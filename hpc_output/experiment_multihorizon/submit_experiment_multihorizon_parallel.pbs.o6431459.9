This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/AAPL/W0/deepLOB_L1/seq2seq
Epoch 1/50
4812/4812 - 127s - loss: 12.7531 - accuracy10: 0.4444 - accuracy20: 0.4288 - accuracy30: 0.4162 - accuracy50: 0.4253 - val_loss: 13.7506 - val_accuracy10: 0.3470 - val_accuracy20: 0.3427 - val_accuracy30: 0.3397 - val_accuracy50: 0.3218 - 127s/epoch - 26ms/step
Epoch 2/50
4812/4812 - 115s - loss: 12.6802 - accuracy10: 0.4542 - accuracy20: 0.4372 - accuracy30: 0.4243 - accuracy50: 0.4330 - val_loss: 13.3985 - val_accuracy10: 0.3696 - val_accuracy20: 0.3615 - val_accuracy30: 0.3559 - val_accuracy50: 0.3331 - 115s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 120s - loss: 12.6495 - accuracy10: 0.4581 - accuracy20: 0.4404 - accuracy30: 0.4272 - accuracy50: 0.4352 - val_loss: 13.3468 - val_accuracy10: 0.3730 - val_accuracy20: 0.3625 - val_accuracy30: 0.3546 - val_accuracy50: 0.3316 - 120s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 118s - loss: 12.6233 - accuracy10: 0.4622 - accuracy20: 0.4431 - accuracy30: 0.4293 - accuracy50: 0.4368 - val_loss: 13.2212 - val_accuracy10: 0.3744 - val_accuracy20: 0.3615 - val_accuracy30: 0.3516 - val_accuracy50: 0.3301 - 118s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 116s - loss: 12.6031 - accuracy10: 0.4651 - accuracy20: 0.4459 - accuracy30: 0.4312 - accuracy50: 0.4391 - val_loss: 13.2828 - val_accuracy10: 0.3675 - val_accuracy20: 0.3537 - val_accuracy30: 0.3430 - val_accuracy50: 0.3240 - 116s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 115s - loss: 12.5821 - accuracy10: 0.4680 - accuracy20: 0.4479 - accuracy30: 0.4331 - accuracy50: 0.4405 - val_loss: 13.2154 - val_accuracy10: 0.3635 - val_accuracy20: 0.3558 - val_accuracy30: 0.3488 - val_accuracy50: 0.3303 - 115s/epoch - 24ms/step
Epoch 7/50
4812/4812 - 123s - loss: 12.5671 - accuracy10: 0.4700 - accuracy20: 0.4494 - accuracy30: 0.4345 - accuracy50: 0.4421 - val_loss: 13.2317 - val_accuracy10: 0.3612 - val_accuracy20: 0.3579 - val_accuracy30: 0.3536 - val_accuracy50: 0.3343 - 123s/epoch - 26ms/step
Epoch 8/50
4812/4812 - 116s - loss: 12.5523 - accuracy10: 0.4719 - accuracy20: 0.4508 - accuracy30: 0.4359 - accuracy50: 0.4430 - val_loss: 13.2373 - val_accuracy10: 0.3617 - val_accuracy20: 0.3559 - val_accuracy30: 0.3509 - val_accuracy50: 0.3329 - 116s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 121s - loss: 12.5387 - accuracy10: 0.4734 - accuracy20: 0.4520 - accuracy30: 0.4369 - accuracy50: 0.4440 - val_loss: 13.3440 - val_accuracy10: 0.3522 - val_accuracy20: 0.3487 - val_accuracy30: 0.3437 - val_accuracy50: 0.3253 - 121s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 111s - loss: 12.5275 - accuracy10: 0.4745 - accuracy20: 0.4530 - accuracy30: 0.4378 - accuracy50: 0.4450 - val_loss: 13.4310 - val_accuracy10: 0.3445 - val_accuracy20: 0.3419 - val_accuracy30: 0.3399 - val_accuracy50: 0.3236 - 111s/epoch - 23ms/step
Epoch 11/50
4812/4812 - 119s - loss: 12.5172 - accuracy10: 0.4758 - accuracy20: 0.4539 - accuracy30: 0.4385 - accuracy50: 0.4458 - val_loss: 13.4499 - val_accuracy10: 0.3424 - val_accuracy20: 0.3409 - val_accuracy30: 0.3395 - val_accuracy50: 0.3240 - 119s/epoch - 25ms/step
Epoch 12/50
4812/4812 - 116s - loss: 12.5058 - accuracy10: 0.4768 - accuracy20: 0.4548 - accuracy30: 0.4395 - accuracy50: 0.4468 - val_loss: 13.4097 - val_accuracy10: 0.3458 - val_accuracy20: 0.3427 - val_accuracy30: 0.3405 - val_accuracy50: 0.3242 - 116s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 114s - loss: 12.4989 - accuracy10: 0.4777 - accuracy20: 0.4555 - accuracy30: 0.4397 - accuracy50: 0.4467 - val_loss: 13.6011 - val_accuracy10: 0.3376 - val_accuracy20: 0.3346 - val_accuracy30: 0.3344 - val_accuracy50: 0.3199 - 114s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 115s - loss: 12.4894 - accuracy10: 0.4790 - accuracy20: 0.4564 - accuracy30: 0.4405 - accuracy50: 0.4476 - val_loss: 13.7358 - val_accuracy10: 0.3347 - val_accuracy20: 0.3339 - val_accuracy30: 0.3336 - val_accuracy50: 0.3188 - 115s/epoch - 24ms/step
Epoch 15/50
4812/4812 - 117s - loss: 12.4800 - accuracy10: 0.4793 - accuracy20: 0.4568 - accuracy30: 0.4410 - accuracy50: 0.4481 - val_loss: 13.9737 - val_accuracy10: 0.3346 - val_accuracy20: 0.3338 - val_accuracy30: 0.3331 - val_accuracy50: 0.3184 - 117s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 126s - loss: 12.4729 - accuracy10: 0.4798 - accuracy20: 0.4578 - accuracy30: 0.4415 - accuracy50: 0.4489 - val_loss: 13.6037 - val_accuracy10: 0.3368 - val_accuracy20: 0.3346 - val_accuracy30: 0.3338 - val_accuracy50: 0.3189 - 126s/epoch - 26ms/step
testing model: results/AAPL/W0/deepLOB_L1/seq2seq
Evaluating performance on  test set...
19053/19053 - 169s - 169s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0950919
{'0': {'precision': 0.28118084352104505, 'recall': 0.4890803138183526, 'f1-score': 0.3570737375982905, 'support': 1177369}, '1': {'precision': 0.5338094674914793, 'recall': 0.21490183764462287, 'f1-score': 0.30643756740166506, 'support': 2541351}, '2': {'precision': 0.25709150171219036, 'recall': 0.40080484599100225, 'f1-score': 0.31325153303887204, 'support': 1158731}, 'accuracy': 0.3252506278381884, 'macro avg': {'precision': 0.35736060424157157, 'recall': 0.3682623324846592, 'f1-score': 0.3255876126796092, 'support': 4877451}, 'weighted avg': {'precision': 0.40708778528886, 'recall': 0.3252506278381884, 'f1-score': 0.3202794307612349, 'support': 4877451}}
[[ 575828  203892  397649]
 [1050826  546141  944384]
 [ 421238  273068  464425]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1052732
{'0': {'precision': 0.28043238752106, 'recall': 0.5552235790769843, 'f1-score': 0.37264778835341145, 'support': 1247411}, '1': {'precision': 0.5017511052390874, 'recall': 0.10302730808608, 'f1-score': 0.1709520861294518, 'support': 2395957}, '2': {'precision': 0.27379241622197503, 'recall': 0.42502570734707473, 'f1-score': 0.3330446405044082, 'support': 1234083}, 'accuracy': 0.3001481716576958, 'macro avg': {'precision': 0.3519919696607075, 'recall': 0.36109219817004634, 'f1-score': 0.2922148383290905, 'support': 4877451}, 'weighted avg': {'precision': 0.3874710549001568, 'recall': 0.3001481716576958, 'f1-score': 0.263548219517076, 'support': 4877451}}
[[ 692592  109463  445356]
 [1203234  246849  945874]
 [ 573903  135663  524517]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1092222
{'0': {'precision': 0.2882934512313265, 'recall': 0.567641593750261, 'f1-score': 0.38238264710433406, 'support': 1316919}, '1': {'precision': 0.472115340831474, 'recall': 0.07341275724225767, 'f1-score': 0.1270669247988847, 'support': 2259689}, '2': {'precision': 0.2844665482730062, 'recall': 0.42272741599101504, 'f1-score': 0.3400815475354846, 'support': 1300843}, 'accuracy': 0.3000194158793189, 'macro avg': {'precision': 0.34829178011193557, 'recall': 0.35459392232784454, 'f1-score': 0.28317703981290115, 'support': 4877451}, 'weighted avg': {'precision': 0.37243619340621614, 'recall': 0.3000194158793189, 'f1-score': 0.2528147194127756, 'support': 4877451}}
[[ 747538   87314  482067]
 [1192669  165890  901130]
 [ 652769   98172  549902]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1189163
{'0': {'precision': 0.24601219784752, 'recall': 0.5651385340654067, 'f1-score': 0.3427993525343464, 'support': 1133584}, '1': {'precision': 0.5502692717139458, 'recall': 0.06682121214655991, 'f1-score': 0.11917104769757697, 'support': 2630078}, '2': {'precision': 0.23880082190168397, 'recall': 0.4189464970474659, 'f1-score': 0.304204258825723, 'support': 1113789}, 'accuracy': 0.2630462099978042, 'macro avg': {'precision': 0.34502743048771656, 'recall': 0.3503020810864775, 'f1-score': 0.25539155301921546, 'support': 4877451}, 'weighted avg': {'precision': 0.40843061786181123, 'recall': 0.2630462099978042, 'f1-score': 0.21339842660908037, 'support': 4877451}}
[[ 640632   69384  423568]
 [1390514  175745 1063819]
 [ 572920   74251  466618]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0902562
{'0': {'precision': 0.38008145236598884, 'recall': 0.5263675500515083, 'f1-score': 0.4414204050494585, 'support': 406731}, '1': {'precision': 0.34309231651657246, 'recall': 0.17204081682821484, 'f1-score': 0.22916748529739217, 'support': 406793}, '2': {'precision': 0.3827610624802254, 'recall': 0.4250927466391295, 'f1-score': 0.40281781064720174, 'support': 418344}, 'accuracy': 0.37496712310085173, 'macro avg': {'precision': 0.36864494378759555, 'recall': 0.3745003711729509, 'f1-score': 0.35780190033135084, 'support': 1231868}, 'weighted avg': {'precision': 0.36877673243985926, 'recall': 0.37496712310085173, 'f1-score': 0.35821979773007034, 'support': 1231868}}
[[214090  58101 134540]
 [184572  69985 152236]
 [164612  75897 177835]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0949528
{'0': {'precision': 0.36382763910544175, 'recall': 0.5696500656403499, 'f1-score': 0.4440479669616293, 'support': 406762}, '1': {'precision': 0.34240433277102017, 'recall': 0.07582579630357845, 'f1-score': 0.12415691450831416, 'support': 406880}, '2': {'precision': 0.37816281137908975, 'recall': 0.4565258974812661, 'f1-score': 0.41366587333999916, 'support': 418226}, 'accuracy': 0.36813603405559686, 'macro avg': {'precision': 0.3614649277518505, 'recall': 0.3673339198083982, 'f1-score': 0.3272902516033142, 'support': 1231868}, 'weighted avg': {'precision': 0.36161849565660575, 'recall': 0.36813603405559686, 'f1-score': 0.3280746216769033, 'support': 1231868}}
[[231712  26850 148200]
 [210268  30852 165760]
 [194893  32402 190931]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0987277
{'0': {'precision': 0.3549753224492773, 'recall': 0.5762248215369284, 'f1-score': 0.4393160657229848, 'support': 405406}, '1': {'precision': 0.3387479861145714, 'recall': 0.05008865901399388, 'f1-score': 0.0872728050750452, 'support': 407178}, '2': {'precision': 0.3714642319592346, 'recall': 0.4549994752959808, 'f1-score': 0.4090101698331041, 'support': 419284}, 'accuracy': 0.36105654177233276, 'macro avg': {'precision': 0.3550625135076945, 'recall': 0.36043765194896765, 'f1-score': 0.3118663468770447, 'support': 1231868}, 'weighted avg': {'precision': 0.3552238243836404, 'recall': 0.36105654177233276, 'f1-score': 0.312637681321085, 'support': 1231868}}
[[233605  18633 153168]
 [217152  20395 169631]
 [207331  21179 190774]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102156
{'0': {'precision': 0.34881470951660504, 'recall': 0.5639708037827971, 'f1-score': 0.4310351319802689, 'support': 405943}, '1': {'precision': 0.33466224109477277, 'recall': 0.044398851652041715, 'f1-score': 0.07839696281269955, 'support': 406497}, '2': {'precision': 0.36227238392490824, 'recall': 0.450523093355713, 'f1-score': 0.4016067500504766, 'support': 419428}, 'accuracy': 0.3538934366344446, 'macro avg': {'precision': 0.34858311151209537, 'recall': 0.3529642495968506, 'f1-score': 0.303679614947815, 'support': 1231868}, 'weighted avg': {'precision': 0.34872670455637905, 'recall': 0.3538934366344446, 'f1-score': 0.30465028780203035, 'support': 1231868}}
[[228940  16991 160012]
 [215821  18048 172628]
 [211576  18890 188962]]
Evaluating performance on  val set...
1767/1767 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0957985
{'0': {'precision': 0.3707721097865262, 'recall': 0.5073295308287382, 'f1-score': 0.42843249984268367, 'support': 147622}, '1': {'precision': 0.3441899724269878, 'recall': 0.1987444843742892, 'f1-score': 0.25198569639443674, 'support': 153881}, '2': {'precision': 0.3635952578571163, 'recall': 0.38928974069898536, 'f1-score': 0.3760040482199362, 'support': 150790}, 'accuracy': 0.3629881514858731, 'macro avg': {'precision': 0.35951911335687675, 'recall': 0.36512125196733763, 'f1-score': 0.3521407481523522, 'support': 452293}, 'weighted avg': {'precision': 0.3593355335373717, 'recall': 0.3629881514858731, 'f1-score': 0.3509219109509392, 'support': 452293}}
[[74893 25164 47565]
 [68118 30583 55180]
 [58981 33108 58701]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0988597
{'0': {'precision': 0.354036474939421, 'recall': 0.5641779518064127, 'f1-score': 0.43506084739697476, 'support': 147613}, '1': {'precision': 0.34438622754491016, 'recall': 0.08947590185719378, 'f1-score': 0.142046360853122, 'support': 154265}, '2': {'precision': 0.36081431549922877, 'recall': 0.4245454243260313, 'f1-score': 0.39009401401352484, 'support': 150415}, 'accuracy': 0.3558334973125828, 'macro avg': {'precision': 0.35307900599451997, 'recall': 0.3593997593298793, 'f1-score': 0.3224004074212072, 'support': 452293}, 'weighted avg': {'precision': 0.3529990798735882, 'recall': 0.3558334973125828, 'f1-score': 0.3201672584843472, 'support': 452293}}
[[83280 11951 52382]
 [79719 13803 60743]
 [72231 14326 63858]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1020008
{'0': {'precision': 0.3465387789115924, 'recall': 0.5761399600657421, 'f1-score': 0.4327721661054994, 'support': 147242}, '1': {'precision': 0.3394265634929535, 'recall': 0.058713223407694796, 'f1-score': 0.10010970171057493, 'support': 154650}, '2': {'precision': 0.3529024476607799, 'recall': 0.4240995738060252, 'f1-score': 0.3852390946564194, 'support': 150401}, 'accuracy': 0.3486611554899147, 'macro avg': {'precision': 0.3462892633551086, 'recall': 0.3529842524264874, 'f1-score': 0.3060403208241646, 'support': 452293}, 'weighted avg': {'precision': 0.34622305001252485, 'recall': 0.3486611554899147, 'f1-score': 0.30322058870392976, 'support': 452293}}
[[84832  8234 54176]
 [82787  9080 62783]
 [77179  9437 63785]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1079887
{'0': {'precision': 0.32739771882985935, 'recall': 0.5666042601292876, 'f1-score': 0.4149989521535186, 'support': 141545}, '1': {'precision': 0.3697497092146642, 'recall': 0.05125464295524848, 'f1-score': 0.09002942240823197, 'support': 167458}, '2': {'precision': 0.330624925319632, 'recall': 0.4248307627887501, 'f1-score': 0.3718540780921664, 'support': 143290}, 'accuracy': 0.3308850678652997, 'macro avg': {'precision': 0.3425907844547185, 'recall': 0.347563221957762, 'f1-score': 0.292294150884639, 'support': 452293}, 'weighted avg': {'precision': 0.3441006216467904, 'recall': 0.3308850678652997, 'f1-score': 0.28101284908241786, 'support': 452293}}
[[80200  7051 54294]
 [89925  8583 68950]
 [74837  7579 60874]]
training model: results/AAPL/W0/deepOF_L1/seq2seq
Epoch 1/50
4812/4812 - 109s - loss: 12.8350 - accuracy10: 0.4298 - accuracy20: 0.4215 - accuracy30: 0.4129 - accuracy50: 0.4274 - val_loss: 13.1937 - val_accuracy10: 0.3822 - val_accuracy20: 0.3838 - val_accuracy30: 0.3810 - val_accuracy50: 0.3631 - 109s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 110s - loss: 12.8041 - accuracy10: 0.4336 - accuracy20: 0.4255 - accuracy30: 0.4175 - accuracy50: 0.4304 - val_loss: 13.1832 - val_accuracy10: 0.3839 - val_accuracy20: 0.3857 - val_accuracy30: 0.3835 - val_accuracy50: 0.3659 - 110s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 116s - loss: 12.8011 - accuracy10: 0.4336 - accuracy20: 0.4254 - accuracy30: 0.4177 - accuracy50: 0.4304 - val_loss: 13.1711 - val_accuracy10: 0.3856 - val_accuracy20: 0.3872 - val_accuracy30: 0.3850 - val_accuracy50: 0.3676 - 116s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 118s - loss: 12.7898 - accuracy10: 0.4347 - accuracy20: 0.4261 - accuracy30: 0.4186 - accuracy50: 0.4309 - val_loss: 13.1553 - val_accuracy10: 0.3878 - val_accuracy20: 0.3889 - val_accuracy30: 0.3868 - val_accuracy50: 0.3691 - 118s/epoch - 25ms/step
Epoch 5/50
4812/4812 - 116s - loss: 12.7747 - accuracy10: 0.4370 - accuracy20: 0.4274 - accuracy30: 0.4198 - accuracy50: 0.4319 - val_loss: 13.1515 - val_accuracy10: 0.3886 - val_accuracy20: 0.3888 - val_accuracy30: 0.3868 - val_accuracy50: 0.3693 - 116s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 110s - loss: 12.7626 - accuracy10: 0.4387 - accuracy20: 0.4287 - accuracy30: 0.4202 - accuracy50: 0.4326 - val_loss: 13.1438 - val_accuracy10: 0.3925 - val_accuracy20: 0.3896 - val_accuracy30: 0.3873 - val_accuracy50: 0.3702 - 110s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 115s - loss: 12.7528 - accuracy10: 0.4403 - accuracy20: 0.4294 - accuracy30: 0.4210 - accuracy50: 0.4333 - val_loss: 13.1321 - val_accuracy10: 0.3937 - val_accuracy20: 0.3905 - val_accuracy30: 0.3879 - val_accuracy50: 0.3708 - 115s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 112s - loss: 12.7432 - accuracy10: 0.4411 - accuracy20: 0.4300 - accuracy30: 0.4214 - accuracy50: 0.4337 - val_loss: 13.1325 - val_accuracy10: 0.3937 - val_accuracy20: 0.3910 - val_accuracy30: 0.3879 - val_accuracy50: 0.3715 - 112s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 106s - loss: 12.7351 - accuracy10: 0.4424 - accuracy20: 0.4311 - accuracy30: 0.4218 - accuracy50: 0.4341 - val_loss: 13.1224 - val_accuracy10: 0.3935 - val_accuracy20: 0.3911 - val_accuracy30: 0.3881 - val_accuracy50: 0.3719 - 106s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 110s - loss: 12.7275 - accuracy10: 0.4434 - accuracy20: 0.4315 - accuracy30: 0.4226 - accuracy50: 0.4348 - val_loss: 13.1234 - val_accuracy10: 0.3955 - val_accuracy20: 0.3922 - val_accuracy30: 0.3891 - val_accuracy50: 0.3724 - 110s/epoch - 23ms/step
Epoch 11/50
4812/4812 - 114s - loss: 12.7219 - accuracy10: 0.4444 - accuracy20: 0.4322 - accuracy30: 0.4230 - accuracy50: 0.4347 - val_loss: 13.1169 - val_accuracy10: 0.3965 - val_accuracy20: 0.3924 - val_accuracy30: 0.3889 - val_accuracy50: 0.3729 - 114s/epoch - 24ms/step
Epoch 12/50
4812/4812 - 113s - loss: 12.7143 - accuracy10: 0.4455 - accuracy20: 0.4329 - accuracy30: 0.4236 - accuracy50: 0.4353 - val_loss: 13.1177 - val_accuracy10: 0.3960 - val_accuracy20: 0.3922 - val_accuracy30: 0.3891 - val_accuracy50: 0.3734 - 113s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 116s - loss: 12.7088 - accuracy10: 0.4464 - accuracy20: 0.4335 - accuracy30: 0.4240 - accuracy50: 0.4353 - val_loss: 13.1158 - val_accuracy10: 0.3964 - val_accuracy20: 0.3930 - val_accuracy30: 0.3898 - val_accuracy50: 0.3745 - 116s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 105s - loss: 12.7025 - accuracy10: 0.4469 - accuracy20: 0.4341 - accuracy30: 0.4246 - accuracy50: 0.4361 - val_loss: 13.1141 - val_accuracy10: 0.3955 - val_accuracy20: 0.3921 - val_accuracy30: 0.3889 - val_accuracy50: 0.3745 - 105s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 107s - loss: 12.6973 - accuracy10: 0.4474 - accuracy20: 0.4345 - accuracy30: 0.4247 - accuracy50: 0.4363 - val_loss: 13.1084 - val_accuracy10: 0.3985 - val_accuracy20: 0.3933 - val_accuracy30: 0.3900 - val_accuracy50: 0.3760 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 106s - loss: 12.6903 - accuracy10: 0.4484 - accuracy20: 0.4355 - accuracy30: 0.4255 - accuracy50: 0.4369 - val_loss: 13.1072 - val_accuracy10: 0.3964 - val_accuracy20: 0.3936 - val_accuracy30: 0.3903 - val_accuracy50: 0.3763 - 106s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 109s - loss: 12.6845 - accuracy10: 0.4494 - accuracy20: 0.4356 - accuracy30: 0.4260 - accuracy50: 0.4377 - val_loss: 13.1015 - val_accuracy10: 0.3991 - val_accuracy20: 0.3936 - val_accuracy30: 0.3901 - val_accuracy50: 0.3760 - 109s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 107s - loss: 12.6802 - accuracy10: 0.4500 - accuracy20: 0.4363 - accuracy30: 0.4266 - accuracy50: 0.4384 - val_loss: 13.0906 - val_accuracy10: 0.4001 - val_accuracy20: 0.3943 - val_accuracy30: 0.3912 - val_accuracy50: 0.3777 - 107s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 111s - loss: 12.6749 - accuracy10: 0.4502 - accuracy20: 0.4365 - accuracy30: 0.4268 - accuracy50: 0.4384 - val_loss: 13.0921 - val_accuracy10: 0.3990 - val_accuracy20: 0.3943 - val_accuracy30: 0.3913 - val_accuracy50: 0.3780 - 111s/epoch - 23ms/step
Epoch 20/50
4812/4812 - 114s - loss: 12.6689 - accuracy10: 0.4510 - accuracy20: 0.4374 - accuracy30: 0.4270 - accuracy50: 0.4391 - val_loss: 13.0913 - val_accuracy10: 0.3998 - val_accuracy20: 0.3944 - val_accuracy30: 0.3914 - val_accuracy50: 0.3783 - 114s/epoch - 24ms/step
Epoch 21/50
4812/4812 - 110s - loss: 12.6628 - accuracy10: 0.4518 - accuracy20: 0.4382 - accuracy30: 0.4280 - accuracy50: 0.4399 - val_loss: 13.0967 - val_accuracy10: 0.3988 - val_accuracy20: 0.3938 - val_accuracy30: 0.3911 - val_accuracy50: 0.3785 - 110s/epoch - 23ms/step
Epoch 22/50
4812/4812 - 103s - loss: 12.6574 - accuracy10: 0.4522 - accuracy20: 0.4387 - accuracy30: 0.4286 - accuracy50: 0.4401 - val_loss: 13.0929 - val_accuracy10: 0.3996 - val_accuracy20: 0.3947 - val_accuracy30: 0.3912 - val_accuracy50: 0.3782 - 103s/epoch - 21ms/step
Epoch 23/50
4812/4812 - 113s - loss: 12.6541 - accuracy10: 0.4527 - accuracy20: 0.4390 - accuracy30: 0.4289 - accuracy50: 0.4405 - val_loss: 13.0893 - val_accuracy10: 0.4002 - val_accuracy20: 0.3953 - val_accuracy30: 0.3916 - val_accuracy50: 0.3795 - 113s/epoch - 24ms/step
Epoch 24/50
4812/4812 - 108s - loss: 12.6499 - accuracy10: 0.4531 - accuracy20: 0.4398 - accuracy30: 0.4293 - accuracy50: 0.4411 - val_loss: 13.0963 - val_accuracy10: 0.3987 - val_accuracy20: 0.3949 - val_accuracy30: 0.3917 - val_accuracy50: 0.3804 - 108s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 109s - loss: 12.6453 - accuracy10: 0.4534 - accuracy20: 0.4399 - accuracy30: 0.4297 - accuracy50: 0.4414 - val_loss: 13.0913 - val_accuracy10: 0.4006 - val_accuracy20: 0.3948 - val_accuracy30: 0.3918 - val_accuracy50: 0.3789 - 109s/epoch - 23ms/step
Epoch 26/50
4812/4812 - 118s - loss: 12.6403 - accuracy10: 0.4540 - accuracy20: 0.4402 - accuracy30: 0.4304 - accuracy50: 0.4420 - val_loss: 13.0869 - val_accuracy10: 0.3994 - val_accuracy20: 0.3948 - val_accuracy30: 0.3921 - val_accuracy50: 0.3805 - 118s/epoch - 24ms/step
Epoch 27/50
4812/4812 - 112s - loss: 12.6343 - accuracy10: 0.4548 - accuracy20: 0.4410 - accuracy30: 0.4306 - accuracy50: 0.4421 - val_loss: 13.0743 - val_accuracy10: 0.4025 - val_accuracy20: 0.3955 - val_accuracy30: 0.3924 - val_accuracy50: 0.3810 - 112s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 114s - loss: 12.6301 - accuracy10: 0.4553 - accuracy20: 0.4418 - accuracy30: 0.4313 - accuracy50: 0.4427 - val_loss: 13.0837 - val_accuracy10: 0.4015 - val_accuracy20: 0.3954 - val_accuracy30: 0.3929 - val_accuracy50: 0.3817 - 114s/epoch - 24ms/step
Epoch 29/50
4812/4812 - 115s - loss: 12.6263 - accuracy10: 0.4557 - accuracy20: 0.4420 - accuracy30: 0.4318 - accuracy50: 0.4433 - val_loss: 13.0809 - val_accuracy10: 0.4017 - val_accuracy20: 0.3952 - val_accuracy30: 0.3927 - val_accuracy50: 0.3824 - 115s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 115s - loss: 12.6217 - accuracy10: 0.4561 - accuracy20: 0.4422 - accuracy30: 0.4315 - accuracy50: 0.4435 - val_loss: 13.0834 - val_accuracy10: 0.4014 - val_accuracy20: 0.3949 - val_accuracy30: 0.3925 - val_accuracy50: 0.3814 - 115s/epoch - 24ms/step
Epoch 31/50
4812/4812 - 114s - loss: 12.6171 - accuracy10: 0.4567 - accuracy20: 0.4429 - accuracy30: 0.4324 - accuracy50: 0.4441 - val_loss: 13.0718 - val_accuracy10: 0.4033 - val_accuracy20: 0.3963 - val_accuracy30: 0.3931 - val_accuracy50: 0.3822 - 114s/epoch - 24ms/step
Epoch 32/50
4812/4812 - 117s - loss: 12.6139 - accuracy10: 0.4569 - accuracy20: 0.4431 - accuracy30: 0.4327 - accuracy50: 0.4441 - val_loss: 13.0784 - val_accuracy10: 0.4032 - val_accuracy20: 0.3959 - val_accuracy30: 0.3928 - val_accuracy50: 0.3832 - 117s/epoch - 24ms/step
Epoch 33/50
4812/4812 - 113s - loss: 12.6069 - accuracy10: 0.4571 - accuracy20: 0.4437 - accuracy30: 0.4336 - accuracy50: 0.4450 - val_loss: 13.0694 - val_accuracy10: 0.4037 - val_accuracy20: 0.3959 - val_accuracy30: 0.3932 - val_accuracy50: 0.3838 - 113s/epoch - 23ms/step
Epoch 34/50
4812/4812 - 104s - loss: 12.6031 - accuracy10: 0.4577 - accuracy20: 0.4440 - accuracy30: 0.4336 - accuracy50: 0.4457 - val_loss: 13.0828 - val_accuracy10: 0.4023 - val_accuracy20: 0.3960 - val_accuracy30: 0.3931 - val_accuracy50: 0.3839 - 104s/epoch - 22ms/step
Epoch 35/50
4812/4812 - 113s - loss: 12.6010 - accuracy10: 0.4585 - accuracy20: 0.4445 - accuracy30: 0.4340 - accuracy50: 0.4458 - val_loss: 13.0697 - val_accuracy10: 0.4044 - val_accuracy20: 0.3963 - val_accuracy30: 0.3933 - val_accuracy50: 0.3843 - 113s/epoch - 24ms/step
Epoch 36/50
4812/4812 - 105s - loss: 12.5964 - accuracy10: 0.4581 - accuracy20: 0.4451 - accuracy30: 0.4345 - accuracy50: 0.4466 - val_loss: 13.0776 - val_accuracy10: 0.4024 - val_accuracy20: 0.3959 - val_accuracy30: 0.3930 - val_accuracy50: 0.3845 - 105s/epoch - 22ms/step
Epoch 37/50
4812/4812 - 108s - loss: 12.5927 - accuracy10: 0.4589 - accuracy20: 0.4454 - accuracy30: 0.4351 - accuracy50: 0.4469 - val_loss: 13.0767 - val_accuracy10: 0.4033 - val_accuracy20: 0.3960 - val_accuracy30: 0.3931 - val_accuracy50: 0.3839 - 108s/epoch - 22ms/step
Epoch 38/50
4812/4812 - 112s - loss: 12.5885 - accuracy10: 0.4593 - accuracy20: 0.4457 - accuracy30: 0.4353 - accuracy50: 0.4476 - val_loss: 13.0837 - val_accuracy10: 0.4027 - val_accuracy20: 0.3956 - val_accuracy30: 0.3931 - val_accuracy50: 0.3841 - 112s/epoch - 23ms/step
Epoch 39/50
4812/4812 - 114s - loss: 12.5829 - accuracy10: 0.4595 - accuracy20: 0.4463 - accuracy30: 0.4361 - accuracy50: 0.4483 - val_loss: 13.0694 - val_accuracy10: 0.4052 - val_accuracy20: 0.3969 - val_accuracy30: 0.3933 - val_accuracy50: 0.3839 - 114s/epoch - 24ms/step
Epoch 40/50
4812/4812 - 105s - loss: 12.5815 - accuracy10: 0.4596 - accuracy20: 0.4465 - accuracy30: 0.4360 - accuracy50: 0.4481 - val_loss: 13.0777 - val_accuracy10: 0.4035 - val_accuracy20: 0.3955 - val_accuracy30: 0.3929 - val_accuracy50: 0.3840 - 105s/epoch - 22ms/step
Epoch 41/50
4812/4812 - 117s - loss: 12.5758 - accuracy10: 0.4599 - accuracy20: 0.4472 - accuracy30: 0.4370 - accuracy50: 0.4489 - val_loss: 13.0680 - val_accuracy10: 0.4061 - val_accuracy20: 0.3974 - val_accuracy30: 0.3933 - val_accuracy50: 0.3839 - 117s/epoch - 24ms/step
Epoch 42/50
4812/4812 - 112s - loss: 12.5719 - accuracy10: 0.4603 - accuracy20: 0.4473 - accuracy30: 0.4373 - accuracy50: 0.4498 - val_loss: 13.0634 - val_accuracy10: 0.4040 - val_accuracy20: 0.3963 - val_accuracy30: 0.3940 - val_accuracy50: 0.3864 - 112s/epoch - 23ms/step
Epoch 43/50
4812/4812 - 115s - loss: 12.5688 - accuracy10: 0.4608 - accuracy20: 0.4474 - accuracy30: 0.4374 - accuracy50: 0.4496 - val_loss: 13.0753 - val_accuracy10: 0.4047 - val_accuracy20: 0.3959 - val_accuracy30: 0.3930 - val_accuracy50: 0.3848 - 115s/epoch - 24ms/step
Epoch 44/50
4812/4812 - 115s - loss: 12.5640 - accuracy10: 0.4610 - accuracy20: 0.4477 - accuracy30: 0.4377 - accuracy50: 0.4506 - val_loss: 13.0835 - val_accuracy10: 0.4041 - val_accuracy20: 0.3956 - val_accuracy30: 0.3927 - val_accuracy50: 0.3851 - 115s/epoch - 24ms/step
Epoch 45/50
4812/4812 - 110s - loss: 12.5619 - accuracy10: 0.4612 - accuracy20: 0.4484 - accuracy30: 0.4387 - accuracy50: 0.4504 - val_loss: 13.0857 - val_accuracy10: 0.4045 - val_accuracy20: 0.3962 - val_accuracy30: 0.3925 - val_accuracy50: 0.3845 - 110s/epoch - 23ms/step
Epoch 46/50
4812/4812 - 109s - loss: 12.5577 - accuracy10: 0.4613 - accuracy20: 0.4485 - accuracy30: 0.4386 - accuracy50: 0.4515 - val_loss: 13.0810 - val_accuracy10: 0.4041 - val_accuracy20: 0.3959 - val_accuracy30: 0.3929 - val_accuracy50: 0.3855 - 109s/epoch - 23ms/step
Epoch 47/50
4812/4812 - 103s - loss: 12.5519 - accuracy10: 0.4623 - accuracy20: 0.4493 - accuracy30: 0.4396 - accuracy50: 0.4518 - val_loss: 13.0804 - val_accuracy10: 0.4059 - val_accuracy20: 0.3963 - val_accuracy30: 0.3924 - val_accuracy50: 0.3856 - 103s/epoch - 21ms/step
Epoch 48/50
4812/4812 - 108s - loss: 12.5473 - accuracy10: 0.4619 - accuracy20: 0.4494 - accuracy30: 0.4398 - accuracy50: 0.4524 - val_loss: 13.0738 - val_accuracy10: 0.4065 - val_accuracy20: 0.3972 - val_accuracy30: 0.3933 - val_accuracy50: 0.3856 - 108s/epoch - 22ms/step
Epoch 49/50
4812/4812 - 113s - loss: 12.5430 - accuracy10: 0.4622 - accuracy20: 0.4500 - accuracy30: 0.4408 - accuracy50: 0.4531 - val_loss: 13.0865 - val_accuracy10: 0.4060 - val_accuracy20: 0.3961 - val_accuracy30: 0.3923 - val_accuracy50: 0.3840 - 113s/epoch - 24ms/step
Epoch 50/50
4812/4812 - 106s - loss: 12.5403 - accuracy10: 0.4625 - accuracy20: 0.4503 - accuracy30: 0.4408 - accuracy50: 0.4535 - val_loss: 13.0800 - val_accuracy10: 0.4056 - val_accuracy20: 0.3968 - val_accuracy30: 0.3929 - val_accuracy50: 0.3854 - 106s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L1/seq2seq
Evaluating performance on  test set...
19053/19053 - 167s - 167s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1441431
{'0': {'precision': 0.3019910279453251, 'recall': 0.6624516080810895, 'f1-score': 0.41486022001823375, 'support': 1177366}, '1': {'precision': 0.6866547642266665, 'recall': 0.09004584177700828, 'f1-score': 0.15921297286767097, 'support': 2541350}, '2': {'precision': 0.3192355830629188, 'recall': 0.5404011288220725, 'f1-score': 0.4013678500749145, 'support': 1158730}, 'accuracy': 0.3352092468066279, 'macro avg': {'precision': 0.4359604584116368, 'recall': 0.43096619289339005, 'f1-score': 0.3251470143202731, 'support': 4877446}, 'weighted avg': {'precision': 0.5065134295362389, 'recall': 0.3352092468066279, 'f1-score': 0.27845211926827057, 'support': 4877446}}
[[ 779948   48034  349384]
 [1326580  228838  985932]
 [ 476158   56393  626179]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1153383
{'0': {'precision': 0.31466652636088777, 'recall': 0.6712168983869765, 'f1-score': 0.42846747302638716, 'support': 1247409}, '1': {'precision': 0.6371770749335484, 'recall': 0.04452212165921313, 'f1-score': 0.0832287184448597, 'support': 2395955}, '2': {'precision': 0.33677439126751435, 'recall': 0.5592091935543991, 'f1-score': 0.42038121889903257, 'support': 1234082}, 'accuracy': 0.3350247240051453, 'macro avg': {'precision': 0.4295393308539835, 'recall': 0.4249827378668629, 'f1-score': 0.3106924701234265, 'support': 4877446}, 'weighted avg': {'precision': 0.47868754874537106, 'recall': 0.3350247240051453, 'f1-score': 0.2568293614205636, 'support': 4877446}}
[[ 837282   28153  381974]
 [1312190  106673  977092]
 [ 511383   32589  690110]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0954273
{'0': {'precision': 0.33102587616368945, 'recall': 0.6540126264505459, 'f1-score': 0.43956678265538285, 'support': 1316918}, '1': {'precision': 0.5523709774294266, 'recall': 0.0492453376265552, 'f1-score': 0.09042871543831463, 'support': 2259686}, '2': {'precision': 0.35234061428016983, 'recall': 0.5617915165715744, 'f1-score': 0.43307080314917706, 'support': 1300842}, 'accuracy': 0.349232364643299, 'macro avg': {'precision': 0.41191248929109525, 'recall': 0.42168316021622515, 'f1-score': 0.3210221004142915, 'support': 4877446}, 'weighted avg': {'precision': 0.4392582447147072, 'recall': 0.349232364643299, 'f1-score': 0.2760810883944357, 'support': 4877446}}
[[ 861281   44708  410929]
 [1216003  111279  932404]
 [ 524570   45470  730802]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851015
{'0': {'precision': 0.2957634795926683, 'recall': 0.6051008174963809, 'f1-score': 0.3973222689929894, 'support': 1133583}, '1': {'precision': 0.5879484510474208, 'recall': 0.1511918286771941, 'f1-score': 0.24053080022888912, 'support': 2630076}, '2': {'precision': 0.31034625678891903, 'recall': 0.5243812326773432, 'f1-score': 0.3899230700928059, 'support': 1113787}, 'accuracy': 0.3419057842977657, 'macro avg': {'precision': 0.3980193958096694, 'recall': 0.4268912929503061, 'f1-score': 0.34259204643822816, 'support': 4877446}, 'weighted avg': {'precision': 0.4566490718983361, 'recall': 0.3419057842977657, 'f1-score': 0.3110856175679098, 'support': 4877446}}
[[ 685932  141496  306155]
 [1240707  397646  991723]
 [ 392552  137186  584049]]
Evaluating performance on  train set...
4812/4812 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0769464
{'0': {'precision': 0.4013591265488778, 'recall': 0.6299081508441023, 'f1-score': 0.49030816893158724, 'support': 406645}, '1': {'precision': 0.4974520940601943, 'recall': 0.09210206262822324, 'f1-score': 0.15542715932672835, 'support': 407005}, '2': {'precision': 0.42511291570439913, 'recall': 0.5268532842997774, 'f1-score': 0.47054640350914656, 'support': 418217}, 'accuracy': 0.41723173037349, 'macro avg': {'precision': 0.44130804543782376, 'recall': 0.41628783259070107, 'f1-score': 0.37209391058915403, 'support': 1231867}, 'weighted avg': {'precision': 0.44117231797392453, 'recall': 0.41723173037349, 'f1-score': 0.37295544208371934, 'support': 1231867}}
[[256149  17715 132781]
 [204332  37486 165187]
 [177723  20155 220339]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0768555
{'0': {'precision': 0.3998102183719074, 'recall': 0.6388649282286069, 'f1-score': 0.49182793542564923, 'support': 406917}, '1': {'precision': 0.47137504150263243, 'recall': 0.04888210107449134, 'f1-score': 0.08857851449606376, 'support': 406611}, '2': {'precision': 0.42130199451323497, 'recall': 0.5433010070779918, 'f1-score': 0.47458653461666556, 'support': 418339}, 'accuracy': 0.4116718769152839, 'macro avg': {'precision': 0.4308290847959249, 'recall': 0.41034934546036334, 'f1-score': 0.35166432817945953, 'support': 1231867}, 'weighted avg': {'precision': 0.43073067686068417, 'recall': 0.4116718769152839, 'f1-score': 0.3528694271884539, 'support': 1231867}}
[[259965  10523 136429]
 [210968  19876 175767]
 [179288  11767 227284]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0770215
{'0': {'precision': 0.3989567291603557, 'recall': 0.6202540697014977, 'f1-score': 0.4855806770745361, 'support': 405558}, '1': {'precision': 0.42387625113739763, 'recall': 0.057218097937967054, 'f1-score': 0.10082593112046129, 'support': 407074}, '2': {'precision': 0.4185468521229868, 'recall': 0.5455031187758655, 'f1-score': 0.47366551543802776, 'support': 419235}, 'accuracy': 0.4087576012670199, 'macro avg': {'precision': 0.41379327747358, 'recall': 0.4076584288051101, 'f1-score': 0.35335737454434174, 'support': 1231867}, 'weighted avg': {'precision': 0.41385846342998145, 'recall': 0.4087576012670199, 'f1-score': 0.354382336471865, 'support': 1231867}}
[[251549  15157 138852]
 [204928  23292 178854]
 [174040  16501 228694]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0785326
{'0': {'precision': 0.4032091348530525, 'recall': 0.5524331193876194, 'f1-score': 0.4661704296644841, 'support': 406022}, '1': {'precision': 0.3813254905482466, 'recall': 0.16715339780983288, 'f1-score': 0.23242408329498943, 'support': 406453}, '2': {'precision': 0.42000394039548705, 'recall': 0.49813778040592094, 'f1-score': 0.45574626637754634, 'support': 419392}, 'accuracy': 0.4068255745141318, 'macro avg': {'precision': 0.4015128552655954, 'recall': 0.40590809920112436, 'f1-score': 0.3847802597790066, 'support': 1231867}, 'weighted avg': {'precision': 0.40170648416708676, 'recall': 0.4068255745141318, 'f1-score': 0.3854971797031201, 'support': 1231867}}
[[224300  53525 128197]
 [178213  67940 160300]
 [153774  56703 208915]]
Evaluating performance on  val set...
1767/1767 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.08992
{'0': {'precision': 0.39204372912238084, 'recall': 0.6201271903118869, 'f1-score': 0.4803871985493157, 'support': 147810}, '1': {'precision': 0.4806550597024882, 'recall': 0.09367402919878837, 'f1-score': 0.15679127861432673, 'support': 153842}, '2': {'precision': 0.4064495936511978, 'recall': 0.5086198312544393, 'f1-score': 0.45183090617987964, 'support': 150641}, 'accuracy': 0.4039217940582764, 'macro avg': {'precision': 0.4263827941586889, 'recall': 0.4074736835883715, 'f1-score': 0.36300312778117405, 'support': 452293}, 'weighted avg': {'precision': 0.42698182933085277, 'recall': 0.4039217940582764, 'f1-score': 0.3608089783392687, 'support': 452293}}
[[91661  7392 48757]
 [76299 14411 63132]
 [65843  8179 76619]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0887529
{'0': {'precision': 0.3890453873653095, 'recall': 0.6250778015316754, 'f1-score': 0.47959387595671954, 'support': 147812}, '1': {'precision': 0.45522476574546317, 'recall': 0.04977369697441284, 'f1-score': 0.08973579611877483, 'support': 154218}, '2': {'precision': 0.400041426276384, 'recall': 0.5269760353513506, 'f1-score': 0.4548182823336827, 'support': 150263}, 'accuracy': 0.3963249486505429, 'macro avg': {'precision': 0.41477052646238555, 'recall': 0.40060917795247963, 'f1-score': 0.34138265146972574, 'support': 452293}, 'weighted avg': {'precision': 0.41526367765484595, 'recall': 0.3963249486505429, 'f1-score': 0.3384331938744708, 'support': 452293}}
[[92394  4442 50976]
 [78761  7676 67781]
 [66334  4744 79185]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869241
{'0': {'precision': 0.3870122611520592, 'recall': 0.6019273737325718, 'f1-score': 0.47111727701102685, 'support': 147247}, '1': {'precision': 0.4193115780062584, 'recall': 0.060580226820636025, 'f1-score': 0.10586548988183243, 'support': 154836}, '2': {'precision': 0.3977163563240703, 'recall': 0.531948605285933, 'f1-score': 0.45514173338231984, 'support': 150210}, 'accuracy': 0.39336447833594596, 'macro avg': {'precision': 0.40134673182746267, 'recall': 0.3981520686130469, 'f1-score': 0.34404150009172635, 'support': 452293}, 'weighted avg': {'precision': 0.4016243801992799, 'recall': 0.39336447833594596, 'f1-score': 0.34077298222776903, 'support': 452293}}
[[88632  6347 52268]
 [76721  9380 68735]
 [63663  6643 79904]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.086381
{'0': {'precision': 0.37756115172849536, 'recall': 0.5313620324629499, 'f1-score': 0.44144910032187895, 'support': 141700}, '1': {'precision': 0.41214196499992983, 'recall': 0.17549688661543425, 'f1-score': 0.24617035276761426, 'support': 167342}, '2': {'precision': 0.38495380312090477, 'recall': 0.4880454586704456, 'f1-score': 0.43041263293983656, 'support': 143251}, 'accuracy': 0.385977673764573, 'macro avg': {'precision': 0.3915523066164433, 'recall': 0.3983014592496099, 'f1-score': 0.3726773620097766, 'support': 452293}, 'weighted avg': {'precision': 0.39269697553979116, 'recall': 0.385977673764573, 'f1-score': 0.3657032427424543, 'support': 452293}}
[[75294 20775 45631]
 [71904 29368 66070]
 [52224 21114 69913]]
training model: results/AAPL/W0/deepLOB_L2/seq2seq
Epoch 1/50
4812/4812 - 239s - loss: 12.7626 - accuracy10: 0.4412 - accuracy20: 0.4270 - accuracy30: 0.4149 - accuracy50: 0.4249 - val_loss: 13.7311 - val_accuracy10: 0.3363 - val_accuracy20: 0.3352 - val_accuracy30: 0.3348 - val_accuracy50: 0.3189 - 239s/epoch - 50ms/step
Epoch 2/50
4812/4812 - 231s - loss: 12.6160 - accuracy10: 0.4601 - accuracy20: 0.4428 - accuracy30: 0.4289 - accuracy50: 0.4354 - val_loss: 13.2690 - val_accuracy10: 0.3708 - val_accuracy20: 0.3680 - val_accuracy30: 0.3668 - val_accuracy50: 0.3500 - 231s/epoch - 48ms/step
Epoch 3/50
4812/4812 - 234s - loss: 12.4964 - accuracy10: 0.4763 - accuracy20: 0.4554 - accuracy30: 0.4394 - accuracy50: 0.4460 - val_loss: 13.0238 - val_accuracy10: 0.4168 - val_accuracy20: 0.4041 - val_accuracy30: 0.3978 - val_accuracy50: 0.3730 - 234s/epoch - 49ms/step
Epoch 4/50
4812/4812 - 233s - loss: 12.4342 - accuracy10: 0.4834 - accuracy20: 0.4610 - accuracy30: 0.4442 - accuracy50: 0.4503 - val_loss: 13.5600 - val_accuracy10: 0.3617 - val_accuracy20: 0.3579 - val_accuracy30: 0.3565 - val_accuracy50: 0.3389 - 233s/epoch - 48ms/step
Epoch 5/50
4812/4812 - 235s - loss: 12.3877 - accuracy10: 0.4891 - accuracy20: 0.4652 - accuracy30: 0.4477 - accuracy50: 0.4530 - val_loss: 13.5101 - val_accuracy10: 0.3696 - val_accuracy20: 0.3637 - val_accuracy30: 0.3611 - val_accuracy50: 0.3430 - 235s/epoch - 49ms/step
Epoch 6/50
4812/4812 - 236s - loss: 12.3516 - accuracy10: 0.4935 - accuracy20: 0.4684 - accuracy30: 0.4503 - accuracy50: 0.4553 - val_loss: 13.3622 - val_accuracy10: 0.3768 - val_accuracy20: 0.3587 - val_accuracy30: 0.3509 - val_accuracy50: 0.3358 - 236s/epoch - 49ms/step
Epoch 7/50
4812/4812 - 236s - loss: 12.3237 - accuracy10: 0.4964 - accuracy20: 0.4708 - accuracy30: 0.4524 - accuracy50: 0.4568 - val_loss: 13.0455 - val_accuracy10: 0.4186 - val_accuracy20: 0.3918 - val_accuracy30: 0.3808 - val_accuracy50: 0.3824 - 236s/epoch - 49ms/step
Epoch 8/50
4812/4812 - 237s - loss: 12.2983 - accuracy10: 0.4987 - accuracy20: 0.4730 - accuracy30: 0.4540 - accuracy50: 0.4581 - val_loss: 12.9865 - val_accuracy10: 0.4269 - val_accuracy20: 0.4009 - val_accuracy30: 0.3856 - val_accuracy50: 0.3820 - 237s/epoch - 49ms/step
Epoch 9/50
4812/4812 - 240s - loss: 12.2774 - accuracy10: 0.5008 - accuracy20: 0.4747 - accuracy30: 0.4551 - accuracy50: 0.4592 - val_loss: 13.0385 - val_accuracy10: 0.4056 - val_accuracy20: 0.3856 - val_accuracy30: 0.3766 - val_accuracy50: 0.3876 - 240s/epoch - 50ms/step
Epoch 10/50
4812/4812 - 239s - loss: 12.2596 - accuracy10: 0.5026 - accuracy20: 0.4761 - accuracy30: 0.4566 - accuracy50: 0.4600 - val_loss: 12.9884 - val_accuracy10: 0.4188 - val_accuracy20: 0.3953 - val_accuracy30: 0.3832 - val_accuracy50: 0.3876 - 239s/epoch - 50ms/step
Epoch 11/50
4812/4812 - 235s - loss: 12.2422 - accuracy10: 0.5042 - accuracy20: 0.4775 - accuracy30: 0.4579 - accuracy50: 0.4613 - val_loss: 13.0511 - val_accuracy10: 0.4153 - val_accuracy20: 0.3917 - val_accuracy30: 0.3849 - val_accuracy50: 0.3957 - 235s/epoch - 49ms/step
Epoch 12/50
4812/4812 - 236s - loss: 12.2288 - accuracy10: 0.5055 - accuracy20: 0.4786 - accuracy30: 0.4587 - accuracy50: 0.4622 - val_loss: 13.1249 - val_accuracy10: 0.3970 - val_accuracy20: 0.3821 - val_accuracy30: 0.3775 - val_accuracy50: 0.3935 - 236s/epoch - 49ms/step
Epoch 13/50
4812/4812 - 234s - loss: 12.2155 - accuracy10: 0.5065 - accuracy20: 0.4796 - accuracy30: 0.4598 - accuracy50: 0.4630 - val_loss: 13.4565 - val_accuracy10: 0.3984 - val_accuracy20: 0.3819 - val_accuracy30: 0.3772 - val_accuracy50: 0.3904 - 234s/epoch - 49ms/step
Epoch 14/50
4812/4812 - 239s - loss: 12.2030 - accuracy10: 0.5078 - accuracy20: 0.4803 - accuracy30: 0.4606 - accuracy50: 0.4639 - val_loss: 13.5484 - val_accuracy10: 0.3833 - val_accuracy20: 0.3719 - val_accuracy30: 0.3664 - val_accuracy50: 0.3862 - 239s/epoch - 50ms/step
Epoch 15/50
4812/4812 - 238s - loss: 12.1921 - accuracy10: 0.5087 - accuracy20: 0.4809 - accuracy30: 0.4613 - accuracy50: 0.4642 - val_loss: 13.5588 - val_accuracy10: 0.3856 - val_accuracy20: 0.3759 - val_accuracy30: 0.3723 - val_accuracy50: 0.3915 - 238s/epoch - 49ms/step
Epoch 16/50
4812/4812 - 240s - loss: 12.1813 - accuracy10: 0.5097 - accuracy20: 0.4820 - accuracy30: 0.4624 - accuracy50: 0.4650 - val_loss: 13.6968 - val_accuracy10: 0.3655 - val_accuracy20: 0.3561 - val_accuracy30: 0.3536 - val_accuracy50: 0.3782 - 240s/epoch - 50ms/step
Epoch 17/50
4812/4812 - 239s - loss: 12.1727 - accuracy10: 0.5104 - accuracy20: 0.4826 - accuracy30: 0.4630 - accuracy50: 0.4657 - val_loss: 13.3629 - val_accuracy10: 0.3747 - val_accuracy20: 0.3635 - val_accuracy30: 0.3585 - val_accuracy50: 0.3809 - 239s/epoch - 50ms/step
Epoch 18/50
4812/4812 - 232s - loss: 12.1628 - accuracy10: 0.5115 - accuracy20: 0.4833 - accuracy30: 0.4642 - accuracy50: 0.4668 - val_loss: 13.4929 - val_accuracy10: 0.3804 - val_accuracy20: 0.3654 - val_accuracy30: 0.3593 - val_accuracy50: 0.3787 - 232s/epoch - 48ms/step
testing model: results/AAPL/W0/deepLOB_L2/seq2seq
Evaluating performance on  test set...
19053/19053 - 306s - 306s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0744162
{'0': {'precision': 0.33620447839758416, 'recall': 0.329832873126437, 'f1-score': 0.332988198977459, 'support': 1177369}, '1': {'precision': 0.6089856481363043, 'recall': 0.46834616705838744, 'f1-score': 0.5294860693344745, 'support': 2541351}, '2': {'precision': 0.322755515584478, 'recall': 0.49244734109987565, 'f1-score': 0.389939986523961, 'support': 1158731}, 'accuracy': 0.4406361027512116, 'macro avg': {'precision': 0.42264854737278884, 'recall': 0.4302087937615667, 'f1-score': 0.4174714182786315, 'support': 4877451}, 'weighted avg': {'precision': 0.4751395427103313, 'recall': 0.4406361027512116, 'f1-score': 0.44890158510173117, 'support': 4877451}}
[[ 388335  370947  418087]
 [ 571875 1190232  779244]
 [ 194846  393271  570614]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0772253
{'0': {'precision': 0.3586070206091295, 'recall': 0.19711626721265085, 'f1-score': 0.2543973911037216, 'support': 1247411}, '1': {'precision': 0.564851336066565, 'recall': 0.49710992309127416, 'f1-score': 0.5288200521603384, 'support': 2395957}, '2': {'precision': 0.32274049777046415, 'recall': 0.5447956093714929, 'f1-score': 0.4053493674885116, 'support': 1234083}, 'accuracy': 0.432451704794164, 'macro avg': {'precision': 0.41539961814871956, 'recall': 0.4130072665584727, 'f1-score': 0.3961889369175238, 'support': 4877451}, 'weighted avg': {'precision': 0.4508458242846851, 'recall': 0.432451704794164, 'f1-score': 0.42739598475235063, 'support': 4877451}}
[[ 245885  464498  537028]
 [ 331085 1191054  873818]
 [ 108697  453063  672323]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08104
{'0': {'precision': 0.3796697320917182, 'recall': 0.08959776569401763, 'f1-score': 0.14498152911752005, 'support': 1316919}, '1': {'precision': 0.5262301643994651, 'recall': 0.5428012438879863, 'f1-score': 0.5343872698090159, 'support': 2259689}, '2': {'precision': 0.32767084737363283, 'recall': 0.5631847963205399, 'f1-score': 0.4142966163924303, 'support': 1300843}, 'accuracy': 0.4258720384889566, 'macro avg': {'precision': 0.41119024795493875, 'recall': 0.39852793530084796, 'f1-score': 0.3645551384396554, 'support': 4877451}, 'weighted avg': {'precision': 0.43370176881084305, 'recall': 0.4258720384889566, 'f1-score': 0.397218305018166, 'support': 4877451}}
[[ 117993  585654  613272]
 [ 143188 1226562  889939]
 [  49597  518631  732615]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0756919
{'0': {'precision': 0.34743358518157447, 'recall': 0.031438340696410674, 'f1-score': 0.05765924933604819, 'support': 1133584}, '1': {'precision': 0.6055516038197126, 'recall': 0.5881350286949665, 'f1-score': 0.5967162573288011, 'support': 2630078}, '2': {'precision': 0.2882060021356099, 'recall': 0.5745657391121658, 'f1-score': 0.3838635103975968, 'support': 1113789}, 'accuracy': 0.4556527579672251, 'macro avg': {'precision': 0.4137303970456323, 'recall': 0.39804636950118094, 'f1-score': 0.34607967235414866, 'support': 4877451}, 'weighted avg': {'precision': 0.4730942000663935, 'recall': 0.4556527579672251, 'f1-score': 0.4228263612539423, 'support': 4877451}}
[[  35638  548189  549757]
 [  52496 1546841 1030741]
 [  14441  459403  639945]]
Evaluating performance on  train set...
4812/4812 - 77s - 77s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0696197
{'0': {'precision': 0.4435270254942386, 'recall': 0.3268720604035591, 'f1-score': 0.37636750957203624, 'support': 406731}, '1': {'precision': 0.44679974876753886, 'recall': 0.3707315514278761, 'f1-score': 0.40522672097956686, 'support': 406793}, '2': {'precision': 0.41875077786261855, 'recall': 0.59515613944505, 'f1-score': 0.491607448549839, 'support': 418344}, 'accuracy': 0.4324651667224086, 'macro avg': {'precision': 0.43635918404146534, 'recall': 0.43091991709216176, 'f1-score': 0.4244005597004807, 'support': 1231868}, 'weighted avg': {'precision': 0.43619371249261274, 'recall': 0.4324651667224086, 'f1-score': 0.4250331638611593, 'support': 1231868}}
[[132949  91471 182311]
 [ 92695 150811 163287]
 [ 74110  95254 248980]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0858539
{'0': {'precision': 0.44953517290383704, 'recall': 0.22396634887231354, 'f1-score': 0.29897705679845354, 'support': 406762}, '1': {'precision': 0.41433356767710183, 'recall': 0.34473554856468736, 'f1-score': 0.3763438840697921, 'support': 406880}, '2': {'precision': 0.3963569130622374, 'recall': 0.6545623658022217, 'f1-score': 0.49373976466853764, 'support': 418226}, 'accuracy': 0.4100455568291408, 'macro avg': {'precision': 0.4200752178810587, 'recall': 0.4077547544130742, 'f1-score': 0.3896869018455944, 'support': 1231868}, 'weighted avg': {'precision': 0.4198539407952289, 'recall': 0.4100455568291408, 'f1-score': 0.3906539596336891, 'support': 1231868}}
[[ 91101 100986 214675]
 [ 64366 140266 202248]
 [ 47189  97282 273755]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.093306
{'0': {'precision': 0.4544929234081626, 'recall': 0.141628392278358, 'f1-score': 0.21595973957099174, 'support': 405406}, '1': {'precision': 0.39395804609021073, 'recall': 0.3536757879846161, 'f1-score': 0.3727317198164411, 'support': 407178}, '2': {'precision': 0.3861176877587866, 'recall': 0.6814569599603133, 'f1-score': 0.49293524579133874, 'support': 419284}, 'accuracy': 0.3954563313601782, 'macro avg': {'precision': 0.41152288575238666, 'recall': 0.39225371340776244, 'f1-score': 0.36054223505959054, 'support': 1231868}, 'weighted avg': {'precision': 0.41121140900842007, 'recall': 0.3954563313601782, 'f1-score': 0.36205128470608217, 'support': 1231868}}
[[ 57417 116897 231092]
 [ 39993 144009 223176]
 [ 28922 104638 285724]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.09708
{'0': {'precision': 0.44793257835133, 'recall': 0.08379501555637121, 'f1-score': 0.14117949792792028, 'support': 405943}, '1': {'precision': 0.39702644079612065, 'recall': 0.4147164677722099, 'f1-score': 0.40567869802407874, 'support': 406497}, '2': {'precision': 0.3857331752627786, 'recall': 0.6725683549977588, 'f1-score': 0.4902797921697819, 'support': 419428}, 'accuracy': 0.39346017592794036, 'macro avg': {'precision': 0.4102307314700764, 'recall': 0.39035994610877994, 'f1-score': 0.34571266270726025, 'support': 1231868}, 'weighted avg': {'precision': 0.40995662359286167, 'recall': 0.39346017592794036, 'f1-score': 0.34732217681458966, 'support': 1231868}}
[[ 34016 136671 235256]
 [ 23947 168581 213969]
 [ 17977 119357 282094]]
Evaluating performance on  val set...
1767/1767 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0674568
{'0': {'precision': 0.43888608651788974, 'recall': 0.3418460663044804, 'f1-score': 0.38433534904266503, 'support': 147622}, '1': {'precision': 0.4127339300244101, 'recall': 0.5406060527290568, 'f1-score': 0.4680942051615335, 'support': 153881}, '2': {'precision': 0.4339876984273139, 'recall': 0.39071556469261887, 'f1-score': 0.4112163883508698, 'support': 150790}, 'accuracy': 0.42576161912742405, 'macro avg': {'precision': 0.4285359049898712, 'recall': 0.4243892279087187, 'f1-score': 0.4212153141850228, 'support': 452293}, 'weighted avg': {'precision': 0.42835541738626254, 'recall': 0.42576161912742405, 'f1-score': 0.4217940062752815, 'support': 452293}}
[[50464 56491 40667]
 [34520 83189 36172]
 [29998 61876 58916]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0806179
{'0': {'precision': 0.4488048411497731, 'recall': 0.2009714591533266, 'f1-score': 0.2776246648542672, 'support': 147613}, '1': {'precision': 0.38769022590803487, 'recall': 0.5051696755582925, 'f1-score': 0.4387011788018329, 'support': 154265}, '2': {'precision': 0.3971930317201456, 'recall': 0.48900043213775224, 'f1-score': 0.4383412247427718, 'support': 150415}, 'accuracy': 0.4005124996407196, 'macro avg': {'precision': 0.41122936625931783, 'recall': 0.3983805222831238, 'f1-score': 0.38488902279962395, 'support': 452293}, 'weighted avg': {'precision': 0.4107962130356432, 'recall': 0.4005124996407196, 'f1-score': 0.3860115949631803, 'support': 452293}}
[[29666 61630 56317]
 [21023 77930 55312]
 [15411 61451 73553]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0871818
{'0': {'precision': 0.4614367417104698, 'recall': 0.09479632170168838, 'f1-score': 0.15728121425875113, 'support': 147242}, '1': {'precision': 0.37808884094920575, 'recall': 0.4986420950533463, 'f1-score': 0.43007724268704167, 'support': 154650}, '2': {'precision': 0.38210047504631245, 'recall': 0.5540521672063351, 'f1-score': 0.4522843535014994, 'support': 150401}, 'accuracy': 0.38559738930295184, 'macro avg': {'precision': 0.40720868590199594, 'recall': 0.3824968613204566, 'f1-score': 0.3465476034824307, 'support': 452293}, 'weighted avg': {'precision': 0.40655637280074663, 'recall': 0.38559738930295184, 'f1-score': 0.3486542245456309, 'support': 452293}}
[[13958 66350 66934]
 [ 9715 77115 67820]
 [ 6576 60495 83330]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901926
{'0': {'precision': 0.4273866243162167, 'recall': 0.03422233212052704, 'f1-score': 0.06337037788054604, 'support': 141545}, '1': {'precision': 0.4034130206691478, 'recall': 0.512014953003141, 'f1-score': 0.4512719837261874, 'support': 167458}, '2': {'precision': 0.35905787584274584, 'recall': 0.5723776955823854, 'f1-score': 0.44129025315434073, 'support': 143290}, 'accuracy': 0.381613246280619, 'macro avg': {'precision': 0.3966191736093701, 'recall': 0.3728716602353512, 'f1-score': 0.318644204920358, 'support': 452293}, 'weighted avg': {'precision': 0.39686349420300576, 'recall': 0.381613246280619, 'f1-score': 0.3267159658946905, 'support': 452293}}
[[ 4844 67807 68894]
 [ 4207 85741 77510]
 [ 2283 58991 82016]]
training model: results/AAPL/W0/deepOF_L2/seq2seq
Epoch 1/50
4812/4812 - 149s - loss: 12.6060 - accuracy10: 0.4631 - accuracy20: 0.4435 - accuracy30: 0.4280 - accuracy50: 0.4365 - val_loss: 12.8606 - val_accuracy10: 0.4302 - val_accuracy20: 0.4136 - val_accuracy30: 0.4029 - val_accuracy50: 0.3814 - 149s/epoch - 31ms/step
Epoch 2/50
4812/4812 - 149s - loss: 12.4529 - accuracy10: 0.4826 - accuracy20: 0.4588 - accuracy30: 0.4410 - accuracy50: 0.4459 - val_loss: 12.8033 - val_accuracy10: 0.4437 - val_accuracy20: 0.4213 - val_accuracy30: 0.4070 - val_accuracy50: 0.3862 - 149s/epoch - 31ms/step
Epoch 3/50
4812/4812 - 152s - loss: 12.3841 - accuracy10: 0.4914 - accuracy20: 0.4657 - accuracy30: 0.4465 - accuracy50: 0.4501 - val_loss: 12.7381 - val_accuracy10: 0.4505 - val_accuracy20: 0.4280 - val_accuracy30: 0.4130 - val_accuracy50: 0.3914 - 152s/epoch - 32ms/step
Epoch 4/50
4812/4812 - 146s - loss: 12.3428 - accuracy10: 0.4958 - accuracy20: 0.4694 - accuracy30: 0.4495 - accuracy50: 0.4525 - val_loss: 12.7340 - val_accuracy10: 0.4525 - val_accuracy20: 0.4286 - val_accuracy30: 0.4138 - val_accuracy50: 0.3933 - 146s/epoch - 30ms/step
Epoch 5/50
4812/4812 - 142s - loss: 12.3138 - accuracy10: 0.4985 - accuracy20: 0.4713 - accuracy30: 0.4512 - accuracy50: 0.4545 - val_loss: 12.7311 - val_accuracy10: 0.4529 - val_accuracy20: 0.4286 - val_accuracy30: 0.4147 - val_accuracy50: 0.3947 - 142s/epoch - 29ms/step
Epoch 6/50
4812/4812 - 143s - loss: 12.2924 - accuracy10: 0.5005 - accuracy20: 0.4733 - accuracy30: 0.4533 - accuracy50: 0.4562 - val_loss: 12.7009 - val_accuracy10: 0.4578 - val_accuracy20: 0.4321 - val_accuracy30: 0.4169 - val_accuracy50: 0.3955 - 143s/epoch - 30ms/step
Epoch 7/50
4812/4812 - 142s - loss: 12.2744 - accuracy10: 0.5024 - accuracy20: 0.4746 - accuracy30: 0.4543 - accuracy50: 0.4572 - val_loss: 12.7020 - val_accuracy10: 0.4585 - val_accuracy20: 0.4331 - val_accuracy30: 0.4181 - val_accuracy50: 0.3967 - 142s/epoch - 29ms/step
Epoch 8/50
4812/4812 - 143s - loss: 12.2567 - accuracy10: 0.5045 - accuracy20: 0.4765 - accuracy30: 0.4557 - accuracy50: 0.4584 - val_loss: 12.6972 - val_accuracy10: 0.4598 - val_accuracy20: 0.4337 - val_accuracy30: 0.4185 - val_accuracy50: 0.3968 - 143s/epoch - 30ms/step
Epoch 9/50
4812/4812 - 142s - loss: 12.2422 - accuracy10: 0.5057 - accuracy20: 0.4779 - accuracy30: 0.4570 - accuracy50: 0.4595 - val_loss: 12.6816 - val_accuracy10: 0.4620 - val_accuracy20: 0.4355 - val_accuracy30: 0.4202 - val_accuracy50: 0.3973 - 142s/epoch - 30ms/step
Epoch 10/50
4812/4812 - 142s - loss: 12.2283 - accuracy10: 0.5069 - accuracy20: 0.4786 - accuracy30: 0.4581 - accuracy50: 0.4607 - val_loss: 12.6776 - val_accuracy10: 0.4630 - val_accuracy20: 0.4357 - val_accuracy30: 0.4201 - val_accuracy50: 0.3979 - 142s/epoch - 29ms/step
Epoch 11/50
4812/4812 - 146s - loss: 12.2145 - accuracy10: 0.5080 - accuracy20: 0.4797 - accuracy30: 0.4593 - accuracy50: 0.4613 - val_loss: 12.6648 - val_accuracy10: 0.4650 - val_accuracy20: 0.4368 - val_accuracy30: 0.4217 - val_accuracy50: 0.3993 - 146s/epoch - 30ms/step
Epoch 12/50
4812/4812 - 144s - loss: 12.2035 - accuracy10: 0.5089 - accuracy20: 0.4806 - accuracy30: 0.4600 - accuracy50: 0.4622 - val_loss: 12.6572 - val_accuracy10: 0.4661 - val_accuracy20: 0.4390 - val_accuracy30: 0.4224 - val_accuracy50: 0.3998 - 144s/epoch - 30ms/step
Epoch 13/50
4812/4812 - 143s - loss: 12.1911 - accuracy10: 0.5099 - accuracy20: 0.4819 - accuracy30: 0.4615 - accuracy50: 0.4633 - val_loss: 12.6613 - val_accuracy10: 0.4655 - val_accuracy20: 0.4381 - val_accuracy30: 0.4222 - val_accuracy50: 0.4003 - 143s/epoch - 30ms/step
Epoch 14/50
4812/4812 - 146s - loss: 12.1838 - accuracy10: 0.5107 - accuracy20: 0.4824 - accuracy30: 0.4619 - accuracy50: 0.4635 - val_loss: 12.6448 - val_accuracy10: 0.4676 - val_accuracy20: 0.4398 - val_accuracy30: 0.4240 - val_accuracy50: 0.4018 - 146s/epoch - 30ms/step
Epoch 15/50
4812/4812 - 141s - loss: 12.1727 - accuracy10: 0.5118 - accuracy20: 0.4831 - accuracy30: 0.4628 - accuracy50: 0.4643 - val_loss: 12.6456 - val_accuracy10: 0.4682 - val_accuracy20: 0.4397 - val_accuracy30: 0.4239 - val_accuracy50: 0.4023 - 141s/epoch - 29ms/step
Epoch 16/50
4812/4812 - 147s - loss: 12.1640 - accuracy10: 0.5120 - accuracy20: 0.4838 - accuracy30: 0.4635 - accuracy50: 0.4652 - val_loss: 12.6396 - val_accuracy10: 0.4684 - val_accuracy20: 0.4402 - val_accuracy30: 0.4240 - val_accuracy50: 0.4025 - 147s/epoch - 31ms/step
Epoch 17/50
4812/4812 - 141s - loss: 12.1549 - accuracy10: 0.5132 - accuracy20: 0.4847 - accuracy30: 0.4644 - accuracy50: 0.4657 - val_loss: 12.6541 - val_accuracy10: 0.4680 - val_accuracy20: 0.4392 - val_accuracy30: 0.4239 - val_accuracy50: 0.4009 - 141s/epoch - 29ms/step
Epoch 18/50
4812/4812 - 141s - loss: 12.1461 - accuracy10: 0.5135 - accuracy20: 0.4852 - accuracy30: 0.4649 - accuracy50: 0.4663 - val_loss: 12.6460 - val_accuracy10: 0.4695 - val_accuracy20: 0.4405 - val_accuracy30: 0.4247 - val_accuracy50: 0.4016 - 141s/epoch - 29ms/step
Epoch 19/50
4812/4812 - 139s - loss: 12.1371 - accuracy10: 0.5144 - accuracy20: 0.4856 - accuracy30: 0.4655 - accuracy50: 0.4669 - val_loss: 12.6554 - val_accuracy10: 0.4679 - val_accuracy20: 0.4399 - val_accuracy30: 0.4242 - val_accuracy50: 0.4017 - 139s/epoch - 29ms/step
Epoch 20/50
4812/4812 - 139s - loss: 12.1294 - accuracy10: 0.5148 - accuracy20: 0.4868 - accuracy30: 0.4662 - accuracy50: 0.4677 - val_loss: 12.6566 - val_accuracy10: 0.4673 - val_accuracy20: 0.4398 - val_accuracy30: 0.4244 - val_accuracy50: 0.4017 - 139s/epoch - 29ms/step
Epoch 21/50
4812/4812 - 139s - loss: 12.1207 - accuracy10: 0.5158 - accuracy20: 0.4874 - accuracy30: 0.4674 - accuracy50: 0.4685 - val_loss: 12.6588 - val_accuracy10: 0.4685 - val_accuracy20: 0.4398 - val_accuracy30: 0.4241 - val_accuracy50: 0.4021 - 139s/epoch - 29ms/step
Epoch 22/50
4812/4812 - 140s - loss: 12.1134 - accuracy10: 0.5158 - accuracy20: 0.4881 - accuracy30: 0.4679 - accuracy50: 0.4692 - val_loss: 12.6651 - val_accuracy10: 0.4684 - val_accuracy20: 0.4408 - val_accuracy30: 0.4248 - val_accuracy50: 0.4005 - 140s/epoch - 29ms/step
Epoch 23/50
4812/4812 - 144s - loss: 12.1060 - accuracy10: 0.5167 - accuracy20: 0.4887 - accuracy30: 0.4688 - accuracy50: 0.4699 - val_loss: 12.6618 - val_accuracy10: 0.4686 - val_accuracy20: 0.4413 - val_accuracy30: 0.4247 - val_accuracy50: 0.4010 - 144s/epoch - 30ms/step
Epoch 24/50
4812/4812 - 141s - loss: 12.0980 - accuracy10: 0.5171 - accuracy20: 0.4895 - accuracy30: 0.4694 - accuracy50: 0.4704 - val_loss: 12.6672 - val_accuracy10: 0.4681 - val_accuracy20: 0.4404 - val_accuracy30: 0.4246 - val_accuracy50: 0.4016 - 141s/epoch - 29ms/step
Epoch 25/50
4812/4812 - 147s - loss: 12.0910 - accuracy10: 0.5177 - accuracy20: 0.4897 - accuracy30: 0.4701 - accuracy50: 0.4713 - val_loss: 12.6461 - val_accuracy10: 0.4700 - val_accuracy20: 0.4419 - val_accuracy30: 0.4266 - val_accuracy50: 0.4029 - 147s/epoch - 31ms/step
Epoch 26/50
4812/4812 - 142s - loss: 12.0818 - accuracy10: 0.5183 - accuracy20: 0.4908 - accuracy30: 0.4713 - accuracy50: 0.4722 - val_loss: 12.6693 - val_accuracy10: 0.4692 - val_accuracy20: 0.4412 - val_accuracy30: 0.4254 - val_accuracy50: 0.4014 - 142s/epoch - 30ms/step
testing model: results/AAPL/W0/deepOF_L2/seq2seq
Evaluating performance on  test set...
19053/19053 - 192s - 192s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9954907
{'0': {'precision': 0.38467728764081643, 'recall': 0.6321475225206096, 'f1-score': 0.47829831043065346, 'support': 1177366}, '1': {'precision': 0.6955258515990977, 'recall': 0.378581069116808, 'f1-score': 0.490291823687838, 'support': 2541350}, '2': {'precision': 0.4048043514786024, 'recall': 0.544771430790607, 'f1-score': 0.4644723462055224, 'support': 1158730}, 'accuracy': 0.479271118532117, 'macro avg': {'precision': 0.4950024969061722, 'recall': 0.5185000074760082, 'f1-score': 0.477687493441338, 'support': 4877446}, 'weighted avg': {'precision': 0.5514237427929874, 'recall': 0.479271118532117, 'f1-score': 0.4812628036079351, 'support': 4877446}}
[[744269 200277 232820]
 [883928 962107 695315]
 [306591 220896 631243]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0243399
{'0': {'precision': 0.37176417413391266, 'recall': 0.6448702871311655, 'f1-score': 0.47163396255619733, 'support': 1247409}, '1': {'precision': 0.6382539722724767, 'recall': 0.2735790112919483, 'f1-score': 0.382993144215704, 'support': 2395955}, '2': {'precision': 0.39989173928020255, 'recall': 0.5465479603462331, 'f1-score': 0.4618572415108306, 'support': 1234082}, 'accuracy': 0.4376029996026609, 'macro avg': {'precision': 0.46996996189553064, 'recall': 0.48833241958978224, 'f1-score': 0.438828116094244, 'support': 4877446}, 'weighted avg': {'precision': 0.5097891335388854, 'recall': 0.4376029996026609, 'f1-score': 0.4256171153439258, 'support': 4877446}}
[[804417 175264 267728]
 [996016 655483 744456]
 [363350 196247 674485]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0438988
{'0': {'precision': 0.36961485672423, 'recall': 0.6359651853798034, 'f1-score': 0.4675156049913644, 'support': 1316918}, '1': {'precision': 0.5554774076796306, 'recall': 0.22508392758993948, 'f1-score': 0.3203567252401247, 'support': 2259686}, '2': {'precision': 0.40182664826141745, 'recall': 0.5238568557903266, 'f1-score': 0.4547983054891407, 'support': 1300842}, 'accuracy': 0.4157069089027331, 'macro avg': {'precision': 0.44230630422175937, 'recall': 0.46163532292002313, 'f1-score': 0.41422354524020993, 'support': 4877446}, 'weighted avg': {'precision': 0.46431471719321804, 'recall': 0.4157069089027331, 'f1-score': 0.3959461693341308, 'support': 4877446}}
[[ 837514  195094  284310]
 [1020939  508619  730128]
 [ 407457  211930  681455]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0536809
{'0': {'precision': 0.320171008862992, 'recall': 0.6325703543542908, 'f1-score': 0.42515355446836905, 'support': 1133583}, '1': {'precision': 0.6276987928721978, 'recall': 0.24911523469283778, 'f1-score': 0.3566761643561187, 'support': 2630076}, '2': {'precision': 0.3481928436457808, 'recall': 0.4983161053235493, 'f1-score': 0.40994274651993906, 'support': 1113787}, 'accuracy': 0.3951414326268297, 'macro avg': {'precision': 0.43202088179365683, 'recall': 0.46000056479022594, 'f1-score': 0.3972574884481423, 'support': 4877446}, 'weighted avg': {'precision': 0.49239880991973645, 'recall': 0.3951414326268297, 'f1-score': 0.38475488261647667, 'support': 4877446}}
[[ 717071  185014  231498]
 [1167404  655192  807480]
 [ 355175  203594  555018]]
Evaluating performance on  train set...
4812/4812 - 48s - 48s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0120385
{'0': {'precision': 0.46116626563733726, 'recall': 0.6061158996176026, 'f1-score': 0.523798138992225, 'support': 406645}, '1': {'precision': 0.5344765110869539, 'recall': 0.22469011437205932, 'f1-score': 0.31637741802123137, 'support': 407005}, '2': {'precision': 0.4762049526227088, 'recall': 0.5992821908243806, 'f1-score': 0.5307011785830746, 'support': 418217}, 'accuracy': 0.4777739804702943, 'macro avg': {'precision': 0.4906159097823333, 'recall': 0.47669606827134753, 'f1-score': 0.45695891186551035, 'support': 1231867}, 'weighted avg': {'precision': 0.4904933528993407, 'recall': 0.4777739804702943, 'f1-score': 0.4576105537819442, 'support': 1231867}}
[[246474  37466 122705]
 [162583  91450 152972]
 [125401  42186 250630]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0398557
{'0': {'precision': 0.4395309322369637, 'recall': 0.6134543408115168, 'f1-score': 0.5121290206103081, 'support': 406917}, '1': {'precision': 0.4746433033334129, 'recall': 0.14669303093128322, 'f1-score': 0.22411972690962242, 'support': 406611}, '2': {'precision': 0.4563291315615914, 'recall': 0.5871458314907289, 'f1-score': 0.5135374721410322, 'support': 418339}, 'accuracy': 0.45045284921180617, 'macro avg': {'precision': 0.456834455710656, 'recall': 0.44909773441117623, 'f1-score': 0.4165954065536542, 'support': 1231867}, 'weighted avg': {'precision': 0.45682534651315077, 'recall': 0.45045284921180617, 'f1-score': 0.4175420751721902, 'support': 1231867}}
[[249625  31123 126169]
 [180494  59647 166470]
 [137816  34897 245626]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0550396
{'0': {'precision': 0.42590038314176243, 'recall': 0.6030012969784839, 'f1-score': 0.4992089883420191, 'support': 405558}, '1': {'precision': 0.42127681756238505, 'recall': 0.1389722753111228, 'f1-score': 0.2089991706088913, 'support': 407074}, '2': {'precision': 0.4464117849363751, 'recall': 0.5573079537729436, 'f1-score': 0.4957336770579717, 'support': 419235}, 'accuracy': 0.4341109876309699, 'macro avg': {'precision': 0.4311963285468409, 'recall': 0.4330938420208501, 'f1-score': 0.401313945336294, 'support': 1231867}, 'weighted avg': {'precision': 0.4313530531107647, 'recall': 0.4341109876309699, 'f1-score': 0.40212558285257677, 'support': 1231867}}
[[244552  36466 124540]
 [185305  56572 165197]
 [144343  41249 233643]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0699456
{'0': {'precision': 0.41647767740854286, 'recall': 0.5631098807453784, 'f1-score': 0.4788192608338263, 'support': 406022}, '1': {'precision': 0.37454169003148857, 'recall': 0.1922657724263322, 'f1-score': 0.25409526906194113, 'support': 406453}, '2': {'precision': 0.4375146284531057, 'recall': 0.49474000457805584, 'f1-score': 0.46437095963806413, 'support': 419392}, 'accuracy': 0.4174736396055743, 'macro avg': {'precision': 0.40951133196437906, 'recall': 0.41670521924992215, 'f1-score': 0.39909516317794386, 'support': 1231867}, 'weighted avg': {'precision': 0.4098030291673897, 'recall': 0.4174736396055743, 'f1-score': 0.3997528985051405, 'support': 1231867}}
[[228635  61795 115592]
 [177141  78147 151165]
 [143197  68705 207490]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0226252
{'0': {'precision': 0.45774497274458154, 'recall': 0.5936810770583858, 'f1-score': 0.516925614479478, 'support': 147810}, '1': {'precision': 0.5425190396502851, 'recall': 0.20651707596105096, 'f1-score': 0.2991563247396471, 'support': 153842}, '2': {'precision': 0.4571144308158356, 'recall': 0.6130402745600467, 'f1-score': 0.5237178414765205, 'support': 150641}, 'accuracy': 0.4684397061197056, 'macro avg': {'precision': 0.4857928144035674, 'recall': 0.47107947585982785, 'f1-score': 0.44659992689854855, 'support': 452293}, 'weighted avg': {'precision': 0.48636983878102047, 'recall': 0.4684397061197056, 'f1-score': 0.4451162448781497, 'support': 452293}}
[[87752 12878 47180]
 [59574 31771 62497]
 [44379 13913 92349]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0490254
{'0': {'precision': 0.4361223894326111, 'recall': 0.5966159716396504, 'f1-score': 0.503898359803325, 'support': 147812}, '1': {'precision': 0.4922721218365962, 'recall': 0.12701500473355898, 'f1-score': 0.20192877650005925, 'support': 154218}, '2': {'precision': 0.4351743978696593, 'recall': 0.6090321636064766, 'f1-score': 0.5076298404140249, 'support': 150263}, 'accuracy': 0.44062145556088644, 'macro avg': {'precision': 0.4545229697129556, 'recall': 0.4442210466598953, 'f1-score': 0.404485658905803, 'support': 452293}, 'weighted avg': {'precision': 0.4549527745494578, 'recall': 0.44062145556088644, 'f1-score': 0.4021757115932987, 'support': 452293}}
[[88187  9652 49973]
 [65823 19588 68807]
 [48197 10551 91515]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0618018
{'0': {'precision': 0.4213967717185736, 'recall': 0.5856146474970627, 'f1-score': 0.49011583626050087, 'support': 147247}, '1': {'precision': 0.437749900039984, 'recall': 0.11313260482058436, 'f1-score': 0.17979800053373843, 'support': 154836}, '2': {'precision': 0.423649637848667, 'recall': 0.5856467612009852, 'f1-score': 0.49164752499594816, 'support': 150210}, 'accuracy': 0.4238778844686962, 'macro avg': {'precision': 0.42759876986907486, 'recall': 0.4281313378395441, 'f1-score': 0.38718712059672916, 'support': 452293}, 'weighted avg': {'precision': 0.42774322412481297, 'recall': 0.4238778844686962, 'f1-score': 0.38439167637379595, 'support': 452293}}
[[86230 10853 50164]
 [67805 17517 69514]
 [50594 11646 87970]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0755963
{'0': {'precision': 0.3971298161098685, 'recall': 0.5538461538461539, 'f1-score': 0.46257492971195163, 'support': 141700}, '1': {'precision': 0.4241698212659926, 'recall': 0.15869297606100083, 'f1-score': 0.23097295487260222, 'support': 167342}, '2': {'precision': 0.40045192327717266, 'recall': 0.5369177178518824, 'f1-score': 0.45875121898848553, 'support': 143251}, 'accuracy': 0.4022834755346645, 'macro avg': {'precision': 0.40725052021767794, 'recall': 0.41648561591967903, 'f1-score': 0.38409970119101317, 'support': 452293}, 'weighted avg': {'precision': 0.4081864181723802, 'recall': 0.4022834755346645, 'f1-score': 0.37567442924341987, 'support': 452293}}
[[78480 17578 45642]
 [71274 26556 69512]
 [47864 18473 76914]]
training model: results/AAPL/W0/deepVOL_L2/seq2seq
Epoch 1/50
4812/4812 - 146s - loss: 12.8007 - accuracy10: 0.4336 - accuracy20: 0.4215 - accuracy30: 0.4110 - accuracy50: 0.4217 - val_loss: 13.0968 - val_accuracy10: 0.4062 - val_accuracy20: 0.3983 - val_accuracy30: 0.3904 - val_accuracy50: 0.3646 - 146s/epoch - 30ms/step
Epoch 2/50
4812/4812 - 138s - loss: 12.6969 - accuracy10: 0.4521 - accuracy20: 0.4359 - accuracy30: 0.4220 - accuracy50: 0.4291 - val_loss: 12.9921 - val_accuracy10: 0.4253 - val_accuracy20: 0.4114 - val_accuracy30: 0.4013 - val_accuracy50: 0.3735 - 138s/epoch - 29ms/step
Epoch 3/50
4812/4812 - 139s - loss: 12.5899 - accuracy10: 0.4676 - accuracy20: 0.4481 - accuracy30: 0.4319 - accuracy50: 0.4377 - val_loss: 12.9014 - val_accuracy10: 0.4291 - val_accuracy20: 0.4120 - val_accuracy30: 0.4020 - val_accuracy50: 0.3795 - 139s/epoch - 29ms/step
Epoch 4/50
4812/4812 - 141s - loss: 12.5173 - accuracy10: 0.4772 - accuracy20: 0.4562 - accuracy30: 0.4386 - accuracy50: 0.4426 - val_loss: 12.8336 - val_accuracy10: 0.4411 - val_accuracy20: 0.4202 - val_accuracy30: 0.4091 - val_accuracy50: 0.3891 - 141s/epoch - 29ms/step
Epoch 5/50
4812/4812 - 140s - loss: 12.4694 - accuracy10: 0.4824 - accuracy20: 0.4603 - accuracy30: 0.4417 - accuracy50: 0.4453 - val_loss: 12.7802 - val_accuracy10: 0.4519 - val_accuracy20: 0.4299 - val_accuracy30: 0.4149 - val_accuracy50: 0.3932 - 140s/epoch - 29ms/step
Epoch 6/50
4812/4812 - 136s - loss: 12.4267 - accuracy10: 0.4871 - accuracy20: 0.4645 - accuracy30: 0.4457 - accuracy50: 0.4490 - val_loss: 12.7469 - val_accuracy10: 0.4586 - val_accuracy20: 0.4343 - val_accuracy30: 0.4178 - val_accuracy50: 0.3963 - 136s/epoch - 28ms/step
Epoch 7/50
4812/4812 - 134s - loss: 12.3908 - accuracy10: 0.4910 - accuracy20: 0.4673 - accuracy30: 0.4480 - accuracy50: 0.4509 - val_loss: 12.6919 - val_accuracy10: 0.4637 - val_accuracy20: 0.4380 - val_accuracy30: 0.4209 - val_accuracy50: 0.4004 - 134s/epoch - 28ms/step
Epoch 8/50
4812/4812 - 136s - loss: 12.3576 - accuracy10: 0.4942 - accuracy20: 0.4699 - accuracy30: 0.4503 - accuracy50: 0.4527 - val_loss: 12.6626 - val_accuracy10: 0.4671 - val_accuracy20: 0.4402 - val_accuracy30: 0.4213 - val_accuracy50: 0.4014 - 136s/epoch - 28ms/step
Epoch 9/50
4812/4812 - 136s - loss: 12.3284 - accuracy10: 0.4971 - accuracy20: 0.4721 - accuracy30: 0.4523 - accuracy50: 0.4548 - val_loss: 12.6473 - val_accuracy10: 0.4689 - val_accuracy20: 0.4421 - val_accuracy30: 0.4247 - val_accuracy50: 0.4050 - 136s/epoch - 28ms/step
Epoch 10/50
4812/4812 - 136s - loss: 12.3052 - accuracy10: 0.4992 - accuracy20: 0.4740 - accuracy30: 0.4538 - accuracy50: 0.4564 - val_loss: 12.6394 - val_accuracy10: 0.4682 - val_accuracy20: 0.4427 - val_accuracy30: 0.4263 - val_accuracy50: 0.4075 - 136s/epoch - 28ms/step
Epoch 11/50
4812/4812 - 137s - loss: 12.2865 - accuracy10: 0.5009 - accuracy20: 0.4752 - accuracy30: 0.4551 - accuracy50: 0.4571 - val_loss: 12.6404 - val_accuracy10: 0.4705 - val_accuracy20: 0.4427 - val_accuracy30: 0.4250 - val_accuracy50: 0.4048 - 137s/epoch - 29ms/step
Epoch 12/50
4812/4812 - 139s - loss: 12.2695 - accuracy10: 0.5030 - accuracy20: 0.4768 - accuracy30: 0.4565 - accuracy50: 0.4577 - val_loss: 12.6093 - val_accuracy10: 0.4724 - val_accuracy20: 0.4459 - val_accuracy30: 0.4275 - val_accuracy50: 0.4078 - 139s/epoch - 29ms/step
Epoch 13/50
4812/4812 - 140s - loss: 12.2541 - accuracy10: 0.5038 - accuracy20: 0.4775 - accuracy30: 0.4572 - accuracy50: 0.4587 - val_loss: 12.6044 - val_accuracy10: 0.4741 - val_accuracy20: 0.4465 - val_accuracy30: 0.4275 - val_accuracy50: 0.4068 - 140s/epoch - 29ms/step
Epoch 14/50
4812/4812 - 136s - loss: 12.2417 - accuracy10: 0.5051 - accuracy20: 0.4792 - accuracy30: 0.4584 - accuracy50: 0.4595 - val_loss: 12.5642 - val_accuracy10: 0.4775 - val_accuracy20: 0.4500 - val_accuracy30: 0.4309 - val_accuracy50: 0.4098 - 136s/epoch - 28ms/step
Epoch 15/50
4812/4812 - 138s - loss: 12.2283 - accuracy10: 0.5064 - accuracy20: 0.4799 - accuracy30: 0.4592 - accuracy50: 0.4605 - val_loss: 12.5736 - val_accuracy10: 0.4770 - val_accuracy20: 0.4486 - val_accuracy30: 0.4296 - val_accuracy50: 0.4090 - 138s/epoch - 29ms/step
Epoch 16/50
4812/4812 - 137s - loss: 12.2167 - accuracy10: 0.5073 - accuracy20: 0.4806 - accuracy30: 0.4597 - accuracy50: 0.4608 - val_loss: 12.5387 - val_accuracy10: 0.4810 - val_accuracy20: 0.4529 - val_accuracy30: 0.4325 - val_accuracy50: 0.4098 - 137s/epoch - 29ms/step
Epoch 17/50
4812/4812 - 136s - loss: 12.2064 - accuracy10: 0.5083 - accuracy20: 0.4819 - accuracy30: 0.4611 - accuracy50: 0.4613 - val_loss: 12.5354 - val_accuracy10: 0.4813 - val_accuracy20: 0.4527 - val_accuracy30: 0.4324 - val_accuracy50: 0.4116 - 136s/epoch - 28ms/step
Epoch 18/50
4812/4812 - 136s - loss: 12.1975 - accuracy10: 0.5090 - accuracy20: 0.4825 - accuracy30: 0.4612 - accuracy50: 0.4626 - val_loss: 12.5274 - val_accuracy10: 0.4836 - val_accuracy20: 0.4542 - val_accuracy30: 0.4336 - val_accuracy50: 0.4121 - 136s/epoch - 28ms/step
Epoch 19/50
4812/4812 - 138s - loss: 12.1887 - accuracy10: 0.5095 - accuracy20: 0.4830 - accuracy30: 0.4621 - accuracy50: 0.4630 - val_loss: 12.5208 - val_accuracy10: 0.4834 - val_accuracy20: 0.4548 - val_accuracy30: 0.4344 - val_accuracy50: 0.4114 - 138s/epoch - 29ms/step
Epoch 20/50
4812/4812 - 136s - loss: 12.1798 - accuracy10: 0.5105 - accuracy20: 0.4838 - accuracy30: 0.4627 - accuracy50: 0.4634 - val_loss: 12.5145 - val_accuracy10: 0.4839 - val_accuracy20: 0.4548 - val_accuracy30: 0.4343 - val_accuracy50: 0.4124 - 136s/epoch - 28ms/step
Epoch 21/50
4812/4812 - 138s - loss: 12.1707 - accuracy10: 0.5114 - accuracy20: 0.4844 - accuracy30: 0.4637 - accuracy50: 0.4645 - val_loss: 12.5017 - val_accuracy10: 0.4867 - val_accuracy20: 0.4566 - val_accuracy30: 0.4351 - val_accuracy50: 0.4109 - 138s/epoch - 29ms/step
Epoch 22/50
4812/4812 - 136s - loss: 12.1628 - accuracy10: 0.5117 - accuracy20: 0.4850 - accuracy30: 0.4641 - accuracy50: 0.4649 - val_loss: 12.5083 - val_accuracy10: 0.4846 - val_accuracy20: 0.4558 - val_accuracy30: 0.4353 - val_accuracy50: 0.4141 - 136s/epoch - 28ms/step
Epoch 23/50
4812/4812 - 138s - loss: 12.1553 - accuracy10: 0.5123 - accuracy20: 0.4856 - accuracy30: 0.4647 - accuracy50: 0.4655 - val_loss: 12.4925 - val_accuracy10: 0.4865 - val_accuracy20: 0.4569 - val_accuracy30: 0.4366 - val_accuracy50: 0.4131 - 138s/epoch - 29ms/step
Epoch 24/50
4812/4812 - 140s - loss: 12.1471 - accuracy10: 0.5131 - accuracy20: 0.4860 - accuracy30: 0.4656 - accuracy50: 0.4661 - val_loss: 12.4976 - val_accuracy10: 0.4860 - val_accuracy20: 0.4564 - val_accuracy30: 0.4356 - val_accuracy50: 0.4127 - 140s/epoch - 29ms/step
Epoch 25/50
4812/4812 - 141s - loss: 12.1412 - accuracy10: 0.5132 - accuracy20: 0.4865 - accuracy30: 0.4661 - accuracy50: 0.4668 - val_loss: 12.4945 - val_accuracy10: 0.4860 - val_accuracy20: 0.4558 - val_accuracy30: 0.4356 - val_accuracy50: 0.4146 - 141s/epoch - 29ms/step
Epoch 26/50
4812/4812 - 140s - loss: 12.1341 - accuracy10: 0.5141 - accuracy20: 0.4873 - accuracy30: 0.4665 - accuracy50: 0.4673 - val_loss: 12.4879 - val_accuracy10: 0.4869 - val_accuracy20: 0.4572 - val_accuracy30: 0.4363 - val_accuracy50: 0.4152 - 140s/epoch - 29ms/step
Epoch 27/50
4812/4812 - 140s - loss: 12.1266 - accuracy10: 0.5148 - accuracy20: 0.4880 - accuracy30: 0.4676 - accuracy50: 0.4680 - val_loss: 12.5070 - val_accuracy10: 0.4862 - val_accuracy20: 0.4555 - val_accuracy30: 0.4347 - val_accuracy50: 0.4134 - 140s/epoch - 29ms/step
Epoch 28/50
4812/4812 - 138s - loss: 12.1199 - accuracy10: 0.5152 - accuracy20: 0.4882 - accuracy30: 0.4682 - accuracy50: 0.4687 - val_loss: 12.4932 - val_accuracy10: 0.4856 - val_accuracy20: 0.4565 - val_accuracy30: 0.4363 - val_accuracy50: 0.4144 - 138s/epoch - 29ms/step
Epoch 29/50
4812/4812 - 140s - loss: 12.1128 - accuracy10: 0.5159 - accuracy20: 0.4893 - accuracy30: 0.4687 - accuracy50: 0.4696 - val_loss: 12.5017 - val_accuracy10: 0.4866 - val_accuracy20: 0.4572 - val_accuracy30: 0.4350 - val_accuracy50: 0.4131 - 140s/epoch - 29ms/step
Epoch 30/50
4812/4812 - 136s - loss: 12.1089 - accuracy10: 0.5157 - accuracy20: 0.4892 - accuracy30: 0.4687 - accuracy50: 0.4694 - val_loss: 12.5083 - val_accuracy10: 0.4865 - val_accuracy20: 0.4555 - val_accuracy30: 0.4348 - val_accuracy50: 0.4137 - 136s/epoch - 28ms/step
Epoch 31/50
4812/4812 - 139s - loss: 12.1014 - accuracy10: 0.5165 - accuracy20: 0.4902 - accuracy30: 0.4700 - accuracy50: 0.4705 - val_loss: 12.5144 - val_accuracy10: 0.4854 - val_accuracy20: 0.4550 - val_accuracy30: 0.4344 - val_accuracy50: 0.4120 - 139s/epoch - 29ms/step
Epoch 32/50
4812/4812 - 136s - loss: 12.0945 - accuracy10: 0.5168 - accuracy20: 0.4901 - accuracy30: 0.4708 - accuracy50: 0.4709 - val_loss: 12.5012 - val_accuracy10: 0.4874 - val_accuracy20: 0.4561 - val_accuracy30: 0.4349 - val_accuracy50: 0.4147 - 136s/epoch - 28ms/step
Epoch 33/50
4812/4812 - 137s - loss: 12.0891 - accuracy10: 0.5169 - accuracy20: 0.4910 - accuracy30: 0.4712 - accuracy50: 0.4713 - val_loss: 12.5071 - val_accuracy10: 0.4862 - val_accuracy20: 0.4560 - val_accuracy30: 0.4349 - val_accuracy50: 0.4150 - 137s/epoch - 28ms/step
Epoch 34/50
4812/4812 - 136s - loss: 12.0818 - accuracy10: 0.5172 - accuracy20: 0.4912 - accuracy30: 0.4716 - accuracy50: 0.4726 - val_loss: 12.5047 - val_accuracy10: 0.4868 - val_accuracy20: 0.4558 - val_accuracy30: 0.4352 - val_accuracy50: 0.4166 - 136s/epoch - 28ms/step
Epoch 35/50
4812/4812 - 137s - loss: 12.0759 - accuracy10: 0.5180 - accuracy20: 0.4918 - accuracy30: 0.4722 - accuracy50: 0.4730 - val_loss: 12.5063 - val_accuracy10: 0.4864 - val_accuracy20: 0.4560 - val_accuracy30: 0.4345 - val_accuracy50: 0.4141 - 137s/epoch - 28ms/step
Epoch 36/50
4812/4812 - 137s - loss: 12.0712 - accuracy10: 0.5174 - accuracy20: 0.4921 - accuracy30: 0.4727 - accuracy50: 0.4737 - val_loss: 12.5053 - val_accuracy10: 0.4865 - val_accuracy20: 0.4565 - val_accuracy30: 0.4352 - val_accuracy50: 0.4135 - 137s/epoch - 29ms/step
testing model: results/AAPL/W0/deepVOL_L2/seq2seq
Evaluating performance on  test set...
19053/19053 - 172s - 172s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9566999
{'0': {'precision': 0.45213529638704003, 'recall': 0.49670409192020515, 'f1-score': 0.47337295349353004, 'support': 1177369}, '1': {'precision': 0.6831416943981528, 'recall': 0.5145542666085873, 'f1-score': 0.5869828153303943, 'support': 2541351}, '2': {'precision': 0.4102186205335381, 'recall': 0.5911613653212006, 'f1-score': 0.48434241390952654, 'support': 1158731}, 'accuracy': 0.5284448782776086, 'macro avg': {'precision': 0.5151652037729103, 'recall': 0.5341399079499977, 'f1-score': 0.5148993942444836, 'support': 4877451}, 'weighted avg': {'precision': 0.5625409547654707, 'recall': 0.5284448782776086, 'f1-score': 0.5351743308577035, 'support': 4877451}}
[[ 584804  347254  245311]
 [ 494162 1307663  739526]
 [ 214461  259273  684997]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.992868
{'0': {'precision': 0.43130513431692197, 'recall': 0.5252551083804776, 'f1-score': 0.47366640376325386, 'support': 1247411}, '1': {'precision': 0.643378851927886, 'recall': 0.39816198704734684, 'f1-score': 0.491903903374334, 'support': 2395957}, '2': {'precision': 0.39890357845886765, 'recall': 0.6062525778249923, 'f1-score': 0.4811915466714946, 'support': 1234083}, 'accuracy': 0.4833167980570179, 'macro avg': {'precision': 0.4911958549012252, 'recall': 0.5098898910842723, 'f1-score': 0.48225395126969417, 'support': 4877451}, 'weighted avg': {'precision': 0.5272842223627142, 'recall': 0.4833167980570179, 'f1-score': 0.48452923268583964, 'support': 4877451}}
[[655209 298055 294147]
 [608735 953979 833243]
 [255187 230730 748166]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0271958
{'0': {'precision': 0.41190189062278104, 'recall': 0.5374020725648274, 'f1-score': 0.46635627427651893, 'support': 1316919}, '1': {'precision': 0.5685355242832866, 'recall': 0.2926929325230153, 'f1-score': 0.386439459892142, 'support': 2259689}, '2': {'precision': 0.38942491718254313, 'recall': 0.5975163797629691, 'f1-score': 0.471533144726142, 'support': 1300843}, 'accuracy': 0.4400628525022599, 'macro avg': {'precision': 0.45662077736287027, 'recall': 0.4758704616169373, 'f1-score': 0.44144295963160096, 'support': 4877451}, 'weighted avg': {'precision': 0.47847442727189443, 'recall': 0.4400628525022599, 'f1-score': 0.4307120718656451, 'support': 4877451}}
[[707715 278296 330908]
 [710521 661395 887773]
 [299928 223640 777275]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.042181
{'0': {'precision': 0.3460050428759326, 'recall': 0.5314286369602959, 'f1-score': 0.419124527682288, 'support': 1133584}, '1': {'precision': 0.6119163077866066, 'recall': 0.2915175899726168, 'f1-score': 0.3949029757535958, 'support': 2630078}, '2': {'precision': 0.32756400760535814, 'recall': 0.5539083255446049, 'f1-score': 0.4116758385665545, 'support': 1113789}, 'accuracy': 0.4071942496193196, 'macro avg': {'precision': 0.42849511942263246, 'recall': 0.45895151749250584, 'f1-score': 0.4085677806674794, 'support': 4877451}, 'weighted avg': {'precision': 0.4851818271349149, 'recall': 0.4071942496193196, 'f1-score': 0.4043625467100476, 'support': 4877451}}
[[602419 252216 278949]
 [875841 766714 987523]
 [262810 234042 616937]]
Evaluating performance on  train set...
4812/4812 - 44s - 44s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99961036
{'0': {'precision': 0.48540539178316944, 'recall': 0.568274854879515, 'f1-score': 0.5235813795446824, 'support': 406731}, '1': {'precision': 0.5377214571076986, 'recall': 0.31366567271314894, 'f1-score': 0.3962116801353858, 'support': 406793}, '2': {'precision': 0.48346955191577273, 'recall': 0.5991098234945403, 'f1-score': 0.535113386588325, 'support': 418344}, 'accuracy': 0.49466825991096447, 'macro avg': {'precision': 0.5021988002688803, 'recall': 0.49368345036240147, 'f1-score': 0.48496881542279774, 'support': 1231868}, 'weighted avg': {'precision': 0.5020240247601402, 'recall': 0.49466825991096447, 'f1-score': 0.4854370684844549, 'support': 1231868}}
[[231135  57540 118056]
 [129479 127597 149717]
 [115555  52155 250634]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0275328
{'0': {'precision': 0.4576702638907102, 'recall': 0.583446831316593, 'f1-score': 0.5129610616982416, 'support': 406762}, '1': {'precision': 0.4860748114730902, 'recall': 0.21528952025167125, 'f1-score': 0.2984092809827404, 'support': 406880}, '2': {'precision': 0.46347918898082374, 'recall': 0.5907906251643849, 'f1-score': 0.5194479745788279, 'support': 418226}, 'accuracy': 0.4643395233904931, 'macro avg': {'precision': 0.4690747547815414, 'recall': 0.463175658910883, 'f1-score': 0.4436061057532699, 'support': 1231868}, 'weighted avg': {'precision': 0.469024309799084, 'recall': 0.4643395233904931, 'f1-score': 0.4442979964094874, 'support': 1231868}}
[[237324  48121 121317]
 [154577  87597 164706]
 [126647  44495 247084]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0459965
{'0': {'precision': 0.43800941572775265, 'recall': 0.5824531457353862, 'f1-score': 0.5000084700541235, 'support': 405406}, '1': {'precision': 0.4340866957148086, 'recall': 0.1805672212152916, 'f1-score': 0.25504377749101553, 'support': 407178}, '2': {'precision': 0.4522388401898371, 'recall': 0.5645338243290944, 'f1-score': 0.5021852590486697, 'support': 419284}, 'accuracy': 0.4435158637126705, 'macro avg': {'precision': 0.4414449838774661, 'recall': 0.44251806375992403, 'f1-score': 0.41907916886460295, 'support': 1231868}, 'weighted avg': {'precision': 0.4415560008462313, 'recall': 0.4435158637126705, 'f1-score': 0.4197794676028285, 'support': 1231868}}
[[236130  48422 120854]
 [167813  73523 165842]
 [135155  47429 236700]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.061373
{'0': {'precision': 0.4262040353192792, 'recall': 0.5385214180315956, 'f1-score': 0.4758244963346045, 'support': 405943}, '1': {'precision': 0.3918221102042795, 'recall': 0.258528353222779, 'f1-score': 0.3115155000385352, 'support': 406497}, '2': {'precision': 0.4476833445742075, 'recall': 0.48110045109053284, 'f1-score': 0.46379073370077367, 'support': 419428}, 'accuracy': 0.42657736056135886, 'macro avg': {'precision': 0.42190316336592204, 'recall': 0.42605007411496915, 'f1-score': 0.4170435766913045, 'support': 1231868}, 'weighted avg': {'precision': 0.42217184543262254, 'recall': 0.42657736056135886, 'f1-score': 0.41750784953369263, 'support': 1231868}}
[[218609  79658 107676]
 [160133 105091 141273]
 [134179  83462 201787]]
Evaluating performance on  val set...
1767/1767 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0088867
{'0': {'precision': 0.47964806000288474, 'recall': 0.5631613174188129, 'f1-score': 0.5180606143693507, 'support': 147622}, '1': {'precision': 0.5391634093693484, 'recall': 0.3002904842053275, 'f1-score': 0.38574040219378436, 'support': 153881}, '2': {'precision': 0.47025038419149034, 'recall': 0.602705749718151, 'f1-score': 0.5283023255138016, 'support': 150790}, 'accuracy': 0.48691003398239635, 'macro avg': {'precision': 0.49635395118790776, 'recall': 0.4887191837807638, 'f1-score': 0.4773677806923122, 'support': 452293}, 'weighted avg': {'precision': 0.4967635270568976, 'recall': 0.48691003398239635, 'f1-score': 0.476456567996056, 'support': 452293}}
[[83135 21061 43426]
 [48717 46209 58955]
 [41473 18435 90882]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0349978
{'0': {'precision': 0.45344889158951235, 'recall': 0.5763178039874537, 'f1-score': 0.5075531584850727, 'support': 147613}, '1': {'precision': 0.4910405197261068, 'recall': 0.20872524551907432, 'f1-score': 0.2929338876809287, 'support': 154265}, '2': {'precision': 0.4493267506742538, 'recall': 0.5947877538809294, 'f1-score': 0.5119247891418043, 'support': 150415}, 'accuracy': 0.45708423521920527, 'macro avg': {'precision': 0.46460538732995765, 'recall': 0.4599436011291525, 'f1-score': 0.43747061176926855, 'support': 452293}, 'weighted avg': {'precision': 0.46489952356640146, 'recall': 0.45708423521920527, 'f1-score': 0.4358061206459529, 'support': 452293}}
[[85072 17548 44993]
 [57415 32199 64651]
 [45124 15826 89465]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0512615
{'0': {'precision': 0.43403388431883233, 'recall': 0.5715556702571277, 'f1-score': 0.493391218190932, 'support': 147242}, '1': {'precision': 0.44005081784976974, 'recall': 0.17917879081797608, 'f1-score': 0.25466409337377083, 'support': 154650}, '2': {'precision': 0.4377724788668973, 'recall': 0.5688326540382045, 'f1-score': 0.4947705368838356, 'support': 150401}, 'accuracy': 0.43648696751884286, 'macro avg': {'precision': 0.4372857270118331, 'recall': 0.43985570503776944, 'f1-score': 0.4142752828161795, 'support': 452293}, 'weighted avg': {'precision': 0.4373344154550272, 'recall': 0.43648696751884286, 'f1-score': 0.4122232608220525, 'support': 452293}}
[[84157 18012 45073]
 [62138 27710 64802]
 [47600 17248 85553]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0641437
{'0': {'precision': 0.4071254067200561, 'recall': 0.5250909604719347, 'f1-score': 0.4586443198612787, 'support': 141545}, '1': {'precision': 0.42981482563233836, 'recall': 0.2636362550609705, 'f1-score': 0.3268140295811557, 'support': 167458}, '2': {'precision': 0.41504361726968464, 'recall': 0.483781143136297, 'f1-score': 0.4467840327929078, 'support': 143290}, 'accuracy': 0.41520209244892137, 'macro avg': {'precision': 0.4173279498740263, 'recall': 0.4241694528897341, 'f1-score': 0.41074746074511403, 'support': 452293}, 'weighted avg': {'precision': 0.4180345410685188, 'recall': 0.41520209244892137, 'f1-score': 0.40607773739425906, 'support': 452293}}
[[74324 28811 38410]
 [64020 44148 59290]
 [44214 29755 69321]]
training model: results/AAPL/W0/deepVOL_L3/seq2seq
Epoch 1/50
4812/4812 - 211s - loss: 12.7742 - accuracy10: 0.4347 - accuracy20: 0.4244 - accuracy30: 0.4154 - accuracy50: 0.4265 - val_loss: 13.0283 - val_accuracy10: 0.4151 - val_accuracy20: 0.4102 - val_accuracy30: 0.4033 - val_accuracy50: 0.3775 - 211s/epoch - 44ms/step
Epoch 2/50
4812/4812 - 204s - loss: 12.6168 - accuracy10: 0.4585 - accuracy20: 0.4438 - accuracy30: 0.4314 - accuracy50: 0.4376 - val_loss: 12.9477 - val_accuracy10: 0.4243 - val_accuracy20: 0.4169 - val_accuracy30: 0.4089 - val_accuracy50: 0.3822 - 204s/epoch - 42ms/step
Epoch 3/50
4812/4812 - 205s - loss: 12.5333 - accuracy10: 0.4720 - accuracy20: 0.4539 - accuracy30: 0.4377 - accuracy50: 0.4428 - val_loss: 12.8068 - val_accuracy10: 0.4434 - val_accuracy20: 0.4270 - val_accuracy30: 0.4137 - val_accuracy50: 0.3858 - 205s/epoch - 43ms/step
Epoch 4/50
4812/4812 - 205s - loss: 12.4703 - accuracy10: 0.4812 - accuracy20: 0.4598 - accuracy30: 0.4424 - accuracy50: 0.4464 - val_loss: 12.7367 - val_accuracy10: 0.4522 - val_accuracy20: 0.4326 - val_accuracy30: 0.4179 - val_accuracy50: 0.3937 - 205s/epoch - 43ms/step
Epoch 5/50
4812/4812 - 210s - loss: 12.4240 - accuracy10: 0.4863 - accuracy20: 0.4636 - accuracy30: 0.4457 - accuracy50: 0.4484 - val_loss: 12.6849 - val_accuracy10: 0.4619 - val_accuracy20: 0.4382 - val_accuracy30: 0.4216 - val_accuracy50: 0.4021 - 210s/epoch - 44ms/step
Epoch 6/50
4812/4812 - 209s - loss: 12.3881 - accuracy10: 0.4911 - accuracy20: 0.4668 - accuracy30: 0.4476 - accuracy50: 0.4502 - val_loss: 12.6714 - val_accuracy10: 0.4650 - val_accuracy20: 0.4406 - val_accuracy30: 0.4238 - val_accuracy50: 0.4052 - 209s/epoch - 43ms/step
Epoch 7/50
4812/4812 - 209s - loss: 12.3591 - accuracy10: 0.4944 - accuracy20: 0.4692 - accuracy30: 0.4500 - accuracy50: 0.4518 - val_loss: 12.5878 - val_accuracy10: 0.4753 - val_accuracy20: 0.4480 - val_accuracy30: 0.4293 - val_accuracy50: 0.4104 - 209s/epoch - 43ms/step
Epoch 8/50
4812/4812 - 211s - loss: 12.3357 - accuracy10: 0.4972 - accuracy20: 0.4710 - accuracy30: 0.4512 - accuracy50: 0.4526 - val_loss: 12.5603 - val_accuracy10: 0.4796 - val_accuracy20: 0.4515 - val_accuracy30: 0.4318 - val_accuracy50: 0.4131 - 211s/epoch - 44ms/step
Epoch 9/50
4812/4812 - 208s - loss: 12.3105 - accuracy10: 0.5000 - accuracy20: 0.4731 - accuracy30: 0.4529 - accuracy50: 0.4540 - val_loss: 12.5219 - val_accuracy10: 0.4839 - val_accuracy20: 0.4547 - val_accuracy30: 0.4332 - val_accuracy50: 0.4152 - 208s/epoch - 43ms/step
Epoch 10/50
4812/4812 - 211s - loss: 12.2866 - accuracy10: 0.5026 - accuracy20: 0.4752 - accuracy30: 0.4543 - accuracy50: 0.4553 - val_loss: 12.5154 - val_accuracy10: 0.4845 - val_accuracy20: 0.4556 - val_accuracy30: 0.4352 - val_accuracy50: 0.4175 - 211s/epoch - 44ms/step
Epoch 11/50
4812/4812 - 208s - loss: 12.2649 - accuracy10: 0.5047 - accuracy20: 0.4768 - accuracy30: 0.4559 - accuracy50: 0.4566 - val_loss: 12.5022 - val_accuracy10: 0.4846 - val_accuracy20: 0.4567 - val_accuracy30: 0.4363 - val_accuracy50: 0.4185 - 208s/epoch - 43ms/step
Epoch 12/50
4812/4812 - 208s - loss: 12.2447 - accuracy10: 0.5068 - accuracy20: 0.4785 - accuracy30: 0.4570 - accuracy50: 0.4574 - val_loss: 12.4772 - val_accuracy10: 0.4888 - val_accuracy20: 0.4597 - val_accuracy30: 0.4381 - val_accuracy50: 0.4193 - 208s/epoch - 43ms/step
Epoch 13/50
4812/4812 - 210s - loss: 12.2280 - accuracy10: 0.5083 - accuracy20: 0.4798 - accuracy30: 0.4582 - accuracy50: 0.4585 - val_loss: 12.4667 - val_accuracy10: 0.4907 - val_accuracy20: 0.4600 - val_accuracy30: 0.4381 - val_accuracy50: 0.4190 - 210s/epoch - 44ms/step
Epoch 14/50
4812/4812 - 213s - loss: 12.2125 - accuracy10: 0.5095 - accuracy20: 0.4810 - accuracy30: 0.4594 - accuracy50: 0.4598 - val_loss: 12.4661 - val_accuracy10: 0.4905 - val_accuracy20: 0.4608 - val_accuracy30: 0.4384 - val_accuracy50: 0.4200 - 213s/epoch - 44ms/step
Epoch 15/50
4812/4812 - 209s - loss: 12.1996 - accuracy10: 0.5107 - accuracy20: 0.4823 - accuracy30: 0.4604 - accuracy50: 0.4605 - val_loss: 12.4635 - val_accuracy10: 0.4904 - val_accuracy20: 0.4597 - val_accuracy30: 0.4377 - val_accuracy50: 0.4189 - 209s/epoch - 43ms/step
Epoch 16/50
4812/4812 - 209s - loss: 12.1876 - accuracy10: 0.5115 - accuracy20: 0.4831 - accuracy30: 0.4614 - accuracy50: 0.4617 - val_loss: 12.4584 - val_accuracy10: 0.4916 - val_accuracy20: 0.4617 - val_accuracy30: 0.4398 - val_accuracy50: 0.4192 - 209s/epoch - 43ms/step
Epoch 17/50
4812/4812 - 210s - loss: 12.1756 - accuracy10: 0.5127 - accuracy20: 0.4840 - accuracy30: 0.4619 - accuracy50: 0.4622 - val_loss: 12.4411 - val_accuracy10: 0.4936 - val_accuracy20: 0.4632 - val_accuracy30: 0.4414 - val_accuracy50: 0.4197 - 210s/epoch - 44ms/step
Epoch 18/50
4812/4812 - 207s - loss: 12.1666 - accuracy10: 0.5139 - accuracy20: 0.4850 - accuracy30: 0.4627 - accuracy50: 0.4626 - val_loss: 12.4518 - val_accuracy10: 0.4923 - val_accuracy20: 0.4625 - val_accuracy30: 0.4409 - val_accuracy50: 0.4191 - 207s/epoch - 43ms/step
Epoch 19/50
4812/4812 - 210s - loss: 12.1553 - accuracy10: 0.5145 - accuracy20: 0.4856 - accuracy30: 0.4632 - accuracy50: 0.4633 - val_loss: 12.4341 - val_accuracy10: 0.4944 - val_accuracy20: 0.4635 - val_accuracy30: 0.4421 - val_accuracy50: 0.4209 - 210s/epoch - 44ms/step
Epoch 20/50
4812/4812 - 209s - loss: 12.1479 - accuracy10: 0.5154 - accuracy20: 0.4865 - accuracy30: 0.4643 - accuracy50: 0.4640 - val_loss: 12.4214 - val_accuracy10: 0.4955 - val_accuracy20: 0.4645 - val_accuracy30: 0.4426 - val_accuracy50: 0.4225 - 209s/epoch - 44ms/step
Epoch 21/50
4812/4812 - 212s - loss: 12.1388 - accuracy10: 0.5157 - accuracy20: 0.4874 - accuracy30: 0.4648 - accuracy50: 0.4647 - val_loss: 12.4296 - val_accuracy10: 0.4939 - val_accuracy20: 0.4636 - val_accuracy30: 0.4427 - val_accuracy50: 0.4214 - 212s/epoch - 44ms/step
Epoch 22/50
4812/4812 - 219s - loss: 12.1315 - accuracy10: 0.5162 - accuracy20: 0.4879 - accuracy30: 0.4656 - accuracy50: 0.4653 - val_loss: 12.4226 - val_accuracy10: 0.4949 - val_accuracy20: 0.4642 - val_accuracy30: 0.4427 - val_accuracy50: 0.4223 - 219s/epoch - 45ms/step
Epoch 23/50
4812/4812 - 205s - loss: 12.1244 - accuracy10: 0.5167 - accuracy20: 0.4880 - accuracy30: 0.4664 - accuracy50: 0.4659 - val_loss: 12.4324 - val_accuracy10: 0.4951 - val_accuracy20: 0.4630 - val_accuracy30: 0.4421 - val_accuracy50: 0.4212 - 205s/epoch - 43ms/step
Epoch 24/50
4812/4812 - 201s - loss: 12.1156 - accuracy10: 0.5178 - accuracy20: 0.4887 - accuracy30: 0.4667 - accuracy50: 0.4663 - val_loss: 12.4157 - val_accuracy10: 0.4947 - val_accuracy20: 0.4646 - val_accuracy30: 0.4435 - val_accuracy50: 0.4236 - 201s/epoch - 42ms/step
Epoch 25/50
4812/4812 - 201s - loss: 12.1100 - accuracy10: 0.5179 - accuracy20: 0.4892 - accuracy30: 0.4674 - accuracy50: 0.4667 - val_loss: 12.4398 - val_accuracy10: 0.4926 - val_accuracy20: 0.4628 - val_accuracy30: 0.4417 - val_accuracy50: 0.4206 - 201s/epoch - 42ms/step
Epoch 26/50
4812/4812 - 202s - loss: 12.1024 - accuracy10: 0.5184 - accuracy20: 0.4900 - accuracy30: 0.4680 - accuracy50: 0.4673 - val_loss: 12.4391 - val_accuracy10: 0.4938 - val_accuracy20: 0.4634 - val_accuracy30: 0.4415 - val_accuracy50: 0.4202 - 202s/epoch - 42ms/step
Epoch 27/50
4812/4812 - 203s - loss: 12.0966 - accuracy10: 0.5189 - accuracy20: 0.4902 - accuracy30: 0.4685 - accuracy50: 0.4678 - val_loss: 12.4255 - val_accuracy10: 0.4950 - val_accuracy20: 0.4641 - val_accuracy30: 0.4436 - val_accuracy50: 0.4237 - 203s/epoch - 42ms/step
Epoch 28/50
4812/4812 - 203s - loss: 12.0890 - accuracy10: 0.5193 - accuracy20: 0.4906 - accuracy30: 0.4690 - accuracy50: 0.4684 - val_loss: 12.4245 - val_accuracy10: 0.4950 - val_accuracy20: 0.4638 - val_accuracy30: 0.4427 - val_accuracy50: 0.4228 - 203s/epoch - 42ms/step
Epoch 29/50
4812/4812 - 201s - loss: 12.0831 - accuracy10: 0.5197 - accuracy20: 0.4915 - accuracy30: 0.4698 - accuracy50: 0.4693 - val_loss: 12.4342 - val_accuracy10: 0.4938 - val_accuracy20: 0.4626 - val_accuracy30: 0.4417 - val_accuracy50: 0.4231 - 201s/epoch - 42ms/step
Epoch 30/50
4812/4812 - 201s - loss: 12.0772 - accuracy10: 0.5201 - accuracy20: 0.4917 - accuracy30: 0.4705 - accuracy50: 0.4700 - val_loss: 12.4383 - val_accuracy10: 0.4933 - val_accuracy20: 0.4629 - val_accuracy30: 0.4417 - val_accuracy50: 0.4230 - 201s/epoch - 42ms/step
Epoch 31/50
4812/4812 - 205s - loss: 12.0704 - accuracy10: 0.5204 - accuracy20: 0.4924 - accuracy30: 0.4710 - accuracy50: 0.4702 - val_loss: 12.4291 - val_accuracy10: 0.4960 - val_accuracy20: 0.4631 - val_accuracy30: 0.4422 - val_accuracy50: 0.4225 - 205s/epoch - 43ms/step
Epoch 32/50
4812/4812 - 204s - loss: 12.0649 - accuracy10: 0.5208 - accuracy20: 0.4926 - accuracy30: 0.4716 - accuracy50: 0.4707 - val_loss: 12.4354 - val_accuracy10: 0.4940 - val_accuracy20: 0.4626 - val_accuracy30: 0.4422 - val_accuracy50: 0.4232 - 204s/epoch - 42ms/step
Epoch 33/50
4812/4812 - 200s - loss: 12.0572 - accuracy10: 0.5216 - accuracy20: 0.4931 - accuracy30: 0.4724 - accuracy50: 0.4716 - val_loss: 12.4526 - val_accuracy10: 0.4928 - val_accuracy20: 0.4618 - val_accuracy30: 0.4404 - val_accuracy50: 0.4209 - 200s/epoch - 42ms/step
Epoch 34/50
4812/4812 - 201s - loss: 12.0524 - accuracy10: 0.5215 - accuracy20: 0.4935 - accuracy30: 0.4728 - accuracy50: 0.4719 - val_loss: 12.4435 - val_accuracy10: 0.4942 - val_accuracy20: 0.4624 - val_accuracy30: 0.4405 - val_accuracy50: 0.4221 - 201s/epoch - 42ms/step
testing model: results/AAPL/W0/deepVOL_L3/seq2seq
Evaluating performance on  test set...
19053/19053 - 316s - 316s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9343309
{'0': {'precision': 0.4578687639876263, 'recall': 0.5000981000858694, 'f1-score': 0.4780526499323882, 'support': 1177369}, '1': {'precision': 0.6791897957439054, 'recall': 0.5689851578943641, 'f1-score': 0.6192223486701733, 'support': 2541351}, '2': {'precision': 0.4351490154865063, 'recall': 0.5492258341237095, 'f1-score': 0.4855773816109231, 'support': 1158731}, 'accuracy': 0.5476622932757295, 'macro avg': {'precision': 0.524069191739346, 'recall': 0.5394363640346477, 'f1-score': 0.5276174600711615, 'support': 4877451}, 'weighted avg': {'precision': 0.5677885455445093, 'recall': 0.5476622932757295, 'f1-score': 0.5533954662763289, 'support': 4877451}}
[[ 588800  368813  219756]
 [ 489022 1445991  606338]
 [ 208136  314190  636405]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9670834
{'0': {'precision': 0.4464002886986507, 'recall': 0.49979357244725275, 'f1-score': 0.47159045136899336, 'support': 1247411}, '1': {'precision': 0.6302166742591105, 'recall': 0.5040716507015777, 'f1-score': 0.5601298229080479, 'support': 2395957}, '2': {'precision': 0.42880163123378034, 'recall': 0.5435963383338074, 'f1-score': 0.47942304263325597, 'support': 1234083}, 'accuracy': 0.5129779878875257, 'macro avg': {'precision': 0.5018061980638472, 'recall': 0.5158205204942126, 'f1-score': 0.503714438970099, 'support': 4877451}, 'weighted avg': {'precision': 0.5322438885006914, 'recall': 0.5129779878875257, 'f1-score': 0.5170655560373486, 'support': 4877451}}
[[ 623448  375987  247976]
 [ 542582 1207734  645641]
 [ 230582  332658  670843]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0014662
{'0': {'precision': 0.4327851152496532, 'recall': 0.4882198525497772, 'f1-score': 0.45883419208426707, 'support': 1316919}, '1': {'precision': 0.5653038745167015, 'recall': 0.4585538098384335, 'f1-score': 0.5063638225059166, 'support': 2259689}, '2': {'precision': 0.42627718871261483, 'recall': 0.510831822133801, 'f1-score': 0.46473985528632916, 'support': 1300843}, 'accuracy': 0.4805065186713306, 'macro avg': {'precision': 0.47478872615965656, 'recall': 0.4858684948406706, 'f1-score': 0.4766459566255043, 'support': 4877451}, 'weighted avg': {'precision': 0.4924444315460499, 'recall': 0.4805065186713306, 'f1-score': 0.482429410913657, 'support': 4877451}}
[[ 642946  418791  255182]
 [ 584321 1036189  639179]
 [ 258334  377997  664512]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0118438
{'0': {'precision': 0.3627857017993389, 'recall': 0.48149056443986504, 'f1-score': 0.41379320801749453, 'support': 1133584}, '1': {'precision': 0.6206336046589401, 'recall': 0.45512072265537373, 'f1-score': 0.5251444637211415, 'support': 2630078}, '2': {'precision': 0.3651153693029375, 'recall': 0.4734532303694865, 'f1-score': 0.4122860100450967, 'support': 1113789}, 'accuracy': 0.4654357368223689, 'macro avg': {'precision': 0.44951155858707215, 'recall': 0.4700215058215751, 'f1-score': 0.45040789392791086, 'support': 4877451}, 'weighted avg': {'precision': 0.5023575508443298, 'recall': 0.4654357368223689, 'f1-score': 0.4734932003651485, 'support': 4877451}}
[[ 545810  376723  211051]
 [ 727178 1197003  705897]
 [ 231509  354953  527327]]
Evaluating performance on  train set...
4812/4812 - 80s - 80s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99268293
{'0': {'precision': 0.4903238404102233, 'recall': 0.5679921127231512, 'f1-score': 0.5263079956577654, 'support': 406731}, '1': {'precision': 0.54099291359487, 'recall': 0.3256054061893887, 'f1-score': 0.40653256152283207, 'support': 406793}, '2': {'precision': 0.4908630966803974, 'recall': 0.6053009006941655, 'f1-score': 0.5421084349601111, 'support': 418344}, 'accuracy': 0.5006201963197355, 'macro avg': {'precision': 0.5073932835618303, 'recall': 0.49963280653556846, 'f1-score': 0.49164966404690286, 'support': 1231868}, 'weighted avg': {'precision': 0.5072391421414897, 'recall': 0.5006201963197355, 'f1-score': 0.4921210623186808, 'support': 1231868}}
[[231020  57225 118486]
 [130174 132454 144165]
 [109964  55156 253224]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0221714
{'0': {'precision': 0.46550101801604493, 'recall': 0.5643250844474165, 'f1-score': 0.5101713787869022, 'support': 406762}, '1': {'precision': 0.4833775382758669, 'recall': 0.25396922925678334, 'f1-score': 0.33298585208899606, 'support': 406880}, '2': {'precision': 0.4706395542644888, 'recall': 0.5907667146471047, 'f1-score': 0.5239052969621534, 'support': 418226}, 'accuracy': 0.4707931369270084, 'macro avg': {'precision': 0.4731727035188002, 'recall': 0.46968700945043484, 'f1-score': 0.4556875092793506, 'support': 1231868}, 'weighted avg': {'precision': 0.4731501070615904, 'recall': 0.4707931369270084, 'f1-score': 0.4563106035739074, 'support': 1231868}}
[[229546  55899 121317]
 [146961 103335 156584]
 [116609  54543 247074]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0417582
{'0': {'precision': 0.4461289165958475, 'recall': 0.5555147185784127, 'f1-score': 0.49484900786958647, 'support': 405406}, '1': {'precision': 0.4368068307014322, 'recall': 0.23369140768902052, 'f1-score': 0.3044840308599112, 'support': 407178}, '2': {'precision': 0.46011653093646965, 'recall': 0.5588121655011877, 'f1-score': 0.5046844120387074, 'support': 419284}, 'accuracy': 0.4502625281280137, 'macro avg': {'precision': 0.44768409274458315, 'recall': 0.44933943058954035, 'f1-score': 0.43467248358940164, 'support': 1231868}, 'weighted avg': {'precision': 0.44780850775405373, 'recall': 0.4502625281280137, 'f1-score': 0.4352739535559751, 'support': 1231868}}
[[225209  61236 118961]
 [156065  95154 155959]
 [123533  61450 234301]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0578282
{'0': {'precision': 0.4328021545711709, 'recall': 0.5189866557620159, 'f1-score': 0.47199240076978055, 'support': 405943}, '1': {'precision': 0.4061796377453735, 'recall': 0.2897905765602206, 'f1-score': 0.33825307172576574, 'support': 406497}, '2': {'precision': 0.45175268968426974, 'recall': 0.49014371954185226, 'f1-score': 0.4701658090337336, 'support': 419428}, 'accuracy': 0.43353508655148115, 'macro avg': {'precision': 0.43024482733360464, 'recall': 0.4329736506213629, 'f1-score': 0.42680376050975993, 'support': 1231868}, 'weighted avg': {'precision': 0.43046944669928905, 'recall': 0.43353508655148115, 'f1-score': 0.4272386124117165, 'support': 1231868}}
[[210679  84115 111149]
 [150355 117799 138343]
 [125745  88103 205580]]
Evaluating performance on  val set...
1767/1767 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0001966
{'0': {'precision': 0.48499581855408486, 'recall': 0.5696373169310808, 'f1-score': 0.5239200391268727, 'support': 147622}, '1': {'precision': 0.5452943718626375, 'recall': 0.31978606845549484, 'f1-score': 0.40314758073765794, 'support': 153881}, '2': {'precision': 0.4803540667320383, 'recall': 0.6010080244048014, 'f1-score': 0.5339500081012211, 'support': 150790}, 'accuracy': 0.4950905718195948, 'macro avg': {'precision': 0.5035480857162535, 'recall': 0.49681046993045896, 'f1-score': 0.48700587598858397, 'support': 452293}, 'weighted avg': {'precision': 0.5039633283860455, 'recall': 0.4950905718195948, 'f1-score': 0.4861742246929798, 'support': 452293}}
[[84091 21332 42199]
 [48832 49209 55840]
 [40462 19702 90626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0288613
{'0': {'precision': 0.4606859749346796, 'recall': 0.5637850324835888, 'f1-score': 0.5070477455439422, 'support': 147613}, '1': {'precision': 0.4883867551004968, 'recall': 0.25107444981039123, 'f1-score': 0.33165076143870603, 'support': 154265}, '2': {'precision': 0.45878890916558784, 'recall': 0.5866635641392148, 'f1-score': 0.5149057341416876, 'support': 150415}, 'accuracy': 0.4647363545312441, 'macro avg': {'precision': 0.46928721306692145, 'recall': 0.46717434881106495, 'f1-score': 0.45120141370811195, 'support': 452293}, 'weighted avg': {'precision': 0.4695030773541773, 'recall': 0.4647363545312441, 'f1-score': 0.4498378033205066, 'support': 452293}}
[[83222 21049 43342]
 [54779 38732 60754]
 [42647 19525 88243]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0467371
{'0': {'precision': 0.4410872684581268, 'recall': 0.5511538827236794, 'f1-score': 0.49001588039586264, 'support': 147242}, '1': {'precision': 0.4447788216872186, 'recall': 0.2350986097639832, 'f1-score': 0.3076050999602359, 'support': 154650}, '2': {'precision': 0.4460322139736821, 'recall': 0.5532808957387252, 'f1-score': 0.4939014618685565, 'support': 150401}, 'accuracy': 0.4437941776680161, 'macro avg': {'precision': 0.4439661013730092, 'recall': 0.44651112940879595, 'f1-score': 0.43050748074155165, 'support': 452293}, 'weighted avg': {'precision': 0.4439938433053256, 'recall': 0.4437941776680161, 'f1-score': 0.4289372613252711, 'support': 452293}}
[[81153 23074 43015]
 [57956 36358 60336]
 [44875 22312 83214]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602065
{'0': {'precision': 0.41301336421750634, 'recall': 0.5139637571090466, 'f1-score': 0.4579916710472887, 'support': 141545}, '1': {'precision': 0.4429202173083562, 'recall': 0.29114165940116327, 'f1-score': 0.3513396653358892, 'support': 167458}, '2': {'precision': 0.4210938299704354, 'recall': 0.4880591806825319, 'f1-score': 0.4521102767909958, 'support': 143290}, 'accuracy': 0.4232588167404758, 'macro avg': {'precision': 0.4256758038320993, 'recall': 0.4310548657309139, 'f1-score': 0.42048053772472455, 'support': 452293}, 'weighted avg': {'precision': 0.4266461017186941, 'recall': 0.4232588167404758, 'f1-score': 0.4166413150713975, 'support': 452293}}
[[72749 30480 38316]
 [60877 48754 57827]
 [42516 30840 69934]]
training model: results/AAPL/W1/deepLOB_L1/seq2seq
Epoch 1/50
6073/6073 - 154s - loss: 12.3275 - accuracy10: 0.4596 - accuracy20: 0.4730 - accuracy30: 0.4633 - accuracy50: 0.4394 - val_loss: 14.0488 - val_accuracy10: 0.4473 - val_accuracy20: 0.3932 - val_accuracy30: 0.3753 - val_accuracy50: 0.3593 - 154s/epoch - 25ms/step
Epoch 2/50
6073/6073 - 151s - loss: 12.1433 - accuracy10: 0.4816 - accuracy20: 0.4910 - accuracy30: 0.4779 - accuracy50: 0.4490 - val_loss: 14.3869 - val_accuracy10: 0.4211 - val_accuracy20: 0.4019 - val_accuracy30: 0.3914 - val_accuracy50: 0.3754 - 151s/epoch - 25ms/step
Epoch 3/50
6073/6073 - 140s - loss: 12.0559 - accuracy10: 0.4943 - accuracy20: 0.4985 - accuracy30: 0.4840 - accuracy50: 0.4533 - val_loss: 13.6918 - val_accuracy10: 0.4563 - val_accuracy20: 0.4209 - val_accuracy30: 0.4059 - val_accuracy50: 0.3836 - 140s/epoch - 23ms/step
Epoch 4/50
6073/6073 - 135s - loss: 12.0092 - accuracy10: 0.5009 - accuracy20: 0.5021 - accuracy30: 0.4862 - accuracy50: 0.4551 - val_loss: 14.5062 - val_accuracy10: 0.4289 - val_accuracy20: 0.4245 - val_accuracy30: 0.4155 - val_accuracy50: 0.3948 - 135s/epoch - 22ms/step
Epoch 5/50
6073/6073 - 137s - loss: 11.9758 - accuracy10: 0.5048 - accuracy20: 0.5049 - accuracy30: 0.4884 - accuracy50: 0.4574 - val_loss: 14.4184 - val_accuracy10: 0.4325 - val_accuracy20: 0.4266 - val_accuracy30: 0.4163 - val_accuracy50: 0.3947 - 137s/epoch - 23ms/step
Epoch 6/50
6073/6073 - 143s - loss: 11.9457 - accuracy10: 0.5077 - accuracy20: 0.5072 - accuracy30: 0.4905 - accuracy50: 0.4592 - val_loss: 15.1570 - val_accuracy10: 0.4121 - val_accuracy20: 0.4153 - val_accuracy30: 0.4077 - val_accuracy50: 0.3896 - 143s/epoch - 24ms/step
Epoch 7/50
6073/6073 - 148s - loss: 11.9246 - accuracy10: 0.5090 - accuracy20: 0.5088 - accuracy30: 0.4919 - accuracy50: 0.4605 - val_loss: 14.9728 - val_accuracy10: 0.4147 - val_accuracy20: 0.4200 - val_accuracy30: 0.4127 - val_accuracy50: 0.3928 - 148s/epoch - 24ms/step
Epoch 8/50
6073/6073 - 141s - loss: 11.9033 - accuracy10: 0.5109 - accuracy20: 0.5105 - accuracy30: 0.4933 - accuracy50: 0.4621 - val_loss: 15.0586 - val_accuracy10: 0.4128 - val_accuracy20: 0.4197 - val_accuracy30: 0.4106 - val_accuracy50: 0.3913 - 141s/epoch - 23ms/step
Epoch 9/50
6073/6073 - 143s - loss: 11.8847 - accuracy10: 0.5120 - accuracy20: 0.5118 - accuracy30: 0.4949 - accuracy50: 0.4631 - val_loss: 15.6056 - val_accuracy10: 0.4075 - val_accuracy20: 0.4168 - val_accuracy30: 0.4097 - val_accuracy50: 0.3910 - 143s/epoch - 24ms/step
Epoch 10/50
6073/6073 - 151s - loss: 11.8665 - accuracy10: 0.5137 - accuracy20: 0.5134 - accuracy30: 0.4959 - accuracy50: 0.4642 - val_loss: 16.2729 - val_accuracy10: 0.4002 - val_accuracy20: 0.4120 - val_accuracy30: 0.4053 - val_accuracy50: 0.3874 - 151s/epoch - 25ms/step
Epoch 11/50
6073/6073 - 139s - loss: 11.8537 - accuracy10: 0.5143 - accuracy20: 0.5142 - accuracy30: 0.4970 - accuracy50: 0.4650 - val_loss: 15.9307 - val_accuracy10: 0.4077 - val_accuracy20: 0.4142 - val_accuracy30: 0.4055 - val_accuracy50: 0.3865 - 139s/epoch - 23ms/step
Epoch 12/50
6073/6073 - 141s - loss: 11.8409 - accuracy10: 0.5154 - accuracy20: 0.5152 - accuracy30: 0.4980 - accuracy50: 0.4658 - val_loss: 16.7331 - val_accuracy10: 0.3932 - val_accuracy20: 0.4074 - val_accuracy30: 0.4007 - val_accuracy50: 0.3816 - 141s/epoch - 23ms/step
Epoch 13/50
6073/6073 - 142s - loss: 11.8269 - accuracy10: 0.5167 - accuracy20: 0.5164 - accuracy30: 0.4990 - accuracy50: 0.4665 - val_loss: 16.7212 - val_accuracy10: 0.3956 - val_accuracy20: 0.4085 - val_accuracy30: 0.4011 - val_accuracy50: 0.3818 - 142s/epoch - 23ms/step
testing model: results/AAPL/W1/deepLOB_L1/seq2seq
Evaluating performance on  test set...
21353/21353 - 203s - 203s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2029625
{'0': {'precision': 0.46651080764889613, 'recall': 0.40130781292492707, 'f1-score': 0.4314598177200416, 'support': 1805457}, '1': {'precision': 0.3538831331547084, 'recall': 0.6883580048143282, 'f1-score': 0.4674509163023562, 'support': 1836601}, '2': {'precision': 0.5390073628709325, 'recall': 0.10064966924484105, 'f1-score': 0.16962500236743844, 'support': 1824159}, 'accuracy': 0.3974200072920632, 'macro avg': {'precision': 0.4531337678915124, 'recall': 0.3967718289946988, 'f1-score': 0.3561785787966121, 'support': 5466217}, 'weighted avg': {'precision': 0.4528620893622958, 'recall': 0.3974200072920632, 'f1-score': 0.3561742871069299, 'support': 5466217}}
[[ 724544 1014394   66519]
 [ 481854 1264239   90508]
 [ 346715 1293843  183601]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.247924
{'0': {'precision': 0.5084093348290816, 'recall': 0.39538699981257946, 'f1-score': 0.4448312830444923, 'support': 2118231}, '1': {'precision': 0.23156640496924216, 'recall': 0.6597494091128937, 'f1-score': 0.3428095775596237, 'support': 1205391}, '2': {'precision': 0.5692149700365281, 'recall': 0.1021845005705698, 'f1-score': 0.17326479980057216, 'support': 2142595}, 'accuracy': 0.3387565843068433, 'macro avg': {'precision': 0.43639690327828395, 'recall': 0.38577363649868096, 'f1-score': 0.32030188680156274, 'support': 5466217}, 'weighted avg': {'precision': 0.4711949091852802, 'recall': 0.3387565843068433, 'f1-score': 0.3158878044445541, 'support': 5466217}}
[[ 837521 1183056   97654]
 [ 342094  795256   68041]
 [ 467721 1455934  218940]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2157534
{'0': {'precision': 0.4995741459813537, 'recall': 0.3951106717008646, 'f1-score': 0.4412438268359843, 'support': 2161483}, '1': {'precision': 0.21052842079060607, 'recall': 0.6267314108516111, 'f1-score': 0.31518238233801144, 'support': 1125455}, '2': {'precision': 0.5505274505653541, 'recall': 0.10263761546823513, 'f1-score': 0.1730185146580661, 'support': 2179279}, 'accuracy': 0.326196160891527, 'macro avg': {'precision': 0.42021000577910467, 'recall': 0.3748265660069036, 'f1-score': 0.3098149079440206, 'support': 5466217}, 'weighted avg': {'precision': 0.4603758320497924, 'recall': 0.326196160891527, 'f1-score': 0.30835223597611766, 'support': 5466217}}
[[ 854025 1197941  109517]
 [ 346996  705358   73101]
 [ 508485 1447118  223676]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1800554
{'0': {'precision': 0.46165650565058886, 'recall': 0.37236864667493774, 'f1-score': 0.4122331509030895, 'support': 2081961}, '1': {'precision': 0.23299061930506756, 'recall': 0.6142433880030242, 'f1-score': 0.3378357009761184, 'support': 1286941}, '2': {'precision': 0.5020299210360717, 'recall': 0.09433585322185747, 'f1-score': 0.15882675696059154, 'support': 2097315}, 'accuracy': 0.3226370266676204, 'macro avg': {'precision': 0.3988923486639093, 'recall': 0.3603159626332732, 'f1-score': 0.30296520294659984, 'support': 5466217}, 'weighted avg': {'precision': 0.4233112049151465, 'recall': 0.3226370266676204, 'f1-score': 0.297488683254261, 'support': 5466217}}
[[ 775257 1199482  107222]
 [ 407416  790495   89030]
 [ 496621 1402842  197852]]
Evaluating performance on  train set...
6073/6073 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0323951
{'0': {'precision': 0.39864164530031093, 'recall': 0.44587039810038565, 'f1-score': 0.42093540400846285, 'support': 393343}, '1': {'precision': 0.5625420067210753, 'recall': 0.48983985442023487, 'f1-score': 0.5236796734194522, 'support': 765491}, '2': {'precision': 0.39413458319384, 'recall': 0.4462549277266754, 'f1-score': 0.4185785225831684, 'support': 395720}, 'accuracy': 0.4676196516814469, 'macro avg': {'precision': 0.45177274507174214, 'recall': 0.46065506008243196, 'f1-score': 0.45439786667036114, 'support': 1554554}, 'weighted avg': {'precision': 0.47820190306399735, 'recall': 0.4676196516814469, 'f1-score': 0.4709286164784511, 'support': 1554554}}
[[175380 140142  77821]
 [196886 374968 193637]
 [ 67678 151450 176592]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0823575
{'0': {'precision': 0.45663816593065865, 'recall': 0.42470085192170126, 'f1-score': 0.4400908484984411, 'support': 492064}, '1': {'precision': 0.42638804884004106, 'recall': 0.47089822132297476, 'f1-score': 0.4475391644088593, 'support': 567388}, '2': {'precision': 0.4526120164665056, 'recall': 0.42992757048042624, 'f1-score': 0.44097825749179087, 'support': 495102}, 'accuracy': 0.4432268033146484, 'macro avg': {'precision': 0.4452127437457351, 'recall': 0.4418422145750341, 'f1-score': 0.44286942346636377, 'support': 1554554}, 'weighted avg': {'precision': 0.44431507642214846, 'recall': 0.4432268033146484, 'f1-score': 0.4430919941873048, 'support': 1554554}}
[[208980 173060 110024]
 [152800 267182 147406]
 [ 95869 186375 212858]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0920922
{'0': {'precision': 0.4569594753686634, 'recall': 0.40688363244586373, 'f1-score': 0.43047013870133977, 'support': 515135}, '1': {'precision': 0.3806523308539029, 'recall': 0.45100104563907, 'f1-score': 0.41285132506525696, 'support': 520256}, '2': {'precision': 0.4549216314016664, 'recall': 0.42013587254869855, 'f1-score': 0.43683734083162096, 'support': 519163}, 'accuracy': 0.42607397362844907, 'macro avg': {'precision': 0.4308444792080775, 'recall': 0.4260068502112107, 'f1-score': 0.4267196015327392, 'support': 1554554}, 'weighted avg': {'precision': 0.43074152284716244, 'recall': 0.42607397362844907, 'f1-score': 0.4267001328041559, 'support': 1554554}}
[[209600 184797 120738]
 [145012 234636 140608]
 [104072 196972 218119]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043587
{'0': {'precision': 0.43656319371823804, 'recall': 0.3662701879009201, 'f1-score': 0.39833939807365154, 'support': 519742}, '1': {'precision': 0.3493984460886643, 'recall': 0.44446757777053225, 'f1-score': 0.3912405276015706, 'support': 509126}, '2': {'precision': 0.44021561373029594, 'recall': 0.39428860574563523, 'f1-score': 0.4159883114172407, 'support': 525686}, 'accuracy': 0.4013549867035819, 'macro avg': {'precision': 0.40872575117906607, 'recall': 0.40167545713902914, 'f1-score': 0.40185607903082093, 'support': 1554554}, 'weighted avg': {'precision': 0.4092513002522049, 'recall': 0.4013549867035819, 'f1-score': 0.4019826083654583, 'support': 1554554}}
[[190366 206625 122751]
 [142017 226290 140819]
 [103673 214741 207272]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0770222
{'0': {'precision': 0.4289461608530981, 'recall': 0.49369772739813494, 'f1-score': 0.4590497969714294, 'support': 126859}, '1': {'precision': 0.4914796249966613, 'recall': 0.5441082253215711, 'f1-score': 0.5164566317700001, 'support': 202910}, '2': {'precision': 0.41023270861738265, 'recall': 0.2786288297338021, 'f1-score': 0.33185960648689067, 'support': 127424}, 'accuracy': 0.45612903084692896, 'macro avg': {'precision': 0.44355283148904734, 'recall': 0.43881159415116944, 'f1-score': 0.43578867840944, 'support': 457193}, 'weighted avg': {'precision': 0.4514839562079846, 'recall': 0.45612903084692896, 'f1-score': 0.449078817574711, 'support': 457193}}
[[ 62630  49359  14870]
 [ 56333 110405  36172]
 [ 27046  64874  35504]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1266739
{'0': {'precision': 0.4797930790312217, 'recall': 0.47142304966823423, 'f1-score': 0.4755712391795991, 'support': 155230}, '1': {'precision': 0.35769680628690337, 'recall': 0.5243626998664114, 'f1-score': 0.4252839219343831, 'support': 145222}, '2': {'precision': 0.4704523664255208, 'recall': 0.27548631181375643, 'f1-score': 0.34749019213358817, 'support': 156741}, 'accuracy': 0.4210650644257458, 'macro avg': {'precision': 0.43598075058121527, 'recall': 0.4237573537828007, 'f1-score': 0.41611511774919013, 'support': 457193}, 'weighted avg': {'precision': 0.4378083208328119, 'recall': 0.4210650644257458, 'f1-score': 0.4156876097713983, 'support': 457193}}
[[73179 60425 21626]
 [42095 76149 26978]
 [37248 76313 43180]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1233026
{'0': {'precision': 0.47796097668593823, 'recall': 0.4566108145971646, 'f1-score': 0.4670420249055264, 'support': 161319}, '1': {'precision': 0.32236562528350354, 'recall': 0.5062955102775424, 'f1-score': 0.39391800036174596, 'support': 133349}, '2': {'precision': 0.47465482076307836, 'recall': 0.2734963851715121, 'f1-score': 0.34703246256421466, 'support': 162525}, 'accuracy': 0.40600796600122924, 'macro avg': {'precision': 0.42499380757750665, 'recall': 0.41213423668207305, 'f1-score': 0.40266416261049565, 'support': 457193}, 'weighted avg': {'precision': 0.43140335768143456, 'recall': 0.40600796600122924, 'f1-score': 0.4030524851085254, 'support': 457193}}
[[73660 63646 24013]
 [40651 67514 25184]
 [39802 78273 44450]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.12389
{'0': {'precision': 0.45368989178487157, 'recall': 0.41468040010411633, 'f1-score': 0.43330894114142504, 'support': 161358}, '1': {'precision': 0.30528850555769194, 'recall': 0.5021687400222898, 'f1-score': 0.379726220845481, 'support': 132796}, '2': {'precision': 0.45868986447251653, 'recall': 0.2567851863664522, 'f1-score': 0.3292491113278178, 'support': 163039}, 'accuracy': 0.38378540353854934, 'macro avg': {'precision': 0.4058894206050267, 'recall': 0.3912114421642861, 'f1-score': 0.3807614244382413, 'support': 457193}, 'weighted avg': {'precision': 0.4123683493762966, 'recall': 0.38378540353854934, 'f1-score': 0.3806366965589382, 'support': 457193}}
[[66912 69535 24911]
 [41614 66686 24496]
 [38958 82215 41866]]
training model: results/AAPL/W1/deepOF_L1/seq2seq
Epoch 1/50
6073/6073 - 141s - loss: 12.6635 - accuracy10: 0.4423 - accuracy20: 0.4493 - accuracy30: 0.4433 - accuracy50: 0.4271 - val_loss: 13.3912 - val_accuracy10: 0.4606 - val_accuracy20: 0.3919 - val_accuracy30: 0.3726 - val_accuracy50: 0.3571 - 141s/epoch - 23ms/step
Epoch 2/50
6073/6073 - 147s - loss: 12.5854 - accuracy10: 0.4487 - accuracy20: 0.4552 - accuracy30: 0.4492 - accuracy50: 0.4328 - val_loss: 13.3564 - val_accuracy10: 0.4635 - val_accuracy20: 0.4006 - val_accuracy30: 0.3818 - val_accuracy50: 0.3637 - 147s/epoch - 24ms/step
Epoch 3/50
6073/6073 - 129s - loss: 12.5429 - accuracy10: 0.4547 - accuracy20: 0.4588 - accuracy30: 0.4520 - accuracy50: 0.4347 - val_loss: 13.3237 - val_accuracy10: 0.4670 - val_accuracy20: 0.4093 - val_accuracy30: 0.3917 - val_accuracy50: 0.3739 - 129s/epoch - 21ms/step
Epoch 4/50
6073/6073 - 144s - loss: 12.5149 - accuracy10: 0.4587 - accuracy20: 0.4612 - accuracy30: 0.4533 - accuracy50: 0.4358 - val_loss: 13.2237 - val_accuracy10: 0.4683 - val_accuracy20: 0.4151 - val_accuracy30: 0.3992 - val_accuracy50: 0.3810 - 144s/epoch - 24ms/step
Epoch 5/50
6073/6073 - 140s - loss: 12.4934 - accuracy10: 0.4611 - accuracy20: 0.4629 - accuracy30: 0.4546 - accuracy50: 0.4368 - val_loss: 13.2098 - val_accuracy10: 0.4683 - val_accuracy20: 0.4189 - val_accuracy30: 0.4042 - val_accuracy50: 0.3862 - 140s/epoch - 23ms/step
Epoch 6/50
6073/6073 - 138s - loss: 12.4766 - accuracy10: 0.4632 - accuracy20: 0.4645 - accuracy30: 0.4558 - accuracy50: 0.4376 - val_loss: 13.1991 - val_accuracy10: 0.4704 - val_accuracy20: 0.4193 - val_accuracy30: 0.4047 - val_accuracy50: 0.3872 - 138s/epoch - 23ms/step
Epoch 7/50
6073/6073 - 141s - loss: 12.4626 - accuracy10: 0.4649 - accuracy20: 0.4656 - accuracy30: 0.4566 - accuracy50: 0.4382 - val_loss: 13.1643 - val_accuracy10: 0.4701 - val_accuracy20: 0.4227 - val_accuracy30: 0.4085 - val_accuracy50: 0.3896 - 141s/epoch - 23ms/step
Epoch 8/50
6073/6073 - 142s - loss: 12.4507 - accuracy10: 0.4660 - accuracy20: 0.4665 - accuracy30: 0.4574 - accuracy50: 0.4388 - val_loss: 13.1442 - val_accuracy10: 0.4706 - val_accuracy20: 0.4266 - val_accuracy30: 0.4120 - val_accuracy50: 0.3920 - 142s/epoch - 23ms/step
Epoch 9/50
6073/6073 - 134s - loss: 12.4400 - accuracy10: 0.4674 - accuracy20: 0.4675 - accuracy30: 0.4583 - accuracy50: 0.4392 - val_loss: 13.1351 - val_accuracy10: 0.4717 - val_accuracy20: 0.4262 - val_accuracy30: 0.4127 - val_accuracy50: 0.3941 - 134s/epoch - 22ms/step
Epoch 10/50
6073/6073 - 140s - loss: 12.4296 - accuracy10: 0.4680 - accuracy20: 0.4684 - accuracy30: 0.4589 - accuracy50: 0.4399 - val_loss: 13.1715 - val_accuracy10: 0.4721 - val_accuracy20: 0.4275 - val_accuracy30: 0.4139 - val_accuracy50: 0.3947 - 140s/epoch - 23ms/step
Epoch 11/50
6073/6073 - 133s - loss: 12.4193 - accuracy10: 0.4686 - accuracy20: 0.4695 - accuracy30: 0.4601 - accuracy50: 0.4408 - val_loss: 13.1349 - val_accuracy10: 0.4721 - val_accuracy20: 0.4290 - val_accuracy30: 0.4153 - val_accuracy50: 0.3955 - 133s/epoch - 22ms/step
Epoch 12/50
6073/6073 - 138s - loss: 12.4111 - accuracy10: 0.4695 - accuracy20: 0.4701 - accuracy30: 0.4606 - accuracy50: 0.4410 - val_loss: 13.1423 - val_accuracy10: 0.4746 - val_accuracy20: 0.4298 - val_accuracy30: 0.4158 - val_accuracy50: 0.3963 - 138s/epoch - 23ms/step
Epoch 13/50
6073/6073 - 142s - loss: 12.4014 - accuracy10: 0.4702 - accuracy20: 0.4709 - accuracy30: 0.4613 - accuracy50: 0.4415 - val_loss: 13.1329 - val_accuracy10: 0.4735 - val_accuracy20: 0.4306 - val_accuracy30: 0.4171 - val_accuracy50: 0.3974 - 142s/epoch - 23ms/step
Epoch 14/50
6073/6073 - 138s - loss: 12.3948 - accuracy10: 0.4707 - accuracy20: 0.4716 - accuracy30: 0.4620 - accuracy50: 0.4419 - val_loss: 13.1122 - val_accuracy10: 0.4737 - val_accuracy20: 0.4313 - val_accuracy30: 0.4172 - val_accuracy50: 0.3968 - 138s/epoch - 23ms/step
Epoch 15/50
6073/6073 - 138s - loss: 12.3865 - accuracy10: 0.4709 - accuracy20: 0.4720 - accuracy30: 0.4627 - accuracy50: 0.4426 - val_loss: 13.1263 - val_accuracy10: 0.4729 - val_accuracy20: 0.4325 - val_accuracy30: 0.4182 - val_accuracy50: 0.3968 - 138s/epoch - 23ms/step
Epoch 16/50
6073/6073 - 138s - loss: 12.3802 - accuracy10: 0.4717 - accuracy20: 0.4727 - accuracy30: 0.4634 - accuracy50: 0.4427 - val_loss: 13.1236 - val_accuracy10: 0.4734 - val_accuracy20: 0.4323 - val_accuracy30: 0.4178 - val_accuracy50: 0.3970 - 138s/epoch - 23ms/step
Epoch 17/50
6073/6073 - 138s - loss: 12.3724 - accuracy10: 0.4721 - accuracy20: 0.4733 - accuracy30: 0.4639 - accuracy50: 0.4433 - val_loss: 13.1126 - val_accuracy10: 0.4733 - val_accuracy20: 0.4337 - val_accuracy30: 0.4194 - val_accuracy50: 0.3992 - 138s/epoch - 23ms/step
Epoch 18/50
6073/6073 - 141s - loss: 12.3638 - accuracy10: 0.4724 - accuracy20: 0.4741 - accuracy30: 0.4643 - accuracy50: 0.4438 - val_loss: 13.1309 - val_accuracy10: 0.4735 - val_accuracy20: 0.4326 - val_accuracy30: 0.4183 - val_accuracy50: 0.3981 - 141s/epoch - 23ms/step
Epoch 19/50
6073/6073 - 138s - loss: 12.3582 - accuracy10: 0.4727 - accuracy20: 0.4747 - accuracy30: 0.4651 - accuracy50: 0.4442 - val_loss: 13.1230 - val_accuracy10: 0.4735 - val_accuracy20: 0.4339 - val_accuracy30: 0.4192 - val_accuracy50: 0.3988 - 138s/epoch - 23ms/step
Epoch 20/50
6073/6073 - 129s - loss: 12.3503 - accuracy10: 0.4736 - accuracy20: 0.4754 - accuracy30: 0.4660 - accuracy50: 0.4451 - val_loss: 13.1248 - val_accuracy10: 0.4734 - val_accuracy20: 0.4337 - val_accuracy30: 0.4200 - val_accuracy50: 0.3988 - 129s/epoch - 21ms/step
Epoch 21/50
6073/6073 - 130s - loss: 12.3446 - accuracy10: 0.4736 - accuracy20: 0.4755 - accuracy30: 0.4659 - accuracy50: 0.4452 - val_loss: 13.1418 - val_accuracy10: 0.4734 - val_accuracy20: 0.4333 - val_accuracy30: 0.4188 - val_accuracy50: 0.3989 - 130s/epoch - 21ms/step
Epoch 22/50
6073/6073 - 141s - loss: 12.3374 - accuracy10: 0.4743 - accuracy20: 0.4765 - accuracy30: 0.4669 - accuracy50: 0.4458 - val_loss: 13.1319 - val_accuracy10: 0.4729 - val_accuracy20: 0.4337 - val_accuracy30: 0.4197 - val_accuracy50: 0.4001 - 141s/epoch - 23ms/step
Epoch 23/50
6073/6073 - 143s - loss: 12.3310 - accuracy10: 0.4746 - accuracy20: 0.4770 - accuracy30: 0.4673 - accuracy50: 0.4462 - val_loss: 13.1364 - val_accuracy10: 0.4732 - val_accuracy20: 0.4342 - val_accuracy30: 0.4190 - val_accuracy50: 0.3999 - 143s/epoch - 24ms/step
Epoch 24/50
6073/6073 - 145s - loss: 12.3253 - accuracy10: 0.4752 - accuracy20: 0.4774 - accuracy30: 0.4677 - accuracy50: 0.4462 - val_loss: 13.1122 - val_accuracy10: 0.4717 - val_accuracy20: 0.4359 - val_accuracy30: 0.4213 - val_accuracy50: 0.4019 - 145s/epoch - 24ms/step
testing model: results/AAPL/W1/deepOF_L1/seq2seq
Evaluating performance on  test set...
21353/21353 - 159s - 159s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0969101
{'0': {'precision': 0.4841967124176478, 'recall': 0.292642966652192, 'f1-score': 0.3648031020629672, 'support': 1805456}, '1': {'precision': 0.3754866352915287, 'recall': 0.6280311445061527, 'f1-score': 0.46998131185367953, 'support': 1836600}, '2': {'precision': 0.4475611515428698, 'recall': 0.31973252287633297, 'f1-score': 0.37299892047867306, 'support': 1824156}, 'accuracy': 0.4143706830251004, 'macro avg': {'precision': 0.43574816641734876, 'recall': 0.41346887801155924, 'f1-score': 0.4025944447984399, 'support': 5466212}, 'weighted avg': {'precision': 0.43544523592297063, 'recall': 0.4143706830251004, 'f1-score': 0.4028771378741546, 'support': 5466212}}
[[ 528354  941729  335373]
 [ 298617 1153442  384541]
 [ 264226  976688  583242]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1361309
{'0': {'precision': 0.5294982671052252, 'recall': 0.2944165647734193, 'f1-score': 0.3784203289535162, 'support': 2118230}, '1': {'precision': 0.2489163220294241, 'recall': 0.5726246277138519, 'f1-score': 0.3469957675963476, 'support': 1205390}, '2': {'precision': 0.4918519251707414, 'recall': 0.3478856450504809, 'f1-score': 0.40752785233193056, 'support': 2142592}, 'accuracy': 0.37672432024224456, 'macro avg': {'precision': 0.4234221714351302, 'recall': 0.40497561251258407, 'f1-score': 0.3776479829605981, 'support': 5466212}, 'weighted avg': {'precision': 0.452869072732045, 'recall': 0.37672432024224456, 'f1-score': 0.382899974952626, 'support': 5466212}}
[[ 623642 1027679  466909]
 [ 211990  690236  303164]
 [ 342166 1055049  745377]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1308252
{'0': {'precision': 0.5224442502112755, 'recall': 0.3005951472184362, 'f1-score': 0.3816201430845736, 'support': 2161482}, '1': {'precision': 0.22149853762459334, 'recall': 0.5165902085649068, 'f1-score': 0.3100547904003208, 'support': 1125453}, '2': {'precision': 0.49277915750787366, 'recall': 0.36128082845824555, 'f1-score': 0.41690669319909673, 'support': 2179277}, 'accuracy': 0.369261199529034, 'macro avg': {'precision': 0.4122406484479142, 'recall': 0.3928220614138629, 'f1-score': 0.36952720889466373, 'support': 5466212}, 'weighted avg': {'precision': 0.44865481260819484, 'recall': 0.369261199529034, 'f1-score': 0.3809534521840701, 'support': 5466212}}
[[ 649731 1015330  496421]
 [ 230071  581398  313984]
 [ 363835 1028111  787331]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1199739
{'0': {'precision': 0.48964206458771464, 'recall': 0.2916538181846128, 'f1-score': 0.36556183343517745, 'support': 2081958}, '1': {'precision': 0.23667239142726845, 'recall': 0.48753825938913964, 'f1-score': 0.31865547857336574, 'support': 1286939}, '2': {'precision': 0.47053635995969634, 'recall': 0.35336370549965074, 'f1-score': 0.4036180568452204, 'support': 2097315}, 'accuracy': 0.3614492083365958, 'macro avg': {'precision': 0.3989502719915598, 'recall': 0.37751859435780105, 'f1-score': 0.36261178961792123, 'support': 5466212}, 'weighted avg': {'precision': 0.42275347352879783, 'recall': 0.3614492083365958, 'f1-score': 0.3691201057418002, 'support': 5466212}}
[[ 607211 1012003  462744]
 [ 288323  627432  371184]
 [ 344578 1011622  741115]]
Evaluating performance on  train set...
6073/6073 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0032575
{'0': {'precision': 0.4137460440304592, 'recall': 0.3041593221544354, 'f1-score': 0.3505885934942926, 'support': 393718}, '1': {'precision': 0.5504204870485712, 'recall': 0.6727204058536177, 'f1-score': 0.6054561589530159, 'support': 765202}, '2': {'precision': 0.40041286239132806, 'recall': 0.3338776087940086, 'f1-score': 0.36413080183315527, 'support': 395633}, 'accuracy': 0.4931404718912768, 'macro avg': {'precision': 0.4548597978234528, 'recall': 0.4369191122673539, 'f1-score': 0.4400585180934879, 'support': 1554553}, 'weighted avg': {'precision': 0.4776284015280233, 'recall': 0.4931404718912768, 'f1-score': 0.47948925840303175, 'support': 1554553}}
[[119753 209474  64491]
 [117127 514767 133308]
 [ 52556 210984 132093]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0620277
{'0': {'precision': 0.4717306630923283, 'recall': 0.30398500947069773, 'f1-score': 0.36972064677754446, 'support': 492044}, '1': {'precision': 0.42428003506649975, 'recall': 0.6378452761239919, 'f1-score': 0.5095915016233938, 'support': 567553}, '2': {'precision': 0.4539196652109868, 'recall': 0.3523848584520644, 'f1-score': 0.39675931928871533, 'support': 494956}, 'accuracy': 0.4412844078008276, 'macro avg': {'precision': 0.44997678778993827, 'recall': 0.43140504801558466, 'f1-score': 0.4253571558965512, 'support': 1554553}, 'weighted avg': {'precision': 0.4487360102530231, 'recall': 0.4412844078008276, 'f1-score': 0.4293950846846248, 'support': 1554553}}
[[149574 245338  97132]
 [ 92847 362011 112695]
 [ 74654 245887 174415]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0740663
{'0': {'precision': 0.4728180208135127, 'recall': 0.31364716756899513, 'f1-score': 0.3771254855125507, 'support': 514964}, '1': {'precision': 0.3837400901601119, 'recall': 0.5928627832225067, 'f1-score': 0.46591142436101846, 'support': 520483}, '2': {'precision': 0.4589736878795958, 'recall': 0.36146567367743776, 'f1-score': 0.40442533857655055, 'support': 519106}, 'accuracy': 0.4230997592233909, 'macro avg': {'precision': 0.43851059961774014, 'recall': 0.4226585414896465, 'f1-score': 0.4158207494833732, 'support': 1554553}, 'weighted avg': {'precision': 0.4383706749383525, 'recall': 0.4230997592233909, 'f1-score': 0.4159682199412307, 'support': 1554553}}
[[161517 247881 105566]
 [ 96290 308575 115618]
 [ 83798 247669 187639]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831062
{'0': {'precision': 0.4572594852404073, 'recall': 0.30714688412169117, 'f1-score': 0.3674637777910783, 'support': 519709}, '1': {'precision': 0.3545337441336658, 'recall': 0.5544790860787232, 'f1-score': 0.43251654959671365, 'support': 509278}, '2': {'precision': 0.45058244735477937, 'recall': 0.35061628796383326, 'f1-score': 0.39436294179962117, 'support': 525566}, 'accuracy': 0.40287014981155356, 'macro avg': {'precision': 0.4207918922429508, 'recall': 0.40408075272141586, 'f1-score': 0.3981144230624711, 'support': 1554553}, 'weighted avg': {'precision': 0.4213487224212837, 'recall': 0.40287014981155356, 'f1-score': 0.3978694516735025, 'support': 1554553}}
[[159627 256833 103249]
 [105451 282384 121443]
 [ 84017 257277 184272]]
Evaluating performance on  val set...
1786/1786 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0229609
{'0': {'precision': 0.4473469120868343, 'recall': 0.32410346297787673, 'f1-score': 0.3758807774191333, 'support': 126654}, '1': {'precision': 0.5085590891244601, 'recall': 0.637789770153428, 'f1-score': 0.5658901859359708, 'support': 203092}, '2': {'precision': 0.4159991330341097, 'recall': 0.36143935470709165, 'f1-score': 0.38680477124155566, 'support': 127446}, 'accuracy': 0.4738556230205253, 'macro avg': {'precision': 0.4573017114151347, 'recall': 0.4411108626127988, 'f1-score': 0.4428585781988866, 'support': 457192}, 'weighted avg': {'precision': 0.4657998911629598, 'recall': 0.4738556230205253, 'f1-score': 0.4633311486224659, 'support': 457192}}
[[ 41049  61760  23845]
 [ 32740 129530  40822]
 [ 17972  63410  46064]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0733534
{'0': {'precision': 0.5030297647244591, 'recall': 0.32849547256146683, 'f1-score': 0.397445544322847, 'support': 155165}, '1': {'precision': 0.37965870006173386, 'recall': 0.5925072085773468, 'f1-score': 0.4627821539238846, 'support': 145313}, '2': {'precision': 0.46708344953673575, 'recall': 0.38473269778067054, 'f1-score': 0.4219273752790432, 'support': 156714}, 'accuracy': 0.4316851563456928, 'macro avg': {'precision': 0.44992397144097623, 'recall': 0.4352451263064947, 'f1-score': 0.42738502450859156, 'support': 457192}, 'weighted avg': {'precision': 0.4514962506698312, 'recall': 0.4316851563456928, 'f1-score': 0.4266037632055591, 'support': 457192}}
[[50971 69510 34684]
 [25107 86099 34107]
 [25250 71171 60293]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825304
{'0': {'precision': 0.5022156979677966, 'recall': 0.3393572305365092, 'f1-score': 0.4050285426771292, 'support': 161302}, '1': {'precision': 0.3405567806212886, 'recall': 0.5434940834840288, 'f1-score': 0.418732909775175, 'support': 133271}, '2': {'precision': 0.46901335694782675, 'recall': 0.3908276400666589, 'f1-score': 0.4263657678387544, 'support': 162619}, 'accuracy': 0.41717046667483243, 'macro avg': {'precision': 0.4372619451789707, 'recall': 0.424559651362399, 'f1-score': 0.4167090734303529, 'support': 457192}, 'weighted avg': {'precision': 0.4432825209480479, 'recall': 0.41717046667483243, 'f1-score': 0.4166128068945302, 'support': 457192}}
[[54739 69321 37242]
 [26127 72432 34712]
 [28129 70934 63556]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908687
{'0': {'precision': 0.48319780986828387, 'recall': 0.33035227329069367, 'f1-score': 0.39241713139344414, 'support': 161352}, '1': {'precision': 0.3151274458898759, 'recall': 0.5073312899606136, 'f1-score': 0.38877090522962565, 'support': 132787}, '2': {'precision': 0.45559796246487655, 'recall': 0.37190974713743385, 'f1-score': 0.4095220408232176, 'support': 163053}, 'accuracy': 0.3965751806680782, 'macro avg': {'precision': 0.4179744060743454, 'recall': 0.4031977701295804, 'f1-score': 0.39690335914876246, 'support': 457192}, 'weighted avg': {'precision': 0.4245401838812399, 'recall': 0.3965751806680782, 'f1-score': 0.39745841681321936, 'support': 457192}}
[[53303 72222 35827]
 [28786 67367 36634]
 [28224 74188 60641]]
training model: results/AAPL/W1/deepLOB_L2/seq2seq
Epoch 1/50
6073/6073 - 301s - loss: 12.2733 - accuracy10: 0.4628 - accuracy20: 0.4766 - accuracy30: 0.4672 - accuracy50: 0.4433 - val_loss: 13.4846 - val_accuracy10: 0.4311 - val_accuracy20: 0.4021 - val_accuracy30: 0.3895 - val_accuracy50: 0.3734 - 301s/epoch - 50ms/step
Epoch 2/50
6073/6073 - 293s - loss: 11.8467 - accuracy10: 0.5150 - accuracy20: 0.5166 - accuracy30: 0.4993 - accuracy50: 0.4654 - val_loss: 13.4111 - val_accuracy10: 0.4716 - val_accuracy20: 0.4407 - val_accuracy30: 0.4217 - val_accuracy50: 0.3966 - 293s/epoch - 48ms/step
Epoch 3/50
6073/6073 - 287s - loss: 11.6926 - accuracy10: 0.5294 - accuracy20: 0.5268 - accuracy30: 0.5081 - accuracy50: 0.4727 - val_loss: 13.1734 - val_accuracy10: 0.5033 - val_accuracy20: 0.4565 - val_accuracy30: 0.4331 - val_accuracy50: 0.4029 - 287s/epoch - 47ms/step
Epoch 4/50
6073/6073 - 289s - loss: 11.6223 - accuracy10: 0.5359 - accuracy20: 0.5315 - accuracy30: 0.5118 - accuracy50: 0.4757 - val_loss: 13.1769 - val_accuracy10: 0.5111 - val_accuracy20: 0.4627 - val_accuracy30: 0.4361 - val_accuracy50: 0.4012 - 289s/epoch - 48ms/step
Epoch 5/50
6073/6073 - 290s - loss: 11.5745 - accuracy10: 0.5402 - accuracy20: 0.5343 - accuracy30: 0.5143 - accuracy50: 0.4781 - val_loss: 13.2689 - val_accuracy10: 0.5026 - val_accuracy20: 0.4656 - val_accuracy30: 0.4403 - val_accuracy50: 0.4068 - 290s/epoch - 48ms/step
Epoch 6/50
6073/6073 - 290s - loss: 11.5430 - accuracy10: 0.5429 - accuracy20: 0.5367 - accuracy30: 0.5162 - accuracy50: 0.4795 - val_loss: 13.0355 - val_accuracy10: 0.5035 - val_accuracy20: 0.4724 - val_accuracy30: 0.4493 - val_accuracy50: 0.4156 - 290s/epoch - 48ms/step
Epoch 7/50
6073/6073 - 294s - loss: 11.5168 - accuracy10: 0.5450 - accuracy20: 0.5385 - accuracy30: 0.5174 - accuracy50: 0.4809 - val_loss: 13.1805 - val_accuracy10: 0.4999 - val_accuracy20: 0.4710 - val_accuracy30: 0.4498 - val_accuracy50: 0.4184 - 294s/epoch - 48ms/step
Epoch 8/50
6073/6073 - 283s - loss: 11.4951 - accuracy10: 0.5467 - accuracy20: 0.5398 - accuracy30: 0.5188 - accuracy50: 0.4820 - val_loss: 13.3670 - val_accuracy10: 0.4995 - val_accuracy20: 0.4700 - val_accuracy30: 0.4486 - val_accuracy50: 0.4172 - 283s/epoch - 47ms/step
Epoch 9/50
6073/6073 - 283s - loss: 11.4768 - accuracy10: 0.5476 - accuracy20: 0.5409 - accuracy30: 0.5198 - accuracy50: 0.4830 - val_loss: 13.2878 - val_accuracy10: 0.5106 - val_accuracy20: 0.4749 - val_accuracy30: 0.4537 - val_accuracy50: 0.4225 - 283s/epoch - 47ms/step
Epoch 10/50
6073/6073 - 283s - loss: 11.4591 - accuracy10: 0.5492 - accuracy20: 0.5421 - accuracy30: 0.5207 - accuracy50: 0.4835 - val_loss: 13.3349 - val_accuracy10: 0.5089 - val_accuracy20: 0.4753 - val_accuracy30: 0.4524 - val_accuracy50: 0.4206 - 283s/epoch - 47ms/step
Epoch 11/50
6073/6073 - 284s - loss: 11.4452 - accuracy10: 0.5500 - accuracy20: 0.5430 - accuracy30: 0.5216 - accuracy50: 0.4842 - val_loss: 13.3042 - val_accuracy10: 0.5124 - val_accuracy20: 0.4733 - val_accuracy30: 0.4508 - val_accuracy50: 0.4202 - 284s/epoch - 47ms/step
Epoch 12/50
6073/6073 - 284s - loss: 11.4306 - accuracy10: 0.5510 - accuracy20: 0.5440 - accuracy30: 0.5225 - accuracy50: 0.4848 - val_loss: 13.3382 - val_accuracy10: 0.5098 - val_accuracy20: 0.4717 - val_accuracy30: 0.4487 - val_accuracy50: 0.4181 - 284s/epoch - 47ms/step
Epoch 13/50
6073/6073 - 284s - loss: 11.4187 - accuracy10: 0.5516 - accuracy20: 0.5448 - accuracy30: 0.5231 - accuracy50: 0.4852 - val_loss: 13.2986 - val_accuracy10: 0.5115 - val_accuracy20: 0.4734 - val_accuracy30: 0.4499 - val_accuracy50: 0.4183 - 284s/epoch - 47ms/step
Epoch 14/50
6073/6073 - 286s - loss: 11.4086 - accuracy10: 0.5524 - accuracy20: 0.5455 - accuracy30: 0.5239 - accuracy50: 0.4861 - val_loss: 13.4734 - val_accuracy10: 0.5117 - val_accuracy20: 0.4699 - val_accuracy30: 0.4458 - val_accuracy50: 0.4154 - 286s/epoch - 47ms/step
Epoch 15/50
6073/6073 - 284s - loss: 11.3973 - accuracy10: 0.5531 - accuracy20: 0.5462 - accuracy30: 0.5244 - accuracy50: 0.4865 - val_loss: 13.3366 - val_accuracy10: 0.5158 - val_accuracy20: 0.4688 - val_accuracy30: 0.4441 - val_accuracy50: 0.4132 - 284s/epoch - 47ms/step
Epoch 16/50
6073/6073 - 285s - loss: 11.3880 - accuracy10: 0.5534 - accuracy20: 0.5468 - accuracy30: 0.5251 - accuracy50: 0.4870 - val_loss: 13.4988 - val_accuracy10: 0.5143 - val_accuracy20: 0.4699 - val_accuracy30: 0.4456 - val_accuracy50: 0.4144 - 285s/epoch - 47ms/step
testing model: results/AAPL/W1/deepLOB_L2/seq2seq
Evaluating performance on  test set...
21353/21353 - 342s - 342s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0652459
{'0': {'precision': 0.45269255602256875, 'recall': 0.6924119488860715, 'f1-score': 0.5474604870003754, 'support': 1805457}, '1': {'precision': 0.48250375265006734, 'recall': 0.4074466909252472, 'f1-score': 0.44181012278948667, 'support': 1836601}, '2': {'precision': 0.5207819086975816, 'recall': 0.3293978211329166, 'f1-score': 0.4035486144667928, 'support': 1824159}, 'accuracy': 0.47552283416483465, 'macro avg': {'precision': 0.4853260724567392, 'recall': 0.4764188203147451, 'f1-score': 0.4642730747522183, 'support': 5466217}, 'weighted avg': {'precision': 0.4854313000247844, 'recall': 0.47552283416483465, 'f1-score': 0.46393732975120844, 'support': 5466217}}
[[1250120  287568  267769]
 [ 803135  748317  285149]
 [ 708266  515019  600874]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0804106
{'0': {'precision': 0.4926815689628779, 'recall': 0.6776461113070293, 'f1-score': 0.57054747136006, 'support': 2118231}, '1': {'precision': 0.3485794583040583, 'recall': 0.3798974772501205, 'f1-score': 0.36356526986042526, 'support': 1205391}, '2': {'precision': 0.551945746056291, 'recall': 0.3191900475824876, 'f1-score': 0.40447330997791914, 'support': 2142595}, 'accuracy': 0.4714834775128759, 'macro avg': {'precision': 0.4644022577744091, 'recall': 0.4589112120465458, 'f1-score': 0.44619535039946817, 'support': 5466217}, 'weighted avg': {'precision': 0.48413447729972514, 'recall': 0.4714834775128759, 'f1-score': 0.4598083348321077, 'support': 5466217}}
[[1435411  324899  357921]
 [ 550220  457925  197246]
 [ 927835  530865  683895]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084718
{'0': {'precision': 0.48440732192386743, 'recall': 0.6738637315213675, 'f1-score': 0.5636409967372521, 'support': 2161483}, '1': {'precision': 0.30553043328463475, 'recall': 0.3277838740775953, 'f1-score': 0.31626618223031333, 'support': 1125455}, '2': {'precision': 0.537651096827376, 'recall': 0.30886407844062186, 'f1-score': 0.3923405401246442, 'support': 2179279}, 'accuracy': 0.45708979354460316, 'macro avg': {'precision': 0.4425296173452928, 'recall': 0.43683722801319486, 'f1-score': 0.42408257303073654, 'support': 5466217}, 'weighted avg': {'precision': 0.46880515168885395, 'recall': 0.45708979354460316, 'f1-score': 0.4444139866044355, 'support': 5466217}}
[[1456545  326090  378848]
 [ 556569  368906  199980]
 [ 993746  512432  673101]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967976
{'0': {'precision': 0.4508024465574818, 'recall': 0.6559138235538514, 'f1-score': 0.5343511510121797, 'support': 2081961}, '1': {'precision': 0.29621695871386433, 'recall': 0.27614785759409327, 'f1-score': 0.2858305619116175, 'support': 1286941}, '2': {'precision': 0.4935121303037749, 'recall': 0.2911288957548103, 'f1-score': 0.36622005927641743, 'support': 2097315}, 'accuracy': 0.42654032944539155, 'macro avg': {'precision': 0.4135105118583737, 'recall': 0.4077301923009184, 'f1-score': 0.3954672574000715, 'support': 5466217}, 'weighted avg': {'precision': 0.4307946894661339, 'recall': 0.42654032944539155, 'f1-score': 0.41133093499780315, 'support': 5466217}}
[[1365587  341162  375212]
 [ 680124  355386  251431]
 [ 983525  503201  610589]]
Evaluating performance on  train set...
6073/6073 - 100s - 100s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96235776
{'0': {'precision': 0.43392521604807816, 'recall': 0.574185888651889, 'f1-score': 0.4942981673814248, 'support': 393343}, '1': {'precision': 0.6382770732628145, 'recall': 0.4947151566772176, 'f1-score': 0.557400719896203, 'support': 765491}, '2': {'precision': 0.43974389225687005, 'recall': 0.4897857070656019, 'f1-score': 0.4634177832611253, 'support': 395720}, 'accuracy': 0.5135685219040317, 'macro avg': {'precision': 0.5039820605225875, 'recall': 0.5195622507982361, 'f1-score': 0.5050388901795844, 'support': 1554554}, 'weighted avg': {'precision': 0.5360330065014871, 'recall': 0.5135685219040317, 'f1-score': 0.5175102593531447, 'support': 1554554}}
[[225852  96468  71023]
 [210880 378700 175911]
 [ 83754 118148 193818]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0054225
{'0': {'precision': 0.48844972724326163, 'recall': 0.542079892046563, 'f1-score': 0.5138693162389045, 'support': 492064}, '1': {'precision': 0.5119767727641218, 'recall': 0.49197550882288665, 'f1-score': 0.5017769029579099, 'support': 567388}, '2': {'precision': 0.4934623662413301, 'recall': 0.4617068806023809, 'f1-score': 0.47705675316666374, 'support': 495102}, 'accuracy': 0.49819498068256235, 'macro avg': {'precision': 0.4979629554162379, 'recall': 0.49858742715727683, 'f1-score': 0.4975676574544927, 'support': 1554554}, 'weighted avg': {'precision': 0.498633182367504, 'recall': 0.49819498068256235, 'f1-score': 0.4977315276584695, 'support': 1554554}}
[[266738 121505 103821]
 [157419 279141 130828]
 [121934 144576 228592]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0273156
{'0': {'precision': 0.4853921596619461, 'recall': 0.528028575033729, 'f1-score': 0.5058134723793815, 'support': 515135}, '1': {'precision': 0.4610814814532728, 'recall': 0.4654516238159675, 'f1-score': 0.4632562463950689, 'support': 520256}, '2': {'precision': 0.4894249898183943, 'recall': 0.44211933439016265, 'f1-score': 0.4645710249295145, 'support': 519163}, 'accuracy': 0.478395732795387, 'macro avg': {'precision': 0.4786328769778711, 'recall': 0.47853317774661974, 'f1-score': 0.4778802479013216, 'support': 1554554}, 'weighted avg': {'precision': 0.47860302271358696, 'recall': 0.478395732795387, 'f1-score': 0.47779758814048734, 'support': 1554554}}
[[272006 129134 113995]
 [152646 242154 125456]
 [135732 153899 229532]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0571418
{'0': {'precision': 0.4622232550656501, 'recall': 0.4974968349681188, 'f1-score': 0.47921182192972783, 'support': 519742}, '1': {'precision': 0.41051744212420427, 'recall': 0.4265938097838256, 'f1-score': 0.41840125603213285, 'support': 509126}, '2': {'precision': 0.4659235976270423, 'recall': 0.41309831344186454, 'f1-score': 0.437923673912627, 'support': 525686}, 'accuracy': 0.4457355614536388, 'macro avg': {'precision': 0.44622143160563227, 'recall': 0.4457296527312697, 'f1-score': 0.44517891729149595, 'support': 1554554}, 'weighted avg': {'precision': 0.44654058631313426, 'recall': 0.4457355614536388, 'f1-score': 0.44533403990884174, 'support': 1554554}}
[[258570 143413 117759]
 [160770 217190 131166]
 [140065 168461 217160]]
Evaluating performance on  val set...
1786/1786 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0111009
{'0': {'precision': 0.4309030004988953, 'recall': 0.6672289707470499, 'f1-score': 0.5236364536194722, 'support': 126859}, '1': {'precision': 0.5668013522705353, 'recall': 0.5502981617465872, 'f1-score': 0.5584278541279082, 'support': 202910}, '2': {'precision': 0.533776683344574, 'recall': 0.26707684580612756, 'f1-score': 0.356018642019866, 'support': 127424}, 'accuracy': 0.5038069261777849, 'macro avg': {'precision': 0.5104936787046682, 'recall': 0.4948679927665882, 'f1-score': 0.4793609832557488, 'support': 457193}, 'weighted avg': {'precision': 0.5198888570647465, 'recall': 0.5038069261777849, 'f1-score': 0.492360802093527, 'support': 457193}}
[[ 84644  31881  10334]
 [ 71858 111661  19391]
 [ 39932  53460  34032]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0649078
{'0': {'precision': 0.47874790059148553, 'recall': 0.6335244475938929, 'f1-score': 0.5453673279818104, 'support': 155230}, '1': {'precision': 0.42989872661616574, 'recall': 0.5451515610582419, 'f1-score': 0.48071358959490196, 'support': 145222}, '2': {'precision': 0.567898496073821, 'recall': 0.24500928282963616, 'f1-score': 0.34232764614644057, 'support': 156741}, 'accuracy': 0.4722578867130512, 'macro avg': {'precision': 0.4921817077604908, 'recall': 0.474561763827257, 'f1-score': 0.45613618790771765, 'support': 457193}, 'weighted avg': {'precision': 0.4937953285780314, 'recall': 0.4722578867130512, 'f1-score': 0.45522205461458626, 'support': 457193}}
[[98342 41844 15044]
 [51878 79168 14176]
 [55195 63143 38403]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0779586
{'0': {'precision': 0.4751640379447541, 'recall': 0.6203856954233538, 'f1-score': 0.5381498678553857, 'support': 161319}, '1': {'precision': 0.38167845340199175, 'recall': 0.5135996520408852, 'f1-score': 0.4379196132843971, 'support': 133349}, '2': {'precision': 0.5495441816123459, 'recall': 0.22699277034302415, 'f1-score': 0.32127912495591254, 'support': 162525}, 'accuracy': 0.4493944570454928, 'macro avg': {'precision': 0.46879555765303055, 'recall': 0.453659372602421, 'f1-score': 0.4324495353652318, 'support': 457193}, 'weighted avg': {'precision': 0.47433818023560836, 'recall': 0.4493944570454928, 'f1-score': 0.431821639499913, 'support': 457193}}
[[100080  45191  16048]
 [ 50669  68488  14192]
 [ 59873  65760  36892]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0955889
{'0': {'precision': 0.4518143098484308, 'recall': 0.5883935100831691, 'f1-score': 0.5111374911505736, 'support': 161358}, '1': {'precision': 0.34212148151380123, 'recall': 0.47237115575770355, 'f1-score': 0.3968318735785974, 'support': 132796}, '2': {'precision': 0.5093948669649164, 'recall': 0.19903826691773133, 'f1-score': 0.2862346963976996, 'support': 163039}, 'accuracy': 0.4158462618631519, 'macro avg': {'precision': 0.43444355277571617, 'recall': 0.41993431091953465, 'f1-score': 0.39806802037562355, 'support': 457193}, 'weighted avg': {'precision': 0.4404867252620291, 'recall': 0.4158462618631519, 'f1-score': 0.39773405858532873, 'support': 457193}}
[[94942 50721 15695]
 [54508 62729 15559]
 [60685 69903 32451]]
training model: results/AAPL/W1/deepOF_L2/seq2seq
Epoch 1/50
6073/6073 - 184s - loss: 11.9682 - accuracy10: 0.5071 - accuracy20: 0.5066 - accuracy30: 0.4895 - accuracy50: 0.4578 - val_loss: 12.6970 - val_accuracy10: 0.5142 - val_accuracy20: 0.4693 - val_accuracy30: 0.4392 - val_accuracy50: 0.4033 - 184s/epoch - 30ms/step
Epoch 2/50
6073/6073 - 173s - loss: 11.7360 - accuracy10: 0.5310 - accuracy20: 0.5236 - accuracy30: 0.5043 - accuracy50: 0.4701 - val_loss: 12.7864 - val_accuracy10: 0.5168 - val_accuracy20: 0.4705 - val_accuracy30: 0.4393 - val_accuracy50: 0.3998 - 173s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 170s - loss: 11.6650 - accuracy10: 0.5368 - accuracy20: 0.5287 - accuracy30: 0.5088 - accuracy50: 0.4742 - val_loss: 12.7114 - val_accuracy10: 0.5201 - val_accuracy20: 0.4744 - val_accuracy30: 0.4433 - val_accuracy50: 0.4038 - 170s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 172s - loss: 11.6209 - accuracy10: 0.5401 - accuracy20: 0.5313 - accuracy30: 0.5114 - accuracy50: 0.4760 - val_loss: 12.6865 - val_accuracy10: 0.5243 - val_accuracy20: 0.4769 - val_accuracy30: 0.4457 - val_accuracy50: 0.4055 - 172s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 174s - loss: 11.5861 - accuracy10: 0.5420 - accuracy20: 0.5336 - accuracy30: 0.5129 - accuracy50: 0.4773 - val_loss: 12.6135 - val_accuracy10: 0.5241 - val_accuracy20: 0.4810 - val_accuracy30: 0.4508 - val_accuracy50: 0.4098 - 174s/epoch - 29ms/step
Epoch 6/50
6073/6073 - 175s - loss: 11.5596 - accuracy10: 0.5439 - accuracy20: 0.5355 - accuracy30: 0.5147 - accuracy50: 0.4787 - val_loss: 12.5956 - val_accuracy10: 0.5241 - val_accuracy20: 0.4832 - val_accuracy30: 0.4528 - val_accuracy50: 0.4119 - 175s/epoch - 29ms/step
Epoch 7/50
6073/6073 - 176s - loss: 11.5369 - accuracy10: 0.5451 - accuracy20: 0.5372 - accuracy30: 0.5160 - accuracy50: 0.4796 - val_loss: 12.5375 - val_accuracy10: 0.5281 - val_accuracy20: 0.4845 - val_accuracy30: 0.4541 - val_accuracy50: 0.4126 - 176s/epoch - 29ms/step
Epoch 8/50
6073/6073 - 170s - loss: 11.5168 - accuracy10: 0.5465 - accuracy20: 0.5384 - accuracy30: 0.5173 - accuracy50: 0.4809 - val_loss: 12.4775 - val_accuracy10: 0.5310 - val_accuracy20: 0.4885 - val_accuracy30: 0.4586 - val_accuracy50: 0.4181 - 170s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 173s - loss: 11.4984 - accuracy10: 0.5477 - accuracy20: 0.5395 - accuracy30: 0.5182 - accuracy50: 0.4817 - val_loss: 12.4894 - val_accuracy10: 0.5288 - val_accuracy20: 0.4876 - val_accuracy30: 0.4587 - val_accuracy50: 0.4180 - 173s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 173s - loss: 11.4826 - accuracy10: 0.5483 - accuracy20: 0.5405 - accuracy30: 0.5192 - accuracy50: 0.4825 - val_loss: 12.4518 - val_accuracy10: 0.5313 - val_accuracy20: 0.4904 - val_accuracy30: 0.4615 - val_accuracy50: 0.4220 - 173s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 174s - loss: 11.4680 - accuracy10: 0.5489 - accuracy20: 0.5412 - accuracy30: 0.5199 - accuracy50: 0.4831 - val_loss: 12.4426 - val_accuracy10: 0.5328 - val_accuracy20: 0.4903 - val_accuracy30: 0.4614 - val_accuracy50: 0.4217 - 174s/epoch - 29ms/step
Epoch 12/50
6073/6073 - 174s - loss: 11.4557 - accuracy10: 0.5500 - accuracy20: 0.5420 - accuracy30: 0.5207 - accuracy50: 0.4839 - val_loss: 12.3998 - val_accuracy10: 0.5338 - val_accuracy20: 0.4927 - val_accuracy30: 0.4641 - val_accuracy50: 0.4250 - 174s/epoch - 29ms/step
Epoch 13/50
6073/6073 - 171s - loss: 11.4429 - accuracy10: 0.5507 - accuracy20: 0.5430 - accuracy30: 0.5213 - accuracy50: 0.4843 - val_loss: 12.4109 - val_accuracy10: 0.5327 - val_accuracy20: 0.4928 - val_accuracy30: 0.4635 - val_accuracy50: 0.4238 - 171s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 171s - loss: 11.4312 - accuracy10: 0.5514 - accuracy20: 0.5438 - accuracy30: 0.5225 - accuracy50: 0.4851 - val_loss: 12.3874 - val_accuracy10: 0.5354 - val_accuracy20: 0.4947 - val_accuracy30: 0.4659 - val_accuracy50: 0.4280 - 171s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 178s - loss: 11.4221 - accuracy10: 0.5520 - accuracy20: 0.5445 - accuracy30: 0.5230 - accuracy50: 0.4857 - val_loss: 12.3853 - val_accuracy10: 0.5336 - val_accuracy20: 0.4952 - val_accuracy30: 0.4675 - val_accuracy50: 0.4299 - 178s/epoch - 29ms/step
Epoch 16/50
6073/6073 - 171s - loss: 11.4114 - accuracy10: 0.5526 - accuracy20: 0.5451 - accuracy30: 0.5236 - accuracy50: 0.4863 - val_loss: 12.3499 - val_accuracy10: 0.5340 - val_accuracy20: 0.4979 - val_accuracy30: 0.4693 - val_accuracy50: 0.4303 - 171s/epoch - 28ms/step
Epoch 17/50
6073/6073 - 173s - loss: 11.4018 - accuracy10: 0.5527 - accuracy20: 0.5456 - accuracy30: 0.5243 - accuracy50: 0.4869 - val_loss: 12.3364 - val_accuracy10: 0.5354 - val_accuracy20: 0.4979 - val_accuracy30: 0.4701 - val_accuracy50: 0.4327 - 173s/epoch - 28ms/step
Epoch 18/50
6073/6073 - 174s - loss: 11.3915 - accuracy10: 0.5533 - accuracy20: 0.5463 - accuracy30: 0.5248 - accuracy50: 0.4872 - val_loss: 12.3671 - val_accuracy10: 0.5367 - val_accuracy20: 0.4962 - val_accuracy30: 0.4675 - val_accuracy50: 0.4301 - 174s/epoch - 29ms/step
Epoch 19/50
6073/6073 - 174s - loss: 11.3842 - accuracy10: 0.5535 - accuracy20: 0.5464 - accuracy30: 0.5252 - accuracy50: 0.4876 - val_loss: 12.3314 - val_accuracy10: 0.5365 - val_accuracy20: 0.4992 - val_accuracy30: 0.4701 - val_accuracy50: 0.4323 - 174s/epoch - 29ms/step
Epoch 20/50
6073/6073 - 177s - loss: 11.3754 - accuracy10: 0.5541 - accuracy20: 0.5472 - accuracy30: 0.5258 - accuracy50: 0.4883 - val_loss: 12.3410 - val_accuracy10: 0.5363 - val_accuracy20: 0.4988 - val_accuracy30: 0.4709 - val_accuracy50: 0.4333 - 177s/epoch - 29ms/step
Epoch 21/50
6073/6073 - 175s - loss: 11.3677 - accuracy10: 0.5544 - accuracy20: 0.5475 - accuracy30: 0.5264 - accuracy50: 0.4890 - val_loss: 12.3183 - val_accuracy10: 0.5369 - val_accuracy20: 0.4997 - val_accuracy30: 0.4718 - val_accuracy50: 0.4352 - 175s/epoch - 29ms/step
Epoch 22/50
6073/6073 - 173s - loss: 11.3601 - accuracy10: 0.5548 - accuracy20: 0.5482 - accuracy30: 0.5269 - accuracy50: 0.4894 - val_loss: 12.3501 - val_accuracy10: 0.5365 - val_accuracy20: 0.4985 - val_accuracy30: 0.4706 - val_accuracy50: 0.4334 - 173s/epoch - 28ms/step
Epoch 23/50
6073/6073 - 175s - loss: 11.3530 - accuracy10: 0.5549 - accuracy20: 0.5486 - accuracy30: 0.5273 - accuracy50: 0.4900 - val_loss: 12.3736 - val_accuracy10: 0.5361 - val_accuracy20: 0.4978 - val_accuracy30: 0.4690 - val_accuracy50: 0.4328 - 175s/epoch - 29ms/step
Epoch 24/50
6073/6073 - 174s - loss: 11.3466 - accuracy10: 0.5552 - accuracy20: 0.5491 - accuracy30: 0.5279 - accuracy50: 0.4902 - val_loss: 12.3733 - val_accuracy10: 0.5368 - val_accuracy20: 0.4992 - val_accuracy30: 0.4708 - val_accuracy50: 0.4340 - 174s/epoch - 29ms/step
Epoch 25/50
6073/6073 - 173s - loss: 11.3375 - accuracy10: 0.5557 - accuracy20: 0.5499 - accuracy30: 0.5286 - accuracy50: 0.4910 - val_loss: 12.3804 - val_accuracy10: 0.5363 - val_accuracy20: 0.4975 - val_accuracy30: 0.4693 - val_accuracy50: 0.4337 - 173s/epoch - 29ms/step
Epoch 26/50
6073/6073 - 174s - loss: 11.3321 - accuracy10: 0.5556 - accuracy20: 0.5497 - accuracy30: 0.5287 - accuracy50: 0.4913 - val_loss: 12.3813 - val_accuracy10: 0.5358 - val_accuracy20: 0.4977 - val_accuracy30: 0.4699 - val_accuracy50: 0.4341 - 174s/epoch - 29ms/step
Epoch 27/50
6073/6073 - 172s - loss: 11.3232 - accuracy10: 0.5562 - accuracy20: 0.5502 - accuracy30: 0.5295 - accuracy50: 0.4919 - val_loss: 12.3333 - val_accuracy10: 0.5365 - val_accuracy20: 0.5005 - val_accuracy30: 0.4731 - val_accuracy50: 0.4366 - 172s/epoch - 28ms/step
Epoch 28/50
6073/6073 - 176s - loss: 11.3174 - accuracy10: 0.5565 - accuracy20: 0.5511 - accuracy30: 0.5298 - accuracy50: 0.4921 - val_loss: 12.4009 - val_accuracy10: 0.5348 - val_accuracy20: 0.4972 - val_accuracy30: 0.4693 - val_accuracy50: 0.4329 - 176s/epoch - 29ms/step
Epoch 29/50
6073/6073 - 174s - loss: 11.3113 - accuracy10: 0.5568 - accuracy20: 0.5512 - accuracy30: 0.5302 - accuracy50: 0.4925 - val_loss: 12.4021 - val_accuracy10: 0.5360 - val_accuracy20: 0.4986 - val_accuracy30: 0.4698 - val_accuracy50: 0.4337 - 174s/epoch - 29ms/step
Epoch 30/50
6073/6073 - 173s - loss: 11.3047 - accuracy10: 0.5571 - accuracy20: 0.5516 - accuracy30: 0.5307 - accuracy50: 0.4933 - val_loss: 12.3952 - val_accuracy10: 0.5351 - val_accuracy20: 0.4979 - val_accuracy30: 0.4705 - val_accuracy50: 0.4356 - 173s/epoch - 29ms/step
Epoch 31/50
6073/6073 - 177s - loss: 11.2990 - accuracy10: 0.5571 - accuracy20: 0.5518 - accuracy30: 0.5310 - accuracy50: 0.4940 - val_loss: 12.3995 - val_accuracy10: 0.5361 - val_accuracy20: 0.4980 - val_accuracy30: 0.4700 - val_accuracy50: 0.4354 - 177s/epoch - 29ms/step
testing model: results/AAPL/W1/deepOF_L2/seq2seq
Evaluating performance on  test set...
21353/21353 - 213s - 213s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9919128
{'0': {'precision': 0.5002988375789207, 'recall': 0.5823271240063452, 'f1-score': 0.538205425638327, 'support': 1805456}, '1': {'precision': 0.5222318198885075, 'recall': 0.4157611891538713, 'f1-score': 0.46295381811534697, 'support': 1836600}, '2': {'precision': 0.5038492569281106, 'recall': 0.5255093314387586, 'f1-score': 0.5144514052664385, 'support': 1824156}, 'accuracy': 0.5074014692441493, 'macro avg': {'precision': 0.5087933047985129, 'recall': 0.5078658815329917, 'f1-score': 0.5052035496733708, 'support': 5466212}, 'weighted avg': {'precision': 0.5088529577023495, 'recall': 0.5074014692441493, 'f1-score': 0.504994466904526, 'support': 5466212}}
[[1051366  329562  424528]
 [ 553577  763587  519436]
 [ 496533  369012  958611]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0091927
{'0': {'precision': 0.5330775235119102, 'recall': 0.5632495054833516, 'f1-score': 0.5477483334102325, 'support': 2118230}, '1': {'precision': 0.37902245989969485, 'recall': 0.4047694107301371, 'f1-score': 0.3914730517013539, 'support': 1205390}, '2': {'precision': 0.5436606916976802, 'recall': 0.4924628674054603, 'f1-score': 0.5167968641902565, 'support': 2142592}, 'accuracy': 0.5005557779317743, 'macro avg': {'precision': 0.4852535583697617, 'recall': 0.4868272612063163, 'f1-score': 0.4853394164339477, 'support': 5466212}, 'weighted avg': {'precision': 0.5032541244856663, 'recall': 0.5005557779317743, 'f1-score': 0.501155001106613, 'support': 5466212}}
[[1193092  379926  545212]
 [ 377025  487905  340460]
 [ 668004  419441 1055147]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0302929
{'0': {'precision': 0.5223751756270693, 'recall': 0.5473304889885736, 'f1-score': 0.5345617393064608, 'support': 2161482}, '1': {'precision': 0.3273593661306379, 'recall': 0.3453702642402659, 'f1-score': 0.33612371353326465, 'support': 1125453}, '2': {'precision': 0.5302031283513795, 'recall': 0.4900157253988364, 'f1-score': 0.5093179166270209, 'support': 2179277}, 'accuracy': 0.48289802883605687, 'macro avg': {'precision': 0.45997922336969554, 'recall': 0.460905492875892, 'f1-score': 0.4600011231555821, 'support': 5466212}, 'weighted avg': {'precision': 0.4853437084033299, 'recall': 0.48289802883605687, 'f1-score': 0.48364056142717204, 'support': 5466212}}
[[1183045  380470  597967]
 [ 388506  388698  348249]
 [ 693191  418206 1067880]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0620706
{'0': {'precision': 0.4837155894963273, 'recall': 0.5224380126784498, 'f1-score': 0.5023316732789435, 'support': 2081958}, '1': {'precision': 0.3020319944012763, 'recall': 0.2769975888523077, 'f1-score': 0.28897360903499014, 'support': 1286939}, '2': {'precision': 0.490545422417686, 'recall': 0.4765130655147176, 'f1-score': 0.4834274367628582, 'support': 2097315}, 'accuracy': 0.44703187509009895, 'macro avg': {'precision': 0.4254310021050965, 'recall': 0.4253162223484917, 'f1-score': 0.42491090635893064, 'support': 5466212}, 'weighted avg': {'precision': 0.4435613852403324, 'recall': 0.44703187509009895, 'f1-score': 0.4448463520640359, 'support': 5466212}}
[[1087694  393058  601206]
 [ 493744  356479  436716]
 [ 667185  430732  999398]]
Evaluating performance on  train set...
6073/6073 - 63s - 63s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.905038
{'0': {'precision': 0.49042364044202047, 'recall': 0.49811286250565123, 'f1-score': 0.4942383465913315, 'support': 393718}, '1': {'precision': 0.632095071251277, 'recall': 0.6492926050898978, 'f1-score': 0.640578433919559, 'support': 765202}, '2': {'precision': 0.49991726367929773, 'recall': 0.46581048598069424, 'f1-score': 0.48226159728055645, 'support': 395633}, 'accuracy': 0.5643075533609984, 'macro avg': {'precision': 0.540811991790865, 'recall': 0.5377386511920811, 'f1-score': 0.5390261259304823, 'support': 1554553}, 'weighted avg': {'precision': 0.5625750903059611, 'recall': 0.5643075533609984, 'f1-score': 0.5632236627842594, 'support': 1554553}}
[[196116 142860  54742]
 [138753 496840 129609]
 [ 65022 146321 184290]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97952497
{'0': {'precision': 0.5361357147729156, 'recall': 0.4472933314906797, 'f1-score': 0.4877015396342814, 'support': 492044}, '1': {'precision': 0.49265103922047904, 'recall': 0.6782785043863745, 'f1-score': 0.5707510104110142, 'support': 567553}, '2': {'precision': 0.5527958703073554, 'recall': 0.40501984014740705, 'f1-score': 0.467508086539381, 'support': 494956}, 'accuracy': 0.5181643855178949, 'macro avg': {'precision': 0.52719420810025, 'recall': 0.510197225341487, 'f1-score': 0.5086535455282255, 'support': 1554553}, 'weighted avg': {'precision': 0.5255643067082771, 'recall': 0.5181643855178949, 'f1-score': 0.5115927196183073, 'support': 1554553}}
[[220088 195987  75969]
 [ 96388 384959  86206]
 [ 94032 200457 200467]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0132668
{'0': {'precision': 0.5251838840443196, 'recall': 0.42441801757016023, 'f1-score': 0.4694546262953444, 'support': 514964}, '1': {'precision': 0.44112513072370446, 'recall': 0.6588726240818624, 'f1-score': 0.5284470284755364, 'support': 520483}, '2': {'precision': 0.5415370466299714, 'recall': 0.3765897523819798, 'f1-score': 0.4442464864668326, 'support': 519106}, 'accuracy': 0.486945121845315, 'macro avg': {'precision': 0.5026153537993318, 'recall': 0.4866267980113341, 'f1-score': 0.4807160470792378, 'support': 1554553}, 'weighted avg': {'precision': 0.5025007543682093, 'recall': 0.486945121845315, 'f1-score': 0.48078833175931596, 'support': 1554553}}
[[218560 213410  82994]
 [ 95044 342932  82507]
 [102555 221061 195490]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0500131
{'0': {'precision': 0.49370316625829624, 'recall': 0.3993350124781368, 'f1-score': 0.44153310519647815, 'support': 519709}, '1': {'precision': 0.393999219574011, 'recall': 0.600732802123791, 'f1-score': 0.47588345412929306, 'support': 509278}, '2': {'precision': 0.5060416456984377, 'recall': 0.3443963270074548, 'f1-score': 0.40985677894140954, 'support': 525566}, 'accuracy': 0.4467399953555781, 'macro avg': {'precision': 0.4645813438435817, 'recall': 0.44815471386979416, 'f1-score': 0.4424244460890603, 'support': 1554553}, 'weighted avg': {'precision': 0.46521115519528194, 'recall': 0.4467399953555781, 'f1-score': 0.4420772339069401, 'support': 1554553}}
[[207538 228824  83347]
 [110004 305940  93334]
 [102828 241735 181003]]
Evaluating performance on  val set...
1786/1786 - 20s - 20s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9418244
{'0': {'precision': 0.5020364104055979, 'recall': 0.5177649343881756, 'f1-score': 0.5097793808983349, 'support': 126654}, '1': {'precision': 0.5923282646901505, 'recall': 0.572533630078979, 'f1-score': 0.5822627611123768, 'support': 203092}, '2': {'precision': 0.48713775764787165, 'recall': 0.4979128415171916, 'f1-score': 0.4924663673649941, 'support': 127446}, 'accuracy': 0.5365601322857793, 'macro avg': {'precision': 0.5271674775812066, 'recall': 0.5294038019947821, 'f1-score': 0.5281695031252353, 'support': 457192}, 'weighted avg': {'precision': 0.5379923754509118, 'recall': 0.5365601322857793, 'f1-score': 0.53715151411952, 'support': 457192}}
[[ 65577  39002  22075]
 [ 42082 116277  44733]
 [ 22963  41026  63457]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0017114
{'0': {'precision': 0.5407038722531411, 'recall': 0.4739857570972835, 'f1-score': 0.5051513819440628, 'support': 155165}, '1': {'precision': 0.44766319852324216, 'recall': 0.5874491614652508, 'f1-score': 0.508117535364478, 'support': 145313}, '2': {'precision': 0.5321684484806682, 'recall': 0.4431001697359521, 'f1-score': 0.4835671433396356, 'support': 156714}, 'accuracy': 0.49946193284221946, 'macro avg': {'precision': 0.5068451730856838, 'recall': 0.5015116960994955, 'f1-score': 0.4989453535493921, 'support': 457192}, 'weighted avg': {'precision': 0.5082062786320976, 'recall': 0.49946193284221946, 'f1-score': 0.49869560031036536, 'support': 457192}}
[[73546 51243 30376]
 [29280 85364 30669]
 [33193 54081 69440]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0291578
{'0': {'precision': 0.5312432072108627, 'recall': 0.45454489094989525, 'f1-score': 0.48991032888318703, 'support': 161302}, '1': {'precision': 0.39515641630430715, 'recall': 0.5543741699244397, 'f1-score': 0.46141643767174617, 'support': 133271}, '2': {'precision': 0.5194578281357548, 'recall': 0.42231842527625924, 'f1-score': 0.4658784104630497, 'support': 162619}, 'accuracy': 0.47218236539571995, 'macro avg': {'precision': 0.4819524838836416, 'recall': 0.4770791620501981, 'f1-score': 0.472401725672661, 'support': 457192}, 'weighted avg': {'precision': 0.48738209575063907, 'recall': 0.47218236539571995, 'f1-score': 0.4730564558556531, 'support': 457192}}
[[73319 54670 33313]
 [29170 73882 30219]
 [35525 58417 68677]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602396
{'0': {'precision': 0.4975139119751391, 'recall': 0.42665104863900044, 'f1-score': 0.45936567886241253, 'support': 161352}, '1': {'precision': 0.3492868479695608, 'recall': 0.49222438943571284, 'f1-score': 0.4086160655676213, 'support': 132787}, '2': {'precision': 0.4914613311059645, 'recall': 0.3969445517715099, 'f1-score': 0.439175159797522, 'support': 163053}, 'accuracy': 0.43510166407111234, 'macro avg': {'precision': 0.4460873636835548, 'recall': 0.43860666328207437, 'f1-score': 0.435718968075852, 'support': 457192}, 'weighted avg': {'precision': 0.45230420004542415, 'recall': 0.43510166407111234, 'f1-score': 0.4374251952020181, 'support': 457192}}
[[68841 59108 33403]
 [33857 65361 33569]
 [35672 62658 64723]]
training model: results/AAPL/W1/deepVOL_L2/seq2seq
Epoch 1/50
6073/6073 - 177s - loss: 12.2448 - accuracy10: 0.4726 - accuracy20: 0.4824 - accuracy30: 0.4712 - accuracy50: 0.4430 - val_loss: 12.7090 - val_accuracy10: 0.4902 - val_accuracy20: 0.4705 - val_accuracy30: 0.4506 - val_accuracy50: 0.4171 - 177s/epoch - 29ms/step
Epoch 2/50
6073/6073 - 172s - loss: 11.9181 - accuracy10: 0.5131 - accuracy20: 0.5129 - accuracy30: 0.4967 - accuracy50: 0.4617 - val_loss: 12.5340 - val_accuracy10: 0.5090 - val_accuracy20: 0.4825 - val_accuracy30: 0.4586 - val_accuracy50: 0.4210 - 172s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 171s - loss: 11.7826 - accuracy10: 0.5250 - accuracy20: 0.5219 - accuracy30: 0.5041 - accuracy50: 0.4687 - val_loss: 12.5069 - val_accuracy10: 0.5153 - val_accuracy20: 0.4884 - val_accuracy30: 0.4636 - val_accuracy50: 0.4244 - 171s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 172s - loss: 11.7081 - accuracy10: 0.5307 - accuracy20: 0.5266 - accuracy30: 0.5082 - accuracy50: 0.4725 - val_loss: 12.4530 - val_accuracy10: 0.5168 - val_accuracy20: 0.4913 - val_accuracy30: 0.4648 - val_accuracy50: 0.4256 - 172s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 172s - loss: 11.6615 - accuracy10: 0.5340 - accuracy20: 0.5299 - accuracy30: 0.5106 - accuracy50: 0.4744 - val_loss: 12.4312 - val_accuracy10: 0.5190 - val_accuracy20: 0.4934 - val_accuracy30: 0.4678 - val_accuracy50: 0.4284 - 172s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 172s - loss: 11.6283 - accuracy10: 0.5365 - accuracy20: 0.5321 - accuracy30: 0.5124 - accuracy50: 0.4758 - val_loss: 12.3863 - val_accuracy10: 0.5187 - val_accuracy20: 0.4967 - val_accuracy30: 0.4699 - val_accuracy50: 0.4303 - 172s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 171s - loss: 11.5998 - accuracy10: 0.5389 - accuracy20: 0.5341 - accuracy30: 0.5137 - accuracy50: 0.4770 - val_loss: 12.3802 - val_accuracy10: 0.5180 - val_accuracy20: 0.4972 - val_accuracy30: 0.4695 - val_accuracy50: 0.4307 - 171s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 173s - loss: 11.5788 - accuracy10: 0.5402 - accuracy20: 0.5358 - accuracy30: 0.5155 - accuracy50: 0.4784 - val_loss: 12.3543 - val_accuracy10: 0.5214 - val_accuracy20: 0.5004 - val_accuracy30: 0.4719 - val_accuracy50: 0.4322 - 173s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 172s - loss: 11.5599 - accuracy10: 0.5414 - accuracy20: 0.5368 - accuracy30: 0.5162 - accuracy50: 0.4790 - val_loss: 12.3237 - val_accuracy10: 0.5212 - val_accuracy20: 0.5015 - val_accuracy30: 0.4726 - val_accuracy50: 0.4327 - 172s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 173s - loss: 11.5414 - accuracy10: 0.5429 - accuracy20: 0.5382 - accuracy30: 0.5173 - accuracy50: 0.4801 - val_loss: 12.3128 - val_accuracy10: 0.5226 - val_accuracy20: 0.5029 - val_accuracy30: 0.4740 - val_accuracy50: 0.4334 - 173s/epoch - 29ms/step
Epoch 11/50
6073/6073 - 173s - loss: 11.5263 - accuracy10: 0.5437 - accuracy20: 0.5391 - accuracy30: 0.5182 - accuracy50: 0.4804 - val_loss: 12.3022 - val_accuracy10: 0.5234 - val_accuracy20: 0.5031 - val_accuracy30: 0.4742 - val_accuracy50: 0.4341 - 173s/epoch - 29ms/step
Epoch 12/50
6073/6073 - 173s - loss: 11.5117 - accuracy10: 0.5450 - accuracy20: 0.5402 - accuracy30: 0.5190 - accuracy50: 0.4815 - val_loss: 12.2812 - val_accuracy10: 0.5229 - val_accuracy20: 0.5043 - val_accuracy30: 0.4756 - val_accuracy50: 0.4351 - 173s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 175s - loss: 11.4994 - accuracy10: 0.5460 - accuracy20: 0.5411 - accuracy30: 0.5199 - accuracy50: 0.4822 - val_loss: 12.2424 - val_accuracy10: 0.5252 - val_accuracy20: 0.5057 - val_accuracy30: 0.4765 - val_accuracy50: 0.4350 - 175s/epoch - 29ms/step
Epoch 14/50
6073/6073 - 172s - loss: 11.4870 - accuracy10: 0.5465 - accuracy20: 0.5414 - accuracy30: 0.5201 - accuracy50: 0.4824 - val_loss: 12.2561 - val_accuracy10: 0.5248 - val_accuracy20: 0.5068 - val_accuracy30: 0.4777 - val_accuracy50: 0.4369 - 172s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 175s - loss: 11.4768 - accuracy10: 0.5471 - accuracy20: 0.5422 - accuracy30: 0.5207 - accuracy50: 0.4828 - val_loss: 12.2449 - val_accuracy10: 0.5254 - val_accuracy20: 0.5066 - val_accuracy30: 0.4782 - val_accuracy50: 0.4375 - 175s/epoch - 29ms/step
Epoch 16/50
6073/6073 - 175s - loss: 11.4691 - accuracy10: 0.5477 - accuracy20: 0.5429 - accuracy30: 0.5212 - accuracy50: 0.4836 - val_loss: 12.2404 - val_accuracy10: 0.5260 - val_accuracy20: 0.5070 - val_accuracy30: 0.4781 - val_accuracy50: 0.4368 - 175s/epoch - 29ms/step
Epoch 17/50
6073/6073 - 178s - loss: 11.4580 - accuracy10: 0.5484 - accuracy20: 0.5436 - accuracy30: 0.5223 - accuracy50: 0.4843 - val_loss: 12.2306 - val_accuracy10: 0.5252 - val_accuracy20: 0.5070 - val_accuracy30: 0.4791 - val_accuracy50: 0.4377 - 178s/epoch - 29ms/step
Epoch 18/50
6073/6073 - 168s - loss: 11.4485 - accuracy10: 0.5490 - accuracy20: 0.5440 - accuracy30: 0.5225 - accuracy50: 0.4845 - val_loss: 12.2323 - val_accuracy10: 0.5273 - val_accuracy20: 0.5067 - val_accuracy30: 0.4782 - val_accuracy50: 0.4370 - 168s/epoch - 28ms/step
Epoch 19/50
6073/6073 - 196s - loss: 11.4404 - accuracy10: 0.5494 - accuracy20: 0.5443 - accuracy30: 0.5228 - accuracy50: 0.4846 - val_loss: 12.2391 - val_accuracy10: 0.5260 - val_accuracy20: 0.5069 - val_accuracy30: 0.4785 - val_accuracy50: 0.4373 - 196s/epoch - 32ms/step
Epoch 20/50
6073/6073 - 245s - loss: 11.4327 - accuracy10: 0.5501 - accuracy20: 0.5450 - accuracy30: 0.5231 - accuracy50: 0.4853 - val_loss: 12.2381 - val_accuracy10: 0.5269 - val_accuracy20: 0.5072 - val_accuracy30: 0.4785 - val_accuracy50: 0.4375 - 245s/epoch - 40ms/step
Epoch 21/50
6073/6073 - 191s - loss: 11.4257 - accuracy10: 0.5504 - accuracy20: 0.5453 - accuracy30: 0.5236 - accuracy50: 0.4855 - val_loss: 12.2240 - val_accuracy10: 0.5275 - val_accuracy20: 0.5083 - val_accuracy30: 0.4802 - val_accuracy50: 0.4391 - 191s/epoch - 31ms/step
Epoch 22/50
6073/6073 - 249s - loss: 11.4165 - accuracy10: 0.5509 - accuracy20: 0.5460 - accuracy30: 0.5241 - accuracy50: 0.4860 - val_loss: 12.2399 - val_accuracy10: 0.5277 - val_accuracy20: 0.5074 - val_accuracy30: 0.4786 - val_accuracy50: 0.4372 - 249s/epoch - 41ms/step
Epoch 23/50
6073/6073 - 212s - loss: 11.4103 - accuracy10: 0.5512 - accuracy20: 0.5462 - accuracy30: 0.5245 - accuracy50: 0.4864 - val_loss: 12.2375 - val_accuracy10: 0.5277 - val_accuracy20: 0.5061 - val_accuracy30: 0.4777 - val_accuracy50: 0.4374 - 212s/epoch - 35ms/step
Epoch 24/50
6073/6073 - 171s - loss: 11.4040 - accuracy10: 0.5517 - accuracy20: 0.5466 - accuracy30: 0.5249 - accuracy50: 0.4867 - val_loss: 12.2396 - val_accuracy10: 0.5267 - val_accuracy20: 0.5078 - val_accuracy30: 0.4790 - val_accuracy50: 0.4377 - 171s/epoch - 28ms/step
Epoch 25/50
6073/6073 - 167s - loss: 11.3961 - accuracy10: 0.5519 - accuracy20: 0.5473 - accuracy30: 0.5257 - accuracy50: 0.4870 - val_loss: 12.2430 - val_accuracy10: 0.5271 - val_accuracy20: 0.5068 - val_accuracy30: 0.4779 - val_accuracy50: 0.4373 - 167s/epoch - 28ms/step
Epoch 26/50
6073/6073 - 167s - loss: 11.3897 - accuracy10: 0.5526 - accuracy20: 0.5476 - accuracy30: 0.5260 - accuracy50: 0.4878 - val_loss: 12.2434 - val_accuracy10: 0.5272 - val_accuracy20: 0.5064 - val_accuracy30: 0.4778 - val_accuracy50: 0.4367 - 167s/epoch - 28ms/step
Epoch 27/50
6073/6073 - 166s - loss: 11.3824 - accuracy10: 0.5532 - accuracy20: 0.5482 - accuracy30: 0.5265 - accuracy50: 0.4881 - val_loss: 12.2354 - val_accuracy10: 0.5279 - val_accuracy20: 0.5070 - val_accuracy30: 0.4784 - val_accuracy50: 0.4376 - 166s/epoch - 27ms/step
Epoch 28/50
6073/6073 - 167s - loss: 11.3762 - accuracy10: 0.5532 - accuracy20: 0.5484 - accuracy30: 0.5268 - accuracy50: 0.4886 - val_loss: 12.2298 - val_accuracy10: 0.5284 - val_accuracy20: 0.5077 - val_accuracy30: 0.4794 - val_accuracy50: 0.4384 - 167s/epoch - 28ms/step
Epoch 29/50
6073/6073 - 168s - loss: 11.3726 - accuracy10: 0.5533 - accuracy20: 0.5487 - accuracy30: 0.5270 - accuracy50: 0.4885 - val_loss: 12.2073 - val_accuracy10: 0.5296 - val_accuracy20: 0.5081 - val_accuracy30: 0.4789 - val_accuracy50: 0.4377 - 168s/epoch - 28ms/step
Epoch 30/50
6073/6073 - 166s - loss: 11.3645 - accuracy10: 0.5538 - accuracy20: 0.5490 - accuracy30: 0.5275 - accuracy50: 0.4889 - val_loss: 12.2511 - val_accuracy10: 0.5269 - val_accuracy20: 0.5068 - val_accuracy30: 0.4784 - val_accuracy50: 0.4374 - 166s/epoch - 27ms/step
Epoch 31/50
6073/6073 - 167s - loss: 11.3593 - accuracy10: 0.5542 - accuracy20: 0.5496 - accuracy30: 0.5280 - accuracy50: 0.4895 - val_loss: 12.2333 - val_accuracy10: 0.5286 - val_accuracy20: 0.5072 - val_accuracy30: 0.4785 - val_accuracy50: 0.4372 - 167s/epoch - 27ms/step
Epoch 32/50
6073/6073 - 169s - loss: 11.3538 - accuracy10: 0.5546 - accuracy20: 0.5501 - accuracy30: 0.5284 - accuracy50: 0.4902 - val_loss: 12.2357 - val_accuracy10: 0.5281 - val_accuracy20: 0.5078 - val_accuracy30: 0.4790 - val_accuracy50: 0.4380 - 169s/epoch - 28ms/step
Epoch 33/50
6073/6073 - 170s - loss: 11.3478 - accuracy10: 0.5547 - accuracy20: 0.5502 - accuracy30: 0.5289 - accuracy50: 0.4901 - val_loss: 12.2364 - val_accuracy10: 0.5264 - val_accuracy20: 0.5075 - val_accuracy30: 0.4795 - val_accuracy50: 0.4387 - 170s/epoch - 28ms/step
Epoch 34/50
6073/6073 - 167s - loss: 11.3426 - accuracy10: 0.5549 - accuracy20: 0.5505 - accuracy30: 0.5290 - accuracy50: 0.4907 - val_loss: 12.2448 - val_accuracy10: 0.5274 - val_accuracy20: 0.5067 - val_accuracy30: 0.4781 - val_accuracy50: 0.4378 - 167s/epoch - 28ms/step
Epoch 35/50
6073/6073 - 168s - loss: 11.3364 - accuracy10: 0.5555 - accuracy20: 0.5509 - accuracy30: 0.5298 - accuracy50: 0.4911 - val_loss: 12.2369 - val_accuracy10: 0.5274 - val_accuracy20: 0.5067 - val_accuracy30: 0.4783 - val_accuracy50: 0.4374 - 168s/epoch - 28ms/step
Epoch 36/50
6073/6073 - 168s - loss: 11.3319 - accuracy10: 0.5557 - accuracy20: 0.5512 - accuracy30: 0.5299 - accuracy50: 0.4913 - val_loss: 12.2503 - val_accuracy10: 0.5269 - val_accuracy20: 0.5062 - val_accuracy30: 0.4783 - val_accuracy50: 0.4380 - 168s/epoch - 28ms/step
Epoch 37/50
6073/6073 - 169s - loss: 11.3271 - accuracy10: 0.5557 - accuracy20: 0.5515 - accuracy30: 0.5300 - accuracy50: 0.4920 - val_loss: 12.2483 - val_accuracy10: 0.5264 - val_accuracy20: 0.5071 - val_accuracy30: 0.4794 - val_accuracy50: 0.4395 - 169s/epoch - 28ms/step
Epoch 38/50
6073/6073 - 169s - loss: 11.3207 - accuracy10: 0.5559 - accuracy20: 0.5518 - accuracy30: 0.5304 - accuracy50: 0.4921 - val_loss: 12.2450 - val_accuracy10: 0.5255 - val_accuracy20: 0.5064 - val_accuracy30: 0.4786 - val_accuracy50: 0.4384 - 169s/epoch - 28ms/step
Epoch 39/50
6073/6073 - 168s - loss: 11.3168 - accuracy10: 0.5562 - accuracy20: 0.5517 - accuracy30: 0.5305 - accuracy50: 0.4923 - val_loss: 12.2419 - val_accuracy10: 0.5284 - val_accuracy20: 0.5074 - val_accuracy30: 0.4790 - val_accuracy50: 0.4388 - 168s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/seq2seq
Evaluating performance on  test set...
21353/21353 - 195s - 195s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0051045
{'0': {'precision': 0.4950573623560748, 'recall': 0.5808119495507231, 'f1-score': 0.5345170246744236, 'support': 1805457}, '1': {'precision': 0.525783386448889, 'recall': 0.3683908480938429, 'f1-score': 0.43323500088684896, 'support': 1836601}, '2': {'precision': 0.4920150844241628, 'recall': 0.5559498925258161, 'f1-score': 0.5220322039822328, 'support': 1824159}, 'accuracy': 0.5011434782043962, 'macro avg': {'precision': 0.5042852777430422, 'recall': 0.5017175633901273, 'f1-score': 0.4965947431811684, 'support': 5466217}, 'weighted avg': {'precision': 0.5043657831349952, 'recall': 0.5011434782043962, 'f1-score': 0.49632077959316734, 'support': 5466217}}
[[1048631  302200  454626]
 [ 567582  676587  592432]
 [ 501988  308030 1014141]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0174598
{'0': {'precision': 0.5349668222042234, 'recall': 0.537568376631255, 'f1-score': 0.5362644442367045, 'support': 2118231}, '1': {'precision': 0.3708958049791414, 'recall': 0.38840840855788705, 'f1-score': 0.37945015129491183, 'support': 1205391}, '2': {'precision': 0.5339511481999192, 'recall': 0.5172004041827784, 'f1-score': 0.5254423095068865, 'support': 2142595}, 'accuracy': 0.49669250232839274, 'macro avg': {'precision': 0.4799379251277613, 'recall': 0.48105906312397345, 'f1-score': 0.4803856350128343, 'support': 5466217}, 'weighted avg': {'precision': 0.49838834287067135, 'recall': 0.49669250232839274, 'f1-score': 0.49744235042944535, 'support': 5466217}}
[[1138694  392522  587015]
 [ 356994  468184  380213]
 [ 632844  401600 1108151]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0425031
{'0': {'precision': 0.5238991635316538, 'recall': 0.5097551079513464, 'f1-score': 0.5167303653252313, 'support': 2161483}, '1': {'precision': 0.3077048642674546, 'recall': 0.36513054720090987, 'f1-score': 0.3339670996839024, 'support': 1125455}, '2': {'precision': 0.5238028304469088, 'recall': 0.48734466766302065, 'f1-score': 0.5049164771752137, 'support': 2179279}, 'accuracy': 0.4710433193559641, 'macro avg': {'precision': 0.45180228608200573, 'recall': 0.454076774271759, 'f1-score': 0.45187131406144915, 'support': 5466217}, 'weighted avg': {'precision': 0.4793478967694708, 'recall': 0.4710433193559641, 'f1-score': 0.47439073821455424, 'support': 5466217}}
[[1101827  459248  600408]
 [ 349390  410938  365127]
 [ 651911  465308 1062060]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078679
{'0': {'precision': 0.4799962193458014, 'recall': 0.47565588404393744, 'f1-score': 0.47781619533057856, 'support': 2081961}, '1': {'precision': 0.2799756646689597, 'recall': 0.3189695564909347, 'f1-score': 0.29820327613523845, 'support': 1286941}, '2': {'precision': 0.4865540365769856, 'recall': 0.4493397510626682, 'f1-score': 0.467207011225973, 'support': 2097315}, 'accuracy': 0.4286692240721508, 'macro avg': {'precision': 0.4155086401972489, 'recall': 0.4146550638658468, 'f1-score': 0.41440882756393, 'support': 5466217}, 'weighted avg': {'precision': 0.4354204470685302, 'recall': 0.4286692240721508, 'f1-score': 0.43145835209045086, 'support': 5466217}}
[[990297 530971 560693]
 [442645 410495 433801]
 [630193 524715 942407]]
Evaluating performance on  train set...
6073/6073 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9086275
{'0': {'precision': 0.48539746509437337, 'recall': 0.517484739781819, 'f1-score': 0.5009277853247495, 'support': 393343}, '1': {'precision': 0.6636817448736656, 'recall': 0.5644612412164218, 'f1-score': 0.6100635279882474, 'support': 765491}, '2': {'precision': 0.46441974640562295, 'recall': 0.5682123723845143, 'f1-score': 0.5110998216800264, 'support': 395720}, 'accuracy': 0.5535298227015594, 'macro avg': {'precision': 0.5378329854578873, 'recall': 0.5500527844609183, 'f1-score': 0.5406970449976743, 'support': 1554554}, 'weighted avg': {'precision': 0.5678479356299854, 'recall': 0.5535298227015594, 'f1-score': 0.5572575796025513, 'support': 1554554}}
[[203549 112917  76877]
 [150972 432090 182429]
 [ 64824 106043 224853]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9648287
{'0': {'precision': 0.5417271023618557, 'recall': 0.4470637965793068, 'f1-score': 0.4898640862312572, 'support': 492064}, '1': {'precision': 0.5184807724540862, 'recall': 0.6106103759684731, 'f1-score': 0.5607868591351866, 'support': 567388}, '2': {'precision': 0.5211809264429994, 'recall': 0.5055645099393661, 'f1-score': 0.5132539582455462, 'support': 495102}, 'accuracy': 0.525387345823947, 'macro avg': {'precision': 0.5271296004196472, 'recall': 0.5210795608290487, 'f1-score': 0.52130163453733, 'support': 1554554}, 'weighted avg': {'precision': 0.5266989068643129, 'recall': 0.525387345823947, 'f1-score': 0.5231991152404992, 'support': 1554554}}
[[219984 164300 107780]
 [ 98754 346453 122181]
 [ 87341 157455 250306]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0014511
{'0': {'precision': 0.535256079967024, 'recall': 0.403321459423258, 'f1-score': 0.4600158309300948, 'support': 515135}, '1': {'precision': 0.456824637291701, 'recall': 0.6077642545208513, 'f1-score': 0.5215941801865706, 'support': 520256}, '2': {'precision': 0.5149776484480432, 'recall': 0.47041680551194903, 'f1-score': 0.4916896767978353, 'support': 519163}, 'accuracy': 0.4941488040942933, 'macro avg': {'precision': 0.5023527885689227, 'recall': 0.49383417315201944, 'f1-score': 0.4910998959715002, 'support': 1554554}, 'weighted avg': {'precision': 0.5022355223130721, 'recall': 0.4941488040942933, 'f1-score': 0.4912018781906022, 'support': 1554554}}
[[207765 191647 115723]
 [ 89769 316193 114294]
 [ 90626 184314 244223]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0448554
{'0': {'precision': 0.49988526635350095, 'recall': 0.3646540014083911, 'f1-score': 0.4216931940935452, 'support': 519742}, '1': {'precision': 0.4007125649331595, 'recall': 0.5498422787286448, 'f1-score': 0.46357916386871556, 'support': 509126}, '2': {'precision': 0.48248995411189316, 'recall': 0.43763197041579954, 'f1-score': 0.4589674991870308, 'support': 525686}, 'accuracy': 0.44998243869302706, 'macro avg': {'precision': 0.4610292617995179, 'recall': 0.4507094168509451, 'f1-score': 0.44807995238309717, 'support': 1554554}, 'weighted avg': {'precision': 0.4615232198151532, 'recall': 0.44998243869302706, 'f1-score': 0.44801573843431913, 'support': 1554554}}
[[189526 212721 117495]
 [ 99927 279939 129260]
 [ 89686 205943 230057]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94734424
{'0': {'precision': 0.49183309557774607, 'recall': 0.5435562317218329, 'f1-score': 0.5164027424651482, 'support': 126859}, '1': {'precision': 0.6235094765909376, 'recall': 0.48962594253609976, 'f1-score': 0.5485162180814355, 'support': 202910}, '2': {'precision': 0.4670193399427857, 'recall': 0.5778110873932697, 'f1-score': 0.516541145023976, 'support': 127424}, 'accuracy': 0.5291682068623098, 'macro avg': {'precision': 0.5274539707038232, 'recall': 0.536997753883734, 'f1-score': 0.5271533685235199, 'support': 457193}, 'weighted avg': {'precision': 0.5433574769076385, 'recall': 0.5291682068623098, 'f1-score': 0.5306938211670463, 'support': 457193}}
[[68955 30017 27887]
 [47421 99350 56139]
 [23824 29973 73627]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.991427
{'0': {'precision': 0.5407768610633403, 'recall': 0.48009405398441024, 'f1-score': 0.5086318979255462, 'support': 155230}, '1': {'precision': 0.4689595915263981, 'recall': 0.5224070733084519, 'f1-score': 0.4942425772406717, 'support': 145222}, '2': {'precision': 0.5198180306962166, 'recall': 0.5226966779591811, 'f1-score': 0.5212533799904564, 'support': 156741}, 'accuracy': 0.5081398884059904, 'macro avg': {'precision': 0.5098514944286516, 'recall': 0.5083992684173477, 'f1-score': 0.5080426183855581, 'support': 457193}, 'weighted avg': {'precision': 0.5107795611325295, 'recall': 0.5081398884059904, 'f1-score': 0.5083883635578661, 'support': 457193}}
[[74525 42961 37744]
 [31420 75865 37937]
 [31866 42947 81928]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0223925
{'0': {'precision': 0.536149924045302, 'recall': 0.441944222317272, 'f1-score': 0.48451033493830975, 'support': 161319}, '1': {'precision': 0.40498328272863676, 'recall': 0.5141245903606326, 'f1-score': 0.45307383481751945, 'support': 133349}, '2': {'precision': 0.5118986916925381, 'recall': 0.4879864636209814, 'f1-score': 0.49965664749352673, 'support': 162525}, 'accuracy': 0.47936429472892195, 'macro avg': {'precision': 0.4843439661554923, 'recall': 0.4813517587662954, 'f1-score': 0.47908027241645196, 'support': 457193}, 'weighted avg': {'precision': 0.4892717522643059, 'recall': 0.47936429472892195, 'f1-score': 0.4807255626286492, 'support': 457193}}
[[71294 50305 39720]
 [28888 68558 35903]
 [32792 50423 79310]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603127
{'0': {'precision': 0.5008965233522987, 'recall': 0.3999243917252321, 'f1-score': 0.444751524006768, 'support': 161358}, '1': {'precision': 0.3509686228771371, 'recall': 0.4645320642188018, 'f1-score': 0.39984314284695727, 'support': 132796}, '2': {'precision': 0.48450493784281473, 'recall': 0.45347432209471356, 'f1-score': 0.4684763461709057, 'support': 163039}, 'accuracy': 0.43778666777487846, 'macro avg': {'precision': 0.44545669469075017, 'recall': 0.4393102593462492, 'f1-score': 0.43769033767487703, 'support': 457193}, 'weighted avg': {'precision': 0.45150317485094305, 'recall': 0.43778666777487846, 'f1-score': 0.44016794091673955, 'support': 457193}}
[[64531 57409 39418]
 [31863 61688 39245]
 [32437 56668 73934]]
training model: results/AAPL/W1/deepVOL_L3/seq2seq
Epoch 1/50
6073/6073 - 255s - loss: 12.3177 - accuracy10: 0.4546 - accuracy20: 0.4681 - accuracy30: 0.4596 - accuracy50: 0.4377 - val_loss: 12.6137 - val_accuracy10: 0.4681 - val_accuracy20: 0.4748 - val_accuracy30: 0.4606 - val_accuracy50: 0.4295 - 255s/epoch - 42ms/step
Epoch 2/50
6073/6073 - 247s - loss: 11.8942 - accuracy10: 0.5109 - accuracy20: 0.5133 - accuracy30: 0.4973 - accuracy50: 0.4637 - val_loss: 12.4697 - val_accuracy10: 0.5034 - val_accuracy20: 0.4837 - val_accuracy30: 0.4609 - val_accuracy50: 0.4219 - 247s/epoch - 41ms/step
Epoch 3/50
6073/6073 - 252s - loss: 11.7606 - accuracy10: 0.5234 - accuracy20: 0.5227 - accuracy30: 0.5048 - accuracy50: 0.4691 - val_loss: 12.3692 - val_accuracy10: 0.5117 - val_accuracy20: 0.4909 - val_accuracy30: 0.4661 - val_accuracy50: 0.4257 - 252s/epoch - 41ms/step
Epoch 4/50
6073/6073 - 250s - loss: 11.6836 - accuracy10: 0.5304 - accuracy20: 0.5279 - accuracy30: 0.5093 - accuracy50: 0.4734 - val_loss: 12.3188 - val_accuracy10: 0.5156 - val_accuracy20: 0.4958 - val_accuracy30: 0.4713 - val_accuracy50: 0.4326 - 250s/epoch - 41ms/step
Epoch 5/50
6073/6073 - 247s - loss: 11.6271 - accuracy10: 0.5353 - accuracy20: 0.5320 - accuracy30: 0.5125 - accuracy50: 0.4762 - val_loss: 12.2471 - val_accuracy10: 0.5214 - val_accuracy20: 0.5014 - val_accuracy30: 0.4771 - val_accuracy50: 0.4392 - 247s/epoch - 41ms/step
Epoch 6/50
6073/6073 - 249s - loss: 11.5924 - accuracy10: 0.5374 - accuracy20: 0.5337 - accuracy30: 0.5143 - accuracy50: 0.4777 - val_loss: 12.2406 - val_accuracy10: 0.5264 - val_accuracy20: 0.5036 - val_accuracy30: 0.4779 - val_accuracy50: 0.4386 - 249s/epoch - 41ms/step
Epoch 7/50
6073/6073 - 245s - loss: 11.5629 - accuracy10: 0.5397 - accuracy20: 0.5361 - accuracy30: 0.5161 - accuracy50: 0.4793 - val_loss: 12.2089 - val_accuracy10: 0.5274 - val_accuracy20: 0.5055 - val_accuracy30: 0.4795 - val_accuracy50: 0.4403 - 245s/epoch - 40ms/step
Epoch 8/50
6073/6073 - 252s - loss: 11.5406 - accuracy10: 0.5415 - accuracy20: 0.5373 - accuracy30: 0.5171 - accuracy50: 0.4800 - val_loss: 12.1809 - val_accuracy10: 0.5272 - val_accuracy20: 0.5070 - val_accuracy30: 0.4807 - val_accuracy50: 0.4408 - 252s/epoch - 42ms/step
Epoch 9/50
6073/6073 - 250s - loss: 11.5188 - accuracy10: 0.5426 - accuracy20: 0.5387 - accuracy30: 0.5183 - accuracy50: 0.4812 - val_loss: 12.1553 - val_accuracy10: 0.5288 - val_accuracy20: 0.5091 - val_accuracy30: 0.4827 - val_accuracy50: 0.4431 - 250s/epoch - 41ms/step
Epoch 10/50
6073/6073 - 248s - loss: 11.5026 - accuracy10: 0.5442 - accuracy20: 0.5400 - accuracy30: 0.5194 - accuracy50: 0.4820 - val_loss: 12.1530 - val_accuracy10: 0.5290 - val_accuracy20: 0.5103 - val_accuracy30: 0.4839 - val_accuracy50: 0.4422 - 248s/epoch - 41ms/step
Epoch 11/50
6073/6073 - 247s - loss: 11.4863 - accuracy10: 0.5453 - accuracy20: 0.5407 - accuracy30: 0.5199 - accuracy50: 0.4829 - val_loss: 12.1465 - val_accuracy10: 0.5322 - val_accuracy20: 0.5104 - val_accuracy30: 0.4831 - val_accuracy50: 0.4432 - 247s/epoch - 41ms/step
Epoch 12/50
6073/6073 - 249s - loss: 11.4722 - accuracy10: 0.5461 - accuracy20: 0.5420 - accuracy30: 0.5208 - accuracy50: 0.4835 - val_loss: 12.1244 - val_accuracy10: 0.5298 - val_accuracy20: 0.5118 - val_accuracy30: 0.4849 - val_accuracy50: 0.4440 - 249s/epoch - 41ms/step
Epoch 13/50
6073/6073 - 251s - loss: 11.4579 - accuracy10: 0.5472 - accuracy20: 0.5427 - accuracy30: 0.5218 - accuracy50: 0.4842 - val_loss: 12.1209 - val_accuracy10: 0.5312 - val_accuracy20: 0.5124 - val_accuracy30: 0.4860 - val_accuracy50: 0.4451 - 251s/epoch - 41ms/step
Epoch 14/50
6073/6073 - 250s - loss: 11.4480 - accuracy10: 0.5484 - accuracy20: 0.5434 - accuracy30: 0.5223 - accuracy50: 0.4847 - val_loss: 12.1320 - val_accuracy10: 0.5297 - val_accuracy20: 0.5121 - val_accuracy30: 0.4851 - val_accuracy50: 0.4445 - 250s/epoch - 41ms/step
Epoch 15/50
6073/6073 - 250s - loss: 11.4365 - accuracy10: 0.5488 - accuracy20: 0.5442 - accuracy30: 0.5227 - accuracy50: 0.4851 - val_loss: 12.1126 - val_accuracy10: 0.5303 - val_accuracy20: 0.5123 - val_accuracy30: 0.4860 - val_accuracy50: 0.4450 - 250s/epoch - 41ms/step
Epoch 16/50
6073/6073 - 249s - loss: 11.4283 - accuracy10: 0.5492 - accuracy20: 0.5448 - accuracy30: 0.5234 - accuracy50: 0.4857 - val_loss: 12.1063 - val_accuracy10: 0.5315 - val_accuracy20: 0.5129 - val_accuracy30: 0.4862 - val_accuracy50: 0.4453 - 249s/epoch - 41ms/step
Epoch 17/50
6073/6073 - 248s - loss: 11.4180 - accuracy10: 0.5500 - accuracy20: 0.5452 - accuracy30: 0.5240 - accuracy50: 0.4861 - val_loss: 12.1003 - val_accuracy10: 0.5341 - val_accuracy20: 0.5137 - val_accuracy30: 0.4866 - val_accuracy50: 0.4459 - 248s/epoch - 41ms/step
Epoch 18/50
6073/6073 - 251s - loss: 11.4095 - accuracy10: 0.5507 - accuracy20: 0.5459 - accuracy30: 0.5245 - accuracy50: 0.4866 - val_loss: 12.0876 - val_accuracy10: 0.5342 - val_accuracy20: 0.5141 - val_accuracy30: 0.4872 - val_accuracy50: 0.4468 - 251s/epoch - 41ms/step
Epoch 19/50
6073/6073 - 248s - loss: 11.4010 - accuracy10: 0.5512 - accuracy20: 0.5464 - accuracy30: 0.5249 - accuracy50: 0.4871 - val_loss: 12.0931 - val_accuracy10: 0.5312 - val_accuracy20: 0.5139 - val_accuracy30: 0.4873 - val_accuracy50: 0.4464 - 248s/epoch - 41ms/step
Epoch 20/50
6073/6073 - 255s - loss: 11.3934 - accuracy10: 0.5518 - accuracy20: 0.5469 - accuracy30: 0.5251 - accuracy50: 0.4874 - val_loss: 12.0675 - val_accuracy10: 0.5330 - val_accuracy20: 0.5157 - val_accuracy30: 0.4881 - val_accuracy50: 0.4470 - 255s/epoch - 42ms/step
Epoch 21/50
6073/6073 - 254s - loss: 11.3860 - accuracy10: 0.5523 - accuracy20: 0.5474 - accuracy30: 0.5257 - accuracy50: 0.4879 - val_loss: 12.0736 - val_accuracy10: 0.5352 - val_accuracy20: 0.5147 - val_accuracy30: 0.4875 - val_accuracy50: 0.4468 - 254s/epoch - 42ms/step
Epoch 22/50
6073/6073 - 255s - loss: 11.3777 - accuracy10: 0.5527 - accuracy20: 0.5480 - accuracy30: 0.5263 - accuracy50: 0.4882 - val_loss: 12.0580 - val_accuracy10: 0.5340 - val_accuracy20: 0.5151 - val_accuracy30: 0.4887 - val_accuracy50: 0.4484 - 255s/epoch - 42ms/step
Epoch 23/50
6073/6073 - 258s - loss: 11.3712 - accuracy10: 0.5532 - accuracy20: 0.5480 - accuracy30: 0.5266 - accuracy50: 0.4885 - val_loss: 12.0569 - val_accuracy10: 0.5333 - val_accuracy20: 0.5154 - val_accuracy30: 0.4890 - val_accuracy50: 0.4482 - 258s/epoch - 42ms/step
Epoch 24/50
6073/6073 - 255s - loss: 11.3642 - accuracy10: 0.5533 - accuracy20: 0.5487 - accuracy30: 0.5271 - accuracy50: 0.4889 - val_loss: 12.1046 - val_accuracy10: 0.5340 - val_accuracy20: 0.5139 - val_accuracy30: 0.4862 - val_accuracy50: 0.4456 - 255s/epoch - 42ms/step
Epoch 25/50
6073/6073 - 253s - loss: 11.3568 - accuracy10: 0.5539 - accuracy20: 0.5490 - accuracy30: 0.5275 - accuracy50: 0.4891 - val_loss: 12.1106 - val_accuracy10: 0.5320 - val_accuracy20: 0.5125 - val_accuracy30: 0.4860 - val_accuracy50: 0.4455 - 253s/epoch - 42ms/step
Epoch 26/50
6073/6073 - 261s - loss: 11.3514 - accuracy10: 0.5545 - accuracy20: 0.5499 - accuracy30: 0.5282 - accuracy50: 0.4898 - val_loss: 12.0911 - val_accuracy10: 0.5343 - val_accuracy20: 0.5132 - val_accuracy30: 0.4862 - val_accuracy50: 0.4454 - 261s/epoch - 43ms/step
Epoch 27/50
6073/6073 - 255s - loss: 11.3448 - accuracy10: 0.5549 - accuracy20: 0.5500 - accuracy30: 0.5283 - accuracy50: 0.4898 - val_loss: 12.0987 - val_accuracy10: 0.5345 - val_accuracy20: 0.5136 - val_accuracy30: 0.4862 - val_accuracy50: 0.4459 - 255s/epoch - 42ms/step
Epoch 28/50
6073/6073 - 255s - loss: 11.3388 - accuracy10: 0.5553 - accuracy20: 0.5502 - accuracy30: 0.5284 - accuracy50: 0.4902 - val_loss: 12.0675 - val_accuracy10: 0.5327 - val_accuracy20: 0.5145 - val_accuracy30: 0.4883 - val_accuracy50: 0.4478 - 255s/epoch - 42ms/step
Epoch 29/50
6073/6073 - 257s - loss: 11.3325 - accuracy10: 0.5553 - accuracy20: 0.5507 - accuracy30: 0.5290 - accuracy50: 0.4909 - val_loss: 12.0596 - val_accuracy10: 0.5343 - val_accuracy20: 0.5148 - val_accuracy30: 0.4882 - val_accuracy50: 0.4478 - 257s/epoch - 42ms/step
Epoch 30/50
6073/6073 - 247s - loss: 11.3269 - accuracy10: 0.5559 - accuracy20: 0.5512 - accuracy30: 0.5294 - accuracy50: 0.4909 - val_loss: 12.0951 - val_accuracy10: 0.5317 - val_accuracy20: 0.5133 - val_accuracy30: 0.4864 - val_accuracy50: 0.4462 - 247s/epoch - 41ms/step
Epoch 31/50
6073/6073 - 246s - loss: 11.3219 - accuracy10: 0.5561 - accuracy20: 0.5515 - accuracy30: 0.5298 - accuracy50: 0.4916 - val_loss: 12.1030 - val_accuracy10: 0.5327 - val_accuracy20: 0.5127 - val_accuracy30: 0.4858 - val_accuracy50: 0.4458 - 246s/epoch - 41ms/step
Epoch 32/50
6073/6073 - 245s - loss: 11.3151 - accuracy10: 0.5563 - accuracy20: 0.5520 - accuracy30: 0.5302 - accuracy50: 0.4921 - val_loss: 12.0731 - val_accuracy10: 0.5329 - val_accuracy20: 0.5144 - val_accuracy30: 0.4878 - val_accuracy50: 0.4475 - 245s/epoch - 40ms/step
Epoch 33/50
6073/6073 - 247s - loss: 11.3091 - accuracy10: 0.5565 - accuracy20: 0.5522 - accuracy30: 0.5309 - accuracy50: 0.4922 - val_loss: 12.0944 - val_accuracy10: 0.5320 - val_accuracy20: 0.5137 - val_accuracy30: 0.4869 - val_accuracy50: 0.4470 - 247s/epoch - 41ms/step
testing model: results/AAPL/W1/deepVOL_L3/seq2seq
Evaluating performance on  test set...
21353/21353 - 350s - 350s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9923472
{'0': {'precision': 0.5049666808401743, 'recall': 0.5716059701227999, 'f1-score': 0.5362238567423261, 'support': 1805457}, '1': {'precision': 0.5449629437582488, 'recall': 0.3536462192931399, 'f1-score': 0.42893861455971694, 'support': 1836601}, '2': {'precision': 0.4904281735324193, 'recall': 0.5997169106421096, 'f1-score': 0.5395943593057152, 'support': 1824159}, 'accuracy': 0.5077544488263089, 'macro avg': {'precision': 0.5134525993769475, 'recall': 0.5083230333526831, 'f1-score': 0.5015856102025861, 'support': 5466217}, 'weighted avg': {'precision': 0.5135533555952364, 'recall': 0.5077544488263089, 'f1-score': 0.5013017432418388, 'support': 5466217}}
[[1032010  269884  503563]
 [ 553975  649507  633119]
 [ 457734  272446 1093979]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0028731
{'0': {'precision': 0.54040614284317, 'recall': 0.539926004293205, 'f1-score': 0.5401659668727478, 'support': 2118231}, '1': {'precision': 0.3911454315174795, 'recall': 0.35920294742535824, 'f1-score': 0.37449429042811516, 'support': 1205391}, '2': {'precision': 0.5312544306201664, 'recall': 0.5561284330449758, 'f1-score': 0.543406934063982, 'support': 2142595}, 'accuracy': 0.5064244613779512, 'macro avg': {'precision': 0.48760200166027196, 'recall': 0.4850857949211797, 'f1-score': 0.48602239712161494, 'support': 5466217}, 'weighted avg': {'precision': 0.5039044944570865, 'recall': 0.5064244613779512, 'f1-score': 0.5049029929289454, 'support': 5466217}}
[[1143688  336358  638185]
 [ 359240  432980  413171]
 [ 613421  337616 1191558]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0290835
{'0': {'precision': 0.5269078230286619, 'recall': 0.5217774093064808, 'f1-score': 0.5243300665749248, 'support': 2161483}, '1': {'precision': 0.32797428526894623, 'recall': 0.32157394120600113, 'f1-score': 0.32474258024080427, 'support': 1125455}, '2': {'precision': 0.5204235454630542, 'recall': 0.5306943259674415, 'f1-score': 0.5255087563133766, 'support': 2179279}, 'accuracy': 0.4841119553065676, 'macro avg': {'precision': 0.45843521792022085, 'recall': 0.4580152254933078, 'f1-score': 0.45819380104303525, 'support': 5466217}, 'weighted avg': {'precision': 0.48336366906107137, 'recall': 0.4841119553065676, 'f1-score': 0.48370635173930004, 'support': 5466217}}
[[1127813  373322  660348]
 [ 358129  361917  405409]
 [ 654495  368253 1156531]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0681287
{'0': {'precision': 0.4838585511953366, 'recall': 0.48544425183757045, 'f1-score': 0.48465010447773715, 'support': 2081961}, '1': {'precision': 0.29138737081141713, 'recall': 0.2648209980100098, 'f1-score': 0.27746973498187905, 'support': 1286941}, '2': {'precision': 0.4812754634085582, 'recall': 0.5066344349799625, 'f1-score': 0.4936294754642126, 'support': 2097315}, 'accuracy': 0.44163211961764415, 'macro avg': {'precision': 0.418840461805104, 'recall': 0.41896656160918094, 'f1-score': 0.4185831049746096, 'support': 5466217}, 'weighted avg': {'precision': 0.43755292481497354, 'recall': 0.44163211961764415, 'f1-score': 0.4393177763907129, 'support': 5466217}}
[[1010676  424378  646907]
 [ 447786  340809  498346]
 [ 630322  404421 1062572]]
Evaluating performance on  train set...
6073/6073 - 101s - 101s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9024947
{'0': {'precision': 0.48844902658722655, 'recall': 0.5187660642238453, 'f1-score': 0.5031512760448772, 'support': 393343}, '1': {'precision': 0.6691318957616963, 'recall': 0.5579908842821144, 'f1-score': 0.6085283466159865, 'support': 765491}, '2': {'precision': 0.46640599295418617, 'recall': 0.5874886283230567, 'f1-score': 0.5199916794531702, 'support': 395720}, 'accuracy': 0.5555747822204954, 'macro avg': {'precision': 0.541328971767703, 'recall': 0.5547485256096721, 'f1-score': 0.5438904340380114, 'support': 1554554}, 'weighted avg': {'precision': 0.5718094250925002, 'recall': 0.5555747822204954, 'f1-score': 0.559327699356823, 'support': 1554554}}
[[204053 110038  79252]
 [151635 427137 186719]
 [ 62069 101170 232481]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9560325
{'0': {'precision': 0.5421256426464898, 'recall': 0.4583814300578786, 'f1-score': 0.49674876695403786, 'support': 492064}, '1': {'precision': 0.5297033455347075, 'recall': 0.5912021403343038, 'f1-score': 0.5587656685961772, 'support': 567388}, '2': {'precision': 0.5202963350018506, 'recall': 0.5309491781491491, 'f1-score': 0.5255687810456634, 'support': 495102}, 'accuracy': 0.529970653962487, 'macro avg': {'precision': 0.530708441061016, 'recall': 0.5268442495137772, 'f1-score': 0.5270277388652929, 'support': 1554554}, 'weighted avg': {'precision': 0.5306393924505262, 'recall': 0.529970653962487, 'f1-score': 0.5285627099921839, 'support': 1554554}}
[[225553 153643 112868]
 [102450 335441 129497]
 [ 88050 144178 262874]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99250525
{'0': {'precision': 0.5333903692220695, 'recall': 0.4248070894037485, 'f1-score': 0.47294638119824556, 'support': 515135}, '1': {'precision': 0.47123243898233497, 'recall': 0.5725854194857916, 'f1-score': 0.5169883261932178, 'support': 520256}, '2': {'precision': 0.511708872499917, 'recall': 0.5047798090387797, 'f1-score': 0.5082207242149683, 'support': 519163}, 'accuracy': 0.5009713396897116, 'macro avg': {'precision': 0.5054438935681071, 'recall': 0.5007241059761066, 'f1-score': 0.49938514386881055, 'support': 1554554}, 'weighted avg': {'precision': 0.5053474276210919, 'recall': 0.5009713396897116, 'f1-score': 0.49946602598311324, 'support': 1554554}}
[[218833 172005 124297]
 [ 96592 297891 125773]
 [ 94843 162257 262063]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0371995
{'0': {'precision': 0.4999838674850402, 'recall': 0.3875961534761478, 'f1-score': 0.4366745966802326, 'support': 519742}, '1': {'precision': 0.4130059774541662, 'recall': 0.5055231907229252, 'f1-score': 0.4546052683871162, 'support': 509126}, '2': {'precision': 0.47894093470535476, 'recall': 0.4814737314670735, 'f1-score': 0.4802039933520024, 'support': 525686}, 'accuracy': 0.45796350593160484, 'macro avg': {'precision': 0.46397692654818706, 'recall': 0.45819769188871556, 'f1-score': 0.45716128613978374, 'support': 1554554}, 'weighted avg': {'precision': 0.46438222199631446, 'recall': 0.45796350593160484, 'f1-score': 0.4572668473078948, 'support': 1554554}}
[[201450 187511 130781]
 [107170 257375 144581]
 [ 94293 178289 253104]]
Evaluating performance on  val set...
1786/1786 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93779516
{'0': {'precision': 0.49834834834834835, 'recall': 0.5494210107284465, 'f1-score': 0.522639931913362, 'support': 126859}, '1': {'precision': 0.6334463866423167, 'recall': 0.4786358484056971, 'f1-score': 0.5452656991269685, 'support': 202910}, '2': {'precision': 0.4688103991756751, 'recall': 0.6034263561024611, 'f1-score': 0.5276680723449665, 'support': 127424}, 'accuracy': 0.5330571552932788, 'macro avg': {'precision': 0.5335350447221133, 'recall': 0.5438277384122016, 'f1-score': 0.5318579011284323, 'support': 457193}, 'weighted avg': {'precision': 0.5500746418717627, 'recall': 0.5330571552932788, 'f1-score': 0.5340830209188141, 'support': 457193}}
[[69699 28481 28679]
 [47347 97120 58443]
 [22814 27719 76891]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9796507
{'0': {'precision': 0.5436984020125429, 'recall': 0.4942601301294853, 'f1-score': 0.517801886314937, 'support': 155230}, '1': {'precision': 0.48543023193241136, 'recall': 0.4969357259919296, 'f1-score': 0.4911156026486461, 'support': 145222}, '2': {'precision': 0.5182541483985807, 'recall': 0.5535437441384194, 'f1-score': 0.5353179805957027, 'support': 156741}, 'accuracy': 0.5154344007891635, 'macro avg': {'precision': 0.5157942607811784, 'recall': 0.5149132000866115, 'f1-score': 0.5147451565197619, 'support': 457193}, 'weighted avg': {'precision': 0.5164670621821368, 'recall': 0.5154344007891635, 'f1-score': 0.5153304019463562, 'support': 457193}}
[[76724 38638 39868]
 [32273 72166 40783]
 [32118 37860 86763]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0109475
{'0': {'precision': 0.534220654037404, 'recall': 0.465518630787446, 'f1-score': 0.4975090429690087, 'support': 161319}, '1': {'precision': 0.42353268730603905, 'recall': 0.4677125437761063, 'f1-score': 0.44452759721747065, 'support': 133349}, '2': {'precision': 0.5072005951783468, 'recall': 0.5285340716812797, 'f1-score': 0.5176476259920575, 'support': 162525}, 'accuracy': 0.4885595361258812, 'macro avg': {'precision': 0.48831797884059663, 'recall': 0.48725508208161067, 'f1-score': 0.48656142205951225, 'support': 457193}, 'weighted avg': {'precision': 0.49233120091426114, 'recall': 0.4885595361258812, 'f1-score': 0.4892149535938415, 'support': 457193}}
[[75097 42889 43333]
 [30852 62369 40128]
 [34624 42001 85900]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0506889
{'0': {'precision': 0.49871310601831376, 'recall': 0.4263005243000037, 'f1-score': 0.4596724882804799, 'support': 161358}, '1': {'precision': 0.36556978528648837, 'recall': 0.4054037772222055, 'f1-score': 0.3844577272175447, 'support': 132796}, '2': {'precision': 0.4789067314736218, 'recall': 0.5052226767828556, 'f1-score': 0.4917128555950537, 'support': 163039}, 'accuracy': 0.448375193845925, 'macro avg': {'precision': 0.44772987425947464, 'recall': 0.44564232610168825, 'f1-score': 0.44528102369769273, 'support': 457193}, 'weighted avg': {'precision': 0.4529772528462497, 'recall': 0.448375193845925, 'f1-score': 0.44925152828434534, 'support': 457193}}
[[68787 47605 44966]
 [34299 53836 44661]
 [34843 45825 82371]]
training model: results/AAPL/W2/deepLOB_L1/seq2seq
Epoch 1/50
6147/6147 - 156s - loss: 12.5240 - accuracy10: 0.4588 - accuracy20: 0.4512 - accuracy30: 0.4411 - accuracy50: 0.4393 - val_loss: 13.9033 - val_accuracy10: 0.4149 - val_accuracy20: 0.3966 - val_accuracy30: 0.3850 - val_accuracy50: 0.3820 - 156s/epoch - 25ms/step
Epoch 2/50
6147/6147 - 148s - loss: 12.4459 - accuracy10: 0.4710 - accuracy20: 0.4606 - accuracy30: 0.4480 - accuracy50: 0.4430 - val_loss: 14.4205 - val_accuracy10: 0.3995 - val_accuracy20: 0.3956 - val_accuracy30: 0.3928 - val_accuracy50: 0.4032 - 148s/epoch - 24ms/step
Epoch 3/50
6147/6147 - 138s - loss: 12.4041 - accuracy10: 0.4761 - accuracy20: 0.4643 - accuracy30: 0.4508 - accuracy50: 0.4450 - val_loss: 14.0823 - val_accuracy10: 0.4189 - val_accuracy20: 0.4056 - val_accuracy30: 0.3961 - val_accuracy50: 0.4022 - 138s/epoch - 22ms/step
Epoch 4/50
6147/6147 - 152s - loss: 12.3621 - accuracy10: 0.4809 - accuracy20: 0.4683 - accuracy30: 0.4536 - accuracy50: 0.4474 - val_loss: 13.8627 - val_accuracy10: 0.4221 - val_accuracy20: 0.4083 - val_accuracy30: 0.3922 - val_accuracy50: 0.3912 - 152s/epoch - 25ms/step
Epoch 5/50
6147/6147 - 154s - loss: 12.3377 - accuracy10: 0.4844 - accuracy20: 0.4703 - accuracy30: 0.4552 - accuracy50: 0.4483 - val_loss: 13.7196 - val_accuracy10: 0.4196 - val_accuracy20: 0.4089 - val_accuracy30: 0.3942 - val_accuracy50: 0.3955 - 154s/epoch - 25ms/step
Epoch 6/50
6147/6147 - 148s - loss: 12.3145 - accuracy10: 0.4874 - accuracy20: 0.4729 - accuracy30: 0.4571 - accuracy50: 0.4494 - val_loss: 13.6073 - val_accuracy10: 0.4201 - val_accuracy20: 0.4102 - val_accuracy30: 0.3943 - val_accuracy50: 0.3897 - 148s/epoch - 24ms/step
Epoch 7/50
6147/6147 - 155s - loss: 12.2923 - accuracy10: 0.4892 - accuracy20: 0.4744 - accuracy30: 0.4584 - accuracy50: 0.4505 - val_loss: 13.5120 - val_accuracy10: 0.4302 - val_accuracy20: 0.4170 - val_accuracy30: 0.3940 - val_accuracy50: 0.3881 - 155s/epoch - 25ms/step
Epoch 8/50
6147/6147 - 146s - loss: 12.2759 - accuracy10: 0.4915 - accuracy20: 0.4761 - accuracy30: 0.4597 - accuracy50: 0.4513 - val_loss: 13.2617 - val_accuracy10: 0.4464 - val_accuracy20: 0.4242 - val_accuracy30: 0.3964 - val_accuracy50: 0.3848 - 146s/epoch - 24ms/step
Epoch 9/50
6147/6147 - 148s - loss: 12.2592 - accuracy10: 0.4927 - accuracy20: 0.4774 - accuracy30: 0.4605 - accuracy50: 0.4521 - val_loss: 13.2463 - val_accuracy10: 0.4395 - val_accuracy20: 0.4206 - val_accuracy30: 0.3926 - val_accuracy50: 0.3808 - 148s/epoch - 24ms/step
Epoch 10/50
6147/6147 - 156s - loss: 12.2434 - accuracy10: 0.4943 - accuracy20: 0.4791 - accuracy30: 0.4619 - accuracy50: 0.4532 - val_loss: 13.4199 - val_accuracy10: 0.4415 - val_accuracy20: 0.4221 - val_accuracy30: 0.3950 - val_accuracy50: 0.3857 - 156s/epoch - 25ms/step
Epoch 11/50
6147/6147 - 158s - loss: 12.2320 - accuracy10: 0.4951 - accuracy20: 0.4801 - accuracy30: 0.4626 - accuracy50: 0.4538 - val_loss: 13.1879 - val_accuracy10: 0.4448 - val_accuracy20: 0.4260 - val_accuracy30: 0.3944 - val_accuracy50: 0.3807 - 158s/epoch - 26ms/step
Epoch 12/50
6147/6147 - 158s - loss: 12.2183 - accuracy10: 0.4965 - accuracy20: 0.4814 - accuracy30: 0.4638 - accuracy50: 0.4544 - val_loss: 13.0684 - val_accuracy10: 0.4518 - val_accuracy20: 0.4273 - val_accuracy30: 0.3914 - val_accuracy50: 0.3716 - 158s/epoch - 26ms/step
Epoch 13/50
6147/6147 - 153s - loss: 12.2062 - accuracy10: 0.4980 - accuracy20: 0.4826 - accuracy30: 0.4646 - accuracy50: 0.4551 - val_loss: 13.2225 - val_accuracy10: 0.4422 - val_accuracy20: 0.4258 - val_accuracy30: 0.3934 - val_accuracy50: 0.3750 - 153s/epoch - 25ms/step
Epoch 14/50
6147/6147 - 153s - loss: 12.1960 - accuracy10: 0.4989 - accuracy20: 0.4832 - accuracy30: 0.4653 - accuracy50: 0.4559 - val_loss: 13.2119 - val_accuracy10: 0.4471 - val_accuracy20: 0.4234 - val_accuracy30: 0.3884 - val_accuracy50: 0.3725 - 153s/epoch - 25ms/step
Epoch 15/50
6147/6147 - 147s - loss: 12.1856 - accuracy10: 0.5000 - accuracy20: 0.4842 - accuracy30: 0.4660 - accuracy50: 0.4563 - val_loss: 13.1359 - val_accuracy10: 0.4500 - val_accuracy20: 0.4314 - val_accuracy30: 0.3961 - val_accuracy50: 0.3759 - 147s/epoch - 24ms/step
Epoch 16/50
6147/6147 - 158s - loss: 12.1773 - accuracy10: 0.5009 - accuracy20: 0.4852 - accuracy30: 0.4668 - accuracy50: 0.4572 - val_loss: 13.2873 - val_accuracy10: 0.4399 - val_accuracy20: 0.4275 - val_accuracy30: 0.3941 - val_accuracy50: 0.3753 - 158s/epoch - 26ms/step
Epoch 17/50
6147/6147 - 153s - loss: 12.1690 - accuracy10: 0.5011 - accuracy20: 0.4856 - accuracy30: 0.4671 - accuracy50: 0.4576 - val_loss: 13.2806 - val_accuracy10: 0.4455 - val_accuracy20: 0.4251 - val_accuracy30: 0.3874 - val_accuracy50: 0.3702 - 153s/epoch - 25ms/step
Epoch 18/50
6147/6147 - 152s - loss: 12.1629 - accuracy10: 0.5017 - accuracy20: 0.4861 - accuracy30: 0.4677 - accuracy50: 0.4579 - val_loss: 13.2764 - val_accuracy10: 0.4439 - val_accuracy20: 0.4228 - val_accuracy30: 0.3854 - val_accuracy50: 0.3698 - 152s/epoch - 25ms/step
Epoch 19/50
6147/6147 - 153s - loss: 12.1543 - accuracy10: 0.5030 - accuracy20: 0.4873 - accuracy30: 0.4687 - accuracy50: 0.4587 - val_loss: 13.3554 - val_accuracy10: 0.4437 - val_accuracy20: 0.4176 - val_accuracy30: 0.3766 - val_accuracy50: 0.3667 - 153s/epoch - 25ms/step
Epoch 20/50
6147/6147 - 157s - loss: 12.1480 - accuracy10: 0.5034 - accuracy20: 0.4873 - accuracy30: 0.4688 - accuracy50: 0.4589 - val_loss: 13.3098 - val_accuracy10: 0.4441 - val_accuracy20: 0.4195 - val_accuracy30: 0.3781 - val_accuracy50: 0.3647 - 157s/epoch - 26ms/step
Epoch 21/50
6147/6147 - 159s - loss: 12.1422 - accuracy10: 0.5037 - accuracy20: 0.4877 - accuracy30: 0.4691 - accuracy50: 0.4592 - val_loss: 13.3328 - val_accuracy10: 0.4429 - val_accuracy20: 0.4169 - val_accuracy30: 0.3737 - val_accuracy50: 0.3648 - 159s/epoch - 26ms/step
Epoch 22/50
6147/6147 - 153s - loss: 12.1356 - accuracy10: 0.5044 - accuracy20: 0.4882 - accuracy30: 0.4697 - accuracy50: 0.4596 - val_loss: 13.3151 - val_accuracy10: 0.4457 - val_accuracy20: 0.4197 - val_accuracy30: 0.3759 - val_accuracy50: 0.3667 - 153s/epoch - 25ms/step
testing model: results/AAPL/W2/deepLOB_L1/seq2seq
Evaluating performance on  test set...
14883/14883 - 151s - 151s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0411401
{'0': {'precision': 0.4291257606409292, 'recall': 0.4744535869031611, 'f1-score': 0.4506527443815918, 'support': 1124424}, '1': {'precision': 0.4901299824029695, 'recall': 0.3883791687046708, 'f1-score': 0.43336207683868877, 'support': 1521096}, '2': {'precision': 0.44117212813108986, 'recall': 0.5158165854932114, 'f1-score': 0.47558324880452113, 'support': 1164379}, 'accuracy': 0.45272984926897014, 'macro avg': {'precision': 0.45347595705832955, 'recall': 0.4595497803670144, 'f1-score': 0.4531993566749339, 'support': 3809899}, 'weighted avg': {'precision': 0.45716320075080563, 'recall': 0.45272984926897014, 'f1-score': 0.45136871889236657, 'support': 3809899}}
[[533487 291208 299729]
 [469282 590762 461052]
 [240426 323347 600606]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.067158
{'0': {'precision': 0.46607995667086244, 'recall': 0.33243002166953217, 'f1-score': 0.3880702165246604, 'support': 1206302}, '1': {'precision': 0.38703179713247643, 'recall': 0.5705841405254894, 'f1-score': 0.4612166457107266, 'support': 1350360}, '2': {'precision': 0.4786598117720195, 'recall': 0.3661765492081705, 'f1-score': 0.41493005323765986, 'support': 1253237}, 'accuracy': 0.42794074068630167, 'macro avg': {'precision': 0.4439238551917861, 'recall': 0.42306357046773074, 'f1-score': 0.42140563849101564, 'support': 3809899}, 'weighted avg': {'precision': 0.44220060111659554, 'recall': 0.42794074068630167, 'f1-score': 0.42283117824526917, 'support': 3809899}}
[[401011 591603 213688]
 [293729 770494 286137]
 [165651 628680 458906]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768523
{'0': {'precision': 0.48469645469182443, 'recall': 0.1566542581504225, 'f1-score': 0.23678078785129245, 'support': 1176074}, '1': {'precision': 0.3770261696771909, 'recall': 0.7966325162725169, 'f1-score': 0.5118205315500043, 'support': 1404669}, '2': {'precision': 0.4958554742818537, 'recall': 0.186301006544328, 'f1-score': 0.2708421793408517, 'support': 1229156}, 'accuracy': 0.4021720785774111, 'macro avg': {'precision': 0.452526032883623, 'recall': 0.3798625936557558, 'f1-score': 0.33981449958071613, 'support': 3809899}, 'weighted avg': {'precision': 0.44859971414882893, 'recall': 0.4021720785774111, 'f1-score': 0.34917394196358426, 'support': 3809899}}
[[ 184237  904132   87705]
 [ 140548 1119005  145116]
 [  55323  944840  228993]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0232308
{'0': {'precision': 0.4002877864959736, 'recall': 0.06398830706135492, 'f1-score': 0.11033838765618746, 'support': 969474}, '1': {'precision': 0.4885402134277512, 'recall': 0.9334318346471633, 'f1-score': 0.6413895242682827, 'support': 1855136}, '2': {'precision': 0.47838728962481203, 'recall': 0.05360153213930126, 'f1-score': 0.09640161834538512, 'support': 985289}, 'accuracy': 0.48465615492694164, 'macro avg': {'precision': 0.45573842984951224, 'recall': 0.35034055794927316, 'f1-score': 0.28270984342328503, 'support': 3809899}, 'weighted avg': {'precision': 0.46345765940515576, 'recall': 0.48465615492694164, 'f1-score': 0.36531636367931686, 'support': 3809899}}
[[  62035  894596   12843]
 [  78751 1731643   44742]
 [  14190  918286   52813]]
Evaluating performance on  train set...
6147/6147 - 53s - 53s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730842
{'0': {'precision': 0.4471410242537602, 'recall': 0.41750587653099097, 'f1-score': 0.43181558875558873, 'support': 484980}, '1': {'precision': 0.4634615503178195, 'recall': 0.377440815404313, 'f1-score': 0.41605140523129036, 'support': 597495}, '2': {'precision': 0.41755789360792744, 'recall': 0.5392008309403067, 'f1-score': 0.4706464805019462, 'support': 491010}, 'accuracy': 0.44026730474075065, 'macro avg': {'precision': 0.4427201560598357, 'recall': 0.44471584095853683, 'f1-score': 0.4395044914962751, 'support': 1573485}, 'weighted avg': {'precision': 0.44410688013559874, 'recall': 0.44026730474075065, 'f1-score': 0.4379467786439755, 'support': 1573485}}
[[202482 131884 150614]
 [153292 225519 218684]
 [ 97063 129194 264753]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0990382
{'0': {'precision': 0.48011827275694563, 'recall': 0.2878261486783317, 'f1-score': 0.35989738189502873, 'support': 521273}, '1': {'precision': 0.36582257575816685, 'recall': 0.5372964713746836, 'f1-score': 0.43528077439639534, 'support': 523575}, '2': {'precision': 0.45279617231104446, 'recall': 0.42141015479431065, 'f1-score': 0.4365397484497336, 'support': 528637}, 'accuracy': 0.415716705275233, 'macro avg': {'precision': 0.43291234027538567, 'recall': 0.4155109249491087, 'f1-score': 0.41057263491371926, 'support': 1573485}, 'weighted avg': {'precision': 0.4329072457884296, 'recall': 0.415716705275233, 'f1-score': 0.41073031036735763, 'support': 1573485}}
[[150036 249624 121613]
 [ 94652 281315 147608]
 [ 67810 238054 222773]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1160703
{'0': {'precision': 0.49626436781609196, 'recall': 0.1355874107662612, 'f1-score': 0.21298413003982528, 'support': 522224}, '1': {'precision': 0.3418436664906293, 'recall': 0.7472522177873969, 'f1-score': 0.4690926512701575, 'support': 518873}, '2': {'precision': 0.4743472162278809, 'recall': 0.26424337137576354, 'f1-score': 0.3394116029164113, 'support': 532388}, 'accuracy': 0.3808209166277403, 'macro avg': {'precision': 0.4374850835115341, 'recall': 0.3823609999764739, 'f1-score': 0.34049612807546464, 'support': 1573485}, 'weighted avg': {'precision': 0.4379268806086567, 'recall': 0.3808209166277403, 'f1-score': 0.34021525468744884, 'support': 1573485}}
[[ 70807 381841  69576]
 [ 44824 387729  86320]
 [ 27049 364659 140680]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1403452
{'0': {'precision': 0.4434138436607763, 'recall': 0.055293180296067064, 'f1-score': 0.09832531095623426, 'support': 519612}, '1': {'precision': 0.3309314313960878, 'recall': 0.9022529755372525, 'f1-score': 0.48424853087209413, 'support': 519402}, '2': {'precision': 0.5127011556323577, 'recall': 0.0888186636880205, 'f1-score': 0.15140791725206956, 'support': 534471}, 'accuracy': 0.34625941778917496, 'macro avg': {'precision': 0.42901547689640723, 'recall': 0.3487882731737801, 'f1-score': 0.24466058636013266, 'support': 1573485}, 'weighted avg': {'precision': 0.42981884213337657, 'recall': 0.34625941778917496, 'f1-score': 0.24374799114719817, 'support': 1573485}}
[[ 28731 471514  19367]
 [ 25018 468632  25752]
 [ 11046 475954  47471]]
Evaluating performance on  val set...
2174/2174 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0554442
{'0': {'precision': 0.44828308939113426, 'recall': 0.37980265533345564, 'f1-score': 0.41121129973916776, 'support': 168943}, '1': {'precision': 0.4916120099545837, 'recall': 0.3866318091787213, 'f1-score': 0.4328475457084381, 'support': 213058}, '2': {'precision': 0.4267558419579509, 'recall': 0.6011357970923136, 'f1-score': 0.49915419772501785, 'support': 174503}, 'accuracy': 0.4518206517832756, 'macro avg': {'precision': 0.4555503137678896, 'recall': 0.45585675386816354, 'f1-score': 0.44773768105754125, 'support': 556504}, 'weighted avg': {'precision': 0.4581213006143683, 'recall': 0.4518206517832756, 'f1-score': 0.44707101471146915, 'support': 556504}}
[[ 64165  44787  59991]
 [ 49766  82375  80917]
 [ 29204  40399 104900]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0824226
{'0': {'precision': 0.48659203332465506, 'recall': 0.25606107104495934, 'f1-score': 0.3355463714672479, 'support': 182476}, '1': {'precision': 0.37924651408295823, 'recall': 0.5548357688698217, 'f1-score': 0.45053746350321255, 'support': 186475}, '2': {'precision': 0.46580911934437064, 'recall': 0.466092251256978, 'f1-score': 0.46595064228985666, 'support': 187553}, 'accuracy': 0.4269600937279876, 'macro avg': {'precision': 0.4438825555839947, 'recall': 0.42566303039058634, 'f1-score': 0.41734482575343906, 'support': 556504}, 'weighted avg': {'precision': 0.44361812196671385, 'recall': 0.4269600937279876, 'f1-score': 0.4180267778848105, 'support': 556504}}
[[ 46725  88476  47275]
 [ 30037 103463  52975]
 [ 19263  80873  87417]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0992368
{'0': {'precision': 0.5143059705271686, 'recall': 0.11187609469150354, 'f1-score': 0.18377576316884717, 'support': 181558}, '1': {'precision': 0.3540163481039887, 'recall': 0.7641265646805372, 'f1-score': 0.4838617547443686, 'support': 188457}, '2': {'precision': 0.48337642309611284, 'recall': 0.28572730831309084, 'f1-score': 0.3591553093110096, 'support': 186489}, 'accuracy': 0.3910160573868292, 'macro avg': {'precision': 0.4505662472424234, 'recall': 0.3872433225617105, 'f1-score': 0.3422642757414085, 'support': 556504}, 'weighted avg': {'precision': 0.4496600349294454, 'recall': 0.3910160573868292, 'f1-score': 0.344169330681127, 'support': 556504}}
[[ 20312 135482  25764]
 [ 13266 144005  31186]
 [  5916 127288  53285]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1107451
{'0': {'precision': 0.46276808312241907, 'recall': 0.03944903080749009, 'f1-score': 0.07270063827560949, 'support': 176126}, '1': {'precision': 0.36008851456572544, 'recall': 0.9157100015520254, 'f1-score': 0.5169102331851492, 'support': 199739}, '2': {'precision': 0.5098506750916515, 'recall': 0.094697158420939, 'f1-score': 0.15972734488071338, 'support': 180639}, 'accuracy': 0.3718877132958613, 'macro avg': {'precision': 0.4442357575932654, 'recall': 0.3499520635934848, 'f1-score': 0.24977940544715735, 'support': 556504}, 'weighted avg': {'precision': 0.44119741693993836, 'recall': 0.3718877132958613, 'f1-score': 0.2603837412399654, 'support': 556504}}
[[  6948 163068   6110]
 [  6501 182903  10335]
 [  1565 161968  17106]]
training model: results/AAPL/W2/deepOF_L1/seq2seq
Epoch 1/50
6147/6147 - 145s - loss: 12.6950 - accuracy10: 0.4487 - accuracy20: 0.4424 - accuracy30: 0.4340 - accuracy50: 0.4332 - val_loss: 13.2462 - val_accuracy10: 0.4029 - val_accuracy20: 0.3394 - val_accuracy30: 0.3390 - val_accuracy50: 0.3586 - 145s/epoch - 24ms/step
Epoch 2/50
6147/6147 - 151s - loss: 12.6681 - accuracy10: 0.4512 - accuracy20: 0.4439 - accuracy30: 0.4352 - accuracy50: 0.4342 - val_loss: 13.2101 - val_accuracy10: 0.4018 - val_accuracy20: 0.3457 - val_accuracy30: 0.3456 - val_accuracy50: 0.3619 - 151s/epoch - 25ms/step
Epoch 3/50
6147/6147 - 147s - loss: 12.6467 - accuracy10: 0.4543 - accuracy20: 0.4452 - accuracy30: 0.4361 - accuracy50: 0.4352 - val_loss: 13.1944 - val_accuracy10: 0.4025 - val_accuracy20: 0.3493 - val_accuracy30: 0.3486 - val_accuracy50: 0.3629 - 147s/epoch - 24ms/step
Epoch 4/50
6147/6147 - 145s - loss: 12.6304 - accuracy10: 0.4566 - accuracy20: 0.4469 - accuracy30: 0.4373 - accuracy50: 0.4361 - val_loss: 13.1737 - val_accuracy10: 0.4079 - val_accuracy20: 0.3515 - val_accuracy30: 0.3494 - val_accuracy50: 0.3630 - 145s/epoch - 24ms/step
Epoch 5/50
6147/6147 - 154s - loss: 12.6167 - accuracy10: 0.4581 - accuracy20: 0.4475 - accuracy30: 0.4381 - accuracy50: 0.4368 - val_loss: 13.1603 - val_accuracy10: 0.4107 - val_accuracy20: 0.3520 - val_accuracy30: 0.3496 - val_accuracy50: 0.3630 - 154s/epoch - 25ms/step
Epoch 6/50
6147/6147 - 147s - loss: 12.6066 - accuracy10: 0.4596 - accuracy20: 0.4486 - accuracy30: 0.4386 - accuracy50: 0.4370 - val_loss: 13.1278 - val_accuracy10: 0.4154 - val_accuracy20: 0.3541 - val_accuracy30: 0.3510 - val_accuracy50: 0.3635 - 147s/epoch - 24ms/step
Epoch 7/50
6147/6147 - 154s - loss: 12.5971 - accuracy10: 0.4605 - accuracy20: 0.4496 - accuracy30: 0.4392 - accuracy50: 0.4377 - val_loss: 13.1242 - val_accuracy10: 0.4167 - val_accuracy20: 0.3559 - val_accuracy30: 0.3522 - val_accuracy50: 0.3638 - 154s/epoch - 25ms/step
Epoch 8/50
6147/6147 - 144s - loss: 12.5891 - accuracy10: 0.4614 - accuracy20: 0.4505 - accuracy30: 0.4400 - accuracy50: 0.4385 - val_loss: 13.0961 - val_accuracy10: 0.4217 - val_accuracy20: 0.3570 - val_accuracy30: 0.3530 - val_accuracy50: 0.3643 - 144s/epoch - 23ms/step
Epoch 9/50
6147/6147 - 146s - loss: 12.5792 - accuracy10: 0.4623 - accuracy20: 0.4511 - accuracy30: 0.4408 - accuracy50: 0.4390 - val_loss: 13.0915 - val_accuracy10: 0.4230 - val_accuracy20: 0.3579 - val_accuracy30: 0.3530 - val_accuracy50: 0.3640 - 146s/epoch - 24ms/step
Epoch 10/50
6147/6147 - 148s - loss: 12.5718 - accuracy10: 0.4632 - accuracy20: 0.4518 - accuracy30: 0.4413 - accuracy50: 0.4391 - val_loss: 13.0849 - val_accuracy10: 0.4246 - val_accuracy20: 0.3599 - val_accuracy30: 0.3542 - val_accuracy50: 0.3647 - 148s/epoch - 24ms/step
Epoch 11/50
6147/6147 - 156s - loss: 12.5641 - accuracy10: 0.4639 - accuracy20: 0.4525 - accuracy30: 0.4418 - accuracy50: 0.4399 - val_loss: 13.0837 - val_accuracy10: 0.4255 - val_accuracy20: 0.3604 - val_accuracy30: 0.3544 - val_accuracy50: 0.3648 - 156s/epoch - 25ms/step
Epoch 12/50
6147/6147 - 148s - loss: 12.5582 - accuracy10: 0.4643 - accuracy20: 0.4529 - accuracy30: 0.4424 - accuracy50: 0.4404 - val_loss: 13.0717 - val_accuracy10: 0.4274 - val_accuracy20: 0.3615 - val_accuracy30: 0.3550 - val_accuracy50: 0.3652 - 148s/epoch - 24ms/step
Epoch 13/50
6147/6147 - 153s - loss: 12.5515 - accuracy10: 0.4650 - accuracy20: 0.4538 - accuracy30: 0.4428 - accuracy50: 0.4408 - val_loss: 13.0643 - val_accuracy10: 0.4272 - val_accuracy20: 0.3615 - val_accuracy30: 0.3550 - val_accuracy50: 0.3650 - 153s/epoch - 25ms/step
Epoch 14/50
6147/6147 - 149s - loss: 12.5452 - accuracy10: 0.4655 - accuracy20: 0.4543 - accuracy30: 0.4433 - accuracy50: 0.4412 - val_loss: 13.0538 - val_accuracy10: 0.4312 - val_accuracy20: 0.3633 - val_accuracy30: 0.3554 - val_accuracy50: 0.3654 - 149s/epoch - 24ms/step
Epoch 15/50
6147/6147 - 157s - loss: 12.5406 - accuracy10: 0.4662 - accuracy20: 0.4550 - accuracy30: 0.4437 - accuracy50: 0.4417 - val_loss: 13.0417 - val_accuracy10: 0.4324 - val_accuracy20: 0.3651 - val_accuracy30: 0.3557 - val_accuracy50: 0.3652 - 157s/epoch - 25ms/step
Epoch 16/50
6147/6147 - 151s - loss: 12.5354 - accuracy10: 0.4666 - accuracy20: 0.4554 - accuracy30: 0.4441 - accuracy50: 0.4422 - val_loss: 13.0531 - val_accuracy10: 0.4309 - val_accuracy20: 0.3644 - val_accuracy30: 0.3559 - val_accuracy50: 0.3656 - 151s/epoch - 25ms/step
Epoch 17/50
6147/6147 - 156s - loss: 12.5292 - accuracy10: 0.4671 - accuracy20: 0.4560 - accuracy30: 0.4446 - accuracy50: 0.4426 - val_loss: 13.0471 - val_accuracy10: 0.4333 - val_accuracy20: 0.3652 - val_accuracy30: 0.3561 - val_accuracy50: 0.3654 - 156s/epoch - 25ms/step
Epoch 18/50
6147/6147 - 148s - loss: 12.5241 - accuracy10: 0.4677 - accuracy20: 0.4566 - accuracy30: 0.4450 - accuracy50: 0.4428 - val_loss: 13.0365 - val_accuracy10: 0.4355 - val_accuracy20: 0.3670 - val_accuracy30: 0.3564 - val_accuracy50: 0.3653 - 148s/epoch - 24ms/step
Epoch 19/50
6147/6147 - 157s - loss: 12.5204 - accuracy10: 0.4679 - accuracy20: 0.4570 - accuracy30: 0.4452 - accuracy50: 0.4431 - val_loss: 13.0290 - val_accuracy10: 0.4366 - val_accuracy20: 0.3676 - val_accuracy30: 0.3570 - val_accuracy50: 0.3658 - 157s/epoch - 25ms/step
Epoch 20/50
6147/6147 - 146s - loss: 12.5155 - accuracy10: 0.4685 - accuracy20: 0.4575 - accuracy30: 0.4458 - accuracy50: 0.4435 - val_loss: 13.0233 - val_accuracy10: 0.4375 - val_accuracy20: 0.3682 - val_accuracy30: 0.3567 - val_accuracy50: 0.3658 - 146s/epoch - 24ms/step
Epoch 21/50
6147/6147 - 163s - loss: 12.5109 - accuracy10: 0.4689 - accuracy20: 0.4576 - accuracy30: 0.4460 - accuracy50: 0.4440 - val_loss: 13.0296 - val_accuracy10: 0.4368 - val_accuracy20: 0.3697 - val_accuracy30: 0.3584 - val_accuracy50: 0.3664 - 163s/epoch - 26ms/step
Epoch 22/50
6147/6147 - 152s - loss: 12.5059 - accuracy10: 0.4693 - accuracy20: 0.4584 - accuracy30: 0.4468 - accuracy50: 0.4444 - val_loss: 13.0262 - val_accuracy10: 0.4381 - val_accuracy20: 0.3689 - val_accuracy30: 0.3574 - val_accuracy50: 0.3661 - 152s/epoch - 25ms/step
Epoch 23/50
6147/6147 - 139s - loss: 12.5020 - accuracy10: 0.4698 - accuracy20: 0.4590 - accuracy30: 0.4469 - accuracy50: 0.4448 - val_loss: 13.0217 - val_accuracy10: 0.4393 - val_accuracy20: 0.3719 - val_accuracy30: 0.3593 - val_accuracy50: 0.3666 - 139s/epoch - 23ms/step
Epoch 24/50
6147/6147 - 147s - loss: 12.4974 - accuracy10: 0.4701 - accuracy20: 0.4588 - accuracy30: 0.4472 - accuracy50: 0.4451 - val_loss: 13.0161 - val_accuracy10: 0.4403 - val_accuracy20: 0.3729 - val_accuracy30: 0.3594 - val_accuracy50: 0.3669 - 147s/epoch - 24ms/step
Epoch 25/50
6147/6147 - 144s - loss: 12.4931 - accuracy10: 0.4704 - accuracy20: 0.4596 - accuracy30: 0.4479 - accuracy50: 0.4454 - val_loss: 13.0113 - val_accuracy10: 0.4404 - val_accuracy20: 0.3732 - val_accuracy30: 0.3596 - val_accuracy50: 0.3671 - 144s/epoch - 23ms/step
Epoch 26/50
6147/6147 - 147s - loss: 12.4886 - accuracy10: 0.4706 - accuracy20: 0.4599 - accuracy30: 0.4483 - accuracy50: 0.4457 - val_loss: 13.0083 - val_accuracy10: 0.4416 - val_accuracy20: 0.3743 - val_accuracy30: 0.3599 - val_accuracy50: 0.3673 - 147s/epoch - 24ms/step
Epoch 27/50
6147/6147 - 145s - loss: 12.4845 - accuracy10: 0.4707 - accuracy20: 0.4602 - accuracy30: 0.4485 - accuracy50: 0.4459 - val_loss: 13.0145 - val_accuracy10: 0.4417 - val_accuracy20: 0.3759 - val_accuracy30: 0.3604 - val_accuracy50: 0.3679 - 145s/epoch - 24ms/step
Epoch 28/50
6147/6147 - 146s - loss: 12.4795 - accuracy10: 0.4714 - accuracy20: 0.4610 - accuracy30: 0.4492 - accuracy50: 0.4467 - val_loss: 13.0148 - val_accuracy10: 0.4408 - val_accuracy20: 0.3756 - val_accuracy30: 0.3602 - val_accuracy50: 0.3678 - 146s/epoch - 24ms/step
Epoch 29/50
6147/6147 - 144s - loss: 12.4771 - accuracy10: 0.4714 - accuracy20: 0.4610 - accuracy30: 0.4492 - accuracy50: 0.4468 - val_loss: 13.0060 - val_accuracy10: 0.4431 - val_accuracy20: 0.3774 - val_accuracy30: 0.3603 - val_accuracy50: 0.3674 - 144s/epoch - 23ms/step
Epoch 30/50
6147/6147 - 153s - loss: 12.4729 - accuracy10: 0.4717 - accuracy20: 0.4614 - accuracy30: 0.4495 - accuracy50: 0.4472 - val_loss: 13.0082 - val_accuracy10: 0.4424 - val_accuracy20: 0.3770 - val_accuracy30: 0.3605 - val_accuracy50: 0.3674 - 153s/epoch - 25ms/step
Epoch 31/50
6147/6147 - 146s - loss: 12.4685 - accuracy10: 0.4724 - accuracy20: 0.4620 - accuracy30: 0.4500 - accuracy50: 0.4476 - val_loss: 13.0150 - val_accuracy10: 0.4448 - val_accuracy20: 0.3789 - val_accuracy30: 0.3608 - val_accuracy50: 0.3674 - 146s/epoch - 24ms/step
Epoch 32/50
6147/6147 - 146s - loss: 12.4652 - accuracy10: 0.4725 - accuracy20: 0.4624 - accuracy30: 0.4503 - accuracy50: 0.4481 - val_loss: 12.9968 - val_accuracy10: 0.4452 - val_accuracy20: 0.3810 - val_accuracy30: 0.3622 - val_accuracy50: 0.3685 - 146s/epoch - 24ms/step
Epoch 33/50
6147/6147 - 148s - loss: 12.4608 - accuracy10: 0.4727 - accuracy20: 0.4623 - accuracy30: 0.4507 - accuracy50: 0.4484 - val_loss: 13.0028 - val_accuracy10: 0.4452 - val_accuracy20: 0.3814 - val_accuracy30: 0.3628 - val_accuracy50: 0.3683 - 148s/epoch - 24ms/step
Epoch 34/50
6147/6147 - 141s - loss: 12.4582 - accuracy10: 0.4729 - accuracy20: 0.4630 - accuracy30: 0.4509 - accuracy50: 0.4484 - val_loss: 12.9884 - val_accuracy10: 0.4470 - val_accuracy20: 0.3831 - val_accuracy30: 0.3631 - val_accuracy50: 0.3683 - 141s/epoch - 23ms/step
Epoch 35/50
6147/6147 - 145s - loss: 12.4522 - accuracy10: 0.4732 - accuracy20: 0.4632 - accuracy30: 0.4513 - accuracy50: 0.4489 - val_loss: 12.9812 - val_accuracy10: 0.4465 - val_accuracy20: 0.3840 - val_accuracy30: 0.3636 - val_accuracy50: 0.3684 - 145s/epoch - 24ms/step
Epoch 36/50
6147/6147 - 148s - loss: 12.4488 - accuracy10: 0.4736 - accuracy20: 0.4638 - accuracy30: 0.4517 - accuracy50: 0.4496 - val_loss: 12.9986 - val_accuracy10: 0.4473 - val_accuracy20: 0.3844 - val_accuracy30: 0.3640 - val_accuracy50: 0.3692 - 148s/epoch - 24ms/step
Epoch 37/50
6147/6147 - 150s - loss: 12.4448 - accuracy10: 0.4735 - accuracy20: 0.4639 - accuracy30: 0.4522 - accuracy50: 0.4498 - val_loss: 12.9755 - val_accuracy10: 0.4491 - val_accuracy20: 0.3866 - val_accuracy30: 0.3642 - val_accuracy50: 0.3686 - 150s/epoch - 24ms/step
Epoch 38/50
6147/6147 - 143s - loss: 12.4409 - accuracy10: 0.4739 - accuracy20: 0.4647 - accuracy30: 0.4526 - accuracy50: 0.4500 - val_loss: 12.9863 - val_accuracy10: 0.4480 - val_accuracy20: 0.3868 - val_accuracy30: 0.3652 - val_accuracy50: 0.3689 - 143s/epoch - 23ms/step
Epoch 39/50
6147/6147 - 142s - loss: 12.4383 - accuracy10: 0.4743 - accuracy20: 0.4646 - accuracy30: 0.4528 - accuracy50: 0.4503 - val_loss: 13.0012 - val_accuracy10: 0.4464 - val_accuracy20: 0.3844 - val_accuracy30: 0.3635 - val_accuracy50: 0.3683 - 142s/epoch - 23ms/step
Epoch 40/50
6147/6147 - 149s - loss: 12.4360 - accuracy10: 0.4744 - accuracy20: 0.4648 - accuracy30: 0.4534 - accuracy50: 0.4504 - val_loss: 12.9952 - val_accuracy10: 0.4478 - val_accuracy20: 0.3868 - val_accuracy30: 0.3640 - val_accuracy50: 0.3686 - 149s/epoch - 24ms/step
Epoch 41/50
6147/6147 - 145s - loss: 12.4313 - accuracy10: 0.4744 - accuracy20: 0.4649 - accuracy30: 0.4534 - accuracy50: 0.4512 - val_loss: 12.9889 - val_accuracy10: 0.4467 - val_accuracy20: 0.3864 - val_accuracy30: 0.3645 - val_accuracy50: 0.3685 - 145s/epoch - 24ms/step
Epoch 42/50
6147/6147 - 140s - loss: 12.4280 - accuracy10: 0.4747 - accuracy20: 0.4653 - accuracy30: 0.4535 - accuracy50: 0.4513 - val_loss: 12.9822 - val_accuracy10: 0.4484 - val_accuracy20: 0.3886 - val_accuracy30: 0.3654 - val_accuracy50: 0.3692 - 140s/epoch - 23ms/step
Epoch 43/50
6147/6147 - 140s - loss: 12.4250 - accuracy10: 0.4749 - accuracy20: 0.4656 - accuracy30: 0.4546 - accuracy50: 0.4513 - val_loss: 12.9736 - val_accuracy10: 0.4492 - val_accuracy20: 0.3902 - val_accuracy30: 0.3656 - val_accuracy50: 0.3685 - 140s/epoch - 23ms/step
Epoch 44/50
6147/6147 - 145s - loss: 12.4204 - accuracy10: 0.4750 - accuracy20: 0.4661 - accuracy30: 0.4547 - accuracy50: 0.4523 - val_loss: 12.9821 - val_accuracy10: 0.4495 - val_accuracy20: 0.3902 - val_accuracy30: 0.3656 - val_accuracy50: 0.3691 - 145s/epoch - 24ms/step
Epoch 45/50
6147/6147 - 144s - loss: 12.4176 - accuracy10: 0.4753 - accuracy20: 0.4662 - accuracy30: 0.4547 - accuracy50: 0.4522 - val_loss: 12.9976 - val_accuracy10: 0.4499 - val_accuracy20: 0.3904 - val_accuracy30: 0.3661 - val_accuracy50: 0.3689 - 144s/epoch - 23ms/step
Epoch 46/50
6147/6147 - 141s - loss: 12.4150 - accuracy10: 0.4755 - accuracy20: 0.4668 - accuracy30: 0.4552 - accuracy50: 0.4528 - val_loss: 12.9779 - val_accuracy10: 0.4497 - val_accuracy20: 0.3915 - val_accuracy30: 0.3669 - val_accuracy50: 0.3689 - 141s/epoch - 23ms/step
Epoch 47/50
6147/6147 - 146s - loss: 12.4106 - accuracy10: 0.4755 - accuracy20: 0.4673 - accuracy30: 0.4554 - accuracy50: 0.4536 - val_loss: 12.9961 - val_accuracy10: 0.4496 - val_accuracy20: 0.3913 - val_accuracy30: 0.3669 - val_accuracy50: 0.3690 - 146s/epoch - 24ms/step
Epoch 48/50
6147/6147 - 143s - loss: 12.4097 - accuracy10: 0.4757 - accuracy20: 0.4674 - accuracy30: 0.4559 - accuracy50: 0.4535 - val_loss: 12.9901 - val_accuracy10: 0.4507 - val_accuracy20: 0.3921 - val_accuracy30: 0.3669 - val_accuracy50: 0.3690 - 143s/epoch - 23ms/step
Epoch 49/50
6147/6147 - 130s - loss: 12.4028 - accuracy10: 0.4763 - accuracy20: 0.4680 - accuracy30: 0.4567 - accuracy50: 0.4546 - val_loss: 13.0012 - val_accuracy10: 0.4495 - val_accuracy20: 0.3919 - val_accuracy30: 0.3669 - val_accuracy50: 0.3689 - 130s/epoch - 21ms/step
Epoch 50/50
6147/6147 - 135s - loss: 12.4000 - accuracy10: 0.4762 - accuracy20: 0.4685 - accuracy30: 0.4571 - accuracy50: 0.4550 - val_loss: 13.0051 - val_accuracy10: 0.4498 - val_accuracy20: 0.3951 - val_accuracy30: 0.3683 - val_accuracy50: 0.3691 - 135s/epoch - 22ms/step
testing model: results/AAPL/W2/deepOF_L1/seq2seq
Evaluating performance on  test set...
14883/14883 - 137s - 137s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0474638
{'0': {'precision': 0.4587637217968972, 'recall': 0.2618794367239346, 'f1-score': 0.3334265610739836, 'support': 1124422}, '1': {'precision': 0.44663577589109377, 'recall': 0.7412904905410309, 'f1-score': 0.5574198715175904, 'support': 1521096}, '2': {'precision': 0.4399444857157955, 'recall': 0.2431147670511931, 'f1-score': 0.3131704920970852, 'support': 1164376}, 'accuracy': 0.44754893443229654, 'macro avg': {'precision': 0.44844799446792877, 'recall': 0.4154282314387195, 'f1-score': 0.4013389748962197, 'support': 3809894}, 'weighted avg': {'precision': 0.4481701365589082, 'recall': 0.44754893443229654, 'f1-score': 0.4166650049707124, 'support': 3809894}}
[[ 294463  667471  162488]
 [ 195649 1127574  197873]
 [ 151750  729549  283077]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.079871
{'0': {'precision': 0.5027683619800659, 'recall': 0.17742669532728564, 'f1-score': 0.2622910237965103, 'support': 1206301}, '1': {'precision': 0.3712162723720208, 'recall': 0.8388236017236897, 'f1-score': 0.5146689415375598, 'support': 1350359}, '2': {'precision': 0.4748719335406433, 'recall': 0.12611691032959527, 'f1-score': 0.19930280460686137, 'support': 1253234}, 'accuracy': 0.39497083120947724, 'macro avg': {'precision': 0.44961885596424334, 'recall': 0.3807890691268569, 'f1-score': 0.32542092331364386, 'support': 3809894}, 'weighted avg': {'precision': 0.4469654181790359, 'recall': 0.39497083120947724, 'f1-score': 0.3310230711277393, 'support': 3809894}}
[[ 214030  913760   78511]
 [ 121376 1132713   96270]
 [  90297 1004883  158054]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0856514
{'0': {'precision': 0.49940428087278443, 'recall': 0.13293987703144278, 'f1-score': 0.2099829431752555, 'support': 1176073}, '1': {'precision': 0.374733094195175, 'recall': 0.9040634512924051, 'f1-score': 0.5298458079934846, 'support': 1404668}, '2': {'precision': 0.49993054976803625, 'recall': 0.04392292904138053, 'f1-score': 0.08075121303315126, 'support': 1229153}, 'accuracy': 0.3885262949572875, 'macro avg': {'precision': 0.45802264161199857, 'recall': 0.3603087524550761, 'f1-score': 0.27352665473396376, 'support': 3809894}, 'weighted avg': {'precision': 0.45360910613651645, 'recall': 0.3885262949572875, 'f1-score': 0.2862201197998898, 'support': 3809894}}
[[ 156347 1000930   18796]
 [  99552 1269909   35207]
 [  57168 1117997   53988]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0305191
{'0': {'precision': 0.4203545340023303, 'recall': 0.10084767791127541, 'f1-score': 0.16266922006324147, 'support': 969472}, '1': {'precision': 0.4903394846840877, 'recall': 0.9365581874722729, 'f1-score': 0.6436781949862128, 'support': 1855133}, '2': {'precision': 0.42648530883825003, 'recall': 0.014702285319332703, 'f1-score': 0.028424682733957644, 'support': 985289}, 'accuracy': 0.48549775925524435, 'macro avg': {'precision': 0.44572644250822274, 'recall': 0.3507027169009603, 'f1-score': 0.278257365927804, 'support': 3809894}, 'weighted avg': {'precision': 0.456017462293881, 'recall': 0.48549775925524435, 'f1-score': 0.36216714749511847, 'support': 3809894}}
[[  97769  868118    3585]
 [ 101798 1737440   15895]
 [  33020  937783   14486]]
Evaluating performance on  train set...
6147/6147 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0444368
{'0': {'precision': 0.47759936155428506, 'recall': 0.2864319223643873, 'f1-score': 0.3580997431109369, 'support': 484726}, '1': {'precision': 0.42844108961628646, 'recall': 0.7073416882569139, 'f1-score': 0.5336482460410207, 'support': 597492}, '2': {'precision': 0.45687019551998054, 'recall': 0.27559056720914377, 'f1-score': 0.34379757314281434, 'support': 491265}, 'accuracy': 0.4428773618780756, 'macro avg': {'precision': 0.4543035488968507, 'recall': 0.4231213926101483, 'f1-score': 0.4118485207649239, 'support': 1573483}, 'weighted avg': {'precision': 0.45246074361648636, 'recall': 0.4428773618780756, 'f1-score': 0.42029467663313697, 'support': 1573483}}
[[138841 273885  72000]
 [ 85911 422631  88950]
 [ 65954 289923 135388]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0754913
{'0': {'precision': 0.5360616907042847, 'recall': 0.1954136573310103, 'f1-score': 0.28641778787742433, 'support': 521156}, '1': {'precision': 0.3507808113276641, 'recall': 0.8232122804739243, 'f1-score': 0.491939984410646, 'support': 523628}, '2': {'precision': 0.5041350636586422, 'recall': 0.1474676517262185, 'f1-score': 0.22818693733244363, 'support': 528699}, 'accuracy': 0.3882240863104336, 'macro avg': {'precision': 0.4636591885635304, 'recall': 0.388697863177051, 'f1-score': 0.335514903206838, 'support': 1573483}, 'weighted avg': {'precision': 0.46367588666405973, 'recall': 0.3882240863104336, 'f1-score': 0.3352461414560884, 'support': 1573483}}
[[101841 384937  34378]
 [ 50262 431057  42309]
 [ 37877 412856  77966]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0920705
{'0': {'precision': 0.5526890699911271, 'recall': 0.1419274174092526, 'f1-score': 0.22585623507939626, 'support': 522274}, '1': {'precision': 0.33674552258081225, 'recall': 0.9026302746755789, 'f1-score': 0.4904996599348794, 'support': 518539}, '2': {'precision': 0.5469694824761866, 'recall': 0.050774400660821895, 'f1-score': 0.09292290037913338, 'support': 532670}, 'accuracy': 0.3617579598889851, 'macro avg': {'precision': 0.4788013583493753, 'recall': 0.36511069758188447, 'f1-score': 0.2697595984644697, 'support': 1573483}, 'weighted avg': {'precision': 0.47958894510119776, 'recall': 0.3617579598889851, 'f1-score': 0.268067264678285, 'support': 1573483}}
[[ 74125 439971   8178]
 [ 36267 468049  14223]
 [ 23725 481899  27046]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1139165
{'0': {'precision': 0.5342368631963996, 'recall': 0.1000733328328993, 'f1-score': 0.1685700900188208, 'support': 519549}, '1': {'precision': 0.33363861811406564, 'recall': 0.9388396227868777, 'f1-score': 0.49231985948234114, 'support': 519176}, '2': {'precision': 0.555876559422193, 'recall': 0.015831460211908937, 'f1-score': 0.030786126242754383, 'support': 534758}, 'accuracy': 0.3481969617720687, 'macro avg': {'precision': 0.47458401357755275, 'recall': 0.3515814719438953, 'f1-score': 0.23055869191463876, 'support': 1573483}, 'weighted avg': {'precision': 0.4754031841451783, 'recall': 0.3481969617720687, 'f1-score': 0.2285656752332978, 'support': 1573483}}
[[ 51993 465452   2104]
 [ 27093 487423   4660]
 [ 18236 508056   8466]]
Evaluating performance on  val set...
2174/2174 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0418051
{'0': {'precision': 0.4782961299957472, 'recall': 0.28657521258629376, 'f1-score': 0.3584075059473961, 'support': 168755}, '1': {'precision': 0.4384054181636247, 'recall': 0.7281331424144973, 'f1-score': 0.5472901206468848, 'support': 213005}, '2': {'precision': 0.45924482626280516, 'recall': 0.2670664919338686, 'f1-score': 0.3377309470911341, 'support': 174743}, 'accuracy': 0.44945849348521033, 'macro avg': {'precision': 0.45864879147405907, 'recall': 0.4272582823115532, 'f1-score': 0.4144761912284716, 'support': 556503}, 'weighted avg': {'precision': 0.457045565233281, 'recall': 0.44945849348521033, 'f1-score': 0.424211027976648, 'support': 556503}}
[[ 48361  94186  26208]
 [ 29166 155096  28743]
 [ 23584 104491  46668]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0765755
{'0': {'precision': 0.5257222031852923, 'recall': 0.19355705728766703, 'f1-score': 0.2829422400763344, 'support': 182308}, '1': {'precision': 0.35525378225432014, 'recall': 0.8284253293740553, 'f1-score': 0.4972652278547804, 'support': 186566}, '2': {'precision': 0.4987666593034386, 'recall': 0.14440731443433585, 'f1-score': 0.2239691179691924, 'support': 187629}, 'accuracy': 0.38982359484135753, 'macro avg': {'precision': 0.4599142149143503, 'recall': 0.3887965670320194, 'f1-score': 0.3347255286334357, 'support': 556503}, 'weighted avg': {'precision': 0.4594849085751715, 'recall': 0.38982359484135753, 'f1-score': 0.3349101802492222, 'support': 556503}}
[[ 35287 133939  13082]
 [ 17863 154556  14147]
 [ 13971 146563  27095]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0911258
{'0': {'precision': 0.5241157556270096, 'recall': 0.13836783066449854, 'f1-score': 0.21893602082779134, 'support': 181415}, '1': {'precision': 0.3440554991374142, 'recall': 0.8959218351741717, 'f1-score': 0.4971814010779336, 'support': 188320}, '2': {'precision': 0.529660319376612, 'recall': 0.0516790884948171, 'f1-score': 0.09416998795069054, 'support': 186768}, 'accuracy': 0.36562965518604573, 'macro avg': {'precision': 0.4659438580470119, 'recall': 0.3619895847778291, 'f1-score': 0.27009580328547184, 'support': 556503}, 'weighted avg': {'precision': 0.4650443752036608, 'recall': 0.36562965518604573, 'f1-score': 0.27122121530170507, 'support': 556503}}
[[ 25102 153183   3130]
 [ 14159 168720   5441]
 [  8633 168483   9652]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024436
{'0': {'precision': 0.4797223342358431, 'recall': 0.09448894839558844, 'f1-score': 0.1578807670796561, 'support': 176264}, '1': {'precision': 0.35960782259675916, 'recall': 0.9290848035284683, 'f1-score': 0.5185195545181056, 'support': 199520}, '2': {'precision': 0.4990482233502538, 'recall': 0.017408241524134154, 'f1-score': 0.03364292092416441, 'support': 180719}, 'accuracy': 0.36868085167555253, 'macro avg': {'precision': 0.44612612672761864, 'recall': 0.34699399781606366, 'f1-score': 0.23668108084064202, 'support': 556503}, 'weighted avg': {'precision': 0.44293422706056673, 'recall': 0.36868085167555253, 'f1-score': 0.24683358772994038, 'support': 556503}}
[[ 16655 158824    785]
 [ 11776 185371   2373]
 [  6287 171286   3146]]
training model: results/AAPL/W2/deepLOB_L2/seq2seq
Epoch 1/50
6147/6147 - 306s - loss: 12.5241 - accuracy10: 0.4546 - accuracy20: 0.4489 - accuracy30: 0.4411 - accuracy50: 0.4404 - val_loss: 13.6178 - val_accuracy10: 0.3911 - val_accuracy20: 0.3808 - val_accuracy30: 0.3762 - val_accuracy50: 0.3813 - 306s/epoch - 50ms/step
Epoch 2/50
6147/6147 - 293s - loss: 12.3065 - accuracy10: 0.4857 - accuracy20: 0.4746 - accuracy30: 0.4602 - accuracy50: 0.4520 - val_loss: 13.8159 - val_accuracy10: 0.4082 - val_accuracy20: 0.4036 - val_accuracy30: 0.3965 - val_accuracy50: 0.4042 - 293s/epoch - 48ms/step
Epoch 3/50
6147/6147 - 296s - loss: 12.1798 - accuracy10: 0.5003 - accuracy20: 0.4861 - accuracy30: 0.4690 - accuracy50: 0.4585 - val_loss: 13.4974 - val_accuracy10: 0.4194 - val_accuracy20: 0.4133 - val_accuracy30: 0.3928 - val_accuracy50: 0.3895 - 296s/epoch - 48ms/step
Epoch 4/50
6147/6147 - 292s - loss: 12.0957 - accuracy10: 0.5087 - accuracy20: 0.4931 - accuracy30: 0.4742 - accuracy50: 0.4626 - val_loss: 13.3283 - val_accuracy10: 0.4230 - val_accuracy20: 0.4182 - val_accuracy30: 0.3918 - val_accuracy50: 0.3877 - 292s/epoch - 48ms/step
Epoch 5/50
6147/6147 - 296s - loss: 12.0490 - accuracy10: 0.5132 - accuracy20: 0.4966 - accuracy30: 0.4773 - accuracy50: 0.4651 - val_loss: 12.8781 - val_accuracy10: 0.4575 - val_accuracy20: 0.4515 - val_accuracy30: 0.4186 - val_accuracy50: 0.4054 - 296s/epoch - 48ms/step
Epoch 6/50
6147/6147 - 294s - loss: 12.0117 - accuracy10: 0.5166 - accuracy20: 0.4994 - accuracy30: 0.4793 - accuracy50: 0.4668 - val_loss: 13.0286 - val_accuracy10: 0.4255 - val_accuracy20: 0.4376 - val_accuracy30: 0.4170 - val_accuracy50: 0.4124 - 294s/epoch - 48ms/step
Epoch 7/50
6147/6147 - 291s - loss: 11.9830 - accuracy10: 0.5188 - accuracy20: 0.5012 - accuracy30: 0.4807 - accuracy50: 0.4686 - val_loss: 12.9857 - val_accuracy10: 0.4388 - val_accuracy20: 0.4475 - val_accuracy30: 0.4205 - val_accuracy50: 0.4085 - 291s/epoch - 47ms/step
Epoch 8/50
6147/6147 - 292s - loss: 11.9600 - accuracy10: 0.5208 - accuracy20: 0.5024 - accuracy30: 0.4821 - accuracy50: 0.4691 - val_loss: 12.7632 - val_accuracy10: 0.4584 - val_accuracy20: 0.4605 - val_accuracy30: 0.4276 - val_accuracy50: 0.4041 - 292s/epoch - 47ms/step
Epoch 9/50
6147/6147 - 290s - loss: 11.9438 - accuracy10: 0.5222 - accuracy20: 0.5038 - accuracy30: 0.4830 - accuracy50: 0.4700 - val_loss: 12.7631 - val_accuracy10: 0.4566 - val_accuracy20: 0.4616 - val_accuracy30: 0.4293 - val_accuracy50: 0.4044 - 290s/epoch - 47ms/step
Epoch 10/50
6147/6147 - 294s - loss: 11.9229 - accuracy10: 0.5243 - accuracy20: 0.5050 - accuracy30: 0.4843 - accuracy50: 0.4712 - val_loss: 12.8235 - val_accuracy10: 0.4667 - val_accuracy20: 0.4621 - val_accuracy30: 0.4286 - val_accuracy50: 0.4116 - 294s/epoch - 48ms/step
Epoch 11/50
6147/6147 - 298s - loss: 11.9056 - accuracy10: 0.5255 - accuracy20: 0.5061 - accuracy30: 0.4852 - accuracy50: 0.4720 - val_loss: 12.8689 - val_accuracy10: 0.4647 - val_accuracy20: 0.4612 - val_accuracy30: 0.4268 - val_accuracy50: 0.4086 - 298s/epoch - 48ms/step
Epoch 12/50
6147/6147 - 297s - loss: 11.8918 - accuracy10: 0.5265 - accuracy20: 0.5070 - accuracy30: 0.4862 - accuracy50: 0.4729 - val_loss: 12.7483 - val_accuracy10: 0.4788 - val_accuracy20: 0.4674 - val_accuracy30: 0.4243 - val_accuracy50: 0.3997 - 297s/epoch - 48ms/step
Epoch 13/50
6147/6147 - 296s - loss: 11.8780 - accuracy10: 0.5276 - accuracy20: 0.5080 - accuracy30: 0.4871 - accuracy50: 0.4737 - val_loss: 12.7080 - val_accuracy10: 0.4842 - val_accuracy20: 0.4707 - val_accuracy30: 0.4311 - val_accuracy50: 0.4042 - 296s/epoch - 48ms/step
Epoch 14/50
6147/6147 - 294s - loss: 11.8682 - accuracy10: 0.5282 - accuracy20: 0.5087 - accuracy30: 0.4877 - accuracy50: 0.4742 - val_loss: 12.7257 - val_accuracy10: 0.4846 - val_accuracy20: 0.4708 - val_accuracy30: 0.4315 - val_accuracy50: 0.4059 - 294s/epoch - 48ms/step
Epoch 15/50
6147/6147 - 296s - loss: 11.8558 - accuracy10: 0.5294 - accuracy20: 0.5099 - accuracy30: 0.4887 - accuracy50: 0.4753 - val_loss: 12.7532 - val_accuracy10: 0.4808 - val_accuracy20: 0.4707 - val_accuracy30: 0.4354 - val_accuracy50: 0.4115 - 296s/epoch - 48ms/step
Epoch 16/50
6147/6147 - 295s - loss: 11.8455 - accuracy10: 0.5299 - accuracy20: 0.5104 - accuracy30: 0.4894 - accuracy50: 0.4758 - val_loss: 12.9015 - val_accuracy10: 0.4704 - val_accuracy20: 0.4623 - val_accuracy30: 0.4265 - val_accuracy50: 0.4067 - 295s/epoch - 48ms/step
Epoch 17/50
6147/6147 - 296s - loss: 11.8366 - accuracy10: 0.5309 - accuracy20: 0.5115 - accuracy30: 0.4901 - accuracy50: 0.4763 - val_loss: 12.7380 - val_accuracy10: 0.4890 - val_accuracy20: 0.4721 - val_accuracy30: 0.4331 - val_accuracy50: 0.4022 - 296s/epoch - 48ms/step
Epoch 18/50
6147/6147 - 295s - loss: 11.8256 - accuracy10: 0.5312 - accuracy20: 0.5121 - accuracy30: 0.4909 - accuracy50: 0.4771 - val_loss: 12.8411 - val_accuracy10: 0.4791 - val_accuracy20: 0.4673 - val_accuracy30: 0.4331 - val_accuracy50: 0.4091 - 295s/epoch - 48ms/step
Epoch 19/50
6147/6147 - 295s - loss: 11.8161 - accuracy10: 0.5321 - accuracy20: 0.5130 - accuracy30: 0.4915 - accuracy50: 0.4778 - val_loss: 12.8361 - val_accuracy10: 0.4814 - val_accuracy20: 0.4672 - val_accuracy30: 0.4325 - val_accuracy50: 0.4067 - 295s/epoch - 48ms/step
Epoch 20/50
6147/6147 - 297s - loss: 11.8061 - accuracy10: 0.5322 - accuracy20: 0.5135 - accuracy30: 0.4924 - accuracy50: 0.4782 - val_loss: 12.9120 - val_accuracy10: 0.4829 - val_accuracy20: 0.4658 - val_accuracy30: 0.4301 - val_accuracy50: 0.4033 - 297s/epoch - 48ms/step
Epoch 21/50
6147/6147 - 300s - loss: 11.7988 - accuracy10: 0.5331 - accuracy20: 0.5141 - accuracy30: 0.4929 - accuracy50: 0.4790 - val_loss: 13.0294 - val_accuracy10: 0.4614 - val_accuracy20: 0.4558 - val_accuracy30: 0.4269 - val_accuracy50: 0.4065 - 300s/epoch - 49ms/step
Epoch 22/50
6147/6147 - 294s - loss: 11.7890 - accuracy10: 0.5338 - accuracy20: 0.5148 - accuracy30: 0.4938 - accuracy50: 0.4798 - val_loss: 12.9648 - val_accuracy10: 0.4726 - val_accuracy20: 0.4617 - val_accuracy30: 0.4269 - val_accuracy50: 0.4038 - 294s/epoch - 48ms/step
Epoch 23/50
6147/6147 - 292s - loss: 11.7824 - accuracy10: 0.5342 - accuracy20: 0.5155 - accuracy30: 0.4942 - accuracy50: 0.4801 - val_loss: 12.9619 - val_accuracy10: 0.4651 - val_accuracy20: 0.4584 - val_accuracy30: 0.4270 - val_accuracy50: 0.4037 - 292s/epoch - 47ms/step
testing model: results/AAPL/W2/deepLOB_L2/seq2seq
Evaluating performance on  test set...
14883/14883 - 235s - 235s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0103079
{'0': {'precision': 0.457054555486893, 'recall': 0.5466087525702048, 'f1-score': 0.4978363130855978, 'support': 1124424}, '1': {'precision': 0.5539599021544489, 'recall': 0.40227769976385447, 'f1-score': 0.46608858457992436, 'support': 1521096}, '2': {'precision': 0.4582230846122185, 'recall': 0.5354270387906344, 'f1-score': 0.4938257914349614, 'support': 1164379}, 'accuracy': 0.4855674651742736, 'macro avg': {'precision': 0.4897458474178535, 'recall': 0.4947711637082312, 'f1-score': 0.4859168963668279, 'support': 3809899}, 'weighted avg': {'precision': 0.4961009832187173, 'recall': 0.4855674651742736, 'f1-score': 0.4839353907703049, 'support': 3809899}}
[[614620 242337 267467]
 [439540 611903 469653]
 [290581 250358 623440]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0414282
{'0': {'precision': 0.48574936862550183, 'recall': 0.43910977516409655, 'f1-score': 0.46125358110049725, 'support': 1206302}, '1': {'precision': 0.43690286222150404, 'recall': 0.5125685002517847, 'f1-score': 0.4717206936315335, 'support': 1350360}, '2': {'precision': 0.48497749729782585, 'recall': 0.4392983928817933, 'f1-score': 0.4610091800736382, 'support': 1253237}, 'accuracy': 0.46520813281401946, 'macro avg': {'precision': 0.4692099093816106, 'recall': 0.4636588894325582, 'f1-score': 0.4646611516018897, 'support': 3809899}, 'weighted avg': {'precision': 0.4681825758851208, 'recall': 0.46520813281401946, 'f1-score': 0.4648830940266174, 'support': 3809899}}
[[529699 437728 238875]
 [312431 692152 345777]
 [248348 454344 550545]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0605845
{'0': {'precision': 0.4966386345386526, 'recall': 0.271358775043067, 'f1-score': 0.3509575678930207, 'support': 1176074}, '1': {'precision': 0.40408081508922783, 'recall': 0.6965434561451844, 'f1-score': 0.5114549167420065, 'support': 1404669}, '2': {'precision': 0.49008744284310557, 'recall': 0.29743336077763927, 'f1-score': 0.37019556697309386, 'support': 1229156}, 'accuracy': 0.43653204455026234, 'macro avg': {'precision': 0.46360229749032866, 'recall': 0.42177853065529697, 'f1-score': 0.41086935053604035, 'support': 3809899}, 'weighted avg': {'precision': 0.460400000320807, 'recall': 0.43653204455026234, 'f1-score': 0.4163378187888115, 'support': 3809899}}
[[319138 712688 144248]
 [190123 978413 236133]
 [133335 730229 365592]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0070643
{'0': {'precision': 0.4372870694070231, 'recall': 0.16205179303416078, 'f1-score': 0.2364710787464271, 'support': 969474}, '1': {'precision': 0.5124047664910893, 'recall': 0.8316700231142083, 'f1-score': 0.6341190048161218, 'support': 1855136}, '2': {'precision': 0.4320245128034813, 'recall': 0.19275664297480233, 'f1-score': 0.2665752447897952, 'support': 985289}, 'accuracy': 0.4960464831219935, 'macro avg': {'precision': 0.46057211623386457, 'recall': 0.3954928197077239, 'f1-score': 0.3790551094507813, 'support': 3809899}, 'weighted avg': {'precision': 0.47250280740018225, 'recall': 0.4960464831219935, 'f1-score': 0.4378812176067836, 'support': 3809899}}
[[ 157105  737406   74963]
 [ 137552 1542861  174723]
 [  64615  730753  189921]]
Evaluating performance on  train set...
6147/6147 - 98s - 98s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0462766
{'0': {'precision': 0.46788312655646924, 'recall': 0.5129098107138439, 'f1-score': 0.4893629159813974, 'support': 484980}, '1': {'precision': 0.5332673272787947, 'recall': 0.32361609720583434, 'f1-score': 0.4027943271866745, 'support': 597495}, '2': {'precision': 0.4304266533184147, 'recall': 0.5954318649314678, 'f1-score': 0.49965904721213417, 'support': 491010}, 'accuracy': 0.4667810624187711, 'macro avg': {'precision': 0.47719236905122625, 'recall': 0.4773192576170487, 'f1-score': 0.4639387634600687, 'support': 1573485}, 'weighted avg': {'precision': 0.48102289597655823, 'recall': 0.4667810624187711, 'f1-score': 0.4597034050446558, 'support': 1573485}}
[[248751  88595 147634]
 [164893 193359 239243]
 [118008  80639 292363]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0695437
{'0': {'precision': 0.49770786452367344, 'recall': 0.3992648765618016, 'f1-score': 0.4430842989774781, 'support': 521273}, '1': {'precision': 0.4105279543390842, 'recall': 0.4533390631714654, 'f1-score': 0.4308727025187202, 'support': 523575}, '2': {'precision': 0.46026014440145474, 'recall': 0.502490366735586, 'f1-score': 0.4804490593952855, 'support': 528637}, 'accuracy': 0.4519382135832245, 'macro avg': {'precision': 0.4561653210880708, 'recall': 0.4516981021562843, 'f1-score': 0.45146868696382797, 'support': 1573485}, 'weighted avg': {'precision': 0.4561177178764886, 'recall': 0.4519382135832245, 'f1-score': 0.45157418495484314, 'support': 1573485}}
[[208126 176446 136701]
 [111413 237357 174805]
 [ 98630 164372 265635]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.098191
{'0': {'precision': 0.526965014119862, 'recall': 0.20581972486902173, 'f1-score': 0.29602088703813867, 'support': 522224}, '1': {'precision': 0.3593142488972994, 'recall': 0.6835718952421883, 'f1-score': 0.4710334363659906, 'support': 518873}, '2': {'precision': 0.4799147478392761, 'recall': 0.34470536525992324, 'f1-score': 0.40122520860138416, 'support': 532388}, 'accuracy': 0.4103553576932732, 'macro avg': {'precision': 0.45539800361881255, 'recall': 0.41136566179037776, 'f1-score': 0.3894265106685045, 'support': 1573485}, 'weighted avg': {'precision': 0.4557609971334177, 'recall': 0.4103553576932732, 'f1-score': 0.38932892928563617, 'support': 1573485}}
[[107484 327666  87074]
 [ 52382 354687 111804]
 [ 44102 304769 183517]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.14115
{'0': {'precision': 0.5017372409304993, 'recall': 0.08754224305828195, 'f1-score': 0.14907426676258004, 'support': 519612}, '1': {'precision': 0.34315325052657564, 'recall': 0.8349717559809166, 'f1-score': 0.486405552178409, 'support': 519402}, '2': {'precision': 0.49646572114813836, 'recall': 0.20342544310168373, 'f1-score': 0.2885984692137301, 'support': 534471}, 'accuracy': 0.3736286014801539, 'macro avg': {'precision': 0.4471187375350711, 'recall': 0.37531314738029403, 'f1-score': 0.30802609605157305, 'support': 1573485}, 'weighted avg': {'precision': 0.44759861473871676, 'recall': 0.3736286014801539, 'f1-score': 0.30781882696863283, 'support': 1573485}}
[[ 45488 423130  50994]
 [ 26437 433686  59279]
 [ 18736 407010 108725]]
Evaluating performance on  val set...
2174/2174 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0234785
{'0': {'precision': 0.46964050257717915, 'recall': 0.5102016656505448, 'f1-score': 0.4890815570945054, 'support': 168943}, '1': {'precision': 0.5898322964985495, 'recall': 0.35689812163823936, 'f1-score': 0.44470957026224067, 'support': 213058}, '2': {'precision': 0.4399144444626555, 'recall': 0.6152444370583887, 'f1-score': 0.5130126267754536, 'support': 174503}, 'accuracy': 0.4844475511406926, 'macro avg': {'precision': 0.49979574784612807, 'recall': 0.49411474144905765, 'f1-score': 0.48226791804406655, 'support': 556504}, 'weighted avg': {'precision': 0.5063348244690984, 'recall': 0.4844475511406926, 'f1-score': 0.4795977738369292, 'support': 556504}}
[[ 86195  28728  54020]
 [ 54348  76040  82670]
 [ 42991  24150 107362]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.047856
{'0': {'precision': 0.49951681929041464, 'recall': 0.41641092527236456, 'f1-score': 0.4541936023766188, 'support': 182476}, '1': {'precision': 0.45356906807666886, 'recall': 0.45633462930687757, 'f1-score': 0.4549476458684744, 'support': 186475}, '2': {'precision': 0.4674016837734979, 'recall': 0.5402259627945167, 'f1-score': 0.5011822085039869, 'support': 187553}, 'accuracy': 0.47151682647384385, 'macro avg': {'precision': 0.47349585704686054, 'recall': 0.47099050579125296, 'f1-score': 0.47010781891636005, 'support': 556504}, 'weighted avg': {'precision': 0.47329706719665154, 'recall': 0.47151682647384385, 'f1-score': 0.4702823713794473, 'support': 556504}}
[[ 75985  53891  52600]
 [ 38526  85095  62854]
 [ 37606  48626 101321]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0732223
{'0': {'precision': 0.5184598541846218, 'recall': 0.24518886526619593, 'f1-score': 0.33292947423528535, 'support': 181558}, '1': {'precision': 0.3847827624110512, 'recall': 0.63525897154258, 'f1-score': 0.47926804125774886, 'support': 188457}, '2': {'precision': 0.47195125009403915, 'recall': 0.4036699215503327, 'f1-score': 0.43514828163249974, 'support': 186489}, 'accuracy': 0.43039223437747076, 'macro avg': {'precision': 0.4583979555632374, 'recall': 0.4280392527863696, 'f1-score': 0.41578193237517796, 'support': 556504}, 'weighted avg': {'precision': 0.4576054366914493, 'recall': 0.43039223437747076, 'f1-score': 0.41674057082767557, 'support': 556504}}
[[ 44516  99349  37693]
 [ 22203 119719  46535]
 [ 19143  92066  75280]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930854
{'0': {'precision': 0.4948351702663965, 'recall': 0.11369133461272043, 'f1-score': 0.1849006426830169, 'support': 176126}, '1': {'precision': 0.3797365253347493, 'recall': 0.7912776172905642, 'f1-score': 0.5131910914268458, 'support': 199739}, '2': {'precision': 0.4713465757129549, 'recall': 0.2604919203494262, 'f1-score': 0.33554390843940524, 'support': 180639}, 'accuracy': 0.40453976970515937, 'macro avg': {'precision': 0.4486394237713669, 'recall': 0.3884869574175703, 'f1-score': 0.3445452141830893, 'support': 556504}, 'weighted avg': {'precision': 0.44589995242152675, 'recall': 0.40453976970515937, 'f1-score': 0.351628024381283, 'support': 556504}}
[[ 20024 132841  23261]
 [ 12175 158049  29515]
 [  8267 125317  47055]]
training model: results/AAPL/W2/deepOF_L2/seq2seq
Epoch 1/50
6147/6147 - 186s - loss: 12.3264 - accuracy10: 0.4866 - accuracy20: 0.4732 - accuracy30: 0.4573 - accuracy50: 0.4496 - val_loss: 13.2853 - val_accuracy10: 0.4692 - val_accuracy20: 0.4160 - val_accuracy30: 0.3769 - val_accuracy50: 0.3692 - 186s/epoch - 30ms/step
Epoch 2/50
6147/6147 - 184s - loss: 12.1427 - accuracy10: 0.5061 - accuracy20: 0.4894 - accuracy30: 0.4698 - accuracy50: 0.4584 - val_loss: 13.2675 - val_accuracy10: 0.4752 - val_accuracy20: 0.4225 - val_accuracy30: 0.3805 - val_accuracy50: 0.3703 - 184s/epoch - 30ms/step
Epoch 3/50
6147/6147 - 182s - loss: 12.0746 - accuracy10: 0.5121 - accuracy20: 0.4943 - accuracy30: 0.4744 - accuracy50: 0.4627 - val_loss: 13.1641 - val_accuracy10: 0.4800 - val_accuracy20: 0.4284 - val_accuracy30: 0.3835 - val_accuracy50: 0.3711 - 182s/epoch - 30ms/step
Epoch 4/50
6147/6147 - 175s - loss: 12.0288 - accuracy10: 0.5162 - accuracy20: 0.4977 - accuracy30: 0.4773 - accuracy50: 0.4651 - val_loss: 13.1110 - val_accuracy10: 0.4849 - val_accuracy20: 0.4300 - val_accuracy30: 0.3838 - val_accuracy50: 0.3706 - 175s/epoch - 29ms/step
Epoch 5/50
6147/6147 - 177s - loss: 11.9951 - accuracy10: 0.5194 - accuracy20: 0.5003 - accuracy30: 0.4798 - accuracy50: 0.4674 - val_loss: 13.0338 - val_accuracy10: 0.4895 - val_accuracy20: 0.4338 - val_accuracy30: 0.3858 - val_accuracy50: 0.3718 - 177s/epoch - 29ms/step
Epoch 6/50
6147/6147 - 180s - loss: 11.9696 - accuracy10: 0.5215 - accuracy20: 0.5022 - accuracy30: 0.4812 - accuracy50: 0.4688 - val_loss: 13.0807 - val_accuracy10: 0.4878 - val_accuracy20: 0.4366 - val_accuracy30: 0.3887 - val_accuracy50: 0.3728 - 180s/epoch - 29ms/step
Epoch 7/50
6147/6147 - 178s - loss: 11.9487 - accuracy10: 0.5232 - accuracy20: 0.5036 - accuracy30: 0.4825 - accuracy50: 0.4698 - val_loss: 13.1008 - val_accuracy10: 0.4888 - val_accuracy20: 0.4367 - val_accuracy30: 0.3896 - val_accuracy50: 0.3726 - 178s/epoch - 29ms/step
Epoch 8/50
6147/6147 - 178s - loss: 11.9313 - accuracy10: 0.5247 - accuracy20: 0.5046 - accuracy30: 0.4840 - accuracy50: 0.4709 - val_loss: 13.0692 - val_accuracy10: 0.4926 - val_accuracy20: 0.4428 - val_accuracy30: 0.3944 - val_accuracy50: 0.3753 - 178s/epoch - 29ms/step
Epoch 9/50
6147/6147 - 178s - loss: 11.9147 - accuracy10: 0.5260 - accuracy20: 0.5061 - accuracy30: 0.4848 - accuracy50: 0.4718 - val_loss: 13.0343 - val_accuracy10: 0.4937 - val_accuracy20: 0.4446 - val_accuracy30: 0.3941 - val_accuracy50: 0.3742 - 178s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 180s - loss: 11.9001 - accuracy10: 0.5273 - accuracy20: 0.5070 - accuracy30: 0.4857 - accuracy50: 0.4729 - val_loss: 13.0480 - val_accuracy10: 0.4947 - val_accuracy20: 0.4460 - val_accuracy30: 0.3960 - val_accuracy50: 0.3752 - 180s/epoch - 29ms/step
Epoch 11/50
6147/6147 - 180s - loss: 11.8864 - accuracy10: 0.5287 - accuracy20: 0.5082 - accuracy30: 0.4868 - accuracy50: 0.4736 - val_loss: 13.1137 - val_accuracy10: 0.4939 - val_accuracy20: 0.4451 - val_accuracy30: 0.3954 - val_accuracy50: 0.3752 - 180s/epoch - 29ms/step
Epoch 12/50
6147/6147 - 195s - loss: 11.8746 - accuracy10: 0.5291 - accuracy20: 0.5089 - accuracy30: 0.4876 - accuracy50: 0.4744 - val_loss: 13.0923 - val_accuracy10: 0.4928 - val_accuracy20: 0.4478 - val_accuracy30: 0.3986 - val_accuracy50: 0.3759 - 195s/epoch - 32ms/step
Epoch 13/50
6147/6147 - 181s - loss: 11.8633 - accuracy10: 0.5301 - accuracy20: 0.5098 - accuracy30: 0.4886 - accuracy50: 0.4750 - val_loss: 13.1142 - val_accuracy10: 0.4950 - val_accuracy20: 0.4502 - val_accuracy30: 0.3988 - val_accuracy50: 0.3755 - 181s/epoch - 30ms/step
Epoch 14/50
6147/6147 - 185s - loss: 11.8537 - accuracy10: 0.5309 - accuracy20: 0.5106 - accuracy30: 0.4892 - accuracy50: 0.4755 - val_loss: 13.2327 - val_accuracy10: 0.4916 - val_accuracy20: 0.4480 - val_accuracy30: 0.4000 - val_accuracy50: 0.3769 - 185s/epoch - 30ms/step
Epoch 15/50
6147/6147 - 181s - loss: 11.8423 - accuracy10: 0.5318 - accuracy20: 0.5117 - accuracy30: 0.4899 - accuracy50: 0.4763 - val_loss: 13.1449 - val_accuracy10: 0.4935 - val_accuracy20: 0.4519 - val_accuracy30: 0.4035 - val_accuracy50: 0.3782 - 181s/epoch - 30ms/step
testing model: results/AAPL/W2/deepOF_L2/seq2seq
Evaluating performance on  test set...
14883/14883 - 146s - 146s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0143276
{'0': {'precision': 0.45465918044849546, 'recall': 0.4654435790121502, 'f1-score': 0.4599881785002516, 'support': 1124422}, '1': {'precision': 0.4991508004859604, 'recall': 0.5864002009077665, 'f1-score': 0.5392692361988384, 'support': 1521096}, '2': {'precision': 0.4956482042247059, 'recall': 0.37111551595017417, 'f1-score': 0.42443571358412724, 'support': 1164376}, 'accuracy': 0.484906929169158, 'macro avg': {'precision': 0.48315272838638723, 'recall': 0.47431976529003034, 'f1-score': 0.47456437609440577, 'support': 3809894}, 'weighted avg': {'precision': 0.48494943545846597, 'recall': 0.484906929169158, 'f1-score': 0.48077554498654024, 'support': 3809894}}
[[523355 441611 159456]
 [348875 891971 280250]
 [278863 453395 432118]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0665902
{'0': {'precision': 0.4875414191250529, 'recall': 0.33225538236310836, 'f1-score': 0.39519124820978263, 'support': 1206301}, '1': {'precision': 0.39624401129489856, 'recall': 0.7016548932543124, 'f1-score': 0.5064702192447095, 'support': 1350359}, '2': {'precision': 0.5189979920957626, 'recall': 0.2470855402901613, 'f1-score': 0.33478568293226146, 'support': 1253234}, 'accuracy': 0.43516748759939256, 'macro avg': {'precision': 0.4675944741719047, 'recall': 0.42699860530252737, 'f1-score': 0.41214905012891784, 'support': 3809894}, 'weighted avg': {'precision': 0.465529827839378, 'recall': 0.43516748759939256, 'f1-score': 0.4147624624883804, 'support': 3809894}}
[[400800 696479 109022]
 [224909 947486 177964]
 [196375 747203 309656]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869966
{'0': {'precision': 0.5267278252453454, 'recall': 0.17214152522845094, 'f1-score': 0.25948120677070213, 'support': 1176073}, '1': {'precision': 0.38097658474074686, 'recall': 0.8436335133996076, 'f1-score': 0.5249093000227456, 'support': 1404668}, '2': {'precision': 0.5220079671158089, 'recall': 0.1337961994967266, 'f1-score': 0.21299859214945233, 'support': 1229153}, 'accuracy': 0.40734256648610173, 'macro avg': {'precision': 0.4765707923673004, 'recall': 0.3831904127082617, 'f1-score': 0.33246303298096674, 'support': 3809894}, 'weighted avg': {'precision': 0.4714681431448441, 'recall': 0.40734256648610173, 'f1-score': 0.34234548165147527, 'support': 3809894}}
[[ 202451  927721   45901]
 [ 114955 1185025  104688]
 [  66950  997747  164456]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0324744
{'0': {'precision': 0.47068828727000034, 'recall': 0.08934450917612886, 'f1-score': 0.15018196887023252, 'support': 969472}, '1': {'precision': 0.4902960307441745, 'recall': 0.9155591539797955, 'f1-score': 0.6386077655586206, 'support': 1855133}, '2': {'precision': 0.4345553624335843, 'recall': 0.07130395244440971, 'f1-score': 0.12250645183790193, 'support': 985289}, 'accuracy': 0.4869836273660107, 'macro avg': {'precision': 0.46517989348258637, 'recall': 0.35873587186677797, 'f1-score': 0.30376539542225167, 'support': 3809894}, 'weighted avg': {'precision': 0.47089133716989984, 'recall': 0.4869836273660107, 'f1-score': 0.3808514916933482, 'support': 3809894}}
[[  86617  866736   16119]
 [  81352 1698484   75297]
 [  16053  898981   70255]]
Evaluating performance on  train set...
6147/6147 - 63s - 63s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0359548
{'0': {'precision': 0.45005861525891366, 'recall': 0.47045547381407227, 'f1-score': 0.4600310665510076, 'support': 484726}, '1': {'precision': 0.4816372020451094, 'recall': 0.5786253205063834, 'f1-score': 0.5256952395723568, 'support': 597492}, '2': {'precision': 0.48968562578264024, 'recall': 0.34785706288866497, 'f1-score': 0.406762797473115, 'support': 491265}, 'accuracy': 0.47325328586327275, 'macro avg': {'precision': 0.4737938143622211, 'recall': 0.46564595240304024, 'f1-score': 0.46416303453215974, 'support': 1573483}, 'weighted avg': {'precision': 0.4744219647841365, 'recall': 0.47325328586327275, 'f1-score': 0.4683342905822307, 'support': 1573483}}
[[228042 185667  71017]
 [144696 345724 107072]
 [133956 186419 170890]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901887
{'0': {'precision': 0.4840905559008969, 'recall': 0.3347231922879138, 'f1-score': 0.3957831352636618, 'support': 521156}, '1': {'precision': 0.37575436556026387, 'recall': 0.7058350584766284, 'f1-score': 0.490427511020172, 'support': 523628}, '2': {'precision': 0.5114563682071078, 'recall': 0.22203749203232842, 'f1-score': 0.3096480977866641, 'support': 528699}, 'accuracy': 0.42035980051897603, 'macro avg': {'precision': 0.45710042988942284, 'recall': 0.42086524759895694, 'f1-score': 0.3986195813568327, 'support': 1573483}, 'weighted avg': {'precision': 0.45723320499516507, 'recall': 0.42035980051897603, 'f1-score': 0.39833730140945345, 'support': 1573483}}
[[174443 298221  48492]
 [ 90393 369595  63640]
 [ 95516 315792 117391]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1237745
{'0': {'precision': 0.539615229283695, 'recall': 0.16884815250232638, 'f1-score': 0.25721310901624045, 'support': 522274}, '1': {'precision': 0.3420990467132807, 'recall': 0.8573993470115073, 'f1-score': 0.4890635965828964, 'support': 518539}, '2': {'precision': 0.5290533444392134, 'recall': 0.10970206694576379, 'f1-score': 0.1817229079397066, 'support': 532670}, 'accuracy': 0.37573650303180905, 'macro avg': {'precision': 0.47025587347872966, 'recall': 0.3786498554865325, 'f1-score': 0.3093332045129478, 'support': 1573483}, 'weighted avg': {'precision': 0.4709485560536759, 'recall': 0.37573650303180905, 'f1-score': 0.3080634547555265, 'support': 1573483}}
[[ 88185 414563  19526]
 [ 41453 444595  32491]
 [ 33784 440451  58435]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1564883
{'0': {'precision': 0.5815629098202577, 'recall': 0.07255138591355195, 'f1-score': 0.12900863160632758, 'support': 519549}, '1': {'precision': 0.33208958804249933, 'recall': 0.9332673313096137, 'f1-score': 0.4898671020771303, 'support': 519176}, '2': {'precision': 0.5332231937784583, 'recall': 0.0494915457085261, 'f1-score': 0.09057618858574382, 'support': 534758}, 'accuracy': 0.3487104722453309, 'macro avg': {'precision': 0.48229189721373844, 'recall': 0.3517700876438972, 'f1-score': 0.23648397408973387, 'support': 1573483}, 'weighted avg': {'precision': 0.48281979586327817, 'recall': 0.3487104722453309, 'f1-score': 0.2350135906051526, 'support': 1573483}}
[[ 37694 474961   6894]
 [ 18372 484530  16274]
 [  8749 499543  26466]]
Evaluating performance on  val set...
2174/2174 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0188873
{'0': {'precision': 0.45487108859152453, 'recall': 0.4755829456904981, 'f1-score': 0.4649964947247055, 'support': 168755}, '1': {'precision': 0.5151528527974188, 'recall': 0.6026759935212789, 'f1-score': 0.5554880040848207, 'support': 213005}, '2': {'precision': 0.48746848017116223, 'recall': 0.36507900173397506, 'f1-score': 0.41748878483572366, 'support': 174743}, 'accuracy': 0.4895301552731971, 'macro avg': {'precision': 0.48583080718670185, 'recall': 0.48111264698191736, 'f1-score': 0.47932442788174995, 'support': 556503}, 'weighted avg': {'precision': 0.48817995338017284, 'recall': 0.4895301552731971, 'f1-score': 0.4847151740527971, 'support': 556503}}
[[ 80257  59369  29129]
 [ 46686 128373  37946]
 [ 49496  61452  63795]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0748793
{'0': {'precision': 0.4895325872284398, 'recall': 0.34669899291309214, 'f1-score': 0.4059173535673345, 'support': 182308}, '1': {'precision': 0.3937028155253575, 'recall': 0.7127826077634725, 'f1-score': 0.507235818253944, 'support': 186566}, '2': {'precision': 0.5045526568323327, 'recall': 0.24099153115989533, 'f1-score': 0.32618567558891526, 'support': 187629}, 'accuracy': 0.43378741893574696, 'macro avg': {'precision': 0.46259601986204335, 'recall': 0.43349104394548665, 'f1-score': 0.4131129491367313, 'support': 556503}, 'weighted avg': {'precision': 0.46247006187305373, 'recall': 0.43378741893574696, 'f1-score': 0.4130019616921949, 'support': 556503}}
[[ 63206  98353  20749]
 [ 29933 132981  23652]
 [ 35976 106436  45217]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1096644
{'0': {'precision': 0.5332988641859999, 'recall': 0.17625334178540913, 'f1-score': 0.26494373829607415, 'support': 181415}, '1': {'precision': 0.3536645548516172, 'recall': 0.8448173322005098, 'f1-score': 0.49860068633749627, 'support': 188320}, '2': {'precision': 0.5090157615213294, 'recall': 0.12726484194294527, 'f1-score': 0.20362025836959874, 'support': 186768}, 'accuracy': 0.38605362414937566, 'macro avg': {'precision': 0.46532639351964883, 'recall': 0.3827785053096214, 'f1-score': 0.32238822766772307, 'support': 556503}, 'weighted avg': {'precision': 0.4643611591739405, 'recall': 0.38605362414937566, 'f1-score': 0.3234322150091425, 'support': 556503}}
[[ 31975 140454   8986]
 [ 15283 159096  13941]
 [ 12699 150300  23769]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1315713
{'0': {'precision': 0.5313385198483942, 'recall': 0.07555711886715381, 'f1-score': 0.13230086078011613, 'support': 176264}, '1': {'precision': 0.3581882300646499, 'recall': 0.9127606255012028, 'f1-score': 0.5144819344841662, 'support': 199520}, '2': {'precision': 0.49845699135045857, 'recall': 0.06345763312103321, 'f1-score': 0.11258258641508695, 'support': 180719}, 'accuracy': 0.37178595623024496, 'macro avg': {'precision': 0.46266124708783424, 'recall': 0.3505917924964633, 'f1-score': 0.2531217938931231, 'support': 556503}, 'weighted avg': {'precision': 0.45858192596431613, 'recall': 0.37178595623024496, 'f1-score': 0.2629188466678083, 'support': 556503}}
[[ 13318 159856   3090]
 [  8957 182114   8449]
 [  2790 166461  11468]]
training model: results/AAPL/W2/deepVOL_L2/seq2seq
Epoch 1/50
6147/6147 - 182s - loss: 12.5245 - accuracy10: 0.4576 - accuracy20: 0.4519 - accuracy30: 0.4424 - accuracy50: 0.4412 - val_loss: 13.3304 - val_accuracy10: 0.4368 - val_accuracy20: 0.4003 - val_accuracy30: 0.3810 - val_accuracy50: 0.3766 - 182s/epoch - 30ms/step
Epoch 2/50
6147/6147 - 176s - loss: 12.3028 - accuracy10: 0.4862 - accuracy20: 0.4765 - accuracy30: 0.4616 - accuracy50: 0.4532 - val_loss: 12.8975 - val_accuracy10: 0.4752 - val_accuracy20: 0.4174 - val_accuracy30: 0.3885 - val_accuracy50: 0.3803 - 176s/epoch - 29ms/step
Epoch 3/50
6147/6147 - 178s - loss: 12.2041 - accuracy10: 0.4973 - accuracy20: 0.4856 - accuracy30: 0.4683 - accuracy50: 0.4577 - val_loss: 12.8601 - val_accuracy10: 0.4847 - val_accuracy20: 0.4197 - val_accuracy30: 0.3848 - val_accuracy50: 0.3765 - 178s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 175s - loss: 12.1430 - accuracy10: 0.5039 - accuracy20: 0.4903 - accuracy30: 0.4720 - accuracy50: 0.4601 - val_loss: 12.8140 - val_accuracy10: 0.4948 - val_accuracy20: 0.4314 - val_accuracy30: 0.3921 - val_accuracy50: 0.3808 - 175s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 174s - loss: 12.0914 - accuracy10: 0.5084 - accuracy20: 0.4941 - accuracy30: 0.4751 - accuracy50: 0.4628 - val_loss: 12.7887 - val_accuracy10: 0.4989 - val_accuracy20: 0.4315 - val_accuracy30: 0.3834 - val_accuracy50: 0.3757 - 174s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 179s - loss: 12.0511 - accuracy10: 0.5124 - accuracy20: 0.4975 - accuracy30: 0.4777 - accuracy50: 0.4651 - val_loss: 12.8836 - val_accuracy10: 0.4934 - val_accuracy20: 0.4300 - val_accuracy30: 0.3819 - val_accuracy50: 0.3748 - 179s/epoch - 29ms/step
Epoch 7/50
6147/6147 - 174s - loss: 12.0164 - accuracy10: 0.5157 - accuracy20: 0.4998 - accuracy30: 0.4798 - accuracy50: 0.4665 - val_loss: 12.7974 - val_accuracy10: 0.5088 - val_accuracy20: 0.4438 - val_accuracy30: 0.3851 - val_accuracy50: 0.3755 - 174s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 175s - loss: 11.9907 - accuracy10: 0.5180 - accuracy20: 0.5016 - accuracy30: 0.4812 - accuracy50: 0.4681 - val_loss: 12.7987 - val_accuracy10: 0.5053 - val_accuracy20: 0.4467 - val_accuracy30: 0.3840 - val_accuracy50: 0.3742 - 175s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 176s - loss: 11.9607 - accuracy10: 0.5206 - accuracy20: 0.5039 - accuracy30: 0.4831 - accuracy50: 0.4695 - val_loss: 12.7340 - val_accuracy10: 0.5072 - val_accuracy20: 0.4567 - val_accuracy30: 0.3876 - val_accuracy50: 0.3736 - 176s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 172s - loss: 11.9400 - accuracy10: 0.5228 - accuracy20: 0.5054 - accuracy30: 0.4845 - accuracy50: 0.4707 - val_loss: 12.7565 - val_accuracy10: 0.5107 - val_accuracy20: 0.4606 - val_accuracy30: 0.3888 - val_accuracy50: 0.3738 - 172s/epoch - 28ms/step
Epoch 11/50
6147/6147 - 173s - loss: 11.9217 - accuracy10: 0.5241 - accuracy20: 0.5068 - accuracy30: 0.4856 - accuracy50: 0.4716 - val_loss: 12.6965 - val_accuracy10: 0.5055 - val_accuracy20: 0.4639 - val_accuracy30: 0.3924 - val_accuracy50: 0.3735 - 173s/epoch - 28ms/step
Epoch 12/50
6147/6147 - 173s - loss: 11.9061 - accuracy10: 0.5258 - accuracy20: 0.5079 - accuracy30: 0.4864 - accuracy50: 0.4724 - val_loss: 12.7105 - val_accuracy10: 0.5075 - val_accuracy20: 0.4685 - val_accuracy30: 0.3972 - val_accuracy50: 0.3746 - 173s/epoch - 28ms/step
Epoch 13/50
6147/6147 - 174s - loss: 11.8919 - accuracy10: 0.5267 - accuracy20: 0.5090 - accuracy30: 0.4874 - accuracy50: 0.4730 - val_loss: 12.6736 - val_accuracy10: 0.5052 - val_accuracy20: 0.4682 - val_accuracy30: 0.4004 - val_accuracy50: 0.3750 - 174s/epoch - 28ms/step
Epoch 14/50
6147/6147 - 179s - loss: 11.8788 - accuracy10: 0.5279 - accuracy20: 0.5096 - accuracy30: 0.4880 - accuracy50: 0.4739 - val_loss: 12.6810 - val_accuracy10: 0.5099 - val_accuracy20: 0.4700 - val_accuracy30: 0.4024 - val_accuracy50: 0.3763 - 179s/epoch - 29ms/step
Epoch 15/50
6147/6147 - 178s - loss: 11.8674 - accuracy10: 0.5287 - accuracy20: 0.5102 - accuracy30: 0.4888 - accuracy50: 0.4745 - val_loss: 12.7011 - val_accuracy10: 0.5090 - val_accuracy20: 0.4718 - val_accuracy30: 0.4030 - val_accuracy50: 0.3750 - 178s/epoch - 29ms/step
Epoch 16/50
6147/6147 - 180s - loss: 11.8534 - accuracy10: 0.5298 - accuracy20: 0.5114 - accuracy30: 0.4899 - accuracy50: 0.4755 - val_loss: 12.6439 - val_accuracy10: 0.5091 - val_accuracy20: 0.4726 - val_accuracy30: 0.4086 - val_accuracy50: 0.3768 - 180s/epoch - 29ms/step
Epoch 17/50
6147/6147 - 185s - loss: 11.8432 - accuracy10: 0.5308 - accuracy20: 0.5123 - accuracy30: 0.4906 - accuracy50: 0.4761 - val_loss: 12.6514 - val_accuracy10: 0.5116 - val_accuracy20: 0.4755 - val_accuracy30: 0.4087 - val_accuracy50: 0.3760 - 185s/epoch - 30ms/step
Epoch 18/50
6147/6147 - 180s - loss: 11.8354 - accuracy10: 0.5313 - accuracy20: 0.5124 - accuracy30: 0.4911 - accuracy50: 0.4769 - val_loss: 12.7149 - val_accuracy10: 0.5073 - val_accuracy20: 0.4711 - val_accuracy30: 0.4061 - val_accuracy50: 0.3748 - 180s/epoch - 29ms/step
Epoch 19/50
6147/6147 - 179s - loss: 11.8254 - accuracy10: 0.5321 - accuracy20: 0.5136 - accuracy30: 0.4920 - accuracy50: 0.4770 - val_loss: 12.6348 - val_accuracy10: 0.5110 - val_accuracy20: 0.4778 - val_accuracy30: 0.4143 - val_accuracy50: 0.3757 - 179s/epoch - 29ms/step
Epoch 20/50
6147/6147 - 179s - loss: 11.8181 - accuracy10: 0.5326 - accuracy20: 0.5140 - accuracy30: 0.4926 - accuracy50: 0.4776 - val_loss: 12.5925 - val_accuracy10: 0.5119 - val_accuracy20: 0.4807 - val_accuracy30: 0.4200 - val_accuracy50: 0.3769 - 179s/epoch - 29ms/step
Epoch 21/50
6147/6147 - 179s - loss: 11.8085 - accuracy10: 0.5334 - accuracy20: 0.5146 - accuracy30: 0.4931 - accuracy50: 0.4784 - val_loss: 12.5991 - val_accuracy10: 0.5117 - val_accuracy20: 0.4800 - val_accuracy30: 0.4198 - val_accuracy50: 0.3775 - 179s/epoch - 29ms/step
Epoch 22/50
6147/6147 - 182s - loss: 11.8035 - accuracy10: 0.5339 - accuracy20: 0.5152 - accuracy30: 0.4934 - accuracy50: 0.4783 - val_loss: 12.5626 - val_accuracy10: 0.5162 - val_accuracy20: 0.4836 - val_accuracy30: 0.4227 - val_accuracy50: 0.3776 - 182s/epoch - 30ms/step
Epoch 23/50
6147/6147 - 183s - loss: 11.7950 - accuracy10: 0.5343 - accuracy20: 0.5156 - accuracy30: 0.4940 - accuracy50: 0.4790 - val_loss: 12.6242 - val_accuracy10: 0.5117 - val_accuracy20: 0.4829 - val_accuracy30: 0.4238 - val_accuracy50: 0.3777 - 183s/epoch - 30ms/step
Epoch 24/50
6147/6147 - 182s - loss: 11.7870 - accuracy10: 0.5351 - accuracy20: 0.5159 - accuracy30: 0.4943 - accuracy50: 0.4796 - val_loss: 12.5363 - val_accuracy10: 0.5158 - val_accuracy20: 0.4863 - val_accuracy30: 0.4292 - val_accuracy50: 0.3800 - 182s/epoch - 30ms/step
Epoch 25/50
6147/6147 - 176s - loss: 11.7799 - accuracy10: 0.5357 - accuracy20: 0.5164 - accuracy30: 0.4950 - accuracy50: 0.4800 - val_loss: 12.5535 - val_accuracy10: 0.5129 - val_accuracy20: 0.4841 - val_accuracy30: 0.4269 - val_accuracy50: 0.3796 - 176s/epoch - 29ms/step
Epoch 26/50
6147/6147 - 180s - loss: 11.7749 - accuracy10: 0.5356 - accuracy20: 0.5168 - accuracy30: 0.4950 - accuracy50: 0.4802 - val_loss: 12.5154 - val_accuracy10: 0.5184 - val_accuracy20: 0.4884 - val_accuracy30: 0.4310 - val_accuracy50: 0.3797 - 180s/epoch - 29ms/step
Epoch 27/50
6147/6147 - 177s - loss: 11.7679 - accuracy10: 0.5361 - accuracy20: 0.5173 - accuracy30: 0.4960 - accuracy50: 0.4807 - val_loss: 12.5616 - val_accuracy10: 0.5181 - val_accuracy20: 0.4898 - val_accuracy30: 0.4294 - val_accuracy50: 0.3788 - 177s/epoch - 29ms/step
Epoch 28/50
6147/6147 - 178s - loss: 11.7619 - accuracy10: 0.5366 - accuracy20: 0.5179 - accuracy30: 0.4965 - accuracy50: 0.4812 - val_loss: 12.5441 - val_accuracy10: 0.5182 - val_accuracy20: 0.4886 - val_accuracy30: 0.4326 - val_accuracy50: 0.3798 - 178s/epoch - 29ms/step
Epoch 29/50
6147/6147 - 179s - loss: 11.7557 - accuracy10: 0.5369 - accuracy20: 0.5184 - accuracy30: 0.4966 - accuracy50: 0.4818 - val_loss: 12.6264 - val_accuracy10: 0.5132 - val_accuracy20: 0.4844 - val_accuracy30: 0.4282 - val_accuracy50: 0.3779 - 179s/epoch - 29ms/step
Epoch 30/50
6147/6147 - 178s - loss: 11.7488 - accuracy10: 0.5371 - accuracy20: 0.5188 - accuracy30: 0.4975 - accuracy50: 0.4823 - val_loss: 12.5561 - val_accuracy10: 0.5169 - val_accuracy20: 0.4854 - val_accuracy30: 0.4327 - val_accuracy50: 0.3797 - 178s/epoch - 29ms/step
Epoch 31/50
6147/6147 - 179s - loss: 11.7441 - accuracy10: 0.5374 - accuracy20: 0.5189 - accuracy30: 0.4976 - accuracy50: 0.4826 - val_loss: 12.5559 - val_accuracy10: 0.5171 - val_accuracy20: 0.4879 - val_accuracy30: 0.4340 - val_accuracy50: 0.3792 - 179s/epoch - 29ms/step
Epoch 32/50
6147/6147 - 179s - loss: 11.7382 - accuracy10: 0.5379 - accuracy20: 0.5194 - accuracy30: 0.4982 - accuracy50: 0.4829 - val_loss: 12.5043 - val_accuracy10: 0.5230 - val_accuracy20: 0.4923 - val_accuracy30: 0.4382 - val_accuracy50: 0.3834 - 179s/epoch - 29ms/step
Epoch 33/50
6147/6147 - 179s - loss: 11.7335 - accuracy10: 0.5381 - accuracy20: 0.5200 - accuracy30: 0.4988 - accuracy50: 0.4835 - val_loss: 12.5027 - val_accuracy10: 0.5204 - val_accuracy20: 0.4915 - val_accuracy30: 0.4383 - val_accuracy50: 0.3836 - 179s/epoch - 29ms/step
Epoch 34/50
6147/6147 - 180s - loss: 11.7290 - accuracy10: 0.5381 - accuracy20: 0.5202 - accuracy30: 0.4993 - accuracy50: 0.4836 - val_loss: 12.5498 - val_accuracy10: 0.5158 - val_accuracy20: 0.4868 - val_accuracy30: 0.4355 - val_accuracy50: 0.3819 - 180s/epoch - 29ms/step
Epoch 35/50
6147/6147 - 174s - loss: 11.7228 - accuracy10: 0.5388 - accuracy20: 0.5207 - accuracy30: 0.4994 - accuracy50: 0.4842 - val_loss: 12.5363 - val_accuracy10: 0.5171 - val_accuracy20: 0.4892 - val_accuracy30: 0.4379 - val_accuracy50: 0.3825 - 174s/epoch - 28ms/step
Epoch 36/50
6147/6147 - 178s - loss: 11.7169 - accuracy10: 0.5392 - accuracy20: 0.5211 - accuracy30: 0.4999 - accuracy50: 0.4846 - val_loss: 12.4901 - val_accuracy10: 0.5175 - val_accuracy20: 0.4892 - val_accuracy30: 0.4393 - val_accuracy50: 0.3841 - 178s/epoch - 29ms/step
Epoch 37/50
6147/6147 - 175s - loss: 11.7124 - accuracy10: 0.5395 - accuracy20: 0.5216 - accuracy30: 0.5006 - accuracy50: 0.4851 - val_loss: 12.6037 - val_accuracy10: 0.5150 - val_accuracy20: 0.4875 - val_accuracy30: 0.4356 - val_accuracy50: 0.3812 - 175s/epoch - 28ms/step
Epoch 38/50
6147/6147 - 177s - loss: 11.7087 - accuracy10: 0.5397 - accuracy20: 0.5218 - accuracy30: 0.5009 - accuracy50: 0.4856 - val_loss: 12.4562 - val_accuracy10: 0.5200 - val_accuracy20: 0.4910 - val_accuracy30: 0.4423 - val_accuracy50: 0.3878 - 177s/epoch - 29ms/step
Epoch 39/50
6147/6147 - 176s - loss: 11.7012 - accuracy10: 0.5397 - accuracy20: 0.5222 - accuracy30: 0.5013 - accuracy50: 0.4864 - val_loss: 12.6106 - val_accuracy10: 0.5131 - val_accuracy20: 0.4859 - val_accuracy30: 0.4375 - val_accuracy50: 0.3830 - 176s/epoch - 29ms/step
Epoch 40/50
6147/6147 - 176s - loss: 11.6981 - accuracy10: 0.5401 - accuracy20: 0.5226 - accuracy30: 0.5017 - accuracy50: 0.4864 - val_loss: 12.4961 - val_accuracy10: 0.5180 - val_accuracy20: 0.4900 - val_accuracy30: 0.4437 - val_accuracy50: 0.3875 - 176s/epoch - 29ms/step
Epoch 41/50
6147/6147 - 175s - loss: 11.6938 - accuracy10: 0.5404 - accuracy20: 0.5228 - accuracy30: 0.5020 - accuracy50: 0.4870 - val_loss: 12.4836 - val_accuracy10: 0.5200 - val_accuracy20: 0.4923 - val_accuracy30: 0.4447 - val_accuracy50: 0.3887 - 175s/epoch - 28ms/step
Epoch 42/50
6147/6147 - 174s - loss: 11.6889 - accuracy10: 0.5409 - accuracy20: 0.5231 - accuracy30: 0.5025 - accuracy50: 0.4876 - val_loss: 12.4986 - val_accuracy10: 0.5154 - val_accuracy20: 0.4890 - val_accuracy30: 0.4434 - val_accuracy50: 0.3902 - 174s/epoch - 28ms/step
Epoch 43/50
6147/6147 - 174s - loss: 11.6838 - accuracy10: 0.5410 - accuracy20: 0.5238 - accuracy30: 0.5033 - accuracy50: 0.4881 - val_loss: 12.5213 - val_accuracy10: 0.5174 - val_accuracy20: 0.4898 - val_accuracy30: 0.4446 - val_accuracy50: 0.3903 - 174s/epoch - 28ms/step
Epoch 44/50
6147/6147 - 173s - loss: 11.6788 - accuracy10: 0.5416 - accuracy20: 0.5242 - accuracy30: 0.5034 - accuracy50: 0.4884 - val_loss: 12.5006 - val_accuracy10: 0.5173 - val_accuracy20: 0.4902 - val_accuracy30: 0.4463 - val_accuracy50: 0.3933 - 173s/epoch - 28ms/step
Epoch 45/50
6147/6147 - 171s - loss: 11.6759 - accuracy10: 0.5414 - accuracy20: 0.5244 - accuracy30: 0.5040 - accuracy50: 0.4886 - val_loss: 12.5348 - val_accuracy10: 0.5158 - val_accuracy20: 0.4895 - val_accuracy30: 0.4415 - val_accuracy50: 0.3882 - 171s/epoch - 28ms/step
Epoch 46/50
6147/6147 - 173s - loss: 11.6707 - accuracy10: 0.5415 - accuracy20: 0.5241 - accuracy30: 0.5040 - accuracy50: 0.4892 - val_loss: 12.5165 - val_accuracy10: 0.5195 - val_accuracy20: 0.4909 - val_accuracy30: 0.4432 - val_accuracy50: 0.3895 - 173s/epoch - 28ms/step
Epoch 47/50
6147/6147 - 175s - loss: 11.6663 - accuracy10: 0.5423 - accuracy20: 0.5250 - accuracy30: 0.5047 - accuracy50: 0.4896 - val_loss: 12.5639 - val_accuracy10: 0.5142 - val_accuracy20: 0.4877 - val_accuracy30: 0.4424 - val_accuracy50: 0.3903 - 175s/epoch - 28ms/step
Epoch 48/50
6147/6147 - 173s - loss: 11.6607 - accuracy10: 0.5421 - accuracy20: 0.5251 - accuracy30: 0.5048 - accuracy50: 0.4898 - val_loss: 12.4861 - val_accuracy10: 0.5177 - val_accuracy20: 0.4902 - val_accuracy30: 0.4461 - val_accuracy50: 0.3935 - 173s/epoch - 28ms/step
testing model: results/AAPL/W2/deepVOL_L2/seq2seq
Evaluating performance on  test set...
14883/14883 - 138s - 138s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9757446
{'0': {'precision': 0.4784176570351462, 'recall': 0.5403851216267174, 'f1-score': 0.5075168407468814, 'support': 1124424}, '1': {'precision': 0.5640346288329079, 'recall': 0.49334230055170747, 'f1-score': 0.5263253503009593, 'support': 1521096}, '2': {'precision': 0.48689370843431473, 'recall': 0.5057116282584966, 'f1-score': 0.4961242922620652, 'support': 1164379}, 'accuracy': 0.5110064597512952, 'macro avg': {'precision': 0.5097819981007896, 'recall': 0.5131463501456405, 'f1-score': 0.5099888277699686, 'support': 3809899}, 'weighted avg': {'precision': 0.5151905398821195, 'recall': 0.5110064597512952, 'f1-score': 0.5115443240046968, 'support': 3809899}}
[[607622 268536 248266]
 [398400 750421 372275]
 [264044 311495 588840]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0124626
{'0': {'precision': 0.4879527583392575, 'recall': 0.48422202731985853, 'f1-score': 0.4860802344696908, 'support': 1206302}, '1': {'precision': 0.4687206052180824, 'recall': 0.4926352972540656, 'f1-score': 0.48038050026411594, 'support': 1350360}, '2': {'precision': 0.4909585836692324, 'recall': 0.4675811518491714, 'f1-score': 0.47898479646885733, 'support': 1253237}, 'accuracy': 0.48173009310745507, 'macro avg': {'precision': 0.4825439824088574, 'recall': 0.48147949214103186, 'f1-score': 0.4818151770675547, 'support': 3809899}, 'weighted avg': {'precision': 0.4821249611274028, 'recall': 0.48173009310745507, 'f1-score': 0.4817260616909136, 'support': 3809899}}
[[584118 354108 268076]
 [345628 665235 339497]
 [267333 399914 585990]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0426574
{'0': {'precision': 0.49273682174506006, 'recall': 0.3400746891777218, 'f1-score': 0.4024135576985478, 'support': 1176074}, '1': {'precision': 0.4173141899801072, 'recall': 0.6662316887466015, 'f1-score': 0.5131816621462892, 'support': 1404669}, '2': {'precision': 0.48988927897015017, 'recall': 0.3011830882329013, 'f1-score': 0.37302874439690065, 'support': 1229156}, 'accuracy': 0.4477780119630468, 'macro avg': {'precision': 0.46664676356510576, 'recall': 0.4358298220524082, 'f1-score': 0.42954132141391255, 'support': 3809899}, 'weighted avg': {'precision': 0.4640106253220888, 'recall': 0.4477780119630468, 'f1-score': 0.4337723950136328, 'support': 3809899}}
[[399953 611554 164567]
 [247919 935835 220915]
 [163825 695130 370201]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0108477
{'0': {'precision': 0.45998529546916644, 'recall': 0.1548808941756045, 'f1-score': 0.2317347581302319, 'support': 969474}, '1': {'precision': 0.5033021503417496, 'recall': 0.8890857597502285, 'f1-score': 0.642750158166712, 'support': 1855136}, '2': {'precision': 0.4594838196954866, 'recall': 0.09623572373181878, 'f1-score': 0.1591405537359512, 'support': 985289}, 'accuracy': 0.4972173803032574, 'macro avg': {'precision': 0.4742570885021342, 'recall': 0.38006745921921725, 'f1-score': 0.34454182334429834, 'support': 3809899}, 'weighted avg': {'precision': 0.48094767749486617, 'recall': 0.4972173803032574, 'f1-score': 0.4130947348930382, 'support': 3809899}}
[[ 150153  782404   36917]
 [ 131136 1649375   74625]
 [  45141  845328   94820]]
Evaluating performance on  train set...
6147/6147 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9744348
{'0': {'precision': 0.4922037537894549, 'recall': 0.5463544888449008, 'f1-score': 0.5178674036172599, 'support': 484980}, '1': {'precision': 0.5486168732527413, 'recall': 0.5035004477024912, 'f1-score': 0.5250913292618431, 'support': 597495}, '2': {'precision': 0.4964276176585386, 'recall': 0.4921610557829779, 'f1-score': 0.4942851298834117, 'support': 491010}, 'accuracy': 0.5131704464929758, 'macro avg': {'precision': 0.5124160815669115, 'recall': 0.5140053307767899, 'f1-score': 0.5124146209208382, 'support': 1573485}, 'weighted avg': {'precision': 0.514943415249256, 'recall': 0.5131704464929758, 'f1-score': 0.5132516158766418, 'support': 1573485}}
[[264971 114745 105264]
 [156786 300839 139870]
 [116579 132775 241656]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0109301
{'0': {'precision': 0.5081061340804867, 'recall': 0.48844463457727527, 'f1-score': 0.4980814280474386, 'support': 521273}, '1': {'precision': 0.45221462755776654, 'recall': 0.51669197345175, 'f1-score': 0.48230792956332763, 'support': 523575}, '2': {'precision': 0.5025055045175005, 'recall': 0.4507176001679792, 'f1-score': 0.47520475312452315, 'support': 528637}, 'accuracy': 0.4851689085056419, 'macro avg': {'precision': 0.4876087553852512, 'recall': 0.4852847360656681, 'f1-score': 0.48519803691176316, 'support': 1573485}, 'weighted avg': {'precision': 0.48762669160857147, 'recall': 0.4851689085056419, 'f1-score': 0.4851470395594367, 'support': 1573485}}
[[254613 153296 113364]
 [130522 270527 122526]
 [115967 174404 238266]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0574287
{'0': {'precision': 0.5262199703601627, 'recall': 0.33928544073041456, 'f1-score': 0.4125653572513805, 'support': 522224}, '1': {'precision': 0.3794757485162594, 'recall': 0.6932736912500747, 'f1-score': 0.49047903109799124, 'support': 518873}, '2': {'precision': 0.5098637971983908, 'recall': 0.2766140484007904, 'f1-score': 0.35865088855388677, 'support': 532388}, 'accuracy': 0.43481189842928275, 'macro avg': {'precision': 0.47185317202493765, 'recall': 0.4363910601270932, 'f1-score': 0.4205650923010862, 'support': 1573485}, 'weighted avg': {'precision': 0.47229543664165824, 'recall': 0.43481189842928275, 'f1-score': 0.42001626115506635, 'support': 1573485}}
[[177183 275736  69305]
 [ 86889 359721  72263]
 [ 72637 312485 147266]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1553776
{'0': {'precision': 0.5455485184870903, 'recall': 0.13610155269701238, 'f1-score': 0.21785371578900348, 'support': 519612}, '1': {'precision': 0.3386920439840526, 'recall': 0.8964617001859831, 'f1-score': 0.4916383033651097, 'support': 519402}, '2': {'precision': 0.5493247253303997, 'recall': 0.07100291690288155, 'f1-score': 0.1257517968566193, 'support': 534471}, 'accuracy': 0.36498155368497315, 'macro avg': {'precision': 0.4778550959338475, 'recall': 0.3678553899286257, 'f1-score': 0.2784146053369108, 'support': 1573485}, 'weighted avg': {'precision': 0.4785485829795536, 'recall': 0.36498155368497315, 'f1-score': 0.27694449685300754, 'support': 1573485}}
[[ 70720 435485  13407]
 [ 36051 465624  17727]
 [ 22860 473662  37949]]
Evaluating performance on  val set...
2174/2174 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.967802
{'0': {'precision': 0.4917950617822041, 'recall': 0.5343103887109854, 'f1-score': 0.5121719419786604, 'support': 168943}, '1': {'precision': 0.5828773651975628, 'recall': 0.5194923448075172, 'f1-score': 0.5493625712562694, 'support': 213058}, '2': {'precision': 0.4821513434971896, 'recall': 0.5058136536334619, 'f1-score': 0.4936991358335431, 'support': 174503}, 'accuracy': 0.5197015654873999, 'macro avg': {'precision': 0.5189412568256522, 'recall': 0.5198721290506548, 'f1-score': 0.5184112163561577, 'support': 556504}, 'weighted avg': {'precision': 0.5236420127999499, 'recall': 0.5197015654873999, 'f1-score': 0.5206178848683565, 'support': 556504}}
[[ 90268  36115  42560]
 [ 50135 110682  52241]
 [ 43145  43092  88266]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0068984
{'0': {'precision': 0.5052449567723343, 'recall': 0.4803919419540104, 'f1-score': 0.4925051127042273, 'support': 182476}, '1': {'precision': 0.48049108809715646, 'recall': 0.524483174688296, 'f1-score': 0.501524269081567, 'support': 186475}, '2': {'precision': 0.48763485199714696, 'recall': 0.466582779267727, 'f1-score': 0.4768765888574939, 'support': 187553}, 'accuracy': 0.49051219757629777, 'macro avg': {'precision': 0.49112363228887923, 'recall': 0.4904859653033445, 'f1-score': 0.49030199021442944, 'support': 556504}, 'weighted avg': {'precision': 0.49101539931703386, 'recall': 0.49051219757629777, 'f1-score': 0.4902601524747195, 'support': 556504}}
[[87660 48772 46044]
 [42769 97803 45903]
 [43071 56973 87509]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0539782
{'0': {'precision': 0.5070757010860756, 'recall': 0.3445896077286597, 'f1-score': 0.41033259219907003, 'support': 181558}, '1': {'precision': 0.4011737941845572, 'recall': 0.668109966729811, 'f1-score': 0.5013228856226521, 'support': 188457}, '2': {'precision': 0.4862580699253794, 'recall': 0.3109888518893876, 'f1-score': 0.379357598631602, 'support': 186489}, 'accuracy': 0.4428881014332332, 'macro avg': {'precision': 0.46483585506533737, 'recall': 0.4412294754492861, 'f1-score': 0.430337692151108, 'support': 556504}, 'weighted avg': {'precision': 0.4642364494608105, 'recall': 0.4428881014332332, 'f1-score': 0.4307659801932704, 'support': 556504}}
[[ 62563  87681  31314]
 [ 32587 125910  29960]
 [ 28230 100263  57996]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1256754
{'0': {'precision': 0.496576611723398, 'recall': 0.14453856897902637, 'f1-score': 0.2239050797964739, 'support': 176126}, '1': {'precision': 0.36749481962089814, 'recall': 0.8665959076594957, 'f1-score': 0.5161200870074707, 'support': 199739}, '2': {'precision': 0.4982618094709474, 'recall': 0.0944203632659614, 'f1-score': 0.1587564573928422, 'support': 180639}, 'accuracy': 0.3874293805615054, 'macro avg': {'precision': 0.45411108027174785, 'recall': 0.36851827996816117, 'f1-score': 0.29959387473226223, 'support': 556504}, 'weighted avg': {'precision': 0.45079391180238815, 'recall': 0.3874293805615054, 'f1-score': 0.3076391613537451, 'support': 556504}}
[[ 25457 143246   7423]
 [ 16894 173093   9752]
 [  8914 154669  17056]]
training model: results/AAPL/W2/deepVOL_L3/seq2seq
Epoch 1/50
6147/6147 - 259s - loss: 12.5582 - accuracy10: 0.4496 - accuracy20: 0.4439 - accuracy30: 0.4372 - accuracy50: 0.4399 - val_loss: 13.1771 - val_accuracy10: 0.4327 - val_accuracy20: 0.3937 - val_accuracy30: 0.3771 - val_accuracy50: 0.3758 - 259s/epoch - 42ms/step
Epoch 2/50
6147/6147 - 251s - loss: 12.2948 - accuracy10: 0.4844 - accuracy20: 0.4747 - accuracy30: 0.4610 - accuracy50: 0.4536 - val_loss: 12.9401 - val_accuracy10: 0.4630 - val_accuracy20: 0.3923 - val_accuracy30: 0.3685 - val_accuracy50: 0.3695 - 251s/epoch - 41ms/step
Epoch 3/50
6147/6147 - 258s - loss: 12.1926 - accuracy10: 0.4958 - accuracy20: 0.4846 - accuracy30: 0.4680 - accuracy50: 0.4586 - val_loss: 12.8141 - val_accuracy10: 0.4849 - val_accuracy20: 0.4092 - val_accuracy30: 0.3724 - val_accuracy50: 0.3705 - 258s/epoch - 42ms/step
Epoch 4/50
6147/6147 - 255s - loss: 12.1294 - accuracy10: 0.5023 - accuracy20: 0.4895 - accuracy30: 0.4720 - accuracy50: 0.4616 - val_loss: 12.7291 - val_accuracy10: 0.5042 - val_accuracy20: 0.4313 - val_accuracy30: 0.3769 - val_accuracy50: 0.3712 - 255s/epoch - 42ms/step
Epoch 5/50
6147/6147 - 253s - loss: 12.0828 - accuracy10: 0.5077 - accuracy20: 0.4938 - accuracy30: 0.4751 - accuracy50: 0.4637 - val_loss: 12.7440 - val_accuracy10: 0.5089 - val_accuracy20: 0.4395 - val_accuracy30: 0.3773 - val_accuracy50: 0.3701 - 253s/epoch - 41ms/step
Epoch 6/50
6147/6147 - 252s - loss: 12.0411 - accuracy10: 0.5122 - accuracy20: 0.4971 - accuracy30: 0.4779 - accuracy50: 0.4656 - val_loss: 12.7042 - val_accuracy10: 0.5097 - val_accuracy20: 0.4494 - val_accuracy30: 0.3798 - val_accuracy50: 0.3715 - 252s/epoch - 41ms/step
Epoch 7/50
6147/6147 - 254s - loss: 12.0079 - accuracy10: 0.5158 - accuracy20: 0.4997 - accuracy30: 0.4801 - accuracy50: 0.4677 - val_loss: 12.6366 - val_accuracy10: 0.5142 - val_accuracy20: 0.4593 - val_accuracy30: 0.3828 - val_accuracy50: 0.3708 - 254s/epoch - 41ms/step
Epoch 8/50
6147/6147 - 252s - loss: 11.9759 - accuracy10: 0.5185 - accuracy20: 0.5020 - accuracy30: 0.4820 - accuracy50: 0.4695 - val_loss: 12.6453 - val_accuracy10: 0.5129 - val_accuracy20: 0.4636 - val_accuracy30: 0.3827 - val_accuracy50: 0.3690 - 252s/epoch - 41ms/step
Epoch 9/50
6147/6147 - 252s - loss: 11.9528 - accuracy10: 0.5208 - accuracy20: 0.5038 - accuracy30: 0.4837 - accuracy50: 0.4709 - val_loss: 12.6793 - val_accuracy10: 0.5173 - val_accuracy20: 0.4622 - val_accuracy30: 0.3797 - val_accuracy50: 0.3707 - 252s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 256s - loss: 11.9299 - accuracy10: 0.5231 - accuracy20: 0.5057 - accuracy30: 0.4846 - accuracy50: 0.4720 - val_loss: 12.6477 - val_accuracy10: 0.5178 - val_accuracy20: 0.4737 - val_accuracy30: 0.3849 - val_accuracy50: 0.3710 - 256s/epoch - 42ms/step
Epoch 11/50
6147/6147 - 256s - loss: 11.9114 - accuracy10: 0.5247 - accuracy20: 0.5071 - accuracy30: 0.4861 - accuracy50: 0.4729 - val_loss: 12.6497 - val_accuracy10: 0.5175 - val_accuracy20: 0.4753 - val_accuracy30: 0.3852 - val_accuracy50: 0.3710 - 256s/epoch - 42ms/step
Epoch 12/50
6147/6147 - 256s - loss: 11.8957 - accuracy10: 0.5263 - accuracy20: 0.5083 - accuracy30: 0.4873 - accuracy50: 0.4736 - val_loss: 12.6116 - val_accuracy10: 0.5117 - val_accuracy20: 0.4805 - val_accuracy30: 0.3891 - val_accuracy50: 0.3716 - 256s/epoch - 42ms/step
Epoch 13/50
6147/6147 - 255s - loss: 11.8794 - accuracy10: 0.5278 - accuracy20: 0.5093 - accuracy30: 0.4882 - accuracy50: 0.4745 - val_loss: 12.5720 - val_accuracy10: 0.5150 - val_accuracy20: 0.4836 - val_accuracy30: 0.3925 - val_accuracy50: 0.3724 - 255s/epoch - 42ms/step
Epoch 14/50
6147/6147 - 259s - loss: 11.8661 - accuracy10: 0.5287 - accuracy20: 0.5101 - accuracy30: 0.4889 - accuracy50: 0.4748 - val_loss: 12.5401 - val_accuracy10: 0.5147 - val_accuracy20: 0.4874 - val_accuracy30: 0.4008 - val_accuracy50: 0.3729 - 259s/epoch - 42ms/step
Epoch 15/50
6147/6147 - 256s - loss: 11.8537 - accuracy10: 0.5298 - accuracy20: 0.5113 - accuracy30: 0.4899 - accuracy50: 0.4757 - val_loss: 12.6100 - val_accuracy10: 0.5140 - val_accuracy20: 0.4815 - val_accuracy30: 0.3959 - val_accuracy50: 0.3731 - 256s/epoch - 42ms/step
Epoch 16/50
6147/6147 - 253s - loss: 11.8435 - accuracy10: 0.5304 - accuracy20: 0.5119 - accuracy30: 0.4903 - accuracy50: 0.4763 - val_loss: 12.6121 - val_accuracy10: 0.5122 - val_accuracy20: 0.4798 - val_accuracy30: 0.3970 - val_accuracy50: 0.3724 - 253s/epoch - 41ms/step
Epoch 17/50
6147/6147 - 262s - loss: 11.8329 - accuracy10: 0.5313 - accuracy20: 0.5128 - accuracy30: 0.4912 - accuracy50: 0.4767 - val_loss: 12.5881 - val_accuracy10: 0.5159 - val_accuracy20: 0.4860 - val_accuracy30: 0.3991 - val_accuracy50: 0.3726 - 262s/epoch - 43ms/step
Epoch 18/50
6147/6147 - 266s - loss: 11.8236 - accuracy10: 0.5326 - accuracy20: 0.5135 - accuracy30: 0.4916 - accuracy50: 0.4772 - val_loss: 12.5957 - val_accuracy10: 0.5176 - val_accuracy20: 0.4858 - val_accuracy30: 0.4060 - val_accuracy50: 0.3739 - 266s/epoch - 43ms/step
Epoch 19/50
6147/6147 - 261s - loss: 11.8134 - accuracy10: 0.5334 - accuracy20: 0.5142 - accuracy30: 0.4926 - accuracy50: 0.4781 - val_loss: 12.6099 - val_accuracy10: 0.5142 - val_accuracy20: 0.4838 - val_accuracy30: 0.4061 - val_accuracy50: 0.3738 - 261s/epoch - 42ms/step
Epoch 20/50
6147/6147 - 262s - loss: 11.8046 - accuracy10: 0.5339 - accuracy20: 0.5146 - accuracy30: 0.4930 - accuracy50: 0.4785 - val_loss: 12.5420 - val_accuracy10: 0.5162 - val_accuracy20: 0.4871 - val_accuracy30: 0.4132 - val_accuracy50: 0.3748 - 262s/epoch - 43ms/step
Epoch 21/50
6147/6147 - 261s - loss: 11.7975 - accuracy10: 0.5343 - accuracy20: 0.5154 - accuracy30: 0.4937 - accuracy50: 0.4791 - val_loss: 12.5463 - val_accuracy10: 0.5240 - val_accuracy20: 0.4902 - val_accuracy30: 0.4141 - val_accuracy50: 0.3745 - 261s/epoch - 42ms/step
Epoch 22/50
6147/6147 - 261s - loss: 11.7885 - accuracy10: 0.5349 - accuracy20: 0.5162 - accuracy30: 0.4942 - accuracy50: 0.4795 - val_loss: 12.5717 - val_accuracy10: 0.5164 - val_accuracy20: 0.4853 - val_accuracy30: 0.4141 - val_accuracy50: 0.3758 - 261s/epoch - 42ms/step
Epoch 23/50
6147/6147 - 264s - loss: 11.7826 - accuracy10: 0.5354 - accuracy20: 0.5165 - accuracy30: 0.4947 - accuracy50: 0.4801 - val_loss: 12.5255 - val_accuracy10: 0.5177 - val_accuracy20: 0.4872 - val_accuracy30: 0.4182 - val_accuracy50: 0.3753 - 264s/epoch - 43ms/step
Epoch 24/50
6147/6147 - 261s - loss: 11.7741 - accuracy10: 0.5357 - accuracy20: 0.5169 - accuracy30: 0.4955 - accuracy50: 0.4807 - val_loss: 12.5279 - val_accuracy10: 0.5163 - val_accuracy20: 0.4869 - val_accuracy30: 0.4208 - val_accuracy50: 0.3760 - 261s/epoch - 42ms/step
Epoch 25/50
6147/6147 - 262s - loss: 11.7673 - accuracy10: 0.5366 - accuracy20: 0.5175 - accuracy30: 0.4957 - accuracy50: 0.4810 - val_loss: 12.4574 - val_accuracy10: 0.5234 - val_accuracy20: 0.4944 - val_accuracy30: 0.4291 - val_accuracy50: 0.3780 - 262s/epoch - 43ms/step
Epoch 26/50
6147/6147 - 265s - loss: 11.7593 - accuracy10: 0.5369 - accuracy20: 0.5179 - accuracy30: 0.4961 - accuracy50: 0.4818 - val_loss: 12.4531 - val_accuracy10: 0.5227 - val_accuracy20: 0.4927 - val_accuracy30: 0.4295 - val_accuracy50: 0.3786 - 265s/epoch - 43ms/step
Epoch 27/50
6147/6147 - 271s - loss: 11.7522 - accuracy10: 0.5373 - accuracy20: 0.5183 - accuracy30: 0.4968 - accuracy50: 0.4823 - val_loss: 12.5120 - val_accuracy10: 0.5180 - val_accuracy20: 0.4880 - val_accuracy30: 0.4250 - val_accuracy50: 0.3780 - 271s/epoch - 44ms/step
Epoch 28/50
6147/6147 - 256s - loss: 11.7472 - accuracy10: 0.5374 - accuracy20: 0.5188 - accuracy30: 0.4971 - accuracy50: 0.4823 - val_loss: 12.5158 - val_accuracy10: 0.5237 - val_accuracy20: 0.4924 - val_accuracy30: 0.4286 - val_accuracy50: 0.3781 - 256s/epoch - 42ms/step
Epoch 29/50
6147/6147 - 257s - loss: 11.7411 - accuracy10: 0.5378 - accuracy20: 0.5196 - accuracy30: 0.4978 - accuracy50: 0.4832 - val_loss: 12.4247 - val_accuracy10: 0.5220 - val_accuracy20: 0.4933 - val_accuracy30: 0.4365 - val_accuracy50: 0.3809 - 257s/epoch - 42ms/step
Epoch 30/50
6147/6147 - 263s - loss: 11.7342 - accuracy10: 0.5383 - accuracy20: 0.5196 - accuracy30: 0.4980 - accuracy50: 0.4835 - val_loss: 12.4173 - val_accuracy10: 0.5259 - val_accuracy20: 0.4962 - val_accuracy30: 0.4400 - val_accuracy50: 0.3834 - 263s/epoch - 43ms/step
Epoch 31/50
6147/6147 - 259s - loss: 11.7268 - accuracy10: 0.5391 - accuracy20: 0.5202 - accuracy30: 0.4986 - accuracy50: 0.4841 - val_loss: 12.4282 - val_accuracy10: 0.5238 - val_accuracy20: 0.4960 - val_accuracy30: 0.4389 - val_accuracy50: 0.3818 - 259s/epoch - 42ms/step
Epoch 32/50
6147/6147 - 257s - loss: 11.7204 - accuracy10: 0.5395 - accuracy20: 0.5207 - accuracy30: 0.4994 - accuracy50: 0.4846 - val_loss: 12.4033 - val_accuracy10: 0.5252 - val_accuracy20: 0.4976 - val_accuracy30: 0.4407 - val_accuracy50: 0.3825 - 257s/epoch - 42ms/step
Epoch 33/50
6147/6147 - 258s - loss: 11.7162 - accuracy10: 0.5395 - accuracy20: 0.5210 - accuracy30: 0.4998 - accuracy50: 0.4849 - val_loss: 12.4052 - val_accuracy10: 0.5223 - val_accuracy20: 0.4963 - val_accuracy30: 0.4439 - val_accuracy50: 0.3849 - 258s/epoch - 42ms/step
Epoch 34/50
6147/6147 - 256s - loss: 11.7105 - accuracy10: 0.5400 - accuracy20: 0.5215 - accuracy30: 0.5002 - accuracy50: 0.4852 - val_loss: 12.4110 - val_accuracy10: 0.5238 - val_accuracy20: 0.4956 - val_accuracy30: 0.4436 - val_accuracy50: 0.3843 - 256s/epoch - 42ms/step
Epoch 35/50
6147/6147 - 250s - loss: 11.7034 - accuracy10: 0.5401 - accuracy20: 0.5218 - accuracy30: 0.5007 - accuracy50: 0.4856 - val_loss: 12.4107 - val_accuracy10: 0.5188 - val_accuracy20: 0.4928 - val_accuracy30: 0.4445 - val_accuracy50: 0.3854 - 250s/epoch - 41ms/step
Epoch 36/50
6147/6147 - 253s - loss: 11.6994 - accuracy10: 0.5404 - accuracy20: 0.5220 - accuracy30: 0.5009 - accuracy50: 0.4862 - val_loss: 12.4211 - val_accuracy10: 0.5217 - val_accuracy20: 0.4950 - val_accuracy30: 0.4443 - val_accuracy50: 0.3843 - 253s/epoch - 41ms/step
Epoch 37/50
6147/6147 - 258s - loss: 11.6925 - accuracy10: 0.5408 - accuracy20: 0.5229 - accuracy30: 0.5015 - accuracy50: 0.4868 - val_loss: 12.4025 - val_accuracy10: 0.5262 - val_accuracy20: 0.4957 - val_accuracy30: 0.4448 - val_accuracy50: 0.3870 - 258s/epoch - 42ms/step
Epoch 38/50
6147/6147 - 255s - loss: 11.6882 - accuracy10: 0.5411 - accuracy20: 0.5226 - accuracy30: 0.5019 - accuracy50: 0.4875 - val_loss: 12.3936 - val_accuracy10: 0.5240 - val_accuracy20: 0.4962 - val_accuracy30: 0.4490 - val_accuracy50: 0.3903 - 255s/epoch - 42ms/step
Epoch 39/50
6147/6147 - 254s - loss: 11.6835 - accuracy10: 0.5414 - accuracy20: 0.5231 - accuracy30: 0.5022 - accuracy50: 0.4879 - val_loss: 12.4564 - val_accuracy10: 0.5224 - val_accuracy20: 0.4946 - val_accuracy30: 0.4452 - val_accuracy50: 0.3858 - 254s/epoch - 41ms/step
Epoch 40/50
6147/6147 - 254s - loss: 11.6789 - accuracy10: 0.5411 - accuracy20: 0.5234 - accuracy30: 0.5026 - accuracy50: 0.4883 - val_loss: 12.4798 - val_accuracy10: 0.5189 - val_accuracy20: 0.4908 - val_accuracy30: 0.4429 - val_accuracy50: 0.3848 - 254s/epoch - 41ms/step
Epoch 41/50
6147/6147 - 259s - loss: 11.6710 - accuracy10: 0.5418 - accuracy20: 0.5240 - accuracy30: 0.5035 - accuracy50: 0.4885 - val_loss: 12.4535 - val_accuracy10: 0.5198 - val_accuracy20: 0.4919 - val_accuracy30: 0.4439 - val_accuracy50: 0.3877 - 259s/epoch - 42ms/step
Epoch 42/50
6147/6147 - 253s - loss: 11.6680 - accuracy10: 0.5419 - accuracy20: 0.5243 - accuracy30: 0.5037 - accuracy50: 0.4894 - val_loss: 12.3931 - val_accuracy10: 0.5212 - val_accuracy20: 0.4958 - val_accuracy30: 0.4516 - val_accuracy50: 0.3931 - 253s/epoch - 41ms/step
Epoch 43/50
6147/6147 - 253s - loss: 11.6620 - accuracy10: 0.5424 - accuracy20: 0.5247 - accuracy30: 0.5041 - accuracy50: 0.4898 - val_loss: 12.3900 - val_accuracy10: 0.5259 - val_accuracy20: 0.4987 - val_accuracy30: 0.4517 - val_accuracy50: 0.3912 - 253s/epoch - 41ms/step
Epoch 44/50
6147/6147 - 254s - loss: 11.6567 - accuracy10: 0.5428 - accuracy20: 0.5250 - accuracy30: 0.5047 - accuracy50: 0.4903 - val_loss: 12.4702 - val_accuracy10: 0.5170 - val_accuracy20: 0.4895 - val_accuracy30: 0.4434 - val_accuracy50: 0.3902 - 254s/epoch - 41ms/step
Epoch 45/50
6147/6147 - 259s - loss: 11.6508 - accuracy10: 0.5428 - accuracy20: 0.5253 - accuracy30: 0.5051 - accuracy50: 0.4909 - val_loss: 12.4745 - val_accuracy10: 0.5168 - val_accuracy20: 0.4904 - val_accuracy30: 0.4439 - val_accuracy50: 0.3906 - 259s/epoch - 42ms/step
Epoch 46/50
6147/6147 - 255s - loss: 11.6481 - accuracy10: 0.5430 - accuracy20: 0.5255 - accuracy30: 0.5054 - accuracy50: 0.4914 - val_loss: 12.5060 - val_accuracy10: 0.5156 - val_accuracy20: 0.4891 - val_accuracy30: 0.4425 - val_accuracy50: 0.3898 - 255s/epoch - 41ms/step
Epoch 47/50
6147/6147 - 257s - loss: 11.6409 - accuracy10: 0.5433 - accuracy20: 0.5261 - accuracy30: 0.5061 - accuracy50: 0.4916 - val_loss: 12.4814 - val_accuracy10: 0.5177 - val_accuracy20: 0.4911 - val_accuracy30: 0.4472 - val_accuracy50: 0.3936 - 257s/epoch - 42ms/step
Epoch 48/50
6147/6147 - 254s - loss: 11.6367 - accuracy10: 0.5435 - accuracy20: 0.5265 - accuracy30: 0.5066 - accuracy50: 0.4923 - val_loss: 12.4745 - val_accuracy10: 0.5147 - val_accuracy20: 0.4891 - val_accuracy30: 0.4466 - val_accuracy50: 0.3939 - 254s/epoch - 41ms/step
Epoch 49/50
6147/6147 - 254s - loss: 11.6328 - accuracy10: 0.5437 - accuracy20: 0.5268 - accuracy30: 0.5068 - accuracy50: 0.4928 - val_loss: 12.4635 - val_accuracy10: 0.5160 - val_accuracy20: 0.4897 - val_accuracy30: 0.4452 - val_accuracy50: 0.3936 - 254s/epoch - 41ms/step
Epoch 50/50
6147/6147 - 258s - loss: 11.6282 - accuracy10: 0.5439 - accuracy20: 0.5271 - accuracy30: 0.5072 - accuracy50: 0.4932 - val_loss: 12.4734 - val_accuracy10: 0.5156 - val_accuracy20: 0.4898 - val_accuracy30: 0.4476 - val_accuracy50: 0.3950 - 258s/epoch - 42ms/step
testing model: results/AAPL/W2/deepVOL_L3/seq2seq
Evaluating performance on  test set...
14883/14883 - 256s - 256s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97390217
{'0': {'precision': 0.4810913668995608, 'recall': 0.5342361955988133, 'f1-score': 0.5062729134535157, 'support': 1124424}, '1': {'precision': 0.5725052168044349, 'recall': 0.46119968759368246, 'f1-score': 0.5108599678932503, 'support': 1521096}, '2': {'precision': 0.4794781929132208, 'recall': 0.5501069668896468, 'f1-score': 0.5123700392956775, 'support': 1164379}, 'accuracy': 0.5099269035740842, 'macro avg': {'precision': 0.5110249255390721, 'recall': 0.5151809500273808, 'f1-score': 0.5098343068808145, 'support': 3809899}, 'weighted avg': {'precision': 0.517095181048404, 'recall': 0.5099269035740842, 'f1-score': 0.5099676873703658, 'support': 3809899}}
[[600708 249596 274120]
 [398324 701529 421243]
 [249604 274242 640533]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.009745
{'0': {'precision': 0.48636454578440314, 'recall': 0.47558737364275283, 'f1-score': 0.480915589004281, 'support': 1206302}, '1': {'precision': 0.4811168278319636, 'recall': 0.4521246186202198, 'f1-score': 0.46617038521433013, 'support': 1350360}, '2': {'precision': 0.48095259082962377, 'recall': 0.522439091728061, 'f1-score': 0.5008381852972776, 'support': 1253237}, 'accuracy': 0.4826828742704203, 'macro avg': {'precision': 0.48281132148199685, 'recall': 0.48338369466367787, 'f1-score': 0.48264138650529625, 'support': 3809899}, 'weighted avg': {'precision': 0.4827243520139333, 'recall': 0.4826828742704203, 'f1-score': 0.4822427636670865, 'support': 3809899}}
[[573702 314215 318385]
 [351614 610531 388215]
 [254256 344241 654740]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0415299
{'0': {'precision': 0.4951160294384905, 'recall': 0.3219941942428793, 'f1-score': 0.3902153769108821, 'support': 1176074}, '1': {'precision': 0.42346813849318565, 'recall': 0.6414678475854454, 'f1-score': 0.5101549743294751, 'support': 1404669}, '2': {'precision': 0.47375398331776164, 'recall': 0.35354096632160603, 'f1-score': 0.40491348613667694, 'support': 1229156}, 'accuracy': 0.4499583847235845, 'macro avg': {'precision': 0.464112717083146, 'recall': 0.43900100271664355, 'f1-score': 0.4350946124590114, 'support': 3809899}, 'weighted avg': {'precision': 0.46180835947458304, 'recall': 0.4499583847235845, 'f1-score': 0.439177751900329, 'support': 3809899}}
[[378689 579924 217461]
 [238374 901050 265245]
 [147786 646813 434557]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0126567
{'0': {'precision': 0.474314371860825, 'recall': 0.12867596242911106, 'f1-score': 0.20243395232867686, 'support': 969474}, '1': {'precision': 0.5054297901365332, 'recall': 0.8915394882100288, 'f1-score': 0.645126021608385, 'support': 1855136}, '2': {'precision': 0.4424599561502546, 'recall': 0.12330189416506224, 'f1-score': 0.1928590648348273, 'support': 985289}, 'accuracy': 0.49874366748304877, 'macro avg': {'precision': 0.4740680393825376, 'recall': 0.3811724482680674, 'f1-score': 0.3468063462572964, 'support': 3809899}, 'weighted avg': {'precision': 0.4812272919138951, 'recall': 0.49874366748304877, 'f1-score': 0.41551570680861266, 'support': 3809899}}
[[ 124748  786544   58182]
 [ 106305 1653927   94904]
 [  31954  831847  121488]]
Evaluating performance on  train set...
6147/6147 - 108s - 108s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96834344
{'0': {'precision': 0.49496184735974824, 'recall': 0.5499793805930141, 'f1-score': 0.521022241148273, 'support': 484980}, '1': {'precision': 0.5685760904220404, 'recall': 0.456656541058921, 'f1-score': 0.5065074653464243, 'support': 597495}, '2': {'precision': 0.48905021326305087, 'recall': 0.55249994908454, 'f1-score': 0.5188424479116861, 'support': 491010}, 'accuracy': 0.5153287130160122, 'macro avg': {'precision': 0.5175293836816132, 'recall': 0.5197119569121584, 'f1-score': 0.5154573848021279, 'support': 1573485}, 'weighted avg': {'precision': 0.5210704347950812, 'recall': 0.5153287130160122, 'f1-score': 0.5148303764372513, 'support': 1573485}}
[[266729  99550 118701]
 [159915 272850 164730]
 [112244 107483 271283]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0031127
{'0': {'precision': 0.5062677351341925, 'recall': 0.4901212992040639, 'f1-score': 0.4980636910639318, 'support': 521273}, '1': {'precision': 0.4747734887686116, 'recall': 0.4573766891085327, 'f1-score': 0.4659127499477122, 'support': 523575}, '2': {'precision': 0.4912578151713093, 'recall': 0.5245357400257644, 'f1-score': 0.5073516765408699, 'support': 528637}, 'accuracy': 0.49078764652983664, 'macro avg': {'precision': 0.4907663463580378, 'recall': 0.4906779094461203, 'f1-score': 0.490442705850838, 'support': 1573485}, 'weighted avg': {'precision': 0.49074524899655686, 'recall': 0.49078764652983664, 'f1-score': 0.49048595361085623, 'support': 1573485}}
[[255487 126684 139102]
 [136048 239471 148056]
 [113113 138235 277289]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0495473
{'0': {'precision': 0.5301647032653326, 'recall': 0.32859462606084744, 'f1-score': 0.4057231554196315, 'support': 522224}, '1': {'precision': 0.3892862679351664, 'recall': 0.6533544817325242, 'f1-score': 0.48788027499104136, 'support': 518873}, '2': {'precision': 0.4951618478653814, 'recall': 0.35246850041698913, 'f1-score': 0.4118044011389634, 'support': 532388}, 'accuracy': 0.4437652726273209, 'macro avg': {'precision': 0.47153760635529346, 'recall': 0.44480586940345357, 'f1-score': 0.43513594384987875, 'support': 1573485}, 'weighted avg': {'precision': 0.4718653762582505, 'recall': 0.4437652726273209, 'f1-score': 0.43487290476544654, 'support': 1573485}}
[[171600 253839  96785]
 [ 85333 339008  94532]
 [ 66740 277998 187650]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1580263
{'0': {'precision': 0.5672971556529611, 'recall': 0.11457587584582342, 'f1-score': 0.1906471306862304, 'support': 519612}, '1': {'precision': 0.34058151166123624, 'recall': 0.8967658961652054, 'f1-score': 0.493671999618444, 'support': 519402}, '2': {'precision': 0.5302579954821067, 'recall': 0.10013639654911118, 'f1-score': 0.1684600167138021, 'support': 534471}, 'accuracy': 0.36786941089365327, 'macro avg': {'precision': 0.47937888759876807, 'recall': 0.37049272285338003, 'f1-score': 0.2842597156728255, 'support': 1573485}, 'weighted avg': {'precision': 0.4798778819412533, 'recall': 0.36786941089365327, 'f1-score': 0.28313822782485704, 'support': 1573485}}
[[ 59535 437432  22645]
 [ 28853 465782  24767]
 [ 16557 464394  53520]]
Evaluating performance on  val set...
2174/2174 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9582139
{'0': {'precision': 0.4951006245662734, 'recall': 0.5278703468033598, 'f1-score': 0.510960615123701, 'support': 168943}, '1': {'precision': 0.6026861679424067, 'recall': 0.4970524458128772, 'f1-score': 0.5447960635126411, 'support': 213058}, '2': {'precision': 0.4857822030857553, 'recall': 0.5586093075763741, 'f1-score': 0.5196565796032167, 'support': 174503}, 'accuracy': 0.5257105070224113, 'macro avg': {'precision': 0.5278563318648118, 'recall': 0.527844033397537, 'f1-score': 0.5251377527465195, 'support': 556504}, 'weighted avg': {'precision': 0.5333678575008388, 'recall': 0.5257105070224113, 'f1-score': 0.5266413377284257, 'support': 556504}}
[[ 89180  32903  46860]
 [ 50832 105901  56325]
 [ 40113  36911  97479]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99875766
{'0': {'precision': 0.5024587026294868, 'recall': 0.467568337754006, 'f1-score': 0.48438604409548064, 'support': 182476}, '1': {'precision': 0.5075387415209839, 'recall': 0.4935353264512669, 'f1-score': 0.500439091366349, 'support': 186475}, '2': {'precision': 0.4867677205420487, 'recall': 0.5330066701145809, 'f1-score': 0.5088389044135986, 'support': 187553}, 'accuracy': 0.49832346218535717, 'macro avg': {'precision': 0.4989217215641731, 'recall': 0.49803677810661795, 'f1-score': 0.4978880132918094, 'support': 556504}, 'weighted avg': {'precision': 0.4988727616278887, 'recall': 0.49832346218535717, 'f1-score': 0.49800625042118396, 'support': 556504}}
[[85320 42137 55019]
 [44060 92032 50383]
 [40425 47161 99967]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0483752
{'0': {'precision': 0.505458413103595, 'recall': 0.32719020918934993, 'f1-score': 0.39724089968336546, 'support': 181558}, '1': {'precision': 0.4165575904869369, 'recall': 0.6366385966029386, 'f1-score': 0.5036034939410093, 'support': 188457}, '2': {'precision': 0.4750453780621911, 'recall': 0.38452670130677946, 'f1-score': 0.4250199292917619, 'support': 186489}, 'accuracy': 0.4511971162830815, 'macro avg': {'precision': 0.46568712721757427, 'recall': 0.44945183569968933, 'f1-score': 0.4419547743053789, 'support': 556504}, 'weighted avg': {'precision': 0.46516098699398234, 'recall': 0.4511971162830815, 'f1-score': 0.4425689815635551, 'support': 556504}}
[[ 59404  79314  42840]
 [ 32074 119979  36404]
 [ 26047  88732  71710]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1279286
{'0': {'precision': 0.5032530290886804, 'recall': 0.121214357902865, 'f1-score': 0.19537126855427644, 'support': 176126}, '1': {'precision': 0.3714260493635784, 'recall': 0.8637121443483746, 'f1-score': 0.5194644472915987, 'support': 199739}, '2': {'precision': 0.4765773029631123, 'recall': 0.13088535698271136, 'f1-score': 0.20536897011496247, 'support': 180639}, 'accuracy': 0.3908489426850481, 'macro avg': {'precision': 0.4504187938051237, 'recall': 0.371937286411317, 'f1-score': 0.3067348953202792, 'support': 556504}, 'weighted avg': {'precision': 0.4472791895566939, 'recall': 0.3908489426850481, 'f1-score': 0.31493918224408773, 'support': 556504}}
[[ 21349 141793  12984]
 [ 14239 172517  12983]
 [  6834 150162  23643]]
training model: results/AAPL/W3/deepLOB_L1/seq2seq
Epoch 1/50
5475/5475 - 148s - loss: 12.6643 - accuracy10: 0.4526 - accuracy20: 0.4377 - accuracy30: 0.4313 - accuracy50: 0.4181 - val_loss: 13.1607 - val_accuracy10: 0.4030 - val_accuracy20: 0.3853 - val_accuracy30: 0.3573 - val_accuracy50: 0.3661 - 148s/epoch - 27ms/step
Epoch 2/50
5475/5475 - 143s - loss: 12.5514 - accuracy10: 0.4662 - accuracy20: 0.4515 - accuracy30: 0.4425 - accuracy50: 0.4278 - val_loss: 13.2927 - val_accuracy10: 0.3960 - val_accuracy20: 0.3776 - val_accuracy30: 0.3453 - val_accuracy50: 0.3587 - 143s/epoch - 26ms/step
Epoch 3/50
5475/5475 - 143s - loss: 12.5293 - accuracy10: 0.4688 - accuracy20: 0.4540 - accuracy30: 0.4446 - accuracy50: 0.4290 - val_loss: 13.2283 - val_accuracy10: 0.4014 - val_accuracy20: 0.3831 - val_accuracy30: 0.3519 - val_accuracy50: 0.3625 - 143s/epoch - 26ms/step
Epoch 4/50
5475/5475 - 140s - loss: 12.5125 - accuracy10: 0.4708 - accuracy20: 0.4558 - accuracy30: 0.4464 - accuracy50: 0.4304 - val_loss: 13.3844 - val_accuracy10: 0.3999 - val_accuracy20: 0.3821 - val_accuracy30: 0.3520 - val_accuracy50: 0.3623 - 140s/epoch - 25ms/step
Epoch 5/50
5475/5475 - 136s - loss: 12.4969 - accuracy10: 0.4729 - accuracy20: 0.4575 - accuracy30: 0.4478 - accuracy50: 0.4318 - val_loss: 13.3157 - val_accuracy10: 0.4126 - val_accuracy20: 0.3930 - val_accuracy30: 0.3616 - val_accuracy50: 0.3676 - 136s/epoch - 25ms/step
Epoch 6/50
5475/5475 - 140s - loss: 12.4839 - accuracy10: 0.4743 - accuracy20: 0.4586 - accuracy30: 0.4492 - accuracy50: 0.4328 - val_loss: 13.2243 - val_accuracy10: 0.4239 - val_accuracy20: 0.4035 - val_accuracy30: 0.3734 - val_accuracy50: 0.3736 - 140s/epoch - 26ms/step
Epoch 7/50
5475/5475 - 142s - loss: 12.4723 - accuracy10: 0.4758 - accuracy20: 0.4597 - accuracy30: 0.4501 - accuracy50: 0.4332 - val_loss: 13.2738 - val_accuracy10: 0.4207 - val_accuracy20: 0.4004 - val_accuracy30: 0.3701 - val_accuracy50: 0.3710 - 142s/epoch - 26ms/step
Epoch 8/50
5475/5475 - 130s - loss: 12.4642 - accuracy10: 0.4767 - accuracy20: 0.4604 - accuracy30: 0.4509 - accuracy50: 0.4340 - val_loss: 13.3469 - val_accuracy10: 0.4175 - val_accuracy20: 0.3977 - val_accuracy30: 0.3661 - val_accuracy50: 0.3693 - 130s/epoch - 24ms/step
Epoch 9/50
5475/5475 - 135s - loss: 12.4544 - accuracy10: 0.4777 - accuracy20: 0.4613 - accuracy30: 0.4520 - accuracy50: 0.4349 - val_loss: 13.4433 - val_accuracy10: 0.4128 - val_accuracy20: 0.3935 - val_accuracy30: 0.3619 - val_accuracy50: 0.3665 - 135s/epoch - 25ms/step
Epoch 10/50
5475/5475 - 143s - loss: 12.4482 - accuracy10: 0.4783 - accuracy20: 0.4618 - accuracy30: 0.4524 - accuracy50: 0.4350 - val_loss: 13.2621 - val_accuracy10: 0.4198 - val_accuracy20: 0.3993 - val_accuracy30: 0.3679 - val_accuracy50: 0.3703 - 143s/epoch - 26ms/step
Epoch 11/50
5475/5475 - 149s - loss: 12.4408 - accuracy10: 0.4793 - accuracy20: 0.4622 - accuracy30: 0.4535 - accuracy50: 0.4357 - val_loss: 13.2772 - val_accuracy10: 0.4127 - val_accuracy20: 0.3929 - val_accuracy30: 0.3608 - val_accuracy50: 0.3657 - 149s/epoch - 27ms/step
testing model: results/AAPL/W3/deepLOB_L1/seq2seq
Evaluating performance on  test set...
13689/13689 - 145s - 145s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0590875
{'0': {'precision': 0.5551617967409427, 'recall': 0.21279428296878863, 'f1-score': 0.30766149156291733, 'support': 1071885}, '1': {'precision': 0.39471096361835634, 'recall': 0.6749803858033719, 'f1-score': 0.49812903254376295, 'support': 1333218}, '2': {'precision': 0.49006336777278564, 'recall': 0.36270894687952343, 'f1-score': 0.41687649792329795, 'support': 1099143}, 'accuracy': 0.43565891207409524, 'macro avg': {'precision': 0.47997870937736153, 'recall': 0.4168278718838947, 'f1-score': 0.40755567400999276, 'support': 3504246}, 'weighted avg': {'precision': 0.47369821760141434, 'recall': 0.43565891207409524, 'f1-score': 0.41438278447082644, 'support': 3504246}}
[[228091 722734 121060]
 [139546 899896 293776]
 [ 43218 657256 398669]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0873816
{'0': {'precision': 0.5597655384863189, 'recall': 0.19388653520930313, 'f1-score': 0.28801353986724304, 'support': 1147140}, '1': {'precision': 0.3500106024653799, 'recall': 0.6732032422493505, 'f1-score': 0.4605650590410744, 'support': 1186707}, '2': {'precision': 0.4963125680779989, 'recall': 0.3495995809975914, 'f1-score': 0.4102332991280922, 'support': 1170399}, 'accuracy': 0.4082136356865357, 'macro avg': {'precision': 0.4686962363432326, 'recall': 0.405563119485415, 'f1-score': 0.38627063267880324, 'support': 3504246}, 'weighted avg': {'precision': 0.46753943792901564, 'recall': 0.4082136356865357, 'f1-score': 0.387268552124761, 'support': 3504246}}
[[222415 774779 149946]
 [122507 798895 265305]
 [ 52414 708814 409171]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1136059
{'0': {'precision': 0.555219567654629, 'recall': 0.17277019988600406, 'f1-score': 0.26353501096141957, 'support': 1221096}, '1': {'precision': 0.30348603178971995, 'recall': 0.680004856558088, 'f1-score': 0.41967236902670546, 'support': 1037772}, '2': {'precision': 0.5035494723351422, 'recall': 0.3230601472002878, 'f1-score': 0.3935999843472561, 'support': 1245378}, 'accuracy': 0.3763979469477885, 'macro avg': {'precision': 0.454085023926497, 'recall': 0.39194506788145994, 'f1-score': 0.3589357881117938, 'support': 3504246}, 'weighted avg': {'precision': 0.4623063375473848, 'recall': 0.3763979469477885, 'f1-score': 0.3559985636855817, 'support': 3504246}}
[[210969 838849 171278]
 [106700 705690 225382]
 [ 62305 780741 402332]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1041483
{'0': {'precision': 0.4774042824211066, 'recall': 0.1481764945135205, 'f1-score': 0.2261581418199319, 'support': 1143265}, '1': {'precision': 0.34969415413294214, 'recall': 0.6891987291168812, 'f1-score': 0.4639723122447667, 'support': 1213959}, '2': {'precision': 0.44107523898236783, 'recall': 0.29104062520160906, 'f1-score': 0.3506844192140564, 'support': 1147022}, 'accuracy': 0.3823629962051751, 'macro avg': {'precision': 0.42272455851213886, 'recall': 0.37613861627733697, 'f1-score': 0.34693829109291835, 'support': 3504246}, 'weighted avg': {'precision': 0.42127093114104214, 'recall': 0.3823629962051751, 'f1-score': 0.3493033297616248, 'support': 3504246}}
[[169405 804900 168960]
 [123235 836659 254065]
 [ 62206 750986 333830]]
Evaluating performance on  train set...
5475/5475 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1243435
{'0': {'precision': 0.5085868631442082, 'recall': 0.14163324158948903, 'f1-score': 0.22156437653199185, 'support': 463973}, '1': {'precision': 0.3359175353772828, 'recall': 0.7877622813694753, 'f1-score': 0.4709938900334586, 'support': 465054}, '2': {'precision': 0.5047701313849337, 'recall': 0.19415328681865412, 'f1-score': 0.2804392514080041, 'support': 472539}, 'accuracy': 0.3737326676018111, 'macro avg': {'precision': 0.44975817663547496, 'recall': 0.37451626992587284, 'f1-score': 0.3243325059911515, 'support': 1401566}, 'weighted avg': {'precision': 0.45000659210159194, 'recall': 0.3737326676018111, 'f1-score': 0.3241773590607825, 'support': 1401566}}
[[ 65714 366006  32253]
 [ 40944 366352  57758]
 [ 22551 358243  91745]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.119392
{'0': {'precision': 0.481319292131118, 'recall': 0.13812808518893752, 'f1-score': 0.21465491539958662, 'support': 463910}, '1': {'precision': 0.33510277903766794, 'recall': 0.7727668915647093, 'f1-score': 0.4674851921360625, 'support': 464655}, '2': {'precision': 0.4866844072479077, 'recall': 0.2026084511449236, 'f1-score': 0.2861087932313599, 'support': 473001}, 'accuracy': 0.37028794933667053, 'macro avg': {'precision': 0.4343688261388979, 'recall': 0.3711678092995235, 'f1-score': 0.322749633589003, 'support': 1401566}, 'weighted avg': {'precision': 0.434655396833943, 'recall': 0.37028794933667053, 'f1-score': 0.32258890345672686, 'support': 1401566}}
[[ 64079 360088  39743]
 [ 44250 359070  61335]
 [ 24803 352364  95834]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1171262
{'0': {'precision': 0.4501954847433712, 'recall': 0.13197933453407906, 'f1-score': 0.20411910140813155, 'support': 464156}, '1': {'precision': 0.33441085111960633, 'recall': 0.7648591406522968, 'f1-score': 0.46535827981597194, 'support': 463654}, '2': {'precision': 0.47345292442155373, 'recall': 0.20490083502900228, 'f1-score': 0.286018609639534, 'support': 473756}, 'accuracy': 0.3659920403320286, 'macro avg': {'precision': 0.41935308676151045, 'recall': 0.36724643673845936, 'f1-score': 0.31849866362121254, 'support': 1401566}, 'weighted avg': {'precision': 0.4197540664112941, 'recall': 0.3659920403320286, 'f1-score': 0.3182235912767393, 'support': 1401566}}
[[ 61259 356411  46486]
 [ 47551 354630  61473]
 [ 27262 349421  97073]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1238645
{'0': {'precision': 0.4150869108726085, 'recall': 0.12222692169790864, 'f1-score': 0.18884604221088858, 'support': 465773}, '1': {'precision': 0.3291196859204749, 'recall': 0.7501048236153557, 'f1-score': 0.45750307146359853, 'support': 462682}, '2': {'precision': 0.4329979419163046, 'recall': 0.19210713764845883, 'f1-score': 0.26613763972972776, 'support': 473111}, 'accuracy': 0.35308933007792714, 'macro avg': {'precision': 0.3924015129031293, 'recall': 0.354812960987241, 'f1-score': 0.3041622511347383, 'support': 1401566}, 'weighted avg': {'precision': 0.39275361956332383, 'recall': 0.35308933007792714, 'f1-score': 0.30362499418492184, 'support': 1401566}}
[[ 56930 356468  52375]
 [ 48981 347060  66641]
 [ 31241 350982  90888]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.077664
{'0': {'precision': 0.505570055382265, 'recall': 0.1490485067624207, 'f1-score': 0.23022403022499652, 'support': 159854}, '1': {'precision': 0.37108385054252624, 'recall': 0.7489458118925838, 'f1-score': 0.4962755988454014, 'support': 193751}, '2': {'precision': 0.49054763510259125, 'recall': 0.24305683994487234, 'f1-score': 0.3250551546124416, 'support': 167611}, 'accuracy': 0.40227851792730845, 'macro avg': {'precision': 0.4557338470091275, 'recall': 0.3803503861999589, 'f1-score': 0.35051826122761315, 'support': 521216}, 'weighted avg': {'precision': 0.4507467967727813, 'recall': 0.40227851792730845, 'f1-score': 0.35961855583717284, 'support': 521216}}
[[ 23826 123998  12030]
 [ 18363 145109  30279]
 [  4938 121934  40739]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0917103
{'0': {'precision': 0.5088234119854673, 'recall': 0.15172746321253394, 'f1-score': 0.23375182267545833, 'support': 167992}, '1': {'precision': 0.3437123891712347, 'recall': 0.7280616306060084, 'f1-score': 0.4669712045669975, 'support': 179651}, '2': {'precision': 0.4894126738794436, 'recall': 0.2554026259844561, 'f1-score': 0.3356463867531317, 'support': 173573}, 'accuracy': 0.3849018449165029, 'macro avg': {'precision': 0.4473161583453819, 'recall': 0.3783972399343328, 'f1-score': 0.34545647133186247, 'support': 521216}, 'weighted avg': {'precision': 0.4454494165500307, 'recall': 0.384901844916503, 'f1-score': 0.3480695726041844, 'support': 521216}}
[[ 25489 126887  15616]
 [ 18221 130797  30633]
 [  6384 122858  44331]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1112915
{'0': {'precision': 0.49180080672522336, 'recall': 0.14716466062786945, 'f1-score': 0.2265402514412725, 'support': 177298}, '1': {'precision': 0.3045224671522249, 'recall': 0.7005028109171197, 'f1-score': 0.4245044356244167, 'support': 161691}, '2': {'precision': 0.4844261528388364, 'recall': 0.25578536660319273, 'f1-score': 0.33479381998664015, 'support': 182227}, 'accuracy': 0.3567964145383104, 'macro avg': {'precision': 0.4269164755720949, 'recall': 0.3678176127160606, 'f1-score': 0.32861283568410976, 'support': 521216}, 'weighted avg': {'precision': 0.43112522681660137, 'recall': 0.3567964145383104, 'f1-score': 0.3257999632307676, 'support': 521216}}
[[ 26092 131273  19933]
 [ 18751 113265  29675]
 [  8211 127405  46611]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1063079
{'0': {'precision': 0.42983435361901334, 'recall': 0.14037821500393974, 'f1-score': 0.21163819469685552, 'support': 170062}, '1': {'precision': 0.33671605940289995, 'recall': 0.6830021191036358, 'f1-score': 0.45106145395040115, 'support': 179793}, '2': {'precision': 0.43092691622103385, 'recall': 0.2539375937348638, 'f1-score': 0.31956260717262547, 'support': 171361}, 'accuracy': 0.3648909473231827, 'macro avg': {'precision': 0.39915910974764907, 'recall': 0.3591059759474798, 'f1-score': 0.32742075193996073, 'support': 521216}, 'weighted avg': {'precision': 0.39807248358441577, 'recall': 0.3648909473231827, 'f1-score': 0.32970951502707013, 'support': 521216}}
[[ 23873 123468  22721]
 [ 22250 122799  34744]
 [  9417 118429  43515]]
training model: results/AAPL/W3/deepOF_L1/seq2seq
Epoch 1/50
5475/5475 - 129s - loss: 12.6714 - accuracy10: 0.4518 - accuracy20: 0.4431 - accuracy30: 0.4388 - accuracy50: 0.4273 - val_loss: 12.9486 - val_accuracy10: 0.3874 - val_accuracy20: 0.3729 - val_accuracy30: 0.3549 - val_accuracy50: 0.3735 - 129s/epoch - 24ms/step
Epoch 2/50
5475/5475 - 134s - loss: 12.6399 - accuracy10: 0.4539 - accuracy20: 0.4461 - accuracy30: 0.4413 - accuracy50: 0.4307 - val_loss: 12.9535 - val_accuracy10: 0.3887 - val_accuracy20: 0.3736 - val_accuracy30: 0.3519 - val_accuracy50: 0.3725 - 134s/epoch - 24ms/step
Epoch 3/50
5475/5475 - 129s - loss: 12.6297 - accuracy10: 0.4544 - accuracy20: 0.4466 - accuracy30: 0.4419 - accuracy50: 0.4312 - val_loss: 12.9593 - val_accuracy10: 0.3892 - val_accuracy20: 0.3746 - val_accuracy30: 0.3528 - val_accuracy50: 0.3714 - 129s/epoch - 24ms/step
Epoch 4/50
5475/5475 - 133s - loss: 12.6237 - accuracy10: 0.4548 - accuracy20: 0.4468 - accuracy30: 0.4424 - accuracy50: 0.4313 - val_loss: 12.9710 - val_accuracy10: 0.3902 - val_accuracy20: 0.3750 - val_accuracy30: 0.3509 - val_accuracy50: 0.3677 - 133s/epoch - 24ms/step
Epoch 5/50
5475/5475 - 133s - loss: 12.6170 - accuracy10: 0.4559 - accuracy20: 0.4477 - accuracy30: 0.4432 - accuracy50: 0.4320 - val_loss: 12.9658 - val_accuracy10: 0.3915 - val_accuracy20: 0.3763 - val_accuracy30: 0.3528 - val_accuracy50: 0.3681 - 133s/epoch - 24ms/step
Epoch 6/50
5475/5475 - 130s - loss: 12.6115 - accuracy10: 0.4563 - accuracy20: 0.4476 - accuracy30: 0.4437 - accuracy50: 0.4322 - val_loss: 12.9761 - val_accuracy10: 0.3923 - val_accuracy20: 0.3775 - val_accuracy30: 0.3553 - val_accuracy50: 0.3689 - 130s/epoch - 24ms/step
Epoch 7/50
5475/5475 - 131s - loss: 12.6065 - accuracy10: 0.4567 - accuracy20: 0.4483 - accuracy30: 0.4442 - accuracy50: 0.4322 - val_loss: 12.9656 - val_accuracy10: 0.3935 - val_accuracy20: 0.3792 - val_accuracy30: 0.3584 - val_accuracy50: 0.3713 - 131s/epoch - 24ms/step
Epoch 8/50
5475/5475 - 127s - loss: 12.6029 - accuracy10: 0.4569 - accuracy20: 0.4484 - accuracy30: 0.4445 - accuracy50: 0.4324 - val_loss: 12.9628 - val_accuracy10: 0.3935 - val_accuracy20: 0.3815 - val_accuracy30: 0.3607 - val_accuracy50: 0.3716 - 127s/epoch - 23ms/step
Epoch 9/50
5475/5475 - 133s - loss: 12.5991 - accuracy10: 0.4572 - accuracy20: 0.4486 - accuracy30: 0.4450 - accuracy50: 0.4326 - val_loss: 12.9714 - val_accuracy10: 0.3930 - val_accuracy20: 0.3810 - val_accuracy30: 0.3596 - val_accuracy50: 0.3708 - 133s/epoch - 24ms/step
Epoch 10/50
5475/5475 - 131s - loss: 12.5951 - accuracy10: 0.4576 - accuracy20: 0.4489 - accuracy30: 0.4455 - accuracy50: 0.4329 - val_loss: 12.9700 - val_accuracy10: 0.3929 - val_accuracy20: 0.3821 - val_accuracy30: 0.3629 - val_accuracy50: 0.3726 - 131s/epoch - 24ms/step
Epoch 11/50
5475/5475 - 130s - loss: 12.5910 - accuracy10: 0.4577 - accuracy20: 0.4493 - accuracy30: 0.4458 - accuracy50: 0.4334 - val_loss: 12.9715 - val_accuracy10: 0.3938 - val_accuracy20: 0.3830 - val_accuracy30: 0.3633 - val_accuracy50: 0.3728 - 130s/epoch - 24ms/step
testing model: results/AAPL/W3/deepOF_L1/seq2seq
Evaluating performance on  test set...
13689/13689 - 122s - 122s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0661556
{'0': {'precision': 0.5030863909303998, 'recall': 0.2010368668968535, 'f1-score': 0.2872761570841513, 'support': 1071883}, '1': {'precision': 0.3832765238608219, 'recall': 0.8520977064516081, 'f1-score': 0.5287289291050794, 'support': 1333218}, '2': {'precision': 0.5091190163436363, 'recall': 0.05183593369731454, 'f1-score': 0.09409190371991248, 'support': 1099141}, 'accuracy': 0.401939991587339, 'macro avg': {'precision': 0.4651606437116193, 'recall': 0.36832350234859207, 'f1-score': 0.30336566330304776, 'support': 3504242}, 'weighted avg': {'precision': 0.45939592508202565, 'recall': 0.401939991587339, 'f1-score': 0.31854467346549, 'support': 3504242}}
[[ 215488  841607   14788]
 [ 157040 1136032   40146]
 [  55804  986362   56975]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0799379
{'0': {'precision': 0.5097670085515156, 'recall': 0.2528111289235723, 'f1-score': 0.3379975548384013, 'support': 1147137}, '1': {'precision': 0.34088226726184556, 'recall': 0.8233656861935476, 'f1-score': 0.48214946148241666, 'support': 1186706}, '2': {'precision': 0.5479469929826596, 'recall': 0.032290697445913744, 'f1-score': 0.06098738795727833, 'support': 1170399}, 'accuracy': 0.3723758233592315, 'macro avg': {'precision': 0.46619875626534024, 'recall': 0.3694891708543446, 'f1-score': 0.29371146809269877, 'support': 3504242}, 'weighted avg': {'precision': 0.46532637910906477, 'recall': 0.3723758233592315, 'f1-score': 0.294294383144892, 'support': 3504242}}
[[ 290009  847399    9729]
 [ 188163  977093   21450]
 [  90733 1041873   37793]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0967078
{'0': {'precision': 0.5017225571456195, 'recall': 0.31235351250599874, 'f1-score': 0.3850126760143966, 'support': 1221094}, '1': {'precision': 0.29671601329809705, 'recall': 0.7716131705483874, 'f1-score': 0.4286131788501652, 'support': 1037770}, '2': {'precision': 0.5571816435997616, 'recall': 0.020268544971888052, 'f1-score': 0.039114235043360826, 'support': 1245378}, 'accuracy': 0.3445572537513106, 'macro avg': {'precision': 0.4518734046811594, 'recall': 0.3680784093420914, 'f1-score': 0.28424669663597424, 'support': 3504242}, 'weighted avg': {'precision': 0.4607202191682319, 'recall': 0.3445572537513106, 'f1-score': 0.2749954412481473, 'support': 3504242}}
[[ 381413  832218    7463]
 [ 224415  800757   12598]
 [ 154379 1065757   25242]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870649
{'0': {'precision': 0.43381360346681147, 'recall': 0.3423682914604951, 'f1-score': 0.3827041656135589, 'support': 1143263}, '1': {'precision': 0.345189560200245, 'recall': 0.724660984976416, 'f1-score': 0.4676268247486469, 'support': 1213958}, '2': {'precision': 0.4676225371069653, 'recall': 0.021808667844790984, 'f1-score': 0.04167378166870052, 'support': 1147021}, 'accuracy': 0.36987742284922104, 'macro avg': {'precision': 0.41554190025800725, 'recall': 0.362945981427234, 'f1-score': 0.2973349240103021, 'support': 3504242}, 'weighted avg': {'precision': 0.41417845571076845, 'recall': 0.36987742284922104, 'f1-score': 0.30049623859695956, 'support': 3504242}}
[[391417 741400  10446]
 [316217 879708  18033]
 [194636 927370  25015]]
Evaluating performance on  train set...
5475/5475 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1057568
{'0': {'precision': 0.5287461323117725, 'recall': 0.11599152726810422, 'f1-score': 0.19024814360591075, 'support': 464077}, '1': {'precision': 0.3329268982953313, 'recall': 0.9106224774814486, 'f1-score': 0.4875893516596943, 'support': 465061}, '2': {'precision': 0.5232650411196076, 'recall': 0.0307073897131197, 'f1-score': 0.0580104808347879, 'support': 472427}, 'accuracy': 0.35091558365113285, 'macro avg': {'precision': 0.46164602390890375, 'recall': 0.3524404648208908, 'f1-score': 0.24528265870013097, 'support': 1401565}, 'weighted avg': {'precision': 0.46192275682825157, 'recall': 0.35091558365113285, 'f1-score': 0.2443370779391221, 'support': 1401565}}
[[ 53829 405765   4483]
 [ 32832 423495   8734]
 [ 15144 442776  14507]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896434
{'0': {'precision': 0.5153792151543276, 'recall': 0.18672831522676323, 'f1-score': 0.27413434092189287, 'support': 463920}, '1': {'precision': 0.33319402679960963, 'recall': 0.8702565029990657, 'f1-score': 0.4818881398162884, 'support': 464478}, '2': {'precision': 0.5291947464213684, 'recall': 0.022736158692385565, 'f1-score': 0.04359913758166227, 'support': 473167}, 'accuracy': 0.357885649256367, 'macro avg': {'precision': 0.4592559961251019, 'recall': 0.3599069923060714, 'f1-score': 0.2665405394399478, 'support': 1401565}, 'weighted avg': {'precision': 0.45966723716287466, 'recall': 0.357885649256367, 'f1-score': 0.26515539127916077, 'support': 1401565}}
[[ 86627 374116   3177]
 [ 53869 404215   6394]
 [ 27588 434821  10758]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0868249
{'0': {'precision': 0.47484786805071416, 'recall': 0.292055953940564, 'f1-score': 0.3616676383750545, 'support': 464096}, '1': {'precision': 0.3325500257008602, 'recall': 0.7885025238362311, 'f1-score': 0.4678041804110023, 'support': 463580}, '2': {'precision': 0.5129597921709866, 'recall': 0.018333407190291397, 'f1-score': 0.035401547595278166, 'support': 473889}, 'accuracy': 0.36371056640255717, 'macro avg': {'precision': 0.4401192286408537, 'recall': 0.36629729498902885, 'f1-score': 0.28829112212711167, 'support': 1401565}, 'weighted avg': {'precision': 0.44066778211312757, 'recall': 0.36371056640255717, 'f1-score': 0.2864580452869617, 'support': 1401565}}
[[135542 325844   2710]
 [ 92507 365534   5539]
 [ 57394 407807   8688]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0914648
{'0': {'precision': 0.4389244147157191, 'recall': 0.35231633904391285, 'f1-score': 0.3908803791383371, 'support': 465627}, '1': {'precision': 0.33121954743576365, 'recall': 0.7135347317090042, 'f1-score': 0.4524253322222709, 'support': 462632}, '2': {'precision': 0.4587435461629734, 'recall': 0.030223576291025258, 'f1-score': 0.056710849988800556, 'support': 473306}, 'accuracy': 0.362778037408183, 'macro avg': {'precision': 0.40962916943815203, 'recall': 0.36535821568131405, 'f1-score': 0.30000552044980283, 'support': 1401565}, 'weighted avg': {'precision': 0.4100658142721534, 'recall': 0.362778037408183, 'f1-score': 0.2983468338311097, 'support': 1401565}}
[[164048 294895   6684]
 [122334 330104  10194]
 [ 87368 371633  14305]]
Evaluating performance on  val set...
2036/2036 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0746181
{'0': {'precision': 0.5060598763945742, 'recall': 0.15772061812473812, 'f1-score': 0.24048937012191338, 'support': 159903}, '1': {'precision': 0.37194590020210194, 'recall': 0.8829054929846577, 'f1-score': 0.5233975595270896, 'support': 193647}, '2': {'precision': 0.4931261207411835, 'recall': 0.03444347691243305, 'f1-score': 0.06438952597044215, 'support': 167666}, 'accuracy': 0.38749194192043224, 'macro avg': {'precision': 0.4570439657792866, 'recall': 0.35835652934060963, 'f1-score': 0.27609215187314834, 'support': 521216}, 'weighted avg': {'precision': 0.45207204750381663, 'recall': 0.38749194192043224, 'f1-score': 0.2889498273685128, 'support': 521216}}
[[ 25220 133115   1568]
 [ 18307 170972   4368]
 [  6309 155582   5775]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0751202
{'0': {'precision': 0.5140538266310175, 'recall': 0.22575473103859336, 'f1-score': 0.31373003777085684, 'support': 167775}, '1': {'precision': 0.34666247997670013, 'recall': 0.8460820791914255, 'f1-score': 0.4918151327236514, 'support': 180070}, '2': {'precision': 0.5175841928669069, 'recall': 0.024023625635198505, 'f1-score': 0.04591606125081304, 'support': 173371}, 'accuracy': 0.3729643756139489, 'macro avg': {'precision': 0.45943349982487486, 'recall': 0.36528681195507245, 'f1-score': 0.28382041058177376, 'support': 521216}, 'weighted avg': {'precision': 0.4573976674429639, 'recall': 0.3729643756139489, 'f1-score': 0.28617256855443446, 'support': 521216}}
[[ 37876 128826   1073]
 [ 24907 152354   2809]
 [ 10898 158308   4165]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0873022
{'0': {'precision': 0.5028171172551812, 'recall': 0.31444388695647274, 'f1-score': 0.38692111323843614, 'support': 177383}, '1': {'precision': 0.3114179316829356, 'recall': 0.7784196333588976, 'f1-score': 0.44486231706045465, 'support': 161684}, '2': {'precision': 0.5211657440573103, 'recall': 0.017573524971314692, 'f1-score': 0.0340005629583995, 'support': 182149}, 'accuracy': 0.3546245702357564, 'macro avg': {'precision': 0.4451335976651423, 'recall': 0.37014568176222834, 'f1-score': 0.28859466441909676, 'support': 521216}, 'weighted avg': {'precision': 0.4498563449521783, 'recall': 0.3546245702357564, 'f1-score': 0.2815598815912896, 'support': 521216}}
[[ 55777 120693    913]
 [ 33798 125858   2028]
 [ 21354 157594   3201]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0827454
{'0': {'precision': 0.4442926138006825, 'recall': 0.36104958255239394, 'f1-score': 0.39836895041700027, 'support': 170201}, '1': {'precision': 0.3449585663167106, 'recall': 0.7158654113976938, 'f1-score': 0.46556999309823865, 'support': 179510}, '2': {'precision': 0.4603602735767267, 'recall': 0.027865076819917785, 'f1-score': 0.05254939907414534, 'support': 171505}, 'accuracy': 0.3736166963408644, 'macro avg': {'precision': 0.4165371512313733, 'recall': 0.3682600235900018, 'f1-score': 0.30549611419646144, 'support': 521216}, 'weighted avg': {'precision': 0.4153683849321188, 'recall': 0.3736166963408644, 'f1-score': 0.3077222262539906, 'support': 521216}}
[[ 61451 106672   2078]
 [ 47481 128505   3524]
 [ 29380 137346   4779]]
training model: results/AAPL/W3/deepLOB_L2/seq2seq
Epoch 1/50
5475/5475 - 269s - loss: 12.6361 - accuracy10: 0.4544 - accuracy20: 0.4410 - accuracy30: 0.4349 - accuracy50: 0.4226 - val_loss: 13.1241 - val_accuracy10: 0.4014 - val_accuracy20: 0.3868 - val_accuracy30: 0.3589 - val_accuracy50: 0.3664 - 269s/epoch - 49ms/step
Epoch 2/50
5475/5475 - 261s - loss: 12.4248 - accuracy10: 0.4787 - accuracy20: 0.4653 - accuracy30: 0.4555 - accuracy50: 0.4394 - val_loss: 12.8440 - val_accuracy10: 0.4184 - val_accuracy20: 0.4099 - val_accuracy30: 0.3903 - val_accuracy50: 0.3813 - 261s/epoch - 48ms/step
Epoch 3/50
5475/5475 - 260s - loss: 12.3532 - accuracy10: 0.4873 - accuracy20: 0.4725 - accuracy30: 0.4618 - accuracy50: 0.4442 - val_loss: 12.7190 - val_accuracy10: 0.4398 - val_accuracy20: 0.4275 - val_accuracy30: 0.4048 - val_accuracy50: 0.3908 - 260s/epoch - 48ms/step
Epoch 4/50
5475/5475 - 261s - loss: 12.3123 - accuracy10: 0.4919 - accuracy20: 0.4758 - accuracy30: 0.4650 - accuracy50: 0.4468 - val_loss: 12.9046 - val_accuracy10: 0.4364 - val_accuracy20: 0.4199 - val_accuracy30: 0.3954 - val_accuracy50: 0.3849 - 261s/epoch - 48ms/step
Epoch 5/50
5475/5475 - 260s - loss: 12.2813 - accuracy10: 0.4950 - accuracy20: 0.4783 - accuracy30: 0.4678 - accuracy50: 0.4486 - val_loss: 12.7901 - val_accuracy10: 0.4501 - val_accuracy20: 0.4319 - val_accuracy30: 0.4058 - val_accuracy50: 0.3929 - 260s/epoch - 47ms/step
Epoch 6/50
5475/5475 - 258s - loss: 12.2564 - accuracy10: 0.4981 - accuracy20: 0.4803 - accuracy30: 0.4695 - accuracy50: 0.4503 - val_loss: 12.8392 - val_accuracy10: 0.4442 - val_accuracy20: 0.4280 - val_accuracy30: 0.4050 - val_accuracy50: 0.3921 - 258s/epoch - 47ms/step
Epoch 7/50
5475/5475 - 256s - loss: 12.2341 - accuracy10: 0.5005 - accuracy20: 0.4820 - accuracy30: 0.4713 - accuracy50: 0.4515 - val_loss: 12.5261 - val_accuracy10: 0.4696 - val_accuracy20: 0.4570 - val_accuracy30: 0.4415 - val_accuracy50: 0.4173 - 256s/epoch - 47ms/step
Epoch 8/50
5475/5475 - 258s - loss: 12.2157 - accuracy10: 0.5025 - accuracy20: 0.4835 - accuracy30: 0.4727 - accuracy50: 0.4527 - val_loss: 12.6432 - val_accuracy10: 0.4586 - val_accuracy20: 0.4420 - val_accuracy30: 0.4216 - val_accuracy50: 0.4026 - 258s/epoch - 47ms/step
Epoch 9/50
5475/5475 - 256s - loss: 12.1999 - accuracy10: 0.5039 - accuracy20: 0.4846 - accuracy30: 0.4740 - accuracy50: 0.4536 - val_loss: 12.6876 - val_accuracy10: 0.4546 - val_accuracy20: 0.4368 - val_accuracy30: 0.4157 - val_accuracy50: 0.4011 - 256s/epoch - 47ms/step
Epoch 10/50
5475/5475 - 257s - loss: 12.1856 - accuracy10: 0.5053 - accuracy20: 0.4855 - accuracy30: 0.4751 - accuracy50: 0.4545 - val_loss: 12.7625 - val_accuracy10: 0.4504 - val_accuracy20: 0.4322 - val_accuracy30: 0.4128 - val_accuracy50: 0.3987 - 257s/epoch - 47ms/step
Epoch 11/50
5475/5475 - 259s - loss: 12.1736 - accuracy10: 0.5066 - accuracy20: 0.4866 - accuracy30: 0.4760 - accuracy50: 0.4553 - val_loss: 12.7416 - val_accuracy10: 0.4518 - val_accuracy20: 0.4352 - val_accuracy30: 0.4192 - val_accuracy50: 0.4034 - 259s/epoch - 47ms/step
Epoch 12/50
5475/5475 - 258s - loss: 12.1626 - accuracy10: 0.5073 - accuracy20: 0.4874 - accuracy30: 0.4770 - accuracy50: 0.4557 - val_loss: 12.7953 - val_accuracy10: 0.4527 - val_accuracy20: 0.4368 - val_accuracy30: 0.4220 - val_accuracy50: 0.4060 - 258s/epoch - 47ms/step
Epoch 13/50
5475/5475 - 257s - loss: 12.1517 - accuracy10: 0.5084 - accuracy20: 0.4881 - accuracy30: 0.4778 - accuracy50: 0.4567 - val_loss: 12.8145 - val_accuracy10: 0.4565 - val_accuracy20: 0.4434 - val_accuracy30: 0.4339 - val_accuracy50: 0.4132 - 257s/epoch - 47ms/step
Epoch 14/50
5475/5475 - 256s - loss: 12.1411 - accuracy10: 0.5093 - accuracy20: 0.4891 - accuracy30: 0.4788 - accuracy50: 0.4575 - val_loss: 13.2912 - val_accuracy10: 0.4382 - val_accuracy20: 0.4235 - val_accuracy30: 0.4101 - val_accuracy50: 0.3983 - 256s/epoch - 47ms/step
Epoch 15/50
5475/5475 - 257s - loss: 12.1312 - accuracy10: 0.5100 - accuracy20: 0.4898 - accuracy30: 0.4796 - accuracy50: 0.4582 - val_loss: 13.8227 - val_accuracy10: 0.4313 - val_accuracy20: 0.4197 - val_accuracy30: 0.4165 - val_accuracy50: 0.3980 - 257s/epoch - 47ms/step
Epoch 16/50
5475/5475 - 258s - loss: 12.1229 - accuracy10: 0.5105 - accuracy20: 0.4899 - accuracy30: 0.4804 - accuracy50: 0.4589 - val_loss: 13.9475 - val_accuracy10: 0.4279 - val_accuracy20: 0.4178 - val_accuracy30: 0.4151 - val_accuracy50: 0.3972 - 258s/epoch - 47ms/step
Epoch 17/50
5475/5475 - 273s - loss: 12.1133 - accuracy10: 0.5113 - accuracy20: 0.4909 - accuracy30: 0.4812 - accuracy50: 0.4599 - val_loss: 14.2337 - val_accuracy10: 0.4227 - val_accuracy20: 0.4136 - val_accuracy30: 0.4115 - val_accuracy50: 0.3955 - 273s/epoch - 50ms/step
testing model: results/AAPL/W3/deepLOB_L2/seq2seq
Evaluating performance on  test set...
13689/13689 - 237s - 237s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0335925
{'0': {'precision': 0.4613629542428048, 'recall': 0.5908506976028212, 'f1-score': 0.5181393016224681, 'support': 1071885}, '1': {'precision': 0.5125372287291594, 'recall': 0.16664116446072585, 'f1-score': 0.25150918074339146, 'support': 1333218}, '2': {'precision': 0.4430226853932121, 'recall': 0.6844204985156618, 'f1-score': 0.5378786470451122, 'support': 1099143}, 'accuracy': 0.45880597423811, 'macro avg': {'precision': 0.47230762278839206, 'recall': 0.4806374535264029, 'f1-score': 0.4358423764703239, 'support': 3504246}, 'weighted avg': {'precision': 0.47507999515774085, 'recall': 0.45880597423811, 'f1-score': 0.42288922124789413, 'support': 3504246}}
[[633324 106925 331636]
 [496908 222169 614141]
 [242492 104375 752276]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401601
{'0': {'precision': 0.4755271200626163, 'recall': 0.5502711090189515, 'f1-score': 0.5101760332725959, 'support': 1147140}, '1': {'precision': 0.4332030460829303, 'recall': 0.17707740832404292, 'f1-score': 0.25139416517275803, 'support': 1186707}, '2': {'precision': 0.45384062918399376, 'recall': 0.6559891114055976, 'f1-score': 0.5365048352371709, 'support': 1170399}, 'accuracy': 0.4591989261027907, 'macro avg': {'precision': 0.45419026510984684, 'recall': 0.4611125429161973, 'f1-score': 0.4326916778941749, 'support': 3504246}, 'weighted avg': {'precision': 0.4539509744101535, 'recall': 0.4591989261027907, 'f1-score': 0.4313336657970769, 'support': 3504246}}
[[631238 138410 377492]
 [430114 210139 546454]
 [266097 136533 767769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0509336
{'0': {'precision': 0.48714106440739957, 'recall': 0.5060969817278903, 'f1-score': 0.4964381365204273, 'support': 1221096}, '1': {'precision': 0.3634421966969541, 'recall': 0.19610858647178764, 'f1-score': 0.2547548412132137, 'support': 1037772}, '2': {'precision': 0.46498705589300016, 'recall': 0.6256437804425644, 'f1-score': 0.5334825493898757, 'support': 1245378}, 'accuracy': 0.45678071687889493, 'macro avg': {'precision': 0.43852343899911794, 'recall': 0.4426164495474141, 'f1-score': 0.42822517570783897, 'support': 3504246}, 'weighted avg': {'precision': 0.4426346752562811, 'recall': 0.45678071687889493, 'f1-score': 0.4380296058616123, 'support': 3504246}}
[[617993 178334 424769]
 [362522 203516 471734]
 [288097 178118 779163]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0705291
{'0': {'precision': 0.43638074028243384, 'recall': 0.4528189002549715, 'f1-score': 0.44444787851627493, 'support': 1143265}, '1': {'precision': 0.4081967982723816, 'recall': 0.22920049194412662, 'f1-score': 0.2935654368479277, 'support': 1213959}, '2': {'precision': 0.4157343197967589, 'recall': 0.5930653466106143, 'f1-score': 0.48881383822470054, 'support': 1147022}, 'accuracy': 0.42125781123813794, 'macro avg': {'precision': 0.42010395278385815, 'recall': 0.42502824626990415, 'f1-score': 0.40894238452963433, 'support': 3504246}, 'weighted avg': {'precision': 0.4198590552817516, 'recall': 0.42125781123813794, 'f1-score': 0.40670042409424306, 'support': 3504246}}
[[517692 204375 421198]
 [400893 278240 534826]
 [267746 199017 680259]]
Evaluating performance on  train set...
5475/5475 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0327214
{'0': {'precision': 0.46792594512930996, 'recall': 0.5640802374276089, 'f1-score': 0.5115236375292196, 'support': 463973}, '1': {'precision': 0.4679216709084408, 'recall': 0.23918082631264326, 'f1-score': 0.3165535190083797, 'support': 465054}, '2': {'precision': 0.47224648325327195, 'recall': 0.6041617728907032, 'f1-score': 0.5301209293688925, 'support': 472539}, 'accuracy': 0.46978879339253377, 'macro avg': {'precision': 0.46936469976367423, 'recall': 0.46914094554365177, 'f1-score': 0.452732695302164, 'support': 1401566}, 'weighted avg': {'precision': 0.4693811994812611, 'recall': 0.46978879339253377, 'f1-score': 0.4531006393900214, 'support': 1401566}}
[[261718  66342 135913]
 [170689 111232 183133]
 [126908  60141 285490]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0471354
{'0': {'precision': 0.4555612386132606, 'recall': 0.535664245219978, 'f1-score': 0.4923760960816968, 'support': 463910}, '1': {'precision': 0.4222821125079008, 'recall': 0.20704824009211134, 'f1-score': 0.2778596896079159, 'support': 464655}, '2': {'precision': 0.4557803205992414, 'recall': 0.6053877264530096, 'f1-score': 0.5200379201316307, 'support': 473001}, 'accuracy': 0.4502499347158821, 'macro avg': {'precision': 0.44454122390680095, 'recall': 0.44936673725503296, 'f1-score': 0.4300912352737478, 'support': 1401566}, 'weighted avg': {'precision': 0.4446022924473041, 'recall': 0.4502499347158821, 'f1-score': 0.43059373948012986, 'support': 1401566}}
[[248500  67757 147653]
 [174190  96206 194259]
 [122791  63861 286349]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0598357
{'0': {'precision': 0.44247595920903376, 'recall': 0.501710631770353, 'f1-score': 0.4702352165533006, 'support': 464156}, '1': {'precision': 0.39700816264191285, 'recall': 0.20182722461145597, 'f1-score': 0.2676096213405933, 'support': 463654}, '2': {'precision': 0.4414375395776817, 'recall': 0.5959354604479943, 'f1-score': 0.5071816663837294, 'support': 473756}, 'accuracy': 0.43435557084004606, 'macro avg': {'precision': 0.4269738871428761, 'recall': 0.43315777227660107, 'f1-score': 0.4150088347592078, 'support': 1401566}, 'weighted avg': {'precision': 0.4270836885058327, 'recall': 0.43435557084004606, 'f1-score': 0.4156929649312664, 'support': 1401566}}
[[232872  71649 159635]
 [172474  93578 197602]
 [120947  70481 282328]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721277
{'0': {'precision': 0.42816355006391826, 'recall': 0.45590019172429486, 'f1-score': 0.44159676579125506, 'support': 465773}, '1': {'precision': 0.39656421555812826, 'recall': 0.22950536221422058, 'f1-score': 0.29074600384419513, 'support': 462682}, '2': {'precision': 0.4214407776122913, 'recall': 0.5681880150746865, 'f1-score': 0.48393417950765155, 'support': 473111}, 'accuracy': 0.419066957959882, 'macro avg': {'precision': 0.41538951441144595, 'recall': 0.41786452300440063, 'f1-score': 0.4054256497143673, 'support': 1401566}, 'weighted avg': {'precision': 0.41546271336755886, 'recall': 0.419066957959882, 'f1-score': 0.40608960016479756, 'support': 1401566}}
[[212346  80147 173280]
 [160740 106188 195754]
 [122860  81435 268816]]
Evaluating performance on  val set...
2036/2036 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0196794
{'0': {'precision': 0.486245439277234, 'recall': 0.4727063445393922, 'f1-score': 0.4793803151079913, 'support': 159854}, '1': {'precision': 0.4565168760210688, 'recall': 0.3475801415218502, 'f1-score': 0.39466929216920427, 'support': 193751}, '2': {'precision': 0.467663172939495, 'recall': 0.6090829360841472, 'f1-score': 0.5290860233164987, 'support': 167611}, 'accuracy': 0.4700488856827112, 'macro avg': {'precision': 0.47014182941259924, 'recall': 0.4764564740484632, 'f1-score': 0.4677118768645647, 'support': 521216}, 'weighted avg': {'precision': 0.4692188493364416, 'recall': 0.4700488856827112, 'f1-score': 0.4638749930402174, 'support': 521216}}
[[ 75564  41896  42394]
 [ 52594  67344  73813]
 [ 27245  38277 102089]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0341184
{'0': {'precision': 0.4917298570552741, 'recall': 0.4535692175817896, 'f1-score': 0.4718792866941015, 'support': 167992}, '1': {'precision': 0.40697791453384713, 'recall': 0.31510539880100863, 'f1-score': 0.35519706852142924, 'support': 179651}, '2': {'precision': 0.4630378799550987, 'recall': 0.6060043900837112, 'f1-score': 0.5249614461318867, 'support': 173573}, 'accuracy': 0.4566072415275049, 'macro avg': {'precision': 0.45391521718140665, 'recall': 0.4582263354888365, 'f1-score': 0.4506792671158058, 'support': 521216}, 'weighted avg': {'precision': 0.4529629662324182, 'recall': 0.4566072415275049, 'f1-score': 0.44933882838728817, 'support': 521216}}
[[ 76196  42724  49072]
 [ 50135  56609  72907]
 [ 28624  39763 105186]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0525426
{'0': {'precision': 0.4910849458882329, 'recall': 0.4189669370212862, 'f1-score': 0.45216840810935016, 'support': 177298}, '1': {'precision': 0.3503146987883026, 'recall': 0.30360997210729107, 'f1-score': 0.3252944587095171, 'support': 161691}, '2': {'precision': 0.46482697403631523, 'recall': 0.5862303610332168, 'f1-score': 0.518517260125034, 'support': 182227}, 'accuracy': 0.4416595039292731, 'macro avg': {'precision': 0.4354088729042836, 'recall': 0.4362690900539314, 'f1-score': 0.4319933756479671, 'support': 521216}, 'weighted avg': {'precision': 0.4382350842943943, 'recall': 0.4416595039292731, 'f1-score': 0.43600654144342593, 'support': 521216}}
[[ 74282  46288  56728]
 [ 46334  49091  66266]
 [ 30645  44755 106827]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0670369
{'0': {'precision': 0.4481959985489857, 'recall': 0.37779162893532947, 'f1-score': 0.40999329951182156, 'support': 170062}, '1': {'precision': 0.38339743632033463, 'recall': 0.32323282886430504, 'f1-score': 0.35075383556848494, 'support': 179793}, '2': {'precision': 0.4214477946342951, 'recall': 0.5565385356061181, 'f1-score': 0.4796630202439331, 'support': 171361}, 'accuracy': 0.41773851915520627, 'macro avg': {'precision': 0.4176804098345385, 'recall': 0.4191876644685842, 'f1-score': 0.41347005177474655, 'support': 521216}, 'weighted avg': {'precision': 0.4170497427360383, 'recall': 0.41773851915520627, 'f1-score': 0.41246412173065417, 'support': 521216}}
[[64248 47407 58407]
 [49165 58115 72513]
 [29935 46057 95369]]
training model: results/AAPL/W3/deepOF_L2/seq2seq
Epoch 1/50
5475/5475 - 180s - loss: 12.4940 - accuracy10: 0.4719 - accuracy20: 0.4586 - accuracy30: 0.4498 - accuracy50: 0.4348 - val_loss: 12.7219 - val_accuracy10: 0.4382 - val_accuracy20: 0.4162 - val_accuracy30: 0.3916 - val_accuracy50: 0.3928 - 180s/epoch - 33ms/step
Epoch 2/50
5475/5475 - 164s - loss: 12.3636 - accuracy10: 0.4865 - accuracy20: 0.4705 - accuracy30: 0.4597 - accuracy50: 0.4427 - val_loss: 12.6384 - val_accuracy10: 0.4497 - val_accuracy20: 0.4271 - val_accuracy30: 0.4039 - val_accuracy50: 0.4010 - 164s/epoch - 30ms/step
Epoch 3/50
5475/5475 - 163s - loss: 12.3079 - accuracy10: 0.4923 - accuracy20: 0.4745 - accuracy30: 0.4638 - accuracy50: 0.4458 - val_loss: 12.5805 - val_accuracy10: 0.4585 - val_accuracy20: 0.4347 - val_accuracy30: 0.4124 - val_accuracy50: 0.4067 - 163s/epoch - 30ms/step
Epoch 4/50
5475/5475 - 169s - loss: 12.2686 - accuracy10: 0.4969 - accuracy20: 0.4779 - accuracy30: 0.4672 - accuracy50: 0.4485 - val_loss: 12.5164 - val_accuracy10: 0.4673 - val_accuracy20: 0.4436 - val_accuracy30: 0.4240 - val_accuracy50: 0.4138 - 169s/epoch - 31ms/step
Epoch 5/50
5475/5475 - 169s - loss: 12.2379 - accuracy10: 0.4998 - accuracy20: 0.4805 - accuracy30: 0.4698 - accuracy50: 0.4502 - val_loss: 12.4718 - val_accuracy10: 0.4729 - val_accuracy20: 0.4487 - val_accuracy30: 0.4300 - val_accuracy50: 0.4178 - 169s/epoch - 31ms/step
Epoch 6/50
5475/5475 - 164s - loss: 12.2150 - accuracy10: 0.5020 - accuracy20: 0.4823 - accuracy30: 0.4720 - accuracy50: 0.4517 - val_loss: 12.4256 - val_accuracy10: 0.4796 - val_accuracy20: 0.4571 - val_accuracy30: 0.4404 - val_accuracy50: 0.4257 - 164s/epoch - 30ms/step
Epoch 7/50
5475/5475 - 163s - loss: 12.1956 - accuracy10: 0.5043 - accuracy20: 0.4841 - accuracy30: 0.4736 - accuracy50: 0.4530 - val_loss: 12.3905 - val_accuracy10: 0.4824 - val_accuracy20: 0.4616 - val_accuracy30: 0.4461 - val_accuracy50: 0.4293 - 163s/epoch - 30ms/step
Epoch 8/50
5475/5475 - 168s - loss: 12.1793 - accuracy10: 0.5059 - accuracy20: 0.4853 - accuracy30: 0.4748 - accuracy50: 0.4543 - val_loss: 12.3570 - val_accuracy10: 0.4868 - val_accuracy20: 0.4661 - val_accuracy30: 0.4504 - val_accuracy50: 0.4322 - 168s/epoch - 31ms/step
Epoch 9/50
5475/5475 - 162s - loss: 12.1667 - accuracy10: 0.5072 - accuracy20: 0.4864 - accuracy30: 0.4760 - accuracy50: 0.4551 - val_loss: 12.3380 - val_accuracy10: 0.4887 - val_accuracy20: 0.4682 - val_accuracy30: 0.4539 - val_accuracy50: 0.4353 - 162s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 163s - loss: 12.1538 - accuracy10: 0.5079 - accuracy20: 0.4875 - accuracy30: 0.4770 - accuracy50: 0.4560 - val_loss: 12.3426 - val_accuracy10: 0.4886 - val_accuracy20: 0.4685 - val_accuracy30: 0.4531 - val_accuracy50: 0.4346 - 163s/epoch - 30ms/step
Epoch 11/50
5475/5475 - 157s - loss: 12.1439 - accuracy10: 0.5089 - accuracy20: 0.4880 - accuracy30: 0.4777 - accuracy50: 0.4564 - val_loss: 12.3115 - val_accuracy10: 0.4918 - val_accuracy20: 0.4725 - val_accuracy30: 0.4589 - val_accuracy50: 0.4383 - 157s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 157s - loss: 12.1336 - accuracy10: 0.5097 - accuracy20: 0.4888 - accuracy30: 0.4787 - accuracy50: 0.4574 - val_loss: 12.3318 - val_accuracy10: 0.4896 - val_accuracy20: 0.4706 - val_accuracy30: 0.4574 - val_accuracy50: 0.4367 - 157s/epoch - 29ms/step
Epoch 13/50
5475/5475 - 162s - loss: 12.1248 - accuracy10: 0.5102 - accuracy20: 0.4894 - accuracy30: 0.4794 - accuracy50: 0.4582 - val_loss: 12.3143 - val_accuracy10: 0.4930 - val_accuracy20: 0.4725 - val_accuracy30: 0.4584 - val_accuracy50: 0.4365 - 162s/epoch - 30ms/step
Epoch 14/50
5475/5475 - 154s - loss: 12.1153 - accuracy10: 0.5109 - accuracy20: 0.4900 - accuracy30: 0.4799 - accuracy50: 0.4586 - val_loss: 12.3152 - val_accuracy10: 0.4929 - val_accuracy20: 0.4734 - val_accuracy30: 0.4583 - val_accuracy50: 0.4370 - 154s/epoch - 28ms/step
Epoch 15/50
5475/5475 - 156s - loss: 12.1070 - accuracy10: 0.5114 - accuracy20: 0.4904 - accuracy30: 0.4806 - accuracy50: 0.4597 - val_loss: 12.3043 - val_accuracy10: 0.4927 - val_accuracy20: 0.4740 - val_accuracy30: 0.4599 - val_accuracy50: 0.4382 - 156s/epoch - 28ms/step
Epoch 16/50
5475/5475 - 158s - loss: 12.1001 - accuracy10: 0.5121 - accuracy20: 0.4911 - accuracy30: 0.4814 - accuracy50: 0.4599 - val_loss: 12.2894 - val_accuracy10: 0.4951 - val_accuracy20: 0.4758 - val_accuracy30: 0.4617 - val_accuracy50: 0.4388 - 158s/epoch - 29ms/step
Epoch 17/50
5475/5475 - 155s - loss: 12.0935 - accuracy10: 0.5126 - accuracy20: 0.4916 - accuracy30: 0.4818 - accuracy50: 0.4604 - val_loss: 12.3067 - val_accuracy10: 0.4940 - val_accuracy20: 0.4754 - val_accuracy30: 0.4620 - val_accuracy50: 0.4387 - 155s/epoch - 28ms/step
Epoch 18/50
5475/5475 - 157s - loss: 12.0865 - accuracy10: 0.5134 - accuracy20: 0.4924 - accuracy30: 0.4824 - accuracy50: 0.4611 - val_loss: 12.2963 - val_accuracy10: 0.4955 - val_accuracy20: 0.4761 - val_accuracy30: 0.4622 - val_accuracy50: 0.4388 - 157s/epoch - 29ms/step
Epoch 19/50
5475/5475 - 152s - loss: 12.0817 - accuracy10: 0.5134 - accuracy20: 0.4926 - accuracy30: 0.4828 - accuracy50: 0.4614 - val_loss: 12.2961 - val_accuracy10: 0.4963 - val_accuracy20: 0.4769 - val_accuracy30: 0.4614 - val_accuracy50: 0.4384 - 152s/epoch - 28ms/step
Epoch 20/50
5475/5475 - 155s - loss: 12.0739 - accuracy10: 0.5139 - accuracy20: 0.4934 - accuracy30: 0.4835 - accuracy50: 0.4622 - val_loss: 12.3053 - val_accuracy10: 0.4951 - val_accuracy20: 0.4761 - val_accuracy30: 0.4623 - val_accuracy50: 0.4389 - 155s/epoch - 28ms/step
Epoch 21/50
5475/5475 - 154s - loss: 12.0662 - accuracy10: 0.5146 - accuracy20: 0.4936 - accuracy30: 0.4842 - accuracy50: 0.4627 - val_loss: 12.3050 - val_accuracy10: 0.4947 - val_accuracy20: 0.4757 - val_accuracy30: 0.4613 - val_accuracy50: 0.4386 - 154s/epoch - 28ms/step
Epoch 22/50
5475/5475 - 159s - loss: 12.0605 - accuracy10: 0.5149 - accuracy20: 0.4945 - accuracy30: 0.4848 - accuracy50: 0.4632 - val_loss: 12.3071 - val_accuracy10: 0.4952 - val_accuracy20: 0.4762 - val_accuracy30: 0.4620 - val_accuracy50: 0.4380 - 159s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 158s - loss: 12.0549 - accuracy10: 0.5152 - accuracy20: 0.4943 - accuracy30: 0.4852 - accuracy50: 0.4637 - val_loss: 12.3096 - val_accuracy10: 0.4951 - val_accuracy20: 0.4766 - val_accuracy30: 0.4621 - val_accuracy50: 0.4387 - 158s/epoch - 29ms/step
Epoch 24/50
5475/5475 - 158s - loss: 12.0503 - accuracy10: 0.5154 - accuracy20: 0.4950 - accuracy30: 0.4853 - accuracy50: 0.4643 - val_loss: 12.3055 - val_accuracy10: 0.4955 - val_accuracy20: 0.4768 - val_accuracy30: 0.4627 - val_accuracy50: 0.4389 - 158s/epoch - 29ms/step
Epoch 25/50
5475/5475 - 158s - loss: 12.0437 - accuracy10: 0.5154 - accuracy20: 0.4952 - accuracy30: 0.4862 - accuracy50: 0.4647 - val_loss: 12.3028 - val_accuracy10: 0.4954 - val_accuracy20: 0.4774 - val_accuracy30: 0.4623 - val_accuracy50: 0.4384 - 158s/epoch - 29ms/step
Epoch 26/50
5475/5475 - 156s - loss: 12.0376 - accuracy10: 0.5164 - accuracy20: 0.4957 - accuracy30: 0.4865 - accuracy50: 0.4651 - val_loss: 12.3095 - val_accuracy10: 0.4958 - val_accuracy20: 0.4777 - val_accuracy30: 0.4629 - val_accuracy50: 0.4389 - 156s/epoch - 29ms/step
testing model: results/AAPL/W3/deepOF_L2/seq2seq
Evaluating performance on  test set...
13689/13689 - 140s - 140s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0124867
{'0': {'precision': 0.4982751586582049, 'recall': 0.41019215716640717, 'f1-score': 0.4499634904463683, 'support': 1071883}, '1': {'precision': 0.4392283011421445, 'recall': 0.636922843825991, 'f1-score': 0.5199168164442121, 'support': 1333218}, '2': {'precision': 0.5446496908716736, 'recall': 0.34119189439753406, 'f1-score': 0.41955596328222455, 'support': 1099141}, 'accuracy': 0.47481110037491703, 'macro avg': {'precision': 0.49405105022400764, 'recall': 0.4627689651299774, 'f1-score': 0.46314542339093495, 'support': 3504242}, 'weighted avg': {'precision': 0.49035613263996675, 'recall': 0.47481110037491703, 'f1-score': 0.4670401859387085, 'support': 3504242}}
[[439678 528435 103770]
 [274300 849157 209761]
 [168422 555701 375018]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0449182
{'0': {'precision': 0.5159023474997818, 'recall': 0.4122768248256311, 'f1-score': 0.45830500853499057, 'support': 1147137}, '1': {'precision': 0.3768231556206464, 'recall': 0.6014488845594443, 'f1-score': 0.4633473253155337, 'support': 1186706}, '2': {'precision': 0.5269737069810907, 'recall': 0.312211476599006, 'f1-score': 0.3921118780565667, 'support': 1170399}, 'accuracy': 0.44291832584621726, 'macro avg': {'precision': 0.47323307003383963, 'recall': 0.4419790619946939, 'f1-score': 0.4379214039690303, 'support': 3504242}, 'weighted avg': {'precision': 0.47250117731445873, 'recall': 0.44291832584621726, 'f1-score': 0.4379044123029251, 'support': 3504242}}
[[472938 548114 126085]
 [271044 713743 201919]
 [172738 632249 365412]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072934
{'0': {'precision': 0.5227204024901967, 'recall': 0.4050064941765335, 'f1-score': 0.4563954293181445, 'support': 1221094}, '1': {'precision': 0.3239408840593303, 'recall': 0.5824190331190919, 'f1-score': 0.4163232131202871, 'support': 1037770}, '2': {'precision': 0.5151356262467374, 'recall': 0.2863644612318509, 'f1-score': 0.3681011103455928, 'support': 1245378}, 'accuracy': 0.41538227097329466, 'macro avg': {'precision': 0.45393230426542147, 'recall': 0.42459666284249203, 'f1-score': 0.41360658426134145, 'support': 3504242}, 'weighted avg': {'precision': 0.46115692191136476, 'recall': 0.41538227097329466, 'f1-score': 0.41314911637028046, 'support': 3504242}}
[[494551 569829 156714]
 [254392 604417 178961]
 [197167 691579 356632]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0737053
{'0': {'precision': 0.4619053383367631, 'recall': 0.36714036927636073, 'f1-score': 0.40910674750593695, 'support': 1143263}, '1': {'precision': 0.3713082874541208, 'recall': 0.5866751568011414, 'f1-score': 0.45478311565823915, 'support': 1213958}, '2': {'precision': 0.44918459167586783, 'recall': 0.2652967992739453, 'f1-score': 0.3335768739794998, 'support': 1147021}, 'accuracy': 0.4098569676409335, 'macro avg': {'precision': 0.42746607248891727, 'recall': 0.4063707751171491, 'f1-score': 0.39915557904789195, 'support': 3504242}, 'weighted avg': {'precision': 0.42635642982784233, 'recall': 0.4098569676409335, 'f1-score': 0.4002074881132538, 'support': 3504242}}
[[419738 556118 167407]
 [296015 712199 205744]
 [192957 649763 304301]]
Evaluating performance on  train set...
5475/5475 - 53s - 53s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0190427
{'0': {'precision': 0.5079177624985208, 'recall': 0.45318557049799923, 'f1-score': 0.4789932425815297, 'support': 464077}, '1': {'precision': 0.4184799269700046, 'recall': 0.5283457438916616, 'f1-score': 0.46703864316961236, 'support': 465061}, '2': {'precision': 0.5222286056851676, 'recall': 0.4425424457111892, 'f1-score': 0.4790946495456405, 'support': 472427}, 'accuracy': 0.47453739212951235, 'macro avg': {'precision': 0.48287543171789765, 'recall': 0.47469125336695, 'f1-score': 0.4750421784322609, 'support': 1401565}, 'weighted avg': {'precision': 0.48306467290610855, 'recall': 0.47453739212951235, 'f1-score': 0.4750607024786649, 'support': 1401565}}
[[210313 172541  81223]
 [109300 245713 110048]
 [ 94456 168902 209069]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0339305
{'0': {'precision': 0.49356361272054694, 'recall': 0.47943610967408173, 'f1-score': 0.4863972988133104, 'support': 463920}, '1': {'precision': 0.3991464688014175, 'recall': 0.4345394184439306, 'f1-score': 0.41609166493152555, 'support': 464478}, '2': {'precision': 0.4897340879486143, 'recall': 0.4608499747446462, 'f1-score': 0.4748532000910252, 'support': 473167}, 'accuracy': 0.45828270540431587, 'macro avg': {'precision': 0.46081472315685956, 'recall': 0.4582751676208862, 'f1-score': 0.4591140546119537, 'support': 1401565}, 'weighted avg': {'precision': 0.4609809705162749, 'recall': 0.45828270540431587, 'f1-score': 0.4592007672401967, 'support': 1401565}}
[[222420 145844  95656]
 [131099 201834 131545]
 [ 97122 157986 218059]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0454962
{'0': {'precision': 0.47990984013158466, 'recall': 0.4752895952561539, 'f1-score': 0.47758854376415466, 'support': 464096}, '1': {'precision': 0.3934508173184298, 'recall': 0.39901419388239356, 'f1-score': 0.3962129771932549, 'support': 463580}, '2': {'precision': 0.4670476174327366, 'recall': 0.46499074677825397, 'f1-score': 0.46601691250101773, 'support': 473889}, 'accuracy': 0.4465786460135634, 'macro avg': {'precision': 0.44680275829425037, 'recall': 0.4464315119722671, 'f1-score': 0.4466061444861424, 'support': 1401565}, 'weighted avg': {'precision': 0.4469638550019212, 'recall': 0.4465786460135634, 'f1-score': 0.4467603239394627, 'support': 1401565}}
[[220580 132770 110746]
 [137903 184975 140702]
 [101145 152390 220354]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0617762
{'0': {'precision': 0.45768667642752564, 'recall': 0.43637933367266074, 'f1-score': 0.4467791072113741, 'support': 465627}, '1': {'precision': 0.384402154764381, 'recall': 0.39147313631568936, 'f1-score': 0.3879054246530745, 'support': 462632}, '2': {'precision': 0.43921656494810607, 'recall': 0.4514352237241869, 'f1-score': 0.44524208177090774, 'support': 473306}, 'accuracy': 0.42664093352787774, 'macro avg': {'precision': 0.4271017987133376, 'recall': 0.42642923123751225, 'f1-score': 0.4266422045451188, 'support': 1401565}, 'weighted avg': {'precision': 0.42725941874775897, 'recall': 0.42664093352787774, 'f1-score': 0.4268268874624244, 'support': 1401565}}
[[203190 135937 126500]
 [135218 181108 146306]
 [105542 154097 213667]]
Evaluating performance on  val set...
2036/2036 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99245507
{'0': {'precision': 0.5258061201097225, 'recall': 0.415970932377754, 'f1-score': 0.4644837362606668, 'support': 159903}, '1': {'precision': 0.46052448566784693, 'recall': 0.5984342644089503, 'f1-score': 0.5204992768660002, 'support': 193647}, '2': {'precision': 0.5292777366191868, 'recall': 0.4516598475540658, 'f1-score': 0.48739798676724244, 'support': 167666}, 'accuracy': 0.49524189587426326, 'macro avg': {'precision': 0.5052027807989187, 'recall': 0.48868834811359, 'f1-score': 0.49079366663130314, 'support': 521216}, 'weighted avg': {'precision': 0.502668839958902, 'recall': 0.49524189587426326, 'f1-score': 0.49266625966178357, 'support': 521216}}
[[ 66515  67540  25848]
 [ 36260 115885  41502]
 [ 23726  68212  75728]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0156643
{'0': {'precision': 0.5260853521806389, 'recall': 0.4418834748919684, 'f1-score': 0.4803221281709897, 'support': 167775}, '1': {'precision': 0.42204129368899285, 'recall': 0.521041817071139, 'f1-score': 0.4663452457875639, 'support': 180070}, '2': {'precision': 0.506317095402066, 'recall': 0.46138050769736577, 'f1-score': 0.4828054503478143, 'support': 173371}, 'accuracy': 0.4757164016453831, 'macro avg': {'precision': 0.48481458042389924, 'recall': 0.47476859988682435, 'f1-score': 0.47649094143545595, 'support': 521216}, 'weighted avg': {'precision': 0.48356467733844555, 'recall': 0.4757164016453831, 'f1-score': 0.47631940921826144, 'support': 521216}}
[[74137 61477 32161]
 [40413 93824 45833]
 [26372 67009 79990]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0372082
{'0': {'precision': 0.5278307682907788, 'recall': 0.43831708788328083, 'f1-score': 0.47892720306513414, 'support': 177383}, '1': {'precision': 0.38428208864485125, 'recall': 0.4925904851438609, 'f1-score': 0.43174733966140655, 'support': 161684}, '2': {'precision': 0.4987669580765746, 'recall': 0.45635715815074474, 'f1-score': 0.47662050973309245, 'support': 182149}, 'accuracy': 0.4614574379911591, 'macro avg': {'precision': 0.47029327167073487, 'recall': 0.46242157705929543, 'f1-score': 0.462431684153211, 'support': 521216}, 'weighted avg': {'precision': 0.4731442876635931, 'recall': 0.4614574379911591, 'f1-score': 0.46348563772886975, 'support': 521216}}
[[77750 59443 40190]
 [38694 79644 43346]
 [30857 68167 83125]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0522926
{'0': {'precision': 0.47656298935851843, 'recall': 0.4023125598557, 'f1-score': 0.4363013087637471, 'support': 170201}, '1': {'precision': 0.40588147556522114, 'recall': 0.46993482257255864, 'f1-score': 0.435565859212235, 'support': 179510}, '2': {'precision': 0.44470635378976275, 'recall': 0.44001049532083614, 'f1-score': 0.4423459623269705, 'support': 171505}, 'accuracy': 0.43800650785854617, 'macro avg': {'precision': 0.4423836062378341, 'recall': 0.4374192925830316, 'f1-score': 0.4380710434343176, 'support': 521216}, 'weighted avg': {'precision': 0.44173748357156206, 'recall': 0.43800650785854617, 'f1-score': 0.43803699561980813, 'support': 521216}}
[[68474 58214 43513]
 [44435 84358 50717]
 [30774 65267 75464]]
training model: results/AAPL/W3/deepVOL_L2/seq2seq
Epoch 1/50
5475/5475 - 161s - loss: 12.6625 - accuracy10: 0.4493 - accuracy20: 0.4382 - accuracy30: 0.4330 - accuracy50: 0.4225 - val_loss: 12.7853 - val_accuracy10: 0.4368 - val_accuracy20: 0.4239 - val_accuracy30: 0.3994 - val_accuracy50: 0.3964 - 161s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 151s - loss: 12.4421 - accuracy10: 0.4768 - accuracy20: 0.4639 - accuracy30: 0.4539 - accuracy50: 0.4387 - val_loss: 12.6331 - val_accuracy10: 0.4517 - val_accuracy20: 0.4373 - val_accuracy30: 0.4106 - val_accuracy50: 0.4016 - 151s/epoch - 28ms/step
Epoch 3/50
5475/5475 - 153s - loss: 12.3695 - accuracy10: 0.4848 - accuracy20: 0.4705 - accuracy30: 0.4605 - accuracy50: 0.4435 - val_loss: 12.5515 - val_accuracy10: 0.4643 - val_accuracy20: 0.4461 - val_accuracy30: 0.4190 - val_accuracy50: 0.4057 - 153s/epoch - 28ms/step
Epoch 4/50
5475/5475 - 150s - loss: 12.3255 - accuracy10: 0.4898 - accuracy20: 0.4745 - accuracy30: 0.4642 - accuracy50: 0.4459 - val_loss: 12.5253 - val_accuracy10: 0.4700 - val_accuracy20: 0.4501 - val_accuracy30: 0.4204 - val_accuracy50: 0.4044 - 150s/epoch - 27ms/step
Epoch 5/50
5475/5475 - 150s - loss: 12.2964 - accuracy10: 0.4926 - accuracy20: 0.4767 - accuracy30: 0.4670 - accuracy50: 0.4480 - val_loss: 12.5038 - val_accuracy10: 0.4737 - val_accuracy20: 0.4519 - val_accuracy30: 0.4211 - val_accuracy50: 0.4049 - 150s/epoch - 27ms/step
Epoch 6/50
5475/5475 - 151s - loss: 12.2726 - accuracy10: 0.4952 - accuracy20: 0.4790 - accuracy30: 0.4694 - accuracy50: 0.4501 - val_loss: 12.4953 - val_accuracy10: 0.4767 - val_accuracy20: 0.4539 - val_accuracy30: 0.4228 - val_accuracy50: 0.4055 - 151s/epoch - 28ms/step
Epoch 7/50
5475/5475 - 148s - loss: 12.2510 - accuracy10: 0.4970 - accuracy20: 0.4808 - accuracy30: 0.4713 - accuracy50: 0.4515 - val_loss: 12.4811 - val_accuracy10: 0.4780 - val_accuracy20: 0.4526 - val_accuracy30: 0.4182 - val_accuracy50: 0.4026 - 148s/epoch - 27ms/step
Epoch 8/50
5475/5475 - 148s - loss: 12.2333 - accuracy10: 0.4987 - accuracy20: 0.4820 - accuracy30: 0.4727 - accuracy50: 0.4527 - val_loss: 12.4747 - val_accuracy10: 0.4840 - val_accuracy20: 0.4570 - val_accuracy30: 0.4222 - val_accuracy50: 0.4046 - 148s/epoch - 27ms/step
Epoch 9/50
5475/5475 - 148s - loss: 12.2176 - accuracy10: 0.5003 - accuracy20: 0.4834 - accuracy30: 0.4741 - accuracy50: 0.4538 - val_loss: 12.4785 - val_accuracy10: 0.4829 - val_accuracy20: 0.4561 - val_accuracy30: 0.4207 - val_accuracy50: 0.4041 - 148s/epoch - 27ms/step
Epoch 10/50
5475/5475 - 151s - loss: 12.2042 - accuracy10: 0.5013 - accuracy20: 0.4843 - accuracy30: 0.4753 - accuracy50: 0.4546 - val_loss: 12.4476 - val_accuracy10: 0.4852 - val_accuracy20: 0.4581 - val_accuracy30: 0.4239 - val_accuracy50: 0.4057 - 151s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 149s - loss: 12.1915 - accuracy10: 0.5024 - accuracy20: 0.4855 - accuracy30: 0.4765 - accuracy50: 0.4559 - val_loss: 12.4494 - val_accuracy10: 0.4863 - val_accuracy20: 0.4590 - val_accuracy30: 0.4239 - val_accuracy50: 0.4057 - 149s/epoch - 27ms/step
Epoch 12/50
5475/5475 - 150s - loss: 12.1798 - accuracy10: 0.5031 - accuracy20: 0.4863 - accuracy30: 0.4774 - accuracy50: 0.4567 - val_loss: 12.4268 - val_accuracy10: 0.4885 - val_accuracy20: 0.4618 - val_accuracy30: 0.4256 - val_accuracy50: 0.4070 - 150s/epoch - 27ms/step
Epoch 13/50
5475/5475 - 149s - loss: 12.1689 - accuracy10: 0.5041 - accuracy20: 0.4871 - accuracy30: 0.4782 - accuracy50: 0.4575 - val_loss: 12.4344 - val_accuracy10: 0.4861 - val_accuracy20: 0.4616 - val_accuracy30: 0.4265 - val_accuracy50: 0.4084 - 149s/epoch - 27ms/step
Epoch 14/50
5475/5475 - 148s - loss: 12.1571 - accuracy10: 0.5051 - accuracy20: 0.4881 - accuracy30: 0.4794 - accuracy50: 0.4584 - val_loss: 12.4119 - val_accuracy10: 0.4892 - val_accuracy20: 0.4645 - val_accuracy30: 0.4286 - val_accuracy50: 0.4091 - 148s/epoch - 27ms/step
Epoch 15/50
5475/5475 - 149s - loss: 12.1478 - accuracy10: 0.5058 - accuracy20: 0.4889 - accuracy30: 0.4804 - accuracy50: 0.4593 - val_loss: 12.4248 - val_accuracy10: 0.4875 - val_accuracy20: 0.4630 - val_accuracy30: 0.4287 - val_accuracy50: 0.4101 - 149s/epoch - 27ms/step
Epoch 16/50
5475/5475 - 148s - loss: 12.1386 - accuracy10: 0.5067 - accuracy20: 0.4894 - accuracy30: 0.4809 - accuracy50: 0.4600 - val_loss: 12.4030 - val_accuracy10: 0.4885 - val_accuracy20: 0.4659 - val_accuracy30: 0.4330 - val_accuracy50: 0.4131 - 148s/epoch - 27ms/step
Epoch 17/50
5475/5475 - 150s - loss: 12.1302 - accuracy10: 0.5073 - accuracy20: 0.4898 - accuracy30: 0.4813 - accuracy50: 0.4603 - val_loss: 12.3947 - val_accuracy10: 0.4905 - val_accuracy20: 0.4679 - val_accuracy30: 0.4343 - val_accuracy50: 0.4139 - 150s/epoch - 27ms/step
Epoch 18/50
5475/5475 - 157s - loss: 12.1215 - accuracy10: 0.5079 - accuracy20: 0.4908 - accuracy30: 0.4822 - accuracy50: 0.4612 - val_loss: 12.3888 - val_accuracy10: 0.4912 - val_accuracy20: 0.4691 - val_accuracy30: 0.4369 - val_accuracy50: 0.4160 - 157s/epoch - 29ms/step
Epoch 19/50
5475/5475 - 150s - loss: 12.1139 - accuracy10: 0.5084 - accuracy20: 0.4913 - accuracy30: 0.4829 - accuracy50: 0.4620 - val_loss: 12.4050 - val_accuracy10: 0.4891 - val_accuracy20: 0.4667 - val_accuracy30: 0.4332 - val_accuracy50: 0.4126 - 150s/epoch - 27ms/step
Epoch 20/50
5475/5475 - 150s - loss: 12.1049 - accuracy10: 0.5092 - accuracy20: 0.4919 - accuracy30: 0.4837 - accuracy50: 0.4624 - val_loss: 12.3808 - val_accuracy10: 0.4912 - val_accuracy20: 0.4694 - val_accuracy30: 0.4382 - val_accuracy50: 0.4164 - 150s/epoch - 27ms/step
Epoch 21/50
5475/5475 - 148s - loss: 12.0983 - accuracy10: 0.5095 - accuracy20: 0.4925 - accuracy30: 0.4839 - accuracy50: 0.4629 - val_loss: 12.3842 - val_accuracy10: 0.4904 - val_accuracy20: 0.4701 - val_accuracy30: 0.4396 - val_accuracy50: 0.4174 - 148s/epoch - 27ms/step
Epoch 22/50
5475/5475 - 150s - loss: 12.0903 - accuracy10: 0.5101 - accuracy20: 0.4929 - accuracy30: 0.4848 - accuracy50: 0.4635 - val_loss: 12.3722 - val_accuracy10: 0.4917 - val_accuracy20: 0.4710 - val_accuracy30: 0.4430 - val_accuracy50: 0.4193 - 150s/epoch - 27ms/step
Epoch 23/50
5475/5475 - 150s - loss: 12.0837 - accuracy10: 0.5108 - accuracy20: 0.4935 - accuracy30: 0.4852 - accuracy50: 0.4642 - val_loss: 12.3648 - val_accuracy10: 0.4926 - val_accuracy20: 0.4724 - val_accuracy30: 0.4441 - val_accuracy50: 0.4200 - 150s/epoch - 27ms/step
Epoch 24/50
5475/5475 - 148s - loss: 12.0772 - accuracy10: 0.5112 - accuracy20: 0.4941 - accuracy30: 0.4860 - accuracy50: 0.4650 - val_loss: 12.3698 - val_accuracy10: 0.4912 - val_accuracy20: 0.4707 - val_accuracy30: 0.4427 - val_accuracy50: 0.4183 - 148s/epoch - 27ms/step
Epoch 25/50
5475/5475 - 149s - loss: 12.0691 - accuracy10: 0.5116 - accuracy20: 0.4946 - accuracy30: 0.4867 - accuracy50: 0.4654 - val_loss: 12.3713 - val_accuracy10: 0.4913 - val_accuracy20: 0.4708 - val_accuracy30: 0.4444 - val_accuracy50: 0.4205 - 149s/epoch - 27ms/step
Epoch 26/50
5475/5475 - 147s - loss: 12.0631 - accuracy10: 0.5117 - accuracy20: 0.4951 - accuracy30: 0.4870 - accuracy50: 0.4664 - val_loss: 12.3779 - val_accuracy10: 0.4922 - val_accuracy20: 0.4723 - val_accuracy30: 0.4453 - val_accuracy50: 0.4209 - 147s/epoch - 27ms/step
Epoch 27/50
5475/5475 - 148s - loss: 12.0560 - accuracy10: 0.5125 - accuracy20: 0.4956 - accuracy30: 0.4875 - accuracy50: 0.4666 - val_loss: 12.3724 - val_accuracy10: 0.4919 - val_accuracy20: 0.4728 - val_accuracy30: 0.4454 - val_accuracy50: 0.4205 - 148s/epoch - 27ms/step
Epoch 28/50
5475/5475 - 149s - loss: 12.0502 - accuracy10: 0.5125 - accuracy20: 0.4959 - accuracy30: 0.4880 - accuracy50: 0.4673 - val_loss: 12.3809 - val_accuracy10: 0.4909 - val_accuracy20: 0.4725 - val_accuracy30: 0.4469 - val_accuracy50: 0.4223 - 149s/epoch - 27ms/step
Epoch 29/50
5475/5475 - 148s - loss: 12.0435 - accuracy10: 0.5129 - accuracy20: 0.4964 - accuracy30: 0.4885 - accuracy50: 0.4679 - val_loss: 12.3693 - val_accuracy10: 0.4922 - val_accuracy20: 0.4738 - val_accuracy30: 0.4475 - val_accuracy50: 0.4219 - 148s/epoch - 27ms/step
Epoch 30/50
5475/5475 - 148s - loss: 12.0374 - accuracy10: 0.5136 - accuracy20: 0.4969 - accuracy30: 0.4889 - accuracy50: 0.4687 - val_loss: 12.3771 - val_accuracy10: 0.4924 - val_accuracy20: 0.4730 - val_accuracy30: 0.4458 - val_accuracy50: 0.4203 - 148s/epoch - 27ms/step
Epoch 31/50
5475/5475 - 148s - loss: 12.0297 - accuracy10: 0.5138 - accuracy20: 0.4973 - accuracy30: 0.4898 - accuracy50: 0.4695 - val_loss: 12.3818 - val_accuracy10: 0.4912 - val_accuracy20: 0.4724 - val_accuracy30: 0.4451 - val_accuracy50: 0.4191 - 148s/epoch - 27ms/step
Epoch 32/50
5475/5475 - 148s - loss: 12.0240 - accuracy10: 0.5141 - accuracy20: 0.4975 - accuracy30: 0.4905 - accuracy50: 0.4700 - val_loss: 12.3641 - val_accuracy10: 0.4927 - val_accuracy20: 0.4737 - val_accuracy30: 0.4489 - val_accuracy50: 0.4217 - 148s/epoch - 27ms/step
Epoch 33/50
5475/5475 - 147s - loss: 12.0185 - accuracy10: 0.5145 - accuracy20: 0.4977 - accuracy30: 0.4908 - accuracy50: 0.4706 - val_loss: 12.3942 - val_accuracy10: 0.4909 - val_accuracy20: 0.4715 - val_accuracy30: 0.4438 - val_accuracy50: 0.4166 - 147s/epoch - 27ms/step
Epoch 34/50
5475/5475 - 149s - loss: 12.0128 - accuracy10: 0.5144 - accuracy20: 0.4982 - accuracy30: 0.4915 - accuracy50: 0.4716 - val_loss: 12.3972 - val_accuracy10: 0.4912 - val_accuracy20: 0.4727 - val_accuracy30: 0.4458 - val_accuracy50: 0.4176 - 149s/epoch - 27ms/step
Epoch 35/50
5475/5475 - 149s - loss: 12.0047 - accuracy10: 0.5150 - accuracy20: 0.4991 - accuracy30: 0.4920 - accuracy50: 0.4724 - val_loss: 12.4204 - val_accuracy10: 0.4908 - val_accuracy20: 0.4721 - val_accuracy30: 0.4479 - val_accuracy50: 0.4192 - 149s/epoch - 27ms/step
Epoch 36/50
5475/5475 - 148s - loss: 11.9989 - accuracy10: 0.5151 - accuracy20: 0.4991 - accuracy30: 0.4928 - accuracy50: 0.4731 - val_loss: 12.4021 - val_accuracy10: 0.4899 - val_accuracy20: 0.4705 - val_accuracy30: 0.4452 - val_accuracy50: 0.4188 - 148s/epoch - 27ms/step
Epoch 37/50
5475/5475 - 148s - loss: 11.9916 - accuracy10: 0.5155 - accuracy20: 0.4996 - accuracy30: 0.4932 - accuracy50: 0.4735 - val_loss: 12.4261 - val_accuracy10: 0.4891 - val_accuracy20: 0.4705 - val_accuracy30: 0.4442 - val_accuracy50: 0.4178 - 148s/epoch - 27ms/step
Epoch 38/50
5475/5475 - 149s - loss: 11.9866 - accuracy10: 0.5155 - accuracy20: 0.5000 - accuracy30: 0.4939 - accuracy50: 0.4745 - val_loss: 12.4330 - val_accuracy10: 0.4892 - val_accuracy20: 0.4709 - val_accuracy30: 0.4457 - val_accuracy50: 0.4193 - 149s/epoch - 27ms/step
Epoch 39/50
5475/5475 - 148s - loss: 11.9796 - accuracy10: 0.5161 - accuracy20: 0.5009 - accuracy30: 0.4946 - accuracy50: 0.4752 - val_loss: 12.4308 - val_accuracy10: 0.4897 - val_accuracy20: 0.4709 - val_accuracy30: 0.4452 - val_accuracy50: 0.4161 - 148s/epoch - 27ms/step
Epoch 40/50
5475/5475 - 150s - loss: 11.9731 - accuracy10: 0.5165 - accuracy20: 0.5008 - accuracy30: 0.4948 - accuracy50: 0.4758 - val_loss: 12.4456 - val_accuracy10: 0.4890 - val_accuracy20: 0.4699 - val_accuracy30: 0.4454 - val_accuracy50: 0.4164 - 150s/epoch - 27ms/step
Epoch 41/50
5475/5475 - 149s - loss: 11.9669 - accuracy10: 0.5164 - accuracy20: 0.5015 - accuracy30: 0.4957 - accuracy50: 0.4765 - val_loss: 12.4313 - val_accuracy10: 0.4890 - val_accuracy20: 0.4710 - val_accuracy30: 0.4458 - val_accuracy50: 0.4168 - 149s/epoch - 27ms/step
Epoch 42/50
5475/5475 - 150s - loss: 11.9605 - accuracy10: 0.5167 - accuracy20: 0.5019 - accuracy30: 0.4961 - accuracy50: 0.4774 - val_loss: 12.4467 - val_accuracy10: 0.4876 - val_accuracy20: 0.4704 - val_accuracy30: 0.4456 - val_accuracy50: 0.4155 - 150s/epoch - 27ms/step
testing model: results/AAPL/W3/deepVOL_L2/seq2seq
Evaluating performance on  test set...
13689/13689 - 119s - 119s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9966766
{'0': {'precision': 0.5255492842421294, 'recall': 0.4203585272673841, 'f1-score': 0.4671049767057082, 'support': 1071885}, '1': {'precision': 0.44775890908771493, 'recall': 0.535282301919116, 'f1-score': 0.4876243577129113, 'support': 1333218}, '2': {'precision': 0.5095173115838193, 'recall': 0.4881648702671081, 'f1-score': 0.4986125979451953, 'support': 1099143}, 'accuracy': 0.4853503435546477, 'macro avg': {'precision': 0.4942751683045546, 'recall': 0.48126856648453603, 'f1-score': 0.4844473107879383, 'support': 3504246}, 'weighted avg': {'precision': 0.49092472908641516, 'recall': 0.4853503435546477, 'f1-score': 0.4847944281425351, 'support': 3504246}}
[[450576 453145 168164]
 [271216 713648 348354]
 [135551 427029 536563]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0242833
{'0': {'precision': 0.5256183662484126, 'recall': 0.43838415537772196, 'f1-score': 0.47805427552230506, 'support': 1147140}, '1': {'precision': 0.39110645861436694, 'recall': 0.4461210728511756, 'f1-score': 0.41680624766517566, 'support': 1186707}, '2': {'precision': 0.5015106499354612, 'recall': 0.5115622962767398, 'f1-score': 0.5064866072032809, 'support': 1170399}, 'accuracy': 0.4654453483003191, 'macro avg': {'precision': 0.47274515826608027, 'recall': 0.4653558415018791, 'f1-score': 0.4671157101302539, 'support': 3504246}, 'weighted avg': {'precision': 0.4720142900968989, 'recall': 0.4654453483003191, 'f1-score': 0.4668089774390175, 'support': 3504246}}
[[502888 419319 224933]
 [287100 529415 370192]
 [166767 404900 598732]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0523976
{'0': {'precision': 0.5366277628834595, 'recall': 0.3883249146668239, 'f1-score': 0.4505872252437249, 'support': 1221096}, '1': {'precision': 0.33211117877842544, 'recall': 0.4634775268556099, 'f1-score': 0.38694885106157034, 'support': 1037772}, '2': {'precision': 0.5050654624766815, 'recall': 0.47544922103971643, 'f1-score': 0.4898100655615249, 'support': 1245378}, 'accuracy': 0.4415443436334093, 'macro avg': {'precision': 0.45793480137952214, 'recall': 0.44241722085405005, 'f1-score': 0.44244871395560675, 'support': 3504246}, 'weighted avg': {'precision': 0.4648438244625147, 'recall': 0.4415443436334093, 'f1-score': 0.44568036070782713, 'support': 3504246}}
[[474182 487558 259356]
 [235907 480984 320881]
 [173544 479720 592114]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0683619
{'0': {'precision': 0.48961106101963003, 'recall': 0.2783335447162294, 'f1-score': 0.35490888568788426, 'support': 1143265}, '1': {'precision': 0.3702658255291922, 'recall': 0.5767954271931753, 'f1-score': 0.4510112400802692, 'support': 1213959}, '2': {'precision': 0.4557397267953581, 'recall': 0.38271628617411, 'f1-score': 0.4160481003252686, 'support': 1147022}, 'accuracy': 0.41589517402602444, 'macro avg': {'precision': 0.4385388711147267, 'recall': 0.4126150860278382, 'f1-score': 0.4073227420311407, 'support': 3504246}, 'weighted avg': {'precision': 0.4371799850462739, 'recall': 0.41589517402602444, 'f1-score': 0.4082134602775755, 'support': 3504246}}
[[318209 608304 216752]
 [206255 700206 307498]
 [125458 582580 438984]]
Evaluating performance on  train set...
5475/5475 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0109047
{'0': {'precision': 0.527487446391512, 'recall': 0.45304144853256545, 'f1-score': 0.4874383162659543, 'support': 463973}, '1': {'precision': 0.42388811155596107, 'recall': 0.4605615691941151, 'f1-score': 0.44146451306393725, 'support': 465054}, '2': {'precision': 0.5092449365791726, 'recall': 0.536453075830778, 'f1-score': 0.5224950403215417, 'support': 472539}, 'accuracy': 0.48365899286940467, 'macro avg': {'precision': 0.48687349817554854, 'recall': 0.4833520311858195, 'f1-score': 0.48379928988381105, 'support': 1401566}, 'weighted avg': {'precision': 0.4869616471021276, 'recall': 0.48365899286940467, 'f1-score': 0.4840031360847801, 'support': 1401566}}
[[210199 153965  99809]
 [106386 214186 144482]
 [ 81906 137138 253495]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0273749
{'0': {'precision': 0.5159663741829104, 'recall': 0.4532754198012546, 'f1-score': 0.482593458748253, 'support': 463910}, '1': {'precision': 0.3964710797810227, 'recall': 0.39822879340586026, 'f1-score': 0.39734799274187493, 'support': 464655}, '2': {'precision': 0.4880382775119617, 'recall': 0.5440707313515193, 'f1-score': 0.5145335236747082, 'support': 473001}, 'accuracy': 0.46566768885660753, 'macro avg': {'precision': 0.4668252438252982, 'recall': 0.46519164818621145, 'f1-score': 0.46482499172161207, 'support': 1401566}, 'weighted avg': {'precision': 0.46692544163049077, 'recall': 0.46566768885660753, 'f1-score': 0.46511154968587887, 'support': 1401566}}
[[210279 145668 107963]
 [117618 185039 161998]
 [ 79647 136008 257346]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0442163
{'0': {'precision': 0.5115365136121728, 'recall': 0.3982152552159188, 'f1-score': 0.4478180758752106, 'support': 464156}, '1': {'precision': 0.37737079405298657, 'recall': 0.4368559313626109, 'f1-score': 0.4049404534613363, 'support': 463654}, '2': {'precision': 0.4731923852272614, 'recall': 0.5028960055387162, 'f1-score': 0.4875922357715674, 'support': 473756}, 'accuracy': 0.44638211828768676, 'macro avg': {'precision': 0.4540332309641402, 'recall': 0.44598906403908195, 'f1-score': 0.44678358836937143, 'support': 1401566}, 'weighted avg': {'precision': 0.45419191947702897, 'recall': 0.44638211828768676, 'f1-score': 0.4470780934221373, 'support': 1401566}}
[[184834 170648 108674]
 [104533 202550 156571]
 [ 71964 163542 238250]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0660508
{'0': {'precision': 0.4987910039037464, 'recall': 0.29407458139479964, 'f1-score': 0.37000409248751664, 'support': 465773}, '1': {'precision': 0.3626523312844017, 'recall': 0.5489493864036207, 'f1-score': 0.43676480830095427, 'support': 462682}, '2': {'precision': 0.4596442041946305, 'recall': 0.4144503087013407, 'f1-score': 0.4358789112863786, 'support': 473111}, 'accuracy': 0.4188472037706394, 'macro avg': {'precision': 0.44036251312759284, 'recall': 0.419158092166587, 'f1-score': 0.41421593735828316, 'support': 1401566}, 'weighted avg': {'precision': 0.44063484509135853, 'recall': 0.4188472037706394, 'f1-score': 0.41427962636229765, 'support': 1401566}}
[[136972 228349 100452]
 [ 78633 253989 130060]
 [ 59003 218027 196081]]
Evaluating performance on  val set...
2036/2036 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9939067
{'0': {'precision': 0.5286412881110745, 'recall': 0.42063382836838614, 'f1-score': 0.4684930743290321, 'support': 159854}, '1': {'precision': 0.4586813029769826, 'recall': 0.5300979091720817, 'f1-score': 0.4918105006596132, 'support': 193751}, '2': {'precision': 0.5113224850679584, 'recall': 0.5189277553382534, 'f1-score': 0.5150970492871207, 'support': 167611}, 'accuracy': 0.49293383165520627, 'macro avg': {'precision': 0.4995483587186718, 'recall': 0.4898864976262404, 'f1-score': 0.491800208091922, 'support': 521216}, 'weighted avg': {'precision': 0.49706582040368413, 'recall': 0.49293383165520627, 'f1-score': 0.49214759283129716, 'support': 521216}}
[[ 67240  63266  29348]
 [ 37266 102707  53778]
 [ 22688  57945  86978]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0173671
{'0': {'precision': 0.5307908881494753, 'recall': 0.4320622410590981, 'f1-score': 0.4763648654413478, 'support': 167992}, '1': {'precision': 0.4136519154186999, 'recall': 0.45156998847765945, 'f1-score': 0.43178007823934855, 'support': 179651}, '2': {'precision': 0.4968622579001019, 'recall': 0.5391679581501732, 'f1-score': 0.5171513435103958, 'support': 173573}, 'accuracy': 0.47445396917976423, 'macro avg': {'precision': 0.48043502048942566, 'recall': 0.4742667292289769, 'f1-score': 0.4750987623970307, 'support': 521216}, 'weighted avg': {'precision': 0.47911705670851606, 'recall': 0.47445396917976423, 'f1-score': 0.47458005789946983, 'support': 521216}}
[[72583 59518 35891]
 [39650 81125 58876]
 [24512 55476 93585]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.045778
{'0': {'precision': 0.5391359808821036, 'recall': 0.37664835474737446, 'f1-score': 0.44347707704516853, 'support': 177298}, '1': {'precision': 0.35726626182795446, 'recall': 0.4719248443017855, 'f1-score': 0.40666819443926305, 'support': 161691}, '2': {'precision': 0.49425912825814877, 'recall': 0.4984442481081289, 'f1-score': 0.4963428661983568, 'support': 182227}, 'accuracy': 0.4487870671660118, 'macro avg': {'precision': 0.4635537903227356, 'recall': 0.4490058157190963, 'f1-score': 0.44882937922759614, 'support': 521216}, 'weighted avg': {'precision': 0.4670267767005553, 'recall': 0.4487870671660118, 'f1-score': 0.4505411524430584, 'support': 521216}}
[[66779 69903 40616]
 [33061 76306 52324]
 [24023 67374 90830]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0640181
{'0': {'precision': 0.5013388192267503, 'recall': 0.27083651844621376, 'f1-score': 0.3516840120030236, 'support': 170062}, '1': {'precision': 0.37651954400948645, 'recall': 0.5757287547346115, 'f1-score': 0.45528698448025234, 'support': 179793}, '2': {'precision': 0.4553961120536697, 'recall': 0.41039092909121677, 'f1-score': 0.43172379499488933, 'support': 171361}, 'accuracy': 0.42189034872298625, 'macro avg': {'precision': 0.44441815842996873, 'recall': 0.4189854007573473, 'f1-score': 0.41289826382605516, 'support': 521216}, 'weighted avg': {'precision': 0.4431778644728214, 'recall': 0.42189034872298625, 'f1-score': 0.4137365707960528, 'support': 521216}}
[[ 46059  88354  35649]
 [ 27829 103512  48452]
 [ 17984  83052  70325]]
training model: results/AAPL/W3/deepVOL_L3/seq2seq
Epoch 1/50
5475/5475 - 230s - loss: 12.6579 - accuracy10: 0.4504 - accuracy20: 0.4390 - accuracy30: 0.4343 - accuracy50: 0.4245 - val_loss: 12.8174 - val_accuracy10: 0.4168 - val_accuracy20: 0.4043 - val_accuracy30: 0.3801 - val_accuracy50: 0.3853 - 230s/epoch - 42ms/step
Epoch 2/50
5475/5475 - 221s - loss: 12.4543 - accuracy10: 0.4746 - accuracy20: 0.4622 - accuracy30: 0.4523 - accuracy50: 0.4371 - val_loss: 12.8001 - val_accuracy10: 0.4278 - val_accuracy20: 0.4132 - val_accuracy30: 0.3869 - val_accuracy50: 0.3877 - 221s/epoch - 40ms/step
Epoch 3/50
5475/5475 - 224s - loss: 12.3964 - accuracy10: 0.4809 - accuracy20: 0.4678 - accuracy30: 0.4574 - accuracy50: 0.4406 - val_loss: 12.6775 - val_accuracy10: 0.4344 - val_accuracy20: 0.4207 - val_accuracy30: 0.3934 - val_accuracy50: 0.3918 - 224s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 219s - loss: 12.3596 - accuracy10: 0.4852 - accuracy20: 0.4710 - accuracy30: 0.4606 - accuracy50: 0.4431 - val_loss: 12.6443 - val_accuracy10: 0.4402 - val_accuracy20: 0.4259 - val_accuracy30: 0.3989 - val_accuracy50: 0.3953 - 219s/epoch - 40ms/step
Epoch 5/50
5475/5475 - 221s - loss: 12.3273 - accuracy10: 0.4890 - accuracy20: 0.4738 - accuracy30: 0.4632 - accuracy50: 0.4448 - val_loss: 12.6024 - val_accuracy10: 0.4504 - val_accuracy20: 0.4326 - val_accuracy30: 0.4029 - val_accuracy50: 0.3963 - 221s/epoch - 40ms/step
Epoch 6/50
5475/5475 - 217s - loss: 12.2988 - accuracy10: 0.4919 - accuracy20: 0.4764 - accuracy30: 0.4665 - accuracy50: 0.4471 - val_loss: 12.5625 - val_accuracy10: 0.4623 - val_accuracy20: 0.4415 - val_accuracy30: 0.4112 - val_accuracy50: 0.4002 - 217s/epoch - 40ms/step
Epoch 7/50
5475/5475 - 219s - loss: 12.2747 - accuracy10: 0.4948 - accuracy20: 0.4786 - accuracy30: 0.4684 - accuracy50: 0.4487 - val_loss: 12.5117 - val_accuracy10: 0.4670 - val_accuracy20: 0.4455 - val_accuracy30: 0.4138 - val_accuracy50: 0.4011 - 219s/epoch - 40ms/step
Epoch 8/50
5475/5475 - 218s - loss: 12.2531 - accuracy10: 0.4969 - accuracy20: 0.4802 - accuracy30: 0.4708 - accuracy50: 0.4504 - val_loss: 12.5048 - val_accuracy10: 0.4743 - val_accuracy20: 0.4502 - val_accuracy30: 0.4178 - val_accuracy50: 0.4027 - 218s/epoch - 40ms/step
Epoch 9/50
5475/5475 - 221s - loss: 12.2342 - accuracy10: 0.4991 - accuracy20: 0.4821 - accuracy30: 0.4724 - accuracy50: 0.4515 - val_loss: 12.4610 - val_accuracy10: 0.4790 - val_accuracy20: 0.4551 - val_accuracy30: 0.4234 - val_accuracy50: 0.4074 - 221s/epoch - 40ms/step
Epoch 10/50
5475/5475 - 220s - loss: 12.2192 - accuracy10: 0.5002 - accuracy20: 0.4827 - accuracy30: 0.4735 - accuracy50: 0.4527 - val_loss: 12.4508 - val_accuracy10: 0.4815 - val_accuracy20: 0.4568 - val_accuracy30: 0.4270 - val_accuracy50: 0.4093 - 220s/epoch - 40ms/step
Epoch 11/50
5475/5475 - 218s - loss: 12.2056 - accuracy10: 0.5017 - accuracy20: 0.4841 - accuracy30: 0.4747 - accuracy50: 0.4537 - val_loss: 12.4383 - val_accuracy10: 0.4829 - val_accuracy20: 0.4579 - val_accuracy30: 0.4259 - val_accuracy50: 0.4080 - 218s/epoch - 40ms/step
Epoch 12/50
5475/5475 - 222s - loss: 12.1941 - accuracy10: 0.5024 - accuracy20: 0.4848 - accuracy30: 0.4754 - accuracy50: 0.4545 - val_loss: 12.4327 - val_accuracy10: 0.4860 - val_accuracy20: 0.4593 - val_accuracy30: 0.4284 - val_accuracy50: 0.4090 - 222s/epoch - 41ms/step
Epoch 13/50
5475/5475 - 220s - loss: 12.1823 - accuracy10: 0.5034 - accuracy20: 0.4857 - accuracy30: 0.4768 - accuracy50: 0.4556 - val_loss: 12.3986 - val_accuracy10: 0.4881 - val_accuracy20: 0.4639 - val_accuracy30: 0.4343 - val_accuracy50: 0.4127 - 220s/epoch - 40ms/step
Epoch 14/50
5475/5475 - 220s - loss: 12.1712 - accuracy10: 0.5043 - accuracy20: 0.4868 - accuracy30: 0.4780 - accuracy50: 0.4564 - val_loss: 12.4130 - val_accuracy10: 0.4893 - val_accuracy20: 0.4634 - val_accuracy30: 0.4321 - val_accuracy50: 0.4114 - 220s/epoch - 40ms/step
Epoch 15/50
5475/5475 - 224s - loss: 12.1629 - accuracy10: 0.5047 - accuracy20: 0.4876 - accuracy30: 0.4789 - accuracy50: 0.4569 - val_loss: 12.4161 - val_accuracy10: 0.4896 - val_accuracy20: 0.4652 - val_accuracy30: 0.4356 - val_accuracy50: 0.4123 - 224s/epoch - 41ms/step
Epoch 16/50
5475/5475 - 215s - loss: 12.1532 - accuracy10: 0.5058 - accuracy20: 0.4882 - accuracy30: 0.4798 - accuracy50: 0.4578 - val_loss: 12.3920 - val_accuracy10: 0.4893 - val_accuracy20: 0.4666 - val_accuracy30: 0.4379 - val_accuracy50: 0.4140 - 215s/epoch - 39ms/step
Epoch 17/50
5475/5475 - 218s - loss: 12.1437 - accuracy10: 0.5062 - accuracy20: 0.4891 - accuracy30: 0.4803 - accuracy50: 0.4586 - val_loss: 12.3803 - val_accuracy10: 0.4897 - val_accuracy20: 0.4676 - val_accuracy30: 0.4391 - val_accuracy50: 0.4139 - 218s/epoch - 40ms/step
Epoch 18/50
5475/5475 - 220s - loss: 12.1360 - accuracy10: 0.5070 - accuracy20: 0.4896 - accuracy30: 0.4810 - accuracy50: 0.4588 - val_loss: 12.3939 - val_accuracy10: 0.4890 - val_accuracy20: 0.4683 - val_accuracy30: 0.4417 - val_accuracy50: 0.4155 - 220s/epoch - 40ms/step
Epoch 19/50
5475/5475 - 221s - loss: 12.1283 - accuracy10: 0.5075 - accuracy20: 0.4901 - accuracy30: 0.4817 - accuracy50: 0.4597 - val_loss: 12.3793 - val_accuracy10: 0.4919 - val_accuracy20: 0.4697 - val_accuracy30: 0.4410 - val_accuracy50: 0.4141 - 221s/epoch - 40ms/step
Epoch 20/50
5475/5475 - 218s - loss: 12.1218 - accuracy10: 0.5079 - accuracy20: 0.4904 - accuracy30: 0.4822 - accuracy50: 0.4606 - val_loss: 12.3885 - val_accuracy10: 0.4900 - val_accuracy20: 0.4682 - val_accuracy30: 0.4417 - val_accuracy50: 0.4149 - 218s/epoch - 40ms/step
Epoch 21/50
5475/5475 - 224s - loss: 12.1133 - accuracy10: 0.5084 - accuracy20: 0.4912 - accuracy30: 0.4830 - accuracy50: 0.4609 - val_loss: 12.3922 - val_accuracy10: 0.4900 - val_accuracy20: 0.4695 - val_accuracy30: 0.4440 - val_accuracy50: 0.4167 - 224s/epoch - 41ms/step
Epoch 22/50
5475/5475 - 217s - loss: 12.1064 - accuracy10: 0.5090 - accuracy20: 0.4915 - accuracy30: 0.4834 - accuracy50: 0.4614 - val_loss: 12.4147 - val_accuracy10: 0.4885 - val_accuracy20: 0.4672 - val_accuracy30: 0.4410 - val_accuracy50: 0.4149 - 217s/epoch - 40ms/step
Epoch 23/50
5475/5475 - 219s - loss: 12.0999 - accuracy10: 0.5095 - accuracy20: 0.4921 - accuracy30: 0.4840 - accuracy50: 0.4620 - val_loss: 12.3873 - val_accuracy10: 0.4916 - val_accuracy20: 0.4717 - val_accuracy30: 0.4464 - val_accuracy50: 0.4170 - 219s/epoch - 40ms/step
Epoch 24/50
5475/5475 - 222s - loss: 12.0927 - accuracy10: 0.5101 - accuracy20: 0.4926 - accuracy30: 0.4847 - accuracy50: 0.4631 - val_loss: 12.4016 - val_accuracy10: 0.4902 - val_accuracy20: 0.4708 - val_accuracy30: 0.4457 - val_accuracy50: 0.4170 - 222s/epoch - 41ms/step
Epoch 25/50
5475/5475 - 220s - loss: 12.0856 - accuracy10: 0.5105 - accuracy20: 0.4935 - accuracy30: 0.4856 - accuracy50: 0.4638 - val_loss: 12.3606 - val_accuracy10: 0.4915 - val_accuracy20: 0.4726 - val_accuracy30: 0.4473 - val_accuracy50: 0.4175 - 220s/epoch - 40ms/step
Epoch 26/50
5475/5475 - 222s - loss: 12.0798 - accuracy10: 0.5110 - accuracy20: 0.4937 - accuracy30: 0.4862 - accuracy50: 0.4642 - val_loss: 12.4073 - val_accuracy10: 0.4905 - val_accuracy20: 0.4710 - val_accuracy30: 0.4443 - val_accuracy50: 0.4137 - 222s/epoch - 40ms/step
Epoch 27/50
5475/5475 - 219s - loss: 12.0718 - accuracy10: 0.5111 - accuracy20: 0.4939 - accuracy30: 0.4866 - accuracy50: 0.4649 - val_loss: 12.3713 - val_accuracy10: 0.4932 - val_accuracy20: 0.4749 - val_accuracy30: 0.4484 - val_accuracy50: 0.4171 - 219s/epoch - 40ms/step
Epoch 28/50
5475/5475 - 219s - loss: 12.0650 - accuracy10: 0.5118 - accuracy20: 0.4950 - accuracy30: 0.4875 - accuracy50: 0.4655 - val_loss: 12.3747 - val_accuracy10: 0.4915 - val_accuracy20: 0.4732 - val_accuracy30: 0.4465 - val_accuracy50: 0.4150 - 219s/epoch - 40ms/step
Epoch 29/50
5475/5475 - 217s - loss: 12.0582 - accuracy10: 0.5121 - accuracy20: 0.4954 - accuracy30: 0.4879 - accuracy50: 0.4662 - val_loss: 12.3739 - val_accuracy10: 0.4929 - val_accuracy20: 0.4744 - val_accuracy30: 0.4491 - val_accuracy50: 0.4171 - 217s/epoch - 40ms/step
Epoch 30/50
5475/5475 - 220s - loss: 12.0514 - accuracy10: 0.5125 - accuracy20: 0.4958 - accuracy30: 0.4884 - accuracy50: 0.4668 - val_loss: 12.3661 - val_accuracy10: 0.4949 - val_accuracy20: 0.4751 - val_accuracy30: 0.4498 - val_accuracy50: 0.4166 - 220s/epoch - 40ms/step
Epoch 31/50
5475/5475 - 221s - loss: 12.0454 - accuracy10: 0.5133 - accuracy20: 0.4962 - accuracy30: 0.4888 - accuracy50: 0.4675 - val_loss: 12.3509 - val_accuracy10: 0.4959 - val_accuracy20: 0.4774 - val_accuracy30: 0.4518 - val_accuracy50: 0.4185 - 221s/epoch - 40ms/step
Epoch 32/50
5475/5475 - 219s - loss: 12.0381 - accuracy10: 0.5135 - accuracy20: 0.4967 - accuracy30: 0.4896 - accuracy50: 0.4683 - val_loss: 12.3568 - val_accuracy10: 0.4918 - val_accuracy20: 0.4757 - val_accuracy30: 0.4503 - val_accuracy50: 0.4170 - 219s/epoch - 40ms/step
Epoch 33/50
5475/5475 - 222s - loss: 12.0314 - accuracy10: 0.5136 - accuracy20: 0.4970 - accuracy30: 0.4901 - accuracy50: 0.4690 - val_loss: 12.3846 - val_accuracy10: 0.4923 - val_accuracy20: 0.4752 - val_accuracy30: 0.4492 - val_accuracy50: 0.4138 - 222s/epoch - 41ms/step
Epoch 34/50
5475/5475 - 219s - loss: 12.0248 - accuracy10: 0.5140 - accuracy20: 0.4977 - accuracy30: 0.4907 - accuracy50: 0.4699 - val_loss: 12.3990 - val_accuracy10: 0.4897 - val_accuracy20: 0.4726 - val_accuracy30: 0.4488 - val_accuracy50: 0.4130 - 219s/epoch - 40ms/step
Epoch 35/50
5475/5475 - 220s - loss: 12.0179 - accuracy10: 0.5144 - accuracy20: 0.4980 - accuracy30: 0.4915 - accuracy50: 0.4706 - val_loss: 12.4139 - val_accuracy10: 0.4918 - val_accuracy20: 0.4723 - val_accuracy30: 0.4477 - val_accuracy50: 0.4113 - 220s/epoch - 40ms/step
Epoch 36/50
5475/5475 - 221s - loss: 12.0129 - accuracy10: 0.5145 - accuracy20: 0.4980 - accuracy30: 0.4916 - accuracy50: 0.4710 - val_loss: 12.4165 - val_accuracy10: 0.4918 - val_accuracy20: 0.4736 - val_accuracy30: 0.4495 - val_accuracy50: 0.4133 - 221s/epoch - 40ms/step
Epoch 37/50
5475/5475 - 221s - loss: 12.0056 - accuracy10: 0.5148 - accuracy20: 0.4989 - accuracy30: 0.4924 - accuracy50: 0.4719 - val_loss: 12.3989 - val_accuracy10: 0.4933 - val_accuracy20: 0.4750 - val_accuracy30: 0.4496 - val_accuracy50: 0.4132 - 221s/epoch - 40ms/step
Epoch 38/50
5475/5475 - 221s - loss: 12.0005 - accuracy10: 0.5152 - accuracy20: 0.4990 - accuracy30: 0.4929 - accuracy50: 0.4725 - val_loss: 12.4141 - val_accuracy10: 0.4917 - val_accuracy20: 0.4740 - val_accuracy30: 0.4500 - val_accuracy50: 0.4135 - 221s/epoch - 40ms/step
Epoch 39/50
5475/5475 - 223s - loss: 11.9918 - accuracy10: 0.5157 - accuracy20: 0.4994 - accuracy30: 0.4935 - accuracy50: 0.4735 - val_loss: 12.3832 - val_accuracy10: 0.4918 - val_accuracy20: 0.4750 - val_accuracy30: 0.4525 - val_accuracy50: 0.4121 - 223s/epoch - 41ms/step
Epoch 40/50
5475/5475 - 219s - loss: 11.9876 - accuracy10: 0.5160 - accuracy20: 0.4998 - accuracy30: 0.4939 - accuracy50: 0.4740 - val_loss: 12.3769 - val_accuracy10: 0.4900 - val_accuracy20: 0.4742 - val_accuracy30: 0.4525 - val_accuracy50: 0.4130 - 219s/epoch - 40ms/step
Epoch 41/50
5475/5475 - 221s - loss: 11.9807 - accuracy10: 0.5163 - accuracy20: 0.5006 - accuracy30: 0.4947 - accuracy50: 0.4748 - val_loss: 12.4144 - val_accuracy10: 0.4895 - val_accuracy20: 0.4731 - val_accuracy30: 0.4505 - val_accuracy50: 0.4093 - 221s/epoch - 40ms/step
testing model: results/AAPL/W3/deepVOL_L3/seq2seq
Evaluating performance on  test set...
13689/13689 - 239s - 239s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99225354
{'0': {'precision': 0.543269194391689, 'recall': 0.4019031892413832, 'f1-score': 0.4620143914983021, 'support': 1071885}, '1': {'precision': 0.4517109141816905, 'recall': 0.549979073189831, 'f1-score': 0.4960248241739397, 'support': 1333218}, '2': {'precision': 0.508859630982744, 'recall': 0.5037124377810712, 'f1-score': 0.5062729520548949, 'support': 1099143}, 'accuracy': 0.4901733497020472, 'macro avg': {'precision': 0.5012799131853746, 'recall': 0.4851982334040952, 'f1-score': 0.48810405590904554, 'support': 3504246}, 'weighted avg': {'precision': 0.49764220987661456, 'recall': 0.4901733497020472, 'f1-score': 0.48883608382720917, 'support': 3504246}}
[[430794 462285 178806]
 [244409 733242 355567]
 [117763 427728 553652]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0214448
{'0': {'precision': 0.5328946101042619, 'recall': 0.4340577436058371, 'f1-score': 0.4784248803037014, 'support': 1147140}, '1': {'precision': 0.40099299709253194, 'recall': 0.41385700092777744, 'f1-score': 0.40732345725702507, 'support': 1186707}, '2': {'precision': 0.4877380043432006, 'recall': 0.5605370476222211, 'f1-score': 0.521609706260013, 'support': 1170399}, 'accuracy': 0.469460192007068, 'macro avg': {'precision': 0.47387520384666476, 'recall': 0.4694839307186119, 'f1-score': 0.46911934794024646, 'support': 3504246}, 'weighted avg': {'precision': 0.473144291862206, 'recall': 0.469460192007068, 'f1-score': 0.46876999896117827, 'support': 3504246}}
[[497925 378595 270620]
 [277161 491127 418419]
 [159292 355055 656052]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0500652
{'0': {'precision': 0.5433685749224101, 'recall': 0.3780849335351193, 'f1-score': 0.44590306434126686, 'support': 1221096}, '1': {'precision': 0.33602635931953617, 'recall': 0.4359319773514799, 'f1-score': 0.37951435537851147, 'support': 1037772}, '2': {'precision': 0.49505377330367584, 'recall': 0.5200541522332979, 'f1-score': 0.507246104396534, 'support': 1245378}, 'accuracy': 0.44567076626469715, 'macro avg': {'precision': 0.45814956918187405, 'recall': 0.444690354373299, 'f1-score': 0.4442211747054374, 'support': 3504246}, 'weighted avg': {'precision': 0.46479414356657445, 'recall': 0.44567076626469715, 'f1-score': 0.4480430194871818, 'support': 3504246}}
[[461678 458439 300979]
 [225747 452398 359627]
 [162234 435480 647664]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0683495
{'0': {'precision': 0.495690294125975, 'recall': 0.26031322571757204, 'f1-score': 0.34136015516839924, 'support': 1143265}, '1': {'precision': 0.36852902993996606, 'recall': 0.5677712344486099, 'f1-score': 0.44695102675379794, 'support': 1213959}, '2': {'precision': 0.45259829660181444, 'recall': 0.40783611822615434, 'f1-score': 0.42905288124431634, 'support': 1147022}, 'accuracy': 0.41511212397759745, 'macro avg': {'precision': 0.43893920688925187, 'recall': 0.4119735261307787, 'f1-score': 0.4057880210555045, 'support': 3504246}, 'weighted avg': {'precision': 0.4375334095082453, 'recall': 0.41511212397759745, 'f1-score': 0.40664337870007755, 'support': 3504246}}
[[297607 611953 233705]
 [192629 689251 332079]
 [110153 569072 467797]]
Evaluating performance on  train set...
5475/5475 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0098664
{'0': {'precision': 0.5380928968681935, 'recall': 0.43874751332512885, 'f1-score': 0.48336845604516293, 'support': 463973}, '1': {'precision': 0.42805762607206865, 'recall': 0.4591208762853346, 'f1-score': 0.4430454341727395, 'support': 465054}, '2': {'precision': 0.49964153058811867, 'recall': 0.5545320068819717, 'f1-score': 0.5256577040314306, 'support': 472539}, 'accuracy': 0.48454443101502176, 'macro avg': {'precision': 0.48859735117612696, 'recall': 0.48413346549747843, 'f1-score': 0.48402386474977765, 'support': 1401566}, 'weighted avg': {'precision': 0.4886181571874069, 'recall': 0.48454443101502176, 'f1-score': 0.48424671389411544, 'support': 1401566}}
[[203567 150002 110404]
 [ 99528 213516 152010]
 [ 75217 135284 262038]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0284474
{'0': {'precision': 0.5210590415943086, 'recall': 0.4417494772692979, 'f1-score': 0.47813777036871985, 'support': 463910}, '1': {'precision': 0.40562381703278416, 'recall': 0.3592837696785787, 'f1-score': 0.38105009438204307, 'support': 464655}, '2': {'precision': 0.4694434016651695, 'recall': 0.592208050300105, 'f1-score': 0.52372774720318, 'support': 473001}, 'accuracy': 0.4651867981957325, 'macro avg': {'precision': 0.4653754200974207, 'recall': 0.46441376574932725, 'f1-score': 0.46097187065131434, 'support': 1401566}, 'weighted avg': {'precision': 0.465370045449455, 'recall': 0.4651867981957325, 'f1-score': 0.46133644281588765, 'support': 1401566}}
[[204932 126985 131993]
 [113124 166943 184588]
 [ 75243 117643 280115]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.047439
{'0': {'precision': 0.5197447841090612, 'recall': 0.36732262429010937, 'f1-score': 0.43043858054613027, 'support': 464156}, '1': {'precision': 0.37396901758183254, 'recall': 0.4151242090006772, 'f1-score': 0.39347338789553254, 'support': 463654}, '2': {'precision': 0.4592959482939102, 'recall': 0.5417936659377401, 'f1-score': 0.4971455742601009, 'support': 473756}, 'accuracy': 0.4421104678623768, 'macro avg': {'precision': 0.45100324999493463, 'recall': 0.4414134997428422, 'f1-score': 0.44035251423392124, 'support': 1401566}, 'weighted avg': {'precision': 0.45108764208802304, 'recall': 0.4421104678623768, 'f1-score': 0.440758307965842, 'support': 1401566}}
[[170495 166805 126856]
 [ 95863 192474 175317]
 [ 61678 155400 256678]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721924
{'0': {'precision': 0.5093481851147094, 'recall': 0.24367019986130584, 'f1-score': 0.3296412851058021, 'support': 465773}, '1': {'precision': 0.35299974432267833, 'recall': 0.5639769863534781, 'f1-score': 0.43421763132386776, 'support': 462682}, '2': {'precision': 0.45380850865358147, 'recall': 0.42159662320258884, 'f1-score': 0.43710992286115014, 'support': 473111}, 'accuracy': 0.40946983588357594, 'macro avg': {'precision': 0.4387188126969897, 'recall': 0.40974793647245766, 'f1-score': 0.40032294643027333, 'support': 1401566}, 'weighted avg': {'precision': 0.43898685988797065, 'recall': 0.40946983588357594, 'f1-score': 0.40044079629395696, 'support': 1401566}}
[[113495 247350 104928]
 [ 66601 260942 135139]
 [ 42728 230921 199462]]
Evaluating performance on  val set...
2036/2036 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9909356
{'0': {'precision': 0.5441925269157695, 'recall': 0.4031553792835963, 'f1-score': 0.4631754462248319, 'support': 159854}, '1': {'precision': 0.4610736968662061, 'recall': 0.5462939546118472, 'f1-score': 0.500079137659368, 'support': 193751}, '2': {'precision': 0.5075304943167714, 'recall': 0.5245419453377165, 'f1-score': 0.5158960215937097, 'support': 167611}, 'accuracy': 0.4953992202848723, 'macro avg': {'precision': 0.5042655726995823, 'recall': 0.49133042641105334, 'f1-score': 0.4930502018259699, 'support': 521216}, 'weighted avg': {'precision': 0.5015052026838127, 'recall': 0.4953992202848723, 'f1-score': 0.49384732789631897, 'support': 521216}}
[[ 64446  64101  31307]
 [ 33903 105845  54003]
 [ 20076  59616  87919]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0153915
{'0': {'precision': 0.5379157126340368, 'recall': 0.4237344635458831, 'f1-score': 0.4740464496795138, 'support': 167992}, '1': {'precision': 0.4244291627356561, 'recall': 0.4332177388380805, 'f1-score': 0.4287784211425203, 'support': 179651}, '2': {'precision': 0.48451185332243374, 'recall': 0.5736664112505977, 'f1-score': 0.5253333685057441, 'support': 173573}, 'accuracy': 0.47693278794204325, 'macro avg': {'precision': 0.48228557623070883, 'recall': 0.47687287121152044, 'f1-score': 0.47605274644259277, 'support': 521216}, 'weighted avg': {'precision': 0.4810152332779025, 'recall': 0.47693278794204325, 'f1-score': 0.47552295417424506, 'support': 521216}}
[[71184 54560 42248]
 [38132 77828 63691]
 [23017 50983 99573]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.044255
{'0': {'precision': 0.5464037023362841, 'recall': 0.35893241886541305, 'f1-score': 0.4332578761935561, 'support': 177298}, '1': {'precision': 0.362024233921725, 'recall': 0.46601851680056405, 'f1-score': 0.4074910296380219, 'support': 161691}, '2': {'precision': 0.4894944840319209, 'recall': 0.5281324940870453, 'f1-score': 0.5080799708582561, 'support': 182227}, 'accuracy': 0.4513080949165029, 'macro avg': {'precision': 0.46597414009664334, 'recall': 0.4510278099176741, 'f1-score': 0.44960962556327805, 'support': 521216}, 'weighted avg': {'precision': 0.46930918345856804, 'recall': 0.4513080949165029, 'f1-score': 0.4514237395938611, 'support': 521216}}
[[63638 68288 45372]
 [31341 75351 54999]
 [21488 64499 96240]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0660784
{'0': {'precision': 0.5086671612265085, 'recall': 0.24191765356164222, 'f1-score': 0.32789250105602097, 'support': 170062}, '1': {'precision': 0.37070930991181855, 'recall': 0.5878259998998848, 'f1-score': 0.45467823363527055, 'support': 179793}, '2': {'precision': 0.4559333170147254, 'recall': 0.4130461423544447, 'f1-score': 0.4334314136734812, 'support': 171361}, 'accuracy': 0.41750061394891946, 'macro avg': {'precision': 0.4451032627176841, 'recall': 0.4142632652719906, 'f1-score': 0.40533404945492424, 'support': 521216}, 'weighted avg': {'precision': 0.44374133347103395, 'recall': 0.41750061394891946, 'f1-score': 0.40632532127386084, 'support': 521216}}
[[ 41141  93143  35778]
 [ 25422 105687  48684]
 [ 14317  86264  70780]]
training model: results/AAPL/W4/deepLOB_L1/seq2seq
Epoch 1/50
5165/5165 - 140s - loss: 12.3962 - accuracy10: 0.4766 - accuracy20: 0.4648 - accuracy30: 0.4520 - accuracy50: 0.4535 - val_loss: 14.3491 - val_accuracy10: 0.4118 - val_accuracy20: 0.4000 - val_accuracy30: 0.3908 - val_accuracy50: 0.3840 - 140s/epoch - 27ms/step
Epoch 2/50
5165/5165 - 112s - loss: 12.2941 - accuracy10: 0.4892 - accuracy20: 0.4749 - accuracy30: 0.4612 - accuracy50: 0.4599 - val_loss: 12.9274 - val_accuracy10: 0.4514 - val_accuracy20: 0.4343 - val_accuracy30: 0.4215 - val_accuracy50: 0.4095 - 112s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 127s - loss: 12.2638 - accuracy10: 0.4929 - accuracy20: 0.4781 - accuracy30: 0.4640 - accuracy50: 0.4617 - val_loss: 13.3694 - val_accuracy10: 0.4443 - val_accuracy20: 0.4271 - val_accuracy30: 0.4132 - val_accuracy50: 0.4028 - 127s/epoch - 25ms/step
Epoch 4/50
5165/5165 - 126s - loss: 12.2325 - accuracy10: 0.4970 - accuracy20: 0.4808 - accuracy30: 0.4666 - accuracy50: 0.4634 - val_loss: 13.1162 - val_accuracy10: 0.4479 - val_accuracy20: 0.4306 - val_accuracy30: 0.4175 - val_accuracy50: 0.4073 - 126s/epoch - 24ms/step
Epoch 5/50
5165/5165 - 125s - loss: 12.2075 - accuracy10: 0.4999 - accuracy20: 0.4827 - accuracy30: 0.4681 - accuracy50: 0.4650 - val_loss: 13.0784 - val_accuracy10: 0.4481 - val_accuracy20: 0.4304 - val_accuracy30: 0.4167 - val_accuracy50: 0.4064 - 125s/epoch - 24ms/step
Epoch 6/50
5165/5165 - 120s - loss: 12.1864 - accuracy10: 0.5022 - accuracy20: 0.4843 - accuracy30: 0.4695 - accuracy50: 0.4665 - val_loss: 12.7644 - val_accuracy10: 0.4615 - val_accuracy20: 0.4418 - val_accuracy30: 0.4237 - val_accuracy50: 0.4045 - 120s/epoch - 23ms/step
Epoch 7/50
5165/5165 - 118s - loss: 12.1686 - accuracy10: 0.5038 - accuracy20: 0.4856 - accuracy30: 0.4707 - accuracy50: 0.4676 - val_loss: 12.8518 - val_accuracy10: 0.4504 - val_accuracy20: 0.4341 - val_accuracy30: 0.4189 - val_accuracy50: 0.4043 - 118s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 126s - loss: 12.1505 - accuracy10: 0.5055 - accuracy20: 0.4869 - accuracy30: 0.4719 - accuracy50: 0.4692 - val_loss: 12.9761 - val_accuracy10: 0.4448 - val_accuracy20: 0.4264 - val_accuracy30: 0.4099 - val_accuracy50: 0.3981 - 126s/epoch - 24ms/step
Epoch 9/50
5165/5165 - 113s - loss: 12.1342 - accuracy10: 0.5074 - accuracy20: 0.4882 - accuracy30: 0.4726 - accuracy50: 0.4699 - val_loss: 13.2769 - val_accuracy10: 0.4358 - val_accuracy20: 0.4157 - val_accuracy30: 0.4015 - val_accuracy50: 0.3949 - 113s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 122s - loss: 12.1178 - accuracy10: 0.5087 - accuracy20: 0.4892 - accuracy30: 0.4736 - accuracy50: 0.4713 - val_loss: 13.2816 - val_accuracy10: 0.4369 - val_accuracy20: 0.4191 - val_accuracy30: 0.4062 - val_accuracy50: 0.3961 - 122s/epoch - 24ms/step
Epoch 11/50
5165/5165 - 125s - loss: 12.1053 - accuracy10: 0.5097 - accuracy20: 0.4900 - accuracy30: 0.4744 - accuracy50: 0.4720 - val_loss: 13.0327 - val_accuracy10: 0.4463 - val_accuracy20: 0.4281 - val_accuracy30: 0.4123 - val_accuracy50: 0.3981 - 125s/epoch - 24ms/step
Epoch 12/50
5165/5165 - 121s - loss: 12.0945 - accuracy10: 0.5105 - accuracy20: 0.4911 - accuracy30: 0.4752 - accuracy50: 0.4728 - val_loss: 13.0259 - val_accuracy10: 0.4452 - val_accuracy20: 0.4231 - val_accuracy30: 0.4039 - val_accuracy50: 0.3896 - 121s/epoch - 23ms/step
Epoch 13/50
5165/5165 - 119s - loss: 12.0824 - accuracy10: 0.5115 - accuracy20: 0.4917 - accuracy30: 0.4760 - accuracy50: 0.4737 - val_loss: 13.0321 - val_accuracy10: 0.4325 - val_accuracy20: 0.4068 - val_accuracy30: 0.3873 - val_accuracy50: 0.3766 - 119s/epoch - 23ms/step
Epoch 14/50
5165/5165 - 112s - loss: 12.0714 - accuracy10: 0.5126 - accuracy20: 0.4927 - accuracy30: 0.4765 - accuracy50: 0.4746 - val_loss: 13.0702 - val_accuracy10: 0.4262 - val_accuracy20: 0.4024 - val_accuracy30: 0.3860 - val_accuracy50: 0.3784 - 112s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 126s - loss: 12.0624 - accuracy10: 0.5130 - accuracy20: 0.4932 - accuracy30: 0.4773 - accuracy50: 0.4750 - val_loss: 13.0923 - val_accuracy10: 0.4324 - val_accuracy20: 0.4088 - val_accuracy30: 0.3913 - val_accuracy50: 0.3809 - 126s/epoch - 24ms/step
Epoch 16/50
5165/5165 - 117s - loss: 12.0545 - accuracy10: 0.5137 - accuracy20: 0.4935 - accuracy30: 0.4775 - accuracy50: 0.4757 - val_loss: 13.0521 - val_accuracy10: 0.4386 - val_accuracy20: 0.4165 - val_accuracy30: 0.3980 - val_accuracy50: 0.3880 - 117s/epoch - 23ms/step
testing model: results/AAPL/W4/deepLOB_L1/seq2seq
Evaluating performance on  test set...
12724/12724 - 118s - 118s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0732296
{'0': {'precision': 0.44094728516755044, 'recall': 0.544304613052661, 'f1-score': 0.487204626275383, 'support': 915706}, '1': {'precision': 0.5804810619219641, 'recall': 0.1686157285483229, 'f1-score': 0.26132333874512437, 'support': 1417092}, '2': {'precision': 0.3885358302675537, 'recall': 0.7209452273978768, 'f1-score': 0.5049442720435049, 'support': 924349}, 'accuracy': 0.4309820833999816, 'macro avg': {'precision': 0.4699880591190228, 'recall': 0.477955189666287, 'f1-score': 0.41782407902133745, 'support': 3257147}, 'weighted avg': {'precision': 0.4867805628314411, 'recall': 0.4309820833999816, 'f1-score': 0.3939644557572235, 'support': 3257147}}
[[498423  84347 332936]
 [462319 238944 715829]
 [169604  88340 666405]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0599905
{'0': {'precision': 0.45329444269116015, 'recall': 0.4961247291548572, 'f1-score': 0.47374350397893145, 'support': 943805}, '1': {'precision': 0.5121549064962033, 'recall': 0.22231768531449184, 'f1-score': 0.310048583444058, 'support': 1373422}, '2': {'precision': 0.388052477109754, 'recall': 0.6721252872584901, 'f1-score': 0.4920304715203749, 'support': 939920}, 'accuracy': 0.43145888103914254, 'macro avg': {'precision': 0.4511672754323725, 'recall': 0.4635225672426131, 'f1-score': 0.42527418631445474, 'support': 3257147}, 'weighted avg': {'precision': 0.45928681197347215, 'recall': 0.43145888103914254, 'f1-score': 0.4099963293444144, 'support': 3257147}}
[[468245 145638 329922]
 [401766 305336 666320]
 [162971 145205 631744]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0555882
{'0': {'precision': 0.46777013891151586, 'recall': 0.4024346182996086, 'f1-score': 0.4326496626107028, 'support': 963190}, '1': {'precision': 0.4603613298080278, 'recall': 0.3285982603895071, 'f1-score': 0.38347700948192553, 'support': 1333172}, '2': {'precision': 0.3933193580581951, 'recall': 0.6046004048772619, 'f1-score': 0.4765935137481186, 'support': 960785}, 'accuracy': 0.4318472577381371, 'macro avg': {'precision': 0.44048360892591293, 'recall': 0.44521109452212587, 'f1-score': 0.4309067286135823, 'support': 3257147}, 'weighted avg': {'precision': 0.442776360512115, 'recall': 0.4318472577381371, 'f1-score': 0.4254854138672668, 'support': 3257147}}
[[387621 266540 309029]
 [308120 438078 586974]
 [132916 246978 580891]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0547814
{'0': {'precision': 0.4253938185617577, 'recall': 0.27779397794296884, 'f1-score': 0.3361032191912503, 'support': 877906}, '1': {'precision': 0.4946844798589039, 'recall': 0.45712994533241846, 'f1-score': 0.4751663417776877, 'support': 1506926}, '2': {'precision': 0.35483736072434185, 'recall': 0.5252804319540533, 'f1-score': 0.423554946088511, 'support': 872315}, 'accuracy': 0.4270448954253523, 'macro avg': {'precision': 0.42497188638166783, 'recall': 0.42006811840981345, 'f1-score': 0.4116081690191497, 'support': 3257147}, 'weighted avg': {'precision': 0.4385551657614444, 'recall': 0.4270448954253523, 'f1-score': 0.4238620118447823, 'support': 3257147}}
[[243877 375315 258714]
 [243665 688861 574400]
 [ 85755 328350 458210]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.041585
{'0': {'precision': 0.4929860534936349, 'recall': 0.4972692424342623, 'f1-score': 0.4951183848438337, 'support': 438523}, '1': {'precision': 0.4328995098642217, 'recall': 0.3573480398683091, 'f1-score': 0.3915122327485611, 'support': 443159}, '2': {'precision': 0.46887063383350974, 'recall': 0.5471527178602243, 'f1-score': 0.5049959554555247, 'support': 440420}, 'accuracy': 0.4669859057773152, 'macro avg': {'precision': 0.46491873239712217, 'recall': 0.4672566667209319, 'f1-score': 0.46387552434930646, 'support': 1322102}, 'weighted avg': {'precision': 0.4648121261302549, 'recall': 0.4669859057773152, 'f1-score': 0.4636807808559508, 'support': 1322102}}
[[218064 103311 117148]
 [128970 158362 155827]
 [ 95299 104144 240977]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.054447
{'0': {'precision': 0.49093467796475315, 'recall': 0.44740676287781456, 'f1-score': 0.46816113088950617, 'support': 441321}, '1': {'precision': 0.3937140021904503, 'recall': 0.39227532537355597, 'f1-score': 0.3929933471031941, 'support': 438957}, '2': {'precision': 0.4611517395872405, 'recall': 0.5036666183819801, 'f1-score': 0.48147246643970393, 'support': 441824}, 'accuracy': 0.44790341441129355, 'macro avg': {'precision': 0.44860013991414793, 'recall': 0.4477829022111169, 'f1-score': 0.44754231481080137, 'support': 1322102}, 'weighted avg': {'precision': 0.4487030550328108, 'recall': 0.44790341441129355, 'f1-score': 0.44765276062052717, 'support': 1322102}}
[[197450 133098 110773]
 [117513 172192 149252]
 [ 87229 132063 222532]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.066226
{'0': {'precision': 0.49415552830025394, 'recall': 0.37212495477456947, 'f1-score': 0.42454518418245957, 'support': 444993}, '1': {'precision': 0.3635922573437791, 'recall': 0.4710547129593335, 'f1-score': 0.4104054828237391, 'support': 431141}, '2': {'precision': 0.4590120696214793, 'recall': 0.44096213181214794, 'f1-score': 0.4498060953866599, 'support': 445968}, 'accuracy': 0.4276061907477638, 'macro avg': {'precision': 0.43891995175517073, 'recall': 0.4280472665153503, 'f1-score': 0.42825225413095286, 'support': 1322102}, 'weighted avg': {'precision': 0.43972399640369736, 'recall': 0.4276061907477638, 'f1-score': 0.4284551344468225, 'support': 1322102}}
[[165593 180084  99316]
 [ 95590 203091 132460]
 [ 73920 175393 196655]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.083245
{'0': {'precision': 0.48165877715033717, 'recall': 0.28750019874122984, 'f1-score': 0.36007379097582454, 'support': 440271}, '1': {'precision': 0.35366961187447915, 'recall': 0.5579472228655504, 'f1-score': 0.43292087253648853, 'support': 440418}, '2': {'precision': 0.43122316566302243, 'recall': 0.35609055465063333, 'f1-score': 0.39007194280311397, 'support': 441413}, 'accuracy': 0.4004917926150932, 'macro avg': {'precision': 0.4221838515626129, 'recall': 0.4005126587524712, 'f1-score': 0.3943555354384756, 'support': 1322102}, 'weighted avg': {'precision': 0.4221840416413425, 'recall': 0.4004917926150932, 'f1-score': 0.39435612332183406, 'support': 1322102}}
[[126578 227595  86098]
 [ 73464 245730 121224]
 [ 62754 221476 157183]]
Evaluating performance on  val set...
1903/1903 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0488237
{'0': {'precision': 0.5301154705174924, 'recall': 0.35760207878396016, 'f1-score': 0.4270961960857164, 'support': 163942}, '1': {'precision': 0.4661297058648052, 'recall': 0.24948906601267115, 'f1-score': 0.32501736826121863, 'support': 156576}, '2': {'precision': 0.4342421839756121, 'recall': 0.7632116384954529, 'f1-score': 0.5535389883376971, 'support': 166482}, 'accuracy': 0.4615010266940452, 'macro avg': {'precision': 0.4768291201193032, 'recall': 0.45676759443069476, 'f1-score': 0.43521751756154403, 'support': 487000}, 'weighted avg': {'precision': 0.47676883483715465, 'recall': 0.4615010266940452, 'f1-score': 0.4375014412484386, 'support': 487000}}
[[ 58626  24811  80505]
 [ 32474  39064  85038]
 [ 19491  19930 127061]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0617731
{'0': {'precision': 0.5230800425812339, 'recall': 0.31436178963338474, 'f1-score': 0.39271116388463906, 'support': 164123}, '1': {'precision': 0.42727084830172335, 'recall': 0.27240269315479365, 'f1-score': 0.3326972448940491, 'support': 159367}, '2': {'precision': 0.4189536967938569, 'recall': 0.734756284019326, 'f1-score': 0.5336330040508848, 'support': 163510}, 'accuracy': 0.4417782340862423, 'macro avg': {'precision': 0.45643486255893806, 'recall': 0.44050692226916816, 'f1-score': 0.419680470943191, 'support': 487000}, 'weighted avg': {'precision': 0.4567668543585711, 'recall': 0.4417782340862423, 'f1-score': 0.4203865065084778, 'support': 487000}}
[[ 51594  32523  80006]
 [ 29339  43412  86616]
 [ 17702  25668 120140]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0683142
{'0': {'precision': 0.5265371653000026, 'recall': 0.24324506558783868, 'f1-score': 0.3327631170704301, 'support': 163140}, '1': {'precision': 0.3923727942436183, 'recall': 0.3530329374915221, 'f1-score': 0.3716647571816651, 'support': 162186}, '2': {'precision': 0.412165188232239, 'recall': 0.6773878298303995, 'f1-score': 0.5124958175687848, 'support': 161674}, 'accuracy': 0.42393429158110885, 'macro avg': {'precision': 0.44369171592528667, 'recall': 0.4245552776365867, 'f1-score': 0.40564123060696006, 'support': 487000}, 'weighted avg': {'precision': 0.44388714947945973, 'recall': 0.42393429158110885, 'f1-score': 0.4053861273855261, 'support': 487000}}
[[ 39683  49564  73893]
 [ 22629  57257  82300]
 [ 13054  39104 109516]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0754871
{'0': {'precision': 0.4862765623364388, 'recall': 0.14718891789815214, 'f1-score': 0.225977652272473, 'support': 157804}, '1': {'precision': 0.3930769413271964, 'recall': 0.4785255873331292, 'f1-score': 0.4316127317914437, 'support': 173113}, '2': {'precision': 0.39791675784498226, 'recall': 0.582510587315723, 'f1-score': 0.4728361065389406, 'support': 156083}, 'accuracy': 0.4044887063655031, 'macro avg': {'precision': 0.42575675383620587, 'recall': 0.40274169751566813, 'f1-score': 0.37680883020095246, 'support': 487000}, 'weighted avg': {'precision': 0.4248278367589994, 'recall': 0.4044887063655031, 'f1-score': 0.3781922593321047, 'support': 487000}}
[[23227 70695 63882]
 [16586 82839 73688]
 [ 7952 57211 90920]]
training model: results/AAPL/W4/deepOF_L1/seq2seq
Epoch 1/50
5165/5165 - 119s - loss: 12.5749 - accuracy10: 0.4597 - accuracy20: 0.4542 - accuracy30: 0.4463 - accuracy50: 0.4558 - val_loss: 13.0099 - val_accuracy10: 0.3770 - val_accuracy20: 0.3747 - val_accuracy30: 0.3692 - val_accuracy50: 0.3723 - 119s/epoch - 23ms/step
Epoch 2/50
5165/5165 - 117s - loss: 12.5513 - accuracy10: 0.4617 - accuracy20: 0.4567 - accuracy30: 0.4495 - accuracy50: 0.4569 - val_loss: 12.9392 - val_accuracy10: 0.3701 - val_accuracy20: 0.3730 - val_accuracy30: 0.3718 - val_accuracy50: 0.3779 - 117s/epoch - 23ms/step
Epoch 3/50
5165/5165 - 115s - loss: 12.5469 - accuracy10: 0.4613 - accuracy20: 0.4567 - accuracy30: 0.4500 - accuracy50: 0.4564 - val_loss: 12.8687 - val_accuracy10: 0.3968 - val_accuracy20: 0.3978 - val_accuracy30: 0.3945 - val_accuracy50: 0.3905 - 115s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 116s - loss: 12.5395 - accuracy10: 0.4618 - accuracy20: 0.4571 - accuracy30: 0.4503 - accuracy50: 0.4570 - val_loss: 12.8498 - val_accuracy10: 0.4086 - val_accuracy20: 0.4154 - val_accuracy30: 0.4117 - val_accuracy50: 0.3993 - 116s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 110s - loss: 12.5325 - accuracy10: 0.4621 - accuracy20: 0.4576 - accuracy30: 0.4508 - accuracy50: 0.4574 - val_loss: 12.8442 - val_accuracy10: 0.4155 - val_accuracy20: 0.4191 - val_accuracy30: 0.4135 - val_accuracy50: 0.3993 - 110s/epoch - 21ms/step
Epoch 6/50
5165/5165 - 116s - loss: 12.5267 - accuracy10: 0.4623 - accuracy20: 0.4579 - accuracy30: 0.4513 - accuracy50: 0.4575 - val_loss: 12.8330 - val_accuracy10: 0.4193 - val_accuracy20: 0.4224 - val_accuracy30: 0.4157 - val_accuracy50: 0.3997 - 116s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 117s - loss: 12.5221 - accuracy10: 0.4630 - accuracy20: 0.4582 - accuracy30: 0.4515 - accuracy50: 0.4577 - val_loss: 12.8323 - val_accuracy10: 0.4188 - val_accuracy20: 0.4211 - val_accuracy30: 0.4153 - val_accuracy50: 0.3997 - 117s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 117s - loss: 12.5173 - accuracy10: 0.4634 - accuracy20: 0.4587 - accuracy30: 0.4518 - accuracy50: 0.4578 - val_loss: 12.8306 - val_accuracy10: 0.4233 - val_accuracy20: 0.4238 - val_accuracy30: 0.4169 - val_accuracy50: 0.3996 - 117s/epoch - 23ms/step
Epoch 9/50
5165/5165 - 115s - loss: 12.5126 - accuracy10: 0.4636 - accuracy20: 0.4587 - accuracy30: 0.4518 - accuracy50: 0.4578 - val_loss: 12.8302 - val_accuracy10: 0.4220 - val_accuracy20: 0.4233 - val_accuracy30: 0.4176 - val_accuracy50: 0.4011 - 115s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 114s - loss: 12.5078 - accuracy10: 0.4644 - accuracy20: 0.4593 - accuracy30: 0.4524 - accuracy50: 0.4581 - val_loss: 12.8280 - val_accuracy10: 0.4236 - val_accuracy20: 0.4250 - val_accuracy30: 0.4181 - val_accuracy50: 0.3990 - 114s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 117s - loss: 12.5045 - accuracy10: 0.4651 - accuracy20: 0.4597 - accuracy30: 0.4523 - accuracy50: 0.4581 - val_loss: 12.8375 - val_accuracy10: 0.4229 - val_accuracy20: 0.4232 - val_accuracy30: 0.4178 - val_accuracy50: 0.3997 - 117s/epoch - 23ms/step
Epoch 12/50
5165/5165 - 115s - loss: 12.5008 - accuracy10: 0.4652 - accuracy20: 0.4600 - accuracy30: 0.4526 - accuracy50: 0.4583 - val_loss: 12.8648 - val_accuracy10: 0.4213 - val_accuracy20: 0.4197 - val_accuracy30: 0.4131 - val_accuracy50: 0.3947 - 115s/epoch - 22ms/step
Epoch 13/50
5165/5165 - 109s - loss: 12.4954 - accuracy10: 0.4660 - accuracy20: 0.4604 - accuracy30: 0.4530 - accuracy50: 0.4586 - val_loss: 12.8321 - val_accuracy10: 0.4243 - val_accuracy20: 0.4236 - val_accuracy30: 0.4175 - val_accuracy50: 0.3980 - 109s/epoch - 21ms/step
Epoch 14/50
5165/5165 - 115s - loss: 12.4910 - accuracy10: 0.4665 - accuracy20: 0.4605 - accuracy30: 0.4531 - accuracy50: 0.4589 - val_loss: 12.8119 - val_accuracy10: 0.4295 - val_accuracy20: 0.4254 - val_accuracy30: 0.4174 - val_accuracy50: 0.3988 - 115s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 109s - loss: 12.4871 - accuracy10: 0.4668 - accuracy20: 0.4611 - accuracy30: 0.4535 - accuracy50: 0.4593 - val_loss: 12.8146 - val_accuracy10: 0.4292 - val_accuracy20: 0.4260 - val_accuracy30: 0.4190 - val_accuracy50: 0.3997 - 109s/epoch - 21ms/step
Epoch 16/50
5165/5165 - 110s - loss: 12.4829 - accuracy10: 0.4673 - accuracy20: 0.4612 - accuracy30: 0.4540 - accuracy50: 0.4593 - val_loss: 12.8253 - val_accuracy10: 0.4265 - val_accuracy20: 0.4245 - val_accuracy30: 0.4183 - val_accuracy50: 0.3979 - 110s/epoch - 21ms/step
Epoch 17/50
5165/5165 - 114s - loss: 12.4791 - accuracy10: 0.4677 - accuracy20: 0.4617 - accuracy30: 0.4541 - accuracy50: 0.4595 - val_loss: 12.8293 - val_accuracy10: 0.4280 - val_accuracy20: 0.4251 - val_accuracy30: 0.4178 - val_accuracy50: 0.3981 - 114s/epoch - 22ms/step
Epoch 18/50
5165/5165 - 114s - loss: 12.4745 - accuracy10: 0.4681 - accuracy20: 0.4619 - accuracy30: 0.4543 - accuracy50: 0.4598 - val_loss: 12.8338 - val_accuracy10: 0.4277 - val_accuracy20: 0.4235 - val_accuracy30: 0.4156 - val_accuracy50: 0.3961 - 114s/epoch - 22ms/step
Epoch 19/50
5165/5165 - 116s - loss: 12.4716 - accuracy10: 0.4682 - accuracy20: 0.4620 - accuracy30: 0.4545 - accuracy50: 0.4597 - val_loss: 12.8513 - val_accuracy10: 0.4257 - val_accuracy20: 0.4216 - val_accuracy30: 0.4136 - val_accuracy50: 0.3956 - 116s/epoch - 23ms/step
Epoch 20/50
5165/5165 - 117s - loss: 12.4685 - accuracy10: 0.4687 - accuracy20: 0.4625 - accuracy30: 0.4549 - accuracy50: 0.4597 - val_loss: 12.8343 - val_accuracy10: 0.4256 - val_accuracy20: 0.4227 - val_accuracy30: 0.4156 - val_accuracy50: 0.3955 - 117s/epoch - 23ms/step
Epoch 21/50
5165/5165 - 109s - loss: 12.4652 - accuracy10: 0.4688 - accuracy20: 0.4623 - accuracy30: 0.4550 - accuracy50: 0.4600 - val_loss: 12.8532 - val_accuracy10: 0.4229 - val_accuracy20: 0.4190 - val_accuracy30: 0.4120 - val_accuracy50: 0.3926 - 109s/epoch - 21ms/step
Epoch 22/50
5165/5165 - 115s - loss: 12.4614 - accuracy10: 0.4691 - accuracy20: 0.4630 - accuracy30: 0.4554 - accuracy50: 0.4600 - val_loss: 12.8537 - val_accuracy10: 0.4223 - val_accuracy20: 0.4191 - val_accuracy30: 0.4127 - val_accuracy50: 0.3926 - 115s/epoch - 22ms/step
Epoch 23/50
5165/5165 - 115s - loss: 12.4587 - accuracy10: 0.4695 - accuracy20: 0.4628 - accuracy30: 0.4555 - accuracy50: 0.4604 - val_loss: 12.8531 - val_accuracy10: 0.4234 - val_accuracy20: 0.4203 - val_accuracy30: 0.4137 - val_accuracy50: 0.3927 - 115s/epoch - 22ms/step
Epoch 24/50
5165/5165 - 115s - loss: 12.4560 - accuracy10: 0.4697 - accuracy20: 0.4637 - accuracy30: 0.4559 - accuracy50: 0.4603 - val_loss: 12.8346 - val_accuracy10: 0.4244 - val_accuracy20: 0.4217 - val_accuracy30: 0.4152 - val_accuracy50: 0.3946 - 115s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L1/seq2seq
Evaluating performance on  test set...
12724/12724 - 108s - 108s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0584362
{'0': {'precision': 0.38238449465326224, 'recall': 0.5414359693437385, 'f1-score': 0.44821851776012794, 'support': 915702}, '1': {'precision': 0.48379224133649024, 'recall': 0.20619409325576604, 'f1-score': 0.2891509513315277, 'support': 1417092}, '2': {'precision': 0.3789794690797796, 'recall': 0.5561957658849633, 'f1-score': 0.45079631747829957, 'support': 924349}, 'accuracy': 0.39977028948375926, 'macro avg': {'precision': 0.4150520683565107, 'recall': 0.43460860949482266, 'f1-score': 0.3960552621899851, 'support': 3257143}, 'weighted avg': {'precision': 0.42553785776289726, 'recall': 0.39977028948375926, 'f1-score': 0.37974421704513145, 'support': 3257143}}
[[495794 153786 266122]
 [548549 292196 576347]
 [252242 157988 514119]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0577949
{'0': {'precision': 0.38930130595267093, 'recall': 0.5503643772740469, 'f1-score': 0.45602936160630214, 'support': 943802}, '1': {'precision': 0.462586700744723, 'recall': 0.191082566028504, 'f1-score': 0.27044947126029306, 'support': 1373422}, '2': {'precision': 0.38447987264144334, 'recall': 0.5544935255059212, 'f1-score': 0.454095079770434, 'support': 939919}, 'accuracy': 0.4000594999973904, 'macro avg': {'precision': 0.4121226264462791, 'recall': 0.43198015626949066, 'f1-score': 0.3935246375456764, 'support': 3257143}, 'weighted avg': {'precision': 0.41881183610428974, 'recall': 0.4000594999973904, 'f1-score': 0.3772187068675683, 'support': 3257143}}
[[519435 151342 273025]
 [549646 262437 561339]
 [265194 153546 521179]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0625545
{'0': {'precision': 0.3909773522827256, 'recall': 0.5347035054423436, 'f1-score': 0.45168258383977555, 'support': 963188}, '1': {'precision': 0.439731283273264, 'recall': 0.2098462987868773, 'f1-score': 0.28411073535833614, 'support': 1333171}, '2': {'precision': 0.3858511848464835, 'recall': 0.5235547219770521, 'f1-score': 0.4442773205914889, 'support': 960784}, 'accuracy': 0.3984485790154132, 'macro avg': {'precision': 0.40551994013415776, 'recall': 0.4227015087354243, 'f1-score': 0.39335687992986684, 'support': 3257143}, 'weighted avg': {'precision': 0.4094205668663422, 'recall': 0.3984485790154132, 'f1-score': 0.3809098891019053, 'support': 3257143}}
[[515020 173975 274193]
 [526955 279761 526455]
 [275288 182473 503023]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0677323
{'0': {'precision': 0.3512048230830709, 'recall': 0.506559942772786, 'f1-score': 0.4148137162173507, 'support': 877904}, '1': {'precision': 0.48423128280746075, 'recall': 0.25845612754450287, 'f1-score': 0.3370261578313623, 'support': 1506925}, '2': {'precision': 0.3373706898368006, 'recall': 0.4589161700947136, 'f1-score': 0.3888670595303606, 'support': 872314}, 'accuracy': 0.37901436934147503, 'macro avg': {'precision': 0.3909355985757774, 'recall': 0.4079774134706675, 'f1-score': 0.3802356445263579, 'support': 3257143}, 'weighted avg': {'precision': 0.4090448349313653, 'recall': 0.37901436934147503, 'f1-score': 0.3718761944990655, 'support': 3257143}}
[[444711 197048 236145]
 [567330 389474 550121]
 [254203 217792 400319]]
Evaluating performance on  train set...
5165/5165 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0587168
{'0': {'precision': 0.43303968100083456, 'recall': 0.5857261770373664, 'f1-score': 0.4979410624272973, 'support': 438495}, '1': {'precision': 0.381195988052311, 'recall': 0.18352217188032624, 'f1-score': 0.2477622311553501, 'support': 442971}, '2': {'precision': 0.44853742433114746, 'recall': 0.5249820713695658, 'f1-score': 0.4837583780336062, 'support': 440636}, 'accuracy': 0.430722440477361, 'macro avg': {'precision': 0.42092436446143106, 'recall': 0.43141014009575285, 'f1-score': 0.4098205572054179, 'support': 1322102}, 'weighted avg': {'precision': 0.4208345796705252, 'recall': 0.430722440477361, 'f1-score': 0.4093916400772334, 'support': 1322102}}
[[256838  65216 116441]
 [193709  81295 167967]
 [142558  66752 231326]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0606585
{'0': {'precision': 0.4317440358025119, 'recall': 0.5931550918526277, 'f1-score': 0.4997392744380075, 'support': 441087}, '1': {'precision': 0.36286219600665715, 'recall': 0.17414812421206893, 'f1-score': 0.2353465786515731, 'support': 439442}, '2': {'precision': 0.4508580590249599, 'recall': 0.5158331691475702, 'f1-score': 0.48116199805023957, 'support': 441573}, 'accuracy': 0.4280600135239187, 'macro avg': {'precision': 0.4151547636113763, 'recall': 0.42771212840408895, 'f1-score': 0.40541595037994, 'support': 1322102}, 'weighted avg': {'precision': 0.415232952038049, 'recall': 0.4280600135239187, 'f1-score': 0.4056553999047581, 'support': 1322102}}
[[261633  65637 113817]
 [199299  76528 163615]
 [145059  68736 227778]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654507
{'0': {'precision': 0.4324830435721207, 'recall': 0.5808833445718139, 'f1-score': 0.49581710970482357, 'support': 444900}, '1': {'precision': 0.3538850903153383, 'recall': 0.20110045860174022, 'f1-score': 0.25646236769082403, 'support': 431093}, '2': {'precision': 0.45005484125229894, 'recall': 0.48380776895332755, 'f1-score': 0.46632133308126505, 'support': 446109}, 'accuracy': 0.42429328448183273, 'macro avg': {'precision': 0.41214099171325264, 'recall': 0.42193052404229386, 'f1-score': 0.40620027015897087, 'support': 1322102}, 'weighted avg': {'precision': 0.4127840412470206, 'recall': 0.42429328448183273, 'f1-score': 0.40781899366475993, 'support': 1322102}}
[[258435  74441 112024]
 [192689  86693 151711]
 [146437  83841 215831]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0747304
{'0': {'precision': 0.4193936118991455, 'recall': 0.5499355026253157, 'f1-score': 0.4758743615593379, 'support': 440328}, '1': {'precision': 0.3589413306380903, 'recall': 0.25565282556119495, 'f1-score': 0.29861776088403885, 'support': 440355}, '2': {'precision': 0.42971209319912684, 'recall': 0.4196443741660418, 'f1-score': 0.42461856558654715, 'support': 441419}, 'accuracy': 0.40841705102934567, 'macro avg': {'precision': 0.4026823452454542, 'recall': 0.4084109007841841, 'f1-score': 0.39970356267664126, 'support': 1322102}, 'weighted avg': {'precision': 0.40270375694260246, 'recall': 0.40841705102934567, 'f1-score': 0.3997220581872194, 'support': 1322102}}
[[242152  91739 106437]
 [188376 112578 139401]
 [146858 109322 185239]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0634339
{'0': {'precision': 0.4308086497470899, 'recall': 0.5950332540118372, 'f1-score': 0.49977578762603936, 'support': 163890}, '1': {'precision': 0.3671324511190725, 'recall': 0.1774266711815028, 'f1-score': 0.239236057269861, 'support': 156521}, '2': {'precision': 0.4524868777399982, 'recall': 0.5024731673349822, 'f1-score': 0.47617178500422386, 'support': 166588}, 'accuracy': 0.42915283193599985, 'macro avg': {'precision': 0.4168093262020535, 'recall': 0.42497769750944075, 'f1-score': 0.4050612099667081, 'support': 486999}, 'weighted avg': {'precision': 0.4177586647562105, 'recall': 0.42915283193599985, 'f1-score': 0.4079643409416675, 'support': 486999}}
[[97520 22847 43523]
 [70988 27771 57762]
 [57857 25025 83706]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0640106
{'0': {'precision': 0.4305985901643643, 'recall': 0.5994220532319392, 'f1-score': 0.5011749865207173, 'support': 164375}, '1': {'precision': 0.3590769037288562, 'recall': 0.17947412422133802, 'f1-score': 0.23932741552878858, 'support': 159087}, '2': {'precision': 0.4493207882997599, 'recall': 0.4908797397530834, 'f1-score': 0.46918176504967857, 'support': 163537}, 'accuracy': 0.42578937533752637, 'macro avg': {'precision': 0.41299876073099345, 'recall': 0.4232586390687869, 'f1-score': 0.40322805569972814, 'support': 486999}, 'weighted avg': {'precision': 0.4135217616421343, 'recall': 0.42578937533752637, 'f1-score': 0.40489425496664383, 'support': 486999}}
[[98530 24086 41759]
 [73908 28552 56627]
 [56383 26877 80277]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0672225
{'0': {'precision': 0.4255416729746819, 'recall': 0.5857451059708993, 'f1-score': 0.4929540413679269, 'support': 163158}, '1': {'precision': 0.35661521325669615, 'recall': 0.20936071510089263, 'f1-score': 0.26383177206825514, 'support': 162103}, '2': {'precision': 0.4425650224215247, 'recall': 0.4576475534506424, 'f1-score': 0.4499799384779992, 'support': 161738}, 'accuracy': 0.41791872262571383, 'macro avg': {'precision': 0.40824063621763423, 'recall': 0.4175844581741448, 'f1-score': 0.4022552506380604, 'support': 486999}, 'weighted avg': {'precision': 0.4082523902311215, 'recall': 0.41791872262571383, 'f1-score': 0.4024159649581277, 'support': 486999}}
[[95569 28406 39183]
 [74117 33938 54048]
 [54896 32823 74019]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0756555
{'0': {'precision': 0.40336134453781514, 'recall': 0.5527422146974338, 'f1-score': 0.4663822046254063, 'support': 157701}, '1': {'precision': 0.373344295991778, 'recall': 0.26243758091363045, 'f1-score': 0.30821757413057566, 'support': 173024}, '2': {'precision': 0.41134186373685266, 'recall': 0.3929060496307767, 'f1-score': 0.40191265415128424, 'support': 156274}, 'accuracy': 0.3983108794884589, 'macro avg': {'precision': 0.3960158347554819, 'recall': 0.40269528174728036, 'f1-score': 0.39217081096908873, 'support': 486999}, 'weighted avg': {'precision': 0.39525758631589036, 'recall': 0.3983108794884589, 'f1-score': 0.38950074992523126, 'support': 486999}}
[[87168 34983 35550]
 [75297 45408 52319]
 [53639 41234 61401]]
training model: results/AAPL/W4/deepLOB_L2/seq2seq
Epoch 1/50
5165/5165 - 254s - loss: 12.3743 - accuracy10: 0.4765 - accuracy20: 0.4659 - accuracy30: 0.4544 - accuracy50: 0.4576 - val_loss: 13.8415 - val_accuracy10: 0.4167 - val_accuracy20: 0.4060 - val_accuracy30: 0.3984 - val_accuracy50: 0.4038 - 254s/epoch - 49ms/step
Epoch 2/50
5165/5165 - 243s - loss: 12.1613 - accuracy10: 0.5024 - accuracy20: 0.4872 - accuracy30: 0.4723 - accuracy50: 0.4716 - val_loss: 14.8061 - val_accuracy10: 0.4088 - val_accuracy20: 0.3978 - val_accuracy30: 0.3907 - val_accuracy50: 0.3953 - 243s/epoch - 47ms/step
Epoch 3/50
5165/5165 - 243s - loss: 12.0775 - accuracy10: 0.5114 - accuracy20: 0.4938 - accuracy30: 0.4780 - accuracy50: 0.4756 - val_loss: 14.7786 - val_accuracy10: 0.4118 - val_accuracy20: 0.4015 - val_accuracy30: 0.3932 - val_accuracy50: 0.3977 - 243s/epoch - 47ms/step
Epoch 4/50
5165/5165 - 244s - loss: 12.0262 - accuracy10: 0.5169 - accuracy20: 0.4978 - accuracy30: 0.4813 - accuracy50: 0.4779 - val_loss: 14.4524 - val_accuracy10: 0.4139 - val_accuracy20: 0.4052 - val_accuracy30: 0.3967 - val_accuracy50: 0.3981 - 244s/epoch - 47ms/step
Epoch 5/50
5165/5165 - 243s - loss: 11.9788 - accuracy10: 0.5216 - accuracy20: 0.5009 - accuracy30: 0.4840 - accuracy50: 0.4797 - val_loss: 14.4917 - val_accuracy10: 0.4141 - val_accuracy20: 0.4046 - val_accuracy30: 0.3958 - val_accuracy50: 0.4000 - 243s/epoch - 47ms/step
Epoch 6/50
5165/5165 - 242s - loss: 11.9402 - accuracy10: 0.5251 - accuracy20: 0.5037 - accuracy30: 0.4857 - accuracy50: 0.4816 - val_loss: 14.8096 - val_accuracy10: 0.4183 - val_accuracy20: 0.4059 - val_accuracy30: 0.3967 - val_accuracy50: 0.4014 - 242s/epoch - 47ms/step
Epoch 7/50
5165/5165 - 242s - loss: 11.9111 - accuracy10: 0.5277 - accuracy20: 0.5057 - accuracy30: 0.4869 - accuracy50: 0.4829 - val_loss: 14.5553 - val_accuracy10: 0.4263 - val_accuracy20: 0.4122 - val_accuracy30: 0.4021 - val_accuracy50: 0.4053 - 242s/epoch - 47ms/step
Epoch 8/50
5165/5165 - 241s - loss: 11.8892 - accuracy10: 0.5294 - accuracy20: 0.5071 - accuracy30: 0.4883 - accuracy50: 0.4842 - val_loss: 14.5352 - val_accuracy10: 0.4307 - val_accuracy20: 0.4156 - val_accuracy30: 0.4036 - val_accuracy50: 0.4067 - 241s/epoch - 47ms/step
Epoch 9/50
5165/5165 - 240s - loss: 11.8693 - accuracy10: 0.5307 - accuracy20: 0.5083 - accuracy30: 0.4893 - accuracy50: 0.4852 - val_loss: 14.2249 - val_accuracy10: 0.4295 - val_accuracy20: 0.4142 - val_accuracy30: 0.4031 - val_accuracy50: 0.4065 - 240s/epoch - 47ms/step
Epoch 10/50
5165/5165 - 241s - loss: 11.8543 - accuracy10: 0.5323 - accuracy20: 0.5097 - accuracy30: 0.4904 - accuracy50: 0.4861 - val_loss: 14.2853 - val_accuracy10: 0.4291 - val_accuracy20: 0.4142 - val_accuracy30: 0.4027 - val_accuracy50: 0.4073 - 241s/epoch - 47ms/step
Epoch 11/50
5165/5165 - 244s - loss: 11.8408 - accuracy10: 0.5336 - accuracy20: 0.5102 - accuracy30: 0.4911 - accuracy50: 0.4868 - val_loss: 14.1796 - val_accuracy10: 0.4354 - val_accuracy20: 0.4186 - val_accuracy30: 0.4064 - val_accuracy50: 0.4099 - 244s/epoch - 47ms/step
testing model: results/AAPL/W4/deepLOB_L2/seq2seq
Evaluating performance on  test set...
12724/12724 - 199s - 199s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0440731
{'0': {'precision': 0.41595884090661506, 'recall': 0.5670957709133717, 'f1-score': 0.47990924759603165, 'support': 915706}, '1': {'precision': 0.5266786957082098, 'recall': 0.19609312592266415, 'f1-score': 0.28578333772131903, 'support': 1417092}, '2': {'precision': 0.4076554694415206, 'recall': 0.6531980886007341, 'f1-score': 0.5020104262802125, 'support': 924349}, 'accuracy': 0.4301181371304396, 'macro avg': {'precision': 0.4500976686854485, 'recall': 0.47212899514559004, 'f1-score': 0.42256767053252103, 'support': 3257147}, 'weighted avg': {'precision': 0.46177347787882195, 'recall': 0.4301181371304396, 'f1-score': 0.4017227022971451, 'support': 3257147}}
[[519293 117799 278614]
 [540496 277882 598714]
 [188635 131931 603783]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0430236
{'0': {'precision': 0.42596633257542543, 'recall': 0.5311796398620477, 'f1-score': 0.4727902527857166, 'support': 943805}, '1': {'precision': 0.4888770089874448, 'recall': 0.2510219000423759, 'f1-score': 0.3317178446552245, 'support': 1373422}, '2': {'precision': 0.4088618540716224, 'recall': 0.598127500212784, 'f1-score': 0.4857082503757122, 'support': 939920}, 'accuracy': 0.43236642374446105, 'macro avg': {'precision': 0.4412350652114976, 'recall': 0.4601096800390692, 'f1-score': 0.43007211593888445, 'support': 3257147}, 'weighted avg': {'precision': 0.4475576410376636, 'recall': 0.43236642374446105, 'f1-score': 0.41703284772398375, 'support': 3257147}}
[[501330 172505 269970]
 [485808 344759 542855]
 [189786 187942 562192]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0474783
{'0': {'precision': 0.4305717824690131, 'recall': 0.48324629616171266, 'f1-score': 0.45539090104602603, 'support': 963190}, '1': {'precision': 0.4576229753389937, 'recall': 0.3201529885116099, 'f1-score': 0.376739241056041, 'support': 1333172}, '2': {'precision': 0.413024544066165, 'recall': 0.5345316590079987, 'f1-score': 0.46598754571907913, 'support': 960785}, 'accuracy': 0.43161914399319407, 'macro avg': {'precision': 0.4337397672913906, 'recall': 0.44597698122710705, 'f1-score': 0.43270589594038206, 'support': 3257147}, 'weighted avg': {'precision': 0.43646797611700544, 'recall': 0.43161914399319407, 'f1-score': 0.4263240233153099, 'support': 3257147}}
[[465458 242655 255077]
 [431563 426819 474790]
 [184002 263213 513570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0525684
{'0': {'precision': 0.37785912329198595, 'recall': 0.4154123562203698, 'f1-score': 0.39574686038776774, 'support': 877906}, '1': {'precision': 0.5016777567308027, 'recall': 0.3914001085653841, 'f1-score': 0.43973036636431106, 'support': 1506926}, '2': {'precision': 0.3736941398208748, 'recall': 0.478221743292274, 'f1-score': 0.41954532494497465, 'support': 872315}, 'accuracy': 0.42112437664004726, 'macro avg': {'precision': 0.4177436732812212, 'recall': 0.4283447360260093, 'f1-score': 0.4183408505656845, 'support': 3257147}, 'weighted avg': {'precision': 0.43402863005874226, 'recall': 0.42112437664004726, 'f1-score': 0.4224695248353436, 'support': 3257147}}
[[364693 287766 225447]
 [443408 589811 473707]
 [157055 298100 417160]]
Evaluating performance on  train set...
5165/5165 - 83s - 83s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0629402
{'0': {'precision': 0.4749147797364592, 'recall': 0.4301689991174921, 'f1-score': 0.45143581232672314, 'support': 438523}, '1': {'precision': 0.40982896527048723, 'recall': 0.39287479211750187, 'f1-score': 0.4011728313277303, 'support': 443159}, '2': {'precision': 0.46675065490831286, 'recall': 0.5299668498251668, 'f1-score': 0.49635402821933244, 'support': 440420}, 'accuracy': 0.4509130157884944, 'macro avg': {'precision': 0.4504981333050864, 'recall': 0.4510035470200536, 'f1-score': 0.44965422395792864, 'support': 1322102}, 'weighted avg': {'precision': 0.4503788450583951, 'recall': 0.4509130157884944, 'f1-score': 0.4495512287218956, 'support': 1322102}}
[[188639 133670 116214]
 [118605 174106 150448]
 [ 89962 117050 233408]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0731063
{'0': {'precision': 0.47234001753232524, 'recall': 0.3906974741741272, 'f1-score': 0.4276570915508066, 'support': 441321}, '1': {'precision': 0.3856301257275306, 'recall': 0.44572930833771873, 'f1-score': 0.41350742451845246, 'support': 438957}, '2': {'precision': 0.463425210420396, 'recall': 0.4716810313609039, 'f1-score': 0.4675166765935443, 'support': 441824}, 'accuracy': 0.4360321669583739, 'macro avg': {'precision': 0.4404651178934173, 'recall': 0.4360359379575833, 'f1-score': 0.4362270642209345, 'support': 1322102}, 'weighted avg': {'precision': 0.44057190152132286, 'recall': 0.4360321669583739, 'f1-score': 0.43627959262137567, 'support': 1322102}}
[[172423 163321 105577]
 [107583 195656 135718]
 [ 85034 148390 208400]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0833465
{'0': {'precision': 0.4709667492422028, 'recall': 0.343922263945725, 'f1-score': 0.39754113264791907, 'support': 444993}, '1': {'precision': 0.36532656814783393, 'recall': 0.5173713471926817, 'f1-score': 0.4282540956381669, 'support': 431141}, '2': {'precision': 0.46153348681998085, 'recall': 0.4000623363111255, 'f1-score': 0.4286050606699034, 'support': 445968}, 'accuracy': 0.4194214969798094, 'macro avg': {'precision': 0.43260893473667245, 'recall': 0.4204519824831774, 'f1-score': 0.41813342965199646, 'support': 1322102}, 'weighted avg': {'precision': 0.4333352000174676, 'recall': 0.4194214969798094, 'f1-score': 0.41803511528215365, 'support': 1322102}}
[[153043 198848  93102]
 [ 93028 223060 115053]
 [ 78884 188669 178415]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0907178
{'0': {'precision': 0.4631334592382751, 'recall': 0.29409386491501827, 'f1-score': 0.3597458904461643, 'support': 440271}, '1': {'precision': 0.368524464064747, 'recall': 0.6004795444327888, 'f1-score': 0.4567399109876844, 'support': 440418}, '2': {'precision': 0.44013579479350695, 'recall': 0.32396191321959256, 'f1-score': 0.37321728010021993, 'support': 441413}, 'accuracy': 0.4061290278662312, 'macro avg': {'precision': 0.4239312393655097, 'recall': 0.40617844085579985, 'f1-score': 0.39656769384468954, 'support': 1322102}, 'weighted avg': {'precision': 0.4239390759819958, 'recall': 0.4061290278662312, 'f1-score': 0.3965542146603481, 'support': 1322102}}
[[129481 228995  81795]
 [ 75850 264462 100106]
 [ 74245 224167 143001]]
Evaluating performance on  val set...
1903/1903 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1617148
{'0': {'precision': 0.5197177847248114, 'recall': 0.11053299337570605, 'f1-score': 0.18229557012006498, 'support': 163942}, '1': {'precision': 0.4138331902941406, 'recall': 0.33875562027386064, 'f1-score': 0.3725495704944056, 'support': 156576}, '2': {'precision': 0.4067933683784877, 'recall': 0.7915930851383333, 'f1-score': 0.5374139811803565, 'support': 166482}, 'accuracy': 0.4167310061601643, 'macro avg': {'precision': 0.4467814477991466, 'recall': 0.4136272329293, 'f1-score': 0.364086373931609, 'support': 487000}, 'weighted avg': {'precision': 0.4470712365939174, 'recall': 0.4167310061601643, 'f1-score': 0.36486237437622976, 'support': 487000}}
[[ 18121  44850 100971]
 [ 12329  53041  91206]
 [  4417  30279 131786]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1581929
{'0': {'precision': 0.5227280754423763, 'recall': 0.09017627023634713, 'f1-score': 0.1538173730487019, 'support': 164123}, '1': {'precision': 0.3944509421702404, 'recall': 0.38091951282260444, 'f1-score': 0.3875671551743401, 'support': 159367}, '2': {'precision': 0.4003385971186435, 'recall': 0.7462418200721669, 'f1-score': 0.5211137376493976, 'support': 163510}, 'accuracy': 0.40559342915811086, 'macro avg': {'precision': 0.4391725382437534, 'recall': 0.4057792010437062, 'f1-score': 0.3541660886241466, 'support': 487000}, 'weighted avg': {'precision': 0.4396581668204173, 'recall': 0.40559342915811086, 'f1-score': 0.35362975519218515, 'support': 487000}}
[[ 14800  55460  93863]
 [  9755  60706  88906]
 [  3758  37734 122018]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1516101
{'0': {'precision': 0.5179884627240301, 'recall': 0.07210371460095623, 'f1-score': 0.12658663753907742, 'support': 163140}, '1': {'precision': 0.38586246015882447, 'recall': 0.44040176094114164, 'f1-score': 0.41133212015111026, 'support': 162186}, '2': {'precision': 0.3973801942109241, 'recall': 0.6862018630082759, 'f1-score': 0.5032992707352758, 'support': 161674}, 'accuracy': 0.39862628336755646, 'macro avg': {'precision': 0.43374370569792625, 'recall': 0.3995691128501246, 'f1-score': 0.3470726761418212, 'support': 487000}, 'weighted avg': {'precision': 0.43394696568988567, 'recall': 0.39862628336755646, 'f1-score': 0.34647651249241895, 'support': 487000}}
[[ 11763  66113  85264]
 [  7783  71427  82976]
 [  3163  47570 110941]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1416799
{'0': {'precision': 0.4526429926809433, 'recall': 0.05290740412156853, 'f1-score': 0.09474096306929401, 'support': 157804}, '1': {'precision': 0.41427512152253315, 'recall': 0.522837684056079, 'f1-score': 0.46226802965338837, 'support': 173113}, '2': {'precision': 0.3900118763420866, 'recall': 0.6248790707508185, 'f1-score': 0.4802688595627339, 'support': 156083}, 'accuracy': 0.4032689938398357, 'macro avg': {'precision': 0.4189766635151877, 'recall': 0.40020805297615536, 'f1-score': 0.34575928409513873, 'support': 487000}, 'weighted avg': {'precision': 0.41893122715452935, 'recall': 0.4032689938398357, 'f1-score': 0.34894643277351967, 'support': 487000}}
[[ 8349 72090 77365]
 [ 7424 90510 75179]
 [ 2672 55878 97533]]
training model: results/AAPL/W4/deepOF_L2/seq2seq
Epoch 1/50
5165/5165 - 165s - loss: 12.2682 - accuracy10: 0.4923 - accuracy20: 0.4784 - accuracy30: 0.4651 - accuracy50: 0.4649 - val_loss: 12.7016 - val_accuracy10: 0.4588 - val_accuracy20: 0.4247 - val_accuracy30: 0.3996 - val_accuracy50: 0.3845 - 165s/epoch - 32ms/step
Epoch 2/50
5165/5165 - 157s - loss: 12.0875 - accuracy10: 0.5129 - accuracy20: 0.4933 - accuracy30: 0.4774 - accuracy50: 0.4724 - val_loss: 12.6468 - val_accuracy10: 0.4746 - val_accuracy20: 0.4421 - val_accuracy30: 0.4172 - val_accuracy50: 0.3933 - 157s/epoch - 30ms/step
Epoch 3/50
5165/5165 - 155s - loss: 12.0127 - accuracy10: 0.5199 - accuracy20: 0.4990 - accuracy30: 0.4821 - accuracy50: 0.4772 - val_loss: 12.5295 - val_accuracy10: 0.4862 - val_accuracy20: 0.4521 - val_accuracy30: 0.4260 - val_accuracy50: 0.4014 - 155s/epoch - 30ms/step
Epoch 4/50
5165/5165 - 153s - loss: 11.9661 - accuracy10: 0.5238 - accuracy20: 0.5019 - accuracy30: 0.4842 - accuracy50: 0.4798 - val_loss: 12.5243 - val_accuracy10: 0.4923 - val_accuracy20: 0.4569 - val_accuracy30: 0.4285 - val_accuracy50: 0.4018 - 153s/epoch - 30ms/step
Epoch 5/50
5165/5165 - 156s - loss: 11.9350 - accuracy10: 0.5260 - accuracy20: 0.5035 - accuracy30: 0.4860 - accuracy50: 0.4814 - val_loss: 12.4969 - val_accuracy10: 0.4940 - val_accuracy20: 0.4593 - val_accuracy30: 0.4317 - val_accuracy50: 0.4050 - 156s/epoch - 30ms/step
Epoch 6/50
5165/5165 - 154s - loss: 11.9093 - accuracy10: 0.5285 - accuracy20: 0.5052 - accuracy30: 0.4875 - accuracy50: 0.4833 - val_loss: 12.4942 - val_accuracy10: 0.4960 - val_accuracy20: 0.4606 - val_accuracy30: 0.4329 - val_accuracy50: 0.4071 - 154s/epoch - 30ms/step
Epoch 7/50
5165/5165 - 153s - loss: 11.8886 - accuracy10: 0.5300 - accuracy20: 0.5066 - accuracy30: 0.4889 - accuracy50: 0.4844 - val_loss: 12.4506 - val_accuracy10: 0.4978 - val_accuracy20: 0.4627 - val_accuracy30: 0.4348 - val_accuracy50: 0.4092 - 153s/epoch - 30ms/step
Epoch 8/50
5165/5165 - 151s - loss: 11.8703 - accuracy10: 0.5313 - accuracy20: 0.5079 - accuracy30: 0.4897 - accuracy50: 0.4854 - val_loss: 12.5318 - val_accuracy10: 0.4964 - val_accuracy20: 0.4615 - val_accuracy30: 0.4335 - val_accuracy50: 0.4087 - 151s/epoch - 29ms/step
Epoch 9/50
5165/5165 - 150s - loss: 11.8540 - accuracy10: 0.5327 - accuracy20: 0.5090 - accuracy30: 0.4909 - accuracy50: 0.4865 - val_loss: 12.4429 - val_accuracy10: 0.4996 - val_accuracy20: 0.4657 - val_accuracy30: 0.4388 - val_accuracy50: 0.4138 - 150s/epoch - 29ms/step
Epoch 10/50
5165/5165 - 149s - loss: 11.8406 - accuracy10: 0.5339 - accuracy20: 0.5102 - accuracy30: 0.4917 - accuracy50: 0.4869 - val_loss: 12.5015 - val_accuracy10: 0.4986 - val_accuracy20: 0.4643 - val_accuracy30: 0.4367 - val_accuracy50: 0.4126 - 149s/epoch - 29ms/step
Epoch 11/50
5165/5165 - 149s - loss: 11.8273 - accuracy10: 0.5348 - accuracy20: 0.5111 - accuracy30: 0.4927 - accuracy50: 0.4876 - val_loss: 12.4621 - val_accuracy10: 0.4986 - val_accuracy20: 0.4653 - val_accuracy30: 0.4380 - val_accuracy50: 0.4134 - 149s/epoch - 29ms/step
Epoch 12/50
5165/5165 - 147s - loss: 11.8150 - accuracy10: 0.5358 - accuracy20: 0.5122 - accuracy30: 0.4934 - accuracy50: 0.4886 - val_loss: 12.4519 - val_accuracy10: 0.4996 - val_accuracy20: 0.4666 - val_accuracy30: 0.4388 - val_accuracy50: 0.4154 - 147s/epoch - 28ms/step
Epoch 13/50
5165/5165 - 148s - loss: 11.8055 - accuracy10: 0.5365 - accuracy20: 0.5128 - accuracy30: 0.4941 - accuracy50: 0.4891 - val_loss: 12.4116 - val_accuracy10: 0.5011 - val_accuracy20: 0.4678 - val_accuracy30: 0.4407 - val_accuracy50: 0.4162 - 148s/epoch - 29ms/step
Epoch 14/50
5165/5165 - 151s - loss: 11.7939 - accuracy10: 0.5372 - accuracy20: 0.5131 - accuracy30: 0.4947 - accuracy50: 0.4892 - val_loss: 12.4255 - val_accuracy10: 0.5012 - val_accuracy20: 0.4689 - val_accuracy30: 0.4401 - val_accuracy50: 0.4147 - 151s/epoch - 29ms/step
Epoch 15/50
5165/5165 - 152s - loss: 11.7856 - accuracy10: 0.5377 - accuracy20: 0.5139 - accuracy30: 0.4955 - accuracy50: 0.4898 - val_loss: 12.4237 - val_accuracy10: 0.5012 - val_accuracy20: 0.4682 - val_accuracy30: 0.4409 - val_accuracy50: 0.4171 - 152s/epoch - 29ms/step
Epoch 16/50
5165/5165 - 146s - loss: 11.7786 - accuracy10: 0.5383 - accuracy20: 0.5142 - accuracy30: 0.4958 - accuracy50: 0.4902 - val_loss: 12.4156 - val_accuracy10: 0.5019 - val_accuracy20: 0.4700 - val_accuracy30: 0.4416 - val_accuracy50: 0.4171 - 146s/epoch - 28ms/step
Epoch 17/50
5165/5165 - 153s - loss: 11.7689 - accuracy10: 0.5388 - accuracy20: 0.5151 - accuracy30: 0.4966 - accuracy50: 0.4904 - val_loss: 12.3841 - val_accuracy10: 0.5033 - val_accuracy20: 0.4708 - val_accuracy30: 0.4427 - val_accuracy50: 0.4174 - 153s/epoch - 30ms/step
Epoch 18/50
5165/5165 - 156s - loss: 11.7608 - accuracy10: 0.5397 - accuracy20: 0.5157 - accuracy30: 0.4973 - accuracy50: 0.4911 - val_loss: 12.4456 - val_accuracy10: 0.5021 - val_accuracy20: 0.4693 - val_accuracy30: 0.4414 - val_accuracy50: 0.4162 - 156s/epoch - 30ms/step
Epoch 19/50
5165/5165 - 149s - loss: 11.7540 - accuracy10: 0.5400 - accuracy20: 0.5162 - accuracy30: 0.4976 - accuracy50: 0.4914 - val_loss: 12.4378 - val_accuracy10: 0.5027 - val_accuracy20: 0.4695 - val_accuracy30: 0.4414 - val_accuracy50: 0.4161 - 149s/epoch - 29ms/step
Epoch 20/50
5165/5165 - 143s - loss: 11.7446 - accuracy10: 0.5408 - accuracy20: 0.5169 - accuracy30: 0.4983 - accuracy50: 0.4918 - val_loss: 12.4078 - val_accuracy10: 0.5024 - val_accuracy20: 0.4705 - val_accuracy30: 0.4431 - val_accuracy50: 0.4182 - 143s/epoch - 28ms/step
Epoch 21/50
5165/5165 - 143s - loss: 11.7381 - accuracy10: 0.5410 - accuracy20: 0.5173 - accuracy30: 0.4984 - accuracy50: 0.4925 - val_loss: 12.4801 - val_accuracy10: 0.5022 - val_accuracy20: 0.4688 - val_accuracy30: 0.4404 - val_accuracy50: 0.4166 - 143s/epoch - 28ms/step
Epoch 22/50
5165/5165 - 144s - loss: 11.7303 - accuracy10: 0.5418 - accuracy20: 0.5177 - accuracy30: 0.4993 - accuracy50: 0.4929 - val_loss: 12.4710 - val_accuracy10: 0.5011 - val_accuracy20: 0.4678 - val_accuracy30: 0.4400 - val_accuracy50: 0.4167 - 144s/epoch - 28ms/step
Epoch 23/50
5165/5165 - 144s - loss: 11.7239 - accuracy10: 0.5422 - accuracy20: 0.5184 - accuracy30: 0.5000 - accuracy50: 0.4934 - val_loss: 12.4837 - val_accuracy10: 0.4999 - val_accuracy20: 0.4670 - val_accuracy30: 0.4398 - val_accuracy50: 0.4167 - 144s/epoch - 28ms/step
Epoch 24/50
5165/5165 - 143s - loss: 11.7155 - accuracy10: 0.5427 - accuracy20: 0.5189 - accuracy30: 0.5007 - accuracy50: 0.4944 - val_loss: 12.4352 - val_accuracy10: 0.5034 - val_accuracy20: 0.4702 - val_accuracy30: 0.4425 - val_accuracy50: 0.4193 - 143s/epoch - 28ms/step
Epoch 25/50
5165/5165 - 149s - loss: 11.7097 - accuracy10: 0.5427 - accuracy20: 0.5193 - accuracy30: 0.5010 - accuracy50: 0.4948 - val_loss: 12.4857 - val_accuracy10: 0.5013 - val_accuracy20: 0.4676 - val_accuracy30: 0.4402 - val_accuracy50: 0.4186 - 149s/epoch - 29ms/step
Epoch 26/50
5165/5165 - 144s - loss: 11.7017 - accuracy10: 0.5434 - accuracy20: 0.5200 - accuracy30: 0.5014 - accuracy50: 0.4949 - val_loss: 12.5332 - val_accuracy10: 0.4989 - val_accuracy20: 0.4659 - val_accuracy30: 0.4394 - val_accuracy50: 0.4178 - 144s/epoch - 28ms/step
Epoch 27/50
5165/5165 - 145s - loss: 11.6956 - accuracy10: 0.5437 - accuracy20: 0.5205 - accuracy30: 0.5021 - accuracy50: 0.4958 - val_loss: 12.4422 - val_accuracy10: 0.5034 - val_accuracy20: 0.4705 - val_accuracy30: 0.4439 - val_accuracy50: 0.4222 - 145s/epoch - 28ms/step
testing model: results/AAPL/W4/deepOF_L2/seq2seq
Evaluating performance on  test set...
12724/12724 - 126s - 126s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9512871
{'0': {'precision': 0.5269688620416354, 'recall': 0.4450934911139213, 'f1-score': 0.4825830560211138, 'support': 915702}, '1': {'precision': 0.5320306048079075, 'recall': 0.6423647864782244, 'f1-score': 0.5820147599234671, 'support': 1417092}, '2': {'precision': 0.516483530704337, 'recall': 0.431771982227492, 'f1-score': 0.4703439416884196, 'support': 924349}, 'accuracy': 0.5271401961780616, 'macro avg': {'precision': 0.5251609991846267, 'recall': 0.5064100866065459, 'f1-score': 0.5116472525443335, 'support': 3257143}, 'weighted avg': {'precision': 0.5261954387205966, 'recall': 0.5271401961780616, 'f1-score': 0.5223696601254106, 'support': 3257143}}
[[407573 397708 110421]
 [243590 910290 263212]
 [122266 402975 399108]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9864406
{'0': {'precision': 0.5121015493112773, 'recall': 0.4091578530242572, 'f1-score': 0.45487811557831864, 'support': 943802}, '1': {'precision': 0.48822626203098995, 'recall': 0.6176834214101711, 'f1-score': 0.5453777509484034, 'support': 1373422}, '2': {'precision': 0.49401282871961016, 'recall': 0.4023240300493979, 'f1-score': 0.4434788778396014, 'support': 939919}, 'accuracy': 0.4951136624950148, 'macro avg': {'precision': 0.4981135466872924, 'recall': 0.47638843482794196, 'f1-score': 0.48124491478877446, 'support': 3257143}, 'weighted avg': {'precision': 0.49681429389238224, 'recall': 0.4951136624950148, 'f1-score': 0.48974911450993297, 'support': 3257143}}
[[386164 445803 111835]
 [249599 848340 275483]
 [118314 443453 378152]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0183136
{'0': {'precision': 0.5125818118246086, 'recall': 0.3409344800807319, 'f1-score': 0.4094984833227857, 'support': 963188}, '1': {'precision': 0.44490767791847413, 'recall': 0.6465344655711833, 'f1-score': 0.5270973811801736, 'support': 1333171}, '2': {'precision': 0.4791429850341899, 'recall': 0.3386911105930157, 'f1-score': 0.3968566989362973, 'support': 960784}, 'accuracy': 0.4653569094141706, 'macro avg': {'precision': 0.47887749159242426, 'recall': 0.44205335208164365, 'f1-score': 0.4444841878130856, 'support': 3257143}, 'weighted avg': {'precision': 0.4750186214664386, 'recall': 0.4653569094141706, 'f1-score': 0.45390347754178184, 'support': 3257143}}
[[328384 532292 102512]
 [220003 861941 251227]
 [ 92260 543115 325409]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0245699
{'0': {'precision': 0.45086849296299963, 'recall': 0.269887140279575, 'f1-score': 0.3376556563575059, 'support': 877904}, '1': {'precision': 0.4842632497171947, 'recall': 0.7093504985317783, 'f1-score': 0.5755838153028021, 'support': 1506925}, '2': {'precision': 0.4110466424813937, 'recall': 0.24705094725064597, 'f1-score': 0.3086152083631677, 'support': 872314}, 'accuracy': 0.46709002337324457, 'macro avg': {'precision': 0.448726128387196, 'recall': 0.4087628620206664, 'f1-score': 0.4072848933411586, 'support': 3257143}, 'weighted avg': {'precision': 0.4556537406910864, 'recall': 0.46709002337324457, 'f1-score': 0.439956200597322, 'support': 3257143}}
[[ 236935  554856   86113]
 [ 215320 1068938  222667]
 [  73253  583555  215506]]
Evaluating performance on  train set...
5165/5165 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9936861
{'0': {'precision': 0.5292507541210046, 'recall': 0.47534863567429503, 'f1-score': 0.5008536267422455, 'support': 438495}, '1': {'precision': 0.4524428945899515, 'recall': 0.5178420257759537, 'f1-score': 0.4829384445015222, 'support': 442971}, '2': {'precision': 0.5327762809632891, 'recall': 0.5093546600822447, 'f1-score': 0.5208022731148937, 'support': 440636}, 'accuracy': 0.5009197474930074, 'macro avg': {'precision': 0.5048233098914151, 'recall': 0.5008484405108312, 'f1-score': 0.5015314481195539, 'support': 1322102}, 'weighted avg': {'precision': 0.5046912418453607, 'recall': 0.5009197474930074, 'f1-score': 0.5014997081721977, 'support': 1322102}}
[[208438 146521  83536]
 [100293 229389 113289]
 [ 85105 131091 224440]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0218577
{'0': {'precision': 0.5122424592596483, 'recall': 0.4421894093455486, 'f1-score': 0.4746450699152645, 'support': 441087}, '1': {'precision': 0.4089512297452063, 'recall': 0.49241993255082583, 'f1-score': 0.4468208999603542, 'support': 439442}, '2': {'precision': 0.5159617955230796, 'recall': 0.48164403167766145, 'f1-score': 0.4982126459399187, 'support': 441573}, 'accuracy': 0.4720626698999018, 'macro avg': {'precision': 0.47905182817597813, 'recall': 0.47208445785801195, 'f1-score': 0.47322620527184583, 'support': 1322102}, 'weighted avg': {'precision': 0.47915261747101684, 'recall': 0.4720626698999018, 'f1-score': 0.4732682444922707, 'support': 1322102}}
[[195044 164526  81517]
 [105047 216390 118005]
 [ 80674 148218 212681]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0452902
{'0': {'precision': 0.5144802214658054, 'recall': 0.3784580804675208, 'f1-score': 0.43610895989763965, 'support': 444900}, '1': {'precision': 0.37190581541848045, 'recall': 0.5416325479652883, 'f1-score': 0.44100237599676656, 'support': 431093}, '2': {'precision': 0.508701706008496, 'recall': 0.4184896516322244, 'f1-score': 0.45920704065644574, 'support': 446109}, 'accuracy': 0.4451714012988408, 'macro avg': {'precision': 0.46502924763092723, 'recall': 0.44619342668834444, 'f1-score': 0.44543945885028396, 'support': 1322102}, 'weighted avg': {'precision': 0.4660416923823426, 'recall': 0.4451714012988408, 'f1-score': 0.4454983860808321, 'support': 1322102}}
[[168376 202584  73940]
 [ 91234 233494 106365]
 [ 67664 191753 186692]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0768594
{'0': {'precision': 0.49580942955666546, 'recall': 0.2912692356606893, 'f1-score': 0.36696213469450817, 'support': 440328}, '1': {'precision': 0.35894022305041695, 'recall': 0.6379852618909744, 'f1-score': 0.45940960616427157, 'support': 440355}, '2': {'precision': 0.47719363238379525, 'recall': 0.3034848975689764, 'f1-score': 0.37101330467823945, 'support': 441419}, 'accuracy': 0.41082911908460923, 'macro avg': {'precision': 0.4439810949969592, 'recall': 0.41091313170688, 'f1-score': 0.39912834851233975, 'support': 1322102}, 'weighted avg': {'precision': 0.4440067653119171, 'recall': 0.41082911908460923, 'f1-score': 0.39910637901311324, 'support': 1322102}}
[[128254 249454  62620]
 [ 75266 280940  84149]
 [ 55156 252299 133964]]
Evaluating performance on  val set...
1903/1903 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9912171
{'0': {'precision': 0.5346351974680987, 'recall': 0.4844468851058637, 'f1-score': 0.5083051905440228, 'support': 163890}, '1': {'precision': 0.45224526499185075, 'recall': 0.5141035388222667, 'f1-score': 0.4811945546582309, 'support': 156521}, '2': {'precision': 0.5324356642834011, 'recall': 0.5131822220087882, 'f1-score': 0.5226316819093266, 'support': 166588}, 'accuracy': 0.5038080160328872, 'macro avg': {'precision': 0.5064387089144501, 'recall': 0.5039108819789728, 'f1-score': 0.5040438090371935, 'support': 486999}, 'weighted avg': {'precision': 0.5074027586842671, 'recall': 0.5038080160328872, 'f1-score': 0.5044925291301045, 'support': 486999}}
[[79396 49855 34639]
 [35618 80468 40435]
 [33491 47607 85490]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0233822
{'0': {'precision': 0.5111039565500396, 'recall': 0.4442585551330798, 'f1-score': 0.4753427154257742, 'support': 164375}, '1': {'precision': 0.41159036583666514, 'recall': 0.48273586150973996, 'f1-score': 0.44433322822436233, 'support': 159087}, '2': {'precision': 0.5061001929717652, 'recall': 0.4875288161088928, 'f1-score': 0.49664095081180915, 'support': 163537}, 'accuracy': 0.47135825740915277, 'macro avg': {'precision': 0.47626483845282336, 'recall': 0.47150774425057085, 'f1-score': 0.47210563148731516, 'support': 486999}, 'weighted avg': {'precision': 0.4769157567998988, 'recall': 0.47135825740915277, 'f1-score': 0.47236497467048516, 'support': 486999}}
[[73025 57400 33950]
 [38433 76797 43857]
 [31419 52389 79729]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0460565
{'0': {'precision': 0.5009826054473697, 'recall': 0.3781120141212812, 'f1-score': 0.43096053091163117, 'support': 163158}, '1': {'precision': 0.37999245574486046, 'recall': 0.52200761244394, 'f1-score': 0.43982026513231925, 'support': 162103}, '2': {'precision': 0.49017857775322127, 'recall': 0.4278462698932842, 'f1-score': 0.4568962955871235, 'support': 161738}, 'accuracy': 0.44252657602993023, 'macro avg': {'precision': 0.45705121298181717, 'recall': 0.44265529881950183, 'f1-score': 0.4425590305436913, 'support': 486999}, 'weighted avg': {'precision': 0.4571215542574863, 'recall': 0.44252657602993023, 'f1-score': 0.4425231587680764, 'support': 486999}}
[[61692 71363 30103]
 [35615 84619 41869]
 [25835 66704 69199]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0680777
{'0': {'precision': 0.4749675666288703, 'recall': 0.29483643096746376, 'f1-score': 0.3638270068937456, 'support': 157701}, '1': {'precision': 0.3835666216596544, 'recall': 0.6222604956537822, 'f1-score': 0.47459121354312456, 'support': 173024}, '2': {'precision': 0.4544364397789851, 'recall': 0.3152475779720235, 'f1-score': 0.3722566239614935, 'support': 156274}, 'accuracy': 0.4177154367873445, 'macro avg': {'precision': 0.43765687602250325, 'recall': 0.4107815015310898, 'f1-score': 0.4035582814661212, 'support': 486999}, 'weighted avg': {'precision': 0.43590580588666633, 'recall': 0.4177154367873445, 'f1-score': 0.4058849907272799, 'support': 486999}}
[[ 46496  86787  24418]
 [ 30632 107666  34726]
 [ 20765  86244  49265]]
training model: results/AAPL/W4/deepVOL_L2/seq2seq
Epoch 1/50
5165/5165 - 151s - loss: 12.4045 - accuracy10: 0.4735 - accuracy20: 0.4639 - accuracy30: 0.4528 - accuracy50: 0.4576 - val_loss: 12.7006 - val_accuracy10: 0.4419 - val_accuracy20: 0.4262 - val_accuracy30: 0.4131 - val_accuracy50: 0.4014 - 151s/epoch - 29ms/step
Epoch 2/50
5165/5165 - 142s - loss: 12.2215 - accuracy10: 0.4955 - accuracy20: 0.4817 - accuracy30: 0.4678 - accuracy50: 0.4656 - val_loss: 12.6122 - val_accuracy10: 0.4718 - val_accuracy20: 0.4423 - val_accuracy30: 0.4174 - val_accuracy50: 0.3975 - 142s/epoch - 28ms/step
Epoch 3/50
5165/5165 - 141s - loss: 12.1554 - accuracy10: 0.5042 - accuracy20: 0.4878 - accuracy30: 0.4724 - accuracy50: 0.4692 - val_loss: 12.4677 - val_accuracy10: 0.4901 - val_accuracy20: 0.4570 - val_accuracy30: 0.4248 - val_accuracy50: 0.4011 - 141s/epoch - 27ms/step
Epoch 4/50
5165/5165 - 140s - loss: 12.0880 - accuracy10: 0.5111 - accuracy20: 0.4939 - accuracy30: 0.4766 - accuracy50: 0.4733 - val_loss: 12.4888 - val_accuracy10: 0.5008 - val_accuracy20: 0.4649 - val_accuracy30: 0.4268 - val_accuracy50: 0.4011 - 140s/epoch - 27ms/step
Epoch 5/50
5165/5165 - 140s - loss: 12.0309 - accuracy10: 0.5170 - accuracy20: 0.4983 - accuracy30: 0.4802 - accuracy50: 0.4771 - val_loss: 12.4782 - val_accuracy10: 0.5028 - val_accuracy20: 0.4668 - val_accuracy30: 0.4291 - val_accuracy50: 0.4024 - 140s/epoch - 27ms/step
Epoch 6/50
5165/5165 - 140s - loss: 11.9863 - accuracy10: 0.5208 - accuracy20: 0.5011 - accuracy30: 0.4829 - accuracy50: 0.4797 - val_loss: 12.4083 - val_accuracy10: 0.5089 - val_accuracy20: 0.4734 - val_accuracy30: 0.4317 - val_accuracy50: 0.4015 - 140s/epoch - 27ms/step
Epoch 7/50
5165/5165 - 142s - loss: 11.9510 - accuracy10: 0.5241 - accuracy20: 0.5036 - accuracy30: 0.4851 - accuracy50: 0.4817 - val_loss: 12.4052 - val_accuracy10: 0.5091 - val_accuracy20: 0.4731 - val_accuracy30: 0.4323 - val_accuracy50: 0.4016 - 142s/epoch - 27ms/step
Epoch 8/50
5165/5165 - 142s - loss: 11.9242 - accuracy10: 0.5265 - accuracy20: 0.5054 - accuracy30: 0.4867 - accuracy50: 0.4832 - val_loss: 12.3689 - val_accuracy10: 0.5129 - val_accuracy20: 0.4772 - val_accuracy30: 0.4380 - val_accuracy50: 0.4055 - 142s/epoch - 27ms/step
Epoch 9/50
5165/5165 - 141s - loss: 11.9018 - accuracy10: 0.5286 - accuracy20: 0.5072 - accuracy30: 0.4880 - accuracy50: 0.4842 - val_loss: 12.4156 - val_accuracy10: 0.5073 - val_accuracy20: 0.4735 - val_accuracy30: 0.4367 - val_accuracy50: 0.4060 - 141s/epoch - 27ms/step
Epoch 10/50
5165/5165 - 142s - loss: 11.8835 - accuracy10: 0.5298 - accuracy20: 0.5083 - accuracy30: 0.4889 - accuracy50: 0.4850 - val_loss: 12.3344 - val_accuracy10: 0.5117 - val_accuracy20: 0.4787 - val_accuracy30: 0.4442 - val_accuracy50: 0.4134 - 142s/epoch - 27ms/step
Epoch 11/50
5165/5165 - 139s - loss: 11.8682 - accuracy10: 0.5310 - accuracy20: 0.5094 - accuracy30: 0.4900 - accuracy50: 0.4859 - val_loss: 12.3009 - val_accuracy10: 0.5141 - val_accuracy20: 0.4817 - val_accuracy30: 0.4454 - val_accuracy50: 0.4110 - 139s/epoch - 27ms/step
Epoch 12/50
5165/5165 - 141s - loss: 11.8538 - accuracy10: 0.5323 - accuracy20: 0.5103 - accuracy30: 0.4905 - accuracy50: 0.4862 - val_loss: 12.2860 - val_accuracy10: 0.5154 - val_accuracy20: 0.4840 - val_accuracy30: 0.4477 - val_accuracy50: 0.4137 - 141s/epoch - 27ms/step
Epoch 13/50
5165/5165 - 141s - loss: 11.8409 - accuracy10: 0.5336 - accuracy20: 0.5119 - accuracy30: 0.4918 - accuracy50: 0.4867 - val_loss: 12.2745 - val_accuracy10: 0.5150 - val_accuracy20: 0.4833 - val_accuracy30: 0.4492 - val_accuracy50: 0.4176 - 141s/epoch - 27ms/step
Epoch 14/50
5165/5165 - 139s - loss: 11.8281 - accuracy10: 0.5346 - accuracy20: 0.5127 - accuracy30: 0.4926 - accuracy50: 0.4874 - val_loss: 12.2573 - val_accuracy10: 0.5164 - val_accuracy20: 0.4858 - val_accuracy30: 0.4527 - val_accuracy50: 0.4208 - 139s/epoch - 27ms/step
Epoch 15/50
5165/5165 - 139s - loss: 11.8182 - accuracy10: 0.5354 - accuracy20: 0.5135 - accuracy30: 0.4932 - accuracy50: 0.4880 - val_loss: 12.2241 - val_accuracy10: 0.5180 - val_accuracy20: 0.4883 - val_accuracy30: 0.4556 - val_accuracy50: 0.4218 - 139s/epoch - 27ms/step
Epoch 16/50
5165/5165 - 139s - loss: 11.8081 - accuracy10: 0.5360 - accuracy20: 0.5137 - accuracy30: 0.4938 - accuracy50: 0.4886 - val_loss: 12.2239 - val_accuracy10: 0.5187 - val_accuracy20: 0.4890 - val_accuracy30: 0.4567 - val_accuracy50: 0.4214 - 139s/epoch - 27ms/step
Epoch 17/50
5165/5165 - 141s - loss: 11.7986 - accuracy10: 0.5367 - accuracy20: 0.5143 - accuracy30: 0.4947 - accuracy50: 0.4892 - val_loss: 12.2257 - val_accuracy10: 0.5186 - val_accuracy20: 0.4902 - val_accuracy30: 0.4579 - val_accuracy50: 0.4253 - 141s/epoch - 27ms/step
Epoch 18/50
5165/5165 - 140s - loss: 11.7897 - accuracy10: 0.5374 - accuracy20: 0.5150 - accuracy30: 0.4952 - accuracy50: 0.4896 - val_loss: 12.1923 - val_accuracy10: 0.5219 - val_accuracy20: 0.4923 - val_accuracy30: 0.4601 - val_accuracy50: 0.4254 - 140s/epoch - 27ms/step
Epoch 19/50
5165/5165 - 140s - loss: 11.7805 - accuracy10: 0.5383 - accuracy20: 0.5155 - accuracy30: 0.4955 - accuracy50: 0.4901 - val_loss: 12.2136 - val_accuracy10: 0.5188 - val_accuracy20: 0.4895 - val_accuracy30: 0.4589 - val_accuracy50: 0.4256 - 140s/epoch - 27ms/step
Epoch 20/50
5165/5165 - 140s - loss: 11.7718 - accuracy10: 0.5386 - accuracy20: 0.5160 - accuracy30: 0.4961 - accuracy50: 0.4903 - val_loss: 12.1854 - val_accuracy10: 0.5204 - val_accuracy20: 0.4916 - val_accuracy30: 0.4611 - val_accuracy50: 0.4281 - 140s/epoch - 27ms/step
Epoch 21/50
5165/5165 - 139s - loss: 11.7643 - accuracy10: 0.5394 - accuracy20: 0.5167 - accuracy30: 0.4970 - accuracy50: 0.4911 - val_loss: 12.2118 - val_accuracy10: 0.5179 - val_accuracy20: 0.4899 - val_accuracy30: 0.4610 - val_accuracy50: 0.4287 - 139s/epoch - 27ms/step
Epoch 22/50
5165/5165 - 139s - loss: 11.7559 - accuracy10: 0.5396 - accuracy20: 0.5173 - accuracy30: 0.4974 - accuracy50: 0.4915 - val_loss: 12.1814 - val_accuracy10: 0.5202 - val_accuracy20: 0.4913 - val_accuracy30: 0.4615 - val_accuracy50: 0.4318 - 139s/epoch - 27ms/step
Epoch 23/50
5165/5165 - 142s - loss: 11.7490 - accuracy10: 0.5403 - accuracy20: 0.5177 - accuracy30: 0.4977 - accuracy50: 0.4921 - val_loss: 12.1633 - val_accuracy10: 0.5222 - val_accuracy20: 0.4931 - val_accuracy30: 0.4625 - val_accuracy50: 0.4324 - 142s/epoch - 27ms/step
Epoch 24/50
5165/5165 - 140s - loss: 11.7431 - accuracy10: 0.5406 - accuracy20: 0.5181 - accuracy30: 0.4981 - accuracy50: 0.4919 - val_loss: 12.1538 - val_accuracy10: 0.5226 - val_accuracy20: 0.4936 - val_accuracy30: 0.4641 - val_accuracy50: 0.4331 - 140s/epoch - 27ms/step
Epoch 25/50
5165/5165 - 142s - loss: 11.7354 - accuracy10: 0.5410 - accuracy20: 0.5184 - accuracy30: 0.4987 - accuracy50: 0.4928 - val_loss: 12.1638 - val_accuracy10: 0.5213 - val_accuracy20: 0.4930 - val_accuracy30: 0.4643 - val_accuracy50: 0.4338 - 142s/epoch - 27ms/step
Epoch 26/50
5165/5165 - 140s - loss: 11.7279 - accuracy10: 0.5415 - accuracy20: 0.5190 - accuracy30: 0.4995 - accuracy50: 0.4934 - val_loss: 12.1776 - val_accuracy10: 0.5212 - val_accuracy20: 0.4924 - val_accuracy30: 0.4635 - val_accuracy50: 0.4353 - 140s/epoch - 27ms/step
Epoch 27/50
5165/5165 - 141s - loss: 11.7238 - accuracy10: 0.5419 - accuracy20: 0.5191 - accuracy30: 0.4994 - accuracy50: 0.4934 - val_loss: 12.1596 - val_accuracy10: 0.5226 - val_accuracy20: 0.4931 - val_accuracy30: 0.4641 - val_accuracy50: 0.4333 - 141s/epoch - 27ms/step
Epoch 28/50
5165/5165 - 140s - loss: 11.7160 - accuracy10: 0.5420 - accuracy20: 0.5198 - accuracy30: 0.5002 - accuracy50: 0.4941 - val_loss: 12.1989 - val_accuracy10: 0.5205 - val_accuracy20: 0.4899 - val_accuracy30: 0.4611 - val_accuracy50: 0.4333 - 140s/epoch - 27ms/step
Epoch 29/50
5165/5165 - 138s - loss: 11.7079 - accuracy10: 0.5429 - accuracy20: 0.5203 - accuracy30: 0.5008 - accuracy50: 0.4949 - val_loss: 12.1538 - val_accuracy10: 0.5229 - val_accuracy20: 0.4927 - val_accuracy30: 0.4640 - val_accuracy50: 0.4358 - 138s/epoch - 27ms/step
Epoch 30/50
5165/5165 - 139s - loss: 11.7023 - accuracy10: 0.5431 - accuracy20: 0.5210 - accuracy30: 0.5014 - accuracy50: 0.4949 - val_loss: 12.1669 - val_accuracy10: 0.5216 - val_accuracy20: 0.4921 - val_accuracy30: 0.4633 - val_accuracy50: 0.4335 - 139s/epoch - 27ms/step
Epoch 31/50
5165/5165 - 140s - loss: 11.6964 - accuracy10: 0.5432 - accuracy20: 0.5209 - accuracy30: 0.5018 - accuracy50: 0.4956 - val_loss: 12.1805 - val_accuracy10: 0.5210 - val_accuracy20: 0.4916 - val_accuracy30: 0.4631 - val_accuracy50: 0.4358 - 140s/epoch - 27ms/step
Epoch 32/50
5165/5165 - 140s - loss: 11.6900 - accuracy10: 0.5434 - accuracy20: 0.5215 - accuracy30: 0.5022 - accuracy50: 0.4958 - val_loss: 12.1605 - val_accuracy10: 0.5232 - val_accuracy20: 0.4929 - val_accuracy30: 0.4645 - val_accuracy50: 0.4380 - 140s/epoch - 27ms/step
Epoch 33/50
5165/5165 - 139s - loss: 11.6833 - accuracy10: 0.5442 - accuracy20: 0.5224 - accuracy30: 0.5031 - accuracy50: 0.4968 - val_loss: 12.1827 - val_accuracy10: 0.5216 - val_accuracy20: 0.4920 - val_accuracy30: 0.4640 - val_accuracy50: 0.4386 - 139s/epoch - 27ms/step
Epoch 34/50
5165/5165 - 138s - loss: 11.6779 - accuracy10: 0.5444 - accuracy20: 0.5223 - accuracy30: 0.5035 - accuracy50: 0.4973 - val_loss: 12.1692 - val_accuracy10: 0.5232 - val_accuracy20: 0.4927 - val_accuracy30: 0.4633 - val_accuracy50: 0.4354 - 138s/epoch - 27ms/step
Epoch 35/50
5165/5165 - 138s - loss: 11.6730 - accuracy10: 0.5447 - accuracy20: 0.5231 - accuracy30: 0.5035 - accuracy50: 0.4972 - val_loss: 12.1944 - val_accuracy10: 0.5212 - val_accuracy20: 0.4913 - val_accuracy30: 0.4630 - val_accuracy50: 0.4371 - 138s/epoch - 27ms/step
Epoch 36/50
5165/5165 - 138s - loss: 11.6659 - accuracy10: 0.5449 - accuracy20: 0.5233 - accuracy30: 0.5042 - accuracy50: 0.4982 - val_loss: 12.2037 - val_accuracy10: 0.5199 - val_accuracy20: 0.4900 - val_accuracy30: 0.4623 - val_accuracy50: 0.4371 - 138s/epoch - 27ms/step
Epoch 37/50
5165/5165 - 138s - loss: 11.6603 - accuracy10: 0.5454 - accuracy20: 0.5238 - accuracy30: 0.5049 - accuracy50: 0.4989 - val_loss: 12.2064 - val_accuracy10: 0.5207 - val_accuracy20: 0.4902 - val_accuracy30: 0.4604 - val_accuracy50: 0.4350 - 138s/epoch - 27ms/step
Epoch 38/50
5165/5165 - 140s - loss: 11.6534 - accuracy10: 0.5457 - accuracy20: 0.5239 - accuracy30: 0.5050 - accuracy50: 0.4993 - val_loss: 12.1958 - val_accuracy10: 0.5222 - val_accuracy20: 0.4913 - val_accuracy30: 0.4621 - val_accuracy50: 0.4368 - 140s/epoch - 27ms/step
Epoch 39/50
5165/5165 - 139s - loss: 11.6474 - accuracy10: 0.5458 - accuracy20: 0.5244 - accuracy30: 0.5055 - accuracy50: 0.5000 - val_loss: 12.2243 - val_accuracy10: 0.5211 - val_accuracy20: 0.4907 - val_accuracy30: 0.4605 - val_accuracy50: 0.4335 - 139s/epoch - 27ms/step
testing model: results/AAPL/W4/deepVOL_L2/seq2seq
Evaluating performance on  test set...
12724/12724 - 109s - 109s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9367027
{'0': {'precision': 0.5396708910779305, 'recall': 0.45936141075847486, 'f1-score': 0.4962882209417017, 'support': 915706}, '1': {'precision': 0.548369884642971, 'recall': 0.6215270427043551, 'f1-score': 0.5826610955942573, 'support': 1417092}, '2': {'precision': 0.5137425206381624, 'recall': 0.484405781798866, 'f1-score': 0.49864303079100675, 'support': 924349}, 'accuracy': 0.5370224309802413, 'macro avg': {'precision': 0.5339277654530213, 'recall': 0.521764745087232, 'f1-score': 0.5258641157756553, 'support': 3257147}, 'weighted avg': {'precision': 0.5360973375666648, 'recall': 0.5370224309802413, 'f1-score': 0.5345348753962089, 'support': 3257147}}
[[420640 363977 131089]
 [243615 880761 292716]
 [115183 361406 447760]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9779349
{'0': {'precision': 0.5144065871592562, 'recall': 0.4342962794221264, 'f1-score': 0.4709690985092737, 'support': 943805}, '1': {'precision': 0.5058747722671237, 'recall': 0.5630519971283408, 'f1-score': 0.53293417094033, 'support': 1373422}, '2': {'precision': 0.48383277752077186, 'recall': 0.47958549663801175, 'f1-score': 0.48169977489715965, 'support': 939920}, 'accuracy': 0.5016571250852356, 'macro avg': {'precision': 0.5013713789823839, 'recall': 0.49231125772949297, 'f1-score': 0.4952010147822545, 'support': 3257147}, 'weighted avg': {'precision': 0.5019862949746583, 'recall': 0.5016571250852356, 'f1-score': 0.5001941138551909, 'support': 3257147}}
[[409891 387203 146711]
 [265928 773308 334186]
 [121004 368144 450772]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0131402
{'0': {'precision': 0.5049734147859042, 'recall': 0.3707440899511, 'f1-score': 0.42757146705780225, 'support': 963190}, '1': {'precision': 0.45642052329877847, 'recall': 0.5814126009247119, 'f1-score': 0.5113898128181453, 'support': 1333172}, '2': {'precision': 0.4756493315894153, 'recall': 0.42165624983737254, 'f1-score': 0.4470283425112289, 'support': 960785}, 'accuracy': 0.47199005755650575, 'macro avg': {'precision': 0.47901442322469934, 'recall': 0.4579376469043948, 'f1-score': 0.46199654079572544, 'support': 3257147}, 'weighted avg': {'precision': 0.47645044829909444, 'recall': 0.47199005755650575, 'f1-score': 0.46761821525078484, 'support': 3257147}}
[[357097 473194 132899]
 [244347 775123 313702]
 [105716 449948 405121]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0207161
{'0': {'precision': 0.4422813765925614, 'recall': 0.31550986096461353, 'f1-score': 0.3682917635358073, 'support': 877906}, '1': {'precision': 0.49872251610349416, 'recall': 0.6345839145386037, 'f1-score': 0.5585096457243047, 'support': 1506926}, '2': {'precision': 0.41568047544625647, 'recall': 0.33997007961573517, 'f1-score': 0.37403247674601925, 'support': 872315}, 'accuracy': 0.46968098154612, 'macro avg': {'precision': 0.452228122714104, 'recall': 0.4300212850396508, 'f1-score': 0.43361129533537707, 'support': 3257147}, 'weighted avg': {'precision': 0.4612698519408379, 'recall': 0.46968098154612, 'f1-score': 0.4578339249975865, 'support': 3257147}}
[[276988 485149 115769]
 [249550 956271 301105]
 [ 99733 476021 296561]]
Evaluating performance on  train set...
5165/5165 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96057564
{'0': {'precision': 0.549103903556405, 'recall': 0.5280612419416998, 'f1-score': 0.5383770362026457, 'support': 438523}, '1': {'precision': 0.48767899202835135, 'recall': 0.5055273615113312, 'f1-score': 0.49644280511491495, 'support': 443159}, '2': {'precision': 0.5445300063944708, 'recall': 0.5452545297670406, 'f1-score': 0.5448920272376807, 'support': 440420}, 'accuracy': 0.5262354946895171, 'macro avg': {'precision': 0.5271043006597425, 'recall': 0.5262810444066905, 'f1-score': 0.5265706228517472, 'support': 1322102}, 'weighted avg': {'precision': 0.5269910573796956, 'recall': 0.5262354946895171, 'f1-score': 0.5264912667514554, 'support': 1322102}}
[[231567 119052  87904]
 [106169 224029 112961]
 [ 83982 116297 240141]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9920998
{'0': {'precision': 0.5351281681992496, 'recall': 0.4967336700496917, 'f1-score': 0.5152166095950776, 'support': 441321}, '1': {'precision': 0.4458146734128609, 'recall': 0.46127752832281976, 'f1-score': 0.4534143061718277, 'support': 438957}, '2': {'precision': 0.5224314422067677, 'recall': 0.5418696132396611, 'f1-score': 0.5319730203858072, 'support': 441824}, 'accuracy': 0.5000453822776155, 'macro avg': {'precision': 0.5011247612729594, 'recall': 0.4999602705373909, 'f1-score': 0.5002013120509042, 'support': 1322102}, 'weighted avg': {'precision': 0.5012317653529856, 'recall': 0.5000453822776155, 'f1-score': 0.5002970578036453, 'support': 1322102}}
[[219219 129735  92367]
 [109991 202481 126485]
 [ 80447 121966 239411]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.021937
{'0': {'precision': 0.5364916404530633, 'recall': 0.4185279319000524, 'f1-score': 0.470224366621599, 'support': 444993}, '1': {'precision': 0.39536813278184474, 'recall': 0.5183571035925602, 'f1-score': 0.44858535586647513, 'support': 431141}, '2': {'precision': 0.5211254198234788, 'recall': 0.47874062713019766, 'f1-score': 0.4990346678135343, 'support': 445968}, 'accuracy': 0.4713932813050733, 'macro avg': {'precision': 0.484328397686129, 'recall': 0.4718752208742701, 'f1-score': 0.4726147967672028, 'support': 1322102}, 'weighted avg': {'precision': 0.4852875934864817, 'recall': 0.4713932813050733, 'f1-score': 0.4728860430020826, 'support': 1322102}}
[[186242 176432  82319]
 [ 93782 223485 113874]
 [ 67124 165341 213503]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0590042
{'0': {'precision': 0.5175360727606856, 'recall': 0.3019163197212626, 'f1-score': 0.3813585458885432, 'support': 440271}, '1': {'precision': 0.37017020385774213, 'recall': 0.6343587228496564, 'f1-score': 0.46752401352120226, 'support': 440418}, '2': {'precision': 0.5028243129222782, 'recall': 0.3537186263204754, 'f1-score': 0.41529342452964435, 'support': 441413}, 'accuracy': 0.4299547236143656, 'macro avg': {'precision': 0.4635101965135687, 'recall': 0.4299978896304648, 'f1-score': 0.42139199464646326, 'support': 1322102}, 'weighted avg': {'precision': 0.46353377694988773, 'recall': 0.4299547236143656, 'f1-score': 0.42139185610927105, 'support': 1322102}}
[[132925 242286  65060]
 [ 71713 279383  89322]
 [ 52204 233073 156136]]
Evaluating performance on  val set...
1903/1903 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96697485
{'0': {'precision': 0.563128935751794, 'recall': 0.49255834380451624, 'f1-score': 0.525484888022672, 'support': 163942}, '1': {'precision': 0.47219332777793743, 'recall': 0.5247547516860822, 'f1-score': 0.497088459409343, 'support': 156576}, '2': {'precision': 0.5396584865387564, 'recall': 0.5497591331194964, 'f1-score': 0.5446619852416091, 'support': 166482}, 'accuracy': 0.5224640657084189, 'macro avg': {'precision': 0.5249935833561626, 'recall': 0.5223574095366983, 'f1-score': 0.5224117775578748, 'support': 487000}, 'weighted avg': {'precision': 0.5258686871275651, 'recall': 0.5224640657084189, 'f1-score': 0.5229108475558187, 'support': 487000}}
[[80751 46968 36223]
 [32562 82164 41850]
 [30084 44873 91525]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0013758
{'0': {'precision': 0.5418757013066927, 'recall': 0.4560725797115578, 'f1-score': 0.4952854845860159, 'support': 164123}, '1': {'precision': 0.43828268863405595, 'recall': 0.4794028876743617, 'f1-score': 0.4579215190328632, 'support': 159367}, '2': {'precision': 0.5079463293343875, 'recall': 0.5422298330377346, 'f1-score': 0.5245284804884398, 'support': 163510}, 'accuracy': 0.49263449691991784, 'macro avg': {'precision': 0.4960349064250454, 'recall': 0.4925684334745514, 'f1-score': 0.49257849470243964, 'support': 487000}, 'weighted avg': {'precision': 0.49658391637488214, 'recall': 0.49263449691991784, 'f1-score': 0.49287673543138766, 'support': 487000}}
[[74852 51484 37787]
 [34867 76401 48099]
 [28416 46434 88660]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0297616
{'0': {'precision': 0.537571601171695, 'recall': 0.379097707490499, 'f1-score': 0.44463616200613254, 'support': 163140}, '1': {'precision': 0.3992924485292777, 'recall': 0.5400219501066676, 'f1-score': 0.4591150461033617, 'support': 162186}, '2': {'precision': 0.500239179581272, 'recall': 0.47217858159011344, 'f1-score': 0.4858040149039548, 'support': 161674}, 'accuracy': 0.4635913757700205, 'macro avg': {'precision': 0.47903440976074824, 'recall': 0.4637660797290934, 'f1-score': 0.46318507433781636, 'support': 487000}, 'weighted avg': {'precision': 0.4791267868417707, 'recall': 0.4635913757700205, 'f1-score': 0.46312495819832095, 'support': 487000}}
[[61846 69212 32082]
 [30418 87584 44184]
 [22783 62552 76339]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0546207
{'0': {'precision': 0.5128130016521566, 'recall': 0.27733771007072067, 'f1-score': 0.359987990803917, 'support': 157804}, '1': {'precision': 0.3973012351746168, 'recall': 0.6631448822445455, 'f1-score': 0.49690083538934343, 'support': 173113}, '2': {'precision': 0.47940732854227663, 'recall': 0.34618760531255804, 'f1-score': 0.40204916050641193, 'support': 156083}, 'accuracy': 0.43654620123203286, 'macro avg': {'precision': 0.4631738551230167, 'recall': 0.4288900658759414, 'f1-score': 0.41964599556655746, 'support': 487000}, 'weighted avg': {'precision': 0.46104576118760676, 'recall': 0.43654620123203286, 'f1-score': 0.4221367111640637, 'support': 487000}}
[[ 43765  89622  24417]
 [ 24055 114799  34259]
 [ 17523  84526  54034]]
training model: results/AAPL/W4/deepVOL_L3/seq2seq
Epoch 1/50
5165/5165 - 219s - loss: 12.5054 - accuracy10: 0.4603 - accuracy20: 0.4543 - accuracy30: 0.4457 - accuracy50: 0.4507 - val_loss: 12.7310 - val_accuracy10: 0.4328 - val_accuracy20: 0.4232 - val_accuracy30: 0.4118 - val_accuracy50: 0.3977 - 219s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 214s - loss: 12.2611 - accuracy10: 0.4907 - accuracy20: 0.4786 - accuracy30: 0.4656 - accuracy50: 0.4618 - val_loss: 12.5332 - val_accuracy10: 0.4722 - val_accuracy20: 0.4540 - val_accuracy30: 0.4352 - val_accuracy50: 0.4132 - 214s/epoch - 41ms/step
Epoch 3/50
5165/5165 - 211s - loss: 12.1983 - accuracy10: 0.4985 - accuracy20: 0.4842 - accuracy30: 0.4696 - accuracy50: 0.4645 - val_loss: 12.5084 - val_accuracy10: 0.4829 - val_accuracy20: 0.4531 - val_accuracy30: 0.4247 - val_accuracy50: 0.3994 - 211s/epoch - 41ms/step
Epoch 4/50
5165/5165 - 206s - loss: 12.1551 - accuracy10: 0.5036 - accuracy20: 0.4880 - accuracy30: 0.4721 - accuracy50: 0.4670 - val_loss: 12.4846 - val_accuracy10: 0.4836 - val_accuracy20: 0.4513 - val_accuracy30: 0.4249 - val_accuracy50: 0.4007 - 206s/epoch - 40ms/step
Epoch 5/50
5165/5165 - 206s - loss: 12.1187 - accuracy10: 0.5078 - accuracy20: 0.4914 - accuracy30: 0.4750 - accuracy50: 0.4697 - val_loss: 12.4490 - val_accuracy10: 0.4910 - val_accuracy20: 0.4534 - val_accuracy30: 0.4238 - val_accuracy50: 0.3972 - 206s/epoch - 40ms/step
Epoch 6/50
5165/5165 - 210s - loss: 12.0771 - accuracy10: 0.5125 - accuracy20: 0.4951 - accuracy30: 0.4777 - accuracy50: 0.4727 - val_loss: 12.4520 - val_accuracy10: 0.4995 - val_accuracy20: 0.4619 - val_accuracy30: 0.4253 - val_accuracy50: 0.3958 - 210s/epoch - 41ms/step
Epoch 7/50
5165/5165 - 204s - loss: 12.0380 - accuracy10: 0.5164 - accuracy20: 0.4982 - accuracy30: 0.4806 - accuracy50: 0.4752 - val_loss: 12.4379 - val_accuracy10: 0.5036 - val_accuracy20: 0.4657 - val_accuracy30: 0.4288 - val_accuracy50: 0.3981 - 204s/epoch - 40ms/step
Epoch 8/50
5165/5165 - 203s - loss: 12.0035 - accuracy10: 0.5201 - accuracy20: 0.5006 - accuracy30: 0.4828 - accuracy50: 0.4775 - val_loss: 12.3874 - val_accuracy10: 0.5097 - val_accuracy20: 0.4711 - val_accuracy30: 0.4304 - val_accuracy50: 0.3979 - 203s/epoch - 39ms/step
Epoch 9/50
5165/5165 - 209s - loss: 11.9707 - accuracy10: 0.5229 - accuracy20: 0.5032 - accuracy30: 0.4845 - accuracy50: 0.4798 - val_loss: 12.3718 - val_accuracy10: 0.5131 - val_accuracy20: 0.4754 - val_accuracy30: 0.4325 - val_accuracy50: 0.3981 - 209s/epoch - 40ms/step
Epoch 10/50
5165/5165 - 207s - loss: 11.9416 - accuracy10: 0.5252 - accuracy20: 0.5050 - accuracy30: 0.4865 - accuracy50: 0.4816 - val_loss: 12.3333 - val_accuracy10: 0.5126 - val_accuracy20: 0.4787 - val_accuracy30: 0.4418 - val_accuracy50: 0.4095 - 207s/epoch - 40ms/step
Epoch 11/50
5165/5165 - 278s - loss: 11.9139 - accuracy10: 0.5280 - accuracy20: 0.5073 - accuracy30: 0.4880 - accuracy50: 0.4833 - val_loss: 12.3179 - val_accuracy10: 0.5121 - val_accuracy20: 0.4780 - val_accuracy30: 0.4439 - val_accuracy50: 0.4117 - 278s/epoch - 54ms/step
Epoch 12/50
5165/5165 - 210s - loss: 11.8932 - accuracy10: 0.5294 - accuracy20: 0.5082 - accuracy30: 0.4889 - accuracy50: 0.4848 - val_loss: 12.2805 - val_accuracy10: 0.5144 - val_accuracy20: 0.4806 - val_accuracy30: 0.4468 - val_accuracy50: 0.4156 - 210s/epoch - 41ms/step
Epoch 13/50
5165/5165 - 208s - loss: 11.8738 - accuracy10: 0.5309 - accuracy20: 0.5092 - accuracy30: 0.4898 - accuracy50: 0.4856 - val_loss: 12.2505 - val_accuracy10: 0.5155 - val_accuracy20: 0.4838 - val_accuracy30: 0.4515 - val_accuracy50: 0.4186 - 208s/epoch - 40ms/step
Epoch 14/50
5165/5165 - 204s - loss: 11.8589 - accuracy10: 0.5315 - accuracy20: 0.5104 - accuracy30: 0.4908 - accuracy50: 0.4865 - val_loss: 12.2601 - val_accuracy10: 0.5146 - val_accuracy20: 0.4823 - val_accuracy30: 0.4511 - val_accuracy50: 0.4183 - 204s/epoch - 40ms/step
Epoch 15/50
5165/5165 - 209s - loss: 11.8446 - accuracy10: 0.5328 - accuracy20: 0.5111 - accuracy30: 0.4918 - accuracy50: 0.4871 - val_loss: 12.2366 - val_accuracy10: 0.5155 - val_accuracy20: 0.4848 - val_accuracy30: 0.4543 - val_accuracy50: 0.4237 - 209s/epoch - 40ms/step
Epoch 16/50
5165/5165 - 210s - loss: 11.8300 - accuracy10: 0.5342 - accuracy20: 0.5119 - accuracy30: 0.4928 - accuracy50: 0.4880 - val_loss: 12.2083 - val_accuracy10: 0.5171 - val_accuracy20: 0.4855 - val_accuracy30: 0.4553 - val_accuracy50: 0.4253 - 210s/epoch - 41ms/step
Epoch 17/50
5165/5165 - 205s - loss: 11.8189 - accuracy10: 0.5349 - accuracy20: 0.5130 - accuracy30: 0.4933 - accuracy50: 0.4886 - val_loss: 12.1999 - val_accuracy10: 0.5151 - val_accuracy20: 0.4851 - val_accuracy30: 0.4575 - val_accuracy50: 0.4304 - 205s/epoch - 40ms/step
Epoch 18/50
5165/5165 - 212s - loss: 11.8083 - accuracy10: 0.5356 - accuracy20: 0.5137 - accuracy30: 0.4940 - accuracy50: 0.4890 - val_loss: 12.1893 - val_accuracy10: 0.5168 - val_accuracy20: 0.4863 - val_accuracy30: 0.4582 - val_accuracy50: 0.4325 - 212s/epoch - 41ms/step
Epoch 19/50
5165/5165 - 208s - loss: 11.7968 - accuracy10: 0.5366 - accuracy20: 0.5145 - accuracy30: 0.4945 - accuracy50: 0.4901 - val_loss: 12.1601 - val_accuracy10: 0.5194 - val_accuracy20: 0.4880 - val_accuracy30: 0.4601 - val_accuracy50: 0.4336 - 208s/epoch - 40ms/step
Epoch 20/50
5165/5165 - 209s - loss: 11.7872 - accuracy10: 0.5370 - accuracy20: 0.5150 - accuracy30: 0.4953 - accuracy50: 0.4906 - val_loss: 12.1659 - val_accuracy10: 0.5199 - val_accuracy20: 0.4882 - val_accuracy30: 0.4589 - val_accuracy50: 0.4302 - 209s/epoch - 40ms/step
Epoch 21/50
5165/5165 - 208s - loss: 11.7779 - accuracy10: 0.5377 - accuracy20: 0.5155 - accuracy30: 0.4960 - accuracy50: 0.4912 - val_loss: 12.1326 - val_accuracy10: 0.5199 - val_accuracy20: 0.4897 - val_accuracy30: 0.4625 - val_accuracy50: 0.4369 - 208s/epoch - 40ms/step
Epoch 22/50
5165/5165 - 204s - loss: 11.7681 - accuracy10: 0.5387 - accuracy20: 0.5161 - accuracy30: 0.4966 - accuracy50: 0.4918 - val_loss: 12.1327 - val_accuracy10: 0.5205 - val_accuracy20: 0.4901 - val_accuracy30: 0.4628 - val_accuracy50: 0.4371 - 204s/epoch - 40ms/step
Epoch 23/50
5165/5165 - 205s - loss: 11.7607 - accuracy10: 0.5393 - accuracy20: 0.5170 - accuracy30: 0.4970 - accuracy50: 0.4925 - val_loss: 12.1206 - val_accuracy10: 0.5190 - val_accuracy20: 0.4895 - val_accuracy30: 0.4632 - val_accuracy50: 0.4413 - 205s/epoch - 40ms/step
Epoch 24/50
5165/5165 - 204s - loss: 11.7518 - accuracy10: 0.5400 - accuracy20: 0.5176 - accuracy30: 0.4981 - accuracy50: 0.4929 - val_loss: 12.1150 - val_accuracy10: 0.5213 - val_accuracy20: 0.4908 - val_accuracy30: 0.4635 - val_accuracy50: 0.4415 - 204s/epoch - 39ms/step
Epoch 25/50
5165/5165 - 209s - loss: 11.7450 - accuracy10: 0.5404 - accuracy20: 0.5181 - accuracy30: 0.4987 - accuracy50: 0.4933 - val_loss: 12.1272 - val_accuracy10: 0.5192 - val_accuracy20: 0.4890 - val_accuracy30: 0.4631 - val_accuracy50: 0.4421 - 209s/epoch - 40ms/step
Epoch 26/50
5165/5165 - 209s - loss: 11.7367 - accuracy10: 0.5410 - accuracy20: 0.5185 - accuracy30: 0.4986 - accuracy50: 0.4938 - val_loss: 12.1149 - val_accuracy10: 0.5205 - val_accuracy20: 0.4905 - val_accuracy30: 0.4644 - val_accuracy50: 0.4441 - 209s/epoch - 41ms/step
Epoch 27/50
5165/5165 - 211s - loss: 11.7305 - accuracy10: 0.5413 - accuracy20: 0.5192 - accuracy30: 0.4994 - accuracy50: 0.4944 - val_loss: 12.1250 - val_accuracy10: 0.5198 - val_accuracy20: 0.4895 - val_accuracy30: 0.4640 - val_accuracy50: 0.4430 - 211s/epoch - 41ms/step
Epoch 28/50
5165/5165 - 211s - loss: 11.7236 - accuracy10: 0.5414 - accuracy20: 0.5193 - accuracy30: 0.4999 - accuracy50: 0.4948 - val_loss: 12.1157 - val_accuracy10: 0.5188 - val_accuracy20: 0.4892 - val_accuracy30: 0.4648 - val_accuracy50: 0.4434 - 211s/epoch - 41ms/step
Epoch 29/50
5165/5165 - 207s - loss: 11.7161 - accuracy10: 0.5421 - accuracy20: 0.5200 - accuracy30: 0.5004 - accuracy50: 0.4951 - val_loss: 12.1131 - val_accuracy10: 0.5195 - val_accuracy20: 0.4898 - val_accuracy30: 0.4644 - val_accuracy50: 0.4459 - 207s/epoch - 40ms/step
Epoch 30/50
5165/5165 - 204s - loss: 11.7094 - accuracy10: 0.5423 - accuracy20: 0.5206 - accuracy30: 0.5011 - accuracy50: 0.4959 - val_loss: 12.1128 - val_accuracy10: 0.5181 - val_accuracy20: 0.4890 - val_accuracy30: 0.4642 - val_accuracy50: 0.4457 - 204s/epoch - 39ms/step
Epoch 31/50
5165/5165 - 206s - loss: 11.7031 - accuracy10: 0.5429 - accuracy20: 0.5208 - accuracy30: 0.5015 - accuracy50: 0.4968 - val_loss: 12.1117 - val_accuracy10: 0.5210 - val_accuracy20: 0.4911 - val_accuracy30: 0.4647 - val_accuracy50: 0.4448 - 206s/epoch - 40ms/step
Epoch 32/50
5165/5165 - 206s - loss: 11.6972 - accuracy10: 0.5429 - accuracy20: 0.5212 - accuracy30: 0.5021 - accuracy50: 0.4970 - val_loss: 12.1096 - val_accuracy10: 0.5205 - val_accuracy20: 0.4900 - val_accuracy30: 0.4657 - val_accuracy50: 0.4464 - 206s/epoch - 40ms/step
Epoch 33/50
5165/5165 - 210s - loss: 11.6921 - accuracy10: 0.5433 - accuracy20: 0.5217 - accuracy30: 0.5023 - accuracy50: 0.4973 - val_loss: 12.1097 - val_accuracy10: 0.5203 - val_accuracy20: 0.4908 - val_accuracy30: 0.4663 - val_accuracy50: 0.4489 - 210s/epoch - 41ms/step
Epoch 34/50
5165/5165 - 207s - loss: 11.6844 - accuracy10: 0.5436 - accuracy20: 0.5221 - accuracy30: 0.5030 - accuracy50: 0.4983 - val_loss: 12.1377 - val_accuracy10: 0.5190 - val_accuracy20: 0.4895 - val_accuracy30: 0.4642 - val_accuracy50: 0.4459 - 207s/epoch - 40ms/step
Epoch 35/50
5165/5165 - 207s - loss: 11.6794 - accuracy10: 0.5437 - accuracy20: 0.5223 - accuracy30: 0.5032 - accuracy50: 0.4987 - val_loss: 12.1246 - val_accuracy10: 0.5191 - val_accuracy20: 0.4896 - val_accuracy30: 0.4652 - val_accuracy50: 0.4460 - 207s/epoch - 40ms/step
Epoch 36/50
5165/5165 - 205s - loss: 11.6734 - accuracy10: 0.5445 - accuracy20: 0.5228 - accuracy30: 0.5037 - accuracy50: 0.4990 - val_loss: 12.1428 - val_accuracy10: 0.5175 - val_accuracy20: 0.4879 - val_accuracy30: 0.4636 - val_accuracy50: 0.4459 - 205s/epoch - 40ms/step
Epoch 37/50
5165/5165 - 209s - loss: 11.6669 - accuracy10: 0.5446 - accuracy20: 0.5234 - accuracy30: 0.5047 - accuracy50: 0.4999 - val_loss: 12.1546 - val_accuracy10: 0.5177 - val_accuracy20: 0.4887 - val_accuracy30: 0.4636 - val_accuracy50: 0.4423 - 209s/epoch - 40ms/step
Epoch 38/50
5165/5165 - 206s - loss: 11.6616 - accuracy10: 0.5445 - accuracy20: 0.5235 - accuracy30: 0.5046 - accuracy50: 0.5002 - val_loss: 12.1656 - val_accuracy10: 0.5171 - val_accuracy20: 0.4884 - val_accuracy30: 0.4633 - val_accuracy50: 0.4399 - 206s/epoch - 40ms/step
Epoch 39/50
5165/5165 - 206s - loss: 11.6569 - accuracy10: 0.5449 - accuracy20: 0.5239 - accuracy30: 0.5051 - accuracy50: 0.5009 - val_loss: 12.1234 - val_accuracy10: 0.5207 - val_accuracy20: 0.4908 - val_accuracy30: 0.4663 - val_accuracy50: 0.4485 - 206s/epoch - 40ms/step
Epoch 40/50
5165/5165 - 211s - loss: 11.6511 - accuracy10: 0.5452 - accuracy20: 0.5241 - accuracy30: 0.5059 - accuracy50: 0.5015 - val_loss: 12.1526 - val_accuracy10: 0.5184 - val_accuracy20: 0.4894 - val_accuracy30: 0.4632 - val_accuracy50: 0.4427 - 211s/epoch - 41ms/step
Epoch 41/50
5165/5165 - 207s - loss: 11.6455 - accuracy10: 0.5451 - accuracy20: 0.5246 - accuracy30: 0.5061 - accuracy50: 0.5022 - val_loss: 12.1670 - val_accuracy10: 0.5182 - val_accuracy20: 0.4876 - val_accuracy30: 0.4618 - val_accuracy50: 0.4402 - 207s/epoch - 40ms/step
Epoch 42/50
5165/5165 - 208s - loss: 11.6382 - accuracy10: 0.5451 - accuracy20: 0.5246 - accuracy30: 0.5068 - accuracy50: 0.5027 - val_loss: 12.1342 - val_accuracy10: 0.5205 - val_accuracy20: 0.4906 - val_accuracy30: 0.4657 - val_accuracy50: 0.4460 - 208s/epoch - 40ms/step
testing model: results/AAPL/W4/deepVOL_L3/seq2seq
Evaluating performance on  test set...
12724/12724 - 206s - 206s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9379941
{'0': {'precision': 0.5152077314353258, 'recall': 0.4864683643003322, 'f1-score': 0.5004257632846009, 'support': 915706}, '1': {'precision': 0.5419418090564174, 'recall': 0.6147603684164472, 'f1-score': 0.5760589937224612, 'support': 1417092}, '2': {'precision': 0.5263560164072253, 'recall': 0.44701730623390085, 'f1-score': 0.48345325087795554, 'support': 924349}, 'accuracy': 0.531088710457342, 'macro avg': {'precision': 0.5278351856329895, 'recall': 0.51608201298356, 'f1-score': 0.5199793359616726, 'support': 3257147}, 'weighted avg': {'precision': 0.5300027509999075, 'recall': 0.531088710457342, 'f1-score': 0.5285149839789933, 'support': 3257147}}
[[445462 359811 110433]
 [284533 871172 261387]
 [134631 376518 413200]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9773112
{'0': {'precision': 0.5005313207368751, 'recall': 0.44866471357960597, 'f1-score': 0.47318095216810724, 'support': 943805}, '1': {'precision': 0.49435085846191107, 'recall': 0.5825558349873527, 'f1-score': 0.5348410941816867, 'support': 1373422}, '2': {'precision': 0.5021585384007893, 'recall': 0.4234871052855562, 'f1-score': 0.4594796448776569, 'support': 939920}, 'accuracy': 0.4978562527266961, 'macro avg': {'precision': 0.49901357253319184, 'recall': 0.48490255128417165, 'f1-score': 0.4891672304091503, 'support': 3257147}, 'weighted avg': {'precision': 0.4983948103392973, 'recall': 0.4978562527266961, 'f1-score': 0.495227013588158, 'support': 3257147}}
[[423452 406118 114235]
 [292940 800095 280387]
 [129613 412263 398044]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0137674
{'0': {'precision': 0.48846825566679086, 'recall': 0.38387857016787963, 'f1-score': 0.42990354295919414, 'support': 963190}, '1': {'precision': 0.4498969186014736, 'recall': 0.5989339710104923, 'f1-score': 0.5138264913289423, 'support': 1333172}, '2': {'precision': 0.4887604048625414, 'recall': 0.36900867519788505, 'f1-score': 0.42052536907672844, 'support': 960785}, 'accuracy': 0.46751589658065784, 'macro avg': {'precision': 0.47570852637693534, 'recall': 0.450607072125419, 'f1-score': 0.45475180112162167, 'support': 3257147}, 'weighted avg': {'precision': 0.4727669274758913, 'recall': 0.46751589658065784, 'f1-score': 0.4614874156337554, 'support': 3257147}}
[[369748 485426 108016]
 [271862 798482 262828]
 [115344 490903 354538]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0174307
{'0': {'precision': 0.4324850441553509, 'recall': 0.31127478340505704, 'f1-score': 0.3620031183640379, 'support': 877906}, '1': {'precision': 0.4947345310948366, 'recall': 0.6774121622428706, 'f1-score': 0.5718383037721185, 'support': 1506926}, '2': {'precision': 0.42645629944940544, 'recall': 0.2747195680459467, 'f1-score': 0.3341697733942338, 'support': 872315}, 'accuracy': 0.47087896247851263, 'macro avg': {'precision': 0.45122529156653096, 'recall': 0.4211355045646248, 'f1-score': 0.42267039851013005, 'support': 3257147}, 'weighted avg': {'precision': 0.4596703096400234, 'recall': 0.47087896247851263, 'f1-score': 0.45162960813834735, 'support': 3257147}}
[[ 273270  511424   93212]
 [ 257032 1020810  229084]
 [ 101558  531115  239642]]
Evaluating performance on  train set...
5165/5165 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9612485
{'0': {'precision': 0.5317735670017496, 'recall': 0.5725172909972795, 'f1-score': 0.5513937923120427, 'support': 438523}, '1': {'precision': 0.4875595541569241, 'recall': 0.5006397252453408, 'f1-score': 0.49401307271041084, 'support': 443159}, '2': {'precision': 0.5591772760880354, 'recall': 0.5014236410698878, 'f1-score': 0.5287280092703435, 'support': 440420}, 'accuracy': 0.5247416613846738, 'macro avg': {'precision': 0.5261701324155698, 'recall': 0.5248602191041694, 'f1-score': 0.5247116247642657, 'support': 1322102}, 'weighted avg': {'precision': 0.5260821028314223, 'recall': 0.5247416613846738, 'f1-score': 0.5246097420003687, 'support': 1322102}}
[[251062 112944  74517]
 [121718 221863  99578]
 [ 99342 120241 220837]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.992644
{'0': {'precision': 0.5241462953629032, 'recall': 0.527822152129629, 'f1-score': 0.525977801537025, 'support': 441321}, '1': {'precision': 0.4402000720192662, 'recall': 0.4817875099383311, 'f1-score': 0.46005586349120714, 'support': 438957}, '2': {'precision': 0.5401891461238134, 'recall': 0.4857024516549576, 'f1-score': 0.5114988624486494, 'support': 441824}, 'accuracy': 0.49846229716012835, 'macro avg': {'precision': 0.5015118378353276, 'recall': 0.49843737124097265, 'f1-score': 0.49917750915896053, 'support': 1322102}, 'weighted avg': {'precision': 0.5016361820239441, 'recall': 0.49846229716012835, 'f1-score': 0.4992521487942256, 'support': 1322102}}
[[232939 132421  75961]
 [120770 211484 106703]
 [ 90707 136522 214595]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0209706
{'0': {'precision': 0.5229214350006429, 'recall': 0.4569465137653851, 'f1-score': 0.4877129147813198, 'support': 444993}, '1': {'precision': 0.399904746785204, 'recall': 0.5199946189297701, 'f1-score': 0.4521110116238737, 'support': 431141}, '2': {'precision': 0.5300946487369882, 'recall': 0.4429353675600043, 'f1-score': 0.4826113565817136, 'support': 445968}, 'accuracy': 0.47278046625752024, 'macro avg': {'precision': 0.4843069435076117, 'recall': 0.4732921667517198, 'f1-score': 0.47414509432896906, 'support': 1322102}, 'weighted avg': {'precision': 0.4852250135518272, 'recall': 0.47278046625752024, 'f1-score': 0.47438219458244973, 'support': 1322102}}
[[203338 167605  74050]
 [105894 224191 101056]
 [ 79618 168815 197535]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0535582
{'0': {'precision': 0.5092106122196527, 'recall': 0.3365926895026018, 'f1-score': 0.40528706648762325, 'support': 440271}, '1': {'precision': 0.3810650011441494, 'recall': 0.6427916206876195, 'f1-score': 0.4784759593282675, 'support': 440418}, '2': {'precision': 0.507212781388699, 'recall': 0.3311252727037944, 'f1-score': 0.40067600351982363, 'support': 441413}, 'accuracy': 0.4367681162270385, 'macro avg': {'precision': 0.4658294649175003, 'recall': 0.43683652763133857, 'f1-score': 0.4281463431119048, 'support': 1322102}, 'weighted avg': {'precision': 0.4658557861629379, 'recall': 0.4367681162270385, 'f1-score': 0.4281282108692864, 'support': 1322102}}
[[148192 228254  63825]
 [ 79140 283097  78181]
 [ 63691 231559 146163]]
Evaluating performance on  val set...
1903/1903 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96611184
{'0': {'precision': 0.5455419743128374, 'recall': 0.536317722121238, 'f1-score': 0.540890523881001, 'support': 163942}, '1': {'precision': 0.46922384505938036, 'recall': 0.5160305538524422, 'f1-score': 0.4915153708812517, 'support': 156576}, '2': {'precision': 0.5491261756761154, 'recall': 0.5067514806405498, 'f1-score': 0.5270885332550287, 'support': 166482}, 'accuracy': 0.519687885010267, 'macro avg': {'precision': 0.5212973316827777, 'recall': 0.51969991887141, 'f1-score': 0.5198314760057605, 'support': 487000}, 'weighted avg': {'precision': 0.5222301008125745, 'recall': 0.519687885010267, 'f1-score': 0.5202976143132764, 'support': 487000}}
[[87925 44948 31069]
 [37577 80798 38201]
 [35668 46449 84365]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99999386
{'0': {'precision': 0.531671382833154, 'recall': 0.48768911121536895, 'f1-score': 0.5087313971188774, 'support': 164123}, '1': {'precision': 0.4306111570427745, 'recall': 0.49675905300344486, 'f1-score': 0.461325990996897, 'support': 159367}, '2': {'precision': 0.5203530660655544, 'recall': 0.4856522536847899, 'f1-score': 0.5024041807437775, 'support': 163510}, 'accuracy': 0.48997330595482547, 'macro avg': {'precision': 0.494211868647161, 'recall': 0.49003347263453456, 'f1-score': 0.49082052295318396, 'support': 487000}, 'weighted avg': {'precision': 0.49480008308324513, 'recall': 0.48997330595482547, 'f1-score': 0.49109398334693855, 'support': 487000}}
[[80041 52599 31483]
 [38486 79167 41714]
 [32019 52082 79409]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0261233
{'0': {'precision': 0.5239820115727595, 'recall': 0.4185239671447836, 'f1-score': 0.4653530802941597, 'support': 163140}, '1': {'precision': 0.4051616700927574, 'recall': 0.5432158139420172, 'f1-score': 0.4641405560604265, 'support': 162186}, '2': {'precision': 0.5054903228123092, 'recall': 0.4353637566955726, 'f1-score': 0.4678135976791097, 'support': 161674}, 'accuracy': 0.4656406570841889, 'macro avg': {'precision': 0.478211334825942, 'recall': 0.4657011792607912, 'f1-score': 0.465769078011232, 'support': 487000}, 'weighted avg': {'precision': 0.4782723171334727, 'recall': 0.4656406570841889, 'f1-score': 0.46576611362541664, 'support': 487000}}
[[68278 65410 29452]
 [34678 88102 39406]
 [27350 63937 70387]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.045355
{'0': {'precision': 0.5051887131375548, 'recall': 0.311886897670528, 'f1-score': 0.38567236225007545, 'support': 157804}, '1': {'precision': 0.413013568816291, 'recall': 0.6797583081570997, 'f1-score': 0.5138298499446544, 'support': 173113}, '2': {'precision': 0.4852138850934941, 'recall': 0.3253525367913226, 'f1-score': 0.3895191415268733, 'support': 156083}, 'accuracy': 0.44696919917864475, 'macro avg': {'precision': 0.46780538901578, 'recall': 0.4389992475396501, 'f1-score': 0.4296737845738677, 'support': 487000}, 'weighted avg': {'precision': 0.4660214711570865, 'recall': 0.44696919917864475, 'f1-score': 0.4324611589998333, 'support': 487000}}
[[ 49217  83887  24700]
 [ 26261 117675  29177]
 [ 21945  83356  50782]]
training model: results/AAPL/W5/deepLOB_L1/seq2seq
Epoch 1/50
5759/5759 - 148s - loss: 12.2814 - accuracy10: 0.4757 - accuracy20: 0.4674 - accuracy30: 0.4527 - accuracy50: 0.4306 - val_loss: 13.7126 - val_accuracy10: 0.4007 - val_accuracy20: 0.3390 - val_accuracy30: 0.3316 - val_accuracy50: 0.3257 - 148s/epoch - 26ms/step
Epoch 2/50
5759/5759 - 142s - loss: 12.1505 - accuracy10: 0.4891 - accuracy20: 0.4820 - accuracy30: 0.4646 - accuracy50: 0.4386 - val_loss: 14.0904 - val_accuracy10: 0.3998 - val_accuracy20: 0.3379 - val_accuracy30: 0.3325 - val_accuracy50: 0.3273 - 142s/epoch - 25ms/step
Epoch 3/50
5759/5759 - 137s - loss: 12.0706 - accuracy10: 0.4988 - accuracy20: 0.4899 - accuracy30: 0.4706 - accuracy50: 0.4426 - val_loss: 13.9640 - val_accuracy10: 0.4069 - val_accuracy20: 0.3482 - val_accuracy30: 0.3406 - val_accuracy50: 0.3322 - 137s/epoch - 24ms/step
Epoch 4/50
5759/5759 - 138s - loss: 12.0290 - accuracy10: 0.5030 - accuracy20: 0.4938 - accuracy30: 0.4743 - accuracy50: 0.4447 - val_loss: 13.9635 - val_accuracy10: 0.4066 - val_accuracy20: 0.3459 - val_accuracy30: 0.3422 - val_accuracy50: 0.3355 - 138s/epoch - 24ms/step
Epoch 5/50
5759/5759 - 138s - loss: 11.9870 - accuracy10: 0.5078 - accuracy20: 0.4979 - accuracy30: 0.4778 - accuracy50: 0.4478 - val_loss: 13.7363 - val_accuracy10: 0.4173 - val_accuracy20: 0.3660 - val_accuracy30: 0.3554 - val_accuracy50: 0.3421 - 138s/epoch - 24ms/step
Epoch 6/50
5759/5759 - 139s - loss: 11.9584 - accuracy10: 0.5101 - accuracy20: 0.4999 - accuracy30: 0.4796 - accuracy50: 0.4493 - val_loss: 13.5672 - val_accuracy10: 0.4189 - val_accuracy20: 0.3670 - val_accuracy30: 0.3554 - val_accuracy50: 0.3414 - 139s/epoch - 24ms/step
Epoch 7/50
5759/5759 - 139s - loss: 11.9332 - accuracy10: 0.5124 - accuracy20: 0.5021 - accuracy30: 0.4816 - accuracy50: 0.4509 - val_loss: 13.5599 - val_accuracy10: 0.4249 - val_accuracy20: 0.3738 - val_accuracy30: 0.3584 - val_accuracy50: 0.3401 - 139s/epoch - 24ms/step
Epoch 8/50
5759/5759 - 126s - loss: 11.9070 - accuracy10: 0.5150 - accuracy20: 0.5041 - accuracy30: 0.4837 - accuracy50: 0.4525 - val_loss: 13.5734 - val_accuracy10: 0.4264 - val_accuracy20: 0.3755 - val_accuracy30: 0.3599 - val_accuracy50: 0.3412 - 126s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 139s - loss: 11.8881 - accuracy10: 0.5167 - accuracy20: 0.5058 - accuracy30: 0.4851 - accuracy50: 0.4542 - val_loss: 13.4976 - val_accuracy10: 0.4279 - val_accuracy20: 0.3758 - val_accuracy30: 0.3607 - val_accuracy50: 0.3422 - 139s/epoch - 24ms/step
Epoch 10/50
5759/5759 - 139s - loss: 11.8730 - accuracy10: 0.5181 - accuracy20: 0.5072 - accuracy30: 0.4866 - accuracy50: 0.4557 - val_loss: 13.6160 - val_accuracy10: 0.4237 - val_accuracy20: 0.3696 - val_accuracy30: 0.3552 - val_accuracy50: 0.3397 - 139s/epoch - 24ms/step
Epoch 11/50
5759/5759 - 128s - loss: 11.8580 - accuracy10: 0.5194 - accuracy20: 0.5083 - accuracy30: 0.4878 - accuracy50: 0.4566 - val_loss: 13.7160 - val_accuracy10: 0.4219 - val_accuracy20: 0.3654 - val_accuracy30: 0.3524 - val_accuracy50: 0.3387 - 128s/epoch - 22ms/step
Epoch 12/50
5759/5759 - 131s - loss: 11.8421 - accuracy10: 0.5208 - accuracy20: 0.5098 - accuracy30: 0.4890 - accuracy50: 0.4575 - val_loss: 13.8162 - val_accuracy10: 0.4229 - val_accuracy20: 0.3659 - val_accuracy30: 0.3531 - val_accuracy50: 0.3394 - 131s/epoch - 23ms/step
Epoch 13/50
5759/5759 - 140s - loss: 11.8272 - accuracy10: 0.5222 - accuracy20: 0.5110 - accuracy30: 0.4901 - accuracy50: 0.4586 - val_loss: 13.7400 - val_accuracy10: 0.4203 - val_accuracy20: 0.3629 - val_accuracy30: 0.3525 - val_accuracy50: 0.3422 - 140s/epoch - 24ms/step
Epoch 14/50
5759/5759 - 138s - loss: 11.8164 - accuracy10: 0.5228 - accuracy20: 0.5118 - accuracy30: 0.4907 - accuracy50: 0.4593 - val_loss: 13.7883 - val_accuracy10: 0.4233 - val_accuracy20: 0.3657 - val_accuracy30: 0.3531 - val_accuracy50: 0.3406 - 138s/epoch - 24ms/step
Epoch 15/50
5759/5759 - 139s - loss: 11.8063 - accuracy10: 0.5237 - accuracy20: 0.5125 - accuracy30: 0.4917 - accuracy50: 0.4598 - val_loss: 13.8174 - val_accuracy10: 0.4199 - val_accuracy20: 0.3614 - val_accuracy30: 0.3511 - val_accuracy50: 0.3410 - 139s/epoch - 24ms/step
Epoch 16/50
5759/5759 - 134s - loss: 11.7963 - accuracy10: 0.5242 - accuracy20: 0.5133 - accuracy30: 0.4922 - accuracy50: 0.4602 - val_loss: 13.9308 - val_accuracy10: 0.4211 - val_accuracy20: 0.3610 - val_accuracy30: 0.3495 - val_accuracy50: 0.3390 - 134s/epoch - 23ms/step
Epoch 17/50
5759/5759 - 129s - loss: 11.7866 - accuracy10: 0.5251 - accuracy20: 0.5139 - accuracy30: 0.4930 - accuracy50: 0.4609 - val_loss: 13.8542 - val_accuracy10: 0.4197 - val_accuracy20: 0.3609 - val_accuracy30: 0.3503 - val_accuracy50: 0.3401 - 129s/epoch - 22ms/step
Epoch 18/50
5759/5759 - 131s - loss: 11.7766 - accuracy10: 0.5262 - accuracy20: 0.5149 - accuracy30: 0.4935 - accuracy50: 0.4616 - val_loss: 13.7988 - val_accuracy10: 0.4219 - val_accuracy20: 0.3627 - val_accuracy30: 0.3524 - val_accuracy50: 0.3421 - 131s/epoch - 23ms/step
Epoch 19/50
5759/5759 - 139s - loss: 11.7640 - accuracy10: 0.5268 - accuracy20: 0.5158 - accuracy30: 0.4948 - accuracy50: 0.4624 - val_loss: 13.7047 - val_accuracy10: 0.4244 - val_accuracy20: 0.3667 - val_accuracy30: 0.3569 - val_accuracy50: 0.3457 - 139s/epoch - 24ms/step
testing model: results/AAPL/W5/deepLOB_L1/seq2seq
Evaluating performance on  test set...
31315/31315 - 307s - 307s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2126685
{'0': {'precision': 0.4764123125784527, 'recall': 0.10223803906360748, 'f1-score': 0.16834850436212556, 'support': 2828771}, '1': {'precision': 0.29051898661545145, 'recall': 0.725135509542977, 'f1-score': 0.4148371994376397, 'support': 2325113}, '2': {'precision': 0.47346522212100134, 'recall': 0.2656188320975113, 'f1-score': 0.34031658137056064, 'support': 2862602}, 'accuracy': 0.34124565302053794, 'macro avg': {'precision': 0.4134655071049685, 'recall': 0.36433079356803194, 'f1-score': 0.3078340950567753, 'support': 8016486}, 'weighted avg': {'precision': 0.4214431732513843, 'recall': 0.34124565302053794, 'f1-score': 0.30124840968892513, 'support': 8016486}}
[[ 289208 2145888  393675]
 [ 187178 1686022  451913]
 [ 130668 1971573  760361]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2470592
{'0': {'precision': 0.5078128792028679, 'recall': 0.09336422728728667, 'f1-score': 0.15772908369751593, 'support': 3137615}, '1': {'precision': 0.21022291894448167, 'recall': 0.7328709686615101, 'f1-score': 0.32672521000593874, 'support': 1683808}, '2': {'precision': 0.5051147049679152, 'recall': 0.24814033400906335, 'f1-score': 0.3327938748975529, 'support': 3195063}, 'accuracy': 0.2893760433187309, 'macro avg': {'precision': 0.40771683437175493, 'recall': 0.35812517665262006, 'f1-score': 0.2724160562003359, 'support': 8016486}, 'weighted avg': {'precision': 0.4442307570026416, 'recall': 0.2893760433187309, 'f1-score': 0.2629996556679649, 'support': 8016486}}
[[ 292941 2384774  459900]
 [ 132926 1234014  316868]
 [ 151001 2251238  792824]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.208429
{'0': {'precision': 0.4989338975891871, 'recall': 0.07912221324119009, 'f1-score': 0.1365845062397193, 'support': 3105310}, '1': {'precision': 0.21600460007941735, 'recall': 0.7412621465780471, 'f1-score': 0.3345275161488406, 'support': 1731146}, '2': {'precision': 0.4940569239252156, 'recall': 0.2459806982952991, 'f1-score': 0.32843861851266587, 'support': 3180030}, 'accuracy': 0.2883006344675211, 'macro avg': {'precision': 0.4029984738646067, 'recall': 0.3554550193715121, 'f1-score': 0.2665168803004086, 'support': 8016486}, 'weighted avg': {'precision': 0.43590118671967554, 'recall': 0.2883006344675211, 'f1-score': 0.2554358436565718, 'support': 8016486}}
[[ 245699 2388789  470822]
 [ 117690 1283233  330223]
 [ 129059 2268745  782226]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1818058
{'0': {'precision': 0.4901772597128243, 'recall': 0.05970337373922737, 'f1-score': 0.10644214163857048, 'support': 3062507}, '1': {'precision': 0.22521385347196732, 'recall': 0.7678832917827367, 'f1-score': 0.3482800368231348, 'support': 1804226}, '2': {'precision': 0.47391596372781924, 'recall': 0.22446299757473046, 'f1-score': 0.3046386094405252, 'support': 3149753}, 'accuracy': 0.283825107409905, 'macro avg': {'precision': 0.3964356923042036, 'recall': 0.35068322103223154, 'f1-score': 0.2531202626340768, 'support': 8016486}, 'weighted avg': {'precision': 0.4241542001826294, 'recall': 0.283825107409905, 'f1-score': 0.2387445166849282, 'support': 8016486}}
[[ 182842 2420903  458762]
 [  92724 1385435  326067]
 [  97446 2345304  707003]]
Evaluating performance on  train set...
5759/5759 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0373117
{'0': {'precision': 0.4787745155870519, 'recall': 0.2835674529552081, 'f1-score': 0.3561783963815914, 'support': 415030}, '1': {'precision': 0.474710456402561, 'recall': 0.6397801211577294, 'f1-score': 0.5450208721852414, 'support': 641808}, '2': {'precision': 0.4372456154352092, 'recall': 0.3807142480603066, 'f1-score': 0.4070264156646954, 'support': 417334}, 'accuracy': 0.4661532032897111, 'macro avg': {'precision': 0.46357686247494073, 'recall': 0.43468727405774804, 'f1-score': 0.4360752280771761, 'support': 1474172}, 'weighted avg': {'precision': 0.4652484360569504, 'recall': 0.4661532032897111, 'f1-score': 0.45278938817229414, 'support': 1474172}}
[[117689 236368  60973]
 [ 87673 410616 143519]
 [ 40451 217998 158885]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.087626
{'0': {'precision': 0.5225781738448939, 'recall': 0.24342916211177448, 'f1-score': 0.3321398138781267, 'support': 487571}, '1': {'precision': 0.3725529029825973, 'recall': 0.6655656698054794, 'f1-score': 0.47770732344311273, 'support': 497428}, '2': {'precision': 0.4808660835112097, 'recall': 0.3523088968524428, 'f1-score': 0.40666943537273703, 'support': 489173}, 'accuracy': 0.4219996038454129, 'macro avg': {'precision': 0.4586657201129003, 'recall': 0.42043457625656555, 'f1-score': 0.4055055242313255, 'support': 1474172}, 'weighted avg': {'precision': 0.4581140551400957, 'recall': 0.4219996038454129, 'f1-score': 0.4059895638959502, 'support': 1474172}}
[[118689 289243  79639]
 [ 59941 331071 106416]
 [ 48492 268341 172340]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0893925
{'0': {'precision': 0.5171331129103642, 'recall': 0.2006164859492914, 'f1-score': 0.28908529672443933, 'support': 495064}, '1': {'precision': 0.3554791471203571, 'recall': 0.6897521431310536, 'f1-score': 0.46916410913356593, 'support': 485038}, '2': {'precision': 0.4738896579231383, 'recall': 0.32704879875321313, 'f1-score': 0.3870086198844136, 'support': 494070}, 'accuracy': 0.4039277641957655, 'macro avg': {'precision': 0.4488339726512865, 'recall': 0.4058058092778527, 'f1-score': 0.381752675247473, 'support': 1474172}, 'weighted avg': {'precision': 0.449451994245519, 'recall': 0.4039277641957655, 'f1-score': 0.3811546368604251, 'support': 1474172}}
[[ 99318 316116  79630]
 [ 50721 334556  99761]
 [ 42016 290469 161585]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0988145
{'0': {'precision': 0.4998436522826767, 'recall': 0.14128314682125975, 'f1-score': 0.2202980259500262, 'support': 497823}, '1': {'precision': 0.33685531154209536, 'recall': 0.7318194739394345, 'f1-score': 0.46135134885841506, 'support': 478424}, '2': {'precision': 0.4610686815242007, 'recall': 0.272314103529648, 'f1-score': 0.34240101413245083, 'support': 497925}, 'accuracy': 0.3771920779936127, 'macro avg': {'precision': 0.43258921511632425, 'recall': 0.38180557476344745, 'f1-score': 0.34135012964696404, 'support': 1474172}, 'weighted avg': {'precision': 0.4338509721575719, 'recall': 0.3771920779936127, 'f1-score': 0.3397710761435293, 'support': 1474172}}
[[ 70334 357729  69760]
 [ 39574 350120  88730]
 [ 30804 331529 135592]]
Evaluating performance on  val set...
2129/2129 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0761412
{'0': {'precision': 0.45998922466571973, 'recall': 0.27673630550726347, 'f1-score': 0.34557162306362, 'support': 169685}, '1': {'precision': 0.4097522364772138, 'recall': 0.6951930555085912, 'f1-score': 0.5156036436267879, 'support': 207013}, '2': {'precision': 0.4606528215817446, 'recall': 0.2508945447629011, 'f1-score': 0.32485618085618084, 'support': 168242}, 'accuracy': 0.4277223180533637, 'macro avg': {'precision': 0.443464760908226, 'recall': 0.4076079685929186, 'f1-score': 0.3953438158488629, 'support': 544940}, 'weighted avg': {'precision': 0.44110996316257933, 'recall': 0.4277223180533637, 'f1-score': 0.4037681790972734, 'support': 544940}}
[[ 46958 104194  18533]
 [ 32210 143914  30889]
 [ 22917 103114  42211]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1238433
{'0': {'precision': 0.4880292242237316, 'recall': 0.23175646898729574, 'f1-score': 0.3142711249625834, 'support': 192534}, '1': {'precision': 0.31757896276749903, 'recall': 0.7191809078521334, 'f1-score': 0.44059715895709717, 'support': 159982}, '2': {'precision': 0.49551623583064747, 'recall': 0.2348979337296803, 'f1-score': 0.3187116153461053, 'support': 192424}, 'accuracy': 0.37596249128344406, 'macro avg': {'precision': 0.43370814094062604, 'recall': 0.3952784368563698, 'f1-score': 0.35785996642192863, 'support': 544940}, 'weighted avg': {'precision': 0.44063264293617366, 'recall': 0.37596249128344406, 'f1-score': 0.35292556121624274, 'support': 544940}}
[[ 44621 124618  23295]
 [ 22203 115056  22723]
 [ 24607 122617  45200]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1139723
{'0': {'precision': 0.47635686000465877, 'recall': 0.18163816569747698, 'f1-score': 0.26299465159733415, 'support': 191397}, '1': {'precision': 0.31099747694110874, 'recall': 0.7442890920261389, 'f1-score': 0.438690373860149, 'support': 161139}, '2': {'precision': 0.4852634505769498, 'recall': 0.21769817675308206, 'f1-score': 0.3005597014925373, 'support': 192404}, 'accuracy': 0.36074613718941534, 'macro avg': {'precision': 0.4242059291742391, 'recall': 0.38120847815889936, 'f1-score': 0.3340815756500068, 'support': 544940}, 'weighted avg': {'precision': 0.43060470017971236, 'recall': 0.36074613718941534, 'f1-score': 0.32821118708701075, 'support': 544940}}
[[ 34765 134483  22149]
 [ 18924 119934  22281]
 [ 19292 131226  41886]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1114753
{'0': {'precision': 0.45500739692545183, 'recall': 0.1127240857302207, 'f1-score': 0.18068503997343618, 'support': 188265}, '1': {'precision': 0.30854436324698015, 'recall': 0.7942993592068673, 'f1-score': 0.444444820284541, 'support': 165420}, '2': {'precision': 0.4684959489862114, 'recall': 0.17747509869023032, 'f1-score': 0.25743062349737966, 'support': 191255}, 'accuracy': 0.34234594634271664, 'macro avg': {'precision': 0.4106825697195478, 'recall': 0.3614995145424395, 'f1-score': 0.2941868279184523, 'support': 544940}, 'weighted avg': {'precision': 0.4152816252685498, 'recall': 0.34234594634271664, 'f1-score': 0.287686029873122, 'support': 544940}}
[[ 21222 148919  18124]
 [ 13643 131393  20384]
 [ 11776 145536  33943]]
training model: results/AAPL/W5/deepOF_L1/seq2seq
Epoch 1/50
5759/5759 - 135s - loss: 12.4891 - accuracy10: 0.4688 - accuracy20: 0.4581 - accuracy30: 0.4466 - accuracy50: 0.4284 - val_loss: 13.7871 - val_accuracy10: 0.3992 - val_accuracy20: 0.3328 - val_accuracy30: 0.3270 - val_accuracy50: 0.3236 - 135s/epoch - 24ms/step
Epoch 2/50
5759/5759 - 129s - loss: 12.4048 - accuracy10: 0.4728 - accuracy20: 0.4664 - accuracy30: 0.4547 - accuracy50: 0.4345 - val_loss: 14.0810 - val_accuracy10: 0.3975 - val_accuracy20: 0.3314 - val_accuracy30: 0.3275 - val_accuracy50: 0.3245 - 129s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 130s - loss: 12.3556 - accuracy10: 0.4767 - accuracy20: 0.4712 - accuracy30: 0.4587 - accuracy50: 0.4380 - val_loss: 14.1497 - val_accuracy10: 0.3969 - val_accuracy20: 0.3347 - val_accuracy30: 0.3321 - val_accuracy50: 0.3301 - 130s/epoch - 23ms/step
Epoch 4/50
5759/5759 - 122s - loss: 12.3239 - accuracy10: 0.4797 - accuracy20: 0.4742 - accuracy30: 0.4614 - accuracy50: 0.4396 - val_loss: 14.1502 - val_accuracy10: 0.3975 - val_accuracy20: 0.3355 - val_accuracy30: 0.3325 - val_accuracy50: 0.3300 - 122s/epoch - 21ms/step
Epoch 5/50
5759/5759 - 130s - loss: 12.2983 - accuracy10: 0.4826 - accuracy20: 0.4764 - accuracy30: 0.4638 - accuracy50: 0.4417 - val_loss: 14.0878 - val_accuracy10: 0.3993 - val_accuracy20: 0.3384 - val_accuracy30: 0.3355 - val_accuracy50: 0.3323 - 130s/epoch - 22ms/step
Epoch 6/50
5759/5759 - 129s - loss: 12.2756 - accuracy10: 0.4846 - accuracy20: 0.4781 - accuracy30: 0.4652 - accuracy50: 0.4427 - val_loss: 14.0539 - val_accuracy10: 0.4009 - val_accuracy20: 0.3425 - val_accuracy30: 0.3392 - val_accuracy50: 0.3352 - 129s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 125s - loss: 12.2586 - accuracy10: 0.4861 - accuracy20: 0.4797 - accuracy30: 0.4666 - accuracy50: 0.4437 - val_loss: 13.8278 - val_accuracy10: 0.4052 - val_accuracy20: 0.3478 - val_accuracy30: 0.3428 - val_accuracy50: 0.3364 - 125s/epoch - 22ms/step
Epoch 8/50
5759/5759 - 125s - loss: 12.2417 - accuracy10: 0.4877 - accuracy20: 0.4812 - accuracy30: 0.4681 - accuracy50: 0.4445 - val_loss: 13.9240 - val_accuracy10: 0.4044 - val_accuracy20: 0.3448 - val_accuracy30: 0.3397 - val_accuracy50: 0.3342 - 125s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 130s - loss: 12.2287 - accuracy10: 0.4892 - accuracy20: 0.4824 - accuracy30: 0.4689 - accuracy50: 0.4451 - val_loss: 13.7632 - val_accuracy10: 0.4092 - val_accuracy20: 0.3515 - val_accuracy30: 0.3460 - val_accuracy50: 0.3393 - 130s/epoch - 23ms/step
Epoch 10/50
5759/5759 - 122s - loss: 12.2170 - accuracy10: 0.4905 - accuracy20: 0.4836 - accuracy30: 0.4698 - accuracy50: 0.4457 - val_loss: 13.7690 - val_accuracy10: 0.4104 - val_accuracy20: 0.3520 - val_accuracy30: 0.3466 - val_accuracy50: 0.3394 - 122s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 130s - loss: 12.2065 - accuracy10: 0.4909 - accuracy20: 0.4844 - accuracy30: 0.4706 - accuracy50: 0.4464 - val_loss: 13.6865 - val_accuracy10: 0.4128 - val_accuracy20: 0.3578 - val_accuracy30: 0.3514 - val_accuracy50: 0.3431 - 130s/epoch - 23ms/step
Epoch 12/50
5759/5759 - 129s - loss: 12.1955 - accuracy10: 0.4920 - accuracy20: 0.4853 - accuracy30: 0.4712 - accuracy50: 0.4470 - val_loss: 13.7074 - val_accuracy10: 0.4143 - val_accuracy20: 0.3578 - val_accuracy30: 0.3519 - val_accuracy50: 0.3442 - 129s/epoch - 22ms/step
Epoch 13/50
5759/5759 - 127s - loss: 12.1854 - accuracy10: 0.4925 - accuracy20: 0.4863 - accuracy30: 0.4720 - accuracy50: 0.4476 - val_loss: 13.7887 - val_accuracy10: 0.4135 - val_accuracy20: 0.3563 - val_accuracy30: 0.3506 - val_accuracy50: 0.3439 - 127s/epoch - 22ms/step
Epoch 14/50
5759/5759 - 129s - loss: 12.1749 - accuracy10: 0.4932 - accuracy20: 0.4868 - accuracy30: 0.4724 - accuracy50: 0.4481 - val_loss: 13.6225 - val_accuracy10: 0.4169 - val_accuracy20: 0.3609 - val_accuracy30: 0.3544 - val_accuracy50: 0.3467 - 129s/epoch - 22ms/step
Epoch 15/50
5759/5759 - 130s - loss: 12.1673 - accuracy10: 0.4936 - accuracy20: 0.4876 - accuracy30: 0.4734 - accuracy50: 0.4487 - val_loss: 13.6605 - val_accuracy10: 0.4169 - val_accuracy20: 0.3614 - val_accuracy30: 0.3545 - val_accuracy50: 0.3472 - 130s/epoch - 23ms/step
Epoch 16/50
5759/5759 - 129s - loss: 12.1579 - accuracy10: 0.4944 - accuracy20: 0.4888 - accuracy30: 0.4741 - accuracy50: 0.4492 - val_loss: 13.6323 - val_accuracy10: 0.4182 - val_accuracy20: 0.3643 - val_accuracy30: 0.3579 - val_accuracy50: 0.3497 - 129s/epoch - 22ms/step
Epoch 17/50
5759/5759 - 125s - loss: 12.1498 - accuracy10: 0.4947 - accuracy20: 0.4893 - accuracy30: 0.4746 - accuracy50: 0.4499 - val_loss: 13.6471 - val_accuracy10: 0.4195 - val_accuracy20: 0.3632 - val_accuracy30: 0.3562 - val_accuracy50: 0.3479 - 125s/epoch - 22ms/step
Epoch 18/50
5759/5759 - 119s - loss: 12.1416 - accuracy10: 0.4953 - accuracy20: 0.4900 - accuracy30: 0.4752 - accuracy50: 0.4504 - val_loss: 13.6366 - val_accuracy10: 0.4212 - val_accuracy20: 0.3662 - val_accuracy30: 0.3589 - val_accuracy50: 0.3508 - 119s/epoch - 21ms/step
Epoch 19/50
5759/5759 - 133s - loss: 12.1330 - accuracy10: 0.4959 - accuracy20: 0.4904 - accuracy30: 0.4759 - accuracy50: 0.4509 - val_loss: 13.6727 - val_accuracy10: 0.4204 - val_accuracy20: 0.3673 - val_accuracy30: 0.3619 - val_accuracy50: 0.3548 - 133s/epoch - 23ms/step
Epoch 20/50
5759/5759 - 128s - loss: 12.1260 - accuracy10: 0.4964 - accuracy20: 0.4910 - accuracy30: 0.4761 - accuracy50: 0.4511 - val_loss: 13.5955 - val_accuracy10: 0.4243 - val_accuracy20: 0.3712 - val_accuracy30: 0.3638 - val_accuracy50: 0.3554 - 128s/epoch - 22ms/step
Epoch 21/50
5759/5759 - 121s - loss: 12.1186 - accuracy10: 0.4968 - accuracy20: 0.4917 - accuracy30: 0.4770 - accuracy50: 0.4518 - val_loss: 13.6197 - val_accuracy10: 0.4228 - val_accuracy20: 0.3697 - val_accuracy30: 0.3640 - val_accuracy50: 0.3554 - 121s/epoch - 21ms/step
Epoch 22/50
5759/5759 - 129s - loss: 12.1123 - accuracy10: 0.4971 - accuracy20: 0.4920 - accuracy30: 0.4773 - accuracy50: 0.4523 - val_loss: 13.7158 - val_accuracy10: 0.4202 - val_accuracy20: 0.3643 - val_accuracy30: 0.3576 - val_accuracy50: 0.3506 - 129s/epoch - 22ms/step
Epoch 23/50
5759/5759 - 122s - loss: 12.1055 - accuracy10: 0.4977 - accuracy20: 0.4927 - accuracy30: 0.4779 - accuracy50: 0.4524 - val_loss: 13.6331 - val_accuracy10: 0.4220 - val_accuracy20: 0.3679 - val_accuracy30: 0.3616 - val_accuracy50: 0.3541 - 122s/epoch - 21ms/step
Epoch 24/50
5759/5759 - 125s - loss: 12.0997 - accuracy10: 0.4983 - accuracy20: 0.4933 - accuracy30: 0.4783 - accuracy50: 0.4527 - val_loss: 13.5972 - val_accuracy10: 0.4257 - val_accuracy20: 0.3727 - val_accuracy30: 0.3650 - val_accuracy50: 0.3559 - 125s/epoch - 22ms/step
Epoch 25/50
5759/5759 - 129s - loss: 12.0917 - accuracy10: 0.4986 - accuracy20: 0.4936 - accuracy30: 0.4789 - accuracy50: 0.4534 - val_loss: 13.6082 - val_accuracy10: 0.4254 - val_accuracy20: 0.3737 - val_accuracy30: 0.3673 - val_accuracy50: 0.3590 - 129s/epoch - 22ms/step
Epoch 26/50
5759/5759 - 122s - loss: 12.0856 - accuracy10: 0.4986 - accuracy20: 0.4940 - accuracy30: 0.4793 - accuracy50: 0.4534 - val_loss: 13.6596 - val_accuracy10: 0.4250 - val_accuracy20: 0.3726 - val_accuracy30: 0.3657 - val_accuracy50: 0.3581 - 122s/epoch - 21ms/step
Epoch 27/50
5759/5759 - 128s - loss: 12.0809 - accuracy10: 0.4990 - accuracy20: 0.4945 - accuracy30: 0.4794 - accuracy50: 0.4540 - val_loss: 13.6790 - val_accuracy10: 0.4268 - val_accuracy20: 0.3743 - val_accuracy30: 0.3676 - val_accuracy50: 0.3598 - 128s/epoch - 22ms/step
Epoch 28/50
5759/5759 - 124s - loss: 12.0733 - accuracy10: 0.4997 - accuracy20: 0.4957 - accuracy30: 0.4804 - accuracy50: 0.4548 - val_loss: 13.5837 - val_accuracy10: 0.4277 - val_accuracy20: 0.3770 - val_accuracy30: 0.3695 - val_accuracy50: 0.3609 - 124s/epoch - 21ms/step
Epoch 29/50
5759/5759 - 128s - loss: 12.0663 - accuracy10: 0.4998 - accuracy20: 0.4954 - accuracy30: 0.4805 - accuracy50: 0.4552 - val_loss: 13.5995 - val_accuracy10: 0.4274 - val_accuracy20: 0.3759 - val_accuracy30: 0.3667 - val_accuracy50: 0.3569 - 128s/epoch - 22ms/step
Epoch 30/50
5759/5759 - 129s - loss: 12.0617 - accuracy10: 0.5006 - accuracy20: 0.4964 - accuracy30: 0.4812 - accuracy50: 0.4558 - val_loss: 13.6256 - val_accuracy10: 0.4297 - val_accuracy20: 0.3803 - val_accuracy30: 0.3726 - val_accuracy50: 0.3628 - 129s/epoch - 22ms/step
Epoch 31/50
5759/5759 - 129s - loss: 12.0528 - accuracy10: 0.5009 - accuracy20: 0.4969 - accuracy30: 0.4818 - accuracy50: 0.4561 - val_loss: 13.6453 - val_accuracy10: 0.4282 - val_accuracy20: 0.3773 - val_accuracy30: 0.3697 - val_accuracy50: 0.3602 - 129s/epoch - 22ms/step
Epoch 32/50
5759/5759 - 133s - loss: 12.0487 - accuracy10: 0.5012 - accuracy20: 0.4970 - accuracy30: 0.4818 - accuracy50: 0.4562 - val_loss: 13.5029 - val_accuracy10: 0.4319 - val_accuracy20: 0.3846 - val_accuracy30: 0.3777 - val_accuracy50: 0.3677 - 133s/epoch - 23ms/step
Epoch 33/50
5759/5759 - 125s - loss: 12.0447 - accuracy10: 0.5014 - accuracy20: 0.4975 - accuracy30: 0.4822 - accuracy50: 0.4565 - val_loss: 13.5176 - val_accuracy10: 0.4348 - val_accuracy20: 0.3875 - val_accuracy30: 0.3788 - val_accuracy50: 0.3677 - 125s/epoch - 22ms/step
Epoch 34/50
5759/5759 - 126s - loss: 12.0356 - accuracy10: 0.5020 - accuracy20: 0.4982 - accuracy30: 0.4834 - accuracy50: 0.4575 - val_loss: 13.5682 - val_accuracy10: 0.4314 - val_accuracy20: 0.3825 - val_accuracy30: 0.3743 - val_accuracy50: 0.3655 - 126s/epoch - 22ms/step
Epoch 35/50
5759/5759 - 128s - loss: 12.0325 - accuracy10: 0.5022 - accuracy20: 0.4981 - accuracy30: 0.4833 - accuracy50: 0.4575 - val_loss: 13.5877 - val_accuracy10: 0.4312 - val_accuracy20: 0.3807 - val_accuracy30: 0.3722 - val_accuracy50: 0.3632 - 128s/epoch - 22ms/step
Epoch 36/50
5759/5759 - 130s - loss: 12.0274 - accuracy10: 0.5027 - accuracy20: 0.4988 - accuracy30: 0.4838 - accuracy50: 0.4577 - val_loss: 13.6586 - val_accuracy10: 0.4296 - val_accuracy20: 0.3792 - val_accuracy30: 0.3724 - val_accuracy50: 0.3635 - 130s/epoch - 23ms/step
Epoch 37/50
5759/5759 - 130s - loss: 12.0214 - accuracy10: 0.5029 - accuracy20: 0.4994 - accuracy30: 0.4841 - accuracy50: 0.4580 - val_loss: 13.6251 - val_accuracy10: 0.4299 - val_accuracy20: 0.3803 - val_accuracy30: 0.3728 - val_accuracy50: 0.3634 - 130s/epoch - 23ms/step
Epoch 38/50
5759/5759 - 129s - loss: 12.0155 - accuracy10: 0.5035 - accuracy20: 0.4996 - accuracy30: 0.4847 - accuracy50: 0.4586 - val_loss: 13.7073 - val_accuracy10: 0.4281 - val_accuracy20: 0.3764 - val_accuracy30: 0.3694 - val_accuracy50: 0.3614 - 129s/epoch - 22ms/step
Epoch 39/50
5759/5759 - 129s - loss: 12.0100 - accuracy10: 0.5039 - accuracy20: 0.5004 - accuracy30: 0.4856 - accuracy50: 0.4589 - val_loss: 13.6774 - val_accuracy10: 0.4292 - val_accuracy20: 0.3805 - val_accuracy30: 0.3729 - val_accuracy50: 0.3646 - 129s/epoch - 22ms/step
Epoch 40/50
5759/5759 - 129s - loss: 12.0054 - accuracy10: 0.5040 - accuracy20: 0.5003 - accuracy30: 0.4856 - accuracy50: 0.4593 - val_loss: 13.6720 - val_accuracy10: 0.4303 - val_accuracy20: 0.3810 - val_accuracy30: 0.3741 - val_accuracy50: 0.3658 - 129s/epoch - 22ms/step
Epoch 41/50
5759/5759 - 129s - loss: 12.0009 - accuracy10: 0.5041 - accuracy20: 0.5009 - accuracy30: 0.4858 - accuracy50: 0.4596 - val_loss: 13.6205 - val_accuracy10: 0.4328 - val_accuracy20: 0.3853 - val_accuracy30: 0.3780 - val_accuracy50: 0.3689 - 129s/epoch - 22ms/step
Epoch 42/50
5759/5759 - 129s - loss: 11.9950 - accuracy10: 0.5048 - accuracy20: 0.5014 - accuracy30: 0.4864 - accuracy50: 0.4603 - val_loss: 13.6054 - val_accuracy10: 0.4325 - val_accuracy20: 0.3862 - val_accuracy30: 0.3787 - val_accuracy50: 0.3692 - 129s/epoch - 22ms/step
testing model: results/AAPL/W5/deepOF_L1/seq2seq
Evaluating performance on  test set...
31315/31315 - 282s - 282s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1510224
{'0': {'precision': 0.4849716319163861, 'recall': 0.24122648402891858, 'f1-score': 0.3221930739070326, 'support': 2828769}, '1': {'precision': 0.30994188149113483, 'recall': 0.6693707657953681, 'f1-score': 0.4236972434505544, 'support': 2325112}, '2': {'precision': 0.4839185429521064, 'recall': 0.26844546915391604, 'f1-score': 0.3453268317059043, 'support': 2862600}, 'accuracy': 0.37512569417927893, 'macro avg': {'precision': 0.4262773521198758, 'recall': 0.3930142396594009, 'f1-score': 0.3637390496878304, 'support': 8016481}, 'weighted avg': {'precision': 0.4338296975015345, 'recall': 0.37512569417927893, 'f1-score': 0.35989431186053455, 'support': 8016481}}
[[ 682374 1737721  408674]
 [ 357898 1556362  410852]
 [ 366767 1727381  768452]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1938502
{'0': {'precision': 0.5162058397628533, 'recall': 0.2098471703958297, 'f1-score': 0.2983923578592779, 'support': 3137612}, '1': {'precision': 0.2244612644104404, 'recall': 0.6955899960090461, 'f1-score': 0.3394006763150494, 'support': 1683808}, '2': {'precision': 0.5127595324689309, 'recall': 0.24441536483966972, 'f1-score': 0.3310366169002382, 'support': 3195061}, 'accuracy': 0.3256517417056187, 'macro avg': {'precision': 0.41780887888074153, 'recall': 0.3832841770815152, 'f1-score': 0.3229432170248552, 'support': 8016481}, 'weighted avg': {'precision': 0.4535532853610125, 'recall': 0.3256517417056187, 'f1-score': 0.3200166258664054, 'support': 8016481}}
[[ 658419 2021193  458000]
 [ 228511 1171240  284057]
 [ 388567 2025572  780922]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1737658
{'0': {'precision': 0.5161885249577952, 'recall': 0.18531120604539456, 'f1-score': 0.27271719112401865, 'support': 3105306}, '1': {'precision': 0.2260347343937984, 'recall': 0.7089026575459262, 'f1-score': 0.34277508909341325, 'support': 1731146}, '2': {'precision': 0.5026994022533845, 'recall': 0.23275133654441515, 'f1-score': 0.31818299059924443, 'support': 3180029}, 'accuracy': 0.31719878086157755, 'macro avg': {'precision': 0.4149742205349927, 'recall': 0.3756550667119119, 'f1-score': 0.3112250902722254, 'support': 8016481}, 'weighted avg': {'precision': 0.4481793354762402, 'recall': 0.31719878086157755, 'f1-score': 0.30588174433352894, 'support': 8016481}}
[[ 575448 2089759  440099]
 [ 211824 1227214  292108]
 [ 327530 2112343  740156]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1565197
{'0': {'precision': 0.5008230902161489, 'recall': 0.16768832552980356, 'f1-score': 0.2512513127133274, 'support': 3062503}, '1': {'precision': 0.22976435713209065, 'recall': 0.7248969918402683, 'f1-score': 0.3489310455408162, 'support': 1804226}, '2': {'precision': 0.48530087718150106, 'recall': 0.20011670760110636, 'f1-score': 0.2833799887649315, 'support': 3149752}, 'accuracy': 0.3058376861368473, 'macro avg': {'precision': 0.4052961081765802, 'recall': 0.3642340083237261, 'f1-score': 0.29452078233969176, 'support': 8016481}, 'weighted avg': {'precision': 0.4337185420599659, 'recall': 0.3058376861368473, 'f1-score': 0.2858592254984136, 'support': 8016481}}
[[ 513546 2161997  386960]
 [ 214807 1307878  281541]
 [ 297051 2222383  630318]]
Evaluating performance on  train set...
5759/5759 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0316236
{'0': {'precision': 0.45059801221802587, 'recall': 0.2654001137535789, 'f1-score': 0.3340477002995488, 'support': 414932}, '1': {'precision': 0.48271822879923515, 'recall': 0.6814228251095218, 'f1-score': 0.5651123085055647, 'support': 641653}, '2': {'precision': 0.4320564696586697, 'recall': 0.3352243609699559, 'f1-score': 0.37753022925282803, 'support': 417586}, 'accuracy': 0.4662586633436691, 'macro avg': {'precision': 0.45512423689197695, 'recall': 0.42734909994435216, 'f1-score': 0.42556341268598047, 'support': 1474171}, 'weighted avg': {'precision': 0.45932654149908714, 'recall': 0.4662586633436691, 'f1-score': 0.44693894180728344, 'support': 1474171}}
[[110123 236590  68219]
 [ 88623 437237 115793]
 [ 45647 231954 139985]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0837505
{'0': {'precision': 0.5062700680672612, 'recall': 0.22932975563323652, 'f1-score': 0.315668349158166, 'support': 487464}, '1': {'precision': 0.37982445311868146, 'recall': 0.7176265031898488, 'f1-score': 0.49673671985197465, 'support': 497359}, '2': {'precision': 0.4785346289707589, 'recall': 0.3067367190629164, 'f1-score': 0.373843111469759, 'support': 489348}, 'accuracy': 0.41976744895944906, 'macro avg': {'precision': 0.45487638338556713, 'recall': 0.4178976592953339, 'f1-score': 0.39541606015996655, 'support': 1474171}, 'weighted avg': {'precision': 0.45440285167499334, 'recall': 0.41976744895944906, 'f1-score': 0.39606857909591087, 'support': 1474171}}
[[111790 294212  81462]
 [ 58336 356918  82105]
 [ 50685 288562 150101]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869809
{'0': {'precision': 0.5187953831582665, 'recall': 0.19595332029039403, 'f1-score': 0.284462713652174, 'support': 494776}, '1': {'precision': 0.3631619319521955, 'recall': 0.730128982244324, 'f1-score': 0.48505854813767746, 'support': 485028}, '2': {'precision': 0.47376918936928164, 'recall': 0.29914618087372336, 'f1-score': 0.36673159590784593, 'support': 494367}, 'accuracy': 0.406312429155098, 'macro avg': {'precision': 0.4519088348265812, 'recall': 0.40840949446948044, 'f1-score': 0.37875095256589913, 'support': 1474171}, 'weighted avg': {'precision': 0.4524896113607903, 'recall': 0.406312429155098, 'f1-score': 0.3780513250974707, 'support': 1474171}}
[[ 96953 315507  82316]
 [ 48947 354133  81948]
 [ 40981 305498 147888]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932983
{'0': {'precision': 0.5133538026658869, 'recall': 0.16922378684060438, 'f1-score': 0.25454007225450986, 'support': 497956}, '1': {'precision': 0.3454693686481766, 'recall': 0.7345892774243736, 'f1-score': 0.4699339148116438, 'support': 478206}, '2': {'precision': 0.4593999092735403, 'recall': 0.2704589676090191, 'f1-score': 0.34047356034772586, 'support': 498009}, 'accuracy': 0.3868221529252712, 'macro avg': {'precision': 0.4394076935292013, 'recall': 0.39142401062466564, 'f1-score': 0.3549825158046265, 'support': 1474171}, 'weighted avg': {'precision': 0.44066693787998196, 'recall': 0.3868221529252712, 'f1-score': 0.35344194886562974, 'support': 1474171}}
[[ 84266 337306  76384]
 [ 44807 351285  82114]
 [ 35075 328243 134691]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0757729
{'0': {'precision': 0.46854369176213173, 'recall': 0.21962476348782514, 'f1-score': 0.2990657206151475, 'support': 169653}, '1': {'precision': 0.41603682658419044, 'recall': 0.6986881839924625, 'f1-score': 0.521527752731994, 'support': 206965}, '2': {'precision': 0.4518546176627829, 'recall': 0.3163419894130857, 'f1-score': 0.37214584745703483, 'support': 168321}, 'accuracy': 0.4314446204070547, 'macro avg': {'precision': 0.4454783786697017, 'recall': 0.4115516456311244, 'f1-score': 0.3975797736013922, 'support': 544939}, 'weighted avg': {'precision': 0.4434469286509778, 'recall': 0.4314446204070547, 'f1-score': 0.40612866620578514, 'support': 544939}}
[[ 37260 105101  27292]
 [ 25059 144604  37302]
 [ 17204  97870  53247]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1240839
{'0': {'precision': 0.5064806968311962, 'recall': 0.18945125753481604, 'f1-score': 0.2757551347651301, 'support': 192440}, '1': {'precision': 0.3256918212596883, 'recall': 0.7269258391881342, 'f1-score': 0.44983816894196305, 'support': 160125}, '2': {'precision': 0.49110465015662047, 'recall': 0.29502427562976286, 'f1-score': 0.36861076833149314, 'support': 192374}, 'accuracy': 0.3846522271300091, 'macro avg': {'precision': 0.441092389415835, 'recall': 0.40380045745090437, 'f1-score': 0.3647346906795288, 'support': 544939}, 'weighted avg': {'precision': 0.44792961073924364, 'recall': 0.3846522271300091, 'f1-score': 0.35968756665064555, 'support': 544939}}
[[ 36458 124301  31681]
 [ 16596 116399  27130]
 [ 18929 116690  56755]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1181284
{'0': {'precision': 0.5048684276227093, 'recall': 0.15859397057439534, 'f1-score': 0.2413673744643774, 'support': 191262}, '1': {'precision': 0.32179740776359506, 'recall': 0.7303511524223503, 'f1-score': 0.44675270489393787, 'support': 161269}, '2': {'precision': 0.4816394877231955, 'recall': 0.29748763045195625, 'f1-score': 0.3678008032128514, 'support': 192408}, 'accuracy': 0.3768403435980908, 'macro avg': {'precision': 0.4361017743698333, 'recall': 0.3954775844829006, 'f1-score': 0.35197362752372224, 'support': 544939}, 'weighted avg': {'precision': 0.44248875912798763, 'recall': 0.3768403435980908, 'f1-score': 0.3467903484333559, 'support': 544939}}
[[ 30333 128427  32502]
 [ 14385 117783  29101]
 [ 15363 119806  57239]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.113399
{'0': {'precision': 0.4884009073406912, 'recall': 0.1360693782826432, 'f1-score': 0.21284089681926546, 'support': 188301}, '1': {'precision': 0.3200811423825192, 'recall': 0.7268363750672526, 'f1-score': 0.44444115869492495, 'support': 165421}, '2': {'precision': 0.4617517673439345, 'recall': 0.282150645601594, 'f1-score': 0.35027056505409676, 'support': 191217}, 'accuracy': 0.3666612226322579, 'macro avg': {'precision': 0.4234112723557149, 'recall': 0.3816854663171633, 'f1-score': 0.3358508735227624, 'support': 544939}, 'weighted avg': {'precision': 0.42795488963613054, 'recall': 0.3666612226322579, 'f1-score': 0.3313687243203127, 'support': 544939}}
[[ 25622 131037  31642]
 [ 13939 120234  31248]
 [ 12900 124365  53952]]
training model: results/AAPL/W5/deepLOB_L2/seq2seq
Epoch 1/50
5759/5759 - 287s - loss: 12.2782 - accuracy10: 0.4736 - accuracy20: 0.4657 - accuracy30: 0.4517 - accuracy50: 0.4310 - val_loss: 13.9153 - val_accuracy10: 0.4076 - val_accuracy20: 0.3570 - val_accuracy30: 0.3473 - val_accuracy50: 0.3406 - 287s/epoch - 50ms/step
Epoch 2/50
5759/5759 - 273s - loss: 11.9688 - accuracy10: 0.5090 - accuracy20: 0.5001 - accuracy30: 0.4795 - accuracy50: 0.4493 - val_loss: 13.0020 - val_accuracy10: 0.4643 - val_accuracy20: 0.4296 - val_accuracy30: 0.4057 - val_accuracy50: 0.3753 - 273s/epoch - 47ms/step
Epoch 3/50
5759/5759 - 271s - loss: 11.7723 - accuracy10: 0.5287 - accuracy20: 0.5173 - accuracy30: 0.4952 - accuracy50: 0.4605 - val_loss: 13.3651 - val_accuracy10: 0.4457 - val_accuracy20: 0.4032 - val_accuracy30: 0.3839 - val_accuracy50: 0.3590 - 271s/epoch - 47ms/step
Epoch 4/50
5759/5759 - 270s - loss: 11.6790 - accuracy10: 0.5378 - accuracy20: 0.5248 - accuracy30: 0.5023 - accuracy50: 0.4659 - val_loss: 12.9733 - val_accuracy10: 0.4671 - val_accuracy20: 0.4366 - val_accuracy30: 0.4116 - val_accuracy50: 0.3784 - 270s/epoch - 47ms/step
Epoch 5/50
5759/5759 - 270s - loss: 11.6180 - accuracy10: 0.5433 - accuracy20: 0.5290 - accuracy30: 0.5060 - accuracy50: 0.4693 - val_loss: 12.9451 - val_accuracy10: 0.4756 - val_accuracy20: 0.4370 - val_accuracy30: 0.4115 - val_accuracy50: 0.3807 - 270s/epoch - 47ms/step
Epoch 6/50
5759/5759 - 270s - loss: 11.5737 - accuracy10: 0.5466 - accuracy20: 0.5325 - accuracy30: 0.5091 - accuracy50: 0.4714 - val_loss: 13.0383 - val_accuracy10: 0.4765 - val_accuracy20: 0.4381 - val_accuracy30: 0.4121 - val_accuracy50: 0.3802 - 270s/epoch - 47ms/step
Epoch 7/50
5759/5759 - 270s - loss: 11.5370 - accuracy10: 0.5494 - accuracy20: 0.5355 - accuracy30: 0.5116 - accuracy50: 0.4735 - val_loss: 12.9570 - val_accuracy10: 0.4743 - val_accuracy20: 0.4406 - val_accuracy30: 0.4150 - val_accuracy50: 0.3837 - 270s/epoch - 47ms/step
Epoch 8/50
5759/5759 - 269s - loss: 11.5087 - accuracy10: 0.5519 - accuracy20: 0.5375 - accuracy30: 0.5138 - accuracy50: 0.4753 - val_loss: 12.9560 - val_accuracy10: 0.4802 - val_accuracy20: 0.4457 - val_accuracy30: 0.4174 - val_accuracy50: 0.3841 - 269s/epoch - 47ms/step
Epoch 9/50
5759/5759 - 270s - loss: 11.4843 - accuracy10: 0.5535 - accuracy20: 0.5390 - accuracy30: 0.5152 - accuracy50: 0.4768 - val_loss: 12.8876 - val_accuracy10: 0.4802 - val_accuracy20: 0.4461 - val_accuracy30: 0.4200 - val_accuracy50: 0.3878 - 270s/epoch - 47ms/step
Epoch 10/50
5759/5759 - 268s - loss: 11.4637 - accuracy10: 0.5551 - accuracy20: 0.5406 - accuracy30: 0.5164 - accuracy50: 0.4778 - val_loss: 12.9773 - val_accuracy10: 0.4776 - val_accuracy20: 0.4419 - val_accuracy30: 0.4153 - val_accuracy50: 0.3845 - 268s/epoch - 47ms/step
Epoch 11/50
5759/5759 - 270s - loss: 11.4484 - accuracy10: 0.5561 - accuracy20: 0.5416 - accuracy30: 0.5177 - accuracy50: 0.4790 - val_loss: 12.8624 - val_accuracy10: 0.4841 - val_accuracy20: 0.4512 - val_accuracy30: 0.4238 - val_accuracy50: 0.3903 - 270s/epoch - 47ms/step
Epoch 12/50
5759/5759 - 271s - loss: 11.4322 - accuracy10: 0.5571 - accuracy20: 0.5428 - accuracy30: 0.5188 - accuracy50: 0.4800 - val_loss: 12.8530 - val_accuracy10: 0.4818 - val_accuracy20: 0.4505 - val_accuracy30: 0.4221 - val_accuracy50: 0.3866 - 271s/epoch - 47ms/step
Epoch 13/50
5759/5759 - 275s - loss: 11.4138 - accuracy10: 0.5584 - accuracy20: 0.5438 - accuracy30: 0.5198 - accuracy50: 0.4810 - val_loss: 12.8174 - val_accuracy10: 0.4863 - val_accuracy20: 0.4537 - val_accuracy30: 0.4261 - val_accuracy50: 0.3902 - 275s/epoch - 48ms/step
Epoch 14/50
5759/5759 - 270s - loss: 11.3994 - accuracy10: 0.5592 - accuracy20: 0.5445 - accuracy30: 0.5207 - accuracy50: 0.4817 - val_loss: 12.7679 - val_accuracy10: 0.4891 - val_accuracy20: 0.4591 - val_accuracy30: 0.4307 - val_accuracy50: 0.3935 - 270s/epoch - 47ms/step
Epoch 15/50
5759/5759 - 269s - loss: 11.3895 - accuracy10: 0.5598 - accuracy20: 0.5456 - accuracy30: 0.5215 - accuracy50: 0.4823 - val_loss: 12.7608 - val_accuracy10: 0.4885 - val_accuracy20: 0.4569 - val_accuracy30: 0.4287 - val_accuracy50: 0.3930 - 269s/epoch - 47ms/step
Epoch 16/50
5759/5759 - 270s - loss: 11.3772 - accuracy10: 0.5607 - accuracy20: 0.5465 - accuracy30: 0.5225 - accuracy50: 0.4831 - val_loss: 12.8793 - val_accuracy10: 0.4867 - val_accuracy20: 0.4515 - val_accuracy30: 0.4241 - val_accuracy50: 0.3899 - 270s/epoch - 47ms/step
Epoch 17/50
5759/5759 - 270s - loss: 11.3665 - accuracy10: 0.5611 - accuracy20: 0.5472 - accuracy30: 0.5232 - accuracy50: 0.4839 - val_loss: 12.8177 - val_accuracy10: 0.4963 - val_accuracy20: 0.4626 - val_accuracy30: 0.4342 - val_accuracy50: 0.3969 - 270s/epoch - 47ms/step
Epoch 18/50
5759/5759 - 270s - loss: 11.3561 - accuracy10: 0.5616 - accuracy20: 0.5477 - accuracy30: 0.5239 - accuracy50: 0.4847 - val_loss: 12.7401 - val_accuracy10: 0.4936 - val_accuracy20: 0.4622 - val_accuracy30: 0.4351 - val_accuracy50: 0.3984 - 270s/epoch - 47ms/step
Epoch 19/50
5759/5759 - 270s - loss: 11.3474 - accuracy10: 0.5624 - accuracy20: 0.5485 - accuracy30: 0.5245 - accuracy50: 0.4852 - val_loss: 12.7589 - val_accuracy10: 0.4932 - val_accuracy20: 0.4612 - val_accuracy30: 0.4328 - val_accuracy50: 0.3966 - 270s/epoch - 47ms/step
Epoch 20/50
5759/5759 - 271s - loss: 11.3370 - accuracy10: 0.5628 - accuracy20: 0.5487 - accuracy30: 0.5249 - accuracy50: 0.4858 - val_loss: 12.7371 - val_accuracy10: 0.4955 - val_accuracy20: 0.4635 - val_accuracy30: 0.4370 - val_accuracy50: 0.4018 - 271s/epoch - 47ms/step
Epoch 21/50
5759/5759 - 269s - loss: 11.3265 - accuracy10: 0.5639 - accuracy20: 0.5499 - accuracy30: 0.5258 - accuracy50: 0.4858 - val_loss: 12.7195 - val_accuracy10: 0.4956 - val_accuracy20: 0.4658 - val_accuracy30: 0.4392 - val_accuracy50: 0.4042 - 269s/epoch - 47ms/step
Epoch 22/50
5759/5759 - 271s - loss: 11.3201 - accuracy10: 0.5640 - accuracy20: 0.5501 - accuracy30: 0.5260 - accuracy50: 0.4867 - val_loss: 12.6690 - val_accuracy10: 0.4964 - val_accuracy20: 0.4687 - val_accuracy30: 0.4430 - val_accuracy50: 0.4088 - 271s/epoch - 47ms/step
Epoch 23/50
5759/5759 - 270s - loss: 11.3097 - accuracy10: 0.5646 - accuracy20: 0.5508 - accuracy30: 0.5269 - accuracy50: 0.4876 - val_loss: 12.6701 - val_accuracy10: 0.4969 - val_accuracy20: 0.4675 - val_accuracy30: 0.4422 - val_accuracy50: 0.4077 - 270s/epoch - 47ms/step
Epoch 24/50
5759/5759 - 270s - loss: 11.3011 - accuracy10: 0.5652 - accuracy20: 0.5514 - accuracy30: 0.5275 - accuracy50: 0.4881 - val_loss: 12.6697 - val_accuracy10: 0.4985 - val_accuracy20: 0.4675 - val_accuracy30: 0.4391 - val_accuracy50: 0.4034 - 270s/epoch - 47ms/step
Epoch 25/50
5759/5759 - 271s - loss: 11.2954 - accuracy10: 0.5655 - accuracy20: 0.5516 - accuracy30: 0.5279 - accuracy50: 0.4887 - val_loss: 12.6509 - val_accuracy10: 0.4993 - val_accuracy20: 0.4682 - val_accuracy30: 0.4417 - val_accuracy50: 0.4066 - 271s/epoch - 47ms/step
Epoch 26/50
5759/5759 - 268s - loss: 11.2853 - accuracy10: 0.5658 - accuracy20: 0.5525 - accuracy30: 0.5288 - accuracy50: 0.4893 - val_loss: 12.7146 - val_accuracy10: 0.5007 - val_accuracy20: 0.4680 - val_accuracy30: 0.4399 - val_accuracy50: 0.4043 - 268s/epoch - 47ms/step
Epoch 27/50
5759/5759 - 271s - loss: 11.2786 - accuracy10: 0.5665 - accuracy20: 0.5529 - accuracy30: 0.5288 - accuracy50: 0.4894 - val_loss: 12.6354 - val_accuracy10: 0.5002 - val_accuracy20: 0.4737 - val_accuracy30: 0.4460 - val_accuracy50: 0.4100 - 271s/epoch - 47ms/step
Epoch 28/50
5759/5759 - 270s - loss: 11.2728 - accuracy10: 0.5664 - accuracy20: 0.5534 - accuracy30: 0.5298 - accuracy50: 0.4902 - val_loss: 12.6964 - val_accuracy10: 0.4998 - val_accuracy20: 0.4693 - val_accuracy30: 0.4425 - val_accuracy50: 0.4080 - 270s/epoch - 47ms/step
Epoch 29/50
5759/5759 - 272s - loss: 11.2638 - accuracy10: 0.5668 - accuracy20: 0.5538 - accuracy30: 0.5301 - accuracy50: 0.4911 - val_loss: 12.6833 - val_accuracy10: 0.5000 - val_accuracy20: 0.4697 - val_accuracy30: 0.4418 - val_accuracy50: 0.4072 - 272s/epoch - 47ms/step
Epoch 30/50
5759/5759 - 270s - loss: 11.2562 - accuracy10: 0.5675 - accuracy20: 0.5547 - accuracy30: 0.5306 - accuracy50: 0.4912 - val_loss: 12.6761 - val_accuracy10: 0.5005 - val_accuracy20: 0.4701 - val_accuracy30: 0.4433 - val_accuracy50: 0.4082 - 270s/epoch - 47ms/step
Epoch 31/50
5759/5759 - 268s - loss: 11.2492 - accuracy10: 0.5676 - accuracy20: 0.5550 - accuracy30: 0.5312 - accuracy50: 0.4920 - val_loss: 12.6114 - val_accuracy10: 0.5027 - val_accuracy20: 0.4759 - val_accuracy30: 0.4495 - val_accuracy50: 0.4133 - 268s/epoch - 47ms/step
Epoch 32/50
5759/5759 - 268s - loss: 11.2475 - accuracy10: 0.5680 - accuracy20: 0.5550 - accuracy30: 0.5316 - accuracy50: 0.4920 - val_loss: 12.6108 - val_accuracy10: 0.5020 - val_accuracy20: 0.4755 - val_accuracy30: 0.4482 - val_accuracy50: 0.4115 - 268s/epoch - 47ms/step
Epoch 33/50
5759/5759 - 269s - loss: 11.2386 - accuracy10: 0.5682 - accuracy20: 0.5556 - accuracy30: 0.5324 - accuracy50: 0.4931 - val_loss: 12.6166 - val_accuracy10: 0.5029 - val_accuracy20: 0.4780 - val_accuracy30: 0.4504 - val_accuracy50: 0.4142 - 269s/epoch - 47ms/step
Epoch 34/50
5759/5759 - 270s - loss: 11.2328 - accuracy10: 0.5685 - accuracy20: 0.5560 - accuracy30: 0.5324 - accuracy50: 0.4932 - val_loss: 12.6134 - val_accuracy10: 0.5007 - val_accuracy20: 0.4776 - val_accuracy30: 0.4495 - val_accuracy50: 0.4132 - 270s/epoch - 47ms/step
Epoch 35/50
5759/5759 - 271s - loss: 11.2255 - accuracy10: 0.5691 - accuracy20: 0.5564 - accuracy30: 0.5329 - accuracy50: 0.4943 - val_loss: 12.8321 - val_accuracy10: 0.4976 - val_accuracy20: 0.4674 - val_accuracy30: 0.4376 - val_accuracy50: 0.4031 - 271s/epoch - 47ms/step
Epoch 36/50
5759/5759 - 269s - loss: 11.2190 - accuracy10: 0.5694 - accuracy20: 0.5572 - accuracy30: 0.5336 - accuracy50: 0.4946 - val_loss: 12.7847 - val_accuracy10: 0.4965 - val_accuracy20: 0.4701 - val_accuracy30: 0.4411 - val_accuracy50: 0.4057 - 269s/epoch - 47ms/step
Epoch 37/50
5759/5759 - 271s - loss: 11.2119 - accuracy10: 0.5700 - accuracy20: 0.5575 - accuracy30: 0.5338 - accuracy50: 0.4951 - val_loss: 12.7224 - val_accuracy10: 0.4985 - val_accuracy20: 0.4730 - val_accuracy30: 0.4445 - val_accuracy50: 0.4099 - 271s/epoch - 47ms/step
Epoch 38/50
5759/5759 - 271s - loss: 11.2069 - accuracy10: 0.5698 - accuracy20: 0.5578 - accuracy30: 0.5347 - accuracy50: 0.4954 - val_loss: 12.6830 - val_accuracy10: 0.5011 - val_accuracy20: 0.4743 - val_accuracy30: 0.4474 - val_accuracy50: 0.4124 - 271s/epoch - 47ms/step
Epoch 39/50
5759/5759 - 273s - loss: 11.2032 - accuracy10: 0.5697 - accuracy20: 0.5578 - accuracy30: 0.5347 - accuracy50: 0.4957 - val_loss: 12.7815 - val_accuracy10: 0.4971 - val_accuracy20: 0.4725 - val_accuracy30: 0.4455 - val_accuracy50: 0.4100 - 273s/epoch - 47ms/step
Epoch 40/50
5759/5759 - 273s - loss: 11.1961 - accuracy10: 0.5700 - accuracy20: 0.5584 - accuracy30: 0.5354 - accuracy50: 0.4965 - val_loss: 12.7732 - val_accuracy10: 0.4989 - val_accuracy20: 0.4736 - val_accuracy30: 0.4445 - val_accuracy50: 0.4085 - 273s/epoch - 47ms/step
Epoch 41/50
5759/5759 - 271s - loss: 11.1905 - accuracy10: 0.5701 - accuracy20: 0.5583 - accuracy30: 0.5354 - accuracy50: 0.4968 - val_loss: 12.7527 - val_accuracy10: 0.4998 - val_accuracy20: 0.4733 - val_accuracy30: 0.4440 - val_accuracy50: 0.4088 - 271s/epoch - 47ms/step
Epoch 42/50
5759/5759 - 270s - loss: 11.1858 - accuracy10: 0.5706 - accuracy20: 0.5588 - accuracy30: 0.5364 - accuracy50: 0.4974 - val_loss: 12.8029 - val_accuracy10: 0.4968 - val_accuracy20: 0.4709 - val_accuracy30: 0.4436 - val_accuracy50: 0.4107 - 270s/epoch - 47ms/step
testing model: results/AAPL/W5/deepLOB_L2/seq2seq
Evaluating performance on  test set...
31315/31315 - 496s - 496s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0762857
{'0': {'precision': 0.4730705768623975, 'recall': 0.4160573620133973, 'f1-score': 0.4427360510218322, 'support': 2828771}, '1': {'precision': 0.4813178953150252, 'recall': 0.2743660200601003, 'f1-score': 0.34950399931625786, 'support': 2325113}, '2': {'precision': 0.43861968550488967, 'recall': 0.6440385355700863, 'f1-score': 0.5218414720839554, 'support': 2862602}, 'accuracy': 0.4563706591641275, 'macro avg': {'precision': 0.46433605256077076, 'recall': 0.44482063921452797, 'f1-score': 0.4380271741406818, 'support': 8016486}, 'weighted avg': {'precision': 0.4631605934666253, 'recall': 0.4563706591641275, 'f1-score': 0.4439425997647568, 'support': 8016486}}
[[1176931  360500 1291340]
 [ 618902  637932 1068279]
 [ 692022  326954 1843626]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.074864
{'0': {'precision': 0.4902977907411611, 'recall': 0.3869161767775843, 'f1-score': 0.4325151073749, 'support': 3137615}, '1': {'precision': 0.3497828224005471, 'recall': 0.3110580303692583, 'f1-score': 0.32928580409908215, 'support': 1683808}, '2': {'precision': 0.4709291971922257, 'recall': 0.5959178269724259, 'f1-score': 0.5261018637014043, 'support': 3195063}, 'accuracy': 0.4542827119014491, 'macro avg': {'precision': 0.43700327011131135, 'recall': 0.4312973447064228, 'f1-score': 0.4293009250584621, 'support': 8016486}, 'weighted avg': {'precision': 0.453064007207838, 'recall': 0.4542827119014491, 'f1-score': 0.4481325806342035, 'support': 8016486}}
[[1213994  503951 1419670]
 [ 440651  523762  719395]
 [ 821389  469679 1903995]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864828
{'0': {'precision': 0.4766894199129421, 'recall': 0.3560423919029018, 'f1-score': 0.407626174123258, 'support': 3105310}, '1': {'precision': 0.30033905155977014, 'recall': 0.3262064551458976, 'f1-score': 0.31273877572381387, 'support': 1731146}, '2': {'precision': 0.4637913575670085, 'recall': 0.5566705345547055, 'f1-score': 0.5060041632752814, 'support': 3180030}, 'accuracy': 0.42918580535162165, 'macro avg': {'precision': 0.4136066096799069, 'recall': 0.4129731272011683, 'f1-score': 0.40878970437411777, 'support': 8016486}, 'weighted avg': {'precision': 0.43349038482761176, 'recall': 0.42918580535162165, 'f1-score': 0.4261606063736861, 'support': 8016486}}
[[1105622  673171 1326517]
 [ 446316  564711  720119]
 [ 767438  642363 1770229]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.10483
{'0': {'precision': 0.4599997398780028, 'recall': 0.3118151240144104, 'f1-score': 0.3716820772621192, 'support': 3062507}, '1': {'precision': 0.2632547955406885, 'recall': 0.36051248568638294, 'f1-score': 0.3043014392243669, 'support': 1804226}, '2': {'precision': 0.4516994298151568, 'recall': 0.49758981101057764, 'f1-score': 0.4735354078590468, 'support': 3149753}, 'accuracy': 0.39576779651333516, 'macro avg': {'precision': 0.39165132174461603, 'recall': 0.389972473570457, 'f1-score': 0.38317297478184437, 'support': 8016486}, 'weighted avg': {'precision': 0.41245817734507817, 'recall': 0.39576779651333516, 'f1-score': 0.39653622589574283, 'support': 8016486}}
[[ 954936  918473 1189098]
 [ 440411  650446  713369]
 [ 680602  901866 1567285]]
Evaluating performance on  train set...
5759/5759 - 94s - 94s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.963785
{'0': {'precision': 0.4933716257268275, 'recall': 0.4871888779124401, 'f1-score': 0.49026075971772143, 'support': 415030}, '1': {'precision': 0.6219462286136531, 'recall': 0.5114566973300426, 'f1-score': 0.5613159393227417, 'support': 641808}, '2': {'precision': 0.4476072261267759, 'recall': 0.5754743203285618, 'f1-score': 0.5035502108740343, 'support': 417334}, 'accuracy': 0.5227476848020448, 'macro avg': {'precision': 0.5209750268224188, 'recall': 0.5247066318570148, 'f1-score': 0.5183756366381659, 'support': 1474172}, 'weighted avg': {'precision': 0.5363931786981903, 'recall': 0.5227476848020448, 'f1-score': 0.5249581508775099, 'support': 1474172}}
[[202198 102278 110554]
 [127717 328257 185834]
 [ 79914  97255 240165]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9974257
{'0': {'precision': 0.5357024537254734, 'recall': 0.4112365173482426, 'f1-score': 0.46528956592667714, 'support': 487571}, '1': {'precision': 0.4959888022534079, 'recall': 0.575588828936047, 'f1-score': 0.5328323502564002, 'support': 497428}, '2': {'precision': 0.4879732121502033, 'recall': 0.521343164892584, 'f1-score': 0.5041065509123362, 'support': 489173}, 'accuracy': 0.5032302879175564, 'macro avg': {'precision': 0.5065548227096949, 'recall': 0.5027228370589579, 'f1-score': 0.5007428223651379, 'support': 1474172}, 'weighted avg': {'precision': 0.5064639805259105, 'recall': 0.5032302879175564, 'f1-score': 0.5009610432847842, 'support': 1474172}}
[[200507 148865 138199]
 [ 81715 286314 129399]
 [ 92066 142080 255027]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.021411
{'0': {'precision': 0.5291027977275163, 'recall': 0.3489649823053181, 'f1-score': 0.42055602687020965, 'support': 495064}, '1': {'precision': 0.4504917558349311, 'recall': 0.5905001257633422, 'f1-score': 0.5110807167246153, 'support': 485038}, '2': {'precision': 0.4746285218628022, 'recall': 0.4917319408181027, 'f1-score': 0.4830288763589226, 'support': 494070}, 'accuracy': 0.47628431417772144, 'macro avg': {'precision': 0.4847410251417499, 'recall': 0.4770656829622543, 'f1-score': 0.47155520665124917, 'support': 1474172}, 'weighted avg': {'precision': 0.48498077667842904, 'recall': 0.47628431417772144, 'f1-score': 0.47127865303899436, 'support': 1474172}}
[[172760 179126 143178]
 [ 72877 286415 125746]
 [ 80878 170242 242950]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0568594
{'0': {'precision': 0.5036431268198219, 'recall': 0.29047271821510856, 'f1-score': 0.3684464652667277, 'support': 497823}, '1': {'precision': 0.3973871824711124, 'recall': 0.5652914569503202, 'f1-score': 0.46669692284329833, 'support': 478424}, '2': {'precision': 0.4497322740124149, 'recall': 0.4574664859165537, 'f1-score': 0.4535664114263754, 'support': 497925}, 'accuracy': 0.43606648342255855, 'macro avg': {'precision': 0.45025419443444975, 'recall': 0.43774355369399415, 'f1-score': 0.4295699331788005, 'support': 1474172}, 'weighted avg': {'precision': 0.45094984862486565, 'recall': 0.43606648342255855, 'f1-score': 0.4290830301364687, 'support': 1474172}}
[[144604 209888 143331]
 [ 72602 270449 135373]
 [ 69910 200231 227784]]
Evaluating performance on  val set...
2129/2129 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9998096
{'0': {'precision': 0.48771466158538385, 'recall': 0.48721454459734215, 'f1-score': 0.48746447481692007, 'support': 169685}, '1': {'precision': 0.5668088519450217, 'recall': 0.5257109456894011, 'f1-score': 0.5454868977685106, 'support': 207013}, '2': {'precision': 0.44882404893526545, 'recall': 0.4893308448544359, 'f1-score': 0.4682029641593776, 'support': 168242}, 'accuracy': 0.5024920174698132, 'macro avg': {'precision': 0.5011158541552237, 'recall': 0.5007521117137265, 'f1-score': 0.5003847789149362, 'support': 544940}, 'weighted avg': {'precision': 0.5057542460817293, 'recall': 0.5024920174698132, 'f1-score': 0.503559459157272, 'support': 544940}}
[[ 82673  40269  46743]
 [ 43827 108829  54357]
 [ 43011  42905  82326]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0343186
{'0': {'precision': 0.5147609750949768, 'recall': 0.40536216979858103, 'f1-score': 0.4535580415516489, 'support': 192534}, '1': {'precision': 0.44699341100998974, 'recall': 0.5783963195859534, 'f1-score': 0.5042752742551648, 'support': 159982}, '2': {'precision': 0.47625488428013224, 'recall': 0.46112751008190245, 'f1-score': 0.46856913522876087, 'support': 192424}, 'accuracy': 0.4758523874187984, 'macro avg': {'precision': 0.4793364234616995, 'recall': 0.4816286664888123, 'f1-score': 0.47546748367852487, 'support': 544940}, 'weighted avg': {'precision': 0.48126905588111824, 'recall': 0.4758523874187984, 'f1-score': 0.47374804230787615, 'support': 544940}}
[[78046 56557 57931]
 [27800 92533 39649]
 [45770 57922 88732]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0534976
{'0': {'precision': 0.5041813554231153, 'recall': 0.3332654116835687, 'f1-score': 0.40128211983857115, 'support': 191397}, '1': {'precision': 0.4080951015905281, 'recall': 0.5830928577191121, 'f1-score': 0.4801457418294892, 'support': 161139}, '2': {'precision': 0.45919506025889006, 'recall': 0.4491330741564624, 'f1-score': 0.4541083364863161, 'support': 192404}, 'accuracy': 0.44804932653136126, 'macro avg': {'precision': 0.4571571724241778, 'recall': 0.4551637811863811, 'f1-score': 0.4451787327181255, 'support': 544940}, 'weighted avg': {'precision': 0.4598851283318633, 'recall': 0.44804932653136126, 'f1-score': 0.4432536773896543, 'support': 544940}}
[[63786 67802 59809]
 [25216 93959 41964]
 [37512 68477 86415]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797251
{'0': {'precision': 0.47844748770558854, 'recall': 0.26406926406926406, 'f1-score': 0.3403109106217528, 'support': 188265}, '1': {'precision': 0.3677452121299373, 'recall': 0.5559061782130335, 'f1-score': 0.44266015851583346, 'support': 165420}, '2': {'precision': 0.4327650126720147, 'recall': 0.43212465033593894, 'f1-score': 0.4324445944425695, 'support': 191255}, 'accuracy': 0.4116398135574559, 'macro avg': {'precision': 0.42631923750251355, 'recall': 0.4173666975394122, 'f1-score': 0.40513855452671854, 'support': 544940}, 'weighted avg': {'precision': 0.42881014746947016, 'recall': 0.4116398135574559, 'f1-score': 0.4037153960436141, 'support': 544940}}
[[49715 78588 59962]
 [25098 91958 48364]
 [29096 79513 82646]]
training model: results/AAPL/W5/deepOF_L2/seq2seq
Epoch 1/50
5759/5759 - 171s - loss: 11.9255 - accuracy10: 0.5197 - accuracy20: 0.5072 - accuracy30: 0.4866 - accuracy50: 0.4532 - val_loss: 12.4687 - val_accuracy10: 0.5104 - val_accuracy20: 0.4845 - val_accuracy30: 0.4598 - val_accuracy50: 0.4232 - 171s/epoch - 30ms/step
Epoch 2/50
5759/5759 - 161s - loss: 11.7198 - accuracy10: 0.5378 - accuracy20: 0.5234 - accuracy30: 0.5005 - accuracy50: 0.4644 - val_loss: 12.3455 - val_accuracy10: 0.5150 - val_accuracy20: 0.4931 - val_accuracy30: 0.4694 - val_accuracy50: 0.4325 - 161s/epoch - 28ms/step
Epoch 3/50
5759/5759 - 159s - loss: 11.6456 - accuracy10: 0.5433 - accuracy20: 0.5286 - accuracy30: 0.5055 - accuracy50: 0.4689 - val_loss: 12.3136 - val_accuracy10: 0.5184 - val_accuracy20: 0.4942 - val_accuracy30: 0.4690 - val_accuracy50: 0.4323 - 159s/epoch - 28ms/step
Epoch 4/50
5759/5759 - 161s - loss: 11.5914 - accuracy10: 0.5468 - accuracy20: 0.5319 - accuracy30: 0.5088 - accuracy50: 0.4718 - val_loss: 12.2285 - val_accuracy10: 0.5189 - val_accuracy20: 0.4994 - val_accuracy30: 0.4744 - val_accuracy50: 0.4364 - 161s/epoch - 28ms/step
Epoch 5/50
5759/5759 - 161s - loss: 11.5499 - accuracy10: 0.5498 - accuracy20: 0.5347 - accuracy30: 0.5111 - accuracy50: 0.4738 - val_loss: 12.1819 - val_accuracy10: 0.5190 - val_accuracy20: 0.5016 - val_accuracy30: 0.4755 - val_accuracy50: 0.4370 - 161s/epoch - 28ms/step
Epoch 6/50
5759/5759 - 160s - loss: 11.5152 - accuracy10: 0.5526 - accuracy20: 0.5370 - accuracy30: 0.5136 - accuracy50: 0.4760 - val_loss: 12.1416 - val_accuracy10: 0.5252 - val_accuracy20: 0.5054 - val_accuracy30: 0.4795 - val_accuracy50: 0.4407 - 160s/epoch - 28ms/step
Epoch 7/50
5759/5759 - 159s - loss: 11.4869 - accuracy10: 0.5547 - accuracy20: 0.5391 - accuracy30: 0.5158 - accuracy50: 0.4775 - val_loss: 12.1304 - val_accuracy10: 0.5270 - val_accuracy20: 0.5063 - val_accuracy30: 0.4797 - val_accuracy50: 0.4407 - 159s/epoch - 28ms/step
Epoch 8/50
5759/5759 - 159s - loss: 11.4625 - accuracy10: 0.5565 - accuracy20: 0.5409 - accuracy30: 0.5173 - accuracy50: 0.4789 - val_loss: 12.0698 - val_accuracy10: 0.5278 - val_accuracy20: 0.5087 - val_accuracy30: 0.4827 - val_accuracy50: 0.4433 - 159s/epoch - 28ms/step
Epoch 9/50
5759/5759 - 162s - loss: 11.4410 - accuracy10: 0.5578 - accuracy20: 0.5422 - accuracy30: 0.5186 - accuracy50: 0.4799 - val_loss: 12.0027 - val_accuracy10: 0.5313 - val_accuracy20: 0.5138 - val_accuracy30: 0.4883 - val_accuracy50: 0.4489 - 162s/epoch - 28ms/step
Epoch 10/50
5759/5759 - 163s - loss: 11.4223 - accuracy10: 0.5591 - accuracy20: 0.5438 - accuracy30: 0.5198 - accuracy50: 0.4807 - val_loss: 11.9818 - val_accuracy10: 0.5307 - val_accuracy20: 0.5144 - val_accuracy30: 0.4901 - val_accuracy50: 0.4517 - 163s/epoch - 28ms/step
Epoch 11/50
5759/5759 - 160s - loss: 11.4050 - accuracy10: 0.5603 - accuracy20: 0.5449 - accuracy30: 0.5206 - accuracy50: 0.4822 - val_loss: 11.9573 - val_accuracy10: 0.5294 - val_accuracy20: 0.5161 - val_accuracy30: 0.4919 - val_accuracy50: 0.4539 - 160s/epoch - 28ms/step
Epoch 12/50
5759/5759 - 161s - loss: 11.3900 - accuracy10: 0.5611 - accuracy20: 0.5455 - accuracy30: 0.5216 - accuracy50: 0.4828 - val_loss: 11.9364 - val_accuracy10: 0.5324 - val_accuracy20: 0.5178 - val_accuracy30: 0.4934 - val_accuracy50: 0.4559 - 161s/epoch - 28ms/step
Epoch 13/50
5759/5759 - 160s - loss: 11.3751 - accuracy10: 0.5620 - accuracy20: 0.5465 - accuracy30: 0.5225 - accuracy50: 0.4839 - val_loss: 11.9442 - val_accuracy10: 0.5359 - val_accuracy20: 0.5178 - val_accuracy30: 0.4927 - val_accuracy50: 0.4548 - 160s/epoch - 28ms/step
Epoch 14/50
5759/5759 - 162s - loss: 11.3635 - accuracy10: 0.5627 - accuracy20: 0.5473 - accuracy30: 0.5233 - accuracy50: 0.4843 - val_loss: 11.9319 - val_accuracy10: 0.5350 - val_accuracy20: 0.5176 - val_accuracy30: 0.4936 - val_accuracy50: 0.4562 - 162s/epoch - 28ms/step
Epoch 15/50
5759/5759 - 160s - loss: 11.3532 - accuracy10: 0.5631 - accuracy20: 0.5482 - accuracy30: 0.5242 - accuracy50: 0.4849 - val_loss: 11.9059 - val_accuracy10: 0.5327 - val_accuracy20: 0.5195 - val_accuracy30: 0.4955 - val_accuracy50: 0.4582 - 160s/epoch - 28ms/step
Epoch 16/50
5759/5759 - 161s - loss: 11.3421 - accuracy10: 0.5640 - accuracy20: 0.5489 - accuracy30: 0.5250 - accuracy50: 0.4857 - val_loss: 11.9136 - val_accuracy10: 0.5349 - val_accuracy20: 0.5187 - val_accuracy30: 0.4938 - val_accuracy50: 0.4572 - 161s/epoch - 28ms/step
Epoch 17/50
5759/5759 - 166s - loss: 11.3327 - accuracy10: 0.5646 - accuracy20: 0.5495 - accuracy30: 0.5252 - accuracy50: 0.4860 - val_loss: 11.9160 - val_accuracy10: 0.5348 - val_accuracy20: 0.5195 - val_accuracy30: 0.4951 - val_accuracy50: 0.4579 - 166s/epoch - 29ms/step
Epoch 18/50
5759/5759 - 162s - loss: 11.3238 - accuracy10: 0.5652 - accuracy20: 0.5500 - accuracy30: 0.5258 - accuracy50: 0.4865 - val_loss: 11.8836 - val_accuracy10: 0.5312 - val_accuracy20: 0.5208 - val_accuracy30: 0.4967 - val_accuracy50: 0.4610 - 162s/epoch - 28ms/step
Epoch 19/50
5759/5759 - 168s - loss: 11.3129 - accuracy10: 0.5657 - accuracy20: 0.5507 - accuracy30: 0.5267 - accuracy50: 0.4876 - val_loss: 11.8947 - val_accuracy10: 0.5356 - val_accuracy20: 0.5204 - val_accuracy30: 0.4962 - val_accuracy50: 0.4596 - 168s/epoch - 29ms/step
Epoch 20/50
5759/5759 - 162s - loss: 11.3043 - accuracy10: 0.5661 - accuracy20: 0.5513 - accuracy30: 0.5269 - accuracy50: 0.4882 - val_loss: 11.9170 - val_accuracy10: 0.5348 - val_accuracy20: 0.5199 - val_accuracy30: 0.4959 - val_accuracy50: 0.4593 - 162s/epoch - 28ms/step
Epoch 21/50
5759/5759 - 161s - loss: 11.2963 - accuracy10: 0.5665 - accuracy20: 0.5518 - accuracy30: 0.5278 - accuracy50: 0.4887 - val_loss: 11.8889 - val_accuracy10: 0.5358 - val_accuracy20: 0.5205 - val_accuracy30: 0.4966 - val_accuracy50: 0.4599 - 161s/epoch - 28ms/step
Epoch 22/50
5759/5759 - 177s - loss: 11.2874 - accuracy10: 0.5673 - accuracy20: 0.5525 - accuracy30: 0.5285 - accuracy50: 0.4892 - val_loss: 11.8990 - val_accuracy10: 0.5342 - val_accuracy20: 0.5210 - val_accuracy30: 0.4973 - val_accuracy50: 0.4608 - 177s/epoch - 31ms/step
Epoch 23/50
5759/5759 - 160s - loss: 11.2807 - accuracy10: 0.5672 - accuracy20: 0.5530 - accuracy30: 0.5291 - accuracy50: 0.4898 - val_loss: 11.9233 - val_accuracy10: 0.5324 - val_accuracy20: 0.5193 - val_accuracy30: 0.4948 - val_accuracy50: 0.4590 - 160s/epoch - 28ms/step
Epoch 24/50
5759/5759 - 160s - loss: 11.2748 - accuracy10: 0.5679 - accuracy20: 0.5531 - accuracy30: 0.5292 - accuracy50: 0.4900 - val_loss: 11.9134 - val_accuracy10: 0.5358 - val_accuracy20: 0.5192 - val_accuracy30: 0.4948 - val_accuracy50: 0.4590 - 160s/epoch - 28ms/step
Epoch 25/50
5759/5759 - 161s - loss: 11.2668 - accuracy10: 0.5679 - accuracy20: 0.5538 - accuracy30: 0.5297 - accuracy50: 0.4906 - val_loss: 11.9132 - val_accuracy10: 0.5364 - val_accuracy20: 0.5206 - val_accuracy30: 0.4961 - val_accuracy50: 0.4596 - 161s/epoch - 28ms/step
Epoch 26/50
5759/5759 - 162s - loss: 11.2601 - accuracy10: 0.5685 - accuracy20: 0.5542 - accuracy30: 0.5302 - accuracy50: 0.4909 - val_loss: 11.9133 - val_accuracy10: 0.5346 - val_accuracy20: 0.5207 - val_accuracy30: 0.4959 - val_accuracy50: 0.4597 - 162s/epoch - 28ms/step
Epoch 27/50
5759/5759 - 161s - loss: 11.2535 - accuracy10: 0.5689 - accuracy20: 0.5547 - accuracy30: 0.5310 - accuracy50: 0.4916 - val_loss: 11.9119 - val_accuracy10: 0.5344 - val_accuracy20: 0.5208 - val_accuracy30: 0.4963 - val_accuracy50: 0.4602 - 161s/epoch - 28ms/step
Epoch 28/50
5759/5759 - 161s - loss: 11.2453 - accuracy10: 0.5689 - accuracy20: 0.5551 - accuracy30: 0.5312 - accuracy50: 0.4920 - val_loss: 11.8983 - val_accuracy10: 0.5342 - val_accuracy20: 0.5204 - val_accuracy30: 0.4957 - val_accuracy50: 0.4601 - 161s/epoch - 28ms/step
testing model: results/AAPL/W5/deepOF_L2/seq2seq
Evaluating performance on  test set...
31315/31315 - 287s - 287s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98756635
{'0': {'precision': 0.49889864589190397, 'recall': 0.5852955826368289, 'f1-score': 0.5386547279822351, 'support': 2828769}, '1': {'precision': 0.5730876402031919, 'recall': 0.2519216278613675, 'f1-score': 0.3499916347992352, 'support': 2325112}, '2': {'precision': 0.5018947148487479, 'recall': 0.6444630755257458, 'f1-score': 0.564313540218321, 'support': 2862600}, 'accuracy': 0.5097313896209571, 'macro avg': {'precision': 0.5246270003146146, 'recall': 0.4938934286746474, 'f1-score': 0.4843199676665971, 'support': 8016481}, 'weighted avg': {'precision': 0.5214863957957544, 'recall': 0.5097313896209571, 'f1-score': 0.49309709415139436, 'support': 8016481}}
[[1655666  229831  943272]
 [ 851727  585746  887639]
 [ 811249  206511 1844840]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9865289
{'0': {'precision': 0.5265211851167416, 'recall': 0.5150579485290087, 'f1-score': 0.5207264867414768, 'support': 3137612}, '1': {'precision': 0.4296778974019061, 'recall': 0.27757677835002564, 'f1-score': 0.33727201976354887, 'support': 1683808}, '2': {'precision': 0.5212429532823706, 'recall': 0.6296267895980703, 'f1-score': 0.5703313156089986, 'support': 3195061}, 'accuracy': 0.5108393570695171, 'macro avg': {'precision': 0.49248067860033945, 'recall': 0.4740871721590349, 'f1-score': 0.47610994070467477, 'support': 8016481}, 'weighted avg': {'precision': 0.5040762026757555, 'recall': 0.5108393570695171, 'f1-score': 0.501963684832899, 'support': 8016481}}
[[1616052  326933 1194627]
 [ 563324  467386  653098]
 [ 889925  293440 2011696]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0174651
{'0': {'precision': 0.5125222070730296, 'recall': 0.46980748435097863, 'f1-score': 0.4902361618123163, 'support': 3105306}, '1': {'precision': 0.3725687899475906, 'recall': 0.25997749467693654, 'f1-score': 0.3062526899921235, 'support': 1731146}, '2': {'precision': 0.5008481850908723, 'recall': 0.6240053156747941, 'f1-score': 0.5556846818364221, 'support': 3180029}, 'accuracy': 0.48566322305260873, 'macro avg': {'precision': 0.46197972737049753, 'recall': 0.4512634315675698, 'f1-score': 0.4507245112136206, 'support': 8016481}, 'weighted avg': {'precision': 0.4776685690873682, 'recall': 0.48566322305260873, 'f1-score': 0.47646776896963355, 'support': 8016481}}
[[1458896  395183 1251227]
 [ 554680  450059  726407]
 [ 832927  362747 1984355]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.051503
{'0': {'precision': 0.49267745350401554, 'recall': 0.4084825386293499, 'f1-score': 0.4466468522561311, 'support': 3062503}, '1': {'precision': 0.3130595291687245, 'recall': 0.2382018660633424, 'f1-score': 0.2705481090527259, 'support': 1804226}, '2': {'precision': 0.472883990887144, 'recall': 0.6162285157688605, 'f1-score': 0.5351230438625015, 'support': 3149752}, 'accuracy': 0.4517837689629652, 'macro avg': {'precision': 0.426206991186628, 'recall': 0.42097097348718426, 'f1-score': 0.41743933505711955, 'support': 8016481}, 'weighted avg': {'precision': 0.444474778587655, 'recall': 0.4517837689629652, 'f1-score': 0.4417764022930665, 'support': 8016481}}
[[1250979  483769 1327755]
 [ 538647  429770  835809]
 [ 749518  459267 1940967]]
Evaluating performance on  train set...
5759/5759 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9268804
{'0': {'precision': 0.49222132468276253, 'recall': 0.5551102349300608, 'f1-score': 0.5217776408518504, 'support': 414932}, '1': {'precision': 0.665712156278194, 'recall': 0.5025286252850061, 'f1-score': 0.572723397452976, 'support': 641653}, '2': {'precision': 0.4742228728887935, 'recall': 0.5926372052702916, 'f1-score': 0.5268584396728277, 'support': 417586}, 'accuracy': 0.5428535766881861, 'macro avg': {'precision': 0.5440521179499167, 'recall': 0.550092021828453, 'f1-score': 0.5404531593258847, 'support': 1474171}, 'weighted avg': {'precision': 0.5626371794749591, 'recall': 0.5428535766881861, 'f1-score': 0.5453917046319944, 'support': 1474171}}
[[230333  83966 100633]
 [145456 322449 173748]
 [ 92157  77952 247477]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9547015
{'0': {'precision': 0.5381423765788341, 'recall': 0.4696182692465495, 'f1-score': 0.5015506262207552, 'support': 487464}, '1': {'precision': 0.5365137106593786, 'recall': 0.5687622019507036, 'f1-score': 0.5521675012907312, 'support': 497359}, '2': {'precision': 0.5118901527062992, 'recall': 0.5455483623106664, 'f1-score': 0.5281835880309278, 'support': 489348}, 'accuracy': 0.5282725002730349, 'macro avg': {'precision': 0.5288487466481707, 'recall': 0.5279762778359731, 'f1-score': 0.5273005718474714, 'support': 1474171}, 'weighted avg': {'precision': 0.5288785225886175, 'recall': 0.5282725002730349, 'f1-score': 0.5274686133225314, 'support': 1474171}}
[[228922 126924 131618]
 [ 91537 282879 122943]
 [104934 117451 266963]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9858183
{'0': {'precision': 0.5302816172283481, 'recall': 0.41406414215725906, 'f1-score': 0.4650216316580337, 'support': 494776}, '1': {'precision': 0.49026113725010056, 'recall': 0.5778985955449994, 'f1-score': 0.5304847467442877, 'support': 485028}, '2': {'precision': 0.495943623438048, 'recall': 0.5177469369921536, 'f1-score': 0.5066107981648107, 'support': 494367}, 'accuracy': 0.5027388274494614, 'macro avg': {'precision': 0.5054954593054989, 'recall': 0.5032365582314707, 'f1-score': 0.5007057255223774, 'support': 1474171}, 'weighted avg': {'precision': 0.5055988468177114, 'recall': 0.5027388274494614, 'f1-score': 0.5005071725230428, 'support': 1474171}}
[[204869 151360 138547]
 [ 83134 280297 121597]
 [ 98337 140073 255957]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0298148
{'0': {'precision': 0.5056457304163726, 'recall': 0.35396500895661465, 'f1-score': 0.41642312571910534, 'support': 497956}, '1': {'precision': 0.43287171806138175, 'recall': 0.5457292463917224, 'f1-score': 0.4827928135426408, 'support': 478206}, '2': {'precision': 0.4669316977421342, 'recall': 0.49008752853864085, 'f1-score': 0.47822947639644764, 'support': 498009}, 'accuracy': 0.46215669688251904, 'macro avg': {'precision': 0.4684830487399629, 'recall': 0.46326059462899266, 'f1-score': 0.4591484718860646, 'support': 1474171}, 'weighted avg': {'precision': 0.4689600907922751, 'recall': 0.46215669688251904, 'f1-score': 0.45883238613042404, 'support': 1474171}}
[[176259 176095 145602]
 [ 84199 260971 133036]
 [ 88124 165817 244068]]
Evaluating performance on  val set...
2129/2129 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94782484
{'0': {'precision': 0.49434585056745245, 'recall': 0.572038219188579, 'f1-score': 0.5303618612505431, 'support': 169653}, '1': {'precision': 0.643847185990914, 'recall': 0.45673906216026866, 'f1-score': 0.5343882142776383, 'support': 206965}, '2': {'precision': 0.486130106439912, 'recall': 0.5828328016112072, 'f1-score': 0.5301073961499494, 'support': 168321}, 'accuracy': 0.5315824339971997, 'macro avg': {'precision': 0.5414410476660928, 'recall': 0.537203360986685, 'f1-score': 0.5316191572260436, 'support': 544939}, 'weighted avg': {'precision': 0.5485879980713474, 'recall': 0.5315824339971997, 'f1-score': 0.5318124499110275, 'support': 544939}}
[[97048 27021 45584]
 [54319 94529 58117]
 [44949 25269 98103]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9667074
{'0': {'precision': 0.5274998182153784, 'recall': 0.49006443566826025, 'f1-score': 0.5080935179124138, 'support': 192440}, '1': {'precision': 0.5216200179272558, 'recall': 0.5160593286494926, 'f1-score': 0.5188247740493434, 'support': 160125}, '2': {'precision': 0.5143498060056417, 'recall': 0.5554284882572489, 'f1-score': 0.5341004518734754, 'support': 192374}, 'accuracy': 0.5207775549189909, 'macro avg': {'precision': 0.5211565473827586, 'recall': 0.5205174175250006, 'f1-score': 0.520339581278411, 'support': 544939}, 'weighted avg': {'precision': 0.5211298878746036, 'recall': 0.5207775549189909, 'f1-score': 0.5204277430325669, 'support': 544939}}
[[ 94308  39651  58481]
 [ 35084  82634  42407]
 [ 49391  36133 106850]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9975213
{'0': {'precision': 0.5151247190597251, 'recall': 0.43859208833955515, 'f1-score': 0.4737876580026432, 'support': 191262}, '1': {'precision': 0.48251858237994266, 'recall': 0.513632502216793, 'f1-score': 0.4975896340749151, 'support': 161269}, '2': {'precision': 0.49522157538315315, 'recall': 0.5415939046193505, 'f1-score': 0.5173707218624094, 'support': 192408}, 'accuracy': 0.49716757288430447, 'macro avg': {'precision': 0.497621625607607, 'recall': 0.4979394983918996, 'f1-score': 0.4962493379799892, 'support': 544939}, 'weighted avg': {'precision': 0.4984478375652209, 'recall': 0.49716757288430447, 'f1-score': 0.49621998718137533, 'support': 544939}}
[[ 83886  46359  61017]
 [ 33235  82833  45201]
 [ 45725  42476 104207]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0374992
{'0': {'precision': 0.4866628325733613, 'recall': 0.37748604627697147, 'f1-score': 0.42517772813054233, 'support': 188301}, '1': {'precision': 0.43489472843186416, 'recall': 0.4771220099020076, 'f1-score': 0.4550307866153172, 'support': 165421}, '2': {'precision': 0.4633437290131464, 'recall': 0.526783706469613, 'f1-score': 0.49303133756714757, 'support': 191217}, 'accuracy': 0.46011938950965153, 'macro avg': {'precision': 0.4616337633394573, 'recall': 0.46046392088286403, 'f1-score': 0.45774661743766903, 'support': 544939}, 'weighted avg': {'precision': 0.4627655879631128, 'recall': 0.46011938950965153, 'f1-score': 0.45804945583446743, 'support': 544939}}
[[ 71081  52747  64473]
 [ 34300  78926  52195]
 [ 40677  49810 100730]]
training model: results/AAPL/W5/deepVOL_L2/seq2seq
Epoch 1/50
5759/5759 - 172s - loss: 12.1162 - accuracy10: 0.4934 - accuracy20: 0.4899 - accuracy30: 0.4740 - accuracy50: 0.4438 - val_loss: 12.4255 - val_accuracy10: 0.5093 - val_accuracy20: 0.4969 - val_accuracy30: 0.4767 - val_accuracy50: 0.4407 - 172s/epoch - 30ms/step
Epoch 2/50
5759/5759 - 159s - loss: 11.8107 - accuracy10: 0.5263 - accuracy20: 0.5178 - accuracy30: 0.4972 - accuracy50: 0.4601 - val_loss: 12.4057 - val_accuracy10: 0.5119 - val_accuracy20: 0.4943 - val_accuracy30: 0.4709 - val_accuracy50: 0.4347 - 159s/epoch - 28ms/step
Epoch 3/50
5759/5759 - 158s - loss: 11.6963 - accuracy10: 0.5367 - accuracy20: 0.5267 - accuracy30: 0.5043 - accuracy50: 0.4658 - val_loss: 12.2564 - val_accuracy10: 0.5238 - val_accuracy20: 0.5061 - val_accuracy30: 0.4820 - val_accuracy50: 0.4434 - 158s/epoch - 27ms/step
Epoch 4/50
5759/5759 - 157s - loss: 11.6385 - accuracy10: 0.5421 - accuracy20: 0.5308 - accuracy30: 0.5079 - accuracy50: 0.4689 - val_loss: 12.3177 - val_accuracy10: 0.5232 - val_accuracy20: 0.5038 - val_accuracy30: 0.4788 - val_accuracy50: 0.4407 - 157s/epoch - 27ms/step
Epoch 5/50
5759/5759 - 159s - loss: 11.6001 - accuracy10: 0.5450 - accuracy20: 0.5339 - accuracy30: 0.5104 - accuracy50: 0.4710 - val_loss: 12.1720 - val_accuracy10: 0.5279 - val_accuracy20: 0.5112 - val_accuracy30: 0.4852 - val_accuracy50: 0.4463 - 159s/epoch - 28ms/step
Epoch 6/50
5759/5759 - 157s - loss: 11.5658 - accuracy10: 0.5475 - accuracy20: 0.5357 - accuracy30: 0.5124 - accuracy50: 0.4729 - val_loss: 12.1702 - val_accuracy10: 0.5323 - val_accuracy20: 0.5130 - val_accuracy30: 0.4868 - val_accuracy50: 0.4473 - 157s/epoch - 27ms/step
Epoch 7/50
5759/5759 - 158s - loss: 11.5395 - accuracy10: 0.5495 - accuracy20: 0.5374 - accuracy30: 0.5138 - accuracy50: 0.4743 - val_loss: 12.1767 - val_accuracy10: 0.5334 - val_accuracy20: 0.5138 - val_accuracy30: 0.4865 - val_accuracy50: 0.4449 - 158s/epoch - 28ms/step
Epoch 8/50
5759/5759 - 158s - loss: 11.5247 - accuracy10: 0.5503 - accuracy20: 0.5382 - accuracy30: 0.5146 - accuracy50: 0.4751 - val_loss: 12.1332 - val_accuracy10: 0.5352 - val_accuracy20: 0.5167 - val_accuracy30: 0.4891 - val_accuracy50: 0.4483 - 158s/epoch - 27ms/step
Epoch 9/50
5759/5759 - 157s - loss: 11.5067 - accuracy10: 0.5514 - accuracy20: 0.5396 - accuracy30: 0.5158 - accuracy50: 0.4760 - val_loss: 12.1216 - val_accuracy10: 0.5335 - val_accuracy20: 0.5168 - val_accuracy30: 0.4901 - val_accuracy50: 0.4490 - 157s/epoch - 27ms/step
Epoch 10/50
5759/5759 - 155s - loss: 11.4895 - accuracy10: 0.5524 - accuracy20: 0.5406 - accuracy30: 0.5169 - accuracy50: 0.4770 - val_loss: 12.1233 - val_accuracy10: 0.5339 - val_accuracy20: 0.5166 - val_accuracy30: 0.4901 - val_accuracy50: 0.4498 - 155s/epoch - 27ms/step
Epoch 11/50
5759/5759 - 156s - loss: 11.4743 - accuracy10: 0.5534 - accuracy20: 0.5413 - accuracy30: 0.5177 - accuracy50: 0.4779 - val_loss: 12.0533 - val_accuracy10: 0.5367 - val_accuracy20: 0.5203 - val_accuracy30: 0.4926 - val_accuracy50: 0.4520 - 156s/epoch - 27ms/step
Epoch 12/50
5759/5759 - 158s - loss: 11.4620 - accuracy10: 0.5542 - accuracy20: 0.5422 - accuracy30: 0.5183 - accuracy50: 0.4783 - val_loss: 12.0721 - val_accuracy10: 0.5358 - val_accuracy20: 0.5192 - val_accuracy30: 0.4926 - val_accuracy50: 0.4519 - 158s/epoch - 27ms/step
Epoch 13/50
5759/5759 - 155s - loss: 11.4508 - accuracy10: 0.5551 - accuracy20: 0.5429 - accuracy30: 0.5189 - accuracy50: 0.4791 - val_loss: 12.0569 - val_accuracy10: 0.5371 - val_accuracy20: 0.5198 - val_accuracy30: 0.4927 - val_accuracy50: 0.4512 - 155s/epoch - 27ms/step
Epoch 14/50
5759/5759 - 155s - loss: 11.4390 - accuracy10: 0.5560 - accuracy20: 0.5438 - accuracy30: 0.5196 - accuracy50: 0.4795 - val_loss: 12.0751 - val_accuracy10: 0.5364 - val_accuracy20: 0.5204 - val_accuracy30: 0.4928 - val_accuracy50: 0.4512 - 155s/epoch - 27ms/step
Epoch 15/50
5759/5759 - 156s - loss: 11.4287 - accuracy10: 0.5567 - accuracy20: 0.5445 - accuracy30: 0.5207 - accuracy50: 0.4803 - val_loss: 12.0390 - val_accuracy10: 0.5382 - val_accuracy20: 0.5217 - val_accuracy30: 0.4940 - val_accuracy50: 0.4522 - 156s/epoch - 27ms/step
Epoch 16/50
5759/5759 - 155s - loss: 11.4203 - accuracy10: 0.5573 - accuracy20: 0.5451 - accuracy30: 0.5215 - accuracy50: 0.4810 - val_loss: 12.0509 - val_accuracy10: 0.5372 - val_accuracy20: 0.5208 - val_accuracy30: 0.4935 - val_accuracy50: 0.4517 - 155s/epoch - 27ms/step
Epoch 17/50
5759/5759 - 156s - loss: 11.4089 - accuracy10: 0.5578 - accuracy20: 0.5458 - accuracy30: 0.5217 - accuracy50: 0.4816 - val_loss: 12.0481 - val_accuracy10: 0.5362 - val_accuracy20: 0.5208 - val_accuracy30: 0.4938 - val_accuracy50: 0.4516 - 156s/epoch - 27ms/step
Epoch 18/50
5759/5759 - 157s - loss: 11.4025 - accuracy10: 0.5586 - accuracy20: 0.5466 - accuracy30: 0.5222 - accuracy50: 0.4818 - val_loss: 12.0705 - val_accuracy10: 0.5377 - val_accuracy20: 0.5210 - val_accuracy30: 0.4931 - val_accuracy50: 0.4515 - 157s/epoch - 27ms/step
Epoch 19/50
5759/5759 - 156s - loss: 11.3928 - accuracy10: 0.5589 - accuracy20: 0.5467 - accuracy30: 0.5225 - accuracy50: 0.4822 - val_loss: 12.0695 - val_accuracy10: 0.5354 - val_accuracy20: 0.5207 - val_accuracy30: 0.4928 - val_accuracy50: 0.4500 - 156s/epoch - 27ms/step
Epoch 20/50
5759/5759 - 155s - loss: 11.3853 - accuracy10: 0.5597 - accuracy20: 0.5477 - accuracy30: 0.5233 - accuracy50: 0.4830 - val_loss: 12.0843 - val_accuracy10: 0.5348 - val_accuracy20: 0.5199 - val_accuracy30: 0.4914 - val_accuracy50: 0.4492 - 155s/epoch - 27ms/step
Epoch 21/50
5759/5759 - 155s - loss: 11.3779 - accuracy10: 0.5601 - accuracy20: 0.5478 - accuracy30: 0.5236 - accuracy50: 0.4833 - val_loss: 12.0655 - val_accuracy10: 0.5348 - val_accuracy20: 0.5204 - val_accuracy30: 0.4925 - val_accuracy50: 0.4503 - 155s/epoch - 27ms/step
Epoch 22/50
5759/5759 - 155s - loss: 11.3704 - accuracy10: 0.5609 - accuracy20: 0.5483 - accuracy30: 0.5238 - accuracy50: 0.4836 - val_loss: 12.0601 - val_accuracy10: 0.5354 - val_accuracy20: 0.5209 - val_accuracy30: 0.4928 - val_accuracy50: 0.4498 - 155s/epoch - 27ms/step
Epoch 23/50
5759/5759 - 157s - loss: 11.3636 - accuracy10: 0.5610 - accuracy20: 0.5486 - accuracy30: 0.5244 - accuracy50: 0.4841 - val_loss: 12.0370 - val_accuracy10: 0.5375 - val_accuracy20: 0.5220 - val_accuracy30: 0.4932 - val_accuracy50: 0.4509 - 157s/epoch - 27ms/step
Epoch 24/50
5759/5759 - 155s - loss: 11.3564 - accuracy10: 0.5616 - accuracy20: 0.5492 - accuracy30: 0.5248 - accuracy50: 0.4847 - val_loss: 12.0567 - val_accuracy10: 0.5369 - val_accuracy20: 0.5220 - val_accuracy30: 0.4944 - val_accuracy50: 0.4516 - 155s/epoch - 27ms/step
Epoch 25/50
5759/5759 - 157s - loss: 11.3488 - accuracy10: 0.5622 - accuracy20: 0.5496 - accuracy30: 0.5253 - accuracy50: 0.4853 - val_loss: 12.0694 - val_accuracy10: 0.5374 - val_accuracy20: 0.5207 - val_accuracy30: 0.4924 - val_accuracy50: 0.4502 - 157s/epoch - 27ms/step
Epoch 26/50
5759/5759 - 156s - loss: 11.3422 - accuracy10: 0.5628 - accuracy20: 0.5501 - accuracy30: 0.5258 - accuracy50: 0.4856 - val_loss: 12.0682 - val_accuracy10: 0.5371 - val_accuracy20: 0.5211 - val_accuracy30: 0.4932 - val_accuracy50: 0.4511 - 156s/epoch - 27ms/step
Epoch 27/50
5759/5759 - 155s - loss: 11.3361 - accuracy10: 0.5632 - accuracy20: 0.5509 - accuracy30: 0.5263 - accuracy50: 0.4859 - val_loss: 12.0516 - val_accuracy10: 0.5371 - val_accuracy20: 0.5228 - val_accuracy30: 0.4944 - val_accuracy50: 0.4519 - 155s/epoch - 27ms/step
Epoch 28/50
5759/5759 - 156s - loss: 11.3334 - accuracy10: 0.5631 - accuracy20: 0.5505 - accuracy30: 0.5263 - accuracy50: 0.4862 - val_loss: 12.0693 - val_accuracy10: 0.5360 - val_accuracy20: 0.5204 - val_accuracy30: 0.4927 - val_accuracy50: 0.4507 - 156s/epoch - 27ms/step
Epoch 29/50
5759/5759 - 154s - loss: 11.3245 - accuracy10: 0.5638 - accuracy20: 0.5516 - accuracy30: 0.5274 - accuracy50: 0.4867 - val_loss: 12.1050 - val_accuracy10: 0.5352 - val_accuracy20: 0.5197 - val_accuracy30: 0.4917 - val_accuracy50: 0.4495 - 154s/epoch - 27ms/step
Epoch 30/50
5759/5759 - 154s - loss: 11.3183 - accuracy10: 0.5640 - accuracy20: 0.5515 - accuracy30: 0.5271 - accuracy50: 0.4871 - val_loss: 12.1272 - val_accuracy10: 0.5363 - val_accuracy20: 0.5185 - val_accuracy30: 0.4905 - val_accuracy50: 0.4482 - 154s/epoch - 27ms/step
Epoch 31/50
5759/5759 - 155s - loss: 11.3120 - accuracy10: 0.5644 - accuracy20: 0.5521 - accuracy30: 0.5279 - accuracy50: 0.4876 - val_loss: 12.0926 - val_accuracy10: 0.5355 - val_accuracy20: 0.5197 - val_accuracy30: 0.4911 - val_accuracy50: 0.4491 - 155s/epoch - 27ms/step
Epoch 32/50
5759/5759 - 156s - loss: 11.3066 - accuracy10: 0.5648 - accuracy20: 0.5522 - accuracy30: 0.5282 - accuracy50: 0.4878 - val_loss: 12.1163 - val_accuracy10: 0.5345 - val_accuracy20: 0.5182 - val_accuracy30: 0.4902 - val_accuracy50: 0.4480 - 156s/epoch - 27ms/step
Epoch 33/50
5759/5759 - 156s - loss: 11.3011 - accuracy10: 0.5650 - accuracy20: 0.5525 - accuracy30: 0.5286 - accuracy50: 0.4881 - val_loss: 12.0992 - val_accuracy10: 0.5350 - val_accuracy20: 0.5195 - val_accuracy30: 0.4916 - val_accuracy50: 0.4488 - 156s/epoch - 27ms/step
testing model: results/AAPL/W5/deepVOL_L2/seq2seq
Evaluating performance on  test set...
31315/31315 - 292s - 292s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0131114
{'0': {'precision': 0.48082240402991616, 'recall': 0.6728310633840633, 'f1-score': 0.5608482244282813, 'support': 2828771}, '1': {'precision': 0.5462834025537414, 'recall': 0.2508893116162526, 'f1-score': 0.3438568941908506, 'support': 2325113}, '2': {'precision': 0.5198274657001464, 'recall': 0.5430066771419848, 'f1-score': 0.5311643152188473, 'support': 2862602}, 'accuracy': 0.5040915683006245, 'macro avg': {'precision': 0.5156444240946013, 'recall': 0.4889090173807669, 'f1-score': 0.4786231446126597, 'support': 8016486}, 'weighted avg': {'precision': 0.5137370983496032, 'recall': 0.5040915683006245, 'f1-score': 0.48731194173620307, 'support': 8016486}}
[[1903285  255120  670366]
 [ 976299  583346  765468]
 [1078811  229379 1554412]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0102289
{'0': {'precision': 0.5097029052623364, 'recall': 0.5994922895256429, 'f1-score': 0.5509633707203316, 'support': 3137615}, '1': {'precision': 0.39004857344243204, 'recall': 0.30235454398601264, 'f1-score': 0.3406482599141934, 'support': 1683808}, '2': {'precision': 0.5462629116808588, 'recall': 0.5164874683222209, 'f1-score': 0.5309580755766075, 'support': 3195063}, 'accuracy': 0.5039980110986285, 'macro avg': {'precision': 0.4820047967952091, 'recall': 0.47277810061129216, 'f1-score': 0.4741899020703775, 'support': 8016486}, 'weighted avg': {'precision': 0.49914174450369153, 'recall': 0.5039980110986285, 'f1-score': 0.4988147803761266, 'support': 8016486}}
[[1880976  416828  839811]
 [ 643814  509107  530887]
 [1165548  379305 1650210]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.037541
{'0': {'precision': 0.4987724276835666, 'recall': 0.5255307843661341, 'f1-score': 0.511802095428804, 'support': 3105310}, '1': {'precision': 0.32559629863072165, 'recall': 0.3031766240397979, 'f1-score': 0.31398676075128096, 'support': 1731146}, '2': {'precision': 0.5220470804628816, 'recall': 0.5142668465391836, 'f1-score': 0.5181277580458467, 'support': 3180030}, 'accuracy': 0.47304554639027624, 'macro avg': {'precision': 0.4488052689257233, 'recall': 0.4476580849817052, 'f1-score': 0.4479722047419772, 'support': 8016486}, 'weighted avg': {'precision': 0.47060808372693635, 'recall': 0.47304554639027624, 'f1-score': 0.47159352667766025, 'support': 8016486}}
[[1631936  560492  912882]
 [ 621932  524843  584371]
 [1018037  526609 1635384]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0701399
{'0': {'precision': 0.4795364105595373, 'recall': 0.4450353909395146, 'f1-score': 0.4616421863549861, 'support': 3062507}, '1': {'precision': 0.27924213329932607, 'recall': 0.2961264276204866, 'f1-score': 0.2874365441269827, 'support': 1804226}, '2': {'precision': 0.48692394168901665, 'recall': 0.5041214342838947, 'f1-score': 0.4953734749641656, 'support': 3149753}, 'accuracy': 0.43473674126044753, 'macro avg': {'precision': 0.41523416184929335, 'recall': 0.4150944176146319, 'f1-score': 0.41481740181537813, 'support': 8016486}, 'weighted avg': {'precision': 0.4373599202187058, 'recall': 0.43473674126044753, 'f1-score': 0.43568803118477406, 'support': 8016486}}
[[1362924  697018 1002565]
 [ 599372  534279  670575]
 [ 879874  682021 1587858]]
Evaluating performance on  train set...
5759/5759 - 56s - 56s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9446919
{'0': {'precision': 0.47303514688981196, 'recall': 0.6069320290099511, 'f1-score': 0.5316831620473268, 'support': 415030}, '1': {'precision': 0.6652823868163027, 'recall': 0.49571834567347245, 'f1-score': 0.5681179605994455, 'support': 641808}, '2': {'precision': 0.4856043000450978, 'recall': 0.5392491385796508, 'f1-score': 0.5110227289499767, 'support': 417334}, 'accuracy': 0.5393522601161873, 'macro avg': {'precision': 0.5413072779170708, 'recall': 0.5472998377543581, 'f1-score': 0.536941283865583, 'support': 1474172}, 'weighted avg': {'precision': 0.5602918248932263, 'recall': 0.5393522601161873, 'f1-score': 0.5416968131022164, 'support': 1474172}}
[[251895  82755  80380]
 [165642 318156 158010]
 [114971  77316 225047]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9683469
{'0': {'precision': 0.5185383993664737, 'recall': 0.5210748793509048, 'f1-score': 0.5198035450683204, 'support': 487571}, '1': {'precision': 0.5276645606472122, 'recall': 0.5866336434619683, 'f1-score': 0.5555887689609937, 'support': 497428}, '2': {'precision': 0.5332631412947184, 'recall': 0.4700627385403528, 'f1-score': 0.4996724147110241, 'support': 489173}, 'accuracy': 0.5262689835378775, 'macro avg': {'precision': 0.5264887004361348, 'recall': 0.5259237537844087, 'f1-score': 0.5250215762467794, 'support': 1474172}, 'weighted avg': {'precision': 0.5265039246490191, 'recall': 0.5262689835378775, 'f1-score': 0.5251984154906423, 'support': 1474172}}
[[254061 134691  98819]
 [103183 291808 102437]
 [132712 126519 229942]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9972449
{'0': {'precision': 0.5119986524590315, 'recall': 0.44820669650792627, 'f1-score': 0.47798364148264955, 'support': 495064}, '1': {'precision': 0.47567798255367144, 'recall': 0.6112552006234563, 'f1-score': 0.5350110662885571, 'support': 485038}, '2': {'precision': 0.516776964218564, 'recall': 0.4366952051328759, 'f1-score': 0.47337306667456513, 'support': 494070}, 'accuracy': 0.4979954849230619, 'macro avg': {'precision': 0.5014845330770891, 'recall': 0.4987190340880861, 'f1-score': 0.4954559248152573, 'support': 1474172}, 'weighted avg': {'precision': 0.5016497348303397, 'recall': 0.4979954849230619, 'f1-score': 0.49520179606541026, 'support': 1474172}}
[[221891 168232 104941]
 [ 91748 296482  96808]
 [119743 158569 215758]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0426807
{'0': {'precision': 0.4855104931118836, 'recall': 0.37874505597370955, 'f1-score': 0.42553316338909, 'support': 497823}, '1': {'precision': 0.4171780054807578, 'recall': 0.5854848418975637, 'f1-score': 0.487205443426353, 'support': 478424}, '2': {'precision': 0.4815725586536095, 'recall': 0.40077320881658884, 'f1-score': 0.4374733505278377, 'support': 497925}, 'accuracy': 0.45328021424908355, 'macro avg': {'precision': 0.46142035241541696, 'recall': 0.45500103556262067, 'f1-score': 0.45007065244776023, 'support': 1474172}, 'weighted avg': {'precision': 0.462003942941639, 'recall': 0.45328021424908355, 'f1-score': 0.44958111477170243, 'support': 1474172}}
[[188548 198832 110443]
 [ 93930 280110 104384]
 [105872 192498 199555]]
Evaluating performance on  val set...
2129/2129 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95649046
{'0': {'precision': 0.48314275877065815, 'recall': 0.6284998674013613, 'f1-score': 0.5463179490857306, 'support': 169685}, '1': {'precision': 0.6419111260453055, 'recall': 0.48909005714616954, 'f1-score': 0.5551759874102791, 'support': 207013}, '2': {'precision': 0.5108334584772488, 'recall': 0.5054683135007906, 'f1-score': 0.5081367244567799, 'support': 168242}, 'accuracy': 0.5375564282306309, 'macro avg': {'precision': 0.5452957810977375, 'recall': 0.5410194126827738, 'f1-score': 0.5365435536509299, 'support': 544940}, 'weighted avg': {'precision': 0.5520051192409169, 'recall': 0.5375564282306309, 'f1-score': 0.5378950832539984, 'support': 544940}}
[[106647  29403  33635]
 [ 57966 101248  47799]
 [ 56123  27078  85041]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9788744
{'0': {'precision': 0.5167221587238483, 'recall': 0.5400604568543738, 'f1-score': 0.5281336028687234, 'support': 192534}, '1': {'precision': 0.5054799142368934, 'recall': 0.5806153192234126, 'f1-score': 0.5404487060137777, 'support': 159982}, '2': {'precision': 0.5453772476054718, 'recall': 0.45333222467051926, 'f1-score': 0.49511311909005257, 'support': 192424}, 'accuracy': 0.5213417990971483, 'macro avg': {'precision': 0.5225264401887378, 'recall': 0.5246693335827685, 'f1-score': 0.5212318093241846, 'support': 544940}, 'weighted avg': {'precision': 0.5235401021037535, 'recall': 0.5213417990971483, 'f1-score': 0.5200891599222066, 'support': 544940}}
[[103980  47295  41259]
 [ 35637  92888  31457]
 [ 61613  43579  87232]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0103065
{'0': {'precision': 0.505681430423804, 'recall': 0.4645684101631687, 'f1-score': 0.48425386607412735, 'support': 191397}, '1': {'precision': 0.4597809344514804, 'recall': 0.600189898162456, 'f1-score': 0.5206857844285265, 'support': 161139}, '2': {'precision': 0.5246604852729976, 'recall': 0.4329068002744226, 'f1-score': 0.4743877434787561, 'support': 192404}, 'accuracy': 0.49349286159944217, 'macro avg': {'precision': 0.496707616716094, 'recall': 0.4992217028666824, 'f1-score': 0.4931091313271366, 'support': 544940}, 'weighted avg': {'precision': 0.49880963912333054, 'recall': 0.49349286159944217, 'f1-score': 0.4915433317765345, 'support': 544940}}
[[88917 58675 43805]
 [32767 96714 31658]
 [54152 54959 83293]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0538023
{'0': {'precision': 0.4733368051035021, 'recall': 0.38623217273524024, 'f1-score': 0.4253711043187037, 'support': 188265}, '1': {'precision': 0.4107475968093072, 'recall': 0.5737033006891549, 'f1-score': 0.4787384574252082, 'support': 165420}, '2': {'precision': 0.4867382528560643, 'recall': 0.4078899898041881, 'f1-score': 0.4438394665574293, 'support': 191255}, 'accuracy': 0.45074136602194737, 'macro avg': {'precision': 0.4569408849229579, 'recall': 0.45594182107619446, 'f1-score': 0.4493163427671137, 'support': 544940}, 'weighted avg': {'precision': 0.4590408955609664, 'recall': 0.45074136602194737, 'f1-score': 0.44805285675171547, 'support': 544940}}
[[72714 68982 46569]
 [34825 94902 35693]
 [46081 67163 78011]]
training model: results/AAPL/W5/deepVOL_L3/seq2seq
Epoch 1/50
5759/5759 - 246s - loss: 12.2077 - accuracy10: 0.4780 - accuracy20: 0.4723 - accuracy30: 0.4595 - accuracy50: 0.4363 - val_loss: 12.3087 - val_accuracy10: 0.5070 - val_accuracy20: 0.4998 - val_accuracy30: 0.4792 - val_accuracy50: 0.4441 - 246s/epoch - 43ms/step
Epoch 2/50
5759/5759 - 236s - loss: 11.7963 - accuracy10: 0.5246 - accuracy20: 0.5182 - accuracy30: 0.4978 - accuracy50: 0.4621 - val_loss: 12.3607 - val_accuracy10: 0.5194 - val_accuracy20: 0.4901 - val_accuracy30: 0.4667 - val_accuracy50: 0.4301 - 236s/epoch - 41ms/step
Epoch 3/50
5759/5759 - 234s - loss: 11.6693 - accuracy10: 0.5366 - accuracy20: 0.5280 - accuracy30: 0.5061 - accuracy50: 0.4674 - val_loss: 12.1604 - val_accuracy10: 0.5307 - val_accuracy20: 0.5106 - val_accuracy30: 0.4852 - val_accuracy50: 0.4455 - 234s/epoch - 41ms/step
Epoch 4/50
5759/5759 - 236s - loss: 11.6044 - accuracy10: 0.5426 - accuracy20: 0.5327 - accuracy30: 0.5099 - accuracy50: 0.4707 - val_loss: 12.1123 - val_accuracy10: 0.5335 - val_accuracy20: 0.5125 - val_accuracy30: 0.4855 - val_accuracy50: 0.4451 - 236s/epoch - 41ms/step
Epoch 5/50
5759/5759 - 234s - loss: 11.5605 - accuracy10: 0.5468 - accuracy20: 0.5359 - accuracy30: 0.5127 - accuracy50: 0.4729 - val_loss: 12.1005 - val_accuracy10: 0.5345 - val_accuracy20: 0.5140 - val_accuracy30: 0.4856 - val_accuracy50: 0.4441 - 234s/epoch - 41ms/step
Epoch 6/50
5759/5759 - 233s - loss: 11.5331 - accuracy10: 0.5487 - accuracy20: 0.5373 - accuracy30: 0.5138 - accuracy50: 0.4737 - val_loss: 12.1129 - val_accuracy10: 0.5340 - val_accuracy20: 0.5097 - val_accuracy30: 0.4824 - val_accuracy50: 0.4423 - 233s/epoch - 40ms/step
Epoch 7/50
5759/5759 - 236s - loss: 11.5037 - accuracy10: 0.5512 - accuracy20: 0.5393 - accuracy30: 0.5158 - accuracy50: 0.4754 - val_loss: 12.1374 - val_accuracy10: 0.5376 - val_accuracy20: 0.5094 - val_accuracy30: 0.4779 - val_accuracy50: 0.4318 - 236s/epoch - 41ms/step
Epoch 8/50
5759/5759 - 235s - loss: 11.4818 - accuracy10: 0.5527 - accuracy20: 0.5409 - accuracy30: 0.5168 - accuracy50: 0.4769 - val_loss: 12.0283 - val_accuracy10: 0.5364 - val_accuracy20: 0.5164 - val_accuracy30: 0.4878 - val_accuracy50: 0.4473 - 235s/epoch - 41ms/step
Epoch 9/50
5759/5759 - 234s - loss: 11.4638 - accuracy10: 0.5539 - accuracy20: 0.5419 - accuracy30: 0.5177 - accuracy50: 0.4775 - val_loss: 12.0036 - val_accuracy10: 0.5370 - val_accuracy20: 0.5176 - val_accuracy30: 0.4890 - val_accuracy50: 0.4473 - 234s/epoch - 41ms/step
Epoch 10/50
5759/5759 - 236s - loss: 11.4463 - accuracy10: 0.5554 - accuracy20: 0.5433 - accuracy30: 0.5189 - accuracy50: 0.4785 - val_loss: 12.0593 - val_accuracy10: 0.5329 - val_accuracy20: 0.5150 - val_accuracy30: 0.4871 - val_accuracy50: 0.4465 - 236s/epoch - 41ms/step
Epoch 11/50
5759/5759 - 234s - loss: 11.4307 - accuracy10: 0.5570 - accuracy20: 0.5439 - accuracy30: 0.5200 - accuracy50: 0.4795 - val_loss: 12.0223 - val_accuracy10: 0.5341 - val_accuracy20: 0.5156 - val_accuracy30: 0.4877 - val_accuracy50: 0.4474 - 234s/epoch - 41ms/step
Epoch 12/50
5759/5759 - 237s - loss: 11.4218 - accuracy10: 0.5575 - accuracy20: 0.5448 - accuracy30: 0.5203 - accuracy50: 0.4798 - val_loss: 11.9685 - val_accuracy10: 0.5357 - val_accuracy20: 0.5183 - val_accuracy30: 0.4907 - val_accuracy50: 0.4498 - 237s/epoch - 41ms/step
Epoch 13/50
5759/5759 - 237s - loss: 11.4046 - accuracy10: 0.5587 - accuracy20: 0.5459 - accuracy30: 0.5214 - accuracy50: 0.4809 - val_loss: 12.0097 - val_accuracy10: 0.5349 - val_accuracy20: 0.5189 - val_accuracy30: 0.4911 - val_accuracy50: 0.4506 - 237s/epoch - 41ms/step
Epoch 14/50
5759/5759 - 234s - loss: 11.4017 - accuracy10: 0.5589 - accuracy20: 0.5459 - accuracy30: 0.5217 - accuracy50: 0.4810 - val_loss: 11.9760 - val_accuracy10: 0.5372 - val_accuracy20: 0.5203 - val_accuracy30: 0.4926 - val_accuracy50: 0.4506 - 234s/epoch - 41ms/step
Epoch 15/50
5759/5759 - 236s - loss: 11.3843 - accuracy10: 0.5605 - accuracy20: 0.5471 - accuracy30: 0.5227 - accuracy50: 0.4819 - val_loss: 11.9923 - val_accuracy10: 0.5347 - val_accuracy20: 0.5191 - val_accuracy30: 0.4925 - val_accuracy50: 0.4511 - 236s/epoch - 41ms/step
Epoch 16/50
5759/5759 - 231s - loss: 11.3733 - accuracy10: 0.5612 - accuracy20: 0.5479 - accuracy30: 0.5232 - accuracy50: 0.4828 - val_loss: 12.0423 - val_accuracy10: 0.5322 - val_accuracy20: 0.5180 - val_accuracy30: 0.4913 - val_accuracy50: 0.4512 - 231s/epoch - 40ms/step
Epoch 17/50
5759/5759 - 237s - loss: 11.3632 - accuracy10: 0.5618 - accuracy20: 0.5486 - accuracy30: 0.5238 - accuracy50: 0.4830 - val_loss: 12.0149 - val_accuracy10: 0.5349 - val_accuracy20: 0.5195 - val_accuracy30: 0.4924 - val_accuracy50: 0.4509 - 237s/epoch - 41ms/step
Epoch 18/50
5759/5759 - 233s - loss: 11.3651 - accuracy10: 0.5614 - accuracy20: 0.5481 - accuracy30: 0.5237 - accuracy50: 0.4829 - val_loss: 11.9568 - val_accuracy10: 0.5366 - val_accuracy20: 0.5223 - val_accuracy30: 0.4945 - val_accuracy50: 0.4532 - 233s/epoch - 40ms/step
Epoch 19/50
5759/5759 - 231s - loss: 11.3478 - accuracy10: 0.5631 - accuracy20: 0.5496 - accuracy30: 0.5248 - accuracy50: 0.4844 - val_loss: 11.9727 - val_accuracy10: 0.5379 - val_accuracy20: 0.5217 - val_accuracy30: 0.4936 - val_accuracy50: 0.4512 - 231s/epoch - 40ms/step
Epoch 20/50
5759/5759 - 231s - loss: 11.3395 - accuracy10: 0.5634 - accuracy20: 0.5500 - accuracy30: 0.5255 - accuracy50: 0.4848 - val_loss: 11.9834 - val_accuracy10: 0.5340 - val_accuracy20: 0.5194 - val_accuracy30: 0.4927 - val_accuracy50: 0.4516 - 231s/epoch - 40ms/step
Epoch 21/50
5759/5759 - 235s - loss: 11.3290 - accuracy10: 0.5643 - accuracy20: 0.5508 - accuracy30: 0.5262 - accuracy50: 0.4852 - val_loss: 11.9560 - val_accuracy10: 0.5359 - val_accuracy20: 0.5208 - val_accuracy30: 0.4941 - val_accuracy50: 0.4534 - 235s/epoch - 41ms/step
Epoch 22/50
5759/5759 - 235s - loss: 11.3230 - accuracy10: 0.5649 - accuracy20: 0.5514 - accuracy30: 0.5268 - accuracy50: 0.4863 - val_loss: 11.9456 - val_accuracy10: 0.5392 - val_accuracy20: 0.5224 - val_accuracy30: 0.4946 - val_accuracy50: 0.4527 - 235s/epoch - 41ms/step
Epoch 23/50
5759/5759 - 234s - loss: 11.3171 - accuracy10: 0.5652 - accuracy20: 0.5517 - accuracy30: 0.5269 - accuracy50: 0.4862 - val_loss: 11.9462 - val_accuracy10: 0.5402 - val_accuracy20: 0.5213 - val_accuracy30: 0.4934 - val_accuracy50: 0.4516 - 234s/epoch - 41ms/step
Epoch 24/50
5759/5759 - 236s - loss: 11.3081 - accuracy10: 0.5655 - accuracy20: 0.5520 - accuracy30: 0.5274 - accuracy50: 0.4867 - val_loss: 11.9239 - val_accuracy10: 0.5380 - val_accuracy20: 0.5219 - val_accuracy30: 0.4947 - val_accuracy50: 0.4539 - 236s/epoch - 41ms/step
Epoch 25/50
5759/5759 - 232s - loss: 11.3015 - accuracy10: 0.5655 - accuracy20: 0.5522 - accuracy30: 0.5276 - accuracy50: 0.4874 - val_loss: 11.8934 - val_accuracy10: 0.5409 - val_accuracy20: 0.5262 - val_accuracy30: 0.4991 - val_accuracy50: 0.4569 - 232s/epoch - 40ms/step
Epoch 26/50
5759/5759 - 235s - loss: 11.2947 - accuracy10: 0.5663 - accuracy20: 0.5533 - accuracy30: 0.5286 - accuracy50: 0.4879 - val_loss: 11.9170 - val_accuracy10: 0.5383 - val_accuracy20: 0.5220 - val_accuracy30: 0.4945 - val_accuracy50: 0.4534 - 235s/epoch - 41ms/step
Epoch 27/50
5759/5759 - 234s - loss: 11.2884 - accuracy10: 0.5667 - accuracy20: 0.5536 - accuracy30: 0.5287 - accuracy50: 0.4884 - val_loss: 11.9070 - val_accuracy10: 0.5392 - val_accuracy20: 0.5241 - val_accuracy30: 0.4964 - val_accuracy50: 0.4542 - 234s/epoch - 41ms/step
Epoch 28/50
5759/5759 - 234s - loss: 11.2816 - accuracy10: 0.5671 - accuracy20: 0.5537 - accuracy30: 0.5292 - accuracy50: 0.4889 - val_loss: 11.9009 - val_accuracy10: 0.5393 - val_accuracy20: 0.5241 - val_accuracy30: 0.4958 - val_accuracy50: 0.4543 - 234s/epoch - 41ms/step
Epoch 29/50
5759/5759 - 240s - loss: 11.2758 - accuracy10: 0.5672 - accuracy20: 0.5544 - accuracy30: 0.5298 - accuracy50: 0.4894 - val_loss: 11.9206 - val_accuracy10: 0.5406 - val_accuracy20: 0.5250 - val_accuracy30: 0.4961 - val_accuracy50: 0.4536 - 240s/epoch - 42ms/step
Epoch 30/50
5759/5759 - 238s - loss: 11.2694 - accuracy10: 0.5678 - accuracy20: 0.5548 - accuracy30: 0.5303 - accuracy50: 0.4898 - val_loss: 11.9010 - val_accuracy10: 0.5395 - val_accuracy20: 0.5253 - val_accuracy30: 0.4976 - val_accuracy50: 0.4550 - 238s/epoch - 41ms/step
Epoch 31/50
5759/5759 - 236s - loss: 11.2641 - accuracy10: 0.5680 - accuracy20: 0.5551 - accuracy30: 0.5307 - accuracy50: 0.4901 - val_loss: 11.9328 - val_accuracy10: 0.5383 - val_accuracy20: 0.5235 - val_accuracy30: 0.4955 - val_accuracy50: 0.4528 - 236s/epoch - 41ms/step
Epoch 32/50
5759/5759 - 236s - loss: 11.2582 - accuracy10: 0.5683 - accuracy20: 0.5552 - accuracy30: 0.5312 - accuracy50: 0.4907 - val_loss: 11.9472 - val_accuracy10: 0.5379 - val_accuracy20: 0.5234 - val_accuracy30: 0.4953 - val_accuracy50: 0.4528 - 236s/epoch - 41ms/step
Epoch 33/50
5759/5759 - 234s - loss: 11.2521 - accuracy10: 0.5687 - accuracy20: 0.5559 - accuracy30: 0.5315 - accuracy50: 0.4913 - val_loss: 11.9177 - val_accuracy10: 0.5366 - val_accuracy20: 0.5222 - val_accuracy30: 0.4945 - val_accuracy50: 0.4527 - 234s/epoch - 41ms/step
Epoch 34/50
5759/5759 - 239s - loss: 11.2457 - accuracy10: 0.5691 - accuracy20: 0.5565 - accuracy30: 0.5321 - accuracy50: 0.4921 - val_loss: 11.9220 - val_accuracy10: 0.5384 - val_accuracy20: 0.5233 - val_accuracy30: 0.4949 - val_accuracy50: 0.4524 - 239s/epoch - 41ms/step
Epoch 35/50
5759/5759 - 238s - loss: 11.2404 - accuracy10: 0.5690 - accuracy20: 0.5563 - accuracy30: 0.5324 - accuracy50: 0.4925 - val_loss: 11.9187 - val_accuracy10: 0.5386 - val_accuracy20: 0.5242 - val_accuracy30: 0.4959 - val_accuracy50: 0.4537 - 238s/epoch - 41ms/step
testing model: results/AAPL/W5/deepVOL_L3/seq2seq
Evaluating performance on  test set...
31315/31315 - 513s - 513s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0036232
{'0': {'precision': 0.47957924386373396, 'recall': 0.7092737446756913, 'f1-score': 0.5722372226726952, 'support': 2828771}, '1': {'precision': 0.5791629119124074, 'recall': 0.2355068334313214, 'f1-score': 0.33485181990600443, 'support': 2325113}, '2': {'precision': 0.5316043079482733, 'recall': 0.5362107620968616, 'f1-score': 0.5338975991168013, 'support': 2862602}, 'accuracy': 0.5100627631608163, 'macro avg': {'precision': 0.5301154879081382, 'recall': 0.49366378006795814, 'f1-score': 0.4803288805651669, 'support': 8016486}, 'weighted avg': {'precision': 0.5270402303441177, 'recall': 0.5100627631608163, 'f1-score': 0.48969495052833945, 'support': 8016486}}
[[2006373  209656  612742]
 [1037826  547580  739707]
 [1139412  188232 1534958]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9971498
{'0': {'precision': 0.5022553148831117, 'recall': 0.667467805960897, 'f1-score': 0.5731941979830912, 'support': 3137615}, '1': {'precision': 0.4259848771750724, 'recall': 0.27656300480814916, 'f1-score': 0.3353839949009539, 'support': 1683808}, '2': {'precision': 0.5589799237216181, 'recall': 0.4817451173889216, 'f1-score': 0.5174966265517568, 'support': 3195063}, 'accuracy': 0.5113390081389776, 'macro avg': {'precision': 0.4957400385932674, 'recall': 0.4752586427193226, 'f1-score': 0.47535827314526724, 'support': 8016486}, 'weighted avg': {'precision': 0.5088434790379653, 'recall': 0.5113390081389776, 'f1-score': 0.5010448831709103, 'support': 8016486}}
[[2094257  327920  715438]
 [ 719175  465679  498954]
 [1356274  299583 1539206]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0249563
{'0': {'precision': 0.48634152095290223, 'recall': 0.6200727141573628, 'f1-score': 0.5451251390933738, 'support': 3105310}, '1': {'precision': 0.35752939916559007, 'recall': 0.27191813977561685, 'f1-score': 0.30890176900121896, 'support': 1731146}, '2': {'precision': 0.5377975814743651, 'recall': 0.46349562739974154, 'f1-score': 0.49788977939800444, 'support': 3180030}, 'accuracy': 0.4827773665418988, 'macro avg': {'precision': 0.4605561671976191, 'recall': 0.45182882711090705, 'f1-score': 0.45063889583086575, 'support': 8016486}, 'weighted avg': {'precision': 0.4789366838155891, 'recall': 0.4827773665418988, 'f1-score': 0.47537550026987696, 'support': 8016486}}
[[1925518  433993  745799]
 [ 739467  470730  520949]
 [1294204  411896 1473930]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0584054
{'0': {'precision': 0.4651857522506117, 'recall': 0.5563657487150233, 'f1-score': 0.5067065519414853, 'support': 3062507}, '1': {'precision': 0.297287614756234, 'recall': 0.2580225537155545, 'f1-score': 0.27626690056300096, 'support': 1804226}, '2': {'precision': 0.5038604249408848, 'recall': 0.44595560350287783, 'f1-score': 0.473142952228107, 'support': 3149753}, 'accuracy': 0.4458381141063553, 'macro avg': {'precision': 0.4221112639825768, 'recall': 0.42011463531115184, 'f1-score': 0.41870546824419774, 'support': 8016486}, 'weighted avg': {'precision': 0.44259349440986634, 'recall': 0.4458381141063553, 'f1-score': 0.44165532384278844, 'support': 8016486}}
[[1703874  554009  804624]
 [ 760193  465531  578502]
 [1198715  546388 1404650]]
Evaluating performance on  train set...
5759/5759 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9350378
{'0': {'precision': 0.4675592799956865, 'recall': 0.6477098041105462, 'f1-score': 0.5430845954073402, 'support': 415030}, '1': {'precision': 0.6825175253581649, 'recall': 0.4860425547827388, 'f1-score': 0.5677629543344921, 'support': 641808}, '2': {'precision': 0.500188837552213, 'recall': 0.5299664058044635, 'f1-score': 0.5146472479182979, 'support': 417334}, 'accuracy': 0.54399215288311, 'macro avg': {'precision': 0.5500885476353549, 'recall': 0.5545729215659162, 'f1-score': 0.5418315992200434, 'support': 1474172}, 'weighted avg': {'precision': 0.5703826583483462, 'recall': 0.54399215288311, 'f1-score': 0.5457782405242774, 'support': 1474172}}
[[268819  72363  73848]
 [182704 311946 147158]
 [123418  72743 221173]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9576282
{'0': {'precision': 0.5090188058603302, 'recall': 0.5789003037506333, 'f1-score': 0.5417151674681094, 'support': 487571}, '1': {'precision': 0.546167703393484, 'recall': 0.5704946243476443, 'f1-score': 0.5580661781768553, 'support': 497428}, '2': {'precision': 0.5443111377724456, 'recall': 0.4451758375871113, 'f1-score': 0.48977737494278906, 'support': 489173}, 'accuracy': 0.5316903319287031, 'macro avg': {'precision': 0.5331658823420865, 'recall': 0.5315235885617963, 'f1-score': 0.5298529068625846, 'support': 1474172}, 'weighted avg': {'precision': 0.5332649302478283, 'recall': 0.5316903319287031, 'f1-score': 0.5299980033731745, 'support': 1474172}}
[[282255 117783  87533]
 [118869 283780  94779]
 [153384 118021 217768]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98748356
{'0': {'precision': 0.4987912269289397, 'recall': 0.5188622077145582, 'f1-score': 0.5086287892963609, 'support': 495064}, '1': {'precision': 0.4920418890974562, 'recall': 0.5955512763948392, 'f1-score': 0.5388709388571343, 'support': 485038}, '2': {'precision': 0.5293257693227594, 'recall': 0.3986661809055397, 'f1-score': 0.45479765823157453, 'support': 494070}, 'accuracy': 0.5038109528603175, 'macro avg': {'precision': 0.5067196284497184, 'recall': 0.5043598883383124, 'f1-score': 0.5007657954616899, 'support': 1474172}, 'weighted avg': {'precision': 0.5068042105138995, 'recall': 0.5038109528603175, 'f1-score': 0.5005376335923314, 'support': 1474172}}
[[256870 149012  89182]
 [110211 288865  85962]
 [147904 149197 196969]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0348924
{'0': {'precision': 0.47131734168960265, 'recall': 0.4544044770932641, 'f1-score': 0.46270641104049776, 'support': 497823}, '1': {'precision': 0.42947437985319453, 'recall': 0.5705106767219036, 'f1-score': 0.4900467611465054, 'support': 478424}, '2': {'precision': 0.49533564924528406, 'recall': 0.35681277300798314, 'f1-score': 0.4148152644807455, 'support': 497925}, 'accuracy': 0.4591221377152734, 'macro avg': {'precision': 0.46537579026269377, 'recall': 0.46057597560771696, 'f1-score': 0.45585614555591625, 'support': 1474172}, 'weighted avg': {'precision': 0.46585029891307517, 'recall': 0.4591221377152734, 'f1-score': 0.45540338297345534, 'support': 1474172}}
[[226213 180835  90775]
 [115241 272946  90237]
 [138505 181754 177666]]
Evaluating performance on  val set...
2129/2129 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9478062
{'0': {'precision': 0.4788595918332501, 'recall': 0.6611132392374105, 'f1-score': 0.5554174753436052, 'support': 169685}, '1': {'precision': 0.6586205732419568, 'recall': 0.47120229164351995, 'f1-score': 0.5493666893821209, 'support': 207013}, '2': {'precision': 0.5225997736331873, 'recall': 0.5049749765219148, 'f1-score': 0.5136362262325807, 'support': 168242}, 'accuracy': 0.5407641208206408, 'macro avg': {'precision': 0.5533599795694647, 'recall': 0.5457635024676151, 'f1-score': 0.5394734636527688, 'support': 544940}, 'weighted avg': {'precision': 0.560651707865741, 'recall': 0.5407641208206408, 'f1-score': 0.5402195594864801, 'support': 544940}}
[[112181  25777  31727]
 [ 63585  97545  45883]
 [ 58501  24783  84958]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96689385
{'0': {'precision': 0.5079805965418882, 'recall': 0.5993798497927639, 'f1-score': 0.5499082699959496, 'support': 192534}, '1': {'precision': 0.5251263525161655, 'recall': 0.5578815116700628, 'f1-score': 0.5410085984548847, 'support': 159982}, '2': {'precision': 0.5559021129476398, 'recall': 0.4269945536939259, 'f1-score': 0.48299517674964065, 'support': 192424}, 'accuracy': 0.5263258340367747, 'macro avg': {'precision': 0.5296696873352311, 'recall': 0.5280853050522509, 'f1-score': 0.5246373484001583, 'support': 544940}, 'weighted avg': {'precision': 0.5299357883155462, 'recall': 0.5263258340367747, 'f1-score': 0.5236678172721444, 'support': 544940}}
[[115401  41119  36014]
 [ 41106  89251  29625]
 [ 70669  39591  82164]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99935454
{'0': {'precision': 0.49208141040539194, 'recall': 0.5420513383177374, 'f1-score': 0.5158590855977923, 'support': 191397}, '1': {'precision': 0.4766724696626559, 'recall': 0.576030631938885, 'f1-score': 0.5216626483002028, 'support': 161139}, '2': {'precision': 0.537207633806859, 'recall': 0.38916030851749445, 'f1-score': 0.45135389289417216, 'support': 192404}, 'accuracy': 0.4981172239145594, 'macro avg': {'precision': 0.5019871712916356, 'recall': 0.5024140929247056, 'f1-score': 0.4962918755973891, 'support': 544940}, 'weighted avg': {'precision': 0.5034578639323714, 'recall': 0.4981172239145594, 'f1-score': 0.4948001124876451, 'support': 544940}}
[[103747  51515  36135]
 [ 39949  92821  28369]
 [ 67137  50391  74876]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0450182
{'0': {'precision': 0.4606051289934158, 'recall': 0.4774865216583008, 'f1-score': 0.46889393109563676, 'support': 188265}, '1': {'precision': 0.42465727813637827, 'recall': 0.5492383025027203, 'f1-score': 0.47897956870487574, 'support': 165420}, '2': {'precision': 0.4995435336386259, 'recall': 0.35476719562887243, 'f1-score': 0.4148880552523687, 'support': 191255}, 'accuracy': 0.4561970125151393, 'macro avg': {'precision': 0.46160198025614, 'recall': 0.46049733992996456, 'f1-score': 0.4542538516842938, 'support': 544940}, 'weighted avg': {'precision': 0.46335895710595754, 'recall': 0.4561970125151393, 'f1-score': 0.45300130509812525, 'support': 544940}}
[[89894 61313 37058]
 [43648 90855 30917]
 [61623 61781 67851]]
training model: results/AAPL/W6/deepLOB_L1/seq2seq
Epoch 1/50
5452/5452 - 139s - loss: 12.3471 - accuracy10: 0.4843 - accuracy20: 0.4617 - accuracy30: 0.4452 - accuracy50: 0.4518 - val_loss: 12.9004 - val_accuracy10: 0.4429 - val_accuracy20: 0.4207 - val_accuracy30: 0.4049 - val_accuracy50: 0.3922 - 139s/epoch - 25ms/step
Epoch 2/50
5452/5452 - 136s - loss: 12.2624 - accuracy10: 0.4943 - accuracy20: 0.4712 - accuracy30: 0.4544 - accuracy50: 0.4573 - val_loss: 13.1068 - val_accuracy10: 0.4358 - val_accuracy20: 0.4112 - val_accuracy30: 0.3927 - val_accuracy50: 0.3781 - 136s/epoch - 25ms/step
Epoch 3/50
5452/5452 - 134s - loss: 12.2266 - accuracy10: 0.4982 - accuracy20: 0.4744 - accuracy30: 0.4576 - accuracy50: 0.4590 - val_loss: 12.9362 - val_accuracy10: 0.4448 - val_accuracy20: 0.4176 - val_accuracy30: 0.3980 - val_accuracy50: 0.3826 - 134s/epoch - 25ms/step
Epoch 4/50
5452/5452 - 135s - loss: 12.1986 - accuracy10: 0.5016 - accuracy20: 0.4767 - accuracy30: 0.4599 - accuracy50: 0.4608 - val_loss: 12.9119 - val_accuracy10: 0.4439 - val_accuracy20: 0.4158 - val_accuracy30: 0.3969 - val_accuracy50: 0.3851 - 135s/epoch - 25ms/step
Epoch 5/50
5452/5452 - 131s - loss: 12.1762 - accuracy10: 0.5044 - accuracy20: 0.4791 - accuracy30: 0.4614 - accuracy50: 0.4622 - val_loss: 13.0858 - val_accuracy10: 0.4351 - val_accuracy20: 0.4101 - val_accuracy30: 0.3930 - val_accuracy50: 0.3799 - 131s/epoch - 24ms/step
Epoch 6/50
5452/5452 - 131s - loss: 12.1536 - accuracy10: 0.5067 - accuracy20: 0.4810 - accuracy30: 0.4633 - accuracy50: 0.4637 - val_loss: 13.2122 - val_accuracy10: 0.4239 - val_accuracy20: 0.4041 - val_accuracy30: 0.3910 - val_accuracy50: 0.3822 - 131s/epoch - 24ms/step
Epoch 7/50
5452/5452 - 130s - loss: 12.1356 - accuracy10: 0.5083 - accuracy20: 0.4823 - accuracy30: 0.4642 - accuracy50: 0.4647 - val_loss: 13.2504 - val_accuracy10: 0.4256 - val_accuracy20: 0.4048 - val_accuracy30: 0.3908 - val_accuracy50: 0.3835 - 130s/epoch - 24ms/step
Epoch 8/50
5452/5452 - 132s - loss: 12.1192 - accuracy10: 0.5094 - accuracy20: 0.4833 - accuracy30: 0.4654 - accuracy50: 0.4657 - val_loss: 13.2361 - val_accuracy10: 0.4250 - val_accuracy20: 0.4047 - val_accuracy30: 0.3918 - val_accuracy50: 0.3861 - 132s/epoch - 24ms/step
Epoch 9/50
5452/5452 - 130s - loss: 12.1018 - accuracy10: 0.5114 - accuracy20: 0.4850 - accuracy30: 0.4667 - accuracy50: 0.4673 - val_loss: 13.3610 - val_accuracy10: 0.3997 - val_accuracy20: 0.3850 - val_accuracy30: 0.3757 - val_accuracy50: 0.3686 - 130s/epoch - 24ms/step
Epoch 10/50
5452/5452 - 128s - loss: 12.0837 - accuracy10: 0.5126 - accuracy20: 0.4866 - accuracy30: 0.4684 - accuracy50: 0.4690 - val_loss: 13.5240 - val_accuracy10: 0.3878 - val_accuracy20: 0.3746 - val_accuracy30: 0.3679 - val_accuracy50: 0.3633 - 128s/epoch - 24ms/step
Epoch 11/50
5452/5452 - 130s - loss: 12.0692 - accuracy10: 0.5138 - accuracy20: 0.4876 - accuracy30: 0.4692 - accuracy50: 0.4699 - val_loss: 13.5568 - val_accuracy10: 0.3892 - val_accuracy20: 0.3759 - val_accuracy30: 0.3702 - val_accuracy50: 0.3650 - 130s/epoch - 24ms/step
testing model: results/AAPL/W6/deepLOB_L1/seq2seq
Evaluating performance on  test set...
29350/29350 - 274s - 274s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1096092
{'0': {'precision': 0.4741069964338228, 'recall': 0.3453575788989878, 'f1-score': 0.39961811494037436, 'support': 2469455}, '1': {'precision': 0.34997799500324195, 'recall': 0.7396270502925157, 'f1-score': 0.475132146696833, 'support': 2535248}, '2': {'precision': 0.5472223390386476, 'recall': 0.0778036123077242, 'f1-score': 0.13623714222097827, 'support': 2508701}, 'accuracy': 0.38906053767373616, 'macro avg': {'precision': 0.45710244349190415, 'recall': 0.38759608049974253, 'f1-score': 0.3369958012860619, 'support': 7513404}, 'weighted avg': {'precision': 0.4566351195707111, 'recall': 0.38906053767373616, 'f1-score': 0.3371567709663749, 'support': 7513404}}
[[ 852845 1571319   45291]
 [ 543902 1875138  116208]
 [ 402098 1911417  195186]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084525
{'0': {'precision': 0.41637977934094766, 'recall': 0.3285999304954161, 'f1-score': 0.36731837053974364, 'support': 2322149}, '1': {'precision': 0.3932599963232088, 'recall': 0.7194069975695546, 'f1-score': 0.5085330917012182, 'support': 2896177}, '2': {'precision': 0.505948445930939, 'recall': 0.08436706726307341, 'f1-score': 0.14461888808764564, 'support': 2295078}, 'accuracy': 0.40463909567487655, 'macro avg': {'precision': 0.4385294071983652, 'recall': 0.37745799844268135, 'f1-score': 0.34015678344286915, 'support': 7513404}, 'weighted avg': {'precision': 0.43482788786260557, 'recall': 0.40463909567487655, 'f1-score': 0.35372534994642535, 'support': 7513404}}
[[ 763058 1507678   51413]
 [ 674984 2083530  137663]
 [ 394559 1706890  193629]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0732653
{'0': {'precision': 0.3801114281016681, 'recall': 0.3206442801904126, 'f1-score': 0.34785461984423344, 'support': 2213509}, '1': {'precision': 0.4191198492328502, 'recall': 0.705106421651256, 'f1-score': 0.5257377536697927, 'support': 3113981}, '2': {'precision': 0.468904031577087, 'recall': 0.08738861638655501, 'f1-score': 0.1473212874108568, 'support': 2185914}, 'accuracy': 0.4121249170149775, 'macro avg': {'precision': 0.42271176963720175, 'recall': 0.3710464394094079, 'f1-score': 0.3403045536416276, 'support': 7513404}, 'weighted avg': {'precision': 0.42211162897944154, 'recall': 0.4121249170149775, 'f1-score': 0.3632372719843921, 'support': 7513404}}
[[ 709749 1446555   57205]
 [ 759138 2195688  159155]
 [ 398326 1596564  191024]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784285
{'0': {'precision': 0.3693952924799968, 'recall': 0.3036657306988846, 'f1-score': 0.3333210141269879, 'support': 2212683}, '1': {'precision': 0.4186122190937509, 'recall': 0.7072504237594492, 'f1-score': 0.5259321307520142, 'support': 3112025}, '2': {'precision': 0.4132004085764409, 'recall': 0.08243218793290617, 'f1-score': 0.1374446070480937, 'support': 2188696}, 'accuracy': 0.40638251317245816, 'macro avg': {'precision': 0.4004026400500629, 'recall': 0.3644494474637467, 'f1-score': 0.3322325839756986, 'support': 7513404}, 'weighted avg': {'precision': 0.40254143881060683, 'recall': 0.40638251317245816, 'f1-score': 0.3560399710135136, 'support': 7513404}}
[[ 671916 1472294   68473]
 [ 723298 2200981  187746]
 [ 423748 1584529  180419]]
Evaluating performance on  train set...
5452/5452 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0992093
{'0': {'precision': 0.4930870695203722, 'recall': 0.26283515586321904, 'f1-score': 0.3428940502596266, 'support': 460532}, '1': {'precision': 0.3521856865801821, 'recall': 0.7786591354049911, 'f1-score': 0.4850048333477417, 'support': 475529}, '2': {'precision': 0.5250126736287134, 'recall': 0.1127131519718598, 'f1-score': 0.18558393244977095, 'support': 459414}, 'accuracy': 0.38918719432451315, 'macro avg': {'precision': 0.4567618099097559, 'recall': 0.38473581441335664, 'f1-score': 0.3378276053523797, 'support': 1395475}, 'weighted avg': {'precision': 0.4555832631158603, 'recall': 0.38918719432451315, 'f1-score': 0.3395312727878777, 'support': 1395475}}
[[121044 323076  16412]
 [ 74818 370275  30436]
 [ 49620 358012  51782]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1003909
{'0': {'precision': 0.47209163142683896, 'recall': 0.25794827222697914, 'f1-score': 0.33361250542576987, 'support': 464818}, '1': {'precision': 0.34305396650687675, 'recall': 0.761701105958973, 'f1-score': 0.47305433069188824, 'support': 466473}, '2': {'precision': 0.5047746912996616, 'recall': 0.11501473553590817, 'f1-score': 0.18734274936397932, 'support': 464184}, 'accuracy': 0.3787957505508877, 'macro avg': {'precision': 0.4399734297444591, 'recall': 0.3782213712406201, 'f1-score': 0.3313365284938791, 'support': 1395475}, 'weighted avg': {'precision': 0.43982904470604267, 'recall': 0.3787957505508877, 'f1-score': 0.331570022478799, 'support': 1395475}}
[[119899 325869  19050]
 [ 77832 355313  33328]
 [ 56243 354553  53388]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0992208
{'0': {'precision': 0.45378992386787587, 'recall': 0.2558567571554085, 'f1-score': 0.32721978825636155, 'support': 467793}, '1': {'precision': 0.3368566892939332, 'recall': 0.745704914901422, 'f1-score': 0.46407647906673277, 'support': 460701}, '2': {'precision': 0.48406965725626216, 'recall': 0.11595546713892, 'f1-score': 0.1870939097475481, 'support': 466981}, 'accuracy': 0.3707583439330694, 'macro avg': {'precision': 0.4249054234726904, 'recall': 0.3725057130652502, 'f1-score': 0.32613005902354747, 'support': 1395475}, 'weighted avg': {'precision': 0.4253184729826877, 'recall': 0.3707583439330694, 'f1-score': 0.32550989839169514, 'support': 1395475}}
[[119688 326194  21911]
 [ 81352 343547  35802]
 [ 62712 350120  54149]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1029757
{'0': {'precision': 0.42565428872882677, 'recall': 0.23835830318749573, 'f1-score': 0.3055912952285372, 'support': 468832}, '1': {'precision': 0.3339507524425534, 'recall': 0.7360103643837344, 'f1-score': 0.4594395275232626, 'support': 460037}, '2': {'precision': 0.4443128360215054, 'recall': 0.11335259297994453, 'f1-score': 0.18062447280439037, 'support': 466606}, 'accuracy': 0.3606177108153138, 'macro avg': {'precision': 0.40130595906429517, 'recall': 0.3625737535170582, 'f1-score': 0.3152184318520634, 'support': 1395475}, 'weighted avg': {'precision': 0.40166186349406385, 'recall': 0.3606177108153138, 'f1-score': 0.31452417478290196, 'support': 1395475}}
[[111750 330042  27040]
 [ 82336 338592  39109]
 [ 68451 345264  52891]]
Evaluating performance on  val set...
1969/1969 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0563134
{'0': {'precision': 0.49994773545178967, 'recall': 0.22366522366522368, 'f1-score': 0.30906279568899864, 'support': 149688}, '1': {'precision': 0.4272736654712454, 'recall': 0.8029975368024981, 'f1-score': 0.5577627116360685, 'support': 206236}, '2': {'precision': 0.48079020724760635, 'recall': 0.1606734215837828, 'f1-score': 0.240856080346075, 'support': 148139}, 'accuracy': 0.44218480626429635, 'macro avg': {'precision': 0.4693372027235472, 'recall': 0.3957787273505015, 'f1-score': 0.3692271958903807, 'support': 504063}, 'weighted avg': {'precision': 0.464583135060277, 'recall': 0.44218480626429635, 'f1-score': 0.39077242575721344, 'support': 504063}}
[[ 33480 108144   8064]
 [ 22989 165607  17640]
 [ 10498 113839  23802]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716953
{'0': {'precision': 0.4860136332848146, 'recall': 0.21697785441303258, 'f1-score': 0.300015568356204, 'support': 155426}, '1': {'precision': 0.4017542573853137, 'recall': 0.788750995657648, 'f1-score': 0.5323522423985974, 'support': 194595}, '2': {'precision': 0.47237422100623194, 'recall': 0.1613975409303956, 'f1-score': 0.24059146288357508, 'support': 154042}, 'accuracy': 0.42072717100838586, 'macro avg': {'precision': 0.4533807038921201, 'recall': 0.389042130333692, 'f1-score': 0.35765309121279215, 'support': 504063}, 'weighted avg': {'precision': 0.4493168402264453, 'recall': 0.42072717100838586, 'f1-score': 0.3715497754494936, 'support': 504063}}
[[ 33724 112077   9625]
 [ 22963 153487  18145]
 [ 12702 116478  24862]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0801052
{'0': {'precision': 0.4731735713592704, 'recall': 0.21331142255518828, 'f1-score': 0.2940583654906284, 'support': 160043}, '1': {'precision': 0.3833462588575253, 'recall': 0.7745549968606954, 'f1-score': 0.5128636986264864, 'support': 186347}, '2': {'precision': 0.4603956821545904, 'recall': 0.1617588299835736, 'f1-score': 0.2394037668195109, 'support': 157673}, 'accuracy': 0.4046716382674388, 'macro avg': {'precision': 0.43897183745712876, 'recall': 0.3832084164664858, 'f1-score': 0.3487752769788752, 'support': 504063}, 'weighted avg': {'precision': 0.4359683443790473, 'recall': 0.4046716382674388, 'f1-score': 0.3578523017200216, 'support': 504063}}
[[ 34139 114753  11151]
 [ 23269 144336  18742]
 [ 14741 117427  25505]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916405
{'0': {'precision': 0.45215646389400477, 'recall': 0.20057187799123283, 'f1-score': 0.27787937274842783, 'support': 164021}, '1': {'precision': 0.3724048257372654, 'recall': 0.7703446134052063, 'f1-score': 0.5020874072414054, 'support': 180318}, '2': {'precision': 0.4402881399536918, 'recall': 0.16072099371415693, 'f1-score': 0.23548243582275755, 'support': 159724}, 'accuracy': 0.39176848925630325, 'macro avg': {'precision': 0.4216164765283206, 'recall': 0.3772124950368654, 'f1-score': 0.3384830719375303, 'support': 504063}, 'weighted avg': {'precision': 0.41986623020855374, 'recall': 0.39176848925630325, 'f1-score': 0.34465066127821276, 'support': 504063}}
[[ 32898 117194  13929]
 [ 22706 138907  18705]
 [ 17154 116899  25671]]
training model: results/AAPL/W6/deepOF_L1/seq2seq
Epoch 1/50
5452/5452 - 120s - loss: 12.4092 - accuracy10: 0.4831 - accuracy20: 0.4668 - accuracy30: 0.4545 - accuracy50: 0.4641 - val_loss: 13.0155 - val_accuracy10: 0.4295 - val_accuracy20: 0.4120 - val_accuracy30: 0.4000 - val_accuracy50: 0.3887 - 120s/epoch - 22ms/step
Epoch 2/50
5452/5452 - 112s - loss: 12.3898 - accuracy10: 0.4831 - accuracy20: 0.4678 - accuracy30: 0.4559 - accuracy50: 0.4638 - val_loss: 12.9875 - val_accuracy10: 0.4315 - val_accuracy20: 0.4138 - val_accuracy30: 0.4015 - val_accuracy50: 0.3900 - 112s/epoch - 20ms/step
Epoch 3/50
5452/5452 - 122s - loss: 12.3934 - accuracy10: 0.4829 - accuracy20: 0.4673 - accuracy30: 0.4555 - accuracy50: 0.4627 - val_loss: 12.9903 - val_accuracy10: 0.4299 - val_accuracy20: 0.4120 - val_accuracy30: 0.3988 - val_accuracy50: 0.3852 - 122s/epoch - 22ms/step
Epoch 4/50
5452/5452 - 121s - loss: 12.3871 - accuracy10: 0.4837 - accuracy20: 0.4680 - accuracy30: 0.4561 - accuracy50: 0.4627 - val_loss: 12.9794 - val_accuracy10: 0.4314 - val_accuracy20: 0.4121 - val_accuracy30: 0.3982 - val_accuracy50: 0.3833 - 121s/epoch - 22ms/step
Epoch 5/50
5452/5452 - 121s - loss: 12.3735 - accuracy10: 0.4850 - accuracy20: 0.4690 - accuracy30: 0.4571 - accuracy50: 0.4632 - val_loss: 12.9674 - val_accuracy10: 0.4334 - val_accuracy20: 0.4148 - val_accuracy30: 0.4014 - val_accuracy50: 0.3869 - 121s/epoch - 22ms/step
Epoch 6/50
5452/5452 - 122s - loss: 12.3530 - accuracy10: 0.4874 - accuracy20: 0.4708 - accuracy30: 0.4586 - accuracy50: 0.4642 - val_loss: 12.9437 - val_accuracy10: 0.4361 - val_accuracy20: 0.4176 - val_accuracy30: 0.4035 - val_accuracy50: 0.3882 - 122s/epoch - 22ms/step
Epoch 7/50
5452/5452 - 123s - loss: 12.3409 - accuracy10: 0.4883 - accuracy20: 0.4715 - accuracy30: 0.4592 - accuracy50: 0.4645 - val_loss: 12.9215 - val_accuracy10: 0.4362 - val_accuracy20: 0.4185 - val_accuracy30: 0.4054 - val_accuracy50: 0.3902 - 123s/epoch - 23ms/step
Epoch 8/50
5452/5452 - 115s - loss: 12.3262 - accuracy10: 0.4894 - accuracy20: 0.4725 - accuracy30: 0.4602 - accuracy50: 0.4651 - val_loss: 12.9046 - val_accuracy10: 0.4377 - val_accuracy20: 0.4208 - val_accuracy30: 0.4090 - val_accuracy50: 0.3963 - 115s/epoch - 21ms/step
Epoch 9/50
5452/5452 - 112s - loss: 12.3147 - accuracy10: 0.4904 - accuracy20: 0.4733 - accuracy30: 0.4608 - accuracy50: 0.4659 - val_loss: 12.9028 - val_accuracy10: 0.4377 - val_accuracy20: 0.4211 - val_accuracy30: 0.4098 - val_accuracy50: 0.3971 - 112s/epoch - 21ms/step
Epoch 10/50
5452/5452 - 121s - loss: 12.3027 - accuracy10: 0.4914 - accuracy20: 0.4738 - accuracy30: 0.4613 - accuracy50: 0.4665 - val_loss: 12.8902 - val_accuracy10: 0.4401 - val_accuracy20: 0.4242 - val_accuracy30: 0.4136 - val_accuracy50: 0.4015 - 121s/epoch - 22ms/step
Epoch 11/50
5452/5452 - 121s - loss: 12.2917 - accuracy10: 0.4923 - accuracy20: 0.4747 - accuracy30: 0.4623 - accuracy50: 0.4669 - val_loss: 12.8712 - val_accuracy10: 0.4411 - val_accuracy20: 0.4261 - val_accuracy30: 0.4160 - val_accuracy50: 0.4040 - 121s/epoch - 22ms/step
Epoch 12/50
5452/5452 - 119s - loss: 12.2822 - accuracy10: 0.4930 - accuracy20: 0.4754 - accuracy30: 0.4631 - accuracy50: 0.4673 - val_loss: 12.8619 - val_accuracy10: 0.4416 - val_accuracy20: 0.4275 - val_accuracy30: 0.4170 - val_accuracy50: 0.4050 - 119s/epoch - 22ms/step
Epoch 13/50
5452/5452 - 122s - loss: 12.2726 - accuracy10: 0.4940 - accuracy20: 0.4762 - accuracy30: 0.4635 - accuracy50: 0.4680 - val_loss: 12.8410 - val_accuracy10: 0.4434 - val_accuracy20: 0.4286 - val_accuracy30: 0.4191 - val_accuracy50: 0.4079 - 122s/epoch - 22ms/step
Epoch 14/50
5452/5452 - 119s - loss: 12.2647 - accuracy10: 0.4945 - accuracy20: 0.4769 - accuracy30: 0.4644 - accuracy50: 0.4688 - val_loss: 12.8394 - val_accuracy10: 0.4427 - val_accuracy20: 0.4284 - val_accuracy30: 0.4193 - val_accuracy50: 0.4075 - 119s/epoch - 22ms/step
Epoch 15/50
5452/5452 - 120s - loss: 12.2535 - accuracy10: 0.4952 - accuracy20: 0.4780 - accuracy30: 0.4651 - accuracy50: 0.4697 - val_loss: 12.8329 - val_accuracy10: 0.4424 - val_accuracy20: 0.4292 - val_accuracy30: 0.4200 - val_accuracy50: 0.4088 - 120s/epoch - 22ms/step
Epoch 16/50
5452/5452 - 121s - loss: 12.2461 - accuracy10: 0.4964 - accuracy20: 0.4787 - accuracy30: 0.4657 - accuracy50: 0.4703 - val_loss: 12.8392 - val_accuracy10: 0.4425 - val_accuracy20: 0.4295 - val_accuracy30: 0.4206 - val_accuracy50: 0.4082 - 121s/epoch - 22ms/step
Epoch 17/50
5452/5452 - 121s - loss: 12.2364 - accuracy10: 0.4973 - accuracy20: 0.4795 - accuracy30: 0.4667 - accuracy50: 0.4710 - val_loss: 12.8236 - val_accuracy10: 0.4434 - val_accuracy20: 0.4307 - val_accuracy30: 0.4218 - val_accuracy50: 0.4099 - 121s/epoch - 22ms/step
Epoch 18/50
5452/5452 - 122s - loss: 12.2266 - accuracy10: 0.4982 - accuracy20: 0.4803 - accuracy30: 0.4676 - accuracy50: 0.4718 - val_loss: 12.8352 - val_accuracy10: 0.4421 - val_accuracy20: 0.4298 - val_accuracy30: 0.4210 - val_accuracy50: 0.4092 - 122s/epoch - 22ms/step
Epoch 19/50
5452/5452 - 111s - loss: 12.2170 - accuracy10: 0.4990 - accuracy20: 0.4809 - accuracy30: 0.4683 - accuracy50: 0.4727 - val_loss: 12.8352 - val_accuracy10: 0.4418 - val_accuracy20: 0.4296 - val_accuracy30: 0.4208 - val_accuracy50: 0.4081 - 111s/epoch - 20ms/step
Epoch 20/50
5452/5452 - 120s - loss: 12.2088 - accuracy10: 0.4999 - accuracy20: 0.4820 - accuracy30: 0.4688 - accuracy50: 0.4734 - val_loss: 12.8160 - val_accuracy10: 0.4428 - val_accuracy20: 0.4311 - val_accuracy30: 0.4220 - val_accuracy50: 0.4100 - 120s/epoch - 22ms/step
Epoch 21/50
5452/5452 - 121s - loss: 12.1996 - accuracy10: 0.5005 - accuracy20: 0.4826 - accuracy30: 0.4695 - accuracy50: 0.4739 - val_loss: 12.8144 - val_accuracy10: 0.4430 - val_accuracy20: 0.4313 - val_accuracy30: 0.4215 - val_accuracy50: 0.4092 - 121s/epoch - 22ms/step
Epoch 22/50
5452/5452 - 121s - loss: 12.1935 - accuracy10: 0.5013 - accuracy20: 0.4835 - accuracy30: 0.4703 - accuracy50: 0.4746 - val_loss: 12.8113 - val_accuracy10: 0.4433 - val_accuracy20: 0.4316 - val_accuracy30: 0.4237 - val_accuracy50: 0.4130 - 121s/epoch - 22ms/step
Epoch 23/50
5452/5452 - 121s - loss: 12.1851 - accuracy10: 0.5020 - accuracy20: 0.4840 - accuracy30: 0.4706 - accuracy50: 0.4753 - val_loss: 12.8162 - val_accuracy10: 0.4429 - val_accuracy20: 0.4309 - val_accuracy30: 0.4247 - val_accuracy50: 0.4145 - 121s/epoch - 22ms/step
Epoch 24/50
5452/5452 - 121s - loss: 12.1785 - accuracy10: 0.5028 - accuracy20: 0.4846 - accuracy30: 0.4712 - accuracy50: 0.4759 - val_loss: 12.8172 - val_accuracy10: 0.4420 - val_accuracy20: 0.4296 - val_accuracy30: 0.4232 - val_accuracy50: 0.4130 - 121s/epoch - 22ms/step
Epoch 25/50
5452/5452 - 121s - loss: 12.1703 - accuracy10: 0.5035 - accuracy20: 0.4853 - accuracy30: 0.4717 - accuracy50: 0.4764 - val_loss: 12.8215 - val_accuracy10: 0.4426 - val_accuracy20: 0.4301 - val_accuracy30: 0.4236 - val_accuracy50: 0.4127 - 121s/epoch - 22ms/step
Epoch 26/50
5452/5452 - 119s - loss: 12.1653 - accuracy10: 0.5044 - accuracy20: 0.4862 - accuracy30: 0.4724 - accuracy50: 0.4773 - val_loss: 12.8133 - val_accuracy10: 0.4427 - val_accuracy20: 0.4304 - val_accuracy30: 0.4238 - val_accuracy50: 0.4136 - 119s/epoch - 22ms/step
Epoch 27/50
5452/5452 - 120s - loss: 12.1592 - accuracy10: 0.5049 - accuracy20: 0.4865 - accuracy30: 0.4726 - accuracy50: 0.4773 - val_loss: 12.8308 - val_accuracy10: 0.4419 - val_accuracy20: 0.4290 - val_accuracy30: 0.4229 - val_accuracy50: 0.4129 - 120s/epoch - 22ms/step
Epoch 28/50
5452/5452 - 120s - loss: 12.1522 - accuracy10: 0.5053 - accuracy20: 0.4868 - accuracy30: 0.4733 - accuracy50: 0.4779 - val_loss: 12.8052 - val_accuracy10: 0.4431 - val_accuracy20: 0.4306 - val_accuracy30: 0.4258 - val_accuracy50: 0.4173 - 120s/epoch - 22ms/step
Epoch 29/50
5452/5452 - 121s - loss: 12.1464 - accuracy10: 0.5058 - accuracy20: 0.4874 - accuracy30: 0.4736 - accuracy50: 0.4782 - val_loss: 12.8058 - val_accuracy10: 0.4430 - val_accuracy20: 0.4303 - val_accuracy30: 0.4264 - val_accuracy50: 0.4189 - 121s/epoch - 22ms/step
Epoch 30/50
5452/5452 - 121s - loss: 12.1397 - accuracy10: 0.5063 - accuracy20: 0.4880 - accuracy30: 0.4739 - accuracy50: 0.4788 - val_loss: 12.8137 - val_accuracy10: 0.4437 - val_accuracy20: 0.4310 - val_accuracy30: 0.4263 - val_accuracy50: 0.4199 - 121s/epoch - 22ms/step
Epoch 31/50
5452/5452 - 121s - loss: 12.1349 - accuracy10: 0.5069 - accuracy20: 0.4885 - accuracy30: 0.4744 - accuracy50: 0.4791 - val_loss: 12.8059 - val_accuracy10: 0.4442 - val_accuracy20: 0.4311 - val_accuracy30: 0.4275 - val_accuracy50: 0.4214 - 121s/epoch - 22ms/step
Epoch 32/50
5452/5452 - 116s - loss: 12.1302 - accuracy10: 0.5071 - accuracy20: 0.4885 - accuracy30: 0.4747 - accuracy50: 0.4794 - val_loss: 12.7979 - val_accuracy10: 0.4448 - val_accuracy20: 0.4315 - val_accuracy30: 0.4278 - val_accuracy50: 0.4221 - 116s/epoch - 21ms/step
Epoch 33/50
5452/5452 - 123s - loss: 12.1248 - accuracy10: 0.5077 - accuracy20: 0.4894 - accuracy30: 0.4750 - accuracy50: 0.4799 - val_loss: 12.8005 - val_accuracy10: 0.4451 - val_accuracy20: 0.4307 - val_accuracy30: 0.4277 - val_accuracy50: 0.4217 - 123s/epoch - 22ms/step
Epoch 34/50
5452/5452 - 119s - loss: 12.1208 - accuracy10: 0.5079 - accuracy20: 0.4895 - accuracy30: 0.4756 - accuracy50: 0.4802 - val_loss: 12.8013 - val_accuracy10: 0.4449 - val_accuracy20: 0.4307 - val_accuracy30: 0.4274 - val_accuracy50: 0.4212 - 119s/epoch - 22ms/step
Epoch 35/50
5452/5452 - 117s - loss: 12.1157 - accuracy10: 0.5082 - accuracy20: 0.4897 - accuracy30: 0.4756 - accuracy50: 0.4806 - val_loss: 12.8076 - val_accuracy10: 0.4446 - val_accuracy20: 0.4300 - val_accuracy30: 0.4259 - val_accuracy50: 0.4205 - 117s/epoch - 21ms/step
Epoch 36/50
5452/5452 - 118s - loss: 12.1103 - accuracy10: 0.5087 - accuracy20: 0.4902 - accuracy30: 0.4762 - accuracy50: 0.4809 - val_loss: 12.8072 - val_accuracy10: 0.4456 - val_accuracy20: 0.4305 - val_accuracy30: 0.4266 - val_accuracy50: 0.4203 - 118s/epoch - 22ms/step
Epoch 37/50
5452/5452 - 122s - loss: 12.1058 - accuracy10: 0.5090 - accuracy20: 0.4904 - accuracy30: 0.4765 - accuracy50: 0.4814 - val_loss: 12.7978 - val_accuracy10: 0.4452 - val_accuracy20: 0.4306 - val_accuracy30: 0.4273 - val_accuracy50: 0.4222 - 122s/epoch - 22ms/step
Epoch 38/50
5452/5452 - 120s - loss: 12.1024 - accuracy10: 0.5092 - accuracy20: 0.4908 - accuracy30: 0.4766 - accuracy50: 0.4814 - val_loss: 12.7823 - val_accuracy10: 0.4467 - val_accuracy20: 0.4313 - val_accuracy30: 0.4284 - val_accuracy50: 0.4238 - 120s/epoch - 22ms/step
Epoch 39/50
5452/5452 - 117s - loss: 12.0964 - accuracy10: 0.5095 - accuracy20: 0.4913 - accuracy30: 0.4769 - accuracy50: 0.4821 - val_loss: 12.7992 - val_accuracy10: 0.4453 - val_accuracy20: 0.4298 - val_accuracy30: 0.4271 - val_accuracy50: 0.4225 - 117s/epoch - 22ms/step
Epoch 40/50
5452/5452 - 117s - loss: 12.0925 - accuracy10: 0.5099 - accuracy20: 0.4917 - accuracy30: 0.4775 - accuracy50: 0.4824 - val_loss: 12.7903 - val_accuracy10: 0.4464 - val_accuracy20: 0.4300 - val_accuracy30: 0.4269 - val_accuracy50: 0.4230 - 117s/epoch - 22ms/step
Epoch 41/50
5452/5452 - 119s - loss: 12.0893 - accuracy10: 0.5104 - accuracy20: 0.4920 - accuracy30: 0.4778 - accuracy50: 0.4826 - val_loss: 12.8007 - val_accuracy10: 0.4455 - val_accuracy20: 0.4287 - val_accuracy30: 0.4252 - val_accuracy50: 0.4211 - 119s/epoch - 22ms/step
Epoch 42/50
5452/5452 - 120s - loss: 12.0856 - accuracy10: 0.5107 - accuracy20: 0.4920 - accuracy30: 0.4779 - accuracy50: 0.4825 - val_loss: 12.8206 - val_accuracy10: 0.4455 - val_accuracy20: 0.4290 - val_accuracy30: 0.4252 - val_accuracy50: 0.4212 - 120s/epoch - 22ms/step
Epoch 43/50
5452/5452 - 121s - loss: 12.0825 - accuracy10: 0.5110 - accuracy20: 0.4920 - accuracy30: 0.4782 - accuracy50: 0.4827 - val_loss: 12.8111 - val_accuracy10: 0.4459 - val_accuracy20: 0.4295 - val_accuracy30: 0.4256 - val_accuracy50: 0.4210 - 121s/epoch - 22ms/step
Epoch 44/50
5452/5452 - 121s - loss: 12.0778 - accuracy10: 0.5111 - accuracy20: 0.4927 - accuracy30: 0.4785 - accuracy50: 0.4831 - val_loss: 12.8130 - val_accuracy10: 0.4472 - val_accuracy20: 0.4304 - val_accuracy30: 0.4262 - val_accuracy50: 0.4214 - 121s/epoch - 22ms/step
Epoch 45/50
5452/5452 - 123s - loss: 12.0758 - accuracy10: 0.5112 - accuracy20: 0.4927 - accuracy30: 0.4786 - accuracy50: 0.4832 - val_loss: 12.8095 - val_accuracy10: 0.4467 - val_accuracy20: 0.4294 - val_accuracy30: 0.4261 - val_accuracy50: 0.4208 - 123s/epoch - 23ms/step
Epoch 46/50
5452/5452 - 124s - loss: 12.0692 - accuracy10: 0.5116 - accuracy20: 0.4928 - accuracy30: 0.4788 - accuracy50: 0.4838 - val_loss: 12.8192 - val_accuracy10: 0.4464 - val_accuracy20: 0.4299 - val_accuracy30: 0.4263 - val_accuracy50: 0.4219 - 124s/epoch - 23ms/step
Epoch 47/50
5452/5452 - 121s - loss: 12.0656 - accuracy10: 0.5120 - accuracy20: 0.4933 - accuracy30: 0.4794 - accuracy50: 0.4842 - val_loss: 12.8204 - val_accuracy10: 0.4476 - val_accuracy20: 0.4315 - val_accuracy30: 0.4268 - val_accuracy50: 0.4203 - 121s/epoch - 22ms/step
Epoch 48/50
5452/5452 - 120s - loss: 12.0629 - accuracy10: 0.5123 - accuracy20: 0.4936 - accuracy30: 0.4798 - accuracy50: 0.4843 - val_loss: 12.8163 - val_accuracy10: 0.4482 - val_accuracy20: 0.4314 - val_accuracy30: 0.4276 - val_accuracy50: 0.4204 - 120s/epoch - 22ms/step
testing model: results/AAPL/W6/deepOF_L1/seq2seq
Evaluating performance on  test set...
29350/29350 - 245s - 245s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1760429
{'0': {'precision': 0.49642313640074, 'recall': 0.09801563342165248, 'f1-score': 0.1637081248049141, 'support': 2469453}, '1': {'precision': 0.3474849081291328, 'recall': 0.893219082795483, 'f1-score': 0.5003290925066994, 'support': 2535247}, '2': {'precision': 0.48902146189246654, 'recall': 0.09920042221087504, 'f1-score': 0.1649416208438425, 'support': 2508699}, 'accuracy': 0.36673681245997986, 'macro avg': {'precision': 0.44430983547411307, 'recall': 0.36347837947600353, 'f1-score': 0.27632627938515203, 'support': 7513399}, 'weighted avg': {'precision': 0.44369550010082587, 'recall': 0.36673681245997986, 'f1-score': 0.2777060329131367, 'support': 7513399}}
[[ 242045 2097269  130139]
 [ 140817 2264531  129899]
 [ 104716 2155119  248864]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1005038
{'0': {'precision': 0.4808767165133717, 'recall': 0.1301570787047165, 'f1-score': 0.20486431070856667, 'support': 2322148}, '1': {'precision': 0.400190625184659, 'recall': 0.8465065129006362, 'f1-score': 0.5434583272419672, 'support': 2896175}, '2': {'precision': 0.4518092456446039, 'recall': 0.14936063119478396, 'f1-score': 0.22450397702527025, 'support': 2295076}, 'accuracy': 0.41215287515011517, 'macro avg': {'precision': 0.44429219578087825, 'recall': 0.3753414076000456, 'f1-score': 0.32427553832526806, 'support': 7513399}, 'weighted avg': {'precision': 0.44089573116632136, 'recall': 0.41215287515011517, 'f1-score': 0.34138069332648646, 'support': 7513399}}
[[ 302244 1842183  177721]
 [ 206345 2451631  238199]
 [ 119938 1832344  342794]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0713197
{'0': {'precision': 0.42965769099265205, 'recall': 0.18507463495710652, 'f1-score': 0.25871013109363417, 'support': 2213507}, '1': {'precision': 0.43267654745457773, 'recall': 0.7186958289364922, 'f1-score': 0.5401603100969777, 'support': 3113978}, '2': {'precision': 0.39849193244399345, 'recall': 0.2529358428556659, 'f1-score': 0.30945224206179855, 'support': 2185914}, 'accuracy': 0.4259807046051993, 'macro avg': {'precision': 0.4202753902970744, 'recall': 0.38556876891642156, 'f1-score': 0.36944089441747013, 'support': 7513399}, 'weighted avg': {'precision': 0.4218416525625703, 'recall': 0.4259807046051993, 'f1-score': 0.3901217007796495, 'support': 7513399}}
[[ 409664 1486108  317735]
 [ 359135 2238003  516840]
 [ 184667 1448351  552896]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0792344
{'0': {'precision': 0.3752575715780702, 'recall': 0.23547282029032665, 'f1-score': 0.28936813982503823, 'support': 2212680}, '1': {'precision': 0.42299666489823834, 'recall': 0.5528872679364722, 'f1-score': 0.4792977167325448, 'support': 3112025}, '2': {'precision': 0.36114718846181515, 'recall': 0.33946773738128766, 'f1-score': 0.34997204429013457, 'support': 2188694}, 'accuracy': 0.39723911907247306, 'macro avg': {'precision': 0.38646714164604123, 'recall': 0.3759426085360289, 'f1-score': 0.37287930028257255, 'support': 7513399}, 'weighted avg': {'precision': 0.39092051467818334, 'recall': 0.39723911907247306, 'f1-score': 0.3856905890460782, 'support': 7513399}}
[[ 521026 1199020  492634]
 [ 569743 1720599  821683]
 [ 297680 1148023  742991]]
Evaluating performance on  train set...
5452/5452 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1110189
{'0': {'precision': 0.5420796934172212, 'recall': 0.1560056881709925, 'f1-score': 0.2422841613519387, 'support': 460605}, '1': {'precision': 0.36423797586034984, 'recall': 0.8635890403467851, 'f1-score': 0.512371726438751, 'support': 475453}, '2': {'precision': 0.5418346959989974, 'recall': 0.15997518583415865, 'f1-score': 0.24701876798150094, 'support': 459415}, 'accuracy': 0.3983939495783867, 'macro avg': {'precision': 0.4827174550921895, 'recall': 0.39318997145064544, 'f1-score': 0.33389155192406356, 'support': 1395473}, 'weighted avg': {'precision': 0.48140640656289974, 'recall': 0.3983939495783867, 'f1-score': 0.33586468378980777, 'support': 1395473}}
[[ 71857 358002  30746]
 [ 33457 410596  31400]
 [ 27244 358676  73495]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896857
{'0': {'precision': 0.5144177746249383, 'recall': 0.19972242842849305, 'f1-score': 0.2877327637782827, 'support': 464745}, '1': {'precision': 0.35819275841614406, 'recall': 0.7742141587569762, 'f1-score': 0.4897849013891178, 'support': 466411}, '2': {'precision': 0.5030930724842205, 'recall': 0.22419381586286954, 'f1-score': 0.31016743863141005, 'support': 464317}, 'accuracy': 0.399878034186258, 'macro avg': {'precision': 0.4585678685084343, 'recall': 0.39937680101611295, 'f1-score': 0.36256170126627013, 'support': 1395473}, 'weighted avg': {'precision': 0.4584343784869753, 'recall': 0.399878034186258, 'f1-score': 0.3627296576479504, 'support': 1395473}}
[[ 92820 323823  48102]
 [ 50594 361102  54715]
 [ 37023 323197 104097]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.07561
{'0': {'precision': 0.4813483146067416, 'recall': 0.28150723572301667, 'f1-score': 0.3552521402152823, 'support': 467956}, '1': {'precision': 0.36266821381845366, 'recall': 0.6067700472748041, 'f1-score': 0.45398705224514135, 'support': 460499}, '2': {'precision': 0.4657720222000854, 'recall': 0.3504126179290734, 'f1-score': 0.39993988034722766, 'support': 467018}, 'accuracy': 0.4119026308642303, 'macro avg': {'precision': 0.4365961835417602, 'recall': 0.41289663364229806, 'f1-score': 0.40305969093588373, 'support': 1395473}, 'weighted avg': {'precision': 0.43697162178640214, 'recall': 0.4119026308642303, 'f1-score': 0.4027896470504407, 'support': 1395473}}
[[131733 249122  87101]
 [ 80482 279417 100600]
 [ 61460 241909 163649]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078487
{'0': {'precision': 0.44397467621497905, 'recall': 0.34655177192170844, 'f1-score': 0.3892601217665124, 'support': 469067}, '1': {'precision': 0.3665003674326065, 'recall': 0.45231834602393706, 'f1-score': 0.40491219189283906, 'support': 459789}, '2': {'precision': 0.43289873647928917, 'recall': 0.4285077483246431, 'f1-score': 0.4306920509509414, 'support': 466617}, 'accuracy': 0.40880475652341536, 'macro avg': {'precision': 0.41445792670895826, 'recall': 0.4091259554234295, 'f1-score': 0.40828812153676425, 'support': 1395473}, 'weighted avg': {'precision': 0.41474440323055967, 'recall': 0.40880475652341536, 'f1-score': 0.4082712328174351, 'support': 1395473}}
[[162556 184878 121633]
 [111516 207971 140302]
 [ 92066 174602 199949]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.064404
{'0': {'precision': 0.5149730782449307, 'recall': 0.15018141241088073, 'f1-score': 0.23254562761246536, 'support': 149659}, '1': {'precision': 0.43157982791586996, 'recall': 0.8756158352083172, 'f1-score': 0.5781814339506647, 'support': 206224}, '2': {'precision': 0.5215746007568365, 'recall': 0.14789545077237665, 'f1-score': 0.2304464867820564, 'support': 148179}, 'accuracy': 0.4463022405973868, 'macro avg': {'precision': 0.4893758356392124, 'recall': 0.3912308994638582, 'f1-score': 0.3470578494483955, 'support': 504062}, 'weighted avg': {'precision': 0.4827955233973752, 'recall': 0.4463022405973868, 'f1-score': 0.37333654209754785, 'support': 504062}}
[[ 22476 119314   7869]
 [ 13418 180573  12233]
 [  7751 118513  21915]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637943
{'0': {'precision': 0.49438591284562494, 'recall': 0.19291890779010218, 'f1-score': 0.27753738216115403, 'support': 155428}, '1': {'precision': 0.40983684510852336, 'recall': 0.7979651985165906, 'f1-score': 0.5415383111703752, 'support': 194417}, '2': {'precision': 0.4944277456647399, 'recall': 0.20799263375633037, 'f1-score': 0.29280850053858654, 'support': 154217}, 'accuracy': 0.4308973896068341, 'macro avg': {'precision': 0.4662168345396294, 'recall': 0.39962558002100773, 'f1-score': 0.37062806462337194, 'support': 504062}, 'weighted avg': {'precision': 0.46178808803364024, 'recall': 0.4308973896068341, 'f1-score': 0.38403486595877867, 'support': 504062}}
[[ 29985 112355  13088]
 [ 19568 155138  19711]
 [ 11098 111043  32076]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0613755
{'0': {'precision': 0.4689294358996624, 'recall': 0.2699197150979351, 'f1-score': 0.34262284681026556, 'support': 160055}, '1': {'precision': 0.4035551357543359, 'recall': 0.6467948270586278, 'f1-score': 0.4970102984338872, 'support': 186277}, '2': {'precision': 0.45983824164968823, 'recall': 0.33053952957585747, 'f1-score': 0.38461283100155286, 'support': 157730}, 'accuracy': 0.4281635989223548, 'macro avg': {'precision': 0.4441076044345622, 'recall': 0.4157513572441401, 'f1-score': 0.4080819920819019, 'support': 504062}, 'weighted avg': {'precision': 0.44192545111759307, 'recall': 0.42816359892235484, 'f1-score': 0.4128164173087065, 'support': 504062}}
[[ 43202  91169  25684]
 [ 30235 120483  35559]
 [ 18692  86902  52136]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0680436
{'0': {'precision': 0.44619719219498016, 'recall': 0.33666731640758246, 'f1-score': 0.38377014064165366, 'support': 164168}, '1': {'precision': 0.40778504299929397, 'recall': 0.5162389935710241, 'f1-score': 0.4556473248740044, 'support': 180122}, '2': {'precision': 0.43169959123588714, 'recall': 0.41114838645069224, 'f1-score': 0.4211734383114593, 'support': 159772}, 'accuracy': 0.42444381841916273, 'macro avg': {'precision': 0.42856060881005376, 'recall': 0.4213515654764329, 'f1-score': 0.4201969679423725, 'support': 504062}, 'weighted avg': {'precision': 0.42787566857712833, 'recall': 0.42444381841916273, 'f1-score': 0.4213104865784624, 'support': 504062}}
[[55270 69868 39030]
 [39690 92986 47446]
 [28909 65173 65690]]
training model: results/AAPL/W6/deepLOB_L2/seq2seq
Epoch 1/50
5452/5452 - 272s - loss: 12.2994 - accuracy10: 0.4902 - accuracy20: 0.4680 - accuracy30: 0.4530 - accuracy50: 0.4595 - val_loss: 12.5522 - val_accuracy10: 0.4836 - val_accuracy20: 0.4557 - val_accuracy30: 0.4354 - val_accuracy50: 0.4208 - 272s/epoch - 50ms/step
Epoch 2/50
5452/5452 - 256s - loss: 12.0440 - accuracy10: 0.5203 - accuracy20: 0.4930 - accuracy30: 0.4739 - accuracy50: 0.4751 - val_loss: 12.4980 - val_accuracy10: 0.4979 - val_accuracy20: 0.4658 - val_accuracy30: 0.4411 - val_accuracy50: 0.4222 - 256s/epoch - 47ms/step
Epoch 3/50
5452/5452 - 256s - loss: 11.9395 - accuracy10: 0.5312 - accuracy20: 0.5020 - accuracy30: 0.4818 - accuracy50: 0.4818 - val_loss: 12.2421 - val_accuracy10: 0.5165 - val_accuracy20: 0.4834 - val_accuracy30: 0.4570 - val_accuracy50: 0.4341 - 256s/epoch - 47ms/step
Epoch 4/50
5452/5452 - 255s - loss: 11.8852 - accuracy10: 0.5360 - accuracy20: 0.5062 - accuracy30: 0.4855 - accuracy50: 0.4850 - val_loss: 12.2280 - val_accuracy10: 0.5197 - val_accuracy20: 0.4862 - val_accuracy30: 0.4598 - val_accuracy50: 0.4377 - 255s/epoch - 47ms/step
Epoch 5/50
5452/5452 - 255s - loss: 11.8456 - accuracy10: 0.5393 - accuracy20: 0.5095 - accuracy30: 0.4880 - accuracy50: 0.4873 - val_loss: 12.1421 - val_accuracy10: 0.5244 - val_accuracy20: 0.4920 - val_accuracy30: 0.4679 - val_accuracy50: 0.4585 - 255s/epoch - 47ms/step
Epoch 6/50
5452/5452 - 254s - loss: 11.8114 - accuracy10: 0.5420 - accuracy20: 0.5119 - accuracy30: 0.4901 - accuracy50: 0.4891 - val_loss: 12.7415 - val_accuracy10: 0.4908 - val_accuracy20: 0.4618 - val_accuracy30: 0.4422 - val_accuracy50: 0.4340 - 254s/epoch - 47ms/step
Epoch 7/50
5452/5452 - 256s - loss: 11.7854 - accuracy10: 0.5439 - accuracy20: 0.5136 - accuracy30: 0.4914 - accuracy50: 0.4905 - val_loss: 12.9690 - val_accuracy10: 0.4789 - val_accuracy20: 0.4508 - val_accuracy30: 0.4320 - val_accuracy50: 0.4212 - 256s/epoch - 47ms/step
Epoch 8/50
5452/5452 - 257s - loss: 11.7631 - accuracy10: 0.5451 - accuracy20: 0.5147 - accuracy30: 0.4924 - accuracy50: 0.4917 - val_loss: 12.9805 - val_accuracy10: 0.4867 - val_accuracy20: 0.4558 - val_accuracy30: 0.4392 - val_accuracy50: 0.4409 - 257s/epoch - 47ms/step
Epoch 9/50
5452/5452 - 255s - loss: 11.7459 - accuracy10: 0.5465 - accuracy20: 0.5159 - accuracy30: 0.4937 - accuracy50: 0.4928 - val_loss: 13.2872 - val_accuracy10: 0.4789 - val_accuracy20: 0.4497 - val_accuracy30: 0.4342 - val_accuracy50: 0.4394 - 255s/epoch - 47ms/step
Epoch 10/50
5452/5452 - 256s - loss: 11.7287 - accuracy10: 0.5476 - accuracy20: 0.5170 - accuracy30: 0.4947 - accuracy50: 0.4939 - val_loss: 13.4846 - val_accuracy10: 0.4672 - val_accuracy20: 0.4378 - val_accuracy30: 0.4208 - val_accuracy50: 0.4207 - 256s/epoch - 47ms/step
Epoch 11/50
5452/5452 - 255s - loss: 11.7149 - accuracy10: 0.5488 - accuracy20: 0.5181 - accuracy30: 0.4957 - accuracy50: 0.4947 - val_loss: 13.0611 - val_accuracy10: 0.4988 - val_accuracy20: 0.4679 - val_accuracy30: 0.4473 - val_accuracy50: 0.4612 - 255s/epoch - 47ms/step
Epoch 12/50
5452/5452 - 254s - loss: 11.7028 - accuracy10: 0.5493 - accuracy20: 0.5186 - accuracy30: 0.4965 - accuracy50: 0.4953 - val_loss: 13.0923 - val_accuracy10: 0.4984 - val_accuracy20: 0.4683 - val_accuracy30: 0.4494 - val_accuracy50: 0.4640 - 254s/epoch - 47ms/step
Epoch 13/50
5452/5452 - 254s - loss: 11.6922 - accuracy10: 0.5501 - accuracy20: 0.5192 - accuracy30: 0.4974 - accuracy50: 0.4959 - val_loss: 13.2663 - val_accuracy10: 0.4955 - val_accuracy20: 0.4657 - val_accuracy30: 0.4463 - val_accuracy50: 0.4597 - 254s/epoch - 47ms/step
Epoch 14/50
5452/5452 - 254s - loss: 11.6805 - accuracy10: 0.5509 - accuracy20: 0.5199 - accuracy30: 0.4982 - accuracy50: 0.4963 - val_loss: 13.6393 - val_accuracy10: 0.4911 - val_accuracy20: 0.4595 - val_accuracy30: 0.4397 - val_accuracy50: 0.4476 - 254s/epoch - 47ms/step
Epoch 15/50
5452/5452 - 258s - loss: 11.6720 - accuracy10: 0.5513 - accuracy20: 0.5201 - accuracy30: 0.4987 - accuracy50: 0.4971 - val_loss: 13.4213 - val_accuracy10: 0.4931 - val_accuracy20: 0.4617 - val_accuracy30: 0.4427 - val_accuracy50: 0.4556 - 258s/epoch - 47ms/step
testing model: results/AAPL/W6/deepLOB_L2/seq2seq
Evaluating performance on  test set...
29350/29350 - 468s - 468s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1060601
{'0': {'precision': 0.42957556423254106, 'recall': 0.6471472450398975, 'f1-score': 0.5163792213474094, 'support': 2469455}, '1': {'precision': 0.44074490709188996, 'recall': 0.5293071920380176, 'f1-score': 0.480983339734258, 'support': 2535248}, '2': {'precision': 0.5308018377033784, 'recall': 0.1583799743373164, 'f1-score': 0.2439657575545461, 'support': 2508701}, 'accuracy': 0.44418668289366575, 'macro avg': {'precision': 0.4670407696759365, 'recall': 0.44494480380507717, 'f1-score': 0.4137761062120712, 'support': 7513404}, 'weighted avg': {'precision': 0.4671435570661544, 'recall': 0.44418668289366575, 'f1-score': 0.413477624800944, 'support': 7513404}}
[[1598101  738454  132900]
 [ 975008 1341925  218315]
 [1147077  964296  397328]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.102547
{'0': {'precision': 0.3826884253028264, 'recall': 0.6661054049503283, 'f1-score': 0.4861028376656507, 'support': 2322149}, '1': {'precision': 0.4586600601172083, 'recall': 0.40610535889208427, 'f1-score': 0.4307857465825938, 'support': 2896177}, '2': {'precision': 0.4512434410688302, 'recall': 0.17835995116505846, 'f1-score': 0.25566494432955955, 'support': 2295078}, 'accuracy': 0.41689479229387905, 'macro avg': {'precision': 0.43086397549628824, 'recall': 0.41685690500249034, 'f1-score': 0.3908511761926013, 'support': 7513404}, 'weighted avg': {'precision': 0.4329141831452132, 'recall': 0.41689479229387905, 'f1-score': 0.39438927797104834, 'support': 7513404}}
[[1546796  617916  157437]
 [1379651 1176153  340373]
 [1115473  770255  409350]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1051131
{'0': {'precision': 0.35076384573354724, 'recall': 0.6925740984111652, 'f1-score': 0.46567836543755536, 'support': 2213509}, '1': {'precision': 0.4693785855381993, 'recall': 0.2995808259587968, 'f1-score': 0.3657327610287135, 'support': 3113981}, '2': {'precision': 0.39947463627000407, 'recall': 0.21114691611838343, 'f1-score': 0.2762687860787285, 'support': 2185914}, 'accuracy': 0.3896312510281625, 'macro avg': {'precision': 0.4065390225139169, 'recall': 0.4011006134961152, 'f1-score': 0.3692266375149991, 'support': 7513404}, 'weighted avg': {'precision': 0.41409621080487025, 'recall': 0.3896312510281625, 'f1-score': 0.3691493135700902, 'support': 7513404}}
[[1533019  479581  200909]
 [1688160  932889  492932]
 [1149337  575028  461549]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1075397
{'0': {'precision': 0.34279435873945985, 'recall': 0.716010381966147, 'f1-score': 0.46362527537100456, 'support': 2212683}, '1': {'precision': 0.4838685195687601, 'recall': 0.22535808677629518, 'f1-score': 0.30750026252749413, 'support': 3112025}, '2': {'precision': 0.36184650713563143, 'recall': 0.23844334708886022, 'f1-score': 0.28746077144781074, 'support': 2188696}, 'accuracy': 0.3736660507008541, 'macro avg': {'precision': 0.3961697951479504, 'recall': 0.39327060527710084, 'f1-score': 0.3528621031154365, 'support': 7513404}, 'weighted avg': {'precision': 0.4067767662262541, 'recall': 0.3736660507008541, 'f1-score': 0.34764116375222237, 'support': 7513404}}
[[1584304  348817  279562]
 [1769878  701320  640827]
 [1267551  399265  521880]]
Evaluating performance on  train set...
5452/5452 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99484324
{'0': {'precision': 0.48788053311209834, 'recall': 0.5720666533487359, 'f1-score': 0.5266303592792227, 'support': 460532}, '1': {'precision': 0.5022283540722096, 'recall': 0.6016899074504394, 'f1-score': 0.5474784545440629, 'support': 475529}, '2': {'precision': 0.537503543021909, 'recall': 0.3343476689870139, 'f1-score': 0.41225625245743686, 'support': 459414}, 'accuracy': 0.5039001056987764, 'macro avg': {'precision': 0.5092041434020723, 'recall': 0.5027014099287297, 'f1-score': 0.4954550220935741, 'support': 1395475}, 'weighted avg': {'precision': 0.5091065030707479, 'recall': 0.5039001056987764, 'f1-score': 0.4960807671917759, 'support': 1395475}}
[[263455 136165  60912]
 [118151 286121  71257]
 [158393 147417 153604]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0214254
{'0': {'precision': 0.4635395053442832, 'recall': 0.583968348902151, 'f1-score': 0.5168312552301654, 'support': 464818}, '1': {'precision': 0.47773562907463674, 'recall': 0.4883969704570254, 'f1-score': 0.4830074754387528, 'support': 466473}, '2': {'precision': 0.5005029833670157, 'recall': 0.3590688175378729, 'f1-score': 0.41815009338971415, 'support': 464184}, 'accuracy': 0.47721170210860103, 'macro avg': {'precision': 0.48059270592864517, 'recall': 0.47714471229901645, 'f1-score': 0.4726629413528774, 'support': 1395475}, 'weighted avg': {'precision': 0.48058027175527096, 'recall': 0.47721170210860103, 'f1-score': 0.47269997630479044, 'support': 1395475}}
[[271439 120220  73159]
 [145469 227824  93180]
 [168671 128839 166674]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0378385
{'0': {'precision': 0.44318071184279534, 'recall': 0.6033202720006499, 'f1-score': 0.5109979096865073, 'support': 467793}, '1': {'precision': 0.46721634789326644, 'recall': 0.3728057894382691, 'f1-score': 0.4147056408968644, 'support': 460701}, '2': {'precision': 0.4706604405664865, 'recall': 0.3941231013681499, 'f1-score': 0.429004816887193, 'support': 466981}, 'accuracy': 0.4572127770114119, 'macro avg': {'precision': 0.46035250010084944, 'recall': 0.4567497209356896, 'f1-score': 0.45156945582352154, 'support': 1395475}, 'weighted avg': {'precision': 0.46031161907023127, 'recall': 0.4572127770114119, 'f1-score': 0.45176993283835604, 'support': 1395475}}
[[282229  95425  90139]
 [172094 171752 116855]
 [182503 100430 184048]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0516392
{'0': {'precision': 0.42344989845078407, 'recall': 0.611922820967852, 'f1-score': 0.5005321301956844, 'support': 468832}, '1': {'precision': 0.49037112059610793, 'recall': 0.29468934020524434, 'f1-score': 0.36814270798115944, 'support': 460037}, '2': {'precision': 0.4376991739730154, 'recall': 0.41415884064928443, 'f1-score': 0.4256037492966215, 'support': 466606}, 'accuracy': 0.4412160733800319, 'macro avg': {'precision': 0.4505067310066358, 'recall': 0.44025700060746026, 'f1-score': 0.43142619582448843, 'support': 1395475}, 'weighted avg': {'precision': 0.4502759152023522, 'recall': 0.4412160733800319, 'f1-score': 0.4318343285689325, 'support': 1395475}}
[[286889  69466 112477]
 [188684 135568 135785]
 [201931  71426 193249]]
Evaluating performance on  val set...
1969/1969 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9695871
{'0': {'precision': 0.5054890219560878, 'recall': 0.43311421089198865, 'f1-score': 0.46651123967417896, 'support': 149688}, '1': {'precision': 0.5407000273658975, 'recall': 0.6802061715704338, 'f1-score': 0.6024828048264592, 'support': 206236}, '2': {'precision': 0.5071244413887934, 'recall': 0.3983353472076901, 'f1-score': 0.446194503570902, 'support': 148139}, 'accuracy': 0.5239900567984558, 'macro avg': {'precision': 0.5177711635702595, 'recall': 0.5038852432233708, 'f1-score': 0.5050628493571802, 'support': 504063}, 'weighted avg': {'precision': 0.5203761418419734, 'recall': 0.5239900567984558, 'f1-score': 0.5161727517096633, 'support': 504063}}
[[ 64832  58558  26298]
 [ 34900 140283  31053]
 [ 28524  60606  59009]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0061052
{'0': {'precision': 0.477980815889708, 'recall': 0.46263816864617247, 'f1-score': 0.4701843635876193, 'support': 155426}, '1': {'precision': 0.5076761657325061, 'recall': 0.5743775533800971, 'f1-score': 0.5389710119419323, 'support': 194595}, '2': {'precision': 0.4807363783492178, 'recall': 0.41651627478220227, 'f1-score': 0.44632807663144425, 'support': 154042}, 'accuracy': 0.4916806034166364, 'macro avg': {'precision': 0.48879778665714396, 'recall': 0.48451066560282396, 'f1-score': 0.48516115072033195, 'support': 504063}, 'weighted avg': {'precision': 0.4902868946041685, 'recall': 0.4916806034166364, 'f1-score': 0.4894491532690766, 'support': 504063}}
[[ 71906  51887  31633]
 [ 45154 111771  37670]
 [ 33377  56504  64161]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0286856
{'0': {'precision': 0.4543752819124944, 'recall': 0.5035396737126897, 'f1-score': 0.477695811833327, 'support': 160043}, '1': {'precision': 0.4919530230535015, 'recall': 0.45519917143823085, 'f1-score': 0.47286298819305855, 'support': 186347}, '2': {'precision': 0.4559302039176033, 'recall': 0.44611315824522907, 'f1-score': 0.45096826104099685, 'support': 157673}, 'accuracy': 0.467705425710675, 'macro avg': {'precision': 0.46741950296119966, 'recall': 0.4682840011320499, 'f1-score': 0.4671756870224608, 'support': 504063}, 'weighted avg': {'precision': 0.46875377933387785, 'recall': 0.467705425710675, 'f1-score': 0.4675486768462873, 'support': 504063}}
[[80588 40987 38468]
 [56052 84825 45470]
 [40720 46613 70340]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0415441
{'0': {'precision': 0.4256186159911128, 'recall': 0.5279019149986892, 'f1-score': 0.47127434625359566, 'support': 164021}, '1': {'precision': 0.5263263433106331, 'recall': 0.37846471234152995, 'f1-score': 0.44031369866990994, 'support': 180318}, '2': {'precision': 0.44777263049530897, 'recall': 0.4792830131977662, 'f1-score': 0.46299230694793886, 'support': 159724}, 'accuracy': 0.45903785836294275, 'macro avg': {'precision': 0.4665725299323516, 'recall': 0.46188321351266176, 'f1-score': 0.45819345062381484, 'support': 504063}, 'weighted avg': {'precision': 0.4686647109980256, 'recall': 0.45903785836294275, 'f1-score': 0.457574466482512, 'support': 504063}}
[[86587 28748 48686]
 [66349 68244 45725]
 [50502 32669 76553]]
training model: results/AAPL/W6/deepOF_L2/seq2seq
Epoch 1/50
5452/5452 - 165s - loss: 12.1170 - accuracy10: 0.5162 - accuracy20: 0.4900 - accuracy30: 0.4715 - accuracy50: 0.4729 - val_loss: 12.5330 - val_accuracy10: 0.4828 - val_accuracy20: 0.4528 - val_accuracy30: 0.4305 - val_accuracy50: 0.4077 - 165s/epoch - 30ms/step
Epoch 2/50
5452/5452 - 158s - loss: 11.9134 - accuracy10: 0.5351 - accuracy20: 0.5051 - accuracy30: 0.4837 - accuracy50: 0.4805 - val_loss: 12.4496 - val_accuracy10: 0.4943 - val_accuracy20: 0.4636 - val_accuracy30: 0.4397 - val_accuracy50: 0.4150 - 158s/epoch - 29ms/step
Epoch 3/50
5452/5452 - 152s - loss: 11.8366 - accuracy10: 0.5413 - accuracy20: 0.5108 - accuracy30: 0.4889 - accuracy50: 0.4854 - val_loss: 12.1905 - val_accuracy10: 0.5116 - val_accuracy20: 0.4819 - val_accuracy30: 0.4598 - val_accuracy50: 0.4369 - 152s/epoch - 28ms/step
Epoch 4/50
5452/5452 - 162s - loss: 11.7940 - accuracy10: 0.5448 - accuracy20: 0.5137 - accuracy30: 0.4913 - accuracy50: 0.4888 - val_loss: 12.0993 - val_accuracy10: 0.5194 - val_accuracy20: 0.4896 - val_accuracy30: 0.4688 - val_accuracy50: 0.4472 - 162s/epoch - 30ms/step
Epoch 5/50
5452/5452 - 154s - loss: 11.7655 - accuracy10: 0.5468 - accuracy20: 0.5153 - accuracy30: 0.4931 - accuracy50: 0.4905 - val_loss: 12.0839 - val_accuracy10: 0.5210 - val_accuracy20: 0.4910 - val_accuracy30: 0.4708 - val_accuracy50: 0.4481 - 154s/epoch - 28ms/step
Epoch 6/50
5452/5452 - 151s - loss: 11.7425 - accuracy10: 0.5483 - accuracy20: 0.5169 - accuracy30: 0.4945 - accuracy50: 0.4923 - val_loss: 12.1373 - val_accuracy10: 0.5202 - val_accuracy20: 0.4889 - val_accuracy30: 0.4680 - val_accuracy50: 0.4488 - 151s/epoch - 28ms/step
Epoch 7/50
5452/5452 - 155s - loss: 11.7242 - accuracy10: 0.5501 - accuracy20: 0.5183 - accuracy30: 0.4958 - accuracy50: 0.4933 - val_loss: 12.0772 - val_accuracy10: 0.5245 - val_accuracy20: 0.4925 - val_accuracy30: 0.4709 - val_accuracy50: 0.4505 - 155s/epoch - 28ms/step
Epoch 8/50
5452/5452 - 153s - loss: 11.7078 - accuracy10: 0.5510 - accuracy20: 0.5194 - accuracy30: 0.4967 - accuracy50: 0.4943 - val_loss: 12.0891 - val_accuracy10: 0.5247 - val_accuracy20: 0.4929 - val_accuracy30: 0.4703 - val_accuracy50: 0.4496 - 153s/epoch - 28ms/step
Epoch 9/50
5452/5452 - 152s - loss: 11.6942 - accuracy10: 0.5517 - accuracy20: 0.5204 - accuracy30: 0.4976 - accuracy50: 0.4954 - val_loss: 12.0639 - val_accuracy10: 0.5275 - val_accuracy20: 0.4943 - val_accuracy30: 0.4709 - val_accuracy50: 0.4494 - 152s/epoch - 28ms/step
Epoch 10/50
5452/5452 - 151s - loss: 11.6819 - accuracy10: 0.5528 - accuracy20: 0.5212 - accuracy30: 0.4983 - accuracy50: 0.4958 - val_loss: 12.0377 - val_accuracy10: 0.5283 - val_accuracy20: 0.4968 - val_accuracy30: 0.4738 - val_accuracy50: 0.4511 - 151s/epoch - 28ms/step
Epoch 11/50
5452/5452 - 152s - loss: 11.6697 - accuracy10: 0.5535 - accuracy20: 0.5219 - accuracy30: 0.4994 - accuracy50: 0.4967 - val_loss: 12.0125 - val_accuracy10: 0.5305 - val_accuracy20: 0.4980 - val_accuracy30: 0.4748 - val_accuracy50: 0.4522 - 152s/epoch - 28ms/step
Epoch 12/50
5452/5452 - 151s - loss: 11.6580 - accuracy10: 0.5543 - accuracy20: 0.5229 - accuracy30: 0.5002 - accuracy50: 0.4976 - val_loss: 11.9849 - val_accuracy10: 0.5337 - val_accuracy20: 0.5007 - val_accuracy30: 0.4758 - val_accuracy50: 0.4536 - 151s/epoch - 28ms/step
Epoch 13/50
5452/5452 - 152s - loss: 11.6477 - accuracy10: 0.5547 - accuracy20: 0.5233 - accuracy30: 0.5007 - accuracy50: 0.4979 - val_loss: 11.9786 - val_accuracy10: 0.5338 - val_accuracy20: 0.5015 - val_accuracy30: 0.4772 - val_accuracy50: 0.4546 - 152s/epoch - 28ms/step
Epoch 14/50
5452/5452 - 151s - loss: 11.6380 - accuracy10: 0.5556 - accuracy20: 0.5240 - accuracy30: 0.5015 - accuracy50: 0.4985 - val_loss: 11.9698 - val_accuracy10: 0.5352 - val_accuracy20: 0.5015 - val_accuracy30: 0.4772 - val_accuracy50: 0.4533 - 151s/epoch - 28ms/step
Epoch 15/50
5452/5452 - 153s - loss: 11.6282 - accuracy10: 0.5563 - accuracy20: 0.5246 - accuracy30: 0.5022 - accuracy50: 0.4991 - val_loss: 11.9802 - val_accuracy10: 0.5353 - val_accuracy20: 0.5022 - val_accuracy30: 0.4764 - val_accuracy50: 0.4520 - 153s/epoch - 28ms/step
Epoch 16/50
5452/5452 - 154s - loss: 11.6201 - accuracy10: 0.5568 - accuracy20: 0.5251 - accuracy30: 0.5029 - accuracy50: 0.4997 - val_loss: 11.9743 - val_accuracy10: 0.5355 - val_accuracy20: 0.5021 - val_accuracy30: 0.4757 - val_accuracy50: 0.4518 - 154s/epoch - 28ms/step
Epoch 17/50
5452/5452 - 152s - loss: 11.6112 - accuracy10: 0.5574 - accuracy20: 0.5253 - accuracy30: 0.5032 - accuracy50: 0.5000 - val_loss: 11.9366 - val_accuracy10: 0.5394 - val_accuracy20: 0.5051 - val_accuracy30: 0.4785 - val_accuracy50: 0.4522 - 152s/epoch - 28ms/step
Epoch 18/50
5452/5452 - 159s - loss: 11.6019 - accuracy10: 0.5580 - accuracy20: 0.5261 - accuracy30: 0.5041 - accuracy50: 0.5010 - val_loss: 11.9657 - val_accuracy10: 0.5374 - val_accuracy20: 0.5036 - val_accuracy30: 0.4766 - val_accuracy50: 0.4527 - 159s/epoch - 29ms/step
Epoch 19/50
5452/5452 - 154s - loss: 11.5931 - accuracy10: 0.5585 - accuracy20: 0.5268 - accuracy30: 0.5049 - accuracy50: 0.5012 - val_loss: 11.9106 - val_accuracy10: 0.5421 - val_accuracy20: 0.5073 - val_accuracy30: 0.4801 - val_accuracy50: 0.4529 - 154s/epoch - 28ms/step
Epoch 20/50
5452/5452 - 152s - loss: 11.5866 - accuracy10: 0.5591 - accuracy20: 0.5273 - accuracy30: 0.5051 - accuracy50: 0.5019 - val_loss: 11.9169 - val_accuracy10: 0.5415 - val_accuracy20: 0.5067 - val_accuracy30: 0.4795 - val_accuracy50: 0.4532 - 152s/epoch - 28ms/step
Epoch 21/50
5452/5452 - 153s - loss: 11.5790 - accuracy10: 0.5594 - accuracy20: 0.5278 - accuracy30: 0.5062 - accuracy50: 0.5024 - val_loss: 11.9479 - val_accuracy10: 0.5388 - val_accuracy20: 0.5044 - val_accuracy30: 0.4779 - val_accuracy50: 0.4509 - 153s/epoch - 28ms/step
Epoch 22/50
5452/5452 - 153s - loss: 11.5720 - accuracy10: 0.5596 - accuracy20: 0.5280 - accuracy30: 0.5065 - accuracy50: 0.5029 - val_loss: 11.9502 - val_accuracy10: 0.5404 - val_accuracy20: 0.5058 - val_accuracy30: 0.4777 - val_accuracy50: 0.4495 - 153s/epoch - 28ms/step
Epoch 23/50
5452/5452 - 154s - loss: 11.5642 - accuracy10: 0.5600 - accuracy20: 0.5286 - accuracy30: 0.5070 - accuracy50: 0.5033 - val_loss: 11.9570 - val_accuracy10: 0.5397 - val_accuracy20: 0.5048 - val_accuracy30: 0.4771 - val_accuracy50: 0.4504 - 154s/epoch - 28ms/step
Epoch 24/50
5452/5452 - 156s - loss: 11.5562 - accuracy10: 0.5606 - accuracy20: 0.5291 - accuracy30: 0.5074 - accuracy50: 0.5038 - val_loss: 11.9342 - val_accuracy10: 0.5426 - val_accuracy20: 0.5052 - val_accuracy30: 0.4762 - val_accuracy50: 0.4473 - 156s/epoch - 29ms/step
Epoch 25/50
5452/5452 - 153s - loss: 11.5515 - accuracy10: 0.5607 - accuracy20: 0.5292 - accuracy30: 0.5076 - accuracy50: 0.5039 - val_loss: 11.9602 - val_accuracy10: 0.5403 - val_accuracy20: 0.5049 - val_accuracy30: 0.4765 - val_accuracy50: 0.4476 - 153s/epoch - 28ms/step
Epoch 26/50
5452/5452 - 152s - loss: 11.5443 - accuracy10: 0.5612 - accuracy20: 0.5302 - accuracy30: 0.5086 - accuracy50: 0.5048 - val_loss: 11.9568 - val_accuracy10: 0.5406 - val_accuracy20: 0.5040 - val_accuracy30: 0.4751 - val_accuracy50: 0.4470 - 152s/epoch - 28ms/step
Epoch 27/50
5452/5452 - 152s - loss: 11.5383 - accuracy10: 0.5614 - accuracy20: 0.5302 - accuracy30: 0.5091 - accuracy50: 0.5054 - val_loss: 11.9500 - val_accuracy10: 0.5416 - val_accuracy20: 0.5057 - val_accuracy30: 0.4756 - val_accuracy50: 0.4467 - 152s/epoch - 28ms/step
Epoch 28/50
5452/5452 - 154s - loss: 11.5315 - accuracy10: 0.5618 - accuracy20: 0.5308 - accuracy30: 0.5094 - accuracy50: 0.5058 - val_loss: 11.9907 - val_accuracy10: 0.5393 - val_accuracy20: 0.5018 - val_accuracy30: 0.4717 - val_accuracy50: 0.4438 - 154s/epoch - 28ms/step
Epoch 29/50
5452/5452 - 152s - loss: 11.5236 - accuracy10: 0.5617 - accuracy20: 0.5310 - accuracy30: 0.5101 - accuracy50: 0.5062 - val_loss: 11.9918 - val_accuracy10: 0.5396 - val_accuracy20: 0.5025 - val_accuracy30: 0.4718 - val_accuracy50: 0.4431 - 152s/epoch - 28ms/step
testing model: results/AAPL/W6/deepOF_L2/seq2seq
Evaluating performance on  test set...
29350/29350 - 297s - 297s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0034562
{'0': {'precision': 0.496581941640668, 'recall': 0.47335907992579734, 'f1-score': 0.4846925035156583, 'support': 2469453}, '1': {'precision': 0.48665743201766365, 'recall': 0.597267248516614, 'f1-score': 0.5363187140421594, 'support': 2535247}, '2': {'precision': 0.524115937754674, 'recall': 0.4278588224414328, 'f1-score': 0.4711209526275825, 'support': 2508699}, 'accuracy': 0.4999770410169885, 'macro avg': {'precision': 0.5024517704710019, 'recall': 0.4994950502946147, 'f1-score': 0.4973773900618001, 'support': 7513399}, 'weighted avg': {'precision': 0.5024266232912787, 'recall': 0.4999770410169885, 'f1-score': 0.4975812452445769, 'support': 7513399}}
[[1168938  788332  512183]
 [ 558618 1514220  462409]
 [ 626412  808918 1073369]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0284919
{'0': {'precision': 0.44017011612051854, 'recall': 0.49642356990166003, 'f1-score': 0.46660750263354156, 'support': 2322148}, '1': {'precision': 0.5104300108830337, 'recall': 0.43708339447719835, 'f1-score': 0.4709178372309568, 'support': 2896175}, '2': {'precision': 0.4460178713799066, 'recall': 0.4692214985473248, 'f1-score': 0.4573255497180092, 'support': 2295076}, 'accuracy': 0.4652405655549506, 'macro avg': {'precision': 0.4655393327944863, 'recall': 0.46757615430872773, 'f1-score': 0.4649502965275025, 'support': 7513399}, 'weighted avg': {'precision': 0.46903933941925763, 'recall': 0.4652405655549506, 'f1-score': 0.4654336924755959, 'support': 7513399}}
[[1152769  608023  561356]
 [ 854085 1265870  776220]
 [ 612063  606114 1076899]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0552001
{'0': {'precision': 0.3986726788085864, 'recall': 0.5195438731388696, 'f1-score': 0.4511527203981708, 'support': 2213507}, '1': {'precision': 0.5185159010600706, 'recall': 0.30629953069674865, 'f1-score': 0.3851071913512082, 'support': 3113978}, '2': {'precision': 0.3989471163291617, 'recall': 0.5090685177916423, 'f1-score': 0.44733022110039267, 'support': 2185914}, 'accuracy': 0.42811569038194297, 'macro avg': {'precision': 0.4387118987326062, 'recall': 0.44497064054242025, 'f1-score': 0.42786337761659055, 'support': 7513399}, 'weighted avg': {'precision': 0.4484223399617586, 'recall': 0.42811569038194297, 'f1-score': 0.4226676127683742, 'support': 7513399}}
[[1150014  446551  616942]
 [1100598  953810 1059570]
 [ 633995  439139 1112780]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0846214
{'0': {'precision': 0.37489617576972467, 'recall': 0.5230241155521811, 'f1-score': 0.43674197509712004, 'support': 2212680}, '1': {'precision': 0.4833840768854405, 'recall': 0.21238486194680312, 'f1-score': 0.2951079150181789, 'support': 3112025}, '2': {'precision': 0.3685271375605648, 'recall': 0.5150870793267583, 'f1-score': 0.4296525866399178, 'support': 2188694}, 'accuracy': 0.39204626294969824, 'macro avg': {'precision': 0.40893579673857666, 'recall': 0.4168320189419142, 'f1-score': 0.3871674922517389, 'support': 7513399}, 'weighted avg': {'precision': 0.417976169891623, 'recall': 0.39204626294969824, 'f1-score': 0.37601243873187246, 'support': 7513399}}
[[1157285  356163  699232]
 [1218560  660947 1232518]
 [ 711103  350223 1127368]]
Evaluating performance on  train set...
5452/5452 - 57s - 57s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95463616
{'0': {'precision': 0.5416983734424047, 'recall': 0.49455607299095755, 'f1-score': 0.5170549014044545, 'support': 460605}, '1': {'precision': 0.5240919107414164, 'recall': 0.6217733403722345, 'f1-score': 0.5687691073397196, 'support': 475453}, '2': {'precision': 0.5390475170607762, 'recall': 0.48210441539784293, 'f1-score': 0.5089882902312884, 'support': 459415}, 'accuracy': 0.533801083933548, 'macro avg': {'precision': 0.5349459337481991, 'recall': 0.5328112762536783, 'f1-score': 0.5316040996584875, 'support': 1395473}, 'weighted avg': {'precision': 0.5348269479865637, 'recall': 0.533801083933548, 'f1-score': 0.5320188255953342, 'support': 1395473}}
[[227795 131811 100999]
 [ 91430 295624  88399]
 [101295 136634 221486]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.989391
{'0': {'precision': 0.5070828642988315, 'recall': 0.5127478509720385, 'f1-score': 0.5098996236153045, 'support': 464745}, '1': {'precision': 0.5126794567000239, 'recall': 0.47714998145412524, 'f1-score': 0.49427706194010207, 'support': 466411}, '2': {'precision': 0.49890934544448245, 'recall': 0.528061647538212, 'f1-score': 0.5130717278829001, 'support': 464317}, 'accuracy': 0.5059452959677472, 'macro avg': {'precision': 0.506223888814446, 'recall': 0.5059864933214585, 'f1-score': 0.5057494711461022, 'support': 1395473}, 'weighted avg': {'precision': 0.5062338392761602, 'recall': 0.5059452959677472, 'f1-score': 0.5057335289103008, 'support': 1395473}}
[[238297 104848 121600]
 [119203 222548 124660]
 [112437 106692 245188]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0123792
{'0': {'precision': 0.4815571585597776, 'recall': 0.5308298216071596, 'f1-score': 0.5049944449696226, 'support': 467956}, '1': {'precision': 0.5165267352908457, 'recall': 0.3428107335737971, 'f1-score': 0.4121102953173438, 'support': 460499}, '2': {'precision': 0.46806501628891484, 'recall': 0.5752968836318942, 'f1-score': 0.5161705544903692, 'support': 467018}, 'accuracy': 0.4836661117771537, 'macro avg': {'precision': 0.48871630337984606, 'recall': 0.4829791462709503, 'f1-score': 0.4777584315924452, 'support': 1395473}, 'weighted avg': {'precision': 0.4885815738053798, 'recall': 0.4836661117771537, 'f1-score': 0.47808341644053987, 'support': 1395473}}
[[248405  73179 146372]
 [143671 157864 158964]
 [123761  74583 268674]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0368512
{'0': {'precision': 0.44947716777647784, 'recall': 0.5258246689705308, 'f1-score': 0.4846626429909737, 'support': 469067}, '1': {'precision': 0.5191898609990897, 'recall': 0.23940329150980125, 'f1-score': 0.3277007213434911, 'support': 459789}, '2': {'precision': 0.4377613365305537, 'recall': 0.5954669461249804, 'f1-score': 0.504578534233453, 'support': 466617}, 'accuracy': 0.4547397190773308, 'macro avg': {'precision': 0.4688094551020405, 'recall': 0.4535649688684375, 'f1-score': 0.4389806328559726, 'support': 1395473}, 'weighted avg': {'precision': 0.4685290043047748, 'recall': 0.4547397190773308, 'f1-score': 0.43960532438396205, 'support': 1395473}}
[[246647  51080 171340]
 [164191 110075 185523]
 [137904  50858 277855]]
Evaluating performance on  val set...
1969/1969 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9391494
{'0': {'precision': 0.533762583344228, 'recall': 0.4364856106214795, 'f1-score': 0.4802476079149252, 'support': 149659}, '1': {'precision': 0.5488203348581472, 'recall': 0.7085984172550237, 'f1-score': 0.6185580101844288, 'support': 206224}, '2': {'precision': 0.5329936923823386, 'recall': 0.41514654573185134, 'f1-score': 0.4667463343386635, 'support': 148179}, 'accuracy': 0.541540524776714, 'macro avg': {'precision': 0.5385255368615712, 'recall': 0.5200768578694515, 'f1-score': 0.5218506508126725, 'support': 504062}, 'weighted avg': {'precision': 0.5396970442922159, 'recall': 0.541540524776714, 'f1-score': 0.5328647843344316, 'support': 504062}}
[[ 65324  59428  24907]
 [ 31101 146130  28993]
 [ 25959  60704  61516]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9815898
{'0': {'precision': 0.49841312990587516, 'recall': 0.47185191857323006, 'f1-score': 0.4847689648448474, 'support': 155428}, '1': {'precision': 0.5250502058559918, 'recall': 0.5634641003615939, 'f1-score': 0.5435793359764599, 'support': 194417}, '2': {'precision': 0.493066983193504, 'recall': 0.47407224884416116, 'f1-score': 0.4833830865507632, 'support': 154217}, 'accuracy': 0.5078660958374168, 'macro avg': {'precision': 0.5055101063184569, 'recall': 0.503129422592995, 'f1-score': 0.5039104624573568, 'support': 504062}, 'weighted avg': {'precision': 0.5070514198135693, 'recall': 0.5078660958374168, 'f1-score': 0.5070281510787152, 'support': 504062}}
[[ 73339  49073  33016]
 [ 42720 109547  42150]
 [ 31086  50021  73110]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0101701
{'0': {'precision': 0.47154598148628774, 'recall': 0.510818156258786, 'f1-score': 0.4903970729366602, 'support': 160055}, '1': {'precision': 0.5150975104015613, 'recall': 0.4080750709964193, 'f1-score': 0.4553827905263127, 'support': 186277}, '2': {'precision': 0.45888379764394904, 'recall': 0.5327014518480948, 'f1-score': 0.4930449809730865, 'support': 157730}, 'accuracy': 0.4796969420428439, 'macro avg': {'precision': 0.4818424298439327, 'recall': 0.48386489303443336, 'f1-score': 0.47960828147868645, 'support': 504062}, 'weighted avg': {'precision': 0.483678302300589, 'recall': 0.4796969420428439, 'f1-score': 0.4782860608985244, 'support': 504062}}
[[81759 35267 43029]
 [54211 76015 56051]
 [37415 36292 84023]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.036991
{'0': {'precision': 0.44475634288529436, 'recall': 0.5279165245358414, 'f1-score': 0.48278147908821495, 'support': 164168}, '1': {'precision': 0.5217541156435002, 'recall': 0.2857507689232853, 'f1-score': 0.3692649854718944, 'support': 180122}, '2': {'precision': 0.4294371883163144, 'recall': 0.5659189344816363, 'f1-score': 0.4883209747192983, 'support': 159772}, 'accuracy': 0.45342636421710025, 'macro avg': {'precision': 0.46531588228170295, 'recall': 0.4598620759802543, 'f1-score': 0.4467891464264692, 'support': 504062}, 'weighted avg': {'precision': 0.46741510482521137, 'recall': 0.45342636421710025, 'f1-score': 0.44397323413582923, 'support': 504062}}
[[86667 23347 54154]
 [62674 51470 65978]
 [45523 23831 90418]]
training model: results/AAPL/W6/deepVOL_L2/seq2seq
Epoch 1/50
5452/5452 - 158s - loss: 12.3388 - accuracy10: 0.4878 - accuracy20: 0.4667 - accuracy30: 0.4520 - accuracy50: 0.4593 - val_loss: 13.1586 - val_accuracy10: 0.4215 - val_accuracy20: 0.4108 - val_accuracy30: 0.3983 - val_accuracy50: 0.3830 - 158s/epoch - 29ms/step
Epoch 2/50
5452/5452 - 146s - loss: 12.1253 - accuracy10: 0.5128 - accuracy20: 0.4871 - accuracy30: 0.4686 - accuracy50: 0.4695 - val_loss: 12.7544 - val_accuracy10: 0.4672 - val_accuracy20: 0.4425 - val_accuracy30: 0.4204 - val_accuracy50: 0.3966 - 146s/epoch - 27ms/step
Epoch 3/50
5452/5452 - 146s - loss: 12.0289 - accuracy10: 0.5238 - accuracy20: 0.4961 - accuracy30: 0.4761 - accuracy50: 0.4742 - val_loss: 12.5124 - val_accuracy10: 0.4936 - val_accuracy20: 0.4621 - val_accuracy30: 0.4360 - val_accuracy50: 0.4075 - 146s/epoch - 27ms/step
Epoch 4/50
5452/5452 - 147s - loss: 11.9509 - accuracy10: 0.5322 - accuracy20: 0.5034 - accuracy30: 0.4819 - accuracy50: 0.4781 - val_loss: 12.3991 - val_accuracy10: 0.5047 - val_accuracy20: 0.4721 - val_accuracy30: 0.4456 - val_accuracy50: 0.4162 - 147s/epoch - 27ms/step
Epoch 5/50
5452/5452 - 146s - loss: 11.8960 - accuracy10: 0.5367 - accuracy20: 0.5078 - accuracy30: 0.4861 - accuracy50: 0.4828 - val_loss: 12.2589 - val_accuracy10: 0.5140 - val_accuracy20: 0.4800 - val_accuracy30: 0.4551 - val_accuracy50: 0.4255 - 146s/epoch - 27ms/step
Epoch 6/50
5452/5452 - 146s - loss: 11.8568 - accuracy10: 0.5398 - accuracy20: 0.5105 - accuracy30: 0.4885 - accuracy50: 0.4859 - val_loss: 12.2211 - val_accuracy10: 0.5159 - val_accuracy20: 0.4837 - val_accuracy30: 0.4601 - val_accuracy50: 0.4322 - 146s/epoch - 27ms/step
Epoch 7/50
5452/5452 - 146s - loss: 11.8252 - accuracy10: 0.5420 - accuracy20: 0.5123 - accuracy30: 0.4900 - accuracy50: 0.4882 - val_loss: 12.1964 - val_accuracy10: 0.5159 - val_accuracy20: 0.4847 - val_accuracy30: 0.4622 - val_accuracy50: 0.4357 - 146s/epoch - 27ms/step
Epoch 8/50
5452/5452 - 148s - loss: 11.7991 - accuracy10: 0.5439 - accuracy20: 0.5140 - accuracy30: 0.4914 - accuracy50: 0.4904 - val_loss: 12.1380 - val_accuracy10: 0.5188 - val_accuracy20: 0.4890 - val_accuracy30: 0.4670 - val_accuracy50: 0.4407 - 148s/epoch - 27ms/step
Epoch 9/50
5452/5452 - 147s - loss: 11.7796 - accuracy10: 0.5449 - accuracy20: 0.5151 - accuracy30: 0.4928 - accuracy50: 0.4916 - val_loss: 12.1373 - val_accuracy10: 0.5170 - val_accuracy20: 0.4877 - val_accuracy30: 0.4670 - val_accuracy50: 0.4427 - 147s/epoch - 27ms/step
Epoch 10/50
5452/5452 - 147s - loss: 11.7615 - accuracy10: 0.5462 - accuracy20: 0.5163 - accuracy30: 0.4939 - accuracy50: 0.4928 - val_loss: 12.1259 - val_accuracy10: 0.5209 - val_accuracy20: 0.4902 - val_accuracy30: 0.4669 - val_accuracy50: 0.4428 - 147s/epoch - 27ms/step
Epoch 11/50
5452/5452 - 147s - loss: 11.7471 - accuracy10: 0.5472 - accuracy20: 0.5171 - accuracy30: 0.4947 - accuracy50: 0.4934 - val_loss: 12.0954 - val_accuracy10: 0.5225 - val_accuracy20: 0.4923 - val_accuracy30: 0.4699 - val_accuracy50: 0.4450 - 147s/epoch - 27ms/step
Epoch 12/50
5452/5452 - 148s - loss: 11.7339 - accuracy10: 0.5487 - accuracy20: 0.5181 - accuracy30: 0.4956 - accuracy50: 0.4939 - val_loss: 12.0786 - val_accuracy10: 0.5248 - val_accuracy20: 0.4938 - val_accuracy30: 0.4707 - val_accuracy50: 0.4445 - 148s/epoch - 27ms/step
Epoch 13/50
5452/5452 - 150s - loss: 11.7215 - accuracy10: 0.5492 - accuracy20: 0.5191 - accuracy30: 0.4964 - accuracy50: 0.4948 - val_loss: 12.1043 - val_accuracy10: 0.5227 - val_accuracy20: 0.4914 - val_accuracy30: 0.4689 - val_accuracy50: 0.4431 - 150s/epoch - 27ms/step
Epoch 14/50
5452/5452 - 149s - loss: 11.7121 - accuracy10: 0.5499 - accuracy20: 0.5194 - accuracy30: 0.4970 - accuracy50: 0.4949 - val_loss: 12.0855 - val_accuracy10: 0.5245 - val_accuracy20: 0.4938 - val_accuracy30: 0.4715 - val_accuracy50: 0.4455 - 149s/epoch - 27ms/step
Epoch 15/50
5452/5452 - 148s - loss: 11.7017 - accuracy10: 0.5507 - accuracy20: 0.5201 - accuracy30: 0.4978 - accuracy50: 0.4957 - val_loss: 12.0805 - val_accuracy10: 0.5268 - val_accuracy20: 0.4943 - val_accuracy30: 0.4708 - val_accuracy50: 0.4459 - 148s/epoch - 27ms/step
Epoch 16/50
5452/5452 - 146s - loss: 11.6930 - accuracy10: 0.5510 - accuracy20: 0.5206 - accuracy30: 0.4985 - accuracy50: 0.4964 - val_loss: 12.0849 - val_accuracy10: 0.5244 - val_accuracy20: 0.4923 - val_accuracy30: 0.4708 - val_accuracy50: 0.4457 - 146s/epoch - 27ms/step
Epoch 17/50
5452/5452 - 146s - loss: 11.6837 - accuracy10: 0.5518 - accuracy20: 0.5214 - accuracy30: 0.4994 - accuracy50: 0.4969 - val_loss: 12.0555 - val_accuracy10: 0.5267 - val_accuracy20: 0.4950 - val_accuracy30: 0.4732 - val_accuracy50: 0.4470 - 146s/epoch - 27ms/step
Epoch 18/50
5452/5452 - 150s - loss: 11.6757 - accuracy10: 0.5523 - accuracy20: 0.5218 - accuracy30: 0.4997 - accuracy50: 0.4976 - val_loss: 12.0778 - val_accuracy10: 0.5268 - val_accuracy20: 0.4940 - val_accuracy30: 0.4716 - val_accuracy50: 0.4459 - 150s/epoch - 28ms/step
Epoch 19/50
5452/5452 - 147s - loss: 11.6665 - accuracy10: 0.5525 - accuracy20: 0.5226 - accuracy30: 0.5004 - accuracy50: 0.4980 - val_loss: 12.0706 - val_accuracy10: 0.5279 - val_accuracy20: 0.4949 - val_accuracy30: 0.4715 - val_accuracy50: 0.4451 - 147s/epoch - 27ms/step
Epoch 20/50
5452/5452 - 149s - loss: 11.6597 - accuracy10: 0.5529 - accuracy20: 0.5229 - accuracy30: 0.5009 - accuracy50: 0.4984 - val_loss: 12.0650 - val_accuracy10: 0.5284 - val_accuracy20: 0.4954 - val_accuracy30: 0.4719 - val_accuracy50: 0.4448 - 149s/epoch - 27ms/step
Epoch 21/50
5452/5452 - 151s - loss: 11.6535 - accuracy10: 0.5535 - accuracy20: 0.5233 - accuracy30: 0.5015 - accuracy50: 0.4989 - val_loss: 12.0644 - val_accuracy10: 0.5284 - val_accuracy20: 0.4957 - val_accuracy30: 0.4726 - val_accuracy50: 0.4459 - 151s/epoch - 28ms/step
Epoch 22/50
5452/5452 - 151s - loss: 11.6445 - accuracy10: 0.5541 - accuracy20: 0.5239 - accuracy30: 0.5021 - accuracy50: 0.4995 - val_loss: 12.0964 - val_accuracy10: 0.5270 - val_accuracy20: 0.4938 - val_accuracy30: 0.4699 - val_accuracy50: 0.4442 - 151s/epoch - 28ms/step
Epoch 23/50
5452/5452 - 148s - loss: 11.6396 - accuracy10: 0.5544 - accuracy20: 0.5242 - accuracy30: 0.5027 - accuracy50: 0.5002 - val_loss: 12.0363 - val_accuracy10: 0.5305 - val_accuracy20: 0.4983 - val_accuracy30: 0.4739 - val_accuracy50: 0.4451 - 148s/epoch - 27ms/step
Epoch 24/50
5452/5452 - 146s - loss: 11.6328 - accuracy10: 0.5546 - accuracy20: 0.5245 - accuracy30: 0.5029 - accuracy50: 0.5006 - val_loss: 12.0808 - val_accuracy10: 0.5286 - val_accuracy20: 0.4948 - val_accuracy30: 0.4711 - val_accuracy50: 0.4454 - 146s/epoch - 27ms/step
Epoch 25/50
5452/5452 - 151s - loss: 11.6241 - accuracy10: 0.5555 - accuracy20: 0.5255 - accuracy30: 0.5039 - accuracy50: 0.5014 - val_loss: 12.0411 - val_accuracy10: 0.5306 - val_accuracy20: 0.4976 - val_accuracy30: 0.4741 - val_accuracy50: 0.4463 - 151s/epoch - 28ms/step
Epoch 26/50
5452/5452 - 147s - loss: 11.6179 - accuracy10: 0.5555 - accuracy20: 0.5258 - accuracy30: 0.5042 - accuracy50: 0.5021 - val_loss: 12.0476 - val_accuracy10: 0.5307 - val_accuracy20: 0.4972 - val_accuracy30: 0.4732 - val_accuracy50: 0.4466 - 147s/epoch - 27ms/step
Epoch 27/50
5452/5452 - 147s - loss: 11.6124 - accuracy10: 0.5560 - accuracy20: 0.5264 - accuracy30: 0.5048 - accuracy50: 0.5024 - val_loss: 12.0796 - val_accuracy10: 0.5289 - val_accuracy20: 0.4958 - val_accuracy30: 0.4715 - val_accuracy50: 0.4439 - 147s/epoch - 27ms/step
Epoch 28/50
5452/5452 - 146s - loss: 11.6054 - accuracy10: 0.5561 - accuracy20: 0.5267 - accuracy30: 0.5053 - accuracy50: 0.5029 - val_loss: 12.0615 - val_accuracy10: 0.5309 - val_accuracy20: 0.4968 - val_accuracy30: 0.4726 - val_accuracy50: 0.4461 - 146s/epoch - 27ms/step
Epoch 29/50
5452/5452 - 146s - loss: 11.6003 - accuracy10: 0.5563 - accuracy20: 0.5269 - accuracy30: 0.5057 - accuracy50: 0.5036 - val_loss: 12.0496 - val_accuracy10: 0.5299 - val_accuracy20: 0.4971 - val_accuracy30: 0.4743 - val_accuracy50: 0.4477 - 146s/epoch - 27ms/step
Epoch 30/50
5452/5452 - 147s - loss: 11.5935 - accuracy10: 0.5572 - accuracy20: 0.5275 - accuracy30: 0.5063 - accuracy50: 0.5041 - val_loss: 12.0332 - val_accuracy10: 0.5314 - val_accuracy20: 0.4987 - val_accuracy30: 0.4748 - val_accuracy50: 0.4485 - 147s/epoch - 27ms/step
Epoch 31/50
5452/5452 - 148s - loss: 11.5868 - accuracy10: 0.5572 - accuracy20: 0.5280 - accuracy30: 0.5069 - accuracy50: 0.5049 - val_loss: 12.0546 - val_accuracy10: 0.5320 - val_accuracy20: 0.4983 - val_accuracy30: 0.4730 - val_accuracy50: 0.4449 - 148s/epoch - 27ms/step
Epoch 32/50
5452/5452 - 147s - loss: 11.5822 - accuracy10: 0.5572 - accuracy20: 0.5283 - accuracy30: 0.5071 - accuracy50: 0.5050 - val_loss: 12.0779 - val_accuracy10: 0.5292 - val_accuracy20: 0.4957 - val_accuracy30: 0.4721 - val_accuracy50: 0.4443 - 147s/epoch - 27ms/step
Epoch 33/50
5452/5452 - 151s - loss: 11.5964 - accuracy10: 0.5563 - accuracy20: 0.5272 - accuracy30: 0.5065 - accuracy50: 0.5045 - val_loss: 12.1731 - val_accuracy10: 0.5188 - val_accuracy20: 0.4883 - val_accuracy30: 0.4664 - val_accuracy50: 0.4395 - 151s/epoch - 28ms/step
Epoch 34/50
5452/5452 - 152s - loss: 11.6066 - accuracy10: 0.5561 - accuracy20: 0.5267 - accuracy30: 0.5060 - accuracy50: 0.5040 - val_loss: 12.0623 - val_accuracy10: 0.5300 - val_accuracy20: 0.4972 - val_accuracy30: 0.4733 - val_accuracy50: 0.4462 - 152s/epoch - 28ms/step
Epoch 35/50
5452/5452 - 148s - loss: 11.5701 - accuracy10: 0.5579 - accuracy20: 0.5289 - accuracy30: 0.5082 - accuracy50: 0.5066 - val_loss: 12.0354 - val_accuracy10: 0.5308 - val_accuracy20: 0.4982 - val_accuracy30: 0.4749 - val_accuracy50: 0.4482 - 148s/epoch - 27ms/step
Epoch 36/50
5452/5452 - 152s - loss: 11.5614 - accuracy10: 0.5584 - accuracy20: 0.5298 - accuracy30: 0.5092 - accuracy50: 0.5073 - val_loss: 12.0801 - val_accuracy10: 0.5294 - val_accuracy20: 0.4969 - val_accuracy30: 0.4724 - val_accuracy50: 0.4455 - 152s/epoch - 28ms/step
Epoch 37/50
5452/5452 - 150s - loss: 11.5551 - accuracy10: 0.5582 - accuracy20: 0.5298 - accuracy30: 0.5097 - accuracy50: 0.5077 - val_loss: 12.0849 - val_accuracy10: 0.5293 - val_accuracy20: 0.4962 - val_accuracy30: 0.4717 - val_accuracy50: 0.4458 - 150s/epoch - 28ms/step
Epoch 38/50
5452/5452 - 148s - loss: 11.5480 - accuracy10: 0.5590 - accuracy20: 0.5308 - accuracy30: 0.5102 - accuracy50: 0.5082 - val_loss: 12.0812 - val_accuracy10: 0.5292 - val_accuracy20: 0.4961 - val_accuracy30: 0.4724 - val_accuracy50: 0.4449 - 148s/epoch - 27ms/step
Epoch 39/50
5452/5452 - 148s - loss: 11.5407 - accuracy10: 0.5594 - accuracy20: 0.5310 - accuracy30: 0.5108 - accuracy50: 0.5091 - val_loss: 12.1046 - val_accuracy10: 0.5283 - val_accuracy20: 0.4947 - val_accuracy30: 0.4703 - val_accuracy50: 0.4440 - 148s/epoch - 27ms/step
Epoch 40/50
5452/5452 - 148s - loss: 11.5339 - accuracy10: 0.5594 - accuracy20: 0.5313 - accuracy30: 0.5114 - accuracy50: 0.5104 - val_loss: 12.1025 - val_accuracy10: 0.5282 - val_accuracy20: 0.4950 - val_accuracy30: 0.4706 - val_accuracy50: 0.4441 - 148s/epoch - 27ms/step
testing model: results/AAPL/W6/deepVOL_L2/seq2seq
Evaluating performance on  test set...
29350/29350 - 256s - 256s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0092883
{'0': {'precision': 0.5515889148253686, 'recall': 0.35548369984470257, 'f1-score': 0.4323377534813283, 'support': 2469455}, '1': {'precision': 0.4353277810985568, 'recall': 0.7081094236145734, 'f1-score': 0.5391808188267716, 'support': 2535248}, '2': {'precision': 0.5473108555741684, 'recall': 0.39227034230065677, 'f1-score': 0.4569989632541513, 'support': 2508701}, 'accuracy': 0.48675314145226317, 'macro avg': {'precision': 0.511409183832698, 'recall': 0.4852878219199776, 'f1-score': 0.47617251185408377, 'support': 7513404}, 'weighted avg': {'precision': 0.5109304891264208, 'recall': 0.48675314145226317, 'f1-score': 0.4766241074893379, 'support': 7513404}}
[[ 877851 1174575  417029]
 [ 343089 1795233  396926]
 [ 370555 1154057  984089]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.025379
{'0': {'precision': 0.48141378511543054, 'recall': 0.3588688753391793, 'f1-score': 0.411205494931153, 'support': 2322149}, '1': {'precision': 0.4603376309518722, 'recall': 0.6062675036781247, 'f1-score': 0.5233197128065735, 'support': 2896177}, '2': {'precision': 0.46282468192349907, 'recall': 0.396882371753814, 'f1-score': 0.42732453265865356, 'support': 2295078}, 'accuracy': 0.46584490864593464, 'macro avg': {'precision': 0.4681920326636006, 'recall': 0.4540062502570394, 'f1-score': 0.45394991346546004, 'support': 7513404}, 'weighted avg': {'precision': 0.46761129097130044, 'recall': 0.46584490864593464, 'f1-score': 0.4593457344355559, 'support': 7513404}}
[[ 833347 1046486  442316]
 [ 525431 1755858  614888]
 [ 372263 1011939  910876]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0383313
{'0': {'precision': 0.42918653407677215, 'recall': 0.38029165456295866, 'f1-score': 0.40326239656801627, 'support': 2213509}, '1': {'precision': 0.4823139722919107, 'recall': 0.49748248303377574, 'f1-score': 0.48978081362400105, 'support': 3113981}, '2': {'precision': 0.40963970747224326, 'recall': 0.43854424282016585, 'f1-score': 0.42359946867788995, 'support': 2185914}, 'accuracy': 0.4458099151862458, 'macro avg': {'precision': 0.4403800712803087, 'recall': 0.4387727934723001, 'f1-score': 0.43888089295663574, 'support': 7513404}, 'weighted avg': {'precision': 0.4455186987321272, 'recall': 0.4458099151862458, 'f1-score': 0.445037309444576, 'support': 7513404}}
[[ 841779  848656  523074]
 [ 706370 1549151  858460]
 [ 413187  814107  958620]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0662405
{'0': {'precision': 0.3924791735806023, 'recall': 0.3773423486328588, 'f1-score': 0.38476194513907624, 'support': 2212683}, '1': {'precision': 0.46249086587602506, 'recall': 0.40085731959094156, 'f1-score': 0.4294741147340966, 'support': 3112025}, '2': {'precision': 0.3741679699340401, 'recall': 0.45965542953429805, 'f1-score': 0.4125294134169672, 'support': 2188696}, 'accuracy': 0.41106041948496314, 'macro avg': {'precision': 0.40971266979688914, 'recall': 0.4126183659193661, 'f1-score': 0.4089218244300467, 'support': 7513404}, 'weighted avg': {'precision': 0.4161436109699996, 'recall': 0.41106041948496314, 'f1-score': 0.4113703820518112, 'support': 7513404}}
[[ 834939  741508  636236]
 [ 818074 1247478 1046473]
 [ 474333  708317 1006046]]
Evaluating performance on  train set...
5452/5452 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9658188
{'0': {'precision': 0.5583702740965952, 'recall': 0.41792535589275015, 'f1-score': 0.47804596958873763, 'support': 460532}, '1': {'precision': 0.49879418830080774, 'recall': 0.6698161416022997, 'f1-score': 0.5717909385397939, 'support': 475529}, '2': {'precision': 0.5394306231122864, 'recall': 0.483999181566082, 'f1-score': 0.5102137516506638, 'support': 459414}, 'accuracy': 0.5255135348178935, 'macro avg': {'precision': 0.5321983618365631, 'recall': 0.523913559687044, 'f1-score': 0.5200168865930651, 'support': 1395475}, 'weighted avg': {'precision': 0.5318335770438425, 'recall': 0.5255135348178935, 'f1-score': 0.5205811499169589, 'support': 1395475}}
[[192468 166453 101611]
 [ 68774 318517  88238]
 [ 83454 153604 222356]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9970027
{'0': {'precision': 0.5261656183126905, 'recall': 0.43640736804512736, 'f1-score': 0.47710159312183437, 'support': 464818}, '1': {'precision': 0.47596381724111003, 'recall': 0.5618524544828961, 'f1-score': 0.5153541069802835, 'support': 466473}, '2': {'precision': 0.5076910348551386, 'recall': 0.5023503610637161, 'f1-score': 0.5050065783418247, 'support': 464184}, 'accuracy': 0.5002755334205199, 'macro avg': {'precision': 0.5032734901363131, 'recall': 0.5002033945305798, 'f1-score': 0.49915409281464757, 'support': 1395475}, 'weighted avg': {'precision': 0.503239094513322, 'recall': 0.5002755334205199, 'f1-score': 0.49917064671036043, 'support': 1395475}}
[[202850 149346 112622]
 [ 90888 262089 113496]
 [ 91787 139214 233183]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0158265
{'0': {'precision': 0.4961031650475461, 'recall': 0.47476341031182595, 'f1-score': 0.48519876259470607, 'support': 467793}, '1': {'precision': 0.48379874075992746, 'recall': 0.42164223650480465, 'f1-score': 0.4505870359180389, 'support': 460701}, '2': {'precision': 0.47372284419321536, 'recall': 0.5541788638081635, 'f1-score': 0.5108021234159007, 'support': 466981}, 'accuracy': 0.48380157294111326, 'macro avg': {'precision': 0.48454158333356295, 'recall': 0.4835281702082647, 'f1-score': 0.48219597397621516, 'support': 1395475}, 'weighted avg': {'precision': 0.48455165377962195, 'recall': 0.48380157294111326, 'f1-score': 0.4823399696732815, 'support': 1395475}}
[[222091 107466 138236]
 [117185 194251 149265]
 [108395  99795 258791]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0383165
{'0': {'precision': 0.4627784248594395, 'recall': 0.48051540850453894, 'f1-score': 0.4714801602707316, 'support': 468832}, '1': {'precision': 0.4945021153866545, 'recall': 0.3041233639902877, 'f1-score': 0.3766212091029982, 'support': 460037}, '2': {'precision': 0.43807800916344786, 'recall': 0.5874892307428538, 'f1-score': 0.5019000268228311, 'support': 466606}, 'accuracy': 0.45813432702126516, 'macro avg': {'precision': 0.4651195164698472, 'recall': 0.45737600107922677, 'f1-score': 0.45000046539885363, 'support': 1395475}, 'weighted avg': {'precision': 0.4649774676605105, 'recall': 0.45813432702126516, 'f1-score': 0.4503801512659542, 'support': 1395475}}
[[225281  74504 169047]
 [137555 139908 182574]
 [123965  68515 274126]]
Evaluating performance on  val set...
1969/1969 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9530701
{'0': {'precision': 0.5534814123040678, 'recall': 0.3484180428624873, 'f1-score': 0.4276372700549777, 'support': 149688}, '1': {'precision': 0.5280821823394811, 'recall': 0.7430371031245757, 'f1-score': 0.61738447282543, 'support': 206236}, '2': {'precision': 0.5236188884245717, 'recall': 0.4229203653325593, 'f1-score': 0.4679131704438943, 'support': 148139}, 'accuracy': 0.5317708302335225, 'macro avg': {'precision': 0.5350608276893736, 'recall': 0.5047918371065407, 'f1-score': 0.5043116377747673, 'support': 504063}, 'weighted avg': {'precision': 0.5343130940264692, 'recall': 0.5317708302335225, 'f1-score': 0.5171084982908941, 'support': 504063}}
[[ 52154  71548  25986]
 [ 21982 153241  31013]
 [ 20093  65395  62651]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99322206
{'0': {'precision': 0.5194459435150207, 'recall': 0.3715723238068277, 'f1-score': 0.43323856177280334, 'support': 155426}, '1': {'precision': 0.49313429050372315, 'recall': 0.6394717233227987, 'f1-score': 0.5568493028084559, 'support': 194595}, '2': {'precision': 0.4907074041923411, 'recall': 0.44770257462250557, 'f1-score': 0.46821959101648425, 'support': 154042}, 'accuracy': 0.49826113005715555, 'macro avg': {'precision': 0.5010958794036949, 'recall': 0.48624887391737737, 'f1-score': 0.48610248519924787, 'support': 504063}, 'weighted avg': {'precision': 0.5005057352631203, 'recall': 0.49826113005715555, 'f1-score': 0.4916490776380581, 'support': 504063}}
[[ 57752  66277  31397]
 [ 29977 124438  40180]
 [ 23451  61626  68965]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0192312
{'0': {'precision': 0.48808765632237144, 'recall': 0.4213992489518442, 'f1-score': 0.4522984786348288, 'support': 160043}, '1': {'precision': 0.4841831992564341, 'recall': 0.4864151287651532, 'f1-score': 0.4852965978053984, 'support': 186347}, '2': {'precision': 0.45251033965558735, 'recall': 0.5128018113437304, 'f1-score': 0.4807732329628903, 'support': 157673}, 'accuracy': 0.47402606420229215, 'macro avg': {'precision': 0.474927065078131, 'recall': 0.4735387296869093, 'f1-score': 0.4727894364677058, 'support': 504063}, 'weighted avg': {'precision': 0.4755154855586612, 'recall': 0.47402606420229215, 'f1-score': 0.47340457142927433, 'support': 504063}}
[[67442 49873 42728]
 [40607 90642 55098]
 [30127 46691 80855]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0451595
{'0': {'precision': 0.45418331676140805, 'recall': 0.4427969589259912, 'f1-score': 0.4484178680579137, 'support': 164021}, '1': {'precision': 0.4890782101465961, 'recall': 0.35338679444093213, 'f1-score': 0.41030495029104214, 'support': 180318}, '2': {'precision': 0.41827516552575467, 'recall': 0.5600535924469711, 'f1-score': 0.4788911849417004, 'support': 159724}, 'accuracy': 0.4479678135471161, 'macro avg': {'precision': 0.45384556414458627, 'recall': 0.4520791152712982, 'f1-score': 0.44587133443021876, 'support': 504063}, 'weighted avg': {'precision': 0.45528790852368156, 'recall': 0.4479678135471161, 'f1-score': 0.4444399426003007, 'support': 504063}}
[[72628 34233 57160]
 [49346 63722 67250]
 [37935 32335 89454]]
training model: results/AAPL/W6/deepVOL_L3/seq2seq
Epoch 1/50
5452/5452 - 238s - loss: 12.3825 - accuracy10: 0.4818 - accuracy20: 0.4621 - accuracy30: 0.4492 - accuracy50: 0.4594 - val_loss: 12.8839 - val_accuracy10: 0.4304 - val_accuracy20: 0.4151 - val_accuracy30: 0.4020 - val_accuracy50: 0.3847 - 238s/epoch - 44ms/step
Epoch 2/50
5452/5452 - 221s - loss: 12.1656 - accuracy10: 0.5072 - accuracy20: 0.4836 - accuracy30: 0.4666 - accuracy50: 0.4694 - val_loss: 12.6394 - val_accuracy10: 0.4593 - val_accuracy20: 0.4420 - val_accuracy30: 0.4283 - val_accuracy50: 0.4125 - 221s/epoch - 40ms/step
Epoch 3/50
5452/5452 - 221s - loss: 12.0656 - accuracy10: 0.5179 - accuracy20: 0.4924 - accuracy30: 0.4732 - accuracy50: 0.4735 - val_loss: 12.4899 - val_accuracy10: 0.4855 - val_accuracy20: 0.4593 - val_accuracy30: 0.4379 - val_accuracy50: 0.4178 - 221s/epoch - 41ms/step
Epoch 4/50
5452/5452 - 215s - loss: 12.0075 - accuracy10: 0.5236 - accuracy20: 0.4969 - accuracy30: 0.4771 - accuracy50: 0.4757 - val_loss: 12.3947 - val_accuracy10: 0.4987 - val_accuracy20: 0.4706 - val_accuracy30: 0.4489 - val_accuracy50: 0.4277 - 215s/epoch - 39ms/step
Epoch 5/50
5452/5452 - 221s - loss: 11.9619 - accuracy10: 0.5281 - accuracy20: 0.5007 - accuracy30: 0.4803 - accuracy50: 0.4784 - val_loss: 12.3684 - val_accuracy10: 0.4995 - val_accuracy20: 0.4729 - val_accuracy30: 0.4518 - val_accuracy50: 0.4302 - 221s/epoch - 41ms/step
Epoch 6/50
5452/5452 - 220s - loss: 11.9252 - accuracy10: 0.5316 - accuracy20: 0.5040 - accuracy30: 0.4828 - accuracy50: 0.4806 - val_loss: 12.2559 - val_accuracy10: 0.5118 - val_accuracy20: 0.4829 - val_accuracy30: 0.4619 - val_accuracy50: 0.4402 - 220s/epoch - 40ms/step
Epoch 7/50
5452/5452 - 219s - loss: 11.8947 - accuracy10: 0.5344 - accuracy20: 0.5065 - accuracy30: 0.4846 - accuracy50: 0.4827 - val_loss: 12.2500 - val_accuracy10: 0.5117 - val_accuracy20: 0.4824 - val_accuracy30: 0.4615 - val_accuracy50: 0.4409 - 219s/epoch - 40ms/step
Epoch 8/50
5452/5452 - 217s - loss: 11.8707 - accuracy10: 0.5368 - accuracy20: 0.5082 - accuracy30: 0.4860 - accuracy50: 0.4847 - val_loss: 12.2223 - val_accuracy10: 0.5103 - val_accuracy20: 0.4844 - val_accuracy30: 0.4644 - val_accuracy50: 0.4437 - 217s/epoch - 40ms/step
Epoch 9/50
5452/5452 - 213s - loss: 11.8450 - accuracy10: 0.5387 - accuracy20: 0.5101 - accuracy30: 0.4877 - accuracy50: 0.4863 - val_loss: 12.2173 - val_accuracy10: 0.5107 - val_accuracy20: 0.4841 - val_accuracy30: 0.4643 - val_accuracy50: 0.4426 - 213s/epoch - 39ms/step
Epoch 10/50
5452/5452 - 218s - loss: 11.8247 - accuracy10: 0.5404 - accuracy20: 0.5116 - accuracy30: 0.4890 - accuracy50: 0.4874 - val_loss: 12.1815 - val_accuracy10: 0.5136 - val_accuracy20: 0.4874 - val_accuracy30: 0.4671 - val_accuracy50: 0.4457 - 218s/epoch - 40ms/step
Epoch 11/50
5452/5452 - 225s - loss: 11.8060 - accuracy10: 0.5422 - accuracy20: 0.5129 - accuracy30: 0.4904 - accuracy50: 0.4888 - val_loss: 12.1619 - val_accuracy10: 0.5154 - val_accuracy20: 0.4889 - val_accuracy30: 0.4688 - val_accuracy50: 0.4472 - 225s/epoch - 41ms/step
Epoch 12/50
5452/5452 - 222s - loss: 11.7892 - accuracy10: 0.5437 - accuracy20: 0.5142 - accuracy30: 0.4916 - accuracy50: 0.4903 - val_loss: 12.1739 - val_accuracy10: 0.5124 - val_accuracy20: 0.4871 - val_accuracy30: 0.4674 - val_accuracy50: 0.4460 - 222s/epoch - 41ms/step
Epoch 13/50
5452/5452 - 218s - loss: 11.7795 - accuracy10: 0.5444 - accuracy20: 0.5148 - accuracy30: 0.4919 - accuracy50: 0.4910 - val_loss: 12.1708 - val_accuracy10: 0.5161 - val_accuracy20: 0.4883 - val_accuracy30: 0.4673 - val_accuracy50: 0.4451 - 218s/epoch - 40ms/step
Epoch 14/50
5452/5452 - 223s - loss: 11.7622 - accuracy10: 0.5459 - accuracy20: 0.5160 - accuracy30: 0.4931 - accuracy50: 0.4917 - val_loss: 12.1067 - val_accuracy10: 0.5186 - val_accuracy20: 0.4922 - val_accuracy30: 0.4717 - val_accuracy50: 0.4501 - 223s/epoch - 41ms/step
Epoch 15/50
5452/5452 - 222s - loss: 11.7496 - accuracy10: 0.5469 - accuracy20: 0.5170 - accuracy30: 0.4939 - accuracy50: 0.4926 - val_loss: 12.1031 - val_accuracy10: 0.5220 - val_accuracy20: 0.4926 - val_accuracy30: 0.4701 - val_accuracy50: 0.4474 - 222s/epoch - 41ms/step
Epoch 16/50
5452/5452 - 219s - loss: 11.7375 - accuracy10: 0.5478 - accuracy20: 0.5175 - accuracy30: 0.4949 - accuracy50: 0.4933 - val_loss: 12.0951 - val_accuracy10: 0.5226 - val_accuracy20: 0.4936 - val_accuracy30: 0.4708 - val_accuracy50: 0.4464 - 219s/epoch - 40ms/step
Epoch 17/50
5452/5452 - 218s - loss: 11.7269 - accuracy10: 0.5486 - accuracy20: 0.5187 - accuracy30: 0.4957 - accuracy50: 0.4939 - val_loss: 12.0926 - val_accuracy10: 0.5242 - val_accuracy20: 0.4946 - val_accuracy30: 0.4709 - val_accuracy50: 0.4457 - 218s/epoch - 40ms/step
Epoch 18/50
5452/5452 - 216s - loss: 11.7172 - accuracy10: 0.5495 - accuracy20: 0.5191 - accuracy30: 0.4964 - accuracy50: 0.4945 - val_loss: 12.0843 - val_accuracy10: 0.5252 - val_accuracy20: 0.4939 - val_accuracy30: 0.4699 - val_accuracy50: 0.4444 - 216s/epoch - 40ms/step
Epoch 19/50
5452/5452 - 216s - loss: 11.7072 - accuracy10: 0.5501 - accuracy20: 0.5198 - accuracy30: 0.4972 - accuracy50: 0.4954 - val_loss: 12.0868 - val_accuracy10: 0.5262 - val_accuracy20: 0.4941 - val_accuracy30: 0.4715 - val_accuracy50: 0.4473 - 216s/epoch - 40ms/step
Epoch 20/50
5452/5452 - 218s - loss: 11.6971 - accuracy10: 0.5510 - accuracy20: 0.5202 - accuracy30: 0.4979 - accuracy50: 0.4962 - val_loss: 12.0677 - val_accuracy10: 0.5270 - val_accuracy20: 0.4953 - val_accuracy30: 0.4723 - val_accuracy50: 0.4445 - 218s/epoch - 40ms/step
Epoch 21/50
5452/5452 - 222s - loss: 11.6895 - accuracy10: 0.5514 - accuracy20: 0.5206 - accuracy30: 0.4981 - accuracy50: 0.4962 - val_loss: 12.0178 - val_accuracy10: 0.5323 - val_accuracy20: 0.4993 - val_accuracy30: 0.4734 - val_accuracy50: 0.4464 - 222s/epoch - 41ms/step
Epoch 22/50
5452/5452 - 213s - loss: 11.6821 - accuracy10: 0.5520 - accuracy20: 0.5215 - accuracy30: 0.4989 - accuracy50: 0.4970 - val_loss: 12.0358 - val_accuracy10: 0.5310 - val_accuracy20: 0.4979 - val_accuracy30: 0.4729 - val_accuracy50: 0.4463 - 213s/epoch - 39ms/step
Epoch 23/50
5452/5452 - 215s - loss: 11.6751 - accuracy10: 0.5525 - accuracy20: 0.5219 - accuracy30: 0.4995 - accuracy50: 0.4972 - val_loss: 12.0342 - val_accuracy10: 0.5295 - val_accuracy20: 0.4968 - val_accuracy30: 0.4736 - val_accuracy50: 0.4472 - 215s/epoch - 39ms/step
Epoch 24/50
5452/5452 - 217s - loss: 11.6673 - accuracy10: 0.5528 - accuracy20: 0.5223 - accuracy30: 0.4996 - accuracy50: 0.4980 - val_loss: 12.0159 - val_accuracy10: 0.5331 - val_accuracy20: 0.4992 - val_accuracy30: 0.4744 - val_accuracy50: 0.4465 - 217s/epoch - 40ms/step
Epoch 25/50
5452/5452 - 217s - loss: 11.6603 - accuracy10: 0.5534 - accuracy20: 0.5227 - accuracy30: 0.5005 - accuracy50: 0.4981 - val_loss: 12.0416 - val_accuracy10: 0.5300 - val_accuracy20: 0.4975 - val_accuracy30: 0.4743 - val_accuracy50: 0.4460 - 217s/epoch - 40ms/step
Epoch 26/50
5452/5452 - 224s - loss: 11.6536 - accuracy10: 0.5539 - accuracy20: 0.5232 - accuracy30: 0.5008 - accuracy50: 0.4990 - val_loss: 12.0587 - val_accuracy10: 0.5294 - val_accuracy20: 0.4971 - val_accuracy30: 0.4732 - val_accuracy50: 0.4468 - 224s/epoch - 41ms/step
Epoch 27/50
5452/5452 - 222s - loss: 11.6452 - accuracy10: 0.5542 - accuracy20: 0.5234 - accuracy30: 0.5016 - accuracy50: 0.4997 - val_loss: 12.0404 - val_accuracy10: 0.5304 - val_accuracy20: 0.4980 - val_accuracy30: 0.4739 - val_accuracy50: 0.4461 - 222s/epoch - 41ms/step
Epoch 28/50
5452/5452 - 221s - loss: 11.6413 - accuracy10: 0.5544 - accuracy20: 0.5242 - accuracy30: 0.5019 - accuracy50: 0.4998 - val_loss: 12.0321 - val_accuracy10: 0.5324 - val_accuracy20: 0.4994 - val_accuracy30: 0.4745 - val_accuracy50: 0.4447 - 221s/epoch - 41ms/step
Epoch 29/50
5452/5452 - 223s - loss: 11.6339 - accuracy10: 0.5551 - accuracy20: 0.5245 - accuracy30: 0.5024 - accuracy50: 0.5006 - val_loss: 12.0228 - val_accuracy10: 0.5341 - val_accuracy20: 0.4996 - val_accuracy30: 0.4753 - val_accuracy50: 0.4461 - 223s/epoch - 41ms/step
Epoch 30/50
5452/5452 - 217s - loss: 11.6281 - accuracy10: 0.5556 - accuracy20: 0.5250 - accuracy30: 0.5027 - accuracy50: 0.5008 - val_loss: 12.0475 - val_accuracy10: 0.5316 - val_accuracy20: 0.4981 - val_accuracy30: 0.4728 - val_accuracy50: 0.4440 - 217s/epoch - 40ms/step
Epoch 31/50
5452/5452 - 218s - loss: 11.6220 - accuracy10: 0.5557 - accuracy20: 0.5249 - accuracy30: 0.5033 - accuracy50: 0.5015 - val_loss: 12.0230 - val_accuracy10: 0.5341 - val_accuracy20: 0.4997 - val_accuracy30: 0.4748 - val_accuracy50: 0.4441 - 218s/epoch - 40ms/step
Epoch 32/50
5452/5452 - 222s - loss: 11.6166 - accuracy10: 0.5559 - accuracy20: 0.5252 - accuracy30: 0.5035 - accuracy50: 0.5015 - val_loss: 12.0558 - val_accuracy10: 0.5303 - val_accuracy20: 0.4967 - val_accuracy30: 0.4737 - val_accuracy50: 0.4430 - 222s/epoch - 41ms/step
Epoch 33/50
5452/5452 - 217s - loss: 11.6111 - accuracy10: 0.5563 - accuracy20: 0.5260 - accuracy30: 0.5040 - accuracy50: 0.5022 - val_loss: 12.0417 - val_accuracy10: 0.5327 - val_accuracy20: 0.4980 - val_accuracy30: 0.4736 - val_accuracy50: 0.4439 - 217s/epoch - 40ms/step
Epoch 34/50
5452/5452 - 219s - loss: 11.6060 - accuracy10: 0.5569 - accuracy20: 0.5267 - accuracy30: 0.5046 - accuracy50: 0.5024 - val_loss: 12.0480 - val_accuracy10: 0.5311 - val_accuracy20: 0.4977 - val_accuracy30: 0.4757 - val_accuracy50: 0.4435 - 219s/epoch - 40ms/step
testing model: results/AAPL/W6/deepVOL_L3/seq2seq
Evaluating performance on  test set...
29350/29350 - 454s - 454s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0052568
{'0': {'precision': 0.567911591097075, 'recall': 0.29360931865533085, 'f1-score': 0.3870924859302555, 'support': 2469455}, '1': {'precision': 0.4423149958422054, 'recall': 0.7391470183587562, 'f1-score': 0.5534427792386415, 'support': 2535248}, '2': {'precision': 0.5425350698647403, 'recall': 0.4325397885200349, 'f1-score': 0.4813333096757881, 'support': 2508701}, 'accuracy': 0.49033553899138127, 'macro avg': {'precision': 0.5175872189346736, 'recall': 0.4884320418447073, 'f1-score': 0.47395619161489505, 'support': 7513404}, 'weighted avg': {'precision': 0.517058393116666, 'recall': 0.49033553899138127, 'f1-score': 0.47469076990124126, 'support': 7513404}}
[[ 725055 1249702  494698]
 [ 241059 1873921  420268]
 [ 310590 1112998 1085113]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0189918
{'0': {'precision': 0.4989921564384071, 'recall': 0.3097962275461221, 'f1-score': 0.38226535074143675, 'support': 2322149}, '1': {'precision': 0.4679975984286324, 'recall': 0.6184905135286967, 'f1-score': 0.5328214304358437, 'support': 2896177}, '2': {'precision': 0.45884936311891267, 'recall': 0.4486810470058098, 'f1-score': 0.45370824022051, 'support': 2295078}, 'accuracy': 0.47121238256321635, 'macro avg': {'precision': 0.4752797059953174, 'recall': 0.45898926269354284, 'f1-score': 0.4562650071325968, 'support': 7513404}, 'weighted avg': {'precision': 0.4747825481384682, 'recall': 0.47121238256321635, 'f1-score': 0.4621231700628736, 'support': 7513404}}
[[ 719393 1090849  511907]
 [ 402366 1791258  702553]
 [ 319933  945387 1029758]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0341761
{'0': {'precision': 0.4398560121876662, 'recall': 0.3594826133528258, 'f1-score': 0.3956285451694708, 'support': 2213509}, '1': {'precision': 0.4936616485797861, 'recall': 0.4690128167127545, 'f1-score': 0.4810216717093629, 'support': 3113981}, '2': {'precision': 0.40231562815929706, 'recall': 0.5053739534126228, 'f1-score': 0.447994212229342, 'support': 2185914}, 'accuracy': 0.4473230775291732, 'macro avg': {'precision': 0.4452777629755831, 'recall': 0.44462312782606767, 'f1-score': 0.4415481430360586, 'support': 7513404}, 'weighted avg': {'precision': 0.45123430069777176, 'recall': 0.4473230775291732, 'f1-score': 0.4462553207722909, 'support': 7513404}}
[[ 795718  803973  613818]
 [ 626142 1460497 1027342]
 [ 387182  694028 1104704]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0665958
{'0': {'precision': 0.39955340818549584, 'recall': 0.37530681078130035, 'f1-score': 0.38705075236111286, 'support': 2212683}, '1': {'precision': 0.46690974764393395, 'recall': 0.3205009599858613, 'f1-score': 0.3800939481686433, 'support': 3112025}, '2': {'precision': 0.36386052173997396, 'recall': 0.5484114742294042, 'f1-score': 0.4374688382915074, 'support': 2188696}, 'accuracy': 0.4030327665063665, 'macro avg': {'precision': 0.41010789252313457, 'recall': 0.41473974833218863, 'f1-score': 0.4015378462737545, 'support': 7513404}, 'weighted avg': {'precision': 0.41705462794040027, 'recall': 0.4030327665063665, 'f1-score': 0.3988563353480573, 'support': 7513404}}
[[ 830435  614441  767807]
 [ 783923  997407 1330695]
 [ 464050  524340 1200306]]
Evaluating performance on  train set...
5452/5452 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9656154
{'0': {'precision': 0.5517659147458198, 'recall': 0.4232583186401814, 'f1-score': 0.4790435055080763, 'support': 460532}, '1': {'precision': 0.5066406904642199, 'recall': 0.66116892976033, 'f1-score': 0.5736809789644529, 'support': 475529}, '2': {'precision': 0.5331851795633179, 'recall': 0.4893385922065936, 'f1-score': 0.510321798585321, 'support': 459414}, 'accuracy': 0.526084666511403, 'macro avg': {'precision': 0.5305305949244525, 'recall': 0.5245886135357017, 'f1-score': 0.5210154276859501, 'support': 1395475}, 'weighted avg': {'precision': 0.5302717262791408, 'recall': 0.526084666511403, 'f1-score': 0.5215899852737665, 'support': 1395475}}
[[194924 162946 102662]
 [ 66961 314405  94163]
 [ 91388 143217 224809]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9991351
{'0': {'precision': 0.5216957657534282, 'recall': 0.4343678601086877, 'f1-score': 0.4740434993408301, 'support': 464818}, '1': {'precision': 0.48303814946457224, 'recall': 0.5459651469645618, 'f1-score': 0.5125775499011286, 'support': 466473}, '2': {'precision': 0.498551604041378, 'recall': 0.5168510762973304, 'f1-score': 0.5075364446597547, 'support': 464184}, 'accuracy': 0.49910890556978804, 'macro avg': {'precision': 0.5010951730864595, 'recall': 0.4990613611235266, 'f1-score': 0.4980524979672378, 'support': 1395475}, 'weighted avg': {'precision': 0.501074913496485, 'recall': 0.49910890556978804, 'f1-score': 0.4980654155320437, 'support': 1395475}}
[[201902 146186 116730]
 [ 87217 254678 124578]
 [ 97892 126378 239914]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0179939
{'0': {'precision': 0.492053877561848, 'recall': 0.47581943295431955, 'f1-score': 0.48380050252566964, 'support': 467793}, '1': {'precision': 0.4974807736038773, 'recall': 0.39413198582160663, 'f1-score': 0.43981668753799835, 'support': 460701}, '2': {'precision': 0.46330279196641544, 'recall': 0.5735693743428534, 'f1-score': 0.5125729114040325, 'support': 466981}, 'accuracy': 0.4815621920851323, 'macro avg': {'precision': 0.48427914771071356, 'recall': 0.48117359770625984, 'f1-score': 0.47873003382256685, 'support': 1395475}, 'weighted avg': {'precision': 0.4842242609302482, 'recall': 0.4815621920851323, 'f1-score': 0.47890810439728443, 'support': 1395475}}
[[222585  99287 145921]
 [114768 181577 164356]
 [115006  84129 267846]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0400857
{'0': {'precision': 0.46271858666065924, 'recall': 0.4775377960548768, 'f1-score': 0.4700114099292626, 'support': 468832}, '1': {'precision': 0.5091556418329228, 'recall': 0.27138469297034806, 'f1-score': 0.35405485500701184, 'support': 460037}, '2': {'precision': 0.4259120319796406, 'recall': 0.6083033651517554, 'f1-score': 0.501024686018905, 'support': 466606}, 'accuracy': 0.4533008473817159, 'macro avg': {'precision': 0.46592875349107427, 'recall': 0.45240861805899346, 'f1-score': 0.44169698365172644, 'support': 1395475}, 'weighted avg': {'precision': 0.46572014834882364, 'recall': 0.4533008473817159, 'f1-score': 0.4421547124221888, 'support': 1395475}}
[[223885  66494 178453]
 [131057 124847 204133]
 [128905  53863 283838]]
Evaluating performance on  val set...
1969/1969 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9508781
{'0': {'precision': 0.5527047024880495, 'recall': 0.34682138848805516, 'f1-score': 0.42620178394775404, 'support': 149688}, '1': {'precision': 0.5355693978597668, 'recall': 0.7316569367132799, 'f1-score': 0.6184421114756518, 'support': 206236}, '2': {'precision': 0.5136655009385539, 'recall': 0.44518324006507404, 'f1-score': 0.47697882312098594, 'support': 148139}, 'accuracy': 0.5331833520809899, 'macro avg': {'precision': 0.5339798670954568, 'recall': 0.5078871884221363, 'f1-score': 0.5072075728481306, 'support': 504063}, 'weighted avg': {'precision': 0.5342206142616587, 'recall': 0.5331833520809899, 'f1-score': 0.5197792454835678, 'support': 504063}}
[[ 51915  69799  27974]
 [ 20876 150894  34466]
 [ 21138  61052  65949]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99148756
{'0': {'precision': 0.5243281693133424, 'recall': 0.36517699741356013, 'f1-score': 0.43051483834265664, 'support': 155426}, '1': {'precision': 0.5009506733936538, 'recall': 0.6174002415272746, 'f1-score': 0.5531127352247224, 'support': 194595}, '2': {'precision': 0.4796645809826649, 'recall': 0.4857116890198777, 'f1-score': 0.4826691954868302, 'support': 154042}, 'accuracy': 0.4993840055707322, 'macro avg': {'precision': 0.5016478078965537, 'recall': 0.48942964265357086, 'f1-score': 0.4887655896847363, 'support': 504063}, 'weighted avg': {'precision': 0.5016539950689999, 'recall': 0.4993840055707322, 'f1-score': 0.4937825235863035, 'support': 504063}}
[[ 56758  64154  34514]
 [ 27802 120143  46650]
 [ 23689  55533  74820]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0174639
{'0': {'precision': 0.4922874863188617, 'recall': 0.42156170529170284, 'f1-score': 0.45418774592467676, 'support': 160043}, '1': {'precision': 0.49914617589379995, 'recall': 0.44390840743344406, 'f1-score': 0.4699095639528278, 'support': 186347}, '2': {'precision': 0.44142720877548586, 'recall': 0.5635333887222289, 'f1-score': 0.49506213766955187, 'support': 157673}, 'accuracy': 0.4742323876182144, 'macro avg': {'precision': 0.47762029032938247, 'recall': 0.4763345004824586, 'f1-score': 0.47305314918235214, 'support': 504063}, 'weighted avg': {'precision': 0.4789137685199443, 'recall': 0.4742323876182144, 'f1-score': 0.4727856227648367, 'support': 504063}}
[[67468 44749 47826]
 [39018 82721 64608]
 [30564 38255 88854]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0430378
{'0': {'precision': 0.4643877564094351, 'recall': 0.4419556032459258, 'f1-score': 0.4528940800139948, 'support': 164021}, '1': {'precision': 0.5115685138945589, 'recall': 0.29882208099025054, 'f1-score': 0.37726984704898003, 'support': 180318}, '2': {'precision': 0.4057312187803953, 'recall': 0.6163444441661867, 'f1-score': 0.48933790635252006, 'support': 159724}, 'accuracy': 0.4460117088538536, 'macro avg': {'precision': 0.4605624963614631, 'recall': 0.4523740428007877, 'f1-score': 0.4398339444718316, 'support': 504063}, 'weighted avg': {'precision': 0.4626790077251274, 'recall': 0.4460117088538536, 'f1-score': 0.43738915955426877, 'support': 504063}}
[[72490 27868 63663]
 [45907 53883 80528]
 [37701 23578 98445]]
training model: results/AAPL/W7/deepLOB_L1/seq2seq
Epoch 1/50
9052/9052 - 271s - loss: 12.8021 - accuracy10: 0.4472 - accuracy20: 0.4242 - accuracy30: 0.4033 - accuracy50: 0.3977 - val_loss: 13.8316 - val_accuracy10: 0.3505 - val_accuracy20: 0.3430 - val_accuracy30: 0.3425 - val_accuracy50: 0.3279 - 271s/epoch - 30ms/step
Epoch 2/50
9052/9052 - 210s - loss: 12.7112 - accuracy10: 0.4617 - accuracy20: 0.4347 - accuracy30: 0.4120 - accuracy50: 0.4042 - val_loss: 13.4163 - val_accuracy10: 0.3807 - val_accuracy20: 0.3660 - val_accuracy30: 0.3609 - val_accuracy50: 0.3408 - 210s/epoch - 23ms/step
Epoch 3/50
9052/9052 - 201s - loss: 12.6741 - accuracy10: 0.4671 - accuracy20: 0.4394 - accuracy30: 0.4154 - accuracy50: 0.4061 - val_loss: 13.4564 - val_accuracy10: 0.3941 - val_accuracy20: 0.3744 - val_accuracy30: 0.3685 - val_accuracy50: 0.3474 - 201s/epoch - 22ms/step
Epoch 4/50
9052/9052 - 216s - loss: 12.6471 - accuracy10: 0.4710 - accuracy20: 0.4424 - accuracy30: 0.4185 - accuracy50: 0.4086 - val_loss: 13.5161 - val_accuracy10: 0.4020 - val_accuracy20: 0.3796 - val_accuracy30: 0.3713 - val_accuracy50: 0.3494 - 216s/epoch - 24ms/step
Epoch 5/50
9052/9052 - 208s - loss: 12.6242 - accuracy10: 0.4740 - accuracy20: 0.4449 - accuracy30: 0.4205 - accuracy50: 0.4100 - val_loss: 13.4838 - val_accuracy10: 0.3971 - val_accuracy20: 0.3759 - val_accuracy30: 0.3680 - val_accuracy50: 0.3464 - 208s/epoch - 23ms/step
Epoch 6/50
9052/9052 - 210s - loss: 12.6160 - accuracy10: 0.4748 - accuracy20: 0.4458 - accuracy30: 0.4215 - accuracy50: 0.4107 - val_loss: 13.5387 - val_accuracy10: 0.3945 - val_accuracy20: 0.3722 - val_accuracy30: 0.3641 - val_accuracy50: 0.3431 - 210s/epoch - 23ms/step
Epoch 7/50
9052/9052 - 210s - loss: 12.6010 - accuracy10: 0.4767 - accuracy20: 0.4474 - accuracy30: 0.4231 - accuracy50: 0.4121 - val_loss: 13.5927 - val_accuracy10: 0.4004 - val_accuracy20: 0.3777 - val_accuracy30: 0.3700 - val_accuracy50: 0.3482 - 210s/epoch - 23ms/step
Epoch 8/50
9052/9052 - 210s - loss: 12.5855 - accuracy10: 0.4783 - accuracy20: 0.4486 - accuracy30: 0.4242 - accuracy50: 0.4129 - val_loss: 13.7188 - val_accuracy10: 0.3789 - val_accuracy20: 0.3603 - val_accuracy30: 0.3546 - val_accuracy50: 0.3360 - 210s/epoch - 23ms/step
Epoch 9/50
9052/9052 - 211s - loss: 12.5761 - accuracy10: 0.4797 - accuracy20: 0.4499 - accuracy30: 0.4251 - accuracy50: 0.4137 - val_loss: 13.7695 - val_accuracy10: 0.3795 - val_accuracy20: 0.3612 - val_accuracy30: 0.3555 - val_accuracy50: 0.3365 - 211s/epoch - 23ms/step
Epoch 10/50
9052/9052 - 200s - loss: 12.5639 - accuracy10: 0.4812 - accuracy20: 0.4512 - accuracy30: 0.4265 - accuracy50: 0.4148 - val_loss: 13.5669 - val_accuracy10: 0.3982 - val_accuracy20: 0.3740 - val_accuracy30: 0.3664 - val_accuracy50: 0.3445 - 200s/epoch - 22ms/step
Epoch 11/50
9052/9052 - 206s - loss: 12.5575 - accuracy10: 0.4816 - accuracy20: 0.4514 - accuracy30: 0.4269 - accuracy50: 0.4154 - val_loss: 13.7642 - val_accuracy10: 0.3835 - val_accuracy20: 0.3606 - val_accuracy30: 0.3539 - val_accuracy50: 0.3351 - 206s/epoch - 23ms/step
Epoch 12/50
9052/9052 - 204s - loss: 12.5458 - accuracy10: 0.4830 - accuracy20: 0.4528 - accuracy30: 0.4281 - accuracy50: 0.4160 - val_loss: 13.7830 - val_accuracy10: 0.3820 - val_accuracy20: 0.3605 - val_accuracy30: 0.3541 - val_accuracy50: 0.3350 - 204s/epoch - 23ms/step
testing model: results/AAPL/W7/deepLOB_L1/seq2seq
Evaluating performance on  test set...
23942/23942 - 233s - 233s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1306621
{'0': {'precision': 0.3324015818355887, 'recall': 0.9250780664119362, 'f1-score': 0.4890694064516692, 'support': 1878849}, '1': {'precision': 0.531810766721044, 'recall': 0.009168442959792671, 'f1-score': 0.018026114840761203, 'support': 2382302}, '2': {'precision': 0.4875612683048336, 'recall': 0.22424973754130947, 'f1-score': 0.3072036974834289, 'support': 1867913}, 'accuracy': 0.3554870694774928, 'macro avg': {'precision': 0.45059120562048877, 'recall': 0.3861654156376795, 'f1-score': 0.27143307292528646, 'support': 6129064}, 'weighted avg': {'precision': 0.45719677004096826, 'recall': 0.3554870694774928, 'f1-score': 0.25055391734481014, 'support': 6129064}}
[[1738082    8125  132642]
 [2052850   21842  307610]
 [1437930   11104  418879]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1280574
{'0': {'precision': 0.3260791441133388, 'recall': 0.9222552143877821, 'f1-score': 0.48180711988527986, 'support': 1876203}, '1': {'precision': 0.47658291457286434, 'recall': 0.003966403508368383, 'f1-score': 0.007867330462305207, 'support': 2391083}, '2': {'precision': 0.44930463068744575, 'recall': 0.19370837983905706, 'f1-score': 0.2707070327966987, 'support': 1861778}, 'accuracy': 0.3427055093567305, 'macro avg': {'precision': 0.4173222297912163, 'recall': 0.3733099992450692, 'f1-score': 0.2534604943814279, 'support': 6129064}, 'weighted avg': {'precision': 0.42222522888658337, 'recall': 0.3427055093567305, 'f1-score': 0.23278853051299417, 'support': 6129064}}
[[1730338    4813  141052]
 [2080626    9484  300973]
 [1495533    5603  360642]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.118281
{'0': {'precision': 0.3296273946015753, 'recall': 0.9244158758886021, 'f1-score': 0.4859685528688141, 'support': 1923949}, '1': {'precision': 0.42321644498186217, 'recall': 0.0021336835477322427, 'f1-score': 0.00424596070493346, 'support': 2296498}, '2': {'precision': 0.43544504039273485, 'recall': 0.16470198054402743, 'f1-score': 0.23900363767135813, 'support': 1908617}, 'accuracy': 0.3422679221492874, 'macro avg': {'precision': 0.3960962933253908, 'recall': 0.36375051332678726, 'f1-score': 0.2430727170817019, 'support': 6129064}, 'weighted avg': {'precision': 0.39764633267714666, 'recall': 0.3422679221492874, 'f1-score': 0.2285660514414199, 'support': 6129064}}
[[1778529    3191  142229]
 [2026268    4900  265330]
 [1590777    3487  314353]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1335665
{'0': {'precision': 0.27389852805641496, 'recall': 0.9316007759716369, 'f1-score': 0.42333343606626866, 'support': 1614492}, '1': {'precision': 0.5016423357664234, 'recall': 0.0009476202803839155, 'f1-score': 0.0018916671340210725, 'support': 2900951}, '2': {'precision': 0.34479568161221497, 'recall': 0.1351029764734098, 'f1-score': 0.19413649976356853, 'support': 1613621}, 'accuracy': 0.28141588993033845, 'macro avg': {'precision': 0.3734455151450177, 'recall': 0.3558837909084769, 'f1-score': 0.2064538676546194, 'support': 6129064}, 'weighted avg': {'precision': 0.4003574396517287, 'recall': 0.28141588993033845, 'f1-score': 0.16351906464194157, 'support': 6129064}}
[[1504062    1356  109074]
 [2593008    2749  305194]
 [1394241    1375  218005]]
Evaluating performance on  train set...
9052/9052 - 88s - 88s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0990012
{'0': {'precision': 0.38350772959333673, 'recall': 0.7651717731250709, 'f1-score': 0.5109332738429496, 'support': 784203}, '1': {'precision': 0.5497285433753032, 'recall': 0.012629707279530798, 'f1-score': 0.02469212669307619, 'support': 753620}, '2': {'precision': 0.44935861684327943, 'recall': 0.42391277845434816, 'f1-score': 0.43626497057885466, 'support': 779257}, 'accuracy': 0.4056420149498507, 'macro avg': {'precision': 0.4608649632706398, 'recall': 0.4005714196196499, 'f1-score': 0.3239634570382935, 'support': 2317080}, 'weighted avg': {'precision': 0.4597166194582073, 'recall': 0.4056420149498507, 'f1-score': 0.3276738044626276, 'support': 2317080}}
[[600050   3198 180955]
 [520264   9518 223838]
 [444322   4598 330337]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1024297
{'0': {'precision': 0.3684804896498342, 'recall': 0.7525900031720877, 'f1-score': 0.49473201667519334, 'support': 778667}, '1': {'precision': 0.4968053386341048, 'recall': 0.004588443260142046, 'f1-score': 0.009092905376872212, 'support': 762568}, '2': {'precision': 0.428590087761715, 'recall': 0.3975613685723308, 'f1-score': 0.412493037543438, 'support': 775845}, 'accuracy': 0.38754035251264524, 'macro avg': {'precision': 0.431291972015218, 'recall': 0.38491327166818684, 'f1-score': 0.30543931986516787, 'support': 2317080}, 'weighted avg': {'precision': 0.4308400778329567, 'recall': 0.38754035251264524, 'f1-score': 0.3073679435361498, 'support': 2317080}}
[[586017   1502 191148]
 [538987   3499 220082]
 [465357   2042 308446]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1014595
{'0': {'precision': 0.36058833289293374, 'recall': 0.7598757862103528, 'f1-score': 0.48908722427378404, 'support': 772217}, '1': {'precision': 0.4333851736651115, 'recall': 0.0021506095537485175, 'f1-score': 0.004279980340760157, 'support': 777454}, '2': {'precision': 0.4071017856518037, 'recall': 0.36386854988669665, 'f1-score': 0.3842729858028612, 'support': 767409}, 'accuracy': 0.37447865416817716, 'macro avg': {'precision': 0.4003584307366163, 'recall': 0.3752983152169327, 'f1-score': 0.2925467301391351, 'support': 2317080}, 'weighted avg': {'precision': 0.4004190842325182, 'recall': 0.37447865416817716, 'f1-score': 0.2917048633041854, 'support': 2317080}}
[[586789    952 184476]
 [553582   1672 222200]
 [486939   1234 279236]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1018935
{'0': {'precision': 0.3532336128906426, 'recall': 0.7562973166055909, 'f1-score': 0.48155418918404824, 'support': 778268}, '1': {'precision': 0.32238035056871256, 'recall': 0.007609282105022879, 'f1-score': 0.014867636978273787, 'support': 771032}, '2': {'precision': 0.4014743358690772, 'recall': 0.33076532339993225, 'f1-score': 0.3627058077489974, 'support': 767780}, 'accuracy': 0.36616085763115647, 'macro avg': {'precision': 0.3590294331094775, 'recall': 0.36489064070351535, 'f1-score': 0.2863758779704398, 'support': 2317080}, 'weighted avg': {'precision': 0.3589517623433072, 'recall': 0.36616085763115647, 'f1-score': 0.2868782712103374, 'support': 2317080}}
[[588602   5937 183729]
 [570293   5867 194872]
 [507430   6395 253955]]
Evaluating performance on  val set...
2763/2763 - 29s - 29s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1182461
{'0': {'precision': 0.35843925938323346, 'recall': 0.8919138230091536, 'f1-score': 0.511370643468757, 'support': 232916}, '1': {'precision': 0.5646371976647206, 'recall': 0.011254213057048221, 'f1-score': 0.0220685608576423, 'support': 240621}, '2': {'precision': 0.48001594169892964, 'recall': 0.25244890451625046, 'f1-score': 0.33088140477565414, 'support': 233778}, 'accuracy': 0.38097028905084723, 'macro avg': {'precision': 0.46769746624896125, 'recall': 0.3852056468608174, 'f1-score': 0.2881068697006845, 'support': 707315}, 'weighted avg': {'precision': 0.46876847302302416, 'recall': 0.38097028905084723, 'f1-score': 0.28526096155452474, 'support': 707315}}
[[207741    757  24418]
 [198400   2708  39513]
 [173430   1331  59017]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1192027
{'0': {'precision': 0.3489353770027876, 'recall': 0.8891076625473889, 'f1-score': 0.5011798580762776, 'support': 231594}, '1': {'precision': 0.48451151707704526, 'recall': 0.005027279170581351, 'f1-score': 0.009951303865510575, 'support': 242676}, '2': {'precision': 0.449913674334246, 'recall': 0.22140359158102513, 'f1-score': 0.2967672915821895, 'support': 233045}, 'accuracy': 0.3657903480061924, 'macro avg': {'precision': 0.4277868561380263, 'recall': 0.3718461777663318, 'f1-score': 0.26929948450799257, 'support': 707315}, 'weighted avg': {'precision': 0.4287209925634223, 'recall': 0.3657903480061924, 'f1-score': 0.26529244273761393, 'support': 707315}}
[[205912    511  25171]
 [203542   1220  37914]
 [180661    787  51597]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.112694
{'0': {'precision': 0.34720372560173673, 'recall': 0.8958453684566372, 'f1-score': 0.500448213957024, 'support': 233691}, '1': {'precision': 0.42736248236953456, 'recall': 0.0025519765184470844, 'f1-score': 0.005073655920730406, 'support': 237463}, '2': {'precision': 0.4397283696349117, 'recall': 0.1916616206740317, 'f1-score': 0.26696353529246963, 'support': 236161}, 'accuracy': 0.3608293334652877, 'macro avg': {'precision': 0.404764859202061, 'recall': 0.3633529885497053, 'f1-score': 0.2574951350567413, 'support': 707315}, 'weighted avg': {'precision': 0.40500746413106264, 'recall': 0.3608293334652877, 'f1-score': 0.2561820752874465, 'support': 707315}}
[[209351    345  23995]
 [203181    606  33676]
 [190431    467  45263]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1147321
{'0': {'precision': 0.3315166334317131, 'recall': 0.9049156513381963, 'f1-score': 0.4852584229101255, 'support': 225789}, '1': {'precision': 0.37735849056603776, 'recall': 0.0023847945499495217, 'f1-score': 0.004739635995955511, 'support': 251594}, '2': {'precision': 0.4060130192604523, 'recall': 0.1578727623819216, 'f1-score': 0.22734532063205756, 'support': 229932}, 'accuracy': 0.34103617200257313, 'macro avg': {'precision': 0.37162938108606774, 'recall': 0.3550577360900225, 'f1-score': 0.23911445984604618, 'support': 707315}, 'weighted avg': {'precision': 0.37203979382026264, 'recall': 0.34103617200257313, 'f1-score': 0.23049481814013706, 'support': 707315}}
[[204320    447  21022]
 [218910    600  32084]
 [193089    543  36300]]
training model: results/AAPL/W7/deepOF_L1/seq2seq
Epoch 1/50
9052/9052 - 199s - loss: 12.9320 - accuracy10: 0.4098 - accuracy20: 0.4096 - accuracy30: 0.3978 - accuracy50: 0.3974 - val_loss: 13.1191 - val_accuracy10: 0.3733 - val_accuracy20: 0.3742 - val_accuracy30: 0.3762 - val_accuracy50: 0.3595 - 199s/epoch - 22ms/step
Epoch 2/50
9052/9052 - 194s - loss: 12.9041 - accuracy10: 0.4140 - accuracy20: 0.4138 - accuracy30: 0.4019 - accuracy50: 0.4003 - val_loss: 13.1285 - val_accuracy10: 0.3764 - val_accuracy20: 0.3766 - val_accuracy30: 0.3778 - val_accuracy50: 0.3605 - 194s/epoch - 21ms/step
Epoch 3/50
9052/9052 - 190s - loss: 12.8894 - accuracy10: 0.4170 - accuracy20: 0.4157 - accuracy30: 0.4040 - accuracy50: 0.4015 - val_loss: 13.1424 - val_accuracy10: 0.3774 - val_accuracy20: 0.3767 - val_accuracy30: 0.3774 - val_accuracy50: 0.3603 - 190s/epoch - 21ms/step
Epoch 4/50
9052/9052 - 194s - loss: 12.8743 - accuracy10: 0.4199 - accuracy20: 0.4177 - accuracy30: 0.4059 - accuracy50: 0.4036 - val_loss: 13.1478 - val_accuracy10: 0.3793 - val_accuracy20: 0.3776 - val_accuracy30: 0.3799 - val_accuracy50: 0.3641 - 194s/epoch - 21ms/step
Epoch 5/50
9052/9052 - 196s - loss: 12.8615 - accuracy10: 0.4224 - accuracy20: 0.4195 - accuracy30: 0.4074 - accuracy50: 0.4047 - val_loss: 13.1436 - val_accuracy10: 0.3789 - val_accuracy20: 0.3779 - val_accuracy30: 0.3809 - val_accuracy50: 0.3655 - 196s/epoch - 22ms/step
Epoch 6/50
9052/9052 - 193s - loss: 12.8491 - accuracy10: 0.4252 - accuracy20: 0.4214 - accuracy30: 0.4090 - accuracy50: 0.4060 - val_loss: 13.1499 - val_accuracy10: 0.3797 - val_accuracy20: 0.3785 - val_accuracy30: 0.3814 - val_accuracy50: 0.3658 - 193s/epoch - 21ms/step
Epoch 7/50
9052/9052 - 197s - loss: 12.8379 - accuracy10: 0.4274 - accuracy20: 0.4231 - accuracy30: 0.4101 - accuracy50: 0.4066 - val_loss: 13.1390 - val_accuracy10: 0.3823 - val_accuracy20: 0.3803 - val_accuracy30: 0.3828 - val_accuracy50: 0.3665 - 197s/epoch - 22ms/step
Epoch 8/50
9052/9052 - 181s - loss: 12.8264 - accuracy10: 0.4297 - accuracy20: 0.4244 - accuracy30: 0.4110 - accuracy50: 0.4074 - val_loss: 13.1317 - val_accuracy10: 0.3846 - val_accuracy20: 0.3819 - val_accuracy30: 0.3841 - val_accuracy50: 0.3677 - 181s/epoch - 20ms/step
Epoch 9/50
9052/9052 - 207s - loss: 12.8148 - accuracy10: 0.4321 - accuracy20: 0.4257 - accuracy30: 0.4124 - accuracy50: 0.4083 - val_loss: 13.1175 - val_accuracy10: 0.3872 - val_accuracy20: 0.3826 - val_accuracy30: 0.3831 - val_accuracy50: 0.3657 - 207s/epoch - 23ms/step
Epoch 10/50
9052/9052 - 180s - loss: 12.8043 - accuracy10: 0.4341 - accuracy20: 0.4272 - accuracy30: 0.4132 - accuracy50: 0.4088 - val_loss: 13.1142 - val_accuracy10: 0.3877 - val_accuracy20: 0.3840 - val_accuracy30: 0.3850 - val_accuracy50: 0.3672 - 180s/epoch - 20ms/step
Epoch 11/50
9052/9052 - 199s - loss: 12.7933 - accuracy10: 0.4359 - accuracy20: 0.4283 - accuracy30: 0.4140 - accuracy50: 0.4092 - val_loss: 13.1220 - val_accuracy10: 0.3873 - val_accuracy20: 0.3837 - val_accuracy30: 0.3844 - val_accuracy50: 0.3668 - 199s/epoch - 22ms/step
Epoch 12/50
9052/9052 - 190s - loss: 12.7839 - accuracy10: 0.4381 - accuracy20: 0.4296 - accuracy30: 0.4151 - accuracy50: 0.4098 - val_loss: 13.1202 - val_accuracy10: 0.3888 - val_accuracy20: 0.3837 - val_accuracy30: 0.3846 - val_accuracy50: 0.3671 - 190s/epoch - 21ms/step
Epoch 13/50
9052/9052 - 192s - loss: 12.7755 - accuracy10: 0.4399 - accuracy20: 0.4307 - accuracy30: 0.4158 - accuracy50: 0.4106 - val_loss: 13.1093 - val_accuracy10: 0.3898 - val_accuracy20: 0.3857 - val_accuracy30: 0.3863 - val_accuracy50: 0.3691 - 192s/epoch - 21ms/step
Epoch 14/50
9052/9052 - 193s - loss: 12.7660 - accuracy10: 0.4415 - accuracy20: 0.4319 - accuracy30: 0.4167 - accuracy50: 0.4112 - val_loss: 13.1276 - val_accuracy10: 0.3899 - val_accuracy20: 0.3839 - val_accuracy30: 0.3839 - val_accuracy50: 0.3660 - 193s/epoch - 21ms/step
Epoch 15/50
9052/9052 - 186s - loss: 12.7590 - accuracy10: 0.4428 - accuracy20: 0.4328 - accuracy30: 0.4174 - accuracy50: 0.4115 - val_loss: 13.1305 - val_accuracy10: 0.3892 - val_accuracy20: 0.3834 - val_accuracy30: 0.3831 - val_accuracy50: 0.3646 - 186s/epoch - 20ms/step
Epoch 16/50
9052/9052 - 192s - loss: 12.7516 - accuracy10: 0.4438 - accuracy20: 0.4336 - accuracy30: 0.4181 - accuracy50: 0.4120 - val_loss: 13.1097 - val_accuracy10: 0.3907 - val_accuracy20: 0.3858 - val_accuracy30: 0.3855 - val_accuracy50: 0.3672 - 192s/epoch - 21ms/step
Epoch 17/50
9052/9052 - 189s - loss: 12.7445 - accuracy10: 0.4452 - accuracy20: 0.4346 - accuracy30: 0.4185 - accuracy50: 0.4125 - val_loss: 13.1002 - val_accuracy10: 0.3944 - val_accuracy20: 0.3874 - val_accuracy30: 0.3866 - val_accuracy50: 0.3676 - 189s/epoch - 21ms/step
Epoch 18/50
9052/9052 - 196s - loss: 12.7381 - accuracy10: 0.4465 - accuracy20: 0.4350 - accuracy30: 0.4192 - accuracy50: 0.4131 - val_loss: 13.1019 - val_accuracy10: 0.3936 - val_accuracy20: 0.3879 - val_accuracy30: 0.3874 - val_accuracy50: 0.3677 - 196s/epoch - 22ms/step
Epoch 19/50
9052/9052 - 181s - loss: 12.7311 - accuracy10: 0.4477 - accuracy20: 0.4358 - accuracy30: 0.4200 - accuracy50: 0.4134 - val_loss: 13.1088 - val_accuracy10: 0.3941 - val_accuracy20: 0.3881 - val_accuracy30: 0.3869 - val_accuracy50: 0.3673 - 181s/epoch - 20ms/step
Epoch 20/50
9052/9052 - 185s - loss: 12.7241 - accuracy10: 0.4487 - accuracy20: 0.4367 - accuracy30: 0.4205 - accuracy50: 0.4137 - val_loss: 13.0858 - val_accuracy10: 0.3971 - val_accuracy20: 0.3908 - val_accuracy30: 0.3893 - val_accuracy50: 0.3692 - 185s/epoch - 20ms/step
Epoch 21/50
9052/9052 - 192s - loss: 12.7173 - accuracy10: 0.4498 - accuracy20: 0.4375 - accuracy30: 0.4210 - accuracy50: 0.4142 - val_loss: 13.0872 - val_accuracy10: 0.3970 - val_accuracy20: 0.3911 - val_accuracy30: 0.3897 - val_accuracy50: 0.3699 - 192s/epoch - 21ms/step
Epoch 22/50
9052/9052 - 198s - loss: 12.7118 - accuracy10: 0.4507 - accuracy20: 0.4381 - accuracy30: 0.4216 - accuracy50: 0.4145 - val_loss: 13.0883 - val_accuracy10: 0.3978 - val_accuracy20: 0.3914 - val_accuracy30: 0.3904 - val_accuracy50: 0.3703 - 198s/epoch - 22ms/step
Epoch 23/50
9052/9052 - 190s - loss: 12.7060 - accuracy10: 0.4515 - accuracy20: 0.4387 - accuracy30: 0.4223 - accuracy50: 0.4153 - val_loss: 13.1113 - val_accuracy10: 0.3948 - val_accuracy20: 0.3886 - val_accuracy30: 0.3873 - val_accuracy50: 0.3677 - 190s/epoch - 21ms/step
Epoch 24/50
9052/9052 - 195s - loss: 12.7011 - accuracy10: 0.4521 - accuracy20: 0.4392 - accuracy30: 0.4226 - accuracy50: 0.4156 - val_loss: 13.0973 - val_accuracy10: 0.3965 - val_accuracy20: 0.3906 - val_accuracy30: 0.3885 - val_accuracy50: 0.3687 - 195s/epoch - 22ms/step
Epoch 25/50
9052/9052 - 190s - loss: 12.6964 - accuracy10: 0.4530 - accuracy20: 0.4401 - accuracy30: 0.4234 - accuracy50: 0.4157 - val_loss: 13.1079 - val_accuracy10: 0.3967 - val_accuracy20: 0.3904 - val_accuracy30: 0.3889 - val_accuracy50: 0.3685 - 190s/epoch - 21ms/step
Epoch 26/50
9052/9052 - 193s - loss: 12.6917 - accuracy10: 0.4536 - accuracy20: 0.4405 - accuracy30: 0.4236 - accuracy50: 0.4163 - val_loss: 13.0919 - val_accuracy10: 0.3985 - val_accuracy20: 0.3925 - val_accuracy30: 0.3904 - val_accuracy50: 0.3695 - 193s/epoch - 21ms/step
Epoch 27/50
9052/9052 - 193s - loss: 12.6886 - accuracy10: 0.4537 - accuracy20: 0.4408 - accuracy30: 0.4238 - accuracy50: 0.4163 - val_loss: 13.0951 - val_accuracy10: 0.3981 - val_accuracy20: 0.3911 - val_accuracy30: 0.3890 - val_accuracy50: 0.3686 - 193s/epoch - 21ms/step
Epoch 28/50
9052/9052 - 188s - loss: 12.6845 - accuracy10: 0.4544 - accuracy20: 0.4411 - accuracy30: 0.4241 - accuracy50: 0.4163 - val_loss: 13.1069 - val_accuracy10: 0.3986 - val_accuracy20: 0.3918 - val_accuracy30: 0.3899 - val_accuracy50: 0.3697 - 188s/epoch - 21ms/step
Epoch 29/50
9052/9052 - 197s - loss: 12.6802 - accuracy10: 0.4550 - accuracy20: 0.4416 - accuracy30: 0.4246 - accuracy50: 0.4166 - val_loss: 13.1090 - val_accuracy10: 0.3969 - val_accuracy20: 0.3909 - val_accuracy30: 0.3893 - val_accuracy50: 0.3692 - 197s/epoch - 22ms/step
Epoch 30/50
9052/9052 - 189s - loss: 12.6746 - accuracy10: 0.4558 - accuracy20: 0.4422 - accuracy30: 0.4253 - accuracy50: 0.4172 - val_loss: 13.0873 - val_accuracy10: 0.3992 - val_accuracy20: 0.3934 - val_accuracy30: 0.3915 - val_accuracy50: 0.3704 - 189s/epoch - 21ms/step
testing model: results/AAPL/W7/deepOF_L1/seq2seq
Evaluating performance on  test set...
23942/23942 - 212s - 212s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1096091
{'0': {'precision': 0.34678434231116523, 'recall': 0.6469497766182007, 'f1-score': 0.4515333599184689, 'support': 1878846}, '1': {'precision': 0.46355024508595266, 'recall': 0.07891656008203833, 'f1-score': 0.13487199739729896, 'support': 2382301}, '2': {'precision': 0.3690720041543979, 'recall': 0.4383177580100133, 'f1-score': 0.4007254512902187, 'support': 1867912}, 'accuracy': 0.3625778443314055, 'macro avg': {'precision': 0.393135530517172, 'recall': 0.38806136490341747, 'f1-score': 0.32904360286866213, 'support': 6129059}, 'weighted avg': {'precision': 0.39896248547395663, 'recall': 0.3625778443314055, 'f1-score': 0.3129660231026285, 'support': 6129059}}
[[1215519  101310  562017]
 [1356682  188003  837616]
 [ 932914  116259  818739]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1115317
{'0': {'precision': 0.3385755657447602, 'recall': 0.6683631808975589, 'f1-score': 0.4494641662165393, 'support': 1876200}, '1': {'precision': 0.457466025522202, 'recall': 0.052638930827131815, 'f1-score': 0.09441399136978824, 'support': 2391082}, '2': {'precision': 0.3626184992819353, 'recall': 0.4187993513723717, 'f1-score': 0.3886893348231967, 'support': 1861777}, 'accuracy': 0.35234739949476745, 'macro avg': {'precision': 0.38622003018296586, 'recall': 0.3799338210323541, 'f1-score': 0.31085583080317475, 'support': 6129059}, 'weighted avg': {'precision': 0.39226071040034377, 'recall': 0.35234739949476745, 'f1-score': 0.2924901078105226, 'support': 6129059}}
[[1253983   73090  549127]
 [1443832  125864  821386]
 [1005887   76179  779711]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1058449
{'0': {'precision': 0.3425692635329434, 'recall': 0.6740495835122191, 'f1-score': 0.4542679295777608, 'support': 1923946}, '1': {'precision': 0.4406779661016949, 'recall': 0.05271335112275397, 'f1-score': 0.09416303671437462, 'support': 2296496}, '2': {'precision': 0.3682123571776264, 'recall': 0.39910364415699956, 'f1-score': 0.38303617627580927, 'support': 1908617}, 'accuracy': 0.3556218009975104, 'macro avg': {'precision': 0.38381986227075493, 'recall': 0.3752888595973242, 'f1-score': 0.3104890475226482, 'support': 6129059}, 'weighted avg': {'precision': 0.38731497204662574, 'recall': 0.3556218009975104, 'f1-score': 0.29715839916973147, 'support': 6129059}}
[[1296835   76418  550693]
 [1419128  121056  756312]
 [1069651   77230  761736]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1223787
{'0': {'precision': 0.28565857079661466, 'recall': 0.6791480152543622, 'f1-score': 0.40216236953977025, 'support': 1614489}, '1': {'precision': 0.5226884515410323, 'recall': 0.04609594998050638, 'f1-score': 0.0847203989883375, 'support': 2900949}, '2': {'precision': 0.30709217488055374, 'recall': 0.3872489264827367, 'f1-score': 0.3425437866784782, 'support': 1613621}, 'accuracy': 0.30266832151558665, 'macro avg': {'precision': 0.37181306573940026, 'recall': 0.3708309639058684, 'f1-score': 0.2764755184021953, 'support': 6129059}, 'weighted avg': {'precision': 0.4034902492273766, 'recall': 0.30266832151558665, 'f1-score': 0.23621768466654106, 'support': 6129059}}
[[1096477   59663  458349]
 [1815643  133722  951584]
 [ 926298   62450  624873]]
Evaluating performance on  train set...
9052/9052 - 89s - 89s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.069974
{'0': {'precision': 0.4065414911405424, 'recall': 0.6088858682485074, 'f1-score': 0.487553081022137, 'support': 784234}, '1': {'precision': 0.4622666944980779, 'recall': 0.14113062758062161, 'f1-score': 0.2162422215577024, 'support': 753210}, '2': {'precision': 0.42368046743330284, 'recall': 0.4959160323946878, 'f1-score': 0.4569611486167054, 'support': 779634}, 'accuracy': 0.4188218955080494, 'macro avg': {'precision': 0.43082955102397436, 'recall': 0.41531084274127233, 'f1-score': 0.3869188170655149, 'support': 2317078}, 'weighted avg': {'precision': 0.4304228231733696, 'recall': 0.4188218955080494, 'f1-score': 0.3890650011706245, 'support': 2317078}}
[[477509  57874 248851]
 [369835 106301 277074]
 [327220  65781 386633]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0765628
{'0': {'precision': 0.3955007256894049, 'recall': 0.6268304374030567, 'f1-score': 0.48499332080850277, 'support': 778161}, '1': {'precision': 0.4487005955603682, 'recall': 0.10862484550040828, 'f1-score': 0.17490690098739298, 'support': 762947}, '2': {'precision': 0.41850338350380617, 'recall': 0.4848937458922381, 'f1-score': 0.4492590615854685, 'support': 775970}, 'accuracy': 0.4086668640416939, 'macro avg': {'precision': 0.4209015682511931, 'recall': 0.40678300959856767, 'f1-score': 0.36971976112712146, 'support': 2317078}, 'weighted avg': {'precision': 0.4207213067413518, 'recall': 0.4086668640416939, 'f1-score': 0.3709236965349331, 'support': 2317078}}
[[487775  49347 241039]
 [398306  82875 281766]
 [347229  52478 376263]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0812938
{'0': {'precision': 0.38719079190390665, 'recall': 0.6300743230025612, 'f1-score': 0.47963696485180324, 'support': 771901}, '1': {'precision': 0.4242339501090103, 'recall': 0.1053144456400308, 'f1-score': 0.16873986829556667, 'support': 777861}, '2': {'precision': 0.4110339741780116, 'recall': 0.46489581867183793, 'f1-score': 0.4363088856829917, 'support': 767316}, 'accuracy': 0.39920839954459886, 'macro avg': {'precision': 0.40748623873030954, 'recall': 0.4000948624381433, 'f1-score': 0.3615619062767872, 'support': 2317078}, 'weighted avg': {'precision': 0.40752229707309695, 'recall': 0.39920839954459886, 'f1-score': 0.36091802020694164, 'support': 2317078}}
[[486355  54609 230937]
 [415735  81920 280206]
 [354022  56572 356722]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869054
{'0': {'precision': 0.3807906446154942, 'recall': 0.625111661510422, 'f1-score': 0.47327990222028454, 'support': 778021}, '1': {'precision': 0.38358605386141276, 'recall': 0.08870154742437161, 'f1-score': 0.14408456396180983, 'support': 771734}, '2': {'precision': 0.40138772638781345, 'recall': 0.45060424358451395, 'f1-score': 0.42457445423802076, 'support': 767323}, 'accuracy': 0.3886632215229699, 'macro avg': {'precision': 0.38858814162157346, 'recall': 0.3881391508397692, 'f1-score': 0.34731297347337176, 'support': 2317078}, 'weighted avg': {'precision': 0.38854261797839834, 'recall': 0.3886632215229699, 'f1-score': 0.34750768150192274, 'support': 2317078}}
[[486350  54413 237258]
 [424888  68454 278392]
 [365973  55591 345759]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0846717
{'0': {'precision': 0.38417577510313444, 'recall': 0.6208226662772117, 'f1-score': 0.47463760976795205, 'support': 232804}, '1': {'precision': 0.44078682014209924, 'recall': 0.1181671490834082, 'f1-score': 0.1863714178893998, 'support': 240456}, '2': {'precision': 0.40510943430191565, 'recall': 0.4615174276021773, 'f1-score': 0.43147765719056197, 'support': 234054}, 'accuracy': 0.3972266913987281, 'macro avg': {'precision': 0.4100240098490498, 'recall': 0.40016908098759907, 'f1-score': 0.36416222828263795, 'support': 707314}, 'weighted avg': {'precision': 0.4103481287056376, 'recall': 0.3972266913987281, 'f1-score': 0.3623577807600466, 'support': 707314}}
[[144530  16391  71883]
 [125301  28414  86741]
 [106377  19657 108020]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879195
{'0': {'precision': 0.376194777322944, 'recall': 0.6450641517899515, 'f1-score': 0.47523651059271865, 'support': 231794}, '1': {'precision': 0.44906118518828625, 'recall': 0.0886007987411773, 'f1-score': 0.14800071747888957, 'support': 242131}, '2': {'precision': 0.40226722934043546, 'recall': 0.4517222319817986, 'f1-score': 0.425562747365638, 'support': 233389}, 'accuracy': 0.390776939237736, 'macro avg': {'precision': 0.4091743972838886, 'recall': 0.3951290608376425, 'f1-score': 0.34959999181241536, 'support': 707314}, 'weighted avg': {'precision': 0.4097417447331091, 'recall': 0.390776939237736, 'f1-score': 0.34682502750564603, 'support': 707314}}
[[149522  12436  69836]
 [133859  21453  86819]
 [114078  13884 105427]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0884881
{'0': {'precision': 0.3751396689292623, 'recall': 0.6521372677371189, 'f1-score': 0.47629329537802456, 'support': 233733}, '1': {'precision': 0.430722703097299, 'recall': 0.08707072836513123, 'f1-score': 0.14485830527497195, 'support': 237175}, '2': {'precision': 0.4028911168104453, 'recall': 0.4312580898961955, 'f1-score': 0.4165922644890154, 'support': 236406}, 'accuracy': 0.3888357928727552, 'macro avg': {'precision': 0.4029178296123355, 'recall': 0.3901553619994818, 'f1-score': 0.34591462171400394, 'support': 707314}, 'weighted avg': {'precision': 0.4030530354349487, 'recall': 0.3888357928727552, 'f1-score': 0.34520331881027866, 'support': 707314}}
[[152426  12939  68368]
 [133793  20651  82731]
 [120099  14355 101952]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967729
{'0': {'precision': 0.3555364474210074, 'recall': 0.6499887081704137, 'f1-score': 0.4596497161341638, 'support': 225827}, '1': {'precision': 0.41324332419418014, 'recall': 0.0712254785164006, 'f1-score': 0.12150814807789366, 'support': 251820}, '2': {'precision': 0.3824326046778408, 'recall': 0.41804874013245263, 'f1-score': 0.3994483309515043, 'support': 229667}, 'accuracy': 0.3686241188496198, 'macro avg': {'precision': 0.3837374587643428, 'recall': 0.37975430893975565, 'f1-score': 0.3268687317211872, 'support': 707314}, 'weighted avg': {'precision': 0.3848146823459848, 'recall': 0.3686241188496198, 'f1-score': 0.319715993348137, 'support': 707314}}
[[146785  12073  66969]
 [145809  17936  88075]
 [120261  13394  96012]]
training model: results/AAPL/W7/deepLOB_L2/seq2seq
Epoch 1/50
9052/9052 - 421s - loss: 12.7323 - accuracy10: 0.4605 - accuracy20: 0.4335 - accuracy30: 0.4094 - accuracy50: 0.4028 - val_loss: 14.4641 - val_accuracy10: 0.3570 - val_accuracy20: 0.3423 - val_accuracy30: 0.3394 - val_accuracy50: 0.3251 - 421s/epoch - 47ms/step
Epoch 2/50
9052/9052 - 408s - loss: 12.5330 - accuracy10: 0.4897 - accuracy20: 0.4560 - accuracy30: 0.4280 - accuracy50: 0.4155 - val_loss: 13.7468 - val_accuracy10: 0.3768 - val_accuracy20: 0.3588 - val_accuracy30: 0.3535 - val_accuracy50: 0.3359 - 408s/epoch - 45ms/step
Epoch 3/50
9052/9052 - 401s - loss: 12.4343 - accuracy10: 0.5012 - accuracy20: 0.4659 - accuracy30: 0.4368 - accuracy50: 0.4210 - val_loss: 13.5452 - val_accuracy10: 0.4063 - val_accuracy20: 0.3777 - val_accuracy30: 0.3664 - val_accuracy50: 0.3440 - 401s/epoch - 44ms/step
Epoch 4/50
9052/9052 - 405s - loss: 12.3828 - accuracy10: 0.5067 - accuracy20: 0.4702 - accuracy30: 0.4406 - accuracy50: 0.4244 - val_loss: 13.5464 - val_accuracy10: 0.4108 - val_accuracy20: 0.3821 - val_accuracy30: 0.3699 - val_accuracy50: 0.3477 - 405s/epoch - 45ms/step
Epoch 5/50
9052/9052 - 403s - loss: 12.3486 - accuracy10: 0.5101 - accuracy20: 0.4733 - accuracy30: 0.4434 - accuracy50: 0.4273 - val_loss: 13.3805 - val_accuracy10: 0.4225 - val_accuracy20: 0.3904 - val_accuracy30: 0.3774 - val_accuracy50: 0.3531 - 403s/epoch - 45ms/step
Epoch 6/50
9052/9052 - 404s - loss: 12.3227 - accuracy10: 0.5128 - accuracy20: 0.4756 - accuracy30: 0.4455 - accuracy50: 0.4288 - val_loss: 13.1164 - val_accuracy10: 0.4398 - val_accuracy20: 0.4053 - val_accuracy30: 0.3898 - val_accuracy50: 0.3628 - 404s/epoch - 45ms/step
Epoch 7/50
9052/9052 - 408s - loss: 12.2992 - accuracy10: 0.5151 - accuracy20: 0.4777 - accuracy30: 0.4477 - accuracy50: 0.4308 - val_loss: 12.9983 - val_accuracy10: 0.4528 - val_accuracy20: 0.4155 - val_accuracy30: 0.3982 - val_accuracy50: 0.3697 - 408s/epoch - 45ms/step
Epoch 8/50
9052/9052 - 411s - loss: 12.2810 - accuracy10: 0.5169 - accuracy20: 0.4794 - accuracy30: 0.4493 - accuracy50: 0.4324 - val_loss: 13.0331 - val_accuracy10: 0.4471 - val_accuracy20: 0.4110 - val_accuracy30: 0.3952 - val_accuracy50: 0.3673 - 411s/epoch - 45ms/step
Epoch 9/50
9052/9052 - 404s - loss: 12.2640 - accuracy10: 0.5185 - accuracy20: 0.4808 - accuracy30: 0.4507 - accuracy50: 0.4333 - val_loss: 13.0704 - val_accuracy10: 0.4450 - val_accuracy20: 0.4076 - val_accuracy30: 0.3916 - val_accuracy50: 0.3651 - 404s/epoch - 45ms/step
Epoch 10/50
9052/9052 - 572s - loss: 12.2486 - accuracy10: 0.5199 - accuracy20: 0.4819 - accuracy30: 0.4522 - accuracy50: 0.4346 - val_loss: 12.9199 - val_accuracy10: 0.4569 - val_accuracy20: 0.4196 - val_accuracy30: 0.4029 - val_accuracy50: 0.3746 - 572s/epoch - 63ms/step
Epoch 11/50
9052/9052 - 448s - loss: 12.2347 - accuracy10: 0.5211 - accuracy20: 0.4832 - accuracy30: 0.4535 - accuracy50: 0.4357 - val_loss: 12.9470 - val_accuracy10: 0.4552 - val_accuracy20: 0.4174 - val_accuracy30: 0.4010 - val_accuracy50: 0.3721 - 448s/epoch - 49ms/step
Epoch 12/50
9052/9052 - 413s - loss: 12.2210 - accuracy10: 0.5224 - accuracy20: 0.4846 - accuracy30: 0.4546 - accuracy50: 0.4367 - val_loss: 13.1140 - val_accuracy10: 0.4447 - val_accuracy20: 0.4079 - val_accuracy30: 0.3921 - val_accuracy50: 0.3653 - 413s/epoch - 46ms/step
Epoch 13/50
9052/9052 - 418s - loss: 12.2097 - accuracy10: 0.5236 - accuracy20: 0.4854 - accuracy30: 0.4556 - accuracy50: 0.4372 - val_loss: 12.9904 - val_accuracy10: 0.4538 - val_accuracy20: 0.4179 - val_accuracy30: 0.4016 - val_accuracy50: 0.3731 - 418s/epoch - 46ms/step
Epoch 14/50
9052/9052 - 418s - loss: 12.1981 - accuracy10: 0.5245 - accuracy20: 0.4862 - accuracy30: 0.4566 - accuracy50: 0.4383 - val_loss: 12.9310 - val_accuracy10: 0.4575 - val_accuracy20: 0.4201 - val_accuracy30: 0.4029 - val_accuracy50: 0.3745 - 418s/epoch - 46ms/step
Epoch 15/50
9052/9052 - 422s - loss: 12.1867 - accuracy10: 0.5257 - accuracy20: 0.4876 - accuracy30: 0.4576 - accuracy50: 0.4391 - val_loss: 13.0129 - val_accuracy10: 0.4514 - val_accuracy20: 0.4137 - val_accuracy30: 0.3969 - val_accuracy50: 0.3695 - 422s/epoch - 47ms/step
Epoch 16/50
9052/9052 - 414s - loss: 12.1766 - accuracy10: 0.5263 - accuracy20: 0.4883 - accuracy30: 0.4587 - accuracy50: 0.4401 - val_loss: 13.1268 - val_accuracy10: 0.4474 - val_accuracy20: 0.4121 - val_accuracy30: 0.3971 - val_accuracy50: 0.3697 - 414s/epoch - 46ms/step
Epoch 17/50
9052/9052 - 405s - loss: 12.1670 - accuracy10: 0.5271 - accuracy20: 0.4892 - accuracy30: 0.4596 - accuracy50: 0.4407 - val_loss: 13.0328 - val_accuracy10: 0.4524 - val_accuracy20: 0.4170 - val_accuracy30: 0.4000 - val_accuracy50: 0.3713 - 405s/epoch - 45ms/step
Epoch 18/50
9052/9052 - 403s - loss: 12.1593 - accuracy10: 0.5274 - accuracy20: 0.4897 - accuracy30: 0.4603 - accuracy50: 0.4413 - val_loss: 13.0943 - val_accuracy10: 0.4474 - val_accuracy20: 0.4121 - val_accuracy30: 0.3959 - val_accuracy50: 0.3680 - 403s/epoch - 45ms/step
Epoch 19/50
9052/9052 - 405s - loss: 12.1510 - accuracy10: 0.5283 - accuracy20: 0.4905 - accuracy30: 0.4610 - accuracy50: 0.4419 - val_loss: 12.9145 - val_accuracy10: 0.4632 - val_accuracy20: 0.4258 - val_accuracy30: 0.4070 - val_accuracy50: 0.3766 - 405s/epoch - 45ms/step
Epoch 20/50
9052/9052 - 405s - loss: 12.1424 - accuracy10: 0.5291 - accuracy20: 0.4910 - accuracy30: 0.4618 - accuracy50: 0.4427 - val_loss: 13.0270 - val_accuracy10: 0.4521 - val_accuracy20: 0.4173 - val_accuracy30: 0.4013 - val_accuracy50: 0.3728 - 405s/epoch - 45ms/step
Epoch 21/50
9052/9052 - 406s - loss: 12.1348 - accuracy10: 0.5295 - accuracy20: 0.4918 - accuracy30: 0.4624 - accuracy50: 0.4434 - val_loss: 12.9813 - val_accuracy10: 0.4568 - val_accuracy20: 0.4206 - val_accuracy30: 0.4023 - val_accuracy50: 0.3726 - 406s/epoch - 45ms/step
Epoch 22/50
9052/9052 - 407s - loss: 12.1273 - accuracy10: 0.5300 - accuracy20: 0.4924 - accuracy30: 0.4634 - accuracy50: 0.4442 - val_loss: 13.0705 - val_accuracy10: 0.4503 - val_accuracy20: 0.4146 - val_accuracy30: 0.3977 - val_accuracy50: 0.3687 - 407s/epoch - 45ms/step
Epoch 23/50
9052/9052 - 405s - loss: 12.1211 - accuracy10: 0.5307 - accuracy20: 0.4930 - accuracy30: 0.4639 - accuracy50: 0.4443 - val_loss: 13.1312 - val_accuracy10: 0.4473 - val_accuracy20: 0.4132 - val_accuracy30: 0.3965 - val_accuracy50: 0.3680 - 405s/epoch - 45ms/step
Epoch 24/50
9052/9052 - 418s - loss: 12.1140 - accuracy10: 0.5308 - accuracy20: 0.4934 - accuracy30: 0.4641 - accuracy50: 0.4450 - val_loss: 13.0643 - val_accuracy10: 0.4512 - val_accuracy20: 0.4148 - val_accuracy30: 0.3972 - val_accuracy50: 0.3676 - 418s/epoch - 46ms/step
Epoch 25/50
9052/9052 - 419s - loss: 12.1086 - accuracy10: 0.5313 - accuracy20: 0.4940 - accuracy30: 0.4646 - accuracy50: 0.4456 - val_loss: 13.1251 - val_accuracy10: 0.4497 - val_accuracy20: 0.4143 - val_accuracy30: 0.3971 - val_accuracy50: 0.3681 - 419s/epoch - 46ms/step
Epoch 26/50
9052/9052 - 416s - loss: 12.1019 - accuracy10: 0.5318 - accuracy20: 0.4943 - accuracy30: 0.4654 - accuracy50: 0.4464 - val_loss: 12.9619 - val_accuracy10: 0.4570 - val_accuracy20: 0.4217 - val_accuracy30: 0.4044 - val_accuracy50: 0.3737 - 416s/epoch - 46ms/step
Epoch 27/50
9052/9052 - 416s - loss: 12.0971 - accuracy10: 0.5322 - accuracy20: 0.4946 - accuracy30: 0.4658 - accuracy50: 0.4466 - val_loss: 13.0968 - val_accuracy10: 0.4497 - val_accuracy20: 0.4148 - val_accuracy30: 0.3980 - val_accuracy50: 0.3681 - 416s/epoch - 46ms/step
Epoch 28/50
9052/9052 - 419s - loss: 12.0900 - accuracy10: 0.5326 - accuracy20: 0.4955 - accuracy30: 0.4667 - accuracy50: 0.4473 - val_loss: 13.1028 - val_accuracy10: 0.4534 - val_accuracy20: 0.4180 - val_accuracy30: 0.3992 - val_accuracy50: 0.3680 - 419s/epoch - 46ms/step
Epoch 29/50
9052/9052 - 427s - loss: 12.0854 - accuracy10: 0.5331 - accuracy20: 0.4959 - accuracy30: 0.4671 - accuracy50: 0.4478 - val_loss: 13.2562 - val_accuracy10: 0.4492 - val_accuracy20: 0.4125 - val_accuracy30: 0.3941 - val_accuracy50: 0.3638 - 427s/epoch - 47ms/step
testing model: results/AAPL/W7/deepLOB_L2/seq2seq
Evaluating performance on  test set...
23942/23942 - 410s - 410s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0788674
{'0': {'precision': 0.39657469952548796, 'recall': 0.784531912889221, 'f1-score': 0.5268372970770517, 'support': 1878849}, '1': {'precision': 0.6018775199784033, 'recall': 0.08703556476047117, 'f1-score': 0.152079416194593, 'support': 2382302}, '2': {'precision': 0.47088063235601363, 'recall': 0.5212437624236247, 'f1-score': 0.49478390764936253, 'support': 1867913}, 'accuracy': 0.43318196709970724, 'macro avg': {'precision': 0.489777617286635, 'recall': 0.46427041335777225, 'f1-score': 0.3912335403070024, 'support': 6129064}, 'weighted avg': {'precision': 0.4990194345913784, 'recall': 0.43318196709970724, 'f1-score': 0.37140420126534435, 'support': 6129064}}
[[1474017   54341  350491]
 [1431390  207345  743567]
 [ 811464   82811  973638]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1037467
{'0': {'precision': 0.37312398600416385, 'recall': 0.7659981355962014, 'f1-score': 0.501811477813936, 'support': 1876203}, '1': {'precision': 0.5405819733552989, 'recall': 0.03952351298553835, 'f1-score': 0.07366142588454275, 'support': 2391083}, '2': {'precision': 0.4309840344575673, 'recall': 0.48671538711919465, 'f1-score': 0.4571574444555995, 'support': 1861778}, 'accuracy': 0.39774882429029945, 'macro avg': {'precision': 0.44822999793901, 'recall': 0.43074567856697815, 'f1-score': 0.34421011605135937, 'support': 6129064}, 'weighted avg': {'precision': 0.4560287349281422, 'recall': 0.39774882429029945, 'f1-score': 0.32121649503429683, 'support': 6129064}}
[[1437168   32755  406280]
 [1506487   94504  790092]
 [ 908062   47560  906156]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1026891
{'0': {'precision': 0.3687914973087758, 'recall': 0.75111190577297, 'f1-score': 0.4946921022191808, 'support': 1923949}, '1': {'precision': 0.48762229956004993, 'recall': 0.016168095944346567, 'f1-score': 0.0312984296415432, 'support': 2296498}, '2': {'precision': 0.4166658077380411, 'recall': 0.46596514649088844, 'f1-score': 0.4399386701999649, 'support': 1908617}, 'accuracy': 0.3869399960581257, 'macro avg': {'precision': 0.42435986820228894, 'recall': 0.41108171606940164, 'f1-score': 0.3219764006868963, 'support': 6129064}, 'weighted avg': {'precision': 0.42822445843579615, 'recall': 0.3869399960581257, 'f1-score': 0.3040127467013694, 'support': 6129064}}
[[1445101   16683  462165]
 [1476440   37130  782928]
 [ 996936   22332  889349]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1397681
{'0': {'precision': 0.30369732281920836, 'recall': 0.74070667429755, 'f1-score': 0.43077321534482227, 'support': 1614492}, '1': {'precision': 0.5616560146276819, 'recall': 0.011541732349150331, 'f1-score': 0.022618663200660416, 'support': 2900951}, '2': {'precision': 0.33626799214171926, 'recall': 0.44424558183117346, 'f1-score': 0.38278788428959903, 'support': 1613621}, 'accuracy': 0.3175347818198668, 'macro avg': {'precision': 0.4005404431962032, 'recall': 0.3988313294926246, 'f1-score': 0.27872658761169394, 'support': 6129064}, 'weighted avg': {'precision': 0.4343669064560153, 'recall': 0.3175347818198668, 'f1-score': 0.22495606380588926, 'support': 6129064}}
[[1195865   12450  406177]
 [1858726   33482 1008743]
 [ 883096   13681  716844]]
Evaluating performance on  train set...
9052/9052 - 152s - 152s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.034059
{'0': {'precision': 0.43700187533667767, 'recall': 0.7479262384867184, 'f1-score': 0.551670882004099, 'support': 784203}, '1': {'precision': 0.6086184273690274, 'recall': 0.151409198269685, 'f1-score': 0.24249231220420314, 'support': 753620}, '2': {'precision': 0.5020998451943579, 'recall': 0.5073717656690925, 'f1-score': 0.5047220392469246, 'support': 779257}, 'accuracy': 0.4730108584943118, 'macro avg': {'precision': 0.5159067159666876, 'recall': 0.4689024008084986, 'f1-score': 0.4329617444850755, 'support': 2317080}, 'weighted avg': {'precision': 0.5147124915605481, 'recall': 0.4730108584943118, 'f1-score': 0.4353225607838455, 'support': 2317080}}
[[586526  28864 168813]
 [416262 114105 223253]
 [339371  44513 395373]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0606583
{'0': {'precision': 0.4079300169265567, 'recall': 0.7344513123068013, 'f1-score': 0.5245266682747823, 'support': 778667}, '1': {'precision': 0.5426193133158591, 'recall': 0.10967546500771079, 'f1-score': 0.18246972837351372, 'support': 762568}, '2': {'precision': 0.47427691393925697, 'recall': 0.4652076123452494, 'f1-score': 0.469698487950059, 'support': 775845}, 'accuracy': 0.4386801491532446, 'macro avg': {'precision': 0.47494208139389094, 'recall': 0.4364447965532538, 'f1-score': 0.3922316281994516, 'support': 2317080}, 'weighted avg': {'precision': 0.4744726722003565, 'recall': 0.4386801491532446, 'f1-score': 0.39359469954229764, 'support': 2317080}}
[[571893  27537 179237]
 [458090  83635 220843]
 [371956  42960 360929]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0746336
{'0': {'precision': 0.39113713569418324, 'recall': 0.7301587507138537, 'f1-score': 0.509396682567216, 'support': 772217}, '1': {'precision': 0.49271156094410423, 'recall': 0.07751841266492937, 'f1-score': 0.13396075223584666, 'support': 777454}, '2': {'precision': 0.4475624651496243, 'recall': 0.4392872640273961, 'f1-score': 0.4433862566082852, 'support': 767409}, 'accuracy': 0.4148415246776115, 'macro avg': {'precision': 0.44380372059597056, 'recall': 0.4156548091353931, 'f1-score': 0.36224789713711597, 'support': 2317080}, 'weighted avg': {'precision': 0.4439064612506261, 'recall': 0.4148415246776115, 'f1-score': 0.3615635646970684, 'support': 2317080}}
[[563841  25072 183304]
 [484384  60267 232803]
 [393318  36978 337113]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0848249
{'0': {'precision': 0.37838794371287177, 'recall': 0.7157213196482446, 'f1-score': 0.4950516872166846, 'support': 778268}, '1': {'precision': 0.4351331438795916, 'recall': 0.053619045642723, 'f1-score': 0.0954734296950956, 'support': 771032}, '2': {'precision': 0.4290863028767626, 'recall': 0.41913568991117245, 'f1-score': 0.4240526303652434, 'support': 767780}, 'accuracy': 0.3971243979491429, 'macro avg': {'precision': 0.41420246348974205, 'recall': 0.39615868506738, 'f1-score': 0.33819258242567457, 'support': 2317080}, 'weighted avg': {'precision': 0.4140697291384067, 'recall': 0.3971243979491429, 'f1-score': 0.33856193333559914, 'support': 2317080}}
[[557023  23811 197434]
 [498953  41342 230737]
 [416119  29857 321804]]
Evaluating performance on  val set...
2763/2763 - 45s - 45s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0429235
{'0': {'precision': 0.41905252317198766, 'recall': 0.8036116024661252, 'f1-score': 0.5508552391491166, 'support': 232916}, '1': {'precision': 0.5925156512768333, 'recall': 0.17424497446191314, 'f1-score': 0.26929623420750076, 'support': 240621}, '2': {'precision': 0.5187999620841101, 'recall': 0.4214126222313477, 'f1-score': 0.4650625955928171, 'support': 233778}, 'accuracy': 0.46318542657797446, 'macro avg': {'precision': 0.5101227121776436, 'recall': 0.46642306638646197, 'f1-score': 0.4284046896498115, 'support': 707315}, 'weighted avg': {'precision': 0.5110308187287257, 'recall': 0.46318542657797446, 'f1-score': 0.426716147014267, 'support': 707315}}
[[187174  10126  35616]
 [142933  41927  55761]
 [116553  18708  98517]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0735567
{'0': {'precision': 0.3935701415920178, 'recall': 0.7998177845712756, 'f1-score': 0.527547483630999, 'support': 231594}, '1': {'precision': 0.5301317014766529, 'recall': 0.1149475020191531, 'f1-score': 0.18892971435344316, 'support': 242676}, '2': {'precision': 0.47929344518821176, 'recall': 0.3785234611341157, 'f1-score': 0.4229895970443042, 'support': 233045}, 'accuracy': 0.42603507630970644, 'macro avg': {'precision': 0.4676650960856275, 'recall': 0.43109624924151485, 'f1-score': 0.37982226500958216, 'support': 707315}, 'weighted avg': {'precision': 0.4686676588129713, 'recall': 0.42603507630970644, 'f1-score': 0.3769199719045455, 'support': 707315}}
[[185233   9023  37338]
 [156284  27895  58497]
 [129131  15701  88213]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0826399
{'0': {'precision': 0.3820583604277856, 'recall': 0.7995087530114553, 'f1-score': 0.5170404623637613, 'support': 233691}, '1': {'precision': 0.47979914579245064, 'recall': 0.0700151181447215, 'f1-score': 0.12219833526266469, 'support': 237463}, '2': {'precision': 0.45852869582264627, 'recall': 0.35654066505477194, 'f1-score': 0.40115389929346296, 'support': 236161}, 'accuracy': 0.4066999851551289, 'macro avg': {'precision': 0.44012873401429414, 'recall': 0.40868817873698293, 'f1-score': 0.34679756563996295, 'support': 707315}, 'weighted avg': {'precision': 0.4404045442245878, 'recall': 0.4066999851551289, 'f1-score': 0.3457896297799021, 'support': 707315}}
[[186838   6785  40068]
 [161473  16626  59364]
 [140719  11241  84201]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0984833
{'0': {'precision': 0.35692863104675265, 'recall': 0.7916771853367525, 'f1-score': 0.49202650720139834, 'support': 225789}, '1': {'precision': 0.4388296705706891, 'recall': 0.03976247446282503, 'f1-score': 0.07291784351527565, 'support': 251594}, '2': {'precision': 0.4214041543285142, 'recall': 0.3366951968408051, 'f1-score': 0.37431704557542234, 'support': 229932}, 'accuracy': 0.3763146547153673, 'macro avg': {'precision': 0.405720818648652, 'recall': 0.3893782855467942, 'f1-score': 0.31308713209736544, 'support': 707315}, 'weighted avg': {'precision': 0.40702059312476213, 'recall': 0.3763146547153673, 'f1-score': 0.3046836725915989, 'support': 707315}}
[[178752   5358  41679]
 [176974  10004  64616]
 [145080   7435  77417]]
training model: results/AAPL/W7/deepOF_L2/seq2seq
Epoch 1/50
9052/9052 - 258s - loss: 12.5147 - accuracy10: 0.4904 - accuracy20: 0.4578 - accuracy30: 0.4306 - accuracy50: 0.4160 - val_loss: 12.7478 - val_accuracy10: 0.4674 - val_accuracy20: 0.4298 - val_accuracy30: 0.4104 - val_accuracy50: 0.3797 - 258s/epoch - 29ms/step
Epoch 2/50
9052/9052 - 251s - loss: 12.3709 - accuracy10: 0.5076 - accuracy20: 0.4718 - accuracy30: 0.4421 - accuracy50: 0.4248 - val_loss: 12.6720 - val_accuracy10: 0.4760 - val_accuracy20: 0.4377 - val_accuracy30: 0.4182 - val_accuracy50: 0.3866 - 251s/epoch - 28ms/step
Epoch 3/50
9052/9052 - 244s - loss: 12.3171 - accuracy10: 0.5132 - accuracy20: 0.4769 - accuracy30: 0.4473 - accuracy50: 0.4287 - val_loss: 12.6487 - val_accuracy10: 0.4776 - val_accuracy20: 0.4399 - val_accuracy30: 0.4208 - val_accuracy50: 0.3890 - 244s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 242s - loss: 12.2823 - accuracy10: 0.5165 - accuracy20: 0.4801 - accuracy30: 0.4505 - accuracy50: 0.4313 - val_loss: 12.6487 - val_accuracy10: 0.4783 - val_accuracy20: 0.4402 - val_accuracy30: 0.4209 - val_accuracy50: 0.3892 - 242s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 241s - loss: 12.2565 - accuracy10: 0.5191 - accuracy20: 0.4824 - accuracy30: 0.4528 - accuracy50: 0.4331 - val_loss: 12.6506 - val_accuracy10: 0.4788 - val_accuracy20: 0.4409 - val_accuracy30: 0.4220 - val_accuracy50: 0.3901 - 241s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 248s - loss: 12.2354 - accuracy10: 0.5208 - accuracy20: 0.4843 - accuracy30: 0.4547 - accuracy50: 0.4346 - val_loss: 12.6724 - val_accuracy10: 0.4766 - val_accuracy20: 0.4381 - val_accuracy30: 0.4205 - val_accuracy50: 0.3891 - 248s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 244s - loss: 12.2167 - accuracy10: 0.5229 - accuracy20: 0.4859 - accuracy30: 0.4563 - accuracy50: 0.4359 - val_loss: 12.6903 - val_accuracy10: 0.4746 - val_accuracy20: 0.4371 - val_accuracy30: 0.4204 - val_accuracy50: 0.3896 - 244s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 248s - loss: 12.2004 - accuracy10: 0.5244 - accuracy20: 0.4872 - accuracy30: 0.4574 - accuracy50: 0.4369 - val_loss: 12.6446 - val_accuracy10: 0.4798 - val_accuracy20: 0.4411 - val_accuracy30: 0.4229 - val_accuracy50: 0.3913 - 248s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 249s - loss: 12.1861 - accuracy10: 0.5254 - accuracy20: 0.4885 - accuracy30: 0.4586 - accuracy50: 0.4376 - val_loss: 12.6318 - val_accuracy10: 0.4812 - val_accuracy20: 0.4429 - val_accuracy30: 0.4237 - val_accuracy50: 0.3918 - 249s/epoch - 28ms/step
Epoch 10/50
9052/9052 - 244s - loss: 12.1727 - accuracy10: 0.5270 - accuracy20: 0.4897 - accuracy30: 0.4598 - accuracy50: 0.4387 - val_loss: 12.6168 - val_accuracy10: 0.4835 - val_accuracy20: 0.4442 - val_accuracy30: 0.4249 - val_accuracy50: 0.3923 - 244s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 247s - loss: 12.1609 - accuracy10: 0.5280 - accuracy20: 0.4906 - accuracy30: 0.4609 - accuracy50: 0.4396 - val_loss: 12.6365 - val_accuracy10: 0.4824 - val_accuracy20: 0.4425 - val_accuracy30: 0.4234 - val_accuracy50: 0.3918 - 247s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 242s - loss: 12.1508 - accuracy10: 0.5286 - accuracy20: 0.4913 - accuracy30: 0.4616 - accuracy50: 0.4404 - val_loss: 12.6298 - val_accuracy10: 0.4837 - val_accuracy20: 0.4438 - val_accuracy30: 0.4243 - val_accuracy50: 0.3921 - 242s/epoch - 27ms/step
Epoch 13/50
9052/9052 - 239s - loss: 12.1405 - accuracy10: 0.5295 - accuracy20: 0.4921 - accuracy30: 0.4623 - accuracy50: 0.4412 - val_loss: 12.6319 - val_accuracy10: 0.4841 - val_accuracy20: 0.4437 - val_accuracy30: 0.4243 - val_accuracy50: 0.3921 - 239s/epoch - 26ms/step
Epoch 14/50
9052/9052 - 242s - loss: 12.1305 - accuracy10: 0.5302 - accuracy20: 0.4930 - accuracy30: 0.4633 - accuracy50: 0.4419 - val_loss: 12.6340 - val_accuracy10: 0.4842 - val_accuracy20: 0.4431 - val_accuracy30: 0.4242 - val_accuracy50: 0.3919 - 242s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 248s - loss: 12.1231 - accuracy10: 0.5307 - accuracy20: 0.4935 - accuracy30: 0.4640 - accuracy50: 0.4425 - val_loss: 12.6230 - val_accuracy10: 0.4844 - val_accuracy20: 0.4447 - val_accuracy30: 0.4251 - val_accuracy50: 0.3918 - 248s/epoch - 27ms/step
Epoch 16/50
9052/9052 - 253s - loss: 12.1152 - accuracy10: 0.5317 - accuracy20: 0.4940 - accuracy30: 0.4643 - accuracy50: 0.4429 - val_loss: 12.6223 - val_accuracy10: 0.4850 - val_accuracy20: 0.4443 - val_accuracy30: 0.4254 - val_accuracy50: 0.3930 - 253s/epoch - 28ms/step
Epoch 17/50
9052/9052 - 259s - loss: 12.1076 - accuracy10: 0.5324 - accuracy20: 0.4949 - accuracy30: 0.4651 - accuracy50: 0.4436 - val_loss: 12.6143 - val_accuracy10: 0.4864 - val_accuracy20: 0.4451 - val_accuracy30: 0.4252 - val_accuracy50: 0.3923 - 259s/epoch - 29ms/step
Epoch 18/50
9052/9052 - 245s - loss: 12.1010 - accuracy10: 0.5327 - accuracy20: 0.4954 - accuracy30: 0.4656 - accuracy50: 0.4440 - val_loss: 12.6207 - val_accuracy10: 0.4858 - val_accuracy20: 0.4451 - val_accuracy30: 0.4248 - val_accuracy50: 0.3915 - 245s/epoch - 27ms/step
Epoch 19/50
9052/9052 - 251s - loss: 12.0941 - accuracy10: 0.5334 - accuracy20: 0.4958 - accuracy30: 0.4663 - accuracy50: 0.4447 - val_loss: 12.6183 - val_accuracy10: 0.4858 - val_accuracy20: 0.4448 - val_accuracy30: 0.4248 - val_accuracy50: 0.3919 - 251s/epoch - 28ms/step
Epoch 20/50
9052/9052 - 246s - loss: 12.0877 - accuracy10: 0.5336 - accuracy20: 0.4964 - accuracy30: 0.4667 - accuracy50: 0.4451 - val_loss: 12.6319 - val_accuracy10: 0.4853 - val_accuracy20: 0.4442 - val_accuracy30: 0.4242 - val_accuracy50: 0.3915 - 246s/epoch - 27ms/step
Epoch 21/50
9052/9052 - 255s - loss: 12.0818 - accuracy10: 0.5341 - accuracy20: 0.4967 - accuracy30: 0.4673 - accuracy50: 0.4455 - val_loss: 12.6279 - val_accuracy10: 0.4866 - val_accuracy20: 0.4445 - val_accuracy30: 0.4241 - val_accuracy50: 0.3910 - 255s/epoch - 28ms/step
Epoch 22/50
9052/9052 - 245s - loss: 12.0754 - accuracy10: 0.5344 - accuracy20: 0.4971 - accuracy30: 0.4680 - accuracy50: 0.4460 - val_loss: 12.6100 - val_accuracy10: 0.4877 - val_accuracy20: 0.4460 - val_accuracy30: 0.4259 - val_accuracy50: 0.3924 - 245s/epoch - 27ms/step
Epoch 23/50
9052/9052 - 257s - loss: 12.0702 - accuracy10: 0.5349 - accuracy20: 0.4976 - accuracy30: 0.4684 - accuracy50: 0.4466 - val_loss: 12.6195 - val_accuracy10: 0.4878 - val_accuracy20: 0.4453 - val_accuracy30: 0.4255 - val_accuracy50: 0.3923 - 257s/epoch - 28ms/step
Epoch 24/50
9052/9052 - 254s - loss: 12.0644 - accuracy10: 0.5352 - accuracy20: 0.4980 - accuracy30: 0.4688 - accuracy50: 0.4469 - val_loss: 12.6112 - val_accuracy10: 0.4882 - val_accuracy20: 0.4462 - val_accuracy30: 0.4258 - val_accuracy50: 0.3922 - 254s/epoch - 28ms/step
Epoch 25/50
9052/9052 - 257s - loss: 12.0594 - accuracy10: 0.5356 - accuracy20: 0.4983 - accuracy30: 0.4692 - accuracy50: 0.4476 - val_loss: 12.6278 - val_accuracy10: 0.4865 - val_accuracy20: 0.4449 - val_accuracy30: 0.4257 - val_accuracy50: 0.3922 - 257s/epoch - 28ms/step
Epoch 26/50
9052/9052 - 259s - loss: 12.0538 - accuracy10: 0.5358 - accuracy20: 0.4987 - accuracy30: 0.4698 - accuracy50: 0.4482 - val_loss: 12.6222 - val_accuracy10: 0.4877 - val_accuracy20: 0.4451 - val_accuracy30: 0.4248 - val_accuracy50: 0.3917 - 259s/epoch - 29ms/step
Epoch 27/50
9052/9052 - 254s - loss: 12.0486 - accuracy10: 0.5361 - accuracy20: 0.4991 - accuracy30: 0.4701 - accuracy50: 0.4483 - val_loss: 12.6262 - val_accuracy10: 0.4875 - val_accuracy20: 0.4453 - val_accuracy30: 0.4252 - val_accuracy50: 0.3917 - 254s/epoch - 28ms/step
Epoch 28/50
9052/9052 - 262s - loss: 12.0440 - accuracy10: 0.5364 - accuracy20: 0.4996 - accuracy30: 0.4707 - accuracy50: 0.4491 - val_loss: 12.6267 - val_accuracy10: 0.4870 - val_accuracy20: 0.4453 - val_accuracy30: 0.4251 - val_accuracy50: 0.3920 - 262s/epoch - 29ms/step
Epoch 29/50
9052/9052 - 253s - loss: 12.0393 - accuracy10: 0.5368 - accuracy20: 0.4999 - accuracy30: 0.4711 - accuracy50: 0.4494 - val_loss: 12.6254 - val_accuracy10: 0.4879 - val_accuracy20: 0.4455 - val_accuracy30: 0.4251 - val_accuracy50: 0.3921 - 253s/epoch - 28ms/step
Epoch 30/50
9052/9052 - 248s - loss: 12.0348 - accuracy10: 0.5369 - accuracy20: 0.5001 - accuracy30: 0.4715 - accuracy50: 0.4498 - val_loss: 12.6329 - val_accuracy10: 0.4872 - val_accuracy20: 0.4447 - val_accuracy30: 0.4246 - val_accuracy50: 0.3917 - 248s/epoch - 27ms/step
Epoch 31/50
9052/9052 - 252s - loss: 12.0301 - accuracy10: 0.5374 - accuracy20: 0.5006 - accuracy30: 0.4715 - accuracy50: 0.4501 - val_loss: 12.6373 - val_accuracy10: 0.4872 - val_accuracy20: 0.4447 - val_accuracy30: 0.4245 - val_accuracy50: 0.3914 - 252s/epoch - 28ms/step
Epoch 32/50
9052/9052 - 252s - loss: 12.0255 - accuracy10: 0.5374 - accuracy20: 0.5010 - accuracy30: 0.4722 - accuracy50: 0.4505 - val_loss: 12.6401 - val_accuracy10: 0.4875 - val_accuracy20: 0.4446 - val_accuracy30: 0.4237 - val_accuracy50: 0.3903 - 252s/epoch - 28ms/step
testing model: results/AAPL/W7/deepOF_L2/seq2seq
Evaluating performance on  test set...
23942/23942 - 275s - 275s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0374888
{'0': {'precision': 0.44434263388358314, 'recall': 0.6336405431844866, 'f1-score': 0.5223708753225567, 'support': 1878846}, '1': {'precision': 0.6127214453677436, 'recall': 0.15367411590726782, 'f1-score': 0.2457201768174734, 'support': 2382301}, '2': {'precision': 0.43861892314121675, 'recall': 0.6697697750215214, 'f1-score': 0.5300914705453659, 'support': 1867912}, 'accuracy': 0.4580934854763186, 'macro avg': {'precision': 0.49856100079751453, 'recall': 0.4856948113710919, 'f1-score': 0.4327275075617987, 'support': 6129059}, 'weighted avg': {'precision': 0.5080453365329347, 'recall': 0.4580934854763186, 'f1-score': 0.4171926019145946, 'support': 6129059}}
[[1190513  116025  572308]
 [ 987286  366098 1028917]
 [ 501469  115372 1251071]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0794461
{'0': {'precision': 0.4103932563892375, 'recall': 0.6030519134420638, 'f1-score': 0.48841012004713824, 'support': 1876200}, '1': {'precision': 0.5642697655536385, 'recall': 0.07440648208635253, 'f1-score': 0.13147609092299747, 'support': 2391082}, '2': {'precision': 0.4004307796791594, 'recall': 0.6574525305662279, 'f1-score': 0.49771884453986526, 'support': 1861777}, 'accuracy': 0.41334044916193496, 'macro avg': {'precision': 0.4583646005406785, 'recall': 0.4449703086982148, 'f1-score': 0.37253501850333365, 'support': 6129059}, 'weighted avg': {'precision': 0.46739767440576746, 'recall': 0.41334044916193496, 'f1-score': 0.3519898697173057, 'support': 6129059}}
[[1131446   73217  671537]
 [1051954  177912 1161216]
 [ 573580   64167 1224030]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.088671
{'0': {'precision': 0.4001909240231345, 'recall': 0.584171801079656, 'f1-score': 0.4749880240292807, 'support': 1923946}, '1': {'precision': 0.5077762114944654, 'recall': 0.03827221993854986, 'f1-score': 0.07117948418926556, 'support': 2296496}, '2': {'precision': 0.3897722651484343, 'recall': 0.6427774666158794, 'f1-score': 0.485277989896239, 'support': 1908617}, 'accuracy': 0.3978788587285585, 'macro avg': {'precision': 0.43257980022201137, 'recall': 0.4217404958780285, 'f1-score': 0.34381516603826173, 'support': 6129059}, 'weighted avg': {'precision': 0.43725761776703675, 'recall': 0.3978788587285585, 'f1-score': 0.3268894182359054, 'support': 6129059}}
[[1123915   45868  754163]
 [1042063   87892 1166541]
 [ 642469   39332 1226816]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1294072
{'0': {'precision': 0.32617483586494533, 'recall': 0.5715876664381114, 'f1-score': 0.41533816082673186, 'support': 1614489}, '1': {'precision': 0.5653962007255364, 'recall': 0.02089936775861968, 'f1-score': 0.04030875811952742, 'support': 2900949}, '2': {'precision': 0.3187302022832153, 'recall': 0.6306183422253429, 'f1-score': 0.4234421866313347, 'support': 1613621}, 'accuracy': 0.3264822544537424, 'macro avg': {'precision': 0.40343374629123235, 'recall': 0.4077017921406913, 'f1-score': 0.293029701859198, 'support': 6129059}, 'weighted avg': {'precision': 0.4374408821024154, 'recall': 0.3264822544537424, 'f1-score': 0.23996632242034469, 'support': 6129059}}
[[ 922822   23030  668637]
 [1333934   60628 1506387]
 [ 572469   23573 1017579]]
Evaluating performance on  train set...
9052/9052 - 88s - 88s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9858906
{'0': {'precision': 0.49085534045178, 'recall': 0.6387608800434564, 'f1-score': 0.5551251541050822, 'support': 784234}, '1': {'precision': 0.5904912414194526, 'recall': 0.24109079805100836, 'f1-score': 0.34238835828296743, 'support': 753210}, '2': {'precision': 0.4998048553604109, 'recall': 0.6340308401121552, 'f1-score': 0.5589728628259842, 'support': 779634}, 'accuracy': 0.5078991730101446, 'macro avg': {'precision': 0.5270504790772145, 'recall': 0.5046275060688733, 'f1-score': 0.485495458404678, 'support': 2317078}, 'weighted avg': {'precision': 0.5262551427347141, 'recall': 0.5078991730101446, 'f1-score': 0.4872656873800676, 'support': 2317078}}
[[500938  61352 221944]
 [298864 181592 272754]
 [220739  64583 494312]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0264691
{'0': {'precision': 0.4552015408754235, 'recall': 0.6192613096775603, 'f1-score': 0.5247062794673286, 'support': 778161}, '1': {'precision': 0.5428613439200117, 'recall': 0.15485217190709183, 'f1-score': 0.24096783634974847, 'support': 762947}, '2': {'precision': 0.46093539079981594, 'recall': 0.6182635926646649, 'f1-score': 0.528131651472344, 'support': 775970}, 'accuracy': 0.46601063926203606, 'macro avg': {'precision': 0.48633275853175045, 'recall': 0.46412569141643906, 'f1-score': 0.43126858909647375, 'support': 2317078}, 'weighted avg': {'precision': 0.4859856056670664, 'recall': 0.46601063926203606, 'f1-score': 0.4324265167461355, 'support': 2317078}}
[[481885  48770 247506]
 [331236 118144 313567]
 [245498  50718 479754]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0501963
{'0': {'precision': 0.43141385767790263, 'recall': 0.6112286420149734, 'f1-score': 0.5058157641810678, 'support': 771901}, '1': {'precision': 0.4996712689020381, 'recall': 0.10063494634645521, 'f1-score': 0.167529137828456, 'support': 777861}, '2': {'precision': 0.43526096685080284, 'recall': 0.605133999551684, 'f1-score': 0.5063292657593729, 'support': 767316}, 'accuracy': 0.4378001085850368, 'macro avg': {'precision': 0.4554486978102479, 'recall': 0.43899919597103754, 'f1-score': 0.3932247225896322, 'support': 2317078}, 'weighted avg': {'precision': 0.45560239452229473, 'recall': 0.4378001085850368, 'f1-score': 0.3924203776277406, 'support': 2317078}}
[[471808  38323 261770]
 [358897  78280 340684]
 [262927  40060 464329]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0701823
{'0': {'precision': 0.4118324065807592, 'recall': 0.5946831769322422, 'f1-score': 0.4866488068754937, 'support': 778021}, '1': {'precision': 0.4319667142272732, 'recall': 0.05609834476646098, 'f1-score': 0.09930076827182992, 'support': 771734}, '2': {'precision': 0.4139124088392333, 'recall': 0.589805075567916, 'f1-score': 0.4864469203066983, 'support': 767323}, 'accuracy': 0.4136848220042657, 'macro avg': {'precision': 0.41923717654908854, 'recall': 0.41352886575553977, 'f1-score': 0.35746549848467396, 'support': 2317078}, 'weighted avg': {'precision': 0.4192272216669384, 'recall': 0.4136848220042657, 'f1-score': 0.35757047484204996, 'support': 2317078}}
[[462676  27584 287761]
 [375375  43293 353066]
 [285406  29346 452571]]
Evaluating performance on  val set...
2763/2763 - 26s - 26s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0048581
{'0': {'precision': 0.4655117080163463, 'recall': 0.6542026769299497, 'f1-score': 0.5439583694213828, 'support': 232804}, '1': {'precision': 0.6020621656497827, 'recall': 0.1998536114715374, 'f1-score': 0.3000921083443915, 'support': 240456}, '2': {'precision': 0.48109387798592196, 'recall': 0.617314807693951, 'f1-score': 0.5407575133799918, 'support': 234054}, 'accuracy': 0.4875373596450798, 'macro avg': {'precision': 0.516222583884017, 'recall': 0.4904570320318127, 'f1-score': 0.4616026637152553, 'support': 707314}, 'weighted avg': {'precision': 0.5170891489418258, 'recall': 0.4875373596450798, 'f1-score': 0.4599952655757912, 'support': 707314}}
[[152301  14420  66083]
 [102642  48056  89758]
 [ 72226  17343 144485]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0456034
{'0': {'precision': 0.43329566056838786, 'recall': 0.635132919747707, 'f1-score': 0.5151497125421215, 'support': 231794}, '1': {'precision': 0.5525519342817731, 'recall': 0.11084082583394939, 'f1-score': 0.18464269251673535, 'support': 242131}, '2': {'precision': 0.4435300572145152, 'recall': 0.6061768121033982, 'f1-score': 0.5122527898269982, 'support': 233389}, 'accuracy': 0.4461003175393107, 'macro avg': {'precision': 0.47645921735489205, 'recall': 0.45071685256168487, 'f1-score': 0.40401506496195166, 'support': 707314}, 'weighted avg': {'precision': 0.477497014435749, 'recall': 0.4461003175393107, 'f1-score': 0.40105313710133184, 'support': 707314}}
[[147220  10251  74323]
 [112116  26838 103177]
 [ 80432  11482 141475]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0623246
{'0': {'precision': 0.41819569461555395, 'recall': 0.6259364317404902, 'f1-score': 0.5013999938311164, 'support': 233733}, '1': {'precision': 0.4969682013678347, 'recall': 0.05943712448613893, 'f1-score': 0.10617569414892615, 'support': 237175}, '2': {'precision': 0.42679432524984273, 'recall': 0.5941515866771571, 'f1-score': 0.4967560427434913, 'support': 236406}, 'accuracy': 0.4253556412003721, 'macro avg': {'precision': 0.44731940707774376, 'recall': 0.4265083809679287, 'f1-score': 0.3681105769078446, 'support': 707314}, 'weighted avg': {'precision': 0.4474834468199524, 'recall': 0.4253556412003721, 'f1-score': 0.36732208617207873, 'support': 707314}}
[[146302   6739  80692]
 [115124  14097 107954]
 [ 88415   7530 140461]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0852302
{'0': {'precision': 0.38479699426269737, 'recall': 0.6040863138597244, 'f1-score': 0.47012745778833087, 'support': 225827}, '1': {'precision': 0.4438805970149254, 'recall': 0.02952505758081169, 'f1-score': 0.0553673157835946, 'support': 251820}, '2': {'precision': 0.3970872688532981, 'recall': 0.5810064136336522, 'f1-score': 0.47175491286155957, 'support': 229667}, 'accuracy': 0.3920352205668204, 'macro avg': {'precision': 0.40858828671030695, 'recall': 0.40487259502472944, 'f1-score': 0.332416562144495, 'support': 707314}, 'weighted avg': {'precision': 0.4098228008202737, 'recall': 0.3920352205668204, 'f1-score': 0.3229917779695665, 'support': 707314}}
[[136419   4362  85046]
 [126827   7435 117558]
 [ 91276   4953 133438]]
training model: results/AAPL/W7/deepVOL_L2/seq2seq
Epoch 1/50
9052/9052 - 245s - loss: 12.7381 - accuracy10: 0.4617 - accuracy20: 0.4331 - accuracy30: 0.4080 - accuracy50: 0.4014 - val_loss: 12.7511 - val_accuracy10: 0.4778 - val_accuracy20: 0.4354 - val_accuracy30: 0.4138 - val_accuracy50: 0.3817 - 245s/epoch - 27ms/step
Epoch 2/50
9052/9052 - 233s - loss: 12.5312 - accuracy10: 0.4937 - accuracy20: 0.4580 - accuracy30: 0.4280 - accuracy50: 0.4139 - val_loss: 12.6989 - val_accuracy10: 0.4856 - val_accuracy20: 0.4428 - val_accuracy30: 0.4193 - val_accuracy50: 0.3835 - 233s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 243s - loss: 12.4520 - accuracy10: 0.5022 - accuracy20: 0.4648 - accuracy30: 0.4350 - accuracy50: 0.4190 - val_loss: 12.6405 - val_accuracy10: 0.4912 - val_accuracy20: 0.4454 - val_accuracy30: 0.4201 - val_accuracy50: 0.3854 - 243s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 235s - loss: 12.4010 - accuracy10: 0.5070 - accuracy20: 0.4696 - accuracy30: 0.4395 - accuracy50: 0.4226 - val_loss: 12.6473 - val_accuracy10: 0.4900 - val_accuracy20: 0.4427 - val_accuracy30: 0.4176 - val_accuracy50: 0.3845 - 235s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 234s - loss: 12.3680 - accuracy10: 0.5101 - accuracy20: 0.4726 - accuracy30: 0.4424 - accuracy50: 0.4252 - val_loss: 12.6567 - val_accuracy10: 0.4894 - val_accuracy20: 0.4408 - val_accuracy30: 0.4155 - val_accuracy50: 0.3845 - 234s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 239s - loss: 12.3433 - accuracy10: 0.5123 - accuracy20: 0.4746 - accuracy30: 0.4447 - accuracy50: 0.4271 - val_loss: 12.6713 - val_accuracy10: 0.4880 - val_accuracy20: 0.4384 - val_accuracy30: 0.4140 - val_accuracy50: 0.3829 - 239s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 250s - loss: 12.3220 - accuracy10: 0.5142 - accuracy20: 0.4764 - accuracy30: 0.4465 - accuracy50: 0.4286 - val_loss: 12.6890 - val_accuracy10: 0.4843 - val_accuracy20: 0.4354 - val_accuracy30: 0.4128 - val_accuracy50: 0.3840 - 250s/epoch - 28ms/step
Epoch 8/50
9052/9052 - 241s - loss: 12.3087 - accuracy10: 0.5152 - accuracy20: 0.4775 - accuracy30: 0.4477 - accuracy50: 0.4294 - val_loss: 12.6710 - val_accuracy10: 0.4881 - val_accuracy20: 0.4385 - val_accuracy30: 0.4144 - val_accuracy50: 0.3843 - 241s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 241s - loss: 12.2937 - accuracy10: 0.5167 - accuracy20: 0.4786 - accuracy30: 0.4491 - accuracy50: 0.4304 - val_loss: 12.6540 - val_accuracy10: 0.4895 - val_accuracy20: 0.4400 - val_accuracy30: 0.4156 - val_accuracy50: 0.3857 - 241s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 244s - loss: 12.2798 - accuracy10: 0.5179 - accuracy20: 0.4798 - accuracy30: 0.4502 - accuracy50: 0.4316 - val_loss: 12.6933 - val_accuracy10: 0.4855 - val_accuracy20: 0.4353 - val_accuracy30: 0.4122 - val_accuracy50: 0.3829 - 244s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 242s - loss: 12.2671 - accuracy10: 0.5187 - accuracy20: 0.4809 - accuracy30: 0.4512 - accuracy50: 0.4326 - val_loss: 12.6294 - val_accuracy10: 0.4915 - val_accuracy20: 0.4418 - val_accuracy30: 0.4176 - val_accuracy50: 0.3873 - 242s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 238s - loss: 12.2556 - accuracy10: 0.5196 - accuracy20: 0.4819 - accuracy30: 0.4523 - accuracy50: 0.4335 - val_loss: 12.6366 - val_accuracy10: 0.4909 - val_accuracy20: 0.4410 - val_accuracy30: 0.4161 - val_accuracy50: 0.3856 - 238s/epoch - 26ms/step
Epoch 13/50
9052/9052 - 231s - loss: 12.2458 - accuracy10: 0.5206 - accuracy20: 0.4827 - accuracy30: 0.4531 - accuracy50: 0.4342 - val_loss: 12.6243 - val_accuracy10: 0.4922 - val_accuracy20: 0.4414 - val_accuracy30: 0.4168 - val_accuracy50: 0.3867 - 231s/epoch - 25ms/step
Epoch 14/50
9052/9052 - 238s - loss: 12.2359 - accuracy10: 0.5214 - accuracy20: 0.4832 - accuracy30: 0.4540 - accuracy50: 0.4353 - val_loss: 12.6066 - val_accuracy10: 0.4945 - val_accuracy20: 0.4434 - val_accuracy30: 0.4176 - val_accuracy50: 0.3874 - 238s/epoch - 26ms/step
Epoch 15/50
9052/9052 - 236s - loss: 12.2278 - accuracy10: 0.5221 - accuracy20: 0.4839 - accuracy30: 0.4549 - accuracy50: 0.4360 - val_loss: 12.6467 - val_accuracy10: 0.4903 - val_accuracy20: 0.4387 - val_accuracy30: 0.4151 - val_accuracy50: 0.3849 - 236s/epoch - 26ms/step
Epoch 16/50
9052/9052 - 237s - loss: 12.2197 - accuracy10: 0.5226 - accuracy20: 0.4846 - accuracy30: 0.4554 - accuracy50: 0.4365 - val_loss: 12.5918 - val_accuracy10: 0.4954 - val_accuracy20: 0.4435 - val_accuracy30: 0.4191 - val_accuracy50: 0.3880 - 237s/epoch - 26ms/step
Epoch 17/50
9052/9052 - 234s - loss: 12.2110 - accuracy10: 0.5235 - accuracy20: 0.4853 - accuracy30: 0.4564 - accuracy50: 0.4374 - val_loss: 12.6058 - val_accuracy10: 0.4946 - val_accuracy20: 0.4427 - val_accuracy30: 0.4182 - val_accuracy50: 0.3875 - 234s/epoch - 26ms/step
Epoch 18/50
9052/9052 - 238s - loss: 12.2039 - accuracy10: 0.5241 - accuracy20: 0.4858 - accuracy30: 0.4568 - accuracy50: 0.4380 - val_loss: 12.6129 - val_accuracy10: 0.4947 - val_accuracy20: 0.4420 - val_accuracy30: 0.4171 - val_accuracy50: 0.3866 - 238s/epoch - 26ms/step
Epoch 19/50
9052/9052 - 240s - loss: 12.1970 - accuracy10: 0.5247 - accuracy20: 0.4866 - accuracy30: 0.4574 - accuracy50: 0.4383 - val_loss: 12.5955 - val_accuracy10: 0.4963 - val_accuracy20: 0.4438 - val_accuracy30: 0.4181 - val_accuracy50: 0.3882 - 240s/epoch - 26ms/step
Epoch 20/50
9052/9052 - 239s - loss: 12.1909 - accuracy10: 0.5248 - accuracy20: 0.4866 - accuracy30: 0.4578 - accuracy50: 0.4388 - val_loss: 12.5948 - val_accuracy10: 0.4959 - val_accuracy20: 0.4432 - val_accuracy30: 0.4184 - val_accuracy50: 0.3885 - 239s/epoch - 26ms/step
Epoch 21/50
9052/9052 - 233s - loss: 12.1833 - accuracy10: 0.5254 - accuracy20: 0.4875 - accuracy30: 0.4586 - accuracy50: 0.4395 - val_loss: 12.5918 - val_accuracy10: 0.4963 - val_accuracy20: 0.4440 - val_accuracy30: 0.4192 - val_accuracy50: 0.3887 - 233s/epoch - 26ms/step
Epoch 22/50
9052/9052 - 231s - loss: 12.1773 - accuracy10: 0.5260 - accuracy20: 0.4879 - accuracy30: 0.4590 - accuracy50: 0.4399 - val_loss: 12.5989 - val_accuracy10: 0.4958 - val_accuracy20: 0.4433 - val_accuracy30: 0.4187 - val_accuracy50: 0.3886 - 231s/epoch - 26ms/step
Epoch 23/50
9052/9052 - 236s - loss: 12.1716 - accuracy10: 0.5265 - accuracy20: 0.4883 - accuracy30: 0.4597 - accuracy50: 0.4406 - val_loss: 12.5848 - val_accuracy10: 0.4970 - val_accuracy20: 0.4445 - val_accuracy30: 0.4193 - val_accuracy50: 0.3890 - 236s/epoch - 26ms/step
Epoch 24/50
9052/9052 - 236s - loss: 12.1659 - accuracy10: 0.5268 - accuracy20: 0.4888 - accuracy30: 0.4603 - accuracy50: 0.4413 - val_loss: 12.5850 - val_accuracy10: 0.4969 - val_accuracy20: 0.4447 - val_accuracy30: 0.4195 - val_accuracy50: 0.3889 - 236s/epoch - 26ms/step
Epoch 25/50
9052/9052 - 241s - loss: 12.1603 - accuracy10: 0.5272 - accuracy20: 0.4893 - accuracy30: 0.4608 - accuracy50: 0.4415 - val_loss: 12.5803 - val_accuracy10: 0.4984 - val_accuracy20: 0.4448 - val_accuracy30: 0.4198 - val_accuracy50: 0.3896 - 241s/epoch - 27ms/step
Epoch 26/50
9052/9052 - 238s - loss: 12.1556 - accuracy10: 0.5274 - accuracy20: 0.4896 - accuracy30: 0.4612 - accuracy50: 0.4421 - val_loss: 12.5915 - val_accuracy10: 0.4959 - val_accuracy20: 0.4429 - val_accuracy30: 0.4194 - val_accuracy50: 0.3894 - 238s/epoch - 26ms/step
Epoch 27/50
9052/9052 - 242s - loss: 12.1501 - accuracy10: 0.5282 - accuracy20: 0.4901 - accuracy30: 0.4616 - accuracy50: 0.4425 - val_loss: 12.5709 - val_accuracy10: 0.4980 - val_accuracy20: 0.4464 - val_accuracy30: 0.4212 - val_accuracy50: 0.3902 - 242s/epoch - 27ms/step
Epoch 28/50
9052/9052 - 238s - loss: 12.1454 - accuracy10: 0.5283 - accuracy20: 0.4901 - accuracy30: 0.4620 - accuracy50: 0.4428 - val_loss: 12.5821 - val_accuracy10: 0.4971 - val_accuracy20: 0.4441 - val_accuracy30: 0.4200 - val_accuracy50: 0.3905 - 238s/epoch - 26ms/step
Epoch 29/50
9052/9052 - 240s - loss: 12.1398 - accuracy10: 0.5285 - accuracy20: 0.4908 - accuracy30: 0.4627 - accuracy50: 0.4434 - val_loss: 12.5877 - val_accuracy10: 0.4955 - val_accuracy20: 0.4446 - val_accuracy30: 0.4202 - val_accuracy50: 0.3892 - 240s/epoch - 26ms/step
Epoch 30/50
9052/9052 - 239s - loss: 12.1355 - accuracy10: 0.5290 - accuracy20: 0.4914 - accuracy30: 0.4631 - accuracy50: 0.4437 - val_loss: 12.5909 - val_accuracy10: 0.4968 - val_accuracy20: 0.4439 - val_accuracy30: 0.4197 - val_accuracy50: 0.3896 - 239s/epoch - 26ms/step
Epoch 31/50
9052/9052 - 238s - loss: 12.1306 - accuracy10: 0.5292 - accuracy20: 0.4916 - accuracy30: 0.4634 - accuracy50: 0.4443 - val_loss: 12.6070 - val_accuracy10: 0.4940 - val_accuracy20: 0.4428 - val_accuracy30: 0.4192 - val_accuracy50: 0.3888 - 238s/epoch - 26ms/step
Epoch 32/50
9052/9052 - 238s - loss: 12.1263 - accuracy10: 0.5294 - accuracy20: 0.4918 - accuracy30: 0.4641 - accuracy50: 0.4448 - val_loss: 12.5902 - val_accuracy10: 0.4963 - val_accuracy20: 0.4449 - val_accuracy30: 0.4202 - val_accuracy50: 0.3892 - 238s/epoch - 26ms/step
Epoch 33/50
9052/9052 - 238s - loss: 12.1224 - accuracy10: 0.5299 - accuracy20: 0.4924 - accuracy30: 0.4645 - accuracy50: 0.4450 - val_loss: 12.5975 - val_accuracy10: 0.4955 - val_accuracy20: 0.4441 - val_accuracy30: 0.4201 - val_accuracy50: 0.3890 - 238s/epoch - 26ms/step
Epoch 34/50
9052/9052 - 236s - loss: 12.1167 - accuracy10: 0.5303 - accuracy20: 0.4926 - accuracy30: 0.4649 - accuracy50: 0.4457 - val_loss: 12.6142 - val_accuracy10: 0.4946 - val_accuracy20: 0.4427 - val_accuracy30: 0.4189 - val_accuracy50: 0.3887 - 236s/epoch - 26ms/step
Epoch 35/50
9052/9052 - 238s - loss: 12.1122 - accuracy10: 0.5304 - accuracy20: 0.4929 - accuracy30: 0.4653 - accuracy50: 0.4463 - val_loss: 12.5904 - val_accuracy10: 0.4961 - val_accuracy20: 0.4457 - val_accuracy30: 0.4208 - val_accuracy50: 0.3890 - 238s/epoch - 26ms/step
Epoch 36/50
9052/9052 - 236s - loss: 12.1085 - accuracy10: 0.5307 - accuracy20: 0.4933 - accuracy30: 0.4656 - accuracy50: 0.4465 - val_loss: 12.6034 - val_accuracy10: 0.4961 - val_accuracy20: 0.4449 - val_accuracy30: 0.4204 - val_accuracy50: 0.3885 - 236s/epoch - 26ms/step
Epoch 37/50
9052/9052 - 235s - loss: 12.1047 - accuracy10: 0.5309 - accuracy20: 0.4935 - accuracy30: 0.4655 - accuracy50: 0.4464 - val_loss: 12.6100 - val_accuracy10: 0.4957 - val_accuracy20: 0.4448 - val_accuracy30: 0.4204 - val_accuracy50: 0.3881 - 235s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/seq2seq
Evaluating performance on  test set...
23942/23942 - 205s - 205s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0166957
{'0': {'precision': 0.44597687064856784, 'recall': 0.6508740191468287, 'f1-score': 0.5292875466412864, 'support': 1878849}, '1': {'precision': 0.5791874822306161, 'recall': 0.2394352185407224, 'f1-score': 0.3388078079273164, 'support': 2382302}, '2': {'precision': 0.46465712000872544, 'recall': 0.5975567384562344, 'f1-score': 0.52279301558753, 'support': 1867913}, 'accuracy': 0.4747029889066259, 'macro avg': {'precision': 0.49660715762930313, 'recall': 0.49595532538126186, 'f1-score': 0.4636294567187109, 'support': 6129064}, 'weighted avg': {'precision': 0.5034474708929473, 'recall': 0.4747029889066259, 'f1-score': 0.4532708038756727, 'support': 6129064}}
[[1222894  196505  459450]
 [ 985362  570407  826533]
 [ 533801  217928 1116184]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0634325
{'0': {'precision': 0.4047262977557538, 'recall': 0.6440481120646326, 'f1-score': 0.49708155639904084, 'support': 1876203}, '1': {'precision': 0.5305716748289107, 'recall': 0.11173305150845872, 'f1-score': 0.18459273252007777, 'support': 2391083}, '2': {'precision': 0.4175892110696995, 'recall': 0.5921167829891641, 'f1-score': 0.48976946105988695, 'support': 1861778}, 'accuracy': 0.420605495390487, 'macro avg': {'precision': 0.45096239455145465, 'recall': 0.4492993155207518, 'f1-score': 0.3904812499930019, 'support': 6129064}, 'weighted avg': {'precision': 0.45772862091178973, 'recall': 0.420605495390487, 'f1-score': 0.3729516382413382, 'support': 6129064}}
[[1208365  115389  552449]
 [1138868  267163  985052]
 [ 638402  120986 1102390]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0766877
{'0': {'precision': 0.3928797179553685, 'recall': 0.6377133697410898, 'f1-score': 0.48621449499579833, 'support': 1923949}, '1': {'precision': 0.4671501614445875, 'recall': 0.05657353065406545, 'f1-score': 0.10092472186100274, 'support': 2296498}, '2': {'precision': 0.4043148194308001, 'recall': 0.5778985516738036, 'f1-score': 0.4757682097252395, 'support': 1908617}, 'accuracy': 0.40133958464130903, 'macro avg': {'precision': 0.42144823294358535, 'recall': 0.4240618173563196, 'f1-score': 0.3543024755273468, 'support': 6129064}, 'weighted avg': {'precision': 0.42426903841357194, 'recall': 0.40133958464130903, 'f1-score': 0.33859731379508806, 'support': 6129064}}
[[1226928   72587  624434]
 [1165958  129921 1000619]
 [ 730024   75606 1102987]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1072075
{'0': {'precision': 0.3208482307665874, 'recall': 0.6303654648025508, 'f1-score': 0.4252496469728457, 'support': 1614492}, '1': {'precision': 0.5521156908298311, 'recall': 0.043746343871371836, 'f1-score': 0.08106924576905938, 'support': 2900951}, '2': {'precision': 0.3323726561952859, 'recall': 0.5617558274216808, 'f1-score': 0.4176408198920768, 'support': 1613621}, 'accuracy': 0.33464930371097446, 'macro avg': {'precision': 0.4017788592639015, 'recall': 0.4119558786985345, 'f1-score': 0.30798657087799397, 'support': 6129064}, 'weighted avg': {'precision': 0.4333436500382101, 'recall': 0.33464930371097446, 'f1-score': 0.26034220886885096, 'support': 6129064}}
[[1017720   49913  546859]
 [1500122  126906 1273923]
 [ 654125   53035  906461]]
Evaluating performance on  train set...
9052/9052 - 81s - 81s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9863343
{'0': {'precision': 0.49034311179581747, 'recall': 0.6428947606678372, 'f1-score': 0.5563510100801101, 'support': 784203}, '1': {'precision': 0.5856304893617627, 'recall': 0.27330484859743637, 'f1-score': 0.37268382183307497, 'support': 753620}, '2': {'precision': 0.501941423326316, 'recall': 0.6036763224456116, 'f1-score': 0.5481282363194863, 'support': 779257}, 'accuracy': 0.5094977299014276, 'macro avg': {'precision': 0.5259716748279654, 'recall': 0.506625310570295, 'f1-score': 0.4923876894108905, 'support': 2317080}, 'weighted avg': {'precision': 0.5252355362824858, 'recall': 0.5094977299014276, 'f1-score': 0.49384867074822986, 'support': 2317080}}
[[504160  69208 210835]
 [291707 205968 255945]
 [232311  76527 470419]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0308884
{'0': {'precision': 0.445550553628093, 'recall': 0.6374355147964406, 'f1-score': 0.524493813540785, 'support': 778667}, '1': {'precision': 0.541615506727425, 'recall': 0.13825127726314243, 'f1-score': 0.2202756109103559, 'support': 762568}, '2': {'precision': 0.45889684197165054, 'recall': 0.5964567664933073, 'f1-score': 0.5187116892782943, 'support': 775845}, 'accuracy': 0.459429109051047, 'macro avg': {'precision': 0.4820209674423895, 'recall': 0.45738118618429674, 'f1-score': 0.4211603712431451, 'support': 2317080}, 'weighted avg': {'precision': 0.4816350695856597, 'recall': 0.459429109051047, 'f1-score': 0.42243730338925245, 'support': 2317080}}
[[496350  42468 239849]
 [351335 105426 305807]
 [266330  46757 462758]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0552139
{'0': {'precision': 0.4191377475785289, 'recall': 0.6345677445588481, 'f1-score': 0.5048304239183121, 'support': 772217}, '1': {'precision': 0.48003222958435837, 'recall': 0.07203255755324431, 'f1-score': 0.12526772223322005, 'support': 777454}, '2': {'precision': 0.4334393814367013, 'recall': 0.582483395425386, 'f1-score': 0.4970284127109437, 'support': 767409}, 'accuracy': 0.42856914737514457, 'macro avg': {'precision': 0.4442031195331962, 'recall': 0.42969456584582616, 'f1-score': 0.3757088529541586, 'support': 2317080}, 'weighted avg': {'precision': 0.4443064345253872, 'recall': 0.42856914737514457, 'f1-score': 0.3748910716756114, 'support': 2317080}}
[[490024  29471 252722]
 [389884  56002 331568]
 [289216  31190 447003]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0713824
{'0': {'precision': 0.40407914116645216, 'recall': 0.620069179254447, 'f1-score': 0.48929831045165645, 'support': 778268}, '1': {'precision': 0.428109789348252, 'recall': 0.05498345075171977, 'f1-score': 0.09745097453273228, 'support': 771032}, '2': {'precision': 0.4156105346543164, 'recall': 0.5541886998879888, 'f1-score': 0.47499864643330997, 'support': 767780}, 'accuracy': 0.41020120151224815, 'macro avg': {'precision': 0.41593315505634015, 'recall': 0.4097471099647185, 'f1-score': 0.3539159771392329, 'support': 2317080}, 'weighted avg': {'precision': 0.41589658899778376, 'recall': 0.41020120151224815, 'f1-score': 0.35416882370616387, 'support': 2317080}}
[[482580  28188 267500]
 [397850  42394 330788]
 [313841  28444 425495]]
Evaluating performance on  val set...
2763/2763 - 24s - 24s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9971492
{'0': {'precision': 0.4736570346107792, 'recall': 0.6419696371223961, 'f1-score': 0.5451168250704522, 'support': 232916}, '1': {'precision': 0.5920978211101834, 'recall': 0.2740907900806663, 'f1-score': 0.3747187563919002, 'support': 240621}, '2': {'precision': 0.48773934329125124, 'recall': 0.584687181856291, 'f1-score': 0.5318311985432587, 'support': 233778}, 'accuracy': 0.49788849381110256, 'macro avg': {'precision': 0.517831399670738, 'recall': 0.5002492030197844, 'f1-score': 0.48388892666853706, 'support': 707315}, 'weighted avg': {'precision': 0.5186037336726915, 'recall': 0.49788849381110256, 'f1-score': 0.48275812932417783, 'support': 707315}}
[[149525  20483  62908]
 [ 94018  65952  80651]
 [ 72139  24952 136687]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0434875
{'0': {'precision': 0.429661696328363, 'recall': 0.636411133276337, 'f1-score': 0.5129883803288731, 'support': 231594}, '1': {'precision': 0.5411704443590729, 'recall': 0.13931332311394617, 'f1-score': 0.2215842804147496, 'support': 242676}, '2': {'precision': 0.44528309388750464, 'recall': 0.5766697418953421, 'f1-score': 0.5025306018663073, 'support': 233045}, 'accuracy': 0.4461760318952659, 'macro avg': {'precision': 0.4720384115249801, 'recall': 0.45079806609520845, 'f1-score': 0.41236775420331, 'support': 707315}, 'weighted avg': {'precision': 0.4730666651629993, 'recall': 0.4461760318952659, 'f1-score': 0.40956357761357864, 'support': 707315}}
[[147389  13031  71174]
 [112624  33808  96244]
 [ 83022  15633 134390]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0625976
{'0': {'precision': 0.40933302262096977, 'recall': 0.6313850340834692, 'f1-score': 0.4966700496336803, 'support': 233691}, '1': {'precision': 0.4708796037389151, 'recall': 0.07446212673132235, 'f1-score': 0.12858981724566748, 'support': 237463}, '2': {'precision': 0.42957045217942336, 'recall': 0.5626119469345066, 'f1-score': 0.487171448842543, 'support': 236161}, 'accuracy': 0.4214501318365933, 'macro avg': {'precision': 0.43659435951310277, 'recall': 0.42281970258309937, 'f1-score': 0.3708104385739636, 'support': 707315}, 'weighted avg': {'precision': 0.43675266930450485, 'recall': 0.4214501318365933, 'f1-score': 0.36992505584026364, 'support': 707315}}
[[147549   9366  76776]
 [120122  17682  99659]
 [ 92791  10503 132867]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0828654
{'0': {'precision': 0.3773847074178812, 'recall': 0.6146756485036915, 'f1-score': 0.46765136492522097, 'support': 225789}, '1': {'precision': 0.4275722092115535, 'recall': 0.05442498628743134, 'f1-score': 0.09655911627923376, 'support': 251594}, '2': {'precision': 0.4020615874873996, 'recall': 0.537750291390498, 'f1-score': 0.4601106682891069, 'support': 229932}, 'accuracy': 0.39038617871811004, 'macro avg': {'precision': 0.4023395013722781, 'recall': 0.4022836420605403, 'f1-score': 0.3414403831645205, 'support': 707315}, 'weighted avg': {'precision': 0.40325843936817446, 'recall': 0.39038617871811004, 'f1-score': 0.33320146542531853, 'support': 707315}}
[[138787   8806  78196]
 [132213  13693 105688]
 [ 96760   9526 123646]]
training model: results/AAPL/W7/deepVOL_L3/seq2seq
Epoch 1/50
9052/9052 - 367s - loss: 12.8360 - accuracy10: 0.4348 - accuracy20: 0.4174 - accuracy30: 0.3977 - accuracy50: 0.3948 - val_loss: 13.4192 - val_accuracy10: 0.4142 - val_accuracy20: 0.3887 - val_accuracy30: 0.3785 - val_accuracy50: 0.3569 - 367s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 351s - loss: 12.5372 - accuracy10: 0.4919 - accuracy20: 0.4565 - accuracy30: 0.4271 - accuracy50: 0.4142 - val_loss: 12.8397 - val_accuracy10: 0.4675 - val_accuracy20: 0.4269 - val_accuracy30: 0.4056 - val_accuracy50: 0.3760 - 351s/epoch - 39ms/step
Epoch 3/50
9052/9052 - 353s - loss: 12.4493 - accuracy10: 0.5018 - accuracy20: 0.4656 - accuracy30: 0.4354 - accuracy50: 0.4194 - val_loss: 12.6753 - val_accuracy10: 0.4853 - val_accuracy20: 0.4418 - val_accuracy30: 0.4184 - val_accuracy50: 0.3855 - 353s/epoch - 39ms/step
Epoch 4/50
9052/9052 - 355s - loss: 12.4011 - accuracy10: 0.5066 - accuracy20: 0.4701 - accuracy30: 0.4395 - accuracy50: 0.4223 - val_loss: 12.6664 - val_accuracy10: 0.4865 - val_accuracy20: 0.4451 - val_accuracy30: 0.4224 - val_accuracy50: 0.3883 - 355s/epoch - 39ms/step
Epoch 5/50
9052/9052 - 361s - loss: 12.3649 - accuracy10: 0.5104 - accuracy20: 0.4733 - accuracy30: 0.4425 - accuracy50: 0.4245 - val_loss: 12.6404 - val_accuracy10: 0.4901 - val_accuracy20: 0.4470 - val_accuracy30: 0.4225 - val_accuracy50: 0.3893 - 361s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 358s - loss: 12.3414 - accuracy10: 0.5124 - accuracy20: 0.4751 - accuracy30: 0.4448 - accuracy50: 0.4267 - val_loss: 12.6402 - val_accuracy10: 0.4889 - val_accuracy20: 0.4453 - val_accuracy30: 0.4210 - val_accuracy50: 0.3888 - 358s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 354s - loss: 12.3131 - accuracy10: 0.5149 - accuracy20: 0.4776 - accuracy30: 0.4469 - accuracy50: 0.4281 - val_loss: 12.6043 - val_accuracy10: 0.4949 - val_accuracy20: 0.4497 - val_accuracy30: 0.4240 - val_accuracy50: 0.3908 - 354s/epoch - 39ms/step
Epoch 8/50
9052/9052 - 349s - loss: 12.2999 - accuracy10: 0.5164 - accuracy20: 0.4789 - accuracy30: 0.4482 - accuracy50: 0.4296 - val_loss: 12.6281 - val_accuracy10: 0.4927 - val_accuracy20: 0.4479 - val_accuracy30: 0.4233 - val_accuracy50: 0.3908 - 349s/epoch - 39ms/step
Epoch 9/50
9052/9052 - 362s - loss: 12.2752 - accuracy10: 0.5190 - accuracy20: 0.4805 - accuracy30: 0.4503 - accuracy50: 0.4309 - val_loss: 12.6296 - val_accuracy10: 0.4937 - val_accuracy20: 0.4478 - val_accuracy30: 0.4223 - val_accuracy50: 0.3901 - 362s/epoch - 40ms/step
Epoch 10/50
9052/9052 - 354s - loss: 12.2598 - accuracy10: 0.5202 - accuracy20: 0.4821 - accuracy30: 0.4515 - accuracy50: 0.4321 - val_loss: 12.5850 - val_accuracy10: 0.4984 - val_accuracy20: 0.4526 - val_accuracy30: 0.4262 - val_accuracy50: 0.3917 - 354s/epoch - 39ms/step
Epoch 11/50
9052/9052 - 357s - loss: 12.2466 - accuracy10: 0.5214 - accuracy20: 0.4832 - accuracy30: 0.4526 - accuracy50: 0.4329 - val_loss: 12.6171 - val_accuracy10: 0.4954 - val_accuracy20: 0.4495 - val_accuracy30: 0.4243 - val_accuracy50: 0.3910 - 357s/epoch - 39ms/step
Epoch 12/50
9052/9052 - 346s - loss: 12.2340 - accuracy10: 0.5225 - accuracy20: 0.4844 - accuracy30: 0.4539 - accuracy50: 0.4339 - val_loss: 12.6007 - val_accuracy10: 0.4977 - val_accuracy20: 0.4510 - val_accuracy30: 0.4252 - val_accuracy50: 0.3913 - 346s/epoch - 38ms/step
Epoch 13/50
9052/9052 - 360s - loss: 12.2310 - accuracy10: 0.5227 - accuracy20: 0.4844 - accuracy30: 0.4539 - accuracy50: 0.4345 - val_loss: 12.5898 - val_accuracy10: 0.4982 - val_accuracy20: 0.4527 - val_accuracy30: 0.4264 - val_accuracy50: 0.3921 - 360s/epoch - 40ms/step
Epoch 14/50
9052/9052 - 352s - loss: 12.2230 - accuracy10: 0.5233 - accuracy20: 0.4849 - accuracy30: 0.4549 - accuracy50: 0.4353 - val_loss: 12.5582 - val_accuracy10: 0.5015 - val_accuracy20: 0.4540 - val_accuracy30: 0.4263 - val_accuracy50: 0.3921 - 352s/epoch - 39ms/step
Epoch 15/50
9052/9052 - 356s - loss: 12.2053 - accuracy10: 0.5250 - accuracy20: 0.4867 - accuracy30: 0.4563 - accuracy50: 0.4361 - val_loss: 12.5431 - val_accuracy10: 0.5037 - val_accuracy20: 0.4551 - val_accuracy30: 0.4269 - val_accuracy50: 0.3925 - 356s/epoch - 39ms/step
Epoch 16/50
9052/9052 - 360s - loss: 12.1935 - accuracy10: 0.5261 - accuracy20: 0.4874 - accuracy30: 0.4573 - accuracy50: 0.4373 - val_loss: 12.5485 - val_accuracy10: 0.5015 - val_accuracy20: 0.4553 - val_accuracy30: 0.4293 - val_accuracy50: 0.3936 - 360s/epoch - 40ms/step
Epoch 17/50
9052/9052 - 351s - loss: 12.1849 - accuracy10: 0.5266 - accuracy20: 0.4882 - accuracy30: 0.4580 - accuracy50: 0.4380 - val_loss: 12.5572 - val_accuracy10: 0.5020 - val_accuracy20: 0.4552 - val_accuracy30: 0.4287 - val_accuracy50: 0.3932 - 351s/epoch - 39ms/step
Epoch 18/50
9052/9052 - 357s - loss: 12.1769 - accuracy10: 0.5274 - accuracy20: 0.4888 - accuracy30: 0.4585 - accuracy50: 0.4386 - val_loss: 12.5213 - val_accuracy10: 0.5044 - val_accuracy20: 0.4561 - val_accuracy30: 0.4291 - val_accuracy50: 0.3946 - 357s/epoch - 39ms/step
Epoch 19/50
9052/9052 - 350s - loss: 12.1737 - accuracy10: 0.5277 - accuracy20: 0.4888 - accuracy30: 0.4591 - accuracy50: 0.4390 - val_loss: 12.4988 - val_accuracy10: 0.5068 - val_accuracy20: 0.4596 - val_accuracy30: 0.4321 - val_accuracy50: 0.3960 - 350s/epoch - 39ms/step
Epoch 20/50
9052/9052 - 358s - loss: 12.1623 - accuracy10: 0.5284 - accuracy20: 0.4902 - accuracy30: 0.4601 - accuracy50: 0.4401 - val_loss: 12.5198 - val_accuracy10: 0.5053 - val_accuracy20: 0.4575 - val_accuracy30: 0.4302 - val_accuracy50: 0.3948 - 358s/epoch - 39ms/step
Epoch 21/50
9052/9052 - 357s - loss: 12.1555 - accuracy10: 0.5291 - accuracy20: 0.4904 - accuracy30: 0.4608 - accuracy50: 0.4408 - val_loss: 12.5309 - val_accuracy10: 0.5048 - val_accuracy20: 0.4566 - val_accuracy30: 0.4285 - val_accuracy50: 0.3931 - 357s/epoch - 39ms/step
Epoch 22/50
9052/9052 - 357s - loss: 12.1492 - accuracy10: 0.5296 - accuracy20: 0.4911 - accuracy30: 0.4611 - accuracy50: 0.4410 - val_loss: 12.5180 - val_accuracy10: 0.5045 - val_accuracy20: 0.4567 - val_accuracy30: 0.4299 - val_accuracy50: 0.3951 - 357s/epoch - 39ms/step
Epoch 23/50
9052/9052 - 351s - loss: 12.1426 - accuracy10: 0.5300 - accuracy20: 0.4915 - accuracy30: 0.4617 - accuracy50: 0.4417 - val_loss: 12.5162 - val_accuracy10: 0.5045 - val_accuracy20: 0.4575 - val_accuracy30: 0.4312 - val_accuracy50: 0.3955 - 351s/epoch - 39ms/step
Epoch 24/50
9052/9052 - 362s - loss: 12.1367 - accuracy10: 0.5304 - accuracy20: 0.4916 - accuracy30: 0.4619 - accuracy50: 0.4421 - val_loss: 12.5100 - val_accuracy10: 0.5047 - val_accuracy20: 0.4583 - val_accuracy30: 0.4315 - val_accuracy50: 0.3953 - 362s/epoch - 40ms/step
Epoch 25/50
9052/9052 - 355s - loss: 12.1306 - accuracy10: 0.5310 - accuracy20: 0.4923 - accuracy30: 0.4628 - accuracy50: 0.4428 - val_loss: 12.4868 - val_accuracy10: 0.5081 - val_accuracy20: 0.4595 - val_accuracy30: 0.4324 - val_accuracy50: 0.3959 - 355s/epoch - 39ms/step
Epoch 26/50
9052/9052 - 351s - loss: 12.1250 - accuracy10: 0.5313 - accuracy20: 0.4927 - accuracy30: 0.4633 - accuracy50: 0.4433 - val_loss: 12.5084 - val_accuracy10: 0.5048 - val_accuracy20: 0.4589 - val_accuracy30: 0.4325 - val_accuracy50: 0.3964 - 351s/epoch - 39ms/step
Epoch 27/50
9052/9052 - 349s - loss: 12.1204 - accuracy10: 0.5314 - accuracy20: 0.4930 - accuracy30: 0.4635 - accuracy50: 0.4438 - val_loss: 12.5190 - val_accuracy10: 0.5032 - val_accuracy20: 0.4574 - val_accuracy30: 0.4315 - val_accuracy50: 0.3964 - 349s/epoch - 39ms/step
Epoch 28/50
9052/9052 - 356s - loss: 12.1143 - accuracy10: 0.5319 - accuracy20: 0.4933 - accuracy30: 0.4641 - accuracy50: 0.4443 - val_loss: 12.5038 - val_accuracy10: 0.5066 - val_accuracy20: 0.4580 - val_accuracy30: 0.4310 - val_accuracy50: 0.3951 - 356s/epoch - 39ms/step
Epoch 29/50
9052/9052 - 354s - loss: 12.1095 - accuracy10: 0.5324 - accuracy20: 0.4938 - accuracy30: 0.4644 - accuracy50: 0.4446 - val_loss: 12.4924 - val_accuracy10: 0.5072 - val_accuracy20: 0.4611 - val_accuracy30: 0.4343 - val_accuracy50: 0.3961 - 354s/epoch - 39ms/step
Epoch 30/50
9052/9052 - 346s - loss: 12.1049 - accuracy10: 0.5327 - accuracy20: 0.4943 - accuracy30: 0.4647 - accuracy50: 0.4450 - val_loss: 12.4996 - val_accuracy10: 0.5064 - val_accuracy20: 0.4600 - val_accuracy30: 0.4336 - val_accuracy50: 0.3963 - 346s/epoch - 38ms/step
Epoch 31/50
9052/9052 - 352s - loss: 12.1002 - accuracy10: 0.5331 - accuracy20: 0.4947 - accuracy30: 0.4652 - accuracy50: 0.4457 - val_loss: 12.4970 - val_accuracy10: 0.5063 - val_accuracy20: 0.4587 - val_accuracy30: 0.4324 - val_accuracy50: 0.3960 - 352s/epoch - 39ms/step
Epoch 32/50
9052/9052 - 367s - loss: 12.0962 - accuracy10: 0.5333 - accuracy20: 0.4950 - accuracy30: 0.4661 - accuracy50: 0.4462 - val_loss: 12.4843 - val_accuracy10: 0.5076 - val_accuracy20: 0.4605 - val_accuracy30: 0.4345 - val_accuracy50: 0.3972 - 367s/epoch - 41ms/step
Epoch 33/50
9052/9052 - 356s - loss: 12.0928 - accuracy10: 0.5335 - accuracy20: 0.4954 - accuracy30: 0.4662 - accuracy50: 0.4460 - val_loss: 12.5129 - val_accuracy10: 0.5060 - val_accuracy20: 0.4581 - val_accuracy30: 0.4324 - val_accuracy50: 0.3951 - 356s/epoch - 39ms/step
Epoch 34/50
9052/9052 - 350s - loss: 12.0876 - accuracy10: 0.5340 - accuracy20: 0.4956 - accuracy30: 0.4667 - accuracy50: 0.4468 - val_loss: 12.4782 - val_accuracy10: 0.5081 - val_accuracy20: 0.4604 - val_accuracy30: 0.4340 - val_accuracy50: 0.3970 - 350s/epoch - 39ms/step
Epoch 35/50
9052/9052 - 349s - loss: 12.0835 - accuracy10: 0.5341 - accuracy20: 0.4957 - accuracy30: 0.4668 - accuracy50: 0.4472 - val_loss: 12.4802 - val_accuracy10: 0.5086 - val_accuracy20: 0.4608 - val_accuracy30: 0.4344 - val_accuracy50: 0.3968 - 349s/epoch - 39ms/step
Epoch 36/50
9052/9052 - 356s - loss: 12.0786 - accuracy10: 0.5341 - accuracy20: 0.4960 - accuracy30: 0.4672 - accuracy50: 0.4477 - val_loss: 12.4607 - val_accuracy10: 0.5092 - val_accuracy20: 0.4618 - val_accuracy30: 0.4354 - val_accuracy50: 0.3984 - 356s/epoch - 39ms/step
Epoch 37/50
9052/9052 - 357s - loss: 12.0746 - accuracy10: 0.5346 - accuracy20: 0.4968 - accuracy30: 0.4681 - accuracy50: 0.4482 - val_loss: 12.4920 - val_accuracy10: 0.5076 - val_accuracy20: 0.4601 - val_accuracy30: 0.4336 - val_accuracy50: 0.3955 - 357s/epoch - 39ms/step
Epoch 38/50
9052/9052 - 354s - loss: 12.0709 - accuracy10: 0.5344 - accuracy20: 0.4967 - accuracy30: 0.4684 - accuracy50: 0.4483 - val_loss: 12.5032 - val_accuracy10: 0.5065 - val_accuracy20: 0.4590 - val_accuracy30: 0.4328 - val_accuracy50: 0.3963 - 354s/epoch - 39ms/step
Epoch 39/50
9052/9052 - 359s - loss: 12.0684 - accuracy10: 0.5348 - accuracy20: 0.4967 - accuracy30: 0.4683 - accuracy50: 0.4486 - val_loss: 12.4677 - val_accuracy10: 0.5100 - val_accuracy20: 0.4622 - val_accuracy30: 0.4355 - val_accuracy50: 0.3965 - 359s/epoch - 40ms/step
Epoch 40/50
9052/9052 - 351s - loss: 12.0643 - accuracy10: 0.5351 - accuracy20: 0.4971 - accuracy30: 0.4690 - accuracy50: 0.4491 - val_loss: 12.4946 - val_accuracy10: 0.5066 - val_accuracy20: 0.4615 - val_accuracy30: 0.4361 - val_accuracy50: 0.3980 - 351s/epoch - 39ms/step
Epoch 41/50
9052/9052 - 354s - loss: 12.0595 - accuracy10: 0.5351 - accuracy20: 0.4979 - accuracy30: 0.4697 - accuracy50: 0.4496 - val_loss: 12.4687 - val_accuracy10: 0.5097 - val_accuracy20: 0.4624 - val_accuracy30: 0.4357 - val_accuracy50: 0.3976 - 354s/epoch - 39ms/step
Epoch 42/50
9052/9052 - 353s - loss: 12.0568 - accuracy10: 0.5355 - accuracy20: 0.4979 - accuracy30: 0.4698 - accuracy50: 0.4501 - val_loss: 12.4684 - val_accuracy10: 0.5085 - val_accuracy20: 0.4625 - val_accuracy30: 0.4367 - val_accuracy50: 0.3984 - 353s/epoch - 39ms/step
Epoch 43/50
9052/9052 - 357s - loss: 12.0530 - accuracy10: 0.5357 - accuracy20: 0.4983 - accuracy30: 0.4701 - accuracy50: 0.4503 - val_loss: 12.5018 - val_accuracy10: 0.5052 - val_accuracy20: 0.4616 - val_accuracy30: 0.4369 - val_accuracy50: 0.3984 - 357s/epoch - 39ms/step
Epoch 44/50
9052/9052 - 358s - loss: 12.0487 - accuracy10: 0.5357 - accuracy20: 0.4985 - accuracy30: 0.4704 - accuracy50: 0.4507 - val_loss: 12.4665 - val_accuracy10: 0.5098 - val_accuracy20: 0.4629 - val_accuracy30: 0.4365 - val_accuracy50: 0.3976 - 358s/epoch - 40ms/step
Epoch 45/50
9052/9052 - 356s - loss: 12.0461 - accuracy10: 0.5359 - accuracy20: 0.4983 - accuracy30: 0.4703 - accuracy50: 0.4513 - val_loss: 12.4829 - val_accuracy10: 0.5081 - val_accuracy20: 0.4619 - val_accuracy30: 0.4366 - val_accuracy50: 0.3976 - 356s/epoch - 39ms/step
Epoch 46/50
9052/9052 - 353s - loss: 12.0430 - accuracy10: 0.5360 - accuracy20: 0.4987 - accuracy30: 0.4709 - accuracy50: 0.4517 - val_loss: 12.4828 - val_accuracy10: 0.5081 - val_accuracy20: 0.4616 - val_accuracy30: 0.4359 - val_accuracy50: 0.3968 - 353s/epoch - 39ms/step
testing model: results/AAPL/W7/deepVOL_L3/seq2seq
Evaluating performance on  test set...
23942/23942 - 380s - 380s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0140486
{'0': {'precision': 0.45468466259478374, 'recall': 0.6563316157924346, 'f1-score': 0.5372089051837704, 'support': 1878849}, '1': {'precision': 0.5859091025124501, 'recall': 0.22159239256819666, 'f1-score': 0.32156720611458917, 'support': 2382302}, '2': {'precision': 0.466374480519687, 'recall': 0.628180755741836, 'f1-score': 0.5353178422172642, 'support': 1867913}, 'accuracy': 0.47877375729801486, 'macro avg': {'precision': 0.502322748542307, 'recall': 0.5020349213674891, 'f1-score': 0.46469798450520794, 'support': 6129064}, 'weighted avg': {'precision': 0.5092528329604865, 'recall': 0.47877375729801486, 'f1-score': 0.45281494354870444, 'support': 6129064}}
[[1233148  181579  464122]
 [ 975935  527900  878467]
 [ 503012  191514 1173387]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0578465
{'0': {'precision': 0.4156108659870814, 'recall': 0.6406183126239539, 'f1-score': 0.504148033529894, 'support': 1876203}, '1': {'precision': 0.5224986756775432, 'recall': 0.13282893149254962, 'f1-score': 0.21181143610361128, 'support': 2391083}, '2': {'precision': 0.4258677202513572, 'recall': 0.6014202552613684, 'f1-score': 0.49864396182251536, 'support': 1861778}, 'accuracy': 0.4306115909378659, 'macro avg': {'precision': 0.4546590873053273, 'recall': 0.4582891664592907, 'f1-score': 0.4048678104853402, 'support': 6129064}, 'weighted avg': {'precision': 0.46042580188537413, 'recall': 0.4306115909378659, 'f1-score': 0.38842915247414905, 'support': 6129064}}
[[1201930  142784  531489]
 [1095432  317605  978046]
 [ 594598  147469 1119711]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0693465
{'0': {'precision': 0.4038285796259818, 'recall': 0.6320806840513964, 'f1-score': 0.49280811321905454, 'support': 1923949}, '1': {'precision': 0.4630169525548317, 'recall': 0.08436976648793075, 'f1-score': 0.14273138462445117, 'support': 2296498}, '2': {'precision': 0.41410374489014884, 'recall': 0.5856324238964653, 'f1-score': 0.4851531582756686, 'support': 1908617}, 'accuracy': 0.41239478001861296, 'macro avg': {'precision': 0.42698309235698745, 'recall': 0.4340276248119308, 'f1-score': 0.37356421870639145, 'support': 6129064}, 'weighted avg': {'precision': 0.42920559235669514, 'recall': 0.41239478001861296, 'f1-score': 0.35925413430755515, 'support': 6129064}}
[[1216091  110123  597735]
 [1119028  193755  983715]
 [ 676285  114584 1117748]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0944517
{'0': {'precision': 0.32926249577914185, 'recall': 0.6251093223131486, 'f1-score': 0.4313309586426439, 'support': 1614492}, '1': {'precision': 0.556704592935429, 'recall': 0.07164857317479682, 'f1-score': 0.12695755162848202, 'support': 2900951}, '2': {'precision': 0.34089244187018897, 'recall': 0.568408566819594, 'f1-score': 0.42618710959589645, 'support': 1613621}, 'accuracy': 0.34822266499419813, 'macro avg': {'precision': 0.4089531768615866, 'recall': 0.4217221541025131, 'f1-score': 0.3281585399556741, 'support': 6129064}, 'weighted avg': {'precision': 0.43997511102169923, 'recall': 0.34822266499419813, 'f1-score': 0.2859135568511466, 'support': 6129064}}
[[1009234   77532  527726]
 [1447451  207849 1245651]
 [ 608450   87975  917196]]
Evaluating performance on  train set...
9052/9052 - 146s - 146s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9752519
{'0': {'precision': 0.5029838895062453, 'recall': 0.638946803314958, 'f1-score': 0.5628711975942294, 'support': 784203}, '1': {'precision': 0.5879144227813933, 'recall': 0.2918937926275842, 'f1-score': 0.39010449686775406, 'support': 753620}, '2': {'precision': 0.509516948830292, 'recall': 0.6190204258672043, 'f1-score': 0.5589560536017321, 'support': 779257}, 'accuracy': 0.5193679113366824, 'macro avg': {'precision': 0.5334717537059769, 'recall': 0.5166203406032488, 'f1-score': 0.5039772493545719, 'support': 2317080}, 'weighted avg': {'precision': 0.5328043017045706, 'recall': 0.5193679113366824, 'f1-score': 0.5053628921565028, 'support': 2317080}}
[[501064  74144 208995]
 [278282 219977 255361]
 [216837  80044 482376]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.019164
{'0': {'precision': 0.45974603796250446, 'recall': 0.6271551253616758, 'f1-score': 0.5305580558789227, 'support': 778667}, '1': {'precision': 0.5347205048988705, 'recall': 0.20132237387354307, 'f1-score': 0.2925133970038345, 'support': 762568}, '2': {'precision': 0.4736790983780187, 'recall': 0.5908538432289955, 'f1-score': 0.5258176704450302, 'support': 775845}, 'accuracy': 0.47485542147875776, 'macro avg': {'precision': 0.4893818804131312, 'recall': 0.47311044748807146, 'f1-score': 0.4496297077759291, 'support': 2317080}, 'weighted avg': {'precision': 0.4890859936657195, 'recall': 0.47485542147875776, 'f1-score': 0.4506285567826392, 'support': 2317080}}
[[488345  63078 227244]
 [326934 153522 282112]
 [246927  70507 458411]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0445579
{'0': {'precision': 0.4315520623063431, 'recall': 0.6251286879206234, 'f1-score': 0.5106094237470641, 'support': 772217}, '1': {'precision': 0.4898746703408569, 'recall': 0.13307925613605434, 'f1-score': 0.20930009093143523, 'support': 777454}, '2': {'precision': 0.447190499101061, 'recall': 0.5753125126236466, 'f1-score': 0.5032245122198641, 'support': 767409}, 'accuracy': 0.44353151380185407, 'macro avg': {'precision': 0.456205743916087, 'recall': 0.4445068188934414, 'f1-score': 0.4077113422994545, 'support': 2317080}, 'weighted avg': {'precision': 0.4563005483530323, 'recall': 0.44353151380185407, 'f1-score': 0.40706470642827536, 'support': 2317080}}
[[482735  50814 238668]
 [366884 103463 307107]
 [268983  56926 441500]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0639948
{'0': {'precision': 0.4114321072130619, 'recall': 0.6134365025929371, 'f1-score': 0.4925264965447587, 'support': 778268}, '1': {'precision': 0.43275585259306276, 'recall': 0.09019470009026863, 'f1-score': 0.14927715110600712, 'support': 771032}, '2': {'precision': 0.4255387293787858, 'recall': 0.5520292271223528, 'f1-score': 0.48060048271298994, 'support': 767780}, 'accuracy': 0.4189747440744385, 'macro avg': {'precision': 0.42324222972830344, 'recall': 0.4185534766018528, 'f1-score': 0.37413471012125193, 'support': 2317080}, 'weighted avg': {'precision': 0.42320212482757336, 'recall': 0.4189747440744385, 'f1-score': 0.3743550116533924, 'support': 2317080}}
[[477418  43737 257113]
 [386438  69543 315051]
 [296525  47418 423837]]
Evaluating performance on  val set...
2763/2763 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98680556
{'0': {'precision': 0.4876290527078428, 'recall': 0.635727043225884, 'f1-score': 0.5519157762905562, 'support': 232916}, '1': {'precision': 0.6049652432969216, 'recall': 0.2911549698488494, 'f1-score': 0.3931138581360507, 'support': 240621}, '2': {'precision': 0.49399871463063, 'recall': 0.60826938377435, 'f1-score': 0.5452109049849223, 'support': 233778}, 'accuracy': 0.5094321483356072, 'macro avg': {'precision': 0.5288643368784648, 'recall': 0.5117171322830278, 'f1-score': 0.49674684647050976, 'support': 707315}, 'weighted avg': {'precision': 0.5296508369775389, 'recall': 0.5094321483356072, 'f1-score': 0.49567700325118375, 'support': 707315}}
[[148071  20991  63854]
 [ 88762  70058  81801]
 [ 66822  24756 142200]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0330174
{'0': {'precision': 0.44470184681919556, 'recall': 0.6224815841515756, 'f1-score': 0.5187837480410168, 'support': 231594}, '1': {'precision': 0.5475500329125911, 'recall': 0.1953798480278231, 'f1-score': 0.2879955294910848, 'support': 242676}, '2': {'precision': 0.4558091069423321, 'recall': 0.5800038619150808, 'f1-score': 0.5104609621063921, 'support': 233045}, 'accuracy': 0.46194976778380215, 'macro avg': {'precision': 0.48268699555803957, 'recall': 0.4659550980314931, 'f1-score': 0.439080079879498, 'support': 707315}, 'weighted avg': {'precision': 0.4836481124063769, 'recall': 0.46194976778380215, 'f1-score': 0.43685936445950374, 'support': 707315}}
[[144163  17755  69676]
 [103562  47414  91700]
 [ 76454  21424 135167]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0531172
{'0': {'precision': 0.42228590497154767, 'recall': 0.61732373090962, 'f1-score': 0.5015096077800857, 'support': 233691}, '1': {'precision': 0.4978874289596209, 'recall': 0.1265418191465618, 'f1-score': 0.20179573965132835, 'support': 237463}, '2': {'precision': 0.4394015811985406, 'recall': 0.5681124317732394, 'f1-score': 0.49553554115520065, 'support': 236161}, 'accuracy': 0.43612534726394886, 'macro avg': {'precision': 0.4531916383765697, 'recall': 0.4373259939431404, 'f1-score': 0.39961362952887153, 'support': 707315}, 'weighted avg': {'precision': 0.4533818380483561, 'recall': 0.43612534726394886, 'f1-score': 0.3988936646491489, 'support': 707315}}
[[144263  13664  75764]
 [112006  30049  95408]
 [ 85355  16640 134166]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0758541
{'0': {'precision': 0.38516946992142576, 'recall': 0.6022481166044404, 'f1-score': 0.4698469846984698, 'support': 225789}, '1': {'precision': 0.43912372172122893, 'recall': 0.07799868041368237, 'f1-score': 0.1324679444990094, 'support': 251594}, '2': {'precision': 0.4075630523541268, 'recall': 0.5487491954142965, 'f1-score': 0.4677340431053018, 'support': 229932}, 'accuracy': 0.39837978835455207, 'macro avg': {'precision': 0.41061874799892717, 'recall': 0.4096653308108064, 'f1-score': 0.3566829907675937, 'support': 707315}, 'weighted avg': {'precision': 0.4116407977219609, 'recall': 0.39837978835455207, 'f1-score': 0.3491534109352337, 'support': 707315}}
[[135981  11322  78486]
 [127047  19624 104923]
 [ 90014  13743 126175]]
training model: results/AAPL/W8/deepLOB_L1/seq2seq
Epoch 1/50
3903/3903 - 87s - loss: 12.8418 - accuracy10: 0.4269 - accuracy20: 0.4126 - accuracy30: 0.4019 - accuracy50: 0.4035 - val_loss: 13.9359 - val_accuracy10: 0.3265 - val_accuracy20: 0.3287 - val_accuracy30: 0.3221 - val_accuracy50: 0.3370 - 87s/epoch - 22ms/step
Epoch 2/50
3903/3903 - 89s - loss: 12.7941 - accuracy10: 0.4375 - accuracy20: 0.4205 - accuracy30: 0.4074 - accuracy50: 0.4070 - val_loss: 13.8123 - val_accuracy10: 0.3462 - val_accuracy20: 0.3428 - val_accuracy30: 0.3335 - val_accuracy50: 0.3440 - 89s/epoch - 23ms/step
Epoch 3/50
3903/3903 - 97s - loss: 12.7691 - accuracy10: 0.4431 - accuracy20: 0.4247 - accuracy30: 0.4104 - accuracy50: 0.4091 - val_loss: 13.6360 - val_accuracy10: 0.3488 - val_accuracy20: 0.3449 - val_accuracy30: 0.3374 - val_accuracy50: 0.3451 - 97s/epoch - 25ms/step
Epoch 4/50
3903/3903 - 91s - loss: 12.7318 - accuracy10: 0.4488 - accuracy20: 0.4290 - accuracy30: 0.4151 - accuracy50: 0.4129 - val_loss: 13.5468 - val_accuracy10: 0.3492 - val_accuracy20: 0.3455 - val_accuracy30: 0.3374 - val_accuracy50: 0.3446 - 91s/epoch - 23ms/step
Epoch 5/50
3903/3903 - 87s - loss: 12.7085 - accuracy10: 0.4520 - accuracy20: 0.4319 - accuracy30: 0.4173 - accuracy50: 0.4155 - val_loss: 13.5793 - val_accuracy10: 0.3422 - val_accuracy20: 0.3398 - val_accuracy30: 0.3323 - val_accuracy50: 0.3411 - 87s/epoch - 22ms/step
Epoch 6/50
3903/3903 - 92s - loss: 12.6945 - accuracy10: 0.4533 - accuracy20: 0.4329 - accuracy30: 0.4189 - accuracy50: 0.4171 - val_loss: 13.5886 - val_accuracy10: 0.3394 - val_accuracy20: 0.3372 - val_accuracy30: 0.3293 - val_accuracy50: 0.3401 - 92s/epoch - 24ms/step
Epoch 7/50
3903/3903 - 85s - loss: 12.6776 - accuracy10: 0.4546 - accuracy20: 0.4343 - accuracy30: 0.4197 - accuracy50: 0.4188 - val_loss: 13.6366 - val_accuracy10: 0.3363 - val_accuracy20: 0.3355 - val_accuracy30: 0.3277 - val_accuracy50: 0.3391 - 85s/epoch - 22ms/step
Epoch 8/50
3903/3903 - 83s - loss: 12.6685 - accuracy10: 0.4560 - accuracy20: 0.4355 - accuracy30: 0.4211 - accuracy50: 0.4200 - val_loss: 13.6089 - val_accuracy10: 0.3371 - val_accuracy20: 0.3355 - val_accuracy30: 0.3278 - val_accuracy50: 0.3398 - 83s/epoch - 21ms/step
Epoch 9/50
3903/3903 - 84s - loss: 12.6522 - accuracy10: 0.4578 - accuracy20: 0.4368 - accuracy30: 0.4224 - accuracy50: 0.4216 - val_loss: 13.6202 - val_accuracy10: 0.3372 - val_accuracy20: 0.3353 - val_accuracy30: 0.3286 - val_accuracy50: 0.3404 - 84s/epoch - 21ms/step
Epoch 10/50
3903/3903 - 92s - loss: 12.6378 - accuracy10: 0.4592 - accuracy20: 0.4384 - accuracy30: 0.4240 - accuracy50: 0.4229 - val_loss: 13.7233 - val_accuracy10: 0.3363 - val_accuracy20: 0.3344 - val_accuracy30: 0.3265 - val_accuracy50: 0.3391 - 92s/epoch - 24ms/step
Epoch 11/50
3903/3903 - 97s - loss: 12.6289 - accuracy10: 0.4601 - accuracy20: 0.4389 - accuracy30: 0.4246 - accuracy50: 0.4243 - val_loss: 13.7231 - val_accuracy10: 0.3366 - val_accuracy20: 0.3343 - val_accuracy30: 0.3275 - val_accuracy50: 0.3396 - 97s/epoch - 25ms/step
Epoch 12/50
3903/3903 - 91s - loss: 12.6168 - accuracy10: 0.4620 - accuracy20: 0.4400 - accuracy30: 0.4253 - accuracy50: 0.4251 - val_loss: 13.8435 - val_accuracy10: 0.3351 - val_accuracy20: 0.3336 - val_accuracy30: 0.3257 - val_accuracy50: 0.3375 - 91s/epoch - 23ms/step
Epoch 13/50
3903/3903 - 85s - loss: 12.6059 - accuracy10: 0.4624 - accuracy20: 0.4409 - accuracy30: 0.4265 - accuracy50: 0.4256 - val_loss: 13.8142 - val_accuracy10: 0.3378 - val_accuracy20: 0.3360 - val_accuracy30: 0.3293 - val_accuracy50: 0.3401 - 85s/epoch - 22ms/step
Epoch 14/50
3903/3903 - 93s - loss: 12.5972 - accuracy10: 0.4635 - accuracy20: 0.4416 - accuracy30: 0.4271 - accuracy50: 0.4263 - val_loss: 13.6992 - val_accuracy10: 0.3378 - val_accuracy20: 0.3360 - val_accuracy30: 0.3279 - val_accuracy50: 0.3392 - 93s/epoch - 24ms/step
testing model: results/AAPL/W8/deepLOB_L1/seq2seq
Evaluating performance on  test set...
10609/10609 - 106s - 106s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1381425
{'0': {'precision': 0.37146847423854257, 'recall': 0.09557114625184378, 'f1-score': 0.15202850602749574, 'support': 873883}, '1': {'precision': 0.3486075961825378, 'recall': 0.8284147277509286, 'f1-score': 0.4907157001378799, 'support': 940646}, '2': {'precision': 0.46134310076973345, 'recall': 0.1308246213462087, 'f1-score': 0.2038443981824092, 'support': 901153}, 'accuracy': 0.361108553947038, 'macro avg': {'precision': 0.39380639039693793, 'recall': 0.3516034984496604, 'f1-score': 0.2821962014492616, 'support': 2715682}, 'weighted avg': {'precision': 0.39337339382139275, 'recall': 0.361108553947038, 'f1-score': 0.28653571307686054, 'support': 2715682}}
[[ 83518 731635  58730]
 [ 82481 779245  78920]
 [ 58833 724427 117893]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1516885
{'0': {'precision': 0.36489789840715725, 'recall': 0.09854023159260968, 'f1-score': 0.15517550710260253, 'support': 895279}, '1': {'precision': 0.32948729333942695, 'recall': 0.8508267763218241, 'f1-score': 0.4750203676068086, 'support': 893954}, '2': {'precision': 0.4625690424104715, 'recall': 0.08262192522200358, 'f1-score': 0.14020168014894765, 'support': 926449}, 'accuracy': 0.3407490273161585, 'macro avg': {'precision': 0.38565141138568526, 'recall': 0.3439963110454791, 'f1-score': 0.25679918495278625, 'support': 2715682}, 'weighted avg': {'precision': 0.38656165787826197, 'recall': 0.3407490273161585, 'f1-score': 0.255354432845672, 'support': 2715682}}
[[ 88221 766904  40154]
 [ 84575 760600  48779]
 [ 68973 780931  76545]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1649997
{'0': {'precision': 0.3633529795937992, 'recall': 0.0982955500035227, 'f1-score': 0.15473235019613263, 'support': 922585}, '1': {'precision': 0.3053184155435106, 'recall': 0.8696664676994547, 'f1-score': 0.4519635814147124, 'support': 832633}, '2': {'precision': 0.4670888220593841, 'recall': 0.045925719235702746, 'f1-score': 0.08362877997914495, 'support': 960464}, 'accuracy': 0.31627745811181135, 'macro avg': {'precision': 0.3785867390655646, 'recall': 0.33796257897956, 'f1-score': 0.23010823719666332, 'support': 2715682}, 'weighted avg': {'precision': 0.38224806709998793, 'recall': 0.31627745811181135, 'f1-score': 0.2207165531618447, 'support': 2715682}}
[[ 90686 807628  24271]
 [ 82465 724113  26055]
 [ 76430 839924  44110]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1558132
{'0': {'precision': 0.33210819572485056, 'recall': 0.0914310958991219, 'f1-score': 0.14338700986052502, 'support': 896369}, '1': {'precision': 0.3270042446937196, 'recall': 0.8819639350036449, 'f1-score': 0.47711090375457693, 'support': 897158}, '2': {'precision': 0.43655957706384707, 'recall': 0.023282419983625312, 'f1-score': 0.04420719936993931, 'support': 922155}, 'accuracy': 0.32945204924582483, 'macro avg': {'precision': 0.36522400582747244, 'recall': 0.3322258169621307, 'f1-score': 0.22156837099501378, 'support': 2715682}, 'weighted avg': {'precision': 0.36589024865279823, 'recall': 0.32945204924582483, 'f1-score': 0.21995853150969222, 'support': 2715682}}
[[ 81956 801528  12885]
 [ 91072 791261  14825]
 [ 73747 826938  21470]]
Evaluating performance on  train set...
3903/3903 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1345178
{'0': {'precision': 0.40521605224789353, 'recall': 0.22064040009395786, 'f1-score': 0.2857109855076928, 'support': 336321}, '1': {'precision': 0.33185250999555754, 'recall': 0.8028952750634147, 'f1-score': 0.4696071070621581, 'support': 325634}, '2': {'precision': 0.4945524460585345, 'recall': 0.04120341255621344, 'f1-score': 0.07606915776272337, 'support': 337108}, 'accuracy': 0.34987383178037823, 'macro avg': {'precision': 0.4105403361006619, 'recall': 0.354913029237862, 'f1-score': 0.2771290834441914, 'support': 999063}, 'weighted avg': {'precision': 0.41144824113580186, 'recall': 0.34987383178037823, 'f1-score': 0.27491175901128123, 'support': 999063}}
[[ 74206 254570   7545]
 [ 57533 261450   6651]
 [ 51388 271830  13890]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1404048
{'0': {'precision': 0.3831214887461284, 'recall': 0.22473077084243734, 'f1-score': 0.28328984924888556, 'support': 334102}, '1': {'precision': 0.3323577923882313, 'recall': 0.7922278769464489, 'f1-score': 0.4682668745123006, 'support': 329125}, '2': {'precision': 0.4894957983193277, 'recall': 0.027057849664717304, 'f1-score': 0.051281038374717834, 'support': 335836}, 'accuracy': 0.3452354856500541, 'macro avg': {'precision': 0.4016583598178958, 'recall': 0.3480054991512012, 'f1-score': 0.2676125873786347, 'support': 999063}, 'weighted avg': {'precision': 0.40215604519154985, 'recall': 0.3452354856500541, 'f1-score': 0.26623752365088477, 'support': 999063}}
[[ 75083 253819   5200]
 [ 64106 260742   4277]
 [ 56788 269961   9087]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1446773
{'0': {'precision': 0.36924281001396886, 'recall': 0.2228014119742832, 'f1-score': 0.2779110626438871, 'support': 334567}, '1': {'precision': 0.3288134213401751, 'recall': 0.7875123764261451, 'f1-score': 0.463923057871708, 'support': 328245}, '2': {'precision': 0.4839586731919521, 'recall': 0.01588099366247238, 'f1-score': 0.030752839886548512, 'support': 336251}, 'accuracy': 0.3386963584879032, 'macro avg': {'precision': 0.39400496818203207, 'recall': 0.3420649273543002, 'f1-score': 0.25752898680071457, 'support': 999063}, 'weighted avg': {'precision': 0.39456911979046005, 'recall': 0.3386963584879032, 'f1-score': 0.2558406905183837, 'support': 999063}}
[[ 74542 256817   3208]
 [ 67262 258497   2486]
 [ 60074 270837   5340]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1497777
{'0': {'precision': 0.35919847155988144, 'recall': 0.2117831758458791, 'f1-score': 0.26646107948151854, 'support': 338228}, '1': {'precision': 0.3211905310571403, 'recall': 0.7921440261865794, 'f1-score': 0.4570578696030032, 'support': 321997}, '2': {'precision': 0.4530938123752495, 'recall': 0.007369303324892722, 'f1-score': 0.014502728336658449, 'support': 338838}, 'accuracy': 0.3295047459469523, 'macro avg': {'precision': 0.3778276049974238, 'recall': 0.3370988351191171, 'f1-score': 0.24600722580706005, 'support': 999063}, 'weighted avg': {'precision': 0.3787936989610929, 'recall': 0.3295047459469523, 'f1-score': 0.24243709985613515, 'support': 999063}}
[[ 71631 264785   1812]
 [ 65727 255068   1202]
 [ 62061 274280   2497]]
Evaluating performance on  val set...
1144/1144 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1274585
{'0': {'precision': 0.40284421045873325, 'recall': 0.25245941215522966, 'f1-score': 0.3103960028692275, 'support': 99414}, '1': {'precision': 0.32718838023415914, 'recall': 0.7733334751350661, 'f1-score': 0.4598286274385809, 'support': 94028}, '2': {'precision': 0.5137841513166028, 'recall': 0.04189896260749463, 'f1-score': 0.07747949291573453, 'support': 99191}, 'accuracy': 0.3484535236969173, 'macro avg': {'precision': 0.4146055806698317, 'recall': 0.35589728329926346, 'f1-score': 0.28256804107451433, 'support': 292633}, 'weighted avg': {'precision': 0.41613894232177223, 'recall': 0.3484535236969173, 'f1-score': 0.27946179272959953, 'support': 292633}}
[[25098 72357  1959]
 [19339 72715  1974]
 [17865 77170  4156]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1313163
{'0': {'precision': 0.3841801829502652, 'recall': 0.25272046925566344, 'f1-score': 0.3048833307915205, 'support': 98880}, '1': {'precision': 0.32900004942909394, 'recall': 0.7668845315904139, 'f1-score': 0.4604591636190972, 'support': 95472}, '2': {'precision': 0.4953437685753913, 'recall': 0.025437266613078824, 'f1-score': 0.04838959430164138, 'support': 98281}, 'accuracy': 0.3441341202120062, 'macro avg': {'precision': 0.4028413336515835, 'recall': 0.3483474224863854, 'f1-score': 0.27124402957075305, 'support': 292633}, 'weighted avg': {'precision': 0.40351194201807283, 'recall': 0.3441341202120062, 'f1-score': 0.2694966006406236, 'support': 292633}}
[[24989 72576  1315]
 [21024 73216  1232]
 [19032 76749  2500]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1364802
{'0': {'precision': 0.37695059520138163, 'recall': 0.24430364566677326, 'f1-score': 0.2964660797011812, 'support': 100064}, '1': {'precision': 0.3226739014410247, 'recall': 0.7721206445158681, 'f1-score': 0.45514143575008936, 'support': 93962}, '2': {'precision': 0.49506970418225094, 'recall': 0.014765686006064479, 'f1-score': 0.028676094063890975, 'support': 98607}, 'accuracy': 0.3364350568801195, 'macro avg': {'precision': 0.39823140027488574, 'recall': 0.343729992062902, 'f1-score': 0.2600945365050538, 'support': 292633}, 'weighted avg': {'precision': 0.3993247781546574, 'recall': 0.3364350568801195, 'f1-score': 0.25717962428204266, 'support': 292633}}
[[24446 74811   807]
 [20734 72550   678]
 [19672 77479  1456]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1317451
{'0': {'precision': 0.35980410985212213, 'recall': 0.22970819028935752, 'f1-score': 0.28040110753573294, 'support': 97872}, '1': {'precision': 0.33837805219338135, 'recall': 0.7853112504820475, 'f1-score': 0.4729636398085727, 'support': 98538}, '2': {'precision': 0.460643394934976, 'recall': 0.006994169793084814, 'f1-score': 0.013779124523975268, 'support': 96223}, 'accuracy': 0.34356343953005986, 'macro avg': {'precision': 0.38627518566015984, 'recall': 0.34067120352149666, 'f1-score': 0.2557146239560936, 'support': 292633}, 'weighted avg': {'precision': 0.3857471089634679, 'recall': 0.34356343953005986, 'f1-score': 0.25757237575825304, 'support': 292633}}
[[22482 74964   426]
 [20793 77383   362]
 [19209 76341   673]]
training model: results/AAPL/W8/deepOF_L1/seq2seq
Epoch 1/50
3903/3903 - 86s - loss: 12.9139 - accuracy10: 0.4170 - accuracy20: 0.4066 - accuracy30: 0.4004 - accuracy50: 0.4037 - val_loss: 14.0063 - val_accuracy10: 0.3381 - val_accuracy20: 0.3348 - val_accuracy30: 0.3267 - val_accuracy50: 0.3400 - 86s/epoch - 22ms/step
Epoch 2/50
3903/3903 - 82s - loss: 12.8969 - accuracy10: 0.4208 - accuracy20: 0.4096 - accuracy30: 0.4030 - accuracy50: 0.4050 - val_loss: 13.8466 - val_accuracy10: 0.3413 - val_accuracy20: 0.3377 - val_accuracy30: 0.3288 - val_accuracy50: 0.3416 - 82s/epoch - 21ms/step
Epoch 3/50
3903/3903 - 85s - loss: 12.8862 - accuracy10: 0.4221 - accuracy20: 0.4105 - accuracy30: 0.4034 - accuracy50: 0.4053 - val_loss: 13.8252 - val_accuracy10: 0.3395 - val_accuracy20: 0.3368 - val_accuracy30: 0.3285 - val_accuracy50: 0.3412 - 85s/epoch - 22ms/step
Epoch 4/50
3903/3903 - 86s - loss: 12.8743 - accuracy10: 0.4235 - accuracy20: 0.4119 - accuracy30: 0.4049 - accuracy50: 0.4069 - val_loss: 13.8445 - val_accuracy10: 0.3383 - val_accuracy20: 0.3360 - val_accuracy30: 0.3281 - val_accuracy50: 0.3410 - 86s/epoch - 22ms/step
Epoch 5/50
3903/3903 - 86s - loss: 12.8668 - accuracy10: 0.4248 - accuracy20: 0.4131 - accuracy30: 0.4056 - accuracy50: 0.4075 - val_loss: 13.8662 - val_accuracy10: 0.3387 - val_accuracy20: 0.3363 - val_accuracy30: 0.3282 - val_accuracy50: 0.3413 - 86s/epoch - 22ms/step
Epoch 6/50
3903/3903 - 84s - loss: 12.8572 - accuracy10: 0.4261 - accuracy20: 0.4138 - accuracy30: 0.4064 - accuracy50: 0.4083 - val_loss: 13.8540 - val_accuracy10: 0.3393 - val_accuracy20: 0.3366 - val_accuracy30: 0.3284 - val_accuracy50: 0.3412 - 84s/epoch - 22ms/step
Epoch 7/50
3903/3903 - 81s - loss: 12.8485 - accuracy10: 0.4273 - accuracy20: 0.4146 - accuracy30: 0.4072 - accuracy50: 0.4091 - val_loss: 13.8425 - val_accuracy10: 0.3398 - val_accuracy20: 0.3367 - val_accuracy30: 0.3284 - val_accuracy50: 0.3414 - 81s/epoch - 21ms/step
Epoch 8/50
3903/3903 - 86s - loss: 12.8392 - accuracy10: 0.4288 - accuracy20: 0.4155 - accuracy30: 0.4079 - accuracy50: 0.4096 - val_loss: 13.8140 - val_accuracy10: 0.3401 - val_accuracy20: 0.3371 - val_accuracy30: 0.3291 - val_accuracy50: 0.3419 - 86s/epoch - 22ms/step
Epoch 9/50
3903/3903 - 83s - loss: 12.8336 - accuracy10: 0.4296 - accuracy20: 0.4165 - accuracy30: 0.4083 - accuracy50: 0.4102 - val_loss: 13.8098 - val_accuracy10: 0.3408 - val_accuracy20: 0.3372 - val_accuracy30: 0.3290 - val_accuracy50: 0.3418 - 83s/epoch - 21ms/step
Epoch 10/50
3903/3903 - 79s - loss: 12.8280 - accuracy10: 0.4299 - accuracy20: 0.4171 - accuracy30: 0.4093 - accuracy50: 0.4104 - val_loss: 13.8066 - val_accuracy10: 0.3409 - val_accuracy20: 0.3375 - val_accuracy30: 0.3293 - val_accuracy50: 0.3418 - 79s/epoch - 20ms/step
Epoch 11/50
3903/3903 - 82s - loss: 12.8223 - accuracy10: 0.4312 - accuracy20: 0.4176 - accuracy30: 0.4095 - accuracy50: 0.4106 - val_loss: 13.8018 - val_accuracy10: 0.3423 - val_accuracy20: 0.3382 - val_accuracy30: 0.3295 - val_accuracy50: 0.3419 - 82s/epoch - 21ms/step
Epoch 12/50
3903/3903 - 82s - loss: 12.8183 - accuracy10: 0.4320 - accuracy20: 0.4186 - accuracy30: 0.4103 - accuracy50: 0.4117 - val_loss: 13.7673 - val_accuracy10: 0.3432 - val_accuracy20: 0.3385 - val_accuracy30: 0.3297 - val_accuracy50: 0.3417 - 82s/epoch - 21ms/step
Epoch 13/50
3903/3903 - 76s - loss: 12.8137 - accuracy10: 0.4321 - accuracy20: 0.4187 - accuracy30: 0.4107 - accuracy50: 0.4122 - val_loss: 13.7520 - val_accuracy10: 0.3442 - val_accuracy20: 0.3392 - val_accuracy30: 0.3303 - val_accuracy50: 0.3422 - 76s/epoch - 19ms/step
Epoch 14/50
3903/3903 - 86s - loss: 12.8088 - accuracy10: 0.4330 - accuracy20: 0.4198 - accuracy30: 0.4110 - accuracy50: 0.4125 - val_loss: 13.7555 - val_accuracy10: 0.3436 - val_accuracy20: 0.3387 - val_accuracy30: 0.3296 - val_accuracy50: 0.3419 - 86s/epoch - 22ms/step
Epoch 15/50
3903/3903 - 90s - loss: 12.8063 - accuracy10: 0.4334 - accuracy20: 0.4199 - accuracy30: 0.4115 - accuracy50: 0.4128 - val_loss: 13.7538 - val_accuracy10: 0.3434 - val_accuracy20: 0.3391 - val_accuracy30: 0.3303 - val_accuracy50: 0.3421 - 90s/epoch - 23ms/step
Epoch 16/50
3903/3903 - 83s - loss: 12.8003 - accuracy10: 0.4343 - accuracy20: 0.4202 - accuracy30: 0.4121 - accuracy50: 0.4133 - val_loss: 13.7438 - val_accuracy10: 0.3442 - val_accuracy20: 0.3396 - val_accuracy30: 0.3307 - val_accuracy50: 0.3422 - 83s/epoch - 21ms/step
Epoch 17/50
3903/3903 - 83s - loss: 12.7961 - accuracy10: 0.4343 - accuracy20: 0.4209 - accuracy30: 0.4128 - accuracy50: 0.4138 - val_loss: 13.7710 - val_accuracy10: 0.3436 - val_accuracy20: 0.3394 - val_accuracy30: 0.3304 - val_accuracy50: 0.3425 - 83s/epoch - 21ms/step
Epoch 18/50
3903/3903 - 82s - loss: 12.7914 - accuracy10: 0.4356 - accuracy20: 0.4220 - accuracy30: 0.4136 - accuracy50: 0.4143 - val_loss: 13.7629 - val_accuracy10: 0.3436 - val_accuracy20: 0.3392 - val_accuracy30: 0.3303 - val_accuracy50: 0.3417 - 82s/epoch - 21ms/step
Epoch 19/50
3903/3903 - 84s - loss: 12.7895 - accuracy10: 0.4355 - accuracy20: 0.4218 - accuracy30: 0.4138 - accuracy50: 0.4142 - val_loss: 13.7422 - val_accuracy10: 0.3453 - val_accuracy20: 0.3401 - val_accuracy30: 0.3314 - val_accuracy50: 0.3426 - 84s/epoch - 22ms/step
Epoch 20/50
3903/3903 - 83s - loss: 12.7840 - accuracy10: 0.4367 - accuracy20: 0.4230 - accuracy30: 0.4145 - accuracy50: 0.4152 - val_loss: 13.7626 - val_accuracy10: 0.3450 - val_accuracy20: 0.3403 - val_accuracy30: 0.3311 - val_accuracy50: 0.3427 - 83s/epoch - 21ms/step
Epoch 21/50
3903/3903 - 84s - loss: 12.7800 - accuracy10: 0.4370 - accuracy20: 0.4234 - accuracy30: 0.4150 - accuracy50: 0.4155 - val_loss: 13.7390 - val_accuracy10: 0.3462 - val_accuracy20: 0.3405 - val_accuracy30: 0.3313 - val_accuracy50: 0.3427 - 84s/epoch - 21ms/step
Epoch 22/50
3903/3903 - 85s - loss: 12.7760 - accuracy10: 0.4374 - accuracy20: 0.4237 - accuracy30: 0.4155 - accuracy50: 0.4159 - val_loss: 13.7554 - val_accuracy10: 0.3458 - val_accuracy20: 0.3404 - val_accuracy30: 0.3315 - val_accuracy50: 0.3428 - 85s/epoch - 22ms/step
Epoch 23/50
3903/3903 - 81s - loss: 12.7716 - accuracy10: 0.4382 - accuracy20: 0.4239 - accuracy30: 0.4160 - accuracy50: 0.4165 - val_loss: 13.7684 - val_accuracy10: 0.3455 - val_accuracy20: 0.3409 - val_accuracy30: 0.3314 - val_accuracy50: 0.3430 - 81s/epoch - 21ms/step
Epoch 24/50
3903/3903 - 80s - loss: 12.7678 - accuracy10: 0.4384 - accuracy20: 0.4247 - accuracy30: 0.4166 - accuracy50: 0.4172 - val_loss: 13.7528 - val_accuracy10: 0.3461 - val_accuracy20: 0.3406 - val_accuracy30: 0.3319 - val_accuracy50: 0.3432 - 80s/epoch - 20ms/step
Epoch 25/50
3903/3903 - 82s - loss: 12.7633 - accuracy10: 0.4393 - accuracy20: 0.4252 - accuracy30: 0.4167 - accuracy50: 0.4175 - val_loss: 13.7605 - val_accuracy10: 0.3464 - val_accuracy20: 0.3410 - val_accuracy30: 0.3320 - val_accuracy50: 0.3432 - 82s/epoch - 21ms/step
Epoch 26/50
3903/3903 - 84s - loss: 12.7598 - accuracy10: 0.4401 - accuracy20: 0.4258 - accuracy30: 0.4174 - accuracy50: 0.4181 - val_loss: 13.7578 - val_accuracy10: 0.3466 - val_accuracy20: 0.3412 - val_accuracy30: 0.3323 - val_accuracy50: 0.3433 - 84s/epoch - 22ms/step
Epoch 27/50
3903/3903 - 83s - loss: 12.7557 - accuracy10: 0.4399 - accuracy20: 0.4262 - accuracy30: 0.4178 - accuracy50: 0.4183 - val_loss: 13.7286 - val_accuracy10: 0.3488 - val_accuracy20: 0.3423 - val_accuracy30: 0.3326 - val_accuracy50: 0.3439 - 83s/epoch - 21ms/step
Epoch 28/50
3903/3903 - 84s - loss: 12.7523 - accuracy10: 0.4410 - accuracy20: 0.4269 - accuracy30: 0.4184 - accuracy50: 0.4187 - val_loss: 13.7238 - val_accuracy10: 0.3476 - val_accuracy20: 0.3411 - val_accuracy30: 0.3317 - val_accuracy50: 0.3433 - 84s/epoch - 22ms/step
Epoch 29/50
3903/3903 - 90s - loss: 12.7467 - accuracy10: 0.4412 - accuracy20: 0.4274 - accuracy30: 0.4188 - accuracy50: 0.4194 - val_loss: 13.7488 - val_accuracy10: 0.3500 - val_accuracy20: 0.3431 - val_accuracy30: 0.3336 - val_accuracy50: 0.3450 - 90s/epoch - 23ms/step
Epoch 30/50
3903/3903 - 89s - loss: 12.7428 - accuracy10: 0.4421 - accuracy20: 0.4281 - accuracy30: 0.4197 - accuracy50: 0.4200 - val_loss: 13.7223 - val_accuracy10: 0.3498 - val_accuracy20: 0.3432 - val_accuracy30: 0.3339 - val_accuracy50: 0.3451 - 89s/epoch - 23ms/step
Epoch 31/50
3903/3903 - 87s - loss: 12.7405 - accuracy10: 0.4421 - accuracy20: 0.4280 - accuracy30: 0.4198 - accuracy50: 0.4201 - val_loss: 13.7261 - val_accuracy10: 0.3501 - val_accuracy20: 0.3432 - val_accuracy30: 0.3336 - val_accuracy50: 0.3449 - 87s/epoch - 22ms/step
Epoch 32/50
3903/3903 - 84s - loss: 12.7350 - accuracy10: 0.4427 - accuracy20: 0.4288 - accuracy30: 0.4205 - accuracy50: 0.4209 - val_loss: 13.7260 - val_accuracy10: 0.3507 - val_accuracy20: 0.3436 - val_accuracy30: 0.3340 - val_accuracy50: 0.3452 - 84s/epoch - 22ms/step
Epoch 33/50
3903/3903 - 83s - loss: 12.7308 - accuracy10: 0.4430 - accuracy20: 0.4291 - accuracy30: 0.4207 - accuracy50: 0.4211 - val_loss: 13.7188 - val_accuracy10: 0.3522 - val_accuracy20: 0.3443 - val_accuracy30: 0.3343 - val_accuracy50: 0.3449 - 83s/epoch - 21ms/step
Epoch 34/50
3903/3903 - 84s - loss: 12.7267 - accuracy10: 0.4433 - accuracy20: 0.4296 - accuracy30: 0.4216 - accuracy50: 0.4217 - val_loss: 13.7623 - val_accuracy10: 0.3511 - val_accuracy20: 0.3435 - val_accuracy30: 0.3340 - val_accuracy50: 0.3448 - 84s/epoch - 21ms/step
Epoch 35/50
3903/3903 - 86s - loss: 12.7235 - accuracy10: 0.4438 - accuracy20: 0.4301 - accuracy30: 0.4221 - accuracy50: 0.4228 - val_loss: 13.7529 - val_accuracy10: 0.3523 - val_accuracy20: 0.3443 - val_accuracy30: 0.3345 - val_accuracy50: 0.3452 - 86s/epoch - 22ms/step
Epoch 36/50
3903/3903 - 86s - loss: 12.7193 - accuracy10: 0.4441 - accuracy20: 0.4307 - accuracy30: 0.4224 - accuracy50: 0.4228 - val_loss: 13.7652 - val_accuracy10: 0.3521 - val_accuracy20: 0.3444 - val_accuracy30: 0.3343 - val_accuracy50: 0.3456 - 86s/epoch - 22ms/step
Epoch 37/50
3903/3903 - 82s - loss: 12.7195 - accuracy10: 0.4438 - accuracy20: 0.4307 - accuracy30: 0.4228 - accuracy50: 0.4232 - val_loss: 13.7609 - val_accuracy10: 0.3525 - val_accuracy20: 0.3448 - val_accuracy30: 0.3352 - val_accuracy50: 0.3455 - 82s/epoch - 21ms/step
Epoch 38/50
3903/3903 - 86s - loss: 12.7134 - accuracy10: 0.4448 - accuracy20: 0.4315 - accuracy30: 0.4237 - accuracy50: 0.4241 - val_loss: 13.7518 - val_accuracy10: 0.3515 - val_accuracy20: 0.3441 - val_accuracy30: 0.3347 - val_accuracy50: 0.3452 - 86s/epoch - 22ms/step
Epoch 39/50
3903/3903 - 85s - loss: 12.7101 - accuracy10: 0.4452 - accuracy20: 0.4321 - accuracy30: 0.4244 - accuracy50: 0.4245 - val_loss: 13.7715 - val_accuracy10: 0.3520 - val_accuracy20: 0.3449 - val_accuracy30: 0.3348 - val_accuracy50: 0.3451 - 85s/epoch - 22ms/step
Epoch 40/50
3903/3903 - 85s - loss: 12.7058 - accuracy10: 0.4455 - accuracy20: 0.4325 - accuracy30: 0.4244 - accuracy50: 0.4251 - val_loss: 13.7509 - val_accuracy10: 0.3536 - val_accuracy20: 0.3457 - val_accuracy30: 0.3355 - val_accuracy50: 0.3458 - 85s/epoch - 22ms/step
Epoch 41/50
3903/3903 - 85s - loss: 12.7030 - accuracy10: 0.4463 - accuracy20: 0.4330 - accuracy30: 0.4251 - accuracy50: 0.4255 - val_loss: 13.7707 - val_accuracy10: 0.3550 - val_accuracy20: 0.3462 - val_accuracy30: 0.3355 - val_accuracy50: 0.3457 - 85s/epoch - 22ms/step
Epoch 42/50
3903/3903 - 89s - loss: 12.6969 - accuracy10: 0.4468 - accuracy20: 0.4338 - accuracy30: 0.4261 - accuracy50: 0.4262 - val_loss: 13.7740 - val_accuracy10: 0.3554 - val_accuracy20: 0.3475 - val_accuracy30: 0.3367 - val_accuracy50: 0.3465 - 89s/epoch - 23ms/step
Epoch 43/50
3903/3903 - 88s - loss: 12.6928 - accuracy10: 0.4470 - accuracy20: 0.4340 - accuracy30: 0.4262 - accuracy50: 0.4271 - val_loss: 13.7725 - val_accuracy10: 0.3548 - val_accuracy20: 0.3472 - val_accuracy30: 0.3362 - val_accuracy50: 0.3462 - 88s/epoch - 23ms/step
testing model: results/AAPL/W8/deepOF_L1/seq2seq
Evaluating performance on  test set...
10609/10609 - 112s - 112s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1386971
{'0': {'precision': 0.5942025869791107, 'recall': 0.09488488121938939, 'f1-score': 0.16363914448528505, 'support': 873880}, '1': {'precision': 0.36152474480332575, 'recall': 0.9334818837267155, 'f1-score': 0.5211970230235774, 'support': 940646}, '2': {'precision': 0.5182563009523551, 'recall': 0.08472386980650301, 'f1-score': 0.1456388833252263, 'support': 901151}, 'accuracy': 0.3819832034516623, 'macro avg': {'precision': 0.49132787757826385, 'recall': 0.3710302115842026, 'f1-score': 0.27682501694469624, 'support': 2715677}, 'weighted avg': {'precision': 0.4884070328205785, 'recall': 0.3819832034516623, 'f1-score': 0.2815156205429614, 'support': 2715677}}
[[ 82918 753996  36966]
 [ 28566 878076  34004]
 [ 28061 796741  76349]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1381066
{'0': {'precision': 0.603410188487984, 'recall': 0.07047890313032308, 'f1-score': 0.126215689647585, 'support': 895275}, '1': {'precision': 0.3369428376964579, 'recall': 0.9320053738843094, 'f1-score': 0.4949493329341275, 'support': 893953}, '2': {'precision': 0.5162418610029124, 'recall': 0.07710732053248479, 'f1-score': 0.13417403406753778, 'support': 926449}, 'accuracy': 0.3563395057659655, 'macro avg': {'precision': 0.4855316290624514, 'recall': 0.3598638658490391, 'f1-score': 0.2517796855497501, 'support': 2715677}, 'weighted avg': {'precision': 0.4859564937104555, 'recall': 0.3563395057659655, 'f1-score': 0.250311282329062, 'support': 2715677}}
[[ 63098 801958  30219]
 [ 24062 833169  36722]
 [ 17409 837604  71436]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.142794
{'0': {'precision': 0.6074063035541316, 'recall': 0.053016540571007395, 'f1-score': 0.09752109946506153, 'support': 922580}, '1': {'precision': 0.3109733776340829, 'recall': 0.9355718545865945, 'f1-score': 0.46679082655008103, 'support': 832633}, '2': {'precision': 0.5212213412010572, 'recall': 0.07063044528477902, 'f1-score': 0.12440308963008061, 'support': 960464}, 'accuracy': 0.3298396679722957, 'macro avg': {'precision': 0.47986700746309063, 'recall': 0.353072946814127, 'f1-score': 0.22957167188174107, 'support': 2715677}, 'weighted avg': {'precision': 0.48603789704294814, 'recall': 0.3298396679722957, 'f1-score': 0.2202475299182546, 'support': 2715677}}
[[ 48912 846372  27296]
 [ 18627 778988  35018]
 [ 12987 879639  67838]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1271836
{'0': {'precision': 0.5647772193106408, 'recall': 0.03522560564055937, 'f1-score': 0.0663150864458894, 'support': 896365}, '1': {'precision': 0.33229469151985347, 'recall': 0.9448881299482699, 'f1-score': 0.4916779405175676, 'support': 897157}, '2': {'precision': 0.48725639940376514, 'recall': 0.05742635457162842, 'f1-score': 0.10274369274676792, 'support': 922155}, 'accuracy': 0.34328235648053873, 'macro avg': {'precision': 0.4614427700780865, 'recall': 0.34584669672015256, 'f1-score': 0.22024557323674165, 'support': 2715677}, 'weighted avg': {'precision': 0.46165024991537607, 'recall': 0.34328235648053873, 'f1-score': 0.2192088523516916, 'support': 2715677}}
[[ 31575 843124  21666]
 [ 15384 847713  34060]
 [  8948 860251  52956]]
Evaluating performance on  train set...
3903/3903 - 37s - 37s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1536272
{'0': {'precision': 0.49679660362794287, 'recall': 0.09591968738170253, 'f1-score': 0.16079387604181242, 'support': 335489}, '1': {'precision': 0.339882927896714, 'recall': 0.9131399981015546, 'f1-score': 0.4953791182824456, 'support': 326583}, '2': {'precision': 0.4997099105117882, 'recall': 0.08434374907267278, 'f1-score': 0.14432717477130722, 'support': 336990}, 'accuracy': 0.3591558882231533, 'macro avg': {'precision': 0.4454631473454817, 'recall': 0.36446781151864327, 'f1-score': 0.2668333896985217, 'support': 999062}, 'weighted avg': {'precision': 0.44648582844627754, 'recall': 0.3591558882231533, 'f1-score': 0.26461199594380563, 'support': 999062}}
[[ 32180 288003  15306]
 [ 15217 298216  13150]
 [ 17378 291189  28423]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1435478
{'0': {'precision': 0.5018219677251432, 'recall': 0.06059735268233984, 'f1-score': 0.10813669324145668, 'support': 334074}, '1': {'precision': 0.3354186173897103, 'recall': 0.9287852859196756, 'f1-score': 0.4928506796088318, 'support': 328991}, '2': {'precision': 0.49396656471278333, 'recall': 0.07017622181150426, 'f1-score': 0.1228933810403642, 'support': 335997}, 'accuracy': 0.3497130308229119, 'macro avg': {'precision': 0.44373571660921224, 'recall': 0.35318628680450653, 'f1-score': 0.24129358463021755, 'support': 999062}, 'weighted avg': {'precision': 0.4443834939606038, 'recall': 0.3497130308229119, 'f1-score': 0.23978582204363175, 'support': 999062}}
[[ 20244 302373  11457]
 [ 10731 305562  12698]
 [  9366 303052  23579]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1378312
{'0': {'precision': 0.4996911673872761, 'recall': 0.04112923725645588, 'f1-score': 0.0760027410281066, 'support': 334385}, '1': {'precision': 0.3320902502004915, 'recall': 0.9410164555651003, 'f1-score': 0.4909288259281743, 'support': 328278}, '2': {'precision': 0.48716273442226254, 'recall': 0.0598456000166469, 'f1-score': 0.10659635077463969, 'support': 336399}, 'accuracy': 0.3431218482936995, 'macro avg': {'precision': 0.43964805067001, 'recall': 0.3473304309460677, 'f1-score': 0.22450930591030685, 'support': 999062}, 'weighted avg': {'precision': 0.4404013072852595, 'recall': 0.3431218482936995, 'f1-score': 0.22264305466624756, 'support': 999062}}
[[ 13753 311092   9540]
 [  7710 308915  11653]
 [  6060 310207  20132]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1416945
{'0': {'precision': 0.4891110118382846, 'recall': 0.025923558207400305, 'f1-score': 0.04923746296931302, 'support': 337878}, '1': {'precision': 0.3245995307462485, 'recall': 0.954659832390621, 'f1-score': 0.4844711597129551, 'support': 322297}, '2': {'precision': 0.47240425659832863, 'recall': 0.04637238961659786, 'f1-score': 0.08445451198834887, 'support': 338887}, 'accuracy': 0.33246985672560864, 'macro avg': {'precision': 0.42870493306095386, 'recall': 0.3423185934048731, 'f1-score': 0.206054378223539, 'support': 999062}, 'weighted avg': {'precision': 0.43037265627624444, 'recall': 0.33246985672560864, 'f1-score': 0.20158948401535384, 'support': 999062}}
[[  8759 321080   8039]
 [  5101 307684   9512]
 [  4048 319124  15715]]
Evaluating performance on  val set...
1144/1144 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1595411
{'0': {'precision': 0.5140940354042169, 'recall': 0.09171184037171506, 'f1-score': 0.15565550614923743, 'support': 99431}, '1': {'precision': 0.3331908527463133, 'recall': 0.9116959064327486, 'f1-score': 0.4880262951948662, 'support': 94050}, '2': {'precision': 0.47943019943019943, 'recall': 0.08485960948846216, 'f1-score': 0.14419632911175473, 'support': 99152}, 'accuracy': 0.35292670341349064, 'macro avg': {'precision': 0.4422383625269099, 'recall': 0.36275578543097525, 'f1-score': 0.2626260434852861, 'support': 292633}, 'weighted avg': {'precision': 0.4442080929661747, 'recall': 0.35292670341349064, 'f1-score': 0.2585942464420988, 'support': 292633}}
[[ 9119 85592  4720]
 [ 3889 85745  4416]
 [ 4730 86008  8414]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1483737
{'0': {'precision': 0.5068989916858305, 'recall': 0.057935119944197894, 'f1-score': 0.10398541192266868, 'support': 98921}, '1': {'precision': 0.3304896435298851, 'recall': 0.9217894670609702, 'f1-score': 0.4865398932269109, 'support': 95358}, '2': {'precision': 0.45949993488735513, 'recall': 0.0717510218191431, 'f1-score': 0.12412058533839876, 'support': 98354}, 'accuracy': 0.3440760269689338, 'macro avg': {'precision': 0.43229619003435693, 'recall': 0.3504918696081037, 'f1-score': 0.2382152968293261, 'support': 292633}, 'weighted avg': {'precision': 0.43348304251464376, 'recall': 0.3440760269689338, 'f1-score': 0.23541284859023742, 'support': 292633}}
[[ 5731 89389  3801]
 [ 2958 87900  4500]
 [ 2617 88680  7057]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1459066
{'0': {'precision': 0.4963704630788486, 'recall': 0.03969731547654796, 'f1-score': 0.07351523689478758, 'support': 99906}, '1': {'precision': 0.3235030387566006, 'recall': 0.9316776127016515, 'f1-score': 0.48025045398893995, 'support': 94098}, '2': {'precision': 0.4509674582233949, 'recall': 0.06238530249723712, 'f1-score': 0.10960783091215162, 'support': 98629}, 'accuracy': 0.3341660031507041, 'macro avg': {'precision': 0.42361365335294804, 'recall': 0.34458674355847885, 'f1-score': 0.22112450726529306, 'support': 292633}, 'weighted avg': {'precision': 0.4254812200346142, 'recall': 0.3341660031507041, 'f1-score': 0.21646817423768516, 'support': 292633}}
[[ 3966 92612  3328]
 [ 2266 87669  4163]
 [ 1758 90718  6153]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1355447
{'0': {'precision': 0.4714422158548233, 'recall': 0.025238528638776115, 'f1-score': 0.047912096445419425, 'support': 97787}, '1': {'precision': 0.33912640649712095, 'recall': 0.9486029560639806, 'f1-score': 0.49963341838026915, 'support': 98780}, '2': {'precision': 0.43449643855378234, 'recall': 0.05016342930901672, 'f1-score': 0.08994279421782991, 'support': 96066}, 'accuracy': 0.3451080363458667, 'macro avg': {'precision': 0.4150216869685755, 'recall': 0.34133497133725776, 'f1-score': 0.21249610301450617, 'support': 292633}, 'weighted avg': {'precision': 0.4146496166245395, 'recall': 0.3451080363458667, 'f1-score': 0.2141912009651723, 'support': 292633}}
[[ 2468 92449  2870]
 [ 1675 93703  3402]
 [ 1092 90155  4819]]
training model: results/AAPL/W8/deepLOB_L2/seq2seq
Epoch 1/50
3903/3903 - 187s - loss: 12.8679 - accuracy10: 0.4185 - accuracy20: 0.4076 - accuracy30: 0.3987 - accuracy50: 0.4016 - val_loss: 14.5632 - val_accuracy10: 0.3419 - val_accuracy20: 0.3397 - val_accuracy30: 0.3317 - val_accuracy50: 0.3412 - 187s/epoch - 48ms/step
Epoch 2/50
3903/3903 - 176s - loss: 12.7644 - accuracy10: 0.4392 - accuracy20: 0.4230 - accuracy30: 0.4105 - accuracy50: 0.4112 - val_loss: 13.8369 - val_accuracy10: 0.3529 - val_accuracy20: 0.3484 - val_accuracy30: 0.3368 - val_accuracy50: 0.3436 - 176s/epoch - 45ms/step
Epoch 3/50
3903/3903 - 176s - loss: 12.6823 - accuracy10: 0.4541 - accuracy20: 0.4334 - accuracy30: 0.4194 - accuracy50: 0.4177 - val_loss: 13.5258 - val_accuracy10: 0.3815 - val_accuracy20: 0.3706 - val_accuracy30: 0.3586 - val_accuracy50: 0.3620 - 176s/epoch - 45ms/step
Epoch 4/50
3903/3903 - 174s - loss: 12.6148 - accuracy10: 0.4626 - accuracy20: 0.4412 - accuracy30: 0.4265 - accuracy50: 0.4240 - val_loss: 13.6321 - val_accuracy10: 0.3687 - val_accuracy20: 0.3583 - val_accuracy30: 0.3476 - val_accuracy50: 0.3549 - 174s/epoch - 44ms/step
Epoch 5/50
3903/3903 - 183s - loss: 12.5688 - accuracy10: 0.4677 - accuracy20: 0.4451 - accuracy30: 0.4301 - accuracy50: 0.4282 - val_loss: 13.3994 - val_accuracy10: 0.3719 - val_accuracy20: 0.3599 - val_accuracy30: 0.3472 - val_accuracy50: 0.3547 - 183s/epoch - 47ms/step
Epoch 6/50
3903/3903 - 178s - loss: 12.5346 - accuracy10: 0.4706 - accuracy20: 0.4471 - accuracy30: 0.4324 - accuracy50: 0.4307 - val_loss: 13.5666 - val_accuracy10: 0.3728 - val_accuracy20: 0.3586 - val_accuracy30: 0.3436 - val_accuracy50: 0.3542 - 178s/epoch - 46ms/step
Epoch 7/50
3903/3903 - 176s - loss: 12.5069 - accuracy10: 0.4735 - accuracy20: 0.4495 - accuracy30: 0.4348 - accuracy50: 0.4329 - val_loss: 13.6151 - val_accuracy10: 0.3706 - val_accuracy20: 0.3551 - val_accuracy30: 0.3420 - val_accuracy50: 0.3519 - 176s/epoch - 45ms/step
Epoch 8/50
3903/3903 - 177s - loss: 12.4870 - accuracy10: 0.4756 - accuracy20: 0.4513 - accuracy30: 0.4361 - accuracy50: 0.4340 - val_loss: 13.5823 - val_accuracy10: 0.3666 - val_accuracy20: 0.3527 - val_accuracy30: 0.3403 - val_accuracy50: 0.3522 - 177s/epoch - 45ms/step
Epoch 9/50
3903/3903 - 184s - loss: 12.4686 - accuracy10: 0.4776 - accuracy20: 0.4527 - accuracy30: 0.4373 - accuracy50: 0.4354 - val_loss: 13.6970 - val_accuracy10: 0.3699 - val_accuracy20: 0.3557 - val_accuracy30: 0.3407 - val_accuracy50: 0.3531 - 184s/epoch - 47ms/step
Epoch 10/50
3903/3903 - 176s - loss: 12.4587 - accuracy10: 0.4789 - accuracy20: 0.4539 - accuracy30: 0.4382 - accuracy50: 0.4360 - val_loss: 13.8172 - val_accuracy10: 0.3932 - val_accuracy20: 0.3677 - val_accuracy30: 0.3471 - val_accuracy50: 0.3513 - 176s/epoch - 45ms/step
Epoch 11/50
3903/3903 - 177s - loss: 12.4423 - accuracy10: 0.4803 - accuracy20: 0.4552 - accuracy30: 0.4396 - accuracy50: 0.4375 - val_loss: 13.7793 - val_accuracy10: 0.3876 - val_accuracy20: 0.3663 - val_accuracy30: 0.3474 - val_accuracy50: 0.3540 - 177s/epoch - 45ms/step
Epoch 12/50
3903/3903 - 178s - loss: 12.4264 - accuracy10: 0.4825 - accuracy20: 0.4567 - accuracy30: 0.4412 - accuracy50: 0.4383 - val_loss: 13.8696 - val_accuracy10: 0.3900 - val_accuracy20: 0.3706 - val_accuracy30: 0.3523 - val_accuracy50: 0.3589 - 178s/epoch - 46ms/step
Epoch 13/50
3903/3903 - 175s - loss: 12.4144 - accuracy10: 0.4835 - accuracy20: 0.4579 - accuracy30: 0.4422 - accuracy50: 0.4391 - val_loss: 13.9989 - val_accuracy10: 0.3902 - val_accuracy20: 0.3707 - val_accuracy30: 0.3536 - val_accuracy50: 0.3607 - 175s/epoch - 45ms/step
Epoch 14/50
3903/3903 - 173s - loss: 12.4031 - accuracy10: 0.4847 - accuracy20: 0.4587 - accuracy30: 0.4434 - accuracy50: 0.4400 - val_loss: 13.8538 - val_accuracy10: 0.3953 - val_accuracy20: 0.3769 - val_accuracy30: 0.3591 - val_accuracy50: 0.3648 - 173s/epoch - 44ms/step
Epoch 15/50
3903/3903 - 175s - loss: 12.3899 - accuracy10: 0.4859 - accuracy20: 0.4600 - accuracy30: 0.4443 - accuracy50: 0.4410 - val_loss: 13.8538 - val_accuracy10: 0.4001 - val_accuracy20: 0.3815 - val_accuracy30: 0.3651 - val_accuracy50: 0.3698 - 175s/epoch - 45ms/step
testing model: results/AAPL/W8/deepLOB_L2/seq2seq
Evaluating performance on  test set...
10609/10609 - 167s - 167s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0895225
{'0': {'precision': 0.47826006461347625, 'recall': 0.17736356011044957, 'f1-score': 0.2587640363149477, 'support': 873883}, '1': {'precision': 0.41838330905429055, 'recall': 0.4549373515647757, 'f1-score': 0.43589532034005, 'support': 940646}, '2': {'precision': 0.38725615899226384, 'recall': 0.5882075518807572, 'f1-score': 0.46703325750113217, 'support': 901153}, 'accuracy': 0.4098399591704773, 'macro avg': {'precision': 0.42796651088667687, 'recall': 0.4068361545186609, 'f1-score': 0.38723087138537665, 'support': 2715682}, 'weighted avg': {'precision': 0.42732211489329613, 'recall': 0.4098399591704773, 'f1-score': 0.38922860001300585, 'support': 2715682}}
[[154995 292584 426304]
 [100309 427935 412402]
 [ 68777 302311 530065]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1017997
{'0': {'precision': 0.4824896358446948, 'recall': 0.12518779062169447, 'f1-score': 0.19879564018198428, 'support': 895279}, '1': {'precision': 0.38523962281481633, 'recall': 0.49731306085100574, 'f1-score': 0.4341603612542334, 'support': 893954}, '2': {'precision': 0.3920123005726777, 'recall': 0.5625015516234568, 'f1-score': 0.462031068109218, 'support': 926449}, 'accuracy': 0.3968734189054536, 'macro avg': {'precision': 0.41991385307739626, 'recall': 0.3950008010320523, 'f1-score': 0.3649956898484786, 'support': 2715682}, 'weighted avg': {'precision': 0.41961052299807394, 'recall': 0.3968734189054536, 'f1-score': 0.36607569463209266, 'support': 2715682}}
[[112078 357336 425865]
 [ 67004 444575 382375]
 [ 53209 352111 521129]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1117337
{'0': {'precision': 0.4856539537296016, 'recall': 0.08525718497482616, 'f1-score': 0.14505055571640113, 'support': 922585}, '1': {'precision': 0.35438870403955297, 'recall': 0.5364932689432199, 'f1-score': 0.42682905271988836, 'support': 832633}, '2': {'precision': 0.40268474020576306, 'recall': 0.5422025187825884, 'f1-score': 0.46214334744790675, 'support': 960464}, 'accuracy': 0.3852163103043729, 'macro avg': {'precision': 0.4142424659916392, 'recall': 0.3879843242335448, 'f1-score': 0.3446743186280654, 'support': 2715682}, 'weighted avg': {'precision': 0.41606380239997826, 'recall': 0.3852163103043729, 'f1-score': 0.3435915801858027, 'support': 2715682}}
[[ 78657 414509 429419]
 [ 42881 446702 343050]
 [ 40423 399275 520766]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1066453
{'0': {'precision': 0.4563607745252354, 'recall': 0.05466387168677186, 'f1-score': 0.0976330476678177, 'support': 896369}, '1': {'precision': 0.3866607365547794, 'recall': 0.593046040942621, 'f1-score': 0.468114795709634, 'support': 897158}, '2': {'precision': 0.39229317893182175, 'recall': 0.5242253200383883, 'f1-score': 0.4487634837823286, 'support': 922155}, 'accuracy': 0.3919722559563307, 'macro avg': {'precision': 0.4117715633372789, 'recall': 0.3906450775559271, 'f1-score': 0.33817044238659344, 'support': 2715682}, 'weighted avg': {'precision': 0.4115793162101813, 'recall': 0.3919722559563307, 'f1-score': 0.33925830107557187, 'support': 2715682}}
[[ 48999 434224 413146]
 [ 29380 532056 335722]
 [ 28990 409748 483417]]
Evaluating performance on  train set...
3903/3903 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1078794
{'0': {'precision': 0.485093258922015, 'recall': 0.15713559367390081, 'f1-score': 0.2373777413450417, 'support': 336321}, '1': {'precision': 0.35567825532032965, 'recall': 0.8266919302038485, 'f1-score': 0.4973676552778535, 'support': 325634}, '2': {'precision': 0.4442585060559216, 'recall': 0.175614343177854, 'f1-score': 0.25172312624636983, 'support': 337108}, 'accuracy': 0.3816055644138558, 'macro avg': {'precision': 0.4283433400994221, 'recall': 0.38648062235186775, 'f1-score': 0.32882284095642167, 'support': 999063}, 'weighted avg': {'precision': 0.4291331771734023, 'recall': 0.3816055644138558, 'f1-score': 0.32695917879885006, 'support': 999063}}
[[ 52848 240011  43462]
 [ 25840 269199  30595]
 [ 30256 247651  59201]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1185039
{'0': {'precision': 0.47131635934957267, 'recall': 0.1100921275538608, 'f1-score': 0.17849144593017474, 'support': 334102}, '1': {'precision': 0.3553909617705935, 'recall': 0.8614568932776301, 'f1-score': 0.5031919028426304, 'support': 329125}, '2': {'precision': 0.43633604635122086, 'recall': 0.16011088745697305, 'f1-score': 0.23426108057830086, 'support': 335836}, 'accuracy': 0.37443084169867163, 'macro avg': {'precision': 0.42101445582379565, 'recall': 0.377219969429488, 'f1-score': 0.305314809783702, 'support': 999063}, 'weighted avg': {'precision': 0.4213679628277357, 'recall': 0.37443084169867163, 'f1-score': 0.30420572911652044, 'support': 999063}}
[[ 36782 255401  41919]
 [ 18055 283527  27543]
 [ 23204 258861  53771]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1259054
{'0': {'precision': 0.46060959360426385, 'recall': 0.08265907874954792, 'f1-score': 0.14016477153218262, 'support': 334567}, '1': {'precision': 0.351376389303184, 'recall': 0.8828100961172295, 'f1-score': 0.5026770713801858, 'support': 328245}, '2': {'precision': 0.43135162557181467, 'recall': 0.14666424783866813, 'f1-score': 0.21890008433574504, 'support': 336251}, 'accuracy': 0.36709296610924436, 'macro avg': {'precision': 0.4144458694930875, 'recall': 0.3707111409018152, 'f1-score': 0.2872473090827045, 'support': 999063}, 'weighted avg': {'precision': 0.41487346469679054, 'recall': 0.36709296610924436, 'f1-score': 0.28576888011103946, 'support': 999063}}
[[ 27655 266590  40322]
 [ 13776 289778  24691]
 [ 18609 268326  49316]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1316581
{'0': {'precision': 0.4554901960784314, 'recall': 0.06181333301796421, 'f1-score': 0.10885434021992667, 'support': 338228}, '1': {'precision': 0.34496322075084296, 'recall': 0.9099743165308993, 'f1-score': 0.5002761678656706, 'support': 321997}, '2': {'precision': 0.43629723140376403, 'recall': 0.1336184253241962, 'f1-score': 0.2045823740592713, 'support': 338838}, 'accuracy': 0.3595278776213312, 'macro avg': {'precision': 0.4122502160776795, 'recall': 0.3684686916243532, 'f1-score': 0.2712376273816229, 'support': 999063}, 'weighted avg': {'precision': 0.4133580580260839, 'recall': 0.3595278776213312, 'f1-score': 0.26747591840518875, 'support': 999063}}
[[ 20907 278206  39115]
 [  9607 293009  19381]
 [ 15386 278177  45275]]
Evaluating performance on  val set...
1144/1144 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1057428
{'0': {'precision': 0.47153225806451615, 'recall': 0.1764439616150643, 'f1-score': 0.25679652158636745, 'support': 99414}, '1': {'precision': 0.34248613189708477, 'recall': 0.8128855234610967, 'f1-score': 0.481926343465678, 'support': 94028}, '2': {'precision': 0.46300257292538516, 'recall': 0.15057817745561594, 'f1-score': 0.2272499049068087, 'support': 99191}, 'accuracy': 0.3721760703680036, 'macro avg': {'precision': 0.425673654295662, 'recall': 0.3799692208439256, 'f1-score': 0.32199092331961804, 'support': 292633}, 'weighted avg': {'precision': 0.42717629974844523, 'recall': 0.3721760703680036, 'f1-score': 0.3191194599993479, 'support': 292633}}
[[17541 72350  9523]
 [ 9794 76434  7800]
 [ 9865 74390 14936]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1187161
{'0': {'precision': 0.45564098772733996, 'recall': 0.12465614886731391, 'f1-score': 0.19575643998348313, 'support': 98880}, '1': {'precision': 0.33984008613981737, 'recall': 0.8463004860063683, 'f1-score': 0.48494560732237973, 'support': 95472}, '2': {'precision': 0.4399525657611039, 'recall': 0.12457138205756962, 'f1-score': 0.19416536488276015, 'support': 98281}, 'accuracy': 0.36006533781220845, 'macro avg': {'precision': 0.41181121320942043, 'recall': 0.3651760056437506, 'f1-score': 0.291622470729541, 'support': 292633}, 'weighted avg': {'precision': 0.41259178454236906, 'recall': 0.36006533781220845, 'f1-score': 0.28957052018703155, 'support': 292633}}
[[12326 78200  8354]
 [ 7443 80798  7231]
 [ 7283 78755 12243]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1295152
{'0': {'precision': 0.4504880773153319, 'recall': 0.09270067157019507, 'f1-score': 0.15376072272181013, 'support': 100064}, '1': {'precision': 0.3310906087587124, 'recall': 0.8746088844426471, 'f1-score': 0.4803432191997008, 'support': 93962}, '2': {'precision': 0.4287092984222894, 'recall': 0.10361333373898404, 'f1-score': 0.16689126830503354, 'support': 98607}, 'accuracy': 0.34744201781753936, 'macro avg': {'precision': 0.4034293281654446, 'recall': 0.35697429658394203, 'f1-score': 0.2669984034088481, 'support': 292633}, 'weighted avg': {'precision': 0.40481187199732843, 'recall': 0.34744201781753936, 'f1-score': 0.26304815183055885, 'support': 292633}}
[[ 9276 83354  7434]
 [ 5601 82180  6181]
 [ 5714 82676 10217]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1253585
{'0': {'precision': 0.4286185512600607, 'recall': 0.06638262220042504, 'f1-score': 0.11496062992125983, 'support': 97872}, '1': {'precision': 0.34606606606606605, 'recall': 0.9063609977876556, 'f1-score': 0.5008847125595534, 'support': 98538}, '2': {'precision': 0.41396907216494844, 'recall': 0.08346237386071938, 'f1-score': 0.13891699748319972, 'support': 96223}, 'accuracy': 0.3548437804348792, 'macro avg': {'precision': 0.3962178964970251, 'recall': 0.3520686646162667, 'f1-score': 0.251587446654671, 'support': 292633}, 'weighted avg': {'precision': 0.3960037278703034, 'recall': 0.3548437804348792, 'f1-score': 0.252789722371273, 'support': 292633}}
[[ 6497 84999  6376]
 [ 4234 89311  4993]
 [ 4427 83765  8031]]
training model: results/AAPL/W8/deepOF_L2/seq2seq
Epoch 1/50
3903/3903 - 116s - loss: 12.7575 - accuracy10: 0.4423 - accuracy20: 0.4229 - accuracy30: 0.4108 - accuracy50: 0.4116 - val_loss: 13.7668 - val_accuracy10: 0.3676 - val_accuracy20: 0.3456 - val_accuracy30: 0.3311 - val_accuracy50: 0.3417 - 116s/epoch - 30ms/step
Epoch 2/50
3903/3903 - 108s - loss: 12.5990 - accuracy10: 0.4673 - accuracy20: 0.4421 - accuracy30: 0.4266 - accuracy50: 0.4231 - val_loss: 13.5626 - val_accuracy10: 0.3939 - val_accuracy20: 0.3600 - val_accuracy30: 0.3396 - val_accuracy50: 0.3443 - 108s/epoch - 28ms/step
Epoch 3/50
3903/3903 - 108s - loss: 12.5099 - accuracy10: 0.4785 - accuracy20: 0.4513 - accuracy30: 0.4351 - accuracy50: 0.4312 - val_loss: 13.5233 - val_accuracy10: 0.4015 - val_accuracy20: 0.3669 - val_accuracy30: 0.3439 - val_accuracy50: 0.3467 - 108s/epoch - 28ms/step
Epoch 4/50
3903/3903 - 105s - loss: 12.4560 - accuracy10: 0.4843 - accuracy20: 0.4558 - accuracy30: 0.4391 - accuracy50: 0.4350 - val_loss: 13.6099 - val_accuracy10: 0.4063 - val_accuracy20: 0.3696 - val_accuracy30: 0.3446 - val_accuracy50: 0.3464 - 105s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 111s - loss: 12.4224 - accuracy10: 0.4875 - accuracy20: 0.4589 - accuracy30: 0.4418 - accuracy50: 0.4378 - val_loss: 13.5998 - val_accuracy10: 0.4119 - val_accuracy20: 0.3736 - val_accuracy30: 0.3469 - val_accuracy50: 0.3472 - 111s/epoch - 29ms/step
Epoch 6/50
3903/3903 - 104s - loss: 12.3974 - accuracy10: 0.4906 - accuracy20: 0.4608 - accuracy30: 0.4435 - accuracy50: 0.4396 - val_loss: 13.5720 - val_accuracy10: 0.4135 - val_accuracy20: 0.3747 - val_accuracy30: 0.3462 - val_accuracy50: 0.3460 - 104s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 109s - loss: 12.3781 - accuracy10: 0.4920 - accuracy20: 0.4623 - accuracy30: 0.4447 - accuracy50: 0.4406 - val_loss: 13.5806 - val_accuracy10: 0.4180 - val_accuracy20: 0.3777 - val_accuracy30: 0.3499 - val_accuracy50: 0.3479 - 109s/epoch - 28ms/step
Epoch 8/50
3903/3903 - 108s - loss: 12.3624 - accuracy10: 0.4939 - accuracy20: 0.4637 - accuracy30: 0.4461 - accuracy50: 0.4418 - val_loss: 13.5336 - val_accuracy10: 0.4211 - val_accuracy20: 0.3815 - val_accuracy30: 0.3527 - val_accuracy50: 0.3493 - 108s/epoch - 28ms/step
Epoch 9/50
3903/3903 - 105s - loss: 12.3474 - accuracy10: 0.4949 - accuracy20: 0.4653 - accuracy30: 0.4472 - accuracy50: 0.4427 - val_loss: 13.5193 - val_accuracy10: 0.4247 - val_accuracy20: 0.3849 - val_accuracy30: 0.3544 - val_accuracy50: 0.3501 - 105s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 107s - loss: 12.3347 - accuracy10: 0.4958 - accuracy20: 0.4666 - accuracy30: 0.4485 - accuracy50: 0.4435 - val_loss: 13.4884 - val_accuracy10: 0.4252 - val_accuracy20: 0.3851 - val_accuracy30: 0.3564 - val_accuracy50: 0.3515 - 107s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 117s - loss: 12.3218 - accuracy10: 0.4965 - accuracy20: 0.4669 - accuracy30: 0.4491 - accuracy50: 0.4448 - val_loss: 13.4956 - val_accuracy10: 0.4272 - val_accuracy20: 0.3877 - val_accuracy30: 0.3585 - val_accuracy50: 0.3535 - 117s/epoch - 30ms/step
Epoch 12/50
3903/3903 - 119s - loss: 12.3118 - accuracy10: 0.4979 - accuracy20: 0.4680 - accuracy30: 0.4503 - accuracy50: 0.4458 - val_loss: 13.4649 - val_accuracy10: 0.4274 - val_accuracy20: 0.3878 - val_accuracy30: 0.3588 - val_accuracy50: 0.3541 - 119s/epoch - 31ms/step
Epoch 13/50
3903/3903 - 106s - loss: 12.3014 - accuracy10: 0.4987 - accuracy20: 0.4692 - accuracy30: 0.4510 - accuracy50: 0.4463 - val_loss: 13.4546 - val_accuracy10: 0.4293 - val_accuracy20: 0.3913 - val_accuracy30: 0.3626 - val_accuracy50: 0.3560 - 106s/epoch - 27ms/step
Epoch 14/50
3903/3903 - 112s - loss: 12.2908 - accuracy10: 0.4998 - accuracy20: 0.4700 - accuracy30: 0.4520 - accuracy50: 0.4472 - val_loss: 13.3704 - val_accuracy10: 0.4327 - val_accuracy20: 0.3944 - val_accuracy30: 0.3650 - val_accuracy50: 0.3579 - 112s/epoch - 29ms/step
Epoch 15/50
3903/3903 - 108s - loss: 12.2812 - accuracy10: 0.5005 - accuracy20: 0.4711 - accuracy30: 0.4534 - accuracy50: 0.4484 - val_loss: 13.4075 - val_accuracy10: 0.4315 - val_accuracy20: 0.3933 - val_accuracy30: 0.3652 - val_accuracy50: 0.3599 - 108s/epoch - 28ms/step
Epoch 16/50
3903/3903 - 105s - loss: 12.2725 - accuracy10: 0.5010 - accuracy20: 0.4721 - accuracy30: 0.4542 - accuracy50: 0.4490 - val_loss: 13.3737 - val_accuracy10: 0.4345 - val_accuracy20: 0.3971 - val_accuracy30: 0.3705 - val_accuracy50: 0.3641 - 105s/epoch - 27ms/step
Epoch 17/50
3903/3903 - 105s - loss: 12.2623 - accuracy10: 0.5014 - accuracy20: 0.4725 - accuracy30: 0.4550 - accuracy50: 0.4500 - val_loss: 13.3608 - val_accuracy10: 0.4349 - val_accuracy20: 0.3960 - val_accuracy30: 0.3691 - val_accuracy50: 0.3631 - 105s/epoch - 27ms/step
Epoch 18/50
3903/3903 - 104s - loss: 12.2546 - accuracy10: 0.5023 - accuracy20: 0.4728 - accuracy30: 0.4560 - accuracy50: 0.4504 - val_loss: 13.4538 - val_accuracy10: 0.4357 - val_accuracy20: 0.3984 - val_accuracy30: 0.3723 - val_accuracy50: 0.3652 - 104s/epoch - 27ms/step
Epoch 19/50
3903/3903 - 107s - loss: 12.2451 - accuracy10: 0.5033 - accuracy20: 0.4744 - accuracy30: 0.4568 - accuracy50: 0.4518 - val_loss: 13.4702 - val_accuracy10: 0.4349 - val_accuracy20: 0.3990 - val_accuracy30: 0.3736 - val_accuracy50: 0.3670 - 107s/epoch - 27ms/step
Epoch 20/50
3903/3903 - 103s - loss: 12.2368 - accuracy10: 0.5035 - accuracy20: 0.4748 - accuracy30: 0.4578 - accuracy50: 0.4524 - val_loss: 13.4192 - val_accuracy10: 0.4354 - val_accuracy20: 0.3998 - val_accuracy30: 0.3743 - val_accuracy50: 0.3681 - 103s/epoch - 26ms/step
Epoch 21/50
3903/3903 - 106s - loss: 12.2311 - accuracy10: 0.5041 - accuracy20: 0.4750 - accuracy30: 0.4581 - accuracy50: 0.4531 - val_loss: 13.4242 - val_accuracy10: 0.4351 - val_accuracy20: 0.3984 - val_accuracy30: 0.3719 - val_accuracy50: 0.3659 - 106s/epoch - 27ms/step
Epoch 22/50
3903/3903 - 108s - loss: 12.2224 - accuracy10: 0.5045 - accuracy20: 0.4762 - accuracy30: 0.4589 - accuracy50: 0.4539 - val_loss: 13.4365 - val_accuracy10: 0.4351 - val_accuracy20: 0.3994 - val_accuracy30: 0.3737 - val_accuracy50: 0.3677 - 108s/epoch - 28ms/step
Epoch 23/50
3903/3903 - 112s - loss: 12.2149 - accuracy10: 0.5049 - accuracy20: 0.4766 - accuracy30: 0.4598 - accuracy50: 0.4547 - val_loss: 13.4649 - val_accuracy10: 0.4372 - val_accuracy20: 0.4029 - val_accuracy30: 0.3781 - val_accuracy50: 0.3721 - 112s/epoch - 29ms/step
Epoch 24/50
3903/3903 - 104s - loss: 12.2082 - accuracy10: 0.5053 - accuracy20: 0.4774 - accuracy30: 0.4606 - accuracy50: 0.4559 - val_loss: 13.4439 - val_accuracy10: 0.4352 - val_accuracy20: 0.3994 - val_accuracy30: 0.3729 - val_accuracy50: 0.3676 - 104s/epoch - 27ms/step
Epoch 25/50
3903/3903 - 110s - loss: 12.2010 - accuracy10: 0.5058 - accuracy20: 0.4777 - accuracy30: 0.4614 - accuracy50: 0.4565 - val_loss: 13.5274 - val_accuracy10: 0.4346 - val_accuracy20: 0.4004 - val_accuracy30: 0.3759 - val_accuracy50: 0.3689 - 110s/epoch - 28ms/step
Epoch 26/50
3903/3903 - 105s - loss: 12.1939 - accuracy10: 0.5062 - accuracy20: 0.4784 - accuracy30: 0.4619 - accuracy50: 0.4578 - val_loss: 13.4482 - val_accuracy10: 0.4383 - val_accuracy20: 0.4041 - val_accuracy30: 0.3791 - val_accuracy50: 0.3739 - 105s/epoch - 27ms/step
Epoch 27/50
3903/3903 - 112s - loss: 12.1863 - accuracy10: 0.5064 - accuracy20: 0.4787 - accuracy30: 0.4628 - accuracy50: 0.4580 - val_loss: 13.4551 - val_accuracy10: 0.4370 - val_accuracy20: 0.4030 - val_accuracy30: 0.3770 - val_accuracy50: 0.3700 - 112s/epoch - 29ms/step
testing model: results/AAPL/W8/deepOF_L2/seq2seq
Evaluating performance on  test set...
10609/10609 - 97s - 97s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1152207
{'0': {'precision': 0.4746812466309502, 'recall': 0.29625806746921773, 'f1-score': 0.36482287572765465, 'support': 873880}, '1': {'precision': 0.4031394050809034, 'recall': 0.7478860272621156, 'f1-score': 0.5238847372556029, 'support': 940646}, '2': {'precision': 0.47125182549555883, 'recall': 0.22237005784824074, 'f1-score': 0.30215971615934517, 'support': 901151}, 'accuracy': 0.42817279079949494, 'macro avg': {'precision': 0.44969082573580416, 'recall': 0.4221713841931914, 'f1-score': 0.3969557763808676, 'support': 2715677}, 'weighted avg': {'precision': 0.44876285745128547, 'recall': 0.42817279079949494, 'f1-score': 0.3991244273815063, 'support': 2715677}}
[[258894 488579 126407]
 [138719 703496  98431]
 [147793 552969 200389]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1516958
{'0': {'precision': 0.46790562989179474, 'recall': 0.22416352517382926, 'f1-score': 0.3031124120400368, 'support': 895275}, '1': {'precision': 0.354672573264824, 'recall': 0.7915315458418954, 'f1-score': 0.4898508485605796, 'support': 893953}, '2': {'precision': 0.45545793296836273, 'recall': 0.14341102424418398, 'f1-score': 0.21813683237533268, 'support': 926449}, 'accuracy': 0.3833824862087796, 'macro avg': {'precision': 0.4260120453749938, 'recall': 0.3863686984199695, 'f1-score': 0.33703336432531633, 'support': 2715677}, 'weighted avg': {'precision': 0.42638479105939053, 'recall': 0.3833824862087796, 'f1-score': 0.3355941264479223, 'support': 2715677}}
[[200688 607851  86736]
 [114247 707592  72114]
 [113972 679614 132863]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.179232
{'0': {'precision': 0.4887925324944118, 'recall': 0.15358993258037243, 'f1-score': 0.23373493578429594, 'support': 922580}, '1': {'precision': 0.31969245071938684, 'recall': 0.8631642031963662, 'f1-score': 0.46657738041138325, 'support': 832633}, '2': {'precision': 0.4569127562103936, 'recall': 0.08452893601425977, 'f1-score': 0.1426648508544568, 'support': 960464}, 'accuracy': 0.34672201443691575, 'macro avg': {'precision': 0.4217992464747307, 'recall': 0.3670943572636662, 'f1-score': 0.28099238901671203, 'support': 2715677}, 'weighted avg': {'precision': 0.42567100300565536, 'recall': 0.34672201443691575, 'f1-score': 0.2729158711993444, 'support': 2715677}}
[[141699 725881  55000]
 [ 72435 718699  41499]
 [ 75762 803515  81187]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1723427
{'0': {'precision': 0.4875041825796998, 'recall': 0.09427298031493866, 'f1-score': 0.15799338694946166, 'support': 896365}, '1': {'precision': 0.33954177922984446, 'recall': 0.9233545522132692, 'f1-score': 0.4965054370855807, 'support': 897157}, '2': {'precision': 0.4357589816565625, 'recall': 0.04848208815220868, 'f1-score': 0.08725614855482247, 'support': 922155}, 'accuracy': 0.3526210959550786, 'macro avg': {'precision': 0.4209349811553689, 'recall': 0.3553698735601389, 'f1-score': 0.24725165752995493, 'support': 2715677}, 'weighted avg': {'precision': 0.4210520228937645, 'recall': 0.3526210959550786, 'f1-score': 0.24580491876718583, 'support': 2715677}}
[[ 84503 778506  33356]
 [ 44229 828394  24534]
 [ 44606 832841  44708]]
Evaluating performance on  train set...
3903/3903 - 37s - 37s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0592921
{'0': {'precision': 0.5165996073629172, 'recall': 0.3168807323041888, 'f1-score': 0.3928118135446361, 'support': 335489}, '1': {'precision': 0.40711332855688115, 'recall': 0.7185799628272139, 'f1-score': 0.5197569937388015, 'support': 326583}, '2': {'precision': 0.512016049069569, 'recall': 0.3294548799667646, 'f1-score': 0.40093170225251656, 'support': 336990}, 'accuracy': 0.452433382512797, 'macro avg': {'precision': 0.4785763283297892, 'recall': 0.45497185836605575, 'f1-score': 0.4378335031786514, 'support': 999062}, 'weighted avg': {'precision': 0.4792636155019646, 'recall': 0.452433382512797, 'f1-score': 0.4370477659470093, 'support': 999062}}
[[106310 170243  58936]
 [ 45031 234676  46876]
 [ 54447 171520 111023]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0865057
{'0': {'precision': 0.49630775224456786, 'recall': 0.2516777719906368, 'f1-score': 0.33398942963317524, 'support': 334074}, '1': {'precision': 0.37272050443030996, 'recall': 0.739543027012897, 'f1-score': 0.49564305991136387, 'support': 328991}, '2': {'precision': 0.49207076103733105, 'recall': 0.2590380271252422, 'f1-score': 0.33940500005849394, 'support': 335997}, 'accuracy': 0.41480708904952845, 'macro avg': {'precision': 0.4536996725707363, 'recall': 0.4167529420429253, 'f1-score': 0.38967916320101104, 'support': 999062}, 'weighted avg': {'precision': 0.4541855330226192, 'recall': 0.41480708904952845, 'f1-score': 0.3890432750352097, 'support': 999062}}
[[ 84079 203803  46192]
 [ 42039 243303  43649]
 [ 43291 205670  87036]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1025517
{'0': {'precision': 0.4936842277273024, 'recall': 0.18069889498631816, 'f1-score': 0.2645623575617862, 'support': 334385}, '1': {'precision': 0.3536057615107105, 'recall': 0.8049610391192831, 'f1-score': 0.49136374539551614, 'support': 328278}, '2': {'precision': 0.48579997835598226, 'recall': 0.18681981813263415, 'f1-score': 0.2698614107972904, 'support': 336399}, 'accuracy': 0.387883835037265, 'macro avg': {'precision': 0.4443633225313317, 'recall': 0.3908265840794118, 'f1-score': 0.34192917125153094, 'support': 999062}, 'weighted avg': {'precision': 0.44500163111476676, 'recall': 0.387883835037265, 'f1-score': 0.34087043674471135, 'support': 999062}}
[[ 60423 240389  33573]
 [ 31080 264251  32947]
 [ 30889 242664  62846]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1220702
{'0': {'precision': 0.4884922264958861, 'recall': 0.11614843227437122, 'f1-score': 0.1876738041438016, 'support': 337878}, '1': {'precision': 0.3399539969652448, 'recall': 0.8758722544733584, 'f1-score': 0.4898006987213243, 'support': 322297}, '2': {'precision': 0.47951779953591034, 'recall': 0.12500627052675375, 'f1-score': 0.19831379671934687, 'support': 338887}, 'accuracy': 0.36423965679807657, 'macro avg': {'precision': 0.4359880076656804, 'recall': 0.37234231909149446, 'f1-score': 0.2919294331948243, 'support': 999062}, 'weighted avg': {'precision': 0.43752968123621006, 'recall': 0.36423965679807657, 'f1-score': 0.2887489595451687, 'support': 999062}}
[[ 39244 273739  24895]
 [ 18919 282291  21087]
 [ 22174 274350  42363]]
Evaluating performance on  val set...
1144/1144 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0880722
{'0': {'precision': 0.5033349399088917, 'recall': 0.32559262201928973, 'f1-score': 0.3954076335877863, 'support': 99431}, '1': {'precision': 0.3873137062556878, 'recall': 0.6968846358320042, 'f1-score': 0.49790330912516334, 'support': 94050}, '2': {'precision': 0.49710620727001964, 'recall': 0.2962623043408101, 'f1-score': 0.37126210156467226, 'support': 99152}, 'accuracy': 0.4349851178780247, 'macro avg': {'precision': 0.46258495114486636, 'recall': 0.4395798540640347, 'f1-score': 0.42152434809254063, 'support': 292633}, 'weighted avg': {'precision': 0.46393614235805747, 'recall': 0.4349851178780247, 'f1-score': 0.4201677956103009, 'support': 292633}}
[[32374 50856 16201]
 [14992 65542 13516]
 [16953 52824 29375]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1129595
{'0': {'precision': 0.48381494064205827, 'recall': 0.25625499135673924, 'f1-score': 0.33504940025774044, 'support': 98921}, '1': {'precision': 0.3563096935687393, 'recall': 0.7284548753119822, 'f1-score': 0.4785472181652843, 'support': 95358}, '2': {'precision': 0.4716351992933642, 'recall': 0.2171543607784127, 'f1-score': 0.2973844150961786, 'support': 98354}, 'accuracy': 0.3969853024095027, 'macro avg': {'precision': 0.4372532778347206, 'recall': 0.4006214091490447, 'f1-score': 0.3703270111730678, 'support': 292633}, 'weighted avg': {'precision': 0.43817220167882787, 'recall': 0.3969853024095027, 'f1-score': 0.3691506908485054, 'support': 292633}}
[[25349 61676 11896]
 [13863 69464 12031]
 [13182 63814 21358]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1298853
{'0': {'precision': 0.4851626454114606, 'recall': 0.18033951914799912, 'f1-score': 0.2629412880722698, 'support': 99906}, '1': {'precision': 0.33700858200982836, 'recall': 0.8045973346936173, 'f1-score': 0.4750434504351318, 'support': 94098}, '2': {'precision': 0.4651924386368795, 'recall': 0.14546431576919566, 'f1-score': 0.22162663165212018, 'support': 98629}, 'accuracy': 0.36931924970867946, 'macro avg': {'precision': 0.42912122201938946, 'recall': 0.3768003898702707, 'f1-score': 0.3198704567198406, 'support': 292633}, 'weighted avg': {'precision': 0.430792008532035, 'recall': 0.36931924970867946, 'f1-score': 0.317219397601809, 'support': 292633}}
[[18017 73900  7989]
 [ 9882 75711  8505]
 [ 9237 75045 14347]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1366128
{'0': {'precision': 0.46534026105690024, 'recall': 0.11265301113644963, 'f1-score': 0.181393051210275, 'support': 97787}, '1': {'precision': 0.3472126302940751, 'recall': 0.8754201255314841, 'f1-score': 0.4972170473101957, 'support': 98780}, '2': {'precision': 0.44062688366485836, 'recall': 0.09131222284679283, 'f1-score': 0.15127528583992964, 'support': 96066}, 'accuracy': 0.3631237761974897, 'macro avg': {'precision': 0.4177265916719446, 'recall': 0.35979511983824214, 'f1-score': 0.2766284614534668, 'support': 292633}, 'weighted avg': {'precision': 0.41735263601360106, 'recall': 0.3631237761974897, 'f1-score': 0.27811420393974357, 'support': 292633}}
[[11016 81347  5424]
 [ 6594 86474  5712]
 [ 6063 81231  8772]]
training model: results/AAPL/W8/deepVOL_L2/seq2seq
Epoch 1/50
3903/3903 - 110s - loss: 12.8745 - accuracy10: 0.4196 - accuracy20: 0.4089 - accuracy30: 0.4007 - accuracy50: 0.4039 - val_loss: 13.6567 - val_accuracy10: 0.3264 - val_accuracy20: 0.3289 - val_accuracy30: 0.3227 - val_accuracy50: 0.3374 - 110s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 102s - loss: 12.7496 - accuracy10: 0.4442 - accuracy20: 0.4258 - accuracy30: 0.4134 - accuracy50: 0.4124 - val_loss: 13.4148 - val_accuracy10: 0.3705 - val_accuracy20: 0.3558 - val_accuracy30: 0.3397 - val_accuracy50: 0.3452 - 102s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 103s - loss: 12.6739 - accuracy10: 0.4578 - accuracy20: 0.4352 - accuracy30: 0.4202 - accuracy50: 0.4172 - val_loss: 13.2946 - val_accuracy10: 0.3876 - val_accuracy20: 0.3703 - val_accuracy30: 0.3518 - val_accuracy50: 0.3525 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 103s - loss: 12.6223 - accuracy10: 0.4652 - accuracy20: 0.4407 - accuracy30: 0.4251 - accuracy50: 0.4215 - val_loss: 13.2402 - val_accuracy10: 0.3981 - val_accuracy20: 0.3750 - val_accuracy30: 0.3554 - val_accuracy50: 0.3554 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 104s - loss: 12.5754 - accuracy10: 0.4707 - accuracy20: 0.4458 - accuracy30: 0.4297 - accuracy50: 0.4261 - val_loss: 13.2141 - val_accuracy10: 0.4063 - val_accuracy20: 0.3759 - val_accuracy30: 0.3534 - val_accuracy50: 0.3530 - 104s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 102s - loss: 12.5360 - accuracy10: 0.4748 - accuracy20: 0.4494 - accuracy30: 0.4337 - accuracy50: 0.4298 - val_loss: 13.2161 - val_accuracy10: 0.4179 - val_accuracy20: 0.3813 - val_accuracy30: 0.3542 - val_accuracy50: 0.3527 - 102s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 101s - loss: 12.5085 - accuracy10: 0.4779 - accuracy20: 0.4516 - accuracy30: 0.4355 - accuracy50: 0.4322 - val_loss: 13.1777 - val_accuracy10: 0.4249 - val_accuracy20: 0.3822 - val_accuracy30: 0.3542 - val_accuracy50: 0.3530 - 101s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 103s - loss: 12.4862 - accuracy10: 0.4799 - accuracy20: 0.4537 - accuracy30: 0.4374 - accuracy50: 0.4340 - val_loss: 13.1971 - val_accuracy10: 0.4253 - val_accuracy20: 0.3825 - val_accuracy30: 0.3540 - val_accuracy50: 0.3528 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 101s - loss: 12.4662 - accuracy10: 0.4815 - accuracy20: 0.4547 - accuracy30: 0.4388 - accuracy50: 0.4355 - val_loss: 13.1701 - val_accuracy10: 0.4342 - val_accuracy20: 0.3900 - val_accuracy30: 0.3586 - val_accuracy50: 0.3547 - 101s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 101s - loss: 12.4498 - accuracy10: 0.4830 - accuracy20: 0.4564 - accuracy30: 0.4399 - accuracy50: 0.4367 - val_loss: 13.1933 - val_accuracy10: 0.4313 - val_accuracy20: 0.3858 - val_accuracy30: 0.3553 - val_accuracy50: 0.3527 - 101s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 102s - loss: 12.4355 - accuracy10: 0.4843 - accuracy20: 0.4572 - accuracy30: 0.4412 - accuracy50: 0.4380 - val_loss: 13.2029 - val_accuracy10: 0.4304 - val_accuracy20: 0.3855 - val_accuracy30: 0.3562 - val_accuracy50: 0.3537 - 102s/epoch - 26ms/step
Epoch 12/50
3903/3903 - 101s - loss: 12.4222 - accuracy10: 0.4857 - accuracy20: 0.4590 - accuracy30: 0.4424 - accuracy50: 0.4390 - val_loss: 13.1925 - val_accuracy10: 0.4343 - val_accuracy20: 0.3894 - val_accuracy30: 0.3602 - val_accuracy50: 0.3559 - 101s/epoch - 26ms/step
Epoch 13/50
3903/3903 - 104s - loss: 12.4105 - accuracy10: 0.4865 - accuracy20: 0.4595 - accuracy30: 0.4431 - accuracy50: 0.4400 - val_loss: 13.1572 - val_accuracy10: 0.4381 - val_accuracy20: 0.3906 - val_accuracy30: 0.3584 - val_accuracy50: 0.3544 - 104s/epoch - 27ms/step
Epoch 14/50
3903/3903 - 100s - loss: 12.3973 - accuracy10: 0.4878 - accuracy20: 0.4608 - accuracy30: 0.4443 - accuracy50: 0.4413 - val_loss: 13.1712 - val_accuracy10: 0.4363 - val_accuracy20: 0.3897 - val_accuracy30: 0.3580 - val_accuracy50: 0.3543 - 100s/epoch - 26ms/step
Epoch 15/50
3903/3903 - 102s - loss: 12.3862 - accuracy10: 0.4885 - accuracy20: 0.4621 - accuracy30: 0.4452 - accuracy50: 0.4420 - val_loss: 13.1399 - val_accuracy10: 0.4407 - val_accuracy20: 0.3923 - val_accuracy30: 0.3609 - val_accuracy50: 0.3565 - 102s/epoch - 26ms/step
Epoch 16/50
3903/3903 - 102s - loss: 12.3766 - accuracy10: 0.4895 - accuracy20: 0.4629 - accuracy30: 0.4460 - accuracy50: 0.4431 - val_loss: 13.1390 - val_accuracy10: 0.4412 - val_accuracy20: 0.3944 - val_accuracy30: 0.3636 - val_accuracy50: 0.3588 - 102s/epoch - 26ms/step
Epoch 17/50
3903/3903 - 102s - loss: 12.3658 - accuracy10: 0.4906 - accuracy20: 0.4636 - accuracy30: 0.4473 - accuracy50: 0.4440 - val_loss: 13.1459 - val_accuracy10: 0.4425 - val_accuracy20: 0.3955 - val_accuracy30: 0.3640 - val_accuracy50: 0.3597 - 102s/epoch - 26ms/step
Epoch 18/50
3903/3903 - 101s - loss: 12.3571 - accuracy10: 0.4916 - accuracy20: 0.4647 - accuracy30: 0.4479 - accuracy50: 0.4449 - val_loss: 13.0786 - val_accuracy10: 0.4471 - val_accuracy20: 0.4016 - val_accuracy30: 0.3690 - val_accuracy50: 0.3628 - 101s/epoch - 26ms/step
Epoch 19/50
3903/3903 - 104s - loss: 12.3475 - accuracy10: 0.4920 - accuracy20: 0.4652 - accuracy30: 0.4485 - accuracy50: 0.4455 - val_loss: 13.0851 - val_accuracy10: 0.4481 - val_accuracy20: 0.4019 - val_accuracy30: 0.3689 - val_accuracy50: 0.3632 - 104s/epoch - 27ms/step
Epoch 20/50
3903/3903 - 103s - loss: 12.3387 - accuracy10: 0.4928 - accuracy20: 0.4664 - accuracy30: 0.4496 - accuracy50: 0.4467 - val_loss: 13.1507 - val_accuracy10: 0.4457 - val_accuracy20: 0.3983 - val_accuracy30: 0.3637 - val_accuracy50: 0.3575 - 103s/epoch - 26ms/step
Epoch 21/50
3903/3903 - 102s - loss: 12.3313 - accuracy10: 0.4937 - accuracy20: 0.4668 - accuracy30: 0.4505 - accuracy50: 0.4479 - val_loss: 13.0564 - val_accuracy10: 0.4494 - val_accuracy20: 0.4044 - val_accuracy30: 0.3722 - val_accuracy50: 0.3652 - 102s/epoch - 26ms/step
Epoch 22/50
3903/3903 - 107s - loss: 12.3232 - accuracy10: 0.4943 - accuracy20: 0.4675 - accuracy30: 0.4512 - accuracy50: 0.4484 - val_loss: 13.0045 - val_accuracy10: 0.4532 - val_accuracy20: 0.4090 - val_accuracy30: 0.3778 - val_accuracy50: 0.3712 - 107s/epoch - 27ms/step
Epoch 23/50
3903/3903 - 103s - loss: 12.3155 - accuracy10: 0.4949 - accuracy20: 0.4683 - accuracy30: 0.4519 - accuracy50: 0.4490 - val_loss: 13.0448 - val_accuracy10: 0.4519 - val_accuracy20: 0.4068 - val_accuracy30: 0.3763 - val_accuracy50: 0.3694 - 103s/epoch - 26ms/step
Epoch 24/50
3903/3903 - 102s - loss: 12.3062 - accuracy10: 0.4956 - accuracy20: 0.4689 - accuracy30: 0.4531 - accuracy50: 0.4501 - val_loss: 13.0102 - val_accuracy10: 0.4533 - val_accuracy20: 0.4102 - val_accuracy30: 0.3775 - val_accuracy50: 0.3712 - 102s/epoch - 26ms/step
Epoch 25/50
3903/3903 - 100s - loss: 12.2977 - accuracy10: 0.4963 - accuracy20: 0.4698 - accuracy30: 0.4539 - accuracy50: 0.4509 - val_loss: 13.0057 - val_accuracy10: 0.4542 - val_accuracy20: 0.4100 - val_accuracy30: 0.3784 - val_accuracy50: 0.3721 - 100s/epoch - 25ms/step
Epoch 26/50
3903/3903 - 99s - loss: 12.2914 - accuracy10: 0.4968 - accuracy20: 0.4701 - accuracy30: 0.4541 - accuracy50: 0.4518 - val_loss: 13.0064 - val_accuracy10: 0.4530 - val_accuracy20: 0.4095 - val_accuracy30: 0.3784 - val_accuracy50: 0.3726 - 99s/epoch - 25ms/step
Epoch 27/50
3903/3903 - 104s - loss: 12.2835 - accuracy10: 0.4970 - accuracy20: 0.4709 - accuracy30: 0.4554 - accuracy50: 0.4525 - val_loss: 12.9819 - val_accuracy10: 0.4545 - val_accuracy20: 0.4133 - val_accuracy30: 0.3817 - val_accuracy50: 0.3758 - 104s/epoch - 27ms/step
Epoch 28/50
3903/3903 - 101s - loss: 12.2760 - accuracy10: 0.4979 - accuracy20: 0.4718 - accuracy30: 0.4560 - accuracy50: 0.4533 - val_loss: 13.0137 - val_accuracy10: 0.4526 - val_accuracy20: 0.4108 - val_accuracy30: 0.3781 - val_accuracy50: 0.3720 - 101s/epoch - 26ms/step
Epoch 29/50
3903/3903 - 101s - loss: 12.2684 - accuracy10: 0.4985 - accuracy20: 0.4720 - accuracy30: 0.4569 - accuracy50: 0.4540 - val_loss: 12.9814 - val_accuracy10: 0.4552 - val_accuracy20: 0.4138 - val_accuracy30: 0.3823 - val_accuracy50: 0.3750 - 101s/epoch - 26ms/step
Epoch 30/50
3903/3903 - 101s - loss: 12.2622 - accuracy10: 0.4984 - accuracy20: 0.4727 - accuracy30: 0.4572 - accuracy50: 0.4546 - val_loss: 13.0132 - val_accuracy10: 0.4533 - val_accuracy20: 0.4128 - val_accuracy30: 0.3803 - val_accuracy50: 0.3737 - 101s/epoch - 26ms/step
Epoch 31/50
3903/3903 - 100s - loss: 12.2527 - accuracy10: 0.4993 - accuracy20: 0.4732 - accuracy30: 0.4580 - accuracy50: 0.4556 - val_loss: 13.0422 - val_accuracy10: 0.4497 - val_accuracy20: 0.4098 - val_accuracy30: 0.3795 - val_accuracy50: 0.3731 - 100s/epoch - 26ms/step
Epoch 32/50
3903/3903 - 100s - loss: 12.2460 - accuracy10: 0.4998 - accuracy20: 0.4737 - accuracy30: 0.4589 - accuracy50: 0.4566 - val_loss: 13.0082 - val_accuracy10: 0.4541 - val_accuracy20: 0.4134 - val_accuracy30: 0.3833 - val_accuracy50: 0.3761 - 100s/epoch - 26ms/step
Epoch 33/50
3903/3903 - 100s - loss: 12.2404 - accuracy10: 0.5000 - accuracy20: 0.4748 - accuracy30: 0.4597 - accuracy50: 0.4569 - val_loss: 12.9887 - val_accuracy10: 0.4530 - val_accuracy20: 0.4144 - val_accuracy30: 0.3854 - val_accuracy50: 0.3789 - 100s/epoch - 26ms/step
Epoch 34/50
3903/3903 - 100s - loss: 12.2323 - accuracy10: 0.5005 - accuracy20: 0.4750 - accuracy30: 0.4608 - accuracy50: 0.4584 - val_loss: 12.9769 - val_accuracy10: 0.4558 - val_accuracy20: 0.4162 - val_accuracy30: 0.3867 - val_accuracy50: 0.3798 - 100s/epoch - 26ms/step
Epoch 35/50
3903/3903 - 99s - loss: 12.2259 - accuracy10: 0.5008 - accuracy20: 0.4759 - accuracy30: 0.4613 - accuracy50: 0.4591 - val_loss: 12.9962 - val_accuracy10: 0.4552 - val_accuracy20: 0.4149 - val_accuracy30: 0.3855 - val_accuracy50: 0.3800 - 99s/epoch - 25ms/step
Epoch 36/50
3903/3903 - 99s - loss: 12.2211 - accuracy10: 0.5016 - accuracy20: 0.4764 - accuracy30: 0.4615 - accuracy50: 0.4596 - val_loss: 12.9932 - val_accuracy10: 0.4536 - val_accuracy20: 0.4141 - val_accuracy30: 0.3864 - val_accuracy50: 0.3802 - 99s/epoch - 25ms/step
Epoch 37/50
3903/3903 - 100s - loss: 12.2141 - accuracy10: 0.5014 - accuracy20: 0.4768 - accuracy30: 0.4625 - accuracy50: 0.4606 - val_loss: 13.0218 - val_accuracy10: 0.4541 - val_accuracy20: 0.4141 - val_accuracy30: 0.3848 - val_accuracy50: 0.3785 - 100s/epoch - 26ms/step
Epoch 38/50
3903/3903 - 100s - loss: 12.2062 - accuracy10: 0.5018 - accuracy20: 0.4776 - accuracy30: 0.4633 - accuracy50: 0.4614 - val_loss: 13.0619 - val_accuracy10: 0.4542 - val_accuracy20: 0.4130 - val_accuracy30: 0.3822 - val_accuracy50: 0.3760 - 100s/epoch - 26ms/step
Epoch 39/50
3903/3903 - 100s - loss: 12.1998 - accuracy10: 0.5022 - accuracy20: 0.4779 - accuracy30: 0.4639 - accuracy50: 0.4623 - val_loss: 13.0603 - val_accuracy10: 0.4526 - val_accuracy20: 0.4108 - val_accuracy30: 0.3795 - val_accuracy50: 0.3734 - 100s/epoch - 26ms/step
Epoch 40/50
3903/3903 - 99s - loss: 12.1919 - accuracy10: 0.5032 - accuracy20: 0.4788 - accuracy30: 0.4649 - accuracy50: 0.4630 - val_loss: 13.0348 - val_accuracy10: 0.4542 - val_accuracy20: 0.4123 - val_accuracy30: 0.3812 - val_accuracy50: 0.3754 - 99s/epoch - 25ms/step
Epoch 41/50
3903/3903 - 100s - loss: 12.1871 - accuracy10: 0.5026 - accuracy20: 0.4789 - accuracy30: 0.4652 - accuracy50: 0.4642 - val_loss: 13.0291 - val_accuracy10: 0.4551 - val_accuracy20: 0.4160 - val_accuracy30: 0.3849 - val_accuracy50: 0.3781 - 100s/epoch - 26ms/step
Epoch 42/50
3903/3903 - 99s - loss: 12.1783 - accuracy10: 0.5033 - accuracy20: 0.4799 - accuracy30: 0.4665 - accuracy50: 0.4649 - val_loss: 13.0728 - val_accuracy10: 0.4532 - val_accuracy20: 0.4136 - val_accuracy30: 0.3829 - val_accuracy50: 0.3772 - 99s/epoch - 25ms/step
Epoch 43/50
3903/3903 - 102s - loss: 12.1743 - accuracy10: 0.5034 - accuracy20: 0.4802 - accuracy30: 0.4668 - accuracy50: 0.4660 - val_loss: 13.0582 - val_accuracy10: 0.4535 - val_accuracy20: 0.4145 - val_accuracy30: 0.3857 - val_accuracy50: 0.3796 - 102s/epoch - 26ms/step
Epoch 44/50
3903/3903 - 102s - loss: 12.1647 - accuracy10: 0.5038 - accuracy20: 0.4804 - accuracy30: 0.4674 - accuracy50: 0.4661 - val_loss: 13.0620 - val_accuracy10: 0.4538 - val_accuracy20: 0.4168 - val_accuracy30: 0.3870 - val_accuracy50: 0.3817 - 102s/epoch - 26ms/step
testing model: results/AAPL/W8/deepVOL_L2/seq2seq
Evaluating performance on  test set...
10609/10609 - 92s - 92s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0292163
{'0': {'precision': 0.48267104296670793, 'recall': 0.4173316107533846, 'f1-score': 0.44762953307459863, 'support': 873883}, '1': {'precision': 0.45509795856171836, 'recall': 0.5492874046134253, 'f1-score': 0.49777622348652906, 'support': 940646}, '2': {'precision': 0.47900990579191777, 'recall': 0.4384083501913659, 'f1-score': 0.45781069027992555, 'support': 901153}, 'accuracy': 0.47003183730642983, 'macro avg': {'precision': 0.47225963577344804, 'recall': 0.4683424551860586, 'f1-score': 0.4677388156136844, 'support': 2715682}, 'weighted avg': {'precision': 0.4719055128708831, 'recall': 0.47003183730642983, 'f1-score': 0.4683775676781615, 'support': 2715682}}
[[364699 307465 201719]
 [195983 516685 227978]
 [194903 311177 395073]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0633193
{'0': {'precision': 0.47973464916903547, 'recall': 0.33045452869999187, 'f1-score': 0.3913419031569368, 'support': 895279}, '1': {'precision': 0.3849318187602798, 'recall': 0.6259550267687152, 'f1-score': 0.47671014413118123, 'support': 893954}, '2': {'precision': 0.48825644283965347, 'recall': 0.34008024186976293, 'f1-score': 0.4009151646679251, 'support': 926449}, 'accuracy': 0.4310118047694833, 'macro avg': {'precision': 0.45097430358965623, 'recall': 0.43216326577949005, 'f1-score': 0.42298907065201435, 'support': 2715682}, 'weighted avg': {'precision': 0.4514344423587836, 'recall': 0.4310118047694833, 'f1-score': 0.42270950033712335, 'support': 2715682}}
[[295849 446299 153131]
 [157287 559575 177092]
 [163557 447825 315067]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0946678
{'0': {'precision': 0.4790449897448138, 'recall': 0.2458190844204057, 'f1-score': 0.32491167647084107, 'support': 922585}, '1': {'precision': 0.3406703326389665, 'recall': 0.7284962282302047, 'f1-score': 0.464243947539217, 'support': 832633}, '2': {'precision': 0.5051413770400914, 'recall': 0.2428472071831948, 'f1-score': 0.3280054675546755, 'support': 960464}, 'accuracy': 0.3927576940157205, 'macro avg': {'precision': 0.44161889980795727, 'recall': 0.40572083994460173, 'f1-score': 0.3723870305215779, 'support': 2715682}, 'weighted avg': {'precision': 0.44584866361279935, 'recall': 0.3927576940157205, 'f1-score': 0.3687253931784743, 'support': 2715682}}
[[226789 583426 112370]
 [109935 606570 116128]
 [136695 590523 233246]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003062
{'0': {'precision': 0.4568632929620754, 'recall': 0.18970981816640245, 'f1-score': 0.26809482405932294, 'support': 896369}, '1': {'precision': 0.3600797082990084, 'recall': 0.8082678859242185, 'f1-score': 0.4982093788356652, 'support': 897158}, '2': {'precision': 0.48277598619045164, 'recall': 0.17256968730853273, 'f1-score': 0.254255133881139, 'support': 922155}, 'accuracy': 0.38823765080005684, 'macro avg': {'precision': 0.4332396624838452, 'recall': 0.3901824637997178, 'f1-score': 0.3401864455920424, 'support': 2715682}, 'weighted avg': {'precision': 0.433688765301939, 'recall': 0.38823765080005684, 'f1-score': 0.33941641997437133, 'support': 2715682}}
[[170050 640514  85805]
 [ 87328 725144  84686]
 [114834 648185 159136]]
Evaluating performance on  train set...
3903/3903 - 37s - 37s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0250221
{'0': {'precision': 0.5017758099717711, 'recall': 0.40537462721626066, 'f1-score': 0.4484530317682739, 'support': 336321}, '1': {'precision': 0.43210296876356036, 'recall': 0.5963075108864554, 'f1-score': 0.501096110645886, 'support': 325634}, '2': {'precision': 0.5069879882148524, 'recall': 0.4180589010050192, 'f1-score': 0.45824885991367054, 'support': 337108}, 'accuracy': 0.47188715826729644, 'macro avg': {'precision': 0.48028892231672793, 'recall': 0.4732470130359118, 'f1-score': 0.4692660007759435, 'support': 999063}, 'weighted avg': {'precision': 0.4808254004472208, 'recall': 0.47188715826729644, 'f1-score': 0.4689168347333228, 'support': 999063}}
[[136336 131072  68913]
 [ 63323 194178  68133]
 [ 72048 124129 140931]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0586871
{'0': {'precision': 0.4860586885731202, 'recall': 0.31452071523067804, 'f1-score': 0.3819122141982286, 'support': 334102}, '1': {'precision': 0.3863990882305054, 'recall': 0.6705962780098746, 'f1-score': 0.49029125135229396, 'support': 329125}, '2': {'precision': 0.5041195423150694, 'recall': 0.31774139758691744, 'f1-score': 0.3897974466219795, 'support': 335836}, 'accuracy': 0.4329066335156041, 'macro avg': {'precision': 0.45885910637289834, 'recall': 0.43428613027582336, 'f1-score': 0.4206669707241673, 'support': 999063}, 'weighted avg': {'precision': 0.45929863331586235, 'recall': 0.4329066335156041, 'f1-score': 0.4202665477283408, 'support': 999063}}
[[105082 179139  49881]
 [ 53331 220710  55084]
 [ 57779 171348 106709]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0823555
{'0': {'precision': 0.4764351458248623, 'recall': 0.23114652670466604, 'f1-score': 0.31127524477494795, 'support': 334567}, '1': {'precision': 0.36639311710259703, 'recall': 0.7701259729775015, 'f1-score': 0.4965492586332373, 'support': 328245}, '2': {'precision': 0.5104868429119296, 'recall': 0.222872199636581, 'f1-score': 0.3102800101023902, 'support': 336251}, 'accuracy': 0.40544490187305504, 'macro avg': {'precision': 0.4511050352797963, 'recall': 0.40804823310624955, 'f1-score': 0.3727015045035251, 'support': 999063}, 'weighted avg': {'precision': 0.4517411790572845, 'recall': 0.40544490187305504, 'f1-score': 0.3718125882908543, 'support': 999063}}
[[ 77334 222369  34864]
 [ 38457 252790  36998]
 [ 46527 214783  74941]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1057903
{'0': {'precision': 0.47057260736388073, 'recall': 0.17805149189304256, 'f1-score': 0.25835042170380346, 'support': 338228}, '1': {'precision': 0.3522310859696688, 'recall': 0.8400264598738497, 'f1-score': 0.49634147124694583, 'support': 321997}, '2': {'precision': 0.5045800416808026, 'recall': 0.15362798741581524, 'f1-score': 0.23554138772813757, 'support': 338838}, 'accuracy': 0.3831219853002263, 'macro avg': {'precision': 0.44246124500478407, 'recall': 0.3905686463942359, 'f1-score': 0.33007776022629565, 'support': 999063}, 'weighted avg': {'precision': 0.44396507226820126, 'recall': 0.3831219853002263, 'f1-score': 0.3273188816762942, 'support': 999063}}
[[ 60222 251288  26718]
 [ 27119 270486  24392]
 [ 40635 246148  52055]]
Evaluating performance on  val set...
1144/1144 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0455848
{'0': {'precision': 0.4882647453901575, 'recall': 0.4021968736797634, 'f1-score': 0.44107134977716983, 'support': 99414}, '1': {'precision': 0.41089298053082957, 'recall': 0.5375632790232696, 'f1-score': 0.4657694558221182, 'support': 94028}, '2': {'precision': 0.4877804121831114, 'recall': 0.43141010777187444, 'f1-score': 0.4578667765181709, 'support': 99191}, 'accuracy': 0.4555945501703499, 'macro avg': {'precision': 0.4623127127013662, 'recall': 0.4570567534916358, 'f1-score': 0.4549025273724863, 'support': 292633}, 'weighted avg': {'precision': 0.4632397010467889, 'recall': 0.4555945501703499, 'f1-score': 0.4547002593296162, 'support': 292633}}
[[39984 37277 22153]
 [20699 50546 22783]
 [21207 35192 42792]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0765109
{'0': {'precision': 0.47228068019478026, 'recall': 0.3109324433656958, 'f1-score': 0.37498704102354574, 'support': 98880}, '1': {'precision': 0.36814998196136, 'recall': 0.6199304508128037, 'f1-score': 0.4619611454975453, 'support': 95472}, '2': {'precision': 0.47543733525041937, 'recall': 0.32299223654622966, 'f1-score': 0.3846615247593139, 'support': 98281}, 'accuracy': 0.4157938441665841, 'macro avg': {'precision': 0.43862266580218656, 'recall': 0.4179517102415764, 'f1-score': 0.40720323709346834, 'support': 292633}, 'weighted avg': {'precision': 0.43936803259106555, 'recall': 0.4157938441665841, 'f1-score': 0.40661166858905173, 'support': 292633}}
[[30745 51817 16318]
 [17580 59186 18706]
 [16774 49763 31744]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1012057
{'0': {'precision': 0.4680873289459939, 'recall': 0.22390669971218422, 'f1-score': 0.30291558788337647, 'support': 100064}, '1': {'precision': 0.3458460020538429, 'recall': 0.7311785615461569, 'f1-score': 0.46958108634583445, 'support': 93962}, '2': {'precision': 0.47512793824269234, 'recall': 0.22220532010912003, 'f1-score': 0.30279914042688444, 'support': 98607}, 'accuracy': 0.3862141316939648, 'macro avg': {'precision': 0.42968708974750974, 'recall': 0.3924301937891537, 'f1-score': 0.35843193821869845, 'support': 292633}, 'weighted avg': {'precision': 0.43120910196366197, 'recall': 0.3862141316939648, 'f1-score': 0.35639124179864634, 'support': 292633}}
[[22405 66219 11440]
 [12494 68703 12765]
 [12966 63730 21911]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1109011
{'0': {'precision': 0.449416130088399, 'recall': 0.16830145496158247, 'f1-score': 0.2448931045761351, 'support': 97872}, '1': {'precision': 0.3577274593456025, 'recall': 0.813503420000406, 'f1-score': 0.4969344929979977, 'support': 98538}, '2': {'precision': 0.4516725710881901, 'recall': 0.1497251176953535, 'f1-score': 0.22489853262566342, 'support': 96223}, 'accuracy': 0.37945139475042117, 'macro avg': {'precision': 0.41960538684073057, 'recall': 0.37717666421911394, 'f1-score': 0.32224204339993207, 'support': 292633}, 'weighted avg': {'precision': 0.4192838595812082, 'recall': 0.37945139475042117, 'f1-score': 0.3231881589121917, 'support': 292633}}
[[16472 72824  8576]
 [ 9463 80161  8914]
 [10717 71099 14407]]
training model: results/AAPL/W8/deepVOL_L3/seq2seq
Epoch 1/50
3903/3903 - 158s - loss: 13.0186 - accuracy10: 0.3869 - accuracy20: 0.3818 - accuracy30: 0.3781 - accuracy50: 0.3849 - val_loss: 14.1636 - val_accuracy10: 0.3214 - val_accuracy20: 0.3263 - val_accuracy30: 0.3211 - val_accuracy50: 0.3368 - 158s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 155s - loss: 12.8686 - accuracy10: 0.4176 - accuracy20: 0.4084 - accuracy30: 0.4011 - accuracy50: 0.4053 - val_loss: 13.7427 - val_accuracy10: 0.3323 - val_accuracy20: 0.3313 - val_accuracy30: 0.3226 - val_accuracy50: 0.3370 - 155s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 150s - loss: 12.7663 - accuracy10: 0.4372 - accuracy20: 0.4229 - accuracy30: 0.4120 - accuracy50: 0.4123 - val_loss: 13.5974 - val_accuracy10: 0.3272 - val_accuracy20: 0.3293 - val_accuracy30: 0.3229 - val_accuracy50: 0.3375 - 150s/epoch - 38ms/step
Epoch 4/50
3903/3903 - 148s - loss: 12.6862 - accuracy10: 0.4519 - accuracy20: 0.4326 - accuracy30: 0.4191 - accuracy50: 0.4176 - val_loss: 13.3141 - val_accuracy10: 0.3589 - val_accuracy20: 0.3484 - val_accuracy30: 0.3342 - val_accuracy50: 0.3425 - 148s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 152s - loss: 12.6290 - accuracy10: 0.4617 - accuracy20: 0.4398 - accuracy30: 0.4249 - accuracy50: 0.4221 - val_loss: 13.1705 - val_accuracy10: 0.3855 - val_accuracy20: 0.3661 - val_accuracy30: 0.3469 - val_accuracy50: 0.3485 - 152s/epoch - 39ms/step
Epoch 6/50
3903/3903 - 151s - loss: 12.5782 - accuracy10: 0.4686 - accuracy20: 0.4448 - accuracy30: 0.4293 - accuracy50: 0.4265 - val_loss: 13.1419 - val_accuracy10: 0.4040 - val_accuracy20: 0.3751 - val_accuracy30: 0.3516 - val_accuracy50: 0.3508 - 151s/epoch - 39ms/step
Epoch 7/50
3903/3903 - 152s - loss: 12.5425 - accuracy10: 0.4728 - accuracy20: 0.4486 - accuracy30: 0.4321 - accuracy50: 0.4295 - val_loss: 13.1516 - val_accuracy10: 0.4156 - val_accuracy20: 0.3779 - val_accuracy30: 0.3485 - val_accuracy50: 0.3478 - 152s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 151s - loss: 12.5120 - accuracy10: 0.4755 - accuracy20: 0.4507 - accuracy30: 0.4346 - accuracy50: 0.4322 - val_loss: 13.1646 - val_accuracy10: 0.4199 - val_accuracy20: 0.3780 - val_accuracy30: 0.3477 - val_accuracy50: 0.3466 - 151s/epoch - 39ms/step
Epoch 9/50
3903/3903 - 154s - loss: 12.4900 - accuracy10: 0.4782 - accuracy20: 0.4526 - accuracy30: 0.4363 - accuracy50: 0.4334 - val_loss: 13.1423 - val_accuracy10: 0.4284 - val_accuracy20: 0.3817 - val_accuracy30: 0.3484 - val_accuracy50: 0.3475 - 154s/epoch - 39ms/step
Epoch 10/50
3903/3903 - 152s - loss: 12.4704 - accuracy10: 0.4800 - accuracy20: 0.4542 - accuracy30: 0.4379 - accuracy50: 0.4350 - val_loss: 13.2136 - val_accuracy10: 0.4267 - val_accuracy20: 0.3780 - val_accuracy30: 0.3451 - val_accuracy50: 0.3456 - 152s/epoch - 39ms/step
Epoch 11/50
3903/3903 - 152s - loss: 12.4549 - accuracy10: 0.4817 - accuracy20: 0.4555 - accuracy30: 0.4394 - accuracy50: 0.4367 - val_loss: 13.1678 - val_accuracy10: 0.4342 - val_accuracy20: 0.3838 - val_accuracy30: 0.3492 - val_accuracy50: 0.3470 - 152s/epoch - 39ms/step
Epoch 12/50
3903/3903 - 148s - loss: 12.4416 - accuracy10: 0.4832 - accuracy20: 0.4568 - accuracy30: 0.4405 - accuracy50: 0.4375 - val_loss: 13.1503 - val_accuracy10: 0.4421 - val_accuracy20: 0.3879 - val_accuracy30: 0.3509 - val_accuracy50: 0.3473 - 148s/epoch - 38ms/step
Epoch 13/50
3903/3903 - 150s - loss: 12.4286 - accuracy10: 0.4844 - accuracy20: 0.4579 - accuracy30: 0.4412 - accuracy50: 0.4384 - val_loss: 13.1172 - val_accuracy10: 0.4476 - val_accuracy20: 0.3943 - val_accuracy30: 0.3548 - val_accuracy50: 0.3490 - 150s/epoch - 38ms/step
Epoch 14/50
3903/3903 - 152s - loss: 12.4169 - accuracy10: 0.4857 - accuracy20: 0.4589 - accuracy30: 0.4417 - accuracy50: 0.4389 - val_loss: 13.1068 - val_accuracy10: 0.4484 - val_accuracy20: 0.3977 - val_accuracy30: 0.3575 - val_accuracy50: 0.3495 - 152s/epoch - 39ms/step
Epoch 15/50
3903/3903 - 150s - loss: 12.4047 - accuracy10: 0.4868 - accuracy20: 0.4602 - accuracy30: 0.4436 - accuracy50: 0.4407 - val_loss: 13.1092 - val_accuracy10: 0.4506 - val_accuracy20: 0.3968 - val_accuracy30: 0.3558 - val_accuracy50: 0.3491 - 150s/epoch - 38ms/step
Epoch 16/50
3903/3903 - 151s - loss: 12.3926 - accuracy10: 0.4881 - accuracy20: 0.4609 - accuracy30: 0.4444 - accuracy50: 0.4410 - val_loss: 13.0851 - val_accuracy10: 0.4533 - val_accuracy20: 0.4036 - val_accuracy30: 0.3618 - val_accuracy50: 0.3516 - 151s/epoch - 39ms/step
Epoch 17/50
3903/3903 - 152s - loss: 12.3820 - accuracy10: 0.4889 - accuracy20: 0.4621 - accuracy30: 0.4453 - accuracy50: 0.4420 - val_loss: 13.0283 - val_accuracy10: 0.4590 - val_accuracy20: 0.4070 - val_accuracy30: 0.3650 - val_accuracy50: 0.3523 - 152s/epoch - 39ms/step
Epoch 18/50
3903/3903 - 153s - loss: 12.3718 - accuracy10: 0.4902 - accuracy20: 0.4629 - accuracy30: 0.4459 - accuracy50: 0.4430 - val_loss: 13.0147 - val_accuracy10: 0.4610 - val_accuracy20: 0.4125 - val_accuracy30: 0.3691 - val_accuracy50: 0.3543 - 153s/epoch - 39ms/step
Epoch 19/50
3903/3903 - 148s - loss: 12.3615 - accuracy10: 0.4910 - accuracy20: 0.4636 - accuracy30: 0.4468 - accuracy50: 0.4437 - val_loss: 13.0076 - val_accuracy10: 0.4617 - val_accuracy20: 0.4118 - val_accuracy30: 0.3704 - val_accuracy50: 0.3549 - 148s/epoch - 38ms/step
Epoch 20/50
3903/3903 - 148s - loss: 12.3525 - accuracy10: 0.4916 - accuracy20: 0.4645 - accuracy30: 0.4479 - accuracy50: 0.4446 - val_loss: 12.9955 - val_accuracy10: 0.4631 - val_accuracy20: 0.4141 - val_accuracy30: 0.3723 - val_accuracy50: 0.3572 - 148s/epoch - 38ms/step
Epoch 21/50
3903/3903 - 148s - loss: 12.3427 - accuracy10: 0.4923 - accuracy20: 0.4654 - accuracy30: 0.4489 - accuracy50: 0.4454 - val_loss: 12.9878 - val_accuracy10: 0.4643 - val_accuracy20: 0.4155 - val_accuracy30: 0.3731 - val_accuracy50: 0.3571 - 148s/epoch - 38ms/step
Epoch 22/50
3903/3903 - 149s - loss: 12.3348 - accuracy10: 0.4930 - accuracy20: 0.4659 - accuracy30: 0.4496 - accuracy50: 0.4463 - val_loss: 12.9800 - val_accuracy10: 0.4637 - val_accuracy20: 0.4170 - val_accuracy30: 0.3754 - val_accuracy50: 0.3586 - 149s/epoch - 38ms/step
Epoch 23/50
3903/3903 - 148s - loss: 12.3247 - accuracy10: 0.4943 - accuracy20: 0.4670 - accuracy30: 0.4507 - accuracy50: 0.4471 - val_loss: 12.9789 - val_accuracy10: 0.4632 - val_accuracy20: 0.4178 - val_accuracy30: 0.3772 - val_accuracy50: 0.3610 - 148s/epoch - 38ms/step
Epoch 24/50
3903/3903 - 148s - loss: 12.3318 - accuracy10: 0.4938 - accuracy20: 0.4667 - accuracy30: 0.4501 - accuracy50: 0.4468 - val_loss: 13.0486 - val_accuracy10: 0.4540 - val_accuracy20: 0.4015 - val_accuracy30: 0.3619 - val_accuracy50: 0.3512 - 148s/epoch - 38ms/step
Epoch 25/50
3903/3903 - 148s - loss: 12.3232 - accuracy10: 0.4945 - accuracy20: 0.4671 - accuracy30: 0.4503 - accuracy50: 0.4471 - val_loss: 13.0101 - val_accuracy10: 0.4650 - val_accuracy20: 0.4182 - val_accuracy30: 0.3746 - val_accuracy50: 0.3584 - 148s/epoch - 38ms/step
Epoch 26/50
3903/3903 - 155s - loss: 12.3041 - accuracy10: 0.4963 - accuracy20: 0.4685 - accuracy30: 0.4519 - accuracy50: 0.4484 - val_loss: 13.0136 - val_accuracy10: 0.4635 - val_accuracy20: 0.4180 - val_accuracy30: 0.3779 - val_accuracy50: 0.3614 - 155s/epoch - 40ms/step
Epoch 27/50
3903/3903 - 152s - loss: 12.2953 - accuracy10: 0.4968 - accuracy20: 0.4696 - accuracy30: 0.4533 - accuracy50: 0.4494 - val_loss: 12.9993 - val_accuracy10: 0.4632 - val_accuracy20: 0.4165 - val_accuracy30: 0.3765 - val_accuracy50: 0.3607 - 152s/epoch - 39ms/step
Epoch 28/50
3903/3903 - 152s - loss: 12.2855 - accuracy10: 0.4973 - accuracy20: 0.4706 - accuracy30: 0.4544 - accuracy50: 0.4509 - val_loss: 12.9996 - val_accuracy10: 0.4611 - val_accuracy20: 0.4144 - val_accuracy30: 0.3754 - val_accuracy50: 0.3611 - 152s/epoch - 39ms/step
Epoch 29/50
3903/3903 - 150s - loss: 12.2782 - accuracy10: 0.4979 - accuracy20: 0.4708 - accuracy30: 0.4546 - accuracy50: 0.4514 - val_loss: 13.0068 - val_accuracy10: 0.4614 - val_accuracy20: 0.4153 - val_accuracy30: 0.3775 - val_accuracy50: 0.3628 - 150s/epoch - 38ms/step
Epoch 30/50
3903/3903 - 152s - loss: 12.2704 - accuracy10: 0.4984 - accuracy20: 0.4720 - accuracy30: 0.4559 - accuracy50: 0.4520 - val_loss: 13.0454 - val_accuracy10: 0.4612 - val_accuracy20: 0.4128 - val_accuracy30: 0.3744 - val_accuracy50: 0.3600 - 152s/epoch - 39ms/step
Epoch 31/50
3903/3903 - 152s - loss: 12.2636 - accuracy10: 0.4990 - accuracy20: 0.4726 - accuracy30: 0.4564 - accuracy50: 0.4531 - val_loss: 13.0372 - val_accuracy10: 0.4605 - val_accuracy20: 0.4132 - val_accuracy30: 0.3739 - val_accuracy50: 0.3601 - 152s/epoch - 39ms/step
Epoch 32/50
3903/3903 - 150s - loss: 12.2543 - accuracy10: 0.4992 - accuracy20: 0.4728 - accuracy30: 0.4571 - accuracy50: 0.4535 - val_loss: 13.0229 - val_accuracy10: 0.4611 - val_accuracy20: 0.4151 - val_accuracy30: 0.3778 - val_accuracy50: 0.3636 - 150s/epoch - 38ms/step
Epoch 33/50
3903/3903 - 148s - loss: 12.2476 - accuracy10: 0.5002 - accuracy20: 0.4738 - accuracy30: 0.4584 - accuracy50: 0.4546 - val_loss: 13.0599 - val_accuracy10: 0.4570 - val_accuracy20: 0.4125 - val_accuracy30: 0.3780 - val_accuracy50: 0.3648 - 148s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/seq2seq
Evaluating performance on  test set...
10609/10609 - 168s - 168s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0303062
{'0': {'precision': 0.47543111671980937, 'recall': 0.4362849489004821, 'f1-score': 0.45501762727561323, 'support': 873883}, '1': {'precision': 0.4696033431941041, 'recall': 0.49565192431584254, 'f1-score': 0.48227615751791214, 'support': 940646}, '2': {'precision': 0.46910405785456005, 'recall': 0.47939916973033436, 'f1-score': 0.4741957419063786, 'support': 901153}, 'accuracy': 0.4711549437673483, 'macro avg': {'precision': 0.4713795059228245, 'recall': 0.47044534764888635, 'f1-score': 0.470496508899968, 'support': 2715682}, 'weighted avg': {'precision': 0.47131299098437474, 'recall': 0.4711549437673483, 'f1-score': 0.470823249204895, 'support': 2715682}}
[[381262 259148 233473]
 [218968 466233 255445]
 [201699 267442 432012]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0671723
{'0': {'precision': 0.4875848653247113, 'recall': 0.29704706577502654, 'f1-score': 0.3691811353076486, 'support': 895279}, '1': {'precision': 0.3824822145102487, 'recall': 0.6439291059718957, 'f1-score': 0.47990786057200313, 'support': 893954}, '2': {'precision': 0.48161565750706514, 'recall': 0.34582583606868805, 'f1-score': 0.4025786444462454, 'support': 926449}, 'accuracy': 0.4278752077746953, 'macro avg': {'precision': 0.4505609124473417, 'recall': 0.4289340026052035, 'f1-score': 0.417222546775299, 'support': 2715682}, 'weighted avg': {'precision': 0.45095056803966743, 'recall': 0.4278752077746953, 'f1-score': 0.4170238826915156, 'support': 2715682}}
[[265940 462233 167106]
 [140567 575643 177744]
 [138916 467143 320390]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.105078
{'0': {'precision': 0.5052870570303569, 'recall': 0.17247733271189106, 'f1-score': 0.2571706780982703, 'support': 922585}, '1': {'precision': 0.3299477357418051, 'recall': 0.803090917607157, 'f1-score': 0.46772990325808417, 'support': 832633}, '2': {'precision': 0.5080879247764194, 'recall': 0.1979199636842193, 'f1-score': 0.2848714448202535, 'support': 960464}, 'accuracy': 0.37482297264554537, 'macro avg': {'precision': 0.44777423918286047, 'recall': 0.39116273800108914, 'f1-score': 0.3365906753922026, 'support': 2715682}, 'weighted avg': {'precision': 0.45251829674708494, 'recall': 0.37482297264554537, 'f1-score': 0.3315255357477868, 'support': 2715682}}
[[159125 670430  93030]
 [ 72940 668680  91013]
 [ 82855 687514 190095]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1187277
{'0': {'precision': 0.49394939493949397, 'recall': 0.08114738461504135, 'f1-score': 0.13939463045705028, 'support': 896369}, '1': {'precision': 0.34116349430892756, 'recall': 0.9163881947215541, 'f1-score': 0.49721725378252396, 'support': 897158}, '2': {'precision': 0.503420619557747, 'recall': 0.08658088932988489, 'f1-score': 0.14775082535123693, 'support': 922155}, 'accuracy': 0.3589242039384582, 'macro avg': {'precision': 0.4461778362687228, 'recall': 0.3613721562221601, 'f1-score': 0.2614542365302704, 'support': 2715682}, 'weighted avg': {'precision': 0.44669085881484, 'recall': 0.3589242039384582, 'f1-score': 0.26044309489437545, 'support': 2715682}}
[[ 72738 784862  38769]
 [ 35026 822145  39987]
 [ 39494 802820  79841]]
Evaluating performance on  train set...
3903/3903 - 64s - 64s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0270827
{'0': {'precision': 0.5012629796272775, 'recall': 0.41539184291197995, 'f1-score': 0.45430525814313844, 'support': 336321}, '1': {'precision': 0.4405911086378532, 'recall': 0.5470620389762739, 'f1-score': 0.48808768711667366, 'support': 325634}, '2': {'precision': 0.49233621911705144, 'recall': 0.4615553472477663, 'f1-score': 0.47644915332088067, 'support': 337108}, 'accuracy': 0.47388503027336615, 'macro avg': {'precision': 0.47806343579406074, 'recall': 0.4746697430453401, 'f1-score': 0.4729473661935642, 'support': 999063}, 'weighted avg': {'precision': 0.47847552135902865, 'recall': 0.47388503027336615, 'f1-score': 0.47278816832192244, 'support': 999063}}
[[139705 115123  81493]
 [ 68547 178142  78945]
 [ 70454 111060 155594]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0660104
{'0': {'precision': 0.49914627820523905, 'recall': 0.2764963993032068, 'f1-score': 0.35586527830746534, 'support': 334102}, '1': {'precision': 0.3818396698306763, 'recall': 0.684217242688948, 'f1-score': 0.49014510008347084, 'support': 329125}, '2': {'precision': 0.4926304335222737, 'recall': 0.32892245024357125, 'f1-score': 0.39446568190705067, 'support': 335836}, 'accuracy': 0.42843644494891714, 'macro avg': {'precision': 0.457872127186063, 'recall': 0.42987869741190865, 'f1-score': 0.4134920200993289, 'support': 999063}, 'weighted avg': {'precision': 0.4583112230623438, 'recall': 0.42843644494891714, 'f1-score': 0.41307713730464385, 'support': 999063}}
[[ 92378 185481  56243]
 [ 46406 225193  57526]
 [ 46288 179084 110464]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0946007
{'0': {'precision': 0.5037265191269298, 'recall': 0.15837784360083332, 'f1-score': 0.24098654035505815, 'support': 334567}, '1': {'precision': 0.3532438304127802, 'recall': 0.8272327072765769, 'f1-score': 0.49507947143632025, 'support': 328245}, '2': {'precision': 0.5055240012461955, 'recall': 0.18819869680684964, 'f1-score': 0.2742852684685934, 'support': 336251}, 'accuracy': 0.38816871408509773, 'macro avg': {'precision': 0.4541647835953018, 'recall': 0.3912697492280866, 'f1-score': 0.3367837600866573, 'support': 999063}, 'weighted avg': {'precision': 0.45488997428752437, 'recall': 0.38816871408509773, 'f1-score': 0.3356767298522903, 'support': 999063}}
[[ 52988 251119  30460]
 [ 25271 271535  31439]
 [ 26933 246036  63282]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1283654
{'0': {'precision': 0.5065084075173096, 'recall': 0.075700415104604, 'f1-score': 0.1317152719546888, 'support': 338228}, '1': {'precision': 0.3324711114596345, 'recall': 0.9216918170045063, 'f1-score': 0.48867000589469256, 'support': 321997}, '2': {'precision': 0.5109026459952021, 'recall': 0.08422313908121284, 'f1-score': 0.14460749538885623, 'support': 338838}, 'accuracy': 0.35125312417735416, 'macro avg': {'precision': 0.44996072165738205, 'recall': 0.36053845706344106, 'f1-score': 0.2549975910794125, 'support': 999063}, 'weighted avg': {'precision': 0.4519066934699361, 'recall': 0.35125312417735416, 'f1-score': 0.2511338958737668, 'support': 999063}}
[[ 25604 299161  13463]
 [ 11358 296782  13857]
 [ 13588 296712  28538]]
Evaluating performance on  val set...
1144/1144 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0392882
{'0': {'precision': 0.4949144162173616, 'recall': 0.42288812440903695, 'f1-score': 0.4560750705142113, 'support': 99414}, '1': {'precision': 0.42703872803410564, 'recall': 0.48045263113115244, 'f1-score': 0.45217373897115865, 'support': 94028}, '2': {'precision': 0.47527920076939684, 'recall': 0.48824994203103106, 'f1-score': 0.48167726727966226, 'support': 99191}, 'accuracy': 0.4635396554728961, 'macro avg': {'precision': 0.46574411500695473, 'recall': 0.4638635658570735, 'f1-score': 0.46330869225501076, 'support': 292633}, 'weighted avg': {'precision': 0.46644923332960025, 'recall': 0.4635396554728961, 'f1-score': 0.46349963676966327, 'support': 292633}}
[[42041 30845 26528]
 [21912 45176 26940]
 [20993 29768 48430]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0745531
{'0': {'precision': 0.49289798266748175, 'recall': 0.27724514563106795, 'f1-score': 0.3548783803026576, 'support': 98880}, '1': {'precision': 0.3676686706746827, 'recall': 0.6341545165074577, 'f1-score': 0.465468859315297, 'support': 95472}, '2': {'precision': 0.47113138433893154, 'recall': 0.34680151809607146, 'f1-score': 0.39951707242741435, 'support': 98281}, 'accuracy': 0.417047974767029, 'macro avg': {'precision': 0.4438993458936986, 'recall': 0.4194003934115324, 'f1-score': 0.4066214373484563, 'support': 292633}, 'weighted avg': {'precision': 0.44473138517196775, 'recall': 0.417047974767029, 'f1-score': 0.4059506432156166, 'support': 292633}}
[[27414 53388 18078]
 [14745 60544 20183]
 [13459 50738 34084]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1035081
{'0': {'precision': 0.5052159028517909, 'recall': 0.15632994883274703, 'f1-score': 0.23877521426881484, 'support': 100064}, '1': {'precision': 0.3394634289189737, 'recall': 0.8019092824758945, 'f1-score': 0.4770025987015988, 'support': 93962}, '2': {'precision': 0.48789824959073164, 'recall': 0.19645664100925897, 'f1-score': 0.2801203077101047, 'support': 98607}, 'accuracy': 0.3771413340258959, 'macro avg': {'precision': 0.4441925271204987, 'recall': 0.38489862410596687, 'f1-score': 0.33196604022683945, 'support': 292633}, 'weighted avg': {'precision': 0.4461587363982855, 'recall': 0.3771413340258959, 'f1-score': 0.329199866051213, 'support': 292633}}
[[15643 74798  9623]
 [ 7903 75349 10710]
 [ 7417 71818 19372]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1216964
{'0': {'precision': 0.49169366512718, 'recall': 0.07288090567271538, 'f1-score': 0.12694542574680323, 'support': 97872}, '1': {'precision': 0.34465365480290855, 'recall': 0.9139418295479916, 'f1-score': 0.5005474685830846, 'support': 98538}, '2': {'precision': 0.4827647688101747, 'recall': 0.08441848622470718, 'f1-score': 0.14370759582128104, 'support': 96223}, 'accuracy': 0.35988422358380634, 'macro avg': {'precision': 0.43970402958008775, 'recall': 0.35708040714847145, 'f1-score': 0.2570668300503896, 'support': 292633}, 'weighted avg': {'precision': 0.4392450563658843, 'recall': 0.35988422358380634, 'f1-score': 0.2582597491077297, 'support': 292633}}
[[ 7133 86721  4018]
 [ 3795 90058  4685]
 [ 3579 84521  8123]]
training model: results/AAPL/W9/deepLOB_L1/seq2seq
Epoch 1/50
3419/3419 - 92s - loss: 12.7141 - accuracy10: 0.4424 - accuracy20: 0.4274 - accuracy30: 0.4144 - accuracy50: 0.4275 - val_loss: 13.1201 - val_accuracy10: 0.3973 - val_accuracy20: 0.3868 - val_accuracy30: 0.3751 - val_accuracy50: 0.3725 - 92s/epoch - 27ms/step
Epoch 2/50
3419/3419 - 89s - loss: 12.6418 - accuracy10: 0.4533 - accuracy20: 0.4372 - accuracy30: 0.4229 - accuracy50: 0.4315 - val_loss: 13.1255 - val_accuracy10: 0.3952 - val_accuracy20: 0.3814 - val_accuracy30: 0.3734 - val_accuracy50: 0.3740 - 89s/epoch - 26ms/step
Epoch 3/50
3419/3419 - 82s - loss: 12.5996 - accuracy10: 0.4598 - accuracy20: 0.4418 - accuracy30: 0.4270 - accuracy50: 0.4341 - val_loss: 13.0415 - val_accuracy10: 0.3966 - val_accuracy20: 0.3757 - val_accuracy30: 0.3657 - val_accuracy50: 0.3690 - 82s/epoch - 24ms/step
Epoch 4/50
3419/3419 - 89s - loss: 12.5682 - accuracy10: 0.4644 - accuracy20: 0.4451 - accuracy30: 0.4298 - accuracy50: 0.4368 - val_loss: 13.1445 - val_accuracy10: 0.3919 - val_accuracy20: 0.3699 - val_accuracy30: 0.3599 - val_accuracy50: 0.3644 - 89s/epoch - 26ms/step
Epoch 5/50
3419/3419 - 84s - loss: 12.5441 - accuracy10: 0.4672 - accuracy20: 0.4469 - accuracy30: 0.4321 - accuracy50: 0.4397 - val_loss: 13.1880 - val_accuracy10: 0.3911 - val_accuracy20: 0.3676 - val_accuracy30: 0.3564 - val_accuracy50: 0.3630 - 84s/epoch - 25ms/step
Epoch 6/50
3419/3419 - 83s - loss: 12.5285 - accuracy10: 0.4686 - accuracy20: 0.4482 - accuracy30: 0.4334 - accuracy50: 0.4418 - val_loss: 13.2252 - val_accuracy10: 0.3896 - val_accuracy20: 0.3666 - val_accuracy30: 0.3559 - val_accuracy50: 0.3616 - 83s/epoch - 24ms/step
Epoch 7/50
3419/3419 - 89s - loss: 12.5181 - accuracy10: 0.4696 - accuracy20: 0.4494 - accuracy30: 0.4342 - accuracy50: 0.4428 - val_loss: 13.1555 - val_accuracy10: 0.3873 - val_accuracy20: 0.3644 - val_accuracy30: 0.3537 - val_accuracy50: 0.3603 - 89s/epoch - 26ms/step
Epoch 8/50
3419/3419 - 78s - loss: 12.5077 - accuracy10: 0.4709 - accuracy20: 0.4501 - accuracy30: 0.4348 - accuracy50: 0.4438 - val_loss: 13.1658 - val_accuracy10: 0.3862 - val_accuracy20: 0.3652 - val_accuracy30: 0.3535 - val_accuracy50: 0.3590 - 78s/epoch - 23ms/step
Epoch 9/50
3419/3419 - 78s - loss: 12.4984 - accuracy10: 0.4716 - accuracy20: 0.4508 - accuracy30: 0.4363 - accuracy50: 0.4451 - val_loss: 13.1298 - val_accuracy10: 0.3911 - val_accuracy20: 0.3694 - val_accuracy30: 0.3572 - val_accuracy50: 0.3608 - 78s/epoch - 23ms/step
Epoch 10/50
3419/3419 - 82s - loss: 12.4941 - accuracy10: 0.4726 - accuracy20: 0.4511 - accuracy30: 0.4360 - accuracy50: 0.4449 - val_loss: 13.1517 - val_accuracy10: 0.3881 - val_accuracy20: 0.3646 - val_accuracy30: 0.3531 - val_accuracy50: 0.3590 - 82s/epoch - 24ms/step
Epoch 11/50
3419/3419 - 81s - loss: 12.4868 - accuracy10: 0.4729 - accuracy20: 0.4519 - accuracy30: 0.4366 - accuracy50: 0.4459 - val_loss: 13.1433 - val_accuracy10: 0.3878 - val_accuracy20: 0.3664 - val_accuracy30: 0.3546 - val_accuracy50: 0.3602 - 81s/epoch - 24ms/step
Epoch 12/50
3419/3419 - 83s - loss: 12.4793 - accuracy10: 0.4736 - accuracy20: 0.4526 - accuracy30: 0.4375 - accuracy50: 0.4464 - val_loss: 13.1587 - val_accuracy10: 0.3881 - val_accuracy20: 0.3676 - val_accuracy30: 0.3564 - val_accuracy50: 0.3599 - 83s/epoch - 24ms/step
Epoch 13/50
3419/3419 - 89s - loss: 12.4755 - accuracy10: 0.4741 - accuracy20: 0.4527 - accuracy30: 0.4377 - accuracy50: 0.4470 - val_loss: 13.1845 - val_accuracy10: 0.3861 - val_accuracy20: 0.3668 - val_accuracy30: 0.3567 - val_accuracy50: 0.3595 - 89s/epoch - 26ms/step
testing model: results/AAPL/W9/deepLOB_L1/seq2seq
Evaluating performance on  test set...
10303/10303 - 97s - 97s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0814109
{'0': {'precision': 0.502491059258239, 'recall': 0.1286777091692339, 'f1-score': 0.20488782594382093, 'support': 822217}, '1': {'precision': 0.3867631406591321, 'recall': 0.9207233182920627, 'f1-score': 0.5447120921564026, 'support': 987062}, '2': {'precision': 0.4966521332918094, 'recall': 0.04621766037735849, 'f1-score': 0.08456576471874935, 'support': 828125}, 'accuracy': 0.3992130140092303, 'macro avg': {'precision': 0.4619687777363935, 'recall': 0.3652062292795517, 'f1-score': 0.2780552276063243, 'support': 2637404}, 'weighted avg': {'precision': 0.45734591222948606, 'recall': 0.3992130140092303, 'f1-score': 0.29428858248484036, 'support': 2637404}}
[[105801 697754  18662]
 [ 58123 908811  20128]
 [ 46629 743222  38274]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0889747
{'0': {'precision': 0.47398024157758656, 'recall': 0.11751648385819756, 'f1-score': 0.18833744639049285, 'support': 836121}, '1': {'precision': 0.3708436273182618, 'recall': 0.9171704426323157, 'f1-score': 0.5281414570695097, 'support': 955782}, '2': {'precision': 0.463431934802294, 'recall': 0.0363181119833093, 'f1-score': 0.06735756409848632, 'support': 845501}, 'accuracy': 0.38127643698121333, 'macro avg': {'precision': 0.4360852678993808, 'recall': 0.3570016794912742, 'f1-score': 0.2612788225194963, 'support': 2637404}, 'weighted avg': {'precision': 0.43322246484833976, 'recall': 0.38127643698121333, 'f1-score': 0.2726968943465277, 'support': 2637404}}
[[ 98258 721256  16607]
 [ 60221 876615  18946]
 [ 48825 765969  30707]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0955269
{'0': {'precision': 0.4603329831475089, 'recall': 0.1109358465647047, 'f1-score': 0.17878598141911903, 'support': 857117}, '1': {'precision': 0.3517073144028032, 'recall': 0.9163568141049202, 'f1-score': 0.508317185035153, 'support': 911455}, '2': {'precision': 0.44195457624701395, 'recall': 0.02853370962395492, 'f1-score': 0.05360645067821642, 'support': 868832}, 'accuracy': 0.362134128863079, 'macro avg': {'precision': 0.41799829126577537, 'recall': 0.35194212343119324, 'f1-score': 0.2469032057108295, 'support': 2637404}, 'weighted avg': {'precision': 0.4167389198451568, 'recall': 0.362134128863079, 'f1-score': 0.2514304762098952, 'support': 2637404}}
[[ 95085 747322  14710]
 [ 59644 835218  16593]
 [ 51828 792213  24791]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0883921
{'0': {'precision': 0.4200384028359017, 'recall': 0.10554561717352415, 'f1-score': 0.168700762489322, 'support': 808314}, '1': {'precision': 0.38709796301259713, 'recall': 0.9180540188352797, 'f1-score': 0.5445754143107704, 'support': 1006834}, '2': {'precision': 0.4020751711370388, 'recall': 0.02271555330699928, 'f1-score': 0.04300169216424353, 'support': 822256}, 'accuracy': 0.38989855175771326, 'macro avg': {'precision': 0.40307051232851254, 'recall': 0.3487717297719344, 'f1-score': 0.25209262298811197, 'support': 2637404}, 'weighted avg': {'precision': 0.40186298115881425, 'recall': 0.38989855175771326, 'f1-score': 0.27300278236294717, 'support': 2637404}}
[[ 85314 710893  12107]
 [ 66837 924328  15669]
 [ 50959 752619  18678]]
Evaluating performance on  train set...
3419/3419 - 32s - 32s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0770441
{'0': {'precision': 0.4468341578076247, 'recall': 0.3315650597394377, 'f1-score': 0.3806648076907886, 'support': 290679}, '1': {'precision': 0.35895257731958763, 'recall': 0.6034008276779959, 'f1-score': 0.45013044298904487, 'support': 288518}, '2': {'precision': 0.4626936679257828, 'recall': 0.2727490817922874, 'f1-score': 0.3431926499411162, 'support': 295957}, 'accuracy': 0.4012928010384458, 'macro avg': {'precision': 0.42282680101766507, 'recall': 0.4025716564032404, 'f1-score': 0.39132930020698325, 'support': 875154}, 'weighted avg': {'precision': 0.4232249589658121, 'recall': 0.4012928010384458, 'f1-score': 0.39089379455922835, 'support': 875154}}
[[ 96379 151905  42395]
 [ 63082 174092  51344]
 [ 56232 159003  80722]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.085138
{'0': {'precision': 0.432032156249157, 'recall': 0.2764123523441977, 'f1-score': 0.33713021457185627, 'support': 289694}, '1': {'precision': 0.34699172444643256, 'recall': 0.6463246551706181, 'f1-score': 0.45155664650644406, 'support': 288041}, '2': {'precision': 0.4609071753354774, 'recall': 0.23755039187140028, 'f1-score': 0.3135156243066465, 'support': 297419}, 'accuracy': 0.38495510504436936, 'macro avg': {'precision': 0.41331035201035565, 'recall': 0.3867624664620721, 'f1-score': 0.36740082846164895, 'support': 875154}, 'weighted avg': {'precision': 0.41385575333577923, 'recall': 0.38495510504436936, 'f1-score': 0.36676622841488526, 'support': 875154}}
[[ 80075 172528  37091]
 [ 56327 186168  45546]
 [ 48943 177824  70652]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901364
{'0': {'precision': 0.4169308117675858, 'recall': 0.23037678786953927, 'f1-score': 0.29677136876718696, 'support': 288332}, '1': {'precision': 0.3394851819793084, 'recall': 0.68461884805874, 'f1-score': 0.4538952047890112, 'support': 288730}, '2': {'precision': 0.45727740302910064, 'recall': 0.20489982958281336, 'f1-score': 0.2829939096007765, 'support': 298092}, 'accuracy': 0.37156203365350554, 'macro avg': {'precision': 0.40456446559199827, 'recall': 0.37329848850369757, 'f1-score': 0.34455349438565824, 'support': 875154}, 'weighted avg': {'precision': 0.40512274072358456, 'recall': 0.37156203365350554, 'f1-score': 0.343916688124406, 'support': 875154}}
[[ 66425 190157  31750]
 [ 50318 197670  40742]
 [ 42576 194437  61079]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0952177
{'0': {'precision': 0.3901734752653745, 'recall': 0.18219735077129443, 'f1-score': 0.24840040861910082, 'support': 286272}, '1': {'precision': 0.33570203806317805, 'recall': 0.7348171503675621, 'f1-score': 0.4608597728057014, 'support': 289883}, '2': {'precision': 0.4537965984422773, 'recall': 0.16232161311576293, 'f1-score': 0.23911319127971423, 'support': 298999}, 'accuracy': 0.3584546262714905, 'macro avg': {'precision': 0.3932240372569433, 'recall': 0.3597787047515398, 'f1-score': 0.31612445756817215, 'support': 875154}, 'weighted avg': {'precision': 0.39386757547663614, 'recall': 0.3584546262714905, 'f1-score': 0.31560171167118656, 'support': 875154}}
[[ 52158 207874  26240]
 [ 44695 213011  32177]
 [ 36826 213639  48534]]
Evaluating performance on  val set...
1396/1396 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0785028
{'0': {'precision': 0.45038272696776555, 'recall': 0.2541166956312267, 'f1-score': 0.3249108989307872, 'support': 116234}, '1': {'precision': 0.3710701262670306, 'recall': 0.7220235981216211, 'f1-score': 0.49020753069021494, 'support': 126705}, '2': {'precision': 0.4543783089294021, 'recall': 0.17941518626396213, 'f1-score': 0.2572521477393867, 'support': 114327}, 'accuracy': 0.3961558054782711, 'macro avg': {'precision': 0.42527705405473276, 'recall': 0.3851851600056033, 'f1-score': 0.35745685912012964, 'support': 357266}, 'weighted avg': {'precision': 0.42353298427504193, 'recall': 0.3961558054782711, 'f1-score': 0.3618824766337285, 'support': 357266}}
[[29537 76949  9748]
 [20338 91484 14883]
 [15707 78108 20512]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.087412
{'0': {'precision': 0.44205273892773894, 'recall': 0.20506365471855914, 'f1-score': 0.2801627376864703, 'support': 118373}, '1': {'precision': 0.3508235096120746, 'recall': 0.7481544924344385, 'f1-score': 0.47766230857964204, 'support': 122595}, '2': {'precision': 0.44901251466562375, 'recall': 0.1579562847168481, 'f1-score': 0.2337001463011259, 'support': 116298}, 'accuracy': 0.3760895243320103, 'macro avg': {'precision': 0.41396292106847915, 'recall': 0.3703914772899486, 'f1-score': 0.33050839752241273, 'support': 357266}, 'weighted avg': {'precision': 0.41301320152650467, 'recall': 0.3760895243320103, 'f1-score': 0.3328096546635003, 'support': 357266}}
[[24274 85185  8914]
 [17247 91720 13628]
 [13391 84537 18370]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0913016
{'0': {'precision': 0.4313838131642325, 'recall': 0.16457894293180478, 'f1-score': 0.23825882151944305, 'support': 118630}, '1': {'precision': 0.3440598921766208, 'recall': 0.7789426870146021, 'f1-score': 0.4772970995294147, 'support': 121421}, '2': {'precision': 0.4444264812868806, 'recall': 0.1407157786972657, 'f1-score': 0.21375252708516929, 'support': 117215}, 'accuracy': 0.36554835892584236, 'macro avg': {'precision': 0.406623395542578, 'recall': 0.36141246954789086, 'f1-score': 0.30976948271134236, 'support': 357266}, 'weighted avg': {'precision': 0.4059849185976054, 'recall': 0.36554835892584236, 'f1-score': 0.31145851433134053, 'support': 357266}}
[[19524 90961  8145]
 [14367 94580 12474]
 [11368 89353 16494]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.092096
{'0': {'precision': 0.4065906562847608, 'recall': 0.12596274790220033, 'f1-score': 0.19233855584934947, 'support': 116074}, '1': {'precision': 0.3565780807652387, 'recall': 0.8228076736395681, 'f1-score': 0.49753896044534474, 'support': 125677}, '2': {'precision': 0.43596869509662994, 'recall': 0.11814915811799333, 'f1-score': 0.1859147255142351, 'support': 115515}, 'accuracy': 0.3685685175751401, 'macro avg': {'precision': 0.39971247738220983, 'recall': 0.35563985988658725, 'f1-score': 0.2919307472696431, 'support': 357266}, 'weighted avg': {'precision': 0.39849633356663505, 'recall': 0.3685685175751401, 'f1-score': 0.2976231966694951, 'support': 357266}}
[[ 14621  94137   7316]
 [ 11928 103408  10341]
 [  9411  92456  13648]]
training model: results/AAPL/W9/deepOF_L1/seq2seq
Epoch 1/50
3419/3419 - 76s - loss: 12.7320 - accuracy10: 0.4452 - accuracy20: 0.4314 - accuracy30: 0.4199 - accuracy50: 0.4357 - val_loss: 13.0004 - val_accuracy10: 0.4144 - val_accuracy20: 0.3881 - val_accuracy30: 0.3705 - val_accuracy50: 0.3698 - 76s/epoch - 22ms/step
Epoch 2/50
3419/3419 - 78s - loss: 12.6914 - accuracy10: 0.4500 - accuracy20: 0.4351 - accuracy30: 0.4227 - accuracy50: 0.4387 - val_loss: 12.9854 - val_accuracy10: 0.4165 - val_accuracy20: 0.3879 - val_accuracy30: 0.3732 - val_accuracy50: 0.3731 - 78s/epoch - 23ms/step
Epoch 3/50
3419/3419 - 82s - loss: 12.6821 - accuracy10: 0.4514 - accuracy20: 0.4359 - accuracy30: 0.4239 - accuracy50: 0.4389 - val_loss: 12.9614 - val_accuracy10: 0.4206 - val_accuracy20: 0.3926 - val_accuracy30: 0.3784 - val_accuracy50: 0.3769 - 82s/epoch - 24ms/step
Epoch 4/50
3419/3419 - 72s - loss: 12.6728 - accuracy10: 0.4527 - accuracy20: 0.4365 - accuracy30: 0.4250 - accuracy50: 0.4399 - val_loss: 12.9552 - val_accuracy10: 0.4225 - val_accuracy20: 0.3950 - val_accuracy30: 0.3798 - val_accuracy50: 0.3773 - 72s/epoch - 21ms/step
Epoch 5/50
3419/3419 - 66s - loss: 12.6672 - accuracy10: 0.4535 - accuracy20: 0.4376 - accuracy30: 0.4252 - accuracy50: 0.4396 - val_loss: 12.9380 - val_accuracy10: 0.4252 - val_accuracy20: 0.3987 - val_accuracy30: 0.3839 - val_accuracy50: 0.3809 - 66s/epoch - 19ms/step
Epoch 6/50
3419/3419 - 76s - loss: 12.6560 - accuracy10: 0.4552 - accuracy20: 0.4382 - accuracy30: 0.4263 - accuracy50: 0.4400 - val_loss: 12.9316 - val_accuracy10: 0.4259 - val_accuracy20: 0.3990 - val_accuracy30: 0.3851 - val_accuracy50: 0.3816 - 76s/epoch - 22ms/step
Epoch 7/50
3419/3419 - 81s - loss: 12.6485 - accuracy10: 0.4561 - accuracy20: 0.4391 - accuracy30: 0.4270 - accuracy50: 0.4404 - val_loss: 12.9223 - val_accuracy10: 0.4275 - val_accuracy20: 0.4015 - val_accuracy30: 0.3875 - val_accuracy50: 0.3815 - 81s/epoch - 24ms/step
Epoch 8/50
3419/3419 - 80s - loss: 12.6406 - accuracy10: 0.4578 - accuracy20: 0.4397 - accuracy30: 0.4275 - accuracy50: 0.4401 - val_loss: 12.9176 - val_accuracy10: 0.4281 - val_accuracy20: 0.4027 - val_accuracy30: 0.3884 - val_accuracy50: 0.3831 - 80s/epoch - 23ms/step
Epoch 9/50
3419/3419 - 79s - loss: 12.6329 - accuracy10: 0.4588 - accuracy20: 0.4402 - accuracy30: 0.4282 - accuracy50: 0.4407 - val_loss: 12.9234 - val_accuracy10: 0.4247 - val_accuracy20: 0.4025 - val_accuracy30: 0.3890 - val_accuracy50: 0.3840 - 79s/epoch - 23ms/step
Epoch 10/50
3419/3419 - 82s - loss: 12.6265 - accuracy10: 0.4593 - accuracy20: 0.4413 - accuracy30: 0.4286 - accuracy50: 0.4410 - val_loss: 12.9216 - val_accuracy10: 0.4265 - val_accuracy20: 0.4040 - val_accuracy30: 0.3906 - val_accuracy50: 0.3844 - 82s/epoch - 24ms/step
Epoch 11/50
3419/3419 - 78s - loss: 12.6212 - accuracy10: 0.4605 - accuracy20: 0.4422 - accuracy30: 0.4292 - accuracy50: 0.4413 - val_loss: 12.9175 - val_accuracy10: 0.4269 - val_accuracy20: 0.4039 - val_accuracy30: 0.3896 - val_accuracy50: 0.3837 - 78s/epoch - 23ms/step
Epoch 12/50
3419/3419 - 79s - loss: 12.6189 - accuracy10: 0.4606 - accuracy20: 0.4418 - accuracy30: 0.4292 - accuracy50: 0.4415 - val_loss: 12.9190 - val_accuracy10: 0.4264 - val_accuracy20: 0.4051 - val_accuracy30: 0.3909 - val_accuracy50: 0.3849 - 79s/epoch - 23ms/step
Epoch 13/50
3419/3419 - 73s - loss: 12.6147 - accuracy10: 0.4614 - accuracy20: 0.4422 - accuracy30: 0.4297 - accuracy50: 0.4414 - val_loss: 12.9192 - val_accuracy10: 0.4266 - val_accuracy20: 0.4059 - val_accuracy30: 0.3921 - val_accuracy50: 0.3847 - 73s/epoch - 21ms/step
Epoch 14/50
3419/3419 - 72s - loss: 12.6112 - accuracy10: 0.4613 - accuracy20: 0.4427 - accuracy30: 0.4301 - accuracy50: 0.4416 - val_loss: 12.9131 - val_accuracy10: 0.4273 - val_accuracy20: 0.4070 - val_accuracy30: 0.3932 - val_accuracy50: 0.3873 - 72s/epoch - 21ms/step
Epoch 15/50
3419/3419 - 79s - loss: 12.6074 - accuracy10: 0.4618 - accuracy20: 0.4431 - accuracy30: 0.4305 - accuracy50: 0.4414 - val_loss: 12.9147 - val_accuracy10: 0.4257 - val_accuracy20: 0.4065 - val_accuracy30: 0.3953 - val_accuracy50: 0.3892 - 79s/epoch - 23ms/step
Epoch 16/50
3419/3419 - 76s - loss: 12.6019 - accuracy10: 0.4626 - accuracy20: 0.4438 - accuracy30: 0.4312 - accuracy50: 0.4422 - val_loss: 12.9214 - val_accuracy10: 0.4243 - val_accuracy20: 0.4047 - val_accuracy30: 0.3939 - val_accuracy50: 0.3879 - 76s/epoch - 22ms/step
Epoch 17/50
3419/3419 - 74s - loss: 12.5975 - accuracy10: 0.4630 - accuracy20: 0.4443 - accuracy30: 0.4316 - accuracy50: 0.4428 - val_loss: 12.9170 - val_accuracy10: 0.4256 - val_accuracy20: 0.4071 - val_accuracy30: 0.3947 - val_accuracy50: 0.3892 - 74s/epoch - 22ms/step
Epoch 18/50
3419/3419 - 80s - loss: 12.5932 - accuracy10: 0.4632 - accuracy20: 0.4447 - accuracy30: 0.4321 - accuracy50: 0.4432 - val_loss: 12.9190 - val_accuracy10: 0.4249 - val_accuracy20: 0.4071 - val_accuracy30: 0.3955 - val_accuracy50: 0.3882 - 80s/epoch - 24ms/step
Epoch 19/50
3419/3419 - 77s - loss: 12.5891 - accuracy10: 0.4638 - accuracy20: 0.4448 - accuracy30: 0.4320 - accuracy50: 0.4433 - val_loss: 12.9197 - val_accuracy10: 0.4255 - val_accuracy20: 0.4066 - val_accuracy30: 0.3961 - val_accuracy50: 0.3895 - 77s/epoch - 23ms/step
Epoch 20/50
3419/3419 - 79s - loss: 12.5864 - accuracy10: 0.4639 - accuracy20: 0.4454 - accuracy30: 0.4325 - accuracy50: 0.4434 - val_loss: 12.9182 - val_accuracy10: 0.4251 - val_accuracy20: 0.4069 - val_accuracy30: 0.3951 - val_accuracy50: 0.3884 - 79s/epoch - 23ms/step
Epoch 21/50
3419/3419 - 78s - loss: 12.5822 - accuracy10: 0.4649 - accuracy20: 0.4456 - accuracy30: 0.4330 - accuracy50: 0.4439 - val_loss: 12.9234 - val_accuracy10: 0.4245 - val_accuracy20: 0.4058 - val_accuracy30: 0.3944 - val_accuracy50: 0.3882 - 78s/epoch - 23ms/step
Epoch 22/50
3419/3419 - 77s - loss: 12.5754 - accuracy10: 0.4655 - accuracy20: 0.4465 - accuracy30: 0.4335 - accuracy50: 0.4447 - val_loss: 12.9224 - val_accuracy10: 0.4267 - val_accuracy20: 0.4067 - val_accuracy30: 0.3941 - val_accuracy50: 0.3878 - 77s/epoch - 23ms/step
Epoch 23/50
3419/3419 - 78s - loss: 12.5724 - accuracy10: 0.4657 - accuracy20: 0.4467 - accuracy30: 0.4339 - accuracy50: 0.4451 - val_loss: 12.9238 - val_accuracy10: 0.4271 - val_accuracy20: 0.4074 - val_accuracy30: 0.3950 - val_accuracy50: 0.3881 - 78s/epoch - 23ms/step
Epoch 24/50
3419/3419 - 76s - loss: 12.5656 - accuracy10: 0.4663 - accuracy20: 0.4469 - accuracy30: 0.4342 - accuracy50: 0.4456 - val_loss: 12.9281 - val_accuracy10: 0.4261 - val_accuracy20: 0.4066 - val_accuracy30: 0.3944 - val_accuracy50: 0.3883 - 76s/epoch - 22ms/step
testing model: results/AAPL/W9/deepOF_L1/seq2seq
Evaluating performance on  test set...
10303/10303 - 103s - 103s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0748469
{'0': {'precision': 0.4536103256152532, 'recall': 0.19704821731542235, 'f1-score': 0.2747465840247247, 'support': 822215}, '1': {'precision': 0.4221459246401599, 'recall': 0.5041137275203863, 'f1-score': 0.45950302408509824, 'support': 987061}, '2': {'precision': 0.3813539934199537, 'recall': 0.5072501219624114, 'f1-score': 0.43538366821514524, 'support': 828124}, 'accuracy': 0.4093702130886479, 'macro avg': {'precision': 0.4190367478917889, 'recall': 0.4028040222660733, 'f1-score': 0.38987775877498937, 'support': 2637400}, 'weighted avg': {'precision': 0.4191466546007022, 'recall': 0.4093702130886479, 'f1-score': 0.39433151660625965, 'support': 2637400}}
[[162016 356462 303737]
 [111761 497591 377709]
 [ 83393 324665 420066]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0760307
{'0': {'precision': 0.4577061311643752, 'recall': 0.2015060057240656, 'f1-score': 0.27982049821378446, 'support': 836119}, '1': {'precision': 0.388406473269887, 'recall': 0.5138970119724079, 'f1-score': 0.4424252578178553, 'support': 955781}, '2': {'precision': 0.3967475256590943, 'recall': 0.47145712596096984, 'f1-score': 0.43088791987080405, 'support': 845500}, 'accuracy': 0.40125616137104725, 'macro avg': {'precision': 0.4142867100311188, 'recall': 0.39562004788581445, 'f1-score': 0.38437789196748123, 'support': 2637400}, 'weighted avg': {'precision': 0.4130501073239388, 'recall': 0.40125616137104725, 'f1-score': 0.38717700263106986, 'support': 2637400}}
[[168483 408705 258931]
 [117444 491173 347164]
 [ 82176 364707 398617]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0803452
{'0': {'precision': 0.4593176826538155, 'recall': 0.20227040712156477, 'f1-score': 0.2808586675133893, 'support': 857115}, '1': {'precision': 0.3593610081301293, 'recall': 0.5345140840898169, 'f1-score': 0.42977709478676335, 'support': 911454}, '2': {'precision': 0.41524219438586324, 'recall': 0.43217150400941035, 'f1-score': 0.42353774553264256, 'support': 868831}, 'accuracy': 0.39282550997194204, 'macro avg': {'precision': 0.41130696172326936, 'recall': 0.38965199840693066, 'f1-score': 0.37805783594426506, 'support': 2637400}, 'weighted avg': {'precision': 0.41025418778438155, 'recall': 0.39282550997194204, 'f1-score': 0.3793254538357415, 'support': 2637400}}
[[173369 459653 224093]
 [119593 487185 304676]
 [ 84487 408860 375484]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802228
{'0': {'precision': 0.41663001551986495, 'recall': 0.20391630954383952, 'f1-score': 0.27381567428114834, 'support': 808312}, '1': {'precision': 0.3902297816849158, 'recall': 0.5516307073764964, 'f1-score': 0.4571010951414697, 'support': 1006833}, '2': {'precision': 0.39041726836682084, 'recall': 0.388640993365805, 'f1-score': 0.38952710588754413, 'support': 822255}, 'accuracy': 0.3942481231515887, 'macro avg': {'precision': 0.3990923551905339, 'recall': 0.38139600342871366, 'f1-score': 0.373481291770054, 'support': 2637400}, 'weighted avg': {'precision': 0.39837939405817174, 'recall': 0.3942481231515887, 'f1-score': 0.3798603066223089, 'support': 2637400}}
[[164828 452381 191103]
 [143584 555400 307849]
 [ 87210 415483 319562]]
Evaluating performance on  train set...
3419/3419 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0729707
{'0': {'precision': 0.45374362577581895, 'recall': 0.2934819282915711, 'f1-score': 0.35642665997658474, 'support': 290454}, '1': {'precision': 0.39280869681511627, 'recall': 0.5693418023849496, 'f1-score': 0.46488031056084955, 'support': 288895}, '2': {'precision': 0.4142218283505673, 'recall': 0.37606996524725833, 'f1-score': 0.39422499348823364, 'support': 295804}, 'accuracy': 0.41246044977278257, 'macro avg': {'precision': 0.4202580503138342, 'recall': 0.41296456530792636, 'f1-score': 0.4051773213418893, 'support': 875153}, 'weighted avg': {'precision': 0.4202700479355083, 'recall': 0.41246044977278257, 'f1-score': 0.40500401231568545, 'support': 875153}}
[[ 85243 124859  80352]
 [ 47451 164480  76964]
 [ 55172 129389 111243]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0802534
{'0': {'precision': 0.4479809217483257, 'recall': 0.2808347115142266, 'f1-score': 0.34524120279880555, 'support': 289633}, '1': {'precision': 0.3620271768843754, 'recall': 0.5679811919628285, 'f1-score': 0.44219952064433193, 'support': 287962}, '2': {'precision': 0.4192196985988652, 'recall': 0.34066971817259156, 'f1-score': 0.37588484172040304, 'support': 297558}, 'accuracy': 0.39566224420187096, 'macro avg': {'precision': 0.4097425990771888, 'recall': 0.39649520721654885, 'f1-score': 0.38777518838784686, 'support': 875153}, 'weighted avg': {'precision': 0.40991952640783097, 'recall': 0.39566224420187096, 'f1-score': 0.38756359789276756, 'support': 875153}}
[[ 81339 141880  66414]
 [ 50384 163557  74021]
 [ 49845 146344 101369]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0826328
{'0': {'precision': 0.4492346051258263, 'recall': 0.2685535027210649, 'f1-score': 0.3361535958346893, 'support': 288490}, '1': {'precision': 0.34611567688072237, 'recall': 0.5888395441796933, 'f1-score': 0.43597082045648217, 'support': 288447}, '2': {'precision': 0.4287756411466098, 'recall': 0.30476231992917885, 'f1-score': 0.3562860166999882, 'support': 298216}, 'accuracy': 0.3864569966622979, 'macro avg': {'precision': 0.40804197438438616, 'recall': 0.38738512227664573, 'f1-score': 0.37613681099705326, 'support': 875153}, 'weighted avg': {'precision': 0.40827544038829866, 'recall': 0.3864569966622979, 'f1-score': 0.37591325958633987, 'support': 875153}}
[[ 77475 157687  53328]
 [ 50847 169849  67751]
 [ 44138 163193  90885]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0864427
{'0': {'precision': 0.439902199901479, 'recall': 0.25579876199924545, 'f1-score': 0.3234908223444437, 'support': 286268}, '1': {'precision': 0.3386491089443119, 'recall': 0.608649941745431, 'f1-score': 0.4351714704686325, 'support': 290106}, '2': {'precision': 0.42839065178042257, 'recall': 0.2685329290211159, 'f1-score': 0.3301280073076496, 'support': 298779}, 'accuracy': 0.3771134875844567, 'macro avg': {'precision': 0.4023139868754045, 'recall': 0.3776605442552641, 'f1-score': 0.3629301000402419, 'support': 875153}, 'weighted avg': {'precision': 0.40240756977248315, 'recall': 0.3771134875844567, 'f1-score': 0.36277798423595026, 'support': 875153}}
[[ 73227 167996  45045]
 [ 51523 176573  62010]
 [ 41712 176835  80232]]
Evaluating performance on  val set...
1396/1396 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0662497
{'0': {'precision': 0.4508222269321398, 'recall': 0.311088551838055, 'f1-score': 0.36814188122944724, 'support': 116237}, '1': {'precision': 0.4273254776994328, 'recall': 0.5666120106579217, 'f1-score': 0.48720920774361476, 'support': 126854}, '2': {'precision': 0.4080749621055533, 'recall': 0.38906065250711624, 'f1-score': 0.3983410303546608, 'support': 114175}, 'accuracy': 0.4267352616817721, 'macro avg': {'precision': 0.42874088891237533, 'recall': 0.4222537383343643, 'f1-score': 0.41789737310924097, 'support': 357266}, 'weighted avg': {'precision': 0.4288181023058353, 'recall': 0.4267352616817721, 'f1-score': 0.4200700089801973, 'support': 357266}}
[[36160 49199 30878]
 [21421 71877 33556]
 [22628 47126 44421]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0753264
{'0': {'precision': 0.45144917345334135, 'recall': 0.29834566899861437, 'f1-score': 0.35926602330940666, 'support': 118356}, '1': {'precision': 0.3807646718306365, 'recall': 0.5636302800809558, 'f1-score': 0.4544931084064609, 'support': 122536}, '2': {'precision': 0.4178714777195282, 'recall': 0.3506882980734528, 'f1-score': 0.38134349975238047, 'support': 116374}, 'accuracy': 0.40638347897644894, 'macro avg': {'precision': 0.41669510766783535, 'recall': 0.4042214157176744, 'f1-score': 0.39836754382274936, 'support': 357266}, 'weighted avg': {'precision': 0.41626819666247256, 'recall': 0.40638347897644894, 'f1-score': 0.3991186550824477, 'support': 357266}}
[[35311 57374 25671]
 [22289 69065 31182]
 [20617 54946 40811]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0792776
{'0': {'precision': 0.45082928243027837, 'recall': 0.2882556582239031, 'f1-score': 0.3516621281405744, 'support': 118721}, '1': {'precision': 0.35725072072484326, 'recall': 0.5785915446565325, 'f1-score': 0.4417459094981374, 'support': 121438}, '2': {'precision': 0.42942843646669815, 'recall': 0.3105194394869649, 'f1-score': 0.3604196504234663, 'support': 117107}, 'accuracy': 0.3942412656116171, 'macro avg': {'precision': 0.4125028132072733, 'recall': 0.3924555474558002, 'f1-score': 0.38460922935405933, 'support': 357266}, 'weighted avg': {'precision': 0.4120061583584618, 'recall': 0.3942412656116171, 'f1-score': 0.38515303240373505, 'support': 357266}}
[[34222 64118 20381]
 [23240 70263 27935]
 [18447 62296 36364]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822089
{'0': {'precision': 0.43141875967948284, 'recall': 0.2760400510116155, 'f1-score': 0.3366665440577593, 'support': 116052}, '1': {'precision': 0.35982133433125113, 'recall': 0.5967599481209768, 'f1-score': 0.44894660756455185, 'support': 125677}, '2': {'precision': 0.4214436086192794, 'recall': 0.272034067008837, 'f1-score': 0.33064371903173884, 'support': 115537}, 'accuracy': 0.3875655673923631, 'macro avg': {'precision': 0.40422790087667115, 'recall': 0.38161135538047647, 'f1-score': 0.37208562355135005, 'support': 357266}, 'weighted avg': {'precision': 0.4030067399140071, 'recall': 0.3875655673923631, 'f1-score': 0.37421605172518874, 'support': 357266}}
[[32035 66756 17261]
 [24792 74999 25886]
 [17428 66679 31430]]
training model: results/AAPL/W9/deepLOB_L2/seq2seq
Epoch 1/50
3419/3419 - 173s - loss: 12.7012 - accuracy10: 0.4434 - accuracy20: 0.4288 - accuracy30: 0.4162 - accuracy50: 0.4290 - val_loss: 13.1982 - val_accuracy10: 0.3958 - val_accuracy20: 0.3923 - val_accuracy30: 0.3835 - val_accuracy50: 0.3802 - 173s/epoch - 51ms/step
Epoch 2/50
3419/3419 - 167s - loss: 12.5806 - accuracy10: 0.4616 - accuracy20: 0.4432 - accuracy30: 0.4283 - accuracy50: 0.4366 - val_loss: 13.3972 - val_accuracy10: 0.4184 - val_accuracy20: 0.4047 - val_accuracy30: 0.3911 - val_accuracy50: 0.3816 - 167s/epoch - 49ms/step
Epoch 3/50
3419/3419 - 166s - loss: 12.5154 - accuracy10: 0.4714 - accuracy20: 0.4504 - accuracy30: 0.4347 - accuracy50: 0.4409 - val_loss: 13.3179 - val_accuracy10: 0.4220 - val_accuracy20: 0.4072 - val_accuracy30: 0.3949 - val_accuracy50: 0.3879 - 166s/epoch - 49ms/step
Epoch 4/50
3419/3419 - 165s - loss: 12.4688 - accuracy10: 0.4772 - accuracy20: 0.4551 - accuracy30: 0.4387 - accuracy50: 0.4450 - val_loss: 13.2132 - val_accuracy10: 0.4367 - val_accuracy20: 0.4175 - val_accuracy30: 0.4015 - val_accuracy50: 0.3970 - 165s/epoch - 48ms/step
Epoch 5/50
3419/3419 - 160s - loss: 12.4351 - accuracy10: 0.4811 - accuracy20: 0.4586 - accuracy30: 0.4422 - accuracy50: 0.4485 - val_loss: 12.9949 - val_accuracy10: 0.4421 - val_accuracy20: 0.4202 - val_accuracy30: 0.4031 - val_accuracy50: 0.3974 - 160s/epoch - 47ms/step
Epoch 6/50
3419/3419 - 163s - loss: 12.4099 - accuracy10: 0.4841 - accuracy20: 0.4613 - accuracy30: 0.4447 - accuracy50: 0.4509 - val_loss: 13.0389 - val_accuracy10: 0.4415 - val_accuracy20: 0.4157 - val_accuracy30: 0.3953 - val_accuracy50: 0.3898 - 163s/epoch - 48ms/step
Epoch 7/50
3419/3419 - 163s - loss: 12.3818 - accuracy10: 0.4871 - accuracy20: 0.4643 - accuracy30: 0.4471 - accuracy50: 0.4540 - val_loss: 12.9832 - val_accuracy10: 0.4439 - val_accuracy20: 0.4164 - val_accuracy30: 0.3946 - val_accuracy50: 0.3888 - 163s/epoch - 48ms/step
Epoch 8/50
3419/3419 - 166s - loss: 12.3595 - accuracy10: 0.4893 - accuracy20: 0.4659 - accuracy30: 0.4487 - accuracy50: 0.4564 - val_loss: 12.9374 - val_accuracy10: 0.4432 - val_accuracy20: 0.4063 - val_accuracy30: 0.3835 - val_accuracy50: 0.3810 - 166s/epoch - 48ms/step
Epoch 9/50
3419/3419 - 162s - loss: 12.3365 - accuracy10: 0.4916 - accuracy20: 0.4675 - accuracy30: 0.4507 - accuracy50: 0.4579 - val_loss: 13.0519 - val_accuracy10: 0.4355 - val_accuracy20: 0.4054 - val_accuracy30: 0.3858 - val_accuracy50: 0.3818 - 162s/epoch - 47ms/step
Epoch 10/50
3419/3419 - 162s - loss: 12.3210 - accuracy10: 0.4933 - accuracy20: 0.4687 - accuracy30: 0.4514 - accuracy50: 0.4583 - val_loss: 13.0329 - val_accuracy10: 0.4307 - val_accuracy20: 0.3965 - val_accuracy30: 0.3782 - val_accuracy50: 0.3768 - 162s/epoch - 47ms/step
Epoch 11/50
3419/3419 - 161s - loss: 12.3039 - accuracy10: 0.4947 - accuracy20: 0.4698 - accuracy30: 0.4526 - accuracy50: 0.4596 - val_loss: 13.0995 - val_accuracy10: 0.4281 - val_accuracy20: 0.3968 - val_accuracy30: 0.3804 - val_accuracy50: 0.3781 - 161s/epoch - 47ms/step
Epoch 12/50
3419/3419 - 158s - loss: 12.2893 - accuracy10: 0.4959 - accuracy20: 0.4716 - accuracy30: 0.4539 - accuracy50: 0.4603 - val_loss: 13.1090 - val_accuracy10: 0.4258 - val_accuracy20: 0.3933 - val_accuracy30: 0.3761 - val_accuracy50: 0.3751 - 158s/epoch - 46ms/step
Epoch 13/50
3419/3419 - 158s - loss: 12.2765 - accuracy10: 0.4971 - accuracy20: 0.4722 - accuracy30: 0.4549 - accuracy50: 0.4616 - val_loss: 13.1894 - val_accuracy10: 0.4233 - val_accuracy20: 0.3942 - val_accuracy30: 0.3776 - val_accuracy50: 0.3758 - 158s/epoch - 46ms/step
Epoch 14/50
3419/3419 - 162s - loss: 12.2635 - accuracy10: 0.4982 - accuracy20: 0.4737 - accuracy30: 0.4560 - accuracy50: 0.4623 - val_loss: 13.2549 - val_accuracy10: 0.4173 - val_accuracy20: 0.3891 - val_accuracy30: 0.3741 - val_accuracy50: 0.3722 - 162s/epoch - 48ms/step
Epoch 15/50
3419/3419 - 162s - loss: 12.2514 - accuracy10: 0.4994 - accuracy20: 0.4748 - accuracy30: 0.4570 - accuracy50: 0.4636 - val_loss: 13.1742 - val_accuracy10: 0.4233 - val_accuracy20: 0.3949 - val_accuracy30: 0.3795 - val_accuracy50: 0.3775 - 162s/epoch - 47ms/step
Epoch 16/50
3419/3419 - 160s - loss: 12.2406 - accuracy10: 0.5007 - accuracy20: 0.4757 - accuracy30: 0.4579 - accuracy50: 0.4640 - val_loss: 13.1864 - val_accuracy10: 0.4241 - val_accuracy20: 0.3968 - val_accuracy30: 0.3811 - val_accuracy50: 0.3790 - 160s/epoch - 47ms/step
Epoch 17/50
3419/3419 - 159s - loss: 12.2289 - accuracy10: 0.5014 - accuracy20: 0.4766 - accuracy30: 0.4588 - accuracy50: 0.4653 - val_loss: 13.1271 - val_accuracy10: 0.4237 - val_accuracy20: 0.3945 - val_accuracy30: 0.3781 - val_accuracy50: 0.3766 - 159s/epoch - 46ms/step
Epoch 18/50
3419/3419 - 158s - loss: 12.2195 - accuracy10: 0.5022 - accuracy20: 0.4777 - accuracy30: 0.4598 - accuracy50: 0.4659 - val_loss: 13.2170 - val_accuracy10: 0.4186 - val_accuracy20: 0.3909 - val_accuracy30: 0.3768 - val_accuracy50: 0.3758 - 158s/epoch - 46ms/step
testing model: results/AAPL/W9/deepLOB_L2/seq2seq
Evaluating performance on  test set...
10303/10303 - 167s - 167s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0546085
{'0': {'precision': 0.43590821604483515, 'recall': 0.4123509973644427, 'f1-score': 0.42380249999999997, 'support': 822217}, '1': {'precision': 0.4640547093443873, 'recall': 0.48088468606835233, 'f1-score': 0.47231982136620226, 'support': 987062}, '2': {'precision': 0.43478484298383885, 'recall': 0.4393189433962264, 'f1-score': 0.43704013367882244, 'support': 828125}, 'accuracy': 0.44646781456310825, 'macro avg': {'precision': 0.44491592279102044, 'recall': 0.4441848756096738, 'f1-score': 0.4443874850150082, 'support': 2637404}, 'weighted avg': {'precision': 0.44608945511670467, 'recall': 0.44646781456310825, 'f1-score': 0.44611687415452506, 'support': 2637404}}
[[339042 253946 229229]
 [268678 474663 243721]
 [170063 294251 363811]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0698339
{'0': {'precision': 0.44007897180581673, 'recall': 0.33724066253568563, 'f1-score': 0.3818571343448515, 'support': 836121}, '1': {'precision': 0.4117507977148505, 'recall': 0.6067377288963383, 'f1-score': 0.490579397507804, 'support': 955782}, '2': {'precision': 0.4453270686469331, 'recall': 0.3098435128994525, 'f1-score': 0.36543188177757685, 'support': 845501}, 'accuracy': 0.4261220503191775, 'macro avg': {'precision': 0.43238561272253345, 'recall': 0.4179406347771588, 'f1-score': 0.41262280454341077, 'support': 2637404}, 'weighted avg': {'precision': 0.4314954223148206, 'recall': 0.4261220503191775, 'f1-score': 0.41599191788940126, 'support': 2637404}}
[[281974 394030 160117]
 [209692 579909 166181]
 [149069 434459 261973]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850618
{'0': {'precision': 0.451095438390691, 'recall': 0.25662774160353835, 'f1-score': 0.32714373889182213, 'support': 857117}, '1': {'precision': 0.3705013361530221, 'recall': 0.7327317311331881, 'f1-score': 0.49215001521729035, 'support': 911455}, '2': {'precision': 0.46917875286555233, 'recall': 0.18750690582298996, 'f1-score': 0.2679341479861191, 'support': 868832}, 'accuracy': 0.3983932685322385, 'macro avg': {'precision': 0.4302585091364219, 'recall': 0.3922887928532388, 'f1-score': 0.36240930069841054, 'support': 2637404}, 'weighted avg': {'precision': 0.429200220527515, 'recall': 0.3983932685322385, 'f1-score': 0.36466268111775557, 'support': 2637404}}
[[219960 546653  90504]
 [149791 667852  93812]
 [117862 588058 162912]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812411
{'0': {'precision': 0.4232827969863252, 'recall': 0.18675910599098866, 'f1-score': 0.2591688090956303, 'support': 808314}, '1': {'precision': 0.3984422648775498, 'recall': 0.8220957973211076, 'f1-score': 0.5367431325179325, 'support': 1006834}, '2': {'precision': 0.46156115405038645, 'recall': 0.11416882333482517, 'f1-score': 0.18305766913275953, 'support': 822256}, 'accuracy': 0.4066688304105097, 'macro avg': {'precision': 0.4277620719714205, 'recall': 0.37434124221564047, 'f1-score': 0.3263232035821074, 'support': 2637404}, 'weighted avg': {'precision': 0.4257338118709845, 'recall': 0.4066688304105097, 'f1-score': 0.3414043804556722, 'support': 2637404}}
[[150960 605818  51536]
 [121144 827714  57976]
 [ 84537 643843  93876]]
Evaluating performance on  train set...
3419/3419 - 57s - 57s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0450505
{'0': {'precision': 0.469269690828604, 'recall': 0.36724015150733286, 'f1-score': 0.41203262325391105, 'support': 290679}, '1': {'precision': 0.453790657369715, 'recall': 0.4292591796698993, 'f1-score': 0.44118417138816507, 'support': 288518}, '2': {'precision': 0.4478030921617915, 'recall': 0.5670283183029967, 'f1-score': 0.5004122490908901, 'support': 295957}, 'accuracy': 0.455250161685829, 'macro avg': {'precision': 0.45695448012003687, 'recall': 0.45450921649340964, 'f1-score': 0.4512096812443221, 'support': 875154}, 'weighted avg': {'precision': 0.4569071010248374, 'recall': 0.455250161685829, 'f1-score': 0.45153117469563847, 'support': 875154}}
[[106749  75665 108265]
 [ 65996 123849  98673]
 [ 54734  73407 167816]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0614746
{'0': {'precision': 0.4626227919474913, 'recall': 0.3262684073539666, 'f1-score': 0.3826616437551999, 'support': 289694}, '1': {'precision': 0.4194410580185609, 'recall': 0.4407566978312115, 'f1-score': 0.42983477789815816, 'support': 288041}, '2': {'precision': 0.43446977722005836, 'recall': 0.5378170190875499, 'f1-score': 0.4806508560138825, 'support': 297419}, 'accuracy': 0.4358444342367172, 'macro avg': {'precision': 0.4388445423953702, 'recall': 0.434947374757576, 'f1-score': 0.43104909255574686, 'support': 875154}, 'weighted avg': {'precision': 0.43884257576857716, 'recall': 0.4358444342367172, 'f1-score': 0.43148922181853155, 'support': 875154}}
[[ 94518  88258 106918]
 [ 59794 126956 101291]
 [ 49997  87465 159957]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0710732
{'0': {'precision': 0.4609823101414959, 'recall': 0.27818625750870524, 'f1-score': 0.34698159323426986, 'support': 288332}, '1': {'precision': 0.3976151591106919, 'recall': 0.47304402036504695, 'f1-score': 0.4320622302220859, 'support': 288730}, '2': {'precision': 0.42452880305771235, 'recall': 0.50935281725105, 'f1-score': 0.4630885481399019, 'support': 298092}, 'accuracy': 0.42121272370348534, 'macro avg': {'precision': 0.4277087574366334, 'recall': 0.42019436504160074, 'f1-score': 0.41404412386541917, 'support': 875154}, 'weighted avg': {'precision': 0.42765960767913697, 'recall': 0.42121272370348534, 'f1-score': 0.41459927734383434, 'support': 875154}}
[[ 80210 103018 105104]
 [ 51433 136582 100715]
 [ 42355 103903 151834]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0736932
{'0': {'precision': 0.4519810905580557, 'recall': 0.22243181310082719, 'f1-score': 0.29814071739934545, 'support': 286272}, '1': {'precision': 0.41246618719792827, 'recall': 0.5549411314219875, 'f1-score': 0.4732121582943324, 'support': 289883}, '2': {'precision': 0.43090481820267995, 'recall': 0.4961287495944802, 'f1-score': 0.4612222816421455, 'support': 298999}, 'accuracy': 0.4260804384142677, 'macro avg': {'precision': 0.43178403198622134, 'recall': 0.42450056470576497, 'f1-score': 0.4108583857786077, 'support': 875154}, 'weighted avg': {'precision': 0.43169153798933196, 'recall': 0.4260804384142677, 'f1-score': 0.4118480867629026, 'support': 875154}}
[[ 63676 114093 108503]
 [ 41603 160868  87412]
 [ 35603 115054 148342]]
Evaluating performance on  val set...
1396/1396 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0532537
{'0': {'precision': 0.45442426403783615, 'recall': 0.46043326393310047, 'f1-score': 0.45740902972158715, 'support': 116234}, '1': {'precision': 0.43077511867210694, 'recall': 0.5507754232271812, 'f1-score': 0.48343990079873644, 'support': 126705}, '2': {'precision': 0.4493122048158567, 'recall': 0.30455622906225127, 'f1-score': 0.3630363724514, 'support': 114327}, 'accuracy': 0.44259179434930834, 'macro avg': {'precision': 0.44483719584193326, 'recall': 0.438588305407511, 'f1-score': 0.4346284343239079, 'support': 357266}, 'weighted avg': {'precision': 0.444401168198221, 'recall': 0.44259179434930834, 'f1-score': 0.4364411758874734, 'support': 357266}}
[[53518 44802 17914]
 [32158 69786 24761]
 [32095 47413 34819]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0770938
{'0': {'precision': 0.45463662356505785, 'recall': 0.3599976345957271, 'f1-score': 0.401819853374508, 'support': 118373}, '1': {'precision': 0.3742129838831149, 'recall': 0.6079530160283861, 'f1-score': 0.46326977763274435, 'support': 122595}, '2': {'precision': 0.4350102541793549, 'recall': 0.24075220554093793, 'f1-score': 0.3099600358680852, 'support': 116298}, 'accuracy': 0.40626591951095264, 'macro avg': {'precision': 0.4212866205425092, 'recall': 0.4029009520550171, 'f1-score': 0.3916832222917792, 'support': 357266}, 'weighted avg': {'precision': 0.4206506198209953, 'recall': 0.40626591951095264, 'f1-score': 0.3930038462763697, 'support': 357266}}
[[42614 61491 14268]
 [25966 74532 22097]
 [25152 63147 27999]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0906745
{'0': {'precision': 0.4560212907518297, 'recall': 0.25999325634325215, 'f1-score': 0.33117332832255125, 'support': 118630}, '1': {'precision': 0.3516261548426687, 'recall': 0.6795694319763468, 'f1-score': 0.4634511422834436, 'support': 121421}, '2': {'precision': 0.4309858642458202, 'recall': 0.20210723883462015, 'f1-score': 0.2751739438501121, 'support': 117215}, 'accuracy': 0.3835993349493095, 'macro avg': {'precision': 0.4128777699467729, 'recall': 0.3805566423847397, 'f1-score': 0.356599471485369, 'support': 357266}, 'weighted avg': {'precision': 0.41232754627256735, 'recall': 0.3835993349493095, 'f1-score': 0.357756704848749, 'support': 357266}}
[[30843 75979 11808]
 [19438 82514 19469]
 [17354 76171 23690]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0955772
{'0': {'precision': 0.4549603914770358, 'recall': 0.17861881213708497, 'f1-score': 0.2565251013022364, 'support': 116074}, '1': {'precision': 0.36198519643196053, 'recall': 0.7588102835045394, 'f1-score': 0.49014846052831085, 'support': 125677}, '2': {'precision': 0.41803295678308633, 'recall': 0.17459204432324807, 'f1-score': 0.24631167562286274, 'support': 115515}, 'accuracy': 0.3814132886980569, 'macro avg': {'precision': 0.4116595148973609, 'recall': 0.3706737133216242, 'f1-score': 0.33099507915113663, 'support': 357266}, 'weighted avg': {'precision': 0.41031434005778095, 'recall': 0.3814132886980569, 'f1-score': 0.33540548468633263, 'support': 357266}}
[[20733 84484 10857]
 [13092 95365 17220]
 [11746 83601 20168]]
training model: results/AAPL/W9/deepOF_L2/seq2seq
Epoch 1/50
3419/3419 - 106s - loss: 12.5977 - accuracy10: 0.4637 - accuracy20: 0.4428 - accuracy30: 0.4282 - accuracy50: 0.4392 - val_loss: 12.7447 - val_accuracy10: 0.4593 - val_accuracy20: 0.4260 - val_accuracy30: 0.3991 - val_accuracy50: 0.3836 - 106s/epoch - 31ms/step
Epoch 2/50
3419/3419 - 102s - loss: 12.4548 - accuracy10: 0.4850 - accuracy20: 0.4577 - accuracy30: 0.4399 - accuracy50: 0.4473 - val_loss: 12.6915 - val_accuracy10: 0.4718 - val_accuracy20: 0.4387 - val_accuracy30: 0.4125 - val_accuracy50: 0.3922 - 102s/epoch - 30ms/step
Epoch 3/50
3419/3419 - 97s - loss: 12.3954 - accuracy10: 0.4920 - accuracy20: 0.4632 - accuracy30: 0.4447 - accuracy50: 0.4500 - val_loss: 12.6463 - val_accuracy10: 0.4758 - val_accuracy20: 0.4439 - val_accuracy30: 0.4166 - val_accuracy50: 0.3929 - 97s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 97s - loss: 12.3539 - accuracy10: 0.4959 - accuracy20: 0.4667 - accuracy30: 0.4479 - accuracy50: 0.4523 - val_loss: 12.6268 - val_accuracy10: 0.4795 - val_accuracy20: 0.4455 - val_accuracy30: 0.4163 - val_accuracy50: 0.3942 - 97s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 96s - loss: 12.3174 - accuracy10: 0.4998 - accuracy20: 0.4697 - accuracy30: 0.4507 - accuracy50: 0.4557 - val_loss: 12.6254 - val_accuracy10: 0.4790 - val_accuracy20: 0.4447 - val_accuracy30: 0.4160 - val_accuracy50: 0.3927 - 96s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 96s - loss: 12.2898 - accuracy10: 0.5021 - accuracy20: 0.4720 - accuracy30: 0.4536 - accuracy50: 0.4578 - val_loss: 12.6200 - val_accuracy10: 0.4800 - val_accuracy20: 0.4466 - val_accuracy30: 0.4190 - val_accuracy50: 0.3949 - 96s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 95s - loss: 12.2661 - accuracy10: 0.5046 - accuracy20: 0.4743 - accuracy30: 0.4554 - accuracy50: 0.4594 - val_loss: 12.6582 - val_accuracy10: 0.4761 - val_accuracy20: 0.4433 - val_accuracy30: 0.4173 - val_accuracy50: 0.3941 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 100s - loss: 12.2475 - accuracy10: 0.5057 - accuracy20: 0.4758 - accuracy30: 0.4563 - accuracy50: 0.4609 - val_loss: 12.6030 - val_accuracy10: 0.4805 - val_accuracy20: 0.4479 - val_accuracy30: 0.4216 - val_accuracy50: 0.3994 - 100s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 97s - loss: 12.2301 - accuracy10: 0.5075 - accuracy20: 0.4772 - accuracy30: 0.4577 - accuracy50: 0.4622 - val_loss: 12.6070 - val_accuracy10: 0.4802 - val_accuracy20: 0.4471 - val_accuracy30: 0.4221 - val_accuracy50: 0.4012 - 97s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 97s - loss: 12.2148 - accuracy10: 0.5089 - accuracy20: 0.4787 - accuracy30: 0.4596 - accuracy50: 0.4634 - val_loss: 12.5804 - val_accuracy10: 0.4819 - val_accuracy20: 0.4494 - val_accuracy30: 0.4238 - val_accuracy50: 0.4026 - 97s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 97s - loss: 12.2023 - accuracy10: 0.5096 - accuracy20: 0.4793 - accuracy30: 0.4602 - accuracy50: 0.4647 - val_loss: 12.5649 - val_accuracy10: 0.4833 - val_accuracy20: 0.4513 - val_accuracy30: 0.4263 - val_accuracy50: 0.4066 - 97s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 96s - loss: 12.1895 - accuracy10: 0.5107 - accuracy20: 0.4805 - accuracy30: 0.4614 - accuracy50: 0.4653 - val_loss: 12.6010 - val_accuracy10: 0.4801 - val_accuracy20: 0.4474 - val_accuracy30: 0.4243 - val_accuracy50: 0.4050 - 96s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 95s - loss: 12.1768 - accuracy10: 0.5116 - accuracy20: 0.4814 - accuracy30: 0.4625 - accuracy50: 0.4664 - val_loss: 12.5740 - val_accuracy10: 0.4832 - val_accuracy20: 0.4506 - val_accuracy30: 0.4268 - val_accuracy50: 0.4080 - 95s/epoch - 28ms/step
Epoch 14/50
3419/3419 - 96s - loss: 12.1658 - accuracy10: 0.5129 - accuracy20: 0.4827 - accuracy30: 0.4636 - accuracy50: 0.4671 - val_loss: 12.5725 - val_accuracy10: 0.4844 - val_accuracy20: 0.4515 - val_accuracy30: 0.4273 - val_accuracy50: 0.4086 - 96s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 98s - loss: 12.1550 - accuracy10: 0.5133 - accuracy20: 0.4837 - accuracy30: 0.4647 - accuracy50: 0.4679 - val_loss: 12.5796 - val_accuracy10: 0.4839 - val_accuracy20: 0.4507 - val_accuracy30: 0.4264 - val_accuracy50: 0.4076 - 98s/epoch - 29ms/step
Epoch 16/50
3419/3419 - 95s - loss: 12.1448 - accuracy10: 0.5136 - accuracy20: 0.4845 - accuracy30: 0.4657 - accuracy50: 0.4691 - val_loss: 12.5823 - val_accuracy10: 0.4839 - val_accuracy20: 0.4509 - val_accuracy30: 0.4269 - val_accuracy50: 0.4084 - 95s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 97s - loss: 12.1356 - accuracy10: 0.5139 - accuracy20: 0.4848 - accuracy30: 0.4665 - accuracy50: 0.4697 - val_loss: 12.5868 - val_accuracy10: 0.4828 - val_accuracy20: 0.4495 - val_accuracy30: 0.4262 - val_accuracy50: 0.4084 - 97s/epoch - 28ms/step
Epoch 18/50
3419/3419 - 96s - loss: 12.1267 - accuracy10: 0.5149 - accuracy20: 0.4858 - accuracy30: 0.4669 - accuracy50: 0.4703 - val_loss: 12.6182 - val_accuracy10: 0.4809 - val_accuracy20: 0.4488 - val_accuracy30: 0.4260 - val_accuracy50: 0.4088 - 96s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 100s - loss: 12.1167 - accuracy10: 0.5161 - accuracy20: 0.4870 - accuracy30: 0.4687 - accuracy50: 0.4711 - val_loss: 12.6084 - val_accuracy10: 0.4814 - val_accuracy20: 0.4483 - val_accuracy30: 0.4267 - val_accuracy50: 0.4085 - 100s/epoch - 29ms/step
Epoch 20/50
3419/3419 - 98s - loss: 12.1070 - accuracy10: 0.5163 - accuracy20: 0.4874 - accuracy30: 0.4689 - accuracy50: 0.4718 - val_loss: 12.5906 - val_accuracy10: 0.4842 - val_accuracy20: 0.4504 - val_accuracy30: 0.4264 - val_accuracy50: 0.4084 - 98s/epoch - 29ms/step
Epoch 21/50
3419/3419 - 99s - loss: 12.0992 - accuracy10: 0.5171 - accuracy20: 0.4883 - accuracy30: 0.4699 - accuracy50: 0.4727 - val_loss: 12.6382 - val_accuracy10: 0.4785 - val_accuracy20: 0.4462 - val_accuracy30: 0.4238 - val_accuracy50: 0.4075 - 99s/epoch - 29ms/step
testing model: results/AAPL/W9/deepOF_L2/seq2seq
Evaluating performance on  test set...
10303/10303 - 92s - 92s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.021169
{'0': {'precision': 0.4698628944213368, 'recall': 0.42659766606058025, 'f1-score': 0.44718624101178034, 'support': 822215}, '1': {'precision': 0.4772083642681648, 'recall': 0.5053203398776772, 'f1-score': 0.4908621840907872, 'support': 987061}, '2': {'precision': 0.46453711597789726, 'recall': 0.47438910114910326, 'f1-score': 0.4694114210027297, 'support': 828124}, 'accuracy': 0.4710662015621445, 'macro avg': {'precision': 0.47053612488913293, 'recall': 0.46876903569578693, 'f1-score': 0.46915328203509904, 'support': 2637400}, 'weighted avg': {'precision': 0.47093972079002744, 'recall': 0.4710662015621445, 'f1-score': 0.47051073672965876, 'support': 2637400}}
[[350755 287742 183718]
 [219163 498782 269116]
 [176587 258684 392853]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.048502
{'0': {'precision': 0.45581748385182685, 'recall': 0.36198914269380317, 'f1-score': 0.4035207709219092, 'support': 836119}, '1': {'precision': 0.41516103629070417, 'recall': 0.541651277855492, 'f1-score': 0.47004517500035187, 'support': 955781}, '2': {'precision': 0.46012221798523417, 'recall': 0.3953116499112951, 'f1-score': 0.4252617998393035, 'support': 845500}, 'accuracy': 0.4377803897778115, 'macro avg': {'precision': 0.44370024604258845, 'recall': 0.4329840234868634, 'f1-score': 0.43294258192052154, 'support': 2637400}, 'weighted avg': {'precision': 0.4424637993911377, 'recall': 0.4377803897778115, 'f1-score': 0.43459865118434754, 'support': 2637400}}
[[302666 376063 157390]
 [203300 517700 234781]
 [158041 353223 334236]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0683658
{'0': {'precision': 0.4639679983141163, 'recall': 0.2876930166897091, 'f1-score': 0.35516103780317687, 'support': 857115}, '1': {'precision': 0.3708603374449271, 'recall': 0.6305814665358866, 'f1-score': 0.46704192802100425, 'support': 911454}, '2': {'precision': 0.4680112340964176, 'recall': 0.29958760679579804, 'f1-score': 0.36532198358590734, 'support': 868831}, 'accuracy': 0.41010957761431716, 'macro avg': {'precision': 0.43427985661848695, 'recall': 0.4059540300071313, 'f1-score': 0.39584164980336284, 'support': 2637400}, 'weighted avg': {'precision': 0.4331230520253875, 'recall': 0.41010957761431716, 'f1-score': 0.39717303052250463, 'support': 2637400}}
[[246586 491317 119212]
 [160047 574746 176661]
 [124839 483701 260291]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0709244
{'0': {'precision': 0.4371291158352613, 'recall': 0.21060679539583724, 'f1-score': 0.2842589415346904, 'support': 808312}, '1': {'precision': 0.3931300545548518, 'recall': 0.7305392254723474, 'f1-score': 0.5111769640217472, 'support': 1006833}, '2': {'precision': 0.4400845627828264, 'recall': 0.20177560489142662, 'f1-score': 0.2766905732151598, 'support': 822255}, 'accuracy': 0.4063388185334041, 'macro avg': {'precision': 0.4234479110576465, 'recall': 0.38097387525320375, 'f1-score': 0.3573754929238658, 'support': 2637400}, 'weighted avg': {'precision': 0.42125379323107975, 'recall': 0.4063388185334041, 'f1-score': 0.3685258045976066, 'support': 2637400}}
[[170236 562846  75230]
 [135445 735531 135857]
 [ 83760 572584 165911]]
Evaluating performance on  train set...
3419/3419 - 33s - 33s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0147828
{'0': {'precision': 0.4878228418185214, 'recall': 0.47659526121175816, 'f1-score': 0.4821436967867884, 'support': 290454}, '1': {'precision': 0.4804212192434564, 'recall': 0.48749545682687484, 'f1-score': 0.48393248620379214, 'support': 288895}, '2': {'precision': 0.4877697118044495, 'recall': 0.49177833971143053, 'f1-score': 0.4897658234560357, 'support': 295804}, 'accuracy': 0.485325423097447, 'macro avg': {'precision': 0.4853379242888091, 'recall': 0.4852896859166878, 'f1-score': 0.4852806688155387, 'support': 875153}, 'weighted avg': {'precision': 0.48536154896515077, 'recall': 0.485325423097447, 'f1-score': 0.4853104891943964, 'support': 875153}}
[[138429  76531  75494]
 [ 70789 140835  77271]
 [ 74551  75783 145470]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0456839
{'0': {'precision': 0.46621025153348666, 'recall': 0.4248549025836144, 'f1-score': 0.4445729026290975, 'support': 289633}, '1': {'precision': 0.41623447005897296, 'recall': 0.49608976184357656, 'f1-score': 0.4526672687231649, 'support': 287962}, '2': {'precision': 0.4732168176594379, 'recall': 0.42621606543934293, 'f1-score': 0.44848840622248315, 'support': 297558}, 'accuracy': 0.4487569602115287, 'macro avg': {'precision': 0.4518871797506325, 'recall': 0.449053576622178, 'f1-score': 0.4485761925249152, 'support': 875153}, 'weighted avg': {'precision': 0.4521484061399862, 'recall': 0.4487569602115287, 'f1-score': 0.44856758615005954, 'support': 875153}}
[[123052  99395  67186]
 [ 71113 142855  73994]
 [ 69776 100958 126824]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620551
{'0': {'precision': 0.46266521996449006, 'recall': 0.3576935075739194, 'f1-score': 0.4034633625661257, 'support': 288490}, '1': {'precision': 0.3783610123712334, 'recall': 0.5716058756027971, 'f1-score': 0.4553282446121047, 'support': 288447}, '2': {'precision': 0.47248876809584556, 'recall': 0.3427783888188427, 'f1-score': 0.397315008434325, 'support': 298216}, 'accuracy': 0.42311572947815984, 'macro avg': {'precision': 0.43783833347718965, 'recall': 0.42402592399851974, 'f1-score': 0.41870220520418516, 'support': 875153}, 'weighted avg': {'precision': 0.4382263429474293, 'recall': 0.42311572947815984, 'f1-score': 0.4184627193137429, 'support': 875153}}
[[103191 132775  52524]
 [ 61967 164878  61602]
 [ 57878 138116 102222]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777727
{'0': {'precision': 0.4611375279751622, 'recall': 0.2713541157237274, 'f1-score': 0.34166005088834694, 'support': 286268}, '1': {'precision': 0.3557787754061666, 'recall': 0.6832123430746003, 'f1-score': 0.46790092126462896, 'support': 290106}, '2': {'precision': 0.4662535678237445, 'recall': 0.23345683598914246, 'f1-score': 0.31112895312012134, 'support': 298779}, 'accuracy': 0.39494351273434475, 'macro avg': {'precision': 0.42772329040169116, 'recall': 0.39600776492915674, 'f1-score': 0.37356330842436575, 'support': 875153}, 'weighted avg': {'precision': 0.42795859697354144, 'recall': 0.39494351273434475, 'f1-score': 0.3730844796239955, 'support': 875153}}
[[ 77680 173295  35293]
 [ 47346 198204  44556]
 [ 43427 185600  69752]]
Evaluating performance on  val set...
1396/1396 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0140798
{'0': {'precision': 0.4839925346349867, 'recall': 0.4640518939752402, 'f1-score': 0.4738125041175308, 'support': 116237}, '1': {'precision': 0.49894184577502754, 'recall': 0.4887902628218267, 'f1-score': 0.4938138869974157, 'support': 126854}, '2': {'precision': 0.4687317454440742, 'recall': 0.4989883950076637, 'f1-score': 0.48338706940437803, 'support': 114175}, 'accuracy': 0.48400071655293253, 'macro avg': {'precision': 0.48388870861802946, 'recall': 0.48394351726824353, 'f1-score': 0.4836711535064415, 'support': 357266}, 'weighted avg': {'precision': 0.48442352809500333, 'recall': 0.48400071655293253, 'f1-score': 0.4839742083252379, 'support': 357266}}
[[53940 32581 29716]
 [29992 62005 34857]
 [27516 29687 56972]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0438827
{'0': {'precision': 0.46968339591712255, 'recall': 0.41638784683497243, 'f1-score': 0.4414328069436856, 'support': 118356}, '1': {'precision': 0.42793196697978936, 'recall': 0.4907374159430698, 'f1-score': 0.4571878231251141, 'support': 122536}, '2': {'precision': 0.4602933285637632, 'recall': 0.44228092185539725, 'f1-score': 0.4511073910795201, 'support': 116374}, 'accuracy': 0.4503227287231363, 'macro avg': {'precision': 0.45263623048689167, 'recall': 0.44980206154447977, 'f1-score': 0.44990934038277325, 'support': 357266}, 'weighted avg': {'precision': 0.45230471226280083, 'recall': 0.4503227287231363, 'f1-score': 0.44998785197184704, 'support': 357266}}
[[49282 41762 27312]
 [29365 60133 33038]
 [26279 38625 51470]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0595527
{'0': {'precision': 0.46558988764044945, 'recall': 0.3574093883980088, 'f1-score': 0.40438965581324426, 'support': 118721}, '1': {'precision': 0.38782103428239395, 'recall': 0.5496137946935885, 'f1-score': 0.45475543200539625, 'support': 121438}, '2': {'precision': 0.4604381580346698, 'recall': 0.369704629099883, 'f1-score': 0.4101128651065422, 'support': 117107}, 'accuracy': 0.42677164913537813, 'macro avg': {'precision': 0.4379496933191711, 'recall': 0.42557593739716015, 'f1-score': 0.4230859843083943, 'support': 357266}, 'weighted avg': {'precision': 0.43746687114002797, 'recall': 0.42677164913537813, 'f1-score': 0.4233854376674727, 'support': 357266}}
[[42432 53977 22312]
 [26271 66744 28423]
 [22433 51379 43295]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0708739
{'0': {'precision': 0.45324639289678137, 'recall': 0.2815117361182918, 'f1-score': 0.347309335998129, 'support': 116052}, '1': {'precision': 0.37664900318683764, 'recall': 0.6470078057241977, 'f1-score': 0.47612606678084696, 'support': 125677}, '2': {'precision': 0.44831019654246873, 'recall': 0.2688922163462787, 'f1-score': 0.3361592771931723, 'support': 115537}, 'accuracy': 0.40600281023103235, 'macro avg': {'precision': 0.4260685308753626, 'recall': 0.39913725272958933, 'f1-score': 0.38653155999071603, 'support': 357266}, 'weighted avg': {'precision': 0.4247050722428014, 'recall': 0.40600281023103235, 'f1-score': 0.3890179114865084, 'support': 357266}}
[[32670 67513 15869]
 [22001 81314 22362]
 [17409 67061 31067]]
training model: results/AAPL/W9/deepVOL_L2/seq2seq
Epoch 1/50
3419/3419 - 99s - loss: 12.7193 - accuracy10: 0.4405 - accuracy20: 0.4293 - accuracy30: 0.4184 - accuracy50: 0.4336 - val_loss: 13.0004 - val_accuracy10: 0.3993 - val_accuracy20: 0.3872 - val_accuracy30: 0.3764 - val_accuracy50: 0.3709 - 99s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 93s - loss: 12.6013 - accuracy10: 0.4588 - accuracy20: 0.4428 - accuracy30: 0.4291 - accuracy50: 0.4390 - val_loss: 12.8813 - val_accuracy10: 0.4268 - val_accuracy20: 0.4064 - val_accuracy30: 0.3900 - val_accuracy50: 0.3814 - 93s/epoch - 27ms/step
Epoch 3/50
3419/3419 - 96s - loss: 12.5398 - accuracy10: 0.4677 - accuracy20: 0.4490 - accuracy30: 0.4335 - accuracy50: 0.4416 - val_loss: 12.7714 - val_accuracy10: 0.4577 - val_accuracy20: 0.4287 - val_accuracy30: 0.4044 - val_accuracy50: 0.3922 - 96s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 94s - loss: 12.4974 - accuracy10: 0.4748 - accuracy20: 0.4533 - accuracy30: 0.4366 - accuracy50: 0.4439 - val_loss: 12.7197 - val_accuracy10: 0.4667 - val_accuracy20: 0.4362 - val_accuracy30: 0.4109 - val_accuracy50: 0.3955 - 94s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 92s - loss: 12.4604 - accuracy10: 0.4804 - accuracy20: 0.4567 - accuracy30: 0.4395 - accuracy50: 0.4459 - val_loss: 12.6783 - val_accuracy10: 0.4718 - val_accuracy20: 0.4399 - val_accuracy30: 0.4135 - val_accuracy50: 0.3987 - 92s/epoch - 27ms/step
Epoch 6/50
3419/3419 - 92s - loss: 12.4319 - accuracy10: 0.4841 - accuracy20: 0.4593 - accuracy30: 0.4423 - accuracy50: 0.4487 - val_loss: 12.6453 - val_accuracy10: 0.4761 - val_accuracy20: 0.4419 - val_accuracy30: 0.4143 - val_accuracy50: 0.3989 - 92s/epoch - 27ms/step
Epoch 7/50
3419/3419 - 91s - loss: 12.4061 - accuracy10: 0.4866 - accuracy20: 0.4616 - accuracy30: 0.4445 - accuracy50: 0.4512 - val_loss: 12.6246 - val_accuracy10: 0.4787 - val_accuracy20: 0.4460 - val_accuracy30: 0.4167 - val_accuracy50: 0.4002 - 91s/epoch - 27ms/step
Epoch 8/50
3419/3419 - 97s - loss: 12.3830 - accuracy10: 0.4891 - accuracy20: 0.4637 - accuracy30: 0.4459 - accuracy50: 0.4528 - val_loss: 12.6383 - val_accuracy10: 0.4786 - val_accuracy20: 0.4454 - val_accuracy30: 0.4167 - val_accuracy50: 0.3995 - 97s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 97s - loss: 12.3616 - accuracy10: 0.4915 - accuracy20: 0.4657 - accuracy30: 0.4482 - accuracy50: 0.4544 - val_loss: 12.6214 - val_accuracy10: 0.4803 - val_accuracy20: 0.4467 - val_accuracy30: 0.4159 - val_accuracy50: 0.3986 - 97s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 94s - loss: 12.3383 - accuracy10: 0.4934 - accuracy20: 0.4675 - accuracy30: 0.4496 - accuracy50: 0.4566 - val_loss: 12.5953 - val_accuracy10: 0.4837 - val_accuracy20: 0.4486 - val_accuracy30: 0.4160 - val_accuracy50: 0.3968 - 94s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 92s - loss: 12.3173 - accuracy10: 0.4955 - accuracy20: 0.4693 - accuracy30: 0.4515 - accuracy50: 0.4590 - val_loss: 12.5830 - val_accuracy10: 0.4846 - val_accuracy20: 0.4504 - val_accuracy30: 0.4188 - val_accuracy50: 0.3991 - 92s/epoch - 27ms/step
Epoch 12/50
3419/3419 - 91s - loss: 12.2966 - accuracy10: 0.4971 - accuracy20: 0.4709 - accuracy30: 0.4528 - accuracy50: 0.4603 - val_loss: 12.5861 - val_accuracy10: 0.4850 - val_accuracy20: 0.4510 - val_accuracy30: 0.4183 - val_accuracy50: 0.3988 - 91s/epoch - 26ms/step
Epoch 13/50
3419/3419 - 94s - loss: 12.2821 - accuracy10: 0.4988 - accuracy20: 0.4721 - accuracy30: 0.4539 - accuracy50: 0.4613 - val_loss: 12.5776 - val_accuracy10: 0.4865 - val_accuracy20: 0.4525 - val_accuracy30: 0.4201 - val_accuracy50: 0.4019 - 94s/epoch - 27ms/step
Epoch 14/50
3419/3419 - 94s - loss: 12.2651 - accuracy10: 0.4996 - accuracy20: 0.4732 - accuracy30: 0.4552 - accuracy50: 0.4627 - val_loss: 12.5734 - val_accuracy10: 0.4860 - val_accuracy20: 0.4533 - val_accuracy30: 0.4200 - val_accuracy50: 0.4000 - 94s/epoch - 27ms/step
Epoch 15/50
3419/3419 - 94s - loss: 12.2534 - accuracy10: 0.5007 - accuracy20: 0.4744 - accuracy30: 0.4565 - accuracy50: 0.4635 - val_loss: 12.5620 - val_accuracy10: 0.4874 - val_accuracy20: 0.4533 - val_accuracy30: 0.4214 - val_accuracy50: 0.4038 - 94s/epoch - 28ms/step
Epoch 16/50
3419/3419 - 96s - loss: 12.2401 - accuracy10: 0.5022 - accuracy20: 0.4756 - accuracy30: 0.4575 - accuracy50: 0.4644 - val_loss: 12.5545 - val_accuracy10: 0.4881 - val_accuracy20: 0.4545 - val_accuracy30: 0.4231 - val_accuracy50: 0.4034 - 96s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 96s - loss: 12.2270 - accuracy10: 0.5027 - accuracy20: 0.4765 - accuracy30: 0.4584 - accuracy50: 0.4654 - val_loss: 12.5590 - val_accuracy10: 0.4878 - val_accuracy20: 0.4549 - val_accuracy30: 0.4215 - val_accuracy50: 0.4018 - 96s/epoch - 28ms/step
Epoch 18/50
3419/3419 - 95s - loss: 12.2180 - accuracy10: 0.5036 - accuracy20: 0.4773 - accuracy30: 0.4592 - accuracy50: 0.4663 - val_loss: 12.5608 - val_accuracy10: 0.4867 - val_accuracy20: 0.4541 - val_accuracy30: 0.4227 - val_accuracy50: 0.4042 - 95s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 97s - loss: 12.2061 - accuracy10: 0.5047 - accuracy20: 0.4784 - accuracy30: 0.4603 - accuracy50: 0.4671 - val_loss: 12.5598 - val_accuracy10: 0.4877 - val_accuracy20: 0.4543 - val_accuracy30: 0.4219 - val_accuracy50: 0.4023 - 97s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 95s - loss: 12.1978 - accuracy10: 0.5056 - accuracy20: 0.4787 - accuracy30: 0.4614 - accuracy50: 0.4679 - val_loss: 12.5655 - val_accuracy10: 0.4893 - val_accuracy20: 0.4552 - val_accuracy30: 0.4212 - val_accuracy50: 0.4019 - 95s/epoch - 28ms/step
Epoch 21/50
3419/3419 - 93s - loss: 12.1879 - accuracy10: 0.5059 - accuracy20: 0.4800 - accuracy30: 0.4619 - accuracy50: 0.4687 - val_loss: 12.5384 - val_accuracy10: 0.4898 - val_accuracy20: 0.4573 - val_accuracy30: 0.4250 - val_accuracy50: 0.4056 - 93s/epoch - 27ms/step
Epoch 22/50
3419/3419 - 96s - loss: 12.1772 - accuracy10: 0.5069 - accuracy20: 0.4806 - accuracy30: 0.4631 - accuracy50: 0.4696 - val_loss: 12.5467 - val_accuracy10: 0.4903 - val_accuracy20: 0.4562 - val_accuracy30: 0.4243 - val_accuracy50: 0.4051 - 96s/epoch - 28ms/step
Epoch 23/50
3419/3419 - 92s - loss: 12.1689 - accuracy10: 0.5073 - accuracy20: 0.4812 - accuracy30: 0.4632 - accuracy50: 0.4700 - val_loss: 12.5460 - val_accuracy10: 0.4905 - val_accuracy20: 0.4564 - val_accuracy30: 0.4244 - val_accuracy50: 0.4054 - 92s/epoch - 27ms/step
Epoch 24/50
3419/3419 - 95s - loss: 12.1597 - accuracy10: 0.5077 - accuracy20: 0.4823 - accuracy30: 0.4649 - accuracy50: 0.4712 - val_loss: 12.5620 - val_accuracy10: 0.4895 - val_accuracy20: 0.4543 - val_accuracy30: 0.4231 - val_accuracy50: 0.4043 - 95s/epoch - 28ms/step
Epoch 25/50
3419/3419 - 95s - loss: 12.1510 - accuracy10: 0.5089 - accuracy20: 0.4827 - accuracy30: 0.4658 - accuracy50: 0.4723 - val_loss: 12.5604 - val_accuracy10: 0.4890 - val_accuracy20: 0.4558 - val_accuracy30: 0.4252 - val_accuracy50: 0.4072 - 95s/epoch - 28ms/step
Epoch 26/50
3419/3419 - 95s - loss: 12.1462 - accuracy10: 0.5092 - accuracy20: 0.4830 - accuracy30: 0.4662 - accuracy50: 0.4723 - val_loss: 12.5541 - val_accuracy10: 0.4900 - val_accuracy20: 0.4571 - val_accuracy30: 0.4255 - val_accuracy50: 0.4058 - 95s/epoch - 28ms/step
Epoch 27/50
3419/3419 - 93s - loss: 12.1354 - accuracy10: 0.5096 - accuracy20: 0.4840 - accuracy30: 0.4671 - accuracy50: 0.4735 - val_loss: 12.5687 - val_accuracy10: 0.4895 - val_accuracy20: 0.4565 - val_accuracy30: 0.4244 - val_accuracy50: 0.4041 - 93s/epoch - 27ms/step
Epoch 28/50
3419/3419 - 92s - loss: 12.1265 - accuracy10: 0.5104 - accuracy20: 0.4852 - accuracy30: 0.4681 - accuracy50: 0.4747 - val_loss: 12.5820 - val_accuracy10: 0.4885 - val_accuracy20: 0.4546 - val_accuracy30: 0.4230 - val_accuracy50: 0.4034 - 92s/epoch - 27ms/step
Epoch 29/50
3419/3419 - 93s - loss: 12.1202 - accuracy10: 0.5105 - accuracy20: 0.4852 - accuracy30: 0.4683 - accuracy50: 0.4749 - val_loss: 12.5797 - val_accuracy10: 0.4882 - val_accuracy20: 0.4542 - val_accuracy30: 0.4239 - val_accuracy50: 0.4070 - 93s/epoch - 27ms/step
Epoch 30/50
3419/3419 - 94s - loss: 12.1108 - accuracy10: 0.5111 - accuracy20: 0.4862 - accuracy30: 0.4690 - accuracy50: 0.4763 - val_loss: 12.5943 - val_accuracy10: 0.4889 - val_accuracy20: 0.4536 - val_accuracy30: 0.4225 - val_accuracy50: 0.4043 - 94s/epoch - 27ms/step
Epoch 31/50
3419/3419 - 94s - loss: 12.1010 - accuracy10: 0.5118 - accuracy20: 0.4872 - accuracy30: 0.4703 - accuracy50: 0.4771 - val_loss: 12.5821 - val_accuracy10: 0.4890 - val_accuracy20: 0.4547 - val_accuracy30: 0.4227 - val_accuracy50: 0.4034 - 94s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/seq2seq
Evaluating performance on  test set...
10303/10303 - 88s - 88s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0085541
{'0': {'precision': 0.4655213704454925, 'recall': 0.46337159168443365, 'f1-score': 0.46444399340012443, 'support': 822217}, '1': {'precision': 0.4879948661043494, 'recall': 0.5631591531231067, 'f1-score': 0.5228896441374536, 'support': 987062}, '2': {'precision': 0.48826571435295224, 'recall': 0.4008646037735849, 'f1-score': 0.44026941412308784, 'support': 828125}, 'accuracy': 0.4810908757247657, 'macro avg': {'precision': 0.48059398363426475, 'recall': 0.4757984495270417, 'f1-score': 0.47586768388688866, 'support': 2637404}, 'weighted avg': {'precision': 0.4810737444353657, 'recall': 0.4810908757247657, 'f1-score': 0.4787269426351653, 'support': 2637404}}
[[380992 286266 154959]
 [238226 555873 192963]
 [199202 296957 331966]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401504
{'0': {'precision': 0.45312635038694726, 'recall': 0.41386234767455904, 'f1-score': 0.432605259061965, 'support': 836121}, '1': {'precision': 0.4269937467352711, 'recall': 0.5653234733443401, 'f1-score': 0.4865169788776432, 'support': 955782}, '2': {'precision': 0.4763239440092715, 'recall': 0.34270213754921636, 'f1-score': 0.39861302943426125, 'support': 845501}, 'accuracy': 0.44593850619776115, 'macro avg': {'precision': 0.45214801371049657, 'recall': 0.4406293195227051, 'f1-score': 0.4392450891246232, 'support': 2637404}, 'weighted avg': {'precision': 0.4510927280908798, 'recall': 0.44593850619776115, 'f1-score': 0.44124534122094233, 'support': 2637404}}
[[346039 353957 136125]
 [233021 540326 182435]
 [184610 371136 289755]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0653453
{'0': {'precision': 0.4658516780945507, 'recall': 0.31326178339713245, 'f1-score': 0.3746143140667674, 'support': 857117}, '1': {'precision': 0.37507379731982954, 'recall': 0.6663598312588115, 'f1-score': 0.47998087527239897, 'support': 911455}, '2': {'precision': 0.4852762736113878, 'recall': 0.246726639902766, 'f1-score': 0.3271314422448892, 'support': 868832}, 'accuracy': 0.4133697378179452, 'macro avg': {'precision': 0.442067249675256, 'recall': 0.40878275151956994, 'f1-score': 0.3939088771946852, 'support': 2637404}, 'weighted avg': {'precision': 0.4408789233897581, 'recall': 0.4133697378179452, 'f1-score': 0.39538558784694394, 'support': 2637404}}
[[268502 491430  97185]
 [173911 607357 130187]
 [133955 520513 214364]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0692
{'0': {'precision': 0.44898775769781124, 'recall': 0.2096202713302009, 'f1-score': 0.2858056125779502, 'support': 808314}, '1': {'precision': 0.3973228068072565, 'recall': 0.7835641227848881, 'f1-score': 0.5272780801899198, 'support': 1006834}, '2': {'precision': 0.47231969450183464, 'recall': 0.1576419022786091, 'f1-score': 0.23638702900447073, 'support': 822256}, 'accuracy': 0.41251928032262025, 'macro avg': {'precision': 0.43954341966896743, 'recall': 0.38360876546456607, 'f1-score': 0.34982357392411356, 'support': 2637404}, 'weighted avg': {'precision': 0.43653869637227605, 'recall': 0.41251928032262025, 'f1-score': 0.3625810946811225, 'support': 2637404}}
[[169439 581814  57061]
 [130161 788919  87754]
 [ 77780 614854 129622]]
Evaluating performance on  train set...
3419/3419 - 30s - 30s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0005299
{'0': {'precision': 0.4809446801697222, 'recall': 0.5166764712965161, 'f1-score': 0.49817067305300233, 'support': 290679}, '1': {'precision': 0.49911105764089403, 'recall': 0.517645346217567, 'f1-score': 0.5082092726499362, 'support': 288518}, '2': {'precision': 0.5052361680580473, 'recall': 0.45007889659646505, 'f1-score': 0.47606521754669373, 'support': 295957}, 'accuracy': 0.4944741154128302, 'macro avg': {'precision': 0.4950973019562212, 'recall': 0.4948002380368493, 'f1-score': 0.4941483877498774, 'support': 875154}, 'weighted avg': {'precision': 0.49514853774929407, 'recall': 0.4944741154128302, 'f1-score': 0.4940046090039637, 'support': 875154}}
[[150187  73105  67387]
 [ 76112 149350  63056]
 [ 85976  76777 133204]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0359122
{'0': {'precision': 0.461939050404094, 'recall': 0.4776695409639136, 'f1-score': 0.469672619401174, 'support': 289694}, '1': {'precision': 0.4349891470661495, 'recall': 0.5092816647630025, 'f1-score': 0.46921284486715487, 'support': 288041}, '2': {'precision': 0.49358320852159976, 'recall': 0.395569886254745, 'f1-score': 0.439174434187294, 'support': 297419}, 'accuracy': 0.4601727238863103, 'macro avg': {'precision': 0.4635038019972811, 'recall': 0.460840363993887, 'f1-score': 0.45935329948520764, 'support': 875154}, 'weighted avg': {'precision': 0.46382317223383546, 'recall': 0.4601727238863103, 'f1-score': 0.4591565574684394, 'support': 875154}}
[[138378  91797  59519]
 [ 80157 146694  61190]
 [ 81024  98745 117650]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.05743
{'0': {'precision': 0.465122149254736, 'recall': 0.3834468598698722, 'f1-score': 0.42035385612689696, 'support': 288332}, '1': {'precision': 0.38538988670413643, 'recall': 0.6022616285110657, 'f1-score': 0.47001505531544535, 'support': 288730}, '2': {'precision': 0.4925286584874762, 'recall': 0.3077271446399098, 'f1-score': 0.37878997474898674, 'support': 298092}, 'accuracy': 0.4298466327069293, 'macro avg': {'precision': 0.4476802314821162, 'recall': 0.4311452110069493, 'f1-score': 0.42305296206377635, 'support': 875154}, 'weighted avg': {'precision': 0.44815206739939556, 'recall': 0.4298466327069293, 'f1-score': 0.42258068422115874, 'support': 875154}}
[[110560 131998  45774]
 [ 66099 173891  48740]
 [ 61042 145319  91731]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078286
{'0': {'precision': 0.4757903027713996, 'recall': 0.24899745696400627, 'f1-score': 0.3269110821669021, 'support': 286272}, '1': {'precision': 0.36003942923377175, 'recall': 0.7522172738656631, 'f1-score': 0.48698807961810114, 'support': 289883}, '2': {'precision': 0.49229715278706054, 'recall': 0.19707758219927157, 'f1-score': 0.2814745817361086, 'support': 298999}, 'accuracy': 0.3979436761987033, 'macro avg': {'precision': 0.44270896159741063, 'recall': 0.39943077100964697, 'f1-score': 0.365124581173704, 'support': 875154}, 'weighted avg': {'precision': 0.4430889966859843, 'recall': 0.3979436761987033, 'f1-score': 0.36441091883546456, 'support': 875154}}
[[ 71281 184353  30638]
 [ 41696 218055  30132]
 [ 36839 203234  58926]]
Evaluating performance on  val set...
1396/1396 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0048108
{'0': {'precision': 0.4702388896303216, 'recall': 0.4850215943699778, 'f1-score': 0.4775158604450242, 'support': 116234}, '1': {'precision': 0.5100813686931939, 'recall': 0.5496704944556253, 'f1-score': 0.5291364665481454, 'support': 126705}, '2': {'precision': 0.4878370471742084, 'recall': 0.4302833101542068, 'f1-score': 0.45725625795897124, 'support': 114327}, 'accuracy': 0.49043289873651563, 'macro avg': {'precision': 0.4893857684992413, 'recall': 0.4883251329932699, 'f1-score': 0.4879695283173802, 'support': 357266}, 'weighted avg': {'precision': 0.49000059622199604, 'recall': 0.49043289873651563, 'f1-score': 0.48934001757968854, 'support': 357266}}
[[56376 33950 25908]
 [31321 69646 25738]
 [32191 32943 49193]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0386117
{'0': {'precision': 0.4625578852871377, 'recall': 0.4396357277419682, 'f1-score': 0.4508056133056133, 'support': 118373}, '1': {'precision': 0.44094975194989516, 'recall': 0.5524613564990416, 'f1-score': 0.49044689764041816, 'support': 122595}, '2': {'precision': 0.4791303298559691, 'recall': 0.37556965725979813, 'f1-score': 0.42107597163776944, 'support': 116298}, 'accuracy': 0.4574966551533031, 'macro avg': {'precision': 0.460879322364334, 'recall': 0.45588891383360264, 'f1-score': 0.4541094941946003, 'support': 357266}, 'weighted avg': {'precision': 0.4605378023572947, 'recall': 0.4574966551533031, 'f1-score': 0.4547307709929905, 'support': 357266}}
[[52041 43059 23273]
 [30656 67729 24210]
 [29810 42810 43678]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.061254
{'0': {'precision': 0.46610435328151684, 'recall': 0.33818595633482257, 'f1-score': 0.39197276053599606, 'support': 118630}, '1': {'precision': 0.38901076984443556, 'recall': 0.6425577124220687, 'f1-score': 0.4846248691692988, 'support': 121421}, '2': {'precision': 0.47671768153695865, 'recall': 0.2872669880134795, 'f1-score': 0.35850261913887826, 'support': 117215}, 'accuracy': 0.4249242861061506, 'macro avg': {'precision': 0.4439442682209704, 'recall': 0.42267021892345696, 'f1-score': 0.4117000829480577, 'support': 357266}, 'weighted avg': {'precision': 0.44338531838020456, 'recall': 0.4249242861061506, 'f1-score': 0.41248047483990713, 'support': 357266}}
[[40119 60682 17829]
 [24269 78020 19132]
 [21685 61858 33672]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.075608
{'0': {'precision': 0.4730415566417589, 'recall': 0.2176111790754174, 'f1-score': 0.2980922989774062, 'support': 116074}, '1': {'precision': 0.37967030611091407, 'recall': 0.7750105428996554, 'f1-score': 0.5096620253363263, 'support': 125677}, '2': {'precision': 0.4665736984448952, 'recall': 0.1911613210405575, 'f1-score': 0.27120600824106655, 'support': 115515}, 'accuracy': 0.40513790844916675, 'macro avg': {'precision': 0.43976185373252275, 'recall': 0.39459434767187673, 'f1-score': 0.35965344418493306, 'support': 357266}, 'weighted avg': {'precision': 0.43810469365290544, 'recall': 0.40513790844916675, 'f1-score': 0.3638239348599187, 'support': 357266}}
[[25259 78404 12411]
 [15441 97401 12835]
 [12697 80736 22082]]
training model: results/AAPL/W9/deepVOL_L3/seq2seq
Epoch 1/50
3419/3419 - 147s - loss: 12.7479 - accuracy10: 0.4366 - accuracy20: 0.4252 - accuracy30: 0.4148 - accuracy50: 0.4321 - val_loss: 12.9528 - val_accuracy10: 0.3969 - val_accuracy20: 0.3835 - val_accuracy30: 0.3743 - val_accuracy50: 0.3708 - 147s/epoch - 43ms/step
Epoch 2/50
3419/3419 - 143s - loss: 12.5931 - accuracy10: 0.4587 - accuracy20: 0.4438 - accuracy30: 0.4310 - accuracy50: 0.4417 - val_loss: 12.9079 - val_accuracy10: 0.4156 - val_accuracy20: 0.4025 - val_accuracy30: 0.3926 - val_accuracy50: 0.3823 - 143s/epoch - 42ms/step
Epoch 3/50
3419/3419 - 139s - loss: 12.5409 - accuracy10: 0.4669 - accuracy20: 0.4490 - accuracy30: 0.4346 - accuracy50: 0.4426 - val_loss: 12.7882 - val_accuracy10: 0.4444 - val_accuracy20: 0.4191 - val_accuracy30: 0.4002 - val_accuracy50: 0.3905 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 145s - loss: 12.4985 - accuracy10: 0.4736 - accuracy20: 0.4534 - accuracy30: 0.4383 - accuracy50: 0.4454 - val_loss: 12.7311 - val_accuracy10: 0.4550 - val_accuracy20: 0.4276 - val_accuracy30: 0.4077 - val_accuracy50: 0.3967 - 145s/epoch - 43ms/step
Epoch 5/50
3419/3419 - 147s - loss: 12.4630 - accuracy10: 0.4783 - accuracy20: 0.4566 - accuracy30: 0.4410 - accuracy50: 0.4473 - val_loss: 12.6921 - val_accuracy10: 0.4655 - val_accuracy20: 0.4350 - val_accuracy30: 0.4118 - val_accuracy50: 0.3963 - 147s/epoch - 43ms/step
Epoch 6/50
3419/3419 - 144s - loss: 12.4360 - accuracy10: 0.4820 - accuracy20: 0.4588 - accuracy30: 0.4430 - accuracy50: 0.4494 - val_loss: 12.6591 - val_accuracy10: 0.4710 - val_accuracy20: 0.4374 - val_accuracy30: 0.4117 - val_accuracy50: 0.3957 - 144s/epoch - 42ms/step
Epoch 7/50
3419/3419 - 137s - loss: 12.4141 - accuracy10: 0.4851 - accuracy20: 0.4612 - accuracy30: 0.4448 - accuracy50: 0.4506 - val_loss: 12.6378 - val_accuracy10: 0.4750 - val_accuracy20: 0.4406 - val_accuracy30: 0.4130 - val_accuracy50: 0.3971 - 137s/epoch - 40ms/step
Epoch 8/50
3419/3419 - 138s - loss: 12.3935 - accuracy10: 0.4868 - accuracy20: 0.4624 - accuracy30: 0.4459 - accuracy50: 0.4526 - val_loss: 12.6348 - val_accuracy10: 0.4761 - val_accuracy20: 0.4410 - val_accuracy30: 0.4129 - val_accuracy50: 0.3941 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 138s - loss: 12.3786 - accuracy10: 0.4888 - accuracy20: 0.4641 - accuracy30: 0.4467 - accuracy50: 0.4532 - val_loss: 12.6070 - val_accuracy10: 0.4814 - val_accuracy20: 0.4466 - val_accuracy30: 0.4165 - val_accuracy50: 0.3964 - 138s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 137s - loss: 12.3645 - accuracy10: 0.4903 - accuracy20: 0.4649 - accuracy30: 0.4476 - accuracy50: 0.4542 - val_loss: 12.6046 - val_accuracy10: 0.4813 - val_accuracy20: 0.4473 - val_accuracy30: 0.4175 - val_accuracy50: 0.3965 - 137s/epoch - 40ms/step
Epoch 11/50
3419/3419 - 136s - loss: 12.3502 - accuracy10: 0.4919 - accuracy20: 0.4662 - accuracy30: 0.4488 - accuracy50: 0.4551 - val_loss: 12.5907 - val_accuracy10: 0.4841 - val_accuracy20: 0.4499 - val_accuracy30: 0.4180 - val_accuracy50: 0.3964 - 136s/epoch - 40ms/step
Epoch 12/50
3419/3419 - 139s - loss: 12.3386 - accuracy10: 0.4928 - accuracy20: 0.4670 - accuracy30: 0.4497 - accuracy50: 0.4562 - val_loss: 12.5824 - val_accuracy10: 0.4838 - val_accuracy20: 0.4506 - val_accuracy30: 0.4195 - val_accuracy50: 0.3986 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 136s - loss: 12.3264 - accuracy10: 0.4940 - accuracy20: 0.4683 - accuracy30: 0.4511 - accuracy50: 0.4574 - val_loss: 12.5650 - val_accuracy10: 0.4854 - val_accuracy20: 0.4516 - val_accuracy30: 0.4211 - val_accuracy50: 0.4013 - 136s/epoch - 40ms/step
Epoch 14/50
3419/3419 - 141s - loss: 12.3158 - accuracy10: 0.4947 - accuracy20: 0.4691 - accuracy30: 0.4515 - accuracy50: 0.4585 - val_loss: 12.5750 - val_accuracy10: 0.4846 - val_accuracy20: 0.4504 - val_accuracy30: 0.4185 - val_accuracy50: 0.3980 - 141s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 138s - loss: 12.3024 - accuracy10: 0.4964 - accuracy20: 0.4702 - accuracy30: 0.4527 - accuracy50: 0.4597 - val_loss: 12.5600 - val_accuracy10: 0.4861 - val_accuracy20: 0.4532 - val_accuracy30: 0.4209 - val_accuracy50: 0.4019 - 138s/epoch - 40ms/step
Epoch 16/50
3419/3419 - 139s - loss: 12.2909 - accuracy10: 0.4969 - accuracy20: 0.4713 - accuracy30: 0.4537 - accuracy50: 0.4606 - val_loss: 12.5501 - val_accuracy10: 0.4863 - val_accuracy20: 0.4545 - val_accuracy30: 0.4227 - val_accuracy50: 0.4038 - 139s/epoch - 41ms/step
Epoch 17/50
3419/3419 - 138s - loss: 12.2780 - accuracy10: 0.4980 - accuracy20: 0.4722 - accuracy30: 0.4538 - accuracy50: 0.4614 - val_loss: 12.5472 - val_accuracy10: 0.4868 - val_accuracy20: 0.4529 - val_accuracy30: 0.4217 - val_accuracy50: 0.4039 - 138s/epoch - 40ms/step
Epoch 18/50
3419/3419 - 141s - loss: 12.2667 - accuracy10: 0.4991 - accuracy20: 0.4732 - accuracy30: 0.4554 - accuracy50: 0.4624 - val_loss: 12.5313 - val_accuracy10: 0.4866 - val_accuracy20: 0.4552 - val_accuracy30: 0.4255 - val_accuracy50: 0.4094 - 141s/epoch - 41ms/step
Epoch 19/50
3419/3419 - 140s - loss: 12.2581 - accuracy10: 0.4999 - accuracy20: 0.4738 - accuracy30: 0.4562 - accuracy50: 0.4632 - val_loss: 12.5328 - val_accuracy10: 0.4881 - val_accuracy20: 0.4553 - val_accuracy30: 0.4251 - val_accuracy50: 0.4063 - 140s/epoch - 41ms/step
Epoch 20/50
3419/3419 - 141s - loss: 12.2457 - accuracy10: 0.5007 - accuracy20: 0.4748 - accuracy30: 0.4568 - accuracy50: 0.4641 - val_loss: 12.5227 - val_accuracy10: 0.4885 - val_accuracy20: 0.4569 - val_accuracy30: 0.4268 - val_accuracy50: 0.4107 - 141s/epoch - 41ms/step
Epoch 21/50
3419/3419 - 136s - loss: 12.2350 - accuracy10: 0.5017 - accuracy20: 0.4759 - accuracy30: 0.4584 - accuracy50: 0.4648 - val_loss: 12.5179 - val_accuracy10: 0.4895 - val_accuracy20: 0.4573 - val_accuracy30: 0.4267 - val_accuracy50: 0.4105 - 136s/epoch - 40ms/step
Epoch 22/50
3419/3419 - 143s - loss: 12.2282 - accuracy10: 0.5024 - accuracy20: 0.4764 - accuracy30: 0.4591 - accuracy50: 0.4658 - val_loss: 12.5235 - val_accuracy10: 0.4888 - val_accuracy20: 0.4569 - val_accuracy30: 0.4269 - val_accuracy50: 0.4098 - 143s/epoch - 42ms/step
Epoch 23/50
3419/3419 - 141s - loss: 12.2167 - accuracy10: 0.5030 - accuracy20: 0.4771 - accuracy30: 0.4598 - accuracy50: 0.4665 - val_loss: 12.5247 - val_accuracy10: 0.4882 - val_accuracy20: 0.4565 - val_accuracy30: 0.4269 - val_accuracy50: 0.4108 - 141s/epoch - 41ms/step
Epoch 24/50
3419/3419 - 140s - loss: 12.2078 - accuracy10: 0.5037 - accuracy20: 0.4781 - accuracy30: 0.4607 - accuracy50: 0.4676 - val_loss: 12.5243 - val_accuracy10: 0.4886 - val_accuracy20: 0.4562 - val_accuracy30: 0.4258 - val_accuracy50: 0.4107 - 140s/epoch - 41ms/step
Epoch 25/50
3419/3419 - 145s - loss: 12.1997 - accuracy10: 0.5045 - accuracy20: 0.4790 - accuracy30: 0.4613 - accuracy50: 0.4686 - val_loss: 12.5157 - val_accuracy10: 0.4901 - val_accuracy20: 0.4578 - val_accuracy30: 0.4281 - val_accuracy50: 0.4118 - 145s/epoch - 42ms/step
Epoch 26/50
3419/3419 - 142s - loss: 12.1925 - accuracy10: 0.5052 - accuracy20: 0.4797 - accuracy30: 0.4622 - accuracy50: 0.4691 - val_loss: 12.5091 - val_accuracy10: 0.4896 - val_accuracy20: 0.4585 - val_accuracy30: 0.4298 - val_accuracy50: 0.4151 - 142s/epoch - 41ms/step
Epoch 27/50
3419/3419 - 142s - loss: 12.1821 - accuracy10: 0.5061 - accuracy20: 0.4804 - accuracy30: 0.4626 - accuracy50: 0.4696 - val_loss: 12.5200 - val_accuracy10: 0.4885 - val_accuracy20: 0.4570 - val_accuracy30: 0.4282 - val_accuracy50: 0.4138 - 142s/epoch - 41ms/step
Epoch 28/50
3419/3419 - 140s - loss: 12.1727 - accuracy10: 0.5063 - accuracy20: 0.4811 - accuracy30: 0.4642 - accuracy50: 0.4712 - val_loss: 12.5335 - val_accuracy10: 0.4871 - val_accuracy20: 0.4559 - val_accuracy30: 0.4279 - val_accuracy50: 0.4134 - 140s/epoch - 41ms/step
Epoch 29/50
3419/3419 - 137s - loss: 12.1641 - accuracy10: 0.5066 - accuracy20: 0.4816 - accuracy30: 0.4646 - accuracy50: 0.4722 - val_loss: 12.5217 - val_accuracy10: 0.4889 - val_accuracy20: 0.4565 - val_accuracy30: 0.4270 - val_accuracy50: 0.4137 - 137s/epoch - 40ms/step
Epoch 30/50
3419/3419 - 141s - loss: 12.1570 - accuracy10: 0.5070 - accuracy20: 0.4820 - accuracy30: 0.4658 - accuracy50: 0.4726 - val_loss: 12.5348 - val_accuracy10: 0.4870 - val_accuracy20: 0.4556 - val_accuracy30: 0.4265 - val_accuracy50: 0.4126 - 141s/epoch - 41ms/step
Epoch 31/50
3419/3419 - 139s - loss: 12.1491 - accuracy10: 0.5082 - accuracy20: 0.4825 - accuracy30: 0.4661 - accuracy50: 0.4737 - val_loss: 12.5381 - val_accuracy10: 0.4874 - val_accuracy20: 0.4563 - val_accuracy30: 0.4270 - val_accuracy50: 0.4116 - 139s/epoch - 41ms/step
Epoch 32/50
3419/3419 - 139s - loss: 12.1407 - accuracy10: 0.5086 - accuracy20: 0.4836 - accuracy30: 0.4668 - accuracy50: 0.4744 - val_loss: 12.5478 - val_accuracy10: 0.4874 - val_accuracy20: 0.4552 - val_accuracy30: 0.4255 - val_accuracy50: 0.4116 - 139s/epoch - 41ms/step
Epoch 33/50
3419/3419 - 137s - loss: 12.1308 - accuracy10: 0.5089 - accuracy20: 0.4847 - accuracy30: 0.4683 - accuracy50: 0.4756 - val_loss: 12.5360 - val_accuracy10: 0.4873 - val_accuracy20: 0.4562 - val_accuracy30: 0.4284 - val_accuracy50: 0.4148 - 137s/epoch - 40ms/step
Epoch 34/50
3419/3419 - 139s - loss: 12.1262 - accuracy10: 0.5088 - accuracy20: 0.4848 - accuracy30: 0.4691 - accuracy50: 0.4768 - val_loss: 12.5488 - val_accuracy10: 0.4859 - val_accuracy20: 0.4540 - val_accuracy30: 0.4264 - val_accuracy50: 0.4137 - 139s/epoch - 41ms/step
Epoch 35/50
3419/3419 - 138s - loss: 12.1185 - accuracy10: 0.5095 - accuracy20: 0.4854 - accuracy30: 0.4697 - accuracy50: 0.4772 - val_loss: 12.5613 - val_accuracy10: 0.4857 - val_accuracy20: 0.4532 - val_accuracy30: 0.4262 - val_accuracy50: 0.4129 - 138s/epoch - 40ms/step
Epoch 36/50
3419/3419 - 143s - loss: 12.1113 - accuracy10: 0.5095 - accuracy20: 0.4857 - accuracy30: 0.4704 - accuracy50: 0.4785 - val_loss: 12.5530 - val_accuracy10: 0.4871 - val_accuracy20: 0.4546 - val_accuracy30: 0.4270 - val_accuracy50: 0.4132 - 143s/epoch - 42ms/step
testing model: results/AAPL/W9/deepVOL_L3/seq2seq
Evaluating performance on  test set...
10303/10303 - 161s - 161s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0089531
{'0': {'precision': 0.462788671778097, 'recall': 0.48781769289615756, 'f1-score': 0.47497368112537014, 'support': 822217}, '1': {'precision': 0.4949675573984489, 'recall': 0.5224362805983819, 'f1-score': 0.5083311071702822, 'support': 987062}, '2': {'precision': 0.48317621992127635, 'recall': 0.4252703396226415, 'f1-score': 0.45237777166918003, 'support': 828125}, 'accuracy': 0.48113447920758445, 'macro avg': {'precision': 0.4803108163659407, 'recall': 0.4785081043723937, 'f1-score': 0.47856085332161075, 'support': 2637404}, 'weighted avg': {'precision': 0.4812333217082048, 'recall': 0.48113447920758445, 'f1-score': 0.48036292378532497, 'support': 2637404}}
[[401092 256350 164775]
 [259458 515677 211927]
 [206135 269813 352177]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.039025
{'0': {'precision': 0.4489200183929912, 'recall': 0.44253403514563083, 'f1-score': 0.4457041535870793, 'support': 836121}, '1': {'precision': 0.4336838125922211, 'recall': 0.5329206869348868, 'f1-score': 0.47820815117715176, 'support': 955782}, '2': {'precision': 0.4749831686733783, 'recall': 0.3588014680053601, 'f1-score': 0.4087977895028335, 'support': 845501}, 'accuracy': 0.44844665436163744, 'macro avg': {'precision': 0.4525289998861968, 'recall': 0.44475206336195927, 'f1-score': 0.4442366980890215, 'support': 2637404}, 'weighted avg': {'precision': 0.4517538384571702, 'recall': 0.44844665436163744, 'f1-score': 0.44565196897108605, 'support': 2637404}}
[[370012 323995 142114]
 [253217 509356 193209]
 [200998 341136 303367]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620204
{'0': {'precision': 0.45774145612103234, 'recall': 0.3496768819192712, 'f1-score': 0.39647750753364674, 'support': 857117}, '1': {'precision': 0.38230901052884264, 'recall': 0.6290436719311431, 'f1-score': 0.47557902987999484, 'support': 911455}, '2': {'precision': 0.48377979364195245, 'recall': 0.26891274722846303, 'f1-score': 0.34567780680125965, 'support': 868832}, 'accuracy': 0.41961678984334594, 'macro avg': {'precision': 0.44127675343060907, 'recall': 0.4158777670262925, 'f1-score': 0.4059114480716337, 'support': 2637404}, 'weighted avg': {'precision': 0.44025064362804556, 'recall': 0.41961678984334594, 'f1-score': 0.40707924790541733, 'support': 2637404}}
[[299714 451241 106162]
 [194965 573345 143145]
 [160088 475104 233640]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0653274
{'0': {'precision': 0.43861353271561065, 'recall': 0.24356005215794851, 'f1-score': 0.3132010305711174, 'support': 808314}, '1': {'precision': 0.40554585418357886, 'recall': 0.7551880449011455, 'f1-score': 0.5277064467233367, 'support': 1006834}, '2': {'precision': 0.46797779853541743, 'recall': 0.1785234768733825, 'f1-score': 0.25845277301662334, 'support': 822256}, 'accuracy': 0.4185987433097091, 'macro avg': {'precision': 0.43737906181153563, 'recall': 0.3924238579774922, 'f1-score': 0.3664534167703591, 'support': 2637404}, 'weighted avg': {'precision': 0.43514469772059716, 'recall': 0.4185987433097091, 'f1-score': 0.37802017200810445, 'support': 2637404}}
[[196873 544407  67034]
 [146638 760349  99847]
 [105342 570122 146792]]
Evaluating performance on  train set...
3419/3419 - 55s - 55s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0019103
{'0': {'precision': 0.48021500930328714, 'recall': 0.5194114469913548, 'f1-score': 0.4990447607274362, 'support': 290679}, '1': {'precision': 0.5023071642403697, 'recall': 0.49200049910230903, 'f1-score': 0.49710041392641774, 'support': 288518}, '2': {'precision': 0.5013104392937648, 'recall': 0.4711495250999301, 'f1-score': 0.4857622607592996, 'support': 295957}, 'accuracy': 0.49405361799180486, 'macro avg': {'precision': 0.49461087094580725, 'recall': 0.49418715706453126, 'f1-score': 0.4939691451377179, 'support': 875154}, 'weighted avg': {'precision': 0.4946322713301179, 'recall': 0.49405361799180486, 'f1-score': 0.4939119179438735, 'support': 875154}}
[[150982  68711  70986]
 [ 78842 141951  67725]
 [ 84581  71936 139440]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0342071
{'0': {'precision': 0.45928683752514604, 'recall': 0.4909904934171919, 'f1-score': 0.47460980838692995, 'support': 289694}, '1': {'precision': 0.4395306859205776, 'recall': 0.4852399484795567, 'f1-score': 0.4612556659081871, 'support': 288041}, '2': {'precision': 0.4919484214056824, 'recall': 0.4093248918192853, 'f1-score': 0.4468494327253774, 'support': 297419}, 'accuracy': 0.46134394632259007, 'macro avg': {'precision': 0.46358864828380203, 'recall': 0.46185177790534465, 'f1-score': 0.4609049690068315, 'support': 875154}, 'weighted avg': {'precision': 0.46388442143818737, 'recall': 0.46134394632259007, 'f1-score': 0.4607802381368907, 'support': 875154}}
[[142237  86786  60671]
 [ 83217 139769  65055]
 [ 84237  91441 121741]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0527298
{'0': {'precision': 0.45784430093173706, 'recall': 0.41873257217374416, 'f1-score': 0.4374158791231683, 'support': 288332}, '1': {'precision': 0.3953711718195345, 'recall': 0.5632009143490458, 'f1-score': 0.46459396990380303, 'support': 288730}, '2': {'precision': 0.49321795954256825, 'recall': 0.3311829904861586, 'f1-score': 0.3962765904068817, 'support': 298092}, 'accuracy': 0.43657459144333455, 'macro avg': {'precision': 0.4488111440979466, 'recall': 0.4377054923363162, 'f1-score': 0.43276214647795097, 'support': 875154}, 'weighted avg': {'precision': 0.44928207996725955, 'recall': 0.43657459144333455, 'f1-score': 0.43236972415967306, 'support': 875154}}
[[120734 119888  47710]
 [ 72389 162613  53728]
 [ 70578 128791  98723]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0683799
{'0': {'precision': 0.4611200212481229, 'recall': 0.31536091549295775, 'f1-score': 0.3745596966314977, 'support': 286272}, '1': {'precision': 0.3780901717192261, 'recall': 0.699009600424999, 'f1-score': 0.49074127892896247, 'support': 289883}, '2': {'precision': 0.49256478363624956, 'recall': 0.23629844915869283, 'f1-score': 0.3193803425564712, 'support': 298999}, 'accuracy': 0.4154274561962809, 'macro avg': {'precision': 0.4439249922011996, 'recall': 0.41688965502554987, 'f1-score': 0.3948937727056438, 'support': 875154}, 'weighted avg': {'precision': 0.44436069733290606, 'recall': 0.4154274561962809, 'f1-score': 0.3941910917140285, 'support': 875154}}
[[ 90279 159339  36654]
 [ 51120 202631  36132]
 [ 54383 173963  70653]]
Evaluating performance on  val set...
1396/1396 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.006534
{'0': {'precision': 0.46765475990295224, 'recall': 0.5024691570452707, 'f1-score': 0.4844372742316098, 'support': 116234}, '1': {'precision': 0.5162695689641416, 'recall': 0.5106507241229628, 'f1-score': 0.5134447746507373, 'support': 126705}, '2': {'precision': 0.4827141696169187, 'recall': 0.45200171438068, 'f1-score': 0.46685337428855367, 'support': 114327}, 'accuracy': 0.4892209166279467, 'macro avg': {'precision': 0.4888794994946708, 'recall': 0.4883738651829712, 'f1-score': 0.488245141056967, 'support': 357266}, 'weighted avg': {'precision': 0.48971517571768586, 'recall': 0.4892209166279467, 'f1-score': 0.48909789352316224, 'support': 357266}}
[[58404 30463 27367]
 [33993 64702 28010]
 [32490 30161 51676]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0377911
{'0': {'precision': 0.45728127814282377, 'recall': 0.46327287472650014, 'f1-score': 0.46025757772863274, 'support': 118373}, '1': {'precision': 0.44752377026847656, 'recall': 0.5225253884742445, 'f1-score': 0.4821251166571334, 'support': 122595}, '2': {'precision': 0.47657668177620194, 'recall': 0.38602555503963953, 'f1-score': 0.42654834464771807, 'support': 116298}, 'accuracy': 0.4584595231564157, 'macro avg': {'precision': 0.4604605767291674, 'recall': 0.45727460608012804, 'f1-score': 0.4563103463444948, 'support': 357266}, 'weighted avg': {'precision': 0.4602140933950421, 'recall': 0.4584595231564157, 'f1-score': 0.45678827067477185, 'support': 357266}}
[[54839 39753 23781]
 [33010 64059 25526]
 [32075 39329 44894]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0579507
{'0': {'precision': 0.45479295612362475, 'recall': 0.3759757228357077, 'f1-score': 0.41164553924531955, 'support': 118630}, '1': {'precision': 0.3966339001206429, 'recall': 0.603808237454806, 'f1-score': 0.47876995010840323, 'support': 121421}, '2': {'precision': 0.4740020443296751, 'recall': 0.30066970950816874, 'f1-score': 0.3679443745530284, 'support': 117215}, 'accuracy': 0.42870018417649597, 'macro avg': {'precision': 0.4418096335246476, 'recall': 0.4268178899328941, 'f1-score': 0.41945328796891707, 'support': 357266}, 'weighted avg': {'precision': 0.44132921352044996, 'recall': 0.42870018417649597, 'f1-score': 0.42012068401700114, 'support': 357266}}
[[44602 55543 18485]
 [27482 73315 20624]
 [25987 55985 35243]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0688423
{'0': {'precision': 0.44969638224477576, 'recall': 0.2717921326050623, 'f1-score': 0.33881049036664734, 'support': 116074}, '1': {'precision': 0.392323649688406, 'recall': 0.7343507563038583, 'f1-score': 0.5114222304727654, 'support': 125677}, '2': {'precision': 0.47092731829573936, 'recall': 0.21146171492879712, 'f1-score': 0.29186605729306686, 'support': 115515}, 'accuracy': 0.4150017074112846, 'macro avg': {'precision': 0.4376491167429737, 'recall': 0.4058682012792392, 'f1-score': 0.38069959271082654, 'support': 357266}, 'weighted avg': {'precision': 0.43637873843999214, 'recall': 0.4150017074112846, 'f1-score': 0.3843522980808489, 'support': 357266}}
[[31548 71028 13498]
 [19441 92291 13945]
 [19165 71923 24427]]
training model: results/AAPL/W10/deepLOB_L1/seq2seq
Epoch 1/50
5429/5429 - 123s - loss: 12.8956 - accuracy10: 0.4214 - accuracy20: 0.4103 - accuracy30: 0.4030 - accuracy50: 0.4034 - val_loss: 13.6312 - val_accuracy10: 0.3350 - val_accuracy20: 0.3308 - val_accuracy30: 0.3142 - val_accuracy50: 0.3280 - 123s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 143s - loss: 12.8249 - accuracy10: 0.4316 - accuracy20: 0.4187 - accuracy30: 0.4113 - accuracy50: 0.4099 - val_loss: 13.3697 - val_accuracy10: 0.3923 - val_accuracy20: 0.3770 - val_accuracy30: 0.3743 - val_accuracy50: 0.3587 - 143s/epoch - 26ms/step
Epoch 3/50
5429/5429 - 132s - loss: 12.8047 - accuracy10: 0.4342 - accuracy20: 0.4211 - accuracy30: 0.4137 - accuracy50: 0.4126 - val_loss: 13.1856 - val_accuracy10: 0.3864 - val_accuracy20: 0.3768 - val_accuracy30: 0.3895 - val_accuracy50: 0.3641 - 132s/epoch - 24ms/step
Epoch 4/50
5429/5429 - 135s - loss: 12.7913 - accuracy10: 0.4357 - accuracy20: 0.4224 - accuracy30: 0.4153 - accuracy50: 0.4144 - val_loss: 13.1702 - val_accuracy10: 0.3847 - val_accuracy20: 0.3775 - val_accuracy30: 0.3977 - val_accuracy50: 0.3694 - 135s/epoch - 25ms/step
Epoch 5/50
5429/5429 - 129s - loss: 12.7818 - accuracy10: 0.4371 - accuracy20: 0.4232 - accuracy30: 0.4160 - accuracy50: 0.4150 - val_loss: 13.2720 - val_accuracy10: 0.3694 - val_accuracy20: 0.3655 - val_accuracy30: 0.3864 - val_accuracy50: 0.3600 - 129s/epoch - 24ms/step
Epoch 6/50
5429/5429 - 122s - loss: 12.7707 - accuracy10: 0.4382 - accuracy20: 0.4244 - accuracy30: 0.4173 - accuracy50: 0.4167 - val_loss: 13.2418 - val_accuracy10: 0.3669 - val_accuracy20: 0.3625 - val_accuracy30: 0.3747 - val_accuracy50: 0.3550 - 122s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 127s - loss: 12.7621 - accuracy10: 0.4395 - accuracy20: 0.4254 - accuracy30: 0.4182 - accuracy50: 0.4175 - val_loss: 13.1913 - val_accuracy10: 0.3612 - val_accuracy20: 0.3595 - val_accuracy30: 0.3747 - val_accuracy50: 0.3539 - 127s/epoch - 23ms/step
Epoch 8/50
5429/5429 - 129s - loss: 12.7536 - accuracy10: 0.4403 - accuracy20: 0.4263 - accuracy30: 0.4189 - accuracy50: 0.4184 - val_loss: 13.2238 - val_accuracy10: 0.3571 - val_accuracy20: 0.3548 - val_accuracy30: 0.3670 - val_accuracy50: 0.3498 - 129s/epoch - 24ms/step
Epoch 9/50
5429/5429 - 126s - loss: 12.7483 - accuracy10: 0.4409 - accuracy20: 0.4263 - accuracy30: 0.4194 - accuracy50: 0.4187 - val_loss: 13.3204 - val_accuracy10: 0.3510 - val_accuracy20: 0.3490 - val_accuracy30: 0.3557 - val_accuracy50: 0.3444 - 126s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 127s - loss: 12.7431 - accuracy10: 0.4417 - accuracy20: 0.4272 - accuracy30: 0.4200 - accuracy50: 0.4194 - val_loss: 13.2340 - val_accuracy10: 0.3577 - val_accuracy20: 0.3565 - val_accuracy30: 0.3721 - val_accuracy50: 0.3518 - 127s/epoch - 23ms/step
Epoch 11/50
5429/5429 - 136s - loss: 12.7377 - accuracy10: 0.4422 - accuracy20: 0.4278 - accuracy30: 0.4206 - accuracy50: 0.4197 - val_loss: 13.2264 - val_accuracy10: 0.3577 - val_accuracy20: 0.3586 - val_accuracy30: 0.3785 - val_accuracy50: 0.3541 - 136s/epoch - 25ms/step
Epoch 12/50
5429/5429 - 126s - loss: 12.7325 - accuracy10: 0.4428 - accuracy20: 0.4282 - accuracy30: 0.4206 - accuracy50: 0.4205 - val_loss: 13.2513 - val_accuracy10: 0.3584 - val_accuracy20: 0.3579 - val_accuracy30: 0.3796 - val_accuracy50: 0.3548 - 126s/epoch - 23ms/step
Epoch 13/50
5429/5429 - 134s - loss: 12.7289 - accuracy10: 0.4431 - accuracy20: 0.4285 - accuracy30: 0.4216 - accuracy50: 0.4207 - val_loss: 13.2491 - val_accuracy10: 0.3561 - val_accuracy20: 0.3569 - val_accuracy30: 0.3743 - val_accuracy50: 0.3537 - 134s/epoch - 25ms/step
Epoch 14/50
5429/5429 - 119s - loss: 12.7254 - accuracy10: 0.4438 - accuracy20: 0.4288 - accuracy30: 0.4217 - accuracy50: 0.4211 - val_loss: 13.2667 - val_accuracy10: 0.3596 - val_accuracy20: 0.3581 - val_accuracy30: 0.3766 - val_accuracy50: 0.3542 - 119s/epoch - 22ms/step
testing model: results/AAPL/W10/deepLOB_L1/seq2seq
Evaluating performance on  test set...
22048/22048 - 181s - 181s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1105095
{'0': {'precision': 0.420641065948828, 'recall': 0.4524335201151433, 'f1-score': 0.4359584420620623, 'support': 2146890}, '1': {'precision': 0.2317553499201103, 'recall': 0.22198100900734277, 'f1-score': 0.22676290055186588, 'support': 1319257}, '2': {'precision': 0.4166505334580217, 'recall': 0.3962526648119927, 'f1-score': 0.40619568118180804, 'support': 2177921}, 'accuracy': 0.37688808852054934, 'macro avg': {'precision': 0.3563489831089866, 'recall': 0.35688906464482634, 'f1-score': 0.3563056745985788, 'support': 5644068}, 'weighted avg': {'precision': 0.3749506406060066, 'recall': 0.37688808852054934, 'f1-score': 0.375575820087061, 'support': 5644068}}
[[971325 470559 705006]
 [523123 292850 503284]
 [814706 500208 863007]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1158816
{'0': {'precision': 0.3930846978800905, 'recall': 0.4633984399279759, 'f1-score': 0.4253553344281103, 'support': 2075417}, '1': {'precision': 0.23880487726981323, 'recall': 0.21255636037637604, 'f1-score': 0.22491738908420736, 'support': 1442281}, '2': {'precision': 0.4048919973077711, 'recall': 0.36438813564901684, 'f1-score': 0.3835737690797039, 'support': 2126370}, 'accuracy': 0.3619968788469593, 'macro avg': {'precision': 0.3455938574858916, 'recall': 0.34678097865112295, 'f1-score': 0.3446154975306739, 'support': 5644068}, 'weighted avg': {'precision': 0.35810847741896673, 'recall': 0.3619968788469593, 'f1-score': 0.35839460550733176, 'support': 5644068}}
[[961745 470862 642810]
 [639693 306566 496022]
 [845223 506323 774824]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1188773
{'0': {'precision': 0.38333427547759985, 'recall': 0.48866217209223206, 'f1-score': 0.42963697894488223, 'support': 2039941}, '1': {'precision': 0.25619365606784356, 'recall': 0.22081199455563263, 'f1-score': 0.2371906165677448, 'support': 1510552}, '2': {'precision': 0.39451621422993893, 'recall': 0.3282046260582974, 'f1-score': 0.3583182865285359, 'support': 2093575}, 'accuracy': 0.3574568910225745, 'macro avg': {'precision': 0.3446813819251275, 'recall': 0.34589293090205403, 'f1-score': 0.34171529401372097, 'support': 5644068}, 'weighted avg': {'precision': 0.35345471174675575, 'recall': 0.3574568910225745, 'f1-score': 0.35167702717657223, 'support': 5644068}}
[[996842 468466 574633]
 [697078 333548 479926]
 [906531 499923 687121]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1098398
{'0': {'precision': 0.392139532814238, 'recall': 0.5163498498055135, 'f1-score': 0.44575356134059424, 'support': 2133567}, '1': {'precision': 0.21855328939455154, 'recall': 0.21505883781097548, 'f1-score': 0.21679198282514706, 'support': 1318030}, '2': {'precision': 0.4135908806252305, 'recall': 0.2900809178319804, 'f1-score': 0.34099653424152215, 'support': 2192471}, 'accuracy': 0.35809543754611034, 'macro avg': {'precision': 0.3414279009446733, 'recall': 0.3404965351494898, 'f1-score': 0.3345140261357545, 'support': 5644068}, 'weighted avg': {'precision': 0.35993573611513113, 'recall': 0.35809543754611034, 'f1-score': 0.3515918727692226, 'support': 5644068}}
[[1101667  490637  541263]
 [ 674096  283454  360480]
 [1033612  522865  635994]]
Evaluating performance on  train set...
5429/5429 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1092405
{'0': {'precision': 0.38625818206356705, 'recall': 0.3102181948253249, 'f1-score': 0.3440872367028951, 'support': 461285}, '1': {'precision': 0.33706879988450733, 'recall': 0.6898712313945985, 'f1-score': 0.4528678617219579, 'support': 460283}, '2': {'precision': 0.46473404943703894, 'recall': 0.0766934057766729, 'f1-score': 0.13165951112561367, 'support': 468228}, 'accuracy': 0.357279053904314, 'macro avg': {'precision': 0.39602034379503775, 'recall': 0.3589276106655321, 'f1-score': 0.3095382031834889, 'support': 1389796}, 'weighted avg': {'precision': 0.3964061189053926, 'recall': 0.357279053904314, 'f1-score': 0.3085462388399353, 'support': 1389796}}
[[143099 300015  18171]
 [119558 317536  23189]
 [107818 324500  35910]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1155859
{'0': {'precision': 0.3748098659979857, 'recall': 0.276350316959454, 'f1-score': 0.31813623737753577, 'support': 459207}, '1': {'precision': 0.3335302380578119, 'recall': 0.7254223484271087, 'f1-score': 0.4569615139549893, 'support': 459218}, '2': {'precision': 0.45925841153582053, 'recall': 0.05108078350174279, 'f1-score': 0.09193602889658056, 'support': 471371}, 'accuracy': 0.34832953901148084, 'macro avg': {'precision': 0.3891995051972061, 'recall': 0.35095114962943513, 'f1-score': 0.2890112600763685, 'support': 1389796}, 'weighted avg': {'precision': 0.389812245610018, 'recall': 0.34832953901148084, 'f1-score': 0.2872877152832634, 'support': 1389796}}
[[126902 320000  12305]
 [110046 333127  16045]
 [101629 345664  24078]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1174505
{'0': {'precision': 0.3709102057631568, 'recall': 0.2537280826317008, 'f1-score': 0.3013274629022571, 'support': 457742}, '1': {'precision': 0.3351564914862045, 'recall': 0.7592303363188594, 'f1-score': 0.46502931008567566, 'support': 458434}, '2': {'precision': 0.4683063544449683, 'recall': 0.03774967273341497, 'f1-score': 0.0698674086260595, 'support': 473620}, 'accuracy': 0.3468696125186718, 'macro avg': {'precision': 0.39145768389810986, 'recall': 0.3502360305613251, 'f1-score': 0.2787413938713308, 'support': 1389796}, 'weighted avg': {'precision': 0.3923076235768786, 'recall': 0.3468696125186718, 'f1-score': 0.27644782711786187, 'support': 1389796}}
[[116142 332434   9166]
 [ 99244 348057  11133]
 [ 97741 358000  17879]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1193682
{'0': {'precision': 0.36017741978290296, 'recall': 0.23728802446119582, 'f1-score': 0.2860944987502849, 'support': 457541}, '1': {'precision': 0.33364644690126244, 'recall': 0.7681116854636592, 'f1-score': 0.4652159619247654, 'support': 459648}, '2': {'precision': 0.4538193869096935, 'recall': 0.02897544894595298, 'f1-score': 0.054472912713661184, 'support': 472607}, 'accuracy': 0.34200990648987334, 'macro avg': {'precision': 0.3825477511979529, 'recall': 0.3447917196236027, 'f1-score': 0.26859445779623714, 'support': 1389796}, 'weighted avg': {'precision': 0.3832462302664494, 'recall': 0.34200990648987334, 'f1-score': 0.2665713740565982, 'support': 1389796}}
[[108569 341597   7375]
 [ 97481 353061   9106]
 [ 95382 363531  13694]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0944873
{'0': {'precision': 0.3954975778108476, 'recall': 0.24479037378659804, 'f1-score': 0.30240768911072463, 'support': 153082}, '1': {'precision': 0.3740103640853401, 'recall': 0.7660877335685726, 'f1-score': 0.502631752027135, 'support': 174574}, '2': {'precision': 0.4664135048026295, 'recall': 0.09368570164924268, 'f1-score': 0.15603048871618594, 'support': 156011}, 'accuracy': 0.38420648917540373, 'macro avg': {'precision': 0.4119738155662724, 'recall': 0.36818793633480446, 'f1-score': 0.3203566432846819, 'support': 483667}, 'weighted avg': {'precision': 0.41061656636495225, 'recall': 0.38420648917540373, 'f1-score': 0.3274610050260487, 'support': 483667}}
[[ 37473 107694   7915]
 [ 32029 133739   8806]
 [ 25247 116148  14616]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1012106
{'0': {'precision': 0.3876327585064806, 'recall': 0.22919304933613588, 'f1-score': 0.28806425676451763, 'support': 153194}, '1': {'precision': 0.3688161064834322, 'recall': 0.7927142898609619, 'f1-score': 0.5034148031948917, 'support': 172255}, '2': {'precision': 0.46597820855029976, 'recall': 0.06730586911729386, 'f1-score': 0.11762236912592298, 'support': 158218}, 'accuracy': 0.37693082223926794, 'macro avg': {'precision': 0.4074756911800708, 'recall': 0.36307106943813056, 'f1-score': 0.3030338096951108, 'support': 483667}, 'weighted avg': {'precision': 0.4065598261393826, 'recall': 0.37693082223926794, 'f1-score': 0.30900476706801344, 'support': 483667}}
[[ 35111 112094   5989]
 [ 29491 136549   6215]
 [ 25976 121593  10649]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0944002
{'0': {'precision': 0.3706504441259128, 'recall': 0.2250872178698963, 'f1-score': 0.2800852878464819, 'support': 145899}, '1': {'precision': 0.4002241380223926, 'recall': 0.8136408438945832, 'f1-score': 0.5365320035730204, 'support': 185663}, '2': {'precision': 0.4681044267877412, 'recall': 0.054225699352421025, 'f1-score': 0.09719251730740903, 'support': 152105}, 'accuracy': 0.3972795332325753, 'macro avg': {'precision': 0.4129930029786822, 'recall': 0.3643179203723002, 'f1-score': 0.30460326957563716, 'support': 483667}, 'weighted avg': {'precision': 0.41265037127140664, 'recall': 0.3972795332325753, 'f1-score': 0.32100964638053664, 'support': 483667}}
[[ 32840 108429   4630]
 [ 29858 151063   4742]
 [ 25903 117954   8248]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1074424
{'0': {'precision': 0.3813477376546297, 'recall': 0.22213518062928914, 'f1-score': 0.28073950734966224, 'support': 154460}, '1': {'precision': 0.36318618942133696, 'recall': 0.8223828609600152, 'f1-score': 0.5038560974941304, 'support': 167664}, '2': {'precision': 0.47219255144912053, 'recall': 0.041047894368682024, 'f1-score': 0.07552993974462656, 'support': 161543}, 'accuracy': 0.36972958667843786, 'macro avg': {'precision': 0.4055754928416957, 'recall': 0.36185531198599546, 'f1-score': 0.2867085148628064, 'support': 483667}, 'weighted avg': {'precision': 0.4053938394805071, 'recall': 0.36972958667843786, 'f1-score': 0.28954401704406324, 'support': 483667}}
[[ 34311 116207   3942]
 [ 26310 137884   3470]
 [ 29352 125560   6631]]
training model: results/AAPL/W10/deepOF_L1/seq2seq
Epoch 1/50
5429/5429 - 129s - loss: 12.8999 - accuracy10: 0.4212 - accuracy20: 0.4126 - accuracy30: 0.4061 - accuracy50: 0.4092 - val_loss: 13.3900 - val_accuracy10: 0.3769 - val_accuracy20: 0.3798 - val_accuracy30: 0.3666 - val_accuracy50: 0.3829 - 129s/epoch - 24ms/step
Epoch 2/50
5429/5429 - 125s - loss: 12.8484 - accuracy10: 0.4275 - accuracy20: 0.4175 - accuracy30: 0.4109 - accuracy50: 0.4140 - val_loss: 13.3360 - val_accuracy10: 0.3796 - val_accuracy20: 0.3829 - val_accuracy30: 0.3690 - val_accuracy50: 0.3846 - 125s/epoch - 23ms/step
Epoch 3/50
5429/5429 - 111s - loss: 12.8279 - accuracy10: 0.4306 - accuracy20: 0.4199 - accuracy30: 0.4132 - accuracy50: 0.4157 - val_loss: 13.3421 - val_accuracy10: 0.3811 - val_accuracy20: 0.3833 - val_accuracy30: 0.3690 - val_accuracy50: 0.3847 - 111s/epoch - 21ms/step
Epoch 4/50
5429/5429 - 126s - loss: 12.8137 - accuracy10: 0.4326 - accuracy20: 0.4211 - accuracy30: 0.4147 - accuracy50: 0.4169 - val_loss: 13.3224 - val_accuracy10: 0.3831 - val_accuracy20: 0.3848 - val_accuracy30: 0.3706 - val_accuracy50: 0.3866 - 126s/epoch - 23ms/step
Epoch 5/50
5429/5429 - 126s - loss: 12.8031 - accuracy10: 0.4340 - accuracy20: 0.4226 - accuracy30: 0.4156 - accuracy50: 0.4181 - val_loss: 13.3257 - val_accuracy10: 0.3849 - val_accuracy20: 0.3853 - val_accuracy30: 0.3716 - val_accuracy50: 0.3873 - 126s/epoch - 23ms/step
Epoch 6/50
5429/5429 - 111s - loss: 12.7944 - accuracy10: 0.4354 - accuracy20: 0.4232 - accuracy30: 0.4162 - accuracy50: 0.4188 - val_loss: 13.2960 - val_accuracy10: 0.3874 - val_accuracy20: 0.3851 - val_accuracy30: 0.3708 - val_accuracy50: 0.3865 - 111s/epoch - 20ms/step
Epoch 7/50
5429/5429 - 120s - loss: 12.7872 - accuracy10: 0.4358 - accuracy20: 0.4243 - accuracy30: 0.4172 - accuracy50: 0.4195 - val_loss: 13.3048 - val_accuracy10: 0.3862 - val_accuracy20: 0.3856 - val_accuracy30: 0.3710 - val_accuracy50: 0.3865 - 120s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 123s - loss: 12.7811 - accuracy10: 0.4372 - accuracy20: 0.4252 - accuracy30: 0.4180 - accuracy50: 0.4200 - val_loss: 13.2921 - val_accuracy10: 0.3893 - val_accuracy20: 0.3865 - val_accuracy30: 0.3715 - val_accuracy50: 0.3875 - 123s/epoch - 23ms/step
Epoch 9/50
5429/5429 - 121s - loss: 12.7754 - accuracy10: 0.4373 - accuracy20: 0.4255 - accuracy30: 0.4184 - accuracy50: 0.4206 - val_loss: 13.2919 - val_accuracy10: 0.3888 - val_accuracy20: 0.3864 - val_accuracy30: 0.3713 - val_accuracy50: 0.3870 - 121s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 127s - loss: 12.7708 - accuracy10: 0.4381 - accuracy20: 0.4262 - accuracy30: 0.4190 - accuracy50: 0.4212 - val_loss: 13.2938 - val_accuracy10: 0.3882 - val_accuracy20: 0.3862 - val_accuracy30: 0.3713 - val_accuracy50: 0.3864 - 127s/epoch - 23ms/step
Epoch 11/50
5429/5429 - 123s - loss: 12.7657 - accuracy10: 0.4389 - accuracy20: 0.4265 - accuracy30: 0.4197 - accuracy50: 0.4214 - val_loss: 13.2947 - val_accuracy10: 0.3883 - val_accuracy20: 0.3864 - val_accuracy30: 0.3712 - val_accuracy50: 0.3860 - 123s/epoch - 23ms/step
Epoch 12/50
5429/5429 - 121s - loss: 12.7615 - accuracy10: 0.4394 - accuracy20: 0.4270 - accuracy30: 0.4201 - accuracy50: 0.4217 - val_loss: 13.2682 - val_accuracy10: 0.3922 - val_accuracy20: 0.3873 - val_accuracy30: 0.3717 - val_accuracy50: 0.3870 - 121s/epoch - 22ms/step
Epoch 13/50
5429/5429 - 116s - loss: 12.7570 - accuracy10: 0.4400 - accuracy20: 0.4279 - accuracy30: 0.4208 - accuracy50: 0.4223 - val_loss: 13.2786 - val_accuracy10: 0.3898 - val_accuracy20: 0.3872 - val_accuracy30: 0.3722 - val_accuracy50: 0.3875 - 116s/epoch - 21ms/step
Epoch 14/50
5429/5429 - 123s - loss: 12.7529 - accuracy10: 0.4403 - accuracy20: 0.4284 - accuracy30: 0.4212 - accuracy50: 0.4225 - val_loss: 13.2610 - val_accuracy10: 0.3919 - val_accuracy20: 0.3869 - val_accuracy30: 0.3715 - val_accuracy50: 0.3867 - 123s/epoch - 23ms/step
Epoch 15/50
5429/5429 - 121s - loss: 12.7482 - accuracy10: 0.4408 - accuracy20: 0.4287 - accuracy30: 0.4214 - accuracy50: 0.4229 - val_loss: 13.2534 - val_accuracy10: 0.3947 - val_accuracy20: 0.3879 - val_accuracy30: 0.3722 - val_accuracy50: 0.3874 - 121s/epoch - 22ms/step
Epoch 16/50
5429/5429 - 121s - loss: 12.7446 - accuracy10: 0.4412 - accuracy20: 0.4296 - accuracy30: 0.4223 - accuracy50: 0.4238 - val_loss: 13.2597 - val_accuracy10: 0.3930 - val_accuracy20: 0.3877 - val_accuracy30: 0.3720 - val_accuracy50: 0.3871 - 121s/epoch - 22ms/step
Epoch 17/50
5429/5429 - 118s - loss: 12.7407 - accuracy10: 0.4415 - accuracy20: 0.4300 - accuracy30: 0.4228 - accuracy50: 0.4244 - val_loss: 13.2526 - val_accuracy10: 0.3943 - val_accuracy20: 0.3877 - val_accuracy30: 0.3718 - val_accuracy50: 0.3870 - 118s/epoch - 22ms/step
Epoch 18/50
5429/5429 - 116s - loss: 12.7370 - accuracy10: 0.4418 - accuracy20: 0.4301 - accuracy30: 0.4232 - accuracy50: 0.4248 - val_loss: 13.2654 - val_accuracy10: 0.3918 - val_accuracy20: 0.3876 - val_accuracy30: 0.3718 - val_accuracy50: 0.3861 - 116s/epoch - 21ms/step
Epoch 19/50
5429/5429 - 120s - loss: 12.7340 - accuracy10: 0.4421 - accuracy20: 0.4306 - accuracy30: 0.4232 - accuracy50: 0.4250 - val_loss: 13.2610 - val_accuracy10: 0.3914 - val_accuracy20: 0.3876 - val_accuracy30: 0.3719 - val_accuracy50: 0.3866 - 120s/epoch - 22ms/step
Epoch 20/50
5429/5429 - 120s - loss: 12.7300 - accuracy10: 0.4429 - accuracy20: 0.4311 - accuracy30: 0.4241 - accuracy50: 0.4255 - val_loss: 13.2692 - val_accuracy10: 0.3921 - val_accuracy20: 0.3880 - val_accuracy30: 0.3726 - val_accuracy50: 0.3869 - 120s/epoch - 22ms/step
Epoch 21/50
5429/5429 - 116s - loss: 12.7257 - accuracy10: 0.4434 - accuracy20: 0.4317 - accuracy30: 0.4249 - accuracy50: 0.4259 - val_loss: 13.2706 - val_accuracy10: 0.3911 - val_accuracy20: 0.3874 - val_accuracy30: 0.3719 - val_accuracy50: 0.3864 - 116s/epoch - 21ms/step
Epoch 22/50
5429/5429 - 131s - loss: 12.7222 - accuracy10: 0.4432 - accuracy20: 0.4320 - accuracy30: 0.4252 - accuracy50: 0.4265 - val_loss: 13.2712 - val_accuracy10: 0.3911 - val_accuracy20: 0.3873 - val_accuracy30: 0.3710 - val_accuracy50: 0.3852 - 131s/epoch - 24ms/step
Epoch 23/50
5429/5429 - 123s - loss: 12.7188 - accuracy10: 0.4439 - accuracy20: 0.4325 - accuracy30: 0.4255 - accuracy50: 0.4265 - val_loss: 13.2780 - val_accuracy10: 0.3913 - val_accuracy20: 0.3876 - val_accuracy30: 0.3716 - val_accuracy50: 0.3863 - 123s/epoch - 23ms/step
Epoch 24/50
5429/5429 - 114s - loss: 12.7162 - accuracy10: 0.4441 - accuracy20: 0.4326 - accuracy30: 0.4257 - accuracy50: 0.4270 - val_loss: 13.2642 - val_accuracy10: 0.3925 - val_accuracy20: 0.3878 - val_accuracy30: 0.3720 - val_accuracy50: 0.3863 - 114s/epoch - 21ms/step
Epoch 25/50
5429/5429 - 109s - loss: 12.7111 - accuracy10: 0.4444 - accuracy20: 0.4334 - accuracy30: 0.4264 - accuracy50: 0.4277 - val_loss: 13.2750 - val_accuracy10: 0.3919 - val_accuracy20: 0.3880 - val_accuracy30: 0.3720 - val_accuracy50: 0.3862 - 109s/epoch - 20ms/step
Epoch 26/50
5429/5429 - 116s - loss: 12.7084 - accuracy10: 0.4445 - accuracy20: 0.4338 - accuracy30: 0.4269 - accuracy50: 0.4281 - val_loss: 13.2813 - val_accuracy10: 0.3919 - val_accuracy20: 0.3874 - val_accuracy30: 0.3712 - val_accuracy50: 0.3854 - 116s/epoch - 21ms/step
Epoch 27/50
5429/5429 - 118s - loss: 12.7049 - accuracy10: 0.4454 - accuracy20: 0.4338 - accuracy30: 0.4274 - accuracy50: 0.4288 - val_loss: 13.2718 - val_accuracy10: 0.3925 - val_accuracy20: 0.3878 - val_accuracy30: 0.3711 - val_accuracy50: 0.3854 - 118s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L1/seq2seq
Evaluating performance on  test set...
22048/22048 - 184s - 184s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0572853
{'0': {'precision': 0.4428490127078058, 'recall': 0.5317158921583742, 'f1-score': 0.48323073549569107, 'support': 2146889}, '1': {'precision': 0.3266957837672164, 'recall': 0.025854743775843184, 'f1-score': 0.047917306156451574, 'support': 1319255}, '2': {'precision': 0.4381626968719931, 'recall': 0.5958972762531572, 'f1-score': 0.5049996410414351, 'support': 2177919}, 'accuracy': 0.43824103309973683, 'macro avg': {'precision': 0.4025691644490051, 'recall': 0.3844893040624582, 'f1-score': 0.3453825608978593, 'support': 5644063}, 'weighted avg': {'precision': 0.41389077033084537, 'recall': 0.43824103309973683, 'f1-score': 0.3898798098902085, 'support': 5644063}}
[[1141535   35776  969578]
 [ 590590   34109  694556]
 [ 845582   34521 1297816]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0674397
{'0': {'precision': 0.4273686241838009, 'recall': 0.554882543916539, 'f1-score': 0.48284878059415914, 'support': 2075414}, '1': {'precision': 0.30320006139206507, 'recall': 0.002739412596721857, 'f1-score': 0.005429767245626537, 'support': 1442280}, '2': {'precision': 0.4320419346698329, 'recall': 0.5966217528566302, 'f1-score': 0.5011659680339483, 'support': 2126369}, 'accuracy': 0.42951327793470767, 'macro avg': {'precision': 0.38753687341523296, 'recall': 0.384747903123297, 'f1-score': 0.329814838624578, 'support': 5644063}, 'weighted avg': {'precision': 0.39739931799455547, 'recall': 0.42951327793470767, 'f1-score': 0.3677503497238509, 'support': 5644063}}
[[1151611    4707  919096]
 [ 689686    3951  748643]
 [ 853358    4373 1268638]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.074647
{'0': {'precision': 0.4177319137508589, 'recall': 0.5665615491443616, 'f1-score': 0.48089487353817656, 'support': 2039939}, '1': {'precision': 0.3365695792880259, 'recall': 0.0005507923929744842, 'f1-score': 0.001099784999963649, 'support': 1510551}, '2': {'precision': 0.42595783728053727, 'recall': 0.5849187011869182, 'f1-score': 0.4929399297766801, 'support': 2093573}, 'accuracy': 0.42188632550699734, 'macro avg': {'precision': 0.39341977677314066, 'recall': 0.38401034757475144, 'f1-score': 0.3249781961049401, 'support': 5644063}, 'weighted avg': {'precision': 0.3990612727457235, 'recall': 0.42188632550699734, 'f1-score': 0.35695264499429363, 'support': 5644063}}
[[1155751     845  883343]
 [ 742770     832  766949]
 [ 868208     795 1224570]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0625682
{'0': {'precision': 0.4302203979882937, 'recall': 0.569777077437492, 'f1-score': 0.4902606797389996, 'support': 2133566}, '1': {'precision': 0.2706983441324694, 'recall': 0.00028527445147261555, 'f1-score': 0.0005699482650683861, 'support': 1318029}, '2': {'precision': 0.44059186095342834, 'recall': 0.5660985701957794, 'f1-score': 0.4955215919573305, 'support': 2192468}, 'accuracy': 0.43535764926791215, 'macro avg': {'precision': 0.38050353435806383, 'recall': 0.3787203073615813, 'f1-score': 0.32878407332046616, 'support': 5644063}, 'weighted avg': {'precision': 0.3969968864050078, 'recall': 0.43535764926791215, 'f1-score': 0.3779493530538873, 'support': 5644063}}
[[1215657     494  917415]
 [ 659208     376  658445]
 [ 950796     519 1241153]]
Evaluating performance on  train set...
5429/5429 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0763804
{'0': {'precision': 0.4126872371591929, 'recall': 0.5676406422302575, 'f1-score': 0.4779177523486756, 'support': 461579}, '1': {'precision': 0.48039492242595205, 'recall': 0.044415272803143585, 'f1-score': 0.0813127173471905, 'support': 460112}, '2': {'precision': 0.4072406701620658, 'recall': 0.6197426212978312, 'f1-score': 0.4915063419708607, 'support': 468104}, 'accuracy': 0.4119679521080447, 'macro avg': {'precision': 0.4334409432490703, 'recall': 0.41059951211041074, 'f1-score': 0.35024560388890896, 'support': 1389795}, 'weighted avg': {'precision': 0.4332683722804417, 'recall': 0.4119679521080447, 'f1-score': 0.3511926866317174, 'support': 1389795}}
[[262011  10786 188782]
 [206197  20436 233479]
 [166682  11318 290104]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0880934
{'0': {'precision': 0.4005977485591044, 'recall': 0.5908323470027154, 'f1-score': 0.4774640371413275, 'support': 459616}, '1': {'precision': 0.4588511924756466, 'recall': 0.002980105721759353, 'f1-score': 0.00592175138181424, 'support': 458373}, '2': {'precision': 0.40591389128291355, 'recall': 0.6099307766327685, 'f1-score': 0.48743549634256955, 'support': 471806}, 'accuracy': 0.4034343194499908, 'macro avg': {'precision': 0.4217876107725549, 'recall': 0.40124774311908107, 'f1-score': 0.3236070949552371, 'support': 1389795}, 'weighted avg': {'precision': 0.4216152323479414, 'recall': 0.4034343194499908, 'f1-score': 0.3253281769097508, 'support': 1389795}}
[[271556    809 187251]
 [223086   1366 233921]
 [183235    802 287769]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950072
{'0': {'precision': 0.39460136038851895, 'recall': 0.6025008463562996, 'f1-score': 0.4768771987449327, 'support': 457845}, '1': {'precision': 0.4341906202723147, 'recall': 0.000626422820124979, 'f1-score': 0.001251040717670187, 'support': 458157}, '2': {'precision': 0.40613909623530403, 'recall': 0.5915325891264751, 'f1-score': 0.48161036274059993, 'support': 473793}, 'accuracy': 0.40034897233045164, 'macro avg': {'precision': 0.41164369229871256, 'recall': 0.39821995276763317, 'f1-score': 0.3199128674010676, 'support': 1389795}, 'weighted avg': {'precision': 0.41158558829309194, 'recall': 0.40034897233045164, 'f1-score': 0.3216968205493734, 'support': 1389795}}
[[275852    184 181809]
 [229874    287 227996]
 [193339    190 280264]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001334
{'0': {'precision': 0.38849094108083426, 'recall': 0.6097798111418447, 'f1-score': 0.4746085811993137, 'support': 457698}, '1': {'precision': 0.39400921658986177, 'recall': 0.00037243298928656214, 'f1-score': 0.0007441625668821546, 'support': 459143}, '2': {'precision': 0.402470813902017, 'recall': 0.5709625037530077, 'f1-score': 0.4721345354124068, 'support': 472954}, 'accuracy': 0.3952417442860278, 'macro avg': {'precision': 0.394990323857571, 'recall': 0.3937049159613797, 'f1-score': 0.3158290930595342, 'support': 1389795}, 'weighted avg': {'precision': 0.39507141830395787, 'recall': 0.3952417442860278, 'f1-score': 0.31721728203990435, 'support': 1389795}}
[[279095    131 178472]
 [236530    171 222442]
 [202783    132 270039]]
Evaluating performance on  val set...
1890/1890 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0883723
{'0': {'precision': 0.39198005943107994, 'recall': 0.550878362481374, 'f1-score': 0.4580397825301385, 'support': 153012}, '1': {'precision': 0.515743280307186, 'recall': 0.05371681264247639, 'f1-score': 0.09729947893759151, 'support': 175029}, '2': {'precision': 0.38712369907107885, 'recall': 0.622871499620886, 'f1-score': 0.47748408961046634, 'support': 155626}, 'accuracy': 0.394130672549502, 'macro avg': {'precision': 0.4316156796031149, 'recall': 0.4091555582482454, 'f1-score': 0.3442744503593988, 'support': 483667}, 'weighted avg': {'precision': 0.43520479225208786, 'recall': 0.394130672549502, 'f1-score': 0.333751842968794, 'support': 483667}}
[[84291  4305 64416]
 [76580  9402 89047]
 [54168  4523 96935]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0990005
{'0': {'precision': 0.3822582030578938, 'recall': 0.5808891673519468, 'f1-score': 0.4610917417409639, 'support': 153222}, '1': {'precision': 0.4833232261976956, 'recall': 0.004621281086377948, 'f1-score': 0.00915502664951296, 'support': 172463}, '2': {'precision': 0.39151530231400844, 'recall': 0.6175197174361636, 'f1-score': 0.47920719127615674, 'support': 157982}, 'accuracy': 0.3873718901641005, 'macro avg': {'precision': 0.41903224385653265, 'recall': 0.40101005529149614, 'f1-score': 0.3164846532222112, 'support': 483667}, 'weighted avg': {'precision': 0.4213190282546493, 'recall': 0.3873718901641005, 'f1-score': 0.3058600497993014, 'support': 483667}}
[[89005   421 63796]
 [83841   797 87825]
 [59994   431 97557]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.116939
{'0': {'precision': 0.36443124502256435, 'recall': 0.6021643923869314, 'f1-score': 0.45406271398855286, 'support': 145907}, '1': {'precision': 0.4845679012345679, 'recall': 0.0008454405445283303, 'f1-score': 0.0016879360949544687, 'support': 185702}, '2': {'precision': 0.3790840230335803, 'recall': 0.6039471780504807, 'f1-score': 0.46579747560947776, 'support': 152058}, 'accuracy': 0.37185088087465135, 'macro avg': {'precision': 0.4093610564302375, 'recall': 0.40231900366064677, 'f1-score': 0.3071827085643284, 'support': 483667}, 'weighted avg': {'precision': 0.4151638553736542, 'recall': 0.37185088087465135, 'f1-score': 0.28406447838049526, 'support': 483667}}
[[87860    82 57965]
 [93090   157 92455]
 [60138    85 91835]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1066363
{'0': {'precision': 0.3779852445210916, 'recall': 0.6074113403997695, 'f1-score': 0.46599009482934195, 'support': 154439}, '1': {'precision': 0.39473684210526316, 'recall': 0.0004466651976344611, 'f1-score': 0.0008923206881577147, 'support': 167911}, '2': {'precision': 0.39619121284498804, 'recall': 0.5778870174873076, 'f1-score': 0.47009316339523216, 'support': 161317}, 'accuracy': 0.3868488029987574, 'macro avg': {'precision': 0.38963776649044757, 'recall': 0.39524834102823725, 'f1-score': 0.3123251929709106, 'support': 483667}, 'weighted avg': {'precision': 0.3898729889693625, 'recall': 0.3868488029987574, 'f1-score': 0.3058941245812649, 'support': 483667}}
[[93808    57 60574]
 [86335    75 81501]
 [68036    58 93223]]
training model: results/AAPL/W10/deepLOB_L2/seq2seq
Epoch 1/50
5429/5429 - 262s - loss: 12.8850 - accuracy10: 0.4227 - accuracy20: 0.4116 - accuracy30: 0.4051 - accuracy50: 0.4056 - val_loss: 13.2339 - val_accuracy10: 0.3699 - val_accuracy20: 0.3580 - val_accuracy30: 0.3331 - val_accuracy50: 0.3418 - 262s/epoch - 48ms/step
Epoch 2/50
5429/5429 - 259s - loss: 12.7545 - accuracy10: 0.4418 - accuracy20: 0.4279 - accuracy30: 0.4192 - accuracy50: 0.4174 - val_loss: 13.2142 - val_accuracy10: 0.3670 - val_accuracy20: 0.3517 - val_accuracy30: 0.3324 - val_accuracy50: 0.3371 - 259s/epoch - 48ms/step
Epoch 3/50
5429/5429 - 261s - loss: 12.7069 - accuracy10: 0.4479 - accuracy20: 0.4332 - accuracy30: 0.4249 - accuracy50: 0.4228 - val_loss: 13.0753 - val_accuracy10: 0.3871 - val_accuracy20: 0.3799 - val_accuracy30: 0.3896 - val_accuracy50: 0.3746 - 261s/epoch - 48ms/step
Epoch 4/50
5429/5429 - 260s - loss: 12.6738 - accuracy10: 0.4519 - accuracy20: 0.4365 - accuracy30: 0.4284 - accuracy50: 0.4258 - val_loss: 13.1481 - val_accuracy10: 0.3554 - val_accuracy20: 0.3582 - val_accuracy30: 0.3650 - val_accuracy50: 0.3622 - 260s/epoch - 48ms/step
Epoch 5/50
5429/5429 - 257s - loss: 12.6518 - accuracy10: 0.4542 - accuracy20: 0.4386 - accuracy30: 0.4306 - accuracy50: 0.4283 - val_loss: 13.1312 - val_accuracy10: 0.3610 - val_accuracy20: 0.3628 - val_accuracy30: 0.3742 - val_accuracy50: 0.3629 - 257s/epoch - 47ms/step
Epoch 6/50
5429/5429 - 250s - loss: 12.6312 - accuracy10: 0.4565 - accuracy20: 0.4407 - accuracy30: 0.4327 - accuracy50: 0.4301 - val_loss: 13.2043 - val_accuracy10: 0.3585 - val_accuracy20: 0.3599 - val_accuracy30: 0.3691 - val_accuracy50: 0.3628 - 250s/epoch - 46ms/step
Epoch 7/50
5429/5429 - 255s - loss: 12.6160 - accuracy10: 0.4584 - accuracy20: 0.4421 - accuracy30: 0.4340 - accuracy50: 0.4317 - val_loss: 13.2317 - val_accuracy10: 0.3598 - val_accuracy20: 0.3639 - val_accuracy30: 0.3761 - val_accuracy50: 0.3687 - 255s/epoch - 47ms/step
Epoch 8/50
5429/5429 - 255s - loss: 12.6035 - accuracy10: 0.4601 - accuracy20: 0.4435 - accuracy30: 0.4354 - accuracy50: 0.4328 - val_loss: 13.3557 - val_accuracy10: 0.3486 - val_accuracy20: 0.3523 - val_accuracy30: 0.3548 - val_accuracy50: 0.3552 - 255s/epoch - 47ms/step
Epoch 9/50
5429/5429 - 250s - loss: 12.5907 - accuracy10: 0.4612 - accuracy20: 0.4449 - accuracy30: 0.4360 - accuracy50: 0.4338 - val_loss: 13.5672 - val_accuracy10: 0.3361 - val_accuracy20: 0.3391 - val_accuracy30: 0.3331 - val_accuracy50: 0.3441 - 250s/epoch - 46ms/step
Epoch 10/50
5429/5429 - 249s - loss: 12.5806 - accuracy10: 0.4622 - accuracy20: 0.4456 - accuracy30: 0.4372 - accuracy50: 0.4348 - val_loss: 13.5329 - val_accuracy10: 0.3393 - val_accuracy20: 0.3423 - val_accuracy30: 0.3387 - val_accuracy50: 0.3459 - 249s/epoch - 46ms/step
Epoch 11/50
5429/5429 - 255s - loss: 12.5712 - accuracy10: 0.4629 - accuracy20: 0.4465 - accuracy30: 0.4386 - accuracy50: 0.4357 - val_loss: 13.5207 - val_accuracy10: 0.3368 - val_accuracy20: 0.3409 - val_accuracy30: 0.3346 - val_accuracy50: 0.3442 - 255s/epoch - 47ms/step
Epoch 12/50
5429/5429 - 251s - loss: 12.5603 - accuracy10: 0.4639 - accuracy20: 0.4472 - accuracy30: 0.4392 - accuracy50: 0.4369 - val_loss: 13.4318 - val_accuracy10: 0.3399 - val_accuracy20: 0.3425 - val_accuracy30: 0.3385 - val_accuracy50: 0.3445 - 251s/epoch - 46ms/step
Epoch 13/50
5429/5429 - 249s - loss: 12.5525 - accuracy10: 0.4649 - accuracy20: 0.4482 - accuracy30: 0.4398 - accuracy50: 0.4372 - val_loss: 13.4144 - val_accuracy10: 0.3434 - val_accuracy20: 0.3448 - val_accuracy30: 0.3444 - val_accuracy50: 0.3472 - 249s/epoch - 46ms/step
testing model: results/AAPL/W10/deepLOB_L2/seq2seq
Evaluating performance on  test set...
22048/22048 - 347s - 347s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0896918
{'0': {'precision': 0.4364867423910337, 'recall': 0.4638048526007387, 'f1-score': 0.44973133225507916, 'support': 2146890}, '1': {'precision': 0.2716760381113827, 'recall': 0.1088461156544934, 'f1-score': 0.15542265369926503, 'support': 1319257}, '2': {'precision': 0.42650346334276085, 'recall': 0.5550339061885164, 'f1-score': 0.48235327682960916, 'support': 2177921}, 'accuracy': 0.41603928230489073, 'macro avg': {'precision': 0.3782220812817258, 'recall': 0.3758949581479161, 'f1-score': 0.3625024209279844, 'support': 5644068}, 'weighted avg': {'precision': 0.39411119546566836, 'recall': 0.41603928230489073, 'f1-score': 0.39352705438390495, 'support': 5644068}}
[[ 995738  171562  979590]
 [ 529815  143596  645846]
 [ 755703  213398 1208820]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1015047
{'0': {'precision': 0.4166564771905381, 'recall': 0.44494769003048545, 'f1-score': 0.43033760539974786, 'support': 2075417}, '1': {'precision': 0.2573389784292243, 'recall': 0.10927620900504131, 'f1-score': 0.1534089637081271, 'support': 1442281}, '2': {'precision': 0.40458426870506664, 'recall': 0.5356631254203172, 'f1-score': 0.4609869173251849, 'support': 2126370}, 'accuracy': 0.3933469618013107, 'macro avg': {'precision': 0.35952657477494304, 'recall': 0.3632956748186147, 'f1-score': 0.3482444954776866, 'support': 5644068}, 'weighted avg': {'precision': 0.3713964655485419, 'recall': 0.3933469618013107, 'f1-score': 0.3711184144068787, 'support': 5644068}}
[[ 923452  205870  946095]
 [ 554507  157607  730167]
 [ 738380  248972 1139018]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1017306
{'0': {'precision': 0.3987215286079047, 'recall': 0.4220200486190532, 'f1-score': 0.4100400992407388, 'support': 2039941}, '1': {'precision': 0.2698403209805906, 'recall': 0.12550974743007853, 'f1-score': 0.1713296303140909, 'support': 1510552}, '2': {'precision': 0.3994864016849188, 'recall': 0.5309114791684081, 'f1-score': 0.45591659394512407, 'support': 2093575}, 'accuracy': 0.3830549171271501, 'macro avg': {'precision': 0.35601608375780475, 'recall': 0.3594804250725132, 'f1-score': 0.34576210783331796, 'support': 5644068}, 'weighted avg': {'precision': 0.3645120813100258, 'recall': 0.3830549171271501, 'f1-score': 0.36316988189797245, 'support': 5644068}}
[[ 860896  237559  941486]
 [ 591622  189589  729341]
 [ 706623  275449 1111503]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0926182
{'0': {'precision': 0.4076066503777347, 'recall': 0.40815170088401254, 'f1-score': 0.40787899354260326, 'support': 2133567}, '1': {'precision': 0.2232894142222905, 'recall': 0.13008277505064375, 'f1-score': 0.16439384605353805, 'support': 1318030}, '2': {'precision': 0.4111928730486237, 'recall': 0.5138426004266419, 'f1-score': 0.456822297571827, 'support': 2192471}, 'accuracy': 0.38427194711332324, 'macro avg': {'precision': 0.3473629792162163, 'recall': 0.35069235878709937, 'f1-score': 0.3430317123893228, 'support': 5644068}, 'weighted avg': {'precision': 0.3659570888266525, 'recall': 0.38427194711332324, 'f1-score': 0.37003147749269805, 'support': 5644068}}
[[ 870819  281358  981390]
 [ 514755  171453  631822]
 [ 750846  315040 1126585]]
Evaluating performance on  train set...
5429/5429 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0960052
{'0': {'precision': 0.37350972974943353, 'recall': 0.6886089944394463, 'f1-score': 0.48431903808593013, 'support': 461285}, '1': {'precision': 0.3599823661542122, 'recall': 0.335298066624229, 'f1-score': 0.34720203733616495, 'support': 460283}, '2': {'precision': 0.45597512698613546, 'recall': 0.1077466533398259, 'f1-score': 0.17430511168310675, 'support': 468228}, 'accuracy': 0.37590193093087043, 'macro avg': {'precision': 0.3964890742965937, 'recall': 0.37721790480116707, 'f1-score': 0.335275395701734, 'support': 1389796}, 'weighted avg': {'precision': 0.3968125688133301, 'recall': 0.37590193093087043, 'f1-score': 0.3344626381625994, 'support': 1389796}}
[[317645 117603  26037]
 [271796 154332  34155]
 [260992 156786  50450]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1005039
{'0': {'precision': 0.3672476873001745, 'recall': 0.6100865187159603, 'f1-score': 0.4584979460910266, 'support': 459207}, '1': {'precision': 0.3490189065180822, 'recall': 0.4079827010265277, 'f1-score': 0.37620442221367706, 'support': 459218}, '2': {'precision': 0.43793264110756125, 'recall': 0.0837493184773777, 'f1-score': 0.14060888845355868, 'support': 471371}, 'accuracy': 0.36479166726627504, 'macro avg': {'precision': 0.384733078308606, 'recall': 0.3672728460732886, 'f1-score': 0.3251037522527541, 'support': 1389796}, 'weighted avg': {'precision': 0.3851984175569538, 'recall': 0.36479166726627504, 'f1-score': 0.32348939056522313, 'support': 1389796}}
[[280156 156374  22677]
 [243875 187353  27990]
 [238822 193072  39477]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1018531
{'0': {'precision': 0.36457877558743185, 'recall': 0.5388166259596017, 'f1-score': 0.43489507567141517, 'support': 457742}, '1': {'precision': 0.3487244122137883, 'recall': 0.48524324112085926, 'f1-score': 0.40580989769559694, 'support': 458434}, '2': {'precision': 0.4349781138081974, 'recall': 0.06923905240488155, 'f1-score': 0.11946230487604961, 'support': 473620}, 'accuracy': 0.361120624897467, 'macro avg': {'precision': 0.38276043386980585, 'recall': 0.36443297316178086, 'f1-score': 0.3200557594143539, 'support': 1389796}, 'weighted avg': {'precision': 0.38334005807010274, 'recall': 0.361120624897467, 'f1-score': 0.31780673796986236, 'support': 1389796}}
[[246639 191125  19978]
 [213363 222452  22619]
 [216502 224325  32793]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1030803
{'0': {'precision': 0.3601607043891112, 'recall': 0.4786543719579229, 'f1-score': 0.4110381432676372, 'support': 457541}, '1': {'precision': 0.3479422551522391, 'recall': 0.5405614731272625, 'f1-score': 0.423372850381894, 'support': 459648}, '2': {'precision': 0.41510884997633696, 'recall': 0.05938972550131505, 'f1-score': 0.10391264348241375, 'support': 472607}, 'accuracy': 0.35655592619348453, 'macro avg': {'precision': 0.37440393650589576, 'recall': 0.3595351901955001, 'f1-score': 0.31277454571064833, 'support': 1389796}, 'weighted avg': {'precision': 0.37480507844596, 'recall': 0.35655592619348453, 'f1-score': 0.3106780633556636, 'support': 1389796}}
[[219004 219900  18637]
 [190269 248468  20911]
 [198800 245739  28068]]
Evaluating performance on  val set...
1890/1890 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.086538
{'0': {'precision': 0.3736199021989958, 'recall': 0.5594975242027149, 'f1-score': 0.44804523923488776, 'support': 153082}, '1': {'precision': 0.3879190552796856, 'recall': 0.44614891106350313, 'f1-score': 0.4150013454001966, 'support': 174574}, '2': {'precision': 0.4425969765317725, 'recall': 0.1521943965489613, 'f1-score': 0.2265022083583741, 'support': 156011}, 'accuracy': 0.38720648710786554, 'macro avg': {'precision': 0.40137864467015133, 'recall': 0.3859469439383931, 'f1-score': 0.36318293099781945, 'support': 483667}, 'weighted avg': {'precision': 0.40103017144134473, 'recall': 0.38720648710786554, 'f1-score': 0.3646577959890737, 'support': 483667}}
[[85649 53641 13792]
 [80577 77886 16111]
 [63015 69252 23744]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0908576
{'0': {'precision': 0.36985359784059324, 'recall': 0.48120030810606157, 'f1-score': 0.41824299023000894, 'support': 153194}, '1': {'precision': 0.3789759962161523, 'recall': 0.5209718150416534, 'f1-score': 0.43877169350521084, 'support': 172255}, '2': {'precision': 0.4369913997939315, 'recall': 0.13135041524984514, 'f1-score': 0.20198760782407968, 'support': 158218}, 'accuracy': 0.38092117097093664, 'macro avg': {'precision': 0.39527366461689234, 'recall': 0.37784084613252, 'f1-score': 0.3530007638530998, 'support': 483667}, 'weighted avg': {'precision': 0.3950647192973707, 'recall': 0.38092117097093664, 'f1-score': 0.35481231931214313, 'support': 483667}}
[[73717 66251 13226]
 [68966 89740 13549]
 [56631 80805 20782]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.088122
{'0': {'precision': 0.35175896582385263, 'recall': 0.4229912473697558, 'f1-score': 0.3841004783051133, 'support': 145899}, '1': {'precision': 0.40937211710439614, 'recall': 0.5855717078793298, 'f1-score': 0.48186987798013464, 'support': 185663}, '2': {'precision': 0.432142187206903, 'recall': 0.12116629959567404, 'f1-score': 0.18926537717005643, 'support': 152105}, 'accuracy': 0.39048146762131797, 'macro avg': {'precision': 0.3977577567117172, 'recall': 0.37657641828158656, 'f1-score': 0.3517452444851014, 'support': 483667}, 'weighted avg': {'precision': 0.39915380647799775, 'recall': 0.39048146762131797, 'f1-score': 0.3603584553713917, 'support': 483667}}
[[ 61714  72108  12077]
 [ 64803 108719  12141]
 [ 48927  84748  18430]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953693
{'0': {'precision': 0.3651120427209662, 'recall': 0.37890716042988476, 'f1-score': 0.3718817115479927, 'support': 154460}, '1': {'precision': 0.3725591679517784, 'recall': 0.631113417310812, 'f1-score': 0.46853345022869863, 'support': 167664}, '2': {'precision': 0.4377239574067956, 'recall': 0.10662176634085042, 'f1-score': 0.17147522051649644, 'support': 161543}, 'accuracy': 0.3753925738162827, 'macro avg': {'precision': 0.3917983893598467, 'recall': 0.3722141146938491, 'f1-score': 0.3372967940977292, 'support': 483667}, 'weighted avg': {'precision': 0.3919457141080814, 'recall': 0.3753925738162827, 'f1-score': 0.33845117221713256, 'support': 483667}}
[[ 58526  83899  12035]
 [ 51759 105815  10090]
 [ 50011  94308  17224]]
training model: results/AAPL/W10/deepOF_L2/seq2seq
Epoch 1/50
5429/5429 - 164s - loss: 12.7815 - accuracy10: 0.4382 - accuracy20: 0.4239 - accuracy30: 0.4161 - accuracy50: 0.4154 - val_loss: 13.2222 - val_accuracy10: 0.4095 - val_accuracy20: 0.4027 - val_accuracy30: 0.3813 - val_accuracy50: 0.3916 - 164s/epoch - 30ms/step
Epoch 2/50
5429/5429 - 157s - loss: 12.6508 - accuracy10: 0.4572 - accuracy20: 0.4379 - accuracy30: 0.4280 - accuracy50: 0.4253 - val_loss: 13.1531 - val_accuracy10: 0.4200 - val_accuracy20: 0.4073 - val_accuracy30: 0.3854 - val_accuracy50: 0.3956 - 157s/epoch - 29ms/step
Epoch 3/50
5429/5429 - 155s - loss: 12.6051 - accuracy10: 0.4631 - accuracy20: 0.4424 - accuracy30: 0.4321 - accuracy50: 0.4291 - val_loss: 13.0774 - val_accuracy10: 0.4298 - val_accuracy20: 0.4110 - val_accuracy30: 0.3878 - val_accuracy50: 0.3976 - 155s/epoch - 28ms/step
Epoch 4/50
5429/5429 - 156s - loss: 12.5751 - accuracy10: 0.4667 - accuracy20: 0.4454 - accuracy30: 0.4347 - accuracy50: 0.4316 - val_loss: 13.0327 - val_accuracy10: 0.4337 - val_accuracy20: 0.4121 - val_accuracy30: 0.3869 - val_accuracy50: 0.3960 - 156s/epoch - 29ms/step
Epoch 5/50
5429/5429 - 160s - loss: 12.5516 - accuracy10: 0.4689 - accuracy20: 0.4474 - accuracy30: 0.4370 - accuracy50: 0.4332 - val_loss: 12.9954 - val_accuracy10: 0.4367 - val_accuracy20: 0.4132 - val_accuracy30: 0.3878 - val_accuracy50: 0.3961 - 160s/epoch - 30ms/step
Epoch 6/50
5429/5429 - 154s - loss: 12.5324 - accuracy10: 0.4708 - accuracy20: 0.4495 - accuracy30: 0.4388 - accuracy50: 0.4359 - val_loss: 12.9541 - val_accuracy10: 0.4415 - val_accuracy20: 0.4169 - val_accuracy30: 0.3895 - val_accuracy50: 0.3971 - 154s/epoch - 28ms/step
Epoch 7/50
5429/5429 - 156s - loss: 12.5153 - accuracy10: 0.4728 - accuracy20: 0.4514 - accuracy30: 0.4406 - accuracy50: 0.4374 - val_loss: 12.9389 - val_accuracy10: 0.4429 - val_accuracy20: 0.4163 - val_accuracy30: 0.3889 - val_accuracy50: 0.3960 - 156s/epoch - 29ms/step
Epoch 8/50
5429/5429 - 159s - loss: 12.5004 - accuracy10: 0.4737 - accuracy20: 0.4525 - accuracy30: 0.4421 - accuracy50: 0.4382 - val_loss: 12.9143 - val_accuracy10: 0.4425 - val_accuracy20: 0.4161 - val_accuracy30: 0.3896 - val_accuracy50: 0.3959 - 159s/epoch - 29ms/step
Epoch 9/50
5429/5429 - 156s - loss: 12.4878 - accuracy10: 0.4746 - accuracy20: 0.4535 - accuracy30: 0.4427 - accuracy50: 0.4398 - val_loss: 12.9175 - val_accuracy10: 0.4407 - val_accuracy20: 0.4150 - val_accuracy30: 0.3889 - val_accuracy50: 0.3956 - 156s/epoch - 29ms/step
Epoch 10/50
5429/5429 - 151s - loss: 12.4749 - accuracy10: 0.4760 - accuracy20: 0.4549 - accuracy30: 0.4445 - accuracy50: 0.4412 - val_loss: 12.8837 - val_accuracy10: 0.4451 - val_accuracy20: 0.4194 - val_accuracy30: 0.3933 - val_accuracy50: 0.3996 - 151s/epoch - 28ms/step
Epoch 11/50
5429/5429 - 156s - loss: 12.4639 - accuracy10: 0.4770 - accuracy20: 0.4559 - accuracy30: 0.4457 - accuracy50: 0.4420 - val_loss: 12.8892 - val_accuracy10: 0.4416 - val_accuracy20: 0.4179 - val_accuracy30: 0.3926 - val_accuracy50: 0.3987 - 156s/epoch - 29ms/step
Epoch 12/50
5429/5429 - 150s - loss: 12.4536 - accuracy10: 0.4776 - accuracy20: 0.4567 - accuracy30: 0.4470 - accuracy50: 0.4431 - val_loss: 12.8985 - val_accuracy10: 0.4428 - val_accuracy20: 0.4165 - val_accuracy30: 0.3905 - val_accuracy50: 0.3969 - 150s/epoch - 28ms/step
Epoch 13/50
5429/5429 - 151s - loss: 12.4425 - accuracy10: 0.4785 - accuracy20: 0.4580 - accuracy30: 0.4478 - accuracy50: 0.4439 - val_loss: 12.8931 - val_accuracy10: 0.4424 - val_accuracy20: 0.4165 - val_accuracy30: 0.3918 - val_accuracy50: 0.3983 - 151s/epoch - 28ms/step
Epoch 14/50
5429/5429 - 150s - loss: 12.4355 - accuracy10: 0.4793 - accuracy20: 0.4586 - accuracy30: 0.4483 - accuracy50: 0.4451 - val_loss: 12.8939 - val_accuracy10: 0.4434 - val_accuracy20: 0.4173 - val_accuracy30: 0.3915 - val_accuracy50: 0.3982 - 150s/epoch - 28ms/step
Epoch 15/50
5429/5429 - 153s - loss: 12.4264 - accuracy10: 0.4798 - accuracy20: 0.4594 - accuracy30: 0.4495 - accuracy50: 0.4457 - val_loss: 12.9032 - val_accuracy10: 0.4409 - val_accuracy20: 0.4150 - val_accuracy30: 0.3902 - val_accuracy50: 0.3955 - 153s/epoch - 28ms/step
Epoch 16/50
5429/5429 - 154s - loss: 12.4181 - accuracy10: 0.4799 - accuracy20: 0.4599 - accuracy30: 0.4498 - accuracy50: 0.4466 - val_loss: 12.9062 - val_accuracy10: 0.4417 - val_accuracy20: 0.4158 - val_accuracy30: 0.3908 - val_accuracy50: 0.3962 - 154s/epoch - 28ms/step
Epoch 17/50
5429/5429 - 155s - loss: 12.4095 - accuracy10: 0.4811 - accuracy20: 0.4609 - accuracy30: 0.4511 - accuracy50: 0.4476 - val_loss: 12.8999 - val_accuracy10: 0.4412 - val_accuracy20: 0.4150 - val_accuracy30: 0.3907 - val_accuracy50: 0.3970 - 155s/epoch - 29ms/step
Epoch 18/50
5429/5429 - 151s - loss: 12.4017 - accuracy10: 0.4814 - accuracy20: 0.4615 - accuracy30: 0.4517 - accuracy50: 0.4485 - val_loss: 12.9126 - val_accuracy10: 0.4410 - val_accuracy20: 0.4150 - val_accuracy30: 0.3900 - val_accuracy50: 0.3961 - 151s/epoch - 28ms/step
Epoch 19/50
5429/5429 - 152s - loss: 12.3933 - accuracy10: 0.4821 - accuracy20: 0.4620 - accuracy30: 0.4527 - accuracy50: 0.4495 - val_loss: 12.9087 - val_accuracy10: 0.4414 - val_accuracy20: 0.4149 - val_accuracy30: 0.3899 - val_accuracy50: 0.3955 - 152s/epoch - 28ms/step
Epoch 20/50
5429/5429 - 153s - loss: 12.3877 - accuracy10: 0.4824 - accuracy20: 0.4629 - accuracy30: 0.4535 - accuracy50: 0.4500 - val_loss: 12.8858 - val_accuracy10: 0.4442 - val_accuracy20: 0.4182 - val_accuracy30: 0.3932 - val_accuracy50: 0.3993 - 153s/epoch - 28ms/step
testing model: results/AAPL/W10/deepOF_L2/seq2seq
Evaluating performance on  test set...
22048/22048 - 261s - 261s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0258349
{'0': {'precision': 0.4867480631968557, 'recall': 0.5690587636342633, 'f1-score': 0.5246949423040251, 'support': 2146889}, '1': {'precision': 0.4314864101943705, 'recall': 0.0446085101060826, 'f1-score': 0.08085768223549164, 'support': 1319255}, '2': {'precision': 0.47630264008974765, 'recall': 0.6555941703984399, 'f1-score': 0.5517485892615007, 'support': 2177919}, 'accuracy': 0.4798647711763671, 'macro avg': {'precision': 0.464845704493658, 'recall': 0.42308714804626196, 'f1-score': 0.3857670712670058, 'support': 5644063}, 'weighted avg': {'precision': 0.46980043212331823, 'recall': 0.4798647711763671, 'f1-score': 0.43139090356389503, 'support': 5644063}}
[[1221706   38142  887041]
 [ 577538   58850  682867]
 [ 710691   39397 1427831]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0514718
{'0': {'precision': 0.45719423781111745, 'recall': 0.5715746352294049, 'f1-score': 0.5080259260440941, 'support': 2075414}, '1': {'precision': 0.40423831919954967, 'recall': 0.015434589677455141, 'f1-score': 0.0297338830159168, 'support': 1442280}, '2': {'precision': 0.4542400617161292, 'recall': 0.6396613193664882, 'f1-score': 0.5312358174351909, 'support': 2126369}, 'accuracy': 0.4551102636522661, 'macro avg': {'precision': 0.43855753957559873, 'recall': 0.4088901814244494, 'f1-score': 0.3563318754984006, 'support': 5644063}, 'weighted avg': {'precision': 0.4425489493435692, 'recall': 0.4551102636522661, 'f1-score': 0.39454770046948867, 'support': 5644063}}
[[1186254   16053  873107]
 [ 658927   22261  761092]
 [ 749458   16755 1360156]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0632193
{'0': {'precision': 0.4389328225907383, 'recall': 0.5725019228516147, 'f1-score': 0.49689786922631807, 'support': 2039939}, '1': {'precision': 0.437350970818667, 'recall': 0.010199589421343603, 'f1-score': 0.019934285560872546, 'support': 1510551}, '2': {'precision': 0.4428482558798209, 'recall': 0.6236114049999689, 'f1-score': 0.5179103029985678, 'support': 2093573}, 'accuracy': 0.4409681465284849, 'macro avg': {'precision': 0.43971068309640876, 'recall': 0.4021043057576424, 'f1-score': 0.34491415259525277, 'support': 5644063}, 'weighted avg': {'precision': 0.43996182911337467, 'recall': 0.4409681465284849, 'f1-score': 0.37703975384745847, 'support': 5644063}}
[[1167869   10157  861913]
 [ 714499   15407  780645]
 [ 778333    9664 1305576]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0534534
{'0': {'precision': 0.4455232355192804, 'recall': 0.5575318504325621, 'f1-score': 0.4952736841447852, 'support': 2133566}, '1': {'precision': 0.35588191218342574, 'recall': 0.009008906480813397, 'f1-score': 0.017572965397212065, 'support': 1318029}, '2': {'precision': 0.4509081746257907, 'recall': 0.6047983368514387, 'f1-score': 0.5166369840890735, 'support': 2192468}, 'accuracy': 0.4477990412226086, 'macro avg': {'precision': 0.41743777410949895, 'recall': 0.3904463645882714, 'f1-score': 0.34316121121035686, 'support': 5644063}, 'weighted avg': {'precision': 0.4266815682519128, 'recall': 0.4477990412226086, 'f1-score': 0.3920173864868939, 'support': 5644063}}
[[1189531   11261  932774]
 [ 624196   11874  681959]
 [ 856237   10230 1326001]]
Evaluating performance on  train set...
5429/5429 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.036781
{'0': {'precision': 0.44243215470410074, 'recall': 0.6380207938402743, 'f1-score': 0.522523289783368, 'support': 461579}, '1': {'precision': 0.5039285867069745, 'recall': 0.15361042528775604, 'f1-score': 0.23544970901083676, 'support': 460112}, '2': {'precision': 0.46484640586118725, 'recall': 0.5798455044178217, 'f1-score': 0.5160164370592379, 'support': 468104}, 'accuracy': 0.4580553247061617, 'macro avg': {'precision': 0.4704023824240875, 'recall': 0.45715890784861735, 'f1-score': 0.4246631452844809, 'support': 1389795}, 'weighted avg': {'precision': 0.47034090883355373, 'recall': 0.4580553247061617, 'f1-score': 0.42529176773588107, 'support': 1389795}}
[[294497  31657 135425]
 [212378  70678 177056]
 [158757  37919 271428]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0585794
{'0': {'precision': 0.4148402516414384, 'recall': 0.6570963586994361, 'f1-score': 0.5085935421290697, 'support': 459616}, '1': {'precision': 0.47640355170244003, 'recall': 0.07432811269424683, 'f1-score': 0.1285932121504922, 'support': 458373}, '2': {'precision': 0.44964253041032765, 'recall': 0.5625320576677703, 'f1-score': 0.4997919150033991, 'support': 471806}, 'accuracy': 0.43278900845088664, 'macro avg': {'precision': 0.446962111251402, 'recall': 0.43131884302048434, 'f1-score': 0.37899288976098705, 'support': 1389795}, 'weighted avg': {'precision': 0.44695928968352094, 'recall': 0.43278900845088664, 'f1-score': 0.380276378992834, 'support': 1389795}}
[[302012  17051 140553]
 [240002  34070 184301]
 [186006  20394 265406]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0708723
{'0': {'precision': 0.40108560915460795, 'recall': 0.6713800522010724, 'f1-score': 0.5021715601988179, 'support': 457845}, '1': {'precision': 0.46456592730819796, 'recall': 0.04781766948884334, 'f1-score': 0.08671026983168915, 'support': 458157}, '2': {'precision': 0.4429437376680486, 'recall': 0.5387268279607339, 'f1-score': 0.4861624319073559, 'support': 473793}, 'accuracy': 0.42059512374127117, 'macro avg': {'precision': 0.4361984247102848, 'recall': 0.41930818321688323, 'f1-score': 0.358348087312621, 'support': 1389795}, 'weighted avg': {'precision': 0.43628219599443896, 'recall': 0.42059512374127117, 'f1-score': 0.35975378539654185, 'support': 1389795}}
[[307388  11796 138661]
 [253908  21908 182341]
 [205094  13454 255245]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.077529
{'0': {'precision': 0.38992808333578644, 'recall': 0.6656332341412897, 'f1-score': 0.4917745409876685, 'support': 457698}, '1': {'precision': 0.4839193825042882, 'recall': 0.04424111877998793, 'f1-score': 0.08107056407759436, 'support': 459143}, '2': {'precision': 0.43417452488799607, 'recall': 0.5200484613725648, 'f1-score': 0.47324744192132007, 'support': 472954}, 'accuracy': 0.41080231257127847, 'macro avg': {'precision': 0.43600733024269017, 'recall': 0.4099742714312808, 'f1-score': 0.3486975156621943, 'support': 1389795}, 'weighted avg': {'precision': 0.43603702644754544, 'recall': 0.41080231257127847, 'f1-score': 0.34978646239892125, 'support': 1389795}}
[[304659  10539 142500]
 [260791  20313 178039]
 [215871  11124 245959]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0457813
{'0': {'precision': 0.4276255830161368, 'recall': 0.6255587797035527, 'f1-score': 0.5079926124060629, 'support': 153012}, '1': {'precision': 0.530083451670006, 'recall': 0.1556884859080495, 'f1-score': 0.2406861099825116, 'support': 175029}, '2': {'precision': 0.4427657083637201, 'recall': 0.5929793222212226, 'f1-score': 0.5069798104655954, 'support': 155626}, 'accuracy': 0.44503966572042336, 'macro avg': {'precision': 0.4668249143499543, 'recall': 0.45807552927760825, 'f1-score': 0.4185528442847233, 'support': 483667}, 'weighted avg': {'precision': 0.46957447644893474, 'recall': 0.44503966572042336, 'f1-score': 0.4109340822035083, 'support': 483667}}
[[95718 11185 46109]
 [77747 27250 70032]
 [50371 12972 92283]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689149
{'0': {'precision': 0.4008287669584333, 'recall': 0.6521322003367662, 'f1-score': 0.49649199519015763, 'support': 153222}, '1': {'precision': 0.48737613424959186, 'recall': 0.07443335671999211, 'f1-score': 0.12914356998420537, 'support': 172463}, '2': {'precision': 0.43195124061487583, 'recall': 0.5688242964388348, 'f1-score': 0.4910279107380937, 'support': 157982}, 'accuracy': 0.41892872575553014, 'macro avg': {'precision': 0.4400520472743003, 'recall': 0.43179661783186435, 'f1-score': 0.37222115863748556, 'support': 483667}, 'weighted avg': {'precision': 0.4418549466199095, 'recall': 0.41892872575553014, 'f1-score': 0.3637204014155149, 'support': 483667}}
[[99921  6128 47173]
 [88621 12837 71005]
 [60744  7374 89864]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892097
{'0': {'precision': 0.37105289934540026, 'recall': 0.674813408541057, 'f1-score': 0.4788211836794242, 'support': 145907}, '1': {'precision': 0.5153166590178981, 'recall': 0.04837320007323562, 'f1-score': 0.08844408124686168, 'support': 185702}, '2': {'precision': 0.41152517398273614, 'recall': 0.5436609714714122, 'f1-score': 0.46845356151187173, 'support': 152058}, 'accuracy': 0.3930617552985835, 'macro avg': {'precision': 0.4326315774486782, 'recall': 0.42228252669523497, 'f1-score': 0.3452396088127192, 'support': 483667}, 'weighted avg': {'precision': 0.43916629520558137, 'recall': 0.3930617552985835, 'f1-score': 0.3256780323635697, 'support': 483667}}
[[ 98460   3870  43577]
 [102082   8983  74637]
 [ 64811   4579  82668]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0862857
{'0': {'precision': 0.37826181195651776, 'recall': 0.6666968835592046, 'f1-score': 0.4826716544550232, 'support': 154439}, '1': {'precision': 0.4647608083908928, 'recall': 0.04327887988279505, 'f1-score': 0.07918407819250654, 'support': 167911}, '2': {'precision': 0.4226055518107727, 'recall': 0.5130147473607866, 'f1-score': 0.4634420193478839, 'support': 161317}, 'accuracy': 0.3990121302466366, 'macro avg': {'precision': 0.4218760573860611, 'recall': 0.4076635036009287, 'f1-score': 0.34176591733180456, 'support': 483667}, 'weighted avg': {'precision': 0.4230809376615198, 'recall': 0.3990121302466366, 'f1-score': 0.33618229408023265, 'support': 483667}}
[[102964   3985  47490]
 [ 95064   7267  65580]
 [ 74175   4384  82758]]
training model: results/AAPL/W10/deepVOL_L2/seq2seq
Epoch 1/50
5429/5429 - 150s - loss: 12.8879 - accuracy10: 0.4192 - accuracy20: 0.4115 - accuracy30: 0.4069 - accuracy50: 0.4091 - val_loss: 13.3269 - val_accuracy10: 0.3987 - val_accuracy20: 0.3939 - val_accuracy30: 0.3741 - val_accuracy50: 0.3854 - 150s/epoch - 28ms/step
Epoch 2/50
5429/5429 - 145s - loss: 12.7445 - accuracy10: 0.4431 - accuracy20: 0.4287 - accuracy30: 0.4204 - accuracy50: 0.4181 - val_loss: 13.1586 - val_accuracy10: 0.4090 - val_accuracy20: 0.4017 - val_accuracy30: 0.3803 - val_accuracy50: 0.3906 - 145s/epoch - 27ms/step
Epoch 3/50
5429/5429 - 142s - loss: 12.7024 - accuracy10: 0.4501 - accuracy20: 0.4335 - accuracy30: 0.4241 - accuracy50: 0.4211 - val_loss: 13.1424 - val_accuracy10: 0.4111 - val_accuracy20: 0.4021 - val_accuracy30: 0.3809 - val_accuracy50: 0.3918 - 142s/epoch - 26ms/step
Epoch 4/50
5429/5429 - 142s - loss: 12.6757 - accuracy10: 0.4536 - accuracy20: 0.4362 - accuracy30: 0.4265 - accuracy50: 0.4236 - val_loss: 13.1322 - val_accuracy10: 0.4152 - val_accuracy20: 0.4033 - val_accuracy30: 0.3816 - val_accuracy50: 0.3924 - 142s/epoch - 26ms/step
Epoch 5/50
5429/5429 - 141s - loss: 12.6513 - accuracy10: 0.4563 - accuracy20: 0.4383 - accuracy30: 0.4286 - accuracy50: 0.4258 - val_loss: 13.0880 - val_accuracy10: 0.4212 - val_accuracy20: 0.4062 - val_accuracy30: 0.3837 - val_accuracy50: 0.3941 - 141s/epoch - 26ms/step
Epoch 6/50
5429/5429 - 148s - loss: 12.6299 - accuracy10: 0.4586 - accuracy20: 0.4405 - accuracy30: 0.4310 - accuracy50: 0.4281 - val_loss: 13.1532 - val_accuracy10: 0.4190 - val_accuracy20: 0.4049 - val_accuracy30: 0.3830 - val_accuracy50: 0.3932 - 148s/epoch - 27ms/step
Epoch 7/50
5429/5429 - 152s - loss: 12.6085 - accuracy10: 0.4606 - accuracy20: 0.4426 - accuracy30: 0.4333 - accuracy50: 0.4307 - val_loss: 13.2117 - val_accuracy10: 0.4195 - val_accuracy20: 0.4053 - val_accuracy30: 0.3834 - val_accuracy50: 0.3943 - 152s/epoch - 28ms/step
Epoch 8/50
5429/5429 - 152s - loss: 12.5884 - accuracy10: 0.4624 - accuracy20: 0.4446 - accuracy30: 0.4355 - accuracy50: 0.4326 - val_loss: 13.1562 - val_accuracy10: 0.4265 - val_accuracy20: 0.4081 - val_accuracy30: 0.3854 - val_accuracy50: 0.3958 - 152s/epoch - 28ms/step
Epoch 9/50
5429/5429 - 151s - loss: 12.5722 - accuracy10: 0.4644 - accuracy20: 0.4463 - accuracy30: 0.4373 - accuracy50: 0.4344 - val_loss: 13.1546 - val_accuracy10: 0.4265 - val_accuracy20: 0.4087 - val_accuracy30: 0.3867 - val_accuracy50: 0.3979 - 151s/epoch - 28ms/step
Epoch 10/50
5429/5429 - 152s - loss: 12.5564 - accuracy10: 0.4654 - accuracy20: 0.4477 - accuracy30: 0.4382 - accuracy50: 0.4356 - val_loss: 13.1160 - val_accuracy10: 0.4333 - val_accuracy20: 0.4110 - val_accuracy30: 0.3879 - val_accuracy50: 0.3982 - 152s/epoch - 28ms/step
Epoch 11/50
5429/5429 - 152s - loss: 12.5434 - accuracy10: 0.4667 - accuracy20: 0.4484 - accuracy30: 0.4398 - accuracy50: 0.4370 - val_loss: 13.1045 - val_accuracy10: 0.4325 - val_accuracy20: 0.4114 - val_accuracy30: 0.3885 - val_accuracy50: 0.3981 - 152s/epoch - 28ms/step
Epoch 12/50
5429/5429 - 153s - loss: 12.5304 - accuracy10: 0.4680 - accuracy20: 0.4499 - accuracy30: 0.4410 - accuracy50: 0.4382 - val_loss: 13.0848 - val_accuracy10: 0.4320 - val_accuracy20: 0.4117 - val_accuracy30: 0.3887 - val_accuracy50: 0.3992 - 153s/epoch - 28ms/step
Epoch 13/50
5429/5429 - 149s - loss: 12.5187 - accuracy10: 0.4692 - accuracy20: 0.4509 - accuracy30: 0.4424 - accuracy50: 0.4393 - val_loss: 13.0196 - val_accuracy10: 0.4374 - val_accuracy20: 0.4137 - val_accuracy30: 0.3897 - val_accuracy50: 0.4000 - 149s/epoch - 27ms/step
Epoch 14/50
5429/5429 - 149s - loss: 12.5090 - accuracy10: 0.4701 - accuracy20: 0.4520 - accuracy30: 0.4429 - accuracy50: 0.4404 - val_loss: 13.0102 - val_accuracy10: 0.4377 - val_accuracy20: 0.4145 - val_accuracy30: 0.3895 - val_accuracy50: 0.3991 - 149s/epoch - 27ms/step
Epoch 15/50
5429/5429 - 151s - loss: 12.4985 - accuracy10: 0.4708 - accuracy20: 0.4529 - accuracy30: 0.4435 - accuracy50: 0.4409 - val_loss: 12.9814 - val_accuracy10: 0.4393 - val_accuracy20: 0.4158 - val_accuracy30: 0.3909 - val_accuracy50: 0.4004 - 151s/epoch - 28ms/step
Epoch 16/50
5429/5429 - 147s - loss: 12.4895 - accuracy10: 0.4715 - accuracy20: 0.4536 - accuracy30: 0.4448 - accuracy50: 0.4421 - val_loss: 12.9725 - val_accuracy10: 0.4398 - val_accuracy20: 0.4156 - val_accuracy30: 0.3901 - val_accuracy50: 0.3990 - 147s/epoch - 27ms/step
Epoch 17/50
5429/5429 - 149s - loss: 12.4812 - accuracy10: 0.4720 - accuracy20: 0.4543 - accuracy30: 0.4455 - accuracy50: 0.4430 - val_loss: 12.9624 - val_accuracy10: 0.4404 - val_accuracy20: 0.4167 - val_accuracy30: 0.3912 - val_accuracy50: 0.4002 - 149s/epoch - 27ms/step
Epoch 18/50
5429/5429 - 148s - loss: 12.4730 - accuracy10: 0.4731 - accuracy20: 0.4552 - accuracy30: 0.4460 - accuracy50: 0.4438 - val_loss: 12.9388 - val_accuracy10: 0.4412 - val_accuracy20: 0.4179 - val_accuracy30: 0.3924 - val_accuracy50: 0.4011 - 148s/epoch - 27ms/step
Epoch 19/50
5429/5429 - 147s - loss: 12.4642 - accuracy10: 0.4736 - accuracy20: 0.4559 - accuracy30: 0.4473 - accuracy50: 0.4451 - val_loss: 12.9135 - val_accuracy10: 0.4427 - val_accuracy20: 0.4204 - val_accuracy30: 0.3944 - val_accuracy50: 0.4019 - 147s/epoch - 27ms/step
Epoch 20/50
5429/5429 - 147s - loss: 12.4573 - accuracy10: 0.4741 - accuracy20: 0.4565 - accuracy30: 0.4482 - accuracy50: 0.4457 - val_loss: 12.8955 - val_accuracy10: 0.4437 - val_accuracy20: 0.4202 - val_accuracy30: 0.3938 - val_accuracy50: 0.4010 - 147s/epoch - 27ms/step
Epoch 21/50
5429/5429 - 148s - loss: 12.4498 - accuracy10: 0.4751 - accuracy20: 0.4571 - accuracy30: 0.4482 - accuracy50: 0.4459 - val_loss: 12.8810 - val_accuracy10: 0.4449 - val_accuracy20: 0.4210 - val_accuracy30: 0.3955 - val_accuracy50: 0.4017 - 148s/epoch - 27ms/step
Epoch 22/50
5429/5429 - 151s - loss: 12.4423 - accuracy10: 0.4753 - accuracy20: 0.4577 - accuracy30: 0.4491 - accuracy50: 0.4469 - val_loss: 12.8707 - val_accuracy10: 0.4441 - val_accuracy20: 0.4216 - val_accuracy30: 0.3964 - val_accuracy50: 0.4020 - 151s/epoch - 28ms/step
Epoch 23/50
5429/5429 - 147s - loss: 12.4350 - accuracy10: 0.4761 - accuracy20: 0.4584 - accuracy30: 0.4498 - accuracy50: 0.4477 - val_loss: 12.8762 - val_accuracy10: 0.4451 - val_accuracy20: 0.4216 - val_accuracy30: 0.3954 - val_accuracy50: 0.4019 - 147s/epoch - 27ms/step
Epoch 24/50
5429/5429 - 146s - loss: 12.4280 - accuracy10: 0.4765 - accuracy20: 0.4588 - accuracy30: 0.4504 - accuracy50: 0.4484 - val_loss: 12.8561 - val_accuracy10: 0.4450 - val_accuracy20: 0.4224 - val_accuracy30: 0.3970 - val_accuracy50: 0.4033 - 146s/epoch - 27ms/step
Epoch 25/50
5429/5429 - 147s - loss: 12.4216 - accuracy10: 0.4771 - accuracy20: 0.4595 - accuracy30: 0.4513 - accuracy50: 0.4488 - val_loss: 12.8769 - val_accuracy10: 0.4434 - val_accuracy20: 0.4204 - val_accuracy30: 0.3952 - val_accuracy50: 0.4015 - 147s/epoch - 27ms/step
Epoch 26/50
5429/5429 - 150s - loss: 12.4149 - accuracy10: 0.4775 - accuracy20: 0.4601 - accuracy30: 0.4519 - accuracy50: 0.4498 - val_loss: 12.8879 - val_accuracy10: 0.4427 - val_accuracy20: 0.4199 - val_accuracy30: 0.3953 - val_accuracy50: 0.4017 - 150s/epoch - 28ms/step
Epoch 27/50
5429/5429 - 150s - loss: 12.4099 - accuracy10: 0.4775 - accuracy20: 0.4601 - accuracy30: 0.4522 - accuracy50: 0.4503 - val_loss: 12.8750 - val_accuracy10: 0.4430 - val_accuracy20: 0.4211 - val_accuracy30: 0.3961 - val_accuracy50: 0.4022 - 150s/epoch - 28ms/step
Epoch 28/50
5429/5429 - 147s - loss: 12.4022 - accuracy10: 0.4783 - accuracy20: 0.4610 - accuracy30: 0.4531 - accuracy50: 0.4511 - val_loss: 12.8791 - val_accuracy10: 0.4429 - val_accuracy20: 0.4207 - val_accuracy30: 0.3955 - val_accuracy50: 0.4022 - 147s/epoch - 27ms/step
Epoch 29/50
5429/5429 - 149s - loss: 12.3968 - accuracy10: 0.4786 - accuracy20: 0.4612 - accuracy30: 0.4535 - accuracy50: 0.4524 - val_loss: 12.8706 - val_accuracy10: 0.4453 - val_accuracy20: 0.4221 - val_accuracy30: 0.3965 - val_accuracy50: 0.4020 - 149s/epoch - 27ms/step
Epoch 30/50
5429/5429 - 148s - loss: 12.3904 - accuracy10: 0.4791 - accuracy20: 0.4623 - accuracy30: 0.4545 - accuracy50: 0.4525 - val_loss: 12.8888 - val_accuracy10: 0.4435 - val_accuracy20: 0.4196 - val_accuracy30: 0.3941 - val_accuracy50: 0.4004 - 148s/epoch - 27ms/step
Epoch 31/50
5429/5429 - 149s - loss: 12.3835 - accuracy10: 0.4790 - accuracy20: 0.4628 - accuracy30: 0.4548 - accuracy50: 0.4531 - val_loss: 12.8900 - val_accuracy10: 0.4428 - val_accuracy20: 0.4196 - val_accuracy30: 0.3945 - val_accuracy50: 0.4000 - 149s/epoch - 27ms/step
Epoch 32/50
5429/5429 - 151s - loss: 12.3785 - accuracy10: 0.4796 - accuracy20: 0.4635 - accuracy30: 0.4559 - accuracy50: 0.4541 - val_loss: 12.8977 - val_accuracy10: 0.4419 - val_accuracy20: 0.4186 - val_accuracy30: 0.3935 - val_accuracy50: 0.3994 - 151s/epoch - 28ms/step
Epoch 33/50
5429/5429 - 147s - loss: 12.3708 - accuracy10: 0.4799 - accuracy20: 0.4640 - accuracy30: 0.4566 - accuracy50: 0.4550 - val_loss: 12.9102 - val_accuracy10: 0.4400 - val_accuracy20: 0.4177 - val_accuracy30: 0.3925 - val_accuracy50: 0.3992 - 147s/epoch - 27ms/step
Epoch 34/50
5429/5429 - 146s - loss: 12.3653 - accuracy10: 0.4800 - accuracy20: 0.4645 - accuracy30: 0.4573 - accuracy50: 0.4553 - val_loss: 12.8848 - val_accuracy10: 0.4425 - val_accuracy20: 0.4190 - val_accuracy30: 0.3941 - val_accuracy50: 0.4000 - 146s/epoch - 27ms/step
testing model: results/AAPL/W10/deepVOL_L2/seq2seq
Evaluating performance on  test set...
22048/22048 - 196s - 196s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0261655
{'0': {'precision': 0.48705228728254707, 'recall': 0.5799197909534256, 'f1-score': 0.5294445213435385, 'support': 2146890}, '1': {'precision': 0.433799661989967, 'recall': 0.0490298706014067, 'f1-score': 0.08810207271352831, 'support': 1319257}, '2': {'precision': 0.47610096514907696, 'recall': 0.6424135678015869, 'f1-score': 0.5468927057180906, 'support': 2177921}, 'accuracy': 0.47994336708912794, 'macro avg': {'precision': 0.4656509714738637, 'recall': 0.4237877431188064, 'f1-score': 0.38814643325838577, 'support': 5644068}, 'weighted avg': {'precision': 0.47037902729739767, 'recall': 0.47994336708912794, 'f1-score': 0.43301702479475973, 'support': 5644068}}
[[1245024   44420  857446]
 [ 572429   64683  682145]
 [ 738790   40005 1399126]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0517017
{'0': {'precision': 0.45676316252094384, 'recall': 0.5658684495694118, 'f1-score': 0.5054955460800102, 'support': 2075417}, '1': {'precision': 0.39282942305859286, 'recall': 0.020002343510037227, 'f1-score': 0.03806639748766263, 'support': 1442281}, '2': {'precision': 0.4517472282557056, 'recall': 0.6372362288783231, 'f1-score': 0.5286943493108928, 'support': 2126370}, 'accuracy': 0.4532656233057433, 'macro avg': {'precision': 0.4337799379450808, 'recall': 0.40770234065259076, 'f1-score': 0.35741876429285524, 'support': 5644068}, 'weighted avg': {'precision': 0.438535857352212, 'recall': 0.4532656233057433, 'f1-score': 0.3947890590860782, 'support': 5644068}}
[[1174413   23446  877558]
 [ 646525   28849  766907]
 [ 750226   21144 1355000]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0631005
{'0': {'precision': 0.4408764961894002, 'recall': 0.5566680604978281, 'f1-score': 0.49205193373589123, 'support': 2039941}, '1': {'precision': 0.41223080930878775, 'recall': 0.012570901233456378, 'f1-score': 0.02439779624518828, 'support': 1510552}, '2': {'precision': 0.4371173022876001, 'recall': 0.6310244438341115, 'f1-score': 0.5164702223610494, 'support': 2093575}, 'accuracy': 0.4386297259352651, 'macro avg': {'precision': 0.43007486926192934, 'recall': 0.400087801855132, 'f1-score': 0.3443066507807096, 'support': 5644068}, 'weighted avg': {'precision': 0.43181548665127206, 'recall': 0.4386297259352651, 'f1-score': 0.37594873049906974, 'support': 5644068}}
[[1135570   14253  890118]
 [ 680484   18989  811079]
 [ 759656   12822 1321097]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.055027
{'0': {'precision': 0.4453399370860762, 'recall': 0.5448345423415342, 'f1-score': 0.4900885366162149, 'support': 2133567}, '1': {'precision': 0.3367603076265755, 'recall': 0.009568067494670075, 'f1-score': 0.018607458033254688, 'support': 1318030}, '2': {'precision': 0.4461279534319165, 'recall': 0.6097102310589285, 'f1-score': 0.5152470929056067, 'support': 2192471}, 'accuracy': 0.44503786984848515, 'macro avg': {'precision': 0.4094093993815227, 'recall': 0.38803761363171096, 'f1-score': 0.3413143625183587, 'support': 5644068}, 'weighted avg': {'precision': 0.42029000749084017, 'recall': 0.44503786984848515, 'f1-score': 0.38975898691228855, 'support': 5644068}}
[[1162441   13233  957893]
 [ 603697   12611  701722]
 [ 844095   11604 1336772]]
Evaluating performance on  train set...
5429/5429 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0362874
{'0': {'precision': 0.4607973192386085, 'recall': 0.578327931755856, 'f1-score': 0.5129159556826648, 'support': 461285}, '1': {'precision': 0.5041393132068523, 'recall': 0.15466137137369834, 'f1-score': 0.2367055146386473, 'support': 460283}, '2': {'precision': 0.44624123981369346, 'recall': 0.6382040373493255, 'f1-score': 0.5252325163440338, 'support': 468228}, 'accuracy': 0.4581873886527231, 'macro avg': {'precision': 0.47039262408638477, 'recall': 0.4570644468262932, 'f1-score': 0.4249513288884486, 'support': 1389796}, 'weighted avg': {'precision': 0.47024764076257036, 'recall': 0.4581873886527231, 'f1-score': 0.4255880227560252, 'support': 1389796}}
[[266774  35913 158598]
 [176869  71188 212226]
 [135297  34106 298825]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0545645
{'0': {'precision': 0.43653962278695685, 'recall': 0.5919356630016529, 'f1-score': 0.5024979688116694, 'support': 459207}, '1': {'precision': 0.4741881595566964, 'recall': 0.0760292497245317, 'f1-score': 0.13104699848174056, 'support': 459218}, '2': {'precision': 0.43326628166028597, 'recall': 0.6374342078744768, 'f1-score': 0.5158842304608428, 'support': 471371}, 'accuracy': 0.43690081134209624, 'macro avg': {'precision': 0.4479980213346464, 'recall': 0.4351330402002205, 'f1-score': 0.38314306591808417, 'support': 1389796}, 'weighted avg': {'precision': 0.4478692910822364, 'recall': 0.43690081134209624, 'f1-score': 0.38430286956463117, 'support': 1389796}}
[[271821  19524 167862]
 [199139  34914 225165]
 [151712  19191 300468]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654507
{'0': {'precision': 0.42320863703016015, 'recall': 0.6015113317108765, 'f1-score': 0.49684752638189145, 'support': 457742}, '1': {'precision': 0.4528340635268346, 'recall': 0.043288674051226564, 'f1-score': 0.07902313153797451, 'support': 458434}, '2': {'precision': 0.42861148900310336, 'recall': 0.6292956378531313, 'f1-score': 0.5099187509302839, 'support': 473620}, 'accuracy': 0.4268460982762938, 'macro avg': {'precision': 0.434884729853366, 'recall': 0.4246985478717448, 'f1-score': 0.36192980295004995, 'support': 1389796}, 'weighted avg': {'precision': 0.4348219972082019, 'recall': 0.4268460982762938, 'f1-score': 0.36347966861336534, 'support': 1389796}}
[[275337  11759 170646]
 [211904  19845 226685]
 [163353  12220 298047]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0748824
{'0': {'precision': 0.4101485115506514, 'recall': 0.6049905910071447, 'f1-score': 0.48887091390433735, 'support': 457541}, '1': {'precision': 0.45889861864824866, 'recall': 0.032379124895572264, 'f1-score': 0.060490164200942935, 'support': 459648}, '2': {'precision': 0.42148411571548516, 'recall': 0.6086431220866386, 'f1-score': 0.4980615960535862, 'support': 472607}, 'accuracy': 0.4168525452656361, 'macro avg': {'precision': 0.4301770819714617, 'recall': 0.4153376126631185, 'f1-score': 0.3491408913862888, 'support': 1389796}, 'weighted avg': {'precision': 0.430126389674294, 'recall': 0.4168525452656361, 'f1-score': 0.35031764844584146, 'support': 1389796}}
[[276808   8540 172193]
 [222140  14883 222625]
 [175949   9009 287649]]
Evaluating performance on  val set...
1890/1890 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0448966
{'0': {'precision': 0.4422318222564357, 'recall': 0.5704132425758743, 'f1-score': 0.4982098791846749, 'support': 153082}, '1': {'precision': 0.5214364104132558, 'recall': 0.1660212861021687, 'f1-score': 0.25185416911065056, 'support': 174574}, '2': {'precision': 0.428069080045614, 'recall': 0.632814352834095, 'f1-score': 0.5106843022744555, 'support': 156011}, 'accuracy': 0.4445806722393713, 'macro avg': {'precision': 0.4639124375717685, 'recall': 0.4564162938373794, 'f1-score': 0.420249450189927, 'support': 483667}, 'weighted avg': {'precision': 0.4662514849537796, 'recall': 0.4445806722393713, 'f1-score': 0.41331437357895245, 'support': 483667}}
[[87320 13474 52288]
 [65974 28983 79617]
 [44159 13126 98726]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0646504
{'0': {'precision': 0.4182608291503997, 'recall': 0.5874446779899996, 'f1-score': 0.48862235784055547, 'support': 153194}, '1': {'precision': 0.4843841465514273, 'recall': 0.08166381237119387, 'f1-score': 0.13976432716000317, 'support': 172255}, '2': {'precision': 0.41802594105217444, 'recall': 0.6326903386466773, 'f1-score': 0.5034298588829322, 'support': 158218}, 'accuracy': 0.4221148021262563, 'macro avg': {'precision': 0.4402236389180005, 'recall': 0.4339329430026236, 'f1-score': 0.37727218129449697, 'support': 483667}, 'weighted avg': {'precision': 0.4417334012171088, 'recall': 0.4221148021262563, 'f1-score': 0.3692225913173985, 'support': 483667}}
[[ 89993   7335  55866]
 [ 74691  14067  83497]
 [ 50476   7639 100103]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0848202
{'0': {'precision': 0.3883727502340287, 'recall': 0.6028416918553245, 'f1-score': 0.47240491235796944, 'support': 145899}, '1': {'precision': 0.5058122381542456, 'recall': 0.046169673009700374, 'f1-score': 0.08461576427619566, 'support': 185663}, '2': {'precision': 0.3973577743369462, 'recall': 0.6276322277374182, 'f1-score': 0.4866282492729835, 'support': 152105}, 'accuracy': 0.3969507946583083, 'macro avg': {'precision': 0.43051425424174017, 'recall': 0.42554786420081436, 'f1-score': 0.3478829753023829, 'support': 483667}, 'weighted avg': {'precision': 0.4362793362465238, 'recall': 0.3969507946583083, 'f1-score': 0.3280190933154295, 'support': 483667}}
[[87954  3970 53975]
 [86280  8572 90811]
 [52234  4405 95466]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0849239
{'0': {'precision': 0.39429748206020976, 'recall': 0.6011977210928395, 'f1-score': 0.4762468907864707, 'support': 154460}, '1': {'precision': 0.44799150881776617, 'recall': 0.03272616661895219, 'f1-score': 0.060996487171506075, 'support': 167664}, '2': {'precision': 0.40891191094871326, 'recall': 0.5971536990151229, 'f1-score': 0.485422139025593, 'support': 161543}, 'accuracy': 0.40278538746699694, 'macro avg': {'precision': 0.4170669672755631, 'recall': 0.4103591955756382, 'f1-score': 0.34088850566118994, 'support': 483667}, 'weighted avg': {'precision': 0.41779177459663347, 'recall': 0.40278538746699694, 'f1-score': 0.3353641211424659, 'support': 483667}}
[[92861  3217 58382]
 [81116  5487 81061]
 [61533  3544 96466]]
training model: results/AAPL/W10/deepVOL_L3/seq2seq
Epoch 1/50
5429/5429 - 232s - loss: 12.8886 - accuracy10: 0.4187 - accuracy20: 0.4119 - accuracy30: 0.4081 - accuracy50: 0.4098 - val_loss: 13.3486 - val_accuracy10: 0.3997 - val_accuracy20: 0.3951 - val_accuracy30: 0.3745 - val_accuracy50: 0.3857 - 232s/epoch - 43ms/step
Epoch 2/50
5429/5429 - 217s - loss: 12.7701 - accuracy10: 0.4358 - accuracy20: 0.4251 - accuracy30: 0.4183 - accuracy50: 0.4171 - val_loss: 13.2527 - val_accuracy10: 0.4044 - val_accuracy20: 0.3984 - val_accuracy30: 0.3773 - val_accuracy50: 0.3885 - 217s/epoch - 40ms/step
Epoch 3/50
5429/5429 - 223s - loss: 12.7395 - accuracy10: 0.4406 - accuracy20: 0.4287 - accuracy30: 0.4212 - accuracy50: 0.4190 - val_loss: 13.1947 - val_accuracy10: 0.4102 - val_accuracy20: 0.4026 - val_accuracy30: 0.3812 - val_accuracy50: 0.3913 - 223s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 219s - loss: 12.7123 - accuracy10: 0.4451 - accuracy20: 0.4314 - accuracy30: 0.4234 - accuracy50: 0.4204 - val_loss: 13.1808 - val_accuracy10: 0.4115 - val_accuracy20: 0.4039 - val_accuracy30: 0.3817 - val_accuracy50: 0.3920 - 219s/epoch - 40ms/step
Epoch 5/50
5429/5429 - 219s - loss: 12.6931 - accuracy10: 0.4488 - accuracy20: 0.4336 - accuracy30: 0.4251 - accuracy50: 0.4215 - val_loss: 13.1134 - val_accuracy10: 0.4119 - val_accuracy20: 0.4036 - val_accuracy30: 0.3813 - val_accuracy50: 0.3920 - 219s/epoch - 40ms/step
Epoch 6/50
5429/5429 - 220s - loss: 12.6744 - accuracy10: 0.4518 - accuracy20: 0.4357 - accuracy30: 0.4266 - accuracy50: 0.4229 - val_loss: 13.0717 - val_accuracy10: 0.4150 - val_accuracy20: 0.4054 - val_accuracy30: 0.3833 - val_accuracy50: 0.3939 - 220s/epoch - 40ms/step
Epoch 7/50
5429/5429 - 219s - loss: 12.6578 - accuracy10: 0.4545 - accuracy20: 0.4373 - accuracy30: 0.4277 - accuracy50: 0.4235 - val_loss: 13.0323 - val_accuracy10: 0.4201 - val_accuracy20: 0.4069 - val_accuracy30: 0.3835 - val_accuracy50: 0.3935 - 219s/epoch - 40ms/step
Epoch 8/50
5429/5429 - 217s - loss: 12.6418 - accuracy10: 0.4570 - accuracy20: 0.4393 - accuracy30: 0.4295 - accuracy50: 0.4251 - val_loss: 12.9880 - val_accuracy10: 0.4249 - val_accuracy20: 0.4095 - val_accuracy30: 0.3862 - val_accuracy50: 0.3957 - 217s/epoch - 40ms/step
Epoch 9/50
5429/5429 - 218s - loss: 12.6250 - accuracy10: 0.4590 - accuracy20: 0.4407 - accuracy30: 0.4313 - accuracy50: 0.4265 - val_loss: 12.9634 - val_accuracy10: 0.4278 - val_accuracy20: 0.4105 - val_accuracy30: 0.3870 - val_accuracy50: 0.3971 - 218s/epoch - 40ms/step
Epoch 10/50
5429/5429 - 219s - loss: 12.6110 - accuracy10: 0.4606 - accuracy20: 0.4423 - accuracy30: 0.4326 - accuracy50: 0.4281 - val_loss: 12.9694 - val_accuracy10: 0.4296 - val_accuracy20: 0.4109 - val_accuracy30: 0.3868 - val_accuracy50: 0.3967 - 219s/epoch - 40ms/step
Epoch 11/50
5429/5429 - 218s - loss: 12.5979 - accuracy10: 0.4618 - accuracy20: 0.4440 - accuracy30: 0.4346 - accuracy50: 0.4300 - val_loss: 12.9883 - val_accuracy10: 0.4322 - val_accuracy20: 0.4124 - val_accuracy30: 0.3877 - val_accuracy50: 0.3975 - 218s/epoch - 40ms/step
Epoch 12/50
5429/5429 - 225s - loss: 12.5847 - accuracy10: 0.4630 - accuracy20: 0.4452 - accuracy30: 0.4358 - accuracy50: 0.4315 - val_loss: 12.9403 - val_accuracy10: 0.4394 - val_accuracy20: 0.4149 - val_accuracy30: 0.3893 - val_accuracy50: 0.3985 - 225s/epoch - 41ms/step
Epoch 13/50
5429/5429 - 225s - loss: 12.5730 - accuracy10: 0.4647 - accuracy20: 0.4462 - accuracy30: 0.4370 - accuracy50: 0.4336 - val_loss: 12.9473 - val_accuracy10: 0.4389 - val_accuracy20: 0.4147 - val_accuracy30: 0.3894 - val_accuracy50: 0.3977 - 225s/epoch - 42ms/step
Epoch 14/50
5429/5429 - 223s - loss: 12.5610 - accuracy10: 0.4660 - accuracy20: 0.4473 - accuracy30: 0.4380 - accuracy50: 0.4345 - val_loss: 12.9443 - val_accuracy10: 0.4406 - val_accuracy20: 0.4151 - val_accuracy30: 0.3893 - val_accuracy50: 0.3986 - 223s/epoch - 41ms/step
Epoch 15/50
5429/5429 - 216s - loss: 12.5521 - accuracy10: 0.4665 - accuracy20: 0.4483 - accuracy30: 0.4389 - accuracy50: 0.4358 - val_loss: 12.9482 - val_accuracy10: 0.4391 - val_accuracy20: 0.4157 - val_accuracy30: 0.3904 - val_accuracy50: 0.3990 - 216s/epoch - 40ms/step
Epoch 16/50
5429/5429 - 218s - loss: 12.5421 - accuracy10: 0.4679 - accuracy20: 0.4492 - accuracy30: 0.4398 - accuracy50: 0.4366 - val_loss: 12.9227 - val_accuracy10: 0.4424 - val_accuracy20: 0.4179 - val_accuracy30: 0.3926 - val_accuracy50: 0.4003 - 218s/epoch - 40ms/step
Epoch 17/50
5429/5429 - 218s - loss: 12.5328 - accuracy10: 0.4685 - accuracy20: 0.4500 - accuracy30: 0.4409 - accuracy50: 0.4373 - val_loss: 12.9311 - val_accuracy10: 0.4412 - val_accuracy20: 0.4179 - val_accuracy30: 0.3925 - val_accuracy50: 0.4003 - 218s/epoch - 40ms/step
Epoch 18/50
5429/5429 - 218s - loss: 12.5234 - accuracy10: 0.4695 - accuracy20: 0.4511 - accuracy30: 0.4419 - accuracy50: 0.4381 - val_loss: 12.8978 - val_accuracy10: 0.4454 - val_accuracy20: 0.4186 - val_accuracy30: 0.3924 - val_accuracy50: 0.4000 - 218s/epoch - 40ms/step
Epoch 19/50
5429/5429 - 217s - loss: 12.5146 - accuracy10: 0.4701 - accuracy20: 0.4514 - accuracy30: 0.4425 - accuracy50: 0.4392 - val_loss: 12.8839 - val_accuracy10: 0.4441 - val_accuracy20: 0.4198 - val_accuracy30: 0.3947 - val_accuracy50: 0.4017 - 217s/epoch - 40ms/step
Epoch 20/50
5429/5429 - 223s - loss: 12.5068 - accuracy10: 0.4711 - accuracy20: 0.4524 - accuracy30: 0.4433 - accuracy50: 0.4401 - val_loss: 12.8839 - val_accuracy10: 0.4439 - val_accuracy20: 0.4192 - val_accuracy30: 0.3937 - val_accuracy50: 0.4010 - 223s/epoch - 41ms/step
Epoch 21/50
5429/5429 - 215s - loss: 12.4995 - accuracy10: 0.4716 - accuracy20: 0.4531 - accuracy30: 0.4440 - accuracy50: 0.4409 - val_loss: 12.8812 - val_accuracy10: 0.4447 - val_accuracy20: 0.4189 - val_accuracy30: 0.3938 - val_accuracy50: 0.4019 - 215s/epoch - 40ms/step
Epoch 22/50
5429/5429 - 220s - loss: 12.4901 - accuracy10: 0.4722 - accuracy20: 0.4538 - accuracy30: 0.4445 - accuracy50: 0.4413 - val_loss: 12.8778 - val_accuracy10: 0.4452 - val_accuracy20: 0.4204 - val_accuracy30: 0.3955 - val_accuracy50: 0.4031 - 220s/epoch - 40ms/step
Epoch 23/50
5429/5429 - 219s - loss: 12.4830 - accuracy10: 0.4729 - accuracy20: 0.4543 - accuracy30: 0.4457 - accuracy50: 0.4423 - val_loss: 12.8668 - val_accuracy10: 0.4464 - val_accuracy20: 0.4217 - val_accuracy30: 0.3969 - val_accuracy50: 0.4039 - 219s/epoch - 40ms/step
Epoch 24/50
5429/5429 - 218s - loss: 12.4761 - accuracy10: 0.4734 - accuracy20: 0.4552 - accuracy30: 0.4463 - accuracy50: 0.4430 - val_loss: 12.8670 - val_accuracy10: 0.4450 - val_accuracy20: 0.4209 - val_accuracy30: 0.3962 - val_accuracy50: 0.4038 - 218s/epoch - 40ms/step
Epoch 25/50
5429/5429 - 216s - loss: 12.4699 - accuracy10: 0.4737 - accuracy20: 0.4557 - accuracy30: 0.4470 - accuracy50: 0.4435 - val_loss: 12.8722 - val_accuracy10: 0.4462 - val_accuracy20: 0.4212 - val_accuracy30: 0.3964 - val_accuracy50: 0.4039 - 216s/epoch - 40ms/step
Epoch 26/50
5429/5429 - 216s - loss: 12.4629 - accuracy10: 0.4742 - accuracy20: 0.4558 - accuracy30: 0.4470 - accuracy50: 0.4444 - val_loss: 12.8809 - val_accuracy10: 0.4443 - val_accuracy20: 0.4202 - val_accuracy30: 0.3957 - val_accuracy50: 0.4036 - 216s/epoch - 40ms/step
Epoch 27/50
5429/5429 - 217s - loss: 12.4559 - accuracy10: 0.4747 - accuracy20: 0.4566 - accuracy30: 0.4479 - accuracy50: 0.4452 - val_loss: 12.8710 - val_accuracy10: 0.4456 - val_accuracy20: 0.4212 - val_accuracy30: 0.3967 - val_accuracy50: 0.4039 - 217s/epoch - 40ms/step
Epoch 28/50
5429/5429 - 221s - loss: 12.4489 - accuracy10: 0.4752 - accuracy20: 0.4571 - accuracy30: 0.4490 - accuracy50: 0.4460 - val_loss: 12.8600 - val_accuracy10: 0.4459 - val_accuracy20: 0.4221 - val_accuracy30: 0.3974 - val_accuracy50: 0.4042 - 221s/epoch - 41ms/step
Epoch 29/50
5429/5429 - 221s - loss: 12.4430 - accuracy10: 0.4754 - accuracy20: 0.4578 - accuracy30: 0.4492 - accuracy50: 0.4467 - val_loss: 12.8545 - val_accuracy10: 0.4470 - val_accuracy20: 0.4224 - val_accuracy30: 0.3974 - val_accuracy50: 0.4038 - 221s/epoch - 41ms/step
Epoch 30/50
5429/5429 - 217s - loss: 12.4363 - accuracy10: 0.4761 - accuracy20: 0.4586 - accuracy30: 0.4503 - accuracy50: 0.4475 - val_loss: 12.8595 - val_accuracy10: 0.4466 - val_accuracy20: 0.4224 - val_accuracy30: 0.3980 - val_accuracy50: 0.4046 - 217s/epoch - 40ms/step
Epoch 31/50
5429/5429 - 218s - loss: 12.4295 - accuracy10: 0.4765 - accuracy20: 0.4589 - accuracy30: 0.4507 - accuracy50: 0.4480 - val_loss: 12.8746 - val_accuracy10: 0.4467 - val_accuracy20: 0.4217 - val_accuracy30: 0.3968 - val_accuracy50: 0.4041 - 218s/epoch - 40ms/step
Epoch 32/50
5429/5429 - 221s - loss: 12.4224 - accuracy10: 0.4770 - accuracy20: 0.4596 - accuracy30: 0.4518 - accuracy50: 0.4489 - val_loss: 12.8528 - val_accuracy10: 0.4481 - val_accuracy20: 0.4228 - val_accuracy30: 0.3975 - val_accuracy50: 0.4044 - 221s/epoch - 41ms/step
Epoch 33/50
5429/5429 - 222s - loss: 12.4164 - accuracy10: 0.4772 - accuracy20: 0.4601 - accuracy30: 0.4521 - accuracy50: 0.4496 - val_loss: 12.8634 - val_accuracy10: 0.4464 - val_accuracy20: 0.4214 - val_accuracy30: 0.3970 - val_accuracy50: 0.4037 - 222s/epoch - 41ms/step
Epoch 34/50
5429/5429 - 219s - loss: 12.4103 - accuracy10: 0.4776 - accuracy20: 0.4608 - accuracy30: 0.4530 - accuracy50: 0.4501 - val_loss: 12.8629 - val_accuracy10: 0.4466 - val_accuracy20: 0.4223 - val_accuracy30: 0.3977 - val_accuracy50: 0.4046 - 219s/epoch - 40ms/step
Epoch 35/50
5429/5429 - 219s - loss: 12.4044 - accuracy10: 0.4781 - accuracy20: 0.4614 - accuracy30: 0.4534 - accuracy50: 0.4509 - val_loss: 12.8621 - val_accuracy10: 0.4456 - val_accuracy20: 0.4225 - val_accuracy30: 0.3973 - val_accuracy50: 0.4035 - 219s/epoch - 40ms/step
Epoch 36/50
5429/5429 - 221s - loss: 12.3973 - accuracy10: 0.4784 - accuracy20: 0.4619 - accuracy30: 0.4542 - accuracy50: 0.4519 - val_loss: 12.8642 - val_accuracy10: 0.4461 - val_accuracy20: 0.4222 - val_accuracy30: 0.3976 - val_accuracy50: 0.4036 - 221s/epoch - 41ms/step
Epoch 37/50
5429/5429 - 219s - loss: 12.3919 - accuracy10: 0.4786 - accuracy20: 0.4622 - accuracy30: 0.4549 - accuracy50: 0.4523 - val_loss: 12.8666 - val_accuracy10: 0.4447 - val_accuracy20: 0.4218 - val_accuracy30: 0.3983 - val_accuracy50: 0.4044 - 219s/epoch - 40ms/step
Epoch 38/50
5429/5429 - 221s - loss: 12.3857 - accuracy10: 0.4790 - accuracy20: 0.4630 - accuracy30: 0.4554 - accuracy50: 0.4534 - val_loss: 12.8656 - val_accuracy10: 0.4458 - val_accuracy20: 0.4217 - val_accuracy30: 0.3976 - val_accuracy50: 0.4038 - 221s/epoch - 41ms/step
Epoch 39/50
5429/5429 - 217s - loss: 12.3799 - accuracy10: 0.4795 - accuracy20: 0.4634 - accuracy30: 0.4562 - accuracy50: 0.4544 - val_loss: 12.8731 - val_accuracy10: 0.4445 - val_accuracy20: 0.4211 - val_accuracy30: 0.3961 - val_accuracy50: 0.4023 - 217s/epoch - 40ms/step
Epoch 40/50
5429/5429 - 220s - loss: 12.3744 - accuracy10: 0.4796 - accuracy20: 0.4638 - accuracy30: 0.4567 - accuracy50: 0.4549 - val_loss: 12.8512 - val_accuracy10: 0.4461 - val_accuracy20: 0.4230 - val_accuracy30: 0.3992 - val_accuracy50: 0.4050 - 220s/epoch - 41ms/step
Epoch 41/50
5429/5429 - 215s - loss: 12.3677 - accuracy10: 0.4801 - accuracy20: 0.4644 - accuracy30: 0.4576 - accuracy50: 0.4555 - val_loss: 12.8609 - val_accuracy10: 0.4455 - val_accuracy20: 0.4223 - val_accuracy30: 0.3980 - val_accuracy50: 0.4039 - 215s/epoch - 40ms/step
Epoch 42/50
5429/5429 - 223s - loss: 12.3627 - accuracy10: 0.4804 - accuracy20: 0.4650 - accuracy30: 0.4576 - accuracy50: 0.4564 - val_loss: 12.8608 - val_accuracy10: 0.4464 - val_accuracy20: 0.4226 - val_accuracy30: 0.3973 - val_accuracy50: 0.4035 - 223s/epoch - 41ms/step
Epoch 43/50
5429/5429 - 217s - loss: 12.3568 - accuracy10: 0.4804 - accuracy20: 0.4652 - accuracy30: 0.4582 - accuracy50: 0.4565 - val_loss: 12.8533 - val_accuracy10: 0.4465 - val_accuracy20: 0.4222 - val_accuracy30: 0.3972 - val_accuracy50: 0.4029 - 217s/epoch - 40ms/step
Epoch 44/50
5429/5429 - 222s - loss: 12.3500 - accuracy10: 0.4806 - accuracy20: 0.4655 - accuracy30: 0.4592 - accuracy50: 0.4580 - val_loss: 12.8650 - val_accuracy10: 0.4470 - val_accuracy20: 0.4222 - val_accuracy30: 0.3973 - val_accuracy50: 0.4024 - 222s/epoch - 41ms/step
Epoch 45/50
5429/5429 - 219s - loss: 12.3453 - accuracy10: 0.4811 - accuracy20: 0.4663 - accuracy30: 0.4595 - accuracy50: 0.4584 - val_loss: 12.8692 - val_accuracy10: 0.4456 - val_accuracy20: 0.4221 - val_accuracy30: 0.3972 - val_accuracy50: 0.4018 - 219s/epoch - 40ms/step
Epoch 46/50
5429/5429 - 217s - loss: 12.3386 - accuracy10: 0.4812 - accuracy20: 0.4664 - accuracy30: 0.4604 - accuracy50: 0.4593 - val_loss: 12.8834 - val_accuracy10: 0.4449 - val_accuracy20: 0.4217 - val_accuracy30: 0.3962 - val_accuracy50: 0.4014 - 217s/epoch - 40ms/step
Epoch 47/50
5429/5429 - 220s - loss: 12.3334 - accuracy10: 0.4814 - accuracy20: 0.4669 - accuracy30: 0.4611 - accuracy50: 0.4600 - val_loss: 12.8756 - val_accuracy10: 0.4456 - val_accuracy20: 0.4218 - val_accuracy30: 0.3973 - val_accuracy50: 0.4024 - 220s/epoch - 41ms/step
Epoch 48/50
5429/5429 - 222s - loss: 12.3255 - accuracy10: 0.4819 - accuracy20: 0.4677 - accuracy30: 0.4620 - accuracy50: 0.4611 - val_loss: 12.8926 - val_accuracy10: 0.4441 - val_accuracy20: 0.4204 - val_accuracy30: 0.3958 - val_accuracy50: 0.4011 - 222s/epoch - 41ms/step
Epoch 49/50
5429/5429 - 217s - loss: 12.3202 - accuracy10: 0.4822 - accuracy20: 0.4682 - accuracy30: 0.4627 - accuracy50: 0.4620 - val_loss: 12.8820 - val_accuracy10: 0.4457 - val_accuracy20: 0.4213 - val_accuracy30: 0.3964 - val_accuracy50: 0.4007 - 217s/epoch - 40ms/step
Epoch 50/50
5429/5429 - 217s - loss: 12.3153 - accuracy10: 0.4825 - accuracy20: 0.4686 - accuracy30: 0.4629 - accuracy50: 0.4620 - val_loss: 12.8684 - val_accuracy10: 0.4460 - val_accuracy20: 0.4216 - val_accuracy30: 0.3968 - val_accuracy50: 0.4015 - 217s/epoch - 40ms/step
testing model: results/AAPL/W10/deepVOL_L3/seq2seq
Evaluating performance on  test set...
22048/22048 - 362s - 362s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0276453
{'0': {'precision': 0.48657388260187484, 'recall': 0.5803306177773431, 'f1-score': 0.529332703694286, 'support': 2146890}, '1': {'precision': 0.42587769256999414, 'recall': 0.04449474211620632, 'f1-score': 0.08057155014446603, 'support': 1319257}, '2': {'precision': 0.47587438630177353, 'recall': 0.6436261921346091, 'f1-score': 0.5471818864401053, 'support': 2177921}, 'accuracy': 0.47950751124897856, 'macro avg': {'precision': 0.46277532049121417, 'recall': 0.42281718400938617, 'f1-score': 0.3856953800929525, 'support': 5644068}, 'weighted avg': {'precision': 0.46825792126790405, 'recall': 0.47950751124897856, 'f1-score': 0.4313258789689784, 'support': 5644068}}
[[1245906   42184  858800]
 [ 575458   58700  685099]
 [ 739205   36949 1401767]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0540155
{'0': {'precision': 0.45614449493449283, 'recall': 0.5564134822062266, 'f1-score': 0.5013143988700793, 'support': 2075417}, '1': {'precision': 0.3840630633383238, 'recall': 0.017430722584572633, 'f1-score': 0.03334794682634063, 'support': 1442281}, '2': {'precision': 0.44882109421203564, 'recall': 0.6431373655572643, 'f1-score': 0.5286897382507421, 'support': 2126370}, 'accuracy': 0.4513549446959179, 'macro avg': {'precision': 0.4296762174949507, 'recall': 0.4056605234493545, 'f1-score': 0.35445069464905404, 'support': 5644068}, 'weighted avg': {'precision': 0.4349658098374731, 'recall': 0.4513549446959179, 'f1-score': 0.39204409560278425, 'support': 5644068}}
[[1154790   21574  899053]
 [ 636764   25140  780377]
 [ 740078   18744 1367548]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664675
{'0': {'precision': 0.44061646766678925, 'recall': 0.5375449584081108, 'f1-score': 0.48427826833510135, 'support': 2039941}, '1': {'precision': 0.400848577589205, 'recall': 0.011445484829386874, 'f1-score': 0.022255505144871894, 'support': 1510552}, '2': {'precision': 0.43330756412901056, 'recall': 0.644141241656019, 'f1-score': 0.5180965831107779, 'support': 2093575}, 'accuracy': 0.4362823055994364, 'macro avg': {'precision': 0.4249242031283349, 'recall': 0.39771056163117224, 'f1-score': 0.341543452196917, 'support': 5644068}, 'weighted avg': {'precision': 0.42726205669644307, 'recall': 0.4362823055994364, 'f1-score': 0.37316900625214267, 'support': 5644068}}
[[1096560   13651  929730]
 [ 659309   17289  833954]
 [ 732826   12191 1348558]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0588448
{'0': {'precision': 0.4447223684099605, 'recall': 0.5192445327472726, 'f1-score': 0.47910287813839564, 'support': 2133567}, '1': {'precision': 0.30983739624518863, 'recall': 0.008977792614735629, 'f1-score': 0.01744995837699018, 'support': 1318030}, '2': {'precision': 0.4418968481964102, 'recall': 0.6277916560811979, 'f1-score': 0.5186914752040555, 'support': 2192471}, 'accuracy': 0.44225034142040814, 'macro avg': {'precision': 0.39881887095051977, 'recall': 0.385337993814402, 'f1-score': 0.3384147705731471, 'support': 5644068}, 'weighted avg': {'precision': 0.41212578895867513, 'recall': 0.44225034142040814, 'f1-score': 0.3866738806784109, 'support': 5644068}}
[[1107843   13878 1011846]
 [ 579670   11833  726527]
 [ 803576   12480 1376415]]
Evaluating performance on  train set...
5429/5429 - 90s - 90s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0319432
{'0': {'precision': 0.46598568391187023, 'recall': 0.5753731424173776, 'f1-score': 0.5149342195888069, 'support': 461285}, '1': {'precision': 0.5035393216243336, 'recall': 0.16026444600387152, 'f1-score': 0.24314248986453077, 'support': 460283}, '2': {'precision': 0.45029462841197515, 'recall': 0.6479257968340211, 'f1-score': 0.5313277721247192, 'support': 468228}, 'accuracy': 0.46233763804184214, 'macro avg': {'precision': 0.47327321131605965, 'recall': 0.46118779508509006, 'f1-score': 0.42980149385935223, 'support': 1389796}, 'weighted avg': {'precision': 0.473136596342616, 'recall': 0.46233763804184214, 'f1-score': 0.4304432637824196, 'support': 1389796}}
[[265411  38233 157641]
 [173804  73767 212712]
 [130354  34497 303377]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0510559
{'0': {'precision': 0.44486223945580056, 'recall': 0.5776262121439787, 'f1-score': 0.5026249243220249, 'support': 459207}, '1': {'precision': 0.4830744516847819, 'recall': 0.0812010853233105, 'f1-score': 0.13903197000796033, 'support': 459218}, '2': {'precision': 0.43399971801611775, 'recall': 0.6595590309968157, 'f1-score': 0.5235172481148819, 'support': 471371}, 'accuracy': 0.4413856422093602, 'macro avg': {'precision': 0.45397880305223337, 'recall': 0.43946210948803494, 'f1-score': 0.38839138081495567, 'support': 1389796}, 'weighted avg': {'precision': 0.4538041691216102, 'recall': 0.4413856422093602, 'f1-score': 0.3895720779074192, 'support': 1389796}}
[[265250  20683 173274]
 [189747  37289 232182]
 [141255  19219 310897]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620381
{'0': {'precision': 0.43319190851510486, 'recall': 0.5783825823280363, 'f1-score': 0.49536768069693876, 'support': 457742}, '1': {'precision': 0.4626684899394413, 'recall': 0.05166283478101537, 'f1-score': 0.09294695697219911, 'support': 458434}, '2': {'precision': 0.4286757074417997, 'recall': 0.6584139183311516, 'f1-score': 0.5192691486305904, 'support': 473620}, 'accuracy': 0.4319137484925845, 'macro avg': {'precision': 0.44151203529878197, 'recall': 0.4294864451467344, 'f1-score': 0.36919459543324273, 'support': 1389796}, 'weighted avg': {'precision': 0.44137591823764366, 'recall': 0.4319137484925845, 'f1-score': 0.37077160413801125, 'support': 1389796}}
[[264750  13855 179137]
 [198280  23684 236470]
 [148131  13651 311838]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0712081
{'0': {'precision': 0.4200533952039665, 'recall': 0.5777121613145052, 'f1-score': 0.48642680282036155, 'support': 457541}, '1': {'precision': 0.47952316862141897, 'recall': 0.04340712893344472, 'f1-score': 0.07960802464209905, 'support': 459648}, '2': {'precision': 0.42190347160594116, 'recall': 0.6417890551769229, 'f1-score': 0.5091189861731814, 'support': 472607}, 'accuracy': 0.42279082685516434, 'macro avg': {'precision': 0.4404933451437755, 'recall': 0.42096944847495754, 'f1-score': 0.358384604545214, 'support': 1389796}, 'weighted avg': {'precision': 0.4403509938946328, 'recall': 0.42279082685516434, 'f1-score': 0.35959599236022505, 'support': 1389796}}
[[264327  10711 182503]
 [206595  19952 233101]
 [158348  10945 303314]]
Evaluating performance on  val set...
1890/1890 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0431106
{'0': {'precision': 0.44663444040619443, 'recall': 0.569165545263323, 'f1-score': 0.5005098216055216, 'support': 153082}, '1': {'precision': 0.5160834525346265, 'recall': 0.16946968047933827, 'f1-score': 0.25515308322552827, 'support': 174574}, '2': {'precision': 0.42971607959803165, 'recall': 0.6369871355224952, 'f1-score': 0.5132141925721648, 'support': 156011}, 'accuracy': 0.44677639781089057, 'macro avg': {'precision': 0.46414465751295086, 'recall': 0.45854078708838547, 'f1-score': 0.4229590324677382, 'support': 483667}, 'weighted avg': {'precision': 0.46624409220229923, 'recall': 0.44677639781089057, 'f1-score': 0.41604905494773436, 'support': 483667}}
[[87129 14220 51733]
 [64837 29585 80152]
 [43113 13521 99377]]
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0648091
{'0': {'precision': 0.4228813927552395, 'recall': 0.5717652127367913, 'f1-score': 0.48618045475864713, 'support': 153194}, '1': {'precision': 0.4830500115082366, 'recall': 0.08528634872717773, 'f1-score': 0.14497601989460598, 'support': 172255}, '2': {'precision': 0.41463484002031487, 'recall': 0.6450087853468, 'f1-score': 0.5047793581192205, 'support': 158218}, 'accuracy': 0.42246835115895853, 'macro avg': {'precision': 0.44018874809459696, 'recall': 0.43402011560358966, 'f1-score': 0.3786452775908245, 'support': 483667}, 'weighted avg': {'precision': 0.4416124460267738, 'recall': 0.42246835115895853, 'f1-score': 0.37074671907768847, 'support': 483667}}
[[ 87591   7932  57671]
 [ 71162  14691  86402]
 [ 48376   7790 102052]]
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845423
{'0': {'precision': 0.3931532134703992, 'recall': 0.5795721697886894, 'f1-score': 0.4684994653413781, 'support': 145899}, '1': {'precision': 0.5133201400517583, 'recall': 0.054485815698335154, 'f1-score': 0.09851487559039782, 'support': 185663}, '2': {'precision': 0.3934209521819665, 'recall': 0.6437329476348576, 'f1-score': 0.48837116507808254, 'support': 152105}, 'accuracy': 0.3981871825036647, 'macro avg': {'precision': 0.43329810190137463, 'recall': 0.42593031104062734, 'f1-score': 0.3517951686699528, 'support': 483667}, 'weighted avg': {'precision': 0.4393653314908509, 'recall': 0.3981871825036647, 'f1-score': 0.33272451274282416, 'support': 483667}}
[[84559  4732 56608]
 [81189 10116 94358]
 [49331  4859 97915]]
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0850028
{'0': {'precision': 0.3981395515727248, 'recall': 0.5746989511847728, 'f1-score': 0.47039746487307144, 'support': 154460}, '1': {'precision': 0.45907003083118353, 'recall': 0.04351560263383911, 'f1-score': 0.07949574246691764, 'support': 167664}, '2': {'precision': 0.4058419145729259, 'recall': 0.6150498628848047, 'f1-score': 0.489009745053647, 'support': 161543}, 'accuracy': 0.4040403831561798, 'macro avg': {'precision': 0.42101716565894476, 'recall': 0.4110881389011389, 'f1-score': 0.3463009841312121, 'support': 483667}, 'weighted avg': {'precision': 0.42183376825596286, 'recall': 0.4040403831561798, 'f1-score': 0.3411071415549732, 'support': 483667}}
[[88768  4163 61529]
 [76437  7296 83931]
 [57752  4434 99357]]
