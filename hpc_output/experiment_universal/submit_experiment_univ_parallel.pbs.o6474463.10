This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W3/deepLOB_L1/h50
Epoch 1/50
10532/10532 - 172s - loss: 3.0925 - accuracy50: 0.4499 - val_loss: 3.3697 - val_accuracy50: 0.4250 - 172s/epoch - 16ms/step
Epoch 2/50
10532/10532 - 157s - loss: 3.0178 - accuracy50: 0.4735 - val_loss: 3.3202 - val_accuracy50: 0.4412 - 157s/epoch - 15ms/step
Epoch 3/50
10532/10532 - 155s - loss: 2.9842 - accuracy50: 0.4834 - val_loss: 3.3662 - val_accuracy50: 0.4370 - 155s/epoch - 15ms/step
Epoch 4/50
10532/10532 - 157s - loss: 2.9666 - accuracy50: 0.4881 - val_loss: 3.3854 - val_accuracy50: 0.4341 - 157s/epoch - 15ms/step
Epoch 5/50
10532/10532 - 154s - loss: 2.9556 - accuracy50: 0.4908 - val_loss: 3.4338 - val_accuracy50: 0.4350 - 154s/epoch - 15ms/step
Epoch 6/50
10532/10532 - 154s - loss: 2.9479 - accuracy50: 0.4929 - val_loss: 3.4150 - val_accuracy50: 0.4330 - 154s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 158s - loss: 2.9431 - accuracy50: 0.4942 - val_loss: 3.3592 - val_accuracy50: 0.4333 - 158s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 160s - loss: 2.9379 - accuracy50: 0.4954 - val_loss: 3.3775 - val_accuracy50: 0.4273 - 160s/epoch - 15ms/step
Epoch 9/50
10532/10532 - 155s - loss: 2.9340 - accuracy50: 0.4967 - val_loss: 3.3649 - val_accuracy50: 0.4302 - 155s/epoch - 15ms/step
Epoch 10/50
10532/10532 - 154s - loss: 2.9307 - accuracy50: 0.4975 - val_loss: 3.3553 - val_accuracy50: 0.4324 - 154s/epoch - 15ms/step
Epoch 11/50
10532/10532 - 157s - loss: 2.9282 - accuracy50: 0.4980 - val_loss: 3.3566 - val_accuracy50: 0.4313 - 157s/epoch - 15ms/step
Epoch 12/50
10532/10532 - 154s - loss: 2.9259 - accuracy50: 0.4986 - val_loss: 3.3912 - val_accuracy50: 0.4336 - 154s/epoch - 15ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 142s - 142s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.092894
{'0': {'precision': 0.4857478171465403, 'recall': 0.1642214431446963, 'f1-score': 0.24545840060327676, 'support': 2074248}, '1': {'precision': 0.41924193288671885, 'recall': 0.6214379822755501, 'f1-score': 0.5006973941988692, 'support': 2941135}, '2': {'precision': 0.39611335296864836, 'recall': 0.38741264278685567, 'f1-score': 0.3917146891055621, 'support': 2071094}, 'accuracy': 0.41921211343803133, 'macro avg': {'precision': 0.4337010343339691, 'recall': 0.3910240227357007, 'f1-score': 0.3792901613025694, 'support': 7086477}, 'weighted avg': {'precision': 0.4319489852510079, 'recall': 0.41921211343803133, 'f1-score': 0.394136348617237, 'support': 7086477}}
[[ 340636 1353192  380420]
 [ 270588 1827733  842814]
 [  90037 1178689  802368]]
Evaluating performance on  train set...
10532/10532 - 70s - 70s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1122599
{'0': {'precision': 0.49274841275912185, 'recall': 0.15556824781954015, 'f1-score': 0.23647705465528523, 'support': 828151}, '1': {'precision': 0.4061371116641246, 'recall': 0.7290858688000063, 'f1-score': 0.5216751845324706, 'support': 1026997}, '2': {'precision': 0.4378123349449478, 'recall': 0.30764042538005854, 'f1-score': 0.3613609879192831, 'support': 840660}, 'accuracy': 0.4214780874602346, 'macro avg': {'precision': 0.4455659531227314, 'recall': 0.3974315139998683, 'f1-score': 0.3731710757023463, 'support': 2695808}, 'weighted avg': {'precision': 0.44262165686036253, 'recall': 0.4214780874602346, 'f1-score': 0.3840701143714046, 'support': 2695808}}
[[128834 555785 143532]
 [ 89669 748769 188559]
 [ 42957 539082 258621]]
Evaluating performance on  val set...
3814/3814 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831175
{'0': {'precision': 0.48864652441245626, 'recall': 0.15276359018249083, 'f1-score': 0.23276027521512685, 'support': 289768}, '1': {'precision': 0.4416148640311024, 'recall': 0.6991315687324151, 'f1-score': 0.5413067861499448, 'support': 394159}, '2': {'precision': 0.42391949257970546, 'recall': 0.3793866560697206, 'f1-score': 0.4004186921835087, 'support': 291908}, 'accuracy': 0.44124365287164324, 'macro avg': {'precision': 0.4513936270077547, 'recall': 0.4104272716615422, 'f1-score': 0.39149525118286005, 'support': 975835}, 'weighted avg': {'precision': 0.4502872827040848, 'recall': 0.44124365287164324, 'f1-score': 0.40754107051757377, 'support': 975835}}
[[ 44266 179286  66216]
 [ 34309 275569  84281]
 [ 12014 169148 110746]]
testing model out of sample: results/universal/W3/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 85s - 85s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0404648
{'0': {'precision': 0.48856454790921694, 'recall': 0.20303902590346726, 'f1-score': 0.28686280306967366, 'support': 1154054}, '1': {'precision': 0.485805110598218, 'recall': 0.7604367104037335, 'f1-score': 0.5928609263066167, 'support': 1837648}, '2': {'precision': 0.4487259167184587, 'recall': 0.3058891768674859, 'f1-score': 0.3637891753578727, 'support': 1144761}, 'accuracy': 0.4791298749680585, 'macro avg': {'precision': 0.4743651917419645, 'recall': 0.4231216377248956, 'f1-score': 0.41450430157805435, 'support': 4136463}, 'weighted avg': {'precision': 0.4763133599410794, 'recall': 0.4791298749680585, 'f1-score': 0.44409354586542277, 'support': 4136463}}
[[ 234318  783396  136340]
 [ 146378 1397415  293855]
 [  98909  695682  350170]]
Evaluating performance on  train set...
6181/6181 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1280067
{'0': {'precision': 0.48784313022593045, 'recall': 0.2177495809815632, 'f1-score': 0.30110185523215294, 'support': 499978}, '1': {'precision': 0.4072475494877909, 'recall': 0.6562823716590719, 'f1-score': 0.5026081209675444, 'support': 578245}, '2': {'precision': 0.43609161736277896, 'recall': 0.36959155142146777, 'f1-score': 0.40009716888145075, 'support': 503564}, 'accuracy': 0.42640064686332607, 'macro avg': {'precision': 0.44372743235883344, 'recall': 0.41454116802070096, 'f1-score': 0.4012690483603827, 'support': 1581787}, 'weighted avg': {'precision': 0.4419050927990547, 'recall': 0.42640064686332607, 'f1-score': 0.4062806604395901, 'support': 1581787}}
[[108870 284335 106773]
 [ 64864 379492 133889]
 [ 49432 268019 186113]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0846273
{'0': {'precision': 0.4963344441078461, 'recall': 0.24249313251870797, 'f1-score': 0.3258072598702657, 'support': 168912}, '1': {'precision': 0.4683830061488617, 'recall': 0.5860197712532255, 'f1-score': 0.5206391864758582, 'support': 229424}, '2': {'precision': 0.4109737850745045, 'recall': 0.4820241601057756, 'f1-score': 0.4436724510850625, 'support': 166390}, 'accuracy': 0.4526283542815454, 'macro avg': {'precision': 0.4585637451104041, 'recall': 0.43684568795923634, 'f1-score': 0.4300396324770621, 'support': 564726}, 'weighted avg': {'precision': 0.45982843808216334, 'recall': 0.4526283542815454, 'f1-score': 0.43968675027055093, 'support': 564726}}
[[ 40960  81479  46473]
 [ 26498 134447  68479]
 [ 15067  71119  80204]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2086397
{'0': {'precision': 0.38114517061885483, 'recall': 0.0346264996934933, 'f1-score': 0.06348543720497095, 'support': 57095}, '1': {'precision': 0.346188541061939, 'recall': 0.6506143413455082, 'f1-score': 0.45191528555855454, 'support': 59576}, '2': {'precision': 0.3816856330014225, 'recall': 0.3784488989968442, 'f1-score': 0.380060374819628, 'support': 56721}, 'accuracy': 0.35874780843406845, 'macro avg': {'precision': 0.3696731148940721, 'recall': 0.3545632466786152, 'f1-score': 0.2984870325277178, 'support': 173392}, 'weighted avg': {'precision': 0.36931117253543, 'recall': 0.35874780843406845, 'f1-score': 0.30050642826542384, 'support': 173392}}
[[ 1977 39426 15692]
 [ 1733 38761 19082]
 [ 1477 33778 21466]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2562873
{'0': {'precision': 0.3971414806487875, 'recall': 0.11064876957494407, 'f1-score': 0.17307625013122444, 'support': 22350}, '1': {'precision': 0.33871608864155817, 'recall': 0.6317301454916133, 'f1-score': 0.4409871591680952, 'support': 21582}, '2': {'precision': 0.38443324937027706, 'recall': 0.34071527436710275, 'f1-score': 0.361256420574242, 'support': 22397}, 'accuracy': 0.35788267575268734, 'macro avg': {'precision': 0.3734302728868743, 'recall': 0.3610313964778867, 'f1-score': 0.3251066099578539, 'support': 66329}, 'weighted avg': {'precision': 0.3738400127200561, 'recall': 0.35788267575268734, 'f1-score': 0.32379048547694067, 'support': 66329}}
[[ 2473 13635  6242]
 [ 1971 13634  5977]
 [ 1783 12983  7631]]
Evaluating performance on  val set...
86/86 - 1s - 612ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2501065
{'0': {'precision': 0.47410817031070196, 'recall': 0.055028716441832506, 'f1-score': 0.09861177596936332, 'support': 7487}, '1': {'precision': 0.3386336866902238, 'recall': 0.6397774687065368, 'f1-score': 0.44286126889380956, 'support': 7190}, '2': {'precision': 0.37414784119770084, 'recall': 0.38569656883009507, 'f1-score': 0.3798344415795902, 'support': 7257}, 'accuracy': 0.3561137959332543, 'macro avg': {'precision': 0.3956298993995422, 'recall': 0.3601675846594881, 'f1-score': 0.307102495480921, 'support': 21934}, 'weighted avg': {'precision': 0.39662692450034875, 'recall': 0.3561137959332543, 'f1-score': 0.30450156982639737, 'support': 21934}}
[[ 412 4730 2345]
 [ 253 4600 2337]
 [ 204 4254 2799]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9367151
{'0': {'precision': 0.4910778848172424, 'recall': 0.29912477622119293, 'f1-score': 0.3717870608284107, 'support': 70382}, '1': {'precision': 0.7137382959581486, 'recall': 0.558367474616698, 'f1-score': 0.6265646443397354, 'support': 230171}, '2': {'precision': 0.31196698010059043, 'recall': 0.6643189755529686, 'f1-score': 0.42455918458448033, 'support': 68720}, 'accuracy': 0.5286739079217815, 'macro avg': {'precision': 0.5055943869586604, 'recall': 0.5072704087969532, 'f1-score': 0.4743036299175421, 'support': 369273}, 'weighted avg': {'precision': 0.5965322996284667, 'recall': 0.5286739079217815, 'f1-score': 0.5404127429630433, 'support': 369273}}
[[ 21053  32039  17290]
 [ 18257 128520  83394]
 [  3561  19507  45652]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0274237
{'0': {'precision': 0.5492310764929099, 'recall': 0.171939477303989, 'f1-score': 0.2618922908432932, 'support': 47982}, '1': {'precision': 0.510518062965829, 'recall': 0.7269155491119971, 'f1-score': 0.5997954386405643, 'support': 68975}, '2': {'precision': 0.43965618976436804, 'recall': 0.4744046861072202, 'f1-score': 0.456369946917109, 'support': 47118}, 'accuracy': 0.4921042206308091, 'macro avg': {'precision': 0.4998017764077023, 'recall': 0.4577532375077354, 'f1-score': 0.43935255880032215, 'support': 164075}, 'weighted avg': {'precision': 0.5014896191050944, 'recall': 0.4921042206308091, 'f1-score': 0.45979122619726437, 'support': 164075}}
[[ 8250 25296 14436]
 [ 4783 50139 14053]
 [ 1988 22777 22353]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0272174
{'0': {'precision': 0.5078098278417512, 'recall': 0.24350773604504947, 'f1-score': 0.32917005395018845, 'support': 18291}, '1': {'precision': 0.5084534308453431, 'recall': 0.7152842920688716, 'f1-score': 0.5943900323120058, 'support': 33047}, '2': {'precision': 0.41968911917098445, 'recall': 0.33203790459965926, 'f1-score': 0.3707534551939367, 'support': 18784}, 'accuracy': 0.4895610507401386, 'macro avg': {'precision': 0.47865079261935956, 'recall': 0.4302766442378601, 'f1-score': 0.43143784715204364, 'support': 70122}, 'weighted avg': {'precision': 0.48450772232262773, 'recall': 0.4895610507401386, 'f1-score': 0.46530175632441545, 'support': 70122}}
[[ 4454 11414  2423]
 [ 3208 23638  6201]
 [ 1109 11438  6237]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
1359/1359 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2413383
{'0': {'precision': 0.43193423838585127, 'recall': 0.2774621969757581, 'f1-score': 0.337879968823071, 'support': 124990}, '1': {'precision': 0.29132761222354914, 'recall': 0.6228069307420565, 'f1-score': 0.39696750856987884, 'support': 101057}, '2': {'precision': 0.45674095086362665, 'recall': 0.1930778454917292, 'f1-score': 0.2714189224294695, 'support': 121754}, 'accuracy': 0.3482652436306969, 'macro avg': {'precision': 0.39333426715767567, 'recall': 0.3644489910698479, 'f1-score': 0.3354221332741398, 'support': 347801}, 'weighted avg': {'precision': 0.3997636369526618, 'recall': 0.3482652436306969, 'f1-score': 0.3317825489237223, 'support': 347801}}
[[34680 76958 13352]
 [23509 62939 14609]
 [22101 76145 23508]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2742684
{'0': {'precision': 0.3995234965494578, 'recall': 0.2599770121087381, 'f1-score': 0.3149866407578334, 'support': 37411}, '1': {'precision': 0.3411241519588645, 'recall': 0.7206031491860154, 'f1-score': 0.4630475978151822, 'support': 37470}, '2': {'precision': 0.4094332144272691, 'recall': 0.10674795907822672, 'f1-score': 0.16934426229508195, 'support': 38708}, 'accuracy': 0.35970912676403527, 'macro avg': {'precision': 0.38336028764519714, 'recall': 0.36244270679099344, 'f1-score': 0.31579283362269917, 'support': 113589}, 'weighted avg': {'precision': 0.38363605954239544, 'recall': 0.35970912676403527, 'f1-score': 0.31419711778820325, 'support': 113589}}
[[ 9726 25026  2659]
 [ 7168 27001  3301]
 [ 7450 27126  4132]]
Evaluating performance on  val set...
144/144 - 1s - 890ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2625285
{'0': {'precision': 0.41885232872357336, 'recall': 0.20728445563247325, 'f1-score': 0.2773246329526917, 'support': 12712}, '1': {'precision': 0.32272055199605715, 'recall': 0.5818375688644037, 'f1-score': 0.4151661171696677, 'support': 11254}, '2': {'precision': 0.41158930523804793, 'recall': 0.32668034080151465, 'f1-score': 0.36425210010115666, 'support': 12676}, 'accuracy': 0.36362643960482505, 'macro avg': {'precision': 0.3843873953192261, 'recall': 0.3719341217661305, 'f1-score': 0.35224761674117205, 'support': 36642}, 'weighted avg': {'precision': 0.3868144186478682, 'recall': 0.36362643960482505, 'f1-score': 0.3497322700072135, 'support': 36642}}
[[2635 6914 3163]
 [1949 6548 2757]
 [1707 6828 4141]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2887394
{'0': {'precision': 0.36724678168296276, 'recall': 0.20669506740749397, 'f1-score': 0.2645149449040494, 'support': 94129}, '1': {'precision': 0.3490390028146361, 'recall': 0.4287351212525312, 'f1-score': 0.384803954163619, 'support': 101235}, '2': {'precision': 0.3782475913788426, 'recall': 0.44913290593406135, 'f1-score': 0.41065372082197243, 'support': 96241}, 'accuracy': 0.3637934877659848, 'macro avg': {'precision': 0.3648444586254805, 'recall': 0.36152103153136217, 'f1-score': 0.3533242066298803, 'support': 291605}, 'weighted avg': {'precision': 0.364556376622028, 'recall': 0.3637934877659848, 'f1-score': 0.3545065423921218, 'support': 291605}}
[[19456 42349 32324]
 [19104 43403 38728]
 [14418 38598 43225]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2998449
{'0': {'precision': 0.378600269179004, 'recall': 0.25074280960304257, 'f1-score': 0.3016837664891145, 'support': 33656}, '1': {'precision': 0.3236951337984633, 'recall': 0.565041778435544, 'f1-score': 0.41159823915191807, 'support': 32433}, '2': {'precision': 0.3612278364251307, 'recall': 0.2180327868852459, 'f1-score': 0.27193117814983414, 'support': 32330}, 'accuracy': 0.3435718712850161, 'macro avg': {'precision': 0.35450774646753264, 'recall': 0.34460579164127747, 'f1-score': 0.32840439459695553, 'support': 98419}, 'weighted avg': {'precision': 0.3548000984118778, 'recall': 0.3435718712850161, 'f1-score': 0.3281314535298665, 'support': 98419}}
[[ 8439 19345  5872]
 [ 7514 18326  6593]
 [ 6337 18944  7049]]
Evaluating performance on  val set...
139/139 - 1s - 859ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2950677
{'0': {'precision': 0.355268771331058, 'recall': 0.27422408825224337, 'f1-score': 0.30952934070529203, 'support': 12147}, '1': {'precision': 0.34010215522611187, 'recall': 0.44754098360655736, 'f1-score': 0.38649394775960927, 'support': 12200}, '2': {'precision': 0.34614223921134696, 'recall': 0.31213715529753266, 'f1-score': 0.32826138802766514, 'support': 11024}, 'accuracy': 0.3458200220519635, 'macro avg': {'precision': 0.34717105525617226, 'recall': 0.3446340757187778, 'f1-score': 0.3414282254975222, 'support': 35371}, 'weighted avg': {'precision': 0.34719312725630647, 'recall': 0.3458200220519635, 'f1-score': 0.34191378829638397, 'support': 35371}}
[[3331 5444 3372]
 [3612 5460 3128]
 [2433 5150 3441]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
2282/2282 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2259831
{'0': {'precision': 0.46453207042108513, 'recall': 0.2763676798326415, 'f1-score': 0.3465560636676238, 'support': 212239}, '1': {'precision': 0.2701227016979805, 'recall': 0.5466820865078508, 'f1-score': 0.361582704483797, 'support': 157373}, '2': {'precision': 0.45883789413201176, 'recall': 0.2979900458525163, 'f1-score': 0.3613215577481597, 'support': 214383}, 'accuracy': 0.3571486057243641, 'macro avg': {'precision': 0.39783088875035916, 'recall': 0.3736799373976695, 'f1-score': 0.35648677529986017, 'support': 583995}, 'weighted avg': {'precision': 0.41005297354621195, 'recall': 0.3571486057243641, 'f1-score': 0.3560257653990276, 'support': 583995}}
[[ 58656 115878  37705]
 [ 33699  86033  37641]
 [ 33914 116585  63884]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.234227
{'0': {'precision': 0.4174088351278302, 'recall': 0.2526178887950337, 'f1-score': 0.31474845682879365, 'support': 74583}, '1': {'precision': 0.3394357445812209, 'recall': 0.5081012589976546, 'f1-score': 0.40698572084109375, 'support': 74186}, '2': {'precision': 0.41035066223233563, 'recall': 0.3702845710374602, 'f1-score': 0.3892894208814779, 'support': 75974}, 'accuracy': 0.3767280849681636, 'macro avg': {'precision': 0.3890650806471289, 'recall': 0.3770012396100495, 'f1-score': 0.37034119951712174, 'support': 224743}, 'weighted avg': {'precision': 0.3892844916650613, 'recall': 0.3767280849681636, 'f1-score': 0.37039374442820777, 'support': 224743}}
[[18841 36895 18847]
 [14915 37694 21577]
 [11382 36460 28132]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.223358
{'0': {'precision': 0.415543658851763, 'recall': 0.26502099603626234, 'f1-score': 0.3236365379085594, 'support': 25481}, '1': {'precision': 0.36779093717816685, 'recall': 0.43555149020504613, 'f1-score': 0.39881347059849936, 'support': 26238}, '2': {'precision': 0.40310877379842897, 'recall': 0.47220056144728634, 'f1-score': 0.43492781728075847, 'support': 25648}, 'accuracy': 0.39153644318637143, 'macro avg': {'precision': 0.39548112327611956, 'recall': 0.3909243492295316, 'f1-score': 0.38579260859593906, 'support': 77367}, 'weighted avg': {'precision': 0.3952266523358101, 'recall': 0.39153644318637143, 'f1-score': 0.3860260721189696, 'support': 77367}}
[[ 6753  9880  8848]
 [ 5725 11428  9085]
 [ 3773  9764 12111]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
5098/5098 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9544701
{'0': {'precision': 0.49151265568501407, 'recall': 0.4619240305589468, 'f1-score': 0.4762592215308552, 'support': 317812}, '1': {'precision': 0.6352870239741495, 'recall': 0.4042333513068313, 'f1-score': 0.4940820956460809, 'support': 675068}, '2': {'precision': 0.3880125198331845, 'recall': 0.7171114408504283, 'f1-score': 0.5035601924574329, 'support': 312031}, 'accuracy': 0.49309952939319235, 'macro avg': {'precision': 0.5049373998307827, 'recall': 0.5277562742387355, 'f1-score': 0.49130050321145635, 'support': 1304911}, 'weighted avg': {'precision': 0.5411422659513294, 'recall': 0.49309952939319235, 'f1-score': 0.4920077294692572, 'support': 1304911}}
[[146805  93869  77138]
 [126397 272885 275786]
 [ 25478  62792 223761]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89513415
{'0': {'precision': 0.5126932034723692, 'recall': 0.42317875586546777, 'f1-score': 0.46365503276671716, 'support': 114441}, '1': {'precision': 0.6537480833905139, 'recall': 0.6195325388447135, 'f1-score': 0.636180591764267, 'support': 249133}, '2': {'precision': 0.4581799228882816, 'recall': 0.5878953640907805, 'f1-score': 0.5149951555845971, 'support': 116633}, 'accuracy': 0.5650542370269488, 'macro avg': {'precision': 0.5415404032503882, 'recall': 0.543535552933654, 'f1-score': 0.5382769267051938, 'support': 480207}, 'weighted avg': {'precision': 0.5726327252708504, 'recall': 0.5650542370269488, 'f1-score': 0.5656313942823852, 'support': 480207}}
[[ 48429  42830  23182]
 [ 36884 154346  57903]
 [  9147  38918  68568]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8662448
{'0': {'precision': 0.502868068833652, 'recall': 0.4975102233844271, 'f1-score': 0.5001747982827817, 'support': 35947}, '1': {'precision': 0.6403753700165852, 'recall': 0.7135288132024936, 'f1-score': 0.6749757973058944, 'support': 85499}, '2': {'precision': 0.5476726454142764, 'recall': 0.408492660997671, 'f1-score': 0.4679530930073835, 'support': 36926}, 'accuracy': 0.5933750915565883, 'macro avg': {'precision': 0.5636386947548379, 'recall': 0.5398438991948639, 'f1-score': 0.5477012295320199, 'support': 158372}, 'weighted avg': {'precision': 0.5875496447350471, 'recall': 0.5933750915565883, 'f1-score': 0.5870303783504562, 'support': 158372}}
[[17884 15291  2772]
 [14807 61006  9686]
 [ 2873 18969 15084]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
5760/5760 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90876126
{'0': {'precision': 0.6267303102625298, 'recall': 0.09750693892201487, 'f1-score': 0.16875838449942027, 'support': 323177}, '1': {'precision': 0.6124296499912469, 'recall': 0.7878745769818214, 'f1-score': 0.6891613152678981, 'support': 834775}, '2': {'precision': 0.41991863535793306, 'recall': 0.4647019610197176, 'f1-score': 0.4411767352435685, 'support': 316519}, 'accuracy': 0.5671844342818543, 'macro avg': {'precision': 0.5530261985372366, 'recall': 0.45002782564118465, 'f1-score': 0.43303214500362897, 'support': 1474471}, 'weighted avg': {'precision': 0.574238495769679, 'recall': 0.5671844342818543, 'f1-score': 0.5218646446370854, 'support': 1474471}}
[[ 31512 251725  39940]
 [ 13829 657698 163248]
 [  4939 164493 147087]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0195317
{'0': {'precision': 0.549952811109613, 'recall': 0.23463954952478955, 'f1-score': 0.3289368755880113, 'support': 156457}, '1': {'precision': 0.49190384456361613, 'recall': 0.6734297693920336, 'f1-score': 0.5685285117333583, 'support': 238500}, '2': {'precision': 0.43743132859932315, 'recall': 0.44212536964881777, 'f1-score': 0.439765823483928, 'support': 157582}, 'accuracy': 0.4832147595011393, 'macro avg': {'precision': 0.4930959947575175, 'recall': 0.450064896188547, 'f1-score': 0.4457437369350992, 'support': 552539}, 'weighted avg': {'precision': 0.49280564361888973, 'recall': 0.4832147595011393, 'f1-score': 0.4639630954349354, 'support': 552539}}
[[ 36711  87364  32382]
 [ 20667 160613  57220]
 [  9375  78536  69671]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98704624
{'0': {'precision': 0.5469141996989463, 'recall': 0.2618438888793562, 'f1-score': 0.3541383831703044, 'support': 58279}, '1': {'precision': 0.5564232902033271, 'recall': 0.5957882653313673, 'f1-score': 0.575433331262455, 'support': 101051}, '2': {'precision': 0.4218948093989636, 'recall': 0.5908127208480566, 'f1-score': 0.49226615347053665, 'support': 58015}, 'accuracy': 0.5049161471393406, 'macro avg': {'precision': 0.5084107664337457, 'recall': 0.48281495835292665, 'f1-score': 0.4739459559677653, 'support': 217345}, 'weighted avg': {'precision': 0.517964388000056, 'recall': 0.5049161471393406, 'f1-score': 0.4938957200937574, 'support': 217345}}
[[15260 27726 15293]
 [ 9172 60205 31674]
 [ 3470 20269 34276]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
6315/6315 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0088927
{'0': {'precision': 0.5310793170966301, 'recall': 0.27566977221058264, 'f1-score': 0.36294435608350406, 'support': 448660}, '1': {'precision': 0.549595570678128, 'recall': 0.510992060518772, 'f1-score': 0.5295912659208992, 'support': 720702}, '2': {'precision': 0.4097808749863345, 'recall': 0.6539500760490292, 'f1-score': 0.5038421305686768, 'support': 447080}, 'accuracy': 0.4852156773951679, 'macro avg': {'precision': 0.49681858758703096, 'recall': 0.4802039695927946, 'f1-score': 0.46545925085769335, 'support': 1616442}, 'weighted avg': {'precision': 0.5057858599172335, 'recall': 0.4852156773951679, 'f1-score': 0.47621494558220634, 'support': 1616442}}
[[123682 178634 146344]
 [ 77667 368273 274762]
 [ 31539 123173 292368]]
Evaluating performance on  train set...
2155/2155 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0203696
{'0': {'precision': 0.5545959509830195, 'recall': 0.27377795416689216, 'f1-score': 0.3665884304308092, 'support': 166299}, '1': {'precision': 0.46577121476315025, 'recall': 0.7197367313143788, 'f1-score': 0.5655510834206319, 'support': 213774}, '2': {'precision': 0.5063079123865115, 'recall': 0.4107646907877855, 'f1-score': 0.45355931985098796, 'support': 171468}, 'accuracy': 0.48921657682747066, 'macro avg': {'precision': 0.5088916927108937, 'recall': 0.4680931254230188, 'f1-score': 0.46189961123414297, 'support': 551541}, 'weighted avg': {'precision': 0.5051557959215964, 'recall': 0.48921657682747066, 'f1-score': 0.4707434554377363, 'support': 551541}}
[[ 45529  89570  31200]
 [ 22435 153861  37478]
 [ 14130  86905  70433]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0033586
{'0': {'precision': 0.5482734319943622, 'recall': 0.2918174827928959, 'f1-score': 0.38090109056192706, 'support': 53321}, '1': {'precision': 0.5253361999915687, 'recall': 0.596101411145659, 'f1-score': 0.5584860843454489, 'support': 83620}, '2': {'precision': 0.43524966661727665, 'recall': 0.5458718153606006, 'f1-score': 0.4843243777977461, 'support': 53813}, 'accuracy': 0.4968755570001153, 'macro avg': {'precision': 0.5029530995344026, 'recall': 0.4779302364330518, 'f1-score': 0.47457051756837404, 'support': 190754}, 'weighted avg': {'precision': 0.5063337650604541, 'recall': 0.4968755570001153, 'f1-score': 0.4879246629965771, 'support': 190754}}
[[15560 24450 13311]
 [ 8970 49846 24804]
 [ 3850 20588 29375]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
6082/6082 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0318874
{'0': {'precision': 0.4944011639685434, 'recall': 0.24596784353789802, 'f1-score': 0.32850318398264755, 'support': 436553}, '1': {'precision': 0.4775170841445473, 'recall': 0.806141922446256, 'f1-score': 0.5997644829923696, 'support': 684867}, '2': {'precision': 0.5142590785435077, 'recall': 0.21665702000992226, 'f1-score': 0.30487176213738926, 'support': 435384}, 'accuracy': 0.48420160790953776, 'macro avg': {'precision': 0.4953924422188661, 'recall': 0.42292226199802546, 'f1-score': 0.41104647637080216, 'support': 1556804}, 'weighted avg': {'precision': 0.49252711250316017, 'recall': 0.48420160790953776, 'f1-score': 0.44122718077364714, 'support': 1556804}}
[[107378 299434  29741]
 [ 73410 552100  59357]
 [ 36400 304655  94329]]
Evaluating performance on  train set...
2440/2440 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.146078
{'0': {'precision': 0.5074473230563169, 'recall': 0.19560945993106316, 'f1-score': 0.2823712087229564, 'support': 209177}, '1': {'precision': 0.37497463826151956, 'recall': 0.6801609630666273, 'f1-score': 0.4834319129493519, 'support': 206507}, '2': {'precision': 0.4525960300872625, 'recall': 0.3669549982527776, 'f1-score': 0.40530087739936604, 'support': 208903}, 'accuracy': 0.4131257935243609, 'macro avg': {'precision': 0.445005997135033, 'recall': 0.4142418070834894, 'f1-score': 0.3903679996905581, 'support': 624587}, 'weighted avg': {'precision': 0.4453020392543268, 'recall': 0.4131257935243609, 'f1-score': 0.3899636168633568, 'support': 624587}}
[[ 40917 121474  46786]
 [ 20119 140458  45930]
 [ 19597 112648  76658]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.086643
{'0': {'precision': 0.5078943154523619, 'recall': 0.24416116268686588, 'f1-score': 0.3297843581692279, 'support': 64953}, '1': {'precision': 0.4511843677514585, 'recall': 0.6135904697040303, 'f1-score': 0.5200018227202073, 'support': 83691}, '2': {'precision': 0.4025181860626233, 'recall': 0.42561391215721245, 'f1-score': 0.41374399145451307, 'support': 62794}, 'accuracy': 0.44427680927742413, 'macro avg': {'precision': 0.4538656230888145, 'recall': 0.4277885148493696, 'f1-score': 0.4211767241146494, 'support': 211438}, 'weighted avg': {'precision': 0.45415231589724137, 'recall': 0.44427680927742413, 'f1-score': 0.4300106705551387, 'support': 211438}}
[[15859 32350 16744]
 [ 9412 51352 22927]
 [ 5954 30114 26726]]
testing model on single stock: results/universal/W3/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
13689/13689 - 71s - 71s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.183312
{'0': {'precision': 0.3973584242473402, 'recall': 0.02570969985086572, 'f1-score': 0.04829466101889855, 'support': 1143265}, '1': {'precision': 0.34321820437529965, 'recall': 0.8356624894250959, 'f1-score': 0.48658796533457666, 'support': 1213959}, '2': {'precision': 0.4153907102788771, 'recall': 0.17185546571905333, 'f1-score': 0.24312517267237638, 'support': 1147022}, 'accuracy': 0.35413466976918856, 'macro avg': {'precision': 0.38532244630050566, 'recall': 0.34440921833167165, 'f1-score': 0.2593359330086172, 'support': 3504246}, 'weighted avg': {'precision': 0.3845052802651035, 'recall': 0.35413466976918856, 'f1-score': 0.2639030927761301, 'support': 3504246}}
[[  29393 1006512  107360]
 [  29435 1014460  170064]
 [  15143  934757  197122]]
Evaluating performance on  train set...
5475/5475 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2196823
{'0': {'precision': 0.37940964722822174, 'recall': 0.03846938315445507, 'f1-score': 0.06985588665864846, 'support': 465773}, '1': {'precision': 0.3315207658223957, 'recall': 0.8041851638922629, 'f1-score': 0.46949491839591784, 'support': 462682}, '2': {'precision': 0.3900711665538749, 'recall': 0.19127223843875962, 'f1-score': 0.25668059372970153, 'support': 473111}, 'accuracy': 0.3428258105576191, 'macro avg': {'precision': 0.3670005265348308, 'recall': 0.34464226182849256, 'f1-score': 0.26534379959475596, 'support': 1401566}, 'weighted avg': {'precision': 0.36719956125515213, 'recall': 0.3428258105576191, 'f1-score': 0.2648482098666574, 'support': 1401566}}
[[ 17918 378832  69023]
 [ 18125 372082  72475]
 [ 11183 371435  90493]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1714989
{'0': {'precision': 0.36416861826697894, 'recall': 0.018287448107160917, 'f1-score': 0.03482603778233166, 'support': 170062}, '1': {'precision': 0.3649268175810095, 'recall': 0.7539726240732397, 'f1-score': 0.4918133301406591, 'support': 179793}, '2': {'precision': 0.4001501342001459, 'recall': 0.32973663785808904, 'f1-score': 0.3615469273886002, 'support': 171361}, 'accuracy': 0.3744570389243615, 'macro avg': {'precision': 0.3764151900160448, 'recall': 0.3673322366794965, 'f1-score': 0.29606209843719694, 'support': 521216}, 'weighted avg': {'precision': 0.37625985775519677, 'recall': 0.3744570389243615, 'f1-score': 0.29987993984750333, 'support': 521216}}
[[  3110 122703  44249]
 [  3780 135559  40454]
 [  1650 113207  56504]]
training model: results/universal/W3/deepLOB_L1/h100
Epoch 1/50
10532/10532 - 157s - loss: 3.1939 - accuracy100: 0.4171 - val_loss: 3.4019 - val_accuracy100: 0.3874 - 157s/epoch - 15ms/step
Epoch 2/50
10532/10532 - 152s - loss: 3.1606 - accuracy100: 0.4335 - val_loss: 3.3377 - val_accuracy100: 0.3931 - 152s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 153s - loss: 3.1422 - accuracy100: 0.4391 - val_loss: 3.3711 - val_accuracy100: 0.3913 - 153s/epoch - 15ms/step
Epoch 4/50
10532/10532 - 155s - loss: 3.1316 - accuracy100: 0.4428 - val_loss: 3.4223 - val_accuracy100: 0.3834 - 155s/epoch - 15ms/step
Epoch 5/50
10532/10532 - 154s - loss: 3.1242 - accuracy100: 0.4452 - val_loss: 3.4781 - val_accuracy100: 0.3758 - 154s/epoch - 15ms/step
Epoch 6/50
10532/10532 - 156s - loss: 3.1187 - accuracy100: 0.4468 - val_loss: 3.4827 - val_accuracy100: 0.3707 - 156s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 154s - loss: 3.1145 - accuracy100: 0.4480 - val_loss: 3.4928 - val_accuracy100: 0.3659 - 154s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 154s - loss: 3.1109 - accuracy100: 0.4494 - val_loss: 3.5638 - val_accuracy100: 0.3662 - 154s/epoch - 15ms/step
Epoch 9/50
10532/10532 - 155s - loss: 3.1077 - accuracy100: 0.4505 - val_loss: 3.5718 - val_accuracy100: 0.3648 - 155s/epoch - 15ms/step
Epoch 10/50
10532/10532 - 156s - loss: 3.1058 - accuracy100: 0.4513 - val_loss: 3.6398 - val_accuracy100: 0.3603 - 156s/epoch - 15ms/step
Epoch 11/50
10532/10532 - 153s - loss: 3.1037 - accuracy100: 0.4520 - val_loss: 3.6881 - val_accuracy100: 0.3611 - 153s/epoch - 15ms/step
Epoch 12/50
10532/10532 - 159s - loss: 3.1017 - accuracy100: 0.4527 - val_loss: 3.5934 - val_accuracy100: 0.3604 - 159s/epoch - 15ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 150s - 150s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1550819
{'0': {'precision': 0.4752257071411919, 'recall': 0.06336365695754295, 'f1-score': 0.11181817054664332, 'support': 2348444}, '1': {'precision': 0.3563264953946375, 'recall': 0.3423181732464911, 'f1-score': 0.34918189591302023, 'support': 2412805}, '2': {'precision': 0.3574974188625039, 'recall': 0.685005513437822, 'f1-score': 0.4698072213960123, 'support': 2325228}, 'accuracy': 0.3623164232382325, 'macro avg': {'precision': 0.3963498737994444, 'recall': 0.3635624478806187, 'f1-score': 0.31026909595189195, 'support': 7086477}, 'weighted avg': {'precision': 0.3961136568380833, 'recall': 0.3623164232382325, 'f1-score': 0.3100998481857576, 'support': 7086477}}
[[ 148806  815366 1384272]
 [ 108524  825947 1478334]
 [  55797  676637 1592794]]
Evaluating performance on  train set...
10532/10532 - 57s - 57s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1370956
{'0': {'precision': 0.4182189743534875, 'recall': 0.13146026226133983, 'f1-score': 0.20004094165813718, 'support': 892011}, '1': {'precision': 0.3694453932500152, 'recall': 0.5233826063900305, 'f1-score': 0.43314343393338617, 'support': 905160}, '2': {'precision': 0.37394857493347927, 'recall': 0.4715174202709214, 'f1-score': 0.4171031558140748, 'support': 898637}, 'accuracy': 0.376411079720811, 'macro avg': {'precision': 0.387204314178994, 'recall': 0.3754534296407639, 'f1-score': 0.35009584380186604, 'support': 2695808}, 'weighted avg': {'precision': 0.38708511259656087, 'recall': 0.376411079720811, 'f1-score': 0.3506656110894594, 'support': 2695808}}
[[117264 405400 369347]
 [ 91380 473745 340035]
 [ 71745 403169 423723]]
Evaluating performance on  val set...
3814/3814 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115333
{'0': {'precision': 0.4433115765823415, 'recall': 0.09983987189751801, 'f1-score': 0.1629754321397485, 'support': 312250}, '1': {'precision': 0.40330560312259134, 'recall': 0.6064961130096411, 'f1-score': 0.48445804110087304, 'support': 350271}, '2': {'precision': 0.3717427462576234, 'recall': 0.4494053888431414, 'f1-score': 0.4069014743875021, 'support': 313314}, 'accuracy': 0.39393749967976144, 'macro avg': {'precision': 0.40611997532085214, 'recall': 0.38524712458343346, 'f1-score': 0.3514449825427079, 'support': 975835}, 'weighted avg': {'precision': 0.4059728371088866, 'recall': 0.39393749967976144, 'f1-score': 0.3566879746538361, 'support': 975835}}
[[ 31175 156013 125062]
 [ 24930 212438 112903]
 [ 14218 158291 140805]]
testing model out of sample: results/universal/W3/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 81s - 81s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1402647
{'0': {'precision': 0.39980017815441654, 'recall': 0.17854943130764683, 'f1-score': 0.24685447445036918, 'support': 1302110}, '1': {'precision': 0.36468243704847864, 'recall': 0.45244919561860153, 'f1-score': 0.4038523750702494, 'support': 1564432}, '2': {'precision': 0.31264362546135177, 'recall': 0.3973546385956292, 'f1-score': 0.3499456297105892, 'support': 1269921}, 'accuracy': 0.34931437800845794, 'macro avg': {'precision': 0.35904208022141565, 'recall': 0.3427844218406259, 'f1-score': 0.33355082641040257, 'support': 4136463}, 'weighted avg': {'precision': 0.35976083669134185, 'recall': 0.34931437800845794, 'f1-score': 0.33788155788899155, 'support': 4136463}}
[[232491 621153 448466]
 [195674 707826 660932]
 [153353 611959 504609]]
Evaluating performance on  train set...
6181/6181 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1584885
{'0': {'precision': 0.3998497592453481, 'recall': 0.12306788462267369, 'f1-score': 0.18820808444409667, 'support': 527660}, '1': {'precision': 0.34319888217015504, 'recall': 0.5433787073101244, 'f1-score': 0.4206895530784148, 'support': 522987}, '2': {'precision': 0.3714614744617383, 'recall': 0.41356892721316413, 'f1-score': 0.39138592127488225, 'support': 531140}, 'accuracy': 0.35958128370001774, 'macro avg': {'precision': 0.3715033719590804, 'recall': 0.36000517304865404, 'f1-score': 0.3334278529324646, 'support': 1581787}, 'weighted avg': {'precision': 0.37158689842471265, 'recall': 0.35958128370001774, 'f1-score': 0.33329757000122895, 'support': 1581787}}
[[ 64938 277386 185336]
 [ 52458 284180 186349]
 [ 45010 266467 219663]]
Evaluating performance on  val set...
2209/2209 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1347278
{'0': {'precision': 0.42598867986738226, 'recall': 0.12435432641406526, 'f1-score': 0.19251097857264068, 'support': 187014}, '1': {'precision': 0.36613443402589096, 'recall': 0.4855016915544926, 'f1-score': 0.4174526695536207, 'support': 195678}, '2': {'precision': 0.3602409638554217, 'recall': 0.4960501884263379, 'f1-score': 0.4173757898191332, 'support': 182034}, 'accuracy': 0.3693047601845851, 'macro avg': {'precision': 0.384121359249565, 'recall': 0.3686354021316319, 'f1-score': 0.34244647931513156, 'support': 564726}, 'weighted avg': {'precision': 0.3840559924148964, 'recall': 0.3693047601845851, 'f1-score': 0.3429364614762439, 'support': 564726}}
[[23256 85812 77946]
 [18260 95002 82416]
 [13077 78659 90298]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2071308
{'0': {'precision': 0.4616771011193322, 'recall': 0.07399917896945463, 'f1-score': 0.12755362782225832, 'support': 65771}, '1': {'precision': 0.25331093423799583, 'recall': 0.3485804062394793, 'f1-score': 0.29340587718552524, 'support': 44555}, '2': {'precision': 0.3790699048632039, 'recall': 0.6103130054228904, 'f1-score': 0.46766785740322225, 'support': 63066}, 'accuracy': 0.3396235120420781, 'macro avg': {'precision': 0.36468598007351066, 'recall': 0.3442975302106081, 'f1-score': 0.2962091208036686, 'support': 173392}, 'weighted avg': {'precision': 0.37808927697238814, 'recall': 0.3396235120420781, 'f1-score': 0.29387728158444704, 'support': 173392}}
[[ 4867 24367 36537]
 [ 2513 15531 26511]
 [ 3162 21414 38490]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1857059
{'0': {'precision': 0.3358476093070826, 'recall': 0.11973564266180492, 'f1-score': 0.1765338350917277, 'support': 21940}, '1': {'precision': 0.3343446816016934, 'recall': 0.432423799963497, 'f1-score': 0.37711147808439943, 'support': 21916}, '2': {'precision': 0.3433127776672634, 'recall': 0.46077515240510836, 'f1-score': 0.39346442481238714, 'support': 22473}, 'accuracy': 0.33860000904581705, 'macro avg': {'precision': 0.3378350228586798, 'recall': 0.33764486501013674, 'f1-score': 0.31570324599617144, 'support': 66329}, 'weighted avg': {'precision': 0.3378803033770525, 'recall': 0.33860000904581705, 'f1-score': 0.31630589205956644, 'support': 66329}}
[[ 2627  9207 10106]
 [ 2738  9477  9701]
 [ 2457  9661 10355]]
Evaluating performance on  val set...
86/86 - 1s - 686ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2003202
{'0': {'precision': 0.34498834498834496, 'recall': 0.09971701926964022, 'f1-score': 0.15471461425883337, 'support': 7421}, '1': {'precision': 0.3624215428224337, 'recall': 0.4773969862648353, 'f1-score': 0.4120389019968924, 'support': 7499}, '2': {'precision': 0.3199475330440924, 'recall': 0.45209580838323354, 'f1-score': 0.37471196454948297, 'support': 7014}, 'accuracy': 0.3415245737211635, 'macro avg': {'precision': 0.34245247361829034, 'recall': 0.3430699379725697, 'f1-score': 0.3138218269350696, 'support': 21934}, 'weighted avg': {'precision': 0.34294108026603454, 'recall': 0.3415245737211635, 'f1-score': 0.313041241809044, 'support': 21934}}
[[ 740 3023 3658]
 [ 837 3580 3082]
 [ 568 3275 3171]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0778385
{'0': {'precision': 0.5349210596735349, 'recall': 0.1287075589131648, 'f1-score': 0.20749070149641033, 'support': 93188}, '1': {'precision': 0.519472696197921, 'recall': 0.399833946151109, 'f1-score': 0.45186841576134973, 'support': 185482}, '2': {'precision': 0.2821737788296168, 'recall': 0.63560809244727, 'f1-score': 0.3908378295836303, 'support': 90603}, 'accuracy': 0.3892621448088541, 'macro avg': {'precision': 0.4455225115670242, 'recall': 0.3880498658371813, 'f1-score': 0.3500656489471301, 'support': 369273}, 'weighted avg': {'precision': 0.4651486819462564, 'recall': 0.3892621448088541, 'f1-score': 0.3752242402153957, 'support': 369273}}
[[ 11994  37915  43279]
 [  8100  74162 103220]
 [  2328  30687  57588]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023579
{'0': {'precision': 0.462317638111042, 'recall': 0.24173897324656543, 'f1-score': 0.31747501365049974, 'support': 55320}, '1': {'precision': 0.37251058576363694, 'recall': 0.6361282686688612, 'f1-score': 0.4698698903800841, 'support': 54074}, '2': {'precision': 0.410484021678191, 'recall': 0.3213547667379894, 'f1-score': 0.36049195293828024, 'support': 54681}, 'accuracy': 0.39825079993905227, 'macro avg': {'precision': 0.4151040818509566, 'recall': 0.3997406695511387, 'f1-score': 0.38261228565628796, 'support': 164075}, 'weighted avg': {'precision': 0.415445533714892, 'recall': 0.39825079993905227, 'f1-score': 0.38203579269344146, 'support': 164075}}
[[13373 29183 12764]
 [ 7204 34398 12472]
 [ 8349 28760 17572]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1288135
{'0': {'precision': 0.4366782935336732, 'recall': 0.15047847995931765, 'f1-score': 0.22382671480144403, 'support': 21631}, '1': {'precision': 0.3731956032313601, 'recall': 0.655196465938154, 'f1-score': 0.4755315558555518, 'support': 25806}, '2': {'precision': 0.36948508236378297, 'recall': 0.28278598192638305, 'f1-score': 0.3203735610657477, 'support': 22685}, 'accuracy': 0.3790251276346938, 'macro avg': {'precision': 0.39311965970960544, 'recall': 0.3628203092746182, 'f1-score': 0.3399106105742478, 'support': 70122}, 'weighted avg': {'precision': 0.39157814948001735, 'recall': 0.3790251276346938, 'f1-score': 0.3476916977703844, 'support': 70122}}
[[ 3255 13832  4544]
 [ 2495 16908  6403]
 [ 1704 14566  6415]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
1359/1359 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1353675
{'0': {'precision': 0.3468790711494069, 'recall': 0.14561765411369634, 'f1-score': 0.20512508616145644, 'support': 104225}, '1': {'precision': 0.4138488558068185, 'recall': 0.6625803255583542, 'f1-score': 0.5094772872371817, 'support': 143323}, '2': {'precision': 0.33329757994234765, 'recall': 0.24796265448415508, 'f1-score': 0.2843660989029845, 'support': 100253}, 'accuracy': 0.3881501203274286, 'macro avg': {'precision': 0.36467516896619107, 'recall': 0.3520535447187352, 'f1-score': 0.3329894907672075, 'support': 347801}, 'weighted avg': {'precision': 0.3705613642091534, 'recall': 0.3881501203274286, 'f1-score': 0.3533846362063171, 'support': 347801}}
[[15177 70653 18395]
 [17029 94963 31331]
 [11547 63847 24859]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1835276
{'0': {'precision': 0.35927158801644804, 'recall': 0.24715771323885985, 'f1-score': 0.2928511005059614, 'support': 37118}, '1': {'precision': 0.3438759487045276, 'recall': 0.694586879526352, 'f1-score': 0.4600101528174068, 'support': 37834}, '2': {'precision': 0.3800928313563693, 'recall': 0.11444987964904108, 'f1-score': 0.17592647848660262, 'support': 38637}, 'accuracy': 0.3510463161045524, 'macro avg': {'precision': 0.3610801226924483, 'recall': 0.3520648241380843, 'f1-score': 0.30959591060332364, 'support': 113589}, 'weighted avg': {'precision': 0.3612259300847587, 'recall': 0.3510463161045524, 'f1-score': 0.30875650476332134, 'support': 113589}}
[[ 9174 24419  3525]
 [ 7868 26279  3687]
 [ 8493 25722  4422]]
Evaluating performance on  val set...
144/144 - 1s - 890ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1776347
{'0': {'precision': 0.3752803947958726, 'recall': 0.13506095099701299, 'f1-score': 0.19863460967646185, 'support': 12387}, '1': {'precision': 0.33313506588579794, 'recall': 0.6115917681646367, 'f1-score': 0.4313260863126092, 'support': 11905}, '2': {'precision': 0.3694810224632068, 'recall': 0.30898785425101216, 'f1-score': 0.33653761354616807, 'support': 12350}, 'accuracy': 0.3485071775558103, 'macro avg': {'precision': 0.35929882771495913, 'recall': 0.3518801911375539, 'f1-score': 0.32216610317841304, 'support': 36642}, 'weighted avg': {'precision': 0.3596327121098058, 'recall': 0.3485071775558103, 'f1-score': 0.32071566767395665, 'support': 36642}}
[[1673 7397 3317]
 [1429 7281 3195]
 [1356 7178 3816]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1923299
{'0': {'precision': 0.3533435673695834, 'recall': 0.14048312489292444, 'f1-score': 0.20103736506209632, 'support': 93392}, '1': {'precision': 0.3527874314271764, 'recall': 0.600301054668791, 'f1-score': 0.4444050479029784, 'support': 102307}, '2': {'precision': 0.36732637549913544, 'recall': 0.3078952307467729, 'f1-score': 0.334995320343742, 'support': 95906}, 'accuracy': 0.35686630887673393, 'macro avg': {'precision': 0.3578191247652984, 'recall': 0.34955980343616283, 'f1-score': 0.3268125777696056, 'support': 291605}, 'weighted avg': {'precision': 0.3577472593385585, 'recall': 0.35686630887673393, 'f1-score': 0.3304781811922849, 'support': 291605}}
[[13120 57258 23014]
 [13046 61415 27846]
 [10965 55412 29529]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1924219
{'0': {'precision': 0.34982664685487863, 'recall': 0.21223594458968117, 'f1-score': 0.26419046550337577, 'support': 33279}, '1': {'precision': 0.328457290565151, 'recall': 0.6867284898360253, 'f1-score': 0.4443737953782264, 'support': 32566}, '2': {'precision': 0.3777733951286855, 'recall': 0.11760913612083257, 'f1-score': 0.1793749268406883, 'support': 32574}, 'accuracy': 0.33792255560410084, 'macro avg': {'precision': 0.35201911084957166, 'recall': 0.33885785684884634, 'f1-score': 0.2959797292407635, 'support': 98419}, 'weighted avg': {'precision': 0.3520053209050083, 'recall': 0.33792255560410084, 'f1-score': 0.2957399525364283, 'support': 98419}}
[[ 7063 22996  3220]
 [ 7112 22364  3090]
 [ 6015 22728  3831]]
Evaluating performance on  val set...
139/139 - 1s - 871ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1877903
{'0': {'precision': 0.30106183635227984, 'recall': 0.12311621966794381, 'f1-score': 0.17476432197244382, 'support': 11745}, '1': {'precision': 0.35704070931452, 'recall': 0.586530931871574, 'f1-score': 0.4438781557425625, 'support': 12770}, '2': {'precision': 0.3291970802919708, 'recall': 0.2908069270449521, 'f1-score': 0.30881345984544656, 'support': 10856}, 'accuracy': 0.34189024907410026, 'macro avg': {'precision': 0.32909987531959023, 'recall': 0.33348469286149, 'f1-score': 0.30915197918681764, 'support': 35371}, 'weighted avg': {'precision': 0.3299071168345137, 'recall': 0.34189024907410026, 'f1-score': 0.3130646555223501, 'support': 35371}}
[[1446 7039 3260]
 [2107 7490 3173]
 [1250 6449 3157]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1708163
{'0': {'precision': 0.38629909783127686, 'recall': 0.15460278188456084, 'f1-score': 0.22082716811998104, 'support': 198858}, '1': {'precision': 0.3178117484310254, 'recall': 0.5321100917431193, 'f1-score': 0.39794444764479553, 'support': 188243}, '2': {'precision': 0.3580521573704653, 'recall': 0.34412424959622945, 'f1-score': 0.3509500710902315, 'support': 196894}, 'accuracy': 0.34018441938715227, 'macro avg': {'precision': 0.3540543345442559, 'recall': 0.34361237440796993, 'f1-score': 0.3232405622850027, 'support': 583995}, 'weighted avg': {'precision': 0.35469965398630804, 'recall': 0.34018441938715227, 'f1-score': 0.3217895169534713, 'support': 583995}}
[[ 30744 109944  58170]
 [ 24768 100166  63309]
 [ 24074 105064  67756]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1805133
{'0': {'precision': 0.36931838925194405, 'recall': 0.13539993575329265, 'f1-score': 0.1981528456558573, 'support': 74712}, '1': {'precision': 0.33284976043537245, 'recall': 0.5688592259032915, 'f1-score': 0.4199684375602927, 'support': 74616}, '2': {'precision': 0.3599077747067837, 'recall': 0.33324935357687463, 'f1-score': 0.3460659304343036, 'support': 75415}, 'accuracy': 0.3457015346417908, 'macro avg': {'precision': 0.3540253081313667, 'recall': 0.3458361717444863, 'f1-score': 0.3213957378834846, 'support': 224743}, 'weighted avg': {'precision': 0.3540527538208046, 'recall': 0.3457015346417908, 'f1-score': 0.32143080089409776, 'support': 224743}}
[[10116 42948 21648]
 [ 9121 42446 23049]
 [ 8154 42129 25132]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1463472
{'0': {'precision': 0.37148945886292717, 'recall': 0.1942300039793076, 'f1-score': 0.25508897541090697, 'support': 25130}, '1': {'precision': 0.35803085657213446, 'recall': 0.507167057597081, 'f1-score': 0.4197454780759868, 'support': 26859}, '2': {'precision': 0.35193460906764445, 'recall': 0.3630703759161478, 'f1-score': 0.35741577610116565, 'support': 25378}, 'accuracy': 0.35825351894218466, 'macro avg': {'precision': 0.36048497483423536, 'recall': 0.3548224791641788, 'f1-score': 0.34408340986268643, 'support': 77367}, 'weighted avg': {'precision': 0.36040272192039247, 'recall': 0.35825351894218466, 'f1-score': 0.345817044910807, 'support': 77367}}
[[ 4881 11908  8341]
 [ 4611 13622  8626]
 [ 3647 12517  9214]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
5098/5098 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0864885
{'0': {'precision': 0.5059888208677136, 'recall': 0.17819005112157418, 'f1-score': 0.263563163227217, 'support': 416067}, '1': {'precision': 0.3771154097898436, 'recall': 0.3870429661905047, 'f1-score': 0.3820147011120699, 'support': 483799}, '2': {'precision': 0.3646685895508519, 'recall': 0.5958770013208409, 'f1-score': 0.4524462507193752, 'support': 405045}, 'accuracy': 0.3852730186196607, 'macro avg': {'precision': 0.415924273402803, 'recall': 0.38703667287763993, 'f1-score': 0.36600803835288737, 'support': 1304911}, 'weighted avg': {'precision': 0.4143428155081139, 'recall': 0.3852730186196607, 'f1-score': 0.3661087665292163, 'support': 1304911}}
[[ 74139 169384 172544]
 [ 48596 187251 247952]
 [ 23788 139900 241357]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0729355
{'0': {'precision': 0.48468907763452546, 'recall': 0.2424312717054161, 'f1-score': 0.3232031384607229, 'support': 150884}, '1': {'precision': 0.4024542909578541, 'recall': 0.5594798260830386, 'f1-score': 0.46815068251062114, 'support': 177556}, '2': {'precision': 0.40224185427947184, 'recall': 0.4185099527565281, 'f1-score': 0.4102146787568782, 'support': 151767}, 'accuracy': 0.4153083982532533, 'macro avg': {'precision': 0.42979507429061714, 'recall': 0.4068070168483276, 'f1-score': 0.4005228332427408, 'support': 480207}, 'weighted avg': {'precision': 0.42822582838974244, 'recall': 0.4153083982532533, 'f1-score': 0.4042968887964121, 'support': 480207}}
[[36579 72825 41480]
 [25308 99339 52909]
 [13582 74669 63516]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0608166
{'0': {'precision': 0.4579062094968776, 'recall': 0.32271793061927795, 'f1-score': 0.3786061351486294, 'support': 48169}, '1': {'precision': 0.4076623451014836, 'recall': 0.700337860001312, 'f1-score': 0.5153453457077686, 'support': 60972}, '2': {'precision': 0.49588372802114034, 'recall': 0.19820844589790984, 'f1-score': 0.28321409394999203, 'support': 49231}, 'accuracy': 0.429394084812972, 'macro avg': {'precision': 0.45381742753983384, 'recall': 0.40708807883949993, 'f1-score': 0.39238852493546333, 'support': 158372}, 'weighted avg': {'precision': 0.4503682754842492, 'recall': 0.429394084812972, 'f1-score': 0.4015964210953985, 'support': 158372}}
[[15545 28986  3638]
 [11989 42701  6282]
 [ 6414 33059  9758]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
5760/5760 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1409107
{'0': {'precision': 0.5516381982858185, 'recall': 0.021244966757187, 'f1-score': 0.0409142243993048, 'support': 427160}, '1': {'precision': 0.4102500819466672, 'recall': 0.16664708582205867, 'f1-score': 0.23701617700463634, 'support': 638379}, '2': {'precision': 0.2913936289579171, 'recall': 0.8541640174894604, 'f1-score': 0.43454461423816443, 'support': 408932}, 'accuracy': 0.31520050241747716, 'macro avg': {'precision': 0.41776063639680094, 'recall': 0.34735202335623533, 'f1-score': 0.23749167188070186, 'support': 1474471}, 'weighted avg': {'precision': 0.4182469436969738, 'recall': 0.31520050241747716, 'f1-score': 0.2349875096519978, 'support': 1474471}}
[[  9075  94795 323290]
 [  5875 106384 526120]
 [  1501  58136 349295]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1320721
{'0': {'precision': 0.46225947642249565, 'recall': 0.12114227589490542, 'f1-score': 0.19197462059504414, 'support': 184824}, '1': {'precision': 0.34474549815222, 'recall': 0.5296504147389746, 'f1-score': 0.41764741436626285, 'support': 182645}, '2': {'precision': 0.37927748147617857, 'recall': 0.45802669260279893, 'f1-score': 0.4149488699500203, 'support': 185070}, 'accuracy': 0.36901467588713194, 'macro avg': {'precision': 0.3954274853502981, 'recall': 0.36960646107889294, 'f1-score': 0.3415236349704424, 'support': 552539}, 'weighted avg': {'precision': 0.39562016523199256, 'recall': 0.36901467588713194, 'f1-score': 0.3412561224373932, 'support': 552539}}
[[22390 94733 67701]
 [14879 96738 71028]
 [11167 89136 84767]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.106871
{'0': {'precision': 0.5173433188805676, 'recall': 0.11231548170862155, 'f1-score': 0.18456238208514475, 'support': 70115}, '1': {'precision': 0.387174902102809, 'recall': 0.4425900769778123, 'f1-score': 0.4130320609949715, 'support': 77295}, '2': {'precision': 0.3710543664571705, 'recall': 0.6036033459641096, 'f1-score': 0.4595862819814916, 'support': 69935}, 'accuracy': 0.3878534127769215, 'macro avg': {'precision': 0.4251908624801824, 'recall': 0.3861696348835144, 'f1-score': 0.352393575020536, 'support': 217345}, 'weighted avg': {'precision': 0.4239798384114189, 'recall': 0.3878534127769215, 'f1-score': 0.3543079951454225, 'support': 217345}}
[[ 7875 29150 33090]
 [ 4623 34210 38462]
 [ 2724 24998 42213]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
6315/6315 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.124939
{'0': {'precision': 0.4819963511411079, 'recall': 0.08240161194338298, 'f1-score': 0.1407420964731952, 'support': 522599}, '1': {'precision': 0.37727217920940037, 'recall': 0.35341733851990914, 'f1-score': 0.3649553640461213, 'support': 584329}, '2': {'precision': 0.3485577978130419, 'recall': 0.6702229968165743, 'f1-score': 0.45860984628979656, 'support': 509514}, 'accuracy': 0.36565679436688725, 'macro avg': {'precision': 0.4026087760545167, 'recall': 0.3686806490932888, 'f1-score': 0.321435768936371, 'support': 1616442}, 'weighted avg': {'precision': 0.4020787409075957, 'recall': 0.36565679436688725, 'f1-score': 0.3219873147412656, 'support': 1616442}}
[[ 43063 186648 292888]
 [ 32476 206512 345341]
 [ 13804 154222 341488]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.120694
{'0': {'precision': 0.45460276524106313, 'recall': 0.17340525533403287, 'f1-score': 0.2510493687962622, 'support': 182976}, '1': {'precision': 0.35920913074266136, 'recall': 0.638374457328131, 'f1-score': 0.45973076671923635, 'support': 181970}, '2': {'precision': 0.4175807521076063, 'recall': 0.35438248613306894, 'f1-score': 0.3833946948833164, 'support': 186595}, 'accuracy': 0.38804005504577177, 'macro avg': {'precision': 0.41046421603044364, 'recall': 0.3887207329317443, 'f1-score': 0.36472494346627166, 'support': 551541}, 'weighted avg': {'precision': 0.4106044002776034, 'recall': 0.38804005504577177, 'f1-score': 0.3646741584334015, 'support': 551541}}
[[ 31729 103653  47594]
 [ 21170 116165  44635]
 [ 16896 103573  66126]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1031971
{'0': {'precision': 0.47291504286827746, 'recall': 0.15692994083605444, 'f1-score': 0.2356596674353684, 'support': 61862}, '1': {'precision': 0.3820314582777926, 'recall': 0.49373820295413007, 'f1-score': 0.43076058473341305, 'support': 66754}, '2': {'precision': 0.38034376377258705, 'recall': 0.5138723486433422, 'f1-score': 0.43713849586901316, 'support': 62138}, 'accuracy': 0.3910691256801954, 'macro avg': {'precision': 0.41176342163955243, 'recall': 0.38818016414450884, 'f1-score': 0.36785291601259823, 'support': 190754}, 'weighted avg': {'precision': 0.4109554669422091, 'recall': 0.3910691256801954, 'f1-score': 0.3695664692561611, 'support': 190754}}
[[ 9708 26925 25229]
 [ 7002 32959 26793]
 [ 3818 26389 31931]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
6082/6082 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1216537
{'0': {'precision': 0.40229352457680395, 'recall': 0.3413838481236761, 'f1-score': 0.3693443327354778, 'support': 506096}, '1': {'precision': 0.36331098480454704, 'recall': 0.7119298385982267, 'f1-score': 0.4811051164413904, 'support': 549932}, '2': {'precision': 0.48798004385523747, 'recall': 0.048438822946786586, 'f1-score': 0.08812955848024925, 'support': 500776}, 'accuracy': 0.3780456627809281, 'macro avg': {'precision': 0.41786151774552954, 'recall': 0.36725083655622975, 'f1-score': 0.3128596692190391, 'support': 1556804}, 'weighted avg': {'precision': 0.4160858878519112, 'recall': 0.3780456627809281, 'f1-score': 0.31836503252332754, 'support': 1556804}}
[[172773 321511  11812]
 [144779 391513  13640]
 [111918 364601  24257]]
Evaluating performance on  train set...
2440/2440 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1665392
{'0': {'precision': 0.3855059872322744, 'recall': 0.09762945672658395, 'f1-score': 0.15580202433476328, 'support': 209066}, '1': {'precision': 0.3464710227867205, 'recall': 0.530537538353983, 'f1-score': 0.41918834475496713, 'support': 205976}, '2': {'precision': 0.3701948969317588, 'recall': 0.4526855806628648, 'f1-score': 0.40730554786241663, 'support': 209545}, 'accuracy': 0.35951276603579646, 'macro avg': {'precision': 0.3673906356502512, 'recall': 0.36028419191447725, 'f1-score': 0.32743197231738236, 'support': 624587}, 'weighted avg': {'precision': 0.36749628121268235, 'recall': 0.35951276603579646, 'f1-score': 0.3270392844321941, 'support': 624587}}
[[ 20411 106110  82545]
 [ 17863 109278  78835]
 [ 14672 100015  94858]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1445681
{'0': {'precision': 0.41649663334013465, 'recall': 0.11346423757312989, 'f1-score': 0.1783432534265276, 'support': 71961}, '1': {'precision': 0.3589157701699503, 'recall': 0.5074736550194121, 'f1-score': 0.4204582660792344, 'support': 72120}, '2': {'precision': 0.3513570657556503, 'recall': 0.46875603129593063, 'f1-score': 0.4016537336216767, 'support': 67357}, 'accuracy': 0.3610420075861482, 'macro avg': {'precision': 0.37558982308857836, 'recall': 0.3632313079628242, 'f1-score': 0.33348508437581287, 'support': 211438}, 'weighted avg': {'precision': 0.3761049454428701, 'recall': 0.3610420075861482, 'f1-score': 0.33206613543930624, 'support': 211438}}
[[ 8165 34296 29500]
 [ 6732 36599 28789]
 [ 4707 31076 31574]]
testing model on single stock: results/universal/W3/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
13689/13689 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1996076
{'0': {'precision': 0.38403428877578355, 'recall': 0.005860048822839802, 'f1-score': 0.011543946473966935, 'support': 1223198}, '1': {'precision': 0.30929408392834357, 'recall': 0.27977136650241086, 'f1-score': 0.29379291706369043, 'support': 1056888}, '2': {'precision': 0.364922566043703, 'recall': 0.7540672787870867, 'f1-score': 0.49182960438070344, 'support': 1224160}, 'accuracy': 0.34984815563747523, 'macro avg': {'precision': 0.35275031291594333, 'recall': 0.34656623137077913, 'f1-score': 0.2657221559727869, 'support': 3504246}, 'weighted avg': {'precision': 0.35481606833107027, 'recall': 0.34984815563747523, 'f1-score': 0.26445200173371247, 'support': 3504246}}
[[  7168 363955 852075]
 [  6800 295687 754401]
 [  4697 296364 923099]]
Evaluating performance on  train set...
5475/5475 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1656462
{'0': {'precision': 0.3326466240674139, 'recall': 0.06086652809486489, 'f1-score': 0.10290403244825544, 'support': 469552}, '1': {'precision': 0.3658112609847095, 'recall': 0.438770441443679, 'f1-score': 0.3989828950444364, 'support': 458994}, '2': {'precision': 0.35745793747573884, 'recall': 0.5781890829140417, 'f1-score': 0.44178685454124, 'support': 473020}, 'accuracy': 0.35921818879738804, 'macro avg': {'precision': 0.3519719408426208, 'recall': 0.35927535081752854, 'f1-score': 0.31455792734464394, 'support': 1401566}, 'weighted avg': {'precision': 0.35188126362461136, 'recall': 0.35921818879738804, 'f1-score': 0.31423676595127636, 'support': 1401566}}
[[ 28580 176407 264565]
 [ 30550 201393 227051]
 [ 26787 172738 273495]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1225992
{'0': {'precision': 0.3805104408352668, 'recall': 0.007770532388076497, 'f1-score': 0.015230046839358993, 'support': 168843}, '1': {'precision': 0.41656541709882944, 'recall': 0.6112768999124852, 'f1-score': 0.4954783677623593, 'support': 183969}, '2': {'precision': 0.3613361957644628, 'recall': 0.531709460582884, 'f1-score': 0.4302711118372368, 'support': 168404}, 'accuracy': 0.39006860879174854, 'macro avg': {'precision': 0.386137351232853, 'recall': 0.38358563096114856, 'f1-score': 0.31365984214631837, 'support': 521216}, 'weighted avg': {'precision': 0.3870412809501667, 'recall': 0.39006860879174854, 'f1-score': 0.3188381073397774, 'support': 521216}}
[[  1312  79575  87956]
 [  1203 112456  70310]
 [   933  77929  89542]]
training model: results/universal/W3/deepLOB_L1/h200
Epoch 1/50
10532/10532 - 158s - loss: 3.2445 - accuracy200: 0.3955 - val_loss: 3.3356 - val_accuracy200: 0.3419 - 158s/epoch - 15ms/step
Epoch 2/50
10532/10532 - 154s - loss: 3.2290 - accuracy200: 0.4052 - val_loss: 3.3514 - val_accuracy200: 0.3400 - 154s/epoch - 15ms/step
Epoch 3/50
10532/10532 - 155s - loss: 3.2220 - accuracy200: 0.4093 - val_loss: 3.3617 - val_accuracy200: 0.3413 - 155s/epoch - 15ms/step
Epoch 4/50
10532/10532 - 159s - loss: 3.2155 - accuracy200: 0.4122 - val_loss: 3.4956 - val_accuracy200: 0.3433 - 159s/epoch - 15ms/step
Epoch 5/50
10532/10532 - 156s - loss: 3.2104 - accuracy200: 0.4144 - val_loss: 3.4512 - val_accuracy200: 0.3390 - 156s/epoch - 15ms/step
Epoch 6/50
10532/10532 - 156s - loss: 3.2067 - accuracy200: 0.4168 - val_loss: 3.5513 - val_accuracy200: 0.3384 - 156s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 158s - loss: 3.2029 - accuracy200: 0.4188 - val_loss: 3.5118 - val_accuracy200: 0.3369 - 158s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 154s - loss: 3.2000 - accuracy200: 0.4200 - val_loss: 3.6526 - val_accuracy200: 0.3381 - 154s/epoch - 15ms/step
Epoch 9/50
10532/10532 - 156s - loss: 3.1981 - accuracy200: 0.4210 - val_loss: 3.6792 - val_accuracy200: 0.3375 - 156s/epoch - 15ms/step
Epoch 10/50
10532/10532 - 156s - loss: 3.1954 - accuracy200: 0.4219 - val_loss: 3.6288 - val_accuracy200: 0.3312 - 156s/epoch - 15ms/step
Epoch 11/50
10532/10532 - 157s - loss: 3.1932 - accuracy200: 0.4229 - val_loss: 3.6363 - val_accuracy200: 0.3294 - 157s/epoch - 15ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 159s - 159s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069374
{'0': {'precision': 0.34392886942565143, 'recall': 0.13601138633505283, 'f1-score': 0.19493360588011857, 'support': 2378992}, '1': {'precision': 0.33653601114168313, 'recall': 0.7367757980196075, 'f1-score': 0.4620308582368136, 'support': 2382053}, '2': {'precision': 0.3311485062767216, 'recall': 0.1325289236580558, 'f1-score': 0.1892986471823747, 'support': 2325432}, 'accuracy': 0.3368099550735859, 'macro avg': {'precision': 0.3372044622813521, 'recall': 0.33510536933757207, 'f1-score': 0.2820877037664356, 'support': 7086477}, 'weighted avg': {'precision': 0.33724994480738996, 'recall': 0.3368099550735859, 'f1-score': 0.2828667351337111, 'support': 7086477}}
[[ 323570 1743753  311669]
 [ 316209 1755039  310805]
 [ 301026 1716219  308187]]
Evaluating performance on  train set...
10532/10532 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1151502
{'0': {'precision': 0.35614751841064235, 'recall': 0.12150627726059861, 'f1-score': 0.181194662367814, 'support': 904694}, '1': {'precision': 0.3316917006116052, 'recall': 0.7855722539695452, 'f1-score': 0.4664391002753404, 'support': 885114}, '2': {'precision': 0.3493130904740295, 'recall': 0.1121456953642384, 'f1-score': 0.16978313397968697, 'support': 906000}, 'accuracy': 0.33639302205498317, 'macro avg': {'precision': 0.34571743649875897, 'recall': 0.3397414088647941, 'f1-score': 0.2724722988742805, 'support': 2695808}, 'weighted avg': {'precision': 0.34582104915691647, 'recall': 0.33639302205498317, 'f1-score': 0.2710137446965404, 'support': 2695808}}
[[109926 697232  97536]
 [ 98065 695321  91728]
 [100662 703734 101604]]
Evaluating performance on  val set...
3814/3814 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1126868
{'0': {'precision': 0.3553971888818699, 'recall': 0.11179071298170663, 'f1-score': 0.17008190913471077, 'support': 322084}, '1': {'precision': 0.34131562720284425, 'recall': 0.768439913872284, 'f1-score': 0.47268166990528654, 'support': 332065}, '2': {'precision': 0.33801906863131354, 'recall': 0.1333536429934781, 'f1-score': 0.1912544917921693, 'support': 321686}, 'accuracy': 0.34234886020689975, 'macro avg': {'precision': 0.34491062823867585, 'recall': 0.33786142328248964, 'f1-score': 0.2780060236107222, 'support': 975835}, 'weighted avg': {'precision': 0.3448766687428442, 'recall': 0.34234886020689975, 'f1-score': 0.2800325800832097, 'support': 975835}}
[[ 36006 246181  39897]
 [ 32778 255172  44115]
 [ 32528 246260  42898]]
testing model out of sample: results/universal/W3/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 80s - 80s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114693
{'0': {'precision': 0.3332296178630792, 'recall': 0.11914487489231891, 'f1-score': 0.17552979562965443, 'support': 1366303}, '1': {'precision': 0.35247975282514626, 'recall': 0.7922389476725786, 'f1-score': 0.48788962446873124, 'support': 1453540}, '2': {'precision': 0.3131372260780999, 'recall': 0.09060245173246646, 'f1-score': 0.14054105638183567, 'support': 1316620}, 'accuracy': 0.3465830590047584, 'macro avg': {'precision': 0.3329488655887751, 'recall': 0.333995424765788, 'f1-score': 0.2679868254934071, 'support': 4136463}, 'weighted avg': {'precision': 0.33359872458561574, 'recall': 0.3465830590047584, 'f1-score': 0.27415527148723823, 'support': 4136463}}
[[ 162788 1073829  129686]
 [ 170016 1151551  131973]
 [ 155712 1041619  119289]]
Evaluating performance on  train set...
6181/6181 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1171325
{'0': {'precision': 0.35012443880538746, 'recall': 0.10901141810944064, 'f1-score': 0.16625824802887315, 'support': 526532}, '1': {'precision': 0.3346567882472138, 'recall': 0.8071907778426903, 'f1-score': 0.4731487481129088, 'support': 523782}, '2': {'precision': 0.33604546543164326, 'recall': 0.09768323132125245, 'f1-score': 0.15136654401688718, 'support': 531473}, 'accuracy': 0.33639548181898066, 'macro avg': {'precision': 0.34027556416141486, 'recall': 0.33796180909112783, 'f1-score': 0.26359118005288973, 'support': 1581787}, 'weighted avg': {'precision': 0.3402721191438115, 'recall': 0.33639548181898066, 'f1-score': 0.26287630172931076, 'support': 1581787}}
[[ 57398 415996  53138]
 [ 51553 422792  49437]
 [ 54985 424572  51916]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112453
{'0': {'precision': 0.3550325488232349, 'recall': 0.11782240432901782, 'f1-score': 0.17692862573840487, 'support': 192561}, '1': {'precision': 0.33424217080613733, 'recall': 0.7961343936424181, 'f1-score': 0.4708195416529803, 'support': 187241}, '2': {'precision': 0.3246338749977203, 'recall': 0.09625575912266661, 'f1-score': 0.14848491168067401, 'support': 184924}, 'accuracy': 0.33566189621161413, 'macro avg': {'precision': 0.33796953154236414, 'recall': 0.3367375190313675, 'f1-score': 0.2654110263573531, 'support': 564726}, 'weighted avg': {'precision': 0.33818498818531695, 'recall': 0.33566189621161413, 'f1-score': 0.26505721129732934, 'support': 564726}}
[[ 22688 150661  19212]
 [ 20353 149069  17819]
 [ 20863 146261  17800]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1031379
{'0': {'precision': 0.3301795030506676, 'recall': 0.13228469196159706, 'f1-score': 0.18889113719142048, 'support': 56454}, '1': {'precision': 0.36888820812137724, 'recall': 0.7167494243511223, 'f1-score': 0.4870877775648805, 'support': 63841}, '2': {'precision': 0.2919830907934608, 'recall': 0.14699512213496055, 'f1-score': 0.19554542265871624, 'support': 53097}, 'accuracy': 0.35198279044015873, 'macro avg': {'precision': 0.33035026732183526, 'recall': 0.3320097461492267, 'f1-score': 0.29050811247167235, 'support': 173392}, 'weighted avg': {'precision': 0.33273491240518377, 'recall': 0.35198279044015873, 'f1-score': 0.3007215233311447, 'support': 173392}}
[[ 7468 39779  9207]
 [ 8364 45758  9719]
 [ 6786 38506  7805]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1177399
{'0': {'precision': 0.3354655294953802, 'recall': 0.10759551381416978, 'f1-score': 0.1629327902240326, 'support': 21934}, '1': {'precision': 0.33581808598750096, 'recall': 0.8138686131386861, 'f1-score': 0.4754544000852832, 'support': 21920}, '2': {'precision': 0.3453808752025932, 'recall': 0.09481646273637374, 'f1-score': 0.1487868737999651, 'support': 22475}, 'accuracy': 0.3366702347389528, 'macro avg': {'precision': 0.33888816356182483, 'recall': 0.3387601965630765, 'f1-score': 0.26239135470309366, 'support': 66329}, 'weighted avg': {'precision': 0.33894176814027005, 'recall': 0.3366702347389528, 'f1-score': 0.2614197901264538, 'support': 66329}}
[[ 2360 17457  2117]
 [ 2158 17840  1922]
 [ 2517 17827  2131]]
Evaluating performance on  val set...
86/86 - 1s - 626ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1129017
{'0': {'precision': 0.3623607098638052, 'recall': 0.113086038124678, 'f1-score': 0.17237655835869245, 'support': 7764}, '1': {'precision': 0.3388753333711627, 'recall': 0.8249758253902473, 'f1-score': 0.48041187354195164, 'support': 7239}, '2': {'precision': 0.3278601694915254, 'recall': 0.08930890203433849, 'f1-score': 0.1403787277469101, 'support': 6931}, 'accuracy': 0.34052156469408223, 'macro avg': {'precision': 0.3430320709088311, 'recall': 0.34245692184975457, 'f1-score': 0.2643890532158514, 'support': 21934}, 'weighted avg': {'precision': 0.3437077561959603, 'recall': 0.34052156469408223, 'f1-score': 0.26392806208082925, 'support': 21934}}
[[ 878 6143  743]
 [ 741 5972  526]
 [ 804 5508  619]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933241
{'0': {'precision': 0.3294344296133205, 'recall': 0.12566489361702127, 'f1-score': 0.18193102225374588, 'support': 114304}, '1': {'precision': 0.40084401641261136, 'recall': 0.7703889842281605, 'f1-score': 0.5273174756331194, 'support': 146844}, '2': {'precision': 0.28265322562084283, 'recall': 0.11358150289017341, 'f1-score': 0.16204626123213745, 'support': 108125}, 'accuracy': 0.378505875057207, 'macro avg': {'precision': 0.3376438905489249, 'recall': 0.336545126911785, 'f1-score': 0.2904315863730009, 'support': 369273}, 'weighted avg': {'precision': 0.3441331800832124, 'recall': 0.378505875057207, 'f1-score': 0.3134540108680754, 'support': 369273}}
[[ 14364  85692  14248]
 [ 16797 113127  16920]
 [ 12441  83403  12281]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1085161
{'0': {'precision': 0.37583167472277507, 'recall': 0.11925082549935945, 'f1-score': 0.1810536120318878, 'support': 55421}, '1': {'precision': 0.34227686717120004, 'recall': 0.8145773022096816, 'f1-score': 0.4820157534952051, 'support': 54578}, '2': {'precision': 0.3684115414734052, 'recall': 0.11310008136696502, 'f1-score': 0.17306903235847587, 'support': 54076}, 'accuracy': 0.34851744628980647, 'macro avg': {'precision': 0.36217336112246007, 'recall': 0.34897606969200196, 'f1-score': 0.2787127992951896, 'support': 164075}, 'weighted avg': {'precision': 0.3622244499039862, 'recall': 0.34851744628980647, 'f1-score': 0.2785342618954594, 'support': 164075}}
[[ 6609 43289  5523]
 [ 5158 44458  4962]
 [ 5818 42142  6116]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1156204
{'0': {'precision': 0.3493664339281096, 'recall': 0.061709222125793634, 'f1-score': 0.10489130434782608, 'support': 21893}, '1': {'precision': 0.3604222970303289, 'recall': 0.9135154622656626, 'f1-score': 0.5169033398687626, 'support': 24964}, '2': {'precision': 0.3443997317236754, 'recall': 0.044143563292499466, 'f1-score': 0.0782565626547796, 'support': 23265}, 'accuracy': 0.3591312284304498, 'macro avg': {'precision': 0.3513961542273713, 'recall': 0.3397894158946519, 'f1-score': 0.2333504022904561, 'support': 70122}, 'weighted avg': {'precision': 0.3516545637546639, 'recall': 0.3591312284304498, 'f1-score': 0.24273408106919644, 'support': 70122}}
[[ 1351 19515  1027]
 [ 1231 22805   928]
 [ 1285 20953  1027]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
1359/1359 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945576
{'0': {'precision': 0.29946181445412606, 'recall': 0.14179391242795025, 'f1-score': 0.19245920090039392, 'support': 98890}, '1': {'precision': 0.4424298494147578, 'recall': 0.6949926687168309, 'f1-score': 0.5406706775417912, 'support': 154134}, '2': {'precision': 0.2555602752527398, 'recall': 0.15869884043597074, 'f1-score': 0.1958055613413872, 'support': 94777}, 'accuracy': 0.3915601162733862, 'macro avg': {'precision': 0.3324839797072079, 'recall': 0.3318284738602506, 'f1-score': 0.3096451465945241, 'support': 347801}, 'weighted avg': {'precision': 0.35085723574311667, 'recall': 0.3915601162733862, 'f1-score': 0.3476870057202799, 'support': 347801}}
[[ 14022  68440  16428]
 [ 19626 107122  27386]
 [ 13176  66560  15041]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1359215
{'0': {'precision': 0.3404206675811614, 'recall': 0.08000644779968835, 'f1-score': 0.1295627583206439, 'support': 37222}, '1': {'precision': 0.3311700054250638, 'recall': 0.8766788117337305, 'f1-score': 0.48073852077089674, 'support': 37601}, '2': {'precision': 0.3358476334150481, 'recall': 0.04594232059020791, 'f1-score': 0.08082779277950486, 'support': 38766}, 'accuracy': 0.3321008196216183, 'macro avg': {'precision': 0.3358127688070911, 'recall': 0.3342091933745423, 'f1-score': 0.23037635729034847, 'support': 113589}, 'weighted avg': {'precision': 0.335797751715937, 'recall': 0.3321008196216183, 'f1-score': 0.22917891983033373, 'support': 113589}}
[[ 2978 32541  1703]
 [ 2818 32964  1819]
 [ 2952 34033  1781]]
Evaluating performance on  val set...
144/144 - 1s - 889ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1114111
{'0': {'precision': 0.3598071555442781, 'recall': 0.1142995324842818, 'f1-score': 0.1734874900593381, 'support': 12406}, '1': {'precision': 0.33904722566432605, 'recall': 0.8085700213429651, 'f1-score': 0.47776107096085757, 'support': 12182}, '2': {'precision': 0.3688681830638531, 'recall': 0.11166417786626846, 'f1-score': 0.17143221040565498, 'support': 12054}, 'accuracy': 0.3442497680257628, 'macro avg': {'precision': 0.35590752142415244, 'recall': 0.34484457723117173, 'f1-score': 0.27422692380861685, 'support': 36642}, 'weighted avg': {'precision': 0.35588608573158725, 'recall': 0.3442497680257628, 'f1-score': 0.2739701717250991, 'support': 36642}}
[[1418 9786 1202]
 [1231 9850 1101]
 [1292 9416 1346]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1140/1140 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090782
{'0': {'precision': 0.33441440128270533, 'recall': 0.10086610538348245, 'f1-score': 0.15498547591704384, 'support': 90982}, '1': {'precision': 0.36724153398580844, 'recall': 0.8063653759567763, 'f1-score': 0.5046508419653, 'support': 106608}, '2': {'precision': 0.3358710106382979, 'recall': 0.10746157528054034, 'f1-score': 0.16282686651355818, 'support': 94015}, 'accuracy': 0.3609163080194098, 'macro avg': {'precision': 0.34584231530227055, 'recall': 0.3382310188735997, 'f1-score': 0.27415439479863396, 'support': 291605}, 'weighted avg': {'precision': 0.34688530573145776, 'recall': 0.3609163080194098, 'f1-score': 0.2853478965909136, 'support': 291605}}
[[ 9177 72763  9042]
 [ 9708 85965 10935]
 [ 8557 75355 10103]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1334698
{'0': {'precision': 0.3378743760399334, 'recall': 0.09915766343160594, 'f1-score': 0.15331980557783967, 'support': 32766}, '1': {'precision': 0.3302161544416727, 'recall': 0.8279261792525495, 'f1-score': 0.4721260783245778, 'support': 32457}, '2': {'precision': 0.36318340964179907, 'recall': 0.08124472828051572, 'f1-score': 0.13278519029097535, 'support': 33196}, 'accuracy': 0.3334518741299952, 'macro avg': {'precision': 0.343757980041135, 'recall': 0.3361095236548904, 'f1-score': 0.2527436913977976, 'support': 98419}, 'weighted avg': {'precision': 0.34388536762725685, 'recall': 0.3334518741299952, 'f1-score': 0.25153080249386334, 'support': 98419}}
[[ 3249 27247  2270]
 [ 3126 26872  2459]
 [ 3241 27258  2697]]
Evaluating performance on  val set...
139/139 - 1s - 885ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1085014
{'0': {'precision': 0.34202546998180716, 'recall': 0.09813815903949887, 'f1-score': 0.15251487290427257, 'support': 11494}, '1': {'precision': 0.3778227165487024, 'recall': 0.8495642288745737, 'f1-score': 0.5230374431354252, 'support': 13195}, '2': {'precision': 0.3196004993757803, 'recall': 0.07189664856768395, 'f1-score': 0.11738632021398547, 'support': 10682}, 'accuracy': 0.37052952984083004, 'macro avg': {'precision': 0.3464828953020966, 'recall': 0.3398663454939188, 'f1-score': 0.2643128787512277, 'support': 35371}, 'weighted avg': {'precision': 0.3486071649419893, 'recall': 0.37052952984083004, 'f1-score': 0.28012794899379256, 'support': 35371}}
[[ 1128  9490   876]
 [ 1226 11210   759]
 [  944  8970   768]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1227472
{'0': {'precision': 0.37092786133061434, 'recall': 0.13693660629843457, 'f1-score': 0.20002817975937234, 'support': 212529}, '1': {'precision': 0.2851590805946498, 'recall': 0.6896200443867713, 'f1-score': 0.40347892723025097, 'support': 164914}, '2': {'precision': 0.3495202039133368, 'recall': 0.180574383206166, 'f1-score': 0.23812503192195722, 'support': 206552}, 'accuracy': 0.30844270926977113, 'macro avg': {'precision': 0.3352023819462004, 'recall': 0.33571034463045724, 'f1-score': 0.28054404630386015, 'support': 583995}, 'weighted avg': {'precision': 0.33913603578220314, 'recall': 0.30844270926977113, 'f1-score': 0.2709549129956136, 'support': 583995}}
[[ 29103 143211  40215]
 [ 21987 113728  29199]
 [ 27370 141884  37298]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196945
{'0': {'precision': 0.3394695787831513, 'recall': 0.10190264657871498, 'f1-score': 0.15675136097475637, 'support': 74738}, '1': {'precision': 0.3327842028517682, 'recall': 0.8089562335114658, 'f1-score': 0.4715745308427283, 'support': 73915}, '2': {'precision': 0.344365885992046, 'recall': 0.10241818898672625, 'f1-score': 0.1578808752025932, 'support': 76090}, 'accuracy': 0.3346177634008623, 'macro avg': {'precision': 0.33887322254232183, 'recall': 0.3377590230256357, 'f1-score': 0.26206892234002593, 'support': 224743}, 'weighted avg': {'precision': 0.33892856283852396, 'recall': 0.3346177634008623, 'f1-score': 0.2606749507568063, 'support': 224743}}
[[ 7616 59377  7745]
 [ 7029 59794  7092]
 [ 7790 60507  7793]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196958
{'0': {'precision': 0.3548051347288077, 'recall': 0.11694747274529237, 'f1-score': 0.17591238783291763, 'support': 26234}, '1': {'precision': 0.32967696955612363, 'recall': 0.8535499398315283, 'f1-score': 0.4756412405699916, 'support': 24930}, '2': {'precision': 0.36383233532934134, 'recall': 0.0579704613975499, 'f1-score': 0.10000658371189676, 'support': 26203}, 'accuracy': 0.3343285897087906, 'macro avg': {'precision': 0.3494381465380909, 'recall': 0.34282262465812346, 'f1-score': 0.2505200707049353, 'support': 77367}, 'weighted avg': {'precision': 0.34976544829377426, 'recall': 0.3343285897087906, 'f1-score': 0.24678602275933512, 'support': 77367}}
[[ 3068 21662  1504]
 [ 2499 21279  1152]
 [ 3080 21604  1519]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
5098/5098 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082019
{'0': {'precision': 0.35321076415225355, 'recall': 0.14831811483517593, 'f1-score': 0.20891141815930103, 'support': 445839}, '1': {'precision': 0.3332493903772355, 'recall': 0.7313171468338079, 'f1-score': 0.45785957915465003, 'support': 439708}, '2': {'precision': 0.3209693890910995, 'recall': 0.11691513816159708, 'f1-score': 0.17139760889323918, 'support': 419364}, 'accuracy': 0.3346756981893784, 'macro avg': {'precision': 0.3358098478735296, 'recall': 0.3321834666101936, 'f1-score': 0.27938953540239675, 'support': 1304911}, 'weighted avg': {'precision': 0.33612297214880543, 'recall': 0.3346756981893784, 'f1-score': 0.2807420310255349, 'support': 1304911}}
[[ 66126 329252  50461]
 [ 64877 321566  53265]
 [ 56211 314123  49030]]
Evaluating performance on  train set...
1876/1876 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1161866
{'0': {'precision': 0.3776205829042555, 'recall': 0.14447287834993341, 'f1-score': 0.20898914307527053, 'support': 162951}, '1': {'precision': 0.3226451728346593, 'recall': 0.7814952098171256, 'f1-score': 0.45672753393066423, 'support': 154587}, '2': {'precision': 0.3643019962699454, 'recall': 0.09726499824797595, 'f1-score': 0.15353711790393013, 'support': 162669}, 'accuracy': 0.33354990660277756, 'macro avg': {'precision': 0.3548559173362868, 'recall': 0.3410776954716783, 'f1-score': 0.2730845983032883, 'support': 480207}, 'weighted avg': {'precision': 0.35541140043576747, 'recall': 0.33354990660277756, 'f1-score': 0.2699562034150115, 'support': 480207}}
[[ 23542 125362  14047]
 [ 20216 120809  13562]
 [ 18585 128262  15822]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1204387
{'0': {'precision': 0.41335044929396664, 'recall': 0.06870332654446708, 'f1-score': 0.11782316545805335, 'support': 51555}, '1': {'precision': 0.3441855516544313, 'recall': 0.8938768743322404, 'f1-score': 0.49700160290058437, 'support': 54286}, '2': {'precision': 0.3732138806985711, 'recall': 0.06264872170718243, 'f1-score': 0.10728781235227959, 'support': 52531}, 'accuracy': 0.3495441113328114, 'macro avg': {'precision': 0.37691662721565633, 'recall': 0.34174297419463, 'f1-score': 0.24070419357030579, 'support': 158372}, 'weighted avg': {'precision': 0.37632938674411853, 'recall': 0.3495441113328114, 'f1-score': 0.2443016340068236, 'support': 158372}}
[[ 3542 45373  2640]
 [ 2874 48525  2887]
 [ 2153 47087  3291]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
5760/5760 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1034633
{'0': {'precision': 0.3330010250073716, 'recall': 0.1457711850516309, 'f1-score': 0.20277682379580955, 'support': 488080}, '1': {'precision': 0.35905554449383964, 'recall': 0.7321189056491376, 'f1-score': 0.4818136133367876, 'support': 527107}, '2': {'precision': 0.3106172998774431, 'recall': 0.12581757692408183, 'f1-score': 0.17909254323436433, 'support': 459284}, 'accuracy': 0.3491686170836863, 'macro avg': {'precision': 0.3342246231262181, 'recall': 0.3345692225416168, 'f1-score': 0.28789432678898713, 'support': 1474471}, 'weighted avg': {'precision': 0.33534290408832984, 'recall': 0.3491686170836863, 'f1-score': 0.2951519426765427, 'support': 1474471}}
[[ 71148 353784  63148]
 [ 76100 385905  65102]
 [ 66409 335089  57786]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112815
{'0': {'precision': 0.35652160061169874, 'recall': 0.12136214516172762, 'f1-score': 0.18108264459466566, 'support': 184415}, '1': {'precision': 0.3373375610528325, 'recall': 0.7858494812597281, 'f1-score': 0.47204345736926545, 'support': 184389}, '2': {'precision': 0.33917332314794824, 'recall': 0.1111600947016083, 'f1-score': 0.1674427756279924, 'support': 183735}, 'accuracy': 0.3397171964331929, 'macro avg': {'precision': 0.3443441616041598, 'recall': 0.3394572403743547, 'f1-score': 0.27352295919730785, 'support': 552539}, 'weighted avg': {'precision': 0.34435085496293555, 'recall': 0.3397171964331929, 'f1-score': 0.27364416872618214, 'support': 552539}}
[[ 22381 141878  20156]
 [ 19850 144902  19637]
 [ 20545 142766  20424]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080258
{'0': {'precision': 0.36220822780477785, 'recall': 0.14309859916707232, 'f1-score': 0.20514858394556768, 'support': 73956}, '1': {'precision': 0.32397882187232757, 'recall': 0.7309885931558935, 'f1-score': 0.448970877847296, 'support': 70484}, '2': {'precision': 0.3189895170991579, 'recall': 0.12730265413894795, 'f1-score': 0.18198039215686276, 'support': 72905}, 'accuracy': 0.3284501598840553, 'macro avg': {'precision': 0.33505885559208776, 'recall': 0.3337966154873046, 'f1-score': 0.2786999513165755, 'support': 217345}, 'weighted avg': {'precision': 0.3353135601025714, 'recall': 0.3284501598840553, 'f1-score': 0.27644764093337, 'support': 217345}}
[[10583 53215 10158]
 [ 9305 51523  9656]
 [ 9330 54294  9281]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
6315/6315 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083051
{'0': {'precision': 0.35776890701609754, 'recall': 0.14722634879369206, 'f1-score': 0.2086079395238107, 'support': 560056}, '1': {'precision': 0.32274896379864215, 'recall': 0.7326659136869772, 'f1-score': 0.44810276886831035, 'support': 519713}, '2': {'precision': 0.3433131893181752, 'recall': 0.1318959589917883, 'f1-score': 0.1905755497371627, 'support': 536673}, 'accuracy': 0.3303650857871795, 'macro avg': {'precision': 0.341277020044305, 'recall': 0.3372627404908192, 'f1-score': 0.28242875270976125, 'support': 1616442}, 'weighted avg': {'precision': 0.34170998678668596, 'recall': 0.3303650857871795, 'f1-score': 0.27962259982040544, 'support': 1616442}}
[[ 82455 407742  69859]
 [ 73399 380776  65538]
 [ 74616 391272  70785]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157541
{'0': {'precision': 0.35963346591148654, 'recall': 0.13991011285101915, 'f1-score': 0.20144932670469085, 'support': 182896}, '1': {'precision': 0.3350714838266052, 'recall': 0.7702101970254103, 'f1-score': 0.4669858879353661, 'support': 182210}, '2': {'precision': 0.3590622563036132, 'recall': 0.11854533751709712, 'f1-score': 0.17824321436204316, 'support': 186435}, 'accuracy': 0.3409175383153746, 'macro avg': {'precision': 0.351255735347235, 'recall': 0.3428885491311755, 'f1-score': 0.28222614300070004, 'support': 551541}, 'weighted avg': {'precision': 0.3513259561906678, 'recall': 0.3409175383153746, 'f1-score': 0.2813291276029737, 'support': 551541}}
[[ 25589 136983  20324]
 [ 22743 140340  19127]
 [ 22821 141513  22101]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097356
{'0': {'precision': 0.35376276146453395, 'recall': 0.16762787179729602, 'f1-score': 0.22747051842665156, 'support': 63462}, '1': {'precision': 0.3420966486502215, 'recall': 0.7324849693155977, 'f1-score': 0.46637807496442185, 'support': 64202}, '2': {'precision': 0.36393004824259134, 'recall': 0.13391979711523222, 'f1-score': 0.1957917178411698, 'support': 63090}, 'accuracy': 0.34659299411807876, 'macro avg': {'precision': 0.3532631527857823, 'recall': 0.344677546076042, 'f1-score': 0.29654677041074773, 'support': 190754}, 'weighted avg': {'precision': 0.3531990319905683, 'recall': 0.34659299411807876, 'f1-score': 0.29740209215983604, 'support': 190754}}
[[10638 45271  7553]
 [ 9961 47027  7214]
 [ 9472 45169  8449]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
6082/6082 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1280336
{'0': {'precision': 0.3237652417326944, 'recall': 0.08022729499363182, 'f1-score': 0.12859054163552194, 'support': 510350}, '1': {'precision': 0.34955965243131987, 'recall': 0.9176828370840263, 'f1-score': 0.5062723136689699, 'support': 543544}, '2': {'precision': 0.4625110261687739, 'recall': 0.0031277962259648844, 'f1-score': 0.006213572290548694, 'support': 502910}, 'accuracy': 0.3477110798790342, 'macro avg': {'precision': 0.37861197344426273, 'recall': 0.333679309434541, 'f1-score': 0.21369214253168015, 'support': 1556804}, 'weighted avg': {'precision': 0.37759156773103614, 'recall': 0.3477110798790342, 'f1-score': 0.2209220486491652, 'support': 1556804}}
[[ 40944 468427    979]
 [ 43894 498801    849]
 [ 41624 459713   1573]]
Evaluating performance on  train set...
2440/2440 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1167179
{'0': {'precision': 0.34866409464197096, 'recall': 0.10459939584003689, 'f1-score': 0.16092208799734012, 'support': 208223}, '1': {'precision': 0.33349844409735674, 'recall': 0.8107226265676816, 'f1-score': 0.47259177703780336, 'support': 205957}, '2': {'precision': 0.33317058880968653, 'recall': 0.0972971431558836, 'f1-score': 0.15061080804699598, 'support': 210407}, 'accuracy': 0.33498295673781237, 'macro avg': {'precision': 0.3384443758496714, 'recall': 0.337539721854534, 'f1-score': 0.2613748910273798, 'support': 624587}, 'weighted avg': {'precision': 0.33844387876992976, 'recall': 0.33498295673781237, 'f1-score': 0.2602212867722019, 'support': 624587}}
[[ 21780 164695  21748]
 [ 19757 166974  19226]
 [ 20930 169005  20472]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150681
{'0': {'precision': 0.3474024282215622, 'recall': 0.0923394412819767, 'f1-score': 0.14589898459383754, 'support': 72201}, '1': {'precision': 0.3438168216029811, 'recall': 0.8371958125017264, 'f1-score': 0.48744949038055607, 'support': 72406}, '2': {'precision': 0.32061739239553266, 'recall': 0.07646152234741363, 'f1-score': 0.12347618069567108, 'support': 66831}, 'accuracy': 0.3423935148837957, 'macro avg': {'precision': 0.3372788807400253, 'recall': 0.3353322587103722, 'f1-score': 0.2522748852233549, 'support': 211438}, 'weighted avg': {'precision': 0.33770838002722453, 'recall': 0.3423935148837957, 'f1-score': 0.2557740662474418, 'support': 211438}}
[[ 6667 60078  5456]
 [ 6416 60618  5372]
 [ 6108 55613  5110]]
testing model on single stock: results/universal/W3/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
13689/13689 - 77s - 77s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1070974
{'0': {'precision': 0.335163848073191, 'recall': 0.12940193233322858, 'f1-score': 0.18671564466487015, 'support': 1167811}, '1': {'precision': 0.33428855612292846, 'recall': 0.7301407824287107, 'f1-score': 0.45860762961808926, 'support': 1169180}, '2': {'precision': 0.3324714673668327, 'recall': 0.14232794033865778, 'f1-score': 0.19932619293006493, 'support': 1167255}, 'accuracy': 0.3341420665101708, 'macro avg': {'precision': 0.33397462385431737, 'recall': 0.3339568850335324, 'f1-score': 0.28154982240434145, 'support': 3504246}, 'weighted avg': {'precision': 0.33397498499571066, 'recall': 0.3341420665101708, 'f1-score': 0.28163203937086245, 'support': 3504246}}
[[151117 848197 168497]
 [150453 853666 165061]
 [149305 851817 166133]]
Evaluating performance on  train set...
5475/5475 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1141355
{'0': {'precision': 0.34409025229124407, 'recall': 0.10776781540815025, 'f1-score': 0.16413054205921992, 'support': 470660}, '1': {'precision': 0.33211587293741157, 'recall': 0.7865383864967633, 'f1-score': 0.46702880827948406, 'support': 461282}, '2': {'precision': 0.3394530018117846, 'recall': 0.11689351481184948, 'f1-score': 0.17390230033436657, 'support': 469624}, 'accuracy': 0.3342218632586692, 'macro avg': {'precision': 0.33855304234681344, 'recall': 0.337066572238921, 'f1-score': 0.2683538835576902, 'support': 1401566}, 'weighted avg': {'precision': 0.33859544878127007, 'recall': 0.3342218632586692, 'f1-score': 0.267094348434962, 'support': 1401566}}
[[ 50722 364756  55182]
 [ 46825 362816  51641]
 [ 49862 364866  54896]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1114316
{'0': {'precision': 0.3507923089375326, 'recall': 0.11229272224781207, 'f1-score': 0.17012609201969672, 'support': 173680}, '1': {'precision': 0.33407786765370645, 'recall': 0.7162206843083379, 'f1-score': 0.45562945609365146, 'support': 175418}, '2': {'precision': 0.32460773912557933, 'recall': 0.16887832765893165, 'f1-score': 0.22217126609417456, 'support': 172118}, 'accuracy': 0.3342337917485265, 'macro avg': {'precision': 0.3364926385722728, 'recall': 0.3324639114050272, 'f1-score': 0.2826422714025076, 'support': 521216}, 'weighted avg': {'precision': 0.3365202036145571, 'recall': 0.3342337917485265, 'f1-score': 0.28340032072809396, 'support': 521216}}
[[ 19503 126304  27873]
 [ 17175 125638  32605]
 [ 18919 124132  29067]]
training model: results/universal/W3/deepOF_L1/h50
Epoch 1/50
10532/10532 - 148s - loss: 3.1689 - accuracy50: 0.4386 - val_loss: 3.2215 - val_accuracy50: 0.4177 - 148s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 137s - loss: 3.1529 - accuracy50: 0.4443 - val_loss: 3.2184 - val_accuracy50: 0.4227 - 137s/epoch - 13ms/step
Epoch 3/50
10532/10532 - 136s - loss: 3.1414 - accuracy50: 0.4478 - val_loss: 3.2145 - val_accuracy50: 0.4232 - 136s/epoch - 13ms/step
Epoch 4/50
10532/10532 - 141s - loss: 3.1323 - accuracy50: 0.4510 - val_loss: 3.2192 - val_accuracy50: 0.4240 - 141s/epoch - 13ms/step
Epoch 5/50
10532/10532 - 142s - loss: 3.1229 - accuracy50: 0.4530 - val_loss: 3.2299 - val_accuracy50: 0.4262 - 142s/epoch - 13ms/step
Epoch 6/50
10532/10532 - 142s - loss: 3.1148 - accuracy50: 0.4547 - val_loss: 3.2546 - val_accuracy50: 0.4259 - 142s/epoch - 13ms/step
Epoch 7/50
10532/10532 - 142s - loss: 3.1078 - accuracy50: 0.4564 - val_loss: 3.2863 - val_accuracy50: 0.4227 - 142s/epoch - 13ms/step
Epoch 8/50
10532/10532 - 141s - loss: 3.1023 - accuracy50: 0.4579 - val_loss: 3.3002 - val_accuracy50: 0.4222 - 141s/epoch - 13ms/step
Epoch 9/50
10532/10532 - 141s - loss: 3.0970 - accuracy50: 0.4590 - val_loss: 3.3130 - val_accuracy50: 0.4221 - 141s/epoch - 13ms/step
Epoch 10/50
10532/10532 - 143s - loss: 3.0922 - accuracy50: 0.4601 - val_loss: 3.3074 - val_accuracy50: 0.4224 - 143s/epoch - 14ms/step
Epoch 11/50
10532/10532 - 139s - loss: 3.0886 - accuracy50: 0.4612 - val_loss: 3.3085 - val_accuracy50: 0.4225 - 139s/epoch - 13ms/step
Epoch 12/50
10532/10532 - 136s - loss: 3.0853 - accuracy50: 0.4620 - val_loss: 3.3095 - val_accuracy50: 0.4236 - 136s/epoch - 13ms/step
Epoch 13/50
10532/10532 - 141s - loss: 3.0824 - accuracy50: 0.4629 - val_loss: 3.3160 - val_accuracy50: 0.4238 - 141s/epoch - 13ms/step
testing model in sample: results/universal/W3/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 169s - 169s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0561306
{'0': {'precision': 0.468166114812303, 'recall': 0.14144354489184235, 'f1-score': 0.21725074011927806, 'support': 2074241}, '1': {'precision': 0.4250359953157721, 'recall': 0.8216312630646976, 'f1-score': 0.5602503143187219, 'support': 2941132}, '2': {'precision': 0.44922900092984813, 'recall': 0.1679540762228862, 'f1-score': 0.24449744219098588, 'support': 2071084}, 'accuracy': 0.4314936222713268, 'macro avg': {'precision': 0.44747703701930774, 'recall': 0.3770096280598087, 'f1-score': 0.3406661655429952, 'support': 7086457}, 'weighted avg': {'precision': 0.44473102896006383, 'recall': 0.4314936222713268, 'f1-score': 0.3675708835107979, 'support': 7086457}}
[[ 293388 1644066  136787]
 [ 234920 2416526  289686]
 [  98367 1624870  347847]]
Evaluating performance on  train set...
10532/10532 - 66s - 66s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721148
{'0': {'precision': 0.4823445363142578, 'recall': 0.11090819050379873, 'f1-score': 0.18034796067078082, 'support': 827910}, '1': {'precision': 0.38853575121220363, 'recall': 0.844121372869193, 'f1-score': 0.532137161769815, 'support': 1027017}, '2': {'precision': 0.47203924572345624, 'recall': 0.1539097322316251, 'f1-score': 0.2321321272844349, 'support': 840876}, 'accuracy': 0.40365264079014673, 'macro avg': {'precision': 0.44763984441663923, 'recall': 0.3696464318682056, 'f1-score': 0.31487241657501025, 'support': 2695803}, 'weighted avg': {'precision': 0.44339187969209837, 'recall': 0.40365264079014673, 'f1-score': 0.33052123105832387, 'support': 2695803}}
[[ 91822 684891  51197]
 [ 66536 866927  93554]
 [ 32008 679449 129419]]
Evaluating performance on  val set...
3814/3814 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0586504
{'0': {'precision': 0.47838942185675853, 'recall': 0.1300449822692589, 'f1-score': 0.20449909952915138, 'support': 289892}, '1': {'precision': 0.4124748974095517, 'recall': 0.8285635223063663, 'f1-score': 0.5507672420630567, 'support': 393901}, '2': {'precision': 0.4624256690963064, 'recall': 0.16749018117319145, 'f1-score': 0.24591144694307449, 'support': 292041}, 'accuracy': 0.4232123496414349, 'macro avg': {'precision': 0.45109666278753885, 'recall': 0.3753662285829389, 'f1-score': 0.3337259295117609, 'support': 975834}, 'weighted avg': {'precision': 0.44700512143866034, 'recall': 0.4232123496414349, 'f1-score': 0.3566658317431933, 'support': 975834}}
[[ 37699 233763  18430]
 [ 29096 326372  38433]
 [ 12009 231118  48914]]
testing model out of sample: results/universal/W3/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 97s - 97s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0510865
{'0': {'precision': 0.4411250448327099, 'recall': 0.11936331937666371, 'f1-score': 0.18788668230672703, 'support': 1154048}, '1': {'precision': 0.45818710362508874, 'recall': 0.8499845454288208, 'f1-score': 0.5954141526882606, 'support': 1837644}, '2': {'precision': 0.44761303718406076, 'recall': 0.1623296245209657, 'f1-score': 0.23825471087286254, 'support': 1144751}, 'accuracy': 0.45583778139817227, 'macro avg': {'precision': 0.4489750618806198, 'recall': 0.3772258297754834, 'f1-score': 0.3405185152892834, 'support': 4136443}, 'weighted avg': {'precision': 0.4505005217097426, 'recall': 0.45583778139817227, 'f1-score': 0.3828728725796052, 'support': 4136443}}
[[ 137751  942944   73353]
 [ 119704 1561969  155971]
 [  54817  904107  185827]]
Evaluating performance on  train set...
6181/6181 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.089079
{'0': {'precision': 0.46465253619649416, 'recall': 0.12364492820268795, 'f1-score': 0.19531591738504955, 'support': 500158}, '1': {'precision': 0.37456756105605155, 'recall': 0.8304499346567926, 'f1-score': 0.516274008817674, 'support': 578484}, '2': {'precision': 0.4539862160291329, 'recall': 0.1499054929373113, 'f1-score': 0.22538818298091065, 'support': 503137}, 'accuracy': 0.39048881038375144, 'macro avg': {'precision': 0.4310687710938928, 'recall': 0.3680001185989306, 'f1-score': 0.31232603639454476, 'support': 1581779}, 'weighted avg': {'precision': 0.4283141241369148, 'recall': 0.39048881038375144, 'f1-score': 0.3222613314153377, 'support': 1581779}}
[[ 61842 402594  35722]
 [ 43092 480402  54990]
 [ 28159 399555  75423]]
Evaluating performance on  val set...
2209/2209 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0681633
{'0': {'precision': 0.4527136431784108, 'recall': 0.13414800291432938, 'f1-score': 0.20696745656763205, 'support': 168821}, '1': {'precision': 0.41749150929682444, 'recall': 0.8256612189427466, 'f1-score': 0.5545683014385563, 'support': 229576}, '2': {'precision': 0.4463288009888752, 'recall': 0.16281586494237324, 'f1-score': 0.23859491462705504, 'support': 166329}, 'accuracy': 0.42370990533462244, 'macro avg': {'precision': 0.4388446511547035, 'recall': 0.3742083622664831, 'f1-score': 0.33337689087774774, 'support': 564726}, 'weighted avg': {'precision': 0.4365143872126108, 'recall': 0.42370990533462244, 'f1-score': 0.35759160887096686, 'support': 564726}}
[[ 22647 134263  11911]
 [ 18341 189552  21683]
 [  9037 130211  27081]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1341144
{'0': {'precision': 0.36804384485666103, 'recall': 0.03058061126193187, 'f1-score': 0.05646921845437346, 'support': 57095}, '1': {'precision': 0.3439751788767175, 'recall': 0.9118590012589173, 'f1-score': 0.4995195512746834, 'support': 59575}, '2': {'precision': 0.347675938025014, 'recall': 0.06567579956980148, 'f1-score': 0.1104816704235378, 'support': 56718}, 'accuracy': 0.34486238955406373, 'macro avg': {'precision': 0.3532316539194642, 'recall': 0.33603847069688353, 'f1-score': 0.22215681338419824, 'support': 173388}, 'weighted avg': {'precision': 0.3531113367509531, 'recall': 0.34486238955406373, 'f1-score': 0.22636679976655785, 'support': 173388}}
[[ 1746 52156  3193]
 [ 1455 54324  3796]
 [ 1543 51450  3725]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1214548
{'0': {'precision': 0.44951001278227526, 'recall': 0.04723951103747817, 'f1-score': 0.08549432739059967, 'support': 22333}, '1': {'precision': 0.3296953846669684, 'recall': 0.905808115701718, 'f1-score': 0.48343166175024577, 'support': 21711}, '2': {'precision': 0.4186100207804202, 'recall': 0.08136247363460934, 'f1-score': 0.13624408206207259, 'support': 22283}, 'accuracy': 0.339740980294601, 'macro avg': {'precision': 0.3992718060765546, 'recall': 0.3448033667912685, 'f1-score': 0.23505669040097268, 'support': 66327}, 'weighted avg': {'precision': 0.39990970049936236, 'recall': 0.339740980294601, 'f1-score': 0.23280197359239846, 'support': 66327}}
[[ 1055 20072  1206]
 [  733 19666  1312]
 [  559 19911  1813]]
Evaluating performance on  val set...
86/86 - 1s - 595ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1348765
{'0': {'precision': 0.4054982817869416, 'recall': 0.03150026695141484, 'f1-score': 0.05845925191974238, 'support': 7492}, '1': {'precision': 0.32914547811347095, 'recall': 0.9207810320781032, 'f1-score': 0.48494197149992657, 'support': 7170}, '2': {'precision': 0.3802163833075734, 'recall': 0.06765676567656766, 'f1-score': 0.11487275274340417, 'support': 7272}, 'accuracy': 0.3341843712957053, 'macro avg': {'precision': 0.3716200477359953, 'recall': 0.33997935490202863, 'f1-score': 0.21942465872102437, 'support': 21934}, 'weighted avg': {'precision': 0.3721573695921413, 'recall': 0.3341843712957053, 'f1-score': 0.21657542212944372, 'support': 21934}}
[[ 236 6856  400]
 [ 166 6602  402]
 [ 180 6600  492]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96035707
{'0': {'precision': 0.46443253560416975, 'recall': 0.17977863343800174, 'f1-score': 0.25921638924455825, 'support': 70381}, '1': {'precision': 0.6521612243196264, 'recall': 0.8834904635704045, 'f1-score': 0.7504022258959674, 'support': 230170}, '2': {'precision': 0.41587501241269736, 'recall': 0.18283419191478215, 'f1-score': 0.2540003436808216, 'support': 68718}, 'accuracy': 0.6189796598143901, 'macro avg': {'precision': 0.5108229241121646, 'recall': 0.41536776297439615, 'f1-score': 0.4212063196071158, 'support': 369269}, 'weighted avg': {'precision': 0.5724100165271963, 'recall': 0.6189796598143901, 'f1-score': 0.5644080186610703, 'support': 369269}}
[[ 12653  54709   3019]
 [ 12189 203353  14628]
 [  2402  53752  12564]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0496511
{'0': {'precision': 0.537381751602075, 'recall': 0.1467010996334555, 'f1-score': 0.23048229827890843, 'support': 48016}, '1': {'precision': 0.4453755726194738, 'recall': 0.8840018562023261, 'f1-score': 0.5923266400750137, 'support': 68958}, '2': {'precision': 0.5183398368215679, 'recall': 0.1551167728237792, 'f1-score': 0.23877767791486232, 'support': 47100}, 'accuracy': 0.45899411241269183, 'macro avg': {'precision': 0.5003657203477055, 'recall': 0.39527324288652027, 'f1-score': 0.3538622054229281, 'support': 164074}, 'weighted avg': {'precision': 0.49324656701192604, 'recall': 0.45899411241269183, 'f1-score': 0.384941715995483, 'support': 164074}}
[[ 7044 38446  2526]
 [ 3736 60959  4263]
 [ 2328 37466  7306]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.020291
{'0': {'precision': 0.5220228384991843, 'recall': 0.15758371634931057, 'f1-score': 0.24208800907830033, 'support': 18276}, '1': {'precision': 0.49926337067872684, 'recall': 0.8810423531545694, 'f1-score': 0.6373547067892797, 'support': 33079}, '2': {'precision': 0.5260792810142835, 'recall': 0.1746683007406618, 'f1-score': 0.2622609808784703, 'support': 18767}, 'accuracy': 0.5034368671743533, 'macro avg': {'precision': 0.5157884967307315, 'recall': 0.40443145674818054, 'f1-score': 0.3805678989153501, 'support': 70122}, 'weighted avg': {'precision': 0.5123720416115878, 'recall': 0.5034368671743533, 'f1-score': 0.4339480994259127, 'support': 70122}}
[[ 2880 14544   852]
 [ 1834 29144  2101]
 [  803 14686  3278]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1356766
{'0': {'precision': 0.4642308975642309, 'recall': 0.11131557681998928, 'f1-score': 0.17957239750382364, 'support': 124987}, '1': {'precision': 0.2877395204703344, 'recall': 0.7865066249740246, 'f1-score': 0.42133553855695677, 'support': 101057}, '2': {'precision': 0.42607817683542476, 'recall': 0.1455734150287878, 'f1-score': 0.217005099448427, 'support': 121753}, 'accuracy': 0.3194938426725935, 'macro avg': {'precision': 0.3926828649566634, 'recall': 0.3477985389409339, 'f1-score': 0.27263767850306914, 'support': 347797}, 'weighted avg': {'precision': 0.39959291246984474, 'recall': 0.3194938426725935, 'f1-score': 0.26292389710062225, 'support': 347797}}
[[ 13913 100086  10988]
 [  8689  79482  12886]
 [  7368  96661  17724]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1068796
{'0': {'precision': 0.46180053685731987, 'recall': 0.11947753619317271, 'f1-score': 0.18983957219251335, 'support': 37438}, '1': {'precision': 0.32945505171042166, 'recall': 0.7946114486728494, 'f1-score': 0.4657887337145, 'support': 37524}, '2': {'precision': 0.45051500223914015, 'recall': 0.15626779889193806, 'f1-score': 0.2320467476549285, 'support': 38626}, 'accuracy': 0.35501989646793675, 'macro avg': {'precision': 0.41392353026896056, 'recall': 0.35678559458598674, 'f1-score': 0.2958916845206473, 'support': 113588}, 'weighted avg': {'precision': 0.4142422820697189, 'recall': 0.35501989646793675, 'f1-score': 0.29535257265349757, 'support': 113588}}
[[ 4473 30039  2926]
 [ 3271 29817  4436]
 [ 1942 30648  6036]]
Evaluating performance on  val set...
144/144 - 1s - 861ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1121624
{'0': {'precision': 0.47885032537960953, 'recall': 0.1389675794774945, 'f1-score': 0.21541839473042207, 'support': 12708}, '1': {'precision': 0.304266128471014, 'recall': 0.7761406000355051, 'f1-score': 0.43715628437156284, 'support': 11266}, '2': {'precision': 0.4658444022770398, 'recall': 0.15503631196716136, 'f1-score': 0.2326462923477849, 'support': 12668}, 'accuracy': 0.34042901588341246, 'macro avg': {'precision': 0.4163202853758878, 'recall': 0.356714830493387, 'f1-score': 0.29507365714992323, 'support': 36642}, 'weighted avg': {'precision': 0.42067597364565423, 'recall': 0.34042901588341246, 'f1-score': 0.28955032180082885, 'support': 36642}}
[[ 1766 10033   909]
 [ 1179  8744  1343]
 [  743  9961  1964]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991989
{'0': {'precision': 0.4047274680771933, 'recall': 0.10404980452150263, 'f1-score': 0.16554125432065378, 'support': 94128}, '1': {'precision': 0.3497819257759168, 'recall': 0.8326056463243574, 'f1-score': 0.4926141195241478, 'support': 101234}, '2': {'precision': 0.47977600363237355, 'recall': 0.1317553174908301, 'f1-score': 0.2067368832947468, 'support': 96239}, 'accuracy': 0.36612357296442744, 'macro avg': {'precision': 0.41142846582849457, 'recall': 0.3561369227788967, 'f1-score': 0.2882974190465161, 'support': 291601}, 'weighted avg': {'precision': 0.4104209978797919, 'recall': 0.36612357296442744, 'f1-score': 0.2926859505763191, 'support': 291601}}
[[ 9794 78717  5617]
 [ 8814 84288  8132]
 [ 5591 77968 12680]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1058588
{'0': {'precision': 0.48094273614435645, 'recall': 0.07776818411885551, 'f1-score': 0.13388692398380234, 'support': 33587}, '1': {'precision': 0.33667223149693937, 'recall': 0.8553076402974983, 'f1-score': 0.4831597222222223, 'support': 32538}, '2': {'precision': 0.47699757869249393, 'recall': 0.15250983185210418, 'f1-score': 0.2311229996715003, 'support': 32293}, 'accuracy': 0.35935499603731025, 'macro avg': {'precision': 0.43153751544459656, 'recall': 0.36186188542281933, 'f1-score': 0.2827232152925083, 'support': 98418}, 'weighted avg': {'precision': 0.43195093942210394, 'recall': 0.35935499603731025, 'f1-score': 0.2812652785659371, 'support': 98418}}
[[ 2612 28577  2398]
 [ 1706 27830  3002]
 [ 1113 26255  4925]]
Evaluating performance on  val set...
139/139 - 1s - 829ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003729
{'0': {'precision': 0.4556083302886372, 'recall': 0.10293874855539045, 'f1-score': 0.16793481920409398, 'support': 12114}, '1': {'precision': 0.3520166571514928, 'recall': 0.8582657823630557, 'f1-score': 0.4992617289830911, 'support': 12213}, '2': {'precision': 0.47182359117955897, 'recall': 0.12205722564288302, 'f1-score': 0.19394288180706423, 'support': 11044}, 'accuracy': 0.3697096491476068, 'macro avg': {'precision': 0.42648285953989634, 'recall': 0.36108725218710974, 'f1-score': 0.28704647666474975, 'support': 35371}, 'weighted avg': {'precision': 0.4249028437956174, 'recall': 0.3697096491476068, 'f1-score': 0.2904569020549632, 'support': 35371}}
[[ 1247 10171   696]
 [  918 10482   813]
 [  572  9124  1348]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
2282/2282 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1326127
{'0': {'precision': 0.48955888691987165, 'recall': 0.09632111120534494, 'f1-score': 0.16097103891399864, 'support': 212238}, '1': {'precision': 0.26685392074643155, 'recall': 0.8047365477975752, 'f1-score': 0.4008006962576153, 'support': 157372}, '2': {'precision': 0.48451703495676596, 'recall': 0.1529053414248464, 'f1-score': 0.23245259470422217, 'support': 214381}, 'accuracy': 0.3079944725175559, 'macro avg': {'precision': 0.4136432808743564, 'recall': 0.3513210001425888, 'f1-score': 0.2647414432919454, 'support': 583991}, 'weighted avg': {'precision': 0.42769422941256563, 'recall': 0.3079944725175559, 'f1-score': 0.2518401794441499, 'support': 583991}}
[[ 20443 175887  15908]
 [ 11762 126643  18967]
 [  9553 172048  32780]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1148614
{'0': {'precision': 0.42385251662431744, 'recall': 0.10505581089954039, 'f1-score': 0.16837764700829003, 'support': 74627}, '1': {'precision': 0.3277422495629661, 'recall': 0.7977700573644664, 'f1-score': 0.46461145138142784, 'support': 74262}, '2': {'precision': 0.4326923076923077, 'recall': 0.14534883720930233, 'f1-score': 0.21760154738878143, 'support': 75852}, 'accuracy': 0.34755118113739814, 'macro avg': {'precision': 0.39476235795986375, 'recall': 0.34939156849110303, 'f1-score': 0.2835302152594998, 'support': 224741}, 'weighted avg': {'precision': 0.3950779502549372, 'recall': 0.34755118113739814, 'f1-score': 0.28287676408981494, 'support': 224741}}
[[ 7840 60882  5905]
 [ 6468 59244  8550]
 [ 4189 60638 11025]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1084951
{'0': {'precision': 0.431970802919708, 'recall': 0.11617133210317616, 'f1-score': 0.18310077039695552, 'support': 25471}, '1': {'precision': 0.33914827274965126, 'recall': 0.7863475514630341, 'f1-score': 0.4739038708493854, 'support': 26281}, '2': {'precision': 0.4332080985180547, 'recall': 0.16205348428655084, 'f1-score': 0.23587237548654716, 'support': 25615}, 'accuracy': 0.35901611798311944, 'macro avg': {'precision': 0.4014423913958047, 'recall': 0.3548574559509204, 'f1-score': 0.29762567224429604, 'support': 77367}, 'weighted avg': {'precision': 0.4008493223317621, 'recall': 0.35901611798311944, 'f1-score': 0.2993562920969077, 'support': 77367}}
[[ 2959 20353  2159]
 [ 2343 20666  3272]
 [ 1548 19916  4151]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/EXC
Evaluating performance on  test set...
5098/5098 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0022892
{'0': {'precision': 0.47543297274167273, 'recall': 0.19927252360679776, 'f1-score': 0.28083579812779097, 'support': 317811}, '1': {'precision': 0.5433461819881026, 'recall': 0.8371171496797359, 'f1-score': 0.6589735442023176, 'support': 675068}, '2': {'precision': 0.41607225602576664, 'recall': 0.1755387337033856, 'f1-score': 0.24690818196366227, 'support': 312028}, 'accuracy': 0.5235737106169251, 'macro avg': {'precision': 0.47828380358518063, 'recall': 0.4039761356633064, 'f1-score': 0.3955725080979236, 'support': 1304907}, 'weighted avg': {'precision': 0.4963722646790584, 'recall': 0.5235737106169251, 'f1-score': 0.4683451959243985, 'support': 1304907}}
[[ 63331 234175  20305]
 [ 53392 565111  56565]
 [ 16484 240771  54773]]
Evaluating performance on  train set...
1876/1876 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99369556
{'0': {'precision': 0.46649204110417086, 'recall': 0.20248204930864694, 'f1-score': 0.2823913984789993, 'support': 114341}, '1': {'precision': 0.5484902930622947, 'recall': 0.8429415400422215, 'f1-score': 0.6645604065282462, 'support': 249162}, '2': {'precision': 0.47694793612154535, 'recall': 0.19475244640194683, 'f1-score': 0.27657205439445104, 'support': 116702}, 'accuracy': 0.5329161503941026, 'macro avg': {'precision': 0.49731009009600363, 'recall': 0.4133920119176051, 'f1-score': 0.4078412864672322, 'support': 480205}, 'weighted avg': {'precision': 0.5115791857917682, 'recall': 0.5329161503941026, 'f1-score': 0.4792716169069863, 'support': 480205}}
[[ 23152  85112   6077]
 [ 20285 210029  18848]
 [  6193  87781  22728]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9830253
{'0': {'precision': 0.468879422553544, 'recall': 0.22023677189862162, 'f1-score': 0.2997012441856068, 'support': 35984}, '1': {'precision': 0.5701244284416971, 'recall': 0.837467821202902, 'f1-score': 0.6784079168128004, 'support': 85460}, '2': {'precision': 0.45657630522088355, 'recall': 0.1970320623916811, 'f1-score': 0.27527239709443097, 'support': 36928}, 'accuracy': 0.5478935670446796, 'macro avg': {'precision': 0.4985267187387082, 'recall': 0.4182455518310682, 'f1-score': 0.41779385269761277, 'support': 158372}, 'weighted avg': {'precision': 0.5206440569986547, 'recall': 0.5478935670446796, 'f1-score': 0.49836113215404204, 'support': 158372}}
[[ 7925 26159  1900]
 [ 7130 71570  6760]
 [ 1847 27805  7276]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/AAL
Evaluating performance on  test set...
5760/5760 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98906386
{'0': {'precision': 0.42717126288284263, 'recall': 0.13607446097482487, 'f1-score': 0.20640049938632743, 'support': 323176}, '1': {'precision': 0.5840529803880266, 'recall': 0.8702163699396483, 'f1-score': 0.6989798201154167, 'support': 834774}, '2': {'precision': 0.40873186732321376, 'recall': 0.16495480495518408, 'f1-score': 0.23504916084419794, 'support': 316517}, 'accuracy': 0.5579107569040203, 'macro avg': {'precision': 0.4733187035313609, 'recall': 0.39041521195655243, 'f1-score': 0.380143160115314, 'support': 1474467}, 'weighted avg': {'precision': 0.5120320272704657, 'recall': 0.5579107569040203, 'f1-score': 0.49142566323262954, 'support': 1474467}}
[[ 43976 264098  15102]
 [ 47914 726434  60426]
 [ 11057 253249  52211]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0497897
{'0': {'precision': 0.48043577695538275, 'recall': 0.1476691056650797, 'f1-score': 0.2259034230605671, 'support': 156485}, '1': {'precision': 0.4495013066056546, 'recall': 0.8457327526585154, 'f1-score': 0.5870104706406031, 'support': 238573}, '2': {'precision': 0.4537405294509331, 'recall': 0.1601028702057404, 'f1-score': 0.2366895567644698, 'support': 157480}, 'accuracy': 0.45262045325389383, 'macro avg': {'precision': 0.4612258710039902, 'recall': 0.3845015761764452, 'f1-score': 0.34986781682188, 'support': 552538}, 'weighted avg': {'precision': 0.45947052755761025, 'recall': 0.45262045325389383, 'f1-score': 0.3848951883292048, 'support': 552538}}
[[ 23108 123293  10084]
 [ 16534 201769  20270]
 [  8456 123811  25213]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0354264
{'0': {'precision': 0.45490138501443744, 'recall': 0.15948046600209323, 'f1-score': 0.23616545556176632, 'support': 58283}, '1': {'precision': 0.48442194344425843, 'recall': 0.8362597988756038, 'f1-score': 0.6134749713190341, 'support': 101032}, '2': {'precision': 0.4412888888888889, 'recall': 0.1711011545752197, 'f1-score': 0.2465913324226996, 'support': 58030}, 'accuracy': 0.4771814396466447, 'macro avg': {'precision': 0.4602040724491949, 'recall': 0.3889471398176389, 'f1-score': 0.36541058643450003, 'support': 217345}, 'weighted avg': {'precision': 0.4649894381516897, 'recall': 0.4771814396466447, 'f1-score': 0.4143400104410055, 'support': 217345}}
[[ 9295 45124  3864]
 [ 7836 84489  8707]
 [ 3302 44799  9929]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/WBA
Evaluating performance on  test set...
6315/6315 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0332303
{'0': {'precision': 0.49146427188087277, 'recall': 0.15271543135305735, 'f1-score': 0.23302248704240297, 'support': 448658}, '1': {'precision': 0.46670883770121235, 'recall': 0.8425285346786883, 'f1-score': 0.6006787179244942, 'support': 720702}, '2': {'precision': 0.4816022912605911, 'recall': 0.18956200036682638, 'f1-score': 0.2720451455819829, 'support': 447078}, 'accuracy': 0.47046530705167783, 'macro avg': {'precision': 0.4799251336142254, 'recall': 0.3949353221328573, 'f1-score': 0.36858211684962666, 'support': 1616438}, 'weighted avg': {'precision': 0.4776992122275462, 'recall': 0.47046530705167783, 'f1-score': 0.4077379744559278, 'support': 1616438}}
[[ 68517 351762  28379]
 [ 50645 607212  62845]
 [ 20252 342077  84749]]
Evaluating performance on  train set...
2155/2155 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602355
{'0': {'precision': 0.5203696107428917, 'recall': 0.14490287906023241, 'f1-score': 0.22668321906535374, 'support': 166339}, '1': {'precision': 0.405436656952493, 'recall': 0.8481661184595302, 'f1-score': 0.5486229647115792, 'support': 213727}, '2': {'precision': 0.5109535528059337, 'recall': 0.1731506050444671, 'f1-score': 0.2586504286012963, 'support': 171475}, 'accuracy': 0.42620584870390416, 'macro avg': {'precision': 0.4789199401671061, 'recall': 0.38873986752140993, 'f1-score': 0.34465220412607644, 'support': 551541}, 'weighted avg': {'precision': 0.4729046100457533, 'recall': 0.42620584870390416, 'f1-score': 0.3613763665791498, 'support': 551541}}
[[ 24103 131828  10408]
 [ 14441 181276  18010]
 [  7775 134009  29691]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0353448
{'0': {'precision': 0.50534406148673, 'recall': 0.15784834105444792, 'f1-score': 0.24055680210372868, 'support': 53317}, '1': {'precision': 0.459295165727761, 'recall': 0.8383170530494147, 'f1-score': 0.5934515169340538, 'support': 83639}, '2': {'precision': 0.47726106628107656, 'recall': 0.190196479357585, 'f1-score': 0.2719974480301983, 'support': 53797}, 'accuracy': 0.4653347522712618, 'macro avg': {'precision': 0.4806334311651892, 'recall': 0.39545395782048254, 'f1-score': 0.36866858902266025, 'support': 190753}, 'weighted avg': {'precision': 0.4772330253013859, 'recall': 0.4653347522712618, 'f1-score': 0.40415671131931047, 'support': 190753}}
[[ 8416 41397  3504]
 [ 5820 70116  7703]
 [ 2418 41147 10232]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
6082/6082 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0510541
{'0': {'precision': 0.4335963107805683, 'recall': 0.1318124759478825, 'f1-score': 0.20216666110391857, 'support': 436552}, '1': {'precision': 0.45759522475843717, 'recall': 0.8397452932398455, 'f1-score': 0.5923863948885554, 'support': 684866}, '2': {'precision': 0.4737883579537642, 'recall': 0.1820286552958092, 'f1-score': 0.26300951622404195, 'support': 435382}, 'accuracy': 0.45728931140801643, 'macro avg': {'precision': 0.45499329783092324, 'recall': 0.38452880816117907, 'f1-score': 0.35252085740550526, 'support': 1556800}, 'weighted avg': {'precision': 0.4553941872597098, 'recall': 0.45728931140801643, 'f1-score': 0.39084736006721416, 'support': 1556800}}
[[ 57543 350834  28175]
 [ 49907 575113  59846]
 [ 25261 330869  79252]]
Evaluating performance on  train set...
2440/2440 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1078131
{'0': {'precision': 0.4662585682343023, 'recall': 0.1215625373312627, 'f1-score': 0.19284634073310414, 'support': 209275}, '1': {'precision': 0.33846784643035566, 'recall': 0.8238394682531224, 'f1-score': 0.4798097148685652, 'support': 206414}, '2': {'precision': 0.46631955743573056, 'recall': 0.15091720281862744, 'f1-score': 0.22803451692935311, 'support': 208896}, 'accuracy': 0.3634701441757327, 'macro avg': {'precision': 0.4236819907001295, 'recall': 0.3654397361343375, 'f1-score': 0.3002301908436742, 'support': 624585}, 'weighted avg': {'precision': 0.42404645354980247, 'recall': 0.3634701441757327, 'f1-score': 0.2994514099606531, 'support': 624585}}
[[ 25440 168080  15755]
 [ 16037 170052  20325]
 [ 13085 164285  31526]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0726645
{'0': {'precision': 0.45981176979662486, 'recall': 0.13105276951300354, 'f1-score': 0.20397096754843744, 'support': 64867}, '1': {'precision': 0.4063928283618524, 'recall': 0.8241735956195498, 'f1-score': 0.5443643383366821, 'support': 83827}, '2': {'precision': 0.4508650368239857, 'recall': 0.16489226061456075, 'f1-score': 0.24147226663243512, 'support': 62744}, 'accuracy': 0.41589023732725433, 'macro avg': {'precision': 0.43902321166082103, 'recall': 0.3733728752490381, 'f1-score': 0.3299358575058516, 'support': 211438}, 'weighted avg': {'precision': 0.43597828945114325, 'recall': 0.41589023732725433, 'f1-score': 0.35005226136881284, 'support': 211438}}
[[ 8501 51765  4601]
 [ 6739 69088  8000]
 [ 3248 49150 10346]]
testing model on single stock: results/universal/W3/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
13689/13689 - 88s - 88s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932351
{'0': {'precision': 0.459963910945144, 'recall': 0.12196056375479658, 'f1-score': 0.19279978871710632, 'support': 1143263}, '1': {'precision': 0.34272424758826664, 'recall': 0.7880832780046756, 'f1-score': 0.47770330914524467, 'support': 1213958}, '2': {'precision': 0.4465782651362396, 'recall': 0.15949054114963893, 'f1-score': 0.2350393500986402, 'support': 1147021}, 'accuracy': 0.3650067546704822, 'macro avg': {'precision': 0.41642214122321675, 'recall': 0.3565114609697037, 'f1-score': 0.30184748265366373, 'support': 3504242}, 'weighted avg': {'precision': 0.41496769090932356, 'recall': 0.3650067546704822, 'f1-score': 0.30532357325804566, 'support': 3504242}}
[[139433 924422  79408]
 [109959 956700 147299]
 [ 53747 910335 182939]]
Evaluating performance on  train set...
5475/5475 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1039504
{'0': {'precision': 0.4643848410307678, 'recall': 0.0758181978278751, 'f1-score': 0.13035403066197973, 'support': 465627}, '1': {'precision': 0.3267988408584691, 'recall': 0.8344018571996749, 'f1-score': 0.46965448815008176, 'support': 462632}, '2': {'precision': 0.4475731855187944, 'recall': 0.1364783036766912, 'f1-score': 0.20917343850940126, 'support': 473306}, 'accuracy': 0.3466981552764231, 'macro avg': {'precision': 0.4129189558026771, 'recall': 0.3488994529014137, 'f1-score': 0.26972731910715425, 'support': 1401565}, 'weighted avg': {'precision': 0.41329285182194697, 'recall': 0.3466981552764231, 'f1-score': 0.268968328178875, 'support': 1401565}}
[[ 35303 400778  29546]
 [ 26428 386021  50183]
 [ 14290 394420  64596]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.092582
{'0': {'precision': 0.4634146341463415, 'recall': 0.10024617951715913, 'f1-score': 0.16483511175302748, 'support': 170201}, '1': {'precision': 0.3412131595212412, 'recall': 0.8088240209459083, 'f1-score': 0.4799521343675572, 'support': 179510}, '2': {'precision': 0.45073962738404577, 'recall': 0.1547476749948981, 'f1-score': 0.23039594419799814, 'support': 171505}, 'accuracy': 0.36221835093320237, 'macro avg': {'precision': 0.4184558070172095, 'recall': 0.35460595848598847, 'f1-score': 0.2917277301061943, 'support': 521216}, 'weighted avg': {'precision': 0.41715701015797724, 'recall': 0.36221835093320237, 'f1-score': 0.29493600523674424, 'support': 521216}}
[[ 17062 141667  11472]
 [ 13449 145192  20869]
 [  6307 138658  26540]]
training model: results/universal/W3/deepOF_L1/h100
Epoch 1/50
10532/10532 - 145s - loss: 3.2396 - accuracy100: 0.4036 - val_loss: 3.2596 - val_accuracy100: 0.3772 - 145s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 141s - loss: 3.2307 - accuracy100: 0.4095 - val_loss: 3.2677 - val_accuracy100: 0.3767 - 141s/epoch - 13ms/step
Epoch 3/50
10532/10532 - 138s - loss: 3.2241 - accuracy100: 0.4132 - val_loss: 3.2640 - val_accuracy100: 0.3783 - 138s/epoch - 13ms/step
Epoch 4/50
10532/10532 - 143s - loss: 3.2196 - accuracy100: 0.4152 - val_loss: 3.2659 - val_accuracy100: 0.3793 - 143s/epoch - 14ms/step
Epoch 5/50
10532/10532 - 138s - loss: 3.2157 - accuracy100: 0.4168 - val_loss: 3.2672 - val_accuracy100: 0.3785 - 138s/epoch - 13ms/step
Epoch 6/50
10532/10532 - 138s - loss: 3.2122 - accuracy100: 0.4184 - val_loss: 3.2667 - val_accuracy100: 0.3800 - 138s/epoch - 13ms/step
Epoch 7/50
10532/10532 - 137s - loss: 3.2095 - accuracy100: 0.4193 - val_loss: 3.2650 - val_accuracy100: 0.3815 - 137s/epoch - 13ms/step
Epoch 8/50
10532/10532 - 139s - loss: 3.2068 - accuracy100: 0.4204 - val_loss: 3.2632 - val_accuracy100: 0.3829 - 139s/epoch - 13ms/step
Epoch 9/50
10532/10532 - 140s - loss: 3.2046 - accuracy100: 0.4215 - val_loss: 3.2700 - val_accuracy100: 0.3823 - 140s/epoch - 13ms/step
Epoch 10/50
10532/10532 - 138s - loss: 3.2023 - accuracy100: 0.4222 - val_loss: 3.2686 - val_accuracy100: 0.3829 - 138s/epoch - 13ms/step
Epoch 11/50
10532/10532 - 137s - loss: 3.2005 - accuracy100: 0.4230 - val_loss: 3.2716 - val_accuracy100: 0.3839 - 137s/epoch - 13ms/step
testing model in sample: results/universal/W3/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 137s - 137s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0928348
{'0': {'precision': 0.4441112561341082, 'recall': 0.10374019452963124, 'f1-score': 0.1681922647036285, 'support': 2348434}, '1': {'precision': 0.34369167233288167, 'recall': 0.7724062957455309, 'f1-score': 0.4757102317143133, 'support': 2412804}, '2': {'precision': 0.4266492378477919, 'recall': 0.20466115234737028, 'f1-score': 0.2766262872342806, 'support': 2325219}, 'accuracy': 0.3645226380404199, 'macro avg': {'precision': 0.40481738877159396, 'recall': 0.3602692142075108, 'f1-score': 0.30684292788407413, 'support': 7086457}, 'weighted avg': {'precision': 0.40419063145923545, 'recall': 0.3645226380404199, 'f1-score': 0.30847582675867924, 'support': 7086457}}
[[ 243627 1832233  272574]
 [ 182201 1863665  366938]
 [ 122744 1726593  475882]]
Evaluating performance on  train set...
10532/10532 - 70s - 70s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0938945
{'0': {'precision': 0.4439966843078493, 'recall': 0.07806960698357031, 'f1-score': 0.1327902116038873, 'support': 891922}, '1': {'precision': 0.3384222586470652, 'recall': 0.8069143859525093, 'f1-score': 0.47685157078743373, 'support': 905272}, '2': {'precision': 0.43650245075493765, 'recall': 0.1848267711540837, 'f1-score': 0.2596927224056839, 'support': 898609}, 'accuracy': 0.35840749490968, 'macro avg': {'precision': 0.4063071312366174, 'recall': 0.35660358803005443, 'f1-score': 0.2897781682656683, 'support': 2695803}, 'weighted avg': {'precision': 0.406045855858761, 'recall': 0.35840749490968, 'f1-score': 0.2906299547453183, 'support': 2695803}}
[[ 69632 730603  91687]
 [ 52074 730477 122721]
 [ 35124 697398 166087]]
Evaluating performance on  val set...
3814/3814 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0861771
{'0': {'precision': 0.4306108897742364, 'recall': 0.09142084538810767, 'f1-score': 0.15082152645085245, 'support': 312117}, '1': {'precision': 0.36257303804143914, 'recall': 0.7886341716744566, 'f1-score': 0.49676111322803057, 'support': 350454}, '2': {'precision': 0.4263727460351944, 'recall': 0.2004801077688715, 'f1-score': 0.27272510145279977, 'support': 313263}, 'accuracy': 0.3768233121616996, 'macro avg': {'precision': 0.40651889128362334, 'recall': 0.36017837494381194, 'f1-score': 0.3067692470438943, 'support': 975834}, 'weighted avg': {'precision': 0.40481573310487534, 'recall': 0.3768233121616996, 'f1-score': 0.3141933617837515, 'support': 975834}}
[[ 28534 249584  33999]
 [ 23580 276380  50494]
 [ 14150 236310  62803]]
testing model out of sample: results/universal/W3/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 91s - 91s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0848204
{'0': {'precision': 0.4056178484774525, 'recall': 0.08679056908071577, 'f1-score': 0.14298619862441736, 'support': 1302100}, '1': {'precision': 0.38156067648367925, 'recall': 0.7961965675655462, 'f1-score': 0.515891203334591, 'support': 1564429}, '2': {'precision': 0.40274571003872844, 'recall': 0.18818124691908272, 'f1-score': 0.2565095026179697, 'support': 1269914}, 'accuracy': 0.3862199962624893, 'macro avg': {'precision': 0.3966414116666201, 'recall': 0.3570561278551149, 'f1-score': 0.30512896819232604, 'support': 4136443}, 'weighted avg': {'precision': 0.3956375087656952, 'recall': 0.3862199962624893, 'f1-score': 0.3188736063999869, 'support': 4136443}}
[[ 113010 1051261  137829]
 [ 102277 1245593  216559]
 [  63325  967615  238974]]
Evaluating performance on  train set...
6181/6181 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003581
{'0': {'precision': 0.4135062191005208, 'recall': 0.09496298149643462, 'f1-score': 0.15445491442550327, 'support': 527574}, '1': {'precision': 0.33018125536729437, 'recall': 0.7732273499763908, 'f1-score': 0.46275727026799757, 'support': 523101}, '2': {'precision': 0.4139248242844046, 'recall': 0.18362505272037116, 'f1-score': 0.25439539227245694, 'support': 531104}, 'accuracy': 0.34903738132823864, 'macro avg': {'precision': 0.3858707662507399, 'recall': 0.35060512806439886, 'f1-score': 0.2905358589886526, 'support': 1581779}, 'weighted avg': {'precision': 0.38609085389069503, 'recall': 0.34903738132823864, 'f1-score': 0.28996819294923704, 'support': 1581779}}
[[ 50100 417444  60030]
 [ 40571 404476  78054]
 [ 30488 403092  97524]]
Evaluating performance on  val set...
2209/2209 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0950055
{'0': {'precision': 0.4142776474676397, 'recall': 0.10200807508222146, 'f1-score': 0.1637065040615519, 'support': 186995}, '1': {'precision': 0.3479283965657403, 'recall': 0.7681970197490208, 'f1-score': 0.4789382150446103, 'support': 195554}, '2': {'precision': 0.4110222631306449, 'recall': 0.19609500650466305, 'f1-score': 0.2655151398034873, 'support': 182177}, 'accuracy': 0.3630486288925957, 'macro avg': {'precision': 0.3910761023880083, 'recall': 0.35543336711196843, 'f1-score': 0.30271995296988313, 'support': 564726}, 'weighted avg': {'precision': 0.3902519826970594, 'recall': 0.3630486288925957, 'f1-score': 0.3057081364339583, 'support': 564726}}
[[ 19075 146128  21792]
 [ 15931 150224  29399]
 [ 11038 135415  35724]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1343328
{'0': {'precision': 0.41966472028630625, 'recall': 0.033875627185646955, 'f1-score': 0.06269080881835705, 'support': 65770}, '1': {'precision': 0.2564246531139077, 'recall': 0.8917742116485243, 'f1-score': 0.39831583168341644, 'support': 44555}, '2': {'precision': 0.37908446949501107, 'recall': 0.07892107892107893, 'f1-score': 0.13064363712725746, 'support': 63063}, 'accuracy': 0.2707107758322375, 'macro avg': {'precision': 0.35172461429840834, 'recall': 0.3348569725850834, 'f1-score': 0.19721675920967696, 'support': 173388}, 'weighted avg': {'precision': 0.3629579496417538, 'recall': 0.2707107758322375, 'f1-score': 0.17365051828727596, 'support': 173388}}
[[ 2228 58892  4650]
 [ 1320 39733  3502]
 [ 1761 56325  4977]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021544
{'0': {'precision': 0.4370139968895801, 'recall': 0.03839322311791228, 'f1-score': 0.07058528008038181, 'support': 21957}, '1': {'precision': 0.33356994372052934, 'recall': 0.899425811155669, 'f1-score': 0.48665442037651185, 'support': 21944}, '2': {'precision': 0.41767068273092367, 'recall': 0.09738696156247213, 'f1-score': 0.15794612185861506, 'support': 22426}, 'accuracy': 0.34320864806187523, 'macro avg': {'precision': 0.39608487444701107, 'recall': 0.34506866527868446, 'f1-score': 0.23839527410516959, 'support': 66327}, 'weighted avg': {'precision': 0.3962497611173655, 'recall': 0.34320864806187523, 'f1-score': 0.2377777575386859, 'support': 66327}}
[[  843 19701  1413]
 [  575 19737  1632]
 [  511 19731  2184]]
Evaluating performance on  val set...
86/86 - 1s - 596ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063178
{'0': {'precision': 0.41187384044526903, 'recall': 0.02996355783506546, 'f1-score': 0.05586311021640664, 'support': 7409}, '1': {'precision': 0.3439825831603463, 'recall': 0.9055044648807143, 'f1-score': 0.4985690173919424, 'support': 7503}, '2': {'precision': 0.36496350364963503, 'recall': 0.0854457419538593, 'f1-score': 0.1384721901684745, 'support': 7022}, 'accuracy': 0.3472234886477615, 'macro avg': {'precision': 0.3736066424184168, 'recall': 0.340304588223213, 'f1-score': 0.23096810592560782, 'support': 21934}, 'weighted avg': {'precision': 0.3736321841861409, 'recall': 0.3472234886477615, 'f1-score': 0.2337469153117593, 'support': 21934}}
[[ 222 6688  499]
 [ 164 6794  545]
 [ 153 6269  600]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0372959
{'0': {'precision': 0.4541719450816585, 'recall': 0.14235123678703654, 'f1-score': 0.21676253349892147, 'support': 93185}, '1': {'precision': 0.5212121621347883, 'recall': 0.8323287434899344, 'f1-score': 0.6410147815977414, 'support': 185482}, '2': {'precision': 0.41457687397410176, 'recall': 0.20071300854285778, 'f1-score': 0.27047729537578274, 'support': 90602}, 'accuracy': 0.5032428933920801, 'macro avg': {'precision': 0.46332032706351617, 'recall': 0.3917976629399429, 'f1-score': 0.3760848701574819, 'support': 369269}, 'weighted avg': {'precision': 0.4781310667706217, 'recall': 0.5032428933920801, 'f1-score': 0.44304153427459636, 'support': 369269}}
[[ 13265  73543   6377]
 [ 11798 154382  19302]
 [  4144  68273  18185]]
Evaluating performance on  train set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0885768
{'0': {'precision': 0.4972985141828005, 'recall': 0.11982425053339602, 'f1-score': 0.19311691339316936, 'support': 55306}, '1': {'precision': 0.341088565732742, 'recall': 0.816857883049593, 'f1-score': 0.481232761722029, 'support': 54040}, '2': {'precision': 0.4740740740740741, 'recall': 0.18476830872679434, 'f1-score': 0.2659023376896579, 'support': 54728}, 'accuracy': 0.3710642758755196, 'macro avg': {'precision': 0.43748705132987215, 'recall': 0.3738168141032611, 'f1-score': 0.3134173376016188, 'support': 164074}, 'weighted avg': {'precision': 0.43810197620291613, 'recall': 0.3710642758755196, 'f1-score': 0.3122898545330806, 'support': 164074}}
[[ 6627 43673  5006]
 [ 3685 44143  6212]
 [ 3014 41602 10112]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0725726
{'0': {'precision': 0.4781912052697169, 'recall': 0.12455367493623927, 'f1-score': 0.19763078507836068, 'support': 21565}, '1': {'precision': 0.3844573713870205, 'recall': 0.8177635140360374, 'f1-score': 0.523024037985953, 'support': 25862}, '2': {'precision': 0.49141653501843074, 'recall': 0.205595946243666, 'f1-score': 0.2899036968002485, 'support': 22695}, 'accuracy': 0.4064487607312969, 'macro avg': {'precision': 0.45135503722505604, 'recall': 0.3826377117386475, 'f1-score': 0.33685283995485404, 'support': 70122}, 'weighted avg': {'precision': 0.4479012027993477, 'recall': 0.4064487607312969, 'f1-score': 0.3475046340590571, 'support': 70122}}
[[ 2686 17025  1854]
 [ 1738 21149  2975]
 [ 1193 16836  4666]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879992
{'0': {'precision': 0.3417788874790226, 'recall': 0.0801174416150141, 'f1-score': 0.12980653385463223, 'support': 104222}, '1': {'precision': 0.40492554410080184, 'recall': 0.7498028927666879, 'f1-score': 0.5258627650074013, 'support': 143323}, '2': {'precision': 0.3218684237761755, 'recall': 0.18613095000598492, 'f1-score': 0.2358651549050093, 'support': 100252}, 'accuracy': 0.3866450831950822, 'macro avg': {'precision': 0.3561909517853333, 'recall': 0.33868376146256235, 'f1-score': 0.297178151255681, 'support': 347797}, 'weighted avg': {'precision': 0.3620617089520814, 'recall': 0.3866450831950822, 'f1-score': 0.3235878375894279, 'support': 347797}}
[[  8350  81686  14186]
 [ 10731 107464  25128]
 [  5350  76242  18660]]
Evaluating performance on  train set...
444/444 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1009167
{'0': {'precision': 0.42418617932609937, 'recall': 0.07993650281163397, 'f1-score': 0.1345226506078649, 'support': 37167}, '1': {'precision': 0.33072280255066666, 'recall': 0.7693080563707992, 'f1-score': 0.4625828709518435, 'support': 37821}, '2': {'precision': 0.4054388133498146, 'recall': 0.19544041450777203, 'f1-score': 0.26374394741902213, 'support': 38600}, 'accuracy': 0.3487252174525478, 'macro avg': {'precision': 0.3867825984088602, 'recall': 0.34822832456340175, 'f1-score': 0.28694982299291016, 'support': 113588}, 'weighted avg': {'precision': 0.3866951882028449, 'recall': 0.3487252174525478, 'f1-score': 0.28766829671960453, 'support': 113588}}
[[ 2971 29431  4765]
 [ 2427 29096  6298]
 [ 1606 29450  7544]]
Evaluating performance on  val set...
144/144 - 1s - 859ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014278
{'0': {'precision': 0.42366277010272757, 'recall': 0.0964983056317573, 'f1-score': 0.15719261352434777, 'support': 12394}, '1': {'precision': 0.3188287198462962, 'recall': 0.7560111364211592, 'f1-score': 0.44850972246552717, 'support': 11853}, '2': {'precision': 0.41904428496411694, 'recall': 0.19314239612747075, 'f1-score': 0.2644135188866799, 'support': 12395}, 'accuracy': 0.34253042956170515, 'macro avg': {'precision': 0.38717859163771357, 'recall': 0.3485506127267957, 'f1-score': 0.29003861829218497, 'support': 36642}, 'weighted avg': {'precision': 0.38818861146011635, 'recall': 0.34253042956170515, 'f1-score': 0.28769817583660984, 'support': 36642}}
[[1196 9761 1437]
 [1010 8961 1882]
 [ 617 9384 2394]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953972
{'0': {'precision': 0.38540652385589097, 'recall': 0.06781167350172929, 'f1-score': 0.11533103266164646, 'support': 93391}, '1': {'precision': 0.3497091472553154, 'recall': 0.8073934334893995, 'f1-score': 0.48803429155502515, 'support': 102307}, '2': {'precision': 0.4150691610850207, 'recall': 0.1686495730060582, 'f1-score': 0.23984577741528879, 'support': 95903}, 'accuracy': 0.36045486812459493, 'macro avg': {'precision': 0.38339494406540897, 'recall': 0.34795155999906235, 'f1-score': 0.2810703672106535, 'support': 291601}, 'weighted avg': {'precision': 0.3826378241268439, 'recall': 0.36045486812459493, 'f1-score': 0.2870433720353573, 'support': 291601}}
[[ 6333 78060  8998]
 [ 5910 82602 13795]
 [ 4189 75540 16174]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0982919
{'0': {'precision': 0.47517146776406033, 'recall': 0.051949610077984404, 'f1-score': 0.09365959172637556, 'support': 33340}, '1': {'precision': 0.3343832285537903, 'recall': 0.8164954162308496, 'f1-score': 0.47445901375593275, 'support': 32506}, '2': {'precision': 0.4298051948051948, 'recall': 0.2032113471693479, 'f1-score': 0.2759526390394397, 'support': 32572}, 'accuracy': 0.354528643134386, 'macro avg': {'precision': 0.41311996370768184, 'recall': 0.357218791159394, 'f1-score': 0.2813570815072493, 'support': 98418}, 'weighted avg': {'precision': 0.41365698111949123, 'recall': 0.354528643134386, 'f1-score': 0.27976289751976613, 'support': 98418}}
[[ 1732 27688  3920]
 [ 1104 26541  4861]
 [  809 25144  6619]]
Evaluating performance on  val set...
139/139 - 1s - 855ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0914112
{'0': {'precision': 0.3911764705882353, 'recall': 0.07962028564098178, 'f1-score': 0.13231009734953458, 'support': 11693}, '1': {'precision': 0.36671514647828796, 'recall': 0.8284440272236564, 'f1-score': 0.5083891409231656, 'support': 12783}, '2': {'precision': 0.4276683685874058, 'recall': 0.1614502065167508, 'f1-score': 0.234408315565032, 'support': 10895}, 'accuracy': 0.3754488140001696, 'macro avg': {'precision': 0.3951866618846431, 'recall': 0.35650483979379627, 'f1-score': 0.29170251794591073, 'support': 35371}, 'weighted avg': {'precision': 0.39357646274575153, 'recall': 0.3754488140001696, 'f1-score': 0.29967258360832194, 'support': 35371}}
[[  931  9712  1050]
 [  889 10590  1304]
 [  560  8576  1759]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1061887
{'0': {'precision': 0.3985668477193901, 'recall': 0.06125538077805045, 'f1-score': 0.10619044713143694, 'support': 198856}, '1': {'precision': 0.3183594980715954, 'recall': 0.7783438340009137, 'f1-score': 0.4518872972718735, 'support': 188242}, '2': {'precision': 0.4086305308785031, 'recall': 0.19343501292580234, 'f1-score': 0.2625742424085737, 'support': 196893}, 'accuracy': 0.3369640970494408, 'macro avg': {'precision': 0.3751856255564962, 'recall': 0.3443447425682555, 'f1-score': 0.2735506622706281, 'support': 583991}, 'weighted avg': {'precision': 0.37610601674056865, 'recall': 0.3369640970494408, 'f1-score': 0.27034630067650417, 'support': 583991}}
[[ 12181 162387  24288]
 [ 10895 146517  30830]
 [  7486 151321  38086]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1044184
{'0': {'precision': 0.4004809822163154, 'recall': 0.08464532698404205, 'f1-score': 0.13975265017667846, 'support': 74759}, '1': {'precision': 0.32796054156813653, 'recall': 0.759295787877568, 'f1-score': 0.4580687204271045, 'support': 74523}, '2': {'precision': 0.40198879244039115, 'recall': 0.19393312924899614, 'f1-score': 0.26164147215790745, 'support': 75459}, 'accuracy': 0.3450505248263557, 'macro avg': {'precision': 0.376810105408281, 'recall': 0.34595808137020206, 'f1-score': 0.2864876142538968, 'support': 224741}, 'weighted avg': {'precision': 0.3769398261890409, 'recall': 0.3450505248263557, 'f1-score': 0.28623004914328476, 'support': 224741}}
[[ 6328 58916  9515]
 [ 5683 56585 12255]
 [ 3790 57035 14634]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994921
{'0': {'precision': 0.3922346850733391, 'recall': 0.09047486367073997, 'f1-score': 0.14703409017400867, 'support': 25123}, '1': {'precision': 0.3447548851559822, 'recall': 0.7494224606900663, 'f1-score': 0.4722580948132148, 'support': 26838}, '2': {'precision': 0.3971432889963724, 'recall': 0.20684090372352987, 'f1-score': 0.2720120089031523, 'support': 25406}, 'accuracy': 0.3572711879742009, 'macro avg': {'precision': 0.3780442864085645, 'recall': 0.34891274269477873, 'f1-score': 0.29710139796345864, 'support': 77367}, 'weighted avg': {'precision': 0.3773762198502667, 'recall': 0.3572711879742009, 'f1-score': 0.30089233515881664, 'support': 77367}}
[[ 2273 19486  3364]
 [ 2112 20113  4613]
 [ 1410 18741  5255]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/EXC
Evaluating performance on  test set...
5098/5098 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0846096
{'0': {'precision': 0.4283407795935453, 'recall': 0.12051482340499682, 'f1-score': 0.1881056260621317, 'support': 416065}, '1': {'precision': 0.38007825992708844, 'recall': 0.7755741537291313, 'f1-score': 0.5101514457295675, 'support': 483799}, '2': {'precision': 0.41408512483613547, 'recall': 0.20510168056231068, 'f1-score': 0.2743261137326513, 'support': 405043}, 'accuracy': 0.38963619629598123, 'macro avg': {'precision': 0.40750138811892306, 'recall': 0.36706355256547957, 'f1-score': 0.3241943951747835, 'support': 1304907}, 'weighted avg': {'precision': 0.40602232170955993, 'recall': 0.38963619629598123, 'f1-score': 0.33426811158548014, 'support': 1304907}}
[[ 50142 318134  47789]
 [ 38818 375222  69759]
 [ 28101 293867  83075]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786628
{'0': {'precision': 0.4238831897462382, 'recall': 0.11971121335472494, 'f1-score': 0.18669644380340888, 'support': 150838}, '1': {'precision': 0.38000476446374853, 'recall': 0.7729155046228217, 'f1-score': 0.5095089090892209, 'support': 177489}, '2': {'precision': 0.4554830287206266, 'recall': 0.22972385730652234, 'f1-score': 0.3054123372928685, 'support': 151878}, 'accuracy': 0.39593715184140105, 'macro avg': {'precision': 0.4197903276435378, 'recall': 0.37411685842802295, 'f1-score': 0.3338725633951661, 'support': 480205}, 'weighted avg': {'precision': 0.41765956133501453, 'recall': 0.39593715184140105, 'f1-score': 0.34355860501061336, 'support': 480205}}
[[ 18057 116379  16402]
 [ 14997 137184  25308]
 [  9545 107443  34890]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0754503
{'0': {'precision': 0.4143817204301075, 'recall': 0.128023586570604, 'f1-score': 0.19561251843979507, 'support': 48163}, '1': {'precision': 0.3971772484529965, 'recall': 0.7685305165089311, 'f1-score': 0.5237038734303134, 'support': 60967}, '2': {'precision': 0.4437739989029073, 'recall': 0.23000690467487103, 'f1-score': 0.30298004387138194, 'support': 49242}, 'accuracy': 0.40630288182254437, 'macro avg': {'precision': 0.4184443225953371, 'recall': 0.3755203359181354, 'f1-score': 0.34076547858049683, 'support': 158372}, 'weighted avg': {'precision': 0.4168975031033647, 'recall': 0.40630288182254437, 'f1-score': 0.3552981783229129, 'support': 158372}}
[[ 6166 36564  5433]
 [ 5349 46855  8763]
 [ 3365 34551 11326]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/AAL
Evaluating performance on  test set...
5760/5760 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0663791
{'0': {'precision': 0.4242538723082735, 'recall': 0.08675732810184546, 'f1-score': 0.14405606909902274, 'support': 427157}, '1': {'precision': 0.4395375645287936, 'recall': 0.8242564370068565, 'f1-score': 0.5733397475046567, 'support': 638379}, '2': {'precision': 0.37945319408767425, 'recall': 0.1762815731749366, 'f1-score': 0.240728527133595, 'support': 408931}, 'accuracy': 0.4308906201359542, 'macro avg': {'precision': 0.4144148769749138, 'recall': 0.3624317794278795, 'f1-score': 0.31937478124575813, 'support': 1474467}, 'weighted avg': {'precision': 0.4184459444337368, 'recall': 0.4308906201359542, 'f1-score': 0.3567282077589221, 'support': 1474467}}
[[ 37059 350532  39566]
 [ 33868 526188  78323]
 [ 16424 320420  72087]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963242
{'0': {'precision': 0.4419383704655485, 'recall': 0.10426116987300935, 'f1-score': 0.16871860231866537, 'support': 184738}, '1': {'precision': 0.33747808783815797, 'recall': 0.7795129104449029, 'f1-score': 0.4710307009930584, 'support': 182759}, '2': {'precision': 0.4283706732707481, 'recall': 0.2009770807550759, 'f1-score': 0.2735933729621564, 'support': 185041}, 'accuracy': 0.3599987693154136, 'macro avg': {'precision': 0.4025957105248182, 'recall': 0.3615837203576627, 'f1-score': 0.30444755875796004, 'support': 552538}, 'weighted avg': {'precision': 0.4028430737631999, 'recall': 0.3599987693154136, 'f1-score': 0.3038339957871247, 'support': 552538}}
[[ 19261 143092  22385]
 [ 13055 142463  27241]
 [ 11267 136585  37189]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0905485
{'0': {'precision': 0.4244251984740695, 'recall': 0.11745823406046253, 'f1-score': 0.18399615603803732, 'support': 70093}, '1': {'precision': 0.3634705110109894, 'recall': 0.7636683846572221, 'f1-score': 0.49252304056057356, 'support': 77222}, '2': {'precision': 0.4142577030812325, 'recall': 0.2111809224618021, 'f1-score': 0.2797503073867398, 'support': 70030}, 'accuracy': 0.3772527548367802, 'macro avg': {'precision': 0.4007178041887638, 'recall': 0.36410251372649555, 'f1-score': 0.3187565013284502, 'support': 217345}, 'weighted avg': {'precision': 0.39949215387845266, 'recall': 0.3772527548367802, 'f1-score': 0.3244674173762274, 'support': 217345}}
[[ 8233 52950  8910]
 [ 6249 58972 12001]
 [ 4916 50325 14789]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/WBA
Evaluating performance on  test set...
6315/6315 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0821728
{'0': {'precision': 0.4563366444711276, 'recall': 0.11199260615732581, 'f1-score': 0.1798476148918877, 'support': 522597}, '1': {'precision': 0.36773140232387186, 'recall': 0.774780988107727, 'f1-score': 0.4987452243613754, 'support': 584329}, '2': {'precision': 0.43194488210419024, 'recall': 0.21791635918290442, 'f1-score': 0.2896860132461735, 'support': 509512}, 'accuracy': 0.38497300855337474, 'macro avg': {'precision': 0.4186709762997299, 'recall': 0.3682299844826524, 'f1-score': 0.3227596174998122, 'support': 1616438}, 'weighted avg': {'precision': 0.4166181349051765, 'recall': 0.38497300855337474, 'f1-score': 0.32974826265319074, 'support': 1616438}}
[[ 58527 404940  59130]
 [ 44714 452727  86888]
 [ 25013 373468 111031]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0915854
{'0': {'precision': 0.4681180829680575, 'recall': 0.1056642141053253, 'f1-score': 0.17241148636896772, 'support': 182938}, '1': {'precision': 0.3348343420799715, 'recall': 0.7846423431440405, 'f1-score': 0.46937145936567604, 'support': 182046}, '2': {'precision': 0.449142816153791, 'recall': 0.20138081122659562, 'f1-score': 0.27807981406572096, 'support': 186557}, 'accuracy': 0.36214896082068243, 'macro avg': {'precision': 0.41736508040060666, 'recall': 0.36389578949198714, 'f1-score': 0.3066209199334549, 'support': 551541}, 'weighted avg': {'precision': 0.41770706956237846, 'recall': 0.36214896082068243, 'f1-score': 0.3061704298641602, 'support': 551541}}
[[ 19330 143504  20104]
 [ 13232 142841  25973]
 [  8731 140257  37569]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0853411
{'0': {'precision': 0.4581093898197913, 'recall': 0.11712119497567047, 'f1-score': 0.1865489095450215, 'support': 61859}, '1': {'precision': 0.35682586497127194, 'recall': 0.7680721087620531, 'f1-score': 0.4872761814295891, 'support': 66788}, '2': {'precision': 0.43831793687451887, 'recall': 0.22002705052651916, 'f1-score': 0.2929825689843699, 'support': 62106}, 'accuracy': 0.37854188400706673, 'macro avg': {'precision': 0.4177510638885274, 'recall': 0.3684067847547476, 'f1-score': 0.32226921998632685, 'support': 190753}, 'weighted avg': {'precision': 0.4162034065104751, 'recall': 0.37854188400706673, 'f1-score': 0.32649502775950134, 'support': 190753}}
[[ 7245 47396  7218]
 [ 5197 51298 10293]
 [ 3373 45068 13665]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
6082/6082 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0880927
{'0': {'precision': 0.40767342068427453, 'recall': 0.10531224374870331, 'f1-score': 0.1673848047836792, 'support': 506095}, '1': {'precision': 0.35845720922750124, 'recall': 0.7738948593457349, 'f1-score': 0.4899680924610597, 'support': 549930}, '2': {'precision': 0.4382878393205632, 'recall': 0.20899006539863213, 'f1-score': 0.28302465922351233, 'support': 500775}, 'accuracy': 0.37483491778006167, 'macro avg': {'precision': 0.4014728230774463, 'recall': 0.3627323894976901, 'f1-score': 0.3134591854894171, 'support': 1556800}, 'weighted avg': {'precision': 0.400135820688234, 'recall': 0.37483491778006167, 'f1-score': 0.3185331703409308, 'support': 1556800}}
[[ 53298 397726  55071]
 [ 45284 425588  79058]
 [ 32155 363963 104657]]
Evaluating performance on  train set...
2440/2440 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102251
{'0': {'precision': 0.39028466169125886, 'recall': 0.09835704679999809, 'f1-score': 0.15711817500726266, 'support': 208953}, '1': {'precision': 0.3243185628246787, 'recall': 0.7604851155522339, 'f1-score': 0.45471718918667947, 'support': 206054}, '2': {'precision': 0.40567398260399296, 'recall': 0.17180238383799826, 'f1-score': 0.24138046618890238, 'support': 209578}, 'accuracy': 0.34144111690162265, 'macro avg': {'precision': 0.3734257357066435, 'recall': 0.3435481820634101, 'f1-score': 0.2844052767942815, 'support': 624585}, 'weighted avg': {'precision': 0.37368593543685746, 'recall': 0.34144111690162265, 'f1-score': 0.28357172373000056, 'support': 624585}}
[[ 20552 166234  22167]
 [ 18770 156701  30583]
 [ 13337 160235  36006]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957575
{'0': {'precision': 0.40915277305205855, 'recall': 0.10024174724908302, 'f1-score': 0.16103113491797788, 'support': 71976}, '1': {'precision': 0.33723525588354325, 'recall': 0.7623859824225789, 'f1-score': 0.4676218008672732, 'support': 72138}, '2': {'precision': 0.4065490527960419, 'recall': 0.18552076525458974, 'f1-score': 0.2547783693368419, 'support': 67324}, 'accuracy': 0.35330451479866437, 'macro avg': {'precision': 0.3843123605772146, 'recall': 0.34938283164208395, 'f1-score': 0.29447710170736435, 'support': 211438}, 'weighted avg': {'precision': 0.3837870454344192, 'recall': 0.35330451479866437, 'f1-score': 0.2954832025229773, 'support': 211438}}
[[ 7215 57181  7580]
 [ 6489 54997 10652]
 [ 3930 50904 12490]]
testing model on single stock: results/universal/W3/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
13689/13689 - 85s - 85s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1064416
{'0': {'precision': 0.4466797118622926, 'recall': 0.09368326907543845, 'f1-score': 0.15488261451336047, 'support': 1223196}, '1': {'precision': 0.29896872884726705, 'recall': 0.7559956740881475, 'f1-score': 0.42848662014997535, 'support': 1056887}, '2': {'precision': 0.43051718532401667, 'recall': 0.20227846219322818, 'f1-score': 0.2752368937326672, 'support': 1224159}, 'accuracy': 0.33137437425839883, 'macro avg': {'precision': 0.39205520867785876, 'recall': 0.3506524684522714, 'f1-score': 0.2862020427986676, 'support': 3504242}, 'weighted avg': {'precision': 0.39648360096858987, 'recall': 0.33137437425839883, 'f1-score': 0.27944629784347647, 'support': 3504242}}
[[114593 958402 150201]
 [ 80536 799002 177349]
 [ 61415 915123 247621]]
Evaluating performance on  train set...
5475/5475 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003582
{'0': {'precision': 0.4261761761761762, 'recall': 0.050781682641107564, 'f1-score': 0.0907499181644476, 'support': 469500}, '1': {'precision': 0.32679773980974697, 'recall': 0.8273703099581655, 'f1-score': 0.4685327190167646, 'support': 459191}, '2': {'precision': 0.4176189747847747, 'recall': 0.1616730883914108, 'f1-score': 0.23310434827681883, 'support': 472874}, 'accuracy': 0.34262699196969104, 'macro avg': {'precision': 0.3901976302568993, 'recall': 0.34660836033022796, 'f1-score': 0.264128995152677, 'support': 1401565}, 'weighted avg': {'precision': 0.39072997023903117, 'recall': 0.34262699196969104, 'f1-score': 0.26255084847530274, 'support': 1401565}}
[[ 23842 399292  46366]
 [ 19023 379921  60247]
 [ 13079 383344  76451]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.091169
{'0': {'precision': 0.41940023817256683, 'recall': 0.068835622523499, 'f1-score': 0.11826118810672201, 'support': 168837}, '1': {'precision': 0.3520325632521012, 'recall': 0.7969400284699055, 'f1-score': 0.4883473165534692, 'support': 184054}, '2': {'precision': 0.40912817709756766, 'recall': 0.1867637011733254, 'f1-score': 0.25645690231844803, 'support': 168325}, 'accuracy': 0.36403141883595286, 'macro avg': {'precision': 0.39352032617407856, 'recall': 0.3508464507222433, 'f1-score': 0.28768846899287975, 'support': 521216}, 'weighted avg': {'precision': 0.39229375118778387, 'recall': 0.36403141883595286, 'f1-score': 0.29357742145302446, 'support': 521216}}
[[ 11622 138800  18415]
 [ 10387 146680  26987]
 [  5702 131186  31437]]
training model: results/universal/W3/deepOF_L1/h200
Epoch 1/50
10532/10532 - 142s - loss: 3.2687 - accuracy200: 0.3815 - val_loss: 3.2801 - val_accuracy200: 0.3570 - 142s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 139s - loss: 3.2661 - accuracy200: 0.3826 - val_loss: 3.2791 - val_accuracy200: 0.3585 - 139s/epoch - 13ms/step
Epoch 3/50
10532/10532 - 137s - loss: 3.2644 - accuracy200: 0.3843 - val_loss: 3.2784 - val_accuracy200: 0.3593 - 137s/epoch - 13ms/step
Epoch 4/50
10532/10532 - 141s - loss: 3.2621 - accuracy200: 0.3857 - val_loss: 3.2782 - val_accuracy200: 0.3591 - 141s/epoch - 13ms/step
Epoch 5/50
10532/10532 - 140s - loss: 3.2620 - accuracy200: 0.3857 - val_loss: 3.2776 - val_accuracy200: 0.3599 - 140s/epoch - 13ms/step
Epoch 6/50
10532/10532 - 136s - loss: 3.2614 - accuracy200: 0.3863 - val_loss: 3.2772 - val_accuracy200: 0.3615 - 136s/epoch - 13ms/step
Epoch 7/50
10532/10532 - 135s - loss: 3.2599 - accuracy200: 0.3872 - val_loss: 3.2771 - val_accuracy200: 0.3639 - 135s/epoch - 13ms/step
Epoch 8/50
10532/10532 - 137s - loss: 3.2587 - accuracy200: 0.3880 - val_loss: 3.2767 - val_accuracy200: 0.3642 - 137s/epoch - 13ms/step
Epoch 9/50
10532/10532 - 139s - loss: 3.2577 - accuracy200: 0.3886 - val_loss: 3.2764 - val_accuracy200: 0.3640 - 139s/epoch - 13ms/step
Epoch 10/50
10532/10532 - 135s - loss: 3.2564 - accuracy200: 0.3897 - val_loss: 3.2780 - val_accuracy200: 0.3620 - 135s/epoch - 13ms/step
Epoch 11/50
10532/10532 - 136s - loss: 3.2553 - accuracy200: 0.3906 - val_loss: 3.2785 - val_accuracy200: 0.3585 - 136s/epoch - 13ms/step
Epoch 12/50
10532/10532 - 135s - loss: 3.2541 - accuracy200: 0.3913 - val_loss: 3.2789 - val_accuracy200: 0.3595 - 135s/epoch - 13ms/step
Epoch 13/50
10532/10532 - 136s - loss: 3.2533 - accuracy200: 0.3916 - val_loss: 3.2799 - val_accuracy200: 0.3580 - 136s/epoch - 13ms/step
Epoch 14/50
10532/10532 - 136s - loss: 3.2525 - accuracy200: 0.3924 - val_loss: 3.2799 - val_accuracy200: 0.3579 - 136s/epoch - 13ms/step
Epoch 15/50
10532/10532 - 140s - loss: 3.2516 - accuracy200: 0.3927 - val_loss: 3.2810 - val_accuracy200: 0.3583 - 140s/epoch - 13ms/step
Epoch 16/50
10532/10532 - 138s - loss: 3.2510 - accuracy200: 0.3931 - val_loss: 3.2821 - val_accuracy200: 0.3581 - 138s/epoch - 13ms/step
Epoch 17/50
10532/10532 - 137s - loss: 3.2501 - accuracy200: 0.3937 - val_loss: 3.2833 - val_accuracy200: 0.3572 - 137s/epoch - 13ms/step
Epoch 18/50
10532/10532 - 136s - loss: 3.2493 - accuracy200: 0.3939 - val_loss: 3.2832 - val_accuracy200: 0.3579 - 136s/epoch - 13ms/step
Epoch 19/50
10532/10532 - 136s - loss: 3.2487 - accuracy200: 0.3946 - val_loss: 3.2855 - val_accuracy200: 0.3563 - 136s/epoch - 13ms/step
testing model in sample: results/universal/W3/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 162s - 162s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958117
{'0': {'precision': 0.3939008863524502, 'recall': 0.20352419203988256, 'f1-score': 0.26837962629358847, 'support': 2378985}, '1': {'precision': 0.3383910629221947, 'recall': 0.5529572822087847, 'f1-score': 0.4198488806297225, 'support': 2382052}, '2': {'precision': 0.3716258720971659, 'recall': 0.31399575130514057, 'f1-score': 0.34038875359421794, 'support': 2325420}, 'accuracy': 0.35723436972806016, 'macro avg': {'precision': 0.3679726071239369, 'recall': 0.3568257418512693, 'f1-score': 0.3428724201725097, 'support': 7086457}, 'weighted avg': {'precision': 0.3679321900672388, 'recall': 0.35723436972806016, 'f1-score': 0.342924508882635, 'support': 7086457}}
[[ 484181 1317954  576850]
 [ 407097 1317173  657782]
 [ 337917 1257331  730172]]
Evaluating performance on  train set...
10532/10532 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948802
{'0': {'precision': 0.39340275011994497, 'recall': 0.23477252476834604, 'f1-score': 0.2940585552747033, 'support': 904582}, '1': {'precision': 0.3304982540341809, 'recall': 0.48550086830958145, 'f1-score': 0.3932778477690529, 'support': 885053}, '2': {'precision': 0.37980468129259015, 'recall': 0.35870721543907974, 'f1-score': 0.3689545970488082, 'support': 906168}, 'accuracy': 0.3587480242436113, 'macro avg': {'precision': 0.3679018951489053, 'recall': 0.3596602028390024, 'f1-score': 0.3520970000308548, 'support': 2695803}, 'weighted avg': {'precision': 0.3681798581625801, 'recall': 0.3587480242436113, 'f1-score': 0.35180859445128954, 'support': 2695803}}
[[212371 441320 250891]
 [175467 429694 279892]
 [151993 429126 325049]]
Evaluating performance on  val set...
3814/3814 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924299
{'0': {'precision': 0.39307498816759995, 'recall': 0.22947771040760506, 'f1-score': 0.2897809246016811, 'support': 322101}, '1': {'precision': 0.3433683571859025, 'recall': 0.5043399458673419, 'f1-score': 0.40857067944707653, 'support': 332147}, '2': {'precision': 0.3786045550172872, 'recall': 0.3531123867332533, 'f1-score': 0.3654144121096861, 'support': 321586}, 'accuracy': 0.3637770358483103, 'macro avg': {'precision': 0.37168263345692987, 'recall': 0.36231001433606674, 'f1-score': 0.3545886720528146, 'support': 975834}, 'weighted avg': {'precision': 0.3713874910361674, 'recall': 0.3637770358483103, 'f1-score': 0.35513869182067825, 'support': 975834}}
[[ 73915 162955  85231]
 [ 63486 167515 101146]
 [ 50642 157388 113556]]
testing model out of sample: results/universal/W3/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 88s - 88s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936495
{'0': {'precision': 0.3885346694498476, 'recall': 0.23990698913555814, 'f1-score': 0.2966454608763803, 'support': 1366292}, '1': {'precision': 0.3572354358326346, 'recall': 0.49946475427543, 'f1-score': 0.4165436432414383, 'support': 1453538}, '2': {'precision': 0.357516841774582, 'recall': 0.342294964427664, 'f1-score': 0.3497403546294402, 'support': 1316613}, 'accuracy': 0.3637047579284907, 'macro avg': {'precision': 0.367762315685688, 'recall': 0.36055556927955074, 'f1-score': 0.35430981958241964, 'support': 4136443}, 'weighted avg': {'precision': 0.36766333130194834, 'recall': 0.3637047579284907, 'f1-score': 0.3556773371883321, 'support': 4136443}}
[[327783 666889 371620]
 [289281 725991 438266]
 [226575 639368 450670]]
Evaluating performance on  train set...
6181/6181 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975612
{'0': {'precision': 0.3867055535301981, 'recall': 0.21153944771864383, 'f1-score': 0.27347818720672984, 'support': 526507}, '1': {'precision': 0.3352274135653759, 'recall': 0.5422188196256846, 'f1-score': 0.4143082632620074, 'support': 523783}, '2': {'precision': 0.3756536031870083, 'recall': 0.3156283573131335, 'f1-score': 0.3430349306580836, 'support': 531489}, 'accuracy': 0.3560137035578295, 'macro avg': {'precision': 0.3658621900941941, 'recall': 0.356462208219154, 'f1-score': 0.3436071270422736, 'support': 1581779}, 'weighted avg': {'precision': 0.3659457858122387, 'recall': 0.3560137035578295, 'f1-score': 0.34348356959369925, 'support': 1581779}}
[[111377 282033 133097]
 [ 94065 284005 145713]
 [ 82573 281163 167753]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977752
{'0': {'precision': 0.3995073633457366, 'recall': 0.19793727701871094, 'f1-score': 0.26471875151927654, 'support': 192561}, '1': {'precision': 0.334341591598688, 'recall': 0.5668611173435046, 'f1-score': 0.42060514534071386, 'support': 187194}, '2': {'precision': 0.3675152360769241, 'recall': 0.30189056662936353, 'f1-score': 0.33148617002015357, 'support': 184971}, 'accuracy': 0.3542762330758633, 'macro avg': {'precision': 0.36712139700711627, 'recall': 0.3555629869971931, 'f1-score': 0.338936688960048, 'support': 564726}, 'weighted avg': {'precision': 0.3674276339735162, 'recall': 0.3542762330758633, 'f1-score': 0.3382606705606096, 'support': 564726}}
[[ 38115 107981  46465]
 [ 31445 106113  49636]
 [ 25845 103285  55841]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1006315
{'0': {'precision': 0.334825372518994, 'recall': 0.20141004747396019, 'f1-score': 0.2515208494635549, 'support': 56452}, '1': {'precision': 0.3680442616154852, 'recall': 0.3615701508435018, 'f1-score': 0.36477848276298014, 'support': 63841}, '2': {'precision': 0.3113724058817395, 'recall': 0.4498728693850645, 'f1-score': 0.368023296124246, 'support': 53095}, 'accuracy': 0.3364650379495698, 'macro avg': {'precision': 0.3380806800054062, 'recall': 0.3376176892341755, 'f1-score': 0.3281075427835937, 'support': 173388}, 'weighted avg': {'precision': 0.3398746944744008, 'recall': 0.3364650379495698, 'f1-score': 0.3288974728337882, 'support': 173388}}
[[11370 20504 24578]
 [12510 23083 28248]
 [10078 19131 23886]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955263
{'0': {'precision': 0.390439176059075, 'recall': 0.22884869470135313, 'f1-score': 0.28856207272936174, 'support': 21949}, '1': {'precision': 0.3287676884359916, 'recall': 0.364247188956943, 'f1-score': 0.3455992367239846, 'support': 21878}, '2': {'precision': 0.3711802347466037, 'recall': 0.4820888888888889, 'f1-score': 0.41942656071766915, 'support': 22500}, 'accuracy': 0.3594162256697876, 'macro avg': {'precision': 0.3634623664138901, 'recall': 0.358394924182395, 'f1-score': 0.3511959567236718, 'support': 66327}, 'weighted avg': {'precision': 0.36356362031633943, 'recall': 0.3594162256697876, 'f1-score': 0.35176876161339504, 'support': 66327}}
[[ 5023  8338  8588]
 [ 4121  7969  9788]
 [ 3721  7932 10847]]
Evaluating performance on  val set...
86/86 - 1s - 752ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102578
{'0': {'precision': 0.3893249607535322, 'recall': 0.19165378670788252, 'f1-score': 0.2568617296737441, 'support': 7764}, '1': {'precision': 0.3286259541984733, 'recall': 0.3567186852644662, 'f1-score': 0.3420965498973578, 'support': 7241}, '2': {'precision': 0.3309598127194694, 'recall': 0.4896810506566604, 'f1-score': 0.3949711891042431, 'support': 6929}, 'accuracy': 0.3402936080970183, 'macro avg': {'precision': 0.34963690922382495, 'recall': 0.34601784087633636, 'f1-score': 0.3313098228917817, 'support': 21934}, 'weighted avg': {'precision': 0.35084891364889087, 'recall': 0.3402936080970183, 'f1-score': 0.3286291126241004, 'support': 21934}}
[[1488 2823 3453]
 [1252 2583 3406]
 [1082 2454 3393]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0781629
{'0': {'precision': 0.410671150792062, 'recall': 0.2692166366292803, 'f1-score': 0.3252286863284945, 'support': 114302}, '1': {'precision': 0.39789831160093553, 'recall': 0.4228870290037659, 'f1-score': 0.4100122809565941, 'support': 146843}, '2': {'precision': 0.3548921336775799, 'recall': 0.4538492841552292, 'f1-score': 0.3983165379448614, 'support': 108124}, 'accuracy': 0.3843864499863243, 'macro avg': {'precision': 0.3878205320235258, 'recall': 0.38198431659609183, 'f1-score': 0.3778525017433167, 'support': 369269}, 'weighted avg': {'precision': 0.3892595173437388, 'recall': 0.3843864499863243, 'f1-score': 0.3803441394375886, 'support': 369269}}
[[30772 49622 33908]
 [29452 62098 55293]
 [14707 44345 49072]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0894582
{'0': {'precision': 0.4145208682190136, 'recall': 0.2368573079145003, 'f1-score': 0.30146019783325484, 'support': 55392}, '1': {'precision': 0.3355593512014075, 'recall': 0.4785180572851806, 'f1-score': 0.3944863404065796, 'support': 54604}, '2': {'precision': 0.3812412933499523, 'recall': 0.38461111727504715, 'f1-score': 0.3829187915385607, 'support': 54078}, 'accuracy': 0.3659812036032522, 'macro avg': {'precision': 0.37710717092345786, 'recall': 0.3666621608249094, 'f1-score': 0.3596217765927984, 'support': 164074}, 'weighted avg': {'precision': 0.3772736046367369, 'recall': 0.3659812036032522, 'f1-score': 0.35926775612688666, 'support': 164074}}
[[13120 26516 15756]
 [10474 26129 18001]
 [ 8057 25222 20799]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0808986
{'0': {'precision': 0.39998551039629066, 'recall': 0.2524347309222258, 'f1-score': 0.3095251443628413, 'support': 21871}, '1': {'precision': 0.36337593653591893, 'recall': 0.4620896717373899, 'f1-score': 0.4068304373876573, 'support': 24980}, '2': {'precision': 0.4048792408259683, 'recall': 0.4271840488161231, 'f1-score': 0.41573268651722983, 'support': 23271}, 'accuracy': 0.3851145147029463, 'macro avg': {'precision': 0.3894135625860593, 'recall': 0.38056948382524625, 'f1-score': 0.3773627560892428, 'support': 70122}, 'weighted avg': {'precision': 0.3885679074442491, 'recall': 0.3851145147029463, 'f1-score': 0.3794353285166686, 'support': 70122}}
[[ 5521 10155  6195]
 [ 5020 11543  8417]
 [ 3262 10068  9941]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0845888
{'0': {'precision': 0.32711555085966765, 'recall': 0.1721948062454494, 'f1-score': 0.22562159225667966, 'support': 98888}, '1': {'precision': 0.45131781541527033, 'recall': 0.6142552211401842, 'f1-score': 0.5203290905493635, 'support': 154133}, '2': {'precision': 0.2873794539511185, 'recall': 0.2606567063391576, 'f1-score': 0.2733665672599716, 'support': 94776}, 'accuracy': 0.3922086734503173, 'macro avg': {'precision': 0.3552709400753522, 'recall': 0.34903557790826367, 'f1-score': 0.3397724166886716, 'support': 347797}, 'weighted avg': {'precision': 0.37132996134090834, 'recall': 0.3922086734503173, 'f1-score': 0.3692376343308155, 'support': 347797}}
[[17028 59059 22801]
 [20998 94677 38458]
 [14029 56043 24704]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994248
{'0': {'precision': 0.3723651033787191, 'recall': 0.19834533147093586, 'f1-score': 0.2588243541659364, 'support': 37228}, '1': {'precision': 0.33694003438163617, 'recall': 0.5315324896309689, 'f1-score': 0.41243578899593597, 'support': 37612}, '2': {'precision': 0.3706425749477109, 'recall': 0.3292815113038092, 'f1-score': 0.3487399551741103, 'support': 38748}, 'accuracy': 0.3533383808148748, 'macro avg': {'precision': 0.3599825709026887, 'recall': 0.35305311080190466, 'f1-score': 0.3400000327786609, 'support': 113588}, 'weighted avg': {'precision': 0.36004732133516704, 'recall': 0.3533383808148748, 'f1-score': 0.34036186688462733, 'support': 113588}}
[[ 7384 19435 10409]
 [ 6364 19992 11256]
 [ 6082 19907 12759]]
Evaluating performance on  val set...
144/144 - 1s - 904ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984643
{'0': {'precision': 0.37507966857871256, 'recall': 0.18977749113189293, 'f1-score': 0.25203426124197004, 'support': 12404}, '1': {'precision': 0.34187419029797034, 'recall': 0.5849273458665134, 'f1-score': 0.431530494821634, 'support': 12181}, '2': {'precision': 0.37763779527559055, 'recall': 0.29833291863647676, 'f1-score': 0.33333333333333337, 'support': 12057}, 'accuracy': 0.3568582500955188, 'macro avg': {'precision': 0.3648638847174244, 'recall': 0.35767925187829436, 'f1-score': 0.3389660297989791, 'support': 36642}, 'weighted avg': {'precision': 0.36488282895878293, 'recall': 0.3568582500955188, 'f1-score': 0.3384560322544545, 'support': 36642}}
[[2354 7019 3031]
 [2159 7125 2897]
 [1763 6697 3597]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918417
{'0': {'precision': 0.3687191622193133, 'recall': 0.1609896571811697, 'f1-score': 0.22412302513293295, 'support': 90981}, '1': {'precision': 0.373461587696359, 'recall': 0.57468482665466, 'f1-score': 0.4527206020904687, 'support': 106608}, '2': {'precision': 0.362048549437537, 'recall': 0.3382334170105944, 'f1-score': 0.3497360316761988, 'support': 94012}, 'accuracy': 0.36937801996563796, 'macro avg': {'precision': 0.3680764331177364, 'recall': 0.3579693002821414, 'f1-score': 0.3421932196332002, 'support': 291601}, 'weighted avg': {'precision': 0.36830236956913903, 'recall': 0.36937801996563796, 'f1-score': 0.34819482343072505, 'support': 291601}}
[[14647 52196 24138]
 [13450 61266 31892]
 [11627 50587 31798]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976833
{'0': {'precision': 0.41071166544387383, 'recall': 0.1709626191057904, 'f1-score': 0.24142838659593743, 'support': 32744}, '1': {'precision': 0.3244129670120734, 'recall': 0.42055642850540714, 'f1-score': 0.3662807078743644, 'support': 32457}, '2': {'precision': 0.3688424798651433, 'recall': 0.47427522051961346, 'f1-score': 0.41496661354686615, 'support': 33217}, 'accuracy': 0.3556463248592737, 'macro avg': {'precision': 0.36798903744036354, 'recall': 0.3552647560436037, 'f1-score': 0.34089190267238934, 'support': 98418}, 'weighted avg': {'precision': 0.3681202127383764, 'recall': 0.3556463248592737, 'f1-score': 0.3411738709215984, 'support': 98418}}
[[ 5598 14771 12375]
 [ 4224 13650 14583]
 [ 3808 13655 15754]]
Evaluating performance on  val set...
139/139 - 1s - 839ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095257
{'0': {'precision': 0.3805774278215223, 'recall': 0.18944342827279853, 'f1-score': 0.2529658060013957, 'support': 11481}, '1': {'precision': 0.3758158901643034, 'recall': 0.5060231835745133, 'f1-score': 0.43130670627361084, 'support': 13199}, '2': {'precision': 0.324217435207001, 'recall': 0.36039659526704704, 'f1-score': 0.3413510520487265, 'support': 10691}, 'accuracy': 0.35924910237199964, 'macro avg': {'precision': 0.36020358439760897, 'recall': 0.351954402371453, 'f1-score': 0.34187452144124436, 'support': 35371}, 'weighted avg': {'precision': 0.36176562672515866, 'recall': 0.35924910237199964, 'f1-score': 0.34623001137260323, 'support': 35371}}
[[2175 5894 3412]
 [1901 6679 4619]
 [1639 5199 3853]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1087105
{'0': {'precision': 0.4025556592004855, 'recall': 0.16853858568558347, 'f1-score': 0.23760057842961665, 'support': 212527}, '1': {'precision': 0.28407268347538606, 'recall': 0.5606316019258523, 'f1-score': 0.3770789999592153, 'support': 164914}, '2': {'precision': 0.38283415710190744, 'recall': 0.3142483660130719, 'f1-score': 0.34516719135539864, 'support': 206550}, 'accuracy': 0.33079790613211507, 'macro avg': {'precision': 0.3564874999259264, 'recall': 0.3478061845415025, 'f1-score': 0.31994892324807683, 'support': 583991}, 'weighted avg': {'precision': 0.36212185505420524, 'recall': 0.33079790613211507, 'f1-score': 0.31503298459332896, 'support': 583991}}
[[ 35819 119543  57165]
 [ 24985  92456  47473]
 [ 28175 113467  64908]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1007491
{'0': {'precision': 0.3753603556667014, 'recall': 0.1444341980407094, 'f1-score': 0.2086011542841701, 'support': 74823}, '1': {'precision': 0.3333670308404399, 'recall': 0.6246380733324314, 'f1-score': 0.4347236542889024, 'support': 73910}, '2': {'precision': 0.3757026260376242, 'recall': 0.28403589095884646, 'f1-score': 0.3235009852327472, 'support': 76008}, 'accuracy': 0.34957128427834705, 'macro avg': {'precision': 0.36147667084825513, 'recall': 0.35103605411066247, 'f1-score': 0.3222752646019399, 'support': 224741}, 'weighted avg': {'precision': 0.36166587467944994, 'recall': 0.34957128427834705, 'f1-score': 0.3218249110801673, 'support': 224741}}
[[10807 46558 17458]
 [ 9327 46167 18416]
 [ 8657 45762 21589]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1037215
{'0': {'precision': 0.38732698961937717, 'recall': 0.1367175572519084, 'f1-score': 0.20209884901828032, 'support': 26200}, '1': {'precision': 0.324407848342805, 'recall': 0.6260156093656194, 'f1-score': 0.42735556496673455, 'support': 24985}, '2': {'precision': 0.3704596834966089, 'recall': 0.2816438774730731, 'f1-score': 0.32000347169483806, 'support': 26182}, 'accuracy': 0.34377706257189755, 'macro avg': {'precision': 0.3607315071529304, 'recall': 0.3481256813635336, 'f1-score': 0.3164859618932843, 'support': 77367}, 'weighted avg': {'precision': 0.361299684001976, 'recall': 0.34377706257189755, 'f1-score': 0.314744006241512, 'support': 77367}}
[[ 3582 16543  6075]
 [ 2888 15641  6456]
 [ 2778 16030  7374]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/EXC
Evaluating performance on  test set...
5098/5098 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094248
{'0': {'precision': 0.43052363467247823, 'recall': 0.17856710284901692, 'f1-score': 0.25243318742400006, 'support': 445838}, '1': {'precision': 0.3424160399040561, 'recall': 0.6366634220892047, 'f1-score': 0.4453239521534374, 'support': 439708}, '2': {'precision': 0.3810208744589603, 'recall': 0.2747775782678885, 'f1-score': 0.3192931996652757, 'support': 419361}, 'accuracy': 0.36384891796886676, 'macro avg': {'precision': 0.3846535163451649, 'recall': 0.36333603440203666, 'f1-score': 0.3390167797475711, 'support': 1304907}, 'weighted avg': {'precision': 0.3849256408642341, 'recall': 0.36384891796886676, 'f1-score': 0.33891758360791585, 'support': 1304907}}
[[ 79612 279252  86974]
 [ 59540 279946 100222]
 [ 45767 258363 115231]]
Evaluating performance on  train set...
1876/1876 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943319
{'0': {'precision': 0.43699346196269, 'recall': 0.16788365994607973, 'f1-score': 0.24257509206264696, 'support': 162833}, '1': {'precision': 0.32615080731034884, 'recall': 0.6554624565214581, 'f1-score': 0.4355678905999944, 'support': 154674}, '2': {'precision': 0.4037134483759515, 'recall': 0.26501247710481995, 'f1-score': 0.319978923855005, 'support': 162698}, 'accuracy': 0.3578409221061838, 'macro avg': {'precision': 0.3889525725496634, 'recall': 0.36278619785745253, 'f1-score': 0.3327073021725488, 'support': 480205}, 'weighted avg': {'precision': 0.3900154662811969, 'recall': 0.3578409221061838, 'f1-score': 0.33096321119076666, 'support': 480205}}
[[ 27337 105701  29795]
 [ 19402 101383  33889]
 [ 15818 103763  43117]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0907632
{'0': {'precision': 0.41986883902039146, 'recall': 0.1589996313614404, 'f1-score': 0.23065340069519694, 'support': 51541}, '1': {'precision': 0.3465413280401483, 'recall': 0.6813320324724335, 'f1-score': 0.459414002619052, 'support': 54323}, '2': {'precision': 0.408393135725429, 'recall': 0.2492763007541708, 'f1-score': 0.309586319449372, 'support': 52508}, 'accuracy': 0.36809537039375645, 'macro avg': {'precision': 0.39160110092865624, 'recall': 0.3632026548626815, 'f1-score': 0.3332179075878737, 'support': 158372}, 'weighted avg': {'precision': 0.3909121004075582, 'recall': 0.36809537039375645, 'f1-score': 0.33529040645539315, 'support': 158372}}
[[ 8195 35064  8282]
 [ 6632 37012 10679]
 [ 4691 34728 13089]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/AAL
Evaluating performance on  test set...
5760/5760 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920233
{'0': {'precision': 0.4029289842355291, 'recall': 0.27283399955334914, 'f1-score': 0.32535882829383544, 'support': 488077}, '1': {'precision': 0.36348875686134613, 'recall': 0.46973094595773907, 'f1-score': 0.409836486169976, 'support': 527106}, '2': {'precision': 0.35254296616724934, 'recall': 0.3552464270473171, 'f1-score': 0.3538895335596309, 'support': 459284}, 'accuracy': 0.3688933017829494, 'macro avg': {'precision': 0.37298690242137483, 'recall': 0.3659371241861351, 'f1-score': 0.3630282826744808, 'support': 1474467}, 'weighted avg': {'precision': 0.3731347111776933, 'recall': 0.3688933017829494, 'f1-score': 0.3644457503950127, 'support': 1474467}}
[[133164 222075 132838]
 [112699 247598 166809]
 [ 84627 211498 163159]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965842
{'0': {'precision': 0.4008894605465386, 'recall': 0.19947065268090552, 'f1-score': 0.26639238878889177, 'support': 184378}, '1': {'precision': 0.33647006876073887, 'recall': 0.5702000292805127, 'f1-score': 0.4232084933072546, 'support': 184423}, '2': {'precision': 0.3749662763718772, 'recall': 0.30257378753326764, 'f1-score': 0.33490260571504304, 'support': 183737}, 'accuracy': 0.35749577404630994, 'macro avg': {'precision': 0.37077526855971826, 'recall': 0.3574148231648953, 'f1-score': 0.3415011626037298, 'support': 552538}, 'weighted avg': {'precision': 0.37076761266999025, 'recall': 0.35749577404630994, 'f1-score': 0.341515472035565, 'support': 552538}}
[[ 36778 104043  43557]
 [ 30152 105158  49113]
 [ 24811 103332  55594]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995537
{'0': {'precision': 0.4086585860929073, 'recall': 0.19044851957458886, 'f1-score': 0.2598147209291607, 'support': 73999}, '1': {'precision': 0.3259375096770198, 'recall': 0.5977935225546295, 'f1-score': 0.42186161391976995, 'support': 70429}, '2': {'precision': 0.37808035464823886, 'recall': 0.2783712988740623, 'f1-score': 0.32065337588069887, 'support': 72917}, 'accuracy': 0.3519427638086913, 'macro avg': {'precision': 0.37089215013938864, 'recall': 0.35553778033442685, 'f1-score': 0.33410990357654313, 'support': 217345}, 'weighted avg': {'precision': 0.37159476777113576, 'recall': 0.3519427638086913, 'f1-score': 0.332735528076953, 'support': 217345}}
[[14093 43824 16082]
 [11020 42102 17307]
 [ 9373 43246 20298]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/WBA
Evaluating performance on  test set...
6315/6315 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965073
{'0': {'precision': 0.40716530483972346, 'recall': 0.20241761969806538, 'f1-score': 0.2704059727125275, 'support': 560055}, '1': {'precision': 0.32361987227206834, 'recall': 0.5721446259762599, 'f1-score': 0.41340636102829187, 'support': 519713}, '2': {'precision': 0.38323890406383815, 'recall': 0.29934224011030985, 'f1-score': 0.3361346647765613, 'support': 536670}, 'accuracy': 0.353471027035989, 'macro avg': {'precision': 0.37134136039187665, 'recall': 0.35796816192821174, 'f1-score': 0.3399823328391269, 'support': 1616438}, 'weighted avg': {'precision': 0.37236024030868164, 'recall': 0.353471027035989, 'f1-score': 0.3382055282678632, 'support': 1616438}}
[[113365 319031 127659]
 [ 91484 297351 130878]
 [ 73576 302446 160648]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918254
{'0': {'precision': 0.40003465709858926, 'recall': 0.21468583494710122, 'f1-score': 0.27941731397691755, 'support': 182802}, '1': {'precision': 0.3389051699943216, 'recall': 0.5693889300106917, 'f1-score': 0.42490389867575545, 'support': 182385}, '2': {'precision': 0.39552426623133696, 'recall': 0.31202979276001586, 'f1-score': 0.3488506729779914, 'support': 186354}, 'accuracy': 0.36487042667725517, 'macro avg': {'precision': 0.37815469777474925, 'recall': 0.3653681859059363, 'f1-score': 0.3510572952102215, 'support': 551541}, 'weighted avg': {'precision': 0.3782962353218079, 'recall': 0.36487042667725517, 'f1-score': 0.3509872515401879, 'support': 551541}}
[[ 39245 100981  42576]
 [ 32246 103848  46291]
 [ 26613 101593  58148]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911411
{'0': {'precision': 0.4050241306768964, 'recall': 0.2062836794504144, 'f1-score': 0.27334794863764483, 'support': 63466}, '1': {'precision': 0.3448634397222377, 'recall': 0.5789088189000919, 'f1-score': 0.43223745833018207, 'support': 64169}, '2': {'precision': 0.3907436256433515, 'recall': 0.3139358027820907, 'f1-score': 0.34815380966186116, 'support': 63118}, 'accuracy': 0.3672550366180348, 'macro avg': {'precision': 0.38021039868082857, 'recall': 0.3663761003775323, 'f1-score': 0.3512464055432294, 'support': 190753}, 'weighted avg': {'precision': 0.3800609149236617, 'recall': 0.3672550366180348, 'f1-score': 0.3515505314729706, 'support': 190753}}
[[13092 35706 14668]
 [10793 37148 16228]
 [ 8439 34864 19815]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
6082/6082 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0909249
{'0': {'precision': 0.3861893339564213, 'recall': 0.25584699068086875, 'f1-score': 0.30778750402204497, 'support': 510348}, '1': {'precision': 0.35664979597043267, 'recall': 0.4938146681777372, 'f1-score': 0.4141710984460676, 'support': 543544}, '2': {'precision': 0.3737385006178772, 'recall': 0.34639337612446014, 'f1-score': 0.3595467585808342, 'support': 502908}, 'accuracy': 0.36818152620760536, 'macro avg': {'precision': 0.37219254351491043, 'recall': 0.3653516783276887, 'f1-score': 0.3605017870163156, 'support': 1556800}, 'weighted avg': {'precision': 0.37185373379732783, 'recall': 0.36818152620760536, 'f1-score': 0.361650754047265, 'support': 1556800}}
[[130571 245218 134559]
 [117785 268410 157349]
 [ 89745 238959 174204]]
Evaluating performance on  train set...
2440/2440 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973158
{'0': {'precision': 0.3795964939577823, 'recall': 0.24615983356476032, 'f1-score': 0.29865110639587755, 'support': 208129}, '1': {'precision': 0.3350166947582945, 'recall': 0.5076228393862886, 'f1-score': 0.40364145982696115, 'support': 205960}, '2': {'precision': 0.37710652007389717, 'recall': 0.31807255244755245, 'f1-score': 0.34508298113596536, 'support': 210496}, 'accuracy': 0.35661439195625894, 'macro avg': {'precision': 0.36390656959665796, 'recall': 0.3572850751328671, 'f1-score': 0.3491251824529347, 'support': 624585}, 'weighted avg': {'precision': 0.3640569197032152, 'recall': 0.35661439195625894, 'f1-score': 0.3489205446596134, 'support': 624585}}
[[ 51233 103678  53218]
 [ 44037 104550  57373]
 [ 39697 103846  66953]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935854
{'0': {'precision': 0.39882455799494854, 'recall': 0.227470426905283, 'f1-score': 0.28970627150039696, 'support': 72194}, '1': {'precision': 0.34650464080691024, 'recall': 0.5355454821857983, 'f1-score': 0.4207674600416956, 'support': 72358}, '2': {'precision': 0.3580303963852947, 'recall': 0.312756032652573, 'f1-score': 0.33386533029031074, 'support': 66886}, 'accuracy': 0.35987854595673435, 'macro avg': {'precision': 0.3677865317290512, 'recall': 0.35859064724788475, 'f1-score': 0.3481130206108011, 'support': 211438}, 'weighted avg': {'precision': 0.368014945430909, 'recall': 0.35987854595673435, 'f1-score': 0.34852705247020116, 'support': 211438}}
[[16422 37719 18053]
 [14151 38751 19456]
 [10603 35364 20919]]
testing model on single stock: results/universal/W3/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
13689/13689 - 80s - 80s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982627
{'0': {'precision': 0.3772539719888472, 'recall': 0.21005661028472977, 'f1-score': 0.2698561645719315, 'support': 1167809}, '1': {'precision': 0.3360833141807733, 'recall': 0.5278006808190355, 'f1-score': 0.4106685690746458, 'support': 1169180}, '2': {'precision': 0.3673191094710802, 'recall': 0.3203093074080769, 'f1-score': 0.34220729296331553, 'support': 1167253}, 'accuracy': 0.3527958400133324, 'macro avg': {'precision': 0.36021879854690025, 'recall': 0.3527221995039474, 'f1-score': 0.34091067553663096, 'support': 3504242}, 'weighted avg': {'precision': 0.36020822920781354, 'recall': 0.3527958400133324, 'f1-score': 0.3409377618944656, 'support': 3504242}}
[[245306 617915 304588]
 [212689 617094 339397]
 [192246 601125 373882]]
Evaluating performance on  train set...
5475/5475 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967625
{'0': {'precision': 0.3796899364279717, 'recall': 0.26893806644279766, 'f1-score': 0.31485867677246177, 'support': 470811}, '1': {'precision': 0.3278377721694993, 'recall': 0.4010365931708079, 'f1-score': 0.3607616058830073, 'support': 460933}, '2': {'precision': 0.37070141759017605, 'recall': 0.39785577911587605, 'f1-score': 0.38379889472587336, 'support': 469821}, 'accuracy': 0.35559606582641545, 'macro avg': {'precision': 0.3594097087292156, 'recall': 0.3559434795764939, 'f1-score': 0.3531397257937809, 'support': 1401565}, 'weighted avg': {'precision': 0.3596242466190492, 'recall': 0.35559606582641545, 'f1-score': 0.3530643518305582, 'support': 1401565}}
[[126619 193934 150258]
 [109025 184851 167057]
 [ 97836 185064 186921]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946759
{'0': {'precision': 0.3856604742744628, 'recall': 0.25928675852701133, 'f1-score': 0.3100925135603954, 'support': 173742}, '1': {'precision': 0.3371107223865106, 'recall': 0.42941484875424557, 'f1-score': 0.37770520728122126, 'support': 175476}, '2': {'precision': 0.37069265768480175, 'recall': 0.38984174234584124, 'f1-score': 0.3800261277881212, 'support': 171998}, 'accuracy': 0.3596455212426326, 'macro avg': {'precision': 0.3644879514485917, 'recall': 0.3595144498756994, 'f1-score': 0.3559412828765793, 'support': 521216}, 'weighted avg': {'precision': 0.3643761108242256, 'recall': 0.3596455212426326, 'f1-score': 0.35593309946584734, 'support': 521216}}
[[45049 75902 52791]
 [39084 75352 61040]
 [32677 72269 67052]]
training model: results/universal/W3/deepLOB_L2/h50
Epoch 1/50
10532/10532 - 423s - loss: 3.0632 - accuracy50: 0.4572 - val_loss: 3.2274 - val_accuracy50: 0.4266 - 423s/epoch - 40ms/step
Epoch 2/50
10532/10532 - 418s - loss: 2.9774 - accuracy50: 0.4869 - val_loss: 3.1808 - val_accuracy50: 0.4388 - 418s/epoch - 40ms/step
Epoch 3/50
10532/10532 - 421s - loss: 2.9436 - accuracy50: 0.4946 - val_loss: 3.1729 - val_accuracy50: 0.4391 - 421s/epoch - 40ms/step
Epoch 4/50
10532/10532 - 419s - loss: 2.9249 - accuracy50: 0.4995 - val_loss: 3.1817 - val_accuracy50: 0.4428 - 419s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 421s - loss: 2.9119 - accuracy50: 0.5028 - val_loss: 3.2141 - val_accuracy50: 0.4460 - 421s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 426s - loss: 2.9036 - accuracy50: 0.5047 - val_loss: 3.2659 - val_accuracy50: 0.4431 - 426s/epoch - 40ms/step
Epoch 7/50
10532/10532 - 420s - loss: 2.8968 - accuracy50: 0.5066 - val_loss: 3.3226 - val_accuracy50: 0.4382 - 420s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 422s - loss: 2.8917 - accuracy50: 0.5079 - val_loss: 3.3501 - val_accuracy50: 0.4372 - 422s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 419s - loss: 2.8872 - accuracy50: 0.5092 - val_loss: 3.3894 - val_accuracy50: 0.4344 - 419s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 419s - loss: 2.8832 - accuracy50: 0.5105 - val_loss: 3.3580 - val_accuracy50: 0.4400 - 419s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 421s - loss: 2.8802 - accuracy50: 0.5114 - val_loss: 3.3399 - val_accuracy50: 0.4410 - 421s/epoch - 40ms/step
Epoch 12/50
10532/10532 - 419s - loss: 2.8771 - accuracy50: 0.5122 - val_loss: 3.3532 - val_accuracy50: 0.4385 - 419s/epoch - 40ms/step
Epoch 13/50
10532/10532 - 420s - loss: 2.8743 - accuracy50: 0.5134 - val_loss: 3.3264 - val_accuracy50: 0.4403 - 420s/epoch - 40ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 366s - 366s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0491756
{'0': {'precision': 0.42868573923565395, 'recall': 0.4553505656025702, 'f1-score': 0.44161601228002134, 'support': 2074248}, '1': {'precision': 0.458156718510333, 'recall': 0.5289100976323766, 'f1-score': 0.49099759156161216, 'support': 2941135}, '2': {'precision': 0.438750779636958, 'recall': 0.3151981513151986, 'f1-score': 0.36685093367006033, 'support': 2071094}, 'accuracy': 0.4449193866007044, 'macro avg': {'precision': 0.4418644124609817, 'recall': 0.43315293818338185, 'f1-score': 0.43315484583723124, 'support': 7086477}, 'weighted avg': {'precision': 0.44385883207345356, 'recall': 0.4449193866007044, 'f1-score': 0.44026024487426285, 'support': 7086477}}
[[ 944510  877762  251976]
 [ 802448 1555596  583091]
 [ 456311  961978  652805]]
Evaluating performance on  train set...
10532/10532 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.059597
{'0': {'precision': 0.41842788081331383, 'recall': 0.46383570146024095, 'f1-score': 0.43996327969794513, 'support': 828151}, '1': {'precision': 0.4325362139828418, 'recall': 0.6018196742541604, 'f1-score': 0.5033254150966597, 'support': 1026997}, '2': {'precision': 0.49596816960920054, 'recall': 0.2058121000166536, 'f1-score': 0.29090658414522297, 'support': 840660}, 'accuracy': 0.4359401708133517, 'macro avg': {'precision': 0.44897742146845204, 'recall': 0.42382249191035165, 'f1-score': 0.41139842631327594, 'support': 2695808}, 'weighted avg': {'precision': 0.4479827434071098, 'recall': 0.4359401708133517, 'f1-score': 0.41761996789114075, 'support': 2695808}}
[[384126 376080  67945]
 [301044 618067 107886]
 [232852 434790 173018]]
Evaluating performance on  val set...
3814/3814 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0508145
{'0': {'precision': 0.4263699764929693, 'recall': 0.37744678501421824, 'f1-score': 0.4004195596819986, 'support': 289768}, '1': {'precision': 0.43665131514433125, 'recall': 0.6439304950540264, 'f1-score': 0.5204105693307334, 'support': 394159}, '2': {'precision': 0.4743388217227216, 'recall': 0.2243241021143648, 'f1-score': 0.30459790165063017, 'support': 291908}, 'accuracy': 0.43928020618239766, 'macro avg': {'precision': 0.44578670445334073, 'recall': 0.41523379406086985, 'f1-score': 0.4084760102211207, 'support': 975835}, 'weighted avg': {'precision': 0.44487205095720633, 'recall': 0.43928020618239766, 'f1-score': 0.42022252618710954, 'support': 975835}}
[[109372 154690  25706]
 [ 93487 253811  46861]
 [ 53660 172766  65482]]
testing model out of sample: results/universal/W3/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 216s - 216s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0204227
{'0': {'precision': 0.4269701352448202, 'recall': 0.5538198385864093, 'f1-score': 0.48219198338418895, 'support': 1154054}, '1': {'precision': 0.5582591119105529, 'recall': 0.648369002115748, 'f1-score': 0.5999493946874493, 'support': 1837648}, '2': {'precision': 0.5025085051684113, 'recall': 0.2218000089101568, 'f1-score': 0.30775943885064744, 'support': 1144761}, 'accuracy': 0.5039377845275057, 'macro avg': {'precision': 0.4959125841079281, 'recall': 0.47466294987077134, 'f1-score': 0.4633002723074286, 'support': 4136463}, 'weighted avg': {'precision': 0.5062011848840725, 'recall': 0.5039377845275057, 'f1-score': 0.48623241533144734, 'support': 4136463}}
[[ 639138  424096   90820]
 [ 485621 1191474  160553]
 [ 372156  518697  253908]]
Evaluating performance on  train set...
6181/6181 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0758052
{'0': {'precision': 0.4383802007005461, 'recall': 0.5336794818972035, 'f1-score': 0.4813583416167108, 'support': 499978}, '1': {'precision': 0.46309497530719923, 'recall': 0.5550916998849968, 'f1-score': 0.5049372248030066, 'support': 578245}, '2': {'precision': 0.4758716009171363, 'recall': 0.2646039033767307, 'f1-score': 0.34009898336579175, 'support': 503564}, 'accuracy': 0.4558464572031506, 'macro avg': {'precision': 0.45911559230829385, 'recall': 0.45112502838631036, 'f1-score': 0.44213151659516975, 'support': 1581787}, 'weighted avg': {'precision': 0.45935047944293755, 'recall': 0.4558464572031506, 'f1-score': 0.44500783666869564, 'support': 1581787}}
[[266828 170759  62391]
 [172900 320979  84366]
 [168940 201379 133245]]
Evaluating performance on  val set...
2209/2209 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.036786
{'0': {'precision': 0.44484652474437225, 'recall': 0.5341834801553471, 'f1-score': 0.4854389825310831, 'support': 168912}, '1': {'precision': 0.525234090164597, 'recall': 0.538134632819583, 'f1-score': 0.5316061082967515, 'support': 229424}, '2': {'precision': 0.4603376092972649, 'recall': 0.35089849149588315, 'f1-score': 0.3982361547354743, 'support': 166390}, 'accuracy': 0.48178585721217015, 'macro avg': {'precision': 0.4768060747354114, 'recall': 0.4744055348236043, 'f1-score': 0.4717604151877696, 'support': 564726}, 'weighted avg': {'precision': 0.4820688208095887, 'recall': 0.48178585721217015, 'f1-score': 0.4785014024387044, 'support': 564726}}
[[ 90230  52483  26199]
 [ 63715 123461  42248]
 [ 48889  59115  58386]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.170996
{'0': {'precision': 0.36970798957881024, 'recall': 0.4772046589018303, 'f1-score': 0.4166341720760603, 'support': 57095}, '1': {'precision': 0.36181871080364647, 'recall': 0.37573855243722304, 'f1-score': 0.36864727775764955, 'support': 59576}, '2': {'precision': 0.39740403933594165, 'recall': 0.26503411434918284, 'f1-score': 0.3179938444616019, 'support': 56721}, 'accuracy': 0.37293531420134723, 'macro avg': {'precision': 0.37631024657279943, 'recall': 0.37265910856274537, 'f1-score': 0.36775843143177056, 'support': 173392}, 'weighted avg': {'precision': 0.3760573941993527, 'recall': 0.37293531420134723, 'f1-score': 0.36787848993078637, 'support': 173392}}
[[27246 19254 10595]
 [24991 22385 12200]
 [21459 20229 15033]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2351274
{'0': {'precision': 0.3593667051806514, 'recall': 0.5148993288590604, 'f1-score': 0.4232983282143711, 'support': 22350}, '1': {'precision': 0.3344629523262493, 'recall': 0.26980817347789826, 'f1-score': 0.29867665162084533, 'support': 21582}, '2': {'precision': 0.36937736742424243, 'recall': 0.27865339107916237, 'f1-score': 0.3176647239966406, 'support': 22397}, 'accuracy': 0.3553799996984728, 'macro avg': {'precision': 0.35440234164371437, 'recall': 0.35445363113870704, 'f1-score': 0.34654656794395233, 'support': 66329}, 'weighted avg': {'precision': 0.35464382390950305, 'recall': 0.3553799996984728, 'f1-score': 0.3470803713944886, 'support': 66329}}
[[11508  5665  5177]
 [10281  5823  5478]
 [10234  5922  6241]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2014921
{'0': {'precision': 0.3731806251491291, 'recall': 0.41779083745158274, 'f1-score': 0.39422773961812335, 'support': 7487}, '1': {'precision': 0.3445913653018958, 'recall': 0.30083449235048676, 'f1-score': 0.32122967253285806, 'support': 7190}, '2': {'precision': 0.36371134020618556, 'recall': 0.364613476643241, 'f1-score': 0.3641618497109827, 'support': 7257}, 'accuracy': 0.36185830217926507, 'macro avg': {'precision': 0.3604944435524035, 'recall': 0.3610796021484368, 'f1-score': 0.3598730872873213, 'support': 21934}, 'weighted avg': {'precision': 0.3606760487320347, 'recall': 0.36185830217926507, 'f1-score': 0.36035137117647215, 'support': 21934}}
[[3128 2052 2307]
 [2705 2163 2322]
 [2549 2062 2646]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94438666
{'0': {'precision': 0.401621768707483, 'recall': 0.5242675684123782, 'f1-score': 0.45482167179228017, 'support': 70382}, '1': {'precision': 0.7427241377338313, 'recall': 0.5642413683739481, 'f1-score': 0.6412957064908772, 'support': 230171}, '2': {'precision': 0.3463852777967408, 'recall': 0.5168509895227008, 'f1-score': 0.41478696010136695, 'support': 68720}, 'accuracy': 0.547803386654318, 'macro avg': {'precision': 0.49691039474601845, 'recall': 0.5351199754363424, 'f1-score': 0.503634779461508, 'support': 369273}, 'weighted avg': {'precision': 0.6039545190731405, 'recall': 0.547803386654318, 'f1-score': 0.5636022478246768, 'support': 369273}}
[[ 36899  22802  10681]
 [ 43959 129872  56340]
 [ 11017  22185  35518]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97993124
{'0': {'precision': 0.44315843621399176, 'recall': 0.5745487891292568, 'f1-score': 0.5003720845811779, 'support': 47982}, '1': {'precision': 0.5776075443521066, 'recall': 0.6056107285248279, 'f1-score': 0.591277761263748, 'support': 68975}, '2': {'precision': 0.5046365236225802, 'recall': 0.31646080054331677, 'f1-score': 0.388985991182532, 'support': 47118}, 'accuracy': 0.513490781654731, 'macro avg': {'precision': 0.5084675013962262, 'recall': 0.4988734393991338, 'f1-score': 0.4935452790091526, 'support': 164075}, 'weighted avg': {'precision': 0.5173339764019811, 'recall': 0.513490781654731, 'f1-score': 0.5066005112179164, 'support': 164075}}
[[27568 14163  6251]
 [18817 41772  8386]
 [15823 16384 14911]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0144209
{'0': {'precision': 0.4189272775470531, 'recall': 0.5183970258597125, 'f1-score': 0.46338423946243135, 'support': 18291}, '1': {'precision': 0.5529688351156856, 'recall': 0.5836233243562199, 'f1-score': 0.5678826958749227, 'support': 33047}, '2': {'precision': 0.45475454040764535, 'recall': 0.3052597955706985, 'f1-score': 0.3653043672156214, 'support': 18784}, 'accuracy': 0.4920424403183024, 'macro avg': {'precision': 0.47555021769012806, 'recall': 0.46909338192887695, 'f1-score': 0.46552376751765845, 'support': 70122}, 'weighted avg': {'precision': 0.4916954624040732, 'recall': 0.4920424403183024, 'f1-score': 0.48635888606092426, 'support': 70122}}
[[ 9482  6837  1972]
 [ 8857 19287  4903]
 [ 4295  8755  5734]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
1359/1359 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2085909
{'0': {'precision': 0.40491246283799726, 'recall': 0.549195935674854, 'f1-score': 0.4661446838563348, 'support': 124990}, '1': {'precision': 0.312133072407045, 'recall': 0.4577119843256776, 'f1-score': 0.3711579276781667, 'support': 101057}, '2': {'precision': 0.4704650467041186, 'recall': 0.11624258751252525, 'f1-score': 0.18642359899102326, 'support': 121754}, 'accuracy': 0.37105126207227696, 'macro avg': {'precision': 0.3958368606497203, 'recall': 0.3743835025043523, 'f1-score': 0.3412420701751749, 'support': 347801}, 'weighted avg': {'precision': 0.40090236061648266, 'recall': 0.37105126207227696, 'f1-score': 0.34062394761409204, 'support': 347801}}
[[68644 48425  7921]
 [46793 46255  8009]
 [54091 53510 14153]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2372572
{'0': {'precision': 0.3780253000557825, 'recall': 0.5615460693378953, 'f1-score': 0.4518626860535146, 'support': 37411}, '1': {'precision': 0.37350111613757137, 'recall': 0.5045903389378169, 'f1-score': 0.4292606509178009, 'support': 37470}, '2': {'precision': 0.42190669371196754, 'recall': 0.08060349281802212, 'f1-score': 0.135349109602412, 'support': 38708}, 'accuracy': 0.3788659113118348, 'macro avg': {'precision': 0.3911443699684405, 'recall': 0.3822466336979114, 'f1-score': 0.3388241488579092, 'support': 113589}, 'weighted avg': {'precision': 0.39148646103288626, 'recall': 0.3788659113118348, 'f1-score': 0.3365477719878527, 'support': 113589}}
[[21008 14602  1801]
 [16089 18907  2474]
 [18476 17112  3120]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1998818
{'0': {'precision': 0.40729738456570874, 'recall': 0.4961453744493392, 'f1-score': 0.44735255523637263, 'support': 12712}, '1': {'precision': 0.36084874284954105, 'recall': 0.4820508263728452, 'f1-score': 0.41273584905660377, 'support': 11254}, '2': {'precision': 0.4280581414339376, 'recall': 0.20676869674976334, 'f1-score': 0.27884461939464866, 'support': 12676}, 'accuracy': 0.3917089678510998, 'macro avg': {'precision': 0.3987347562830625, 'recall': 0.39498829919064926, 'f1-score': 0.3796443412292083, 'support': 36642}, 'weighted avg': {'precision': 0.40021344646702195, 'recall': 0.3917089678510998, 'f1-score': 0.3784266503710047, 'support': 36642}}
[[6307 4649 1756]
 [4083 5425 1746]
 [5095 4960 2621]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2549576
{'0': {'precision': 0.3490752168182085, 'recall': 0.44171296837318996, 'f1-score': 0.3899680169575779, 'support': 94129}, '1': {'precision': 0.3281334314446897, 'recall': 0.2642959450782832, 'f1-score': 0.29277527014088356, 'support': 101235}, '2': {'precision': 0.3371740182066054, 'recall': 0.31865836805519476, 'f1-score': 0.32765482352815484, 'support': 96241}, 'accuracy': 0.33950721009584883, 'macro avg': {'precision': 0.3381275554898346, 'recall': 0.3415557605022226, 'f1-score': 0.3367993702088721, 'support': 291605}, 'weighted avg': {'precision': 0.33787710671081156, 'recall': 0.33950721009584883, 'f1-score': 0.33566033439785103, 'support': 291605}}
[[41578 25642 26909]
 [41100 26756 33379]
 [36431 29142 30668]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2524911
{'0': {'precision': 0.3583060678167757, 'recall': 0.5726764915616829, 'f1-score': 0.4408105388345073, 'support': 33656}, '1': {'precision': 0.3319270461478549, 'recall': 0.31535781457157835, 'f1-score': 0.3234303603332965, 'support': 32433}, '2': {'precision': 0.32816911605009774, 'recall': 0.14021033096195484, 'f1-score': 0.1964761719003966, 'support': 32330}, 'accuracy': 0.3458173726617828, 'macro avg': {'precision': 0.3394674100049095, 'recall': 0.342748212365072, 'f1-score': 0.3202390236894001, 'support': 98419}, 'weighted avg': {'precision': 0.3397133320604197, 'recall': 0.3458173726617828, 'f1-score': 0.32186682458919325, 'support': 98419}}
[[19274 10123  4259]
 [17184 10228  5021]
 [17334 10463  4533]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2665653
{'0': {'precision': 0.35391558541463664, 'recall': 0.5681238165802256, 'f1-score': 0.43613726853314794, 'support': 12147}, '1': {'precision': 0.33643103268246843, 'recall': 0.2640983606557377, 'f1-score': 0.2959085273453644, 'support': 12200}, '2': {'precision': 0.31755361397934867, 'recall': 0.18133164005805516, 'f1-score': 0.2308447369940528, 'support': 11024}, 'accuracy': 0.3427101297673235, 'macro avg': {'precision': 0.3359667440254846, 'recall': 0.33785127243133944, 'f1-score': 0.3209635109575217, 'support': 35371}, 'weighted avg': {'precision': 0.336552041369089, 'recall': 0.3427101297673235, 'f1-score': 0.32378716505351934, 'support': 35371}}
[[6901 3151 2095]
 [6777 3222 2201]
 [5821 3204 1999]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1526856
{'0': {'precision': 0.4252219522567756, 'recall': 0.607725253134438, 'f1-score': 0.500351067750257, 'support': 212239}, '1': {'precision': 0.310371177171663, 'recall': 0.3458471275250519, 'f1-score': 0.3271502160885271, 'support': 157373}, '2': {'precision': 0.4840982688052572, 'recall': 0.23778471240723378, 'f1-score': 0.31891918945465236, 'support': 214383}, 'accuracy': 0.4013510389643747, 'macro avg': {'precision': 0.40656379941123194, 'recall': 0.3971190310222413, 'f1-score': 0.3821401577644788, 'support': 583995}, 'weighted avg': {'precision': 0.41588569140376097, 'recall': 0.4013510389643747, 'f1-score': 0.3870743308035228, 'support': 583995}}
[[128983  55432  27824]
 [ 76444  54427  26502]
 [ 97904  65502  50977]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1830363
{'0': {'precision': 0.39731596935522645, 'recall': 0.5096871941327112, 'f1-score': 0.44654058498766597, 'support': 74583}, '1': {'precision': 0.37800640876109565, 'recall': 0.4150243981344189, 'f1-score': 0.3956514196495692, 'support': 74186}, '2': {'precision': 0.4303475795442613, 'recall': 0.26971069049938134, 'f1-score': 0.3315990905339472, 'support': 75974}, 'accuracy': 0.39731604543856763, 'macro avg': {'precision': 0.40188998588686115, 'recall': 0.3981407609221705, 'f1-score': 0.3912636983903941, 'support': 224743}, 'weighted avg': {'precision': 0.4021083076717282, 'recall': 0.39731604543856763, 'f1-score': 0.3908866659806274, 'support': 224743}}
[[38014 23965 12604]
 [28877 30789 14520]
 [28786 26697 20491]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1807406
{'0': {'precision': 0.3972046751502945, 'recall': 0.5108119775519014, 'f1-score': 0.44690128755364805, 'support': 25481}, '1': {'precision': 0.3776263702801462, 'recall': 0.3781157100388749, 'f1-score': 0.377870881736812, 'support': 26238}, '2': {'precision': 0.4282440248826803, 'recall': 0.30598877105427325, 'f1-score': 0.35693819074907895, 'support': 25648}, 'accuracy': 0.3979086690707925, 'macro avg': {'precision': 0.401025023437707, 'recall': 0.39830548621501655, 'f1-score': 0.39390345334651294, 'support': 77367}, 'weighted avg': {'precision': 0.40085483191937277, 'recall': 0.3979086690707925, 'f1-score': 0.39366679100258967, 'support': 77367}}
[[13016  7653  4812]
 [10651  9921  5666]
 [ 9102  8698  7848]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
5098/5098 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95707715
{'0': {'precision': 0.42586845969436365, 'recall': 0.732791713339962, 'f1-score': 0.5386788732361789, 'support': 317812}, '1': {'precision': 0.723781696182616, 'recall': 0.39115763152749056, 'f1-score': 0.5078531665094398, 'support': 675068}, '2': {'precision': 0.44386998659786736, 'recall': 0.5593642939323337, 'f1-score': 0.49496917413917296, 'support': 312031}, 'accuracy': 0.5145845195572725, 'macro avg': {'precision': 0.5311733808249489, 'recall': 0.5611045462665953, 'f1-score': 0.5138337379615973, 'support': 1304911}, 'weighted avg': {'precision': 0.5842920818194579, 'recall': 0.5145845195572725, 'f1-score': 0.5122799622701865, 'support': 1304911}}
[[232890  45633  39289]
 [231617 264058 179393]
 [ 82352  55140 174539]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88131344
{'0': {'precision': 0.4405666706996491, 'recall': 0.7000113595651908, 'f1-score': 0.5407813686608725, 'support': 114441}, '1': {'precision': 0.7179879339806405, 'recall': 0.5784902040275676, 'f1-score': 0.6407342696204614, 'support': 249133}, '2': {'precision': 0.5340829953709393, 'recall': 0.4471290286625569, 'f1-score': 0.486753127960537, 'support': 116633}, 'accuracy': 0.5755455459832947, 'macro avg': {'precision': 0.5642125333504097, 'recall': 0.5752101974184384, 'f1-score': 0.5560895887472903, 'support': 480207}, 'weighted avg': {'precision': 0.6072070592828431, 'recall': 0.5755455459832947, 'f1-score': 0.5795148529232074, 'support': 480207}}
[[ 80110  23539  10792]
 [ 70310 144121  34702]
 [ 31414  33069  52150]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8868471
{'0': {'precision': 0.42515702749000733, 'recall': 0.7249561854953125, 'f1-score': 0.5359823944386171, 'support': 35947}, '1': {'precision': 0.696363312848168, 'recall': 0.5950595913402495, 'f1-score': 0.6417381432896064, 'support': 85499}, '2': {'precision': 0.5710359760159893, 'recall': 0.371391431511672, 'f1-score': 0.4500672770831282, 'support': 36926}, 'accuracy': 0.5723928472204682, 'macro avg': {'precision': 0.5641854387847215, 'recall': 0.5638024027824113, 'f1-score': 0.5425959382704506, 'support': 158372}, 'weighted avg': {'precision': 0.6055840742224333, 'recall': 0.5723928472204681, 'f1-score': 0.573043927711809, 'support': 158372}}
[[26060  7586  2301]
 [26621 50877  8001]
 [ 8614 14598 13714]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
5760/5760 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9058643
{'0': {'precision': 0.4625066347446047, 'recall': 0.5068986963800023, 'f1-score': 0.48368624081562156, 'support': 323177}, '1': {'precision': 0.6726342463841256, 'recall': 0.7504189751729508, 'f1-score': 0.7094007366576354, 'support': 834775}, '2': {'precision': 0.4982086629799169, 'recall': 0.29743554099437947, 'f1-score': 0.3724905239334974, 'support': 316519}, 'accuracy': 0.5998035905758743, 'macro avg': {'precision': 0.5444498480362158, 'recall': 0.5182510708491108, 'f1-score': 0.5218591671355848, 'support': 1474471}, 'weighted avg': {'precision': 0.5891348609229383, 'recall': 0.5998035905758743, 'f1-score': 0.5876050436640357, 'support': 1474471}}
[[163818 139080  20279]
 [133802 626431  74542]
 [ 56576 165799  94144]]
Evaluating performance on  train set...
2159/2159 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97685504
{'0': {'precision': 0.4680513140292812, 'recall': 0.5613043839521402, 'f1-score': 0.5104537819033614, 'support': 156457}, '1': {'precision': 0.5499980652401038, 'recall': 0.5959580712788259, 'f1-score': 0.572056426458455, 'support': 238500}, '2': {'precision': 0.493209992486852, 'recall': 0.33326775900800854, 'f1-score': 0.3977626466511653, 'support': 157582}, 'accuracy': 0.5112272617860458, 'macro avg': {'precision': 0.5037531239187457, 'recall': 0.4968434047463249, 'f1-score': 0.49342428500432717, 'support': 552539}, 'weighted avg': {'precision': 0.5105982745741153, 'recall': 0.5112272617860458, 'f1-score': 0.5049050989164199, 'support': 552539}}
[[ 87820  50633  18004]
 [ 60405 142136  35959]
 [ 39404  65661  52517]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94055223
{'0': {'precision': 0.4768081400678339, 'recall': 0.5355102180888485, 'f1-score': 0.5044571779557596, 'support': 58279}, '1': {'precision': 0.6037252950376795, 'recall': 0.5882574145728394, 'f1-score': 0.5958909945717823, 'support': 101051}, '2': {'precision': 0.4880121282449606, 'recall': 0.4494354908213393, 'f1-score': 0.4679300814758982, 'support': 58015}, 'accuracy': 0.5370585934804113, 'macro avg': {'precision': 0.5228485211168247, 'recall': 0.524401041161009, 'f1-score': 0.5227594180011467, 'support': 217345}, 'weighted avg': {'precision': 0.5388068278727242, 'recall': 0.5370585934804113, 'f1-score': 0.5372178078326215, 'support': 217345}}
[[31209 18601  8469]
 [22721 59444 18886]
 [11524 20417 26074]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
6315/6315 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9434212
{'0': {'precision': 0.4710922926814981, 'recall': 0.5735857887932956, 'f1-score': 0.517311215931123, 'support': 448660}, '1': {'precision': 0.6234396648735144, 'recall': 0.5319438547416269, 'f1-score': 0.5740689440370641, 'support': 720702}, '2': {'precision': 0.48448170952712544, 'recall': 0.49332110584235483, 'f1-score': 0.48886145334732695, 'support': 447080}, 'accuracy': 0.5328196124574838, 'macro avg': {'precision': 0.5263378890273793, 'recall': 0.5329502497924258, 'f1-score': 0.5267472044385048, 'support': 1616442}, 'weighted avg': {'precision': 0.5427207187659934, 'recall': 0.5328196124574838, 'f1-score': 0.5347483329482782, 'support': 1616442}}
[[257345 113121  78194]
 [180840 383373 156489]
 [108088 118438 220554]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9634897
{'0': {'precision': 0.4758404121384021, 'recall': 0.5931845651507225, 'f1-score': 0.5280722040213273, 'support': 166299}, '1': {'precision': 0.5418287042844837, 'recall': 0.6061260957833974, 'f1-score': 0.572176739174593, 'support': 213774}, '2': {'precision': 0.5563802455038538, 'recall': 0.3409965707887186, 'f1-score': 0.4228407784262252, 'support': 171468}, 'accuracy': 0.5197981655035618, 'macro avg': {'precision': 0.5246831206422465, 'recall': 0.5134357439076128, 'f1-score': 0.5076965738740484, 'support': 551541}, 'weighted avg': {'precision': 0.5264560242374913, 'recall': 0.5197981655035618, 'f1-score': 0.5124515716728949, 'support': 551541}}
[[ 98646  47084  20569]
 [ 58149 129574  26051]
 [ 50514  62484  58470]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9389145
{'0': {'precision': 0.4990984682713348, 'recall': 0.5347049005082425, 'f1-score': 0.5162885029788312, 'support': 53321}, '1': {'precision': 0.5824320078987524, 'recall': 0.6207964601769912, 'f1-score': 0.6010026165281219, 'support': 83620}, '2': {'precision': 0.5021909620008539, 'recall': 0.41528998569118986, 'f1-score': 0.4546249771141444, 'support': 53813}, 'accuracy': 0.5387567233190392, 'macro avg': {'precision': 0.5279071460569803, 'recall': 0.5235971154588078, 'f1-score': 0.5239720322070325, 'support': 190754}, 'weighted avg': {'precision': 0.5365014425141358, 'recall': 0.5387567233190392, 'f1-score': 0.5360285601080935, 'support': 190754}}
[[28511 17400  7410]
 [16966 51911 14743]
 [11648 19817 22348]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0204136
{'0': {'precision': 0.4201404327072305, 'recall': 0.5736073283198145, 'f1-score': 0.4850237466200773, 'support': 436553}, '1': {'precision': 0.5409485025253452, 'recall': 0.6458757685798848, 'f1-score': 0.5887738199107267, 'support': 684867}, '2': {'precision': 0.5577128719099239, 'recall': 0.18327958767432886, 'f1-score': 0.2758931859081739, 'support': 435384}, 'accuracy': 0.4962384474860034, 'macro avg': {'precision': 0.5062672690475, 'recall': 0.46758756152467607, 'f1-score': 0.44989691747965926, 'support': 1556804}, 'weighted avg': {'precision': 0.5117603792271188, 'recall': 0.4962384474860034, 'f1-score': 0.47217877795308766, 'support': 1556804}}
[[250410 161943  24200]
 [203446 442339  39082]
 [142159 213428  79797]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0782782
{'0': {'precision': 0.4552795945405985, 'recall': 0.5174804113262931, 'f1-score': 0.484391361549408, 'support': 209177}, '1': {'precision': 0.4316893165777725, 'recall': 0.5965221517914647, 'f1-score': 0.5008935378609984, 'support': 206507}, '2': {'precision': 0.4975067504976644, 'recall': 0.2416623983379846, 'f1-score': 0.3253076097777864, 'support': 208903}, 'accuracy': 0.451362260181528, 'macro avg': {'precision': 0.4614918872053451, 'recall': 0.4518883204852475, 'f1-score': 0.43686416972939757, 'support': 624587}, 'weighted avg': {'precision': 0.46160348861721173, 'recall': 0.451362260181528, 'f1-score': 0.43663939413290803, 'support': 624587}}
[[108245  76076  24856]
 [ 57187 123186  26134]
 [ 72323  86096  50484]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0381101
{'0': {'precision': 0.4530369674804784, 'recall': 0.5645158807137468, 'f1-score': 0.5026698380275414, 'support': 64953}, '1': {'precision': 0.5217841273412452, 'recall': 0.5542292480672951, 'f1-score': 0.5375175274935393, 'support': 83691}, '2': {'precision': 0.4610522267887615, 'recall': 0.30549097047488616, 'f1-score': 0.3674869014664611, 'support': 62794}, 'accuracy': 0.4835176269166375, 'macro avg': {'precision': 0.47862444053682834, 'recall': 0.4747453664186427, 'f1-score': 0.469224755662514, 'support': 211438}, 'weighted avg': {'precision': 0.48262875679418626, 'recall': 0.4835176269166375, 'f1-score': 0.47631582720962956, 'support': 211438}}
[[36667 19449  8837]
 [23720 46384 13587]
 [20549 23062 19183]]
testing model on single stock: results/universal/W3/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
13689/13689 - 185s - 185s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1262574
{'0': {'precision': 0.4177894038218458, 'recall': 0.3287138152571801, 'f1-score': 0.36793719141287007, 'support': 1143265}, '1': {'precision': 0.34806327387417013, 'recall': 0.6190760972981789, 'f1-score': 0.44559793474574466, 'support': 1213959}, '2': {'precision': 0.4300075412750141, 'recall': 0.1670316698371958, 'f1-score': 0.24060355274807388, 'support': 1147022}, 'accuracy': 0.3763802541259946, 'macro avg': {'precision': 0.39862007299034335, 'recall': 0.37160719413085164, 'f1-score': 0.3513795596355629, 'support': 3504246}, 'weighted avg': {'precision': 0.39763380101104356, 'recall': 0.3763802541259946, 'f1-score': 0.3531615373711907, 'support': 3504246}}
[[375807 670774  96684]
 [305151 751533 157275]
 [218555 736878 191589]]
Evaluating performance on  train set...
5475/5475 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.154334
{'0': {'precision': 0.3840554282353909, 'recall': 0.34072176789981384, 'f1-score': 0.36109316125744034, 'support': 465773}, '1': {'precision': 0.3300542127851818, 'recall': 0.6316001054720088, 'f1-score': 0.4335492944791192, 'support': 462682}, '2': {'precision': 0.42137216237481423, 'recall': 0.09168884257605509, 'f1-score': 0.15060636255377066, 'support': 473111}, 'accuracy': 0.3526826421303028, 'macro avg': {'precision': 0.378493934465129, 'recall': 0.3546702386492926, 'f1-score': 0.31508293943011006, 'support': 1401566}, 'weighted avg': {'precision': 0.37882525501379666, 'recall': 0.3526826421303028, 'f1-score': 0.31396054588990213, 'support': 1401566}}
[[158699 281226  25848]
 [136732 292230  33720]
 [117788 311944  43379]]
Evaluating performance on  val set...
2036/2036 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1313493
{'0': {'precision': 0.40088004909966607, 'recall': 0.22660559090214158, 'f1-score': 0.28954179861979845, 'support': 170062}, '1': {'precision': 0.3430049932880174, 'recall': 0.7148498551111556, 'f1-score': 0.463574128578024, 'support': 179793}, '2': {'precision': 0.4290421182168235, 'recall': 0.12614305472073575, 'f1-score': 0.19496444081662107, 'support': 171361}, 'accuracy': 0.36199579444990176, 'macro avg': {'precision': 0.39097572020150234, 'recall': 0.3558661669113443, 'f1-score': 0.3160267893381479, 'support': 521216}, 'weighted avg': {'precision': 0.39017498712236964, 'recall': 0.36199579444990176, 'f1-score': 0.3184797515791645, 'support': 521216}}
[[ 38537 119598  11927]
 [ 34429 128525  16839]
 [ 23165 126580  21616]]
training model: results/universal/W3/deepLOB_L2/h100
Epoch 1/50
10532/10532 - 422s - loss: 3.1950 - accuracy100: 0.4155 - val_loss: 3.4426 - val_accuracy100: 0.3828 - 422s/epoch - 40ms/step
Epoch 2/50
10532/10532 - 417s - loss: 3.1585 - accuracy100: 0.4329 - val_loss: 3.4285 - val_accuracy100: 0.3909 - 417s/epoch - 40ms/step
Epoch 3/50
10532/10532 - 417s - loss: 3.1410 - accuracy100: 0.4397 - val_loss: 3.3807 - val_accuracy100: 0.3786 - 417s/epoch - 40ms/step
Epoch 4/50
10532/10532 - 419s - loss: 3.1236 - accuracy100: 0.4460 - val_loss: 3.3463 - val_accuracy100: 0.3902 - 419s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 416s - loss: 3.1127 - accuracy100: 0.4494 - val_loss: 3.3410 - val_accuracy100: 0.3797 - 416s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 414s - loss: 3.1047 - accuracy100: 0.4519 - val_loss: 3.3308 - val_accuracy100: 0.3755 - 414s/epoch - 39ms/step
Epoch 7/50
10532/10532 - 414s - loss: 3.0995 - accuracy100: 0.4532 - val_loss: 3.3192 - val_accuracy100: 0.3757 - 414s/epoch - 39ms/step
Epoch 8/50
10532/10532 - 419s - loss: 3.0946 - accuracy100: 0.4551 - val_loss: 3.2922 - val_accuracy100: 0.3899 - 419s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 419s - loss: 3.0905 - accuracy100: 0.4563 - val_loss: 3.2985 - val_accuracy100: 0.3925 - 419s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 419s - loss: 3.0869 - accuracy100: 0.4576 - val_loss: 3.3303 - val_accuracy100: 0.3933 - 419s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 419s - loss: 3.0839 - accuracy100: 0.4585 - val_loss: 3.3146 - val_accuracy100: 0.3933 - 419s/epoch - 40ms/step
Epoch 12/50
10532/10532 - 420s - loss: 3.0812 - accuracy100: 0.4595 - val_loss: 3.3232 - val_accuracy100: 0.3917 - 420s/epoch - 40ms/step
Epoch 13/50
10532/10532 - 419s - loss: 3.0786 - accuracy100: 0.4606 - val_loss: 3.3274 - val_accuracy100: 0.3926 - 419s/epoch - 40ms/step
Epoch 14/50
10532/10532 - 418s - loss: 3.0762 - accuracy100: 0.4610 - val_loss: 3.3286 - val_accuracy100: 0.3907 - 418s/epoch - 40ms/step
Epoch 15/50
10532/10532 - 420s - loss: 3.0738 - accuracy100: 0.4619 - val_loss: 3.3576 - val_accuracy100: 0.3812 - 420s/epoch - 40ms/step
Epoch 16/50
10532/10532 - 419s - loss: 3.0719 - accuracy100: 0.4625 - val_loss: 3.4181 - val_accuracy100: 0.3767 - 419s/epoch - 40ms/step
Epoch 17/50
10532/10532 - 418s - loss: 3.0699 - accuracy100: 0.4628 - val_loss: 3.3517 - val_accuracy100: 0.3789 - 418s/epoch - 40ms/step
Epoch 18/50
10532/10532 - 418s - loss: 3.0678 - accuracy100: 0.4637 - val_loss: 3.3559 - val_accuracy100: 0.3795 - 418s/epoch - 40ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 363s - 363s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1136436
{'0': {'precision': 0.4438516517924301, 'recall': 0.05402342998172407, 'f1-score': 0.09632291115046397, 'support': 2348444}, '1': {'precision': 0.41855821672135624, 'recall': 0.32258926850698666, 'f1-score': 0.3643603780646481, 'support': 2412805}, '2': {'precision': 0.35743536292893213, 'recall': 0.7595409998503373, 'f1-score': 0.48611022039068696, 'support': 2325228}, 'accuracy': 0.37696051225453775, 'macro avg': {'precision': 0.4066150771475728, 'recall': 0.37871789944634937, 'f1-score': 0.31559783653526635, 'support': 7086477}, 'weighted avg': {'precision': 0.4068846650755952, 'recall': 0.37696051225453775, 'f1-score': 0.3154820936113544, 'support': 7086477}}
[[ 126871  592730 1628843]
 [  88359  778345 1546101]
 [  70611  488511 1766106]]
Evaluating performance on  train set...
10532/10532 - 143s - 143s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1045287
{'0': {'precision': 0.3817340341686864, 'recall': 0.2166497946774199, 'f1-score': 0.27641990353752943, 'support': 892011}, '1': {'precision': 0.4030202453310661, 'recall': 0.43571744222015996, 'f1-score': 0.41873151299849876, 'support': 905160}, '2': {'precision': 0.3803811689743418, 'recall': 0.5125829450601299, 'f1-score': 0.43669593609392504, 'support': 898637}, 'accuracy': 0.3888533604767105, 'macro avg': {'precision': 0.3883784828246981, 'recall': 0.38831672731923667, 'f1-score': 0.3772824508766511, 'support': 2695808}, 'weighted avg': {'precision': 0.38843024256931785, 'recall': 0.3888533604767105, 'f1-score': 0.377630653519751, 'support': 2695808}}
[[193254 290587 408170]
 [168603 394394 342163]
 [144396 293615 460626]]
Evaluating performance on  val set...
3814/3814 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967239
{'0': {'precision': 0.3899128609881838, 'recall': 0.16422417934347477, 'f1-score': 0.23110932838175247, 'support': 312250}, '1': {'precision': 0.4065214283548274, 'recall': 0.5358194084009239, 'f1-score': 0.46229997204257905, 'support': 350271}, '2': {'precision': 0.36984604448532965, 'recall': 0.45168425285815506, 'f1-score': 0.4066889189993059, 'support': 313314}, 'accuracy': 0.3899019813800489, 'macro avg': {'precision': 0.38876011127611365, 'recall': 0.38390928020085124, 'f1-score': 0.36669940647454585, 'support': 975835}, 'weighted avg': {'precision': 0.38943151419728816, 'recall': 0.3899019813800489, 'f1-score': 0.3704678488288255, 'support': 975835}}
[[ 51279 136770 124201]
 [ 45666 187682 116923]
 [ 34569 137226 141519]]
testing model out of sample: results/universal/W3/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 219s - 219s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054332
{'0': {'precision': 0.38770497989283365, 'recall': 0.27617328797106233, 'f1-score': 0.32257045980517035, 'support': 1302110}, '1': {'precision': 0.43694421216260654, 'recall': 0.4238509567689743, 'f1-score': 0.430298005992891, 'support': 1564432}, '2': {'precision': 0.3378578438907874, 'recall': 0.44998547153720586, 'f1-score': 0.38594252998935263, 'support': 1269921}, 'accuracy': 0.38538722575301654, 'macro avg': {'precision': 0.38750234531540917, 'recall': 0.3833365720924142, 'f1-score': 0.3796036652624713, 'support': 4136463}, 'weighted avg': {'precision': 0.39102412134760084, 'recall': 0.38538722575301654, 'f1-score': 0.38276921977906964, 'support': 4136463}}
[[359608 426649 515853]
 [297265 663086 604081]
 [270657 427818 571446]]
Evaluating performance on  train set...
6181/6181 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1282301
{'0': {'precision': 0.3690913396910535, 'recall': 0.20970132282151385, 'f1-score': 0.2674496315802832, 'support': 527660}, '1': {'precision': 0.3835775560045443, 'recall': 0.4312516372299885, 'f1-score': 0.4060199374423366, 'support': 522987}, '2': {'precision': 0.3736423028042985, 'recall': 0.4882140301991942, 'f1-score': 0.4233128133300031, 'support': 531140}, 'accuracy': 0.3764729385182708, 'macro avg': {'precision': 0.37543706616663214, 'recall': 0.37638899675023224, 'f1-score': 0.3655941274508743, 'support': 1581787}, 'weighted avg': {'precision': 0.3754090685376761, 'recall': 0.3764729385182708, 'f1-score': 0.36560168296673656, 'support': 1581787}}
[[110651 184956 232053]
 [ 94805 225539 202643]
 [ 94337 177493 259310]]
Evaluating performance on  val set...
2209/2209 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1171163
{'0': {'precision': 0.3644478807900471, 'recall': 0.1663511822644294, 'f1-score': 0.2284342232795841, 'support': 187014}, '1': {'precision': 0.3913963431539932, 'recall': 0.411216386103701, 'f1-score': 0.40106164255541854, 'support': 195678}, '2': {'precision': 0.3595992358744526, 'recall': 0.5408330311919751, 'f1-score': 0.4319772888324327, 'support': 182034}, 'accuracy': 0.3719077924515606, 'macro avg': {'precision': 0.3718144866061643, 'recall': 0.3728001998533685, 'f1-score': 0.3538243848891451, 'support': 564726}, 'weighted avg': {'precision': 0.3722226299425333, 'recall': 0.3719077924515606, 'f1-score': 0.3538599103276463, 'support': 564726}}
[[31110 66935 88969]
 [28854 80466 86358]
 [25398 58186 98450]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1405425
{'0': {'precision': 0.47586206896551725, 'recall': 0.017834607957914583, 'f1-score': 0.03438067882056393, 'support': 65771}, '1': {'precision': 0.28828339723796276, 'recall': 0.19068566939737402, 'f1-score': 0.22954097209088697, 'support': 44555}, '2': {'precision': 0.37429306639520415, 'recall': 0.8395331874544129, 'f1-score': 0.5177535913006914, 'support': 63066}, 'accuracy': 0.3611181600073821, 'macro avg': {'precision': 0.37947951086622805, 'recall': 0.34935115493656715, 'f1-score': 0.2605584140707141, 'support': 173392}, 'weighted avg': {'precision': 0.39071904947834046, 'recall': 0.3611181600073821, 'f1-score': 0.2603412938727634, 'support': 173392}}
[[ 1173 11570 53028]
 [  577  8496 35482]
 [  715  9405 52946]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1537431
{'0': {'precision': 0.33258518669659254, 'recall': 0.2228805834092981, 'f1-score': 0.2668995442512895, 'support': 21940}, '1': {'precision': 0.3455763130066972, 'recall': 0.22367220295674392, 'f1-score': 0.2715714246142766, 'support': 21916}, '2': {'precision': 0.34285943217328596, 'recall': 0.5712187958883994, 'f1-score': 0.4285142036919585, 'support': 22473}, 'accuracy': 0.3411629905471212, 'macro avg': {'precision': 0.3403403106255252, 'recall': 0.33925719408481375, 'f1-score': 0.32232839085250814, 'support': 66329}, 'weighted avg': {'precision': 0.34035865897583667, 'recall': 0.3411629905471212, 'f1-score': 0.32320003380556256, 'support': 66329}}
[[ 4890  4555 12495]
 [ 4905  4902 12109]
 [ 4908  4728 12837]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1671776
{'0': {'precision': 0.3053704429635437, 'recall': 0.20994475138121546, 'f1-score': 0.24882216721232933, 'support': 7421}, '1': {'precision': 0.3671875, 'recall': 0.19429257234297906, 'f1-score': 0.2541205197523328, 'support': 7499}, '2': {'precision': 0.33138992537313433, 'recall': 0.6077844311377245, 'f1-score': 0.42891638997887116, 'support': 7014}, 'accuracy': 0.33181362268624054, 'macro avg': {'precision': 0.33464928944555933, 'recall': 0.337340584953973, 'f1-score': 0.3106196923145111, 'support': 21934}, 'weighted avg': {'precision': 0.3348254789960619, 'recall': 0.33181362268624054, 'f1-score': 0.3082237001831514, 'support': 21934}}
[[1558 1232 4631]
 [2072 1457 3970]
 [1472 1279 4263]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965447
{'0': {'precision': 0.5382653061224489, 'recall': 0.03169936043267373, 'f1-score': 0.05987271474319996, 'support': 93188}, '1': {'precision': 0.5372216503223709, 'recall': 0.4276641399165418, 'f1-score': 0.4762230667170962, 'support': 185482}, '2': {'precision': 0.27724183242415407, 'recall': 0.6613467545224772, 'f1-score': 0.39069937274232874, 'support': 90603}, 'accuracy': 0.3850755403184094, 'macro avg': {'precision': 0.45090959628965804, 'recall': 0.37357008495723093, 'f1-score': 0.30893171806754166, 'support': 369273}, 'weighted avg': {'precision': 0.4736976579255954, 'recall': 0.3850755403184094, 'f1-score': 0.350171175988721, 'support': 369273}}
[[  2954  38165  52069]
 [  2018  79324 104140]
 [   516  30167  59920]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964953
{'0': {'precision': 0.3963377166031707, 'recall': 0.2914859002169197, 'f1-score': 0.3359200041664496, 'support': 55320}, '1': {'precision': 0.3886157952991731, 'recall': 0.441524577430928, 'f1-score': 0.413384122586789, 'support': 54074}, '2': {'precision': 0.4000710204345159, 'recall': 0.4532835902781588, 'f1-score': 0.42501821923093414, 'support': 54681}, 'accuracy': 0.3948560109705927, 'macro avg': {'precision': 0.39500817744561995, 'recall': 0.39543135597533546, 'f1-score': 0.39144078199472426, 'support': 164075}, 'weighted avg': {'precision': 0.39503700421072474, 'recall': 0.3948560109705927, 'f1-score': 0.3911433729758509, 'support': 164075}}
[[16125 18946 20249]
 [13280 23875 16919]
 [11280 18615 24786]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1264267
{'0': {'precision': 0.3559631504689186, 'recall': 0.39656049188664416, 'f1-score': 0.37516674320453103, 'support': 21631}, '1': {'precision': 0.3923254445902529, 'recall': 0.3359683794466403, 'f1-score': 0.3619663918171381, 'support': 25806}, '2': {'precision': 0.34098223615464995, 'recall': 0.35962089486444787, 'f1-score': 0.3500536365586784, 'support': 22685}, 'accuracy': 0.3623114001311999, 'macro avg': {'precision': 0.36309027707127384, 'recall': 0.3640499220659108, 'f1-score': 0.36239559052678255, 'support': 70122}, 'weighted avg': {'precision': 0.3644986075419622, 'recall': 0.3623114001311999, 'f1-score': 0.3621845251821667, 'support': 70122}}
[[8578 6214 6839]
 [8208 8670 8928]
 [7312 7215 8158]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
1359/1359 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198077
{'0': {'precision': 0.34933661111311953, 'recall': 0.27813864236027824, 'f1-score': 0.30969830349130373, 'support': 104225}, '1': {'precision': 0.444040094900695, 'recall': 0.481862645911682, 'f1-score': 0.4621788565654132, 'support': 143323}, '2': {'precision': 0.33429410634384693, 'recall': 0.3644180224033196, 'f1-score': 0.34870669084661643, 'support': 100253}, 'accuracy': 0.3869597844744552, 'macro avg': {'precision': 0.37589027078588716, 'recall': 0.3748064368917599, 'f1-score': 0.37352795030111113, 'support': 347801}, 'weighted avg': {'precision': 0.38402636524336303, 'recall': 0.3869597844744552, 'f1-score': 0.383777096150821, 'support': 347801}}
[[28989 45631 29605]
 [31113 69062 43148]
 [22881 40838 36534]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1650522
{'0': {'precision': 0.3470734073515145, 'recall': 0.43372487741796434, 'f1-score': 0.3855909368525682, 'support': 37118}, '1': {'precision': 0.3541974700180713, 'recall': 0.455886239890046, 'f1-score': 0.39865942447705993, 'support': 37834}, '2': {'precision': 0.37367624810892586, 'recall': 0.17899940471568704, 'f1-score': 0.24205092309038412, 'support': 38637}, 'accuracy': 0.3544621398198769, 'macro avg': {'precision': 0.35831570849283717, 'recall': 0.35620350734123246, 'f1-score': 0.342100428140004, 'support': 113589}, 'weighted avg': {'precision': 0.3584951624974407, 'recall': 0.3544621398198769, 'f1-score': 0.34111900426275327, 'support': 113589}}
[[16099 15268  5751]
 [14745 17248  5841]
 [15541 16180  6916]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1410923
{'0': {'precision': 0.36300518134715026, 'recall': 0.28279648018083475, 'f1-score': 0.31791986205018835, 'support': 12387}, '1': {'precision': 0.36207777048223533, 'recall': 0.41688366232675345, 'f1-score': 0.38755270966734345, 'support': 11905}, '2': {'precision': 0.3745577719232217, 'recall': 0.402914979757085, 'f1-score': 0.38821923151940707, 'support': 12350}, 'accuracy': 0.36684678783909175, 'macro avg': {'precision': 0.3665469079175357, 'recall': 0.3675317074215578, 'f1-score': 0.364563934412313, 'support': 36642}, 'weighted avg': {'precision': 0.36659760717728157, 'recall': 0.36684678783909175, 'f1-score': 0.3642376466642128, 'support': 36642}}
[[3503 4410 4474]
 [3107 4963 3835]
 [3040 4334 4976]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1486561
{'0': {'precision': 0.34421309322828736, 'recall': 0.21613200274113414, 'f1-score': 0.2655344563351378, 'support': 93392}, '1': {'precision': 0.3309410138827816, 'recall': 0.20597808556599256, 'f1-score': 0.25391756987161335, 'support': 102307}, '2': {'precision': 0.3397760030244317, 'recall': 0.5997539257189332, 'f1-score': 0.43379563640203017, 'support': 95906}, 'accuracy': 0.3387390476843676, 'macro avg': {'precision': 0.3383100367118335, 'recall': 0.3406213380086866, 'f1-score': 0.3177492208695938, 'support': 291605}, 'weighted avg': {'precision': 0.33809738809740264, 'recall': 0.3387390476843676, 'f1-score': 0.31679821358234406, 'support': 291605}}
[[20185 21758 51449]
 [20915 21073 60319]
 [17541 20845 57520]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1484883
{'0': {'precision': 0.3404012598268978, 'recall': 0.41245229724450855, 'f1-score': 0.37297899513600175, 'support': 33279}, '1': {'precision': 0.3277210990799274, 'recall': 0.3215623656574341, 'f1-score': 0.3246125232486051, 'support': 32566}, '2': {'precision': 0.34813709739117127, 'recall': 0.2793946091975195, 'f1-score': 0.31000068124531643, 'support': 32574}, 'accuracy': 0.33833914183236974, 'macro avg': {'precision': 0.33875315209933216, 'recall': 0.3378030906998207, 'f1-score': 0.33586406654330775, 'support': 98419}, 'weighted avg': {'precision': 0.3387658546503852, 'recall': 0.33833914183236974, 'f1-score': 0.3361308446756217, 'support': 98419}}
[[13726 10922  8631]
 [13684 10472  8410]
 [12913 10560  9101]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.171902
{'0': {'precision': 0.29298162976919456, 'recall': 0.26479352916134524, 'f1-score': 0.27817531305903404, 'support': 11745}, '1': {'precision': 0.3446126447016919, 'recall': 0.24244322631166798, 'f1-score': 0.2846373080812724, 'support': 12770}, '2': {'precision': 0.30959928988080143, 'recall': 0.4497973470891673, 'f1-score': 0.36675679735616645, 'support': 10856}, 'accuracy': 0.3135054140397501, 'macro avg': {'precision': 0.3157311881172293, 'recall': 0.31901136752072684, 'f1-score': 0.3098564728321576, 'support': 35371}, 'weighted avg': {'precision': 0.31672224719193054, 'recall': 0.3135054140397501, 'f1-score': 0.3076955491271026, 'support': 35371}}
[[3110 3078 5557]
 [4342 3096 5332]
 [3163 2810 4883]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
2282/2282 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1271248
{'0': {'precision': 0.3822573782539744, 'recall': 0.19878506270806304, 'f1-score': 0.2615542395871241, 'support': 198858}, '1': {'precision': 0.353575257539738, 'recall': 0.32235992839043154, 'f1-score': 0.3372468161848683, 'support': 188243}, '2': {'precision': 0.3645046753776391, 'recall': 0.5719676577244609, 'f1-score': 0.44525583519322803, 'support': 196894}, 'accuracy': 0.3644363393522205, 'macro avg': {'precision': 0.3667791037237838, 'recall': 0.36437088294098513, 'f1-score': 0.34801896365507345, 'support': 583995}, 'weighted avg': {'precision': 0.3670267527696069, 'recall': 0.3644363393522205, 'f1-score': 0.3478877521373298, 'support': 583995}}
[[ 39530  58976 100352]
 [ 31571  60682  95990]
 [ 32311  51966 112617]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1391013
{'0': {'precision': 0.36607544439446976, 'recall': 0.25056215868936715, 'f1-score': 0.2974993841826315, 'support': 74712}, '1': {'precision': 0.37264669553296326, 'recall': 0.3679371716521926, 'f1-score': 0.37027695918105863, 'support': 74616}, '2': {'precision': 0.35987111364614294, 'recall': 0.47686799708280847, 'f1-score': 0.4101900221274266, 'support': 75415}, 'accuracy': 0.36547078218231493, 'macro avg': {'precision': 0.366197751191192, 'recall': 0.3651224424747894, 'f1-score': 0.3593221218303722, 'support': 224743}, 'weighted avg': {'precision': 0.3661752066632157, 'recall': 0.36547078218231493, 'f1-score': 0.35947655809545354, 'support': 224743}}
[[18720 23210 32782]
 [15974 27454 31188]
 [16443 23009 35963]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1378187
{'0': {'precision': 0.3378547206853471, 'recall': 0.30131317150815756, 'f1-score': 0.3185393967439316, 'support': 25130}, '1': {'precision': 0.3660179908970362, 'recall': 0.380244983059682, 'f1-score': 0.3729958730506556, 'support': 26859}, '2': {'precision': 0.35572231258317316, 'recall': 0.37918669713925446, 'f1-score': 0.367079916078581, 'support': 25378}, 'accuracy': 0.3542595680328822, 'macro avg': {'precision': 0.35319834138851885, 'recall': 0.353581617235698, 'f1-score': 0.3528717286243894, 'support': 77367}, 'weighted avg': {'precision': 0.3534929258865154, 'recall': 0.3542595680328822, 'f1-score': 0.3533670079579768, 'support': 77367}}
[[ 7572  8787  8771]
 [ 7988 10213  8658]
 [ 6852  8903  9623]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
5098/5098 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0716102
{'0': {'precision': 0.46462980868844533, 'recall': 0.1293517630573922, 'f1-score': 0.20236548668074203, 'support': 416067}, '1': {'precision': 0.4686579414049332, 'recall': 0.3965737837407684, 'f1-score': 0.42961312606011076, 'support': 483799}, '2': {'precision': 0.3593504109950968, 'recall': 0.6917330173190633, 'f1-score': 0.4729872765117688, 'support': 405045}, 'accuracy': 0.40298840304051387, 'macro avg': {'precision': 0.43087938702949174, 'recall': 0.40588618803907467, 'f1-score': 0.36832196308420717, 'support': 1304911}, 'weighted avg': {'precision': 0.43344447339845377, 'recall': 0.40298840304051387, 'f1-score': 0.3706192477006181, 'support': 1304911}}
[[ 53819 121947 240301]
 [ 32728 191862 259209]
 [ 29285  95577 280183]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0393945
{'0': {'precision': 0.42222442202643967, 'recall': 0.31095411044245913, 'f1-score': 0.3581458369115093, 'support': 150884}, '1': {'precision': 0.477957793870971, 'recall': 0.5359999098875847, 'f1-score': 0.5053175955866347, 'support': 177556}, '2': {'precision': 0.4208439235620823, 'recall': 0.471314580903622, 'f1-score': 0.4446516543117783, 'support': 151767}, 'accuracy': 0.44484566030899175, 'macro avg': {'precision': 0.4403420464864976, 'recall': 0.4394228670778886, 'f1-score': 0.4360383622699741, 'support': 480207}, 'weighted avg': {'precision': 0.44239547422015507, 'recall': 0.44484566030899175, 'f1-score': 0.4399021569416363, 'support': 480207}}
[[46918 50595 53371]
 [37319 95170 45067]
 [26884 53353 71530]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0368333
{'0': {'precision': 0.4003998720409469, 'recall': 0.519691087628973, 'f1-score': 0.4523123345589896, 'support': 48169}, '1': {'precision': 0.47428260453896953, 'recall': 0.5288657088499639, 'f1-score': 0.5000891742464776, 'support': 60972}, '2': {'precision': 0.459641818899616, 'recall': 0.26014096808921205, 'f1-score': 0.3322437543777726, 'support': 49231}, 'accuracy': 0.4425403480413204, 'macro avg': {'precision': 0.44477476515984415, 'recall': 0.43623258818938293, 'f1-score': 0.4282150877277466, 'support': 158372}, 'weighted avg': {'precision': 0.44725991202066917, 'recall': 0.4425403480413204, 'f1-score': 0.43338192513386403, 'support': 158372}}
[[25033 16208  6928]
 [20598 32246  8128]
 [16889 19535 12807]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
5760/5760 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0949115
{'0': {'precision': 0.4800498753117207, 'recall': 0.0009013016200018728, 'f1-score': 0.0017992251648510848, 'support': 427160}, '1': {'precision': 0.5191507472198394, 'recall': 0.36878562734676423, 'f1-score': 0.43123660542560405, 'support': 638379}, '2': {'precision': 0.31051433657325905, 'recall': 0.7746593565678401, 'f1-score': 0.4433259628302732, 'support': 408932}, 'accuracy': 0.37477373240979306, 'macro avg': {'precision': 0.4365716530349397, 'recall': 0.38144876184486876, 'f1-score': 0.29212059780690947, 'support': 1474471}, 'weighted avg': {'precision': 0.449959536865211, 'recall': 0.37477373240979306, 'f1-score': 0.3101798018330091, 'support': 1474471}}
[[   385 126125 300650]
 [   199 235425 402755]
 [   218  91931 316783]]
Evaluating performance on  train set...
2159/2159 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1000606
{'0': {'precision': 0.4199609951507485, 'recall': 0.17243431588971128, 'f1-score': 0.24448433520513055, 'support': 184824}, '1': {'precision': 0.3938762196505559, 'recall': 0.4561800213528977, 'f1-score': 0.4227448811586556, 'support': 182645}, '2': {'precision': 0.37945042717311356, 'recall': 0.5435672988598909, 'f1-score': 0.4469184890656064, 'support': 185070}, 'accuracy': 0.39053713855492556, 'macro avg': {'precision': 0.39776254732480604, 'recall': 0.39072721203416655, 'f1-score': 0.3713825684764642, 'support': 552539}, 'weighted avg': {'precision': 0.39776972062197574, 'recall': 0.39053713855492556, 'f1-score': 0.37121364530023665, 'support': 552539}}
[[ 31870  66197  86757]
 [ 21566  83319  77760]
 [ 22452  62020 100598]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920255
{'0': {'precision': 0.5003806784535996, 'recall': 0.08436140626114241, 'f1-score': 0.1443809802772896, 'support': 70115}, '1': {'precision': 0.41286695815115554, 'recall': 0.410479332427712, 'f1-score': 0.4116696833459839, 'support': 77295}, '2': {'precision': 0.36585688084802137, 'recall': 0.6731536426681919, 'f1-score': 0.47406236311181155, 'support': 69935}, 'accuracy': 0.38979502634061053, 'macro avg': {'precision': 0.4263681724842588, 'recall': 0.3893314604523488, 'f1-score': 0.34337100891169503, 'support': 217345}, 'weighted avg': {'precision': 0.425972273400235, 'recall': 0.38979502634061053, 'f1-score': 0.34551902261655215, 'support': 217345}}
[[ 5915 25279 38921]
 [ 2889 31728 42678]
 [ 3017 19841 47077]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
6315/6315 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.086876
{'0': {'precision': 0.47101917210358724, 'recall': 0.08095308257382812, 'f1-score': 0.13816076300951802, 'support': 522599}, '1': {'precision': 0.453729431200349, 'recall': 0.45216479072577265, 'f1-score': 0.45294575975684076, 'support': 584329}, '2': {'precision': 0.3625334900615264, 'recall': 0.6719030291611222, 'f1-score': 0.4709565944708576, 'support': 509514}, 'accuracy': 0.40141434087953665, 'macro avg': {'precision': 0.42909403112182093, 'recall': 0.4016736341535743, 'f1-score': 0.3540210390790721, 'support': 1616442}, 'weighted avg': {'precision': 0.4305736313342761, 'recall': 0.40141434087953665, 'f1-score': 0.356852270428627, 'support': 1616442}}
[[ 42306 170729 309564]
 [ 27714 264213 292402]
 [ 19798 147372 342344]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0785205
{'0': {'precision': 0.42024671312270256, 'recall': 0.3055318730325289, 'f1-score': 0.3538235154507049, 'support': 182976}, '1': {'precision': 0.42101616858390317, 'recall': 0.4642028905863604, 'f1-score': 0.44155606550864335, 'support': 181970}, '2': {'precision': 0.41227578989884156, 'recall': 0.4813901765856534, 'f1-score': 0.44416039716073585, 'support': 186595}, 'accuracy': 0.4173778558620302, 'macro avg': {'precision': 0.4178462238684824, 'recall': 0.4170416467348475, 'f1-score': 0.41317999270669475, 'support': 551541}, 'weighted avg': {'precision': 0.4178038909051673, 'recall': 0.4173778558620302, 'f1-score': 0.41333151680822194, 'support': 551541}}
[[55905 56939 70132]
 [39580 84471 57919]
 [37544 59226 89825]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0804985
{'0': {'precision': 0.46018336293380696, 'recall': 0.15497397432996024, 'f1-score': 0.2318640788439446, 'support': 61862}, '1': {'precision': 0.41360449721094783, 'recall': 0.5709320789765407, 'f1-score': 0.4796979232221523, 'support': 66754}, '2': {'precision': 0.39303117968498874, 'recall': 0.49193730084650295, 'f1-score': 0.43695725200660407, 'support': 62138}, 'accuracy': 0.4103033226039821, 'macro avg': {'precision': 0.42227301327658123, 'recall': 0.40594778471766796, 'f1-score': 0.382839751357567, 'support': 190754}, 'weighted avg': {'precision': 0.42200839430835846, 'recall': 0.4103033226039821, 'f1-score': 0.3854020389475556, 'support': 190754}}
[[ 9587 27003 25272]
 [ 6707 38112 21935]
 [ 4539 27031 30568]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
6082/6082 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1000603
{'0': {'precision': 0.3924261881153248, 'recall': 0.5724210426480352, 'f1-score': 0.4656343524676853, 'support': 506096}, '1': {'precision': 0.40953582939756583, 'recall': 0.5263305281380244, 'f1-score': 0.4606452783405401, 'support': 549932}, '2': {'precision': 0.4744745550487434, 'recall': 0.10593758486828442, 'f1-score': 0.17320343592573123, 'support': 500776}, 'accuracy': 0.40608644376556075, 'macro avg': {'precision': 0.42547885752054465, 'recall': 0.4015630518847813, 'f1-score': 0.36649435557798554, 'support': 1556804}, 'weighted avg': {'precision': 0.4248625078120079, 'recall': 0.40608644376556075, 'f1-score': 0.3698059526337288, 'support': 1556804}}
[[289700 184253  32143]
 [233870 289446  26616]
 [214658 233067  53051]]
Evaluating performance on  train set...
2440/2440 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1393957
{'0': {'precision': 0.3506726296638196, 'recall': 0.18715142586551614, 'f1-score': 0.2440533552892157, 'support': 209066}, '1': {'precision': 0.38576478416368626, 'recall': 0.4503485843010836, 'f1-score': 0.4155623650422457, 'support': 205976}, '2': {'precision': 0.37774353329664284, 'recall': 0.49132167314896563, 'f1-score': 0.4271108391499601, 'support': 209545}, 'accuracy': 0.3759956579307607, 'macro avg': {'precision': 0.3713936490413829, 'recall': 0.37627389443852177, 'f1-score': 0.3622421864938072, 'support': 624587}, 'weighted avg': {'precision': 0.3713274209371002, 'recall': 0.3759956579307607, 'f1-score': 0.36202814542812317, 'support': 624587}}
[[ 39127  75844  94095]
 [ 37714  92761  75501]
 [ 34736  71855 102954]]
Evaluating performance on  val set...
826/826 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1269058
{'0': {'precision': 0.3460871002396496, 'recall': 0.17459457205986575, 'f1-score': 0.23209931279095544, 'support': 71961}, '1': {'precision': 0.38710572007330957, 'recall': 0.4451608430393788, 'f1-score': 0.41410845114023315, 'support': 72120}, '2': {'precision': 0.3550689269948698, 'recall': 0.4860222397078255, 'f1-score': 0.4103512246483994, 'support': 67357}, 'accuracy': 0.3660931336845789, 'macro avg': {'precision': 0.36275391576927635, 'recall': 0.3685925516023567, 'f1-score': 0.35218632952652934, 'support': 211438}, 'weighted avg': {'precision': 0.3629395665283722, 'recall': 0.3660931336845789, 'f1-score': 0.35096637114721946, 'support': 211438}}
[[12564 27146 32251]
 [12804 32105 27211]
 [10935 23685 32737]]
testing model on single stock: results/universal/W3/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
13689/13689 - 183s - 183s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1404434
{'0': {'precision': 0.47411545623836127, 'recall': 0.006244287515185604, 'f1-score': 0.012326233672339725, 'support': 1223198}, '1': {'precision': 0.33793395711572294, 'recall': 0.20975164823519615, 'f1-score': 0.2588426783802308, 'support': 1056888}, '2': {'precision': 0.36239088631980504, 'recall': 0.8384042935563979, 'f1-score': 0.5060481256554622, 'support': 1224160}, 'accuracy': 0.3583261563257831, 'macro avg': {'precision': 0.3914800998912964, 'recall': 0.35146674310225984, 'f1-score': 0.2590723459026776, 'support': 3504246}, 'weighted avg': {'precision': 0.39401339098488686, 'recall': 0.3583261563257831, 'f1-score': 0.259151046629105, 'support': 3504246}}
[[   7638  239959  975601]
 [   5008  221684  830196]
 [   3464  194355 1026341]]
Evaluating performance on  train set...
5475/5475 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1347877
{'0': {'precision': 0.33501871829519525, 'recall': 0.12883557092718165, 'f1-score': 0.1861029588201635, 'support': 469552}, '1': {'precision': 0.37189457008721194, 'recall': 0.392800341616666, 'f1-score': 0.3820616874516577, 'support': 458994}, '2': {'precision': 0.3606122266020826, 'recall': 0.5612489958141305, 'f1-score': 0.43909700318718375, 'support': 473020}, 'accuracy': 0.36121738112939383, 'macro avg': {'precision': 0.35584183832816324, 'recall': 0.360961636119326, 'f1-score': 0.33575388315300164, 'support': 1401566}, 'weighted avg': {'precision': 0.3557327167916975, 'recall': 0.36121738112939383, 'f1-score': 0.3356607559955887, 'support': 1401566}}
[[ 60495 152840 256217]
 [ 64202 180293 214499]
 [ 55875 151663 265482]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111769
{'0': {'precision': 0.3708271787296898, 'recall': 0.029737685305283607, 'f1-score': 0.05505995624592204, 'support': 168843}, '1': {'precision': 0.3907767169786205, 'recall': 0.5744663503090195, 'f1-score': 0.4651430960685717, 'support': 183969}, '2': {'precision': 0.35868987902036, 'recall': 0.5052849100971474, 'f1-score': 0.41955062938511073, 'support': 168404}, 'accuracy': 0.3756542393172888, 'macro avg': {'precision': 0.3734312582428901, 'recall': 0.3698296485704835, 'f1-score': 0.3132512272332015, 'support': 521216}, 'weighted avg': {'precision': 0.3739470499191152, 'recall': 0.3756542393172888, 'f1-score': 0.31756968823681436, 'support': 521216}}
[[  5021  84220  79602]
 [  5749 105684  72536]
 [  2770  80542  85092]]
training model: results/universal/W3/deepLOB_L2/h200
Epoch 1/50
10532/10532 - 422s - loss: 3.2470 - accuracy200: 0.3949 - val_loss: 3.3455 - val_accuracy200: 0.3371 - 422s/epoch - 40ms/step
Epoch 2/50
10532/10532 - 418s - loss: 3.2252 - accuracy200: 0.4074 - val_loss: 3.3879 - val_accuracy200: 0.3354 - 418s/epoch - 40ms/step
Epoch 3/50
10532/10532 - 415s - loss: 3.2130 - accuracy200: 0.4139 - val_loss: 3.4410 - val_accuracy200: 0.3302 - 415s/epoch - 39ms/step
Epoch 4/50
10532/10532 - 418s - loss: 3.2054 - accuracy200: 0.4176 - val_loss: 3.4798 - val_accuracy200: 0.3253 - 418s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 417s - loss: 3.1998 - accuracy200: 0.4200 - val_loss: 3.4908 - val_accuracy200: 0.3265 - 417s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 419s - loss: 3.1937 - accuracy200: 0.4229 - val_loss: 3.5215 - val_accuracy200: 0.3272 - 419s/epoch - 40ms/step
Epoch 7/50
10532/10532 - 418s - loss: 3.1894 - accuracy200: 0.4248 - val_loss: 3.5781 - val_accuracy200: 0.3283 - 418s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 418s - loss: 3.1851 - accuracy200: 0.4268 - val_loss: 3.5562 - val_accuracy200: 0.3324 - 418s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 422s - loss: 3.1822 - accuracy200: 0.4280 - val_loss: 3.5765 - val_accuracy200: 0.3328 - 422s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 419s - loss: 3.1788 - accuracy200: 0.4295 - val_loss: 3.6145 - val_accuracy200: 0.3354 - 419s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 416s - loss: 3.1758 - accuracy200: 0.4308 - val_loss: 3.6313 - val_accuracy200: 0.3387 - 416s/epoch - 40ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 365s - 365s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.122615
{'0': {'precision': 0.3762286577869467, 'recall': 0.02637041234270649, 'f1-score': 0.04928627797272227, 'support': 2378992}, '1': {'precision': 0.33344821456180873, 'recall': 0.4110429113038207, 'f1-score': 0.36820190361082866, 'support': 2382053}, '2': {'precision': 0.328814790714582, 'recall': 0.5632454528878935, 'f1-score': 0.4152262967450525, 'support': 2325432}, 'accuracy': 0.33185036796140027, 'macro avg': {'precision': 0.3461638876877791, 'recall': 0.3335529255114736, 'f1-score': 0.27757149277620113, 'support': 7086477}, 'weighted avg': {'precision': 0.34628952063041707, 'recall': 0.33185036796140027, 'f1-score': 0.2765702376231813, 'support': 7086477}}
[[  62735  987720 1328537]
 [  57889  979126 1345038]
 [  46123  969520 1309789]]
Evaluating performance on  train set...
10532/10532 - 145s - 145s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1191506
{'0': {'precision': 0.3520491818870049, 'recall': 0.10228872966992154, 'f1-score': 0.15851929887671246, 'support': 904694}, '1': {'precision': 0.3320955325449619, 'recall': 0.49489218337976804, 'f1-score': 0.39747019218554347, 'support': 885114}, '2': {'precision': 0.34551560630230865, 'recall': 0.4248167770419426, 'f1-score': 0.38108439800964483, 'support': 906000}, 'accuracy': 0.3395864987417502, 'macro avg': {'precision': 0.3432201069114251, 'recall': 0.3406658966972107, 'f1-score': 0.31235796302396696, 'support': 2695808}, 'weighted avg': {'precision': 0.34330201819305195, 'recall': 0.3395864987417502, 'f1-score': 0.3117730768885699, 'support': 2695808}}
[[ 92540 439756 372398]
 [ 90419 438036 356659]
 [ 79902 441214 384884]]
Evaluating performance on  val set...
3814/3814 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157869
{'0': {'precision': 0.35351340834657413, 'recall': 0.06769662572496615, 'f1-score': 0.11363292874229339, 'support': 322084}, '1': {'precision': 0.3360906163137712, 'recall': 0.5141463267733727, 'f1-score': 0.4064743534038924, 'support': 332065}, '2': {'precision': 0.33694102701092404, 'recall': 0.4254303886398538, 'f1-score': 0.37605017482877773, 'support': 321686}, 'accuracy': 0.33754579411478375, 'macro avg': {'precision': 0.3421816838904231, 'recall': 0.3357577803793976, 'f1-score': 0.29871915232498786, 'support': 975835}, 'weighted avg': {'precision': 0.34212152088741077, 'recall': 0.33754579411478375, 'f1-score': 0.2997897502385819, 'support': 975835}}
[[ 21804 170410 129870]
 [ 21891 170730 139444]
 [ 17983 166848 136855]]
testing model out of sample: results/universal/W3/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 215s - 215s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1212847
{'0': {'precision': 0.32750574991301334, 'recall': 0.19082663215992354, 'f1-score': 0.2411457259103534, 'support': 1366303}, '1': {'precision': 0.35221545303530927, 'recall': 0.47904151244547793, 'f1-score': 0.40595346646175806, 'support': 1453540}, '2': {'precision': 0.3170550493167243, 'recall': 0.328327839467728, 'f1-score': 0.3225929944642865, 'support': 1316620}, 'accuracy': 0.33587052513222043, 'macro avg': {'precision': 0.33225875075501565, 'recall': 0.33273199469104314, 'f1-score': 0.32323072894546595, 'support': 4136463}, 'weighted avg': {'precision': 0.33286224420712307, 'recall': 0.33587052513222043, 'f1-score': 0.32498299120792, 'support': 4136463}}
[[260727 652436 453140]
 [279225 696306 478009]
 [256147 628190 432283]]
Evaluating performance on  train set...
6181/6181 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1216549
{'0': {'precision': 0.3288236927889605, 'recall': 0.08544399960496228, 'f1-score': 0.13564181804477274, 'support': 526532}, '1': {'precision': 0.3306485012793182, 'recall': 0.4968975642538308, 'f1-score': 0.3970738107588564, 'support': 523782}, '2': {'precision': 0.33660317011512075, 'recall': 0.4166307601703191, 'f1-score': 0.37236568614920995, 'support': 531473}, 'accuracy': 0.3329670809028017, 'macro avg': {'precision': 0.3320251213944665, 'recall': 0.3329907746763707, 'f1-score': 0.30169377165094635, 'support': 1581787}, 'weighted avg': {'precision': 0.3320418150732269, 'recall': 0.3329670809028017, 'f1-score': 0.30174870624200645, 'support': 1581787}}
[[ 44989 261853 219690]
 [ 46803 260266 216713]
 [ 45026 265019 221428]]
Evaluating performance on  val set...
2209/2209 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201283
{'0': {'precision': 0.3475808583766634, 'recall': 0.0614454640347734, 'f1-score': 0.10442979320570869, 'support': 192561}, '1': {'precision': 0.32940178522286145, 'recall': 0.543374581421804, 'f1-score': 0.4101590373102739, 'support': 187241}, '2': {'precision': 0.3305352183791972, 'recall': 0.3964763903008804, 'f1-score': 0.36051531691006544, 'support': 184924}, 'accuracy': 0.330942793496315, 'macro avg': {'precision': 0.33583928732624074, 'recall': 0.33376547858581923, 'f1-score': 0.2917013824753493, 'support': 564726}, 'weighted avg': {'precision': 0.33597166069976797, 'recall': 0.330942793496315, 'f1-score': 0.28965485594567, 'support': 564726}}
[[ 11832 106081  74648]
 [ 11649 101742  73850]
 [ 10560 101046  73318]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1260216
{'0': {'precision': 0.3522267206477733, 'recall': 0.0030821553831437984, 'f1-score': 0.006110837957434853, 'support': 56454}, '1': {'precision': 0.39149739885350743, 'recall': 0.3701383123697937, 'f1-score': 0.380518361661527, 'support': 63841}, '2': {'precision': 0.305464723653812, 'recall': 0.6474377083451043, 'f1-score': 0.41508841623550297, 'support': 53097}, 'accuracy': 0.3355460459536772, 'macro avg': {'precision': 0.34972961438503086, 'recall': 0.3402193920326806, 'f1-score': 0.2672392052848216, 'support': 173392}, 'weighted avg': {'precision': 0.35236604433597063, 'recall': 0.3355460459536772, 'f1-score': 0.2692027522015957, 'support': 173392}}
[[  174 18143 38137]
 [  185 23630 40026]
 [  135 18585 34377]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1200613
{'0': {'precision': 0.3232706917233107, 'recall': 0.07372116349047142, 'f1-score': 0.12006237006237007, 'support': 21934}, '1': {'precision': 0.3357319715258434, 'recall': 0.5938412408759124, 'f1-score': 0.4289527450075793, 'support': 21920}, '2': {'precision': 0.3431611616049656, 'recall': 0.34438264738598445, 'f1-score': 0.34377081945369753, 'support': 22475}, 'accuracy': 0.337318518295165, 'macro avg': {'precision': 0.3340546082847066, 'recall': 0.33731501725078944, 'f1-score': 0.29759531150788227, 'support': 66329}, 'weighted avg': {'precision': 0.3341285301327803, 'recall': 0.337318518295165, 'f1-score': 0.29794420785381986, 'support': 66329}}
[[ 1617 12632  7685]
 [ 1773 13017  7130]
 [ 1612 13123  7740]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1330558
{'0': {'precision': 0.27476415094339623, 'recall': 0.09003091190108192, 'f1-score': 0.13562281722933645, 'support': 7764}, '1': {'precision': 0.34807101399795154, 'recall': 0.5633374775521481, 'f1-score': 0.4302822474281192, 'support': 7239}, '2': {'precision': 0.31939014855355746, 'recall': 0.35362862501803494, 'f1-score': 0.3356384799726121, 'support': 6931}, 'accuracy': 0.3295340567156014, 'macro avg': {'precision': 0.3140751044983017, 'recall': 0.33566567149042165, 'f1-score': 0.3005145148766893, 'support': 21934}, 'weighted avg': {'precision': 0.3130595449019972, 'recall': 0.3295340567156014, 'f1-score': 0.29607454394049865, 'support': 21934}}
[[ 699 4022 3043]
 [ 981 4078 2180]
 [ 864 3616 2451]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1168445
{'0': {'precision': 0.24096958174904942, 'recall': 0.004435540313549832, 'f1-score': 0.008710741529791767, 'support': 114304}, '1': {'precision': 0.3890649128527571, 'recall': 0.4306542998011495, 'f1-score': 0.4088045638928843, 'support': 146844}, '2': {'precision': 0.2880788552886213, 'recall': 0.545193063583815, 'f1-score': 0.3769684063781962, 'support': 108125}, 'accuracy': 0.33226095598649236, 'macro avg': {'precision': 0.3060377832968093, 'recall': 0.32676096789950476, 'f1-score': 0.2648279039336241, 'support': 369273}, 'weighted avg': {'precision': 0.3136545627849201, 'recall': 0.33226095598649236, 'f1-score': 0.27563856258039576, 'support': 369273}}
[[  507 50553 63244]
 [ 1170 63239 82435]
 [  427 48749 58949]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112457
{'0': {'precision': 0.3543159998262305, 'recall': 0.14716443225492143, 'f1-score': 0.20795512493625704, 'support': 55421}, '1': {'precision': 0.3497206418858586, 'recall': 0.5023269449228627, 'f1-score': 0.4123574887946334, 'support': 54578}, '2': {'precision': 0.35559030991669593, 'recall': 0.41204970781862565, 'f1-score': 0.3817437338313146, 'support': 54076}, 'accuracy': 0.3526070394636599, 'macro avg': {'precision': 0.3532089838762617, 'recall': 0.3538470283321366, 'f1-score': 0.334018782520735, 'support': 164075}, 'weighted avg': {'precision': 0.35320738575816646, 'recall': 0.3526070394636599, 'f1-score': 0.3332250626432301, 'support': 164075}}
[[ 8156 26001 21264]
 [ 8046 27416 19116]
 [ 6817 24977 22282]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1102264
{'0': {'precision': 0.2937534146785649, 'recall': 0.07367651760836798, 'f1-score': 0.11780601811276659, 'support': 21893}, '1': {'precision': 0.37817292437863564, 'recall': 0.6875100144207659, 'f1-score': 0.48794564166714044, 'support': 24964}, '2': {'precision': 0.35558788382605083, 'recall': 0.2941758005587793, 'f1-score': 0.3219796763266842, 'support': 23265}, 'accuracy': 0.36536322409514843, 'macro avg': {'precision': 0.3425047409610838, 'recall': 0.351787444195971, 'f1-score': 0.3092437787021971, 'support': 70122}, 'weighted avg': {'precision': 0.3443228160771107, 'recall': 0.36536322409514843, 'f1-score': 0.3173192339474288, 'support': 70122}}
[[ 1613 13577  6703]
 [ 2101 17163  5700]
 [ 1777 14644  6844]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
1359/1359 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097493
{'0': {'precision': 0.34075654623798474, 'recall': 0.16633633329962585, 'f1-score': 0.22354955763036652, 'support': 98890}, '1': {'precision': 0.4172148511539748, 'recall': 0.21849818988672196, 'f1-score': 0.28679823721019354, 'support': 154134}, '2': {'precision': 0.2660643120909656, 'recall': 0.614252403009169, 'f1-score': 0.37129964762345136, 'support': 94777}, 'accuracy': 0.3115114677646125, 'macro avg': {'precision': 0.34134523649430837, 'recall': 0.33302897539850557, 'f1-score': 0.2938824808213371, 'support': 347801}, 'weighted avg': {'precision': 0.3542864627539498, 'recall': 0.3115114677646125, 'f1-score': 0.29184171969324635, 'support': 347801}}
[[ 16449  24838  57603]
 [ 17468  33678 102988]
 [ 14355  22205  58217]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211349
{'0': {'precision': 0.32499272621472214, 'recall': 0.21006394068024287, 'f1-score': 0.2551851307909466, 'support': 37222}, '1': {'precision': 0.32022018348623854, 'recall': 0.5801707401398899, 'f1-score': 0.4126704878648582, 'support': 37601}, '2': {'precision': 0.3348283111422565, 'recall': 0.18487850177991022, 'f1-score': 0.23822106995064066, 'support': 38766}, 'accuracy': 0.3239838364630378, 'macro avg': {'precision': 0.3266804069477391, 'recall': 0.32503772753334764, 'f1-score': 0.30202556286881516, 'support': 113589}, 'weighted avg': {'precision': 0.3267696051921503, 'recall': 0.3239838364630378, 'f1-score': 0.3015274538046262, 'support': 113589}}
[[ 7819 22539  6864]
 [ 8412 21815  7374]
 [ 7828 23771  7167]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134766
{'0': {'precision': 0.34027488546438983, 'recall': 0.1317104626793487, 'f1-score': 0.1899116689911669, 'support': 12406}, '1': {'precision': 0.34146341463414637, 'recall': 0.5550812674437695, 'f1-score': 0.4228231983742379, 'support': 12182}, '2': {'precision': 0.36163495887679653, 'recall': 0.36112493777999005, 'f1-score': 0.36137976837823255, 'support': 12054}, 'accuracy': 0.3479340647344577, 'macro avg': {'precision': 0.34779108632511085, 'recall': 0.34930555596770274, 'f1-score': 0.3247048785812124, 'support': 36642}, 'weighted avg': {'precision': 0.3476967780264531, 'recall': 0.3479340647344577, 'f1-score': 0.3237527453777249, 'support': 36642}}
[[1634 6767 4005]
 [1741 6762 3679]
 [1427 6274 4353]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1146437
{'0': {'precision': 0.326833364433663, 'recall': 0.1540084851948737, 'f1-score': 0.20936243967307663, 'support': 90982}, '1': {'precision': 0.3646211754672265, 'recall': 0.41707001350742906, 'f1-score': 0.3890860245634454, 'support': 106608}, '2': {'precision': 0.324047637826327, 'recall': 0.4370153698877839, 'f1-score': 0.3721473698512262, 'support': 94015}, 'accuracy': 0.34142418682807224, 'macro avg': {'precision': 0.3385007259090722, 'recall': 0.33603128953002886, 'f1-score': 0.32353194469591606, 'support': 291605}, 'weighted avg': {'precision': 0.33975009381648374, 'recall': 0.34142418682807224, 'f1-score': 0.3275503896351526, 'support': 291605}}
[[14012 38859 38111]
 [14552 44463 47593]
 [14308 38621 41086]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217101
{'0': {'precision': 0.3329151565839606, 'recall': 0.21867179393273514, 'f1-score': 0.26396256999705275, 'support': 32766}, '1': {'precision': 0.3257278914115375, 'recall': 0.5352928490002157, 'f1-score': 0.4050072264441233, 'support': 32457}, '2': {'precision': 0.34918074539434585, 'recall': 0.24780093987227378, 'f1-score': 0.28988265144307007, 'support': 33196}, 'accuracy': 0.33291336022515977, 'macro avg': {'precision': 0.3359412644632813, 'recall': 0.33392186093507487, 'f1-score': 0.31961748262808204, 'support': 98419}, 'weighted avg': {'precision': 0.3360311750402365, 'recall': 0.33291336022515977, 'f1-score': 0.3192194760617817, 'support': 98419}}
[[ 7165 18047  7554]
 [ 7305 17374  7778]
 [ 7052 17918  8226]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1117829
{'0': {'precision': 0.2872661436330718, 'recall': 0.0828258221680877, 'f1-score': 0.12857914640734738, 'support': 11494}, '1': {'precision': 0.38054254735687465, 'recall': 0.6835922697991663, 'f1-score': 0.48891538836793313, 'support': 13195}, '2': {'precision': 0.3192482643045248, 'recall': 0.24967234600262123, 'f1-score': 0.28020592561462493, 'support': 10682}, 'accuracy': 0.35732662350513134, 'macro avg': {'precision': 0.3290189850981571, 'recall': 0.33869681265662505, 'f1-score': 0.29923348679663514, 'support': 35371}, 'weighted avg': {'precision': 0.3317210688584835, 'recall': 0.35732662350513134, 'f1-score': 0.3087921448569832, 'support': 35371}}
[[ 952 7507 3035]
 [1523 9020 2652]
 [ 839 7176 2667]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
2282/2282 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.138152
{'0': {'precision': 0.34745822663025794, 'recall': 0.11555128947108395, 'f1-score': 0.17342730431343747, 'support': 212529}, '1': {'precision': 0.2881964504245948, 'recall': 0.28131632244685106, 'f1-score': 0.2847148279639511, 'support': 164914}, '2': {'precision': 0.35460451440232277, 'recall': 0.6048888415507959, 'f1-score': 0.44710328131961335, 'support': 206552}, 'accuracy': 0.3354343787189959, 'macro avg': {'precision': 0.33008639715239185, 'recall': 0.3339188178229103, 'f1-score': 0.3017484711990006, 'support': 583995}, 'weighted avg': {'precision': 0.3332508849076658, 'recall': 0.3354343787189959, 'f1-score': 0.301649619706344, 'support': 583995}}
[[ 24558  59813 128158]
 [ 19281  46393  99240]
 [ 26840  54771 124941]]
Evaluating performance on  train set...
878/878 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223671
{'0': {'precision': 0.32591828018223234, 'recall': 0.12252134121865718, 'f1-score': 0.17809284866872824, 'support': 74738}, '1': {'precision': 0.3375208549398025, 'recall': 0.5063383616316038, 'f1-score': 0.40504329004329004, 'support': 73915}, '2': {'precision': 0.3410951237144656, 'recall': 0.3844526218951242, 'f1-score': 0.36147838766280305, 'support': 76090}, 'accuracy': 0.3374343138607209, 'macro avg': {'precision': 0.3348447529455001, 'recall': 0.3377707749151284, 'f1-score': 0.31487150879160714, 'support': 224743}, 'weighted avg': {'precision': 0.33487255389742443, 'recall': 0.3374343138607209, 'f1-score': 0.314821679093969, 'support': 224743}}
[[ 9157 36526 29055]
 [ 9035 37426 27454]
 [ 9904 36933 29253]]
Evaluating performance on  val set...
303/303 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1185414
{'0': {'precision': 0.32767011768870014, 'recall': 0.1411527025996798, 'f1-score': 0.19730917810043958, 'support': 26234}, '1': {'precision': 0.33223651608555177, 'recall': 0.6723225030084236, 'f1-score': 0.4447127183963704, 'support': 24930}, '2': {'precision': 0.3554459883460332, 'recall': 0.21184597183528603, 'f1-score': 0.26547106647537067, 'support': 26203}, 'accuracy': 0.33625447542233766, 'macro avg': {'precision': 0.33845087404009505, 'recall': 0.34177372581446314, 'f1-score': 0.30249765432406023, 'support': 77367}, 'weighted avg': {'precision': 0.33854880564180173, 'recall': 0.33625447542233766, 'f1-score': 0.300115493721646, 'support': 77367}}
[[ 3703 16895  5636]
 [ 3739 16761  4430]
 [ 3859 16793  5551]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
5098/5098 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1174811
{'0': {'precision': 0.4075351470065113, 'recall': 0.059102052534659374, 'f1-score': 0.10323293424434277, 'support': 445839}, '1': {'precision': 0.3295530053044722, 'recall': 0.5323896767855031, 'f1-score': 0.4071050700316159, 'support': 439708}, '2': {'precision': 0.3238172519861863, 'recall': 0.4091767533693879, 'f1-score': 0.36152680890870287, 'support': 419364}, 'accuracy': 0.3310877140280065, 'macro avg': {'precision': 0.3536351347657232, 'recall': 0.3335561608965168, 'f1-score': 0.2906216043948872, 'support': 1304911}, 'weighted avg': {'precision': 0.35435324962743814, 'recall': 0.3310877140280065, 'f1-score': 0.28863574067136727, 'support': 1304911}}
[[ 26350 244750 174739]
 [ 22035 234096 183577]
 [ 16272 231498 171594]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116002
{'0': {'precision': 0.3761399273070817, 'recall': 0.17591791397413947, 'f1-score': 0.2397203569128875, 'support': 162951}, '1': {'precision': 0.32309094852167486, 'recall': 0.5204124538285885, 'f1-score': 0.39867190306874634, 'support': 154587}, '2': {'precision': 0.3550626459696254, 'recall': 0.33831891755651045, 'f1-score': 0.34648861858487034, 'support': 162669}, 'accuracy': 0.3418296692884527, 'macro avg': {'precision': 0.351431173932794, 'recall': 0.34488309511974613, 'f1-score': 0.32829362618883473, 'support': 480207}, 'weighted avg': {'precision': 0.35192265691872343, 'recall': 0.3418296692884527, 'f1-score': 0.32705712839584283, 'support': 480207}}
[[28666 83231 51054]
 [25228 80449 48910]
 [22317 85318 55034]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072445
{'0': {'precision': 0.3644118914261094, 'recall': 0.16405780234700804, 'f1-score': 0.22625560088276597, 'support': 51555}, '1': {'precision': 0.3478221769237687, 'recall': 0.6412150462365988, 'f1-score': 0.45100185925383673, 'support': 54286}, '2': {'precision': 0.36183554225452474, 'recall': 0.24166682530315434, 'f1-score': 0.2897872534696859, 'support': 52531}, 'accuracy': 0.35335791680347534, 'macro avg': {'precision': 0.35802320353480094, 'recall': 0.34897989129558704, 'f1-score': 0.3223482378687629, 'support': 158372}, 'weighted avg': {'precision': 0.3578707892122927, 'recall': 0.35335791680347534, 'f1-score': 0.32436610415339107, 'support': 158372}}
[[ 8458 32188 10909]
 [ 7996 34809 11481]
 [ 6756 33080 12695]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
5760/5760 - 75s - 75s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1197039
{'0': {'precision': 0.34233576642335767, 'recall': 0.0028827241435830193, 'f1-score': 0.005717304293057559, 'support': 488080}, '1': {'precision': 0.36515666669946956, 'recall': 0.5631664918128577, 'f1-score': 0.44304399187190263, 'support': 527107}, '2': {'precision': 0.3134060919496521, 'recall': 0.44861349404725614, 'f1-score': 0.3690146672051537, 'support': 459284}, 'accuracy': 0.34201893424828295, 'macro avg': {'precision': 0.34029950835749306, 'recall': 0.3382209033345656, 'f1-score': 0.27259198779003796, 'support': 1474471}, 'weighted avg': {'precision': 0.34148266023873897, 'recall': 0.34201893424828295, 'f1-score': 0.27522048498453366, 'support': 1474471}}
[[  1407 264157 222516]
 [  1390 296849 228868]
 [  1313 251930 206041]]
Evaluating performance on  train set...
2159/2159 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189959
{'0': {'precision': 0.3426927446041389, 'recall': 0.07524875959113955, 'f1-score': 0.123401019968076, 'support': 184415}, '1': {'precision': 0.3355354597764158, 'recall': 0.5145372012430243, 'f1-score': 0.4061899277741863, 'support': 184389}, '2': {'precision': 0.3387835386064687, 'recall': 0.4227773695811903, 'f1-score': 0.3761485437856971, 'support': 183735}, 'accuracy': 0.33740785718293187, 'macro avg': {'precision': 0.33900391432900784, 'recall': 0.3375211101384514, 'f1-score': 0.3019131638426531, 'support': 552539}, 'weighted avg': {'precision': 0.3390043487513919, 'recall': 0.33740785718293187, 'f1-score': 0.30181689687466806, 'support': 552539}}
[[13877 93993 76545]
 [14450 94875 75064]
 [12167 93889 77679]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1231078
{'0': {'precision': 0.39386150589658303, 'recall': 0.03522364649250906, 'f1-score': 0.06466426709693435, 'support': 73956}, '1': {'precision': 0.30090666299875063, 'recall': 0.3724533227399126, 'f1-score': 0.3328789617503662, 'support': 70484}, '2': {'precision': 0.331603070743716, 'recall': 0.5616761538989096, 'f1-score': 0.41701078959026033, 'support': 72905}, 'accuracy': 0.3211760104902344, 'macro avg': {'precision': 0.34212374654634986, 'recall': 0.32311770771044374, 'f1-score': 0.2715180061458536, 'support': 217345}, 'weighted avg': {'precision': 0.34283304717137386, 'recall': 0.3211760104902344, 'f1-score': 0.2698342399986732, 'support': 217345}}
[[ 2605 30719 40632]
 [ 2325 26252 41907]
 [ 1684 30272 40949]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
6315/6315 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119474
{'0': {'precision': 0.40456528879087883, 'recall': 0.03079156370077278, 'f1-score': 0.0572275262908134, 'support': 560056}, '1': {'precision': 0.32088766914992745, 'recall': 0.5327478820041062, 'f1-score': 0.4005274285255508, 'support': 519713}, '2': {'precision': 0.3374914905228335, 'recall': 0.4471009348336883, 'f1-score': 0.3846398614990642, 'support': 536673}, 'accuracy': 0.3303972552061874, 'macro avg': {'precision': 0.3543148161545466, 'recall': 0.3368801268461891, 'f1-score': 0.2807982721051428, 'support': 1616442}, 'weighted avg': {'precision': 0.35539244913788515, 'recall': 0.3303972552061874, 'f1-score': 0.27630794010296356, 'support': 1616442}}
[[ 17245 299402 243409]
 [ 15221 276876 227616]
 [ 10160 286566 239947]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.11605
{'0': {'precision': 0.36257894173475574, 'recall': 0.1666848919604584, 'f1-score': 0.2283792236784442, 'support': 182896}, '1': {'precision': 0.3371680412204093, 'recall': 0.4568135667636244, 'f1-score': 0.387976078941358, 'support': 182210}, '2': {'precision': 0.35356223253789804, 'recall': 0.41833883122804194, 'f1-score': 0.3832325619676336, 'support': 186435}, 'accuracy': 0.34759881858284336, 'macro avg': {'precision': 0.351103071831021, 'recall': 0.3472790966507082, 'f1-score': 0.3331959548624786, 'support': 551541}, 'weighted avg': {'precision': 0.35113618342334235, 'recall': 0.34759881858284336, 'f1-score': 0.3334488832711137, 'support': 551541}}
[[30486 81082 71328]
 [27703 83236 71271]
 [25892 82550 77993]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1137586
{'0': {'precision': 0.36258070509545265, 'recall': 0.12300274179824147, 'f1-score': 0.1836900377687049, 'support': 63462}, '1': {'precision': 0.3487757344556631, 'recall': 0.5240490950437681, 'f1-score': 0.4188139517514377, 'support': 64202}, '2': {'precision': 0.3512417707774983, 'recall': 0.4050721191948011, 'f1-score': 0.37624126787830603, 'support': 63090}, 'accuracy': 0.3512744162638791, 'macro avg': {'precision': 0.3541994034428713, 'recall': 0.3507079853456035, 'f1-score': 0.3262484191328162, 'support': 190754}, 'weighted avg': {'precision': 0.3541841310202799, 'recall': 0.3512744162638791, 'f1-score': 0.32651001865054297, 'support': 190754}}
[[ 7806 31578 24078]
 [ 7432 33645 23125]
 [ 6291 31243 25556]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
6082/6082 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1185263
{'0': {'precision': 0.32451414649528054, 'recall': 0.4275066131086509, 'f1-score': 0.36895774990868135, 'support': 510350}, '1': {'precision': 0.3436487886844081, 'recall': 0.5448298573804513, 'f1-score': 0.421462285800897, 'support': 543544}, '2': {'precision': 0.4079531957946598, 'recall': 0.018440675269929013, 'f1-score': 0.03528630648558052, 'support': 502910}, 'accuracy': 0.3363242900198098, 'macro avg': {'precision': 0.3587053769914495, 'recall': 0.33025904858634375, 'f1-score': 0.2752354473983863, 'support': 1556804}, 'weighted avg': {'precision': 0.35814898571537374, 'recall': 0.3363242900198098, 'f1-score': 0.2795000017561116, 'support': 1556804}}
[[218178 285712   6460]
 [240406 296139   6999]
 [213738 279898   9274]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241919
{'0': {'precision': 0.3207232267037552, 'recall': 0.060910658284627536, 'f1-score': 0.1023780310613154, 'support': 208223}, '1': {'precision': 0.32474595578276183, 'recall': 0.45401710065693324, 'f1-score': 0.37865231555439477, 'support': 205957}, '2': {'precision': 0.3312386401884887, 'recall': 0.4677173287960952, 'f1-score': 0.3878212517265771, 'support': 210407}, 'accuracy': 0.3275796646423957, 'macro avg': {'precision': 0.3255692742250019, 'recall': 0.32754836257921865, 'f1-score': 0.2896171994474291, 'support': 624587}, 'weighted avg': {'precision': 0.3255920853543632, 'recall': 0.3275796646423957, 'f1-score': 0.28963757143256375, 'support': 624587}}
[[12683 95877 99663]
 [13423 93508 99026]
 [13439 98557 98411]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175078
{'0': {'precision': 0.343305013760919, 'recall': 0.039736291741111616, 'f1-score': 0.07122818342064102, 'support': 72201}, '1': {'precision': 0.34018490708383453, 'recall': 0.660124851531641, 'f1-score': 0.44898994406060816, 'support': 72406}, '2': {'precision': 0.31423183866534565, 'recall': 0.29423471143630947, 'f1-score': 0.30390467432713336, 'support': 66831}, 'accuracy': 0.33262705852306584, 'macro avg': {'precision': 0.33257391983669976, 'recall': 0.3313652849030207, 'f1-score': 0.2747076006027942, 'support': 211438}, 'weighted avg': {'precision': 0.33304714238078276, 'recall': 0.33262705852306584, 'f1-score': 0.274135043136819, 'support': 211438}}
[[ 2869 48210 21122]
 [ 2817 47797 21792]
 [ 2671 44496 19664]]
testing model on single stock: results/universal/W3/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
13689/13689 - 182s - 182s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.127314
{'0': {'precision': 0.3337851575737038, 'recall': 0.00421729201043662, 'f1-score': 0.008329344831493548, 'support': 1167811}, '1': {'precision': 0.3336506801283629, 'recall': 0.3072409723053764, 'f1-score': 0.3199016837985319, 'support': 1169180}, '2': {'precision': 0.3308543899843173, 'recall': 0.6839156825201006, 'f1-score': 0.44596606082884016, 'support': 1167255}, 'accuracy': 0.33172585486292916, 'macro avg': {'precision': 0.3327634092287947, 'recall': 0.3317913156119712, 'f1-score': 0.2580656964862886, 'support': 3504246}, 'weighted avg': {'precision': 0.332764058751848, 'recall': 0.33172585486292916, 'f1-score': 0.25806004073725036, 'support': 3504246}}
[[  4925 353328 809558]
 [  4966 359220 804994]
 [  4864 364087 798304]]
Evaluating performance on  train set...
5475/5475 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221255
{'0': {'precision': 0.30866576398291845, 'recall': 0.0377788637232822, 'f1-score': 0.06731835855421321, 'support': 470660}, '1': {'precision': 0.33170296431169455, 'recall': 0.49722078901843125, 'f1-score': 0.39793674381322436, 'support': 461282}, '2': {'precision': 0.33943089742391197, 'recall': 0.47160920225542136, 'f1-score': 0.3947492480784226, 'support': 469624}, 'accuracy': 0.33435385846974025, 'macro avg': {'precision': 0.32659987523950834, 'recall': 0.3355362849990449, 'f1-score': 0.2866681168152867, 'support': 1401566}, 'weighted avg': {'precision': 0.32655624567921504, 'recall': 0.33435385846974025, 'f1-score': 0.2858437180813168, 'support': 1401566}}
[[ 17781 231479 221400]
 [ 22301 229359 209622]
 [ 17524 230621 221479]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1202242
{'0': {'precision': 0.37390876675273577, 'recall': 0.017509212344541687, 'f1-score': 0.03345195338067135, 'support': 173680}, '1': {'precision': 0.31361596545332193, 'recall': 0.4330513402273427, 'f1-score': 0.3637813337292076, 'support': 175418}, '2': {'precision': 0.327619434394152, 'recall': 0.5155707131154208, 'f1-score': 0.400647436215794, 'support': 172118}, 'accuracy': 0.3218339421660118, 'macro avg': {'precision': 0.3383813888667366, 'recall': 0.3220437552291017, 'f1-score': 0.2659602411085577, 'support': 521216}, 'weighted avg': {'precision': 0.33833106014888, 'recall': 0.3218339421660118, 'f1-score': 0.26588279080046506, 'support': 521216}}
[[ 3041 85221 85418]
 [ 2750 75965 96703]
 [ 2342 81037 88739]]
training model: results/universal/W3/deepOF_L2/h50
Epoch 1/50
10532/10532 - 227s - loss: 2.9957 - accuracy50: 0.4824 - val_loss: 3.2391 - val_accuracy50: 0.4692 - 227s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 225s - loss: 2.9404 - accuracy50: 0.4960 - val_loss: 3.2498 - val_accuracy50: 0.4716 - 225s/epoch - 21ms/step
Epoch 3/50
10532/10532 - 225s - loss: 2.9229 - accuracy50: 0.5009 - val_loss: 3.2664 - val_accuracy50: 0.4727 - 225s/epoch - 21ms/step
Epoch 4/50
10532/10532 - 224s - loss: 2.9133 - accuracy50: 0.5035 - val_loss: 3.3016 - val_accuracy50: 0.4754 - 224s/epoch - 21ms/step
Epoch 5/50
10532/10532 - 225s - loss: 2.9061 - accuracy50: 0.5058 - val_loss: 3.3090 - val_accuracy50: 0.4743 - 225s/epoch - 21ms/step
Epoch 6/50
10532/10532 - 224s - loss: 2.9003 - accuracy50: 0.5072 - val_loss: 3.3222 - val_accuracy50: 0.4743 - 224s/epoch - 21ms/step
Epoch 7/50
10532/10532 - 227s - loss: 2.8952 - accuracy50: 0.5089 - val_loss: 3.3284 - val_accuracy50: 0.4741 - 227s/epoch - 22ms/step
Epoch 8/50
10532/10532 - 230s - loss: 2.8915 - accuracy50: 0.5097 - val_loss: 3.3473 - val_accuracy50: 0.4718 - 230s/epoch - 22ms/step
Epoch 9/50
10532/10532 - 223s - loss: 2.8874 - accuracy50: 0.5106 - val_loss: 3.3845 - val_accuracy50: 0.4726 - 223s/epoch - 21ms/step
Epoch 10/50
10532/10532 - 222s - loss: 2.8842 - accuracy50: 0.5114 - val_loss: 3.3667 - val_accuracy50: 0.4705 - 222s/epoch - 21ms/step
Epoch 11/50
10532/10532 - 223s - loss: 2.8812 - accuracy50: 0.5122 - val_loss: 3.3567 - val_accuracy50: 0.4725 - 223s/epoch - 21ms/step
testing model in sample: results/universal/W3/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 206s - 206s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1101465
{'0': {'precision': 0.4221911819912456, 'recall': 0.5340555894903244, 'f1-score': 0.4715802809490523, 'support': 2074241}, '1': {'precision': 0.6058044605577144, 'recall': 0.3914451986514036, 'f1-score': 0.4755865198188933, 'support': 2941132}, '2': {'precision': 0.4209119006536213, 'recall': 0.5207200673656887, 'f1-score': 0.46552640672216233, 'support': 2071084}, 'accuracy': 0.4709697666972367, 'macro avg': {'precision': 0.4829691810675271, 'recall': 0.48207361850247227, 'f1-score': 0.47089773583003597, 'support': 7086457}, 'weighted avg': {'precision': 0.49802334891286854, 'recall': 0.4709697666972367, 'f1-score': 0.4714737108097583, 'support': 7086457}}
[[1107760  358082  608399]
 [ 914507 1151292  875333]
 [ 601568  391061 1078455]]
Evaluating performance on  train set...
10532/10532 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1104544
{'0': {'precision': 0.41846988751092085, 'recall': 0.5577152105905231, 'f1-score': 0.47816140994746564, 'support': 827910}, '1': {'precision': 0.5724226518315898, 'recall': 0.3618810594177117, 'f1-score': 0.44342950410102316, 'support': 1027017}, '2': {'precision': 0.43649000408213035, 'recall': 0.48957158962795944, 'f1-score': 0.461509486208325, 'support': 840876}, 'accuracy': 0.4618531101864639, 'macro avg': {'precision': 0.475794181141547, 'recall': 0.46972261987873143, 'f1-score': 0.46103346675227125, 'support': 2695803}, 'weighted avg': {'precision': 0.482741939176511, 'recall': 0.4618531101864639, 'f1-score': 0.4597355602942197, 'support': 2695803}}
[[461738 130135 236037]
 [359930 371658 295429]
 [281728 147479 411669]]
Evaluating performance on  val set...
3814/3814 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1093241
{'0': {'precision': 0.41799479140481244, 'recall': 0.5735929242614491, 'f1-score': 0.48358577045671347, 'support': 289892}, '1': {'precision': 0.5908671513338954, 'recall': 0.3771759909215767, 'f1-score': 0.46043589088007186, 'support': 393901}, '2': {'precision': 0.4385981027968131, 'recall': 0.49047907656801615, 'f1-score': 0.46309003648402025, 'support': 292041}, 'accuracy': 0.46943435051453425, 'macro avg': {'precision': 0.4824866818451737, 'recall': 0.4804159972503473, 'f1-score': 0.4690372326069352, 'support': 975834}, 'weighted avg': {'precision': 0.49394173228887367, 'recall': 0.46943435051453425, 'f1-score': 0.468107363924211, 'support': 975834}}
[[166280  46800  76812]
 [138797 148570 106534]
 [ 92727  56074 143240]]
testing model out of sample: results/universal/W3/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 120s - 120s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0130156
{'0': {'precision': 0.43653519776542943, 'recall': 0.48454223741126884, 'f1-score': 0.4592876415291929, 'support': 1154048}, '1': {'precision': 0.6141742786506917, 'recall': 0.548725977392792, 'f1-score': 0.5796084050900958, 'support': 1837644}, '2': {'precision': 0.4366034365416401, 'recall': 0.4628858153432493, 'f1-score': 0.449360650573076, 'support': 1144751}, 'accuracy': 0.5070629523965398, 'macro avg': {'precision': 0.4957709709859204, 'recall': 0.4987180100491034, 'f1-score': 0.49608556573078827, 'support': 4136443}, 'weighted avg': {'precision': 0.5154714982442763, 'recall': 0.5070629523965398, 'f1-score': 0.5099937183224923, 'support': 4136443}}
[[ 559185  307315  287548]
 [ 433056 1008363  396225]
 [ 288721  326141  529889]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0667969
{'0': {'precision': 0.4407469653209804, 'recall': 0.4991662634607464, 'f1-score': 0.4681411199969998, 'support': 500158}, '1': {'precision': 0.5187429905385361, 'recall': 0.47094647388691824, 'f1-score': 0.49369057877058936, 'support': 578484}, '2': {'precision': 0.44840291832604295, 'recall': 0.4368233701755188, 'f1-score': 0.4425374088500636, 'support': 503137}, 'accuracy': 0.4690155830871443, 'macro avg': {'precision': 0.4692976247285198, 'recall': 0.46897870250772783, 'f1-score': 0.46812303587255094, 'support': 1581779}, 'weighted avg': {'precision': 0.4717066922354613, 'recall': 0.4690155830871443, 'f1-score': 0.46934089486684266, 'support': 1581779}}
[[249662 119590 130906]
 [166593 272435 139456]
 [150197 133158 219782]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.035904
{'0': {'precision': 0.44782894665904704, 'recall': 0.4920359433956676, 'f1-score': 0.4688927963602187, 'support': 168821}, '1': {'precision': 0.5497289836658958, 'recall': 0.5239397846464787, 'f1-score': 0.5365246597767082, 'support': 229576}, '2': {'precision': 0.45009162646321854, 'recall': 0.43413956676226034, 'f1-score': 0.44197170426272253, 'support': 166329}, 'accuracy': 0.4879534499916774, 'macro avg': {'precision': 0.4825498522627205, 'recall': 0.48337176493480216, 'f1-score': 0.4824630534665498, 'support': 564726}, 'weighted avg': {'precision': 0.48992042494237803, 'recall': 0.4879534499916774, 'f1-score': 0.48845784976349665, 'support': 564726}}
[[ 83066  47122  38633]
 [ 59701 120284  49591]
 [ 42719  51400  72210]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3028961
{'0': {'precision': 0.354680396956506, 'recall': 0.5151764602854891, 'f1-score': 0.4201219773470641, 'support': 57095}, '1': {'precision': 0.3926665119517289, 'recall': 0.08520352496852707, 'f1-score': 0.14002372348349013, 'support': 59575}, '2': {'precision': 0.35335998968141363, 'recall': 0.4830212630910822, 'f1-score': 0.4081401585126035, 'support': 56718}, 'accuracy': 0.35692204766189123, 'macro avg': {'precision': 0.3669022995298829, 'recall': 0.3611337494483661, 'f1-score': 0.3227619531143859, 'support': 173388}, 'weighted avg': {'precision': 0.3673002549686621, 'recall': 0.35692204766189123, 'f1-score': 0.3199625760356968, 'support': 173388}}
[[29414  4079 23602]
 [27967  5076 26532]
 [25550  3772 27396]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3153658
{'0': {'precision': 0.35173160173160173, 'recall': 0.5675457842654368, 'f1-score': 0.43430588154671146, 'support': 22333}, '1': {'precision': 0.3427601809954751, 'recall': 0.04186817742158353, 'f1-score': 0.07462135205024012, 'support': 21711}, '2': {'precision': 0.3504106516154709, 'recall': 0.4346362698020913, 'f1-score': 0.3880052882496695, 'support': 22283}, 'accuracy': 0.3508224403334992, 'macro avg': {'precision': 0.3483008114475159, 'recall': 0.3480167438297039, 'f1-score': 0.298977507282207, 'support': 66327}, 'weighted avg': {'precision': 0.34835117977614183, 'recall': 0.3508224403334992, 'f1-score': 0.3010143571247434, 'support': 66327}}
[[12675   898  8760]
 [11608   909  9194]
 [11753   845  9685]]
Evaluating performance on  val set...
86/86 - 1s - 880ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3251987
{'0': {'precision': 0.35997882477501325, 'recall': 0.5445808862786973, 'f1-score': 0.43344311059173485, 'support': 7492}, '1': {'precision': 0.3530895334174023, 'recall': 0.03905160390516039, 'f1-score': 0.07032525430114278, 'support': 7170}, '2': {'precision': 0.3483226266952177, 'recall': 0.46974697469746973, 'f1-score': 0.40002342057497514, 'support': 7272}, 'accuracy': 0.3545180997538069, 'macro avg': {'precision': 0.3537969949625444, 'recall': 0.35112648829377574, 'f1-score': 0.30126392848928424, 'support': 21934}, 'weighted avg': {'precision': 0.35386228919234053, 'recall': 0.3545180997538069, 'f1-score': 0.303663635101381, 'support': 21934}}
[[4080  266 3146]
 [3645  280 3245]
 [3609  247 3416]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89939374
{'0': {'precision': 0.4292451617877612, 'recall': 0.4746025205666302, 'f1-score': 0.4507857677852077, 'support': 70381}, '1': {'precision': 0.738087302549186, 'recall': 0.6350045618455924, 'f1-score': 0.6826765438095815, 'support': 230170}, '2': {'precision': 0.3555396191679065, 'recall': 0.48338135568555546, 'f1-score': 0.4097196953344229, 'support': 68718}, 'accuracy': 0.576216795885926, 'macro avg': {'precision': 0.5076240278349512, 'recall': 0.5309961460325927, 'f1-score': 0.5143940023097374, 'support': 369269}, 'weighted avg': {'precision': 0.6080343319084752, 'recall': 0.576216795885926, 'f1-score': 0.5876841306341256, 'support': 369269}}
[[ 33403  24599  12379]
 [ 36180 146159  47831]
 [  8235  27266  33217]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98518217
{'0': {'precision': 0.466709372622813, 'recall': 0.48554648450516497, 'f1-score': 0.4759416147800347, 'support': 48016}, '1': {'precision': 0.5896142479149581, 'recall': 0.5525827315177354, 'f1-score': 0.5704981846764232, 'support': 68958}, '2': {'precision': 0.45062938193279856, 'recall': 0.4735244161358811, 'f1-score': 0.4617932976509685, 'support': 47100}, 'accuracy': 0.5102697563294611, 'macro avg': {'precision': 0.5023176674901899, 'recall': 0.5038845440529272, 'f1-score': 0.5027443657024754, 'support': 164074}, 'weighted avg': {'precision': 0.5137485551191016, 'recall': 0.5102697563294611, 'f1-score': 0.5116209193019952, 'support': 164074}}
[[23314 13326 11376]
 [15039 38105 15814]
 [11601 13196 22303]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9594545
{'0': {'precision': 0.4597975603425902, 'recall': 0.4846793609104837, 'f1-score': 0.4719107109560214, 'support': 18276}, '1': {'precision': 0.6023178383915995, 'recall': 0.5687596360228544, 'f1-score': 0.5850579180595507, 'support': 33079}, '2': {'precision': 0.4629733448855818, 'recall': 0.4840411360366601, 'f1-score': 0.4732728977805564, 'support': 18767}, 'accuracy': 0.5241721570976299, 'macro avg': {'precision': 0.5083629145399238, 'recall': 0.512493377656666, 'f1-score': 0.5100805089320428, 'support': 70122}, 'weighted avg': {'precision': 0.5278793068144749, 'recall': 0.5241721570976299, 'f1-score': 0.5256507729039649, 'support': 70122}}
[[ 8858  6060  3358]
 [ 7086 18814  7179]
 [ 3321  6362  9084]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
1359/1359 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1938201
{'0': {'precision': 0.4102999605714112, 'recall': 0.5411762823333627, 'f1-score': 0.4667370498409478, 'support': 124987}, '1': {'precision': 0.3663219512195122, 'recall': 0.18577634404346063, 'f1-score': 0.24652839331087872, 'support': 101057}, '2': {'precision': 0.4215973635452419, 'recall': 0.4560134041871658, 'f1-score': 0.4381305608711949, 'support': 121753}, 'accuracy': 0.4080972521327096, 'macro avg': {'precision': 0.3994064251120551, 'recall': 0.39432201018799634, 'f1-score': 0.38379866800767387, 'support': 347797}, 'weighted avg': {'precision': 0.4014764428676874, 'recall': 0.4080972521327096, 'f1-score': 0.3927382745366941, 'support': 347797}}
[[67640 16308 41039]
 [47151 18774 35132]
 [50064 16168 55521]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2500589
{'0': {'precision': 0.3713447263939237, 'recall': 0.574603344195737, 'f1-score': 0.45113664960993205, 'support': 37438}, '1': {'precision': 0.41679533367644533, 'recall': 0.1294904594392922, 'f1-score': 0.19759261518441706, 'support': 37524}, '2': {'precision': 0.38679545454545455, 'recall': 0.4406099518459069, 'f1-score': 0.4119526541282405, 'support': 38626}, 'accuracy': 0.38199457689192523, 'macro avg': {'precision': 0.39164517153860784, 'recall': 0.38156791849364535, 'f1-score': 0.3535606396408632, 'support': 113588}, 'weighted avg': {'precision': 0.3916134908166653, 'recall': 0.38199457689192523, 'f1-score': 0.35405326617806565, 'support': 113588}}
[[21512  3072 12854]
 [18538  4859 14127]
 [17880  3727 17019]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2198983
{'0': {'precision': 0.3892535579436538, 'recall': 0.5273056342461442, 'f1-score': 0.4478828994419009, 'support': 12708}, '1': {'precision': 0.3985153764581124, 'recall': 0.16678501686490324, 'f1-score': 0.23515424566672927, 'support': 11266}, '2': {'precision': 0.391721044045677, 'recall': 0.4549257972844964, 'f1-score': 0.42096420745069396, 'support': 12668}, 'accuracy': 0.3914360569837891, 'macro avg': {'precision': 0.3931633261491478, 'recall': 0.3830054827985146, 'f1-score': 0.36800045085310806, 'support': 36642}, 'weighted avg': {'precision': 0.39295427737284216, 'recall': 0.3914360569837891, 'f1-score': 0.37317062927172207, 'support': 36642}}
[[6701 1355 4652]
 [5090 1879 4297]
 [5424 1481 5763]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3627411
{'0': {'precision': 0.321286701208981, 'recall': 0.47431157572667004, 'f1-score': 0.383082784184514, 'support': 94128}, '1': {'precision': 0.40472078295912495, 'recall': 0.020832921745658574, 'f1-score': 0.03962609798487481, 'support': 101234}, '2': {'precision': 0.32611408804178255, 'recall': 0.49957917268467045, 'f1-score': 0.3946254960622812, 'support': 96239}, 'accuracy': 0.32521836344868504, 'macro avg': {'precision': 0.3507071907366295, 'recall': 0.33157455671899966, 'f1-score': 0.27244479274389, 'support': 291601}, 'weighted avg': {'precision': 0.351845405442835, 'recall': 0.32521836344868504, 'f1-score': 0.26765576190979673, 'support': 291601}}
[[44646  1731 47751]
 [47525  2109 51600]
 [46789  1371 48079]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3240148
{'0': {'precision': 0.3428908528305247, 'recall': 0.45860005359216366, 'f1-score': 0.3923931319101238, 'support': 33587}, '1': {'precision': 0.4269957983193277, 'recall': 0.02498617001659598, 'f1-score': 0.04720980198594739, 'support': 32538}, '2': {'precision': 0.3299672436183203, 'recall': 0.5271730715634967, 'f1-score': 0.4058841761438142, 'support': 32293}, 'accuracy': 0.3377430957751631, 'macro avg': {'precision': 0.3666179649227242, 'recall': 0.3369197650574188, 'f1-score': 0.2818290366799618, 'support': 98418}, 'weighted avg': {'precision': 0.3664563043132307, 'recall': 0.3377430957751631, 'f1-score': 0.28269867665159093, 'support': 98418}}
[[15403   659 17525]
 [14681   813 17044]
 [14837   432 17024]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3520037
{'0': {'precision': 0.3357567364837574, 'recall': 0.48035331021958066, 'f1-score': 0.39524537272881644, 'support': 12114}, '1': {'precision': 0.4645006016847172, 'recall': 0.03160566609350692, 'f1-score': 0.05918429929469489, 'support': 12213}, '2': {'precision': 0.3012958335754547, 'recall': 0.4694856935892793, 'f1-score': 0.3670406682476197, 'support': 11044}, 'accuracy': 0.3220152102004467, 'macro avg': {'precision': 0.36718439058130975, 'recall': 0.32714822330078897, 'f1-score': 0.2738234467570437, 'support': 35371}, 'weighted avg': {'precision': 0.36944994883229226, 'recall': 0.3220152102004467, 'f1-score': 0.27040279982612037, 'support': 35371}}
[[5819  257 6038]
 [5841  386 5986]
 [5671  188 5185]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1696756
{'0': {'precision': 0.4190609056122449, 'recall': 0.49535898378235754, 'f1-score': 0.45402683549332995, 'support': 212238}, '1': {'precision': 0.3630598320503849, 'recall': 0.15824288945937015, 'f1-score': 0.2204156414296083, 'support': 157372}, '2': {'precision': 0.4264495178040141, 'recall': 0.5261846898745691, 'f1-score': 0.4710962622676968, 'support': 214381}, 'accuracy': 0.41583003847662037, 'macro avg': {'precision': 0.4028567518222146, 'recall': 0.39326218770543225, 'f1-score': 0.38184624639687836, 'support': 583991}, 'weighted avg': {'precision': 0.4066822510126135, 'recall': 0.41583003847662037, 'f1-score': 0.3973401741391645, 'support': 583991}}
[[105134  22507  84597]
 [ 65351  24903  67118]
 [ 80395  21182 112804]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2451105
{'0': {'precision': 0.38087545117125593, 'recall': 0.49914910153161723, 'f1-score': 0.4320643978936136, 'support': 74627}, '1': {'precision': 0.41122491841416525, 'recall': 0.17137970967655058, 'f1-score': 0.24193287774092065, 'support': 74262}, '2': {'precision': 0.3897552895583961, 'recall': 0.49323682961556714, 'f1-score': 0.43543234231245964, 'support': 75852}, 'accuracy': 0.3888476068007173, 'macro avg': {'precision': 0.3939518863812725, 'recall': 0.3879218802745783, 'f1-score': 0.369809872648998, 'support': 224741}, 'weighted avg': {'precision': 0.39390095892344307, 'recall': 0.3888476068007173, 'f1-score': 0.370375246250073, 'support': 224741}}
[[37250  8797 28580]
 [31537 12727 29998]
 [29014  9425 37413]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2579464
{'0': {'precision': 0.3832827290587605, 'recall': 0.5055160771072985, 'f1-score': 0.4359942436298993, 'support': 25471}, '1': {'precision': 0.39457384628805725, 'recall': 0.17210151820706976, 'f1-score': 0.2396672318779144, 'support': 26281}, '2': {'precision': 0.38483441658929124, 'recall': 0.4854186999804802, 'f1-score': 0.4293137678031938, 'support': 25615}, 'accuracy': 0.38560368115604843, 'macro avg': {'precision': 0.387563663978703, 'recall': 0.38767876509828286, 'f1-score': 0.3683250811036691, 'support': 77367}, 'weighted avg': {'precision': 0.3876319778081975, 'recall': 0.38560368115604843, 'f1-score': 0.36709160317395584, 'support': 77367}}
[[12876  3309  9286]
 [11168  4523 10590]
 [ 9550  3631 12434]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/EXC
Evaluating performance on  test set...
5098/5098 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8475448
{'0': {'precision': 0.515634904809664, 'recall': 0.5451636349906076, 'f1-score': 0.5299882842730896, 'support': 317811}, '1': {'precision': 0.6518426348155956, 'recall': 0.6852213406649404, 'f1-score': 0.6681153517286005, 'support': 675068}, '2': {'precision': 0.5320411941680167, 'recall': 0.4420660966323535, 'f1-score': 0.4828982929800731, 'support': 312028}, 'accuracy': 0.5929671616444697, 'macro avg': {'precision': 0.5665062445977588, 'recall': 0.5574836907626338, 'f1-score': 0.5603339763272545, 'support': 1304907}, 'weighted avg': {'precision': 0.5900223527546534, 'recall': 0.5929671616444697, 'f1-score': 0.5901854993772154, 'support': 1304907}}
[[173259 109641  34911]
 [126085 462571  86412]
 [ 36667 137424 137937]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85120195
{'0': {'precision': 0.4928274513000245, 'recall': 0.5288129367418511, 'f1-score': 0.5101864313106724, 'support': 114341}, '1': {'precision': 0.6634856165638551, 'recall': 0.697586309308803, 'f1-score': 0.6801087785886174, 'support': 249162}, '2': {'precision': 0.5506295331093598, 'recall': 0.4508148960600504, 'f1-score': 0.49574791871810936, 'support': 116702}, 'accuracy': 0.5974281817140596, 'macro avg': {'precision': 0.5689808669910797, 'recall': 0.5590713807035682, 'f1-score': 0.5620143762057997, 'support': 480205}, 'weighted avg': {'precision': 0.5954235265695024, 'recall': 0.5974281817140596, 'f1-score': 0.5948444182035412, 'support': 480205}}
[[ 60465  39506  14370]
 [ 46784 173812  28566]
 [ 15441  48650  52611]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8342061
{'0': {'precision': 0.49906694956415043, 'recall': 0.5425466874166296, 'f1-score': 0.5198993382421475, 'support': 35984}, '1': {'precision': 0.6623347062649035, 'recall': 0.7150362742803651, 'f1-score': 0.687677245104659, 'support': 85460}, '2': {'precision': 0.5730374541547809, 'recall': 0.418869150779896, 'f1-score': 0.4839724034354907, 'support': 36928}, 'accuracy': 0.6067865531785922, 'macro avg': {'precision': 0.5781463699946116, 'recall': 0.5588173708256302, 'f1-score': 0.5638496622607657, 'support': 158372}, 'weighted avg': {'precision': 0.6044166659355364, 'recall': 0.6067865531785922, 'f1-score': 0.6020577379083133, 'support': 158372}}
[[19523 13438  3023]
 [15851 61107  8502]
 [ 3745 17715 15468]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/AAL
Evaluating performance on  test set...
5760/5760 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8805712
{'0': {'precision': 0.4678401868555567, 'recall': 0.49335037255241726, 'f1-score': 0.4802567570416914, 'support': 323176}, '1': {'precision': 0.6938270954865094, 'recall': 0.6629554825617473, 'f1-score': 0.678040069713092, 'support': 834774}, '2': {'precision': 0.44675006993256716, 'recall': 0.47430311799998104, 'f1-score': 0.46011447310954634, 'support': 316517}, 'accuracy': 0.5852840382321205, 'macro avg': {'precision': 0.5361391174248777, 'recall': 0.5435363243713819, 'f1-score': 0.53947043328811, 'support': 1474467}, 'weighted avg': {'precision': 0.5912560484023943, 'recall': 0.5852840382321205, 'f1-score': 0.5879085334250252, 'support': 1474467}}
[[159439 118322  45415]
 [140858 553418 140498]
 [ 40501 125891 150125]]
Evaluating performance on  train set...
2159/2159 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94428694
{'0': {'precision': 0.4918408408599011, 'recall': 0.4951976227753459, 'f1-score': 0.49351352384106384, 'support': 156485}, '1': {'precision': 0.5739868518958892, 'recall': 0.6272755089637134, 'f1-score': 0.5994492234050012, 'support': 238573}, '2': {'precision': 0.5082561837587422, 'recall': 0.4333248666497333, 'f1-score': 0.46780899627411804, 'support': 157480}, 'accuracy': 0.5345912860291961, 'macro avg': {'precision': 0.5246946255048441, 'recall': 0.5185993327962642, 'f1-score': 0.520257247840061, 'support': 552538}, 'weighted avg': {'precision': 0.5319881402141505, 'recall': 0.5345912860291961, 'f1-score': 0.5319279833910399, 'support': 552538}}
[[ 77491  52049  26945]
 [ 49844 149651  39078]
 [ 30218  59022  68240]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9167514
{'0': {'precision': 0.49816862717475524, 'recall': 0.48539025101659145, 'f1-score': 0.49169643089918397, 'support': 58283}, '1': {'precision': 0.5955972754439968, 'recall': 0.6569007839100482, 'f1-score': 0.6247487797875395, 'support': 101032}, '2': {'precision': 0.5139844481537271, 'recall': 0.4351197656384629, 'f1-score': 0.4712755235357796, 'support': 58030}, 'accuracy': 0.5516943108882192, 'macro avg': {'precision': 0.5359167835908264, 'recall': 0.5258036001883676, 'f1-score': 0.5292402447408344, 'support': 217345}, 'weighted avg': {'precision': 0.5476807083514456, 'recall': 0.5516943108882192, 'f1-score': 0.5480930338051169, 'support': 217345}}
[[28290 21313  8680]
 [19468 66368 15196]
 [ 9030 23750 25250]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/WBA
Evaluating performance on  test set...
6315/6315 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93361545
{'0': {'precision': 0.5072650081339523, 'recall': 0.4274280186690085, 'f1-score': 0.46393686729091344, 'support': 448658}, '1': {'precision': 0.5722142981627393, 'recall': 0.6924734494978507, 'f1-score': 0.6266261527933855, 'support': 720702}, '2': {'precision': 0.5142931258106356, 'recall': 0.4212844291152774, 'f1-score': 0.46316563445603914, 'support': 447078}, 'accuracy': 0.5439014673003233, 'macro avg': {'precision': 0.5312574773691091, 'recall': 0.5137286324273789, 'f1-score': 0.5179095515134461, 'support': 1616438}, 'weighted avg': {'precision': 0.5381670285127005, 'recall': 0.5439014673003233, 'f1-score': 0.5362598962019219, 'support': 1616438}}
[[191769 183377  73512]
 [117269 499067 104366]
 [ 69007 189724 188347]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9564152
{'0': {'precision': 0.5111393595116558, 'recall': 0.46413048052471156, 'f1-score': 0.4865019850022056, 'support': 166339}, '1': {'precision': 0.5322146011608656, 'recall': 0.6422398667458955, 'f1-score': 0.5820735394518677, 'support': 213727}, '2': {'precision': 0.5273057528981899, 'recall': 0.4384779122321038, 'f1-score': 0.47880686739008604, 'support': 171475}, 'accuracy': 0.5251740124487572, 'macro avg': {'precision': 0.5235532378569038, 'recall': 0.5149494198342369, 'f1-score': 0.5157941306147198, 'support': 551541}, 'weighted avg': {'precision': 0.5243323596293562, 'recall': 0.5251740124487572, 'f1-score': 0.5211443802644341, 'support': 551541}}
[[ 77203  57090  32046]
 [ 41108 137264  35355]
 [ 32730  63557  75188]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9325839
{'0': {'precision': 0.5111544607466744, 'recall': 0.4619727291483017, 'f1-score': 0.48532077553593944, 'support': 53317}, '1': {'precision': 0.5707080291241773, 'recall': 0.6831860734824663, 'f1-score': 0.6219022431188168, 'support': 83639}, '2': {'precision': 0.5240911339914709, 'recall': 0.4134803055932487, 'f1-score': 0.4622610141313383, 'support': 53797}, 'accuracy': 0.545291555047627, 'macro avg': {'precision': 0.5353178746207742, 'recall': 0.5195463694080056, 'f1-score': 0.5231613442620315, 'support': 190753}, 'weighted avg': {'precision': 0.540915225275024, 'recall': 0.545291555047627, 'f1-score': 0.5387039012685935, 'support': 190753}}
[[24631 20188  8498]
 [14797 57141 11701]
 [ 8759 22794 22244]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
6082/6082 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0067888
{'0': {'precision': 0.44745029663511615, 'recall': 0.4526448166541443, 'f1-score': 0.45003256765189503, 'support': 436552}, '1': {'precision': 0.5706810704889163, 'recall': 0.5919303922227122, 'f1-score': 0.5811115419431736, 'support': 684866}, '2': {'precision': 0.4557190604056688, 'recall': 0.4237221566348632, 'f1-score': 0.4391385333166706, 'support': 435382}, 'accuracy': 0.5058305498458376, 'macro avg': {'precision': 0.4912834758432337, 'recall': 0.48943245517057327, 'f1-score': 0.4900942143039131, 'support': 1556800}, 'weighted avg': {'precision': 0.503974344729995, 'recall': 0.5058305498458376, 'f1-score': 0.5046500306208261, 'support': 1556800}}
[[197603 146118  92831]
 [151972 405393 127501]
 [ 92045 158856 184481]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.051121
{'0': {'precision': 0.46370709845441704, 'recall': 0.4815529805280134, 'f1-score': 0.47246158029460583, 'support': 209275}, '1': {'precision': 0.4744664980806666, 'recall': 0.5053920761188679, 'f1-score': 0.4894412618876707, 'support': 206414}, '2': {'precision': 0.46500309518218885, 'recall': 0.41712622549019607, 'f1-score': 0.4397654207588497, 'support': 208896}, 'accuracy': 0.4678834746271524, 'macro avg': {'precision': 0.46772556390575754, 'recall': 0.4680237607123591, 'f1-score': 0.4672227543137087, 'support': 624585}, 'weighted avg': {'precision': 0.46769633810458044, 'recall': 0.4678834746271524, 'f1-score': 0.4671376404849235, 'support': 624585}}
[[100777  55080  53418]
 [ 55260 104320  46834]
 [ 61292  60468  87136]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0137593
{'0': {'precision': 0.4688270251470566, 'recall': 0.4779626003977369, 'f1-score': 0.4733507381792088, 'support': 64867}, '1': {'precision': 0.523147791014183, 'recall': 0.5663091843916638, 'f1-score': 0.5438735177865613, 'support': 83827}, '2': {'precision': 0.46570999193607504, 'recall': 0.40499489991074844, 'f1-score': 0.4332355849558428, 'support': 62744}, 'accuracy': 0.49133552152404014, 'macro avg': {'precision': 0.4858949360324382, 'recall': 0.48308889490004975, 'f1-score': 0.4834866136405376, 'support': 211438}, 'weighted avg': {'precision': 0.4894381343542652, 'recall': 0.49133552152404014, 'f1-score': 0.4894061675357988, 'support': 211438}}
[[31004 20908 12955]
 [20157 47472 16198]
 [14970 22363 25411]]
testing model on single stock: results/universal/W3/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
13689/13689 - 109s - 109s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2905031
{'0': {'precision': 0.39261811546705877, 'recall': 0.581569595097541, 'f1-score': 0.46876953171130314, 'support': 1143263}, '1': {'precision': 0.3542297853020527, 'recall': 0.033420431349354754, 'f1-score': 0.061078321192992654, 'support': 1213958}, '2': {'precision': 0.3953340301690976, 'recall': 0.5846283546683103, 'f1-score': 0.47169868390509484, 'support': 1147021}, 'accuracy': 0.392678074174101, 'macro avg': {'precision': 0.3807273103127364, 'recall': 0.39987279370506873, 'f1-score': 0.33384884560313016, 'support': 3504242}, 'weighted avg': {'precision': 0.38020841051146403, 'recall': 0.392678074174101, 'f1-score': 0.328493772371648, 'support': 3504242}}
[[664887  38474 439902]
 [587631  40571 585756]
 [440952  35488 670581]]
Evaluating performance on  train set...
5475/5475 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2593514
{'0': {'precision': 0.38809503079903357, 'recall': 0.612687838119353, 'f1-score': 0.4751901991729927, 'support': 465627}, '1': {'precision': 0.34254357026761717, 'recall': 0.04601065209496965, 'f1-score': 0.08112460054156749, 'support': 462632}, '2': {'precision': 0.4049833205369199, 'recall': 0.5170988747237516, 'f1-score': 0.4542250580433947, 'support': 473306}, 'accuracy': 0.3933574254494083, 'macro avg': {'precision': 0.3785406405345236, 'recall': 0.3919324549793581, 'f1-score': 0.33684661925265164, 'support': 1401565}, 'weighted avg': {'precision': 0.37876243871383575, 'recall': 0.3933574254494083, 'f1-score': 0.33803617270005776, 'support': 1401565}}
[[285284  19469 160874]
 [242630  21286 198716]
 [207174  21386 244746]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.261388
{'0': {'precision': 0.39116855221388935, 'recall': 0.6291502400103407, 'f1-score': 0.48240567631490033, 'support': 170201}, '1': {'precision': 0.40674115456238363, 'recall': 0.06083783633223776, 'f1-score': 0.10584415584415584, 'support': 179510}, '2': {'precision': 0.41307333523708506, 'recall': 0.5313606017317279, 'f1-score': 0.46480942155757643, 'support': 171505}, 'accuracy': 0.40124247912573674, 'macro avg': {'precision': 0.4036610140044527, 'recall': 0.40711622602476877, 'f1-score': 0.3510197512388775, 'support': 521216}, 'weighted avg': {'precision': 0.4037395739399518, 'recall': 0.40124247912573674, 'f1-score': 0.34692556017905996, 'support': 521216}}
[[107082   6957  56162]
 [ 95265  10921  73324]
 [ 71402   8972  91131]]
training model: results/universal/W3/deepOF_L2/h100
Epoch 1/50
10532/10532 - 230s - loss: 3.1666 - accuracy100: 0.4303 - val_loss: 3.2980 - val_accuracy100: 0.3905 - 230s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 224s - loss: 3.1282 - accuracy100: 0.4422 - val_loss: 3.2889 - val_accuracy100: 0.4034 - 224s/epoch - 21ms/step
Epoch 3/50
10532/10532 - 225s - loss: 3.1160 - accuracy100: 0.4461 - val_loss: 3.2859 - val_accuracy100: 0.4079 - 225s/epoch - 21ms/step
Epoch 4/50
10532/10532 - 227s - loss: 3.1070 - accuracy100: 0.4498 - val_loss: 3.2793 - val_accuracy100: 0.4085 - 227s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 224s - loss: 3.1012 - accuracy100: 0.4517 - val_loss: 3.2858 - val_accuracy100: 0.4107 - 224s/epoch - 21ms/step
Epoch 6/50
10532/10532 - 226s - loss: 3.0964 - accuracy100: 0.4535 - val_loss: 3.2970 - val_accuracy100: 0.4136 - 226s/epoch - 21ms/step
Epoch 7/50
10532/10532 - 225s - loss: 3.0930 - accuracy100: 0.4547 - val_loss: 3.2977 - val_accuracy100: 0.4147 - 225s/epoch - 21ms/step
Epoch 8/50
10532/10532 - 224s - loss: 3.0900 - accuracy100: 0.4558 - val_loss: 3.2889 - val_accuracy100: 0.4130 - 224s/epoch - 21ms/step
Epoch 9/50
10532/10532 - 223s - loss: 3.0872 - accuracy100: 0.4570 - val_loss: 3.3063 - val_accuracy100: 0.4140 - 223s/epoch - 21ms/step
Epoch 10/50
10532/10532 - 227s - loss: 3.0849 - accuracy100: 0.4577 - val_loss: 3.3047 - val_accuracy100: 0.4158 - 227s/epoch - 22ms/step
Epoch 11/50
10532/10532 - 228s - loss: 3.0823 - accuracy100: 0.4586 - val_loss: 3.3152 - val_accuracy100: 0.4140 - 228s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 226s - loss: 3.0803 - accuracy100: 0.4591 - val_loss: 3.3026 - val_accuracy100: 0.4155 - 226s/epoch - 21ms/step
Epoch 13/50
10532/10532 - 223s - loss: 3.0783 - accuracy100: 0.4599 - val_loss: 3.2975 - val_accuracy100: 0.4140 - 223s/epoch - 21ms/step
Epoch 14/50
10532/10532 - 223s - loss: 3.0766 - accuracy100: 0.4603 - val_loss: 3.3172 - val_accuracy100: 0.4150 - 223s/epoch - 21ms/step
testing model in sample: results/universal/W3/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 205s - 205s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0737299
{'0': {'precision': 0.44476079071490404, 'recall': 0.38241526055235103, 'f1-score': 0.4112384864241117, 'support': 2348434}, '1': {'precision': 0.45428055052923877, 'recall': 0.34878174936712636, 'f1-score': 0.3946014279029071, 'support': 2412804}, '2': {'precision': 0.40558811901022446, 'recall': 0.560748901501321, 'f1-score': 0.4707117441833599, 'support': 2325219}, 'accuracy': 0.429478793140211, 'macro avg': {'precision': 0.4348764867514558, 'recall': 0.4306486371402661, 'f1-score': 0.42551721950345955, 'support': 7086457}, 'weighted avg': {'precision': 0.43514869175354476, 'recall': 0.429478793140211, 'f1-score': 0.42508833940219437, 'support': 7086457}}
[[ 898077  494595  955762]
 [ 616139  841542  955123]
 [ 505020  516335 1303864]]
Evaluating performance on  train set...
10532/10532 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085012
{'0': {'precision': 0.4268057272209646, 'recall': 0.3790275382824956, 'f1-score': 0.40150023842056914, 'support': 891922}, '1': {'precision': 0.40268735589011656, 'recall': 0.341080912698062, 'f1-score': 0.3693326985828158, 'support': 905272}, '2': {'precision': 0.40507761994810676, 'recall': 0.5125176801033597, 'f1-score': 0.45250764040737707, 'support': 898609}, 'accuracy': 0.4107818709304797, 'macro avg': {'precision': 0.411523567686396, 'recall': 0.41087537702797244, 'f1-score': 0.407780192470254, 'support': 2695803}, 'weighted avg': {'precision': 0.4114638201900076, 'recall': 0.4107818709304797, 'f1-score': 0.40770074245145005, 'support': 2695803}}
[[338063 221539 332320]
 [252424 308771 344077]
 [201590 236466 460553]]
Evaluating performance on  val set...
3814/3814 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0940295
{'0': {'precision': 0.4121915868388172, 'recall': 0.3963545721636438, 'f1-score': 0.40411797949176964, 'support': 312117}, '1': {'precision': 0.41423853957937806, 'recall': 0.3368230923316612, 'f1-score': 0.3715410292203653, 'support': 350454}, '2': {'precision': 0.4004427383237364, 'recall': 0.4994940353632571, 'f1-score': 0.44451735976466344, 'support': 313263}, 'accuracy': 0.4080847767140723, 'macro avg': {'precision': 0.40895762158064386, 'recall': 0.41089056661952067, 'f1-score': 0.4067254561589328, 'support': 975834}, 'weighted avg': {'precision': 0.409155090102037, 'recall': 0.4080847767140723, 'f1-score': 0.4053875689219522, 'support': 975834}}
[[123709  79998 108410]
 [106546 118041 125867]
 [ 69870  86920 156473]]
testing model out of sample: results/universal/W3/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 121s - 121s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0603205
{'0': {'precision': 0.43309112914720965, 'recall': 0.3896858920205821, 'f1-score': 0.4102435985594055, 'support': 1302100}, '1': {'precision': 0.4826558917799987, 'recall': 0.44354649523883793, 'f1-score': 0.4622754858027383, 'support': 1564429}, '2': {'precision': 0.4060116109582511, 'recall': 0.48826298473754914, 'f1-score': 0.44335474128130214, 'support': 1269914}, 'accuracy': 0.44032010111102704, 'macro avg': {'precision': 0.4405862106284865, 'recall': 0.4404984573323231, 'f1-score': 0.4386246085478153, 'support': 4136443}, 'weighted avg': {'precision': 0.4435232547148625, 'recall': 0.44032010111102704, 'f1-score': 0.4400877175347509, 'support': 4136443}}
[[507410 362657 432033]
 [395439 693897 475093]
 [268752 381110 620052]]
Evaluating performance on  train set...
6181/6181 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.08845
{'0': {'precision': 0.4202565391952619, 'recall': 0.39919328852445346, 'f1-score': 0.4094542075189607, 'support': 527574}, '1': {'precision': 0.4138894920290269, 'recall': 0.3461798008415201, 'f1-score': 0.37701873569942934, 'support': 523101}, '2': {'precision': 0.4089426267488906, 'recall': 0.49519491474362837, 'f1-score': 0.4479546526818517, 'support': 531104}, 'accuracy': 0.4138953671783479, 'macro avg': {'precision': 0.41436288599105975, 'recall': 0.413522668036534, 'f1-score': 0.41147586530008057, 'support': 1581779}, 'weighted avg': {'precision': 0.41435212846808556, 'recall': 0.4138953671783479, 'f1-score': 0.4116547125727788, 'support': 1581779}}
[[210604 123933 193037]
 [154929 181087 187085]
 [135599 132505 263000]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0747974
{'0': {'precision': 0.43623691713638457, 'recall': 0.3902885103879783, 'f1-score': 0.41198552614495304, 'support': 186995}, '1': {'precision': 0.4212264247537526, 'recall': 0.4207482332245825, 'f1-score': 0.4209871931969935, 'support': 195554}, '2': {'precision': 0.4118459140503229, 'recall': 0.4568743584535918, 'f1-score': 0.4331931548486489, 'support': 182177}, 'accuracy': 0.42231630914815327, 'macro avg': {'precision': 0.4231030853134867, 'recall': 0.4226370340220509, 'f1-score': 0.42205529139686515, 'support': 564726}, 'weighted avg': {'precision': 0.42317068396029095, 'recall': 0.42231630914815327, 'f1-score': 0.42194407980291804, 'support': 564726}}
[[72982 55678 58335]
 [52747 82279 60528]
 [41570 57375 83232]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11768
{'0': {'precision': 0.42034615796806346, 'recall': 0.2385434088490193, 'f1-score': 0.3043630085164995, 'support': 65770}, '1': {'precision': 0.3219332956472583, 'recall': 0.10225563909774436, 'f1-score': 0.15521147392985504, 'support': 44555}, '2': {'precision': 0.37780530218518277, 'recall': 0.730364873222016, 'f1-score': 0.49800243276118394, 'support': 63063}, 'accuracy': 0.3824024730661868, 'macro avg': {'precision': 0.37336158526683483, 'recall': 0.3570546403895933, 'f1-score': 0.3191923050691795, 'support': 173388}, 'weighted avg': {'precision': 0.3795847496298897, 'recall': 0.3824024730661868, 'f1-score': 0.3364646325483506, 'support': 173388}}
[[15689  4926 45155]
 [ 9301  4556 30698]
 [12334  4670 46059]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1790439
{'0': {'precision': 0.35714868947497347, 'recall': 0.19920754201393634, 'f1-score': 0.2557595602853468, 'support': 21957}, '1': {'precision': 0.3428304530593181, 'recall': 0.03344877870944222, 'f1-score': 0.060950799252646876, 'support': 21944}, '2': {'precision': 0.3434991047189973, 'recall': 0.7955498082582716, 'f1-score': 0.47982249714247294, 'support': 22426}, 'accuracy': 0.34599785909207414, 'macro avg': {'precision': 0.34782608241776297, 'recall': 0.34273537632721673, 'f1-score': 0.2655109522268222, 'support': 66327}, 'weighted avg': {'precision': 0.34779646537856235, 'recall': 0.34599785909207414, 'f1-score': 0.2670664484282802, 'support': 66327}}
[[ 4374   694 16889]
 [ 4001   734 17209]
 [ 3872   713 17841]]
Evaluating performance on  val set...
86/86 - 1s - 937ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1962037
{'0': {'precision': 0.36538962731300495, 'recall': 0.18922931569712512, 'f1-score': 0.2493330962119865, 'support': 7409}, '1': {'precision': 0.31170886075949367, 'recall': 0.02625616420098627, 'f1-score': 0.04843269821757836, 'support': 7503}, '2': {'precision': 0.32304609218436875, 'recall': 0.8034747935061236, 'f1-score': 0.46081594315351004, 'support': 7022}, 'accuracy': 0.33012674386796753, 'macro avg': {'precision': 0.3333815267522891, 'recall': 0.3396534244680784, 'f1-score': 0.2528605791943583, 'support': 21934}, 'weighted avg': {'precision': 0.33347100348131536, 'recall': 0.33012674386796753, 'f1-score': 0.24831535503715899, 'support': 21934}}
[[1402  229 5778]
 [1261  197 6045]
 [1174  206 5642]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9846079
{'0': {'precision': 0.44255969129351236, 'recall': 0.35445618930085315, 'f1-score': 0.39363838421156133, 'support': 93185}, '1': {'precision': 0.5917804609032611, 'recall': 0.6537399855511586, 'f1-score': 0.6212191073404648, 'support': 185482}, '2': {'precision': 0.4148752409927229, 'recall': 0.4108960067106686, 'f1-score': 0.4128760362658386, 'support': 90602}, 'accuracy': 0.5186327582331579, 'macro avg': {'precision': 0.48307179772983205, 'recall': 0.4730307271875602, 'f1-score': 0.4759111759392882, 'support': 369269}, 'weighted avg': {'precision': 0.5107200302946289, 'recall': 0.5186327582331579, 'f1-score': 0.5126711149276976, 'support': 369269}}
[[ 33030  42406  17749]
 [ 29469 121257  34756]
 [ 12135  41239  37228]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0251377
{'0': {'precision': 0.47029165724621297, 'recall': 0.3761074747766969, 'f1-score': 0.4179593312972191, 'support': 55306}, '1': {'precision': 0.45475386284788555, 'recall': 0.5506106587712806, 'f1-score': 0.498112512659976, 'support': 54040}, '2': {'precision': 0.4683623398820135, 'recall': 0.465666569215027, 'f1-score': 0.46701056431588495, 'support': 54728}, 'accuracy': 0.46345551397540136, 'macro avg': {'precision': 0.46446928665870396, 'recall': 0.46412823425433486, 'f1-score': 0.46102746942436007, 'support': 164074}, 'weighted avg': {'precision': 0.46453053671527256, 'recall': 0.46345551397540136, 'f1-score': 0.46072024284620877, 'support': 164074}}
[[20801 18001 16504]
 [11861 29755 12424]
 [11568 17675 25485]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0208105
{'0': {'precision': 0.4593897948448185, 'recall': 0.4049617435659634, 'f1-score': 0.43046210720887246, 'support': 21565}, '1': {'precision': 0.4568711155753657, 'recall': 0.5627948341195577, 'f1-score': 0.5043312543312544, 'support': 25862}, '2': {'precision': 0.4981302586475538, 'recall': 0.42260409781890285, 'f1-score': 0.45726954158621186, 'support': 22695}, 'accuracy': 0.46888280425544054, 'macro avg': {'precision': 0.47146372302257933, 'recall': 0.46345355850147457, 'f1-score': 0.4640209677087796, 'support': 70122}, 'weighted avg': {'precision': 0.47099922901293245, 'recall': 0.46888280425544054, 'f1-score': 0.466382340603139, 'support': 70122}}
[[ 8733  8412  4420]
 [ 6064 14555  5243]
 [ 4213  8891  9591]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.19432
{'0': {'precision': 0.328400700083379, 'recall': 0.41947957245111395, 'f1-score': 0.3683942211679847, 'support': 104222}, '1': {'precision': 0.44383035662342196, 'recall': 0.10645883773016195, 'f1-score': 0.17172666445321072, 'support': 143323}, '2': {'precision': 0.3225101502007854, 'recall': 0.5799984040218649, 'f1-score': 0.41452321204516934, 'support': 100252}, 'accuracy': 0.33675678628625316, 'macro avg': {'precision': 0.3649137356358621, 'recall': 0.36864560473438024, 'f1-score': 0.3182146992221216, 'support': 347797}, 'weighted avg': {'precision': 0.3742699435140549, 'recall': 0.33675678628625316, 'f1-score': 0.3006464814301145, 'support': 347797}}
[[43719  9781 50722]
 [56641 15258 71424]
 [32767  9339 58146]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1488888
{'0': {'precision': 0.36281482273675203, 'recall': 0.3651088331046358, 'f1-score': 0.3639582131985141, 'support': 37167}, '1': {'precision': 0.40070748963161745, 'recall': 0.08685650828904577, 'f1-score': 0.14276711792955082, 'support': 37821}, '2': {'precision': 0.36449079249279287, 'recall': 0.6419948186528497, 'f1-score': 0.46498667767478513, 'support': 38600}, 'accuracy': 0.36655280487375425, 'macro avg': {'precision': 0.37600436828705414, 'recall': 0.36465338668217706, 'f1-score': 0.3239040029342834, 'support': 113588}, 'weighted avg': {'precision': 0.3760013476092199, 'recall': 0.36655280487375425, 'f1-score': 0.32464094653844966, 'support': 113588}}
[[13570  2278 21319]
 [12648  3285 21888]
 [11184  2635 24781]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1472979
{'0': {'precision': 0.36005864650050157, 'recall': 0.37647248668710664, 'f1-score': 0.36808267266201233, 'support': 12394}, '1': {'precision': 0.3600357355568791, 'recall': 0.10199949379903822, 'f1-score': 0.1589639076983762, 'support': 11853}, '2': {'precision': 0.3646740467404674, 'recall': 0.5979830576845502, 'f1-score': 0.4530562347188264, 'support': 12395}, 'accuracy': 0.36261666939577536, 'macro avg': {'precision': 0.36158947626594934, 'recall': 0.35881834605689833, 'f1-score': 0.3267009383597383, 'support': 36642}, 'weighted avg': {'precision': 0.3616125006176245, 'recall': 0.36261666939577536, 'f1-score': 0.3291809364189096, 'support': 36642}}
[[4666 1079 6649]
 [4380 1209 6264]
 [3913 1070 7412]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.205014
{'0': {'precision': 0.30103389670474934, 'recall': 0.1365549142851024, 'f1-score': 0.18788258259364296, 'support': 93391}, '1': {'precision': 0.41357857722477687, 'recall': 0.02989042782996276, 'f1-score': 0.05575154283005625, 'support': 102307}, '2': {'precision': 0.3263026012743805, 'recall': 0.822852256967978, 'f1-score': 0.46729791026392614, 'support': 95903}, 'accuracy': 0.3248445650049211, 'macro avg': {'precision': 0.34697169173463555, 'recall': 0.3297658663610144, 'f1-score': 0.23697734522920846, 'support': 291601}, 'weighted avg': {'precision': 0.3488302115469611, 'recall': 0.3248445650049211, 'f1-score': 0.23342027925610265, 'support': 291601}}
[[12753  2237 78401]
 [14721  3058 84528]
 [14890  2099 78914]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1727476
{'0': {'precision': 0.3498809305733651, 'recall': 0.11457708458308338, 'f1-score': 0.17262415834425415, 'support': 33340}, '1': {'precision': 0.3990738791833298, 'recall': 0.0583276933489202, 'f1-score': 0.10177953136323376, 'support': 32506}, '2': {'precision': 0.33277743537686255, 'recall': 0.8454193786073928, 'f1-score': 0.47757130097727213, 'support': 32572}, 'accuracy': 0.3378751854335589, 'macro avg': {'precision': 0.3605774150445192, 'recall': 0.33944138551313213, 'f1-score': 0.25065833022825335, 'support': 98418}, 'weighted avg': {'precision': 0.36046812947981544, 'recall': 0.3378751854335589, 'f1-score': 0.2501492338913859, 'support': 98418}}
[[ 3820  1507 28013]
 [ 3411  1896 27199]
 [ 3687  1348 27537]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2118587
{'0': {'precision': 0.3154386597009548, 'recall': 0.14974771230650816, 'f1-score': 0.20308513106007886, 'support': 11693}, '1': {'precision': 0.4602012808783166, 'recall': 0.03934913557067981, 'f1-score': 0.07249927933121937, 'support': 12783}, '2': {'precision': 0.30507884568524385, 'recall': 0.8044056906837999, 'f1-score': 0.44238049568421584, 'support': 10895}, 'accuracy': 0.3114981199287552, 'macro avg': {'precision': 0.360239595421505, 'recall': 0.3311675128536626, 'f1-score': 0.23932163535850468, 'support': 35371}, 'weighted avg': {'precision': 0.36456450892232384, 'recall': 0.3114981199287552, 'f1-score': 0.2295996218839165, 'support': 35371}}
[[ 1751   318  9624]
 [ 1941   503 10339]
 [ 1859   272  8764]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1507703
{'0': {'precision': 0.3793828769084248, 'recall': 0.3265227099006316, 'f1-score': 0.35097363549141225, 'support': 198856}, '1': {'precision': 0.34604998459503056, 'recall': 0.10143326144006119, 'f1-score': 0.1568817553272341, 'support': 188242}, '2': {'precision': 0.36570813470705826, 'recall': 0.6643252934334892, 'f1-score': 0.47173063953635147, 'support': 196893}, 'accuracy': 0.3678584087768476, 'macro avg': {'precision': 0.3637136654035045, 'recall': 0.36409375492472734, 'f1-score': 0.3265286767849993, 'support': 583991}, 'weighted avg': {'precision': 0.3640279975847509, 'recall': 0.3678584087768476, 'f1-score': 0.32912392392317746, 'support': 583991}}
[[ 64931  19335 114590]
 [ 56874  19094 112274]
 [ 49344  16748 130801]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1548386
{'0': {'precision': 0.3655477363698106, 'recall': 0.33838066319774207, 'f1-score': 0.35143996332365485, 'support': 74759}, '1': {'precision': 0.37559639512281323, 'recall': 0.11408558431625136, 'f1-score': 0.1750120935785671, 'support': 74523}, '2': {'precision': 0.36352349851770477, 'recall': 0.6402549728991903, 'f1-score': 0.46374321490106113, 'support': 75459}, 'accuracy': 0.3653627953955887, 'macro avg': {'precision': 0.36822254333677623, 'recall': 0.36424040680439457, 'f1-score': 0.3300650906010944, 'support': 224741}, 'weighted avg': {'precision': 0.36820016397388805, 'recall': 0.3653627953955887, 'f1-score': 0.3306442781739328, 'support': 224741}}
[[25297  7161 42301]
 [23733  8502 42288]
 [20173  6973 48313]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1667002
{'0': {'precision': 0.35731203082975393, 'recall': 0.35429685945149864, 'f1-score': 0.35579805732102177, 'support': 25123}, '1': {'precision': 0.3620555411367765, 'recall': 0.10395707578806171, 'f1-score': 0.16153311718388144, 'support': 26838}, '2': {'precision': 0.3543463687150838, 'recall': 0.6241439030150359, 'f1-score': 0.4520497177718228, 'support': 25406}, 'accuracy': 0.3560691250791681, 'macro avg': {'precision': 0.3579046468938714, 'recall': 0.3607992794181987, 'f1-score': 0.323126964092242, 'support': 77367}, 'weighted avg': {'precision': 0.35798364428167223, 'recall': 0.3560691250791681, 'f1-score': 0.32001648665151766, 'support': 77367}}
[[ 8901  2447 13775]
 [ 8930  2790 15118]
 [ 7080  2469 15857]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/EXC
Evaluating performance on  test set...
5098/5098 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9791122
{'0': {'precision': 0.5438144868050936, 'recall': 0.43817672719406825, 'f1-score': 0.4853136130588255, 'support': 416065}, '1': {'precision': 0.4552277337787471, 'recall': 0.6669918705908859, 'f1-score': 0.5411297334597741, 'support': 483799}, '2': {'precision': 0.5337908822514474, 'recall': 0.343711655305733, 'f1-score': 0.4181643696131129, 'support': 405043}, 'accuracy': 0.49368882226856015, 'macro avg': {'precision': 0.5109443676117628, 'recall': 0.48296008436356236, 'f1-score': 0.4815359053772375, 'support': 1304907}, 'weighted avg': {'precision': 0.5078593011967584, 'recall': 0.49368882226856015, 'f1-score': 0.48516452367611607, 'support': 1304907}}
[[182310 177107  56648]
 [ 96165 322690  64944]
 [ 56768 209057 139218]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9746167
{'0': {'precision': 0.5292526432117703, 'recall': 0.42544982033705037, 'f1-score': 0.47170809873131153, 'support': 150838}, '1': {'precision': 0.46593323684291565, 'recall': 0.681969023432438, 'f1-score': 0.5536221079279992, 'support': 177489}, '2': {'precision': 0.5606502163017939, 'recall': 0.36607013524012694, 'f1-score': 0.44293254197454635, 'support': 151878}, 'accuracy': 0.5014816588748555, 'macro avg': {'precision': 0.5186120321188267, 'recall': 0.49116299300320515, 'f1-score': 0.48942091621128564, 'support': 480205}, 'weighted avg': {'precision': 0.5157794442420907, 'recall': 0.5014816588748555, 'f1-score': 0.49288335007023326, 'support': 480205}}
[[ 64174  64307  22357]
 [ 35235 121042  21212]
 [ 21845  74435  55598]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97385114
{'0': {'precision': 0.5266201395812562, 'recall': 0.43867699271224797, 'f1-score': 0.4786425472627799, 'support': 48163}, '1': {'precision': 0.4595867668310333, 'recall': 0.6833532894844752, 'f1-score': 0.5495653550370008, 'support': 60967}, '2': {'precision': 0.5736386362812942, 'recall': 0.3215344624507534, 'f1-score': 0.4120869825488333, 'support': 49242}, 'accuracy': 0.49644507867552345, 'macro avg': {'precision': 0.5199485142311945, 'recall': 0.48118824821582556, 'f1-score': 0.48009829494953804, 'support': 158372}, 'weighted avg': {'precision': 0.5154342050602577, 'recall': 0.49644507867552345, 'f1-score': 0.4852511757067395, 'support': 158372}}
[[21128 21838  5197]
 [12734 41662  6571]
 [ 6258 27151 15833]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/AAL
Evaluating performance on  test set...
5760/5760 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9906432
{'0': {'precision': 0.484562878467103, 'recall': 0.4447287531282409, 'f1-score': 0.46379207005867923, 'support': 427157}, '1': {'precision': 0.5372804794746932, 'recall': 0.5729370796971704, 'f1-score': 0.5545361922002784, 'support': 638379}, '2': {'precision': 0.445013443537144, 'recall': 0.4371226441624626, 'f1-score': 0.4410327518378112, 'support': 408931}, 'accuracy': 0.49812779804498847, 'macro avg': {'precision': 0.48895226715964674, 'recall': 0.4849294923292913, 'f1-score': 0.4864536713655896, 'support': 1474467}, 'weighted avg': {'precision': 0.49641856559898273, 'recall': 0.49812779804498847, 'f1-score': 0.4967681564609209, 'support': 1474467}}
[[189969 150965  86223]
 [135924 365751 136704]
 [ 66149 164029 178753]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.021198
{'0': {'precision': 0.47984626585980117, 'recall': 0.4352325996817114, 'f1-score': 0.4564518875957991, 'support': 184738}, '1': {'precision': 0.42893704071150757, 'recall': 0.5346439847011638, 'f1-score': 0.47599237133942424, 'support': 182759}, '2': {'precision': 0.48705289544338265, 'recall': 0.41371371750044583, 'f1-score': 0.4473977190044971, 'support': 185041}, 'accuracy': 0.46090766607907513, 'macro avg': {'precision': 0.4652787340048971, 'recall': 0.4611967672944403, 'f1-score': 0.4599473259799068, 'support': 552538}, 'weighted avg': {'precision': 0.4654208378637149, 'recall': 0.46090766607907513, 'f1-score': 0.4598829762416444, 'support': 552538}}
[[80404 61653 42681]
 [47105 97711 37943]
 [40053 68434 76554]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0118868
{'0': {'precision': 0.49192245557350567, 'recall': 0.4083574679354572, 'f1-score': 0.4462616640291863, 'support': 70093}, '1': {'precision': 0.44292811109406166, 'recall': 0.5980808577866411, 'f1-score': 0.5089424443783266, 'support': 77222}, '2': {'precision': 0.495454297010221, 'recall': 0.3883192917321148, 'f1-score': 0.4353931010190767, 'support': 70030}, 'accuracy': 0.4693091628516874, 'macro avg': {'precision': 0.47676828789259607, 'recall': 0.46491920581807106, 'f1-score': 0.4635324031421965, 'support': 217345}, 'weighted avg': {'precision': 0.4756529006558473, 'recall': 0.4693091628516874, 'f1-score': 0.4650300265520109, 'support': 217345}}
[[28623 27682 13788]
 [17132 46185 13905]
 [12431 30405 27194]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/WBA
Evaluating performance on  test set...
6315/6315 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0265954
{'0': {'precision': 0.47680049679238384, 'recall': 0.36436489302464425, 'f1-score': 0.41306826008531833, 'support': 522597}, '1': {'precision': 0.44388655959694867, 'recall': 0.6191032791458236, 'f1-score': 0.5170540951553335, 'support': 584329}, '2': {'precision': 0.4836120002089069, 'recall': 0.38165342523826723, 'f1-score': 0.4266255669944768, 'support': 509512}, 'accuracy': 0.46190017804580197, 'macro avg': {'precision': 0.46809968553274645, 'recall': 0.4550405324695784, 'f1-score': 0.45224930741170954, 'support': 1616438}, 'weighted avg': {'precision': 0.4670494112087042, 'recall': 0.46190017804580197, 'f1-score': 0.45493163472667547, 'support': 1616438}}
[[190416 229241 102940]
 [117873 361760 104696]
 [ 91073 223982 194457]]
Evaluating performance on  train set...
2155/2155 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.035385
{'0': {'precision': 0.4721710736294223, 'recall': 0.4205140539417726, 'f1-score': 0.4448479451341864, 'support': 182938}, '1': {'precision': 0.4219371223399597, 'recall': 0.5293277523263351, 'f1-score': 0.46957064123617903, 'support': 182046}, '2': {'precision': 0.4845697310858291, 'recall': 0.41620523486119526, 'f1-score': 0.44779321441547437, 'support': 186557}, 'accuracy': 0.45497252244166797, 'macro avg': {'precision': 0.45955930901840364, 'recall': 0.4553490137097677, 'f1-score': 0.45407060026194657, 'support': 551541}, 'weighted avg': {'precision': 0.4597842636599973, 'recall': 0.45497252244166797, 'f1-score': 0.4540043424571281, 'support': 551541}}
[[76928 63224 42786]
 [45879 96362 39805]
 [40117 68794 77646]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0286014
{'0': {'precision': 0.48517178653912973, 'recall': 0.3837436751321554, 'f1-score': 0.42853790190096225, 'support': 61859}, '1': {'precision': 0.4283660254190149, 'recall': 0.6111277474995508, 'f1-score': 0.5036804857130516, 'support': 66788}, '2': {'precision': 0.4954128440366973, 'recall': 0.3712684764757028, 'f1-score': 0.4244493736711797, 'support': 62106}, 'accuracy': 0.45929552877281093, 'macro avg': {'precision': 0.4696502186649473, 'recall': 0.4553799663691363, 'f1-score': 0.45222258709506447, 'support': 190753}, 'weighted avg': {'precision': 0.46861680676556755, 'recall': 0.45929552877281093, 'f1-score': 0.4535162810268629, 'support': 190753}}
[[23738 26416 11705]
 [14192 40816 11780]
 [10997 28051 23058]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
6082/6082 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0559499
{'0': {'precision': 0.4415428286716004, 'recall': 0.38172675090645036, 'f1-score': 0.40946176940301754, 'support': 506095}, '1': {'precision': 0.44288949760509283, 'recall': 0.5262760715000091, 'f1-score': 0.48099551271397706, 'support': 549930}, '2': {'precision': 0.44230521515856724, 'recall': 0.41141031401327943, 'f1-score': 0.42629874059950074, 'support': 500775}, 'accuracy': 0.44233620246659816, 'macro avg': {'precision': 0.4422458471450868, 'recall': 0.4398043788065797, 'f1-score': 0.4389186742388318, 'support': 1556800}, 'weighted avg': {'precision': 0.4422637676101964, 'recall': 0.44233620246659816, 'f1-score': 0.44014656238215094, 'support': 1556800}}
[[193190 177597 135308]
 [136051 289415 124464]
 [108293 186458 206024]]
Evaluating performance on  train set...
2440/2440 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036034
{'0': {'precision': 0.40464707032522973, 'recall': 0.41597392715108183, 'f1-score': 0.41023232764215173, 'support': 208953}, '1': {'precision': 0.3994607305574712, 'recall': 0.3429537888126413, 'f1-score': 0.3690568205556716, 'support': 206054}, '2': {'precision': 0.40871790687787973, 'recall': 0.4541554934201109, 'f1-score': 0.4302403634267892, 'support': 209578}, 'accuracy': 0.40469591808961153, 'macro avg': {'precision': 0.40427523592019354, 'recall': 0.40436106979461134, 'f1-score': 0.40317650387487086, 'support': 624585}, 'weighted avg': {'precision': 0.4043020279827552, 'recall': 0.40469591808961153, 'f1-score': 0.4033619516108272, 'support': 624585}}
[[86919 52095 69939]
 [67630 70667 67757]
 [60253 54144 95181]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.080952
{'0': {'precision': 0.4361515079270473, 'recall': 0.40667722574191395, 'f1-score': 0.4208989991947544, 'support': 71976}, '1': {'precision': 0.4003038216240647, 'recall': 0.4420000554492778, 'f1-score': 0.4201199024968707, 'support': 72138}, '2': {'precision': 0.4214985929430683, 'recall': 0.4049076109559741, 'f1-score': 0.4130365611600176, 'support': 67324}, 'accuracy': 0.41816513587907567, 'macro avg': {'precision': 0.41931797416472677, 'recall': 0.41786163071572197, 'f1-score': 0.4180184876172142, 'support': 211438}, 'weighted avg': {'precision': 0.4192554284952235, 'recall': 0.41816513587907567, 'f1-score': 0.4181297086422399, 'support': 211438}}
[[29271 24345 18360]
 [21199 31885 19054]
 [16642 23422 27260]]
testing model on single stock: results/universal/W3/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
13689/13689 - 101s - 101s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1291317
{'0': {'precision': 0.4108312260631513, 'recall': 0.39235249297741326, 'f1-score': 0.40137929073411344, 'support': 1223196}, '1': {'precision': 0.28271563313189996, 'recall': 0.030941813079354747, 'f1-score': 0.05577890390070257, 'support': 1056887}, '2': {'precision': 0.38471387722804024, 'recall': 0.6977982435288227, 'f1-score': 0.4959808996931967, 'support': 1224159}, 'accuracy': 0.39005354082280846, 'macro avg': {'precision': 0.35942024547436385, 'recall': 0.3736975165285303, 'f1-score': 0.3177130314426709, 'support': 3504242}, 'weighted avg': {'precision': 0.3630675464146076, 'recall': 0.39005354082280846, 'f1-score': 0.33019324107845016, 'support': 3504242}}
[[479924  43308 699964]
 [357972  32702 666213]
 [330282  39661 854216]]
Evaluating performance on  train set...
5475/5475 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1432836
{'0': {'precision': 0.380842825755923, 'recall': 0.3680937167199148, 'f1-score': 0.3743597575174676, 'support': 469500}, '1': {'precision': 0.2863010202853332, 'recall': 0.1294907783471366, 'f1-score': 0.17832647050884867, 'support': 459191}, '2': {'precision': 0.3705551314358292, 'recall': 0.5799557598852971, 'f1-score': 0.4521896272699467, 'support': 472874}, 'accuracy': 0.3614010053047843, 'macro avg': {'precision': 0.3458996591590284, 'recall': 0.3591800849841162, 'f1-score': 0.33495861843208763, 'support': 1401565}, 'weighted avg': {'precision': 0.3463973812993579, 'recall': 0.3614010053047843, 'f1-score': 0.3363929138352688, 'support': 1401565}}
[[172820  73991 222689]
 [156570  59461 243160]
 [124393  74235 274246]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1561173
{'0': {'precision': 0.36691055042194204, 'recall': 0.4066229558686781, 'f1-score': 0.3857473563554227, 'support': 168837}, '1': {'precision': 0.31017711852850716, 'recall': 0.11122822649874493, 'f1-score': 0.1637399772050149, 'support': 184054}, '2': {'precision': 0.368827022349536, 'recall': 0.5874587850883707, 'f1-score': 0.45315045517140246, 'support': 168325}, 'accuracy': 0.3607122574901768, 'macro avg': {'precision': 0.3486382304333284, 'recall': 0.3684366558185979, 'f1-score': 0.33421259624394667, 'support': 521216}, 'weighted avg': {'precision': 0.3474955191556302, 'recall': 0.3607122574901768, 'f1-score': 0.32911878095875535, 'support': 521216}}
[[68653 22760 77424]
 [71786 20472 91796]
 [46672 22769 98884]]
training model: results/universal/W3/deepOF_L2/h200
Epoch 1/50
10532/10532 - 229s - loss: 3.2493 - accuracy200: 0.3928 - val_loss: 3.2987 - val_accuracy200: 0.3528 - 229s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 227s - loss: 3.2321 - accuracy200: 0.4001 - val_loss: 3.2935 - val_accuracy200: 0.3615 - 227s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 224s - loss: 3.2227 - accuracy200: 0.4051 - val_loss: 3.2820 - val_accuracy200: 0.3668 - 224s/epoch - 21ms/step
Epoch 4/50
10532/10532 - 225s - loss: 3.2171 - accuracy200: 0.4077 - val_loss: 3.2884 - val_accuracy200: 0.3631 - 225s/epoch - 21ms/step
Epoch 5/50
10532/10532 - 223s - loss: 3.2133 - accuracy200: 0.4092 - val_loss: 3.2822 - val_accuracy200: 0.3686 - 223s/epoch - 21ms/step
Epoch 6/50
10532/10532 - 222s - loss: 3.2102 - accuracy200: 0.4110 - val_loss: 3.2783 - val_accuracy200: 0.3727 - 222s/epoch - 21ms/step
Epoch 7/50
10532/10532 - 226s - loss: 3.2073 - accuracy200: 0.4124 - val_loss: 3.2830 - val_accuracy200: 0.3727 - 226s/epoch - 21ms/step
Epoch 8/50
10532/10532 - 224s - loss: 3.2053 - accuracy200: 0.4134 - val_loss: 3.2878 - val_accuracy200: 0.3736 - 224s/epoch - 21ms/step
Epoch 9/50
10532/10532 - 223s - loss: 3.2034 - accuracy200: 0.4143 - val_loss: 3.2864 - val_accuracy200: 0.3789 - 223s/epoch - 21ms/step
Epoch 10/50
10532/10532 - 223s - loss: 3.2013 - accuracy200: 0.4154 - val_loss: 3.2952 - val_accuracy200: 0.3752 - 223s/epoch - 21ms/step
Epoch 11/50
10532/10532 - 222s - loss: 3.1997 - accuracy200: 0.4162 - val_loss: 3.2993 - val_accuracy200: 0.3777 - 222s/epoch - 21ms/step
Epoch 12/50
10532/10532 - 225s - loss: 3.1980 - accuracy200: 0.4169 - val_loss: 3.3061 - val_accuracy200: 0.3781 - 225s/epoch - 21ms/step
Epoch 13/50
10532/10532 - 225s - loss: 3.1966 - accuracy200: 0.4179 - val_loss: 3.3123 - val_accuracy200: 0.3777 - 225s/epoch - 21ms/step
Epoch 14/50
10532/10532 - 223s - loss: 3.1951 - accuracy200: 0.4183 - val_loss: 3.3214 - val_accuracy200: 0.3797 - 223s/epoch - 21ms/step
Epoch 15/50
10532/10532 - 226s - loss: 3.1940 - accuracy200: 0.4191 - val_loss: 3.3217 - val_accuracy200: 0.3799 - 226s/epoch - 21ms/step
Epoch 16/50
10532/10532 - 223s - loss: 3.1925 - accuracy200: 0.4198 - val_loss: 3.3263 - val_accuracy200: 0.3783 - 223s/epoch - 21ms/step
testing model in sample: results/universal/W3/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 205s - 205s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997086
{'0': {'precision': 0.37806629764436406, 'recall': 0.4904520205045429, 'f1-score': 0.4269878382290137, 'support': 2378985}, '1': {'precision': 0.3392163782578042, 'recall': 0.3599354674037343, 'f1-score': 0.34926892181396524, 'support': 2382052}, '2': {'precision': 0.39196041658461994, 'recall': 0.24823687763930816, 'f1-score': 0.30396576445740275, 'support': 2325420}, 'accuracy': 0.367097126250819, 'macro avg': {'precision': 0.36974769749559605, 'recall': 0.3662081218491951, 'f1-score': 0.3600741748334606, 'support': 7086457}, 'weighted avg': {'precision': 0.36956658246814217, 'recall': 0.367097126250819, 'f1-score': 0.3604936097204263, 'support': 7086457}}
[[1166778  804164  408043]
 [1037227  857385  487440]
 [ 882168  865997  577255]]
Evaluating performance on  train set...
10532/10532 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097656
{'0': {'precision': 0.37386651510230595, 'recall': 0.5090240575204902, 'f1-score': 0.4310999718188806, 'support': 904582}, '1': {'precision': 0.3389121383308787, 'recall': 0.3608857322668812, 'f1-score': 0.34955395080353424, 'support': 885053}, '2': {'precision': 0.4014052249375679, 'recall': 0.23112711991595378, 'f1-score': 0.2933466859485901, 'support': 906168}, 'accuracy': 0.3669767412529773, 'macro avg': {'precision': 0.37139462612358415, 'recall': 0.3670123032344417, 'f1-score': 0.3580002028570017, 'support': 2695803}, 'weighted avg': {'precision': 0.3716475924248394, 'recall': 0.3669767412529773, 'f1-score': 0.35802335231507976, 'support': 2695803}}
[[460454 295442 148686]
 [402009 319403 163641]
 [369137 327591 209440]]
Evaluating performance on  val set...
3814/3814 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0929134
{'0': {'precision': 0.37240669021195244, 'recall': 0.5152700550448461, 'f1-score': 0.4323421037893006, 'support': 322101}, '1': {'precision': 0.3553974600530587, 'recall': 0.36743068581080063, 'f1-score': 0.36131391183349615, 'support': 332147}, '2': {'precision': 0.4043421228751171, 'recall': 0.23483920319914425, 'f1-score': 0.2971156323950893, 'support': 321586}, 'accuracy': 0.3725336481409748, 'macro avg': {'precision': 0.37738209104670944, 'recall': 0.3725133146849304, 'f1-score': 0.3635905493392954, 'support': 975834}, 'weighted avg': {'precision': 0.3771415357685024, 'recall': 0.3725336481409748, 'f1-score': 0.36360219423160595, 'support': 975834}}
[[165969 104541  51591]
 [150443 122041  59663]
 [129254 116811  75521]]
testing model out of sample: results/universal/W3/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 123s - 123s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955999
{'0': {'precision': 0.3781468780873872, 'recall': 0.46755451982445917, 'f1-score': 0.41812460625894865, 'support': 1366292}, '1': {'precision': 0.36182397517203174, 'recall': 0.41162941732517483, 'f1-score': 0.3851231205890143, 'support': 1453538}, '2': {'precision': 0.38239249090411864, 'recall': 0.23045876047099642, 'f1-score': 0.28759245989771115, 'support': 1316613}, 'accuracy': 0.37243593106444356, 'macro avg': {'precision': 0.3741211147211792, 'recall': 0.3698808992068768, 'f1-score': 0.3636133955818914, 'support': 4136443}, 'weighted avg': {'precision': 0.3737624031580083, 'recall': 0.37243593106444356, 'f1-score': 0.3649800967625497, 'support': 4136443}}
[[638816 509037 218439]
 [583592 598319 271627]
 [466925 546263 303425]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974147
{'0': {'precision': 0.37785276149796365, 'recall': 0.4623794175576013, 'f1-score': 0.4158644339957038, 'support': 526507}, '1': {'precision': 0.35322998427070046, 'recall': 0.430886454886852, 'f1-score': 0.3882127910636973, 'support': 523783}, '2': {'precision': 0.393349991291416, 'recall': 0.22095847703339108, 'f1-score': 0.28296538139498456, 'support': 531489}, 'accuracy': 0.3708318292251952, 'macro avg': {'precision': 0.37481091235336006, 'recall': 0.3714081164926148, 'f1-score': 0.3623475354847952, 'support': 1581779}, 'weighted avg': {'precision': 0.37490646814172657, 'recall': 0.3708318292251952, 'f1-score': 0.3620529691465948, 'support': 1581779}}
[[243446 196384  86677]
 [203650 225691  94442]
 [197192 216860 117437]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979234
{'0': {'precision': 0.39092129325177694, 'recall': 0.45071431909888293, 'f1-score': 0.4186938430923235, 'support': 192561}, '1': {'precision': 0.3418323099871648, 'recall': 0.4211246086947231, 'f1-score': 0.37735812929321944, 'support': 187194}, '2': {'precision': 0.38911290322580644, 'recall': 0.23580993777402945, 'f1-score': 0.2936576597198612, 'support': 184971}, 'accuracy': 0.370515967035341, 'macro avg': {'precision': 0.3739555021549161, 'recall': 0.3692162885225452, 'f1-score': 0.36323654403513467, 'support': 564726}, 'weighted avg': {'precision': 0.3740570744186975, 'recall': 0.370515967035341, 'f1-score': 0.364037486764658, 'support': 564726}}
[[86790 73971 31800]
 [71684 78832 36678]
 [63540 77813 43618]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105489
{'0': {'precision': 0.34795757838776176, 'recall': 0.45449231205271734, 'f1-score': 0.39415307094355856, 'support': 56452}, '1': {'precision': 0.3798887225873625, 'recall': 0.3657680800739337, 'f1-score': 0.3726946987048017, 'support': 63841}, '2': {'precision': 0.3373140582442908, 'recall': 0.24258404746209625, 'f1-score': 0.2822116806713483, 'support': 53095}, 'accuracy': 0.3569335824855238, 'macro avg': {'precision': 0.35505345307313835, 'recall': 0.35428147986291575, 'f1-score': 0.3496864834399028, 'support': 173388}, 'weighted avg': {'precision': 0.3564552741615703, 'recall': 0.3569335824855238, 'f1-score': 0.35197338112305493, 'support': 173388}}
[[25657 19290 11505]
 [26691 23351 13799]
 [21388 18827 12880]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1161265
{'0': {'precision': 0.33757884522076664, 'recall': 0.507175725545583, 'f1-score': 0.4053527537551207, 'support': 21949}, '1': {'precision': 0.3348125969095867, 'recall': 0.286223603620075, 'f1-score': 0.30861733323476503, 'support': 21878}, '2': {'precision': 0.3489896231567449, 'recall': 0.2272, 'f1-score': 0.2752234306019167, 'support': 22500}, 'accuracy': 0.3393188294359763, 'macro avg': {'precision': 0.34046035509569944, 'recall': 0.3401997763885527, 'f1-score': 0.3297311725306008, 'support': 66327}, 'weighted avg': {'precision': 0.34053725616966396, 'recall': 0.33931882943597635, 'f1-score': 0.32930096035135703, 'support': 66327}}
[[11132  6038  4779]
 [10859  6262  4757]
 [10985  6403  5112]]
Evaluating performance on  val set...
86/86 - 1s - 852ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1172938
{'0': {'precision': 0.3628007040876198, 'recall': 0.4778464708912932, 'f1-score': 0.41245136186770426, 'support': 7764}, '1': {'precision': 0.31622543446483675, 'recall': 0.2688855130506836, 'f1-score': 0.29064039408867, 'support': 7241}, '2': {'precision': 0.32624752296883447, 'recall': 0.26136527637465723, 'f1-score': 0.290224358974359, 'support': 6929}, 'accuracy': 0.34047597337466945, 'macro avg': {'precision': 0.335091220507097, 'recall': 0.3360324201055447, 'f1-score': 0.33110537164357773, 'support': 21934}, 'weighted avg': {'precision': 0.3358777297413703, 'recall': 0.34047597337466945, 'f1-score': 0.3336265182123757, 'support': 21934}}
[[3710 2209 1845]
 [3399 1947 1895]
 [3117 2001 1811]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0840638
{'0': {'precision': 0.3681546823487481, 'recall': 0.54222148343861, 'f1-score': 0.43854702154984837, 'support': 114302}, '1': {'precision': 0.3877062887219694, 'recall': 0.3852481902440021, 'f1-score': 0.38647333094225544, 'support': 146843}, '2': {'precision': 0.3939140551152476, 'recall': 0.2004180385483334, 'f1-score': 0.2656679089839153, 'support': 108124}, 'accuracy': 0.3797177667229039, 'macro avg': {'precision': 0.38325834206198833, 'recall': 0.37596257074364847, 'f1-score': 0.3635627538253397, 'support': 369269}, 'weighted avg': {'precision': 0.38347203353627785, 'recall': 0.3797177667229039, 'f1-score': 0.3672195120189381, 'support': 369269}}
[[61977 40397 11928]
 [68858 56571 21414]
 [37510 48944 21670]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0855505
{'0': {'precision': 0.39639906423050725, 'recall': 0.48331889081455803, 'f1-score': 0.43556495566582604, 'support': 55392}, '1': {'precision': 0.36038754529990386, 'recall': 0.44619441799135595, 'f1-score': 0.3987267713507188, 'support': 54604}, '2': {'precision': 0.4198956137015658, 'recall': 0.22463848515107807, 'f1-score': 0.2926911539712561, 'support': 54078}, 'accuracy': 0.3857040116045199, 'macro avg': {'precision': 0.3922274077439923, 'recall': 0.3847172646523307, 'f1-score': 0.37566096032926694, 'support': 164074}, 'weighted avg': {'precision': 0.39215874231849945, 'recall': 0.3857040116045199, 'f1-score': 0.376214652361335, 'support': 164074}}
[[26772 20328  8292]
 [21749 24364  8491]
 [19017 22913 12148]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0762799
{'0': {'precision': 0.3747587183116716, 'recall': 0.5326231082255041, 'f1-score': 0.43995845529222927, 'support': 21871}, '1': {'precision': 0.38572384878272203, 'recall': 0.43827061649319454, 'f1-score': 0.4103217585218222, 'support': 24980}, '2': {'precision': 0.4528390427029564, 'recall': 0.20733960723647457, 'f1-score': 0.28444261038731355, 'support': 23271}, 'accuracy': 0.3910612931747526, 'macro avg': {'precision': 0.40444053659911666, 'recall': 0.39274444398505776, 'f1-score': 0.378240941400455, 'support': 70122}, 'weighted avg': {'precision': 0.4045769805984922, 'recall': 0.3910612931747526, 'f1-score': 0.377790606227641, 'support': 70122}}
[[11649  7749  2473]
 [10675 10948  3357]
 [ 8760  9686  4825]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
1359/1359 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933164
{'0': {'precision': 0.3056445973732856, 'recall': 0.44643434997168513, 'f1-score': 0.36286149913490895, 'support': 98888}, '1': {'precision': 0.4632625353798007, 'recall': 0.39184340796584766, 'f1-score': 0.4245704805556336, 'support': 154133}, '2': {'precision': 0.30827407620535163, 'recall': 0.23740187389212458, 'f1-score': 0.2682355465746321, 'support': 94776}, 'accuracy': 0.36527917147071426, 'macro avg': {'precision': 0.359060402986146, 'recall': 0.3585598772765524, 'f1-score': 0.3518891754217249, 'support': 347797}, 'weighted avg': {'precision': 0.3762125928549777, 'recall': 0.36527917147071426, 'f1-score': 0.3644231030402553, 'support': 347797}}
[[44147 35927 18814]
 [62064 60396 31673]
 [38228 34048 22500]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049569
{'0': {'precision': 0.341778309248262, 'recall': 0.4529655098313098, 'f1-score': 0.38959418716138944, 'support': 37228}, '1': {'precision': 0.35114428596063363, 'recall': 0.37897479527810274, 'f1-score': 0.3645291221788888, 'support': 37612}, '2': {'precision': 0.36861684139330403, 'recall': 0.22504387323216682, 'f1-score': 0.2794692647907185, 'support': 38748}, 'accuracy': 0.35071486424622317, 'macro avg': {'precision': 0.3538464788673999, 'recall': 0.35232805944719314, 'f1-score': 0.3445308580436655, 'support': 113588}, 'weighted avg': {'precision': 0.35403499621926077, 'recall': 0.35071486424622317, 'f1-score': 0.34372783053797346, 'support': 113588}}
[[16863 12877  7488]
 [15910 14254  7448]
 [16566 13462  8720]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062367
{'0': {'precision': 0.3452300634192417, 'recall': 0.41252821670428896, 'f1-score': 0.37589069272019393, 'support': 12404}, '1': {'precision': 0.34391310481026943, 'recall': 0.40029554223791153, 'f1-score': 0.36996851170378237, 'support': 12181}, '2': {'precision': 0.34532844805024865, 'recall': 0.2188770009123331, 'f1-score': 0.26793238235443423, 'support': 12057}, 'accuracy': 0.3447410075869221, 'macro avg': {'precision': 0.3448238720932532, 'recall': 0.3439002532848445, 'f1-score': 0.3379305289261368, 'support': 36642}, 'weighted avg': {'precision': 0.34482463660520757, 'recall': 0.3447410075869221, 'f1-score': 0.33839843151608734, 'support': 36642}}
[[5117 4749 2538]
 [4840 4876 2465]
 [4865 4553 2639]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1143346
{'0': {'precision': 0.3214173475801383, 'recall': 0.40468889108715006, 'f1-score': 0.35827823269256037, 'support': 90981}, '1': {'precision': 0.3724957490666945, 'recall': 0.3678241782980639, 'f1-score': 0.37014522439694353, 'support': 106608}, '2': {'precision': 0.32863830142940736, 'recall': 0.25091477683699953, 'f1-score': 0.2845648109053622, 'support': 94012}, 'accuracy': 0.34163463088261015, 'macro avg': {'precision': 0.3408504660254134, 'recall': 0.3411426154074045, 'f1-score': 0.3376627559982887, 'support': 291601}, 'weighted avg': {'precision': 0.3424194104638605, 'recall': 0.34163463088261015, 'f1-score': 0.3388515847817603, 'support': 291601}}
[[36819 32222 21940]
 [41146 39213 26249]
 [36587 33836 23589]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1111683
{'0': {'precision': 0.33855415667466027, 'recall': 0.41390789152211094, 'f1-score': 0.37245795317137514, 'support': 32744}, '1': {'precision': 0.3406089567660069, 'recall': 0.3250146347475121, 'f1-score': 0.33262912278488993, 'support': 32457}, '2': {'precision': 0.34440999452854276, 'recall': 0.2842520396182678, 'f1-score': 0.3114526982451511, 'support': 33217}, 'accuracy': 0.3408319616330346, 'macro avg': {'precision': 0.3411910359897366, 'recall': 0.34105818862929693, 'f1-score': 0.3388465914004721, 'support': 98418}, 'weighted avg': {'precision': 0.3412082038261697, 'recall': 0.3408319616330346, 'f1-score': 0.338733066456155, 'support': 98418}}
[[13553 10126  9065]
 [13000 10549  8908]
 [13479 10296  9442]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1146126
{'0': {'precision': 0.3201171741944274, 'recall': 0.4092849054960369, 'f1-score': 0.3592507645259939, 'support': 11481}, '1': {'precision': 0.3790782388343364, 'recall': 0.3626789908326388, 'f1-score': 0.37069733224919654, 'support': 13199}, '2': {'precision': 0.30617559523809523, 'recall': 0.23094191375923673, 'f1-score': 0.26328978938949615, 'support': 10691}, 'accuracy': 0.33798874784427924, 'macro avg': {'precision': 0.33512366942228633, 'recall': 0.3343019366959708, 'f1-score': 0.3310792953882289, 'support': 35371}, 'weighted avg': {'precision': 0.33790512679853846, 'recall': 0.33798874784427924, 'f1-score': 0.33451763462280354, 'support': 35371}}
[[4699 4035 2747]
 [5564 4787 2848]
 [4416 3806 2469]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089302
{'0': {'precision': 0.38462181730155587, 'recall': 0.4111854023253516, 'f1-score': 0.39746027125612876, 'support': 212527}, '1': {'precision': 0.3030271712116067, 'recall': 0.37336429896794693, 'f1-score': 0.33453859883131803, 'support': 164914}, '2': {'precision': 0.3804860898608661, 'recall': 0.2829339143064633, 'f1-score': 0.3245377530592015, 'support': 206550}, 'accuracy': 0.3551441717423727, 'macro avg': {'precision': 0.3560450261246762, 'recall': 0.35582787186658726, 'f1-score': 0.3521788743822161, 'support': 583991}, 'weighted avg': {'precision': 0.36011744314484395, 'recall': 0.3551441717423727, 'f1-score': 0.353899992382241, 'support': 583991}}
[[87388 72382 52757]
 [60945 61573 42396]
 [78872 69238 58440]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1046337
{'0': {'precision': 0.3544262571921402, 'recall': 0.39270010558250806, 'f1-score': 0.37258283352142324, 'support': 74823}, '1': {'precision': 0.34888919458009493, 'recall': 0.41178460289541335, 'f1-score': 0.3777366827185623, 'support': 73910}, '2': {'precision': 0.36929528972236464, 'recall': 0.26530102094516367, 'f1-score': 0.3087771414571402, 'support': 76008}, 'accuracy': 0.35588966855179965, 'macro avg': {'precision': 0.35753691383153324, 'recall': 0.35659524314102836, 'f1-score': 0.3530322192323753, 'support': 224741}, 'weighted avg': {'precision': 0.35763404360806356, 'recall': 0.35588966855179965, 'f1-score': 0.35269851313368145, 'support': 224741}}
[[29383 28298 17142]
 [26178 30435 17297]
 [27342 28501 20165]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1104672
{'0': {'precision': 0.36056244951905425, 'recall': 0.3748473282442748, 'f1-score': 0.3675661514278229, 'support': 26200}, '1': {'precision': 0.3386448936590505, 'recall': 0.4116870122073244, 'f1-score': 0.3716107588648639, 'support': 24985}, '2': {'precision': 0.35945330296127564, 'recall': 0.27121686654953786, 'f1-score': 0.3091625487080132, 'support': 26182}, 'accuracy': 0.3516744865381881, 'macro avg': {'precision': 0.3528868820464601, 'recall': 0.35258373566704565, 'f1-score': 0.3494464863335667, 'support': 77367}, 'weighted avg': {'precision': 0.3531090157767875, 'recall': 0.3516744865381881, 'f1-score': 0.3491077827487273, 'support': 77367}}
[[ 9821 10026  6353]
 [ 8398 10286  6301]
 [ 9019 10062  7101]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/EXC
Evaluating performance on  test set...
5098/5098 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997374
{'0': {'precision': 0.43031678506961674, 'recall': 0.4571750277006446, 'f1-score': 0.4433394997079944, 'support': 445838}, '1': {'precision': 0.3170533156494099, 'recall': 0.4180751771630264, 'f1-score': 0.36062299966945194, 'support': 439708}, '2': {'precision': 0.4308617473581221, 'recall': 0.2583263584358107, 'f1-score': 0.3229972927524479, 'support': 419361}, 'accuracy': 0.38009528648401764, 'macro avg': {'precision': 0.3927439493590496, 'recall': 0.37785885443316053, 'f1-score': 0.3756532640432981, 'support': 1304907}, 'weighted avg': {'precision': 0.39232609478935127, 'recall': 0.38009528648401764, 'f1-score': 0.3767922782967886, 'support': 1304907}}
[[203826 186786  55226]
 [168004 183831  87873]
 [101835 209194 108332]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033196
{'0': {'precision': 0.4272058645926427, 'recall': 0.4344758126424005, 'f1-score': 0.4308101705958829, 'support': 162833}, '1': {'precision': 0.3052555474231037, 'recall': 0.44220748154182343, 'f1-score': 0.36118518674981914, 'support': 154674}, '2': {'precision': 0.4525973954248727, 'recall': 0.2518469802947793, 'f1-score': 0.32361756656965385, 'support': 162698}, 'accuracy': 0.37508980539561226, 'macro avg': {'precision': 0.3950196024802064, 'recall': 0.3761767581596678, 'f1-score': 0.3718709746384519, 'support': 480205}, 'weighted avg': {'precision': 0.39652856620020793, 'recall': 0.37508980539561226, 'f1-score': 0.37206609870728224, 'support': 480205}}
[[70747 72302 19784]
 [56502 68398 29774]
 [38355 83368 40975]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948687
{'0': {'precision': 0.421660095973741, 'recall': 0.45860577016355913, 'f1-score': 0.43935760887748837, 'support': 51541}, '1': {'precision': 0.3245102211727234, 'recall': 0.4351195626162031, 'f1-score': 0.3717620043723754, 'support': 54323}, '2': {'precision': 0.4612566155516352, 'recall': 0.25893197227089204, 'f1-score': 0.3316744730679157, 'support': 52508}, 'accuracy': 0.3843482433763544, 'macro avg': {'precision': 0.4024756442326998, 'recall': 0.38421910168355144, 'f1-score': 0.3809313621059265, 'support': 158372}, 'weighted avg': {'precision': 0.40146499457437995, 'recall': 0.3843482433763544, 'f1-score': 0.38046953447910803, 'support': 158372}}
[[23637 22160  5744]
 [20550 23637 10136]
 [11870 27042 13596]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/AAL
Evaluating performance on  test set...
5760/5760 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978696
{'0': {'precision': 0.39108114320741705, 'recall': 0.5019535851925003, 'f1-score': 0.43963482200937615, 'support': 488077}, '1': {'precision': 0.3355172787272487, 'recall': 0.3702481094884141, 'f1-score': 0.35202813916258935, 'support': 527106}, '2': {'precision': 0.39482260183968465, 'recall': 0.22896726208620374, 'f1-score': 0.28984584515058553, 'support': 459284}, 'accuracy': 0.3698373717417887, 'macro avg': {'precision': 0.37380700792478344, 'recall': 0.3670563189223727, 'f1-score': 0.36050293544085027, 'support': 1474467}, 'weighted avg': {'precision': 0.3723830955303777, 'recall': 0.3698373717417887, 'f1-score': 0.3616583812913057, 'support': 1474467}}
[[244992 181659  61426]
 [232183 195160  99763]
 [149273 204850 105161]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920662
{'0': {'precision': 0.39953821860306704, 'recall': 0.48990660490947946, 'f1-score': 0.4401316574858878, 'support': 184378}, '1': {'precision': 0.3470192730944839, 'recall': 0.436019368516942, 'f1-score': 0.3864614497350683, 'support': 184423}, '2': {'precision': 0.4271071937509896, 'recall': 0.22021694051824076, 'f1-score': 0.29060013214973135, 'support': 183737}, 'accuracy': 0.3822397735540361, 'macro avg': {'precision': 0.39122156181618023, 'recall': 0.38204763798155406, 'f1-score': 0.3723977464568958, 'support': 552538}, 'weighted avg': {'precision': 0.3911763309124909, 'recall': 0.3822397735540361, 'f1-score': 0.37249378534909583, 'support': 552538}}
[[90328 70263 23787]
 [73525 80412 30486]
 [62228 81047 40462]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1036295
{'0': {'precision': 0.4057691838774963, 'recall': 0.44976283463290045, 'f1-score': 0.4266348760743746, 'support': 73999}, '1': {'precision': 0.31323759874628204, 'recall': 0.4171861023158074, 'f1-score': 0.35781525908786455, 'support': 70429}, '2': {'precision': 0.42011463802321664, 'recall': 0.23923090637299943, 'f1-score': 0.30486110504286124, 'support': 72917}, 'accuracy': 0.3685753065402931, 'macro avg': {'precision': 0.37970714021566493, 'recall': 0.36872661444056903, 'f1-score': 0.3631037467350335, 'support': 217345}, 'weighted avg': {'precision': 0.3805977765331231, 'recall': 0.3685753065402931, 'f1-score': 0.3634805598165919, 'support': 217345}}
[[33282 30486 10231]
 [27200 29382 13847]
 [21540 33933 17444]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/WBA
Evaluating performance on  test set...
6315/6315 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913544
{'0': {'precision': 0.41558345794520735, 'recall': 0.432716429636375, 'f1-score': 0.4239769279014415, 'support': 560055}, '1': {'precision': 0.34322071882990574, 'recall': 0.46411961986711897, 'f1-score': 0.3946178876951543, 'support': 519713}, '2': {'precision': 0.41546626002608067, 'recall': 0.2558685970894591, 'f1-score': 0.3166967064621885, 'support': 536670}, 'accuracy': 0.384098245648766, 'macro avg': {'precision': 0.39142347893373125, 'recall': 0.38423488219765095, 'f1-score': 0.3784305073529281, 'support': 1616438}, 'weighted avg': {'precision': 0.3922786650356814, 'recall': 0.384098245648766, 'f1-score': 0.37891961589656775, 'support': 1616438}}
[[242345 224348  93362]
 [178670 241209  99834]
 [162129 237224 137317]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0797542
{'0': {'precision': 0.4072791762121376, 'recall': 0.47362173280379866, 'f1-score': 0.43795225364901197, 'support': 182802}, '1': {'precision': 0.3679669364385893, 'recall': 0.478882583545796, 'f1-score': 0.4161612022508851, 'support': 182385}, '2': {'precision': 0.4353402033444553, 'recall': 0.23734934586861564, 'f1-score': 0.30720772342900804, 'support': 186354}, 'accuracy': 0.39552997873231543, 'macro avg': {'precision': 0.40352877199839404, 'recall': 0.3966178874060701, 'f1-score': 0.3871070597763017, 'support': 551541}, 'weighted avg': {'precision': 0.4037605290020795, 'recall': 0.39552997873231543, 'f1-score': 0.3865705302705759, 'support': 551541}}
[[86579 69761 26462]
 [64136 87341 30908]
 [61864 80259 44231]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0781194
{'0': {'precision': 0.4132883376429855, 'recall': 0.4457504805722749, 'f1-score': 0.42890605456461256, 'support': 63466}, '1': {'precision': 0.37139451171053245, 'recall': 0.4952235503124562, 'f1-score': 0.4244622093993976, 'support': 64169}, '2': {'precision': 0.42941913005607274, 'recall': 0.24994454830634685, 'f1-score': 0.3159750040057683, 'support': 63118}, 'accuracy': 0.3976031831740523, 'macro avg': {'precision': 0.40470065980319686, 'recall': 0.3969728597303593, 'f1-score': 0.38978108932325944, 'support': 190753}, 'weighted avg': {'precision': 0.40453281840748023, 'recall': 0.3976031831740523, 'f1-score': 0.390043550962678, 'support': 190753}}
[[28290 25466  9710]
 [21139 31778 11252]
 [19022 28320 15776]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
6082/6082 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0878557
{'0': {'precision': 0.3834759347897897, 'recall': 0.46404414242830383, 'f1-score': 0.41993049152422157, 'support': 510348}, '1': {'precision': 0.38117756868559916, 'recall': 0.4748428830048717, 'f1-score': 0.42288582076285525, 'support': 543544}, '2': {'precision': 0.39798413709698954, 'recall': 0.20743356637794585, 'f1-score': 0.2727216876745849, 'support': 502908}, 'accuracy': 0.3849190647482014, 'macro avg': {'precision': 0.3875458801907928, 'recall': 0.38210686393704046, 'f1-score': 0.37184599998722057, 'support': 1556800}, 'weighted avg': {'precision': 0.3873602024543408, 'recall': 0.3849190647482014, 'f1-score': 0.37340805212884054, 'support': 1556800}}
[[236824 199547  73977]
 [201622 258098  83824]
 [179126 219462 104320]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096449
{'0': {'precision': 0.3784009433215682, 'recall': 0.4594794574518688, 'f1-score': 0.4150173699639581, 'support': 208129}, '1': {'precision': 0.36215149688875925, 'recall': 0.4580646727519907, 'f1-score': 0.40450021116177565, 'support': 205960}, '2': {'precision': 0.3898737360130754, 'recall': 0.20624619945272119, 'f1-score': 0.2697778468230542, 'support': 210496}, 'accuracy': 0.37366891616033043, 'macro avg': {'precision': 0.37680872540780097, 'recall': 0.3745967765521936, 'f1-score': 0.3630984759829294, 'support': 624585}, 'weighted avg': {'precision': 0.37690913833600204, 'recall': 0.37366891616033043, 'f1-score': 0.3626010412177263, 'support': 624585}}
[[95631 79223 33275]
 [76952 94343 34665]
 [80141 86941 43414]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0843613
{'0': {'precision': 0.3986991498830376, 'recall': 0.4839737374297033, 'f1-score': 0.43721727596368615, 'support': 72194}, '1': {'precision': 0.376866321965956, 'recall': 0.44825727632051743, 'f1-score': 0.40947337192200634, 'support': 72358}, '2': {'precision': 0.38931580899888707, 'recall': 0.21965732739287744, 'f1-score': 0.2808533414895244, 'support': 66886}, 'accuracy': 0.38813742089879777, 'macro avg': {'precision': 0.3882937602826269, 'recall': 0.38396278038103276, 'f1-score': 0.3758479964584056, 'support': 211438}, 'weighted avg': {'precision': 0.38825923888879116, 'recall': 0.38813742089879777, 'f1-score': 0.3782588506575129, 'support': 211438}}
[[34940 26363 10891]
 [27768 32435 12155]
 [24927 27267 14692]]
testing model on single stock: results/universal/W3/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
13689/13689 - 104s - 104s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1040348
{'0': {'precision': 0.35583115725423, 'recall': 0.5322017555953071, 'f1-score': 0.4265021348781864, 'support': 1167809}, '1': {'precision': 0.33797006926436535, 'recall': 0.28737833353290343, 'f1-score': 0.3106277232171335, 'support': 1169180}, '2': {'precision': 0.37398370788945257, 'recall': 0.24460249834440348, 'f1-score': 0.2957626548021692, 'support': 1167253}, 'accuracy': 0.35471865242183614, 'macro avg': {'precision': 0.3559283114693493, 'recall': 0.354727529157538, 'f1-score': 0.344297504299163, 'support': 3504242}, 'weighted avg': {'precision': 0.35591842072822105, 'recall': 0.35471865242183614, 'f1-score': 0.344292032104736, 'support': 3504242}}
[[621510 320645 225654]
 [580913 335997 252270]
 [544220 337520 285513]]
Evaluating performance on  train set...
5475/5475 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1030225
{'0': {'precision': 0.3530436650156378, 'recall': 0.5586403036462615, 'f1-score': 0.4326596211057566, 'support': 470811}, '1': {'precision': 0.3377354061244718, 'recall': 0.2809106746533661, 'f1-score': 0.30671326865747656, 'support': 460933}, '2': {'precision': 0.3758963377807061, 'recall': 0.21857899072199838, 'f1-score': 0.27642204205562193, 'support': 469821}, 'accuracy': 0.35331076332528283, 'macro avg': {'precision': 0.3555584696402719, 'recall': 0.3527099896738753, 'f1-score': 0.33859831060628504, 'support': 1401565}, 'weighted avg': {'precision': 0.35566971794623703, 'recall': 0.35331076332528283, 'f1-score': 0.33886694955648394, 'support': 1401565}}
[[263014 122824  84973]
 [245923 129481  85529]
 [236053 131075 102693]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983815
{'0': {'precision': 0.3538814525995549, 'recall': 0.561044537302437, 'f1-score': 0.43400943469733494, 'support': 173742}, '1': {'precision': 0.35366099130302, 'recall': 0.29037019307483647, 'f1-score': 0.3189057077318346, 'support': 175476}, '2': {'precision': 0.38406167643472444, 'recall': 0.22707240781869556, 'f1-score': 0.2854031933939859, 'support': 171998}, 'accuracy': 0.3597088347249509, 'macro avg': {'precision': 0.36386804011243307, 'recall': 0.3594957127319897, 'f1-score': 0.3461061119410518, 'support': 521216}, 'weighted avg': {'precision': 0.363766514594449, 'recall': 0.3597088347249509, 'f1-score': 0.34621873394238584, 'support': 521216}}
[[97477 45139 31126]
 [93013 50953 31510]
 [84961 47981 39056]]
training model: results/universal/W3/deepVOL_L2/h50
Epoch 1/50
10532/10532 - 345s - loss: 3.0273 - accuracy50: 0.4690 - val_loss: 3.4909 - val_accuracy50: 0.4614 - 345s/epoch - 33ms/step
Epoch 2/50
10532/10532 - 336s - loss: 2.9787 - accuracy50: 0.4837 - val_loss: 3.5195 - val_accuracy50: 0.4688 - 336s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 341s - loss: 2.9610 - accuracy50: 0.4888 - val_loss: 3.5013 - val_accuracy50: 0.4742 - 341s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 342s - loss: 2.9462 - accuracy50: 0.4933 - val_loss: 3.4843 - val_accuracy50: 0.4768 - 342s/epoch - 32ms/step
Epoch 5/50
10532/10532 - 342s - loss: 2.9342 - accuracy50: 0.4970 - val_loss: 3.4740 - val_accuracy50: 0.4771 - 342s/epoch - 32ms/step
Epoch 6/50
10532/10532 - 343s - loss: 2.9245 - accuracy50: 0.4994 - val_loss: 3.4765 - val_accuracy50: 0.4777 - 343s/epoch - 33ms/step
Epoch 7/50
10532/10532 - 344s - loss: 2.9176 - accuracy50: 0.5010 - val_loss: 3.4535 - val_accuracy50: 0.4753 - 344s/epoch - 33ms/step
Epoch 8/50
10532/10532 - 347s - loss: 2.9113 - accuracy50: 0.5029 - val_loss: 3.4396 - val_accuracy50: 0.4762 - 347s/epoch - 33ms/step
Epoch 9/50
10532/10532 - 352s - loss: 2.9065 - accuracy50: 0.5043 - val_loss: 3.4192 - val_accuracy50: 0.4762 - 352s/epoch - 33ms/step
Epoch 10/50
10532/10532 - 343s - loss: 2.9025 - accuracy50: 0.5050 - val_loss: 3.4353 - val_accuracy50: 0.4771 - 343s/epoch - 33ms/step
Epoch 11/50
10532/10532 - 347s - loss: 2.8989 - accuracy50: 0.5061 - val_loss: 3.4343 - val_accuracy50: 0.4777 - 347s/epoch - 33ms/step
Epoch 12/50
10532/10532 - 345s - loss: 2.8954 - accuracy50: 0.5070 - val_loss: 3.4445 - val_accuracy50: 0.4772 - 345s/epoch - 33ms/step
Epoch 13/50
10532/10532 - 340s - loss: 2.8922 - accuracy50: 0.5081 - val_loss: 3.4228 - val_accuracy50: 0.4793 - 340s/epoch - 32ms/step
Epoch 14/50
10532/10532 - 338s - loss: 2.8896 - accuracy50: 0.5086 - val_loss: 3.4471 - val_accuracy50: 0.4787 - 338s/epoch - 32ms/step
Epoch 15/50
10532/10532 - 345s - loss: 2.8868 - accuracy50: 0.5093 - val_loss: 3.4220 - val_accuracy50: 0.4800 - 345s/epoch - 33ms/step
Epoch 16/50
10532/10532 - 342s - loss: 2.8846 - accuracy50: 0.5102 - val_loss: 3.4375 - val_accuracy50: 0.4805 - 342s/epoch - 32ms/step
Epoch 17/50
10532/10532 - 342s - loss: 2.8823 - accuracy50: 0.5107 - val_loss: 3.4464 - val_accuracy50: 0.4811 - 342s/epoch - 32ms/step
Epoch 18/50
10532/10532 - 347s - loss: 2.8801 - accuracy50: 0.5113 - val_loss: 3.4262 - val_accuracy50: 0.4803 - 347s/epoch - 33ms/step
Epoch 19/50
10532/10532 - 341s - loss: 2.8782 - accuracy50: 0.5118 - val_loss: 3.4274 - val_accuracy50: 0.4802 - 341s/epoch - 32ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 434s - 434s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1713176
{'0': {'precision': 0.41329500623798765, 'recall': 0.5909172866503909, 'f1-score': 0.48639747870414535, 'support': 2074248}, '1': {'precision': 0.5649015646809648, 'recall': 0.4867032625160015, 'f1-score': 0.5228949647625063, 'support': 2941135}, '2': {'precision': 0.4721088898384021, 'recall': 0.3617083531698706, 'f1-score': 0.4095998985202326, 'support': 2071094}, 'accuracy': 0.48067622317831554, 'macro avg': {'precision': 0.4834351535857848, 'recall': 0.4797763007787543, 'f1-score': 0.47296411399562804, 'support': 7086477}, 'weighted avg': {'precision': 0.49340596076556215, 'recall': 0.48067622317831554, 'f1-score': 0.47910034447578853, 'support': 7086477}}
[[1225709  522560  325979]
 [ 998008 1431460  511667]
 [ 741983  579979  749132]]
Evaluating performance on  train set...
10532/10532 - 174s - 174s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1798269
{'0': {'precision': 0.4120912591795791, 'recall': 0.6069231335831268, 'f1-score': 0.4908816207500384, 'support': 828151}, '1': {'precision': 0.5470887515289343, 'recall': 0.4394414005104202, 'f1-score': 0.48739199035810443, 'support': 1026997}, '2': {'precision': 0.47472803887001763, 'recall': 0.3677360645207337, 'f1-score': 0.41443812271425656, 'support': 840660}, 'accuracy': 0.46853114168368076, 'macro avg': {'precision': 0.47796934985951034, 'recall': 0.47136686620476026, 'f1-score': 0.46423724460746646, 'support': 2695808}, 'weighted avg': {'precision': 0.48305263879744315, 'recall': 0.46853114168368076, 'f1-score': 0.46571408990125934, 'support': 2695808}}
[[502624 175859 149668]
 [383305 451305 192387]
 [333762 197757 309141]]
Evaluating performance on  val set...
3814/3814 - 63s - 63s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1743438
{'0': {'precision': 0.4148039194375409, 'recall': 0.5926982965682891, 'f1-score': 0.48804572844544025, 'support': 289768}, '1': {'precision': 0.5567122539952087, 'recall': 0.4657688902194292, 'f1-score': 0.5071961476885163, 'support': 394159}, '2': {'precision': 0.47154629222587124, 'recall': 0.37481329734025787, 'f1-score': 0.4176518416441765, 'support': 291908}, 'accuracy': 0.4762516204071385, 'macro avg': {'precision': 0.48102082188620693, 'recall': 0.47776016137599203, 'f1-score': 0.470964572592711, 'support': 975835}, 'weighted avg': {'precision': 0.48909721676425255, 'recall': 0.4762516204071385, 'f1-score': 0.47472356987360004, 'support': 975835}}
[[171745  68027  49996]
 [137953 183587  72619]
 [104341  78156 109411]]
testing model out of sample: results/universal/W3/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 256s - 256s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0188773
{'0': {'precision': 0.45418523716099607, 'recall': 0.5101225765865376, 'f1-score': 0.4805315069007498, 'support': 1154054}, '1': {'precision': 0.5890849606175134, 'recall': 0.6408038971554945, 'f1-score': 0.61385699387979, 'support': 1837648}, '2': {'precision': 0.4855085814539797, 'recall': 0.3568028610338752, 'f1-score': 0.41132256355825536, 'support': 1144761}, 'accuracy': 0.5257474803956907, 'macro avg': {'precision': 0.5095929264108298, 'recall': 0.5025764449253024, 'f1-score': 0.5019036881129317, 'support': 4136463}, 'weighted avg': {'precision': 0.5227839288322627, 'recall': 0.5257474803956907, 'f1-score': 0.5206086489678642, 'support': 4136463}}
[[ 588709  388682  176663]
 [ 403902 1177572  256174]
 [ 303576  432731  408454]]
Evaluating performance on  train set...
6181/6181 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017156
{'0': {'precision': 0.45003352747673264, 'recall': 0.5127745620807316, 'f1-score': 0.479359796570873, 'support': 499978}, '1': {'precision': 0.4940541685273766, 'recall': 0.5567570839350102, 'f1-score': 0.5235348546766426, 'support': 578245}, '2': {'precision': 0.48769946070707293, 'recall': 0.34911550468262226, 'f1-score': 0.40693211856913364, 'support': 503564}, 'accuracy': 0.4767519267764876, 'macro avg': {'precision': 0.4772623855703941, 'recall': 0.47288238356612133, 'f1-score': 0.4699422566055498, 'support': 1581787}, 'weighted avg': {'precision': 0.4781169063295951, 'recall': 0.4767519267764876, 'f1-score': 0.47245117690786076, 'support': 1581787}}
[[256376 156123  87479]
 [159112 321942  97191]
 [154194 173568 175802]]
Evaluating performance on  val set...
2209/2209 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0625812
{'0': {'precision': 0.4636444785934622, 'recall': 0.4858506204414133, 'f1-score': 0.4744878784900293, 'support': 168912}, '1': {'precision': 0.525158756186274, 'recall': 0.6142295487830393, 'f1-score': 0.5662126325940212, 'support': 229424}, '2': {'precision': 0.49262907494890606, 'recall': 0.3534707614640303, 'f1-score': 0.41160621181476525, 'support': 166390}, 'accuracy': 0.49900128557920126, 'macro avg': {'precision': 0.49381076990954736, 'recall': 0.48451697689616097, 'f1-score': 0.4841022409662719, 'support': 564726}, 'weighted avg': {'precision': 0.497175073271298, 'recall': 0.49900128557920126, 'f1-score': 0.49322436214308774, 'support': 564726}}
[[ 82066  61219  25627]
 [ 53558 140919  34947]
 [ 41378  66198  58814]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
678/678 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4041154
{'0': {'precision': 0.36259855675875835, 'recall': 0.703178912339084, 'f1-score': 0.47847072423697107, 'support': 57095}, '1': {'precision': 0.37974889939670636, 'recall': 0.03909292332482879, 'f1-score': 0.0708883105815033, 'support': 59576}, '2': {'precision': 0.3893979057591623, 'recall': 0.3881278538812785, 'f1-score': 0.3887618425351192, 'support': 56721}, 'accuracy': 0.37194334225339115, 'macro avg': {'precision': 0.37724845397154233, 'recall': 0.3767998965150638, 'f1-score': 0.31270695911786456, 'support': 173392}, 'weighted avg': {'precision': 0.3772580259825421, 'recall': 0.37194334225339115, 'f1-score': 0.30908282078727967, 'support': 173392}}
[[40148  1722 15225]
 [37951  2329 19296]
 [32624  2082 22015]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3426932
{'0': {'precision': 0.37324585383634046, 'recall': 0.6414317673378076, 'f1-score': 0.4718971674978193, 'support': 22350}, '1': {'precision': 0.3974468085106383, 'recall': 0.06491520711704198, 'f1-score': 0.11160234197634127, 'support': 21582}, '2': {'precision': 0.39479401516704243, 'recall': 0.43001294816270036, 'f1-score': 0.4116515643699778, 'support': 22397}, 'accuracy': 0.38245714544166204, 'macro avg': {'precision': 0.3884955591713404, 'recall': 0.3787866408725167, 'f1-score': 0.33171702461471275, 'support': 66329}, 'weighted avg': {'precision': 0.38839637884206085, 'recall': 0.38245714544166204, 'f1-score': 0.334322295305282, 'support': 66329}}
[[14336  1100  6914]
 [12331  1401  7850]
 [11742  1024  9631]]
Evaluating performance on  val set...
86/86 - 1s - 877ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3763028
{'0': {'precision': 0.3766742042094277, 'recall': 0.5784693468679044, 'f1-score': 0.45625493810903345, 'support': 7487}, '1': {'precision': 0.3028571428571429, 'recall': 0.0368567454798331, 'f1-score': 0.0657160570365778, 'support': 7190}, '2': {'precision': 0.3734964961824077, 'recall': 0.49207661568141103, 'f1-score': 0.4246640504221667, 'support': 7257}, 'accuracy': 0.37234430564420534, 'macro avg': {'precision': 0.3510092810829928, 'recall': 0.36913423600971623, 'f1-score': 0.3155450151892593, 'support': 21934}, 'weighted avg': {'precision': 0.35142548996327955, 'recall': 0.37234430564420534, 'f1-score': 0.31778363206113763, 'support': 21934}}
[[4331  311 2845]
 [3780  265 3145]
 [3387  299 3571]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79635984
{'0': {'precision': 0.5258504127526331, 'recall': 0.4199511238668978, 'f1-score': 0.46697211470100325, 'support': 70382}, '1': {'precision': 0.7323425758166487, 'recall': 0.8323985210995304, 'f1-score': 0.7791715552808217, 'support': 230171}, '2': {'precision': 0.48914416778432174, 'recall': 0.3661961583236321, 'f1-score': 0.41883378964274715, 'support': 68720}, 'accuracy': 0.6670295418294866, 'macro avg': {'precision': 0.5824457187845345, 'recall': 0.5395152677633535, 'f1-score': 0.554992486541524, 'support': 369273}, 'weighted avg': {'precision': 0.6477278706506793, 'recall': 0.6670295418294866, 'f1-score': 0.6526103599550404, 'support': 369273}}
[[ 29557  33456   7369]
 [ 19664 191594  18913]
 [  6987  36568  25165]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96466386
{'0': {'precision': 0.4939854282845117, 'recall': 0.48184735942645157, 'f1-score': 0.48784090309648154, 'support': 47982}, '1': {'precision': 0.5607776640218411, 'recall': 0.7623486770569047, 'f1-score': 0.646209053538401, 'support': 68975}, '2': {'precision': 0.5815605854322669, 'recall': 0.29010144742985694, 'f1-score': 0.3871031689841692, 'support': 47118}, 'accuracy': 0.5447021179338717, 'macro avg': {'precision': 0.5454412259128733, 'recall': 0.5114324946377377, 'f1-score': 0.5070510418730172, 'support': 164075}, 'weighted avg': {'precision': 0.5472132857549992, 'recall': 0.5447021179338717, 'f1-score': 0.5254876050366154, 'support': 164075}}
[[23120 19413  5449]
 [12006 52583  4386]
 [11677 21772 13669]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9308023
{'0': {'precision': 0.5050718512256974, 'recall': 0.4573287409108305, 'f1-score': 0.4800160674834304, 'support': 18291}, '1': {'precision': 0.5857607355084651, 'recall': 0.7904499652010772, 'f1-score': 0.6728832333015636, 'support': 33047}, '2': {'precision': 0.6104852203011712, 'recall': 0.2913649914821124, 'f1-score': 0.3944646653933475, 'support': 18784}, 'accuracy': 0.5698639513989904, 'macro avg': {'precision': 0.5671059356784446, 'recall': 0.5130478991980066, 'f1-score': 0.5157879887261138, 'support': 70122}, 'weighted avg': {'precision': 0.5713365083034523, 'recall': 0.5698639513989904, 'f1-score': 0.547993074584365, 'support': 70122}}
[[ 8365  8373  1553]
 [ 4986 26122  1939]
 [ 3211 10100  5473]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3157307
{'0': {'precision': 0.41824573551540006, 'recall': 0.5025842067365389, 'f1-score': 0.4565527065527065, 'support': 124990}, '1': {'precision': 0.31919957178737596, 'recall': 0.3835657104406424, 'f1-score': 0.3484349999101091, 'support': 101057}, '2': {'precision': 0.4444152707031455, 'recall': 0.2780360398836999, 'f1-score': 0.3420672372502854, 'support': 121754}, 'accuracy': 0.3893950851205143, 'macro avg': {'precision': 0.3939535260019738, 'recall': 0.38806198568696043, 'f1-score': 0.3823516479043671, 'support': 347801}, 'weighted avg': {'precision': 0.3986280156680904, 'recall': 0.3893950851205143, 'f1-score': 0.3850603448009348, 'support': 347801}}
[[62818 40840 21332]
 [41307 38762 20988]
 [46069 41833 33852]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4405806
{'0': {'precision': 0.3696737899407735, 'recall': 0.5322231429258775, 'f1-score': 0.4363002892453327, 'support': 37411}, '1': {'precision': 0.3398195648328321, 'recall': 0.2563384040565786, 'f1-score': 0.2922339697269339, 'support': 37470}, '2': {'precision': 0.4157581921622223, 'recall': 0.3379404774206882, 'f1-score': 0.3728320816291631, 'support': 38708}, 'accuracy': 0.3750099041280406, 'macro avg': {'precision': 0.37508384897860925, 'recall': 0.3755006748010481, 'f1-score': 0.36712211353380986, 'support': 113589}, 'weighted avg': {'precision': 0.3755299663873773, 'recall': 0.3750099041280406, 'f1-score': 0.3671484138633759, 'support': 113589}}
[[19911  9427  8073]
 [17556  9605 10309]
 [16394  9233 13081]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.375832
{'0': {'precision': 0.39888571997081645, 'recall': 0.47309628697293893, 'f1-score': 0.432833135413293, 'support': 12712}, '1': {'precision': 0.3374762644571034, 'recall': 0.3474320241691843, 'f1-score': 0.34238178633975486, 'support': 11254}, '2': {'precision': 0.4346126866419481, 'recall': 0.34214263174502996, 'f1-score': 0.3828735378503642, 'support': 12676}, 'accuracy': 0.3891981878718411, 'macro avg': {'precision': 0.3903248903566226, 'recall': 0.3875569809623844, 'f1-score': 0.38602948653447067, 'support': 36642}, 'weighted avg': {'precision': 0.3923842467207738, 'recall': 0.3891981878718411, 'f1-score': 0.3877693468323945, 'support': 36642}}
[[6014 3915 2783]
 [4485 3910 2859]
 [4578 3761 4337]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3165178
{'0': {'precision': 0.3205810863212053, 'recall': 0.7202031254979868, 'f1-score': 0.4436721805003354, 'support': 94129}, '1': {'precision': 0.2903901544907044, 'recall': 0.021909418679310514, 'f1-score': 0.04074472091335776, 'support': 101235}, '2': {'precision': 0.3416642529068565, 'recall': 0.2573851061397949, 'f1-score': 0.293596140854085, 'support': 96241}, 'accuracy': 0.3250321496544984, 'macro avg': {'precision': 0.3175451645729221, 'recall': 0.33316588343903075, 'f1-score': 0.25933768075592606, 'support': 291605}, 'weighted avg': {'precision': 0.31705812221396734, 'recall': 0.3250321496544984, 'f1-score': 0.2542590034187268, 'support': 291605}}
[[67792  2783 23554]
 [74841  2218 24176]
 [68833  2637 24771]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2914791
{'0': {'precision': 0.3381671105849857, 'recall': 0.7129783693843594, 'f1-score': 0.45874874539979926, 'support': 33656}, '1': {'precision': 0.28748651564185546, 'recall': 0.03286775814756575, 'f1-score': 0.058991173459505816, 'support': 32433}, '2': {'precision': 0.3328140788144156, 'recall': 0.24450974327250233, 'f1-score': 0.2819086337862416, 'support': 32330}, 'accuracy': 0.3349658094473628, 'macro avg': {'precision': 0.31948923501375226, 'recall': 0.3301186236014758, 'f1-score': 0.2665495175485155, 'support': 98419}, 'weighted avg': {'precision': 0.31970738987116953, 'recall': 0.3349658094473628, 'f1-score': 0.2689218000009855, 'support': 98419}}
[[23996  1421  8239]
 [23759  1066  7608]
 [23204  1221  7905]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3243636
{'0': {'precision': 0.34556198937098437, 'recall': 0.7172964517987981, 'f1-score': 0.46642220497310033, 'support': 12147}, '1': {'precision': 0.30809128630705396, 'recall': 0.024344262295081968, 'f1-score': 0.04512306289881495, 'support': 12200}, '2': {'precision': 0.30936582182095074, 'recall': 0.25798258345428154, 'f1-score': 0.28134738091705, 'support': 11024}, 'accuracy': 0.3351333012920189, 'macro avg': {'precision': 0.32100636583299635, 'recall': 0.3332077658493872, 'f1-score': 0.26429754959632173, 'support': 35371}, 'weighted avg': {'precision': 0.32135659148990886, 'recall': 0.3351333012920189, 'f1-score': 0.2634278199203684, 'support': 35371}}
[[8713  330 3104]
 [8658  297 3245]
 [7843  337 2844]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
2282/2282 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2921258
{'0': {'precision': 0.43486879435237247, 'recall': 0.5560994916108727, 'f1-score': 0.4880687280960208, 'support': 212239}, '1': {'precision': 0.3112399179142444, 'recall': 0.34598056845837594, 'f1-score': 0.32769204843640914, 'support': 157373}, '2': {'precision': 0.48910279694878317, 'recall': 0.31404075882882504, 'f1-score': 0.3824925504143078, 'support': 214383}, 'accuracy': 0.4106182415945342, 'macro avg': {'precision': 0.41173716973846664, 'recall': 0.40537360629935787, 'f1-score': 0.39941777564891257, 'support': 583995}, 'weighted avg': {'precision': 0.42146285938191685, 'recall': 0.4106182415945342, 'f1-score': 0.4060942301842052, 'support': 583995}}
[[118026  58073  36140]
 [ 68740  54448  34185]
 [ 84640  62418  67325]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3912241
{'0': {'precision': 0.393081578028628, 'recall': 0.5434616467559632, 'f1-score': 0.45619840291729274, 'support': 74583}, '1': {'precision': 0.36704706619611466, 'recall': 0.3000161755587308, 'f1-score': 0.3301637690618881, 'support': 74186}, '2': {'precision': 0.4338815196182918, 'recall': 0.348303366941322, 'f1-score': 0.38641092849893766, 'support': 75974}, 'accuracy': 0.3971291653132689, 'macro avg': {'precision': 0.3980033879476781, 'recall': 0.397260396418672, 'f1-score': 0.39092436682603954, 'support': 224743}, 'weighted avg': {'precision': 0.39828013134297496, 'recall': 0.3971291653132689, 'f1-score': 0.39100376313470925, 'support': 224743}}
[[40533 18687 15363]
 [32765 22257 19164]
 [29818 19694 26462]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4043894
{'0': {'precision': 0.39622160539285106, 'recall': 0.548997292099996, 'f1-score': 0.46026288515636565, 'support': 25481}, '1': {'precision': 0.3678003291278113, 'recall': 0.30665447061513834, 'f1-score': 0.33445566778900115, 'support': 26238}, '2': {'precision': 0.4362645528858063, 'recall': 0.3433406113537118, 'f1-score': 0.38426461283354785, 'support': 25648}, 'accuracy': 0.39863249188930683, 'macro avg': {'precision': 0.40009549580215625, 'recall': 0.3996641246896154, 'f1-score': 0.3929943885929716, 'support': 77367}, 'weighted avg': {'precision': 0.39985757513004133, 'recall': 0.39863249188930683, 'f1-score': 0.39240277092393394, 'support': 77367}}
[[13989  6640  4852]
 [11665  8046  6527]
 [ 9652  7190  8806]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
5098/5098 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8174211
{'0': {'precision': 0.5712328022187178, 'recall': 0.495783670849433, 'f1-score': 0.5308407184741101, 'support': 317812}, '1': {'precision': 0.6368833724344075, 'recall': 0.7805450710150681, 'f1-score': 0.7014338952523644, 'support': 675068}, '2': {'precision': 0.5828396940510476, 'recall': 0.37681512413830676, 'f1-score': 0.45771210127607226, 'support': 312031}, 'accuracy': 0.614651114137286, 'macro avg': {'precision': 0.5969852895680576, 'recall': 0.5510479553342692, 'f1-score': 0.5633289050008489, 'support': 1304911}, 'weighted avg': {'precision': 0.60797117686626, 'recall': 0.614651114137286, 'f1-score': 0.6016069233021955, 'support': 1304911}}
[[157566 137095  23151]
 [ 87143 526921  61004]
 [ 31126 163327 117578]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8128455
{'0': {'precision': 0.56700151220566, 'recall': 0.4586905042773132, 'f1-score': 0.5071272962646302, 'support': 114441}, '1': {'precision': 0.6484990076626842, 'recall': 0.7921832916554611, 'f1-score': 0.7131760815950421, 'support': 249133}, '2': {'precision': 0.590455609580407, 'recall': 0.4216816852863255, 'f1-score': 0.49199711896282666, 'support': 116633}, 'accuracy': 0.6227189524517551, 'macro avg': {'precision': 0.6019853764829171, 'recall': 0.5575184937396999, 'f1-score': 0.5707668322741664, 'support': 480207}, 'weighted avg': {'precision': 0.6149792328028268, 'recall': 0.6227189524517551, 'f1-score': 0.6103512685650762, 'support': 480207}}
[[ 52493  51510  10438]
 [ 28099 197359  23675]
 [ 11988  55463  49182]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7913388
{'0': {'precision': 0.5758822329502957, 'recall': 0.47122152057195316, 'f1-score': 0.5183213231131715, 'support': 35947}, '1': {'precision': 0.6552173127916592, 'recall': 0.8063252201780138, 'f1-score': 0.7229597936198326, 'support': 85499}, '2': {'precision': 0.6187607935638768, 'recall': 0.39782267237177055, 'f1-score': 0.4842830533898165, 'support': 36926}, 'accuracy': 0.635017553607961, 'macro avg': {'precision': 0.6166201131019439, 'recall': 0.5584564710405792, 'f1-score': 0.5751880567076069, 'support': 158372}, 'weighted avg': {'precision': 0.6287097764590841, 'recall': 0.635017553607961, 'f1-score': 0.6208614655755034, 'support': 158372}}
[[16939 16758  2250]
 [ 9758 68940  6801]
 [ 2717 19519 14690]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
5760/5760 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8343259
{'0': {'precision': 0.48909760436923333, 'recall': 0.5120847089984745, 'f1-score': 0.500327265196669, 'support': 323177}, '1': {'precision': 0.6843968505943627, 'recall': 0.7721134437423258, 'f1-score': 0.7256138336316661, 'support': 834775}, '2': {'precision': 0.5414273952866111, 'recall': 0.33243186033065947, 'f1-score': 0.4119375404955183, 'support': 316519}, 'accuracy': 0.6207351653576096, 'macro avg': {'precision': 0.571640616750069, 'recall': 0.53887667102382, 'f1-score': 0.5459595464412844, 'support': 1474471}, 'weighted avg': {'precision': 0.6109001365037819, 'recall': 0.6207351653576096, 'f1-score': 0.6088994703418643, 'support': 1474471}}
[[165494 132814  24869]
 [125984 644541  64250]
 [ 46888 164410 105221]]
Evaluating performance on  train set...
2159/2159 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9379308
{'0': {'precision': 0.503233095198538, 'recall': 0.48399240685939265, 'f1-score': 0.4934252538021451, 'support': 156457}, '1': {'precision': 0.5507509674453058, 'recall': 0.7232410901467505, 'f1-score': 0.6253190162698298, 'support': 238500}, '2': {'precision': 0.5643988837376783, 'recall': 0.31829142922415, 'f1-score': 0.40703590992087646, 'support': 157582}, 'accuracy': 0.540005320891376, 'macro avg': {'precision': 0.539460982127174, 'recall': 0.5085083087434311, 'f1-score': 0.5085933933309504, 'support': 552539}, 'weighted avg': {'precision': 0.5411881351512453, 'recall': 0.540005320891376, 'f1-score': 0.5257184616318996, 'support': 552539}}
[[ 75724  64235  16498]
 [ 43794 172493  22213]
 [ 30957  76468  50157]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90495855
{'0': {'precision': 0.5097534911521255, 'recall': 0.4829183754010879, 'f1-score': 0.4959732134989867, 'support': 58279}, '1': {'precision': 0.5825000783625365, 'recall': 0.7356087520163086, 'f1-score': 0.6501620288371972, 'support': 101051}, '2': {'precision': 0.5639302473784833, 'recall': 0.335568387485995, 'f1-score': 0.4207614251596659, 'support': 58015}, 'accuracy': 0.5610711081460351, 'macro avg': {'precision': 0.5520612722977151, 'recall': 0.5180318383011305, 'f1-score': 0.5222988891652832, 'support': 217345}, 'weighted avg': {'precision': 0.5580370030648514, 'recall': 0.5610711081460351, 'f1-score': 0.5475848083285701, 'support': 217345}}
[[28144 24637  5498]
 [17161 74334  9556]
 [ 9906 28641 19468]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
6315/6315 - 47s - 47s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9212996
{'0': {'precision': 0.5269690767762455, 'recall': 0.45164935585967103, 'f1-score': 0.48641071156382737, 'support': 448660}, '1': {'precision': 0.5636756707411322, 'recall': 0.7539412961251668, 'f1-score': 0.6450711799856707, 'support': 720702}, '2': {'precision': 0.5796266300412782, 'recall': 0.34737407175449586, 'f1-score': 0.43440584712552693, 'support': 447080}, 'accuracy': 0.5575875905228892, 'macro avg': {'precision': 0.5567571258528853, 'recall': 0.5176549079131112, 'f1-score': 0.5219625795583417, 'support': 1616442}, 'weighted avg': {'precision': 0.5578991408289072, 'recall': 0.5575875905228892, 'f1-score': 0.5427669446482709, 'support': 1616442}}
[[202637 200957  45066]
 [109767 543367  67568]
 [ 72129 219647 155304]]
Evaluating performance on  train set...
2155/2155 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9542595
{'0': {'precision': 0.5279434621464724, 'recall': 0.4779583761778483, 'f1-score': 0.501708994391721, 'support': 166299}, '1': {'precision': 0.5139326919238293, 'recall': 0.7226416683039097, 'f1-score': 0.6006742333220573, 'support': 213774}, '2': {'precision': 0.5853843165768583, 'recall': 0.34275783236522267, 'f1-score': 0.43235846939863976, 'support': 171468}, 'accuracy': 0.5307638054106585, 'macro avg': {'precision': 0.5424201568823867, 'recall': 0.5144526256156602, 'f1-score': 0.5115805657041393, 'support': 551541}, 'weighted avg': {'precision': 0.5403706978984728, 'recall': 0.5307638054106585, 'f1-score': 0.5185070187771793, 'support': 551541}}
[[ 79484  67144  19671]
 [ 37336 154482  21956]
 [ 33734  78962  58772]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9246249
{'0': {'precision': 0.5246533442088092, 'recall': 0.4825303351400011, 'f1-score': 0.502710993444769, 'support': 53321}, '1': {'precision': 0.5606092010994458, 'recall': 0.7439368572111935, 'f1-score': 0.639391525554385, 'support': 83620}, '2': {'precision': 0.5760187323164981, 'recall': 0.3291397989333432, 'f1-score': 0.4189115678437123, 'support': 53813}, 'accuracy': 0.5538494605617706, 'macro avg': {'precision': 0.5537604258749177, 'recall': 0.5185356637615125, 'f1-score': 0.5203380289476222, 'support': 190754}, 'weighted avg': {'precision': 0.5549056816876253, 'recall': 0.5538494605617706, 'f1-score': 0.5389866553188919, 'support': 190754}}
[[25729 22234  5358]
 [13733 62208  7679]
 [ 9578 26523 17712]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
6082/6082 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9816997
{'0': {'precision': 0.47565512207755517, 'recall': 0.4627731340753585, 'f1-score': 0.4691257112935005, 'support': 436553}, '1': {'precision': 0.5794025947903048, 'recall': 0.6393007693464571, 'f1-score': 0.6078797113572388, 'support': 684867}, '2': {'precision': 0.4788366816681987, 'recall': 0.41397249324734026, 'f1-score': 0.44404833762426243, 'support': 435384}, 'accuracy': 0.5267830760969268, 'macro avg': {'precision': 0.5112981328453529, 'recall': 0.5053487988897186, 'f1-score': 0.5070179200916672, 'support': 1556804}, 'weighted avg': {'precision': 0.5221853343169736, 'recall': 0.5267830760969268, 'f1-score': 0.5231529032226354, 'support': 1556804}}
[[202025 155455  79073]
 [129935 437836 117096]
 [ 92770 162377 180237]]
Evaluating performance on  train set...
2440/2440 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.055752
{'0': {'precision': 0.47274583585975677, 'recall': 0.5069151962213819, 'f1-score': 0.489234623609775, 'support': 209177}, '1': {'precision': 0.4719832237310911, 'recall': 0.5612981642268785, 'f1-score': 0.5127805844828044, 'support': 206507}, '2': {'precision': 0.4911962044135328, 'recall': 0.3637621288349138, 'f1-score': 0.4179819531419739, 'support': 208903}, 'accuracy': 0.4770160121808491, 'macro avg': {'precision': 0.4786417546681269, 'recall': 0.4773251630943914, 'f1-score': 0.4733323870781844, 'support': 624587}, 'weighted avg': {'precision': 0.4786647112112052, 'recall': 0.4770160121808491, 'f1-score': 0.4731880346210058, 'support': 624587}}
[[106035  62459  40683]
 [ 52563 115912  38032]
 [ 65698  67214  75991]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0136954
{'0': {'precision': 0.4942613598228069, 'recall': 0.45349714408880265, 'f1-score': 0.4730025933568314, 'support': 64953}, '1': {'precision': 0.5108189408776977, 'recall': 0.6513245151808438, 'f1-score': 0.5725780191384544, 'support': 83691}, '2': {'precision': 0.498349249961224, 'recall': 0.3581711628499538, 'f1-score': 0.41678943710910354, 'support': 62794}, 'accuracy': 0.5034903848882415, 'macro avg': {'precision': 0.5011431835539096, 'recall': 0.48766427403986673, 'f1-score': 0.4874566832014631, 'support': 211438}, 'weighted avg': {'precision': 0.5020291947882182, 'recall': 0.5034903848882415, 'f1-score': 0.4957218681592321, 'support': 211438}}
[[29456 25777  9720]
 [16261 54510 12920]
 [13879 26424 22491]]
testing model on single stock: results/universal/W3/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
13689/13689 - 116s - 116s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4458884
{'0': {'precision': 0.37687814250332646, 'recall': 0.6718888446685589, 'f1-score': 0.4828912863289651, 'support': 1143265}, '1': {'precision': 0.35369477087831563, 'recall': 0.13777401048964585, 'f1-score': 0.19830332635772424, 'support': 1213959}, '2': {'precision': 0.42946220817546676, 'recall': 0.37186557886422406, 'f1-score': 0.3985939717215062, 'support': 1147022}, 'accuracy': 0.38865336508909476, 'macro avg': {'precision': 0.38667837385236964, 'recall': 0.3938428113408096, 'f1-score': 0.3599295281360652, 'support': 3504246}, 'weighted avg': {'precision': 0.3860588385905484, 'recall': 0.38865336508909476, 'f1-score': 0.3567103647571336, 'support': 3504246}}
[[768147 148213 226905]
 [706959 167252 339748]
 [563078 157406 426538]]
Evaluating performance on  train set...
5475/5475 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4112968
{'0': {'precision': 0.3764853236981301, 'recall': 0.6943897563834743, 'f1-score': 0.48825032362276344, 'support': 465773}, '1': {'precision': 0.37067730127664456, 'recall': 0.09783393345753671, 'f1-score': 0.15480874625298607, 'support': 462682}, '2': {'precision': 0.42699291350383106, 'recall': 0.37939933757617134, 'f1-score': 0.40179163010583246, 'support': 473111}, 'accuracy': 0.39112820944572, 'macro avg': {'precision': 0.3913851794928686, 'recall': 0.3905410091390608, 'f1-score': 0.3482835666605273, 'support': 1401566}, 'weighted avg': {'precision': 0.3916172753083626, 'recall': 0.39112820944572, 'f1-score': 0.34899039947428095, 'support': 1401566}}
[[323428  36547 105798]
 [282335  45266 135081]
 [253309  40304 179498]]
Evaluating performance on  val set...
2036/2036 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4044654
{'0': {'precision': 0.3808041848632029, 'recall': 0.6583540120661876, 'f1-score': 0.4825135646470175, 'support': 170062}, '1': {'precision': 0.38329890823251694, 'recall': 0.1444995077672657, 'f1-score': 0.20987749067951675, 'support': 179793}, '2': {'precision': 0.43080715576073864, 'recall': 0.40079714754232293, 'f1-score': 0.4152606678053721, 'support': 171361}, 'accuracy': 0.396422980108055, 'macro avg': {'precision': 0.39830341628548616, 'recall': 0.40121688912525877, 'f1-score': 0.36921724104396875, 'support': 521216}, 'weighted avg': {'precision': 0.39810429248597673, 'recall': 0.396422980108055, 'f1-score': 0.3663571509864237, 'support': 521216}}
[[111961  20212  37889]
 [100959  25980  52854]
 [ 81092  21588  68681]]
training model: results/universal/W3/deepVOL_L2/h100
Epoch 1/50
10532/10532 - 348s - loss: 3.1711 - accuracy100: 0.4244 - val_loss: 3.3799 - val_accuracy100: 0.4061 - 348s/epoch - 33ms/step
Epoch 2/50
10532/10532 - 340s - loss: 3.1443 - accuracy100: 0.4340 - val_loss: 3.3195 - val_accuracy100: 0.4094 - 340s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 341s - loss: 3.1344 - accuracy100: 0.4371 - val_loss: 3.3567 - val_accuracy100: 0.4103 - 341s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 344s - loss: 3.1275 - accuracy100: 0.4397 - val_loss: 3.3488 - val_accuracy100: 0.4129 - 344s/epoch - 33ms/step
Epoch 5/50
10532/10532 - 343s - loss: 3.1220 - accuracy100: 0.4422 - val_loss: 3.3581 - val_accuracy100: 0.4126 - 343s/epoch - 33ms/step
Epoch 6/50
10532/10532 - 343s - loss: 3.1176 - accuracy100: 0.4436 - val_loss: 3.3625 - val_accuracy100: 0.4156 - 343s/epoch - 33ms/step
Epoch 7/50
10532/10532 - 343s - loss: 3.1138 - accuracy100: 0.4451 - val_loss: 3.3708 - val_accuracy100: 0.4167 - 343s/epoch - 33ms/step
Epoch 8/50
10532/10532 - 335s - loss: 3.1101 - accuracy100: 0.4464 - val_loss: 3.3518 - val_accuracy100: 0.4166 - 335s/epoch - 32ms/step
Epoch 9/50
10532/10532 - 343s - loss: 3.1075 - accuracy100: 0.4475 - val_loss: 3.3545 - val_accuracy100: 0.4169 - 343s/epoch - 33ms/step
Epoch 10/50
10532/10532 - 340s - loss: 3.1049 - accuracy100: 0.4483 - val_loss: 3.3781 - val_accuracy100: 0.4171 - 340s/epoch - 32ms/step
Epoch 11/50
10532/10532 - 338s - loss: 3.1024 - accuracy100: 0.4495 - val_loss: 3.3755 - val_accuracy100: 0.4174 - 338s/epoch - 32ms/step
Epoch 12/50
10532/10532 - 343s - loss: 3.0999 - accuracy100: 0.4502 - val_loss: 3.3791 - val_accuracy100: 0.4178 - 343s/epoch - 33ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 443s - 443s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0950819
{'0': {'precision': 0.4147461017785207, 'recall': 0.47689150773874106, 'f1-score': 0.44365309783872453, 'support': 2348444}, '1': {'precision': 0.42129216752707893, 'recall': 0.4587320566726279, 'f1-score': 0.4392156878306773, 'support': 2412805}, '2': {'precision': 0.43077262447169107, 'recall': 0.3258570772414576, 'f1-score': 0.3710409677234533, 'support': 2325228}, 'accuracy': 0.4211508765215776, 'macro avg': {'precision': 0.4222702979257636, 'recall': 0.42049354721760884, 'f1-score': 0.4179699177976184, 'support': 7086477}, 'weighted avg': {'precision': 0.42223355985920663, 'recall': 0.4211508765215776, 'f1-score': 0.4183166206105986, 'support': 7086477}}
[[1119953  720694  507797]
 [ 812549 1106831  493425]
 [ 767832  799704  757692]]
Evaluating performance on  train set...
10532/10532 - 170s - 170s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103305
{'0': {'precision': 0.3980212713784307, 'recall': 0.48766999510095727, 'f1-score': 0.4383085592223423, 'support': 892011}, '1': {'precision': 0.40810451828611993, 'recall': 0.3937580096336559, 'f1-score': 0.4008029238122013, 'support': 905160}, '2': {'precision': 0.42013641397914314, 'recall': 0.3410809926588823, 'f1-score': 0.3765035951162678, 'support': 898637}, 'accuracy': 0.407272698945919, 'macro avg': {'precision': 0.4087540678812312, 'recall': 0.40750299913116517, 'f1-score': 0.4052050260502705, 'support': 2695808}, 'weighted avg': {'precision': 0.4087788762123953, 'recall': 0.407272698945919, 'f1-score': 0.40511300951062923, 'support': 2695808}}
[[435007 244541 212463]
 [338173 356414 210573]
 [319744 272385 306508]]
Evaluating performance on  val set...
3814/3814 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072377
{'0': {'precision': 0.39715177019188586, 'recall': 0.4696909527622098, 'f1-score': 0.43038624745426485, 'support': 312250}, '1': {'precision': 0.4215066988798594, 'recall': 0.41092182909804126, 'f1-score': 0.41614696723942024, 'support': 350271}, '2': {'precision': 0.4079818015829303, 'recall': 0.3451712978034815, 'f1-score': 0.37395745445995104, 'support': 313314}, 'accuracy': 0.40861621073234716, 'macro avg': {'precision': 0.40888009021822525, 'recall': 0.40859469322124414, 'f1-score': 0.406830223051212, 'support': 975835}, 'weighted avg': {'precision': 0.40937107538356154, 'recall': 0.40861621073234716, 'f1-score': 0.4071573842055043, 'support': 975835}}
[[146661  92116  73473]
 [122879 143934  83458]
 [ 99742 105425 108147]]
testing model out of sample: results/universal/W3/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 259s - 259s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0720756
{'0': {'precision': 0.4217975357044915, 'recall': 0.4382310250286074, 'f1-score': 0.42985727420204745, 'support': 1302110}, '1': {'precision': 0.46763270989375033, 'recall': 0.5412002567065874, 'f1-score': 0.5017340848639354, 'support': 1564432}, '2': {'precision': 0.4225624951827968, 'recall': 0.32378785766988655, 'f1-score': 0.36663908451018196, 'support': 1269921}, 'accuracy': 0.4420397329796012, 'macro avg': {'precision': 0.4373309135936796, 'recall': 0.4344063798016938, 'f1-score': 0.43274348119205497, 'support': 4136463}, 'weighted avg': {'precision': 0.43936748648923185, 'recall': 0.4420397329796012, 'f1-score': 0.43763306622187587, 'support': 4136463}}
[[570625 453055 278430]
 [434301 846671 283460]
 [347915 510821 411185]]
Evaluating performance on  train set...
6181/6181 - 102s - 102s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.109768
{'0': {'precision': 0.40726554267650156, 'recall': 0.43948186332107797, 'f1-score': 0.4227608335004467, 'support': 527660}, '1': {'precision': 0.38888860496849337, 'recall': 0.43650224575371854, 'f1-score': 0.4113221009616165, 'support': 522987}, '2': {'precision': 0.41586579150288694, 'recall': 0.333049666754528, 'f1-score': 0.3698787673495675, 'support': 531140}, 'accuracy': 0.40275839920292683, 'macro avg': {'precision': 0.4040066463826273, 'recall': 0.4030112586097749, 'f1-score': 0.40132056727054355, 'support': 1581787}, 'weighted avg': {'precision': 0.40407739954506117, 'recall': 0.40275839920292683, 'f1-score': 0.4012218468798314, 'support': 1581787}}
[[231897 169946 125817]
 [172047 228285 122655]
 [165456 188788 176896]]
Evaluating performance on  val set...
2209/2209 - 36s - 36s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963186
{'0': {'precision': 0.42070542514989345, 'recall': 0.41909696600254526, 'f1-score': 0.4198996552490806, 'support': 187014}, '1': {'precision': 0.4028683181225554, 'recall': 0.4974243399871217, 'f1-score': 0.44518080968160206, 'support': 195678}, '2': {'precision': 0.4216207919778983, 'recall': 0.3169023369260688, 'f1-score': 0.36183731841332767, 'support': 182034}, 'accuracy': 0.41329600549647083, 'macro avg': {'precision': 0.41506484508344904, 'recall': 0.41114121430524525, 'f1-score': 0.40897259444800343, 'support': 564726}, 'weighted avg': {'precision': 0.41481991333756957, 'recall': 0.41329600549647083, 'f1-score': 0.40994375860803256, 'support': 564726}}
[[78377 69221 39416]
 [58624 97335 39719]
 [49298 75049 57687]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1449804
{'0': {'precision': 0.4022052319522171, 'recall': 0.6982560703045415, 'f1-score': 0.5104082154328328, 'support': 65771}, '1': {'precision': 0.24500258933195235, 'recall': 0.10618336886993604, 'f1-score': 0.14815626712596885, 'support': 44555}, '2': {'precision': 0.4072783779042081, 'recall': 0.25766657152824024, 'f1-score': 0.31564123731365024, 'support': 63066}, 'accuracy': 0.38586555319737936, 'macro avg': {'precision': 0.3514953997294592, 'recall': 0.35403533690090594, 'f1-score': 0.32473523995748393, 'support': 173392}, 'weighted avg': {'precision': 0.36365546772239316, 'recall': 0.38586555319737936, 'f1-score': 0.34648306433660747, 'support': 173392}}
[[45925  6875 12971]
 [29146  4731 10678]
 [39112  7704 16250]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.174337
{'0': {'precision': 0.33723483903169454, 'recall': 0.6159070191431176, 'f1-score': 0.43583293017255287, 'support': 21940}, '1': {'precision': 0.31340244353942986, 'recall': 0.1544989961671838, 'f1-score': 0.20696821515892422, 'support': 21916}, '2': {'precision': 0.37295373665480425, 'recall': 0.2564855604503182, 'f1-score': 0.30394431554524365, 'support': 22473}, 'accuracy': 0.341675586847382, 'macro avg': {'precision': 0.34119700640864287, 'recall': 0.3422971919202065, 'f1-score': 0.31558182029224024, 'support': 66329}, 'weighted avg': {'precision': 0.3414622509733139, 'recall': 0.341675586847382, 'f1-score': 0.315527604737853, 'support': 66329}}
[[13513  3768  4659]
 [13498  3386  5032]
 [13059  3650  5764]]
Evaluating performance on  val set...
86/86 - 1s - 832ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1745976
{'0': {'precision': 0.34882970137207425, 'recall': 0.582401293626196, 'f1-score': 0.436323254757458, 'support': 7421}, '1': {'precision': 0.3150431565967941, 'recall': 0.13628483797839713, 'f1-score': 0.1902634273480406, 'support': 7499}, '2': {'precision': 0.3665079365079365, 'recall': 0.32919874536641003, 'f1-score': 0.34685293675829953, 'support': 7014}, 'accuracy': 0.3489103674660345, 'macro avg': {'precision': 0.3434602648256016, 'recall': 0.3492949589903344, 'f1-score': 0.3244798729545994, 'support': 21934}, 'weighted avg': {'precision': 0.3429315451749881, 'recall': 0.3489103674660345, 'f1-score': 0.32358743565518217, 'support': 21934}}
[[4322 1185 1914]
 [4400 1022 2077]
 [3668 1037 2309]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95239025
{'0': {'precision': 0.5173488580385132, 'recall': 0.30992187835343604, 'f1-score': 0.3876306094099173, 'support': 93188}, '1': {'precision': 0.5814072351440056, 'recall': 0.8586008345823314, 'f1-score': 0.693324916466222, 'support': 185482}, '2': {'precision': 0.5262678639180473, 'recall': 0.22963919517013787, 'f1-score': 0.31975287771442623, 'support': 90603}, 'accuracy': 0.5658198676859667, 'macro avg': {'precision': 0.5416746523668553, 'recall': 0.466053969368635, 'f1-score': 0.4669028011968552, 'support': 369273}, 'weighted avg': {'precision': 0.5517130400718174, 'recall': 0.5658198676859667, 'f1-score': 0.5245235459002942, 'support': 369273}}
[[ 28881  54802   9505]
 [ 17003 159255   9224]
 [  9941  59856  20806]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0566777
{'0': {'precision': 0.4844074384910994, 'recall': 0.3964750542299349, 'f1-score': 0.4360524066084812, 'support': 55320}, '1': {'precision': 0.41877952474722224, 'recall': 0.7590524096608352, 'f1-score': 0.5397639477923529, 'support': 54074}, '2': {'precision': 0.5376214759934571, 'recall': 0.20436714763811928, 'f1-score': 0.2961559357069978, 'support': 54681}, 'accuracy': 0.45194575651378943, 'macro avg': {'precision': 0.4802694797439262, 'recall': 0.4532982038429631, 'f1-score': 0.42399076336927727, 'support': 164075}, 'weighted avg': {'precision': 0.48051307906327684, 'recall': 0.45194575651378943, 'f1-score': 0.42360943207008517, 'support': 164075}}
[[21933 26668  6719]
 [10137 41045  2892]
 [13208 30298 11175]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0512079
{'0': {'precision': 0.49721927138661504, 'recall': 0.3678516943275854, 'f1-score': 0.42286230536217256, 'support': 21631}, '1': {'precision': 0.43439731383883035, 'recall': 0.7921026117957064, 'f1-score': 0.5610880843237902, 'support': 25806}, '2': {'precision': 0.5776582188871584, 'recall': 0.17985452942473, 'f1-score': 0.27430415490116977, 'support': 22685}, 'accuracy': 0.46316419953794813, 'macro avg': {'precision': 0.503091601370868, 'recall': 0.4466029451826739, 'f1-score': 0.41941818152904414, 'support': 70122}, 'weighted avg': {'precision': 0.5001224128767564, 'recall': 0.46316419953794813, 'f1-score': 0.4256718773748883, 'support': 70122}}
[[ 7957 11838  1836]
 [ 4218 20441  1147]
 [ 3828 14777  4080]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2122602
{'0': {'precision': 0.3286188963689513, 'recall': 0.4735044375149916, 'f1-score': 0.3879765096186351, 'support': 104225}, '1': {'precision': 0.4277804233545291, 'recall': 0.31965560307836144, 'f1-score': 0.3658972925485185, 'support': 143323}, '2': {'precision': 0.32763705855711556, 'recall': 0.2958514957158389, 'f1-score': 0.3109340601740224, 'support': 100253}, 'accuracy': 0.35889776050097616, 'macro avg': {'precision': 0.3613454594268653, 'recall': 0.3630038454363973, 'f1-score': 0.35493595411372536, 'support': 347801}, 'weighted avg': {'precision': 0.36919869730685545, 'recall': 0.35889776050097616, 'f1-score': 0.3566706872883052, 'support': 347801}}
[[49351 30294 24580]
 [61222 45814 36287]
 [39604 30989 29660]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2083329
{'0': {'precision': 0.35173935933260436, 'recall': 0.4679939651920901, 'f1-score': 0.4016230463331175, 'support': 37118}, '1': {'precision': 0.3457814661134163, 'recall': 0.26431252312734577, 'f1-score': 0.29960751415645503, 'support': 37834}, '2': {'precision': 0.374004478077261, 'recall': 0.34153790408157986, 'f1-score': 0.357034632034632, 'support': 38637}, 'accuracy': 0.35713845530817245, 'macro avg': {'precision': 0.35717510117442725, 'recall': 0.35794813080033855, 'f1-score': 0.35275506417473484, 'support': 113589}, 'weighted avg': {'precision': 0.3573283376745436, 'recall': 0.35713845530817245, 'f1-score': 0.35247728215152924, 'support': 113589}}
[[17371  9380 10367]
 [16114 10000 11720]
 [15901  9540 13196]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1946799
{'0': {'precision': 0.3735552151510932, 'recall': 0.43311536288043917, 'f1-score': 0.4011364910837788, 'support': 12387}, '1': {'precision': 0.3475823405746321, 'recall': 0.3333053338933221, 'f1-score': 0.3402941554821835, 'support': 11905}, '2': {'precision': 0.37315905743740796, 'recall': 0.3282591093117409, 'f1-score': 0.34927199103988976, 'support': 12350}, 'accuracy': 0.3653457780688827, 'macro avg': {'precision': 0.3647655377210444, 'recall': 0.36489326869516736, 'f1-score': 0.3635675458686174, 'support': 36642}, 'weighted avg': {'precision': 0.36498309519048017, 'recall': 0.3653457780688827, 'f1-score': 0.36388812634170625, 'support': 36642}}
[[5365 3683 3339]
 [4466 3968 3471]
 [4531 3765 4054]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1489751
{'0': {'precision': 0.2997813948955012, 'recall': 0.2305336645537091, 'f1-score': 0.26063639830277646, 'support': 93392}, '1': {'precision': 0.35165383296442937, 'recall': 0.6615383111615041, 'f1-score': 0.45920704008901886, 'support': 102307}, '2': {'precision': 0.33951837212706776, 'recall': 0.09673013158717911, 'f1-score': 0.15056398604235982, 'support': 95906}, 'accuracy': 0.3377411224087378, 'macro avg': {'precision': 0.33031786666233276, 'recall': 0.32960070243413075, 'f1-score': 0.29013580814471834, 'support': 291605}, 'weighted avg': {'precision': 0.331049473494594, 'recall': 0.3377411224087378, 'f1-score': 0.29410140020252984, 'support': 291605}}
[[21530 62972  8890]
 [25470 67680  9157]
 [24819 61810  9277]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1567016
{'0': {'precision': 0.33228466561799896, 'recall': 0.20947143844466481, 'f1-score': 0.2569574993549339, 'support': 33279}, '1': {'precision': 0.329903190599708, 'recall': 0.7147024504084014, 'f1-score': 0.45142895933745164, 'support': 32566}, '2': {'precision': 0.3237044563797358, 'recall': 0.0684595075827347, 'f1-score': 0.11301725667080556, 'support': 32574}, 'accuracy': 0.3299769353478495, 'macro avg': {'precision': 0.32863077086581427, 'recall': 0.33087779881193363, 'f1-score': 0.273801238454397, 'support': 98419}, 'weighted avg': {'precision': 0.32865684120225763, 'recall': 0.3299769353478495, 'f1-score': 0.27366614403327727, 'support': 98419}}
[[ 6971 23923  2385]
 [ 7017 23275  2274]
 [ 6991 23353  2230]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.160457
{'0': {'precision': 0.3139830040834345, 'recall': 0.24223073648361004, 'f1-score': 0.2734788041910987, 'support': 11745}, '1': {'precision': 0.3460858027421495, 'recall': 0.6127642913077526, 'f1-score': 0.4423403052572075, 'support': 12770}, '2': {'precision': 0.28243243243243243, 'recall': 0.09626013264554163, 'f1-score': 0.1435834020335257, 'support': 10856}, 'accuracy': 0.33120352831415567, 'macro avg': {'precision': 0.31416707975267216, 'recall': 0.3170850534789681, 'f1-score': 0.2864675038272773, 'support': 35371}, 'weighted avg': {'precision': 0.3158896432236486, 'recall': 0.33120352831415567, 'f1-score': 0.29457565988620477, 'support': 35371}}
[[2845 7745 1155]
 [3445 7825 1500]
 [2771 7040 1045]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
2282/2282 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.200767
{'0': {'precision': 0.38022507737736577, 'recall': 0.5108921944301964, 'f1-score': 0.43597858621836477, 'support': 198858}, '1': {'precision': 0.32008610386278447, 'recall': 0.2717338758944556, 'f1-score': 0.293934779485706, 'support': 188243}, '2': {'precision': 0.3891433266875171, 'recall': 0.31027862707852955, 'f1-score': 0.3452647046356867, 'support': 196894}, 'accuracy': 0.3661658062140943, 'macro avg': {'precision': 0.3631515026425558, 'recall': 0.3643015658010605, 'f1-score': 0.35839269011325253, 'support': 583995}, 'weighted avg': {'precision': 0.36384687035225016, 'recall': 0.3661658062140943, 'f1-score': 0.3596084609414092, 'support': 583995}}
[[101595  51951  45312]
 [ 86504  51152  50587]
 [ 79098  56704  61092]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.200252
{'0': {'precision': 0.3698089145772055, 'recall': 0.4812881464824928, 'f1-score': 0.41824758935945006, 'support': 74712}, '1': {'precision': 0.34553933845755247, 'recall': 0.26810603623887636, 'f1-score': 0.3019371976666088, 'support': 74616}, '2': {'precision': 0.37910477777458557, 'recall': 0.349943645163429, 'f1-score': 0.3639410049024678, 'support': 75415}, 'accuracy': 0.36643632949635807, 'macro avg': {'precision': 0.3648176769364478, 'recall': 0.3664459426282661, 'f1-score': 0.3613752639761756, 'support': 224743}, 'weighted avg': {'precision': 0.3648706020659655, 'recall': 0.36643632949635807, 'f1-score': 0.36140867890005257, 'support': 224743}}
[[35958 18483 20271]
 [31659 20005 22952]
 [29617 19407 26391]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2055498
{'0': {'precision': 0.36995002709374436, 'recall': 0.489017111022682, 'f1-score': 0.4212312332899157, 'support': 25130}, '1': {'precision': 0.356366118886234, 'recall': 0.2720875684128225, 'f1-score': 0.30857577165055106, 'support': 26859}, '2': {'precision': 0.37902884696726163, 'recall': 0.35310111119867604, 'f1-score': 0.36560587515299875, 'support': 25378}, 'accuracy': 0.36912378662737344, 'macro avg': {'precision': 0.3684483309824133, 'recall': 0.3714019302113935, 'f1-score': 0.36513762669782185, 'support': 77367}, 'weighted avg': {'precision': 0.3682122332049364, 'recall': 0.36912378662737344, 'f1-score': 0.3638750816623436, 'support': 77367}}
[[12289  6266  6575]
 [11445  7308  8106]
 [ 9484  6933  8961]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
5098/5098 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9984555
{'0': {'precision': 0.5213351093453061, 'recall': 0.43648018227833496, 'f1-score': 0.4751489051075793, 'support': 416067}, '1': {'precision': 0.4371039238220325, 'recall': 0.7154045378349273, 'f1-score': 0.5426530754631637, 'support': 483799}, '2': {'precision': 0.5714753998846632, 'recall': 0.23242355787628535, 'f1-score': 0.33045034925760824, 'support': 405045}, 'accuracy': 0.4765528070496762, 'macro avg': {'precision': 0.5099714776840006, 'recall': 0.4614360926631826, 'f1-score': 0.4494174432761171, 'support': 1304911}, 'weighted avg': {'precision': 0.505669757958537, 'recall': 0.4765528070496762, 'f1-score': 0.45526174311692236, 'support': 1304911}}
[[181605 197590  36872]
 [103966 346112  33721]
 [ 62775 248128  94142]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9898635
{'0': {'precision': 0.5251818979307498, 'recall': 0.40471488030540015, 'f1-score': 0.4571452099506659, 'support': 150884}, '1': {'precision': 0.45308469627823916, 'recall': 0.7201953186600284, 'f1-score': 0.5562346124735748, 'support': 177556}, '2': {'precision': 0.5767493665928202, 'recall': 0.310482515961968, 'f1-score': 0.40366131546935763, 'support': 151767}, 'accuracy': 0.49158175536799753, 'macro avg': {'precision': 0.518338653600603, 'recall': 0.47846423830913215, 'f1-score': 0.47234704596453275, 'support': 480207}, 'weighted avg': {'precision': 0.5148216767757547, 'recall': 0.49158175536799753, 'f1-score': 0.4768800904097448, 'support': 480207}}
[[ 61065  70995  18824]
 [ 33925 127875  15756]
 [ 21284  83362  47121]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98667693
{'0': {'precision': 0.5265393868045247, 'recall': 0.42712117752081213, 'f1-score': 0.47164815515284897, 'support': 48169}, '1': {'precision': 0.45001574227359054, 'recall': 0.7267106212687792, 'f1-score': 0.5558322304667164, 'support': 60972}, '2': {'precision': 0.6096846954935932, 'recall': 0.258048790396295, 'f1-score': 0.36261916994919224, 'support': 49231}, 'accuracy': 0.48990351829868917, 'macro avg': {'precision': 0.5287466081905695, 'recall': 0.4706268630619621, 'f1-score': 0.4633665185229192, 'support': 158372}, 'weighted avg': {'precision': 0.5229246508520293, 'recall': 0.48990351829868917, 'f1-score': 0.4701659832378381, 'support': 158372}}
[[20574 23693  3902]
 [12432 44309  4231]
 [ 6068 30459 12704]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
5760/5760 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99196756
{'0': {'precision': 0.4817334499535341, 'recall': 0.4126018353778444, 'f1-score': 0.44449572520239083, 'support': 427160}, '1': {'precision': 0.5155515130002662, 'recall': 0.7644659363794861, 'f1-score': 0.6158065584630672, 'support': 638379}, '2': {'precision': 0.512952504397741, 'recall': 0.20322694237672767, 'f1-score': 0.2911163382940974, 'support': 408932}, 'accuracy': 0.5068746689490672, 'macro avg': {'precision': 0.5034124891171804, 'recall': 0.4600982380446861, 'f1-score': 0.4504728739865185, 'support': 1474471}, 'weighted avg': {'precision': 0.5050334752790158, 'recall': 0.5068746689490672, 'f1-score': 0.4761270689039184, 'support': 1474471}}
[[176247 207413  43500]
 [114951 488019  35409]
 [ 74662 251164  83106]]
Evaluating performance on  train set...
2159/2159 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0490098
{'0': {'precision': 0.4725686024862603, 'recall': 0.3996342466346362, 'f1-score': 0.4330520076336102, 'support': 184824}, '1': {'precision': 0.40441080898409065, 'recall': 0.6814038161460757, 'f1-score': 0.5075766381382942, 'support': 182645}, '2': {'precision': 0.508463659374435, 'recall': 0.24313502998865294, 'f1-score': 0.32896631891390016, 'support': 185070}, 'accuracy': 0.44035624634641174, 'macro avg': {'precision': 0.461814356948262, 'recall': 0.44139103092312165, 'f1-score': 0.4231983215619349, 'support': 552539}, 'weighted avg': {'precision': 0.4620615034110651, 'recall': 0.44035624634641174, 'f1-score': 0.4228236124020903, 'support': 552539}}
[[ 73862  83843  27119]
 [ 41810 124455  16380]
 [ 40627  99446  44997]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0374278
{'0': {'precision': 0.4720648905670932, 'recall': 0.38513870070598305, 'f1-score': 0.4241943464840283, 'support': 70115}, '1': {'precision': 0.4250497518307887, 'recall': 0.6991008474028074, 'f1-score': 0.5286705213622533, 'support': 77295}, '2': {'precision': 0.5059981823689791, 'recall': 0.23883606205762495, 'f1-score': 0.3245033755889067, 'support': 69935}, 'accuracy': 0.44971818997446456, 'macro avg': {'precision': 0.46770427492228706, 'recall': 0.44102520338880513, 'f1-score': 0.4257894144783961, 'support': 217345}, 'weighted avg': {'precision': 0.46626346708618616, 'recall': 0.44971818997446456, 'f1-score': 0.4292719783028513, 'support': 217345}}
[[27004 33570  9541]
 [16492 54037  6766]
 [13708 39524 16703]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
6315/6315 - 53s - 53s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0434197
{'0': {'precision': 0.4680660818252458, 'recall': 0.3976643659861576, 'f1-score': 0.4300026691661649, 'support': 522599}, '1': {'precision': 0.43250588613073154, 'recall': 0.6661555390884245, 'f1-score': 0.5244858609227353, 'support': 584329}, '2': {'precision': 0.4997173793356579, 'recall': 0.26721149958587986, 'f1-score': 0.3482206341979937, 'support': 509514}, 'accuracy': 0.4536017995078079, 'macro avg': {'precision': 0.46676311576387847, 'recall': 0.44367713488682065, 'f1-score': 0.4342363880956313, 'support': 1616442}, 'weighted avg': {'precision': 0.4651881100883943, 'recall': 0.4536017995078079, 'f1-score': 0.43837920057969676, 'support': 1616442}}
[[207819 241158  73622]
 [132395 389254  62680]
 [103781 269585 136148]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0601794
{'0': {'precision': 0.4552740963327156, 'recall': 0.42560772997551594, 'f1-score': 0.4399413607359849, 'support': 182976}, '1': {'precision': 0.4026260406384445, 'recall': 0.5940045062372918, 'f1-score': 0.47994050195921717, 'support': 181970}, '2': {'precision': 0.4922203476071878, 'recall': 0.2955063104584796, 'f1-score': 0.3693012477479589, 'support': 186595}, 'accuracy': 0.4371515444907994, 'macro avg': {'precision': 0.450040161526116, 'recall': 0.4383728488904291, 'f1-score': 0.42972770348105366, 'support': 551541}, 'weighted avg': {'precision': 0.4504034141202847, 'recall': 0.4371515444907994, 'f1-score': 0.4292396211470711, 'support': 551541}}
[[ 77876  73533  31567]
 [ 48563 108091  25316]
 [ 44614  86841  55140]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.048556
{'0': {'precision': 0.4682614606147572, 'recall': 0.40090847369952476, 'f1-score': 0.43197533659624127, 'support': 61862}, '1': {'precision': 0.4177325888695619, 'recall': 0.6511669712676393, 'f1-score': 0.5089601957719351, 'support': 66754}, '2': {'precision': 0.4958645836421309, 'recall': 0.269191155170749, 'f1-score': 0.34894806562985686, 'support': 62138}, 'accuracy': 0.44557912284932427, 'macro avg': {'precision': 0.4606195443754833, 'recall': 0.44042220004597105, 'f1-score': 0.42996119933267773, 'support': 190754}, 'weighted avg': {'precision': 0.4595706785299578, 'recall': 0.44557912284932427, 'f1-score': 0.4318699586020973, 'support': 190754}}
[[24801 27915  9146]
 [15426 43468  7860]
 [12737 32674 16727]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
6082/6082 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0599555
{'0': {'precision': 0.4338443018009112, 'recall': 0.3902263602162436, 'f1-score': 0.41088098532211254, 'support': 506096}, '1': {'precision': 0.44509074914584457, 'recall': 0.46737960329640754, 'f1-score': 0.4559629520233669, 'support': 549932}, '2': {'precision': 0.42160654355213223, 'recall': 0.44125916577471763, 'f1-score': 0.43120905068324067, 'support': 500776}, 'accuracy': 0.4338959817677755, 'macro avg': {'precision': 0.4335138648329626, 'recall': 0.4329550430957896, 'f1-score': 0.43268432934290674, 'support': 1556804}, 'weighted avg': {'precision': 0.4338805335015642, 'recall': 0.4338959817677755, 'f1-score': 0.4333448429247642, 'support': 1556804}}
[[197492 156242 152362]
 [142120 257027 150785]
 [115602 164202 220972]]
Evaluating performance on  train set...
2440/2440 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1065135
{'0': {'precision': 0.40253458364524686, 'recall': 0.43467134780404276, 'f1-score': 0.417986169084892, 'support': 209066}, '1': {'precision': 0.38716548184338373, 'recall': 0.34240882432904807, 'f1-score': 0.3634143262371149, 'support': 205976}, '2': {'precision': 0.40012000092308403, 'recall': 0.4137154310529958, 'f1-score': 0.40680415757490435, 'support': 209545}, 'accuracy': 0.3972144793279399, 'macro avg': {'precision': 0.39660668880390487, 'recall': 0.39693186772869554, 'f1-score': 0.39606821763230377, 'support': 624587}, 'weighted avg': {'precision': 0.3966560913787473, 'recall': 0.3972144793279399, 'f1-score': 0.3962379986870545, 'support': 624587}}
[[90875 54707 63484]
 [68959 70528 66489]
 [65923 56930 86692]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918615
{'0': {'precision': 0.4245391286662696, 'recall': 0.4061088645238393, 'f1-score': 0.41511953294791115, 'support': 71961}, '1': {'precision': 0.3933284733918202, 'recall': 0.4339156960621187, 'f1-score': 0.412626415790931, 'support': 72120}, '2': {'precision': 0.40624058122749407, 'recall': 0.3801980492005285, 'f1-score': 0.3927881223350409, 'support': 67357}, 'accuracy': 0.4073392673029446, 'macro avg': {'precision': 0.4080360610951946, 'recall': 0.40674086992882885, 'f1-score': 0.406844690357961, 'support': 211438}, 'weighted avg': {'precision': 0.408064097128765, 'recall': 0.4073392673029446, 'f1-score': 0.4071551157948331, 'support': 211438}}
[[29224 24485 18252]
 [21648 31294 19178]
 [17965 23783 25609]]
testing model on single stock: results/universal/W3/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
13689/13689 - 101s - 101s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1654391
{'0': {'precision': 0.3822095115471839, 'recall': 0.5562329238602418, 'f1-score': 0.4530858923547837, 'support': 1223198}, '1': {'precision': 0.3088109586471374, 'recall': 0.13706845001551726, 'f1-score': 0.18986406919541782, 'support': 1056888}, '2': {'precision': 0.39636224846733803, 'recall': 0.4063496601751405, 'f1-score': 0.4012938221966581, 'support': 1224160}, 'accuracy': 0.37745238205308645, 'macro avg': {'precision': 0.3624609062205531, 'recall': 0.3665503446836332, 'f1-score': 0.3480812612489532, 'support': 3504246}, 'weighted avg': {'precision': 0.36501641627098225, 'recall': 0.37745238205308645, 'f1-score': 0.35560478890484704, 'support': 3504246}}
[[680383 163908 378907]
 [533360 144866 378662]
 [566388 160335 497437]]
Evaluating performance on  train set...
5475/5475 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1745037
{'0': {'precision': 0.36135082448021016, 'recall': 0.5688571233856953, 'f1-score': 0.4419592221684474, 'support': 469552}, '1': {'precision': 0.3635548800685879, 'recall': 0.1219493065268827, 'f1-score': 0.1826359760962025, 'support': 458994}, '2': {'precision': 0.3750535984736728, 'recall': 0.4031140332332671, 'f1-score': 0.38857789144411725, 'support': 473020}, 'accuracy': 0.36656354392158486, 'macro avg': {'precision': 0.36665310100749027, 'recall': 0.36464015438194836, 'f1-score': 0.3377243632362557, 'support': 1401566}, 'weighted avg': {'precision': 0.36669722589485604, 'recall': 0.36656354392158486, 'f1-score': 0.3390184751277039, 'support': 1401566}}
[[267108  49267 153177]
 [238468  55974 164552]
 [233617  48722 190681]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1697526
{'0': {'precision': 0.3589774130408026, 'recall': 0.5355033966465889, 'f1-score': 0.4298216840894289, 'support': 168843}, '1': {'precision': 0.4008000693200855, 'recall': 0.15085693785366014, 'f1-score': 0.21920675478747143, 'support': 183969}, '2': {'precision': 0.36895367839241183, 'recall': 0.4383981378114534, 'f1-score': 0.4006892715159902, 'support': 168404}, 'accuracy': 0.36836359589882123, 'macro avg': {'precision': 0.3762437202511, 'recall': 0.3749194907705675, 'f1-score': 0.34990590346429684, 'support': 521216}, 'weighted avg': {'precision': 0.3769625003046544, 'recall': 0.36836359589882123, 'f1-score': 0.3460701631542136, 'support': 521216}}
[[90416 20997 57430]
 [87373 27753 68843]
 [74082 20494 73828]]
training model: results/universal/W3/deepVOL_L2/h200
Epoch 1/50
10532/10532 - 345s - loss: 3.2592 - accuracy200: 0.3854 - val_loss: 3.3530 - val_accuracy200: 0.3473 - 345s/epoch - 33ms/step
Epoch 2/50
10532/10532 - 344s - loss: 3.2373 - accuracy200: 0.3955 - val_loss: 3.5262 - val_accuracy200: 0.3506 - 344s/epoch - 33ms/step
Epoch 3/50
10532/10532 - 343s - loss: 3.2307 - accuracy200: 0.3988 - val_loss: 3.4629 - val_accuracy200: 0.3511 - 343s/epoch - 33ms/step
Epoch 4/50
10532/10532 - 342s - loss: 3.2259 - accuracy200: 0.4015 - val_loss: 3.4852 - val_accuracy200: 0.3495 - 342s/epoch - 32ms/step
Epoch 5/50
10532/10532 - 344s - loss: 3.2216 - accuracy200: 0.4042 - val_loss: 3.4897 - val_accuracy200: 0.3516 - 344s/epoch - 33ms/step
Epoch 6/50
10532/10532 - 341s - loss: 3.2187 - accuracy200: 0.4055 - val_loss: 3.4956 - val_accuracy200: 0.3509 - 341s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 346s - loss: 3.2166 - accuracy200: 0.4065 - val_loss: 3.4631 - val_accuracy200: 0.3518 - 346s/epoch - 33ms/step
Epoch 8/50
10532/10532 - 348s - loss: 3.2146 - accuracy200: 0.4075 - val_loss: 3.4641 - val_accuracy200: 0.3521 - 348s/epoch - 33ms/step
Epoch 9/50
10532/10532 - 340s - loss: 3.2128 - accuracy200: 0.4086 - val_loss: 3.4524 - val_accuracy200: 0.3518 - 340s/epoch - 32ms/step
Epoch 10/50
10532/10532 - 345s - loss: 3.2108 - accuracy200: 0.4097 - val_loss: 3.4726 - val_accuracy200: 0.3507 - 345s/epoch - 33ms/step
Epoch 11/50
10532/10532 - 343s - loss: 3.2093 - accuracy200: 0.4106 - val_loss: 3.4506 - val_accuracy200: 0.3520 - 343s/epoch - 33ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 440s - 440s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119875
{'0': {'precision': 0.4022537456299272, 'recall': 0.20579178072057408, 'f1-score': 0.2722839360781206, 'support': 2378992}, '1': {'precision': 0.3339091366461163, 'recall': 0.8105130322457141, 'f1-score': 0.4729683052184437, 'support': 2382053}, '2': {'precision': 0.43008302318923564, 'recall': 0.016150547511172116, 'f1-score': 0.0311320203402166, 'support': 2325432}, 'accuracy': 0.34683228351690126, 'macro avg': {'precision': 0.38874863515509306, 'recall': 0.3441517868258201, 'f1-score': 0.258794753878927, 'support': 7086477}, 'weighted avg': {'precision': 0.38841253958489014, 'recall': 0.34683228351690126, 'f1-score': 0.26060795404157244, 'support': 7086477}}
[[ 489577 1869395   20020]
 [ 421620 1930685   29748]
 [ 305888 1981987   37557]]
Evaluating performance on  train set...
10532/10532 - 168s - 168s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1271254
{'0': {'precision': 0.3951501412131287, 'recall': 0.18419045555734867, 'f1-score': 0.251261123178053, 'support': 904694}, '1': {'precision': 0.3261976868868106, 'recall': 0.8259105606735404, 'f1-score': 0.46768194748642344, 'support': 885114}, '2': {'precision': 0.4439436108422072, 'recall': 0.01619757174392936, 'f1-score': 0.03125479204648072, 'support': 906000}, 'accuracy': 0.3384276625041546, 'macro avg': {'precision': 0.38843047964738214, 'recall': 0.3420995293249394, 'f1-score': 0.2500659542369857, 'support': 2695808}, 'weighted avg': {'precision': 0.38890937808213427, 'recall': 0.3384276625041546, 'f1-score': 0.24837937695639123, 'support': 2695808}}
[[166636 730999   7059]
 [142767 731025  11322]
 [112300 779025  14675]]
Evaluating performance on  val set...
3814/3814 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196166
{'0': {'precision': 0.38743143479159825, 'recall': 0.19780554141155723, 'f1-score': 0.26189761698244285, 'support': 322084}, '1': {'precision': 0.33713711886069014, 'recall': 0.8118561125080933, 'f1-score': 0.47642896968915105, 'support': 332065}, '2': {'precision': 0.4460896944940856, 'recall': 0.016295393644734306, 'f1-score': 0.0314422214691231, 'support': 321686}, 'accuracy': 0.34692442882249563, 'macro avg': {'precision': 0.3902194160487913, 'recall': 0.3419856825214616, 'f1-score': 0.25658960271357234, 'support': 975835}, 'weighted avg': {'precision': 0.3896536946111962, 'recall': 0.34692442882249563, 'f1-score': 0.25892998339218964, 'support': 975835}}
[[ 63710 255862   2512]
 [ 58479 269589   3997]
 [ 42253 274191   5242]]
testing model out of sample: results/universal/W3/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 254s - 254s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1122572
{'0': {'precision': 0.38842307399802267, 'recall': 0.23923829487309917, 'f1-score': 0.29610130086478226, 'support': 1366303}, '1': {'precision': 0.3485915948973645, 'recall': 0.7777515582646505, 'f1-score': 0.4814121795267611, 'support': 1453540}, '2': {'precision': 0.41114129911170205, 'recall': 0.01620589084170072, 'f1-score': 0.031182659769663078, 'support': 1316620}, 'accuracy': 0.35747980823229897, 'macro avg': {'precision': 0.38271865600236304, 'recall': 0.34439858132648343, 'f1-score': 0.2695653800537355, 'support': 4136463}, 'weighted avg': {'precision': 0.3816575405984013, 'recall': 0.35747980823229897, 'f1-score': 0.2768963891640555, 'support': 4136463}}
[[ 326872 1028576   10855]
 [ 303342 1130493   19705]
 [ 211322 1083961   21337]]
Evaluating performance on  train set...
6181/6181 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1258638
{'0': {'precision': 0.3813941169996148, 'recall': 0.2105949875791025, 'f1-score': 0.2713552959371956, 'support': 526532}, '1': {'precision': 0.32798057549427023, 'recall': 0.7955962595125453, 'f1-score': 0.4644811301301535, 'support': 523782}, '2': {'precision': 0.41828119662290764, 'recall': 0.016126877564805738, 'f1-score': 0.031056373241733156, 'support': 531473}, 'accuracy': 0.338967888849763, 'macro avg': {'precision': 0.37588529637226425, 'recall': 0.3407727082188179, 'f1-score': 0.2556309331030274, 'support': 1581787}, 'weighted avg': {'precision': 0.3761010119683293, 'recall': 0.338967888849763, 'f1-score': 0.2545663391076922, 'support': 1581787}}
[[110885 410977   4670]
 [ 99813 416719   7250]
 [ 80038 442864   8571]]
Evaluating performance on  val set...
2209/2209 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201303
{'0': {'precision': 0.39625034123832087, 'recall': 0.23367660118092448, 'f1-score': 0.2939846725772415, 'support': 192561}, '1': {'precision': 0.3289759465037265, 'recall': 0.7798185226526242, 'f1-score': 0.4627395675701372, 'support': 187241}, '2': {'precision': 0.4105119453924915, 'recall': 0.01626073413943025, 'f1-score': 0.03128234737241806, 'support': 184924}, 'accuracy': 0.3435613022952724, 'macro avg': {'precision': 0.3785794110448463, 'recall': 0.3432519526576596, 'f1-score': 0.2626688625065989, 'support': 564726}, 'weighted avg': {'precision': 0.37861486481631385, 'recall': 0.3435613022952724, 'f1-score': 0.2639132228957818, 'support': 564726}}
[[ 44997 145907   1657]
 [ 38566 146014   2661]
 [ 29994 151923   3007]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221522
{'0': {'precision': 0.28435468895078925, 'recall': 0.10849541219399865, 'f1-score': 0.15706336384850114, 'support': 56454}, '1': {'precision': 0.3645023418043454, 'recall': 0.8643035040177942, 'f1-score': 0.5127590372641947, 'support': 63841}, '2': {'precision': 0.39112050739957716, 'recall': 0.003484189313897207, 'f1-score': 0.006906850849355982, 'support': 53097}, 'accuracy': 0.3546184368367629, 'macro avg': {'precision': 0.3466591793849039, 'recall': 0.3254277018418967, 'f1-score': 0.22557641732068393, 'support': 173392}, 'weighted avg': {'precision': 0.34655854476881526, 'recall': 0.3546184368367629, 'f1-score': 0.2420448342497635, 'support': 173392}}
[[ 6125 50237    92]
 [ 8467 55178   196]
 [ 6948 45964   185]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1411998
{'0': {'precision': 0.3110851467796115, 'recall': 0.0971095103492295, 'f1-score': 0.1480143149994788, 'support': 21934}, '1': {'precision': 0.32948132675235414, 'recall': 0.8922901459854015, 'f1-score': 0.4812568433743833, 'support': 21920}, '2': {'precision': 0.3445378151260504, 'recall': 0.0018242491657397108, 'f1-score': 0.0036292821102947687, 'support': 22475}, 'accuracy': 0.3276093413137542, 'macro avg': {'precision': 0.32836809621933866, 'recall': 0.3304079685001236, 'f1-score': 0.210966813494719, 'support': 66329}, 'weighted avg': {'precision': 0.3284997465186206, 'recall': 0.3276093413137542, 'f1-score': 0.20921865409389445, 'support': 66329}}
[[ 2130 19762    42]
 [ 2325 19559    36]
 [ 2392 20042    41]]
Evaluating performance on  val set...
86/86 - 1s - 857ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1383643
{'0': {'precision': 0.35724233983286907, 'recall': 0.0660741885625966, 'f1-score': 0.11152173913043478, 'support': 7764}, '1': {'precision': 0.32935829138360784, 'recall': 0.9309296864207763, 'f1-score': 0.4865703971119134, 'support': 7239}, '2': {'precision': 0.32432432432432434, 'recall': 0.0017313518972731207, 'f1-score': 0.0034443168771526975, 'support': 6931}, 'accuracy': 0.33117534421446154, 'macro avg': {'precision': 0.3369749851802671, 'recall': 0.3329117422935487, 'f1-score': 0.20051215103983364, 'support': 21934}, 'weighted avg': {'precision': 0.33763773546458575, 'recall': 0.33117534421446154, 'f1-score': 0.2011493775680397, 'support': 21934}}
[[ 513 7239   12]
 [ 487 6739   13]
 [ 436 6483   12]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0789582
{'0': {'precision': 0.3877568845688332, 'recall': 0.27187150055991044, 'f1-score': 0.3196346562302324, 'support': 114304}, '1': {'precision': 0.39547669669538027, 'recall': 0.7372245376045327, 'f1-score': 0.5147961634116534, 'support': 146844}, '2': {'precision': 0.4365904365904366, 'recall': 0.06215028901734104, 'f1-score': 0.10881093290802077, 'support': 108125}, 'accuracy': 0.39551497130848995, 'macro avg': {'precision': 0.40660800595155006, 'recall': 0.35708210906059473, 'f1-score': 0.3144139175166355, 'support': 369273}, 'weighted avg': {'precision': 0.4051254327817991, 'recall': 0.39551497130848995, 'f1-score': 0.3355117479112772, 'support': 369273}}
[[ 31076  80212   3016]
 [ 32931 108257   5656]
 [ 16136  85269   6720]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109793
{'0': {'precision': 0.40080758846438724, 'recall': 0.302683098464481, 'f1-score': 0.3449020293192426, 'support': 55421}, '1': {'precision': 0.3314117128420767, 'recall': 0.7162592986184909, 'f1-score': 0.4531512629394786, 'support': 54578}, '2': {'precision': 0.43670886075949367, 'recall': 0.03445151268584955, 'f1-score': 0.06386479723012581, 'support': 54076}, 'accuracy': 0.3518512875209508, 'macro avg': {'precision': 0.3896427206886526, 'recall': 0.3511313032562738, 'f1-score': 0.2873060298296157, 'support': 164075}, 'weighted avg': {'precision': 0.38955608214664056, 'recall': 0.3518512875209508, 'f1-score': 0.28828558750954675, 'support': 164075}}
[[16775 37661   985]
 [14068 39092  1418]
 [11010 41203  1863]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955745
{'0': {'precision': 0.38874734607218686, 'recall': 0.3345361531082995, 'f1-score': 0.35961014410919895, 'support': 21893}, '1': {'precision': 0.35638892843342623, 'recall': 0.7019708380067297, 'f1-score': 0.4727591555945236, 'support': 24964}, '2': {'precision': 0.50734249171009, 'recall': 0.046034816247582204, 'f1-score': 0.08441046658259772, 'support': 23265}, 'accuracy': 0.3696272211288896, 'macro avg': {'precision': 0.4174929220719011, 'recall': 0.3608472691208704, 'f1-score': 0.3055932554287734, 'support': 70122}, 'weighted avg': {'precision': 0.4165748542056085, 'recall': 0.3696272211288896, 'f1-score': 0.30858666253513184, 'support': 70122}}
[[ 7324 14188   381]
 [ 6781 17524   659]
 [ 4735 17459  1071]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920086
{'0': {'precision': 0.2885889719739802, 'recall': 0.1920113257154414, 'f1-score': 0.23059640770921636, 'support': 98890}, '1': {'precision': 0.42906722637644323, 'recall': 0.7732168113459716, 'f1-score': 0.5518862136111157, 'support': 154134}, '2': {'precision': 0.2267798208392268, 'recall': 0.010150141912067274, 'f1-score': 0.019430614326543392, 'support': 94777}, 'accuracy': 0.40002472678341927, 'macro avg': {'precision': 0.3148120063965501, 'recall': 0.32512609299116013, 'f1-score': 0.26730441188229176, 'support': 347801}, 'weighted avg': {'precision': 0.3340011166974592, 'recall': 0.40002472678341927, 'f1-score': 0.3154380917281058, 'support': 347801}}
[[ 18988  79042    860]
 [ 32535 119179   2420]
 [ 14273  79542    962]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1412479
{'0': {'precision': 0.3337465564738292, 'recall': 0.1301918220407286, 'f1-score': 0.18731398090526072, 'support': 37222}, '1': {'precision': 0.32274452197331377, 'recall': 0.841413792186378, 'f1-score': 0.4665373924455684, 'support': 37601}, '2': {'precision': 0.3227665706051873, 'recall': 0.00866738894907909, 'f1-score': 0.016881453010777, 'support': 38766}, 'accuracy': 0.32415110618105625, 'macro avg': {'precision': 0.32641921635077675, 'recall': 0.3267576677253952, 'f1-score': 0.22357760878720204, 'support': 113589}, 'weighted avg': {'precision': 0.3263573054773625, 'recall': 0.32415110618105625, 'f1-score': 0.22157867309349685, 'support': 113589}}
[[ 4846 32098   278]
 [ 5536 31638   427]
 [ 4138 34292   336]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1351886
{'0': {'precision': 0.3700862895493768, 'recall': 0.1555698855392552, 'f1-score': 0.21905680721865955, 'support': 12406}, '1': {'precision': 0.32567348263550794, 'recall': 0.8236742735183057, 'f1-score': 0.46678451804986976, 'support': 12182}, '2': {'precision': 0.28363047001620745, 'recall': 0.014518002322880372, 'f1-score': 0.02762212927156499, 'support': 12054}, 'accuracy': 0.33128650182850283, 'macro avg': {'precision': 0.3264634140670307, 'recall': 0.33125405379348044, 'f1-score': 0.2378211515133648, 'support': 36642}, 'weighted avg': {'precision': 0.32687971615061107, 'recall': 0.33128650182850283, 'f1-score': 0.23844072090709156, 'support': 36642}}
[[ 1930 10333   143]
 [ 1849 10034   299]
 [ 1436 10443   175]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1194454
{'0': {'precision': 0.29413476932033183, 'recall': 0.044426370051218925, 'f1-score': 0.07719338451548834, 'support': 90982}, '1': {'precision': 0.36435548392458994, 'recall': 0.9457733003151734, 'f1-score': 0.5260516258624962, 'support': 106608}, '2': {'precision': 0.3609154929577465, 'recall': 0.004361006222411317, 'f1-score': 0.008617881052222257, 'support': 94015}, 'accuracy': 0.36103290409972394, 'macro avg': {'precision': 0.3398019154008894, 'recall': 0.3315202255296012, 'f1-score': 0.20395429714340227, 'support': 291605}, 'weighted avg': {'precision': 0.3413372510174985, 'recall': 0.36103290409972394, 'f1-score': 0.21918255971969558, 'support': 291605}}
[[  4042  86564    376]
 [  5431 100827    350]
 [  4269  89336    410]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1311246
{'0': {'precision': 0.33279417711281845, 'recall': 0.05023499969480559, 'f1-score': 0.08729316928298685, 'support': 32766}, '1': {'precision': 0.32939367216570237, 'recall': 0.943679329574514, 'f1-score': 0.4883333466195802, 'support': 32457}, '2': {'precision': 0.33880903490759756, 'recall': 0.0049704783708880585, 'f1-score': 0.009797227087848468, 'support': 33196}, 'accuracy': 0.32961115231814997, 'macro avg': {'precision': 0.3336656280620394, 'recall': 0.33296160254673585, 'f1-score': 0.19514124766347185, 'support': 98419}, 'weighted avg': {'precision': 0.3337015123863626, 'recall': 0.32961115231814997, 'f1-score': 0.19341094876361556, 'support': 98419}}
[[ 1646 30944   176]
 [ 1682 30629   146]
 [ 1618 31413   165]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096127
{'0': {'precision': 0.30557256582976117, 'recall': 0.043413955107012354, 'f1-score': 0.07602651024605774, 'support': 11494}, '1': {'precision': 0.3732578916021441, 'recall': 0.9499052671466465, 'f1-score': 0.5359273115980759, 'support': 13195}, '2': {'precision': 0.2848101265822785, 'recall': 0.004212694252012731, 'f1-score': 0.008302583025830259, 'support': 10682}, 'accuracy': 0.369737920895649, 'macro avg': {'precision': 0.3212135280047279, 'recall': 0.33251063883522386, 'f1-score': 0.20675213495665468, 'support': 35371}, 'weighted avg': {'precision': 0.3245520546065835, 'recall': 0.369737920895649, 'f1-score': 0.22713798810287295, 'support': 35371}}
[[  499 10945    50]
 [  598 12534    63]
 [  536 10101    45]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1501226
{'0': {'precision': 0.4076091285646009, 'recall': 0.19261841913338887, 'f1-score': 0.26161087164215346, 'support': 212529}, '1': {'precision': 0.2811946953745127, 'recall': 0.8122051493505706, 'f1-score': 0.4177571099082577, 'support': 164914}, '2': {'precision': 0.3900885935769657, 'recall': 0.013643053565203919, 'f1-score': 0.026364044607439564, 'support': 206552}, 'accuracy': 0.3042817147407084, 'macro avg': {'precision': 0.35963080583869306, 'recall': 0.3394888740163878, 'f1-score': 0.2352440087192836, 'support': 583995}, 'weighted avg': {'precision': 0.3657142298447896, 'recall': 0.3042817147407084, 'f1-score': 0.22250094453617153, 'support': 583995}}
[[ 40937 169416   2176]
 [ 28740 133944   2230]
 [ 30755 172979   2818]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1382079
{'0': {'precision': 0.34586897701494984, 'recall': 0.16932484144611845, 'f1-score': 0.2273482623263, 'support': 74738}, '1': {'precision': 0.31843361677821247, 'recall': 0.7994723669079348, 'f1-score': 0.4554566860252266, 'support': 73915}, '2': {'precision': 0.3806201550387597, 'recall': 0.012905769483506375, 'f1-score': 0.024965043854073984, 'support': 76090}, 'accuracy': 0.3236140836422047, 'macro avg': {'precision': 0.34830758294397396, 'recall': 0.3272343259458532, 'f1-score': 0.2359233307352002, 'support': 224743}, 'weighted avg': {'precision': 0.34861136491549954, 'recall': 0.3236140836422047, 'f1-score': 0.23385033377748862, 'support': 224743}}
[[12655 61472   611]
 [13835 59093   987]
 [10099 65009   982]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1380645
{'0': {'precision': 0.3627188140671818, 'recall': 0.17534497217351527, 'f1-score': 0.2364066193853428, 'support': 26234}, '1': {'precision': 0.31631448935601114, 'recall': 0.8064179703168873, 'f1-score': 0.4543944308203465, 'support': 24930}, '2': {'precision': 0.3776595744680851, 'recall': 0.01625768041827272, 'f1-score': 0.0311733928506092, 'support': 26203}, 'accuracy': 0.3248154898083162, 'macro avg': {'precision': 0.3522309592970927, 'recall': 0.3326735409695584, 'f1-score': 0.2406581476854328, 'support': 77367}, 'weighted avg': {'precision': 0.35282613281723524, 'recall': 0.3248154898083162, 'f1-score': 0.23713961800471559, 'support': 77367}}
[[ 4600 21357   277]
 [ 4401 20104   425]
 [ 3681 22096   426]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
5098/5098 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094511
{'0': {'precision': 0.4262388702852841, 'recall': 0.36829438429567624, 'f1-score': 0.395153711665337, 'support': 445839}, '1': {'precision': 0.3278682792636614, 'recall': 0.6610955452254678, 'f1-score': 0.43834213845772213, 'support': 439708}, '2': {'precision': 0.4609710381522462, 'recall': 0.03635982106237064, 'f1-score': 0.06740311465336994, 'support': 419364}, 'accuracy': 0.3602828085593577, 'macro avg': {'precision': 0.4050260625670639, 'recall': 0.3552499168611715, 'f1-score': 0.30029965492547633, 'support': 1304911}, 'weighted avg': {'precision': 0.4042535279963656, 'recall': 0.3602828085593577, 'f1-score': 0.3043762528215534, 'support': 1304911}}
[[164200 275246   6393]
 [137582 290689  11437]
 [ 83448 320668  15248]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042835
{'0': {'precision': 0.42668246552804173, 'recall': 0.3469447870832336, 'f1-score': 0.38270434929768155, 'support': 162951}, '1': {'precision': 0.31185377551758214, 'recall': 0.6696099930783312, 'f1-score': 0.42552850374603046, 'support': 154587}, '2': {'precision': 0.46692015209125476, 'recall': 0.045294432251996385, 'f1-score': 0.08257821562463225, 'support': 162669}, 'accuracy': 0.34863298535839754, 'macro avg': {'precision': 0.4018187977122929, 'recall': 0.3539497374711871, 'f1-score': 0.29693702288944807, 'support': 480207}, 'weighted avg': {'precision': 0.4033475319117146, 'recall': 0.34863298535839754, 'f1-score': 0.29482316373654993, 'support': 480207}}
[[ 56535 103611   2805]
 [ 45467 103513   5607]
 [ 30497 124804   7368]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903778
{'0': {'precision': 0.4170268286716138, 'recall': 0.39678013771700127, 'f1-score': 0.4066516246384446, 'support': 51555}, '1': {'precision': 0.3313826943638308, 'recall': 0.6394466344913974, 'f1-score': 0.4365371797935085, 'support': 54286}, '2': {'precision': 0.4956217162872154, 'recall': 0.04309836096780948, 'f1-score': 0.07930086341266922, 'support': 52531}, 'accuracy': 0.3626461748288839, 'macro avg': {'precision': 0.41467707977422, 'recall': 0.35977504439206937, 'f1-score': 0.3074965559482074, 'support': 158372}, 'weighted avg': {'precision': 0.41373957187308164, 'recall': 0.3626461748288839, 'f1-score': 0.30831545668701754, 'support': 158372}}
[[20456 30351   748]
 [18017 34713  1556]
 [10579 39688  2264]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
5760/5760 - 53s - 53s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000826
{'0': {'precision': 0.40054030340114066, 'recall': 0.31987174233732174, 'f1-score': 0.3556895681662587, 'support': 488080}, '1': {'precision': 0.3539450066580404, 'recall': 0.7130335965942399, 'f1-score': 0.4730641839015067, 'support': 527107}, '2': {'precision': 0.44008590462833097, 'recall': 0.02186228999921617, 'f1-score': 0.041655258245177344, 'support': 459284}, 'accuracy': 0.36759556478221683, 'macro avg': {'precision': 0.39819040489583735, 'recall': 0.35158920964359264, 'f1-score': 0.2901363367709809, 'support': 1474471}, 'weighted avg': {'precision': 0.39620108942790117, 'recall': 0.36759556478221683, 'f1-score': 0.29983092298338665, 'support': 1474471}}
[[156123 328005   3952]
 [142439 375845   8823]
 [ 91219 358024  10041]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109371
{'0': {'precision': 0.40146262558759427, 'recall': 0.2866632323834829, 'f1-score': 0.3344869912937842, 'support': 184415}, '1': {'precision': 0.3334221618079936, 'recall': 0.73962655039075, 'f1-score': 0.45963968002264854, 'support': 184389}, '2': {'precision': 0.4308537616229924, 'recall': 0.02774104008490489, 'f1-score': 0.0521258916472784, 'support': 183735}, 'accuracy': 0.35172358874215215, 'macro avg': {'precision': 0.38857951633952675, 'recall': 0.35134360761971256, 'f1-score': 0.2820841876545704, 'support': 552539}, 'weighted avg': {'precision': 0.3885300856286178, 'recall': 0.35172358874215215, 'f1-score': 0.2823588383099691, 'support': 552539}}
[[ 52865 128892   2658]
 [ 43935 136379   4075]
 [ 34881 143757   5097]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155922
{'0': {'precision': 0.40073187842475494, 'recall': 0.2857780301801071, 'f1-score': 0.3336306305595239, 'support': 73956}, '1': {'precision': 0.31920149843498175, 'recall': 0.7277680040860337, 'f1-score': 0.4437658152561801, 'support': 70484}, '2': {'precision': 0.4468357673584422, 'recall': 0.023921541732391468, 'f1-score': 0.04541193625663994, 'support': 72905}, 'accuracy': 0.3412776921484276, 'macro avg': {'precision': 0.3889230480727263, 'recall': 0.34582252533284413, 'f1-score': 0.27426946069078134, 'support': 217345}, 'weighted avg': {'precision': 0.38975677763803934, 'recall': 0.3412776921484276, 'f1-score': 0.2726684940944907, 'support': 217345}}
[[21135 51997   824]
 [17853 51296  1335]
 [13753 57408  1744]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
6315/6315 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130619
{'0': {'precision': 0.4175418699313302, 'recall': 0.2879229934149442, 'f1-score': 0.34082464290696346, 'support': 560056}, '1': {'precision': 0.32171921022859407, 'recall': 0.7479762869121996, 'f1-score': 0.44991932926391714, 'support': 519713}, '2': {'precision': 0.44507221943773634, 'recall': 0.018201027441291064, 'f1-score': 0.0349718950270309, 'support': 536673}, 'accuracy': 0.3462877109107534, 'macro avg': {'precision': 0.39477776653255353, 'recall': 0.351366769256145, 'f1-score': 0.27523862239930386, 'support': 1616442}, 'weighted avg': {'precision': 0.3958736092195716, 'recall': 0.3462877109107534, 'f1-score': 0.274354590141485, 'support': 1616442}}
[[161253 393534   5269]
 [124070 388733   6910]
 [100873 426032   9768]]
Evaluating performance on  train set...
2155/2155 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1122524
{'0': {'precision': 0.40349037987173164, 'recall': 0.28619543347038756, 'f1-score': 0.334868724090281, 'support': 182896}, '1': {'precision': 0.33345900003141665, 'recall': 0.7572745732945503, 'f1-score': 0.4630278706650806, 'support': 182210}, '2': {'precision': 0.4649625935162095, 'recall': 0.020001609139914715, 'f1-score': 0.0383533465326168, 'support': 186435}, 'accuracy': 0.35184328998206843, 'macro avg': {'precision': 0.40063732447311934, 'recall': 0.35449053863495084, 'f1-score': 0.27874998042932614, 'support': 551541}, 'weighted avg': {'precision': 0.40113362748179954, 'recall': 0.35184328998206843, 'f1-score': 0.2769782566226423, 'support': 551541}}
[[ 52344 128712   1840]
 [ 41776 137983   2451]
 [ 35608 147098   3729]]
Evaluating performance on  val set...
746/746 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1068581
{'0': {'precision': 0.40990760325058445, 'recall': 0.2901106173773282, 'f1-score': 0.33975843583048065, 'support': 63462}, '1': {'precision': 0.34019381504066465, 'recall': 0.7551166630323043, 'f1-score': 0.46906520761069903, 'support': 64202}, '2': {'precision': 0.4384753901560624, 'recall': 0.02315739419876367, 'f1-score': 0.04399144861642227, 'support': 63090}, 'accuracy': 0.3583253824297262, 'macro avg': {'precision': 0.3961922694824372, 'recall': 0.35612822486946544, 'f1-score': 0.284271697352534, 'support': 190754}, 'weighted avg': {'precision': 0.39589257365861436, 'recall': 0.3583253824297262, 'f1-score': 0.28545715847062786, 'support': 190754}}
[[18411 44263   788]
 [14639 48480  1083]
 [11865 49764  1461]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
6082/6082 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1129179
{'0': {'precision': 0.3985439484513836, 'recall': 0.2062721661604781, 'f1-score': 0.27184633997384083, 'support': 510350}, '1': {'precision': 0.350280868697119, 'recall': 0.8217568402925982, 'f1-score': 0.4911884620565845, 'support': 543544}, '2': {'precision': 0.4373643941989266, 'recall': 0.015231353522499056, 'f1-score': 0.029437535547937838, 'support': 502910}, 'accuracy': 0.35944923060321016, 'macro avg': {'precision': 0.39539640378247637, 'recall': 0.3477534533251918, 'f1-score': 0.2641574458594544, 'support': 1556804}, 'weighted avg': {'precision': 0.3942338894773219, 'recall': 0.35944923060321016, 'f1-score': 0.2701199072125632, 'support': 1556804}}
[[105271 401407   3672]
 [ 90701 446661   6182]
 [ 68167 427083   7660]]
Evaluating performance on  train set...
2440/2440 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1314759
{'0': {'precision': 0.38051521506865577, 'recall': 0.18472503037608717, 'f1-score': 0.24871082775365574, 'support': 208223}, '1': {'precision': 0.3279737186086594, 'recall': 0.8259879489407983, 'f1-score': 0.4695170502766159, 'support': 205957}, '2': {'precision': 0.42358078602620086, 'recall': 0.009681236840979626, 'f1-score': 0.018929819344286673, 'support': 210407}, 'accuracy': 0.3372132305027162, 'macro avg': {'precision': 0.3773565732345054, 'recall': 0.340131405385955, 'f1-score': 0.24571923245818614, 'support': 624587}, 'weighted avg': {'precision': 0.37769736679780275, 'recall': 0.3372132305027162, 'f1-score': 0.24411427761055507, 'support': 624587}}
[[ 38464 168735   1024]
 [ 34091 170118   1748]
 [ 28529 179841   2037]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136445
{'0': {'precision': 0.4093465614212953, 'recall': 0.23487209318430494, 'f1-score': 0.2984827683317492, 'support': 72201}, '1': {'precision': 0.3453003231324843, 'recall': 0.8028616413004447, 'f1-score': 0.4829081484312047, 'support': 72406}, '2': {'precision': 0.4141048824593128, 'recall': 0.01027966063653095, 'f1-score': 0.020061322820849756, 'support': 66831}, 'accuracy': 0.35838874752882643, 'macro avg': {'precision': 0.3895839223376975, 'recall': 0.3493377983737602, 'f1-score': 0.2671507465279345, 'support': 211438}, 'weighted avg': {'precision': 0.38891821563554296, 'recall': 0.35838874752882643, 'f1-score': 0.27363539201596043, 'support': 211438}}
[[16958 54867   376]
 [13678 58132   596]
 [10791 55353   687]]
testing model on single stock: results/universal/W3/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
13689/13689 - 106s - 106s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1368301
{'0': {'precision': 0.3670543429996243, 'recall': 0.11042454643773693, 'f1-score': 0.16977424652845208, 'support': 1167811}, '1': {'precision': 0.33230466283523563, 'recall': 0.8917078636309208, 'f1-score': 0.4841758961844979, 'support': 1169180}, '2': {'precision': 0.35324023424930817, 'recall': 0.004702485746473564, 'f1-score': 0.009281413331484602, 'support': 1167255}, 'accuracy': 0.3358813850397489, 'macro avg': {'precision': 0.3508664133613894, 'recall': 0.33561163193837706, 'f1-score': 0.22107718534814483, 'support': 3504246}, 'weighted avg': {'precision': 0.35085878522087527, 'recall': 0.3358813850397489, 'f1-score': 0.22121357434149075, 'support': 3504246}}
[[ 128955 1034128    4728]
 [ 121291 1042567    5322]
 [ 101078 1060688    5489]]
Evaluating performance on  train set...
5475/5475 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1424308
{'0': {'precision': 0.34800247480996993, 'recall': 0.08365486763268601, 'f1-score': 0.1348852346694073, 'support': 470660}, '1': {'precision': 0.32689600289045245, 'recall': 0.9100918743848665, 'f1-score': 0.4810158635585015, 'support': 461282}, '2': {'precision': 0.3242020009528347, 'recall': 0.002898063131356149, 'f1-score': 0.005744773353706666, 'support': 469624}, 'accuracy': 0.3285917323907686, 'macro avg': {'precision': 0.333033492884419, 'recall': 0.33221493504963623, 'f1-score': 0.2072152905272052, 'support': 1401566}, 'weighted avg': {'precision': 0.33308108736573816, 'recall': 0.3285917323907686, 'f1-score': 0.2055321886839129, 'support': 1401566}}
[[ 39373 430000   1287]
 [ 39923 419809   1550]
 [ 33844 434419   1361]]
Evaluating performance on  val set...
2036/2036 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1368294
{'0': {'precision': 0.3471849065615858, 'recall': 0.10044334408106863, 'f1-score': 0.1558097058416359, 'support': 173680}, '1': {'precision': 0.3332594372099666, 'recall': 0.8912483325542419, 'f1-score': 0.4851205113684848, 'support': 175418}, '2': {'precision': 0.31107491856677527, 'recall': 0.0033291114235582567, 'f1-score': 0.006587721315244885, 'support': 172118}, 'accuracy': 0.33452349889489197, 'macro avg': {'precision': 0.33050642077944253, 'recall': 0.33167359601962293, 'f1-score': 0.2158393128417885, 'support': 521216}, 'weighted avg': {'precision': 0.3305738338078462, 'recall': 0.33452349889489197, 'f1-score': 0.21736432686477297, 'support': 521216}}
[[ 17445 155598    637]
 [ 18445 156341    632]
 [ 14357 157188    573]]
training model: results/universal/W3/deepVOL_L3/h50
Epoch 1/50
10532/10532 - 593s - loss: 3.0482 - accuracy50: 0.4638 - val_loss: 3.6148 - val_accuracy50: 0.4565 - 593s/epoch - 56ms/step
Epoch 2/50
10532/10532 - 579s - loss: 2.9725 - accuracy50: 0.4848 - val_loss: 3.6729 - val_accuracy50: 0.4642 - 579s/epoch - 55ms/step
Epoch 3/50
10532/10532 - 587s - loss: 2.9503 - accuracy50: 0.4912 - val_loss: 3.4832 - val_accuracy50: 0.4694 - 587s/epoch - 56ms/step
Epoch 4/50
10532/10532 - 564s - loss: 2.9354 - accuracy50: 0.4947 - val_loss: 3.4251 - val_accuracy50: 0.4657 - 564s/epoch - 54ms/step
Epoch 5/50
10532/10532 - 561s - loss: 2.9236 - accuracy50: 0.4977 - val_loss: 3.3608 - val_accuracy50: 0.4682 - 561s/epoch - 53ms/step
Epoch 6/50
10532/10532 - 553s - loss: 2.9149 - accuracy50: 0.5001 - val_loss: 3.3268 - val_accuracy50: 0.4687 - 553s/epoch - 53ms/step
Epoch 7/50
10532/10532 - 582s - loss: 2.9095 - accuracy50: 0.5016 - val_loss: 3.3515 - val_accuracy50: 0.4693 - 582s/epoch - 55ms/step
Epoch 8/50
10532/10532 - 579s - loss: 2.9043 - accuracy50: 0.5031 - val_loss: 3.3732 - val_accuracy50: 0.4746 - 579s/epoch - 55ms/step
Epoch 9/50
10532/10532 - 561s - loss: 2.8994 - accuracy50: 0.5043 - val_loss: 3.3595 - val_accuracy50: 0.4748 - 561s/epoch - 53ms/step
Epoch 10/50
10532/10532 - 562s - loss: 2.8956 - accuracy50: 0.5057 - val_loss: 3.3459 - val_accuracy50: 0.4735 - 562s/epoch - 53ms/step
Epoch 11/50
10532/10532 - 568s - loss: 2.8920 - accuracy50: 0.5068 - val_loss: 3.3395 - val_accuracy50: 0.4759 - 568s/epoch - 54ms/step
Epoch 12/50
10532/10532 - 570s - loss: 2.8895 - accuracy50: 0.5073 - val_loss: 3.3853 - val_accuracy50: 0.4773 - 570s/epoch - 54ms/step
Epoch 13/50
10532/10532 - 575s - loss: 2.8866 - accuracy50: 0.5081 - val_loss: 3.3564 - val_accuracy50: 0.4779 - 575s/epoch - 55ms/step
Epoch 14/50
10532/10532 - 570s - loss: 2.8846 - accuracy50: 0.5088 - val_loss: 3.3619 - val_accuracy50: 0.4778 - 570s/epoch - 54ms/step
Epoch 15/50
10532/10532 - 573s - loss: 2.8818 - accuracy50: 0.5097 - val_loss: 3.3648 - val_accuracy50: 0.4786 - 573s/epoch - 54ms/step
Epoch 16/50
10532/10532 - 572s - loss: 2.8797 - accuracy50: 0.5104 - val_loss: 3.3903 - val_accuracy50: 0.4783 - 572s/epoch - 54ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 806s - 806s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1321092
{'0': {'precision': 0.3995904653304827, 'recall': 0.6889422094175817, 'f1-score': 0.5058088644159404, 'support': 2074248}, '1': {'precision': 0.6227226639407507, 'recall': 0.40886800503887105, 'f1-score': 0.49362868617218125, 'support': 2941135}, '2': {'precision': 0.469181428496342, 'recall': 0.3577326765467912, 'f1-score': 0.405946705173903, 'support': 2071094}, 'accuracy': 0.47590234188299774, 'macro avg': {'precision': 0.4971648525891918, 'recall': 0.485180963667748, 'f1-score': 0.4684614185873415, 'support': 7086477}, 'weighted avg': {'precision': 0.5125367636429788, 'recall': 0.47590234188299774, 'f1-score': 0.4715679478967466, 'support': 7086477}}
[[1429037  324297  320914]
 [1221282 1202536  517317]
 [ 925935  404261  740898]]
Evaluating performance on  train set...
10532/10532 - 307s - 307s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1505078
{'0': {'precision': 0.39816304929421226, 'recall': 0.6999713820305717, 'f1-score': 0.5075931178148212, 'support': 828151}, '1': {'precision': 0.5990752010151101, 'recall': 0.36041682692354504, 'f1-score': 0.45006477751007534, 'support': 1026997}, '2': {'precision': 0.47388084295068106, 'recall': 0.3506518687697761, 'f1-score': 0.40305787943362775, 'support': 840660}, 'accuracy': 0.461682731114382, 'macro avg': {'precision': 0.49037303108666785, 'recall': 0.47034669257463096, 'f1-score': 0.4535719249195081, 'support': 2695808}, 'weighted avg': {'precision': 0.4983145057392388, 'recall': 0.461682731114382, 'f1-score': 0.45307883994136466, 'support': 2695808}}
[[579682 109543 138926]
 [468502 370147 188348]
 [407707 138174 294779]]
Evaluating performance on  val set...
3814/3814 - 109s - 109s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1472256
{'0': {'precision': 0.39790063453489943, 'recall': 0.691632616437978, 'f1-score': 0.5051723877173436, 'support': 289768}, '1': {'precision': 0.6095411728957764, 'recall': 0.38169875608574205, 'f1-score': 0.4694344944647605, 'support': 394159}, '2': {'precision': 0.47203262712240496, 'recall': 0.3643785028159557, 'f1-score': 0.41127750646699224, 'support': 291908}, 'accuracy': 0.46855052339791053, 'macro avg': {'precision': 0.4931581448510269, 'recall': 0.47923662511322523, 'f1-score': 0.46196146288303214, 'support': 975835}, 'weighted avg': {'precision': 0.5055620164816614, 'recall': 0.46855052339791053, 'f1-score': 0.4626497488874467, 'support': 975835}}
[[200413  42260  47095]
 [171835 150450  71874]
 [131428  54115 106365]]
testing model out of sample: results/universal/W3/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 465s - 465s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9947206
{'0': {'precision': 0.42852705113628703, 'recall': 0.6610236609378763, 'f1-score': 0.5199694094344085, 'support': 1154054}, '1': {'precision': 0.6646871794940146, 'recall': 0.542759549162843, 'f1-score': 0.5975672554561509, 'support': 1837648}, '2': {'precision': 0.4887019382462996, 'recall': 0.3653103136811963, 'f1-score': 0.4180920307745679, 'support': 1144761}, 'accuracy': 0.5266458324418712, 'macro avg': {'precision': 0.5273053896255337, 'recall': 0.5230311745939719, 'f1-score': 0.5118762318883757, 'support': 4136463}, 'weighted avg': {'precision': 0.5500959015041657, 'recall': 0.5266458324418712, 'f1-score': 0.5262482705469448, 'support': 4136463}}
[[762857 220483 170714]
 [573432 997401 266815]
 [443895 282673 418193]]
Evaluating performance on  train set...
6181/6181 - 185s - 185s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0737978
{'0': {'precision': 0.4226558171098424, 'recall': 0.6789038717703579, 'f1-score': 0.5209752563727713, 'support': 499978}, '1': {'precision': 0.5727957505106608, 'recall': 0.40056723361205027, 'f1-score': 0.4714442873818341, 'support': 578245}, '2': {'precision': 0.4853781952637428, 'recall': 0.36078631514564186, 'f1-score': 0.41390960827823775, 'support': 503564}, 'accuracy': 0.4758807601782035, 'macro avg': {'precision': 0.4936099209614153, 'recall': 0.48008580684268337, 'f1-score': 0.46877638401094773, 'support': 1581787}, 'weighted avg': {'precision': 0.4975093829957973, 'recall': 0.4758807601782035, 'f1-score': 0.4687840061088355, 'support': 1581787}}
[[339437  76255  84286]
 [238280 231626 108339]
 [225388  96497 181679]]
Evaluating performance on  val set...
2209/2209 - 62s - 62s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0387623
{'0': {'precision': 0.4304916258065026, 'recall': 0.6450518613242399, 'f1-score': 0.5163704263632938, 'support': 168912}, '1': {'precision': 0.5919319685316029, 'recall': 0.46996390961712814, 'f1-score': 0.5239433882038511, 'support': 229424}, '2': {'precision': 0.48556489233525907, 'recall': 0.37784121641925594, 'f1-score': 0.42498293146221594, 'support': 166390}, 'accuracy': 0.4951905880019691, 'macro avg': {'precision': 0.5026628288911216, 'recall': 0.49761899578687463, 'f1-score': 0.48843224867645363, 'support': 564726}, 'weighted avg': {'precision': 0.5123046289391426, 'recall': 0.4951905880019691, 'f1-score': 0.4925207256601522, 'support': 564726}}
[[108957  33649  26306]
 [ 81302 107821  40301]
 [ 62840  40681  62869]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3903396
{'0': {'precision': 0.35332997421381784, 'recall': 0.8351694544180751, 'f1-score': 0.4965764302190564, 'support': 57095}, '1': {'precision': 0.3843558282208589, 'recall': 0.02103195917819256, 'f1-score': 0.039881596537017, 'support': 59576}, '2': {'precision': 0.4179554241528315, 'recall': 0.2591985331711359, 'f1-score': 0.31996691948594624, 'support': 56721}, 'accuracy': 0.36702385346498106, 'macro avg': {'precision': 0.3852137421958361, 'recall': 0.3717999822558012, 'f1-score': 0.2854749820806732, 'support': 173392}, 'weighted avg': {'precision': 0.3851308440596832, 'recall': 0.36702385346498106, 'f1-score': 0.28188648218377266, 'support': 173392}}
[[47684   847  8564]
 [46413  1253 11910]
 [40859  1160 14702]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3472149
{'0': {'precision': 0.3577972613535612, 'recall': 0.8125279642058165, 'f1-score': 0.49681964297927633, 'support': 22350}, '1': {'precision': 0.3407451923076923, 'recall': 0.02627189324437031, 'f1-score': 0.04878258625139809, 'support': 21582}, '2': {'precision': 0.4290438533429188, 'recall': 0.2664642586060633, 'f1-score': 0.3287520312887322, 'support': 22397}, 'accuracy': 0.3723107539688522, 'macro avg': {'precision': 0.3758621023347241, 'recall': 0.3684213720187501, 'f1-score': 0.2914514201731356, 'support': 66329}, 'weighted avg': {'precision': 0.3763063926029046, 'recall': 0.3723107539688522, 'f1-score': 0.2942876274606617, 'support': 66329}}
[[18160   548  3642]
 [16715   567  4300]
 [15880   549  5968]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3590537
{'0': {'precision': 0.3605615054153809, 'recall': 0.7959129157205823, 'f1-score': 0.4962938285999834, 'support': 7487}, '1': {'precision': 0.27204502814258913, 'recall': 0.020166898470097356, 'f1-score': 0.037550174802537875, 'support': 7190}, '2': {'precision': 0.40685268773081656, 'recall': 0.2732534105002067, 'f1-score': 0.326931003214904, 'support': 7257}, 'accuracy': 0.3686970000911826, 'macro avg': {'precision': 0.34648640709626216, 'recall': 0.3631110748969621, 'f1-score': 0.2869250022058084, 'support': 21934}, 'weighted avg': {'precision': 0.346861388631928, 'recall': 0.3686970000911826, 'f1-score': 0.28988218938127475, 'support': 21934}}
[[5959  193 1335]
 [5489  145 1556]
 [5079  195 1983]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8413107
{'0': {'precision': 0.4453305567633127, 'recall': 0.5529965047881561, 'f1-score': 0.4933578400304221, 'support': 70382}, '1': {'precision': 0.7704482165774753, 'recall': 0.6911643951670714, 'f1-score': 0.7286559671686637, 'support': 230171}, '2': {'precision': 0.43374452845204936, 'recall': 0.4758440046565774, 'f1-score': 0.45381999861217126, 'support': 68720}, 'accuracy': 0.6247600014081722, 'macro avg': {'precision': 0.5498411005976125, 'recall': 0.5733349682039349, 'f1-score': 0.5586112686037524, 'support': 369273}, 'weighted avg': {'precision': 0.6458230515071354, 'recall': 0.6247600014081722, 'f1-score': 0.6326633531853887, 'support': 369273}}
[[ 38921  21928   9533]
 [ 37928 159086  33157]
 [ 10549  25471  32700]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96897054
{'0': {'precision': 0.4288434142379741, 'recall': 0.6712934016923012, 'f1-score': 0.5233526415416236, 'support': 47982}, '1': {'precision': 0.6285103730745258, 'recall': 0.511692642261689, 'f1-score': 0.5641173179892911, 'support': 68975}, '2': {'precision': 0.5192465941300174, 'recall': 0.36158156118680757, 'f1-score': 0.4263033442179935, 'support': 47118}, 'accuracy': 0.5152582660368734, 'macro avg': {'precision': 0.5255334604808392, 'recall': 0.514855868380266, 'f1-score': 0.5045911012496361, 'support': 164075}, 'weighted avg': {'precision': 0.538742213664483, 'recall': 0.5152582660368734, 'f1-score': 0.5126195912090504, 'support': 164075}}
[[32210  9314  6458]
 [24365 35294  9316]
 [18534 11547 17037]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9418482
{'0': {'precision': 0.43244384718756, 'recall': 0.6157673172598546, 'f1-score': 0.5080747022735475, 'support': 18291}, '1': {'precision': 0.6191681735985534, 'recall': 0.5698550549217781, 'f1-score': 0.593489017049573, 'support': 33047}, '2': {'precision': 0.5382081686429513, 'recall': 0.39145017035775126, 'f1-score': 0.4532453923442027, 'support': 18784}, 'accuracy': 0.5340406719717065, 'macro avg': {'precision': 0.5299400631430214, 'recall': 0.525690847513128, 'f1-score': 0.5182697038891076, 'support': 70122}, 'weighted avg': {'precision': 0.548774753737889, 'recall': 0.5340406719717065, 'f1-score': 0.5336411878656655, 'support': 70122}}
[[11263  4933  2095]
 [10001 18832  4214]
 [ 4781  6650  7353]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
1359/1359 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2184594
{'0': {'precision': 0.40370425596327375, 'recall': 0.71481718537483, 'f1-score': 0.5159932198103973, 'support': 124990}, '1': {'precision': 0.3656804393455821, 'recall': 0.12584976795273956, 'f1-score': 0.18725521952943255, 'support': 101057}, '2': {'precision': 0.44260650535934315, 'recall': 0.33338535078929643, 'f1-score': 0.3803094681513892, 'support': 121754}, 'accuracy': 0.4101598327779391, 'macro avg': {'precision': 0.4039970668893997, 'recall': 0.39135076803895535, 'f1-score': 0.36118596916373963, 'support': 347801}, 'weighted avg': {'precision': 0.40627449479822525, 'recall': 0.4101598327779391, 'f1-score': 0.372976622405892, 'support': 347801}}
[[89345 10091 25554]
 [62775 12718 25564]
 [69193 11970 40591]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3334266
{'0': {'precision': 0.3610140814321581, 'recall': 0.7072251476838363, 'f1-score': 0.4780169649228991, 'support': 37411}, '1': {'precision': 0.35985883424408016, 'recall': 0.08436082199092608, 'f1-score': 0.13668007091278592, 'support': 37470}, '2': {'precision': 0.41222197544182504, 'recall': 0.3356412111191485, 'f1-score': 0.3700106799572802, 'support': 38708}, 'accuracy': 0.37513315549921206, 'macro avg': {'precision': 0.37769829703935437, 'recall': 0.3757423935979703, 'f1-score': 0.3282359052643217, 'support': 113589}, 'weighted avg': {'precision': 0.37808323468809757, 'recall': 0.37513315549921206, 'f1-score': 0.3286134073864465, 'support': 113589}}
[[26458  2754  8199]
 [23983  3161 10326]
 [22847  2869 12992]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2671554
{'0': {'precision': 0.3855758976182012, 'recall': 0.6825833857772183, 'f1-score': 0.49278736937755563, 'support': 12712}, '1': {'precision': 0.3908320084790673, 'recall': 0.13106451039630354, 'f1-score': 0.1963002395528347, 'support': 11254}, '2': {'precision': 0.42174835970667696, 'recall': 0.34482486588829286, 'f1-score': 0.37942708333333336, 'support': 12676}, 'accuracy': 0.3963484525953824, 'macro avg': {'precision': 0.3993854219346485, 'recall': 0.38615758735393824, 'f1-score': 0.3561715640879079, 'support': 36642}, 'weighted avg': {'precision': 0.39970379459603284, 'recall': 0.3963484525953824, 'f1-score': 0.36251006068960273, 'support': 36642}}
[[8677 1148 2887]
 [6673 1475 3106]
 [7154 1151 4371]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2905377
{'0': {'precision': 0.3229038805099474, 'recall': 0.5645337781130151, 'f1-score': 0.4108235566980421, 'support': 94129}, '1': {'precision': 0.34234444866586783, 'recall': 0.11571096952634959, 'f1-score': 0.17296163954758884, 'support': 101235}, '2': {'precision': 0.3347590010988774, 'recall': 0.32286655375567586, 'f1-score': 0.32870524639934834, 'support': 96241}, 'accuracy': 0.3289586941239005, 'macro avg': {'precision': 0.33333577675823084, 'recall': 0.33437043379834686, 'f1-score': 0.3041634808816598, 'support': 291605}, 'weighted avg': {'precision': 0.3335656132575471, 'recall': 0.3289586941239005, 'f1-score': 0.3011440262229723, 'support': 291605}}
[[53139 11441 29549]
 [57321 11714 32200]
 [54106 11062 31073]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2616097
{'0': {'precision': 0.33886353434086486, 'recall': 0.5382992631328738, 'f1-score': 0.4159090909090909, 'support': 33656}, '1': {'precision': 0.3315461527314882, 'recall': 0.14109086424320907, 'f1-score': 0.19794527955012434, 'support': 32433}, '2': {'precision': 0.33325843417969375, 'recall': 0.32112588926693475, 'f1-score': 0.32707969062583686, 'support': 32330}, 'accuracy': 0.33606315853646146, 'macro avg': {'precision': 0.33455604041734893, 'recall': 0.33350533888100586, 'f1-score': 0.3136446870283507, 'support': 98419}, 'weighted avg': {'precision': 0.3346109253329744, 'recall': 0.33606315853646146, 'f1-score': 0.31490141144716827, 'support': 98419}}
[[18117  4897 10642]
 [17728  4576 10129]
 [17619  4329 10382]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3109821
{'0': {'precision': 0.3396272803264985, 'recall': 0.5686177657034659, 'f1-score': 0.42525551040512255, 'support': 12147}, '1': {'precision': 0.33241620810405204, 'recall': 0.10893442622950819, 'f1-score': 0.16409433263365844, 'support': 12200}, '2': {'precision': 0.31660021747009787, 'recall': 0.31694484760522496, 'f1-score': 0.31677243880326383, 'support': 11024}, 'accuracy': 0.3316276045347884, 'macro avg': {'precision': 0.32954790196688283, 'recall': 0.3314990131793997, 'f1-score': 0.30204076061401497, 'support': 35371}, 'weighted avg': {'precision': 0.3299632781200919, 'recall': 0.3316276045347884, 'f1-score': 0.30136634272112284, 'support': 35371}}
[[6907 1401 3839]
 [7168 1329 3703]
 [6262 1268 3494]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
2282/2282 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1881874
{'0': {'precision': 0.4120177850882829, 'recall': 0.7553371435033147, 'f1-score': 0.5331923123614527, 'support': 212239}, '1': {'precision': 0.37304957410990225, 'recall': 0.09434273986007766, 'f1-score': 0.15059947659911144, 'support': 157373}, '2': {'precision': 0.4793109228527588, 'recall': 0.3467812279891596, 'f1-score': 0.4024152275169221, 'support': 214383}, 'accuracy': 0.4272348222159436, 'macro avg': {'precision': 0.42145942735031466, 'recall': 0.39882037045085067, 'f1-score': 0.3620690054924954, 'support': 583995}, 'weighted avg': {'precision': 0.4262198938170579, 'recall': 0.4272348222159436, 'f1-score': 0.38208456979062255, 'support': 583995}}
[[160312  11087  40840]
 [102604  14847  39922]
 [126174  13865  74344]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2965585
{'0': {'precision': 0.3771804045494411, 'recall': 0.7265462638939169, 'f1-score': 0.496570431021448, 'support': 74583}, '1': {'precision': 0.43865250537564343, 'recall': 0.0907448844795514, 'f1-score': 0.1503803067025566, 'support': 74186}, '2': {'precision': 0.4258329529895025, 'recall': 0.3684155105694053, 'f1-score': 0.39504883418957826, 'support': 75974}, 'accuracy': 0.3956074271501226, 'macro avg': {'precision': 0.41388862097152906, 'recall': 0.39523555298095786, 'f1-score': 0.34733319063786094, 'support': 224743}, 'weighted avg': {'precision': 0.41391880346321314, 'recall': 0.3956074271501226, 'f1-score': 0.3479764264899353, 'support': 224743}}
[[54188  4160 16235]
 [45949  6732 21505]
 [43529  4455 27990]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3043847
{'0': {'precision': 0.37895267884169104, 'recall': 0.7369804952709862, 'f1-score': 0.5005330774561544, 'support': 25481}, '1': {'precision': 0.40960912052117265, 'recall': 0.07668267398429758, 'f1-score': 0.12918138041733546, 'support': 26238}, '2': {'precision': 0.42842794759825326, 'recall': 0.3825249532127261, 'f1-score': 0.40417730905495586, 'support': 25648}, 'accuracy': 0.39554331950314736, 'macro avg': {'precision': 0.40566324898703904, 'recall': 0.39872937415600335, 'f1-score': 0.34463058897614857, 'support': 77367}, 'weighted avg': {'precision': 0.40575099608101206, 'recall': 0.39554331950314736, 'f1-score': 0.34265105314529226, 'support': 77367}}
[[18779  1340  5362]
 [16499  2012  7727]
 [14277  1560  9811]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
5098/5098 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8267746
{'0': {'precision': 0.5212070248959224, 'recall': 0.5948390872591344, 'f1-score': 0.5555940880676893, 'support': 317812}, '1': {'precision': 0.6607593687551911, 'recall': 0.7141413902006909, 'f1-score': 0.6864140718771758, 'support': 675068}, '2': {'precision': 0.5769938145299748, 'recall': 0.39312119629139414, 'f1-score': 0.4676321798767122, 'support': 312031}, 'accuracy': 0.6083227131965322, 'macro avg': {'precision': 0.5863200693936962, 'recall': 0.5673672245837398, 'f1-score': 0.5698801132738591, 'support': 1304911}, 'weighted avg': {'precision': 0.6067412332984049, 'recall': 0.6083227131965322, 'f1-score': 0.6022375316861152, 'support': 1304911}}
[[189047 102375  26390]
 [129435 482094  63539]
 [ 44228 145137 122666]]
Evaluating performance on  train set...
1876/1876 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8226349
{'0': {'precision': 0.5083510499992353, 'recall': 0.5808495207137302, 'f1-score': 0.5421874936277289, 'support': 114441}, '1': {'precision': 0.6860255496762487, 'recall': 0.7072286690241758, 'f1-score': 0.6964657704272618, 'support': 249133}, '2': {'precision': 0.5684576512762924, 'recall': 0.4513816844289352, 'f1-score': 0.5031995985567157, 'support': 116633}, 'accuracy': 0.614970210763275, 'macro avg': {'precision': 0.5876114169839255, 'recall': 0.5798199580556137, 'f1-score': 0.5806176208705688, 'support': 480207}, 'weighted avg': {'precision': 0.61512790738528, 'recall': 0.614970210763275, 'f1-score': 0.6127581741219336, 'support': 480207}}
[[ 66473  35680  12288]
 [ 45261 176194  27678]
 [ 19028  44959  52646]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80117804
{'0': {'precision': 0.5216553637484587, 'recall': 0.5649150137702729, 'f1-score': 0.542424040066778, 'support': 35947}, '1': {'precision': 0.675193954340026, 'recall': 0.7461256856805343, 'f1-score': 0.7088898766529614, 'support': 85499}, '2': {'precision': 0.6103032488082362, 'recall': 0.4125819205979527, 'f1-score': 0.4923330478760361, 'support': 36926}, 'accuracy': 0.6272257722324653, 'macro avg': {'precision': 0.6023841889655737, 'recall': 0.5745408733495866, 'f1-score': 0.5812156548652585, 'support': 158372}, 'weighted avg': {'precision': 0.6252141226244328, 'recall': 0.6272257722324653, 'f1-score': 0.6206133827829573, 'support': 158372}}
[[20307 13131  2509]
 [14487 63793  7219]
 [ 4134 17557 15235]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
5760/5760 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82334375
{'0': {'precision': 0.4815920813581974, 'recall': 0.5708822100582653, 'f1-score': 0.5224495343868448, 'support': 323177}, '1': {'precision': 0.7058338740930499, 'recall': 0.7479272857955737, 'f1-score': 0.7262711760897976, 'support': 834775}, '2': {'precision': 0.5372672459227239, 'recall': 0.35105633469080844, 'f1-score': 0.42464496996193646, 'support': 316519}, 'accuracy': 0.6239274967089892, 'macro avg': {'precision': 0.5748977337913237, 'recall': 0.5566219435148825, 'f1-score': 0.5577885601461929, 'support': 1474471}, 'weighted avg': {'precision': 0.6204986383152592, 'recall': 0.6239274967089892, 'f1-score': 0.616848276732659, 'support': 1474471}}
[[184496 114068  24613]
 [139336 624351  71088]
 [ 59264 146139 111116]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9250267
{'0': {'precision': 0.47836869382136205, 'recall': 0.6041148686220496, 'f1-score': 0.533938159704667, 'support': 156457}, '1': {'precision': 0.5976258665666807, 'recall': 0.6282012578616352, 'f1-score': 0.6125322463931054, 'support': 238500}, '2': {'precision': 0.5495093666369313, 'recall': 0.36354405960071584, 'f1-score': 0.4375885576794547, 'support': 157582}, 'accuracy': 0.545901737252936, 'macro avg': {'precision': 0.541834642341658, 'recall': 0.5319533953614669, 'f1-score': 0.5280196545924091, 'support': 552539}, 'weighted avg': {'precision': 0.5501343523601829, 'recall': 0.545901737252936, 'f1-score': 0.5403842688279245, 'support': 552539}}
[[ 94518  43855  18084]
 [ 59793 149826  28881]
 [ 43273  57021  57288]]
Evaluating performance on  val set...
850/850 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89710885
{'0': {'precision': 0.48027802893309224, 'recall': 0.583331903430052, 'f1-score': 0.5268124869249902, 'support': 58279}, '1': {'precision': 0.6194098189089686, 'recall': 0.6559855914340283, 'f1-score': 0.6371732454137811, 'support': 101051}, '2': {'precision': 0.5519560984244999, 'recall': 0.37621304834956476, 'f1-score': 0.44744664712273724, 'support': 58015}, 'accuracy': 0.5618256688674688, 'macro avg': {'precision': 0.5505479820888536, 'recall': 0.5385101810712151, 'f1-score': 0.5371441264871695, 'support': 217345}, 'weighted avg': {'precision': 0.564097807213689, 'recall': 0.5618256688674688, 'f1-score': 0.5569381204105689, 'support': 217345}}
[[33996 18134  6149]
 [23195 66288 11568]
 [13593 22596 21826]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
6315/6315 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9012328
{'0': {'precision': 0.5015534402034045, 'recall': 0.5407970400748897, 'f1-score': 0.520436496232941, 'support': 448660}, '1': {'precision': 0.5966677721524272, 'recall': 0.7139511198803389, 'f1-score': 0.6500617787738745, 'support': 720702}, '2': {'precision': 0.5772240123413401, 'recall': 0.3489979422027378, 'f1-score': 0.4349929118151747, 'support': 447080}, 'accuracy': 0.5649506756196634, 'macro avg': {'precision': 0.5584817415657239, 'recall': 0.5345820340526555, 'f1-score': 0.5351637289406633, 'support': 1616442}, 'weighted avg': {'precision': 0.5648900082063101, 'recall': 0.5649506756196634, 'f1-score': 0.5545986144260595, 'support': 1616442}}
[[242634 158109  47917]
 [139792 514546  66364]
 [101339 189711 156030]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93697476
{'0': {'precision': 0.4960086543243423, 'recall': 0.5817533478854353, 'f1-score': 0.5354701587951715, 'support': 166299}, '1': {'precision': 0.5488581967783595, 'recall': 0.6640143328936167, 'f1-score': 0.6009695173581711, 'support': 213774}, '2': {'precision': 0.588936118036539, 'recall': 0.33614435346536964, 'f1-score': 0.428000712864229, 'support': 171468}, 'accuracy': 0.5372800934110066, 'macro avg': {'precision': 0.5446009897130802, 'recall': 0.5273040114148072, 'f1-score': 0.5214801296725238, 'support': 551541}, 'weighted avg': {'precision': 0.5453829427931379, 'recall': 0.5372800934110066, 'f1-score': 0.5274462565332542, 'support': 551541}}
[[ 96745  50210  19344]
 [ 50939 141949  20886]
 [ 47363  66467  57638]]
Evaluating performance on  val set...
746/746 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9081826
{'0': {'precision': 0.5009535180670945, 'recall': 0.5665497646330714, 'f1-score': 0.531736252904316, 'support': 53321}, '1': {'precision': 0.5911752948231062, 'recall': 0.7074025352786415, 'f1-score': 0.644087543554007, 'support': 83620}, '2': {'precision': 0.5832318778585766, 'recall': 0.3293813762473752, 'f1-score': 0.42100137760676454, 'support': 53813}, 'accuracy': 0.5613879656520964, 'macro avg': {'precision': 0.5584535635829257, 'recall': 0.534444558719696, 'f1-score': 0.5322750580216958, 'support': 190754}, 'weighted avg': {'precision': 0.563714929873907, 'recall': 0.5613879656520964, 'f1-score': 0.5497481377389198, 'support': 190754}}
[[30209 17825  5287]
 [17088 59153  7379]
 [13006 23082 17725]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
6082/6082 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9902198
{'0': {'precision': 0.43142017227041607, 'recall': 0.6441027778986744, 'f1-score': 0.5167326859128619, 'support': 436553}, '1': {'precision': 0.6398622889814473, 'recall': 0.5031312649025286, 'f1-score': 0.5633185274312441, 'support': 684867}, '2': {'precision': 0.4835383704528278, 'recall': 0.40705675909082556, 'f1-score': 0.44201356024357064, 'support': 435384}, 'accuracy': 0.5157932533575197, 'macro avg': {'precision': 0.5182736105682304, 'recall': 0.5180969339640096, 'f1-score': 0.5073549245292256, 'support': 1556804}, 'weighted avg': {'precision': 0.53769338119266, 'recall': 0.5157932533575197, 'f1-score': 0.5163303190849061, 'support': 1556804}}
[[281185  84462  70906]
 [221902 344578 118387]
 [148679 109479 177226]]
Evaluating performance on  train set...
2440/2440 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.048995
{'0': {'precision': 0.43286352127792044, 'recall': 0.6979926091300669, 'f1-score': 0.5343483233450752, 'support': 209177}, '1': {'precision': 0.5594493901721637, 'recall': 0.34539749257894403, 'f1-score': 0.4271052269148089, 'support': 206507}, '2': {'precision': 0.48608208067887404, 'recall': 0.37181371258430945, 'f1-score': 0.42133784652438183, 'support': 208903}, 'accuracy': 0.47231850807013276, 'macro avg': {'precision': 0.4927983307096528, 'recall': 0.4717346047644402, 'f1-score': 0.4609304655947553, 'support': 624587}, 'weighted avg': {'precision': 0.4925163554583964, 'recall': 0.47231850807013276, 'f1-score': 0.4610924314456307, 'support': 624587}}
[[146004  24745  38428]
 [ 91487  71327  43693]
 [ 99807  31423  77673]]
Evaluating performance on  val set...
826/826 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0145464
{'0': {'precision': 0.44141358130011943, 'recall': 0.6372915800655858, 'f1-score': 0.5215682074479144, 'support': 64953}, '1': {'precision': 0.5752323765333819, 'recall': 0.45328649436618035, 'f1-score': 0.507030205827319, 'support': 83691}, '2': {'precision': 0.4795119215671108, 'recall': 0.3948944166640125, 'f1-score': 0.43310889290611054, 'support': 62794}, 'accuracy': 0.49247060604054144, 'macro avg': {'precision': 0.4987192931335374, 'recall': 0.4951574970319262, 'f1-score': 0.48723576872711466, 'support': 211438}, 'weighted avg': {'precision': 0.5056961415333434, 'recall': 0.49247060604054144, 'f1-score': 0.48954267707509924, 'support': 211438}}
[[41394 12798 10761]
 [29600 37936 16155]
 [22782 15215 24797]]
testing model on single stock: results/universal/W3/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
13689/13689 - 193s - 193s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3697282
{'0': {'precision': 0.3653982622559689, 'recall': 0.7922257744267515, 'f1-score': 0.5001242408881732, 'support': 1143265}, '1': {'precision': 0.3582764121231952, 'recall': 0.028862589263723076, 'f1-score': 0.05342156119092361, 'support': 1213959}, '2': {'precision': 0.4297465072936956, 'recall': 0.34758182493448253, 'f1-score': 0.3843217056972413, 'support': 1147022}, 'accuracy': 0.38223515129930946, 'macro avg': {'precision': 0.3844737272242866, 'recall': 0.3895567295416524, 'f1-score': 0.3126225025921127, 'support': 3504246}, 'weighted avg': {'precision': 0.3839937657264249, 'recall': 0.38223515129930946, 'f1-score': 0.30747030224848676, 'support': 3504246}}
[[905724  30096 207445]
 [857331  35038 321590]
 [715676  32662 398684]]
Evaluating performance on  train set...
5475/5475 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3602872
{'0': {'precision': 0.3655377154204628, 'recall': 0.7864539163927493, 'f1-score': 0.49909836138166325, 'support': 465773}, '1': {'precision': 0.38059422008613697, 'recall': 0.026357195654899045, 'f1-score': 0.049300215877944066, 'support': 462682}, '2': {'precision': 0.4269298393637695, 'recall': 0.33155010135042307, 'f1-score': 0.37324291365515605, 'support': 473111}, 'accuracy': 0.381975590161291, 'macro avg': {'precision': 0.3910205916234564, 'recall': 0.38145373779935715, 'f1-score': 0.3072138303049211, 'support': 1401566}, 'weighted avg': {'precision': 0.39123159130120283, 'recall': 0.381975590161291, 'f1-score': 0.3081283305109891, 'support': 1401566}}
[[366309   9284  90180]
 [330113  12195 120374]
 [305688  10563 156860]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3560222
{'0': {'precision': 0.36821880777243454, 'recall': 0.7753289976596771, 'f1-score': 0.4993070124283346, 'support': 170062}, '1': {'precision': 0.4113375365908579, 'recall': 0.04064118180351849, 'f1-score': 0.07397358736972115, 'support': 179793}, '2': {'precision': 0.43146265288994673, 'recall': 0.36601093597726436, 'f1-score': 0.39605085767869486, 'support': 171361}, 'accuracy': 0.38732694314833005, 'macro avg': {'precision': 0.40367299908441306, 'recall': 0.39399370514682003, 'f1-score': 0.3231104858255835, 'support': 521216}, 'weighted avg': {'precision': 0.4038853532231359, 'recall': 0.38732694314833005, 'f1-score': 0.31864093459185927, 'support': 521216}}
[[131854   4799  33409]
 [123249   7307  49237]
 [102983   5658  62720]]
training model: results/universal/W3/deepVOL_L3/h100
Epoch 1/50
10532/10532 - 588s - loss: 3.1969 - accuracy100: 0.4170 - val_loss: 3.4162 - val_accuracy100: 0.3878 - 588s/epoch - 56ms/step
Epoch 2/50
10532/10532 - 574s - loss: 3.1410 - accuracy100: 0.4359 - val_loss: 3.3677 - val_accuracy100: 0.3972 - 574s/epoch - 55ms/step
Epoch 3/50
10532/10532 - 578s - loss: 3.1282 - accuracy100: 0.4396 - val_loss: 3.3935 - val_accuracy100: 0.3989 - 578s/epoch - 55ms/step
Epoch 4/50
10532/10532 - 580s - loss: 3.1204 - accuracy100: 0.4426 - val_loss: 3.3608 - val_accuracy100: 0.3983 - 580s/epoch - 55ms/step
Epoch 5/50
10532/10532 - 567s - loss: 3.1139 - accuracy100: 0.4453 - val_loss: 3.3903 - val_accuracy100: 0.3969 - 567s/epoch - 54ms/step
Epoch 6/50
10532/10532 - 566s - loss: 3.1084 - accuracy100: 0.4471 - val_loss: 3.3936 - val_accuracy100: 0.3984 - 566s/epoch - 54ms/step
Epoch 7/50
10532/10532 - 565s - loss: 3.1037 - accuracy100: 0.4485 - val_loss: 3.3662 - val_accuracy100: 0.3991 - 565s/epoch - 54ms/step
Epoch 8/50
10532/10532 - 577s - loss: 3.1001 - accuracy100: 0.4498 - val_loss: 3.3748 - val_accuracy100: 0.4000 - 577s/epoch - 55ms/step
Epoch 9/50
10532/10532 - 575s - loss: 3.0971 - accuracy100: 0.4507 - val_loss: 3.3830 - val_accuracy100: 0.3992 - 575s/epoch - 55ms/step
Epoch 10/50
10532/10532 - 576s - loss: 3.0946 - accuracy100: 0.4514 - val_loss: 3.3957 - val_accuracy100: 0.4008 - 576s/epoch - 55ms/step
Epoch 11/50
10532/10532 - 571s - loss: 3.0920 - accuracy100: 0.4525 - val_loss: 3.4154 - val_accuracy100: 0.4015 - 571s/epoch - 54ms/step
Epoch 12/50
10532/10532 - 569s - loss: 3.0900 - accuracy100: 0.4530 - val_loss: 3.4138 - val_accuracy100: 0.4040 - 569s/epoch - 54ms/step
Epoch 13/50
10532/10532 - 568s - loss: 3.0879 - accuracy100: 0.4540 - val_loss: 3.4015 - val_accuracy100: 0.4070 - 568s/epoch - 54ms/step
Epoch 14/50
10532/10532 - 565s - loss: 3.0863 - accuracy100: 0.4544 - val_loss: 3.4190 - val_accuracy100: 0.4064 - 565s/epoch - 54ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 807s - 807s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0981961
{'0': {'precision': 0.3855834638937953, 'recall': 0.7403846972718958, 'f1-score': 0.5070837809348091, 'support': 2348444}, '1': {'precision': 0.46675929263544574, 'recall': 0.34293446838845243, 'f1-score': 0.39537874092766356, 'support': 2412805}, '2': {'precision': 0.4884932075673431, 'recall': 0.1689812783950649, 'f1-score': 0.2511008669217169, 'support': 2325228}, 'accuracy': 0.4175708183346958, 'macro avg': {'precision': 0.44694532136552806, 'recall': 0.41743348135180436, 'f1-score': 0.3845211295947299, 'support': 7086477}, 'weighted avg': {'precision': 0.44698916138347233, 'recall': 0.4175708183346958, 'f1-score': 0.3850568388817586, 'support': 7086477}}
[[1738752  425246  184446]
 [1358386  827434  226985]
 [1412267  520041  392920]]
Evaluating performance on  train set...
10532/10532 - 352s - 352s/epoch - 33ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1184196
{'0': {'precision': 0.3730066887499162, 'recall': 0.7671519745832731, 'f1-score': 0.5019526264365962, 'support': 892011}, '1': {'precision': 0.4476344947461034, 'recall': 0.27654668787838615, 'f1-score': 0.3418808438339102, 'support': 905160}, '2': {'precision': 0.48252662806135793, 'recall': 0.1621767187418279, 'f1-score': 0.24276152941529217, 'support': 898637}, 'accuracy': 0.40075739815298417, 'macro avg': {'precision': 0.43438927051912585, 'recall': 0.4019584604011624, 'f1-score': 0.36219833322859946, 'support': 2695808}, 'weighted avg': {'precision': 0.4345721914038607, 'recall': 0.40075739815298417, 'f1-score': 0.3618056706465025, 'support': 2695808}}
[[684308 136987  70716]
 [569264 250319  85577]
 [581001 171898 145738]]
Evaluating performance on  val set...
3814/3814 - 117s - 117s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1218677
{'0': {'precision': 0.3665805011077301, 'recall': 0.7434651721377101, 'f1-score': 0.49104256144985814, 'support': 312250}, '1': {'precision': 0.44875261179340986, 'recall': 0.29615640461242865, 'f1-score': 0.3568246782953869, 'support': 350271}, '2': {'precision': 0.4759369810135105, 'recall': 0.1692136323305055, 'f1-score': 0.24966271023218248, 'support': 313314}, 'accuracy': 0.3985294645098813, 'macro avg': {'precision': 0.4304233646382168, 'recall': 0.4029450696935481, 'f1-score': 0.36584331665914255, 'support': 975835}, 'weighted avg': {'precision': 0.4311871441643774, 'recall': 0.3985294645098813, 'f1-score': 0.365365250372868, 'support': 975835}}
[[232147  56111  23992]
 [212150 103735  34386]
 [188980  71317  53017]]
testing model out of sample: results/universal/W3/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 510s - 510s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0691752
{'0': {'precision': 0.39404610002593593, 'recall': 0.6977482701154281, 'f1-score': 0.5036570844438926, 'support': 1302110}, '1': {'precision': 0.5104333266985915, 'recall': 0.41800091023451325, 'f1-score': 0.4596159570307078, 'support': 1564432}, '2': {'precision': 0.47740909603635795, 'recall': 0.20663175110892726, 'f1-score': 0.28842686199518897, 'support': 1269921}, 'accuracy': 0.441170391225547, 'macro avg': {'precision': 0.4606295075869618, 'recall': 0.4407936438196229, 'f1-score': 0.41723330115659646, 'support': 4136463}, 'weighted avg': {'precision': 0.4636573406086529, 'recall': 0.441170391225547, 'f1-score': 0.4209234232547211, 'support': 4136463}}
[[908545 278114 115451]
 [738709 653934 171789]
 [658428 349087 262406]]
Evaluating performance on  train set...
6181/6181 - 216s - 216s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1136596
{'0': {'precision': 0.3822363587050324, 'recall': 0.7344862221885305, 'f1-score': 0.5028058783654485, 'support': 527660}, '1': {'precision': 0.4279607946140979, 'recall': 0.29596720377370755, 'f1-score': 0.34993082181870794, 'support': 522987}, '2': {'precision': 0.46785043918574815, 'recall': 0.1816093685280717, 'f1-score': 0.2616513656948097, 'support': 531140}, 'accuracy': 0.4038508345308186, 'macro avg': {'precision': 0.4260158641682928, 'recall': 0.40402093149676993, 'f1-score': 0.3714626886263221, 'support': 1581787}, 'weighted avg': {'precision': 0.42610215622979514, 'recall': 0.4038508345308186, 'f1-score': 0.3712847095493605, 'support': 1581787}}
[[387559  92146  47955]
 [306438 154787  61762]
 [319928 114752  96460]]
Evaluating performance on  val set...
2209/2209 - 75s - 75s/epoch - 34ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0955118
{'0': {'precision': 0.3945251228593617, 'recall': 0.6872640550974793, 'f1-score': 0.5012860939989431, 'support': 187014}, '1': {'precision': 0.43952890007143625, 'recall': 0.3553082104273347, 'f1-score': 0.39295655638796023, 'support': 195678}, '2': {'precision': 0.47023426279035213, 'recall': 0.20863135458211104, 'f1-score': 0.2890280747950898, 'support': 182034}, 'accuracy': 0.41795844356378137, 'macro avg': {'precision': 0.43476276190705004, 'recall': 0.417067873368975, 'f1-score': 0.3944235750606644, 'support': 564726}, 'weighted avg': {'precision': 0.4345230806220683, 'recall': 0.41795844356378137, 'f1-score': 0.39533049158574424, 'support': 564726}}
[[128528  40307  18179]
 [101545  69526  24607]
 [ 95706  48350  37978]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1369694
{'0': {'precision': 0.39251050126924153, 'recall': 0.9192197168965045, 'f1-score': 0.5501182893539582, 'support': 65771}, '1': {'precision': 0.24003707136237257, 'recall': 0.029065200314218383, 'f1-score': 0.05185185185185186, 'support': 44555}, '2': {'precision': 0.4722938144329897, 'recall': 0.10460469983826468, 'f1-score': 0.17127502141911363, 'support': 63066}, 'accuracy': 0.39419350373719664, 'macro avg': {'precision': 0.36828046235486794, 'recall': 0.3509632056829958, 'f1-score': 0.25774838754164126, 'support': 173392}, 'weighted avg': {'precision': 0.38234948322045265, 'recall': 0.39419350373719664, 'f1-score': 0.2842906233804113, 'support': 173392}}
[[60458  1745  3568]
 [39457  1295  3803]
 [54114  2355  6597]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2184061
{'0': {'precision': 0.3332399841855561, 'recall': 0.9220145852324522, 'f1-score': 0.4895455205459562, 'support': 21940}, '1': {'precision': 0.33115671641791045, 'recall': 0.032396422704873154, 'f1-score': 0.05901911886949294, 'support': 21916}, '2': {'precision': 0.398448721631715, 'recall': 0.061718506652427355, 'f1-score': 0.10688140556368961, 'support': 22473}, 'accuracy': 0.3365948529300909, 'macro avg': {'precision': 0.35428180741172716, 'recall': 0.33870983819658423, 'f1-score': 0.21848201499304623, 'support': 66329}, 'weighted avg': {'precision': 0.3546450869344564, 'recall': 0.3365948529300909, 'f1-score': 0.21764292477128983, 'support': 66329}}
[[20229   687  1024]
 [20136   710  1070]
 [20339   747  1387]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2265728
{'0': {'precision': 0.3399014778325123, 'recall': 0.9204958900417733, 'f1-score': 0.4964750345228577, 'support': 7421}, '1': {'precision': 0.26517571884984026, 'recall': 0.022136284837978398, 'f1-score': 0.040861538461538456, 'support': 7499}, '2': {'precision': 0.40545004128819156, 'recall': 0.07000285143997718, 'f1-score': 0.11939209726443767, 'support': 7014}, 'accuracy': 0.34138779976292516, 'macro avg': {'precision': 0.33684241265684806, 'recall': 0.33754500877324295, 'f1-score': 0.2189095567496113, 'support': 21934}, 'weighted avg': {'precision': 0.3353144967742045, 'recall': 0.34138779976292516, 'f1-score': 0.22012300895094233, 'support': 21934}}
[[6831  250  340]
 [6953  166  380]
 [6313  210  491]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
1443/1443 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.938623
{'0': {'precision': 0.4730081621042036, 'recall': 0.4639223934412156, 'f1-score': 0.46842122371144074, 'support': 93188}, '1': {'precision': 0.6084942051660007, 'recall': 0.7611574168922052, 'f1-score': 0.6763177875875152, 'support': 185482}, '2': {'precision': 0.5262549609664617, 'recall': 0.26635983355959514, 'f1-score': 0.3536981262045566, 'support': 90603}, 'accuracy': 0.5647474903391257, 'macro avg': {'precision': 0.5359191094122221, 'recall': 0.49714654796433866, 'f1-score': 0.4994790458345042, 'support': 369273}, 'weighted avg': {'precision': 0.5541257687434797, 'recall': 0.5647474903391257, 'f1-score': 0.5446976199208733, 'support': 369273}}
[[ 43232  42529   7427]
 [ 30003 141181  14298]
 [ 18163  48307  24133]]
Evaluating performance on  train set...
641/641 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0352665
{'0': {'precision': 0.44293619453392913, 'recall': 0.6163955169920463, 'f1-score': 0.5154643850526061, 'support': 55320}, '1': {'precision': 0.45424031271244053, 'recall': 0.5931316344268964, 'f1-score': 0.5144768290531111, 'support': 54074}, '2': {'precision': 0.5666444215252078, 'recall': 0.17080887328322453, 'f1-score': 0.2624922713731662, 'support': 54681}, 'accuracy': 0.4602285540149322, 'macro avg': {'precision': 0.48794030959052587, 'recall': 0.46011200823405574, 'f1-score': 0.4308111618262944, 'support': 164075}, 'weighted avg': {'precision': 0.48788971241596435, 'recall': 0.4602285540149322, 'f1-score': 0.4308313254687442, 'support': 164075}}
[[34099 17444  3777]
 [18635 32073  3366]
 [24250 21091  9340]]
Evaluating performance on  val set...
274/274 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0269687
{'0': {'precision': 0.44818267272442425, 'recall': 0.5290092922194998, 'f1-score': 0.4852532705722706, 'support': 21631}, '1': {'precision': 0.45156389876027453, 'recall': 0.6450437882662947, 'f1-score': 0.5312355391022674, 'support': 25806}, '2': {'precision': 0.5931150511194513, 'recall': 0.20202777165527883, 'f1-score': 0.30139418650532684, 'support': 22685}, 'accuracy': 0.4659308063090043, 'macro avg': {'precision': 0.49762054086805, 'recall': 0.45869361738035774, 'f1-score': 0.43929433205995494, 'support': 70122}, 'weighted avg': {'precision': 0.4963137431869373, 'recall': 0.4659308063090043, 'f1-score': 0.4426956581200655, 'support': 70122}}
[[11443  8807  1381]
 [ 7397 16646  1763]
 [ 6692 11410  4583]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
1359/1359 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2319677
{'0': {'precision': 0.31299230733797045, 'recall': 0.7823171024226433, 'f1-score': 0.44710514266600504, 'support': 104225}, '1': {'precision': 0.4346199855104207, 'recall': 0.17998506869099865, 'f1-score': 0.2545540665890387, 'support': 143323}, '2': {'precision': 0.34774516821760915, 'recall': 0.09691480554197879, 'f1-score': 0.15158393984070892, 'support': 100253}, 'accuracy': 0.3365401479581715, 'macro avg': {'precision': 0.3651191536886668, 'recall': 0.35307232555187357, 'f1-score': 0.2844143830319176, 'support': 347801}, 'weighted avg': {'precision': 0.3731304963612237, 'recall': 0.3365401479581715, 'f1-score': 0.2825746064587386, 'support': 347801}}
[[ 81537  16114   6574]
 [105877  25796  11650]
 [ 73094  17443   9716]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2090605
{'0': {'precision': 0.3375872103214949, 'recall': 0.7782477504175872, 'f1-score': 0.4709056379241484, 'support': 37118}, '1': {'precision': 0.35458594965920676, 'recall': 0.17463128403023737, 'f1-score': 0.23401278622912502, 'support': 37834}, '2': {'precision': 0.3951209118994354, 'recall': 0.0959960659471491, 'f1-score': 0.1544644344494419, 'support': 38637}, 'accuracy': 0.3451302502883202, 'macro avg': {'precision': 0.36243135729337905, 'recall': 0.34962503346499124, 'f1-score': 0.2864609528675718, 'support': 113589}, 'weighted avg': {'precision': 0.3628190543554232, 'recall': 0.3451302502883202, 'f1-score': 0.2843651900842894, 'support': 113589}}
[[28887  5835  2396]
 [27945  6607  3282]
 [28737  6191  3709]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1863956
{'0': {'precision': 0.35179242329367566, 'recall': 0.7256801485428271, 'f1-score': 0.4738659426974881, 'support': 12387}, '1': {'precision': 0.3555439193611729, 'recall': 0.22813943721125576, 'f1-score': 0.27793696275071633, 'support': 11905}, '2': {'precision': 0.3923500434656621, 'recall': 0.10963562753036438, 'f1-score': 0.17138155812923234, 'support': 12350}, 'accuracy': 0.35639430162109054, 'macro avg': {'precision': 0.36656212870683685, 'recall': 0.35448507109481575, 'f1-score': 0.3077281545258123, 'support': 36642}, 'weighted avg': {'precision': 0.36668102571187305, 'recall': 0.35639430162109054, 'f1-score': 0.30825771564426296, 'support': 36642}}
[[8989 2463  935]
 [8027 2716 1162]
 [8536 2460 1354]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.17748
{'0': {'precision': 0.31860941941606413, 'recall': 0.7836859688195991, 'f1-score': 0.4530359723808374, 'support': 93392}, '1': {'precision': 0.34528170733998387, 'recall': 0.17964557654901425, 'f1-score': 0.23633113877173131, 'support': 102307}, '2': {'precision': 0.330061207991685, 'recall': 0.02980001251225158, 'f1-score': 0.054664562712188586, 'support': 95906}, 'accuracy': 0.32381817870063956, 'macro avg': {'precision': 0.33131744491591103, 'recall': 0.33104385262695496, 'f1-score': 0.2480105579549191, 'support': 291605}, 'weighted avg': {'precision': 0.33173353249974225, 'recall': 0.32381817870063956, 'f1-score': 0.24598660824878119, 'support': 291605}}
[[73190 17389  2813]
 [80940 18379  2988]
 [75587 17461  2858]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1717739
{'0': {'precision': 0.3346567520913557, 'recall': 0.7573244388353015, 'f1-score': 0.46419066387939845, 'support': 33279}, '1': {'precision': 0.3169992786727579, 'recall': 0.20241970152920225, 'f1-score': 0.2470718314874159, 'support': 32566}, '2': {'precision': 0.34572169403630076, 'recall': 0.02455946460367164, 'f1-score': 0.04586104104563174, 'support': 32574}, 'accuracy': 0.3311860514738008, 'macro avg': {'precision': 0.3324592416001381, 'recall': 0.32810120165605844, 'f1-score': 0.252374512137482, 'support': 98419}, 'weighted avg': {'precision': 0.3324762395842644, 'recall': 0.3311860514738008, 'f1-score': 0.2538922354269205, 'support': 98419}}
[[25203  7274   802]
 [25262  6592   712]
 [24845  6929   800]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1877321
{'0': {'precision': 0.32859129318643704, 'recall': 0.7846743295019157, 'f1-score': 0.4632086851628468, 'support': 11745}, '1': {'precision': 0.3353206574282952, 'recall': 0.1629600626468285, 'f1-score': 0.21932967959527824, 'support': 12770}, '2': {'precision': 0.29695885509839, 'recall': 0.030582166543846722, 'f1-score': 0.055453482545515284, 'support': 10856}, 'accuracy': 0.32877215798252807, 'macro avg': {'precision': 0.3202902685710407, 'recall': 0.32607218623086365, 'f1-score': 0.24599728243454677, 'support': 35371}, 'weighted avg': {'precision': 0.321312229362533, 'recall': 0.32877215798252807, 'f1-score': 0.25001354279447724, 'support': 35371}}
[[ 9216  2162   367]
 [10270  2081   419]
 [ 8561  1963   332]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
2282/2282 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1936775
{'0': {'precision': 0.3568889869905222, 'recall': 0.7968148125798309, 'f1-score': 0.492976501224251, 'support': 198858}, '1': {'precision': 0.3235793742122856, 'recall': 0.15684514165201363, 'f1-score': 0.21127919624456148, 'support': 188243}, '2': {'precision': 0.42478366074724194, 'recall': 0.10520889412577326, 'f1-score': 0.16864772449727264, 'support': 196894}, 'accuracy': 0.35735408693567583, 'macro avg': {'precision': 0.3684173406500166, 'recall': 0.35295628278587254, 'f1-score': 0.29096780732202837, 'support': 583995}, 'weighted avg': {'precision': 0.36904277676002706, 'recall': 0.35735408693567583, 'f1-score': 0.29282763702819903, 'support': 583995}}
[[158453  28804  11601]
 [142268  29525  16450]
 [143263  32916  20715]]
Evaluating performance on  train set...
878/878 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2003728
{'0': {'precision': 0.34940031546680156, 'recall': 0.7856970767748153, 'f1-score': 0.4836991228467722, 'support': 74712}, '1': {'precision': 0.3541964974116092, 'recall': 0.17238929988206284, 'f1-score': 0.2319078354307143, 'support': 74616}, '2': {'precision': 0.4124963274899618, 'recall': 0.11170191606444341, 'f1-score': 0.1757984911881632, 'support': 75415}, 'accuracy': 0.35590874910453274, 'macro avg': {'precision': 0.3720310467894575, 'recall': 0.35659609757377386, 'f1-score': 0.2971351498218832, 'support': 224743}, 'weighted avg': {'precision': 0.372165240998277, 'recall': 0.35590874910453274, 'f1-score': 0.29678346879583145, 'support': 224743}}
[[58701 11141  4870]
 [54625 12863  7128]
 [54679 12312  8424]]
Evaluating performance on  val set...
303/303 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.212421
{'0': {'precision': 0.3426766405748303, 'recall': 0.7856744926382809, 'f1-score': 0.4772136754202569, 'support': 25130}, '1': {'precision': 0.36241185326043895, 'recall': 0.17029673480025317, 'f1-score': 0.23171225937183387, 'support': 26859}, '2': {'precision': 0.40959461355028753, 'recall': 0.11506028843880527, 'f1-score': 0.1796536130679546, 'support': 25378}, 'accuracy': 0.3520622487623922, 'macro avg': {'precision': 0.37156103579518557, 'recall': 0.35701050529244643, 'f1-score': 0.2961931826200151, 'support': 77367}, 'weighted avg': {'precision': 0.37147848626735963, 'recall': 0.3520622487623922, 'f1-score': 0.2943785933307184, 'support': 77367}}
[[19744  3722  1664]
 [19740  4574  2545]
 [18133  4325  2920]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
5098/5098 - 83s - 83s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9926318
{'0': {'precision': 0.48687308809015817, 'recall': 0.5714993017951435, 'f1-score': 0.5258028885967541, 'support': 416067}, '1': {'precision': 0.46081521119644614, 'recall': 0.6183642380410046, 'f1-score': 0.5280894612115569, 'support': 483799}, '2': {'precision': 0.579073506296356, 'recall': 0.23920798923576392, 'f1-score': 0.33856077600967216, 'support': 405045}, 'accuracy': 0.4857312107875556, 'macro avg': {'precision': 0.5089206018609868, 'recall': 0.476357176357304, 'f1-score': 0.46415104193932777, 'support': 1304911}, 'weighted avg': {'precision': 0.5058311194110899, 'recall': 0.4857312107875556, 'f1-score': 0.4685305995683333, 'support': 1304911}}
[[237782 148297  29988]
 [144194 299164  40441]
 [106410 201745  96890]]
Evaluating performance on  train set...
1876/1876 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98115134
{'0': {'precision': 0.4837204852904765, 'recall': 0.5697158081705151, 'f1-score': 0.5232081121877588, 'support': 150884}, '1': {'precision': 0.48087000840735145, 'recall': 0.6217137128567889, 'f1-score': 0.5422961949513285, 'support': 177556}, '2': {'precision': 0.5901861855274343, 'recall': 0.2836387356935302, 'f1-score': 0.3831423421819719, 'support': 151767}, 'accuracy': 0.4985287594724775, 'macro avg': {'precision': 0.5182588930750874, 'recall': 0.49168941890694473, 'f1-score': 0.48288221644035306, 'support': 480207}, 'weighted avg': {'precision': 0.516314472163642, 'recall': 0.49852875947247755, 'f1-score': 0.4859988293299498, 'support': 480207}}
[[ 85961  52125  12798]
 [ 50074 110389  17093]
 [ 41673  67047  43047]]
Evaluating performance on  val set...
619/619 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9829926
{'0': {'precision': 0.4921927906661765, 'recall': 0.5280989848242645, 'f1-score': 0.5095140808396427, 'support': 48169}, '1': {'precision': 0.4652296310083291, 'recall': 0.6559240307026176, 'f1-score': 0.5443594490118147, 'support': 60972}, '2': {'precision': 0.6147647768395658, 'recall': 0.2588003493733623, 'f1-score': 0.36425753330664995, 'support': 49231}, 'accuracy': 0.49359735306746144, 'macro avg': {'precision': 0.5240623995046905, 'recall': 0.4809411216334149, 'f1-score': 0.47271035438603576, 'support': 158372}, 'weighted avg': {'precision': 0.5199145071352737, 'recall': 0.49359735306746144, 'f1-score': 0.47777530565587856, 'support': 158372}}
[[25438 19498  3233]
 [16228 39993  4751]
 [10017 26473 12741]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
5760/5760 - 86s - 86s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98253715
{'0': {'precision': 0.44946878813954927, 'recall': 0.5612604176421013, 'f1-score': 0.4991822504093953, 'support': 427160}, '1': {'precision': 0.5445722384838945, 'recall': 0.6554335277319586, 'f1-score': 0.5948819804423922, 'support': 638379}, '2': {'precision': 0.5243818422865612, 'recall': 0.2214964835229329, 'f1-score': 0.3114415047888554, 'support': 408932}, 'accuracy': 0.5078024593226995, 'macro avg': {'precision': 0.506140956303335, 'recall': 0.47939680963233094, 'f1-score': 0.4685019118802143, 'support': 1474471}, 'weighted avg': {'precision': 0.5114207631772534, 'recall': 0.5078024593226995, 'f1-score': 0.48854758846666185, 'support': 1474471}}
[[239748 156177  31235]
 [169045 418415  50919]
 [124610 193745  90577]]
Evaluating performance on  train set...
2159/2159 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0318472
{'0': {'precision': 0.44252223626595083, 'recall': 0.6118631779422585, 'f1-score': 0.5135940959409594, 'support': 184824}, '1': {'precision': 0.4369071139481933, 'recall': 0.5242574392948068, 'f1-score': 0.4766130918901161, 'support': 182645}, '2': {'precision': 0.5288010587585286, 'recall': 0.22237531744745231, 'f1-score': 0.3130883958356314, 'support': 185070}, 'accuracy': 0.4524477005243069, 'macro avg': {'precision': 0.46941013632422424, 'recall': 0.4528319782281726, 'f1-score': 0.4344318612222356, 'support': 552539}, 'weighted avg': {'precision': 0.46956475754132604, 'recall': 0.4524477005243069, 'f1-score': 0.4342114905441289, 'support': 552539}}
[[113087  54291  17446]
 [ 67666  95753  19226]
 [ 74798  69117  41155]]
Evaluating performance on  val set...
850/850 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.023121
{'0': {'precision': 0.44293423521803205, 'recall': 0.5958496755330528, 'f1-score': 0.5081369043275196, 'support': 70115}, '1': {'precision': 0.4610232908253631, 'recall': 0.5388058736011385, 'f1-score': 0.4968890002445849, 'support': 77295}, '2': {'precision': 0.5243514439549681, 'recall': 0.24508472152713234, 'f1-score': 0.33403817857595275, 'support': 69935}, 'accuracy': 0.46269755457912537, 'macro avg': {'precision': 0.47610298999945444, 'recall': 0.45991342355377457, 'f1-score': 0.4463546943826857, 'support': 217345}, 'weighted avg': {'precision': 0.47556487335641234, 'recall': 0.46269755457912537, 'f1-score': 0.4481171149073523, 'support': 217345}}
[[41778 21482  6855]
 [26955 41647  8693]
 [25588 27207 17140]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
6315/6315 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0299618
{'0': {'precision': 0.44054288633698313, 'recall': 0.580802871800367, 'f1-score': 0.5010420251852329, 'support': 522599}, '1': {'precision': 0.46732309832677477, 'recall': 0.5564587757924047, 'f1-score': 0.5080106334528803, 'support': 584329}, '2': {'precision': 0.5229113071703586, 'recall': 0.23776775515491233, 'f1-score': 0.3268959376138372, 'support': 509514}, 'accuracy': 0.46387559838212566, 'macro avg': {'precision': 0.4769257639447055, 'recall': 0.45834313424922807, 'f1-score': 0.44531619875065015, 'support': 1616442}, 'weighted avg': {'precision': 0.4761867993658944, 'recall': 0.46387559838212566, 'f1-score': 0.44866902957980687, 'support': 1616442}}
[[303527 168969  50103]
 [198747 325155  60427]
 [186710 201658 121146]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0503639
{'0': {'precision': 0.4243122713834745, 'recall': 0.6479101084295208, 'f1-score': 0.5127969998313054, 'support': 182976}, '1': {'precision': 0.4356782561241196, 'recall': 0.46943452217398474, 'f1-score': 0.4519269175931584, 'support': 181970}, '2': {'precision': 0.5253043089623262, 'recall': 0.21416436667649186, 'f1-score': 0.30427648485356096, 'support': 186595}, 'accuracy': 0.4422826226880685, 'macro avg': {'precision': 0.46176494548997343, 'recall': 0.4438363324266658, 'f1-score': 0.42300013409267495, 'support': 551541}, 'weighted avg': {'precision': 0.46222944797647664, 'recall': 0.4422826226880685, 'f1-score': 0.4221683532626046, 'support': 551541}}
[[118552  47545  16879]
 [ 77314  85423  19233]
 [ 83532  63101  39962]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0379696
{'0': {'precision': 0.4382564262495652, 'recall': 0.590621059778216, 'f1-score': 0.5031570394750432, 'support': 61862}, '1': {'precision': 0.4443536884196667, 'recall': 0.5460197141744315, 'f1-score': 0.48996847715770164, 'support': 66754}, '2': {'precision': 0.5360044167521097, 'recall': 0.21873893591683027, 'f1-score': 0.31068848861662246, 'support': 62138}, 'accuracy': 0.45387252691948793, 'macro avg': {'precision': 0.47287151047378057, 'recall': 0.45179323662315934, 'f1-score': 0.43460466841645573, 'support': 190754}, 'weighted avg': {'precision': 0.47223150028602096, 'recall': 0.45387252691948793, 'f1-score': 0.4358452132372062, 'support': 190754}}
[[36537 20135  5190]
 [23729 36449  6576]
 [23103 25443 13592]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
6082/6082 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0607737
{'0': {'precision': 0.40333667109878146, 'recall': 0.7282472100154911, 'f1-score': 0.5191463228256452, 'support': 506096}, '1': {'precision': 0.5012872018169618, 'recall': 0.3246910527119717, 'f1-score': 0.39411078530587734, 'support': 549932}, '2': {'precision': 0.4723485112614183, 'recall': 0.2705381248302634, 'f1-score': 0.34403171168974955, 'support': 500776}, 'accuracy': 0.4384623883289097, 'macro avg': {'precision': 0.4589907947257205, 'recall': 0.4411587958525754, 'f1-score': 0.41909627327375737, 'support': 1556804}, 'weighted avg': {'precision': 0.4601361169687786, 'recall': 0.4384623883289097, 'f1-score': 0.41864925464910513, 'support': 1556804}}
[[368563  75333  62200]
 [282233 178558  89141]
 [262989 102308 135479]]
Evaluating performance on  train set...
2440/2440 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1263722
{'0': {'precision': 0.3753007705132249, 'recall': 0.7967866606717496, 'f1-score': 0.5102599682046665, 'support': 209066}, '1': {'precision': 0.4528343615411477, 'recall': 0.18887151901192373, 'f1-score': 0.2665629732155705, 'support': 205976}, '2': {'precision': 0.44227301011422004, 'recall': 0.20012407836025675, 'f1-score': 0.27556002391888607, 'support': 209545}, 'accuracy': 0.39613216413405977, 'macro avg': {'precision': 0.4234693807228642, 'recall': 0.39526075268131006, 'f1-score': 0.35079432177970765, 'support': 624587}, 'weighted avg': {'precision': 0.4233385248897297, 'recall': 0.39613216413405977, 'f1-score': 0.3511533392398659, 'support': 624587}}
[[166581  20470  22015]
 [136206  38903  30867]
 [141073  26537  41935]]
Evaluating performance on  val set...
826/826 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977796
{'0': {'precision': 0.39856744244049197, 'recall': 0.7106210308361474, 'f1-score': 0.5106984315624954, 'support': 71961}, '1': {'precision': 0.43764972621492126, 'recall': 0.2837077093732668, 'f1-score': 0.344252641496736, 'support': 72120}, '2': {'precision': 0.4438764291996482, 'recall': 0.23976721053491099, 'f1-score': 0.3113523100799105, 'support': 67357}, 'accuracy': 0.41500581730814706, 'macro avg': {'precision': 0.4266978659516871, 'recall': 0.411365316914775, 'f1-score': 0.3887677943797139, 'support': 211438}, 'weighted avg': {'precision': 0.42633204353844184, 'recall': 0.41500581730814706, 'f1-score': 0.3904200185797532, 'support': 211438}}
[[51137 12341  8483]
 [39908 20461 11751]
 [37257 13950 16150]]
testing model on single stock: results/universal/W3/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
13689/13689 - 198s - 198s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1792387
{'0': {'precision': 0.35902226487715216, 'recall': 0.8838340154251397, 'f1-score': 0.5106239474707772, 'support': 1223198}, '1': {'precision': 0.30772261068981527, 'recall': 0.04138943766983824, 'f1-score': 0.07296491699206534, 'support': 1056888}, '2': {'precision': 0.4212320470176459, 'recall': 0.12072604888249902, 'f1-score': 0.18766646751411264, 'support': 1224160}, 'accuracy': 0.36316970897591094, 'macro avg': {'precision': 0.3626589741948711, 'recall': 0.34864983399249233, 'f1-score': 0.25708511065898504, 'support': 3504246}, 'weighted avg': {'precision': 0.36528230997397493, 'recall': 0.36316970897591094, 'f1-score': 0.26580431834989493, 'support': 3504246}}
[[1081104   47728   94366]
 [ 904451   43744  108693]
 [1025690   50682  147788]]
Evaluating performance on  train set...
5475/5475 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1981936
{'0': {'precision': 0.3431180164090654, 'recall': 0.894833799025454, 'f1-score': 0.49603481219442075, 'support': 469552}, '1': {'precision': 0.37231318565153043, 'recall': 0.03452986313546582, 'f1-score': 0.06319844167133541, 'support': 458994}, '2': {'precision': 0.39212973294651493, 'recall': 0.11144137668597523, 'f1-score': 0.17355831755700057, 'support': 473020}, 'accuracy': 0.3487056620951136, 'macro avg': {'precision': 0.3691869783357036, 'recall': 0.346935012948965, 'f1-score': 0.24426385714091892, 'support': 1401566}, 'weighted avg': {'precision': 0.36922019758913144, 'recall': 0.3487056620951136, 'f1-score': 0.24545287131881052, 'support': 1401566}}
[[420171  12899  36482]
 [397911  15849  45234]
 [406485  13821  52714]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2032974
{'0': {'precision': 0.33625529577553565, 'recall': 0.8846798505120141, 'f1-score': 0.4872958006084184, 'support': 168843}, '1': {'precision': 0.4147368421052632, 'recall': 0.04604580119476651, 'f1-score': 0.08288893020343062, 'support': 183969}, '2': {'precision': 0.3869257013558663, 'recall': 0.12997315978242796, 'f1-score': 0.19458335000200022, 'support': 168404}, 'accuracy': 0.3448301663801572, 'macro avg': {'precision': 0.3793059464122217, 'recall': 0.3535662704964029, 'f1-score': 0.2549226936046164, 'support': 521216}, 'weighted avg': {'precision': 0.3803277543686787, 'recall': 0.3448301663801572, 'f1-score': 0.24998099240326266, 'support': 521216}}
[[149372   5722  13749]
 [154566   8471  20932]
 [140284   6232  21888]]
training model: results/universal/W3/deepVOL_L3/h200
Epoch 1/50
10532/10532 - 574s - loss: 3.2712 - accuracy200: 0.3757 - val_loss: 3.3027 - val_accuracy200: 0.3486 - 574s/epoch - 55ms/step
Epoch 2/50
10532/10532 - 578s - loss: 3.2534 - accuracy200: 0.3868 - val_loss: 3.3069 - val_accuracy200: 0.3526 - 578s/epoch - 55ms/step
Epoch 3/50
10532/10532 - 565s - loss: 3.2456 - accuracy200: 0.3926 - val_loss: 3.3017 - val_accuracy200: 0.3522 - 565s/epoch - 54ms/step
Epoch 4/50
10532/10532 - 564s - loss: 3.2374 - accuracy200: 0.3973 - val_loss: 3.3081 - val_accuracy200: 0.3526 - 564s/epoch - 54ms/step
Epoch 5/50
10532/10532 - 568s - loss: 3.2329 - accuracy200: 0.4000 - val_loss: 3.3196 - val_accuracy200: 0.3526 - 568s/epoch - 54ms/step
Epoch 6/50
10532/10532 - 568s - loss: 3.2291 - accuracy200: 0.4021 - val_loss: 3.3378 - val_accuracy200: 0.3509 - 568s/epoch - 54ms/step
Epoch 7/50
10532/10532 - 582s - loss: 3.2253 - accuracy200: 0.4041 - val_loss: 3.3537 - val_accuracy200: 0.3495 - 582s/epoch - 55ms/step
Epoch 8/50
10532/10532 - 570s - loss: 3.2203 - accuracy200: 0.4066 - val_loss: 3.4307 - val_accuracy200: 0.3486 - 570s/epoch - 54ms/step
Epoch 9/50
10532/10532 - 563s - loss: 3.2153 - accuracy200: 0.4086 - val_loss: 3.4582 - val_accuracy200: 0.3473 - 563s/epoch - 53ms/step
Epoch 10/50
10532/10532 - 574s - loss: 3.2107 - accuracy200: 0.4105 - val_loss: 3.4668 - val_accuracy200: 0.3467 - 574s/epoch - 55ms/step
Epoch 11/50
10532/10532 - 569s - loss: 3.2079 - accuracy200: 0.4120 - val_loss: 3.4163 - val_accuracy200: 0.3484 - 569s/epoch - 54ms/step
Epoch 12/50
10532/10532 - 597s - loss: 3.2059 - accuracy200: 0.4126 - val_loss: 3.3993 - val_accuracy200: 0.3500 - 597s/epoch - 57ms/step
Epoch 13/50
10532/10532 - 594s - loss: 3.2027 - accuracy200: 0.4137 - val_loss: 3.3805 - val_accuracy200: 0.3485 - 594s/epoch - 56ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 843s - 843s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099717
{'0': {'precision': 0.3881738943027109, 'recall': 0.33312007774721397, 'f1-score': 0.3585459545213215, 'support': 2378992}, '1': {'precision': 0.3334978697871326, 'recall': 0.6551944897951473, 'f1-score': 0.44201002369486714, 'support': 2382053}, '2': {'precision': 0.4502763792942878, 'recall': 0.07069052115907926, 'f1-score': 0.12219690690612561, 'support': 2325432}, 'accuracy': 0.3552659523201726, 'macro avg': {'precision': 0.39064938112804376, 'recall': 0.35300169623381344, 'f1-score': 0.3075842950407714, 'support': 7086477}, 'weighted avg': {'precision': 0.3901740302875628, 'recall': 0.3552659523201726, 'f1-score': 0.3090435286859102, 'support': 7086477}}
[[ 792490 1508846   77656]
 [ 698309 1560708  123036]
 [ 550786 1610260  164386]]
Evaluating performance on  train set...
10532/10532 - 319s - 319s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049179
{'0': {'precision': 0.3798628750661832, 'recall': 0.3132451414511426, 'f1-score': 0.34335254302795915, 'support': 904694}, '1': {'precision': 0.3247097372386951, 'recall': 0.6706446853173715, 'f1-score': 0.43756244934485083, 'support': 885114}, '2': {'precision': 0.45858260469397144, 'recall': 0.06159381898454746, 'f1-score': 0.10860105401639407, 'support': 906000}, 'accuracy': 0.34601573999335267, 'macro avg': {'precision': 0.38771840566628324, 'recall': 0.34849454858435386, 'f1-score': 0.2965053487964014, 'support': 2695808}, 'weighted avg': {'precision': 0.3882103763005949, 'recall': 0.34601573999335267, 'f1-score': 0.2953898016069422, 'support': 2695808}}
[[283391 595858  25445]
 [251078 593597  40439]
 [211566 638630  55804]]
Evaluating performance on  val set...
3814/3814 - 111s - 111s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013714
{'0': {'precision': 0.37578126945392065, 'recall': 0.3279796574806572, 'f1-score': 0.3502570470343851, 'support': 322084}, '1': {'precision': 0.33472874800380314, 'recall': 0.6552000361375032, 'f1-score': 0.44309104109664366, 'support': 332065}, '2': {'precision': 0.45779685264663805, 'recall': 0.06366456731098027, 'f1-score': 0.11178368111085034, 'support': 321686}, 'accuracy': 0.35219683655536027, 'macro avg': {'precision': 0.3894356233681206, 'recall': 0.3489480869763803, 'f1-score': 0.30171058974729303, 'support': 975835}, 'weighted avg': {'precision': 0.38884819097200435, 'recall': 0.35219683655536027, 'f1-score': 0.30323411492783603, 'support': 975835}}
[[105637 207566   8881]
 [ 99121 217569  15375]
 [ 76355 224851  20480]]
testing model out of sample: results/universal/W3/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 467s - 467s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093463
{'0': {'precision': 0.39149501316298513, 'recall': 0.3644016005234564, 'f1-score': 0.3774627556480144, 'support': 1366303}, '1': {'precision': 0.3499472667319972, 'recall': 0.6316406841229, 'f1-score': 0.450374173344377, 'support': 1453540}, '2': {'precision': 0.4213756666417842, 'recall': 0.0771733681700111, 'f1-score': 0.13045448767905587, 'support': 1316620}, 'accuracy': 0.36688494493967433, 'macro avg': {'precision': 0.38760598217892217, 'recall': 0.35773855093878915, 'f1-score': 0.31943047222381576, 'support': 4136463}, 'weighted avg': {'precision': 0.3864061618027671, 'recall': 0.36688494493967433, 'f1-score': 0.32446183101870685, 'support': 4136463}}
[[497883 819404  49016]
 [444915 918115  90510]
 [328950 886062 101608]]
Evaluating performance on  train set...
6181/6181 - 184s - 184s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050265
{'0': {'precision': 0.3762593806563231, 'recall': 0.3486093912620695, 'f1-score': 0.36190703401418217, 'support': 526532}, '1': {'precision': 0.3263041533596466, 'recall': 0.6351325551469886, 'f1-score': 0.4311181148893211, 'support': 523782}, '2': {'precision': 0.41799666827878984, 'recall': 0.0585429551454166, 'f1-score': 0.10270189087800313, 'support': 531473}, 'accuracy': 0.34602572912787877, 'macro avg': {'precision': 0.37352006743158656, 'recall': 0.34742830051815826, 'f1-score': 0.2985756799271688, 'support': 1581787}, 'weighted avg': {'precision': 0.373741084957008, 'recall': 0.34602572912787877, 'f1-score': 0.2977334021186915, 'support': 1581787}}
[[183554 326447  16531]
 [164320 332671  26791]
 [139965 360394  31114]]
Evaluating performance on  val set...
2209/2209 - 61s - 61s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996224
{'0': {'precision': 0.3961215675758942, 'recall': 0.36056626211953613, 'f1-score': 0.37750857714537384, 'support': 192561}, '1': {'precision': 0.32959220801029976, 'recall': 0.6289220843725466, 'f1-score': 0.432518993409007, 'support': 187241}, '2': {'precision': 0.4222146211014024, 'recall': 0.07342475827907681, 'f1-score': 0.12509500974281726, 'support': 184924}, 'accuracy': 0.3555157722506136, 'macro avg': {'precision': 0.38264279889586544, 'recall': 0.3543043682570532, 'f1-score': 0.3117075267657327, 'support': 564726}, 'weighted avg': {'precision': 0.3826074173786828, 'recall': 0.3555157722506136, 'f1-score': 0.31309305318024483, 'support': 564726}}
[[ 69431 115907   7223]
 [ 58123 117760  11358]
 [ 47723 123623  13578]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996559
{'0': {'precision': 0.349811395672027, 'recall': 0.218478761469515, 'f1-score': 0.2689695026877324, 'support': 56454}, '1': {'precision': 0.3668795338502965, 'recall': 0.7811124512460644, 'f1-score': 0.49926162502565535, 'support': 63841}, '2': {'precision': 0.3649932157394844, 'recall': 0.01519859879089214, 'f1-score': 0.02918203514862226, 'support': 53097}, 'accuracy': 0.3633847005628864, 'macro avg': {'precision': 0.360561381753936, 'recall': 0.33826327050215726, 'f1-score': 0.26580438762067, 'support': 173392}, 'weighted avg': {'precision': 0.3607447496304605, 'recall': 0.3633847005628864, 'f1-score': 0.28033152756922175, 'support': 173392}}
[[12334 43694   426]
 [12996 49867   978]
 [ 9929 42361   807]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140935
{'0': {'precision': 0.3242139897635876, 'recall': 0.24259141059542264, 'f1-score': 0.27752568716424136, 'support': 21934}, '1': {'precision': 0.32823858716446164, 'recall': 0.7436131386861314, 'f1-score': 0.4554408415876165, 'support': 21920}, '2': {'precision': 0.3062015503875969, 'recall': 0.003515016685205784, 'f1-score': 0.0069502485373685845, 'support': 22475}, 'accuracy': 0.32715705046058285, 'macro avg': {'precision': 0.31955137577188203, 'recall': 0.32990652198891995, 'f1-score': 0.24663892576307547, 'support': 66329}, 'weighted avg': {'precision': 0.3194406568330711, 'recall': 0.32715705046058285, 'f1-score': 0.24463987857103803, 'support': 66329}}
[[ 5321 16531    82]
 [ 5523 16300    97]
 [ 5568 16828    79]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086581
{'0': {'precision': 0.3665706051873199, 'recall': 0.16383307573415765, 'f1-score': 0.2264554032401638, 'support': 7764}, '1': {'precision': 0.3317597980019761, 'recall': 0.8349219505456554, 'f1-score': 0.4748399261499784, 'support': 7239}, '2': {'precision': 0.34146341463414637, 'recall': 0.012119463280911845, 'f1-score': 0.02340810923784311, 'support': 6931}, 'accuracy': 0.33737576365460015, 'macro avg': {'precision': 0.34659793927448074, 'recall': 0.3369581631869083, 'f1-score': 0.24156781287599507, 'support': 21934}, 'weighted avg': {'precision': 0.3471480935187346, 'recall': 0.33737576365460015, 'f1-score': 0.2442695167905451, 'support': 21934}}
[[1272 6408   84]
 [1117 6044   78]
 [1081 5766   84]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0691206
{'0': {'precision': 0.4011243266693178, 'recall': 0.3882803751399776, 'f1-score': 0.3945978626171382, 'support': 114304}, '1': {'precision': 0.4066791346397601, 'recall': 0.5790090163711149, 'f1-score': 0.47777968211332544, 'support': 146844}, '2': {'precision': 0.44243341404358355, 'recall': 0.20279306358381502, 'f1-score': 0.27811142467577765, 'support': 108125}, 'accuracy': 0.409813335933036, 'macro avg': {'precision': 0.4167456251175538, 'recall': 0.39002748503163587, 'f1-score': 0.38349632313541376, 'support': 369273}, 'weighted avg': {'precision': 0.4154287445226515, 'recall': 0.409813335933036, 'f1-score': 0.39356787937896076, 'support': 369273}}
[[44382 60963  8959]
 [43146 85024 18674]
 [23116 63082 21927]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095899
{'0': {'precision': 0.39353739329850934, 'recall': 0.44587791631331086, 'f1-score': 0.4180758461421333, 'support': 55421}, '1': {'precision': 0.32511192790812177, 'recall': 0.5202279306680347, 'f1-score': 0.4001522080740746, 'support': 54578}, '2': {'precision': 0.4453763440860215, 'recall': 0.11489385309564316, 'f1-score': 0.1826654514450357, 'support': 54076}, 'accuracy': 0.3615236934328813, 'macro avg': {'precision': 0.3880085550975509, 'recall': 0.3603332333589963, 'f1-score': 0.33363116855374786, 'support': 164075}, 'weighted avg': {'precision': 0.38786144054951616, 'recall': 0.3615236934328813, 'f1-score': 0.33452692752492313, 'support': 164075}}
[[24711 27670  3040]
 [21488 28393  4697]
 [16593 31270  6213]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0901307
{'0': {'precision': 0.3768829768110732, 'recall': 0.47882884940391907, 'f1-score': 0.42178321396958235, 'support': 21893}, '1': {'precision': 0.3469240950681936, 'recall': 0.4829754846979651, 'f1-score': 0.4037978498945042, 'support': 24964}, '2': {'precision': 0.46021448431086986, 'recall': 0.14940898345153664, 'f1-score': 0.22558245181387498, 'support': 23265}, 'accuracy': 0.37101052451441774, 'macro avg': {'precision': 0.39467385206337885, 'recall': 0.3704044391844736, 'f1-score': 0.3503878385593205, 'support': 70122}, 'weighted avg': {'precision': 0.3938650081015886, 'recall': 0.37101052451441774, 'f1-score': 0.350285005699385, 'support': 70122}}
[[10483 10004  1406]
 [10236 12057  2671]
 [ 7096 12693  3476]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
1359/1359 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0827186
{'0': {'precision': 0.29261467801385593, 'recall': 0.30666397006775203, 'f1-score': 0.29947464054352985, 'support': 98890}, '1': {'precision': 0.4232822346482052, 'recall': 0.6497528124878352, 'f1-score': 0.5126185266229031, 'support': 154134}, '2': {'precision': 0.32967468923565196, 'recall': 0.026303850090211762, 'f1-score': 0.04872042916190309, 'support': 94777}, 'accuracy': 0.38231057415016056, 'macro avg': {'precision': 0.3485238672992377, 'recall': 0.32757354421526635, 'f1-score': 0.28693786544277866, 'support': 347801}, 'weighted avg': {'precision': 0.36062123882836467, 'recall': 0.38231057415016056, 'f1-score': 0.32560161500548274, 'support': 347801}}
[[ 30326  67118   1446]
 [ 50362 100149   3623]
 [ 22950  69334   2493]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1153114
{'0': {'precision': 0.3392348789143236, 'recall': 0.23370587287088282, 'f1-score': 0.27675176966515547, 'support': 37222}, '1': {'precision': 0.3220281716396174, 'recall': 0.735086832797, 'f1-score': 0.4478579298723184, 'support': 37601}, '2': {'precision': 0.30638297872340425, 'recall': 0.016715678687509672, 'f1-score': 0.03170176854773611, 'support': 38766}, 'accuracy': 0.3256213189657449, 'macro avg': {'precision': 0.3225486764257817, 'recall': 0.32850279478513084, 'f1-score': 0.25210382269507, 'support': 113589}, 'weighted avg': {'precision': 0.322327201559673, 'recall': 0.3256213189657449, 'f1-score': 0.24976107854745616, 'support': 113589}}
[[ 8699 27988   535]
 [ 9029 27640   932]
 [ 7915 30203   648]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1102114
{'0': {'precision': 0.34260662481056503, 'recall': 0.25511849105271645, 'f1-score': 0.29245980410275363, 'support': 12406}, '1': {'precision': 0.32421433416233325, 'recall': 0.706287965851256, 'f1-score': 0.44442148760330574, 'support': 12182}, '2': {'precision': 0.30484988452655887, 'recall': 0.021901443504230962, 'f1-score': 0.040866873065015484, 'support': 12054}, 'accuracy': 0.32839364663500903, 'macro avg': {'precision': 0.3238902811664857, 'recall': 0.3277693001360678, 'f1-score': 0.259249388257025, 'support': 36642}, 'weighted avg': {'precision': 0.3240712110214659, 'recall': 0.32839364663500903, 'f1-score': 0.26021527699383024, 'support': 36642}}
[[3165 9020  221]
 [3197 8604  381]
 [2876 8914  264]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1099764
{'0': {'precision': 0.29557461682167896, 'recall': 0.1617242971137148, 'f1-score': 0.20906061962305436, 'support': 90982}, '1': {'precision': 0.36352457998327387, 'recall': 0.8236248686777727, 'f1-score': 0.5044148144743872, 'support': 106608}, '2': {'precision': 0.22377622377622378, 'recall': 0.0006807424347178642, 'f1-score': 0.001357355701424163, 'support': 94015}, 'accuracy': 0.3517875207901099, 'macro avg': {'precision': 0.2942918068603922, 'recall': 0.3286766360754018, 'f1-score': 0.2382775965996219, 'support': 291605}, 'weighted avg': {'precision': 0.29726829062892796, 'recall': 0.3517875207901099, 'f1-score': 0.25007465452341215, 'support': 291605}}
[[14714 76189    79]
 [18660 87805   143]
 [16407 77544    64]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1171639
{'0': {'precision': 0.32510363326018044, 'recall': 0.16276017823353475, 'f1-score': 0.21692088671954443, 'support': 32766}, '1': {'precision': 0.33001500567287634, 'recall': 0.8334411683150014, 'f1-score': 0.4728121231188716, 'support': 32457}, '2': {'precision': 0.15217391304347827, 'recall': 0.00021086877937100855, 'f1-score': 0.000421153961855484, 'support': 33196}, 'accuracy': 0.32911328097217, 'macro avg': {'precision': 0.2690975173255117, 'recall': 0.3321374051093024, 'f1-score': 0.23005138793342383, 'support': 98419}, 'weighted avg': {'precision': 0.26839541047886, 'recall': 0.32911328097217, 'f1-score': 0.22828593545189, 'support': 98419}}
[[ 5333 27420    13]
 [ 5380 27051    26]
 [ 5691 27498     7]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101896
{'0': {'precision': 0.3235701906412478, 'recall': 0.16243257351661736, 'f1-score': 0.2162882298424467, 'support': 11494}, '1': {'precision': 0.37253509216979536, 'recall': 0.8347101174687381, 'f1-score': 0.5151543498596819, 'support': 13195}, '2': {'precision': 0.2222222222222222, 'recall': 0.0007489234225800412, 'f1-score': 0.0014928158238477329, 'support': 10682}, 'accuracy': 0.3643945605156767, 'macro avg': {'precision': 0.3061091683444218, 'recall': 0.3326305381359785, 'f1-score': 0.24431179850865878, 'support': 35371}, 'weighted avg': {'precision': 0.3112293712416592, 'recall': 0.3643945605156767, 'f1-score': 0.2629109954153947, 'support': 35371}}
[[ 1867  9615    12]
 [ 2165 11014    16]
 [ 1738  8936     8]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
2282/2282 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1185279
{'0': {'precision': 0.3986137277865472, 'recall': 0.29467507963619083, 'f1-score': 0.3388531034165582, 'support': 212529}, '1': {'precision': 0.2823651797804065, 'recall': 0.7093818596359315, 'f1-score': 0.4039431999654711, 'support': 164914}, '2': {'precision': 0.4045497931912186, 'recall': 0.02462333940121616, 'f1-score': 0.04642120443219365, 'support': 206552}, 'accuracy': 0.3162698310773209, 'macro avg': {'precision': 0.3618429002527241, 'recall': 0.34289342622444613, 'f1-score': 0.26307250260474097, 'support': 583995}, 'weighted avg': {'precision': 0.367885884458404, 'recall': 0.3162698310773209, 'f1-score': 0.25380421529807945, 'support': 583995}}
[[ 62627 146549   3353]
 [ 43794 116987   4133]
 [ 50691 150775   5086]]
Evaluating performance on  train set...
878/878 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1129763
{'0': {'precision': 0.343036520444653, 'recall': 0.2836575771361289, 'f1-score': 0.3105339866265316, 'support': 74738}, '1': {'precision': 0.314600603461966, 'recall': 0.670039910708246, 'f1-score': 0.42816633526411346, 'support': 73915}, '2': {'precision': 0.3643284393692224, 'recall': 0.02641608621369431, 'f1-score': 0.04926048010587327, 'support': 76090}, 'accuracy': 0.3236407808029616, 'macro avg': {'precision': 0.34065518775861375, 'recall': 0.32670452468602307, 'f1-score': 0.2626536006655061, 'support': 224743}, 'weighted avg': {'precision': 0.34089301122387716, 'recall': 0.3236407808029616, 'f1-score': 0.2607637777140848, 'support': 224743}}
[[21200 52277  1261]
 [22143 49526  2246]
 [18458 55622  2010]]
Evaluating performance on  val set...
303/303 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1151254
{'0': {'precision': 0.3562022285661663, 'recall': 0.2948845010291988, 'f1-score': 0.322655989322656, 'support': 26234}, '1': {'precision': 0.31621973929236497, 'recall': 0.6811472121941436, 'f1-score': 0.4319216584001017, 'support': 24930}, '2': {'precision': 0.3683940482298615, 'recall': 0.027401442582910353, 'f1-score': 0.05100880932082978, 'support': 26203}, 'accuracy': 0.32875773908772477, 'macro avg': {'precision': 0.34693867202946427, 'recall': 0.33447771860208425, 'f1-score': 0.26852881901452913, 'support': 77367}, 'weighted avg': {'precision': 0.3474478344840891, 'recall': 0.32875773908772477, 'f1-score': 0.26586203418044896, 'support': 77367}}
[[ 7736 17981   517]
 [ 7235 16981   714]
 [ 6747 18738   718]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
5098/5098 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0801644
{'0': {'precision': 0.4321448050043022, 'recall': 0.49228308873831134, 'f1-score': 0.46025781097636415, 'support': 445839}, '1': {'precision': 0.33597461640168585, 'recall': 0.49294304402012246, 'f1-score': 0.3995966258898704, 'support': 439708}, '2': {'precision': 0.4736350049708007, 'recall': 0.17154309859692296, 'f1-score': 0.2518647669763379, 'support': 419364}, 'accuracy': 0.3894280912644617, 'macro avg': {'precision': 0.41391814212559624, 'recall': 0.38558974378511895, 'f1-score': 0.37057306794752415, 'support': 1304911}, 'weighted avg': {'precision': 0.41307277245087237, 'recall': 0.3894280912644617, 'f1-score': 0.37284514537998326, 'support': 1304911}}
[[219479 197062  29298]
 [172307 216751  50650]
 [116097 231328  71939]]
Evaluating performance on  train set...
1876/1876 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0851356
{'0': {'precision': 0.4306449738524114, 'recall': 0.4548238427502746, 'f1-score': 0.442404290690074, 'support': 162951}, '1': {'precision': 0.3166755756664139, 'recall': 0.4943688667222988, 'f1-score': 0.38605663827680625, 'support': 154587}, '2': {'precision': 0.47538111354038753, 'recall': 0.19515088922904794, 'f1-score': 0.2767087824203411, 'support': 162669}, 'accuracy': 0.3795904682772221, 'macro avg': {'precision': 0.40756722101973764, 'recall': 0.3814478662338738, 'f1-score': 0.3683899037957405, 'support': 480207}, 'weighted avg': {'precision': 0.40911050173835345, 'recall': 0.3795904682772221, 'f1-score': 0.3681360330879586, 'support': 480207}}
[[74114 75477 13360]
 [56491 76423 21673]
 [41495 89429 31745]]
Evaluating performance on  val set...
619/619 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0773036
{'0': {'precision': 0.42461112223779957, 'recall': 0.49347299001066824, 'f1-score': 0.4564595275901356, 'support': 51555}, '1': {'precision': 0.3396666114839482, 'recall': 0.4913421508307851, 'f1-score': 0.40166248785886927, 'support': 54286}, '2': {'precision': 0.4951578102263034, 'recall': 0.18785098322895052, 'f1-score': 0.2723709632900911, 'support': 52531}, 'accuracy': 0.3913696865607557, 'macro avg': {'precision': 0.41981184798268373, 'recall': 0.390888708023468, 'f1-score': 0.37683099291303196, 'support': 158372}, 'weighted avg': {'precision': 0.4188941416853062, 'recall': 0.3913696865607557, 'f1-score': 0.37661543602030534, 'support': 158372}}
[[25441 22768  3346]
 [20898 26673  6715]
 [13577 29086  9868]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
5760/5760 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0843383
{'0': {'precision': 0.41356830703744457, 'recall': 0.41046959514833636, 'f1-score': 0.4120131248952446, 'support': 488080}, '1': {'precision': 0.35861854034451496, 'recall': 0.6003430043615433, 'f1-score': 0.4490151521063748, 'support': 527107}, '2': {'precision': 0.41980343341260407, 'recall': 0.09839445745987233, 'f1-score': 0.15942299958372433, 'support': 459284}, 'accuracy': 0.38113872704176616, 'macro avg': {'precision': 0.3973300935981879, 'recall': 0.36973568565658393, 'f1-score': 0.34015042552844793, 'support': 1474471}, 'weighted avg': {'precision': 0.39586655984124924, 'recall': 0.38113872704176616, 'f1-score': 0.346561464227521, 'support': 1474471}}
[[200342 268175  19563]
 [167768 316445  42894]
 [116313 297780  45191]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960917
{'0': {'precision': 0.40212074368964934, 'recall': 0.41189165740313965, 'f1-score': 0.4069475584700157, 'support': 184415}, '1': {'precision': 0.33261533929820686, 'recall': 0.5878984104257846, 'f1-score': 0.42485846477639494, 'support': 184389}, '2': {'precision': 0.438929375910958, 'recall': 0.0901461343783166, 'f1-score': 0.14957330563959, 'support': 183735}, 'accuracy': 0.36363767987418083, 'macro avg': {'precision': 0.39122181963293806, 'recall': 0.36331206740241356, 'f1-score': 0.3271264429620002, 'support': 552539}, 'weighted avg': {'precision': 0.3911658645423827, 'recall': 0.36363767987418083, 'f1-score': 0.3273403556465565, 'support': 552539}}
[[ 75959 100445   8011]
 [ 62826 108402  13161]
 [ 50111 117061  16563]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950725
{'0': {'precision': 0.41234605868291935, 'recall': 0.3988587808967494, 'f1-score': 0.4054902985023335, 'support': 73956}, '1': {'precision': 0.3205101673220048, 'recall': 0.5932693944725044, 'f1-score': 0.4161810590641499, 'support': 70484}, '2': {'precision': 0.46000912587184667, 'recall': 0.09679720183800837, 'f1-score': 0.1599392607030347, 'support': 72905}, 'accuracy': 0.3605834042651085, 'macro avg': {'precision': 0.3976217839589236, 'recall': 0.3629751257357541, 'f1-score': 0.3272035394231727, 'support': 217345}, 'weighted avg': {'precision': 0.39855192928829813, 'recall': 0.3605834042651085, 'f1-score': 0.32659098706973183, 'support': 217345}}
[[29498 41314  3144]
 [23528 41816  5140]
 [18511 47337  7057]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
6315/6315 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09688
{'0': {'precision': 0.41152116534936095, 'recall': 0.4097929492765009, 'f1-score': 0.41065523904952766, 'support': 560056}, '1': {'precision': 0.3212186390646293, 'recall': 0.578732877568966, 'f1-score': 0.4131328941142213, 'support': 519713}, '2': {'precision': 0.4469202987367423, 'recall': 0.10191494634535368, 'f1-score': 0.1659800775352588, 'support': 536673}, 'accuracy': 0.3618917350576142, 'macro avg': {'precision': 0.3932200343835775, 'recall': 0.36348025773027354, 'f1-score': 0.3299227368996693, 'support': 1616442}, 'weighted avg': {'precision': 0.3942402250306791, 'recall': 0.3618917350576142, 'f1-score': 0.330217534876591, 'support': 1616442}}
[[229507 302224  28325]
 [179576 300775  39362]
 [148621 333357  54695]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990225
{'0': {'precision': 0.3957830959087317, 'recall': 0.4271607908319482, 'f1-score': 0.41087374964500956, 'support': 182896}, '1': {'precision': 0.33172529541879825, 'recall': 0.5868393611766642, 'f1-score': 0.4238557602928556, 'support': 182210}, '2': {'precision': 0.4660755832232912, 'recall': 0.07951296698581276, 'f1-score': 0.13584981740369592, 'support': 186435}, 'accuracy': 0.36239916887411816, 'macro avg': {'precision': 0.39786132485027376, 'recall': 0.3645043729981417, 'f1-score': 0.32352644244718703, 'support': 551541}, 'weighted avg': {'precision': 0.3983812854272247, 'recall': 0.36239916887411816, 'f1-score': 0.3221974143457928, 'support': 551541}}
[[ 78126  98043   6727]
 [ 65027 106928  10255]
 [ 54243 117368  14824]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952034
{'0': {'precision': 0.4061020680978218, 'recall': 0.4068891620182156, 'f1-score': 0.40649523404724236, 'support': 63462}, '1': {'precision': 0.3401493752924255, 'recall': 0.6114762779975702, 'f1-score': 0.43713254943880275, 'support': 64202}, '2': {'precision': 0.44066354742662694, 'recall': 0.08210492946584244, 'f1-score': 0.1384194000935266, 'support': 63090}, 'accuracy': 0.3683277939125785, 'macro avg': {'precision': 0.3956383302722914, 'recall': 0.3668234564938761, 'f1-score': 0.32734906119319057, 'support': 190754}, 'weighted avg': {'precision': 0.3953352634560437, 'recall': 0.3683277939125785, 'f1-score': 0.32814339114292074, 'support': 190754}}
[[25822 35044  2596]
 [20965 39258  3979]
 [16798 41112  5180]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
6082/6082 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944296
{'0': {'precision': 0.3907614845448107, 'recall': 0.3762182815714706, 'f1-score': 0.38335200148546583, 'support': 510350}, '1': {'precision': 0.35088587008915284, 'recall': 0.6160605213193412, 'f1-score': 0.4471125472340539, 'support': 543544}, '2': {'precision': 0.43441133066983406, 'recall': 0.09599530731144737, 'f1-score': 0.15724331560381863, 'support': 502910}, 'accuracy': 0.3694337887107176, 'macro avg': {'precision': 0.3920195617679325, 'recall': 0.3627580367340864, 'f1-score': 0.3292359547744461, 'support': 1556804}, 'weighted avg': {'precision': 0.3909399226340303, 'recall': 0.3694337887107176, 'f1-score': 0.3325712627808064, 'support': 1556804}}
[[192003 294223  24124]
 [169957 334856  38731]
 [129396 325237  48277]]
Evaluating performance on  train set...
2440/2440 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072023
{'0': {'precision': 0.3723951923865781, 'recall': 0.34878951892922494, 'f1-score': 0.3602060275711909, 'support': 208223}, '1': {'precision': 0.32598278994549484, 'recall': 0.6342100535548683, 'f1-score': 0.43062508551016815, 'support': 205957}, '2': {'precision': 0.40998371843281256, 'recall': 0.0562481286268993, 'f1-score': 0.09892424584367712, 'support': 210407}, 'accuracy': 0.34435715120551663, 'macro avg': {'precision': 0.3694539002549619, 'recall': 0.3464159003703308, 'f1-score': 0.2965851196416787, 'support': 624587}, 'weighted avg': {'precision': 0.3697533343752072, 'recall': 0.34435715120551663, 'f1-score': 0.29540766011877345, 'support': 624587}}
[[ 72626 129029   6568]
 [ 64873 130620  10464]
 [ 57525 141047  11835]]
Evaluating performance on  val set...
826/826 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959854
{'0': {'precision': 0.4004806230728028, 'recall': 0.3831525879142948, 'f1-score': 0.39162502300428936, 'support': 72201}, '1': {'precision': 0.345308156958959, 'recall': 0.6142446758555921, 'f1-score': 0.4420886264686587, 'support': 72406}, '2': {'precision': 0.4000589840005898, 'recall': 0.08118986697789948, 'f1-score': 0.13498519790034083, 'support': 66831}, 'accuracy': 0.36684512717676104, 'macro avg': {'precision': 0.3819492546774505, 'recall': 0.35952904358259546, 'f1-score': 0.3228996157910963, 'support': 211438}, 'weighted avg': {'precision': 0.38145378711013744, 'recall': 0.36684512717676104, 'f1-score': 0.3277877351039079, 'support': 211438}}
[[27664 41365  3172]
 [22966 44475  4965]
 [18447 42958  5426]]
testing model on single stock: results/universal/W3/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
13689/13689 - 196s - 196s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1106734
{'0': {'precision': 0.3490874164169486, 'recall': 0.2439983867252492, 'f1-score': 0.2872325251440855, 'support': 1167811}, '1': {'precision': 0.32879215960935554, 'recall': 0.744410612566072, 'f1-score': 0.4561232588797558, 'support': 1169180}, '2': {'precision': 0.37486239878666305, 'recall': 0.01312823676060501, 'f1-score': 0.025368046921947402, 'support': 1167255}, 'accuracy': 0.33405702681832267, 'macro avg': {'precision': 0.3509139916043224, 'recall': 0.33384574535064204, 'f1-score': 0.25624127698192956, 'support': 3504246}, 'weighted avg': {'precision': 0.3509015495262278, 'recall': 0.33405702681832267, 'f1-score': 0.25635599608245263, 'support': 3504246}}
[[284944 871653  11214]
 [284489 870350  14341]
 [246821 905110  15324]]
Evaluating performance on  train set...
5475/5475 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142584
{'0': {'precision': 0.3387146097622448, 'recall': 0.2141524667488208, 'f1-score': 0.26240147871419556, 'support': 470660}, '1': {'precision': 0.3240290973925974, 'recall': 0.7690501688771727, 'f1-score': 0.4559497920426094, 'support': 461282}, '2': {'precision': 0.36145890038105605, 'recall': 0.00706948537553447, 'f1-score': 0.013867742669832855, 'support': 469624}, 'accuracy': 0.32739235968909064, 'macro avg': {'precision': 0.34140086917863277, 'recall': 0.3300907070005093, 'f1-score': 0.24407300447554592, 'support': 1401566}, 'weighted avg': {'precision': 0.3415022788557252, 'recall': 0.32739235968909064, 'f1-score': 0.2428254800189215, 'support': 1401566}}
[[100793 367567   2300]
 [102968 354749   3565]
 [ 93814 372490   3320]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1123459
{'0': {'precision': 0.3369917685208281, 'recall': 0.24113887609396592, 'f1-score': 0.2811192143885568, 'support': 173680}, '1': {'precision': 0.3280255833718292, 'recall': 0.7326842171270908, 'f1-score': 0.4531666769504703, 'support': 175418}, '2': {'precision': 0.351953125, 'recall': 0.010469561579846385, 'f1-score': 0.020334239835701148, 'support': 172118}, 'accuracy': 0.3303985295923379, 'macro avg': {'precision': 0.3389901589642191, 'recall': 0.328097551600301, 'f1-score': 0.2515400437249094, 'support': 521216}, 'weighted avg': {'precision': 0.338914749565184, 'recall': 0.3303985295923379, 'f1-score': 0.25290525614014797, 'support': 521216}}
[[ 41881 130437   1362]
 [ 44936 128526   1956]
 [ 37462 132854   1802]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        75 (peak)  21.28 (ave)

============================================
