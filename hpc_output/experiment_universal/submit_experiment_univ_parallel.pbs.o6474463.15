This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W5/deepLOB_L1/h10
Epoch 1/50
9913/9913 - 245s - loss: 2.7610 - accuracy10: 0.5178 - val_loss: 4.4074 - val_accuracy10: 0.4591 - 245s/epoch - 25ms/step
Epoch 2/50
9913/9913 - 220s - loss: 2.6820 - accuracy10: 0.5463 - val_loss: 4.5765 - val_accuracy10: 0.4619 - 220s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 215s - loss: 2.6466 - accuracy10: 0.5560 - val_loss: 4.6395 - val_accuracy10: 0.4597 - 215s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 212s - loss: 2.6258 - accuracy10: 0.5610 - val_loss: 4.5736 - val_accuracy10: 0.4594 - 212s/epoch - 21ms/step
Epoch 5/50
9913/9913 - 210s - loss: 2.6107 - accuracy10: 0.5644 - val_loss: 4.5357 - val_accuracy10: 0.4603 - 210s/epoch - 21ms/step
Epoch 6/50
9913/9913 - 209s - loss: 2.5980 - accuracy10: 0.5672 - val_loss: 4.5840 - val_accuracy10: 0.4600 - 209s/epoch - 21ms/step
Epoch 7/50
9913/9913 - 208s - loss: 2.5891 - accuracy10: 0.5691 - val_loss: 4.5793 - val_accuracy10: 0.4609 - 208s/epoch - 21ms/step
Epoch 8/50
9913/9913 - 207s - loss: 2.5809 - accuracy10: 0.5711 - val_loss: 4.5301 - val_accuracy10: 0.4615 - 207s/epoch - 21ms/step
Epoch 9/50
9913/9913 - 208s - loss: 2.5773 - accuracy10: 0.5716 - val_loss: 4.5228 - val_accuracy10: 0.4617 - 208s/epoch - 21ms/step
Epoch 10/50
9913/9913 - 207s - loss: 2.5729 - accuracy10: 0.5726 - val_loss: 4.4908 - val_accuracy10: 0.4633 - 207s/epoch - 21ms/step
Epoch 11/50
9913/9913 - 208s - loss: 2.5672 - accuracy10: 0.5743 - val_loss: 4.4553 - val_accuracy10: 0.4637 - 208s/epoch - 21ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 600s - 600s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3409233
{'0': {'precision': 0.4214866111878943, 'recall': 0.10674436674025843, 'f1-score': 0.17034715221441932, 'support': 3782579}, '1': {'precision': 0.3975075442337021, 'recall': 0.8086809797568509, 'f1-score': 0.5330125165975591, 'support': 5223051}, '2': {'precision': 0.3716935960763874, 'recall': 0.12168434191435365, 'f1-score': 0.18334541190280618, 'support': 3832761}, 'accuracy': 0.3967738636407008, 'macro avg': {'precision': 0.39689591716599465, 'recall': 0.34570322947048765, 'f1-score': 0.29556836023826155, 'support': 12838391}, 'weighted avg': {'precision': 0.396866032485629, 'recall': 0.3967738636407008, 'f1-score': 0.32177102744210506, 'support': 12838391}}
[[ 403769 3174616  204194]
 [ 415088 4223782  584181]
 [ 139107 3227267  466387]]
Evaluating performance on  train set...
9913/9913 - 114s - 114s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0360181
{'0': {'precision': 0.4019617693308815, 'recall': 0.30055662516728454, 'f1-score': 0.3439405253513988, 'support': 572378}, '1': {'precision': 0.5746669122754946, 'recall': 0.716453197431026, 'f1-score': 0.6377748184112474, 'support': 1389037}, '2': {'precision': 0.34157343871338797, 'recall': 0.22389153918049817, 'f1-score': 0.2704867884888432, 'support': 575618}, 'accuracy': 0.5108676158331406, 'macro avg': {'precision': 0.43940070677325466, 'recall': 0.4136337872596029, 'f1-score': 0.41740071075049645, 'support': 2537033}, 'weighted avg': {'precision': 0.4828173291706534, 'recall': 0.5108676158331406, 'f1-score': 0.48815047919260723, 'support': 2537033}}
[[172032 349442  50904]
 [196336 995180 197521]
 [ 59613 387129 128876]]
Evaluating performance on  val set...
3496/3496 - 41s - 41s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1682582
{'0': {'precision': 0.4017828650711065, 'recall': 0.2506036086711955, 'f1-score': 0.30867665085540696, 'support': 231110}, '1': {'precision': 0.4945498476595553, 'recall': 0.7091378813217231, 'f1-score': 0.5827159698206621, 'support': 433525}, '2': {'precision': 0.3523727955775295, 'recall': 0.19712610634887448, 'f1-score': 0.25281898446730483, 'support': 229584}, 'accuracy': 0.4591749895719058, 'macro avg': {'precision': 0.41623516943606376, 'recall': 0.38562253211393105, 'f1-score': 0.38140386838112467, 'support': 894219}, 'weighted avg': {'precision': 0.43407142607466814, 'recall': 0.4591749895719058, 'f1-score': 0.4271922150229836, 'support': 894219}}
[[ 57917 152290  20903]
 [ 63821 307429  62275]
 [ 22412 161915  45257]]
testing model out of sample: results/universal/W5/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 260s - 260s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0269978
{'0': {'precision': 0.46112863269451615, 'recall': 0.2324866364353222, 'f1-score': 0.3091230817731586, 'support': 1307473}, '1': {'precision': 0.5865884115816589, 'recall': 0.7953773140467841, 'f1-score': 0.6752108342522367, 'support': 2727635}, '2': {'precision': 0.4299321800648537, 'recall': 0.324364255832222, 'f1-score': 0.36976081288044116, 'support': 1313736}, 'accuracy': 0.5420980682928872, 'macro avg': {'precision': 0.4925497414470095, 'recall': 0.45074273543810944, 'f1-score': 0.4513649096352788, 'support': 5348844}, 'weighted avg': {'precision': 0.5174444611413636, 'recall': 0.5420980682928872, 'f1-score': 0.5107022897379501, 'support': 5348844}}
[[ 303970  778774  224729]
 [ 217840 2169499  340296]
 [ 137377  750230  426129]]
Evaluating performance on  train set...
4957/4957 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93023247
{'0': {'precision': 0.4310215800968279, 'recall': 0.3162825795413368, 'f1-score': 0.36484372643399793, 'support': 267691}, '1': {'precision': 0.6568556403200376, 'recall': 0.7351789486952542, 'f1-score': 0.6938138504685224, 'support': 729874}, '2': {'precision': 0.3999819614209695, 'recall': 0.3766872615675514, 'f1-score': 0.387985271630391, 'support': 270779}, 'accuracy': 0.5702341005279324, 'macro avg': {'precision': 0.49595306061261163, 'recall': 0.47604959660138085, 'f1-score': 0.48221428284430373, 'support': 1268344}, 'weighted avg': {'precision': 0.5543521055425467, 'recall': 0.5702341005279324, 'f1-score': 0.5590914894827518, 'support': 1268344}}
[[ 84666 140345  42680]
 [ 82956 536588 110330]
 [ 28809 139971 101999]]
Evaluating performance on  val set...
1701/1701 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93428344
{'0': {'precision': 0.4425572145791224, 'recall': 0.28822879952439595, 'f1-score': 0.34909736151828424, 'support': 94196}, '1': {'precision': 0.6485514719025424, 'recall': 0.7666215650661693, 'f1-score': 0.7026611324942694, 'support': 246111}, '2': {'precision': 0.41413873055743405, 'recall': 0.36188466205877695, 'f1-score': 0.38625241449995207, 'support': 94765}, 'accuracy': 0.5748887540453075, 'macro avg': {'precision': 0.501749139013033, 'recall': 0.4722450088831141, 'f1-score': 0.47933696950416865, 'support': 435072}, 'weighted avg': {'precision': 0.5528938370825446, 'recall': 0.5748887540453075, 'f1-score': 0.5571937957509594, 'support': 435072}}
[[ 27150  51863  15183]
 [ 24106 188674  33331]
 [ 10092  50379  34294]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.271839
{'0': {'precision': 0.4818751298874803, 'recall': 0.18204760088831065, 'f1-score': 0.26426030397017286, 'support': 89158}, '1': {'precision': 0.4029945923885318, 'recall': 0.8135176050173527, 'f1-score': 0.5389887521620617, 'support': 97103}, '2': {'precision': 0.44452987961650287, 'recall': 0.21749609094863565, 'f1-score': 0.29208374119801694, 'support': 85059}, 'accuracy': 0.41915818959162615, 'macro avg': {'precision': 0.44313320063083833, 'recall': 0.4043537656180997, 'f1-score': 0.3651109324434172, 'support': 271320}, 'weighted avg': {'precision': 0.4419367306704692, 'recall': 0.41915818959162615, 'f1-score': 0.3713058231060279, 'support': 271320}}
[[16231 59842 13085]
 [ 8076 78995 10032]
 [ 9376 57183 18500]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1510428
{'0': {'precision': 0.4580382056235244, 'recall': 0.11672683513838748, 'f1-score': 0.18604245673684672, 'support': 18282}, '1': {'precision': 0.5092203942787802, 'recall': 0.7787648311530271, 'f1-score': 0.6157880176571765, 'support': 32870}, '2': {'precision': 0.3986839427447256, 'recall': 0.3173840254900902, 'f1-score': 0.3534187263214866, 'support': 18517}, 'accuracy': 0.4824096800585626, 'macro avg': {'precision': 0.4553141808823434, 'recall': 0.4042918972605016, 'f1-score': 0.3850830669051699, 'support': 69669}, 'weighted avg': {'precision': 0.46641059011837205, 'recall': 0.4824096800585626, 'f1-score': 0.4332835965745079, 'support': 69669}}
[[ 2134 12920  3228]
 [ 1636 25598  5636]
 [  889 11751  5877]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1760304
{'0': {'precision': 0.46793650793650793, 'recall': 0.10870206489675516, 'f1-score': 0.17642130460801916, 'support': 6780}, '1': {'precision': 0.4940391556381932, 'recall': 0.8015260402803656, 'f1-score': 0.6112934330277091, 'support': 11271}, '2': {'precision': 0.3870689655172414, 'recall': 0.2784496124031008, 'f1-score': 0.3238954012623986, 'support': 6450}, 'accuracy': 0.47210317946206276, 'macro avg': {'precision': 0.4496815430306475, 'recall': 0.39622590586007383, 'f1-score': 0.37053671296604235, 'support': 24501}, 'weighted avg': {'precision': 0.45865555179763295, 'recall': 0.47210317946206276, 'f1-score': 0.41529529680585076, 'support': 24501}}
[[ 737 4919 1124]
 [ 517 9034 1720]
 [ 321 4333 1796]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83544827
{'0': {'precision': 0.3653638393393033, 'recall': 0.3767281818969465, 'f1-score': 0.3709589942656567, 'support': 80793}, '1': {'precision': 0.8399072164948453, 'recall': 0.6155056875845205, 'f1-score': 0.7104068781400188, 'support': 397093}, '2': {'precision': 0.29293672255273123, 'recall': 0.6660600098376783, 'f1-score': 0.4069115768912929, 'support': 81320}, 'accuracy': 0.5883592093074824, 'macro avg': {'precision': 0.49940259279562665, 'recall': 0.5527646264397151, 'f1-score': 0.4960924830989895, 'support': 559206}, 'weighted avg': {'precision': 0.691805401353555, 'recall': 0.5883592093074824, 'f1-score': 0.6172296755001907, 'support': 559206}}
[[ 30437  26945  23411]
 [ 45355 244413 107325]
 [  7514  19642  54164]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78973645
{'0': {'precision': 0.22988832102971796, 'recall': 0.5951486442339105, 'f1-score': 0.3316644667971416, 'support': 12244}, '1': {'precision': 0.9292559033498078, 'recall': 0.537087585101487, 'f1-score': 0.6807297376122615, 'support': 126026}, '2': {'precision': 0.18551340107901979, 'recall': 0.6893164801545769, 'f1-score': 0.2923481408133301, 'support': 12421}, 'accuracy': 0.5543529474222083, 'macro avg': {'precision': 0.44821920848618185, 'recall': 0.6071842364966581, 'f1-score': 0.43491411507424443, 'support': 150691}, 'weighted avg': {'precision': 0.81112620550035, 'recall': 0.5543529474222083, 'f1-score': 0.620354247438994, 'support': 150691}}
[[ 7287  2537  2420]
 [23168 67687 35171]
 [ 1243  2616  8562]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.804646
{'0': {'precision': 0.22704048211712302, 'recall': 0.6269898697539797, 'f1-score': 0.3333653938636145, 'support': 5528}, '1': {'precision': 0.9028626094635367, 'recall': 0.5404964867067557, 'f1-score': 0.6761921820962564, 'support': 45399}, '2': {'precision': 0.2483807378203323, 'recall': 0.616675406397483, 'f1-score': 0.3541279799247177, 'support': 5721}, 'accuracy': 0.5566304194322835, 'macro avg': {'precision': 0.4594279431336639, 'recall': 0.5947205876194062, 'f1-score': 0.45456185196152954, 'support': 56648}, 'weighted avg': {'precision': 0.7708149553955775, 'recall': 0.5566304194322835, 'f1-score': 0.6102114628127262, 'support': 56648}}
[[ 3466  1161   901]
 [11086 24538  9775]
 [  714  1479  3528]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
2341/2341 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1831301
{'0': {'precision': 0.4369544210017716, 'recall': 0.31468604469085826, 'f1-score': 0.36587561402384955, 'support': 172429}, '1': {'precision': 0.48490271139601787, 'recall': 0.5898127228786674, 'f1-score': 0.5322372405170746, 'support': 254062}, '2': {'precision': 0.4038320266868986, 'recall': 0.38813139497198945, 'f1-score': 0.39582607874499065, 'support': 172792}, 'accuracy': 0.45250073838236693, 'macro avg': {'precision': 0.44189638636156275, 'recall': 0.4308767208471717, 'f1-score': 0.4313129777619715, 'support': 599283}, 'weighted avg': {'precision': 0.44773155600424536, 'recall': 0.45250073838236693, 'f1-score': 0.44503916154683476, 'support': 599283}}
[[ 54261  79926  38242]
 [ 43447 149849  60766]
 [ 26472  79254  67066]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1142778
{'0': {'precision': 0.45555500958183875, 'recall': 0.27991304610368045, 'f1-score': 0.34676092160383004, 'support': 33121}, '1': {'precision': 0.5142132516115396, 'recall': 0.6891741170222183, 'f1-score': 0.5889748768808297, 'support': 56485}, '2': {'precision': 0.40722382184641176, 'recall': 0.32972318951779495, 'f1-score': 0.364398349721964, 'support': 33886}, 'accuracy': 0.480776082661225, 'macro avg': {'precision': 0.4589973610132634, 'recall': 0.4329367842145646, 'f1-score': 0.4333780494022079, 'support': 123492}, 'weighted avg': {'precision': 0.46912317734529696, 'recall': 0.480776082661225, 'f1-score': 0.46238879347433515, 'support': 123492}}
[[ 9271 18051  5799]
 [ 7092 38928 10465]
 [ 3988 18725 11173]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1693906
{'0': {'precision': 0.42957904164800714, 'recall': 0.33023495997934416, 'f1-score': 0.37341248601041305, 'support': 11619}, '1': {'precision': 0.491908540405095, 'recall': 0.5503767303311723, 'f1-score': 0.5195027152190094, 'support': 17121}, '2': {'precision': 0.41148469965999246, 'recall': 0.4328061670507828, 'f1-score': 0.42187621039584783, 'support': 12583}, 'accuracy': 0.4526776855504199, 'macro avg': {'precision': 0.44432409390436484, 'recall': 0.43780595245376636, 'f1-score': 0.43826380387509006, 'support': 41323}, 'weighted avg': {'precision': 0.4498936907050677, 'recall': 0.4526776855504199, 'f1-score': 0.44869815883722386, 'support': 41323}}
[[3837 4770 3012]
 [2921 9423 4777]
 [2174 4963 5446]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
2027/2027 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.433161
{'0': {'precision': 0.4319496240141835, 'recall': 0.18852126580927478, 'f1-score': 0.2624835144422773, 'support': 187390}, '1': {'precision': 0.31025536594306197, 'recall': 0.5159959629075195, 'f1-score': 0.387510460091413, 'support': 147631}, '2': {'precision': 0.3928127708000543, 'recall': 0.40927682534157167, 'f1-score': 0.40087582374846176, 'support': 183856}, 'accuracy': 0.3599157411101282, 'macro avg': {'precision': 0.3783392535857666, 'recall': 0.371264684686122, 'f1-score': 0.35028993276071735, 'support': 518877}, 'weighted avg': {'precision': 0.38345761088229546, 'recall': 0.3599157411101282, 'f1-score': 0.34709337271875784, 'support': 518877}}
[[35327 86391 65672]
 [20812 76177 50642]
 [25646 82962 75248]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3538976
{'0': {'precision': 0.40816416788288884, 'recall': 0.3290430690245294, 'f1-score': 0.364357764661758, 'support': 28048}, '1': {'precision': 0.36932867994251695, 'recall': 0.3809691878727985, 'f1-score': 0.3750586354870655, 'support': 28333}, '2': {'precision': 0.3902543540142634, 'recall': 0.45330109858854484, 'f1-score': 0.41942169150301, 'support': 28127}, 'accuracy': 0.38780943815970087, 'macro avg': {'precision': 0.38924906727988967, 'recall': 0.38777111849529095, 'f1-score': 0.3862793638839445, 'support': 84508}, 'weighted avg': {'precision': 0.38918282629987444, 'recall': 0.38780943815970087, 'f1-score': 0.386272504607767, 'support': 84508}}
[[ 9229  9234  9585]
 [ 7203 10794 10336]
 [ 6179  9198 12750]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4131986
{'0': {'precision': 0.4329612606697308, 'recall': 0.268485342019544, 'f1-score': 0.3314400603166625, 'support': 12280}, '1': {'precision': 0.3171989226625625, 'recall': 0.38952938952938954, 'f1-score': 0.34966280697289726, 'support': 10582}, '2': {'precision': 0.3875842497339482, 'recall': 0.4612851473444229, 'f1-score': 0.42123525329632194, 'support': 11843}, 'accuracy': 0.37118570811122314, 'macro avg': {'precision': 0.3792481443554139, 'recall': 0.3730999596311188, 'f1-score': 0.3674460401952939, 'support': 34705}, 'weighted avg': {'precision': 0.38217903905024286, 'recall': 0.37118570811122314, 'f1-score': 0.3676388090725877, 'support': 34705}}
[[3297 4533 4450]
 [2278 4122 4182]
 [2040 4340 5463]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
2900/2900 - 35s - 35s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3346444
{'0': {'precision': 0.49223921370101154, 'recall': 0.1969946598063463, 'f1-score': 0.28138053039361827, 'support': 261601}, '1': {'precision': 0.32868900679305596, 'recall': 0.5469923249563603, 'f1-score': 0.41062966057332634, 'support': 216546}, '2': {'precision': 0.426942952862815, 'recall': 0.44808883808774047, 'f1-score': 0.437260391351559, 'support': 264211}, 'accuracy': 0.38845543524822257, 'macro avg': {'precision': 0.4159570577856275, 'recall': 0.3973586076168157, 'f1-score': 0.3764235274395012, 'support': 742358}, 'weighted avg': {'precision': 0.4212921322693965, 'recall': 0.38845543524822257, 'f1-score': 0.3745613893423378, 'support': 742358}}
[[ 51534 123339  86728]
 [ 25918 118449  72179]
 [ 27241 118580 118390]]
Evaluating performance on  train set...
694/694 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2856786
{'0': {'precision': 0.4775369553315513, 'recall': 0.24634093665376372, 'f1-score': 0.32501863136206216, 'support': 60193}, '1': {'precision': 0.35203785252506326, 'recall': 0.6516415477202171, 'f1-score': 0.45712304351264377, 'support': 57659}, '2': {'precision': 0.4554129730544185, 'recall': 0.3035146443514644, 'f1-score': 0.3642626869269164, 'support': 59750}, 'accuracy': 0.3971576896656569, 'macro avg': {'precision': 0.4283292603036777, 'recall': 0.40049904290848176, 'f1-score': 0.3821347872672074, 'support': 177602}, 'weighted avg': {'precision': 0.42935021920370375, 'recall': 0.3971576896656569, 'f1-score': 0.3811094446422641, 'support': 177602}}
[[14828 34999 10366]
 [ 8766 37573 11320]
 [ 7457 34158 18135]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2639582
{'0': {'precision': 0.4827780914737436, 'recall': 0.2583081570996979, 'f1-score': 0.3365479236370793, 'support': 19860}, '1': {'precision': 0.38171294400305783, 'recall': 0.6645909587868992, 'f1-score': 0.48491259711431745, 'support': 21037}, '2': {'precision': 0.4477743499338916, 'recall': 0.30525788683024535, 'f1-score': 0.36303001429252024, 'support': 19970}, 'accuracy': 0.4141324527247934, 'macro avg': {'precision': 0.43742179513689766, 'recall': 0.40938566757228084, 'f1-score': 0.39483017834797235, 'support': 60867}, 'weighted avg': {'precision': 0.4363632488514415, 'recall': 0.4141324527247934, 'f1-score': 0.39651465415328374, 'support': 60867}}
[[ 5130 11302  3428]
 [ 2966 13981  4090]
 [ 2530 11344  6096]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
7167/7167 - 88s - 88s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7515791
{'0': {'precision': 0.41473423115979424, 'recall': 0.5545370232972251, 'f1-score': 0.4745534027740299, 'support': 269560}, '1': {'precision': 0.8585232417905714, 'recall': 0.6358916424482063, 'f1-score': 0.7306240858009772, 'support': 1294123}, '2': {'precision': 0.34458401940990624, 'recall': 0.6558873039780279, 'f1-score': 0.45180362135585334, 'support': 270888}, 'accuracy': 0.6268904283344716, 'macro avg': {'precision': 0.539280497453424, 'recall': 0.6154386565744865, 'f1-score': 0.5523270366436202, 'support': 1834571}, 'weighted avg': {'precision': 0.7174288203820317, 'recall': 0.6268904283344716, 'f1-score': 0.6518288081642138, 'support': 1834571}}
[[149481  72756  47323]
 [180583 822922 290618]
 [ 30362  62854 177672]]
Evaluating performance on  train set...
1570/1570 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7585138
{'0': {'precision': 0.3394031597425395, 'recall': 0.5760537083382989, 'f1-score': 0.4271407110665999, 'support': 50346}, '1': {'precision': 0.8936942770334213, 'recall': 0.5961762741599466, 'f1-score': 0.7152290162297477, 'support': 300963}, '2': {'precision': 0.3127668234051213, 'recall': 0.7167692002381425, 'f1-score': 0.43550030445713184, 'support': 50390}, 'accuracy': 0.6087816997303952, 'macro avg': {'precision': 0.5152880867270274, 'recall': 0.6296663942454627, 'f1-score': 0.5259566772511598, 'support': 401699}, 'weighted avg': {'precision': 0.7513506939539097, 'recall': 0.6087816997303952, 'f1-score': 0.6440323650108849, 'support': 401699}}
[[ 29002  11564   9780]
 [ 51955 179427  69581]
 [  4493   9779  36118]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81213254
{'0': {'precision': 0.3617298623624583, 'recall': 0.5095868214960843, 'f1-score': 0.42311314408717876, 'support': 18515}, '1': {'precision': 0.8714514407684099, 'recall': 0.5514186991412396, 'f1-score': 0.6754440990149515, 'support': 88849}, '2': {'precision': 0.3117361382834258, 'recall': 0.7366474491460894, 'f1-score': 0.43808322416832435, 'support': 18386}, 'accuracy': 0.5723419483101392, 'macro avg': {'precision': 0.5149724804714313, 'recall': 0.5992176565944711, 'f1-score': 0.5122134890901515, 'support': 125750}, 'weighted avg': {'precision': 0.714565392452902, 'recall': 0.5723419483101392, 'f1-score': 0.6035870439420464, 'support': 125750}}
[[ 9435  4088  4992]
 [14945 48993 24911]
 [ 1703  3139 13544]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
6357/6357 - 78s - 78s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7910792
{'0': {'precision': 0.5237611764320571, 'recall': 0.062048227830911594, 'f1-score': 0.11095230826869441, 'support': 257735}, '1': {'precision': 0.7108621882784745, 'recall': 0.944198460104895, 'f1-score': 0.8110820400145959, 'support': 1106439}, '2': {'precision': 0.45722946108727314, 'recall': 0.22082168862525903, 'f1-score': 0.2978128765929079, 'support': 262995}, 'accuracy': 0.687553044582339, 'macro avg': {'precision': 0.5639509419326015, 'recall': 0.4090227921870219, 'f1-score': 0.40661574162539943, 'support': 1627169}, 'weighted avg': {'precision': 0.6402323899134083, 'recall': 0.687553044582339, 'f1-score': 0.6172268473175763, 'support': 1627169}}
[[  15992  224506   17237]
 [  10038 1044698   51703]
 [   4503  200417   58075]]
Evaluating performance on  train set...
1701/1701 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7626441
{'0': {'precision': 0.40902032506297664, 'recall': 0.3511531795760565, 'f1-score': 0.3778842245371292, 'support': 67509}, '1': {'precision': 0.7573819554614518, 'recall': 0.8197137192970666, 'f1-score': 0.7873160640490033, 'support': 297610}, '2': {'precision': 0.4039055584659573, 'recall': 0.3180557333674732, 'f1-score': 0.35587636085821606, 'support': 70299}, 'accuracy': 0.6660726015001677, 'macro avg': {'precision': 0.5234359463301286, 'recall': 0.4963075440801988, 'f1-score': 0.5070255498147829, 'support': 435418}, 'weighted avg': {'precision': 0.6463011491122497, 'recall': 0.6660726015001677, 'f1-score': 0.6541793683951346, 'support': 435418}}
[[ 23706  37061   6742]
 [ 27399 243955  26256]
 [  6853  41087  22359]]
Evaluating performance on  val set...
563/563 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7505841
{'0': {'precision': 0.41930674617964964, 'recall': 0.25240061024858657, 'f1-score': 0.3151172236071819, 'support': 22286}, '1': {'precision': 0.7431702516884716, 'recall': 0.864668025097343, 'f1-score': 0.799328593076116, 'support': 99134}, '2': {'precision': 0.41155329020453507, 'recall': 0.2781924996687133, 'f1-score': 0.3319803911232934, 'support': 22639}, 'accuracy': 0.6777847965069868, 'macro avg': {'precision': 0.5246767626908855, 'recall': 0.46508704500488096, 'f1-score': 0.4821420692688638, 'support': 144059}, 'weighted avg': {'precision': 0.6409545034547309, 'recall': 0.6777847965069868, 'f1-score': 0.6509766641859069, 'support': 144059}}
[[ 5625 14745  1916]
 [ 6327 85718  7089]
 [ 1463 14878  6298]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
7459/7459 - 93s - 93s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9527952
{'0': {'precision': 0.42237383061366257, 'recall': 0.37556872123346113, 'f1-score': 0.3975985466092638, 'support': 416065}, '1': {'precision': 0.6194280442663527, 'recall': 0.7658473162362819, 'f1-score': 0.6848996507535482, 'support': 1059091}, '2': {'precision': 0.42610341302125254, 'recall': 0.22562342344417696, 'f1-score': 0.2950282400783191, 'support': 434095}, 'accuracy': 0.5579701149822627, 'macro avg': {'precision': 0.4893017626337559, 'recall': 0.45567982030464, 'f1-score': 0.4591754791470437, 'support': 1909251}, 'weighted avg': {'precision': 0.5325308174461242, 'recall': 0.5579701149822627, 'f1-score': 0.5336481055597233, 'support': 1909251}}
[[156261 224990  34814]
 [150890 811102  97099]
 [ 62808 273345  97942]]
Evaluating performance on  train set...
1664/1664 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78519845
{'0': {'precision': 0.3806220460436042, 'recall': 0.4490780992354969, 'f1-score': 0.41202602153791146, 'support': 66710}, '1': {'precision': 0.7850354875147945, 'recall': 0.6975783383063784, 'f1-score': 0.7387274303729044, 'support': 291907}, '2': {'precision': 0.35831019256156965, 'recall': 0.4674962135835833, 'f1-score': 0.4056850541832567, 'support': 67346}, 'accuracy': 0.6222840950974615, 'macro avg': {'precision': 0.5079892420399895, 'recall': 0.5380508837084862, 'f1-score': 0.5188128353646908, 'support': 425963}, 'weighted avg': {'precision': 0.6542338394973306, 'recall': 0.6222840950974615, 'f1-score': 0.6349077961552603, 'support': 425963}}
[[ 29958  27488   9264]
 [ 41159 203628  47120]
 [  7591  28271  31484]]
Evaluating performance on  val set...
517/517 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85922873
{'0': {'precision': 0.4035233316986684, 'recall': 0.4261413433192574, 'f1-score': 0.41452403557381184, 'support': 25102}, '1': {'precision': 0.7318765825752602, 'recall': 0.6687887172204402, 'f1-score': 0.6989118683750952, 'support': 81682}, '2': {'precision': 0.38857732224585834, 'recall': 0.47479521109010714, 'f1-score': 0.42738133219894364, 'support': 25392}, 'accuracy': 0.5854391114877133, 'macro avg': {'precision': 0.5079924121732623, 'recall': 0.5232417572099349, 'f1-score': 0.5136057453826169, 'support': 132176}, 'weighted avg': {'precision': 0.6035675240337067, 'recall': 0.5854391114877133, 'f1-score': 0.5927397436810308, 'support': 132176}}
[[10697 10043  4362]
 [12446 54628 14608]
 [ 3366  9970 12056]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
8238/8238 - 100s - 100s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0248209
{'0': {'precision': 0.45357170230704374, 'recall': 0.3146842655018517, 'f1-score': 0.3715737565957218, 'support': 526550}, '1': {'precision': 0.5700808980859982, 'recall': 0.7384803770343195, 'f1-score': 0.6434449262147124, 'support': 1053485}, '2': {'precision': 0.43296859404622967, 'recall': 0.3101560682380045, 'f1-score': 0.3614140227485874, 'support': 528679}, 'accuracy': 0.525271800727837, 'macro avg': {'precision': 0.48554039814642386, 'recall': 0.4544402369247252, 'f1-score': 0.45881090185300716, 'support': 2108714}, 'weighted avg': {'precision': 0.5066126834182674, 'recall': 0.525271800727837, 'f1-score': 0.5048497538127428, 'support': 2108714}}
[[165697 291731  69122]
 [129884 777978 145623]
 [ 69735 294971 163973]]
Evaluating performance on  train set...
1806/1806 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86958736
{'0': {'precision': 0.4208028619753958, 'recall': 0.3903777120538234, 'f1-score': 0.40501970521236536, 'support': 88586}, '1': {'precision': 0.7268331375749348, 'recall': 0.6681717791411043, 'f1-score': 0.6962690738257975, 'support': 285250}, '2': {'precision': 0.37746488442006215, 'recall': 0.5032209856555753, 'f1-score': 0.4313643664384392, 'support': 88327}, 'accuracy': 0.5834002289235616, 'macro avg': {'precision': 0.5083669613234643, 'recall': 0.5205901589501676, 'f1-score': 0.5108843818255341, 'support': 462163}, 'weighted avg': {'precision': 0.6014041272675947, 'recall': 0.5834002289235616, 'f1-score': 0.5898156046874358, 'support': 462163}}
[[ 34582  37358  16646]
 [ 37994 190596  56660]
 [  9605  34274  44448]]
Evaluating performance on  val set...
642/642 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8769092
{'0': {'precision': 0.44522309613449135, 'recall': 0.35493744613830197, 'f1-score': 0.394986606699957, 'support': 33651}, '1': {'precision': 0.6961213267900431, 'recall': 0.7241665641530324, 'f1-score': 0.7098670525458985, 'support': 97548}, '2': {'precision': 0.4073076602715384, 'recall': 0.4428946653382846, 'f1-score': 0.4243563783627422, 'support': 33123}, 'accuracy': 0.5918562334927764, 'macro avg': {'precision': 0.5162173610653576, 'recall': 0.5073328918765396, 'f1-score': 0.5097366792028659, 'support': 164322}, 'weighted avg': {'precision': 0.5865233944627686, 'recall': 0.5918562334927764, 'f1-score': 0.5878321944980992, 'support': 164322}}
[[11944 15927  5780]
 [11340 70641 15567]
 [ 3543 14910 14670]]
testing model on single stock: results/universal/W5/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
31315/31315 - 378s - 378s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5975633
{'0': {'precision': 0.5172308237606534, 'recall': 0.01134909824796705, 'f1-score': 0.022210845290642166, 'support': 2828771}, '1': {'precision': 0.29013835528147003, 'recall': 0.9759706302446376, 'f1-score': 0.447301956939409, 'support': 2325113}, '2': {'precision': 0.4583858953565207, 'recall': 0.021325353646787084, 'f1-score': 0.0407546887653224, 'support': 2862602}, 'accuracy': 0.2946917140502709, 'macro avg': {'precision': 0.42191835813288137, 'recall': 0.33621502737979725, 'f1-score': 0.1700891636651245, 'support': 8016486}, 'weighted avg': {'precision': 0.43035170235975945, 'recall': 0.2946917140502709, 'f1-score': 0.15212668538533025, 'support': 8016486}}
[[  32104 2763439   33228]
 [  16969 2269242   38902]
 [  12996 2788560   61046]]
Evaluating performance on  train set...
5759/5759 - 71s - 71s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1910205
{'0': {'precision': 0.46140411155013455, 'recall': 0.23297111052213093, 'f1-score': 0.30961308770929863, 'support': 415030}, '1': {'precision': 0.4563764415339649, 'recall': 0.831546194500536, 'f1-score': 0.5893181509500216, 'support': 641808}, '2': {'precision': 0.4186991869918699, 'recall': 0.09551342569740304, 'f1-score': 0.15554419591989635, 'support': 417334}, 'accuracy': 0.4546579367943496, 'macro avg': {'precision': 0.4454932466919898, 'recall': 0.3866769102400234, 'f1-score': 0.3514918115264056, 'support': 1474172}, 'weighted avg': {'precision': 0.44712557700780386, 'recall': 0.4546579367943496, 'f1-score': 0.3877713761195815, 'support': 1474172}}
[[ 96690 298400  19940]
 [ 72714 533693  35401]
 [ 40152 337321  39861]]
Evaluating performance on  val set...
2129/2129 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3475629
{'0': {'precision': 0.4533257249875633, 'recall': 0.18259127206294015, 'f1-score': 0.2603274363423252, 'support': 169685}, '1': {'precision': 0.3888739681574327, 'recall': 0.846318830218392, 'f1-score': 0.532890674664128, 'support': 207013}, '2': {'precision': 0.41784001534624976, 'recall': 0.06473413297511918, 'f1-score': 0.11210095364551972, 'support': 168242}, 'accuracy': 0.398342936837083, 'macro avg': {'precision': 0.4200132361637486, 'recall': 0.36454807841881715, 'f1-score': 0.3017730215506576, 'support': 544940}, 'weighted avg': {'precision': 0.41788597327517346, 'recall': 0.398342936837083, 'f1-score': 0.3181066666297613, 'support': 544940}}
[[ 30983 132436   6266]
 [ 22906 175199   8908]
 [ 14457 142894  10891]]
training model: results/universal/W5/deepLOB_L1/h20
Epoch 1/50
9913/9913 - 213s - loss: 2.8228 - accuracy20: 0.5179 - val_loss: 3.9803 - val_accuracy20: 0.4080 - 213s/epoch - 22ms/step
Epoch 2/50
9913/9913 - 208s - loss: 2.7421 - accuracy20: 0.5460 - val_loss: 4.1581 - val_accuracy20: 0.4110 - 208s/epoch - 21ms/step
Epoch 3/50
9913/9913 - 209s - loss: 2.7114 - accuracy20: 0.5533 - val_loss: 4.0171 - val_accuracy20: 0.4141 - 209s/epoch - 21ms/step
Epoch 4/50
9913/9913 - 208s - loss: 2.6913 - accuracy20: 0.5581 - val_loss: 4.0151 - val_accuracy20: 0.4112 - 208s/epoch - 21ms/step
Epoch 5/50
9913/9913 - 204s - loss: 2.6787 - accuracy20: 0.5605 - val_loss: 3.9768 - val_accuracy20: 0.4110 - 204s/epoch - 21ms/step
Epoch 6/50
9913/9913 - 203s - loss: 2.6695 - accuracy20: 0.5627 - val_loss: 4.0414 - val_accuracy20: 0.4124 - 203s/epoch - 20ms/step
Epoch 7/50
9913/9913 - 204s - loss: 2.6613 - accuracy20: 0.5645 - val_loss: 3.9858 - val_accuracy20: 0.4128 - 204s/epoch - 21ms/step
Epoch 8/50
9913/9913 - 200s - loss: 2.6547 - accuracy20: 0.5662 - val_loss: 3.9859 - val_accuracy20: 0.4159 - 200s/epoch - 20ms/step
Epoch 9/50
9913/9913 - 207s - loss: 2.6504 - accuracy20: 0.5668 - val_loss: 3.9731 - val_accuracy20: 0.4153 - 207s/epoch - 21ms/step
Epoch 10/50
9913/9913 - 201s - loss: 2.6460 - accuracy20: 0.5678 - val_loss: 3.9833 - val_accuracy20: 0.4155 - 201s/epoch - 20ms/step
Epoch 11/50
9913/9913 - 199s - loss: 2.6419 - accuracy20: 0.5688 - val_loss: 3.9517 - val_accuracy20: 0.4193 - 199s/epoch - 20ms/step
Epoch 12/50
9913/9913 - 201s - loss: 2.6385 - accuracy20: 0.5694 - val_loss: 3.9976 - val_accuracy20: 0.4183 - 201s/epoch - 20ms/step
Epoch 13/50
9913/9913 - 206s - loss: 2.6351 - accuracy20: 0.5703 - val_loss: 3.9443 - val_accuracy20: 0.4187 - 206s/epoch - 21ms/step
Epoch 14/50
9913/9913 - 204s - loss: 2.6323 - accuracy20: 0.5712 - val_loss: 3.9919 - val_accuracy20: 0.4204 - 204s/epoch - 21ms/step
Epoch 15/50
9913/9913 - 205s - loss: 2.6294 - accuracy20: 0.5717 - val_loss: 3.8652 - val_accuracy20: 0.4222 - 205s/epoch - 21ms/step
Epoch 16/50
9913/9913 - 205s - loss: 2.6265 - accuracy20: 0.5726 - val_loss: 3.9644 - val_accuracy20: 0.4252 - 205s/epoch - 21ms/step
Epoch 17/50
9913/9913 - 204s - loss: 2.6238 - accuracy20: 0.5733 - val_loss: 3.9074 - val_accuracy20: 0.4253 - 204s/epoch - 21ms/step
Epoch 18/50
9913/9913 - 207s - loss: 2.6213 - accuracy20: 0.5738 - val_loss: 3.9185 - val_accuracy20: 0.4241 - 207s/epoch - 21ms/step
Epoch 19/50
9913/9913 - 200s - loss: 2.6194 - accuracy20: 0.5744 - val_loss: 3.9135 - val_accuracy20: 0.4233 - 200s/epoch - 20ms/step
Epoch 20/50
9913/9913 - 204s - loss: 2.6170 - accuracy20: 0.5749 - val_loss: 3.9568 - val_accuracy20: 0.4272 - 204s/epoch - 21ms/step
Epoch 21/50
9913/9913 - 199s - loss: 2.6153 - accuracy20: 0.5751 - val_loss: 3.9187 - val_accuracy20: 0.4281 - 199s/epoch - 20ms/step
Epoch 22/50
9913/9913 - 206s - loss: 2.6133 - accuracy20: 0.5757 - val_loss: 3.9085 - val_accuracy20: 0.4267 - 206s/epoch - 21ms/step
Epoch 23/50
9913/9913 - 207s - loss: 2.6113 - accuracy20: 0.5761 - val_loss: 3.8686 - val_accuracy20: 0.4269 - 207s/epoch - 21ms/step
Epoch 24/50
9913/9913 - 206s - loss: 2.6095 - accuracy20: 0.5764 - val_loss: 3.8916 - val_accuracy20: 0.4276 - 206s/epoch - 21ms/step
Epoch 25/50
9913/9913 - 204s - loss: 2.6077 - accuracy20: 0.5768 - val_loss: 3.8734 - val_accuracy20: 0.4294 - 204s/epoch - 21ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 553s - 553s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4484985
{'0': {'precision': 0.5297288441058409, 'recall': 0.08986586272006464, 'f1-score': 0.15366348052631118, 'support': 4317368}, '1': {'precision': 0.3162760504838944, 'recall': 0.7743884288706174, 'f1-score': 0.4491216473256347, 'support': 4125440}, '2': {'precision': 0.4350737927598258, 'recall': 0.19845513098035006, 'f1-score': 0.2725767468311516, 'support': 4395583}, 'accuracy': 0.3470063343607466, 'macro avg': {'precision': 0.42702622911652033, 'recall': 0.3542364741903441, 'f1-score': 0.29178729156103245, 'support': 12838391}, 'weighted avg': {'precision': 0.4287309209641953, 'recall': 0.3470063343607466, 'f1-score': 0.2893181798951519, 'support': 12838391}}
[[ 387984 3504488  424896]
 [ 222962 3194693  707785]
 [ 121474 3401783  872326]]
Evaluating performance on  train set...
9913/9913 - 116s - 116s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.060328
{'0': {'precision': 0.4821414995723653, 'recall': 0.2945125464205224, 'f1-score': 0.3656627336371769, 'support': 689081}, '1': {'precision': 0.5197412609588866, 'recall': 0.6846253836713619, 'f1-score': 0.5908965708744909, 'support': 1156263}, '2': {'precision': 0.4176860011399009, 'recall': 0.3581118103656412, 'f1-score': 0.38561152871085824, 'support': 691689}, 'accuracy': 0.48964755286982864, 'macro avg': {'precision': 0.47318958722371757, 'recall': 0.4457499134858418, 'f1-score': 0.447390277740842, 'support': 2537033}, 'weighted avg': {'precision': 0.4817047900951178, 'recall': 0.48964755286982864, 'f1-score': 0.4737527405315484, 'support': 2537033}}
[[202943 372339 113799]
 [133123 791607 231533]
 [ 84854 359133 247702]]
Evaluating performance on  val set...
3496/3496 - 39s - 39s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1594802
{'0': {'precision': 0.46554586777234414, 'recall': 0.1906963434258595, 'f1-score': 0.27056441407238674, 'support': 269077}, '1': {'precision': 0.4172312014515414, 'recall': 0.7002921883815122, 'f1-score': 0.5229129945444752, 'support': 356277}, '2': {'precision': 0.41342902454103164, 'recall': 0.2860320235062206, 'f1-score': 0.3381287372493844, 'support': 268865}, 'accuracy': 0.4223954087309708, 'macro avg': {'precision': 0.43206869792163904, 'recall': 0.3923401851045307, 'f1-score': 0.3772020486220821, 'support': 894219}, 'weighted avg': {'precision': 0.4306262346308391, 'recall': 0.4223954087309708, 'f1-score': 0.3914203531162202, 'support': 894219}}
[[ 51312 176492  41273]
 [ 38941 249498  67838]
 [ 19966 171995  76904]]
testing model out of sample: results/universal/W5/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 258s - 258s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1231506
{'0': {'precision': 0.5246377130856528, 'recall': 0.18258892319762535, 'f1-score': 0.27089770149099524, 'support': 1565199}, '1': {'precision': 0.5184421120360317, 'recall': 0.6971073495715885, 'f1-score': 0.5946443448705961, 'support': 2219245}, '2': {'precision': 0.4351508458465883, 'recall': 0.5062675786243928, 'f1-score': 0.46802305826318447, 'support': 1564400}, 'accuracy': 0.49073126828899855, 'macro avg': {'precision': 0.49274355698942424, 'recall': 0.4619879504645355, 'f1-score': 0.44452170154159193, 'support': 5348844}, 'weighted avg': {'precision': 0.4958945282479273, 'recall': 0.49073126828899855, 'f1-score': 0.4628748890330838, 'support': 5348844}}
[[ 285788  794343  485068]
 [ 129196 1547052  542997]
 [ 129750  642645  792005]]
Evaluating performance on  train set...
4957/4957 - 60s - 60s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9928041
{'0': {'precision': 0.5070146945517635, 'recall': 0.2824171990156818, 'f1-score': 0.3627663667046081, 'support': 323879}, '1': {'precision': 0.6130728653684491, 'recall': 0.6742098224549338, 'f1-score': 0.6421895542010277, 'support': 617646}, '2': {'precision': 0.4296522126362253, 'recall': 0.5372943433521307, 'f1-score': 0.4774818257089911, 'support': 326819}, 'accuracy': 0.5388837728565752, 'macro avg': {'precision': 0.5165799241854793, 'recall': 0.49797378827424876, 'f1-score': 0.494145915538209, 'support': 1268344}, 'weighted avg': {'precision': 0.5387276020871705, 'recall': 0.5388837728565752, 'f1-score': 0.5283963579851811, 'support': 1268344}}
[[ 91469 143736  88674]
 [ 56797 416423 144426]
 [ 32141 119080 175598]]
Evaluating performance on  val set...
1701/1701 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0075574
{'0': {'precision': 0.5135168738898757, 'recall': 0.25328088588299197, 'f1-score': 0.3392394072022811, 'support': 114146}, '1': {'precision': 0.5979265382935107, 'recall': 0.6879419255994239, 'f1-score': 0.6397835325633817, 'support': 206907}, '2': {'precision': 0.4301003439552005, 'recall': 0.5308062691305835, 'f1-score': 0.475176163463992, 'support': 114019}, 'accuracy': 0.5327233193586349, 'macro avg': {'precision': 0.5138479187128623, 'recall': 0.49067636020433314, 'f1-score': 0.48473303440988497, 'support': 435072}, 'weighted avg': {'precision': 0.5317986320957385, 'recall': 0.5327233193586349, 'f1-score': 0.5177938909619652, 'support': 435072}}
[[ 28911  53216  32019]
 [ 16392 142340  48175]
 [ 10997  42500  60522]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
1060/1060 - 26s - 26s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.278559
{'0': {'precision': 0.5151319120211509, 'recall': 0.17818747871771173, 'f1-score': 0.2647843341357102, 'support': 102785}, '1': {'precision': 0.3201657755447487, 'recall': 0.664348335122026, 'f1-score': 0.4320945685626612, 'support': 71747}, '2': {'precision': 0.4439751409828519, 'recall': 0.398572137041782, 'f1-score': 0.4200503054257995, 'support': 96788}, 'accuracy': 0.3853641456582633, 'macro avg': {'precision': 0.4264242761829172, 'recall': 0.4137026502938399, 'f1-score': 0.3723097360413903, 'support': 271320}, 'weighted avg': {'precision': 0.4381919262146224, 'recall': 0.3853641456582633, 'f1-score': 0.36441536103625427, 'support': 271320}}
[[18315 53944 30526]
 [ 6295 47665 17787]
 [10944 47267 38577]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.234263
{'0': {'precision': 0.5284013273472574, 'recall': 0.12348889193011267, 'f1-score': 0.2001922792486318, 'support': 21921}, '1': {'precision': 0.4261671007814065, 'recall': 0.6658058457565442, 'f1-score': 0.5196915324120027, 'support': 25557}, '2': {'precision': 0.4314729060037371, 'recall': 0.4786625208417827, 'f1-score': 0.4538443461727446, 'support': 22191}, 'accuracy': 0.43555957455970373, 'macro avg': {'precision': 0.4620137780441336, 'recall': 0.42265241950947985, 'f1-score': 0.391242719277793, 'support': 69669}, 'weighted avg': {'precision': 0.46002459269658763, 'recall': 0.43555957455970373, 'f1-score': 0.3981890271596002, 'support': 69669}}
[[ 2707 12513  6701]
 [ 1246 17016  7295]
 [ 1170 10399 10622]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2766141
{'0': {'precision': 0.542136695421367, 'recall': 0.10221443763292881, 'f1-score': 0.17200000000000001, 'support': 7993}, '1': {'precision': 0.4151726865278144, 'recall': 0.7112691960252936, 'f1-score': 0.5243049775262194, 'support': 8856}, '2': {'precision': 0.4179238046535413, 'recall': 0.42720857292211184, 'f1-score': 0.4225151867648959, 'support': 7652}, 'accuracy': 0.42386025060201626, 'macro avg': {'precision': 0.4584110622009076, 'recall': 0.41356406886011143, 'f1-score': 0.3729400547637051, 'support': 24501}, 'weighted avg': {'precision': 0.4574515681646548, 'recall': 0.42386025060201626, 'f1-score': 0.3775816125912078, 'support': 24501}}
[[ 817 4819 2357]
 [ 361 6299 2196]
 [ 329 4054 3269]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89300054
{'0': {'precision': 0.516902433109692, 'recall': 0.31218145247905643, 'f1-score': 0.3892666475927268, 'support': 102418}, '1': {'precision': 0.7820299926847111, 'recall': 0.6041930415517476, 'f1-score': 0.6817042686426303, 'support': 353872}, '2': {'precision': 0.32375385687047614, 'recall': 0.7045065878969257, 'f1-score': 0.4436360966386941, 'support': 102916}, 'accuracy': 0.5691730775420865, 'macro avg': {'precision': 0.5408954275549597, 'recall': 0.5402936939759099, 'f1-score': 0.5048690042913504, 'support': 559206}, 'weighted avg': {'precision': 0.6491312376820607, 'recall': 0.5691730775420865, 'f1-score': 0.5843306706078344, 'support': 559206}}
[[ 31973  35987  34458]
 [ 23077 213807 116988]
 [  6805  23606  72505]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79167783
{'0': {'precision': 0.3518199563669767, 'recall': 0.5490055545601147, 'f1-score': 0.4288313505948216, 'support': 16743}, '1': {'precision': 0.9107050025992722, 'recall': 0.584958646552167, 'f1-score': 0.712359046809753, 'support': 116798}, '2': {'precision': 0.25210423268675697, 'recall': 0.7282798833819242, 'f1-score': 0.3745520519394839, 'support': 17150}, 'accuracy': 0.5972752188252782, 'macro avg': {'precision': 0.5048763972176687, 'recall': 0.6207480281647353, 'f1-score': 0.5052474831146861, 'support': 150691}, 'weighted avg': {'precision': 0.7736535825870157, 'recall': 0.5972752188252782, 'f1-score': 0.6424113115120133, 'support': 150691}}
[[ 9192  3488  4063]
 [15486 68322 32990]
 [ 1449  3211 12490]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8450109
{'0': {'precision': 0.31497844065879693, 'recall': 0.5946883758174296, 'f1-score': 0.41182994454713495, 'support': 7493}, '1': {'precision': 0.8760265936644506, 'recall': 0.5424385518827946, 'f1-score': 0.6700067299783145, 'support': 41295}, '2': {'precision': 0.3107908570078554, 'recall': 0.6694656488549618, 'f1-score': 0.42450889435682304, 'support': 7860}, 'accuracy': 0.5669750035305747, 'macro avg': {'precision': 0.500598630443701, 'recall': 0.6021975255183953, 'f1-score': 0.5021151896274242, 'support': 56648}, 'weighted avg': {'precision': 0.7233877237909829, 'recall': 0.5669750035305747, 'f1-score': 0.6017937014297204, 'support': 56648}}
[[ 4456  1509  1528]
 [ 8754 22400 10141]
 [  937  1661  5262]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
2341/2341 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2600689
{'0': {'precision': 0.49515369953840455, 'recall': 0.2654633683313316, 'f1-score': 0.3456277132705531, 'support': 206488}, '1': {'precision': 0.3876377738467819, 'recall': 0.488599697707076, 'f1-score': 0.43230221320143597, 'support': 186574}, '2': {'precision': 0.4386532603033795, 'recall': 0.5390333671158611, 'f1-score': 0.48369024852436615, 'support': 206221}, 'accuracy': 0.42907107326588606, 'macro avg': {'precision': 0.44048157789618864, 'recall': 0.43103214438475623, 'f1-score': 0.4205400583321184, 'support': 599283}, 'weighted avg': {'precision': 0.44223837672852195, 'recall': 0.42907107326588606, 'f1-score': 0.4201210698861773, 'support': 599283}}
[[ 54815  77229  74444]
 [ 27606  91160  67808]
 [ 28282  66779 111160]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1950095
{'0': {'precision': 0.5256165734955607, 'recall': 0.200140238405289, 'f1-score': 0.2898960770444529, 'support': 39932}, '1': {'precision': 0.4199532774494984, 'recall': 0.5723248355455673, 'f1-score': 0.4844401731841915, 'support': 42717}, '2': {'precision': 0.4356014459467556, 'recall': 0.5340205175917538, 'f1-score': 0.4798160899311437, 'support': 40843}, 'accuracy': 0.4393078094127555, 'macro avg': {'precision': 0.46039043229727156, 'recall': 0.43549519718087004, 'f1-score': 0.4180507800532627, 'support': 123492}, 'weighted avg': {'precision': 0.45929562257019313, 'recall': 0.4393078094127555, 'f1-score': 0.4200036406204929, 'support': 123492}}
[[ 7992 18198 13742]
 [ 3751 24448 14518]
 [ 3462 15570 21811]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2513354
{'0': {'precision': 0.5054319710294879, 'recall': 0.20943193997856377, 'f1-score': 0.29615034859048195, 'support': 13995}, '1': {'precision': 0.386095676920992, 'recall': 0.45992412624102025, 'f1-score': 0.41978855858842595, 'support': 12389}, '2': {'precision': 0.4425503226427815, 'recall': 0.6151683512952674, 'f1-score': 0.5147738411987116, 'support': 14939}, 'accuracy': 0.43121264187014496, 'macro avg': {'precision': 0.4446926568644205, 'recall': 0.42817480583828377, 'f1-score': 0.4102375827925398, 'support': 41323}, 'weighted avg': {'precision': 0.4469210620209657, 'recall': 0.43121264187014496, 'f1-score': 0.41225445864393584, 'support': 41323}}
[[2931 4743 6321]
 [1436 5698 5255]
 [1432 4317 9190]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
2027/2027 - 22s - 22s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3994418
{'0': {'precision': 0.45169353621097486, 'recall': 0.14236540718885823, 'f1-score': 0.2164954670633405, 'support': 189126}, '1': {'precision': 0.3336991294379314, 'recall': 0.45763907551733407, 'f1-score': 0.38596332172676295, 'support': 148840}, '2': {'precision': 0.3925227417919866, 'recall': 0.5535926505298185, 'f1-score': 0.4593471510670599, 'support': 180911}, 'accuracy': 0.37617971118396076, 'macro avg': {'precision': 0.39263846914696426, 'recall': 0.38453237774533694, 'f1-score': 0.3539353132857211, 'support': 518877}, 'weighted avg': {'precision': 0.39721639597690517, 'recall': 0.37617971118396076, 'f1-score': 0.34977972613225405, 'support': 518877}}
[[ 26925  73014  89187]
 [ 14916  68115  65809]
 [ 17768  62992 100151]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3745394
{'0': {'precision': 0.40793003541152484, 'recall': 0.2678433030367082, 'f1-score': 0.32336679142565494, 'support': 28386}, '1': {'precision': 0.3625709798236076, 'recall': 0.32408207343412526, 'f1-score': 0.3422478188971888, 'support': 27780}, '2': {'precision': 0.3836594458929311, 'recall': 0.5555359537082775, 'f1-score': 0.4538706562315331, 'support': 28342}, 'accuracy': 0.38281582808728165, 'macro avg': {'precision': 0.3847201537093545, 'recall': 0.38248711005970365, 'f1-score': 0.37316175551812564, 'support': 84508}, 'weighted avg': {'precision': 0.38487953590416074, 'recall': 0.38281582808728165, 'f1-score': 0.3733414148871901, 'support': 84508}}
[[ 7603  8284 12499]
 [ 5982  9003 12795]
 [ 5053  7544 15745]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4304272
{'0': {'precision': 0.4376762549351382, 'recall': 0.1870179948586118, 'f1-score': 0.26205887319187254, 'support': 12448}, '1': {'precision': 0.28784368242199565, 'recall': 0.3594021215043394, 'f1-score': 0.3196672098807788, 'support': 10370}, '2': {'precision': 0.3741939408687188, 'recall': 0.5174560444182721, 'f1-score': 0.43431597528684907, 'support': 11887}, 'accuracy': 0.35170724679441, 'macro avg': {'precision': 0.3665712927419509, 'recall': 0.3546253869270744, 'f1-score': 0.3386806861198335, 'support': 34705}, 'weighted avg': {'precision': 0.37116197617793273, 'recall': 0.35170724679441, 'f1-score': 0.33827321187698833, 'support': 34705}}
[[2328 4782 5338]
 [1694 3727 4949]
 [1297 4439 6151]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
2900/2900 - 35s - 35s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3633852
{'0': {'precision': 0.485633211447291, 'recall': 0.1608351001852807, 'f1-score': 0.24164174735549193, 'support': 261765}, '1': {'precision': 0.33390139272492214, 'recall': 0.3682300442535227, 'f1-score': 0.3502265192640435, 'support': 216028}, '2': {'precision': 0.4110443263133434, 'recall': 0.648540056318863, 'f1-score': 0.5031759903341975, 'support': 264565}, 'accuracy': 0.3949981006468577, 'macro avg': {'precision': 0.41019297682851885, 'recall': 0.3925350669192221, 'f1-score': 0.365014752317911, 'support': 742358}, 'weighted avg': {'precision': 0.4148965456736094, 'recall': 0.3949981006468577, 'f1-score': 0.3664469735395188, 'support': 742358}}
[[ 42101  87933 131731]
 [ 22365  79548 114115]
 [ 22227  70757 171581]]
Evaluating performance on  train set...
694/694 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2468536
{'0': {'precision': 0.45585371488926296, 'recall': 0.23520495921252066, 'f1-score': 0.3103037656151703, 'support': 58719}, '1': {'precision': 0.38981446421809923, 'recall': 0.4427371067517946, 'f1-score': 0.4145937238623339, 'support': 60458}, '2': {'precision': 0.4117041162781826, 'recall': 0.5541463414634147, 'f1-score': 0.47242164244440554, 'support': 58425}, 'accuracy': 0.41077240121169806, 'macro avg': {'precision': 0.4191240984618482, 'recall': 0.4106961358092433, 'f1-score': 0.3991063773073032, 'support': 177602}, 'weighted avg': {'precision': 0.41884939446534, 'recall': 0.41077240121169806, 'f1-score': 0.39913665741512233, 'support': 177602}}
[[13811 23084 21824]
 [ 9252 26767 24439]
 [ 7234 18815 32376]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2183908
{'0': {'precision': 0.4766651563207975, 'recall': 0.21436576668364749, 'f1-score': 0.295734064235013, 'support': 19630}, '1': {'precision': 0.4053935219111828, 'recall': 0.5075462177164091, 'f1-score': 0.4507547208245911, 'support': 21799}, '2': {'precision': 0.4062310583100982, 'recall': 0.5171828377405083, 'f1-score': 0.45504130360982237, 'support': 19438}, 'accuracy': 0.4160711058537467, 'macro avg': {'precision': 0.4294299121806928, 'recall': 0.4130316073801883, 'f1-score': 0.40051002955647547, 'support': 60867}, 'weighted avg': {'precision': 0.4286465525514781, 'recall': 0.4160711058537467, 'f1-score': 0.40212848833943343, 'support': 60867}}
[[ 4208  8762  6660]
 [ 2701 11064  8034]
 [ 1919  7466 10053]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
7167/7167 - 87s - 87s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77159697
{'0': {'precision': 0.5309974807297061, 'recall': 0.4548767686946299, 'f1-score': 0.48999843207255883, 'support': 357255}, '1': {'precision': 0.7878908575811332, 'recall': 0.6903546395036783, 'f1-score': 0.7359049765770544, 'support': 1117501}, '2': {'precision': 0.4348825652703374, 'recall': 0.6639828800911579, 'f1-score': 0.5255503836407153, 'support': 359815}, 'accuracy': 0.6393265782572601, 'macro avg': {'precision': 0.5845903011937256, 'recall': 0.603071429429822, 'f1-score': 0.5838179307634429, 'support': 1834571}, 'weighted avg': {'precision': 0.668629121706716, 'recall': 0.6393265782572601, 'f1-score': 0.6467614763176791, 'support': 1834571}}
[[162507 120060  74688]
 [110259 771472 235770]
 [ 33275  87629 238911]]
Evaluating performance on  train set...
1570/1570 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7713654
{'0': {'precision': 0.47312048528183565, 'recall': 0.47444129358350845, 'f1-score': 0.47377996889397544, 'support': 68059}, '1': {'precision': 0.8368523502597054, 'recall': 0.6346218297527819, 'f1-score': 0.7218404195855115, 'support': 265555}, '2': {'precision': 0.3736635672532332, 'recall': 0.7248145700227656, 'f1-score': 0.49311276873192, 'support': 68085}, 'accuracy': 0.6227697853367821, 'macro avg': {'precision': 0.5612121342649247, 'recall': 0.6112925644530187, 'f1-score': 0.5629110524038023, 'support': 401699}, 'weighted avg': {'precision': 0.6967189785323062, 'recall': 0.6227697853367821, 'f1-score': 0.6410444297473938, 'support': 401699}}
[[ 32290  18838  16931]
 [ 31240 168527  65788]
 [  4719  14017  49349]]
Evaluating performance on  val set...
492/492 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84547055
{'0': {'precision': 0.47216724393864423, 'recall': 0.31561104680006613, 'f1-score': 0.3783328377440777, 'support': 24188}, '1': {'precision': 0.7245239174790297, 'recall': 0.659334141372463, 'f1-score': 0.6903935732127185, 'support': 77554}, '2': {'precision': 0.34184484438291546, 'recall': 0.5553982005998, 'f1-score': 0.42320754118132475, 'support': 24008}, 'accuracy': 0.573375745526839, 'macro avg': {'precision': 0.512845335266863, 'recall': 0.5101144629241098, 'f1-score': 0.4973113173793737, 'support': 125750}, 'weighted avg': {'precision': 0.6029226259761561, 'recall': 0.573375745526839, 'f1-score': 0.5793579682304109, 'support': 125750}}
[[ 7634  9895  6659]
 [ 7407 51134 19013]
 [ 1127  9547 13334]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
6357/6357 - 78s - 78s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94896173
{'0': {'precision': 0.655209316965691, 'recall': 0.06155065302948316, 'f1-score': 0.11253017193611252, 'support': 338193}, '1': {'precision': 0.6255769399558726, 'recall': 0.8736070870817563, 'f1-score': 0.7290745344189176, 'support': 946398}, '2': {'precision': 0.4215786186265163, 'recall': 0.3369042962478618, 'f1-score': 0.3745150880426511, 'support': 342578}, 'accuracy': 0.5918328090075462, 'macro avg': {'precision': 0.5674549585160266, 'recall': 0.424020678786367, 'f1-score': 0.40537326479922703, 'support': 1627169}, 'weighted avg': {'precision': 0.5887867390324979, 'recall': 0.5918328090075462, 'f1-score': 0.526283519102232, 'support': 1627169}}
[[ 20816 273097  44280]
 [  5543 826780 114075]
 [  5411 221751 115416]]
Evaluating performance on  train set...
1701/1701 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84158117
{'0': {'precision': 0.5209507008858286, 'recall': 0.3094988561704813, 'f1-score': 0.3883044904422576, 'support': 88737}, '1': {'precision': 0.6990699300699301, 'recall': 0.7821715555486006, 'f1-score': 0.7382896306225467, 'support': 255614}, '2': {'precision': 0.4488360789666905, 'recall': 0.47659415595111293, 'f1-score': 0.46229881874247736, 'support': 91067}, 'accuracy': 0.6219311098760272, 'macro avg': {'precision': 0.5562855699741497, 'recall': 0.5227548558900649, 'f1-score': 0.5296309799357606, 'support': 435418}, 'weighted avg': {'precision': 0.6104336950991013, 'recall': 0.6219311098760272, 'f1-score': 0.6092405636348233, 'support': 435418}}
[[ 27464  46371  14902]
 [ 17285 199934  38395]
 [  7970  39695  43402]]
Evaluating performance on  val set...
563/563 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8775778
{'0': {'precision': 0.5559444383681506, 'recall': 0.1713524811218986, 'f1-score': 0.2619630479037287, 'support': 29664}, '1': {'precision': 0.6741550395406236, 'recall': 0.790829591113212, 'f1-score': 0.7278462082279685, 'support': 84620}, '2': {'precision': 0.42220414574626236, 'recall': 0.5055247691015953, 'f1-score': 0.46012288692568704, 'support': 29775}, 'accuracy': 0.6043010155561264, 'macro avg': {'precision': 0.5507678745516789, 'recall': 0.48923561377890196, 'f1-score': 0.48331071435246137, 'support': 144059}, 'weighted avg': {'precision': 0.5977388688334317, 'recall': 0.6043010155561264, 'f1-score': 0.5765788805383852, 'support': 144059}}
[[ 5083 18716  5865]
 [ 2966 66920 14734]
 [ 1094 13629 15052]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
7459/7459 - 92s - 92s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0570616
{'0': {'precision': 0.5323496288124296, 'recall': 0.2181168236796408, 'f1-score': 0.3094459712037024, 'support': 530954}, '1': {'precision': 0.518353703906651, 'recall': 0.6564311271105245, 'f1-score': 0.5792780041307554, 'support': 821419}, '2': {'precision': 0.4355452201142015, 'recall': 0.5095353021667224, 'f1-score': 0.46964393002735944, 'support': 556878}, 'accuracy': 0.4916922918987603, 'macro avg': {'precision': 0.4954161842777607, 'recall': 0.4613610843189626, 'f1-score': 0.4527893017872724, 'support': 1909251}, 'weighted avg': {'precision': 0.4980928631240882, 'recall': 0.4916922918987603, 'f1-score': 0.4722615871539925, 'support': 1909251}}
[[115810 271838 143306]
 [ 57789 539205 224425]
 [ 43946 229183 283749]]
Evaluating performance on  train set...
1664/1664 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.844372
{'0': {'precision': 0.4967996987951807, 'recall': 0.3585516632322638, 'f1-score': 0.4165033603829916, 'support': 88322}, '1': {'precision': 0.7241756755614535, 'recall': 0.688989232093027, 'f1-score': 0.7061443995714167, 'support': 248702}, '2': {'precision': 0.4057372154680297, 'recall': 0.5729882278865289, 'f1-score': 0.4750722475995152, 'support': 88939}, 'accuracy': 0.5962536652244443, 'macro avg': {'precision': 0.5422375299415546, 'recall': 0.54017637440394, 'f1-score': 0.532573335851308, 'support': 425963}, 'weighted avg': {'precision': 0.6105416293597886, 'recall': 0.5962536652244443, 'f1-score': 0.5978415610914806, 'support': 425963}}
[[ 31668  35493  21161]
 [ 23870 171353  53479]
 [  8206  29772  50961]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9144371
{'0': {'precision': 0.5081035849555183, 'recall': 0.3559264515332881, 'f1-score': 0.4186139332365747, 'support': 32414}, '1': {'precision': 0.6876608777817601, 'recall': 0.6292861828373785, 'f1-score': 0.6571797786046801, 'support': 67076}, '2': {'precision': 0.42844368657461324, 'recall': 0.6303310285749251, 'f1-score': 0.5101394012924951, 'support': 32686}, 'accuracy': 0.5625075656700157, 'macro avg': {'precision': 0.5414027164372972, 'recall': 0.5385145543151972, 'f1-score': 0.5286443710445833, 'support': 132176}, 'weighted avg': {'precision': 0.5795251859657979, 'recall': 0.5625075656700157, 'f1-score': 0.5623135768389446, 'support': 132176}}
[[11537 10803 10074]
 [ 7455 42210 17411]
 [ 3714  8369 20603]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
8238/8238 - 100s - 100s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1139616
{'0': {'precision': 0.5338729821321854, 'recall': 0.22742877701351286, 'f1-score': 0.31897490830214376, 'support': 655968}, '1': {'precision': 0.4820963635490224, 'recall': 0.628417353581349, 'f1-score': 0.5456172513303628, 'support': 798498}, '2': {'precision': 0.4498473535145474, 'recall': 0.5421033002775706, 'f1-score': 0.49168521443905094, 'support': 654248}, 'accuracy': 0.4769001391369337, 'macro avg': {'precision': 0.4886055663985851, 'recall': 0.46598314362414417, 'f1-score': 0.4520924580238525, 'support': 2108714}, 'weighted avg': {'precision': 0.48819721678076705, 'recall': 0.4769001391369337, 'f1-score': 0.45838159407973433, 'support': 2108714}}
[[149186 302495 204287]
 [ 67242 501790 229466]
 [ 63013 236565 354670]]
Evaluating performance on  train set...
1806/1806 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9473619
{'0': {'precision': 0.509683030035565, 'recall': 0.3427336999214454, 'f1-score': 0.4098595077552554, 'support': 114570}, '1': {'precision': 0.6536019239679632, 'recall': 0.6348735533647664, 'f1-score': 0.644101627474642, 'support': 233300}, '2': {'precision': 0.42387669867386724, 'recall': 0.5878487746406167, 'f1-score': 0.49257511941026183, 'support': 114293}, 'accuracy': 0.5508229780402153, 'macro avg': {'precision': 0.5290538842257985, 'recall': 0.5218186759756095, 'f1-score': 0.5155120848800531, 'support': 462163}, 'weighted avg': {'precision': 0.5611134018396817, 'recall': 0.5508229780402153, 'f1-score': 0.5485605762817677, 'support': 462163}}
[[ 39267  43866  31437]
 [ 25302 148116  59882]
 [ 12473  34633  67187]]
Evaluating performance on  val set...
642/642 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9423639
{'0': {'precision': 0.5138579679282419, 'recall': 0.3715472191116088, 'f1-score': 0.43126582449869344, 'support': 42864}, '1': {'precision': 0.6427756023911523, 'recall': 0.66081546635034, 'f1-score': 0.6516707112189658, 'support': 79243}, '2': {'precision': 0.4436967336392735, 'recall': 0.5450906076039322, 'f1-score': 0.4891950210997374, 'support': 42215}, 'accuracy': 0.5556285829042976, 'macro avg': {'precision': 0.5334434346528892, 'recall': 0.5258177643552937, 'f1-score': 0.5240438522724655, 'support': 164322}, 'weighted avg': {'precision': 0.5580027787401575, 'recall': 0.5556285829042976, 'f1-score': 0.55243660791715, 'support': 164322}}
[[15926 16034 10904]
 [ 8931 52365 17947]
 [ 6136 13068 23011]]
testing model on single stock: results/universal/W5/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
31315/31315 - 376s - 376s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.7386434
{'0': {'precision': 0.5838458900194352, 'recall': 0.01627637552727151, 'f1-score': 0.03166986296485209, 'support': 3137615}, '1': {'precision': 0.21071075401730532, 'recall': 0.9516352220680743, 'f1-score': 0.3450259721579845, 'support': 1683808}, '2': {'precision': 0.5444521848490826, 'recall': 0.055281852032338645, 'f1-score': 0.10037224259613427, 'support': 3195063}, 'accuracy': 0.22828818013279134, 'macro avg': {'precision': 0.44633627629527445, 'recall': 0.34106448320922816, 'f1-score': 0.15902269257299026, 'support': 8016486}, 'weighted avg': {'precision': 0.489770593573564, 'recall': 0.22828818013279134, 'f1-score': 0.12487029451056092, 'support': 8016486}}
[[  51069 3003426   83120]
 [  16770 1602371   64667]
 [  19631 2998803  176629]]
Evaluating performance on  train set...
5759/5759 - 63s - 63s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2110078
{'0': {'precision': 0.4997012457642379, 'recall': 0.25042711728138056, 'f1-score': 0.33364620948492935, 'support': 487571}, '1': {'precision': 0.3800499654343145, 'recall': 0.7526315366243959, 'f1-score': 0.5050627011370588, 'support': 497428}, '2': {'precision': 0.48665334657170994, 'recall': 0.2434823671788917, 'f1-score': 0.3245739294415165, 'support': 489173}, 'accuracy': 0.4175808521665043, 'macro avg': {'precision': 0.4554681859234208, 'recall': 0.4155136736948894, 'f1-score': 0.38776094668783484, 'support': 1474172}, 'weighted avg': {'precision': 0.4549977938850409, 'recall': 0.4175808521665043, 'f1-score': 0.3884766147319826, 'support': 1474172}}
[[122101 306322  59148]
 [ 56558 374380  66490]
 [ 65689 304379 119105]]
Evaluating performance on  val set...
2129/2129 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3065952
{'0': {'precision': 0.48739964961592513, 'recall': 0.13149365826295614, 'f1-score': 0.20711150742196605, 'support': 192534}, '1': {'precision': 0.3040982724665884, 'recall': 0.8126914277856259, 'f1-score': 0.4425865660870631, 'support': 159982}, '2': {'precision': 0.48260530778750516, 'recall': 0.16415312019290734, 'f1-score': 0.24497915656810473, 'support': 192424}, 'accuracy': 0.343010239659412, 'macro avg': {'precision': 0.4247010766233396, 'recall': 0.36944606874716307, 'f1-score': 0.29822574335904467, 'support': 544940}, 'weighted avg': {'precision': 0.43189359876427713, 'recall': 0.343010239659412, 'f1-score': 0.2896130954034982, 'support': 544940}}
[[ 25317 149651  17566]
 [ 13668 130016  16298]
 [ 12958 147879  31587]]
training model: results/universal/W5/deepLOB_L1/h30
Epoch 1/50
9913/9913 - 211s - loss: 2.9301 - accuracy30: 0.4900 - val_loss: 3.7451 - val_accuracy30: 0.3918 - 211s/epoch - 21ms/step
Epoch 2/50
9913/9913 - 209s - loss: 2.8487 - accuracy30: 0.5193 - val_loss: 3.7582 - val_accuracy30: 0.4012 - 209s/epoch - 21ms/step
Epoch 3/50
9913/9913 - 207s - loss: 2.8163 - accuracy30: 0.5288 - val_loss: 3.6655 - val_accuracy30: 0.4027 - 207s/epoch - 21ms/step
Epoch 4/50
9913/9913 - 202s - loss: 2.7989 - accuracy30: 0.5332 - val_loss: 3.7002 - val_accuracy30: 0.4044 - 202s/epoch - 20ms/step
Epoch 5/50
9913/9913 - 207s - loss: 2.7855 - accuracy30: 0.5360 - val_loss: 3.7079 - val_accuracy30: 0.4021 - 207s/epoch - 21ms/step
Epoch 6/50
9913/9913 - 205s - loss: 2.7754 - accuracy30: 0.5383 - val_loss: 3.7247 - val_accuracy30: 0.4029 - 205s/epoch - 21ms/step
Epoch 7/50
9913/9913 - 204s - loss: 2.7678 - accuracy30: 0.5400 - val_loss: 3.7228 - val_accuracy30: 0.4010 - 204s/epoch - 21ms/step
Epoch 8/50
9913/9913 - 200s - loss: 2.7617 - accuracy30: 0.5414 - val_loss: 3.7309 - val_accuracy30: 0.4023 - 200s/epoch - 20ms/step
Epoch 9/50
9913/9913 - 201s - loss: 2.7563 - accuracy30: 0.5426 - val_loss: 3.7292 - val_accuracy30: 0.4009 - 201s/epoch - 20ms/step
Epoch 10/50
9913/9913 - 206s - loss: 2.7515 - accuracy30: 0.5437 - val_loss: 3.7117 - val_accuracy30: 0.4024 - 206s/epoch - 21ms/step
Epoch 11/50
9913/9913 - 207s - loss: 2.7473 - accuracy30: 0.5446 - val_loss: 3.6971 - val_accuracy30: 0.4019 - 207s/epoch - 21ms/step
Epoch 12/50
9913/9913 - 207s - loss: 2.7434 - accuracy30: 0.5456 - val_loss: 3.7651 - val_accuracy30: 0.4026 - 207s/epoch - 21ms/step
Epoch 13/50
9913/9913 - 207s - loss: 2.7402 - accuracy30: 0.5461 - val_loss: 3.7576 - val_accuracy30: 0.4022 - 207s/epoch - 21ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 622s - 622s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2744184
{'0': {'precision': 0.5301792855850026, 'recall': 0.09629112107994874, 'f1-score': 0.16298154626049105, 'support': 4441396}, '1': {'precision': 0.2926555017395661, 'recall': 0.7586530681091233, 'f1-score': 0.42237645665856555, 'support': 3859527}, '2': {'precision': 0.44815223441083474, 'recall': 0.2001675824490663, 'f1-score': 0.2767323996531453, 'support': 4537468}, 'accuracy': 0.332125965006051, 'macro avg': {'precision': 0.42366234057846786, 'recall': 0.3517039238793795, 'f1-score': 0.2873634675240673, 'support': 12838391}, 'weighted avg': {'precision': 0.4297831707813037, 'recall': 0.332125965006051, 'f1-score': 0.281164776354185, 'support': 12838391}}
[[ 427667 3588347  425382]
 [ 238457 2928042  693028]
 [ 140522 3488692  908254]]
Evaluating performance on  train set...
9913/9913 - 115s - 115s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852554
{'0': {'precision': 0.47909295959109055, 'recall': 0.28942593373506387, 'f1-score': 0.36085495979263943, 'support': 728017}, '1': {'precision': 0.4631442317699159, 'recall': 0.6628324028289799, 'f1-score': 0.5452813043670177, 'support': 1080955}, '2': {'precision': 0.4151563397381373, 'recall': 0.31374294186888185, 'f1-score': 0.3573947036352954, 'support': 728061}, 'accuracy': 0.45550176130937203, 'macro avg': {'precision': 0.4524645103663813, 'recall': 0.4220004261443086, 'f1-score': 0.42117698926498415, 'support': 2537033}, 'weighted avg': {'precision': 0.45394956710518325, 'recall': 0.45550176130937203, 'f1-score': 0.43844058904587546, 'support': 2537033}}
[[210707 422340  94970]
 [137645 716492 226818]
 [ 91452 408185 228424]]
Evaluating performance on  val set...
3496/3496 - 40s - 40s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1424881
{'0': {'precision': 0.46195665937850866, 'recall': 0.19665426841320324, 'f1-score': 0.2758707608854563, 'support': 278265}, '1': {'precision': 0.38554915626922726, 'recall': 0.6813049380772305, 'f1-score': 0.4924319931464422, 'support': 336629}, '2': {'precision': 0.4220746915491089, 'recall': 0.273355410364271, 'f1-score': 0.33181307566450613, 'support': 279325}, 'accuracy': 0.40306010048992474, 'macro avg': {'precision': 0.4231935023989483, 'recall': 0.3837715389515683, 'f1-score': 0.3667052765654682, 'support': 894219}, 'weighted avg': {'precision': 0.4207352001743077, 'recall': 0.40306010048992474, 'f1-score': 0.37486986304101494, 'support': 894219}}
[[ 54722 184547  38996]
 [ 41729 229347  65553]
 [ 22006 180964  76355]]
testing model out of sample: results/universal/W5/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 253s - 253s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1506579
{'0': {'precision': 0.5306881491427072, 'recall': 0.1604119106555059, 'f1-score': 0.246357090436576, 'support': 1714935}, '1': {'precision': 0.4237919254556275, 'recall': 0.6699406789924213, 'f1-score': 0.5191679376414428, 'support': 1923939}, '2': {'precision': 0.4477814581751961, 'recall': 0.4684918448861676, 'f1-score': 0.45790259466343225, 'support': 1709970}, 'accuracy': 0.44217554297713674, 'macro avg': {'precision': 0.46742051092451026, 'recall': 0.4329481448446983, 'f1-score': 0.4078092075804837, 'support': 5348844}, 'weighted avg': {'precision': 0.46573397062151434, 'recall': 0.44217554297713674, 'f1-score': 0.41211400808518966, 'support': 5348844}}
[[ 275096  974220  465619]
 [ 112682 1288925  522332]
 [ 130598  778265  801107]]
Evaluating performance on  train set...
4957/4957 - 57s - 57s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0389911
{'0': {'precision': 0.5195998610786898, 'recall': 0.25397328969741495, 'f1-score': 0.34118166048570403, 'support': 359337}, '1': {'precision': 0.5211950214691888, 'recall': 0.6550607582705088, 'f1-score': 0.5805104839458899, 'support': 548485}, '2': {'precision': 0.44160706095278235, 'recall': 0.49406138876406985, 'f1-score': 0.46636390890037144, 'support': 360522}, 'accuracy': 0.49566442542401745, 'macro avg': {'precision': 0.494133981166887, 'recall': 0.4676984789106646, 'f1-score': 0.4626853511106552, 'support': 1268344}, 'weighted avg': {'precision': 0.49812051577472694, 'recall': 0.49566442542401745, 'f1-score': 0.48026003693445357, 'support': 1268344}}
[[ 91262 180260  87815]
 [ 51784 359291 137410]
 [ 32593 149809 178120]]
Evaluating performance on  val set...
1701/1701 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0511181
{'0': {'precision': 0.526224471353696, 'recall': 0.23083570516835403, 'f1-score': 0.320902883783471, 'support': 126133}, '1': {'precision': 0.5091733516437508, 'recall': 0.6640584046828586, 'f1-score': 0.5763922460780133, 'support': 183136}, '2': {'precision': 0.4442149640165226, 'recall': 0.4975159574890901, 'f1-score': 0.46935707027720186, 'support': 125803}, 'accuracy': 0.490305052956752, 'macro avg': {'precision': 0.4932042623379898, 'recall': 0.46413668911343425, 'f1-score': 0.4555507333795621, 'support': 435072}, 'weighted avg': {'precision': 0.49533368566595015, 'recall': 0.490305052956752, 'f1-score': 0.47137287927075616, 'support': 435072}}
[[ 29116  65205  31812]
 [ 15026 121613  46497]
 [ 11188  52026  62589]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
1060/1060 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3013666
{'0': {'precision': 0.5007193739691898, 'recall': 0.1344888687816924, 'f1-score': 0.21202867862847802, 'support': 106098}, '1': {'precision': 0.2663093415007657, 'recall': 0.7515589306661727, 'f1-score': 0.3932673203353418, 'support': 64788}, '2': {'precision': 0.46199756597702685, 'recall': 0.27592249636577254, 'f1-score': 0.34549954181913384, 'support': 100434}, 'accuracy': 0.3341920978917883, 'macro avg': {'precision': 0.40967542714899413, 'recall': 0.38732343193787927, 'f1-score': 0.3169318469276512, 'support': 271320}, 'weighted avg': {'precision': 0.43041145989190405, 'recall': 0.3341920978917883, 'f1-score': 0.30471296947542853, 'support': 271320}}
[[14269 70595 21234]
 [ 5059 48692 11037]
 [ 9169 63553 27712]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2142247
{'0': {'precision': 0.5227068345323741, 'recall': 0.09936746730489786, 'f1-score': 0.1669898728722258, 'support': 23398}, '1': {'precision': 0.37192459539310274, 'recall': 0.6246980808923631, 'f1-score': 0.46625585892687404, 'support': 22771}, '2': {'precision': 0.4350114925483799, 'recall': 0.4993191489361702, 'f1-score': 0.4649522526449261, 'support': 23500}, 'accuracy': 0.40597683331180295, 'macro avg': {'precision': 0.44321430749128554, 'recall': 0.4077948990444771, 'f1-score': 0.36606599481467533, 'support': 69669}, 'weighted avg': {'precision': 0.4438438839508499, 'recall': 0.40597683331180295, 'f1-score': 0.3653090922252932, 'support': 69669}}
[[ 2325 13342  7731]
 [ 1037 14225  7509]
 [ 1086 10680 11734]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2171605
{'0': {'precision': 0.5281823939202026, 'recall': 0.09916765755053508, 'f1-score': 0.16698368205025527, 'support': 8410}, '1': {'precision': 0.38489656245139214, 'recall': 0.6207977922729554, 'f1-score': 0.4751800288046088, 'support': 7972}, '2': {'precision': 0.42945151033386325, 'recall': 0.5323315679270846, 'f1-score': 0.47538909970851895, 'support': 8119}, 'accuracy': 0.4124321456267091, 'macro avg': {'precision': 0.447510155568486, 'recall': 0.4174323392501917, 'f1-score': 0.37251760352112767, 'support': 24501}, 'weighted avg': {'precision': 0.44884397131268267, 'recall': 0.4124321456267091, 'f1-score': 0.3694605141098916, 'support': 24501}}
[[ 834 4509 3067]
 [ 348 4949 2675]
 [ 397 3400 4322]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9537534
{'0': {'precision': 0.4977481887605248, 'recall': 0.3231958500737426, 'f1-score': 0.3919150182698386, 'support': 117978}, '1': {'precision': 0.7142147790366993, 'recall': 0.5393507040856803, 'f1-score': 0.6145865519244453, 'support': 322688}, '2': {'precision': 0.3439715718363623, 'recall': 0.6932765311287329, 'f1-score': 0.4598078655394481, 'support': 118540}, 'accuracy': 0.5263766840842194, 'macro avg': {'precision': 0.5186448465445288, 'recall': 0.518607695096052, 'f1-score': 0.488769811911244, 'support': 559206}, 'weighted avg': {'precision': 0.5900620961807741, 'recall': 0.5263766840842194, 'f1-score': 0.5347987676703766, 'support': 559206}}
[[ 38130  42602  37246]
 [ 29155 174042 119491]
 [  9320  27039  82181]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.874467
{'0': {'precision': 0.3756529560314111, 'recall': 0.5366444279713368, 'f1-score': 0.44194375483293313, 'support': 20235}, '1': {'precision': 0.8639220272904483, 'recall': 0.5050690151888118, 'f1-score': 0.6374625311401465, 'support': 109686}, '2': {'precision': 0.25869335229539187, 'recall': 0.7181511795859412, 'f1-score': 0.3803695061775619, 'support': 20770}, 'accuracy': 0.5386784877663563, 'macro avg': {'precision': 0.49942277853908373, 'recall': 0.5866215409153633, 'f1-score': 0.48659193071688045, 'support': 150691}, 'weighted avg': {'precision': 0.7149368573959362, 'recall': 0.5386784877663563, 'f1-score': 0.57577241980603, 'support': 150691}}
[[10859  4710  4666]
 [16210 55399 38077]
 [ 1838  4016 14916]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88143003
{'0': {'precision': 0.34403639909002276, 'recall': 0.5859625816450792, 'f1-score': 0.4335326398558441, 'support': 9033}, '1': {'precision': 0.817876316544404, 'recall': 0.5233662016154411, 'f1-score': 0.6382869844721987, 'support': 38132}, '2': {'precision': 0.34930613213141976, 'recall': 0.6211114626173152, 'f1-score': 0.4471436705257164, 'support': 9483}, 'accuracy': 0.5497104928682389, 'macro avg': {'precision': 0.5037396159219488, 'recall': 0.5768134152926119, 'f1-score': 0.5063210982845864, 'support': 56648}, 'weighted avg': {'precision': 0.6638788756258587, 'recall': 0.5497104928682389, 'f1-score': 0.5736393704156738, 'support': 56648}}
[[ 5293  2116  1624]
 [ 8827 19957  9348]
 [ 1265  2328  5890]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
2341/2341 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.255184
{'0': {'precision': 0.4926457416953606, 'recall': 0.2312438982235364, 'f1-score': 0.31474776117979547, 'support': 214077}, '1': {'precision': 0.3257134656388388, 'recall': 0.5558944452544102, 'f1-score': 0.410754722265912, 'support': 171475}, '2': {'precision': 0.44872684230696464, 'recall': 0.43279168674642426, 'f1-score': 0.4406152351192745, 'support': 213731}, 'accuracy': 0.39601824179894973, 'macro avg': {'precision': 0.4223620165470547, 'recall': 0.40664334340812364, 'f1-score': 0.38870590618832734, 'support': 599283}, 'weighted avg': {'precision': 0.4292173742596527, 'recall': 0.39601824179894973, 'f1-score': 0.3871085234987677, 'support': 599283}}
[[ 49504 103847  60726]
 [ 23239  95322  52914]
 [ 27743  93487  92501]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1780981
{'0': {'precision': 0.5128108278249921, 'recall': 0.19924664905586537, 'f1-score': 0.2869876164808258, 'support': 40884}, '1': {'precision': 0.38866928062735057, 'recall': 0.5864058915851744, 'f1-score': 0.46748796920115493, 'support': 41415}, '2': {'precision': 0.43519790789415363, 'recall': 0.47670720753526086, 'f1-score': 0.4550078201934774, 'support': 41193}, 'accuracy': 0.4216386486574029, 'macro avg': {'precision': 0.44555933878216547, 'recall': 0.4207865827254335, 'f1-score': 0.4031611352918194, 'support': 123492}, 'weighted avg': {'precision': 0.44528879248746944, 'recall': 0.4216386486574029, 'f1-score': 0.4035674626202331, 'support': 123492}}
[[ 8146 20459 12279]
 [ 3923 24286 13206]
 [ 3816 17740 19637]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2098337
{'0': {'precision': 0.4861287142655964, 'recall': 0.24091004257100984, 'f1-score': 0.3221651889874009, 'support': 14329}, '1': {'precision': 0.360833915972796, 'recall': 0.47637828312494757, 'f1-score': 0.41063291139240504, 'support': 11917}, '2': {'precision': 0.4491860024879658, 'recall': 0.5508390263314983, 'f1-score': 0.494845975093845, 'support': 15077}, 'accuracy': 0.4218957965297776, 'macro avg': {'precision': 0.43204954424211933, 'recall': 0.4227091173424853, 'f1-score': 0.4092146918245503, 'support': 41323}, 'weighted avg': {'precision': 0.43651655211070356, 'recall': 0.4218957965297776, 'f1-score': 0.41068194866185076, 'support': 41323}}
[[3452 5224 5653]
 [1709 5677 4531]
 [1940 4832 8305]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
2027/2027 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3318769
{'0': {'precision': 0.42410096205048103, 'recall': 0.12599733165990792, 'f1-score': 0.19427651452012246, 'support': 189631}, '1': {'precision': 0.3066330873179661, 'recall': 0.5233979036752023, 'f1-score': 0.3867111393217838, 'support': 150740}, '2': {'precision': 0.3812841676492657, 'recall': 0.438383023539825, 'f1-score': 0.40784481320880583, 'support': 178506}, 'accuracy': 0.3489150607947548, 'macro avg': {'precision': 0.3706727390059043, 'recall': 0.3625927529583117, 'f1-score': 0.32961082235023736, 'support': 518877}, 'weighted avg': {'precision': 0.37524514046162155, 'recall': 0.3489150607947548, 'f1-score': 0.3236536464190591, 'support': 518877}}
[[23893 94746 70992]
 [15851 78897 55992]
 [16594 83658 78254]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3023919
{'0': {'precision': 0.39275135979320375, 'recall': 0.25786719468213, 'f1-score': 0.31132739962860984, 'support': 28282}, '1': {'precision': 0.3512683282135732, 'recall': 0.3963410276566855, 'f1-score': 0.37244598156573716, 'support': 27986}, '2': {'precision': 0.3867644491007508, 'recall': 0.47060906515580736, 'f1-score': 0.4245870738954027, 'support': 28240}, 'accuracy': 0.374816585412032, 'macro avg': {'precision': 0.37692804570250926, 'recall': 0.374939095831541, 'f1-score': 0.36945348502991654, 'support': 84508}, 'weighted avg': {'precision': 0.37701303348395004, 'recall': 0.374816585412032, 'f1-score': 0.36941560234772136, 'support': 84508}}
[[ 7293 10775 10214]
 [ 6036 11092 10858]
 [ 5240  9710 13290]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3197665
{'0': {'precision': 0.42665562913907285, 'recall': 0.2065565886502084, 'f1-score': 0.2783538561244329, 'support': 12476}, '1': {'precision': 0.3107848861456335, 'recall': 0.36266303289857893, 'f1-score': 0.3347257781970085, 'support': 10274}, '2': {'precision': 0.39080115135524107, 'recall': 0.5451275616896696, 'f1-score': 0.45524082288428624, 'support': 11955}, 'accuracy': 0.369399222014119, 'macro avg': {'precision': 0.3760805555466491, 'recall': 0.3714490610794856, 'f1-score': 0.3561068190685759, 'support': 34705}, 'weighted avg': {'precision': 0.38000251588679496, 'recall': 0.369399222014119, 'f1-score': 0.35597520218372375, 'support': 34705}}
[[2577 4424 5475]
 [1864 3726 4684]
 [1599 3839 6517]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
2900/2900 - 33s - 33s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3074963
{'0': {'precision': 0.46490926139128574, 'recall': 0.1494017446095988, 'f1-score': 0.2261338444485498, 'support': 262179}, '1': {'precision': 0.3124475669442582, 'recall': 0.4463513951228541, 'f1-score': 0.3675846024575249, 'support': 216110}, '2': {'precision': 0.40715500117351405, 'recall': 0.538688751803506, 'f1-score': 0.4637760067291877, 'support': 264069}, 'accuracy': 0.3743234396342465, 'macro avg': {'precision': 0.3948372765030193, 'recall': 0.378147297178653, 'f1-score': 0.35249815121175415, 'support': 742358}, 'weighted avg': {'precision': 0.39998154925186796, 'recall': 0.3743234396342465, 'f1-score': 0.3518452282614883, 'support': 742358}}
[[ 39170 112605 110404]
 [ 22926  96461  96723]
 [ 22157  99661 142251]]
Evaluating performance on  train set...
694/694 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2295934
{'0': {'precision': 0.4468764411649934, 'recall': 0.21112526396942982, 'f1-score': 0.2867679699504866, 'support': 59666}, '1': {'precision': 0.35278542434563526, 'recall': 0.5127140193253094, 'f1-score': 0.41797377040118294, 'support': 58990}, '2': {'precision': 0.4110802280114948, 'recall': 0.4441013809249143, 'f1-score': 0.426953281088178, 'support': 58946}, 'accuracy': 0.3886217497550703, 'macro avg': {'precision': 0.4035806978407079, 'recall': 0.3893135547398845, 'f1-score': 0.37723167381328254, 'support': 177602}, 'weighted avg': {'precision': 0.4037436348749738, 'recall': 0.3886217497550703, 'f1-score': 0.37687502684685564, 'support': 177602}}
[[12597 29567 17502]
 [ 8744 30245 20001]
 [ 6848 25920 26178]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2024385
{'0': {'precision': 0.46338124572210815, 'recall': 0.20440821256038647, 'f1-score': 0.2836790278650744, 'support': 19872}, '1': {'precision': 0.3769633507853403, 'recall': 0.5276707695198722, 'f1-score': 0.43976351748169606, 'support': 21286}, '2': {'precision': 0.40506612867070163, 'recall': 0.4584200111624131, 'f1-score': 0.4300947303279859, 'support': 19709}, 'accuracy': 0.3997075591042765, 'macro avg': {'precision': 0.4151369083927167, 'recall': 0.39683299774755726, 'f1-score': 0.3845124252249188, 'support': 60867}, 'weighted avg': {'precision': 0.41427706852280133, 'recall': 0.3997075591042765, 'f1-score': 0.3856738941443544, 'support': 60867}}
[[ 4062  9849  5961]
 [ 2745 11232  7309]
 [ 1959  8715  9035]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
7167/7167 - 85s - 85s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86987
{'0': {'precision': 0.5389071243429181, 'recall': 0.4224687788562652, 'f1-score': 0.47363665758725354, 'support': 421269}, '1': {'precision': 0.6985234495193542, 'recall': 0.6187683106701958, 'f1-score': 0.6562315014563125, 'support': 989860}, '2': {'precision': 0.441228593011433, 'recall': 0.653839250712022, 'f1-score': 0.526894428141331, 'support': 423442}, 'accuracy': 0.581787240722763, 'macro avg': {'precision': 0.5595530556245684, 'recall': 0.565025446746161, 'f1-score': 0.552254195728299, 'support': 1834571}, 'weighted avg': {'precision': 0.6024841802186952, 'recall': 0.581787240722763, 'f1-score': 0.58444998071903, 'support': 1834571}}
[[177973 155264  88032]
 [114779 612494 262587]
 [ 37496 109083 276863]]
Evaluating performance on  train set...
1570/1570 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8520518
{'0': {'precision': 0.4902067062504619, 'recall': 0.49272562931045155, 'f1-score': 0.49146294020661846, 'support': 80763}, '1': {'precision': 0.7820912587049164, 'recall': 0.564248160707888, 'f1-score': 0.655545767830868, 'support': 240038}, '2': {'precision': 0.39836979021738395, 'recall': 0.7255679992088803, 'f1-score': 0.5143422960817732, 'support': 80898}, 'accuracy': 0.5823564410167812, 'macro avg': {'precision': 0.5568892517242541, 'recall': 0.5941805964090733, 'f1-score': 0.5537836680397532, 'support': 401699}, 'weighted avg': {'precision': 0.646129328335203, 'recall': 0.5823564410167812, 'f1-score': 0.5941194265530069, 'support': 401699}}
[[ 39794  22082  18887]
 [ 34838 135441  69759]
 [  6546  15655  58697]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9072642
{'0': {'precision': 0.48616734143049933, 'recall': 0.4101323466628718, 'f1-score': 0.4449247394828252, 'support': 28108}, '1': {'precision': 0.7868043815567032, 'recall': 0.48743920460251644, 'f1-score': 0.6019560248755337, 'support': 69701}, '2': {'precision': 0.3788504341029954, 'recall': 0.7980387244551018, 'f1-score': 0.513790640337335, 'support': 27941}, 'accuracy': 0.5391729622266401, 'macro avg': {'precision': 0.5506073856967327, 'recall': 0.5652034252401633, 'f1-score': 0.5202238015652313, 'support': 125750}, 'weighted avg': {'precision': 0.6289598712611056, 'recall': 0.5391729622266401, 'f1-score': 0.5472660496930282, 'support': 125750}}
[[11528  5811 10769]
 [ 9936 33975 25790]
 [ 2248  3395 22298]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
6357/6357 - 73s - 73s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0108218
{'0': {'precision': 0.671024115036637, 'recall': 0.04911778851601629, 'f1-score': 0.09153534993289472, 'support': 397127}, '1': {'precision': 0.5655088317236836, 'recall': 0.7627978663198834, 'f1-score': 0.6495020026011002, 'support': 830490}, '2': {'precision': 0.418143162361863, 'recall': 0.5001126261412783, 'f1-score': 0.45546933142168766, 'support': 399552}, 'accuracy': 0.5241145818289311, 'macro avg': {'precision': 0.5515587030407278, 'recall': 0.43734276032572605, 'f1-score': 0.39883556131856085, 'support': 1627169}, 'weighted avg': {'precision': 0.5550752012841712, 'recall': 0.5241145818289311, 'f1-score': 0.4656798152872791, 'support': 1627169}}
[[ 19506 291102  86519]
 [  5457 633496 191537]
 [  4106 195625 199821]]
Evaluating performance on  train set...
1701/1701 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92493045
{'0': {'precision': 0.5401760110748541, 'recall': 0.26364101425634395, 'f1-score': 0.35434071921540145, 'support': 103603}, '1': {'precision': 0.607406052651397, 'recall': 0.7486838790096936, 'f1-score': 0.6706857842030862, 'support': 226233}, '2': {'precision': 0.4551509433962264, 'recall': 0.45695288969710746, 'f1-score': 0.4560501365900691, 'support': 105582}, 'accuracy': 0.5625330142529708, 'macro avg': {'precision': 0.5342443357074925, 'recall': 0.489759260987715, 'f1-score': 0.4936922133361856, 'support': 435418}, 'weighted avg': {'precision': 0.5544899285067039, 'recall': 0.5625330142529708, 'f1-score': 0.5433691397047038, 'support': 435418}}
[[ 27314  59751  16538]
 [ 15640 169377  41216]
 [  7611  49725  48246]]
Evaluating performance on  val set...
563/563 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94848204
{'0': {'precision': 0.568343990362339, 'recall': 0.1758415046734331, 'f1-score': 0.26858481683417634, 'support': 34878}, '1': {'precision': 0.593242054745437, 'recall': 0.7347633136094674, 'f1-score': 0.6564619515916832, 'support': 74360}, '2': {'precision': 0.4392382617989264, 'recall': 0.5193130582119985, 'f1-score': 0.47593104355836297, 'support': 34821}, 'accuracy': 0.54736600975989, 'macro avg': {'precision': 0.5336081023022341, 'recall': 0.4766392921649663, 'f1-score': 0.4669926039947408, 'support': 144059}, 'weighted avg': {'precision': 0.5499892155355013, 'recall': 0.54736600975989, 'f1-score': 0.5189166024312658, 'support': 144059}}
[[ 6133 22239  6506]
 [ 3143 54637 16580]
 [ 1515 15223 18083]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
7459/7459 - 88s - 88s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031239
{'0': {'precision': 0.5433743412267602, 'recall': 0.22651216716512299, 'f1-score': 0.31973777503981027, 'support': 607208}, '1': {'precision': 0.4040921441444738, 'recall': 0.6641191532612732, 'f1-score': 0.5024573944509128, 'support': 665093}, '2': {'precision': 0.4780973219502752, 'recall': 0.4226344297040584, 'f1-score': 0.4486583017294037, 'support': 636950}, 'accuracy': 0.44438264010337036, 'macro avg': {'precision': 0.4751879357738364, 'recall': 0.43775525004348487, 'f1-score': 0.42361782374004225, 'support': 1909251}, 'weighted avg': {'precision': 0.4730777632848311, 'recall': 0.44438264010337036, 'f1-score': 0.426398171869732, 'support': 1909251}}
[[137540 340871 128797]
 [ 58327 441701 165065]
 [ 57255 310498 269197]]
Evaluating performance on  train set...
1664/1664 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92559433
{'0': {'precision': 0.5156106330712119, 'recall': 0.36239908172812596, 'f1-score': 0.4256372493485896, 'support': 103673}, '1': {'precision': 0.6419728000453647, 'recall': 0.6225877263332523, 'f1-score': 0.6321316814982841, 'support': 218207}, '2': {'precision': 0.42246144276848696, 'recall': 0.5742436324856125, 'f1-score': 0.48679554163731215, 'support': 104083}, 'accuracy': 0.5474489568342791, 'macro avg': {'precision': 0.5266816252950212, 'recall': 0.5197434801823303, 'f1-score': 0.5148548241613953, 'support': 425963}, 'weighted avg': {'precision': 0.5575810910561788, 'recall': 0.5474489568342791, 'f1-score': 0.5463615120013917, 'support': 425963}}
[[ 37571  42226  23876]
 [ 24521 135853  57833]
 [ 10775  33539  59769]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97703165
{'0': {'precision': 0.5223121489540489, 'recall': 0.31703846876593916, 'f1-score': 0.39457418729745075, 'support': 37251}, '1': {'precision': 0.5612360159066644, 'recall': 0.6320861579213356, 'f1-score': 0.5945578231292517, 'support': 57383}, '2': {'precision': 0.458453869776136, 'recall': 0.5487720419796495, 'f1-score': 0.49956353055286123, 'support': 37542}, 'accuracy': 0.5196329136908364, 'macro avg': {'precision': 0.5140006782122831, 'recall': 0.49929888955564145, 'f1-score': 0.4962318469931879, 'support': 132176}, 'weighted avg': {'precision': 0.5210728978074317, 'recall': 0.5196329136908364, 'f1-score': 0.5112154148987615, 'support': 132176}}
[[11810 15623  9818]
 [ 6594 36271 14518]
 [ 4207 12733 20602]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
8238/8238 - 98s - 98s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1539809
{'0': {'precision': 0.5535100567003581, 'recall': 0.20759694012134003, 'f1-score': 0.3019470181649181, 'support': 735454}, '1': {'precision': 0.3648670506410121, 'recall': 0.6474489764084134, 'f1-score': 0.4667174916734695, 'support': 641076}, '2': {'precision': 0.48677696885669824, 'recall': 0.4622567551325896, 'f1-score': 0.47420009723387835, 'support': 732184}, 'accuracy': 0.4297401164880586, 'macro avg': {'precision': 0.46838469206602285, 'recall': 0.43910089055411433, 'f1-score': 0.4142882023574219, 'support': 2108714}, 'weighted avg': {'precision': 0.4729892260224077, 'recall': 0.4297401164880586, 'f1-score': 0.4118487613695422, 'support': 2108714}}
[[152678 396289 186487]
 [ 55654 415064 170358]
 [ 67504 326223 338457]]
Evaluating performance on  train set...
1806/1806 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0097567
{'0': {'precision': 0.5333741739549798, 'recall': 0.3105109799219947, 'f1-score': 0.3925143999961632, 'support': 131786}, '1': {'precision': 0.5416155629761595, 'recall': 0.607798026884205, 'f1-score': 0.5728014239794735, 'support': 199076}, '2': {'precision': 0.4474635892372254, 'recall': 0.552219708913108, 'f1-score': 0.4943529885014369, 'support': 131301}, 'accuracy': 0.5072366243078741, 'macro avg': {'precision': 0.5074844420561215, 'recall': 0.49017623857310255, 'f1-score': 0.4865562708256912, 'support': 462163}, 'weighted avg': {'precision': 0.5125168510553848, 'recall': 0.5072366243078741, 'f1-score': 0.49910520907398304, 'support': 462163}}
[[ 40921  57020  33845]
 [ 22390 120998  55688]
 [ 13410  45384  72507]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0203301
{'0': {'precision': 0.5416357978959846, 'recall': 0.3005920565742949, 'f1-score': 0.3866208355367531, 'support': 48644}, '1': {'precision': 0.5102541768944493, 'recall': 0.667268235676987, 'f1-score': 0.5782928642855311, 'support': 67601}, '2': {'precision': 0.46714224393434584, 'recall': 0.4753624394200969, 'f1-score': 0.47121649484536077, 'support': 48077}, 'accuracy': 0.5025742140431592, 'macro avg': {'precision': 0.5063440729082599, 'recall': 0.4810742438904596, 'f1-score': 0.478710064889215, 'support': 164322}, 'weighted avg': {'precision': 0.5069304294417394, 'recall': 0.5025742140431592, 'f1-score': 0.4902242868580982, 'support': 164322}}
[[14622 23392 10630]
 [ 7054 45108 15439]
 [ 5320 19903 22854]]
testing model on single stock: results/universal/W5/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
31315/31315 - 384s - 384s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4264535
{'0': {'precision': 0.5564435564435565, 'recall': 0.016143315804219224, 'f1-score': 0.03137635350816799, 'support': 3105310}, '1': {'precision': 0.2150853765390827, 'recall': 0.9360117517528851, 'f1-score': 0.34979227229852256, 'support': 1731146}, '2': {'precision': 0.5137116218438827, 'recall': 0.06344908695829914, 'f1-score': 0.11294785964729614, 'support': 3180030}, 'accuracy': 0.23355283100350951, 'macro avg': {'precision': 0.42841351827550733, 'recall': 0.3385347181718012, 'f1-score': 0.1647054951513289, 'support': 8016486}, 'weighted avg': {'precision': 0.46577668798100186, 'recall': 0.23355283100350951, 'f1-score': 0.13249600628593855, 'support': 8016486}}
[[  50130 2955040  100140]
 [  19914 1620373   90859]
 [  20046 2958214  201770]]
Evaluating performance on  train set...
5759/5759 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2041907
{'0': {'precision': 0.48296872182595096, 'recall': 0.2326466881049723, 'f1-score': 0.3140264226617062, 'support': 495064}, '1': {'precision': 0.35514716293933907, 'recall': 0.7808254198640107, 'f1-score': 0.4882299745849181, 'support': 485038}, '2': {'precision': 0.48428196767791326, 'recall': 0.16594207298560934, 'f1-score': 0.24718481200423298, 'support': 494070}, 'accuracy': 0.39065455048664605, 'macro avg': {'precision': 0.44079928414773445, 'recall': 0.3931380603181975, 'f1-score': 0.34981373641695246, 'support': 1474172}, 'weighted avg': {'precision': 0.44135249393587744, 'recall': 0.39065455048664605, 'f1-score': 0.34894155321648074, 'support': 1474172}}
[[115175 342720  37169]
 [ 56168 378730  50140]
 [ 67130 344953  81987]]
Evaluating performance on  val set...
2129/2129 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2529966
{'0': {'precision': 0.4635519949234552, 'recall': 0.12213357576137557, 'f1-score': 0.1933298873152073, 'support': 191397}, '1': {'precision': 0.3003368765621292, 'recall': 0.840417279491619, 'f1-score': 0.4425288295324208, 'support': 161139}, '2': {'precision': 0.4844398578144708, 'recall': 0.10978981725951643, 'f1-score': 0.17901012249532855, 'support': 192404}, 'accuracy': 0.3301721290417294, 'macro avg': {'precision': 0.4161095764333518, 'recall': 0.3574468908375037, 'f1-score': 0.2716229464476522, 'support': 544940}, 'weighted avg': {'precision': 0.42266416766551357, 'recall': 0.3301721290417294, 'f1-score': 0.26196219237546275, 'support': 544940}}
[[ 23376 156802  11219]
 [ 14453 135424  11262]
 [ 12599 158681  21124]]
training model: results/universal/W5/deepOF_L1/h10
Epoch 1/50
9913/9913 - 200s - loss: 2.9557 - accuracy10: 0.5104 - val_loss: 3.9441 - val_accuracy10: 0.4845 - 200s/epoch - 20ms/step
Epoch 2/50
9913/9913 - 195s - loss: 2.9337 - accuracy10: 0.5145 - val_loss: 3.9605 - val_accuracy10: 0.4855 - 195s/epoch - 20ms/step
Epoch 3/50
9913/9913 - 194s - loss: 2.9155 - accuracy10: 0.5191 - val_loss: 3.9946 - val_accuracy10: 0.4845 - 194s/epoch - 20ms/step
Epoch 4/50
9913/9913 - 193s - loss: 2.8982 - accuracy10: 0.5220 - val_loss: 4.1073 - val_accuracy10: 0.4860 - 193s/epoch - 19ms/step
Epoch 5/50
9913/9913 - 192s - loss: 2.8837 - accuracy10: 0.5235 - val_loss: 4.0942 - val_accuracy10: 0.4854 - 192s/epoch - 19ms/step
Epoch 6/50
9913/9913 - 193s - loss: 2.8718 - accuracy10: 0.5247 - val_loss: 4.0870 - val_accuracy10: 0.4859 - 193s/epoch - 19ms/step
Epoch 7/50
9913/9913 - 190s - loss: 2.8616 - accuracy10: 0.5254 - val_loss: 4.0864 - val_accuracy10: 0.4871 - 190s/epoch - 19ms/step
Epoch 8/50
9913/9913 - 187s - loss: 2.8534 - accuracy10: 0.5267 - val_loss: 4.0129 - val_accuracy10: 0.4875 - 187s/epoch - 19ms/step
Epoch 9/50
9913/9913 - 192s - loss: 2.8460 - accuracy10: 0.5281 - val_loss: 4.0533 - val_accuracy10: 0.4880 - 192s/epoch - 19ms/step
Epoch 10/50
9913/9913 - 192s - loss: 2.8391 - accuracy10: 0.5290 - val_loss: 4.0780 - val_accuracy10: 0.4888 - 192s/epoch - 19ms/step
Epoch 11/50
9913/9913 - 192s - loss: 2.8328 - accuracy10: 0.5298 - val_loss: 4.0296 - val_accuracy10: 0.4893 - 192s/epoch - 19ms/step
testing model in sample: results/universal/W5/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 608s - 608s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1338376
{'0': {'precision': 0.4359548689673976, 'recall': 0.060871344546879265, 'f1-score': 0.10682672658551857, 'support': 3782568}, '1': {'precision': 0.4049229373494181, 'recall': 0.9205088523997582, 'f1-score': 0.5624358058295676, 'support': 5223047}, '2': {'precision': 0.42564129573568676, 'recall': 0.048496497685344024, 'f1-score': 0.08707220727752671, 'support': 3832751}, 'accuracy': 0.40690427426667847, 'macro avg': {'precision': 0.4221730340175008, 'recall': 0.34329223154399385, 'f1-score': 0.2521115798975377, 'support': 12838366}, 'weighted avg': {'precision': 0.420251110758689, 'recall': 0.40690427426667847, 'f1-score': 0.2862851935653638, 'support': 12838366}}
[[ 230250 3493606   58712]
 [ 223079 4807861  192107]
 [  74822 3572054  185875]]
Evaluating performance on  train set...
9913/9913 - 113s - 113s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9872336
{'0': {'precision': 0.4059842242101088, 'recall': 0.09656220521957866, 'f1-score': 0.156016358602237, 'support': 572460}, '1': {'precision': 0.552604014510614, 'recall': 0.9168680295724384, 'f1-score': 0.6895877413364794, 'support': 1388455}, '2': {'precision': 0.3965423205556985, 'recall': 0.06688641598580829, 'f1-score': 0.11446547232528227, 'support': 576111}, 'accuracy': 0.5387575846680326, 'macro avg': {'precision': 0.4517101864254738, 'recall': 0.3601055502592751, 'f1-score': 0.32002319075466623, 'support': 2537026}, 'weighted avg': {'precision': 0.4840817275015383, 'recall': 0.5387575846680326, 'f1-score': 0.4385920718863617, 'support': 2537026}}
[[  55278  506700   10482]
 [  67266 1273030   48159]
 [  13614  523963   38534]]
Evaluating performance on  val set...
3496/3496 - 37s - 37s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0527434
{'0': {'precision': 0.44256320486698997, 'recall': 0.06672781869001981, 'f1-score': 0.11597014644784087, 'support': 231118}, '1': {'precision': 0.48783745467927103, 'recall': 0.932994127352232, 'f1-score': 0.6406804100841402, 'support': 433365}, '2': {'precision': 0.42510227458681066, 'recall': 0.056539301975327985, 'f1-score': 0.09980444813265256, 'support': 229734}, 'accuracy': 0.48392951598996664, 'macro avg': {'precision': 0.4518343113776906, 'recall': 0.3520870826725266, 'f1-score': 0.2854850015548779, 'support': 894217}, 'weighted avg': {'precision': 0.46001859423323166, 'recall': 0.48392951598996664, 'f1-score': 0.3661077001557254, 'support': 894217}}
[[ 15422 212111   3585]
 [ 15057 404327  13981]
 [  4368 212377  12989]]
testing model out of sample: results/universal/W5/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 258s - 258s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0270761
{'0': {'precision': 0.41381958025436744, 'recall': 0.09645688412309317, 'f1-score': 0.1564475341780066, 'support': 1307465}, '1': {'precision': 0.5213074709496677, 'recall': 0.9162033825726968, 'f1-score': 0.6645148689822712, 'support': 2727628}, '2': {'precision': 0.4427122464312547, 'recall': 0.08432428070998062, 'f1-score': 0.14166529194592678, 'support': 1313726}, 'accuracy': 0.5115063717803874, 'macro avg': {'precision': 0.45927976587842995, 'recall': 0.3656615158019236, 'f1-score': 0.32087589836873487, 'support': 5348819}, 'weighted avg': {'precision': 0.47572932651561456, 'recall': 0.5115063717803874, 'f1-score': 0.4119055843268161, 'support': 5348819}}
[[ 126114 1143310   38041]
 [ 127158 2499062  101408]
 [  51484 1151463  110779]]
Evaluating performance on  train set...
4957/4957 - 55s - 55s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9559989
{'0': {'precision': 0.4028426689065043, 'recall': 0.11471550032701112, 'f1-score': 0.17857818140564505, 'support': 267575}, '1': {'precision': 0.5899083909303036, 'recall': 0.9123151319600703, 'f1-score': 0.7165143446568263, 'support': 730183}, '2': {'precision': 0.43056814387253733, 'recall': 0.1000731755992638, 'f1-score': 0.16240092841656395, 'support': 270582}, 'accuracy': 0.5707696674393301, 'macro avg': {'precision': 0.4744397345697817, 'recall': 0.37570126929544845, 'f1-score': 0.35249781815967846, 'support': 1268340}, 'weighted avg': {'precision': 0.5164511844242385, 'recall': 0.5707696674393301, 'f1-score': 0.4848167042173089, 'support': 1268340}}
[[ 30695 228894   7986]
 [ 36201 666157  27825]
 [  9300 234204  27078]]
Evaluating performance on  val set...
1701/1701 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9638532
{'0': {'precision': 0.4266066949225846, 'recall': 0.10469225952302615, 'f1-score': 0.16812537817131268, 'support': 94219}, '1': {'precision': 0.5800694430218981, 'recall': 0.921223211744134, 'f1-score': 0.7118844332433545, 'support': 245910}, '2': {'precision': 0.4451709321875584, 'recall': 0.10039919528970624, 'f1-score': 0.16384622656914732, 'support': 94941}, 'accuracy': 0.5652745535201232, 'macro avg': {'precision': 0.48394902337734697, 'recall': 0.3754382221856221, 'f1-score': 0.34795201266127146, 'support': 435070}, 'weighted avg': {'precision': 0.5173979046940607, 'recall': 0.5652745535201232, 'f1-score': 0.4745347428724059, 'support': 435070}}
[[  9864  81725   2630]
 [ 10122 226538   9250]
 [  3136  82273   9532]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2478008
{'0': {'precision': 0.4101326899879373, 'recall': 0.02669478217955045, 'f1-score': 0.05012689687128129, 'support': 89156}, '1': {'precision': 0.3613529767103628, 'recall': 0.9671991019659941, 'f1-score': 0.5261371084755828, 'support': 97101}, '2': {'precision': 0.4485831402602032, 'recall': 0.029591572809141996, 'f1-score': 0.055520629983787186, 'support': 85058}, 'accuracy': 0.36420028380295966, 'macro avg': {'precision': 0.4066896023195011, 'recall': 0.3411618189848955, 'f1-score': 0.2105948784435504, 'support': 271315}, 'weighted avg': {'precision': 0.4047292270769026, 'recall': 0.36420028380295966, 'f1-score': 0.22217727266352574, 'support': 271315}}
[[ 2380 85396  1380]
 [ 1471 93916  1714]
 [ 1952 80589  2517]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1145827
{'0': {'precision': 0.36381709741550694, 'recall': 0.02999016715830875, 'f1-score': 0.055412566237698704, 'support': 18306}, '1': {'precision': 0.47646769065424743, 'recall': 0.9706257982120051, 'f1-score': 0.6391733998137746, 'support': 32886}, '2': {'precision': 0.39193825042881647, 'recall': 0.024734791080320416, 'f1-score': 0.04653293961918339, 'support': 18476}, 'accuracy': 0.47261296434518, 'macro avg': {'precision': 0.41074101283285697, 'recall': 0.34178358548354476, 'f1-score': 0.24703963522355224, 'support': 69668}, 'weighted avg': {'precision': 0.4244502982009913, 'recall': 0.47261296434518, 'f1-score': 0.3286154540998326, 'support': 69668}}
[[  549 17459   298]
 [  555 31920   411]
 [  405 17614   457]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1316369
{'0': {'precision': 0.3177304964539007, 'recall': 0.03308714918759232, 'f1-score': 0.05993311036789298, 'support': 6770}, '1': {'precision': 0.46194652406417114, 'recall': 0.9609326332651064, 'f1-score': 0.6239454524442389, 'support': 11237}, '2': {'precision': 0.37054631828978624, 'recall': 0.02402217431475208, 'f1-score': 0.04511930585683298, 'support': 6494}, 'accuracy': 0.4562262764785111, 'macro avg': {'precision': 0.3834077796026194, 'recall': 0.3393473189224836, 'f1-score': 0.24299928955632163, 'support': 24501}, 'weighted avg': {'precision': 0.3978717743306751, 'recall': 0.4562262764785111, 'f1-score': 0.3146821345471949, 'support': 24501}}
[[  224  6427   119]
 [  293 10798   146]
 [  188  6150   156]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8025044
{'0': {'precision': 0.44489507367167735, 'recall': 0.14800099022156207, 'f1-score': 0.2221128304200026, 'support': 80790}, '1': {'precision': 0.7329256831280195, 'recall': 0.9505204070582962, 'f1-score': 0.8276603839368826, 'support': 397093}, '2': {'precision': 0.4455337062453146, 'recall': 0.09500971494626036, 'f1-score': 0.1566202779270011, 'support': 81318}, 'accuracy': 0.710170403844056, 'macro avg': {'precision': 0.5411181543483371, 'recall': 0.39784370407537284, 'f1-score': 0.4021311640946288, 'support': 559201}, 'weighted avg': {'precision': 0.6495207290701304, 'recall': 0.710170403844056, 'f1-score': 0.642593071487262, 'support': 559201}}
[[ 11957  66607   2226]
 [ 12259 377445   7389]
 [  2660  70932   7726]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6771209
{'0': {'precision': 0.3172496984318456, 'recall': 0.17195161817587448, 'f1-score': 0.22302310790756838, 'support': 12236}, '1': {'precision': 0.85540290224069, 'recall': 0.9492384981071579, 'f1-score': 0.8998811243529553, 'support': 126001}, '2': {'precision': 0.3565525383707202, 'recall': 0.12125592226772665, 'f1-score': 0.18096836049856183, 'support': 12453}, 'accuracy': 0.8176985865020904, 'macro avg': {'precision': 0.5097350463477519, 'recall': 0.41414867951691975, 'f1-score': 0.43462419758636184, 'support': 150690}, 'weighted avg': {'precision': 0.7704800395220109, 'recall': 0.8176985865020904, 'f1-score': 0.7855095314303691, 'support': 150690}}
[[  2104   9744    388]
 [  4059 119605   2337]
 [   469  10474   1510]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70128083
{'0': {'precision': 0.37033582089552236, 'recall': 0.14415395787944807, 'f1-score': 0.207527443805541, 'support': 5508}, '1': {'precision': 0.8201486343745285, 'recall': 0.9577945679229906, 'f1-score': 0.8836434210927419, 'support': 45397}, '2': {'precision': 0.42876344086021506, 'recall': 0.11109176388647049, 'f1-score': 0.17646245332595767, 'support': 5743}, 'accuracy': 0.792843524925858, 'macro avg': {'precision': 0.5397492987100886, 'recall': 0.4043467632296364, 'f1-score': 0.4225444394080801, 'support': 56648}, 'weighted avg': {'precision': 0.7367336127851507, 'recall': 0.792843524925858, 'f1-score': 0.746208964434386, 'support': 56648}}
[[  794  4587   127]
 [ 1193 43481   723]
 [  157  4948   638]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
2341/2341 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1102824
{'0': {'precision': 0.47542122108823, 'recall': 0.0913145349309269, 'f1-score': 0.15320320709920993, 'support': 172426}, '1': {'precision': 0.438768513311274, 'recall': 0.924337366469602, 'f1-score': 0.5950676878440614, 'support': 254062}, '2': {'precision': 0.5181497882794065, 'recall': 0.09277157242896, 'f1-score': 0.15736745743077743, 'support': 172790}, 'accuracy': 0.44489202006414386, 'macro avg': {'precision': 0.47744650755963686, 'recall': 0.3694744912764963, 'f1-score': 0.30187945079134954, 'support': 599278}, 'weighted avg': {'precision': 0.47220236253132375, 'recall': 0.44489202006414386, 'f1-score': 0.3417309263243275, 'support': 599278}}
[[ 15745 151002   5679]
 [  9995 234839   9228]
 [  7378 149382  16030]]
Evaluating performance on  train set...
483/483 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0709879
{'0': {'precision': 0.4940546967895363, 'recall': 0.10046241726357784, 'f1-score': 0.16697224664071328, 'support': 33087}, '1': {'precision': 0.47337703797627717, 'recall': 0.9299531843476725, 'f1-score': 0.6273911540707722, 'support': 56605}, '2': {'precision': 0.5063814488585295, 'recall': 0.0833431952662722, 'f1-score': 0.14312933465437086, 'support': 33800}, 'accuracy': 0.47599034755287795, 'macro avg': {'precision': 0.49127106120811437, 'recall': 0.3712529322925075, 'f1-score': 0.3124975784552854, 'support': 123492}, 'weighted avg': {'precision': 0.4879505389720861, 'recall': 0.47599034755287795, 'f1-score': 0.3714885054262225, 'support': 123492}}
[[ 3324 28698  1065]
 [ 2284 52640  1681]
 [ 1120 29863  2817]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1228131
{'0': {'precision': 0.49508489722966936, 'recall': 0.09551724137931035, 'f1-score': 0.1601387483740425, 'support': 11600}, '1': {'precision': 0.4267500471710828, 'recall': 0.9255232082310301, 'f1-score': 0.5841527534360299, 'support': 17106}, '2': {'precision': 0.486404833836858, 'recall': 0.07656336688594753, 'f1-score': 0.1323015818667397, 'support': 12617}, 'accuracy': 0.43331800692108513, 'macro avg': {'precision': 0.4694132594125367, 'recall': 0.365867938832096, 'f1-score': 0.29219769455893735, 'support': 41323}, 'weighted avg': {'precision': 0.4641468650217153, 'recall': 0.43331800692108513, 'f1-score': 0.3271634571504556, 'support': 41323}}
[[ 1108 10063   429]
 [  683 15832   591]
 [  447 11204   966]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
2027/2027 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.274637
{'0': {'precision': 0.4730052556139513, 'recall': 0.026415638057730177, 'f1-score': 0.05003689589293115, 'support': 187389}, '1': {'precision': 0.2886161123911669, 'recall': 0.9587953586354985, 'f1-score': 0.4436768386622554, 'support': 147629}, '2': {'precision': 0.5028647716526673, 'recall': 0.049169449672022365, 'f1-score': 0.08957989605164716, 'support': 183854}, 'accuracy': 0.29975793644675375, 'macro avg': {'precision': 0.4214953798859285, 'recall': 0.34479348212175037, 'f1-score': 0.1944312102022779, 'support': 518872}, 'weighted avg': {'precision': 0.4311232628237172, 'recall': 0.29975793644675375, 'f1-score': 0.17604641242547314, 'support': 518872}}
[[  4950 177012   5427]
 [  2573 141546   3510]
 [  2942 171872   9040]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2071198
{'0': {'precision': 0.5253431890179514, 'recall': 0.03531750257338587, 'f1-score': 0.06618551900754982, 'support': 28173}, '1': {'precision': 0.3383198646870889, 'recall': 0.9564000850038961, 'f1-score': 0.49982878138622294, 'support': 28234}, '2': {'precision': 0.49141630901287553, 'recall': 0.04890027759982917, 'f1-score': 0.08894931054573704, 'support': 28098}, 'accuracy': 0.34757706644577246, 'macro avg': {'precision': 0.45169312090597197, 'recall': 0.34687262172570366, 'f1-score': 0.2183212036465033, 'support': 84505}, 'weighted avg': {'precision': 0.451576027151314, 'recall': 0.34757706644577246, 'f1-score': 0.2186392304404762, 'support': 84505}}
[[  995 26515   663]
 [  472 27003   759]
 [  427 26297  1374]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.241968
{'0': {'precision': 0.5042321644498187, 'recall': 0.03379802236991409, 'f1-score': 0.06334979111279909, 'support': 12338}, '1': {'precision': 0.30681438761572316, 'recall': 0.959468438538206, 'f1-score': 0.464949402023919, 'support': 10535}, '2': {'precision': 0.5273311897106109, 'recall': 0.04158215010141988, 'f1-score': 0.07708578143360752, 'support': 11832}, 'accuracy': 0.3174470537386544, 'macro avg': {'precision': 0.4461259139253843, 'recall': 0.34494953700318004, 'f1-score': 0.20179499152344185, 'support': 34705}, 'weighted avg': {'precision': 0.4521794742881272, 'recall': 0.3174470537386544, 'f1-score': 0.18994181354254847, 'support': 34705}}
[[  417 11700   221]
 [  207 10108   220]
 [  203 11137   492]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
2900/2900 - 33s - 33s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2532285
{'0': {'precision': 0.4835379306443401, 'recall': 0.06534760952748651, 'f1-score': 0.11513528985873282, 'support': 261601}, '1': {'precision': 0.29981881376304864, 'recall': 0.9353430958285421, 'f1-score': 0.4540837201585937, 'support': 216543}, '2': {'precision': 0.4935614129916378, 'recall': 0.05875272984644732, 'f1-score': 0.10500574984779815, 'support': 264209}, 'accuracy': 0.316776520065252, 'macro avg': {'precision': 0.4256393857996755, 'recall': 0.35314781173415866, 'f1-score': 0.22474158662170826, 'support': 742353}, 'weighted avg': {'precision': 0.4335148358641906, 'recall': 0.316776520065252, 'f1-score': 0.21040074215120516, 'support': 742353}}
[[ 17095 234848   9658]
 [  7731 202542   6270]
 [ 10528 238158  15523]]
Evaluating performance on  train set...
694/694 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2139223
{'0': {'precision': 0.49648443105180085, 'recall': 0.057508518241502535, 'f1-score': 0.10307742723508208, 'support': 60165}, '1': {'precision': 0.33087228451944783, 'recall': 0.9305427862681492, 'f1-score': 0.4881673362969973, 'support': 57647}, '2': {'precision': 0.5307393910896908, 'recall': 0.07551430005017562, 'f1-score': 0.13221664201941521, 'support': 59790}, 'accuracy': 0.34694429116789227, 'macro avg': {'precision': 0.4526987022203131, 'recall': 0.35452186818660913, 'f1-score': 0.2411538018504982, 'support': 177602}, 'weighted avg': {'precision': 0.45426114893512926, 'recall': 0.34694429116789227, 'f1-score': 0.23788171795054425, 'support': 177602}}
[[ 3460 54887  1818]
 [ 1830 53643  2174]
 [ 1679 53596  4515]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.186652
{'0': {'precision': 0.49288537549407113, 'recall': 0.06294165152432869, 'f1-score': 0.11162832333721243, 'support': 19812}, '1': {'precision': 0.353678268373364, 'recall': 0.9338301609151753, 'f1-score': 0.5130458593576822, 'support': 21067}, '2': {'precision': 0.5204570586067084, 'recall': 0.07064238543125875, 'f1-score': 0.12439980617593938, 'support': 19988}, 'accuracy': 0.3668983192863128, 'macro avg': {'precision': 0.45567356749138116, 'recall': 0.3558047326235876, 'f1-score': 0.24969132962361132, 'support': 60867}, 'weighted avg': {'precision': 0.45375787908950804, 'recall': 0.3668983192863128, 'f1-score': 0.2547590777743247, 'support': 60867}}
[[ 1247 17964   601]
 [  694 19673   700]
 [  589 17987  1412]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/EXC
Evaluating performance on  test set...
7167/7167 - 84s - 84s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8486262
{'0': {'precision': 0.3157647617862355, 'recall': 0.20707756458769236, 'f1-score': 0.25012434745591827, 'support': 269556}, '1': {'precision': 0.7239023108508154, 'recall': 0.8387803941356424, 'f1-score': 0.777118814553478, 'support': 1294123}, '2': {'precision': 0.3053360370433541, 'recall': 0.17843233525418348, 'f1-score': 0.22523928907611582, 'support': 270887}, 'accuracy': 0.6484580004208079, 'macro avg': {'precision': 0.4483343698934683, 'recall': 0.4080967646591727, 'f1-score': 0.4174941503618374, 'support': 1834566}, 'weighted avg': {'precision': 0.6021295932769948, 'recall': 0.6484580004208079, 'f1-score': 0.6181975712779916, 'support': 1834566}}
[[  55819  206023    7714]
 [ 106386 1085485  102252]
 [  14569  207983   48335]]
Evaluating performance on  train set...
1570/1570 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7985253
{'0': {'precision': 0.3101377424548312, 'recall': 0.2414163517008156, 'f1-score': 0.271495844565497, 'support': 50270}, '1': {'precision': 0.7758454077102874, 'recall': 0.8538218677301429, 'f1-score': 0.8129681255359612, 'support': 300900}, '2': {'precision': 0.3216444981862152, 'recall': 0.2000435393536385, 'f1-score': 0.24667195412116405, 'support': 50529}, 'accuracy': 0.6949457180625294, 'macro avg': {'precision': 0.4692092161171113, 'recall': 0.43176058626153235, 'f1-score': 0.44371197474087404, 'support': 401699}, 'weighted avg': {'precision': 0.6604320208466568, 'recall': 0.6949457180625294, 'f1-score': 0.6739730301789811, 'support': 401699}}
[[ 12136  36033   2101]
 [ 24768 256915  19217]
 [  2227  38194  10108]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83025223
{'0': {'precision': 0.34829234176477447, 'recall': 0.16125202374527792, 'f1-score': 0.2204433951824117, 'support': 18530}, '1': {'precision': 0.7253838873011643, 'recall': 0.8890102711956032, 'f1-score': 0.7989049303436515, 'support': 88792}, '2': {'precision': 0.34910179640718564, 'recall': 0.15818319947905363, 'f1-score': 0.21771603555157218, 'support': 18428}, 'accuracy': 0.6746719681908548, 'macro avg': {'precision': 0.4742593418243748, 'recall': 0.4028151648066449, 'f1-score': 0.4123547870258784, 'support': 125750}, 'weighted avg': {'precision': 0.6146750784758479, 'recall': 0.6746719681908548, 'f1-score': 0.6284950599677771, 'support': 125750}}
[[ 2988 14998   544]
 [ 4964 78937  4891]
 [  627 14886  2915]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/AAL
Evaluating performance on  test set...
6357/6357 - 72s - 72s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8505324
{'0': {'precision': 0.366490424970362, 'recall': 0.16432573370788262, 'f1-score': 0.22691022869435, 'support': 257732}, '1': {'precision': 0.699342101137055, 'recall': 0.9070295850287138, 'f1-score': 0.7897599058179527, 'support': 1106438}, '2': {'precision': 0.3767171585270306, 'recall': 0.10969451774565199, 'f1-score': 0.16991289085736835, 'support': 262994}, 'accuracy': 0.6605191609450554, 'macro avg': {'precision': 0.4808498948781492, 'recall': 0.3936832788274161, 'f1-score': 0.39552767512322373, 'support': 1627164}, 'weighted avg': {'precision': 0.5944756264863283, 'recall': 0.6605191609450554, 'f1-score': 0.6004240928101894, 'support': 1627164}}
[[  42352  208649    6731]
 [  61866 1003572   41000]
 [  11343  222802   28849]]
Evaluating performance on  train set...
1701/1701 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8449595
{'0': {'precision': 0.3608955390542125, 'recall': 0.19157133542765692, 'f1-score': 0.25028555940603636, 'support': 67484}, '1': {'precision': 0.70793953858393, 'recall': 0.896505173230171, 'f1-score': 0.7911415756508906, 'support': 297783}, '2': {'precision': 0.4000266714082504, 'recall': 0.12828042365753875, 'f1-score': 0.19426425032650818, 'support': 70151}, 'accuracy': 0.6634796907798942, 'macro avg': {'precision': 0.4896205830154643, 'recall': 0.4054523107717889, 'f1-score': 0.41189712846114507, 'support': 435418}, 'weighted avg': {'precision': 0.6045439214769097, 'recall': 0.6634796907798942, 'f1-score': 0.6111520744150701, 'support': 435418}}
[[ 12928  52272   2284]
 [ 19606 266964  11213]
 [  3288  57864   8999]]
Evaluating performance on  val set...
563/563 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8370344
{'0': {'precision': 0.38441312578880943, 'recall': 0.16361520211289673, 'f1-score': 0.22953496404684898, 'support': 22339}, '1': {'precision': 0.7110680284975727, 'recall': 0.9109964560131663, 'f1-score': 0.7987110995047116, 'support': 99041}, '2': {'precision': 0.4009920375930035, 'recall': 0.13546765445164705, 'f1-score': 0.20251829388885229, 'support': 22677}, 'accuracy': 0.6730183191375636, 'macro avg': {'precision': 0.49882439729312855, 'recall': 0.4033597708592367, 'f1-score': 0.410254785813471, 'support': 144057}, 'weighted avg': {'precision': 0.6116022814852514, 'recall': 0.6730183191375636, 'f1-score': 0.6165978391775908, 'support': 144057}}
[[ 3655 17976   708]
 [ 4934 90226  3881]
 [  919 18686  3072]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/WBA
Evaluating performance on  test set...
7458/7458 - 87s - 87s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9719672
{'0': {'precision': 0.4421133798656105, 'recall': 0.10611107906475926, 'f1-score': 0.17114569422181217, 'support': 416064}, '1': {'precision': 0.5666074827238239, 'recall': 0.9214287737586041, 'f1-score': 0.7017146735965002, 'support': 1059090}, '2': {'precision': 0.4292719901691684, 'recall': 0.08610617104208325, 'f1-score': 0.14344017729509848, 'support': 434092}, 'accuracy': 0.5538327695854803, 'macro avg': {'precision': 0.47933095091953426, 'recall': 0.3712153412884822, 'f1-score': 0.33876684837113696, 'support': 1909246}, 'weighted avg': {'precision': 0.5082526384315561, 'recall': 0.5538327695854803, 'f1-score': 0.4591617786405761, 'support': 1909246}}
[[ 44149 361770  10145]
 [ 43664 975876  39550]
 [ 12046 384668  37378]]
Evaluating performance on  train set...
1664/1664 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83223414
{'0': {'precision': 0.41673121611154146, 'recall': 0.14486379751379977, 'f1-score': 0.21499217423157616, 'support': 66849}, '1': {'precision': 0.703536081182661, 'recall': 0.9241703723767173, 'f1-score': 0.7988998270606383, 'support': 291667}, '2': {'precision': 0.3925052330627457, 'recall': 0.1139891763659278, 'f1-score': 0.17667064987590772, 'support': 67445}, 'accuracy': 0.6735874880564183, 'macro avg': {'precision': 0.5042575101189827, 'recall': 0.39434111541881495, 'f1-score': 0.39685421705604074, 'support': 425961}, 'weighted avg': {'precision': 0.6092784050653944, 'recall': 0.6735874880564183, 'f1-score': 0.6087418324573902, 'support': 425961}}
[[  9684  55683   1482]
 [ 11700 269550  10417]
 [  1854  57903   7688]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.902113
{'0': {'precision': 0.44737683941138834, 'recall': 0.1114831200924708, 'f1-score': 0.17848824223860119, 'support': 25089}, '1': {'precision': 0.633077573151038, 'recall': 0.9263553553063323, 'f1-score': 0.7521385364010955, 'support': 81676}, '2': {'precision': 0.4165366614664587, 'recall': 0.1050767414403778, 'f1-score': 0.16781898177247018, 'support': 25410}, 'accuracy': 0.6137923207868357, 'macro avg': {'precision': 0.498997024676295, 'recall': 0.3809717389463936, 'f1-score': 0.36614858680405565, 'support': 132175}, 'weighted avg': {'precision': 0.556199568424734, 'recall': 0.6137923207868357, 'f1-score': 0.5309176390047937, 'support': 132175}}
[[ 2797 21713   579]
 [ 2854 75661  3161]
 [  601 22139  2670]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
8238/8238 - 89s - 89s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.031708
{'0': {'precision': 0.422017309150492, 'recall': 0.09195897825467667, 'f1-score': 0.15101194940798737, 'support': 526550}, '1': {'precision': 0.5107419526720614, 'recall': 0.9153342623143779, 'f1-score': 0.6556446332519916, 'support': 1053484}, '2': {'precision': 0.45376295373463954, 'recall': 0.09094055894453114, 'f1-score': 0.1515152947627669, 'support': 528675}, 'accuracy': 0.5030513930561306, 'macro avg': {'precision': 0.4621740718523976, 'recall': 0.3660779331711952, 'f1-score': 0.319390625807582, 'support': 2108709}, 'weighted avg': {'precision': 0.47430196341345626, 'recall': 0.5030513930561306, 'f1-score': 0.4032461668425196, 'support': 2108709}}
[[ 48421 463498  14631]
 [ 45949 964290  43245]
 [ 20367 460230  48078]]
Evaluating performance on  train set...
1806/1806 - 21s - 21s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9070804
{'0': {'precision': 0.4156375394444661, 'recall': 0.12050873685518394, 'f1-score': 0.186844363496261, 'support': 88533}, '1': {'precision': 0.634180859652365, 'recall': 0.9142402423035666, 'f1-score': 0.7488837010300102, 'support': 285262}, '2': {'precision': 0.41298752722233223, 'recall': 0.11803315792451763, 'f1-score': 0.18359443759901428, 'support': 88365}, 'accuracy': 0.6099554266920547, 'macro avg': {'precision': 0.4876019754397211, 'recall': 0.38426071236108933, 'f1-score': 0.3731075007084285, 'support': 462160}, 'weighted avg': {'precision': 0.5500237612705366, 'recall': 0.6099554266920547, 'f1-score': 0.5331341458262813, 'support': 462160}}
[[ 10669  75402   2462]
 [ 12101 260798  12363]
 [  2899  75036  10430]]
Evaluating performance on  val set...
642/642 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9276432
{'0': {'precision': 0.44234775150104155, 'recall': 0.10712801946703068, 'f1-score': 0.17248381471129268, 'support': 33698}, '1': {'precision': 0.610321924771264, 'recall': 0.9240090704809202, 'f1-score': 0.7350995269561527, 'support': 97459}, '2': {'precision': 0.45302520032516547, 'recall': 0.11762400120609076, 'f1-score': 0.18675794714668711, 'support': 33165}, 'accuracy': 0.5937366877228856, 'macro avg': {'precision': 0.501898292199157, 'recall': 0.38292036371801386, 'f1-score': 0.3647804296047108, 'support': 164322}, 'weighted avg': {'precision': 0.5441278694584343, 'recall': 0.5937366877228856, 'f1-score': 0.5090508373977964, 'support': 164322}}
[[ 3610 29304   784]
 [ 3480 90053  3926]
 [ 1071 28193  3901]]
testing model on single stock: results/universal/W5/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
31315/31315 - 346s - 346s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2516875
{'0': {'precision': 0.5286811517202166, 'recall': 0.04010118889170519, 'f1-score': 0.07454782335825665, 'support': 2828769}, '1': {'precision': 0.2913370277220396, 'recall': 0.958091911271371, 'f1-score': 0.4468083634099361, 'support': 2325112}, '2': {'precision': 0.5349933137890244, 'recall': 0.02906972682177042, 'f1-score': 0.05514316082996702, 'support': 2862600}, 'accuracy': 0.30241735744150083, 'macro avg': {'precision': 0.45167049774376017, 'recall': 0.34242094232828224, 'f1-score': 0.1921664491993866, 'support': 8016481}, 'weighted avg': {'precision': 0.46209551698853324, 'recall': 0.30241735744150083, 'f1-score': 0.17558962235299744, 'support': 8016481}}
[[ 113437 2682120   33212]
 [  58324 2227671   39117]
 [  42805 2736580   83215]]
Evaluating performance on  train set...
5759/5759 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1024731
{'0': {'precision': 0.46568936608777245, 'recall': 0.07296135270357552, 'f1-score': 0.12615717348590766, 'support': 414932}, '1': {'precision': 0.43797689376049775, 'recall': 0.9350832926831169, 'f1-score': 0.5965432250970131, 'support': 641653}, '2': {'precision': 0.4532871090264855, 'recall': 0.04258284521032793, 'f1-score': 0.07785208454188237, 'support': 417586}, 'accuracy': 0.4396063957302104, 'macro avg': {'precision': 0.4523177896249186, 'recall': 0.3502091635323401, 'f1-score': 0.26685082770826773, 'support': 1474171}, 'weighted avg': {'precision': 0.4501139681702938, 'recall': 0.4396063957302104, 'f1-score': 0.3172158039315214, 'support': 1474171}}
[[ 30274 378716   5942]
 [ 26149 599999  15505]
 [  8586 391218  17782]]
Evaluating performance on  val set...
2129/2129 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.164846
{'0': {'precision': 0.49712677377741293, 'recall': 0.04997259111244717, 'f1-score': 0.09081609152308162, 'support': 169653}, '1': {'precision': 0.38156089293835493, 'recall': 0.9485806778923973, 'f1-score': 0.5442146887487163, 'support': 206965}, '2': {'precision': 0.47466127704169475, 'recall': 0.03767206706233922, 'f1-score': 0.0698040510788199, 'support': 168321}, 'accuracy': 0.3874598808306985, 'macro avg': {'precision': 0.45111631458582085, 'recall': 0.34540844535572784, 'f1-score': 0.23494494378353925, 'support': 544939}, 'weighted avg': {'precision': 0.4462963002677018, 'recall': 0.3874598808306985, 'f1-score': 0.2565243139391409, 'support': 544939}}
[[  8478 159084   2091]
 [  5715 196323   4927]
 [  2861 159119   6341]]
training model: results/universal/W5/deepOF_L1/h20
Epoch 1/50
9913/9913 - 198s - loss: 2.9838 - accuracy20: 0.5061 - val_loss: 3.7146 - val_accuracy20: 0.4098 - 198s/epoch - 20ms/step
Epoch 2/50
9913/9913 - 194s - loss: 2.9629 - accuracy20: 0.5097 - val_loss: 3.8958 - val_accuracy20: 0.4103 - 194s/epoch - 20ms/step
Epoch 3/50
9913/9913 - 187s - loss: 2.9417 - accuracy20: 0.5144 - val_loss: 3.9992 - val_accuracy20: 0.4101 - 187s/epoch - 19ms/step
Epoch 4/50
9913/9913 - 192s - loss: 2.9249 - accuracy20: 0.5168 - val_loss: 3.9978 - val_accuracy20: 0.4115 - 192s/epoch - 19ms/step
Epoch 5/50
9913/9913 - 190s - loss: 2.9115 - accuracy20: 0.5192 - val_loss: 3.9659 - val_accuracy20: 0.4128 - 190s/epoch - 19ms/step
Epoch 6/50
9913/9913 - 189s - loss: 2.8990 - accuracy20: 0.5209 - val_loss: 3.9636 - val_accuracy20: 0.4141 - 189s/epoch - 19ms/step
Epoch 7/50
9913/9913 - 192s - loss: 2.8898 - accuracy20: 0.5224 - val_loss: 3.9724 - val_accuracy20: 0.4149 - 192s/epoch - 19ms/step
Epoch 8/50
9913/9913 - 192s - loss: 2.8822 - accuracy20: 0.5240 - val_loss: 3.9655 - val_accuracy20: 0.4156 - 192s/epoch - 19ms/step
Epoch 9/50
9913/9913 - 192s - loss: 2.8750 - accuracy20: 0.5250 - val_loss: 3.9337 - val_accuracy20: 0.4168 - 192s/epoch - 19ms/step
Epoch 10/50
9913/9913 - 187s - loss: 2.8692 - accuracy20: 0.5262 - val_loss: 3.9489 - val_accuracy20: 0.4183 - 187s/epoch - 19ms/step
Epoch 11/50
9913/9913 - 192s - loss: 2.8636 - accuracy20: 0.5274 - val_loss: 3.9583 - val_accuracy20: 0.4184 - 192s/epoch - 19ms/step
testing model in sample: results/universal/W5/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 590s - 590s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1809176
{'0': {'precision': 0.4982980257098234, 'recall': 0.05475968503864056, 'f1-score': 0.09867557187230529, 'support': 4317355}, '1': {'precision': 0.32019003730327383, 'recall': 0.9333202922938122, 'f1-score': 0.47680478118040526, 'support': 4125438}, '2': {'precision': 0.5075627622165994, 'recall': 0.03911003184340244, 'f1-score': 0.07262404863936842, 'support': 4395573}, 'accuracy': 0.3317153444605022, 'macro avg': {'precision': 0.4420169417432322, 'recall': 0.3423966697252851, 'f1-score': 0.21603480056402632, 'support': 12838366}, 'weighted avg': {'precision': 0.4442374359249053, 'recall': 0.3317153444605022, 'f1-score': 0.2112628930982323, 'support': 12838366}}
[[ 236417 4023806   57132]
 [ 165427 3850355  109656]
 [  72605 4151057  171911]]
Evaluating performance on  train set...
9913/9913 - 124s - 124s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554695
{'0': {'precision': 0.4939960198333727, 'recall': 0.08500814065189063, 'f1-score': 0.14505485798331602, 'support': 689134}, '1': {'precision': 0.4619186550818568, 'recall': 0.9352830382935943, 'f1-score': 0.6184141992066104, 'support': 1155833}, '2': {'precision': 0.4888393999897609, 'recall': 0.05518893620341618, 'f1-score': 0.09918059286592548, 'support': 692059}, 'accuracy': 0.4642471145348924, 'macro avg': {'precision': 0.4815846916349968, 'recall': 0.35849337171630036, 'f1-score': 0.2875498833519507, 'support': 2537026}, 'weighted avg': {'precision': 0.4779753870510563, 'recall': 0.4642471145348924, 'f1-score': 0.34819690280322246, 'support': 2537026}}
[[  58582  619260   11292]
 [  46156 1081031   28646]
 [  13850  640015   38194]]
Evaluating performance on  val set...
3496/3496 - 40s - 40s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1115096
{'0': {'precision': 0.5166208360889694, 'recall': 0.05519831898395225, 'f1-score': 0.09973993158923977, 'support': 268885}, '1': {'precision': 0.40293271667059216, 'recall': 0.9503724590715878, 'f1-score': 0.5659272773749884, 'support': 356415}, '2': {'precision': 0.5184424579205927, 'recall': 0.047877226058598, 'f1-score': 0.08765927605352831, 'support': 268917}, 'accuracy': 0.40979314864289096, 'macro avg': {'precision': 0.4793320035600514, 'recall': 0.3511493347047127, 'f1-score': 0.25110882833925213, 'support': 894217}, 'weighted avg': {'precision': 0.4718550957771589, 'recall': 0.40979314864289096, 'f1-score': 0.28191883134570905, 'support': 894217}}
[[ 14842 250135   3908]
 [  9637 338727   8051]
 [  4250 251792  12875]]
testing model out of sample: results/universal/W5/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 239s - 239s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0978554
{'0': {'precision': 0.4745840546697039, 'recall': 0.0831938931258693, 'f1-score': 0.14157065649323045, 'support': 1565187}, '1': {'precision': 0.42433571794615765, 'recall': 0.9268199594545697, 'f1-score': 0.5821428566374491, 'support': 2219239}, '2': {'precision': 0.4959032984827683, 'recall': 0.07203880354872465, 'f1-score': 0.12580254279716618, 'support': 1564393}, 'accuracy': 0.4299539767563644, 'macro avg': {'precision': 0.46494102369954327, 'recall': 0.3606842187097212, 'f1-score': 0.28317201864261526, 'support': 5348819}, 'weighted avg': {'precision': 0.45997122279867314, 'recall': 0.4299539767563644, 'f1-score': 0.31975344454168164, 'support': 5348819}}
[[ 130214 1394508   40465]
 [  88310 2056835   74094]
 [  55851 1395845  112697]]
Evaluating performance on  train set...
4957/4957 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.02654
{'0': {'precision': 0.4850636245222793, 'recall': 0.10468047249542826, 'f1-score': 0.17219905942971256, 'support': 323728}, '1': {'precision': 0.5006522126335421, 'recall': 0.9279939019850916, 'f1-score': 0.6504090769368627, 'support': 617906}, '2': {'precision': 0.5031705710791231, 'recall': 0.08185034863149131, 'f1-score': 0.1407973126304788, 'support': 326706}, 'accuracy': 0.49989908068814354, 'macro avg': {'precision': 0.49629546941164815, 'recall': 0.371508241037337, 'f1-score': 0.3211351496656847, 'support': 1268340}, 'weighted avg': {'precision': 0.4973221121575176, 'recall': 0.49989908068814354, 'f1-score': 0.3970833175844523, 'support': 1268340}}
[[ 33888 282115   7725]
 [ 25814 573413  18679]
 [ 10161 289804  26741]]
Evaluating performance on  val set...
1701/1701 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0373685
{'0': {'precision': 0.4956185326745595, 'recall': 0.09318038418395962, 'f1-score': 0.15686824129944085, 'support': 114112}, '1': {'precision': 0.4889509264719654, 'recall': 0.9337796360296783, 'f1-score': 0.6418255574049895, 'support': 206885}, '2': {'precision': 0.5219551714825816, 'recall': 0.08471768078335802, 'f1-score': 0.14577488158807733, 'support': 114073}, 'accuracy': 0.49068425770565655, 'macro avg': {'precision': 0.5021748768763689, 'recall': 0.37055923366566534, 'f1-score': 0.3148228934308359, 'support': 435070}, 'weighted avg': {'precision': 0.4993532688998194, 'recall': 0.49068425770565655, 'f1-score': 0.3845670978515866, 'support': 435070}}
[[ 10633 100917   2562]
 [  7411 193185   6289]
 [  3410 100999   9664]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2887319
{'0': {'precision': 0.4378020404510471, 'recall': 0.02379794127376389, 'f1-score': 0.045142060921481236, 'support': 102782}, '1': {'precision': 0.266671020834694, 'recall': 0.9674681162450345, 'f1-score': 0.4180982555898226, 'support': 71745}, '2': {'precision': 0.4716044844697666, 'recall': 0.026511551018721328, 'f1-score': 0.05020101928024338, 'support': 96788}, 'accuracy': 0.2743047748926524, 'macro avg': {'precision': 0.39202584858516926, 'recall': 0.3392592028458399, 'f1-score': 0.1711471119305157, 'support': 271315}, 'weighted avg': {'precision': 0.4046076942088878, 'recall': 0.2743047748926524, 'f1-score': 0.14556919782179276, 'support': 271315}}
[[ 2446 98645  1691]
 [ 1150 69411  1184]
 [ 1991 92231  2566]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.182978
{'0': {'precision': 0.4357084357084357, 'recall': 0.024232486107315297, 'f1-score': 0.04591154261057174, 'support': 21954}, '1': {'precision': 0.3699701217427497, 'recall': 0.972796560484659, 'f1-score': 0.5360658209308836, 'support': 25585}, '2': {'precision': 0.41141396933560476, 'recall': 0.021826562429391298, 'f1-score': 0.0414538900570742, 'support': 22129}, 'accuracy': 0.3718206350117701, 'macro avg': {'precision': 0.40569750892893003, 'recall': 0.3396185363404552, 'f1-score': 0.20781041786617652, 'support': 69668}, 'weighted avg': {'precision': 0.40384980607680493, 'recall': 0.3718206350117701, 'f1-score': 0.22450076316331952, 'support': 69668}}
[[  532 21079   343]
 [  348 24889   348]
 [  341 21305   483]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1896391
{'0': {'precision': 0.4040066777963272, 'recall': 0.030212234706616728, 'f1-score': 0.05622023463816936, 'support': 8010}, '1': {'precision': 0.3628216617590577, 'recall': 0.9622000905387053, 'f1-score': 0.5269453655210884, 'support': 8836}, '2': {'precision': 0.43070362473347545, 'recall': 0.026387981711299805, 'f1-score': 0.04972919743968489, 'support': 7655}, 'accuracy': 0.3651279539610628, 'macro avg': {'precision': 0.39917732142962015, 'recall': 0.33960010231887394, 'f1-score': 0.21096493253298088, 'support': 24501}, 'weighted avg': {'precision': 0.3974948753024925, 'recall': 0.3651279539610628, 'f1-score': 0.22395372987212203, 'support': 24501}}
[[ 242 7637  131]
 [ 198 8502  136]
 [ 159 7294  202]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8884196
{'0': {'precision': 0.5465803808370967, 'recall': 0.11463052648023746, 'f1-score': 0.18951531538803018, 'support': 102416}, '1': {'precision': 0.6543137062158, 'recall': 0.959312856945045, 'f1-score': 0.7779886191494384, 'support': 353871}, '2': {'precision': 0.5246309328535901, 'recall': 0.09634257729754941, 'f1-score': 0.1627905067603622, 'support': 102914}, 'accuracy': 0.6457928365650276, 'macro avg': {'precision': 0.5751750066354956, 'recall': 0.390095320240944, 'f1-score': 0.37676481376594356, 'support': 559201}, 'weighted avg': {'precision': 0.6107161640265268, 'recall': 0.6457928365650276, 'f1-score': 0.556991910601997, 'support': 559201}}
[[ 11740  88112   2564]
 [  7978 339473   6420]
 [  1761  91238   9915]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76656735
{'0': {'precision': 0.4255277174985204, 'recall': 0.12905348809381356, 'f1-score': 0.19804434650874533, 'support': 16714}, '1': {'precision': 0.7965369498247229, 'recall': 0.9629214252692498, 'f1-score': 0.871862052393115, 'support': 116806}, '2': {'precision': 0.494338768115942, 'recall': 0.127140361094933, 'f1-score': 0.2022607245436857, 'support': 17170}, 'accuracy': 0.7752007432477271, 'macro avg': {'precision': 0.5721344784797284, 'recall': 0.4063717581526655, 'f1-score': 0.4240557078151819, 'support': 150690}, 'weighted avg': {'precision': 0.7209526967950598, 'recall': 0.7752007432477271, 'f1-score': 0.7208285137686139, 'support': 150690}}
[[  2157  14129    428]
 [  2526 112475   1805]
 [   386  14601   2183]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7970307
{'0': {'precision': 0.5003362474781439, 'recall': 0.09922646038943718, 'f1-score': 0.1656093489148581, 'support': 7498}, '1': {'precision': 0.7488122404698665, 'recall': 0.9698856478340925, 'f1-score': 0.84513078173489, 'support': 41276}, '2': {'precision': 0.5467922307239552, 'recall': 0.11798323596647194, 'f1-score': 0.19408753786691738, 'support': 7874}, 'accuracy': 0.7362307583674622, 'macro avg': {'precision': 0.5986469062239885, 'recall': 0.3956984480633339, 'f1-score': 0.4016092228388885, 'support': 56648}, 'weighted avg': {'precision': 0.687843123251408, 'recall': 0.7362307583674622, 'f1-score': 0.664694293147455, 'support': 56648}}
[[  744  6600   154]
 [  627 40033   616]
 [  116  6829   929]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
2341/2341 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1859635
{'0': {'precision': 0.5186814493356716, 'recall': 0.08450977068552196, 'f1-score': 0.1453391524520256, 'support': 206485}, '1': {'precision': 0.32126447993014334, 'recall': 0.9268118816126577, 'f1-score': 0.477137050767157, 'support': 186574}, '2': {'precision': 0.5710478276743337, 'recall': 0.07584655148167725, 'f1-score': 0.13390751212496094, 'support': 206219}, 'accuracy': 0.34376366227360255, 'macro avg': {'precision': 0.4703312523133829, 'recall': 0.3623894012599523, 'f1-score': 0.2521279051147145, 'support': 599278}, 'weighted avg': {'precision': 0.4752392881429589, 'recall': 0.34376366227360255, 'f1-score': 0.2447044547718845, 'support': 599278}}
[[ 17450 183103   5932]
 [  7838 172919   5817]
 [  8355 182223  15641]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1528631
{'0': {'precision': 0.5426573426573427, 'recall': 0.09695636963366486, 'f1-score': 0.16451831750339213, 'support': 40018}, '1': {'precision': 0.35753315626145826, 'recall': 0.9361228838363734, 'f1-score': 0.5174404307365751, 'support': 42707}, '2': {'precision': 0.555383594959098, 'recall': 0.06161846591605956, 'f1-score': 0.11092956502539192, 'support': 40767}, 'accuracy': 0.3754980079681275, 'macro avg': {'precision': 0.4851913646259663, 'recall': 0.3648992397953659, 'f1-score': 0.26429610442178636, 'support': 123492}, 'weighted avg': {'precision': 0.4828373745555759, 'recall': 0.3754980079681275, 'f1-score': 0.2688780494502301, 'support': 123492}}
[[ 3880 35117  1021]
 [ 1738 39979   990]
 [ 1532 36723  2512]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1966172
{'0': {'precision': 0.5303215303215303, 'recall': 0.09325794446034927, 'f1-score': 0.15862194899263496, 'support': 13972}, '1': {'precision': 0.30855607790463396, 'recall': 0.9263650294378579, 'f1-score': 0.46292116717717224, 'support': 12399}, '2': {'precision': 0.5319926873857403, 'recall': 0.05838683788121991, 'f1-score': 0.10522509491954439, 'support': 14952}, 'accuracy': 0.33061491179246427, 'macro avg': {'precision': 0.45695676520396816, 'recall': 0.35933660392647576, 'f1-score': 0.24225607036311717, 'support': 41323}, 'weighted avg': {'precision': 0.46438530342384554, 'recall': 0.33061491179246427, 'f1-score': 0.2306064671585287, 'support': 41323}}
[[ 1303 12264   405]
 [  550 11486   363]
 [  604 13475   873]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
2027/2027 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2328751
{'0': {'precision': 0.460081096196868, 'recall': 0.03479727586133965, 'f1-score': 0.06470102444107989, 'support': 189124}, '1': {'precision': 0.28863604183101726, 'recall': 0.9587070593056928, 'f1-score': 0.44369093094157575, 'support': 148839}, '2': {'precision': 0.4903902726024711, 'recall': 0.02764373248428768, 'f1-score': 0.05233717236940562, 'support': 180909}, 'accuracy': 0.2973276646263433, 'macro avg': {'precision': 0.4130358035434521, 'recall': 0.3403826892171067, 'f1-score': 0.1869097092506871, 'support': 518872}, 'weighted avg': {'precision': 0.4214694392710797, 'recall': 0.2973276646263433, 'f1-score': 0.1691039341744877, 'support': 518872}}
[[  6581 179394   3149]
 [  4098 142693   2048]
 [  3625 172283   5001]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1765202
{'0': {'precision': 0.42299212598425195, 'recall': 0.047187379220687956, 'f1-score': 0.08490327475028449, 'support': 28461}, '1': {'precision': 0.3279659634282559, 'recall': 0.9432913402880554, 'f1-score': 0.4867109943938463, 'support': 27703}, '2': {'precision': 0.5136281041792853, 'recall': 0.029921315408771743, 'f1-score': 0.05654841291010936, 'support': 28341}, 'accuracy': 0.33516359978699484, 'macro avg': {'precision': 0.4215287311972644, 'recall': 0.340133344972505, 'f1-score': 0.20938756068474673, 'support': 84505}, 'weighted avg': {'precision': 0.4222371940481142, 'recall': 0.33516359978699484, 'f1-score': 0.20711703864441133, 'support': 84505}}
[[ 1343 26714   404]
 [ 1172 26132   399]
 [  660 26833   848]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2018404
{'0': {'precision': 0.4441645675902603, 'recall': 0.042640657746251816, 'f1-score': 0.07781128190041921, 'support': 12406}, '1': {'precision': 0.3022768033559291, 'recall': 0.9510328997704667, 'f1-score': 0.4587456462067216, 'support': 10456}, '2': {'precision': 0.5526742301458671, 'recall': 0.028793380055729123, 'f1-score': 0.054735152487961465, 'support': 11843}, 'accuracy': 0.3115977524852327, 'macro avg': {'precision': 0.4330385336973522, 'recall': 0.3408223125241492, 'f1-score': 0.19709736019836743, 'support': 34705}, 'weighted avg': {'precision': 0.43844497303074104, 'recall': 0.3115977524852327, 'f1-score': 0.18470536380662753, 'support': 34705}}
[[  529 11728   149]
 [  385  9944   127]
 [  277 11225   341]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
2900/2900 - 36s - 36s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.215425
{'0': {'precision': 0.45915811189154676, 'recall': 0.07142284109793134, 'f1-score': 0.12361686441882684, 'support': 261765}, '1': {'precision': 0.29490840653191597, 'recall': 0.9197592871195464, 'f1-score': 0.44661555942425113, 'support': 216025}, '2': {'precision': 0.4587231601964369, 'recall': 0.04837033145224389, 'f1-score': 0.08751282226629283, 'support': 264563}, 'accuracy': 0.3100735095028915, 'macro avg': {'precision': 0.40426322620663324, 'recall': 0.3465174865565739, 'f1-score': 0.21924841536979026, 'support': 742353}, 'weighted avg': {'precision': 0.41120637636191654, 'recall': 0.3100735095028915, 'f1-score': 0.20474268917409277, 'support': 742353}}
[[ 18696 234717   8352]
 [ 10586 198691   6748]
 [ 11436 240330  12797]]
Evaluating performance on  train set...
694/694 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1632676
{'0': {'precision': 0.4739214423696072, 'recall': 0.06272691632433906, 'f1-score': 0.11078998073217727, 'support': 58667}, '1': {'precision': 0.3439079894212436, 'recall': 0.9234682080924855, 'f1-score': 0.501174150757372, 'support': 60550}, '2': {'precision': 0.4937215399475645, 'recall': 0.06128286374925066, 'f1-score': 0.1090321794246709, 'support': 58385}, 'accuracy': 0.3557054537674125, 'macro avg': {'precision': 0.43718365724613845, 'recall': 0.3491593293886917, 'f1-score': 0.24033210363807342, 'support': 177602}, 'weighted avg': {'precision': 0.43610494323708404, 'recall': 0.3557054537674125, 'f1-score': 0.2433061250643739, 'support': 177602}}
[[ 3680 53509  1478]
 [ 2443 55916  2191]
 [ 1642 53165  3578]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1451927
{'0': {'precision': 0.48612099644128115, 'recall': 0.06969743354252768, 'f1-score': 0.12191530188763443, 'support': 19599}, '1': {'precision': 0.3625876010781671, 'recall': 0.9252992158481221, 'f1-score': 0.521011658081258, 'support': 21807}, '2': {'precision': 0.49937681761528874, 'recall': 0.061764554750526696, 'f1-score': 0.10993232119992684, 'support': 19461}, 'accuracy': 0.373700034501454, 'macro avg': {'precision': 0.44936180504491235, 'recall': 0.3522537347137255, 'f1-score': 0.2509530937229398, 'support': 60867}, 'weighted avg': {'precision': 0.44610060416277125, 'recall': 0.373700034501454, 'f1-score': 0.26106941581391424, 'support': 60867}}
[[ 1366 17778   455]
 [  879 20178   750]
 [  565 17694  1202]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/EXC
Evaluating performance on  test set...
7167/7167 - 84s - 84s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92242056
{'0': {'precision': 0.3894523574139846, 'recall': 0.17863630892565732, 'f1-score': 0.2449277225651821, 'support': 357251}, '1': {'precision': 0.6258651573785269, 'recall': 0.8773182305877131, 'f1-score': 0.7305601124300899, 'support': 1117501}, '2': {'precision': 0.4216096409587227, 'recall': 0.12212142940519269, 'f1-score': 0.18938616831452731, 'support': 359814}, 'accuracy': 0.5931446456546126, 'macro avg': {'precision': 0.4789757185837447, 'recall': 0.39269198963952107, 'f1-score': 0.38829133443659974, 'support': 1834566}, 'weighted avg': {'precision': 0.5397670264935066, 'recall': 0.5931446456546126, 'f1-score': 0.5298507247931091, 'support': 1834566}}
[[ 63818 285765   7668]
 [ 84484 980404  52613]
 [ 15564 300309  43941]]
Evaluating performance on  train set...
1570/1570 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8679305
{'0': {'precision': 0.4134362120789563, 'recall': 0.19608188939347176, 'f1-score': 0.2660047451003848, 'support': 68043}, '1': {'precision': 0.6855277444178525, 'recall': 0.8966129020107128, 'f1-score': 0.7769891023517181, 'support': 265478}, '2': {'precision': 0.4335960369286197, 'recall': 0.14121857490686146, 'f1-score': 0.21304891406569823, 'support': 68178}, 'accuracy': 0.6497427178061185, 'macro avg': {'precision': 0.5108533311418095, 'recall': 0.4113044554370153, 'f1-score': 0.4186809205059337, 'support': 401699}, 'weighted avg': {'precision': 0.5966798157744243, 'recall': 0.6497427178061185, 'f1-score': 0.5947202324331554, 'support': 401699}}
[[ 13342  52727   1974]
 [ 16844 238031  10603]
 [  2085  56465   9628]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9088682
{'0': {'precision': 0.44290865384615385, 'recall': 0.12195424647333802, 'f1-score': 0.1912484997891596, 'support': 24173}, '1': {'precision': 0.6337102797153527, 'recall': 0.9281991744066047, 'f1-score': 0.7531926474898463, 'support': 77520}, '2': {'precision': 0.4655855855855856, 'recall': 0.10741156420168765, 'f1-score': 0.17455331509440333, 'support': 24057}, 'accuracy': 0.6161908548707753, 'macro avg': {'precision': 0.5140681730490307, 'recall': 0.38585499502721016, 'f1-score': 0.37299815412446974, 'support': 125750}, 'weighted avg': {'precision': 0.5648687411959415, 'recall': 0.6161908548707753, 'f1-score': 0.5344713568194218, 'support': 125750}}
[[ 2948 20691   534]
 [ 3134 71954  2432]
 [  574 20899  2584]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/AAL
Evaluating performance on  test set...
6357/6357 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.943744
{'0': {'precision': 0.46242458170056605, 'recall': 0.10991487008743632, 'f1-score': 0.17761256074194764, 'support': 338189}, '1': {'precision': 0.5983876022842753, 'recall': 0.9320285968482604, 'f1-score': 0.7288401124406936, 'support': 946398}, '2': {'precision': 0.4620294081236847, 'recall': 0.09805094912968472, 'f1-score': 0.16177115089169183, 'support': 342577}, 'accuracy': 0.5855783436703369, 'macro avg': {'precision': 0.5076138640361754, 'recall': 0.37999813868846055, 'f1-score': 0.3560746080247777, 'support': 1627164}, 'weighted avg': {'precision': 0.5414207697774495, 'recall': 0.5855783436703369, 'f1-score': 0.4948846671862388, 'support': 1627164}}
[[ 37172 293332   7685]
 [ 32902 882070  31426]
 [ 10311 298676  33590]]
Evaluating performance on  train set...
1701/1701 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93180054
{'0': {'precision': 0.4680397727272727, 'recall': 0.1486628241424817, 'f1-score': 0.2256520883090646, 'support': 88657}, '1': {'precision': 0.6087431975195873, 'recall': 0.9253819496053383, 'f1-score': 0.7343859371386622, 'support': 255662}, '2': {'precision': 0.49164562402621825, 'recall': 0.10045115753191583, 'f1-score': 0.16681857955374071, 'support': 91099}, 'accuracy': 0.5946377963244515, 'macro avg': {'precision': 0.5228095314243594, 'recall': 0.39149864375991195, 'f1-score': 0.37561886833382246, 'support': 435418}, 'weighted avg': {'precision': 0.5555946933707357, 'recall': 0.5946377963244515, 'f1-score': 0.5120532923138861, 'support': 435418}}
[[ 13180  73305   2172]
 [ 11787 236585   7290]
 [  3193  78755   9151]]
Evaluating performance on  val set...
563/563 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9331621
{'0': {'precision': 0.4758022093634929, 'recall': 0.12180177753837867, 'f1-score': 0.19395303956256033, 'support': 29704}, '1': {'precision': 0.6071486321041649, 'recall': 0.9320449172576832, 'f1-score': 0.7353068713252608, 'support': 84600}, '2': {'precision': 0.5009115770282588, 'recall': 0.11081235505663295, 'f1-score': 0.18147791385716253, 'support': 29753}, 'accuracy': 0.5953615582720728, 'macro avg': {'precision': 0.5279541394986389, 'recall': 0.38821968328423156, 'f1-score': 0.37024594158166124, 'support': 144057}, 'weighted avg': {'precision': 0.558123695858357, 'recall': 0.5953615582720728, 'f1-score': 0.5092960062494396, 'support': 144057}}
[[ 3618 25406   680]
 [ 3144 78851  2605]
 [  842 25614  3297]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/WBA
Evaluating performance on  test set...
7458/7458 - 87s - 87s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0790486
{'0': {'precision': 0.49365397461589844, 'recall': 0.09186141120101252, 'f1-score': 0.1548985794453072, 'support': 530952}, '1': {'precision': 0.43790261114707735, 'recall': 0.9288694320438169, 'f1-score': 0.595204374764753, 'support': 821419}, '2': {'precision': 0.5038050185109009, 'recall': 0.06158114478114478, 'f1-score': 0.10974760898193915, 'support': 556875}, 'accuracy': 0.4431372384700557, 'macro avg': {'precision': 0.4784538680912922, 'recall': 0.3607706626753247, 'f1-score': 0.2866168543973331, 'support': 1909246}, 'weighted avg': {'precision': 0.47262872870197953, 'recall': 0.4431372384700557, 'f1-score': 0.33116297879914414, 'support': 1909246}}
[[ 48774 472088  10090]
 [ 34743 762991  23685]
 [ 15285 507297  34293]]
Evaluating performance on  train set...
1664/1664 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9311252
{'0': {'precision': 0.5043314331882042, 'recall': 0.12702934925157147, 'f1-score': 0.2029422654902421, 'support': 88452}, '1': {'precision': 0.6003678781571056, 'recall': 0.9378599282859867, 'f1-score': 0.73209049114204, 'support': 248487}, '2': {'precision': 0.49381044487427467, 'recall': 0.08603491271820449, 'f1-score': 0.14653885891401675, 'support': 89022}, 'accuracy': 0.5914649463213768, 'macro avg': {'precision': 0.5328365854065281, 'recall': 0.38364139675192094, 'f1-score': 0.3605238718487662, 'support': 425961}, 'weighted avg': {'precision': 0.5581560994823127, 'recall': 0.5914649463213768, 'f1-score': 0.49983637337173725, 'support': 425961}}
[[ 11236  75790   1426]
 [  9016 233046   6425]
 [  2027  79336   7659]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0030122
{'0': {'precision': 0.5204717775905644, 'recall': 0.09543376173999012, 'f1-score': 0.1612928491240895, 'support': 32368}, '1': {'precision': 0.5202386937779719, 'recall': 0.9415406187535428, 'f1-score': 0.6701775807607571, 'support': 67038}, '2': {'precision': 0.5104823936495013, 'recall': 0.07653575025176233, 'f1-score': 0.13311395361180406, 'support': 32769}, 'accuracy': 0.519886514091167, 'macro avg': {'precision': 0.5170642883393459, 'recall': 0.3711700435817651, 'f1-score': 0.32152812783221685, 'support': 132175}, 'weighted avg': {'precision': 0.5178769783093594, 'recall': 0.519886514091167, 'f1-score': 0.41240857004269615, 'support': 132175}}
[[ 3089 28660   619]
 [ 2133 63119  1786]
 [  713 29548  2508]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
8238/8238 - 100s - 100s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1259716
{'0': {'precision': 0.4780650439402869, 'recall': 0.08284728171886957, 'f1-score': 0.1412213194948827, 'support': 655966}, '1': {'precision': 0.38599957819599373, 'recall': 0.9191305665519094, 'f1-score': 0.5436760654465019, 'support': 798497}, '2': {'precision': 0.5128796370429677, 'recall': 0.07343415167994913, 'f1-score': 0.12847346176935798, 'support': 654246}, 'accuracy': 0.3965990565791676, 'macro avg': {'precision': 0.4589814197264161, 'recall': 0.3584706666502427, 'f1-score': 0.2711236155702475, 'support': 2108709}, 'weighted avg': {'precision': 0.45400449792783837, 'recall': 0.3965990565791676, 'f1-score': 0.2896622245000951, 'support': 2108709}}
[[ 54345 584819  16802]
 [ 35745 733923  28829]
 [ 23587 582615  48044]]
Evaluating performance on  train set...
1806/1806 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0057257
{'0': {'precision': 0.49447524522157177, 'recall': 0.11145483780760626, 'f1-score': 0.18190764842217863, 'support': 114432}, '1': {'precision': 0.5205705318423203, 'recall': 0.9252448565136545, 'f1-score': 0.6662748382936645, 'support': 233402}, '2': {'precision': 0.5066431292390597, 'recall': 0.09539387365953501, 'f1-score': 0.16055707681889114, 'support': 114326}, 'accuracy': 0.5184654665051065, 'macro avg': {'precision': 0.5072296354343173, 'recall': 0.37736452266026527, 'f1-score': 0.3362465211782448, 'support': 462160}, 'weighted avg': {'precision': 0.5106640058153905, 'recall': 0.5184654665051065, 'f1-score': 0.421243258170463, 'support': 462160}}
[[ 12754  98964   2714]
 [  9542 215954   7906]
 [  3497  99923  10906]]
Evaluating performance on  val set...
642/642 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0260514
{'0': {'precision': 0.5057725374600835, 'recall': 0.09615429518761529, 'f1-score': 0.16158841648845376, 'support': 42827}, '1': {'precision': 0.49825701903146785, 'recall': 0.9343285842282599, 'f1-score': 0.6499238497359978, 'support': 79243}, '2': {'precision': 0.5474683544303798, 'recall': 0.09826753763135473, 'f1-score': 0.16662653503491454, 'support': 42252}, 'accuracy': 0.500900670634486, 'macro avg': {'precision': 0.5171659703073104, 'recall': 0.3762501390157433, 'f1-score': 0.3260462670864554, 'support': 164322}, 'weighted avg': {'precision': 0.5128694534651843, 'recall': 0.500900670634486, 'f1-score': 0.39837980973865883, 'support': 164322}}
[[ 4118 37751   958]
 [ 2730 74039  2474]
 [ 1294 36806  4152]]
testing model on single stock: results/universal/W5/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
31315/31315 - 369s - 369s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.281371
{'0': {'precision': 0.5997550764674052, 'recall': 0.033559280114940915, 'f1-score': 0.06356195277221832, 'support': 3137612}, '1': {'precision': 0.21092664073115855, 'recall': 0.9649306809327429, 'f1-score': 0.3461807539363152, 'support': 1683808}, '2': {'precision': 0.5736103158093112, 'recall': 0.024768541195301124, 'f1-score': 0.04748660675710706, 'support': 3195061}, 'accuracy': 0.22568393787748015, 'macro avg': {'precision': 0.46143067766929163, 'recall': 0.34108616741432835, 'f1-score': 0.1524097711552135, 'support': 8016481}, 'weighted avg': {'precision': 0.5076639786586299, 'recall': 0.22568393787748015, 'f1-score': 0.11651711941405633, 'support': 8016481}}
[[ 105296 2998705   33611]
 [  33835 1624758   25215]
 [  36434 3079490   79137]]
Evaluating performance on  train set...
5759/5759 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1650344
{'0': {'precision': 0.5464058153100602, 'recall': 0.062451791311768666, 'f1-score': 0.11209196231813084, 'support': 487464}, '1': {'precision': 0.34039138436991684, 'recall': 0.9471086277718911, 'f1-score': 0.5007962934612507, 'support': 497359}, '2': {'precision': 0.5195236856556548, 'recall': 0.03673255025053745, 'f1-score': 0.06861381017545667, 'support': 489348}, 'accuracy': 0.3523817793186815, 'macro avg': {'precision': 0.46877362844521064, 'recall': 0.34876432311139904, 'f1-score': 0.2271673553182794, 'support': 1474171}, 'weighted avg': {'precision': 0.46797675400029165, 'recall': 0.3523817793186815, 'f1-score': 0.22880138791278548, 'support': 1474171}}
[[ 30443 450079   6942]
 [ 16624 471053   9682]
 [  8648 462725  17975]]
Evaluating performance on  val set...
2129/2129 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2115737
{'0': {'precision': 0.5622051886792453, 'recall': 0.03963832882976512, 'f1-score': 0.07405537649023337, 'support': 192440}, '1': {'precision': 0.2957872301919341, 'recall': 0.9594441842310695, 'f1-score': 0.45217373388941046, 'support': 160125}, '2': {'precision': 0.538583597795223, 'recall': 0.033523241186438915, 'f1-score': 0.06311781862313308, 'support': 192374}, 'accuracy': 0.3077555469511266, 'macro avg': {'precision': 0.4655253388888008, 'recall': 0.3442019180824245, 'f1-score': 0.19644897633425895, 'support': 544939}, 'weighted avg': {'precision': 0.4755819968586863, 'recall': 0.3077555469511266, 'f1-score': 0.18130059149855116, 'support': 544939}}
[[  7628 182396   2416]
 [  3385 153631   3109]
 [  2555 183370   6449]]
training model: results/universal/W5/deepOF_L1/h30
Epoch 1/50
9913/9913 - 198s - loss: 3.0473 - accuracy30: 0.4816 - val_loss: 3.5401 - val_accuracy30: 0.3931 - 198s/epoch - 20ms/step
Epoch 2/50
9913/9913 - 193s - loss: 3.0285 - accuracy30: 0.4850 - val_loss: 3.6475 - val_accuracy30: 0.3916 - 193s/epoch - 20ms/step
Epoch 3/50
9913/9913 - 190s - loss: 3.0091 - accuracy30: 0.4910 - val_loss: 3.8471 - val_accuracy30: 0.3898 - 190s/epoch - 19ms/step
Epoch 4/50
9913/9913 - 190s - loss: 2.9937 - accuracy30: 0.4939 - val_loss: 3.8368 - val_accuracy30: 0.3937 - 190s/epoch - 19ms/step
Epoch 5/50
9913/9913 - 191s - loss: 2.9801 - accuracy30: 0.4962 - val_loss: 3.7714 - val_accuracy30: 0.3953 - 191s/epoch - 19ms/step
Epoch 6/50
9913/9913 - 191s - loss: 2.9699 - accuracy30: 0.4976 - val_loss: 3.7768 - val_accuracy30: 0.3969 - 191s/epoch - 19ms/step
Epoch 7/50
9913/9913 - 194s - loss: 2.9617 - accuracy30: 0.4994 - val_loss: 3.7652 - val_accuracy30: 0.3971 - 194s/epoch - 20ms/step
Epoch 8/50
9913/9913 - 193s - loss: 2.9541 - accuracy30: 0.5009 - val_loss: 3.7861 - val_accuracy30: 0.3972 - 193s/epoch - 19ms/step
Epoch 9/50
9913/9913 - 192s - loss: 2.9469 - accuracy30: 0.5026 - val_loss: 3.8229 - val_accuracy30: 0.3972 - 192s/epoch - 19ms/step
Epoch 10/50
9913/9913 - 190s - loss: 2.9413 - accuracy30: 0.5039 - val_loss: 3.7597 - val_accuracy30: 0.3993 - 190s/epoch - 19ms/step
Epoch 11/50
9913/9913 - 190s - loss: 2.9358 - accuracy30: 0.5054 - val_loss: 3.7870 - val_accuracy30: 0.3994 - 190s/epoch - 19ms/step
testing model in sample: results/universal/W5/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 598s - 598s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1600446
{'0': {'precision': 0.5289247991505793, 'recall': 0.062361670308926365, 'f1-score': 0.11156904697310169, 'support': 4441382}, '1': {'precision': 0.30059547577533496, 'recall': 0.9225873850830387, 'f1-score': 0.4534491167882189, 'support': 3859526}, '2': {'precision': 0.5068573170653711, 'recall': 0.052396518050415015, 'f1-score': 0.09497497163198622, 'support': 4537458}, 'accuracy': 0.3174445252612365, 'macro avg': {'precision': 0.4454591973304285, 'recall': 0.34578185781412674, 'f1-score': 0.21999771179776895, 'support': 12838366}, 'weighted avg': {'precision': 0.4524841342515923, 'recall': 0.3174445252612365, 'f1-score': 0.20848169913024636, 'support': 12838366}}
[[ 276972 4075896   88514]
 [ 155976 3560750  142800]
 [  90703 4209008  237747]]
Evaluating performance on  train set...
9913/9913 - 116s - 116s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.063136
{'0': {'precision': 0.5222678681534199, 'recall': 0.09659805245751173, 'f1-score': 0.16304035250463822, 'support': 727789}, '1': {'precision': 0.4336970297761517, 'recall': 0.9228942304133821, 'f1-score': 0.5900915010640863, 'support': 1080840}, '2': {'precision': 0.4901093536418668, 'recall': 0.0689143420414966, 'f1-score': 0.1208376814629455, 'support': 728397}, 'accuracy': 0.44067384409935095, 'macro avg': {'precision': 0.48202475052381283, 'recall': 0.3628022083041302, 'f1-score': 0.29132317834389, 'support': 2537026}, 'weighted avg': {'precision': 0.4753014316855404, 'recall': 0.44067384409935095, 'f1-score': 0.3328587400301259, 'support': 2537026}}
[[ 70303 641704  15782]
 [ 46898 997501  36441]
 [ 17410 660790  50197]]
Evaluating performance on  val set...
3496/3496 - 40s - 40s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1028774
{'0': {'precision': 0.5299913713919893, 'recall': 0.06847531745489462, 'f1-score': 0.1212810272676896, 'support': 278071}, '1': {'precision': 0.3819090362730463, 'recall': 0.9356507799860478, 'f1-score': 0.5424171005566354, 'support': 336865}, '2': {'precision': 0.5130932896890343, 'recall': 0.06061636846043949, 'f1-score': 0.10842366503882796, 'support': 279281}, 'accuracy': 0.3926988639222918, 'macro avg': {'precision': 0.47499789911802326, 'recall': 0.35491415530046067, 'f1-score': 0.2573739309543843, 'support': 894217}, 'weighted avg': {'precision': 0.4689289346725737, 'recall': 0.3926988639222918, 'f1-score': 0.27591372419454513, 'support': 894217}}
[[ 19041 253527   5503]
 [ 11115 315188  10562]
 [  5771 256581  16929]]
testing model out of sample: results/universal/W5/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 252s - 252s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1232606
{'0': {'precision': 0.4884176582239729, 'recall': 0.0837273255257959, 'f1-score': 0.1429494461164435, 'support': 1714924}, '1': {'precision': 0.3671278629944944, 'recall': 0.9125193029071179, 'f1-score': 0.5235994273178797, 'support': 1923933}, '2': {'precision': 0.5044522895656223, 'recall': 0.08047254851277397, 'f1-score': 0.13880265874094624, 'support': 1709962}, 'accuracy': 0.3807975181063334, 'macro avg': {'precision': 0.4533326035946965, 'recall': 0.3589063923152292, 'f1-score': 0.2684505107250898, 'support': 5348819}, 'weighted avg': {'precision': 0.449916667757291, 'recall': 0.3807975181063334, 'f1-score': 0.2785409124660513, 'support': 5348819}}
[[ 143586 1515478   55860]
 [  88991 1755626   79316]
 [  61405 1510952  137605]]
Evaluating performance on  train set...
4957/4957 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0608894
{'0': {'precision': 0.5056573870795932, 'recall': 0.10838844413505047, 'f1-score': 0.1785124649166254, 'support': 359125}, '1': {'precision': 0.44474667636015447, 'recall': 0.9140524781341108, 'f1-score': 0.5983545107815627, 'support': 548800}, '2': {'precision': 0.5046016137165911, 'recall': 0.08884202932730324, 'f1-score': 0.15108370235283847, 'support': 360415}, 'accuracy': 0.4514381001939543, 'macro avg': {'precision': 0.4850018923854463, 'recall': 0.3704276505321549, 'f1-score': 0.3093168926836755, 'support': 1268340}, 'weighted avg': {'precision': 0.4790018257951944, 'recall': 0.4514381001939543, 'f1-score': 0.3523803373414092, 'support': 1268340}}
[[ 38925 309645  10555]
 [ 26287 501632  20881]
 [ 11767 316628  32020]]
Evaluating performance on  val set...
1701/1701 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0704802
{'0': {'precision': 0.5133041428090266, 'recall': 0.0966951390706417, 'f1-score': 0.1627346685442375, 'support': 126087}, '1': {'precision': 0.43282781489247574, 'recall': 0.9206564107043422, 'f1-score': 0.5888294742943135, 'support': 183178}, '2': {'precision': 0.5216509107678119, 'recall': 0.08991693493899289, 'f1-score': 0.15339345040341718, 'support': 125805}, 'accuracy': 0.44164847036109134, 'macro avg': {'precision': 0.4892609561564381, 'recall': 0.369089494904659, 'f1-score': 0.3016525310806561, 'support': 435070}, 'weighted avg': {'precision': 0.4818346605371095, 'recall': 0.44164847036109134, 'f1-score': 0.339432722603312, 'support': 435070}}
[[ 12192 110348   3547]
 [  7708 168644   6826]
 [  3852 110641  11312]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2505157
{'0': {'precision': 0.45800316957210774, 'recall': 0.02723973797068665, 'f1-score': 0.05142120012454962, 'support': 106095}, '1': {'precision': 0.24092886555566756, 'recall': 0.9591115364430587, 'f1-score': 0.38511645779876785, 'support': 64786}, '2': {'precision': 0.479645020425412, 'recall': 0.03390286158073959, 'f1-score': 0.06332939655733588, 'support': 100434}, 'accuracy': 0.2522234303300592, 'macro avg': {'precision': 0.39285901851772903, 'recall': 0.34008471199816165, 'f1-score': 0.16662235149355112, 'support': 271315}, 'weighted avg': {'precision': 0.4141803134402745, 'recall': 0.2522234303300592, 'f1-score': 0.13551079621843445, 'support': 271315}}
[[  2890 100984   2221]
 [  1176  62137   1473]
 [  2244  94785   3405]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1743836
{'0': {'precision': 0.43867069486404836, 'recall': 0.031118731247321046, 'f1-score': 0.058114868921352814, 'support': 23330}, '1': {'precision': 0.3315326160559777, 'recall': 0.963695214766862, 'f1-score': 0.4933439322861269, 'support': 22862}, '2': {'precision': 0.4685494223363286, 'recall': 0.03109558698245016, 'f1-score': 0.058320683869936885, 'support': 23476}, 'accuracy': 0.33714187288281566, 'macro avg': {'precision': 0.4129175777521183, 'recall': 0.34196984433221106, 'f1-score': 0.20325982835913883, 'support': 69668}, 'weighted avg': {'precision': 0.413580872397911, 'recall': 0.33714187288281566, 'f1-score': 0.20100742444725317, 'support': 69668}}
[[  726 22178   426]
 [  428 22032   402]
 [  501 22245   730]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1763794
{'0': {'precision': 0.3967828418230563, 'recall': 0.03528850739151168, 'f1-score': 0.06481278738778191, 'support': 8388}, '1': {'precision': 0.32776554879364667, 'recall': 0.9484201323841639, 'f1-score': 0.4871696176546061, 'support': 8007}, '2': {'precision': 0.4249146757679181, 'recall': 0.0307179866765359, 'f1-score': 0.0572940635066728, 'support': 8106}, 'accuracy': 0.33219052283580264, 'macro avg': {'precision': 0.38315435546154036, 'recall': 0.3381422088174038, 'f1-score': 0.20309215618302026, 'support': 24501}, 'weighted avg': {'precision': 0.38353502257774247, 'recall': 0.33219052283580264, 'f1-score': 0.20035273939652407, 'support': 24501}}
[[ 296 7920  172]
 [ 248 7594  165]
 [ 202 7655  249]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9435645
{'0': {'precision': 0.6021742752415862, 'recall': 0.12254291163382072, 'f1-score': 0.2036440982371129, 'support': 117975}, '1': {'precision': 0.599676207266267, 'recall': 0.9550370636652122, 'f1-score': 0.7367442149565442, 'support': 322688}, '2': {'precision': 0.5450103364029317, 'recall': 0.09785891444093878, 'f1-score': 0.1659252478150792, 'support': 118538}, 'accuracy': 0.5977027938075933, 'macro avg': {'precision': 0.5822869396369282, 'recall': 0.3918129632466572, 'f1-score': 0.36877118700291206, 'support': 559201}, 'weighted avg': {'precision': 0.5886152945872665, 'recall': 0.5977027938075933, 'f1-score': 0.5032749883332193, 'support': 559201}}
[[ 14457 100955   2563]
 [  7388 308179   7121]
 [  2163 104775  11600]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8361422
{'0': {'precision': 0.4895628902765388, 'recall': 0.13555303067727115, 'f1-score': 0.2123181677499226, 'support': 20243}, '1': {'precision': 0.7505827838175013, 'recall': 0.9599212282557165, 'f1-score': 0.8424421605143243, 'support': 109684}, '2': {'precision': 0.5224532224532225, 'recall': 0.12103260607811973, 'f1-score': 0.19653540843858758, 'support': 20763}, 'accuracy': 0.7335921428097418, 'macro avg': {'precision': 0.5875329655157543, 'recall': 0.4055022883370358, 'f1-score': 0.41709857890094476, 'support': 150690}, 'weighted avg': {'precision': 0.6840854728641783, 'recall': 0.7335921428097418, 'f1-score': 0.6687971815583331, 'support': 150690}}
[[  2744  17122    377]
 [  2476 105288   1920]
 [   385  17865   2513]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8680271
{'0': {'precision': 0.5396570203644159, 'recall': 0.11123384513420966, 'f1-score': 0.18444912537778185, 'support': 9053}, '1': {'precision': 0.6949360401494283, 'recall': 0.9663142429886927, 'f1-score': 0.8084592675512242, 'support': 38117}, '2': {'precision': 0.5960674157303371, 'recall': 0.11194344798480692, 'f1-score': 0.18848818617871735, 'support': 9478}, 'accuracy': 0.6867144471119898, 'macro avg': {'precision': 0.6102201587480605, 'recall': 0.3964971787025698, 'f1-score': 0.3937988597025745, 'support': 56648}, 'weighted avg': {'precision': 0.6535785731892909, 'recall': 0.6867144471119898, 'f1-score': 0.6050054876058635, 'support': 56648}}
[[ 1007  7906   140]
 [  705 36833   579]
 [  154  8263  1061]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
2341/2341 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1746823
{'0': {'precision': 0.5197407007254206, 'recall': 0.07865037323542326, 'f1-score': 0.13662570140666777, 'support': 214074}, '1': {'precision': 0.29434800002253814, 'recall': 0.9139524712057151, 'f1-score': 0.4452867286256972, 'support': 171475}, '2': {'precision': 0.5606931382793452, 'recall': 0.09038080934267226, 'f1-score': 0.15566864506146724, 'support': 213729}, 'accuracy': 0.3218439522225078, 'macro avg': {'precision': 0.4582606130091013, 'recall': 0.3609945512612702, 'f1-score': 0.24586035836461073, 'support': 599278}, 'weighted avg': {'precision': 0.46985318637137446, 'recall': 0.3218439522225078, 'f1-score': 0.23173628271747795, 'support': 599278}}
[[ 16837 189479   7758]
 [  7378 156720   7377]
 [  8180 186232  19317]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1390842
{'0': {'precision': 0.5355961455486841, 'recall': 0.09098016222026777, 'f1-score': 0.1555393129372455, 'support': 40932}, '1': {'precision': 0.344264365017091, 'recall': 0.9236781609195402, 'f1-score': 0.501583422031248, 'support': 41325}, '2': {'precision': 0.5287884139879901, 'recall': 0.07260822117133503, 'f1-score': 0.12768407360811992, 'support': 41235}, 'accuracy': 0.3634972305898358, 'macro avg': {'precision': 0.4695496415179217, 'recall': 0.3624221814370477, 'f1-score': 0.2616022695255378, 'support': 123492}, 'weighted avg': {'precision': 0.4692962828743951, 'recall': 0.3634972305898358, 'f1-score': 0.2620374020002873, 'support': 123492}}
[[ 3724 35881  1327]
 [ 1813 38171  1341]
 [ 1416 36825  2994]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1714965
{'0': {'precision': 0.5446313065976714, 'recall': 0.08822913028292001, 'f1-score': 0.15185764097631357, 'support': 14315}, '1': {'precision': 0.2941001353179973, 'recall': 0.9130398252394556, 'f1-score': 0.4448947842462949, 'support': 11902}, '2': {'precision': 0.5189873417721519, 'recall': 0.07056798623063683, 'f1-score': 0.12424242424242422, 'support': 15106}, 'accuracy': 0.3193378989908768, 'macro avg': {'precision': 0.4525729278959402, 'recall': 0.35727898058433744, 'f1-score': 0.24033161648834425, 'support': 41323}, 'weighted avg': {'precision': 0.46309802650607645, 'recall': 0.3193378989908768, 'f1-score': 0.22616426477461443, 'support': 41323}}
[[ 1263 12555   497]
 [  544 10867   491]
 [  512 13528  1066]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
2027/2027 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2026304
{'0': {'precision': 0.504708097928437, 'recall': 0.016959341876285398, 'f1-score': 0.032815991673554354, 'support': 189630}, '1': {'precision': 0.2931365898921749, 'recall': 0.9661534174964674, 'f1-score': 0.4498009457009522, 'support': 150739}, '2': {'precision': 0.4663519806085348, 'recall': 0.040957294835380915, 'f1-score': 0.07530126686579462, 'support': 178503}, 'accuracy': 0.30096825421298506, 'macro avg': {'precision': 0.4213988894763822, 'recall': 0.3413566847360446, 'f1-score': 0.18597273474676704, 'support': 518872}, 'weighted avg': {'precision': 0.4300485295573693, 'recall': 0.30096825421298506, 'f1-score': 0.16857133029806365, 'support': 518872}}
[[  3216 181607   4807]
 [  1543 145637   3559]
 [  1613 169579   7311]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1484457
{'0': {'precision': 0.517814726840855, 'recall': 0.02307936619966828, 'f1-score': 0.04418918918918919, 'support': 28337}, '1': {'precision': 0.3334114541574669, 'recall': 0.9686436122558681, 'f1-score': 0.49607252973131705, 'support': 27905}, '2': {'precision': 0.5274067250115154, 'recall': 0.04051233060892333, 'f1-score': 0.07524479200893737, 'support': 28263}, 'accuracy': 0.341151411159103, 'macro avg': {'precision': 0.45954430200327917, 'recall': 0.34407843635481994, 'f1-score': 0.20516883697648122, 'support': 84505}, 'weighted avg': {'precision': 0.46012968240641244, 'recall': 0.341151411159103, 'f1-score': 0.2037954742648962, 'support': 84505}}
[[  654 27179   504]
 [  353 27030   522]
 [  256 26862  1145]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1750402
{'0': {'precision': 0.5192697768762677, 'recall': 0.02053915275994865, 'f1-score': 0.03951531990429883, 'support': 12464}, '1': {'precision': 0.3012185605378474, 'recall': 0.9696618357487923, 'f1-score': 0.4596500870202436, 'support': 10350}, '2': {'precision': 0.540268456375839, 'recall': 0.04061895551257253, 'f1-score': 0.07555729370355885, 'support': 11891}, 'accuracy': 0.31047399510157037, 'macro avg': {'precision': 0.4535855979299847, 'recall': 0.3436066480071045, 'f1-score': 0.19157423354270042, 'support': 34705}, 'weighted avg': {'precision': 0.46143560914328263, 'recall': 0.31047399510157037, 'f1-score': 0.17716032639031035, 'support': 34705}}
[[  256 11993   215]
 [  118 10036   196]
 [  119 11289   483]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
2900/2900 - 36s - 36s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1888688
{'0': {'precision': 0.4495957554320364, 'recall': 0.0542987806040911, 'f1-score': 0.09689528081322339, 'support': 262179}, '1': {'precision': 0.29255396311767823, 'recall': 0.9145284511839042, 'f1-score': 0.4432985181588069, 'support': 216107}, '2': {'precision': 0.44662017930838194, 'recall': 0.05942431276910784, 'f1-score': 0.10489234697629025, 'support': 264067}, 'accuracy': 0.3065441912405554, 'macro avg': {'precision': 0.3962566326193655, 'recall': 0.34275051485236774, 'f1-score': 0.21502871531610682, 'support': 742353}, 'weighted avg': {'precision': 0.4028207278212851, 'recall': 0.3065441912405554, 'f1-score': 0.20058170180636894, 'support': 742353}}
[[ 14236 238178   9765]
 [  8793 197636   9678]
 [  8635 239740  15692]]
Evaluating performance on  train set...
694/694 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1459749
{'0': {'precision': 0.4721522530086762, 'recall': 0.05659269695902313, 'f1-score': 0.10107092039242119, 'support': 59619}, '1': {'precision': 0.3349530529542817, 'recall': 0.9125245147764929, 'f1-score': 0.49003345635466455, 'support': 59148}, '2': {'precision': 0.46796179027583984, 'recall': 0.07410554941786351, 'f1-score': 0.12794928982274914, 'support': 58835}, 'accuracy': 0.34745104221799306, 'macro avg': {'precision': 0.4250223654129326, 'recall': 0.34774092038445986, 'f1-score': 0.23968455552327828, 'support': 177602}, 'weighted avg': {'precision': 0.4250716786924874, 'recall': 0.34745104221799306, 'f1-score': 0.23951387116171496, 'support': 177602}}
[[ 3374 54224  2021]
 [ 2238 53974  2936]
 [ 1534 52941  4360]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1318836
{'0': {'precision': 0.4820007578628268, 'recall': 0.06410321020007055, 'f1-score': 0.11315719242060314, 'support': 19843}, '1': {'precision': 0.3515547094551718, 'recall': 0.9109273701024148, 'f1-score': 0.5073193704948915, 'support': 21286}, '2': {'precision': 0.4712007809957696, 'recall': 0.07336102948627014, 'f1-score': 0.1269562930165271, 'support': 19738}, 'accuracy': 0.36325102272167187, 'macro avg': {'precision': 0.43491874943792275, 'recall': 0.34946386992958517, 'f1-score': 0.24914428531067392, 'support': 60867}, 'weighted avg': {'precision': 0.43287981334761627, 'recall': 0.36325102272167187, 'f1-score': 0.25547573563863013, 'support': 60867}}
[[ 1272 17961   610]
 [  881 19390  1015]
 [  486 17804  1448]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/EXC
Evaluating performance on  test set...
7167/7167 - 87s - 87s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97767836
{'0': {'precision': 0.43559608283024337, 'recall': 0.16408436494842912, 'f1-score': 0.2383753110176549, 'support': 421265}, '1': {'precision': 0.5564649353591081, 'recall': 0.8636736508193078, 'f1-score': 0.676841129382779, 'support': 989860}, '2': {'precision': 0.4488842388889685, 'recall': 0.14793088057131926, 'f1-score': 0.22252734077341038, 'support': 423441}, 'accuracy': 0.5378269301840326, 'macro avg': {'precision': 0.4803150856927733, 'recall': 0.3918962987796854, 'f1-score': 0.3792479270579481, 'support': 1834566}, 'weighted avg': {'precision': 0.5038792584989763, 'recall': 0.5378269301840326, 'f1-score': 0.4712963913160517, 'support': 1834566}}
[[ 69123 339075  13067]
 [ 71105 854916  63839]
 [ 18458 342343  62640]]
Evaluating performance on  train set...
1570/1570 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9243209
{'0': {'precision': 0.4696198234894773, 'recall': 0.20561534746046098, 'f1-score': 0.2860071493173694, 'support': 80743}, '1': {'precision': 0.6257828732671565, 'recall': 0.8797649804150346, 'f1-score': 0.7313508579583933, 'support': 239980}, '2': {'precision': 0.4700359016846175, 'recall': 0.16814858723572418, 'f1-score': 0.24768973295495894, 'support': 80976}, 'accuracy': 0.600808067732307, 'macro avg': {'precision': 0.5218128661470837, 'recall': 0.41784297170373996, 'f1-score': 0.42168258007690723, 'support': 401699}, 'weighted avg': {'precision': 0.5629974545853405, 'recall': 0.600808067732307, 'f1-score': 0.5443368740423759, 'support': 401699}}
[[ 16602  61624   2517]
 [ 16019 211126  12835]
 [  2731  64629  13616]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96186656
{'0': {'precision': 0.4765761275853476, 'recall': 0.13614522156967432, 'f1-score': 0.21178815647407323, 'support': 28095}, '1': {'precision': 0.5746433539728867, 'recall': 0.9064454133440423, 'f1-score': 0.7033782768617807, 'support': 69724}, '2': {'precision': 0.49631830512853636, 'recall': 0.13755325623858794, 'f1-score': 0.2154070419376542, 'support': 27931}, 'accuracy': 0.5635626242544731, 'macro avg': {'precision': 0.5158459288955902, 'recall': 0.3933812970507682, 'f1-score': 0.3768578250911694, 'support': 125750}, 'weighted avg': {'precision': 0.5353360325841832, 'recall': 0.5635626242544731, 'f1-score': 0.48516158505296625, 'support': 125750}}
[[ 3825 23516   754]
 [ 3378 63201  3145]
 [  823 23266  3842]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/AAL
Evaluating performance on  test set...
6357/6357 - 76s - 76s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.004632
{'0': {'precision': 0.4823930687175805, 'recall': 0.12856437787693517, 'f1-score': 0.20302089815751853, 'support': 397124}, '1': {'precision': 0.5265675279131676, 'recall': 0.9126840780743898, 'f1-score': 0.6678329164379542, 'support': 830490}, '2': {'precision': 0.48068066600701187, 'recall': 0.0984832937054186, 'f1-score': 0.16347362233102275, 'support': 399550}, 'accuracy': 0.5213856747076508, 'macro avg': {'precision': 0.4965470875459199, 'recall': 0.37991058321891447, 'f1-score': 0.3447758123088318, 'support': 1627164}, 'weighted avg': {'precision': 0.5045188385320155, 'recall': 0.5213856747076508, 'f1-score': 0.4305459779928901, 'support': 1627164}}
[[ 51056 335241  10827]
 [ 40830 757975  31685]
 [ 13953 346248  39349]]
Evaluating performance on  train set...
1701/1701 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98926944
{'0': {'precision': 0.5017031923552286, 'recall': 0.16071342352520834, 'f1-score': 0.2434432823813355, 'support': 103557}, '1': {'precision': 0.5412237575528005, 'recall': 0.9091591989677784, 'f1-score': 0.6785222560246674, 'support': 226308}, '2': {'precision': 0.5044367982614995, 'recall': 0.10555834509677603, 'f1-score': 0.17458340188497426, 'support': 105553}, 'accuracy': 0.5363466829575259, 'macro avg': {'precision': 0.5157879160565095, 'recall': 0.39181032252992093, 'f1-score': 0.3655163134303257, 'support': 435418}, 'weighted avg': {'precision': 0.5229066345026747, 'recall': 0.5363466829575259, 'f1-score': 0.4528822247338398, 'support': 435418}}
[[ 16643  83941   2973]
 [ 12585 205750   7973]
 [  3945  90466  11142]]
Evaluating performance on  val set...
563/563 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99474317
{'0': {'precision': 0.5073075673920104, 'recall': 0.13414634146341464, 'f1-score': 0.21218501664063033, 'support': 34932}, '1': {'precision': 0.535485845687781, 'recall': 0.917476837844743, 'f1-score': 0.6762676921857035, 'support': 74367}, '2': {'precision': 0.5108739700121573, 'recall': 0.10880948270901664, 'f1-score': 0.17940750930955152, 'support': 34758}, 'accuracy': 0.5324142526916429, 'macro avg': {'precision': 0.5178891276973162, 'recall': 0.3868108873390581, 'f1-score': 0.35595340604529513, 'support': 144057}, 'weighted avg': {'precision': 0.522714628793349, 'recall': 0.5324142526916429, 'f1-score': 0.4438513413068862, 'support': 144057}}
[[ 4686 29317   929]
 [ 3445 68230  2692]
 [ 1106 29870  3782]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/WBA
Evaluating performance on  test set...
7458/7458 - 91s - 91s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1283164
{'0': {'precision': 0.5221562583624885, 'recall': 0.08676462353797558, 'f1-score': 0.14880321083232242, 'support': 607206}, '1': {'precision': 0.35465924411171457, 'recall': 0.9184219349775145, 'f1-score': 0.5117141539517075, 'support': 665093}, '2': {'precision': 0.5134544524648091, 'recall': 0.06935113910576547, 'f1-score': 0.12219735593614188, 'support': 636947}, 'accuracy': 0.3706662211155608, 'macro avg': {'precision': 0.4634233183130041, 'recall': 0.3581792325404185, 'f1-score': 0.2609049069067239, 'support': 1909246}, 'weighted avg': {'precision': 0.4609050205124686, 'recall': 0.3706662211155608, 'f1-score': 0.2663485708506457, 'support': 1909246}}
[[ 52684 537584  16938]
 [ 29337 610836  24920]
 [ 18876 573898  44173]]
Evaluating performance on  train set...
1664/1664 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99136424
{'0': {'precision': 0.5433637199966547, 'recall': 0.12531584530813, 'f1-score': 0.2036613272311213, 'support': 103690}, '1': {'precision': 0.5290477099386336, 'recall': 0.9271225193935201, 'f1-score': 0.6736740469452306, 'support': 218243}, '2': {'precision': 0.5061255742725881, 'recall': 0.09531087784058138, 'f1-score': 0.1604135320099015, 'support': 104028}, 'accuracy': 0.5287972373057628, 'macro avg': {'precision': 0.5261790014026254, 'recall': 0.3825830808474105, 'f1-score': 0.3459163020620844, 'support': 425961}, 'weighted avg': {'precision': 0.5269345661387289, 'recall': 0.5287972373057628, 'f1-score': 0.4339124637137882, 'support': 425961}}
[[ 12994  88449   2247]
 [  8477 202338   7428]
 [  2443  91670   9915]]
Evaluating performance on  val set...
517/517 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0556768
{'0': {'precision': 0.5482123510292525, 'recall': 0.09522273301610346, 'f1-score': 0.16226121214897612, 'support': 37197}, '1': {'precision': 0.44585025338121287, 'recall': 0.9257033359463461, 'f1-score': 0.6018358598585447, 'support': 57405}, '2': {'precision': 0.512105424456022, 'recall': 0.08894685013174354, 'f1-score': 0.15156806276786322, 'support': 37573}, 'accuracy': 0.45412521278607904, 'macro avg': {'precision': 0.5020560096221625, 'recall': 0.3699576396980644, 'f1-score': 0.30522171159179473, 'support': 132175}, 'weighted avg': {'precision': 0.4934913995057291, 'recall': 0.45412521278607904, 'f1-score': 0.3501334190721555, 'support': 132175}}
[[ 3542 32670   985]
 [ 2066 53140  2199]
 [  853 33378  3342]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
8238/8238 - 101s - 101s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1606523
{'0': {'precision': 0.49659396499800645, 'recall': 0.07959458944975335, 'f1-score': 0.13719881265300335, 'support': 735452}, '1': {'precision': 0.30966742819199816, 'recall': 0.9064306048434271, 'f1-score': 0.46162731393580797, 'support': 641075}, '2': {'precision': 0.5248790812801204, 'recall': 0.08196186194142986, 'f1-score': 0.14178366597166028, 'support': 732182}, 'accuracy': 0.33178546684250887, 'macro avg': {'precision': 0.44371349149004163, 'recall': 0.35599568541153676, 'f1-score': 0.24686993085349052, 'support': 2108709}, 'weighted avg': {'precision': 0.44958696850240604, 'recall': 0.33178546684250887, 'f1-score': 0.2374212466315347, 'support': 2108709}}
[[ 58538 651670  25244]
 [ 30907 581090  29078]
 [ 28434 643737  60011]]
Evaluating performance on  train set...
1806/1806 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0571182
{'0': {'precision': 0.5172587553539935, 'recall': 0.10912998245840516, 'f1-score': 0.1802345268702577, 'support': 131687}, '1': {'precision': 0.44445855734165124, 'recall': 0.9136510391299326, 'f1-score': 0.5980077363717927, 'support': 199157}, '2': {'precision': 0.5212169735788631, 'recall': 0.09915014164305949, 'f1-score': 0.16660695091365102, 'support': 131316}, 'accuracy': 0.4529838151289597, 'macro avg': {'precision': 0.4943114287581693, 'recall': 0.37397705441046575, 'f1-score': 0.31494973805190046, 'support': 462160}, 'weighted avg': {'precision': 0.48701188922294136, 'recall': 0.4529838151289597, 'f1-score': 0.35639200549320094, 'support': 462160}}
[[ 14371 113513   3803]
 [  9040 181960   8157]
 [  4372 113924  13020]]
Evaluating performance on  val set...
642/642 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0727446
{'0': {'precision': 0.5306609130138542, 'recall': 0.09613446069657883, 'f1-score': 0.1627797613863973, 'support': 48609}, '1': {'precision': 0.42538816389293344, 'recall': 0.9246480123047799, 'f1-score': 0.5827018966401043, 'support': 67616}, '2': {'precision': 0.5533832826036057, 'recall': 0.09828055803896293, 'f1-score': 0.16691678878511274, 'support': 48097}, 'accuracy': 0.4376833290734047, 'macro avg': {'precision': 0.5031441198367977, 'recall': 0.3730210103467739, 'f1-score': 0.30413281560387145, 'support': 164322}, 'weighted avg': {'precision': 0.4939936110433214, 'recall': 0.4376833290734047, 'f1-score': 0.33678223034436194, 'support': 164322}}
[[ 4673 42612  1324]
 [ 2604 62521  2491]
 [ 1529 41841  4727]]
testing model on single stock: results/universal/W5/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
31315/31315 - 384s - 384s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2216634
{'0': {'precision': 0.5880363686175131, 'recall': 0.0442371862869553, 'f1-score': 0.08228423972585099, 'support': 3105306}, '1': {'precision': 0.21663834986056305, 'recall': 0.948095654554844, 'f1-score': 0.3526880426502552, 'support': 1731146}, '2': {'precision': 0.5435896443448853, 'recall': 0.0353311243388032, 'f1-score': 0.06634978170606468, 'support': 3180029}, 'accuracy': 0.2358910349815586, 'macro avg': {'precision': 0.44942145427432045, 'recall': 0.34255465506020083, 'f1-score': 0.16710735469405694, 'support': 8016481}, 'weighted avg': {'precision': 0.49020216097441144, 'recall': 0.2358910349815586, 'f1-score': 0.13435651722705977, 'support': 8016481}}
[[ 137370 2916778   51158]
 [  46677 1641292   43177]
 [  49561 3018114  112354]]
Evaluating performance on  train set...
5759/5759 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1400588
{'0': {'precision': 0.5462813790679282, 'recall': 0.07538562905233884, 'f1-score': 0.1324881805297538, 'support': 494776}, '1': {'precision': 0.33254561854494463, 'recall': 0.9319008387144659, 'f1-score': 0.49017424036212326, 'support': 485028}, '2': {'precision': 0.4895795403431362, 'recall': 0.04623488218266996, 'f1-score': 0.08449064233884235, 'support': 494367}, 'accuracy': 0.34741831171553367, 'macro avg': {'precision': 0.45613551265200303, 'recall': 0.3511737833164916, 'f1-score': 0.23571768774357316, 'support': 1474171}, 'weighted avg': {'precision': 0.45694347569050386, 'recall': 0.34741831171553367, 'f1-score': 0.23407704319599007, 'support': 1474171}}
[[ 37299 447250  10227]
 [ 19427 451998  13603]
 [ 11552 459958  22857]]
Evaluating performance on  val set...
2129/2129 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1667386
{'0': {'precision': 0.542892859003073, 'recall': 0.05449592705294308, 'f1-score': 0.09904923002361483, 'support': 191262}, '1': {'precision': 0.29842205550769546, 'recall': 0.9429710607742343, 'f1-score': 0.453367041511144, 'support': 161269}, '2': {'precision': 0.5143317030892094, 'recall': 0.04317907779302316, 'f1-score': 0.07966973691150309, 'support': 192408}, 'accuracy': 0.3134350817247435, 'macro avg': {'precision': 0.45188220586665934, 'recall': 0.34688202187340017, 'f1-score': 0.21069533614875394, 'support': 544939}, 'weighted avg': {'precision': 0.46045985843609083, 'recall': 0.3134350817247435, 'f1-score': 0.197063337345842, 'support': 544939}}
[[ 10423 177338   3501]
 [  4853 152072   4344]
 [  3923 180177   8308]]
training model: results/universal/W5/deepLOB_L2/h10
Epoch 1/50
9913/9913 - 458s - loss: 2.7979 - accuracy10: 0.5035 - val_loss: 4.6132 - val_accuracy10: 0.4551 - 458s/epoch - 46ms/step
Epoch 2/50
9913/9913 - 449s - loss: 2.6518 - accuracy10: 0.5534 - val_loss: 4.3840 - val_accuracy10: 0.4794 - 449s/epoch - 45ms/step
Epoch 3/50
9913/9913 - 441s - loss: 2.5752 - accuracy10: 0.5760 - val_loss: 3.9524 - val_accuracy10: 0.4849 - 441s/epoch - 45ms/step
Epoch 4/50
9913/9913 - 441s - loss: 2.5359 - accuracy10: 0.5854 - val_loss: 3.7499 - val_accuracy10: 0.5011 - 441s/epoch - 44ms/step
Epoch 5/50
9913/9913 - 439s - loss: 2.5120 - accuracy10: 0.5903 - val_loss: 3.7536 - val_accuracy10: 0.5080 - 439s/epoch - 44ms/step
Epoch 6/50
9913/9913 - 443s - loss: 2.4974 - accuracy10: 0.5933 - val_loss: 3.7550 - val_accuracy10: 0.5078 - 443s/epoch - 45ms/step
Epoch 7/50
9913/9913 - 444s - loss: 2.4845 - accuracy10: 0.5957 - val_loss: 3.7254 - val_accuracy10: 0.5125 - 444s/epoch - 45ms/step
Epoch 8/50
9913/9913 - 455s - loss: 2.4753 - accuracy10: 0.5973 - val_loss: 3.7952 - val_accuracy10: 0.5105 - 455s/epoch - 46ms/step
Epoch 9/50
9913/9913 - 445s - loss: 2.4681 - accuracy10: 0.5986 - val_loss: 3.7874 - val_accuracy10: 0.5138 - 445s/epoch - 45ms/step
Epoch 10/50
9913/9913 - 445s - loss: 2.4611 - accuracy10: 0.6000 - val_loss: 3.7790 - val_accuracy10: 0.5156 - 445s/epoch - 45ms/step
Epoch 11/50
9913/9913 - 442s - loss: 2.4558 - accuracy10: 0.6009 - val_loss: 3.7594 - val_accuracy10: 0.5181 - 442s/epoch - 45ms/step
Epoch 12/50
9913/9913 - 442s - loss: 2.4507 - accuracy10: 0.6019 - val_loss: 3.7946 - val_accuracy10: 0.5174 - 442s/epoch - 45ms/step
Epoch 13/50
9913/9913 - 443s - loss: 2.4464 - accuracy10: 0.6029 - val_loss: 3.7016 - val_accuracy10: 0.5226 - 443s/epoch - 45ms/step
Epoch 14/50
9913/9913 - 443s - loss: 2.4432 - accuracy10: 0.6036 - val_loss: 3.6980 - val_accuracy10: 0.5224 - 443s/epoch - 45ms/step
Epoch 15/50
9913/9913 - 442s - loss: 2.4389 - accuracy10: 0.6044 - val_loss: 3.7045 - val_accuracy10: 0.5209 - 442s/epoch - 45ms/step
Epoch 16/50
9913/9913 - 449s - loss: 2.4358 - accuracy10: 0.6048 - val_loss: 3.6245 - val_accuracy10: 0.5256 - 449s/epoch - 45ms/step
Epoch 17/50
9913/9913 - 442s - loss: 2.4327 - accuracy10: 0.6055 - val_loss: 3.7079 - val_accuracy10: 0.5250 - 442s/epoch - 45ms/step
Epoch 18/50
9913/9913 - 445s - loss: 2.4307 - accuracy10: 0.6059 - val_loss: 3.6549 - val_accuracy10: 0.5274 - 445s/epoch - 45ms/step
Epoch 19/50
9913/9913 - 443s - loss: 2.4275 - accuracy10: 0.6066 - val_loss: 3.7200 - val_accuracy10: 0.5225 - 443s/epoch - 45ms/step
Epoch 20/50
9913/9913 - 447s - loss: 2.4248 - accuracy10: 0.6070 - val_loss: 3.6763 - val_accuracy10: 0.5252 - 447s/epoch - 45ms/step
Epoch 21/50
9913/9913 - 444s - loss: 2.4222 - accuracy10: 0.6075 - val_loss: 3.6526 - val_accuracy10: 0.5267 - 444s/epoch - 45ms/step
Epoch 22/50
9913/9913 - 444s - loss: 2.4197 - accuracy10: 0.6078 - val_loss: 3.6315 - val_accuracy10: 0.5266 - 444s/epoch - 45ms/step
Epoch 23/50
9913/9913 - 437s - loss: 2.4178 - accuracy10: 0.6083 - val_loss: 3.6075 - val_accuracy10: 0.5287 - 437s/epoch - 44ms/step
Epoch 24/50
9913/9913 - 445s - loss: 2.4161 - accuracy10: 0.6084 - val_loss: 3.6340 - val_accuracy10: 0.5271 - 445s/epoch - 45ms/step
Epoch 25/50
9913/9913 - 443s - loss: 2.4135 - accuracy10: 0.6091 - val_loss: 3.5989 - val_accuracy10: 0.5288 - 443s/epoch - 45ms/step
Epoch 26/50
9913/9913 - 446s - loss: 2.4118 - accuracy10: 0.6092 - val_loss: 3.5848 - val_accuracy10: 0.5278 - 446s/epoch - 45ms/step
Epoch 27/50
9913/9913 - 446s - loss: 2.4106 - accuracy10: 0.6094 - val_loss: 3.6547 - val_accuracy10: 0.5263 - 446s/epoch - 45ms/step
Epoch 28/50
9913/9913 - 449s - loss: 2.4078 - accuracy10: 0.6099 - val_loss: 3.6342 - val_accuracy10: 0.5278 - 449s/epoch - 45ms/step
Epoch 29/50
9913/9913 - 449s - loss: 2.4063 - accuracy10: 0.6099 - val_loss: 3.6305 - val_accuracy10: 0.5263 - 449s/epoch - 45ms/step
Epoch 30/50
9913/9913 - 444s - loss: 2.4044 - accuracy10: 0.6106 - val_loss: 3.6536 - val_accuracy10: 0.5254 - 444s/epoch - 45ms/step
Epoch 31/50
9913/9913 - 444s - loss: 2.4030 - accuracy10: 0.6108 - val_loss: 3.6552 - val_accuracy10: 0.5252 - 444s/epoch - 45ms/step
Epoch 32/50
9913/9913 - 446s - loss: 2.4016 - accuracy10: 0.6109 - val_loss: 3.6556 - val_accuracy10: 0.5268 - 446s/epoch - 45ms/step
Epoch 33/50
9913/9913 - 442s - loss: 2.4006 - accuracy10: 0.6111 - val_loss: 3.6257 - val_accuracy10: 0.5273 - 442s/epoch - 45ms/step
Epoch 34/50
9913/9913 - 440s - loss: 2.3985 - accuracy10: 0.6115 - val_loss: 3.6653 - val_accuracy10: 0.5259 - 440s/epoch - 44ms/step
Epoch 35/50
9913/9913 - 444s - loss: 2.3975 - accuracy10: 0.6117 - val_loss: 3.6239 - val_accuracy10: 0.5263 - 444s/epoch - 45ms/step
Epoch 36/50
9913/9913 - 442s - loss: 2.3959 - accuracy10: 0.6122 - val_loss: 3.6293 - val_accuracy10: 0.5269 - 442s/epoch - 45ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 825s - 825s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1369913
{'0': {'precision': 0.4676879542801636, 'recall': 0.2871591049387204, 'f1-score': 0.35583593444925793, 'support': 3782579}, '1': {'precision': 0.5090057332628082, 'recall': 0.6507495331751499, 'f1-score': 0.5712157605829971, 'support': 5223051}, '2': {'precision': 0.4256268409487976, 'recall': 0.42625016274168936, 'f1-score': 0.42593827380172555, 'support': 3832761}, 'accuracy': 0.47660294814202186, 'macro avg': {'precision': 0.4674401761639231, 'recall': 0.4547196002851866, 'f1-score': 0.4509966562779935, 'support': 12838391}, 'weighted avg': {'precision': 0.4719404086601588, 'recall': 0.47660294814202186, 'f1-score': 0.46438733536441584, 'support': 12838391}}
[[1086202 1663886 1032491]
 [ 651985 3398898 1172168]
 [ 584306 1614740 1633715]]
Evaluating performance on  train set...
9913/9913 - 171s - 171s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.920949
{'0': {'precision': 0.46856727960792294, 'recall': 0.4464846657278931, 'f1-score': 0.4572595168463232, 'support': 572378}, '1': {'precision': 0.6953070269039258, 'recall': 0.6637972926567111, 'f1-score': 0.6791868959304282, 'support': 1389037}, '2': {'precision': 0.4103428639257386, 'recall': 0.47444659479029494, 'f1-score': 0.44007254509696175, 'support': 575618}, 'accuracy': 0.5718084865273727, 'macro avg': {'precision': 0.5247390568125291, 'recall': 0.5282428510582997, 'f1-score': 0.5255063192912378, 'support': 2537033}, 'weighted avg': {'precision': 0.5794979914507133, 'recall': 0.5718084865273727, 'f1-score': 0.574866268731862, 'support': 2537033}}
[[255558 200116 116704]
 [191261 922039 275737]
 [ 98584 203934 273100]]
Evaluating performance on  val set...
3496/3496 - 59s - 59s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0236738
{'0': {'precision': 0.4744241757810199, 'recall': 0.4181731642940591, 'f1-score': 0.4445262155660529, 'support': 231110}, '1': {'precision': 0.6244145111898507, 'recall': 0.6288449339715126, 'f1-score': 0.6266218915421445, 'support': 433525}, '2': {'precision': 0.40305620101610806, 'recall': 0.4457627709248031, 'f1-score': 0.4233351396294473, 'support': 229584}, 'accuracy': 0.527392059439578, 'macro avg': {'precision': 0.5006316293289929, 'recall': 0.4975936230634583, 'f1-score': 0.49816108224588157, 'support': 894219}, 'weighted avg': {'precision': 0.5288175794547127, 'recall': 0.527392059439578, 'f1-score': 0.5273671034802053, 'support': 894219}}
[[ 96644  79267  55199]
 [ 64534 272620  96371]
 [ 42530  84714 102340]]
testing model out of sample: results/universal/W5/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 365s - 365s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9623829
{'0': {'precision': 0.47898312535592613, 'recall': 0.3666760231377627, 'f1-score': 0.4153721457834337, 'support': 1307473}, '1': {'precision': 0.6943346034941404, 'recall': 0.6797977002054894, 'f1-score': 0.6869892591238909, 'support': 2727635}, '2': {'precision': 0.43788862088248165, 'recall': 0.5591054823800216, 'f1-score': 0.49112813768119334, 'support': 1313736}, 'accuracy': 0.5736147848020993, 'macro avg': {'precision': 0.5370687832441827, 'recall': 0.5351930685744245, 'f1-score': 0.5311631808628393, 'support': 5348844}, 'weighted avg': {'precision': 0.5787080190231565, 'recall': 0.5736147848020993, 'f1-score': 0.5724894067688341, 'support': 5348844}}
[[ 479419  450289  377765]
 [ 308271 1854240  565124]
 [ 213220  365999  734517]]
Evaluating performance on  train set...
4957/4957 - 87s - 87s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8652006
{'0': {'precision': 0.4683205117123347, 'recall': 0.4452745889850611, 'f1-score': 0.4565068775145583, 'support': 267691}, '1': {'precision': 0.7732404631150948, 'recall': 0.6628513962683971, 'f1-score': 0.7138032532920218, 'support': 729874}, '2': {'precision': 0.4211284297307742, 'recall': 0.6036694130637901, 'f1-score': 0.49614146592424974, 'support': 270779}, 'accuracy': 0.6042958377222584, 'macro avg': {'precision': 0.5542298015194013, 'recall': 0.5705984661057494, 'f1-score': 0.5554838655769433, 'support': 1268344}, 'weighted avg': {'precision': 0.6337129603250558, 'recall': 0.6042958377222584, 'f1-score': 0.6130307773313179, 'support': 1268344}}
[[119196  77290  71205]
 [ 92592 483798 153484]
 [ 42730  64588 163461]]
Evaluating performance on  val set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8679585
{'0': {'precision': 0.4796579361497078, 'recall': 0.4174168754511869, 'f1-score': 0.44637819366630904, 'support': 94196}, '1': {'precision': 0.7623262612232299, 'recall': 0.6823831523174503, 'f1-score': 0.720142877664216, 'support': 246111}, '2': {'precision': 0.42763767253778323, 'recall': 0.5992613306600538, 'f1-score': 0.49910793541979764, 'support': 94765}, 'accuracy': 0.6069110400117682, 'macro avg': {'precision': 0.5565406233035737, 'recall': 0.566353786142897, 'f1-score': 0.5552096689167741, 'support': 435072}, 'weighted avg': {'precision': 0.6282266417225453, 'recall': 0.6069110400117682, 'f1-score': 0.6127263707971706, 'support': 435072}}
[[ 39319  28741  26136]
 [ 28297 167942  49872]
 [ 14357  23619  56789]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
1060/1060 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.14258
{'0': {'precision': 0.44400060371283395, 'recall': 0.4949303483703089, 'f1-score': 0.46808420360342207, 'support': 89158}, '1': {'precision': 0.5110962130197858, 'recall': 0.3061903339752634, 'f1-score': 0.3829567995053969, 'support': 97103}, '2': {'precision': 0.4167120831209015, 'recall': 0.5573307939195147, 'f1-score': 0.4768711554614452, 'support': 85059}, 'accuracy': 0.44694456730060445, 'macro avg': {'precision': 0.45726963328450704, 'recall': 0.452817158755029, 'f1-score': 0.442637386190088, 'support': 271320}, 'weighted avg': {'precision': 0.45945855254632856, 'recall': 0.44694456730060445, 'f1-score': 0.44037258270544577, 'support': 271320}}
[[44127 14784 30247]
 [31262 29732 36109]
 [23996 13657 47406]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1296849
{'0': {'precision': 0.4009064458370636, 'recall': 0.3919155453451482, 'f1-score': 0.3963600154892957, 'support': 18282}, '1': {'precision': 0.6281967213114754, 'recall': 0.37888652266504413, 'f1-score': 0.47268241768668756, 'support': 32870}, '2': {'precision': 0.36860377830601776, 'recall': 0.6364421882594373, 'f1-score': 0.4668343599595951, 'support': 18517}, 'accuracy': 0.4507600223915945, 'macro avg': {'precision': 0.4659023151515189, 'recall': 0.46908141875654324, 'f1-score': 0.44529226437852615, 'support': 69669}, 'weighted avg': {'precision': 0.49955696271216654, 'recall': 0.4507600223915945, 'f1-score': 0.45110015524707614, 'support': 69669}}
[[ 7165  4165  6952]
 [ 7181 12454 13235]
 [ 3526  3206 11785]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1089525
{'0': {'precision': 0.43414956982131037, 'recall': 0.3870206489675516, 'f1-score': 0.40923268870867124, 'support': 6780}, '1': {'precision': 0.6222989387546349, 'recall': 0.4318161653801792, 'f1-score': 0.5098470563586842, 'support': 11271}, '2': {'precision': 0.3750470101541933, 'recall': 0.6184496124031008, 'f1-score': 0.46693199110382766, 'support': 6450}, 'accuracy': 0.46855230398759234, 'macro avg': {'precision': 0.4771651729100463, 'recall': 0.47909547558361054, 'f1-score': 0.462003912057061, 'support': 24501}, 'weighted avg': {'precision': 0.5051434079256569, 'recall': 0.46855230398759234, 'f1-score': 0.4707071198842173, 'support': 24501}}
[[2624 1666 2490]
 [2247 4867 4157]
 [1173 1288 3989]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7603179
{'0': {'precision': 0.44084640346133047, 'recall': 0.4842746277524043, 'f1-score': 0.46154118375652486, 'support': 80793}, '1': {'precision': 0.8930124993117119, 'recall': 0.6534690865867694, 'f1-score': 0.7546886656225597, 'support': 397093}, '2': {'precision': 0.3246978507655188, 'recall': 0.7182242990654205, 'f1-score': 0.44721628802670765, 'support': 81320}, 'accuracy': 0.6384409323218992, 'macro avg': {'precision': 0.5528522511795204, 'recall': 0.618656004468198, 'f1-score': 0.5544820458019307, 'support': 559206}, 'weighted avg': {'precision': 0.7450398334214742, 'recall': 0.6384409323218992, 'f1-score': 0.667622507089752, 'support': 559206}}
[[ 39126  18374  23293]
 [ 39426 259488  98179]
 [ 10200  12714  58406]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65462935
{'0': {'precision': 0.33814371000300647, 'recall': 0.6430088206468474, 'f1-score': 0.4432122048019816, 'support': 12244}, '1': {'precision': 0.9572996236958922, 'recall': 0.674210083633536, 'f1-score': 0.7911948748510131, 'support': 126026}, '2': {'precision': 0.241888745148771, 'recall': 0.7526769181225345, 'f1-score': 0.3661177576315326, 'support': 12421}, 'accuracy': 0.67814268934442, 'macro avg': {'precision': 0.5124440262825566, 'recall': 0.689965274134306, 'f1-score': 0.5335082790948424, 'support': 150691}, 'weighted avg': {'precision': 0.8480226029734238, 'recall': 0.67814268934442, 'f1-score': 0.7278826486061577, 'support': 150691}}
[[ 7873  2033  2338]
 [14095 84968 26963]
 [ 1315  1757  9349]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7020725
{'0': {'precision': 0.32013663834632566, 'recall': 0.6611794500723589, 'f1-score': 0.43139569194452637, 'support': 5528}, '1': {'precision': 0.941507881243274, 'recall': 0.6552126698825965, 'f1-score': 0.7726936214980582, 'support': 45399}, '2': {'precision': 0.2999926670088729, 'recall': 0.715084775388918, 'f1-score': 0.42266763095361093, 'support': 5721}, 'accuracy': 0.6618415478039825, 'macro avg': {'precision': 0.5205457288661576, 'recall': 0.6771589651146245, 'f1-score': 0.5422523147987318, 'support': 56648}, 'weighted avg': {'precision': 0.8160833513151328, 'recall': 0.6618415478039825, 'f1-score': 0.7040381765313038, 'support': 56648}}
[[ 3655   885   988]
 [ 7095 29746  8558]
 [  667   963  4091]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
2341/2341 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1814246
{'0': {'precision': 0.43308439753917705, 'recall': 0.3931589233829576, 'f1-score': 0.41215702725542763, 'support': 172429}, '1': {'precision': 0.5545488630808587, 'recall': 0.45990348812494586, 'f1-score': 0.5028111101787364, 'support': 254062}, '2': {'precision': 0.40695284185667685, 'recall': 0.5465125700263901, 'f1-score': 0.4665189543549196, 'support': 172792}, 'accuracy': 0.4656714774155115, 'macro avg': {'precision': 0.4648620341589042, 'recall': 0.4665249938447646, 'f1-score': 0.46049569726302786, 'support': 599283}, 'weighted avg': {'precision': 0.4770438979337488, 'recall': 0.4656714774155115, 'f1-score': 0.46626345731107255, 'support': 599283}}
[[ 67792  49720  54917]
 [ 54519 116844  82699]
 [ 34222  44137  94433]]
Evaluating performance on  train set...
483/483 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0954157
{'0': {'precision': 0.4408330283775242, 'recall': 0.4000785000452885, 'f1-score': 0.4194681861348528, 'support': 33121}, '1': {'precision': 0.6170629559578492, 'recall': 0.48517305479330797, 'f1-score': 0.5432272515535644, 'support': 56485}, '2': {'precision': 0.4075804247159381, 'recall': 0.5896240335241693, 'f1-score': 0.48198583955516416, 'support': 33886}, 'accuracy': 0.4910115635020892, 'macro avg': {'precision': 0.48849213635043714, 'recall': 0.49162519612092187, 'f1-score': 0.4815604257478605, 'support': 123492}, 'weighted avg': {'precision': 0.5123157943194326, 'recall': 0.4910115635020892, 'f1-score': 0.49323008175543226, 'support': 123492}}
[[13251  9113 10757]
 [10796 27405 18284]
 [ 6012  7894 19980]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1357853
{'0': {'precision': 0.4318908748824083, 'recall': 0.395128668560117, 'f1-score': 0.4126927052901253, 'support': 11619}, '1': {'precision': 0.6077731881336839, 'recall': 0.37813211845102507, 'f1-score': 0.466208187808303, 'support': 17121}, '2': {'precision': 0.4132029339853301, 'recall': 0.6581101486132083, 'f1-score': 0.5076630701324178, 'support': 12583}, 'accuracy': 0.46816542845388764, 'macro avg': {'precision': 0.484288999000474, 'recall': 0.47712364520811673, 'f1-score': 0.4621879877436154, 'support': 41323}, 'weighted avg': {'precision': 0.49907212321547106, 'recall': 0.46816542845388764, 'f1-score': 0.46378412355608584, 'support': 41323}}
[[4591 2209 4819]
 [3706 6474 6941]
 [2333 1969 8281]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3974942
{'0': {'precision': 0.38409357974575364, 'recall': 0.306996104381237, 'f1-score': 0.34124437220834836, 'support': 187390}, '1': {'precision': 0.24372705635564162, 'recall': 0.1636986811712987, 'f1-score': 0.1958531040938137, 'support': 147631}, '2': {'precision': 0.3881086888069792, 'recall': 0.5698372639456967, 'f1-score': 0.4617354302877252, 'support': 183856}, 'accuracy': 0.35935876903389435, 'macro avg': {'precision': 0.3386431083027915, 'recall': 0.3468440164994108, 'f1-score': 0.3329443021966291, 'support': 518877}, 'weighted avg': {'precision': 0.3455791566299768, 'recall': 0.35935876903389435, 'f1-score': 0.3425717497394878, 'support': 518877}}
[[ 57528  39237  90625]
 [ 48912  24167  74552]
 [ 43336  35752 104768]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3900846
{'0': {'precision': 0.37512407421546917, 'recall': 0.3503280091272105, 'f1-score': 0.36230227498986034, 'support': 28048}, '1': {'precision': 0.29140980970249264, 'recall': 0.15349592348145272, 'f1-score': 0.20107728228957164, 'support': 28333}, '2': {'precision': 0.3741645540447108, 'recall': 0.5772033988694137, 'f1-score': 0.45401792580784983, 'support': 28127}, 'accuracy': 0.3598475883939982, 'macro avg': {'precision': 0.3468994793208908, 'recall': 0.36034244382602565, 'f1-score': 0.33913249436242726, 'support': 84508}, 'weighted avg': {'precision': 0.34673783054280993, 'recall': 0.3598475883939982, 'f1-score': 0.3387743059500098, 'support': 84508}}
[[ 9826  5558 12664]
 [ 9493  4349 14491]
 [ 6875  5017 16235]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3931277
{'0': {'precision': 0.42003853564547206, 'recall': 0.3195439739413681, 'f1-score': 0.3629636481361576, 'support': 12280}, '1': {'precision': 0.2595594713656388, 'recall': 0.1391986391986392, 'f1-score': 0.18121424617088025, 'support': 10582}, '2': {'precision': 0.3804347826086957, 'recall': 0.632441104449886, 'f1-score': 0.47508800862643114, 'support': 11843}, 'accuracy': 0.37132977957066704, 'macro avg': {'precision': 0.35334426320660217, 'recall': 0.3637279058632978, 'f1-score': 0.33975530097782297, 'support': 34705}, 'weighted avg': {'precision': 0.3575917209091592, 'recall': 0.37132977957066704, 'f1-score': 0.3458080979183142, 'support': 34705}}
[[3924 2246 6110]
 [3021 1473 6088]
 [2397 1956 7490]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
2900/2900 - 50s - 50s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2908007
{'0': {'precision': 0.46879894613461676, 'recall': 0.34553002473232136, 'f1-score': 0.39783457852403636, 'support': 261601}, '1': {'precision': 0.3394900703982004, 'recall': 0.23138270852382403, 'f1-score': 0.2752001318192428, 'support': 216546}, '2': {'precision': 0.426050179746489, 'recall': 0.6481675630462017, 'f1-score': 0.5141451229873636, 'support': 264211}, 'accuracy': 0.41994428564115965, 'macro avg': {'precision': 0.41144639875976874, 'recall': 0.4083600987674491, 'f1-score': 0.39572661111021423, 'support': 742358}, 'weighted avg': {'precision': 0.4158648979780782, 'recall': 0.41994428564115965, 'f1-score': 0.4034579116962577, 'support': 742358}}
[[ 90391  52820 118390]
 [ 54129  50105 112312]
 [ 48294  44664 171253]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1775079
{'0': {'precision': 0.47726553225168183, 'recall': 0.4007276593623843, 'f1-score': 0.4356605528613873, 'support': 60193}, '1': {'precision': 0.4582088933134229, 'recall': 0.3831665481538008, 'f1-score': 0.4173412042502952, 'support': 57659}, '2': {'precision': 0.44801258148796386, 'recall': 0.5911966527196653, 'f1-score': 0.5097405408525499, 'support': 59750}, 'accuracy': 0.45910519025686647, 'macro avg': {'precision': 0.46116233568435616, 'recall': 0.45836362007861675, 'f1-score': 0.4542474326547441, 'support': 177602}, 'weighted avg': {'precision': 0.4612372749534914, 'recall': 0.45910519025686647, 'f1-score': 0.45463558670619203, 'support': 177602}}
[[24121 14390 21682]
 [13726 22093 21840]
 [12693 11733 35324]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1866772
{'0': {'precision': 0.4722600739731361, 'recall': 0.36646525679758307, 'f1-score': 0.4126903121544611, 'support': 19860}, '1': {'precision': 0.48110285006195785, 'recall': 0.4429338784047155, 'f1-score': 0.4612300457864126, 'support': 21037}, '2': {'precision': 0.443230604109169, 'recall': 0.5790185277916875, 'f1-score': 0.5021060402101698, 'support': 19970}, 'accuracy': 0.4626316394762351, 'macro avg': {'precision': 0.46553117604808764, 'recall': 0.46280588766466196, 'f1-score': 0.4586754660503478, 'support': 60867}, 'weighted avg': {'precision': 0.4657919872824354, 'recall': 0.4626316394762351, 'f1-score': 0.45880335314034615, 'support': 60867}}
[[ 7278  5496  7086]
 [ 4280  9318  7439]
 [ 3853  4554 11563]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
7167/7167 - 120s - 120s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64070344
{'0': {'precision': 0.4888718292568371, 'recall': 0.5598939011722808, 'f1-score': 0.5219780694852503, 'support': 269560}, '1': {'precision': 0.8853184597069857, 'recall': 0.7211957441448765, 'f1-score': 0.7948736510672655, 'support': 1294123}, '2': {'precision': 0.3991158416996194, 'recall': 0.6948886624730516, 'f1-score': 0.5070199845661347, 'support': 270888}, 'accuracy': 0.6936106588406772, 'macro avg': {'precision': 0.5911020435544808, 'recall': 0.6586594359300696, 'f1-score': 0.6079572350395501, 'support': 1834571}, 'weighted avg': {'precision': 0.7552757366447977, 'recall': 0.6936106588406772, 'f1-score': 0.712272412422151, 'support': 1834571}}
[[150925  72681  45954]
 [123363 933316 237444]
 [ 34433  48218 188237]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6673158
{'0': {'precision': 0.42018287834614365, 'recall': 0.6297819091884161, 'f1-score': 0.5040618094526493, 'support': 50346}, '1': {'precision': 0.9304429956921376, 'recall': 0.6710060705136511, 'f1-score': 0.779709965869253, 'support': 300963}, '2': {'precision': 0.3543509716651098, 'recall': 0.7678706092478667, 'f1-score': 0.48492330058151195, 'support': 50390}, 'accuracy': 0.6779902364705912, 'macro avg': {'precision': 0.5683256152344637, 'recall': 0.6895528629833113, 'f1-score': 0.5895650253011381, 'support': 401699}, 'weighted avg': {'precision': 0.7942245013502962, 'recall': 0.6779902364705912, 'f1-score': 0.7081835688734935, 'support': 401699}}
[[ 31707   8945   9694]
 [ 38208 201948  60807]
 [  5545   6152  38693]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7609771
{'0': {'precision': 0.4346670896617361, 'recall': 0.592006481231434, 'f1-score': 0.5012805268453308, 'support': 18515}, '1': {'precision': 0.9336048158640227, 'recall': 0.5934788236221005, 'f1-score': 0.7256638386006923, 'support': 88849}, '2': {'precision': 0.33280366830862823, 'recall': 0.7974001958011531, 'f1-score': 0.4696103396915389, 'support': 18386}, 'accuracy': 0.6230775347912525, 'macro avg': {'precision': 0.567025191278129, 'recall': 0.6609618335515625, 'f1-score': 0.565518235045854, 'support': 125750}, 'weighted avg': {'precision': 0.7722993534418452, 'recall': 0.6230775347912525, 'f1-score': 0.6551886366277762, 'support': 125750}}
[[10961  2488  5066]
 [11793 52730 24326]
 [ 2463  1262 14661]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
6357/6357 - 107s - 107s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6807462
{'0': {'precision': 0.5667375108017844, 'recall': 0.28245290705569676, 'f1-score': 0.3770100417933327, 'support': 257735}, '1': {'precision': 0.7850518940237372, 'recall': 0.8858527221112054, 'f1-score': 0.8324117973031218, 'support': 1106439}, '2': {'precision': 0.4907718254919828, 'recall': 0.46691762200802295, 'f1-score': 0.4785476425691777, 'support': 262995}, 'accuracy': 0.7225660026708965, 'macro avg': {'precision': 0.6141870767725015, 'recall': 0.5450744170583083, 'f1-score': 0.562656493888544, 'support': 1627169}, 'weighted avg': {'precision': 0.702908340291323, 'recall': 0.7225660026708965, 'f1-score': 0.7030844349759332, 'support': 1627169}}
[[ 72798 150036  34901]
 [ 33783 980142  92514]
 [ 21870 118328 122797]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6690101
{'0': {'precision': 0.4925052217717164, 'recall': 0.47501814572871764, 'f1-score': 0.48360365251355364, 'support': 67509}, '1': {'precision': 0.8356898432586286, 'recall': 0.7902254628540708, 'f1-score': 0.8123220080514102, 'support': 297610}, '2': {'precision': 0.45135959139131704, 'recall': 0.5707051309406962, 'f1-score': 0.504064427776312, 'support': 70299}, 'accuracy': 0.7059124795024551, 'macro avg': {'precision': 0.5931848854738874, 'recall': 0.6119829131744949, 'f1-score': 0.5999966961137586, 'support': 435418}, 'weighted avg': {'precision': 0.7204302926934704, 'recall': 0.7059124795024551, 'f1-score': 0.7115874332295969, 'support': 435418}}
[[ 32068  23966  11475]
 [ 25139 235179  37292]
 [  7905  22274  40120]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6649727
{'0': {'precision': 0.5353931872863112, 'recall': 0.3794310329354752, 'f1-score': 0.4441176470588235, 'support': 22286}, '1': {'precision': 0.8110018680562383, 'recall': 0.8320757762220833, 'f1-score': 0.8214036764852323, 'support': 99134}, '2': {'precision': 0.45577104123517226, 'recall': 0.5346084190997835, 'f1-score': 0.49205187624507046, 'support': 22639}, 'accuracy': 0.7153041462178691, 'macro avg': {'precision': 0.6007220321925739, 'recall': 0.582038409419114, 'f1-score': 0.585857733263042, 'support': 144059}, 'weighted avg': {'precision': 0.712540225617788, 'recall': 0.7153041462178691, 'f1-score': 0.711279408946002, 'support': 144059}}
[[ 8456 10526  3304]
 [ 5499 82487 11148]
 [ 1839  8697 12103]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
7459/7459 - 126s - 126s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8893152
{'0': {'precision': 0.4686495136270249, 'recall': 0.4462716162138127, 'f1-score': 0.4571868963623851, 'support': 416065}, '1': {'precision': 0.7084149759685087, 'recall': 0.6851309283149418, 'f1-score': 0.6965784315043113, 'support': 1059091}, '2': {'precision': 0.44876956945160523, 'recall': 0.5052949239221829, 'f1-score': 0.4753577709464094, 'support': 434095}, 'accuracy': 0.5921903406100089, 'macro avg': {'precision': 0.5419446863490462, 'recall': 0.5455658228169792, 'f1-score': 0.5430410329377019, 'support': 1909251}, 'weighted avg': {'precision': 0.59713113228789, 'recall': 0.5921903406100089, 'f1-score': 0.594112479299123, 'support': 1909251}}
[[185678 151005  79382]
 [143431 725616 190044]
 [ 67089 147660 219346]]
Evaluating performance on  train set...
1664/1664 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70807904
{'0': {'precision': 0.46338773156852425, 'recall': 0.5541897766451807, 'f1-score': 0.5047374600660788, 'support': 66710}, '1': {'precision': 0.8670427178714472, 'recall': 0.6919155758512129, 'f1-score': 0.7696426053721606, 'support': 291907}, '2': {'precision': 0.39660349365031705, 'recall': 0.6668399014046863, 'f1-score': 0.49738620002215095, 'support': 67346}, 'accuracy': 0.6663818218953289, 'macro avg': {'precision': 0.5756779810300962, 'recall': 0.6376484179670266, 'f1-score': 0.5905887551534634, 'support': 425963}, 'weighted avg': {'precision': 0.729448550935201, 'recall': 0.6663818218953289, 'f1-score': 0.6851113148185902, 'support': 425963}}
[[ 36970  17213  12527]
 [ 34134 201975  55798]
 [  8678  13759  44909]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7962275
{'0': {'precision': 0.46638932223955626, 'recall': 0.5359333917616126, 'f1-score': 0.4987487719428328, 'support': 25102}, '1': {'precision': 0.8324835080786513, 'recall': 0.6396146029725032, 'f1-score': 0.7234145666020494, 'support': 81682}, '2': {'precision': 0.40955808049688214, 'recall': 0.6544187145557656, 'f1-score': 0.5038126279087395, 'support': 25392}, 'accuracy': 0.6227681273453577, 'macro avg': {'precision': 0.5694769702716965, 'recall': 0.6099889030966271, 'f1-score': 0.5753253221512072, 'support': 132176}, 'weighted avg': {'precision': 0.6817101550486818, 'recall': 0.6227681273453577, 'f1-score': 0.6385603328165196, 'support': 132176}}
[[13453  5772  5877]
 [11358 52245 18079]
 [ 4034  4741 16617]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
8238/8238 - 137s - 137s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9786974
{'0': {'precision': 0.48281948915671735, 'recall': 0.3890779603076631, 'f1-score': 0.43090944274073795, 'support': 526550}, '1': {'precision': 0.6735075220570101, 'recall': 0.6428786361457448, 'f1-score': 0.6578367518009423, 'support': 1053485}, '2': {'precision': 0.4397793229427536, 'recall': 0.5646734596986073, 'f1-score': 0.4944616931359777, 'support': 528679}, 'accuracy': 0.5598971695545247, 'macro avg': {'precision': 0.532035444718827, 'recall': 0.5322100187173384, 'f1-score': 0.5277359625592193, 'support': 2108714}, 'weighted avg': {'precision': 0.5672939841836072, 'recall': 0.5598971695545247, 'f1-score': 0.5602125423417242, 'support': 2108714}}
[[204869 182695 138986]
 [134919 677263 241303]
 [ 84530 145618 298531]]
Evaluating performance on  train set...
1806/1806 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82853776
{'0': {'precision': 0.4675798382297842, 'recall': 0.4789808773395345, 'f1-score': 0.4732116967412397, 'support': 88586}, '1': {'precision': 0.8055749248900252, 'recall': 0.6561121822962314, 'f1-score': 0.7232020031840735, 'support': 285250}, '2': {'precision': 0.40462718651817875, 'recall': 0.6371777599148618, 'f1-score': 0.4949476294752394, 'support': 88327}, 'accuracy': 0.6185415102463849, 'macro avg': {'precision': 0.5592606498793294, 'recall': 0.5907569398502092, 'f1-score': 0.5637871098001842, 'support': 462163}, 'weighted avg': {'precision': 0.664161303215304, 'recall': 0.6185415102463849, 'f1-score': 0.6316614312362432, 'support': 462163}}
[[ 42431  25665  20490]
 [ 35773 187156  62321]
 [ 12542  19505  56280]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82379454
{'0': {'precision': 0.4808326463314097, 'recall': 0.4853050429407744, 'f1-score': 0.4830584929379575, 'support': 33651}, '1': {'precision': 0.8029273845316308, 'recall': 0.6652622298765736, 'f1-score': 0.7276407039260865, 'support': 97548}, '2': {'precision': 0.420732815181185, 'recall': 0.6292002536002174, 'f1-score': 0.5042706090154613, 'support': 33123}, 'accuracy': 0.62114020033836, 'macro avg': {'precision': 0.5681642820147418, 'recall': 0.5932558421391884, 'f1-score': 0.5716566019598351, 'support': 164322}, 'weighted avg': {'precision': 0.6599261993235002, 'recall': 0.62114020033836, 'f1-score': 0.6325279154030271, 'support': 164322}}
[[16331  8835  8485]
 [12444 64895 20209]
 [ 5189  7093 20841]]
testing model on single stock: results/universal/W5/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
31315/31315 - 522s - 522s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.319022
{'0': {'precision': 0.47330146703839177, 'recall': 0.23081613888151428, 'f1-score': 0.31030502924588044, 'support': 2828771}, '1': {'precision': 0.34598801083288044, 'recall': 0.6262151559945689, 'f1-score': 0.44571534750908104, 'support': 2325113}, '2': {'precision': 0.4377118698153271, 'recall': 0.37136109036464027, 'f1-score': 0.40181581943860417, 'support': 2862602}, 'accuracy': 0.39568534143264267, 'macro avg': {'precision': 0.4190004492288664, 'recall': 0.4094641284135745, 'f1-score': 0.38594539873118855, 'support': 8016486}, 'weighted avg': {'precision': 0.42366662400513444, 'recall': 0.39568534143264267, 'f1-score': 0.382257161683357, 'support': 8016486}}
[[ 652926 1382092  793753]
 [ 297231 1456021  571861]
 [ 429357 1370186 1063059]]
Evaluating performance on  train set...
5759/5759 - 99s - 99s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0518261
{'0': {'precision': 0.49712355223687843, 'recall': 0.4080885719104643, 'f1-score': 0.44822740456883964, 'support': 415030}, '1': {'precision': 0.555453080252391, 'recall': 0.6690676962580709, 'f1-score': 0.6069896402133305, 'support': 641808}, '2': {'precision': 0.4547182481103699, 'recall': 0.39267109796949207, 'f1-score': 0.4214230791979653, 'support': 417334}, 'accuracy': 0.517346008471196, 'macro avg': {'precision': 0.5024316268665465, 'recall': 0.4899424553793425, 'f1-score': 0.49221337466004506, 'support': 1474172}, 'weighted avg': {'precision': 0.5105135654268235, 'recall': 0.517346008471196, 'f1-score': 0.5097592452293535, 'support': 1474172}}
[[169369 166304  79357]
 [ 95239 429413 117156]
 [ 76090 177369 163875]]
Evaluating performance on  val set...
2129/2129 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.149452
{'0': {'precision': 0.5005661548006825, 'recall': 0.38036950820638243, 'f1-score': 0.43226789451653413, 'support': 169685}, '1': {'precision': 0.48733047822983583, 'recall': 0.6596204103123958, 'f1-score': 0.5605351252942757, 'support': 207013}, '2': {'precision': 0.43851988217967597, 'recall': 0.3539603666147573, 'f1-score': 0.391728774314075, 'support': 168242}, 'accuracy': 0.47829852827834257, 'macro avg': {'precision': 0.4754721717367314, 'recall': 0.4646500950445118, 'f1-score': 0.4615105980416283, 'support': 544940}, 'weighted avg': {'precision': 0.4763823068316142, 'recall': 0.47829852827834257, 'f1-score': 0.46847848941485415, 'support': 544940}}
[[ 64543  68116  37026]
 [ 31240 136550  39223]
 [ 33157  75534  59551]]
training model: results/universal/W5/deepLOB_L2/h20
Epoch 1/50
9913/9913 - 458s - loss: 2.8358 - accuracy20: 0.5115 - val_loss: 3.9848 - val_accuracy20: 0.4233 - 458s/epoch - 46ms/step
Epoch 2/50
9913/9913 - 451s - loss: 2.6938 - accuracy20: 0.5556 - val_loss: 3.5954 - val_accuracy20: 0.4770 - 451s/epoch - 46ms/step
Epoch 3/50
9913/9913 - 441s - loss: 2.6280 - accuracy20: 0.5748 - val_loss: 3.5207 - val_accuracy20: 0.4891 - 441s/epoch - 45ms/step
Epoch 4/50
9913/9913 - 444s - loss: 2.5985 - accuracy20: 0.5809 - val_loss: 3.4288 - val_accuracy20: 0.4961 - 444s/epoch - 45ms/step
Epoch 5/50
9913/9913 - 439s - loss: 2.5819 - accuracy20: 0.5844 - val_loss: 3.4460 - val_accuracy20: 0.4969 - 439s/epoch - 44ms/step
Epoch 6/50
9913/9913 - 448s - loss: 2.5707 - accuracy20: 0.5873 - val_loss: 3.4431 - val_accuracy20: 0.4978 - 448s/epoch - 45ms/step
Epoch 7/50
9913/9913 - 444s - loss: 2.5618 - accuracy20: 0.5888 - val_loss: 3.4730 - val_accuracy20: 0.4975 - 444s/epoch - 45ms/step
Epoch 8/50
9913/9913 - 448s - loss: 2.5544 - accuracy20: 0.5906 - val_loss: 3.4501 - val_accuracy20: 0.4982 - 448s/epoch - 45ms/step
Epoch 9/50
9913/9913 - 447s - loss: 2.5497 - accuracy20: 0.5915 - val_loss: 3.4640 - val_accuracy20: 0.4961 - 447s/epoch - 45ms/step
Epoch 10/50
9913/9913 - 447s - loss: 2.5445 - accuracy20: 0.5929 - val_loss: 3.5110 - val_accuracy20: 0.4945 - 447s/epoch - 45ms/step
Epoch 11/50
9913/9913 - 447s - loss: 2.5401 - accuracy20: 0.5937 - val_loss: 3.4624 - val_accuracy20: 0.4950 - 447s/epoch - 45ms/step
Epoch 12/50
9913/9913 - 445s - loss: 2.5363 - accuracy20: 0.5947 - val_loss: 3.5221 - val_accuracy20: 0.4923 - 445s/epoch - 45ms/step
Epoch 13/50
9913/9913 - 448s - loss: 2.5327 - accuracy20: 0.5954 - val_loss: 3.4943 - val_accuracy20: 0.4949 - 448s/epoch - 45ms/step
Epoch 14/50
9913/9913 - 447s - loss: 2.5299 - accuracy20: 0.5959 - val_loss: 3.5211 - val_accuracy20: 0.4939 - 447s/epoch - 45ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 838s - 838s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1689327
{'0': {'precision': 0.5364763573943623, 'recall': 0.27544165797309844, 'f1-score': 0.3639971882559948, 'support': 4317368}, '1': {'precision': 0.400718827644828, 'recall': 0.6655314342227738, 'f1-score': 0.5002408639326484, 'support': 4125440}, '2': {'precision': 0.4672474233585781, 'recall': 0.4007509356551793, 'f1-score': 0.431452064739339, 'support': 4395583}, 'accuracy': 0.4436947745243154, 'macro avg': {'precision': 0.46814753613258947, 'recall': 0.4472413426170172, 'f1-score': 0.43189670564266075, 'support': 12838391}, 'weighted avg': {'precision': 0.4691500803643409, 'recall': 0.4436947745243154, 'f1-score': 0.43087228325199406, 'support': 12838391}}
[[1189183 2053756 1074429]
 [ 445769 2745610  934061]
 [ 581703 2052346 1761534]]
Evaluating performance on  train set...
9913/9913 - 171s - 171s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9854058
{'0': {'precision': 0.4990784422013587, 'recall': 0.435397290013801, 'f1-score': 0.4650680456381269, 'support': 689081}, '1': {'precision': 0.5940796571909553, 'recall': 0.6714501804520252, 'f1-score': 0.6303998233130189, 'support': 1156263}, '2': {'precision': 0.4488551365839622, 'recall': 0.4081921210254898, 'f1-score': 0.4275589907292711, 'support': 691689}, 'accuracy': 0.5355622098727135, 'macro avg': {'precision': 0.514004411992092, 'recall': 0.505013197163772, 'f1-score': 0.5076756198934723, 'support': 2537033}, 'weighted avg': {'precision': 0.528682898197132, 'recall': 0.5355622098727135, 'f1-score': 0.5301923134615459, 'support': 2537033}}
[[300024 262835 126222]
 [159427 776373 220463]
 [141705 267642 282342]]
Evaluating performance on  val set...
3496/3496 - 60s - 60s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0590788
{'0': {'precision': 0.4957478916999556, 'recall': 0.41509307744623286, 'f1-score': 0.45184949947105135, 'support': 269077}, '1': {'precision': 0.517884659813516, 'recall': 0.64805755072598, 'f1-score': 0.5757044580142775, 'support': 356277}, '2': {'precision': 0.45320274328746246, 'recall': 0.3760437394231306, 'f1-score': 0.41103352948948585, 'support': 268865}, 'accuracy': 0.49617040121044176, 'macro avg': {'precision': 0.488945098266978, 'recall': 0.4797314558651145, 'f1-score': 0.47952916232493825, 'support': 894219}, 'weighted avg': {'precision': 0.4917756209310165, 'recall': 0.49617040121044176, 'f1-score': 0.4889239603087336, 'support': 894219}}
[[111692 105770  51615]
 [ 55019 230888  70370]
 [ 58589 109171 101105]]
testing model out of sample: results/universal/W5/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 353s - 353s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.072637
{'0': {'precision': 0.5222334371020552, 'recall': 0.29817039239099946, 'f1-score': 0.3796046367960996, 'support': 1565199}, '1': {'precision': 0.5483981430705323, 'recall': 0.7115235136273823, 'f1-score': 0.6194006929715519, 'support': 2219245}, '2': {'precision': 0.46365780711289983, 'recall': 0.46704039887496807, 'f1-score': 0.46534295603514797, 'support': 1564400}, 'accuracy': 0.5190615018871367, 'macro avg': {'precision': 0.5114297957618291, 'recall': 0.4922447682977833, 'f1-score': 0.4881160952675998, 'support': 5348844}, 'weighted avg': {'precision': 0.5159573477904167, 'recall': 0.5190615018871367, 'f1-score': 0.5041727164231479, 'support': 5348844}}
[[ 466696  694996  403507]
 [ 198532 1579045  441668]
 [ 228426  605336  730638]]
Evaluating performance on  train set...
4957/4957 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94094557
{'0': {'precision': 0.5188756508845133, 'recall': 0.37166657918543655, 'f1-score': 0.4331040835013879, 'support': 323879}, '1': {'precision': 0.6456195335276967, 'recall': 0.7170693244997944, 'f1-score': 0.6794712675066698, 'support': 617646}, '2': {'precision': 0.46777812029045074, 'recall': 0.5014610533659304, 'f1-score': 0.48403431334182945, 'support': 326819}, 'accuracy': 0.5733121298322853, 'macro avg': {'precision': 0.5440911015675536, 'recall': 0.530065652350387, 'f1-score': 0.5322032214499623, 'support': 1268344}, 'weighted avg': {'precision': 0.567429677463904, 'recall': 0.5733121298322853, 'f1-score': 0.5662009976810976, 'support': 1268344}}
[[120375 128464  75040]
 [ 63326 442895 111425]
 [ 48291 114641 163887]]
Evaluating performance on  val set...
1701/1701 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94405496
{'0': {'precision': 0.5274867932288788, 'recall': 0.35953077637411734, 'f1-score': 0.42760762085367315, 'support': 114146}, '1': {'precision': 0.6367131247104199, 'recall': 0.7372297698966203, 'f1-score': 0.6832945856234799, 'support': 206907}, '2': {'precision': 0.47784197111299914, 'recall': 0.493268665748691, 'f1-score': 0.48543278712578597, 'support': 114019}, 'accuracy': 0.5742015114739629, 'macro avg': {'precision': 0.547347296350766, 'recall': 0.5300097373398095, 'f1-score': 0.532111664534313, 'support': 435072}, 'weighted avg': {'precision': 0.5664211296031357, 'recall': 0.5742015114739629, 'f1-score': 0.5643587573386836, 'support': 435072}}
[[ 41039  46384  26723]
 [ 19634 152538  34735]
 [ 17128  40649  56242]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
1060/1060 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1954335
{'0': {'precision': 0.4708966894902157, 'recall': 0.348601449627864, 'f1-score': 0.4006238958831817, 'support': 102785}, '1': {'precision': 0.3343117985893084, 'recall': 0.5476465914951147, 'f1-score': 0.41517767516562937, 'support': 71747}, '2': {'precision': 0.45662694020438105, 'recall': 0.36656403686407407, 'f1-score': 0.40666872986944513, 'support': 96788}, 'accuracy': 0.4076441102756892, 'macro avg': {'precision': 0.42061180942796833, 'recall': 0.4209373593290176, 'f1-score': 0.4074901003060854, 'support': 271320}, 'weighted avg': {'precision': 0.4296881657494492, 'recall': 0.4076441102756892, 'f1-score': 0.4066288250960678, 'support': 271320}}
[[35831 41462 25492]
 [15728 39292 16727]
 [24532 36777 35479]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1736604
{'0': {'precision': 0.4631832672420496, 'recall': 0.27174855161717076, 'f1-score': 0.3425334943361508, 'support': 21921}, '1': {'precision': 0.4411296210260835, 'recall': 0.5201314708299096, 'f1-score': 0.4773841374728412, 'support': 25557}, '2': {'precision': 0.4138486916098073, 'recall': 0.49745392276147987, 'f1-score': 0.4518162283843241, 'support': 22191}, 'accuracy': 0.43475577373006646, 'macro avg': {'precision': 0.43938719329264675, 'recall': 0.4297779817361867, 'f1-score': 0.4239112867311054, 'support': 69669}, 'weighted avg': {'precision': 0.43937915631471414, 'recall': 0.43475577373006646, 'f1-score': 0.426810160255102, 'support': 69669}}
[[ 5957  8914  7050]
 [ 3679 13293  8585]
 [ 3225  7927 11039]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1832592
{'0': {'precision': 0.48828956706884313, 'recall': 0.25822594770424123, 'f1-score': 0.33780687397708675, 'support': 7993}, '1': {'precision': 0.4378206262161684, 'recall': 0.5589430894308943, 'f1-score': 0.49102271600039676, 'support': 8856}, '2': {'precision': 0.4154772524531668, 'recall': 0.4869315211709357, 'f1-score': 0.4483754512635379, 'support': 7652}, 'accuracy': 0.43834945512428064, 'macro avg': {'precision': 0.4471958152460595, 'recall': 0.4347001861020237, 'f1-score': 0.4257350137470071, 'support': 24501}, 'weighted avg': {'precision': 0.4473070450644171, 'recall': 0.43834945512428064, 'f1-score': 0.427719540821475, 'support': 24501}}
[[2064 3378 2551]
 [1215 4950 2691]
 [ 948 2978 3726]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8112774
{'0': {'precision': 0.5223264630371668, 'recall': 0.42510105645492, 'f1-score': 0.46872510389079086, 'support': 102418}, '1': {'precision': 0.8118818695499563, 'recall': 0.6667043450739251, 'f1-score': 0.7321658551420868, 'support': 353872}, '2': {'precision': 0.3674281272603612, 'recall': 0.6614034746783785, 'f1-score': 0.47241597090646625, 'support': 102916}, 'accuracy': 0.6214793832684199, 'macro avg': {'precision': 0.5672121532824947, 'recall': 0.5844029587357412, 'f1-score': 0.557768976646448, 'support': 559206}, 'weighted avg': {'precision': 0.6770530462438709, 'recall': 0.6214793832684199, 'f1-score': 0.6361127120290866, 'support': 559206}}
[[ 43538  31971  26909]
 [ 27664 235928  90280]
 [ 12152  22695  68069]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6883387
{'0': {'precision': 0.4198002712365923, 'recall': 0.6101057158215374, 'f1-score': 0.4973707274320771, 'support': 16743}, '1': {'precision': 0.9156618235899783, 'recall': 0.6852685833661535, 'f1-score': 0.7838870171589751, 'support': 116798}, '2': {'precision': 0.30376399301632945, 'recall': 0.6898542274052478, 'f1-score': 0.4217975685407679, 'support': 17150}, 'accuracy': 0.6774392631278576, 'macro avg': {'precision': 0.5464086959476333, 'recall': 0.6617428421976462, 'f1-score': 0.5676851043772734, 'support': 150691}, 'weighted avg': {'precision': 0.7909280454254508, 'recall': 0.6774392631278576, 'f1-score': 0.7108436616652847, 'support': 150691}}
[[10215  3911  2617]
 [12260 80038 24500]
 [ 1858  3461 11831]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7262772
{'0': {'precision': 0.3789282039103934, 'recall': 0.6388629387428266, 'f1-score': 0.47570307065487427, 'support': 7493}, '1': {'precision': 0.8879240585122938, 'recall': 0.6908584574403681, 'f1-score': 0.7770922710248555, 'support': 41295}, '2': {'precision': 0.409928481278923, 'recall': 0.6198473282442748, 'f1-score': 0.4934920232970373, 'support': 7860}, 'accuracy': 0.6741279480299393, 'macro avg': {'precision': 0.5589269145672034, 'recall': 0.6498562414758232, 'f1-score': 0.582095788325589, 'support': 56648}, 'weighted avg': {'precision': 0.754275012198455, 'recall': 0.6741279480299393, 'f1-score': 0.6978766371893641, 'support': 56648}}
[[ 4787  1705  1001]
 [ 6754 28529  6012]
 [ 1092  1896  4872]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
2341/2341 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2445155
{'0': {'precision': 0.4910153775269251, 'recall': 0.3303049087598311, 'f1-score': 0.3949367674989578, 'support': 206488}, '1': {'precision': 0.38969870466037093, 'recall': 0.5713014675142303, 'f1-score': 0.4633411071239945, 'support': 186574}, '2': {'precision': 0.4620143422883442, 'recall': 0.41863825701553187, 'f1-score': 0.4392580664036166, 'support': 206221}, 'accuracy': 0.4357306981843303, 'macro avg': {'precision': 0.44757614149188013, 'recall': 0.4400815444298644, 'f1-score': 0.4325119803421896, 'support': 599283}, 'weighted avg': {'precision': 0.4494929592181463, 'recall': 0.4357306981843303, 'f1-score': 0.4314845318150142, 'support': 599283}}
[[ 68204  85978  52306]
 [ 31762 106590  48222]
 [ 38938  80951  86332]]
Evaluating performance on  train set...
483/483 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1636755
{'0': {'precision': 0.5012398157987956, 'recall': 0.31891715917059, 'f1-score': 0.3898131284531444, 'support': 39932}, '1': {'precision': 0.44667093137848163, 'recall': 0.6047943441721094, 'f1-score': 0.5138430327379767, 'support': 42717}, '2': {'precision': 0.4607911345226855, 'recall': 0.4540557745513307, 'f1-score': 0.457398660730802, 'support': 40843}, 'accuracy': 0.46249959511547306, 'macro avg': {'precision': 0.4695672938999875, 'recall': 0.45925575929801005, 'f1-score': 0.4536849406406411, 'support': 123492}, 'weighted avg': {'precision': 0.46898619187868157, 'recall': 0.46249959511547306, 'f1-score': 0.45506902613195405, 'support': 123492}}
[[12735 16356 10841]
 [ 6022 25835 10860]
 [ 6650 15648 18545]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.180153
{'0': {'precision': 0.49561900834965467, 'recall': 0.34355126831011074, 'f1-score': 0.4058068872383524, 'support': 13995}, '1': {'precision': 0.42028005141040387, 'recall': 0.5014932601501332, 'f1-score': 0.45730899455321655, 'support': 12389}, '2': {'precision': 0.4719995249124057, 'recall': 0.5320302563759288, 'f1-score': 0.5002202781798728, 'support': 14939}, 'accuracy': 0.45904217989981366, 'macro avg': {'precision': 0.462632861557488, 'recall': 0.45902492827872426, 'f1-score': 0.45444538665714723, 'support': 41323}, 'weighted avg': {'precision': 0.4644928606694417, 'recall': 0.45904217989981366, 'f1-score': 0.4553797946942299, 'support': 41323}}
[[4808 4334 4853]
 [2138 6213 4038]
 [2755 4236 7948]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3201513
{'0': {'precision': 0.4084826387527607, 'recall': 0.3305468312130537, 'f1-score': 0.3654052979822777, 'support': 189126}, '1': {'precision': 0.28232228269833415, 'recall': 0.2875100779360387, 'f1-score': 0.28489256528468954, 'support': 148840}, '2': {'precision': 0.3845561467376085, 'recall': 0.45544494254080736, 'f1-score': 0.4170093453213925, 'support': 180911}, 'accuracy': 0.3617485454163511, 'macro avg': {'precision': 0.35845368939623445, 'recall': 0.3578339505632999, 'f1-score': 0.35576906952945325, 'support': 518877}, 'weighted avg': {'precision': 0.36395132787928963, 'recall': 0.3617485454163511, 'f1-score': 0.3603024020617755, 'support': 518877}}
[[62515 56563 70048]
 [44230 42793 61817]
 [46297 52219 82395]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3135692
{'0': {'precision': 0.38408152829017056, 'recall': 0.370429084760093, 'f1-score': 0.3771317898965264, 'support': 28386}, '1': {'precision': 0.3157958102576451, 'recall': 0.28326133909287254, 'f1-score': 0.2986451098713423, 'support': 27780}, '2': {'precision': 0.37574892124297643, 'recall': 0.4270693670171477, 'f1-score': 0.39976880521839653, 'support': 28342}, 'accuracy': 0.3607705779334501, 'macro avg': {'precision': 0.3585420865969307, 'recall': 0.36025326362337107, 'f1-score': 0.35851523499542176, 'support': 84508}, 'weighted avg': {'precision': 0.3588396577468477, 'recall': 0.3607705779334501, 'f1-score': 0.3589230796815506, 'support': 84508}}
[[10515  8523  9348]
 [ 9150  7869 10761]
 [ 7712  8526 12104]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3293381
{'0': {'precision': 0.4203098471986418, 'recall': 0.3182037275064267, 'f1-score': 0.36219824433065106, 'support': 12448}, '1': {'precision': 0.28476130915155307, 'recall': 0.26345226615236256, 'f1-score': 0.2736926467641755, 'support': 10370}, '2': {'precision': 0.3813348632625741, 'recall': 0.503238832337848, 'f1-score': 0.4338869949952854, 'support': 11887}, 'accuracy': 0.3652211496902464, 'macro avg': {'precision': 0.362135339870923, 'recall': 0.3616316086655458, 'f1-score': 0.356592628696704, 'support': 34705}, 'weighted avg': {'precision': 0.3664578381625851, 'recall': 0.3652211496902464, 'f1-score': 0.360306906839977, 'support': 34705}}
[[3961 3523 4964]
 [2897 2732 4741]
 [2566 3339 5982]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
2900/2900 - 49s - 49s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2977623
{'0': {'precision': 0.4667544999298554, 'recall': 0.2923347277137891, 'f1-score': 0.3595059570789642, 'support': 261765}, '1': {'precision': 0.3180616352477948, 'recall': 0.334664950839706, 'f1-score': 0.3261521249264097, 'support': 216028}, '2': {'precision': 0.4214482236133817, 'recall': 0.5593067866119857, 'f1-score': 0.48068854956624557, 'support': 264565}, 'accuracy': 0.3997976717432829, 'macro avg': {'precision': 0.4020881195970106, 'recall': 0.39543548838849363, 'f1-score': 0.3887822105238732, 'support': 742358}, 'weighted avg': {'precision': 0.4073380496926329, 'recall': 0.3997976717432829, 'f1-score': 0.3929875265227441, 'support': 742358}}
[[ 76523  81840 103402]
 [ 44000  72297  99731]
 [ 43424  73168 147973]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2114172
{'0': {'precision': 0.4594317716158995, 'recall': 0.34368773310172174, 'f1-score': 0.39321934823907645, 'support': 58719}, '1': {'precision': 0.4148141665208005, 'recall': 0.47037612888286084, 'f1-score': 0.44085138047033656, 'support': 60458}, '2': {'precision': 0.4384674447174447, 'recall': 0.48871202396234487, 'f1-score': 0.4622283378526043, 'support': 58425}, 'accuracy': 0.43452213375975496, 'macro avg': {'precision': 0.4375711276180483, 'recall': 0.4342586286489758, 'f1-score': 0.4320996888540058, 'support': 177602}, 'weighted avg': {'precision': 0.43734681779847784, 'recall': 0.43452213375975496, 'f1-score': 0.43213550696931535, 'support': 177602}}
[[20181 21191 17347]
 [12800 28438 19220]
 [10945 18927 28553]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1966698
{'0': {'precision': 0.47164413931202176, 'recall': 0.3359653591441671, 'f1-score': 0.39240769940201714, 'support': 19630}, '1': {'precision': 0.4414193597043629, 'recall': 0.5369971099591725, 'f1-score': 0.48453992301005844, 'support': 21799}, '2': {'precision': 0.4417382764547017, 'recall': 0.4628048153102171, 'f1-score': 0.45202622917870505, 'support': 19438}, 'accuracy': 0.44846961407659325, 'macro avg': {'precision': 0.45160059182369544, 'recall': 0.44525576147118556, 'f1-score': 0.4429912838635935, 'support': 60867}, 'weighted avg': {'precision': 0.45126889274347154, 'recall': 0.44846961407659325, 'f1-score': 0.44444337266061296, 'support': 60867}}
[[ 6595  7821  5214]
 [ 3938 11706  6155]
 [ 3450  6992  8996]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
7167/7167 - 121s - 121s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72242516
{'0': {'precision': 0.5545726932243786, 'recall': 0.45591524261381927, 'f1-score': 0.5004278329531228, 'support': 357255}, '1': {'precision': 0.7909186583605343, 'recall': 0.7417720431570084, 'f1-score': 0.7655573934156583, 'support': 1117501}, '2': {'precision': 0.4620807207645949, 'recall': 0.6328752275474897, 'f1-score': 0.5341574549186336, 'support': 359815}, 'accuracy': 0.6647477802712459, 'macro avg': {'precision': 0.6025240241165026, 'recall': 0.610187504439439, 'f1-score': 0.6000475604291383, 'support': 1834571}, 'weighted avg': {'precision': 0.6803987600896032, 'recall': 0.6647477802712459, 'f1-score': 0.6685428706779992, 'support': 1834571}}
[[162878 131327  63050]
 [ 86528 828931 202042]
 [ 44294  87803 227718]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7098026
{'0': {'precision': 0.50653745161203, 'recall': 0.5498758430185574, 'f1-score': 0.5273176883352942, 'support': 68059}, '1': {'precision': 0.8604130438847442, 'recall': 0.6931257178362298, 'f1-score': 0.7677625088898575, 'support': 265555}, '2': {'precision': 0.4224667012020054, 'recall': 0.7067048542263348, 'f1-score': 0.5288111749771951, 'support': 68085}, 'accuracy': 0.6711567616548709, 'macro avg': {'precision': 0.5964723988995931, 'recall': 0.6499021383603739, 'f1-score': 0.6079637907341157, 'support': 401699}, 'weighted avg': {'precision': 0.7262280056445621, 'recall': 0.6711567616548709, 'f1-score': 0.6865239805102334, 'support': 401699}}
[[ 37424  17565  13070]
 [ 28785 184063  52707]
 [  7673  12296  48116]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76201046
{'0': {'precision': 0.5195726495726496, 'recall': 0.5026459401356045, 'f1-score': 0.5109691518870304, 'support': 24188}, '1': {'precision': 0.8619939429804714, 'recall': 0.6385873069087346, 'f1-score': 0.7336602275420716, 'support': 77554}, '2': {'precision': 0.40498039914469, 'recall': 0.7573308897034322, 'f1-score': 0.5277487518866829, 'support': 24008}, 'accuracy': 0.6351093439363817, 'macro avg': {'precision': 0.5955156638992704, 'recall': 0.632854712249257, 'f1-score': 0.590792710438595, 'support': 125750}, 'weighted avg': {'precision': 0.7088769059597331, 'recall': 0.6351093439363817, 'f1-score': 0.651513313462718, 'support': 125750}}
[[12158  5167  6863]
 [ 8178 49525 19851]
 [ 3064  2762 18182]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
6357/6357 - 107s - 107s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87715566
{'0': {'precision': 0.6238560732113144, 'recall': 0.19512231181603404, 'f1-score': 0.297268502981064, 'support': 338193}, '1': {'precision': 0.6908771975985932, 'recall': 0.8323284706856946, 'f1-score': 0.7550349546119624, 'support': 946398}, '2': {'precision': 0.4384384148068872, 'recall': 0.4879034847538371, 'f1-score': 0.4618502747973905, 'support': 342578}, 'accuracy': 0.6273767506632686, 'macro avg': {'precision': 0.584390561872265, 'recall': 0.5051180890851886, 'f1-score': 0.5047179107968056, 'support': 1627169}, 'weighted avg': {'precision': 0.6237999312229899, 'recall': 0.6273767506632686, 'f1-score': 0.5981661654339945, 'support': 1627169}}
[[ 65989 193235  78969]
 [ 23570 787714 135114]
 [ 16217 159216 167145]]
Evaluating performance on  train set...
1701/1701 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7772311
{'0': {'precision': 0.5593010522306338, 'recall': 0.39713986274045776, 'f1-score': 0.4644735281325373, 'support': 88737}, '1': {'precision': 0.7329978156400174, 'recall': 0.8204910529157244, 'f1-score': 0.7742806037593749, 'support': 255614}, '2': {'precision': 0.5000115896342311, 'recall': 0.47375009608310364, 'f1-score': 0.4865267182028858, 'support': 91067}, 'accuracy': 0.6616929019930274, 'macro avg': {'precision': 0.597436819168294, 'recall': 0.5637936705797619, 'f1-score': 0.575093616698266, 'support': 435418}, 'weighted avg': {'precision': 0.6488701811868542, 'recall': 0.6616929019930274, 'f1-score': 0.650959488036388, 'support': 435418}}
[[ 35241  39240  14256]
 [ 17000 209729  28885]
 [ 10768  37156  43143]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8010559
{'0': {'precision': 0.5971189279731993, 'recall': 0.3004314994606257, 'f1-score': 0.3997398461503958, 'support': 29664}, '1': {'precision': 0.705161239946904, 'recall': 0.8537934294493028, 'f1-score': 0.772391969039321, 'support': 84620}, '2': {'precision': 0.5038233750655972, 'recall': 0.4514189756507137, 'f1-score': 0.47618372805696785, 'support': 29775}, 'accuracy': 0.6566823315447143, 'macro avg': {'precision': 0.6020345143285668, 'recall': 0.5352146348535474, 'f1-score': 0.5494385144155616, 'support': 144059}, 'weighted avg': {'precision': 0.6412998909910673, 'recall': 0.6566823315447143, 'f1-score': 0.6344349309602934, 'support': 144059}}
[[ 8912 16306  4446]
 [ 3581 72248  8791]
 [ 2432 13902 13441]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
7459/7459 - 126s - 126s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0019274
{'0': {'precision': 0.5393037833612712, 'recall': 0.3326634699051142, 'f1-score': 0.41149863652301133, 'support': 530954}, '1': {'precision': 0.5516036085419006, 'recall': 0.7546453149975835, 'f1-score': 0.6373441867327576, 'support': 821419}, '2': {'precision': 0.5033976766529827, 'recall': 0.4139793635230697, 'f1-score': 0.4543306419349689, 'support': 556878}, 'accuracy': 0.5379308430374006, 'macro avg': {'precision': 0.5314350228520515, 'recall': 0.5004293828085892, 'f1-score': 0.5010578217302459, 'support': 1909251}, 'weighted avg': {'precision': 0.5341226883709055, 'recall': 0.5379308430374006, 'f1-score': 0.5211573600316226, 'support': 1909251}}
[[176629 254628  99697]
 [ 73812 619880 127727]
 [ 77072 249270 230536]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77712375
{'0': {'precision': 0.5337185623991749, 'recall': 0.45699825638006386, 'f1-score': 0.4923878302876522, 'support': 88322}, '1': {'precision': 0.7644341322087647, 'recall': 0.740520783910061, 'f1-score': 0.7522874695684852, 'support': 248702}, '2': {'precision': 0.46504592606132616, 'recall': 0.5721112222984293, 'f1-score': 0.5130524214283554, 'support': 88939}, 'accuracy': 0.6465702420163254, 'macro avg': {'precision': 0.5877328735564219, 'recall': 0.5898767541961847, 'f1-score': 0.5859092404281643, 'support': 425963}, 'weighted avg': {'precision': 0.65408523283659, 'recall': 0.6465702420163254, 'f1-score': 0.6484470376833291, 'support': 425963}}
[[ 40363  31024  16935]
 [ 22936 184169  41597]
 [ 12327  25729  50883]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.847573
{'0': {'precision': 0.5303525990548892, 'recall': 0.4501141482075646, 'f1-score': 0.4869501368399974, 'support': 32414}, '1': {'precision': 0.7206820050576354, 'recall': 0.6925427872860636, 'f1-score': 0.7063322512221268, 'support': 67076}, '2': {'precision': 0.475291601382775, 'recall': 0.5846845744355381, 'f1-score': 0.5243432334179299, 'support': 32686}, 'accuracy': 0.606418714441351, 'macro avg': {'precision': 0.5754420684984333, 'recall': 0.5757805033097222, 'f1-score': 0.5725418738266846, 'support': 132176}, 'weighted avg': {'precision': 0.6133238757399869, 'recall': 0.606418714441351, 'f1-score': 0.6075280440171098, 'support': 132176}}
[[14590  9918  7906]
 [ 7431 46453 13192]
 [ 5489  8086 19111]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
8238/8238 - 146s - 146s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0795357
{'0': {'precision': 0.5380884869225129, 'recall': 0.3355834430947851, 'f1-score': 0.4133670338419707, 'support': 655968}, '1': {'precision': 0.5109936857876712, 'recall': 0.7175559613173733, 'f1-score': 0.5969096426774345, 'support': 798498}, '2': {'precision': 0.5074662738140936, 'recall': 0.4485837174893924, 'f1-score': 0.4762117246560472, 'support': 654248}, 'accuracy': 0.5152827742406035, 'macro avg': {'precision': 0.5188494821747592, 'recall': 0.5005743739671836, 'f1-score': 0.49549613372515083, 'support': 2108714}, 'weighted avg': {'precision': 0.5183277862308469, 'recall': 0.5152827742406035, 'f1-score': 0.5023664995569174, 'support': 2108714}}
[[220132 292748 143088]
 [ 83770 572967 141761]
 [105198 255565 293485]]
Evaluating performance on  train set...
1806/1806 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89739454
{'0': {'precision': 0.5330169211721008, 'recall': 0.4058130400628437, 'f1-score': 0.4607974310944608, 'support': 114570}, '1': {'precision': 0.6813005588981604, 'recall': 0.7100857265323618, 'f1-score': 0.6953953872017832, 'support': 233300}, '2': {'precision': 0.4759671568850643, 'recall': 0.5487825151146615, 'f1-score': 0.5097878254650081, 'support': 114293}, 'accuracy': 0.5947663486691924, 'macro avg': {'precision': 0.5634282123184419, 'recall': 0.5548937605699557, 'f1-score': 0.5553268812537507, 'support': 462163}, 'weighted avg': {'precision': 0.5937621213976303, 'recall': 0.5947663486691924, 'f1-score': 0.5913378731108734, 'support': 462163}}
[[ 46494  42663  25413]
 [ 23994 165663  43643]
 [ 16740  34831  62722]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8804413
{'0': {'precision': 0.5364484366902746, 'recall': 0.43470044792833146, 'f1-score': 0.48024433619423185, 'support': 42864}, '1': {'precision': 0.6800488348386791, 'recall': 0.7240134775311384, 'f1-score': 0.7013428356630748, 'support': 79243}, '2': {'precision': 0.49436115165185085, 'recall': 0.5295747956887362, 'f1-score': 0.5113624666903026, 'support': 42215}, 'accuracy': 0.5985930064142355, 'macro avg': {'precision': 0.5702861410602682, 'recall': 0.562762907049402, 'f1-score': 0.5643165461825363, 'support': 164322}, 'weighted avg': {'precision': 0.5948862089458276, 'recall': 0.5985930064142355, 'f1-score': 0.5948617354000664, 'support': 164322}}
[[18633 14483  9748]
 [ 8752 57373 13118]
 [ 7349 12510 22356]]
testing model on single stock: results/universal/W5/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
31315/31315 - 539s - 539s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3259805
{'0': {'precision': 0.5472662888788623, 'recall': 0.2369704377369435, 'f1-score': 0.33073159578722244, 'support': 3137615}, '1': {'precision': 0.240277758770156, 'recall': 0.6047678832741025, 'f1-score': 0.34391579422324753, 'support': 1683808}, '2': {'precision': 0.47649628545062855, 'recall': 0.3608786430815292, 'f1-score': 0.41070571154605123, 'support': 3195063}, 'accuracy': 0.36360881812804263, 'macro avg': {'precision': 0.42134677769988227, 'recall': 0.40087232136419176, 'f1-score': 0.36178436718550705, 'support': 8016486}, 'weighted avg': {'precision': 0.4545792484014382, 'recall': 0.36360881812804263, 'f1-score': 0.36537545308565933, 'support': 8016486}}
[[ 743522 1579409  814684]
 [ 213400 1018313  452095]
 [ 401689 1640344 1153030]]
Evaluating performance on  train set...
5759/5759 - 99s - 99s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.132201
{'0': {'precision': 0.5041337410356372, 'recall': 0.4132136652918242, 'f1-score': 0.45416807088295996, 'support': 487571}, '1': {'precision': 0.43303474778090495, 'recall': 0.643369492670296, 'f1-score': 0.5176518923255596, 'support': 497428}, '2': {'precision': 0.4761992762910812, 'recall': 0.32659611221387935, 'f1-score': 0.3874582104049271, 'support': 489173}, 'accuracy': 0.46213264123860714, 'macro avg': {'precision': 0.4711225883692078, 'recall': 0.46105975672533317, 'f1-score': 0.45309272453781557, 'support': 1474172}, 'weighted avg': {'precision': 0.4708734322391036, 'recall': 0.46213264123860714, 'f1-score': 0.4534530713801399, 'support': 1474172}}
[[201471 201680  84420]
 [ 86086 320030  91312]
 [112081 217330 159762]]
Evaluating performance on  val set...
2129/2129 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1954126
{'0': {'precision': 0.5017061929214363, 'recall': 0.3963248049695119, 'f1-score': 0.44283239560452314, 'support': 192534}, '1': {'precision': 0.3680427890831164, 'recall': 0.6494730657198935, 'f1-score': 0.469838140435047, 'support': 159982}, '2': {'precision': 0.4798429414106322, 'recall': 0.27563089843262795, 'f1-score': 0.35013665350744005, 'support': 192424}, 'accuracy': 0.4280251036811392, 'macro avg': {'precision': 0.4498639744717283, 'recall': 0.44047625637401105, 'f1-score': 0.42093572984900335, 'support': 544940}, 'weighted avg': {'precision': 0.45474551288037296, 'recall': 0.4280251036811392, 'f1-score': 0.4180288348312045, 'support': 544940}}
[[ 76306  85354  30874]
 [ 29458 103904  26620]
 [ 46329  93057  53038]]
training model: results/universal/W5/deepLOB_L2/h30
Epoch 1/50
9913/9913 - 459s - loss: 2.9224 - accuracy30: 0.4937 - val_loss: 3.5560 - val_accuracy30: 0.4172 - 459s/epoch - 46ms/step
Epoch 2/50
9913/9913 - 466s - loss: 2.8042 - accuracy30: 0.5301 - val_loss: 3.3815 - val_accuracy30: 0.4408 - 466s/epoch - 47ms/step
Epoch 3/50
9913/9913 - 469s - loss: 2.7416 - accuracy30: 0.5476 - val_loss: 3.5056 - val_accuracy30: 0.4408 - 469s/epoch - 47ms/step
Epoch 4/50
9913/9913 - 469s - loss: 2.7127 - accuracy30: 0.5545 - val_loss: 3.4556 - val_accuracy30: 0.4517 - 469s/epoch - 47ms/step
Epoch 5/50
9913/9913 - 467s - loss: 2.6971 - accuracy30: 0.5578 - val_loss: 3.4567 - val_accuracy30: 0.4560 - 467s/epoch - 47ms/step
Epoch 6/50
9913/9913 - 463s - loss: 2.6862 - accuracy30: 0.5605 - val_loss: 3.3936 - val_accuracy30: 0.4616 - 463s/epoch - 47ms/step
Epoch 7/50
9913/9913 - 467s - loss: 2.6791 - accuracy30: 0.5622 - val_loss: 3.4263 - val_accuracy30: 0.4629 - 467s/epoch - 47ms/step
Epoch 8/50
9913/9913 - 469s - loss: 2.6729 - accuracy30: 0.5636 - val_loss: 3.3520 - val_accuracy30: 0.4691 - 469s/epoch - 47ms/step
Epoch 9/50
9913/9913 - 467s - loss: 2.6673 - accuracy30: 0.5650 - val_loss: 3.3513 - val_accuracy30: 0.4727 - 467s/epoch - 47ms/step
Epoch 10/50
9913/9913 - 466s - loss: 2.6631 - accuracy30: 0.5659 - val_loss: 3.3768 - val_accuracy30: 0.4679 - 466s/epoch - 47ms/step
Epoch 11/50
9913/9913 - 467s - loss: 2.6587 - accuracy30: 0.5669 - val_loss: 3.3528 - val_accuracy30: 0.4729 - 467s/epoch - 47ms/step
Epoch 12/50
9913/9913 - 468s - loss: 2.6551 - accuracy30: 0.5679 - val_loss: 3.3636 - val_accuracy30: 0.4723 - 468s/epoch - 47ms/step
Epoch 13/50
9913/9913 - 469s - loss: 2.6526 - accuracy30: 0.5684 - val_loss: 3.3720 - val_accuracy30: 0.4707 - 469s/epoch - 47ms/step
Epoch 14/50
9913/9913 - 474s - loss: 2.6494 - accuracy30: 0.5692 - val_loss: 3.3616 - val_accuracy30: 0.4734 - 474s/epoch - 48ms/step
Epoch 15/50
9913/9913 - 467s - loss: 2.6465 - accuracy30: 0.5700 - val_loss: 3.3412 - val_accuracy30: 0.4770 - 467s/epoch - 47ms/step
Epoch 16/50
9913/9913 - 462s - loss: 2.6439 - accuracy30: 0.5706 - val_loss: 3.3442 - val_accuracy30: 0.4776 - 462s/epoch - 47ms/step
Epoch 17/50
9913/9913 - 471s - loss: 2.6422 - accuracy30: 0.5709 - val_loss: 3.3099 - val_accuracy30: 0.4810 - 471s/epoch - 48ms/step
Epoch 18/50
9913/9913 - 472s - loss: 2.6400 - accuracy30: 0.5716 - val_loss: 3.3296 - val_accuracy30: 0.4792 - 472s/epoch - 48ms/step
Epoch 19/50
9913/9913 - 477s - loss: 2.6379 - accuracy30: 0.5718 - val_loss: 3.3123 - val_accuracy30: 0.4845 - 477s/epoch - 48ms/step
Epoch 20/50
9913/9913 - 471s - loss: 2.6362 - accuracy30: 0.5723 - val_loss: 3.3297 - val_accuracy30: 0.4864 - 471s/epoch - 48ms/step
Epoch 21/50
9913/9913 - 473s - loss: 2.6339 - accuracy30: 0.5729 - val_loss: 3.2872 - val_accuracy30: 0.4866 - 473s/epoch - 48ms/step
Epoch 22/50
9913/9913 - 470s - loss: 2.6322 - accuracy30: 0.5733 - val_loss: 3.3376 - val_accuracy30: 0.4847 - 470s/epoch - 47ms/step
Epoch 23/50
9913/9913 - 468s - loss: 2.6308 - accuracy30: 0.5735 - val_loss: 3.3297 - val_accuracy30: 0.4842 - 468s/epoch - 47ms/step
Epoch 24/50
9913/9913 - 463s - loss: 2.6288 - accuracy30: 0.5743 - val_loss: 3.3262 - val_accuracy30: 0.4864 - 463s/epoch - 47ms/step
Epoch 25/50
9913/9913 - 463s - loss: 2.6276 - accuracy30: 0.5743 - val_loss: 3.3563 - val_accuracy30: 0.4854 - 463s/epoch - 47ms/step
Epoch 26/50
9913/9913 - 461s - loss: 2.6257 - accuracy30: 0.5748 - val_loss: 3.3481 - val_accuracy30: 0.4859 - 461s/epoch - 46ms/step
Epoch 27/50
9913/9913 - 463s - loss: 2.6246 - accuracy30: 0.5752 - val_loss: 3.3685 - val_accuracy30: 0.4844 - 463s/epoch - 47ms/step
Epoch 28/50
9913/9913 - 463s - loss: 2.6232 - accuracy30: 0.5754 - val_loss: 3.3459 - val_accuracy30: 0.4852 - 463s/epoch - 47ms/step
Epoch 29/50
9913/9913 - 462s - loss: 2.6216 - accuracy30: 0.5757 - val_loss: 3.3471 - val_accuracy30: 0.4833 - 462s/epoch - 47ms/step
Epoch 30/50
9913/9913 - 462s - loss: 2.6202 - accuracy30: 0.5760 - val_loss: 3.3460 - val_accuracy30: 0.4837 - 462s/epoch - 47ms/step
Epoch 31/50
9913/9913 - 462s - loss: 2.6187 - accuracy30: 0.5768 - val_loss: 3.3689 - val_accuracy30: 0.4843 - 462s/epoch - 47ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 877s - 877s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2389345
{'0': {'precision': 0.5097553667237685, 'recall': 0.2030082433541166, 'f1-score': 0.29037549076787966, 'support': 4441396}, '1': {'precision': 0.3673716303307653, 'recall': 0.6536959062600158, 'f1-score': 0.4703887298681892, 'support': 3859527}, '2': {'precision': 0.4478315615322393, 'recall': 0.41472534902725483, 'f1-score': 0.43064312253068, 'support': 4537468}, 'accuracy': 0.41332282215115584, 'macro avg': {'precision': 0.4416528528622577, 'recall': 0.4238098328804624, 'f1-score': 0.39713578105558295, 'support': 12838391}, 'weighted avg': {'precision': 0.4450657058881953, 'recall': 0.41332282215115584, 'f1-score': 0.39406650993255465, 'support': 12838391}}
[[ 901640 2169938 1369818]
 [ 386158 2522957  950412]
 [ 480972 2174693 1881803]]
Evaluating performance on  train set...
9913/9913 - 180s - 180s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0025032
{'0': {'precision': 0.5096589051948124, 'recall': 0.3790996638814753, 'f1-score': 0.4347896636414192, 'support': 728017}, '1': {'precision': 0.5732176539622037, 'recall': 0.6488669741108557, 'f1-score': 0.6087008969580836, 'support': 1080955}, '2': {'precision': 0.44478300297966056, 'recall': 0.471564882612858, 'f1-score': 0.457782569013461, 'support': 728061}, 'accuracy': 0.5205746239800586, 'macro avg': {'precision': 0.5092198540455589, 'recall': 0.4998438402017297, 'f1-score': 0.5004243765376546, 'support': 2537033}, 'weighted avg': {'precision': 0.5181217564983587, 'recall': 0.5205746239800586, 'f1-score': 0.5154864676987132, 'support': 2537033}}
[[275991 265124 186902]
 [137889 701396 241670]
 [127641 257092 343328]]
Evaluating performance on  val set...
3496/3496 - 62s - 62s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0555646
{'0': {'precision': 0.5005047265538743, 'recall': 0.3421091405674447, 'f1-score': 0.4064192355064498, 'support': 278265}, '1': {'precision': 0.516951306480707, 'recall': 0.6223290328521904, 'f1-score': 0.5647667136645109, 'support': 336629}, '2': {'precision': 0.4378246666309645, 'recall': 0.46830036695605476, 'f1-score': 0.45255002222825735, 'support': 279325}, 'accuracy': 0.4870160441681512, 'macro avg': {'precision': 0.48509356655518193, 'recall': 0.47757951345856325, 'f1-score': 0.47457865713307273, 'support': 894219}, 'weighted avg': {'precision': 0.48711682942377865, 'recall': 0.4870160441681512, 'f1-score': 0.48043895016912064, 'support': 894219}}
[[ 95197  96085  86983]
 [ 46158 209494  80977]
 [ 48847  99670 130808]]
testing model out of sample: results/universal/W5/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 369s - 369s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1213361
{'0': {'precision': 0.5084078029470258, 'recall': 0.28128646275223257, 'f1-score': 0.36218632637523857, 'support': 1714935}, '1': {'precision': 0.49039586863361945, 'recall': 0.6925822492293154, 'f1-score': 0.5742109149484508, 'support': 1923939}, '2': {'precision': 0.46706527403662457, 'recall': 0.4596601109960993, 'f1-score': 0.46333310638408237, 'support': 1709970}, 'accuracy': 0.48625067397740523, 'macro avg': {'precision': 0.48862298187242326, 'recall': 0.4778429409925491, 'f1-score': 0.4665767825692573, 'support': 5348844}, 'weighted avg': {'precision': 0.488712267415999, 'recall': 0.48625067397740523, 'f1-score': 0.4707855553538141, 'support': 5348844}}
[[ 482388  726507  506040]
 [ 200639 1332486  390814]
 [ 265794  658171  786005]]
Evaluating performance on  train set...
4957/4957 - 92s - 92s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9982562
{'0': {'precision': 0.5154887107148857, 'recall': 0.3501476330018896, 'f1-score': 0.4170276657308864, 'support': 359337}, '1': {'precision': 0.5896433744568204, 'recall': 0.6887480970309124, 'f1-score': 0.6353542887944988, 'support': 548485}, '2': {'precision': 0.4676882408607084, 'recall': 0.4976145699846334, 'f1-score': 0.48218751721848696, 'support': 360522}, 'accuracy': 0.5384895580378825, 'macro avg': {'precision': 0.5242734420108047, 'recall': 0.5121701000058119, 'f1-score': 0.5115231572479574, 'support': 1268344}, 'weighted avg': {'precision': 0.533969185846023, 'recall': 0.5384895580378825, 'f1-score': 0.5299626721873826, 'support': 1268344}}
[[125821 138167  95349]
 [ 61876 377768 108841]
 [ 56384 124737 179401]]
Evaluating performance on  val set...
1701/1701 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0045664
{'0': {'precision': 0.5225088257273173, 'recall': 0.32151776299620244, 'f1-score': 0.3980819349487355, 'support': 126133}, '1': {'precision': 0.5781961117979943, 'recall': 0.7124432116023065, 'f1-score': 0.6383377406168893, 'support': 183136}, '2': {'precision': 0.4700495443888893, 'recall': 0.49246043417088625, 'f1-score': 0.48099408394279597, 'support': 125803}, 'accuracy': 0.5354998712856722, 'macro avg': {'precision': 0.5235848273047335, 'recall': 0.5088071362564651, 'f1-score': 0.5058045865028069, 'support': 435072}, 'weighted avg': {'precision': 0.5307805873015423, 'recall': 0.5354998712856722, 'f1-score': 0.523187858351627, 'support': 435072}}
[[ 40554  50408  35171]
 [ 17985 130474  34677]
 [ 19075  44775  61953]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
1060/1060 - 26s - 26s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1902106
{'0': {'precision': 0.4722238712051955, 'recall': 0.37487982808347, 'f1-score': 0.417958754761592, 'support': 106098}, '1': {'precision': 0.31439197842020655, 'recall': 0.3561925047848367, 'f1-score': 0.3339894348360952, 'support': 64788}, '2': {'precision': 0.44256801329920575, 'recall': 0.5009857219666647, 'f1-score': 0.46996847635726796, 'support': 100434}, 'accuracy': 0.41709789178829426, 'macro avg': {'precision': 0.40972795430820264, 'recall': 0.4106860182783238, 'f1-score': 0.4073055553183184, 'support': 271320}, 'weighted avg': {'precision': 0.42355783441216865, 'recall': 0.41709789178829426, 'f1-score': 0.41716021458544217, 'support': 271320}}
[[39774 27493 38831]
 [17167 23077 24544]
 [27286 22832 50316]]
Evaluating performance on  train set...
273/273 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1895127
{'0': {'precision': 0.46835274542429284, 'recall': 0.3007522010428242, 'f1-score': 0.3662910236056529, 'support': 23398}, '1': {'precision': 0.42121382047189754, 'recall': 0.42883492161082076, 'f1-score': 0.42499020759890327, 'support': 22771}, '2': {'precision': 0.4220145577063666, 'recall': 0.5649787234042554, 'f1-score': 0.48314259201979587, 'support': 23500}, 'accuracy': 0.4317415206189266, 'macro avg': {'precision': 0.437193707867519, 'recall': 0.43152194868596677, 'f1-score': 0.42480794107478403, 'support': 69669}, 'weighted avg': {'precision': 0.43731529876276104, 'recall': 0.4317415206189266, 'f1-score': 0.42489170649822583, 'support': 69669}}
[[ 7037  7192  9169]
 [ 3991  9765  9015]
 [ 3997  6226 13277]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2150328
{'0': {'precision': 0.46569433032046015, 'recall': 0.2695600475624257, 'f1-score': 0.34146708841693024, 'support': 8410}, '1': {'precision': 0.4047874938935027, 'recall': 0.5196939287506271, 'f1-score': 0.455099686933597, 'support': 7972}, '2': {'precision': 0.42849542455841666, 'recall': 0.49599704397093236, 'f1-score': 0.4597819261289034, 'support': 8119}, 'accuracy': 0.4259826129545733, 'macro avg': {'precision': 0.4329924162574599, 'recall': 0.42841700676132843, 'f1-score': 0.41878290049314354, 'support': 24501}, 'weighted avg': {'precision': 0.4335500416841704, 'recall': 0.4259826129545733, 'f1-score': 0.41764672364644645, 'support': 24501}}
[[2267 3248 2895]
 [1353 4143 2476]
 [1248 2844 4027]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87440646
{'0': {'precision': 0.5428845704158616, 'recall': 0.37389174252826796, 'f1-score': 0.4428126145027631, 'support': 117978}, '1': {'precision': 0.756224126242301, 'recall': 0.6498754214597382, 'f1-score': 0.6990279935199568, 'support': 322688}, '2': {'precision': 0.3864536868598769, 'recall': 0.6541251898093471, 'f1-score': 0.4858624308786441, 'support': 118540}, 'accuracy': 0.5925508667646627, 'macro avg': {'precision': 0.5618541278393465, 'recall': 0.5592974512657843, 'f1-score': 0.542567679633788, 'support': 559206}, 'weighted avg': {'precision': 0.6328313836721493, 'recall': 0.5925508667646627, 'f1-score': 0.5997865265450107, 'support': 559206}}
[[ 44111  39217  34650]
 [ 24526 209707  88455]
 [ 12616  28384  77540]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70561373
{'0': {'precision': 0.501771760857714, 'recall': 0.545836422041018, 'f1-score': 0.5228773640731887, 'support': 20235}, '1': {'precision': 0.8798748360674596, 'recall': 0.6972995642105647, 'f1-score': 0.7780196529204728, 'support': 109686}, '2': {'precision': 0.3452446530788207, 'recall': 0.6940298507462687, 'f1-score': 0.46111031140540276, 'support': 20770}, 'accuracy': 0.6765102096342848, 'macro avg': {'precision': 0.5756304166679981, 'recall': 0.6457219456659504, 'f1-score': 0.5873357761330215, 'support': 150691}, 'weighted avg': {'precision': 0.7554136232044272, 'recall': 0.6765102096342848, 'f1-score': 0.7000786263290188, 'support': 150691}}
[[11045  5747  3443]
 [ 9307 76484 23895]
 [ 1660  4695 14415]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7657411
{'0': {'precision': 0.44118155121782693, 'recall': 0.5654821211114801, 'f1-score': 0.49565765853185195, 'support': 9033}, '1': {'precision': 0.8435160276148187, 'recall': 0.6824976397776146, 'f1-score': 0.7545118504022614, 'support': 38132}, '2': {'precision': 0.4239994372933812, 'recall': 0.6356638194664136, 'f1-score': 0.508691983122363, 'support': 9483}, 'accuracy': 0.6559984465470978, 'macro avg': {'precision': 0.5695656720420089, 'recall': 0.6278811934518361, 'f1-score': 0.5862871640188255, 'support': 56648}, 'weighted avg': {'precision': 0.7091324103412658, 'recall': 0.6559984465470978, 'f1-score': 0.6720845852458448, 'support': 56648}}
[[ 5108  2412  1513]
 [ 5431 26025  6676]
 [ 1039  2416  6028]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
2341/2341 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2441846
{'0': {'precision': 0.4765984545591817, 'recall': 0.33910695684263137, 'f1-score': 0.39626524307033917, 'support': 214077}, '1': {'precision': 0.3635162110674603, 'recall': 0.46515235457063714, 'f1-score': 0.40810144975735047, 'support': 171475}, '2': {'precision': 0.4448331326413121, 'recall': 0.4735859561785609, 'f1-score': 0.45875946401013423, 'support': 213731}, 'accuracy': 0.4231339784375662, 'macro avg': {'precision': 0.42831593275598473, 'recall': 0.4259484225306098, 'f1-score': 0.4210420522792746, 'support': 599283}, 'weighted avg': {'precision': 0.43291289744915007, 'recall': 0.4231339784375662, 'f1-score': 0.4219402011074245, 'support': 599283}}
[[ 72595  72849  68633]
 [ 34020  79762  57693]
 [ 45704  66807 101220]]
Evaluating performance on  train set...
483/483 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2006842
{'0': {'precision': 0.48454598613315514, 'recall': 0.2837540358086293, 'f1-score': 0.35791194890938827, 'support': 40884}, '1': {'precision': 0.4307263252178161, 'recall': 0.5109018471568272, 'f1-score': 0.467400788610433, 'support': 41415}, '2': {'precision': 0.42743822631182327, 'recall': 0.523244240526303, 'f1-score': 0.4705137580632838, 'support': 41193}, 'accuracy': 0.439817963916691, 'macro avg': {'precision': 0.4475701792209315, 'recall': 0.4393000411639198, 'f1-score': 0.4319421651943684, 'support': 123492}, 'weighted avg': {'precision': 0.44744737887820024, 'recall': 0.439817963916691, 'f1-score': 0.43219114610997766, 'support': 123492}}
[[11601 14830 14453]
 [ 5837 21159 14419]
 [ 6504 13135 21554]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1905353
{'0': {'precision': 0.4781505186493048, 'recall': 0.30239374694675136, 'f1-score': 0.37048437433200804, 'support': 14329}, '1': {'precision': 0.4128574920557321, 'recall': 0.42519090375094404, 'f1-score': 0.41893344357172385, 'support': 11917}, '2': {'precision': 0.45167100260156096, 'recall': 0.5987928633017179, 'f1-score': 0.5149294167973764, 'support': 15077}, 'accuracy': 0.445950197226726, 'macro avg': {'precision': 0.44755967110219924, 'recall': 0.44212583799980437, 'f1-score': 0.43478241156703606, 'support': 41323}, 'weighted avg': {'precision': 0.44965963799283165, 'recall': 0.445950197226726, 'f1-score': 0.437158271759108, 'support': 41323}}
[[4333 3745 6251]
 [2141 5067 4709]
 [2588 3461 9028]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2966553
{'0': {'precision': 0.4074516374714395, 'recall': 0.3526480375044165, 'f1-score': 0.37807415280588885, 'support': 189631}, '1': {'precision': 0.30876230338615807, 'recall': 0.2769868648003184, 'f1-score': 0.29201271475380025, 'support': 150740}, '2': {'precision': 0.37761530577382985, 'recall': 0.4643877516722127, 'f1-score': 0.4165303707500169, 'support': 178506}, 'accuracy': 0.3691086712265142, 'macro avg': {'precision': 0.3646097488771425, 'recall': 0.36467421799231586, 'f1-score': 0.36220574610323536, 'support': 518877}, 'weighted avg': {'precision': 0.3685167946357986, 'recall': 0.3691086712265142, 'f1-score': 0.3663021229575099, 'support': 518877}}
[[66873 49124 73634]
 [45992 41753 62995]
 [51260 44350 82896]]
Evaluating performance on  train set...
331/331 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2998755
{'0': {'precision': 0.3754610755193166, 'recall': 0.41029630153454494, 'f1-score': 0.39210650807596137, 'support': 28282}, '1': {'precision': 0.330360074422677, 'recall': 0.21571500035732152, 'f1-score': 0.2610030263726762, 'support': 27986}, '2': {'precision': 0.3784816576086957, 'recall': 0.47347733711048157, 'f1-score': 0.420683362698213, 'support': 28240}, 'accuracy': 0.36697117432669096, 'macro avg': {'precision': 0.3614342691835631, 'recall': 0.36649621300078267, 'f1-score': 0.35793096571561683, 'support': 84508}, 'weighted avg': {'precision': 0.3615346380401846, 'recall': 0.36697117432669096, 'f1-score': 0.358239280542287, 'support': 84508}}
[[11604  6365 10313]
 [10305  6037 11644]
 [ 8997  5872 13371]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3222578
{'0': {'precision': 0.40909525174357503, 'recall': 0.34321898044244953, 'f1-score': 0.37327289369306543, 'support': 12476}, '1': {'precision': 0.2825520833333333, 'recall': 0.23233404710920771, 'f1-score': 0.2549941245593419, 'support': 10274}, '2': {'precision': 0.38214059531348954, 'recall': 0.5047260560434964, 'f1-score': 0.43496125428005045, 'support': 11955}, 'accuracy': 0.36602794986313214, 'macro avg': {'precision': 0.3579293101301326, 'recall': 0.3600930278650512, 'f1-score': 0.35440942417748594, 'support': 34705}, 'weighted avg': {'precision': 0.3623484593543373, 'recall': 0.36602794986313214, 'f1-score': 0.35950796866029006, 'support': 34705}}
[[4282 3175 5019]
 [3150 2387 4737]
 [3035 2886 6034]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
2900/2900 - 52s - 52s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2886678
{'0': {'precision': 0.43391818703671353, 'recall': 0.3315635500936383, 'f1-score': 0.3758978106608665, 'support': 262179}, '1': {'precision': 0.3223319448638977, 'recall': 0.2617509601591782, 'f1-score': 0.2888997275301773, 'support': 216110}, '2': {'precision': 0.4089215071071945, 'recall': 0.5675865020127315, 'f1-score': 0.47536390003790047, 'support': 264069}, 'accuracy': 0.39519746537384925, 'macro avg': {'precision': 0.3883905463359352, 'recall': 0.38696700408851603, 'f1-score': 0.3800538127429814, 'support': 742358}, 'weighted avg': {'precision': 0.3925422591578796, 'recall': 0.39519746537384925, 'f1-score': 0.3859532758277142, 'support': 742358}}
[[ 86929  62357 112893]
 [ 55788  56567 103755]
 [ 57618  56569 149882]]
Evaluating performance on  train set...
694/694 - 28s - 28s/epoch - 40ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2469678
{'0': {'precision': 0.4292232833289588, 'recall': 0.35630007039184797, 'f1-score': 0.38937680296716887, 'support': 59666}, '1': {'precision': 0.3959660847191283, 'recall': 0.3887099508391253, 'f1-score': 0.3923044679595206, 'support': 58990}, '2': {'precision': 0.4099823271193204, 'recall': 0.4880059715671971, 'f1-score': 0.445604523274727, 'support': 58946}, 'accuracy': 0.4107780317789214, 'macro avg': {'precision': 0.4117238983891358, 'recall': 0.41100533093272346, 'f1-score': 0.4090952647338055, 'support': 177602}, 'weighted avg': {'precision': 0.4117909371238077, 'recall': 0.4107780317789214, 'f1-score': 0.40901116608891386, 'support': 177602}}
[[21259 18571 19836]
 [14498 22930 21562]
 [13772 16408 28766]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2578629
{'0': {'precision': 0.4360449192002191, 'recall': 0.32045088566827695, 'f1-score': 0.3694164056155006, 'support': 19872}, '1': {'precision': 0.41548211063679974, 'recall': 0.44353095931598235, 'f1-score': 0.4290486036946989, 'support': 21286}, '2': {'precision': 0.40509770603228545, 'recall': 0.483839870110102, 'f1-score': 0.4409812943651876, 'support': 19709}, 'accuracy': 0.4163996911298405, 'macro avg': {'precision': 0.4188749119564347, 'recall': 0.4159405716981204, 'f1-score': 0.4131487678917957, 'support': 60867}, 'weighted avg': {'precision': 0.41883298880431086, 'recall': 0.4163996911298405, 'f1-score': 0.4134436019728272, 'support': 60867}}
[[6368 6968 6536]
 [4377 9441 7468]
 [3859 6314 9536]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
7167/7167 - 130s - 130s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79349345
{'0': {'precision': 0.5832550459760298, 'recall': 0.38907206559229374, 'f1-score': 0.4667734609168642, 'support': 421269}, '1': {'precision': 0.7094505697352349, 'recall': 0.7610177196775302, 'f1-score': 0.7343299528335223, 'support': 989860}, '2': {'precision': 0.503076791677004, 'recall': 0.584226411173195, 'f1-score': 0.5406233473340997, 'support': 423442}, 'accuracy': 0.6348029048753088, 'macro avg': {'precision': 0.5985941357960897, 'recall': 0.5781053988143396, 'f1-score': 0.5805755870281621, 'support': 1834571}, 'weighted avg': {'precision': 0.6328388782678291, 'recall': 0.6348029048753088, 'f1-score': 0.6281815572472381, 'support': 1834571}}
[[163904 179179  78186]
 [ 70385 753301 166174]
 [ 46727 129329 247386]]
Evaluating performance on  train set...
1570/1570 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75748974
{'0': {'precision': 0.5435534097077394, 'recall': 0.47115634634671816, 'f1-score': 0.5047722011819405, 'support': 80763}, '1': {'precision': 0.7893366443972906, 'recall': 0.7097709529324524, 'f1-score': 0.7474423093796613, 'support': 240038}, '2': {'precision': 0.4509499270614841, 'recall': 0.6457885238201192, 'f1-score': 0.5310624196311036, 'support': 80898}, 'accuracy': 0.6489112494678851, 'macro avg': {'precision': 0.5946133270555046, 'recall': 0.6089052743664299, 'f1-score': 0.5944256433975684, 'support': 401699}, 'weighted avg': {'precision': 0.6717734937739027, 'recall': 0.6489112494678851, 'f1-score': 0.655075969734177, 'support': 401699}}
[[ 38052  26469  16242]
 [ 22300 170372  47366]
 [  9654  19001  52243]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80916667
{'0': {'precision': 0.5363216935046137, 'recall': 0.42183719937384373, 'f1-score': 0.4722399235303488, 'support': 28108}, '1': {'precision': 0.7842820730671198, 'recall': 0.6621856214401515, 'f1-score': 0.7180807617210291, 'support': 69701}, '2': {'precision': 0.4301661010894803, 'recall': 0.6895959342901113, 'f1-score': 0.5298282760232632, 'support': 27941}, 'accuracy': 0.6145526838966203, 'macro avg': {'precision': 0.5835899558870712, 'recall': 0.5912062517013689, 'f1-score': 0.5733829870915471, 'support': 125750}, 'weighted avg': {'precision': 0.6501745206077152, 'recall': 0.6145526838966203, 'f1-score': 0.6213009845222622, 'support': 125750}}
[[11857  7998  8253]
 [ 6275 46155 17271]
 [ 3976  4697 19268]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
6357/6357 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9397066
{'0': {'precision': 0.5602773728860075, 'recall': 0.2313290206911139, 'f1-score': 0.32745671848210817, 'support': 397127}, '1': {'precision': 0.6008381731838425, 'recall': 0.8868065840648292, 'f1-score': 0.7163366729061772, 'support': 830490}, '2': {'precision': 0.505704575031271, 'recall': 0.30052408697741473, 'f1-score': 0.3770057127786334, 'support': 399552}, 'accuracy': 0.582868773925757, 'macro avg': {'precision': 0.555606707033707, 'recall': 0.4728865639111192, 'f1-score': 0.47359970138897295, 'support': 1627169}, 'weighted avg': {'precision': 0.5675788077774621, 'recall': 0.582868773925757, 'f1-score': 0.5381037459997234, 'support': 1627169}}
[[ 91867 246237  59023]
 [ 35663 736484  58343]
 [ 36437 243040 120075]]
Evaluating performance on  train set...
1701/1701 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84251916
{'0': {'precision': 0.5659811925183424, 'recall': 0.3700568516355704, 'f1-score': 0.44751432806900815, 'support': 103603}, '1': {'precision': 0.6608679453468127, 'recall': 0.8154248053997427, 'f1-score': 0.7300558990848379, 'support': 226233}, '2': {'precision': 0.5200763522595073, 'recall': 0.43611600462199995, 'f1-score': 0.47441002683920686, 'support': 105582}, 'accuracy': 0.6174779177709695, 'macro avg': {'precision': 0.5823084967082208, 'recall': 0.5405325538857709, 'f1-score': 0.550660084664351, 'support': 435418}, 'weighted avg': {'precision': 0.6041509280562278, 'recall': 0.6174779177709695, 'f1-score': 0.600838097190127, 'support': 435418}}
[[ 38339  47307  17957]
 [ 17223 184476  24534]
 [ 12177  47359  46046]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8864909
{'0': {'precision': 0.6023956194387405, 'recall': 0.25233671655484835, 'f1-score': 0.3556821855803427, 'support': 34878}, '1': {'precision': 0.6258542698807449, 'recall': 0.8596153846153847, 'f1-score': 0.7243419039740728, 'support': 74360}, '2': {'precision': 0.5036426871682226, 'recall': 0.3950776830073806, 'f1-score': 0.442802883996395, 'support': 34821}, 'accuracy': 0.600302653773801, 'macro avg': {'precision': 0.5772975254959026, 'recall': 0.5023432613925379, 'f1-score': 0.5076089911836035, 'support': 144059}, 'weighted avg': {'precision': 0.5906345312198562, 'recall': 0.600302653773801, 'f1-score': 0.5670342461895593, 'support': 144059}}
[[ 8801 19996  6081]
 [ 2962 63921  7477]
 [ 2847 18217 13757]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
7459/7459 - 133s - 133s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0978091
{'0': {'precision': 0.5498038161969624, 'recall': 0.2628456805575684, 'f1-score': 0.35566024176125377, 'support': 607208}, '1': {'precision': 0.45297726694013496, 'recall': 0.7328719442243415, 'f1-score': 0.5598929900806767, 'support': 665093}, '2': {'precision': 0.4980070288151952, 'recall': 0.4244791584896774, 'f1-score': 0.45831278001250997, 'support': 636950}, 'accuracy': 0.4805036111019452, 'macro avg': {'precision': 0.5002627039840976, 'recall': 0.4733989277571958, 'f1-score': 0.4579553372848135, 'support': 1909251}, 'weighted avg': {'precision': 0.49879395743680577, 'recall': 0.4805036111019452, 'f1-score': 0.4610514687487727, 'support': 1909251}}
[[159602 300305 147301]
 [ 52430 487428 125235]
 [ 78257 288321 270372]]
Evaluating performance on  train set...
1664/1664 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8419365
{'0': {'precision': 0.5644018398552426, 'recall': 0.39413347737598026, 'f1-score': 0.46414494235247344, 'support': 103673}, '1': {'precision': 0.6855282778384052, 'recall': 0.7542516967833296, 'f1-score': 0.7182498379843286, 'support': 218207}, '2': {'precision': 0.4934704451728878, 'recall': 0.5380417551377267, 'f1-score': 0.514793144180873, 'support': 104083}, 'accuracy': 0.6137739662834566, 'macro avg': {'precision': 0.5811335209555119, 'recall': 0.5621423097656789, 'f1-score': 0.5657293081725583, 'support': 425963}, 'weighted avg': {'precision': 0.6091190671737384, 'recall': 0.6137739662834566, 'f1-score': 0.6066903835106152, 'support': 425963}}
[[ 40861  41096  21716]
 [ 17857 164583  35767]
 [ 13679  34403  56001]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88882554
{'0': {'precision': 0.5436317910910532, 'recall': 0.4236127889184183, 'f1-score': 0.47617610670207305, 'support': 37251}, '1': {'precision': 0.6480546673375643, 'recall': 0.695780980429744, 'f1-score': 0.6710703240553987, 'support': 57383}, '2': {'precision': 0.5026239768897448, 'recall': 0.556150444835118, 'f1-score': 0.5280341923573, 'support': 37542}, 'accuracy': 0.5794168381551871, 'macro avg': {'precision': 0.5647701451061208, 'recall': 0.5585147380610934, 'f1-score': 0.5584268743715906, 'support': 132176}, 'weighted avg': {'precision': 0.5773185613587873, 'recall': 0.5794168381551871, 'f1-score': 0.5755169183929579, 'support': 132176}}
[[15780 11636  9835]
 [ 6631 39926 10826]
 [ 6616 10047 20879]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
8238/8238 - 146s - 146s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1586385
{'0': {'precision': 0.5489660195984526, 'recall': 0.2602814044114248, 'f1-score': 0.3531321628364948, 'support': 735454}, '1': {'precision': 0.4267825712832949, 'recall': 0.6808272342124803, 'f1-score': 0.5246706848840816, 'support': 641076}, '2': {'precision': 0.4945852145502778, 'recall': 0.49806332834369504, 'f1-score': 0.4963181780135922, 'support': 732184}, 'accuracy': 0.4706949353966446, 'macro avg': {'precision': 0.4901112684773417, 'recall': 0.47972398898920005, 'f1-score': 0.4580403419113895, 'support': 2108714}, 'weighted avg': {'precision': 0.49293868176341155, 'recall': 0.4706949353966446, 'f1-score': 0.4549988640091558, 'support': 2108714}}
[[191425 317788 226241]
 [ 58196 436462 146418]
 [ 99080 268430 364674]]
Evaluating performance on  train set...
1806/1806 - 39s - 39s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9667419
{'0': {'precision': 0.5402382302892796, 'recall': 0.36135856616029016, 'f1-score': 0.4330532518550851, 'support': 131786}, '1': {'precision': 0.6030858328291123, 'recall': 0.7009483815226346, 'f1-score': 0.6483450108721914, 'support': 199076}, '2': {'precision': 0.48607965898494737, 'recall': 0.5280310127112513, 'f1-score': 0.5061876218359167, 'support': 131301}, 'accuracy': 0.5549881751676357, 'macro avg': {'precision': 0.5431345740344465, 'recall': 0.5301126534647254, 'f1-score': 0.5291952948543978, 'support': 462163}, 'weighted avg': {'precision': 0.5519232305000054, 'recall': 0.5549881751676357, 'f1-score': 0.5465673975806032, 'support': 462163}}
[[ 47622  50212  33952]
 [ 20184 139542  39350]
 [ 20344  41626  69331]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93513334
{'0': {'precision': 0.5450580127366309, 'recall': 0.38533015377024915, 'f1-score': 0.4514831452555008, 'support': 48644}, '1': {'precision': 0.6115580910474679, 'recall': 0.7072528512891821, 'f1-score': 0.6559335985731924, 'support': 67601}, '2': {'precision': 0.49656065231672913, 'recall': 0.5345383447386484, 'f1-score': 0.5148500966633611, 'support': 48077}, 'accuracy': 0.5614220859045046, 'macro avg': {'precision': 0.551058918700276, 'recall': 0.5423737832660266, 'f1-score': 0.5407556134973515, 'support': 164322}, 'weighted avg': {'precision': 0.5582264515152685, 'recall': 0.5614220859045046, 'f1-score': 0.5541325045474093, 'support': 164322}}
[[18744 16386 13514]
 [ 7249 47811 12541]
 [ 8396 13982 25699]]
testing model on single stock: results/universal/W5/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
31315/31315 - 552s - 552s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.396231
{'0': {'precision': 0.49019881709499363, 'recall': 0.15031768164853107, 'f1-score': 0.23008166027609822, 'support': 3105310}, '1': {'precision': 0.2387647405339405, 'recall': 0.5954026985592203, 'f1-score': 0.34084564842100845, 'support': 1731146}, '2': {'precision': 0.43814378391245906, 'recall': 0.37852661767341816, 'f1-score': 0.4061591659424827, 'support': 3180030}, 'accuracy': 0.33696035894031373, 'macro avg': {'precision': 0.3890357805137978, 'recall': 0.3747489992937232, 'f1-score': 0.3256954915465298, 'support': 8016486}, 'weighted avg': {'precision': 0.41525255472095396, 'recall': 0.33696035894031373, 'f1-score': 0.3238484784761651, 'support': 8016486}}
[[ 466783 1602207 1036320]
 [ 193132 1030729  507285]
 [ 292317 1683987 1203726]]
Evaluating performance on  train set...
5759/5759 - 103s - 103s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1291001
{'0': {'precision': 0.5037010264565563, 'recall': 0.35188379684242843, 'f1-score': 0.41432298665499684, 'support': 495064}, '1': {'precision': 0.4284795536171234, 'recall': 0.5851520911763615, 'f1-score': 0.49470773355039827, 'support': 485038}, '2': {'precision': 0.44491351723753086, 'recall': 0.41957414941202664, 'f1-score': 0.43187246679951374, 'support': 494070}, 'accuracy': 0.4513211484141606, 'macro avg': {'precision': 0.45903136577040354, 'recall': 0.45220334581027216, 'f1-score': 0.4469677290016363, 'support': 1474172}, 'weighted avg': {'precision': 0.4592486712205753, 'recall': 0.4513211484141606, 'f1-score': 0.44665322255667805, 'support': 1474172}}
[[174205 185414 135445]
 [ 78030 283821 123187]
 [ 93615 193156 207299]]
Evaluating performance on  val set...
2129/2129 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1662852
{'0': {'precision': 0.49644423625601497, 'recall': 0.3045502280600009, 'f1-score': 0.3775112366099763, 'support': 191397}, '1': {'precision': 0.38679399148630794, 'recall': 0.5886967152582553, 'f1-score': 0.4668508899065186, 'support': 161139}, '2': {'precision': 0.430815315488306, 'recall': 0.40813080809130786, 'f1-score': 0.41916637530459566, 'support': 192404}, 'accuracy': 0.4251440525562447, 'macro avg': {'precision': 0.43801784774354297, 'recall': 0.43379258380318797, 'f1-score': 0.42117616727369683, 'support': 544940}, 'weighted avg': {'precision': 0.44084876214265184, 'recall': 0.4251440525562447, 'f1-score': 0.4186363470770939, 'support': 544940}}
[[58290 70739 62368]
 [24898 94862 41379]
 [34227 79651 78526]]
training model: results/universal/W5/deepOF_L2/h10
Epoch 1/50
9913/9913 - 277s - loss: 2.6290 - accuracy10: 0.5682 - val_loss: 3.0713 - val_accuracy10: 0.5657 - 277s/epoch - 28ms/step
Epoch 2/50
9913/9913 - 230s - loss: 2.5404 - accuracy10: 0.5885 - val_loss: 2.9605 - val_accuracy10: 0.5727 - 230s/epoch - 23ms/step
Epoch 3/50
9913/9913 - 227s - loss: 2.5163 - accuracy10: 0.5931 - val_loss: 2.9512 - val_accuracy10: 0.5736 - 227s/epoch - 23ms/step
Epoch 4/50
9913/9913 - 225s - loss: 2.5014 - accuracy10: 0.5955 - val_loss: 2.9168 - val_accuracy10: 0.5727 - 225s/epoch - 23ms/step
Epoch 5/50
9913/9913 - 230s - loss: 2.4903 - accuracy10: 0.5973 - val_loss: 2.9077 - val_accuracy10: 0.5766 - 230s/epoch - 23ms/step
Epoch 6/50
9913/9913 - 226s - loss: 2.4815 - accuracy10: 0.5988 - val_loss: 2.8971 - val_accuracy10: 0.5788 - 226s/epoch - 23ms/step
Epoch 7/50
9913/9913 - 224s - loss: 2.4738 - accuracy10: 0.6001 - val_loss: 2.8872 - val_accuracy10: 0.5796 - 224s/epoch - 23ms/step
Epoch 8/50
9913/9913 - 223s - loss: 2.4674 - accuracy10: 0.6012 - val_loss: 2.8743 - val_accuracy10: 0.5782 - 223s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 224s - loss: 2.4616 - accuracy10: 0.6020 - val_loss: 2.8678 - val_accuracy10: 0.5812 - 224s/epoch - 23ms/step
Epoch 10/50
9913/9913 - 226s - loss: 2.4567 - accuracy10: 0.6026 - val_loss: 2.8605 - val_accuracy10: 0.5808 - 226s/epoch - 23ms/step
Epoch 11/50
9913/9913 - 224s - loss: 2.4515 - accuracy10: 0.6035 - val_loss: 2.8536 - val_accuracy10: 0.5815 - 224s/epoch - 23ms/step
Epoch 12/50
9913/9913 - 230s - loss: 2.4472 - accuracy10: 0.6044 - val_loss: 2.8382 - val_accuracy10: 0.5797 - 230s/epoch - 23ms/step
Epoch 13/50
9913/9913 - 225s - loss: 2.4435 - accuracy10: 0.6050 - val_loss: 2.8386 - val_accuracy10: 0.5818 - 225s/epoch - 23ms/step
Epoch 14/50
9913/9913 - 224s - loss: 2.4397 - accuracy10: 0.6058 - val_loss: 2.8345 - val_accuracy10: 0.5807 - 224s/epoch - 23ms/step
Epoch 15/50
9913/9913 - 224s - loss: 2.4359 - accuracy10: 0.6063 - val_loss: 2.8468 - val_accuracy10: 0.5825 - 224s/epoch - 23ms/step
Epoch 16/50
9913/9913 - 236s - loss: 2.4327 - accuracy10: 0.6069 - val_loss: 2.8233 - val_accuracy10: 0.5804 - 236s/epoch - 24ms/step
Epoch 17/50
9913/9913 - 227s - loss: 2.4298 - accuracy10: 0.6074 - val_loss: 2.8415 - val_accuracy10: 0.5819 - 227s/epoch - 23ms/step
Epoch 18/50
9913/9913 - 226s - loss: 2.4276 - accuracy10: 0.6077 - val_loss: 2.8442 - val_accuracy10: 0.5828 - 226s/epoch - 23ms/step
Epoch 19/50
9913/9913 - 225s - loss: 2.4270 - accuracy10: 0.6082 - val_loss: 2.8520 - val_accuracy10: 0.5846 - 225s/epoch - 23ms/step
Epoch 20/50
9913/9913 - 227s - loss: 2.4239 - accuracy10: 0.6086 - val_loss: 2.8560 - val_accuracy10: 0.5825 - 227s/epoch - 23ms/step
Epoch 21/50
9913/9913 - 225s - loss: 2.4208 - accuracy10: 0.6090 - val_loss: 2.8330 - val_accuracy10: 0.5822 - 225s/epoch - 23ms/step
Epoch 22/50
9913/9913 - 225s - loss: 2.4173 - accuracy10: 0.6096 - val_loss: 2.8360 - val_accuracy10: 0.5827 - 225s/epoch - 23ms/step
Epoch 23/50
9913/9913 - 224s - loss: 2.4149 - accuracy10: 0.6099 - val_loss: 2.8459 - val_accuracy10: 0.5844 - 224s/epoch - 23ms/step
Epoch 24/50
9913/9913 - 228s - loss: 2.4345 - accuracy10: 0.6089 - val_loss: 2.9384 - val_accuracy10: 0.5803 - 228s/epoch - 23ms/step
Epoch 25/50
9913/9913 - 395s - loss: 2.4562 - accuracy10: 0.6033 - val_loss: 2.8190 - val_accuracy10: 0.5837 - 395s/epoch - 40ms/step
Epoch 26/50
9913/9913 - 228s - loss: 2.4325 - accuracy10: 0.6070 - val_loss: 2.8295 - val_accuracy10: 0.5849 - 228s/epoch - 23ms/step
Epoch 27/50
9913/9913 - 228s - loss: 2.4252 - accuracy10: 0.6084 - val_loss: 2.8319 - val_accuracy10: 0.5828 - 228s/epoch - 23ms/step
Epoch 28/50
9913/9913 - 233s - loss: 2.4196 - accuracy10: 0.6094 - val_loss: 2.8366 - val_accuracy10: 0.5855 - 233s/epoch - 23ms/step
Epoch 29/50
9913/9913 - 226s - loss: 2.4168 - accuracy10: 0.6097 - val_loss: 2.8514 - val_accuracy10: 0.5848 - 226s/epoch - 23ms/step
Epoch 30/50
9913/9913 - 228s - loss: 2.4124 - accuracy10: 0.6105 - val_loss: 2.8282 - val_accuracy10: 0.5839 - 228s/epoch - 23ms/step
Epoch 31/50
9913/9913 - 276s - loss: 2.4092 - accuracy10: 0.6110 - val_loss: 2.8189 - val_accuracy10: 0.5839 - 276s/epoch - 28ms/step
Epoch 32/50
9913/9913 - 231s - loss: 2.4072 - accuracy10: 0.6113 - val_loss: 2.8191 - val_accuracy10: 0.5848 - 231s/epoch - 23ms/step
Epoch 33/50
9913/9913 - 233s - loss: 2.4052 - accuracy10: 0.6116 - val_loss: 2.8210 - val_accuracy10: 0.5851 - 233s/epoch - 24ms/step
Epoch 34/50
9913/9913 - 252s - loss: 2.4027 - accuracy10: 0.6120 - val_loss: 2.8230 - val_accuracy10: 0.5825 - 252s/epoch - 25ms/step
Epoch 35/50
9913/9913 - 256s - loss: 2.4005 - accuracy10: 0.6123 - val_loss: 2.8085 - val_accuracy10: 0.5824 - 256s/epoch - 26ms/step
Epoch 36/50
9913/9913 - 240s - loss: 2.3987 - accuracy10: 0.6126 - val_loss: 2.8112 - val_accuracy10: 0.5836 - 240s/epoch - 24ms/step
Epoch 37/50
9913/9913 - 250s - loss: 2.3969 - accuracy10: 0.6131 - val_loss: 2.8302 - val_accuracy10: 0.5832 - 250s/epoch - 25ms/step
Epoch 38/50
9913/9913 - 318s - loss: 2.3951 - accuracy10: 0.6134 - val_loss: 2.8081 - val_accuracy10: 0.5845 - 318s/epoch - 32ms/step
Epoch 39/50
9913/9913 - 234s - loss: 2.3937 - accuracy10: 0.6136 - val_loss: 2.8081 - val_accuracy10: 0.5834 - 234s/epoch - 24ms/step
Epoch 40/50
9913/9913 - 235s - loss: 2.3917 - accuracy10: 0.6141 - val_loss: 2.8110 - val_accuracy10: 0.5825 - 235s/epoch - 24ms/step
Epoch 41/50
9913/9913 - 229s - loss: 2.3901 - accuracy10: 0.6143 - val_loss: 2.8183 - val_accuracy10: 0.5831 - 229s/epoch - 23ms/step
Epoch 42/50
9913/9913 - 238s - loss: 2.3887 - accuracy10: 0.6145 - val_loss: 2.8141 - val_accuracy10: 0.5847 - 238s/epoch - 24ms/step
Epoch 43/50
9913/9913 - 231s - loss: 2.3876 - accuracy10: 0.6146 - val_loss: 2.8119 - val_accuracy10: 0.5824 - 231s/epoch - 23ms/step
Epoch 44/50
9913/9913 - 226s - loss: 2.3860 - accuracy10: 0.6151 - val_loss: 2.8156 - val_accuracy10: 0.5816 - 226s/epoch - 23ms/step
Epoch 45/50
9913/9913 - 223s - loss: 2.3845 - accuracy10: 0.6153 - val_loss: 2.8103 - val_accuracy10: 0.5815 - 223s/epoch - 22ms/step
Epoch 46/50
9913/9913 - 224s - loss: 2.3832 - accuracy10: 0.6153 - val_loss: 2.8178 - val_accuracy10: 0.5849 - 224s/epoch - 23ms/step
Epoch 47/50
9913/9913 - 223s - loss: 2.3820 - accuracy10: 0.6154 - val_loss: 2.8085 - val_accuracy10: 0.5815 - 223s/epoch - 23ms/step
Epoch 48/50
9913/9913 - 252s - loss: 2.3808 - accuracy10: 0.6157 - val_loss: 2.8062 - val_accuracy10: 0.5796 - 252s/epoch - 25ms/step
Epoch 49/50
9913/9913 - 226s - loss: 2.3794 - accuracy10: 0.6162 - val_loss: 2.8071 - val_accuracy10: 0.5806 - 226s/epoch - 23ms/step
Epoch 50/50
9913/9913 - 226s - loss: 2.3795 - accuracy10: 0.6162 - val_loss: 2.8177 - val_accuracy10: 0.5804 - 226s/epoch - 23ms/step
testing model in sample: results/universal/W5/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 411s - 411s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9294449
{'0': {'precision': 0.5203982058881275, 'recall': 0.47089543400145084, 'f1-score': 0.4944107964670549, 'support': 3782568}, '1': {'precision': 0.7672011090361126, 'recall': 0.4792434377864109, 'f1-score': 0.5899598147471629, 'support': 5223047}, '2': {'precision': 0.4541688140067847, 'recall': 0.72910632597839, 'f1-score': 0.55969629406496, 'support': 3832751}, 'accuracy': 0.5513776441643742, 'macro avg': {'precision': 0.5805893763103417, 'recall': 0.5597483992554172, 'f1-score': 0.548022301759726, 'support': 12838366}, 'weighted avg': {'precision': 0.6010332645019547, 'recall': 0.5513776441643742, 'f1-score': 0.5527733692029257, 'support': 12838366}}
[[1781194  389659 1611715]
 [ 973173 2503111 1746763]
 [ 668385  369883 2794483]]
Evaluating performance on  train set...
9913/9913 - 92s - 92s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82651025
{'0': {'precision': 0.5009046311715198, 'recall': 0.4860426929392447, 'f1-score': 0.49336176286754113, 'support': 572460}, '1': {'precision': 0.8064140050284011, 'recall': 0.6237206103186635, 'f1-score': 0.7033981696384153, 'support': 1388455}, '2': {'precision': 0.4292035154481183, 'recall': 0.6762012875990911, 'f1-score': 0.5251071263450607, 'support': 576111}, 'accuracy': 0.6045720461674418, 'macro avg': {'precision': 0.5788407172160132, 'recall': 0.5953215302856664, 'f1-score': 0.5739556862836723, 'support': 2537026}, 'weighted avg': {'precision': 0.6518207889869824, 'recall': 0.6045720461674418, 'f1-score': 0.6155185528497689, 'support': 2537026}}
[[278240 103620 190600]
 [194963 866008 327484]
 [ 82272 104272 389567]]
Evaluating performance on  val set...
3496/3496 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8761077
{'0': {'precision': 0.5011068562604326, 'recall': 0.4857994617468133, 'f1-score': 0.49333444645587643, 'support': 231118}, '1': {'precision': 0.788944581137235, 'recall': 0.5778639253285337, 'f1-score': 0.6671053192396216, 'support': 433365}, '2': {'precision': 0.4411010942904122, 'recall': 0.6772789399914684, 'f1-score': 0.5342521726291646, 'support': 229734}, 'accuracy': 0.5796098709820994, 'macro avg': {'precision': 0.5770508438960266, 'recall': 0.5803141090222718, 'f1-score': 0.5648973127748875, 'support': 894217}, 'weighted avg': {'precision': 0.6251857229346456, 'recall': 0.5796098709820994, 'f1-score': 0.5880613496445005, 'support': 894217}}
[[112277  33934  84907]
 [ 70700 250426 112239]
 [ 41081  33059 155594]]
testing model out of sample: results/universal/W5/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 181s - 181s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93723875
{'0': {'precision': 0.44739914421437654, 'recall': 0.49797661887698713, 'f1-score': 0.4713349375401775, 'support': 1307465}, '1': {'precision': 0.7555945374277765, 'recall': 0.534864358336254, 'f1-score': 0.6263517400674904, 'support': 2727628}, '2': {'precision': 0.4116743158529726, 'recall': 0.6150506269952791, 'f1-score': 0.49321982064800396, 'support': 1313726}, 'accuracy': 0.5455421093890072, 'macro avg': {'precision': 0.5382226658317085, 'recall': 0.5492972014028401, 'f1-score': 0.530302166085224, 'support': 5348819}, 'weighted avg': {'precision': 0.5957888631665351, 'recall': 0.5455421093890072, 'f1-score': 0.5557608474447157, 'support': 5348819}}
[[ 651087  237376  419002]
 [ 532991 1458911  735726]
 [ 271193  234525  808008]]
Evaluating performance on  train set...
4957/4957 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83693606
{'0': {'precision': 0.47157381839378526, 'recall': 0.47165841352891713, 'f1-score': 0.47161611216783317, 'support': 267575}, '1': {'precision': 0.7960011122822266, 'recall': 0.6547016295914859, 'f1-score': 0.7184700356941575, 'support': 730183}, '2': {'precision': 0.4179332750218668, 'recall': 0.618060329216282, 'f1-score': 0.49866712785434414, 'support': 270582}, 'accuracy': 0.6082690761152373, 'macro avg': {'precision': 0.5618360685659595, 'recall': 0.5814734574455617, 'f1-score': 0.5629177585721116, 'support': 1268340}, 'weighted avg': {'precision': 0.6469030906919729, 'recall': 0.6082690761152373, 'f1-score': 0.6195007932223686, 'support': 1268340}}
[[126204  62017  79354]
 [ 98571 478052 153560]
 [ 42848  60498 167236]]
Evaluating performance on  val set...
1701/1701 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84266305
{'0': {'precision': 0.4710872522246566, 'recall': 0.48152708052515947, 'f1-score': 0.4762499606352939, 'support': 94219}, '1': {'precision': 0.7928231591820907, 'recall': 0.6485055508112724, 'f1-score': 0.7134392258705264, 'support': 245910}, '2': {'precision': 0.4236861992791536, 'recall': 0.6141287747127163, 'f1-score': 0.5014340570268795, 'support': 94941}, 'accuracy': 0.6048428988438642, 'macro avg': {'precision': 0.562532203561967, 'recall': 0.5813871353497161, 'f1-score': 0.5637077478442333, 'support': 435070}, 'weighted avg': {'precision': 0.6425947648368883, 'recall': 0.6048428988438642, 'f1-score': 0.6158096073806671, 'support': 435070}}
[[ 45369  21412  27438]
 [ 34564 159474  51872]
 [ 16374  20261  58306]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1113644
{'0': {'precision': 0.4408346333853354, 'recall': 0.5071111310511912, 'f1-score': 0.47165599115358137, 'support': 89156}, '1': {'precision': 0.6603911089517794, 'recall': 0.16797973244353817, 'f1-score': 0.26783251231527094, 'support': 97101}, '2': {'precision': 0.39715110790248237, 'recall': 0.6726233863951656, 'f1-score': 0.4994195029548609, 'support': 85058}, 'accuracy': 0.43762784954757383, 'macro avg': {'precision': 0.4994589500798657, 'recall': 0.4492380832966316, 'f1-score': 0.4129693354745711, 'support': 271315}, 'weighted avg': {'precision': 0.5057168552435326, 'recall': 0.43762784954757383, 'f1-score': 0.4074134876728098, 'support': 271315}}
[[45212  4368 39576]
 [33522 16311 47268]
 [23826  4020 57212]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.135563
{'0': {'precision': 0.3827806864456079, 'recall': 0.5032229869987982, 'f1-score': 0.4348154441612385, 'support': 18306}, '1': {'precision': 0.7415348792083051, 'recall': 0.23240892781122666, 'f1-score': 0.3538999374898711, 'support': 32886}, '2': {'precision': 0.35166454171979034, 'recall': 0.6717904308291838, 'f1-score': 0.46166149039445054, 'support': 18476}, 'accuracy': 0.42009243842223115, 'macro avg': {'precision': 0.49199336912456776, 'recall': 0.46914078187973624, 'f1-score': 0.41679229068185336, 'support': 69668}, 'weighted avg': {'precision': 0.5438745673269286, 'recall': 0.42009243842223115, 'f1-score': 0.403739773807708, 'support': 69668}}
[[ 9212  1356  7738]
 [10098  7643 15145]
 [ 4756  1308 12412]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0994272
{'0': {'precision': 0.39964601769911506, 'recall': 0.5002954209748892, 'f1-score': 0.444342407346671, 'support': 6770}, '1': {'precision': 0.7338095238095238, 'recall': 0.27427249265818276, 'f1-score': 0.39930038219861363, 'support': 11237}, '2': {'precision': 0.3675799086757991, 'recall': 0.6693871265783801, 'f1-score': 0.4745633187772926, 'support': 6494}, 'accuracy': 0.441451369331864, 'macro avg': {'precision': 0.5003451500614794, 'recall': 0.4813183467371507, 'f1-score': 0.43940203610752576, 'support': 24501}, 'weighted avg': {'precision': 0.5444057420436417, 'recall': 0.441451369331864, 'f1-score': 0.4316946526526478, 'support': 24501}}
[[3387  580 2803]
 [3479 3082 4676]
 [1609  538 4347]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6535007
{'0': {'precision': 0.48971725903697383, 'recall': 0.4403515286545365, 'f1-score': 0.4637242889543523, 'support': 80790}, '1': {'precision': 0.8741721118371338, 'recall': 0.792408831180605, 'f1-score': 0.8312847981295696, 'support': 397093}, '2': {'precision': 0.3926052305237633, 'recall': 0.6112422833812932, 'f1-score': 0.47811428379047816, 'support': 81318}, 'accuracy': 0.715200795420609, 'macro avg': {'precision': 0.585498200465957, 'recall': 0.6146675477388116, 'f1-score': 0.5910411236248, 'support': 559201}, 'weighted avg': {'precision': 0.7485997984607887, 'recall': 0.715200795420609, 'f1-score': 0.7268244459104355, 'support': 559201}}
[[ 35576  23389  21825]
 [ 27360 314660  55073]
 [  9710  21903  49705]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45536885
{'0': {'precision': 0.44232125229163727, 'recall': 0.5126675384112455, 'f1-score': 0.4749034749034749, 'support': 12236}, '1': {'precision': 0.9287326961107449, 'recall': 0.8945246466297887, 'f1-score': 0.9113077647648579, 'support': 126001}, '2': {'precision': 0.4489701610773699, 'recall': 0.5461334618164297, 'f1-score': 0.49280823158581205, 'support': 12453}, 'accuracy': 0.8347269228216869, 'macro avg': {'precision': 0.6066747031599175, 'recall': 0.651108548952488, 'f1-score': 0.6263398237513816, 'support': 150690}, 'weighted avg': {'precision': 0.8495886701279908, 'recall': 0.8347269228216869, 'f1-score': 0.8412870760833093, 'support': 150690}}
[[  6273   4137   1826]
 [  6769 112711   6521]
 [  1140   4512   6801]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5060659
{'0': {'precision': 0.45810336176618166, 'recall': 0.49727668845315903, 'f1-score': 0.4768869156437712, 'support': 5508}, '1': {'precision': 0.9060885194338351, 'recall': 0.8883846950239003, 'f1-score': 0.8971492764745793, 'support': 45397}, '2': {'precision': 0.4867673323591492, 'recall': 0.5220268152533519, 'f1-score': 0.503780877163502, 'support': 5743}, 'accuracy': 0.8132149413924586, 'macro avg': {'precision': 0.616986404519722, 'recall': 0.6358960662434704, 'f1-score': 0.6259390230939509, 'support': 56648}, 'weighted avg': {'precision': 0.8200190407972838, 'recall': 0.8132149413924586, 'f1-score': 0.8164064470596024, 'support': 56648}}
[[ 2739  2008   761]
 [ 2667 40330  2400]
 [  573  2172  2998]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0746793
{'0': {'precision': 0.4229578759007593, 'recall': 0.5072030900212265, 'f1-score': 0.46126541419213285, 'support': 172426}, '1': {'precision': 0.6437615205632611, 'recall': 0.33541419023702873, 'f1-score': 0.44103779688122674, 'support': 254062}, '2': {'precision': 0.4044807331549651, 'recall': 0.6089472770414954, 'f1-score': 0.48608769166093047, 'support': 172790}, 'accuracy': 0.4637096639623013, 'macro avg': {'precision': 0.49040004320632846, 'recall': 0.4838548524332502, 'f1-score': 0.4627969675780967, 'support': 599278}, 'weighted avg': {'precision': 0.5112393580763085, 'recall': 0.4637096639623013, 'f1-score': 0.4598469947183496, 'support': 599278}}
[[ 87455  24020  60951]
 [ 74881  85216  93965]
 [ 44434  23136 105220]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0531152
{'0': {'precision': 0.45063828459065514, 'recall': 0.43636473539456583, 'f1-score': 0.4433866658477413, 'support': 33087}, '1': {'precision': 0.6756163875672001, 'recall': 0.3863086299796838, 'f1-score': 0.49155342752132714, 'support': 56605}, '2': {'precision': 0.3841792610895798, 'recall': 0.6715976331360947, 'f1-score': 0.4887659198811459, 'support': 33800}, 'accuracy': 0.4778042302335374, 'macro avg': {'precision': 0.503477977749145, 'recall': 0.49809033283678145, 'f1-score': 0.4745686710834048, 'support': 123492}, 'weighted avg': {'precision': 0.5355714828921725, 'recall': 0.4778042302335374, 'f1-score': 0.4778852433334279, 'support': 123492}}
[[14438  5647 13002]
 [11353 21867 23385]
 [ 6248  4852 22700]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.07494
{'0': {'precision': 0.4348279457768509, 'recall': 0.43137931034482757, 'f1-score': 0.433096763025792, 'support': 11600}, '1': {'precision': 0.6535354653092841, 'recall': 0.3452589734596048, 'f1-score': 0.45182266763569595, 'support': 17106}, '2': {'precision': 0.40480315718548465, 'recall': 0.6666402472854086, 'f1-score': 0.5037281030094326, 'support': 12617}, 'accuracy': 0.46756043849672096, 'macro avg': {'precision': 0.49772218942387325, 'recall': 0.4810928436966136, 'f1-score': 0.46288251122364016, 'support': 41323}, 'weighted avg': {'precision': 0.5161963863901784, 'recall': 0.46756043849672096, 'f1-score': 0.4624141151258479, 'support': 41323}}
[[5004 1532 5064]
 [3897 5906 7303]
 [2607 1599 8411]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2950631
{'0': {'precision': 0.40661162887621816, 'recall': 0.24469952878770898, 'f1-score': 0.30553038379530917, 'support': 187389}, '1': {'precision': 0.7262210796915167, 'recall': 0.0038271613300909714, 'f1-score': 0.007614196095871488, 'support': 147629}, '2': {'precision': 0.36345827895283517, 'recall': 0.8012771003078529, 'f1-score': 0.5000806209339469, 'support': 183854}, 'accuracy': 0.37338110362478605, 'macro avg': {'precision': 0.4987636625068566, 'recall': 0.349934596808551, 'f1-score': 0.2710750669417092, 'support': 518872}, 'weighted avg': {'precision': 0.4822559257694752, 'recall': 0.37338110362478605, 'f1-score': 0.28970330201985556, 'support': 518872}}
[[ 45854    110 141425]
 [ 30484    565 116580]
 [ 36433    103 147318]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3481321
{'0': {'precision': 0.3743758153763102, 'recall': 0.29538920242785643, 'f1-score': 0.3302249910717829, 'support': 28173}, '1': {'precision': 0.6866197183098591, 'recall': 0.006906566550966919, 'f1-score': 0.01367557332211235, 'support': 28234}, '2': {'precision': 0.35009356045941414, 'recall': 0.7724037298028329, 'f1-score': 0.4818070818070818, 'support': 28098}, 'accuracy': 0.3576119756227442, 'macro avg': {'precision': 0.4703630313818612, 'recall': 0.35823316626055207, 'f1-score': 0.27523588206699234, 'support': 84505}, 'weighted avg': {'precision': 0.47062587817461654, 'recall': 0.3576119756227442, 'f1-score': 0.27486373818421683, 'support': 84505}}
[[ 8322    48 19803]
 [ 7553   195 20486]
 [ 6354    41 21703]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3097397
{'0': {'precision': 0.41427511133102424, 'recall': 0.2714378343329551, 'f1-score': 0.32797962981098816, 'support': 12338}, '1': {'precision': 0.7424242424242424, 'recall': 0.004651162790697674, 'f1-score': 0.009244410904631638, 'support': 10535}, '2': {'precision': 0.3571832046695538, 'recall': 0.8016396213657877, 'f1-score': 0.4941777164144111, 'support': 11832}, 'accuracy': 0.3712145224031119, 'macro avg': {'precision': 0.5046275194749401, 'recall': 0.35924287282981354, 'f1-score': 0.27713391904334367, 'support': 34705}, 'weighted avg': {'precision': 0.4944232068921403, 'recall': 0.3712145224031119, 'f1-score': 0.2878868544043676, 'support': 34705}}
[[3349   11 8978]
 [2394   49 8092]
 [2341    6 9485]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
2900/2900 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1257036
{'0': {'precision': 0.4559799925898481, 'recall': 0.4704454493675483, 'f1-score': 0.4630997872064211, 'support': 261601}, '1': {'precision': 0.5252616215880508, 'recall': 0.07811381573174843, 'f1-score': 0.1360021869698407, 'support': 216543}, '2': {'precision': 0.421862578080636, 'recall': 0.7029472879425, 'f1-score': 0.5272840576953378, 'support': 264209}, 'accuracy': 0.43875218393405835, 'macro avg': {'precision': 0.4677013974195116, 'recall': 0.41716885101393225, 'f1-score': 0.3754620106238666, 'support': 742353}, 'weighted avg': {'precision': 0.464046672212741, 'recall': 0.43875218393405835, 'f1-score': 0.39052968413359235, 'support': 742353}}
[[123069   7943 130589]
 [ 75692  16915 123936]
 [ 71139   7345 185725]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0726348
{'0': {'precision': 0.4874721752292761, 'recall': 0.45498213246904345, 'f1-score': 0.4706671251719394, 'support': 60165}, '1': {'precision': 0.5844103392568659, 'recall': 0.22590941419327978, 'f1-score': 0.32585605084385283, 'support': 57647}, '2': {'precision': 0.4273468934985831, 'recall': 0.7087640073590902, 'f1-score': 0.5332016382201028, 'support': 59790}, 'accuracy': 0.4660645713449173, 'macro avg': {'precision': 0.49974313599490844, 'recall': 0.4632185180071378, 'f1-score': 0.44324160474529833, 'support': 177602}, 'weighted avg': {'precision': 0.4986956059734137, 'recall': 0.4660645713449173, 'f1-score': 0.44471592267060767, 'support': 177602}}
[[27374  5020 27771]
 [15609 13023 29015]
 [13172  4241 42377]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0621753
{'0': {'precision': 0.4731880385200203, 'recall': 0.47122955784373105, 'f1-score': 0.47220676748773455, 'support': 19812}, '1': {'precision': 0.6017935304793424, 'recall': 0.26757488014430153, 'f1-score': 0.370440954195965, 'support': 21067}, '2': {'precision': 0.4331444759206799, 'recall': 0.688463077846708, 'f1-score': 0.5317438850032845, 'support': 19988}, 'accuracy': 0.4720784661639312, 'macro avg': {'precision': 0.5027086816400143, 'recall': 0.47575583861158016, 'f1-score': 0.458130535562328, 'support': 60867}, 'weighted avg': {'precision': 0.5045505365874693, 'recall': 0.4720784661639312, 'f1-score': 0.45653534481671587, 'support': 60867}}
[[ 9336  2018  8458]
 [ 5879  5637  9551]
 [ 4515  1712 13761]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/EXC
Evaluating performance on  test set...
7167/7167 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58371496
{'0': {'precision': 0.5152785124303211, 'recall': 0.4698096128448263, 'f1-score': 0.4914947043230887, 'support': 269556}, '1': {'precision': 0.8469402658098437, 'recall': 0.8424330608450665, 'f1-score': 0.844680650773488, 'support': 1294123}, '2': {'precision': 0.48480236105584296, 'recall': 0.5396973645837563, 'f1-score': 0.5107791638352547, 'support': 270887}, 'accuracy': 0.7429817188370438, 'macro avg': {'precision': 0.6156737130986693, 'recall': 0.6173133460912164, 'f1-score': 0.6156515063106105, 'support': 1834566}, 'weighted avg': {'precision': 0.7447363297295568, 'recall': 0.7429817188370438, 'f1-score': 0.7434834395128296, 'support': 1834566}}
[[ 126640  103129   39787]
 [  88335 1090212  115576]
 [  30795   93895  146197]]
Evaluating performance on  train set...
1570/1570 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.52467626
{'0': {'precision': 0.5001029866117405, 'recall': 0.48299184404217227, 'f1-score': 0.49139850232746407, 'support': 50270}, '1': {'precision': 0.8800790173070984, 'recall': 0.8617082087072117, 'f1-score': 0.8707967336054769, 'support': 300900}, '2': {'precision': 0.47963437553391425, 'recall': 0.5555819430426092, 'f1-score': 0.514822252175428, 'support': 50529}, 'accuracy': 0.7758072586688043, 'macro avg': {'precision': 0.6199387931509177, 'recall': 0.6334273319306644, 'f1-score': 0.625672496036123, 'support': 401699}, 'weighted avg': {'precision': 0.7821562881810292, 'recall': 0.7758072586688043, 'f1-score': 0.7785401343644416, 'support': 401699}}
[[ 24280  17689   8301]
 [ 19456 259288  22156]
 [  4814  17642  28073]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5971927
{'0': {'precision': 0.5125959040657283, 'recall': 0.45790609821910416, 'f1-score': 0.48371005900293584, 'support': 18530}, '1': {'precision': 0.8727986458745993, 'recall': 0.8188237679070186, 'f1-score': 0.8449501141824477, 'support': 88792}, '2': {'precision': 0.45033982082174856, 'recall': 0.6328413284132841, 'f1-score': 0.5262160454832596, 'support': 18428}, 'accuracy': 0.7383856858846919, 'macro avg': {'precision': 0.6119114569206922, 'recall': 0.6365237315131357, 'f1-score': 0.6182920728895477, 'support': 125750}, 'weighted avg': {'precision': 0.757811544214223, 'recall': 0.7383856858846919, 'f1-score': 0.7450104748944557, 'support': 125750}}
[[ 8485  5866  4179]
 [ 6032 72705 10055]
 [ 2036  4730 11662]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/AAL
Evaluating performance on  test set...
6357/6357 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78342474
{'0': {'precision': 0.4271175486975809, 'recall': 0.5282425154811975, 'f1-score': 0.4723279877186744, 'support': 257732}, '1': {'precision': 0.8336767053730169, 'recall': 0.6564760067893547, 'f1-score': 0.7345404937758476, 'support': 1106438}, '2': {'precision': 0.35931373670364863, 'recall': 0.5972531692738238, 'f1-score': 0.4486905550858109, 'support': 262994}, 'accuracy': 0.6265926483132616, 'macro avg': {'precision': 0.5400359969247487, 'recall': 0.5939905638481253, 'f1-score': 0.5518530121934443, 'support': 1627164}, 'weighted avg': {'precision': 0.6926104581167445, 'recall': 0.6265926483132616, 'f1-score': 0.6468066375775942, 'support': 1627164}}
[[136145  71970  49617]
 [149629 726350 230459]
 [ 32979  72941 157074]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.696255
{'0': {'precision': 0.4792268448659912, 'recall': 0.49414676071365066, 'f1-score': 0.4865724562081871, 'support': 67484}, '1': {'precision': 0.8429285175355948, 'recall': 0.7540961035384828, 'f1-score': 0.7960417168866893, 'support': 297783}, '2': {'precision': 0.41908037653874003, 'recall': 0.5940043620190731, 'f1-score': 0.4914407694167457, 'support': 70151}, 'accuracy': 0.6880147352658824, 'macro avg': {'precision': 0.5804119129801087, 'recall': 0.6140824087570689, 'f1-score': 0.591351647503874, 'support': 435418}, 'weighted avg': {'precision': 0.7182726360205773, 'recall': 0.6880147352658824, 'f1-score': 0.6990032741636232, 'support': 435418}}
[[ 33347  20257  13880]
 [ 29344 224557  43882]
 [  6894  21587  41670]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7039052
{'0': {'precision': 0.4971670027849803, 'recall': 0.4634943372577107, 'f1-score': 0.47974053052241394, 'support': 22339}, '1': {'precision': 0.8368098159509203, 'recall': 0.7505780434365565, 'f1-score': 0.7913517426387617, 'support': 99041}, '2': {'precision': 0.40150017443888825, 'recall': 0.6089870794196763, 'f1-score': 0.4839416186287737, 'support': 22677}, 'accuracy': 0.6837710073096066, 'macro avg': {'precision': 0.5784923310582629, 'recall': 0.6076864867046479, 'f1-score': 0.5850112972633165, 'support': 144057}, 'weighted avg': {'precision': 0.7156161388378173, 'recall': 0.6837710073096066, 'f1-score': 0.6946384815709788, 'support': 144057}}
[[10354  7622  4363]
 [ 8480 74338 16223]
 [ 1992  6875 13810]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/WBA
Evaluating performance on  test set...
7458/7458 - 62s - 62s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8744769
{'0': {'precision': 0.47549846872888984, 'recall': 0.4787773034917705, 'f1-score': 0.47713225316977187, 'support': 416064}, '1': {'precision': 0.7361255292496696, 'recall': 0.6220037957114126, 'f1-score': 0.6742699165655487, 'support': 1059090}, '2': {'precision': 0.43177352228869326, 'recall': 0.5922339043336435, 'f1-score': 0.49943176630345043, 'support': 434092}, 'accuracy': 0.5840232217325583, 'macro avg': {'precision': 0.5477991734224176, 'recall': 0.5643383345122756, 'f1-score': 0.5502779786795903, 'support': 1909246}, 'weighted avg': {'precision': 0.6101311268970017, 'recall': 0.5840232217325583, 'f1-score': 0.5915578265013688, 'support': 1909246}}
[[199202 119178  97684]
 [159686 658758 240646]
 [ 60045 116963 257084]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6664141
{'0': {'precision': 0.5048003042982122, 'recall': 0.49631258507980675, 'f1-score': 0.5005204640427232, 'support': 66849}, '1': {'precision': 0.8428635097493036, 'recall': 0.7780825393342408, 'f1-score': 0.8091785415667558, 'support': 291667}, '2': {'precision': 0.43873782779768317, 'recall': 0.5918748609978501, 'f1-score': 0.5039291552789543, 'support': 67445}, 'accuracy': 0.7043790393956254, 'macro avg': {'precision': 0.5954672139483997, 'recall': 0.6220899951372992, 'f1-score': 0.6045427202961444, 'support': 425961}, 'weighted avg': {'precision': 0.725821236300732, 'recall': 0.7043790393956254, 'f1-score': 0.7124067040450466, 'support': 425961}}
[[ 33178  21677  11994]
 [ 25653 226941  39073]
 [  6894  20632  39919]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76132613
{'0': {'precision': 0.493099173553719, 'recall': 0.47562676870341586, 'f1-score': 0.484205400799367, 'support': 25089}, '1': {'precision': 0.8067402367518531, 'recall': 0.7142489837896078, 'f1-score': 0.7576824168116997, 'support': 81676}, '2': {'precision': 0.43198833524941815, 'recall': 0.6062967335694608, 'f1-score': 0.5045109950387241, 'support': 25410}, 'accuracy': 0.6482012483449971, 'macro avg': {'precision': 0.5772759151849968, 'recall': 0.5987241620208281, 'f1-score': 0.5821329375499302, 'support': 132175}, 'weighted avg': {'precision': 0.6751617502623138, 'recall': 0.6482012483449971, 'f1-score': 0.6571009855124015, 'support': 132175}}
[[11933  7152  6004]
 [ 9086 58337 14253]
 [ 3181  6823 15406]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
8238/8238 - 64s - 64s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9279862
{'0': {'precision': 0.46511727981123346, 'recall': 0.4926559680941981, 'f1-score': 0.4784907163858649, 'support': 526550}, '1': {'precision': 0.7058381522150005, 'recall': 0.5831450691230242, 'f1-score': 0.638652282278458, 'support': 1053484}, '2': {'precision': 0.44436265651125, 'recall': 0.5720773632193692, 'f1-score': 0.500196395095663, 'support': 528675}, 'accuracy': 0.5577749229504877, 'macro avg': {'precision': 0.5384393628458279, 'recall': 0.5492928001455305, 'f1-score': 0.5391131312533286, 'support': 2108709}, 'weighted avg': {'precision': 0.580174946407379, 'recall': 0.5577749229504877, 'f1-score': 0.5639472192863102, 'support': 2108709}}
[[259408 128917 138225]
 [199196 614334 239954]
 [ 99122 127110 302443]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7760824
{'0': {'precision': 0.4872770706230898, 'recall': 0.47001682988264265, 'f1-score': 0.4784913470936584, 'support': 88533}, '1': {'precision': 0.7832772116049328, 'recall': 0.7387839950641866, 'f1-score': 0.7603802857555202, 'support': 285262}, '2': {'precision': 0.4476765238382619, 'recall': 0.5456572172240141, 'f1-score': 0.4918345488856021, 'support': 88365}, 'accuracy': 0.6503721654838152, 'macro avg': {'precision': 0.5727436020220947, 'recall': 0.5848193473902811, 'f1-score': 0.5769020605782602, 'support': 462160}, 'weighted avg': {'precision': 0.6624075230640651, 'recall': 0.6503721654838152, 'f1-score': 0.6550346966845039, 'support': 462160}}
[[ 41612  29810  17111]
 [ 32138 210747  42377]
 [ 11647  28501  48217]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7861042
{'0': {'precision': 0.4824632383716064, 'recall': 0.5131165054305894, 'f1-score': 0.4973179746034485, 'support': 33698}, '1': {'precision': 0.7864420018970039, 'recall': 0.7231451174339979, 'f1-score': 0.7534665426515711, 'support': 97459}, '2': {'precision': 0.4616136667695791, 'recall': 0.5409920096487261, 'f1-score': 0.4981605652964614, 'support': 33165}, 'accuracy': 0.6433100862939838, 'macro avg': {'precision': 0.5768396356793964, 'recall': 0.5924178775044378, 'f1-score': 0.582981694183827, 'support': 164322}, 'weighted avg': {'precision': 0.6585442882142354, 'recall': 0.6433100862939838, 'f1-score': 0.6494091602860459, 'support': 164322}}
[[17291  9637  6770]
 [12826 70477 14156]
 [ 5722  9501 17942]]
testing model on single stock: results/universal/W5/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
31315/31315 - 247s - 247s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.017179
{'0': {'precision': 0.5340283710990128, 'recall': 0.4856709756081179, 'f1-score': 0.5087030423852245, 'support': 2828769}, '1': {'precision': 0.6101973615742302, 'recall': 0.1891276635276064, 'f1-score': 0.2887566325614319, 'support': 2325112}, '2': {'precision': 0.46454590377806937, 'recall': 0.7664871096206246, 'f1-score': 0.5784872431485857, 'support': 2862600}, 'accuracy': 0.49993756612159373, 'macro avg': {'precision': 0.5362572121504375, 'recall': 0.48042858291878304, 'f1-score': 0.458648972698414, 'support': 8016481}, 'weighted avg': {'precision': 0.531309088514657, 'recall': 0.49993756612159373, 'f1-score': 0.46982865551484826, 'support': 8016481}}
[[1373851  143908 1311010]
 [ 667319  439743 1218050]
 [ 531448  137006 2194146]]
Evaluating performance on  train set...
5759/5759 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96294945
{'0': {'precision': 0.5089029732454745, 'recall': 0.497520075578649, 'f1-score': 0.503147152695096, 'support': 414932}, '1': {'precision': 0.6878330189943213, 'recall': 0.4160488613004225, 'f1-score': 0.5184832714909849, 'support': 641653}, '2': {'precision': 0.4304383866056049, 'recall': 0.701345351616194, 'f1-score': 0.5334693394293208, 'support': 417586}, 'accuracy': 0.5197958717136615, 'macro avg': {'precision': 0.5423914596151336, 'recall': 0.5383047628317552, 'f1-score': 0.5183665878718006, 'support': 1474171}, 'weighted avg': {'precision': 0.5645581772674558, 'recall': 0.5197958717136615, 'f1-score': 0.5184117232933079, 'support': 1474171}}
[[206437  59824 148671]
 [135833 266959 238861]
 [ 63381  61333 292872]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9791365
{'0': {'precision': 0.5061397910461873, 'recall': 0.5048599199542596, 'f1-score': 0.5054990453763459, 'support': 169653}, '1': {'precision': 0.6742785895454196, 'recall': 0.3814944555842775, 'f1-score': 0.48728946929908473, 'support': 206965}, '2': {'precision': 0.44935773998716255, 'recall': 0.6904189019789568, 'f1-score': 0.5443962720669698, 'support': 168321}, 'accuracy': 0.515321898414318, 'macro avg': {'precision': 0.5432587068595899, 'recall': 0.5255910925058314, 'f1-score': 0.5123949289141335, 'support': 544939}, 'weighted avg': {'precision': 0.5524591677380509, 'recall': 0.515321898414318, 'f1-score': 0.5105977356535368, 'support': 544939}}
[[ 85651  18876  65126]
 [ 50729  78956  77280]
 [ 32844  19265 116212]]
training model: results/universal/W5/deepOF_L2/h20
Epoch 1/50
9913/9913 - 233s - loss: 2.7023 - accuracy20: 0.5588 - val_loss: 2.9838 - val_accuracy20: 0.5510 - 233s/epoch - 24ms/step
Epoch 2/50
9913/9913 - 238s - loss: 2.6235 - accuracy20: 0.5788 - val_loss: 2.9697 - val_accuracy20: 0.5548 - 238s/epoch - 24ms/step
Epoch 3/50
9913/9913 - 230s - loss: 2.6029 - accuracy20: 0.5827 - val_loss: 2.9499 - val_accuracy20: 0.5571 - 230s/epoch - 23ms/step
Epoch 4/50
9913/9913 - 225s - loss: 2.5900 - accuracy20: 0.5849 - val_loss: 2.9387 - val_accuracy20: 0.5573 - 225s/epoch - 23ms/step
Epoch 5/50
9913/9913 - 228s - loss: 2.5807 - accuracy20: 0.5868 - val_loss: 2.9123 - val_accuracy20: 0.5586 - 228s/epoch - 23ms/step
Epoch 6/50
9913/9913 - 237s - loss: 2.5734 - accuracy20: 0.5883 - val_loss: 2.9036 - val_accuracy20: 0.5598 - 237s/epoch - 24ms/step
Epoch 7/50
9913/9913 - 226s - loss: 2.5668 - accuracy20: 0.5896 - val_loss: 2.8959 - val_accuracy20: 0.5603 - 226s/epoch - 23ms/step
Epoch 8/50
9913/9913 - 223s - loss: 2.5604 - accuracy20: 0.5909 - val_loss: 2.8669 - val_accuracy20: 0.5630 - 223s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 232s - loss: 2.5554 - accuracy20: 0.5918 - val_loss: 2.8576 - val_accuracy20: 0.5645 - 232s/epoch - 23ms/step
Epoch 10/50
9913/9913 - 228s - loss: 2.5506 - accuracy20: 0.5928 - val_loss: 2.8668 - val_accuracy20: 0.5647 - 228s/epoch - 23ms/step
Epoch 11/50
9913/9913 - 234s - loss: 2.5459 - accuracy20: 0.5934 - val_loss: 2.8549 - val_accuracy20: 0.5646 - 234s/epoch - 24ms/step
Epoch 12/50
9913/9913 - 224s - loss: 2.5426 - accuracy20: 0.5945 - val_loss: 2.8459 - val_accuracy20: 0.5662 - 224s/epoch - 23ms/step
Epoch 13/50
9913/9913 - 222s - loss: 2.5385 - accuracy20: 0.5952 - val_loss: 2.8499 - val_accuracy20: 0.5650 - 222s/epoch - 22ms/step
Epoch 14/50
9913/9913 - 219s - loss: 2.5356 - accuracy20: 0.5958 - val_loss: 2.8382 - val_accuracy20: 0.5670 - 219s/epoch - 22ms/step
Epoch 15/50
9913/9913 - 220s - loss: 2.5323 - accuracy20: 0.5966 - val_loss: 2.8500 - val_accuracy20: 0.5663 - 220s/epoch - 22ms/step
Epoch 16/50
9913/9913 - 222s - loss: 2.5296 - accuracy20: 0.5969 - val_loss: 2.8365 - val_accuracy20: 0.5669 - 222s/epoch - 22ms/step
Epoch 17/50
9913/9913 - 222s - loss: 2.5266 - accuracy20: 0.5975 - val_loss: 2.8312 - val_accuracy20: 0.5668 - 222s/epoch - 22ms/step
Epoch 18/50
9913/9913 - 220s - loss: 2.5244 - accuracy20: 0.5978 - val_loss: 2.8333 - val_accuracy20: 0.5667 - 220s/epoch - 22ms/step
Epoch 19/50
9913/9913 - 235s - loss: 2.5219 - accuracy20: 0.5981 - val_loss: 2.8302 - val_accuracy20: 0.5675 - 235s/epoch - 24ms/step
Epoch 20/50
9913/9913 - 226s - loss: 2.5199 - accuracy20: 0.5988 - val_loss: 2.8237 - val_accuracy20: 0.5670 - 226s/epoch - 23ms/step
Epoch 21/50
9913/9913 - 229s - loss: 2.5175 - accuracy20: 0.5994 - val_loss: 2.8291 - val_accuracy20: 0.5665 - 229s/epoch - 23ms/step
Epoch 22/50
9913/9913 - 228s - loss: 2.5157 - accuracy20: 0.5996 - val_loss: 2.8317 - val_accuracy20: 0.5666 - 228s/epoch - 23ms/step
Epoch 23/50
9913/9913 - 238s - loss: 2.5137 - accuracy20: 0.6000 - val_loss: 2.8314 - val_accuracy20: 0.5663 - 238s/epoch - 24ms/step
Epoch 24/50
9913/9913 - 237s - loss: 2.5119 - accuracy20: 0.6003 - val_loss: 2.8349 - val_accuracy20: 0.5672 - 237s/epoch - 24ms/step
Epoch 25/50
9913/9913 - 220s - loss: 2.5100 - accuracy20: 0.6006 - val_loss: 2.8331 - val_accuracy20: 0.5667 - 220s/epoch - 22ms/step
Epoch 26/50
9913/9913 - 221s - loss: 2.5086 - accuracy20: 0.6008 - val_loss: 2.8199 - val_accuracy20: 0.5662 - 221s/epoch - 22ms/step
Epoch 27/50
9913/9913 - 220s - loss: 2.5064 - accuracy20: 0.6013 - val_loss: 2.8214 - val_accuracy20: 0.5658 - 220s/epoch - 22ms/step
Epoch 28/50
9913/9913 - 219s - loss: 2.5054 - accuracy20: 0.6016 - val_loss: 2.8227 - val_accuracy20: 0.5660 - 219s/epoch - 22ms/step
Epoch 29/50
9913/9913 - 225s - loss: 2.5036 - accuracy20: 0.6015 - val_loss: 2.8221 - val_accuracy20: 0.5663 - 225s/epoch - 23ms/step
Epoch 30/50
9913/9913 - 218s - loss: 2.5020 - accuracy20: 0.6022 - val_loss: 2.8252 - val_accuracy20: 0.5674 - 218s/epoch - 22ms/step
Epoch 31/50
9913/9913 - 220s - loss: 2.5006 - accuracy20: 0.6022 - val_loss: 2.8258 - val_accuracy20: 0.5659 - 220s/epoch - 22ms/step
Epoch 32/50
9913/9913 - 220s - loss: 2.4994 - accuracy20: 0.6026 - val_loss: 2.8326 - val_accuracy20: 0.5644 - 220s/epoch - 22ms/step
Epoch 33/50
9913/9913 - 219s - loss: 2.4977 - accuracy20: 0.6028 - val_loss: 2.8302 - val_accuracy20: 0.5660 - 219s/epoch - 22ms/step
Epoch 34/50
9913/9913 - 221s - loss: 2.4963 - accuracy20: 0.6030 - val_loss: 2.8273 - val_accuracy20: 0.5657 - 221s/epoch - 22ms/step
Epoch 35/50
9913/9913 - 221s - loss: 2.4952 - accuracy20: 0.6034 - val_loss: 2.8347 - val_accuracy20: 0.5645 - 221s/epoch - 22ms/step
Epoch 36/50
9913/9913 - 219s - loss: 2.4935 - accuracy20: 0.6036 - val_loss: 2.8318 - val_accuracy20: 0.5647 - 219s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 393s - 393s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9524288
{'0': {'precision': 0.5289886398064315, 'recall': 0.47560022282161185, 'f1-score': 0.5008757797769698, 'support': 4317355}, '1': {'precision': 0.6642353311322663, 'recall': 0.494352599651237, 'f1-score': 0.566839087480181, 'support': 4125438}, '2': {'precision': 0.48911060097210307, 'recall': 0.6550015208483626, 'f1-score': 0.5600293561963613, 'support': 4395573}, 'accuracy': 0.5430490920729321, 'macro avg': {'precision': 0.5607781906369337, 'recall': 0.5416514477737372, 'f1-score': 0.5425814078178374, 'support': 12838366}, 'weighted avg': {'precision': 0.5587950037141706, 'recall': 0.5430490920729321, 'f1-score': 0.5423250887908299, 'support': 12838366}}
[[2053335  521628 1742392]
 [ 821103 2039421 1264914]
 [1007186  509280 2879107]]
Evaluating performance on  train set...
9913/9913 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.873732
{'0': {'precision': 0.5203085664349256, 'recall': 0.48555433340975773, 'f1-score': 0.5023310416990371, 'support': 689134}, '1': {'precision': 0.712917519874017, 'recall': 0.6521331368805009, 'f1-score': 0.6811719935403354, 'support': 1155833}, '2': {'precision': 0.4808089042094669, 'recall': 0.5812553553959995, 'f1-score': 0.5262821867250345, 'support': 692059}, 'accuracy': 0.5875509356230484, 'macro avg': {'precision': 0.5713449968394698, 'recall': 0.5729809418954194, 'f1-score': 0.569928407321469, 'support': 2537026}, 'weighted avg': {'precision': 0.597283610340773, 'recall': 0.5875509356230484, 'f1-score': 0.5903419171749409, 'support': 2537026}}
[[334612 150466 204056]
 [171757 753757 230319]
 [136734 153062 402263]]
Evaluating performance on  val set...
3496/3496 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9106003
{'0': {'precision': 0.5103496869681732, 'recall': 0.4929505178793908, 'f1-score': 0.5014992347754363, 'support': 268885}, '1': {'precision': 0.6877192318965273, 'recall': 0.6122469593030596, 'f1-score': 0.6477922448034484, 'support': 356415}, '2': {'precision': 0.4886916058739336, 'recall': 0.5764306458870209, 'f1-score': 0.5289473908703923, 'support': 268917}, 'accuracy': 0.5656043219934311, 'macro avg': {'precision': 0.5622535082462113, 'recall': 0.5605427076898238, 'f1-score': 0.5594129568164258, 'support': 894217}, 'weighted avg': {'precision': 0.5745320276774415, 'recall': 0.5656043219934311, 'f1-score': 0.5680628305935892, 'support': 894217}}
[[132547  49908  86430]
 [ 62445 218214  75756]
 [ 64726  49179 155012]]
testing model out of sample: results/universal/W5/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0053474
{'0': {'precision': 0.4727657812599529, 'recall': 0.47418934606535834, 'f1-score': 0.4734764936347859, 'support': 1565187}, '1': {'precision': 0.6410151163925215, 'recall': 0.5151144153468824, 'f1-score': 0.5712095709764724, 'support': 2219239}, '2': {'precision': 0.4345478480444307, 'recall': 0.5543140374573396, 'f1-score': 0.48717819070492563, 'support': 1564393}, 'accuracy': 0.5146036910203916, 'macro avg': {'precision': 0.5161095818989684, 'recall': 0.5145392662898601, 'f1-score': 0.510621418438728, 'support': 5348819}, 'weighted avg': {'precision': 0.5313951009384531, 'recall': 0.5146036910203916, 'f1-score': 0.5180335997569662, 'support': 5348819}}
[[ 742195  321890  501102]
 [ 448787 1143162  627290]
 [ 378918  318310  867165]]
Evaluating performance on  train set...
4957/4957 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91198415
{'0': {'precision': 0.49459668743018864, 'recall': 0.4459052043691, 'f1-score': 0.46899052285139686, 'support': 323728}, '1': {'precision': 0.6984008420194887, 'recall': 0.6657970629836901, 'f1-score': 0.681709343925181, 'support': 617906}, '2': {'precision': 0.45653576719959116, 'recall': 0.5413797114225022, 'f1-score': 0.49535097349494767, 'support': 326706}, 'accuracy': 0.5776242963243294, 'macro avg': {'precision': 0.5498444322164228, 'recall': 0.5510273262584308, 'f1-score': 0.5486836134238419, 'support': 1268340}, 'weighted avg': {'precision': 0.5840814304334832, 'recall': 0.5776242963243294, 'f1-score': 0.579412297172454, 'support': 1268340}}
[[144352  90095  89281]
 [ 85237 411400 121269]
 [ 62269  87565 176872]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91208965
{'0': {'precision': 0.495245769540693, 'recall': 0.4578046130117779, 'f1-score': 0.4757897421185171, 'support': 114112}, '1': {'precision': 0.6982216716491256, 'recall': 0.6592986441742997, 'f1-score': 0.6782021544512316, 'support': 206885}, '2': {'precision': 0.4613247115090924, 'recall': 0.5428541372629807, 'f1-score': 0.4987797314603754, 'support': 114073}, 'accuracy': 0.5759188176615258, 'macro avg': {'precision': 0.5515973842329703, 'recall': 0.5533191314830194, 'f1-score': 0.5509238760100413, 'support': 435070}, 'weighted avg': {'precision': 0.5828711922424751, 'recall': 0.5759188176615258, 'f1-score': 0.5780689821940163, 'support': 435070}}
[[ 52241  30315  31556]
 [ 29734 136399  40752]
 [ 23510  28638  61925]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1118776
{'0': {'precision': 0.44957827129923394, 'recall': 0.5652643458971415, 'f1-score': 0.5008275434029275, 'support': 102782}, '1': {'precision': 0.5288290750102473, 'recall': 0.10789602062861524, 'f1-score': 0.17922507900860124, 'support': 71745}, '2': {'precision': 0.4274875046097594, 'recall': 0.5629003595487044, 'f1-score': 0.4859366289829866, 'support': 96788}, 'accuracy': 0.44347713911873654, 'macro avg': {'precision': 0.46863161697308026, 'recall': 0.4120202420248204, 'f1-score': 0.3886630837981717, 'support': 271315}, 'weighted avg': {'precision': 0.46265431864606615, 'recall': 0.44347713911873654, 'f1-score': 0.4104726767982496, 'support': 271315}}
[[58099  3673 41010]
 [32049  7741 31955]
 [39082  3224 54482]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1875249
{'0': {'precision': 0.3963470319634703, 'recall': 0.5337523913637606, 'f1-score': 0.454900133931171, 'support': 21954}, '1': {'precision': 0.6384969325153375, 'recall': 0.1627125268712136, 'f1-score': 0.25933655193895033, 'support': 25585}, '2': {'precision': 0.38721972426525325, 'recall': 0.5876451714944191, 'f1-score': 0.466829408385985, 'support': 22129}, 'accuracy': 0.4146092897743584, 'macro avg': {'precision': 0.47402122958135373, 'recall': 0.4280366965764644, 'f1-score': 0.3936886980853688, 'support': 69668}, 'weighted avg': {'precision': 0.4823754383130953, 'recall': 0.4146092897743584, 'f1-score': 0.3868701728175982, 'support': 69668}}
[[11718  1174  9062]
 [ 9905  4163 11517]
 [ 7942  1183 13004]]
Evaluating performance on  val set...
96/96 - 1s - 953ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1465269
{'0': {'precision': 0.41747859462651316, 'recall': 0.5295880149812734, 'f1-score': 0.46689780419349514, 'support': 8010}, '1': {'precision': 0.6259092483546934, 'recall': 0.20450430058850158, 'f1-score': 0.30828286274844324, 'support': 8836}, '2': {'precision': 0.3977997031345499, 'recall': 0.595166557805356, 'f1-score': 0.4768683274021352, 'support': 7655}, 'accuracy': 0.4328394759397576, 'macro avg': {'precision': 0.4803958487052522, 'recall': 0.44308629112504366, 'f1-score': 0.4173496647813579, 'support': 24501}, 'weighted avg': {'precision': 0.4864982812503743, 'recall': 0.4328394759397576, 'f1-score': 0.4128103274600418, 'support': 24501}}
[[4242  543 3225]
 [3357 1807 3672]
 [2562  537 4556]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7348494
{'0': {'precision': 0.5246682743275202, 'recall': 0.43974574285267926, 'f1-score': 0.47846803537754645, 'support': 102416}, '1': {'precision': 0.8007482860052363, 'recall': 0.7977342025766452, 'f1-score': 0.7992384026273694, 'support': 353871}, '2': {'precision': 0.444650439072031, 'recall': 0.5220281011329848, 'f1-score': 0.48024242749299406, 'support': 102914}, 'accuracy': 0.6814293965854854, 'macro avg': {'precision': 0.5900223331349291, 'recall': 0.5865026821874364, 'f1-score': 0.58598295516597, 'support': 559201}, 'weighted avg': {'precision': 0.6846496661972087, 'recall': 0.6814293965854854, 'f1-score': 0.6817830158930163, 'support': 559201}}
[[ 45037  35491  21888]
 [ 26365 282295  45211]
 [ 14437  34753  53724]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.51113844
{'0': {'precision': 0.5395054074533305, 'recall': 0.46858920665310516, 'f1-score': 0.5015529441900675, 'support': 16714}, '1': {'precision': 0.8790120815090364, 'recall': 0.914396520726675, 'f1-score': 0.896355228815764, 'support': 116806}, '2': {'precision': 0.5469485168769178, 'recall': 0.4671520093185789, 'f1-score': 0.5039107900109941, 'support': 17170}, 'accuracy': 0.8139889840069016, 'macro avg': {'precision': 0.6551553352797616, 'recall': 0.616712578899453, 'f1-score': 0.633939654338942, 'support': 150690}, 'weighted avg': {'precision': 0.803519043119624, 'recall': 0.8139889840069016, 'f1-score': 0.807849047917816, 'support': 150690}}
[[  7832   7090   1792]
 [  5147 106807   4852]
 [  1538   7611   8021]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5740162
{'0': {'precision': 0.5398970398970399, 'recall': 0.44758602293945055, 'f1-score': 0.48942686305964705, 'support': 7498}, '1': {'precision': 0.8430242983950507, 'recall': 0.9111590270375036, 'f1-score': 0.8757684426229507, 'support': 41276}, '2': {'precision': 0.5974226804123711, 'recall': 0.4415798831597663, 'f1-score': 0.5078136410106616, 'support': 7874}, 'accuracy': 0.7845290213246716, 'macro avg': {'precision': 0.6601146729014872, 'recall': 0.6001083110455735, 'f1-score': 0.6243363155644198, 'support': 56648}, 'weighted avg': {'precision': 0.7687636832945405, 'recall': 0.7845290213246716, 'f1-score': 0.7734865390877719, 'support': 56648}}
[[ 3356  3395   747]
 [ 2071 37609  1596]
 [  789  3608  3477]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0961436
{'0': {'precision': 0.45195249355403255, 'recall': 0.49151270068043684, 'f1-score': 0.4709032024572897, 'support': 206485}, '1': {'precision': 0.5016352014270848, 'recall': 0.3255598314877743, 'f1-score': 0.394857960085809, 'support': 186574}, '2': {'precision': 0.4448790181088423, 'recall': 0.5471658770530359, 'f1-score': 0.4907491975679132, 'support': 206219}, 'accuracy': 0.45899732678322913, 'macro avg': {'precision': 0.46615557102998656, 'recall': 0.45474613640708234, 'f1-score': 0.452170120037004, 'support': 599278}, 'weighted avg': {'precision': 0.4649862049632202, 'recall': 0.45899732678322913, 'f1-score': 0.4540571914498791, 'support': 599278}}
[[101490  30141  74854]
 [ 59890  60741  65943]
 [ 63179  30204 112836]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0827576
{'0': {'precision': 0.4673812359401879, 'recall': 0.4413014143635364, 'f1-score': 0.4539670706785085, 'support': 40018}, '1': {'precision': 0.5458440721649485, 'recall': 0.39672653195026575, 'f1-score': 0.4594898775543412, 'support': 42707}, '2': {'precision': 0.4351802732910165, 'recall': 0.5835602325410258, 'f1-score': 0.49856445292034296, 'support': 40767}, 'accuracy': 0.47284844362387846, 'macro avg': {'precision': 0.48280186046538426, 'recall': 0.4738627262849427, 'f1-score': 0.47067380038439754, 'support': 123492}, 'weighted avg': {'precision': 0.48388575204108575, 'recall': 0.47284844362387846, 'f1-score': 0.47059943548836697, 'support': 123492}}
[[17660  7313 15045]
 [ 9932 16943 15832]
 [10193  6784 23790]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0826539
{'0': {'precision': 0.45706959706959704, 'recall': 0.44653592900085887, 'f1-score': 0.45174136557816236, 'support': 13972}, '1': {'precision': 0.518667560921082, 'recall': 0.3742237277199774, 'f1-score': 0.43476223940032793, 'support': 12399}, '2': {'precision': 0.45362311101617986, 'recall': 0.568151417870519, 'f1-score': 0.5044686599958432, 'support': 14952}, 'accuracy': 0.46884301720591437, 'macro avg': {'precision': 0.4764534230022863, 'recall': 0.46297035819711846, 'f1-score': 0.46365742165811114, 'support': 41323}, 'weighted avg': {'precision': 0.47430506628344565, 'recall': 0.46884301720591437, 'f1-score': 0.4657252080062096, 'support': 41323}}
[[6239 2030 5703]
 [3230 4640 4529]
 [4181 2276 8495]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3344314
{'0': {'precision': 0.3970565893162647, 'recall': 0.31783380216154483, 'f1-score': 0.35305553679301527, 'support': 189124}, '1': {'precision': 0.5194174757281553, 'recall': 0.0014377952015264817, 'f1-score': 0.0028676524780403482, 'support': 148839}, '2': {'precision': 0.3597859814586279, 'recall': 0.7300189598085225, 'f1-score': 0.4820139421146757, 'support': 180909}, 'accuracy': 0.3707870149092647, 'macro avg': {'precision': 0.425420015501016, 'recall': 0.34976351905719794, 'f1-score': 0.2793123771285771, 'support': 518872}, 'weighted avg': {'precision': 0.4191612385857226, 'recall': 0.3707870149092647, 'f1-score': 0.29756617069652075, 'support': 518872}}
[[ 60110    108 128906]
 [ 42527    214 106098]
 [ 48752     90 132067]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3772155
{'0': {'precision': 0.35680504466631635, 'recall': 0.38171532974948175, 'f1-score': 0.3688400753704867, 'support': 28461}, '1': {'precision': 0.6378737541528239, 'recall': 0.0069306573295310975, 'f1-score': 0.013712326810455647, 'support': 27703}, '2': {'precision': 0.352388570578168, 'recall': 0.6683956105994848, 'f1-score': 0.46147849495109444, 'support': 28341}, 'accuracy': 0.3549967457546891, 'macro avg': {'precision': 0.44902245646576944, 'recall': 0.3523471992261659, 'f1-score': 0.28134363237734555, 'support': 84505}, 'weighted avg': {'precision': 0.44746570577243444, 'recall': 0.3549967457546891, 'f1-score': 0.28348845630623565, 'support': 84505}}
[[10864    57 17540]
 [10238   192 17273]
 [ 9346    52 18943]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3428932
{'0': {'precision': 0.39048317594205556, 'recall': 0.34330162824439786, 'f1-score': 0.3653755415433449, 'support': 12406}, '1': {'precision': 0.6774193548387096, 'recall': 0.004016832440703902, 'f1-score': 0.007986309184255561, 'support': 10456}, '2': {'precision': 0.35444051230198853, 'recall': 0.7103774381491176, 'f1-score': 0.47291941875825627, 'support': 11843}, 'accuracy': 0.36634490707390865, 'macro avg': {'precision': 0.47411434769425126, 'recall': 0.3525652996114064, 'f1-score': 0.2820937564952856, 'support': 34705}, 'weighted avg': {'precision': 0.46463247492070714, 'recall': 0.36634490707390865, 'f1-score': 0.2943996108218223, 'support': 34705}}
[[4259   14 8133]
 [3224   42 7190]
 [3424    6 8413]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
2900/2900 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2085716
{'0': {'precision': 0.4153839333819829, 'recall': 0.46535251083987544, 'f1-score': 0.4389507386233624, 'support': 261765}, '1': {'precision': 0.4409748960418913, 'recall': 0.05301701191991667, 'f1-score': 0.09465406595949537, 'support': 216025}, '2': {'precision': 0.402434729998322, 'recall': 0.6436311955942441, 'f1-score': 0.49522604661984326, 'support': 264563}, 'accuracy': 0.4088984620524198, 'macro avg': {'precision': 0.41959785314073206, 'recall': 0.3873335727846787, 'f1-score': 0.342943617067567, 'support': 742353}, 'weighted avg': {'precision': 0.4182160194836289, 'recall': 0.4088984620524198, 'f1-score': 0.3588159181232245, 'support': 742353}}
[[121813   7669 132283]
 [ 84009  11453 120563]
 [ 87432   6850 170281]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1619431
{'0': {'precision': 0.42741215483706396, 'recall': 0.45696899449434947, 'f1-score': 0.4416966661449366, 'support': 58667}, '1': {'precision': 0.5477752765937066, 'recall': 0.18888521882741535, 'f1-score': 0.28090729347038523, 'support': 60550}, '2': {'precision': 0.40073830572665664, 'recall': 0.6451828380577203, 'f1-score': 0.49439573708525825, 'support': 58385}, 'accuracy': 0.42744451076001394, 'macro avg': {'precision': 0.45864191238580904, 'recall': 0.4303456837931617, 'f1-score': 0.40566656556686004, 'support': 177602}, 'weighted avg': {'precision': 0.4596788767323894, 'recall': 0.42744451076001394, 'f1-score': 0.40420293714079586, 'support': 177602}}
[[26809  4995 26863]
 [19646 11437 29467]
 [16269  4447 37669]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.149149
{'0': {'precision': 0.4331478905887807, 'recall': 0.4767079953058829, 'f1-score': 0.4538852048871723, 'support': 19599}, '1': {'precision': 0.5688433445982776, 'recall': 0.23928096482780759, 'f1-score': 0.3368624919302776, 'support': 21807}, '2': {'precision': 0.40253618377373523, 'recall': 0.6230923385232002, 'f1-score': 0.48909952606635065, 'support': 19461}, 'accuracy': 0.438447763155733, 'macro avg': {'precision': 0.4681758063202645, 'recall': 0.44636043288563026, 'f1-score': 0.4266157409612668, 'support': 60867}, 'weighted avg': {'precision': 0.47197642393620215, 'recall': 0.438447763155733, 'f1-score': 0.4232182031130909, 'support': 60867}}
[[ 9343  2049  8207]
 [ 6798  5218  9791]
 [ 5429  1906 12126]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/EXC
Evaluating performance on  test set...
7167/7167 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68637305
{'0': {'precision': 0.5757355217711227, 'recall': 0.40079943793019474, 'f1-score': 0.47259848964934514, 'support': 357251}, '1': {'precision': 0.7521657705081433, 'recall': 0.8643571683604757, 'f1-score': 0.8043682646274325, 'support': 1117501}, '2': {'precision': 0.5525556881463802, 'recall': 0.4632810285314079, 'f1-score': 0.5039955010929803, 'support': 359814}, 'accuracy': 0.6954238768188226, 'macro avg': {'precision': 0.6268189934752154, 'recall': 0.5761458782740262, 'f1-score': 0.5936540851232527, 'support': 1834566}, 'weighted avg': {'precision': 0.6786593472088646, 'recall': 0.6954238768188226, 'f1-score': 0.680849454500633, 'support': 1834566}}
[[143186 166962  47103]
 [ 63699 965920  87882]
 [ 41816 151303 166695]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6099698
{'0': {'precision': 0.5824984096692112, 'recall': 0.4306394485839837, 'f1-score': 0.49518787970966727, 'support': 68043}, '1': {'precision': 0.8019535416516619, 'recall': 0.8807810816715509, 'f1-score': 0.8395209774329461, 'support': 265478}, '2': {'precision': 0.5522884557520644, 'recall': 0.4845991375517029, 'f1-score': 0.516234375, 'support': 68178}, 'accuracy': 0.7372908570845335, 'macro avg': {'precision': 0.6455801356909792, 'recall': 0.5986732226024125, 'f1-score': 0.6169810773808712, 'support': 401699}, 'weighted avg': {'precision': 0.7224062891766876, 'recall': 0.7372908570845335, 'f1-score': 0.7263255476483103, 'support': 401699}}
[[ 29302  29291   9450]
 [ 14317 233828  17333]
 [  6685  28454  33039]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67165977
{'0': {'precision': 0.5646926747123211, 'recall': 0.41616679766681836, 'f1-score': 0.47918452891302277, 'support': 24173}, '1': {'precision': 0.7941023312140478, 'recall': 0.8458849329205367, 'f1-score': 0.8191761141822044, 'support': 77520}, '2': {'precision': 0.5182570977917981, 'recall': 0.5463274722533982, 'f1-score': 0.5319222130036222, 'support': 24057}, 'accuracy': 0.7059721669980119, 'macro avg': {'precision': 0.6256840345727223, 'recall': 0.6027930676135844, 'f1-score': 0.6100942853662831, 'support': 125750}, 'weighted avg': {'precision': 0.6972313299650991, 'recall': 0.7059721669980119, 'f1-score': 0.6988653094795001, 'support': 125750}}
[[10060  9343  4770]
 [ 4500 65573  7447]
 [ 3255  7659 13143]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/AAL
Evaluating performance on  test set...
6357/6357 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8842957
{'0': {'precision': 0.48132291747977973, 'recall': 0.4740544488436939, 'f1-score': 0.47766103406820787, 'support': 338189}, '1': {'precision': 0.7485485095295735, 'recall': 0.6168483027225332, 'f1-score': 0.6763467930574656, 'support': 946398}, '2': {'precision': 0.3856968381583605, 'recall': 0.5789151052172212, 'f1-score': 0.46295451176568764, 'support': 342577}, 'accuracy': 0.5791837823354007, 'macro avg': {'precision': 0.5385227550559046, 'recall': 0.5566059522611494, 'f1-score': 0.5389874462971204, 'support': 1627164}, 'weighted avg': {'precision': 0.6166150395332709, 'recall': 0.5791837823354007, 'f1-score': 0.590125228608577, 'support': 1627164}}
[[160320  98414  79455]
 [126198 583784 236416]
 [ 46564  97690 198323]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76827705
{'0': {'precision': 0.5448036889224463, 'recall': 0.45576773407627147, 'f1-score': 0.49632427452786737, 'support': 88657}, '1': {'precision': 0.7558463464151058, 'recall': 0.7747142711861755, 'f1-score': 0.7651640120068147, 'support': 255662}, '2': {'precision': 0.48317642078100115, 'recall': 0.5261748207993502, 'f1-score': 0.5037597540789784, 'support': 91099}, 'accuracy': 0.6577725312228709, 'macro avg': {'precision': 0.5946088187061844, 'recall': 0.5855522753539324, 'f1-score': 0.5884160135378869, 'support': 435418}, 'weighted avg': {'precision': 0.6558266723532434, 'recall': 0.6577725312228709, 'f1-score': 0.6557330948223185, 'support': 435418}}
[[ 40407  31665  16585]
 [ 22910 198065  34687]
 [ 10851  32314  47934]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.786248
{'0': {'precision': 0.5514026833943195, 'recall': 0.42613789388634526, 'f1-score': 0.4807443980250664, 'support': 29704}, '1': {'precision': 0.7507722075227583, 'recall': 0.7613593380614657, 'f1-score': 0.7560287100995933, 'support': 84600}, '2': {'precision': 0.46927042030134813, 'recall': 0.5568850199979833, 'f1-score': 0.509337391063771, 'support': 29753}, 'accuracy': 0.6500065946118551, 'macro avg': {'precision': 0.590481770406142, 'recall': 0.5814607506485981, 'f1-score': 0.5820368330628103, 'support': 144057}, 'weighted avg': {'precision': 0.6515226395051698, 'recall': 0.6500065946118551, 'f1-score': 0.6483154297929468, 'support': 144057}}
[[12658 11327  5719]
 [ 7169 64411 13020]
 [ 3129 10055 16569]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/WBA
Evaluating performance on  test set...
7458/7458 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95559186
{'0': {'precision': 0.5155047204882443, 'recall': 0.4322349289577966, 'f1-score': 0.4702117218961644, 'support': 530952}, '1': {'precision': 0.6031706604661005, 'recall': 0.6385486578713178, 'f1-score': 0.6203556794520694, 'support': 821419}, '2': {'precision': 0.4822351676560784, 'recall': 0.5147833894500561, 'f1-score': 0.4979780012090302, 'support': 556875}, 'accuracy': 0.5450748620135907, 'macro avg': {'precision': 0.5336368495368077, 'recall': 0.5285223254263901, 'f1-score': 0.5295151341857547, 'support': 1909246}, 'weighted avg': {'precision': 0.5435176043791929, 'recall': 0.5450748620135907, 'f1-score': 0.542907145253849, 'support': 1909246}}
[[229496 169450 132006]
 [121118 524516 175785]
 [ 94573 175632 286670]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74962777
{'0': {'precision': 0.563219394362713, 'recall': 0.43758196535974314, 'f1-score': 0.4925146176506143, 'support': 88452}, '1': {'precision': 0.7509568539091119, 'recall': 0.8101268879257265, 'f1-score': 0.7794205047691137, 'support': 248487}, '2': {'precision': 0.5057864399937202, 'recall': 0.5066500415627597, 'f1-score': 0.5062178724550496, 'support': 89022}, 'accuracy': 0.6693429680181988, 'macro avg': {'precision': 0.6066542294218483, 'recall': 0.5847862982827431, 'f1-score': 0.5927176649582592, 'support': 425961}, 'weighted avg': {'precision': 0.6607342411361724, 'recall': 0.6693429680181988, 'f1-score': 0.6627468086765885, 'support': 425961}}
[[ 38705  33972  15775]
 [ 18885 201306  28296]
 [ 11131  32788  45103]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83530676
{'0': {'precision': 0.539133134143029, 'recall': 0.4292511122095897, 'f1-score': 0.4779579972135744, 'support': 32368}, '1': {'precision': 0.7036075277824314, 'recall': 0.7517825710790895, 'f1-score': 0.726897725469834, 'support': 67038}, '2': {'precision': 0.4978433402346446, 'recall': 0.5283347065824407, 'f1-score': 0.5126360204308239, 'support': 32769}, 'accuracy': 0.6174011726877247, 'macro avg': {'precision': 0.5801946673867017, 'recall': 0.5697894632903733, 'f1-score': 0.5724972477047441, 'support': 132175}, 'weighted avg': {'precision': 0.6123164830684265, 'recall': 0.6174011726877247, 'f1-score': 0.6128154637968857, 'support': 132175}}
[[13894 10801  7673]
 [ 6850 50398  9790]
 [ 5027 10429 17313]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
8238/8238 - 65s - 65s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9876935
{'0': {'precision': 0.5097582492153703, 'recall': 0.4580679486436797, 'f1-score': 0.4825327440790868, 'support': 655966}, '1': {'precision': 0.5695693745805693, 'recall': 0.6005395136111971, 'f1-score': 0.5846445892861063, 'support': 798497}, '2': {'precision': 0.4888092313506874, 'recall': 0.5060665254353867, 'f1-score': 0.49728820432715776, 'support': 654246}, 'accuracy': 0.5269091183278489, 'macro avg': {'precision': 0.5227122850488756, 'recall': 0.5215579958967546, 'f1-score': 0.521488512564117, 'support': 2108709}, 'weighted avg': {'precision': 0.5259070838951854, 'recall': 0.5269091183278489, 'f1-score': 0.525777071725874, 'support': 2108709}}
[[300477 181810 173679]
 [146395 479529 172573]
 [142578 180576 331092]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86431026
{'0': {'precision': 0.5422568890913232, 'recall': 0.4161510766219239, 'f1-score': 0.47090758064197136, 'support': 114432}, '1': {'precision': 0.6721422024842961, 'recall': 0.7729453903565522, 'f1-score': 0.7190279947709083, 'support': 233402}, '2': {'precision': 0.5124889081881171, 'recall': 0.4748701082868289, 'f1-score': 0.49296286207209666, 'support': 114326}, 'accuracy': 0.6108663666262766, 'macro avg': {'precision': 0.5756293332545788, 'recall': 0.554655525088435, 'f1-score': 0.5609661458283255, 'support': 462160}, 'weighted avg': {'precision': 0.6004883191843791, 'recall': 0.6108663666262766, 'f1-score': 0.6016702883693874, 'support': 462160}}
[[ 47621  45121  21690]
 [ 23041 180407  29954]
 [ 17158  42878  54290]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85706854
{'0': {'precision': 0.5321693887950224, 'recall': 0.4633292082097742, 'f1-score': 0.4953690990338767, 'support': 42827}, '1': {'precision': 0.6808169532476037, 'recall': 0.7609757328723041, 'f1-score': 0.7186680650235971, 'support': 79243}, '2': {'precision': 0.5223857313712236, 'recall': 0.4755277856669507, 'f1-score': 0.4978566295809897, 'support': 42252}, 'accuracy': 0.6100035296551892, 'macro avg': {'precision': 0.5784573578046165, 'recall': 0.566610908916343, 'f1-score': 0.5706312645461545, 'support': 164322}, 'weighted avg': {'precision': 0.6013378498437288, 'recall': 0.6100035296551892, 'f1-score': 0.6036928968369708, 'support': 164322}}
[[19843 14367  8617]
 [ 9188 60302  9753]
 [ 8256 13904 20092]]
testing model on single stock: results/universal/W5/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
31315/31315 - 242s - 242s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0030988
{'0': {'precision': 0.5339674037410267, 'recall': 0.5019922794787883, 'f1-score': 0.5174863819762238, 'support': 3137612}, '1': {'precision': 0.4726042465014619, 'recall': 0.15820687394287233, 'f1-score': 0.23705745833540975, 'support': 1683808}, '2': {'precision': 0.4974706268492849, 'recall': 0.7011309017261329, 'f1-score': 0.5819983053077797, 'support': 3195061}, 'accuracy': 0.509151459349807, 'macro avg': {'precision': 0.5013474256972579, 'recall': 0.45377668504926455, 'f1-score': 0.4455140485398044, 'support': 8016481}, 'weighted avg': {'precision': 0.5065322730973262, 'recall': 0.509151459349807, 'f1-score': 0.4842961411727905, 'support': 8016481}}
[[1575057  149831 1412724]
 [ 567206  266390  850212]
 [ 807462  147443 2240156]]
Evaluating performance on  train set...
5759/5759 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98972327
{'0': {'precision': 0.516356039249475, 'recall': 0.5065133014950848, 'f1-score': 0.5113873136461359, 'support': 487464}, '1': {'precision': 0.5624314119375778, 'recall': 0.42557991310099946, 'f1-score': 0.48452786997825337, 'support': 497359}, '2': {'precision': 0.47924984426893547, 'recall': 0.6068707749903954, 'f1-score': 0.5355624766682957, 'support': 489348}, 'accuracy': 0.5125212746689495, 'macro avg': {'precision': 0.519345765151996, 'recall': 0.5129879965288265, 'f1-score': 0.510492553430895, 'support': 1474171}, 'weighted avg': {'precision': 0.5195837238148647, 'recall': 0.5125212746689495, 'f1-score': 0.510350311582843, 'support': 1474171}}
[[246907  80444 160113]
 [123119 211666 162574]
 [108146  84231 296971]]
Evaluating performance on  val set...
2129/2129 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9916444
{'0': {'precision': 0.5079652516838447, 'recall': 0.5247557680315943, 'f1-score': 0.5162240153767115, 'support': 192440}, '1': {'precision': 0.5460269434255676, 'recall': 0.40347853239656517, 'f1-score': 0.4640524049460041, 'support': 160125}, '2': {'precision': 0.4955446500684763, 'recall': 0.58684125713454, 'f1-score': 0.5373426307146767, 'support': 192374}, 'accuracy': 0.5110370151521546, 'macro avg': {'precision': 0.5165122817259629, 'recall': 0.5050251858542332, 'f1-score': 0.5058730170124641, 'support': 544939}, 'weighted avg': {'precision': 0.5147645954177094, 'recall': 0.5110370151521546, 'f1-score': 0.5083491768843457, 'support': 544939}}
[[100984  26467  64989]
 [ 45584  64607  49934]
 [ 52233  27248 112893]]
training model: results/universal/W5/deepOF_L2/h30
Epoch 1/50
9913/9913 - 225s - loss: 2.7996 - accuracy30: 0.5336 - val_loss: 3.0965 - val_accuracy30: 0.5172 - 225s/epoch - 23ms/step
Epoch 2/50
9913/9913 - 226s - loss: 2.7302 - accuracy30: 0.5521 - val_loss: 3.0201 - val_accuracy30: 0.5268 - 226s/epoch - 23ms/step
Epoch 3/50
9913/9913 - 224s - loss: 2.7115 - accuracy30: 0.5567 - val_loss: 3.0110 - val_accuracy30: 0.5280 - 224s/epoch - 23ms/step
Epoch 4/50
9913/9913 - 223s - loss: 2.7004 - accuracy30: 0.5592 - val_loss: 3.0063 - val_accuracy30: 0.5284 - 223s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 219s - loss: 2.6925 - accuracy30: 0.5609 - val_loss: 2.9931 - val_accuracy30: 0.5313 - 219s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 220s - loss: 2.6867 - accuracy30: 0.5623 - val_loss: 2.9768 - val_accuracy30: 0.5316 - 220s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 221s - loss: 2.6811 - accuracy30: 0.5634 - val_loss: 2.9761 - val_accuracy30: 0.5308 - 221s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 222s - loss: 2.6765 - accuracy30: 0.5646 - val_loss: 2.9633 - val_accuracy30: 0.5317 - 222s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 222s - loss: 2.6719 - accuracy30: 0.5655 - val_loss: 2.9515 - val_accuracy30: 0.5327 - 222s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 222s - loss: 2.6683 - accuracy30: 0.5663 - val_loss: 2.9480 - val_accuracy30: 0.5327 - 222s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 224s - loss: 2.6647 - accuracy30: 0.5670 - val_loss: 2.9413 - val_accuracy30: 0.5332 - 224s/epoch - 23ms/step
Epoch 12/50
9913/9913 - 221s - loss: 2.6614 - accuracy30: 0.5679 - val_loss: 2.9394 - val_accuracy30: 0.5325 - 221s/epoch - 22ms/step
Epoch 13/50
9913/9913 - 224s - loss: 2.6583 - accuracy30: 0.5686 - val_loss: 2.9326 - val_accuracy30: 0.5319 - 224s/epoch - 23ms/step
Epoch 14/50
9913/9913 - 225s - loss: 2.6559 - accuracy30: 0.5692 - val_loss: 2.9285 - val_accuracy30: 0.5334 - 225s/epoch - 23ms/step
Epoch 15/50
9913/9913 - 223s - loss: 2.6531 - accuracy30: 0.5699 - val_loss: 2.9287 - val_accuracy30: 0.5335 - 223s/epoch - 22ms/step
Epoch 16/50
9913/9913 - 221s - loss: 2.6509 - accuracy30: 0.5705 - val_loss: 2.9194 - val_accuracy30: 0.5337 - 221s/epoch - 22ms/step
Epoch 17/50
9913/9913 - 221s - loss: 2.6481 - accuracy30: 0.5711 - val_loss: 2.9212 - val_accuracy30: 0.5327 - 221s/epoch - 22ms/step
Epoch 18/50
9913/9913 - 226s - loss: 2.6462 - accuracy30: 0.5711 - val_loss: 2.9243 - val_accuracy30: 0.5342 - 226s/epoch - 23ms/step
Epoch 19/50
9913/9913 - 224s - loss: 2.6440 - accuracy30: 0.5718 - val_loss: 2.9167 - val_accuracy30: 0.5355 - 224s/epoch - 23ms/step
Epoch 20/50
9913/9913 - 221s - loss: 2.6420 - accuracy30: 0.5726 - val_loss: 2.9178 - val_accuracy30: 0.5346 - 221s/epoch - 22ms/step
Epoch 21/50
9913/9913 - 221s - loss: 2.6400 - accuracy30: 0.5727 - val_loss: 2.9102 - val_accuracy30: 0.5339 - 221s/epoch - 22ms/step
Epoch 22/50
9913/9913 - 220s - loss: 2.6383 - accuracy30: 0.5732 - val_loss: 2.9209 - val_accuracy30: 0.5336 - 220s/epoch - 22ms/step
Epoch 23/50
9913/9913 - 219s - loss: 2.6365 - accuracy30: 0.5736 - val_loss: 2.9108 - val_accuracy30: 0.5347 - 219s/epoch - 22ms/step
Epoch 24/50
9913/9913 - 219s - loss: 2.6351 - accuracy30: 0.5739 - val_loss: 2.9119 - val_accuracy30: 0.5355 - 219s/epoch - 22ms/step
Epoch 25/50
9913/9913 - 220s - loss: 2.6332 - accuracy30: 0.5742 - val_loss: 2.9079 - val_accuracy30: 0.5358 - 220s/epoch - 22ms/step
Epoch 26/50
9913/9913 - 218s - loss: 2.6317 - accuracy30: 0.5747 - val_loss: 2.9066 - val_accuracy30: 0.5373 - 218s/epoch - 22ms/step
Epoch 27/50
9913/9913 - 226s - loss: 2.6304 - accuracy30: 0.5749 - val_loss: 2.9092 - val_accuracy30: 0.5349 - 226s/epoch - 23ms/step
Epoch 28/50
9913/9913 - 223s - loss: 2.6287 - accuracy30: 0.5753 - val_loss: 2.9081 - val_accuracy30: 0.5364 - 223s/epoch - 23ms/step
Epoch 29/50
9913/9913 - 220s - loss: 2.6271 - accuracy30: 0.5755 - val_loss: 2.9146 - val_accuracy30: 0.5334 - 220s/epoch - 22ms/step
Epoch 30/50
9913/9913 - 221s - loss: 2.6257 - accuracy30: 0.5761 - val_loss: 2.9096 - val_accuracy30: 0.5344 - 221s/epoch - 22ms/step
Epoch 31/50
9913/9913 - 228s - loss: 2.6244 - accuracy30: 0.5764 - val_loss: 2.9088 - val_accuracy30: 0.5348 - 228s/epoch - 23ms/step
Epoch 32/50
9913/9913 - 228s - loss: 2.6228 - accuracy30: 0.5767 - val_loss: 2.9101 - val_accuracy30: 0.5344 - 228s/epoch - 23ms/step
Epoch 33/50
9913/9913 - 229s - loss: 2.6217 - accuracy30: 0.5769 - val_loss: 2.9074 - val_accuracy30: 0.5356 - 229s/epoch - 23ms/step
Epoch 34/50
9913/9913 - 230s - loss: 2.6201 - accuracy30: 0.5770 - val_loss: 2.9027 - val_accuracy30: 0.5355 - 230s/epoch - 23ms/step
Epoch 35/50
9913/9913 - 228s - loss: 2.6191 - accuracy30: 0.5772 - val_loss: 2.9089 - val_accuracy30: 0.5354 - 228s/epoch - 23ms/step
Epoch 36/50
9913/9913 - 222s - loss: 2.6173 - accuracy30: 0.5779 - val_loss: 2.9075 - val_accuracy30: 0.5346 - 222s/epoch - 22ms/step
Epoch 37/50
9913/9913 - 225s - loss: 2.6165 - accuracy30: 0.5779 - val_loss: 2.9068 - val_accuracy30: 0.5348 - 225s/epoch - 23ms/step
Epoch 38/50
9913/9913 - 225s - loss: 2.6149 - accuracy30: 0.5781 - val_loss: 2.9186 - val_accuracy30: 0.5339 - 225s/epoch - 23ms/step
Epoch 39/50
9913/9913 - 226s - loss: 2.6138 - accuracy30: 0.5783 - val_loss: 2.9042 - val_accuracy30: 0.5351 - 226s/epoch - 23ms/step
Epoch 40/50
9913/9913 - 230s - loss: 2.6125 - accuracy30: 0.5788 - val_loss: 2.9095 - val_accuracy30: 0.5332 - 230s/epoch - 23ms/step
Epoch 41/50
9913/9913 - 230s - loss: 2.6114 - accuracy30: 0.5788 - val_loss: 2.9087 - val_accuracy30: 0.5336 - 230s/epoch - 23ms/step
Epoch 42/50
9913/9913 - 228s - loss: 2.6101 - accuracy30: 0.5795 - val_loss: 2.9111 - val_accuracy30: 0.5342 - 228s/epoch - 23ms/step
Epoch 43/50
9913/9913 - 227s - loss: 2.6092 - accuracy30: 0.5795 - val_loss: 2.9068 - val_accuracy30: 0.5334 - 227s/epoch - 23ms/step
Epoch 44/50
9913/9913 - 225s - loss: 2.6079 - accuracy30: 0.5795 - val_loss: 2.9142 - val_accuracy30: 0.5346 - 225s/epoch - 23ms/step
testing model in sample: results/universal/W5/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 382s - 382s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0125945
{'0': {'precision': 0.4942190656610338, 'recall': 0.5660105345588378, 'f1-score': 0.5276841874363056, 'support': 4441382}, '1': {'precision': 0.6231535519469297, 'recall': 0.4082594598404053, 'f1-score': 0.49331999811524463, 'support': 3859526}, '2': {'precision': 0.49777006524868533, 'recall': 0.5730027693920252, 'f1-score': 0.5327434852298066, 'support': 4537458}, 'accuracy': 0.5210579757579742, 'macro avg': {'precision': 0.5383808942855496, 'recall': 0.5157575879304227, 'f1-score': 0.5179158902604523, 'support': 12838366}, 'weighted avg': {'precision': 0.5342349456884489, 'recall': 0.5210579757579742, 'f1-score': 0.5191415792176232, 'support': 12838366}}
[[2513869  482632 1444881]
 [1105448 1575688 1178390]
 [1467231  470251 2599976]]
Evaluating performance on  train set...
9913/9913 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.935525
{'0': {'precision': 0.48578582026282324, 'recall': 0.5542554229316464, 'f1-score': 0.5177668232405336, 'support': 727789}, '1': {'precision': 0.6937904574318571, 'recall': 0.5631453314089042, 'f1-score': 0.6216783077505259, 'support': 1080840}, '2': {'precision': 0.47944346576282304, 'recall': 0.5458904965286787, 'f1-score': 0.5105139226984665, 'support': 728397}, 'accuracy': 0.5556411325701825, 'macro avg': {'precision': 0.5530065811525011, 'recall': 0.5544304169564098, 'f1-score': 0.5499863512298421, 'support': 2537026}, 'weighted avg': {'precision': 0.5725803505699788, 'recall': 0.5556411325701825, 'f1-score': 0.5599535008392811, 'support': 2537026}}
[[403381 133078 191330]
 [231778 608670 240392]
 [195209 135563 397625]]
Evaluating performance on  val set...
3496/3496 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9704743
{'0': {'precision': 0.4762230167543228, 'recall': 0.5613818053662554, 'f1-score': 0.5153078150815278, 'support': 278071}, '1': {'precision': 0.6725410459254292, 'recall': 0.512056758642186, 'f1-score': 0.5814280369295487, 'support': 336865}, '2': {'precision': 0.4840517519519907, 'recall': 0.537190141828481, 'f1-score': 0.5092384690973336, 'support': 279281}, 'accuracy': 0.5352448007586526, 'macro avg': {'precision': 0.5442719382105808, 'recall': 0.5368762352789741, 'f1-score': 0.5353247737028034, 'support': 894217}, 'weighted avg': {'precision': 0.5526240356249824, 'recall': 0.5352448007586526, 'f1-score': 0.5383207252778469, 'support': 894217}}
[[156104  42809  79158]
 [ 83616 172494  80755]
 [ 88076  41178 150027]]
testing model out of sample: results/universal/W5/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0590416
{'0': {'precision': 0.4551060622861041, 'recall': 0.5648267794957678, 'f1-score': 0.5040647402646062, 'support': 1714924}, '1': {'precision': 0.5771111468553964, 'recall': 0.41027312281664696, 'f1-score': 0.4795968493832771, 'support': 1923933}, '2': {'precision': 0.4485571652722206, 'recall': 0.4860020281152447, 'f1-score': 0.4665294474451598, 'support': 1709962}, 'accuracy': 0.48403544782502456, 'macro avg': {'precision': 0.49359145813790706, 'recall': 0.4870339768092198, 'f1-score': 0.4833970123643477, 'support': 5348819}, 'weighted avg': {'precision': 0.496896828310342, 'recall': 0.48403544782502456, 'f1-score': 0.483264165953321, 'support': 5348819}}
[[968635 284719 461570]
 [574503 789338 560092]
 [585234 293683 831045]]
Evaluating performance on  train set...
4957/4957 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97340685
{'0': {'precision': 0.46986252018612806, 'recall': 0.519326139923425, 'f1-score': 0.4933576348841885, 'support': 359125}, '1': {'precision': 0.6435022439039944, 'recall': 0.5883965014577259, 'f1-score': 0.6147168676304297, 'support': 548800}, '2': {'precision': 0.47175498166962027, 'recall': 0.4837839712553584, 'f1-score': 0.47769376181474477, 'support': 360415}, 'accuracy': 0.5391125408013624, 'macro avg': {'precision': 0.528373248586581, 'recall': 0.5305022042121698, 'f1-score': 0.5285894214431209, 'support': 1268340}, 'weighted avg': {'precision': 0.5455327283968112, 'recall': 0.5391125408013624, 'f1-score': 0.5414176598923199, 'support': 1268340}}
[[186503  89020  83602]
 [114248 322912 111640]
 [ 96180  89872 174363]]
Evaluating performance on  val set...
1701/1701 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9687918
{'0': {'precision': 0.46881424681891426, 'recall': 0.53532878092111, 'f1-score': 0.49986854919037405, 'support': 126087}, '1': {'precision': 0.6484350008612416, 'recall': 0.575434822959089, 'f1-score': 0.609757790671441, 'support': 183178}, '2': {'precision': 0.47256842334562543, 'recall': 0.4828345455268074, 'f1-score': 0.47764632799015505, 'support': 125805}, 'accuracy': 0.5370354195876526, 'macro avg': {'precision': 0.5299392236752604, 'recall': 0.5311993831356688, 'f1-score': 0.5290908892839901, 'support': 435070}, 'weighted avg': {'precision': 0.5455257292514155, 'recall': 0.5370354195876526, 'f1-score': 0.5397095516449798, 'support': 435070}}
[[ 67498  28800  29789]
 [ 39765 105407  38006]
 [ 36713  28349  60743]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1308248
{'0': {'precision': 0.43745833024668496, 'recall': 0.6679202601442104, 'f1-score': 0.5286646299839975, 'support': 106095}, '1': {'precision': 0.46149936467598474, 'recall': 0.05606149476738802, 'f1-score': 0.09997797841885048, 'support': 64786}, '2': {'precision': 0.44508510994805683, 'recall': 0.4496186550371388, 'f1-score': 0.447340396550614, 'support': 100434}, 'accuracy': 0.44100768479442715, 'macro avg': {'precision': 0.44801426829024216, 'recall': 0.39120013664957903, 'f1-score': 0.358661001651154, 'support': 271315}, 'weighted avg': {'precision': 0.4460222152108933, 'recall': 0.44100768479442715, 'f1-score': 0.39619642340143457, 'support': 271315}}
[[70863  2144 33088]
 [37942  3632 23212]
 [53183  2094 45157]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2101707
{'0': {'precision': 0.39340506589785834, 'recall': 0.6550792970424346, 'f1-score': 0.49158866480105506, 'support': 23330}, '1': {'precision': 0.5963883677298312, 'recall': 0.11123261306972268, 'f1-score': 0.18749539187495393, 'support': 22862}, '2': {'precision': 0.42020635637897275, 'recall': 0.4753365138865224, 'f1-score': 0.44607451231212025, 'support': 23476}, 'accuracy': 0.4160446690015502, 'macro avg': {'precision': 0.4699999300022208, 'recall': 0.41388280799955995, 'f1-score': 0.37505285632937646, 'support': 69668}, 'weighted avg': {'precision': 0.4690465561346558, 'recall': 0.4160446690015502, 'f1-score': 0.37646162441713765, 'support': 69668}}
[[15283   875  7172]
 [12094  2543  8225]
 [11471   846 11159]]
Evaluating performance on  val set...
96/96 - 1s - 953ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.180493
{'0': {'precision': 0.40002957704821057, 'recall': 0.644969003338102, 'f1-score': 0.49379335523913837, 'support': 8388}, '1': {'precision': 0.6020629750271445, 'recall': 0.13850380916697888, 'f1-score': 0.22520052797238296, 'support': 8007}, '2': {'precision': 0.4090859332238643, 'recall': 0.4610165309647175, 'f1-score': 0.4335015370338148, 'support': 8106}, 'accuracy': 0.41859515938124975, 'macro avg': {'precision': 0.4703928284330731, 'recall': 0.4148297811565995, 'f1-score': 0.3841651400817787, 'support': 24501}, 'weighted avg': {'precision': 0.4690509329429566, 'recall': 0.41859515938124975, 'f1-score': 0.3860692522924316, 'support': 24501}}
[[5410  350 2628]
 [4128 1109 2770]
 [3986  383 3737]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8105128
{'0': {'precision': 0.49061229697952935, 'recall': 0.45627463445645267, 'f1-score': 0.4728208596663051, 'support': 117975}, '1': {'precision': 0.7505035176409617, 'recall': 0.7494452846092821, 'f1-score': 0.749974027826664, 'support': 322688}, '2': {'precision': 0.46220039292730847, 'recall': 0.4961700045555012, 'f1-score': 0.47858316923527594, 'support': 118538}, 'accuracy': 0.6339062340732581, 'macro avg': {'precision': 0.5677720691825998, 'recall': 0.5672966412070787, 'f1-score': 0.567126018909415, 'support': 559201}, 'weighted avg': {'precision': 0.634560337004948, 'recall': 0.6339062340732581, 'f1-score': 0.6339741018440133, 'support': 559201}}
[[ 53829  41150  22996]
 [ 35412 241837  45439]
 [ 20477  39246  58815]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.58734345
{'0': {'precision': 0.5500431158378845, 'recall': 0.4726572148396977, 'f1-score': 0.5084223391253521, 'support': 20243}, '1': {'precision': 0.8447750804837727, 'recall': 0.8851792421866452, 'f1-score': 0.8645053291424398, 'support': 109684}, '2': {'precision': 0.5403212632725293, 'recall': 0.47791744930886676, 'f1-score': 0.5072071151093845, 'support': 20763}, 'accuracy': 0.773647886389276, 'macro avg': {'precision': 0.6450464865313954, 'recall': 0.6119179687784032, 'f1-score': 0.6267115944590588, 'support': 150690}, 'weighted avg': {'precision': 0.7632326173668853, 'recall': 0.773647886389276, 'f1-score': 0.7674400243120979, 'support': 150690}}
[[ 9568  8812  1863]
 [ 6015 97090  6579]
 [ 1812  9028  9923]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66431785
{'0': {'precision': 0.5218172484599589, 'recall': 0.4491328841268088, 'f1-score': 0.48275452656574647, 'support': 9053}, '1': {'precision': 0.8001782187755888, 'recall': 0.8716583151874492, 'f1-score': 0.83439018571303, 'support': 38117}, '2': {'precision': 0.5769020998091082, 'recall': 0.4464021945558135, 'f1-score': 0.5033309540804187, 'support': 9478}, 'accuracy': 0.7329826295720944, 'macro avg': {'precision': 0.632965855681552, 'recall': 0.5890644646233572, 'f1-score': 0.6068252221197318, 'support': 56648}, 'weighted avg': {'precision': 0.718335736784491, 'recall': 0.7329826295720944, 'f1-score': 0.7228039510767807, 'support': 56648}}
[[ 4066  4155   832]
 [ 2621 33225  2271]
 [ 1105  4142  4231]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1233917
{'0': {'precision': 0.420027691309362, 'recall': 0.6107701075329092, 'f1-score': 0.49775107877791164, 'support': 214074}, '1': {'precision': 0.47492782534352657, 'recall': 0.22353112698644118, 'f1-score': 0.30398680318182897, 'support': 171475}, '2': {'precision': 0.45682210708117443, 'recall': 0.44304235737780084, 'f1-score': 0.4498267266175943, 'support': 213729}, 'accuracy': 0.44014797806694056, 'macro avg': {'precision': 0.45059254124468767, 'recall': 0.4257811972990504, 'f1-score': 0.4171882028591116, 'support': 599278}, 'weighted avg': {'precision': 0.448859108735001, 'recall': 0.44014797806694056, 'f1-score': 0.42521620678075717, 'support': 599278}}
[[130750  21013  62311]
 [ 82865  38330  50280]
 [ 97674  21364  94691]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1176746
{'0': {'precision': 0.42720397293250184, 'recall': 0.5506205413857129, 'f1-score': 0.481123717832403, 'support': 40932}, '1': {'precision': 0.5467971028125294, 'recall': 0.2813309134906231, 'f1-score': 0.3715148513269529, 'support': 41325}, '2': {'precision': 0.42906231681927515, 'recall': 0.5147811325330424, 'f1-score': 0.46802928076906114, 'support': 41235}, 'accuracy': 0.448539176626826, 'macro avg': {'precision': 0.46768779752143547, 'recall': 0.4489108624697928, 'f1-score': 0.44022261664280565, 'support': 123492}, 'weighted avg': {'precision': 0.467844782883456, 'recall': 0.448539176626826, 'f1-score': 0.44007218801148645, 'support': 123492}}
[[22538  5004 13390]
 [14843 11626 14856]
 [15376  4632 21227]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1023945
{'0': {'precision': 0.4247149297268629, 'recall': 0.5594132029339853, 'f1-score': 0.48284594513114265, 'support': 14315}, '1': {'precision': 0.5137173110861544, 'recall': 0.26903041505629305, 'f1-score': 0.35312930796801767, 'support': 11902}, '2': {'precision': 0.45457345241761626, 'recall': 0.48854759698133193, 'f1-score': 0.4709485976835455, 'support': 15106}, 'accuracy': 0.44987053214916634, 'macro avg': {'precision': 0.4643352310768778, 'recall': 0.4389970716572034, 'f1-score': 0.4356412835942353, 'support': 41323}, 'weighted avg': {'precision': 0.46126477331771565, 'recall': 0.44987053214916634, 'f1-score': 0.44113530587312855, 'support': 41323}}
[[8008 1466 4841]
 [4686 3202 4014]
 [6161 1565 7380]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3247604
{'0': {'precision': 0.39510723320603924, 'recall': 0.517233560090703, 'f1-score': 0.44799645560138307, 'support': 189630}, '1': {'precision': 0.6285714285714286, 'recall': 0.0014594763133628323, 'f1-score': 0.002912190827922615, 'support': 150739}, '2': {'precision': 0.3761534420115585, 'recall': 0.5695478507364022, 'f1-score': 0.45307622203257275, 'support': 178503}, 'accuracy': 0.38539177292280175, 'macro avg': {'precision': 0.46661070126300874, 'recall': 0.362746962380156, 'f1-score': 0.3013282894872928, 'support': 518872}, 'weighted avg': {'precision': 0.45641108223931726, 'recall': 0.38539177292280175, 'f1-score': 0.32044129085859485, 'support': 518872}}
[[ 98083     72  91475]
 [ 73382    220  77137]
 [ 76779     58 101666]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3901591
{'0': {'precision': 0.3620482847360042, 'recall': 0.5858418322334756, 'f1-score': 0.44752662083838796, 'support': 28337}, '1': {'precision': 0.6884615384615385, 'recall': 0.006414621035656693, 'f1-score': 0.012710811290608913, 'support': 27905}, '2': {'precision': 0.37617211919149823, 'recall': 0.5109860948943848, 'f1-score': 0.43333583377090984, 'support': 28263}, 'accuracy': 0.36946926217383586, 'macro avg': {'precision': 0.47556064746301363, 'recall': 0.3677475160545057, 'f1-score': 0.2978577552999689, 'support': 84505}, 'weighted avg': {'precision': 0.4745593051303792, 'recall': 0.36946926217383586, 'f1-score': 0.29919682520121965, 'support': 84505}}
[[16601    45 11691]
 [15467   179 12259]
 [13785    36 14442]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3168972
{'0': {'precision': 0.3901290644214258, 'recall': 0.5650673940949936, 'f1-score': 0.46157879214863845, 'support': 12464}, '1': {'precision': 0.5660377358490566, 'recall': 0.002898550724637681, 'f1-score': 0.005767567047966933, 'support': 10350}, '2': {'precision': 0.3824326766672691, 'recall': 0.5338491295938105, 'f1-score': 0.4456300456300456, 'support': 11891}, 'accuracy': 0.3867166114392739, 'macro avg': {'precision': 0.44619982564591715, 'recall': 0.3672716914711473, 'f1-score': 0.30432546827555035, 'support': 34705}, 'weighted avg': {'precision': 0.4399529227268948, 'recall': 0.3867166114392739, 'f1-score': 0.32017862719705975, 'support': 34705}}
[[7043   19 5402]
 [5471   30 4849]
 [5539    4 6348]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
2900/2900 - 25s - 25s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2384872
{'0': {'precision': 0.3907124571272747, 'recall': 0.633933305108342, 'f1-score': 0.4834561336657136, 'support': 262179}, '1': {'precision': 0.43628274009402285, 'recall': 0.02404827238358776, 'f1-score': 0.04558392063819243, 'support': 216107}, '2': {'precision': 0.4136284067738827, 'recall': 0.4778294902430065, 'f1-score': 0.44341712922208115, 'support': 264067}, 'accuracy': 0.40086050706335125, 'macro avg': {'precision': 0.4135412013317268, 'recall': 0.3786036892449787, 'f1-score': 0.3241523945086624, 'support': 742353}, 'weighted avg': {'precision': 0.41213003504024315, 'recall': 0.40086050706335125, 'f1-score': 0.3417442659597096, 'support': 742353}}
[[166204   3603  92372]
 [124407   5197  86503]
 [134776   3112 126179]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2180411
{'0': {'precision': 0.3976395975927022, 'recall': 0.5973431288683138, 'f1-score': 0.4774500603298029, 'support': 59619}, '1': {'precision': 0.5274699547370064, 'recall': 0.1142726719415703, 'f1-score': 0.1878491426030405, 'support': 59148}, '2': {'precision': 0.4047881744586385, 'recall': 0.51756607461545, 'f1-score': 0.4542823469737882, 'support': 58835}, 'accuracy': 0.41003479690544026, 'macro avg': {'precision': 0.4432992422627824, 'recall': 0.4097272918084447, 'f1-score': 0.37319384996887717, 'support': 177602}, 'weighted avg': {'precision': 0.4432460236705542, 'recall': 0.41003479690544026, 'f1-score': 0.37332742940783314, 'support': 177602}}
[[35613  3251 20755]
 [28368  6759 24021]
 [25580  2804 30451]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2087047
{'0': {'precision': 0.39125052933320303, 'recall': 0.6053016176989366, 'f1-score': 0.4752878793874401, 'support': 19843}, '1': {'precision': 0.5475247524752476, 'recall': 0.15587710232077423, 'f1-score': 0.24266803188766184, 'support': 21286}, '2': {'precision': 0.40525966484154635, 'recall': 0.49498429425473706, 'f1-score': 0.4456506864936368, 'support': 19738}, 'accuracy': 0.412358092233887, 'macro avg': {'precision': 0.44801164888333234, 'recall': 0.41872100475814933, 'f1-score': 0.38786886592291286, 'support': 60867}, 'weighted avg': {'precision': 0.450444598869491, 'recall': 0.412358092233887, 'f1-score': 0.3843268498111809, 'support': 60867}}
[[12011  1427  6405]
 [10035  3318  7933]
 [ 8653  1315  9770]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/EXC
Evaluating performance on  test set...
7167/7167 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7716349
{'0': {'precision': 0.5780883220997433, 'recall': 0.3998623194426311, 'f1-score': 0.47273497761182504, 'support': 421265}, '1': {'precision': 0.6840154505246038, 'recall': 0.8361758228436345, 'f1-score': 0.7524805492573352, 'support': 989860}, '2': {'precision': 0.5663480646730027, 'recall': 0.4455473135572606, 'f1-score': 0.49873705164011456, 'support': 423441}, 'accuracy': 0.6458246800605701, 'macro avg': {'precision': 0.6094839457657831, 'recall': 0.5605284852811754, 'f1-score': 0.5746508595030916, 'support': 1834566}, 'weighted avg': {'precision': 0.6325326544364355, 'recall': 0.6458246800605701, 'f1-score': 0.629676344549639, 'support': 1834566}}
[[168448 199908  52909]
 [ 70613 827697  91550]
 [ 52327 182451 188663]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6860868
{'0': {'precision': 0.5948784082535004, 'recall': 0.4399019110015729, 'f1-score': 0.5057849356715153, 'support': 80743}, '1': {'precision': 0.7468453081127933, 'recall': 0.8545587132261022, 'f1-score': 0.7970795089501741, 'support': 239980}, '2': {'precision': 0.5680118694362017, 'recall': 0.47278205888164393, 'f1-score': 0.5160403299725023, 'support': 80976}, 'accuracy': 0.6942511681632267, 'macro avg': {'precision': 0.6365785286008318, 'recall': 0.589080894369773, 'f1-score': 0.6063015915313972, 'support': 401699}, 'weighted avg': {'precision': 0.6802494741037104, 'recall': 0.6942511681632267, 'f1-score': 0.6818752732235861, 'support': 401699}}
[[ 35519  35375   9849]
 [ 15636 205077  19267]
 [  8553  34139  38284]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7371261
{'0': {'precision': 0.558198771889925, 'recall': 0.4368037017262858, 'f1-score': 0.49009584664536743, 'support': 28095}, '1': {'precision': 0.7425906816964694, 'recall': 0.8153863805863117, 'f1-score': 0.7772878598333367, 'support': 69724}, '2': {'precision': 0.5329339116371389, 'recall': 0.5191006408649887, 'f1-score': 0.5259263289624028, 'support': 27931}, 'accuracy': 0.6649940357852883, 'macro avg': {'precision': 0.6112411217411777, 'recall': 0.5904302410591954, 'f1-score': 0.5977700118137023, 'support': 125750}, 'weighted avg': {'precision': 0.6548259584317216, 'recall': 0.6649940357852883, 'f1-score': 0.6572923248093044, 'support': 125750}}
[[12272 10893  4930]
 [ 5095 56852  7777]
 [ 4618  8814 14499]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/AAL
Evaluating performance on  test set...
6357/6357 - 53s - 53s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0037671
{'0': {'precision': 0.46213850667475187, 'recall': 0.5219906125039031, 'f1-score': 0.4902445369406868, 'support': 397124}, '1': {'precision': 0.689054011082319, 'recall': 0.4905260749677901, 'f1-score': 0.5730835294597602, 'support': 830490}, '2': {'precision': 0.38960088253920694, 'recall': 0.5727693655362283, 'f1-score': 0.46375384266211117, 'support': 399550}, 'accuracy': 0.5184001120968753, 'macro avg': {'precision': 0.5135978000987593, 'recall': 0.5284286843359738, 'f1-score': 0.5090273030208526, 'support': 1627164}, 'weighted avg': {'precision': 0.5601425490036649, 'recall': 0.5184001120968753, 'f1-score': 0.5260200322184586, 'support': 1627164}}
[[207295  89776 100053]
 [164620 407377 258493]
 [ 76641  94059 228850]]
Evaluating performance on  train set...
1701/1701 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8476444
{'0': {'precision': 0.5165119687347337, 'recall': 0.5104918064447599, 'f1-score': 0.5134842428863515, 'support': 103557}, '1': {'precision': 0.7035706539420887, 'recall': 0.6880136804708628, 'f1-score': 0.6957052089756307, 'support': 226308}, '2': {'precision': 0.48566622526037007, 'recall': 0.5142440290659669, 'f1-score': 0.4995467450774675, 'support': 105553}, 'accuracy': 0.6036681992935524, 'macro avg': {'precision': 0.5685829493123975, 'recall': 0.5709165053271965, 'f1-score': 0.5695787323131499, 'support': 435418}, 'weighted avg': {'precision': 0.6062579511492333, 'recall': 0.6036681992935524, 'f1-score': 0.6048146832620629, 'support': 435418}}
[[ 52865  31679  19013]
 [ 32134 155703  38471]
 [ 17351  33922  54280]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8635123
{'0': {'precision': 0.5192242259271861, 'recall': 0.48053360815298296, 'f1-score': 0.4991302537874846, 'support': 34932}, '1': {'precision': 0.6984113475177305, 'recall': 0.6620947463256552, 'f1-score': 0.6797683392352987, 'support': 74367}, '2': {'precision': 0.4684922867953818, 'recall': 0.5556994073306865, 'f1-score': 0.5083831232069066, 'support': 34758}, 'accuracy': 0.5923974537856543, 'macro avg': {'precision': 0.5620426200800994, 'recall': 0.5661092539364415, 'f1-score': 0.56242723874323, 'support': 144057}, 'weighted avg': {'precision': 0.5994859829468433, 'recall': 0.5923974537856543, 'f1-score': 0.5946141506878633, 'support': 144057}}
[[16786 10996  7150]
 [10366 49238 14763]
 [ 5177 10266 19315]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/WBA
Evaluating performance on  test set...
7458/7458 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98851144
{'0': {'precision': 0.5057862813881663, 'recall': 0.49247537079673126, 'f1-score': 0.4990420816533604, 'support': 607206}, '1': {'precision': 0.522860089849925, 'recall': 0.5723951387249603, 'f1-score': 0.5465074548017652, 'support': 665093}, '2': {'precision': 0.5164268871722633, 'recall': 0.4782956823723167, 'f1-score': 0.49663043336506735, 'support': 636947}, 'accuracy': 0.5155852100776956, 'macro avg': {'precision': 0.5150244194701182, 'recall': 0.514388730631336, 'f1-score': 0.5140599899400643, 'support': 1909246}, 'weighted avg': {'precision': 0.5152838382371108, 'recall': 0.5155852100776956, 'f1-score': 0.5147722679578537, 'support': 1909246}}
[[299034 167394 140778]
 [139907 380696 144490]
 [152285 180013 304649]]
Evaluating performance on  train set...
1664/1664 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80578333
{'0': {'precision': 0.5581276130369898, 'recall': 0.47249493683093835, 'f1-score': 0.5117537381640039, 'support': 103690}, '1': {'precision': 0.695415975972033, 'recall': 0.7765838995981543, 'f1-score': 0.7337620871116267, 'support': 218243}, '2': {'precision': 0.5356114498644986, 'recall': 0.48636905448533085, 'f1-score': 0.5098039215686273, 'support': 104028}, 'accuracy': 0.6316845908428237, 'macro avg': {'precision': 0.5963850129578404, 'recall': 0.5784826303048077, 'f1-score': 0.5851065822814193, 'support': 425961}, 'weighted avg': {'precision': 0.6229690252074108, 'recall': 0.6316845908428237, 'f1-score': 0.6250245131377509, 'support': 425961}}
[[ 48993  37511  17186]
 [ 22077 169484  26682]
 [ 16711  36721  50596]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8826446
{'0': {'precision': 0.5277718792658881, 'recall': 0.4677258918730005, 'f1-score': 0.4959379721216613, 'support': 37197}, '1': {'precision': 0.6395092893315067, 'recall': 0.7237522863862033, 'f1-score': 0.6790278821952734, 'support': 57405}, '2': {'precision': 0.5250708173933358, 'recall': 0.47853511830303674, 'f1-score': 0.5007240726300545, 'support': 37573}, 'accuracy': 0.5819935691318328, 'macro avg': {'precision': 0.5641173286635769, 'recall': 0.5566710988540802, 'f1-score': 0.5585633089823298, 'support': 132175}, 'weighted avg': {'precision': 0.5755327949237616, 'recall': 0.5819935691318328, 'f1-score': 0.5768163866643324, 'support': 132175}}
[[17398 11857  7942]
 [ 7537 41547  8321]
 [ 8030 11563 17980]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
8238/8238 - 70s - 70s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0114653
{'0': {'precision': 0.5039720209842617, 'recall': 0.5348996263522297, 'f1-score': 0.5189754603614556, 'support': 735452}, '1': {'precision': 0.49493315670103705, 'recall': 0.5221729126857232, 'f1-score': 0.5081882721929692, 'support': 641075}, '2': {'precision': 0.5159888671701194, 'recall': 0.459317492098959, 'f1-score': 0.48600669967368715, 'support': 732182}, 'accuracy': 0.50478705217268, 'macro avg': {'precision': 0.5049646816184727, 'recall': 0.5054633437123038, 'f1-score': 0.5043901440760373, 'support': 2108709}, 'weighted avg': {'precision': 0.5053965554049359, 'recall': 0.50478705217268, 'f1-score': 0.5042486631632628, 'support': 2108709}}
[[393393 168184 173875]
 [164736 334752 141587]
 [222456 173422 336304]]
Evaluating performance on  train set...
1806/1806 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9237209
{'0': {'precision': 0.5322313904185506, 'recall': 0.45944550335264683, 'f1-score': 0.49316732215271125, 'support': 131687}, '1': {'precision': 0.6041227831057584, 'recall': 0.7344406674131464, 'f1-score': 0.662938077162767, 'support': 199157}, '2': {'precision': 0.5383588432176301, 'recall': 0.4360626275549057, 'f1-score': 0.481841130932346, 'support': 131316}, 'accuracy': 0.5713043101956032, 'macro avg': {'precision': 0.558237672247313, 'recall': 0.5433162661068996, 'f1-score': 0.5459821767492747, 'support': 462160}, 'weighted avg': {'precision': 0.5649523240458013, 'recall': 0.5713043101956032, 'f1-score': 0.5631078711600771, 'support': 462160}}
[[ 60503  48045  23139]
 [ 26925 146269  25963]
 [ 26250  47804  57262]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9061176
{'0': {'precision': 0.5230549636954138, 'recall': 0.5201711617190232, 'f1-score': 0.5216090768437339, 'support': 48609}, '1': {'precision': 0.6229516565419368, 'recall': 0.72190014197823, 'f1-score': 0.6687857945359384, 'support': 67616}, '2': {'precision': 0.5474019933554817, 'recall': 0.4282179761731501, 'f1-score': 0.480530085625627, 'support': 48097}, 'accuracy': 0.5762648945363372, 'macro avg': {'precision': 0.5644695378642774, 'recall': 0.5567630932901345, 'f1-score': 0.5569749856684331, 'support': 164322}, 'weighted avg': {'precision': 0.5712872994086524, 'recall': 0.5762648945363372, 'f1-score': 0.5701462459559576, 'support': 164322}}
[[25285 14724  8600]
 [10375 48812  8429]
 [12681 14820 20596]]
testing model on single stock: results/universal/W5/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
31315/31315 - 242s - 242s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0673201
{'0': {'precision': 0.4926221379028077, 'recall': 0.6100764304709423, 'f1-score': 0.5450939433175083, 'support': 3105306}, '1': {'precision': 0.46864653206269574, 'recall': 0.07252363463278083, 'f1-score': 0.12560910395624306, 'support': 1731146}, '2': {'precision': 0.49870121884039775, 'recall': 0.6120623428276912, 'f1-score': 0.5495971364348513, 'support': 3180029}, 'accuracy': 0.4947805651881418, 'macro avg': {'precision': 0.48665662960196704, 'recall': 0.43155413597713815, 'f1-score': 0.4067667279028675, 'support': 8016481}, 'weighted avg': {'precision': 0.48985613365820174, 'recall': 0.4947805651881418, 'f1-score': 0.45629323175651965, 'support': 8016481}}
[[1894474   73897 1136935]
 [ 786018  125549  819579]
 [1165202   68451 1946376]]
Evaluating performance on  train set...
5759/5759 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0504166
{'0': {'precision': 0.47226264888395525, 'recall': 0.591576794347341, 'f1-score': 0.5252289256509778, 'support': 494776}, '1': {'precision': 0.5617080567166626, 'recall': 0.2825981180467932, 'f1-score': 0.3760191372858852, 'support': 485028}, '2': {'precision': 0.4654727519074402, 'recall': 0.5746985539083312, 'f1-score': 0.5143508879917447, 'support': 494367}, 'accuracy': 0.4842572537378635, 'macro avg': {'precision': 0.49981448583601934, 'recall': 0.4829578221008218, 'f1-score': 0.4718663169762025, 'support': 1474171}, 'weighted avg': {'precision': 0.49941474065057767, 'recall': 0.4842572537378635, 'f1-score': 0.472488322237516, 'support': 1474171}}
[[292698  51364 150714]
 [172413 137068 175547]
 [154667  55588 284112]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.055554
{'0': {'precision': 0.46652573946285675, 'recall': 0.6023256057136285, 'f1-score': 0.5257988397938831, 'support': 191262}, '1': {'precision': 0.5572425615281009, 'recall': 0.2539793760735169, 'f1-score': 0.348925766275365, 'support': 161269}, '2': {'precision': 0.47599109131403117, 'recall': 0.5553823125857553, 'f1-score': 0.5126310840761031, 'support': 192408}, 'accuracy': 0.48266136209740906, 'macro avg': {'precision': 0.4999197974349963, 'recall': 0.47056243145763355, 'f1-score': 0.46245189671511705, 'support': 544939}, 'weighted avg': {'precision': 0.49671447727868684, 'recall': 0.48266136209740906, 'f1-score': 0.46880580894932156, 'support': 544939}}
[[115202  15882  60178]
 [ 62848  40959  57462]
 [ 68886  16662 106860]]
training model: results/universal/W5/deepVOL_L2/h10
Epoch 1/50
9913/9913 - 338s - loss: 2.6887 - accuracy10: 0.5482 - val_loss: 3.1320 - val_accuracy10: 0.5664 - 338s/epoch - 34ms/step
Epoch 2/50
9913/9913 - 325s - loss: 2.5728 - accuracy10: 0.5825 - val_loss: 2.9842 - val_accuracy10: 0.5775 - 325s/epoch - 33ms/step
Epoch 3/50
9913/9913 - 323s - loss: 2.5343 - accuracy10: 0.5899 - val_loss: 2.9274 - val_accuracy10: 0.5835 - 323s/epoch - 33ms/step
Epoch 4/50
9913/9913 - 321s - loss: 2.5123 - accuracy10: 0.5934 - val_loss: 2.9246 - val_accuracy10: 0.5869 - 321s/epoch - 32ms/step
Epoch 5/50
9913/9913 - 324s - loss: 2.4986 - accuracy10: 0.5958 - val_loss: 2.9311 - val_accuracy10: 0.5867 - 324s/epoch - 33ms/step
Epoch 6/50
9913/9913 - 322s - loss: 2.4880 - accuracy10: 0.5971 - val_loss: 2.9147 - val_accuracy10: 0.5851 - 322s/epoch - 32ms/step
Epoch 7/50
9913/9913 - 323s - loss: 2.4795 - accuracy10: 0.5989 - val_loss: 2.9150 - val_accuracy10: 0.5874 - 323s/epoch - 33ms/step
Epoch 8/50
9913/9913 - 319s - loss: 2.4721 - accuracy10: 0.6000 - val_loss: 2.9068 - val_accuracy10: 0.5883 - 319s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 318s - loss: 2.4661 - accuracy10: 0.6013 - val_loss: 2.8920 - val_accuracy10: 0.5862 - 318s/epoch - 32ms/step
Epoch 10/50
9913/9913 - 327s - loss: 2.4612 - accuracy10: 0.6016 - val_loss: 2.9143 - val_accuracy10: 0.5876 - 327s/epoch - 33ms/step
Epoch 11/50
9913/9913 - 322s - loss: 2.4567 - accuracy10: 0.6025 - val_loss: 2.9144 - val_accuracy10: 0.5891 - 322s/epoch - 32ms/step
Epoch 12/50
9913/9913 - 318s - loss: 2.4521 - accuracy10: 0.6029 - val_loss: 2.9026 - val_accuracy10: 0.5889 - 318s/epoch - 32ms/step
Epoch 13/50
9913/9913 - 318s - loss: 2.4487 - accuracy10: 0.6037 - val_loss: 2.9103 - val_accuracy10: 0.5885 - 318s/epoch - 32ms/step
Epoch 14/50
9913/9913 - 319s - loss: 2.4448 - accuracy10: 0.6043 - val_loss: 2.8897 - val_accuracy10: 0.5897 - 319s/epoch - 32ms/step
Epoch 15/50
9913/9913 - 335s - loss: 2.4418 - accuracy10: 0.6047 - val_loss: 2.9081 - val_accuracy10: 0.5882 - 335s/epoch - 34ms/step
Epoch 16/50
9913/9913 - 324s - loss: 2.4392 - accuracy10: 0.6054 - val_loss: 2.9110 - val_accuracy10: 0.5874 - 324s/epoch - 33ms/step
Epoch 17/50
9913/9913 - 327s - loss: 2.4367 - accuracy10: 0.6056 - val_loss: 2.8893 - val_accuracy10: 0.5888 - 327s/epoch - 33ms/step
Epoch 18/50
9913/9913 - 319s - loss: 2.4340 - accuracy10: 0.6062 - val_loss: 2.8639 - val_accuracy10: 0.5905 - 319s/epoch - 32ms/step
Epoch 19/50
9913/9913 - 313s - loss: 2.4319 - accuracy10: 0.6063 - val_loss: 2.8965 - val_accuracy10: 0.5886 - 313s/epoch - 32ms/step
Epoch 20/50
9913/9913 - 330s - loss: 2.4294 - accuracy10: 0.6067 - val_loss: 2.8872 - val_accuracy10: 0.5892 - 330s/epoch - 33ms/step
Epoch 21/50
9913/9913 - 344s - loss: 2.4277 - accuracy10: 0.6072 - val_loss: 2.8951 - val_accuracy10: 0.5870 - 344s/epoch - 35ms/step
Epoch 22/50
9913/9913 - 344s - loss: 2.4263 - accuracy10: 0.6076 - val_loss: 2.8616 - val_accuracy10: 0.5926 - 344s/epoch - 35ms/step
Epoch 23/50
9913/9913 - 331s - loss: 2.4241 - accuracy10: 0.6078 - val_loss: 2.8766 - val_accuracy10: 0.5899 - 331s/epoch - 33ms/step
Epoch 24/50
9913/9913 - 314s - loss: 2.4224 - accuracy10: 0.6080 - val_loss: 2.8711 - val_accuracy10: 0.5900 - 314s/epoch - 32ms/step
Epoch 25/50
9913/9913 - 315s - loss: 2.4203 - accuracy10: 0.6083 - val_loss: 2.8682 - val_accuracy10: 0.5906 - 315s/epoch - 32ms/step
Epoch 26/50
9913/9913 - 314s - loss: 2.4183 - accuracy10: 0.6086 - val_loss: 2.8598 - val_accuracy10: 0.5894 - 314s/epoch - 32ms/step
Epoch 27/50
9913/9913 - 313s - loss: 2.4170 - accuracy10: 0.6089 - val_loss: 2.8595 - val_accuracy10: 0.5889 - 313s/epoch - 32ms/step
Epoch 28/50
9913/9913 - 313s - loss: 2.4153 - accuracy10: 0.6094 - val_loss: 2.8595 - val_accuracy10: 0.5885 - 313s/epoch - 32ms/step
Epoch 29/50
9913/9913 - 313s - loss: 2.4132 - accuracy10: 0.6097 - val_loss: 2.8646 - val_accuracy10: 0.5913 - 313s/epoch - 32ms/step
Epoch 30/50
9913/9913 - 314s - loss: 2.4116 - accuracy10: 0.6100 - val_loss: 2.8720 - val_accuracy10: 0.5873 - 314s/epoch - 32ms/step
Epoch 31/50
9913/9913 - 314s - loss: 2.4105 - accuracy10: 0.6101 - val_loss: 2.8636 - val_accuracy10: 0.5887 - 314s/epoch - 32ms/step
Epoch 32/50
9913/9913 - 312s - loss: 2.4093 - accuracy10: 0.6104 - val_loss: 2.8698 - val_accuracy10: 0.5878 - 312s/epoch - 32ms/step
Epoch 33/50
9913/9913 - 311s - loss: 2.4076 - accuracy10: 0.6105 - val_loss: 2.8607 - val_accuracy10: 0.5873 - 311s/epoch - 31ms/step
Epoch 34/50
9913/9913 - 315s - loss: 2.4071 - accuracy10: 0.6105 - val_loss: 2.8668 - val_accuracy10: 0.5883 - 315s/epoch - 32ms/step
Epoch 35/50
9913/9913 - 314s - loss: 2.4049 - accuracy10: 0.6110 - val_loss: 2.8736 - val_accuracy10: 0.5871 - 314s/epoch - 32ms/step
Epoch 36/50
9913/9913 - 314s - loss: 2.4037 - accuracy10: 0.6112 - val_loss: 2.8779 - val_accuracy10: 0.5885 - 314s/epoch - 32ms/step
Epoch 37/50
9913/9913 - 318s - loss: 2.4025 - accuracy10: 0.6113 - val_loss: 2.8727 - val_accuracy10: 0.5866 - 318s/epoch - 32ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 772s - 772s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94316906
{'0': {'precision': 0.5130980578358653, 'recall': 0.5188050269406138, 'f1-score': 0.515935761111469, 'support': 3782579}, '1': {'precision': 0.7464596049961904, 'recall': 0.5008176255602329, 'f1-score': 0.5994499342925509, 'support': 5223051}, '2': {'precision': 0.46730937821605345, 'recall': 0.6717421201061062, 'f1-score': 0.5511803336911707, 'support': 3832761}, 'accuracy': 0.5571448945588275, 'macro avg': {'precision': 0.5756223470160363, 'recall': 0.563788257535651, 'f1-score': 0.5555220096983969, 'support': 12838391}, 'weighted avg': {'precision': 0.5943669798346557, 'recall': 0.5571448945588275, 'f1-score': 0.5604337678315302, 'support': 12838391}}
[[1962421  476732 1343426]
 [1015838 2615796 1591417]
 [ 846392  411742 2574627]]
Evaluating performance on  train set...
9913/9913 - 161s - 161s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83698106
{'0': {'precision': 0.5073008271818807, 'recall': 0.48194899175020706, 'f1-score': 0.49430005949010536, 'support': 572378}, '1': {'precision': 0.7989842429027858, 'recall': 0.6439785261299735, 'f1-score': 0.7131558848056841, 'support': 1389037}, '2': {'precision': 0.4348929838617374, 'recall': 0.6601009697403486, 'f1-score': 0.5243376539862197, 'support': 575618}, 'accuracy': 0.6110811329612189, 'macro avg': {'precision': 0.5803926846488013, 'recall': 0.5953428292068431, 'f1-score': 0.5772645327606697, 'support': 2537033}, 'weighted avg': {'precision': 0.6505704648911516, 'recall': 0.6110811329612189, 'f1-score': 0.6209397283858351, 'support': 2537033}}
[[275857 118144 178377]
 [179170 894510 315357]
 [ 88747 106905 379966]]
Evaluating performance on  val set...
3496/3496 - 53s - 53s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88095456
{'0': {'precision': 0.5090556392350176, 'recall': 0.4825797239409805, 'f1-score': 0.49546423811639273, 'support': 231110}, '1': {'precision': 0.7741631057262267, 'recall': 0.6092981950291217, 'f1-score': 0.6819073041213227, 'support': 433525}, '2': {'precision': 0.45124533206359474, 'recall': 0.6563305805282598, 'f1-score': 0.5348005628993933, 'support': 229584}, 'accuracy': 0.5886231448895628, 'macro avg': {'precision': 0.5781546923416131, 'recall': 0.582736166499454, 'f1-score': 0.5707240350457029, 'support': 894219}, 'weighted avg': {'precision': 0.6227396392942396, 'recall': 0.5886231448895628, 'f1-score': 0.5959527325218658, 'support': 894219}}
[[111529  41182  78399]
 [ 64534 264146 104845]
 [ 43027  35874 150683]]
testing model out of sample: results/universal/W5/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 359s - 359s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.921826
{'0': {'precision': 0.469012127717569, 'recall': 0.4882479408752609, 'f1-score': 0.47843676575843996, 'support': 1307473}, '1': {'precision': 0.7622246307466854, 'recall': 0.5726400343154417, 'f1-score': 0.6539694249627055, 'support': 2727635}, '2': {'precision': 0.42369530946937495, 'recall': 0.6252032371800728, 'f1-score': 0.5050930424194718, 'support': 1313736}, 'accuracy': 0.5649213175781533, 'macro avg': {'precision': 0.5516440226445432, 'recall': 0.5620304041235918, 'f1-score': 0.5458330777135392, 'support': 5348844}, 'weighted avg': {'precision': 0.607405087048915, 'recall': 0.5649213175781533, 'f1-score': 0.5744964629872588, 'support': 5348844}}
[[ 638371  261165  407937]
 [ 456427 1561953  709255]
 [ 266299  226085  821352]]
Evaluating performance on  train set...
4957/4957 - 83s - 83s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8378415
{'0': {'precision': 0.47337725018605714, 'recall': 0.4799750458551091, 'f1-score': 0.47665331757906043, 'support': 267691}, '1': {'precision': 0.7926045593250763, 'recall': 0.6654792471029246, 'f1-score': 0.7235000938418868, 'support': 729874}, '2': {'precision': 0.42779970425292624, 'recall': 0.6068528209351538, 'f1-score': 0.5018331294826162, 'support': 270779}, 'accuracy': 0.6138113950158632, 'macro avg': {'precision': 0.5645938379213532, 'recall': 0.5841023712977292, 'f1-score': 0.5673288469678545, 'support': 1268344}, 'weighted avg': {'precision': 0.6473476168376163, 'recall': 0.6138113950158632, 'f1-score': 0.6240779975282597, 'support': 1268344}}
[[128485  66126  73080]
 [ 97449 485716 146709]
 [ 45488  60968 164323]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8431138
{'0': {'precision': 0.47761018651056464, 'recall': 0.47465922119835235, 'f1-score': 0.4761301315158937, 'support': 94196}, '1': {'precision': 0.7894277377191502, 'recall': 0.6650495101803657, 'f1-score': 0.7219205815025383, 'support': 246111}, '2': {'precision': 0.4319989860053831, 'recall': 0.6114177175117396, 'f1-score': 0.5062825486700919, 'support': 94765}, 'accuracy': 0.6121469549867609, 'macro avg': {'precision': 0.5663456367450327, 'recall': 0.5837088162968193, 'f1-score': 0.568111087229508, 'support': 435072}, 'weighted avg': {'precision': 0.6440639779051445, 'recall': 0.6121469549867609, 'f1-score': 0.621736208781911, 'support': 435072}}
[[ 44711  22960  26525]
 [ 32778 163676  49657]
 [ 16125  20699  57941]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0809832
{'0': {'precision': 0.455337361530715, 'recall': 0.5071334036205388, 'f1-score': 0.479841662333252, 'support': 89158}, '1': {'precision': 0.6472761642893968, 'recall': 0.23273225338043108, 'f1-score': 0.34236499844716967, 'support': 97103}, '2': {'precision': 0.4163493938996105, 'recall': 0.6711106408492928, 'f1-score': 0.5138883262440078, 'support': 85059}, 'accuracy': 0.4603346601798614, 'macro avg': {'precision': 0.5063209732399074, 'recall': 0.47032543261675425, 'f1-score': 0.4453649956748098, 'support': 271320}, 'weighted avg': {'precision': 0.5118077876900183, 'recall': 0.4603346601798614, 'f1-score': 0.44131364630883335, 'support': 271320}}
[[45215  7075 36868]
 [31350 22599 43154]
 [22735  5240 57084]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0830458
{'0': {'precision': 0.40741102854908096, 'recall': 0.45585822120118147, 'f1-score': 0.43027518199184267, 'support': 18282}, '1': {'precision': 0.7265030191651352, 'recall': 0.3367508366291451, 'f1-score': 0.46019207583253646, 'support': 32870}, '2': {'precision': 0.3729876092650911, 'recall': 0.684398120645893, 'f1-score': 0.48283613365336997, 'support': 18517}, 'accuracy': 0.46040563234724197, 'macro avg': {'precision': 0.5023005523264357, 'recall': 0.49233572615873983, 'f1-score': 0.4577677971592497, 'support': 69669}, 'weighted avg': {'precision': 0.5488101483393473, 'recall': 0.46040563234724197, 'f1-score': 0.4583599749766724, 'support': 69669}}
[[ 8334  2318  7630]
 [ 8127 11069 13674]
 [ 3995  1849 12673]]
Evaluating performance on  val set...
96/96 - 1s - 801ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0528293
{'0': {'precision': 0.4412102093490106, 'recall': 0.453834808259587, 'f1-score': 0.44743347389850224, 'support': 6780}, '1': {'precision': 0.7103299618637042, 'recall': 0.38009049773755654, 'f1-score': 0.4952028667206103, 'support': 11271}, '2': {'precision': 0.3794363256784969, 'recall': 0.6762790697674419, 'f1-score': 0.4861250417920428, 'support': 6450}, 'accuracy': 0.4784702665197339, 'macro avg': {'precision': 0.5103254989637372, 'recall': 0.5034014585881952, 'f1-score': 0.47625379413705177, 'support': 24501}, 'weighted avg': {'precision': 0.548748970253394, 'recall': 0.4784702665197339, 'f1-score': 0.47959417915181096, 'support': 24501}}
[[3077 1010 2693]
 [2546 4284 4441]
 [1351  737 4362]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61304057
{'0': {'precision': 0.5246452692236198, 'recall': 0.41920710952681545, 'f1-score': 0.4660369180386518, 'support': 80793}, '1': {'precision': 0.8689995966115369, 'recall': 0.8463080437076453, 'f1-score': 0.8575037285488832, 'support': 397093}, '2': {'precision': 0.4412653114170821, 'recall': 0.5856369896704378, 'f1-score': 0.503302579711064, 'support': 81320}, 'accuracy': 0.7466944203030725, 'macro avg': {'precision': 0.6116367257507462, 'recall': 0.6170507143016328, 'f1-score': 0.608947742099533, 'support': 559206}, 'weighted avg': {'precision': 0.7570466289311739, 'recall': 0.7466944203030725, 'f1-score': 0.7494372638738895, 'support': 559206}}
[[ 33869  27173  19751]
 [ 20479 336063  40551]
 [ 10208  23488  47624]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40579364
{'0': {'precision': 0.5065737919024815, 'recall': 0.47517151257758905, 'f1-score': 0.49037043280374226, 'support': 12244}, '1': {'precision': 0.928059455260397, 'recall': 0.9195245425547109, 'f1-score': 0.9237722853965634, 'support': 126026}, '2': {'precision': 0.47925238859055724, 'recall': 0.5532565815956847, 'f1-score': 0.5136023916292974, 'support': 12421}, 'accuracy': 0.8532294563046233, 'macro avg': {'precision': 0.6379618785844786, 'recall': 0.6493175455759949, 'f1-score': 0.6425817032765343, 'support': 150691}, 'weighted avg': {'precision': 0.856818949608033, 'recall': 0.8532294563046233, 'f1-score': 0.8547483056391146, 'support': 150691}}
[[  5818   4576   1850]
 [  4525 115884   5617]
 [  1142   4407   6872]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45908654
{'0': {'precision': 0.5127433273128638, 'recall': 0.46219247467438496, 'f1-score': 0.48615735895728285, 'support': 5528}, '1': {'precision': 0.9057796639831992, 'recall': 0.9120244939315844, 'f1-score': 0.9088913523065272, 'support': 45399}, '2': {'precision': 0.5155383840080632, 'recall': 0.5364446775039329, 'f1-score': 0.5257837930443722, 'support': 5721}, 'accuracy': 0.8301970060725886, 'macro avg': {'precision': 0.6446871251013754, 'recall': 0.6368872153699674, 'f1-score': 0.6402775014360608, 'support': 56648}, 'weighted avg': {'precision': 0.8280138958739743, 'recall': 0.8301970060725886, 'f1-score': 0.8289479851660561, 'support': 56648}}
[[ 2555  2205   768]
 [ 1878 41405  2116]
 [  550  2102  3069]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
2341/2341 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0854756
{'0': {'precision': 0.4303410315464745, 'recall': 0.4724669284169136, 'f1-score': 0.4504211623361724, 'support': 172429}, '1': {'precision': 0.6158522050059595, 'recall': 0.4067511079972605, 'f1-score': 0.4899232450422176, 'support': 254062}, '2': {'precision': 0.41671931454526684, 'recall': 0.5840490300476874, 'f1-score': 0.48639530372294665, 'support': 172792}, 'accuracy': 0.4767797518034051, 'macro avg': {'precision': 0.4876375170325669, 'recall': 0.4877556888206205, 'f1-score': 0.47557990370044556, 'support': 599283}, 'weighted avg': {'precision': 0.5050596803774793, 'recall': 0.4767797518034051, 'f1-score': 0.47754027296498514, 'support': 599283}}
[[ 81467  34079  56883]
 [ 66349 103340  84373]
 [ 41492  30381 100919]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0634958
{'0': {'precision': 0.4356194627643013, 'recall': 0.46465988345762504, 'f1-score': 0.44967129291453617, 'support': 33121}, '1': {'precision': 0.6473052294557097, 'recall': 0.42951225989200675, 'f1-score': 0.5163837599106049, 'support': 56485}, '2': {'precision': 0.40646765187538225, 'recall': 0.6079501859174881, 'f1-score': 0.4871998013456467, 'support': 33886}, 'accuracy': 0.48790205033524436, 'macro avg': {'precision': 0.49646411469846435, 'recall': 0.5007074430890399, 'f1-score': 0.4844182847235959, 'support': 123492}, 'weighted avg': {'precision': 0.5244449111154681, 'recall': 0.48790205033524436, 'f1-score': 0.4904832057102602, 'support': 123492}}
[[15390  6820 10911]
 [13053 24261 19171]
 [ 6886  6399 20601]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0981126
{'0': {'precision': 0.42799710541127284, 'recall': 0.45812892675789657, 'f1-score': 0.44255071499833726, 'support': 11619}, '1': {'precision': 0.6298230345227734, 'recall': 0.3804100227790433, 'f1-score': 0.47432816255188986, 'support': 17121}, '2': {'precision': 0.4205446211916959, 'recall': 0.6198044981324009, 'f1-score': 0.5010922641994346, 'support': 12583}, 'accuracy': 0.47515911235873487, 'macro avg': {'precision': 0.49278825370858076, 'recall': 0.48611448255644696, 'f1-score': 0.4726570472498873, 'support': 41323}, 'weighted avg': {'precision': 0.5093485833626089, 'recall': 0.47515911235873487, 'f1-score': 0.47354289836260854, 'support': 41323}}
[[5323 1869 4427]
 [4289 6513 6319]
 [2825 1959 7799]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
2027/2027 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.261748
{'0': {'precision': 0.42419042521370887, 'recall': 0.1437910240674529, 'f1-score': 0.2147773513317471, 'support': 187390}, '1': {'precision': 0.3053813621117107, 'recall': 0.014184012842831113, 'f1-score': 0.027108901662265032, 'support': 147631}, '2': {'precision': 0.3536997852838022, 'recall': 0.8628165520842398, 'f1-score': 0.5017245060132363, 'support': 183856}, 'accuracy': 0.3616907282458078, 'macro avg': {'precision': 0.3610905242030739, 'recall': 0.3402638629981746, 'f1-score': 0.24787025300241614, 'support': 518877}, 'weighted avg': {'precision': 0.36540958141110436, 'recall': 0.3616907282458078, 'f1-score': 0.2630571463081376, 'support': 518877}}
[[ 26945   2484 157961]
 [ 13633   2094 131904]
 [ 22943   2279 158634]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3215482
{'0': {'precision': 0.40318438623523367, 'recall': 0.16792641186537363, 'f1-score': 0.23710042788824565, 'support': 28048}, '1': {'precision': 0.37278525868178597, 'recall': 0.018564924293226977, 'f1-score': 0.03536847767616998, 'support': 28333}, '2': {'precision': 0.3322831337954211, 'recall': 0.8436733387847976, 'f1-score': 0.4767836692049587, 'support': 28127}, 'accuracy': 0.34276044871491457, 'macro avg': {'precision': 0.36941759290414694, 'recall': 0.3433882249811327, 'f1-score': 0.24975085825645812, 'support': 84508}, 'weighted avg': {'precision': 0.3693942360915024, 'recall': 0.34276044871491457, 'f1-score': 0.2492400973060102, 'support': 84508}}
[[ 4710   465 22873]
 [ 2995   526 24812]
 [ 3977   420 23730]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3071954
{'0': {'precision': 0.40583711299546443, 'recall': 0.16758957654723128, 'f1-score': 0.2372197567863524, 'support': 12280}, '1': {'precision': 0.28594249201277955, 'recall': 0.016915516915516914, 'f1-score': 0.031941470378301216, 'support': 10582}, '2': {'precision': 0.3392512410369553, 'recall': 0.8309549945115258, 'f1-score': 0.48179971114538206, 'support': 11843}, 'accuracy': 0.34801901743264657, 'macro avg': {'precision': 0.3436769486817331, 'recall': 0.3384866959914246, 'f1-score': 0.25032031277001193, 'support': 34705}, 'weighted avg': {'precision': 0.34655743108094506, 'recall': 0.34801901743264657, 'f1-score': 0.25809010897491286, 'support': 34705}}
[[2058  237 9985]
 [1221  179 9182]
 [1792  210 9841]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
2900/2900 - 27s - 27s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1474981
{'0': {'precision': 0.4596928626190098, 'recall': 0.5202961762378584, 'f1-score': 0.4881206404992021, 'support': 261601}, '1': {'precision': 0.4225402265595442, 'recall': 0.08767652138575638, 'f1-score': 0.14522007503470644, 'support': 216546}, '2': {'precision': 0.43807433173201504, 'recall': 0.6654340659548619, 'f1-score': 0.5283323341552136, 'support': 264211}, 'accuracy': 0.44575662955070194, 'macro avg': {'precision': 0.4401024736368564, 'recall': 0.4244689211928256, 'f1-score': 0.38722434989637405, 'support': 742358}, 'weighted avg': {'precision': 0.4411612264107157, 'recall': 0.44575662955070194, 'f1-score': 0.4024081216652619, 'support': 742358}}
[[136110  14125 111366]
 [ 83405  18986 114155]
 [ 76574  11822 175815]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0869441
{'0': {'precision': 0.4783168808592537, 'recall': 0.5119698303789477, 'f1-score': 0.4945715409120453, 'support': 60193}, '1': {'precision': 0.5162085654278148, 'recall': 0.2941258086335177, 'f1-score': 0.37473484178893407, 'support': 57659}, '2': {'precision': 0.45859737802069195, 'recall': 0.6164853556485356, 'f1-score': 0.5259475551684503, 'support': 59750}, 'accuracy': 0.4764079233341967, 'macro avg': {'precision': 0.4843742747692535, 'recall': 0.4741936648870004, 'f1-score': 0.46508464595647653, 'support': 177602}, 'weighted avg': {'precision': 0.4839843640291201, 'recall': 0.4764079233341967, 'f1-score': 0.46622193120652805, 'support': 177602}}
[[30817  8469 20907]
 [18121 16959 22579]
 [15490  7425 36835]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0873883
{'0': {'precision': 0.4728825622775801, 'recall': 0.5018126888217522, 'f1-score': 0.4869182850861121, 'support': 19860}, '1': {'precision': 0.5552246426140232, 'recall': 0.31016779959119645, 'f1-score': 0.3979993290432767, 'support': 21037}, '2': {'precision': 0.4473965763195435, 'recall': 0.628192288432649, 'f1-score': 0.522599458446157, 'support': 19970}, 'accuracy': 0.47704010383294726, 'macro avg': {'precision': 0.4918345937370489, 'recall': 0.4800575922818659, 'f1-score': 0.469172357525182, 'support': 60867}, 'weighted avg': {'precision': 0.4929800733173185, 'recall': 0.47704010383294726, 'f1-score': 0.4678926218158173, 'support': 60867}}
[[ 9966  2778  7116]
 [ 6133  6525  8379]
 [ 4976  2449 12545]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
7167/7167 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5731852
{'0': {'precision': 0.5358266535213683, 'recall': 0.4637297818667458, 'f1-score': 0.49717808491597887, 'support': 269560}, '1': {'precision': 0.8513354946598863, 'recall': 0.8465601801374367, 'f1-score': 0.848941122136609, 'support': 1294123}, '2': {'precision': 0.4867612120209785, 'recall': 0.5649788842621305, 'f1-score': 0.5229615328760219, 'support': 270888}, 'accuracy': 0.7487319923840505, 'macro avg': {'precision': 0.624641120067411, 'recall': 0.6250896154221044, 'f1-score': 0.6230269133095366, 'support': 1834571}, 'weighted avg': {'precision': 0.7511445718268167, 'recall': 0.7487319923840505, 'f1-score': 0.7491220345740045, 'support': 1834571}}
[[ 125003  102779   41778]
 [  78977 1095553  119593]
 [  29310   88532  153046]]
Evaluating performance on  train set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.506892
{'0': {'precision': 0.5259455669018714, 'recall': 0.4767210900568069, 'f1-score': 0.5001250260470932, 'support': 50346}, '1': {'precision': 0.8795517182913166, 'recall': 0.8790549004362662, 'f1-score': 0.8793032391866471, 'support': 300963}, '2': {'precision': 0.49989144594007817, 'recall': 0.5483230799761858, 'f1-score': 0.5229883969639038, 'support': 50390}, 'accuracy': 0.787141615986099, 'macro avg': {'precision': 0.6351295770444221, 'recall': 0.6346996901564196, 'f1-score': 0.6341388873992146, 'support': 401699}, 'weighted avg': {'precision': 0.7876079085690322, 'recall': 0.787141615986099, 'f1-score': 0.7870829169594868, 'support': 401699}}
[[ 24001  18273   8072]
 [ 16830 264563  19570]
 [  4803  17957  27630]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57684046
{'0': {'precision': 0.5155050120171171, 'recall': 0.47496624358628137, 'f1-score': 0.49440602687355933, 'support': 18515}, '1': {'precision': 0.8697273797452125, 'recall': 0.8398518835327353, 'f1-score': 0.8545285892605614, 'support': 88849}, '2': {'precision': 0.478422294050843, 'recall': 0.5957250081583814, 'f1-score': 0.5306686046511628, 'support': 18386}, 'accuracy': 0.7504333996023856, 'macro avg': {'precision': 0.6212182286043908, 'recall': 0.6368477117591327, 'f1-score': 0.6265344069284279, 'support': 125750}, 'weighted avg': {'precision': 0.7603598851602235, 'recall': 0.7504333996023856, 'f1-score': 0.7541535680309492, 'support': 125750}}
[[ 8794  5953  3768]
 [ 6056 74620  8173]
 [ 2209  5224 10953]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
6357/6357 - 53s - 53s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6831007
{'0': {'precision': 0.5361186743028824, 'recall': 0.4431062913457621, 'f1-score': 0.4851950590009666, 'support': 257735}, '1': {'precision': 0.8289211378715102, 'recall': 0.790321924661007, 'f1-score': 0.8091614708544079, 'support': 1106439}, '2': {'precision': 0.42532959201852844, 'recall': 0.5809692199471472, 'f1-score': 0.4911133718080379, 'support': 262995}, 'accuracy': 0.7014876758345322, 'macro avg': {'precision': 0.5967898013976404, 'recall': 0.6047991453179721, 'f1-score': 0.5951566338878042, 'support': 1627169}, 'weighted avg': {'precision': 0.7173113410099271, 'recall': 0.7014876758345322, 'f1-score': 0.7064416286205977, 'support': 1627169}}
[[114204  94746  48785]
 [ 74341 874443 157655]
 [ 24475  85728 152792]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67176324
{'0': {'precision': 0.5171273002963678, 'recall': 0.44456294716260053, 'f1-score': 0.4781074515114102, 'support': 67509}, '1': {'precision': 0.8417760922697082, 'recall': 0.7950472094351668, 'f1-score': 0.8177446306283578, 'support': 297610}, '2': {'precision': 0.4336867685086143, 'recall': 0.5940482794918847, 'f1-score': 0.5013566077602766, 'support': 70299}, 'accuracy': 0.7082550560610723, 'macro avg': {'precision': 0.5975300536915634, 'recall': 0.6112194786965507, 'f1-score': 0.5990695633000148, 'support': 435418}, 'weighted avg': {'precision': 0.7255544692123027, 'recall': 0.7082550560610723, 'f1-score': 0.7140044822086571, 'support': 435418}}
[[ 30012  22864  14633]
 [ 21097 236614  39899]
 [  6927  21611  41761]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6732481
{'0': {'precision': 0.5245397116786351, 'recall': 0.4359238984115588, 'f1-score': 0.47614379885803904, 'support': 22286}, '1': {'precision': 0.8325780410176422, 'recall': 0.7969011640809409, 'f1-score': 0.814349036181837, 'support': 99134}, '2': {'precision': 0.4302818739397103, 'recall': 0.5825787358098856, 'f1-score': 0.49498039068510624, 'support': 22639}, 'accuracy': 0.7073768386563838, 'macro avg': {'precision': 0.5957998755453292, 'recall': 0.6051345994341285, 'f1-score': 0.5951577419083274, 'support': 144059}, 'weighted avg': {'precision': 0.7217031554906955, 'recall': 0.7073768386563838, 'f1-score': 0.711839448551778, 'support': 144059}}
[[ 9715  8392  4179]
 [ 6850 79000 13284]
 [ 1956  7494 13189]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
7459/7459 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88839746
{'0': {'precision': 0.47809935900562944, 'recall': 0.4711162919255405, 'f1-score': 0.4745821394026775, 'support': 416065}, '1': {'precision': 0.7345822271940516, 'recall': 0.6231239808477269, 'f1-score': 0.6742781302139581, 'support': 1059091}, '2': {'precision': 0.42994634428859585, 'recall': 0.5951254909639595, 'f1-score': 0.4992275086162501, 'support': 434095}, 'accuracy': 0.5836325344336601, 'macro avg': {'precision': 0.5475426434960923, 'recall': 0.5631219212457422, 'f1-score': 0.5493625927442952, 'support': 1909251}, 'weighted avg': {'precision': 0.6094261014972944, 'recall': 0.5836325344336601, 'f1-score': 0.5909600583630844, 'support': 1909251}}
[[196015 123614  96436]
 [153055 659945 246091]
 [ 60918 114836 258341]]
Evaluating performance on  train set...
1664/1664 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6765916
{'0': {'precision': 0.5047470069849923, 'recall': 0.48853245390496175, 'f1-score': 0.4965073851474363, 'support': 66710}, '1': {'precision': 0.8428321873257759, 'recall': 0.7768364581870253, 'f1-score': 0.8084897772913074, 'support': 291907}, '2': {'precision': 0.43123687003226996, 'recall': 0.591319454756036, 'f1-score': 0.49874758910903494, 'support': 67346}, 'accuracy': 0.7023544298448456, 'macro avg': {'precision': 0.592938688114346, 'recall': 0.6188961222826744, 'f1-score': 0.6012482505159262, 'support': 425963}, 'weighted avg': {'precision': 0.724810291952276, 'recall': 0.7023544298448456, 'f1-score': 0.7106591140993378, 'support': 425963}}
[[ 32590  21765  12355]
 [ 24975 226764  40168]
 [  7002  20521  39823]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77471584
{'0': {'precision': 0.492385363207744, 'recall': 0.4701219026372401, 'f1-score': 0.48099614828099213, 'support': 25102}, '1': {'precision': 0.8035532295827021, 'recall': 0.7143067015988834, 'f1-score': 0.7563062245612215, 'support': 81682}, '2': {'precision': 0.4330458720750583, 'recall': 0.6071203528670447, 'f1-score': 0.505517207456838, 'support': 25392}, 'accuracy': 0.6473414235564702, 'macro avg': {'precision': 0.5763281549551681, 'recall': 0.597182985701056, 'f1-score': 0.5809398600996839, 'support': 132176}, 'weighted avg': {'precision': 0.6732810273404018, 'recall': 0.6473414235564702, 'f1-score': 0.6558426891455573, 'support': 132176}}
[[11801  7540  5761]
 [ 8914 58346 14422]
 [ 3252  6724 15416]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
8238/8238 - 82s - 82s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95951563
{'0': {'precision': 0.4638630622692924, 'recall': 0.49592251448105595, 'f1-score': 0.47935735186674155, 'support': 526550}, '1': {'precision': 0.7264853789030327, 'recall': 0.5149223766831041, 'f1-score': 0.602676399026764, 'support': 1053485}, '2': {'precision': 0.41916361001505487, 'recall': 0.633548902074794, 'f1-score': 0.5045264340737304, 'support': 528679}, 'accuracy': 0.5399191165800578, 'macro avg': {'precision': 0.53650401706246, 'recall': 0.5481312644129847, 'f1-score': 0.5288533949890787, 'support': 2108714}, 'weighted avg': {'precision': 0.5838589505313221, 'recall': 0.5399191165800578, 'f1-score': 0.5472760604301052, 'support': 2108714}}
[[261128 111217 154205]
 [201094 542463 309928]
 [100720  93015 334944]]
Evaluating performance on  train set...
1806/1806 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80233693
{'0': {'precision': 0.4705282151526217, 'recall': 0.4945363827241325, 'f1-score': 0.4822336701670959, 'support': 88586}, '1': {'precision': 0.8001470761505052, 'recall': 0.6904154250657318, 'f1-score': 0.7412421595804141, 'support': 285250}, '2': {'precision': 0.4271350243235768, 'recall': 0.5944501681252619, 'f1-score': 0.49709116556924643, 'support': 88327}, 'accuracy': 0.6345293759993769, 'macro avg': {'precision': 0.5659367718755679, 'recall': 0.5931339919717087, 'f1-score': 0.5735223317722521, 'support': 462163}, 'weighted avg': {'precision': 0.6656779561169336, 'recall': 0.6345293759993769, 'f1-score': 0.6449349024196448, 'support': 462163}}
[[ 43809  25531  19246]
 [ 37135 196941  51174]
 [ 12162  23659  52506]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8062805
{'0': {'precision': 0.4831496335622367, 'recall': 0.49760779768803304, 'f1-score': 0.4902721456909045, 'support': 33651}, '1': {'precision': 0.7996901938062411, 'recall': 0.6932894574978472, 'f1-score': 0.7426983752203253, 'support': 97548}, '2': {'precision': 0.44397383301918175, 'recall': 0.6044440419044169, 'f1-score': 0.5119282006699226, 'support': 33123}, 'accuracy': 0.6353075059943282, 'macro avg': {'precision': 0.5756045534625532, 'recall': 0.5984470990300991, 'f1-score': 0.5816329071937175, 'support': 164322}, 'weighted avg': {'precision': 0.6631637432328501, 'recall': 0.6353075059943282, 'f1-score': 0.6444875723970421, 'support': 164322}}
[[16745  8942  7964]
 [12809 67629 17110]
 [ 5104  7998 20021]]
testing model on single stock: results/universal/W5/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
31315/31315 - 313s - 313s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0433316
{'0': {'precision': 0.517609070128441, 'recall': 0.5587373456529355, 'f1-score': 0.5373874315723872, 'support': 2828771}, '1': {'precision': 0.5642560469093575, 'recall': 0.2244824230048174, 'f1-score': 0.3211852076116317, 'support': 2325113}, '2': {'precision': 0.4847122088358188, 'recall': 0.683725156343774, 'f1-score': 0.5672703401043109, 'support': 2862602}, 'accuracy': 0.5064213921161965, 'macro avg': {'precision': 0.5221924419578725, 'recall': 0.48898164166717556, 'f1-score': 0.47528099309610994, 'support': 8016486}, 'weighted avg': {'precision': 0.519391505873233, 'recall': 0.5064213921161965, 'f1-score': 0.4853507002875372, 'support': 8016486}}
[[1580540  220561 1027670]
 [ 750141  521947 1053025]
 [ 722859  182510 1957233]]
Evaluating performance on  train set...
5759/5759 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9898417
{'0': {'precision': 0.5086028603932249, 'recall': 0.5030552008288558, 'f1-score': 0.5058138196777113, 'support': 415030}, '1': {'precision': 0.6775797380011773, 'recall': 0.44655410964026626, 'f1-score': 0.5383273837866165, 'support': 641808}, '2': {'precision': 0.4403939502723626, 'recall': 0.6760915717387033, 'f1-score': 0.5333640824782803, 'support': 417334}, 'accuracy': 0.5274425236675232, 'macro avg': {'precision': 0.5421921828889216, 'recall': 0.5419002940692751, 'f1-score': 0.5258350953142027, 'support': 1474172}, 'weighted avg': {'precision': 0.5628603110620918, 'recall': 0.5274425236675232, 'f1-score': 0.5277686030606685, 'support': 1474172}}
[[208783  73168 133079]
 [129751 286602 225455]
 [ 71969  63209 282156]]
Evaluating performance on  val set...
2129/2129 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9936673
{'0': {'precision': 0.5145121246941291, 'recall': 0.509290744615022, 'f1-score': 0.5118881201724873, 'support': 169685}, '1': {'precision': 0.6565452388276135, 'recall': 0.43304526768850266, 'f1-score': 0.5218727714630844, 'support': 207013}, '2': {'precision': 0.46318963545240915, 'recall': 0.6619452930897161, 'f1-score': 0.545012320243126, 'support': 168242}, 'accuracy': 0.5274562337138033, 'macro avg': {'precision': 0.5447489996580507, 'recall': 0.5347604351310803, 'f1-score': 0.5262577372928993, 'support': 544940}, 'weighted avg': {'precision': 0.5526229310601687, 'recall': 0.5274562337138033, 'f1-score': 0.5259077081746614, 'support': 544940}}
[[ 86419  25250  58016]
 [ 46315  89646  71052]
 [ 35229  21646 111367]]
training model: results/universal/W5/deepVOL_L2/h20
Epoch 1/50
9913/9913 - 329s - loss: 2.7385 - accuracy20: 0.5474 - val_loss: 3.1328 - val_accuracy20: 0.5416 - 329s/epoch - 33ms/step
Epoch 2/50
9913/9913 - 317s - loss: 2.6437 - accuracy20: 0.5752 - val_loss: 3.0463 - val_accuracy20: 0.5482 - 317s/epoch - 32ms/step
Epoch 3/50
9913/9913 - 313s - loss: 2.6115 - accuracy20: 0.5818 - val_loss: 2.9602 - val_accuracy20: 0.5596 - 313s/epoch - 32ms/step
Epoch 4/50
9913/9913 - 317s - loss: 2.5945 - accuracy20: 0.5848 - val_loss: 2.9926 - val_accuracy20: 0.5609 - 317s/epoch - 32ms/step
Epoch 5/50
9913/9913 - 321s - loss: 2.5830 - accuracy20: 0.5871 - val_loss: 2.9636 - val_accuracy20: 0.5641 - 321s/epoch - 32ms/step
Epoch 6/50
9913/9913 - 331s - loss: 2.5745 - accuracy20: 0.5889 - val_loss: 2.9532 - val_accuracy20: 0.5652 - 331s/epoch - 33ms/step
Epoch 7/50
9913/9913 - 336s - loss: 2.5679 - accuracy20: 0.5902 - val_loss: 2.9361 - val_accuracy20: 0.5655 - 336s/epoch - 34ms/step
Epoch 8/50
9913/9913 - 321s - loss: 2.5613 - accuracy20: 0.5913 - val_loss: 2.9233 - val_accuracy20: 0.5678 - 321s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 319s - loss: 2.5561 - accuracy20: 0.5925 - val_loss: 2.9281 - val_accuracy20: 0.5685 - 319s/epoch - 32ms/step
Epoch 10/50
9913/9913 - 317s - loss: 2.5509 - accuracy20: 0.5934 - val_loss: 2.9062 - val_accuracy20: 0.5706 - 317s/epoch - 32ms/step
Epoch 11/50
9913/9913 - 330s - loss: 2.5469 - accuracy20: 0.5942 - val_loss: 2.8961 - val_accuracy20: 0.5708 - 330s/epoch - 33ms/step
Epoch 12/50
9913/9913 - 324s - loss: 2.5433 - accuracy20: 0.5951 - val_loss: 2.8909 - val_accuracy20: 0.5704 - 324s/epoch - 33ms/step
Epoch 13/50
9913/9913 - 317s - loss: 2.5397 - accuracy20: 0.5956 - val_loss: 2.8916 - val_accuracy20: 0.5715 - 317s/epoch - 32ms/step
Epoch 14/50
9913/9913 - 316s - loss: 2.5361 - accuracy20: 0.5964 - val_loss: 2.8900 - val_accuracy20: 0.5707 - 316s/epoch - 32ms/step
Epoch 15/50
9913/9913 - 315s - loss: 2.5337 - accuracy20: 0.5969 - val_loss: 2.8923 - val_accuracy20: 0.5714 - 315s/epoch - 32ms/step
Epoch 16/50
9913/9913 - 320s - loss: 2.5313 - accuracy20: 0.5974 - val_loss: 2.8791 - val_accuracy20: 0.5733 - 320s/epoch - 32ms/step
Epoch 17/50
9913/9913 - 315s - loss: 2.5288 - accuracy20: 0.5978 - val_loss: 2.8812 - val_accuracy20: 0.5721 - 315s/epoch - 32ms/step
Epoch 18/50
9913/9913 - 311s - loss: 2.5264 - accuracy20: 0.5983 - val_loss: 2.8733 - val_accuracy20: 0.5717 - 311s/epoch - 31ms/step
Epoch 19/50
9913/9913 - 320s - loss: 2.5242 - accuracy20: 0.5988 - val_loss: 2.8641 - val_accuracy20: 0.5728 - 320s/epoch - 32ms/step
Epoch 20/50
9913/9913 - 322s - loss: 2.5222 - accuracy20: 0.5991 - val_loss: 2.8617 - val_accuracy20: 0.5726 - 322s/epoch - 32ms/step
Epoch 21/50
9913/9913 - 311s - loss: 2.5203 - accuracy20: 0.5995 - val_loss: 2.8607 - val_accuracy20: 0.5732 - 311s/epoch - 31ms/step
Epoch 22/50
9913/9913 - 315s - loss: 2.5184 - accuracy20: 0.6000 - val_loss: 2.8622 - val_accuracy20: 0.5729 - 315s/epoch - 32ms/step
Epoch 23/50
9913/9913 - 314s - loss: 2.5164 - accuracy20: 0.6004 - val_loss: 2.8686 - val_accuracy20: 0.5721 - 314s/epoch - 32ms/step
Epoch 24/50
9913/9913 - 316s - loss: 2.5152 - accuracy20: 0.6005 - val_loss: 2.8683 - val_accuracy20: 0.5722 - 316s/epoch - 32ms/step
Epoch 25/50
9913/9913 - 319s - loss: 2.5135 - accuracy20: 0.6007 - val_loss: 2.8745 - val_accuracy20: 0.5718 - 319s/epoch - 32ms/step
Epoch 26/50
9913/9913 - 318s - loss: 2.5120 - accuracy20: 0.6010 - val_loss: 2.8745 - val_accuracy20: 0.5726 - 318s/epoch - 32ms/step
Epoch 27/50
9913/9913 - 316s - loss: 2.5103 - accuracy20: 0.6016 - val_loss: 2.8602 - val_accuracy20: 0.5727 - 316s/epoch - 32ms/step
Epoch 28/50
9913/9913 - 315s - loss: 2.5089 - accuracy20: 0.6016 - val_loss: 2.8600 - val_accuracy20: 0.5716 - 315s/epoch - 32ms/step
Epoch 29/50
9913/9913 - 316s - loss: 2.5073 - accuracy20: 0.6019 - val_loss: 2.8729 - val_accuracy20: 0.5723 - 316s/epoch - 32ms/step
Epoch 30/50
9913/9913 - 319s - loss: 2.5064 - accuracy20: 0.6023 - val_loss: 2.8860 - val_accuracy20: 0.5712 - 319s/epoch - 32ms/step
Epoch 31/50
9913/9913 - 319s - loss: 2.5049 - accuracy20: 0.6022 - val_loss: 2.8762 - val_accuracy20: 0.5717 - 319s/epoch - 32ms/step
Epoch 32/50
9913/9913 - 312s - loss: 2.5037 - accuracy20: 0.6026 - val_loss: 2.8709 - val_accuracy20: 0.5715 - 312s/epoch - 31ms/step
Epoch 33/50
9913/9913 - 316s - loss: 2.5024 - accuracy20: 0.6030 - val_loss: 2.8696 - val_accuracy20: 0.5710 - 316s/epoch - 32ms/step
Epoch 34/50
9913/9913 - 317s - loss: 2.5013 - accuracy20: 0.6033 - val_loss: 2.8782 - val_accuracy20: 0.5714 - 317s/epoch - 32ms/step
Epoch 35/50
9913/9913 - 317s - loss: 2.5002 - accuracy20: 0.6033 - val_loss: 2.8735 - val_accuracy20: 0.5710 - 317s/epoch - 32ms/step
Epoch 36/50
9913/9913 - 316s - loss: 2.4989 - accuracy20: 0.6037 - val_loss: 2.8785 - val_accuracy20: 0.5718 - 316s/epoch - 32ms/step
Epoch 37/50
9913/9913 - 315s - loss: 2.4980 - accuracy20: 0.6040 - val_loss: 2.8782 - val_accuracy20: 0.5712 - 315s/epoch - 32ms/step
Epoch 38/50
9913/9913 - 323s - loss: 2.4966 - accuracy20: 0.6043 - val_loss: 2.8722 - val_accuracy20: 0.5715 - 323s/epoch - 33ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 776s - 776s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9605722
{'0': {'precision': 0.5330618126736186, 'recall': 0.48580547222289133, 'f1-score': 0.50833773832713, 'support': 4317368}, '1': {'precision': 0.6597862152163726, 'recall': 0.5098709470989761, 'f1-score': 0.575221241358112, 'support': 4125440}, '2': {'precision': 0.49361748658737037, 'recall': 0.6418641167735883, 'f1-score': 0.5580633822945033, 'support': 4395583}, 'accuracy': 0.5469696319421958, 'macro avg': {'precision': 0.5621551714924539, 'recall': 0.5458468453651519, 'f1-score': 0.5472074539932484, 'support': 12838391}, 'weighted avg': {'precision': 0.5602780822228799, 'recall': 0.5469696319421958, 'f1-score': 0.5468547981386884, 'support': 12838391}}
[[2097401  572266 1647701]
 [ 775371 2103442 1246627]
 [1061858  512358 2821367]]
Evaluating performance on  train set...
9913/9913 - 158s - 158s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87783635
{'0': {'precision': 0.5425695285740433, 'recall': 0.4517088702199016, 'f1-score': 0.4929876160745538, 'support': 689081}, '1': {'precision': 0.7172231858245507, 'recall': 0.6658969455910982, 'f1-score': 0.69060773232887, 'support': 1156263}, '2': {'precision': 0.47738219659935044, 'recall': 0.6141329412496078, 'f1-score': 0.5371911434513275, 'support': 691689}, 'accuracy': 0.5936087547934931, 'macro avg': {'precision': 0.5790583036659815, 'recall': 0.5772462523535359, 'f1-score': 0.5735954972849171, 'support': 2537033}, 'weighted avg': {'precision': 0.6043961588256798, 'recall': 0.5936087547934931, 'f1-score': 0.5951052953196712, 'support': 2537033}}
[[311264 156624 221193]
 [142463 769952 243848]
 [119958 146942 424789]]
Evaluating performance on  val set...
3496/3496 - 53s - 53s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9128171
{'0': {'precision': 0.5282508315315048, 'recall': 0.4621539559308302, 'f1-score': 0.49299683241953196, 'support': 269077}, '1': {'precision': 0.6913975471004304, 'recall': 0.6280169643283176, 'f1-score': 0.6581849523602209, 'support': 356277}, '2': {'precision': 0.487268528877393, 'recall': 0.6074758707901735, 'f1-score': 0.5407725748189743, 'support': 268865}, 'accuracy': 0.5719314843455574, 'macro avg': {'precision': 0.5689723025031094, 'recall': 0.565882263683107, 'f1-score': 0.5639847865329091, 'support': 894219}, 'weighted avg': {'precision': 0.5809300024948285, 'recall': 0.5719314843455574, 'f1-score': 0.5731762434903489, 'support': 894219}}
[[124355  52550  92172]
 [ 52837 223748  79692]
 [ 58217  47319 163329]]
testing model out of sample: results/universal/W5/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 337s - 337s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9828219
{'0': {'precision': 0.49251965363217626, 'recall': 0.4693946264979725, 'f1-score': 0.4806791699324939, 'support': 1565199}, '1': {'precision': 0.6688771476493133, 'recall': 0.5554434053022537, 'f1-score': 0.6069054378341225, 'support': 2219245}, '2': {'precision': 0.4568389791128004, 'recall': 0.5882044234211199, 'f1-score': 0.514265163827233, 'support': 1564400}, 'accuracy': 0.5398452450660367, 'macro avg': {'precision': 0.5394119267980967, 'recall': 0.5376808184071153, 'f1-score': 0.5339499238646165, 'support': 5348844}, 'weighted avg': {'precision': 0.5552550109527393, 'recall': 0.5398452450660367, 'f1-score': 0.5428737194011791, 'support': 5348844}}
[[ 734696  320968  509535]
 [ 402054 1232665  584526]
 [ 354959  289254  920187]]
Evaluating performance on  train set...
4957/4957 - 83s - 83s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9080378
{'0': {'precision': 0.5035012036459154, 'recall': 0.4533421432078029, 'f1-score': 0.47710696953499065, 'support': 323879}, '1': {'precision': 0.7101640662503921, 'recall': 0.6634560897342491, 'f1-score': 0.6860159592322226, 'support': 617646}, '2': {'precision': 0.4652633053711844, 'recall': 0.569027504520851, 'f1-score': 0.5119403847900832, 'support': 326819}, 'accuracy': 0.5854705032704062, 'macro avg': {'precision': 0.5596428584224973, 'recall': 0.5619419124876344, 'f1-score': 0.5583544378524322, 'support': 1268344}, 'weighted avg': {'precision': 0.594286998950624, 'recall': 0.5854705032704062, 'f1-score': 0.5878151242554692, 'support': 1268344}}
[[146828  85739  91312]
 [ 85439 409781 122426]
 [ 59347  81503 185969]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9080641
{'0': {'precision': 0.5068545879844847, 'recall': 0.44989749969337517, 'f1-score': 0.4766806673937763, 'support': 114146}, '1': {'precision': 0.707619911554598, 'recall': 0.663539657913942, 'f1-score': 0.6848712352684417, 'support': 206907}, '2': {'precision': 0.46861559380255485, 'recall': 0.5743077908067954, 'f1-score': 0.5161061500508366, 'support': 114019}, 'accuracy': 0.5841033208296558, 'macro avg': {'precision': 0.5610300311138792, 'recall': 0.5625816494713708, 'f1-score': 0.5592193509043516, 'support': 435072}, 'weighted avg': {'precision': 0.5923111995942687, 'recall': 0.5841033208296558, 'f1-score': 0.5860219716705828, 'support': 435072}}
[[ 51354  29490  33302]
 [ 28665 137291  40951]
 [ 21300  27237  65482]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798242
{'0': {'precision': 0.4617469466172636, 'recall': 0.5237729240647955, 'f1-score': 0.4908080610091304, 'support': 102785}, '1': {'precision': 0.5198985563792431, 'recall': 0.1857220510962131, 'f1-score': 0.273678589399961, 'support': 71747}, '2': {'precision': 0.44482486173294705, 'recall': 0.5933173533909162, 'f1-score': 0.5084511656322215, 'support': 96788}, 'accuracy': 0.4591884122069881, 'macro avg': {'precision': 0.4754901215764846, 'recall': 0.43427077618397486, 'f1-score': 0.4243126053471043, 'support': 271320}, 'weighted avg': {'precision': 0.4710877574451035, 'recall': 0.4591884122069881, 'f1-score': 0.43968485818853725, 'support': 271320}}
[[53836  6335 42614]
 [29364 13325 29058]
 [33392  5970 57426]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0854015
{'0': {'precision': 0.43226181254841206, 'recall': 0.5091464805437708, 'f1-score': 0.4675645671435454, 'support': 21921}, '1': {'precision': 0.6245287374009387, 'recall': 0.31760378761200453, 'f1-score': 0.4210717435285573, 'support': 25557}, '2': {'precision': 0.431771035913393, 'recall': 0.6002884052093191, 'f1-score': 0.5022717417943933, 'support': 22191}, 'accuracy': 0.46791255795260445, 'macro avg': {'precision': 0.4961871952875813, 'recall': 0.4756795577883648, 'f1-score': 0.46363601748883204, 'support': 69669}, 'weighted avg': {'precision': 0.5026356513310601, 'recall': 0.46791255795260445, 'f1-score': 0.4615643348960424, 'support': 69669}}
[[11161  2474  8286]
 [ 8195  8117  9245]
 [ 6464  2406 13321]]
Evaluating performance on  val set...
96/96 - 1s - 818ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0737185
{'0': {'precision': 0.44223327805417356, 'recall': 0.5004378831477543, 'f1-score': 0.4695386782486207, 'support': 7993}, '1': {'precision': 0.6200901481004507, 'recall': 0.32621951219512196, 'f1-score': 0.42752497225305214, 'support': 8856}, '2': {'precision': 0.4290080577938316, 'recall': 0.6053319393622583, 'f1-score': 0.5021410374546046, 'support': 7652}, 'accuracy': 0.47022570507326233, 'macro avg': {'precision': 0.49711049464948526, 'recall': 0.4773297782350448, 'f1-score': 0.4664015626520925, 'support': 24501}, 'weighted avg': {'precision': 0.5023900494389208, 'recall': 0.47022570507326233, 'f1-score': 0.46453479564576505, 'support': 24501}}
[[4000  911 3082]
 [2884 2889 3083]
 [2161  859 4632]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6960401
{'0': {'precision': 0.5530670743359449, 'recall': 0.4238805678689293, 'f1-score': 0.47993234317047423, 'support': 102418}, '1': {'precision': 0.8026494399887512, 'recall': 0.8388089478681557, 'f1-score': 0.8203309169999143, 'support': 353872}, '2': {'precision': 0.49064447189734617, 'recall': 0.5286933032764585, 'f1-score': 0.5089587630312469, 'support': 102916}, 'accuracy': 0.7057417123564482, 'macro avg': {'precision': 0.6154536620740141, 'recall': 0.5971276063378478, 'f1-score': 0.6030740077338784, 'support': 559206}, 'weighted avg': {'precision': 0.6995174456583538, 'recall': 0.7057417123564482, 'f1-score': 0.7006824909595948, 'support': 559206}}
[[ 43413  37945  21060]
 [ 21615 296831  35426]
 [ 13467  35038  54411]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.47994742
{'0': {'precision': 0.5929286608260326, 'recall': 0.4527265125724183, 'f1-score': 0.5134283875774714, 'support': 16743}, '1': {'precision': 0.8828281343167765, 'recall': 0.9253754345108649, 'f1-score': 0.9036012122478838, 'support': 116798}, '2': {'precision': 0.560529715762274, 'recall': 0.5059475218658892, 'f1-score': 0.5318418633159668, 'support': 17150}, 'accuracy': 0.8251255881240419, 'macro avg': {'precision': 0.6787621703016944, 'recall': 0.6280164896497241, 'f1-score': 0.6496238210471074, 'support': 150691}, 'weighted avg': {'precision': 0.8139374589422336, 'recall': 0.8251255881240419, 'f1-score': 0.8179402475078589, 'support': 150691}}
[[  7580   7212   1951]
 [  3864 108082   4852]
 [  1340   7133   8677]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54680514
{'0': {'precision': 0.5744936491589426, 'recall': 0.4466835713332444, 'f1-score': 0.5025902845558976, 'support': 7493}, '1': {'precision': 0.8477619281849483, 'recall': 0.9181983290955321, 'f1-score': 0.8815754292556468, 'support': 41295}, '2': {'precision': 0.6131889763779528, 'recall': 0.47557251908396947, 'f1-score': 0.5356835769561479, 'support': 7860}, 'accuracy': 0.7944146307018782, 'macro avg': {'precision': 0.6784815179072812, 'recall': 0.6134848065042486, 'f1-score': 0.6399497635892307, 'support': 56648}, 'weighted avg': {'precision': 0.7790685477311838, 'recall': 0.7944146307018782, 'f1-score': 0.7834528892134692, 'support': 56648}}
[[ 3347  3368   778]
 [ 1798 37917  1580]
 [  681  3441  3738]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1075569
{'0': {'precision': 0.4515740043378234, 'recall': 0.531377126031537, 'f1-score': 0.4882360662740535, 'support': 206488}, '1': {'precision': 0.5070664807066481, 'recall': 0.29229689024194155, 'f1-score': 0.3708299900722144, 'support': 186574}, '2': {'precision': 0.45496353827476144, 'recall': 0.5487995887906664, 'f1-score': 0.49749546678388934, 'support': 206221}, 'accuracy': 0.46293987982305523, 'macro avg': {'precision': 0.47120134110641093, 'recall': 0.4574912016880483, 'f1-score': 0.4521871743767191, 'support': 599283}, 'weighted avg': {'precision': 0.4700167874036644, 'recall': 0.46293987982305523, 'f1-score': 0.4548704636643632, 'support': 599283}}
[[109723  26257  70508]
 [ 66967  54535  65072]
 [ 66289  26758 113174]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1048113
{'0': {'precision': 0.4625113783356489, 'recall': 0.4835219873785435, 'f1-score': 0.4727833688386102, 'support': 39932}, '1': {'precision': 0.5535056723079784, 'recall': 0.3483624786384812, 'f1-score': 0.4276026550961179, 'support': 42717}, '2': {'precision': 0.4445598877162283, 'recall': 0.5971402688343168, 'f1-score': 0.509675666638803, 'support': 40843}, 'accuracy': 0.47434651637353026, 'macro avg': {'precision': 0.48685897945328516, 'recall': 0.47634157828378054, 'f1-score': 0.4700205635245103, 'support': 123492}, 'weighted avg': {'precision': 0.4880499599785651, 'recall': 0.47434651637353026, 'f1-score': 0.4693564875031004, 'support': 123492}}
[[19308  5944 14680]
 [12044 14881 15792]
 [10394  6060 24389]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.102606
{'0': {'precision': 0.4562756129749253, 'recall': 0.4693819221150411, 'f1-score': 0.4627359819667512, 'support': 13995}, '1': {'precision': 0.5266731328806984, 'recall': 0.306804423278715, 'f1-score': 0.38773844741405694, 'support': 12389}, '2': {'precision': 0.4590796083007763, 'recall': 0.6056630296539259, 'f1-score': 0.5222812283537289, 'support': 14939}, 'accuracy': 0.4699077995305278, 'macro avg': {'precision': 0.4806761180521333, 'recall': 0.4606164583492274, 'f1-score': 0.45758521924484574, 'support': 41323}, 'weighted avg': {'precision': 0.4783951047902706, 'recall': 0.4699077995305278, 'f1-score': 0.46177772579468557, 'support': 41323}}
[[6569 1594 5832]
 [3759 3801 4829]
 [4069 1822 9048]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
2027/2027 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1832392
{'0': {'precision': 0.3873223363419442, 'recall': 0.19740278967460848, 'f1-score': 0.26151949452920326, 'support': 189126}, '1': {'precision': 0.3499873917794402, 'recall': 0.13987503359312012, 'f1-score': 0.19987039481579263, 'support': 148840}, '2': {'precision': 0.3547390923465986, 'recall': 0.7117919861147194, 'f1-score': 0.4734985190646298, 'support': 180911}, 'accuracy': 0.36024722622124317, 'macro avg': {'precision': 0.3640162734893277, 'recall': 0.349689936460816, 'f1-score': 0.31162946946987524, 'support': 518877}, 'weighted avg': {'precision': 0.3652523652252343, 'recall': 0.36024722622124317, 'f1-score': 0.317743773705934, 'support': 518877}}
[[ 37334  20208 131584]
 [ 25374  20819 102647]
 [ 33682  18458 128771]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2016886
{'0': {'precision': 0.36799219601767374, 'recall': 0.22592122877474813, 'f1-score': 0.27996420230065705, 'support': 28386}, '1': {'precision': 0.4144144144144144, 'recall': 0.12584593232541397, 'f1-score': 0.19306383918709963, 'support': 27780}, '2': {'precision': 0.3430471480944667, 'recall': 0.7098299343730153, 'f1-score': 0.4625518755676135, 'support': 28342}, 'accuracy': 0.35531547309130496, 'macro avg': {'precision': 0.3751512528421849, 'recall': 0.35386569849105914, 'f1-score': 0.3118599723517901, 'support': 84508}, 'weighted avg': {'precision': 0.37488641524924854, 'recall': 0.35531547309130496, 'f1-score': 0.3126333904063684, 'support': 84508}}
[[ 6413  2535 19438]
 [ 5195  3496 19089]
 [ 5819  2405 20118]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2025359
{'0': {'precision': 0.3813131313131313, 'recall': 0.23047879177377892, 'f1-score': 0.2873022231123573, 'support': 12448}, '1': {'precision': 0.3325301204819277, 'recall': 0.10646094503375121, 'f1-score': 0.16128560993425858, 'support': 10370}, '2': {'precision': 0.3467163991450484, 'recall': 0.6959703878186254, 'f1-score': 0.46285106859124986, 'support': 11887}, 'accuracy': 0.3528598184699611, 'macro avg': {'precision': 0.35351988364670245, 'recall': 0.3443033748753852, 'f1-score': 0.3038129672126219, 'support': 34705}, 'weighted avg': {'precision': 0.3548866458614217, 'recall': 0.3528598184699611, 'f1-score': 0.30977612737833377, 'support': 34705}}
[[2869 1170 8409]
 [2087 1104 7179]
 [2568 1046 8273]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
2900/2900 - 27s - 27s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2348161
{'0': {'precision': 0.4279319713956949, 'recall': 0.5427157947013542, 'f1-score': 0.47853701012054034, 'support': 261765}, '1': {'precision': 0.39403049173287524, 'recall': 0.03397707704556817, 'f1-score': 0.06255966180280921, 'support': 216028}, '2': {'precision': 0.42230033286364843, 'recall': 0.6253170298414378, 'f1-score': 0.5041374823446596, 'support': 264565}, 'accuracy': 0.42410939196452385, 'macro avg': {'precision': 0.4147542653307395, 'recall': 0.4006699671961201, 'f1-score': 0.3484113847560031, 'support': 742358}, 'weighted avg': {'precision': 0.4160595280505292, 'recall': 0.42410939196452385, 'f1-score': 0.3666101962808448, 'support': 742358}}
[[142064   5979 113722]
 [ 96095   7340 112593]
 [ 93819   5309 165437]]
Evaluating performance on  train set...
694/694 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1859474
{'0': {'precision': 0.43541605553925883, 'recall': 0.5308503210204534, 'f1-score': 0.47842035792123283, 'support': 58719}, '1': {'precision': 0.5406676783004553, 'recall': 0.17680042343445035, 'f1-score': 0.2664655731166176, 'support': 60458}, '2': {'precision': 0.42035875375392784, 'recall': 0.620504920838682, 'f1-score': 0.5011889291342937, 'support': 58425}, 'accuracy': 0.4398204975169199, 'macro avg': {'precision': 0.46548082919788064, 'recall': 0.4427185550978619, 'f1-score': 0.415358286724048, 'support': 177602}, 'weighted avg': {'precision': 0.4662917199579504, 'recall': 0.4398204975169199, 'f1-score': 0.41375831241164207, 'support': 177602}}
[[31171  4648 22900]
 [22679 10689 27090]
 [17739  4433 36253]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1770097
{'0': {'precision': 0.43944969473948314, 'recall': 0.5353540499235864, 'f1-score': 0.4826841815175455, 'support': 19630}, '1': {'precision': 0.5694654710609061, 'recall': 0.22432221661544108, 'f1-score': 0.32185875074047265, 'support': 21799}, '2': {'precision': 0.41694281886765844, 'recall': 0.6084473711287169, 'f1-score': 0.4948121496109112, 'support': 19438}, 'accuracy': 0.4473031363464603, 'macro avg': {'precision': 0.47528599488934925, 'recall': 0.4560412125559148, 'f1-score': 0.4331183606229765, 'support': 60867}, 'weighted avg': {'precision': 0.47882612621851395, 'recall': 0.4473031363464603, 'f1-score': 0.4289590082428553, 'support': 60867}}
[[10509  1844  7277]
 [ 7647  4890  9262]
 [ 5758  1853 11827]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
7167/7167 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6752015
{'0': {'precision': 0.5931861556283388, 'recall': 0.3984660816503618, 'f1-score': 0.4767085763273206, 'support': 357255}, '1': {'precision': 0.7604796677225838, 'recall': 0.8595222733581447, 'f1-score': 0.8069733699300411, 'support': 1117501}, '2': {'precision': 0.5523272648304318, 'recall': 0.5089365368314273, 'f1-score': 0.5297448663003372, 'support': 359815}, 'accuracy': 0.7009780488190427, 'macro avg': {'precision': 0.6353310293937847, 'recall': 0.5889749639466446, 'f1-score': 0.6044756041858996, 'support': 1834571}, 'weighted avg': {'precision': 0.6870767846998667, 'recall': 0.7009780488190427, 'f1-score': 0.6882863728762003, 'support': 1834571}}
[[142354 161494  53407]
 [ 61966 960517  95018]
 [ 35662 141030 183123]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59890705
{'0': {'precision': 0.6084960774495076, 'recall': 0.4285105570167061, 'f1-score': 0.5028839438902636, 'support': 68059}, '1': {'precision': 0.8039056060405622, 'recall': 0.8924591892451658, 'f1-score': 0.8458710619206871, 'support': 265555}, '2': {'precision': 0.5695678719218507, 'recall': 0.4932657707277668, 'f1-score': 0.5286779116718746, 'support': 68085}, 'accuracy': 0.7461930450411876, 'macro avg': {'precision': 0.6606565184706402, 'recall': 0.6047451723298796, 'f1-score': 0.625810972494275, 'support': 401699}, 'weighted avg': {'precision': 0.7310792815193384, 'recall': 0.7461930450411876, 'f1-score': 0.7339976046785156, 'support': 401699}}
[[ 29164  29289   9606]
 [ 12784 236997  15774]
 [  5980  28521  33584]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6563513
{'0': {'precision': 0.5783852581484146, 'recall': 0.4321150983958988, 'f1-score': 0.4946638585863366, 'support': 24188}, '1': {'precision': 0.7978232865002829, 'recall': 0.8544755912009696, 'f1-score': 0.8251782212122154, 'support': 77554}, '2': {'precision': 0.5371679259078723, 'recall': 0.550816394535155, 'f1-score': 0.5439065520503434, 'support': 24008}, 'accuracy': 0.7152604373757455, 'macro avg': {'precision': 0.6377921568521899, 'recall': 0.6124690280440078, 'f1-score': 0.6212495439496318, 'support': 125750}, 'weighted avg': {'precision': 0.7058504759485725, 'recall': 0.7152604373757455, 'f1-score': 0.7079038543220924, 'support': 125750}}
[[10452  8967  4769]
 [ 4661 66268  6625]
 [ 2958  7826 13224]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
6357/6357 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7789104
{'0': {'precision': 0.5873418859107147, 'recall': 0.38649528523653653, 'f1-score': 0.46620703430122445, 'support': 338193}, '1': {'precision': 0.7355914696948919, 'recall': 0.7991669466757115, 'f1-score': 0.7660624402724413, 'support': 946398}, '2': {'precision': 0.4816314278048301, 'recall': 0.529225461062882, 'f1-score': 0.5043080128343317, 'support': 342578}, 'accuracy': 0.6565642536208594, 'macro avg': {'precision': 0.6015215944701456, 'recall': 0.57162923099171, 'f1-score': 0.5788591624693326, 'support': 1627169}, 'weighted avg': {'precision': 0.651311290611259, 'recall': 0.6565642536208594, 'f1-score': 0.6486313021703041, 'support': 1627169}}
[[130710 142154  65329]
 [ 60267 756330 129801]
 [ 31568 129709 181301]]
Evaluating performance on  train set...
1701/1701 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75231844
{'0': {'precision': 0.5806929656416617, 'recall': 0.4062566911209529, 'f1-score': 0.47805964805261975, 'support': 88737}, '1': {'precision': 0.7549704049447571, 'recall': 0.8118647648407364, 'f1-score': 0.7823846210397538, 'support': 255614}, '2': {'precision': 0.4964960390006094, 'recall': 0.5368025739290851, 'f1-score': 0.5158631751676542, 'support': 91067}, 'accuracy': 0.6716741154476847, 'macro avg': {'precision': 0.6107198031956761, 'recall': 0.5849746766302582, 'f1-score': 0.5921024814200093, 'support': 435418}, 'weighted avg': {'precision': 0.6653936253562365, 'recall': 0.6716741154476847, 'f1-score': 0.6646214747316228, 'support': 435418}}
[[ 36050  34408  18279]
 [ 16794 207524  31296]
 [  9237  32945  48885]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76505923
{'0': {'precision': 0.5838083808380838, 'recall': 0.3935747033441208, 'f1-score': 0.47017840602472716, 'support': 29664}, '1': {'precision': 0.7442250188939638, 'recall': 0.8029662018435358, 'f1-score': 0.7724805166013904, 'support': 84620}, '2': {'precision': 0.49035467920151393, 'recall': 0.5395465994962216, 'f1-score': 0.5137758446999376, 'support': 29775}, 'accuracy': 0.6642209094884735, 'macro avg': {'precision': 0.6061293596445204, 'recall': 0.5786958348946261, 'f1-score': 0.5854782557753517, 'support': 144059}, 'weighted avg': {'precision': 0.6587212425548783, 'recall': 0.6642209094884735, 'f1-score': 0.6567611140370807, 'support': 144059}}
[[11675 12317  5672]
 [ 5648 67947 11025]
 [ 2675 11035 16065]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
7459/7459 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.959918
{'0': {'precision': 0.5232062485534715, 'recall': 0.43853704840720664, 'f1-score': 0.4771446282473603, 'support': 530954}, '1': {'precision': 0.6188481727356301, 'recall': 0.6072625541897618, 'f1-score': 0.6130006267435144, 'support': 821419}, '2': {'precision': 0.47981628098131357, 'recall': 0.5670990773562612, 'f1-score': 0.5198192348177905, 'support': 556878}, 'accuracy': 0.5486261366368277, 'macro avg': {'precision': 0.5406235674234717, 'recall': 0.5376328933177432, 'f1-score': 0.5366548299362218, 'support': 1909251}, 'weighted avg': {'precision': 0.5516986654007778, 'recall': 0.5486261366368277, 'f1-score': 0.5480411462989107, 'support': 1909251}}
[[232843 154815 143296]
 [123524 498817 199078]
 [ 88664 152409 315805]]
Evaluating performance on  train set...
1664/1664 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7510546
{'0': {'precision': 0.5720429469687982, 'recall': 0.43674282738162634, 'f1-score': 0.49531954235525255, 'support': 88322}, '1': {'precision': 0.759549813634172, 'recall': 0.7980675668068612, 'f1-score': 0.7783324444723303, 'support': 248702}, '2': {'precision': 0.49792731723875455, 'recall': 0.5442719167069564, 'f1-score': 0.5200691892821074, 'support': 88939}, 'accuracy': 0.6701567976561345, 'macro avg': {'precision': 0.6098400259472415, 'recall': 0.5930274369651479, 'f1-score': 0.5979070587032301, 'support': 425963}, 'weighted avg': {'precision': 0.666045390281601, 'recall': 0.6701567976561345, 'f1-score': 0.6657265580593137, 'support': 425963}}
[[ 38574  32061  17687]
 [ 19098 198481  31123]
 [  9760  30772  48407]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8410657
{'0': {'precision': 0.5470146585627458, 'recall': 0.4248164373418893, 'f1-score': 0.47823293451647075, 'support': 32414}, '1': {'precision': 0.7130996977104095, 'recall': 0.7350319041087722, 'f1-score': 0.7238997173585875, 'support': 67076}, '2': {'precision': 0.4954310162687513, 'recall': 0.5739154378021171, 'f1-score': 0.531793054571226, 'support': 32686}, 'accuracy': 0.619113908727757, 'macro avg': {'precision': 0.5851817908473022, 'recall': 0.5779212597509261, 'f1-score': 0.5779752354820947, 'support': 132176}, 'weighted avg': {'precision': 0.6185424484326707, 'recall': 0.619113908727757, 'f1-score': 0.6161476180447025, 'support': 132176}}
[[13770 10405  8239]
 [ 6907 49303 10866]
 [ 4496  9431 18759]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
8238/8238 - 71s - 71s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0035024
{'0': {'precision': 0.5164080514572028, 'recall': 0.4540755036831065, 'f1-score': 0.4832400195334364, 'support': 655968}, '1': {'precision': 0.6047079781526182, 'recall': 0.5024821602558804, 'f1-score': 0.5488758626821978, 'support': 798498}, '2': {'precision': 0.46387774466497467, 'recall': 0.615725229576552, 'f1-score': 0.5291227194514863, 'support': 654248}, 'accuracy': 0.5225587727875852, 'macro avg': {'precision': 0.5283312580915985, 'recall': 0.5240942978385129, 'f1-score': 0.5204128672223735, 'support': 2108714}, 'weighted avg': {'precision': 0.53354620613737, 'recall': 0.5225587727875852, 'f1-score': 0.5223296040567923, 'support': 2108714}}
[[297859 140362 217747]
 [149439 401231 247828]
 [129492 121919 402837]]
Evaluating performance on  train set...
1806/1806 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86829144
{'0': {'precision': 0.5439001491136025, 'recall': 0.42979837653836084, 'f1-score': 0.48016381853197143, 'support': 114570}, '1': {'precision': 0.6955332387113811, 'recall': 0.7225675096442349, 'f1-score': 0.7087926873365455, 'support': 233300}, '2': {'precision': 0.4880473464335448, 'recall': 0.5519585626416316, 'f1-score': 0.5180391947543245, 'support': 114293}, 'accuracy': 0.6077985472657915, 'macro avg': {'precision': 0.5758269114195095, 'recall': 0.5681081496080758, 'f1-score': 0.5689985668742805, 'support': 462163}, 'weighted avg': {'precision': 0.6066321623350198, 'recall': 0.6077985472657915, 'f1-score': 0.6049423176041354, 'support': 462163}}
[[ 49242  38199  27129]
 [ 25679 168575  39046]
 [ 15614  35594  63085]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.860538
{'0': {'precision': 0.5521070868007226, 'recall': 0.43493374393430384, 'f1-score': 0.48656548916234943, 'support': 42864}, '1': {'precision': 0.7011636663994364, 'recall': 0.7284428908547127, 'f1-score': 0.7145430125828592, 'support': 79243}, '2': {'precision': 0.49808206680627837, 'recall': 0.5690394409570058, 'f1-score': 0.5312016275264252, 'support': 42215}, 'accuracy': 0.6109285427392559, 'macro avg': {'precision': 0.5837842733354791, 'recall': 0.577472025248674, 'f1-score': 0.5774367097572113, 'support': 164322}, 'weighted avg': {'precision': 0.6101092065295198, 'recall': 0.6109285427392559, 'f1-score': 0.6079730759094126, 'support': 164322}}
[[18643 12927 11294]
 [ 8606 57724 12913]
 [ 6518 11675 24022]]
testing model on single stock: results/universal/W5/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
31315/31315 - 321s - 321s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0300951
{'0': {'precision': 0.5337470327292646, 'recall': 0.5229889581736447, 'f1-score': 0.5283132342958109, 'support': 3137615}, '1': {'precision': 0.4730647128522181, 'recall': 0.1937210180733195, 'f1-score': 0.2748786410323718, 'support': 1683808}, '2': {'precision': 0.5030770666998386, 'recall': 0.6695893007430527, 'f1-score': 0.5745112687864579, 'support': 3195063}, 'accuracy': 0.5122577398625782, 'macro avg': {'precision': 0.5032962707604405, 'recall': 0.46209975899667227, 'f1-score': 0.4592343813715469, 'support': 8016486}, 'weighted avg': {'precision': 0.5087772580250606, 'recall': 0.5122577398625782, 'f1-score': 0.4934937928422944, 'support': 8016486}}
[[1640938  198029 1298648]
 [ 543058  326189  814561]
 [ 890378  165305 2139380]]
Evaluating performance on  train set...
5759/5759 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0124081
{'0': {'precision': 0.5352806238057195, 'recall': 0.46997052736934725, 'f1-score': 0.5005040118909674, 'support': 487571}, '1': {'precision': 0.576711776025824, 'recall': 0.44823773490836866, 'f1-score': 0.5044228567808843, 'support': 497428}, '2': {'precision': 0.4759141376308998, 'recall': 0.6415991888350339, 'f1-score': 0.5464742431747962, 'support': 489173}, 'accuracy': 0.519588623308542, 'macro avg': {'precision': 0.5293021791541478, 'recall': 0.5199358170375833, 'f1-score': 0.5171337039488826, 'support': 1474172}, 'weighted avg': {'precision': 0.5295611643701497, 'recall': 0.519588623308542, 'f1-score': 0.5170805980177599, 'support': 1474172}}
[[229144  85621 172806]
 [101647 222966 172815]
 [ 97291  78029 313853]]
Evaluating performance on  val set...
2129/2129 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0092762
{'0': {'precision': 0.5244558087081772, 'recall': 0.48791382301307823, 'f1-score': 0.5055253152806516, 'support': 192534}, '1': {'precision': 0.5600697259607589, 'recall': 0.43179232663674666, 'f1-score': 0.48763597602727643, 'support': 159982}, '2': {'precision': 0.4914281943739922, 'recall': 0.6192678667941629, 'f1-score': 0.5479909405502351, 'support': 192424}, 'accuracy': 0.5178203104928983, 'macro avg': {'precision': 0.525317909680976, 'recall': 0.5129913388146626, 'f1-score': 0.5137174106193877, 'support': 544940}, 'weighted avg': {'precision': 0.5232488502343292, 'recall': 0.5178203104928983, 'f1-score': 0.5152684671954328, 'support': 544940}}
[[ 93940  28629  69965]
 [ 37549  69079  53354]
 [ 47630  25632 119162]]
training model: results/universal/W5/deepVOL_L2/h30
Epoch 1/50
9913/9913 - 336s - loss: 2.8459 - accuracy30: 0.5218 - val_loss: 3.0703 - val_accuracy30: 0.5102 - 336s/epoch - 34ms/step
Epoch 2/50
9913/9913 - 320s - loss: 2.7698 - accuracy30: 0.5453 - val_loss: 3.0848 - val_accuracy30: 0.5184 - 320s/epoch - 32ms/step
Epoch 3/50
9913/9913 - 312s - loss: 2.7383 - accuracy30: 0.5521 - val_loss: 3.0269 - val_accuracy30: 0.5239 - 312s/epoch - 31ms/step
Epoch 4/50
9913/9913 - 320s - loss: 2.7205 - accuracy30: 0.5561 - val_loss: 3.0251 - val_accuracy30: 0.5257 - 320s/epoch - 32ms/step
Epoch 5/50
9913/9913 - 326s - loss: 2.7087 - accuracy30: 0.5586 - val_loss: 3.0028 - val_accuracy30: 0.5298 - 326s/epoch - 33ms/step
Epoch 6/50
9913/9913 - 326s - loss: 2.7009 - accuracy30: 0.5602 - val_loss: 2.9867 - val_accuracy30: 0.5315 - 326s/epoch - 33ms/step
Epoch 7/50
9913/9913 - 329s - loss: 2.6938 - accuracy30: 0.5617 - val_loss: 2.9755 - val_accuracy30: 0.5326 - 329s/epoch - 33ms/step
Epoch 8/50
9913/9913 - 324s - loss: 2.6881 - accuracy30: 0.5630 - val_loss: 2.9658 - val_accuracy30: 0.5333 - 324s/epoch - 33ms/step
Epoch 9/50
9913/9913 - 327s - loss: 2.6830 - accuracy30: 0.5643 - val_loss: 2.9580 - val_accuracy30: 0.5342 - 327s/epoch - 33ms/step
Epoch 10/50
9913/9913 - 330s - loss: 2.6785 - accuracy30: 0.5649 - val_loss: 2.9489 - val_accuracy30: 0.5361 - 330s/epoch - 33ms/step
Epoch 11/50
9913/9913 - 328s - loss: 2.6747 - accuracy30: 0.5657 - val_loss: 2.9484 - val_accuracy30: 0.5363 - 328s/epoch - 33ms/step
Epoch 12/50
9913/9913 - 327s - loss: 2.6713 - accuracy30: 0.5667 - val_loss: 2.9397 - val_accuracy30: 0.5378 - 327s/epoch - 33ms/step
Epoch 13/50
9913/9913 - 328s - loss: 2.6676 - accuracy30: 0.5674 - val_loss: 2.9509 - val_accuracy30: 0.5364 - 328s/epoch - 33ms/step
Epoch 14/50
9913/9913 - 327s - loss: 2.6645 - accuracy30: 0.5680 - val_loss: 2.9417 - val_accuracy30: 0.5383 - 327s/epoch - 33ms/step
Epoch 15/50
9913/9913 - 329s - loss: 2.6619 - accuracy30: 0.5686 - val_loss: 2.9438 - val_accuracy30: 0.5382 - 329s/epoch - 33ms/step
Epoch 16/50
9913/9913 - 330s - loss: 2.6593 - accuracy30: 0.5693 - val_loss: 2.9381 - val_accuracy30: 0.5371 - 330s/epoch - 33ms/step
Epoch 17/50
9913/9913 - 325s - loss: 2.6572 - accuracy30: 0.5696 - val_loss: 2.9449 - val_accuracy30: 0.5367 - 325s/epoch - 33ms/step
Epoch 18/50
9913/9913 - 329s - loss: 2.6546 - accuracy30: 0.5702 - val_loss: 2.9429 - val_accuracy30: 0.5362 - 329s/epoch - 33ms/step
Epoch 19/50
9913/9913 - 329s - loss: 2.6527 - accuracy30: 0.5704 - val_loss: 2.9419 - val_accuracy30: 0.5368 - 329s/epoch - 33ms/step
Epoch 20/50
9913/9913 - 328s - loss: 2.6508 - accuracy30: 0.5710 - val_loss: 2.9400 - val_accuracy30: 0.5373 - 328s/epoch - 33ms/step
Epoch 21/50
9913/9913 - 326s - loss: 2.6488 - accuracy30: 0.5714 - val_loss: 2.9321 - val_accuracy30: 0.5379 - 326s/epoch - 33ms/step
Epoch 22/50
9913/9913 - 328s - loss: 2.6471 - accuracy30: 0.5717 - val_loss: 2.9550 - val_accuracy30: 0.5362 - 328s/epoch - 33ms/step
Epoch 23/50
9913/9913 - 326s - loss: 2.6453 - accuracy30: 0.5723 - val_loss: 2.9408 - val_accuracy30: 0.5385 - 326s/epoch - 33ms/step
Epoch 24/50
9913/9913 - 326s - loss: 2.6440 - accuracy30: 0.5725 - val_loss: 2.9422 - val_accuracy30: 0.5380 - 326s/epoch - 33ms/step
Epoch 25/50
9913/9913 - 327s - loss: 2.6422 - accuracy30: 0.5729 - val_loss: 2.9514 - val_accuracy30: 0.5366 - 327s/epoch - 33ms/step
Epoch 26/50
9913/9913 - 327s - loss: 2.6406 - accuracy30: 0.5731 - val_loss: 2.9417 - val_accuracy30: 0.5387 - 327s/epoch - 33ms/step
Epoch 27/50
9913/9913 - 326s - loss: 2.6392 - accuracy30: 0.5733 - val_loss: 2.9625 - val_accuracy30: 0.5372 - 326s/epoch - 33ms/step
Epoch 28/50
9913/9913 - 329s - loss: 2.6375 - accuracy30: 0.5738 - val_loss: 2.9541 - val_accuracy30: 0.5376 - 329s/epoch - 33ms/step
Epoch 29/50
9913/9913 - 325s - loss: 2.6364 - accuracy30: 0.5740 - val_loss: 2.9608 - val_accuracy30: 0.5373 - 325s/epoch - 33ms/step
Epoch 30/50
9913/9913 - 326s - loss: 2.6351 - accuracy30: 0.5743 - val_loss: 2.9605 - val_accuracy30: 0.5379 - 326s/epoch - 33ms/step
Epoch 31/50
9913/9913 - 327s - loss: 2.6340 - accuracy30: 0.5746 - val_loss: 2.9771 - val_accuracy30: 0.5362 - 327s/epoch - 33ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 808s - 808s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0245138
{'0': {'precision': 0.517945856864883, 'recall': 0.46675437182363383, 'f1-score': 0.4910194717464504, 'support': 4441396}, '1': {'precision': 0.588216153022239, 'recall': 0.4416709612343689, 'f1-score': 0.5045174177296937, 'support': 3859527}, '2': {'precision': 0.48014315981919103, 'recall': 0.6283416213623986, 'f1-score': 0.5443357214255391, 'support': 4537468}, 'accuracy': 0.5163234240178539, 'macro avg': {'precision': 0.5287683899021044, 'recall': 0.5122556514734672, 'f1-score': 0.5132908703005611, 'support': 12838391}, 'weighted avg': {'precision': 0.5257101925327085, 'recall': 0.5163234240178539, 'f1-score': 0.5139208200357916, 'support': 12838391}}
[[2073041  646134 1722221]
 [ 790208 1704641 1364678]
 [1139179  547209 2851080]]
Evaluating performance on  train set...
9913/9913 - 164s - 164s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.944035
{'0': {'precision': 0.5343901965945773, 'recall': 0.4238554868911028, 'f1-score': 0.4727476906413043, 'support': 728017}, '1': {'precision': 0.6690007837759413, 'recall': 0.5993339223186904, 'f1-score': 0.6322540286062271, 'support': 1080955}, '2': {'precision': 0.4563544428437105, 'recall': 0.6212995889080722, 'f1-score': 0.5262038082375515, 'support': 728061}, 'accuracy': 0.555282883588822, 'macro avg': {'precision': 0.5532484744047431, 'recall': 0.5481629993726219, 'f1-score': 0.543735175828361, 'support': 2537033}, 'weighted avg': {'precision': 0.569349615078697, 'recall': 0.555282883588822, 'f1-score': 0.556049125028683, 'support': 2537033}}
[[308574 170987 248456]
 [142690 647853 290412]
 [126168 149549 452344]]
Evaluating performance on  val set...
3496/3496 - 58s - 58s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96826124
{'0': {'precision': 0.5140347011155415, 'recall': 0.4442923112860043, 'f1-score': 0.4766257498419357, 'support': 278265}, '1': {'precision': 0.6410911644173187, 'recall': 0.5641611388204819, 'f1-score': 0.6001709690722953, 'support': 336629}, '2': {'precision': 0.4678661944644925, 'recall': 0.5987648796205137, 'f1-score': 0.5252834881964324, 'support': 279325}, 'accuracy': 0.5376691839471092, 'macro avg': {'precision': 0.5409973533324509, 'recall': 0.5357394432423334, 'f1-score': 0.5340267357035544, 'support': 894219}, 'weighted avg': {'precision': 0.5474435999026503, 'recall': 0.5376691839471092, 'f1-score': 0.5383334818071103, 'support': 894219}}
[[123631  57267  97367]
 [ 53859 189913  92857]
 [ 63021  49054 167250]]
testing model out of sample: results/universal/W5/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 339s - 339s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0233479
{'0': {'precision': 0.5048514151654753, 'recall': 0.4489732847017525, 'f1-score': 0.47527558928747243, 'support': 1714935}, '1': {'precision': 0.5905862795120832, 'recall': 0.49080350260585187, 'f1-score': 0.5360912769265969, 'support': 1923939}, '2': {'precision': 0.45685560733948416, 'recall': 0.5944151066977783, 'f1-score': 0.516635479246409, 'support': 1709970}, 'accuracy': 0.5105155431715713, 'macro avg': {'precision': 0.5174311006723475, 'recall': 0.5113972980017942, 'f1-score': 0.5093341151534928, 'support': 5348844}, 'weighted avg': {'precision': 0.5203458393191688, 'recall': 0.5105155431715713, 'f1-score': 0.5103728634449937, 'support': 5348844}}
[[ 769960  353725  591250]
 [ 362502  944276  617161]
 [ 392660  300878 1016432]]
Evaluating performance on  train set...
4957/4957 - 83s - 83s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97192866
{'0': {'precision': 0.5161575299478811, 'recall': 0.42112279002718894, 'f1-score': 0.4638221767229158, 'support': 359337}, '1': {'precision': 0.6406713566263643, 'recall': 0.5960801115800797, 'f1-score': 0.6175718623529578, 'support': 548485}, '2': {'precision': 0.4555584716192902, 'recall': 0.587398272504868, 'f1-score': 0.5131454602728441, 'support': 360522}, 'accuracy': 0.5440448332629003, 'macro avg': {'precision': 0.5374624527311785, 'recall': 0.5348670580373788, 'f1-score': 0.5315131664495726, 'support': 1268344}, 'weighted avg': {'precision': 0.5527774631198026, 'recall': 0.5440448332629003, 'f1-score': 0.5443299294735741, 'support': 1268344}}
[[151325  98218 109794]
 [ 78250 326941 143294]
 [ 63601  85151 211770]]
Evaluating performance on  val set...
1701/1701 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9665077
{'0': {'precision': 0.5188703264850467, 'recall': 0.42008039133295805, 'f1-score': 0.46427836022624214, 'support': 126133}, '1': {'precision': 0.6377220972607278, 'recall': 0.5991285165123187, 'f1-score': 0.6178231870919425, 'support': 183136}, '2': {'precision': 0.46046948123380216, 'recall': 0.5889366708266098, 'f1-score': 0.5168396673921535, 'support': 125803}, 'accuracy': 0.5442731318034716, 'macro avg': {'precision': 0.5390206349931922, 'recall': 0.5360485262239622, 'f1-score': 0.5329804049034461, 'support': 435072}, 'weighted avg': {'precision': 0.5520120509757812, 'recall': 0.5442731318034716, 'f1-score': 0.5441087228748843, 'support': 435072}}
[[ 52986  33650  39497]
 [ 26100 109722  47314]
 [ 23032  28681  74090]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0501127
{'0': {'precision': 0.48077625968148985, 'recall': 0.5207072706365813, 'f1-score': 0.4999457033229567, 'support': 106098}, '1': {'precision': 0.43041009463722396, 'recall': 0.21059455454713835, 'f1-score': 0.2828123704502114, 'support': 64788}, '2': {'precision': 0.44746211210007214, 'recall': 0.5556186152099887, 'f1-score': 0.4957094126425754, 'support': 100434}, 'accuracy': 0.45957909479581305, 'macro avg': {'precision': 0.4528828221395953, 'recall': 0.42897348013123615, 'f1-score': 0.4261558288052478, 'support': 271320}, 'weighted avg': {'precision': 0.4564175828457239, 'recall': 0.45957909479581305, 'f1-score': 0.4465286976162162, 'support': 271320}}
[[55246  9982 40870]
 [23107 13644 28037]
 [36557  8074 55803]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0692635
{'0': {'precision': 0.4598630195260986, 'recall': 0.46200529959825626, 'f1-score': 0.4609316703976122, 'support': 23398}, '1': {'precision': 0.551961862852952, 'recall': 0.3305081024109613, 'f1-score': 0.4134483326924133, 'support': 22771}, '2': {'precision': 0.4363144464598641, 'recall': 0.6039148936170213, 'f1-score': 0.5066128830742321, 'support': 23500}, 'accuracy': 0.4668934533293143, 'macro avg': {'precision': 0.48271310961297154, 'recall': 0.4654760985420796, 'f1-score': 0.4603309620547525, 'support': 69669}, 'weighted avg': {'precision': 0.48202196101139727, 'recall': 0.4668934533293143, 'f1-score': 0.4608206513649791, 'support': 69669}}
[[10810  3434  9154]
 [ 6064  7526  9181]
 [ 6633  2675 14192]]
Evaluating performance on  val set...
96/96 - 1s - 892ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0541955
{'0': {'precision': 0.47593582887700536, 'recall': 0.4338882282996433, 'f1-score': 0.45394041176836475, 'support': 8410}, '1': {'precision': 0.5487924602395444, 'recall': 0.3506021073758154, 'f1-score': 0.4278606965174129, 'support': 7972}, '2': {'precision': 0.42475087300911335, 'recall': 0.614238206675699, 'f1-score': 0.5022155085599195, 'support': 8119}, 'accuracy': 0.4665523856169136, 'macro avg': {'precision': 0.48315972070855445, 'recall': 0.46624284745038586, 'f1-score': 0.461338872281899, 'support': 24501}, 'weighted avg': {'precision': 0.4826801417022266, 'recall': 0.4665523856169136, 'f1-score': 0.4614518611324742, 'support': 24501}}
[[3649 1265 3496]
 [1919 2795 3258]
 [2099 1033 4987]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7775098
{'0': {'precision': 0.6071088017025746, 'recall': 0.37236603434538645, 'f1-score': 0.46160797314265606, 'support': 117978}, '1': {'precision': 0.738837825551872, 'recall': 0.8260362951209838, 'f1-score': 0.78000760834577, 'support': 322688}, '2': {'precision': 0.4909536538354763, 'recall': 0.5221528597941623, 'f1-score': 0.5060728579429549, 'support': 118540}, 'accuracy': 0.6659066605150875, 'macro avg': {'precision': 0.612300093696641, 'recall': 0.5735183964201774, 'f1-score': 0.5825628131437935, 'support': 559206}, 'weighted avg': {'precision': 0.658500138740654, 'recall': 0.6659066605150875, 'f1-score': 0.6547650725454698, 'support': 559206}}
[[ 43931  50475  23572]
 [ 15531 266552  40605]
 [ 12899  43745  61896]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.56891483
{'0': {'precision': 0.6337353123067409, 'recall': 0.4051396095873486, 'f1-score': 0.4942871785595852, 'support': 20235}, '1': {'precision': 0.839406378809379, 'recall': 0.9060317633973342, 'f1-score': 0.8714474872631293, 'support': 109686}, '2': {'precision': 0.5385012652997986, 'recall': 0.5020221473278768, 'f1-score': 0.519622255998804, 'support': 20770}, 'accuracy': 0.7830859175398663, 'macro avg': {'precision': 0.6705476521386395, 'recall': 0.6043978401041865, 'f1-score': 0.6284523072738395, 'support': 150691}, 'weighted avg': {'precision': 0.7703143080269509, 'recall': 0.7830859175398663, 'f1-score': 0.7723091916782817, 'support': 150691}}
[[ 8198  9920  2117]
 [ 3488 99379  6819]
 [ 1250  9093 10427]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.63732624
{'0': {'precision': 0.6120436061602353, 'recall': 0.39156426436399866, 'f1-score': 0.4775857412908453, 'support': 9033}, '1': {'precision': 0.7930023142313773, 'recall': 0.9076104059582503, 'f1-score': 0.8464445123815348, 'support': 38132}, '2': {'precision': 0.6054525325214504, 'recall': 0.461351892860909, 'f1-score': 0.5236698785085881, 'support': 9483}, 'accuracy': 0.7506178505860754, 'macro avg': {'precision': 0.670166150971021, 'recall': 0.5868421877277193, 'f1-score': 0.6159000440603227, 'support': 56648}, 'weighted avg': {'precision': 0.7327506797524573, 'recall': 0.7506178505860754, 'f1-score': 0.7335936944836504, 'support': 56648}}
[[ 3537  4628   868]
 [ 1540 34609  1983]
 [  702  4406  4375]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1310525
{'0': {'precision': 0.47034704295335883, 'recall': 0.45278567991890767, 'f1-score': 0.46139932073657475, 'support': 214077}, '1': {'precision': 0.41660735149944267, 'recall': 0.36181367546289545, 'f1-score': 0.38728202823372254, 'support': 171475}, '2': {'precision': 0.4533296216999554, 'recall': 0.5181185696038478, 'f1-score': 0.4835636058758799, 'support': 213731}, 'accuracy': 0.4500561504331009, 'macro avg': {'precision': 0.44676133871758567, 'recall': 0.4442393083285503, 'f1-score': 0.4440816516153924, 'support': 599283}, 'weighted avg': {'precision': 0.44890114167804906, 'recall': 0.4500561504331009, 'f1-score': 0.4480966441967468, 'support': 599283}}
[[ 96931  45715  71431]
 [ 47325  62042  62108]
 [ 61828  41165 110738]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.141867
{'0': {'precision': 0.4705456972798576, 'recall': 0.4138049114568046, 'f1-score': 0.4403550326661288, 'support': 40884}, '1': {'precision': 0.4918695336427647, 'recall': 0.3761439092116383, 'f1-score': 0.42629231316531213, 'support': 41415}, '2': {'precision': 0.4306835878067553, 'recall': 0.584104095356007, 'f1-score': 0.495796414588914, 'support': 41193}, 'accuracy': 0.4579810837949017, 'macro avg': {'precision': 0.4643662729097926, 'recall': 0.45801763867481665, 'f1-score': 0.45414792014011834, 'support': 123492}, 'weighted avg': {'precision': 0.4644002531008362, 'recall': 0.4579810837949017, 'f1-score': 0.4541323568443668, 'support': 123492}}
[[16918  8609 15357]
 [ 9388 15578 16449]
 [ 9648  7484 24061]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1218318
{'0': {'precision': 0.46484464462936104, 'recall': 0.4249424244539047, 'f1-score': 0.4439988333090273, 'support': 14329}, '1': {'precision': 0.4615214016411621, 'recall': 0.34924897205672567, 'f1-score': 0.3976116551229998, 'support': 11917}, '2': {'precision': 0.4569405394147662, 'recall': 0.582078662863965, 'f1-score': 0.511973864597614, 'support': 15077}, 'accuracy': 0.46044575660044046, 'macro avg': {'precision': 0.46110219522842977, 'recall': 0.4520900197915318, 'f1-score': 0.45119478434321364, 'support': 41323}, 'weighted avg': {'precision': 0.46100239501024304, 'recall': 0.46044575660044046, 'f1-score': 0.45542258144675035, 'support': 41323}}
[[6089 2445 5795]
 [3120 4162 4635]
 [3890 2411 8776]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
2027/2027 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2165579
{'0': {'precision': 0.4152583196178395, 'recall': 0.10910136000970305, 'f1-score': 0.17280217829803762, 'support': 189631}, '1': {'precision': 0.2567960157709068, 'recall': 0.03283799920392729, 'f1-score': 0.05822981366459628, 'support': 150740}, '2': {'precision': 0.3444536094393024, 'recall': 0.8679148039841798, 'f1-score': 0.4931774592740555, 'support': 178506}, 'accuracy': 0.34799576778311625, 'macro avg': {'precision': 0.3388359816093496, 'recall': 0.33661805439927006, 'f1-score': 0.24140315041222982, 'support': 518877}, 'weighted avg': {'precision': 0.3448646169156257, 'recall': 0.34799576778311625, 'f1-score': 0.2497342289787579, 'support': 518877}}
[[ 20689   7540 161402]
 [ 12341   4950 133449]
 [ 16792   6786 154928]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2153544
{'0': {'precision': 0.3970473210793899, 'recall': 0.14358956226575206, 'f1-score': 0.2109062581147754, 'support': 28282}, '1': {'precision': 0.33323572474377744, 'recall': 0.040663188737225756, 'f1-score': 0.07248176809655743, 'support': 27986}, '2': {'precision': 0.33483383898962815, 'recall': 0.8402266288951842, 'f1-score': 0.4788456687351798, 'support': 28240}, 'accuracy': 0.3422989539451886, 'macro avg': {'precision': 0.3550389616042651, 'recall': 0.34149312663272063, 'f1-score': 0.25407789831550426, 'support': 84508}, 'weighted avg': {'precision': 0.35512537204186295, 'recall': 0.3422989539451886, 'f1-score': 0.25460225350302707, 'support': 84508}}
[[ 4061  1192 23029]
 [ 2740  1138 24108]
 [ 3427  1085 23728]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2162001
{'0': {'precision': 0.3886223440712817, 'recall': 0.1363417762103238, 'f1-score': 0.20186316976206015, 'support': 12476}, '1': {'precision': 0.2617403314917127, 'recall': 0.0368892349620401, 'f1-score': 0.06466473298072001, 'support': 10274}, '2': {'precision': 0.3428324099722992, 'recall': 0.8281890422417398, 'f1-score': 0.4849271458307825, 'support': 11955}, 'accuracy': 0.3452240311194352, 'macro avg': {'precision': 0.3310650285117645, 'recall': 0.3338066844713679, 'f1-score': 0.25048501619118757, 'support': 34705}, 'weighted avg': {'precision': 0.33528696129082275, 'recall': 0.3452240311194352, 'f1-score': 0.25875563754509107, 'support': 34705}}
[[ 1701   527 10248]
 [ 1164   379  8731]
 [ 1512   542  9901]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
2900/2900 - 28s - 28s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2659222
{'0': {'precision': 0.4189393982554993, 'recall': 0.5609411890349723, 'f1-score': 0.47965102531697174, 'support': 262179}, '1': {'precision': 0.31781767289223495, 'recall': 0.060945814631437695, 'f1-score': 0.10227837485245699, 'support': 216110}, '2': {'precision': 0.4295909909394918, 'recall': 0.5691732085174708, 'f1-score': 0.48962844842891556, 'support': 264069}, 'accuracy': 0.41831434429210707, 'macro avg': {'precision': 0.38878268736240873, 'recall': 0.39702007072796025, 'f1-score': 0.35718594953278143, 'support': 742358}, 'weighted avg': {'precision': 0.3932905056190815, 'recall': 0.41831434429210707, 'f1-score': 0.37334210785647637, 'support': 742358}}
[[147067  15791  99321]
 [102691  13171 100248]
 [101288  12480 150301]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2365935
{'0': {'precision': 0.4334056653568706, 'recall': 0.49542452988301544, 'f1-score': 0.46234456870258855, 'support': 59666}, '1': {'precision': 0.44446036978644116, 'recall': 0.21027292761484997, 'f1-score': 0.28548413082004187, 'support': 58990}, '2': {'precision': 0.41403853233525584, 'recall': 0.5723882875852475, 'f1-score': 0.48050357458201604, 'support': 58946}, 'accuracy': 0.42625646107588877, 'macro avg': {'precision': 0.4306348558261892, 'recall': 0.42602858169437097, 'f1-score': 0.4094440913682155, 'support': 177602}, 'weighted avg': {'precision': 0.43064951391267664, 'recall': 0.42625646107588877, 'f1-score': 0.4096278398925374, 'support': 177602}}
[[29560  8385 21721]
 [20557 12404 26029]
 [18087  7119 33740]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2284414
{'0': {'precision': 0.4301388080791289, 'recall': 0.5208333333333334, 'f1-score': 0.4711612873856239, 'support': 19872}, '1': {'precision': 0.4801710730948678, 'recall': 0.23207742177957344, 'f1-score': 0.3129156901247862, 'support': 21286}, '2': {'precision': 0.411849002526681, 'recall': 0.5541123344664874, 'f1-score': 0.4725046510621728, 'support': 19709}, 'accuracy': 0.43062743358470107, 'macro avg': {'precision': 0.4407196279002259, 'recall': 0.4356743631931314, 'f1-score': 0.41886054285752766, 'support': 60867}, 'weighted avg': {'precision': 0.4417134382644809, 'recall': 0.43062743358470107, 'f1-score': 0.4162556828939767, 'support': 60867}}
[[10350  2787  6735]
 [ 7485  4940  8861]
 [ 6227  2561 10921]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
7167/7167 - 63s - 63s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76934314
{'0': {'precision': 0.611789926720519, 'recall': 0.3563281418760934, 'f1-score': 0.450354093944026, 'support': 421269}, '1': {'precision': 0.6920066412641469, 'recall': 0.8122279918372295, 'f1-score': 0.7473131547478792, 'support': 989860}, '2': {'precision': 0.5407597886668133, 'recall': 0.5457913952796368, 'f1-score': 0.5432639417787932, 'support': 423442}, 'accuracy': 0.6460436799665971, 'macro avg': {'precision': 0.6148521188838264, 'recall': 0.5714491763309866, 'f1-score': 0.5803103968235661, 'support': 1834571}, 'weighted avg': {'precision': 0.6386769609865236, 'recall': 0.6460436799665971, 'f1-score': 0.632025900439469, 'support': 1834571}}
[[150110 200803  70356]
 [ 59953 803992 125915]
 [ 35299 157032 231111]]
Evaluating performance on  train set...
1570/1570 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6954261
{'0': {'precision': 0.6387190743855906, 'recall': 0.3855106917771752, 'f1-score': 0.48081600506528505, 'support': 80763}, '1': {'precision': 0.7415669478879706, 'recall': 0.8612677992651163, 'f1-score': 0.7969477007528593, 'support': 240038}, '2': {'precision': 0.5567959659696099, 'recall': 0.5104823357808599, 'f1-score': 0.5326342806657767, 'support': 80898}, 'accuracy': 0.6949706123241531, 'macro avg': {'precision': 0.6456939960810569, 'recall': 0.5857536089410504, 'f1-score': 0.6034659954946403, 'support': 401699}, 'weighted avg': {'precision': 0.6836780666537523, 'recall': 0.6949706123241531, 'f1-score': 0.6801583355888424, 'support': 401699}}
[[ 31135  38159  11469]
 [ 11898 206737  21403]
 [  5713  33888  41297]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7428979
{'0': {'precision': 0.5986960431654677, 'recall': 0.37896684218016224, 'f1-score': 0.46413943355119824, 'support': 28108}, '1': {'precision': 0.7367525553937175, 'recall': 0.820045623448731, 'f1-score': 0.7761708830678562, 'support': 69701}, '2': {'precision': 0.5255291832636534, 'recall': 0.5713467664006299, 'f1-score': 0.5474810521622826, 'support': 27941}, 'accuracy': 0.6661948310139165, 'macro avg': {'precision': 0.6203259272742795, 'recall': 0.590119744009841, 'f1-score': 0.5959304562604457, 'support': 125750}, 'weighted avg': {'precision': 0.6589610270724628, 'recall': 0.6661948310139165, 'f1-score': 0.6556110218483981, 'support': 125750}}
[[10652 11479  5977]
 [ 4107 57158  8436]
 [ 3033  8944 15964]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
6357/6357 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8649808
{'0': {'precision': 0.5940183195290228, 'recall': 0.3546875432796058, 'f1-score': 0.4441648495627125, 'support': 397127}, '1': {'precision': 0.6701736755534836, 'recall': 0.7339414080843839, 'f1-score': 0.700609539529265, 'support': 830490}, '2': {'precision': 0.4643760157991231, 'recall': 0.558495514976774, 'f1-score': 0.5071055636671458, 'support': 399552}, 'accuracy': 0.5982998692821705, 'macro avg': {'precision': 0.5761893369605432, 'recall': 0.5490414887802545, 'f1-score': 0.5506266509197077, 'support': 1627169}, 'weighted avg': {'precision': 0.601053495275897, 'recall': 0.5982998692821705, 'f1-score': 0.5905066485843118, 'support': 1627169}}
[[140856 160484  95787]
 [ 59361 609531 161598]
 [ 36907 139497 223148]]
Evaluating performance on  train set...
1701/1701 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83454615
{'0': {'precision': 0.5927644212305092, 'recall': 0.372440952482071, 'f1-score': 0.45745651993503184, 'support': 103603}, '1': {'precision': 0.6886603964717141, 'recall': 0.7602560192368045, 'f1-score': 0.7226893227952083, 'support': 226233}, '2': {'precision': 0.48228415028614086, 'recall': 0.5507472864692845, 'f1-score': 0.5142470550780006, 'support': 105582}, 'accuracy': 0.6171770574482451, 'macro avg': {'precision': 0.5879029893294546, 'recall': 0.5611480860627199, 'f1-score': 0.564797632602747, 'support': 435418}, 'weighted avg': {'precision': 0.615800001293564, 'recall': 0.6171770574482451, 'f1-score': 0.6090360847920916, 'support': 435418}}
[[ 38586  40769  24248]
 [ 16065 171995  38173]
 [ 10444  36989  58149]]
Evaluating performance on  val set...
563/563 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84982395
{'0': {'precision': 0.5995232999319, 'recall': 0.35337462010436377, 'f1-score': 0.44465690165235594, 'support': 34878}, '1': {'precision': 0.6763557111897445, 'recall': 0.7428725121032813, 'f1-score': 0.7080553472662834, 'support': 74360}, '2': {'precision': 0.47111982404131203, 'recall': 0.5659228626403607, 'f1-score': 0.5141880520293807, 'support': 34821}, 'accuracy': 0.6058004012244983, 'macro avg': {'precision': 0.5823329450543189, 'recall': 0.5540566649493353, 'f1-score': 0.5556334336493399, 'support': 144059}, 'weighted avg': {'precision': 0.6081456051481459, 'recall': 0.6058004012244983, 'f1-score': 0.5974238416084159, 'support': 144059}}
[[12325 14338  8215]
 [ 5213 55240 13907]
 [ 3020 12095 19706]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
7459/7459 - 73s - 73s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0016899
{'0': {'precision': 0.5493007624588824, 'recall': 0.3806191618028748, 'f1-score': 0.4496610736688095, 'support': 607208}, '1': {'precision': 0.5205946851263609, 'recall': 0.5650292515482798, 'f1-score': 0.5419026153715264, 'support': 665093}, '2': {'precision': 0.4888136114973534, 'recall': 0.5883460240207238, 'f1-score': 0.5339812880629469, 'support': 636950}, 'accuracy': 0.5141592174103876, 'macro avg': {'precision': 0.5195696863608655, 'recall': 0.5113314791239595, 'f1-score': 0.5085149923677609, 'support': 1909251}, 'weighted avg': {'precision': 0.5191216493426579, 'recall': 0.5141592174103876, 'f1-score': 0.5099239538527303, 'support': 1909251}}
[[231115 182463 193630]
 [ 91027 375797 198269]
 [ 98602 163601 374747]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8306624
{'0': {'precision': 0.5952668185812371, 'recall': 0.3855198557001341, 'f1-score': 0.4679655301611091, 'support': 103673}, '1': {'precision': 0.6931578637955506, 'recall': 0.7564835225267751, 'f1-score': 0.7234375445108897, 'support': 218207}, '2': {'precision': 0.4947794958484562, 'recall': 0.5736671694705188, 'f1-score': 0.5313110370571407, 'support': 104083}, 'accuracy': 0.6215258132748619, 'macro avg': {'precision': 0.5944013927417479, 'recall': 0.5718901825658094, 'f1-score': 0.5742380372430466, 'support': 425963}, 'weighted avg': {'precision': 0.6208593918589248, 'recall': 0.6215258132748619, 'f1-score': 0.6143138567281635, 'support': 425963}}
[[ 39968  39392  24313]
 [ 16481 165070  36656]
 [ 10694  33680  59709]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89485836
{'0': {'precision': 0.5729808627959779, 'recall': 0.3793723658425277, 'f1-score': 0.45649681014293786, 'support': 37251}, '1': {'precision': 0.6378495901895764, 'recall': 0.7106460101423767, 'f1-score': 0.6722828998887194, 'support': 57383}, '2': {'precision': 0.5025470399265718, 'recall': 0.5833732885834532, 'f1-score': 0.5399521708044673, 'support': 37542}, 'accuracy': 0.5811342452487592, 'macro avg': {'precision': 0.5711258309707087, 'recall': 0.5577972215227859, 'f1-score': 0.5562439602787083, 'support': 132176}, 'weighted avg': {'precision': 0.5811376810221585, 'recall': 0.5811342452487592, 'f1-score': 0.5738822230608452, 'support': 132176}}
[[14132 12592 10527]
 [ 5452 40779 11152]
 [ 5080 10561 21901]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
8238/8238 - 73s - 73s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0260137
{'0': {'precision': 0.5362833783220063, 'recall': 0.44923815765499947, 'f1-score': 0.4889166762237012, 'support': 735454}, '1': {'precision': 0.5257250827045788, 'recall': 0.3832384927840069, 'f1-score': 0.44331388792153026, 'support': 641076}, '2': {'precision': 0.46460035872182676, 'recall': 0.6505987565967025, 'f1-score': 0.5420886934840634, 'support': 732184}, 'accuracy': 0.49908949245843676, 'macro avg': {'precision': 0.508869606582804, 'recall': 0.494358469011903, 'f1-score': 0.4914397525430983, 'support': 2108714}, 'weighted avg': {'precision': 0.5081838684101948, 'recall': 0.49908949245843676, 'f1-score': 0.49351514105684524, 'support': 2108714}}
[[330394 121635 283425]
 [129867 245685 265524]
 [155820 100006 476358]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9394475
{'0': {'precision': 0.5501269983564918, 'recall': 0.41908852230130667, 'f1-score': 0.4757495230014514, 'support': 131786}, '1': {'precision': 0.6380013578022847, 'recall': 0.5995147581828045, 'f1-score': 0.6181595937256404, 'support': 199076}, '2': {'precision': 0.4676504427564811, 'recall': 0.6222267918751571, 'f1-score': 0.533976902111751, 'support': 131301}, 'accuracy': 0.5545186438550901, 'macro avg': {'precision': 0.5519262663050859, 'recall': 0.5469433574530894, 'f1-score': 0.5426286729462809, 'support': 462163}, 'weighted avg': {'precision': 0.5645470660689518, 'recall': 0.5545186438550901, 'f1-score': 0.5536349018484169, 'support': 462163}}
[[ 55230  36907  39649]
 [ 26374 119349  53353]
 [ 18791  30811  81699]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9196509
{'0': {'precision': 0.5558489641466801, 'recall': 0.4197434421511389, 'f1-score': 0.4783021188376261, 'support': 48644}, '1': {'precision': 0.6429543598584521, 'recall': 0.6289256076093549, 'f1-score': 0.6358626156273602, 'support': 67601}, '2': {'precision': 0.4801587947220279, 'recall': 0.6138486178422115, 'f1-score': 0.5388351287201023, 'support': 48077}, 'accuracy': 0.5625905234843782, 'macro avg': {'precision': 0.55965403957572, 'recall': 0.5541725558675684, 'f1-score': 0.5509999543950296, 'support': 164322}, 'weighted avg': {'precision': 0.5695382789072264, 'recall': 0.5625905234843782, 'f1-score': 0.5608321066639831, 'support': 164322}}
[[20418 12926 15300]
 [ 8434 42516 16651]
 [ 7881 10684 29512]]
testing model on single stock: results/universal/W5/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
31315/31315 - 286s - 286s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0930915
{'0': {'precision': 0.5063470105575608, 'recall': 0.5241779403666623, 'f1-score': 0.5151082132787593, 'support': 3105310}, '1': {'precision': 0.3994231281200624, 'recall': 0.146466560301673, 'f1-score': 0.21433682636438905, 'support': 1731146}, '2': {'precision': 0.4867562430705876, 'recall': 0.6378314041062506, 'f1-score': 0.5521462355639337, 'support': 3180030}, 'accuracy': 0.4876966042228478, 'macro avg': {'precision': 0.464175460582737, 'recall': 0.436158634924862, 'f1-score': 0.42719709173569403, 'support': 8016486}, 'weighted avg': {'precision': 0.4754855982482591, 'recall': 0.48769660422284783, 'f1-score': 0.46484963846633637, 'support': 8016486}}
[[1627735  205019 1272556]
 [ 611450  253555  866141]
 [ 975478  176229 2028323]]
Evaluating performance on  train set...
5759/5759 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0674294
{'0': {'precision': 0.5135098166166641, 'recall': 0.45498763796196046, 'f1-score': 0.4824806042145939, 'support': 495064}, '1': {'precision': 0.5322113545707885, 'recall': 0.36145621580164855, 'f1-score': 0.4305204946614673, 'support': 485038}, '2': {'precision': 0.44873036778972114, 'recall': 0.6413119598437469, 'f1-score': 0.5280091319635387, 'support': 494070}, 'accuracy': 0.48666030829509715, 'macro avg': {'precision': 0.49815051299239127, 'recall': 0.4859186045357853, 'f1-score': 0.48033674361319995, 'support': 1474172}, 'weighted avg': {'precision': 0.49795218445723144, 'recall': 0.48666030829509715, 'f1-score': 0.4806434048155358, 'support': 1474172}}
[[225248  82358 187458]
 [107919 175320 201799]
 [105477  71740 316853]]
Evaluating performance on  val set...
2129/2129 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.056434
{'0': {'precision': 0.4983550880480378, 'recall': 0.48912469892422555, 'f1-score': 0.4936967533203779, 'support': 191397}, '1': {'precision': 0.5198864928284932, 'recall': 0.35473100863229884, 'f1-score': 0.42171545771114916, 'support': 161139}, '2': {'precision': 0.46593212726441396, 'recall': 0.5984802810752375, 'f1-score': 0.5239532878466953, 'support': 192404}, 'accuracy': 0.4879950086248027, 'macro avg': {'precision': 0.494724569380315, 'recall': 0.48077866287725396, 'f1-score': 0.4797884996260741, 'support': 544940}, 'weighted avg': {'precision': 0.49327423820824895, 'recall': 0.4879950086248027, 'f1-score': 0.48309463983233536, 'support': 544940}}
[[ 93617  28130  69650]
 [ 41639  57161  62339]
 [ 52596  24658 115150]]
training model: results/universal/W5/deepVOL_L3/h10
Epoch 1/50
9913/9913 - 569s - loss: 2.6916 - accuracy10: 0.5336 - val_loss: 3.2960 - val_accuracy10: 0.5561 - 569s/epoch - 57ms/step
Epoch 2/50
9913/9913 - 561s - loss: 2.5562 - accuracy10: 0.5825 - val_loss: 3.0933 - val_accuracy10: 0.5686 - 561s/epoch - 57ms/step
Epoch 3/50
9913/9913 - 563s - loss: 2.5176 - accuracy10: 0.5901 - val_loss: 2.9899 - val_accuracy10: 0.5792 - 563s/epoch - 57ms/step
Epoch 4/50
9913/9913 - 561s - loss: 2.4960 - accuracy10: 0.5942 - val_loss: 2.9886 - val_accuracy10: 0.5752 - 561s/epoch - 57ms/step
Epoch 5/50
9913/9913 - 538s - loss: 2.4842 - accuracy10: 0.5961 - val_loss: 2.9459 - val_accuracy10: 0.5719 - 538s/epoch - 54ms/step
Epoch 6/50
9913/9913 - 543s - loss: 2.4765 - accuracy10: 0.5974 - val_loss: 2.9031 - val_accuracy10: 0.5740 - 543s/epoch - 55ms/step
Epoch 7/50
9913/9913 - 544s - loss: 2.4654 - accuracy10: 0.5998 - val_loss: 2.9076 - val_accuracy10: 0.5678 - 544s/epoch - 55ms/step
Epoch 8/50
9913/9913 - 543s - loss: 2.4624 - accuracy10: 0.5998 - val_loss: 2.8683 - val_accuracy10: 0.5740 - 543s/epoch - 55ms/step
Epoch 9/50
9913/9913 - 532s - loss: 2.4525 - accuracy10: 0.6026 - val_loss: 2.8794 - val_accuracy10: 0.5704 - 532s/epoch - 54ms/step
Epoch 10/50
9913/9913 - 588s - loss: 2.4466 - accuracy10: 0.6034 - val_loss: 2.8509 - val_accuracy10: 0.5782 - 588s/epoch - 59ms/step
Epoch 11/50
9913/9913 - 577s - loss: 2.4426 - accuracy10: 0.6044 - val_loss: 2.8156 - val_accuracy10: 0.5754 - 577s/epoch - 58ms/step
Epoch 12/50
9913/9913 - 537s - loss: 2.4378 - accuracy10: 0.6051 - val_loss: 2.8186 - val_accuracy10: 0.5760 - 537s/epoch - 54ms/step
Epoch 13/50
9913/9913 - 537s - loss: 2.4345 - accuracy10: 0.6058 - val_loss: 2.8096 - val_accuracy10: 0.5765 - 537s/epoch - 54ms/step
Epoch 14/50
9913/9913 - 512s - loss: 2.4312 - accuracy10: 0.6063 - val_loss: 2.8118 - val_accuracy10: 0.5768 - 512s/epoch - 52ms/step
Epoch 15/50
9913/9913 - 498s - loss: 2.4282 - accuracy10: 0.6071 - val_loss: 2.7870 - val_accuracy10: 0.5767 - 498s/epoch - 50ms/step
Epoch 16/50
9913/9913 - 498s - loss: 2.4299 - accuracy10: 0.6061 - val_loss: 2.7924 - val_accuracy10: 0.5781 - 498s/epoch - 50ms/step
Epoch 17/50
9913/9913 - 529s - loss: 2.4226 - accuracy10: 0.6079 - val_loss: 2.8081 - val_accuracy10: 0.5796 - 529s/epoch - 53ms/step
Epoch 18/50
9913/9913 - 525s - loss: 2.4232 - accuracy10: 0.6073 - val_loss: 2.7819 - val_accuracy10: 0.5817 - 525s/epoch - 53ms/step
Epoch 19/50
9913/9913 - 529s - loss: 2.4173 - accuracy10: 0.6088 - val_loss: 2.8068 - val_accuracy10: 0.5799 - 529s/epoch - 53ms/step
Epoch 20/50
9913/9913 - 519s - loss: 2.4146 - accuracy10: 0.6094 - val_loss: 2.7875 - val_accuracy10: 0.5800 - 519s/epoch - 52ms/step
Epoch 21/50
9913/9913 - 534s - loss: 2.4132 - accuracy10: 0.6098 - val_loss: 2.8178 - val_accuracy10: 0.5786 - 534s/epoch - 54ms/step
Epoch 22/50
9913/9913 - 518s - loss: 2.4109 - accuracy10: 0.6100 - val_loss: 2.8157 - val_accuracy10: 0.5792 - 518s/epoch - 52ms/step
Epoch 23/50
9913/9913 - 515s - loss: 2.4092 - accuracy10: 0.6102 - val_loss: 2.8373 - val_accuracy10: 0.5819 - 515s/epoch - 52ms/step
Epoch 24/50
9913/9913 - 528s - loss: 2.4069 - accuracy10: 0.6107 - val_loss: 2.8005 - val_accuracy10: 0.5832 - 528s/epoch - 53ms/step
Epoch 25/50
9913/9913 - 523s - loss: 2.4048 - accuracy10: 0.6112 - val_loss: 2.8425 - val_accuracy10: 0.5788 - 523s/epoch - 53ms/step
Epoch 26/50
9913/9913 - 537s - loss: 2.4031 - accuracy10: 0.6115 - val_loss: 2.8347 - val_accuracy10: 0.5817 - 537s/epoch - 54ms/step
Epoch 27/50
9913/9913 - 574s - loss: 2.4010 - accuracy10: 0.6121 - val_loss: 2.8171 - val_accuracy10: 0.5805 - 574s/epoch - 58ms/step
Epoch 28/50
9913/9913 - 530s - loss: 2.3998 - accuracy10: 0.6121 - val_loss: 2.8780 - val_accuracy10: 0.5803 - 530s/epoch - 53ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1415s - 1415s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9453505
{'0': {'precision': 0.5241335608530358, 'recall': 0.49266043088591144, 'f1-score': 0.5079098972447887, 'support': 3782579}, '1': {'precision': 0.7807115470812253, 'recall': 0.46353903111418976, 'f1-score': 0.581699989464429, 'support': 5223051}, '2': {'precision': 0.4528983221440683, 'recall': 0.7304747152248732, 'f1-score': 0.559131841688003, 'support': 3832761}, 'accuracy': 0.5518098023342645, 'macro avg': {'precision': 0.5859144766927764, 'recall': 0.562224725741658, 'f1-score': 0.549580576132407, 'support': 12838391}, 'weighted avg': {'precision': 0.6072508504571388, 'recall': 0.5518098023342645, 'f1-score': 0.5532217191050205, 'support': 12838391}}
[[1863527  371498 1547554]
 [ 967434 2421088 1834529]
 [ 724482  308544 2799735]]
Evaluating performance on  train set...
9913/9913 - 285s - 285s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84073967
{'0': {'precision': 0.5124810957178124, 'recall': 0.47184902284853714, 'f1-score': 0.4913264354747015, 'support': 572378}, '1': {'precision': 0.8187392414532769, 'recall': 0.6177243658736232, 'f1-score': 0.7041670616128329, 'support': 1389037}, '2': {'precision': 0.42354412327240676, 'recall': 0.7078704974479603, 'f1-score': 0.5299814652229051, 'support': 575618}, 'accuracy': 0.6052664667743778, 'macro avg': {'precision': 0.5849214868144986, 'recall': 0.599147962056707, 'f1-score': 0.5751583207701465, 'support': 2537033}, 'weighted avg': {'precision': 0.659980231035671, 'recall': 0.6052664667743778, 'f1-score': 0.6166279336115539, 'support': 2537033}}
[[270076 101363 200939]
 [177365 858042 353630]
 [ 79556  88599 407463]]
Evaluating performance on  val set...
3496/3496 - 105s - 105s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88290745
{'0': {'precision': 0.5134971787425927, 'recall': 0.47055947384362423, 'f1-score': 0.49109156797886633, 'support': 231110}, '1': {'precision': 0.8004019575267031, 'recall': 0.572310708724987, 'f1-score': 0.6674064031590783, 'support': 433525}, '2': {'precision': 0.4371742860134622, 'recall': 0.7092218969963063, 'f1-score': 0.5409187173503203, 'support': 229584}, 'accuracy': 0.5811641219880141, 'macro avg': {'precision': 0.5836911407609193, 'recall': 0.5840306931883058, 'f1-score': 0.5664722294960883, 'support': 894219}, 'weighted avg': {'precision': 0.6329957347093713, 'recall': 0.5811641219880141, 'f1-score': 0.5893632499525185, 'support': 894219}}
[[108751  33865  88494]
 [ 64283 248111 121131]
 [ 38751  28007 162826]]
testing model out of sample: results/universal/W5/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 609s - 609s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93939006
{'0': {'precision': 0.46909566870108255, 'recall': 0.486270844598703, 'f1-score': 0.4775288726187343, 'support': 1307473}, '1': {'precision': 0.7857753690405918, 'recall': 0.5329272428312439, 'f1-score': 0.6351107476963199, 'support': 2727635}, '2': {'precision': 0.41012694722070864, 'recall': 0.6691869599371564, 'f1-score': 0.5085667907710748, 'support': 1313736}, 'accuracy': 0.5549894519264349, 'macro avg': {'precision': 0.5549993283207942, 'recall': 0.5627950157890345, 'f1-score': 0.5404021370287097, 'support': 5348844}, 'weighted avg': {'precision': 0.6161026298599453, 'recall': 0.5549894519264349, 'f1-score': 0.565510774552878, 'support': 5348844}}
[[ 635786  212544  459143]
 [ 468714 1453631  805290]
 [ 250844  183757  879135]]
Evaluating performance on  train set...
4957/4957 - 146s - 146s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8512255
{'0': {'precision': 0.47070650918331985, 'recall': 0.48711760948257504, 'f1-score': 0.4787714676482197, 'support': 267691}, '1': {'precision': 0.8174782822575758, 'recall': 0.62840435472424, 'f1-score': 0.7105789907477985, 'support': 729874}, '2': {'precision': 0.412789535580977, 'recall': 0.6559075851524675, 'f1-score': 0.5066950817146598, 'support': 270779}, 'accuracy': 0.6044566773682849, 'macro avg': {'precision': 0.5669914423406243, 'recall': 0.5904765164530942, 'f1-score': 0.565348513370226, 'support': 1268344}, 'weighted avg': {'precision': 0.6578931091165641, 'recall': 0.6044566773682849, 'f1-score': 0.6181275196404856, 'support': 1268344}}
[[130397  53615  83679]
 [102245 458656 168973]
 [ 44382  48791 177606]]
Evaluating performance on  val set...
1701/1701 - 51s - 51s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8565604
{'0': {'precision': 0.4719187872338206, 'recall': 0.48019024162384816, 'f1-score': 0.4760185852675447, 'support': 94196}, '1': {'precision': 0.8138533171961461, 'recall': 0.6256932847373746, 'f1-score': 0.7074763048961459, 'support': 246111}, '2': {'precision': 0.4174477048808778, 'recall': 0.6608241439349971, 'f1-score': 0.5116697102284101, 'support': 94765}, 'accuracy': 0.6018429133568697, 'macro avg': {'precision': 0.5677399364369481, 'recall': 0.5889025567654066, 'f1-score': 0.5650548667973668, 'support': 435072}, 'weighted avg': {'precision': 0.653479303618192, 'recall': 0.6018429133568697, 'f1-score': 0.6147146394664613, 'support': 435072}}
[[ 45232  18730  30234]
 [ 34964 153990  57157]
 [ 15651  16491  62623]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.169082
{'0': {'precision': 0.4152542372881356, 'recall': 0.5660737118374123, 'f1-score': 0.47907431489620217, 'support': 89158}, '1': {'precision': 0.6868574259878608, 'recall': 0.05710431191621268, 'f1-score': 0.10544230622955807, 'support': 97103}, '2': {'precision': 0.4034098527242832, 'recall': 0.6720746775767409, 'f1-score': 0.5041849307215368, 'support': 85059}, 'accuracy': 0.41714949137549756, 'macro avg': {'precision': 0.5018405053334266, 'recall': 0.43175090044345527, 'f1-score': 0.3629005172824324, 'support': 271320}, 'weighted avg': {'precision': 0.5087453655709482, 'recall': 0.41714949137549756, 'f1-score': 0.3532269572886907, 'support': 271320}}
[[50470  1367 37321]
 [44338  5545 47220]
 [26732  1161 57166]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2038821
{'0': {'precision': 0.37358719563073656, 'recall': 0.5387813149546001, 'f1-score': 0.44122917039956994, 'support': 18282}, '1': {'precision': 0.7875, 'recall': 0.14566473988439307, 'f1-score': 0.24585365853658536, 'support': 32870}, '2': {'precision': 0.3557209252343981, 'recall': 0.7150726359561485, 'f1-score': 0.4750986724076067, 'support': 18517}, 'accuracy': 0.40016363088317614, 'macro avg': {'precision': 0.5056027069550448, 'recall': 0.4665062302650472, 'f1-score': 0.38739383378125397, 'support': 69669}, 'weighted avg': {'precision': 0.564123648725925, 'recall': 0.40016363088317614, 'f1-score': 0.3580525566078766, 'support': 69669}}
[[ 9850   653  7779]
 [11879  4788 16203]
 [ 4637   639 13241]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1865436
{'0': {'precision': 0.3823038397328882, 'recall': 0.5404129793510325, 'f1-score': 0.44781227083842584, 'support': 6780}, '1': {'precision': 0.7682252388134742, 'recall': 0.13556915979061307, 'f1-score': 0.2304675716440422, 'support': 11271}, '2': {'precision': 0.35813737623762376, 'recall': 0.7178294573643411, 'f1-score': 0.47786149241407777, 'support': 6450}, 'accuracy': 0.40088159666952367, 'macro avg': {'precision': 0.5028888182613288, 'recall': 0.46460386550199556, 'f1-score': 0.3853804449655153, 'support': 24501}, 'weighted avg': {'precision': 0.5534742572461664, 'recall': 0.40088159666952367, 'f1-score': 0.35573951358537725, 'support': 24501}}
[[3664  236 2880]
 [4325 1528 5418]
 [1595  225 4630]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6884065
{'0': {'precision': 0.43810746784156573, 'recall': 0.4898444172143626, 'f1-score': 0.4625336738211971, 'support': 80793}, '1': {'precision': 0.8878359987400976, 'recall': 0.7524358273754511, 'f1-score': 0.8145474471359423, 'support': 397093}, '2': {'precision': 0.39082500868986986, 'recall': 0.6360181997048696, 'f1-score': 0.4841475629276695, 'support': 81320}, 'accuracy': 0.6975676226649928, 'macro avg': {'precision': 0.5722561584238444, 'recall': 0.6260994814315611, 'f1-score': 0.587076227961603, 'support': 559206}, 'weighted avg': {'precision': 0.7505845191283452, 'recall': 0.6975676226649928, 'f1-score': 0.7156422719925516, 'support': 559206}}
[[ 39576  19541  21676]
 [ 39365 298787  58941]
 [ 11393  18206  51721]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4178898
{'0': {'precision': 0.5000414765657404, 'recall': 0.49232277033649136, 'f1-score': 0.4961521050248981, 'support': 12244}, '1': {'precision': 0.9321567449525495, 'recall': 0.9111135797375145, 'f1-score': 0.9215150457250398, 'support': 126026}, '2': {'precision': 0.4626334519572954, 'recall': 0.5756380323645439, 'f1-score': 0.5129860812168174, 'support': 12421}, 'accuracy': 0.8494336091737397, 'macro avg': {'precision': 0.6316105578251952, 'recall': 0.65969146081285, 'f1-score': 0.6435510773222518, 'support': 150691}, 'weighted avg': {'precision': 0.8583449833448746, 'recall': 0.8494336091737397, 'f1-score': 0.8532795033629269, 'support': 150691}}
[[  6028   4233   1983]
 [  4880 114824   6322]
 [  1147   4124   7150]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47738224
{'0': {'precision': 0.48201563857515206, 'recall': 0.501808972503618, 'f1-score': 0.4917131968448108, 'support': 5528}, '1': {'precision': 0.9135919911213789, 'recall': 0.8884777197735633, 'f1-score': 0.900859854829704, 'support': 45399}, '2': {'precision': 0.4872441412043904, 'recall': 0.5742003146303094, 'f1-score': 0.5271603947685148, 'support': 5721}, 'accuracy': 0.8190050840276797, 'macro avg': {'precision': 0.6276172569669738, 'recall': 0.6548290023024969, 'f1-score': 0.6399111488143432, 'support': 56648}, 'weighted avg': {'precision': 0.8284188141998524, 'recall': 0.8190050840276797, 'f1-score': 0.8231925526063146, 'support': 56648}}
[[ 2774  1933   821]
 [ 2427 40336  2636]
 [  554  1882  3285]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
2341/2341 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1247207
{'0': {'precision': 0.4119090069383284, 'recall': 0.5560433569759147, 'f1-score': 0.4732449147815614, 'support': 172429}, '1': {'precision': 0.6987905900283654, 'recall': 0.1949012445780951, 'f1-score': 0.30479221230876236, 'support': 254062}, '2': {'precision': 0.39177492837984557, 'recall': 0.6703493217278578, 'f1-score': 0.49452982074889695, 'support': 172792}, 'accuracy': 0.43589756425595255, 'macro avg': {'precision': 0.5008248417821798, 'recall': 0.47376464109395583, 'f1-score': 0.4241889826130736, 'support': 599283}, 'weighted avg': {'precision': 0.5277252424409935, 'recall': 0.43589756425595255, 'f1-score': 0.4079676267160958, 'support': 599283}}
[[ 95878  10905  65646]
 [ 90365  49517 114180]
 [ 46522  10439 115831]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1056564
{'0': {'precision': 0.4282273844764437, 'recall': 0.5153829896440325, 'f1-score': 0.46778016798432515, 'support': 33121}, '1': {'precision': 0.731794420578645, 'recall': 0.250314242719306, 'f1-score': 0.3730311584834973, 'support': 56485}, '2': {'precision': 0.3776920804242019, 'recall': 0.716785693206634, 'f1-score': 0.4947095065940222, 'support': 33886}, 'accuracy': 0.4494056295144625, 'macro avg': {'precision': 0.5125712951597635, 'recall': 0.49416097518999086, 'f1-score': 0.44517361102061487, 'support': 123492}, 'weighted avg': {'precision': 0.5532115512331452, 'recall': 0.4494056295144625, 'f1-score': 0.4318315216466995, 'support': 123492}}
[[17070  2704 13347]
 [15673 14139 26673]
 [ 7119  2478 24289]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1321436
{'0': {'precision': 0.4166359684668091, 'recall': 0.48670281435579654, 'f1-score': 0.4489520482692919, 'support': 11619}, '1': {'precision': 0.7235640349096814, 'recall': 0.2082238187021786, 'f1-score': 0.3233853410740203, 'support': 17121}, '2': {'precision': 0.3939885203522762, 'recall': 0.7146149566875943, 'f1-score': 0.507936507936508, 'support': 12583}, 'accuracy': 0.44072308399680565, 'macro avg': {'precision': 0.5113961745762555, 'recall': 0.4698471965818565, 'f1-score': 0.42675796575994007, 'support': 41323}, 'weighted avg': {'precision': 0.5369065825544419, 'recall': 0.44072308399680565, 'f1-score': 0.41488806119435384, 'support': 41323}}
[[5655  653 5311]
 [5036 3565 8520]
 [2882  709 8992]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
2027/2027 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.274609
{'0': {'precision': 0.44061265064676863, 'recall': 0.09579486632157533, 'f1-score': 0.15737449097229222, 'support': 187390}, '1': {'precision': 0.3137890394814378, 'recall': 0.00721393203324505, 'f1-score': 0.014103625227611324, 'support': 147631}, '2': {'precision': 0.35353518332062467, 'recall': 0.9128774693238186, 'f1-score': 0.5096826895921336, 'support': 183856}, 'accuracy': 0.36011231948997546, 'macro avg': {'precision': 0.36931229114961034, 'recall': 0.3386287558928797, 'f1-score': 0.22705360193067903, 'support': 518877}, 'weighted avg': {'precision': 0.3736742213607057, 'recall': 0.36011231948997546, 'f1-score': 0.2414459664562635, 'support': 518877}}
[[ 17951   1270 168169]
 [  7831   1065 138735]
 [ 14959   1059 167838]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3166388
{'0': {'precision': 0.4133024869866975, 'recall': 0.12738876212207645, 'f1-score': 0.19475104243316166, 'support': 28048}, '1': {'precision': 0.42597087378640774, 'recall': 0.012388381039776939, 'f1-score': 0.024076551085502624, 'support': 28333}, '2': {'precision': 0.33165420647929744, 'recall': 0.8848081914174992, 'f1-score': 0.48246515324816314, 'support': 28127}, 'accuracy': 0.3409263028352345, 'macro avg': {'precision': 0.3903091890841342, 'recall': 0.3415284448597842, 'f1-score': 0.2337642489222758, 'support': 84508}, 'weighted avg': {'precision': 0.39037462474128354, 'recall': 0.3409263028352345, 'f1-score': 0.23328957643633677, 'support': 84508}}
[[ 3573   242 24233]
 [ 2063   351 25919]
 [ 3009   231 24887]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.308502
{'0': {'precision': 0.42151675485008816, 'recall': 0.13623778501628664, 'f1-score': 0.2059203643301126, 'support': 12280}, '1': {'precision': 0.31142857142857144, 'recall': 0.010300510300510301, 'f1-score': 0.019941456275155506, 'support': 10582}, '2': {'precision': 0.3398604620548937, 'recall': 0.8719918939457908, 'f1-score': 0.48909517156456467, 'support': 11843}, 'accuracy': 0.34891226048119867, 'macro avg': {'precision': 0.3576019294445178, 'recall': 0.33951006308752923, 'f1-score': 0.23831899738994425, 'support': 34705}, 'weighted avg': {'precision': 0.36008443580268923, 'recall': 0.34891226048119867, 'f1-score': 0.24584574790712052, 'support': 34705}}
[[ 1673   127 10480]
 [  894   109  9579]
 [ 1402   114 10327]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1770421
{'0': {'precision': 0.47574182526295977, 'recall': 0.5024330946747145, 'f1-score': 0.48872330022179705, 'support': 261601}, '1': {'precision': 0.5167851827352407, 'recall': 0.014431113943457741, 'f1-score': 0.028078151604048644, 'support': 216546}, '2': {'precision': 0.4236630850395515, 'recall': 0.7376642153430403, 'f1-score': 0.5382136407067232, 'support': 264211}, 'accuracy': 0.44380339404977115, 'macro avg': {'precision': 0.47206336434591734, 'recall': 0.41817614132040415, 'f1-score': 0.35167169751085625, 'support': 742358}, 'weighted avg': {'precision': 0.4691789524361371, 'recall': 0.44380339404977115, 'f1-score': 0.37196700204394195, 'support': 742358}}
[[131437   1497 128667]
 [ 76954   3125 136467]
 [ 67887   1425 194899]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0966939
{'0': {'precision': 0.4752327200762296, 'recall': 0.5385676075291147, 'f1-score': 0.5049218117251262, 'support': 60193}, '1': {'precision': 0.6386770628052437, 'recall': 0.12927730276279506, 'f1-score': 0.21502956872926582, 'support': 57659}, '2': {'precision': 0.4344324368578329, 'recall': 0.7104769874476987, 'f1-score': 0.5391767111630448, 'support': 59750}, 'accuracy': 0.46352518552719, 'macro avg': {'precision': 0.5161140732464354, 'recall': 0.4594406325798695, 'f1-score': 0.4197093638724789, 'support': 177602}, 'weighted avg': {'precision': 0.5145691038732196, 'recall': 0.46352518552719, 'f1-score': 0.4223317136548191, 'support': 177602}}
[[32418  2258 25517]
 [20457  7454 29748]
 [15340  1959 42451]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.097039
{'0': {'precision': 0.48016905071521454, 'recall': 0.5205941591137966, 'f1-score': 0.49956513335910324, 'support': 19860}, '1': {'precision': 0.6636080332409973, 'recall': 0.18220278556828445, 'f1-score': 0.2859060903293179, 'support': 21037}, '2': {'precision': 0.42903543013796597, 'recall': 0.7209814722083124, 'f1-score': 0.5379513908348745, 'support': 19970}, 'accuracy': 0.4693840668999622, 'macro avg': {'precision': 0.5242708380313926, 'recall': 0.4745928056301311, 'f1-score': 0.4411408715077652, 'support': 60867}, 'weighted avg': {'precision': 0.5267931240631245, 'recall': 0.4693840668999622, 'f1-score': 0.43831401655646074, 'support': 60867}}
[[10339  1026  8495]
 [ 6538  3833 10666]
 [ 4655   917 14398]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
7167/7167 - 105s - 105s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59088385
{'0': {'precision': 0.5298625912657022, 'recall': 0.47679180887372014, 'f1-score': 0.5019282552365554, 'support': 269560}, '1': {'precision': 0.8591862583332598, 'recall': 0.827675576432843, 'f1-score': 0.8431366066536942, 'support': 1294123}, '2': {'precision': 0.4701620679370723, 'recall': 0.5993990136144828, 'f1-score': 0.5269725771091317, 'support': 270888}, 'accuracy': 0.7424122587787554, 'macro avg': {'precision': 0.6197369725120115, 'recall': 0.634622132973682, 'f1-score': 0.6240124796664605, 'support': 1834571}, 'weighted avg': {'precision': 0.7533552642846384, 'recall': 0.7424122587787554, 'f1-score': 0.7463176964870822, 'support': 1834571}}
[[ 128524   95495   45541]
 [  85571 1071114  137438]
 [  28466   80052  162370]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5260411
{'0': {'precision': 0.5183473770046209, 'recall': 0.49241250546220156, 'f1-score': 0.5050472125737219, 'support': 50346}, '1': {'precision': 0.8886349734362435, 'recall': 0.8592119297056449, 'f1-score': 0.8736757995881486, 'support': 300963}, '2': {'precision': 0.4779718166491714, 'recall': 0.5963881722564001, 'f1-score': 0.5306540471818053, 'support': 50390}, 'accuracy': 0.7802707997779432, 'macro avg': {'precision': 0.6283180556966786, 'recall': 0.6493375358080821, 'f1-score': 0.6364590197812253, 'support': 401699}, 'weighted avg': {'precision': 0.7907113644642346, 'recall': 0.7802707997779432, 'f1-score': 0.7844452041781924, 'support': 401699}}
[[ 24791  16839   8716]
 [ 18266 258591  24106]
 [  4770  15568  30052]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6007778
{'0': {'precision': 0.49625147263575026, 'recall': 0.5005130974885228, 'f1-score': 0.4983731748635349, 'support': 18515}, '1': {'precision': 0.885497510275546, 'recall': 0.802597665702484, 'f1-score': 0.8420120439249026, 'support': 88849}, '2': {'precision': 0.44935016010548123, 'recall': 0.6487544871097575, 'f1-score': 0.5309474527609, 'support': 18386}, 'accuracy': 0.7356262425447316, 'macro avg': {'precision': 0.6103663810055925, 'recall': 0.6506217501002548, 'f1-score': 0.6237775571831126, 'support': 125750}, 'weighted avg': {'precision': 0.7644168298212507, 'recall': 0.7356262425447316, 'f1-score': 0.7459348492226157, 'support': 125750}}
[[ 9267  4995  4253]
 [ 7175 71310 10364]
 [ 2232  4226 11928]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
6357/6357 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69409645
{'0': {'precision': 0.533362017762521, 'recall': 0.4424854986711157, 'f1-score': 0.4836922868121708, 'support': 257735}, '1': {'precision': 0.8326407734881865, 'recall': 0.7736648834684967, 'f1-score': 0.8020701716413471, 'support': 1106439}, '2': {'precision': 0.41316659658739924, 'recall': 0.6052738645221392, 'f1-score': 0.491101742630034, 'support': 262995}, 'accuracy': 0.6939912203342123, 'macro avg': {'precision': 0.5930564626127023, 'recall': 0.6071414155539172, 'f1-score': 0.5922880670278506, 'support': 1627169}, 'weighted avg': {'precision': 0.7174380986209926, 'recall': 0.6939912203342123, 'f1-score': 0.7013797909038342, 'support': 1627169}}
[[114044  91735  51956]
 [ 76288 856013 174138]
 [ 23489  80322 159184]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67997295
{'0': {'precision': 0.5221547086372895, 'recall': 0.4442518775274408, 'f1-score': 0.4800633873833496, 'support': 67509}, '1': {'precision': 0.8473475371811611, 'recall': 0.780689492960586, 'f1-score': 0.8126538978118529, 'support': 297610}, '2': {'precision': 0.42232350192228013, 'recall': 0.6234797081039559, 'f1-score': 0.5035557955446284, 'support': 70299}, 'accuracy': 0.7031450238621278, 'macro avg': {'precision': 0.5972752492469103, 'recall': 0.6161403595306609, 'f1-score': 0.5987576935799436, 'support': 435418}, 'weighted avg': {'precision': 0.7283074255715531, 'recall': 0.7031450238621278, 'f1-score': 0.7111832643979806, 'support': 435418}}
[[ 29991  21866  15652]
 [ 20968 232341  44301]
 [  6478  19991  43830]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6822907
{'0': {'precision': 0.5096188936968875, 'recall': 0.43861617158754374, 'f1-score': 0.4714592326428244, 'support': 22286}, '1': {'precision': 0.8388204359258535, 'recall': 0.7787439223677043, 'f1-score': 0.8076665550719787, 'support': 99134}, '2': {'precision': 0.4211728169528681, 'recall': 0.6110252219621009, 'f1-score': 0.4986392228250095, 'support': 22639}, 'accuracy': 0.6997688447094593, 'macro avg': {'precision': 0.5898707155252031, 'recall': 0.6094617719724497, 'f1-score': 0.5925883368466042, 'support': 144059}, 'weighted avg': {'precision': 0.7222590963632843, 'recall': 0.6997688447094593, 'f1-score': 0.7070911924608592, 'support': 144059}}
[[ 9775  7967  4544]
 [ 7467 77200 14467]
 [ 1939  6867 13833]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
7459/7459 - 107s - 107s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89638186
{'0': {'precision': 0.48169767666056107, 'recall': 0.48037205725066995, 'f1-score': 0.4810339536814744, 'support': 416065}, '1': {'precision': 0.7523694974666817, 'recall': 0.586497288712679, 'f1-score': 0.6591584389564745, 'support': 1059091}, '2': {'precision': 0.4154626503213535, 'recall': 0.6400304080903949, 'f1-score': 0.5038568989390014, 'support': 434095}, 'accuracy': 0.5755419271745831, 'macro avg': {'precision': 0.5498432748161988, 'recall': 0.5689665846845813, 'f1-score': 0.5480164305256502, 'support': 1909251}, 'weighted avg': {'precision': 0.6167840511658811, 'recall': 0.5755419271745831, 'f1-score': 0.5850314718998497, 'support': 1909251}}
[[199866 105535 110664]
 [157701 621154 280236]
 [ 57353  98908 277834]]
Evaluating performance on  train set...
1664/1664 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68553096
{'0': {'precision': 0.5033162752585767, 'recall': 0.4880077949332934, 'f1-score': 0.49554383481364783, 'support': 66710}, '1': {'precision': 0.8508670653262091, 'recall': 0.7599235372909865, 'f1-score': 0.8028280137672951, 'support': 291907}, '2': {'precision': 0.41810589112602536, 'recall': 0.6244023401538324, 'f1-score': 0.5008426581547275, 'support': 67346}, 'accuracy': 0.6959125557853616, 'macro avg': {'precision': 0.5907630772369371, 'recall': 0.6241112241260375, 'f1-score': 0.5997381689118901, 'support': 425963}, 'weighted avg': {'precision': 0.7280163781935302, 'recall': 0.6959125557853616, 'f1-score': 0.7069595150078212, 'support': 425963}}
[[ 32555  20322  13833]
 [ 25389 221827  44691]
 [  6737  18558  42051]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7780691
{'0': {'precision': 0.497110794740809, 'recall': 0.47295036252091466, 'f1-score': 0.4847297076596439, 'support': 25102}, '1': {'precision': 0.8177784820155285, 'recall': 0.6950246076246909, 'f1-score': 0.7514212159917407, 'support': 81682}, '2': {'precision': 0.4240475394232501, 'recall': 0.6491808443604284, 'f1-score': 0.5130008558313235, 'support': 25392}, 'accuracy': 0.644042791429609, 'macro avg': {'precision': 0.5796456053931959, 'recall': 0.6057186048353446, 'f1-score': 0.5830505931609027, 'support': 132176}, 'weighted avg': {'precision': 0.6812407113137889, 'recall': 0.644042791429609, 'f1-score': 0.6549705742160356, 'support': 132176}}
[[11872  6783  6447]
 [ 8969 56771 15942]
 [ 3041  5867 16484]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
8238/8238 - 116s - 116s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96294
{'0': {'precision': 0.4778722463772368, 'recall': 0.4640148134080334, 'f1-score': 0.4708415917427789, 'support': 526550}, '1': {'precision': 0.7321759557870009, 'recall': 0.5118250378505627, 'f1-score': 0.6024850272637883, 'support': 1053485}, '2': {'precision': 0.4088906129863252, 'recall': 0.6659125858980591, 'f1-score': 0.5066702550304856, 'support': 528679}, 'accuracy': 0.5385182627895485, 'macro avg': {'precision': 0.5396462717168543, 'recall': 0.5472508123855517, 'f1-score': 0.5266656246790176, 'support': 2108714}, 'weighted avg': {'precision': 0.5876244471726371, 'recall': 0.5385182627895485, 'f1-score': 0.5455915324877695, 'support': 2108714}}
[[244327 107100 175123]
 [180464 539200 333821]
 [ 86490  90135 352054]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79756844
{'0': {'precision': 0.4850125042561435, 'recall': 0.46631521910911433, 'f1-score': 0.4754801245417451, 'support': 88586}, '1': {'precision': 0.8003094548063703, 'recall': 0.6999263803680982, 'f1-score': 0.7467595250607326, 'support': 285250}, '2': {'precision': 0.42215007724217973, 'recall': 0.6094738868069786, 'f1-score': 0.498804714428672, 'support': 88327}, 'accuracy': 0.6378615337013132, 'macro avg': {'precision': 0.5691573454348978, 'recall': 0.5919051620947303, 'f1-score': 0.5736814546770499, 'support': 462163}, 'weighted avg': {'precision': 0.667601775906167, 'recall': 0.6378615337013132, 'f1-score': 0.6473732446075743, 'support': 462163}}
[[ 41309  25984  21293]
 [ 33201 199654  52395]
 [ 10661  23833  53833]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80236596
{'0': {'precision': 0.4940871790071453, 'recall': 0.4705655106831892, 'f1-score': 0.48203957382039575, 'support': 33651}, '1': {'precision': 0.803371252027131, 'recall': 0.6957395333579366, 'f1-score': 0.7456915732281475, 'support': 97548}, '2': {'precision': 0.43335983596267313, 'recall': 0.625305678833439, 'f1-score': 0.511931979682885, 'support': 33123}, 'accuracy': 0.6354292182422318, 'macro avg': {'precision': 0.5769394223323164, 'recall': 0.5972035742915216, 'f1-score': 0.579887708910476, 'support': 164322}, 'weighted avg': {'precision': 0.665449327540461, 'recall': 0.6354292182422318, 'f1-score': 0.6445792909465907, 'support': 164322}}
[[15835  8821  8995]
 [11593 67868 18087]
 [ 4621  7790 20712]]
testing model on single stock: results/universal/W5/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
31315/31315 - 441s - 441s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.034709
{'0': {'precision': 0.5340824809339646, 'recall': 0.5223632453811213, 'f1-score': 0.5281578619565717, 'support': 2828771}, '1': {'precision': 0.6227724569594609, 'recall': 0.1844374875543683, 'f1-score': 0.2845916060879156, 'support': 2325113}, '2': {'precision': 0.4692322685018014, 'recall': 0.7476617427082074, 'f1-score': 0.576594201912688, 'support': 2862602}, 'accuracy': 0.504802478292858, 'macro avg': {'precision': 0.542029068798409, 'recall': 0.48482082521456565, 'f1-score': 0.46311455665239176, 'support': 8016486}, 'weighted avg': {'precision': 0.5366489256851729, 'recall': 0.504802478292858, 'f1-score': 0.47480966122990914, 'support': 8016486}}
[[1477646  149684 1201441]
 [ 676783  428838 1219492]
 [ 612271  110073 2140258]]
Evaluating performance on  train set...
5759/5759 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9872487
{'0': {'precision': 0.5161479622295442, 'recall': 0.4895477435366118, 'f1-score': 0.5024960707135535, 'support': 415030}, '1': {'precision': 0.7056337914591302, 'recall': 0.40901951985640567, 'f1-score': 0.5178614581720227, 'support': 641808}, '2': {'precision': 0.42838754114279587, 'recall': 0.727273598604475, 'f1-score': 0.5391804533851109, 'support': 417334}, 'accuracy': 0.52178782394456, 'macro avg': {'precision': 0.5500564316104901, 'recall': 0.5419469539991643, 'f1-score': 0.519845994090229, 'support': 1474172}, 'weighted avg': {'precision': 0.5737993852062152, 'recall': 0.52178782394456, 'f1-score': 0.5195709227333972, 'support': 1474172}}
[[203177  59616 152237]
 [126541 262512 252755]
 [ 63923  49895 303516]]
Evaluating performance on  val set...
2129/2129 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98836946
{'0': {'precision': 0.521929164471869, 'recall': 0.4905029908359608, 'f1-score': 0.5057283391006614, 'support': 169685}, '1': {'precision': 0.6889569596594154, 'recall': 0.3846135266867298, 'f1-score': 0.49364651759723976, 'support': 207013}, '2': {'precision': 0.44787444517720987, 'recall': 0.7185126187277849, 'f1-score': 0.5517952837853876, 'support': 168242}, 'accuracy': 0.5206720005872206, 'macro avg': {'precision': 0.5529201897694981, 'recall': 0.5312097120834919, 'f1-score': 0.5170567134944296, 'support': 544940}, 'weighted avg': {'precision': 0.5625167720646085, 'recall': 0.5206720005872206, 'f1-score': 0.5153611441668335, 'support': 544940}}
[[ 83231  20059  66395]
 [ 44766  79620  82627]
 [ 31471  15887 120884]]
training model: results/universal/W5/deepVOL_L3/h20
Epoch 1/50
9913/9913 - 533s - loss: 2.7837 - accuracy20: 0.5197 - val_loss: 3.0629 - val_accuracy20: 0.5396 - 533s/epoch - 54ms/step
Epoch 2/50
9913/9913 - 538s - loss: 2.6388 - accuracy20: 0.5744 - val_loss: 2.8936 - val_accuracy20: 0.5565 - 538s/epoch - 54ms/step
Epoch 3/50
9913/9913 - 530s - loss: 2.6025 - accuracy20: 0.5827 - val_loss: 2.8672 - val_accuracy20: 0.5582 - 530s/epoch - 53ms/step
Epoch 4/50
9913/9913 - 550s - loss: 2.5844 - accuracy20: 0.5861 - val_loss: 2.8735 - val_accuracy20: 0.5619 - 550s/epoch - 56ms/step
Epoch 5/50
9913/9913 - 530s - loss: 2.5714 - accuracy20: 0.5889 - val_loss: 2.8524 - val_accuracy20: 0.5617 - 530s/epoch - 53ms/step
Epoch 6/50
9913/9913 - 524s - loss: 2.5627 - accuracy20: 0.5902 - val_loss: 2.8249 - val_accuracy20: 0.5659 - 524s/epoch - 53ms/step
Epoch 7/50
9913/9913 - 520s - loss: 2.5553 - accuracy20: 0.5918 - val_loss: 2.8505 - val_accuracy20: 0.5614 - 520s/epoch - 52ms/step
Epoch 8/50
9913/9913 - 512s - loss: 2.5496 - accuracy20: 0.5929 - val_loss: 2.8382 - val_accuracy20: 0.5612 - 512s/epoch - 52ms/step
Epoch 9/50
9913/9913 - 530s - loss: 2.5447 - accuracy20: 0.5938 - val_loss: 2.8228 - val_accuracy20: 0.5638 - 530s/epoch - 53ms/step
Epoch 10/50
9913/9913 - 523s - loss: 2.5407 - accuracy20: 0.5945 - val_loss: 2.8104 - val_accuracy20: 0.5652 - 523s/epoch - 53ms/step
Epoch 11/50
9913/9913 - 522s - loss: 2.5367 - accuracy20: 0.5954 - val_loss: 2.8239 - val_accuracy20: 0.5627 - 522s/epoch - 53ms/step
Epoch 12/50
9913/9913 - 524s - loss: 2.5334 - accuracy20: 0.5961 - val_loss: 2.7966 - val_accuracy20: 0.5646 - 524s/epoch - 53ms/step
Epoch 13/50
9913/9913 - 513s - loss: 2.5303 - accuracy20: 0.5967 - val_loss: 2.8035 - val_accuracy20: 0.5632 - 513s/epoch - 52ms/step
Epoch 14/50
9913/9913 - 519s - loss: 2.5279 - accuracy20: 0.5971 - val_loss: 2.7853 - val_accuracy20: 0.5652 - 519s/epoch - 52ms/step
Epoch 15/50
9913/9913 - 514s - loss: 2.5261 - accuracy20: 0.5976 - val_loss: 2.7780 - val_accuracy20: 0.5672 - 514s/epoch - 52ms/step
Epoch 16/50
9913/9913 - 504s - loss: 2.5236 - accuracy20: 0.5979 - val_loss: 2.7713 - val_accuracy20: 0.5674 - 504s/epoch - 51ms/step
Epoch 17/50
9913/9913 - 510s - loss: 2.5217 - accuracy20: 0.5982 - val_loss: 2.7837 - val_accuracy20: 0.5655 - 510s/epoch - 51ms/step
Epoch 18/50
9913/9913 - 502s - loss: 2.5191 - accuracy20: 0.5989 - val_loss: 2.7858 - val_accuracy20: 0.5645 - 502s/epoch - 51ms/step
Epoch 19/50
9913/9913 - 537s - loss: 2.5174 - accuracy20: 0.5993 - val_loss: 2.7774 - val_accuracy20: 0.5658 - 537s/epoch - 54ms/step
Epoch 20/50
9913/9913 - 520s - loss: 2.5155 - accuracy20: 0.5996 - val_loss: 2.7839 - val_accuracy20: 0.5643 - 520s/epoch - 52ms/step
Epoch 21/50
9913/9913 - 521s - loss: 2.5134 - accuracy20: 0.6000 - val_loss: 2.7688 - val_accuracy20: 0.5662 - 521s/epoch - 53ms/step
Epoch 22/50
9913/9913 - 512s - loss: 2.5118 - accuracy20: 0.6004 - val_loss: 2.7906 - val_accuracy20: 0.5630 - 512s/epoch - 52ms/step
Epoch 23/50
9913/9913 - 519s - loss: 2.5106 - accuracy20: 0.6006 - val_loss: 2.7715 - val_accuracy20: 0.5681 - 519s/epoch - 52ms/step
Epoch 24/50
9913/9913 - 502s - loss: 2.5088 - accuracy20: 0.6007 - val_loss: 2.7737 - val_accuracy20: 0.5660 - 502s/epoch - 51ms/step
Epoch 25/50
9913/9913 - 501s - loss: 2.5072 - accuracy20: 0.6013 - val_loss: 2.7887 - val_accuracy20: 0.5634 - 501s/epoch - 51ms/step
Epoch 26/50
9913/9913 - 518s - loss: 2.5061 - accuracy20: 0.6014 - val_loss: 2.7700 - val_accuracy20: 0.5685 - 518s/epoch - 52ms/step
Epoch 27/50
9913/9913 - 511s - loss: 2.5052 - accuracy20: 0.6016 - val_loss: 2.7845 - val_accuracy20: 0.5655 - 511s/epoch - 52ms/step
Epoch 28/50
9913/9913 - 511s - loss: 2.5031 - accuracy20: 0.6021 - val_loss: 2.7674 - val_accuracy20: 0.5702 - 511s/epoch - 52ms/step
Epoch 29/50
9913/9913 - 527s - loss: 2.5018 - accuracy20: 0.6024 - val_loss: 2.7728 - val_accuracy20: 0.5661 - 527s/epoch - 53ms/step
Epoch 30/50
9913/9913 - 499s - loss: 2.5006 - accuracy20: 0.6028 - val_loss: 2.7767 - val_accuracy20: 0.5662 - 499s/epoch - 50ms/step
Epoch 31/50
9913/9913 - 517s - loss: 2.4997 - accuracy20: 0.6030 - val_loss: 2.7741 - val_accuracy20: 0.5657 - 517s/epoch - 52ms/step
Epoch 32/50
9913/9913 - 564s - loss: 2.4984 - accuracy20: 0.6030 - val_loss: 2.7795 - val_accuracy20: 0.5665 - 564s/epoch - 57ms/step
Epoch 33/50
9913/9913 - 549s - loss: 2.4971 - accuracy20: 0.6035 - val_loss: 2.7777 - val_accuracy20: 0.5665 - 549s/epoch - 55ms/step
Epoch 34/50
9913/9913 - 557s - loss: 2.4965 - accuracy20: 0.6032 - val_loss: 2.7752 - val_accuracy20: 0.5671 - 557s/epoch - 56ms/step
Epoch 35/50
9913/9913 - 507s - loss: 2.4951 - accuracy20: 0.6038 - val_loss: 2.7724 - val_accuracy20: 0.5683 - 507s/epoch - 51ms/step
Epoch 36/50
9913/9913 - 503s - loss: 2.4939 - accuracy20: 0.6040 - val_loss: 2.7701 - val_accuracy20: 0.5673 - 503s/epoch - 51ms/step
Epoch 37/50
9913/9913 - 499s - loss: 2.4927 - accuracy20: 0.6040 - val_loss: 2.7620 - val_accuracy20: 0.5681 - 499s/epoch - 50ms/step
Epoch 38/50
9913/9913 - 507s - loss: 2.4916 - accuracy20: 0.6044 - val_loss: 2.7650 - val_accuracy20: 0.5668 - 507s/epoch - 51ms/step
Epoch 39/50
9913/9913 - 503s - loss: 2.4906 - accuracy20: 0.6048 - val_loss: 2.7623 - val_accuracy20: 0.5698 - 503s/epoch - 51ms/step
Epoch 40/50
9913/9913 - 504s - loss: 2.4899 - accuracy20: 0.6049 - val_loss: 2.7679 - val_accuracy20: 0.5678 - 504s/epoch - 51ms/step
Epoch 41/50
9913/9913 - 521s - loss: 2.4888 - accuracy20: 0.6051 - val_loss: 2.7782 - val_accuracy20: 0.5665 - 521s/epoch - 53ms/step
Epoch 42/50
9913/9913 - 503s - loss: 2.4878 - accuracy20: 0.6055 - val_loss: 2.7709 - val_accuracy20: 0.5683 - 503s/epoch - 51ms/step
Epoch 43/50
9913/9913 - 506s - loss: 2.4868 - accuracy20: 0.6053 - val_loss: 2.7543 - val_accuracy20: 0.5698 - 506s/epoch - 51ms/step
Epoch 44/50
9913/9913 - 515s - loss: 2.4857 - accuracy20: 0.6056 - val_loss: 2.7586 - val_accuracy20: 0.5681 - 515s/epoch - 52ms/step
Epoch 45/50
9913/9913 - 501s - loss: 2.4849 - accuracy20: 0.6057 - val_loss: 2.7679 - val_accuracy20: 0.5661 - 501s/epoch - 50ms/step
Epoch 46/50
9913/9913 - 506s - loss: 2.4842 - accuracy20: 0.6060 - val_loss: 2.7643 - val_accuracy20: 0.5662 - 506s/epoch - 51ms/step
Epoch 47/50
9913/9913 - 505s - loss: 2.4833 - accuracy20: 0.6061 - val_loss: 2.7631 - val_accuracy20: 0.5670 - 505s/epoch - 51ms/step
Epoch 48/50
9913/9913 - 504s - loss: 2.4826 - accuracy20: 0.6063 - val_loss: 2.7567 - val_accuracy20: 0.5682 - 504s/epoch - 51ms/step
Epoch 49/50
9913/9913 - 498s - loss: 2.4813 - accuracy20: 0.6065 - val_loss: 2.7615 - val_accuracy20: 0.5671 - 498s/epoch - 50ms/step
Epoch 50/50
9913/9913 - 508s - loss: 2.4804 - accuracy20: 0.6068 - val_loss: 2.7715 - val_accuracy20: 0.5662 - 508s/epoch - 51ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1297s - 1297s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9427761
{'0': {'precision': 0.5359833867170918, 'recall': 0.46324682074819656, 'f1-score': 0.4969677618141248, 'support': 4317368}, '1': {'precision': 0.6886365202270128, 'recall': 0.47727369686627363, 'f1-score': 0.5637965822535982, 'support': 4125440}, '2': {'precision': 0.4864479685157637, 'recall': 0.6914168154713493, 'f1-score': 0.5710983295470635, 'support': 4395583}, 'accuracy': 0.545874557021982, 'macro avg': {'precision': 0.5703559584866228, 'recall': 0.5439791110286065, 'f1-score': 0.5439542245382621, 'support': 12838391}, 'weighted avg': {'precision': 0.5680765283703971, 'recall': 0.545874557021982, 'f1-score': 0.5438229598137087, 'support': 12838391}}
[[2000007  467417 1849944]
 [ 797902 1968964 1358574]
 [ 933563  422840 3039180]]
Evaluating performance on  train set...
9913/9913 - 275s - 275s/epoch - 28ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8600514
{'0': {'precision': 0.5355108235159518, 'recall': 0.4618949005994941, 'f1-score': 0.49598616213520746, 'support': 689081}, '1': {'precision': 0.739021514294565, 'recall': 0.6396131329982885, 'f1-score': 0.6857333333951479, 'support': 1156263}, '2': {'precision': 0.47378148923137026, 'recall': 0.6452003718434152, 'f1-score': 0.5463609441014472, 'support': 691689}, 'accuracy': 0.5928665492329032, 'macro avg': {'precision': 0.582771275680629, 'recall': 0.582236135147066, 'f1-score': 0.5760268132106009, 'support': 2537033}, 'weighted avg': {'precision': 0.6114319409589586, 'recall': 0.5928665492329032, 'f1-score': 0.5961982271915071, 'support': 2537033}}
[[318283 133515 237283]
 [158314 739561 258388]
 [117757 127654 446278]]
Evaluating performance on  val set...
3496/3496 - 92s - 92s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89474547
{'0': {'precision': 0.5247878345685649, 'recall': 0.45709592421500167, 'f1-score': 0.48860851014805956, 'support': 269077}, '1': {'precision': 0.7187043027429433, 'recall': 0.5918063753764627, 'f1-score': 0.6491115188532868, 'support': 356277}, '2': {'precision': 0.4790806567361295, 'recall': 0.6530154538523051, 'f1-score': 0.5526864186960135, 'support': 268865}, 'accuracy': 0.5696747664721953, 'macro avg': {'precision': 0.5741909313492125, 'recall': 0.5673059178145898, 'f1-score': 0.56346881589912, 'support': 894219}, 'weighted avg': {'precision': 0.5883057392024915, 'recall': 0.5696747664721953, 'f1-score': 0.5718228427827026, 'support': 894219}}
[[122994  43291 102792]
 [ 57316 210847  88114]
 [ 54059  39233 175573]]
testing model out of sample: results/universal/W5/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 561s - 561s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9656296
{'0': {'precision': 0.500558590132558, 'recall': 0.4551549036256732, 'f1-score': 0.4767782360273388, 'support': 1565199}, '1': {'precision': 0.6849360905933713, 'recall': 0.5331254548281059, 'f1-score': 0.5995704670233607, 'support': 2219245}, '2': {'precision': 0.44818130413678875, 'recall': 0.6297717974942469, 'f1-score': 0.5236813087368454, 'support': 1564400}, 'accuracy': 0.5385759988513406, 'macro avg': {'precision': 0.544558661620906, 'recall': 0.539350718649342, 'f1-score': 0.533343337262515, 'support': 5348844}, 'weighted avg': {'precision': 0.5617381309451852, 'recall': 0.5385759988513406, 'f1-score': 0.541442902191377, 'support': 5348844}}
[[ 712408  282361  570430]
 [ 393503 1183136  642606]
 [ 317315  261870  985215]]
Evaluating performance on  train set...
4957/4957 - 145s - 145s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8935356
{'0': {'precision': 0.5055863019581495, 'recall': 0.4507362317408662, 'f1-score': 0.4765882984749135, 'support': 323879}, '1': {'precision': 0.7243282014312528, 'recall': 0.6441877709885598, 'f1-score': 0.6819114704508743, 'support': 617646}, '2': {'precision': 0.4557266792627349, 'recall': 0.6000140750690749, 'f1-score': 0.5180105453354326, 'support': 326819}, 'accuracy': 0.5834063944797311, 'macro avg': {'precision': 0.561880394217379, 'recall': 0.564979359266167, 'f1-score': 0.5588367714204069, 'support': 1268344}, 'weighted avg': {'precision': 0.5992596170936897, 'recall': 0.5834063944797311, 'f1-score': 0.5872480352458308, 'support': 1268344}}
[[145984  77525 100370]
 [ 85939 397880 133827]
 [ 56819  73904 196096]]
Evaluating performance on  val set...
1701/1701 - 45s - 45s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89270973
{'0': {'precision': 0.5095229021031623, 'recall': 0.44507034850104255, 'f1-score': 0.475120760522415, 'support': 114146}, '1': {'precision': 0.7226545764164195, 'recall': 0.6440139772941467, 'f1-score': 0.6810717151633794, 'support': 206907}, '2': {'precision': 0.4596817995151483, 'recall': 0.6086704847437707, 'f1-score': 0.5237874207997947, 'support': 114019}, 'accuracy': 0.5825564504265961, 'macro avg': {'precision': 0.5639530926782433, 'recall': 0.5659182701796533, 'f1-score': 0.5599932988285298, 'support': 435072}, 'weighted avg': {'precision': 0.597820017663691, 'recall': 0.5825564504265961, 'f1-score': 0.5858188015594493, 'support': 435072}}
[[ 50803  26562  36781]
 [ 28863 133251  44793]
 [ 20041  24578  69400]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.071245
{'0': {'precision': 0.4549133047505897, 'recall': 0.5140827941820304, 'f1-score': 0.4826915259501505, 'support': 102785}, '1': {'precision': 0.5541253886759708, 'recall': 0.10680585947844509, 'f1-score': 0.17909226886042817, 'support': 71747}, '2': {'precision': 0.4398565131564983, 'recall': 0.6423110302930115, 'f1-score': 0.5221459317585301, 'support': 96788}, 'accuracy': 0.4521266401297361, 'macro avg': {'precision': 0.48296506886101964, 'recall': 0.421066561317829, 'f1-score': 0.394643242189703, 'support': 271320}, 'weighted avg': {'precision': 0.47577742328437045, 'recall': 0.4521266401297361, 'f1-score': 0.416483274184579, 'support': 271320}}
[[52840  3302 46643]
 [31558  7663 32526]
 [31756  2864 62168]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.093447
{'0': {'precision': 0.4260828625235405, 'recall': 0.4954153551389079, 'f1-score': 0.4581408593305068, 'support': 21921}, '1': {'precision': 0.6698952584750535, 'recall': 0.23273467151856633, 'f1-score': 0.34545243349982574, 'support': 25557}, '2': {'precision': 0.4186165089796612, 'recall': 0.6659456536433689, 'f1-score': 0.5140799749534726, 'support': 22191}, 'accuracy': 0.4533723750879157, 'macro avg': {'precision': 0.5048648766594184, 'recall': 0.46469856010028104, 'f1-score': 0.43922442259460165, 'support': 69669}, 'weighted avg': {'precision': 0.5131434999927247, 'recall': 0.4533723750879157, 'f1-score': 0.43462059660008895, 'support': 69669}}
[[10860  1567  9494]
 [ 8579  5948 11030]
 [ 6049  1364 14778]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0762804
{'0': {'precision': 0.4313894577988574, 'recall': 0.5006881020893281, 'f1-score': 0.4634626519976838, 'support': 7993}, '1': {'precision': 0.6505480335267569, 'recall': 0.22786811201445348, 'f1-score': 0.33751463455427333, 'support': 8856}, '2': {'precision': 0.4181653192542485, 'recall': 0.6624411918452692, 'f1-score': 0.5126934358248204, 'support': 7652}, 'accuracy': 0.45259377168278847, 'macro avg': {'precision': 0.5000342701932876, 'recall': 0.46366580198301693, 'f1-score': 0.4378902407922592, 'support': 24501}, 'weighted avg': {'precision': 0.5064752599499096, 'recall': 0.45259377168278847, 'f1-score': 0.43331360972865013, 'support': 24501}}
[[4002  591 3400]
 [3185 2018 3653]
 [2090  493 5069]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7270151
{'0': {'precision': 0.5131933341202477, 'recall': 0.4669589330000586, 'f1-score': 0.4889856806179675, 'support': 102418}, '1': {'precision': 0.8152158552956971, 'recall': 0.7825032780214315, 'f1-score': 0.7985246790398303, 'support': 353872}, '2': {'precision': 0.46305691648923963, 'recall': 0.5684636013836527, 'f1-score': 0.510374729018272, 'support': 102916}, 'accuracy': 0.6853199000010729, 'macro avg': {'precision': 0.5971553686350615, 'recall': 0.6059752708017143, 'f1-score': 0.5992950295586899, 'support': 559206}, 'weighted avg': {'precision': 0.6950895835461941, 'recall': 0.6853199000010729, 'f1-score': 0.688801955398115, 'support': 559206}}
[[ 47825  32349  22244]
 [ 31371 276906  45595]
 [ 13995  30417  58504]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.48507947
{'0': {'precision': 0.5748576371368846, 'recall': 0.4763184614465747, 'f1-score': 0.5209694277501961, 'support': 16743}, '1': {'precision': 0.887479206495022, 'recall': 0.9181235980068152, 'f1-score': 0.9025413564842676, 'support': 116798}, '2': {'precision': 0.5575154813285794, 'recall': 0.5197084548104957, 'f1-score': 0.5379485167637383, 'support': 17150}, 'accuracy': 0.8236921913053865, 'macro avg': {'precision': 0.6732841083201621, 'recall': 0.6380501714212952, 'f1-score': 0.6538197669994007, 'support': 150691}, 'weighted avg': {'precision': 0.8151915395317144, 'recall': 0.8236921913053865, 'f1-score': 0.8186516351073994, 'support': 150691}}
[[  7975   6704   2064]
 [  4553 107235   5010]
 [  1345   6892   8913]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55200034
{'0': {'precision': 0.5534831818906424, 'recall': 0.4633658080875484, 'f1-score': 0.5044312073223884, 'support': 7493}, '1': {'precision': 0.8545508762271768, 'recall': 0.9021673326068531, 'f1-score': 0.8777137741338894, 'support': 41295}, '2': {'precision': 0.5835668977725328, 'recall': 0.5033078880407125, 'f1-score': 0.5404740760980942, 'support': 7860}, 'accuracy': 0.788783363931648, 'macro avg': {'precision': 0.663866985296784, 'recall': 0.6229470095783713, 'f1-score': 0.6408730191847907, 'support': 56648}, 'weighted avg': {'precision': 0.7771282963599766, 'recall': 0.788783363931648, 'f1-score': 0.781546031235995, 'support': 56648}}
[[ 3472  3139   882]
 [ 2099 37255  1941]
 [  702  3202  3956]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0735439
{'0': {'precision': 0.45559525743056684, 'recall': 0.5433923520979428, 'f1-score': 0.49563573397413246, 'support': 206488}, '1': {'precision': 0.5642392296592951, 'recall': 0.2053983942028364, 'f1-score': 0.30116467315279066, 'support': 186574}, '2': {'precision': 0.4413806408614975, 'recall': 0.6101754913418129, 'f1-score': 0.5122306668349257, 'support': 206221}, 'accuracy': 0.461146069553116, 'macro avg': {'precision': 0.4870717093171198, 'recall': 0.4529887458808641, 'f1-score': 0.43634369132061623, 'support': 599283}, 'weighted avg': {'precision': 0.48452781188499433, 'recall': 0.461146069553116, 'f1-score': 0.4408018407180324, 'support': 599283}}
[[112204  14368  79916]
 [ 68914  38322  79338]
 [ 65162  15228 125831]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0670066
{'0': {'precision': 0.46526663410776997, 'recall': 0.5010017028949214, 'f1-score': 0.48247338148581354, 'support': 39932}, '1': {'precision': 0.6228709129744235, 'recall': 0.26624060678418426, 'f1-score': 0.37303201259511937, 'support': 42717}, '2': {'precision': 0.42947584921425586, 'recall': 0.6544083441470999, 'f1-score': 0.5186025980577627, 'support': 40843}, 'accuracy': 0.47053250412982217, 'macro avg': {'precision': 0.5058711320988164, 'recall': 0.4738835512754019, 'f1-score': 0.4580359973795652, 'support': 123492}, 'weighted avg': {'precision': 0.5079461514282526, 'recall': 0.47053250412982217, 'f1-score': 0.45656578129749636, 'support': 123492}}
[[20006  3493 16433]
 [12271 11373 19073]
 [10722  3393 26728]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0653974
{'0': {'precision': 0.46117969821673527, 'recall': 0.48045730618077886, 'f1-score': 0.47062117235345585, 'support': 13995}, '1': {'precision': 0.5973997355663287, 'recall': 0.21882314956816531, 'f1-score': 0.3203166538666037, 'support': 12389}, '2': {'precision': 0.45079936951137134, 'recall': 0.6700582368297744, 'f1-score': 0.5389834158948955, 'support': 14939}, 'accuracy': 0.47056118868426783, 'macro avg': {'precision': 0.5031262677648117, 'recall': 0.45644623085957287, 'f1-score': 0.443307080704985, 'support': 41323}, 'weighted avg': {'precision': 0.49826699372274114, 'recall': 0.47056118868426783, 'f1-score': 0.450272719354689, 'support': 41323}}
[[ 6724   888  6383]
 [ 3866  2711  5812]
 [ 3990   939 10010]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.192333
{'0': {'precision': 0.36749132592361383, 'recall': 0.4295443249473896, 'f1-score': 0.3961022655520531, 'support': 189126}, '1': {'precision': 0.3351597646787403, 'recall': 0.03904192421392099, 'f1-score': 0.06993705544656934, 'support': 148840}, '2': {'precision': 0.36396794044452685, 'recall': 0.5642829899784977, 'f1-score': 0.4425116333506, 'support': 180911}, 'accuracy': 0.36450642445126685, 'macro avg': {'precision': 0.355539677015627, 'recall': 0.3442897463799361, 'f1-score': 0.3028503181164075, 'support': 518877}, 'weighted avg': {'precision': 0.3569885501866008, 'recall': 0.36450642445126685, 'f1-score': 0.3187227233208552, 'support': 518877}}
[[ 81238   6118 101770]
 [ 66406   5811  76623]
 [ 73417   5409 102085]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.243071
{'0': {'precision': 0.34143781703690745, 'recall': 0.41259775945888816, 'f1-score': 0.37366003062787134, 'support': 28386}, '1': {'precision': 0.4157427937915743, 'recall': 0.04049676025917927, 'f1-score': 0.07380436921865775, 'support': 27780}, '2': {'precision': 0.3539157894736842, 'recall': 0.5931479782654717, 'f1-score': 0.4433163682392342, 'support': 28342}, 'accuracy': 0.3508306905855067, 'macro avg': {'precision': 0.37036546676738863, 'recall': 0.3487474993278464, 'f1-score': 0.29692692269525445, 'support': 84508}, 'weighted avg': {'precision': 0.37004863434470997, 'recall': 0.3508306905855067, 'f1-score': 0.2984506971521447, 'support': 84508}}
[[11712   782 15892]
 [11858  1125 14797]
 [10732   799 16811]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2344788
{'0': {'precision': 0.37112759026959596, 'recall': 0.430189588688946, 'f1-score': 0.39848197343453506, 'support': 12448}, '1': {'precision': 0.3415384615384615, 'recall': 0.03211186113789778, 'f1-score': 0.05870427501101807, 'support': 10370}, '2': {'precision': 0.35443759390705143, 'recall': 0.575502649953731, 'f1-score': 0.43869436962934466, 'support': 11887}, 'accuracy': 0.3610142630744849, 'macro avg': {'precision': 0.3557012152383696, 'recall': 0.34593469992685827, 'f1-score': 0.29862687269163257, 'support': 34705}, 'weighted avg': {'precision': 0.35656965188309747, 'recall': 0.3610142630744849, 'f1-score': 0.310728336232859, 'support': 34705}}
[[5355  355 6738]
 [4315  333 5722]
 [4759  287 6841]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
2900/2900 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2082243
{'0': {'precision': 0.44954698972352114, 'recall': 0.4998452810727179, 'f1-score': 0.47336374720070623, 'support': 261765}, '1': {'precision': 0.49666221628838453, 'recall': 0.013775992001036902, 'f1-score': 0.02680839564003243, 'support': 216028}, '2': {'precision': 0.4172750402525864, 'recall': 0.7023529189424149, 'f1-score': 0.5235209430352821, 'support': 264565}, 'accuracy': 0.43056853970725717, 'macro avg': {'precision': 0.4544947487548307, 'recall': 0.4053247306720566, 'f1-score': 0.3412310286253402, 'support': 742358}, 'weighted avg': {'precision': 0.45175640870004785, 'recall': 0.43056853970725717, 'f1-score': 0.3612902988496752, 'support': 742358}}
[[130842   1606 129317]
 [ 82874   2976 130178]
 [ 77337   1410 185818]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1620727
{'0': {'precision': 0.4386529477353884, 'recall': 0.5292835368449735, 'f1-score': 0.47972524504129044, 'support': 58719}, '1': {'precision': 0.6127150186097978, 'recall': 0.10074762645142082, 'f1-score': 0.17304223071350444, 'support': 60458}, '2': {'precision': 0.4109389525875426, 'recall': 0.6809242618741976, 'f1-score': 0.5125519373852546, 'support': 58425}, 'accuracy': 0.43328903953784303, 'macro avg': {'precision': 0.48743563964424297, 'recall': 0.43698514172353065, 'f1-score': 0.3884398043800165, 'support': 177602}, 'weighted avg': {'precision': 0.4887889513525332, 'recall': 0.43328903953784303, 'f1-score': 0.3861252733065511, 'support': 177602}}
[[31079  2070 25570]
 [22910  6091 31457]
 [16862  1780 39783]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1594121
{'0': {'precision': 0.4431981218207904, 'recall': 0.5193071828833419, 'f1-score': 0.4782435317022824, 'support': 19630}, '1': {'precision': 0.6313861184612253, 'recall': 0.14230010550942704, 'f1-score': 0.23225516621743034, 'support': 21799}, '2': {'precision': 0.4026340545625588, 'recall': 0.6825805123983949, 'f1-score': 0.5064992078792159, 'support': 19438}, 'accuracy': 0.43642696370775624, 'macro avg': {'precision': 0.4924060982815248, 'recall': 0.4480626002637213, 'f1-score': 0.4056659685996429, 'support': 60867}, 'weighted avg': {'precision': 0.49764184008190615, 'recall': 0.43642696370775624, 'f1-score': 0.39916839171383117, 'support': 60867}}
[[10194   924  8512]
 [ 7524  3102 11173]
 [ 5283   887 13268]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
7167/7167 - 100s - 100s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6735103
{'0': {'precision': 0.5835753431966645, 'recall': 0.4286070173965375, 'f1-score': 0.49422810950211493, 'support': 357255}, '1': {'precision': 0.7685189416441986, 'recall': 0.8427553979817468, 'f1-score': 0.803927016763916, 'support': 1117501}, '2': {'precision': 0.5445712456415093, 'recall': 0.5247780109222795, 'f1-score': 0.5344914457817683, 'support': 359815}, 'accuracy': 0.6997412474087947, 'macro avg': {'precision': 0.6322218434941241, 'recall': 0.5987134754335213, 'f1-score': 0.6108821906825997, 'support': 1834571}, 'weighted avg': {'precision': 0.6885810349071023, 'recall': 0.6997412474087947, 'f1-score': 0.6907733459129343, 'support': 1834571}}
[[153122 148827  55306]
 [ 73113 941780 102608]
 [ 36151 134841 188823]]
Evaluating performance on  train set...
1570/1570 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59752613
{'0': {'precision': 0.5975132800186795, 'recall': 0.4511967557560352, 'f1-score': 0.5141479422696983, 'support': 68059}, '1': {'precision': 0.810743229202743, 'recall': 0.8815273672120653, 'f1-score': 0.8446549220180589, 'support': 265555}, '2': {'precision': 0.5626482149238216, 'recall': 0.5087757949621796, 'f1-score': 0.5343576216149508, 'support': 68085}, 'accuracy': 0.7454387489139879, 'macro avg': {'precision': 0.656968241381748, 'recall': 0.61383330597676, 'f1-score': 0.6310534953009027, 'support': 401699}, 'weighted avg': {'precision': 0.7325658721301623, 'recall': 0.7454387489139879, 'f1-score': 0.7360647432209017, 'support': 401699}}
[[ 30708  27352   9999]
 [ 14534 234094  16927]
 [  6151  27294  34640]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6569931
{'0': {'precision': 0.5654235145385588, 'recall': 0.4437737721184058, 'f1-score': 0.49726674696562584, 'support': 24188}, '1': {'precision': 0.8091966966966967, 'recall': 0.8338834876344224, 'f1-score': 0.8213546363209165, 'support': 77554}, '2': {'precision': 0.517097519183491, 'recall': 0.5782239253582139, 'f1-score': 0.5459550871121248, 'support': 24008}, 'accuracy': 0.7100357852882704, 'macro avg': {'precision': 0.6305725768062488, 'recall': 0.6186270617036808, 'f1-score': 0.621525490132889, 'support': 125750}, 'weighted avg': {'precision': 0.7065398157123781, 'recall': 0.7100357852882704, 'f1-score': 0.7064374971946308, 'support': 125750}}
[[10734  8066  5388]
 [ 5307 64671  7576]
 [ 2943  7183 13882]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
6357/6357 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7700693
{'0': {'precision': 0.5790980462839155, 'recall': 0.4085122991901074, 'f1-score': 0.47907289636662487, 'support': 338193}, '1': {'precision': 0.7400722379786063, 'recall': 0.7882888594439126, 'f1-score': 0.7634199815293777, 'support': 946398}, '2': {'precision': 0.4780667523341769, 'recall': 0.5310440250103626, 'f1-score': 0.5031647626462588, 'support': 342578}, 'accuracy': 0.6551962334582333, 'macro avg': {'precision': 0.5990790121988995, 'recall': 0.5759483945481275, 'f1-score': 0.5818858801807537, 'support': 1627169}, 'weighted avg': {'precision': 0.651453501957394, 'recall': 0.6551962334582333, 'f1-score': 0.6495277514371206, 'support': 1627169}}
[[138156 134581  65456]
 [ 67202 746035 133161]
 [ 33213 127441 181924]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74127907
{'0': {'precision': 0.5800267148581756, 'recall': 0.4159482515748786, 'f1-score': 0.48447221274249863, 'support': 88737}, '1': {'precision': 0.7592107682689125, 'recall': 0.8076122591094385, 'f1-score': 0.7826639167127942, 'support': 255614}, '2': {'precision': 0.49639041582810167, 'recall': 0.5443903938858203, 'f1-score': 0.5192835445689745, 'support': 91067}, 'accuracy': 0.6727397581174871, 'macro avg': {'precision': 0.6118759663183966, 'recall': 0.5893169681900458, 'f1-score': 0.5954732246747558, 'support': 435418}, 'weighted avg': {'precision': 0.6677250777755571, 'recall': 0.6727397581174871, 'f1-score': 0.6668076645936045, 'support': 435418}}
[[ 36910  33107  18720]
 [ 17600 206437  31577]
 [  9125  32366  49576]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.749631
{'0': {'precision': 0.577708082026538, 'recall': 0.4036205501618123, 'f1-score': 0.47522276687372245, 'support': 29664}, '1': {'precision': 0.747448895888703, 'recall': 0.8076104939730561, 'f1-score': 0.7763659394152831, 'support': 84620}, '2': {'precision': 0.49700655110804626, 'recall': 0.532527287993283, 'f1-score': 0.5141541554525115, 'support': 29775}, 'accuracy': 0.6675667608410443, 'macro avg': {'precision': 0.6073878430077624, 'recall': 0.5812527773760504, 'f1-score': 0.588580953913839, 'support': 144059}, 'weighted avg': {'precision': 0.6607336450661142, 'recall': 0.6675667608410443, 'f1-score': 0.6601603088211211, 'support': 144059}}
[[11973 11983  5708]
 [ 5941 68340 10339]
 [ 2811 11108 15856]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
7459/7459 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9430781
{'0': {'precision': 0.529427257249819, 'recall': 0.4240292002697032, 'f1-score': 0.47090271343204293, 'support': 530954}, '1': {'precision': 0.6310013301101035, 'recall': 0.5821547833687801, 'f1-score': 0.6055946774768545, 'support': 821419}, '2': {'precision': 0.4678304026484266, 'recall': 0.6100492387919796, 'f1-score': 0.5295574200437242, 'support': 556878}, 'accuracy': 0.5463168540961875, 'macro avg': {'precision': 0.5427529966694496, 'recall': 0.538744407476821, 'f1-score': 0.535351603650874, 'support': 1909251}, 'weighted avg': {'precision': 0.55516140124561, 'recall': 0.5463168540961875, 'f1-score': 0.5459594001234338, 'support': 1909251}}
[[225140 142234 163580]
 [120362 478193 222864]
 [ 79750 137405 339723]]
Evaluating performance on  train set...
1664/1664 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7386797
{'0': {'precision': 0.5833666964368206, 'recall': 0.42894182649849416, 'f1-score': 0.49437571771583677, 'support': 88322}, '1': {'precision': 0.7652737212900338, 'recall': 0.7975368111233524, 'f1-score': 0.7810722421631499, 'support': 248702}, '2': {'precision': 0.4951391480252175, 'recall': 0.5669278943995323, 'f1-score': 0.5286072976783927, 'support': 88939}, 'accuracy': 0.672959858015837, 'macro avg': {'precision': 0.614593188584024, 'recall': 0.5978021773404597, 'f1-score': 0.6013517525191264, 'support': 425963}, 'weighted avg': {'precision': 0.6711531261663142, 'recall': 0.672959858015837, 'f1-score': 0.668913228047451, 'support': 425963}}
[[ 37885  31227  19210]
 [ 18151 198349  32202]
 [  8906  29611  50422]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8279565
{'0': {'precision': 0.5617814302909558, 'recall': 0.41756648361818965, 'f1-score': 0.4790556922151238, 'support': 32414}, '1': {'precision': 0.723268763698833, 'recall': 0.7280994692587512, 'f1-score': 0.7256760772659732, 'support': 67076}, '2': {'precision': 0.4865258019181932, 'recall': 0.6037141283730038, 'f1-score': 0.5388217625776504, 'support': 32686}, 'accuracy': 0.6211869023120687, 'macro avg': {'precision': 0.5905253319693273, 'recall': 0.5831266937499815, 'f1-score': 0.5811845106862491, 'support': 132176}, 'weighted avg': {'precision': 0.6251221192713656, 'recall': 0.6211869023120687, 'f1-score': 0.6189889836109923, 'support': 132176}}
[[13535  9805  9074]
 [ 6486 48838 11752]
 [ 4072  8881 19733]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
8238/8238 - 116s - 116s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9867068
{'0': {'precision': 0.524423910993777, 'recall': 0.4239566564222645, 'f1-score': 0.46886875478391055, 'support': 655968}, '1': {'precision': 0.614400248149168, 'recall': 0.4861953317353331, 'f1-score': 0.5428306962644788, 'support': 798498}, '2': {'precision': 0.45356013928683114, 'recall': 0.6561900074589452, 'f1-score': 0.5363759257963597, 'support': 654248}, 'accuracy': 0.5195768605889656, 'macro avg': {'precision': 0.5307947661432587, 'recall': 0.5221139985388475, 'f1-score': 0.5160251256149163, 'support': 2108714}, 'weighted avg': {'precision': 0.5365087382174686, 'recall': 0.5195768605889656, 'f1-score': 0.517820340427532, 'support': 2108714}}
[[278102 128680 249186]
 [142233 388226 268039]
 [109965 114972 429311]]
Evaluating performance on  train set...
1806/1806 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85752004
{'0': {'precision': 0.5485879578536494, 'recall': 0.41217596229379416, 'f1-score': 0.47069787840578914, 'support': 114570}, '1': {'precision': 0.6991311670877421, 'recall': 0.7187955422203172, 'f1-score': 0.7088269979415084, 'support': 233300}, '2': {'precision': 0.47954044927323447, 'recall': 0.571539814336836, 'f1-score': 0.5215138535724693, 'support': 114293}, 'accuracy': 0.6063683159404799, 'macro avg': {'precision': 0.5757531914048754, 'recall': 0.5675037729503157, 'f1-score': 0.5670129099732556, 'support': 462163}, 'weighted avg': {'precision': 0.6075067458486479, 'recall': 0.6063683159404799, 'f1-score': 0.6034723191061668, 'support': 462163}}
[[ 47223  37358  29989]
 [ 24697 167695  40908]
 [ 14161  34809  65323]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8484861
{'0': {'precision': 0.5566650024962556, 'recall': 0.4162000746547219, 'f1-score': 0.4762921828278514, 'support': 42864}, '1': {'precision': 0.7087840439140101, 'recall': 0.7202150347664777, 'f1-score': 0.7144538193835908, 'support': 79243}, '2': {'precision': 0.48615539195795415, 'recall': 0.5959966836432548, 'f1-score': 0.535501447301209, 'support': 42215}, 'accuracy': 0.6089994036099853, 'macro avg': {'precision': 0.58386814612274, 'recall': 0.5774705976881515, 'f1-score': 0.575415816504217, 'support': 164322}, 'weighted avg': {'precision': 0.6119090111511692, 'recall': 0.6089994036099853, 'f1-score': 0.6063548747700699, 'support': 164322}}
[[17840 12222 12802]
 [ 8380 57072 13791]
 [ 5828 11227 25160]]
testing model on single stock: results/universal/W5/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
31315/31315 - 431s - 431s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0032156
{'0': {'precision': 0.546822155597367, 'recall': 0.4757330010214765, 'f1-score': 0.5088064803615002, 'support': 3137615}, '1': {'precision': 0.5124368916528564, 'recall': 0.15811363290826508, 'f1-score': 0.241661904980187, 'support': 1683808}, '2': {'precision': 0.4928987078662645, 'recall': 0.7354352637178047, 'f1-score': 0.5902223655644969, 'support': 3195063}, 'accuracy': 0.5125265608896467, 'macro avg': {'precision': 0.5173859183721626, 'recall': 0.4564272992158487, 'f1-score': 0.4468969169687281, 'support': 8016486}, 'weighted avg': {'precision': 0.5181079539895855, 'recall': 0.5125265608896467, 'f1-score': 0.4851438318195685, 'support': 8016486}}
[[1492667  138171 1506777]
 [ 506883  266233  910692]
 [ 730162  115139 2349762]]
Evaluating performance on  train set...
5759/5759 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9828403
{'0': {'precision': 0.5353455252411561, 'recall': 0.4721466206972933, 'f1-score': 0.5017638731319128, 'support': 487571}, '1': {'precision': 0.6045861399633693, 'recall': 0.39949299195059385, 'f1-score': 0.48109340841578757, 'support': 497428}, '2': {'precision': 0.4694104887109804, 'recall': 0.6865689643541242, 'f1-score': 0.5575923901358655, 'support': 489173}, 'accuracy': 0.5187827471963923, 'macro avg': {'precision': 0.536447384638502, 'recall': 0.5194028590006704, 'f1-score': 0.513483223894522, 'support': 1474172}, 'weighted avg': {'precision': 0.5368301422841235, 'recall': 0.5187827471963923, 'f1-score': 0.5133145844638074, 'support': 1474172}}
[[230205  67177 190189]
 [109275 198719 189434]
 [ 90532  62790 335851]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97984964
{'0': {'precision': 0.5260954098783073, 'recall': 0.46659291345944093, 'f1-score': 0.4945608491241205, 'support': 192534}, '1': {'precision': 0.5910461884203678, 'recall': 0.37481716693127975, 'f1-score': 0.45872794871402556, 'support': 159982}, '2': {'precision': 0.48102505059986506, 'recall': 0.6817704652226334, 'f1-score': 0.5640693794716566, 'support': 192424}, 'accuracy': 0.5156310786508607, 'macro avg': {'precision': 0.5327222162995134, 'recall': 0.5077268485377847, 'f1-score': 0.5057860591032676, 'support': 544940}, 'weighted avg': {'precision': 0.5292486682900975, 'recall': 0.5156310786508607, 'f1-score': 0.508585311212032, 'support': 544940}}
[[ 89835  21866  80833]
 [ 39312  59964  60706]
 [ 41611  19624 131189]]
training model: results/universal/W5/deepVOL_L3/h30
Epoch 1/50
9913/9913 - 506s - loss: 2.8562 - accuracy30: 0.5143 - val_loss: 3.0963 - val_accuracy30: 0.5039 - 506s/epoch - 51ms/step
Epoch 2/50
9913/9913 - 510s - loss: 2.7593 - accuracy30: 0.5456 - val_loss: 3.2067 - val_accuracy30: 0.5039 - 510s/epoch - 51ms/step
Epoch 3/50
9913/9913 - 499s - loss: 2.7292 - accuracy30: 0.5525 - val_loss: 3.1872 - val_accuracy30: 0.5067 - 499s/epoch - 50ms/step
Epoch 4/50
9913/9913 - 502s - loss: 2.7109 - accuracy30: 0.5565 - val_loss: 3.0995 - val_accuracy30: 0.5146 - 502s/epoch - 51ms/step
Epoch 5/50
9913/9913 - 512s - loss: 2.6989 - accuracy30: 0.5593 - val_loss: 3.0071 - val_accuracy30: 0.5210 - 512s/epoch - 52ms/step
Epoch 6/50
9913/9913 - 507s - loss: 2.6896 - accuracy30: 0.5615 - val_loss: 3.0179 - val_accuracy30: 0.5159 - 507s/epoch - 51ms/step
Epoch 7/50
9913/9913 - 545s - loss: 2.6828 - accuracy30: 0.5628 - val_loss: 3.0223 - val_accuracy30: 0.5172 - 545s/epoch - 55ms/step
Epoch 8/50
9913/9913 - 525s - loss: 2.6763 - accuracy30: 0.5644 - val_loss: 2.9808 - val_accuracy30: 0.5163 - 525s/epoch - 53ms/step
Epoch 9/50
9913/9913 - 498s - loss: 2.6710 - accuracy30: 0.5656 - val_loss: 2.9583 - val_accuracy30: 0.5155 - 498s/epoch - 50ms/step
Epoch 10/50
9913/9913 - 505s - loss: 2.6668 - accuracy30: 0.5665 - val_loss: 2.9883 - val_accuracy30: 0.5109 - 505s/epoch - 51ms/step
Epoch 11/50
9913/9913 - 501s - loss: 2.6632 - accuracy30: 0.5673 - val_loss: 2.9438 - val_accuracy30: 0.5156 - 501s/epoch - 51ms/step
Epoch 12/50
9913/9913 - 499s - loss: 2.6593 - accuracy30: 0.5682 - val_loss: 2.9978 - val_accuracy30: 0.5077 - 499s/epoch - 50ms/step
Epoch 13/50
9913/9913 - 497s - loss: 2.6562 - accuracy30: 0.5686 - val_loss: 3.0214 - val_accuracy30: 0.5056 - 497s/epoch - 50ms/step
Epoch 14/50
9913/9913 - 512s - loss: 2.6535 - accuracy30: 0.5693 - val_loss: 3.0334 - val_accuracy30: 0.5032 - 512s/epoch - 52ms/step
Epoch 15/50
9913/9913 - 524s - loss: 2.6510 - accuracy30: 0.5700 - val_loss: 3.0237 - val_accuracy30: 0.5045 - 524s/epoch - 53ms/step
Epoch 16/50
9913/9913 - 508s - loss: 2.6490 - accuracy30: 0.5702 - val_loss: 3.0153 - val_accuracy30: 0.5056 - 508s/epoch - 51ms/step
Epoch 17/50
9913/9913 - 520s - loss: 2.6467 - accuracy30: 0.5710 - val_loss: 3.0457 - val_accuracy30: 0.5033 - 520s/epoch - 52ms/step
Epoch 18/50
9913/9913 - 512s - loss: 2.6448 - accuracy30: 0.5712 - val_loss: 3.0783 - val_accuracy30: 0.5013 - 512s/epoch - 52ms/step
Epoch 19/50
9913/9913 - 505s - loss: 2.6429 - accuracy30: 0.5717 - val_loss: 3.0383 - val_accuracy30: 0.5026 - 505s/epoch - 51ms/step
Epoch 20/50
9913/9913 - 530s - loss: 2.6408 - accuracy30: 0.5719 - val_loss: 3.0945 - val_accuracy30: 0.4993 - 530s/epoch - 53ms/step
Epoch 21/50
9913/9913 - 505s - loss: 2.6395 - accuracy30: 0.5725 - val_loss: 3.0621 - val_accuracy30: 0.5031 - 505s/epoch - 51ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1343s - 1343s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.014843
{'0': {'precision': 0.5446669994592122, 'recall': 0.29480032854534927, 'f1-score': 0.3825473726775292, 'support': 4441396}, '1': {'precision': 0.5861481401751003, 'recall': 0.41623364728372153, 'f1-score': 0.48678972680092636, 'support': 3859527}, '2': {'precision': 0.4498181387136823, 'recall': 0.7627161227362925, 'f1-score': 0.5658950144400684, 'support': 4537468}, 'accuracy': 0.49668139878276024, 'macro avg': {'precision': 0.5268777594493316, 'recall': 0.4912500328551211, 'f1-score': 0.478410704639508, 'support': 12838391}, 'weighted avg': {'precision': 0.5236148218237492, 'recall': 0.49668139878276024, 'f1-score': 0.4786856066396977, 'support': 12838391}}
[[1309325  610419 2521652]
 [ 541738 1606465 1711324]
 [ 552837  523831 3460800]]
Evaluating performance on  train set...
9913/9913 - 280s - 280s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9417861
{'0': {'precision': 0.5370998307877964, 'recall': 0.33440839980385073, 'f1-score': 0.4121835885054863, 'support': 728017}, '1': {'precision': 0.6714149923543908, 'recall': 0.5711190567599946, 'f1-score': 0.6172191376184304, 'support': 1080955}, '2': {'precision': 0.43396399816538034, 'recall': 0.6939706975102361, 'f1-score': 0.5339995296815839, 'support': 728061}, 'accuracy': 0.5384486524219433, 'macro avg': {'precision': 0.547492940435856, 'recall': 0.5331660513580272, 'f1-score': 0.5211340852685002, 'support': 2537033}, 'weighted avg': {'precision': 0.564730322009751, 'recall': 0.5384486524219433, 'f1-score': 0.5345011294834685, 'support': 2537033}}
[[243455 161258 323304]
 [127884 617354 335717]
 [ 81938 140870 505253]]
Evaluating performance on  val set...
3496/3496 - 93s - 93s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.971369
{'0': {'precision': 0.5156343253016278, 'recall': 0.3166945178157512, 'f1-score': 0.3923895353885269, 'support': 278265}, '1': {'precision': 0.642767225944589, 'recall': 0.5172341063901209, 'f1-score': 0.5732081894409018, 'support': 336629}, '2': {'precision': 0.4392986287320855, 'recall': 0.7115403204152868, 'f1-score': 0.543218818371773, 'support': 279325}, 'accuracy': 0.5155247204543854, 'macro avg': {'precision': 0.532566726659434, 'recall': 0.5151563148737196, 'f1-score': 0.5029388477337339, 'support': 894219}, 'weighted avg': {'precision': 0.5396487476816622, 'recall': 0.5155247204543854, 'f1-score': 0.5075729436635603, 'support': 894219}}
[[ 88125  52045 138095]
 [ 46931 174116 115582]
 [ 35850  44724 198751]]
testing model out of sample: results/universal/W5/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 579s - 579s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0087621
{'0': {'precision': 0.5273765436361448, 'recall': 0.31172610040613785, 'f1-score': 0.3918401033785297, 'support': 1714935}, '1': {'precision': 0.6056861809144884, 'recall': 0.46034931460924694, 'f1-score': 0.5231105707512888, 'support': 1923939}, '2': {'precision': 0.4262250059522069, 'recall': 0.7160915103773751, 'f1-score': 0.5343809774433137, 'support': 1709970}, 'accuracy': 0.4944561852991039, 'macro avg': {'precision': 0.5197625768342801, 'recall': 0.4960556417975866, 'f1-score': 0.4831105505243774, 'support': 5348844}, 'weighted avg': {'precision': 0.5232068333851553, 'recall': 0.4944561852991039, 'f1-score': 0.4846259446091278, 'support': 5348844}}
[[ 534590  307117  873228]
 [ 263094  885684  775161]
 [ 215994  269481 1224495]]
Evaluating performance on  train set...
4957/4957 - 145s - 145s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9552902
{'0': {'precision': 0.5376634840987757, 'recall': 0.3220486618411129, 'f1-score': 0.40281809764485565, 'support': 359337}, '1': {'precision': 0.6496166772622577, 'recall': 0.5980272933626262, 'f1-score': 0.6227553891544809, 'support': 548485}, '2': {'precision': 0.4337044996004977, 'recall': 0.6594576752597623, 'f1-score': 0.5232705039264711, 'support': 360522}, 'accuracy': 0.5373006061447052, 'macro avg': {'precision': 0.5403282203205103, 'recall': 0.5265112101545005, 'f1-score': 0.5162813302419359, 'support': 1268344}, 'weighted avg': {'precision': 0.5565267783966825, 'recall': 0.5373006061447052, 'f1-score': 0.5321663247434325, 'support': 1268344}}
[[115724  93482 150131]
 [ 60174 328009 160302]
 [ 39337  83436 237749]]
Evaluating performance on  val set...
1701/1701 - 46s - 46s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95098084
{'0': {'precision': 0.5368078001153387, 'recall': 0.3173317054220545, 'f1-score': 0.39887192569856894, 'support': 126133}, '1': {'precision': 0.6479441153063932, 'recall': 0.6001769177005067, 'f1-score': 0.6231464604516811, 'support': 183136}, '2': {'precision': 0.43745612288734975, 'recall': 0.6637282099790943, 'f1-score': 0.5273448971665134, 'support': 125803}, 'accuracy': 0.5365525706090026, 'macro avg': {'precision': 0.5407360127696939, 'recall': 0.5270789443672186, 'f1-score': 0.5164544277722545, 'support': 435072}, 'weighted avg': {'precision': 0.5548607227776021, 'recall': 0.5365525706090026, 'f1-score': 0.5304249248024593, 'support': 435072}}
[[ 40026  31798  54309]
 [ 20156 109914  53066]
 [ 14381  27923  83499]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0648931
{'0': {'precision': 0.4864855687606112, 'recall': 0.2700710663725989, 'f1-score': 0.34732542212632883, 'support': 106098}, '1': {'precision': 0.3747906754206427, 'recall': 0.21763289498055197, 'f1-score': 0.2753664228729897, 'support': 64788}, '2': {'precision': 0.41797721954931094, 'recall': 0.7274628113985304, 'f1-score': 0.5309101742886936, 'support': 100434}, 'accuracy': 0.4268612708241191, 'macro avg': {'precision': 0.4264178212435216, 'recall': 0.4050555909172271, 'f1-score': 0.3845340064293374, 'support': 271320}, 'weighted avg': {'precision': 0.4344545489522756, 'recall': 0.4268612708241191, 'f1-score': 0.3980996789266001, 'support': 271320}}
[[28654 13160 64284]
 [13235 14100 37453]
 [17011 10361 73062]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0663822
{'0': {'precision': 0.47780057447681573, 'recall': 0.24882468587058723, 'f1-score': 0.3272349155495602, 'support': 23398}, '1': {'precision': 0.5237983587338805, 'recall': 0.2943217250010979, 'f1-score': 0.3768767924422201, 'support': 22771}, '2': {'precision': 0.3993600214817964, 'recall': 0.7594468085106383, 'f1-score': 0.5234568625438121, 'support': 23500}, 'accuracy': 0.4359327678020353, 'macro avg': {'precision': 0.4669863182308309, 'recall': 0.43419773979410775, 'f1-score': 0.4091895235118641, 'support': 69669}, 'weighted avg': {'precision': 0.4663760176428532, 'recall': 0.4359327678020353, 'f1-score': 0.4096476232543884, 'support': 69669}}
[[ 5822  3257 14319]
 [ 3546  6702 12523]
 [ 2817  2836 17847]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0588181
{'0': {'precision': 0.49799575571799104, 'recall': 0.2511296076099881, 'f1-score': 0.333886649276737, 'support': 8410}, '1': {'precision': 0.5216725043782837, 'recall': 0.2989212242849975, 'f1-score': 0.38006379585326955, 'support': 7972}, '2': {'precision': 0.39956665816976805, 'recall': 0.7722625939155069, 'f1-score': 0.5266473478644325, 'support': 8119}, 'accuracy': 0.43936982163993304, 'macro avg': {'precision': 0.47307830608868096, 'recall': 0.4407711419368308, 'f1-score': 0.413532597664813, 'support': 24501}, 'weighted avg': {'precision': 0.4730826989989114, 'recall': 0.43936982163993304, 'f1-score': 0.412787442074648, 'support': 24501}}
[[2112 1202 5096]
 [1263 2383 4326]
 [ 866  983 6270]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8077627
{'0': {'precision': 0.5596148702861727, 'recall': 0.3547102002068182, 'f1-score': 0.43420247149275254, 'support': 117978}, '1': {'precision': 0.7505424843413908, 'recall': 0.7363800327251091, 'f1-score': 0.7433938121688694, 'support': 322688}, '2': {'precision': 0.42817901767891936, 'recall': 0.6062088746414712, 'f1-score': 0.5018734700576533, 'support': 118540}, 'accuracy': 0.6282640028898117, 'macro avg': {'precision': 0.5794454574354942, 'recall': 0.5657663691911329, 'f1-score': 0.5598232512397584, 'support': 559206}, 'weighted avg': {'precision': 0.6419273704313543, 'recall': 0.6282640028898117, 'f1-score': 0.6269651662957019, 'support': 559206}}
[[ 41848  42637  33493]
 [ 22593 237621  62474]
 [ 10339  36341  71860]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.55841017
{'0': {'precision': 0.6294428061462052, 'recall': 0.4008401284902397, 'f1-score': 0.48977989794994115, 'support': 20235}, '1': {'precision': 0.8418686868686869, 'recall': 0.9118210163557793, 'f1-score': 0.8754496993251227, 'support': 109686}, '2': {'precision': 0.5442252038937122, 'recall': 0.49797785267212324, 'f1-score': 0.5200754242614708, 'support': 20770}, 'accuracy': 0.7861650662614224, 'macro avg': {'precision': 0.6718455656362013, 'recall': 0.6035463325060474, 'f1-score': 0.6284350071788448, 'support': 150691}, 'weighted avg': {'precision': 0.7723191262591639, 'recall': 0.7861650662614224, 'f1-score': 0.7746795662455173, 'support': 150691}}
[[  8111   9614   2510]
 [  3520 100014   6152]
 [  1255   9172  10343]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6355166
{'0': {'precision': 0.5866495507060334, 'recall': 0.40473818222074615, 'f1-score': 0.4790042581067802, 'support': 9033}, '1': {'precision': 0.7992966002344666, 'recall': 0.8939997902024547, 'f1-score': 0.8439999009680375, 'support': 38132}, '2': {'precision': 0.5784187483904197, 'recall': 0.47368976062427504, 'f1-score': 0.520841787929735, 'support': 9483}, 'accuracy': 0.7456220872758085, 'macro avg': {'precision': 0.6547882997769733, 'recall': 0.5908092443491587, 'f1-score': 0.6146153156681842, 'support': 56648}, 'weighted avg': {'precision': 0.7284128008518329, 'recall': 0.7456220872758085, 'f1-score': 0.7317008960974691, 'support': 56648}}
[[ 3656  4285  1092]
 [ 1860 34090  2182]
 [  716  4275  4492]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
2341/2341 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0988322
{'0': {'precision': 0.48561724192870903, 'recall': 0.3132284178122825, 'f1-score': 0.38082229901834114, 'support': 214077}, '1': {'precision': 0.4171413548330558, 'recall': 0.16655489138358362, 'f1-score': 0.2380585227201687, 'support': 171475}, '2': {'precision': 0.4077864208690338, 'recall': 0.7493157286495642, 'f1-score': 0.52814832158769, 'support': 213731}, 'accuracy': 0.4267883454060936, 'macro avg': {'precision': 0.4368483392102662, 'recall': 0.4096996792818101, 'f1-score': 0.3823430477753999, 'support': 599283}, 'weighted avg': {'precision': 0.43826605399974633, 'recall': 0.4267883454060936, 'f1-score': 0.39251580540687603, 'support': 599283}}
[[ 67055  21639 125383]
 [ 35715  28560 107200]
 [ 35312  18267 160152]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1176319
{'0': {'precision': 0.48545417762492415, 'recall': 0.29346443596516975, 'f1-score': 0.3657982591198037, 'support': 40884}, '1': {'precision': 0.5164207221350079, 'recall': 0.1985753953881444, 'f1-score': 0.28685036623648413, 'support': 41415}, '2': {'precision': 0.3896586684690774, 'recall': 0.7837253902362051, 'f1-score': 0.5205207787496474, 'support': 41193}, 'accuracy': 0.4251773394227966, 'macro avg': {'precision': 0.4638445227430032, 'recall': 0.42525507386317307, 'f1-score': 0.3910564680353117, 'support': 123492}, 'weighted avg': {'precision': 0.46388496692486525, 'recall': 0.4251773394227966, 'f1-score': 0.3909323387958108, 'support': 123492}}
[[11998  4155 24731]
 [ 7354  8224 25837]
 [ 5363  3546 32284]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1002322
{'0': {'precision': 0.4813542064401171, 'recall': 0.2639402610091423, 'f1-score': 0.3409357252321284, 'support': 14329}, '1': {'precision': 0.4738214208125136, 'recall': 0.18301585969623227, 'f1-score': 0.26404358353510893, 'support': 11917}, '2': {'precision': 0.4156532584970377, 'recall': 0.7957153279830205, 'f1-score': 0.5460628129267182, 'support': 15077}, 'accuracy': 0.4346247852285652, 'macro avg': {'precision': 0.45694296191655615, 'recall': 0.41422381622946497, 'f1-score': 0.3836807072313185, 'support': 41323}, 'weighted avg': {'precision': 0.4552103785848801, 'recall': 0.4346247852285652, 'f1-score': 0.3936031852076372, 'support': 41323}}
[[ 3782  1265  9282]
 [ 2152  2181  7584]
 [ 1923  1157 11997]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1703331
{'0': {'precision': 0.38423773799113237, 'recall': 0.132072287758858, 'f1-score': 0.1965762993893537, 'support': 189631}, '1': {'precision': 0.29757771629870106, 'recall': 0.5430210959267613, 'f1-score': 0.3844663477458309, 'support': 150740}, '2': {'precision': 0.3561147655703289, 'recall': 0.3563521674341479, 'f1-score': 0.3562334269497747, 'support': 178506}, 'accuracy': 0.3286154522169994, 'macro avg': {'precision': 0.34597673995338746, 'recall': 0.34381518370658903, 'f1-score': 0.3124253580283198, 'support': 518877}, 'weighted avg': {'precision': 0.3493869911188196, 'recall': 0.3286154522169994, 'f1-score': 0.30608645517108213, 'support': 518877}}
[[ 25045 100662  63924]
 [ 17795  81855  51090]
 [ 22341  92554  63611]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1584684
{'0': {'precision': 0.36463669132991844, 'recall': 0.1359168375645287, 'f1-score': 0.19802184215948898, 'support': 28282}, '1': {'precision': 0.36085819206197495, 'recall': 0.512649181733724, 'f1-score': 0.4235651865847898, 'support': 27986}, '2': {'precision': 0.355793966323667, 'recall': 0.4309844192634561, 'f1-score': 0.3897963105303613, 'support': 28240}, 'accuracy': 0.3592795948312586, 'macro avg': {'precision': 0.36042961657185346, 'recall': 0.35985014618723626, 'f1-score': 0.33712777975821334, 'support': 84508}, 'weighted avg': {'precision': 0.36043041932384556, 'recall': 0.3592795948312586, 'f1-score': 0.3367988458026932, 'support': 84508}}
[[ 3844 12838 11600]
 [ 3202 14347 10437]
 [ 3496 12573 12171]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1819962
{'0': {'precision': 0.3801089918256131, 'recall': 0.13417762103238218, 'f1-score': 0.19834123222748815, 'support': 12476}, '1': {'precision': 0.304207506574229, 'recall': 0.4954253455324119, 'f1-score': 0.37695326964378284, 'support': 10274}, '2': {'precision': 0.35595843466725624, 'recall': 0.40401505646173147, 'f1-score': 0.3784673248707099, 'support': 11955}, 'accuracy': 0.3340729001584786, 'macro avg': {'precision': 0.34675831102236615, 'recall': 0.3445393410088418, 'f1-score': 0.3179206089139936, 'support': 34705}, 'weighted avg': {'precision': 0.34932000550373216, 'recall': 0.3340729001584786, 'f1-score': 0.3132660992485147, 'support': 34705}}
[[1674 6045 4757]
 [1202 5090 3982]
 [1528 5597 4830]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
2900/2900 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1852524
{'0': {'precision': 0.4727985750890569, 'recall': 0.23084228713970226, 'f1-score': 0.3102204840243268, 'support': 262179}, '1': {'precision': 0.284461211978307, 'recall': 0.02791171162833742, 'f1-score': 0.05083538756505066, 'support': 216110}, '2': {'precision': 0.3810872552242706, 'recall': 0.8559883969720036, 'f1-score': 0.5273828938864741, 'support': 264069}, 'accuracy': 0.39414137114438047, 'macro avg': {'precision': 0.3794490140972115, 'recall': 0.3715807985800144, 'f1-score': 0.2961462551586172, 'support': 742358}, 'weighted avg': {'precision': 0.3853479056448825, 'recall': 0.39414137114438047, 'f1-score': 0.3119583883967094, 'support': 742358}}
[[ 60522   8339 193318]
 [ 36291   6032 173787]
 [ 31195   6834 226040]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1816995
{'0': {'precision': 0.4544209057465432, 'recall': 0.30018771159454294, 'f1-score': 0.3615425762759762, 'support': 59666}, '1': {'precision': 0.4696132596685083, 'recall': 0.09654178674351585, 'f1-score': 0.16015861186495495, 'support': 58990}, '2': {'precision': 0.3769078216722196, 'recall': 0.8060428188511519, 'f1-score': 0.5136373955439283, 'support': 58946}, 'accuracy': 0.40044031035686534, 'macro avg': {'precision': 0.4336473290290903, 'recall': 0.40092410572973697, 'f1-score': 0.3451128612282865, 'support': 177602}, 'weighted avg': {'precision': 0.4337404556615872, 'recall': 0.40044031035686534, 'f1-score': 0.3451336459484042, 'support': 177602}}
[[17911  3581 38174]
 [12922  5695 40373]
 [ 8582  2851 47513]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1713629
{'0': {'precision': 0.4535404840155363, 'recall': 0.3055555555555556, 'f1-score': 0.36512327119663257, 'support': 19872}, '1': {'precision': 0.5250434782608696, 'recall': 0.14183031100253687, 'f1-score': 0.22333185382453025, 'support': 21286}, '2': {'precision': 0.37281027582736226, 'recall': 0.7893348216550814, 'f1-score': 0.5064292457436765, 'support': 19709}, 'accuracy': 0.4049484942579723, 'macro avg': {'precision': 0.4504647460345894, 'recall': 0.41224022940439126, 'f1-score': 0.3649614569216131, 'support': 60867}, 'weighted avg': {'precision': 0.4524052393398572, 'recall': 0.4049484942579723, 'f1-score': 0.3612924160890228, 'support': 60867}}
[[ 6072  1479 12321]
 [ 4416  3019 13851]
 [ 2900  1252 15557]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
7167/7167 - 124s - 124s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76981914
{'0': {'precision': 0.5955945523954668, 'recall': 0.3784968749184013, 'f1-score': 0.4628532198907665, 'support': 421269}, '1': {'precision': 0.6983146285034141, 'recall': 0.8013355423999353, 'f1-score': 0.7462864906160267, 'support': 989860}, '2': {'precision': 0.5319109440441799, 'recall': 0.541361036458358, 'f1-score': 0.5365943865160281, 'support': 423442}, 'accuracy': 0.644234537665754, 'macro avg': {'precision': 0.6086067083143537, 'recall': 0.5737311512588982, 'f1-score': 0.5819113656742737, 'support': 1834571}, 'weighted avg': {'precision': 0.6363191577929832, 'recall': 0.644234537665754, 'f1-score': 0.6328026873347847, 'support': 1834571}}
[[159449 187164  74656]
 [ 69576 793210 127074]
 [ 38689 155518 229235]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69372106
{'0': {'precision': 0.6240101920815366, 'recall': 0.39420279088196325, 'f1-score': 0.48317309516401963, 'support': 80763}, '1': {'precision': 0.7470998100375574, 'recall': 0.8585432306551463, 'f1-score': 0.798954024369914, 'support': 240038}, '2': {'precision': 0.5552883009287098, 'recall': 0.5136715369972064, 'f1-score': 0.5336698066562643, 'support': 80898}, 'accuracy': 0.69573237672984, 'macro avg': {'precision': 0.6421327676826013, 'recall': 0.5888058528447719, 'f1-score': 0.6052656420633994, 'support': 401699}, 'weighted avg': {'precision': 0.6837233657873361, 'recall': 0.69573237672984, 'f1-score': 0.6820396735000975, 'support': 401699}}
[[ 31837  36411  12515]
 [ 13190 206083  20765]
 [  5993  33350  41555]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7431047
{'0': {'precision': 0.5878033742503223, 'recall': 0.3730966272947204, 'f1-score': 0.4564625998389519, 'support': 28108}, '1': {'precision': 0.7539053534057922, 'recall': 0.8011075881264257, 'f1-score': 0.7767900616279231, 'support': 69701}, '2': {'precision': 0.5013887247370287, 'recall': 0.6073154146236713, 'f1-score': 0.5492918993283159, 'support': 27941}, 'accuracy': 0.6623777335984096, 'macro avg': {'precision': 0.614365817464381, 'recall': 0.5938398766816059, 'f1-score': 0.5941815202650637, 'support': 125750}, 'weighted avg': {'precision': 0.6606698738691252, 'recall': 0.6623777335984096, 'f1-score': 0.6546406345998695, 'support': 125750}}
[[10487  9920  7701]
 [ 4689 55838  9174]
 [ 2665  8307 16969]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86350334
{'0': {'precision': 0.5839081572912035, 'recall': 0.3340165740430643, 'f1-score': 0.42494770125805303, 'support': 397127}, '1': {'precision': 0.6718356676497688, 'recall': 0.7339980011800262, 'f1-score': 0.701542505504016, 'support': 830490}, '2': {'precision': 0.45787815680400107, 'recall': 0.5645848350152171, 'f1-score': 0.5056634140983483, 'support': 399552}, 'accuracy': 0.5947790303281343, 'macro avg': {'precision': 0.5712073272483245, 'recall': 0.5441998034127692, 'f1-score': 0.5440512069534724, 'support': 1627169}, 'weighted avg': {'precision': 0.5978387197115925, 'recall': 0.5947790303281343, 'f1-score': 0.5859385654368786, 'support': 1627169}}
[[132647 157423 107057]
 [ 60884 609578 160028]
 [ 33640 140331 225581]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8277965
{'0': {'precision': 0.6032726313011348, 'recall': 0.3309460150767835, 'f1-score': 0.42741744474501053, 'support': 103603}, '1': {'precision': 0.6895985995925945, 'recall': 0.7766240999323706, 'f1-score': 0.7305287142215643, 'support': 226233}, '2': {'precision': 0.48266558966074313, 'recall': 0.5659487412627152, 'f1-score': 0.5209999040901204, 'support': 105582}, 'accuracy': 0.6194943709263283, 'macro avg': {'precision': 0.5918456068514909, 'recall': 0.5578396187572898, 'f1-score': 0.5596486876855651, 'support': 435418}, 'weighted avg': {'precision': 0.6188802775491217, 'recall': 0.6194943709263283, 'f1-score': 0.6075992356908708, 'support': 435418}}
[[ 34287  41303  28013]
 [ 14502 175698  36033]
 [  8046  37782  59754]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84135306
{'0': {'precision': 0.5985727487421707, 'recall': 0.3342794885027811, 'f1-score': 0.4289866804032674, 'support': 34878}, '1': {'precision': 0.6767438012622025, 'recall': 0.7700645508337816, 'f1-score': 0.720394529923132, 'support': 74360}, '2': {'precision': 0.4786949233117322, 'recall': 0.5494385571924988, 'f1-score': 0.5116328822805798, 'support': 34821}, 'accuracy': 0.6112287326720303, 'macro avg': {'precision': 0.5846704911053685, 'recall': 0.5512608655096871, 'f1-score': 0.5536713642023264, 'support': 144059}, 'weighted avg': {'precision': 0.6099467948349262, 'recall': 0.6112287326720303, 'f1-score': 0.5993815261669269, 'support': 144059}}
[[11659 14500  8719]
 [ 4982 57262 12116]
 [ 2837 12852 19132]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
7459/7459 - 106s - 106s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.994363
{'0': {'precision': 0.5458449096508798, 'recall': 0.33391029103700876, 'f1-score': 0.4143498839224406, 'support': 607208}, '1': {'precision': 0.5337372657517966, 'recall': 0.537473706684629, 'f1-score': 0.5355989697657101, 'support': 665093}, '2': {'precision': 0.4697415137767927, 'recall': 0.6401774079598085, 'f1-score': 0.5418736428607499, 'support': 636950}, 'accuracy': 0.5069967227986263, 'macro avg': {'precision': 0.5164412297264896, 'recall': 0.5038538018938153, 'f1-score': 0.4972741655163002, 'support': 1909251}, 'weighted avg': {'precision': 0.5162381333779996, 'recall': 0.5069967227986263, 'f1-score': 0.49913086688723346, 'support': 1909251}}
[[202753 162474 241981]
 [ 89311 357470 218312]
 [ 79384 149805 407761]]
Evaluating performance on  train set...
1664/1664 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8229129
{'0': {'precision': 0.6038367739497819, 'recall': 0.3391336220616747, 'f1-score': 0.4343325159513029, 'support': 103673}, '1': {'precision': 0.6934362366175996, 'recall': 0.7774086074232266, 'f1-score': 0.7330253782100864, 'support': 218207}, '2': {'precision': 0.48786411710233457, 'recall': 0.5770298703918988, 'f1-score': 0.5287139782295798, 'support': 104083}, 'accuracy': 0.6217770088012339, 'macro avg': {'precision': 0.5950457092232386, 'recall': 0.5645240332922666, 'f1-score': 0.5653572907969897, 'support': 425963}, 'weighted avg': {'precision': 0.6213980360962679, 'recall': 0.6217770088012339, 'f1-score': 0.6104050366472606, 'support': 425963}}
[[ 35159  39984  28530]
 [ 14054 169636  34517]
 [  9013  35011  60059]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89148915
{'0': {'precision': 0.5760811009354033, 'recall': 0.315776757670935, 'f1-score': 0.40794173747182244, 'support': 37251}, '1': {'precision': 0.6455028945262861, 'recall': 0.7170242057752296, 'f1-score': 0.6793864139229221, 'support': 57383}, '2': {'precision': 0.4854423525491503, 'recall': 0.6208779500293005, 'f1-score': 0.544870146567241, 'support': 37542}, 'accuracy': 0.5766326715893959, 'macro avg': {'precision': 0.5690087826702799, 'recall': 0.5512263044918216, 'f1-score': 0.5440660993206619, 'support': 132176}, 'weighted avg': {'precision': 0.5804757784086882, 'recall': 0.5766326715893959, 'f1-score': 0.5646787865809925, 'support': 132176}}
[[11763 12181 13307]
 [ 4838 41145 11400]
 [ 3818 10415 23309]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
8238/8238 - 123s - 123s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0255649
{'0': {'precision': 0.5330985900223975, 'recall': 0.33431322693193594, 'f1-score': 0.4109280192401061, 'support': 735454}, '1': {'precision': 0.5320300491943434, 'recall': 0.35527924926217797, 'f1-score': 0.426050390301298, 'support': 641076}, '2': {'precision': 0.4428945967821959, 'recall': 0.737611037662664, 'f1-score': 0.5534644368916168, 'support': 732184}, 'accuracy': 0.48071952858472033, 'macro avg': {'precision': 0.5026744119996457, 'recall': 0.475734504618926, 'f1-score': 0.463480948811007, 'support': 2108714}, 'weighted avg': {'precision': 0.5014532666326588, 'recall': 0.48071952858472033, 'f1-score': 0.4650166597917307, 'support': 2108714}}
[[245872 106765 382817]
 [116796 227761 296519]
 [ 98545  93572 540067]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92830503
{'0': {'precision': 0.5598632537280513, 'recall': 0.3467060234015753, 'f1-score': 0.42822532650412143, 'support': 131786}, '1': {'precision': 0.6292202514700961, 'recall': 0.6611243947035303, 'f1-score': 0.6447779035189568, 'support': 199076}, '2': {'precision': 0.47046947754139873, 'recall': 0.6140851935628823, 'f1-score': 0.5327686060994505, 'support': 131301}, 'accuracy': 0.5581039589928228, 'macro avg': {'precision': 0.5531843275798487, 'recall': 0.5406385372226626, 'f1-score': 0.5352572787075096, 'support': 462163}, 'weighted avg': {'precision': 0.5643418066961852, 'recall': 0.5581039589928228, 'f1-score': 0.5512058722768286, 'support': 462163}}
[[ 45691  41125  44970]
 [ 21680 131614  45782]
 [ 14240  36431  80630]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9105782
{'0': {'precision': 0.5588582212786034, 'recall': 0.3409053531781926, 'f1-score': 0.42348404560951003, 'support': 48644}, '1': {'precision': 0.6451658855539253, 'recall': 0.669960503542847, 'f1-score': 0.6573294629898403, 'support': 67601}, '2': {'precision': 0.4741194724592708, 'recall': 0.6355845830646671, 'f1-score': 0.5431052103050823, 'support': 48077}, 'accuracy': 0.5624931536860555, 'macro avg': {'precision': 0.5593811930972664, 'recall': 0.5488168132619022, 'f1-score': 0.5413062396348108, 'support': 164322}, 'weighted avg': {'precision': 0.5695719393789732, 'recall': 0.5624931536860555, 'f1-score': 0.5546850460561741, 'support': 164322}}
[[16583 13280 18781]
 [ 7199 45290 15112]
 [ 5891 11629 30557]]
testing model on single stock: results/universal/W5/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
31315/31315 - 425s - 425s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0802077
{'0': {'precision': 0.5418215292915112, 'recall': 0.28336269164753275, 'f1-score': 0.37211571195074145, 'support': 3105310}, '1': {'precision': 0.3968889792598617, 'recall': 0.07892632972608896, 'f1-score': 0.13166869518542393, 'support': 1731146}, '2': {'precision': 0.44449560745781475, 'recall': 0.8454011440143646, 'f1-score': 0.5826467810316078, 'support': 3180030}, 'accuracy': 0.46216796237154284, 'macro avg': {'precision': 0.46106870533639593, 'recall': 0.4025633884626621, 'f1-score': 0.3621437293892577, 'support': 8016486}, 'weighted avg': {'precision': 0.4719157432069475, 'recall': 0.46216796237154284, 'f1-score': 0.40370638950247856, 'support': 8016486}}
[[ 879929  117470 2107911]
 [ 342619  136633 1251894]
 [ 401472   90157 2688401]]
Evaluating performance on  train set...
5759/5759 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0703381
{'0': {'precision': 0.5124795596110396, 'recall': 0.33171670733480924, 'f1-score': 0.4027452826949582, 'support': 495064}, '1': {'precision': 0.5295940707997691, 'recall': 0.26281858328625796, 'f1-score': 0.35129969893006496, 'support': 485038}, '2': {'precision': 0.41772752214899767, 'recall': 0.7719432469083328, 'f1-score': 0.5421028206420196, 'support': 494070}, 'accuracy': 0.4565898687534426, 'macro avg': {'precision': 0.48660038418660206, 'recall': 0.4554928458431333, 'f1-score': 0.43204926742234767, 'support': 1474172}, 'weighted avg': {'precision': 0.48635441894162507, 'recall': 0.4565898687534426, 'f1-score': 0.4325242472359673, 'support': 1474172}}
[[164221  62715 268128]
 [ 94062 127477 263499]
 [ 62161  50515 381394]]
Evaluating performance on  val set...
2129/2129 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642282
{'0': {'precision': 0.49817368126624767, 'recall': 0.3163894940882041, 'f1-score': 0.38699740855655645, 'support': 191397}, '1': {'precision': 0.5170199534959173, 'recall': 0.23734167395850786, 'f1-score': 0.32533569250269023, 'support': 161139}, '2': {'precision': 0.42737513308071845, 'recall': 0.7761273154404275, 'f1-score': 0.5512203404845926, 'support': 192404}, 'accuracy': 0.45533636730649246, 'macro avg': {'precision': 0.4808562559476279, 'recall': 0.4432861611623798, 'f1-score': 0.42118448051461305, 'support': 544940}, 'weighted avg': {'precision': 0.4787494246430014, 'recall': 0.45533636730649246, 'f1-score': 0.42674681533799647, 'support': 544940}}
[[ 60556  19646 111195]
 [ 34007  38245  88887]
 [ 26993  16081 149330]]
