This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W10/deepLOB_L1/h10
Epoch 1/50
8543/8543 - 154s - loss: 2.8795 - accuracy10: 0.5066 - val_loss: 3.5439 - val_accuracy10: 0.4613 - 154s/epoch - 18ms/step
Epoch 2/50
8543/8543 - 137s - loss: 2.8377 - accuracy10: 0.5173 - val_loss: 3.6157 - val_accuracy10: 0.4785 - 137s/epoch - 16ms/step
Epoch 3/50
8543/8543 - 138s - loss: 2.8144 - accuracy10: 0.5204 - val_loss: 3.8073 - val_accuracy10: 0.4768 - 138s/epoch - 16ms/step
Epoch 4/50
8543/8543 - 136s - loss: 2.7984 - accuracy10: 0.5240 - val_loss: 3.8512 - val_accuracy10: 0.4784 - 136s/epoch - 16ms/step
Epoch 5/50
8543/8543 - 138s - loss: 2.7877 - accuracy10: 0.5255 - val_loss: 3.9258 - val_accuracy10: 0.4708 - 138s/epoch - 16ms/step
Epoch 6/50
8543/8543 - 136s - loss: 2.7812 - accuracy10: 0.5267 - val_loss: 4.1776 - val_accuracy10: 0.4707 - 136s/epoch - 16ms/step
Epoch 7/50
8543/8543 - 137s - loss: 2.7737 - accuracy10: 0.5279 - val_loss: 4.3460 - val_accuracy10: 0.4743 - 137s/epoch - 16ms/step
Epoch 8/50
8543/8543 - 140s - loss: 2.7688 - accuracy10: 0.5287 - val_loss: 4.1551 - val_accuracy10: 0.4685 - 140s/epoch - 16ms/step
Epoch 9/50
8543/8543 - 136s - loss: 2.7648 - accuracy10: 0.5294 - val_loss: 4.1548 - val_accuracy10: 0.4662 - 136s/epoch - 16ms/step
Epoch 10/50
8543/8543 - 137s - loss: 2.7602 - accuracy10: 0.5305 - val_loss: 4.2363 - val_accuracy10: 0.4699 - 137s/epoch - 16ms/step
Epoch 11/50
8543/8543 - 139s - loss: 2.7569 - accuracy10: 0.5311 - val_loss: 4.1933 - val_accuracy10: 0.4683 - 139s/epoch - 16ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 203s - 203s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1918625
{'0': {'precision': 0.34283650911640107, 'recall': 0.040701363934600304, 'f1-score': 0.07276420144176488, 'support': 2787597}, '1': {'precision': 0.38850340552880486, 'recall': 0.8119127511247666, 'f1-score': 0.5255358603029252, 'support': 3943707}, '2': {'precision': 0.3223057561649695, 'recall': 0.11139828889737827, 'f1-score': 0.16557055507006743, 'support': 2813975}, 'accuracy': 0.3801750582670239, 'macro avg': {'precision': 0.3512152236033918, 'recall': 0.3213374679855817, 'f1-score': 0.2546235389382525, 'support': 9545279}, 'weighted avg': {'precision': 0.3556516225890787, 'recall': 0.3801750582670239, 'f1-score': 0.28718994210409365, 'support': 9545279}}
[[ 113459 2577494   96644]
 [ 179285 3201946  562476]
 [  38198 2462305  313472]]
Evaluating performance on  train set...
8543/8543 - 54s - 54s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.103886
{'0': {'precision': 0.32164205508277316, 'recall': 0.059623463459593434, 'f1-score': 0.10059872915659565, 'support': 579386}, '1': {'precision': 0.4494944979065117, 'recall': 0.8504263934671494, 'f1-score': 0.5881311505564242, 'support': 1022647}, '2': {'precision': 0.29576012566691345, 'recall': 0.07309894011667781, 'f1-score': 0.11722499849148924, 'support': 584687}, 'accuracy': 0.43305544376966415, 'macro avg': {'precision': 0.35563222621873275, 'recall': 0.32771626568114026, 'f1-score': 0.26865162606816967, 'support': 2186720}, 'weighted avg': {'precision': 0.3745135198482653, 'recall': 0.43305544376966415, 'f1-score': 0.3330449187400272, 'support': 2186720}}
[[ 34545 533676  11165]
 [ 62357 869686  90604]
 [ 10500 531447  42740]]
Evaluating performance on  val set...
3077/3077 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0694004
{'0': {'precision': 0.3237119630890915, 'recall': 0.060225635365891046, 'f1-score': 0.10155691305584036, 'support': 195714}, '1': {'precision': 0.48339814537840264, 'recall': 0.8535305186016572, 'f1-score': 0.6172282498418497, 'support': 393809}, '2': {'precision': 0.2731802779640133, 'recall': 0.07636510991794145, 'f1-score': 0.11936327971908935, 'support': 197420}, 'accuracy': 0.4612672074089229, 'macro avg': {'precision': 0.36009679547716916, 'recall': 0.33004042129516326, 'f1-score': 0.27938281420559313, 'support': 786943}, 'weighted avg': {'precision': 0.3909466808307556, 'recall': 0.4612672074089229, 'f1-score': 0.36408081424693056, 'support': 786943}}
[[ 11787 179877   4050]
 [ 21620 336128  36061]
 [  3005 179339  15076]]
testing model out of sample: results/universal/W10/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 111s - 111s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89460444
{'0': {'precision': 0.45703535986936794, 'recall': 0.15133458379435955, 'f1-score': 0.22737893837624157, 'support': 1076403}, '1': {'precision': 0.6313037423708489, 'recall': 0.8635292483482504, 'f1-score': 0.7293781305518137, 'support': 3311640}, '2': {'precision': 0.3768625478418725, 'recall': 0.201840865956471, 'f1-score': 0.2628851366322569, 'support': 1072756}, 'accuracy': 0.593158803317976, 'macro avg': {'precision': 0.4884005500273631, 'recall': 0.40556823269969366, 'f1-score': 0.4065474018534374, 'support': 5460799}, 'weighted avg': {'precision': 0.5469687709119344, 'recall': 0.593158803317976, 'f1-score': 0.5387857658373222, 'support': 5460799}}
[[ 162897  860900   52606]
 [ 146525 2859698  305417]
 [  46999  809231  216526]]
Evaluating performance on  train set...
4055/4055 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88192993
{'0': {'precision': 0.43029329982664943, 'recall': 0.19256301186565106, 'f1-score': 0.26605999568376376, 'support': 192067}, '1': {'precision': 0.653930164590063, 'recall': 0.8160820689231525, 'f1-score': 0.7260629122446262, 'support': 651160}, '2': {'precision': 0.3508876762033664, 'recall': 0.2509047479318209, 'f1-score': 0.2925905359367262, 'support': 194253}, 'accuracy': 0.5948297798511779, 'macro avg': {'precision': 0.4783703802066929, 'recall': 0.4198499429068749, 'f1-score': 0.4282378146217054, 'support': 1037480}, 'weighted avg': {'precision': 0.5557883457587645, 'recall': 0.5948297798511779, 'f1-score': 0.5597419328618586, 'support': 1037480}}
[[ 36985 144856  10226]
 [ 39823 531400  79937]
 [  9145 136369  48739]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8877055
{'0': {'precision': 0.4119708994708995, 'recall': 0.1739628279781604, 'f1-score': 0.24462706056768088, 'support': 71613}, '1': {'precision': 0.6567756194380222, 'recall': 0.8504886579394424, 'f1-score': 0.741184175233132, 'support': 250175}, '2': {'precision': 0.36261117389808856, 'recall': 0.20185456186659737, 'f1-score': 0.25934158620265507, 'support': 73117}, 'accuracy': 0.6077107152353097, 'macro avg': {'precision': 0.47711923093567005, 'recall': 0.4087686825947334, 'f1-score': 0.41505094066782267, 'support': 394905}, 'weighted avg': {'precision': 0.5579173568798149, 'recall': 0.6077107152353097, 'f1-score': 0.5619237727700629, 'support': 394905}}
[[ 12458  56111   3044]
 [ 14505 212771  22899]
 [  3277  55081  14759]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2912912
{'0': {'precision': 0.6130443050009508, 'recall': 0.06339468302658487, 'f1-score': 0.11490688764145057, 'support': 50856}, '1': {'precision': 0.26269571323053353, 'recall': 0.8241453297096266, 'f1-score': 0.39840130550830466, 'support': 34955}, '2': {'precision': 0.4864314789687924, 'recall': 0.1838500822667151, 'f1-score': 0.2668444802828477, 'support': 46799}, 'accuracy': 0.3064323957469271, 'macro avg': {'precision': 0.4540571657334256, 'recall': 0.35713003166764223, 'f1-score': 0.26005089114420094, 'support': 132610}, 'weighted avg': {'precision': 0.4760124923864126, 'recall': 0.3064323957469271, 'f1-score': 0.2432537300708347, 'support': 132610}}
[[ 3224 43740  3892]
 [  955 28808  5192]
 [ 1080 37115  8604]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2084373
{'0': {'precision': 0.5244094488188976, 'recall': 0.14971675209063934, 'f1-score': 0.23293228875209848, 'support': 11121}, '1': {'precision': 0.3398662846227316, 'recall': 0.7725575336517586, 'f1-score': 0.4720615547890688, 'support': 11515}, '2': {'precision': 0.4809973858837724, 'recall': 0.20467185761957732, 'f1-score': 0.28715486194477796, 'support': 11687}, 'accuracy': 0.37738542668181685, 'macro avg': {'precision': 0.4484243731084672, 'recall': 0.3756487144539918, 'f1-score': 0.33071623516198173, 'support': 34323}, 'weighted avg': {'precision': 0.44771535694925746, 'recall': 0.37738542668181685, 'f1-score': 0.33162041949004556, 'support': 34323}}
[[1665 8640  816]
 [ 854 8896 1765]
 [ 656 8639 2392]]
Evaluating performance on  val set...
46/46 - 0s - 478ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1971042
{'0': {'precision': 0.5131707317073171, 'recall': 0.13900634249471458, 'f1-score': 0.21875649823248078, 'support': 3784}, '1': {'precision': 0.35868880016810256, 'recall': 0.83492296404989, 'f1-score': 0.5018005438377305, 'support': 4089}, '2': {'precision': 0.47146619841966636, 'recall': 0.14098188500918876, 'f1-score': 0.21705739692805173, 'support': 3809}, 'accuracy': 0.3832391713747646, 'macro avg': {'precision': 0.44777524343169534, 'recall': 0.37163706385126444, 'f1-score': 0.31253814633275434, 'support': 11682}, 'weighted avg': {'precision': 0.4455000258901189, 'recall': 0.3832391713747646, 'f1-score': 0.31727517873336214, 'support': 11682}}
[[ 526 3012  246]
 [ 319 3414  356]
 [ 180 3092  537]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
1840/1840 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6963419
{'0': {'precision': 0.30485520256029974, 'recall': 0.19385501203683023, 'f1-score': 0.23700219980277631, 'support': 40293}, '1': {'precision': 0.8519949909318594, 'recall': 0.8088031461768059, 'f1-score': 0.8298374303239958, 'support': 390315}, '2': {'precision': 0.2031089190959274, 'recall': 0.3765207264798434, 'f1-score': 0.2638744182815865, 'support': 40359}, 'accuracy': 0.7191480507126826, 'macro avg': {'precision': 0.45331970419602885, 'recall': 0.4597262948978265, 'f1-score': 0.44357134946945287, 'support': 470967}, 'weighted avg': {'precision': 0.7495795425754318, 'recall': 0.7191480507126826, 'f1-score': 0.7306185654217604, 'support': 470967}}
[[  7811  30622   1860]
 [ 16866 315688  57761]
 [   945  24218  15196]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69400764
{'0': {'precision': 0.1995078553851978, 'recall': 0.41070268866086507, 'f1-score': 0.2685578393069475, 'support': 7699}, '1': {'precision': 0.9184512407722274, 'recall': 0.7122007393376002, 'f1-score': 0.802282351724689, 'support': 119837}, '2': {'precision': 0.15161871854578232, 'recall': 0.5132867132867133, 'f1-score': 0.2340900524774579, 'support': 7865}, 'accuracy': 0.6835030760481828, 'macro avg': {'precision': 0.4231926049010692, 'recall': 0.5453967137617263, 'f1-score': 0.4349767478363648, 'support': 135401}, 'weighted avg': {'precision': 0.8330288073233922, 'recall': 0.6835030760481828, 'f1-score': 0.7389299580593272, 'support': 135401}}
[[ 3162  4084   453]
 [12353 85348 22136]
 [  334  3494  4037]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75832385
{'0': {'precision': 0.21607773851590106, 'recall': 0.31840666493100755, 'f1-score': 0.25744658457004527, 'support': 3841}, '1': {'precision': 0.8764070175438596, 'recall': 0.6899737022386245, 'f1-score': 0.7720955536871259, 'support': 45251}, '2': {'precision': 0.15622615919301516, 'recall': 0.46190476190476193, 'f1-score': 0.23348324570849432, 'support': 3990}, 'accuracy': 0.6459440111525564, 'macro avg': {'precision': 0.41623697175092533, 'recall': 0.49009504302479795, 'f1-score': 0.4210084613218885, 'support': 53082}, 'weighted avg': {'precision': 0.7744921238780923, 'recall': 0.6459440111525564, 'f1-score': 0.6943699631062615, 'support': 53082}}
[[ 1223  2378   240]
 [ 4315 31222  9714]
 [  122  2025  1843]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2841101
{'0': {'precision': 0.4909271596304612, 'recall': 0.14892476720037515, 'f1-score': 0.22852541312933153, 'support': 89562}, '1': {'precision': 0.2773773528370243, 'recall': 0.7347215608179286, 'f1-score': 0.4027177953901887, 'support': 69297}, '2': {'precision': 0.4698356648105392, 'recall': 0.19504961659900766, 'f1-score': 0.27566038487589145, 'support': 88680}, 'accuracy': 0.3294389974913044, 'macro avg': {'precision': 0.41271339242600824, 'recall': 0.35956531487243715, 'f1-score': 0.3023011977984706, 'support': 247539}, 'weighted avg': {'precision': 0.42358926652272666, 'recall': 0.3294389974913044, 'f1-score': 0.2941754270989103, 'support': 247539}}
[[13338 67444  8780]
 [ 7645 50914 10738]
 [ 6186 65197 17297]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2063717
{'0': {'precision': 0.4769433465085639, 'recall': 0.25069252077562326, 'f1-score': 0.3286427598729006, 'support': 18772}, '1': {'precision': 0.33181445832480033, 'recall': 0.7017106972715461, 'f1-score': 0.45057007786429365, 'support': 18472}, '2': {'precision': 0.4858194709571857, 'recall': 0.18731927869197204, 'f1-score': 0.2703851261620186, 'support': 19021}, 'accuracy': 0.37733937616635566, 'macro avg': {'precision': 0.43152575859684994, 'recall': 0.3799074989130471, 'f1-score': 0.3498659879664043, 'support': 56265}, 'weighted avg': {'precision': 0.4322976865175705, 'recall': 0.37733937616635566, 'f1-score': 0.34897730118850223, 'support': 56265}}
[[ 4706 12745  1321]
 [ 3060 12962  2450]
 [ 2101 13357  3563]]
Evaluating performance on  val set...
79/79 - 1s - 603ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2333536
{'0': {'precision': 0.4899135446685879, 'recall': 0.217453098351336, 'f1-score': 0.3012107490894773, 'support': 7036}, '1': {'precision': 0.305545986910093, 'recall': 0.7249101013403073, 'f1-score': 0.42989385935152424, 'support': 6118}, '2': {'precision': 0.49055812001678556, 'recall': 0.17023445463812437, 'f1-score': 0.2527567567567568, 'support': 6867}, 'accuracy': 0.3563258578492583, 'macro avg': {'precision': 0.4286725505318221, 'recall': 0.37086588477658927, 'f1-score': 0.32795378839925277, 'support': 20021}, 'weighted avg': {'precision': 0.43379574738321763, 'recall': 0.3563258578492583, 'f1-score': 0.32391439542254813, 'support': 20021}}
[[1530 5069  437]
 [ 906 4435  777]
 [ 687 5011 1169]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3016044
{'0': {'precision': 0.39611600143211645, 'recall': 0.22893328576525152, 'f1-score': 0.2901663584280282, 'support': 140150}, '1': {'precision': 0.299955756468212, 'recall': 0.6168342603068111, 'f1-score': 0.4036322031880141, 'support': 126397}, '2': {'precision': 0.41742908723723265, 'recall': 0.19524971554111595, 'f1-score': 0.2660542854496078, 'support': 139739}, 'accuracy': 0.33802543036186333, 'macro avg': {'precision': 0.371166948379187, 'recall': 0.34700575387105953, 'f1-score': 0.3199509490218833, 'support': 406286}, 'weighted avg': {'precision': 0.37353068668983763, 'recall': 0.33802543036186333, 'f1-score': 0.31717281549077825, 'support': 406286}}
[[32085 90582 17483]
 [27836 77966 20595]
 [21078 91377 27284]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2660835
{'0': {'precision': 0.4254696743158032, 'recall': 0.2513827008757106, 'f1-score': 0.3160385330403921, 'support': 26036}, '1': {'precision': 0.32413142722421073, 'recall': 0.6078620523332932, 'f1-score': 0.4228080966226795, 'support': 24879}, '2': {'precision': 0.381635687732342, 'recall': 0.20887080366225838, 'f1-score': 0.26998027613412223, 'support': 24575}, 'accuracy': 0.3550271559146907, 'macro avg': {'precision': 0.37707892975745194, 'recall': 0.3560385189570874, 'f1-score': 0.33627563526573123, 'support': 75490}, 'weighted avg': {'precision': 0.37780224194488926, 'recall': 0.3550271559146907, 'f1-score': 0.3362324436098999, 'support': 75490}}
[[ 6545 15964  3527]
 [ 4966 15123  4790]
 [ 3872 15570  5133]]
Evaluating performance on  val set...
131/131 - 1s - 866ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.250832
{'0': {'precision': 0.3972009330223259, 'recall': 0.21082419525999294, 'f1-score': 0.2754477180820335, 'support': 11308}, '1': {'precision': 0.34210154816243943, 'recall': 0.6311311745811269, 'f1-score': 0.44369850472993594, 'support': 11519}, '2': {'precision': 0.39747582363546957, 'recall': 0.23036002659827112, 'f1-score': 0.29167668992061585, 'support': 10527}, 'accuracy': 0.3621454698087186, 'macro avg': {'precision': 0.37892610160674495, 'recall': 0.357438465479797, 'f1-score': 0.3369409709108617, 'support': 33354}, 'weighted avg': {'precision': 0.3782587959258316, 'recall': 0.3621454698087186, 'f1-score': 0.3386762123538433, 'support': 33354}}
[[2384 7289 1635]
 [2208 7270 2041]
 [1410 6692 2425]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
2104/2104 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.358971
{'0': {'precision': 0.5576861309179675, 'recall': 0.15793590874773733, 'f1-score': 0.2461597351688157, 'support': 219874}, '1': {'precision': 0.18881511030676879, 'recall': 0.7307749223104621, 'f1-score': 0.3000931777669746, 'support': 101365}, '2': {'precision': 0.5270785205649099, 'recall': 0.2036747315044036, 'f1-score': 0.29381347494191834, 'support': 217322}, 'accuracy': 0.28420921678324274, 'macro avg': {'precision': 0.4245265872632154, 'recall': 0.36412852085420105, 'f1-score': 0.28002212929256953, 'support': 538561}, 'weighted avg': {'precision': 0.47590835996648506, 'recall': 0.28420921678324274, 'f1-score': 0.275540194288456, 'support': 538561}}
[[ 34726 162100  23048]
 [ 10623  74075  16667]
 [ 16919 156140  44263]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2214643
{'0': {'precision': 0.48463085320310256, 'recall': 0.1861055186298574, 'f1-score': 0.26893569535500067, 'support': 36259}, '1': {'precision': 0.33211660002579646, 'recall': 0.7120064152195553, 'f1-score': 0.45295266240962584, 'support': 36164}, '2': {'precision': 0.4626940133037694, 'recall': 0.2251625259636913, 'f1-score': 0.3029159332982526, 'support': 37071}, 'accuracy': 0.37302500593639837, 'macro avg': {'precision': 0.4264804888442228, 'recall': 0.3744248199377014, 'f1-score': 0.3416014303542931, 'support': 109494}, 'weighted avg': {'precision': 0.42683091855999633, 'recall': 0.37302500593639837, 'f1-score': 0.34121792997386347, 'support': 109494}}
[[ 6748 25925  3586]
 [ 4308 25749  6107]
 [ 2868 25856  8347]]
Evaluating performance on  val set...
141/141 - 1s - 907ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2360815
{'0': {'precision': 0.5014277555682467, 'recall': 0.21655841486475377, 'f1-score': 0.3024804777216353, 'support': 12163}, '1': {'precision': 0.31932405566600397, 'recall': 0.7094522968197879, 'f1-score': 0.44041678091582126, 'support': 11320}, '2': {'precision': 0.4780399274047187, 'recall': 0.21190667739340305, 'f1-score': 0.2936454849498327, 'support': 12430}, 'accuracy': 0.37031158633363964, 'macro avg': {'precision': 0.43293057954632314, 'recall': 0.37930579635931494, 'f1-score': 0.34551424786242974, 'support': 35913}, 'weighted avg': {'precision': 0.4359326817240666, 'recall': 0.37031158633363964, 'f1-score': 0.3429009380564633, 'support': 35913}}
[[2634 8490 1039]
 [1452 8031 1837]
 [1167 8629 2634]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77279824
{'0': {'precision': 0.2972151316294, 'recall': 0.3584125453308408, 'f1-score': 0.32495770261570023, 'support': 151387}, '1': {'precision': 0.8082943629857247, 'recall': 0.6781196790264541, 'f1-score': 0.7375069105843132, 'support': 1046566}, '2': {'precision': 0.23230869258343678, 'recall': 0.44473361910594, 'f1-score': 0.3051965403598044, 'support': 150236}, 'accuracy': 0.6162125636687438, 'macro avg': {'precision': 0.44593939573285385, 'recall': 0.49375528115441164, 'f1-score': 0.45588705118660594, 'support': 1348189}, 'weighted avg': {'precision': 0.6867205074091711, 'recall': 0.6162125636687438, 'f1-score': 0.643007424438236, 'support': 1348189}}
[[ 54259  90307   6821]
 [122892 709697 213977]
 [  5407  78014  66815]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73407644
{'0': {'precision': 0.23636451981244383, 'recall': 0.4422674788617147, 'f1-score': 0.3080796086068494, 'support': 21998}, '1': {'precision': 0.8761941800104834, 'recall': 0.6853821125307515, 'f1-score': 0.7691302960362754, 'support': 226818}, '2': {'precision': 0.20731221169726077, 'recall': 0.4865238116452087, 'f1-score': 0.29073822644623704, 'support': 22447}, 'accuracy': 0.649211282039939, 'macro avg': {'precision': 0.4399569705067294, 'recall': 0.5380578010125583, 'f1-score': 0.4559827103631206, 'support': 271263}, 'weighted avg': {'precision': 0.7689574156608914, 'recall': 0.649211282039939, 'f1-score': 0.6921545941965107, 'support': 271263}}
[[  9729  11335    934]
 [ 30537 155457  40824]
 [   895  10631  10921]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73975134
{'0': {'precision': 0.2601511558980439, 'recall': 0.43920440330247684, 'f1-score': 0.32675663099115865, 'support': 7994}, '1': {'precision': 0.8841405648647048, 'recall': 0.6835937052932761, 'f1-score': 0.7710400113598956, 'support': 87375}, '2': {'precision': 0.17858101458351971, 'recall': 0.49670274978225704, 'f1-score': 0.2627093547431805, 'support': 8037}, 'accuracy': 0.650175038198944, 'macro avg': {'precision': 0.4409575784487562, 'recall': 0.5398336194593366, 'f1-score': 0.4535019990314116, 'support': 103406}, 'weighted avg': {'precision': 0.7810638242414396, 'recall': 0.650175038198944, 'f1-score': 0.6971849659089913, 'support': 103406}}
[[ 3511  4131   352]
 [ 9636 59729 18010]
 [  349  3696  3992]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
10110/10110 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6920834
{'0': {'precision': 0.4819362017804154, 'recall': 0.044711712176740824, 'f1-score': 0.08183149375698696, 'support': 290595}, '1': {'precision': 0.7860844392607735, 'recall': 0.9175201254469547, 'f1-score': 0.8467320506929752, 'support': 2002440}, '2': {'precision': 0.30298320134710816, 'recall': 0.22989432872645443, 'f1-score': 0.26142637194505086, 'support': 295066}, 'accuracy': 0.7411248633650696, 'macro avg': {'precision': 0.5236679474627657, 'recall': 0.39737538878338335, 'f1-score': 0.39666330546500433, 'support': 2588101}, 'weighted avg': {'precision': 0.6968565818715764, 'recall': 0.7411248633650696, 'f1-score': 0.6941181910529346, 'support': 2588101}}
[[  12993  273616    3986]
 [  13094 1837279  152067]
 [    873  226359   67834]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6877866
{'0': {'precision': 0.35547385620915034, 'recall': 0.10204991087344029, 'f1-score': 0.15857569793716741, 'support': 42636}, '1': {'precision': 0.8190297389058132, 'recall': 0.8678124747375593, 'f1-score': 0.8427157191760659, 'support': 346364}, '2': {'precision': 0.2478312378186265, 'recall': 0.3046889682390528, 'f1-score': 0.27333459779562075, 'support': 42568}, 'accuracy': 0.7366162458755051, 'macro avg': {'precision': 0.47411161097786336, 'recall': 0.4248504512833508, 'f1-score': 0.4248753383029514, 'support': 431568}, 'weighted avg': {'precision': 0.7168930040020801, 'recall': 0.7366162458755051, 'f1-score': 0.7189660215143662, 'support': 431568}}
[[  4351  37202   1083]
 [  7504 300579  38281]
 [   385  29213  12970]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75757664
{'0': {'precision': 0.3306379155435759, 'recall': 0.08668613964006407, 'f1-score': 0.13735956104662014, 'support': 21226}, '1': {'precision': 0.7679699154649429, 'recall': 0.9009706047502024, 'f1-score': 0.8291707353084283, 'support': 137131}, '2': {'precision': 0.25635335385496455, 'recall': 0.1623520877725892, 'f1-score': 0.19880086604119246, 'support': 22057}, 'accuracy': 0.7148669172015476, 'macro avg': {'precision': 0.45165372828782774, 'recall': 0.38333627738761855, 'f1-score': 0.388443720798747, 'support': 180414}, 'weighted avg': {'precision': 0.6539680335169665, 'recall': 0.7148669172015476, 'f1-score': 0.670710459546522, 'support': 180414}}
[[  1840  19131    255]
 [  3447 123551  10133]
 [   278  18198   3581]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
6546/6546 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89252245
{'0': {'precision': 0.3991389913899139, 'recall': 0.002101160008676593, 'f1-score': 0.004180313877804723, 'support': 308877}, '1': {'precision': 0.6541682577461423, 'recall': 0.7765074841778713, 'f1-score': 0.7101071656787167, 'support': 1061172}, '2': {'precision': 0.33288220478823494, 'recall': 0.45134436739500194, 'f1-score': 0.3831660733426266, 'support': 305720}, 'accuracy': 0.5744479101833248, 'macro avg': {'precision': 0.46206315130809705, 'recall': 0.4099843371938499, 'f1-score': 0.3658178509663827, 'support': 1675769}, 'weighted avg': {'precision': 0.5485473476955302, 'recall': 0.5744479101833248, 'f1-score': 0.520345331587801, 'support': 1675769}}
[[   649 268036  40192]
 [   825 824008 236339]
 [   152 167583 137985]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8818325
{'0': {'precision': 0.447591706539075, 'recall': 0.11249358645459209, 'f1-score': 0.17979831631280194, 'support': 62368}, '1': {'precision': 0.6192303638854667, 'recall': 0.8929046795577216, 'f1-score': 0.7313019985021426, 'support': 190830}, '2': {'precision': 0.4117696230042631, 'recall': 0.16000779575131555, 'f1-score': 0.23046153126388924, 'support': 61572}, 'accuracy': 0.5949137465450964, 'macro avg': {'precision': 0.4928638978096016, 'recall': 0.3884686872545431, 'f1-score': 0.3805206153596113, 'support': 314770}, 'weighted avg': {'precision': 0.5446408778514825, 'recall': 0.5949137465450964, 'f1-score': 0.524058833970648, 'support': 314770}}
[[  7016  54197   1155]
 [  7518 170393  12919]
 [  1141  50579   9852]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82075727
{'0': {'precision': 0.41299106509714933, 'recall': 0.14941762019600802, 'f1-score': 0.21944235116804825, 'support': 19489}, '1': {'precision': 0.676481568812387, 'recall': 0.9169663070981489, 'f1-score': 0.7785768400104028, 'support': 75090}, '2': {'precision': 0.4272667971298108, 'recall': 0.10421638822593476, 'f1-score': 0.1675620363264262, 'support': 18855}, 'accuracy': 0.6499991184301003, 'macro avg': {'precision': 0.5055798103464489, 'recall': 0.3902001051733639, 'f1-score': 0.38852707583495905, 'support': 113434}, 'weighted avg': {'precision': 0.5897870068029257, 'recall': 0.6499991184301003, 'f1-score': 0.5809495309451311, 'support': 113434}}
[[ 2912 16408   169]
 [ 3770 68855  2465]
 [  369 16521  1965]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
7633/7633 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9585757
{'0': {'precision': 0.41974175648276596, 'recall': 0.23109589298639768, 'f1-score': 0.29807924024425914, 'support': 425516}, '1': {'precision': 0.5761556022184167, 'recall': 0.7871578304486386, 'f1-score': 0.6653281380142265, 'support': 1103583}, '2': {'precision': 0.3701968665525001, 'recall': 0.18468588266582567, 'f1-score': 0.2464309267342901, 'support': 424889}, 'accuracy': 0.535059580713904, 'macro avg': {'precision': 0.4553647417512276, 'recall': 0.4009798687002874, 'f1-score': 0.4032794349975919, 'support': 1953988}, 'weighted avg': {'precision': 0.4973085493089787, 'recall': 0.535059580713904, 'f1-score': 0.49426511245470095, 'support': 1953988}}
[[ 98335 314332  12849]
 [114238 868694 120651]
 [ 21702 324716  78471]]
Evaluating performance on  train set...
1586/1586 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92394084
{'0': {'precision': 0.41970669701329094, 'recall': 0.23471703550715067, 'f1-score': 0.30106582878969906, 'support': 83279}, '1': {'precision': 0.6051646891658892, 'recall': 0.7691927339772465, 'f1-score': 0.6773904283231299, 'support': 238645}, '2': {'precision': 0.38116864540123013, 'recall': 0.25407003074869494, 'f1-score': 0.3049043866298611, 'support': 83906}, 'accuracy': 0.553012345070596, 'macro avg': {'precision': 0.4686800105268034, 'recall': 0.4193266000776974, 'f1-score': 0.42778688124756337, 'support': 405830}, 'weighted avg': {'precision': 0.5207959431969028, 'recall': 0.553012345070596, 'f1-score': 0.5231540482160407, 'support': 405830}}
[[ 19547  60344   3388]
 [ 23859 183564  31222]
 [  3167  59421  21318]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89022
{'0': {'precision': 0.3906229593835706, 'recall': 0.21828930083199533, 'f1-score': 0.28006929163350347, 'support': 27404}, '1': {'precision': 0.6434117378396894, 'recall': 0.8004523749685851, 'f1-score': 0.7133918615578636, 'support': 91517}, '2': {'precision': 0.38182639634043036, 'recall': 0.24186162982041925, 'f1-score': 0.29613893694838045, 'support': 27954}, 'accuracy': 0.5855182978723404, 'macro avg': {'precision': 0.47195369785456354, 'recall': 0.4202011018736666, 'f1-score': 0.4298666967132492, 'support': 146875}, 'weighted avg': {'precision': 0.5464600420365796, 'recall': 0.5855182978723404, 'f1-score': 0.5531286448038847, 'support': 146875}}
[[ 5982 20344  1078]
 [ 8394 73255  9868]
 [  938 20255  6761]]
testing model on single stock: results/universal/W10/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
22048/22048 - 115s - 115s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4142891
{'0': {'precision': 0.46611611611611614, 'recall': 0.008675805467443605, 'f1-score': 0.017034547408372774, 'support': 2146890}, '1': {'precision': 0.23281384776759212, 'recall': 0.9658694249869434, 'f1-score': 0.3751913159771439, 'support': 1319257}, '2': {'precision': 0.5071904809183042, 'recall': 0.030492382414238167, 'f1-score': 0.05752627489434171, 'support': 2177921}, 'accuracy': 0.24083090423432177, 'macro avg': {'precision': 0.40204014826733747, 'recall': 0.33501253762287503, 'f1-score': 0.14991737942661945, 'support': 5644068}, 'weighted avg': {'precision': 0.4274332141790164, 'recall': 0.24083090423432177, 'f1-score': 0.11637576860728464, 'support': 5644068}}
[[  18626 2098013   30251]
 [  10751 1274230   34276]
 [  10583 2100928   66410]]
Evaluating performance on  train set...
5429/5429 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2574083
{'0': {'precision': 0.4208623937280456, 'recall': 0.017921675320029917, 'f1-score': 0.034379366557987893, 'support': 461285}, '1': {'precision': 0.3300982374476442, 'recall': 0.9626186498306477, 'f1-score': 0.49161378298746045, 'support': 460283}, '2': {'precision': 0.4600466033339308, 'recall': 0.027407587756392186, 'f1-score': 0.05173313875792898, 'support': 468228}, 'accuracy': 0.3339893049051803, 'macro avg': {'precision': 0.4036690781698735, 'recall': 0.33598263763569, 'f1-score': 0.19257542943445907, 'support': 1389796}, 'weighted avg': {'precision': 0.40400376551939665, 'recall': 0.3339893049051803, 'f1-score': 0.19165622657704173, 'support': 1389796}}
[[  8267 447900   5118]
 [  7262 443077   9944]
 [  4114 451281  12833]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2197311
{'0': {'precision': 0.3866387337057728, 'recall': 0.010850393906533752, 'f1-score': 0.021108414136664592, 'support': 153082}, '1': {'precision': 0.3603952082281057, 'recall': 0.9686723108824911, 'f1-score': 0.5253380346228225, 'support': 174574}, '2': {'precision': 0.474384236453202, 'recall': 0.03086320836351283, 'f1-score': 0.05795583801253002, 'support': 156011}, 'accuracy': 0.3630204252099068, 'macro avg': {'precision': 0.4071393927956935, 'recall': 0.3367953043841792, 'f1-score': 0.2014674289240057, 'support': 483667}, 'weighted avg': {'precision': 0.405469512759111, 'recall': 0.3630204252099068, 'f1-score': 0.2149897110063046, 'support': 483667}}
[[  1661 149761   1660]
 [  1794 169105   3675]
 [   841 150355   4815]]
training model: results/universal/W10/deepLOB_L1/h20
Epoch 1/50
8543/8543 - 142s - loss: 2.9636 - accuracy20: 0.4784 - val_loss: 3.3168 - val_accuracy20: 0.4069 - 142s/epoch - 17ms/step
Epoch 2/50
8543/8543 - 133s - loss: 2.9237 - accuracy20: 0.4901 - val_loss: 3.4708 - val_accuracy20: 0.4275 - 133s/epoch - 16ms/step
Epoch 3/50
8543/8543 - 135s - loss: 2.9088 - accuracy20: 0.4947 - val_loss: 3.6893 - val_accuracy20: 0.4377 - 135s/epoch - 16ms/step
Epoch 4/50
8543/8543 - 138s - loss: 2.8867 - accuracy20: 0.4984 - val_loss: 3.7962 - val_accuracy20: 0.4366 - 138s/epoch - 16ms/step
Epoch 5/50
8543/8543 - 135s - loss: 2.8753 - accuracy20: 0.5012 - val_loss: 3.8632 - val_accuracy20: 0.4433 - 135s/epoch - 16ms/step
Epoch 6/50
8543/8543 - 135s - loss: 2.8666 - accuracy20: 0.5033 - val_loss: 3.8436 - val_accuracy20: 0.4495 - 135s/epoch - 16ms/step
Epoch 7/50
8543/8543 - 136s - loss: 2.8584 - accuracy20: 0.5053 - val_loss: 3.9407 - val_accuracy20: 0.4492 - 136s/epoch - 16ms/step
Epoch 8/50
8543/8543 - 136s - loss: 2.8543 - accuracy20: 0.5058 - val_loss: 4.0710 - val_accuracy20: 0.4597 - 136s/epoch - 16ms/step
Epoch 9/50
8543/8543 - 138s - loss: 2.8491 - accuracy20: 0.5069 - val_loss: 4.1525 - val_accuracy20: 0.4553 - 138s/epoch - 16ms/step
Epoch 10/50
8543/8543 - 136s - loss: 2.8452 - accuracy20: 0.5078 - val_loss: 4.2306 - val_accuracy20: 0.4573 - 136s/epoch - 16ms/step
Epoch 11/50
8543/8543 - 136s - loss: 2.8411 - accuracy20: 0.5089 - val_loss: 4.2182 - val_accuracy20: 0.4567 - 136s/epoch - 16ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 195s - 195s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1259184
{'0': {'precision': 0.3823120301040469, 'recall': 0.17348740936021267, 'f1-score': 0.23866999122535032, 'support': 2870704}, '1': {'precision': 0.37132495402863774, 'recall': 0.6633512270550944, 'f1-score': 0.47612744623748093, 'support': 3757370}, '2': {'precision': 0.36658397951728655, 'recall': 0.19229742167588496, 'f1-score': 0.25226516373012886, 'support': 2917205}, 'accuracy': 0.3720643472024233, 'macro avg': {'precision': 0.3734069878833237, 'recall': 0.34304535269706404, 'f1-score': 0.32235420039765333, 'support': 9545279}, 'weighted avg': {'precision': 0.37318034753663215, 'recall': 0.3720643472024233, 'f1-score': 0.33629683093802204, 'support': 9545279}}
[[ 498031 2128490  244183]
 [ 539802 2492456  725112]
 [ 264849 2091385  560971]]
Evaluating performance on  train set...
8543/8543 - 48s - 48s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.098117
{'0': {'precision': 0.3576436270231774, 'recall': 0.345606680749934, 'f1-score': 0.35152214072468185, 'support': 605920}, '1': {'precision': 0.4281037880128966, 'recall': 0.6117331901301787, 'f1-score': 0.5037045257144321, 'support': 964597}, '2': {'precision': 0.3411160223473715, 'recall': 0.12336194403467689, 'f1-score': 0.18119583146613782, 'support': 616203}, 'accuracy': 0.4003722470183654, 'macro avg': {'precision': 0.37562114579448186, 'recall': 0.36023393830492983, 'f1-score': 0.34547416596841724, 'support': 2186720}, 'weighted avg': {'precision': 0.3840673576910976, 'recall': 0.4003722470183654, 'f1-score': 0.3706554039087729, 'support': 2186720}}
[[209410 368798  27712]
 [255404 590076 119117]
 [120713 419474  76016]]
Evaluating performance on  val set...
3077/3077 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0685765
{'0': {'precision': 0.3379906015865327, 'recall': 0.26084339104176174, 'f1-score': 0.2944475956387471, 'support': 205978}, '1': {'precision': 0.44247514494191303, 'recall': 0.6490191851692175, 'f1-score': 0.5262049469347094, 'support': 371120}, '2': {'precision': 0.30827274466660287, 'recall': 0.12284781624532393, 'f1-score': 0.17568465493800026, 'support': 209845}, 'accuracy': 0.4071082657829093, 'macro avg': {'precision': 0.36291283039834954, 'recall': 0.3442367974854344, 'f1-score': 0.3321123991704856, 'support': 786943}, 'weighted avg': {'precision': 0.3793406867193645, 'recall': 0.4071082657829093, 'f1-score': 0.37207453802416673, 'support': 786943}}
[[ 53728 142835   9415]
 [ 81826 240864  48430]
 [ 23409 160657  25779]]
testing model out of sample: results/universal/W10/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 116s - 116s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97591835
{'0': {'precision': 0.4204457308124531, 'recall': 0.30797664588804413, 'f1-score': 0.35552852327272116, 'support': 1270697}, '1': {'precision': 0.5933905346102585, 'recall': 0.745114721919675, 'f1-score': 0.6606533983021414, 'support': 2924245}, '2': {'precision': 0.419805213345811, 'recall': 0.2845668981567428, 'f1-score': 0.3392032859932841, 'support': 1265857}, 'accuracy': 0.53663648854316, 'macro avg': {'precision': 0.47788049292284085, 'recall': 0.44588608865482066, 'f1-score': 0.4517950691893822, 'support': 5460799}, 'weighted avg': {'precision': 0.5129087887391305, 'recall': 0.53663648854316, 'f1-score': 0.5151378541222124, 'support': 5460799}}
[[ 391345  749041  130311]
 [ 377812 2178898  367535]
 [ 161629  744007  360221]]
Evaluating performance on  train set...
4055/4055 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97146994
{'0': {'precision': 0.3902557560294028, 'recall': 0.4227224271882992, 'f1-score': 0.40584080561674235, 'support': 227951}, '1': {'precision': 0.6313886529168465, 'recall': 0.6267939937822616, 'f1-score': 0.6290829339107796, 'support': 578667}, '2': {'precision': 0.39239920595625355, 'recall': 0.3673233360189204, 'f1-score': 0.37944743618713517, 'support': 230862}, 'accuracy': 0.5242182981840614, 'macro avg': {'precision': 0.47134787163416764, 'recall': 0.47227991899649374, 'f1-score': 0.47145705857155235, 'support': 1037480}, 'weighted avg': {'precision': 0.5252275060199365, 'recall': 0.5242182981840614, 'f1-score': 0.5244836966606832, 'support': 1037480}}
[[ 96360 103760  27831]
 [112485 362705 103477]
 [ 38070 107991  84801]]
Evaluating performance on  val set...
1545/1545 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9808982
{'0': {'precision': 0.35691617695642164, 'recall': 0.4177201841849348, 'f1-score': 0.3849318174456645, 'support': 85349}, '1': {'precision': 0.6196231875107525, 'recall': 0.6334866729806522, 'f1-score': 0.6264782425443947, 'support': 221730}, '2': {'precision': 0.39884376143432126, 'recall': 0.3102839705781887, 'f1-score': 0.34903394790939535, 'support': 87826}, 'accuracy': 0.5149744875349768, 'macro avg': {'precision': 0.45846104196716514, 'recall': 0.45383027591459185, 'f1-score': 0.4534813359664849, 'support': 394905}, 'weighted avg': {'precision': 0.5137446736444043, 'recall': 0.5149744875349768, 'f1-score': 0.5125709269713709, 'support': 394905}}
[[ 35652  40538   9159]
 [ 49352 140463  31915]
 [ 14885  45690  27251]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2336428
{'0': {'precision': 0.5669451343418379, 'recall': 0.14085639491398655, 'f1-score': 0.2256503961537886, 'support': 53480}, '1': {'precision': 0.23329671954542575, 'recall': 0.7403720462543992, 'f1-score': 0.3547949276002474, 'support': 29835}, '2': {'precision': 0.4890223611054746, 'recall': 0.24444669844811848, 'f1-score': 0.325957584938325, 'support': 49295}, 'accuracy': 0.31424477792021716, 'macro avg': {'precision': 0.42975473833091277, 'recall': 0.3752250465388347, 'f1-score': 0.3021343028974537, 'support': 132610}, 'weighted avg': {'precision': 0.4629137372968376, 'recall': 0.31424477792021716, 'f1-score': 0.2919928286011064, 'support': 132610}}
[[ 7533 38731  7216]
 [ 2371 22089  5375]
 [ 3383 33862 12050]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1463951
{'0': {'precision': 0.4590514530129576, 'recall': 0.3194991681989318, 'f1-score': 0.37676819824470836, 'support': 11421}, '1': {'precision': 0.3463668586619406, 'recall': 0.5476836850862598, 'f1-score': 0.4243596268023749, 'support': 11419}, '2': {'precision': 0.45070930512142343, 'recall': 0.326482626491335, 'f1-score': 0.37866774405333065, 'support': 11483}, 'accuracy': 0.39775077936077846, 'macro avg': {'precision': 0.41870920559877384, 'recall': 0.3978884932588422, 'f1-score': 0.39326518970013796, 'support': 34323}, 'weighted avg': {'precision': 0.4187712249695829, 'recall': 0.39775077936077846, 'f1-score': 0.3932370094564441, 'support': 34323}}
[[3649 5946 1826]
 [2422 6254 2743]
 [1878 5856 3749]]
Evaluating performance on  val set...
46/46 - 0s - 431ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1583935
{'0': {'precision': 0.47226331360946744, 'recall': 0.31956956956956956, 'f1-score': 0.38119402985074624, 'support': 3996}, '1': {'precision': 0.34114853835880693, 'recall': 0.6120873269435569, 'f1-score': 0.4381133873272987, 'support': 3756}, '2': {'precision': 0.45913354175971416, 'recall': 0.26157760814249365, 'f1-score': 0.3332792997244286, 'support': 3930}, 'accuracy': 0.394110597500428, 'macro avg': {'precision': 0.42418179790932947, 'recall': 0.3977448348852067, 'f1-score': 0.3841955723008246, 'support': 11682}, 'weighted avg': {'precision': 0.4256902011962667, 'recall': 0.394110597500428, 'f1-score': 0.38337552422546833, 'support': 11682}}
[[1277 2158  561]
 [ 807 2299  650]
 [ 620 2282 1028]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
1840/1840 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85182136
{'0': {'precision': 0.2863228208497591, 'recall': 0.4699148125516696, 'f1-score': 0.35583348076373483, 'support': 55642}, '1': {'precision': 0.8336344962856569, 'recall': 0.6000127834948408, 'f1-score': 0.6977885866184039, 'support': 359839}, '2': {'precision': 0.2562597906358008, 'recall': 0.557221641495152, 'f1-score': 0.3510676348524161, 'support': 55486}, 'accuracy': 0.5796011185497073, 'macro avg': {'precision': 0.45873903592373894, 'recall': 0.5423830791805542, 'f1-score': 0.4682299007448516, 'support': 470967}, 'weighted avg': {'precision': 0.7009506157541289, 'recall': 0.5796011185497073, 'f1-score': 0.616540378719224, 'support': 470967}}
[[ 26147  22839   6656]
 [ 60854 215908  83077]
 [  4319  20249  30918]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8523029
{'0': {'precision': 0.1813074716891872, 'recall': 0.5770750988142292, 'f1-score': 0.2759241343622742, 'support': 10626}, '1': {'precision': 0.8972051374819102, 'recall': 0.5226474410762584, 'f1-score': 0.6605220518056512, 'support': 113876}, '2': {'precision': 0.1927987742594484, 'recall': 0.6234516928158547, 'f1-score': 0.2945192120148235, 'support': 10899}, 'accuracy': 0.535032976122776, 'macro avg': {'precision': 0.4237704611435153, 'recall': 0.5743914109021141, 'f1-score': 0.4103217993942496, 'support': 135401}, 'weighted avg': {'precision': 0.7843222669752294, 'recall': 0.535032976122776, 'f1-score': 0.6008784566945844, 'support': 135401}}
[[ 6132  3615   879]
 [26789 59517 27570]
 [  900  3204  6795]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9183452
{'0': {'precision': 0.19778526171585137, 'recall': 0.6486334706102583, 'f1-score': 0.3031363457416561, 'support': 5342}, '1': {'precision': 0.8593709917397774, 'recall': 0.39717354705617336, 'f1-score': 0.5432667358588479, 'support': 42173}, '2': {'precision': 0.21702339472374316, 'recall': 0.6265493084246452, 'f1-score': 0.32238088636258605, 'support': 5567}, 'accuracy': 0.4465355487735956, 'macro avg': {'precision': 0.424726549393124, 'recall': 0.5574521086970257, 'f1-score': 0.38959465598769666, 'support': 53082}, 'weighted avg': {'precision': 0.7254246437804677, 'recall': 0.4465355487735956, 'f1-score': 0.49593528511939333, 'support': 53082}}
[[ 3465  1296   581]
 [13420 16750 12003]
 [  634  1445  3488]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
967/967 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2063226
{'0': {'precision': 0.4550455683052368, 'recall': 0.22029810483963147, 'f1-score': 0.2968730745532963, 'support': 87486}, '1': {'precision': 0.29835183316515307, 'recall': 0.6025494165911875, 'f1-score': 0.39909307054728954, 'support': 75076}, '2': {'precision': 0.41333408013143647, 'recall': 0.2605293196982713, 'f1-score': 0.3196067533329965, 'support': 84977}, 'accuracy': 0.3500418115933247, 'macro avg': {'precision': 0.38891049386727544, 'recall': 0.36112561370969676, 'f1-score': 0.3385242994778608, 'support': 247539}, 'weighted avg': {'precision': 0.39320296576615427, 'recall': 0.3500418115933247, 'f1-score': 0.33567951814766983, 'support': 247539}}
[[19273 54158 14055]
 [12471 45237 17368]
 [10610 52228 22139]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1653988
{'0': {'precision': 0.42145486742159466, 'recall': 0.48555782239879736, 'f1-score': 0.4512411126356492, 'support': 18626}, '1': {'precision': 0.33507055410787157, 'recall': 0.36782167530224524, 'f1-score': 0.3506830987727378, 'support': 18528}, '2': {'precision': 0.439621206884634, 'recall': 0.33279263251530533, 'f1-score': 0.37881946512597536, 'support': 19111}, 'accuracy': 0.3948991380076424, 'macro avg': {'precision': 0.39871554280470006, 'recall': 0.39539071007211596, 'f1-score': 0.39358122551145414, 'support': 56265}, 'weighted avg': {'precision': 0.39917900065542533, 'recall': 0.3948991380076424, 'f1-score': 0.39352869840994226, 'support': 56265}}
[[9044 6399 3183]
 [6789 6815 4924]
 [5626 7125 6360]]
Evaluating performance on  val set...
79/79 - 1s - 618ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1688561
{'0': {'precision': 0.43601488691669055, 'recall': 0.4399826664740719, 'f1-score': 0.4379897907829463, 'support': 6923}, '1': {'precision': 0.31654094827586204, 'recall': 0.3723067173637516, 'f1-score': 0.34216656959813624, 'support': 6312}, '2': {'precision': 0.43824630190696845, 'recall': 0.36236368994989687, 'f1-score': 0.39670888118093084, 'support': 6786}, 'accuracy': 0.39233804505269465, 'macro avg': {'precision': 0.3969340456998403, 'recall': 0.39155102459590685, 'f1-score': 0.3922884138540044, 'support': 20021}, 'weighted avg': {'precision': 0.39910478659318604, 'recall': 0.39233804505269465, 'f1-score': 0.3937877816586369, 'support': 20021}}
[[3046 2526 1351]
 [2161 2350 1801]
 [1779 2548 2459]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1588/1588 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2328991
{'0': {'precision': 0.3935045317220544, 'recall': 0.318536633916765, 'f1-score': 0.35207405137392644, 'support': 140662}, '1': {'precision': 0.30309522252022414, 'recall': 0.44273599554086873, 'f1-score': 0.3598432509570299, 'support': 125585}, '2': {'precision': 0.3996586466993338, 'recall': 0.31101336056384293, 'f1-score': 0.3498074428653466, 'support': 140039}, 'accuracy': 0.3543341390055281, 'macro avg': {'precision': 0.3654194669805375, 'recall': 0.3574286633404922, 'f1-score': 0.35390824839876767, 'support': 406286}, 'weighted avg': {'precision': 0.36767977529724866, 'recall': 0.3543341390055281, 'f1-score': 0.3536942926342973, 'support': 406286}}
[[44806 63518 32338]
 [36898 55601 33086]
 [32160 64325 43554]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2102592
{'0': {'precision': 0.39634206623826, 'recall': 0.4593263061411549, 'f1-score': 0.4255161067770525, 'support': 26184}, '1': {'precision': 0.32828930494998715, 'recall': 0.2572347266881029, 'f1-score': 0.2884507042253521, 'support': 24880}, '2': {'precision': 0.37762183235867447, 'recall': 0.3965446655203472, 'f1-score': 0.3868519849828261, 'support': 24426}, 'accuracy': 0.3724069413167307, 'macro avg': {'precision': 0.3674177345156406, 'recall': 0.3710352327832016, 'f1-score': 0.3669395986617436, 'support': 75490}, 'weighted avg': {'precision': 0.36785600008916763, 'recall': 0.3724069413167307, 'f1-score': 0.36783168427828333, 'support': 75490}}
[[12027  6831  7326]
 [ 9842  6400  8638]
 [ 8476  6264  9686]]
Evaluating performance on  val set...
131/131 - 1s - 856ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1996034
{'0': {'precision': 0.4031449631449631, 'recall': 0.3601404741000878, 'f1-score': 0.38043125434732206, 'support': 11390}, '1': {'precision': 0.37052743175192154, 'recall': 0.37000441111601234, 'f1-score': 0.3702657367352344, 'support': 11335}, '2': {'precision': 0.3808600337268128, 'recall': 0.42496942327594317, 'f1-score': 0.401707501445151, 'support': 10629}, 'accuracy': 0.38415182586796187, 'macro avg': {'precision': 0.38484414287456586, 'recall': 0.3850381028306811, 'f1-score': 0.38413483084256916, 'support': 33354}, 'weighted avg': {'precision': 0.38495865166431176, 'recall': 0.38415182586796187, 'f1-score': 0.38375676517870083, 'support': 33354}}
[[4102 3732 3556]
 [3354 4194 3787]
 [2719 3393 4517]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
2104/2104 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2455919
{'0': {'precision': 0.5052383513921975, 'recall': 0.27862954870790324, 'f1-score': 0.3591787183028059, 'support': 212368}, '1': {'precision': 0.22771589707437434, 'recall': 0.55225679603351, 'f1-score': 0.3224668064290706, 'support': 116980}, '2': {'precision': 0.4844711929376234, 'recall': 0.31897157442415147, 'f1-score': 0.3846759108477419, 'support': 209213}, 'accuracy': 0.353735231477957, 'macro avg': {'precision': 0.4058084804680651, 'recall': 0.38328597305518824, 'f1-score': 0.3554404785265395, 'support': 538561}, 'weighted avg': {'precision': 0.4368907803132375, 'recall': 0.353735231477957, 'f1-score': 0.36110939039550133, 'support': 538561}}
[[ 59172 110717  42479]
 [ 23845  64603  28532]
 [ 34100 108380  66733]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1700331
{'0': {'precision': 0.4446212258181161, 'recall': 0.3387421141078267, 'f1-score': 0.3845263783344279, 'support': 36299}, '1': {'precision': 0.3396644443996858, 'recall': 0.4662556332771158, 'f1-score': 0.3930177818173344, 'support': 36169}, '2': {'precision': 0.4346070208139174, 'recall': 0.377842597093934, 'f1-score': 0.4042417938049006, 'support': 37026}, 'accuracy': 0.39408552066779917, 'macro avg': {'precision': 0.40629756367723974, 'recall': 0.39428011482629216, 'f1-score': 0.3939286513188876, 'support': 109494}, 'weighted avg': {'precision': 0.4065646402370919, 'recall': 0.39408552066779917, 'f1-score': 0.39399820825919973, 'support': 109494}}
[[12296 16261  7742]
 [ 8847 16864 10458]
 [ 6512 16524 13990]]
Evaluating performance on  val set...
141/141 - 1s - 897ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1733835
{'0': {'precision': 0.43513179571663924, 'recall': 0.3555144275258686, 'f1-score': 0.39131441270429185, 'support': 11887}, '1': {'precision': 0.3246053853296193, 'recall': 0.45032202662086734, 'f1-score': 0.3772661870503597, 'support': 11645}, '2': {'precision': 0.44037427831972925, 'recall': 0.3573217026088361, 'f1-score': 0.39452445712756945, 'support': 12381}, 'accuracy': 0.38687940300169854, 'macro avg': {'precision': 0.40003715312199595, 'recall': 0.38771938558519076, 'f1-score': 0.387701685627407, 'support': 35913}, 'weighted avg': {'precision': 0.4011003065108366, 'recall': 0.38687940300169854, 'f1-score': 0.38786585569887766, 'support': 35913}}
[[4226 5381 2280]
 [3059 5244 3342]
 [2427 5530 4424]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
5267/5267 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90829307
{'0': {'precision': 0.29784654493901397, 'recall': 0.6013908013641501, 'f1-score': 0.39838686211332835, 'support': 202617}, '1': {'precision': 0.7817485984265758, 'recall': 0.4165095590028523, 'f1-score': 0.5434651322220231, 'support': 943090}, '2': {'precision': 0.2930706720902961, 'recall': 0.6319425924279689, 'f1-score': 0.4004349935063919, 'support': 202482}, 'accuracy': 0.4766505289688612, 'macro avg': {'precision': 0.45755527181862865, 'recall': 0.5499476509316571, 'f1-score': 0.4474289959472477, 'support': 1348189}, 'weighted avg': {'precision': 0.6356301638065693, 'recall': 0.4766505289688612, 'f1-score': 0.5001801384993093, 'support': 1348189}}
[[121852  57537  23228]
 [264861 392806 285423]
 [ 22397  52128 127957]]
Evaluating performance on  train set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.894926
{'0': {'precision': 0.22059377626633947, 'recall': 0.7439397888700638, 'f1-score': 0.3402856951244048, 'support': 30692}, '1': {'precision': 0.8628226520816595, 'recall': 0.40019300684601017, 'f1-score': 0.5467795891059218, 'support': 209319}, '2': {'precision': 0.27825102589500494, 'recall': 0.6292077307052348, 'f1-score': 0.38586369969192125, 'support': 31252}, 'accuracy': 0.46547077928062436, 'macro avg': {'precision': 0.4538891514143346, 'recall': 0.591113508807103, 'f1-score': 0.424309661307416, 'support': 271263}, 'weighted avg': {'precision': 0.7228097453523631, 'recall': 0.46547077928062436, 'f1-score': 0.5048768822493027, 'support': 271263}}
[[22833  5552  2307]
 [76852 83768 48699]
 [ 3822  7766 19664]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9073998
{'0': {'precision': 0.22634281305701137, 'recall': 0.7635971997845988, 'f1-score': 0.34918224538794607, 'support': 11142}, '1': {'precision': 0.8806353517758555, 'recall': 0.3678109894446089, 'f1-score': 0.5188967268868458, 'support': 81096}, '2': {'precision': 0.23495899330119577, 'recall': 0.6720988538681948, 'f1-score': 0.3481931623138656, 'support': 11168}, 'accuracy': 0.44332050364582326, 'macro avg': {'precision': 0.44731238604468754, 'recall': 0.601169014365801, 'f1-score': 0.40542404486288586, 'support': 103406}, 'weighted avg': {'precision': 0.7404013127660266, 'recall': 0.44332050364582326, 'f1-score': 0.482173749864122, 'support': 103406}}
[[ 8508  1828   806]
 [27634 29828 23634]
 [ 1447  2215  7506]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
10110/10110 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8366331
{'0': {'precision': 0.41539185123099837, 'recall': 0.17326904503199325, 'f1-score': 0.24453653991214452, 'support': 397584}, '1': {'precision': 0.719669899174516, 'recall': 0.8665191744532017, 'f1-score': 0.7862968889141176, 'support': 1790377}, '2': {'precision': 0.3727635947553038, 'recall': 0.24831808866896588, 'f1-score': 0.298073331883395, 'support': 400140}, 'accuracy': 0.6644435437411446, 'macro avg': {'precision': 0.5026084483869394, 'recall': 0.4293687693847203, 'f1-score': 0.4429689202365524, 'support': 2588101}, 'weighted avg': {'precision': 0.6192923744705423, 'recall': 0.6644435437411446, 'f1-score': 0.6275886233912985, 'support': 2588101}}
[[  68889  313524   15171]
 [  86959 1551396  152022]
 [   9993  290785   99362]]
Evaluating performance on  train set...
1686/1686 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8398516
{'0': {'precision': 0.33246120806993135, 'recall': 0.37862555976575957, 'f1-score': 0.35404486962683807, 'support': 58060}, '1': {'precision': 0.784528646787185, 'recall': 0.7261764062851512, 'f1-score': 0.7542255745991628, 'support': 315601}, '2': {'precision': 0.30671449419659297, 'recall': 0.3883468319892241, 'f1-score': 0.34273695761510675, 'support': 57907}, 'accuracy': 0.6340901086271457, 'macro avg': {'precision': 0.47456811635123647, 'recall': 0.49771626601337826, 'f1-score': 0.48366913394703587, 'support': 431568}, 'weighted avg': {'precision': 0.6595985786959755, 'recall': 0.6340901086271457, 'f1-score': 0.6451754062030146, 'support': 431568}}
[[ 21983  32325   3752]
 [ 39340 229182  47079]
 [  4799  30620  22488]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.893721
{'0': {'precision': 0.2991174021648626, 'recall': 0.32049818000142744, 'f1-score': 0.3094389029579478, 'support': 28022}, '1': {'precision': 0.7013418208463088, 'recall': 0.7469941223812891, 'f1-score': 0.7234484794803661, 'support': 123009}, '2': {'precision': 0.3020698910855314, 'recall': 0.1991627812000136, 'f1-score': 0.24005250635819178, 'support': 29383}, 'accuracy': 0.5915283736295409, 'macro avg': {'precision': 0.4341763713655677, 'recall': 0.4222183611942434, 'f1-score': 0.42431329626550185, 'support': 180414}, 'weighted avg': {'precision': 0.5738409629724609, 'recall': 0.5915283736295409, 'f1-score': 0.5804163410013121, 'support': 180414}}
[[ 8981 18204   837]
 [18438 91887 12684]
 [ 2606 20925  5852]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98931676
{'0': {'precision': 0.4915706893673844, 'recall': 0.044580009385265136, 'f1-score': 0.08174651640481874, 'support': 396366}, '1': {'precision': 0.5737642572005208, 'recall': 0.7266198573160759, 'f1-score': 0.6412082369294211, 'support': 886575}, '2': {'precision': 0.3864525574549808, 'recall': 0.5086653700856354, 'f1-score': 0.43921594487215415, 'support': 392828}, 'accuracy': 0.5142063136386936, 'macro avg': {'precision': 0.4839291680076287, 'recall': 0.42662174559565885, 'f1-score': 0.38739023273546463, 'support': 1675769}, 'weighted avg': {'precision': 0.5104142273960609, 'recall': 0.5142063136386936, 'f1-score': 0.4615296341973461, 'support': 1675769}}
[[ 17670 289793  88903]
 [ 14036 644203 228336]
 [  4240 188770 199818]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9891371
{'0': {'precision': 0.43217179594476357, 'recall': 0.2868414740376968, 'f1-score': 0.3448192131122662, 'support': 79211}, '1': {'precision': 0.5313109050836962, 'recall': 0.741735747342725, 'f1-score': 0.6191325204028569, 'support': 157304}, '2': {'precision': 0.4437687828700225, 'recall': 0.24153089259472238, 'f1-score': 0.31280875818183324, 'support': 78255}, 'accuracy': 0.5029068843917781, 'macro avg': {'precision': 0.4690838279661607, 'recall': 0.4233693713250481, 'f1-score': 0.4255868305656521, 'support': 314770}, 'weighted avg': {'precision': 0.4845989670088002, 'recall': 0.5029068843917781, 'f1-score': 0.4739471552270105, 'support': 314770}}
[[ 22721  50917   5573]
 [ 22508 116678  18118]
 [  7345  52009  18901]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9465154
{'0': {'precision': 0.3793522618737519, 'recall': 0.35078281814532314, 'f1-score': 0.3645085933589187, 'support': 24910}, '1': {'precision': 0.5977057104722052, 'recall': 0.7735173744572914, 'f1-score': 0.6743406772303018, 'support': 64261}, '2': {'precision': 0.43940859472156973, 'recall': 0.13106375963401062, 'f1-score': 0.20190476190476192, 'support': 24263}, 'accuracy': 0.5432674506761641, 'macro avg': {'precision': 0.4721555223558423, 'recall': 0.4184546507455417, 'f1-score': 0.41358467749799416, 'support': 113434}, 'weighted avg': {'precision': 0.51589648815751, 'recall': 0.5432674506761641, 'f1-score': 0.5052500181441395, 'support': 113434}}
[[ 8738 15446   726]
 [11223 49707  3331]
 [ 3073 18010  3180]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
7633/7633 - 47s - 47s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0394427
{'0': {'precision': 0.3995614982648969, 'recall': 0.4554416396199154, 'f1-score': 0.4256754995050578, 'support': 519779}, '1': {'precision': 0.5025186131905138, 'recall': 0.543229708643968, 'f1-score': 0.5220817172391516, 'support': 911977}, '2': {'precision': 0.42663766850522816, 'recall': 0.3068923390370563, 'f1-score': 0.35699107238319255, 'support': 522232}, 'accuracy': 0.4567126307838124, 'macro avg': {'precision': 0.4429059266535463, 'recall': 0.4351878957669799, 'f1-score': 0.4349160963758007, 'support': 1953988}, 'weighted avg': {'precision': 0.45485076479850306, 'recall': 0.4567126307838124, 'f1-score': 0.4523138654959337, 'support': 1953988}}
[[236729 231994  51056]
 [252233 495413 164331]
 [103510 258453 160269]]
Evaluating performance on  train set...
1586/1586 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0163602
{'0': {'precision': 0.40008251959840463, 'recall': 0.4775991114974166, 'f1-score': 0.43541769387898854, 'support': 103545}, '1': {'precision': 0.5331443243271057, 'recall': 0.5260979944148261, 'f1-score': 0.5295977224461215, 'support': 196950}, '2': {'precision': 0.43470344576448633, 'recall': 0.3626524896757963, 'f1-score': 0.39542262086527163, 'support': 105335}, 'accuracy': 0.4713007909715891, 'macro avg': {'precision': 0.45597676322999886, 'recall': 0.455449865196013, 'f1-score': 0.4534793457301272, 'support': 405830}, 'weighted avg': {'precision': 0.47364366022137944, 'recall': 0.4713007909715891, 'f1-score': 0.47074252351306434, 'support': 405830}}
[[ 49453  42797  11295]
 [ 54954 103615  38381]
 [ 19200  47935  38200]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0009513
{'0': {'precision': 0.3607716152980433, 'recall': 0.5293010051852496, 'f1-score': 0.4290813451061431, 'support': 34521}, '1': {'precision': 0.5920462228778659, 'recall': 0.5003116559318512, 'f1-score': 0.5423270741251653, 'support': 77008}, '2': {'precision': 0.4329417051874679, 'recall': 0.38157075765291687, 'f1-score': 0.40563625973713496, 'support': 35346}, 'accuracy': 0.47854978723404257, 'macro avg': {'precision': 0.4619198477877924, 'recall': 0.4703944729233392, 'f1-score': 0.4590148929894811, 'support': 146875}, 'weighted avg': {'precision': 0.49939914876349745, 'recall': 0.47854978723404257, 'f1-score': 0.48281504459784624, 'support': 146875}}
[[18272 12061  4188]
 [25003 38528 13477]
 [ 7372 14487 13487]]
testing model on single stock: results/universal/W10/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
22048/22048 - 115s - 115s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.233558
{'0': {'precision': 0.44099224635081813, 'recall': 0.13861118030737918, 'f1-score': 0.21092510141123377, 'support': 2075417}, '1': {'precision': 0.25495957446029854, 'recall': 0.8211575968899264, 'f1-score': 0.3891063111746586, 'support': 1442281}, '2': {'precision': 0.4575020994277436, 'recall': 0.07455663877876381, 'f1-score': 0.12821824478454993, 'support': 2126370}, 'accuracy': 0.2888964130127419, 'macro avg': {'precision': 0.3844846400796201, 'recall': 0.34477513865868975, 'f1-score': 0.24274988579014742, 'support': 5644068}, 'weighted avg': {'precision': 0.3996735854559196, 'recall': 0.2888964130127419, 'f1-score': 0.2252980669165254, 'support': 5644068}}
[[ 287676 1694762   92979]
 [ 162932 1184340   95009]
 [ 201730 1766105  158535]]
Evaluating performance on  train set...
5429/5429 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1803511
{'0': {'precision': 0.3986664187958948, 'recall': 0.31755831248217037, 'f1-score': 0.35351986511335304, 'support': 459207}, '1': {'precision': 0.33120026749650755, 'recall': 0.7031714784699206, 'f1-score': 0.45030344781422743, 'support': 459218}, '2': {'precision': 0.42652095906051213, 'recall': 0.04438117745894423, 'f1-score': 0.08039675722831027, 'support': 471371}, 'accuracy': 0.35232077225722336, 'macro avg': {'precision': 0.3854625484509715, 'recall': 0.35503698947034507, 'f1-score': 0.2947400233852969, 'support': 1389796}, 'weighted avg': {'precision': 0.3858214771150085, 'recall': 0.35232077225722336, 'f1-score': 0.292865244430785, 'support': 1389796}}
[[145825 301743  11639]
 [119820 322909  16489]
 [100137 350314  20920]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.139048
{'0': {'precision': 0.4099920921825576, 'recall': 0.18952439390576653, 'f1-score': 0.259220570510245, 'support': 153194}, '1': {'precision': 0.3537765486334882, 'recall': 0.8139212214449508, 'f1-score': 0.49318624726500115, 'support': 172255}, '2': {'precision': 0.43045317220543805, 'recall': 0.04502648244826758, 'f1-score': 0.08152522200860571, 'support': 158218}, 'accuracy': 0.36463103746999487, 'macro avg': {'precision': 0.398073937673828, 'recall': 0.3494906992663283, 'f1-score': 0.27797734659461726, 'support': 483667}, 'weighted avg': {'precision': 0.3966645397653266, 'recall': 0.36463103746999487, 'f1-score': 0.28441797905818844, 'support': 483667}}
[[ 29034 120496   3664]
 [ 26291 140202   5762]
 [ 15491 135603   7124]]
training model: results/universal/W10/deepLOB_L1/h30
Epoch 1/50
8543/8543 - 137s - loss: 3.0180 - accuracy30: 0.4632 - val_loss: 3.2835 - val_accuracy30: 0.3922 - 137s/epoch - 16ms/step
Epoch 2/50
8543/8543 - 134s - loss: 2.9828 - accuracy30: 0.4752 - val_loss: 3.3200 - val_accuracy30: 0.4155 - 134s/epoch - 16ms/step
Epoch 3/50
8543/8543 - 132s - loss: 2.9575 - accuracy30: 0.4819 - val_loss: 3.5030 - val_accuracy30: 0.4230 - 132s/epoch - 15ms/step
Epoch 4/50
8543/8543 - 134s - loss: 2.9399 - accuracy30: 0.4858 - val_loss: 3.7105 - val_accuracy30: 0.4565 - 134s/epoch - 16ms/step
Epoch 5/50
8543/8543 - 135s - loss: 2.9278 - accuracy30: 0.4888 - val_loss: 3.6483 - val_accuracy30: 0.4418 - 135s/epoch - 16ms/step
Epoch 6/50
8543/8543 - 135s - loss: 2.9205 - accuracy30: 0.4899 - val_loss: 3.7138 - val_accuracy30: 0.4487 - 135s/epoch - 16ms/step
Epoch 7/50
8543/8543 - 133s - loss: 2.9146 - accuracy30: 0.4914 - val_loss: 3.7433 - val_accuracy30: 0.4469 - 133s/epoch - 16ms/step
Epoch 8/50
8543/8543 - 134s - loss: 2.9107 - accuracy30: 0.4922 - val_loss: 3.6045 - val_accuracy30: 0.4564 - 134s/epoch - 16ms/step
Epoch 9/50
8543/8543 - 135s - loss: 2.9055 - accuracy30: 0.4931 - val_loss: 3.6207 - val_accuracy30: 0.4518 - 135s/epoch - 16ms/step
Epoch 10/50
8543/8543 - 134s - loss: 2.9012 - accuracy30: 0.4939 - val_loss: 3.5710 - val_accuracy30: 0.4511 - 134s/epoch - 16ms/step
Epoch 11/50
8543/8543 - 135s - loss: 2.8973 - accuracy30: 0.4951 - val_loss: 3.5334 - val_accuracy30: 0.4573 - 135s/epoch - 16ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 207s - 207s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1380409
{'0': {'precision': 0.3693843111346721, 'recall': 0.1728870674632726, 'f1-score': 0.23553435729590091, 'support': 2946166}, '1': {'precision': 0.34151739055812336, 'recall': 0.5675418919237615, 'f1-score': 0.4264307723321354, 'support': 3604215}, '2': {'precision': 0.3696712575455489, 'recall': 0.2686879486379837, 'f1-score': 0.3111922281317592, 'support': 2994898}, 'accuracy': 0.3519635203957894, 'macro avg': {'precision': 0.36019098641278147, 'recall': 0.3363723026750059, 'f1-score': 0.32438578591993183, 'support': 9545279}, 'weighted avg': {'precision': 0.3589520337843963, 'recall': 0.3519635203957894, 'f1-score': 0.3313533824464902, 'support': 9545279}}
[[ 509354 2008161  428651]
 [ 615236 2045543  943436]
 [ 254337 1935868  804693]]
Evaluating performance on  train set...
8543/8543 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0954206
{'0': {'precision': 0.3565748259390097, 'recall': 0.21099697169527443, 'f1-score': 0.2651160919886975, 'support': 624772}, '1': {'precision': 0.38983925482389625, 'recall': 0.5342981481361139, 'f1-score': 0.45077797144887044, 'support': 923286}, '2': {'precision': 0.3495557493342132, 'recall': 0.3019061725920753, 'f1-score': 0.3239883555342718, 'support': 638662}, 'accuracy': 0.374053834052828, 'macro avg': {'precision': 0.36532327669903975, 'recall': 0.34906709747448783, 'f1-score': 0.3466274729906132, 'support': 2186720}, 'weighted avg': {'precision': 0.3685698522728974, 'recall': 0.374053834052828, 'f1-score': 0.36070148546376923, 'support': 2186720}}
[[131825 389020 103927]
 [175116 493310 254860]
 [ 62757 383089 192816]]
Evaluating performance on  val set...
3077/3077 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0793496
{'0': {'precision': 0.33507676733592034, 'recall': 0.1928726467546215, 'f1-score': 0.2448232397165918, 'support': 205939}, '1': {'precision': 0.437538795945676, 'recall': 0.5509373951988922, 'f1-score': 0.4877335168946218, 'support': 369748}, '2': {'precision': 0.3215613382899628, 'recall': 0.30872969288446245, 'f1-score': 0.3150149004303496, 'support': 211256}, 'accuracy': 0.39221265072565614, 'macro avg': {'precision': 0.3647256338571864, 'recall': 0.35084657827932536, 'f1-score': 0.3491905523471877, 'support': 786943}, 'weighted avg': {'precision': 0.37959068343386787, 'recall': 0.39221265072565614, 'f1-score': 0.3777985614892842, 'support': 786943}}
[[ 39720 131793  34426]
 [ 62861 203708 103179]
 [ 15959 130076  65221]]
testing model out of sample: results/universal/W10/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 118s - 118s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0257066
{'0': {'precision': 0.42255778225539364, 'recall': 0.4216430347666458, 'f1-score': 0.4220999129162801, 'support': 1407067}, '1': {'precision': 0.551358320574771, 'recall': 0.546496425963971, 'f1-score': 0.5489166077198842, 'support': 2650365}, '2': {'precision': 0.3666092220922881, 'recall': 0.3735102792070784, 'f1-score': 0.3700275770687832, 'support': 1403367}, 'accuracy': 0.46987025158772555, 'macro avg': {'precision': 0.4468417749741509, 'recall': 0.44721657997923175, 'f1-score': 0.44701469923498244, 'support': 5460799}, 'weighted avg': {'precision': 0.47069214422557776, 'recall': 0.46987025158772555, 'f1-score': 0.4702675769489354, 'support': 5460799}}
[[ 593280  593710  220077]
 [ 516415 1448415  685535]
 [ 294326  584869  524172]]
Evaluating performance on  train set...
4055/4055 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0187509
{'0': {'precision': 0.39628939958216003, 'recall': 0.4842695738354807, 'f1-score': 0.435884260894698, 'support': 252250}, '1': {'precision': 0.598822562911228, 'recall': 0.456041432365255, 'f1-score': 0.5177689266967394, 'support': 529055}, '2': {'precision': 0.36138257349403496, 'recall': 0.46033375622133305, 'f1-score': 0.404900307986005, 'support': 256175}, 'accuracy': 0.46396460654663224, 'macro avg': {'precision': 0.452164845329141, 'recall': 0.4668815874740229, 'f1-score': 0.45285116519248075, 'support': 1037480}, 'weighted avg': {'precision': 0.4909504306882388, 'recall': 0.46396460654663224, 'f1-score': 0.4699901499041387, 'support': 1037480}}
[[122157  81037  49056]
 [128447 241271 159337]
 [ 57648  80601 117926]]
Evaluating performance on  val set...
1545/1545 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0154239
{'0': {'precision': 0.3827982434943463, 'recall': 0.4838335966298052, 'f1-score': 0.42742637036485687, 'support': 94950}, '1': {'precision': 0.6072480098869543, 'recall': 0.4961318583413765, 'f1-score': 0.5460949438982732, 'support': 202035}, '2': {'precision': 0.3687402119678042, 'recall': 0.41358251633986925, 'f1-score': 0.38987619616073316, 'support': 97920}, 'accuracy': 0.47270609387067775, 'macro avg': {'precision': 0.45292882178303495, 'recall': 0.464515990437017, 'f1-score': 0.4544658368079544, 'support': 394905}, 'weighted avg': {'precision': 0.4941418479208578, 'recall': 0.47270609387067775, 'f1-score': 0.47882681400511456, 'support': 394905}}
[[ 45940  32420  16590]
 [ 49059 100236  52740]
 [ 25012  32410  40498]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1827886
{'0': {'precision': 0.501833568406206, 'recall': 0.24106624336985558, 'f1-score': 0.32568357459495506, 'support': 51658}, '1': {'precision': 0.2659565276423467, 'recall': 0.6538706642794283, 'f1-score': 0.37811704834605603, 'support': 32953}, '2': {'precision': 0.4604152662633505, 'recall': 0.25685951790662304, 'f1-score': 0.3297538013025395, 'support': 47999}, 'accuracy': 0.34936279315285423, 'macro avg': {'precision': 0.40940178743730105, 'recall': 0.383932141851969, 'f1-score': 0.34451814141451687, 'support': 132610}, 'weighted avg': {'precision': 0.42822755672649576, 'recall': 0.34936279315285423, 'f1-score': 0.3401863049490564, 'support': 132610}}
[[12453 30845  8360]
 [ 5317 21547  6089]
 [ 7045 28625 12329]]
Evaluating performance on  train set...
135/135 - 5s - 5s/epoch - 40ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1341147
{'0': {'precision': 0.43246741240639736, 'recall': 0.4085589519650655, 'f1-score': 0.42017335069834283, 'support': 11450}, '1': {'precision': 0.34717131474103585, 'recall': 0.3826293141301484, 'f1-score': 0.36403893553912353, 'support': 11387}, '2': {'precision': 0.41383716684921507, 'recall': 0.39474142434267806, 'f1-score': 0.40406380892968546, 'support': 11486}, 'accuracy': 0.3953325758237916, 'macro avg': {'precision': 0.3978252979988828, 'recall': 0.3953098968126307, 'f1-score': 0.39609203172238394, 'support': 34323}, 'weighted avg': {'precision': 0.3979350677807741, 'recall': 0.3953325758237916, 'f1-score': 0.39615922657828256, 'support': 34323}}
[[4678 4142 2630]
 [3238 4357 3792]
 [2901 4051 4534]]
Evaluating performance on  val set...
46/46 - 0s - 467ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1375325
{'0': {'precision': 0.43699806147881476, 'recall': 0.3940074906367041, 'f1-score': 0.414390756302521, 'support': 4005}, '1': {'precision': 0.3588850174216028, 'recall': 0.48699763593380613, 'f1-score': 0.41323971915747243, 'support': 3807}, '2': {'precision': 0.4244406196213425, 'recall': 0.3186046511627907, 'f1-score': 0.3639852398523985, 'support': 3870}, 'accuracy': 0.39933230611196713, 'macro avg': {'precision': 0.40677456617392, 'recall': 0.3998699259111003, 'f1-score': 0.397205238437464, 'support': 11682}, 'weighted avg': {'precision': 0.4073821002808843, 'recall': 0.39933230611196713, 'f1-score': 0.3973173658665362, 'support': 11682}}
[[1578 1670  757]
 [1038 1854  915]
 [ 995 1642 1233]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
1840/1840 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9623139
{'0': {'precision': 0.2894679813630946, 'recall': 0.5555043963878327, 'f1-score': 0.380605900251356, 'support': 67328}, '1': {'precision': 0.7951876937783396, 'recall': 0.37575296505528927, 'f1-score': 0.5103488916514636, 'support': 336503}, '2': {'precision': 0.23589345123445982, 'recall': 0.6421294089609152, 'f1-score': 0.3450345754898195, 'support': 67136}, 'accuracy': 0.4394214456639213, 'macro avg': {'precision': 0.44018304212529796, 'recall': 0.5244622568013457, 'f1-score': 0.41199645579754635, 'support': 470967}, 'weighted avg': {'precision': 0.6431645688780397, 'recall': 0.4394214456639213, 'f1-score': 0.46823579656239245, 'support': 470967}}
[[ 37401  17228  12699]
 [ 83118 126442 126943]
 [  8687  15339  43110]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9526072
{'0': {'precision': 0.20053523245012606, 'recall': 0.6978372970060802, 'f1-score': 0.3115432851718865, 'support': 12993}, '1': {'precision': 0.8811136913169424, 'recall': 0.33744384340331895, 'f1-score': 0.48799729516510765, 'support': 109070}, '2': {'precision': 0.18624008592200925, 'recall': 0.6760383865647024, 'f1-score': 0.29202966609450404, 'support': 13338}, 'accuracy': 0.4053810533157067, 'macro avg': {'precision': 0.42262966989635925, 'recall': 0.5704398423247005, 'f1-score': 0.3638567488104994, 'support': 135401}, 'weighted avg': {'precision': 0.7473555945169619, 'recall': 0.4053810533157067, 'f1-score': 0.45176061162225617, 'support': 135401}}
[[ 9067  2398  1528]
 [34394 36805 37871]
 [ 1753  2568  9017]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9989201
{'0': {'precision': 0.2429078014184397, 'recall': 0.7160645657186779, 'f1-score': 0.36275845956154357, 'support': 6505}, '1': {'precision': 0.8540540540540541, 'recall': 0.24623582937435587, 'f1-score': 0.38226055060191594, 'support': 39783}, '2': {'precision': 0.20814761989659475, 'recall': 0.6873712098910804, 'f1-score': 0.31953472459801574, 'support': 6794}, 'accuracy': 0.36027278550167663, 'macro avg': {'precision': 0.4350364917896962, 'recall': 0.5498905349947046, 'f1-score': 0.35485124492049175, 'support': 53082}, 'weighted avg': {'precision': 0.6964903848806913, 'recall': 0.36027278550167663, 'f1-score': 0.3718423228771106, 'support': 53082}}
[[ 4658   876   971]
 [13192  9796 16795]
 [ 1326   798  4670]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1683738
{'0': {'precision': 0.41582628497072216, 'recall': 0.3519854974356621, 'f1-score': 0.3812518252937558, 'support': 87157}, '1': {'precision': 0.3038874690136244, 'recall': 0.4136325591127851, 'f1-score': 0.350367227570316, 'support': 76464}, '2': {'precision': 0.3935997703953505, 'recall': 0.32684287042112536, 'f1-score': 0.35712844150179357, 'support': 83918}, 'accuracy': 0.3625044942413115, 'macro avg': {'precision': 0.37110450812656565, 'recall': 0.36415364232319086, 'f1-score': 0.36291583145528844, 'support': 247539}, 'weighted avg': {'precision': 0.3737137521032566, 'recall': 0.3625044942413115, 'f1-score': 0.36353362330789096, 'support': 247539}}
[[30678 37089 19390]
 [21969 31628 22867]
 [21129 35361 27428]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1446255
{'0': {'precision': 0.39882645803698435, 'recall': 0.48377008519357273, 'f1-score': 0.4372106622484284, 'support': 18546}, '1': {'precision': 0.3314366998577525, 'recall': 0.25125357200625437, 'f1-score': 0.2858281963995461, 'support': 18547}, '2': {'precision': 0.4146836470647927, 'recall': 0.4262987690381807, 'f1-score': 0.4204109976595252, 'support': 19172}, 'accuracy': 0.38754110015107085, 'macro avg': {'precision': 0.3816489349865098, 'recall': 0.38710747541266927, 'f1-score': 0.3811499521024999, 'support': 56265}, 'weighted avg': {'precision': 0.3820155841916263, 'recall': 0.38754110015107085, 'f1-score': 0.38158507327486274, 'support': 56265}}
[[8972 4637 4937]
 [7288 4660 6599]
 [6236 4763 8173]]
Evaluating performance on  val set...
79/79 - 1s - 587ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.144251
{'0': {'precision': 0.40671641791044777, 'recall': 0.5191974595842956, 'f1-score': 0.4561247780877505, 'support': 6928}, '1': {'precision': 0.33460166468489894, 'recall': 0.22195929957406532, 'f1-score': 0.2668816388467375, 'support': 6339}, '2': {'precision': 0.4120768789443488, 'recall': 0.42537755404204913, 'f1-score': 0.4186215940550779, 'support': 6754}, 'accuracy': 0.39343689126417264, 'macro avg': {'precision': 0.38446498717989847, 'recall': 0.3888447710668033, 'f1-score': 0.3805426703298553, 'support': 20021}, 'weighted avg': {'precision': 0.3856919502577938, 'recall': 0.39343689126417264, 'f1-score': 0.38355553756003197, 'support': 20021}}
[[3597 1430 1901]
 [2734 1407 2198]
 [2513 1368 2873]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1845665
{'0': {'precision': 0.38215929934526194, 'recall': 0.4444169768542389, 'f1-score': 0.41094351575791815, 'support': 141581}, '1': {'precision': 0.3155170504871568, 'recall': 0.2765718260194426, 'f1-score': 0.294763608154118, 'support': 123646}, '2': {'precision': 0.4022633127213784, 'recall': 0.3800112009868211, 'f1-score': 0.3908207717405173, 'support': 141059}, 'accuracy': 0.3709751258965359, 'macro avg': {'precision': 0.36664655418459907, 'recall': 0.3670000012868342, 'f1-score': 0.3655092985508512, 'support': 406286}, 'weighted avg': {'precision': 0.36885784303249786, 'recall': 0.3709751258965359, 'f1-score': 0.3685997603641069, 'support': 406286}}
[[62921 37703 40957]
 [50754 34197 38695]
 [50971 36484 53604]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1942967
{'0': {'precision': 0.388901718847943, 'recall': 0.4488956587966489, 'f1-score': 0.4167506319492319, 'support': 26260}, '1': {'precision': 0.31269234356057074, 'recall': 0.134783133014431, 'f1-score': 0.18837078651685396, 'support': 24877}, '2': {'precision': 0.3492280009287207, 'recall': 0.4941075021557919, 'f1-score': 0.40922307810029074, 'support': 24353}, 'accuracy': 0.3599682077096304, 'macro avg': {'precision': 0.3502740211124115, 'recall': 0.3592620979889573, 'f1-score': 0.3381148321887922, 'support': 75490}, 'weighted avg': {'precision': 0.3509889531636036, 'recall': 0.3599682077096304, 'f1-score': 0.3390618793501522, 'support': 75490}}
[[11788  4022 10450]
 [ 9551  3353 11973]
 [ 8972  3348 12033]]
Evaluating performance on  val set...
131/131 - 1s - 891ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1815346
{'0': {'precision': 0.35251500724487683, 'recall': 0.45001321236677533, 'f1-score': 0.3953416389383271, 'support': 11353}, '1': {'precision': 0.3155844155844156, 'recall': 0.14967003959524858, 'f1-score': 0.20304386750223816, 'support': 11365}, '2': {'precision': 0.37762601143196495, 'recall': 0.47828130876269276, 'f1-score': 0.4220350935412951, 'support': 10636}, 'accuracy': 0.35668885291119506, 'macro avg': {'precision': 0.34857514475375245, 'recall': 0.3593215202415722, 'f1-score': 0.34014019999395345, 'support': 33354}, 'weighted avg': {'precision': 0.3479387784960829, 'recall': 0.35668885291119506, 'f1-score': 0.3383304082249499, 'support': 33354}}
[[5109 1951 4293]
 [5573 1701 4091]
 [3811 1738 5087]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
2104/2104 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1895409
{'0': {'precision': 0.4616463985032741, 'recall': 0.38218599775223594, 'f1-score': 0.4181749603443197, 'support': 211766}, '1': {'precision': 0.2296875, 'recall': 0.4271507941918331, 'f1-score': 0.29873775298576843, 'support': 117352}, '2': {'precision': 0.4707975587048722, 'recall': 0.3259502585428971, 'f1-score': 0.3852074211167788, 'support': 209443}, 'accuracy': 0.3701140632166087, 'macro avg': {'precision': 0.3873771524027154, 'recall': 0.3784290168289887, 'f1-score': 0.36737337814895565, 'support': 538561}, 'weighted avg': {'precision': 0.4146615737368077, 'recall': 0.3701140632166087, 'f1-score': 0.3793288213250172, 'support': 538561}}
[[80934 83849 46983]
 [37471 50127 29754]
 [56911 84264 68268]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1506482
{'0': {'precision': 0.4077195257002404, 'recall': 0.4172886603637972, 'f1-score': 0.41244859762012104, 'support': 36174}, '1': {'precision': 0.33715453152488506, 'recall': 0.32719262012942313, 'f1-score': 0.3320988862026077, 'support': 36315}, '2': {'precision': 0.4134142738187972, 'recall': 0.41591676800432376, 'f1-score': 0.41466174529191474, 'support': 37005}, 'accuracy': 0.38694357681699454, 'macro avg': {'precision': 0.38609611034797425, 'recall': 0.3867993494991813, 'f1-score': 0.3864030763715478, 'support': 109494}, 'weighted avg': {'precision': 0.38624041625724964, 'recall': 0.38694357681699454, 'f1-score': 0.38654761454769454, 'support': 109494}}
[[15095 11609  9470]
 [12065 11882 12368]
 [ 9863 11751 15391]]
Evaluating performance on  val set...
141/141 - 1s - 968ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1458049
{'0': {'precision': 0.4094762008259074, 'recall': 0.4740020127474002, 'f1-score': 0.43938274964045554, 'support': 11924}, '1': {'precision': 0.31353846153846154, 'recall': 0.2646753246753247, 'f1-score': 0.2870422535211268, 'support': 11550}, '2': {'precision': 0.4145631067961165, 'recall': 0.41193021947101854, 'f1-score': 0.4132424694544135, 'support': 12439}, 'accuracy': 0.3851808537298471, 'macro avg': {'precision': 0.3791925897201618, 'recall': 0.3835358522979145, 'f1-score': 0.3798891575386653, 'support': 35913}, 'weighted avg': {'precision': 0.38038353618060994, 'recall': 0.3851808537298471, 'f1-score': 0.38133436394690656, 'support': 35913}}
[[5652 3241 3031]
 [4288 3057 4205]
 [3863 3452 5124]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
5267/5267 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98881304
{'0': {'precision': 0.31856776658944247, 'recall': 0.6937634550781169, 'f1-score': 0.43663708022667047, 'support': 242009}, '1': {'precision': 0.7557136877354542, 'recall': 0.2510769230769231, 'f1-score': 0.3769249840155539, 'support': 862875}, '2': {'precision': 0.29522220060171533, 'recall': 0.6485193481432769, 'f1-score': 0.4057409771695486, 'support': 243305}, 'accuracy': 0.40226778292954474, 'macro avg': {'precision': 0.45650121830887064, 'recall': 0.5311199087661057, 'f1-score': 0.4064343471372576, 'support': 1348189}, 'weighted avg': {'precision': 0.5941390654030517, 'recall': 0.40226778292954474, 'f1-score': 0.39284407244179737, 'support': 1348189}}
[[167897  37419  36693]
 [306236 216648 339991]
 [ 52904  32613 157788]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9636807
{'0': {'precision': 0.2811047777181561, 'recall': 0.7387648670941649, 'f1-score': 0.4072487789137099, 'support': 37583}, '1': {'precision': 0.8399931826280969, 'recall': 0.2774002742585808, 'f1-score': 0.41706766367794074, 'support': 195436}, '2': {'precision': 0.2573482413317153, 'recall': 0.7264146009831608, 'f1-score': 0.3800540374157803, 'support': 38244}, 'accuracy': 0.4046257690875645, 'macro avg': {'precision': 0.45948206722598944, 'recall': 0.5808599141119689, 'f1-score': 0.4014568266691437, 'support': 271263}, 'weighted avg': {'precision': 0.6804160340428894, 'recall': 0.4046257690875645, 'f1-score': 0.4104889107007041, 'support': 271263}}
[[27765  5363  4455]
 [65507 54214 75715]
 [ 5499  4964 27781]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98738295
{'0': {'precision': 0.2765177054397368, 'recall': 0.7538416292919639, 'f1-score': 0.40461720599842155, 'support': 13601}, '1': {'precision': 0.85302450420001, 'recall': 0.22564062109678013, 'f1-score': 0.3568799517561189, 'support': 76059}, '2': {'precision': 0.22052458448753462, 'recall': 0.741306561908919, 'f1-score': 0.3399272775794776, 'support': 13746}, 'accuracy': 0.3636636171982283, 'macro avg': {'precision': 0.45002226470909373, 'recall': 0.5735962707658876, 'f1-score': 0.36714147844467265, 'support': 103406}, 'weighted avg': {'precision': 0.693116830889891, 'recall': 0.3636636171982283, 'f1-score': 0.3609052784849107, 'support': 103406}}
[[10253  1632  1716]
 [24595 17162 34302]
 [ 2231  1325 10190]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
10110/10110 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.931348
{'0': {'precision': 0.4249764123566511, 'recall': 0.3010599425223132, 'f1-score': 0.3524434373503552, 'support': 474271}, '1': {'precision': 0.6649626665669447, 'recall': 0.6521067593428483, 'f1-score': 0.658471969736011, 'support': 1636091}, '2': {'precision': 0.3025939536176389, 'recall': 0.41021980621217863, 'f1-score': 0.34828180938493813, 'support': 477739}, 'accuracy': 0.5431271808944087, 'macro avg': {'precision': 0.46417767751374495, 'recall': 0.4544621693591134, 'f1-score': 0.45306573882376816, 'support': 2588101}, 'weighted avg': {'precision': 0.5540952053178441, 'recall': 0.5431271808944087, 'f1-score': 0.5451338909287934, 'support': 2588101}}
[[ 142784  281568   49919]
 [ 167422 1066906  401763]
 [  25775  255986  195978]]
Evaluating performance on  train set...
1686/1686 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9193065
{'0': {'precision': 0.34750049702887187, 'recall': 0.4524302559677883, 'f1-score': 0.3930833718562201, 'support': 69540}, '1': {'precision': 0.7442013735801717, 'recall': 0.5591848444175777, 'f1-score': 0.638561500120902, 'support': 292803}, '2': {'precision': 0.2878426058287405, 'recall': 0.5032141567352835, 'f1-score': 0.3662100648633874, 'support': 69225}, 'accuracy': 0.5330052274496719, 'macro avg': {'precision': 0.45984815881259467, 'recall': 0.5049430857068832, 'f1-score': 0.46595164561350316, 'support': 431568}, 'weighted avg': {'precision': 0.6070781052818497, 'recall': 0.5330052274496719, 'f1-score': 0.5553206733097681, 'support': 431568}}
[[ 31462  29568   8510]
 [ 51396 163731  77676]
 [  7680  26710  34835]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94120294
{'0': {'precision': 0.3427255679255584, 'recall': 0.4378734115791708, 'f1-score': 0.38450066577896136, 'support': 32973}, '1': {'precision': 0.6900513534685351, 'recall': 0.6318809776833156, 'f1-score': 0.6596862995270917, 'support': 112920}, '2': {'precision': 0.3215616579716792, 'recall': 0.3249616175661192, 'f1-score': 0.32325269785468325, 'support': 34521}, 'accuracy': 0.5376966310818451, 'macro avg': {'precision': 0.45144619312192424, 'recall': 0.4649053356095352, 'f1-score': 0.4558132210535788, 'support': 180414}, 'weighted avg': {'precision': 0.5560650447288833, 'recall': 0.5376966310818451, 'f1-score': 0.5450182567759176, 'support': 180414}}
[[14438 16028  2507]
 [20407 71352 21161]
 [ 7282 16021 11218]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0249165
{'0': {'precision': 0.5338208409506399, 'recall': 0.07952436487908159, 'f1-score': 0.13842698347462892, 'support': 455307}, '1': {'precision': 0.4942340589079502, 'recall': 0.7216984865806169, 'f1-score': 0.5866903943872056, 'support': 770639}, '2': {'precision': 0.412611421680556, 'recall': 0.44270079564628756, 'f1-score': 0.42712684554329516, 'support': 449823}, 'accuracy': 0.47232882336407944, 'macro avg': {'precision': 0.4802221071797154, 'recall': 0.41464121570199536, 'f1-score': 0.38408140780170985, 'support': 1675769}, 'weighted avg': {'precision': 0.4830800152575263, 'recall': 0.47232882336407944, 'f1-score': 0.42206578141012646, 'support': 1675769}}
[[ 36208 325844  93255]
 [ 24236 556169 190234]
 [  7384 243302 199137]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0294476
{'0': {'precision': 0.43900289984385454, 'recall': 0.43640375191254405, 'f1-score': 0.437699467345736, 'support': 90194}, '1': {'precision': 0.49199000832639467, 'recall': 0.5452169869121348, 'f1-score': 0.5172377570957373, 'support': 135469}, '2': {'precision': 0.4120690804827632, 'recall': 0.34676288058177246, 'f1-score': 0.3766058064987934, 'support': 89107}, 'accuracy': 0.45785811862629855, 'macro avg': {'precision': 0.44768732955100415, 'recall': 0.44279453980215044, 'f1-score': 0.4438476769800889, 'support': 314770}, 'weighted avg': {'precision': 0.45418261442025143, 'recall': 0.45785811862629855, 'f1-score': 0.4546359598229556, 'support': 314770}}
[[39361 38146 12687]
 [30210 73860 31399]
 [20089 38119 30899]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9962758
{'0': {'precision': 0.42102557511887934, 'recall': 0.3438648052902278, 'f1-score': 0.37855327016408596, 'support': 28581}, '1': {'precision': 0.527502056484782, 'recall': 0.6764654172087626, 'f1-score': 0.5927683372105563, 'support': 56878}, '2': {'precision': 0.37525508716692907, 'recall': 0.23006255585344057, 'f1-score': 0.2852457563267296, 'support': 27975}, 'accuracy': 0.4825713630833789, 'macro avg': {'precision': 0.4412609062568635, 'recall': 0.41679759278414363, 'f1-score': 0.4188557879004573, 'support': 113434}, 'weighted avg': {'precision': 0.4631270606229963, 'recall': 0.4825713630833789, 'f1-score': 0.46295342253347344, 'support': 113434}}
[[ 9828 16460  2293]
 [ 9980 38476  8422]
 [ 3535 18004  6436]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
7633/7633 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0767819
{'0': {'precision': 0.41100511558243447, 'recall': 0.5604046615082058, 'f1-score': 0.47421631552020843, 'support': 582215}, '1': {'precision': 0.44956833765587806, 'recall': 0.3535063269439559, 'f1-score': 0.3957919699389866, 'support': 787505}, '2': {'precision': 0.4072415673731986, 'recall': 0.37701705381776857, 'f1-score': 0.39154689989894886, 'support': 584268}, 'accuracy': 0.42218427134659986, 'macro avg': {'precision': 0.4226050068705037, 'recall': 0.4303093474233101, 'f1-score': 0.4205183951193813, 'support': 1953988}, 'weighted avg': {'precision': 0.42542168795331564, 'recall': 0.42218427134659986, 'f1-score': 0.4178901464786676, 'support': 1953988}}
[[326276 160223  95716]
 [284207 278388 224910]
 [183366 180623 220279]]
Evaluating performance on  train set...
1586/1586 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.06188
{'0': {'precision': 0.419796840799897, 'recall': 0.5315685601510212, 'f1-score': 0.469116917636279, 'support': 116540}, '1': {'precision': 0.4688614744351962, 'recall': 0.3339999882355017, 'f1-score': 0.390103982384484, 'support': 170003}, '2': {'precision': 0.4014815138855472, 'recall': 0.4616261621132227, 'f1-score': 0.42945828328991903, 'support': 119287}, 'accuracy': 0.42824828130005177, 'macro avg': {'precision': 0.4300466097068802, 'recall': 0.4423982368332486, 'f1-score': 0.4295597277702274, 'support': 405830}, 'weighted avg': {'precision': 0.43496662743535947, 'recall': 0.42824828130005177, 'f1-score': 0.4243612427308133, 'support': 405830}}
[[61949 31174 23417]
 [54548 56781 58674]
 [31072 33149 55066]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0476315
{'0': {'precision': 0.39891818796484113, 'recall': 0.5278629856850716, 'f1-score': 0.4544204214116741, 'support': 39120}, '1': {'precision': 0.5312264328808446, 'recall': 0.3343419510820392, 'f1-score': 0.4103922586048374, 'support': 67419}, '2': {'precision': 0.3793424199855727, 'recall': 0.4954135263784213, 'f1-score': 0.42967725288666225, 'support': 40336}, 'accuracy': 0.4301208510638298, 'macro avg': {'precision': 0.43649568027708613, 'recall': 0.4525394877151774, 'f1-score': 0.43149664430105794, 'support': 146875}, 'weighted avg': {'precision': 0.4542746569812174, 'recall': 0.4301208510638298, 'f1-score': 0.4274153139808724, 'support': 146875}}
[[20650 10046  8424]
 [20607 22541 24271]
 [10508  9845 19983]]
testing model on single stock: results/universal/W10/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
22048/22048 - 114s - 114s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2185609
{'0': {'precision': 0.41791382711163966, 'recall': 0.10043476747611818, 'f1-score': 0.16194923065005445, 'support': 2039941}, '1': {'precision': 0.2580437774525517, 'recall': 0.7362944142273817, 'f1-score': 0.3821560783931049, 'support': 1510552}, '2': {'precision': 0.4160743050789598, 'recall': 0.16766726771192816, 'f1-score': 0.23901687030510357, 'support': 2093575}, 'accuracy': 0.29555207343355894, 'macro avg': {'precision': 0.364010636547717, 'recall': 0.33479881647180937, 'f1-score': 0.26104072644942095, 'support': 5644068}, 'weighted avg': {'precision': 0.3744446129575575, 'recall': 0.29555207343355894, 'f1-score': 0.24947134731533555, 'support': 5644068}}
[[ 204881 1590071  244989]
 [ 150697 1112211  247644]
 [ 134669 1607882  351024]]
Evaluating performance on  train set...
5429/5429 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1446111
{'0': {'precision': 0.41511291146907947, 'recall': 0.09581816831315457, 'f1-score': 0.15569755058572948, 'support': 457742}, '1': {'precision': 0.32591972306138967, 'recall': 0.7097641099918418, 'f1-score': 0.44671185314440504, 'support': 458434}, '2': {'precision': 0.39587605058188763, 'recall': 0.238881381698408, 'f1-score': 0.2979639564190284, 'support': 473620}, 'accuracy': 0.34708619106689037, 'macro avg': {'precision': 0.37896956170411894, 'recall': 0.3481545533344681, 'f1-score': 0.3001244533830543, 'support': 1389796}, 'weighted avg': {'precision': 0.37913629893897965, 'recall': 0.34708619106689037, 'f1-score': 0.3001727583931709, 'support': 1389796}}
[[ 43860 338892  74990]
 [ 35389 325380  97665]
 [ 26409 334072 113139]]
Evaluating performance on  val set...
1890/1890 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1203609
{'0': {'precision': 0.40058337384540593, 'recall': 0.06777291139761067, 'f1-score': 0.11593183377007087, 'support': 145899}, '1': {'precision': 0.38338521466487285, 'recall': 0.73367337595536, 'f1-score': 0.5036074689302925, 'support': 185663}, '2': {'precision': 0.3760524666055842, 'recall': 0.25634265803228035, 'f1-score': 0.3048672739356504, 'support': 152105}, 'accuracy': 0.3826909836726508, 'macro avg': {'precision': 0.386673685038621, 'recall': 0.352596315128417, 'f1-score': 0.3081355255453379, 'support': 483667}, 'weighted avg': {'precision': 0.386267045723685, 'recall': 0.3826909836726508, 'f1-score': 0.324164040178897, 'support': 483667}}
[[  9888 110985  25026]
 [  9779 136216  39668]
 [  5017 108097  38991]]
training model: results/universal/W10/deepOF_L1/h10
Epoch 1/50
8543/8543 - 129s - loss: 2.9354 - accuracy10: 0.5078 - val_loss: 3.2679 - val_accuracy10: 0.4998 - 129s/epoch - 15ms/step
Epoch 2/50
8543/8543 - 120s - loss: 2.9200 - accuracy10: 0.5089 - val_loss: 3.2593 - val_accuracy10: 0.4992 - 120s/epoch - 14ms/step
Epoch 3/50
8543/8543 - 122s - loss: 2.9096 - accuracy10: 0.5110 - val_loss: 3.2529 - val_accuracy10: 0.4999 - 122s/epoch - 14ms/step
Epoch 4/50
8543/8543 - 118s - loss: 2.8998 - accuracy10: 0.5125 - val_loss: 3.2596 - val_accuracy10: 0.4992 - 118s/epoch - 14ms/step
Epoch 5/50
8543/8543 - 122s - loss: 2.8931 - accuracy10: 0.5143 - val_loss: 3.2713 - val_accuracy10: 0.5005 - 122s/epoch - 14ms/step
Epoch 6/50
8543/8543 - 120s - loss: 2.8860 - accuracy10: 0.5156 - val_loss: 3.2736 - val_accuracy10: 0.5001 - 120s/epoch - 14ms/step
Epoch 7/50
8543/8543 - 120s - loss: 2.8810 - accuracy10: 0.5166 - val_loss: 3.2819 - val_accuracy10: 0.4996 - 120s/epoch - 14ms/step
Epoch 8/50
8543/8543 - 119s - loss: 2.8764 - accuracy10: 0.5172 - val_loss: 3.2973 - val_accuracy10: 0.4997 - 119s/epoch - 14ms/step
Epoch 9/50
8543/8543 - 118s - loss: 2.8718 - accuracy10: 0.5175 - val_loss: 3.3040 - val_accuracy10: 0.4996 - 118s/epoch - 14ms/step
Epoch 10/50
8543/8543 - 120s - loss: 2.8684 - accuracy10: 0.5178 - val_loss: 3.3137 - val_accuracy10: 0.4995 - 120s/epoch - 14ms/step
Epoch 11/50
8543/8543 - 121s - loss: 2.8642 - accuracy10: 0.5187 - val_loss: 3.3255 - val_accuracy10: 0.4998 - 121s/epoch - 14ms/step
Epoch 12/50
8543/8543 - 119s - loss: 2.8614 - accuracy10: 0.5187 - val_loss: 3.3287 - val_accuracy10: 0.4999 - 119s/epoch - 14ms/step
Epoch 13/50
8543/8543 - 119s - loss: 2.8578 - accuracy10: 0.5196 - val_loss: 3.3444 - val_accuracy10: 0.4998 - 119s/epoch - 14ms/step
testing model in sample: results/universal/W10/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 190s - 190s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0859302
{'0': {'precision': 0.4356868804776302, 'recall': 0.06534131776051956, 'f1-score': 0.11363973126257737, 'support': 2787593}, '1': {'precision': 0.41323273174754943, 'recall': 0.9171469903225274, 'f1-score': 0.5697548601166337, 'support': 3943695}, '2': {'precision': 0.40469684464139283, 'recall': 0.053842157296854334, 'f1-score': 0.0950399031472441, 'support': 2813966}, 'accuracy': 0.41388139068902724, 'macro avg': {'precision': 0.4178721522888575, 'recall': 0.3454434884599671, 'f1-score': 0.2594781648421517, 'support': 9545254}, 'weighted avg': {'precision': 0.41727383235360654, 'recall': 0.41388139068902724, 'f1-score': 0.29660392154643006, 'support': 9545254}}
[[ 182145 2546164   59284]
 [ 163162 3616948  163585]
 [  72757 2589699  151510]]
Evaluating performance on  train set...
8543/8543 - 43s - 43s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0469689
{'0': {'precision': 0.4363492601378064, 'recall': 0.06664734359526446, 'f1-score': 0.11563306333327346, 'support': 579618}, '1': {'precision': 0.47111340164534155, 'recall': 0.9350997859250356, 'f1-score': 0.6265593935811763, 'support': 1022539}, '2': {'precision': 0.4296005716535663, 'recall': 0.050395600071849525, 'f1-score': 0.09020896363346849, 'support': 584555}, 'accuracy': 0.4684041611332448, 'macro avg': {'precision': 0.44568774447890475, 'recall': 0.35071424319738315, 'f1-score': 0.27746714018263946, 'support': 2186712}, 'weighted avg': {'precision': 0.45080141977111365, 'recall': 0.4684041611332448, 'f1-score': 0.3477533947739665, 'support': 2186712}}
[[ 38630 531162   9826]
 [ 37075 956176  29288]
 [ 12825 542271  29459]]
Evaluating performance on  val set...
3077/3077 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0243177
{'0': {'precision': 0.423296408190668, 'recall': 0.0708506573772334, 'f1-score': 0.12138422293882659, 'support': 195778}, '1': {'precision': 0.5059506060535273, 'recall': 0.9342025808481379, 'f1-score': 0.656402896935933, 'support': 394134}, '2': {'precision': 0.42385834815179146, 'recall': 0.05685965010226921, 'f1-score': 0.1002685044303231, 'support': 197029}, 'accuracy': 0.4997515696856562, 'macro avg': {'precision': 0.45103512079866226, 'recall': 0.3539709627758801, 'f1-score': 0.29268520810169424, 'support': 786941}, 'weighted avg': {'precision': 0.46483389078349313, 'recall': 0.4997515696856562, 'f1-score': 0.38405784288640027, 'support': 786941}}
[[ 13871 178269   3638]
 [ 14343 368201  11590]
 [  4555 181271  11203]]
testing model out of sample: results/universal/W10/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 113s - 113s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95630383
{'0': {'precision': 0.3871929118002416, 'recall': 0.12504343205183233, 'f1-score': 0.18903746732827065, 'support': 1076394}, '1': {'precision': 0.6254430500007917, 'recall': 0.906478880384535, 'f1-score': 0.7401825177427943, 'support': 3311637}, '2': {'precision': 0.3967556703990813, 'recall': 0.11593736803689234, 'f1-score': 0.1794399561972078, 'support': 1072743}, 'accuracy': 0.5971490488344693, 'macro avg': {'precision': 0.4697972107333716, 'recall': 0.3824865601577532, 'f1-score': 0.3695533137560909, 'support': 5460774}, 'weighted avg': {'precision': 0.5335561114616175, 'recall': 0.5971490488344693, 'f1-score': 0.5213890128118106, 'support': 5460774}}
[[ 134596  899147   42651]
 [ 163260 3001929  146448]
 [  49764  898608  124371]]
Evaluating performance on  train set...
4055/4055 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9412801
{'0': {'precision': 0.3897144740390089, 'recall': 0.13546939115582496, 'f1-score': 0.20105104524904363, 'support': 192036}, '1': {'precision': 0.6472871178205265, 'recall': 0.910953896439016, 'f1-score': 0.7568132486534286, 'support': 651056}, '2': {'precision': 0.40153142731228997, 'recall': 0.11249672032472643, 'f1-score': 0.175752899476768, 'support': 194379}, 'accuracy': 0.617813895520935, 'macro avg': {'precision': 0.4795110063906085, 'recall': 0.38630666930652247, 'f1-score': 0.3778723977930801, 'support': 1037471}, 'weighted avg': {'precision': 0.5535659770980118, 'recall': 0.617813895520935, 'f1-score': 0.5450750120130072, 'support': 1037471}}
[[ 26015 159175   6846]
 [ 32228 593082  25746]
 [  8511 164001  21867]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9387449
{'0': {'precision': 0.3978069616218284, 'recall': 0.1306532663316583, 'f1-score': 0.19670270781451946, 'support': 71640}, '1': {'precision': 0.6527517318741919, 'recall': 0.9138159077740704, 'f1-score': 0.761531007429262, 'support': 250255}, '2': {'precision': 0.3867256216421813, 'recall': 0.11140939597315436, 'f1-score': 0.17298469848898906, 'support': 73010}, 'accuracy': 0.6233929679289956, 'macro avg': {'precision': 0.47909477171273385, 'recall': 0.38529285669296104, 'f1-score': 0.3770728045775902, 'support': 394905}, 'weighted avg': {'precision': 0.5573191350498458, 'recall': 0.6233929679289956, 'f1-score': 0.5502547121174035, 'support': 394905}}
[[  9360  59621   2659]
 [ 11328 228687  10240]
 [  2841  62035   8134]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1938021
{'0': {'precision': 0.4300869120654397, 'recall': 0.06616721724083688, 'f1-score': 0.1146898432174506, 'support': 50856}, '1': {'precision': 0.2723952006124045, 'recall': 0.9366005779189197, 'f1-score': 0.4220453153704838, 'support': 34953}, '2': {'precision': 0.4218308327897369, 'recall': 0.04145653474655953, 'f1-score': 0.07549372507053215, 'support': 46796}, 'accuracy': 0.28688209343539084, 'macro avg': {'precision': 0.37477098182252705, 'recall': 0.3480747766354388, 'f1-score': 0.2040762945528222, 'support': 132605}, 'weighted avg': {'precision': 0.3856078209587414, 'recall': 0.28688209343539084, 'f1-score': 0.18187263627473935, 'support': 132605}}
[[ 3365 45632  1859]
 [ 1416 32737   800]
 [ 3043 41813  1940]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.157524
{'0': {'precision': 0.4297159504734159, 'recall': 0.052697391925687745, 'f1-score': 0.0938817726151643, 'support': 11196}, '1': {'precision': 0.3437911364633611, 'recall': 0.9533286980705719, 'f1-score': 0.5053441444761817, 'support': 11506}, '2': {'precision': 0.381957773512476, 'recall': 0.03425423874688011, 'f1-score': 0.06287023141931918, 'support': 11619}, 'accuracy': 0.34838728475277525, 'macro avg': {'precision': 0.3851549534830843, 'recall': 0.3467601095810466, 'f1-score': 0.22069871617022171, 'support': 34321}, 'weighted avg': {'precision': 0.38474193549399077, 'recall': 0.34838728475277525, 'f1-score': 0.2213245322514902, 'support': 34321}}
[[  590 10211   395]
 [  288 10969   249]
 [  495 10726   398]]
Evaluating performance on  val set...
46/46 - 0s - 413ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1416912
{'0': {'precision': 0.47326732673267324, 'recall': 0.06316067653276955, 'f1-score': 0.11144788995103752, 'support': 3784}, '1': {'precision': 0.35945517305718816, 'recall': 0.9443627450980392, 'f1-score': 0.5207108588418136, 'support': 4080}, '2': {'precision': 0.4366812227074236, 'recall': 0.05238344683080147, 'f1-score': 0.09354536950420954, 'support': 3818}, 'accuracy': 0.36740284197911316, 'macro avg': {'precision': 0.4231345741657617, 'recall': 0.3533022894872034, 'f1-score': 0.24190137276568688, 'support': 11682}, 'weighted avg': {'precision': 0.4215604843970815, 'recall': 0.36740284197911316, 'f1-score': 0.2485340986488955, 'support': 11682}}
[[ 239 3415  130]
 [  99 3853  128]
 [ 167 3451  200]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
1840/1840 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.809619
{'0': {'precision': 0.334202580290969, 'recall': 0.12086466631921178, 'f1-score': 0.1775266563382849, 'support': 40293}, '1': {'precision': 0.8444316360164988, 'recall': 0.9609133206255508, 'f1-score': 0.898914752463857, 'support': 390312}, '2': {'precision': 0.34164079097891814, 'recall': 0.10360036672696186, 'f1-score': 0.15898849700541876, 'support': 40357}, 'accuracy': 0.8155796009019836, 'macro avg': {'precision': 0.5067583357621287, 'recall': 0.3951261178905748, 'f1-score': 0.4118099686025202, 'support': 470962}, 'weighted avg': {'precision': 0.7576947241732281, 'recall': 0.8155796009019836, 'f1-score': 0.7737919305616147, 'support': 470962}}
[[  4870  34298   1125]
 [  8324 375056   6932]
 [  1378  34798   4181]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7741055
{'0': {'precision': 0.19642191576593365, 'recall': 0.06816711938947097, 'f1-score': 0.10120990973689266, 'support': 7731}, '1': {'precision': 0.8915212162328852, 'recall': 0.965114629322072, 'f1-score': 0.9268593733093418, 'support': 119821}, '2': {'precision': 0.1774300932090546, 'recall': 0.06792404740665223, 'f1-score': 0.09823979356741315, 'support': 7847}, 'accuracy': 0.8619044453799511, 'macro avg': {'precision': 0.4217910750692912, 'recall': 0.3670685987060651, 'f1-score': 0.3754363588712158, 'support': 135399}, 'weighted avg': {'precision': 0.8104476061303142, 'recall': 0.8619044453799511, 'f1-score': 0.8316941664384379, 'support': 135399}}
[[   527   6976    228]
 [  1937 115641   2243]
 [   219   7095    533]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79035074
{'0': {'precision': 0.2092274678111588, 'recall': 0.05036157024793388, 'f1-score': 0.08118234804329726, 'support': 3872}, '1': {'precision': 0.8573468150437112, 'recall': 0.9694805051197558, 'f1-score': 0.9099721841657324, 'support': 45217}, '2': {'precision': 0.20902845927379785, 'recall': 0.05334335086401202, 'f1-score': 0.08499600957701517, 'support': 3993}, 'accuracy': 0.8335217211107343, 'macro avg': {'precision': 0.42520091404288934, 'recall': 0.35772847541056724, 'f1-score': 0.35871684726201497, 'support': 53082}, 'weighted avg': {'precision': 0.7613019541290188, 'recall': 0.8335217211107343, 'f1-score': 0.7874597673276552, 'support': 53082}}
[[  195  3586    91]
 [  665 43837   715]
 [   72  3708   213]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1680123
{'0': {'precision': 0.4654084040043359, 'recall': 0.08149752682529227, 'f1-score': 0.13870624453650565, 'support': 89561}, '1': {'precision': 0.28445119907024563, 'recall': 0.9183081518680463, 'f1-score': 0.4343576372298746, 'support': 69297}, '2': {'precision': 0.48549655850540807, 'recall': 0.04454418331904912, 'f1-score': 0.08160145436516135, 'support': 88676}, 'accuracy': 0.30252409769970995, 'macro avg': {'precision': 0.4117853871933299, 'recall': 0.3481166206707959, 'f1-score': 0.21822177871051385, 'support': 247534}, 'weighted avg': {'precision': 0.42194587262771466, 'recall': 0.30252409769970995, 'f1-score': 0.20101659457423082, 'support': 247534}}
[[ 7299 80014  2248]
 [ 3723 63636  1938]
 [ 4661 80065  3950]]
Evaluating performance on  train set...
220/220 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1341399
{'0': {'precision': 0.4583333333333333, 'recall': 0.07309361770537484, 'f1-score': 0.1260803253685816, 'support': 18661}, '1': {'precision': 0.33500432491939924, 'recall': 0.9237816447118773, 'f1-score': 0.49169732381158476, 'support': 18447}, '2': {'precision': 0.5357881671493587, 'recall': 0.06761342870568579, 'f1-score': 0.12007417709782105, 'support': 19153}, 'accuracy': 0.3501537477115586, 'macro avg': {'precision': 0.44304194180069706, 'recall': 0.35482956370764596, 'f1-score': 0.24595060875932914, 'support': 56261}, 'weighted avg': {'precision': 0.4442639462599875, 'recall': 0.3501537477115586, 'f1-score': 0.24391507790494255, 'support': 56261}}
[[ 1364 16818   479]
 [  763 17041   643]
 [  849 17009  1295]]
Evaluating performance on  val set...
79/79 - 1s - 554ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1506116
{'0': {'precision': 0.46844181459566075, 'recall': 0.06706197938726528, 'f1-score': 0.11732740521180686, 'support': 7083}, '1': {'precision': 0.3123979536301295, 'recall': 0.9343968744912909, 'f1-score': 0.4682465228208998, 'support': 6143}, '2': {'precision': 0.5165876777251185, 'recall': 0.04812362030905077, 'f1-score': 0.08804523424878835, 'support': 6795}, 'accuracy': 0.326756905249488, 'macro avg': {'precision': 0.4324758153169696, 'recall': 0.3498608247292023, 'f1-score': 0.22453972076049836, 'support': 20021}, 'weighted avg': {'precision': 0.436903614808108, 'recall': 0.326756905249488, 'f1-score': 0.21506097435315583, 'support': 20021}}
[[ 475 6444  164]
 [ 261 5740  142]
 [ 278 6190  327]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1588/1588 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.165015
{'0': {'precision': 0.47351363433169424, 'recall': 0.030231894398858365, 'f1-score': 0.056835101745160904, 'support': 140150}, '1': {'precision': 0.3144042380244976, 'recall': 0.9762093137332468, 'f1-score': 0.4756254806385771, 'support': 126394}, '2': {'precision': 0.5364306180925092, 'recall': 0.018756664305087413, 'f1-score': 0.036245963643403885, 'support': 139737}, 'accuracy': 0.32057861430881585, 'macro avg': {'precision': 0.4414494968162337, 'recall': 0.34173262414573086, 'f1-score': 0.189568848675714, 'support': 406281}, 'weighted avg': {'precision': 0.445654486409279, 'recall': 0.32057861430881585, 'f1-score': 0.18003930464642687, 'support': 406281}}
[[  4237 134608   1305]
 [  2047 123387    960]
 [  2664 134452   2621]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1492277
{'0': {'precision': 0.4974958263772955, 'recall': 0.02298141435952803, 'f1-score': 0.04393336281881173, 'support': 25934}, '1': {'precision': 0.33410273570345683, 'recall': 0.9824490943411383, 'f1-score': 0.4986342696400179, 'support': 24899}, '2': {'precision': 0.5862068965517241, 'recall': 0.025512066517947678, 'f1-score': 0.048896144278606966, 'support': 24655}, 'accuracy': 0.3402792496820687, 'macro avg': {'precision': 0.4726018195441588, 'recall': 0.3436475250728713, 'f1-score': 0.19715459224581222, 'support': 75488}, 'weighted avg': {'precision': 0.4725759301085194, 'recall': 0.3402792496820687, 'f1-score': 0.1955330244316835, 'support': 75488}}
[[  596 25094   244]
 [  237 24462   200]
 [  365 23661   629]]
Evaluating performance on  val set...
131/131 - 1s - 830ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1435347
{'0': {'precision': 0.5141065830721003, 'recall': 0.02890122477751344, 'f1-score': 0.05472595311587553, 'support': 11349}, '1': {'precision': 0.34810830860534125, 'recall': 0.9824653232138184, 'f1-score': 0.5140705237932215, 'support': 11463}, '2': {'precision': 0.5934065934065934, 'recall': 0.020489470688673878, 'f1-score': 0.03961122317990097, 'support': 10542}, 'accuracy': 0.3539605444624333, 'macro avg': {'precision': 0.4852071616946783, 'recall': 0.34395200622666855, 'f1-score': 0.20280256669633268, 'support': 33354}, 'weighted avg': {'precision': 0.4821206889884452, 'recall': 0.3539605444624333, 'f1-score': 0.2078148579155809, 'support': 33354}}
[[  328 10924    97]
 [  150 11262    51]
 [  160 10166   216]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
2104/2104 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2335654
{'0': {'precision': 0.5237547262863719, 'recall': 0.057961259101927946, 'f1-score': 0.10437218215992432, 'support': 219871}, '1': {'precision': 0.1917222284428791, 'recall': 0.9290484881369309, 'f1-score': 0.3178513568246253, 'support': 101365}, '2': {'precision': 0.5347605193451734, 'recall': 0.056667586968525675, 'f1-score': 0.1024759828416178, 'support': 217320}, 'accuracy': 0.2213920186572984, 'macro avg': {'precision': 0.4167458246914748, 'recall': 0.3478924447357948, 'f1-score': 0.17489984060872246, 'support': 538556}, 'weighted avg': {'precision': 0.4657019050451882, 'recall': 0.2213920186572984, 'f1-score': 0.14378727456263274, 'support': 538556}}
[[ 12744 199907   7220]
 [  3698  94173   3494]
 [  7890 197115  12315]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1465019
{'0': {'precision': 0.45536287732819525, 'recall': 0.058841429677990484, 'f1-score': 0.10421617384061345, 'support': 36148}, '1': {'precision': 0.3351858044970787, 'recall': 0.9408597697341174, 'f1-score': 0.4942814664394241, 'support': 36219}, '2': {'precision': 0.48130544993662866, 'recall': 0.04091472283574853, 'f1-score': 0.07541830097810437, 'support': 37126}, 'accuracy': 0.34452430748997653, 'macro avg': {'precision': 0.42395137725396753, 'recall': 0.3468719740826188, 'f1-score': 0.2246386470860473, 'support': 109493}, 'weighted avg': {'precision': 0.42440610885706453, 'recall': 0.34452430748997653, 'f1-score': 0.22348064741191762, 'support': 109493}}
[[ 2127 33206   815]
 [ 1320 34077   822]
 [ 1224 34383  1519]]
Evaluating performance on  val set...
141/141 - 1s - 921ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1614754
{'0': {'precision': 0.48072383949645947, 'recall': 0.05053345463567943, 'f1-score': 0.09145337524322705, 'support': 12091}, '1': {'precision': 0.3203255425709516, 'recall': 0.9468628833274586, 'f1-score': 0.47870444622649905, 'support': 11348}, '2': {'precision': 0.4872495446265938, 'recall': 0.042889209555876225, 'f1-score': 0.07883878573533747, 'support': 12474}, 'accuracy': 0.33110572773090524, 'macro avg': {'precision': 0.42943297556466825, 'recall': 0.34676184917300473, 'f1-score': 0.21633220240168782, 'support': 35913}, 'weighted avg': {'precision': 0.43230688107701887, 'recall': 0.33110572773090524, 'f1-score': 0.2094376918972731, 'support': 35913}}
[[  611 11195   285]
 [  325 10745   278]
 [  335 11604   535]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/EXC
Evaluating performance on  test set...
5267/5267 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85837543
{'0': {'precision': 0.3212256657422117, 'recall': 0.2364155205897507, 'f1-score': 0.2723713199621009, 'support': 151386}, '1': {'precision': 0.8081188335676515, 'recall': 0.867231117476922, 'f1-score': 0.836632130083699, 'support': 1046563}, '2': {'precision': 0.30249010118785746, 'recall': 0.2288281692015842, 'f1-score': 0.2605528923584137, 'support': 150235}, 'accuracy': 0.7252570865697857, 'macro avg': {'precision': 0.4772782001659069, 'recall': 0.44415826908941897, 'f1-score': 0.45651878080140457, 'support': 1348184}, 'weighted avg': {'precision': 0.6971013895737304, 'recall': 0.7252570865697857, 'f1-score': 0.7090765061623897, 'support': 1348184}}
[[ 35790 107899   7697]
 [ 67376 907612  71575]
 [  8251 107606  34378]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8169408
{'0': {'precision': 0.2804384572043231, 'recall': 0.24939643784448595, 'f1-score': 0.26400810107049866, 'support': 21953}, '1': {'precision': 0.8663352393957497, 'recall': 0.8944741108878784, 'f1-score': 0.8801798364650081, 'support': 226968}, '2': {'precision': 0.29605149721248347, 'recall': 0.23056264267490265, 'f1-score': 0.25923502767991946, 'support': 22341}, 'accuracy': 0.7875891204813059, 'macro avg': {'precision': 0.4809417312708521, 'recall': 0.45814439713575567, 'f1-score': 0.4678076550718087, 'support': 271262}, 'weighted avg': {'precision': 0.7719508392823364, 'recall': 0.7875891204813059, 'f1-score': 0.7791728908545527, 'support': 271262}}
[[  5475  15388   1090]
 [ 12793 203017  11158]
 [  1255  15935   5151]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81696725
{'0': {'precision': 0.290409847152712, 'recall': 0.2679395981530014, 'f1-score': 0.27872257561988834, 'support': 8013}, '1': {'precision': 0.8742821893225662, 'recall': 0.8922247530532124, 'f1-score': 0.8831623491024037, 'support': 87367}, '2': {'precision': 0.2649934335327594, 'recall': 0.22626463992025916, 'f1-score': 0.24410242623832248, 'support': 8026}, 'accuracy': 0.7921590623368083, 'macro avg': {'precision': 0.4765618233360125, 'recall': 0.4621429970421577, 'f1-score': 0.4686624503202048, 'support': 103406}, 'weighted avg': {'precision': 0.7817467403952697, 'recall': 0.7921590623368083, 'f1-score': 0.7867223857944475, 'support': 103406}}
[[ 2147  5494   372]
 [ 4751 77951  4665]
 [  495  5715  1816]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/AAL
Evaluating performance on  test set...
10110/10110 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84992397
{'0': {'precision': 0.3374142110335563, 'recall': 0.19879074441140843, 'f1-score': 0.25018352219698264, 'support': 290592}, '1': {'precision': 0.8031722398640051, 'recall': 0.9046248576736382, 'f1-score': 0.850885124728206, 'support': 2002440}, '2': {'precision': 0.35167447821537584, 'recall': 0.19250061003714447, 'f1-score': 0.24880797762480372, 'support': 295064}, 'accuracy': 0.7441856870842504, 'macro avg': {'precision': 0.4974203097043124, 'recall': 0.43197207070739707, 'f1-score': 0.44995887484999747, 'support': 2588096}, 'weighted avg': {'precision': 0.6994024057245493, 'recall': 0.7441856870842504, 'f1-score': 0.7147965208218318, 'support': 2588096}}
[[  57767  218600   14225]
 [ 100495 1811457   90488]
 [  12943  225321   56800]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8292854
{'0': {'precision': 0.33120816066305386, 'recall': 0.19503038550881063, 'f1-score': 0.24549952004725686, 'support': 42619}, '1': {'precision': 0.8297527023793423, 'recall': 0.9212882209566935, 'f1-score': 0.8731279558591698, 'support': 346276}, '2': {'precision': 0.3649177048285896, 'recall': 0.1880902720817417, 'f1-score': 0.24823320188664658, 'support': 42671}, 'accuracy': 0.7770723365603407, 'macro avg': {'precision': 0.5086261892903287, 'recall': 0.4348029595157486, 'f1-score': 0.45562022593102447, 'support': 431566}, 'weighted avg': {'precision': 0.734558817773292, 'recall': 0.7770723365603407, 'f1-score': 0.749360605436223, 'support': 431566}}
[[  8312  32605   1702]
 [ 14990 319020  12266]
 [  1794  32851   8026]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85531366
{'0': {'precision': 0.3624298111281266, 'recall': 0.16725559481743227, 'f1-score': 0.22888459058671823, 'support': 21225}, '1': {'precision': 0.7857971356088846, 'recall': 0.9232467806936357, 'f1-score': 0.848994772818657, 'support': 137219}, '2': {'precision': 0.36816343902958076, 'recall': 0.1574874829312699, 'f1-score': 0.2206069880132619, 'support': 21970}, 'accuracy': 0.7410566807453967, 'macro avg': {'precision': 0.5054634619221973, 'recall': 0.4159966194807794, 'f1-score': 0.43282878380621237, 'support': 180414}, 'weighted avg': {'precision': 0.6851320886837492, 'recall': 0.7410566807453967, 'f1-score': 0.6995190212137514, 'support': 180414}}
[[  3550  16837    838]
 [  5432 126687   5100]
 [   813  17697   3460]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/WBA
Evaluating performance on  test set...
6546/6546 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9372556
{'0': {'precision': 0.387404346639308, 'recall': 0.13325455281262646, 'f1-score': 0.19830024234073204, 'support': 308875}, '1': {'precision': 0.6530022495835694, 'recall': 0.8958565584623025, 'f1-score': 0.7553901555663973, 'support': 1061171}, '2': {'precision': 0.37912503518153673, 'recall': 0.14099595051648905, 'f1-score': 0.2055486941303819, 'support': 305718}, 'accuracy': 0.6175815926347624, 'macro avg': {'precision': 0.47317721046813804, 'recall': 0.390035687263806, 'f1-score': 0.38641303067917043, 'support': 1675764}, 'weighted avg': {'precision': 0.5540827439106529, 'recall': 0.6175815926347624, 'f1-score': 0.5523976226948992, 'support': 1675764}}
[[ 41159 256074  11642]
 [ 51565 950657  58949]
 [ 13519 249094  43105]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9461746
{'0': {'precision': 0.41680495406160195, 'recall': 0.16497653033434262, 'f1-score': 0.23638784317326234, 'support': 62421}, '1': {'precision': 0.6299053247035188, 'recall': 0.8975091617340973, 'f1-score': 0.7402650753497222, 'support': 190739}, '2': {'precision': 0.45740841990158554, 'recall': 0.1357940527204259, 'f1-score': 0.20941700668352148, 'support': 61608}, 'accuracy': 0.6031553398058253, 'macro avg': {'precision': 0.5013728995555687, 'recall': 0.3994265815962887, 'f1-score': 0.39535664173550195, 'support': 314768}, 'weighted avg': {'precision': 0.553883850008262, 'recall': 0.6031553398058253, 'f1-score': 0.5364419150409421, 'support': 314768}}
[[ 10298  50123   2000]
 [ 11625 171190   7924]
 [  2784  50458   8366]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9115791
{'0': {'precision': 0.390356529209622, 'recall': 0.18610485357362277, 'f1-score': 0.25204548606295935, 'support': 19532}, '1': {'precision': 0.6890394904458599, 'recall': 0.9007967172053611, 'f1-score': 0.7808156689744374, 'support': 75058}, '2': {'precision': 0.44386989157631357, 'recall': 0.14122704596115063, 'f1-score': 0.2142770866046624, 'support': 18842}, 'accuracy': 0.6515621694054587, 'macro avg': {'precision': 0.5077553037439319, 'recall': 0.4093762055800449, 'f1-score': 0.4157127472140197, 'support': 113432}, 'weighted avg': {'precision': 0.5968841799447122, 'recall': 0.6515621694054587, 'f1-score': 0.5956592829313606, 'support': 113432}}
[[ 3635 15274   623]
 [ 4735 67612  2711]
 [  942 15239  2661]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
7633/7633 - 49s - 49s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9778761
{'0': {'precision': 0.4156191184329763, 'recall': 0.12610865917455125, 'f1-score': 0.19350371872887084, 'support': 425514}, '1': {'precision': 0.5850687728567407, 'recall': 0.9058964354257318, 'f1-score': 0.7109645655922169, 'support': 1103582}, '2': {'precision': 0.4258380621883907, 'recall': 0.11639094629866294, 'f1-score': 0.18281461984628974, 'support': 424887}, 'accuracy': 0.5644086975168157, 'macro avg': {'precision': 0.4755086511593693, 'recall': 0.38279868029964864, 'f1-score': 0.36242763472245915, 'support': 1953983}, 'weighted avg': {'precision': 0.5135439647001616, 'recall': 0.5644086975168157, 'f1-score': 0.4834339879002106, 'support': 1953983}}
[[ 53661 354835  17018]
 [ 54191 999731  49660]
 [ 21259 354175  49453]]
Evaluating performance on  train set...
1586/1586 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9598012
{'0': {'precision': 0.4139803085605619, 'recall': 0.16181125017983025, 'f1-score': 0.23267680903331467, 'support': 83412}, '1': {'precision': 0.6101016384849558, 'recall': 0.887790853617649, 'f1-score': 0.7232063145783937, 'support': 238608}, '2': {'precision': 0.41205412054120544, 'recall': 0.12790836415702184, 'f1-score': 0.19521789011709434, 'support': 83810}, 'accuracy': 0.581649951950324, 'macro avg': {'precision': 0.4787120225289077, 'recall': 0.392503489318167, 'f1-score': 0.3837003379096009, 'support': 405830}, 'weighted avg': {'precision': 0.5288921792273374, 'recall': 0.581649951950324, 'f1-score': 0.5133481055484362, 'support': 405830}}
[[ 13497  66438   3477]
 [ 14955 211834  11819]
 [  4151  68939  10720]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9418423
{'0': {'precision': 0.4012889171280748, 'recall': 0.16101540590741886, 'f1-score': 0.229817539117326, 'support': 27457}, '1': {'precision': 0.6457400167771957, 'recall': 0.8921117367298966, 'f1-score': 0.749190871655029, 'support': 91465}, '2': {'precision': 0.3871103622577928, 'recall': 0.13150645726755625, 'f1-score': 0.19632032898074717, 'support': 27953}, 'accuracy': 0.6106825531914893, 'macro avg': {'precision': 0.47804643205435443, 'recall': 0.3948778666349572, 'f1-score': 0.3917762465843673, 'support': 146875}, 'weighted avg': {'precision': 0.5508200605161112, 'recall': 0.6106825531914893, 'f1-score': 0.5468771772151181, 'support': 146875}}
[[ 4421 21746  1290]
 [ 5338 81597  4530]
 [ 1258 23019  3676]]
testing model on single stock: results/universal/W10/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
22048/22048 - 128s - 128s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2017698
{'0': {'precision': 0.54454924548906, 'recall': 0.044828586852883406, 'f1-score': 0.0828377716551631, 'support': 2146889}, '1': {'precision': 0.2361571247025523, 'recall': 0.9554536461866735, 'f1-score': 0.3787095440596519, 'support': 1319255}, '2': {'precision': 0.5180193017183613, 'recall': 0.030880854613968656, 'f1-score': 0.05828702564227006, 'support': 2177919}, 'accuracy': 0.25229785705793856, 'macro avg': {'precision': 0.4329085573033245, 'recall': 0.34372102921784187, 'f1-score': 0.17327811378569502, 'support': 5644063}, 'weighted avg': {'precision': 0.4622277129485231, 'recall': 0.25229785705793856, 'f1-score': 0.14252186428450297, 'support': 5644063}}
[[  96242 2013149   37498]
 [  33689 1260487   25079]
 [  46806 2063857   67256]]
Evaluating performance on  train set...
5429/5429 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1356674
{'0': {'precision': 0.5405667171629374, 'recall': 0.047157691316112735, 'f1-score': 0.08674772739047437, 'support': 461579}, '1': {'precision': 0.3347638185171613, 'recall': 0.9609486385923427, 'f1-score': 0.49654664333732385, 'support': 460112}, '2': {'precision': 0.5132109581421221, 'recall': 0.031535727103378736, 'f1-score': 0.05942020818406499, 'support': 468104}, 'accuracy': 0.34441986048302087, 'macro avg': {'precision': 0.462847164607407, 'recall': 0.346547352337278, 'f1-score': 0.21423819297062108, 'support': 1389795}, 'weighted avg': {'precision': 0.46321881799623654, 'recall': 0.34441986048302087, 'f1-score': 0.21321334121376467, 'support': 1389795}}
[[ 21767 433518   6294]
 [ 10260 442144   7708]
 [  8240 445102  14762]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1127224
{'0': {'precision': 0.5182687676322851, 'recall': 0.04922489739366847, 'f1-score': 0.08991017338625444, 'support': 153012}, '1': {'precision': 0.36652390758665665, 'recall': 0.9568814310771357, 'f1-score': 0.5300264567008874, 'support': 175029}, '2': {'precision': 0.5158775744645934, 'recall': 0.040398133987894054, 'f1-score': 0.074928640808519, 'support': 155626}, 'accuracy': 0.3748467437307073, 'macro avg': {'precision': 0.46689008322784503, 'recall': 0.3488348208195661, 'f1-score': 0.23162175696522028, 'support': 483667}, 'weighted avg': {'precision': 0.46258607078333425, 'recall': 0.3748467437307073, 'f1-score': 0.24435857892836138, 'support': 483667}}
[[  7532 143023   2457]
 [  4104 167482   3443]
 [  2897 146442   6287]]
training model: results/universal/W10/deepOF_L1/h20
Epoch 1/50
8543/8543 - 125s - loss: 3.0142 - accuracy20: 0.4780 - val_loss: 3.1956 - val_accuracy20: 0.4528 - 125s/epoch - 15ms/step
Epoch 2/50
8543/8543 - 117s - loss: 2.9973 - accuracy20: 0.4807 - val_loss: 3.1956 - val_accuracy20: 0.4539 - 117s/epoch - 14ms/step
Epoch 3/50
8543/8543 - 118s - loss: 2.9894 - accuracy20: 0.4826 - val_loss: 3.1897 - val_accuracy20: 0.4519 - 118s/epoch - 14ms/step
Epoch 4/50
8543/8543 - 119s - loss: 2.9804 - accuracy20: 0.4847 - val_loss: 3.1885 - val_accuracy20: 0.4469 - 119s/epoch - 14ms/step
Epoch 5/50
8543/8543 - 118s - loss: 2.9742 - accuracy20: 0.4860 - val_loss: 3.1930 - val_accuracy20: 0.4470 - 118s/epoch - 14ms/step
Epoch 6/50
8543/8543 - 117s - loss: 2.9684 - accuracy20: 0.4869 - val_loss: 3.1935 - val_accuracy20: 0.4447 - 117s/epoch - 14ms/step
Epoch 7/50
8543/8543 - 120s - loss: 2.9626 - accuracy20: 0.4882 - val_loss: 3.1945 - val_accuracy20: 0.4399 - 120s/epoch - 14ms/step
Epoch 8/50
8543/8543 - 119s - loss: 2.9575 - accuracy20: 0.4889 - val_loss: 3.2007 - val_accuracy20: 0.4418 - 119s/epoch - 14ms/step
Epoch 9/50
8543/8543 - 118s - loss: 2.9534 - accuracy20: 0.4895 - val_loss: 3.2057 - val_accuracy20: 0.4444 - 118s/epoch - 14ms/step
Epoch 10/50
8543/8543 - 118s - loss: 2.9490 - accuracy20: 0.4901 - val_loss: 3.1973 - val_accuracy20: 0.4456 - 118s/epoch - 14ms/step
Epoch 11/50
8543/8543 - 119s - loss: 2.9450 - accuracy20: 0.4905 - val_loss: 3.2083 - val_accuracy20: 0.4488 - 119s/epoch - 14ms/step
Epoch 12/50
8543/8543 - 118s - loss: 2.9420 - accuracy20: 0.4909 - val_loss: 3.2254 - val_accuracy20: 0.4494 - 118s/epoch - 14ms/step
Epoch 13/50
8543/8543 - 122s - loss: 2.9376 - accuracy20: 0.4916 - val_loss: 3.2538 - val_accuracy20: 0.4548 - 122s/epoch - 14ms/step
Epoch 14/50
8543/8543 - 119s - loss: 2.9340 - accuracy20: 0.4923 - val_loss: 3.2828 - val_accuracy20: 0.4549 - 119s/epoch - 14ms/step
testing model in sample: results/universal/W10/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 197s - 197s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0787129
{'0': {'precision': 0.39511508536566226, 'recall': 0.2630512820066221, 'f1-score': 0.31583360954937223, 'support': 2870695}, '1': {'precision': 0.3962980983701952, 'recall': 0.7090596734679756, 'f1-score': 0.5084308581086083, 'support': 3757365}, '2': {'precision': 0.40514748885453233, 'recall': 0.12657163013498587, 'f1-score': 0.19288446203276385, 'support': 2917194}, 'accuracy': 0.3969061483329831, 'macro avg': {'precision': 0.39885355753012997, 'recall': 0.3662275285365279, 'f1-score': 0.3390496432302481, 'support': 9545254}, 'weighted avg': {'precision': 0.3986468383102238, 'recall': 0.3969061483329831, 'f1-score': 0.3540716329055039, 'support': 9545254}}
[[ 755140 1947999  167556]
 [ 718602 2664196  374567]
 [ 437448 2110512  369234]]
Evaluating performance on  train set...
8543/8543 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0605278
{'0': {'precision': 0.3797122852679627, 'recall': 0.25700321810717236, 'f1-score': 0.30653338500915805, 'support': 606257}, '1': {'precision': 0.44655102485335096, 'recall': 0.740113592157473, 'f1-score': 0.5570208774208357, 'support': 963975}, '2': {'precision': 0.4147008948808784, 'recall': 0.120198546587075, 'f1-score': 0.18637688121806473, 'support': 616480}, 'accuracy': 0.4314061476774262, 'macro avg': {'precision': 0.4136547350007307, 'recall': 0.37243845228390676, 'f1-score': 0.3499770478826862, 'support': 2186712}, 'weighted avg': {'precision': 0.41904103640025403, 'recall': 0.4314061476774262, 'f1-score': 0.383081919539729, 'support': 2186712}}
[[155810 420198  30249]
 [176190 713451  74334]
 [ 78337 464043  74100]]
Evaluating performance on  val set...
3077/3077 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0511422
{'0': {'precision': 0.356302023697719, 'recall': 0.2688782742082678, 'f1-score': 0.3064775827057893, 'support': 206004}, '1': {'precision': 0.47700742522298795, 'recall': 0.7221761378938863, 'f1-score': 0.5745298562946869, 'support': 371300}, '2': {'precision': 0.40116807268007787, 'recall': 0.1327008114025673, 'f1-score': 0.1994322214336409, 'support': 209637}, 'accuracy': 0.4464794692359402, 'macro avg': {'precision': 0.4114925072002616, 'recall': 0.3745850745015738, 'f1-score': 0.36014655347803903, 'support': 786941}, 'weighted avg': {'precision': 0.42520617216227624, 'recall': 0.4464794692359402, 'f1-score': 0.4044355500534663, 'support': 786941}}
[[ 55390 139642  10972]
 [ 72602 268144  30554]
 [ 27466 154352  27819]]
testing model out of sample: results/universal/W10/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 113s - 113s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0279514
{'0': {'precision': 0.3463147765284691, 'recall': 0.33193277972248103, 'f1-score': 0.33897129557672045, 'support': 1270688}, '1': {'precision': 0.5646522522613655, 'recall': 0.6871817336532796, 'f1-score': 0.6199204015645742, 'support': 2924241}, '2': {'precision': 0.3915913194114508, 'recall': 0.2116135861815625, 'f1-score': 0.27475255141289295, 'support': 1265845}, 'accuracy': 0.49427755113103017, 'macro avg': {'precision': 0.4341861160670952, 'recall': 0.41024269985244105, 'f1-score': 0.41121474951806253, 'support': 5460774}, 'weighted avg': {'precision': 0.4737297700441042, 'recall': 0.49427755113103017, 'f1-score': 0.47453301602824743, 'support': 5460774}}
[[ 421783  748150  100755]
 [ 599326 2009485  315430]
 [ 196809  801166  267870]]
Evaluating performance on  train set...
4055/4055 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0206307
{'0': {'precision': 0.3328517631542413, 'recall': 0.33619480815410774, 'f1-score': 0.33451493350773925, 'support': 228204}, '1': {'precision': 0.5850322896367307, 'recall': 0.6943929191913081, 'f1-score': 0.6350387292964857, 'support': 578465}, '2': {'precision': 0.39147013133738173, 'recall': 0.20417500714898484, 'f1-score': 0.2683759564210844, 'support': 230802}, 'accuracy': 0.5065462070747038, 'macro avg': {'precision': 0.43645139470945127, 'recall': 0.41158757816480024, 'f1-score': 0.41264320640843644, 'support': 1037471}, 'weighted avg': {'precision': 0.4865012096111528, 'recall': 0.5065462070747038, 'f1-score': 0.48736497880190477, 'support': 1037471}}
[[ 76721 134934  16549]
 [120079 401682  56704]
 [ 33696 149982  47124]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0202477
{'0': {'precision': 0.3302026302421403, 'recall': 0.3423972843263491, 'f1-score': 0.3361894089589978, 'support': 85430}, '1': {'precision': 0.5904513053066422, 'recall': 0.6857479111335567, 'f1-score': 0.634541604514588, 'support': 221771}, '2': {'precision': 0.3905160390516039, 'recall': 0.21709386116938795, 'f1-score': 0.27905613366554305, 'support': 87704}, 'accuracy': 0.507387852774718, 'macro avg': {'precision': 0.4370566582001289, 'recall': 0.415079685543098, 'f1-score': 0.41659571571304294, 'support': 394905}, 'weighted avg': {'precision': 0.48974818201776954, 'recall': 0.507387852774718, 'f1-score': 0.4910495600946421, 'support': 394905}}
[[ 29251  49674   6505]
 [ 46481 152079  23211]
 [ 12853  55811  19040]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
518/518 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1452491
{'0': {'precision': 0.43385660804731496, 'recall': 0.25787210172026925, 'f1-score': 0.3234780161140887, 'support': 53480}, '1': {'precision': 0.23723990752267474, 'recall': 0.7154493346294372, 'f1-score': 0.35632423769417615, 'support': 29833}, '2': {'precision': 0.415852534562212, 'recall': 0.09153615191106061, 'f1-score': 0.15004489375145486, 'support': 49292}, 'accuracy': 0.298985709437804, 'macro avg': {'precision': 0.3623163500440672, 'recall': 0.35495252942025574, 'f1-score': 0.2766157158532399, 'support': 132605}, 'weighted avg': {'precision': 0.3829300003252887, 'recall': 0.298985709437804, 'f1-score': 0.2663989908955811, 'support': 132605}}
[[13791 35565  4124]
 [ 6275 21344  2214]
 [11721 33059  4512]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1209422
{'0': {'precision': 0.37597154525095505, 'recall': 0.2486495905209967, 'f1-score': 0.2993339975877078, 'support': 11478}, '1': {'precision': 0.3468583644213438, 'recall': 0.7228336827393431, 'f1-score': 0.46877212859368356, 'support': 11448}, '2': {'precision': 0.3640793595544727, 'recall': 0.09179464677490128, 'f1-score': 0.1466218110456967, 'support': 11395}, 'accuracy': 0.35473908102910756, 'macro avg': {'precision': 0.36230308974225717, 'recall': 0.35442597334508036, 'f1-score': 0.30490931240902935, 'support': 34321}, 'weighted avg': {'precision': 0.3623122943506664, 'recall': 0.35473908102910756, 'f1-score': 0.305148873556071, 'support': 34321}}
[[2854 7680  944]
 [2290 8275  883]
 [2447 7902 1046]]
Evaluating performance on  val set...
46/46 - 0s - 418ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1181657
{'0': {'precision': 0.38124757845796203, 'recall': 0.24550898203592814, 'f1-score': 0.29867961754439215, 'support': 4008}, '1': {'precision': 0.3317018072289157, 'recall': 0.7027386333421962, 'f1-score': 0.45067780714468414, 'support': 3761}, '2': {'precision': 0.39982347749338043, 'recall': 0.1157679529772553, 'f1-score': 0.17954815695600476, 'support': 3913}, 'accuracy': 0.3492552645095018, 'macro avg': {'precision': 0.3709242877267527, 'recall': 0.35467185611845986, 'f1-score': 0.3096351938816937, 'support': 11682}, 'weighted avg': {'precision': 0.3715185806265247, 'recall': 0.3492552645095018, 'f1-score': 0.3077109294605314, 'support': 11682}}
[[ 984 2686  338]
 [ 776 2643  342]
 [ 821 2639  453]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
1840/1840 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.954394
{'0': {'precision': 0.23907663349425728, 'recall': 0.4930805176132279, 'f1-score': 0.32201838092890595, 'support': 55640}, '1': {'precision': 0.811925164597678, 'recall': 0.7183176874037761, 'f1-score': 0.7622583641752312, 'support': 359838}, '2': {'precision': 0.3720678360101437, 'recall': 0.25385696777449357, 'f1-score': 0.3017998714377545, 'support': 55484}, 'accuracy': 0.6369898208348019, 'macro avg': {'precision': 0.474356544700693, 'recall': 0.48841839093049916, 'f1-score': 0.4620255388472972, 'support': 470962}, 'weighted avg': {'precision': 0.6924286101199387, 'recall': 0.6369898208348019, 'f1-score': 0.6560013165177309, 'support': 470962}}
[[ 27435  25639   2566]
 [ 80155 258478  21205]
 [  7164  34235  14085]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93394536
{'0': {'precision': 0.1802772391007685, 'recall': 0.4706544159009938, 'f1-score': 0.26069796427087666, 'support': 10666}, '1': {'precision': 0.8706284248805362, 'recall': 0.7634001510865936, 'f1-score': 0.8134960194324707, 'support': 113842}, '2': {'precision': 0.24301603724780135, 'recall': 0.17252777522725185, 'f1-score': 0.201793481179187, 'support': 10891}, 'accuracy': 0.6928116160385231, 'macro avg': {'precision': 0.4313072337430353, 'recall': 0.4688607807382798, 'f1-score': 0.42532915496084484, 'support': 135399}, 'weighted avg': {'precision': 0.7657634534905323, 'recall': 0.6928116160385231, 'f1-score': 0.7207464688414761, 'support': 135399}}
[[ 5020  5218   428]
 [21510 86907  5425]
 [ 1316  7696  1879]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.945606
{'0': {'precision': 0.2028397565922921, 'recall': 0.5050505050505051, 'f1-score': 0.28943560057887124, 'support': 5346}, '1': {'precision': 0.8267530135234415, 'recall': 0.7208027898370223, 'f1-score': 0.7701510696542633, 'support': 42153}, '2': {'precision': 0.3079470198675497, 'recall': 0.16657710908113918, 'f1-score': 0.2162036498895734, 'support': 5583}, 'accuracy': 0.640782186051769, 'macro avg': {'precision': 0.44584659666109444, 'recall': 0.4641434679895555, 'f1-score': 0.4252634400409026, 'support': 53082}, 'weighted avg': {'precision': 0.7093509914795326, 'recall': 0.640782186051769, 'f1-score': 0.6634747322475472, 'support': 53082}}
[[ 2700  2443   203]
 [ 9882 30384  1887]
 [  729  3924   930]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1095569
{'0': {'precision': 0.42430595131482535, 'recall': 0.2382922786763445, 'f1-score': 0.3051889589143371, 'support': 87485}, '1': {'precision': 0.30564416090731883, 'recall': 0.7351483829719218, 'f1-score': 0.4317744433839752, 'support': 75076}, '2': {'precision': 0.43823628407943455, 'recall': 0.09193508526237747, 'f1-score': 0.15198591425986635, 'support': 84973}, 'accuracy': 0.33874538447243613, 'macro avg': {'precision': 0.38939546543385956, 'recall': 0.3551252489702146, 'f1-score': 0.2963164388527262, 'support': 247534}, 'weighted avg': {'precision': 0.39309831757308955, 'recall': 0.33874538447243613, 'f1-score': 0.2909905438223425, 'support': 247534}}
[[20847 61956  4682]
 [14552 55192  5332]
 [13733 63428  7812]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0997846
{'0': {'precision': 0.40036686619038425, 'recall': 0.2236664689067472, 'f1-score': 0.2869995501574449, 'support': 18541}, '1': {'precision': 0.33430934777834714, 'recall': 0.7353477887505367, 'f1-score': 0.45964941709301355, 'support': 18632}, '2': {'precision': 0.4678861788617886, 'recall': 0.12059932942162616, 'f1-score': 0.19176941019660113, 'support': 19088}, 'accuracy': 0.35815218357299017, 'macro avg': {'precision': 0.4008541309435067, 'recall': 0.35987119569297005, 'f1-score': 0.3128061258156865, 'support': 56261}, 'weighted avg': {'precision': 0.40139821929855324, 'recall': 0.35815218357299017, 'f1-score': 0.3118668544920804, 'support': 56261}}
[[ 4147 13316  1078]
 [ 3391 13701  1540]
 [ 2820 13966  2302]]
Evaluating performance on  val set...
79/79 - 1s - 559ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1040289
{'0': {'precision': 0.42687846696923853, 'recall': 0.2436672423719056, 'f1-score': 0.3102437236576874, 'support': 6948}, '1': {'precision': 0.31906668507524505, 'recall': 0.7371610845295056, 'f1-score': 0.44536519560608984, 'support': 6270}, '2': {'precision': 0.45124282982791586, 'recall': 0.10407173305894458, 'f1-score': 0.16913521261347347, 'support': 6803}, 'accuracy': 0.35078167923680137, 'macro avg': {'precision': 0.39906266062413315, 'recall': 0.3616333533201186, 'f1-score': 0.30824804395908356, 'support': 20021}, 'weighted avg': {'precision': 0.40139377030334983, 'recall': 0.35078167923680137, 'f1-score': 0.30461215822552595, 'support': 20021}}
[[1693 4834  421]
 [1208 4622  440]
 [1065 5030  708]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1151544
{'0': {'precision': 0.41036671261303564, 'recall': 0.19260491536388907, 'f1-score': 0.26216373137216953, 'support': 140661}, '1': {'precision': 0.31847030603046556, 'recall': 0.8298973587189349, 'f1-score': 0.4603014764661977, 'support': 125583}, '2': {'precision': 0.4692088875221035, 'recall': 0.04358133921749252, 'f1-score': 0.07975484174485768, 'support': 140037}, 'accuracy': 0.33822895975937833, 'macro avg': {'precision': 0.3993486353885349, 'recall': 0.3553612044334389, 'f1-score': 0.2674066831944083, 'support': 406281}, 'weighted avg': {'precision': 0.4022429146010248, 'recall': 0.33822895975937833, 'f1-score': 0.2605361356081625, 'support': 406281}}
[[ 27092 109630   3939]
 [ 18397 104221   2965]
 [ 20530 113404   6103]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1044687
{'0': {'precision': 0.398703728451156, 'recall': 0.22886621663086837, 'f1-score': 0.29080364540182274, 'support': 26072}, '1': {'precision': 0.3375210531743031, 'recall': 0.7879869999598764, 'f1-score': 0.47260826143979595, 'support': 24923}, '2': {'precision': 0.5321061643835616, 'recall': 0.050749193647164494, 'f1-score': 0.09266092660926609, 'support': 24493}, 'accuracy': 0.35567242475625266, 'macro avg': {'precision': 0.4227769820030069, 'recall': 0.355867470079303, 'f1-score': 0.28535761115029495, 'support': 75488}, 'weighted avg': {'precision': 0.42178779542030875, 'recall': 0.35567242475625266, 'f1-score': 0.28653815729945303, 'support': 75488}}
[[ 5967 19504   601]
 [ 4792 19639   492]
 [ 4207 19043  1243]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1084809
{'0': {'precision': 0.3315538391640164, 'recall': 0.2562774363476734, 'f1-score': 0.2890957710210954, 'support': 11390}, '1': {'precision': 0.31045682709748174, 'recall': 0.6490872210953347, 'f1-score': 0.4200194030702505, 'support': 11339}, '2': {'precision': 0.5255041518386714, 'recall': 0.041694117647058826, 'f1-score': 0.07725845831880014, 'support': 10625}, 'accuracy': 0.32146069436949093, 'macro avg': {'precision': 0.38917160603338985, 'recall': 0.3156862583633557, 'f1-score': 0.2621245441367154, 'support': 33354}, 'weighted avg': {'precision': 0.3861650717701738, 'recall': 0.32146069436949093, 'f1-score': 0.2661231625286652, 'support': 33354}}
[[2919 8239  232]
 [3811 7360  168]
 [2074 8108  443]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
2104/2104 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1372002
{'0': {'precision': 0.4717349689416728, 'recall': 0.22743753708220713, 'f1-score': 0.30690634590823307, 'support': 212366}, '1': {'precision': 0.21774710226126998, 'recall': 0.7292505492438813, 'f1-score': 0.3353592137592138, 'support': 116979}, '2': {'precision': 0.4814964975110931, 'recall': 0.1021791397201868, 'f1-score': 0.16858300999968456, 'support': 209211}, 'accuracy': 0.28777694427320466, 'macro avg': {'precision': 0.3903261895713453, 'recall': 0.35295574201542507, 'f1-score': 0.2702828565557105, 'support': 538556}, 'weighted avg': {'precision': 0.4203586450257386, 'recall': 0.28777694427320466, 'f1-score': 0.25935256245688637, 'support': 538556}}
[[ 48300 150656  13410]
 [ 22062  85307   9610]
 [ 32026 155808  21377]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1071304
{'0': {'precision': 0.4069009046917736, 'recall': 0.21252747252747253, 'f1-score': 0.2792174980148704, 'support': 36400}, '1': {'precision': 0.33390443784146456, 'recall': 0.7725294525294525, 'f1-score': 0.466274604940647, 'support': 36075}, '2': {'precision': 0.4342311529143509, 'recall': 0.08231130801231833, 'f1-score': 0.13838991711138865, 'support': 37018}, 'accuracy': 0.3530088681468222, 'macro avg': {'precision': 0.39167883181586305, 'recall': 0.3557894110230811, 'f1-score': 0.294627340022302, 'support': 109493}, 'weighted avg': {'precision': 0.3920904929492738, 'recall': 0.3530088681468222, 'f1-score': 0.29323601739476046, 'support': 109493}}
[[ 7736 26848  1816]
 [ 6052 27869  2154]
 [ 5224 28747  3047]]
Evaluating performance on  val set...
141/141 - 1s - 904ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1109746
{'0': {'precision': 0.4069395317500421, 'recall': 0.20311055065153427, 'f1-score': 0.2709735307312696, 'support': 11895}, '1': {'precision': 0.3294399303540337, 'recall': 0.7786351165980796, 'f1-score': 0.4629893964110931, 'support': 11664}, '2': {'precision': 0.42400332225913623, 'recall': 0.08264529706977497, 'f1-score': 0.13832813981845277, 'support': 12354}, 'accuracy': 0.34859243170996573, 'macro avg': {'precision': 0.386794261454404, 'recall': 0.35479698810646293, 'f1-score': 0.2907636889869385, 'support': 35913}, 'weighted avg': {'precision': 0.3876387414308348, 'recall': 0.34859243170996573, 'f1-score': 0.2877076353160306, 'support': 35913}}
[[2416 8901  578]
 [1773 9082  809]
 [1748 9585 1021]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/EXC
Evaluating performance on  test set...
5267/5267 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97649384
{'0': {'precision': 0.2961715047393365, 'recall': 0.4737434358589647, 'f1-score': 0.3644800194413646, 'support': 202616}, '1': {'precision': 0.7641364195153082, 'recall': 0.6373438774071164, 'f1-score': 0.6950046597891416, 'support': 943089}, '2': {'precision': 0.32740594142787965, 'recall': 0.38401019364971184, 'f1-score': 0.35345619187024396, 'support': 202479}, 'accuracy': 0.5747093868492728, 'macro avg': {'precision': 0.46257128856084145, 'recall': 0.4983658356385976, 'f1-score': 0.4709802903669167, 'support': 1348184}, 'weighted avg': {'precision': 0.6282158555233659, 'recall': 0.5747093868492728, 'f1-score': 0.5940347827067436, 'support': 1348184}}
[[ 95988  88929  17699]
 [199985 601072 142032]
 [ 28123  96602  77754]]
Evaluating performance on  train set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9543734
{'0': {'precision': 0.24794959138024297, 'recall': 0.5535790057773281, 'f1-score': 0.34249479997576693, 'support': 30637}, '1': {'precision': 0.8410773668448804, 'recall': 0.6556748576093651, 'f1-score': 0.73689321951141, 'support': 209459}, '2': {'precision': 0.3253904078435336, 'recall': 0.4131746133607136, 'f1-score': 0.3640655923098671, 'support': 31166}, 'accuracy': 0.6162824133125908, 'macro avg': {'precision': 0.471472455356219, 'recall': 0.5408094922491355, 'f1-score': 0.481151203932348, 'support': 271262}, 'weighted avg': {'precision': 0.7148394292747599, 'recall': 0.6162824133125908, 'f1-score': 0.6495137479721719, 'support': 271262}}
[[ 16960  11603   2074]
 [ 47499 137337  24623]
 [  3942  14347  12877]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95457107
{'0': {'precision': 0.257151989771456, 'recall': 0.5776341769879735, 'f1-score': 0.35587503455902686, 'support': 11142}, '1': {'precision': 0.8531510298960419, 'recall': 0.6516608714951543, 'f1-score': 0.7389164627752535, 'support': 81102}, '2': {'precision': 0.2868533171028606, 'recall': 0.422236158394553, 'f1-score': 0.3416207596404755, 'support': 11162}, 'accuracy': 0.6189195984759105, 'macro avg': {'precision': 0.46571877892345287, 'recall': 0.5505104022925602, 'f1-score': 0.4788040856582519, 'support': 103406}, 'weighted avg': {'precision': 0.7278039864433833, 'recall': 0.6189195984759105, 'f1-score': 0.6547582685546514, 'support': 103406}}
[[ 6436  3993   713]
 [17247 52851 11004]
 [ 1345  5104  4713]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/AAL
Evaluating performance on  test set...
10110/10110 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9746823
{'0': {'precision': 0.29931714661461073, 'recall': 0.49403014731589284, 'f1-score': 0.37277922334261404, 'support': 397581}, '1': {'precision': 0.7602281459285147, 'recall': 0.6603441621513234, 'f1-score': 0.7067746079685024, 'support': 1790377}, '2': {'precision': 0.36716887777583124, 'recall': 0.34569323583363737, 'f1-score': 0.35610756984419567, 'support': 400138}, 'accuracy': 0.5861478863226094, 'macro avg': {'precision': 0.47557139010631894, 'recall': 0.5000225151002845, 'f1-score': 0.47855380038510403, 'support': 2588096}, 'weighted avg': {'precision': 0.6286536581744671, 'recall': 0.5861478863226094, 'f1-score': 0.6012509232535888, 'support': 2588096}}
[[ 196417  168427   32737]
 [ 402440 1182265  205672]
 [  57360  204453  138325]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96275634
{'0': {'precision': 0.26987468949404847, 'recall': 0.5038706229202945, 'f1-score': 0.35149014985687826, 'support': 58001}, '1': {'precision': 0.7955000280546879, 'recall': 0.673879771724079, 'f1-score': 0.7296566583979223, 'support': 315583}, '2': {'precision': 0.3623525205577404, 'recall': 0.34959125245765926, 'f1-score': 0.3558575165464089, 'support': 57982}, 'accuracy': 0.6074621263028135, 'macro avg': {'precision': 0.4759090793688256, 'recall': 0.5091138823673442, 'f1-score': 0.47900144160040314, 'support': 431566}, 'weighted avg': {'precision': 0.6666632938320114, 'recall': 0.6074621263028135, 'f1-score': 0.6286114938003322, 'support': 431566}}
[[ 29225  24809   3967]
 [ 71215 212665  31703]
 [  7851  29861  20270]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97834694
{'0': {'precision': 0.2882250346585573, 'recall': 0.46011065500624665, 'f1-score': 0.35442759530912743, 'support': 28015}, '1': {'precision': 0.7411410872200027, 'recall': 0.6706092607636068, 'f1-score': 0.7041132695055121, 'support': 123100}, '2': {'precision': 0.3903813716213436, 'recall': 0.323867708795522, 'f1-score': 0.3540275342312427, 'support': 29299}, 'accuracy': 0.5816122917290233, 'macro avg': {'precision': 0.4732491644999679, 'recall': 0.4848625415217918, 'f1-score': 0.47085613301529405, 'support': 180414}, 'weighted avg': {'precision': 0.6138485704539314, 'recall': 0.5816122917290233, 'f1-score': 0.5929599991361808, 'support': 180414}}
[[12890 13206  1919]
 [27649 82552 12899]
 [ 4183 15627  9489]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/WBA
Evaluating performance on  test set...
6546/6546 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0312097
{'0': {'precision': 0.3567825895592075, 'recall': 0.30267885075334794, 'f1-score': 0.3275113223463123, 'support': 396364}, '1': {'precision': 0.5554704778256315, 'recall': 0.6889682203987254, 'f1-score': 0.6150588327695329, 'support': 886575}, '2': {'precision': 0.37242868697312576, 'recall': 0.227404060332209, 'f1-score': 0.28238470134332677, 'support': 392825}, 'accuracy': 0.4894024456904433, 'macro avg': {'precision': 0.4282272514526549, 'recall': 0.4063503771614274, 'f1-score': 0.40831828548639065, 'support': 1675764}, 'weighted avg': {'precision': 0.46556753347519286, 'recall': 0.4894024456904433, 'f1-score': 0.46906202349394943, 'support': 1675764}}
[[119971 241737  34656]
 [159881 610822 115872]
 [ 56406 247089  89330]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0303301
{'0': {'precision': 0.38262873604609293, 'recall': 0.3351247697625716, 'f1-score': 0.3573047460841611, 'support': 79266}, '1': {'precision': 0.5311869094483447, 'recall': 0.7004918095286508, 'f1-score': 0.6042031475650628, 'support': 157378}, '2': {'precision': 0.43939794730716325, 'recall': 0.21262352158107622, 'f1-score': 0.2865744255054861, 'support': 78124}, 'accuracy': 0.48739706704620545, 'macro avg': {'precision': 0.45107119760053366, 'recall': 0.4160800336240995, 'f1-score': 0.41602743971823664, 'support': 314768}, 'weighted avg': {'precision': 0.4709948535493316, 'recall': 0.48739706704620545, 'f1-score': 0.4631942935075743, 'support': 314768}}
[[ 26564  47000   5702]
 [ 31645 110242  15491]
 [ 11216  50297  16611]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0104522
{'0': {'precision': 0.34245448367135245, 'recall': 0.38443623514294895, 'f1-score': 0.3622330262386258, 'support': 24904}, '1': {'precision': 0.6049029059358215, 'recall': 0.6836853820649721, 'f1-score': 0.641885819090557, 'support': 64243}, '2': {'precision': 0.42914885347842985, 'recall': 0.2273419806464896, 'f1-score': 0.29722745625841185, 'support': 24285}, 'accuracy': 0.5202852810494393, 'macro avg': {'precision': 0.458835414361868, 'recall': 0.43182119928480356, 'f1-score': 0.4337821005291982, 'support': 113432}, 'weighted avg': {'precision': 0.5096546279190177, 'recall': 0.5202852810494393, 'f1-score': 0.5066990861178231, 'support': 113432}}
[[ 9574 13744  1586]
 [14563 43922  5758]
 [ 3820 14944  5521]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
7633/7633 - 40s - 40s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0501037
{'0': {'precision': 0.37634292344611164, 'recall': 0.27456635165917626, 'f1-score': 0.3174977140912094, 'support': 519776}, '1': {'precision': 0.49603750293690957, 'recall': 0.7292242339710694, 'f1-score': 0.5904413027912198, 'support': 911976}, '2': {'precision': 0.4077743316330454, 'recall': 0.18277543845539618, 'f1-score': 0.2524127043311662, 'support': 522231}, 'accuracy': 0.46223483008808164, 'macro avg': {'precision': 0.4267182526720222, 'recall': 0.39552200802854726, 'f1-score': 0.3867839070711985, 'support': 1953983}, 'weighted avg': {'precision': 0.4406080882682061, 'recall': 0.46223483008808164, 'f1-score': 0.4274928330437712, 'support': 1953983}}
[[142713 331255  45808]
 [154122 665035  92819]
 [ 82375 344405  95451]]
Evaluating performance on  train set...
1586/1586 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0394418
{'0': {'precision': 0.3828339473004998, 'recall': 0.3144222616202883, 'f1-score': 0.34527197892308836, 'support': 103784}, '1': {'precision': 0.512964097717994, 'recall': 0.7063748239946728, 'f1-score': 0.5943301206725845, 'support': 196727}, '2': {'precision': 0.4110283759307708, 'recall': 0.19392512272239576, 'f1-score': 0.26352018269906907, 'support': 105319}, 'accuracy': 0.4731513195180248, 'macro avg': {'precision': 0.4356088069830882, 'recall': 0.4049074027791189, 'f1-score': 0.40104076076491396, 'support': 405830}, 'weighted avg': {'precision': 0.4532317077669362, 'recall': 0.4731513195180248, 'f1-score': 0.44478764712266855, 'support': 405830}}
[[ 32632  62432   8720]
 [ 37218 138963  20546]
 [ 15388  69507  20424]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0305896
{'0': {'precision': 0.36168290636897465, 'recall': 0.3243258882073834, 'f1-score': 0.34198724793312796, 'support': 34564}, '1': {'precision': 0.5552561484966887, 'recall': 0.6959961546456038, 'f1-score': 0.6177109815926163, 'support': 76976}, '2': {'precision': 0.38692379086315354, 'recall': 0.21236734116315267, 'f1-score': 0.27422390323229, 'support': 35335}, 'accuracy': 0.4921804255319149, 'macro avg': {'precision': 0.43462094857627226, 'recall': 0.4108964613387132, 'f1-score': 0.41130737758601144, 'support': 146875}, 'weighted avg': {'precision': 0.4692054972770579, 'recall': 0.4921804255319149, 'f1-score': 0.4701894085266168, 'support': 146875}}
[[11210 20146  3208]
 [14719 53575  8682]
 [ 5065 22766  7504]]
testing model on single stock: results/universal/W10/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
22048/22048 - 110s - 110s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.124974
{'0': {'precision': 0.4528414120775888, 'recall': 0.23365795932763295, 'f1-score': 0.30825956920690717, 'support': 2075414}, '1': {'precision': 0.25990701275430267, 'recall': 0.755068363979255, 'f1-score': 0.3867040864354759, 'support': 1442280}, '2': {'precision': 0.47447735873678715, 'recall': 0.08549597929616168, 'f1-score': 0.14488513535860859, 'support': 2126369}, 'accuracy': 0.3110796247313327, 'macro avg': {'precision': 0.3957419278562262, 'recall': 0.35807410086768315, 'f1-score': 0.27994959700033056, 'support': 5644063}, 'weighted avg': {'precision': 0.41169030883968794, 'recall': 0.3110796247313327, 'f1-score': 0.26675482816855367, 'support': 5644063}}
[[ 484937 1481883  108594]
 [ 260500 1089020   92760]
 [ 325439 1619134  181796]]
Evaluating performance on  train set...
5429/5429 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0981514
{'0': {'precision': 0.4418734439924483, 'recall': 0.22049928636078814, 'f1-score': 0.29419320753183376, 'support': 459616}, '1': {'precision': 0.3365656837739936, 'recall': 0.7850658742988789, 'f1-score': 0.47114621711430743, 'support': 458373}, '2': {'precision': 0.453847081127878, 'recall': 0.08777760350652598, 'f1-score': 0.14710411201707818, 'support': 471806}, 'accuracy': 0.36164470299576557, 'macro avg': {'precision': 0.41076206963144, 'recall': 0.3644475880553977, 'f1-score': 0.30414784555440644, 'support': 1389795}, 'weighted avg': {'precision': 0.4112063311216327, 'recall': 0.36164470299576557, 'f1-score': 0.30262104333705137, 'support': 1389795}}
[[101345 336685  21586]
 [ 70269 359853  28251]
 [ 57739 372653  41414]]
Evaluating performance on  val set...
1890/1890 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0890063
{'0': {'precision': 0.4195753598962102, 'recall': 0.21951155839239797, 'f1-score': 0.2882288417372228, 'support': 153222}, '1': {'precision': 0.36412441600069656, 'recall': 0.7759287499347686, 'f1-score': 0.49565162638062715, 'support': 172463}, '2': {'precision': 0.4493832648072008, 'recall': 0.10239141167981163, 'f1-score': 0.16678179999793794, 'support': 157982}, 'accuracy': 0.37965997266714496, 'macro avg': {'precision': 0.41102768023470254, 'recall': 0.36594390666899274, 'f1-score': 0.31688742270526266, 'support': 483667}, 'weighted avg': {'precision': 0.40953927369764, 'recall': 0.37965997266714496, 'f1-score': 0.32252166957104184, 'support': 483667}}
[[ 33634 111397   8191]
 [ 27015 133819  11629]
 [ 19513 122293  16176]]
training model: results/universal/W10/deepOF_L1/h30
Epoch 1/50
8543/8543 - 139s - loss: 3.0589 - accuracy30: 0.4629 - val_loss: 3.1772 - val_accuracy30: 0.3956 - 139s/epoch - 16ms/step
Epoch 2/50
8543/8543 - 141s - loss: 3.0427 - accuracy30: 0.4657 - val_loss: 3.1691 - val_accuracy30: 0.4002 - 141s/epoch - 17ms/step
Epoch 3/50
8543/8543 - 165s - loss: 3.0326 - accuracy30: 0.4679 - val_loss: 3.1672 - val_accuracy30: 0.4012 - 165s/epoch - 19ms/step
Epoch 4/50
8543/8543 - 161s - loss: 3.0248 - accuracy30: 0.4701 - val_loss: 3.1671 - val_accuracy30: 0.4003 - 161s/epoch - 19ms/step
Epoch 5/50
8543/8543 - 122s - loss: 3.0198 - accuracy30: 0.4709 - val_loss: 3.1637 - val_accuracy30: 0.4040 - 122s/epoch - 14ms/step
Epoch 6/50
8543/8543 - 123s - loss: 3.0145 - accuracy30: 0.4718 - val_loss: 3.1637 - val_accuracy30: 0.4036 - 123s/epoch - 14ms/step
Epoch 7/50
8543/8543 - 162s - loss: 3.0095 - accuracy30: 0.4732 - val_loss: 3.1631 - val_accuracy30: 0.3980 - 162s/epoch - 19ms/step
Epoch 8/50
8543/8543 - 126s - loss: 3.0049 - accuracy30: 0.4740 - val_loss: 3.1633 - val_accuracy30: 0.3928 - 126s/epoch - 15ms/step
Epoch 9/50
8543/8543 - 123s - loss: 3.0014 - accuracy30: 0.4748 - val_loss: 3.1665 - val_accuracy30: 0.3969 - 123s/epoch - 14ms/step
Epoch 10/50
8543/8543 - 123s - loss: 2.9977 - accuracy30: 0.4753 - val_loss: 3.1682 - val_accuracy30: 0.4040 - 123s/epoch - 14ms/step
Epoch 11/50
8543/8543 - 125s - loss: 2.9940 - accuracy30: 0.4762 - val_loss: 3.1633 - val_accuracy30: 0.4030 - 125s/epoch - 15ms/step
Epoch 12/50
8543/8543 - 123s - loss: 2.9908 - accuracy30: 0.4769 - val_loss: 3.1632 - val_accuracy30: 0.4044 - 123s/epoch - 14ms/step
Epoch 13/50
8543/8543 - 116s - loss: 2.9876 - accuracy30: 0.4777 - val_loss: 3.1664 - val_accuracy30: 0.4127 - 116s/epoch - 14ms/step
Epoch 14/50
8543/8543 - 120s - loss: 2.9845 - accuracy30: 0.4783 - val_loss: 3.1694 - val_accuracy30: 0.4159 - 120s/epoch - 14ms/step
Epoch 15/50
8543/8543 - 120s - loss: 2.9814 - accuracy30: 0.4790 - val_loss: 3.1815 - val_accuracy30: 0.4270 - 120s/epoch - 14ms/step
Epoch 16/50
8543/8543 - 121s - loss: 2.9788 - accuracy30: 0.4793 - val_loss: 3.1818 - val_accuracy30: 0.4273 - 121s/epoch - 14ms/step
Epoch 17/50
8543/8543 - 119s - loss: 2.9759 - accuracy30: 0.4800 - val_loss: 3.1978 - val_accuracy30: 0.4323 - 119s/epoch - 14ms/step
testing model in sample: results/universal/W10/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 260s - 260s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0826148
{'0': {'precision': 0.38205792447028514, 'recall': 0.4516832628855324, 'f1-score': 0.4139634038791104, 'support': 2946153}, '1': {'precision': 0.3877567361168708, 'recall': 0.37487351607688, 'f1-score': 0.3812063070734224, 'support': 3604213}, '2': {'precision': 0.38409101312856464, 'recall': 0.33059199542687406, 'f1-score': 0.35533911660319567, 'support': 2994888}, 'accuracy': 0.3846873011446317, 'macro avg': {'precision': 0.38463522457190685, 'recall': 0.3857162581297622, 'f1-score': 0.38350294251857614, 'support': 9545254}, 'weighted avg': {'precision': 0.3848476463411534, 'recall': 0.3846873011446317, 'f1-score': 0.38320081457341887, 'support': 9545254}}
[[1330728 1029515  585910]
 [1251347 1351124 1001742]
 [ 900978 1103824  990086]]
Evaluating performance on  train set...
8543/8543 - 47s - 47s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738037
{'0': {'precision': 0.3656247446212916, 'recall': 0.42245854938864347, 'f1-score': 0.39199231961223846, 'support': 624840}, '1': {'precision': 0.430817077931917, 'recall': 0.4219433780774197, 'f1-score': 0.4263340587970364, 'support': 923176}, '2': {'precision': 0.3708917842821058, 'recall': 0.3255320214937936, 'f1-score': 0.3467347074911614, 'support': 638696}, 'accuracy': 0.3939307050951383, 'macro avg': {'precision': 0.38911120227843815, 'recall': 0.38997798298661895, 'f1-score': 0.3883536953001454, 'support': 2186712}, 'weighted avg': {'precision': 0.3946857433534398, 'recall': 0.3939307050951383, 'f1-score': 0.39327168954407293, 'support': 2186712}}
[[263969 246064 114807]
 [295787 389528 237861]
 [162211 268569 207916]]
Evaluating performance on  val set...
3077/3077 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0667385
{'0': {'precision': 0.3394884619249104, 'recall': 0.44280867298647214, 'f1-score': 0.38432567015911934, 'support': 206019}, '1': {'precision': 0.48220683066634823, 'recall': 0.39860718583927196, 'f1-score': 0.4364397118177807, 'support': 369755}, '2': {'precision': 0.3519059514232892, 'recall': 0.3542456917984344, 'f1-score': 0.3530719454002237, 'support': 211167}, 'accuracy': 0.39827509305017783, 'macro avg': {'precision': 0.39120041467151595, 'recall': 0.3985538502080595, 'f1-score': 0.39127910912570796, 'support': 786941}, 'weighted avg': {'precision': 0.40987873824663523, 'recall': 0.39827509305017783, 'f1-score': 0.4004255711394173, 'support': 786941}}
[[ 91227  76145  38647]
 [123249 147387  99119]
 [ 54243  82119  74805]]
testing model out of sample: results/universal/W10/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 146s - 146s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0619475
{'0': {'precision': 0.3473760080223959, 'recall': 0.4963228239347632, 'f1-score': 0.40870186075501186, 'support': 1407058}, '1': {'precision': 0.5043257314104046, 'recall': 0.35475116229405645, 'f1-score': 0.416517172569164, 'support': 2650362}, '2': {'precision': 0.3377885155536277, 'recall': 0.3817739501223497, 'f1-score': 0.35843686139944947, 'support': 1403354}, 'accuracy': 0.39817395849013343, 'macro avg': {'precision': 0.3964967516621427, 'recall': 0.4109493121170565, 'f1-score': 0.3945519649078751, 'support': 5460774}, 'weighted avg': {'precision': 0.4210869758947293, 'recall': 0.39817395849013343, 'f1-score': 0.3995774797688648, 'support': 5460774}}
[[698355 444292 264411]
 [924225 940219 785918]
 [387792 479798 535764]]
Evaluating performance on  train set...
4055/4055 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.058966
{'0': {'precision': 0.32918460299017016, 'recall': 0.49062585449170376, 'f1-score': 0.3940093119174085, 'support': 252343}, '1': {'precision': 0.5239391187671957, 'recall': 0.36543606206527557, 'f1-score': 0.43056350671944504, 'support': 528927}, '2': {'precision': 0.3319052031580711, 'recall': 0.3788743993973482, 'f1-score': 0.3538379099548352, 'support': 256201}, 'accuracy': 0.3992044114968033, 'macro avg': {'precision': 0.39500964163847896, 'recall': 0.41164543865144254, 'f1-score': 0.39280357619722955, 'support': 1037471}, 'weighted avg': {'precision': 0.4291468595255443, 'recall': 0.3992044114968033, 'f1-score': 0.402725263726995, 'support': 1037471}}
[[123806  82574  45963]
 [186212 193289 149426]
 [ 66081  93052  97068]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0581262
{'0': {'precision': 0.3288574528341764, 'recall': 0.49137359340624637, 'f1-score': 0.39401548882652093, 'support': 94999}, '1': {'precision': 0.5307653711065653, 'recall': 0.3402816957171561, 'f1-score': 0.41469570907731146, 'support': 202062}, '2': {'precision': 0.33334143614176676, 'recall': 0.42045501001594376, 'f1-score': 0.3718645201529437, 'support': 97844}, 'accuracy': 0.39649282738886565, 'macro avg': {'precision': 0.39765475336083617, 'recall': 0.4173700997131154, 'f1-score': 0.39352523935225864, 'support': 394905}, 'weighted avg': {'precision': 0.43327914575957194, 'recall': 0.39649282738886565, 'f1-score': 0.39910873222789023, 'support': 394905}}
[[46680 29069 19250]
 [70279 68758 63025]
 [24987 31718 41139]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
518/518 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1138353
{'0': {'precision': 0.4260468296017775, 'recall': 0.4825583646289055, 'f1-score': 0.4525452036889115, 'support': 51658}, '1': {'precision': 0.26669005283813113, 'recall': 0.36914299587278465, 'f1-score': 0.3096623092295355, 'support': 32952}, '2': {'precision': 0.40408650470439544, 'recall': 0.23981664756745494, 'f1-score': 0.30099765948822554, 'support': 47995}, 'accuracy': 0.3665170996568757, 'macro avg': {'precision': 0.36560779571476804, 'recall': 0.36383933602304835, 'f1-score': 0.3544017241355575, 'support': 132605}, 'weighted avg': {'precision': 0.3784987710718161, 'recall': 0.3665170996568757, 'f1-score': 0.3621881166851237, 'support': 132605}}
[[24928 16936  9794]
 [13608 12164  7180]
 [19974 16511 11510]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1120304
{'0': {'precision': 0.36267683060910355, 'recall': 0.43033571055835795, 'f1-score': 0.39361998329422054, 'support': 11498}, '1': {'precision': 0.33789579341180764, 'recall': 0.3256529768709876, 'f1-score': 0.33166144200626957, 'support': 11371}, '2': {'precision': 0.35085914188702544, 'recall': 0.2977645826056584, 'f1-score': 0.32213877473902985, 'support': 11452}, 'accuracy': 0.3514174994901081, 'macro avg': {'precision': 0.35047725530264556, 'recall': 0.35125109001166804, 'f1-score': 0.34914006667983993, 'support': 34321}, 'weighted avg': {'precision': 0.35052329938286625, 'recall': 0.3514174994901081, 'f1-score': 0.34924093334348094, 'support': 34321}}
[[4948 3528 3022]
 [4381 3703 3287]
 [4314 3728 3410]]
Evaluating performance on  val set...
46/46 - 1s - 795ms/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1020366
{'0': {'precision': 0.37656452309020283, 'recall': 0.4361409647588103, 'f1-score': 0.404169079328315, 'support': 4001}, '1': {'precision': 0.33807626636311894, 'recall': 0.3096168881939015, 'f1-score': 0.32322133043123386, 'support': 3837}, '2': {'precision': 0.3655913978494624, 'recall': 0.33610822060353795, 'f1-score': 0.35023041474654376, 'support': 3844}, 'accuracy': 0.36166752268447183, 'macro avg': {'precision': 0.3600773957675947, 'recall': 0.3606220245187499, 'f1-score': 0.35920694150203086, 'support': 11682}, 'weighted avg': {'precision': 0.36031215752889245, 'recall': 0.36166752268447183, 'f1-score': 0.35983277226013927, 'support': 11682}}
[[1745 1218 1038]
 [1445 1188 1204]
 [1444 1108 1292]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0206388
{'0': {'precision': 0.2656923922532251, 'recall': 0.6102933531377646, 'f1-score': 0.37021219083659956, 'support': 67325}, '1': {'precision': 0.8064567929679045, 'recall': 0.34325994121894904, 'f1-score': 0.4815521999783213, 'support': 336503}, '2': {'precision': 0.23247134405620262, 'recall': 0.5993684273244556, 'f1-score': 0.33500678539018075, 'support': 67134}, 'accuracy': 0.4179403009159975, 'macro avg': {'precision': 0.4348735097591107, 'recall': 0.517640573893723, 'f1-score': 0.3955903920683672, 'support': 470962}, 'weighted avg': {'precision': 0.6473337588263942, 'recall': 0.4179403009159975, 'f1-score': 0.4447463728023992, 'support': 470962}}
[[ 41088  12637  13600]
 [101745 115508 119250]
 [ 11812  15084  40238]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0066285
{'0': {'precision': 0.19368426178418388, 'recall': 0.6110300330286504, 'f1-score': 0.29413395943872367, 'support': 13019}, '1': {'precision': 0.8646985568822797, 'recall': 0.4330193783875494, 'f1-score': 0.5770610414133205, 'support': 109039}, '2': {'precision': 0.1784608413261838, 'recall': 0.5313694625590285, 'f1-score': 0.26718679330619627, 'support': 13341}, 'accuracy': 0.4598261434722561, 'macro avg': {'precision': 0.4122812199975492, 'recall': 0.5251396246584094, 'f1-score': 0.3794605980527468, 'support': 135399}, 'weighted avg': {'precision': 0.7325629246315541, 'recall': 0.4598261434722561, 'f1-score': 0.5193245734613828, 'support': 135399}}
[[ 7955  3216  1848]
 [31037 47216 30786]
 [ 2080  4172  7089]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0184691
{'0': {'precision': 0.21674203386265642, 'recall': 0.6330824758101674, 'f1-score': 0.32292686748403776, 'support': 6511}, '1': {'precision': 0.8305560138590992, 'recall': 0.3797812146359864, 'f1-score': 0.5212259266928971, 'support': 39765}, '2': {'precision': 0.24223915370568605, 'recall': 0.5652365559800177, 'f1-score': 0.33913695067659894, 'support': 6806}, 'accuracy': 0.4346294412418522, 'macro avg': {'precision': 0.4298457338091472, 'recall': 0.5260334154753905, 'f1-score': 0.3944299149511779, 'support': 53082}, 'weighted avg': {'precision': 0.6798339729796867, 'recall': 0.4346294412418522, 'f1-score': 0.473555855006152, 'support': 53082}}
[[ 4122  1368  1021]
 [13650 15102 11013]
 [ 1246  1713  3847]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1067282
{'0': {'precision': 0.40334439647154424, 'recall': 0.4726926430767819, 'f1-score': 0.4352736704754962, 'support': 87156}, '1': {'precision': 0.3048542995479802, 'recall': 0.44630152751621677, 'f1-score': 0.362260225258219, 'support': 76464}, '2': {'precision': 0.4249499267585423, 'recall': 0.16939962342398168, 'f1-score': 0.2422357602351638, 'support': 83914}, 'accuracy': 0.3617240459896418, 'macro avg': {'precision': 0.3777162075926889, 'recall': 0.36279793133899346, 'f1-score': 0.34658988532295965, 'support': 247534}, 'weighted avg': {'precision': 0.380244780650444, 'recall': 0.3617240459896418, 'f1-score': 0.34727976549678163, 'support': 247534}}
[[41198 37108  8850]
 [31952 34126 10386]
 [28991 40708 14215]]
Evaluating performance on  train set...
220/220 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0998057
{'0': {'precision': 0.3886033191364371, 'recall': 0.4282246318174462, 'f1-score': 0.40745303356944873, 'support': 18537}, '1': {'precision': 0.3287214862428471, 'recall': 0.4523244525941107, 'f1-score': 0.3807426911203923, 'support': 18542}, '2': {'precision': 0.42228682170542636, 'recall': 0.22719215931602543, 'f1-score': 0.2954375974510203, 'support': 19182}, 'accuracy': 0.36762588649330796, 'macro avg': {'precision': 0.3798705423615702, 'recall': 0.3692470812425275, 'f1-score': 0.3612111073802871, 'support': 56261}, 'weighted avg': {'precision': 0.3803522749098042, 'recall': 0.36762588649330796, 'f1-score': 0.360458787727496, 'support': 56261}}
[[7938 7970 2629]
 [6822 8387 3333]
 [5667 9157 4358]]
Evaluating performance on  val set...
79/79 - 1s - 662ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0989786
{'0': {'precision': 0.40733118971061094, 'recall': 0.4561428777185655, 'f1-score': 0.43035738551433617, 'support': 6943}, '1': {'precision': 0.3142723771735325, 'recall': 0.42536724056231245, 'f1-score': 0.3614765100671141, 'support': 6331}, '2': {'precision': 0.4120206690236606, 'recall': 0.22454424188528235, 'f1-score': 0.29067536454336146, 'support': 6747}, 'accuracy': 0.3683632186204485, 'macro avg': {'precision': 0.3778747453026013, 'recall': 0.36868478672205346, 'f1-score': 0.36083642004160393, 'support': 20021}, 'weighted avg': {'precision': 0.37948465730727954, 'recall': 0.3683632186204485, 'f1-score': 0.36150371097522577, 'support': 20021}}
[[3167 2801  975]
 [2451 2693 1187]
 [2157 3075 1515]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1588/1588 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1068826
{'0': {'precision': 0.40213591269137766, 'recall': 0.4005424571614234, 'f1-score': 0.40133760328385143, 'support': 141578}, '1': {'precision': 0.31257714046583573, 'recall': 0.47723725180961624, 'f1-score': 0.3777430671139222, 'support': 123645}, '2': {'precision': 0.3975158527815912, 'recall': 0.21554254278381943, 'f1-score': 0.2795217497230433, 'support': 141058}, 'accuracy': 0.35965255574343863, 'macro avg': {'precision': 0.3707429686462682, 'recall': 0.364440750584953, 'f1-score': 0.35286747337360563, 'support': 406281}, 'weighted avg': {'precision': 0.3732761067871345, 'recall': 0.35965255574343863, 'f1-score': 0.35186335492788257, 'support': 406281}}
[[56708 61705 23165]
 [41721 59008 22916]
 [42588 68066 30404]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0973363
{'0': {'precision': 0.38760023858439924, 'recall': 0.44749225295535405, 'f1-score': 0.41539854750785726, 'support': 26139}, '1': {'precision': 0.3426734327229174, 'recall': 0.435611827870823, 'f1-score': 0.3835935432654141, 'support': 24958}, '2': {'precision': 0.40499153353456524, 'recall': 0.22553400844573818, 'f1-score': 0.2897245483752041, 'support': 24391}, 'accuracy': 0.3718471810089021, 'macro avg': {'precision': 0.378421734947294, 'recall': 0.36954602975730505, 'f1-score': 0.3629055463828252, 'support': 75488}, 'weighted avg': {'precision': 0.378365762302588, 'recall': 0.3718471810089021, 'f1-score': 0.3642764644121674, 'support': 75488}}
[[11697 10344  4098]
 [10102 10872  3984]
 [ 8379 10511  5501]]
Evaluating performance on  val set...
131/131 - 1s - 820ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1074162
{'0': {'precision': 0.3946156289707751, 'recall': 0.4372195336559613, 'f1-score': 0.41482656426096753, 'support': 11365}, '1': {'precision': 0.30313207841912054, 'recall': 0.34085719304408924, 'f1-score': 0.3208896605895241, 'support': 11386}, '2': {'precision': 0.3123507978389245, 'recall': 0.23446194473262283, 'f1-score': 0.26785906691089323, 'support': 10603}, 'accuracy': 0.33986928104575165, 'macro avg': {'precision': 0.3366995017429401, 'recall': 0.3375128904775578, 'f1-score': 0.334525097253795, 'support': 33354}, 'weighted avg': {'precision': 0.337234633855582, 'recall': 0.33986928104575165, 'f1-score': 0.3360395534195124, 'support': 33354}}
[[4969 4394 2002]
 [4034 3881 3471]
 [3589 4528 2486]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
2104/2104 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1193413
{'0': {'precision': 0.45846280436971515, 'recall': 0.399926333087777, 'f1-score': 0.4271986683144594, 'support': 211764}, '1': {'precision': 0.21388586227043757, 'recall': 0.46168332609010576, 'f1-score': 0.2923387803884433, 'support': 117351}, '2': {'precision': 0.4633214619685243, 'recall': 0.22237288782998554, 'f1-score': 0.30051328706974706, 'support': 209441}, 'accuracy': 0.3443337368815871, 'macro avg': {'precision': 0.37855670953622567, 'recall': 0.36132751566928945, 'f1-score': 0.3400169119242166, 'support': 538556}, 'weighted avg': {'precision': 0.4070591497337253, 'recall': 0.3443337368815871, 'f1-score': 0.3485456486818127, 'support': 538556}}
[[ 84690  95406  31668]
 [ 40892  54179  22280]
 [ 59144 103723  46574]]
Evaluating performance on  train set...
428/428 - 15s - 15s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1042205
{'0': {'precision': 0.38797653094318485, 'recall': 0.36385002488525137, 'f1-score': 0.37552616183667936, 'support': 36166}, '1': {'precision': 0.3298733350270388, 'recall': 0.5009231447546089, 'f1-score': 0.39778981344712516, 'support': 36289}, '2': {'precision': 0.40205178309721545, 'recall': 0.22220422269021006, 'f1-score': 0.2862210475064339, 'support': 37038}, 'accuracy': 0.36136556674855924, 'macro avg': {'precision': 0.3733005496891464, 'recall': 0.36232579744335675, 'f1-score': 0.3531790075967462, 'support': 109493}, 'weighted avg': {'precision': 0.37348073954720484, 'recall': 0.36136556674855924, 'f1-score': 0.3526958697515948, 'support': 109493}}
[[13159 17495  5512]
 [11383 18178  6728]
 [ 9375 19433  8230]]
Evaluating performance on  val set...
141/141 - 1s - 853ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1082093
{'0': {'precision': 0.38360473723168026, 'recall': 0.3470617780010045, 'f1-score': 0.36441944273534327, 'support': 11946}, '1': {'precision': 0.3205921343349536, 'recall': 0.502946273830156, 'f1-score': 0.3915800836594252, 'support': 11540}, '2': {'precision': 0.40237108984430797, 'recall': 0.22668383358815483, 'f1-score': 0.28999382334774554, 'support': 12427}, 'accuracy': 0.35549800907749285, 'macro avg': {'precision': 0.3688559871369806, 'recall': 0.3588972951397718, 'f1-score': 0.34866444991417134, 'support': 35913}, 'weighted avg': {'precision': 0.36985049855735336, 'recall': 0.35549800907749285, 'f1-score': 0.3473934806640663, 'support': 35913}}
[[4146 5882 1918]
 [3470 5804 2266]
 [3192 6418 2817]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/EXC
Evaluating performance on  test set...
5267/5267 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0276788
{'0': {'precision': 0.2974873569664087, 'recall': 0.6006256043238597, 'f1-score': 0.39789766155909745, 'support': 242006}, '1': {'precision': 0.7425834294152657, 'recall': 0.34558539765319424, 'f1-score': 0.4716657624469924, 'support': 862875}, '2': {'precision': 0.3001454123072086, 'recall': 0.5650115288344163, 'f1-score': 0.3920343471013573, 'support': 243303}, 'accuracy': 0.4309656545397364, 'macro avg': {'precision': 0.44673873289629434, 'recall': 0.5037408436038234, 'f1-score': 0.4205325903691491, 'support': 1348184}, 'weighted avg': {'precision': 0.5828408297511993, 'recall': 0.4309656545397364, 'f1-score': 0.4440531477954946, 'support': 1348184}}
[[145355  49464  47187]
 [291326 298197 273352]
 [ 51928  53906 137469]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0174458
{'0': {'precision': 0.2544708646990879, 'recall': 0.6805677611781311, 'f1-score': 0.3704331818610079, 'support': 37551}, '1': {'precision': 0.8288693945156739, 'recall': 0.3454487812111698, 'f1-score': 0.48765645978604527, 'support': 195563}, '2': {'precision': 0.2659046894065757, 'recall': 0.6226538743839782, 'f1-score': 0.37266330396855907, 'support': 38148}, 'accuracy': 0.4308233368477708, 'macro avg': {'precision': 0.44974831620711253, 'recall': 0.549556805591093, 'f1-score': 0.41025098187187076, 'support': 271262}, 'weighted avg': {'precision': 0.6701843713143243, 'recall': 0.4308233368477708, 'f1-score': 0.4552574867729121, 'support': 271262}}
[[25556  6290  5705]
 [68135 67557 59871]
 [ 6737  7658 23753]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0225623
{'0': {'precision': 0.25797484380590646, 'recall': 0.6892925430210325, 'f1-score': 0.37543810458432636, 'support': 13598}, '1': {'precision': 0.8415148196090145, 'recall': 0.3333289510011438, 'f1-score': 0.47751243031490126, 'support': 76063}, '2': {'precision': 0.2404991338241663, 'recall': 0.6464168788650418, 'f1-score': 0.3505691570163152, 'support': 13745}, 'accuracy': 0.42175502388642827, 'macro avg': {'precision': 0.44666293241302907, 'recall': 0.5563461242957394, 'f1-score': 0.4011732306385143, 'support': 103406}, 'weighted avg': {'precision': 0.6848900861111188, 'recall': 0.42175502388642827, 'f1-score': 0.44721591006681677, 'support': 103406}}
[[ 9373  2197  2028]
 [24678 25354 26031]
 [ 2282  2578  8885]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/AAL
Evaluating performance on  test set...
10110/10110 - 85s - 85s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0354768
{'0': {'precision': 0.2959781280529007, 'recall': 0.6215641789030675, 'f1-score': 0.401004729137349, 'support': 474268}, '1': {'precision': 0.7381281620407807, 'recall': 0.30015873200207077, 'f1-score': 0.4267714722093677, 'support': 1636091}, '2': {'precision': 0.2953669765850995, 'recall': 0.5730077427538582, 'f1-score': 0.3898030671963775, 'support': 477737}, 'accuracy': 0.4094214434085907, 'macro avg': {'precision': 0.44315775555959364, 'recall': 0.49824355121966546, 'f1-score': 0.4058597561810314, 'support': 2588096}, 'weighted avg': {'precision': 0.5753749207485703, 'recall': 0.4094214434085907, 'f1-score': 0.4152257194208424, 'support': 2588096}}
[[294788  81103  98377]
 [590325 491087 554679]
 [110866  93124 273747]]
Evaluating performance on  train set...
1686/1686 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0327281
{'0': {'precision': 0.26781559262322885, 'recall': 0.6477632563763026, 'f1-score': 0.3789539275083468, 'support': 69476}, '1': {'precision': 0.7763148806851539, 'recall': 0.30709097056442936, 'f1-score': 0.4400923068640382, 'support': 292809}, '2': {'precision': 0.2708179583877804, 'recall': 0.5773444378689684, 'f1-score': 0.3686917567679672, 'support': 69281}, 'accuracy': 0.40531923274771414, 'macro avg': {'precision': 0.43831614389872103, 'recall': 0.5107328882699002, 'f1-score': 0.39591266371345074, 'support': 431566}, 'weighted avg': {'precision': 0.6133042894637076, 'recall': 0.40531923274771414, 'f1-score': 0.41878768241419295, 'support': 431566}}
[[ 45004  11976  12496]
 [107688  89919  95202]
 [ 15349  13933  39999]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0389978
{'0': {'precision': 0.28762344036425996, 'recall': 0.5894864414482655, 'f1-score': 0.3866108952895707, 'support': 33005}, '1': {'precision': 0.7027790761908809, 'recall': 0.29286972844228404, 'f1-score': 0.4134444118069835, 'support': 112941}, '2': {'precision': 0.29771399001582854, 'recall': 0.567511895091099, 'f1-score': 0.39054825699796347, 'support': 34468}, 'accuracy': 0.3996031350116953, 'macro avg': {'precision': 0.4293721688569898, 'recall': 0.4832893549938828, 'f1-score': 0.39686785469817254, 'support': 180414}, 'weighted avg': {'precision': 0.5494428874763724, 'recall': 0.3996031350116953, 'f1-score': 0.40416118059092204, 'support': 180414}}
[[19456  6822  6727]
 [40448 33077 39416]
 [ 7740  7167 19561]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/WBA
Evaluating performance on  test set...
6546/6546 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0609914
{'0': {'precision': 0.36231423983051136, 'recall': 0.4687561085426253, 'f1-score': 0.40871874075400405, 'support': 455305}, '1': {'precision': 0.49983529534145876, 'recall': 0.37410512574629623, 'f1-score': 0.42792607254259774, 'support': 770639}, '2': {'precision': 0.36039050181601384, 'recall': 0.40853230180961275, 'f1-score': 0.3829543370621676, 'support': 449820}, 'accuracy': 0.40906297068083575, 'macro avg': {'precision': 0.40751334566266134, 'recall': 0.4171311786995114, 'f1-score': 0.4065330501195898, 'support': 1675764}, 'weighted avg': {'precision': 0.4250401086665883, 'recall': 0.40906297068083575, 'f1-score': 0.4106358214966194, 'support': 1675764}}
[[213427 143776  98102]
 [254299 288300 228040]
 [121340 144714 183766]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0551316
{'0': {'precision': 0.3851894477512633, 'recall': 0.4744921693285781, 'f1-score': 0.4252024773701763, 'support': 90286}, '1': {'precision': 0.4762578090855336, 'recall': 0.4102717427413461, 'f1-score': 0.4408090422367639, 'support': 135459}, '2': {'precision': 0.3980934618174283, 'recall': 0.3884164766408681, 'f1-score': 0.39319543785037697, 'support': 89023}, 'accuracy': 0.42251118283942457, 'macro avg': {'precision': 0.419846906218075, 'recall': 0.4243934629035975, 'f1-score': 0.41973565248577244, 'support': 314768}, 'weighted avg': {'precision': 0.428029835599428, 'recall': 0.42251118283942457, 'f1-score': 0.4228664298402241, 'support': 314768}}
[[42840 29770 17676]
 [45279 55575 34605]
 [23099 31346 34578]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0443529
{'0': {'precision': 0.34853389631714754, 'recall': 0.5188211467281235, 'f1-score': 0.4169613290677443, 'support': 28638}, '1': {'precision': 0.5583025552121806, 'recall': 0.3909463572547019, 'f1-score': 0.45987168874172185, 'support': 56839}, '2': {'precision': 0.36724621786393985, 'recall': 0.4072616705419424, 'f1-score': 0.3862202320374516, 'support': 27955}, 'accuracy': 0.427251569222089, 'macro avg': {'precision': 0.4246942231310893, 'recall': 0.43900972484158923, 'f1-score': 0.4210177499489725, 'support': 113432}, 'weighted avg': {'precision': 0.4582572878801576, 'recall': 0.427251569222089, 'f1-score': 0.4308869811414746, 'support': 113432}}
[[14858  8412  5368]
 [20370 22221 14248]
 [ 7402  9168 11385]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
7633/7633 - 64s - 64s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0719761
{'0': {'precision': 0.3782691841516955, 'recall': 0.4341923560489993, 'f1-score': 0.40430612444002306, 'support': 582212}, '1': {'precision': 0.44274159378702654, 'recall': 0.4431812409841728, 'f1-score': 0.44296130829615615, 'support': 787504}, '2': {'precision': 0.3819597877811307, 'recall': 0.3251783859091819, 'f1-score': 0.35128938556575984, 'support': 584267}, 'accuracy': 0.4052184691473774, 'macro avg': {'precision': 0.4009901885732843, 'recall': 0.40085066098078465, 'f1-score': 0.3995189394339797, 'support': 1953983}, 'weighted avg': {'precision': 0.40535671684170405, 'recall': 0.4052184691473774, 'f1-score': 0.40403241731748984, 'support': 1953983}}
[[252792 213795 115625]
 [246702 349007 191795]
 [168792 225484 189991]]
Evaluating performance on  train set...
1586/1586 - 42s - 42s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0643044
{'0': {'precision': 0.3771861487331594, 'recall': 0.45235115629232164, 'f1-score': 0.4113632731963785, 'support': 116666}, '1': {'precision': 0.4528192042808304, 'recall': 0.43029496927893784, 'f1-score': 0.44126984126984126, 'support': 169916}, '2': {'precision': 0.3927774746053173, 'recall': 0.34403931302831076, 'f1-score': 0.36679645416385415, 'support': 119248}, 'accuracy': 0.41129044181061036, 'macro avg': {'precision': 0.4075942758731024, 'recall': 0.40889514619985673, 'f1-score': 0.40647652287669134, 'support': 405830}, 'weighted avg': {'precision': 0.4134340867713555, 'recall': 0.41129044181061036, 'f1-score': 0.4107893885273793, 'support': 405830}}
[[52774 41482 22410]
 [55787 73114 41015]
 [31354 46868 41026]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0599307
{'0': {'precision': 0.3539027780496877, 'recall': 0.4622800736497545, 'f1-score': 0.4008959560005766, 'support': 39104}, '1': {'precision': 0.49888721918928686, 'recall': 0.38904958984172194, 'f1-score': 0.4371749566608881, 'support': 67413}, '2': {'precision': 0.3686524002313476, 'recall': 0.3948411715149413, 'f1-score': 0.38129763229364816, 'support': 40358}, 'accuracy': 0.41013787234042554, 'macro avg': {'precision': 0.4071474658234407, 'recall': 0.4153902783354726, 'f1-score': 0.4064561816517043, 'support': 146875}, 'weighted avg': {'precision': 0.424500915122377, 'recall': 0.41013787234042554, 'f1-score': 0.4121621832233808, 'support': 146875}}
[[18077 12550  8477]
 [22373 26227 18813]
 [10629 13794 15935]]
testing model on single stock: results/universal/W10/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
22048/22048 - 138s - 138s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1055642
{'0': {'precision': 0.4141751795765972, 'recall': 0.42850546021229063, 'f1-score': 0.42121847246292515, 'support': 2039939}, '1': {'precision': 0.2713788599137663, 'recall': 0.39046281787241877, 'f1-score': 0.32020755993298494, 'support': 1510551}, '2': {'precision': 0.43967265278874473, 'recall': 0.28564516260001444, 'f1-score': 0.34630437508089107, 'support': 2093573}, 'accuracy': 0.36533220837542035, 'macro avg': {'precision': 0.3750755640930361, 'recall': 0.3682044802282413, 'f1-score': 0.3625768024922671, 'support': 5644063}, 'weighted avg': {'precision': 0.3854157022323802, 'recall': 0.36533220837542035, 'f1-score': 0.36639621648679394, 'support': 5644063}}
[[874125 761739 404075]
 [562685 589814 358052]
 [673710 821844 598019]]
Evaluating performance on  train set...
5429/5429 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.094205
{'0': {'precision': 0.3994238673756362, 'recall': 0.38310126789634047, 'f1-score': 0.39109233204753724, 'support': 457845}, '1': {'precision': 0.33633163485174467, 'recall': 0.4548266205689316, 'f1-score': 0.38670539003275406, 'support': 458157}, '2': {'precision': 0.41427177750863065, 'recall': 0.28949351298985, 'f1-score': 0.3408209919491105, 'support': 473793}, 'accuracy': 0.37483441802568007, 'macro avg': {'precision': 0.38334242657867046, 'recall': 0.375807133818374, 'f1-score': 0.3728729046764672, 'support': 1389795}, 'weighted avg': {'precision': 0.3836867895398354, 'recall': 0.37483441802568007, 'f1-score': 0.372508211920525, 'support': 1389795}}
[[175401 196948  85496]
 [141344 208382 108431]
 [122390 214243 137160]]
Evaluating performance on  val set...
1890/1890 - 21s - 21s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843031
{'0': {'precision': 0.3656361775002844, 'recall': 0.39654711562844824, 'f1-score': 0.3804648379577115, 'support': 145907}, '1': {'precision': 0.39443563148261135, 'recall': 0.43515955670913614, 'f1-score': 0.4137980475040773, 'support': 185702}, '2': {'precision': 0.3975114060555786, 'recall': 0.3151429059963961, 'f1-score': 0.3515670853386548, 'support': 152058}, 'accuracy': 0.3857798857478389, 'macro avg': {'precision': 0.38586107167949146, 'recall': 0.3822831927779935, 'f1-score': 0.3819433236001479, 'support': 483667}, 'weighted avg': {'precision': 0.38671472887361974, 'recall': 0.3857798857478389, 'f1-score': 0.38417794886135115, 'support': 483667}}
[[57859 59695 28353]
 [60615 80810 44277]
 [39768 64370 47920]]
training model: results/universal/W10/deepLOB_L2/h10
Epoch 1/50
8543/8543 - 414s - loss: 2.8932 - accuracy10: 0.5063 - val_loss: 3.7896 - val_accuracy10: 0.4937 - 414s/epoch - 48ms/step
Epoch 2/50
8543/8543 - 349s - loss: 2.8192 - accuracy10: 0.5233 - val_loss: 3.8501 - val_accuracy10: 0.4996 - 349s/epoch - 41ms/step
Epoch 3/50
8543/8543 - 351s - loss: 2.7665 - accuracy10: 0.5344 - val_loss: 4.0097 - val_accuracy10: 0.4914 - 351s/epoch - 41ms/step
Epoch 4/50
8543/8543 - 371s - loss: 2.7373 - accuracy10: 0.5399 - val_loss: 3.5292 - val_accuracy10: 0.4977 - 371s/epoch - 43ms/step
Epoch 5/50
8543/8543 - 389s - loss: 2.7195 - accuracy10: 0.5439 - val_loss: 3.3373 - val_accuracy10: 0.5091 - 389s/epoch - 46ms/step
Epoch 6/50
8543/8543 - 358s - loss: 2.7080 - accuracy10: 0.5460 - val_loss: 3.4763 - val_accuracy10: 0.5179 - 358s/epoch - 42ms/step
Epoch 7/50
8543/8543 - 365s - loss: 2.7000 - accuracy10: 0.5478 - val_loss: 3.2529 - val_accuracy10: 0.5150 - 365s/epoch - 43ms/step
Epoch 8/50
8543/8543 - 381s - loss: 2.6935 - accuracy10: 0.5491 - val_loss: 3.2088 - val_accuracy10: 0.5149 - 381s/epoch - 45ms/step
Epoch 9/50
8543/8543 - 369s - loss: 2.6882 - accuracy10: 0.5500 - val_loss: 3.1916 - val_accuracy10: 0.5138 - 369s/epoch - 43ms/step
Epoch 10/50
8543/8543 - 358s - loss: 2.6833 - accuracy10: 0.5511 - val_loss: 3.1379 - val_accuracy10: 0.5146 - 358s/epoch - 42ms/step
Epoch 11/50
8543/8543 - 357s - loss: 2.6794 - accuracy10: 0.5518 - val_loss: 3.1842 - val_accuracy10: 0.5082 - 357s/epoch - 42ms/step
Epoch 12/50
8543/8543 - 368s - loss: 2.6751 - accuracy10: 0.5528 - val_loss: 3.1041 - val_accuracy10: 0.5130 - 368s/epoch - 43ms/step
Epoch 13/50
8543/8543 - 362s - loss: 2.6716 - accuracy10: 0.5534 - val_loss: 3.1296 - val_accuracy10: 0.5130 - 362s/epoch - 42ms/step
Epoch 14/50
8543/8543 - 359s - loss: 2.6686 - accuracy10: 0.5541 - val_loss: 3.1230 - val_accuracy10: 0.5108 - 359s/epoch - 42ms/step
Epoch 15/50
8543/8543 - 392s - loss: 2.6657 - accuracy10: 0.5547 - val_loss: 3.1007 - val_accuracy10: 0.5132 - 392s/epoch - 46ms/step
Epoch 16/50
8543/8543 - 356s - loss: 2.6626 - accuracy10: 0.5553 - val_loss: 3.1243 - val_accuracy10: 0.5106 - 356s/epoch - 42ms/step
Epoch 17/50
8543/8543 - 394s - loss: 2.6602 - accuracy10: 0.5555 - val_loss: 3.0772 - val_accuracy10: 0.5085 - 394s/epoch - 46ms/step
Epoch 18/50
8543/8543 - 375s - loss: 2.6575 - accuracy10: 0.5566 - val_loss: 3.0719 - val_accuracy10: 0.5138 - 375s/epoch - 44ms/step
Epoch 19/50
8543/8543 - 364s - loss: 2.6555 - accuracy10: 0.5568 - val_loss: 3.1042 - val_accuracy10: 0.5088 - 364s/epoch - 43ms/step
Epoch 20/50
8543/8543 - 360s - loss: 2.6532 - accuracy10: 0.5574 - val_loss: 3.0955 - val_accuracy10: 0.5080 - 360s/epoch - 42ms/step
Epoch 21/50
8543/8543 - 373s - loss: 2.6508 - accuracy10: 0.5576 - val_loss: 3.0700 - val_accuracy10: 0.5059 - 373s/epoch - 44ms/step
Epoch 22/50
8543/8543 - 358s - loss: 2.6488 - accuracy10: 0.5584 - val_loss: 3.0830 - val_accuracy10: 0.5065 - 358s/epoch - 42ms/step
Epoch 23/50
8543/8543 - 364s - loss: 2.6470 - accuracy10: 0.5588 - val_loss: 3.0938 - val_accuracy10: 0.5077 - 364s/epoch - 43ms/step
Epoch 24/50
8543/8543 - 359s - loss: 2.6451 - accuracy10: 0.5592 - val_loss: 3.0881 - val_accuracy10: 0.5052 - 359s/epoch - 42ms/step
Epoch 25/50
8543/8543 - 349s - loss: 2.6429 - accuracy10: 0.5594 - val_loss: 3.1056 - val_accuracy10: 0.4952 - 349s/epoch - 41ms/step
Epoch 26/50
8543/8543 - 355s - loss: 2.6416 - accuracy10: 0.5599 - val_loss: 3.1109 - val_accuracy10: 0.5047 - 355s/epoch - 42ms/step
Epoch 27/50
8543/8543 - 351s - loss: 2.6398 - accuracy10: 0.5602 - val_loss: 3.1448 - val_accuracy10: 0.5093 - 351s/epoch - 41ms/step
Epoch 28/50
8543/8543 - 350s - loss: 2.6385 - accuracy10: 0.5605 - val_loss: 3.1280 - val_accuracy10: 0.5013 - 350s/epoch - 41ms/step
Epoch 29/50
8543/8543 - 352s - loss: 2.6372 - accuracy10: 0.5606 - val_loss: 3.1247 - val_accuracy10: 0.5018 - 352s/epoch - 41ms/step
Epoch 30/50
8543/8543 - 358s - loss: 2.6357 - accuracy10: 0.5611 - val_loss: 3.1773 - val_accuracy10: 0.5055 - 358s/epoch - 42ms/step
Epoch 31/50
8543/8543 - 349s - loss: 2.6342 - accuracy10: 0.5613 - val_loss: 3.1657 - val_accuracy10: 0.5037 - 349s/epoch - 41ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 532s - 532s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0099465
{'0': {'precision': 0.42224306240131204, 'recall': 0.5208927258854131, 'f1-score': 0.4664086391207084, 'support': 2787597}, '1': {'precision': 0.6397338419768119, 'recall': 0.553134145107636, 'f1-score': 0.5932905159826647, 'support': 3943707}, '2': {'precision': 0.43213136761534626, 'recall': 0.4140996277507796, 'f1-score': 0.4229233848649767, 'support': 2813975}, 'accuracy': 0.5027306168840114, 'macro avg': {'precision': 0.49803609066449006, 'recall': 0.4960421662479429, 'f1-score': 0.49420751332278323, 'support': 9545279}, 'weighted avg': {'precision': 0.5150161865302157, 'recall': 0.5027306168840114, 'f1-score': 0.5060113084203027, 'support': 9545279}}
[[1452039  599479  736079]
 [ 967098 2181399  795210]
 [1019733  628976 1165266]]
Evaluating performance on  train set...
8543/8543 - 130s - 130s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0082644
{'0': {'precision': 0.3974044112563092, 'recall': 0.4960130206805135, 'f1-score': 0.4412668824508498, 'support': 579386}, '1': {'precision': 0.6109861545965323, 'recall': 0.5989916364102178, 'f1-score': 0.6049294446326271, 'support': 1022647}, '2': {'precision': 0.42057791882411893, 'recall': 0.33160648346893296, 'f1-score': 0.3708302492335175, 'support': 584687}, 'accuracy': 0.5002131045584254, 'macro avg': {'precision': 0.47632282822565347, 'recall': 0.4755370468532214, 'f1-score': 0.4723421921056648, 'support': 2186720}, 'weighted avg': {'precision': 0.5034847405627357, 'recall': 0.5002131045584254, 'f1-score': 0.49897232460236696, 'support': 2186720}}
[[287383 179634 112369]
 [255346 612557 154744]
 [180421 210380 193886]]
Evaluating performance on  val set...
3077/3077 - 43s - 43s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99238956
{'0': {'precision': 0.37964635154550636, 'recall': 0.483348150873213, 'f1-score': 0.4252665839492187, 'support': 195714}, '1': {'precision': 0.636276102623078, 'recall': 0.5956897887046766, 'f1-score': 0.6153144008246579, 'support': 393809}, '2': {'precision': 0.40605039034776436, 'recall': 0.34776111842771756, 'f1-score': 0.3746521145975443, 'support': 197420}, 'accuracy': 0.5055524987197294, 'macro avg': {'precision': 0.47399094817211623, 'recall': 0.475599686001869, 'f1-score': 0.4717443664571403, 'support': 786943}, 'weighted avg': {'precision': 0.5146952572253958, 'recall': 0.5055524987197294, 'f1-score': 0.5076743722852128, 'support': 786943}}
[[ 94598  62270  38846]
 [ 97642 234588  61579]
 [ 56934  71831  68655]]
testing model out of sample: results/universal/W10/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 313s - 313s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7810583
{'0': {'precision': 0.4596131108106088, 'recall': 0.5026899776384867, 'f1-score': 0.4801873903742793, 'support': 1076403}, '1': {'precision': 0.7741184818883075, 'recall': 0.801803940041792, 'f1-score': 0.7877180249482438, 'support': 3311640}, '2': {'precision': 0.49021365448294774, 'recall': 0.38999082736428414, 'f1-score': 0.4343963991091222, 'support': 1072756}, 'accuracy': 0.6619448912146373, 'macro avg': {'precision': 0.574648415727288, 'recall': 0.5648282483481877, 'f1-score': 0.5674339381438818, 'support': 5460799}, 'weighted avg': {'precision': 0.6563527241718612, 'recall': 0.6619448912146373, 'f1-score': 0.6576903876563398, 'support': 5460799}}
[[ 541097  353440  181866]
 [ 403151 2655286  253203]
 [ 233040  421351  418365]]
Evaluating performance on  train set...
4055/4055 - 62s - 62s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7957667
{'0': {'precision': 0.4270038857570424, 'recall': 0.5229373083351122, 'f1-score': 0.4701264963665937, 'support': 192067}, '1': {'precision': 0.7841600935967012, 'recall': 0.7575726395970268, 'f1-score': 0.7706371139206494, 'support': 651160}, '2': {'precision': 0.4605728144127497, 'recall': 0.4106088451658404, 'f1-score': 0.43415806419129466, 'support': 194253}, 'accuracy': 0.6491710683579442, 'macro avg': {'precision': 0.5572455979221644, 'recall': 0.563706264365993, 'f1-score': 0.5583072248261792, 'support': 1037480}, 'weighted avg': {'precision': 0.6574533415489895, 'recall': 0.6491710683579442, 'f1-score': 0.6520032726621855, 'support': 1037480}}
[[100439  60761  30867]
 [ 95308 493301  62551]
 [ 39471  75020  79762]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8172797
{'0': {'precision': 0.3896645113578446, 'recall': 0.5444681831511039, 'f1-score': 0.45423938115985923, 'support': 71613}, '1': {'precision': 0.7897466137116496, 'recall': 0.7280663535525133, 'f1-score': 0.7576532150886731, 'support': 250175}, '2': {'precision': 0.44474036694389935, 'recall': 0.39053845206997007, 'f1-score': 0.4158808065655426, 'support': 73117}, 'accuracy': 0.6322786492954001, 'macro avg': {'precision': 0.5413838306711312, 'recall': 0.554357662924529, 'f1-score': 0.5425911342713583, 'support': 394905}, 'weighted avg': {'precision': 0.6533165828414894, 'recall': 0.6322786492954001, 'f1-score': 0.6393519829363077, 'support': 394905}}
[[ 38991  21280  11342]
 [ 43722 182144  24309]
 [ 17350  27212  28555]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1274494
{'0': {'precision': 0.5459336109346696, 'recall': 0.45630800692150386, 'f1-score': 0.49711341752085947, 'support': 50856}, '1': {'precision': 0.3658476708741638, 'recall': 0.5116006293806322, 'f1-score': 0.4266186363853237, 'support': 34955}, '2': {'precision': 0.4910969870457523, 'recall': 0.4325733455843074, 'f1-score': 0.45998114086411196, 'support': 46799}, 'accuracy': 0.46250659829575447, 'macro avg': {'precision': 0.46762608961819524, 'recall': 0.4668273272954811, 'f1-score': 0.4612377315900984, 'support': 132610}, 'weighted avg': {'precision': 0.47911208015876716, 'recall': 0.46250659829575447, 'f1-score': 0.4654272815593801, 'support': 132610}}
[[23206 15139 12511]
 [ 8605 17883  8467]
 [10696 15859 20244]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1003035
{'0': {'precision': 0.5031122349737405, 'recall': 0.46515601115007643, 'f1-score': 0.4833901789468766, 'support': 11121}, '1': {'precision': 0.4371123790622674, 'recall': 0.6120712114633087, 'f1-score': 0.5100039798834979, 'support': 11515}, '2': {'precision': 0.5239358342806618, 'recall': 0.35492427483528705, 'f1-score': 0.4231789430728422, 'support': 11687}, 'accuracy': 0.4769105264691315, 'macro avg': {'precision': 0.4880534827722232, 'recall': 0.47738383248289074, 'f1-score': 0.47219103396773887, 'support': 34323}, 'weighted avg': {'precision': 0.48806043484785927, 'recall': 0.4769105264691315, 'f1-score': 0.4718168667109227, 'support': 34323}}
[[5173 3960 1988]
 [2686 7048 1781]
 [2423 5116 4148]]
Evaluating performance on  val set...
46/46 - 1s - 923ms/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1069307
{'0': {'precision': 0.5022261798753339, 'recall': 0.44714587737843553, 'f1-score': 0.47308821473507623, 'support': 3784}, '1': {'precision': 0.4476140165522099, 'recall': 0.6216678894595256, 'f1-score': 0.5204750204750205, 'support': 4089}, '2': {'precision': 0.5117691723614275, 'recall': 0.35389866106589657, 'f1-score': 0.41843861555176165, 'support': 3809}, 'accuracy': 0.477829138846088, 'macro avg': {'precision': 0.4872031229296571, 'recall': 0.47423747596795257, 'f1-score': 0.4706672835872861, 'support': 11682}, 'weighted avg': {'precision': 0.4862220814804766, 'recall': 0.477829138846088, 'f1-score': 0.47185591935597915, 'support': 11682}}
[[1692 1455  637]
 [ 898 2542  649]
 [ 779 1682 1348]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
1840/1840 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63893497
{'0': {'precision': 0.30826070481242895, 'recall': 0.5653091107636562, 'f1-score': 0.39896658930682666, 'support': 40293}, '1': {'precision': 0.9245535094967822, 'recall': 0.7854399651563481, 'f1-score': 0.8493380671310886, 'support': 390315}, '2': {'precision': 0.3237490265540778, 'recall': 0.5253351173220348, 'f1-score': 0.4006121986244426, 'support': 40359}, 'accuracy': 0.7443175424180463, 'macro avg': {'precision': 0.5188544136210963, 'recall': 0.6253613977473463, 'f1-score': 0.5496389516874526, 'support': 470967}, 'weighted avg': {'precision': 0.8203420592120887, 'recall': 0.7443175424180463, 'f1-score': 0.7723540209388231, 'support': 470967}}
[[ 22778  11726   5789]
 [ 45248 306569  38498]
 [  5866  13291  21202]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5954669
{'0': {'precision': 0.21766679090570257, 'recall': 0.6826860631250812, 'f1-score': 0.3300885511524211, 'support': 7699}, '1': {'precision': 0.9618585961667251, 'recall': 0.7550506104124769, 'f1-score': 0.8459992146156291, 'support': 119837}, '2': {'precision': 0.2768433917243788, 'recall': 0.6048315321042593, 'f1-score': 0.37983072500798465, 'support': 7865}, 'accuracy': 0.7422101757003272, 'macro avg': {'precision': 0.4854562595989355, 'recall': 0.6808560685472725, 'f1-score': 0.518639496925345, 'support': 135401}, 'weighted avg': {'precision': 0.8797530187216275, 'recall': 0.7422101757003272, 'f1-score': 0.789585957927958, 'support': 135401}}
[[ 5256  1499   944]
 [17872 90483 11482]
 [ 1019  2089  4757]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6902976
{'0': {'precision': 0.21138660770688567, 'recall': 0.6969539182504556, 'f1-score': 0.3243865495304453, 'support': 3841}, '1': {'precision': 0.9470907446487791, 'recall': 0.6942388013524563, 'f1-score': 0.8011884571734612, 'support': 45251}, '2': {'precision': 0.3051876379690949, 'recall': 0.5543859649122806, 'f1-score': 0.39366435308773795, 'support': 3990}, 'accuracy': 0.6839229870765985, 'macro avg': {'precision': 0.4878883301082532, 'recall': 0.6485262281717309, 'f1-score': 0.5064131199305482, 'support': 53082}, 'weighted avg': {'precision': 0.8456056275536102, 'recall': 0.6839229870765985, 'f1-score': 0.736054941055778, 'support': 53082}}
[[ 2677   690   474]
 [ 9274 31415  4562]
 [  713  1065  2212]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2604797
{'0': {'precision': 0.4607612409766695, 'recall': 0.45469060539067907, 'f1-score': 0.45770579508159875, 'support': 89562}, '1': {'precision': 0.3258964233075686, 'recall': 0.41799789312668656, 'f1-score': 0.3662456220207615, 'support': 69297}, '2': {'precision': 0.45853491946041325, 'recall': 0.36337392873252145, 'f1-score': 0.4054455320969325, 'support': 88680}, 'accuracy': 0.4117048222704301, 'macro avg': {'precision': 0.41506419458155036, 'recall': 0.4120208090832957, 'f1-score': 0.409798983066431, 'support': 247539}, 'weighted avg': {'precision': 0.4222091038908879, 'recall': 0.4117048222704301, 'f1-score': 0.4133800293070055, 'support': 247539}}
[[40723 28292 20547]
 [22826 28966 17505]
 [24833 31623 32224]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2003877
{'0': {'precision': 0.44705192138457023, 'recall': 0.48710845940762837, 'f1-score': 0.4662213837760669, 'support': 18772}, '1': {'precision': 0.40563649390972056, 'recall': 0.4597228237332178, 'f1-score': 0.43098941812368363, 'support': 18472}, '2': {'precision': 0.4742538316751815, 'recall': 0.3709058409126755, 'f1-score': 0.41626102604950294, 'support': 19021}, 'accuracy': 0.4388340886874611, 'macro avg': {'precision': 0.44231408232315744, 'recall': 0.4392457080178405, 'f1-score': 0.43782394264975116, 'support': 56265}, 'weighted avg': {'precision': 0.44265099290900445, 'recall': 0.4388340886874611, 'f1-score': 0.437764957332491, 'support': 56265}}
[[9144 5810 3818]
 [5977 8492 4003]
 [5333 6633 7055]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2126025
{'0': {'precision': 0.45967637540453077, 'recall': 0.5046901648664014, 'f1-score': 0.4811327145857327, 'support': 7036}, '1': {'precision': 0.35455069124423966, 'recall': 0.40241909120627656, 'f1-score': 0.37697136732506514, 'support': 6118}, '2': {'precision': 0.46860986547085204, 'recall': 0.3652249890782001, 'f1-score': 0.41050822489565436, 'support': 6867}, 'accuracy': 0.42560311672743617, 'macro avg': {'precision': 0.4276123107065408, 'recall': 0.4241114150502927, 'f1-score': 0.4228707689354841, 'support': 20021}, 'weighted avg': {'precision': 0.4306162555600058, 'recall': 0.42560311672743617, 'f1-score': 0.42507969559354786, 'support': 20021}}
[[3551 2108 1377]
 [2189 2462 1467]
 [1985 2374 2508]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3056782
{'0': {'precision': 0.37633877622684575, 'recall': 0.4894042097752408, 'f1-score': 0.42548835939777796, 'support': 140150}, '1': {'precision': 0.2991181094625135, 'recall': 0.192670712121332, 'f1-score': 0.23437417293432072, 'support': 126397}, '2': {'precision': 0.391988163854881, 'recall': 0.4000529558677248, 'f1-score': 0.39597950083760397, 'support': 139739}, 'accuracy': 0.3663576889186435, 'macro avg': {'precision': 0.35581501651474673, 'recall': 0.3607092925880992, 'f1-score': 0.3519473443899009, 'support': 406286}, 'weighted avg': {'precision': 0.35769764451357655, 'recall': 0.3663576889186435, 'f1-score': 0.3558827165433312, 'support': 406286}}
[[68590 28620 42940]
 [58273 24353 43771]
 [55393 28443 55903]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2945249
{'0': {'precision': 0.38893645648584185, 'recall': 0.48851590106007065, 'f1-score': 0.4330756920562498, 'support': 26036}, '1': {'precision': 0.33558925300223896, 'recall': 0.2650830017283653, 'f1-score': 0.2961981540949002, 'support': 24879}, '2': {'precision': 0.38200207468879666, 'recall': 0.35963377416073244, 'f1-score': 0.3704806019576198, 'support': 24575}, 'accuracy': 0.37292356603523646, 'macro avg': {'precision': 0.3688425947256258, 'recall': 0.37107755898305617, 'f1-score': 0.3665848160362566, 'support': 75490}, 'weighted avg': {'precision': 0.36909757043297475, 'recall': 0.37292356603523646, 'f1-score': 0.36758820224151606, 'support': 75490}}
[[12719  6620  6697]
 [10683  6595  7601]
 [ 9300  6437  8838]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2721682
{'0': {'precision': 0.38180913099132413, 'recall': 0.4747966041740361, 'f1-score': 0.4232558139534884, 'support': 11308}, '1': {'precision': 0.37672452158433467, 'recall': 0.2939491275284313, 'f1-score': 0.3302287023943044, 'support': 11519}, '2': {'precision': 0.3804347826086957, 'recall': 0.37237579557328776, 'f1-score': 0.3763621525610869, 'support': 10527}, 'accuracy': 0.38001439107753193, 'macro avg': {'precision': 0.3796561450614515, 'recall': 0.3803738424252517, 'f1-score': 0.3766155563029599, 'support': 33354}, 'weighted avg': {'precision': 0.3796193672093777, 'recall': 0.38001439107753193, 'f1-score': 0.3763280430256221, 'support': 33354}}
[[5369 2937 3002]
 [4751 3386 3382]
 [3942 2665 3920]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2421222
{'0': {'precision': 0.503212988840092, 'recall': 0.48152123488907284, 'f1-score': 0.49212819857298906, 'support': 219874}, '1': {'precision': 0.23711502695205372, 'recall': 0.37103536723721203, 'f1-score': 0.28932994845757365, 'support': 101365}, '2': {'precision': 0.509979357121793, 'recall': 0.39787504256356926, 'f1-score': 0.4470057279927211, 'support': 217322}, 'accuracy': 0.4269729891321503, 'macro avg': {'precision': 0.41676912430464624, 'recall': 0.4168105482299514, 'f1-score': 0.4094879583410946, 'support': 538561}, 'weighted avg': {'precision': 0.45585987708661346, 'recall': 0.4269729891321503, 'f1-score': 0.43575064770243943, 'support': 538561}}
[[105874  59365  54635]
 [ 35307  37610  28448]
 [ 69215  61640  86467]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1876023
{'0': {'precision': 0.45364345254100563, 'recall': 0.4652913759342508, 'f1-score': 0.4593935928331223, 'support': 36259}, '1': {'precision': 0.41214836942992283, 'recall': 0.45780334033845815, 'f1-score': 0.43377787093562503, 'support': 36164}, '2': {'precision': 0.46190950395220015, 'recall': 0.40039383884977475, 'f1-score': 0.4289574452712955, 'support': 37071}, 'accuracy': 0.44084607375746615, 'macro avg': {'precision': 0.4425671086410428, 'recall': 0.4411628517074946, 'f1-score': 0.4407096363466809, 'support': 109494}, 'weighted avg': {'precision': 0.44273694265220076, 'recall': 0.44084607375746615, 'f1-score': 0.44062849709303087, 'support': 109494}}
[[16871 11139  8249]
 [10566 16556  9042]
 [ 9753 12475 14843]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1762649
{'0': {'precision': 0.4468910123251627, 'recall': 0.5306256680095371, 'f1-score': 0.48517196015786507, 'support': 12163}, '1': {'precision': 0.3981033481710857, 'recall': 0.36342756183745584, 'f1-score': 0.37997598596102333, 'support': 11320}, '2': {'precision': 0.4684385382059801, 'recall': 0.41971037811745776, 'f1-score': 0.4427377264819451, 'support': 12430}, 'accuracy': 0.4395344304290925, 'macro avg': {'precision': 0.43781096623407617, 'recall': 0.43792120265481693, 'f1-score': 0.4359618908669445, 'support': 35913}, 'weighted avg': {'precision': 0.43897074357775673, 'recall': 0.4395344304290925, 'f1-score': 0.43732644592903613, 'support': 35913}}
[[6454 2918 2791]
 [4077 4114 3129]
 [3911 3302 5217]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6417687
{'0': {'precision': 0.35728063657759024, 'recall': 0.6447911643668215, 'f1-score': 0.4597902015553536, 'support': 151387}, '1': {'precision': 0.9060248716549862, 'recall': 0.742645948750485, 'f1-score': 0.8162402003770196, 'support': 1046566}, '2': {'precision': 0.3817135962124771, 'recall': 0.5516853483852072, 'f1-score': 0.45122356207638076, 'support': 150236}, 'accuracy': 0.7103781443106271, 'macro avg': {'precision': 0.5483397014816845, 'recall': 0.6463741538341713, 'f1-score': 0.5757513213362513, 'support': 1348189}, 'weighted avg': {'precision': 0.7859800023576975, 'recall': 0.7103781443106271, 'f1-score': 0.735538951781051, 'support': 1348189}}
[[ 97613  33701  20073]
 [155160 777228 114178]
 [ 20438  46915  82883]]
Evaluating performance on  train set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5965246
{'0': {'precision': 0.2854596898655104, 'recall': 0.7062914810437313, 'f1-score': 0.4065893805772905, 'support': 21998}, '1': {'precision': 0.9397976793913015, 'recall': 0.7634711530830887, 'f1-score': 0.8425075411112193, 'support': 226818}, '2': {'precision': 0.3827096061154944, 'recall': 0.5553526083663741, 'f1-score': 0.4531443111595783, 'support': 22447}, 'accuracy': 0.741612383553968, 'macro avg': {'precision': 0.5359889917907688, 'recall': 0.675038414164398, 'f1-score': 0.567413744282696, 'support': 271263}, 'weighted avg': {'precision': 0.8406353053321398, 'recall': 0.741612383553968, 'f1-score': 0.7749370869093936, 'support': 271263}}
[[ 15537   4118   2343]
 [ 35885 173169  17764]
 [  3006   6975  12466]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61690885
{'0': {'precision': 0.28161141094834236, 'recall': 0.731048286214661, 'f1-score': 0.4065957002713422, 'support': 7994}, '1': {'precision': 0.946238271747944, 'recall': 0.7479370529327611, 'f1-score': 0.8354822007299971, 'support': 87375}, '2': {'precision': 0.3352465047829286, 'recall': 0.5668781883787483, 'f1-score': 0.4213251953576547, 'support': 8037}, 'accuracy': 0.7325590391273233, 'macro avg': {'precision': 0.5210320624930717, 'recall': 0.6819545091753901, 'f1-score': 0.5544676987863314, 'support': 103406}, 'weighted avg': {'precision': 0.8473700440210243, 'recall': 0.7325590391273233, 'f1-score': 0.7701368770849087, 'support': 103406}}
[[ 5844  1330   820]
 [13810 65351  8214]
 [ 1098  2383  4556]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
10110/10110 - 143s - 143s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5444911
{'0': {'precision': 0.49986261371005264, 'recall': 0.4695159930487448, 'f1-score': 0.4842142994030677, 'support': 290595}, '1': {'precision': 0.8727410024859581, 'recall': 0.9090354767184036, 'f1-score': 0.8905185835664254, 'support': 2002440}, '2': {'precision': 0.5040774430879603, 'recall': 0.3919529867893963, 'f1-score': 0.44099988751170166, 'support': 295066}, 'accuracy': 0.8007338198934276, 'macro avg': {'precision': 0.6255603530946571, 'recall': 0.5901681521855149, 'f1-score': 0.605244256827065, 'support': 2588101}, 'weighted avg': {'precision': 0.7888429331278983, 'recall': 0.8007338198934276, 'f1-score': 0.7936492276075452, 'support': 2588101}}
[[ 136439  122337   31819]
 [ 100189 1820289   81962]
 [  36325  143089  115652]]
Evaluating performance on  train set...
1686/1686 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5715702
{'0': {'precision': 0.4006670087224218, 'recall': 0.5494652406417112, 'f1-score': 0.4634146341463415, 'support': 42636}, '1': {'precision': 0.9032965087350308, 'recall': 0.8543324363963922, 'f1-score': 0.8781324513727219, 'support': 346364}, '2': {'precision': 0.4364411435100749, 'recall': 0.4665946250704755, 'f1-score': 0.45101445326248624, 'support': 42568}, 'accuracy': 0.7859688392095799, 'macro avg': {'precision': 0.5801348869891757, 'recall': 0.6234641007028596, 'f1-score': 0.5975205129271832, 'support': 431568}, 'weighted avg': {'precision': 0.8075915200671187, 'recall': 0.7859688392095799, 'f1-score': 0.79503206441442, 'support': 431568}}
[[ 23427  14768   4441]
 [ 29248 295910  21206]
 [  5795  16911  19862]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6847791
{'0': {'precision': 0.33183366707409045, 'recall': 0.6011495335908791, 'f1-score': 0.4276211062517804, 'support': 21226}, '1': {'precision': 0.8866372275291837, 'recall': 0.780407056026719, 'f1-score': 0.8301374538459152, 'support': 137131}, '2': {'precision': 0.4065380997177799, 'recall': 0.3918483928004715, 'f1-score': 0.39905810651707185, 'support': 22057}, 'accuracy': 0.7118128304898733, 'macro avg': {'precision': 0.5416696647736846, 'recall': 0.5911349941393566, 'f1-score': 0.5522722222049224, 'support': 180414}, 'weighted avg': {'precision': 0.7626678746166827, 'recall': 0.7118128304898733, 'f1-score': 0.7300779841924214, 'support': 180414}}
[[ 12760   5986   2480]
 [ 19976 107018  10137]
 [  5717   7697   8643]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
6546/6546 - 93s - 93s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83971614
{'0': {'precision': 0.41277505777949913, 'recall': 0.3174435131136342, 'f1-score': 0.3588864202863009, 'support': 308877}, '1': {'precision': 0.7297789519540198, 'recall': 0.7340723275774332, 'f1-score': 0.7319193436772845, 'support': 1061172}, '2': {'precision': 0.3870333564357237, 'recall': 0.4694393562737145, 'f1-score': 0.4242719867323545, 'support': 305720}, 'accuracy': 0.60900100192807, 'macro avg': {'precision': 0.5098624553897476, 'recall': 0.5069850656549273, 'f1-score': 0.5050259168986466, 'support': 1675769}, 'weighted avg': {'precision': 0.6088199204390574, 'recall': 0.60900100192807, 'f1-score': 0.6070362361347528, 'support': 1675769}}
[[ 98051 158734  52092]
 [106991 778977 175204]
 [ 32499 129704 143517]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79383457
{'0': {'precision': 0.44224561996983663, 'recall': 0.5030785017957927, 'f1-score': 0.4707047218992611, 'support': 62368}, '1': {'precision': 0.7495956215220908, 'recall': 0.7722527904417544, 'f1-score': 0.7607555468370898, 'support': 190830}, '2': {'precision': 0.4802329274748544, 'recall': 0.3683330085103618, 'f1-score': 0.4169048778918536, 'support': 61572}, 'accuracy': 0.6399085046224228, 'macro avg': {'precision': 0.5573580563222607, 'recall': 0.5478881002493029, 'f1-score': 0.5494550488760682, 'support': 314770}, 'weighted avg': {'precision': 0.6360079076526388, 'recall': 0.6399085046224228, 'f1-score': 0.6360249078371261, 'support': 314770}}
[[ 31376  22233   8759]
 [ 27674 147369  15787]
 [ 11897  26996  22679]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.726908
{'0': {'precision': 0.4263913437082381, 'recall': 0.5075170609061522, 'f1-score': 0.4634306329944244, 'support': 19489}, '1': {'precision': 0.7857078350169653, 'recall': 0.8110400852310561, 'f1-score': 0.7981730132830059, 'support': 75090}, '2': {'precision': 0.5017287443030017, 'recall': 0.3386369663219305, 'f1-score': 0.40435705012507517, 'support': 18855}, 'accuracy': 0.6803692014739848, 'macro avg': {'precision': 0.571275974342735, 'recall': 0.5523980374863796, 'f1-score': 0.5553202321341685, 'support': 113434}, 'weighted avg': {'precision': 0.6767709655199223, 'recall': 0.6803692014739848, 'f1-score': 0.6752011156615967, 'support': 113434}}
[[ 9891  7297  2301]
 [10149 60901  4040]
 [ 3157  9313  6385]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
7633/7633 - 112s - 112s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8829547
{'0': {'precision': 0.41687032892193204, 'recall': 0.5523858092292652, 'f1-score': 0.47515459520214115, 'support': 425516}, '1': {'precision': 0.7163460115082492, 'recall': 0.6796661420119737, 'f1-score': 0.69752419957055, 'support': 1103583}, '2': {'precision': 0.47693917585572665, 'recall': 0.3850982256542297, 'f1-score': 0.4261263607479556, 'support': 424889}, 'accuracy': 0.5878956267899291, 'macro avg': {'precision': 0.536718505428636, 'recall': 0.5390500589651562, 'f1-score': 0.5329350518402155, 'support': 1953988}, 'weighted avg': {'precision': 0.5990714808842311, 'recall': 0.5878956267899291, 'f1-score': 0.5900845525962998, 'support': 1953988}}
[[235049 128084  62383]
 [236451 750068 117064]
 [ 92342 168923 163624]]
Evaluating performance on  train set...
1586/1586 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84764975
{'0': {'precision': 0.41917051874678996, 'recall': 0.5487938135664453, 'f1-score': 0.4753030247879737, 'support': 83279}, '1': {'precision': 0.7363817522836393, 'recall': 0.6921578076222004, 'f1-score': 0.7135852496338762, 'support': 238645}, '2': {'precision': 0.46546181968683176, 'recall': 0.402104736252473, 'f1-score': 0.4314698416149267, 'support': 83906}, 'accuracy': 0.6027696326047852, 'macro avg': {'precision': 0.540338030239087, 'recall': 0.5476854524803729, 'f1-score': 0.5401193720122589, 'support': 405830}, 'weighted avg': {'precision': 0.6152747809355797, 'recall': 0.6027696326047852, 'f1-score': 0.606360350468758, 'support': 405830}}
[[ 45703  25151  12425]
 [ 47144 165180  26321]
 [ 16185  33982  33739]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81702465
{'0': {'precision': 0.40133056133056133, 'recall': 0.5283170340096336, 'f1-score': 0.45615085303801256, 'support': 27404}, '1': {'precision': 0.7581867466405213, 'recall': 0.718238141547472, 'f1-score': 0.7376719861737705, 'support': 91517}, '2': {'precision': 0.4501140842148932, 'recall': 0.38813765471846606, 'f1-score': 0.41683474519295416, 'support': 27954}, 'accuracy': 0.619976170212766, 'macro avg': {'precision': 0.5365437973953252, 'recall': 0.5448976100918572, 'f1-score': 0.5368858614682458, 'support': 146875}, 'weighted avg': {'precision': 0.632970405481848, 'recall': 0.619976170212766, 'f1-score': 0.6240822713357788, 'support': 146875}}
[[14478  8834  4092]
 [16623 65731  9163]
 [ 4974 12130 10850]]
testing model on single stock: results/universal/W10/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
22048/22048 - 320s - 320s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1579663
{'0': {'precision': 0.43593670411858865, 'recall': 0.5425545789490845, 'f1-score': 0.483437019919072, 'support': 2146890}, '1': {'precision': 0.27464153400773794, 'recall': 0.22313847870430098, 'f1-score': 0.24622561180636993, 'support': 1319257}, '2': {'precision': 0.45359294829627683, 'recall': 0.39576274805192657, 'f1-score': 0.4227091017026996, 'support': 2177921}, 'accuracy': 0.4112498290240302, 'macro avg': {'precision': 0.3880570621408678, 'recall': 0.38715193523510405, 'f1-score': 0.3841239111427139, 'support': 5644068}, 'weighted avg': {'precision': 0.4050483666181872, 'recall': 0.4112498290240302, 'f1-score': 0.404557137713142, 'support': 5644068}}
[[1164805  367007  615078]
 [ 601648  294377  423232]
 [ 905506  410475  861940]]
Evaluating performance on  train set...
5429/5429 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1618303
{'0': {'precision': 0.4112439320500478, 'recall': 0.48245661575815385, 'f1-score': 0.444013056038817, 'support': 461285}, '1': {'precision': 0.38388561187210113, 'recall': 0.4234699087300639, 'f1-score': 0.40270735970447136, 'support': 460283}, '2': {'precision': 0.4268645420196663, 'recall': 0.31077381104931784, 'f1-score': 0.3596839019374231, 'support': 468228}, 'accuracy': 0.405080313945356, 'macro avg': {'precision': 0.407331361980605, 'recall': 0.4055667785125119, 'f1-score': 0.40213477256023716, 'support': 1389796}, 'weighted avg': {'precision': 0.40744584749547197, 'recall': 0.405080313945356, 'f1-score': 0.40192228804664465, 'support': 1389796}}
[[222550 145254  93481]
 [163473 194916 101894]
 [155140 167575 145513]]
Evaluating performance on  val set...
1890/1890 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1483814
{'0': {'precision': 0.39639173227238705, 'recall': 0.4601455429116421, 'f1-score': 0.4258959747267862, 'support': 153082}, '1': {'precision': 0.40937754328075604, 'recall': 0.42356250071602874, 'f1-score': 0.4163492371838726, 'support': 174574}, '2': {'precision': 0.4128258111870816, 'recall': 0.33166892078122695, 'f1-score': 0.3678239358525974, 'support': 156011}, 'accuracy': 0.4055000651274534, 'macro avg': {'precision': 0.4061983622467416, 'recall': 0.405125654802966, 'f1-score': 0.403356382587752, 'support': 483667}, 'weighted avg': {'precision': 0.4063797654781576, 'recall': 0.4055000651274534, 'f1-score': 0.40371854890154346, 'support': 483667}}
[[70440 50265 32377]
 [59411 73943 41220]
 [47852 56415 51744]]
training model: results/universal/W10/deepLOB_L2/h20
Epoch 1/50
8543/8543 - 366s - loss: 2.9652 - accuracy20: 0.4787 - val_loss: 3.6147 - val_accuracy20: 0.4376 - 366s/epoch - 43ms/step
Epoch 2/50
8543/8543 - 363s - loss: 2.9108 - accuracy20: 0.4943 - val_loss: 3.6487 - val_accuracy20: 0.4610 - 363s/epoch - 42ms/step
Epoch 3/50
8543/8543 - 360s - loss: 2.8716 - accuracy20: 0.5057 - val_loss: 3.7095 - val_accuracy20: 0.4577 - 360s/epoch - 42ms/step
Epoch 4/50
8543/8543 - 360s - loss: 2.8381 - accuracy20: 0.5134 - val_loss: 3.5056 - val_accuracy20: 0.4611 - 360s/epoch - 42ms/step
Epoch 5/50
8543/8543 - 359s - loss: 2.8187 - accuracy20: 0.5179 - val_loss: 3.4850 - val_accuracy20: 0.4700 - 359s/epoch - 42ms/step
Epoch 6/50
8543/8543 - 359s - loss: 2.8064 - accuracy20: 0.5207 - val_loss: 3.3572 - val_accuracy20: 0.4647 - 359s/epoch - 42ms/step
Epoch 7/50
8543/8543 - 359s - loss: 2.7971 - accuracy20: 0.5225 - val_loss: 3.2566 - val_accuracy20: 0.4641 - 359s/epoch - 42ms/step
Epoch 8/50
8543/8543 - 358s - loss: 2.7899 - accuracy20: 0.5237 - val_loss: 3.2431 - val_accuracy20: 0.4675 - 358s/epoch - 42ms/step
Epoch 9/50
8543/8543 - 359s - loss: 2.7842 - accuracy20: 0.5252 - val_loss: 3.2131 - val_accuracy20: 0.4677 - 359s/epoch - 42ms/step
Epoch 10/50
8543/8543 - 358s - loss: 2.7789 - accuracy20: 0.5260 - val_loss: 3.1926 - val_accuracy20: 0.4701 - 358s/epoch - 42ms/step
Epoch 11/50
8543/8543 - 362s - loss: 2.7746 - accuracy20: 0.5269 - val_loss: 3.1827 - val_accuracy20: 0.4743 - 362s/epoch - 42ms/step
Epoch 12/50
8543/8543 - 361s - loss: 2.7711 - accuracy20: 0.5275 - val_loss: 3.2038 - val_accuracy20: 0.4740 - 361s/epoch - 42ms/step
Epoch 13/50
8543/8543 - 359s - loss: 2.7677 - accuracy20: 0.5284 - val_loss: 3.1964 - val_accuracy20: 0.4707 - 359s/epoch - 42ms/step
Epoch 14/50
8543/8543 - 358s - loss: 2.7648 - accuracy20: 0.5288 - val_loss: 3.1561 - val_accuracy20: 0.4725 - 358s/epoch - 42ms/step
Epoch 15/50
8543/8543 - 356s - loss: 2.7618 - accuracy20: 0.5294 - val_loss: 3.1471 - val_accuracy20: 0.4729 - 356s/epoch - 42ms/step
Epoch 16/50
8543/8543 - 357s - loss: 2.7596 - accuracy20: 0.5300 - val_loss: 3.1484 - val_accuracy20: 0.4749 - 357s/epoch - 42ms/step
Epoch 17/50
8543/8543 - 357s - loss: 2.7575 - accuracy20: 0.5301 - val_loss: 3.1819 - val_accuracy20: 0.4735 - 357s/epoch - 42ms/step
Epoch 18/50
8543/8543 - 357s - loss: 2.7555 - accuracy20: 0.5309 - val_loss: 3.1759 - val_accuracy20: 0.4720 - 357s/epoch - 42ms/step
Epoch 19/50
8543/8543 - 358s - loss: 2.7529 - accuracy20: 0.5315 - val_loss: 3.1515 - val_accuracy20: 0.4702 - 358s/epoch - 42ms/step
Epoch 20/50
8543/8543 - 354s - loss: 2.7511 - accuracy20: 0.5318 - val_loss: 3.1805 - val_accuracy20: 0.4704 - 354s/epoch - 41ms/step
Epoch 21/50
8543/8543 - 355s - loss: 2.7493 - accuracy20: 0.5321 - val_loss: 3.1589 - val_accuracy20: 0.4694 - 355s/epoch - 42ms/step
Epoch 22/50
8543/8543 - 356s - loss: 2.7476 - accuracy20: 0.5325 - val_loss: 3.1548 - val_accuracy20: 0.4712 - 356s/epoch - 42ms/step
Epoch 23/50
8543/8543 - 355s - loss: 2.7456 - accuracy20: 0.5330 - val_loss: 3.1554 - val_accuracy20: 0.4681 - 355s/epoch - 42ms/step
Epoch 24/50
8543/8543 - 356s - loss: 2.7437 - accuracy20: 0.5336 - val_loss: 3.1617 - val_accuracy20: 0.4681 - 356s/epoch - 42ms/step
Epoch 25/50
8543/8543 - 357s - loss: 2.7425 - accuracy20: 0.5337 - val_loss: 3.1446 - val_accuracy20: 0.4648 - 357s/epoch - 42ms/step
Epoch 26/50
8543/8543 - 356s - loss: 2.7408 - accuracy20: 0.5341 - val_loss: 3.1621 - val_accuracy20: 0.4651 - 356s/epoch - 42ms/step
Epoch 27/50
8543/8543 - 357s - loss: 2.7393 - accuracy20: 0.5345 - val_loss: 3.1987 - val_accuracy20: 0.4646 - 357s/epoch - 42ms/step
Epoch 28/50
8543/8543 - 356s - loss: 2.7377 - accuracy20: 0.5347 - val_loss: 3.1614 - val_accuracy20: 0.4626 - 356s/epoch - 42ms/step
Epoch 29/50
8543/8543 - 356s - loss: 2.7363 - accuracy20: 0.5354 - val_loss: 3.1889 - val_accuracy20: 0.4643 - 356s/epoch - 42ms/step
Epoch 30/50
8543/8543 - 355s - loss: 2.7348 - accuracy20: 0.5357 - val_loss: 3.1835 - val_accuracy20: 0.4639 - 355s/epoch - 42ms/step
Epoch 31/50
8543/8543 - 359s - loss: 2.7336 - accuracy20: 0.5359 - val_loss: 3.1936 - val_accuracy20: 0.4624 - 359s/epoch - 42ms/step
Epoch 32/50
8543/8543 - 361s - loss: 2.7320 - accuracy20: 0.5362 - val_loss: 3.2290 - val_accuracy20: 0.4622 - 361s/epoch - 42ms/step
Epoch 33/50
8543/8543 - 361s - loss: 2.7311 - accuracy20: 0.5364 - val_loss: 3.2027 - val_accuracy20: 0.4586 - 361s/epoch - 42ms/step
Epoch 34/50
8543/8543 - 367s - loss: 2.7292 - accuracy20: 0.5367 - val_loss: 3.2209 - val_accuracy20: 0.4603 - 367s/epoch - 43ms/step
Epoch 35/50
8543/8543 - 366s - loss: 2.7280 - accuracy20: 0.5370 - val_loss: 3.2248 - val_accuracy20: 0.4552 - 366s/epoch - 43ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 535s - 535s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0573435
{'0': {'precision': 0.41863421500195397, 'recall': 0.34666618362603735, 'f1-score': 0.3792663009458448, 'support': 2870704}, '1': {'precision': 0.5421509369563501, 'recall': 0.5098356030947179, 'f1-score': 0.5254969324951422, 'support': 3757370}, '2': {'precision': 0.4176615062758053, 'recall': 0.5203826950797081, 'f1-score': 0.4633978227311314, 'support': 2917205}, 'accuracy': 0.4639864376934399, 'macro avg': {'precision': 0.45948221941136974, 'recall': 0.4589614939334878, 'f1-score': 0.45605368539070607, 'support': 9545279}, 'weighted avg': {'precision': 0.46695762543451697, 'recall': 0.4639864376934399, 'f1-score': 0.4625400831028703, 'support': 9545279}}
[[ 995176  827773 1047755]
 [ 772874 1915641 1068855]
 [ 609147  789995 1518063]]
Evaluating performance on  train set...
8543/8543 - 124s - 124s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0437567
{'0': {'precision': 0.3935371187367297, 'recall': 0.4086727620808027, 'f1-score': 0.4009621550199815, 'support': 605920}, '1': {'precision': 0.5548960903464899, 'recall': 0.524358877334265, 'f1-score': 0.5391954629525988, 'support': 964597}, '2': {'precision': 0.4109798555070335, 'recall': 0.4308417842821278, 'f1-score': 0.4206765088505181, 'support': 616203}, 'accuracy': 0.4659508304675496, 'macro avg': {'precision': 0.45313768819675104, 'recall': 0.4546244745657318, 'f1-score': 0.45361137560769943, 'support': 2186720}, 'weighted avg': {'precision': 0.4696303756072624, 'recall': 0.4659508304675496, 'f1-score': 0.4674944399514391, 'support': 2186720}}
[[247623 196828 161469]
 [239774 505795 219028]
 [141827 208890 265486]]
Evaluating performance on  val set...
3077/3077 - 43s - 43s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0452685
{'0': {'precision': 0.3705275842386134, 'recall': 0.3970860965734205, 'f1-score': 0.38334739407574053, 'support': 205978}, '1': {'precision': 0.5694273318112011, 'recall': 0.5255173528777753, 'f1-score': 0.5465918931871494, 'support': 371120}, '2': {'precision': 0.3981868492930232, 'recall': 0.424475207891539, 'f1-score': 0.41091100326610447, 'support': 209845}, 'accuracy': 0.46495743656147903, 'macro avg': {'precision': 0.4460472551142793, 'recall': 0.44902621911424495, 'f1-score': 0.4469500968429982, 'support': 786943}, 'weighted avg': {'precision': 0.4717036958432422, 'recall': 0.46495743656147903, 'f1-score': 0.4676830881231849, 'support': 786943}}
[[ 81791  71766  52421]
 [ 93886 195030  82204]
 [ 45065  75706  89074]]
testing model out of sample: results/universal/W10/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 300s - 300s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8601254
{'0': {'precision': 0.4703568326341524, 'recall': 0.5100909186060878, 'f1-score': 0.48941873450677265, 'support': 1270697}, '1': {'precision': 0.7341703888754089, 'recall': 0.7346436430600035, 'f1-score': 0.7344069397260858, 'support': 2924245}, '2': {'precision': 0.4858709974166283, 'recall': 0.44394588014285974, 'f1-score': 0.46396324435445424, 'support': 1265857}, 'accuracy': 0.6150054231990594, 'macro avg': {'precision': 0.5634660729753965, 'recall': 0.5628934806029836, 'f1-score': 0.562596306195771, 'support': 5460799}, 'weighted avg': {'precision': 0.6152246783211597, 'recall': 0.6150054231990594, 'f1-score': 0.6147085545081693, 'support': 5460799}}
[[ 648171  376934  245592]
 [ 426903 2148278  349064]
 [ 302967  400918  561972]]
Evaluating performance on  train set...
4055/4055 - 61s - 61s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87475973
{'0': {'precision': 0.43750021738147493, 'recall': 0.55181596044764, 'f1-score': 0.4880534819114429, 'support': 227951}, '1': {'precision': 0.7527129473937064, 'recall': 0.6768884349720997, 'f1-score': 0.7127898660833709, 'support': 578667}, '2': {'precision': 0.46440642531098647, 'recall': 0.4618516689624104, 'f1-score': 0.46312552393941636, 'support': 230862}, 'accuracy': 0.6015576203878629, 'macro avg': {'precision': 0.551539863362056, 'recall': 0.5635186881273834, 'f1-score': 0.5546562906447433, 'support': 1037480}, 'weighted avg': {'precision': 0.6193011444480312, 'recall': 0.6015576203878629, 'f1-score': 0.6078558983303417, 'support': 1037480}}
[[125787  60520  41644]
 [105650 391693  81324]
 [ 56076  68162 106624]]
Evaluating performance on  val set...
1545/1545 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90353835
{'0': {'precision': 0.40158597662771284, 'recall': 0.5636855733517675, 'f1-score': 0.46902495259543064, 'support': 85349}, '1': {'precision': 0.7581910049550357, 'recall': 0.630054570874487, 'f1-score': 0.6882092283743075, 'support': 221730}, '2': {'precision': 0.45002641775272983, 'recall': 0.4655113519914376, 'f1-score': 0.4576379327714161, 'support': 87826}, 'accuracy': 0.5791164963725453, 'macro avg': {'precision': 0.5366011331118261, 'recall': 0.5530838320725641, 'f1-score': 0.5382907045803847, 'support': 394905}, 'weighted avg': {'precision': 0.6125844778198047, 'recall': 0.5791164963725453, 'f1-score': 0.5895593926895962, 'support': 394905}}
[[ 48110  21364  15875]
 [ 47939 139702  34089]
 [ 23751  23191  40884]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1235243
{'0': {'precision': 0.5035995756289785, 'recall': 0.49704562453253553, 'f1-score': 0.5003011367913875, 'support': 53480}, '1': {'precision': 0.32033436441302104, 'recall': 0.2915703033350092, 'f1-score': 0.30527627169202154, 'support': 29835}, '2': {'precision': 0.4649515853426998, 'recall': 0.49678466375900193, 'f1-score': 0.4803412935811308, 'support': 49295}, 'accuracy': 0.4507201568509162, 'macro avg': {'precision': 0.42962850846156647, 'recall': 0.4284668638755156, 'f1-score': 0.42863956735484665, 'support': 132610}, 'weighted avg': {'precision': 0.4480014287487266, 'recall': 0.4507201568509162, 'f1-score': 0.4490041959778049, 'support': 132610}}
[[26582  9528 17370]
 [10325  8699 10811]
 [15877  8929 24489]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0932095
{'0': {'precision': 0.47022403258655804, 'recall': 0.5053848174415551, 'f1-score': 0.487170830519919, 'support': 11421}, '1': {'precision': 0.4525154939846883, 'recall': 0.4348016463788423, 'f1-score': 0.4434817560627038, 'support': 11419}, '2': {'precision': 0.46677500902853014, 'recall': 0.4502307759296351, 'f1-score': 0.4583536504277672, 'support': 11483}, 'accuracy': 0.46345016461265043, 'macro avg': {'precision': 0.46317151186659217, 'recall': 0.4634724132500108, 'f1-score': 0.4630020790034633, 'support': 34323}, 'weighted avg': {'precision': 0.4631786420376088, 'recall': 0.46345016461265043, 'f1-score': 0.4629948196751467, 'support': 34323}}
[[5772 2809 2840]
 [3388 4965 3066]
 [3115 3198 5170]]
Evaluating performance on  val set...
46/46 - 1s - 891ms/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1067572
{'0': {'precision': 0.4599294947121034, 'recall': 0.4897397397397397, 'f1-score': 0.47436674342503937, 'support': 3996}, '1': {'precision': 0.4311756935270806, 'recall': 0.43450479233226835, 'f1-score': 0.43283384166556155, 'support': 3756}, '2': {'precision': 0.4769357495881384, 'recall': 0.44198473282442746, 'f1-score': 0.45879556259904913, 'support': 3930}, 'accuracy': 0.4559150830337271, 'macro avg': {'precision': 0.4560136459424408, 'recall': 0.45540975496547853, 'f1-score': 0.45533204922988335, 'support': 11682}, 'weighted avg': {'precision': 0.4564057234753179, 'recall': 0.4559150830337271, 'f1-score': 0.4557746941479687, 'support': 11682}}
[[1957 1070  969]
 [1188 1632  936]
 [1110 1083 1737]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
1840/1840 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7739961
{'0': {'precision': 0.29084877811254145, 'recall': 0.6870349735811078, 'f1-score': 0.40868514737168454, 'support': 55642}, '1': {'precision': 0.8998524315008054, 'recall': 0.6659811749143367, 'f1-score': 0.765451421051623, 'support': 359839}, '2': {'precision': 0.38504930750949273, 'recall': 0.5080741087841978, 'f1-score': 0.4380885780885781, 'support': 55486}, 'accuracy': 0.6498650648559241, 'macro avg': {'precision': 0.5252501723742798, 'recall': 0.6203634190932141, 'f1-score': 0.5374083821706286, 'support': 470967}, 'weighted avg': {'precision': 0.7672517452115075, 'recall': 0.6498650648559241, 'f1-score': 0.6847339956168331, 'support': 470967}}
[[ 38228  12594   4820]
 [ 79990 239646  40203]
 [ 13218  14077  28191]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78603476
{'0': {'precision': 0.2000296706557215, 'recall': 0.7613401091661961, 'f1-score': 0.316820050910515, 'support': 10626}, '1': {'precision': 0.9452917771883289, 'recall': 0.6008640977905793, 'f1-score': 0.7347149146354558, 'support': 113876}, '2': {'precision': 0.2918087981216498, 'recall': 0.6043673731535003, 'f1-score': 0.39358269598470363, 'support': 10899}, 'accuracy': 0.6137399280655239, 'macro avg': {'precision': 0.47904341532190003, 'recall': 0.6555238600367587, 'f1-score': 0.4817058871768915, 'support': 135401}, 'weighted avg': {'precision': 0.8342034829152939, 'recall': 0.6137399280655239, 'f1-score': 0.6744601833335025, 'support': 135401}}
[[ 8090  1611   925]
 [30391 68424 15061]
 [ 1963  2349  6587]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8667692
{'0': {'precision': 0.22740429250177488, 'recall': 0.7794833395731936, 'f1-score': 0.35209064389295225, 'support': 5342}, '1': {'precision': 0.9237841279949057, 'recall': 0.5503758328788562, 'f1-score': 0.6897873668256586, 'support': 42173}, '2': {'precision': 0.30523587350959047, 'recall': 0.5288306089455721, 'f1-score': 0.38706284512227185, 'support': 5567}, 'accuracy': 0.5711729023020986, 'macro avg': {'precision': 0.485474764668757, 'recall': 0.619563260465874, 'f1-score': 0.4763136186136275, 'support': 53082}, 'weighted avg': {'precision': 0.7888321816868529, 'recall': 0.5711729023020986, 'f1-score': 0.6240542876984729, 'support': 53082}}
[[ 4164   728   450]
 [12711 23211  6251]
 [ 1436  1187  2944]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
967/967 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2698528
{'0': {'precision': 0.42467268815112874, 'recall': 0.39930960382232583, 'f1-score': 0.41160079412301837, 'support': 87486}, '1': {'precision': 0.3406046132339236, 'recall': 0.31155096169215196, 'f1-score': 0.32543061468681306, 'support': 75076}, '2': {'precision': 0.40546135850775317, 'recall': 0.4609482565870765, 'f1-score': 0.43142805218550195, 'support': 84977}, 'accuracy': 0.3938530898161502, 'macro avg': {'precision': 0.3902462199642685, 'recall': 0.3906029407005181, 'f1-score': 0.38948648699844446, 'support': 247539}, 'weighted avg': {'precision': 0.3925807109209177, 'recall': 0.3938530898161502, 'f1-score': 0.39227272265558544, 'support': 247539}}
[[34934 23061 29491]
 [23741 23390 27945]
 [23586 22221 39170]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2183803
{'0': {'precision': 0.41323181937516407, 'recall': 0.507033179426608, 'f1-score': 0.4553519768563163, 'support': 18626}, '1': {'precision': 0.40340610698477003, 'recall': 0.2902094127806563, 'f1-score': 0.33757102049784976, 'support': 18528}, '2': {'precision': 0.4253062443979683, 'recall': 0.4469153890429596, 'f1-score': 0.4358431352537443, 'support': 19111}, 'accuracy': 0.4152137207855683, 'macro avg': {'precision': 0.41398139025263414, 'recall': 0.414719327083408, 'f1-score': 0.40958871086930343, 'support': 56265}, 'weighted avg': {'precision': 0.4140974292115026, 'recall': 0.4152137207855683, 'f1-score': 0.4099404593716202, 'support': 56265}}
[[9444 3820 5362]
 [6972 5377 6179]
 [6438 4132 8541]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2117782
{'0': {'precision': 0.4299849699398798, 'recall': 0.49588328759208433, 'f1-score': 0.460588985040585, 'support': 6923}, '1': {'precision': 0.3642514185945002, 'recall': 0.2644169835234474, 'f1-score': 0.3064071966219937, 'support': 6312}, '2': {'precision': 0.42146210596914824, 'recall': 0.46301208370173885, 'f1-score': 0.4412611473913349, 'support': 6786}, 'accuracy': 0.4117676439738275, 'macro avg': {'precision': 0.405232831501176, 'recall': 0.4077707849390902, 'f1-score': 0.4027524430179712, 'support': 20021}, 'weighted avg': {'precision': 0.4063724465395791, 'recall': 0.4117676439738275, 'f1-score': 0.4054291950807448, 'support': 20021}}
[[3433 1450 2040]
 [2370 1669 2273]
 [2181 1463 3142]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3261255
{'0': {'precision': 0.36234147371915293, 'recall': 0.3414426071007095, 'f1-score': 0.35158174451248303, 'support': 140662}, '1': {'precision': 0.28924526381599036, 'recall': 0.1584106382131624, 'f1-score': 0.20470869090983929, 'support': 125585}, '2': {'precision': 0.36664097034514387, 'recall': 0.5366076592949107, 'f1-score': 0.4356327736183213, 'support': 140039}, 'accuracy': 0.3521361799323629, 'macro avg': {'precision': 0.33940923596009576, 'recall': 0.3454869682029275, 'f1-score': 0.33064106968021456, 'support': 406286}, 'weighted avg': {'precision': 0.34122902999064264, 'recall': 0.3521361799323629, 'f1-score': 0.33515334094520405, 'support': 406286}}
[[48028 25778 66856]
 [42735 19894 62956]
 [41786 23107 75146]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3221364
{'0': {'precision': 0.37767316745124413, 'recall': 0.32172318973418884, 'f1-score': 0.34746024871620373, 'support': 26184}, '1': {'precision': 0.30953282350268796, 'recall': 0.16430868167202572, 'f1-score': 0.21466642161367394, 'support': 24880}, '2': {'precision': 0.34513982690479766, 'recall': 0.5648898714484566, 'f1-score': 0.42848270293770574, 'support': 24426}, 'accuracy': 0.3485229831765797, 'macro avg': {'precision': 0.3441152726195766, 'recall': 0.3503072476182237, 'f1-score': 0.3302031244225278, 'support': 75490}, 'weighted avg': {'precision': 0.34468878364375205, 'recall': 0.3485229831765797, 'f1-score': 0.3299101632545991, 'support': 75490}}
[[ 8424  4933 12827]
 [ 7439  4088 13353]
 [ 6442  4186 13798]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2989583
{'0': {'precision': 0.35819338687806407, 'recall': 0.30149253731343284, 'f1-score': 0.3274062067979215, 'support': 11390}, '1': {'precision': 0.3782720532607051, 'recall': 0.22055580061755625, 'f1-score': 0.2786446723138653, 'support': 11335}, '2': {'precision': 0.3573843105257023, 'recall': 0.5769122212814, 'f1-score': 0.4413574693201857, 'support': 10629}, 'accuracy': 0.3617557114588955, 'macro avg': {'precision': 0.36461658355482385, 'recall': 0.36632018640412967, 'f1-score': 0.3491361161439908, 'support': 33354}, 'weighted avg': {'precision': 0.36475907647745187, 'recall': 0.3617557114588955, 'f1-score': 0.3471482460127793, 'support': 33354}}
[[3434 2292 5664]
 [3473 2500 5362]
 [2680 1817 6132]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2146558
{'0': {'precision': 0.47177925307416785, 'recall': 0.38950312664808256, 'f1-score': 0.42671137477431, 'support': 212368}, '1': {'precision': 0.2616469012381979, 'recall': 0.27385023080868526, 'f1-score': 0.267609516490126, 'support': 116980}, '2': {'precision': 0.45381717907082014, 'recall': 0.5223193587396576, 'f1-score': 0.4856646355826366, 'support': 209213}, 'accuracy': 0.4159770202446891, 'macro avg': {'precision': 0.39574777779439524, 'recall': 0.39522423873214185, 'f1-score': 0.39332850894902416, 'support': 538561}, 'weighted avg': {'precision': 0.4191590635204606, 'recall': 0.4159770202446891, 'f1-score': 0.41505448385834803, 'support': 538561}}
[[ 82718  47306  82344]
 [ 35772  32035  49173]
 [ 56842  43095 109276]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2004359
{'0': {'precision': 0.4336619336167134, 'recall': 0.3962919088680129, 'f1-score': 0.41413559809989925, 'support': 36299}, '1': {'precision': 0.4036186280679673, 'recall': 0.35464071442395423, 'f1-score': 0.3775478667824398, 'support': 36169}, '2': {'precision': 0.4242866443661181, 'recall': 0.5104251066817912, 'f1-score': 0.46338682587747804, 'support': 37026}, 'accuracy': 0.42112809834328824, 'macro avg': {'precision': 0.4205224020169329, 'recall': 0.4204525766579194, 'f1-score': 0.4183567635866057, 'support': 109494}, 'weighted avg': {'precision': 0.42056746471261697, 'recall': 0.42112809834328824, 'f1-score': 0.41870419825763794, 'support': 109494}}
[[14385  9426 12488]
 [10186 12827 13156]
 [ 8600  9527 18899]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1913227
{'0': {'precision': 0.41972407519708915, 'recall': 0.4658029780432405, 'f1-score': 0.44156465568802583, 'support': 11887}, '1': {'precision': 0.39061328535012746, 'recall': 0.22370115929583512, 'f1-score': 0.28448181718903576, 'support': 11645}, '2': {'precision': 0.4227510590580613, 'recall': 0.5480978919311849, 'f1-score': 0.47733267681918895, 'support': 12381}, 'accuracy': 0.4156712054130816, 'macro avg': {'precision': 0.41102947320175937, 'recall': 0.4125340097567534, 'f1-score': 0.4011263832320835, 'support': 35913}, 'weighted avg': {'precision': 0.41132828368467933, 'recall': 0.4156712054130816, 'f1-score': 0.40296064642408774, 'support': 35913}}
[[5537 2077 4273]
 [4047 2605 4993]
 [3608 1987 6786]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
5267/5267 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7627282
{'0': {'precision': 0.3791493379615985, 'recall': 0.685712452558275, 'f1-score': 0.48830265999602857, 'support': 202617}, '1': {'precision': 0.8648681548393596, 'recall': 0.655423130348111, 'f1-score': 0.7457184013434737, 'support': 943090}, '2': {'precision': 0.41559973487415885, 'recall': 0.5481129186791912, 'f1-score': 0.47274586017783937, 'support': 202482}, 'accuracy': 0.6438585391217404, 'macro avg': {'precision': 0.5532057425583724, 'recall': 0.6297495005285256, 'f1-score': 0.5689223071724472, 'support': 1348189}, 'weighted avg': {'precision': 0.724395522492771, 'recall': 0.6438585391217404, 'f1-score': 0.6660345948854064, 'support': 1348189}}
[[138937  43224  20456]
 [189363 618123 135604]
 [ 38144  53355 110983]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7250764
{'0': {'precision': 0.31111407427161814, 'recall': 0.7601980972240323, 'f1-score': 0.4415301787353223, 'support': 30692}, '1': {'precision': 0.9165011125238398, 'recall': 0.6611869921029625, 'f1-score': 0.7681855647786594, 'support': 209319}, '2': {'precision': 0.4063632346442775, 'recall': 0.5885063355945219, 'f1-score': 0.48076118778753657, 'support': 31252}, 'accuracy': 0.6640161024540759, 'macro avg': {'precision': 0.5446594738132452, 'recall': 0.6699638083071723, 'f1-score': 0.5634923104338394, 'support': 271263}, 'weighted avg': {'precision': 0.7892321228808392, 'recall': 0.6640161024540759, 'f1-score': 0.6981122641878355, 'support': 271263}}
[[ 23332   4945   2415]
 [ 46467 138399  24453]
 [  5196   7664  18392]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7632012
{'0': {'precision': 0.2936812822890449, 'recall': 0.7959073774905762, 'f1-score': 0.4290483332526972, 'support': 11142}, '1': {'precision': 0.9259728736214983, 'recall': 0.6305489789878662, 'f1-score': 0.7502255738378362, 'support': 81096}, '2': {'precision': 0.36198365486184464, 'recall': 0.5830050143266475, 'f1-score': 0.4466472303206997, 'support': 11168}, 'accuracy': 0.6432315339535424, 'macro avg': {'precision': 0.5272126035907959, 'recall': 0.6698204569350299, 'f1-score': 0.541973712470411, 'support': 103406}, 'weighted avg': {'precision': 0.7969317686011512, 'recall': 0.6432315339535424, 'f1-score': 0.6828318079538546, 'support': 103406}}
[[ 8868  1494   780]
 [19265 51135 10696]
 [ 2063  2594  6511]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
10110/10110 - 142s - 142s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6720842
{'0': {'precision': 0.5138602349140038, 'recall': 0.502427160046682, 'f1-score': 0.5080793873247856, 'support': 397584}, '1': {'precision': 0.8256998399804396, 'recall': 0.845023143170405, 'f1-score': 0.8352497465255436, 'support': 1790377}, '2': {'precision': 0.5032267555102742, 'recall': 0.4616584195531564, 'f1-score': 0.48154718225505616, 'support': 400140}, 'accuracy': 0.7331224708772958, 'macro avg': {'precision': 0.6142622768015725, 'recall': 0.6030362409234143, 'f1-score': 0.6082921053684618, 'support': 2588101}, 'weighted avg': {'precision': 0.7279382697941812, 'recall': 0.7331224708772958, 'f1-score': 0.7303047524315469, 'support': 2588101}}
[[ 199757  160645   37182]
 [ 132290 1512910  145177]
 [  56691  158721  184728]]
Evaluating performance on  train set...
1686/1686 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.694985
{'0': {'precision': 0.4123742941016965, 'recall': 0.6024457457802274, 'f1-score': 0.48961023509073986, 'support': 58060}, '1': {'precision': 0.8678670025045537, 'recall': 0.7729601617231885, 'f1-score': 0.8176688358592165, 'support': 315601}, '2': {'precision': 0.4430314199119694, 'recall': 0.5023399588996149, 'f1-score': 0.4708253079326029, 'support': 57907}, 'accuracy': 0.7137090794498202, 'macro avg': {'precision': 0.5744242388394065, 'recall': 0.6259152888010102, 'f1-score': 0.5927014596275199, 'support': 431568}, 'weighted avg': {'precision': 0.7495846907227287, 'recall': 0.7137090794498202, 'f1-score': 0.7269954065682029, 'support': 431568}}
[[ 34978  18032   5050]
 [ 40134 243947  31520]
 [  9709  19109  29089]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79796016
{'0': {'precision': 0.35468306723820175, 'recall': 0.611234030404682, 'f1-score': 0.4488881317730924, 'support': 28022}, '1': {'precision': 0.8423999528496493, 'recall': 0.6971684998658635, 'f1-score': 0.7629341980597035, 'support': 123009}, '2': {'precision': 0.43313215263348837, 'recall': 0.4469591260252527, 'f1-score': 0.4399370226450489, 'support': 29383}, 'accuracy': 0.643070936845256, 'macro avg': {'precision': 0.5434050575737798, 'recall': 0.5851205520985995, 'f1-score': 0.5505864508259483, 'support': 180414}, 'weighted avg': {'precision': 0.699992388346033, 'recall': 0.643070936845256, 'f1-score': 0.6615516840935356, 'support': 180414}}
[[17128  7904  2990]
 [23053 85758 14198]
 [ 8110  8140 13133]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
6546/6546 - 97s - 97s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90700454
{'0': {'precision': 0.4656132362554381, 'recall': 0.36479415489724143, 'f1-score': 0.4090835145217122, 'support': 396366}, '1': {'precision': 0.658758573784271, 'recall': 0.6948278487437611, 'f1-score': 0.6763126388474897, 'support': 886575}, '2': {'precision': 0.4436539489897933, 'recall': 0.48575967089922306, 'f1-score': 0.4637530409338249, 'support': 392828}, 'accuracy': 0.5677566538108773, 'macro avg': {'precision': 0.5226752530098341, 'recall': 0.5151272248467419, 'f1-score': 0.5163830647676756, 'support': 1675769}, 'weighted avg': {'precision': 0.5626502411896721, 'recall': 0.5677566538108773, 'f1-score': 0.563278025591283, 'support': 1675769}}
[[144592 179753  72021]
 [103289 616017 167269]
 [ 62660 139348 190820]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86103696
{'0': {'precision': 0.48558946944875553, 'recall': 0.5332466450366742, 'f1-score': 0.5083034489398061, 'support': 79211}, '1': {'precision': 0.6834361451304595, 'recall': 0.7205093322483853, 'f1-score': 0.7014832534404487, 'support': 157304}, '2': {'precision': 0.5230838767998967, 'recall': 0.41408216727365665, 'f1-score': 0.462244031868077, 'support': 78255}, 'accuracy': 0.5972043079073609, 'macro avg': {'precision': 0.5640364971263706, 'recall': 0.5559460481862387, 'f1-score': 0.5573435780827772, 'support': 314770}, 'weighted avg': {'precision': 0.5937833834770883, 'recall': 0.5972043079073609, 'f1-score': 0.5933928039743421, 'support': 314770}}
[[ 42239  24985  11987]
 [ 26408 113339  17557]
 [ 18338  27513  32404]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8202778
{'0': {'precision': 0.45269853633206764, 'recall': 0.5599759132878362, 'f1-score': 0.5006550257523824, 'support': 24910}, '1': {'precision': 0.7292563570477282, 'recall': 0.7328083907813449, 'f1-score': 0.7310280591454185, 'support': 64261}, '2': {'precision': 0.5293954673907021, 'recall': 0.39376828916457157, 'f1-score': 0.4516190025998582, 'support': 24263}, 'accuracy': 0.6223354549782252, 'macro avg': {'precision': 0.5704501202568326, 'recall': 0.5621841977445842, 'f1-score': 0.5611006958325531, 'support': 113434}, 'weighted avg': {'precision': 0.6257752131246053, 'recall': 0.6223354549782252, 'f1-score': 0.6206740717978378, 'support': 113434}}
[[13949  7955  3006]
 [11683 47091  5487]
 [ 5181  9528  9554]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
7633/7633 - 107s - 107s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94219375
{'0': {'precision': 0.44730919577813716, 'recall': 0.5842810117376808, 'f1-score': 0.5067017262565684, 'support': 519779}, '1': {'precision': 0.6523252225790599, 'recall': 0.6258545994032744, 'f1-score': 0.6388158126681989, 'support': 911977}, '2': {'precision': 0.5109454203701297, 'recall': 0.391429479618254, 'f1-score': 0.4432727461975826, 'support': 522232}, 'accuracy': 0.5521420807087863, 'macro avg': {'precision': 0.5368599462424423, 'recall': 0.5338550302530697, 'f1-score': 0.5295967617074501, 'support': 1953988}, 'weighted avg': {'precision': 0.5600032214911663, 'recall': 0.5521420807087863, 'f1-score': 0.5514104783416658, 'support': 1953988}}
[[303697 136511  79571]
 [225124 570765 116088]
 [150121 167694 204417]]
Evaluating performance on  train set...
1586/1586 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9115177
{'0': {'precision': 0.4552492109807658, 'recall': 0.5906610652373364, 'f1-score': 0.5141893908503545, 'support': 103545}, '1': {'precision': 0.6808776710481048, 'recall': 0.6330693069306931, 'f1-score': 0.6561037279876654, 'support': 196950}, '2': {'precision': 0.508436598200645, 'recall': 0.4265248967579627, 'f1-score': 0.4638926174496644, 'support': 105335}, 'accuracy': 0.5686395781484859, 'macro avg': {'precision': 0.5481878267431718, 'recall': 0.5500850896419974, 'f1-score': 0.5447285787625614, 'support': 405830}, 'weighted avg': {'precision': 0.5785521177226736, 'recall': 0.5686395781484859, 'f1-score': 0.5700059102625017, 'support': 405830}}
[[ 61160  26307  16078]
 [ 44908 124683  27359]
 [ 28276  32131  44928]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90418774
{'0': {'precision': 0.43319943545760503, 'recall': 0.5779380666840473, 'f1-score': 0.49520949166004763, 'support': 34521}, '1': {'precision': 0.7114523731878687, 'recall': 0.6232599210471639, 'f1-score': 0.664442444798228, 'support': 77008}, '2': {'precision': 0.4810839978415972, 'recall': 0.45402591523793356, 'f1-score': 0.46716348393106655, 'support': 35346}, 'accuracy': 0.5718808510638298, 'macro avg': {'precision': 0.5419119354956904, 'recall': 0.5517413009897149, 'f1-score': 0.5422718067964474, 'support': 146875}, 'weighted avg': {'precision': 0.5906137671733955, 'recall': 0.5718808510638298, 'f1-score': 0.5771906121099297, 'support': 146875}}
[[19951  8959  5611]
 [17313 47996 11699]
 [ 8791 10507 16048]]
testing model on single stock: results/universal/W10/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
22048/22048 - 314s - 314s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1765777
{'0': {'precision': 0.43545724891529175, 'recall': 0.30126957618637606, 'f1-score': 0.3561429185367075, 'support': 2075417}, '1': {'precision': 0.2729641920856261, 'recall': 0.29324382696575774, 'f1-score': 0.28274083594192634, 'support': 1442281}, '2': {'precision': 0.4186279790158134, 'recall': 0.523442768662086, 'f1-score': 0.46520452718774435, 'support': 2126370}, 'accuracy': 0.38292114836320185, 'macro avg': {'precision': 0.37568314000557707, 'recall': 0.37265205727140654, 'f1-score': 0.36802942722212606, 'support': 5644068}, 'weighted avg': {'precision': 0.38759356209693646, 'recall': 0.38292114836320185, 'f1-score': 0.3784741349041258, 'support': 5644068}}
[[ 625260  566653  883504]
 [ 357114  422940  662227]
 [ 453496  559841 1113033]]
Evaluating performance on  train set...
5429/5429 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1577109
{'0': {'precision': 0.4088908134859264, 'recall': 0.3598442532452685, 'f1-score': 0.3828029078037186, 'support': 459207}, '1': {'precision': 0.35577767603987165, 'recall': 0.39429421320592833, 'f1-score': 0.3740470236564337, 'support': 459218}, '2': {'precision': 0.40735791986374065, 'recall': 0.4119960710353416, 'f1-score': 0.40966386776204, 'support': 471371}, 'accuracy': 0.3889153516055594, 'macro avg': {'precision': 0.3906754697965129, 'recall': 0.3887115124955128, 'f1-score': 0.3888379330740641, 'support': 1389796}, 'weighted avg': {'precision': 0.39082120445605034, 'recall': 0.3889153516055594, 'f1-score': 0.38902009216039113, 'support': 1389796}}
[[165243 160281 133683]
 [129299 181067 148852]
 [109583 167585 194203]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1601602
{'0': {'precision': 0.39024223659047447, 'recall': 0.33567241536874814, 'f1-score': 0.36090621337282347, 'support': 153194}, '1': {'precision': 0.3720121504137425, 'recall': 0.4123653885228295, 'f1-score': 0.39115075923402026, 'support': 172255}, '2': {'precision': 0.3980615700040384, 'recall': 0.40494760393886914, 'f1-score': 0.40147506211365, 'support': 158218}, 'accuracy': 0.38564756330285094, 'macro avg': {'precision': 0.3867719856694185, 'recall': 0.3843284692768156, 'f1-score': 0.3845106782401646, 'support': 483667}, 'weighted avg': {'precision': 0.3863075786536177, 'recall': 0.38564756330285094, 'f1-score': 0.3849485738344563, 'support': 483667}}
[[51423 59368 42403]
 [46741 71032 54482]
 [33608 60540 64070]]
training model: results/universal/W10/deepLOB_L2/h30
Epoch 1/50
8543/8543 - 363s - loss: 3.0210 - accuracy30: 0.4638 - val_loss: 3.3368 - val_accuracy30: 0.3931 - 363s/epoch - 42ms/step
Epoch 2/50
8543/8543 - 356s - loss: 2.9771 - accuracy30: 0.4763 - val_loss: 3.3763 - val_accuracy30: 0.3902 - 356s/epoch - 42ms/step
Epoch 3/50
8543/8543 - 358s - loss: 2.9361 - accuracy30: 0.4882 - val_loss: 3.3960 - val_accuracy30: 0.4352 - 358s/epoch - 42ms/step
Epoch 4/50
8543/8543 - 356s - loss: 2.9072 - accuracy30: 0.4957 - val_loss: 3.3774 - val_accuracy30: 0.4557 - 356s/epoch - 42ms/step
Epoch 5/50
8543/8543 - 357s - loss: 2.8876 - accuracy30: 0.5005 - val_loss: 3.4632 - val_accuracy30: 0.4556 - 357s/epoch - 42ms/step
Epoch 6/50
8543/8543 - 358s - loss: 2.8740 - accuracy30: 0.5037 - val_loss: 3.3784 - val_accuracy30: 0.4557 - 358s/epoch - 42ms/step
Epoch 7/50
8543/8543 - 358s - loss: 2.8649 - accuracy30: 0.5055 - val_loss: 3.3437 - val_accuracy30: 0.4521 - 358s/epoch - 42ms/step
Epoch 8/50
8543/8543 - 356s - loss: 2.8566 - accuracy30: 0.5078 - val_loss: 3.4532 - val_accuracy30: 0.4548 - 356s/epoch - 42ms/step
Epoch 9/50
8543/8543 - 356s - loss: 2.8508 - accuracy30: 0.5090 - val_loss: 3.4108 - val_accuracy30: 0.4618 - 356s/epoch - 42ms/step
Epoch 10/50
8543/8543 - 355s - loss: 2.8446 - accuracy30: 0.5105 - val_loss: 3.3834 - val_accuracy30: 0.4593 - 355s/epoch - 42ms/step
Epoch 11/50
8543/8543 - 356s - loss: 2.8399 - accuracy30: 0.5116 - val_loss: 3.3246 - val_accuracy30: 0.4607 - 356s/epoch - 42ms/step
Epoch 12/50
8543/8543 - 355s - loss: 2.8356 - accuracy30: 0.5123 - val_loss: 3.3654 - val_accuracy30: 0.4594 - 355s/epoch - 42ms/step
Epoch 13/50
8543/8543 - 356s - loss: 2.8321 - accuracy30: 0.5132 - val_loss: 3.4138 - val_accuracy30: 0.4584 - 356s/epoch - 42ms/step
Epoch 14/50
8543/8543 - 356s - loss: 2.8288 - accuracy30: 0.5140 - val_loss: 3.6112 - val_accuracy30: 0.4559 - 356s/epoch - 42ms/step
Epoch 15/50
8543/8543 - 356s - loss: 2.8253 - accuracy30: 0.5149 - val_loss: 3.4137 - val_accuracy30: 0.4507 - 356s/epoch - 42ms/step
Epoch 16/50
8543/8543 - 356s - loss: 2.8225 - accuracy30: 0.5155 - val_loss: 3.4523 - val_accuracy30: 0.4526 - 356s/epoch - 42ms/step
Epoch 17/50
8543/8543 - 357s - loss: 2.8204 - accuracy30: 0.5159 - val_loss: 3.4011 - val_accuracy30: 0.4477 - 357s/epoch - 42ms/step
Epoch 18/50
8543/8543 - 356s - loss: 2.8174 - accuracy30: 0.5164 - val_loss: 3.6101 - val_accuracy30: 0.4570 - 356s/epoch - 42ms/step
Epoch 19/50
8543/8543 - 357s - loss: 2.8153 - accuracy30: 0.5173 - val_loss: 3.5971 - val_accuracy30: 0.4496 - 357s/epoch - 42ms/step
Epoch 20/50
8543/8543 - 357s - loss: 2.8130 - accuracy30: 0.5175 - val_loss: 3.6236 - val_accuracy30: 0.4514 - 357s/epoch - 42ms/step
Epoch 21/50
8543/8543 - 358s - loss: 2.8113 - accuracy30: 0.5181 - val_loss: 3.6419 - val_accuracy30: 0.4511 - 358s/epoch - 42ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 534s - 534s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.088048
{'0': {'precision': 0.407239113135897, 'recall': 0.42089108353025595, 'f1-score': 0.41395256995505164, 'support': 2946166}, '1': {'precision': 0.4492630284482548, 'recall': 0.5351925453947669, 'f1-score': 0.4884775507103244, 'support': 3604215}, '2': {'precision': 0.4268650507553371, 'recall': 0.31453158004045545, 'f1-score': 0.3621881548989832, 'support': 2994898}, 'accuracy': 0.4306792918258335, 'macro avg': {'precision': 0.427789064113163, 'recall': 0.42353840298849277, 'f1-score': 0.4215394251881197, 'support': 9545279}, 'weighted avg': {'precision': 0.42926475610056214, 'recall': 0.4306792918258335, 'f1-score': 0.425851112720567, 'support': 9545279}}
[[1240015 1175200  530951]
 [ 941444 1928949  733822]
 [ 863472 1189436  941990]]
Evaluating performance on  train set...
8543/8543 - 121s - 121s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1179936
{'0': {'precision': 0.39253727062769184, 'recall': 0.3724238602242098, 'f1-score': 0.38221614069785487, 'support': 624772}, '1': {'precision': 0.4573395899667105, 'recall': 0.669885604243972, 'f1-score': 0.5435740952970209, 'support': 923286}, '2': {'precision': 0.4314045276364645, 'recall': 0.16318490844922667, 'f1-score': 0.23679770972854147, 'support': 638662}, 'accuracy': 0.436908246140338, 'macro avg': {'precision': 0.4270937960769556, 'recall': 0.4018314576391362, 'f1-score': 0.38752931524113904, 'support': 2186720}, 'weighted avg': {'precision': 0.4312500982000294, 'recall': 0.436908246140338, 'f1-score': 0.4078738904373378, 'support': 2186720}}
[[232680 348777  43315]
 [210742 618496  94048]
 [149337 385105 104220]]
Evaluating performance on  val set...
3077/3077 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0753857
{'0': {'precision': 0.37167018117657186, 'recall': 0.33549740457125654, 'f1-score': 0.35265864458254115, 'support': 205939}, '1': {'precision': 0.4995579867357417, 'recall': 0.6999713318260005, 'f1-score': 0.5830224637093505, 'support': 369748}, '2': {'precision': 0.4171257066403095, 'recall': 0.16381073200287802, 'f1-score': 0.23523973638684106, 'support': 211256}, 'accuracy': 0.4606572521770954, 'macro avg': {'precision': 0.429451291517541, 'recall': 0.399759822800045, 'f1-score': 0.39030694822624423, 'support': 786943}, 'weighted avg': {'precision': 0.443961329096128, 'recall': 0.4606572521770954, 'f1-score': 0.4293746361152299, 'support': 786943}}
[[ 69092 123818  13029]
 [ 75607 258813  35328]
 [ 41197 135453  34606]]
testing model out of sample: results/universal/W10/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 300s - 300s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9065327
{'0': {'precision': 0.4754473770856257, 'recall': 0.4802891404602624, 'f1-score': 0.47785599458080236, 'support': 1407067}, '1': {'precision': 0.6663442215977788, 'recall': 0.718639508143218, 'f1-score': 0.6915045619382896, 'support': 2650365}, '2': {'precision': 0.49090585799743447, 'recall': 0.41313284408141276, 'f1-score': 0.44867400659804474, 'support': 1403367}, 'accuracy': 0.5787125656886474, 'macro avg': {'precision': 0.5442324855602797, 'recall': 0.5373538308949644, 'f1-score': 0.5393448543723789, 'support': 5460799}, 'weighted avg': {'precision': 0.5720706436235837, 'recall': 0.5787125656886474, 'f1-score': 0.5740495454320657, 'support': 5460799}}
[[ 675799  470095  261173]
 [ 405623 1904657  340085]
 [ 339974  483616  579777]]
Evaluating performance on  train set...
4055/4055 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9202807
{'0': {'precision': 0.44842917036872504, 'recall': 0.5122101090188306, 'f1-score': 0.4782022954302359, 'support': 252250}, '1': {'precision': 0.6807677678869863, 'recall': 0.669854741000463, 'f1-score': 0.6752671658271636, 'support': 529055}, '2': {'precision': 0.46482179230520415, 'recall': 0.41511076412608566, 'f1-score': 0.43856208746002184, 'support': 256175}, 'accuracy': 0.5686239734741875, 'macro avg': {'precision': 0.5313395768536385, 'recall': 0.5323918713817931, 'f1-score': 0.5306771829058071, 'support': 1037480}, 'weighted avg': {'precision': 0.5709561363194916, 'recall': 0.5686239734741875, 'f1-score': 0.5689060436770234, 'support': 1037480}}
[[129205  80488  42557]
 [ 94785 354390  79880]
 [ 64138  85696 106341]]
Evaluating performance on  val set...
1545/1545 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9483315
{'0': {'precision': 0.4209812008020524, 'recall': 0.506361242759347, 'f1-score': 0.4597407688960924, 'support': 94950}, '1': {'precision': 0.6704435934177447, 'recall': 0.6507585319375355, 'f1-score': 0.6604544153032365, 'support': 202035}, '2': {'precision': 0.44749689697972694, 'recall': 0.3866013071895425, 'f1-score': 0.41482617867024624, 'support': 97920}, 'accuracy': 0.550540003291931, 'macro avg': {'precision': 0.512973897066508, 'recall': 0.5145736939621416, 'f1-score': 0.5116737876231917, 'support': 394905}, 'weighted avg': {'precision': 0.5551819616478996, 'recall': 0.550540003291931, 'f1-score': 0.5512897360576945, 'support': 394905}}
[[ 48079  31001  15870]
 [ 39690 131476  30869]
 [ 26438  33626  37856]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.113028
{'0': {'precision': 0.4693628175565147, 'recall': 0.4610128150528476, 'f1-score': 0.4651503462015489, 'support': 51658}, '1': {'precision': 0.30551860506920725, 'recall': 0.25788243862470794, 'f1-score': 0.2796866771985255, 'support': 32953}, '2': {'precision': 0.435233831582063, 'recall': 0.49015604491760245, 'f1-score': 0.46106511194943894, 'support': 47999}, 'accuracy': 0.42108438277656285, 'macro avg': {'precision': 0.40337175140259496, 'recall': 0.4030170995317193, 'f1-score': 0.4019673784498378, 'support': 132610}, 'weighted avg': {'precision': 0.41629505847437953, 'recall': 0.42108438277656285, 'f1-score': 0.4175847671085419, 'support': 132610}}
[[23815 10178 17665]
 [11591  8498 12864]
 [15333  9139 23527]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1193936
{'0': {'precision': 0.44306503329770613, 'recall': 0.47065502183406116, 'f1-score': 0.45644348452123834, 'support': 11450}, '1': {'precision': 0.4041324330920036, 'recall': 0.43628699394045845, 'f1-score': 0.4195945945945946, 'support': 11387}, '2': {'precision': 0.4453227931488801, 'recall': 0.3825526728190841, 'f1-score': 0.4115580948812813, 'support': 11486}, 'accuracy': 0.4297701249890744, 'macro avg': {'precision': 0.43084008651286326, 'recall': 0.4298315628645346, 'f1-score': 0.42919872466570475, 'support': 34323}, 'weighted avg': {'precision': 0.4309042988370893, 'recall': 0.4297701249890744, 'f1-score': 0.4291978505440441, 'support': 34323}}
[[5389 3497 2564]
 [3510 4968 2909]
 [3264 3828 4394]]
Evaluating performance on  val set...
46/46 - 1s - 835ms/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1373272
{'0': {'precision': 0.44677661169415295, 'recall': 0.44644194756554306, 'f1-score': 0.44660921693518174, 'support': 4005}, '1': {'precision': 0.3768431230360164, 'recall': 0.4095087995797216, 'f1-score': 0.39249748237663645, 'support': 3807}, '2': {'precision': 0.42506350550381033, 'recall': 0.3891472868217054, 'f1-score': 0.40631323350870097, 'support': 3870}, 'accuracy': 0.41542544084916966, 'macro avg': {'precision': 0.41622774674465984, 'recall': 0.4150326779889901, 'f1-score': 0.4151399776068397, 'support': 11682}, 'weighted avg': {'precision': 0.4167931745876513, 'recall': 0.41542544084916966, 'f1-score': 0.41562575268891716, 'support': 11682}}
[[1788 1274  943]
 [1154 1559 1094]
 [1060 1304 1506]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8466215
{'0': {'precision': 0.3203787907256398, 'recall': 0.6331392585551331, 'f1-score': 0.425465234076743, 'support': 67328}, '1': {'precision': 0.8579880699625922, 'recall': 0.6304817490482997, 'f1-score': 0.7268482196999545, 'support': 336503}, '2': {'precision': 0.3736443174421042, 'recall': 0.5044387511916111, 'f1-score': 0.4293003238830471, 'support': 67136}, 'accuracy': 0.6128943216828355, 'macro avg': {'precision': 0.5173370593767788, 'recall': 0.5893532529316813, 'f1-score': 0.5272045925532481, 'support': 470967}, 'weighted avg': {'precision': 0.7120902475638233, 'recall': 0.6128943216828355, 'f1-score': 0.6413481970028154, 'support': 470967}}
[[ 42628  17165   7535]
 [ 75108 212159  49236]
 [ 15319  17951  33866]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8727186
{'0': {'precision': 0.24367928103513617, 'recall': 0.6928346032479027, 'f1-score': 0.3605487133273255, 'support': 12993}, '1': {'precision': 0.9212658902456229, 'recall': 0.5388649491152471, 'f1-score': 0.6799909757212191, 'support': 109070}, '2': {'precision': 0.2559286827072875, 'recall': 0.6650922177237967, 'f1-score': 0.369625, 'support': 13338}, 'accuracy': 0.5660741058042408, 'macro avg': {'precision': 0.4736246179960155, 'recall': 0.6322639233623155, 'f1-score': 0.470054896349515, 'support': 135401}, 'weighted avg': {'precision': 0.7907044432281106, 'recall': 0.5660741058042408, 'f1-score': 0.6187641406206403, 'support': 135401}}
[[ 9002  2359  1632]
 [26137 58774 24159]
 [ 1803  2664  8871]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81407297
{'0': {'precision': 0.31693388974302655, 'recall': 0.6654880860876249, 'f1-score': 0.4293790914501091, 'support': 6505}, '1': {'precision': 0.8910498629325035, 'recall': 0.6046049820274992, 'f1-score': 0.7203977417374245, 'support': 39783}, '2': {'precision': 0.3350229302437847, 'recall': 0.6128937297615543, 'f1-score': 0.4332310253342351, 'support': 6794}, 'accuracy': 0.6131268603293019, 'macro avg': {'precision': 0.514335560973105, 'recall': 0.6276622659588927, 'f1-score': 0.527669286173923, 'support': 53082}, 'weighted avg': {'precision': 0.7495278519629714, 'recall': 0.6131268603293019, 'f1-score': 0.6479798412935404, 'support': 53082}}
[[ 4329  1289   887]
 [ 8352 24053  7378]
 [  978  1652  4164]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2223389
{'0': {'precision': 0.4192013943523887, 'recall': 0.3973748522780729, 'f1-score': 0.4079964188106682, 'support': 87157}, '1': {'precision': 0.33170669362241045, 'recall': 0.3733652437748483, 'f1-score': 0.35130528945247375, 'support': 76464}, '2': {'precision': 0.400060872763243, 'recall': 0.3759145832836817, 'f1-score': 0.38761204391445647, 'support': 83918}, 'accuracy': 0.3826831327588784, 'macro avg': {'precision': 0.3836563202460141, 'recall': 0.38221822644553427, 'f1-score': 0.3823045840591995, 'support': 247539}, 'weighted avg': {'precision': 0.38568575000004424, 'recall': 0.3826831327588784, 'f1-score': 0.3835742207417365, 'support': 247539}}
[[34634 29272 23251]
 [23859 28549 24056]
 [24126 28246 31546]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2228259
{'0': {'precision': 0.3989935916734764, 'recall': 0.5002156799309824, 'f1-score': 0.44390745747302435, 'support': 18546}, '1': {'precision': 0.37424400417101145, 'recall': 0.38701676821049225, 'f1-score': 0.38052323269806765, 'support': 18547}, '2': {'precision': 0.42916004047997686, 'recall': 0.30967035259753806, 'f1-score': 0.35975277222323215, 'support': 19172}, 'accuracy': 0.3979738736336977, 'macro avg': {'precision': 0.40079921210815495, 'recall': 0.39896760024633754, 'f1-score': 0.39472782079810803, 'support': 56265}, 'weighted avg': {'precision': 0.4011142805050771, 'recall': 0.3979738736336977, 'f1-score': 0.3943384386778561, 'support': 56265}}
[[9277 5565 3704]
 [7176 7178 4193]
 [6798 6437 5937]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.202986
{'0': {'precision': 0.4153057575396352, 'recall': 0.5028868360277137, 'f1-score': 0.4549193706339361, 'support': 6928}, '1': {'precision': 0.3443413729128015, 'recall': 0.2927906609875375, 'f1-score': 0.31648051837326285, 'support': 6339}, '2': {'precision': 0.41477090676065365, 'recall': 0.38332839798637847, 'f1-score': 0.39843028624192056, 'support': 6754}, 'accuracy': 0.39603416412766596, 'macro avg': {'precision': 0.3914726790710301, 'recall': 0.3930019650005432, 'f1-score': 0.38994339174970644, 'support': 20021}, 'weighted avg': {'precision': 0.39265675817343265, 'recall': 0.39603416412766596, 'f1-score': 0.39203084556205753, 'support': 20021}}
[[3484 1727 1717]
 [2547 1856 1936]
 [2358 1807 2589]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1588/1588 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2401427
{'0': {'precision': 0.36857212732819317, 'recall': 0.4044893029431915, 'f1-score': 0.3856963419192548, 'support': 141581}, '1': {'precision': 0.3010958395245171, 'recall': 0.2622163272568462, 'f1-score': 0.2803143615503662, 'support': 123646}, '2': {'precision': 0.39856033736420254, 'recall': 0.40468881815410573, 'f1-score': 0.40160119878854816, 'support': 141059}, 'accuracy': 0.36126029447236674, 'macro avg': {'precision': 0.35607610140563756, 'recall': 0.35713148278471446, 'f1-score': 0.3558706340860564, 'support': 406286}, 'weighted avg': {'precision': 0.3584485538791846, 'recall': 0.36126029447236674, 'f1-score': 0.35914721854417925, 'support': 406286}}
[[57268 40744 43569]
 [48650 32422 42574]
 [49460 34514 57085]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.279985
{'0': {'precision': 0.3670916118532583, 'recall': 0.4123000761614623, 'f1-score': 0.38838468988772107, 'support': 26260}, '1': {'precision': 0.33682852072914987, 'recall': 0.41966475057281827, 'f1-score': 0.3737113402061856, 'support': 24877}, '2': {'precision': 0.3889074061729218, 'recall': 0.23955980782655115, 'f1-score': 0.29648828581592723, 'support': 24353}, 'accuracy': 0.3590011922108889, 'macro avg': {'precision': 0.3642758462517766, 'recall': 0.3571748781869439, 'f1-score': 0.35286143863661135, 'support': 75490}, 'weighted avg': {'precision': 0.36415645648396855, 'recall': 0.3590011922108889, 'f1-score': 0.3539035394255678, 'support': 75490}}
[[10827 10953  4480]
 [ 9750 10440  4687]
 [ 8917  9602  5834]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2578071
{'0': {'precision': 0.36692205196535643, 'recall': 0.3880912534131947, 'f1-score': 0.37720987971405334, 'support': 11353}, '1': {'precision': 0.3252518049737053, 'recall': 0.32107347118345797, 'f1-score': 0.3231491321289408, 'support': 11365}, '2': {'precision': 0.35667028735064676, 'recall': 0.3396013538924408, 'f1-score': 0.3479266002022829, 'support': 10636}, 'accuracy': 0.3497931282604785, 'macro avg': {'precision': 0.3496147147632362, 'recall': 0.34958869282969784, 'f1-score': 0.34942853734842566, 'support': 33354}, 'weighted avg': {'precision': 0.34945427822001357, 'recall': 0.3497931282604785, 'f1-score': 0.34945136927476583, 'support': 33354}}
[[4406 4080 2867]
 [4068 3649 3648]
 [3534 3490 3612]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1805826
{'0': {'precision': 0.458051637720014, 'recall': 0.4453547783874654, 'f1-score': 0.4516139845137935, 'support': 211766}, '1': {'precision': 0.24710297470525333, 'recall': 0.3130837139545981, 'f1-score': 0.2762076236942704, 'support': 117352}, '2': {'precision': 0.46143560643120374, 'recall': 0.40533223836556964, 'f1-score': 0.43156821826999575, 'support': 209443}, 'accuracy': 0.4009685068172408, 'macro avg': {'precision': 0.3888634062854903, 'recall': 0.38792357690254436, 'f1-score': 0.3864632754926865, 'support': 538561}, 'weighted avg': {'precision': 0.41340210137532796, 'recall': 0.4009685068172408, 'f1-score': 0.4055974094660414, 'support': 538561}}
[[94311 56426 61029]
 [42556 36741 38055]
 [69029 55520 84894]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1821177
{'0': {'precision': 0.41461085468725134, 'recall': 0.4320782882733455, 'f1-score': 0.4231643924626381, 'support': 36174}, '1': {'precision': 0.3721068864525827, 'recall': 0.3953462756436734, 'f1-score': 0.3833747229565543, 'support': 36315}, '2': {'precision': 0.42591756240026496, 'recall': 0.3822726658559654, 'f1-score': 0.40291663106326014, 'support': 37005}, 'accuracy': 0.4030631815441942, 'macro avg': {'precision': 0.40421176784669965, 'recall': 0.40323240992432813, 'f1-score': 0.4031519154941508, 'support': 109494}, 'weighted avg': {'precision': 0.40433516024260663, 'recall': 0.4030631815441942, 'f1-score': 0.40312466189569, 'support': 109494}}
[[15630 11612  8932]
 [11823 14357 10135]
 [10245 12614 14146]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1752874
{'0': {'precision': 0.39949266419854657, 'recall': 0.48867829587386785, 'f1-score': 0.439607695209355, 'support': 11924}, '1': {'precision': 0.37314509480626545, 'recall': 0.3135064935064935, 'f1-score': 0.34073586148489693, 'support': 11550}, '2': {'precision': 0.43482749720382, 'recall': 0.40630275745638716, 'f1-score': 0.42008145623805165, 'support': 12439}, 'accuracy': 0.40380920558015204, 'macro avg': {'precision': 0.4024884187362107, 'recall': 0.4028291822789161, 'f1-score': 0.4001416709774345, 'support': 35913}, 'weighted avg': {'precision': 0.4032577509713517, 'recall': 0.40380920558015204, 'f1-score': 0.4010462671448231, 'support': 35913}}
[[5827 2968 3129]
 [4489 3621 3440]
 [4270 3115 5054]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86221915
{'0': {'precision': 0.38275056039701283, 'recall': 0.6596903420947154, 'f1-score': 0.4844338849746026, 'support': 242009}, '1': {'precision': 0.817434322026339, 'recall': 0.5310189772562653, 'f1-score': 0.6438089296641242, 'support': 862875}, '2': {'precision': 0.40374754409827923, 'recall': 0.6148784447504162, 'f1-score': 0.48743241327966036, 'support': 243305}, 'accuracy': 0.5692503054097015, 'macro avg': {'precision': 0.534644142173877, 'recall': 0.601862588033799, 'f1-score': 0.5385584093061291, 'support': 1348189}, 'weighted avg': {'precision': 0.6647484271169916, 'recall': 0.5692503054097015, 'f1-score': 0.5869790760536968, 'support': 1348189}}
[[159651  49917  32441]
 [216180 458203 188492]
 [ 41284  52418 149603]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7374689
{'0': {'precision': 0.36929315324251, 'recall': 0.6736556421786446, 'f1-score': 0.47706352870238644, 'support': 37583}, '1': {'precision': 0.8645255114296658, 'recall': 0.6813586033279436, 'f1-score': 0.7620906242399096, 'support': 195436}, '2': {'precision': 0.4399498726271674, 'recall': 0.559957117456333, 'f1-score': 0.492751955821445, 'support': 38244}, 'accuracy': 0.6631755897413212, 'macro avg': {'precision': 0.5579228457664477, 'recall': 0.638323787654307, 'f1-score': 0.5773020362545803, 'support': 271263}, 'weighted avg': {'precision': 0.7360531858706673, 'recall': 0.6631755897413212, 'f1-score': 0.6846279353859838, 'support': 271263}}
[[ 25318   9196   3069]
 [ 38082 133162  24192]
 [  5158  11671  21415]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7834977
{'0': {'precision': 0.33670520231213874, 'recall': 0.7195059186824498, 'f1-score': 0.4587366694011485, 'support': 13601}, '1': {'precision': 0.8878138418555812, 'recall': 0.6225167304329534, 'f1-score': 0.7318649045521294, 'support': 76059}, '2': {'precision': 0.39255628004378657, 'recall': 0.6000290993743634, 'f1-score': 0.47460943119371635, 'support': 13746}, 'accuracy': 0.6322843935554997, 'macro avg': {'precision': 0.5390251080705022, 'recall': 0.6473505828299223, 'f1-score': 0.555070335048998, 'support': 103406}, 'weighted avg': {'precision': 0.7494907363191975, 'recall': 0.6322843935554997, 'f1-score': 0.6617427562911654, 'support': 103406}}
[[ 9786  2643  1172]
 [17120 47348 11591]
 [ 2158  3340  8248]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
10110/10110 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74061346
{'0': {'precision': 0.5737621235324145, 'recall': 0.39815211134562306, 'f1-score': 0.4700920980404116, 'support': 474271}, '1': {'precision': 0.7562173348204938, 'recall': 0.8652678854660285, 'f1-score': 0.807075594728223, 'support': 1636091}, '2': {'precision': 0.5230317987414882, 'recall': 0.4236518266249982, 'f1-score': 0.4681255088446451, 'support': 477739}, 'accuracy': 0.6981504972178443, 'macro avg': {'precision': 0.6176704190314655, 'recall': 0.5623572744788833, 'f1-score': 0.5817644005377599, 'support': 2588101}, 'weighted avg': {'precision': 0.6797384646629316, 'recall': 0.6981504972178443, 'f1-score': 0.682756190254611, 'support': 2588101}}
[[ 188832  234211   51228]
 [  87092 1415657  133342]
 [  53188  222156  202395]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75431985
{'0': {'precision': 0.46030653134854516, 'recall': 0.4806873741731378, 'f1-score': 0.4702762399848058, 'support': 69540}, '1': {'precision': 0.8080565019875071, 'recall': 0.7775808307974986, 'f1-score': 0.7925257978672486, 'support': 292803}, '2': {'precision': 0.4348158416354662, 'recall': 0.48483929216323585, 'f1-score': 0.45846708648080103, 'support': 69225}, 'accuracy': 0.6827846364883402, 'macro avg': {'precision': 0.5677262916571728, 'recall': 0.5810358323779574, 'f1-score': 0.5737563747776185, 'support': 431568}, 'weighted avg': {'precision': 0.6921532893510202, 'recall': 0.6827846364883402, 'f1-score': 0.6870164724518519, 'support': 431568}}
[[ 33427  28556   7557]
 [ 29056 227678  36069]
 [ 10136  25526  33563]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85591847
{'0': {'precision': 0.3941838250902144, 'recall': 0.5068692566645437, 'f1-score': 0.4434803375258717, 'support': 32973}, '1': {'precision': 0.7649218683289215, 'recall': 0.7139744952178534, 'f1-score': 0.7385706237203359, 'support': 112920}, '2': {'precision': 0.41179175864606327, 'recall': 0.3890675241157556, 'f1-score': 0.4001072433978283, 'support': 34521}, 'accuracy': 0.6139545711530148, 'macro avg': {'precision': 0.5236324840217331, 'recall': 0.5366370919993843, 'f1-score': 0.5273860682146786, 'support': 180414}, 'weighted avg': {'precision': 0.6295956186139778, 'recall': 0.6139545711530148, 'f1-score': 0.6198763629711516, 'support': 180414}}
[[16713 12555  3705]
 [16818 80622 15480]
 [ 8868 12222 13431]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
6546/6546 - 93s - 93s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9614911
{'0': {'precision': 0.5061397265405506, 'recall': 0.2967536189867496, 'f1-score': 0.3741438296894319, 'support': 455307}, '1': {'precision': 0.5933224895733833, 'recall': 0.6536757158669624, 'f1-score': 0.6220385906247453, 'support': 770639}, '2': {'precision': 0.43166901873917, 'recall': 0.5371979645327162, 'f1-score': 0.4786863877545159, 'support': 449823}, 'accuracy': 0.5254339947809036, 'macro avg': {'precision': 0.510377078284368, 'recall': 0.49587576646214276, 'f1-score': 0.4916229360228977, 'support': 1675769}, 'weighted avg': {'precision': 0.526242616691591, 'recall': 0.5254339947809036, 'f1-score': 0.5162057831979043, 'support': 1675769}}
[[135114 198436 121757]
 [ 70502 503748 196389]
 [ 61334 146845 241644]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92737377
{'0': {'precision': 0.49414836256314204, 'recall': 0.4826485132048695, 'f1-score': 0.48833074390455944, 'support': 90194}, '1': {'precision': 0.5971763890137264, 'recall': 0.6866146498460902, 'f1-score': 0.6387800581676836, 'support': 135469}, '2': {'precision': 0.5178448044897557, 'recall': 0.4121337268676984, 'f1-score': 0.45898115282707597, 'support': 89107}, 'accuracy': 0.5504685961178003, 'macro avg': {'precision': 0.536389852022208, 'recall': 0.5271322966395527, 'f1-score': 0.528697318299773, 'support': 314770}, 'weighted avg': {'precision': 0.5451971364805707, 'recall': 0.5504685961178003, 'f1-score': 0.544771841028713, 'support': 314770}}
[[43532 31145 15517]
 [23778 93015 18676]
 [20785 31598 36724]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8970129
{'0': {'precision': 0.4800495121596039, 'recall': 0.4613554459256149, 'f1-score': 0.47051686916804936, 'support': 28581}, '1': {'precision': 0.6280836330532631, 'recall': 0.7399345968564296, 'f1-score': 0.6794365742422408, 'support': 56878}, '2': {'precision': 0.5153752835065141, 'recall': 0.34927613941018765, 'f1-score': 0.41637192653513444, 'support': 27975}, 'accuracy': 0.5733995098471357, 'macro avg': {'precision': 0.5411694762397937, 'recall': 0.5168553940640774, 'f1-score': 0.5221084566484749, 'support': 113434}, 'weighted avg': {'precision': 0.5629886942533268, 'recall': 0.5733995098471357, 'f1-score': 0.5619200658732177, 'support': 113434}}
[[13186 12228  3167]
 [ 8771 42086  6021]
 [ 5511 12693  9771]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
7633/7633 - 109s - 109s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9967137
{'0': {'precision': 0.443056841534744, 'recall': 0.5728519533162147, 'f1-score': 0.49966291932835544, 'support': 582215}, '1': {'precision': 0.5733890313736761, 'recall': 0.5269058609151688, 'f1-score': 0.5491655797597753, 'support': 787505}, '2': {'precision': 0.49776671196761785, 'recall': 0.40684583102274985, 'f1-score': 0.44773712934927457, 'support': 584268}, 'accuracy': 0.5046965488017326, 'macro avg': {'precision': 0.5047375282920127, 'recall': 0.5022012150847112, 'f1-score': 0.49885520947913503, 'support': 1953988}, 'weighted avg': {'precision': 0.5119428724301142, 'recall': 0.5046965488017326, 'f1-score': 0.504087212181509, 'support': 1953988}}
[[333523 140448 108244]
 [240968 414941 131596]
 [178286 168275 237707]]
Evaluating performance on  train set...
1586/1586 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96789217
{'0': {'precision': 0.46004784688995215, 'recall': 0.5610262570791145, 'f1-score': 0.5055439573184876, 'support': 116540}, '1': {'precision': 0.5937082135207734, 'recall': 0.590254289630183, 'f1-score': 0.5919762135822098, 'support': 170003}, '2': {'precision': 0.5106657092168624, 'recall': 0.4053920376906117, 'f1-score': 0.45197983017342497, 'support': 119287}, 'accuracy': 0.5275238400315403, 'macro avg': {'precision': 0.521473923209196, 'recall': 0.5188908614666364, 'f1-score': 0.5165000003580408, 'support': 405830}, 'weighted avg': {'precision': 0.5309167236406351, 'recall': 0.5275238400315403, 'f1-score': 0.5260063155148961, 'support': 405830}}
[[ 65382  31422  19736]
 [ 43056 100345  26602]
 [ 33682  37247  48358]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9569991
{'0': {'precision': 0.4518748187638018, 'recall': 0.5178425357873211, 'f1-score': 0.4826148586675561, 'support': 39120}, '1': {'precision': 0.6132396377227487, 'recall': 0.6497871519897952, 'f1-score': 0.6309846171573429, 'support': 67419}, '2': {'precision': 0.49916685725487636, 'recall': 0.3787683458944863, 'f1-score': 0.430711980040314, 'support': 40336}, 'accuracy': 0.5402144680851064, 'macro avg': {'precision': 0.5214271045804756, 'recall': 0.5154660112238676, 'f1-score': 0.5147704852884044, 'support': 146875}, 'weighted avg': {'precision': 0.5389327005950816, 'recall': 0.5402144680851064, 'f1-score': 0.5364659989931017, 'support': 146875}}
[[20258 12500  6362]
 [14644 43808  8967]
 [ 9929 15129 15278]]
testing model on single stock: results/universal/W10/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
22048/22048 - 321s - 321s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1887624
{'0': {'precision': 0.40793186229983563, 'recall': 0.4143271790703751, 'f1-score': 0.41110465013061, 'support': 2039941}, '1': {'precision': 0.28550219942798266, 'recall': 0.47804974605309847, 'f1-score': 0.357498280875063, 'support': 1510552}, '2': {'precision': 0.4407787490458857, 'recall': 0.21956079911156753, 'f1-score': 0.2931150637333501, 'support': 2093575}, 'accuracy': 0.359136176247345, 'macro avg': {'precision': 0.378070936924568, 'recall': 0.370645908078347, 'f1-score': 0.35390599824634106, 'support': 5644068}, 'weighted avg': {'precision': 0.3873493761938849, 'recall': 0.359136176247345, 'f1-score': 0.3529913785269815, 'support': 5644068}}
[[845203 869217 325521]
 [530769 722119 257664]
 [695950 937958 459667]]
Evaluating performance on  train set...
5429/5429 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2503741
{'0': {'precision': 0.3886591673306235, 'recall': 0.31437578373843783, 'f1-score': 0.34759304683471076, 'support': 457742}, '1': {'precision': 0.3405252966354915, 'recall': 0.7035232988827181, 'f1-score': 0.458920171092436, 'support': 458434}, '2': {'precision': 0.43415402035377454, 'recall': 0.066384443224526, 'f1-score': 0.11516027243475283, 'support': 473620}, 'accuracy': 0.3582273945240884, 'macro avg': {'precision': 0.3877794947732965, 'recall': 0.36142784194856065, 'f1-score': 0.30722449678729985, 'support': 1389796}, 'weighted avg': {'precision': 0.38828578117220364, 'recall': 0.3582273945240884, 'f1-score': 0.30510575249126604, 'support': 1389796}}
[[143903 295187  18652]
 [113589 322519  22326]
 [112763 329416  31441]]
Evaluating performance on  val set...
1890/1890 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.195625
{'0': {'precision': 0.3612884559745395, 'recall': 0.2567666673520723, 'f1-score': 0.30018951155699974, 'support': 145899}, '1': {'precision': 0.39336284417717643, 'recall': 0.7610132336545246, 'f1-score': 0.518642643061523, 'support': 185663}, '2': {'precision': 0.4346947611487949, 'recall': 0.05940633115282206, 'f1-score': 0.10452768202114615, 'support': 152105}, 'accuracy': 0.3882629991295664, 'macro avg': {'precision': 0.3964486871001703, 'recall': 0.359062077386473, 'f1-score': 0.30778661221322295, 'support': 483667}, 'weighted avg': {'precision': 0.3966857296884714, 'recall': 0.3882629991295664, 'f1-score': 0.3225137990791447, 'support': 483667}}
[[ 37462 103496   4941]
 [ 37561 141292   6810]
 [ 28667 114402   9036]]
training model: results/universal/W10/deepOF_L2/h10
Epoch 1/50
8543/8543 - 199s - loss: 2.8041 - accuracy10: 0.5309 - val_loss: 2.9958 - val_accuracy10: 0.5215 - 199s/epoch - 23ms/step
Epoch 2/50
8543/8543 - 193s - loss: 2.7260 - accuracy10: 0.5465 - val_loss: 2.9866 - val_accuracy10: 0.5211 - 193s/epoch - 23ms/step
Epoch 3/50
8543/8543 - 193s - loss: 2.6993 - accuracy10: 0.5516 - val_loss: 2.9754 - val_accuracy10: 0.5240 - 193s/epoch - 23ms/step
Epoch 4/50
8543/8543 - 193s - loss: 2.6860 - accuracy10: 0.5542 - val_loss: 2.9898 - val_accuracy10: 0.5259 - 193s/epoch - 23ms/step
Epoch 5/50
8543/8543 - 193s - loss: 2.6771 - accuracy10: 0.5562 - val_loss: 2.9775 - val_accuracy10: 0.5230 - 193s/epoch - 23ms/step
Epoch 6/50
8543/8543 - 193s - loss: 2.6704 - accuracy10: 0.5573 - val_loss: 2.9728 - val_accuracy10: 0.5256 - 193s/epoch - 23ms/step
Epoch 7/50
8543/8543 - 192s - loss: 2.6651 - accuracy10: 0.5584 - val_loss: 2.9943 - val_accuracy10: 0.5242 - 192s/epoch - 23ms/step
Epoch 8/50
8543/8543 - 193s - loss: 2.6603 - accuracy10: 0.5593 - val_loss: 2.9706 - val_accuracy10: 0.5243 - 193s/epoch - 23ms/step
Epoch 9/50
8543/8543 - 192s - loss: 2.6560 - accuracy10: 0.5601 - val_loss: 2.9565 - val_accuracy10: 0.5221 - 192s/epoch - 23ms/step
Epoch 10/50
8543/8543 - 191s - loss: 2.6531 - accuracy10: 0.5608 - val_loss: 2.9426 - val_accuracy10: 0.5214 - 191s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 193s - loss: 2.6495 - accuracy10: 0.5618 - val_loss: 2.9739 - val_accuracy10: 0.5191 - 193s/epoch - 23ms/step
Epoch 12/50
8543/8543 - 193s - loss: 2.6466 - accuracy10: 0.5624 - val_loss: 2.9359 - val_accuracy10: 0.5259 - 193s/epoch - 23ms/step
Epoch 13/50
8543/8543 - 192s - loss: 2.6441 - accuracy10: 0.5628 - val_loss: 2.9351 - val_accuracy10: 0.5197 - 192s/epoch - 22ms/step
Epoch 14/50
8543/8543 - 191s - loss: 2.6414 - accuracy10: 0.5634 - val_loss: 2.9236 - val_accuracy10: 0.5197 - 191s/epoch - 22ms/step
Epoch 15/50
8543/8543 - 191s - loss: 2.6390 - accuracy10: 0.5639 - val_loss: 2.9158 - val_accuracy10: 0.5225 - 191s/epoch - 22ms/step
Epoch 16/50
8543/8543 - 191s - loss: 2.6370 - accuracy10: 0.5644 - val_loss: 2.9058 - val_accuracy10: 0.5200 - 191s/epoch - 22ms/step
Epoch 17/50
8543/8543 - 191s - loss: 2.6349 - accuracy10: 0.5645 - val_loss: 2.9039 - val_accuracy10: 0.5221 - 191s/epoch - 22ms/step
Epoch 18/50
8543/8543 - 191s - loss: 2.6330 - accuracy10: 0.5649 - val_loss: 2.9129 - val_accuracy10: 0.5205 - 191s/epoch - 22ms/step
Epoch 19/50
8543/8543 - 192s - loss: 2.6309 - accuracy10: 0.5656 - val_loss: 2.8668 - val_accuracy10: 0.5248 - 192s/epoch - 22ms/step
Epoch 20/50
8543/8543 - 192s - loss: 2.6289 - accuracy10: 0.5658 - val_loss: 2.8914 - val_accuracy10: 0.5235 - 192s/epoch - 22ms/step
Epoch 21/50
8543/8543 - 191s - loss: 2.6275 - accuracy10: 0.5663 - val_loss: 2.8794 - val_accuracy10: 0.5250 - 191s/epoch - 22ms/step
Epoch 22/50
8543/8543 - 192s - loss: 2.6258 - accuracy10: 0.5666 - val_loss: 2.8849 - val_accuracy10: 0.5253 - 192s/epoch - 22ms/step
Epoch 23/50
8543/8543 - 191s - loss: 2.6242 - accuracy10: 0.5669 - val_loss: 2.8757 - val_accuracy10: 0.5261 - 191s/epoch - 22ms/step
Epoch 24/50
8543/8543 - 191s - loss: 2.6225 - accuracy10: 0.5673 - val_loss: 2.8532 - val_accuracy10: 0.5273 - 191s/epoch - 22ms/step
Epoch 25/50
8543/8543 - 191s - loss: 2.6212 - accuracy10: 0.5674 - val_loss: 2.8624 - val_accuracy10: 0.5282 - 191s/epoch - 22ms/step
Epoch 26/50
8543/8543 - 195s - loss: 2.6196 - accuracy10: 0.5678 - val_loss: 2.8667 - val_accuracy10: 0.5253 - 195s/epoch - 23ms/step
Epoch 27/50
8543/8543 - 192s - loss: 2.6183 - accuracy10: 0.5683 - val_loss: 2.8696 - val_accuracy10: 0.5250 - 192s/epoch - 22ms/step
Epoch 28/50
8543/8543 - 191s - loss: 2.6177 - accuracy10: 0.5685 - val_loss: 2.8708 - val_accuracy10: 0.5224 - 191s/epoch - 22ms/step
Epoch 29/50
8543/8543 - 189s - loss: 2.6156 - accuracy10: 0.5685 - val_loss: 2.8493 - val_accuracy10: 0.5275 - 189s/epoch - 22ms/step
Epoch 30/50
8543/8543 - 190s - loss: 2.6144 - accuracy10: 0.5690 - val_loss: 2.8472 - val_accuracy10: 0.5248 - 190s/epoch - 22ms/step
Epoch 31/50
8543/8543 - 190s - loss: 2.6131 - accuracy10: 0.5692 - val_loss: 2.8557 - val_accuracy10: 0.5268 - 190s/epoch - 22ms/step
Epoch 32/50
8543/8543 - 190s - loss: 2.6118 - accuracy10: 0.5697 - val_loss: 2.8536 - val_accuracy10: 0.5271 - 190s/epoch - 22ms/step
Epoch 33/50
8543/8543 - 190s - loss: 2.6104 - accuracy10: 0.5698 - val_loss: 2.8594 - val_accuracy10: 0.5259 - 190s/epoch - 22ms/step
Epoch 34/50
8543/8543 - 189s - loss: 2.6097 - accuracy10: 0.5698 - val_loss: 2.8546 - val_accuracy10: 0.5260 - 189s/epoch - 22ms/step
Epoch 35/50
8543/8543 - 190s - loss: 2.6079 - accuracy10: 0.5704 - val_loss: 2.8449 - val_accuracy10: 0.5275 - 190s/epoch - 22ms/step
Epoch 36/50
8543/8543 - 191s - loss: 2.6071 - accuracy10: 0.5705 - val_loss: 2.8443 - val_accuracy10: 0.5273 - 191s/epoch - 22ms/step
Epoch 37/50
8543/8543 - 189s - loss: 2.6060 - accuracy10: 0.5707 - val_loss: 2.8455 - val_accuracy10: 0.5262 - 189s/epoch - 22ms/step
Epoch 38/50
8543/8543 - 190s - loss: 2.6046 - accuracy10: 0.5712 - val_loss: 2.8244 - val_accuracy10: 0.5296 - 190s/epoch - 22ms/step
Epoch 39/50
8543/8543 - 187s - loss: 2.6039 - accuracy10: 0.5711 - val_loss: 2.8399 - val_accuracy10: 0.5236 - 187s/epoch - 22ms/step
Epoch 40/50
8543/8543 - 190s - loss: 2.6028 - accuracy10: 0.5713 - val_loss: 2.8474 - val_accuracy10: 0.5250 - 190s/epoch - 22ms/step
Epoch 41/50
8543/8543 - 191s - loss: 2.6017 - accuracy10: 0.5716 - val_loss: 2.8441 - val_accuracy10: 0.5240 - 191s/epoch - 22ms/step
Epoch 42/50
8543/8543 - 190s - loss: 2.6009 - accuracy10: 0.5716 - val_loss: 2.8414 - val_accuracy10: 0.5227 - 190s/epoch - 22ms/step
Epoch 43/50
8543/8543 - 190s - loss: 2.5996 - accuracy10: 0.5720 - val_loss: 2.8146 - val_accuracy10: 0.5301 - 190s/epoch - 22ms/step
Epoch 44/50
8543/8543 - 192s - loss: 2.5984 - accuracy10: 0.5724 - val_loss: 2.8362 - val_accuracy10: 0.5252 - 192s/epoch - 22ms/step
Epoch 45/50
8543/8543 - 188s - loss: 2.5975 - accuracy10: 0.5724 - val_loss: 2.8258 - val_accuracy10: 0.5288 - 188s/epoch - 22ms/step
Epoch 46/50
8543/8543 - 190s - loss: 2.5965 - accuracy10: 0.5728 - val_loss: 2.8254 - val_accuracy10: 0.5266 - 190s/epoch - 22ms/step
Epoch 47/50
8543/8543 - 190s - loss: 2.5957 - accuracy10: 0.5729 - val_loss: 2.8304 - val_accuracy10: 0.5265 - 190s/epoch - 22ms/step
Epoch 48/50
8543/8543 - 190s - loss: 2.5941 - accuracy10: 0.5729 - val_loss: 2.8298 - val_accuracy10: 0.5256 - 190s/epoch - 22ms/step
Epoch 49/50
8543/8543 - 190s - loss: 2.5938 - accuracy10: 0.5730 - val_loss: 2.8487 - val_accuracy10: 0.5220 - 190s/epoch - 22ms/step
Epoch 50/50
8543/8543 - 189s - loss: 2.5931 - accuracy10: 0.5733 - val_loss: 2.8322 - val_accuracy10: 0.5279 - 189s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 291s - 291s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9463038
{'0': {'precision': 0.45116711479433147, 'recall': 0.47613658091407174, 'f1-score': 0.4633156719922967, 'support': 2787593}, '1': {'precision': 0.8039690660598448, 'recall': 0.5249779711666344, 'f1-score': 0.6351886679572809, 'support': 3943695}, '2': {'precision': 0.43640278743534056, 'recall': 0.6247147264750178, 'f1-score': 0.5138493039869574, 'support': 2813966}, 'accuracy': 0.5401170047439282, 'macro avg': {'precision': 0.5638463227631724, 'recall': 0.5419430928519079, 'f1-score': 0.5374512146455116, 'support': 9545254}, 'weighted avg': {'precision': 0.5925773880039263, 'recall': 0.5401170047439282, 'f1-score': 0.5492237680064641, 'support': 9545254}}
[[1327275  244850 1215468]
 [ 818517 2070353 1054825]
 [ 796078  259962 1757926]]
Evaluating performance on  train set...
8543/8543 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95632994
{'0': {'precision': 0.42658392836903547, 'recall': 0.49350606778947514, 'f1-score': 0.4576112292287584, 'support': 579618}, '1': {'precision': 0.7665632217616565, 'recall': 0.5138131650724325, 'f1-score': 0.6152413919087925, 'support': 1022539}, '2': {'precision': 0.414366103939093, 'recall': 0.588900958849039, 'f1-score': 0.4864519228731108, 'support': 584555}, 'accuracy': 0.5285030676193299, 'macro avg': {'precision': 0.5358377513565951, 'recall': 0.5320733972369822, 'f1-score': 0.5197681813368872, 'support': 2186712}, 'weighted avg': {'precision': 0.5822972076334069, 'recall': 0.5285030676193299, 'f1-score': 0.5390311695729618, 'support': 2186712}}
[[286045  76684 216889]
 [227504 525394 269641]
 [156999  83311 344245]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95215905
{'0': {'precision': 0.414401264450711, 'recall': 0.4901470032383618, 'f1-score': 0.44910270720572093, 'support': 195778}, '1': {'precision': 0.7900815217391305, 'recall': 0.5104837441073341, 'f1-score': 0.620228425222337, 'support': 394134}, '2': {'precision': 0.3991626818124381, 'recall': 0.6092351887285627, 'f1-score': 0.48231746395285996, 'support': 197029}, 'accuracy': 0.5301490200663074, 'macro avg': {'precision': 0.5345484893340932, 'recall': 0.5366219786914196, 'f1-score': 0.5172161987936393, 'support': 786941}, 'weighted avg': {'precision': 0.5987428095315718, 'recall': 0.5301490200663074, 'f1-score': 0.5431259364591122, 'support': 786941}}
[[ 95960  26312  73506]
 [ 85756 201199 107179]
 [ 49847  27145 120037]]
testing model out of sample: results/universal/W10/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 168s - 168s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75363374
{'0': {'precision': 0.49938016660951134, 'recall': 0.4356202282807225, 'f1-score': 0.46532622524258743, 'support': 1076394}, '1': {'precision': 0.7892064049789832, 'recall': 0.8220321248977469, 'f1-score': 0.8052848861768703, 'support': 3311637}, '2': {'precision': 0.4799320796730425, 'recall': 0.47979338946979844, 'f1-score': 0.47986272455033996, 'support': 1072743}, 'accuracy': 0.6786338346908332, 'macro avg': {'precision': 0.589506217087179, 'recall': 0.579148580882756, 'f1-score': 0.5834912786565992, 'support': 5460774}, 'weighted avg': {'precision': 0.6713221835160293, 'recall': 0.6786338346908332, 'f1-score': 0.6743467062032208, 'support': 5460774}}
[[ 468899  352070  255425]
 [ 287052 2722272  302313]
 [ 183011  375037  514695]]
Evaluating performance on  train set...
4055/4055 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7568969
{'0': {'precision': 0.4747984335406588, 'recall': 0.4293153367077006, 'f1-score': 0.4509128299368839, 'support': 192036}, '1': {'precision': 0.7859048091002584, 'recall': 0.8087230591531297, 'f1-score': 0.7971506758061037, 'support': 651056}, '2': {'precision': 0.46306841627465545, 'recall': 0.46186059193637174, 'f1-score': 0.4624637154830252, 'support': 194379}, 'accuracy': 0.6735070185094331, 'macro avg': {'precision': 0.5745905529718576, 'recall': 0.5666329959324007, 'f1-score': 0.5701757404086709, 'support': 1037471}, 'weighted avg': {'precision': 0.6678328445460577, 'recall': 0.6735070185094331, 'f1-score': 0.6703555676729788, 'support': 1037471}}
[[ 82444  68515  41077]
 [ 61513 526524  63019]
 [ 29683  74920  89776]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7582724
{'0': {'precision': 0.46960331272880035, 'recall': 0.4369067560022334, 'f1-score': 0.4526653747143725, 'support': 71640}, '1': {'precision': 0.7985250642154408, 'recall': 0.7900661325448043, 'f1-score': 0.7942730773170718, 'support': 250255}, '2': {'precision': 0.4449776190653325, 'recall': 0.49153540610875224, 'f1-score': 0.4670992262086829, 'support': 73010}, 'accuracy': 0.6708069029260202, 'macro avg': {'precision': 0.5710353320031912, 'recall': 0.5728360982185966, 'f1-score': 0.5713458927467091, 'support': 394905}, 'weighted avg': {'precision': 0.673491313700982, 'recall': 0.6708069029260202, 'f1-score': 0.6718139069244942, 'support': 394905}}
[[ 31300  24175  16165]
 [ 23940 197718  28597]
 [ 11412  25711  35887]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0530893
{'0': {'precision': 0.5473901098901099, 'recall': 0.5171661160924964, 'f1-score': 0.5318490657607376, 'support': 50856}, '1': {'precision': 0.42503858566016556, 'recall': 0.3466655222727663, 'f1-score': 0.3818723310379603, 'support': 34953}, '2': {'precision': 0.49023176149440667, 'recall': 0.5871655697068126, 'f1-score': 0.5343380815790753, 'support': 46796}, 'accuracy': 0.4969269635383281, 'macro avg': {'precision': 0.4875534856815607, 'recall': 0.4836657360240251, 'f1-score': 0.48268649279259107, 'support': 132605}, 'weighted avg': {'precision': 0.4949687464578519, 'recall': 0.4969269635383281, 'f1-score': 0.49319546427866445, 'support': 132605}}
[[26301  8363 16192]
 [10456 12117 12380]
 [11291  8028 27477]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0452259
{'0': {'precision': 0.5460066808381415, 'recall': 0.4817792068595927, 'f1-score': 0.5118861209964413, 'support': 11196}, '1': {'precision': 0.4886401603742065, 'recall': 0.5084303841474014, 'f1-score': 0.4983388704318937, 'support': 11506}, '2': {'precision': 0.5030473135525261, 'recall': 0.5398915569326104, 'f1-score': 0.5208186309103741, 'support': 11619}, 'accuracy': 0.5103872264794149, 'macro avg': {'precision': 0.512564718254958, 'recall': 0.5100337159798681, 'f1-score': 0.5103478741129029, 'support': 34321}, 'weighted avg': {'precision': 0.5122313225167172, 'recall': 0.5103872264794149, 'f1-score': 0.5103684544859755, 'support': 34321}}
[[5394 2816 2986]
 [2445 5850 3211]
 [2040 3306 6273]]
Evaluating performance on  val set...
46/46 - 1s - 555ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0512155
{'0': {'precision': 0.5052774018944519, 'recall': 0.49339323467230445, 'f1-score': 0.4992646075678567, 'support': 3784}, '1': {'precision': 0.5081727250548914, 'recall': 0.5105392156862745, 'f1-score': 0.5093532216652402, 'support': 4080}, '2': {'precision': 0.5169753086419753, 'recall': 0.5264536406495547, 'f1-score': 0.5216714248637426, 'support': 3818}, 'accuracy': 0.5101866118815271, 'macro avg': {'precision': 0.5101418118637728, 'recall': 0.5101286970027111, 'f1-score': 0.5100964180322799, 'support': 11682}, 'weighted avg': {'precision': 0.5101118075147769, 'recall': 0.5101866118815271, 'f1-score': 0.5101112754289265, 'support': 11682}}
[[1867 1002  915]
 [1034 2083  963]
 [ 794 1014 2010]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
1840/1840 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5419059
{'0': {'precision': 0.3675063464167155, 'recall': 0.5604943786761969, 'f1-score': 0.4439333628188118, 'support': 40293}, '1': {'precision': 0.9179592140723312, 'recall': 0.8526127815696161, 'f1-score': 0.8840801286862131, 'support': 390312}, '2': {'precision': 0.41336227997360747, 'recall': 0.4812300220531754, 'f1-score': 0.44472177696359055, 'support': 40357}, 'accuracy': 0.7957966884801746, 'macro avg': {'precision': 0.5662759468208847, 'recall': 0.6314457274329961, 'f1-score': 0.5909117561562052, 'support': 470962}, 'weighted avg': {'precision': 0.8276262023519165, 'recall': 0.7957966884801746, 'f1-score': 0.8087746504574705, 'support': 470962}}
[[ 22584  13633   4076]
 [ 34041 332785  23486]
 [  4827  16109  19421]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.39930043
{'0': {'precision': 0.380500354861604, 'recall': 0.5547794593196222, 'f1-score': 0.4514024101457665, 'support': 7731}, '1': {'precision': 0.9504743110372524, 'recall': 0.9164837549344439, 'f1-score': 0.9331696104216147, 'support': 119821}, '2': {'precision': 0.4354557094633919, 'recall': 0.47674270421817255, 'f1-score': 0.45516486190534133, 'support': 7847}, 'accuracy': 0.8703461620839149, 'macro avg': {'precision': 0.5888101251207495, 'recall': 0.6493353061574129, 'f1-score': 0.6132456274909076, 'support': 135399}, 'weighted avg': {'precision': 0.8880822725307345, 'recall': 0.8703461620839149, 'f1-score': 0.8779591178261025, 'support': 135399}}
[[  4289   2511    931]
 [  6088 109814   3919]
 [   895   3211   3741]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47291717
{'0': {'precision': 0.3405336721728081, 'recall': 0.5537190082644629, 'f1-score': 0.4217151848937844, 'support': 3872}, '1': {'precision': 0.9325469269297383, 'recall': 0.8811730101510494, 'f1-score': 0.90613238120146, 'support': 45217}, '2': {'precision': 0.47881773399014776, 'recall': 0.4868519909842224, 'f1-score': 0.4828014404569725, 'support': 3993}, 'accuracy': 0.827625183678083, 'macro avg': {'precision': 0.5839661110308981, 'recall': 0.6405813364665782, 'f1-score': 0.603549668850739, 'support': 53082}, 'weighted avg': {'precision': 0.8552322818555771, 'recall': 0.827625183678083, 'f1-score': 0.8389528508428438, 'support': 53082}}
[[ 2144  1253   475]
 [ 3732 39844  1641]
 [  420  1629  1944]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2089094
{'0': {'precision': 0.4550745725718443, 'recall': 0.43301213697926555, 'f1-score': 0.4437693099897013, 'support': 89561}, '1': {'precision': 0.35937004347744955, 'recall': 0.2779196790625857, 'f1-score': 0.3134398802161318, 'support': 69297}, '2': {'precision': 0.43286670836245905, 'recall': 0.5307298479859263, 'f1-score': 0.4768287740628166, 'support': 88676}, 'accuracy': 0.42460025693440095, 'macro avg': {'precision': 0.4157704414705843, 'recall': 0.4138872213425924, 'f1-score': 0.41134598808954986, 'support': 247534}, 'weighted avg': {'precision': 0.42032645183172085, 'recall': 0.42460025693440095, 'f1-score': 0.41912680649979095, 'support': 247534}}
[[38781 16551 34229]
 [22606 19259 27432]
 [23832 17781 47063]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1933045
{'0': {'precision': 0.43668192835981684, 'recall': 0.43443545361984887, 'f1-score': 0.43555579433729114, 'support': 18661}, '1': {'precision': 0.43782529984159313, 'recall': 0.41952621022388464, 'f1-score': 0.4284804695069623, 'support': 18447}, '2': {'precision': 0.4422577422577423, 'recall': 0.46227745000783166, 'f1-score': 0.452046052127741, 'support': 19153}, 'accuracy': 0.4390252572830202, 'macro avg': {'precision': 0.4389216568197174, 'recall': 0.4387463712838551, 'f1-score': 0.4386941053239981, 'support': 56261}, 'weighted avg': {'precision': 0.43895500095559886, 'recall': 0.4390252572830202, 'f1-score': 0.43884971713132986, 'support': 56261}}
[[8107 4653 5901]
 [5443 7739 5265]
 [5015 5284 8854]]
Evaluating performance on  val set...
79/79 - 1s - 817ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1962197
{'0': {'precision': 0.46114066193853426, 'recall': 0.4406325003529578, 'f1-score': 0.45065338242726155, 'support': 7083}, '1': {'precision': 0.39178482068390325, 'recall': 0.30587660752075535, 'f1-score': 0.3435414571715879, 'support': 6143}, '2': {'precision': 0.4163414922549367, 'recall': 0.5181751287711552, 'f1-score': 0.4617099396800419, 'support': 6795}, 'accuracy': 0.42560311672743617, 'macro avg': {'precision': 0.4230889916257914, 'recall': 0.4215614122149562, 'f1-score': 0.4186349264262971, 'support': 20021}, 'weighted avg': {'precision': 0.4246558064953874, 'recall': 0.42560311672743617, 'f1-score': 0.42154098792584005, 'support': 20021}}
[[3121 1365 2597]
 [1925 1879 2339]
 [1722 1552 3521]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2712717
{'0': {'precision': 0.370232865127983, 'recall': 0.3842311808776311, 'f1-score': 0.3771021607218513, 'support': 140150}, '1': {'precision': 0.34872052182639235, 'recall': 0.02199471493900027, 'f1-score': 0.04137951565128083, 'support': 126394}, '2': {'precision': 0.35671913311713993, 'recall': 0.6454983290037714, 'f1-score': 0.4595042753765312, 'support': 139737}, 'accuracy': 0.3614001146989399, 'macro avg': {'precision': 0.3585575066905051, 'recall': 0.35057474160680097, 'f1-score': 0.29266198391655446, 'support': 406281}, 'weighted avg': {'precision': 0.3588924394392099, 'recall': 0.3614001146989399, 'f1-score': 0.3010003895202724, 'support': 406281}}
[[53850  2593 83707]
 [44661  2780 78953]
 [46938  2599 90200]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2695297
{'0': {'precision': 0.36719046796753585, 'recall': 0.40996375414513764, 'f1-score': 0.3874000255060212, 'support': 25934}, '1': {'precision': 0.369901547116737, 'recall': 0.021125346399453793, 'f1-score': 0.03996808631890886, 'support': 24899}, '2': {'precision': 0.34195650728203764, 'recall': 0.6256743054147231, 'f1-score': 0.44222113923687756, 'support': 24655}, 'accuracy': 0.3521619330224671, 'macro avg': {'precision': 0.35968284078877016, 'recall': 0.35225446865310484, 'f1-score': 0.2898630836872692, 'support': 75488}, 'weighted avg': {'precision': 0.359843073137033, 'recall': 0.3521619330224671, 'f1-score': 0.29070792484385444, 'support': 75488}}
[[10632   506 14796]
 [ 9484   526 14889]
 [ 8839   390 15426]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2757918
{'0': {'precision': 0.374313012598292, 'recall': 0.39007842100625606, 'f1-score': 0.38203313772868486, 'support': 11349}, '1': {'precision': 0.45104510451045104, 'recall': 0.035767251155892875, 'f1-score': 0.06627869382476562, 'support': 11463}, '2': {'precision': 0.317635076147056, 'recall': 0.6212293682413205, 'f1-score': 0.42034659820282416, 'support': 10542}, 'accuracy': 0.34136835162199436, 'macro avg': {'precision': 0.38099773108526636, 'recall': 0.34902501346782316, 'f1-score': 0.2895528099187582, 'support': 33354}, 'weighted avg': {'precision': 0.3827702040451994, 'recall': 0.34136835162199436, 'f1-score': 0.28562512998891604, 'support': 33354}}
[[4427  289 6633]
 [3617  410 7436]
 [3783  210 6549]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1251818
{'0': {'precision': 0.4911247988351598, 'recall': 0.4663598200763175, 'f1-score': 0.4784220410353315, 'support': 219871}, '1': {'precision': 0.28150845574620414, 'recall': 0.1799832289251714, 'f1-score': 0.21957839119471873, 'support': 101365}, '2': {'precision': 0.46844099575791426, 'recall': 0.5711393337014541, 'f1-score': 0.5147174693748912, 'support': 217320}, 'accuracy': 0.4547400827397708, 'macro avg': {'precision': 0.4136914167797594, 'recall': 0.40582746090098104, 'f1-score': 0.4042393005349805, 'support': 538556}, 'weighted avg': {'precision': 0.44251814567010544, 'recall': 0.4547400827397708, 'f1-score': 0.444349513611367, 'support': 538556}}
[[102539  23881  93451]
 [ 35728  18244  47393]
 [ 70517  22683 124120]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1538486
{'0': {'precision': 0.43353984418623204, 'recall': 0.4510622994356534, 'f1-score': 0.44212752687880474, 'support': 36148}, '1': {'precision': 0.45121689334287757, 'recall': 0.34807697617272704, 'f1-score': 0.39299240948269143, 'support': 36219}, '2': {'precision': 0.4363963225923903, 'recall': 0.516538275063298, 'f1-score': 0.47309732330085114, 'support': 37126}, 'accuracy': 0.4391970262939183, 'macro avg': {'precision': 0.44038435337383336, 'recall': 0.4385591835572262, 'f1-score': 0.4360724198874491, 'support': 109493}, 'weighted avg': {'precision': 0.440355756260169, 'recall': 0.4391970262939183, 'f1-score': 0.43637519426388927, 'support': 109493}}
[[16305  7357 12486]
 [11331 12607 12281]
 [ 9973  7976 19177]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1378559
{'0': {'precision': 0.4428506027773539, 'recall': 0.4800264659664213, 'f1-score': 0.4606897646545224, 'support': 12091}, '1': {'precision': 0.4346250348480625, 'recall': 0.274762072611914, 'f1-score': 0.33668070402764283, 'support': 11348}, '2': {'precision': 0.44003070427940894, 'recall': 0.5514670514670514, 'f1-score': 0.48948660476038, 'support': 12474}, 'accuracy': 0.43997995154957814, 'macro avg': {'precision': 0.43916878063494175, 'recall': 0.4354185300151289, 'f1-score': 0.4289523578141818, 'support': 35913}, 'weighted avg': {'precision': 0.43927197780241545, 'recall': 0.43997995154957814, 'f1-score': 0.431506932907986, 'support': 35913}}
[[5804 1941 4346]
 [3822 3118 4408]
 [3480 2115 6879]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/EXC
Evaluating performance on  test set...
5267/5267 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5387487
{'0': {'precision': 0.47781196035466034, 'recall': 0.43500059450675754, 'f1-score': 0.4554023401842272, 'support': 151386}, '1': {'precision': 0.870489042327911, 'recall': 0.8711802347302551, 'f1-score': 0.8708345013770579, 'support': 1046563}, '2': {'precision': 0.4168302979726081, 'recall': 0.45215828535294705, 'f1-score': 0.4337761771119689, 'support': 150235}, 'accuracy': 0.7755083875791435, 'macro avg': {'precision': 0.5883771002183932, 'recall': 0.5861130381966533, 'f1-score': 0.5866710062244179, 'support': 1348184}, 'weighted avg': {'precision': 0.7758422921885967, 'recall': 0.7755083875791435, 'f1-score': 0.7754824793234633, 'support': 1348184}}
[[ 65853  65861  19672]
 [ 59452 911745  75366]
 [ 12517  69788  67930]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45649108
{'0': {'precision': 0.3881184090061375, 'recall': 0.5213865986425545, 'f1-score': 0.44498872560454084, 'support': 21953}, '1': {'precision': 0.9214459264214668, 'recall': 0.8738853054175038, 'f1-score': 0.8970356450733908, 'support': 226968}, '2': {'precision': 0.42337280337883704, 'recall': 0.5025289825880668, 'f1-score': 0.45956732638817815, 'support': 22341}, 'accuracy': 0.8147731713251395, 'macro avg': {'precision': 0.5776457129354805, 'recall': 0.632600295549375, 'f1-score': 0.6005305656887033, 'support': 271262}, 'weighted avg': {'precision': 0.837263141395499, 'recall': 0.8147731713251395, 'f1-score': 0.8244222096093523, 'support': 271262}}
[[ 11446   7940   2567]
 [ 15900 198344  12724]
 [  2145   8969  11227]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46069187
{'0': {'precision': 0.3890231891843495, 'recall': 0.5422438537376763, 'f1-score': 0.4530288812428318, 'support': 8013}, '1': {'precision': 0.9260998789124133, 'recall': 0.8666544576327446, 'f1-score': 0.8953916015278549, 'support': 87367}, '2': {'precision': 0.37488070242412674, 'recall': 0.4894094193869923, 'f1-score': 0.4245568525724168, 'support': 8026}, 'accuracy': 0.8122352668123707, 'macro avg': {'precision': 0.5633345901736299, 'recall': 0.6327692435858043, 'f1-score': 0.5909924451143679, 'support': 103406}, 'weighted avg': {'precision': 0.8416978072213511, 'recall': 0.8122352668123707, 'f1-score': 0.8245681273313844, 'support': 103406}}
[[ 4345  2749   919]
 [ 6019 75717  5631]
 [  805  3293  3928]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/AAL
Evaluating performance on  test set...
10110/10110 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5307079
{'0': {'precision': 0.49746105548335134, 'recall': 0.4675937396762471, 'f1-score': 0.4820652183553678, 'support': 290592}, '1': {'precision': 0.8738396602026964, 'recall': 0.902371107249156, 'f1-score': 0.8878762320155881, 'support': 2002440}, '2': {'precision': 0.5165661797434549, 'recall': 0.43264851015372935, 'f1-score': 0.47089787050391557, 'support': 295064}, 'accuracy': 0.8000020091990405, 'macro avg': {'precision': 0.6292889651431676, 'recall': 0.6008711190263775, 'f1-score': 0.6136131069582905, 'support': 2588096}, 'weighted avg': {'precision': 0.79084770250838, 'recall': 0.8000020091990405, 'f1-score': 0.7947727546551536, 'support': 2588096}}
[[ 135879  120551   34162]
 [ 110187 1806944   85309]
 [  27079  140326  127659]]
Evaluating performance on  train set...
1686/1686 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49475083
{'0': {'precision': 0.48006978603794614, 'recall': 0.4648630892325019, 'f1-score': 0.4723440778180431, 'support': 42619}, '1': {'precision': 0.892130900402486, 'recall': 0.9057572572167866, 'f1-score': 0.8988924411148097, 'support': 346276}, '2': {'precision': 0.49320974904471754, 'recall': 0.44768109488880037, 'f1-score': 0.46934388167512253, 'support': 42671}, 'accuracy': 0.8169248735998665, 'macro avg': {'precision': 0.6218034784950499, 'recall': 0.6061004804460296, 'f1-score': 0.6135268002026585, 'support': 431566}, 'weighted avg': {'precision': 0.8119948445438464, 'recall': 0.8169248735998665, 'f1-score': 0.8142974283584855, 'support': 431566}}
[[ 19812  18040   4767]
 [ 17772 313642  14862]
 [  3685  19883  19103]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5758574
{'0': {'precision': 0.4719386555017171, 'recall': 0.4726501766784452, 'f1-score': 0.47229414810978765, 'support': 21225}, '1': {'precision': 0.8767899257212969, 'recall': 0.8696973451198449, 'f1-score': 0.8732292337411462, 'support': 137219}, '2': {'precision': 0.457089552238806, 'recall': 0.4795175238962221, 'f1-score': 0.4680350082189346, 'support': 21970}, 'accuracy': 0.7754719700244992, 'macro avg': {'precision': 0.6019393778206067, 'recall': 0.6072883485648374, 'f1-score': 0.6045194633566229, 'support': 180414}, 'weighted avg': {'precision': 0.7780515494543725, 'recall': 0.7754719700244992, 'f1-score': 0.7767180742565798, 'support': 180414}}
[[ 10032   7971   3222]
 [  8589 119339   9291]
 [  2636   8799  10535]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/WBA
Evaluating performance on  test set...
6546/6546 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7834774
{'0': {'precision': 0.4496292692993706, 'recall': 0.4937660866046135, 'f1-score': 0.4706652059191137, 'support': 308875}, '1': {'precision': 0.7715682556581619, 'recall': 0.7266529145632513, 'f1-score': 0.748437324077633, 'support': 1061171}, '2': {'precision': 0.428798951277093, 'recall': 0.4729162169057759, 'f1-score': 0.4497783446623839, 'support': 305718}, 'accuracy': 0.6374370138038531, 'macro avg': {'precision': 0.5499988254115418, 'recall': 0.5644450726912136, 'f1-score': 0.5562936248863769, 'support': 1675764}, 'weighted avg': {'precision': 0.6496956944810849, 'recall': 0.6374370138038531, 'f1-score': 0.6427528190607668, 'support': 1675764}}
[[152512 111090  45273]
 [142748 771103 147320]
 [ 43935 117204 144579]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77208024
{'0': {'precision': 0.5024620318837846, 'recall': 0.4266673074766505, 'f1-score': 0.4614731516296155, 'support': 62421}, '1': {'precision': 0.7510598151141897, 'recall': 0.7867347527249278, 'f1-score': 0.7684834766399173, 'support': 190739}, '2': {'precision': 0.46528629526822024, 'recall': 0.4679749383196987, 'f1-score': 0.4666267439225715, 'support': 61608}, 'accuracy': 0.6529412138463885, 'macro avg': {'precision': 0.5729360474220648, 'recall': 0.5604589995070923, 'f1-score': 0.5655277907307015, 'support': 314768}, 'weighted avg': {'precision': 0.6458278435106735, 'recall': 0.6529412138463885, 'f1-score': 0.648519944493326, 'support': 314768}}
[[ 26633  24286  11502]
 [ 19047 150061  21631]
 [  7325  25452  28831]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6989677
{'0': {'precision': 0.5010504201680672, 'recall': 0.4395863198853164, 'f1-score': 0.46831024326388127, 'support': 19532}, '1': {'precision': 0.7906976744186046, 'recall': 0.8298649044738735, 'f1-score': 0.8098079748300117, 'support': 75058}, '2': {'precision': 0.47825342465753423, 'recall': 0.4446980150727099, 'f1-score': 0.4608657389582531, 'support': 18842}, 'accuracy': 0.6986829113477678, 'macro avg': {'precision': 0.5900005064147354, 'recall': 0.5713830798106333, 'f1-score': 0.5796613190173819, 'support': 113432}, 'weighted avg': {'precision': 0.6889233539092282, 'recall': 0.6986829113477678, 'f1-score': 0.6930428353522159, 'support': 113432}}
[[ 8586  7998  2948]
 [ 6577 62288  6193]
 [ 1973  8490  8379]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
7633/7633 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86870575
{'0': {'precision': 0.5106183808900038, 'recall': 0.38842200256630804, 'f1-score': 0.441215806769372, 'support': 425514}, '1': {'precision': 0.7011312316110092, 'recall': 0.7846965608355337, 'f1-score': 0.7405639724017143, 'support': 1103582}, '2': {'precision': 0.4765337753204196, 'recall': 0.44322137415359847, 'f1-score': 0.4592743076217698, 'support': 424887}, 'accuracy': 0.6241482141861009, 'macro avg': {'precision': 0.5627611292738108, 'recall': 0.5387799791851468, 'f1-score': 0.5470180289309521, 'support': 1953983}, 'weighted avg': {'precision': 0.6108057658456275, 'recall': 0.6241482141861009, 'f1-score': 0.6142101826552135, 'support': 1953983}}
[[165279 183027  77208]
 [107947 865977 129658]
 [ 50458 186110 188319]]
Evaluating performance on  train set...
1586/1586 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8426728
{'0': {'precision': 0.4962512634072018, 'recall': 0.3943797055579533, 'f1-score': 0.43948938216845584, 'support': 83412}, '1': {'precision': 0.7160234240652014, 'recall': 0.7835152216187219, 'f1-score': 0.7482504747782202, 'support': 238608}, '2': {'precision': 0.4627113026184952, 'recall': 0.43307481207493137, 'f1-score': 0.4474028055124128, 'support': 83810}, 'accuracy': 0.6311632949757288, 'macro avg': {'precision': 0.5583286633636328, 'recall': 0.5369899130838688, 'f1-score': 0.5450475541530296, 'support': 405830}, 'weighted avg': {'precision': 0.6185399350100464, 'recall': 0.6311632949757288, 'f1-score': 0.6226598988771458, 'support': 405830}}
[[ 32896  35730  14786]
 [ 24295 186953  27360]
 [  9098  38416  36296]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80711067
{'0': {'precision': 0.4837702584821634, 'recall': 0.38376370324507414, 'f1-score': 0.4280027620943174, 'support': 27457}, '1': {'precision': 0.748378293271754, 'recall': 0.7795112884709998, 'f1-score': 0.7636276006104907, 'support': 91465}, '2': {'precision': 0.4369970493562232, 'recall': 0.46624691446356387, 'f1-score': 0.4511483808435882, 'support': 27953}, 'accuracy': 0.6459097872340426, 'macro avg': {'precision': 0.5563818670367134, 'recall': 0.543173968726546, 'f1-score': 0.5475929145161321, 'support': 146875}, 'weighted avg': {'precision': 0.6396505811193207, 'recall': 0.6459097872340426, 'f1-score': 0.6414149516145228, 'support': 146875}}
[[10537 11801  5119]
 [ 8495 71298 11672]
 [ 2749 12171 13033]]
testing model on single stock: results/universal/W10/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
22048/22048 - 171s - 171s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1023695
{'0': {'precision': 0.4573550255064427, 'recall': 0.48112082180308346, 'f1-score': 0.46893700324469995, 'support': 2146889}, '1': {'precision': 0.3261060930802204, 'recall': 0.03875141651917181, 'f1-score': 0.06927127829308893, 'support': 1319255}, '2': {'precision': 0.44482239165324083, 'recall': 0.6594657560726547, 'f1-score': 0.5312836788726716, 'support': 2177919}, 'accuracy': 0.4465398419542801, 'macro avg': {'precision': 0.40942783674663463, 'recall': 0.39311266479830326, 'f1-score': 0.3564973201368202, 'support': 5644063}, 'weighted avg': {'precision': 0.4218405615933206, 'recall': 0.4465398419542801, 'f1-score': 0.39957650947734813, 'support': 5644063}}
[[1032913   51754 1062222]
 [ 537771   51123  730361]
 [ 687765   53891 1436263]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1329519
{'0': {'precision': 0.4253497804298032, 'recall': 0.5053046174111041, 'f1-score': 0.4618926393398309, 'support': 461579}, '1': {'precision': 0.43356277659025094, 'recall': 0.14415185867788713, 'f1-score': 0.21636592284016568, 'support': 460112}, '2': {'precision': 0.4139747150210902, 'recall': 0.6088604241792422, 'f1-score': 0.49285131284066075, 'support': 468104}, 'accuracy': 0.4206188682503535, 'macro avg': {'precision': 0.4242957573470481, 'recall': 0.41943896675607784, 'f1-score': 0.3903699583402191, 'support': 1389795}, 'weighted avg': {'precision': 0.4242375188885656, 'recall': 0.4206188682503535, 'f1-score': 0.39103477204166, 'support': 1389795}}
[[233238  41436 186905]
 [177229  66326 216557]
 [137877  45217 285010]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1469374
{'0': {'precision': 0.412696872152397, 'recall': 0.5002222047943952, 'f1-score': 0.45226383041583573, 'support': 153012}, '1': {'precision': 0.4559964797183775, 'recall': 0.1302527009809803, 'f1-score': 0.20262637484723922, 'support': 175029}, '2': {'precision': 0.3998622123380391, 'recall': 0.6377404803824553, 'f1-score': 0.4915336499650847, 'support': 155626}, 'accuracy': 0.41058620910667876, 'macro avg': {'precision': 0.4228518547362712, 'recall': 0.42273846205261023, 'f1-score': 0.3821412850760532, 'support': 483667}, 'weighted avg': {'precision': 0.42423638227898564, 'recall': 0.41058620910667876, 'f1-score': 0.3745608048351274, 'support': 483667}}
[[76540 13977 62495]
 [65767 22798 86464]
 [43156 13221 99249]]
training model: results/universal/W10/deepOF_L2/h20
Epoch 1/50
8543/8543 - 192s - loss: 2.9023 - accuracy20: 0.5037 - val_loss: 3.0522 - val_accuracy20: 0.4869 - 192s/epoch - 22ms/step
Epoch 2/50
8543/8543 - 190s - loss: 2.8299 - accuracy20: 0.5180 - val_loss: 3.0102 - val_accuracy20: 0.4860 - 190s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 189s - loss: 2.8057 - accuracy20: 0.5225 - val_loss: 3.0331 - val_accuracy20: 0.4846 - 189s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 189s - loss: 2.7915 - accuracy20: 0.5257 - val_loss: 3.0447 - val_accuracy20: 0.4872 - 189s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 190s - loss: 2.7835 - accuracy20: 0.5275 - val_loss: 3.0463 - val_accuracy20: 0.4876 - 190s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 190s - loss: 2.7768 - accuracy20: 0.5291 - val_loss: 3.0426 - val_accuracy20: 0.4882 - 190s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 189s - loss: 2.7715 - accuracy20: 0.5303 - val_loss: 3.0565 - val_accuracy20: 0.4879 - 189s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 190s - loss: 2.7672 - accuracy20: 0.5311 - val_loss: 3.0570 - val_accuracy20: 0.4885 - 190s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 189s - loss: 2.7630 - accuracy20: 0.5319 - val_loss: 3.0503 - val_accuracy20: 0.4890 - 189s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 189s - loss: 2.7596 - accuracy20: 0.5328 - val_loss: 3.0537 - val_accuracy20: 0.4886 - 189s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 188s - loss: 2.7564 - accuracy20: 0.5334 - val_loss: 3.0500 - val_accuracy20: 0.4905 - 188s/epoch - 22ms/step
Epoch 12/50
8543/8543 - 188s - loss: 2.7535 - accuracy20: 0.5342 - val_loss: 3.0550 - val_accuracy20: 0.4900 - 188s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 288s - 288s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0104183
{'0': {'precision': 0.40290129349484277, 'recall': 0.4700297314761756, 'f1-score': 0.43388442242403313, 'support': 2870695}, '1': {'precision': 0.7049658687498633, 'recall': 0.4975412290261926, 'f1-score': 0.5833638494242718, 'support': 3757365}, '2': {'precision': 0.3997127334252519, 'recall': 0.48565813586617823, 'f1-score': 0.4385139555193212, 'support': 2917194}, 'accuracy': 0.48563558392474415, 'macro avg': {'precision': 0.502526631889986, 'recall': 0.48440969878951545, 'f1-score': 0.4852540757892087, 'support': 9545254}, 'weighted avg': {'precision': 0.5208306031286598, 'recall': 0.48563558392474415, 'f1-score': 0.4941399183384559, 'support': 9545254}}
[[1349312  377073 1144310]
 [ 904547 1869444  983374]
 [1095130  405305 1416759]]
Evaluating performance on  train set...
8543/8543 - 70s - 70s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0231749
{'0': {'precision': 0.38322901413438487, 'recall': 0.44981748664345317, 'f1-score': 0.41386191955867674, 'support': 606257}, '1': {'precision': 0.705589049975542, 'recall': 0.4878103685261547, 'f1-score': 0.5768289294605503, 'support': 963975}, '2': {'precision': 0.3774330133008849, 'recall': 0.4950979756034259, 'f1-score': 0.42833165397558703, 'support': 616480}, 'accuracy': 0.47933152605372814, 'macro avg': {'precision': 0.48875035913693726, 'recall': 0.4775752769243446, 'f1-score': 0.4730075009982713, 'support': 2186712}, 'weighted avg': {'precision': 0.5237019694006217, 'recall': 0.47933152605372814, 'f1-score': 0.48978249128622725, 'support': 2186712}}
[[272705  92043 241509]
 [231797 470237 261941]
 [207096 104166 305218]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0106382
{'0': {'precision': 0.375324261410169, 'recall': 0.45160288149744665, 'f1-score': 0.4099454695676122, 'support': 206004}, '1': {'precision': 0.7314827814436712, 'recall': 0.4911257743064907, 'f1-score': 0.5876779542213522, 'support': 371300}, '2': {'precision': 0.3682788370287292, 'recall': 0.509060900508975, 'f1-score': 0.42737459252080445, 'support': 209637}, 'accuracy': 0.48555736707072067, 'macro avg': {'precision': 0.4916952932941898, 'recall': 0.4839298521043041, 'f1-score': 0.4749993387699229, 'support': 786941}, 'weighted avg': {'precision': 0.5414925978640931, 'recall': 0.48555736707072067, 'f1-score': 0.4984474800111804, 'support': 786941}}
[[ 93032  32072  80900]
 [ 86788 182355 102157]
 [ 68051  34868 106718]]
testing model out of sample: results/universal/W10/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.857622
{'0': {'precision': 0.5082808769019911, 'recall': 0.35547357022337506, 'f1-score': 0.41836060836487815, 'support': 1270688}, '1': {'precision': 0.7037018720280859, 'recall': 0.8174712686129495, 'f1-score': 0.7563321316726497, 'support': 2924241}, '2': {'precision': 0.4717344813882183, 'recall': 0.4379130146265933, 'f1-score': 0.45419499257251533, 'support': 1265845}, 'accuracy': 0.6219830741942443, 'macro avg': {'precision': 0.5612390767727651, 'recall': 0.5369526178209726, 'f1-score': 0.542962577536681, 'support': 5460774}, 'weighted avg': {'precision': 0.6044569893320962, 'recall': 0.6219830741942443, 'f1-score': 0.6076508008112891, 'support': 5460774}}
[[ 451696  505041  313951]
 [ 226950 2390483  306808]
 [ 210028  501487  554330]]
Evaluating performance on  train set...
4055/4055 - 35s - 35s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8569977
{'0': {'precision': 0.48556778419478647, 'recall': 0.3514793781002962, 'f1-score': 0.4077836243930959, 'support': 228204}, '1': {'precision': 0.7088172585552851, 'recall': 0.7965529461592318, 'f1-score': 0.7501284053882238, 'support': 578465}, '2': {'precision': 0.45528060156872274, 'recall': 0.43834975433488443, 'f1-score': 0.44665479083751086, 'support': 230802}, 'accuracy': 0.6189657349458443, 'macro avg': {'precision': 0.5498885481062648, 'recall': 0.5287940261981375, 'f1-score': 0.5348556068729435, 'support': 1037471}, 'weighted avg': {'precision': 0.6033076196807761, 'recall': 0.6189657349458443, 'f1-score': 0.6073130731160487, 'support': 1037471}}
[[ 80209  94395  53600]
 [ 50240 460778  67447]
 [ 34737  94893 101172]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8545657
{'0': {'precision': 0.47501174046749783, 'recall': 0.3670373405127005, 'f1-score': 0.4141018614509941, 'support': 85430}, '1': {'precision': 0.7225008611202124, 'recall': 0.7755748046408232, 'f1-score': 0.7480976789399628, 'support': 221771}, '2': {'precision': 0.44802492513651576, 'recall': 0.46400392228404636, 'f1-score': 0.45587444548998524, 'support': 87704}, 'accuracy': 0.617999265646168, 'macro avg': {'precision': 0.5485125089080753, 'recall': 0.5355386891458567, 'f1-score': 0.5393579952936474, 'support': 394905}, 'weighted avg': {'precision': 0.6080033666167862, 'recall': 0.617999265646168, 'f1-score': 0.6109446695970083, 'support': 394905}}
[[ 31356  33103  20971]
 [ 20605 172000  29166]
 [ 14050  32959  40695]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1070557
{'0': {'precision': 0.5103184217357446, 'recall': 0.4411181750186986, 'f1-score': 0.47320174910739365, 'support': 53480}, '1': {'precision': 0.32301593074852697, 'recall': 0.2976904769885697, 'f1-score': 0.3098365517121077, 'support': 29833}, '2': {'precision': 0.46062530781380023, 'recall': 0.5502515621196137, 'f1-score': 0.5014652183961174, 'support': 49292}, 'accuracy': 0.4494174427811923, 'macro avg': {'precision': 0.43131988676602395, 'recall': 0.429686738042294, 'f1-score': 0.4281678397385396, 'support': 132605}, 'weighted avg': {'precision': 0.44970782496290684, 'recall': 0.4494174427811923, 'f1-score': 0.4469545411912985, 'support': 132605}}
[[23591  9758 20131]
 [ 9323  8881 11629]
 [13314  8855 27123]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0952255
{'0': {'precision': 0.4706443408223824, 'recall': 0.386914096532497, 'f1-score': 0.42469159414746105, 'support': 11478}, '1': {'precision': 0.4498693811368345, 'recall': 0.4362334032145353, 'f1-score': 0.4429464721273671, 'support': 11448}, '2': {'precision': 0.4267991874637261, 'recall': 0.5162790697674419, 'f1-score': 0.46729417371619203, 'support': 11395}, 'accuracy': 0.4463156667929256, 'macro avg': {'precision': 0.449104303140981, 'recall': 0.4464755231714914, 'f1-score': 0.4449774133303401, 'support': 34321}, 'weighted avg': {'precision': 0.44915757583878513, 'recall': 0.4463156667929256, 'f1-score': 0.44492521896316145, 'support': 34321}}
[[4441 3002 4035]
 [2588 4994 3866]
 [2407 3105 5883]]
Evaluating performance on  val set...
46/46 - 1s - 551ms/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.108553
{'0': {'precision': 0.4549723756906077, 'recall': 0.41092814371257486, 'f1-score': 0.4318300996329313, 'support': 4008}, '1': {'precision': 0.43038941206413844, 'recall': 0.44961446423823453, 'f1-score': 0.4397919375812744, 'support': 3761}, '2': {'precision': 0.45124606823130897, 'recall': 0.476616406848965, 'f1-score': 0.4635843897588864, 'support': 3913}, 'accuracy': 0.4453860640301318, 'macro avg': {'precision': 0.44553595199535173, 'recall': 0.4457196715999248, 'f1-score': 0.44506880899103063, 'support': 11682}, 'weighted avg': {'precision': 0.44580976934859545, 'recall': 0.4453860640301318, 'f1-score': 0.4450298094246263, 'support': 11682}}
[[1647 1120 1241]
 [1043 1691 1027]
 [ 930 1118 1865]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
1840/1840 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6469238
{'0': {'precision': 0.49574012375059495, 'recall': 0.37438892882818114, 'f1-score': 0.42660249846405895, 'support': 55640}, '1': {'precision': 0.8598519977046318, 'recall': 0.8786314952839889, 'f1-score': 0.869140316273444, 'support': 359838}, '2': {'precision': 0.43198628459466076, 'recall': 0.4768401701391392, 'f1-score': 0.4533063763075157, 'support': 55484}, 'accuracy': 0.7717246826707888, 'macro avg': {'precision': 0.5958594686832959, 'recall': 0.5766201980837697, 'f1-score': 0.5830163970150063, 'support': 470962}, 'weighted avg': {'precision': 0.766428566742057, 'recall': 0.7717246826707888, 'f1-score': 0.7678690151748759, 'support': 470962}}
[[ 20831  27320   7489]
 [ 16374 316165  27299]
 [  4815  24212  26457]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.545347
{'0': {'precision': 0.5216477511559479, 'recall': 0.34905306581661355, 'f1-score': 0.4182441161601977, 'support': 10666}, '1': {'precision': 0.9087364831285453, 'recall': 0.9315981799335922, 'f1-score': 0.9200253309506046, 'support': 113842}, '2': {'precision': 0.4365697473174109, 'recall': 0.4632265173078689, 'f1-score': 0.4495032743796499, 'support': 10891}, 'accuracy': 0.8480343281708137, 'macro avg': {'precision': 0.6223179938673014, 'recall': 0.5812925876860249, 'f1-score': 0.5959242404968174, 'support': 135399}, 'weighted avg': {'precision': 0.8402643649080357, 'recall': 0.8480343281708137, 'f1-score': 0.8426506520012125, 'support': 135399}}
[[  3723   5568   1375]
 [  2651 106055   5136]
 [   763   5083   5045]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59132755
{'0': {'precision': 0.48575305291723203, 'recall': 0.3348297792742237, 'f1-score': 0.39641235743549996, 'support': 5346}, '1': {'precision': 0.8782398080449102, 'recall': 0.920408986311769, 'f1-score': 0.8988300706590988, 'support': 42153}, '2': {'precision': 0.49118773946360156, 'recall': 0.45925129858499014, 'f1-score': 0.4746829584374711, 'support': 5583}, 'accuracy': 0.8129309370408048, 'macro avg': {'precision': 0.6183935334752478, 'recall': 0.5714966880569943, 'f1-score': 0.5899751288440234, 'support': 53082}, 'weighted avg': {'precision': 0.7980027052265911, 'recall': 0.8129309370408048, 'f1-score': 0.8036200480068494, 'support': 53082}}
[[ 1790  2804   752]
 [ 1451 38798  1904]
 [  444  2575  2564]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
967/967 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2479953
{'0': {'precision': 0.3939534643759996, 'recall': 0.3491341372806767, 'f1-score': 0.3701921620196707, 'support': 87485}, '1': {'precision': 0.3341667119589833, 'recall': 0.24568437316852257, 'f1-score': 0.2831745641844435, 'support': 75076}, '2': {'precision': 0.3637994860851008, 'recall': 0.4915208360302684, 'f1-score': 0.41812411777072545, 'support': 84973}, 'accuracy': 0.3666365024602681, 'macro avg': {'precision': 0.3639732208066946, 'recall': 0.3621131154931559, 'f1-score': 0.3571636146582799, 'support': 247534}, 'weighted avg': {'precision': 0.3654691986922048, 'recall': 0.3666365024602681, 'f1-score': 0.36025408846596435, 'support': 247534}}
[[30544 17222 39719]
 [23311 18445 33320]
 [23677 19530 41766]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2201014
{'0': {'precision': 0.3964920513873409, 'recall': 0.36454344425866997, 'f1-score': 0.37984713948521975, 'support': 18541}, '1': {'precision': 0.39098695177329423, 'recall': 0.36507084585659083, 'f1-score': 0.37758472341724725, 'support': 18632}, '2': {'precision': 0.3823623779621396, 'recall': 0.4370284995808885, 'f1-score': 0.4078718983009413, 'support': 19088}, 'accuracy': 0.3893105348287446, 'macro avg': {'precision': 0.38994712704092493, 'recall': 0.3888809298987164, 'f1-score': 0.38843458706780276, 'support': 56261}, 'weighted avg': {'precision': 0.3898750658671909, 'recall': 0.3893105348287446, 'f1-score': 0.3886060179284758, 'support': 56261}}
[[6759 4926 6856]
 [5211 6802 6619]
 [5077 5669 8342]]
Evaluating performance on  val set...
79/79 - 1s - 792ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2122675
{'0': {'precision': 0.4247644287396938, 'recall': 0.4152274035693725, 'f1-score': 0.4199417758369724, 'support': 6948}, '1': {'precision': 0.35760892443696063, 'recall': 0.2709728867623604, 'f1-score': 0.3083204790853824, 'support': 6270}, '2': {'precision': 0.38145789101203115, 'recall': 0.47537850948111127, 'f1-score': 0.42327072835547414, 'support': 6803}, 'accuracy': 0.390489985515209, 'macro avg': {'precision': 0.38794374806289517, 'recall': 0.38719293327094806, 'f1-score': 0.3838443277592763, 'support': 20021}, 'weighted avg': {'precision': 0.3890179930901545, 'recall': 0.390489985515209, 'f1-score': 0.3861163591919946, 'support': 20021}}
[[2885 1410 2653]
 [1980 1699 2591]
 [1927 1642 3234]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1588/1588 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2312818
{'0': {'precision': 0.3448390540098375, 'recall': 0.45704210833137826, 'f1-score': 0.3930905866886789, 'support': 140661}, '1': {'precision': 0.31001715718622147, 'recall': 0.07481904397888249, 'f1-score': 0.12054576595185097, 'support': 125583}, '2': {'precision': 0.33914552821508465, 'recall': 0.45904296721580723, 'f1-score': 0.3900892345129119, 'support': 140037}, 'accuracy': 0.33958516396287297, 'macro avg': {'precision': 0.33133391313704785, 'recall': 0.33030137317535596, 'f1-score': 0.3012418623844806, 'support': 406281}, 'weighted avg': {'precision': 0.33211302808069, 'recall': 0.33958516396287297, 'f1-score': 0.3078114410303022, 'support': 406281}}
[[64288  8563 67810]
 [58736  9396 57451]
 [63405 12349 64283]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2173535
{'0': {'precision': 0.3491068630523347, 'recall': 0.47000613685179504, 'f1-score': 0.40063426675167146, 'support': 26072}, '1': {'precision': 0.35409689662871174, 'recall': 0.06363599887653974, 'f1-score': 0.1078838174273859, 'support': 24923}, '2': {'precision': 0.31745015038431545, 'recall': 0.4653982770587515, 'f1-score': 0.37744408205162167, 'support': 24493}, 'accuracy': 0.33434453158117844, 'macro avg': {'precision': 0.34021797002178733, 'recall': 0.3330134709290287, 'f1-score': 0.29532072207689297, 'support': 75488}, 'weighted avg': {'precision': 0.34048295916623683, 'recall': 0.33434453158117844, 'f1-score': 0.2964558987677868, 'support': 75488}}
[[12254  1212 12606]
 [11434  1586 11903]
 [11413  1681 11399]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2455049
{'0': {'precision': 0.35984660180384914, 'recall': 0.44486391571553996, 'f1-score': 0.39786423776059043, 'support': 11390}, '1': {'precision': 0.3182543906333156, 'recall': 0.05273833671399594, 'f1-score': 0.09048267513996065, 'support': 11339}, '2': {'precision': 0.2898125790502472, 'recall': 0.4744470588235294, 'f1-score': 0.35982726007352156, 'support': 10625}, 'accuracy': 0.32098099178509326, 'macro avg': {'precision': 0.3226378571624707, 'recall': 0.32401643708435507, 'f1-score': 0.28272472432469087, 'support': 33354}, 'weighted avg': {'precision': 0.3233974330618781, 'recall': 0.32098099178509326, 'f1-score': 0.2812502656288992, 'support': 33354}}
[[5067  526 5797]
 [4185  598 6556]
 [4829  755 5041]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2054642
{'0': {'precision': 0.4207148351264147, 'recall': 0.3966407051976305, 'f1-score': 0.4083232342818362, 'support': 212366}, '1': {'precision': 0.2599145891043398, 'recall': 0.1925046375845237, 'f1-score': 0.22118761019354777, 'support': 116979}, '2': {'precision': 0.40015176677181746, 'recall': 0.4814230609289187, 'f1-score': 0.4370412637525954, 'support': 209211}, 'accuracy': 0.3852357043650057, 'macro avg': {'precision': 0.3602603970008573, 'recall': 0.35685613457035764, 'f1-score': 0.3555173694093265, 'support': 538556}, 'weighted avg': {'precision': 0.3777995726969739, 'recall': 0.3852357043650057, 'f1-score': 0.37883175984534884, 'support': 538556}}
[[ 84233  30214  97919]
 [ 41396  22519  53064]
 [ 74585  33907 100719]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.213017
{'0': {'precision': 0.38202662721893493, 'recall': 0.36892857142857144, 'f1-score': 0.3753633720930233, 'support': 36400}, '1': {'precision': 0.39702901083537223, 'recall': 0.3148717948717949, 'f1-score': 0.35120970858777145, 'support': 36075}, '2': {'precision': 0.37665915899499247, 'recall': 0.46531417148414284, 'f1-score': 0.4163192304438725, 'support': 37018}, 'accuracy': 0.3837048943768095, 'macro avg': {'precision': 0.3852382656830999, 'recall': 0.383038179261503, 'f1-score': 0.38096410370822237, 'support': 109493}, 'weighted avg': {'precision': 0.38515484592012195, 'recall': 0.3837048943768095, 'f1-score': 0.38125197276594097, 'support': 109493}}
[[13429  8241 14730]
 [10940 11359 13776]
 [10783  9010 17225]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1938446
{'0': {'precision': 0.38736791546589816, 'recall': 0.4068095838587642, 'f1-score': 0.39685078115389344, 'support': 11895}, '1': {'precision': 0.39785088882992836, 'recall': 0.2571159122085048, 'f1-score': 0.31236329549005315, 'support': 11664}, '2': {'precision': 0.378580872631115, 'recall': 0.4867249473854622, 'f1-score': 0.4258951021709105, 'support': 12354}, 'accuracy': 0.3856820649903934, 'macro avg': {'precision': 0.38793322564231386, 'recall': 0.38355014781757707, 'f1-score': 0.378369726271619, 'support': 35913}, 'weighted avg': {'precision': 0.38774990176994234, 'recall': 0.3856820649903934, 'f1-score': 0.3794017100392885, 'support': 35913}}
[[4839 2101 4955]
 [3750 2999 4915]
 [3903 2438 6013]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/EXC
Evaluating performance on  test set...
5267/5267 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6545191
{'0': {'precision': 0.5729127857747671, 'recall': 0.33393710269672683, 'f1-score': 0.4219371655919879, 'support': 202616}, '1': {'precision': 0.7969353272628578, 'recall': 0.8842155936502282, 'f1-score': 0.8383097968549333, 'support': 943089}, '2': {'precision': 0.4690378208896727, 'recall': 0.42555524276591644, 'f1-score': 0.44623977503126716, 'support': 202479}, 'accuracy': 0.7326307091613607, 'macro avg': {'precision': 0.6129619779757659, 'recall': 0.5479026463709572, 'f1-score': 0.5688289124927295, 'support': 1348184}, 'weighted avg': {'precision': 0.714021637099581, 'recall': 0.7326307091613607, 'f1-score': 0.7168503350865048, 'support': 1348184}}
[[ 67661 108983  25972]
 [ 37625 833894  71570]
 [ 12814 103499  86166]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.570049
{'0': {'precision': 0.5066524520255864, 'recall': 0.3877990664882332, 'f1-score': 0.4393292288350251, 'support': 30637}, '1': {'precision': 0.8622577927548442, 'recall': 0.8990971980196601, 'f1-score': 0.8802922403457148, 'support': 209459}, '2': {'precision': 0.4883009114406203, 'recall': 0.4606943464031316, 'f1-score': 0.47409608717186724, 'support': 31166}, 'accuracy': 0.7909806755092862, 'macro avg': {'precision': 0.619070385407017, 'recall': 0.5825302036370084, 'f1-score': 0.5979058521175357, 'support': 271262}, 'weighted avg': {'precision': 0.7791299643566115, 'recall': 0.7909806755092862, 'f1-score': 0.7838198516828386, 'support': 271262}}
[[ 11881  15400   3356]
 [  9445 188324  11690]
 [  2124  14684  14358]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5636566
{'0': {'precision': 0.5291189070279032, 'recall': 0.41015975587865733, 'f1-score': 0.4621062743313615, 'support': 11142}, '1': {'precision': 0.8708462295160633, 'recall': 0.8950704051687998, 'f1-score': 0.8827921683084032, 'support': 81102}, '2': {'precision': 0.4428183331872754, 'recall': 0.45269664934599535, 'f1-score': 0.4477030080184291, 'support': 11162}, 'accuracy': 0.7950699185733904, 'macro avg': {'precision': 0.6142611565770807, 'recall': 0.5859756034644842, 'f1-score': 0.5975338168860646, 'support': 103406}, 'weighted avg': {'precision': 0.7878222927427135, 'recall': 0.7950699185733904, 'f1-score': 0.790498225617951, 'support': 103406}}
[[ 4570  5417  1155]
 [ 3307 72592  5203]
 [  760  5349  5053]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/AAL
Evaluating performance on  test set...
10110/10110 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6608983
{'0': {'precision': 0.595231359870681, 'recall': 0.37046538944265445, 'f1-score': 0.45669122879365487, 'support': 397581}, '1': {'precision': 0.8025504202531746, 'recall': 0.9073351590195808, 'f1-score': 0.8517320948356724, 'support': 1790377}, '2': {'precision': 0.5411315318047828, 'recall': 0.4280348279843454, 'f1-score': 0.47798427956860207, 'support': 400138}, 'accuracy': 0.7507584726378002, 'macro avg': {'precision': 0.6463044373095461, 'recall': 0.5686117921488602, 'f1-score': 0.5954692010659765, 'support': 2588096}, 'weighted avg': {'precision': 0.730285036537928, 'recall': 0.7507584726378002, 'f1-score': 0.7332622058256874, 'support': 2588096}}
[[ 147290  201295   48996]
 [  69665 1624472   96240]
 [  30495  198370  171273]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63112575
{'0': {'precision': 0.5605641298563065, 'recall': 0.36320063447181944, 'f1-score': 0.44079890354777623, 'support': 58001}, '1': {'precision': 0.8311848817572502, 'recall': 0.9014522328515795, 'f1-score': 0.8648937059641709, 'support': 315583}, '2': {'precision': 0.5024360064960173, 'recall': 0.44820806457176365, 'f1-score': 0.4737753632435783, 'support': 57982}, 'accuracy': 0.7682185343609089, 'macro avg': {'precision': 0.6313950060365247, 'recall': 0.5709536439650542, 'f1-score': 0.5931559909185085, 'support': 431566}, 'weighted avg': {'precision': 0.7506461193978349, 'recall': 0.7682185343609089, 'f1-score': 0.755349056055284, 'support': 431566}}
[[ 21066  29811   7124]
 [ 12488 284483  18612]
 [  4026  27968  25988]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6932868
{'0': {'precision': 0.5244571937286711, 'recall': 0.378511511690166, 'f1-score': 0.4396898453373139, 'support': 28015}, '1': {'precision': 0.8135471936542253, 'recall': 0.8681559707554833, 'f1-score': 0.8399649457877963, 'support': 123100}, '2': {'precision': 0.4819991675915649, 'recall': 0.4743165295743882, 'f1-score': 0.4781269890419913, 'support': 29299}, 'accuracy': 0.728164111432594, 'macro avg': {'precision': 0.6066678516581537, 'recall': 0.5736613373400125, 'f1-score': 0.5859272600557005, 'support': 180414}, 'weighted avg': {'precision': 0.7148138250491044, 'recall': 0.728164111432594, 'f1-score': 0.7190475156891588, 'support': 180414}}
[[ 10604  12374   5037]
 [  6332 106870   9898]
 [  3283  12119  13897]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/WBA
Evaluating performance on  test set...
6546/6546 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8883897
{'0': {'precision': 0.49687876004295345, 'recall': 0.3875755618572827, 'f1-score': 0.43547317216981135, 'support': 396364}, '1': {'precision': 0.668224425070991, 'recall': 0.7267360347404337, 'f1-score': 0.6962530953148968, 'support': 886575}, '2': {'precision': 0.4505425139045593, 'recall': 0.46150830522497294, 'f1-score': 0.45595948748193876, 'support': 392825}, 'accuracy': 0.5843418285629719, 'macro avg': {'precision': 0.5385485663395012, 'recall': 0.525273300607563, 'f1-score': 0.5292285849888824, 'support': 1675764}, 'weighted avg': {'precision': 0.5766684840631124, 'recall': 0.5843418285629719, 'f1-score': 0.5782429757786969, 'support': 1675764}}
[[153621 162513  80230]
 [101405 644306 140864]
 [ 54146 157387 181292]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8884738
{'0': {'precision': 0.5326806907134394, 'recall': 0.3459743143340146, 'f1-score': 0.41949078004420687, 'support': 79266}, '1': {'precision': 0.6418505633729685, 'recall': 0.7854592128505891, 'f1-score': 0.7064303021990583, 'support': 157378}, '2': {'precision': 0.4854798783506613, 'recall': 0.4393144232246173, 'f1-score': 0.4612448679268104, 'support': 78124}, 'accuracy': 0.5888749809383419, 'macro avg': {'precision': 0.5533370441456897, 'recall': 0.523582650136407, 'f1-score': 0.5290553167233586, 'support': 314768}, 'weighted avg': {'precision': 0.5755485170311773, 'recall': 0.5888749809383419, 'f1-score': 0.5733182481458777, 'support': 314768}}
[[ 27424  35258  16584]
 [ 13974 123614  19790]
 [ 10085  33718  34321]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8131315
{'0': {'precision': 0.5516979700246633, 'recall': 0.3503051718599422, 'f1-score': 0.42851880050101926, 'support': 24904}, '1': {'precision': 0.6994521944905671, 'recall': 0.8327599894151893, 'f1-score': 0.7603069707951396, 'support': 64243}, '2': {'precision': 0.5035964414158622, 'recall': 0.438212888614371, 'f1-score': 0.46863509258647645, 'support': 24285}, 'accuracy': 0.6423672332322449, 'macro avg': {'precision': 0.5849155353103642, 'recall': 0.5404260166298341, 'f1-score': 0.5524869546275452, 'support': 113432}, 'weighted avg': {'precision': 0.6250813981586848, 'recall': 0.6423672332322449, 'f1-score': 0.6250179504542996, 'support': 113432}}
[[ 8724 11841  4339]
 [ 4593 53499  6151]
 [ 2496 11147 10642]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
7633/7633 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9559105
{'0': {'precision': 0.5235546847930854, 'recall': 0.319781983008065, 'f1-score': 0.3970498656315318, 'support': 519776}, '1': {'precision': 0.5950821102308559, 'recall': 0.7853496144635385, 'f1-score': 0.6771033981378758, 'support': 911976}, '2': {'precision': 0.49261336339110834, 'recall': 0.4083901568462998, 'f1-score': 0.44656528908315235, 'support': 522231}, 'accuracy': 0.5607566698379669, 'macro avg': {'precision': 0.5370833861383498, 'recall': 0.5045072514393011, 'f1-score': 0.5069061842841867, 'support': 1953983}, 'weighted avg': {'precision': 0.5486689146118506, 'recall': 0.5607566698379669, 'f1-score': 0.5409920542102291, 'support': 1953983}}
[[166215 246546 107015]
 [ 83101 716220 112655]
 [ 68158 240799 213274]]
Evaluating performance on  train set...
1586/1586 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9309014
{'0': {'precision': 0.5229348056912295, 'recall': 0.3321802975410468, 'f1-score': 0.4062813033999174, 'support': 103784}, '1': {'precision': 0.610800730037538, 'recall': 0.779140636516594, 'f1-score': 0.6847766114999118, 'support': 196727}, '2': {'precision': 0.4873985476292183, 'recall': 0.4116826023794377, 'f1-score': 0.44635237315791376, 'support': 105319}, 'accuracy': 0.5694773673705739, 'macro avg': {'precision': 0.5403780277859953, 'recall': 0.5076678454790262, 'f1-score': 0.5124700960192476, 'support': 405830}, 'weighted avg': {'precision': 0.55630581457683, 'recall': 0.5694773673705739, 'f1-score': 0.5516815731493938, 'support': 405830}}
[[ 34475  48337  20972]
 [ 18821 153278  24628]
 [ 12630  49331  43358]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8988986
{'0': {'precision': 0.49536226811340567, 'recall': 0.32756625390579797, 'f1-score': 0.3943573667711599, 'support': 34564}, '1': {'precision': 0.64755465703333, 'recall': 0.7614840989399293, 'f1-score': 0.6999134302516493, 'support': 76976}, '2': {'precision': 0.4688358208955224, 'recall': 0.4444884675251167, 'f1-score': 0.45633761894385116, 'support': 35335}, 'accuracy': 0.583108085106383, 'macro avg': {'precision': 0.5372509153474193, 'recall': 0.5111796067902813, 'f1-score': 0.5168694719888868, 'support': 146875}, 'weighted avg': {'precision': 0.5687433698465543, 'recall': 0.583108085106383, 'f1-score': 0.5694079591319852, 'support': 146875}}
[[11322 16239  7003]
 [ 7569 58616 10791]
 [ 3965 15664 15706]]
testing model on single stock: results/universal/W10/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
22048/22048 - 169s - 169s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1461024
{'0': {'precision': 0.3872501739075209, 'recall': 0.5023961484311082, 'f1-score': 0.4373715508405417, 'support': 2075414}, '1': {'precision': 0.26988964231295254, 'recall': 0.045561888121585264, 'f1-score': 0.07796241578729132, 'support': 1442280}, '2': {'precision': 0.39097966477096696, 'recall': 0.4979361531324055, 'f1-score': 0.4380232780382705, 'support': 2126369}, 'accuracy': 0.3839767557520177, 'macro avg': {'precision': 0.34937316033048016, 'recall': 0.34863139656169967, 'f1-score': 0.31778574822203454, 'support': 5644063}, 'weighted avg': {'precision': 0.358665008619607, 'recall': 0.3839767557520177, 'f1-score': 0.34577392076538227, 'support': 5644063}}
[[1042680   69808  962926]
 [ 690230   65713  686337]
 [ 959613  107960 1058796]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1781923
{'0': {'precision': 0.3658177186945535, 'recall': 0.4737063113555664, 'f1-score': 0.41282954614404466, 'support': 459616}, '1': {'precision': 0.37633894914419225, 'recall': 0.10999120803363199, 'f1-score': 0.17022993551001114, 'support': 458373}, '2': {'precision': 0.3633139587685042, 'recall': 0.5087408807857466, 'f1-score': 0.4239014681235463, 'support': 471806}, 'accuracy': 0.3656416953579485, 'macro avg': {'precision': 0.3684902088690833, 'recall': 0.3641461333916484, 'f1-score': 0.3356536499258673, 'support': 1389795}, 'weighted avg': {'precision': 0.36843778784807807, 'recall': 0.3656416953579485, 'f1-score': 0.3365756294846142, 'support': 1389795}}
[[217723  34570 207323]
 [194646  50417 213310]
 [182799  48980 240027]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1826615
{'0': {'precision': 0.3552538812740984, 'recall': 0.47685058281447834, 'f1-score': 0.40716767579948115, 'support': 153222}, '1': {'precision': 0.3918295831796385, 'recall': 0.09854867420838093, 'f1-score': 0.15748775707819254, 'support': 172463}, '2': {'precision': 0.3562593767048554, 'recall': 0.5290919218645163, 'f1-score': 0.42580602436030013, 'support': 157982}, 'accuracy': 0.35902180632542635, 'macro avg': {'precision': 0.3677809470528641, 'recall': 0.3681637262957918, 'f1-score': 0.3301538190793246, 'support': 483667}, 'weighted avg': {'precision': 0.3686242486071541, 'recall': 0.35902180632542635, 'f1-score': 0.32422626313313363, 'support': 483667}}
[[73064 11387 68771]
 [73201 16996 82266]
 [59402 14993 83587]]
training model: results/universal/W10/deepOF_L2/h30
Epoch 1/50
8543/8543 - 201s - loss: 2.9597 - accuracy30: 0.4860 - val_loss: 3.1237 - val_accuracy30: 0.4657 - 201s/epoch - 24ms/step
Epoch 2/50
8543/8543 - 193s - loss: 2.8929 - accuracy30: 0.5015 - val_loss: 3.1880 - val_accuracy30: 0.4487 - 193s/epoch - 23ms/step
Epoch 3/50
8543/8543 - 190s - loss: 2.8686 - accuracy30: 0.5064 - val_loss: 3.1921 - val_accuracy30: 0.4574 - 190s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 191s - loss: 2.8560 - accuracy30: 0.5095 - val_loss: 3.2221 - val_accuracy30: 0.4587 - 191s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 190s - loss: 2.8477 - accuracy30: 0.5113 - val_loss: 3.2362 - val_accuracy30: 0.4613 - 190s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 191s - loss: 2.8418 - accuracy30: 0.5125 - val_loss: 3.2504 - val_accuracy30: 0.4585 - 191s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 190s - loss: 2.8357 - accuracy30: 0.5142 - val_loss: 3.2572 - val_accuracy30: 0.4591 - 190s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 191s - loss: 2.8316 - accuracy30: 0.5152 - val_loss: 3.2771 - val_accuracy30: 0.4563 - 191s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 188s - loss: 2.8277 - accuracy30: 0.5162 - val_loss: 3.2893 - val_accuracy30: 0.4574 - 188s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 189s - loss: 2.8246 - accuracy30: 0.5173 - val_loss: 3.2870 - val_accuracy30: 0.4546 - 189s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 190s - loss: 2.8215 - accuracy30: 0.5180 - val_loss: 3.2758 - val_accuracy30: 0.4578 - 190s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 288s - 288s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0585829
{'0': {'precision': 0.403579366296357, 'recall': 0.5440423494638602, 'f1-score': 0.4634006650192969, 'support': 2946153}, '1': {'precision': 0.623950918009748, 'recall': 0.46365850186989505, 'f1-score': 0.5319927220136802, 'support': 3604213}, '2': {'precision': 0.41420878981591264, 'recall': 0.4004517030353055, 'f1-score': 0.4072140891807507, 'support': 2994888}, 'accuracy': 0.4686375029936343, 'macro avg': {'precision': 0.48057969137400586, 'recall': 0.4693841847896869, 'f1-score': 0.4675358254045759, 'support': 9545254}, 'weighted avg': {'precision': 0.49012498828412293, 'recall': 0.4686375029936343, 'f1-score': 0.4716715692588221, 'support': 9545254}}
[[1602832  490596  852725]
 [1089703 1671124  843386]
 [1279006  516574 1199308]]
Evaluating performance on  train set...
8543/8543 - 70s - 70s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0733752
{'0': {'precision': 0.3819623153614048, 'recall': 0.5342343639971833, 'f1-score': 0.4454445190979045, 'support': 624840}, '1': {'precision': 0.6466565848164895, 'recall': 0.4590197318821113, 'f1-score': 0.5369168674401117, 'support': 923176}, '2': {'precision': 0.3975408838703397, 'recall': 0.40922755113543846, 'f1-score': 0.4032995722776677, 'support': 638696}, 'accuracy': 0.4659685408961034, 'macro avg': {'precision': 0.4753865946827447, 'recall': 0.46749388233824435, 'f1-score': 0.4618869862718946, 'support': 2186712}, 'weighted avg': {'precision': 0.49825991938555153, 'recall': 0.4659685408961034, 'f1-score': 0.4717521753868294, 'support': 2186712}}
[[333811 109052 181977]
 [285297 423756 214123]
 [254829 122495 261372]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0777982
{'0': {'precision': 0.35886020807352614, 'recall': 0.5098219096296943, 'f1-score': 0.42122381212101767, 'support': 206019}, '1': {'precision': 0.6750577623921173, 'recall': 0.45988019093724225, 'f1-score': 0.5470707746654463, 'support': 369755}, '2': {'precision': 0.3763956395804623, 'recall': 0.4319993180752674, 'f1-score': 0.402285190142196, 'support': 211167}, 'accuracy': 0.4654732692793996, 'macro avg': {'precision': 0.47010453668203533, 'recall': 0.467233806214068, 'f1-score': 0.45685992564288663, 'support': 786941}, 'weighted avg': {'precision': 0.5121353979061767, 'recall': 0.4654732692793996, 'f1-score': 0.47527275816425774, 'support': 786941}}
[[105033  39021  61965]
 [110539 170043  89173]
 [ 77113  42830  91224]]
testing model out of sample: results/universal/W10/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9219728
{'0': {'precision': 0.48493064542993775, 'recall': 0.3869321662646458, 'f1-score': 0.43042382954635744, 'support': 1407058}, '1': {'precision': 0.6470884012838111, 'recall': 0.7783551831787506, 'f1-score': 0.7066777199800629, 'support': 2650362}, '2': {'precision': 0.47142359030900205, 'recall': 0.3863344530318081, 'f1-score': 0.4246586233081944, 'support': 1403354}, 'accuracy': 0.5767539546591747, 'macro avg': {'precision': 0.5344808790075836, 'recall': 0.5172072674917348, 'f1-score': 0.5205867242782048, 'support': 5460774}, 'weighted avg': {'precision': 0.5601620273344439, 'recall': 0.5767539546591747, 'f1-score': 0.5630208182374303, 'support': 5460774}}
[[ 544436  548756  313866]
 [ 293412 2062923  294027]
 [ 284861  576329  542164]]
Evaluating performance on  train set...
4055/4055 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92550963
{'0': {'precision': 0.458195776284779, 'recall': 0.3921527444787452, 'f1-score': 0.4226096166247432, 'support': 252343}, '1': {'precision': 0.6583285355991874, 'recall': 0.7523306618871791, 'f1-score': 0.7021975879207221, 'support': 528927}, '2': {'precision': 0.45691736390107257, 'recall': 0.3870906046424487, 'f1-score': 0.41911551846913564, 'support': 256201}, 'accuracy': 0.5745297940858106, 'macro avg': {'precision': 0.524480558595013, 'recall': 0.5105246703361244, 'f1-score': 0.5146409076715336, 'support': 1037471}, 'weighted avg': {'precision': 0.5599124406106002, 'recall': 0.5745297940858106, 'f1-score': 0.5642872494955448, 'support': 1037471}}
[[ 98957  99640  53746]
 [ 66870 397928  64129]
 [ 50144 106884  99173]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9224642
{'0': {'precision': 0.45192296448742386, 'recall': 0.40682533500352636, 'f1-score': 0.4281899865941347, 'support': 94999}, '1': {'precision': 0.667652487158391, 'recall': 0.7429650305351823, 'f1-score': 0.7032982992010157, 'support': 202062}, '2': {'precision': 0.4634394482497545, 'recall': 0.40038224111851517, 'f1-score': 0.42960932145305, 'support': 97844}, 'accuracy': 0.5772223699370734, 'macro avg': {'precision': 0.5276716332985231, 'recall': 0.5167242022190746, 'f1-score': 0.5203658690827334, 'support': 394905}, 'weighted avg': {'precision': 0.5651592052217332, 'recall': 0.5772223699370734, 'f1-score': 0.56930698754856, 'support': 394905}}
[[ 38648  36154  20197]
 [ 26778 150125  25159]
 [ 20093  38576  39175]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1217033
{'0': {'precision': 0.44796443800788477, 'recall': 0.43112393046575553, 'f1-score': 0.4393828792392526, 'support': 51658}, '1': {'precision': 0.3184380728392073, 'recall': 0.27940640932265115, 'f1-score': 0.29764810474420106, 'support': 32952}, '2': {'precision': 0.42133540832962796, 'recall': 0.47384102510678194, 'f1-score': 0.44604838630591054, 'support': 47995}, 'accuracy': 0.4088835262622073, 'macro avg': {'precision': 0.3959126397255733, 'recall': 0.3947904549650629, 'f1-score': 0.3943597900964548, 'support': 132605}, 'weighted avg': {'precision': 0.40613937059378885, 'recall': 0.4088835262622073, 'f1-score': 0.4065746647865797, 'support': 132605}}
[[22271  9874 19513]
 [12024  9207 11721]
 [15421  9832 22742]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.113919
{'0': {'precision': 0.4130541629804384, 'recall': 0.3654548617150809, 'f1-score': 0.3877993632042822, 'support': 11498}, '1': {'precision': 0.4211443508568109, 'recall': 0.3825521062351596, 'f1-score': 0.4009216589861751, 'support': 11371}, '2': {'precision': 0.39279253202113035, 'recall': 0.47397834439399233, 'f1-score': 0.42958331684539586, 'support': 11452}, 'accuracy': 0.4073307887299321, 'macro avg': {'precision': 0.4089970152861266, 'recall': 0.4073284374480776, 'f1-score': 0.40610144634528433, 'support': 34321}, 'weighted avg': {'precision': 0.40897378445406196, 'recall': 0.4073307887299321, 'f1-score': 0.4060891409623294, 'support': 34321}}
[[4202 2926 4370]
 [3000 4350 4021]
 [2971 3053 5428]]
Evaluating performance on  val set...
46/46 - 1s - 549ms/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.115307
{'0': {'precision': 0.4033766233766234, 'recall': 0.3881529617595601, 'f1-score': 0.39561839256145714, 'support': 4001}, '1': {'precision': 0.416515190859517, 'recall': 0.4180349231170185, 'f1-score': 0.41727367325702397, 'support': 3837}, '2': {'precision': 0.4081888972619945, 'recall': 0.42273673257023936, 'f1-score': 0.41533546325878595, 'support': 3844}, 'accuracy': 0.4093477144324602, 'macro avg': {'precision': 0.40936023716604497, 'recall': 0.40964153914893936, 'f1-score': 0.409409176359089, 'support': 11682}, 'weighted avg': {'precision': 0.40927553317350995, 'recall': 0.4093477144324602, 'f1-score': 0.40921912289782264, 'support': 11682}}
[[1553 1162 1286]
 [1163 1604 1070]
 [1134 1085 1625]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78076607
{'0': {'precision': 0.4270353532332356, 'recall': 0.42413665057556627, 'f1-score': 0.42558106607647195, 'support': 67325}, '1': {'precision': 0.8138229535830405, 'recall': 0.826408679863181, 'f1-score': 0.8200675307058286, 'support': 336503}, '2': {'precision': 0.4390017151009024, 'recall': 0.4079601990049751, 'f1-score': 0.42291211463778067, 'support': 67134}, 'accuracy': 0.7092546744747984, 'macro avg': {'precision': 0.5599533406390595, 'recall': 0.5528351764812408, 'f1-score': 0.5561869038066938, 'support': 470962}, 'weighted avg': {'precision': 0.7051013917207023, 'recall': 0.7092546744747984, 'f1-score': 0.7070617405709902, 'support': 470962}}
[[ 28555  31759   7011]
 [ 30426 278089  27988]
 [  7887  31859  27388]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6944926
{'0': {'precision': 0.44876736889287316, 'recall': 0.38451493970351025, 'f1-score': 0.4141639778274179, 'support': 13019}, '1': {'precision': 0.8751515367610354, 'recall': 0.9003934372105393, 'f1-score': 0.8875930622042011, 'support': 109039}, '2': {'precision': 0.44402985074626866, 'recall': 0.4013941983359568, 'f1-score': 0.4216369434274241, 'support': 13341}, 'accuracy': 0.801623350246309, 'macro avg': {'precision': 0.5893162521333924, 'recall': 0.5621008584166688, 'f1-score': 0.5744646611530143, 'support': 135399}, 'weighted avg': {'precision': 0.7916746285519748, 'recall': 0.801623350246309, 'f1-score': 0.7961603793180474, 'support': 135399}}
[[ 5006  6909  1104]
 [ 5260 98178  5601]
 [  889  7097  5355]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7295676
{'0': {'precision': 0.43609158103479356, 'recall': 0.37152511135002303, 'f1-score': 0.4012274008956709, 'support': 6511}, '1': {'precision': 0.8317043372021992, 'recall': 0.890204954105369, 'f1-score': 0.8599608876796191, 'support': 39765}, '2': {'precision': 0.5264427910717877, 'recall': 0.38466059359388777, 'f1-score': 0.44451990831140165, 'support': 6806}, 'accuracy': 0.7617648166986926, 'macro avg': {'precision': 0.5980795697695934, 'recall': 0.54879688634976, 'f1-score': 0.5685693989622306, 'support': 53082}, 'weighted avg': {'precision': 0.7440391260502162, 'recall': 0.7617648166986926, 'f1-score': 0.7504264873550199, 'support': 53082}}
[[ 2419  3505   587]
 [ 2598 35399  1768]
 [  530  3658  2618]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
967/967 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2279482
{'0': {'precision': 0.3801248802405101, 'recall': 0.39604846482169903, 'f1-score': 0.3879233323780786, 'support': 87156}, '1': {'precision': 0.32293243122941334, 'recall': 0.18976250261560995, 'f1-score': 0.2390523575735609, 'support': 76464}, '2': {'precision': 0.34921955364730084, 'recall': 0.46525013704506996, 'f1-score': 0.39896989918705833, 'support': 83914}, 'accuracy': 0.35578546785492093, 'macro avg': {'precision': 0.3507589550390748, 'recall': 0.3503537014941263, 'f1-score': 0.34198186304623257, 'support': 247534}, 'weighted avg': {'precision': 0.3519810575861391, 'recall': 0.35578546785492093, 'f1-score': 0.3456814237503995, 'support': 247534}}
[[34518 14601 38037]
 [27237 14510 34717]
 [29052 15821 39041]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2102244
{'0': {'precision': 0.37473840859414964, 'recall': 0.43469817122511734, 'f1-score': 0.4024975024975025, 'support': 18537}, '1': {'precision': 0.36776465409727827, 'recall': 0.27035918455398555, 'f1-score': 0.3116277624094738, 'support': 18542}, '2': {'precision': 0.3740237610640413, 'recall': 0.4119487019080388, 'f1-score': 0.39207124959686424, 'support': 19182}, 'accuracy': 0.37278043404845274, 'macro avg': {'precision': 0.37217560791848975, 'recall': 0.37233535256238054, 'f1-score': 0.3687321715012802, 'support': 56261}, 'weighted avg': {'precision': 0.37219640392300035, 'recall': 0.37278043404845274, 'f1-score': 0.36899466565044553, 'support': 56261}}
[[8058 3937 6542]
 [6846 5013 6683]
 [6599 4681 7902]]
Evaluating performance on  val set...
79/79 - 1s - 843ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2034465
{'0': {'precision': 0.394096025729382, 'recall': 0.49416678669163183, 'f1-score': 0.4384944724902549, 'support': 6943}, '1': {'precision': 0.3536959553695955, 'recall': 0.20028431527404833, 'f1-score': 0.25574828559903184, 'support': 6331}, '2': {'precision': 0.377490297542044, 'recall': 0.4324885134133689, 'f1-score': 0.40312219382468745, 'support': 6747}, 'accuracy': 0.38045052694670595, 'macro avg': {'precision': 0.3750940928803405, 'recall': 0.37564653845968304, 'f1-score': 0.36578831730465805, 'support': 20021}, 'weighted avg': {'precision': 0.37572473091255076, 'recall': 0.38045052694670595, 'f1-score': 0.36878652216984553, 'support': 20021}}
[[3431 1096 2416]
 [2667 1268 2396]
 [2608 1221 2918]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2086607
{'0': {'precision': 0.3479924411541776, 'recall': 0.47345632796055886, 'f1-score': 0.4011430281268701, 'support': 141578}, '1': {'precision': 0.3349468298555377, 'recall': 0.10801083747826438, 'f1-score': 0.16334693028859382, 'support': 123645}, '2': {'precision': 0.35728794443773126, 'recall': 0.4401877241985566, 'f1-score': 0.3944290047483683, 'support': 141058}, 'accuracy': 0.35068831670690975, 'macro avg': {'precision': 0.34674240514914884, 'recall': 0.3405516298791266, 'f1-score': 0.31963965438794406, 'support': 406281}, 'weighted avg': {'precision': 0.34724955751736264, 'recall': 0.35068831670690975, 'f1-score': 0.32644259855487834, 'support': 406281}}
[[67031 13000 61547]
 [60142 13355 50148]
 [65449 13517 62092]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2036239
{'0': {'precision': 0.35098322976079, 'recall': 0.47320096407666706, 'f1-score': 0.403030303030303, 'support': 26139}, '1': {'precision': 0.3758189398451459, 'recall': 0.12641237278628095, 'f1-score': 0.1891883788564747, 'support': 24958}, '2': {'precision': 0.3354577420570137, 'recall': 0.4380714197859866, 'f1-score': 0.3799583948224668, 'support': 24391}, 'accuracy': 0.3471942560406952, 'macro avg': {'precision': 0.3540866372209832, 'recall': 0.34589491888297824, 'f1-score': 0.3240590255697482, 'support': 75488}, 'weighted avg': {'precision': 0.35417800882107175, 'recall': 0.3471942560406952, 'f1-score': 0.3248746537002407, 'support': 75488}}
[[12369  2808 10962]
 [11598  3155 10205]
 [11274  2432 10685]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1993049
{'0': {'precision': 0.368260144524736, 'recall': 0.4663440387153542, 'f1-score': 0.41153861086306637, 'support': 11365}, '1': {'precision': 0.4724155069582505, 'recall': 0.16695942385385562, 'f1-score': 0.24672290720311488, 'support': 11386}, '2': {'precision': 0.31724461105904406, 'recall': 0.44694897670470624, 'f1-score': 0.37108962060999967, 'support': 10603}, 'accuracy': 0.3579780536067638, 'macro avg': {'precision': 0.38597342084734354, 'recall': 0.3600841464246387, 'f1-score': 0.34311704622539363, 'support': 33354}, 'weighted avg': {'precision': 0.3875980127064013, 'recall': 0.3579780536067638, 'f1-score': 0.34241729871083654, 'support': 33354}}
[[5300 1092 4973]
 [4259 1901 5226]
 [4833 1031 4739]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1608645
{'0': {'precision': 0.409228867678363, 'recall': 0.42213974046580155, 'f1-score': 0.41558405333221765, 'support': 211764}, '1': {'precision': 0.24171622769753612, 'recall': 0.1406123509812443, 'f1-score': 0.17779621478636115, 'support': 117351}, '2': {'precision': 0.39820921598602316, 'recall': 0.4788317473656065, 'f1-score': 0.43481484371951457, 'support': 209441}, 'accuracy': 0.38284226709942887, 'macro avg': {'precision': 0.3497181037873074, 'recall': 0.3471946129375508, 'f1-score': 0.34273170394603114, 'support': 538556}, 'weighted avg': {'precision': 0.3684425006441356, 'recall': 0.38284226709942887, 'f1-score': 0.37124897086783337, 'support': 538556}}
[[ 89394  24940  97430]
 [ 46722  16501  54128]
 [ 82329  26825 100287]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2069349
{'0': {'precision': 0.36093194359288777, 'recall': 0.40692915998451584, 'f1-score': 0.3825528651824125, 'support': 36166}, '1': {'precision': 0.37365771064474446, 'recall': 0.23108931081043843, 'f1-score': 0.28556834434379896, 'support': 36289}, '2': {'precision': 0.3676283090221502, 'recall': 0.45931205788649493, 'f1-score': 0.40838764658576693, 'support': 37038}, 'accuracy': 0.3663704529056652, 'macro avg': {'precision': 0.3674059877532608, 'recall': 0.3657768428938164, 'f1-score': 0.3588362853706595, 'support': 109493}, 'weighted avg': {'precision': 0.3674147812474762, 'recall': 0.3663704529056652, 'f1-score': 0.3591486051557897, 'support': 109493}}
[[14717  6664 14785]
 [13425  8386 14478]
 [12633  7393 17012]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1936827
{'0': {'precision': 0.37183138706921104, 'recall': 0.4371337686254813, 'f1-score': 0.40184686417853016, 'support': 11946}, '1': {'precision': 0.37268211920529803, 'recall': 0.19506065857885616, 'f1-score': 0.2560864618885097, 'support': 11540}, '2': {'precision': 0.3767768020721461, 'recall': 0.47992274885330327, 'f1-score': 0.4221404303510759, 'support': 12427}, 'accuracy': 0.37415420599782806, 'macro avg': {'precision': 0.37376343611555174, 'recall': 0.3707057253525469, 'f1-score': 0.36002458547270527, 'support': 35913}, 'weighted avg': {'precision': 0.37381601996236724, 'recall': 0.37415420599782806, 'f1-score': 0.3620315634350498, 'support': 35913}}
[[5222 1749 4975]
 [4399 2251 4890]
 [4423 2040 5964]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/EXC
Evaluating performance on  test set...
5267/5267 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7808313
{'0': {'precision': 0.525104423689504, 'recall': 0.3807715511185673, 'f1-score': 0.4414397367141485, 'support': 242006}, '1': {'precision': 0.742327275644223, 'recall': 0.8365278864261915, 'f1-score': 0.7866173944883744, 'support': 862875}, '2': {'precision': 0.48084602943231963, 'recall': 0.39590551698910414, 'f1-score': 0.43426121493957764, 'support': 243303}, 'accuracy': 0.6751993793132095, 'macro avg': {'precision': 0.5827592429220155, 'recall': 0.537734984844621, 'f1-score': 0.5541061153807002, 'support': 1348184}, 'weighted avg': {'precision': 0.6561458603795051, 'recall': 0.6751993793132095, 'f1-score': 0.6610674845353782, 'support': 1348184}}
[[ 92149 123662  26195]
 [ 63252 721819  77804]
 [ 20086 126892  96325]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72871965
{'0': {'precision': 0.44618294825023647, 'recall': 0.43969534766051505, 'f1-score': 0.4429153924566769, 'support': 37551}, '1': {'precision': 0.8154118496395265, 'recall': 0.8432269907906915, 'f1-score': 0.8290861922035612, 'support': 195563}, '2': {'precision': 0.4916778565406114, 'recall': 0.41273461256160215, 'f1-score': 0.44876088412592097, 'support': 38148}, 'accuracy': 0.7268249883876104, 'macro avg': {'precision': 0.5844242181434581, 'recall': 0.5652189836709361, 'f1-score': 0.5735874895953863, 'support': 271262}, 'weighted avg': {'precision': 0.7187720001773584, 'recall': 0.7268249883876104, 'f1-score': 0.7221425378994527, 'support': 271262}}
[[ 16511  17942   3098]
 [ 17479 164904  13180]
 [  3015  19388  15745]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71568
{'0': {'precision': 0.4755669862052841, 'recall': 0.44874246212678337, 'f1-score': 0.4617654848840289, 'support': 13598}, '1': {'precision': 0.8259807662952221, 'recall': 0.8536607811945361, 'f1-score': 0.8395926943591402, 'support': 76063}, '2': {'precision': 0.459918080748976, 'recall': 0.40029101491451435, 'f1-score': 0.42803796483584877, 'support': 13745}, 'accuracy': 0.7401504748273795, 'macro avg': {'precision': 0.5871552777498273, 'recall': 0.567564752745278, 'f1-score': 0.5764653813596726, 'support': 103406}, 'weighted avg': {'precision': 0.7312429542292285, 'recall': 0.7401504748273795, 'f1-score': 0.7352030636632405, 'support': 103406}}
[[ 6102  6503   993]
 [ 5663 64932  5468]
 [ 1066  7177  5502]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/AAL
Evaluating performance on  test set...
10110/10110 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7818329
{'0': {'precision': 0.5655469780168758, 'recall': 0.3852442079161993, 'f1-score': 0.45829978403028093, 'support': 474268}, '1': {'precision': 0.7397675391639286, 'recall': 0.8818225881078742, 'f1-score': 0.8045728880715937, 'support': 1636091}, '2': {'precision': 0.5518829860912551, 'recall': 0.363618476274603, 'f1-score': 0.43839329314841713, 'support': 477737}, 'accuracy': 0.6951693445683622, 'macro avg': {'precision': 0.6190658344240199, 'recall': 0.5435617574328923, 'f1-score': 0.5670886550834305, 'support': 2588096}, 'weighted avg': {'precision': 0.6731600254452063, 'recall': 0.6951693445683622, 'f1-score': 0.6735252786910766, 'support': 2588096}}
[[ 182709  246155   45404]
 [  97701 1442742   95648]
 [  42656  261367  173714]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75769144
{'0': {'precision': 0.5191848153400812, 'recall': 0.38465081466981405, 'f1-score': 0.44190526585585654, 'support': 69476}, '1': {'precision': 0.7776016164911309, 'recall': 0.8726849243021901, 'f1-score': 0.8224040989858743, 'support': 292809}, '2': {'precision': 0.513966588966589, 'recall': 0.3819084597508696, 'f1-score': 0.43820438717797966, 'support': 69281}, 'accuracy': 0.7153320697181891, 'macro avg': {'precision': 0.6035843402659337, 'recall': 0.5464147329076247, 'f1-score': 0.5675045840065702, 'support': 431566}, 'weighted avg': {'precision': 0.6936778040992878, 'recall': 0.7153320697181891, 'f1-score': 0.6994720858886797, 'support': 431566}}
[[ 26724  36249   6503]
 [ 18761 255530  18518]
 [  5988  36834  26459]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80135864
{'0': {'precision': 0.501915421017051, 'recall': 0.40490834722011815, 'f1-score': 0.44822323959014604, 'support': 33005}, '1': {'precision': 0.7561800243875402, 'recall': 0.8455830920569146, 'f1-score': 0.7983865237109954, 'support': 112941}, '2': {'precision': 0.5066923692441987, 'recall': 0.404171985609841, 'f1-score': 0.44966269649139795, 'support': 34468}, 'accuracy': 0.6806345405567196, 'macro avg': {'precision': 0.5882626048829299, 'recall': 0.5515544749622913, 'f1-score': 0.5654241532641798, 'support': 180414}, 'weighted avg': {'precision': 0.6620002837259303, 'recall': 0.6806345405567196, 'f1-score': 0.6677040264047235, 'support': 180414}}
[[13364 14951  4690]
 [ 8567 95501  8873]
 [ 4695 15842 13931]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/WBA
Evaluating performance on  test set...
6546/6546 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9693721
{'0': {'precision': 0.515438381450595, 'recall': 0.3103260451785067, 'f1-score': 0.38740819849004765, 'support': 455305}, '1': {'precision': 0.576267342471682, 'recall': 0.7187827244663195, 'f1-score': 0.6396833929704602, 'support': 770639}, '2': {'precision': 0.43807700865995486, 'recall': 0.42892045707171755, 'f1-score': 0.43345038068471575, 'support': 449820}, 'accuracy': 0.5299982575112009, 'macro avg': {'precision': 0.5099275775274106, 'recall': 0.4860097422388479, 'f1-score': 0.48684732404840786, 'support': 1675764}, 'weighted avg': {'precision': 0.52264612489397, 'recall': 0.5299982575112009, 'f1-score': 0.5157817630218052, 'support': 1675764}}
[[141293 208262 105750]
 [ 74986 553922 141731]
 [ 57843 199040 192937]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94770753
{'0': {'precision': 0.5148224199558902, 'recall': 0.3748864718782535, 'f1-score': 0.4338496837166973, 'support': 90286}, '1': {'precision': 0.5624509419152276, 'recall': 0.7617434057537705, 'f1-score': 0.6471003245378862, 'support': 135459}, '2': {'precision': 0.5085485076334132, 'recall': 0.37455489030924594, 'f1-score': 0.43138624749336957, 'support': 89023}, 'accuracy': 0.5412748436944035, 'macro avg': {'precision': 0.5286072898348437, 'recall': 0.5037282559804234, 'f1-score': 0.5041120852493177, 'support': 314768}, 'weighted avg': {'precision': 0.5335447470647641, 'recall': 0.5412748436944035, 'f1-score': 0.5249244310610529, 'support': 314768}}
[[ 33847  39986  16453]
 [ 16504 103185  15770]
 [ 15394  40285  33344]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89168125
{'0': {'precision': 0.5294821312864477, 'recall': 0.37094070815001046, 'f1-score': 0.4362538756904376, 'support': 28638}, '1': {'precision': 0.6290269559500329, 'recall': 0.8079663611252837, 'f1-score': 0.7073555800288032, 'support': 56839}, '2': {'precision': 0.5161337851775453, 'recall': 0.37592559470577713, 'f1-score': 0.4350111764218892, 'support': 27955}, 'accuracy': 0.591155934833204, 'macro avg': {'precision': 0.5582142908046753, 'recall': 0.5182775546603571, 'f1-score': 0.5262068773803766, 'support': 113432}, 'weighted avg': {'precision': 0.57607282239283, 'recall': 0.591155934833204, 'f1-score': 0.5717924372501041, 'support': 113432}}
[[10623 13590  4425]
 [ 5488 45924  5427]
 [ 3952 13494 10509]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
7633/7633 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98949575
{'0': {'precision': 0.48900890506937145, 'recall': 0.3698240503459221, 'f1-score': 0.42114651699766165, 'support': 582212}, '1': {'precision': 0.5294828190231513, 'recall': 0.7369664154086837, 'f1-score': 0.6162284986196644, 'support': 787504}, '2': {'precision': 0.4944034139893097, 'recall': 0.3533504373856473, 'f1-score': 0.4121424215171439, 'support': 584267}, 'accuracy': 0.5128657721177717, 'macro avg': {'precision': 0.5042983793606108, 'recall': 0.48671363438008436, 'f1-score': 0.4831724790448233, 'support': 1953983}, 'weighted avg': {'precision': 0.5069339344464863, 'recall': 0.5128657721177717, 'f1-score': 0.4970770880421068, 'support': 1953983}}
[[215316 253319 113577]
 [109592 580364  97548]
 [115403 262413 206451]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9722291
{'0': {'precision': 0.49453828644863373, 'recall': 0.38922222412699503, 'f1-score': 0.43560509767995126, 'support': 116666}, '1': {'precision': 0.5438960381123721, 'recall': 0.7330445631959321, 'f1-score': 0.6244613622177714, 'support': 169916}, '2': {'precision': 0.49930589868473685, 'recall': 0.3559137260163692, 'f1-score': 0.41558873929008566, 'support': 119248}, 'accuracy': 0.5233891038119409, 'macro avg': {'precision': 0.5125800744152476, 'recall': 0.4927268377797654, 'f1-score': 0.49188506639593604, 'support': 405830}, 'weighted avg': {'precision': 0.5166046688147146, 'recall': 0.5233891038119409, 'f1-score': 0.5087953259527096, 'support': 405830}}
[[ 45409  49513  21744]
 [ 24544 124556  20816]
 [ 21868  54938  42442]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9510432
{'0': {'precision': 0.4648874217557846, 'recall': 0.38175122749590834, 'f1-score': 0.4192375201853542, 'support': 39104}, '1': {'precision': 0.582093583044678, 'recall': 0.7353774494533696, 'f1-score': 0.6498184535123018, 'support': 67413}, '2': {'precision': 0.4989019899320923, 'recall': 0.36590019327023143, 'f1-score': 0.4221736209385765, 'support': 40358}, 'accuracy': 0.5397038297872341, 'macro avg': {'precision': 0.5152943315775184, 'recall': 0.49434295673983647, 'f1-score': 0.4970765315454108, 'support': 146875}, 'weighted avg': {'precision': 0.5280294057110363, 'recall': 0.5397038297872341, 'f1-score': 0.5258768230794346, 'support': 146875}}
[[14928 17311  6865]
 [ 9872 49574  7967]
 [ 7311 18280 14767]]
testing model on single stock: results/universal/W10/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
22048/22048 - 171s - 171s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1637574
{'0': {'precision': 0.39039991221768056, 'recall': 0.6243936705950521, 'f1-score': 0.48041934501386596, 'support': 2039939}, '1': {'precision': 0.2864863825203878, 'recall': 0.06902448179505359, 'f1-score': 0.11124596224583154, 'support': 1510551}, '2': {'precision': 0.4064098045950861, 'recall': 0.3916428994833235, 'f1-score': 0.39888973105824366, 'support': 2093573}, 'accuracy': 0.3894221237431262, 'macro avg': {'precision': 0.36109869977771814, 'recall': 0.36168701729114305, 'f1-score': 0.33018501277264706, 'support': 5644063}, 'weighted avg': {'precision': 0.36852758234050986, 'recall': 0.3894221237431262, 'f1-score': 0.35137340399734096, 'support': 5644063}}
[[1273725  114229  651985]
 [ 860701  104265  545585]
 [1128190  145450  819933]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.19885
{'0': {'precision': 0.36747423624819714, 'recall': 0.5826382290949994, 'f1-score': 0.4506930412040197, 'support': 457845}, '1': {'precision': 0.36445492839090143, 'recall': 0.11802940913267723, 'f1-score': 0.17831210884174292, 'support': 458157}, '2': {'precision': 0.3806947470111368, 'recall': 0.4142040933487831, 'f1-score': 0.3967431188023734, 'support': 473793}, 'accuracy': 0.37205559093247564, 'macro avg': {'precision': 0.37087463721674513, 'recall': 0.3716239105254866, 'f1-score': 0.34191608961604536, 'support': 1389795}, 'weighted avg': {'precision': 0.3709858825168414, 'recall': 0.37205559093247564, 'f1-score': 0.34250850577775405, 'support': 1389795}}
[[266758  41224 149863]
 [234694  54076 169387]
 [224471  53075 196247]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2287244
{'0': {'precision': 0.3365760133375013, 'recall': 0.553455283159821, 'f1-score': 0.4185915113313567, 'support': 145907}, '1': {'precision': 0.4104832713754647, 'recall': 0.118921713282571, 'f1-score': 0.18441599652612503, 'support': 185702}, '2': {'precision': 0.3577829021490771, 'recall': 0.4469215694011496, 'f1-score': 0.39741520467836255, 'support': 152058}, 'accuracy': 0.35312518737064963, 'macro avg': {'precision': 0.36828072895401437, 'recall': 0.3730995219478472, 'f1-score': 0.3334742375119481, 'support': 483667}, 'weighted avg': {'precision': 0.3716195510009691, 'recall': 0.35312518737064963, 'f1-score': 0.32202323545683537, 'support': 483667}}
[[80753 14326 50828]
 [92462 22084 71156]
 [66710 17390 67958]]
training model: results/universal/W10/deepVOL_L2/h10
Epoch 1/50
8543/8543 - 283s - loss: 2.8387 - accuracy10: 0.5089 - val_loss: 2.9994 - val_accuracy10: 0.4878 - 283s/epoch - 33ms/step
Epoch 2/50
8543/8543 - 275s - loss: 2.7745 - accuracy10: 0.5287 - val_loss: 3.0364 - val_accuracy10: 0.5050 - 275s/epoch - 32ms/step
Epoch 3/50
8543/8543 - 273s - loss: 2.7391 - accuracy10: 0.5383 - val_loss: 2.8661 - val_accuracy10: 0.5231 - 273s/epoch - 32ms/step
Epoch 4/50
8543/8543 - 272s - loss: 2.7229 - accuracy10: 0.5423 - val_loss: 2.8735 - val_accuracy10: 0.5227 - 272s/epoch - 32ms/step
Epoch 5/50
8543/8543 - 276s - loss: 2.7127 - accuracy10: 0.5445 - val_loss: 2.8023 - val_accuracy10: 0.5334 - 276s/epoch - 32ms/step
Epoch 6/50
8543/8543 - 275s - loss: 2.7050 - accuracy10: 0.5463 - val_loss: 2.8207 - val_accuracy10: 0.5326 - 275s/epoch - 32ms/step
Epoch 7/50
8543/8543 - 273s - loss: 2.6984 - accuracy10: 0.5478 - val_loss: 2.8014 - val_accuracy10: 0.5341 - 273s/epoch - 32ms/step
Epoch 8/50
8543/8543 - 276s - loss: 2.6926 - accuracy10: 0.5493 - val_loss: 2.8203 - val_accuracy10: 0.5323 - 276s/epoch - 32ms/step
Epoch 9/50
8543/8543 - 274s - loss: 2.6870 - accuracy10: 0.5505 - val_loss: 2.8164 - val_accuracy10: 0.5329 - 274s/epoch - 32ms/step
Epoch 10/50
8543/8543 - 276s - loss: 2.6829 - accuracy10: 0.5512 - val_loss: 2.7986 - val_accuracy10: 0.5369 - 276s/epoch - 32ms/step
Epoch 11/50
8543/8543 - 274s - loss: 2.6781 - accuracy10: 0.5524 - val_loss: 2.7873 - val_accuracy10: 0.5366 - 274s/epoch - 32ms/step
Epoch 12/50
8543/8543 - 275s - loss: 2.6745 - accuracy10: 0.5530 - val_loss: 2.7797 - val_accuracy10: 0.5378 - 275s/epoch - 32ms/step
Epoch 13/50
8543/8543 - 275s - loss: 2.6711 - accuracy10: 0.5537 - val_loss: 2.7893 - val_accuracy10: 0.5374 - 275s/epoch - 32ms/step
Epoch 14/50
8543/8543 - 272s - loss: 2.6680 - accuracy10: 0.5542 - val_loss: 2.7879 - val_accuracy10: 0.5375 - 272s/epoch - 32ms/step
Epoch 15/50
8543/8543 - 274s - loss: 2.6654 - accuracy10: 0.5547 - val_loss: 2.7905 - val_accuracy10: 0.5370 - 274s/epoch - 32ms/step
Epoch 16/50
8543/8543 - 273s - loss: 2.6626 - accuracy10: 0.5552 - val_loss: 2.7875 - val_accuracy10: 0.5375 - 273s/epoch - 32ms/step
Epoch 17/50
8543/8543 - 272s - loss: 2.6604 - accuracy10: 0.5559 - val_loss: 2.7913 - val_accuracy10: 0.5355 - 272s/epoch - 32ms/step
Epoch 18/50
8543/8543 - 273s - loss: 2.6575 - accuracy10: 0.5566 - val_loss: 2.7908 - val_accuracy10: 0.5366 - 273s/epoch - 32ms/step
Epoch 19/50
8543/8543 - 276s - loss: 2.6554 - accuracy10: 0.5572 - val_loss: 2.7939 - val_accuracy10: 0.5351 - 276s/epoch - 32ms/step
Epoch 20/50
8543/8543 - 275s - loss: 2.6532 - accuracy10: 0.5577 - val_loss: 2.7871 - val_accuracy10: 0.5371 - 275s/epoch - 32ms/step
Epoch 21/50
8543/8543 - 276s - loss: 2.6513 - accuracy10: 0.5580 - val_loss: 2.8041 - val_accuracy10: 0.5358 - 276s/epoch - 32ms/step
Epoch 22/50
8543/8543 - 273s - loss: 2.6493 - accuracy10: 0.5585 - val_loss: 2.7976 - val_accuracy10: 0.5357 - 273s/epoch - 32ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 578s - 578s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92459184
{'0': {'precision': 0.4686850314450307, 'recall': 0.5041557298275181, 'f1-score': 0.4857737329556737, 'support': 2787597}, '1': {'precision': 0.7921843068166419, 'recall': 0.5558407356327435, 'f1-score': 0.6532939581858106, 'support': 3943707}, '2': {'precision': 0.4477477439339949, 'recall': 0.6013919810943594, 'f1-score': 0.5133194298742576, 'support': 2813975}, 'accuracy': 0.5541753153574662, 'macro avg': {'precision': 0.5695390273985558, 'recall': 0.5537961488515403, 'f1-score': 0.5507957070052473, 'support': 9545279}, 'weighted avg': {'precision': 0.5961689272173893, 'recall': 0.5541753153574662, 'f1-score': 0.563106578582097, 'support': 9545279}}
[[1405383  292000 1090214]
 [ 754562 2192073  997072]
 [ 838621  283052 1692302]]
Evaluating performance on  train set...
8543/8543 - 138s - 138s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95127213
{'0': {'precision': 0.439382174405971, 'recall': 0.5137179704031509, 'f1-score': 0.47365121093830814, 'support': 579386}, '1': {'precision': 0.8000178343191748, 'recall': 0.5000601380535024, 'f1-score': 0.6154354387603318, 'support': 1022647}, '2': {'precision': 0.4114654146960964, 'recall': 0.6123173595445084, 'f1-score': 0.49218920773009295, 'support': 584687}, 'accuracy': 0.533694300139021, 'macro avg': {'precision': 0.5502884744737474, 'recall': 0.5420318226670539, 'f1-score': 0.5270919524762443, 'support': 2186720}, 'weighted avg': {'precision': 0.6005735520029064, 'recall': 0.533694300139021, 'f1-score': 0.5449150860387815, 'support': 2186720}}
[[297641  64497 217248]
 [216429 511385 294833]
 [163338  63335 358014]]
Evaluating performance on  val set...
3077/3077 - 52s - 52s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94545245
{'0': {'precision': 0.43046844737311707, 'recall': 0.505349642846194, 'f1-score': 0.46491316722800274, 'support': 195714}, '1': {'precision': 0.8046132540781626, 'recall': 0.5149018940653972, 'f1-score': 0.6279532131144495, 'support': 393809}, '2': {'precision': 0.39880263852069825, 'recall': 0.6164674298450005, 'f1-score': 0.4843023452469304, 'support': 197420}, 'accuracy': 0.5380059292731494, 'macro avg': {'precision': 0.5446281133239926, 'recall': 0.545572988918864, 'f1-score': 0.5257229085297942, 'support': 786943}, 'weighted avg': {'precision': 0.6097573262373586, 'recall': 0.5380059292731494, 'f1-score': 0.5513672674042447, 'support': 786943}}
[[ 98904  25019  71791]
 [ 79359 202773 111677]
 [ 51496  24221 121703]]
testing model out of sample: results/universal/W10/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 333s - 333s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7379714
{'0': {'precision': 0.5247336133621519, 'recall': 0.4183841925375533, 'f1-score': 0.4655627276899984, 'support': 1076403}, '1': {'precision': 0.7913092267059494, 'recall': 0.8279067169136742, 'f1-score': 0.8091943838956173, 'support': 3311640}, '2': {'precision': 0.47315981588270917, 'recall': 0.5018280018941865, 'f1-score': 0.4870724344483556, 'support': 1072756}, 'accuracy': 0.6831267732066315, 'macro avg': {'precision': 0.5964008853169368, 'recall': 0.5827063037818047, 'f1-score': 0.587276515344657, 'support': 5460799}, 'weighted avg': {'precision': 0.6762638864018657, 'recall': 0.6831267732066315, 'f1-score': 0.6781797833516413, 'support': 5460799}}
[[ 450350  364774  261279]
 [ 231776 2741729  338135]
 [ 176119  358298  538339]]
Evaluating performance on  train set...
4055/4055 - 64s - 64s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7356811
{'0': {'precision': 0.4999515539083884, 'recall': 0.42983958722737375, 'f1-score': 0.4622521339645407, 'support': 192067}, '1': {'precision': 0.8081936887415473, 'recall': 0.8004376804472019, 'f1-score': 0.8042969868163086, 'support': 651160}, '2': {'precision': 0.4495574598680074, 'recall': 0.5263548053311918, 'f1-score': 0.4849344305058218, 'support': 194253}, 'accuracy': 0.6805114315456684, 'macro avg': {'precision': 0.5859009008393145, 'recall': 0.5855440243352558, 'f1-score': 0.5838278504288904, 'support': 1037480}, 'weighted avg': {'precision': 0.6839799154848366, 'recall': 0.6805114315456684, 'f1-score': 0.6811787933054346, 'support': 1037480}}
[[ 82558  61756  47753]
 [ 52509 521213  77438]
 [ 30065  61942 102246]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74471587
{'0': {'precision': 0.4840398446947998, 'recall': 0.4247692458073255, 'f1-score': 0.45247179395643217, 'support': 71613}, '1': {'precision': 0.8158010235346727, 'recall': 0.7875647047067053, 'f1-score': 0.8014342341023122, 'support': 250175}, '2': {'precision': 0.4347451543431443, 'recall': 0.538370009710464, 'f1-score': 0.48104019259204944, 'support': 73117}, 'accuracy': 0.6756359124346362, 'macro avg': {'precision': 0.578195340857539, 'recall': 0.5835679867414982, 'f1-score': 0.578315406883598, 'support': 394905}, 'weighted avg': {'precision': 0.6850858508021501, 'recall': 0.6756359124346362, 'f1-score': 0.6788313337610331, 'support': 394905}}
[[ 30419  22373  18821]
 [ 20786 197029  32360]
 [ 11639  22114  39364]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0526268
{'0': {'precision': 0.5455370062414963, 'recall': 0.4966965549787636, 'f1-score': 0.5199724163484598, 'support': 50856}, '1': {'precision': 0.4489437743314825, 'recall': 0.4024889143184094, 'f1-score': 0.42444903685155294, 'support': 34955}, '2': {'precision': 0.47723262202332223, 'recall': 0.5605461655163572, 'f1-score': 0.5155451615439038, 'support': 46799}, 'accuracy': 0.4943971042907775, 'macro avg': {'precision': 0.490571134198767, 'recall': 0.4865772116045101, 'f1-score': 0.48665553824797225, 'support': 132610}, 'weighted avg': {'precision': 0.4959706590697833, 'recall': 0.4943971042907775, 'f1-score': 0.4932307616624422, 'support': 132610}}
[[25260  8681 16915]
 [ 9065 14069 11821]
 [11978  8588 26233]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0283589
{'0': {'precision': 0.5141357399392209, 'recall': 0.5020231993525762, 'f1-score': 0.5080072793448589, 'support': 11121}, '1': {'precision': 0.5395087585681645, 'recall': 0.4921406860616587, 'f1-score': 0.5147372723556928, 'support': 11515}, '2': {'precision': 0.4902006172839506, 'recall': 0.5435954479336015, 'f1-score': 0.5155191301172557, 'support': 11687}, 'accuracy': 0.5128630947178277, 'macro avg': {'precision': 0.514615038597112, 'recall': 0.5125864444492788, 'f1-score': 0.5127545606059358, 'support': 34323}, 'weighted avg': {'precision': 0.5144981945917904, 'recall': 0.5128630947178277, 'f1-score': 0.5128229093741906, 'support': 34323}}
[[5583 2215 3323]
 [2564 5667 3284]
 [2712 2622 6353]]
Evaluating performance on  val set...
46/46 - 1s - 522ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0153296
{'0': {'precision': 0.5026020268419611, 'recall': 0.48493657505285415, 'f1-score': 0.49361129791526565, 'support': 3784}, '1': {'precision': 0.5635897435897436, 'recall': 0.5375397407679139, 'f1-score': 0.5502566028288898, 'support': 4089}, '2': {'precision': 0.48898571774388766, 'recall': 0.5303229194014177, 'f1-score': 0.508816120906801, 'support': 3809}, 'accuracy': 0.5181475774696114, 'macro avg': {'precision': 0.5183924960585308, 'recall': 0.5175997450740618, 'f1-score': 0.5175613405503188, 'support': 11682}, 'weighted avg': {'precision': 0.5195095985272137, 'recall': 0.5181475774696114, 'f1-score': 0.5183962510539891, 'support': 11682}}
[[1835  852 1097]
 [ 877 2198 1014]
 [ 939  850 2020]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4479456
{'0': {'precision': 0.48264493085447385, 'recall': 0.39237584692130145, 'f1-score': 0.4328542094455852, 'support': 40293}, '1': {'precision': 0.9112351713227155, 'recall': 0.923774387353804, 'f1-score': 0.9174619370713268, 'support': 390315}, '2': {'precision': 0.45715360737465904, 'recall': 0.4816769493793206, 'f1-score': 0.4690949893222977, 'support': 40359}, 'accuracy': 0.8404261869727603, 'macro avg': {'precision': 0.6170112365172828, 'recall': 0.5992757278848088, 'f1-score': 0.60647037861307, 'support': 470967}, 'weighted avg': {'precision': 0.8356556415497877, 'recall': 0.8404261869727603, 'f1-score': 0.837579608132299, 'support': 470967}}
[[ 15810  18219   6264]
 [ 12932 360563  16820]
 [  4015  16904  19440]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.35132238
{'0': {'precision': 0.47885256837891926, 'recall': 0.4661644369398623, 'f1-score': 0.47242332499670914, 'support': 7699}, '1': {'precision': 0.9494438232005179, 'recall': 0.9423133089112712, 'f1-score': 0.94586512769397, 'support': 119837}, '2': {'precision': 0.46058646448879476, 'recall': 0.5252383979656707, 'f1-score': 0.49079244386360943, 'support': 7865}, 'accuracy': 0.8910126217679337, 'macro avg': {'precision': 0.6296276186894106, 'recall': 0.6445720479389347, 'f1-score': 0.6363602988514295, 'support': 135401}, 'weighted avg': {'precision': 0.8942895392798734, 'recall': 0.8910126217679337, 'f1-score': 0.8925112004903896, 'support': 135401}}
[[  3589   3040   1070]
 [  3145 112924   3768]
 [   761   2973   4131]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.41364875
{'0': {'precision': 0.48078668683812403, 'recall': 0.41369435042957564, 'f1-score': 0.4447243212986286, 'support': 3841}, '1': {'precision': 0.9301644364556287, 'recall': 0.9262999712713531, 'f1-score': 0.9282281816772593, 'support': 45251}, '2': {'precision': 0.44654221467967753, 'recall': 0.5275689223057645, 'f1-score': 0.4836856617647059, 'support': 3990}, 'accuracy': 0.8592366527259712, 'macro avg': {'precision': 0.6191644459911435, 'recall': 0.6225210813355644, 'f1-score': 0.6188793882468645, 'support': 53082}, 'weighted avg': {'precision': 0.8612952792805624, 'recall': 0.8592366527259712, 'f1-score': 0.8598271609514876, 'support': 53082}}
[[ 1589  1636   616]
 [ 1342 41916  1993]
 [  374  1511  2105]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1380177
{'0': {'precision': 0.47780382057962556, 'recall': 0.5303365266519283, 'f1-score': 0.5027014727127443, 'support': 89562}, '1': {'precision': 0.3574992662166129, 'recall': 0.17576518464002772, 'f1-score': 0.23566515425619394, 'support': 69297}, '2': {'precision': 0.4447045414694021, 'recall': 0.5719778980604421, 'f1-score': 0.5003748643582914, 'support': 88680}, 'accuracy': 0.4459943685641454, 'macro avg': {'precision': 0.4266692094218802, 'recall': 0.4260265364507994, 'f1-score': 0.41291383044240987, 'support': 247539}, 'weighted avg': {'precision': 0.43226760699231886, 'recall': 0.4459943685641455, 'f1-score': 0.4271128204641837, 'support': 247539}}
[[47498 10141 31923]
 [25703 12180 31414]
 [26208 11749 50723]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1183411
{'0': {'precision': 0.4596167008898015, 'recall': 0.5007990624334114, 'f1-score': 0.47932493754142663, 'support': 18772}, '1': {'precision': 0.4854059928582518, 'recall': 0.33851234300563016, 'f1-score': 0.3988645786821458, 'support': 18472}, '2': {'precision': 0.45043394827511013, 'recall': 0.5429788128910152, 'f1-score': 0.4923957091775924, 'support': 19021}, 'accuracy': 0.46177908113391986, 'macro avg': {'precision': 0.4651522140077211, 'recall': 0.460763406110019, 'f1-score': 0.45686174180038824, 'support': 56265}, 'weighted avg': {'precision': 0.46497908716470016, 'recall': 0.46177908113391986, 'f1-score': 0.45732823263505273, 'support': 56265}}
[[ 9401  3265  6106]
 [ 5724  6253  6495]
 [ 5329  3364 10328]]
Evaluating performance on  val set...
79/79 - 1s - 724ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1279072
{'0': {'precision': 0.4732266599470833, 'recall': 0.533826037521319, 'f1-score': 0.5017030655179324, 'support': 7036}, '1': {'precision': 0.4237929946355317, 'recall': 0.21951618175874468, 'f1-score': 0.2892214924087434, 'support': 6118}, '2': {'precision': 0.44385866517106, 'recall': 0.5762341633901267, 'f1-score': 0.5014573564820681, 'support': 6867}, 'accuracy': 0.4523250586883772, 'macro avg': {'precision': 0.4469594399178917, 'recall': 0.4431921275567301, 'f1-score': 0.43079397146958137, 'support': 20021}, 'weighted avg': {'precision': 0.44804783848446783, 'recall': 0.4523250586883772, 'f1-score': 0.4366888530294804, 'support': 20021}}
[[3756  879 2401]
 [2218 1343 2557]
 [1963  947 3957]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1588/1588 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1956886
{'0': {'precision': 0.3673591604522835, 'recall': 0.18383160899036746, 'f1-score': 0.24504120637426705, 'support': 140150}, '1': {'precision': 0.2738912732474964, 'recall': 0.030293440508872838, 'f1-score': 0.05455309630495024, 'support': 126397}, '2': {'precision': 0.34592284269631535, 'recall': 0.7975368365309613, 'f1-score': 0.4825464590657961, 'support': 139739}, 'accuracy': 0.34714462226116577, 'macro avg': {'precision': 0.3290577587986984, 'recall': 0.33722062867673386, 'f1-score': 0.26071358724833776, 'support': 406286}, 'weighted avg': {'precision': 0.33090811329357095, 'recall': 0.34714462226116577, 'f1-score': 0.2674678242184215, 'support': 406286}}
[[ 25764   5132 109254]
 [ 21096   3829 101472]
 [ 23273   5019 111447]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1966347
{'0': {'precision': 0.38860780153419294, 'recall': 0.18290059917037949, 'f1-score': 0.2487333507443197, 'support': 26036}, '1': {'precision': 0.31217432496447184, 'recall': 0.026488202902045902, 'f1-score': 0.04883290107447203, 'support': 24879}, '2': {'precision': 0.3273292433537832, 'recall': 0.8141607324516785, 'f1-score': 0.4669311551925321, 'support': 24575}, 'accuracy': 0.33685256325341106, 'macro avg': {'precision': 0.342703789950816, 'recall': 0.3411831781747013, 'f1-score': 0.2548324690037746, 'support': 75490}, 'weighted avg': {'precision': 0.34346925297330194, 'recall': 0.33685256325341106, 'f1-score': 0.25388486428225426, 'support': 75490}}
[[ 4762   745 20529]
 [ 3632   659 20588]
 [ 3860   707 20008]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1965916
{'0': {'precision': 0.38344226579520696, 'recall': 0.1867704280155642, 'f1-score': 0.2511893434823977, 'support': 11308}, '1': {'precision': 0.31887456037514655, 'recall': 0.02361316086465839, 'f1-score': 0.04397025541545426, 'support': 11519}, '2': {'precision': 0.31771199940725375, 'recall': 0.8146670466419683, 'f1-score': 0.4571428571428572, 'support': 10527}, 'accuracy': 0.3285962703124063, 'macro avg': {'precision': 0.3400096085258691, 'recall': 0.34168354517406363, 'f1-score': 0.250767485346903, 'support': 33354}, 'weighted avg': {'precision': 0.3403980158401893, 'recall': 0.3285962703124063, 'f1-score': 0.24462689108869784, 'support': 33354}}
[[2112  309 8887]
 [1717  272 9530]
 [1679  272 8576]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
2104/2104 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0784388
{'0': {'precision': 0.5354438125043884, 'recall': 0.4855508154670402, 'f1-score': 0.509278252158565, 'support': 219874}, '1': {'precision': 0.3032832798328199, 'recall': 0.27775859517584967, 'f1-score': 0.28996029845673765, 'support': 101365}, '2': {'precision': 0.5047312465241272, 'recall': 0.5721279944046161, 'f1-score': 0.5363205604070197, 'support': 217322}, 'accuracy': 0.4813772256067558, 'macro avg': {'precision': 0.44781944628711184, 'recall': 0.445145801682502, 'f1-score': 0.44518637034077413, 'support': 538561}, 'weighted avg': {'precision': 0.47935458833439487, 'recall': 0.4813772256067558, 'f1-score': 0.47891163470239007, 'support': 538561}}
[[106760  32457  80657]
 [ 31862  28155  41348]
 [ 60764  32222 124336]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0996231
{'0': {'precision': 0.4830457899305556, 'recall': 0.49110565652665544, 'f1-score': 0.48704238064630834, 'support': 36259}, '1': {'precision': 0.5049559471365639, 'recall': 0.2789237916159717, 'f1-score': 0.3593516209476309, 'support': 36164}, '2': {'precision': 0.4377825046530178, 'recall': 0.6218068031615009, 'f1-score': 0.5138144329896908, 'support': 37071}, 'accuracy': 0.4652766361627121, 'macro avg': {'precision': 0.47526141390671245, 'recall': 0.463945417101376, 'f1-score': 0.4534028115278767, 'support': 109494}, 'weighted avg': {'precision': 0.47495770909210305, 'recall': 0.4652766361627121, 'f1-score': 0.4539324213670653, 'support': 109494}}
[[17807  4763 13689]
 [10163 10087 15914]
 [ 8894  5126 23051]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1060412
{'0': {'precision': 0.47201738725452147, 'recall': 0.49995889172079255, 'f1-score': 0.4855865208017248, 'support': 12163}, '1': {'precision': 0.4835394862036156, 'recall': 0.22446996466431096, 'f1-score': 0.30660633484162897, 'support': 11320}, '2': {'precision': 0.439943741209564, 'recall': 0.6291230893000804, 'f1-score': 0.5177950670418804, 'support': 12430}, 'accuracy': 0.45782864143903323, 'macro avg': {'precision': 0.4651668715559003, 'recall': 0.4511839818950613, 'f1-score': 0.436662640895078, 'support': 35913}, 'weighted avg': {'precision': 0.46454807919796604, 'recall': 0.45782864143903323, 'f1-score': 0.4403186936833234, 'support': 35913}}
[[6081 1354 4728]
 [3552 2541 5227]
 [3250 1360 7820]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
5267/5267 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5107358
{'0': {'precision': 0.5382983237852748, 'recall': 0.3686842331243766, 'f1-score': 0.4376315799790648, 'support': 151387}, '1': {'precision': 0.8684491250368823, 'recall': 0.9140130674988486, 'f1-score': 0.8906487352895033, 'support': 1046566}, '2': {'precision': 0.46487401068322287, 'recall': 0.4425703559732687, 'f1-score': 0.4534480877298271, 'support': 150236}, 'accuracy': 0.8002431409839421, 'macro avg': {'precision': 0.6238738198351266, 'recall': 0.575089218865498, 'f1-score': 0.5939094676661317, 'support': 1348189}, 'weighted avg': {'precision': 0.7864042112828661, 'recall': 0.8002431409839421, 'f1-score': 0.7910601875578744, 'support': 1348189}}
[[ 55814  73529  22044]
 [ 35497 956575  54494]
 [ 12375  71371  66490]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.41748267
{'0': {'precision': 0.5088327179778472, 'recall': 0.40721883807618875, 'f1-score': 0.45238997045678364, 'support': 21998}, '1': {'precision': 0.9141632014385379, 'recall': 0.9324127714731635, 'f1-score': 0.9231978068988396, 'support': 226818}, '2': {'precision': 0.4882126210111151, 'recall': 0.48527642892145945, 'f1-score': 0.48674009696373916, 'support': 22447}, 'accuracy': 0.8528218002455182, 'macro avg': {'precision': 0.6370695134758334, 'recall': 0.6083026794902705, 'f1-score': 0.6207759581064541, 'support': 271263}, 'weighted avg': {'precision': 0.8460456452144209, 'recall': 0.8528218002455182, 'f1-score': 0.8489009178982552, 'support': 271263}}
[[  8958  10251   2789]
 [  6700 211488   8630]
 [  1947   9607  10893]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40968433
{'0': {'precision': 0.5318210459987398, 'recall': 0.4223167375531649, 'f1-score': 0.47078510667968204, 'support': 7994}, '1': {'precision': 0.9194039578814883, 'recall': 0.9363662374821173, 'f1-score': 0.9278075775960809, 'support': 87375}, '2': {'precision': 0.4693346549374303, 'recall': 0.4713201443324624, 'f1-score': 0.47032530419667246, 'support': 8037}, 'accuracy': 0.8604819836373131, 'macro avg': {'precision': 0.6401865529392196, 'recall': 0.6100010397892482, 'f1-score': 0.6229726628241451, 'support': 103406}, 'weighted avg': {'precision': 0.8544604847237208, 'recall': 0.8604819836373131, 'f1-score': 0.8569197890362609, 'support': 103406}}
[[ 3376  3642   976]
 [ 2253 81815  3307]
 [  719  3530  3788]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
10110/10110 - 87s - 87s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53293204
{'0': {'precision': 0.5522776018792769, 'recall': 0.3721571258968668, 'f1-score': 0.444669675071698, 'support': 290595}, '1': {'precision': 0.8684917263022194, 'recall': 0.9218258724356285, 'f1-score': 0.8943643785505772, 'support': 2002440}, '2': {'precision': 0.49290106455928145, 'recall': 0.44580195617251733, 'f1-score': 0.4681699194037766, 'support': 295066}, 'accuracy': 0.8058375619807727, 'macro avg': {'precision': 0.6378901309135926, 'recall': 0.5799283181683376, 'f1-score': 0.6024013243420172, 'support': 2588101}, 'weighted avg': {'precision': 0.7901662368083678, 'recall': 0.8058375619807727, 'f1-score': 0.7952822613379743, 'support': 2588101}}
[[ 108147  140087   42361]
 [  63570 1845901   92969]
 [  24103  139422  131541]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49543485
{'0': {'precision': 0.5290577141710694, 'recall': 0.3710948494230228, 'f1-score': 0.4362162609247057, 'support': 42636}, '1': {'precision': 0.8905745075350964, 'recall': 0.9221772470580083, 'f1-score': 0.9061004029678632, 'support': 346364}, '2': {'precision': 0.47122561443485944, 'recall': 0.4760853223078369, 'f1-score': 0.47364300321355535, 'support': 42568}, 'accuracy': 0.8237334556779001, 'macro avg': {'precision': 0.6302859453803418, 'recall': 0.5897858062629561, 'f1-score': 0.6053198890353748, 'support': 431568}, 'weighted avg': {'precision': 0.8134963328711742, 'recall': 0.8237334556779001, 'f1-score': 0.8170233006968575, 'support': 431568}}
[[ 15822  20169   6645]
 [ 10859 319409  16096]
 [  3225  19077  20266]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5788156
{'0': {'precision': 0.49191830597669467, 'recall': 0.3699236785074908, 'f1-score': 0.4222867591696246, 'support': 21226}, '1': {'precision': 0.871536523929471, 'recall': 0.8906665888821638, 'f1-score': 0.8809977206497591, 'support': 137131}, '2': {'precision': 0.44202212990004525, 'recall': 0.4871922745613637, 'f1-score': 0.4635093167701863, 'support': 22057}, 'accuracy': 0.7800724999168579, 'macro avg': {'precision': 0.601825653268737, 'recall': 0.5825941806503394, 'f1-score': 0.5889312655298566, 'support': 180414}, 'weighted avg': {'precision': 0.7743623839881545, 'recall': 0.7800724999168579, 'f1-score': 0.7759884608764097, 'support': 180414}}
[[  7852   8972   4402]
 [  5830 122138   9163]
 [  2280   9031  10746]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
6546/6546 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7829146
{'0': {'precision': 0.47021236052592574, 'recall': 0.3595055637033512, 'f1-score': 0.4074733226672929, 'support': 308877}, '1': {'precision': 0.7525225438603655, 'recall': 0.7814491901407123, 'f1-score': 0.7667131270124148, 'support': 1061172}, '2': {'precision': 0.4157369591678982, 'recall': 0.459158707313882, 'f1-score': 0.4363703057800242, 'support': 305720}, 'accuracy': 0.644879455342592, 'macro avg': {'precision': 0.5461572878513965, 'recall': 0.5333711537193152, 'f1-score': 0.5368522518199107, 'support': 1675769}, 'weighted avg': {'precision': 0.6390455601890046, 'recall': 0.644879455342592, 'f1-score': 0.6402318993766997, 'support': 1675769}}
[[111043 139042  58792]
 [ 93435 829252 138485]
 [ 31677 133669 140374]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78907657
{'0': {'precision': 0.5036579839005546, 'recall': 0.37419830682401234, 'f1-score': 0.4293822731245113, 'support': 62368}, '1': {'precision': 0.7538160767785508, 'recall': 0.7779122779437195, 'f1-score': 0.7656746441097586, 'support': 190830}, '2': {'precision': 0.42659748542019216, 'recall': 0.4954037549535503, 'f1-score': 0.45843321435280854, 'support': 61572}, 'accuracy': 0.6426597197954061, 'macro avg': {'precision': 0.5613571820330993, 'recall': 0.5491714465737608, 'f1-score': 0.5511633771956929, 'support': 314770}, 'weighted avg': {'precision': 0.6402431090760006, 'recall': 0.6426597197954061, 'f1-score': 0.6389428974166086, 'support': 314770}}
[[ 23338  24439  14591]
 [ 15972 148449  26409]
 [  7027  24042  30503]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70133567
{'0': {'precision': 0.4965545755237045, 'recall': 0.3697470367899841, 'f1-score': 0.42386988617981824, 'support': 19489}, '1': {'precision': 0.789266420962286, 'recall': 0.8327606871753895, 'f1-score': 0.8104304099327363, 'support': 75090}, '2': {'precision': 0.4512541890931248, 'recall': 0.4713338636966322, 'f1-score': 0.4610755142805261, 'support': 18855}, 'accuracy': 0.6931343336213128, 'macro avg': {'precision': 0.5790250618597051, 'recall': 0.5579471958873353, 'f1-score': 0.5651252701310269, 'support': 113434}, 'weighted avg': {'precision': 0.6827914506037908, 'recall': 0.6931343336213128, 'f1-score': 0.6859459995712659, 'support': 113434}}
[[ 7206  8615  3668]
 [ 5419 62532  7139]
 [ 1887  8081  8887]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
7633/7633 - 61s - 61s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8437154
{'0': {'precision': 0.5133668778691133, 'recall': 0.382916271068538, 'f1-score': 0.4386482793896932, 'support': 425516}, '1': {'precision': 0.7122502756134198, 'recall': 0.7622163443982012, 'f1-score': 0.7363866960520182, 'support': 1103583}, '2': {'precision': 0.45107408521127224, 'recall': 0.4836745597085356, 'f1-score': 0.46680583223356187, 'support': 424889}, 'accuracy': 0.6190488375568325, 'macro avg': {'precision': 0.5588970795646018, 'recall': 0.5429357250584249, 'f1-score': 0.5472802692250912, 'support': 1953988}, 'weighted avg': {'precision': 0.612147839857241, 'recall': 0.6190488375568325, 'f1-score': 0.6129292317526234, 'support': 1953988}}
[[162937 173477  89102]
 [101427 841169 160987]
 [ 53025 166356 205508]]
Evaluating performance on  train set...
1586/1586 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81548923
{'0': {'precision': 0.5041643696827928, 'recall': 0.4063209212406489, 'f1-score': 0.44998537195138166, 'support': 83279}, '1': {'precision': 0.7402131858804527, 'recall': 0.7527876134006579, 'f1-score': 0.7464474471479857, 'support': 238645}, '2': {'precision': 0.44110233924219383, 'recall': 0.5047553214311253, 'f1-score': 0.4707870164517564, 'support': 83906}, 'accuracy': 0.6304092846758494, 'macro avg': {'precision': 0.5618266316018131, 'recall': 0.5546212853574773, 'f1-score': 0.555739945183708, 'support': 405830}, 'weighted avg': {'precision': 0.6299327628901498, 'recall': 0.6304092846758494, 'f1-score': 0.6286182347726171, 'support': 405830}}
[[ 33838  31400  18041]
 [ 23375 179649  35621]
 [  9904  31650  42352]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78613955
{'0': {'precision': 0.48789209251799215, 'recall': 0.3933367391621661, 'f1-score': 0.4355415479726044, 'support': 27404}, '1': {'precision': 0.7723418061398013, 'recall': 0.7543407235814111, 'f1-score': 0.7632351396620252, 'support': 91517}, '2': {'precision': 0.41728346234250524, 'recall': 0.5284038062531301, 'f1-score': 0.4663151913120343, 'support': 27954}, 'accuracy': 0.6439829787234043, 'macro avg': {'precision': 0.5591724536667663, 'recall': 0.5586937563322358, 'f1-score': 0.5550306263155546, 'support': 146875}, 'weighted avg': {'precision': 0.6516925404744283, 'recall': 0.6439829787234043, 'f1-score': 0.645582609123591, 'support': 146875}}
[[10779 10308  6317]
 [ 8172 69035 14310]
 [ 3142 10041 14771]]
testing model on single stock: results/universal/W10/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
22048/22048 - 221s - 221s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0857483
{'0': {'precision': 0.46818991035240576, 'recall': 0.557482684254899, 'f1-score': 0.5089494821966081, 'support': 2146890}, '1': {'precision': 0.2715480302282702, 'recall': 0.03170420926324439, 'f1-score': 0.05677923823292845, 'support': 1319257}, '2': {'precision': 0.4616816256075525, 'recall': 0.6218930806030154, 'f1-score': 0.529943356487124, 'support': 2177921}, 'accuracy': 0.45944060206220055, 'macro avg': {'precision': 0.40047318872940946, 'recall': 0.4036933247070529, 'f1-score': 0.36522402563888684, 'support': 5644068}, 'weighted avg': {'precision': 0.4197149970688092, 'recall': 0.45944060206220055, 'f1-score': 0.41135927600984395, 'support': 5644068}}
[[1196854   56152  893884]
 [ 592052   41826  685379]
 [ 767437   56050 1354434]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1373222
{'0': {'precision': 0.43260647600562074, 'recall': 0.556614674225262, 'f1-score': 0.48683777667593536, 'support': 461285}, '1': {'precision': 0.42140814350733896, 'recall': 0.08227329708027453, 'f1-score': 0.13766890970760487, 'support': 460283}, '2': {'precision': 0.41412815906706923, 'recall': 0.6247981752479561, 'f1-score': 0.4981036856178919, 'support': 468228}, 'accuracy': 0.4224900632898641, 'macro avg': {'precision': 0.42271425952667635, 'recall': 0.4212287155178309, 'f1-score': 0.3742034573338107, 'support': 1389796}, 'weighted avg': {'precision': 0.42267230763788133, 'recall': 0.4224900632898641, 'f1-score': 0.37499295946340233, 'support': 1389796}}
[[256758  26086 178441]
 [186984  37869 235430]
 [149772  25908 292548]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1584057
{'0': {'precision': 0.4227849115567219, 'recall': 0.5514691472544127, 'f1-score': 0.47862840814382657, 'support': 153082}, '1': {'precision': 0.4269316835592997, 'recall': 0.09289470367866921, 'f1-score': 0.1525882225640881, 'support': 174574}, '2': {'precision': 0.40012032226856253, 'recall': 0.6309298703296562, 'f1-score': 0.4896907344714278, 'support': 156011}, 'accuracy': 0.41158276252049447, 'macro avg': {'precision': 0.41661230579486136, 'recall': 0.42509790708757933, 'f1-score': 0.3736357883931141, 'support': 483667}, 'weighted avg': {'precision': 0.41697098035228375, 'recall': 0.41158276252049447, 'f1-score': 0.36451623021003765, 'support': 483667}}
[[84420 10824 57838]
 [68621 16217 89736]
 [46635 10944 98432]]
training model: results/universal/W10/deepVOL_L2/h20
Epoch 1/50
8543/8543 - 285s - loss: 2.9235 - accuracy20: 0.4866 - val_loss: 3.1647 - val_accuracy20: 0.4726 - 285s/epoch - 33ms/step
Epoch 2/50
8543/8543 - 277s - loss: 2.8661 - accuracy20: 0.5037 - val_loss: 3.1291 - val_accuracy20: 0.4798 - 277s/epoch - 32ms/step
Epoch 3/50
8543/8543 - 279s - loss: 2.8395 - accuracy20: 0.5116 - val_loss: 3.1046 - val_accuracy20: 0.4867 - 279s/epoch - 33ms/step
Epoch 4/50
8543/8543 - 279s - loss: 2.8239 - accuracy20: 0.5157 - val_loss: 3.1480 - val_accuracy20: 0.4930 - 279s/epoch - 33ms/step
Epoch 5/50
8543/8543 - 277s - loss: 2.8131 - accuracy20: 0.5188 - val_loss: 3.1131 - val_accuracy20: 0.4995 - 277s/epoch - 32ms/step
Epoch 6/50
8543/8543 - 274s - loss: 2.8059 - accuracy20: 0.5204 - val_loss: 3.1406 - val_accuracy20: 0.5005 - 274s/epoch - 32ms/step
Epoch 7/50
8543/8543 - 276s - loss: 2.7990 - accuracy20: 0.5222 - val_loss: 3.1611 - val_accuracy20: 0.5013 - 276s/epoch - 32ms/step
Epoch 8/50
8543/8543 - 278s - loss: 2.7933 - accuracy20: 0.5232 - val_loss: 3.0908 - val_accuracy20: 0.5044 - 278s/epoch - 33ms/step
Epoch 9/50
8543/8543 - 278s - loss: 2.7881 - accuracy20: 0.5244 - val_loss: 3.0646 - val_accuracy20: 0.5070 - 278s/epoch - 33ms/step
Epoch 10/50
8543/8543 - 277s - loss: 2.7836 - accuracy20: 0.5251 - val_loss: 3.0560 - val_accuracy20: 0.5063 - 277s/epoch - 32ms/step
Epoch 11/50
8543/8543 - 275s - loss: 2.7800 - accuracy20: 0.5262 - val_loss: 3.0780 - val_accuracy20: 0.5064 - 275s/epoch - 32ms/step
Epoch 12/50
8543/8543 - 273s - loss: 2.7755 - accuracy20: 0.5270 - val_loss: 3.0420 - val_accuracy20: 0.5063 - 273s/epoch - 32ms/step
Epoch 13/50
8543/8543 - 276s - loss: 2.7726 - accuracy20: 0.5276 - val_loss: 3.0221 - val_accuracy20: 0.5075 - 276s/epoch - 32ms/step
Epoch 14/50
8543/8543 - 277s - loss: 2.7698 - accuracy20: 0.5284 - val_loss: 3.0358 - val_accuracy20: 0.5066 - 277s/epoch - 32ms/step
Epoch 15/50
8543/8543 - 282s - loss: 2.7666 - accuracy20: 0.5290 - val_loss: 3.0373 - val_accuracy20: 0.5073 - 282s/epoch - 33ms/step
Epoch 16/50
8543/8543 - 276s - loss: 2.7639 - accuracy20: 0.5297 - val_loss: 3.0491 - val_accuracy20: 0.5070 - 276s/epoch - 32ms/step
Epoch 17/50
8543/8543 - 274s - loss: 2.7613 - accuracy20: 0.5302 - val_loss: 3.0211 - val_accuracy20: 0.5080 - 274s/epoch - 32ms/step
Epoch 18/50
8543/8543 - 279s - loss: 2.7594 - accuracy20: 0.5306 - val_loss: 3.0296 - val_accuracy20: 0.5076 - 279s/epoch - 33ms/step
Epoch 19/50
8543/8543 - 278s - loss: 2.7573 - accuracy20: 0.5310 - val_loss: 3.0233 - val_accuracy20: 0.5076 - 278s/epoch - 33ms/step
Epoch 20/50
8543/8543 - 284s - loss: 2.7550 - accuracy20: 0.5316 - val_loss: 3.0266 - val_accuracy20: 0.5067 - 284s/epoch - 33ms/step
Epoch 21/50
8543/8543 - 275s - loss: 2.7528 - accuracy20: 0.5320 - val_loss: 3.0369 - val_accuracy20: 0.5072 - 275s/epoch - 32ms/step
Epoch 22/50
8543/8543 - 280s - loss: 2.7511 - accuracy20: 0.5325 - val_loss: 3.0411 - val_accuracy20: 0.5081 - 280s/epoch - 33ms/step
Epoch 23/50
8543/8543 - 280s - loss: 2.7494 - accuracy20: 0.5328 - val_loss: 3.0194 - val_accuracy20: 0.5075 - 280s/epoch - 33ms/step
Epoch 24/50
8543/8543 - 275s - loss: 2.7474 - accuracy20: 0.5333 - val_loss: 3.0279 - val_accuracy20: 0.5066 - 275s/epoch - 32ms/step
Epoch 25/50
8543/8543 - 284s - loss: 2.7458 - accuracy20: 0.5338 - val_loss: 3.0326 - val_accuracy20: 0.5083 - 284s/epoch - 33ms/step
Epoch 26/50
8543/8543 - 281s - loss: 2.7443 - accuracy20: 0.5341 - val_loss: 3.0269 - val_accuracy20: 0.5087 - 281s/epoch - 33ms/step
Epoch 27/50
8543/8543 - 276s - loss: 2.7425 - accuracy20: 0.5345 - val_loss: 3.0045 - val_accuracy20: 0.5088 - 276s/epoch - 32ms/step
Epoch 28/50
8543/8543 - 278s - loss: 2.7412 - accuracy20: 0.5348 - val_loss: 3.0156 - val_accuracy20: 0.5065 - 278s/epoch - 33ms/step
Epoch 29/50
8543/8543 - 280s - loss: 2.7395 - accuracy20: 0.5352 - val_loss: 3.0140 - val_accuracy20: 0.5080 - 280s/epoch - 33ms/step
Epoch 30/50
8543/8543 - 277s - loss: 2.7384 - accuracy20: 0.5355 - val_loss: 3.0078 - val_accuracy20: 0.5083 - 277s/epoch - 32ms/step
Epoch 31/50
8543/8543 - 277s - loss: 2.7369 - accuracy20: 0.5359 - val_loss: 3.0107 - val_accuracy20: 0.5066 - 277s/epoch - 32ms/step
Epoch 32/50
8543/8543 - 275s - loss: 2.7356 - accuracy20: 0.5361 - val_loss: 3.0128 - val_accuracy20: 0.5082 - 275s/epoch - 32ms/step
Epoch 33/50
8543/8543 - 277s - loss: 2.7341 - accuracy20: 0.5367 - val_loss: 3.0109 - val_accuracy20: 0.5094 - 277s/epoch - 32ms/step
Epoch 34/50
8543/8543 - 277s - loss: 2.7326 - accuracy20: 0.5370 - val_loss: 3.0177 - val_accuracy20: 0.5080 - 277s/epoch - 32ms/step
Epoch 35/50
8543/8543 - 275s - loss: 2.7318 - accuracy20: 0.5370 - val_loss: 3.0073 - val_accuracy20: 0.5072 - 275s/epoch - 32ms/step
Epoch 36/50
8543/8543 - 275s - loss: 2.7304 - accuracy20: 0.5375 - val_loss: 3.0041 - val_accuracy20: 0.5070 - 275s/epoch - 32ms/step
Epoch 37/50
8543/8543 - 276s - loss: 2.7295 - accuracy20: 0.5376 - val_loss: 3.0021 - val_accuracy20: 0.5070 - 276s/epoch - 32ms/step
Epoch 38/50
8543/8543 - 272s - loss: 2.7278 - accuracy20: 0.5381 - val_loss: 3.0116 - val_accuracy20: 0.5047 - 272s/epoch - 32ms/step
Epoch 39/50
8543/8543 - 275s - loss: 2.7270 - accuracy20: 0.5384 - val_loss: 3.0005 - val_accuracy20: 0.5070 - 275s/epoch - 32ms/step
Epoch 40/50
8543/8543 - 276s - loss: 2.7260 - accuracy20: 0.5386 - val_loss: 2.9996 - val_accuracy20: 0.5069 - 276s/epoch - 32ms/step
Epoch 41/50
8543/8543 - 276s - loss: 2.7248 - accuracy20: 0.5390 - val_loss: 3.0040 - val_accuracy20: 0.5052 - 276s/epoch - 32ms/step
Epoch 42/50
8543/8543 - 275s - loss: 2.7242 - accuracy20: 0.5388 - val_loss: 2.9905 - val_accuracy20: 0.5067 - 275s/epoch - 32ms/step
Epoch 43/50
8543/8543 - 273s - loss: 2.7231 - accuracy20: 0.5390 - val_loss: 2.9999 - val_accuracy20: 0.5062 - 273s/epoch - 32ms/step
Epoch 44/50
8543/8543 - 275s - loss: 2.7223 - accuracy20: 0.5393 - val_loss: 3.0002 - val_accuracy20: 0.5056 - 275s/epoch - 32ms/step
Epoch 45/50
8543/8543 - 274s - loss: 2.7211 - accuracy20: 0.5396 - val_loss: 2.9951 - val_accuracy20: 0.5065 - 274s/epoch - 32ms/step
Epoch 46/50
8543/8543 - 275s - loss: 2.7204 - accuracy20: 0.5398 - val_loss: 2.9999 - val_accuracy20: 0.5049 - 275s/epoch - 32ms/step
Epoch 47/50
8543/8543 - 276s - loss: 2.7189 - accuracy20: 0.5403 - val_loss: 2.9898 - val_accuracy20: 0.5063 - 276s/epoch - 32ms/step
Epoch 48/50
8543/8543 - 274s - loss: 2.7185 - accuracy20: 0.5407 - val_loss: 2.9858 - val_accuracy20: 0.5082 - 274s/epoch - 32ms/step
Epoch 49/50
8543/8543 - 277s - loss: 2.7169 - accuracy20: 0.5407 - val_loss: 2.9937 - val_accuracy20: 0.5046 - 277s/epoch - 32ms/step
Epoch 50/50
8543/8543 - 279s - loss: 2.7162 - accuracy20: 0.5410 - val_loss: 3.0040 - val_accuracy20: 0.5061 - 279s/epoch - 33ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 572s - 572s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0145955
{'0': {'precision': 0.43916783195314857, 'recall': 0.5082850757166186, 'f1-score': 0.47120538215586566, 'support': 2870704}, '1': {'precision': 0.7227085039989014, 'recall': 0.48743802180780704, 'f1-score': 0.5822032225363288, 'support': 3757370}, '2': {'precision': 0.4401817392650453, 'recall': 0.5565759005623534, 'f1-score': 0.49158298497710945, 'support': 2917205}, 'accuracy': 0.5148374395342451, 'macro avg': {'precision': 0.5340193584056985, 'recall': 0.5174329993622596, 'f1-score': 0.5149971965564346, 'support': 9545279}, 'weighted avg': {'precision': 0.5510896511482032, 'recall': 0.5148374395342451, 'f1-score': 0.5211259345408181, 'support': 9545279}}
[[1459136  373201 1038367]
 [ 899317 1831485 1026568]
 [ 964049  329510 1623646]]
Evaluating performance on  train set...
8543/8543 - 136s - 136s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0420525
{'0': {'precision': 0.41651899730387054, 'recall': 0.541543438077634, 'f1-score': 0.47087354956102967, 'support': 605920}, '1': {'precision': 0.767855092021017, 'recall': 0.4436028724949383, 'f1-score': 0.5623351935557847, 'support': 964597}, '2': {'precision': 0.41954589739324666, 'recall': 0.5730497904099785, 'f1-score': 0.4844282350261993, 'support': 616203}, 'accuracy': 0.507218573937221, 'macro avg': {'precision': 0.5346399955727114, 'recall': 0.519398700327517, 'f1-score': 0.5058789927143379, 'support': 2186720}, 'weighted avg': {'precision': 0.5723519013206854, 'recall': 0.507218573937221, 'f1-score': 0.5150383558737275, 'support': 2186720}}
[[328132  68424 209364]
 [257518 427898 279181]
 [202146  60942 353115]]
Evaluating performance on  val set...
3077/3077 - 47s - 47s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0457381
{'0': {'precision': 0.40588944567970886, 'recall': 0.5344065871112449, 'f1-score': 0.46136532718604284, 'support': 205978}, '1': {'precision': 0.7712677468608281, 'recall': 0.4559711144643242, 'f1-score': 0.5731171415266076, 'support': 371120}, '2': {'precision': 0.40569816528931196, 'recall': 0.5729228716433558, 'f1-score': 0.47502301525526186, 'support': 209845}, 'accuracy': 0.5076873420311255, 'macro avg': {'precision': 0.5276184526099497, 'recall': 0.5211001910729749, 'f1-score': 0.5031684946559708, 'support': 786943}, 'weighted avg': {'precision': 0.5781497693636531, 'recall': 0.5076873420311255, 'f1-score': 0.5177090914624335, 'support': 786943}}
[[110076  26525  69377]
 [ 95161 169220 106739]
 [ 65960  23660 120225]]
testing model out of sample: results/universal/W10/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 334s - 334s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8220751
{'0': {'precision': 0.5285094370323727, 'recall': 0.4319841787617347, 'f1-score': 0.47539663225246587, 'support': 1270697}, '1': {'precision': 0.7439953400504609, 'recall': 0.7722314648738392, 'f1-score': 0.7578504870650431, 'support': 2924245}, '2': {'precision': 0.4810671169586258, 'recall': 0.527087182833448, 'f1-score': 0.503026791600903, 'support': 1265857}, 'accuracy': 0.6362314379269407, 'macro avg': {'precision': 0.5845239646804865, 'recall': 0.5771009421563407, 'f1-score': 0.5787579703061373, 'support': 5460799}, 'weighted avg': {'precision': 0.6329041202114344, 'recall': 0.6362314379269407, 'f1-score': 0.6330548986139891, 'support': 5460799}}
[[ 548921  404867  316909]
 [ 263225 2258194  402826]
 [ 226475  372165  667217]]
Evaluating performance on  train set...
4055/4055 - 69s - 69s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8227628
{'0': {'precision': 0.5022653157147495, 'recall': 0.4547205320441674, 'f1-score': 0.477311868558956, 'support': 227951}, '1': {'precision': 0.7647396855013497, 'recall': 0.7451159302327591, 'f1-score': 0.7548002818417746, 'support': 578667}, '2': {'precision': 0.4694394456936125, 'recall': 0.5435108419748594, 'f1-score': 0.5037669301075377, 'support': 230862}, 'accuracy': 0.6364498592743957, 'macro avg': {'precision': 0.5788148156365707, 'recall': 0.5811157680839286, 'f1-score': 0.5786263601694227, 'support': 1037480}, 'weighted avg': {'precision': 0.6413590911479943, 'recall': 0.6364498592743957, 'f1-score': 0.6379712124194231, 'support': 1037480}}
[[103654  68898  55399]
 [ 61079 431174  86414]
 [ 41640  63746 125476]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82772833
{'0': {'precision': 0.4887253169031867, 'recall': 0.45353782703956697, 'f1-score': 0.4704745583489818, 'support': 85349}, '1': {'precision': 0.7690092435636888, 'recall': 0.740653046497993, 'f1-score': 0.7545648358313193, 'support': 221730}, '2': {'precision': 0.4661810919557109, 'recall': 0.5421970714822489, 'f1-score': 0.5013238723397535, 'support': 87826}, 'accuracy': 0.6344639850090528, 'macro avg': {'precision': 0.5746385508075288, 'recall': 0.5787959816732696, 'f1-score': 0.5754544221733515, 'support': 394905}, 'weighted avg': {'precision': 0.641084456337218, 'recall': 0.6344639850090528, 'f1-score': 0.6368454806637466, 'support': 394905}}
[[ 38709  25772  20868]
 [ 23845 164225  33660]
 [ 16650  23557  47619]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.077657
{'0': {'precision': 0.5241342036336424, 'recall': 0.47146596858638745, 'f1-score': 0.49640698521449805, 'support': 53480}, '1': {'precision': 0.3990185950413223, 'recall': 0.25892408245349424, 'f1-score': 0.31405630653521704, 'support': 29835}, '2': {'precision': 0.45975070612796265, 'recall': 0.6075666903337053, 'f1-score': 0.5234229589562998, 'support': 49295}, 'accuracy': 0.474240253374557, 'macro avg': {'precision': 0.4609678349343091, 'recall': 0.44598558045786235, 'f1-score': 0.44462875023533827, 'support': 132610}, 'weighted avg': {'precision': 0.4720520929942159, 'recall': 0.474240253374557, 'f1-score': 0.4654238008936004, 'support': 132610}}
[[25214  6033 22233]
 [ 9149  7725 12961]
 [13743  5602 29950]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.087804
{'0': {'precision': 0.47936454568378584, 'recall': 0.4993433149461518, 'f1-score': 0.4891500128655974, 'support': 11421}, '1': {'precision': 0.5283657917019475, 'recall': 0.32787459497329013, 'f1-score': 0.40464739259659555, 'support': 11419}, '2': {'precision': 0.44765319426336375, 'recall': 0.5980144561525733, 'f1-score': 0.5120232636170451, 'support': 11483}, 'accuracy': 0.475308102438598, 'macro avg': {'precision': 0.4851278438830324, 'recall': 0.4750774553573384, 'f1-score': 0.46860688969307934, 'support': 34323}, 'weighted avg': {'precision': 0.485057631367458, 'recall': 0.475308102438598, 'f1-score': 0.4686890425986377, 'support': 34323}}
[[5703 1655 4063]
 [3265 3744 4410]
 [2929 1687 6867]]
Evaluating performance on  val set...
46/46 - 0s - 479ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0726451
{'0': {'precision': 0.4786407766990291, 'recall': 0.4934934934934935, 'f1-score': 0.4859536717594874, 'support': 3996}, '1': {'precision': 0.5208820581356498, 'recall': 0.4150692225772098, 'f1-score': 0.4619943695362276, 'support': 3756}, '2': {'precision': 0.4729700153206391, 'recall': 0.5498727735368957, 'f1-score': 0.5085304153429816, 'support': 3930}, 'accuracy': 0.48724533470296183, 'macro avg': {'precision': 0.4908309500517727, 'recall': 0.48614516320253304, 'f1-score': 0.4854928188795655, 'support': 11682}, 'weighted avg': {'precision': 0.4903144764815043, 'recall': 0.48724533470296183, 'f1-score': 0.4858454251521058, 'support': 11682}}
[[1972  756 1268]
 [1057 1559 1140]
 [1091  678 2161]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.58887196
{'0': {'precision': 0.504166578764161, 'recall': 0.42949570468351245, 'f1-score': 0.46384519084265785, 'support': 55642}, '1': {'precision': 0.8727119760445898, 'recall': 0.8763474776219364, 'f1-score': 0.8745259485535452, 'support': 359839}, '2': {'precision': 0.46385871311949606, 'recall': 0.5202213170889954, 'f1-score': 0.4904259476357952, 'support': 55486}, 'accuracy': 0.7815982860794918, 'macro avg': {'precision': 0.6135790893094156, 'recall': 0.6086881664648147, 'f1-score': 0.6095990290106661, 'support': 470967}, 'weighted avg': {'precision': 0.7810022912001328, 'recall': 0.7815982860794918, 'f1-score': 0.7807544712069976, 'support': 470967}}
[[ 23898  24579   7165]
 [ 18297 315344  26198]
 [  5206  21415  28865]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.47317618
{'0': {'precision': 0.5222611305652827, 'recall': 0.4912478825522304, 'f1-score': 0.5062800058193104, 'support': 10626}, '1': {'precision': 0.9261248498108064, 'recall': 0.9070128912150058, 'f1-score': 0.916469241621636, 'support': 113876}, '2': {'precision': 0.4494236311239193, 'recall': 0.5723460867969539, 'f1-score': 0.5034908591952864, 'support': 10899}, 'accuracy': 0.8474457352604486, 'macro avg': {'precision': 0.6326032038333361, 'recall': 0.6568689535213966, 'f1-score': 0.6420800355454109, 'support': 135401}, 'weighted avg': {'precision': 0.8560587316641805, 'recall': 0.8474457352604486, 'f1-score': 0.8510360305692782, 'support': 135401}}
[[  5220   4366   1040]
 [  3987 103287   6602]
 [   788   3873   6238]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5337028
{'0': {'precision': 0.5383003492433062, 'recall': 0.43279670535380005, 'f1-score': 0.4798173705510013, 'support': 5342}, '1': {'precision': 0.8959100693613968, 'recall': 0.8881986104853816, 'f1-score': 0.8920376742912257, 'support': 42173}, '2': {'precision': 0.45950981797334095, 'recall': 0.5758936590623316, 'f1-score': 0.5111607142857142, 'support': 5567}, 'accuracy': 0.8096153121585472, 'macro avg': {'precision': 0.6312400788593481, 'recall': 0.632296324967171, 'f1-score': 0.6276719197093138, 'support': 53082}, 'weighted avg': {'precision': 0.8141537051635869, 'recall': 0.8096153121585472, 'f1-score': 0.8106085099995457, 'support': 53082}}
[[ 2312  2373   657]
 [ 1601 37458  3114]
 [  382  1979  3206]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2259282
{'0': {'precision': 0.4293894062124425, 'recall': 0.5023089408591089, 'f1-score': 0.46299564344752386, 'support': 87486}, '1': {'precision': 0.3294675803900896, 'recall': 0.09989876924716287, 'f1-score': 0.1533115290269828, 'support': 75076}, '2': {'precision': 0.40462460794563515, 'recall': 0.5829695093966603, 'f1-score': 0.47769383199379006, 'support': 84977}, 'accuracy': 0.40795187828988566, 'macro avg': {'precision': 0.3878271981827224, 'recall': 0.39505907316764405, 'f1-score': 0.3646670014894322, 'support': 247539}, 'weighted avg': {'precision': 0.3905827161241838, 'recall': 0.40795187828988566, 'f1-score': 0.37411737939159534, 'support': 247539}}
[[43945  7690 35851]
 [30534  7500 37042]
 [27864  7574 49539]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1899816
{'0': {'precision': 0.42291760468257544, 'recall': 0.5042950714055621, 'f1-score': 0.4600352630032324, 'support': 18626}, '1': {'precision': 0.4421436004162331, 'recall': 0.22932858376511225, 'f1-score': 0.3020115146776601, 'support': 18528}, '2': {'precision': 0.4257721415422377, 'recall': 0.544607817487311, 'f1-score': 0.47791349067866656, 'support': 19111}, 'accuracy': 0.4274415711365858, 'macro avg': {'precision': 0.43027778221368207, 'recall': 0.4260771575526618, 'f1-score': 0.4133200894531863, 'support': 56265}, 'weighted avg': {'precision': 0.43021827655457784, 'recall': 0.4274415711365858, 'f1-score': 0.41407075220840467, 'support': 56265}}
[[ 9393  2707  6526]
 [ 6768  4249  7511]
 [ 6049  2654 10408]]
Evaluating performance on  val set...
79/79 - 1s - 729ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1999837
{'0': {'precision': 0.4363061057072542, 'recall': 0.5377726419182436, 'f1-score': 0.4817546583850932, 'support': 6923}, '1': {'precision': 0.3919925512104283, 'recall': 0.13339670468948037, 'f1-score': 0.19905437352245864, 'support': 6312}, '2': {'precision': 0.4185224839400428, 'recall': 0.5760389036251106, 'f1-score': 0.48480714374302375, 'support': 6786}, 'accuracy': 0.42325558163927873, 'macro avg': {'precision': 0.41560704695257505, 'recall': 0.41573608341094487, 'f1-score': 0.38853872521685856, 'support': 20021}, 'weighted avg': {'precision': 0.41630776330196667, 'recall': 0.42325558163927884, 'f1-score': 0.3936626533696578, 'support': 20021}}
[[3723  684 2516]
 [2555  842 2915]
 [2255  622 3909]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2100748
{'0': {'precision': 0.3479539941269098, 'recall': 0.46499409933030955, 'f1-score': 0.398048917045503, 'support': 140662}, '1': {'precision': 0.31928726222008186, 'recall': 0.20061313054903054, 'f1-score': 0.24640572736341768, 'support': 125585}, '2': {'precision': 0.35900231702330654, 'recall': 0.3573718749776848, 'f1-score': 0.35818524058659756, 'support': 140039}, 'accuracy': 0.34617732336334506, 'macro avg': {'precision': 0.3420811911234327, 'recall': 0.3409930349523416, 'f1-score': 0.3342132949985061, 'support': 406286}, 'weighted avg': {'precision': 0.34290111158498, 'recall': 0.34617732336334506, 'f1-score': 0.3374350160893949, 'support': 406286}}
[[65407 27135 48120]
 [59154 25194 41237]
 [63415 26578 50046]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1894476
{'0': {'precision': 0.35654768607138837, 'recall': 0.483730522456462, 'f1-score': 0.41051403383677965, 'support': 26184}, '1': {'precision': 0.3463521969332325, 'recall': 0.202451768488746, 'f1-score': 0.2555361083631383, 'support': 24880}, '2': {'precision': 0.34401919521692953, 'recall': 0.35806108245312374, 'f1-score': 0.3508997171457803, 'support': 24426}, 'accuracy': 0.35036428666048486, 'macro avg': {'precision': 0.34897302607385017, 'recall': 0.34808112446611056, 'f1-score': 0.338983286448566, 'support': 75490}, 'weighted avg': {'precision': 0.34913366186462813, 'recall': 0.35036428666048486, 'f1-score': 0.34014722915697376, 'support': 75490}}
[[12666  4970  8548]
 [11714  5037  8129]
 [11144  4536  8746]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1945639
{'0': {'precision': 0.34164511759635513, 'recall': 0.4871817383669886, 'f1-score': 0.401635784597568, 'support': 11390}, '1': {'precision': 0.36726612770169936, 'recall': 0.19638288486987207, 'f1-score': 0.2559209013566337, 'support': 11335}, '2': {'precision': 0.34530811691249663, 'recall': 0.3590177815410669, 'f1-score': 0.35202952029520296, 'support': 10629}, 'accuracy': 0.34751454098458956, 'macro avg': {'precision': 0.3514064540701837, 'recall': 0.3475274682593092, 'f1-score': 0.33652873541646827, 'support': 33354}, 'weighted avg': {'precision': 0.3515194405943567, 'recall': 0.34751454098458956, 'f1-score': 0.33630799228462716, 'support': 33354}}
[[5549 2008 3833]
 [5707 2226 3402]
 [4986 1827 3816]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
2104/2104 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.119673
{'0': {'precision': 0.4979038657693228, 'recall': 0.48039723498832215, 'f1-score': 0.48899391040312123, 'support': 212368}, '1': {'precision': 0.2904061935131817, 'recall': 0.1455804411010429, 'f1-score': 0.19393925590188016, 'support': 116980}, '2': {'precision': 0.466267662480274, 'recall': 0.6129255830182637, 'f1-score': 0.5296315188412143, 'support': 209213}, 'accuracy': 0.4591550446467531, 'macro avg': {'precision': 0.4181925739209262, 'recall': 0.41296775303587624, 'f1-score': 0.4041882283820719, 'support': 538561}, 'weighted avg': {'precision': 0.4405440073703018, 'recall': 0.4591550446467531, 'f1-score': 0.44069190281364407, 'support': 538561}}
[[102021  21105  89242]
 [ 42406  17030  57544]
 [ 60474  20507 128232]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1786094
{'0': {'precision': 0.4454475789070358, 'recall': 0.5124383591834486, 'f1-score': 0.4766004330168979, 'support': 36299}, '1': {'precision': 0.477718499921544, 'recall': 0.16834858580552406, 'f1-score': 0.24896248594500664, 'support': 36169}, '2': {'precision': 0.4266775777414075, 'recall': 0.6336898395721925, 'f1-score': 0.5099765258215962, 'support': 37026}, 'accuracy': 0.43977752205600307, 'macro avg': {'precision': 0.44994788552332915, 'recall': 0.43815892818705504, 'f1-score': 0.41184648159450027, 'support': 109494}, 'weighted avg': {'precision': 0.4497604077288451, 'recall': 0.43977752205600307, 'f1-score': 0.41269141795254294, 'support': 109494}}
[[18601  3316 14382]
 [12935  6089 17145]
 [10222  3341 23463]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1892707
{'0': {'precision': 0.4335508957089293, 'recall': 0.5252797173382687, 'f1-score': 0.4750275780744799, 'support': 11887}, '1': {'precision': 0.46506233690924903, 'recall': 0.13774151996565048, 'f1-score': 0.2125347820325957, 'support': 11645}, '2': {'precision': 0.4250359871553538, 'recall': 0.6200629997576932, 'f1-score': 0.5043523962815754, 'support': 12381}, 'accuracy': 0.43229471222120125, 'macro avg': {'precision': 0.4412164065911774, 'recall': 0.42769474568720417, 'f1-score': 0.397304918796217, 'support': 35913}, 'weighted avg': {'precision': 0.4408331514373815, 'recall': 0.43229471222120125, 'f1-score': 0.40002248143299374, 'support': 35913}}
[[6244  921 4722]
 [4378 1604 5663]
 [3780  924 7677]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
5267/5267 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62751544
{'0': {'precision': 0.57865945992943, 'recall': 0.3941722560298494, 'f1-score': 0.4689228384551251, 'support': 202617}, '1': {'precision': 0.8179170358535364, 'recall': 0.855480388934248, 'f1-score': 0.8362771133541884, 'support': 943090}, '2': {'precision': 0.47056773086410925, 'recall': 0.5200363489100266, 'f1-score': 0.49406686217008805, 'support': 202482}, 'accuracy': 0.7357714682436958, 'macro avg': {'precision': 0.6223814088823585, 'recall': 0.5898963312913746, 'f1-score': 0.5997556046598006, 'support': 1348189}, 'weighted avg': {'precision': 0.7297916808522095, 'recall': 0.7357714682436958, 'f1-score': 0.7296721512921315, 'support': 1348189}}
[[ 79866  97075  25676]
 [ 43501 806795  92794]
 [ 14652  82532 105298]]
Evaluating performance on  train set...
1060/1060 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.53178173
{'0': {'precision': 0.5535046348999837, 'recall': 0.44356835657500326, 'f1-score': 0.4924757632759369, 'support': 30692}, '1': {'precision': 0.8785267533746514, 'recall': 0.8864508238621435, 'f1-score': 0.8824710006040054, 'support': 209319}, '2': {'precision': 0.4888324873096447, 'recall': 0.5546525022398566, 'f1-score': 0.5196666266938481, 'support': 31252}, 'accuracy': 0.7981147447311281, 'macro avg': {'precision': 0.6402879585280932, 'recall': 0.6282238942256678, 'f1-score': 0.6315377968579302, 'support': 271263}, 'weighted avg': {'precision': 0.7968558138683859, 'recall': 0.7981147447311281, 'f1-score': 0.7965466536878637, 'support': 271263}}
[[ 13614  13971   3107]
 [  8749 185551  15019]
 [  2233  11685  17334]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5337016
{'0': {'precision': 0.5773101555352241, 'recall': 0.4530604918327051, 'f1-score': 0.5076938549733481, 'support': 11142}, '1': {'precision': 0.8854576848067773, 'recall': 0.8789829338068462, 'f1-score': 0.8822084295076084, 'support': 81096}, '2': {'precision': 0.43767215198813475, 'recall': 0.5548889684813754, 'f1-score': 0.48935918190073835, 'support': 11168}, 'accuracy': 0.7980871516159604, 'macro avg': {'precision': 0.6334799974433788, 'recall': 0.6289774647069756, 'f1-score': 0.6264204887938982, 'support': 103406}, 'weighted avg': {'precision': 0.8038932823382334, 'recall': 0.7980871516159604, 'f1-score': 0.7994261752212589, 'support': 103406}}
[[ 5048  5050  1044]
 [ 2896 71282  6918]
 [  800  4171  6197]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
10110/10110 - 85s - 85s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6386369
{'0': {'precision': 0.6100742020336853, 'recall': 0.39084067769326736, 'f1-score': 0.47644773675673857, 'support': 397584}, '1': {'precision': 0.8115741263847094, 'recall': 0.8946328063865878, 'f1-score': 0.8510818052989569, 'support': 1790377}, '2': {'precision': 0.5236142997704165, 'recall': 0.4708027190483331, 'f1-score': 0.49580614852576976, 'support': 400140}, 'accuracy': 0.7517129354689017, 'macro avg': {'precision': 0.6484208760629371, 'recall': 0.5854254010427294, 'f1-score': 0.6077785635271552, 'support': 2588101}, 'weighted avg': {'precision': 0.7360989455688831, 'recall': 0.7517129354689017, 'f1-score': 0.7386022255574737, 'support': 2588101}}
[[ 155392  193585   48607]
 [  65859 1601730  122788]
 [  33459  178294  188387]]
Evaluating performance on  train set...
1686/1686 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60122496
{'0': {'precision': 0.5705407389283093, 'recall': 0.4016190148122632, 'f1-score': 0.4714040230465987, 'support': 58060}, '1': {'precision': 0.8434846429420099, 'recall': 0.888523800621671, 'f1-score': 0.8654186225221971, 'support': 315601}, '2': {'precision': 0.4953729933899906, 'recall': 0.4982644585283299, 'f1-score': 0.4968145189062608, 'support': 57907}, 'accuracy': 0.7706549141734327, 'macro avg': {'precision': 0.6364661250867699, 'recall': 0.5961357579874215, 'f1-score': 0.6112123881583522, 'support': 431568}, 'weighted avg': {'precision': 0.7600557873325943, 'recall': 0.7706549141734327, 'f1-score': 0.7629521619096373, 'support': 431568}}
[[ 23318  27584   7158]
 [ 12948 280419  22234]
 [  4604  24450  28853]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6687681
{'0': {'precision': 0.5327262642137376, 'recall': 0.41128399114981085, 'f1-score': 0.46419365232801674, 'support': 28022}, '1': {'precision': 0.8243168655498114, 'recall': 0.8620182263086441, 'f1-score': 0.8427461016356439, 'support': 123009}, '2': {'precision': 0.49172333720351635, 'recall': 0.5044753769186264, 'f1-score': 0.49801773955113565, 'support': 29383}, 'accuracy': 0.7337789750241112, 'macro avg': {'precision': 0.6162554889890218, 'recall': 0.5925925314590271, 'f1-score': 0.6016524978382655, 'support': 180414}, 'weighted avg': {'precision': 0.7248592432253873, 'recall': 0.7337789750241112, 'f1-score': 0.727805186863911, 'support': 180414}}
[[ 11525  11613   4884]
 [  6535 106036  10438]
 [  3574  10986  14823]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
6546/6546 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8762233
{'0': {'precision': 0.5094436691725455, 'recall': 0.3997265153923394, 'f1-score': 0.4479648499790773, 'support': 396366}, '1': {'precision': 0.6811885743578538, 'recall': 0.7314293770972563, 'f1-score': 0.7054155500644804, 'support': 886575}, '2': {'precision': 0.4765808388020436, 'recall': 0.500814605883491, 'f1-score': 0.48839729355002476, 'support': 392828}, 'accuracy': 0.5989124992764516, 'macro avg': {'precision': 0.5557376941108143, 'recall': 0.5439901661243622, 'f1-score': 0.5472592311978608, 'support': 1675769}, 'weighted avg': {'precision': 0.5926026841596238, 'recall': 0.5989124992764516, 'f1-score': 0.5936486228447314, 'support': 1675769}}
[[158438 160622  77306]
 [ 99345 648467 138763]
 [ 53219 142875 196734]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85980034
{'0': {'precision': 0.535480126737146, 'recall': 0.43098812033682193, 'f1-score': 0.4775854230056308, 'support': 79211}, '1': {'precision': 0.6793480163871284, 'recall': 0.7400256827544118, 'f1-score': 0.7083898764064772, 'support': 157304}, '2': {'precision': 0.5003263789510682, 'recall': 0.5093220880454923, 'f1-score': 0.5047841587669473, 'support': 78255}, 'accuracy': 0.604901991930616, 'macro avg': {'precision': 0.5717181740251142, 'recall': 0.560111963712242, 'f1-score': 0.5635864860596851, 'support': 314770}, 'weighted avg': {'precision': 0.5986374733092504, 'recall': 0.604901991930616, 'f1-score': 0.5996901369388791, 'support': 314770}}
[[ 34139  28471  16601]
 [ 17691 116409  23204]
 [ 11924  26474  39857]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7977914
{'0': {'precision': 0.5274255381893247, 'recall': 0.43079084704937776, 'f1-score': 0.4742354604914265, 'support': 24910}, '1': {'precision': 0.7258382076081802, 'recall': 0.7859510434011298, 'f1-score': 0.754699500911509, 'support': 64261}, '2': {'precision': 0.5029142735588172, 'recall': 0.4872027366772452, 'f1-score': 0.4949338469268129, 'support': 24263}, 'accuracy': 0.644057337306275, 'macro avg': {'precision': 0.5853926731187741, 'recall': 0.5679815423759175, 'f1-score': 0.5746229361099161, 'support': 113434}, 'weighted avg': {'precision': 0.6345845887014734, 'recall': 0.644057337306275, 'f1-score': 0.6375472069829256, 'support': 113434}}
[[10731  9836  4343]
 [ 6414 50506  7341]
 [ 3201  9241 11821]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
7633/7633 - 61s - 61s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9145314
{'0': {'precision': 0.5183812640077989, 'recall': 0.4276259718072489, 'f1-score': 0.4686503092061846, 'support': 519779}, '1': {'precision': 0.6491564094054343, 'recall': 0.684186114342796, 'f1-score': 0.6662111099603559, 'support': 911977}, '2': {'precision': 0.4798500053189603, 'recall': 0.5182466796366366, 'f1-score': 0.498309784469902, 'support': 522232}, 'accuracy': 0.5715889759814288, 'macro avg': {'precision': 0.5491292262440645, 'recall': 0.5433529219288938, 'f1-score': 0.5443904012121475, 'support': 1953988}, 'weighted avg': {'precision': 0.5691193793323095, 'recall': 0.5715889759814288, 'f1-score': 0.5687840016727241, 'support': 1953988}}
[[222271 176651 120857]
 [115497 623962 172518]
 [ 91011 160576 270645]]
Evaluating performance on  train set...
1586/1586 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88897985
{'0': {'precision': 0.5206320450885669, 'recall': 0.44963059539330724, 'f1-score': 0.4825334639242572, 'support': 103545}, '1': {'precision': 0.6755096881645278, 'recall': 0.691942117288652, 'f1-score': 0.6836271699135421, 'support': 196950}, '2': {'precision': 0.48900710766144856, 'recall': 0.5323206911283049, 'f1-score': 0.5097454545454545, 'support': 105335}, 'accuracy': 0.5886873814158637, 'macro avg': {'precision': 0.5617162803048478, 'recall': 0.5579644679367547, 'f1-score': 0.558635362794418, 'support': 405830}, 'weighted avg': {'precision': 0.5875860381889414, 'recall': 0.5886873814158637, 'f1-score': 0.5871875812311923, 'support': 405830}}
[[ 46557  33822  23166]
 [ 25245 136278  35427]
 [ 17622  31641  56072]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8645808
{'0': {'precision': 0.49973868164891877, 'recall': 0.44317951391906374, 'f1-score': 0.46976280033776, 'support': 34521}, '1': {'precision': 0.7092948591946115, 'recall': 0.7028750259713277, 'f1-score': 0.7060703500544616, 'support': 77008}, '2': {'precision': 0.47381727158948683, 'recall': 0.5355344310530187, 'f1-score': 0.5027889927751805, 'support': 35346}, 'accuracy': 0.6015659574468085, 'macro avg': {'precision': 0.5609502708110057, 'recall': 0.5605296569811368, 'f1-score': 0.5595407143891341, 'support': 146875}, 'weighted avg': {'precision': 0.6033729554223862, 'recall': 0.6015659574468085, 'f1-score': 0.6016090341180278, 'support': 146875}}
[[15299 11797  7425]
 [ 9285 54127 13596]
 [ 6030 10387 18929]]
testing model on single stock: results/universal/W10/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
22048/22048 - 193s - 193s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.169562
{'0': {'precision': 0.42894428981819643, 'recall': 0.5451979048066004, 'f1-score': 0.4801342748072006, 'support': 2075417}, '1': {'precision': 0.23002793654048234, 'recall': 0.024891127318462908, 'f1-score': 0.044921353221355285, 'support': 1442281}, '2': {'precision': 0.435983604774292, 'recall': 0.5843743092688478, 'f1-score': 0.49938872308633353, 'support': 2126370}, 'accuracy': 0.4269985762042555, 'macro avg': {'precision': 0.3649852770443236, 'recall': 0.3848211137979704, 'f1-score': 0.34148145037162986, 'support': 5644068}, 'weighted avg': {'precision': 0.3807653719209383, 'recall': 0.4269985762042555, 'f1-score': 0.37617428591790036, 'support': 5644068}}
[[1131513   63741  880163]
 [ 679042   35900  727339]
 [ 827347   56427 1242596]]
Evaluating performance on  train set...
5429/5429 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2306179
{'0': {'precision': 0.4016183471815036, 'recall': 0.5718749931947902, 'f1-score': 0.4718583682812798, 'support': 459207}, '1': {'precision': 0.35695947750005136, 'recall': 0.03784694850811597, 'f1-score': 0.06843772580413343, 'support': 459218}, '2': {'precision': 0.40906683352007334, 'recall': 0.5963943475521405, 'f1-score': 0.4852800921110892, 'support': 471371}, 'accuracy': 0.4037369513223523, 'macro avg': {'precision': 0.3892148860672094, 'recall': 0.40203876308501557, 'f1-score': 0.3418587287321675, 'support': 1389796}, 'weighted avg': {'precision': 0.38938838223450484, 'recall': 0.4037369513223523, 'f1-score': 0.34311184057959615, 'support': 1389796}}
[[262609  16913 179685]
 [215416  17380 226422]
 [175852  14396 281123]]
Evaluating performance on  val set...
1890/1890 - 20s - 20s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2594821
{'0': {'precision': 0.3901506074485353, 'recall': 0.5632727130305365, 'f1-score': 0.4609939497549183, 'support': 153194}, '1': {'precision': 0.367012331838565, 'recall': 0.04561260921308525, 'f1-score': 0.08114095103349633, 'support': 172255}, '2': {'precision': 0.39540333820015927, 'recall': 0.6025041398576647, 'f1-score': 0.47746339899726026, 'support': 158218}, 'accuracy': 0.39174473346331257, 'macro avg': {'precision': 0.38418875916241985, 'recall': 0.40379648736709556, 'f1-score': 0.3398660999285583, 'support': 483667}, 'weighted avg': {'precision': 0.38362833673100655, 'recall': 0.39174473346331257, 'f1-score': 0.3310991771644094, 'support': 483667}}
[[86290  7173 59731]
 [78368  7857 86030]
 [56513  6378 95327]]
training model: results/universal/W10/deepVOL_L2/h30
Epoch 1/50
8543/8543 - 288s - loss: 2.9652 - accuracy30: 0.4772 - val_loss: 3.2569 - val_accuracy30: 0.4566 - 288s/epoch - 34ms/step
Epoch 2/50
8543/8543 - 275s - loss: 2.9125 - accuracy30: 0.4919 - val_loss: 3.2657 - val_accuracy30: 0.4613 - 275s/epoch - 32ms/step
Epoch 3/50
8543/8543 - 288s - loss: 2.8941 - accuracy30: 0.4972 - val_loss: 3.3559 - val_accuracy30: 0.4655 - 288s/epoch - 34ms/step
Epoch 4/50
8543/8543 - 276s - loss: 2.8820 - accuracy30: 0.5015 - val_loss: 3.5017 - val_accuracy30: 0.4621 - 276s/epoch - 32ms/step
Epoch 5/50
8543/8543 - 284s - loss: 2.8745 - accuracy30: 0.5032 - val_loss: 3.5112 - val_accuracy30: 0.4647 - 284s/epoch - 33ms/step
Epoch 6/50
8543/8543 - 279s - loss: 2.8679 - accuracy30: 0.5049 - val_loss: 3.4739 - val_accuracy30: 0.4663 - 279s/epoch - 33ms/step
Epoch 7/50
8543/8543 - 284s - loss: 2.8620 - accuracy30: 0.5065 - val_loss: 3.4805 - val_accuracy30: 0.4678 - 284s/epoch - 33ms/step
Epoch 8/50
8543/8543 - 281s - loss: 2.8579 - accuracy30: 0.5075 - val_loss: 3.4886 - val_accuracy30: 0.4691 - 281s/epoch - 33ms/step
Epoch 9/50
8543/8543 - 280s - loss: 2.8528 - accuracy30: 0.5092 - val_loss: 3.4846 - val_accuracy30: 0.4722 - 280s/epoch - 33ms/step
Epoch 10/50
8543/8543 - 280s - loss: 2.8485 - accuracy30: 0.5098 - val_loss: 3.5023 - val_accuracy30: 0.4726 - 280s/epoch - 33ms/step
Epoch 11/50
8543/8543 - 278s - loss: 2.8446 - accuracy30: 0.5107 - val_loss: 3.4733 - val_accuracy30: 0.4733 - 278s/epoch - 33ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 583s - 583s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0918808
{'0': {'precision': 0.3991987423406426, 'recall': 0.5038690963102554, 'f1-score': 0.44546799463451375, 'support': 2946166}, '1': {'precision': 0.6774222737541157, 'recall': 0.423736375327221, 'f1-score': 0.5213571342984397, 'support': 3604215}, '2': {'precision': 0.4058284917004979, 'recall': 0.4840488724490784, 'f1-score': 0.4415008892895429, 'support': 2994898}, 'accuracy': 0.4673929384358488, 'macro avg': {'precision': 0.49414983593175205, 'recall': 0.47055144802885157, 'f1-score': 0.4694420060741655, 'support': 9545279}, 'weighted avg': {'precision': 0.5063336776706358, 'recall': 0.4673929384358488, 'f1-score': 0.4728783720211123, 'support': 9545279}}
[[1484482  370464 1091220]
 [1045733 1527237 1031245]
 [1188439  356782 1449677]]
Evaluating performance on  train set...
8543/8543 - 137s - 137s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1279142
{'0': {'precision': 0.3800658394756022, 'recall': 0.5458727343734995, 'f1-score': 0.44812384945595113, 'support': 624772}, '1': {'precision': 0.7229139384307255, 'recall': 0.3862421828122597, 'f1-score': 0.5034816149271769, 'support': 923286}, '2': {'precision': 0.3927907467516154, 'recall': 0.4896110931917039, 'f1-score': 0.4358891792995296, 'support': 638662}, 'accuracy': 0.4620408648569547, 'macro avg': {'precision': 0.49859017488598106, 'recall': 0.47390867012582105, 'f1-score': 0.46249821456088586, 'support': 2186720}, 'weighted avg': {'precision': 0.5285410739009484, 'recall': 0.4620408648569547, 'f1-score': 0.46792392945678596, 'support': 2186720}}
[[341046  68646 215080]
 [298362 356612 268312]
 [257926  68040 312696]]
Evaluating performance on  val set...
3077/3077 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1541512
{'0': {'precision': 0.3621736978236141, 'recall': 0.5364695370959361, 'f1-score': 0.43241889210271905, 'support': 205939}, '1': {'precision': 0.7302160096499853, 'recall': 0.389659984638186, 'f1-score': 0.5081561897103275, 'support': 369748}, '2': {'precision': 0.3674373660353491, 'recall': 0.4949871246260461, 'f1-score': 0.42178014948189557, 'support': 211256}, 'accuracy': 0.45635452631257917, 'macro avg': {'precision': 0.4866090245029829, 'recall': 0.4737055487867227, 'f1-score': 0.45411841043164736, 'support': 786943}, 'weighted avg': {'precision': 0.5365127416996196, 'recall': 0.45635452631257917, 'f1-score': 0.46514834786344544, 'support': 786943}}
[[110480  26703  68756]
 [114407 144076 111265]
 [ 80160  26527 104569]]
testing model out of sample: results/universal/W10/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 336s - 336s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9475749
{'0': {'precision': 0.44566476748986134, 'recall': 0.4841446782562593, 'f1-score': 0.46410848255771175, 'support': 1407067}, '1': {'precision': 0.6774996646100038, 'recall': 0.6459412194169483, 'f1-score': 0.6613441745598166, 'support': 2650365}, '2': {'precision': 0.43875081564298285, 'recall': 0.43936546890442774, 'f1-score': 0.43905792715491154, 'support': 1403367}, 'accuracy': 0.5511638498322315, 'macro avg': {'precision': 0.5206384159142826, 'recall': 0.5231504555258785, 'f1-score': 0.5215035280908134, 'support': 5460799}, 'weighted avg': {'precision': 0.5564075883196206, 'recall': 0.5511638498322315, 'f1-score': 0.5533978799607653, 'support': 5460799}}
[[ 681224  386304  339539]
 [ 489182 1711980  449203]
 [ 358151  428625  616591]]
Evaluating performance on  train set...
4055/4055 - 68s - 68s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95145595
{'0': {'precision': 0.4288371459231123, 'recall': 0.4990406342913776, 'f1-score': 0.4612830824760212, 'support': 252250}, '1': {'precision': 0.7056163834182144, 'recall': 0.6185651775335268, 'f1-score': 0.6592294234424243, 'support': 529055}, '2': {'precision': 0.42553069973478397, 'recall': 0.46535376207670537, 'f1-score': 0.44455217368605543, 'support': 256175}, 'accuracy': 0.5516732852681497, 'macro avg': {'precision': 0.5199947430253702, 'recall': 0.5276531913005366, 'f1-score': 0.5216882265348336, 'support': 1037480}, 'weighted avg': {'precision': 0.5691621744929896, 'recall': 0.5516732852681497, 'f1-score': 0.558093103739767, 'support': 1037480}}
[[125883  64181  62186]
 [103049 327255  98751]
 [ 64613  72350 119212]]
Evaluating performance on  val set...
1545/1545 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96272534
{'0': {'precision': 0.4108210320849091, 'recall': 0.4965244865718799, 'f1-score': 0.4496251931256795, 'support': 94950}, '1': {'precision': 0.7108540191562305, 'recall': 0.5973024475957136, 'f1-score': 0.6491499393486231, 'support': 202035}, '2': {'precision': 0.42346333288037324, 'recall': 0.47736928104575166, 'f1-score': 0.4488034372674684, 'support': 97920}, 'accuracy': 0.5433332067206037, 'macro avg': {'precision': 0.5150461280405042, 'recall': 0.5237320717377817, 'f1-score': 0.5158595232472569, 'support': 394905}, 'weighted avg': {'precision': 0.5674538897009086, 'recall': 0.5433332067206037, 'f1-score': 0.5514991014568386, 'support': 394905}}
[[ 47145  23397  24408]
 [ 42126 120676  39233]
 [ 25487  25689  46744]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1243749
{'0': {'precision': 0.4630395147751683, 'recall': 0.49655426071470055, 'f1-score': 0.4792116201952267, 'support': 51658}, '1': {'precision': 0.3973721890002527, 'recall': 0.2863472218007465, 'f1-score': 0.332845376461666, 'support': 32953}, '2': {'precision': 0.43099481923429406, 'recall': 0.4800933352778183, 'f1-score': 0.4542211184041945, 'support': 47999}, 'accuracy': 0.4383606062891185, 'macro avg': {'precision': 0.4304688410032383, 'recall': 0.4209982725977551, 'f1-score': 0.4220927050203624, 'support': 132610}, 'weighted avg': {'precision': 0.4351227006018238, 'recall': 0.4383606062891185, 'f1-score': 0.43379478944928157, 'support': 132610}}
[[25651  7016 18991]
 [12085  9436 11432]
 [17661  7294 23044]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1554675
{'0': {'precision': 0.42591191160889963, 'recall': 0.491528384279476, 'f1-score': 0.4563736620175154, 'support': 11450}, '1': {'precision': 0.5065676756139349, 'recall': 0.3115833845613419, 'f1-score': 0.3858409004404328, 'support': 11387}, '2': {'precision': 0.41261963842609006, 'recall': 0.5067038133379766, 'f1-score': 0.454847407291626, 'support': 11486}, 'accuracy': 0.4369081956705416, 'macro avg': {'precision': 0.44836640854964155, 'recall': 0.43660519405959813, 'f1-score': 0.43235398991652474, 'support': 34323}, 'weighted avg': {'precision': 0.4482220865629417, 'recall': 0.4369081956705416, 'f1-score': 0.4324629573046463, 'support': 34323}}
[[5628 1669 4153]
 [3707 3548 4132]
 [3879 1787 5820]]
Evaluating performance on  val set...
46/46 - 1s - 518ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1370875
{'0': {'precision': 0.42419255297263936, 'recall': 0.514856429463171, 'f1-score': 0.4651477554703361, 'support': 4005}, '1': {'precision': 0.5237896494156928, 'recall': 0.32965589703178355, 'f1-score': 0.4046429147186845, 'support': 3807}, '2': {'precision': 0.4183050847457627, 'recall': 0.4782945736434108, 'f1-score': 0.4462929475587703, 'support': 3870}, 'accuracy': 0.44239000171203563, 'macro avg': {'precision': 0.455429095711365, 'recall': 0.4409356333794551, 'f1-score': 0.4386945392492636, 'support': 11682}, 'weighted avg': {'precision': 0.45469945625295877, 'recall': 0.44239000171203563, 'f1-score': 0.4391838763948955, 'support': 11682}}
[[2062  587 1356]
 [1334 1255 1218]
 [1465  554 1851]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
1840/1840 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7122827
{'0': {'precision': 0.48029637760702526, 'recall': 0.38992692490494296, 'f1-score': 0.43041938551332914, 'support': 67328}, '1': {'precision': 0.820625785424267, 'recall': 0.8402718549314567, 'f1-score': 0.8303326275728201, 'support': 336503}, '2': {'precision': 0.4177677426548475, 'recall': 0.44646687321258344, 'f1-score': 0.43164079375594017, 'support': 67136}, 'accuracy': 0.7197553119432997, 'macro avg': {'precision': 0.5728966352287133, 'recall': 0.5588885510163276, 'f1-score': 0.5641309356140297, 'support': 470967}, 'weighted avg': {'precision': 0.7145462173677217, 'recall': 0.7197553119432997, 'f1-score': 0.7163290270731855, 'support': 470967}}
[[ 26253  32033   9042]
 [ 21017 282754  32732]
 [  7390  29772  29974]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6212584
{'0': {'precision': 0.4224716116608008, 'recall': 0.48964827214654044, 'f1-score': 0.45358619706259806, 'support': 12993}, '1': {'precision': 0.8932685420014327, 'recall': 0.8460621619143669, 'f1-score': 0.8690247485591591, 'support': 109070}, '2': {'precision': 0.3972763559521014, 'recall': 0.5074224021592443, 'f1-score': 0.445644301046948, 'support': 13338}, 'accuracy': 0.7785023744285493, 'macro avg': {'precision': 0.5710055032047783, 'recall': 0.6143776120733838, 'f1-score': 0.5894184155562351, 'support': 135401}, 'weighted avg': {'precision': 0.7992322476354988, 'recall': 0.7785023744285493, 'f1-score': 0.7874534048577633, 'support': 135401}}
[[ 6362  5558  1073]
 [ 7595 92280  9195]
 [ 1102  5468  6768]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67144156
{'0': {'precision': 0.4993145990404387, 'recall': 0.4479631053036126, 'f1-score': 0.4722469816060287, 'support': 6505}, '1': {'precision': 0.8562194132579624, 'recall': 0.8223864464721112, 'f1-score': 0.8389619714337001, 'support': 39783}, '2': {'precision': 0.3985611510791367, 'recall': 0.5300264939652635, 'f1-score': 0.45498768083896646, 'support': 6794}, 'accuracy': 0.739082928299612, 'macro avg': {'precision': 0.5846983877925126, 'recall': 0.6001253485803291, 'f1-score': 0.5887322112928984, 'support': 53082}, 'weighted avg': {'precision': 0.7539060857697756, 'recall': 0.739082928299612, 'f1-score': 0.7448773035777484, 'support': 53082}}
[[ 2914  2798   793]
 [ 2425 32717  4641]
 [  497  2696  3601]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2820164
{'0': {'precision': 0.4010702246943787, 'recall': 0.5228495703156373, 'f1-score': 0.45393419597764695, 'support': 87157}, '1': {'precision': 0.30097453846681765, 'recall': 0.11470757480644486, 'f1-score': 0.1661079862886578, 'support': 76464}, '2': {'precision': 0.3764698022447889, 'recall': 0.4700421840367978, 'f1-score': 0.4180843058072859, 'support': 83918}, 'accuracy': 0.37887363203374014, 'macro avg': {'precision': 0.3595048551353284, 'recall': 0.3691997763862933, 'f1-score': 0.34604216269119686, 'support': 247539}, 'weighted avg': {'precision': 0.36181121983926934, 'recall': 0.37887363203374014, 'f1-score': 0.3528721638090787, 'support': 247539}}
[[45570  9930 31657]
 [34019  8771 33674]
 [34032 10441 39445]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2576858
{'0': {'precision': 0.3913242388953585, 'recall': 0.5073331176534024, 'f1-score': 0.4418408077013384, 'support': 18546}, '1': {'precision': 0.386468952734013, 'recall': 0.2248342049927212, 'f1-score': 0.28428264648737095, 'support': 18547}, '2': {'precision': 0.40208109747561943, 'recall': 0.4494575422491133, 'f1-score': 0.4244513952171022, 'support': 19172}, 'accuracy': 0.3944903581267218, 'macro avg': {'precision': 0.39329142970166364, 'recall': 0.393874954965079, 'f1-score': 0.38352494980193724, 'support': 56265}, 'weighted avg': {'precision': 0.3933891016033703, 'recall': 0.3944903581267218, 'f1-score': 0.3839785304031383, 'support': 56265}}
[[9409 3084 6053]
 [7616 4170 6761]
 [7019 3536 8617]]
Evaluating performance on  val set...
79/79 - 1s - 813ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2599684
{'0': {'precision': 0.4013093289689034, 'recall': 0.5308891454965358, 'f1-score': 0.4570931460883613, 'support': 6928}, '1': {'precision': 0.3588957055214724, 'recall': 0.1476573592049219, 'f1-score': 0.20923214485302336, 'support': 6339}, '2': {'precision': 0.39791464597478177, 'recall': 0.48593426117856087, 'f1-score': 0.4375416611118518, 'support': 6754}, 'accuracy': 0.39438589481044906, 'macro avg': {'precision': 0.3860398934883859, 'recall': 0.3881602552933395, 'f1-score': 0.36795565068441216, 'support': 20021}, 'weighted avg': {'precision': 0.3867352493537212, 'recall': 0.394385894810449, 'f1-score': 0.3720203916624009, 'support': 20021}}
[[3678  821 2429]
 [2866  936 2537]
 [2621  851 3282]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1741518
{'0': {'precision': 0.3440528376877667, 'recall': 0.6236430029453105, 'f1-score': 0.4434578218856099, 'support': 141581}, '1': {'precision': 0.2932816025970941, 'recall': 0.05991297737088139, 'f1-score': 0.0994996810046674, 'support': 123646}, '2': {'precision': 0.3411714579715737, 'recall': 0.30085992386164656, 'f1-score': 0.3197501610466715, 'support': 141059}, 'accuracy': 0.34001417720522, 'macro avg': {'precision': 0.32616863275214486, 'recall': 0.3281386347259461, 'f1-score': 0.28756922131231627, 'support': 406286}, 'weighted avg': {'precision': 0.3276011148240506, 'recall': 0.34001417720522, 'f1-score': 0.2958299754482608, 'support': 406286}}
[[88296  9121 44164]
 [78449  7408 37789]
 [89890  8730 42439]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1740025
{'0': {'precision': 0.3449479510905486, 'recall': 0.6359862909367859, 'f1-score': 0.44729230274787074, 'support': 26260}, '1': {'precision': 0.33111480865224624, 'recall': 0.055995497849419144, 'f1-score': 0.09579150048136433, 'support': 24877}, '2': {'precision': 0.32194865964053004, 'recall': 0.302303617624112, 'f1-score': 0.31181702668360867, 'support': 24353}, 'accuracy': 0.3372102265200689, 'macro avg': {'precision': 0.332670473127775, 'recall': 0.331428468803439, 'f1-score': 0.28496694330428124, 'support': 75490}, 'weighted avg': {'precision': 0.33296982380057705, 'recall': 0.3372102265200689, 'f1-score': 0.2877544188430244, 'support': 75490}}
[[16701  1495  8064]
 [16043  1393  7441]
 [15672  1319  7362]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1875292
{'0': {'precision': 0.335732528442071, 'recall': 0.636836078569541, 'f1-score': 0.43967404524446607, 'support': 11353}, '1': {'precision': 0.3497917906008328, 'recall': 0.0517377914650242, 'f1-score': 0.0901425724359957, 'support': 11365}, '2': {'precision': 0.31436180706253697, 'recall': 0.29964272282813087, 'f1-score': 0.30682583999229807, 'support': 10636}, 'accuracy': 0.32994543383102476, 'macro avg': {'precision': 0.33329537536848025, 'recall': 0.32940553095423203, 'f1-score': 0.2788808192242533, 'support': 33354}, 'weighted avg': {'precision': 0.33370831910710685, 'recall': 0.32994543383102476, 'f1-score': 0.27821219060843067, 'support': 33354}}
[[7230  578 3545]
 [7371  588 3406]
 [6934  515 3187]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1628549
{'0': {'precision': 0.44533327586578453, 'recall': 0.4879159071805672, 'f1-score': 0.46565310367050416, 'support': 211766}, '1': {'precision': 0.2610335022870565, 'recall': 0.17992876133342423, 'f1-score': 0.21302246748923034, 'support': 117352}, '2': {'precision': 0.4385480554472294, 'recall': 0.47249609679005744, 'f1-score': 0.45488957685492265, 'support': 209443}, 'accuracy': 0.4148090931203708, 'macro avg': {'precision': 0.3816382778666902, 'recall': 0.3801135884346829, 'f1-score': 0.37785504933821906, 'support': 538561}, 'weighted avg': {'precision': 0.40253577669830987, 'recall': 0.4148090931203708, 'f1-score': 0.4064192271663, 'support': 538561}}
[[103324  29122  79320]
 [ 48862  21115  47375]
 [ 79829  30653  98961]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.241417
{'0': {'precision': 0.3963472538150659, 'recall': 0.49612981699563224, 'f1-score': 0.4406604873856731, 'support': 36174}, '1': {'precision': 0.40975849566767036, 'recall': 0.18361558584606913, 'f1-score': 0.25359397581197235, 'support': 36315}, '2': {'precision': 0.39286608260325406, 'recall': 0.5089582488852857, 'f1-score': 0.4434398728589087, 'support': 37005}, 'accuracy': 0.3968162639048715, 'macro avg': {'precision': 0.3996572773619968, 'recall': 0.39623455057566237, 'f1-score': 0.3792314453521847, 'support': 109494}, 'weighted avg': {'precision': 0.399618743642675, 'recall': 0.3968162639048715, 'f1-score': 0.37955696382856624, 'support': 109494}}
[[17947  4529 13698]
 [14239  6668 15408]
 [13095  5076 18834]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2458467
{'0': {'precision': 0.38693340086097744, 'recall': 0.5125796712512579, 'f1-score': 0.440981240981241, 'support': 11924}, '1': {'precision': 0.39879951980792316, 'recall': 0.1438095238095238, 'f1-score': 0.2113903913458479, 'support': 11550}, '2': {'precision': 0.3954989969909729, 'recall': 0.5071951121472787, 'f1-score': 0.4444366172378571, 'support': 12439}, 'accuracy': 0.3921142761674046, 'macro avg': {'precision': 0.39374397255329113, 'recall': 0.38786143573602017, 'f1-score': 0.3656027498549819, 'support': 35913}, 'weighted avg': {'precision': 0.39371649122096514, 'recall': 0.3921142761674046, 'f1-score': 0.3683392203192873, 'support': 35913}}
[[6112 1183 4629]
 [4875 1661 5014]
 [4809 1321 6309]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
5267/5267 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75940543
{'0': {'precision': 0.5276094698436418, 'recall': 0.39974959608940164, 'f1-score': 0.4548651761995439, 'support': 242009}, '1': {'precision': 0.7595715970500974, 'recall': 0.8076163986672461, 'f1-score': 0.782857550486455, 'support': 862875}, '2': {'precision': 0.4643131452780001, 'recall': 0.47207825568730605, 'f1-score': 0.4681635040423576, 'support': 243305}, 'accuracy': 0.67384765785806, 'macro avg': {'precision': 0.5838314040572464, 'recall': 0.5598147501479845, 'f1-score': 0.5686287435761188, 'support': 1348189}, 'weighted avg': {'precision': 0.6646481255994942, 'recall': 0.67384765785806, 'f1-score': 0.6671885000203244, 'support': 1348189}}
[[ 96743 114424  30842]
 [ 64330 696872 101673]
 [ 22288 106158 114859]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67730707
{'0': {'precision': 0.4958891508077962, 'recall': 0.4589841151584493, 'f1-score': 0.47672345893960116, 'support': 37583}, '1': {'precision': 0.8328388846053686, 'recall': 0.8345647680058945, 'f1-score': 0.8337009330985465, 'support': 195436}, '2': {'precision': 0.4737917117826558, 'recall': 0.5034253739148624, 'f1-score': 0.4881592292089249, 'support': 38244}, 'accuracy': 0.735843074801945, 'macro avg': {'precision': 0.6008399157319402, 'recall': 0.5989914190264021, 'f1-score': 0.5995278737490243, 'support': 271263}, 'weighted avg': {'precision': 0.7355348589079975, 'recall': 0.735843074801945, 'f1-score': 0.7355261678896152, 'support': 271263}}
[[ 17250  16916   3417]
 [ 14366 163104  17966]
 [  3170  15821  19253]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6776662
{'0': {'precision': 0.520019895548371, 'recall': 0.4612160870524226, 'f1-score': 0.4888559850374064, 'support': 13601}, '1': {'precision': 0.8437366109682948, 'recall': 0.8285278533769836, 'f1-score': 0.8360630725652914, 'support': 76059}, '2': {'precision': 0.4255178625037526, 'recall': 0.5155681652844464, 'f1-score': 0.466234663333443, 'support': 13746}, 'accuracy': 0.7386128464499159, 'macro avg': {'precision': 0.5964247896734728, 'recall': 0.6017707019046176, 'f1-score': 0.597051240312047, 'support': 103406}, 'weighted avg': {'precision': 0.7455633331815128, 'recall': 0.7386128464499159, 'f1-score': 0.7412327444337735, 'support': 103406}}
[[ 6273  6101  1227]
 [ 4701 63017  8341]
 [ 1089  5570  7087]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
10110/10110 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81947577
{'0': {'precision': 0.4452109741612633, 'recall': 0.48210200497184097, 'f1-score': 0.4629226768275461, 'support': 474271}, '1': {'precision': 0.7640752863135206, 'recall': 0.7479516726147873, 'f1-score': 0.7559275117778071, 'support': 1636091}, '2': {'precision': 0.4359159768693244, 'recall': 0.43155991032760566, 'f1-score': 0.43372700651306817, 'support': 477739}, 'accuracy': 0.6408316367869724, 'macro avg': {'precision': 0.5484007457813694, 'recall': 0.5538711959714114, 'f1-score': 0.5508590650394738, 'support': 2588101}, 'weighted avg': {'precision': 0.6450681082616115, 'recall': 0.6408316367869724, 'f1-score': 0.6427590367989071, 'support': 2588101}}
[[ 228647  181261   64363]
 [ 209945 1223717  202429]
 [  74978  196588  206173]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7936472
{'0': {'precision': 0.41474960551449214, 'recall': 0.5027034800115042, 'f1-score': 0.45451058656802773, 'support': 69540}, '1': {'precision': 0.8109162161345858, 'recall': 0.7335614730723388, 'f1-score': 0.7703016990182454, 'support': 292803}, '2': {'precision': 0.40164302442694366, 'recall': 0.478136511375948, 'f1-score': 0.4365643589168656, 'support': 69225}, 'accuracy': 0.6553915026137248, 'macro avg': {'precision': 0.5424362820253404, 'recall': 0.5714671548199303, 'f1-score': 0.5537922148343796, 'support': 431568}, 'weighted avg': {'precision': 0.6814317251656473, 'recall': 0.6553915026137248, 'f1-score': 0.6658845936529121, 'support': 431568}}
[[ 34958  24545  10037]
 [ 38741 214789  39273]
 [ 10588  25538  33099]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8593572
{'0': {'precision': 0.3895443734552068, 'recall': 0.5066569617565887, 'f1-score': 0.4404487272439658, 'support': 32973}, '1': {'precision': 0.7851356365435356, 'recall': 0.6746103436060928, 'f1-score': 0.7256887550965972, 'support': 112920}, '2': {'precision': 0.4097126209757061, 'recall': 0.4807218794357058, 'f1-score': 0.44238587137620794, 'support': 34521}, 'accuracy': 0.6068154356092099, 'macro avg': {'precision': 0.5281308769914829, 'recall': 0.5539963949327957, 'f1-score': 0.5361744512389236, 'support': 180414}, 'weighted avg': {'precision': 0.6410015414166136, 'recall': 0.6068154356092099, 'f1-score': 0.6193493452542548, 'support': 180414}}
[[16706  9931  6336]
 [19170 76177 17573]
 [ 7010 10916 16595]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
6546/6546 - 63s - 63s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9715519
{'0': {'precision': 0.46198999109483374, 'recall': 0.40449630688744076, 'f1-score': 0.4313357191036498, 'support': 455307}, '1': {'precision': 0.6034635142371265, 'recall': 0.6653854788039536, 'f1-score': 0.6329135485208787, 'support': 770639}, '2': {'precision': 0.4515721475214607, 'recall': 0.4290709901450126, 'f1-score': 0.44003410728290804, 'support': 449823}, 'accuracy': 0.5310684229150915, 'macro avg': {'precision': 0.505675217617807, 'recall': 0.4996509252788022, 'f1-score': 0.5014277916358122, 'support': 1675769}, 'weighted avg': {'precision': 0.524253243817105, 'recall': 0.5310684229150915, 'f1-score': 0.5263705788905431, 'support': 1675769}}
[[184170 169267 101870]
 [125334 512772 132533]
 [ 89141 167676 193006]]
Evaluating performance on  train set...
1230/1230 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9710556
{'0': {'precision': 0.46796358677281363, 'recall': 0.44512938776415284, 'f1-score': 0.45626097382193004, 'support': 90194}, '1': {'precision': 0.5994340180494742, 'recall': 0.6285718503864353, 'f1-score': 0.6136572464264223, 'support': 135469}, '2': {'precision': 0.4582101400089735, 'recall': 0.44697947411538935, 'f1-score': 0.452525137760609, 'support': 89107}, 'accuracy': 0.5246020904152238, 'macro avg': {'precision': 0.5085359149437537, 'recall': 0.5068935707553258, 'f1-score': 0.5074811193363205, 'support': 314770}, 'weighted avg': {'precision': 0.5217840508381071, 'recall': 0.5246020904152238, 'f1-score': 0.5229427621421061, 'support': 314770}}
[[40148 28591 21455]
 [24678 85152 25639]
 [20967 28311 39829]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9098392
{'0': {'precision': 0.47012164893414177, 'recall': 0.4313355026066268, 'f1-score': 0.44989416830888257, 'support': 28581}, '1': {'precision': 0.6571623976160623, 'recall': 0.7095362002883364, 'f1-score': 0.6823457802500654, 'support': 56878}, '2': {'precision': 0.46829457364341087, 'recall': 0.4318856121537087, 'f1-score': 0.4493537889353789, 'support': 27975}, 'accuracy': 0.5709663769240263, 'macro avg': {'precision': 0.5318595400645383, 'recall': 0.5242524383495574, 'f1-score': 0.527197912498109, 'support': 113434}, 'weighted avg': {'precision': 0.5634569035515588, 'recall': 0.5709663769240263, 'f1-score': 0.5663166313359894, 'support': 113434}}
[[12328 10501  5752]
 [ 8555 40357  7966]
 [ 5340 10553 12082]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
7633/7633 - 56s - 56s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0036509
{'0': {'precision': 0.4527985475974733, 'recall': 0.4772103089065036, 'f1-score': 0.46468403663096175, 'support': 582215}, '1': {'precision': 0.5667752442996743, 'recall': 0.5698325724916032, 'f1-score': 0.5682997964867046, 'support': 787505}, '2': {'precision': 0.4534231569123874, 'recall': 0.4257669425674519, 'f1-score': 0.43916006634307203, 'support': 584268}, 'accuracy': 0.4991571084366946, 'macro avg': {'precision': 0.49099898293651173, 'recall': 0.49093660798851957, 'f1-score': 0.49071463315357944, 'support': 1953988}, 'weighted avg': {'precision': 0.49892071302104446, 'recall': 0.4991571084366946, 'f1-score': 0.49881172313314703, 'support': 1953988}}
[[277839 159317 145059]
 [183949 448746 154810]
 [151816 183690 248762]]
Evaluating performance on  train set...
1586/1586 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98074657
{'0': {'precision': 0.4578085493513552, 'recall': 0.4987300497683199, 'f1-score': 0.47739397199965505, 'support': 116540}, '1': {'precision': 0.5960959774342389, 'recall': 0.5767898213560937, 'f1-score': 0.5862840059790734, 'support': 170003}, '2': {'precision': 0.4632265510246905, 'recall': 0.44415569173505914, 'f1-score': 0.4534907109811995, 'support': 119287}, 'accuracy': 0.5153882167409999, 'macro avg': {'precision': 0.5057103592700948, 'recall': 0.5065585209531576, 'f1-score': 0.5057228963199759, 'support': 405830}, 'weighted avg': {'precision': 0.5173299617703031, 'recall': 0.5153882167409999, 'f1-score': 0.5159822581034289, 'support': 405830}}
[[58122 30208 28210]
 [38763 98056 33184]
 [30072 36233 52982]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9642811
{'0': {'precision': 0.43913394809392525, 'recall': 0.4723159509202454, 'f1-score': 0.45512094191832114, 'support': 39120}, '1': {'precision': 0.6403900597672224, 'recall': 0.6039247096515818, 'f1-score': 0.6216230658249299, 'support': 67419}, '2': {'precision': 0.451806205875931, 'recall': 0.46169674732249105, 'f1-score': 0.45669793390963154, 'support': 40336}, 'accuracy': 0.5298110638297873, 'macro avg': {'precision': 0.5104434045790263, 'recall': 0.5126458026314394, 'f1-score': 0.5111473138842942, 'support': 146875}, 'weighted avg': {'precision': 0.5349952858491388, 'recall': 0.5298110638297873, 'f1-score': 0.5319823290885077, 'support': 146875}}
[[18477 10945  9698]
 [13805 40716 12898]
 [ 9794 11919 18623]]
testing model on single stock: results/universal/W10/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
22048/22048 - 233s - 233s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2327471
{'0': {'precision': 0.38542599269671174, 'recall': 0.5337085729440214, 'f1-score': 0.44760618135233937, 'support': 2039941}, '1': {'precision': 0.23117872017852428, 'recall': 0.01796826590544384, 'f1-score': 0.033344820109105944, 'support': 1510552}, '2': {'precision': 0.39589275126521795, 'recall': 0.5109274805058334, 'f1-score': 0.44611374750520333, 'support': 2093575}, 'accuracy': 0.38722797103082385, 'macro avg': {'precision': 0.33749915471348463, 'recall': 0.3542014397850995, 'f1-score': 0.3090215829888829, 'support': 5644068}, 'weighted avg': {'precision': 0.34802644649584513, 'recall': 0.38722797103082385, 'f1-score': 0.3361816113542092, 'support': 5644068}}
[[1088734   45867  905340]
 [ 756509   27142  726901]
 [ 979512   44398 1069665]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2981633
{'0': {'precision': 0.3649521670142162, 'recall': 0.569301047314863, 'f1-score': 0.44477802744350736, 'support': 457742}, '1': {'precision': 0.3067413157949508, 'recall': 0.032148575367446565, 'f1-score': 0.058197642162292354, 'support': 458434}, '2': {'precision': 0.3810916645159646, 'recall': 0.5050715763692412, 'f1-score': 0.4344088286622804, 'support': 473620}, 'accuracy': 0.3702291559336766, 'macro avg': {'precision': 0.3509283824417105, 'recall': 0.36884039968385024, 'f1-score': 0.31246149942269336, 'support': 1389796}, 'weighted avg': {'precision': 0.3512509874446429, 'recall': 0.3702291559336766, 'f1-score': 0.3137281091297597, 'support': 1389796}}
[[260593  16243 180906]
 [236112  14738 207584]
 [217342  17066 239212]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.364475
{'0': {'precision': 0.34258451130645395, 'recall': 0.5622862391106176, 'f1-score': 0.4257636935468803, 'support': 145899}, '1': {'precision': 0.35263919354085965, 'recall': 0.040697392587645355, 'f1-score': 0.07297310348157805, 'support': 185663}, '2': {'precision': 0.354505667152957, 'recall': 0.5192137010617666, 'f1-score': 0.4213348271446863, 'support': 152105}, 'accuracy': 0.3485207797927086, 'macro avg': {'precision': 0.3499097906667568, 'recall': 0.37406577758667653, 'f1-score': 0.3066905413910482, 'support': 483667}, 'weighted avg': {'precision': 0.35019315501735176, 'recall': 0.3485207797927086, 'f1-score': 0.2889468091048986, 'support': 483667}}
[[82037  6848 57014]
 [91321  7556 86786]
 [66107  7023 78975]]
training model: results/universal/W10/deepVOL_L3/h10
Epoch 1/50
8543/8543 - 468s - loss: 2.8314 - accuracy10: 0.5124 - val_loss: 3.0314 - val_accuracy10: 0.4956 - 468s/epoch - 55ms/step
Epoch 2/50
8543/8543 - 447s - loss: 2.7583 - accuracy10: 0.5315 - val_loss: 3.2828 - val_accuracy10: 0.4918 - 447s/epoch - 52ms/step
Epoch 3/50
8543/8543 - 446s - loss: 2.7279 - accuracy10: 0.5390 - val_loss: 3.0276 - val_accuracy10: 0.5033 - 446s/epoch - 52ms/step
Epoch 4/50
8543/8543 - 453s - loss: 2.7106 - accuracy10: 0.5434 - val_loss: 3.0080 - val_accuracy10: 0.5104 - 453s/epoch - 53ms/step
Epoch 5/50
8543/8543 - 443s - loss: 2.7004 - accuracy10: 0.5457 - val_loss: 2.8728 - val_accuracy10: 0.5183 - 443s/epoch - 52ms/step
Epoch 6/50
8543/8543 - 440s - loss: 2.6920 - accuracy10: 0.5479 - val_loss: 2.8826 - val_accuracy10: 0.5171 - 440s/epoch - 52ms/step
Epoch 7/50
8543/8543 - 449s - loss: 2.6857 - accuracy10: 0.5493 - val_loss: 2.9126 - val_accuracy10: 0.5147 - 449s/epoch - 53ms/step
Epoch 8/50
8543/8543 - 448s - loss: 2.6804 - accuracy10: 0.5507 - val_loss: 2.9113 - val_accuracy10: 0.5160 - 448s/epoch - 52ms/step
Epoch 9/50
8543/8543 - 438s - loss: 2.6759 - accuracy10: 0.5515 - val_loss: 2.8987 - val_accuracy10: 0.5189 - 438s/epoch - 51ms/step
Epoch 10/50
8543/8543 - 446s - loss: 2.6714 - accuracy10: 0.5527 - val_loss: 2.8684 - val_accuracy10: 0.5246 - 446s/epoch - 52ms/step
Epoch 11/50
8543/8543 - 444s - loss: 2.6671 - accuracy10: 0.5533 - val_loss: 2.8366 - val_accuracy10: 0.5244 - 444s/epoch - 52ms/step
Epoch 12/50
8543/8543 - 463s - loss: 2.6637 - accuracy10: 0.5543 - val_loss: 2.7943 - val_accuracy10: 0.5311 - 463s/epoch - 54ms/step
Epoch 13/50
8543/8543 - 449s - loss: 2.6605 - accuracy10: 0.5550 - val_loss: 2.7763 - val_accuracy10: 0.5347 - 449s/epoch - 53ms/step
Epoch 14/50
8543/8543 - 449s - loss: 2.6572 - accuracy10: 0.5558 - val_loss: 2.7655 - val_accuracy10: 0.5363 - 449s/epoch - 53ms/step
Epoch 15/50
8543/8543 - 449s - loss: 2.6544 - accuracy10: 0.5564 - val_loss: 2.7757 - val_accuracy10: 0.5338 - 449s/epoch - 53ms/step
Epoch 16/50
8543/8543 - 443s - loss: 2.6516 - accuracy10: 0.5571 - val_loss: 2.7668 - val_accuracy10: 0.5346 - 443s/epoch - 52ms/step
Epoch 17/50
8543/8543 - 451s - loss: 2.6489 - accuracy10: 0.5577 - val_loss: 2.7592 - val_accuracy10: 0.5364 - 451s/epoch - 53ms/step
Epoch 18/50
8543/8543 - 453s - loss: 2.6460 - accuracy10: 0.5583 - val_loss: 2.7674 - val_accuracy10: 0.5338 - 453s/epoch - 53ms/step
Epoch 19/50
8543/8543 - 443s - loss: 2.6439 - accuracy10: 0.5589 - val_loss: 2.7804 - val_accuracy10: 0.5345 - 443s/epoch - 52ms/step
Epoch 20/50
8543/8543 - 450s - loss: 2.6420 - accuracy10: 0.5593 - val_loss: 2.7582 - val_accuracy10: 0.5347 - 450s/epoch - 53ms/step
Epoch 21/50
8543/8543 - 446s - loss: 2.6397 - accuracy10: 0.5597 - val_loss: 2.7374 - val_accuracy10: 0.5378 - 446s/epoch - 52ms/step
Epoch 22/50
8543/8543 - 455s - loss: 2.6376 - accuracy10: 0.5605 - val_loss: 2.7381 - val_accuracy10: 0.5373 - 455s/epoch - 53ms/step
Epoch 23/50
8543/8543 - 443s - loss: 2.6358 - accuracy10: 0.5609 - val_loss: 2.7242 - val_accuracy10: 0.5400 - 443s/epoch - 52ms/step
Epoch 24/50
8543/8543 - 445s - loss: 2.6337 - accuracy10: 0.5612 - val_loss: 2.7458 - val_accuracy10: 0.5361 - 445s/epoch - 52ms/step
Epoch 25/50
8543/8543 - 442s - loss: 2.6318 - accuracy10: 0.5618 - val_loss: 2.7315 - val_accuracy10: 0.5376 - 442s/epoch - 52ms/step
Epoch 26/50
8543/8543 - 449s - loss: 2.6302 - accuracy10: 0.5622 - val_loss: 2.7272 - val_accuracy10: 0.5381 - 449s/epoch - 53ms/step
Epoch 27/50
8543/8543 - 449s - loss: 2.6285 - accuracy10: 0.5625 - val_loss: 2.7225 - val_accuracy10: 0.5372 - 449s/epoch - 53ms/step
Epoch 28/50
8543/8543 - 455s - loss: 2.6270 - accuracy10: 0.5628 - val_loss: 2.7203 - val_accuracy10: 0.5371 - 455s/epoch - 53ms/step
Epoch 29/50
8543/8543 - 451s - loss: 2.6259 - accuracy10: 0.5631 - val_loss: 2.7359 - val_accuracy10: 0.5378 - 451s/epoch - 53ms/step
Epoch 30/50
8543/8543 - 462s - loss: 2.6242 - accuracy10: 0.5637 - val_loss: 2.7451 - val_accuracy10: 0.5365 - 462s/epoch - 54ms/step
Epoch 31/50
8543/8543 - 447s - loss: 2.6228 - accuracy10: 0.5639 - val_loss: 2.7113 - val_accuracy10: 0.5393 - 447s/epoch - 52ms/step
Epoch 32/50
8543/8543 - 442s - loss: 2.6218 - accuracy10: 0.5642 - val_loss: 2.7106 - val_accuracy10: 0.5397 - 442s/epoch - 52ms/step
Epoch 33/50
8543/8543 - 446s - loss: 2.6202 - accuracy10: 0.5644 - val_loss: 2.7097 - val_accuracy10: 0.5394 - 446s/epoch - 52ms/step
Epoch 34/50
8543/8543 - 449s - loss: 2.6191 - accuracy10: 0.5650 - val_loss: 2.7165 - val_accuracy10: 0.5391 - 449s/epoch - 53ms/step
Epoch 35/50
8543/8543 - 451s - loss: 2.6178 - accuracy10: 0.5653 - val_loss: 2.7297 - val_accuracy10: 0.5377 - 451s/epoch - 53ms/step
Epoch 36/50
8543/8543 - 443s - loss: 2.6168 - accuracy10: 0.5656 - val_loss: 2.7127 - val_accuracy10: 0.5394 - 443s/epoch - 52ms/step
Epoch 37/50
8543/8543 - 455s - loss: 2.6153 - accuracy10: 0.5656 - val_loss: 2.7219 - val_accuracy10: 0.5372 - 455s/epoch - 53ms/step
Epoch 38/50
8543/8543 - 442s - loss: 2.6143 - accuracy10: 0.5660 - val_loss: 2.7170 - val_accuracy10: 0.5361 - 442s/epoch - 52ms/step
Epoch 39/50
8543/8543 - 443s - loss: 2.6130 - accuracy10: 0.5662 - val_loss: 2.7305 - val_accuracy10: 0.5359 - 443s/epoch - 52ms/step
Epoch 40/50
8543/8543 - 441s - loss: 2.6124 - accuracy10: 0.5663 - val_loss: 2.7218 - val_accuracy10: 0.5370 - 441s/epoch - 52ms/step
Epoch 41/50
8543/8543 - 446s - loss: 2.6112 - accuracy10: 0.5669 - val_loss: 2.7354 - val_accuracy10: 0.5340 - 446s/epoch - 52ms/step
Epoch 42/50
8543/8543 - 442s - loss: 2.6102 - accuracy10: 0.5669 - val_loss: 2.7283 - val_accuracy10: 0.5367 - 442s/epoch - 52ms/step
Epoch 43/50
8543/8543 - 443s - loss: 2.6092 - accuracy10: 0.5671 - val_loss: 2.7105 - val_accuracy10: 0.5368 - 443s/epoch - 52ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1050s - 1050s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91458774
{'0': {'precision': 0.4555234489367581, 'recall': 0.5559006556543145, 'f1-score': 0.5007311626851919, 'support': 2787597}, '1': {'precision': 0.801249128027951, 'recall': 0.5428955548675396, 'f1-score': 0.6472437014902632, 'support': 3943707}, '2': {'precision': 0.4532625244323837, 'recall': 0.5591439156353557, 'f1-score': 0.5006664768053661, 'support': 2813975}, 'accuracy': 0.5514836182368268, 'macro avg': {'precision': 0.5700117004656976, 'recall': 0.55264670871907, 'f1-score': 0.5495471136602738, 'support': 9545279}, 'weighted avg': {'precision': 0.5976962021563857, 'recall': 0.5514836182368268, 'f1-score': 0.5612448994156373, 'support': 9545279}}
[[1549627  277913  960057]
 [ 864845 2141021  937841]
 [ 987388  253170 1573417]]
Evaluating performance on  train set...
8543/8543 - 251s - 251s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9245882
{'0': {'precision': 0.4274639704702295, 'recall': 0.5746445374931393, 'f1-score': 0.49024598365115396, 'support': 579386}, '1': {'precision': 0.8103803903096207, 'recall': 0.49290908788663146, 'f1-score': 0.6129779541864426, 'support': 1022647}, '2': {'precision': 0.42754502905223296, 'recall': 0.574625397862446, 'f1-score': 0.4902923211965155, 'support': 584687}, 'accuracy': 0.5364148130533402, 'macro avg': {'precision': 0.5551297966106944, 'recall': 0.5473930077474056, 'f1-score': 0.531172086344704, 'support': 2186720}, 'weighted avg': {'precision': 0.6065613043303624, 'recall': 0.5364148130533402, 'f1-score': 0.5476555168480818, 'support': 2186720}}
[[332941  61550 184895]
 [253620 504072 264955]
 [192314  56397 335976]]
Evaluating performance on  val set...
3077/3077 - 84s - 84s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.917326
{'0': {'precision': 0.41518252940761874, 'recall': 0.5718650684161583, 'f1-score': 0.48108801664349105, 'support': 195714}, '1': {'precision': 0.8160981137324045, 'recall': 0.5065806012559388, 'f1-score': 0.6251245573904052, 'support': 393809}, '2': {'precision': 0.4154969056753103, 'recall': 0.574394691520616, 'f1-score': 0.48219263127233764, 'support': 197420}, 'accuracy': 0.5398294412683002, 'macro avg': {'precision': 0.5489258496051111, 'recall': 0.5509467870642377, 'f1-score': 0.5294684017687447, 'support': 786943}, 'weighted avg': {'precision': 0.6158911315682927, 'recall': 0.5398294412683002, 'f1-score': 0.553445174779504, 'support': 786943}}
[[111922  23556  60236]
 [ 95027 199496  99286]
 [ 62624  21399 113397]]
testing model out of sample: results/universal/W10/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 597s - 597s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7107319
{'0': {'precision': 0.5109946163149066, 'recall': 0.48674427700405887, 'f1-score': 0.498574740819794, 'support': 1076403}, '1': {'precision': 0.8133321531096097, 'recall': 0.804631844041019, 'f1-score': 0.8089586064052714, 'support': 3311640}, '2': {'precision': 0.4775426477489165, 'recall': 0.51605211250275, 'f1-score': 0.49605111065313034, 'support': 1072756}, 'accuracy': 0.6852810367127594, 'macro avg': {'precision': 0.6006231390578108, 'recall': 0.6024760778492759, 'f1-score': 0.6011948192927319, 'support': 5460799}, 'weighted avg': {'precision': 0.6877722784042517, 'recall': 0.6852810367127594, 'f1-score': 0.6863077786452881, 'support': 5460799}}
[[ 523933  316476  235994]
 [ 277317 2664651  369672]
 [ 224070  295088  553598]]
Evaluating performance on  train set...
4055/4055 - 115s - 115s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7117503
{'0': {'precision': 0.4881494131980964, 'recall': 0.4881265391764332, 'f1-score': 0.4881379759192971, 'support': 192067}, '1': {'precision': 0.8249433938972611, 'recall': 0.7799665212850913, 'f1-score': 0.8018247293612816, 'support': 651160}, '2': {'precision': 0.45810048571577794, 'recall': 0.5418449135920681, 'f1-score': 0.4964659435824508, 'support': 194253}, 'accuracy': 0.6813538574237575, 'macro avg': {'precision': 0.5903977642703785, 'recall': 0.6033126580178642, 'f1-score': 0.5954762162876764, 'support': 1037480}, 'weighted avg': {'precision': 0.6939072824214504, 'recall': 0.6813538574237575, 'f1-score': 0.6865784268906443, 'support': 1037480}}
[[ 93753  55217  43097]
 [ 61865 507883  81412]
 [ 36440  52558 105255]]
Evaluating performance on  val set...
1545/1545 - 49s - 49s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7189521
{'0': {'precision': 0.47427729498915433, 'recall': 0.48545655118484077, 'f1-score': 0.47980181348937995, 'support': 71613}, '1': {'precision': 0.8298938806524311, 'recall': 0.7683621464974518, 'f1-score': 0.7979435493077017, 'support': 250175}, '2': {'precision': 0.442430371868679, 'recall': 0.5444561456296073, 'f1-score': 0.4881694717802507, 'support': 73117}, 'accuracy': 0.6756029931249288, 'macro avg': {'precision': 0.5822005158367548, 'recall': 0.5994249477706334, 'f1-score': 0.5886382781924441, 'support': 394905}, 'weighted avg': {'precision': 0.6936663324551535, 'recall': 0.6756029931249288, 'f1-score': 0.6828960433157996, 'support': 394905}}
[[ 34765  20325  16523]
 [ 24304 192225  33646]
 [ 14232  19076  39809]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0117676
{'0': {'precision': 0.5143825140206898, 'recall': 0.6149913481201825, 'f1-score': 0.5602056260579086, 'support': 50856}, '1': {'precision': 0.4948552891682295, 'recall': 0.2793019596624231, 'f1-score': 0.3570697096042718, 'support': 34955}, '2': {'precision': 0.4849648604017051, 'recall': 0.5396696510609201, 'f1-score': 0.510856923248076, 'support': 46799}, 'accuracy': 0.4999245909056632, 'macro avg': {'precision': 0.4980675545302082, 'recall': 0.4779876529478419, 'f1-score': 0.47604408630341877, 'support': 132610}, 'weighted avg': {'precision': 0.49885358772227634, 'recall': 0.4999245909056632, 'f1-score': 0.48924502050452473, 'support': 132610}}
[[31276  4961 14619]
 [12989  9763 12203]
 [16538  5005 25256]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99196583
{'0': {'precision': 0.4862317227046686, 'recall': 0.5890657314989659, 'f1-score': 0.532731560543222, 'support': 11121}, '1': {'precision': 0.5819870759289176, 'recall': 0.3754233608336952, 'f1-score': 0.45642189727075966, 'support': 11515}, '2': {'precision': 0.49254954552227687, 'recall': 0.5656712586634722, 'f1-score': 0.5265840933529811, 'support': 11687}, 'accuracy': 0.509425166797774, 'macro avg': {'precision': 0.520256114718621, 'recall': 0.5100534503320445, 'f1-score': 0.5052458503889876, 'support': 34323}, 'weighted avg': {'precision': 0.5205078433131998, 'recall': 0.509425166797774, 'f1-score': 0.5050372674559408, 'support': 34323}}
[[6551 1377 3193]
 [3574 4323 3618]
 [3348 1728 6611]]
Evaluating performance on  val set...
46/46 - 1s - 924ms/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9872156
{'0': {'precision': 0.48001747106355097, 'recall': 0.5808668076109936, 'f1-score': 0.5256486906612461, 'support': 3784}, '1': {'precision': 0.5948002536461636, 'recall': 0.458791880655417, 'f1-score': 0.5180173961065857, 'support': 4089}, '2': {'precision': 0.4986072423398329, 'recall': 0.5169335783670255, 'f1-score': 0.5076050528486724, 'support': 3809}, 'accuracy': 0.5172915596644411, 'macro avg': {'precision': 0.5244749890165158, 'recall': 0.5188640888778121, 'f1-score': 0.5170903798721681, 'support': 11682}, 'weighted avg': {'precision': 0.5262557210868056, 'recall': 0.5172915596644411, 'f1-score': 0.5170942838933896, 'support': 11682}}
[[2198  638  948]
 [1181 1876 1032]
 [1200  640 1969]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45711356
{'0': {'precision': 0.4787399047975611, 'recall': 0.4442955352046261, 'f1-score': 0.4608750498796453, 'support': 40293}, '1': {'precision': 0.9160025346061315, 'recall': 0.9111000089671163, 'f1-score': 0.9135446944990694, 'support': 390315}, '2': {'precision': 0.4467991267338523, 'recall': 0.502019376099507, 'f1-score': 0.47280237089585325, 'support': 40359}, 'accuracy': 0.8361074130459246, 'macro avg': {'precision': 0.6138471887125149, 'recall': 0.6191383067570831, 'f1-score': 0.6157407050915227, 'support': 470967}, 'weighted avg': {'precision': 0.8383851994612189, 'recall': 0.8361074130459246, 'f1-score': 0.837048172600608, 'support': 470967}}
[[ 17902  16779   5612]
 [ 15225 355616  19474]
 [  4267  15831  20261]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.33309054
{'0': {'precision': 0.507395407803916, 'recall': 0.4678529679179114, 'f1-score': 0.4868225435869712, 'support': 7699}, '1': {'precision': 0.9508099134750821, 'recall': 0.946327094303095, 'f1-score': 0.9485632075747881, 'support': 119837}, '2': {'precision': 0.47807308970099666, 'recall': 0.5488874761602034, 'f1-score': 0.5110387688665285, 'support': 7865}, 'accuracy': 0.8960347412500647, 'macro avg': {'precision': 0.6454261369933315, 'recall': 0.65435584612707, 'f1-score': 0.6488081733427625, 'support': 135401}, 'weighted avg': {'precision': 0.8981373084120067, 'recall': 0.8960347412500647, 'f1-score': 0.8968939356899227, 'support': 135401}}
[[  3602   3065   1032]
 [  2751 113405   3681]
 [   746   2802   4317]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.3956907
{'0': {'precision': 0.4998518518518518, 'recall': 0.43920853944285343, 'f1-score': 0.46757206208425717, 'support': 3841}, '1': {'precision': 0.9319567965579187, 'recall': 0.9286203619809507, 'f1-score': 0.9302855877794997, 'support': 45251}, '2': {'precision': 0.46253789519272415, 'recall': 0.5353383458646617, 'f1-score': 0.49628252788104094, 'support': 3990}, 'accuracy': 0.8636449267171545, 'macro avg': {'precision': 0.6314488478674982, 'recall': 0.6343890824294885, 'f1-score': 0.6313800592482659, 'support': 53082}, 'weighted avg': {'precision': 0.8654051122004505, 'recall': 0.8636449267171545, 'f1-score': 0.8641811670494918, 'support': 53082}}
[[ 1687  1588   566]
 [ 1314 42021  1916]
 [  374  1480  2136]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
967/967 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0987395
{'0': {'precision': 0.45348789713174686, 'recall': 0.6198052745584065, 'f1-score': 0.5237603257049314, 'support': 89562}, '1': {'precision': 0.40748674556846787, 'recall': 0.1098027331630518, 'f1-score': 0.17299079231556214, 'support': 69297}, '2': {'precision': 0.45161896352517916, 'recall': 0.5421515561569689, 'f1-score': 0.49276149576963874, 'support': 88680}, 'accuracy': 0.44921406323852, 'macro avg': {'precision': 0.43753120207513135, 'recall': 0.4239198546261424, 'f1-score': 0.3965042045967107, 'support': 247539}, 'weighted avg': {'precision': 0.4399406224311503, 'recall': 0.44921406323852, 'f1-score': 0.4144593565891764, 'support': 247539}}
[[55511  5266 28785]
 [32094  7609 29594]
 [34804  5798 48078]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.077957
{'0': {'precision': 0.44539486771434256, 'recall': 0.5963669294694225, 'f1-score': 0.5099414671920196, 'support': 18772}, '1': {'precision': 0.52428810720268, 'recall': 0.2541684711996535, 'f1-score': 0.3423633645677617, 'support': 18472}, '2': {'precision': 0.455152198421646, 'recall': 0.5306240471058304, 'f1-score': 0.48999902903194487, 'support': 19021}, 'accuracy': 0.4617968541722207, 'macro avg': {'precision': 0.4749450577795562, 'recall': 0.46038648259163545, 'f1-score': 0.44743462026390873, 'support': 56265}, 'weighted avg': {'precision': 0.47459437197475646, 'recall': 0.4617968541722207, 'f1-score': 0.4481832191174071, 'support': 56265}}
[[11195  2004  5573]
 [ 7268  4695  6509]
 [ 6672  2256 10093]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0873245
{'0': {'precision': 0.4552015671718734, 'recall': 0.6274872086412735, 'f1-score': 0.5276366895727518, 'support': 7036}, '1': {'precision': 0.4539440203562341, 'recall': 0.14579928081072246, 'f1-score': 0.22071013237659282, 'support': 6118}, '2': {'precision': 0.4588967332774919, 'recall': 0.5584680355322558, 'f1-score': 0.503809774040988, 'support': 6867}, 'accuracy': 0.4566205484241546, 'macro avg': {'precision': 0.4560141069351998, 'recall': 0.44391817499475056, 'f1-score': 0.41738553199677747, 'support': 20021}, 'weighted avg': {'precision': 0.45608469160268106, 'recall': 0.4566205484241546, 'f1-score': 0.42567394516024887, 'support': 20021}}
[[4415  508 2113]
 [2817  892 2409]
 [2467  565 3835]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1947613
{'0': {'precision': 0.349360907232265, 'recall': 0.16947556189796648, 'f1-score': 0.22823428799300463, 'support': 140150}, '1': {'precision': 0.3172898525209572, 'recall': 0.18536041203509576, 'f1-score': 0.23401152628372235, 'support': 126397}, '2': {'precision': 0.34756747763349943, 'recall': 0.6577762829274576, 'f1-score': 0.4548128758996232, 'support': 139739}, 'accuracy': 0.3423647381401279, 'macro avg': {'precision': 0.3380727457955739, 'recall': 0.3375374189535066, 'f1-score': 0.3056862300587834, 'support': 406286}, 'weighted avg': {'precision': 0.3387666530343672, 'recall': 0.3423647381401279, 'f1-score': 0.3079616004864571, 'support': 406286}}
[[23752 25534 90864]
 [21291 23429 81677]
 [22944 24878 91917]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1844102
{'0': {'precision': 0.3662308809706913, 'recall': 0.16461822092487324, 'f1-score': 0.2271390338906701, 'support': 26036}, '1': {'precision': 0.3424240172400981, 'recall': 0.18521644760641504, 'f1-score': 0.2404006677796327, 'support': 24879}, '2': {'precision': 0.328174051261673, 'recall': 0.6721057985757884, 'f1-score': 0.4410119484680596, 'support': 24575}, 'accuracy': 0.33661412107563915, 'macro avg': {'precision': 0.3456096498241541, 'recall': 0.3406468223690256, 'f1-score': 0.30285055004612077, 'support': 75490}, 'weighted avg': {'precision': 0.34599591537455193, 'recall': 0.33661412107563915, 'f1-score': 0.3011337757804945, 'support': 75490}}
[[ 4286  4623 17127]
 [ 3585  4608 16686]
 [ 3832  4226 16517]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1773999
{'0': {'precision': 0.36799854041233354, 'recall': 0.17836929607357624, 'f1-score': 0.2402763714336768, 'support': 11308}, '1': {'precision': 0.37691118364542175, 'recall': 0.19046792256272246, 'f1-score': 0.2530565167243368, 'support': 11519}, '2': {'precision': 0.3198802829675313, 'recall': 0.6700864443811152, 'f1-score': 0.4330396881426686, 'support': 10527}, 'accuracy': 0.33774060082748697, 'macro avg': {'precision': 0.35493000234176225, 'recall': 0.3463078876724713, 'f1-score': 0.3087908587668941, 'support': 33354}, 'weighted avg': {'precision': 0.355889763092687, 'recall': 0.33774060082748697, 'f1-score': 0.30552893270364945, 'support': 33354}}
[[2017 1897 7394]
 [1721 2194 7604]
 [1743 1730 7054]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0238699
{'0': {'precision': 0.5083003657535269, 'recall': 0.6194183941712071, 'f1-score': 0.5583849582012816, 'support': 219874}, '1': {'precision': 0.3371216725416312, 'recall': 0.16416909189562473, 'f1-score': 0.22080980846165585, 'support': 101365}, '2': {'precision': 0.5180580224985198, 'recall': 0.5274431488758616, 'f1-score': 0.52270846206288, 'support': 217322}, 'accuracy': 0.4966196958190437, 'macro avg': {'precision': 0.4544933535978926, 'recall': 0.43701021164756454, 'f1-score': 0.4339677429086059, 'support': 538561}, 'weighted avg': {'precision': 0.4800194936549374, 'recall': 0.4966196958190437, 'f1-score': 0.4804521102097878, 'support': 538561}}
[[136194  15987  67693]
 [ 45783  16641  38941]
 [ 85963  16734 114625]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0621212
{'0': {'precision': 0.4598688483375584, 'recall': 0.6053669433795748, 'f1-score': 0.5226812715799501, 'support': 36259}, '1': {'precision': 0.5574296589297709, 'recall': 0.20653135715075766, 'f1-score': 0.30139418517845973, 'support': 36164}, '2': {'precision': 0.45260937887685054, 'recall': 0.5904885220253028, 'f1-score': 0.5124363551237783, 'support': 37071}, 'accuracy': 0.4686010192339306, 'macro avg': {'precision': 0.4899692953813933, 'recall': 0.4674622741852117, 'f1-score': 0.44550393729406274, 'support': 109494}, 'weighted avg': {'precision': 0.4896337063378038, 'recall': 0.4686010192339306, 'f1-score': 0.44612533709431396, 'support': 109494}}
[[21950  2794 11515]
 [13736  7469 14959]
 [12045  3136 21890]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0644155
{'0': {'precision': 0.4507210106066023, 'recall': 0.621886047850037, 'f1-score': 0.5226463983416826, 'support': 12163}, '1': {'precision': 0.5396870554765292, 'recall': 0.16757950530035334, 'f1-score': 0.25574654533198515, 'support': 11320}, '2': {'precision': 0.4602330942622951, 'recall': 0.5781979082864038, 'f1-score': 0.5125151536761036, 'support': 12430}, 'accuracy': 0.4635647258652856, 'macro avg': {'precision': 0.48354705344847554, 'recall': 0.4558878204789314, 'f1-score': 0.4303026991165904, 'support': 35913}, 'weighted avg': {'precision': 0.48205592631311067, 'recall': 0.4635647258652856, 'f1-score': 0.4350113439807848, 'support': 35913}}
[[7564  799 3800]
 [4794 1897 4629]
 [4424  819 7187]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
5267/5267 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5102369
{'0': {'precision': 0.5282849810795529, 'recall': 0.4011506932563562, 'f1-score': 0.45602270764655967, 'support': 151387}, '1': {'precision': 0.8771543084290881, 'recall': 0.8927157962326313, 'f1-score': 0.8848666405581477, 'support': 1046566}, '2': {'precision': 0.4457260813439539, 'recall': 0.49872866689741474, 'f1-score': 0.4707401276006245, 'support': 150236}, 'accuracy': 0.7936142484473616, 'macro avg': {'precision': 0.6170551236175316, 'recall': 0.5975317187954674, 'f1-score': 0.6038764919351106, 'support': 1348189}, 'weighted avg': {'precision': 0.789903684085004, 'recall': 0.7936142484473616, 'f1-score': 0.7905637592318847, 'support': 1348189}}
[[ 60729  68106  22552]
 [ 41658 934286  70622]
 [ 12568  62741  74927]]
Evaluating performance on  train set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4097356
{'0': {'precision': 0.5018810743024349, 'recall': 0.4366306027820711, 'f1-score': 0.46698755348113574, 'support': 21998}, '1': {'precision': 0.9199961184576162, 'recall': 0.9195742842278831, 'f1-score': 0.9197851529770777, 'support': 226818}, '2': {'precision': 0.4693243083703908, 'recall': 0.5312959415512095, 'f1-score': 0.4983910735927118, 'support': 22447}, 'accuracy': 0.8482800824292291, 'macro avg': {'precision': 0.6304005003768139, 'recall': 0.6291669428537213, 'f1-score': 0.6283879266836417, 'support': 271263}, 'weighted avg': {'precision': 0.8487961211769195, 'recall': 0.8482800824292291, 'f1-score': 0.8481953139881534, 'support': 271263}}
[[  9605   9551   2842]
 [  7599 208576  10643]
 [  1934   8587  11926]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40660608
{'0': {'precision': 0.5110983817843334, 'recall': 0.44645984488366275, 'f1-score': 0.4765974494224478, 'support': 7994}, '1': {'precision': 0.9257550770934001, 'recall': 0.9187410586552217, 'f1-score': 0.922234731859749, 'support': 87375}, '2': {'precision': 0.4423274974253347, 'recall': 0.5344033843473933, 'f1-score': 0.4840254690933679, 'support': 8037}, 'accuracy': 0.8523586639073167, 'macro avg': {'precision': 0.6263936521010227, 'recall': 0.6332014292954259, 'f1-score': 0.627619216791855, 'support': 103406}, 'weighted avg': {'precision': 0.8561259155351452, 'recall': 0.8523586639073167, 'f1-score': 0.8537250488562754, 'support': 103406}}
[[ 3569  3413  1012]
 [ 2697 80275  4403]
 [  717  3025  4295]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
10110/10110 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5108026
{'0': {'precision': 0.5687610725838903, 'recall': 0.3745177996868494, 'f1-score': 0.45163981026920025, 'support': 290595}, '1': {'precision': 0.8747092707001898, 'recall': 0.9114560236511456, 'f1-score': 0.8927046519652836, 'support': 2002440}, '2': {'precision': 0.47925928552776226, 'recall': 0.5038194844543255, 'f1-score': 0.4912325919904568, 'support': 295066}, 'accuracy': 0.8046938662749251, 'macro avg': {'precision': 0.6409098762706141, 'recall': 0.5965977692641068, 'f1-score': 0.6118590180749802, 'support': 2588101}, 'weighted avg': {'precision': 0.7952723159768257, 'recall': 0.8046938662749251, 'f1-score': 0.7974100740020568, 'support': 2588101}}
[[ 108833  138368   43394]
 [  59171 1825136  118133]
 [  23347  123059  148660]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47828472
{'0': {'precision': 0.5500581047293728, 'recall': 0.36635706914344685, 'f1-score': 0.43979558796615653, 'support': 42636}, '1': {'precision': 0.8945433463893327, 'recall': 0.9132444480373249, 'f1-score': 0.9037971681603042, 'support': 346364}, '2': {'precision': 0.4551708832667554, 'recall': 0.5299990603270062, 'f1-score': 0.4897432001215621, 'support': 42568}, 'accuracy': 0.8214140065991918, 'macro avg': {'precision': 0.6332574447951537, 'recall': 0.6032001925025926, 'f1-score': 0.6111119854160075, 'support': 431568}, 'weighted avg': {'precision': 0.8171727355618017, 'recall': 0.8214140065991918, 'f1-score': 0.8171164580876601, 'support': 431568}}
[[ 15620  20278   6738]
 [  9782 316315  20267]
 [  2995  17012  22561]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55369025
{'0': {'precision': 0.4916819642037632, 'recall': 0.4037972298124941, 'f1-score': 0.4434269750116406, 'support': 21226}, '1': {'precision': 0.8782435713658836, 'recall': 0.8756882105432032, 'f1-score': 0.8769640294599854, 'support': 137131}, '2': {'precision': 0.43961904761904763, 'recall': 0.5231899170331414, 'f1-score': 0.47777754776740433, 'support': 22057}, 'accuracy': 0.777073841276176, 'macro avg': {'precision': 0.6031815277295648, 'recall': 0.6008917857962796, 'f1-score': 0.5993895174130102, 'support': 180414}, 'weighted avg': {'precision': 0.779138746940356, 'recall': 0.777073841276176, 'f1-score': 0.7771540715608544, 'support': 180414}}
[[  8571   8724   3931]
 [  6268 120084  10779]
 [  2593   7924  11540]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
6546/6546 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75815153
{'0': {'precision': 0.47270032806941525, 'recall': 0.4202999899636425, 'f1-score': 0.444962760105156, 'support': 308877}, '1': {'precision': 0.7727776304086632, 'recall': 0.7467215493812501, 'f1-score': 0.7595261875504418, 'support': 1061172}, '2': {'precision': 0.42498003938893913, 'recall': 0.5223145361768939, 'f1-score': 0.4686467290816776, 'support': 305720}, 'accuracy': 0.6456158336859078, 'macro avg': {'precision': 0.5568193326223392, 'recall': 0.5631120251739289, 'f1-score': 0.5577118922457585, 'support': 1675769}, 'weighted avg': {'precision': 0.6540168367424777, 'recall': 0.6456158336859078, 'f1-score': 0.6484792139985451, 'support': 1675769}}
[[129821 123324  55732]
 [108446 792400 160326]
 [ 36370 109668 159682]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76415014
{'0': {'precision': 0.49307307022841107, 'recall': 0.445116085171883, 'f1-score': 0.46786888008763794, 'support': 62368}, '1': {'precision': 0.7717250394313246, 'recall': 0.7486820730493109, 'f1-score': 0.7600289390949085, 'support': 190830}, '2': {'precision': 0.44197938256790664, 'recall': 0.5264243487299421, 'f1-score': 0.48052005811367743, 'support': 61572}, 'accuracy': 0.6450582965339772, 'macro avg': {'precision': 0.5689258307425474, 'recall': 0.5734075023170453, 'f1-score': 0.569472625765408, 'support': 314770}, 'weighted avg': {'precision': 0.6520120248503871, 'recall': 0.6450582965339772, 'f1-score': 0.6474662444926852, 'support': 314770}}
[[ 27761  21890  12717]
 [ 19753 142871  28206]
 [  8788  20371  32413]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6844283
{'0': {'precision': 0.4959981440668136, 'recall': 0.4388116373338807, 'f1-score': 0.4656557131578231, 'support': 19489}, '1': {'precision': 0.8067059042850675, 'recall': 0.8067918497802636, 'f1-score': 0.8067488747436545, 'support': 75090}, '2': {'precision': 0.4633071015454632, 'recall': 0.5183240519756033, 'f1-score': 0.48927382412576037, 'support': 18855}, 'accuracy': 0.6956203607384029, 'macro avg': {'precision': 0.5886703832991147, 'recall': 0.5879758463632493, 'f1-score': 0.5872261373424127, 'support': 113434}, 'weighted avg': {'precision': 0.6962437151305918, 'recall': 0.6956203607384029, 'f1-score': 0.6953752415688863, 'support': 113434}}
[[ 8552  7650  3287]
 [ 6474 60582  8034]
 [ 2216  6866  9773]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
7633/7633 - 108s - 108s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8196063
{'0': {'precision': 0.5016631875940261, 'recall': 0.45295594055217664, 'f1-score': 0.47606697640413087, 'support': 425516}, '1': {'precision': 0.7311845427957817, 'recall': 0.729919725113562, 'f1-score': 0.7305515865044301, 'support': 1103583}, '2': {'precision': 0.4620902689954541, 'recall': 0.5090976702150444, 'f1-score': 0.48445634439379126, 'support': 424889}, 'accuracy': 0.621588771271881, 'macro avg': {'precision': 0.5649793331284206, 'recall': 0.5639911119602611, 'f1-score': 0.5636916357674507, 'support': 1953988}, 'weighted avg': {'precision': 0.622688377066628, 'recall': 0.621588771271881, 'f1-score': 0.6216202958943619, 'support': 1953988}}
[[192740 151793  80983]
 [127237 805527 170819]
 [ 64225 144354 216310]]
Evaluating performance on  train set...
1586/1586 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7912037
{'0': {'precision': 0.4983874519149818, 'recall': 0.462049256114987, 'f1-score': 0.47953092481587184, 'support': 83279}, '1': {'precision': 0.7538027029005162, 'recall': 0.7336629721971967, 'f1-score': 0.7435964953261105, 'support': 238645}, '2': {'precision': 0.45662868173609816, 'recall': 0.5243725120968703, 'f1-score': 0.488161544435815, 'support': 83906}, 'accuracy': 0.6346549047630782, 'macro avg': {'precision': 0.5696062788505319, 'recall': 0.5733615801363513, 'f1-score': 0.5704296548592658, 'support': 405830}, 'weighted avg': {'precision': 0.639948601166672, 'recall': 0.6346549047630782, 'f1-score': 0.6365969101896659, 'support': 405830}}
[[ 38479  28624  16176]
 [ 27380 175085  36180]
 [ 11348  28560  43998]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7662351
{'0': {'precision': 0.4835367073414683, 'recall': 0.44103050649540215, 'f1-score': 0.46130651348308177, 'support': 27404}, '1': {'precision': 0.7830938764123309, 'recall': 0.7361255285903165, 'f1-score': 0.758883663296629, 'support': 91517}, '2': {'precision': 0.4268102197924802, 'recall': 0.5473992988481076, 'f1-score': 0.4796414130332571, 'support': 27954}, 'accuracy': 0.6451472340425531, 'macro avg': {'precision': 0.5644802678487598, 'recall': 0.5748517779779421, 'f1-score': 0.5666105299376559, 'support': 146875}, 'weighted avg': {'precision': 0.6593926474872638, 'recall': 0.6451472340425531, 'f1-score': 0.6502147810678444, 'support': 146875}}
[[12086  9572  5746]
 [ 9345 67368 14804]
 [ 3564  9088 15302]]
testing model on single stock: results/universal/W10/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
22048/22048 - 310s - 310s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0756284
{'0': {'precision': 0.45312881092972496, 'recall': 0.6135461062280787, 'f1-score': 0.5212748759602875, 'support': 2146890}, '1': {'precision': 0.2940930178030113, 'recall': 0.026621045027617817, 'f1-score': 0.04882270144403705, 'support': 1319257}, '2': {'precision': 0.46852426639263633, 'recall': 0.563134750984999, 'f1-score': 0.5114912808228148, 'support': 2177921}, 'accuracy': 0.4569043108623071, 'macro avg': {'precision': 0.40524869837512423, 'recall': 0.4011006340802319, 'f1-score': 0.36052961940904654, 'support': 5644068}, 'weighted avg': {'precision': 0.4218961968691344, 'recall': 0.4569043108623071, 'f1-score': 0.40706758155823836, 'support': 5644068}}
[[1317216   44072  785602]
 [ 678487   35120  605650]
 [ 911232   40226 1226463]]
Evaluating performance on  train set...
5429/5429 - 92s - 92s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1049252
{'0': {'precision': 0.41985216411418164, 'recall': 0.6235494325633827, 'f1-score': 0.5018174776184632, 'support': 461285}, '1': {'precision': 0.4454208162468268, 'recall': 0.07433470278068058, 'f1-score': 0.1274069164286592, 'support': 460283}, '2': {'precision': 0.4308111043690287, 'recall': 0.5777206830860179, 'f1-score': 0.4935659710343255, 'support': 468228}, 'accuracy': 0.4262165094733328, 'macro avg': {'precision': 0.43202802824334574, 'recall': 0.42520160614336033, 'f1-score': 0.3742634550271493, 'support': 1389796}, 'weighted avg': {'precision': 0.4320122930735518, 'recall': 0.4262165094733328, 'f1-score': 0.3750374302151003, 'support': 1389796}}
[[287634  22211 151440]
 [220116  34215 205952]
 [177334  20389 270505]]
Evaluating performance on  val set...
1890/1890 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1202819
{'0': {'precision': 0.4065095075077111, 'recall': 0.626762127487229, 'f1-score': 0.49316124654978327, 'support': 153082}, '1': {'precision': 0.45472061657032753, 'recall': 0.08246359709922439, 'f1-score': 0.13960908293047183, 'support': 174574}, '2': {'precision': 0.41801707533891397, 'recall': 0.5787091935825038, 'f1-score': 0.48540975013105014, 'support': 156011}, 'accuracy': 0.41480398704067056, 'macro avg': {'precision': 0.4264157331389842, 'recall': 0.4293116393896524, 'f1-score': 0.37272669320376844, 'support': 483667}, 'weighted avg': {'precision': 0.42762261491096787, 'recall': 0.41480398704067056, 'f1-score': 0.36305037663419953, 'support': 483667}}
[[95946  8867 48269]
 [82748 14396 77430]
 [57330  8396 90285]]
training model: results/universal/W10/deepVOL_L3/h20
Epoch 1/50
8543/8543 - 483s - loss: 2.9232 - accuracy20: 0.4884 - val_loss: 3.1951 - val_accuracy20: 0.4657 - 483s/epoch - 56ms/step
Epoch 2/50
8543/8543 - 455s - loss: 2.8551 - accuracy20: 0.5055 - val_loss: 3.2801 - val_accuracy20: 0.4739 - 455s/epoch - 53ms/step
Epoch 3/50
8543/8543 - 444s - loss: 2.8289 - accuracy20: 0.5124 - val_loss: 3.2143 - val_accuracy20: 0.4793 - 444s/epoch - 52ms/step
Epoch 4/50
8543/8543 - 456s - loss: 2.8156 - accuracy20: 0.5156 - val_loss: 3.1932 - val_accuracy20: 0.4755 - 456s/epoch - 53ms/step
Epoch 5/50
8543/8543 - 443s - loss: 2.8068 - accuracy20: 0.5179 - val_loss: 3.1437 - val_accuracy20: 0.4862 - 443s/epoch - 52ms/step
Epoch 6/50
8543/8543 - 462s - loss: 2.7991 - accuracy20: 0.5195 - val_loss: 3.1117 - val_accuracy20: 0.4902 - 462s/epoch - 54ms/step
Epoch 7/50
8543/8543 - 449s - loss: 2.7929 - accuracy20: 0.5209 - val_loss: 3.1023 - val_accuracy20: 0.4930 - 449s/epoch - 53ms/step
Epoch 8/50
8543/8543 - 453s - loss: 2.7880 - accuracy20: 0.5217 - val_loss: 3.0915 - val_accuracy20: 0.4984 - 453s/epoch - 53ms/step
Epoch 9/50
8543/8543 - 449s - loss: 2.7839 - accuracy20: 0.5230 - val_loss: 3.1495 - val_accuracy20: 0.4937 - 449s/epoch - 53ms/step
Epoch 10/50
8543/8543 - 442s - loss: 2.7791 - accuracy20: 0.5241 - val_loss: 3.0569 - val_accuracy20: 0.5055 - 442s/epoch - 52ms/step
Epoch 11/50
8543/8543 - 439s - loss: 2.7754 - accuracy20: 0.5246 - val_loss: 3.0580 - val_accuracy20: 0.5012 - 439s/epoch - 51ms/step
Epoch 12/50
8543/8543 - 459s - loss: 2.7726 - accuracy20: 0.5253 - val_loss: 3.0731 - val_accuracy20: 0.4982 - 459s/epoch - 54ms/step
Epoch 13/50
8543/8543 - 468s - loss: 2.7688 - accuracy20: 0.5262 - val_loss: 3.0823 - val_accuracy20: 0.5028 - 468s/epoch - 55ms/step
Epoch 14/50
8543/8543 - 457s - loss: 2.7664 - accuracy20: 0.5269 - val_loss: 3.0325 - val_accuracy20: 0.5077 - 457s/epoch - 54ms/step
Epoch 15/50
8543/8543 - 452s - loss: 2.7632 - accuracy20: 0.5275 - val_loss: 3.0130 - val_accuracy20: 0.5068 - 452s/epoch - 53ms/step
Epoch 16/50
8543/8543 - 451s - loss: 2.7610 - accuracy20: 0.5284 - val_loss: 3.0064 - val_accuracy20: 0.5074 - 451s/epoch - 53ms/step
Epoch 17/50
8543/8543 - 459s - loss: 2.7586 - accuracy20: 0.5288 - val_loss: 3.0073 - val_accuracy20: 0.5046 - 459s/epoch - 54ms/step
Epoch 18/50
8543/8543 - 458s - loss: 2.7562 - accuracy20: 0.5294 - val_loss: 3.0325 - val_accuracy20: 0.5055 - 458s/epoch - 54ms/step
Epoch 19/50
8543/8543 - 450s - loss: 2.7546 - accuracy20: 0.5299 - val_loss: 3.0135 - val_accuracy20: 0.5068 - 450s/epoch - 53ms/step
Epoch 20/50
8543/8543 - 443s - loss: 2.7526 - accuracy20: 0.5301 - val_loss: 3.0195 - val_accuracy20: 0.5076 - 443s/epoch - 52ms/step
Epoch 21/50
8543/8543 - 467s - loss: 2.7510 - accuracy20: 0.5306 - val_loss: 3.0126 - val_accuracy20: 0.5052 - 467s/epoch - 55ms/step
Epoch 22/50
8543/8543 - 445s - loss: 2.7494 - accuracy20: 0.5312 - val_loss: 3.0154 - val_accuracy20: 0.5068 - 445s/epoch - 52ms/step
Epoch 23/50
8543/8543 - 448s - loss: 2.7479 - accuracy20: 0.5314 - val_loss: 3.0239 - val_accuracy20: 0.5050 - 448s/epoch - 52ms/step
Epoch 24/50
8543/8543 - 442s - loss: 2.7459 - accuracy20: 0.5317 - val_loss: 3.0162 - val_accuracy20: 0.5017 - 442s/epoch - 52ms/step
Epoch 25/50
8543/8543 - 439s - loss: 2.7441 - accuracy20: 0.5323 - val_loss: 3.0270 - val_accuracy20: 0.5075 - 439s/epoch - 51ms/step
Epoch 26/50
8543/8543 - 448s - loss: 2.7430 - accuracy20: 0.5328 - val_loss: 3.0112 - val_accuracy20: 0.5079 - 448s/epoch - 52ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1010s - 1010s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0218935
{'0': {'precision': 0.4510896412495248, 'recall': 0.42529254148111406, 'f1-score': 0.4378114109190626, 'support': 2870704}, '1': {'precision': 0.7346699513602186, 'recall': 0.4774853155265518, 'f1-score': 0.5787940260063709, 'support': 3757370}, '2': {'precision': 0.42616618964353364, 'recall': 0.6423031634732561, 'f1-score': 0.5123738757221336, 'support': 2917205}, 'accuracy': 0.5121597807670158, 'macro avg': {'precision': 0.5373085940844257, 'recall': 0.515027006826974, 'f1-score': 0.5096597708825223, 'support': 9545279}, 'weighted avg': {'precision': 0.555100150754628, 'recall': 0.5121597807670158, 'f1-score': 0.5160949103941898, 'support': 9545279}}
[[1220889  361728 1288087]
 [ 728386 1794089 1234895]
 [ 757258  286217 1873730]]
Evaluating performance on  train set...
8543/8543 - 246s - 246s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0596063
{'0': {'precision': 0.4209842596401585, 'recall': 0.4813506733562186, 'f1-score': 0.4491482030452944, 'support': 605920}, '1': {'precision': 0.7587098054994744, 'recall': 0.4437459374225713, 'f1-score': 0.5599780214029672, 'support': 964597}, '2': {'precision': 0.41169365594266, 'recall': 0.6211800332033437, 'f1-score': 0.4951929389924027, 'support': 616203}, 'accuracy': 0.5041655996195215, 'macro avg': {'precision': 0.5304625736940977, 'recall': 0.5154255479940445, 'f1-score': 0.5014397211468881, 'support': 2186720}, 'weighted avg': {'precision': 0.567342344117846, 'recall': 0.5041655996195215, 'f1-score': 0.5110120972444474, 'support': 2186720}}
[[291660  75770 238490]
 [228072 428036 308489]
 [173073  60357 382773]]
Evaluating performance on  val set...
3077/3077 - 91s - 91s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0640149
{'0': {'precision': 0.4141251127160567, 'recall': 0.47714319004942274, 'f1-score': 0.44340627114820663, 'support': 205978}, '1': {'precision': 0.7646395688300023, 'recall': 0.45873841345117483, 'f1-score': 0.5734442629300908, 'support': 371120}, '2': {'precision': 0.40069608619724684, 'recall': 0.6243465414949129, 'f1-score': 0.48812255968525525, 'support': 209845}, 'accuracy': 0.5077165690526506, 'macro avg': {'precision': 0.5264869225811019, 'recall': 0.5200760483318368, 'f1-score': 0.5016576979211842, 'support': 786943}, 'weighted avg': {'precision': 0.5758457340103154, 'recall': 0.5077165690526506, 'f1-score': 0.5166557810595341, 'support': 786943}}
[[ 98281  29041  78656]
 [ 83574 170247 117299]
 [ 55467  23362 131016]]
testing model out of sample: results/universal/W10/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 586s - 586s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.826334
{'0': {'precision': 0.5334800335981521, 'recall': 0.38386806610860025, 'f1-score': 0.4464738061164294, 'support': 1270697}, '1': {'precision': 0.7363355003520723, 'recall': 0.7688446077534543, 'f1-score': 0.7522389857459397, 'support': 2924245}, '2': {'precision': 0.46664050209193814, 'recall': 0.550415252275731, 'f1-score': 0.5050776195464249, 'support': 1265857}, 'accuracy': 0.6286290705810633, 'macro avg': {'precision': 0.5788186786807209, 'recall': 0.5677093087125952, 'f1-score': 0.5679301371362646, 'support': 5460799}, 'weighted avg': {'precision': 0.6266147187502619, 'recall': 0.6286290705810633, 'f1-score': 0.623795173404028, 'support': 5460799}}
[[ 487780  441169  341748]
 [ 221337 2248290  454618]
 [ 205219  363891  696747]]
Evaluating performance on  train set...
4055/4055 - 121s - 121s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82997197
{'0': {'precision': 0.5101552501252017, 'recall': 0.40219169909322616, 'f1-score': 0.44978548352675385, 'support': 227951}, '1': {'precision': 0.7561300999433753, 'recall': 0.7453578655772664, 'f1-score': 0.7507053407478962, 'support': 578667}, '2': {'precision': 0.45533101093799483, 'recall': 0.5667368384576067, 'f1-score': 0.5049622835574064, 'support': 230862}, 'accuracy': 0.6302116667309249, 'macro avg': {'precision': 0.573872120335524, 'recall': 0.5714288010426998, 'f1-score': 0.5684843692773521, 'support': 1037480}, 'weighted avg': {'precision': 0.6351511005632786, 'recall': 0.6302116667309249, 'f1-score': 0.6299052134755366, 'support': 1037480}}
[[ 91680  76114  60157]
 [ 51001 431314  96352]
 [ 37029  62995 130838]]
Evaluating performance on  val set...
1545/1545 - 42s - 42s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8379537
{'0': {'precision': 0.49638795404433095, 'recall': 0.4009302979531102, 'f1-score': 0.4435816832485336, 'support': 85349}, '1': {'precision': 0.7622216594443506, 'recall': 0.7329950841113065, 'f1-score': 0.7473227300107137, 'support': 221730}, '2': {'precision': 0.4500758375391384, 'recall': 0.5777560175802154, 'f1-score': 0.5059855310195595, 'support': 87826}, 'accuracy': 0.6267026246818855, 'macro avg': {'precision': 0.5695618170092733, 'recall': 0.5705604665482107, 'f1-score': 0.565629981426269, 'support': 394905}, 'weighted avg': {'precision': 0.6353477027286001, 'recall': 0.6267026246818855, 'f1-score': 0.6280037154661968, 'support': 394905}}
[[ 34219  28196  22934]
 [ 20138 162527  39065]
 [ 14579  22505  50742]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0596036
{'0': {'precision': 0.5188638085834347, 'recall': 0.4225130890052356, 'f1-score': 0.4657576600810067, 'support': 53480}, '1': {'precision': 0.3984833772599066, 'recall': 0.2888553712083124, 'f1-score': 0.3349267420621041, 'support': 29835}, '2': {'precision': 0.4558531304683098, 'recall': 0.62359265645603, 'f1-score': 0.5266900256148859, 'support': 49295}, 'accuracy': 0.4671895030540683, 'macro avg': {'precision': 0.45773343877055034, 'recall': 0.4449870388898593, 'f1-score': 0.44245814258599886, 'support': 132610}, 'weighted avg': {'precision': 0.4683573494459447, 'recall': 0.4671895030540683, 'f1-score': 0.45897325860222393, 'support': 132610}}
[[22596  7297 23587]
 [ 8110  8618 13107]
 [12843  5712 30740]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0932714
{'0': {'precision': 0.4821411000688773, 'recall': 0.4290342351808073, 'f1-score': 0.4540400296515938, 'support': 11421}, '1': {'precision': 0.5276868327402136, 'recall': 0.32463438129433403, 'f1-score': 0.4019735415311213, 'support': 11419}, '2': {'precision': 0.42982200175080243, 'recall': 0.6413829138726813, 'f1-score': 0.5147110210357118, 'support': 11483}, 'accuracy': 0.46534393846691724, 'macro avg': {'precision': 0.4798833115199644, 'recall': 0.4650171767826075, 'f1-score': 0.45690819740614225, 'support': 34323}, 'weighted avg': {'precision': 0.4797900968170501, 'recall': 0.46534393846691724, 'f1-score': 0.45701581166995314, 'support': 34323}}
[[4900 1835 4686]
 [2628 3707 5084]
 [2635 1483 7365]]
Evaluating performance on  val set...
46/46 - 1s - 883ms/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0682901
{'0': {'precision': 0.47541460576083794, 'recall': 0.4089089089089089, 'f1-score': 0.43966097134400645, 'support': 3996}, '1': {'precision': 0.5232674924673586, 'recall': 0.41613418530351437, 'f1-score': 0.463591873053537, 'support': 3756}, '2': {'precision': 0.4492202358311145, 'recall': 0.6010178117048346, 'f1-score': 0.5141488898563342, 'support': 3930}, 'accuracy': 0.4758602978941962, 'macro avg': {'precision': 0.48263411135310363, 'recall': 0.4753536353057526, 'f1-score': 0.47246724475129254, 'support': 11682}, 'weighted avg': {'precision': 0.4819881007656212, 'recall': 0.4758602978941962, 'f1-score': 0.4724140946597439, 'support': 11682}}
[[1634  823 1539]
 [ 836 1563 1357]
 [ 967  601 2362]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57342327
{'0': {'precision': 0.5509350453539554, 'recall': 0.40715646454117393, 'f1-score': 0.4682574951169352, 'support': 55642}, '1': {'precision': 0.8711494353785543, 'recall': 0.8824140796300568, 'f1-score': 0.8767455762627859, 'support': 359839}, '2': {'precision': 0.4517244545092879, 'recall': 0.5320621418015355, 'f1-score': 0.4886130420390599, 'support': 55486}, 'accuracy': 0.7849891818322727, 'macro avg': {'precision': 0.6246029784139325, 'recall': 0.6072108953242554, 'f1-score': 0.6112053711395937, 'support': 470967}, 'weighted avg': {'precision': 0.7839042917097604, 'recall': 0.7849891818322727, 'f1-score': 0.7827580662991259, 'support': 470967}}
[[ 22655  26087   6900]
 [ 13380 317527  28932]
 [  5086  20878  29522]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.44940418
{'0': {'precision': 0.5557576446515857, 'recall': 0.4600978731413514, 'f1-score': 0.5034237759357463, 'support': 10626}, '1': {'precision': 0.9241408065861145, 'recall': 0.9147757209596403, 'f1-score': 0.9194344168968835, 'support': 113876}, '2': {'precision': 0.45166402535657685, 'recall': 0.5752821359757776, 'f1-score': 0.5060328477462572, 'support': 10899}, 'accuracy': 0.8517662351090465, 'macro avg': {'precision': 0.643854158864759, 'recall': 0.6500519100255898, 'f1-score': 0.6429636801929624, 'support': 135401}, 'weighted avg': {'precision': 0.8571991745646594, 'recall': 0.8517662351090465, 'f1-score': 0.8535102895047245, 'support': 135401}}
[[  4889   4708   1029]
 [  3122 104171   6583]
 [   786   3843   6270]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5094497
{'0': {'precision': 0.5640465793304221, 'recall': 0.43523025084238115, 'f1-score': 0.4913355874894337, 'support': 5342}, '1': {'precision': 0.8954085270212463, 'recall': 0.8933915064140564, 'f1-score': 0.8943988795385217, 'support': 42173}, '2': {'precision': 0.458151700087184, 'recall': 0.5663732710616131, 'f1-score': 0.5065467105791631, 'support': 5567}, 'accuracy': 0.8129874533740251, 'macro avg': {'precision': 0.6392022688129508, 'recall': 0.6316650094393502, 'f1-score': 0.6307603925357061, 'support': 53082}, 'weighted avg': {'precision': 0.8162038195854618, 'recall': 0.8129874533740251, 'f1-score': 0.81315971879245, 'support': 53082}}
[[ 2325  2415   602]
 [ 1369 37677  3127]
 [  428  1986  3153]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
967/967 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.247402
{'0': {'precision': 0.4396189915947374, 'recall': 0.44419678577143773, 'f1-score': 0.4418960331584064, 'support': 87486}, '1': {'precision': 0.32329024676850765, 'recall': 0.09161383131759816, 'f1-score': 0.1427696650787226, 'support': 75076}, '2': {'precision': 0.3966794084153568, 'recall': 0.6435741435917954, 'f1-score': 0.49082766419558077, 'support': 84977}, 'accuracy': 0.40570576757601834, 'macro avg': {'precision': 0.3865295489262006, 'recall': 0.39312825356027714, 'f1-score': 0.35849778747756994, 'support': 247539}, 'weighted avg': {'precision': 0.3895970806780405, 'recall': 0.40570576757601834, 'f1-score': 0.36797173032408786, 'support': 247539}}
[[38861  7434 41191]
 [26211  6878 41987]
 [23325  6963 54689]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2076491
{'0': {'precision': 0.4337928982344773, 'recall': 0.469612369805648, 'f1-score': 0.4509925238463522, 'support': 18626}, '1': {'precision': 0.443360433604336, 'recall': 0.22074697754749567, 'f1-score': 0.29474291067632324, 'support': 18528}, '2': {'precision': 0.4217889566899836, 'recall': 0.5931662393386008, 'f1-score': 0.493008893817818, 'support': 19111}, 'accuracy': 0.4296276548475962, 'macro avg': {'precision': 0.43298076284293235, 'recall': 0.4278418622305815, 'f1-score': 0.41291477611349786, 'support': 56265}, 'weighted avg': {'precision': 0.4328662114571899, 'recall': 0.4296276548475962, 'f1-score': 0.4138110080498604, 'support': 56265}}
[[ 8747  2629  7250]
 [ 6148  4090  8290]
 [ 5269  2506 11336]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2215819
{'0': {'precision': 0.4447900466562986, 'recall': 0.49573884154268383, 'f1-score': 0.4688844866452627, 'support': 6923}, '1': {'precision': 0.37711250603573154, 'recall': 0.12373257287705956, 'f1-score': 0.1863294763211261, 'support': 6312}, '2': {'precision': 0.4166503810826656, 'recall': 0.6283524904214559, 'f1-score': 0.5010575793184489, 'support': 6786}, 'accuracy': 0.4234054243044803, 'macro avg': {'precision': 0.41285097792489855, 'recall': 0.41594130161373305, 'f1-score': 0.38542384742827923, 'support': 20021}, 'weighted avg': {'precision': 0.41391564442965195, 'recall': 0.4234054243044803, 'f1-score': 0.39070854047445663, 'support': 20021}}
[[3432  663 2828]
 [2389  781 3142]
 [1895  627 4264]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2573383
{'0': {'precision': 0.34777889411173707, 'recall': 0.2756181484693805, 'f1-score': 0.3075220712466982, 'support': 140662}, '1': {'precision': 0.2707985177650222, 'recall': 0.029677111119958594, 'f1-score': 0.05349197692108965, 'support': 125585}, '2': {'precision': 0.3441844246691834, 'recall': 0.6907504338077249, 'f1-score': 0.45944058933329524, 'support': 140039}, 'accuracy': 0.34268470978571747, 'macro avg': {'precision': 0.3209206121819809, 'recall': 0.3320152311323547, 'f1-score': 0.2734848791670277, 'support': 406286}, 'weighted avg': {'precision': 0.3227449365799296, 'recall': 0.34268470978571747, 'f1-score': 0.281363522732714, 'support': 406286}}
[[38769  5091 96802]
 [34345  3727 87513]
 [38362  4945 96732]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2787422
{'0': {'precision': 0.356640625, 'recall': 0.2789489764741827, 'f1-score': 0.31304645979770274, 'support': 26184}, '1': {'precision': 0.31525911708253357, 'recall': 0.026406752411575564, 'f1-score': 0.04873164218958611, 'support': 24880}, '2': {'precision': 0.32617239164115935, 'recall': 0.7067469090313601, 'f1-score': 0.44634915710001033, 'support': 24426}, 'accuracy': 0.3341369717843423, 'macro avg': {'precision': 0.33269071124123095, 'recall': 0.3373675459723728, 'f1-score': 0.2693757530290997, 'support': 75490}, 'weighted avg': {'precision': 0.3331436189725844, 'recall': 0.3341369717843423, 'f1-score': 0.26906578715518353, 'support': 75490}}
[[ 7304   780 18100]
 [ 6660   657 17563]
 [ 6516   647 17263]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2875617
{'0': {'precision': 0.3521141875939043, 'recall': 0.2880597014925373, 'f1-score': 0.31688236430365074, 'support': 11390}, '1': {'precision': 0.35568181818181815, 'recall': 0.027613586237318043, 'f1-score': 0.05124846500204667, 'support': 11335}, '2': {'precision': 0.3181896700639143, 'recall': 0.6931978549252046, 'f1-score': 0.43616989788367616, 'support': 10629}, 'accuracy': 0.328656233135456, 'macro avg': {'precision': 0.34199522527987886, 'recall': 0.33629038088501995, 'f1-score': 0.26810024239645786, 'support': 33354}, 'weighted avg': {'precision': 0.34251580047055297, 'recall': 0.32865623313545594, 'f1-score': 0.2646231733771774, 'support': 33354}}
[[3281  307 7802]
 [3036  313 7986]
 [3001  260 7368]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1095257
{'0': {'precision': 0.4953103670215251, 'recall': 0.449342650493483, 'f1-score': 0.4712080923000195, 'support': 212368}, '1': {'precision': 0.2844511682635737, 'recall': 0.14465720636006155, 'f1-score': 0.19178330594435314, 'support': 116980}, '2': {'precision': 0.45859461195759954, 'recall': 0.6278147151467643, 'f1-score': 0.5300257250945776, 'support': 209213}, 'accuracy': 0.4524928466784635, 'macro avg': {'precision': 0.41278538241423285, 'recall': 0.40727152400010297, 'f1-score': 0.3976723744463167, 'support': 538561}, 'weighted avg': {'precision': 0.43524712008219196, 'recall': 0.4524928466784635, 'f1-score': 0.43336335772392137, 'support': 538561}}
[[ 95426  22330  94612]
 [ 39605  16922  60453]
 [ 57628  20238 131347]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1976955
{'0': {'precision': 0.44335197307396707, 'recall': 0.4608666905424392, 'f1-score': 0.4519397017505943, 'support': 36299}, '1': {'precision': 0.4758076198754165, 'recall': 0.18161961901075507, 'f1-score': 0.26289144572286144, 'support': 36169}, '2': {'precision': 0.4194288672245708, 'recall': 0.6565116404688597, 'f1-score': 0.5118497383687264, 'support': 37026}, 'accuracy': 0.43478181452864995, 'macro avg': {'precision': 0.44619615339131813, 'recall': 0.432999316674018, 'f1-score': 0.4088936286140607, 'support': 109494}, 'weighted avg': {'precision': 0.44598327133672006, 'recall': 0.43478181452864995, 'f1-score': 0.4097505648440596, 'support': 109494}}
[[16729  3717 15853]
 [11806  6569 17794]
 [ 9198  3520 24308]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2096066
{'0': {'precision': 0.4324984247006931, 'recall': 0.4619332043408766, 'f1-score': 0.4467314811048285, 'support': 11887}, '1': {'precision': 0.46120098711269536, 'recall': 0.14443967367969085, 'f1-score': 0.21998430551922574, 'support': 11645}, '2': {'precision': 0.42054164537557487, 'recall': 0.6647282125837978, 'f1-score': 0.5151638446371005, 'support': 12381}, 'accuracy': 0.4288976136774984, 'macro avg': {'precision': 0.4380803523963211, 'recall': 0.4237003635347884, 'f1-score': 0.3939598770870516, 'support': 35913}, 'weighted avg': {'precision': 0.43768330077519196, 'recall': 0.4288976136774984, 'f1-score': 0.39679942956913716, 'support': 35913}}
[[5491 1026 5370]
 [3993 1682 5970]
 [3212  939 8230]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
5267/5267 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63201845
{'0': {'precision': 0.5845645054091495, 'recall': 0.3602905975313029, 'f1-score': 0.44581035609377767, 'support': 202617}, '1': {'precision': 0.8160954690600308, 'recall': 0.851736313607397, 'f1-score': 0.833535076609696, 'support': 943090}, '2': {'precision': 0.45679430701457135, 'recall': 0.5392479331496133, 'f1-score': 0.4946083127790122, 'support': 202482}, 'accuracy': 0.7309457353531292, 'macro avg': {'precision': 0.6191514271612505, 'recall': 0.5837582814294376, 'f1-score': 0.5913179151608287, 'support': 1348189}, 'weighted avg': {'precision': 0.7273363060974645, 'recall': 0.7309457353531292, 'f1-score': 0.7243618162650868, 'support': 1348189}}
[[ 73001 102058  27558]
 [ 37541 803264 102285]
 [ 14339  78955 109188]]
Evaluating performance on  train set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.522145
{'0': {'precision': 0.5738734638142922, 'recall': 0.41079108562491856, 'f1-score': 0.4788272378565189, 'support': 30692}, '1': {'precision': 0.876530099195068, 'recall': 0.8911613374801141, 'f1-score': 0.8837851667251002, 'support': 209319}, '2': {'precision': 0.4841282894736842, 'recall': 0.5651158325867145, 'f1-score': 0.5214964861513022, 'support': 31252}, 'accuracy': 0.7992464877259339, 'macro avg': {'precision': 0.6448439508276814, 'recall': 0.6223560852305824, 'f1-score': 0.6280362969109737, 'support': 271263}, 'weighted avg': {'precision': 0.797077763968666, 'recall': 0.7992464877259339, 'f1-score': 0.7962272815799576, 'support': 271263}}
[[ 12608  14950   3134]
 [  7097 186537  15685]
 [  2265  11326  17661]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.52190703
{'0': {'precision': 0.5969786198950199, 'recall': 0.4185065517860348, 'f1-score': 0.4920593045955785, 'support': 11142}, '1': {'precision': 0.8834092307692307, 'recall': 0.885086810693499, 'f1-score': 0.8842472250625207, 'support': 81096}, '2': {'precision': 0.4413384454513768, 'recall': 0.5668875358166189, 'f1-score': 0.49629600595774703, 'support': 11168}, 'accuracy': 0.8004467825851498, 'macro avg': {'precision': 0.6405754320385424, 'recall': 0.6234936327653843, 'f1-score': 0.6242008452052821, 'support': 103406}, 'weighted avg': {'precision': 0.8048020281234437, 'recall': 0.8004467825851498, 'f1-score': 0.8000896614317373, 'support': 103406}}
[[ 4663  5433  1046]
 [ 2351 71777  6968]
 [  797  4040  6331]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
10110/10110 - 143s - 143s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6394615
{'0': {'precision': 0.6394704106028866, 'recall': 0.34780323151837095, 'f1-score': 0.4505536576266603, 'support': 397584}, '1': {'precision': 0.811314730336497, 'recall': 0.884188078823622, 'f1-score': 0.8461853426157161, 'support': 1790377}, '2': {'precision': 0.49486410866552405, 'recall': 0.5202504123556755, 'f1-score': 0.5072398261710731, 'support': 400140}, 'accuracy': 0.7455211369262637, 'macro avg': {'precision': 0.6485497498683025, 'recall': 0.5840805742325562, 'f1-score': 0.6013262754711498, 'support': 2588101}, 'weighted avg': {'precision': 0.7359903501162541, 'recall': 0.7455211369262637, 'f1-score': 0.7330048729219723, 'support': 2588101}}
[[ 138281  205488   53815]
 [  48668 1583030  158679]
 [  29294  162673  208173]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6007943
{'0': {'precision': 0.602053953711189, 'recall': 0.34633138132965896, 'f1-score': 0.43971615696650956, 'support': 58060}, '1': {'precision': 0.8410222840301304, 'recall': 0.8833717256916169, 'f1-score': 0.8616769742881251, 'support': 315601}, '2': {'precision': 0.4691193232947387, 'recall': 0.54015922081959, 'f1-score': 0.5021391361582238, 'support': 57907}, 'accuracy': 0.7650706261817373, 'macro avg': {'precision': 0.6373985203453527, 'recall': 0.5899541092802886, 'f1-score': 0.6011774224709528, 'support': 431568}, 'weighted avg': {'precision': 0.7589719790825392, 'recall': 0.7650706261817373, 'f1-score': 0.7566673288874439, 'support': 431568}}
[[ 20108  30289   7663]
 [  9074 278793  27734]
 [  4217  22411  31279]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6702509
{'0': {'precision': 0.5515375549126754, 'recall': 0.36738990792948395, 'f1-score': 0.4410126799177519, 'support': 28022}, '1': {'precision': 0.820051715113781, 'recall': 0.8533847116877626, 'f1-score': 0.8363862352500618, 'support': 123009}, '2': {'precision': 0.47253919796081684, 'recall': 0.5425926556171936, 'f1-score': 0.505148759545008, 'support': 29383}, 'accuracy': 0.7272828051038168, 'macro avg': {'precision': 0.6147094893290911, 'recall': 0.5877890917448134, 'f1-score': 0.5941825582376072, 'support': 180414}, 'weighted avg': {'precision': 0.7217485674164796, 'recall': 0.7272828051038168, 'f1-score': 0.7210298409782006, 'support': 180414}}
[[ 10295  12886   4841]
 [  5080 104974  12955]
 [  3291  10149  15943]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
6546/6546 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8875244
{'0': {'precision': 0.5030327552012023, 'recall': 0.3513040977278576, 'f1-score': 0.4136950608829476, 'support': 396366}, '1': {'precision': 0.6764668805806823, 'recall': 0.7202774722950681, 'f1-score': 0.6976850900922555, 'support': 886575}, '2': {'precision': 0.4555427340564659, 'recall': 0.5275998655900292, 'f1-score': 0.48893067057642614, 'support': 392828}, 'accuracy': 0.5878381805606858, 'macro avg': {'precision': 0.5450141232794502, 'recall': 0.5330604785376516, 'f1-score': 0.5334369405172098, 'support': 1675769}, 'weighted avg': {'precision': 0.5836566059121702, 'recall': 0.5878381805606858, 'f1-score': 0.5815780532469977, 'support': 1675769}}
[[139245 171942  85179]
 [ 85465 638580 162530]
 [ 52101 133471 207256]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8805422
{'0': {'precision': 0.5243546072311656, 'recall': 0.3828382421633359, 'f1-score': 0.4425585943200724, 'support': 79211}, '1': {'precision': 0.6727860097512129, 'recall': 0.7175659868789096, 'f1-score': 0.6944548692929081, 'support': 157304}, '2': {'precision': 0.47101376131354933, 'recall': 0.5366685834770941, 'f1-score': 0.5017023259147761, 'support': 78255}, 'accuracy': 0.5883597547415573, 'macro avg': {'precision': 0.556051459431976, 'recall': 0.5456909375064466, 'f1-score': 0.5462385965092522, 'support': 314770}, 'weighted avg': {'precision': 0.5852710396889299, 'recall': 0.5883597547415573, 'f1-score': 0.5831456399542513, 'support': 314770}}
[[ 30325  30382  18504]
 [ 15766 112876  28662]
 [ 11742  24516  41997]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.806676
{'0': {'precision': 0.528274311410905, 'recall': 0.3772782015254918, 'f1-score': 0.4401873536299766, 'support': 24910}, '1': {'precision': 0.7227845904673762, 'recall': 0.7777967974354585, 'f1-score': 0.7492823038234654, 'support': 64261}, '2': {'precision': 0.47727615884040464, 'recall': 0.5211226971108271, 'f1-score': 0.49823662693330706, 'support': 24263}, 'accuracy': 0.6349419045436112, 'macro avg': {'precision': 0.5761116869062286, 'recall': 0.5587325653572591, 'f1-score': 0.5625687614622498, 'support': 113434}, 'weighted avg': {'precision': 0.6275572148316594, 'recall': 0.6349419045436112, 'f1-score': 0.6277078511222849, 'support': 113434}}
[[ 9398 10656  4856]
 [ 5287 49982  8992]
 [ 3105  8514 12644]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
7633/7633 - 109s - 109s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92666537
{'0': {'precision': 0.5162386412779251, 'recall': 0.3697552228928064, 'f1-score': 0.43088771060567, 'support': 519779}, '1': {'precision': 0.6328429117241103, 'recall': 0.6937992953769667, 'f1-score': 0.6619206955550196, 'support': 911977}, '2': {'precision': 0.46776552432902485, 'recall': 0.521189816020466, 'f1-score': 0.4930346550929301, 'support': 522232}, 'accuracy': 0.5614681359353282, 'macro avg': {'precision': 0.5389490257770201, 'recall': 0.5282481114300798, 'f1-score': 0.5286143537512066, 'support': 1953988}, 'weighted avg': {'precision': 0.5577057331629534, 'recall': 0.5614681359353282, 'f1-score': 0.5553264950959658, 'support': 1953988}}
[[192191 198751 128837]
 [ 98390 632729 180858]
 [ 81710 168340 272182]]
Evaluating performance on  train set...
1586/1586 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9000297
{'0': {'precision': 0.5240548084242578, 'recall': 0.3989183446810565, 'f1-score': 0.4530035916979684, 'support': 103545}, '1': {'precision': 0.6615140610550223, 'recall': 0.700969789286621, 'f1-score': 0.6806706323478294, 'support': 196950}, '2': {'precision': 0.47713269040595707, 'recall': 0.5359187354630465, 'f1-score': 0.5048200744026327, 'support': 105335}, 'accuracy': 0.5810634994948624, 'macro avg': {'precision': 0.554233853295079, 'recall': 0.545268956476908, 'f1-score': 0.5461647661494768, 'support': 405830}, 'weighted avg': {'precision': 0.5785851745977082, 'recall': 0.5810634994948624, 'f1-score': 0.5769400006911083, 'support': 405830}}
[[ 41306  37589  24650]
 [ 21682 138056  37212]
 [ 15832  33052  56451]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8823032
{'0': {'precision': 0.5032819474138255, 'recall': 0.38869094174560415, 'f1-score': 0.4386257395966134, 'support': 34521}, '1': {'precision': 0.7007450276930329, 'recall': 0.6949667567006025, 'f1-score': 0.6978439311257588, 'support': 77008}, '2': {'precision': 0.453844574713168, 'recall': 0.5629208396989759, 'f1-score': 0.5025319812595502, 'support': 35346}, 'accuracy': 0.5912034042553191, 'macro avg': {'precision': 0.5526238499400088, 'recall': 0.5488595127150608, 'f1-score': 0.5463338839939742, 'support': 146875}, 'weighted avg': {'precision': 0.5949164904651533, 'recall': 0.5912034042553191, 'f1-score': 0.5899156426508745, 'support': 146875}}
[[13418 12710  8393]
 [ 7939 53518 15551]
 [ 5304 10145 19897]]
testing model on single stock: results/universal/W10/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
22048/22048 - 315s - 315s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1753185
{'0': {'precision': 0.44043161317024976, 'recall': 0.4568450581256682, 'f1-score': 0.44848821407234984, 'support': 2075417}, '1': {'precision': 0.22780056405234053, 'recall': 0.0214493569560994, 'f1-score': 0.039207038408601826, 'support': 1442281}, '2': {'precision': 0.42645724755506176, 'recall': 0.6729680159144458, 'f1-score': 0.5220765745436687, 'support': 2126370}, 'accuracy': 0.42700743506279515, 'macro avg': {'precision': 0.364896474925884, 'recall': 0.38375414366540445, 'f1-score': 0.33659060900820686, 'support': 5644068}, 'weighted avg': {'precision': 0.38083126923995075, 'recall': 0.42700743506279515, 'f1-score': 0.371624791933905, 'support': 5644068}}
[[ 948144   56585 1070688]
 [ 557508   30936  853837]
 [ 647109   48282 1430979]]
Evaluating performance on  train set...
5429/5429 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2526184
{'0': {'precision': 0.40519877151729955, 'recall': 0.5148593118136265, 'f1-score': 0.45349389224612086, 'support': 459207}, '1': {'precision': 0.34867161668310226, 'recall': 0.052356397179553066, 'f1-score': 0.09104196723049601, 'support': 459218}, '2': {'precision': 0.40633832233005496, 'recall': 0.6356267144139117, 'f1-score': 0.4957546244933719, 'support': 471371}, 'accuracy': 0.4029987134802518, 'macro avg': {'precision': 0.3867362368434856, 'recall': 0.40094747446903045, 'f1-score': 0.3467634946566629, 'support': 1389796}, 'weighted avg': {'precision': 0.38690750014906194, 'recall': 0.4029987134802518, 'f1-score': 0.348065495213962, 'support': 1389796}}
[[236427  25025 197755]
 [195190  24043 239985]
 [151867  19888 299616]]
Evaluating performance on  val set...
1890/1890 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2856963
{'0': {'precision': 0.3964586787062185, 'recall': 0.5135971382691228, 'f1-score': 0.44748912984749084, 'support': 153194}, '1': {'precision': 0.35336612886580204, 'recall': 0.059632521552349715, 'f1-score': 0.10204446563747988, 'support': 172255}, '2': {'precision': 0.39479427346656726, 'recall': 0.6391371398955871, 'f1-score': 0.4880936579149964, 'support': 158218}, 'accuracy': 0.3929873239232778, 'macro avg': {'precision': 0.3815396936795293, 'recall': 0.4041222665723532, 'f1-score': 0.34587575113332236, 'support': 483667}, 'weighted avg': {'precision': 0.3805670713793426, 'recall': 0.3929873239232778, 'f1-score': 0.3377437814741041, 'support': 483667}}
[[ 78680  10227  64287]
 [ 71252  10272  90731]
 [ 48525   8570 101123]]
training model: results/universal/W10/deepVOL_L3/h30
Epoch 1/50
8543/8543 - 469s - loss: 2.9988 - accuracy30: 0.4721 - val_loss: 3.3028 - val_accuracy30: 0.4289 - 469s/epoch - 55ms/step
Epoch 2/50
8543/8543 - 438s - loss: 2.9185 - accuracy30: 0.4909 - val_loss: 3.3560 - val_accuracy30: 0.4489 - 438s/epoch - 51ms/step
Epoch 3/50
8543/8543 - 449s - loss: 2.8908 - accuracy30: 0.4973 - val_loss: 3.4182 - val_accuracy30: 0.4565 - 449s/epoch - 53ms/step
Epoch 4/50
8543/8543 - 479s - loss: 2.8784 - accuracy30: 0.5003 - val_loss: 3.2475 - val_accuracy30: 0.4643 - 479s/epoch - 56ms/step
Epoch 5/50
8543/8543 - 447s - loss: 2.8697 - accuracy30: 0.5026 - val_loss: 3.2656 - val_accuracy30: 0.4676 - 447s/epoch - 52ms/step
Epoch 6/50
8543/8543 - 446s - loss: 2.8622 - accuracy30: 0.5041 - val_loss: 3.4123 - val_accuracy30: 0.4609 - 446s/epoch - 52ms/step
Epoch 7/50
8543/8543 - 449s - loss: 2.8558 - accuracy30: 0.5063 - val_loss: 3.3532 - val_accuracy30: 0.4611 - 449s/epoch - 53ms/step
Epoch 8/50
8543/8543 - 446s - loss: 2.8510 - accuracy30: 0.5075 - val_loss: 3.2847 - val_accuracy30: 0.4682 - 446s/epoch - 52ms/step
Epoch 9/50
8543/8543 - 447s - loss: 2.8467 - accuracy30: 0.5087 - val_loss: 3.1753 - val_accuracy30: 0.4728 - 447s/epoch - 52ms/step
Epoch 10/50
8543/8543 - 441s - loss: 2.8420 - accuracy30: 0.5098 - val_loss: 3.2299 - val_accuracy30: 0.4696 - 441s/epoch - 52ms/step
Epoch 11/50
8543/8543 - 441s - loss: 2.8384 - accuracy30: 0.5107 - val_loss: 3.1655 - val_accuracy30: 0.4689 - 441s/epoch - 52ms/step
Epoch 12/50
8543/8543 - 434s - loss: 2.8338 - accuracy30: 0.5115 - val_loss: 3.1459 - val_accuracy30: 0.4698 - 434s/epoch - 51ms/step
Epoch 13/50
8543/8543 - 435s - loss: 2.8307 - accuracy30: 0.5122 - val_loss: 3.1286 - val_accuracy30: 0.4705 - 435s/epoch - 51ms/step
Epoch 14/50
8543/8543 - 442s - loss: 2.8280 - accuracy30: 0.5130 - val_loss: 3.1469 - val_accuracy30: 0.4696 - 442s/epoch - 52ms/step
Epoch 15/50
8543/8543 - 444s - loss: 2.8255 - accuracy30: 0.5137 - val_loss: 3.1028 - val_accuracy30: 0.4731 - 444s/epoch - 52ms/step
Epoch 16/50
8543/8543 - 434s - loss: 2.8232 - accuracy30: 0.5145 - val_loss: 3.1329 - val_accuracy30: 0.4738 - 434s/epoch - 51ms/step
Epoch 17/50
8543/8543 - 434s - loss: 2.8211 - accuracy30: 0.5146 - val_loss: 3.1562 - val_accuracy30: 0.4733 - 434s/epoch - 51ms/step
Epoch 18/50
8543/8543 - 434s - loss: 2.8191 - accuracy30: 0.5153 - val_loss: 3.0979 - val_accuracy30: 0.4756 - 434s/epoch - 51ms/step
Epoch 19/50
8543/8543 - 438s - loss: 2.8168 - accuracy30: 0.5159 - val_loss: 3.1666 - val_accuracy30: 0.4687 - 438s/epoch - 51ms/step
Epoch 20/50
8543/8543 - 451s - loss: 2.8155 - accuracy30: 0.5159 - val_loss: 3.1403 - val_accuracy30: 0.4707 - 451s/epoch - 53ms/step
Epoch 21/50
8543/8543 - 437s - loss: 2.8138 - accuracy30: 0.5165 - val_loss: 3.1460 - val_accuracy30: 0.4703 - 437s/epoch - 51ms/step
Epoch 22/50
8543/8543 - 443s - loss: 2.8123 - accuracy30: 0.5168 - val_loss: 3.1104 - val_accuracy30: 0.4688 - 443s/epoch - 52ms/step
Epoch 23/50
8543/8543 - 433s - loss: 2.8106 - accuracy30: 0.5171 - val_loss: 3.1610 - val_accuracy30: 0.4704 - 433s/epoch - 51ms/step
Epoch 24/50
8543/8543 - 444s - loss: 2.8091 - accuracy30: 0.5175 - val_loss: 3.1613 - val_accuracy30: 0.4683 - 444s/epoch - 52ms/step
Epoch 25/50
8543/8543 - 441s - loss: 2.8076 - accuracy30: 0.5181 - val_loss: 3.1311 - val_accuracy30: 0.4705 - 441s/epoch - 52ms/step
Epoch 26/50
8543/8543 - 441s - loss: 2.8067 - accuracy30: 0.5180 - val_loss: 3.1209 - val_accuracy30: 0.4704 - 441s/epoch - 52ms/step
Epoch 27/50
8543/8543 - 439s - loss: 2.8053 - accuracy30: 0.5184 - val_loss: 3.0923 - val_accuracy30: 0.4691 - 439s/epoch - 51ms/step
Epoch 28/50
8543/8543 - 440s - loss: 2.8036 - accuracy30: 0.5187 - val_loss: 3.1218 - val_accuracy30: 0.4709 - 440s/epoch - 52ms/step
Epoch 29/50
8543/8543 - 442s - loss: 2.8025 - accuracy30: 0.5194 - val_loss: 3.1283 - val_accuracy30: 0.4717 - 442s/epoch - 52ms/step
Epoch 30/50
8543/8543 - 447s - loss: 2.8016 - accuracy30: 0.5194 - val_loss: 3.1212 - val_accuracy30: 0.4696 - 447s/epoch - 52ms/step
Epoch 31/50
8543/8543 - 444s - loss: 2.8004 - accuracy30: 0.5195 - val_loss: 3.0931 - val_accuracy30: 0.4722 - 444s/epoch - 52ms/step
Epoch 32/50
8543/8543 - 443s - loss: 2.7987 - accuracy30: 0.5200 - val_loss: 3.1093 - val_accuracy30: 0.4712 - 443s/epoch - 52ms/step
Epoch 33/50
8543/8543 - 453s - loss: 2.7975 - accuracy30: 0.5203 - val_loss: 3.1098 - val_accuracy30: 0.4692 - 453s/epoch - 53ms/step
Epoch 34/50
8543/8543 - 438s - loss: 2.7963 - accuracy30: 0.5207 - val_loss: 3.1426 - val_accuracy30: 0.4665 - 438s/epoch - 51ms/step
Epoch 35/50
8543/8543 - 441s - loss: 2.7953 - accuracy30: 0.5211 - val_loss: 3.0874 - val_accuracy30: 0.4652 - 441s/epoch - 52ms/step
Epoch 36/50
8543/8543 - 440s - loss: 2.7944 - accuracy30: 0.5211 - val_loss: 3.0925 - val_accuracy30: 0.4714 - 440s/epoch - 51ms/step
Epoch 37/50
8543/8543 - 432s - loss: 2.7933 - accuracy30: 0.5218 - val_loss: 3.1396 - val_accuracy30: 0.4679 - 432s/epoch - 51ms/step
Epoch 38/50
8543/8543 - 448s - loss: 2.7919 - accuracy30: 0.5221 - val_loss: 3.0958 - val_accuracy30: 0.4686 - 448s/epoch - 52ms/step
Epoch 39/50
8543/8543 - 435s - loss: 2.7909 - accuracy30: 0.5223 - val_loss: 3.1322 - val_accuracy30: 0.4689 - 435s/epoch - 51ms/step
Epoch 40/50
8543/8543 - 441s - loss: 2.7894 - accuracy30: 0.5228 - val_loss: 3.0865 - val_accuracy30: 0.4662 - 441s/epoch - 52ms/step
Epoch 41/50
8543/8543 - 438s - loss: 2.7882 - accuracy30: 0.5233 - val_loss: 3.1508 - val_accuracy30: 0.4665 - 438s/epoch - 51ms/step
Epoch 42/50
8543/8543 - 436s - loss: 2.7877 - accuracy30: 0.5232 - val_loss: 3.1424 - val_accuracy30: 0.4703 - 436s/epoch - 51ms/step
Epoch 43/50
8543/8543 - 432s - loss: 2.7866 - accuracy30: 0.5238 - val_loss: 3.1335 - val_accuracy30: 0.4664 - 432s/epoch - 51ms/step
Epoch 44/50
8543/8543 - 431s - loss: 2.7854 - accuracy30: 0.5242 - val_loss: 3.1214 - val_accuracy30: 0.4693 - 431s/epoch - 50ms/step
Epoch 45/50
8543/8543 - 439s - loss: 2.7840 - accuracy30: 0.5243 - val_loss: 3.1359 - val_accuracy30: 0.4681 - 439s/epoch - 51ms/step
Epoch 46/50
8543/8543 - 436s - loss: 2.7831 - accuracy30: 0.5246 - val_loss: 3.1110 - val_accuracy30: 0.4656 - 436s/epoch - 51ms/step
Epoch 47/50
8543/8543 - 433s - loss: 2.7819 - accuracy30: 0.5250 - val_loss: 3.1121 - val_accuracy30: 0.4663 - 433s/epoch - 51ms/step
Epoch 48/50
8543/8543 - 439s - loss: 2.7813 - accuracy30: 0.5252 - val_loss: 3.1719 - val_accuracy30: 0.4657 - 439s/epoch - 51ms/step
Epoch 49/50
8543/8543 - 449s - loss: 2.7803 - accuracy30: 0.5256 - val_loss: 3.1243 - val_accuracy30: 0.4668 - 449s/epoch - 53ms/step
Epoch 50/50
8543/8543 - 448s - loss: 2.7791 - accuracy30: 0.5259 - val_loss: 3.1256 - val_accuracy30: 0.4664 - 448s/epoch - 52ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1019s - 1019s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0391586
{'0': {'precision': 0.41624237715124385, 'recall': 0.4451198608632372, 'f1-score': 0.4301970549115944, 'support': 2946166}, '1': {'precision': 0.6521702254526015, 'recall': 0.4224204160961541, 'f1-score': 0.5127348170539808, 'support': 3604215}, '2': {'precision': 0.41471213093694076, 'recall': 0.562229498300109, 'f1-score': 0.47733331519046046, 'support': 2994898}, 'accuracy': 0.47329271360219016, 'macro avg': {'precision': 0.49437491118026206, 'recall': 0.47658992508650017, 'f1-score': 0.4734217290520119, 'support': 9545279}, 'weighted avg': {'precision': 0.50484657179435, 'recall': 0.47329271360219016, 'f1-score': 0.47615193292162183, 'support': 9545279}}
[[1311397  451471 1183298]
 [ 888625 1522494 1193096]
 [ 950539  360539 1683820]]
Evaluating performance on  train set...
8543/8543 - 257s - 257s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0560694
{'0': {'precision': 0.39849261556255483, 'recall': 0.5040334714103705, 'f1-score': 0.44509210149715733, 'support': 624772}, '1': {'precision': 0.7228438807661343, 'recall': 0.39383571287769986, 'f1-score': 0.5098718319941165, 'support': 923286}, '2': {'precision': 0.4032909051836066, 'recall': 0.5641685273274439, 'f1-score': 0.4703536467083613, 'support': 638662}, 'accuracy': 0.4750685958879052, 'macro avg': {'precision': 0.5082091338374319, 'recall': 0.4873459038718381, 'f1-score': 0.47510586006654504, 'support': 2186720}, 'weighted avg': {'precision': 0.5368429610529296, 'recall': 0.4750685958879052, 'f1-score': 0.4798216540870149, 'support': 2186720}}
[[314906  79120 230746]
 [257290 363623 302373]
 [218047  60302 360313]]
Evaluating performance on  val set...
3077/3077 - 84s - 84s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0818768
{'0': {'precision': 0.3759619829514987, 'recall': 0.49365103258731957, 'f1-score': 0.4268427858858304, 'support': 205939}, '1': {'precision': 0.7304493098572413, 'recall': 0.3925917111113515, 'f1-score': 0.5106996789656537, 'support': 369748}, '2': {'precision': 0.37594985699047545, 'recall': 0.5655744688908244, 'f1-score': 0.4516668021252507, 'support': 211256}, 'accuracy': 0.4654758985085324, 'macro avg': {'precision': 0.4941203832664051, 'recall': 0.4839390708631652, 'f1-score': 0.46306975565891156, 'support': 786943}, 'weighted avg': {'precision': 0.5425158737246838, 'recall': 0.4654758985085324, 'f1-score': 0.4729072923077104, 'support': 786943}}
[[101662  30323  73954]
 [100212 145160 124376]
 [ 68531  23244 119481]]
testing model out of sample: results/universal/W10/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 596s - 596s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88135177
{'0': {'precision': 0.492015937329984, 'recall': 0.4769012420872638, 'f1-score': 0.48434069830514104, 'support': 1407067}, '1': {'precision': 0.7087797763116337, 'recall': 0.6739947139356277, 'f1-score': 0.6909497187688141, 'support': 2650365}, '2': {'precision': 0.46326518315558474, 'recall': 0.5204725492333795, 'f1-score': 0.49020547430363165, 'support': 1403367}, 'accuracy': 0.5837566993401515, 'macro avg': {'precision': 0.5546869655990675, 'recall': 0.5571228350854237, 'f1-score': 0.5551652971258623, 'support': 5460799}, 'weighted avg': {'precision': 0.5898322884663536, 'recall': 0.5837566993401515, 'f1-score': 0.5861242925410535, 'support': 5460799}}
[[ 671032  405008  331027]
 [ 348809 1786332  515224]
 [ 344001  328952  730414]]
Evaluating performance on  train set...
4055/4055 - 122s - 122s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88596964
{'0': {'precision': 0.4689028175197953, 'recall': 0.4911238850346878, 'f1-score': 0.4797561835129556, 'support': 252250}, '1': {'precision': 0.7323982075928005, 'recall': 0.6496942661916058, 'f1-score': 0.6885717490945222, 'support': 529055}, '2': {'precision': 0.4526899655550182, 'recall': 0.5371367229433005, 'f1-score': 0.49131106977209194, 'support': 256175}, 'accuracy': 0.5833471488607009, 'macro avg': {'precision': 0.551330330222538, 'recall': 0.5593182913898648, 'f1-score': 0.5532130007931899, 'support': 1037480}, 'weighted avg': {'precision': 0.599266994412841, 'recall': 0.5833471488607009, 'f1-score': 0.589093223298002, 'support': 1037480}}
[[123886  70307  58057]
 [ 77026 343724 108305]
 [ 63292  55282 137601]]
Evaluating performance on  val set...
1545/1545 - 42s - 42s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8892157
{'0': {'precision': 0.46492825406074734, 'recall': 0.4705739863085835, 'f1-score': 0.46773408425934165, 'support': 94950}, '1': {'precision': 0.7329824047251372, 'recall': 0.6437300467740737, 'f1-score': 0.6854631076583331, 'support': 202035}, '2': {'precision': 0.4491546371366423, 'recall': 0.5567095588235295, 'f1-score': 0.4971817883331509, 'support': 97920}, 'accuracy': 0.580519365416999, 'macro avg': {'precision': 0.549021765307509, 'recall': 0.5570045306353956, 'f1-score': 0.5501263267502752, 'support': 394905}, 'weighted avg': {'precision': 0.598154644611061, 'recall': 0.580519365416999, 'f1-score': 0.586426940580033, 'support': 394905}}
[[ 44681  26975  23294]
 [ 28418 130056  43561]
 [ 23004  20403  54513]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1016616
{'0': {'precision': 0.45690126354370963, 'recall': 0.5501955166673119, 'f1-score': 0.4992271481767723, 'support': 51658}, '1': {'precision': 0.3970759477293311, 'recall': 0.09313264346190028, 'f1-score': 0.1508775379774839, 'support': 32953}, '2': {'precision': 0.4254487435181492, 'recall': 0.5555324069251443, 'f1-score': 0.4818656595044907, 'support': 47999}, 'accuracy': 0.4385491290249604, 'macro avg': {'precision': 0.42647531826373, 'recall': 0.39962018901811885, 'f1-score': 0.3773234485529156, 'support': 132610}, 'weighted avg': {'precision': 0.43065050462101834, 'recall': 0.4385491290249604, 'f1-score': 0.40637970982613514, 'support': 132610}}
[[28422  2693 20543]
 [14417  3069 15467]
 [19367  1967 26665]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1334453
{'0': {'precision': 0.42011986853128824, 'recall': 0.5693449781659389, 'f1-score': 0.48347980865502277, 'support': 11450}, '1': {'precision': 0.5007598784194529, 'recall': 0.11574602617019408, 'f1-score': 0.18803052999500675, 'support': 11387}, '2': {'precision': 0.4025596636577223, 'recall': 0.566864008358001, 'f1-score': 0.4707881417208966, 'support': 11486}, 'accuracy': 0.4180287270926201, 'macro avg': {'precision': 0.44114647020282116, 'recall': 0.4173183375647113, 'f1-score': 0.38076616012364206, 'support': 34323}, 'weighted avg': {'precision': 0.4409965774267447, 'recall': 0.4180287270926201, 'f1-score': 0.38121434752088607, 'support': 34323}}
[[6519  757 4174]
 [4580 1318 5489]
 [4418  557 6511]]
Evaluating performance on  val set...
46/46 - 1s - 775ms/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1256042
{'0': {'precision': 0.42691415313225056, 'recall': 0.45942571785268416, 'f1-score': 0.4425736620565243, 'support': 4005}, '1': {'precision': 0.4673698088332235, 'recall': 0.18623588127134227, 'f1-score': 0.2663410969196094, 'support': 3807}, '2': {'precision': 0.4006831767719898, 'recall': 0.6062015503875969, 'f1-score': 0.4824678663239075, 'support': 3870}, 'accuracy': 0.4190207156308851, 'macro avg': {'precision': 0.431655712912488, 'recall': 0.4172877165038744, 'f1-score': 0.3971275417666804, 'support': 11682}, 'weighted avg': {'precision': 0.43140831532531637, 'recall': 0.4190207156308851, 'f1-score': 0.39835804786704804, 'support': 11682}}
[[1840  497 1668]
 [1257  709 1841]
 [1213  311 2346]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
1840/1840 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68822837
{'0': {'precision': 0.4990624595887754, 'recall': 0.4585610741444867, 'f1-score': 0.4779552913493096, 'support': 67328}, '1': {'precision': 0.8415290400443052, 'recall': 0.7811995732578907, 'f1-score': 0.8102428484685967, 'support': 336503}, '2': {'precision': 0.4029093089615814, 'recall': 0.5804784318398475, 'f1-score': 0.47566215061637984, 'support': 67136}, 'accuracy': 0.7064635101822421, 'macro avg': {'precision': 0.5811669361982207, 'recall': 0.6067463597474083, 'f1-score': 0.5879534301447621, 'support': 470967}, 'weighted avg': {'precision': 0.7300461459245906, 'recall': 0.7064635101822421, 'f1-score': 0.7150458041390921, 'support': 470967}}
[[ 30874  28392   8062]
 [ 23936 262876  49691]
 [  7054  21111  38971]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.54056007
{'0': {'precision': 0.5364610333506135, 'recall': 0.4778727006849842, 'f1-score': 0.5054748239508283, 'support': 12993}, '1': {'precision': 0.9011515198511166, 'recall': 0.8523883744384341, 'f1-score': 0.8760919345263336, 'support': 109070}, '2': {'precision': 0.39939009632605643, 'recall': 0.6186084870295396, 'f1-score': 0.485395770215019, 'support': 13338}, 'accuracy': 0.7934210234784086, 'macro avg': {'precision': 0.6123342165092621, 'recall': 0.6496231873843193, 'f1-score': 0.6223208428973935, 'support': 135401}, 'weighted avg': {'precision': 0.8167288246119508, 'recall': 0.7934210234784086, 'f1-score': 0.8020412734729303, 'support': 135401}}
[[ 6209  5885   899]
 [ 4591 92970 11509]
 [  774  4313  8251]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.60654587
{'0': {'precision': 0.5363839669705832, 'recall': 0.47932359723289775, 'f1-score': 0.5062510147751258, 'support': 6505}, '1': {'precision': 0.8666419511161719, 'recall': 0.8226378101199004, 'f1-score': 0.8440667474789157, 'support': 39783}, '2': {'precision': 0.4327792972859247, 'recall': 0.6055342949661466, 'f1-score': 0.5047852760736196, 'support': 6794}, 'accuracy': 0.7527787197166648, 'macro avg': {'precision': 0.6119350717908932, 'recall': 0.6358319007729816, 'f1-score': 0.6183676794425538, 'support': 53082}, 'weighted avg': {'precision': 0.7706397082280035, 'recall': 0.7527787197166648, 'f1-score': 0.7592438384331802, 'support': 53082}}
[[ 3118  2816   571]
 [ 2235 32727  4821]
 [  460  2220  4114]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
967/967 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2278466
{'0': {'precision': 0.39273825946140467, 'recall': 0.6010417981344012, 'f1-score': 0.47505905931323433, 'support': 87157}, '1': {'precision': 0.3207489569553272, 'recall': 0.041222012973425405, 'f1-score': 0.0730551274176913, 'support': 76464}, '2': {'precision': 0.3922820335863814, 'recall': 0.4876903644033461, 'f1-score': 0.43481401995261515, 'support': 83918}, 'accuracy': 0.3896880895535653, 'macro avg': {'precision': 0.3685897500010378, 'recall': 0.3766513918370576, 'f1-score': 0.32764273556118023, 'support': 247539}, 'weighted avg': {'precision': 0.3703463309579975, 'recall': 0.3896880895535653, 'f1-score': 0.33723790037858065, 'support': 247539}}
[[52385  3739 31033]
 [40943  3152 32369]
 [40056  2936 40926]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2095072
{'0': {'precision': 0.3847691099850118, 'recall': 0.5813652539631188, 'f1-score': 0.4630647655042089, 'support': 18546}, '1': {'precision': 0.4176272388721404, 'recall': 0.12697471289157275, 'f1-score': 0.19474075911684444, 'support': 18547}, '2': {'precision': 0.4126260838789595, 'recall': 0.486490715626956, 'f1-score': 0.44652432018383764, 'support': 19172}, 'accuracy': 0.3992535323913623, 'macro avg': {'precision': 0.40500747757870387, 'recall': 0.3982768941605492, 'f1-score': 0.368109948268297, 'support': 56265}, 'weighted avg': {'precision': 0.40509246588946995, 'recall': 0.3992535323913623, 'f1-score': 0.3689792991548157, 'support': 56265}}
[[10782  1702  6062]
 [ 8977  2355  7215]
 [ 8263  1582  9327]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2135757
{'0': {'precision': 0.391500904159132, 'recall': 0.625, 'f1-score': 0.4814320658216589, 'support': 6928}, '1': {'precision': 0.3638790035587189, 'recall': 0.06452121785770626, 'f1-score': 0.10960739648934743, 'support': 6339}, '2': {'precision': 0.4132959040449151, 'recall': 0.47956766360675157, 'f1-score': 0.4439723116989925, 'support': 6754}, 'accuracy': 0.39848159432595776, 'macro avg': {'precision': 0.389558603920922, 'recall': 0.3896962938214859, 'f1-score': 0.34500392466999963, 'support': 20021}, 'weighted avg': {'precision': 0.3901077770087679, 'recall': 0.39848159432595776, 'f1-score': 0.35106895917154096, 'support': 20021}}
[[4330  421 2177]
 [3509  409 2421]
 [3221  294 3239]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2504044
{'0': {'precision': 0.33835092075315537, 'recall': 0.046199701937406856, 'f1-score': 0.08129858992126181, 'support': 141581}, '1': {'precision': 0.3118604059151605, 'recall': 0.5449347330281611, 'f1-score': 0.39669591788072456, 'support': 123646}, '2': {'precision': 0.3623602244600612, 'recall': 0.43901488029831487, 'f1-score': 0.3970213939055898, 'support': 141059}, 'accuracy': 0.3343629856800382, 'macro avg': {'precision': 0.3375238503761257, 'recall': 0.34338310508796094, 'f1-score': 0.29167196723585875, 'support': 406286}, 'weighted avg': {'precision': 0.33862482183252735, 'recall': 0.3343629856800382, 'f1-score': 0.2869004590974113, 'support': 406286}}
[[ 6541 75649 59391]
 [ 6686 67379 49581]
 [ 6105 73027 61927]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2277651
{'0': {'precision': 0.37310385064177365, 'recall': 0.048705255140898705, 'f1-score': 0.08616275936405282, 'support': 26260}, '1': {'precision': 0.3504785581106277, 'recall': 0.5667082043654782, 'f1-score': 0.4331049737335259, 'support': 24877}, '2': {'precision': 0.3382856424914408, 'recall': 0.44224530858621114, 'f1-score': 0.3833422317138281, 'support': 24353}, 'accuracy': 0.3463637567889787, 'macro avg': {'precision': 0.3539560170812807, 'recall': 0.3525529226975294, 'f1-score': 0.30086998827046896, 'support': 75490}, 'weighted avg': {'precision': 0.35441558431004266, 'recall': 0.3463637567889787, 'f1-score': 0.2963640198886714, 'support': 75490}}
[[ 1279 13592 11389]
 [ 1101 14098  9678]
 [ 1048 12535 10770]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2244748
{'0': {'precision': 0.31091445427728615, 'recall': 0.04641944860389324, 'f1-score': 0.08077866339668914, 'support': 11353}, '1': {'precision': 0.3673647978531008, 'recall': 0.554069511658601, 'f1-score': 0.4418017259524311, 'support': 11365}, '2': {'precision': 0.33778757404601184, 'recall': 0.4610755923279428, 'f1-score': 0.3899181044764252, 'support': 10636}, 'accuracy': 0.3516219943634946, 'macro avg': {'precision': 0.33868894205879957, 'recall': 0.35385485086347906, 'f1-score': 0.30416616460851514, 'support': 33354}, 'weighted avg': {'precision': 0.3387186353829796, 'recall': 0.3516219943634946, 'f1-score': 0.30237230137924237, 'support': 33354}}
[[ 527 5629 5197]
 [ 651 6297 4417]
 [ 517 5215 4904]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1125324
{'0': {'precision': 0.4466254528272169, 'recall': 0.5356147823541079, 'f1-score': 0.48708897506259047, 'support': 211766}, '1': {'precision': 0.2400519361490873, 'recall': 0.05356534187742859, 'f1-score': 0.08758656244339477, 'support': 117352}, '2': {'precision': 0.44685873498055456, 'recall': 0.5513433249141771, 'f1-score': 0.49363268342103805, 'support': 209443}, 'accuracy': 0.43669333650227177, 'macro avg': {'precision': 0.37784537465228624, 'recall': 0.38017448304857115, 'f1-score': 0.3561027403090078, 'support': 538561}, 'weighted avg': {'precision': 0.40170397500916033, 'recall': 0.43669333650227177, 'f1-score': 0.4025825343511956, 'support': 538561}}
[[113425  11216  87125]
 [ 55251   6286  55815]
 [ 85284   8684 115475]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2089483
{'0': {'precision': 0.39061923389180014, 'recall': 0.5852269585890418, 'f1-score': 0.4685183135996459, 'support': 36174}, '1': {'precision': 0.4548993061431714, 'recall': 0.07401900041305245, 'f1-score': 0.1273209549071618, 'support': 36315}, '2': {'precision': 0.41521391402943975, 'recall': 0.5541683556276179, 'f1-score': 0.47473204157696136, 'support': 37005}, 'accuracy': 0.4051820191060697, 'macro avg': {'precision': 0.4202441513548038, 'recall': 0.4044714382099041, 'f1-score': 0.35685710336125637, 'support': 109494}, 'weighted avg': {'precision': 0.4202506014763427, 'recall': 0.4051820191060697, 'f1-score': 0.3574561268394855, 'support': 109494}}
[[21170  1822 13182]
 [17927  2688 15700]
 [15099  1399 20507]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2028052
{'0': {'precision': 0.39303453852373804, 'recall': 0.5706977524320698, 'f1-score': 0.4654901156029825, 'support': 11924}, '1': {'precision': 0.41003948110547095, 'recall': 0.06294372294372294, 'f1-score': 0.10913457929895669, 'support': 11550}, '2': {'precision': 0.41495304885296563, 'recall': 0.5612991398022349, 'f1-score': 0.4771570134973518, 'support': 12439}, 'accuracy': 0.40414334642051625, 'macro avg': {'precision': 0.40600902282739154, 'recall': 0.39831353839267586, 'f1-score': 0.3505939027997636, 'support': 35913}, 'weighted avg': {'precision': 0.4060953086293899, 'recall': 0.40414334642051625, 'f1-score': 0.3549234154831529, 'support': 35913}}
[[6805  591 4528]
 [5507  727 5316]
 [5002  455 6982]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
5267/5267 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72374165
{'0': {'precision': 0.5692549091471341, 'recall': 0.4107491870137061, 'f1-score': 0.4771837016839801, 'support': 242009}, '1': {'precision': 0.7698429819471346, 'recall': 0.7733831667390989, 'f1-score': 0.7716090137236243, 'support': 862875}, '2': {'precision': 0.4487925587582281, 'recall': 0.5657713569388216, 'f1-score': 0.5005381544212295, 'support': 243305}, 'accuracy': 0.6708206341989142, 'macro avg': {'precision': 0.5959634832841657, 'recall': 0.5833012368972089, 'f1-score': 0.5831102899429447, 'support': 1348189}, 'weighted avg': {'precision': 0.6758967384128585, 'recall': 0.6708206341989142, 'f1-score': 0.6698380670952425, 'support': 1348189}}
[[ 99405 114163  28441]
 [ 54915 667333 140627]
 [ 20303  85347 137655]]
Evaluating performance on  train set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6101474
{'0': {'precision': 0.5657963961594108, 'recall': 0.45783998084240213, 'f1-score': 0.5061254504007648, 'support': 37583}, '1': {'precision': 0.8453684210526315, 'recall': 0.8218547248204016, 'f1-score': 0.8334457601261946, 'support': 195436}, '2': {'precision': 0.45902735442764153, 'recall': 0.610344106265035, 'f1-score': 0.5239800213255513, 'support': 38244}, 'accuracy': 0.7416013241761685, 'macro avg': {'precision': 0.6233973905465613, 'recall': 0.6300129373092795, 'f1-score': 0.6211837439508369, 'support': 271263}, 'weighted avg': {'precision': 0.7521659453608932, 'recall': 0.7416013241761685, 'f1-score': 0.7444661096943164, 'support': 271263}}
[[ 17207  17268   3108]
 [ 10415 160620  24401]
 [  2790  12112  23342]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.62631243
{'0': {'precision': 0.5761216444527877, 'recall': 0.4512903462980663, 'f1-score': 0.5061224489795918, 'support': 13601}, '1': {'precision': 0.8513408256370313, 'recall': 0.804743685822848, 'f1-score': 0.8273867054171877, 'support': 76059}, '2': {'precision': 0.40563866513233604, 'recall': 0.6154517677869926, 'f1-score': 0.48898907577596673, 'support': 13746}, 'accuracy': 0.7330909231572637, 'macro avg': {'precision': 0.6110337117407183, 'recall': 0.6238285999693024, 'f1-score': 0.6074994100575821, 'support': 103406}, 'weighted avg': {'precision': 0.755892998803149, 'recall': 0.7330909231572637, 'f1-score': 0.7401468066796294, 'support': 103406}}
[[ 6138  6332  1131]
 [ 3586 61208 11265]
 [  930  4356  8460]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
10110/10110 - 143s - 143s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7278939
{'0': {'precision': 0.6189455502720925, 'recall': 0.37627221567416097, 'f1-score': 0.46802221895849944, 'support': 474271}, '1': {'precision': 0.7665150894967412, 'recall': 0.8160903030454908, 'f1-score': 0.7905262229284918, 'support': 1636091}, '2': {'precision': 0.47037945912420925, 'recall': 0.549278999621132, 'f1-score': 0.5067766692545085, 'support': 477739}, 'accuracy': 0.6862425384480745, 'macro avg': {'precision': 0.6186133662976809, 'recall': 0.5805471727802612, 'f1-score': 0.5884417037138333, 'support': 2588101}, 'weighted avg': {'precision': 0.684809046009197, 'recall': 0.6862425384480745, 'f1-score': 0.6790496907183858, 'support': 2588101}}
[[ 178455  230993   64823]
 [  70255 1335198  230638]
 [  39611  175716  262412]]
Evaluating performance on  train set...
1686/1686 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6941793
{'0': {'precision': 0.5837646902006087, 'recall': 0.3778688524590164, 'f1-score': 0.45877454104213766, 'support': 69540}, '1': {'precision': 0.8061005507677471, 'recall': 0.8107669661854557, 'f1-score': 0.8084270246432408, 'support': 292803}, '2': {'precision': 0.43902147582476075, 'recall': 0.583820873961719, 'f1-score': 0.5011718604680001, 'support': 69225}, 'accuracy': 0.7046097022948875, 'macro avg': {'precision': 0.6096289055977056, 'recall': 0.5908188975353971, 'f1-score': 0.589457808717793, 'support': 431568}, 'weighted avg': {'precision': 0.7113940741365626, 'recall': 0.7046097022948875, 'f1-score': 0.7028015555406851, 'support': 431568}}
[[ 26277  33984   9279]
 [ 13045 237395  42363]
 [  5691  23119  40415]]
Evaluating performance on  val set...
705/705 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7466777
{'0': {'precision': 0.548002437113761, 'recall': 0.3818882115670397, 'f1-score': 0.450108130328323, 'support': 32973}, '1': {'precision': 0.7874102902845718, 'recall': 0.7811902231668438, 'f1-score': 0.7842879243202874, 'support': 112920}, '2': {'precision': 0.45064746300211417, 'recall': 0.5927696184930912, 'f1-score': 0.5120294261156777, 'support': 34521}, 'accuracy': 0.672159588502001, 'macro avg': {'precision': 0.595353396800149, 'recall': 0.5852826844089916, 'f1-score': 0.5821418269214294, 'support': 180414}, 'weighted avg': {'precision': 0.6792181061790208, 'recall': 0.672159588502001, 'f1-score': 0.6711174056032345, 'support': 180414}}
[[12592 13846  6535]
 [ 6298 88212 18410]
 [ 4088  9970 20463]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
6546/6546 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9266637
{'0': {'precision': 0.49627614114035545, 'recall': 0.4374433074826436, 'f1-score': 0.4650062219980902, 'support': 455307}, '1': {'precision': 0.6357100288007393, 'recall': 0.6284070751674908, 'f1-score': 0.632037456971793, 'support': 770639}, '2': {'precision': 0.46652114884951196, 'recall': 0.5316824617682955, 'f1-score': 0.4969749863632822, 'support': 449823}, 'accuracy': 0.5505585793746035, 'macro avg': {'precision': 0.5328357729302023, 'recall': 0.5325109481394766, 'f1-score': 0.5313395551110551, 'support': 1675769}, 'weighted avg': {'precision': 0.5524107944580063, 'recall': 0.5505585793746035, 'f1-score': 0.5504004913645382, 'support': 1675769}}
[[199171 158151  97985]
 [110860 484275 175504]
 [ 91300 119360 239163]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.916645
{'0': {'precision': 0.5194757001047009, 'recall': 0.43457436193094884, 'f1-score': 0.47324732714748824, 'support': 90194}, '1': {'precision': 0.6258020689502404, 'recall': 0.6256265271021414, 'f1-score': 0.6257142857142857, 'support': 135469}, '2': {'precision': 0.48361665671986603, 'recall': 0.5638277576396916, 'f1-score': 0.5206510080676502, 'support': 89107}, 'accuracy': 0.5533881882009086, 'macro avg': {'precision': 0.5429648085916025, 'recall': 0.5413428822242606, 'f1-score': 0.5398708736431413, 'support': 314770}, 'weighted avg': {'precision': 0.5550846688191398, 'recall': 0.5533881882009086, 'f1-score': 0.5522845486293269, 'support': 314770}}
[[39196 28879 22119]
 [19190 84753 31526]
 [17067 21799 50241]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86409307
{'0': {'precision': 0.518908788004998, 'recall': 0.4359189671460061, 'f1-score': 0.47380730543248845, 'support': 28581}, '1': {'precision': 0.6791363207951332, 'recall': 0.6967720383979746, 'f1-score': 0.687841156613123, 'support': 56878}, '2': {'precision': 0.4837619492098233, 'recall': 0.5372654155495978, 'f1-score': 0.5091118487907325, 'support': 27975}, 'accuracy': 0.5917097166634342, 'macro avg': {'precision': 0.5606023526699848, 'recall': 0.5566521403645263, 'f1-score': 0.5569201036121146, 'support': 113434}, 'weighted avg': {'precision': 0.5905820852063864, 'recall': 0.5917097166634342, 'f1-score': 0.5898347926752816, 'support': 113434}}
[[12459 10447  5675]
 [ 6883 39631 10364]
 [ 4668  8277 15030]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
7633/7633 - 109s - 109s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9618602
{'0': {'precision': 0.47712830292519665, 'recall': 0.5122334532775693, 'f1-score': 0.49405806669112967, 'support': 582215}, '1': {'precision': 0.5969717748408883, 'recall': 0.55718376391261, 'f1-score': 0.5763919494155424, 'support': 787505}, '2': {'precision': 0.47963186837240157, 'recall': 0.48755365688348495, 'f1-score': 0.48356032069639254, 'support': 584268}, 'accuracy': 0.5229699465912789, 'macro avg': {'precision': 0.5179106487128289, 'recall': 0.5189902913578881, 'f1-score': 0.5180034456010215, 'support': 1953988}, 'weighted avg': {'precision': 0.5261767548745814, 'recall': 0.5229699465912789, 'f1-score': 0.5241016735392964, 'support': 1953988}}
[[298230 156397 127588]
 [167252 438785 181468]
 [159570 139836 284862]]
Evaluating performance on  train set...
1586/1586 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9366203
{'0': {'precision': 0.48903749268204194, 'recall': 0.5089153938561867, 'f1-score': 0.49877847252299035, 'support': 116540}, '1': {'precision': 0.6229831681689159, 'recall': 0.5887013758580731, 'f1-score': 0.6053573102757893, 'support': 170003}, '2': {'precision': 0.49423348533150396, 'recall': 0.5133669217936573, 'f1-score': 0.5036185400835553, 'support': 119287}, 'accuracy': 0.543646354384841, 'macro avg': {'precision': 0.5354180487274872, 'recall': 0.5369945638359724, 'f1-score': 0.535918107627445, 'support': 405830}, 'weighted avg': {'precision': 0.546674880368934, 'recall': 0.543646354384841, 'f1-score': 0.5448472187802562, 'support': 405830}}
[[ 59309  32072  25159]
 [ 32414 100081  37508]
 [ 29554  28495  61238]]
Evaluating performance on  val set...
574/574 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9244448
{'0': {'precision': 0.47292169713694376, 'recall': 0.4906441717791411, 'f1-score': 0.4816199533284822, 'support': 39120}, '1': {'precision': 0.6562540951382518, 'recall': 0.5942390127412154, 'f1-score': 0.623708812379833, 'support': 67419}, '2': {'precision': 0.47414955460754626, 'recall': 0.5318078143593812, 'f1-score': 0.5013262909426599, 'support': 40336}, 'accuracy': 0.5495012765957447, 'macro avg': {'precision': 0.5344417822942473, 'recall': 0.5388969996265792, 'f1-score': 0.535551685550325, 'support': 146875}, 'weighted avg': {'precision': 0.557412684709944, 'recall': 0.5495012765957447, 'f1-score': 0.5522539184170846, 'support': 146875}}
[[19194 11506  8420]
 [11986 40063 15370]
 [ 9406  9479 21451]]
testing model on single stock: results/universal/W10/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
22048/22048 - 313s - 313s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1619556
{'0': {'precision': 0.3911383797731852, 'recall': 0.4782368705761588, 'f1-score': 0.43032463744462834, 'support': 2039941}, '1': {'precision': 0.2273992360305137, 'recall': 0.026720033471207875, 'f1-score': 0.04782097170337775, 'support': 1510552}, '2': {'precision': 0.40569409025763864, 'recall': 0.5759893961286316, 'f1-score': 0.4760709481233055, 'support': 2093575}, 'accuracy': 0.3936547185469771, 'macro avg': {'precision': 0.3414105686871125, 'recall': 0.3603154333919994, 'f1-score': 0.3180721857571039, 'support': 5644068}, 'weighted avg': {'precision': 0.35271520353199, 'recall': 0.3936547185469771, 'f1-score': 0.3449219908227829, 'support': 5644068}}
[[ 975575   75187  989179]
 [ 692866   40362  777324]
 [ 825753   61945 1205877]]
Evaluating performance on  train set...
5429/5429 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2157972
{'0': {'precision': 0.3745924737255746, 'recall': 0.5477059129378559, 'f1-score': 0.4449026817530061, 'support': 457742}, '1': {'precision': 0.324119209550775, 'recall': 0.024221589149146877, 'f1-score': 0.04507472198711977, 'support': 458434}, '2': {'precision': 0.3902485227794333, 'recall': 0.5654533170051941, 'f1-score': 0.4617911412867766, 'support': 473620}, 'accuracy': 0.38107894971636125, 'macro avg': {'precision': 0.3629867353519276, 'recall': 0.3791269396973989, 'f1-score': 0.31725618167563413, 'support': 1389796}, 'weighted avg': {'precision': 0.36327884033202507, 'recall': 0.38107894971636125, 'f1-score': 0.3187719268055678, 'support': 1389796}}
[[250708  13641 193393]
 [222278  11104 225052]
 [196296   9514 267810]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2721382
{'0': {'precision': 0.34890794568958317, 'recall': 0.5440681567385657, 'f1-score': 0.42516188813248845, 'support': 145899}, '1': {'precision': 0.3918742757821553, 'recall': 0.029144202129665037, 'f1-score': 0.05425350050884589, 'support': 185663}, '2': {'precision': 0.36134217996963097, 'recall': 0.5757338680516748, 'f1-score': 0.4440129088848721, 'support': 152105}, 'accuracy': 0.3563650197346521, 'macro avg': {'precision': 0.36737480048045645, 'recall': 0.3829820756399685, 'f1-score': 0.3078094325087355, 'support': 483667}, 'weighted avg': {'precision': 0.369311584865181, 'recall': 0.3563650197346521, 'f1-score': 0.288711335459209, 'support': 483667}}
[[79379  5226 61294]
 [86766  5411 93486]
 [61362  3171 87572]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        78 (peak)  20.91 (ave)

============================================
