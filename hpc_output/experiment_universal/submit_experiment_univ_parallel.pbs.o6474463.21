This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W7/deepLOB_L1/h10
Epoch 1/50
12475/12475 - 291s - loss: 2.9667 - accuracy10: 0.4883 - val_loss: 3.8476 - val_accuracy10: 0.4178 - 291s/epoch - 23ms/step
Epoch 2/50
12475/12475 - 274s - loss: 2.9039 - accuracy10: 0.5063 - val_loss: 4.0670 - val_accuracy10: 0.4193 - 274s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 267s - loss: 2.8773 - accuracy10: 0.5133 - val_loss: 4.1828 - val_accuracy10: 0.4222 - 267s/epoch - 21ms/step
Epoch 4/50
12475/12475 - 271s - loss: 2.8613 - accuracy10: 0.5176 - val_loss: 4.1147 - val_accuracy10: 0.4219 - 271s/epoch - 22ms/step
Epoch 5/50
12475/12475 - 271s - loss: 2.8526 - accuracy10: 0.5197 - val_loss: 4.0961 - val_accuracy10: 0.4241 - 271s/epoch - 22ms/step
Epoch 6/50
12475/12475 - 270s - loss: 2.8448 - accuracy10: 0.5218 - val_loss: 4.0489 - val_accuracy10: 0.4237 - 270s/epoch - 22ms/step
Epoch 7/50
12475/12475 - 266s - loss: 2.8389 - accuracy10: 0.5233 - val_loss: 4.0279 - val_accuracy10: 0.4248 - 266s/epoch - 21ms/step
Epoch 8/50
12475/12475 - 270s - loss: 2.8339 - accuracy10: 0.5245 - val_loss: 3.9865 - val_accuracy10: 0.4247 - 270s/epoch - 22ms/step
Epoch 9/50
12475/12475 - 265s - loss: 2.8289 - accuracy10: 0.5259 - val_loss: 4.1150 - val_accuracy10: 0.4245 - 265s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 265s - loss: 2.8250 - accuracy10: 0.5268 - val_loss: 4.0394 - val_accuracy10: 0.4261 - 265s/epoch - 21ms/step
Epoch 11/50
12475/12475 - 275s - loss: 2.8212 - accuracy10: 0.5280 - val_loss: 4.0953 - val_accuracy10: 0.4279 - 275s/epoch - 22ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 500s - 500s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0991251
{'0': {'precision': 0.35983312033487064, 'recall': 0.06431592276560702, 'f1-score': 0.10912673057938513, 'support': 2416540}, '1': {'precision': 0.49156616256291225, 'recall': 0.9187284386204297, 'f1-score': 0.6404559907286342, 'support': 4691838}, '2': {'precision': 0.40525203326747233, 'recall': 0.051507303956208804, 'f1-score': 0.09139797681314762, 'support': 2397194}, 'accuracy': 0.4828136591885265, 'macro avg': {'precision': 0.4188837720550851, 'recall': 0.34485055511408186, 'f1-score': 0.28032689937372235, 'support': 9505572}, 'weighted avg': {'precision': 0.4363091113588391, 'recall': 0.4828136591885265, 'f1-score': 0.3669135898156552, 'support': 9505572}}
[[ 155422 2230880   30238]
 [ 230342 4310525  150971]
 [  46164 2227557  123473]]
Evaluating performance on  train set...
12475/12475 - 169s - 169s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1916028
{'0': {'precision': 0.4264717807330522, 'recall': 0.06629905642736633, 'f1-score': 0.11475791391565399, 'support': 951914}, '1': {'precision': 0.40398118203720185, 'recall': 0.9181869475268009, 'f1-score': 0.561093918540186, 'support': 1297348}, '2': {'precision': 0.41026465342016843, 'recall': 0.04191574258705561, 'f1-score': 0.07606056236481615, 'support': 943822}, 'accuracy': 0.4052132671736791, 'macro avg': {'precision': 0.4135725387301408, 'recall': 0.3421339155137409, 'f1-score': 0.2506374649402187, 'support': 3193084}, 'weighted avg': {'precision': 0.4125433101536485, 'recall': 0.4052132671736791, 'f1-score': 0.2846656617832994, 'support': 3193084}}
[[  63111  876583   12220]
 [  61493 1191208   44647]
 [  23380  880881   39561]]
Evaluating performance on  val set...
3866/3866 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1952686
{'0': {'precision': 0.4062406447898676, 'recall': 0.0618023976849938, 'f1-score': 0.10728349150264394, 'support': 285442}, '1': {'precision': 0.41842226898753104, 'recall': 0.9244278385814001, 'f1-score': 0.5760899024459635, 'support': 416185}, '2': {'precision': 0.4187205233531112, 'recall': 0.03828218725549857, 'f1-score': 0.07015073263516076, 'support': 287575}, 'accuracy': 0.41789543490611625, 'macro avg': {'precision': 0.41446114571016995, 'recall': 0.34150414117396416, 'f1-score': 0.2511747088612561, 'support': 989202}, 'weighted avg': {'precision': 0.4149938724870713, 'recall': 0.41789543490611625, 'f1-score': 0.29372846735907054, 'support': 989202}}
[[ 17641 264696   3105]
 [ 19274 384733  12178]
 [  6510 270056  11009]]
testing model out of sample: results/universal/W7/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 208s - 208s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85332286
{'0': {'precision': 0.44607950381220124, 'recall': 0.22846126157418756, 'f1-score': 0.3021667227033971, 'support': 713981}, '1': {'precision': 0.6534234797822837, 'recall': 0.9162823843090828, 'f1-score': 0.7628440941896099, 'support': 2344847}, '2': {'precision': 0.514099765073093, 'recall': 0.08656284157588261, 'f1-score': 0.14817615088940383, 'support': 715434}, 'accuracy': 0.628888243582454, 'macro avg': {'precision': 0.5378675828891927, 'recall': 0.41043549581971767, 'f1-score': 0.40439565592747034, 'support': 3774262}, 'weighted avg': {'precision': 0.5877903621512472, 'recall': 0.628888243582454, 'f1-score': 0.5591832895824741, 'support': 3774262}}
[[ 163117  536357   14507]
 [ 152279 2148542   44026]
 [  50272  603232   61930]]
Evaluating performance on  train set...
5285/5285 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9042986
{'0': {'precision': 0.46941486188768083, 'recall': 0.20040134596905357, 'f1-score': 0.28088711212640394, 'support': 294509}, '1': {'precision': 0.6058584163219874, 'recall': 0.8970214929693153, 'f1-score': 0.723235459835845, 'support': 766995}, '2': {'precision': 0.4670054096673164, 'recall': 0.14647835077041443, 'f1-score': 0.22300894211159336, 'support': 291142}, 'accuracy': 0.5838016746436244, 'macro avg': {'precision': 0.5140928959589949, 'recall': 0.41463372990292774, 'f1-score': 0.409043838024614, 'support': 1352646}, 'weighted avg': {'precision': 0.5462642602483752, 'recall': 0.5838016746436244, 'f1-score': 0.5192556170988437, 'support': 1352646}}
[[ 59020 221792  13697]
 [ 44009 688011  34975]
 [ 22702 225794  42646]]
Evaluating performance on  val set...
1714/1714 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88059765
{'0': {'precision': 0.46546604344239756, 'recall': 0.1872739139573216, 'f1-score': 0.2670884378426562, 'support': 90397}, '1': {'precision': 0.621200667361614, 'recall': 0.9098986743748737, 'f1-score': 0.7383317964359745, 'support': 257388}, '2': {'precision': 0.47223912073650487, 'recall': 0.1290208201752928, 'f1-score': 0.2026700085287104, 'support': 90249}, 'accuracy': 0.5998849404384134, 'macro avg': {'precision': 0.5196352771801721, 'recall': 0.4087311361691626, 'f1-score': 0.402696747602447, 'support': 438034}, 'weighted avg': {'precision': 0.558370902047061, 'recall': 0.5998849404384134, 'f1-score': 0.5307179432108757, 'support': 438034}}
[[ 16929  70125   3343]
 [ 13521 234197   9670]
 [  5920  72685  11644]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1181266
{'0': {'precision': 0.5091666666666667, 'recall': 0.05782918149466192, 'f1-score': 0.10386210647990754, 'support': 52828}, '1': {'precision': 0.41884094330155547, 'recall': 0.9640073140217496, 'f1-score': 0.5839624566415017, 'support': 72737}, '2': {'precision': 0.5746897163120568, 'recall': 0.04952348211386772, 'f1-score': 0.09118883086282992, 'support': 52359}, 'accuracy': 0.42583912232189025, 'macro avg': {'precision': 0.500899108760093, 'recall': 0.35711999254342636, 'f1-score': 0.25967113132807973, 'support': 177924}, 'weighted avg': {'precision': 0.49152261199149566, 'recall': 0.42583912232189025, 'f1-score': 0.29640217488928067, 'support': 177924}}
[[ 3055 48968   805]
 [ 1504 70119  1114]
 [ 1441 48325  2593]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2051073
{'0': {'precision': 0.521013795316009, 'recall': 0.06952352412346419, 'f1-score': 0.12267714156216951, 'support': 23359}, '1': {'precision': 0.3627983217287998, 'recall': 0.9409126365054602, 'f1-score': 0.5236766988289178, 'support': 25640}, '2': {'precision': 0.47984886649874053, 'recall': 0.04970213506109492, 'f1-score': 0.0900744710193467, 'support': 22997}, 'accuracy': 0.37352075115284183, 'macro avg': {'precision': 0.4545536611811831, 'recall': 0.35337943189667304, 'f1-score': 0.24547610380347798, 'support': 71996}, 'weighted avg': {'precision': 0.45151945381388714, 'recall': 0.37352075115284183, 'f1-score': 0.2550715111638992, 'support': 71996}}
[[ 1624 21204   531]
 [  807 24125   708]
 [  686 21168  1143]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2127146
{'0': {'precision': 0.5026548672566372, 'recall': 0.1451695348440961, 'f1-score': 0.22527763088313058, 'support': 5869}, '1': {'precision': 0.3612450679526523, 'recall': 0.895513119080888, 'f1-score': 0.5148161370938951, 'support': 6441}, '2': {'precision': 0.43498817966903075, 'recall': 0.05937399161019684, 'f1-score': 0.10448608745031232, 'support': 6198}, 'accuracy': 0.37756645774800085, 'macro avg': {'precision': 0.43296270495944006, 'recall': 0.3666855485117269, 'f1-score': 0.2815266184757793, 'support': 18508}, 'weighted avg': {'precision': 0.430782236665274, 'recall': 0.37756645774800085, 'f1-score': 0.28558947075275054, 'support': 18508}}
[[ 852 4809  208]
 [ 403 5768  270]
 [ 440 5390  368]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
2006/2006 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67688245
{'0': {'precision': 0.3050011795234725, 'recall': 0.2675759018191602, 'f1-score': 0.2850654290092493, 'support': 48319}, '1': {'precision': 0.8416342851979035, 'recall': 0.8934586835825549, 'f1-score': 0.8667725292430826, 'support': 416965}, '2': {'precision': 0.33664310954063603, 'recall': 0.19828913957457436, 'f1-score': 0.2495743064469651, 'support': 48046}, 'accuracy': 0.7694796719459217, 'macro avg': {'precision': 0.4944261914206707, 'recall': 0.45310790832542974, 'f1-score': 0.46713742156643234, 'support': 513330}, 'weighted avg': {'precision': 0.7438562845770321, 'recall': 0.7694796719459217, 'f1-score': 0.7542495689862091, 'support': 513330}}
[[ 12929  33849   1541]
 [ 27192 372541  17232]
 [  2269  36250   9527]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69227123
{'0': {'precision': 0.33818210410441896, 'recall': 0.2986183434006804, 'f1-score': 0.317171195752369, 'support': 14403}, '1': {'precision': 0.8278221403221403, 'recall': 0.8888013629618774, 'f1-score': 0.8572286761782765, 'support': 109174}, '2': {'precision': 0.3474944101012758, 'recall': 0.18925501432664757, 'f1-score': 0.24504939015906876, 'support': 13960}, 'accuracy': 0.7559929328108073, 'macro avg': {'precision': 0.5044995515092784, 'recall': 0.4588915735630685, 'f1-score': 0.4731497540299047, 'support': 137537}, 'weighted avg': {'precision': 0.7277933440307633, 'recall': 0.7559929328108073, 'f1-score': 0.7385371915348532, 'support': 137537}}
[[ 4301  9584   518]
 [ 7697 97034  4443]
 [  720 10598  2642]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6954752
{'0': {'precision': 0.3835259038389862, 'recall': 0.23573883161512027, 'f1-score': 0.2919977298524404, 'support': 4365}, '1': {'precision': 0.8010760300155741, 'recall': 0.9340024431311698, 'f1-score': 0.8624474117431864, 'support': 30289}, '2': {'precision': 0.4439163498098859, 'recall': 0.1062329390354868, 'f1-score': 0.17143906020558003, 'support': 4396}, 'accuracy': 0.7627656850192062, 'macro avg': {'precision': 0.5428394278881488, 'recall': 0.42532473792725894, 'f1-score': 0.44196140060040223, 'support': 39050}, 'weighted avg': {'precision': 0.7141956137557788, 'recall': 0.7627656850192062, 'f1-score': 0.7208933637326249, 'support': 39050}}
[[ 1029  3255    81]
 [ 1495 28290   504]
 [  159  3770   467]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
930/930 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1008658
{'0': {'precision': 0.47334706662527865, 'recall': 0.2404874551971326, 'f1-score': 0.3189367507391598, 'support': 69750}, '1': {'precision': 0.42901647841392565, 'recall': 0.8284918880593902, 'f1-score': 0.5653030734206034, 'support': 95908}, '2': {'precision': 0.5118524514338575, 'recall': 0.1224701536929185, 'f1-score': 0.19764910753156292, 'support': 72287}, 'accuracy': 0.44163987476097416, 'macro avg': {'precision': 0.47140533215768726, 'recall': 0.39714983231648043, 'f1-score': 0.36062964389710866, 'support': 237945}, 'weighted avg': {'precision': 0.46717665202309455, 'recall': 0.44163987476097416, 'f1-score': 0.3813922821064267, 'support': 237945}}
[[16774 50207  2769]
 [10775 79459  5674]
 [ 7888 55546  8853]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1187091
{'0': {'precision': 0.5032550569634968, 'recall': 0.27550435944759116, 'f1-score': 0.3560764959901295, 'support': 31426}, '1': {'precision': 0.3877343029101076, 'recall': 0.80529176201373, 'f1-score': 0.5234407682510761, 'support': 34960}, '2': {'precision': 0.5389206019719772, 'recall': 0.13341898185321985, 'f1-score': 0.21388667198723066, 'support': 31135}, 'accuracy': 0.4200633709662534, 'macro avg': {'precision': 0.4766366539485272, 'recall': 0.4047383677715137, 'f1-score': 0.36446797874281217, 'support': 97521}, 'weighted avg': {'precision': 0.47322912595512473, 'recall': 0.4200633709662534, 'f1-score': 0.3706782206229003, 'support': 97521}}
[[ 8658 21312  1456]
 [ 4709 28153  2098]
 [ 3837 23144  4154]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1469506
{'0': {'precision': 0.5199063231850117, 'recall': 0.22757560225525372, 'f1-score': 0.3165775401069519, 'support': 9755}, '1': {'precision': 0.3613399728383884, 'recall': 0.8190867111339148, 'f1-score': 0.5014606565101304, 'support': 9745}, '2': {'precision': 0.5465587044534413, 'recall': 0.15505899551007624, 'f1-score': 0.2415812591508053, 'support': 9577}, 'accuracy': 0.4019327991195791, 'macro avg': {'precision': 0.47593500015894713, 'recall': 0.4005737696330816, 'f1-score': 0.3532064852559625, 'support': 29077}, 'weighted avg': {'precision': 0.47554207554185407, 'recall': 0.4019327991195791, 'f1-score': 0.353838832077649, 'support': 29077}}
[[2220 7013  522]
 [1053 7982  710]
 [ 997 7095 1485]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1065/1065 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2093481
{'0': {'precision': 0.3781553808436892, 'recall': 0.2536172721912278, 'f1-score': 0.30361154663245843, 'support': 88188}, '1': {'precision': 0.3537824921319501, 'recall': 0.6289385069678288, 'f1-score': 0.4528394785430538, 'support': 96515}, '2': {'precision': 0.42226216151449797, 'recall': 0.20080454006746284, 'f1-score': 0.27217682766716605, 'support': 87752}, 'accuracy': 0.36956194600943276, 'macro avg': {'precision': 0.3847333448300458, 'recall': 0.3611201064088398, 'f1-score': 0.3428759509475594, 'support': 272455}, 'weighted avg': {'precision': 0.38372734268476866, 'recall': 0.36956194600943276, 'f1-score': 0.34634988650402904, 'support': 272455}}
[[22366 56675  9147]
 [20851 60702 14962]
 [15928 54203 17621]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2410862
{'0': {'precision': 0.3968691434240988, 'recall': 0.3052830935353478, 'f1-score': 0.34510305160568777, 'support': 35377}, '1': {'precision': 0.3230205918908932, 'recall': 0.5673156342182891, 'f1-score': 0.41165264667480045, 'support': 33900}, '2': {'precision': 0.4025565140734211, 'recall': 0.19166541747863888, 'f1-score': 0.2596880331464782, 'support': 33355}, 'accuracy': 0.3549088003741523, 'macro avg': {'precision': 0.3741487497961377, 'recall': 0.3547547150774253, 'f1-score': 0.3388145771423221, 'support': 102632}, 'weighted avg': {'precision': 0.37432487215424604, 'recall': 0.3549088003741523, 'f1-score': 0.33932525649437734, 'support': 102632}}
[[10800 20489  4088]
 [ 9268 19232  5400]
 [ 7145 19817  6393]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2179396
{'0': {'precision': 0.36843400172222907, 'recall': 0.2983364876979779, 'f1-score': 0.3297005724350507, 'support': 10039}, '1': {'precision': 0.3403524834058137, 'recall': 0.551046877895127, 'f1-score': 0.42079943402900605, 'support': 10794}, '2': {'precision': 0.3992382271468144, 'recall': 0.2186196435343193, 'f1-score': 0.2825287919627542, 'support': 10548}, 'accuracy': 0.3584653134062012, 'macro avg': {'precision': 0.3693415707582857, 'recall': 0.35600100304247473, 'f1-score': 0.34434293280893696, 'support': 31381}, 'weighted avg': {'precision': 0.3691290420673787, 'recall': 0.3584653134062012, 'f1-score': 0.34517978506764274, 'support': 31381}}
[[2995 5639 1405]
 [2781 5948 2065]
 [2353 5889 2306]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1539774
{'0': {'precision': 0.4564453741711399, 'recall': 0.17930013333746783, 'f1-score': 0.2574637665026605, 'support': 128996}, '1': {'precision': 0.39529717245121465, 'recall': 0.8622997552133362, 'f1-score': 0.542088880058282, 'support': 161365}, '2': {'precision': 0.5076832151300237, 'recall': 0.0721716415630442, 'f1-score': 0.12637759469291673, 'support': 130924}, 'accuracy': 0.40761717127360336, 'macro avg': {'precision': 0.45314192058412606, 'recall': 0.37125717670461605, 'f1-score': 0.30864341375128646, 'support': 421285}, 'weighted avg': {'precision': 0.44894708564713637, 'recall': 0.40761717127360336, 'f1-score': 0.32574582138447206, 'support': 421285}}
[[ 23129 102454   3413]
 [ 16470 139145   5750]
 [ 11073 110402   9449]]
Evaluating performance on  train set...
526/526 - 14s - 14s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2074742
{'0': {'precision': 0.4643479057831546, 'recall': 0.21972374612398898, 'f1-score': 0.2982970017221331, 'support': 46117}, '1': {'precision': 0.3266325460936055, 'recall': 0.7434559872745561, 'f1-score': 0.45386323553562635, 'support': 42749}, '2': {'precision': 0.4657534246575342, 'recall': 0.15760703196746403, 'f1-score': 0.2355170723737951, 'support': 45734}, 'accuracy': 0.3649554234769688, 'macro avg': {'precision': 0.418911292178098, 'recall': 0.37359558845533636, 'f1-score': 0.3292257698771848, 'support': 134600}, 'weighted avg': {'precision': 0.42108702977150786, 'recall': 0.3649554234769688, 'f1-score': 0.32637370038837477, 'support': 134600}}
[[10133 32404  3580]
 [ 6279 31782  4688]
 [ 5410 33116  7208]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2108009
{'0': {'precision': 0.48102773523906756, 'recall': 0.2220738413197172, 'f1-score': 0.30386413715268445, 'support': 12730}, '1': {'precision': 0.3189292407793769, 'recall': 0.7845337508698678, 'f1-score': 0.45350094280326836, 'support': 11496}, '2': {'precision': 0.506737699780633, 'recall': 0.1232375581129487, 'f1-score': 0.19825895046591466, 'support': 13121}, 'accuracy': 0.360484108495997, 'macro avg': {'precision': 0.4355648919330258, 'recall': 0.37661505010084456, 'f1-score': 0.31854134347395585, 'support': 37347}, 'weighted avg': {'precision': 0.4401638412834962, 'recall': 0.360484108495997, 'f1-score': 0.31282279683731795, 'support': 37347}}
[[ 2827  9210   693]
 [ 1596  9019   881]
 [ 1454 10050  1617]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
5929/5929 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6877378
{'0': {'precision': 0.33139993152811725, 'recall': 0.47140600137038274, 'f1-score': 0.3891947235916604, 'support': 176593}, '1': {'precision': 0.8409007749782289, 'recall': 0.7881312120248254, 'f1-score': 0.813661305933539, 'support': 1166387}, '2': {'precision': 0.38949550475508565, 'recall': 0.38634996821178397, 'f1-score': 0.3879163599558336, 'support': 174593}, 'accuracy': 0.7050514209201139, 'macro avg': {'precision': 0.520598737087144, 'recall': 0.548629060535664, 'f1-score': 0.5302574631603444, 'support': 1517573}, 'weighted avg': {'precision': 0.729679448036161, 'recall': 0.7050514209201139, 'f1-score': 0.7152871819022173, 'support': 1517573}}
[[ 83247  81368  11978]
 [153370 919266  93751]
 [ 14581  92558  67454]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7195792
{'0': {'precision': 0.3856404612660893, 'recall': 0.398295033358043, 'f1-score': 0.39186560995769926, 'support': 40470}, '1': {'precision': 0.8109423799107313, 'recall': 0.8023594760612013, 'f1-score': 0.8066280970947051, 'support': 239799}, '2': {'precision': 0.36323939965162616, 'recall': 0.3740386741688985, 'f1-score': 0.36855994576796436, 'support': 40699}, 'accuracy': 0.6971006455472196, 'macro avg': {'precision': 0.5199407469428156, 'recall': 0.5248977278627143, 'f1-score': 0.5223512176067895, 'support': 320968}, 'weighted avg': {'precision': 0.7005480968634681, 'recall': 0.6971006455472196, 'f1-score': 0.6987844069284528, 'support': 320968}}
[[ 16119  22050   2301]
 [ 23009 192405  24385]
 [  2670  22806  15223]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69341904
{'0': {'precision': 0.3693359931604446, 'recall': 0.5003088326127239, 'f1-score': 0.42495983211463423, 'support': 12952}, '1': {'precision': 0.8375242025884031, 'recall': 0.790670546923854, 'f1-score': 0.8134232339477917, 'support': 83156}, '2': {'precision': 0.3911259686977663, 'recall': 0.3928871250858582, 'f1-score': 0.39200456881781837, 'support': 13103}, 'accuracy': 0.7085092161046048, 'macro avg': {'precision': 0.532662054815538, 'recall': 0.5612888348741453, 'f1-score': 0.5434625449600815, 'support': 109211}, 'weighted avg': {'precision': 0.728440596109386, 'recall': 0.7085092161046048, 'f1-score': 0.7167916972917672, 'support': 109211}}
[[ 6480  5889   583]
 [ 9976 65749  7431]
 [ 1089  6866  5148]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
5331/5331 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6920738
{'0': {'precision': 0.3821529799295235, 'recall': 0.27344670704634527, 'f1-score': 0.31878744308650847, 'support': 145948}, '1': {'precision': 0.8084702225657874, 'recall': 0.937734545013029, 'f1-score': 0.8683179319977341, 'support': 1070690}, '2': {'precision': 0.4231988630151962, 'recall': 0.052322123702422146, 'f1-score': 0.09313011993119294, 'support': 147968}, 'accuracy': 0.7706795954290103, 'macro avg': {'precision': 0.5379406885035024, 'recall': 0.4211677919205988, 'f1-score': 0.4267451650051452, 'support': 1364606}, 'weighted avg': {'precision': 0.7210984966183275, 'recall': 0.7706795954290103, 'f1-score': 0.7254885248490938, 'support': 1364606}}
[[  39909  104267    1772]
 [  57887 1004023    8780]
 [   6636  133590    7742]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71651083
{'0': {'precision': 0.41133251043319813, 'recall': 0.10450547317175156, 'f1-score': 0.16666666666666666, 'support': 66963}, '1': {'precision': 0.7629090589446719, 'recall': 0.9521795688925575, 'f1-score': 0.8471007352736128, 'support': 382828}, '2': {'precision': 0.41380824591363746, 'recall': 0.12943941637032402, 'f1-score': 0.19719587053571427, 'support': 65521}, 'accuracy': 0.7374173316359798, 'macro avg': {'precision': 0.5293499384305025, 'recall': 0.395374819478211, 'f1-score': 0.4036544241586646, 'support': 515312}, 'weighted avg': {'precision': 0.6728353661360816, 'recall': 0.7374173316359798, 'f1-score': 0.676046455189666, 'support': 515312}}
[[  6998  58350   1615]
 [  7908 364521  10399]
 [  2107  54933   8481]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68516684
{'0': {'precision': 0.41991836734693877, 'recall': 0.23943399739340904, 'f1-score': 0.30497420999584984, 'support': 21484}, '1': {'precision': 0.8003454452405322, 'recall': 0.922347633125189, 'f1-score': 0.8570264040306478, 'support': 135643}, '2': {'precision': 0.4271823912811198, 'recall': 0.1921930583597731, 'f1-score': 0.2651105732568549, 'support': 20802}, 'accuracy': 0.7545256815920958, 'macro avg': {'precision': 0.5491487346228636, 'recall': 0.4513248962927903, 'f1-score': 0.4757037290944508, 'support': 177929}, 'weighted avg': {'precision': 0.7107836920135165, 'recall': 0.7545256815920958, 'f1-score': 0.7211670306378898, 'support': 177929}}
[[  5144  15627    713]
 [  5885 125110   4648]
 [  1221  15583   3998]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
4192/4192 - 54s - 54s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88884217
{'0': {'precision': 0.4617552334943639, 'recall': 0.14810477712820194, 'f1-score': 0.22427493114247862, 'support': 224591}, '1': {'precision': 0.6111529933014234, 'recall': 0.9218255940819701, 'f1-score': 0.7350089241450833, 'support': 629669}, '2': {'precision': 0.4641355140186916, 'recall': 0.10890401571565626, 'f1-score': 0.17641443108233118, 'support': 218890}, 'accuracy': 0.5940884312537856, 'macro avg': {'precision': 0.5123479136048262, 'recall': 0.39294479564194273, 'f1-score': 0.37856609545663106, 'support': 1073150}, 'weighted avg': {'precision': 0.5498996286151964, 'recall': 0.5940884312537856, 'f1-score': 0.5141851746143059, 'support': 1073150}}
[[ 33263 185766   5562]
 [ 27264 580445  21960]
 [ 11509 183543  23838]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96743846
{'0': {'precision': 0.46364923587715445, 'recall': 0.24518144614709336, 'f1-score': 0.32074850324683546, 'support': 77461}, '1': {'precision': 0.5441251090145088, 'recall': 0.8533213142270989, 'f1-score': 0.6645171441366206, 'support': 160855}, '2': {'precision': 0.4735504735504735, 'recall': 0.13389766299591122, 'f1-score': 0.20876614118701373, 'support': 76551}, 'accuracy': 0.528804225276069, 'macro avg': {'precision': 0.4937749394807122, 'recall': 0.4108001411233679, 'f1-score': 0.39801059619015655, 'support': 314867}, 'weighted avg': {'precision': 0.5071688686701731, 'recall': 0.528804225276069, 'f1-score': 0.46914304104306354, 'support': 314867}}
[[ 18992  55283   3186]
 [ 15385 137261   8209]
 [  6585  59716  10250]]
Evaluating performance on  val set...
400/400 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9771645
{'0': {'precision': 0.4749292172801169, 'recall': 0.20659515295987285, 'f1-score': 0.28793709681884877, 'support': 25170}, '1': {'precision': 0.53020764495148, 'recall': 0.8910277642474428, 'f1-score': 0.6648155955167251, 'support': 51325}, '2': {'precision': 0.4826492167360698, 'recall': 0.0945242718446602, 'f1-score': 0.1580878771149287, 'support': 25750}, 'accuracy': 0.5219423932710646, 'macro avg': {'precision': 0.4959286929892222, 'recall': 0.39738239635065864, 'f1-score': 0.3702801898168342, 'support': 102245}, 'weighted avg': {'precision': 0.5046221634997217, 'recall': 0.5219423932710646, 'f1-score': 0.4444207540959045, 'support': 102245}}
[[ 5200 19161   809]
 [ 3793 45732  1800]
 [ 1956 21360  2434]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
6143/6143 - 77s - 77s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84532785
{'0': {'precision': 0.47349369178162953, 'recall': 0.2537895904366758, 'f1-score': 0.3304565718741192, 'support': 316459}, '1': {'precision': 0.6377024070348236, 'recall': 0.9057381954293134, 'f1-score': 0.7484465893232471, 'support': 944147}, '2': {'precision': 0.533443195036836, 'recall': 0.10586221048041655, 'f1-score': 0.17666509716633852, 'support': 311896}, 'accuracy': 0.6158860211306567, 'macro avg': {'precision': 0.5482130979510963, 'recall': 0.42179666544880196, 'f1-score': 0.41852275278790163, 'support': 1572502}, 'weighted avg': {'precision': 0.5839769701160566, 'recall': 0.6158860211306567, 'f1-score': 0.5509186604495766, 'support': 1572502}}
[[ 80314 230251   5894]
 [ 66013 855150  22984]
 [ 23293 255585  33018]]
Evaluating performance on  train set...
2083/2083 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93011016
{'0': {'precision': 0.47350694653274794, 'recall': 0.24866555067748966, 'f1-score': 0.32608515573227304, 'support': 126644}, '1': {'precision': 0.5679705185825, 'recall': 0.8523420863334972, 'f1-score': 0.6816882073832728, 'support': 280818}, '2': {'precision': 0.4795213177010885, 'recall': 0.1727008866446662, 'f1-score': 0.2539433836511815, 'support': 125755}, 'accuracy': 0.5486753048008597, 'macro avg': {'precision': 0.5069995942721123, 'recall': 0.4245695078852177, 'f1-score': 0.4205722489222425, 'support': 533217}, 'weighted avg': {'precision': 0.5246744986215635, 'recall': 0.5486753048008597, 'f1-score': 0.49634894929187967, 'support': 533217}}
[[ 31492  88770   6382]
 [ 24274 239353  17191]
 [ 10742  93295  21718]]
Evaluating performance on  val set...
685/685 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9287092
{'0': {'precision': 0.4772391125718981, 'recall': 0.1431987968145171, 'f1-score': 0.22029623167516924, 'support': 40559}, '1': {'precision': 0.5588800652389181, 'recall': 0.9180230271201216, 'f1-score': 0.6947846096905524, 'support': 94063}, '2': {'precision': 0.4935248410642807, 'recall': 0.10337599565978645, 'f1-score': 0.17094505046385972, 'support': 40551}, 'accuracy': 0.5500391041998481, 'macro avg': {'precision': 0.5098813396250322, 'recall': 0.3881992731981417, 'f1-score': 0.36200863060986044, 'support': 175173}, 'weighted avg': {'precision': 0.5248480220888472, 'recall': 0.5500391041998481, 'f1-score': 0.4636588534945203, 'support': 175173}}
[[ 5808 33585  1166]
 [ 4575 86352  3136]
 [ 1787 34572  4192]]
testing model on single stock: results/universal/W7/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
23942/23942 - 306s - 306s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2682707
{'0': {'precision': 0.49864393645873695, 'recall': 0.0020549815339071954, 'f1-score': 0.004093094850396907, 'support': 1878849}, '1': {'precision': 0.38896897076094394, 'recall': 0.9977874341708146, 'f1-score': 0.5597354372078397, 'support': 2382302}, '2': {'precision': 0.4711180732328177, 'recall': 0.0025761371113108586, 'f1-score': 0.005124254110611262, 'support': 1867913}, 'accuracy': 0.3892444262288663, 'macro avg': {'precision': 0.4529103268174995, 'recall': 0.33413951760534416, 'f1-score': 0.18965092872294928, 'support': 6129064}, 'weighted avg': {'precision': 0.44762557413005183, 'recall': 0.3892444262288663, 'f1-score': 0.22037962396316935, 'support': 6129064}}
[[   3861 1872827    2161]
 [   2030 2377031    3241]
 [   1852 1861249    4812]]
Evaluating performance on  train set...
9052/9052 - 120s - 120s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3147527
{'0': {'precision': 0.5190472403372037, 'recall': 0.016644924847265312, 'f1-score': 0.032255473830266466, 'support': 784203}, '1': {'precision': 0.3265430403110943, 'recall': 0.9890156842971258, 'f1-score': 0.49097950919966554, 'support': 753620}, '2': {'precision': 0.5200340099904347, 'recall': 0.006279058128447996, 'f1-score': 0.012408294512505929, 'support': 779257}, 'accuracy': 0.329418060662558, 'macro avg': {'precision': 0.45520809687957753, 'recall': 0.3373132224242797, 'f1-score': 0.17854775918081264, 'support': 2317080}, 'weighted avg': {'precision': 0.45676796294323857, 'recall': 0.329418060662558, 'f1-score': 0.1747786297512819, 'support': 2317080}}
[[ 13053 769021   2129]
 [  5891 745342   2387]
 [  6204 768160   4893]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3311229
{'0': {'precision': 0.4536643026004728, 'recall': 0.008239021793264524, 'f1-score': 0.01618412286102232, 'support': 232916}, '1': {'precision': 0.34059062303649257, 'recall': 0.9934710602981452, 'f1-score': 0.5072732867192224, 'support': 240621}, '2': {'precision': 0.4819078947368421, 'recall': 0.002506651609646759, 'f1-score': 0.0049873613794394756, 'support': 233778}, 'accuracy': 0.3415097940804309, 'macro avg': {'precision': 0.42538760679126913, 'recall': 0.33473891123368554, 'f1-score': 0.17614825698656142, 'support': 707315}, 'weighted avg': {'precision': 0.4245327680396217, 'recall': 0.3415097940804309, 'f1-score': 0.1795467112284152, 'support': 707315}}
[[  1919 230660    337]
 [  1278 239050    293]
 [  1033 232159    586]]
training model: results/universal/W7/deepLOB_L1/h20
Epoch 1/50
12475/12475 - 269s - loss: 3.0663 - accuracy20: 0.4525 - val_loss: 3.4013 - val_accuracy20: 0.3988 - 269s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 270s - loss: 3.0146 - accuracy20: 0.4710 - val_loss: 3.5000 - val_accuracy20: 0.4023 - 270s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 271s - loss: 2.9939 - accuracy20: 0.4772 - val_loss: 3.6828 - val_accuracy20: 0.4044 - 271s/epoch - 22ms/step
Epoch 4/50
12475/12475 - 269s - loss: 2.9809 - accuracy20: 0.4811 - val_loss: 3.6368 - val_accuracy20: 0.4094 - 269s/epoch - 22ms/step
Epoch 5/50
12475/12475 - 273s - loss: 2.9711 - accuracy20: 0.4838 - val_loss: 3.6335 - val_accuracy20: 0.4121 - 273s/epoch - 22ms/step
Epoch 6/50
12475/12475 - 270s - loss: 2.9624 - accuracy20: 0.4860 - val_loss: 3.6361 - val_accuracy20: 0.4120 - 270s/epoch - 22ms/step
Epoch 7/50
12475/12475 - 273s - loss: 2.9565 - accuracy20: 0.4878 - val_loss: 3.6840 - val_accuracy20: 0.4132 - 273s/epoch - 22ms/step
Epoch 8/50
12475/12475 - 269s - loss: 2.9517 - accuracy20: 0.4892 - val_loss: 3.7118 - val_accuracy20: 0.4152 - 269s/epoch - 22ms/step
Epoch 9/50
12475/12475 - 276s - loss: 2.9478 - accuracy20: 0.4902 - val_loss: 3.7477 - val_accuracy20: 0.4142 - 276s/epoch - 22ms/step
Epoch 10/50
12475/12475 - 274s - loss: 2.9440 - accuracy20: 0.4914 - val_loss: 3.7165 - val_accuracy20: 0.4146 - 274s/epoch - 22ms/step
Epoch 11/50
12475/12475 - 260s - loss: 2.9405 - accuracy20: 0.4922 - val_loss: 3.7228 - val_accuracy20: 0.4163 - 260s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 480s - 480s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0428921
{'0': {'precision': 0.3667994695747653, 'recall': 0.14627321681202757, 'f1-score': 0.20914361556638672, 'support': 2551007}, '1': {'precision': 0.46529207077995427, 'recall': 0.8465206335833908, 'f1-score': 0.6005115474912771, 'support': 4425116}, '2': {'precision': 0.43502369029143745, 'recall': 0.07524642718631606, 'f1-score': 0.12830058949028808, 'support': 2529449}, 'accuracy': 0.45335809354765816, 'macro avg': {'precision': 0.42237174354871904, 'recall': 0.3560134258605781, 'f1-score': 0.312651917515984, 'support': 9505572}, 'weighted avg': {'precision': 0.43080517826249776, 'recall': 0.45335809354765816, 'f1-score': 0.36982412863625586, 'support': 9505572}}
[[ 373144 2117093   60770]
 [ 492745 3745952  186419]
 [ 151408 2187709  190332]]
Evaluating performance on  train set...
12475/12475 - 165s - 165s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1058011
{'0': {'precision': 0.41650690535210577, 'recall': 0.13850442508420754, 'f1-score': 0.2078806190282469, 'support': 985066}, '1': {'precision': 0.38833367318606216, 'recall': 0.8565093064449755, 'f1-score': 0.5343829069725845, 'support': 1229578}, '2': {'precision': 0.440232362767253, 'recall': 0.06908854911900576, 'f1-score': 0.11943360073781374, 'support': 978440}, 'accuracy': 0.3937196766511623, 'macro avg': {'precision': 0.41502431376847365, 'recall': 0.35470076021606295, 'f1-score': 0.2872323755795484, 'support': 3193084}, 'weighted avg': {'precision': 0.41292815518236925, 'recall': 0.3937196766511623, 'f1-score': 0.3065062516861824, 'support': 3193084}}
[[ 136436  817163   31467]
 [ 121946 1053145   54487]
 [  69190  841651   67599]]
Evaluating performance on  val set...
3866/3866 - 47s - 47s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1004798
{'0': {'precision': 0.38584608309941465, 'recall': 0.13584298540889497, 'f1-score': 0.20094146878110475, 'support': 296482}, '1': {'precision': 0.3980350827473416, 'recall': 0.8565671042533836, 'f1-score': 0.5435089492952546, 'support': 393522}, '2': {'precision': 0.4604909656008007, 'recall': 0.05843287722511514, 'f1-score': 0.10370620825473657, 'support': 299198}, 'accuracy': 0.39914597827339615, 'macro avg': {'precision': 0.41479071048251903, 'recall': 0.3502809889624645, 'f1-score': 0.2827188754436986, 'support': 989202}, 'weighted avg': {'precision': 0.4132724723243669, 'recall': 0.39914597827339615, 'f1-score': 0.3078106871893985, 'support': 989202}}
[[ 40275 248866   7341]
 [ 43302 337078  13142]
 [ 20804 260911  17483]]
testing model out of sample: results/universal/W7/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 175s - 175s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94066435
{'0': {'precision': 0.4234297169770027, 'recall': 0.2819512888938631, 'f1-score': 0.33850232275601055, 'support': 857751}, '1': {'precision': 0.5820793385374216, 'recall': 0.8416610857797706, 'f1-score': 0.6882062484365199, 'support': 2057618}, '2': {'precision': 0.4881780921705093, 'recall': 0.12952370085680057, 'f1-score': 0.2047286696878379, 'support': 858893}, 'accuracy': 0.5524015025983887, 'macro avg': {'precision': 0.4978957158949778, 'recall': 0.41771202517681144, 'f1-score': 0.4104790802934561, 'support': 3774262}, 'weighted avg': {'precision': 0.5246553985091758, 'recall': 0.5524015025983887, 'f1-score': 0.49870843402920684, 'support': 3774262}}
[[ 241844  573960   41947]
 [ 251113 1731817   74688]
 [  78198  669448  111247]]
Evaluating performance on  train set...
5285/5285 - 66s - 66s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97671413
{'0': {'precision': 0.45055652737877205, 'recall': 0.28291843524148214, 'f1-score': 0.34758036527508385, 'support': 348680}, '1': {'precision': 0.5430479839408174, 'recall': 0.8078175945140114, 'f1-score': 0.6494853715860281, 'support': 659717}, '2': {'precision': 0.47426950876064305, 'recall': 0.2098626285043675, 'f1-score': 0.290971408318532, 'support': 344249}, 'accuracy': 0.5203312618379088, 'macro avg': {'precision': 0.4892913400267442, 'recall': 0.43353288608662033, 'f1-score': 0.42934571505988134, 'support': 1352646}, 'weighted avg': {'precision': 0.5017017319455771, 'recall': 0.5203312618379088, 'f1-score': 0.4804194733825275, 'support': 1352646}}
[[ 98648 219312  30720]
 [ 77422 532931  49364]
 [ 42877 229127  72245]]
Evaluating performance on  val set...
1714/1714 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96176445
{'0': {'precision': 0.44067391206852735, 'recall': 0.27411450729502784, 'f1-score': 0.33798844248761695, 'support': 107539}, '1': {'precision': 0.5518076504314414, 'recall': 0.821364758698092, 'f1-score': 0.6601288441728771, 'support': 222750}, '2': {'precision': 0.47516296932639346, 'recall': 0.17454174207619844, 'f1-score': 0.2553029737379771, 'support': 107745}, 'accuracy': 0.5279110753959738, 'macro avg': {'precision': 0.4892148439421207, 'recall': 0.4233403360231061, 'f1-score': 0.4178067534661571, 'support': 438034}, 'weighted avg': {'precision': 0.5056712951360242, 'recall': 0.5279110753959738, 'f1-score': 0.48146549825260726, 'support': 438034}}
[[ 29478  70499   7562]
 [ 26581 182959  13210]
 [ 10834  78105  18806]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0846324
{'0': {'precision': 0.44549315714959886, 'recall': 0.06900584795321638, 'f1-score': 0.11950123425533263, 'support': 54720}, '1': {'precision': 0.3901870040368726, 'recall': 0.9113379350859157, 'f1-score': 0.5464239798524154, 'support': 68090}, '2': {'precision': 0.5340887267140388, 'recall': 0.10091809703523606, 'f1-score': 0.16975949212550362, 'support': 55114}, 'accuracy': 0.40124435152087407, 'macro avg': {'precision': 0.4565896293001701, 'recall': 0.360420626691456, 'f1-score': 0.27856156874441723, 'support': 177924}, 'weighted avg': {'precision': 0.45177145718517037, 'recall': 0.40124435152087407, 'f1-score': 0.29844900618021053, 'support': 177924}}
[[ 3776 49092  1852]
 [ 3037 62053  3000]
 [ 1663 47889  5562]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1323415
{'0': {'precision': 0.46201131054831573, 'recall': 0.15508418620006603, 'f1-score': 0.23221899524192055, 'support': 24232}, '1': {'precision': 0.34461338930698476, 'recall': 0.8378905439608315, 'f1-score': 0.4883675937122129, 'support': 24101}, '2': {'precision': 0.4871746152384572, 'recall': 0.10835481553480117, 'f1-score': 0.177279955749153, 'support': 23663}, 'accuracy': 0.36829823879104395, 'macro avg': {'precision': 0.4312664383645859, 'recall': 0.3671098485652329, 'f1-score': 0.2992888482344288, 'support': 71996}, 'weighted avg': {'precision': 0.4309822530874221, 'recall': 0.36829823879104395, 'f1-score': 0.2999090735825944, 'support': 71996}}
[[ 3758 19165  1309]
 [ 2517 20194  1390]
 [ 1859 19240  2564]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1498439
{'0': {'precision': 0.44095269599735365, 'recall': 0.21496532817287534, 'f1-score': 0.28902862098872506, 'support': 6201}, '1': {'precision': 0.33593528242974735, 'recall': 0.8008797157841313, 'f1-score': 0.4733290006499025, 'support': 5911}, '2': {'precision': 0.46733668341708545, 'recall': 0.10178236397748593, 'f1-score': 0.1671588137116446, 'support': 6396}, 'accuracy': 0.3629781716014696, 'macro avg': {'precision': 0.41474155394806217, 'recall': 0.37254246931149754, 'f1-score': 0.3098388117834241, 'support': 18508}, 'weighted avg': {'precision': 0.4165305029964072, 'recall': 0.3629781716014696, 'f1-score': 0.30577382613423043, 'support': 18508}}
[[1333 4525  343]
 [ 778 4734  399]
 [ 912 4833  651]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
2006/2006 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81544995
{'0': {'precision': 0.28187297171998144, 'recall': 0.3991048784126511, 'f1-score': 0.33039805357606, 'support': 67030}, '1': {'precision': 0.7776237664728882, 'recall': 0.7903903272440531, 'f1-score': 0.7839550750443852, 'support': 380450}, '2': {'precision': 0.35954737439324214, 'recall': 0.17322703113135915, 'f1-score': 0.2338074936459785, 'support': 65850}, 'accuracy': 0.660127013811778, 'macro avg': {'precision': 0.47301470419537067, 'recall': 0.45424074559602107, 'f1-score': 0.4493868740888079, 'support': 513330}, 'weighted avg': {'precision': 0.6592583754169749, 'recall': 0.660127013811778, 'f1-score': 0.6541571957384672, 'support': 513330}}
[[ 26752  37362   2916]
 [ 62343 300704  17403]
 [  5813  48630  11407]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83435774
{'0': {'precision': 0.3059319690265487, 'recall': 0.45393926959376285, 'f1-score': 0.365521229142574, 'support': 19496}, '1': {'precision': 0.775750356823806, 'recall': 0.7615956127705475, 'f1-score': 0.7686078215928052, 'support': 99197}, '2': {'precision': 0.3910176439137409, 'recall': 0.23285926554871578, 'f1-score': 0.29189117275327614, 'support': 18844}, 'accuracy': 0.645542653976748, 'macro avg': {'precision': 0.49089998992136524, 'recall': 0.48279804930434206, 'f1-score': 0.47534007449621846, 'support': 137537}, 'weighted avg': {'precision': 0.6564407708173307, 'recall': 0.645542653976748, 'f1-score': 0.6461547745062628, 'support': 137537}}
[[ 8850  9617  1029]
 [17844 75548  5805]
 [ 2234 12222  4388]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83891225
{'0': {'precision': 0.30933904201230933, 'recall': 0.3929299796057104, 'f1-score': 0.3461596047312472, 'support': 5884}, '1': {'precision': 0.7316211984943872, 'recall': 0.8061958596388196, 'f1-score': 0.7671003230594604, 'support': 27244}, '2': {'precision': 0.4231511254019293, 'recall': 0.1111111111111111, 'f1-score': 0.17600641968704026, 'support': 5922}, 'accuracy': 0.6385147247119078, 'macro avg': {'precision': 0.4880371219695419, 'recall': 0.436745650118547, 'f1-score': 0.4297554491592493, 'support': 39050}, 'weighted avg': {'precision': 0.621212287314001, 'recall': 0.6385147247119078, 'f1-score': 0.614033145532836, 'support': 39050}}
[[ 2312  3408   164]
 [ 4547 21964   733]
 [  615  4649   658]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
930/930 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.081884
{'0': {'precision': 0.43969027434750685, 'recall': 0.26902917511878344, 'f1-score': 0.33381195310652384, 'support': 73453}, '1': {'precision': 0.39733833314951655, 'recall': 0.7319269969187011, 'f1-score': 0.5150652290462858, 'support': 88599}, '2': {'precision': 0.4851657940663176, 'recall': 0.1904787002753877, 'f1-score': 0.2735573238463795, 'support': 75893}, 'accuracy': 0.41633570783164175, 'macro avg': {'precision': 0.4407314671877804, 'recall': 0.39714495743762407, 'f1-score': 0.37414483533306303, 'support': 237945}, 'weighted avg': {'precision': 0.4384249986737964, 'recall': 0.41633570783164175, 'f1-score': 0.3820834209522312, 'support': 237945}}
[[19761 47409  6283]
 [14694 64848  9057]
 [10488 50949 14456]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0898477
{'0': {'precision': 0.46537609118458545, 'recall': 0.3154296575615439, 'f1-score': 0.3760049700336209, 'support': 32619}, '1': {'precision': 0.3622063724622048, 'recall': 0.6907700810611643, 'f1-score': 0.4752268190411812, 'support': 32568}, '2': {'precision': 0.4851514923689948, 'recall': 0.19957320467619225, 'f1-score': 0.28280924728826556, 'support': 32334}, 'accuracy': 0.40236461890259534, 'macro avg': {'precision': 0.437577985338595, 'recall': 0.4019243144329668, 'f1-score': 0.37801367878768916, 'support': 97521}, 'weighted avg': {'precision': 0.4374783709248075, 'recall': 0.40236461890259534, 'f1-score': 0.37824106973758115, 'support': 97521}}
[[10289 19138  3192]
 [ 6415 22497  3656]
 [ 5405 20476  6453]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1071335
{'0': {'precision': 0.4681219681219681, 'recall': 0.27309480493228216, 'f1-score': 0.34495084897229666, 'support': 9894}, '1': {'precision': 0.3426438201643659, 'recall': 0.6838550600343053, 'f1-score': 0.45653963141885845, 'support': 9328}, '2': {'precision': 0.4667235494880546, 'recall': 0.22201927955352613, 'f1-score': 0.30090077700611984, 'support': 9855}, 'accuracy': 0.38755717577466725, 'macro avg': {'precision': 0.42582977925812954, 'recall': 0.39298971484003786, 'f1-score': 0.3674637524657583, 'support': 29077}, 'weighted avg': {'precision': 0.42739419084832464, 'recall': 0.38755717577466725, 'f1-score': 0.3658191195447373, 'support': 29077}}
[[2702 6007 1185]
 [1634 6379 1315]
 [1436 6231 2188]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1355828
{'0': {'precision': 0.38607258150342333, 'recall': 0.2504314609844214, 'f1-score': 0.3037992351282695, 'support': 86914}, '1': {'precision': 0.362254201517389, 'recall': 0.6254490276229406, 'f1-score': 0.45878464584666295, 'support': 96876}, '2': {'precision': 0.40994755817764666, 'recall': 0.2257034906671178, 'f1-score': 0.2911238643885337, 'support': 88665}, 'accuracy': 0.37572810188838524, 'macro avg': {'precision': 0.386091447066153, 'recall': 0.36719465975815996, 'f1-score': 0.35123591512115543, 'support': 272455}, 'weighted avg': {'precision': 0.3853731831708288, 'recall': 0.37572810188838524, 'f1-score': 0.35478198421386686, 'support': 272455}}
[[21766 52506 12642]
 [20123 60591 16162]
 [14489 54164 20012]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1707054
{'0': {'precision': 0.40502018606284007, 'recall': 0.3248578025567382, 'f1-score': 0.36053688338880296, 'support': 35514}, '1': {'precision': 0.3300688411735781, 'recall': 0.4747450934166323, 'f1-score': 0.3894032051436997, 'support': 33934}, '2': {'precision': 0.3826907139192549, 'recall': 0.2922191417550627, 'f1-score': 0.3313910770124567, 'support': 33184}, 'accuracy': 0.3638631226128303, 'macro avg': {'precision': 0.37259324705189095, 'recall': 0.3639406792428111, 'f1-score': 0.3604437218483198, 'support': 102632}, 'weighted avg': {'precision': 0.3730186646944078, 'recall': 0.3638631226128303, 'f1-score': 0.3606574629705902, 'support': 102632}}
[[11537 16661  7316]
 [ 9498 16110  8326]
 [ 7450 16037  9697]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1478752
{'0': {'precision': 0.3893726937269373, 'recall': 0.2603375111023389, 'f1-score': 0.3120416370948663, 'support': 10133}, '1': {'precision': 0.3465132997843278, 'recall': 0.5499144324015972, 'f1-score': 0.4251378169790518, 'support': 10518}, '2': {'precision': 0.4086429112964367, 'recall': 0.3013979496738117, 'f1-score': 0.3469212615318601, 'support': 10730}, 'accuracy': 0.37143494471176824, 'macro avg': {'precision': 0.3815096349359006, 'recall': 0.37054996439258264, 'f1-score': 0.361366905201926, 'support': 31381}, 'weighted avg': {'precision': 0.3815964701850604, 'recall': 0.37143494471176824, 'f1-score': 0.361874465565304, 'support': 31381}}
[[2638 5341 2154]
 [2208 5784 2526]
 [1929 5567 3234]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0887696
{'0': {'precision': 0.4243921987710393, 'recall': 0.1987193019491943, 'f1-score': 0.2706896643537625, 'support': 127899}, '1': {'precision': 0.39902614280572996, 'recall': 0.7963547293978981, 'f1-score': 0.531657086650478, 'support': 162896}, '2': {'precision': 0.44762796848311204, 'recall': 0.12451528852785654, 'f1-score': 0.19483416073098786, 'support': 130490}, 'accuracy': 0.40681961142694373, 'macro avg': {'precision': 0.4236821033532938, 'recall': 0.3731964399583163, 'f1-score': 0.33239363724507615, 'support': 421285}, 'weighted avg': {'precision': 0.42178115526653126, 'recall': 0.40681961142694373, 'f1-score': 0.34810083388201507, 'support': 421285}}
[[ 25416  94652   7831]
 [ 20954 129723  12219]
 [ 13518 100724  16248]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1408193
{'0': {'precision': 0.42877958747531003, 'recall': 0.28975929978118165, 'f1-score': 0.34582087408432677, 'support': 45700}, '1': {'precision': 0.3329847285923089, 'recall': 0.6067082969833326, 'f1-score': 0.42997998730902526, 'support': 43558}, '2': {'precision': 0.43764628587853655, 'recall': 0.23505800361695559, 'f1-score': 0.30584690436903655, 'support': 45342}, 'accuracy': 0.3739004457652303, 'macro avg': {'precision': 0.3998035339820518, 'recall': 0.3771752001271566, 'f1-score': 0.36054925525412956, 'support': 134600}, 'weighted avg': {'precision': 0.4007662247395993, 'recall': 0.37390044576523035, 'f1-score': 0.35958984079317313, 'support': 134600}}
[[13242 26306  6152]
 [ 9588 26427  7543]
 [ 8053 26631 10658]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1323175
{'0': {'precision': 0.4448505417047383, 'recall': 0.2722262161514498, 'f1-score': 0.33776015857284447, 'support': 12519}, '1': {'precision': 0.3309882607609691, 'recall': 0.6708572392845089, 'f1-score': 0.4432736801025812, 'support': 11852}, '2': {'precision': 0.4646892655367232, 'recall': 0.20283600493218248, 'f1-score': 0.28240343347639485, 'support': 12976}, 'accuracy': 0.37462179023750236, 'macro avg': {'precision': 0.41350935600081024, 'recall': 0.3819731534560471, 'f1-score': 0.3544790907172735, 'support': 37347}, 'weighted avg': {'precision': 0.41560941194058815, 'recall': 0.37462179023750236, 'f1-score': 0.35201130035983963, 'support': 37347}}
[[3408 7732 1379]
 [2248 7951 1653]
 [2005 8339 2632]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
5929/5929 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8274205
{'0': {'precision': 0.34132709590052934, 'recall': 0.5936790715601045, 'f1-score': 0.43344901979176437, 'support': 233510}, '1': {'precision': 0.7954235042531095, 'recall': 0.6658119178490005, 'f1-score': 0.7248694369960699, 'support': 1051381}, '2': {'precision': 0.43611066687989763, 'recall': 0.43363474613420894, 'f1-score': 0.43486918238180516, 'support': 232682}, 'accuracy': 0.6191142040613532, 'macro avg': {'precision': 0.5242870890111789, 'recall': 0.5643752451811046, 'f1-score': 0.5310625463898798, 'support': 1517573}, 'weighted avg': {'precision': 0.6704597088112528, 'recall': 0.6191142040613532, 'f1-score': 0.6355640652837807, 'support': 1517573}}
[[138630  74954  19926]
 [240823 700022 110536]
 [ 26697 105086 100899]]
Evaluating performance on  train set...
1254/1254 - 15s - 15s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84259653
{'0': {'precision': 0.3894387813725973, 'recall': 0.43601712825979083, 'f1-score': 0.4114138068566078, 'support': 54413}, '1': {'precision': 0.7258148143138607, 'recall': 0.760065909992257, 'f1-score': 0.7425456004686314, 'support': 211804}, '2': {'precision': 0.4217736875130726, 'recall': 0.2946430202188088, 'f1-score': 0.34692846159636126, 'support': 54751}, 'accuracy': 0.6257383913661175, 'macro avg': {'precision': 0.5123424277331768, 'recall': 0.4969086861569522, 'f1-score': 0.5002959563072001, 'support': 320968}, 'weighted avg': {'precision': 0.616926125055421, 'recall': 0.6257383913661175, 'f1-score': 0.6189248399684983, 'support': 320968}}
[[ 23725  26696   3992]
 [ 32695 160985  18124]
 [  4501  34118  16132]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81719005
{'0': {'precision': 0.37478771035973446, 'recall': 0.5510783200908059, 'f1-score': 0.4461496048520493, 'support': 17620}, '1': {'precision': 0.7637925621485858, 'recall': 0.7249160255715679, 'f1-score': 0.7438466776923824, 'support': 73832}, '2': {'precision': 0.4698011943457555, 'recall': 0.34996339884002475, 'f1-score': 0.4011230153607849, 'support': 17759}, 'accuracy': 0.6358974828542913, 'macro avg': {'precision': 0.5361271556180253, 'recall': 0.5419859148341328, 'f1-score': 0.5303730993017388, 'support': 109211}, 'weighted avg': {'precision': 0.6532244125177791, 'recall': 0.6358974828542913, 'f1-score': 0.6400855918787417, 'support': 109211}}
[[ 9710  6839  1071]
 [14367 53522  5943]
 [ 1831  9713  6215]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
5331/5331 - 63s - 63s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8434944
{'0': {'precision': 0.3373985238880431, 'recall': 0.32342870994131967, 'f1-score': 0.33026595676107723, 'support': 198022}, '1': {'precision': 0.733185941023158, 'recall': 0.8637343776365084, 'f1-score': 0.7931239837852404, 'support': 966003}, '2': {'precision': 0.367621067515023, 'recall': 0.06740419082565148, 'f1-score': 0.1139207441923171, 'support': 200581}, 'accuracy': 0.668277876544585, 'macro avg': {'precision': 0.47940184414207465, 'recall': 0.41818909280115985, 'f1-score': 0.41243689491287827, 'support': 1364606}, 'weighted avg': {'precision': 0.6220183338097464, 'recall': 0.668277876544585, 'f1-score': 0.6261224190638726, 'support': 1364606}}
[[ 64046 128097   5879]
 [114255 834370  17378]
 [ 11522 175539  13520]]
Evaluating performance on  train set...
2013/2013 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8551715
{'0': {'precision': 0.3841319367060397, 'recall': 0.19488919041157848, 'f1-score': 0.25858525241917335, 'support': 88440}, '1': {'precision': 0.692723394278201, 'recall': 0.8857176446384223, 'f1-score': 0.7774219220594285, 'support': 340245}, '2': {'precision': 0.43704101231499265, 'recall': 0.17861636672169184, 'f1-score': 0.25359130057116636, 'support': 86627}, 'accuracy': 0.6482868631042941, 'macro avg': {'precision': 0.5046321144330778, 'recall': 0.4197410672572308, 'f1-score': 0.42986615834992276, 'support': 515312}, 'weighted avg': {'precision': 0.5967799149685619, 'recall': 0.6482868631042941, 'f1-score': 0.6003179727808404, 'support': 515312}}
[[ 17236  67220   3984]
 [ 22937 301361  15947]
 [  4697  66457  15473]]
Evaluating performance on  val set...
696/696 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8308765
{'0': {'precision': 0.3917081390336612, 'recall': 0.35051546391752575, 'f1-score': 0.3699687251327794, 'support': 28518}, '1': {'precision': 0.7314332247557003, 'recall': 0.8503791153152708, 'f1-score': 0.7864340450802666, 'support': 121467}, '2': {'precision': 0.4352100089365505, 'recall': 0.17427712567993128, 'f1-score': 0.24888843460929114, 'support': 27944}, 'accuracy': 0.6640794923817928, 'macro avg': {'precision': 0.519450457575304, 'recall': 0.45839056830424263, 'f1-score': 0.4684304016074457, 'support': 177929}, 'weighted avg': {'precision': 0.630460693366936, 'recall': 0.6640794923817928, 'f1-score': 0.6352617655009772, 'support': 177929}}
[[  9996  17158   1364]
 [ 13218 103293   4956]
 [  2305  20769   4870]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
4192/4192 - 50s - 50s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98790604
{'0': {'precision': 0.4768614707083622, 'recall': 0.18690447189838177, 'f1-score': 0.26855111306678403, 'support': 287350}, '1': {'precision': 0.4965983781573174, 'recall': 0.8698780589164222, 'f1-score': 0.6322539072500956, 'support': 505326}, '2': {'precision': 0.4869688686005467, 'recall': 0.13083922217389135, 'f1-score': 0.20626025764967737, 'support': 280474}, 'accuracy': 0.49385081302706985, 'macro avg': {'precision': 0.48680957248874207, 'recall': 0.3958739176628985, 'f1-score': 0.3690217593221856, 'support': 1073150}, 'weighted avg': {'precision': 0.4887968337144315, 'recall': 0.49385081302706985, 'f1-score': 0.42353178938530284, 'support': 1073150}}
[[ 53707 219793  13850]
 [ 40943 439572  24811]
 [ 17976 225801  36697]]
Evaluating performance on  train set...
1230/1230 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0436069
{'0': {'precision': 0.4690893841014591, 'recall': 0.33449513281636695, 'f1-score': 0.3905205053964738, 'support': 96976}, '1': {'precision': 0.43184926229823956, 'recall': 0.7346549252508704, 'f1-score': 0.5439503619441572, 'support': 122075}, '2': {'precision': 0.4927978130585638, 'recall': 0.19566669449778742, 'f1-score': 0.2801135514716868, 'support': 95816}, 'accuracy': 0.44739207347864335, 'macro avg': {'precision': 0.4645788198194208, 'recall': 0.42160558418834154, 'f1-score': 0.4048614729374393, 'support': 314867}, 'weighted avg': {'precision': 0.46186588643363713, 'recall': 0.44739207347864335, 'f1-score': 0.4164082517808236, 'support': 314867}}
[[32438 55782  8756]
 [21852 89683 10540]
 [14861 62207 18748]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0450517
{'0': {'precision': 0.4731637014213299, 'recall': 0.30466225080797416, 'f1-score': 0.37066163159636384, 'support': 31251}, '1': {'precision': 0.4258836710434628, 'recall': 0.7940996637114033, 'f1-score': 0.5544240979713805, 'support': 39252}, '2': {'precision': 0.5146630848444146, 'recall': 0.1448553966353727, 'f1-score': 0.2260792604975907, 'support': 31742}, 'accuracy': 0.4429458653234877, 'macro avg': {'precision': 0.47123681910306914, 'recall': 0.41453910371825003, 'f1-score': 0.3837216633551117, 'support': 102245}, 'weighted avg': {'precision': 0.46789633065721936, 'recall': 0.4429458653234877, 'f1-score': 0.39632264882688756, 'support': 102245}}
[[ 9521 19604  2126]
 [ 5872 31170  2210]
 [ 4729 22415  4598]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
6143/6143 - 73s - 73s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94772214
{'0': {'precision': 0.4794975422449986, 'recall': 0.318024956832162, 'f1-score': 0.38241475406661796, 'support': 403657}, '1': {'precision': 0.5384036771114269, 'recall': 0.8297838166910613, 'f1-score': 0.6530664256729652, 'support': 772030}, '2': {'precision': 0.5355387145330677, 'recall': 0.15511006388367377, 'f1-score': 0.2405490223665647, 'support': 396815}, 'accuracy': 0.5281653059900718, 'macro avg': {'precision': 0.5178133112964977, 'recall': 0.4343062791356323, 'f1-score': 0.4253434007020493, 'support': 1572502}, 'weighted avg': {'precision': 0.5225596694044037, 'recall': 0.5281653059900718, 'f1-score': 0.4794936510764098, 'support': 1572502}}
[[128373 255067  20217]
 [ 98248 640618  33164]
 [ 41103 294162  61550]]
Evaluating performance on  train set...
2083/2083 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0106671
{'0': {'precision': 0.47897056859165593, 'recall': 0.34108910577148693, 'f1-score': 0.3984384259807989, 'support': 157689}, '1': {'precision': 0.46890050062397864, 'recall': 0.7420602522292412, 'f1-score': 0.5746716777461446, 'support': 219245}, '2': {'precision': 0.5003448042728686, 'recall': 0.2367691943461541, 'f1-score': 0.32143260452227695, 'support': 156283}, 'accuracy': 0.47538244279533476, 'macro avg': {'precision': 0.4827386244961677, 'recall': 0.43997285078229403, 'f1-score': 0.4315142360830735, 'support': 533217}, 'weighted avg': {'precision': 0.4810946899594922, 'recall': 0.47538244279533476, 'f1-score': 0.4483309809598994, 'support': 533217}}
[[ 53786  87581  16322]
 [ 35922 162693  20630]
 [ 22587  96693  37003]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0142361
{'0': {'precision': 0.4832145274979093, 'recall': 0.2407205348463507, 'f1-score': 0.32135384941338485, 'support': 50407}, '1': {'precision': 0.45418890294379616, 'recall': 0.817891416864352, 'f1-score': 0.5840467768714358, 'support': 74192}, '2': {'precision': 0.5030682301476396, 'recall': 0.16372048878870565, 'f1-score': 0.24704250145450746, 'support': 50574}, 'accuracy': 0.46294234842127496, 'macro avg': {'precision': 0.48015722019644835, 'recall': 0.40744414683313607, 'f1-score': 0.3841477092464427, 'support': 175173}, 'weighted avg': {'precision': 0.476653082645613, 'recall': 0.46294234842127496, 'f1-score': 0.4111593078019233, 'support': 175173}}
[[12134 34945  3328]
 [ 8660 60681  4851]
 [ 4317 37977  8280]]
testing model on single stock: results/universal/W7/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
23942/23942 - 277s - 277s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1208668
{'0': {'precision': 0.3805564521707053, 'recall': 0.07037991091582307, 'f1-score': 0.1187907270058704, 'support': 1876203}, '1': {'precision': 0.3916297423606072, 'recall': 0.9387930071854469, 'f1-score': 0.5526953949929422, 'support': 2391083}, '2': {'precision': 0.42809437675167467, 'recall': 0.011567974269757189, 'f1-score': 0.022527217642293474, 'support': 1861778}, 'accuracy': 0.3913021629403772, 'macro avg': {'precision': 0.4000935237609957, 'recall': 0.3402469641236758, 'f1-score': 0.23133777988036872, 'support': 6129064}, 'weighted avg': {'precision': 0.39931661164654847, 'recall': 0.3913021629403772, 'f1-score': 0.25882528877723227, 'support': 6129064}}
[[ 132047 1733034   11122]
 [ 128701 2244732   17650]
 [  86236 1754005   21537]]
Evaluating performance on  train set...
9052/9052 - 109s - 109s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1639192
{'0': {'precision': 0.42692387293838896, 'recall': 0.07682488149619798, 'f1-score': 0.13021719917978902, 'support': 778667}, '1': {'precision': 0.33275406869832075, 'recall': 0.932333903337145, 'f1-score': 0.4904605949603078, 'support': 762568}, '2': {'precision': 0.4600912200684151, 'recall': 0.023923592985712352, 'f1-score': 0.045482224049145606, 'support': 775845}, 'accuracy': 0.34066583803753, 'macro avg': {'precision': 0.4065897205683749, 'recall': 0.34436079260635183, 'f1-score': 0.22205333939641414, 'support': 2317080}, 'weighted avg': {'precision': 0.4070375682593769, 'recall': 0.34066583803753, 'f1-score': 0.22040350222212016, 'support': 2317080}}
[[ 59821 708536  10310]
 [ 40129 710968  11471]
 [ 40171 717113  18561]]
Evaluating performance on  val set...
2763/2763 - 31s - 31s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1647741
{'0': {'precision': 0.3630659811094249, 'recall': 0.0692116376071919, 'f1-score': 0.11626043090849088, 'support': 231594}, '1': {'precision': 0.3419061013997723, 'recall': 0.925596268275396, 'f1-score': 0.49935529767462544, 'support': 242676}, '2': {'precision': 0.4456626894550145, 'recall': 0.011860370314746078, 'f1-score': 0.02310582786827003, 'support': 233045}, 'accuracy': 0.3441366293659826, 'macro avg': {'precision': 0.3835449239880706, 'recall': 0.335556092065778, 'f1-score': 0.21290718548379542, 'support': 707315}, 'weighted avg': {'precision': 0.38301996897618623, 'recall': 0.3441366293659826, 'f1-score': 0.2170058066206279, 'support': 707315}}
[[ 16029 213791   1774]
 [ 16392 224620   1664]
 [ 11728 218553   2764]]
training model: results/universal/W7/deepLOB_L1/h30
Epoch 1/50
12475/12475 - 274s - loss: 3.1300 - accuracy30: 0.4298 - val_loss: 3.3123 - val_accuracy30: 0.3826 - 274s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 263s - loss: 3.0811 - accuracy30: 0.4479 - val_loss: 3.2899 - val_accuracy30: 0.3856 - 263s/epoch - 21ms/step
Epoch 3/50
12475/12475 - 266s - loss: 3.0616 - accuracy30: 0.4539 - val_loss: 3.3161 - val_accuracy30: 0.3881 - 266s/epoch - 21ms/step
Epoch 4/50
12475/12475 - 264s - loss: 3.0519 - accuracy30: 0.4568 - val_loss: 3.3267 - val_accuracy30: 0.3892 - 264s/epoch - 21ms/step
Epoch 5/50
12475/12475 - 262s - loss: 3.0436 - accuracy30: 0.4595 - val_loss: 3.3701 - val_accuracy30: 0.3868 - 262s/epoch - 21ms/step
Epoch 6/50
12475/12475 - 261s - loss: 3.0378 - accuracy30: 0.4614 - val_loss: 3.3894 - val_accuracy30: 0.3905 - 261s/epoch - 21ms/step
Epoch 7/50
12475/12475 - 260s - loss: 3.0340 - accuracy30: 0.4626 - val_loss: 3.4425 - val_accuracy30: 0.3920 - 260s/epoch - 21ms/step
Epoch 8/50
12475/12475 - 264s - loss: 3.0304 - accuracy30: 0.4636 - val_loss: 3.4728 - val_accuracy30: 0.3932 - 264s/epoch - 21ms/step
Epoch 9/50
12475/12475 - 264s - loss: 3.0272 - accuracy30: 0.4646 - val_loss: 3.5275 - val_accuracy30: 0.3908 - 264s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 264s - loss: 3.0245 - accuracy30: 0.4656 - val_loss: 3.5240 - val_accuracy30: 0.3914 - 264s/epoch - 21ms/step
Epoch 11/50
12475/12475 - 265s - loss: 3.0221 - accuracy30: 0.4663 - val_loss: 3.6063 - val_accuracy30: 0.3907 - 265s/epoch - 21ms/step
Epoch 12/50
12475/12475 - 264s - loss: 3.0198 - accuracy30: 0.4670 - val_loss: 3.5838 - val_accuracy30: 0.3898 - 264s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 440s - 440s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0563183
{'0': {'precision': 0.3469708271721211, 'recall': 0.6561286944388455, 'f1-score': 0.453908133612096, 'support': 2688974}, '1': {'precision': 0.5003616290308892, 'recall': 0.41635263842770487, 'f1-score': 0.4545077824359374, 'support': 4149043}, '2': {'precision': 0.4395385009439847, 'recall': 0.15953822882752183, 'f1-score': 0.23410421556134553, 'support': 2667555}, 'accuracy': 0.41211144368797586, 'macro avg': {'precision': 0.428956985715665, 'recall': 0.4106731872313574, 'f1-score': 0.380840043869793, 'support': 9505572}, 'weighted avg': {'precision': 0.4399009942073097, 'recall': 0.41211144368797586, 'f1-score': 0.3924861516565806, 'support': 9505572}}
[[1764313  768002  156659]
 [2035578 1727465  386000]
 [1285012  956966  425577]]
Evaluating performance on  train set...
12475/12475 - 151s - 151s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0900637
{'0': {'precision': 0.37459899279925907, 'recall': 0.6124340775040075, 'f1-score': 0.4648622128100651, 'support': 1002503}, '1': {'precision': 0.41626551399796585, 'recall': 0.36388240838536307, 'f1-score': 0.38831532691546317, 'support': 1196752}, '2': {'precision': 0.4058460351147984, 'recall': 0.20742300737853292, 'f1-score': 0.27453466359205814, 'support': 993829}, 'accuracy': 0.39322078592357734, 'macro avg': {'precision': 0.3989035139706744, 'recall': 0.39457983108930117, 'f1-score': 0.3759040677725289, 'support': 3193084}, 'weighted avg': {'precision': 0.39994085959480996, 'recall': 0.39322078592357734, 'f1-score': 0.3769344675017929, 'support': 3193084}}
[[613967 272539 115997]
 [575481 435477 185794]
 [449550 338136 206143]]
Evaluating performance on  val set...
3866/3866 - 47s - 47s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0915173
{'0': {'precision': 0.3604213344404756, 'recall': 0.6574266604428283, 'f1-score': 0.4655913170624577, 'support': 306349}, '1': {'precision': 0.41210472316881025, 'recall': 0.361881038121107, 'f1-score': 0.385363381327318, 'support': 372943}, '2': {'precision': 0.4386478030199973, 'recall': 0.1456648704462586, 'f1-score': 0.2187033699591109, 'support': 309910}, 'accuracy': 0.38567046973216795, 'macro avg': {'precision': 0.403724620209761, 'recall': 0.38832418967006466, 'f1-score': 0.3565526894496289, 'support': 989202}, 'weighted avg': {'precision': 0.4044144955137355, 'recall': 0.38567046973216795, 'f1-score': 0.3579960122372871, 'support': 989202}}
[[201402  85356  19591]
 [199802 134961  38180]
 [157592 107175  45143]]
testing model out of sample: results/universal/W7/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 184s - 184s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0244108
{'0': {'precision': 0.34802176507846255, 'recall': 0.7084801913258657, 'f1-score': 0.4667601895362557, 'support': 939967}, '1': {'precision': 0.6481526215863876, 'recall': 0.34378932911316673, 'f1-score': 0.4492761996424849, 'support': 1888709}, '2': {'precision': 0.43469392507043564, 'recall': 0.3948620220688547, 'f1-score': 0.4138216905713744, 'support': 945586}, 'accuracy': 0.4474098512503901, 'macro avg': {'precision': 0.47695610391176196, 'recall': 0.4823771808359624, 'f1-score': 0.44328602658337174, 'support': 3774262}, 'weighted avg': {'precision': 0.5199271153012072, 'recall': 0.4474098512503901, 'f1-score': 0.4447479199719064, 'support': 3774262}}
[[665948 139640 134379]
 [888206 649318 351185]
 [359370 212840 373376]]
Evaluating performance on  train set...
5285/5285 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0237261
{'0': {'precision': 0.4087536601584222, 'recall': 0.5465300976174073, 'f1-score': 0.4677064295701718, 'support': 384665}, '1': {'precision': 0.5713283412084176, 'recall': 0.44856489022030743, 'f1-score': 0.5025581634557874, 'support': 588178}, '2': {'precision': 0.4329747961649802, 'recall': 0.42924358154095676, 'f1-score': 0.4311011155139337, 'support': 379803}, 'accuracy': 0.47099906405667114, 'macro avg': {'precision': 0.47101893251060667, 'recall': 0.4747795231262238, 'f1-score': 0.46712190284663097, 'support': 1352646}, 'weighted avg': {'precision': 0.4862477797354016, 'recall': 0.47099906405667114, 'f1-score': 0.4725829567907988, 'support': 1352646}}
[[210231  94459  79975]
 [190815 263836 133527]
 [113276 103499 163028]]
Evaluating performance on  val set...
1714/1714 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0194365
{'0': {'precision': 0.3835063085063085, 'recall': 0.6309331503134494, 'f1-score': 0.4770454092400573, 'support': 119477}, '1': {'precision': 0.6049298641117165, 'recall': 0.3884990096620786, 'f1-score': 0.47313835811849125, 'support': 198922}, '2': {'precision': 0.44223633070118357, 'recall': 0.42037865173235256, 'f1-score': 0.43103056689964303, 'support': 119635}, 'accuracy': 0.463331613527717, 'macro avg': {'precision': 0.4768908344397362, 'recall': 0.47993693723596015, 'f1-score': 0.46040477808606384, 'support': 438034}, 'weighted avg': {'precision': 0.5001004147478852, 'recall': 0.463331613527717, 'f1-score': 0.46270363648588836, 'support': 438034}}
[[75382 21603 22492]
 [80703 77281 40938]
 [40475 28868 50292]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.098756
{'0': {'precision': 0.3550990376529945, 'recall': 0.5637445767048614, 'f1-score': 0.43573281359721405, 'support': 53934}, '1': {'precision': 0.44152982371407873, 'recall': 0.2116021699819168, 'f1-score': 0.28609429552189175, 'support': 69125}, '2': {'precision': 0.40438045021293856, 'recall': 0.43612503417479265, 'f1-score': 0.41965327042977274, 'support': 54865}, 'accuracy': 0.38758121445111393, 'macro avg': {'precision': 0.4003364371933373, 'recall': 0.403823926953857, 'f1-score': 0.3804934598496262, 'support': 177924}, 'weighted avg': {'precision': 0.4038746541329173, 'recall': 0.38758121445111393, 'f1-score': 0.37263864587482515, 'support': 177924}}
[[30405  8427 15102]
 [34356 14627 20142]
 [20863 10074 23928]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1119436
{'0': {'precision': 0.40815028252815927, 'recall': 0.4453654552878726, 'f1-score': 0.4259465370120868, 'support': 24490}, '1': {'precision': 0.3583092186854072, 'recall': 0.439120155366039, 'f1-score': 0.39462002504078614, 'support': 23686}, '2': {'precision': 0.4227146814404432, 'recall': 0.28828715365239294, 'f1-score': 0.3427929614376638, 'support': 23820}, 'accuracy': 0.3913411856214234, 'macro avg': {'precision': 0.39639139421800323, 'recall': 0.3909242547687682, 'f1-score': 0.38778650783017893, 'support': 71996}, 'weighted avg': {'precision': 0.3965717023835843, 'recall': 0.3913411856214234, 'f1-score': 0.3881289091892218, 'support': 71996}}
[[10907  9212  4371]
 [ 8278 10401  5007]
 [ 7538  9415  6867]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1372907
{'0': {'precision': 0.4035143769968051, 'recall': 0.595754716981132, 'f1-score': 0.4811428571428571, 'support': 6360}, '1': {'precision': 0.36148148148148146, 'recall': 0.30353652034832057, 'f1-score': 0.32998454404945904, 'support': 5627}, '2': {'precision': 0.4302299112223993, 'recall': 0.2898328477227419, 'f1-score': 0.3463441451346894, 'support': 6521}, 'accuracy': 0.3991247028312081, 'macro avg': {'precision': 0.3984085899002286, 'recall': 0.39637469501739814, 'f1-score': 0.3858238487756685, 'support': 18508}, 'weighted avg': {'precision': 0.4001478811906874, 'recall': 0.3991247028312081, 'f1-score': 0.38769190464762193, 'support': 18508}}
[[3789 1353 1218]
 [2634 1708 1285]
 [2967 1664 1890]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
2006/2006 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9612553
{'0': {'precision': 0.26424124945562605, 'recall': 0.7454799503728062, 'f1-score': 0.39018008845233626, 'support': 83019}, '1': {'precision': 0.8215313368323557, 'recall': 0.3808644572881152, 'f1-score': 0.5204477398837034, 'support': 349329}, '2': {'precision': 0.3519451035283273, 'recall': 0.5091995752142452, 'f1-score': 0.4162141429638452, 'support': 80982}, 'accuracy': 0.46007831219683243, 'macro avg': {'precision': 0.4792392299387697, 'recall': 0.5451813276250556, 'f1-score': 0.4422806570999616, 'support': 513330}, 'weighted avg': {'precision': 0.6573217677260195, 'recall': 0.46007831219683243, 'f1-score': 0.48293632364084865, 'support': 513330}}
[[ 61889  10139  10991]
 [151343 133047  64939]
 [ 20982  18764  41236]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93027616
{'0': {'precision': 0.3034374220294417, 'recall': 0.670654110460677, 'f1-score': 0.41782840228867424, 'support': 23574}, '1': {'precision': 0.8058774989685308, 'recall': 0.4708015601717942, 'f1-score': 0.5943676777736282, 'support': 91272}, '2': {'precision': 0.35326357747882414, 'recall': 0.499933894495615, 'f1-score': 0.41399193474809776, 'support': 22691}, 'accuracy': 0.5098628005554869, 'macro avg': {'precision': 0.48752616615893224, 'recall': 0.5471298550426954, 'f1-score': 0.47539600493680007, 'support': 137537}, 'weighted avg': {'precision': 0.6450859674803857, 'recall': 0.5098628005554869, 'f1-score': 0.5343500616755992, 'support': 137537}}
[[15810  4544  3220]
 [30753 42971 17548]
 [ 5540  5807 11344]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9670861
{'0': {'precision': 0.28933340370507205, 'recall': 0.7695115103874228, 'f1-score': 0.42054389935177017, 'support': 7124}, '1': {'precision': 0.8078083254330777, 'recall': 0.3782791185729276, 'f1-score': 0.5152689590720431, 'support': 24778}, '2': {'precision': 0.39329411764705885, 'recall': 0.46768326804700616, 'f1-score': 0.4272750511247444, 'support': 7148}, 'accuracy': 0.46601792573623557, 'macro avg': {'precision': 0.49681194892840286, 'recall': 0.5384912990024523, 'f1-score': 0.45436263651618586, 'support': 39050}, 'weighted avg': {'precision': 0.6373457671835316, 'recall': 0.46601792573623557, 'f1-score': 0.481880949354898, 'support': 39050}}
[[ 5482   794   848]
 [11096  9373  4309]
 [ 2369  1436  3343]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1011449
{'0': {'precision': 0.38831438660799633, 'recall': 0.6520395304105592, 'f1-score': 0.48675037629723533, 'support': 75385}, '1': {'precision': 0.45037777777777777, 'recall': 0.2401644783618524, 'f1-score': 0.3132748013726157, 'support': 84388}, '2': {'precision': 0.45575781320635306, 'recall': 0.3869032390114107, 'f1-score': 0.4185174422627202, 'support': 78172}, 'accuracy': 0.41886150160751434, 'macro avg': {'precision': 0.4314833258640424, 'recall': 0.42636908259460743, 'f1-score': 0.4061808733108571, 'support': 237945}, 'weighted avg': {'precision': 0.4324825473093443, 'recall': 0.41886150160751434, 'f1-score': 0.4028101307107136, 'support': 237945}}
[[49154 10669 15562]
 [43566 20267 20555]
 [33863 14064 30245]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1002073
{'0': {'precision': 0.41409177467903435, 'recall': 0.6135805091173883, 'f1-score': 0.4944740574111203, 'support': 32959}, '1': {'precision': 0.3976912109644483, 'recall': 0.2725782555243829, 'f1-score': 0.3234578984775371, 'support': 31723}, '2': {'precision': 0.46078467762889275, 'recall': 0.37802612747038583, 'f1-score': 0.415322850451656, 'support': 32839}, 'accuracy': 0.42333446129551583, 'macro avg': {'precision': 0.42418922109079177, 'recall': 0.4213949640373857, 'f1-score': 0.41108493544677116, 'support': 97521}, 'weighted avg': {'precision': 0.4244800311289537, 'recall': 0.42333446129551583, 'f1-score': 0.41219032267509514, 'support': 97521}}
[[20223  6066  6670]
 [15219  8647  7857]
 [13395  7030 12414]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1035578
{'0': {'precision': 0.4105134631450421, 'recall': 0.6433031218529708, 'f1-score': 0.5011965007257463, 'support': 9930}, '1': {'precision': 0.39392565729827744, 'recall': 0.1912411971830986, 'f1-score': 0.2574814814814815, 'support': 9088}, '2': {'precision': 0.4522188049209139, 'recall': 0.4092852172184114, 'f1-score': 0.42968220007305746, 'support': 10059}, 'accuracy': 0.42105444165491623, 'macro avg': {'precision': 0.4188859751214111, 'recall': 0.4146098454181602, 'f1-score': 0.39612006076009515, 'support': 29077}, 'weighted avg': {'precision': 0.41975664687748004, 'recall': 0.42105444165491623, 'f1-score': 0.40028359894229976, 'support': 29077}}
[[6388 1180 2362]
 [4725 1738 2625]
 [4448 1494 4117]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1631488
{'0': {'precision': 0.3554352392697901, 'recall': 0.6079604065973551, 'f1-score': 0.448601887526673, 'support': 86277}, '1': {'precision': 0.36650800519255733, 'recall': 0.12310407474695043, 'f1-score': 0.1843035771182555, 'support': 96325}, '2': {'precision': 0.4048656067958542, 'recall': 0.41691429334579816, 'f1-score': 0.4108016229849764, 'support': 89853}, 'accuracy': 0.37353691435282893, 'macro avg': {'precision': 0.37560295041940056, 'recall': 0.3826595915633679, 'f1-score': 0.3479023625433017, 'support': 272455}, 'weighted avg': {'precision': 0.3756516089118594, 'recall': 0.37353691435282893, 'f1-score': 0.3426944829279104, 'support': 272455}}
[[52453  9403 24421]
 [53822 11858 30645]
 [41299 11093 37461]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1832244
{'0': {'precision': 0.38501520054918115, 'recall': 0.5541284403669725, 'f1-score': 0.4543455618562667, 'support': 35425}, '1': {'precision': 0.33081587651598676, 'recall': 0.1759204971857411, 'f1-score': 0.22969455714613796, 'support': 34112}, '2': {'precision': 0.37583191571910346, 'recall': 0.3805106511557637, 'f1-score': 0.3781568121077445, 'support': 33095}, 'accuracy': 0.37243744641047627, 'macro avg': {'precision': 0.36388766426142377, 'recall': 0.37018652956949244, 'f1-score': 0.35406564370338306, 'support': 102632}, 'weighted avg': {'precision': 0.3640395969082919, 'recall': 0.37243744641047627, 'f1-score': 0.3551098288918964, 'support': 102632}}
[[19630  5931  9864]
 [17061  6001 11050]
 [14294  6208 12593]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1784548
{'0': {'precision': 0.3661980749746707, 'recall': 0.5712169103121296, 'f1-score': 0.44628800740855074, 'support': 10124}, '1': {'precision': 0.3418745785569791, 'recall': 0.09675572519083969, 'f1-score': 0.15082552431950022, 'support': 10480}, '2': {'precision': 0.38627901449734614, 'recall': 0.45244502180569734, 'f1-score': 0.4167521367521368, 'support': 10777}, 'accuracy': 0.3719766737834996, 'macro avg': {'precision': 0.36478388934299866, 'recall': 0.3734725524362223, 'f1-score': 0.33795522282672924, 'support': 31381}, 'weighted avg': {'precision': 0.36497128305530757, 'recall': 0.3719766737834996, 'f1-score': 0.3374720072543994, 'support': 31381}}
[[5783  879 3462]
 [5181 1014 4285]
 [4828 1073 4876]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1426107
{'0': {'precision': 0.30723558863928396, 'recall': 0.6926695484761525, 'f1-score': 0.42566585280781305, 'support': 110116}, '1': {'precision': 0.5162952109200277, 'recall': 0.17119798698907573, 'f1-score': 0.2571333100325315, 'support': 195528}, '2': {'precision': 0.3661117837897792, 'recall': 0.34252557483937357, 'f1-score': 0.35392615890489293, 'support': 115641}, 'accuracy': 0.35452959398032213, 'macro avg': {'precision': 0.3965475277830303, 'recall': 0.40213103676820056, 'f1-score': 0.3455751072484125, 'support': 421285}, 'weighted avg': {'precision': 0.42042621234700606, 'recall': 0.35452959398032213, 'f1-score': 0.3277537957291303, 'support': 421285}}
[[ 76274  13093  20749]
 [114222  33474  47832]
 [ 57763  18268  39610]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1514859
{'0': {'precision': 0.39078854373506544, 'recall': 0.5131701065099218, 'f1-score': 0.4436950706916316, 'support': 45254}, '1': {'precision': 0.34300724123242937, 'recall': 0.2720801892104967, 'f1-score': 0.30345433990704684, 'support': 44395}, '2': {'precision': 0.4092194499361846, 'recall': 0.36377388712153236, 'f1-score': 0.3851607584501237, 'support': 44951}, 'accuracy': 0.3837592867756315, 'macro avg': {'precision': 0.38100507830122643, 'recall': 0.38300806094731693, 'f1-score': 0.3774367230162674, 'support': 134600}, 'weighted avg': {'precision': 0.38118406186316334, 'recall': 0.3837592867756315, 'f1-score': 0.377891481443863, 'support': 134600}}
[[23223 11257 10774]
 [19483 12079 12833]
 [16720 11879 16352]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1359403
{'0': {'precision': 0.3815658575407879, 'recall': 0.6248269121120795, 'f1-score': 0.47379636206417347, 'support': 12277}, '1': {'precision': 0.3687685704853087, 'recall': 0.18108130015400828, 'f1-score': 0.24289209024191358, 'support': 12337}, '2': {'precision': 0.42315601251676355, 'recall': 0.3717113013429671, 'f1-score': 0.3957688769964044, 'support': 12733}, 'accuracy': 0.39194580555332426, 'macro avg': {'precision': 0.39116348018095337, 'recall': 0.39253983786968494, 'f1-score': 0.37081910976749716, 'support': 37347}, 'weighted avg': {'precision': 0.39151812446733225, 'recall': 0.39194580555332426, 'f1-score': 0.37091822007581765, 'support': 37347}}
[[7671 1715 2891]
 [6542 2234 3561]
 [5891 2109 4733]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
5929/5929 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85274744
{'0': {'precision': 0.37508954361640673, 'recall': 0.646519947569286, 'f1-score': 0.4747467093149552, 'support': 276174}, '1': {'precision': 0.7819694796305673, 'recall': 0.5922811645860642, 'f1-score': 0.6740339486329431, 'support': 967348}, '2': {'precision': 0.46281612526185256, 'recall': 0.5215963452058193, 'f1-score': 0.49045132336492203, 'support': 274051}, 'accuracy': 0.5893871332713484, 'macro avg': {'precision': 0.5399583828362755, 'recall': 0.5867991524537232, 'f1-score': 0.5464106604376068, 'support': 1517573}, 'weighted avg': {'precision': 0.6502895173705142, 'recall': 0.5893871332713484, 'f1-score': 0.6046145822705128, 'support': 1517573}}
[[178552  67996  29626]
 [258119 572942 136287]
 [ 39354  91753 142944]]
Evaluating performance on  train set...
1254/1254 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9440047
{'0': {'precision': 0.3575616524191022, 'recall': 0.7357595665321033, 'f1-score': 0.4812481489104298, 'support': 65149}, '1': {'precision': 0.7967960956652395, 'recall': 0.37087673725226245, 'f1-score': 0.5061574233551499, 'support': 190171}, '2': {'precision': 0.4080269937902087, 'recall': 0.6115494759931758, 'f1-score': 0.4894751921775654, 'support': 65648}, 'accuracy': 0.4941645273049027, 'macro avg': {'precision': 0.5207949139581834, 'recall': 0.5727285932591805, 'f1-score': 0.49229358814771507, 'support': 320968}, 'weighted avg': {'precision': 0.6281263256478714, 'recall': 0.4941645273049027, 'f1-score': 0.49768938469352275, 'support': 320968}}
[[47934  6762 10453]
 [71848 70530 47793]
 [14276 11225 40147]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9194799
{'0': {'precision': 0.3475712983461388, 'recall': 0.7484576556365676, 'f1-score': 0.47469986660738106, 'support': 21396}, '1': {'precision': 0.7845813458996609, 'recall': 0.411858756806492, 'f1-score': 0.5401636020138676, 'support': 66297}, '2': {'precision': 0.44235044997353096, 'recall': 0.5824890789106795, 'f1-score': 0.5028383447335165, 'support': 21518}, 'accuracy': 0.5114228420214081, 'macro avg': {'precision': 0.5248343647397768, 'recall': 0.5809351637845798, 'f1-score': 0.5059006044515884, 'support': 109211}, 'weighted avg': {'precision': 0.631534570428384, 'recall': 0.5114228420214081, 'f1-score': 0.5199840691012876, 'support': 109211}}
[[16014  2787  2595]
 [25786 27305 13206]
 [ 4274  4710 12534]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
5331/5331 - 64s - 64s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9946157
{'0': {'precision': 0.2758081563409516, 'recall': 0.8183192070828558, 'f1-score': 0.41256460508882803, 'support': 238209}, '1': {'precision': 0.832852407876779, 'recall': 0.3379643182087899, 'f1-score': 0.48081717646396716, 'support': 884765}, '2': {'precision': 0.3659144682460268, 'recall': 0.45250629055754205, 'f1-score': 0.40462951826735377, 'support': 241632}, 'accuracy': 0.4420983052983792, 'macro avg': {'precision': 0.49152501082125255, 'recall': 0.5362632719497292, 'f1-score': 0.432670433273383, 'support': 1364606}, 'weighted avg': {'precision': 0.6529322680393785, 'recall': 0.4420983052983792, 'f1-score': 0.4554122222133889, 'support': 1364606}}
[[194931  19565  23713]
 [419986 299019 165760]
 [ 91846  40446 109340]]
Evaluating performance on  train set...
2013/2013 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9579218
{'0': {'precision': 0.341326098238745, 'recall': 0.49519171201738416, 'f1-score': 0.40410820396353797, 'support': 104923}, '1': {'precision': 0.7059016480642559, 'recall': 0.5177279140685449, 'f1-score': 0.5973457966361085, 'support': 307594}, '2': {'precision': 0.37088433592982917, 'recall': 0.49607471180504886, 'f1-score': 0.42444067119456647, 'support': 102795}, 'accuracy': 0.5088198994007513, 'macro avg': {'precision': 0.47270402741094336, 'recall': 0.5029981126303259, 'f1-score': 0.4752982239314043, 'support': 515312}, 'weighted avg': {'precision': 0.5648405724145515, 'recall': 0.5088198994007513, 'f1-score': 0.523509265940632, 'support': 515312}}
[[ 51957  33767  19199]
 [ 81044 159250  67300]
 [ 19220  32581  50994]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9537518
{'0': {'precision': 0.32150343237436463, 'recall': 0.7197196316499501, 'f1-score': 0.44446255546500046, 'support': 34098}, '1': {'precision': 0.7778182721775864, 'recall': 0.42564590698939353, 'f1-score': 0.5502036033396808, 'support': 110310}, '2': {'precision': 0.3934565386107877, 'recall': 0.48396527549894097, 'f1-score': 0.4340427808917367, 'support': 33521}, 'accuracy': 0.49298877642205596, 'macro avg': {'precision': 0.49759274772091294, 'recall': 0.5431102713794282, 'f1-score': 0.4762363132321393, 'support': 177929}, 'weighted avg': {'precision': 0.6179589289648278, 'recall': 0.49298877642205596, 'f1-score': 0.508055414007372, 'support': 177929}}
[[24541  5154  4403]
 [42751 46953 20606]
 [ 9040  8258 16223]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
4192/4192 - 51s - 51s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0353022
{'0': {'precision': 0.3955176952325241, 'recall': 0.6770790630720847, 'f1-score': 0.49934283027250326, 'support': 319555}, '1': {'precision': 0.5669610271253233, 'recall': 0.3057175293429767, 'f1-score': 0.39723658421944147, 'support': 439543}, '2': {'precision': 0.45714443841037156, 'recall': 0.42082202947282615, 'f1-score': 0.43823188554773185, 'support': 314052}, 'accuracy': 0.449983692866794, 'macro avg': {'precision': 0.47320772025607294, 'recall': 0.46787287396262917, 'f1-score': 0.44493710001322556, 'support': 1073150}, 'weighted avg': {'precision': 0.4837725695545163, 'recall': 0.449983692866794, 'f1-score': 0.4396381290456432, 'support': 1073150}}
[[216364  42609  60582]
 [208810 134376  96357]
 [121866  60026 132160]]
Evaluating performance on  train set...
1230/1230 - 15s - 15s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0535847
{'0': {'precision': 0.4476286062055564, 'recall': 0.5924927924023441, 'f1-score': 0.5099726305119107, 'support': 106138}, '1': {'precision': 0.4410413816879636, 'recall': 0.38227157494963515, 'f1-score': 0.40955892224597495, 'support': 103743}, '2': {'precision': 0.4815003374338452, 'recall': 0.3873659345055531, 'f1-score': 0.4293337978431963, 'support': 104986}, 'accuracy': 0.4548333105724004, 'macro avg': {'precision': 0.4567234417757884, 'recall': 0.4540434339525108, 'f1-score': 0.449621783533694, 'support': 314867}, 'weighted avg': {'precision': 0.45675207465923523, 'recall': 0.4548333105724004, 'f1-score': 0.45000074453087546, 'support': 314867}}
[[62886 22193 21059]
 [41351 39658 22734]
 [36250 28068 40668]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0518147
{'0': {'precision': 0.4340428899264066, 'recall': 0.645028517669195, 'f1-score': 0.5189092027151676, 'support': 34014}, '1': {'precision': 0.4575449569976544, 'recall': 0.34499631540162123, 'f1-score': 0.39337870767162425, 'support': 33925}, '2': {'precision': 0.48478002833403533, 'recall': 0.36906080568996674, 'f1-score': 0.4190788275987621, 'support': 34306}, 'accuracy': 0.4528827815541102, 'macro avg': {'precision': 0.4587892917526988, 'recall': 0.45302854625359434, 'f1-score': 0.4437889126618513, 'support': 102245}, 'weighted avg': {'precision': 0.45886460145855185, 'recall': 0.4528827815541102, 'f1-score': 0.4437622234683035, 'support': 102245}}
[[21940  5768  6306]
 [15071 11704  7150]
 [13537  8108 12661]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
6143/6143 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99881446
{'0': {'precision': 0.4218648854030828, 'recall': 0.680842181764697, 'f1-score': 0.5209423563874683, 'support': 462323}, '1': {'precision': 0.563739490004137, 'recall': 0.4307065321123892, 'f1-score': 0.4883247061267594, 'support': 654903}, '2': {'precision': 0.5216559102844102, 'recall': 0.37354044579551743, 'f1-score': 0.4353448937902222, 'support': 455276}, 'accuracy': 0.48769667701535513, 'macro avg': {'precision': 0.5024200952305433, 'recall': 0.4950297198908679, 'f1-score': 0.48153731876815, 'support': 1572502}, 'weighted avg': {'precision': 0.5098435097996912, 'recall': 0.48769667701535513, 'f1-score': 0.4825755578777603, 'support': 1572502}}
[[314769  88138  59416]
 [276304 282071  96528]
 [155064 130148 170064]]
Evaluating performance on  train set...
2083/2083 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0288118
{'0': {'precision': 0.456713026168603, 'recall': 0.5857692372866995, 'f1-score': 0.5132527437175981, 'support': 177039}, '1': {'precision': 0.4891721946745011, 'recall': 0.40709149242172804, 'f1-score': 0.4443733281807587, 'support': 180780}, '2': {'precision': 0.4910375389358081, 'recall': 0.43590576859485286, 'f1-score': 0.46183211870626356, 'support': 175398}, 'accuracy': 0.47589442947242866, 'macro avg': {'precision': 0.47897425325963744, 'recall': 0.4762554994344268, 'f1-score': 0.47315273020154014, 'support': 533217}, 'weighted avg': {'precision': 0.47900867573123607, 'recall': 0.47589442947242866, 'f1-score': 0.4729856563470006, 'support': 533217}}
[[103704  34471  38864]
 [ 66802  73594  40384]
 [ 56560  42381  76457]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0349916
{'0': {'precision': 0.4399286702863835, 'recall': 0.5818841089910582, 'f1-score': 0.5010458031465034, 'support': 56812}, '1': {'precision': 0.4736490612120287, 'recall': 0.4032326185834958, 'f1-score': 0.4356135055454162, 'support': 61560}, '2': {'precision': 0.4915268473992566, 'recall': 0.4120878153553635, 'f1-score': 0.4483154890731838, 'support': 56801}, 'accuracy': 0.46404411638779947, 'macro avg': {'precision': 0.4683681929658896, 'recall': 0.46573484764330586, 'f1-score': 0.46165826592170117, 'support': 175173}, 'weighted avg': {'precision': 0.4685098747161245, 'recall': 0.46404411638779947, 'f1-score': 0.46095317009231385, 'support': 175173}}
[[33058 12203 11551]
 [24074 24823 12663]
 [18012 15382 23407]]
testing model on single stock: results/universal/W7/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
23942/23942 - 295s - 295s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1136166
{'0': {'precision': 0.3410383579374994, 'recall': 0.6524112645397565, 'f1-score': 0.44792863437553915, 'support': 1923949}, '1': {'precision': 0.3824601299055423, 'recall': 0.38111681351344523, 'f1-score': 0.38178729010039414, 'support': 2296498}, '2': {'precision': 0.4494534324442501, 'recall': 0.037699025000825205, 'f1-score': 0.06956325859582821, 'support': 1908617}, 'accuracy': 0.3593359442812149, 'macro avg': {'precision': 0.39098397342909724, 'recall': 0.35707570101800895, 'f1-score': 0.2997597276905872, 'support': 6129064}, 'weighted avg': {'precision': 0.39031959741238786, 'recall': 0.3593359442812149, 'f1-score': 0.3053215326598895, 'support': 6129064}}
[[1255206  638071   30672]
 [1363799  875234   57465]
 [1061537  775127   71953]]
Evaluating performance on  train set...
9052/9052 - 110s - 110s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1205844
{'0': {'precision': 0.3707207121496098, 'recall': 0.605520209992787, 'f1-score': 0.459884191244268, 'support': 772217}, '1': {'precision': 0.34633788559644524, 'recall': 0.3547039438989316, 'f1-score': 0.3504709955213485, 'support': 777454}, '2': {'precision': 0.39033205156855644, 'recall': 0.13201044032582365, 'f1-score': 0.19729547873454034, 'support': 767409}, 'accuracy': 0.3645385571495158, 'macro avg': {'precision': 0.3691302164382038, 'recall': 0.36407819807251407, 'f1-score': 0.3358835551667189, 'support': 2317080}, 'weighted avg': {'precision': 0.36903470749594675, 'recall': 0.3645385571495158, 'f1-score': 0.3362040990826058, 'support': 2317080}}
[[467593 233492  71132]
 [414588 275766  87100]
 [379127 286976 101306]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1269721
{'0': {'precision': 0.35581029497359756, 'recall': 0.6513558502466933, 'f1-score': 0.46022022942076396, 'support': 233691}, '1': {'precision': 0.33891519893563105, 'recall': 0.36043931054522177, 'f1-score': 0.34934602975059537, 'support': 237463}, '2': {'precision': 0.43400074156470153, 'recall': 0.049563645140391514, 'f1-score': 0.08896709243684704, 'support': 236161}, 'accuracy': 0.35275937877748953, 'macro avg': {'precision': 0.3762420784913101, 'recall': 0.35378626864410223, 'f1-score': 0.29951111720273543, 'support': 707315}, 'weighted avg': {'precision': 0.3762447179208531, 'recall': 0.35275937877748953, 'f1-score': 0.2990416425683205, 'support': 707315}}
[[152216  75118   6357]
 [142964  85591   8908]
 [132621  91835  11705]]
training model: results/universal/W7/deepOF_L1/h10
Epoch 1/50
12475/12475 - 263s - loss: 3.0784 - accuracy10: 0.4590 - val_loss: 3.3175 - val_accuracy10: 0.4214 - 263s/epoch - 21ms/step
Epoch 2/50
12475/12475 - 260s - loss: 3.0714 - accuracy10: 0.4594 - val_loss: 3.3156 - val_accuracy10: 0.4231 - 260s/epoch - 21ms/step
Epoch 3/50
12475/12475 - 241s - loss: 3.0639 - accuracy10: 0.4624 - val_loss: 3.3179 - val_accuracy10: 0.4226 - 241s/epoch - 19ms/step
Epoch 4/50
12475/12475 - 243s - loss: 3.0589 - accuracy10: 0.4647 - val_loss: 3.3202 - val_accuracy10: 0.4233 - 243s/epoch - 19ms/step
Epoch 5/50
12475/12475 - 244s - loss: 3.0538 - accuracy10: 0.4669 - val_loss: 3.3386 - val_accuracy10: 0.4240 - 244s/epoch - 20ms/step
Epoch 6/50
12475/12475 - 244s - loss: 3.0495 - accuracy10: 0.4685 - val_loss: 3.3373 - val_accuracy10: 0.4237 - 244s/epoch - 20ms/step
Epoch 7/50
12475/12475 - 244s - loss: 3.0454 - accuracy10: 0.4694 - val_loss: 3.3477 - val_accuracy10: 0.4236 - 244s/epoch - 20ms/step
Epoch 8/50
12475/12475 - 242s - loss: 3.0407 - accuracy10: 0.4709 - val_loss: 3.3506 - val_accuracy10: 0.4247 - 242s/epoch - 19ms/step
Epoch 9/50
12475/12475 - 245s - loss: 3.0360 - accuracy10: 0.4723 - val_loss: 3.3610 - val_accuracy10: 0.4247 - 245s/epoch - 20ms/step
Epoch 10/50
12475/12475 - 248s - loss: 3.0312 - accuracy10: 0.4736 - val_loss: 3.3719 - val_accuracy10: 0.4254 - 248s/epoch - 20ms/step
Epoch 11/50
12475/12475 - 249s - loss: 3.0262 - accuracy10: 0.4754 - val_loss: 3.3637 - val_accuracy10: 0.4255 - 249s/epoch - 20ms/step
Epoch 12/50
12475/12475 - 255s - loss: 3.0217 - accuracy10: 0.4764 - val_loss: 3.3690 - val_accuracy10: 0.4262 - 255s/epoch - 20ms/step
testing model in sample: results/universal/W7/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 453s - 453s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0375887
{'0': {'precision': 0.412606215384296, 'recall': 0.06578769318498294, 'f1-score': 0.11348142448175891, 'support': 2416531}, '1': {'precision': 0.49736731939384204, 'recall': 0.9040084572544188, 'f1-score': 0.6416897888293479, 'support': 4691830}, '2': {'precision': 0.36553545958628375, 'recall': 0.09033758748799635, 'f1-score': 0.14487187506376226, 'support': 2397186}, 'accuracy': 0.48571513033389874, 'macro avg': {'precision': 0.4251696647881406, 'recall': 0.35337791264246604, 'f1-score': 0.300014362791623, 'support': 9505547}, 'weighted avg': {'precision': 0.44257264801744106, 'recall': 0.48571513033389874, 'f1-score': 0.3821153704046835, 'support': 9505547}}
[[ 158978 2164803   92750]
 [ 167247 4241454  283129]
 [  59077 2121553  216556]]
Evaluating performance on  train set...
12475/12475 - 159s - 159s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0802811
{'0': {'precision': 0.4565657065966633, 'recall': 0.058062287805523305, 'f1-score': 0.10302295929059137, 'support': 952546}, '1': {'precision': 0.40705210128808705, 'recall': 0.900393766077496, 'f1-score': 0.5606460406762794, 'support': 1296455}, '2': {'precision': 0.42589128305582763, 'recall': 0.09211854541525744, 'f1-score': 0.1514739039447799, 'support': 944077}, 'accuracy': 0.410135298918473, 'macro avg': {'precision': 0.42983636364685934, 'recall': 0.35019153309942563, 'f1-score': 0.2717143013038836, 'support': 3193078}, 'weighted avg': {'precision': 0.427392858666393, 'recall': 0.410135298918473, 'f1-score': 0.3031524752166585, 'support': 3193078}}
[[  55307  863150   34089]
 [  45991 1167320   83144]
 [  19839  837271   86967]]
Evaluating performance on  val set...
3866/3866 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0743479
{'0': {'precision': 0.4457167394260359, 'recall': 0.06548551600862206, 'f1-score': 0.11419351289902639, 'support': 285315}, '1': {'precision': 0.4231387763260708, 'recall': 0.8955218140607011, 'f1-score': 0.5747195409302487, 'support': 416039}, '2': {'precision': 0.4101608121462582, 'recall': 0.09516513981385945, 'f1-score': 0.1544864691103197, 'support': 287847}, 'accuracy': 0.4232193457143695, 'macro avg': {'precision': 0.42633877596612163, 'recall': 0.3520574899610609, 'f1-score': 0.28113317431319823, 'support': 989201}, 'weighted avg': {'precision': 0.42587448270586625, 'recall': 0.4232193457143695, 'f1-score': 0.3196067653549316, 'support': 989201}}
[[ 18684 254654  11977]
 [ 16051 372572  27416]
 [  7184 253270  27393]]
testing model out of sample: results/universal/W7/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 186s - 186s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9583577
{'0': {'precision': 0.3954455150926388, 'recall': 0.12657025806225708, 'f1-score': 0.19176294460353718, 'support': 713975}, '1': {'precision': 0.6430768599268722, 'recall': 0.86857226932328, 'f1-score': 0.7390057874780022, 'support': 2344840}, '2': {'precision': 0.36208421914407574, 'recall': 0.19164213569054347, 'f1-score': 0.2506313541003055, 'support': 715422}, 'accuracy': 0.5998923755980348, 'macro avg': {'precision': 0.46686886472119554, 'recall': 0.39559488769202683, 'f1-score': 0.3938000287272816, 'support': 3774237}, 'weighted avg': {'precision': 0.5429689688532242, 'recall': 0.5998923755980348, 'f1-score': 0.5429101202962023, 'support': 3774237}}
[[  90368  578603   45004]
 [ 111631 2036663  196546]
 [  26523  551794  137105]]
Evaluating performance on  train set...
5285/5285 - 64s - 64s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98703736
{'0': {'precision': 0.42366257370043814, 'recall': 0.10614566781071384, 'f1-score': 0.1697593328619151, 'support': 295151}, '1': {'precision': 0.5858076699339497, 'recall': 0.8745970518277416, 'f1-score': 0.7016488695603049, 'support': 766848}, '2': {'precision': 0.38035947834535333, 'recall': 0.1751101018442059, 'f1-score': 0.2398143457927411, 'support': 290640}, 'accuracy': 0.5566200590105712, 'macro avg': {'precision': 0.463276573993247, 'recall': 0.38528427382755376, 'f1-score': 0.37040751607165373, 'support': 1352639}, 'weighted avg': {'precision': 0.5062825714400228, 'recall': 0.5566200590105712, 'f1-score': 0.48635468195084575, 'support': 1352639}}
[[ 31329 244919  18903]
 [ 32157 670683  64008]
 [ 10462 229284  50894]]
Evaluating performance on  val set...
1714/1714 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.978906
{'0': {'precision': 0.40222926105609236, 'recall': 0.11112095702259636, 'f1-score': 0.17413492332126954, 'support': 90280}, '1': {'precision': 0.6043964990840627, 'recall': 0.8656099750856068, 'f1-score': 0.7117950127525744, 'support': 257281}, '2': {'precision': 0.3591617169113527, 'recall': 0.17711948712280315, 'f1-score': 0.2372432172335937, 'support': 90470}, 'accuracy': 0.5679072942326, 'macro avg': {'precision': 0.4552624923505026, 'recall': 0.38461680641033547, 'f1-score': 0.3743910511024792, 'support': 438031}, 'weighted avg': {'precision': 0.5120787202229085, 'recall': 0.5679072942326, 'f1-score': 0.5029681173628409, 'support': 438031}}
[[ 10032  74487   5761]
 [ 11746 222705  22830]
 [  3163  71283  16024]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
695/695 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1180539
{'0': {'precision': 0.3619729514717582, 'recall': 0.02583954870707606, 'f1-score': 0.04823577221407495, 'support': 52826}, '1': {'precision': 0.4159277159067031, 'recall': 0.9524588586276586, 'f1-score': 0.5790089510325864, 'support': 72737}, '2': {'precision': 0.3763681920084399, 'recall': 0.05451142180456872, 'f1-score': 0.09523015065316404, 'support': 52356}, 'accuracy': 0.413098095200625, 'macro avg': {'precision': 0.38475628646230037, 'recall': 0.34426994304643443, 'f1-score': 0.2408249579666085, 'support': 177919}, 'weighted avg': {'precision': 0.3882668543952407, 'recall': 0.413098095200625, 'f1-score': 0.2790559003919481, 'support': 177919}}
[[ 1365 48935  2526]
 [ 1255 69279  2203]
 [ 1151 48351  2854]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1408888
{'0': {'precision': 0.4300239234449761, 'recall': 0.030666211720549348, 'f1-score': 0.05724978103352178, 'support': 23446}, '1': {'precision': 0.36275738585496864, 'recall': 0.9484278692361707, 'f1-score': 0.5247911585036803, 'support': 25634}, '2': {'precision': 0.38461538461538464, 'recall': 0.055424631229815835, 'f1-score': 0.09688739700945988, 'support': 22914}, 'accuracy': 0.365322110175848, 'macro avg': {'precision': 0.3924655646384431, 'recall': 0.34483957072884536, 'f1-score': 0.226309445515554, 'support': 71994}, 'weighted avg': {'precision': 0.3916206997968456, 'recall': 0.365322110175848, 'f1-score': 0.2363370939004647, 'support': 71994}}
[[  719 21576  1151]
 [  441 24312   881]
 [  512 21132  1270]]
Evaluating performance on  val set...
73/73 - 6s - 6s/epoch - 78ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1477641
{'0': {'precision': 0.3802469135802469, 'recall': 0.026306798770071745, 'f1-score': 0.0492091388400703, 'support': 5854}, '1': {'precision': 0.3537638831756479, 'recall': 0.9324659231722429, 'f1-score': 0.5129297490734035, 'support': 6456}, '2': {'precision': 0.3766114180478821, 'recall': 0.06598902871894159, 'f1-score': 0.11230093355299287, 'support': 6198}, 'accuracy': 0.355684028528204, 'macro avg': {'precision': 0.3702074049345923, 'recall': 0.3415872502204187, 'f1-score': 0.22481327382215555, 'support': 18508}, 'weighted avg': {'precision': 0.3697915836903783, 'recall': 0.355684028528204, 'f1-score': 0.23209347011827935, 'support': 18508}}
[[ 154 5330  370]
 [ 129 6020  307]
 [ 122 5667  409]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
2006/2006 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8451918
{'0': {'precision': 0.4042904290429043, 'recall': 0.11662320460283952, 'f1-score': 0.18102672834746852, 'support': 48318}, '1': {'precision': 0.835483272629165, 'recall': 0.9506381876525919, 'f1-score': 0.8893485933268567, 'support': 416962}, '2': {'precision': 0.38641554798637545, 'recall': 0.20070766989280883, 'f1-score': 0.2641917808219178, 'support': 48045}, 'accuracy': 0.8019441874056397, 'macro avg': {'precision': 0.5420630832194816, 'recall': 0.42265635404941343, 'f1-score': 0.44485570083208104, 'support': 513325}, 'weighted avg': {'precision': 0.7528653704290699, 'recall': 0.8019441874056397, 'f1-score': 0.7641640515085663, 'support': 513325}}
[[  5635  40962   1721]
 [  6991 396380  13591]
 [  1312  37090   9643]]
Evaluating performance on  train set...
538/538 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8554656
{'0': {'precision': 0.45323537722520485, 'recall': 0.11060543373327816, 'f1-score': 0.17781719416883762, 'support': 14502}, '1': {'precision': 0.8133162350127451, 'recall': 0.9477964299139109, 'f1-score': 0.8754218163188403, 'support': 109073}, '2': {'precision': 0.34480255516840885, 'recall': 0.17012893982808022, 'f1-score': 0.22783960092095165, 'support': 13960}, 'accuracy': 0.7805867597338859, 'macro avg': {'precision': 0.5371180558021196, 'recall': 0.40951026782508976, 'f1-score': 0.4270262038028765, 'support': 137535}, 'weighted avg': {'precision': 0.7277936875138404, 'recall': 0.7805867597338859, 'f1-score': 0.7361342898174126, 'support': 137535}}
[[  1604  12406    492]
 [  1673 103379   4021]
 [   262  11323   2375]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8616076
{'0': {'precision': 0.44692737430167595, 'recall': 0.11049723756906077, 'f1-score': 0.17718715393134, 'support': 4344}, '1': {'precision': 0.7984753713838937, 'recall': 0.9428891746628417, 'f1-score': 0.8646940534329216, 'support': 30327}, '2': {'precision': 0.36275415896487984, 'recall': 0.1792646722996118, 'f1-score': 0.2399510927709002, 'support': 4379}, 'accuracy': 0.7646606914212548, 'macro avg': {'precision': 0.5360523015501498, 'recall': 0.41088369484383813, 'f1-score': 0.42727743337838725, 'support': 39050}, 'weighted avg': {'precision': 0.7105074408203081, 'recall': 0.7646606914212548, 'f1-score': 0.7181568089726433, 'support': 39050}}
[[  480  3716   148]
 [  501 28595  1231]
 [   93  3501   785]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
930/930 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0632795
{'0': {'precision': 0.518780302587768, 'recall': 0.12732981590869988, 'f1-score': 0.20447350547388535, 'support': 69748}, '1': {'precision': 0.42238726461202686, 'recall': 0.8515436829428509, 'f1-score': 0.5646792828547526, 'support': 95907}, '2': {'precision': 0.48471059337459044, 'recall': 0.18420142491526595, 'f1-score': 0.26695403739160944, 'support': 72285}, 'accuracy': 0.43651760948138185, 'macro avg': {'precision': 0.4752927201914618, 'recall': 0.38769164125560557, 'f1-score': 0.3453689419067491, 'support': 237940}, 'weighted avg': {'precision': 0.4695767385648465, 'recall': 0.43651760948138185, 'f1-score': 0.368643719565419, 'support': 237940}}
[[ 8881 55995  4872]
 [ 4955 81669  9283]
 [ 3283 55687 13315]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.087174
{'0': {'precision': 0.5142378559463987, 'recall': 0.09778315709007517, 'f1-score': 0.16432050527217257, 'support': 31396}, '1': {'precision': 0.36996304988265843, 'recall': 0.8461670235546038, 'f1-score': 0.5148306740899655, 'support': 35025}, '2': {'precision': 0.49309561265513024, 'recall': 0.18142062445737805, 'f1-score': 0.26524999412331635, 'support': 31099}, 'accuracy': 0.39324241181296143, 'macro avg': {'precision': 0.4590988394947291, 'recall': 0.37512360170068565, 'f1-score': 0.3148003911618182, 'support': 97520}, 'weighted avg': {'precision': 0.4556783019421159, 'recall': 0.39324241181296143, 'f1-score': 0.32239500113584074, 'support': 97520}}
[[ 3070 26176  2150]
 [ 1738 29637  3650]
 [ 1162 24295  5642]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0948669
{'0': {'precision': 0.5267441860465116, 'recall': 0.0934020618556701, 'f1-score': 0.15866900175131346, 'support': 9700}, '1': {'precision': 0.34706173654671507, 'recall': 0.859390966687104, 'f1-score': 0.49444411781997766, 'support': 9786}, '2': {'precision': 0.52128, 'recall': 0.16984673131060368, 'f1-score': 0.25621264548600187, 'support': 9591}, 'accuracy': 0.3764143481101902, 'macro avg': {'precision': 0.46502864086440887, 'recall': 0.3742132532844593, 'f1-score': 0.303108588352431, 'support': 29077}, 'weighted avg': {'precision': 0.4644688667502602, 'recall': 0.3764143481101902, 'f1-score': 0.3038502918743435, 'support': 29077}}
[[ 906 8196  598]
 [ 478 8410  898]
 [ 336 7626 1629]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1065614
{'0': {'precision': 0.4131646655231561, 'recall': 0.043703082121878754, 'f1-score': 0.0790450601964846, 'support': 88186}, '1': {'precision': 0.3536179994542613, 'recall': 0.8862122201154249, 'f1-score': 0.5055217842292996, 'support': 96513}, '2': {'precision': 0.4123211596385542, 'recall': 0.09983931807044934, 'f1-score': 0.16075376838319616, 'support': 87751}, 'accuracy': 0.36023490548724535, 'macro avg': {'precision': 0.3930346082053238, 'recall': 0.34325154010258435, 'f1-score': 0.24844020426966015, 'support': 272450}, 'weighted avg': {'precision': 0.39179910902770027, 'recall': 0.36023490548724535, 'f1-score': 0.25643749520720655, 'support': 272450}}
[[ 3854 79504  4828]
 [ 3323 85531  7659]
 [ 2151 76839  8761]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1233656
{'0': {'precision': 0.4632497887918896, 'recall': 0.04627415679765957, 'f1-score': 0.08414322250639386, 'support': 35549}, '1': {'precision': 0.3336303669814499, 'recall': 0.91081971103925, 'f1-score': 0.48837172308475446, 'support': 33707}, '2': {'precision': 0.44589235127478755, 'recall': 0.09431927133269415, 'f1-score': 0.15570283905430804, 'support': 33376}, 'accuracy': 0.3458375555382337, 'macro avg': {'precision': 0.4142575023493757, 'recall': 0.3504710463898679, 'f1-score': 0.24273926154848546, 'support': 102632}, 'weighted avg': {'precision': 0.4150347711995666, 'recall': 0.3458375555382337, 'f1-score': 0.24017354278562436, 'support': 102632}}
[[ 1645 32025  1879]
 [  973 30701  2033]
 [  933 29295  3148]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1167804
{'0': {'precision': 0.4609375, 'recall': 0.04083044982698962, 'f1-score': 0.07501589319771139, 'support': 10115}, '1': {'precision': 0.3461024342197833, 'recall': 0.9201346675395118, 'f1-score': 0.5030035019554715, 'support': 10693}, '2': {'precision': 0.46037919299951385, 'recall': 0.08956776695356096, 'f1-score': 0.14996041171813143, 'support': 10573}, 'accuracy': 0.3568719926069915, 'macro avg': {'precision': 0.4224730424064324, 'recall': 0.35017762810668746, 'f1-score': 0.24265993562377144, 'support': 31381}, 'weighted avg': {'precision': 0.42161962172002176, 'recall': 0.3568719926069915, 'f1-score': 0.2461022159650907, 'support': 31381}}
[[ 413 9205  497]
 [ 241 9839  613]
 [ 242 9384  947]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0919745
{'0': {'precision': 0.4442225020626167, 'recall': 0.0793047846444851, 'f1-score': 0.134583127775037, 'support': 128996}, '1': {'precision': 0.3939486020679615, 'recall': 0.8837720929079597, 'f1-score': 0.5449716544730903, 'support': 161364}, '2': {'precision': 0.4349277281253448, 'recall': 0.12043232508402077, 'f1-score': 0.18863206757112433, 'support': 130920}, 'accuracy': 0.40022312951006456, 'macro avg': {'precision': 0.42436627741864097, 'recall': 0.36116973421215515, 'f1-score': 0.28939561660641716, 'support': 421280}, 'weighted avg': {'precision': 0.42207744556193977, 'recall': 0.40022312951006456, 'f1-score': 0.30857197467070835, 'support': 421280}}
[[ 10230 109762   9004]
 [  7274 142609  11481]
 [  5525 109628  15767]]
Evaluating performance on  train set...
526/526 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1217016
{'0': {'precision': 0.5114141713608064, 'recall': 0.07472384665367121, 'f1-score': 0.13039534356338348, 'support': 46170}, '1': {'precision': 0.32710667968446244, 'recall': 0.886440797021705, 'f1-score': 0.477872866808038, 'support': 42709}, '2': {'precision': 0.4867921413240878, 'recall': 0.12898075240594925, 'f1-score': 0.20392848497423663, 'support': 45720}, 'accuracy': 0.350715829983878, 'macro avg': {'precision': 0.44177099745645226, 'recall': 0.3633817986937751, 'f1-score': 0.27073223178188605, 'support': 134599}, 'weighted avg': {'precision': 0.4445688911188748, 'recall': 0.350715829983878, 'f1-score': 0.26562928115251977, 'support': 134599}}
[[ 3450 39620  3100]
 [ 1733 37859  3117]
 [ 1563 38260  5897]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1282685
{'0': {'precision': 0.4829683698296837, 'recall': 0.06235765334171051, 'f1-score': 0.11045419767684496, 'support': 12733}, '1': {'precision': 0.3162767576972069, 'recall': 0.8819961878357304, 'f1-score': 0.4655949141302111, 'support': 11542}, '2': {'precision': 0.4793623683461429, 'recall': 0.12885454128089371, 'f1-score': 0.20311180798456158, 'support': 13069}, 'accuracy': 0.3389567266495287, 'macro avg': {'precision': 0.42620249862434445, 'recall': 0.35773612748611155, 'f1-score': 0.25972030659720585, 'support': 37344}, 'weighted avg': {'precision': 0.43018662656111467, 'recall': 0.3389567266495287, 'f1-score': 0.2526450839883354, 'support': 37344}}
[[  794 11030   909]
 [  442 10180   920]
 [  408 10977  1684]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/EXC
Evaluating performance on  test set...
5928/5928 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8964881
{'0': {'precision': 0.28917464114832536, 'recall': 0.17522877593548972, 'f1-score': 0.2182228490832158, 'support': 176592}, '1': {'precision': 0.8011220612385925, 'recall': 0.8289391333572248, 'f1-score': 0.8147932474659457, 'support': 1166386}, '2': {'precision': 0.24898612488584698, 'recall': 0.29046337132710925, 'f1-score': 0.2681301947845949, 'support': 174590}, 'accuracy': 0.6909206045462213, 'macro avg': {'precision': 0.4464276090909216, 'recall': 0.4315437602066079, 'f1-score': 0.43371543044458544, 'support': 1517568}, 'weighted avg': {'precision': 0.6780282480213883, 'recall': 0.6909206045462213, 'f1-score': 0.6824819031579212, 'support': 1517568}}
[[ 30944 124871  20777]
 [ 67338 966863 132185]
 [  8726 115152  50712]]
Evaluating performance on  train set...
1254/1254 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89954007
{'0': {'precision': 0.3120446370930554, 'recall': 0.16717310210232467, 'f1-score': 0.2177109305879514, 'support': 40479}, '1': {'precision': 0.7702115543629187, 'recall': 0.8237961545360872, 'f1-score': 0.7961031971441184, 'support': 239711}, '2': {'precision': 0.26662314650750724, 'recall': 0.28045909358446147, 'f1-score': 0.27336616149543436, 'support': 40776}, 'accuracy': 0.671959023697214, 'macro avg': {'precision': 0.44962644598782714, 'recall': 0.4238094500742911, 'f1-score': 0.42906009640916803, 'support': 320966}, 'weighted avg': {'precision': 0.648452677837433, 'recall': 0.671959023697214, 'f1-score': 0.656749290738026, 'support': 320966}}
[[  6767  31123   2589]
 [ 13371 197473  28867]
 [  1548  27792  11436]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89319026
{'0': {'precision': 0.2970322580645161, 'recall': 0.17832519947323572, 'f1-score': 0.2228568662568372, 'support': 12909}, '1': {'precision': 0.7870768450535391, 'recall': 0.8207747875524358, 'f1-score': 0.8035726894019629, 'support': 83197}, '2': {'precision': 0.2649299415045572, 'recall': 0.29721480351011065, 'f1-score': 0.2801452871579099, 'support': 13105}, 'accuracy': 0.6820100539322962, 'macro avg': {'precision': 0.4496796815408708, 'recall': 0.43210493017859414, 'f1-score': 0.43552494760557003, 'support': 109211}, 'weighted avg': {'precision': 0.6664963106343808, 'recall': 0.6820100539322962, 'f1-score': 0.6721209430816404, 'support': 109211}}
[[ 2302  9757   850]
 [ 4954 68286  9957]
 [  494  8716  3895]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/AAL
Evaluating performance on  test set...
5331/5331 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87469846
{'0': {'precision': 0.32982320410326943, 'recall': 0.15773426151780087, 'f1-score': 0.2134083598305415, 'support': 145948}, '1': {'precision': 0.8076847025292937, 'recall': 0.8850867574620384, 'f1-score': 0.8446161236874871, 'support': 1070686}, '2': {'precision': 0.2771518627943149, 'recall': 0.22759804551014753, 'f1-score': 0.24994248138994649, 'support': 147967}, 'accuracy': 0.7360012194040603, 'macro avg': {'precision': 0.471553256475626, 'recall': 0.42347302149666227, 'f1-score': 0.43598898830265836, 'support': 1364601}, 'weighted avg': {'precision': 0.6990490774129798, 'recall': 0.7360012194040603, 'f1-score': 0.7126247316621012, 'support': 1364601}}
[[ 23021 115200   7727]
 [ 42929 947650  80107]
 [  3848 110442  33677]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89424
{'0': {'precision': 0.35791574279379157, 'recall': 0.12049505837389149, 'f1-score': 0.18029307956931598, 'support': 66982}, '1': {'precision': 0.7639491214735995, 'recall': 0.8926108760382385, 'f1-score': 0.8232835461334617, 'support': 382860}, '2': {'precision': 0.30198150594451784, 'recall': 0.20950693468564796, 'f1-score': 0.2473847485751389, 'support': 65468}, 'accuracy': 0.7054627311715278, 'macro avg': {'precision': 0.47461545673730293, 'recall': 0.40753762303259267, 'f1-score': 0.4169871247593055, 'support': 515310}, 'weighted avg': {'precision': 0.652480251037961, 'recall': 0.7054627311715278, 'f1-score': 0.666539586361775, 'support': 515310}}
[[  8071  55498   3413]
 [ 12824 341745  28291]
 [  1655  50097  13716]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8894008
{'0': {'precision': 0.32824348187389635, 'recall': 0.14694940476190477, 'f1-score': 0.20301307378497319, 'support': 21504}, '1': {'precision': 0.7845569569381836, 'recall': 0.8642068217534695, 'f1-score': 0.8224579930766692, 'support': 135537}, '2': {'precision': 0.2689292291502236, 'recall': 0.24468594408272692, 'f1-score': 0.25623542977464714, 'support': 20888}, 'accuracy': 0.7047923609979262, 'macro avg': {'precision': 0.4605765559874346, 'recall': 0.4186140568660337, 'f1-score': 0.4272354988787632, 'support': 177929}, 'weighted avg': {'precision': 0.6688760002317595, 'recall': 0.7047923609979262, 'f1-score': 0.6811218396295005, 'support': 177929}}
[[  3160  17110   1234]
 [  5745 117132  12660]
 [   722  15055   5111]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/WBA
Evaluating performance on  test set...
4192/4192 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97057927
{'0': {'precision': 0.43857119974371295, 'recall': 0.13410273878061704, 'f1-score': 0.20539994953318194, 'support': 224589}, '1': {'precision': 0.6109328880605666, 'recall': 0.8704348958498764, 'f1-score': 0.717954461499768, 'support': 629668}, '2': {'precision': 0.3890296616485318, 'recall': 0.1907825006395965, 'f1-score': 0.25601412491723685, 'support': 218888}, 'accuracy': 0.5777066472843837, 'macro avg': {'precision': 0.4795112498176038, 'recall': 0.39844004509003, 'f1-score': 0.393122845316729, 'support': 1073145}, 'weighted avg': {'precision': 0.5295995243117058, 'recall': 0.5777066472843837, 'f1-score': 0.5164650992216596, 'support': 1073145}}
[[ 30118 180865  13606]
 [ 29605 548085  51978]
 [  8950 168178  41760]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0097659
{'0': {'precision': 0.47341544007209374, 'recall': 0.12157054331336299, 'f1-score': 0.19346127091943205, 'support': 77782}, '1': {'precision': 0.5317351824839815, 'recall': 0.866255272030556, 'f1-score': 0.6589721749006245, 'support': 160754}, '2': {'precision': 0.4239403762838186, 'recall': 0.18332001414890411, 'f1-score': 0.255958587133476, 'support': 76331}, 'accuracy': 0.5167356375866635, 'macro avg': {'precision': 0.4763636662799646, 'recall': 0.3903819431642744, 'f1-score': 0.36946401098451087, 'support': 314867}, 'weighted avg': {'precision': 0.4911964421385465, 'recall': 0.5167356375866635, 'f1-score': 0.4462766580591666, 'support': 314867}}
[[  9456  63067   5259]
 [  7745 139254  13755]
 [  2773  59565  13993]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0174414
{'0': {'precision': 0.4631925914299168, 'recall': 0.11736865131448117, 'f1-score': 0.18728184299041695, 'support': 25143}, '1': {'precision': 0.5219098439921239, 'recall': 0.8720749133668185, 'f1-score': 0.6530121360107877, 'support': 51366}, '2': {'precision': 0.41831757093081134, 'recall': 0.1632732359341001, 'f1-score': 0.2348732567563791, 'support': 25736}, 'accuracy': 0.5080737444373808, 'macro avg': {'precision': 0.46780666878428406, 'recall': 0.3842389335384666, 'f1-score': 0.3583890785858612, 'support': 102245}, 'weighted avg': {'precision': 0.4813956025066966, 'recall': 0.5080737444373808, 'f1-score': 0.43323533564008354, 'support': 102245}}
[[ 2951 20457  1735]
 [ 2463 44795  4108]
 [  957 20577  4202]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
6143/6143 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9612514
{'0': {'precision': 0.40748106718543736, 'recall': 0.1482634291546719, 'f1-score': 0.2174184026450356, 'support': 316457}, '1': {'precision': 0.6256140742756559, 'recall': 0.8424777523815172, 'f1-score': 0.7180285723054813, 'support': 944146}, '2': {'precision': 0.38449498996918147, 'recall': 0.22920607642340027, 'f1-score': 0.2872036334345076, 'support': 311894}, 'accuracy': 0.5811324282335674, 'macro avg': {'precision': 0.4725300438100915, 'recall': 0.40664908598652977, 'f1-score': 0.4075502027950082, 'support': 1572497}, 'weighted avg': {'precision': 0.5338916018604889, 'recall': 0.5811324282335674, 'f1-score': 0.5318321560678293, 'support': 1572497}}
[[ 46919 248428  21110]
 [ 55395 795422  93329]
 [ 12830 227576  71488]]
Evaluating performance on  train set...
2083/2083 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0036168
{'0': {'precision': 0.43085723536871645, 'recall': 0.12557704255369345, 'f1-score': 0.1944732002581934, 'support': 127157}, '1': {'precision': 0.5453959914335468, 'recall': 0.8448934502173758, 'f1-score': 0.662885708733901, 'support': 280620}, '2': {'precision': 0.3977472491698678, 'recall': 0.19480384888272387, 'f1-score': 0.26152240802675586, 'support': 125439}, 'accuracy': 0.520423243113485, 'macro avg': {'precision': 0.45800015865737703, 'recall': 0.3884247805512644, 'f1-score': 0.37296043900628345, 'support': 533216}, 'weighted avg': {'precision': 0.48334737476459977, 'recall': 0.520423243113485, 'f1-score': 0.45676184820149174, 'support': 533216}}
[[ 15968 102188   9001]
 [ 15527 237094  27999]
 [  5566  95437  24436]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0003144
{'0': {'precision': 0.43527253668763105, 'recall': 0.12307046358270148, 'f1-score': 0.19188632381539172, 'support': 40489}, '1': {'precision': 0.5557904563176103, 'recall': 0.8617709663686676, 'f1-score': 0.6757577780745093, 'support': 93960}, '2': {'precision': 0.40378111659366855, 'recall': 0.1788380316275415, 'f1-score': 0.24788550228893313, 'support': 40724}, 'accuracy': 0.5322623920353022, 'macro avg': {'precision': 0.46494803653296995, 'recall': 0.38789315385963685, 'f1-score': 0.3718432013929447, 'support': 175173}, 'weighted avg': {'precision': 0.49259533835527564, 'recall': 0.5322623920353022, 'f1-score': 0.46444586430589646, 'support': 175173}}
[[ 4983 32855  2651]
 [ 4885 80972  8103]
 [ 1580 31861  7283]]
testing model on single stock: results/universal/W7/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
23942/23942 - 312s - 312s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0973366
{'0': {'precision': 0.473298401182319, 'recall': 0.04687398541445121, 'f1-score': 0.08530011559764271, 'support': 1878846}, '1': {'precision': 0.39321342423167865, 'recall': 0.9421021944750054, 'f1-score': 0.5548459475438342, 'support': 2382301}, '2': {'precision': 0.44845163594313314, 'recall': 0.05647107572519476, 'f1-score': 0.10031058499530222, 'support': 1867912}, 'accuracy': 0.3977646487005591, 'macro avg': {'precision': 0.4383211537857103, 'recall': 0.34848241853821715, 'f1-score': 0.2468188827122597, 'support': 6129059}, 'weighted avg': {'precision': 0.43459782877374115, 'recall': 0.3977646487005591, 'f1-score': 0.2723822991603666, 'support': 6129059}}
[[  88069 1739033   51744]
 [  59941 2244371   77989]
 [  38065 1724364  105483]]
Evaluating performance on  train set...
9052/9052 - 119s - 119s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1263343
{'0': {'precision': 0.4965139649317347, 'recall': 0.045676418007890504, 'f1-score': 0.08365688556118263, 'support': 784234}, '1': {'precision': 0.32690347560680744, 'recall': 0.9244314334647707, 'f1-score': 0.48300394461788404, 'support': 753210}, '2': {'precision': 0.48937151008054, 'recall': 0.07216847905555684, 'f1-score': 0.12578693684831793, 'support': 779634}, 'accuracy': 0.34024620664474825, 'macro avg': {'precision': 0.4375963168730274, 'recall': 0.347425443509406, 'f1-score': 0.2308159223424615, 'support': 2317078}, 'weighted avg': {'precision': 0.43897562685684693, 'recall': 0.34024620664474825, 'f1-score': 0.22764781670691553, 'support': 2317078}}
[[ 35821 724546  23867]
 [ 22077 696291  34842]
 [ 14247 709122  56265]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1201831
{'0': {'precision': 0.48452483043579947, 'recall': 0.053392553392553395, 'f1-score': 0.09618584063948496, 'support': 232804}, '1': {'precision': 0.3434844060636183, 'recall': 0.9197067238912733, 'f1-score': 0.5001696264599184, 'support': 240456}, '2': {'precision': 0.4642252776308831, 'recall': 0.07501260392900784, 'f1-score': 0.12915541758314514, 'support': 234054}, 'accuracy': 0.3550558874842008, 'macro avg': {'precision': 0.4307448380434336, 'recall': 0.34937062707094485, 'f1-score': 0.24183696156084947, 'support': 707314}, 'weighted avg': {'precision': 0.42985998877419085, 'recall': 0.3550558874842008, 'f1-score': 0.24443256920022258, 'support': 707314}}
[[ 12430 211606   8768]
 [  7812 221149  11495]
 [  5412 211085  17557]]
training model: results/universal/W7/deepOF_L1/h20
Epoch 1/50
12475/12475 - 254s - loss: 3.1348 - accuracy20: 0.4386 - val_loss: 3.2431 - val_accuracy20: 0.3754 - 254s/epoch - 20ms/step
Epoch 2/50
12475/12475 - 249s - loss: 3.1257 - accuracy20: 0.4408 - val_loss: 3.2440 - val_accuracy20: 0.3819 - 249s/epoch - 20ms/step
Epoch 3/50
12475/12475 - 251s - loss: 3.1192 - accuracy20: 0.4436 - val_loss: 3.2417 - val_accuracy20: 0.3869 - 251s/epoch - 20ms/step
Epoch 4/50
12475/12475 - 249s - loss: 3.1144 - accuracy20: 0.4453 - val_loss: 3.2420 - val_accuracy20: 0.3926 - 249s/epoch - 20ms/step
Epoch 5/50
12475/12475 - 253s - loss: 3.1098 - accuracy20: 0.4469 - val_loss: 3.2441 - val_accuracy20: 0.3984 - 253s/epoch - 20ms/step
Epoch 6/50
12475/12475 - 249s - loss: 3.1056 - accuracy20: 0.4482 - val_loss: 3.2410 - val_accuracy20: 0.4054 - 249s/epoch - 20ms/step
Epoch 7/50
12475/12475 - 249s - loss: 3.1024 - accuracy20: 0.4492 - val_loss: 3.2437 - val_accuracy20: 0.4067 - 249s/epoch - 20ms/step
Epoch 8/50
12475/12475 - 251s - loss: 3.0991 - accuracy20: 0.4500 - val_loss: 3.2438 - val_accuracy20: 0.4073 - 251s/epoch - 20ms/step
Epoch 9/50
12475/12475 - 248s - loss: 3.0960 - accuracy20: 0.4509 - val_loss: 3.2482 - val_accuracy20: 0.4082 - 248s/epoch - 20ms/step
Epoch 10/50
12475/12475 - 245s - loss: 3.0925 - accuracy20: 0.4519 - val_loss: 3.2470 - val_accuracy20: 0.4093 - 245s/epoch - 20ms/step
Epoch 11/50
12475/12475 - 246s - loss: 3.0890 - accuracy20: 0.4523 - val_loss: 3.2452 - val_accuracy20: 0.4104 - 246s/epoch - 20ms/step
Epoch 12/50
12475/12475 - 248s - loss: 3.0860 - accuracy20: 0.4531 - val_loss: 3.2496 - val_accuracy20: 0.4113 - 248s/epoch - 20ms/step
Epoch 13/50
12475/12475 - 243s - loss: 3.0830 - accuracy20: 0.4539 - val_loss: 3.2500 - val_accuracy20: 0.4119 - 243s/epoch - 19ms/step
Epoch 14/50
12475/12475 - 246s - loss: 3.0799 - accuracy20: 0.4545 - val_loss: 3.2523 - val_accuracy20: 0.4121 - 246s/epoch - 20ms/step
Epoch 15/50
12475/12475 - 244s - loss: 3.0773 - accuracy20: 0.4552 - val_loss: 3.2458 - val_accuracy20: 0.4143 - 244s/epoch - 20ms/step
Epoch 16/50
12475/12475 - 251s - loss: 3.0746 - accuracy20: 0.4560 - val_loss: 3.2524 - val_accuracy20: 0.4138 - 251s/epoch - 20ms/step
testing model in sample: results/universal/W7/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 453s - 453s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0610299
{'0': {'precision': 0.3657988199967529, 'recall': 0.2623139109924473, 'f1-score': 0.3055315212562387, 'support': 2550997}, '1': {'precision': 0.48185561342634237, 'recall': 0.6052983993618237, 'f1-score': 0.5365687438938911, 'support': 4425110}, '2': {'precision': 0.35738795911755733, 'recall': 0.29918242773103926, 'f1-score': 0.32570520813113873, 'support': 2529440}, 'accuracy': 0.43179398302906713, 'macro avg': {'precision': 0.40168079751355085, 'recall': 0.3889315793617701, 'f1-score': 0.3892684910937562, 'support': 9505547}, 'weighted avg': {'precision': 0.4175885075582302, 'recall': 0.43179398302906713, 'f1-score': 0.41845434987356595, 'support': 9505547}}
[[ 669162 1461311  420524]
 [ 806400 2678512  940198]
 [ 353755 1418921  756764]]
Evaluating performance on  train set...
12475/12475 - 152s - 152s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0751042
{'0': {'precision': 0.4089056951961972, 'recall': 0.2520119135747934, 'f1-score': 0.31183646902569245, 'support': 984759}, '1': {'precision': 0.39589995631162656, 'recall': 0.5991784133015391, 'f1-score': 0.47677593020369985, 'support': 1229572}, '2': {'precision': 0.4032300318783988, 'recall': 0.29879529643513597, 'f1-score': 0.3432447008602685, 'support': 978747}, 'accuracy': 0.4000368923026622, 'macro avg': {'precision': 0.40267856112874084, 'recall': 0.3833285411038228, 'f1-score': 0.3772857000298869, 'support': 3193078}, 'weighted avg': {'precision': 0.40215780779191684, 'recall': 0.4000368923026622, 'f1-score': 0.3849777001020898, 'support': 3193078}}
[[248171 571567 165021]
 [225049 736733 267790]
 [133695 552607 292445]]
Evaluating performance on  val set...
3866/3866 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075039
{'0': {'precision': 0.39724669872342505, 'recall': 0.27429407382688337, 'f1-score': 0.3245146676450414, 'support': 296667}, '1': {'precision': 0.41153101852096863, 'recall': 0.593485738126978, 'f1-score': 0.48603724997317566, 'support': 393076}, '2': {'precision': 0.3957100489688944, 'recall': 0.2873892165178422, 'f1-score': 0.33296127426041167, 'support': 299458}, 'accuracy': 0.405094616766461, 'macro avg': {'precision': 0.4014959220710961, 'recall': 0.38505634282390117, 'f1-score': 0.38117106395954287, 'support': 989201}, 'weighted avg': {'precision': 0.40245763282736047, 'recall': 0.405094616766461, 'f1-score': 0.3912554559125818, 'support': 989201}}
[[ 81374 166139  49154]
 [ 77521 233285  82270]
 [ 45950 167447  86061]]
testing model out of sample: results/universal/W7/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 183s - 183s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0371138
{'0': {'precision': 0.33777903056190983, 'recall': 0.36323785385098767, 'f1-score': 0.35004614828908664, 'support': 857741}, '1': {'precision': 0.5848368649298091, 'recall': 0.5445821766549249, 'f1-score': 0.5639921431546417, 'support': 2057616}, '2': {'precision': 0.3449433567913081, 'recall': 0.3758592585692995, 'f1-score': 0.35973830163511333, 'support': 858880}, 'accuracy': 0.46497424512557106, 'macro avg': {'precision': 0.422519750761009, 'recall': 0.427893096358404, 'f1-score': 0.42459219769294726, 'support': 3774237}, 'weighted avg': {'precision': 0.474098887908612, 'recall': 0.46497424512557106, 'f1-score': 0.46888953274987155, 'support': 3774237}}
[[ 311564  406400  139777]
 [ 463812 1120541  473263]
 [ 147014  389048  322818]]
Evaluating performance on  train set...
5285/5285 - 66s - 66s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0518569
{'0': {'precision': 0.36430416333558824, 'recall': 0.3393151206715334, 'f1-score': 0.3513658990111078, 'support': 349171}, '1': {'precision': 0.5193062978882452, 'recall': 0.5266269139160401, 'f1-score': 0.5229409869532358, 'support': 659577}, '2': {'precision': 0.35639698335490205, 'recall': 0.3715828561957132, 'f1-score': 0.3638315288959121, 'support': 343891}, 'accuracy': 0.43885619148937743, 'macro avg': {'precision': 0.4133358148595785, 'recall': 0.41250829692776225, 'f1-score': 0.41271280495341855, 'support': 1352639}, 'weighted avg': {'precision': 0.43787636912819045, 'recall': 0.43885619148937743, 'f1-score': 0.43819897103277816, 'support': 1352639}}
[[118479 165705  64987]
 [146453 347351 165773]
 [ 60288 155819 127784]]
Evaluating performance on  val set...
1714/1714 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0503907
{'0': {'precision': 0.34897552027685064, 'recall': 0.34336536761901215, 'f1-score': 0.346147713950762, 'support': 107489}, '1': {'precision': 0.5363742285069885, 'recall': 0.5149945413130501, 'f1-score': 0.5254670058905775, 'support': 222581}, '2': {'precision': 0.34237228093555216, 'recall': 0.37598762516093776, 'f1-score': 0.35839344522827804, 'support': 107961}, 'accuracy': 0.438617358132187, 'macro avg': {'precision': 0.40924067657313046, 'recall': 0.41144917803100006, 'f1-score': 0.4100027216898725, 'support': 438031}, 'weighted avg': {'precision': 0.4425727760739207, 'recall': 0.438617358132187, 'f1-score': 0.4402851807366926, 'support': 438031}}
[[ 36908  50460  20121]
 [ 50105 114628  57848]
 [ 18748  48621  40592]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
695/695 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1054512
{'0': {'precision': 0.31950999444752914, 'recall': 0.16826272890091012, 'f1-score': 0.22043718725309458, 'support': 54718}, '1': {'precision': 0.4064434389140271, 'recall': 0.6596072787087488, 'f1-score': 0.5029649082530279, 'support': 68089}, '2': {'precision': 0.33681320104655077, 'recall': 0.23591958194222673, 'f1-score': 0.2774795923811556, 'support': 55112}, 'accuracy': 0.3772559423108268, 'macro avg': {'precision': 0.3542555448027023, 'recall': 0.35459652985062856, 'f1-score': 0.33362722929575933, 'support': 177919}, 'weighted avg': {'precision': 0.3581389526946228, 'recall': 0.3772559423108268, 'f1-score': 0.34622898591755513, 'support': 177919}}
[[ 9207 32880 12631]
 [10207 44912 12970]
 [ 9402 32708 13002]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1133435
{'0': {'precision': 0.35752627201935433, 'recall': 0.1949218911009439, 'f1-score': 0.2522940674349125, 'support': 24261}, '1': {'precision': 0.34977704106646745, 'recall': 0.6205782453814929, 'f1-score': 0.44739081746920495, 'support': 24142}, '2': {'precision': 0.35107317685452494, 'recall': 0.23712432707388412, 'f1-score': 0.2830613535736875, 'support': 23591}, 'accuracy': 0.35148762396866406, 'macro avg': {'precision': 0.3527921633134489, 'recall': 0.3508748211854403, 'f1-score': 0.32758207949260165, 'support': 71994}, 'weighted avg': {'precision': 0.35281314451292206, 'recall': 0.35148762396866406, 'f1-score': 0.3277983703855435, 'support': 71994}}
[[ 4729 14176  5356]
 [ 4176 14982  4984]
 [ 4322 13675  5594]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1228206
{'0': {'precision': 0.35945315105035014, 'recall': 0.1750284137035233, 'f1-score': 0.23542258134963964, 'support': 6159}, '1': {'precision': 0.3293168788261588, 'recall': 0.5715972339348963, 'f1-score': 0.4178791615289766, 'support': 5929}, '2': {'precision': 0.35147566117286316, 'recall': 0.2856697819314642, 'f1-score': 0.3151744285959787, 'support': 6420}, 'accuracy': 0.34044737410849363, 'macro avg': {'precision': 0.346748563683124, 'recall': 0.34409847652329456, 'f1-score': 0.32282539049153164, 'support': 18508}, 'weighted avg': {'precision': 0.347031849827598, 'recall': 0.34044737410849363, 'f1-score': 0.32153625777090533, 'support': 18508}}
[[1078 3364 1717]
 [ 873 3389 1667]
 [1048 3538 1834]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
2006/2006 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9794142
{'0': {'precision': 0.2825404046969106, 'recall': 0.3891242727137103, 'f1-score': 0.32737564796104074, 'support': 67030}, '1': {'precision': 0.7975710436294838, 'recall': 0.6581880882851578, 'f1-score': 0.7212068933239826, 'support': 380449}, '2': {'precision': 0.29260044653283135, 'recall': 0.47568569085441786, 'f1-score': 0.36232814515336076, 'support': 65846}, 'accuracy': 0.5996435007061803, 'macro avg': {'precision': 0.45757063161974193, 'recall': 0.5076660172844286, 'f1-score': 0.47030356214612806, 'support': 513325}, 'weighted avg': {'precision': 0.6655439698183963, 'recall': 0.5996435007061804, 'f1-score': 0.6237457557820341, 'support': 513325}}
[[ 26083  34580   6367]
 [ 60684 250407  69358]
 [  5549  28975  31322]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9878608
{'0': {'precision': 0.3148155814049758, 'recall': 0.38874405765986814, 'f1-score': 0.34789569990850866, 'support': 19563}, '1': {'precision': 0.7795860985865546, 'recall': 0.6208506904168726, 'f1-score': 0.6912222977108238, 'support': 99143}, '2': {'precision': 0.2737783975364592, 'recall': 0.5005045408678103, 'f1-score': 0.3539464047623518, 'support': 18829}, 'accuracy': 0.5713600174501036, 'macro avg': {'precision': 0.4560600258426632, 'recall': 0.5033664296481836, 'f1-score': 0.46435480079389474, 'support': 137535}, 'weighted avg': {'precision': 0.6442303067466922, 'recall': 0.5713600174501036, 'f1-score': 0.5962132743994234, 'support': 137535}}
[[ 7605  9569  2389]
 [14981 61553 22609]
 [ 1571  7834  9424]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98990345
{'0': {'precision': 0.32453526323258125, 'recall': 0.38901173668991323, 'f1-score': 0.35386043632987774, 'support': 5879}, '1': {'precision': 0.7581089006180358, 'recall': 0.6160416437552696, 'f1-score': 0.6797314241799135, 'support': 27279}, '2': {'precision': 0.2936152907686051, 'recall': 0.49015614392396467, 'f1-score': 0.3672431332655137, 'support': 5892}, 'accuracy': 0.5628681177976953, 'macro avg': {'precision': 0.4587531515397407, 'recall': 0.4984031747897159, 'f1-score': 0.4669449979251017, 'support': 39050}, 'weighted avg': {'precision': 0.6227497261386008, 'recall': 0.5628681177976953, 'f1-score': 0.5835220375566612, 'support': 39050}}
[[ 2287  2884   708]
 [ 4234 16805  6240]
 [  526  2478  2888]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.068102
{'0': {'precision': 0.41661432413715355, 'recall': 0.3521851599727706, 'f1-score': 0.38170000221335243, 'support': 73450}, '1': {'precision': 0.39528813276624136, 'recall': 0.5349834648246594, 'f1-score': 0.45464704161451064, 'support': 88599}, '2': {'precision': 0.44355458624573196, 'recall': 0.3269425887127591, 'f1-score': 0.37642418265948574, 'support': 75891}, 'accuracy': 0.41220055476170464, 'macro avg': {'precision': 0.4184856810497089, 'recall': 0.4047037378367297, 'f1-score': 0.404257075495783, 'support': 237940}, 'weighted avg': {'precision': 0.4172659346373245, 'recall': 0.41220055476170464, 'f1-score': 0.4071797345918542, 'support': 237940}}
[[25868 36017 11565]
 [21638 47399 19562]
 [14585 36494 24812]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0740054
{'0': {'precision': 0.44730246127295886, 'recall': 0.3340390929454724, 'f1-score': 0.3824614411692373, 'support': 32589}, '1': {'precision': 0.3500752850075285, 'recall': 0.4992943919499325, 'f1-score': 0.41157727031332975, 'support': 32596}, '2': {'precision': 0.44071479414078596, 'recall': 0.36381629812896243, 'f1-score': 0.39859049942400215, 'support': 32335}, 'accuracy': 0.39914889253486463, 'macro avg': {'precision': 0.4126975134737578, 'recall': 0.39904992767478914, 'f1-score': 0.39754307030218977, 'support': 97520}, 'weighted avg': {'precision': 0.4126200448018065, 'recall': 0.39914889253486463, 'f1-score': 0.3975413495516067, 'support': 97520}}
[[10886 15401  6302]
 [ 7694 16275  8627]
 [ 5757 14814 11764]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0752059
{'0': {'precision': 0.44712871287128714, 'recall': 0.34326543022195194, 'f1-score': 0.38837289301685585, 'support': 9867}, '1': {'precision': 0.3343639893578773, 'recall': 0.49637062339880444, 'f1-score': 0.39957035445757255, 'support': 9368}, '2': {'precision': 0.462936142198815, 'recall': 0.3572444625076204, 'f1-score': 0.4032803807994494, 'support': 9842}, 'accuracy': 0.39732434570278913, 'macro avg': {'precision': 0.4148096148093265, 'recall': 0.3989601720427922, 'f1-score': 0.3970745427579592, 'support': 29077}, 'weighted avg': {'precision': 0.41614879023717444, 'recall': 0.39732434570278913, 'f1-score': 0.39702637561591764, 'support': 29077}}
[[3387 4714 1766]
 [2405 4650 2313]
 [1783 4543 3516]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0792272
{'0': {'precision': 0.4107503284973111, 'recall': 0.3488816273932253, 'f1-score': 0.3772965103619045, 'support': 86912}, '1': {'precision': 0.37278590920367155, 'recall': 0.4653570617503148, 'f1-score': 0.41395933958972286, 'support': 96874}, '2': {'precision': 0.41680073102613935, 'recall': 0.36525534602544435, 'f1-score': 0.38932935809044084, 'support': 88664}, 'accuracy': 0.3956248853000551, 'macro avg': {'precision': 0.4001123229090407, 'recall': 0.39316467838966146, 'f1-score': 0.3935284026806894, 'support': 272450}, 'weighted avg': {'precision': 0.3992204614947931, 'recall': 0.3956248853000551, 'f1-score': 0.3942484477068068, 'support': 272450}}
[[30322 37778 18812]
 [25291 45081 26502]
 [18208 38071 32385]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0889819
{'0': {'precision': 0.4221821585826717, 'recall': 0.34195450716090986, 'f1-score': 0.3778567328130576, 'support': 35610}, '1': {'precision': 0.34494467058029415, 'recall': 0.5008910538196507, 'f1-score': 0.4085419770582749, 'support': 33668}, '2': {'precision': 0.4089558232931727, 'recall': 0.3053007135575943, 'f1-score': 0.3496068939471968, 'support': 33354}, 'accuracy': 0.3821809961805285, 'macro avg': {'precision': 0.3920275508187128, 'recall': 0.3827154248460516, 'f1-score': 0.37866853460617644, 'support': 102632}, 'weighted avg': {'precision': 0.39254634389222437, 'recall': 0.3821809961805285, 'f1-score': 0.3787420870662735, 'support': 102632}}
[[12177 16346  7087]
 [ 9174 16864  7630]
 [ 7492 15679 10183]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088788
{'0': {'precision': 0.4083863991349273, 'recall': 0.33408688814625515, 'f1-score': 0.3675190571444018, 'support': 10174}, '1': {'precision': 0.34603798297314997, 'recall': 0.5033339683749286, 'f1-score': 0.4101210804098106, 'support': 10498}, '2': {'precision': 0.4169234720082178, 'recall': 0.3032029134372957, 'f1-score': 0.35108395956100985, 'support': 10709}, 'accuracy': 0.3801663426914375, 'macro avg': {'precision': 0.39044928470543167, 'recall': 0.3802079233194932, 'f1-score': 0.37624136570507405, 'support': 31381}, 'weighted avg': {'precision': 0.3904420965484492, 'recall': 0.3801663426914375, 'f1-score': 0.37616226737414965, 'support': 31381}}
[[3399 4742 2033]
 [2706 5284 2508]
 [2218 5244 3247]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0815338
{'0': {'precision': 0.3804968804029166, 'recall': 0.3166116749284586, 'f1-score': 0.3456269577760518, 'support': 127898}, '1': {'precision': 0.40185750936007036, 'recall': 0.5442552303310088, 'f1-score': 0.4623403578487357, 'support': 162896}, '2': {'precision': 0.39833188310448014, 'recall': 0.28767837162607485, 'f1-score': 0.3340809170360086, 'support': 130486}, 'accuracy': 0.39567271173566276, 'macro avg': {'precision': 0.3935620909558224, 'recall': 0.38284842562851407, 'f1-score': 0.3806827442202654, 'support': 421280}, 'weighted avg': {'precision': 0.3942805377735982, 'recall': 0.39567271173566276, 'f1-score': 0.3871801987232476, 'support': 421280}}
[[40494 65513 21891]
 [39430 88657 34809]
 [26500 66448 37538]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0908878
{'0': {'precision': 0.4271444222465683, 'recall': 0.2895018454213894, 'f1-score': 0.3451049815810369, 'support': 45789}, '1': {'precision': 0.3316070585457979, 'recall': 0.5176186089359742, 'f1-score': 0.4042411597539479, 'support': 43420}, '2': {'precision': 0.42102321942496296, 'recall': 0.33196739369905265, 'f1-score': 0.3712290124293229, 'support': 45390}, 'accuracy': 0.3774099361808037, 'macro avg': {'precision': 0.39325823340577637, 'recall': 0.37969594935213874, 'f1-score': 0.37352505125476926, 'support': 134599}, 'weighted avg': {'precision': 0.39426101502987193, 'recall': 0.3774099361808037, 'f1-score': 0.3729912408881009, 'support': 134599}}
[[13256 23164  9369]
 [ 9593 22475 11352]
 [ 8185 22137 15068]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899248
{'0': {'precision': 0.41523874800091387, 'recall': 0.29066048296817526, 'f1-score': 0.3419567262464722, 'support': 12506}, '1': {'precision': 0.3255752724974988, 'recall': 0.5196671709531013, 'f1-score': 0.40033668943636896, 'support': 11898}, '2': {'precision': 0.43202416918429004, 'recall': 0.32047913446676973, 'f1-score': 0.3679843826256711, 'support': 12940}, 'accuracy': 0.3739556555269923, 'macro avg': {'precision': 0.3909460632275676, 'recall': 0.3769355961293488, 'f1-score': 0.37009259943617073, 'support': 37344}, 'weighted avg': {'precision': 0.3924877657433425, 'recall': 0.3739556555269923, 'f1-score': 0.3695756924948716, 'support': 37344}}
[[3635 6384 2487]
 [2750 6183 2965]
 [2369 6424 4147]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/EXC
Evaluating performance on  test set...
5928/5928 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0011374
{'0': {'precision': 0.2915949312115149, 'recall': 0.483066961303253, 'f1-score': 0.36366801752570344, 'support': 233508}, '1': {'precision': 0.7624536460824287, 'recall': 0.5109950731419658, 'f1-score': 0.6118975201208647, 'support': 1051380}, '2': {'precision': 0.28292618816842174, 'recall': 0.5181107099879663, 'f1-score': 0.3659933482802223, 'support': 232680}, 'accuracy': 0.5077887778340081, 'macro avg': {'precision': 0.4456582551541218, 'recall': 0.5040575814777283, 'f1-score': 0.4471862953089301, 'support': 1517568}, 'weighted avg': {'precision': 0.6164794784013043, 'recall': 0.5077887778340081, 'f1-score': 0.5359994006323993, 'support': 1517568}}
[[112800  84246  36462]
 [245049 537250 269081]
 [ 28989  83137 120554]]
Evaluating performance on  train set...
1254/1254 - 16s - 16s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99802715
{'0': {'precision': 0.31137179615039395, 'recall': 0.459228888194304, 'f1-score': 0.3711154860517812, 'support': 54389}, '1': {'precision': 0.7166528583264291, 'recall': 0.5270030934895034, 'f1-score': 0.607367773610786, 'support': 211735}, '2': {'precision': 0.3009512387268216, 'recall': 0.46670435068013566, 'f1-score': 0.3659329897275697, 'support': 54842}, 'accuracy': 0.5052155056921916, 'macro avg': {'precision': 0.44299196440121485, 'recall': 0.48431211078798103, 'f1-score': 0.44813874979671225, 'support': 320966}, 'weighted avg': {'precision': 0.57694728230662, 'recall': 0.5052155056921916, 'f1-score': 0.5260809953047658, 'support': 320966}}
[[ 24977  22226   7186]
 [ 47884 111585  52266]
 [  7355  21892  25595]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99606884
{'0': {'precision': 0.30342931558385183, 'recall': 0.47724169321802457, 'f1-score': 0.3709862892525431, 'support': 17576}, '1': {'precision': 0.7420571513507488, 'recall': 0.5404099857925715, 'f1-score': 0.6253806947630494, 'support': 73905}, '2': {'precision': 0.30171202018381693, 'recall': 0.4721376198533559, 'f1-score': 0.36815832875206156, 'support': 17730}, 'accuracy': 0.5191601578595563, 'macro avg': {'precision': 0.4490661623728059, 'recall': 0.4965964329546506, 'f1-score': 0.45484177092255135, 'support': 109211}, 'weighted avg': {'precision': 0.5999776720214809, 'recall': 0.5191601578595562, 'f1-score': 0.542680338382946, 'support': 109211}}
[[ 8388  6977  2211]
 [16803 39939 17163]
 [ 2453  6906  8371]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/AAL
Evaluating performance on  test set...
5331/5331 - 64s - 64s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0090302
{'0': {'precision': 0.2566964627957253, 'recall': 0.4227329424656981, 'f1-score': 0.3194270080095244, 'support': 198021}, '1': {'precision': 0.7627553272312868, 'recall': 0.5456334458934867, 'f1-score': 0.6361791328686859, 'support': 966002}, '2': {'precision': 0.26217727522584616, 'recall': 0.45418241282693017, 'f1-score': 0.33244837596638255, 'support': 200578}, 'accuracy': 0.5143569438978867, 'macro avg': {'precision': 0.42720968841761947, 'recall': 0.47418293372870507, 'f1-score': 0.42935150561486424, 'support': 1364601}, 'weighted avg': {'precision': 0.615741491751508, 'recall': 0.5143569438978867, 'f1-score': 0.5455700242173759, 'support': 1364601}}
[[ 83710  83888  30423]
 [212970 527083 225949]
 [ 29425  80054  91099]]
Evaluating performance on  train set...
2013/2013 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0210538
{'0': {'precision': 0.28709534508401635, 'recall': 0.4104089387496607, 'f1-score': 0.33785167669018934, 'support': 88424}, '1': {'precision': 0.7090464448845952, 'recall': 0.5155644253463089, 'f1-score': 0.5970208688933855, 'support': 340231}, '2': {'precision': 0.2791557138415444, 'recall': 0.4558882926547804, 'f1-score': 0.3462753811834107, 'support': 86655}, 'accuracy': 0.4874852030816402, 'macro avg': {'precision': 0.42509916793671865, 'recall': 0.46062055225025, 'f1-score': 0.42704930892232856, 'support': 515310}, 'weighted avg': {'precision': 0.5643514353809916, 'recall': 0.4874852030816402, 'f1-score': 0.5103834527965054, 'support': 515310}}
[[ 36290  37929  14205]
 [ 77014 175411  87806]
 [ 13100  34050  39505]]
Evaluating performance on  val set...
696/696 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0184796
{'0': {'precision': 0.27723356009070294, 'recall': 0.4285914604220711, 'f1-score': 0.33668383223638915, 'support': 28526}, '1': {'precision': 0.7320096852300242, 'recall': 0.4981421827498991, 'f1-score': 0.5928453419224529, 'support': 121379}, '2': {'precision': 0.26104354955201153, 'recall': 0.4771981159006566, 'f1-score': 0.33747618386685674, 'support': 28024}, 'accuracy': 0.48369293369827293, 'macro avg': {'precision': 0.4234289316242463, 'recall': 0.46797725302420895, 'f1-score': 0.4223351193418996, 'support': 177929}, 'weighted avg': {'precision': 0.5849212469655204, 'recall': 0.48369293369827293, 'f1-score': 0.5115560157830675, 'support': 177929}}
[[12226 11511  4789]
 [27848 60464 33067]
 [ 4026 10625 13373]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/WBA
Evaluating performance on  test set...
4192/4192 - 52s - 52s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0415909
{'0': {'precision': 0.39313937857992926, 'recall': 0.3195961676996802, 'f1-score': 0.35257351600277187, 'support': 287347}, '1': {'precision': 0.5050503003497466, 'recall': 0.5918211052293079, 'f1-score': 0.5450035900818976, 'support': 505325}, '2': {'precision': 0.38592123132639206, 'recall': 0.3404249250373476, 'f1-score': 0.3617481970368322, 'support': 280473}, 'accuracy': 0.45322579893676995, 'macro avg': {'precision': 0.42803697008535596, 'recall': 0.41728073265544524, 'f1-score': 0.4197751010405006, 'support': 1073145}, 'weighted avg': {'precision': 0.4439497454256879, 'recall': 0.45322579893676995, 'f1-score': 0.44558329333733543, 'support': 1073145}}
[[ 91835 151507  44005]
 [ 98340 299062 107923]
 [ 43419 141574  95480]]
Evaluating performance on  train set...
1230/1230 - 15s - 15s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0622278
{'0': {'precision': 0.424747702350226, 'recall': 0.32053052475369964, 'f1-score': 0.36535242536546403, 'support': 97036}, '1': {'precision': 0.4165457977048046, 'recall': 0.5622424823270178, 'f1-score': 0.478550362897322, 'support': 122079}, '2': {'precision': 0.42098073145028037, 'recall': 0.33792505639568887, 'f1-score': 0.3749080312606814, 'support': 95752}, 'accuracy': 0.4195358675250185, 'macro avg': {'precision': 0.420758077168437, 'recall': 0.4068993544921354, 'f1-score': 0.40627027317448916, 'support': 314867}, 'weighted avg': {'precision': 0.4204221448455653, 'recall': 0.4195358675250185, 'f1-score': 0.41214697478356926, 'support': 314867}}
[[31103 49213 16720]
 [25657 68638 27784]
 [16467 46928 32357]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0664812
{'0': {'precision': 0.41458883751651254, 'recall': 0.32143771604147997, 'f1-score': 0.36211869906973393, 'support': 31244}, '1': {'precision': 0.41529174305131195, 'recall': 0.5711993479866541, 'f1-score': 0.48092552484292234, 'support': 39263}, '2': {'precision': 0.42076775751519696, 'recall': 0.31841956014871764, 'f1-score': 0.3625080708802641, 'support': 31738}, 'accuracy': 0.41641156046750455, 'macro avg': {'precision': 0.4168827793610071, 'recall': 0.4036855413922839, 'f1-score': 0.4018507649309735, 'support': 102245}, 'weighted avg': {'precision': 0.4167767659524368, 'recall': 0.41641156046750455, 'f1-score': 0.407862454586926, 'support': 102245}}
[[10043 15686  5515]
 [ 8439 22427  8397]
 [ 5742 15890 10106]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
6143/6143 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0371547
{'0': {'precision': 0.3816438445471391, 'recall': 0.3770630292280022, 'f1-score': 0.3793396081813118, 'support': 403654}, '1': {'precision': 0.5328980100306139, 'recall': 0.5341411603176043, 'f1-score': 0.5335188610101427, 'support': 772030}, '2': {'precision': 0.3908972457653611, 'recall': 0.3938958653068322, 'f1-score': 0.39239082681662424, 'support': 396813}, 'accuracy': 0.4584294914394113, 'macro avg': {'precision': 0.435146366781038, 'recall': 0.4350333516174795, 'f1-score': 0.4350830986693596, 'support': 1572497}, 'weighted avg': {'precision': 0.4582383456977381, 'recall': 0.4584294914394113, 'f1-score': 0.4583285676399159, 'support': 1572497}}
[[152203 188075  63376]
 [179479 412373 180178]
 [ 67127 173383 156303]]
Evaluating performance on  train set...
2083/2083 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0594795
{'0': {'precision': 0.40997039869260893, 'recall': 0.3363713411086093, 'f1-score': 0.36954195502932263, 'support': 158108}, '1': {'precision': 0.4472581175519028, 'recall': 0.5398835702684454, 'f1-score': 0.48922522939667484, 'support': 219188}, '2': {'precision': 0.4035677520138794, 'recall': 0.35954335556695743, 'f1-score': 0.380285655171946, 'support': 155920}, 'accuracy': 0.42680452199483887, 'macro avg': {'precision': 0.42026542275279705, 'recall': 0.41193275564800397, 'f1-score': 0.41301761319931446, 'support': 533216}, 'weighted avg': {'precision': 0.4234259586367655, 'recall': 0.42680452199483887, 'f1-score': 0.42188152336236034, 'support': 533216}}
[[ 53183  75376  29549]
 [ 47550 118336  53302]
 [ 28991  70869  56060]]
Evaluating performance on  val set...
685/685 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0622581
{'0': {'precision': 0.3922258979206049, 'recall': 0.32914278915746265, 'f1-score': 0.3579260600963871, 'support': 50431}, '1': {'precision': 0.45379622366970185, 'recall': 0.5394084343372925, 'f1-score': 0.4929125302513953, 'support': 74007}, '2': {'precision': 0.3959317351394706, 'recall': 0.35027101606386124, 'f1-score': 0.37170436837866955, 'support': 50735}, 'accuracy': 0.4240950374772368, 'macro avg': {'precision': 0.41398461890992583, 'recall': 0.4062740798528721, 'f1-score': 0.407514319575484, 'support': 175173}, 'weighted avg': {'precision': 0.4193114119496652, 'recall': 0.4240950374772368, 'f1-score': 0.41894565882143775, 'support': 175173}}
[[16599 24579  9253]
 [16227 39920 17860]
 [ 9494 23470 17771]]
testing model on single stock: results/universal/W7/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
23942/23942 - 285s - 285s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0853277
{'0': {'precision': 0.3910832924909867, 'recall': 0.2173297089862488, 'f1-score': 0.2793957983806508, 'support': 1876200}, '1': {'precision': 0.40402126859558446, 'recall': 0.6466570364378972, 'f1-score': 0.497322910269047, 'support': 2391082}, '2': {'precision': 0.37862807204491733, 'recall': 0.2561192881854272, 'f1-score': 0.30555133703580534, 'support': 1861777}, 'accuracy': 0.3966026432442566, 'macro avg': {'precision': 0.3912442110438295, 'recall': 0.3733686778698577, 'f1-score': 0.36075668189516774, 'support': 6129059}, 'weighted avg': {'precision': 0.39234725794208003, 'recall': 0.3966026432442566, 'f1-score': 0.372359069714653, 'support': 6129059}}
[[ 407754 1153487  314959]
 [ 377287 1546210  467585]
 [ 257586 1127354  476837]]
Evaluating performance on  train set...
9052/9052 - 108s - 108s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0921487
{'0': {'precision': 0.4301226357306264, 'recall': 0.22107764331545784, 'f1-score': 0.292046860862081, 'support': 778161}, '1': {'precision': 0.33816787247009555, 'recall': 0.6261863537047789, 'f1-score': 0.4391666490477998, 'support': 762947}, '2': {'precision': 0.4256387277392032, 'recall': 0.27665502532314395, 'f1-score': 0.335344270079948, 'support': 775970}, 'accuracy': 0.373080664526615, 'macro avg': {'precision': 0.3979764119799751, 'recall': 0.37463967411446025, 'f1-score': 0.35551925999660955, 'support': 2317078}, 'weighted avg': {'precision': 0.39834295941008957, 'recall': 0.373080664526615, 'f1-score': 0.3549891060811534, 'support': 2317078}}
[[172034 474118 132009]
 [127523 477747 157677]
 [100408 460886 214676]]
Evaluating performance on  val set...
2763/2763 - 34s - 34s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0926089
{'0': {'precision': 0.41572682614888234, 'recall': 0.24680966720450054, 'f1-score': 0.3097350882227143, 'support': 231794}, '1': {'precision': 0.3526458339262506, 'recall': 0.6140931974840066, 'f1-score': 0.44801627057361304, 'support': 242131}, '2': {'precision': 0.4156952005295222, 'recall': 0.26370994348491145, 'f1-score': 0.32270276080294247, 'support': 233389}, 'accuracy': 0.3781163669883531, 'macro avg': {'precision': 0.39468928686821836, 'recall': 0.3748709360578062, 'f1-score': 0.3601513731997566, 'support': 707314}, 'weighted avg': {'precision': 0.3941222137708792, 'recall': 0.3781163669883531, 'f1-score': 0.36135102272935815, 'support': 707314}}
[[ 57209 136122  38463]
 [ 45392 148691  48048]
 [ 35011 136831  61547]]
training model: results/universal/W7/deepOF_L1/h30
Epoch 1/50
12475/12475 - 247s - loss: 3.1769 - accuracy30: 0.4232 - val_loss: 3.2608 - val_accuracy30: 0.3651 - 247s/epoch - 20ms/step
Epoch 2/50
12475/12475 - 246s - loss: 3.1652 - accuracy30: 0.4266 - val_loss: 3.2612 - val_accuracy30: 0.3690 - 246s/epoch - 20ms/step
Epoch 3/50
12475/12475 - 244s - loss: 3.1593 - accuracy30: 0.4299 - val_loss: 3.2553 - val_accuracy30: 0.3719 - 244s/epoch - 20ms/step
Epoch 4/50
12475/12475 - 242s - loss: 3.1552 - accuracy30: 0.4322 - val_loss: 3.2558 - val_accuracy30: 0.3722 - 242s/epoch - 19ms/step
Epoch 5/50
12475/12475 - 246s - loss: 3.1525 - accuracy30: 0.4329 - val_loss: 3.2505 - val_accuracy30: 0.3744 - 246s/epoch - 20ms/step
Epoch 6/50
12475/12475 - 243s - loss: 3.1489 - accuracy30: 0.4337 - val_loss: 3.2512 - val_accuracy30: 0.3745 - 243s/epoch - 19ms/step
Epoch 7/50
12475/12475 - 242s - loss: 3.1462 - accuracy30: 0.4344 - val_loss: 3.2486 - val_accuracy30: 0.3772 - 242s/epoch - 19ms/step
Epoch 8/50
12475/12475 - 241s - loss: 3.1431 - accuracy30: 0.4355 - val_loss: 3.2487 - val_accuracy30: 0.3766 - 241s/epoch - 19ms/step
Epoch 9/50
12475/12475 - 242s - loss: 3.1406 - accuracy30: 0.4360 - val_loss: 3.2459 - val_accuracy30: 0.3811 - 242s/epoch - 19ms/step
Epoch 10/50
12475/12475 - 242s - loss: 3.1374 - accuracy30: 0.4369 - val_loss: 3.2419 - val_accuracy30: 0.3832 - 242s/epoch - 19ms/step
Epoch 11/50
12475/12475 - 242s - loss: 3.1352 - accuracy30: 0.4377 - val_loss: 3.2374 - val_accuracy30: 0.3871 - 242s/epoch - 19ms/step
Epoch 12/50
12475/12475 - 248s - loss: 3.1323 - accuracy30: 0.4385 - val_loss: 3.2365 - val_accuracy30: 0.3879 - 248s/epoch - 20ms/step
Epoch 13/50
12475/12475 - 244s - loss: 3.1300 - accuracy30: 0.4389 - val_loss: 3.2345 - val_accuracy30: 0.3904 - 244s/epoch - 20ms/step
Epoch 14/50
12475/12475 - 245s - loss: 3.1276 - accuracy30: 0.4396 - val_loss: 3.2356 - val_accuracy30: 0.3911 - 245s/epoch - 20ms/step
Epoch 15/50
12475/12475 - 251s - loss: 3.1254 - accuracy30: 0.4401 - val_loss: 3.2317 - val_accuracy30: 0.3929 - 251s/epoch - 20ms/step
Epoch 16/50
12475/12475 - 249s - loss: 3.1231 - accuracy30: 0.4404 - val_loss: 3.2313 - val_accuracy30: 0.3943 - 249s/epoch - 20ms/step
Epoch 17/50
12475/12475 - 249s - loss: 3.1208 - accuracy30: 0.4411 - val_loss: 3.2299 - val_accuracy30: 0.3962 - 249s/epoch - 20ms/step
Epoch 18/50
12475/12475 - 251s - loss: 3.1187 - accuracy30: 0.4417 - val_loss: 3.2311 - val_accuracy30: 0.3967 - 251s/epoch - 20ms/step
Epoch 19/50
12475/12475 - 259s - loss: 3.1169 - accuracy30: 0.4422 - val_loss: 3.2323 - val_accuracy30: 0.3984 - 259s/epoch - 21ms/step
Epoch 20/50
12475/12475 - 254s - loss: 3.1150 - accuracy30: 0.4425 - val_loss: 3.2289 - val_accuracy30: 0.3990 - 254s/epoch - 20ms/step
Epoch 21/50
12475/12475 - 254s - loss: 3.1131 - accuracy30: 0.4433 - val_loss: 3.2307 - val_accuracy30: 0.3991 - 254s/epoch - 20ms/step
Epoch 22/50
12475/12475 - 251s - loss: 3.1114 - accuracy30: 0.4438 - val_loss: 3.2280 - val_accuracy30: 0.3985 - 251s/epoch - 20ms/step
Epoch 23/50
12475/12475 - 247s - loss: 3.1093 - accuracy30: 0.4442 - val_loss: 3.2315 - val_accuracy30: 0.4016 - 247s/epoch - 20ms/step
Epoch 24/50
12475/12475 - 244s - loss: 3.1081 - accuracy30: 0.4447 - val_loss: 3.2329 - val_accuracy30: 0.4027 - 244s/epoch - 20ms/step
Epoch 25/50
12475/12475 - 240s - loss: 3.1063 - accuracy30: 0.4451 - val_loss: 3.2328 - val_accuracy30: 0.4035 - 240s/epoch - 19ms/step
Epoch 26/50
12475/12475 - 243s - loss: 3.1064 - accuracy30: 0.4453 - val_loss: 3.2337 - val_accuracy30: 0.4041 - 243s/epoch - 19ms/step
Epoch 27/50
12475/12475 - 242s - loss: 3.1041 - accuracy30: 0.4459 - val_loss: 3.2315 - val_accuracy30: 0.4071 - 242s/epoch - 19ms/step
Epoch 28/50
12475/12475 - 241s - loss: 3.1020 - accuracy30: 0.4463 - val_loss: 3.2387 - val_accuracy30: 0.4077 - 241s/epoch - 19ms/step
Epoch 29/50
12475/12475 - 240s - loss: 3.1003 - accuracy30: 0.4467 - val_loss: 3.2394 - val_accuracy30: 0.4061 - 240s/epoch - 19ms/step
Epoch 30/50
12475/12475 - 243s - loss: 3.0994 - accuracy30: 0.4473 - val_loss: 3.2409 - val_accuracy30: 0.4070 - 243s/epoch - 19ms/step
Epoch 31/50
12475/12475 - 242s - loss: 3.0979 - accuracy30: 0.4475 - val_loss: 3.2378 - val_accuracy30: 0.4080 - 242s/epoch - 19ms/step
Epoch 32/50
12475/12475 - 241s - loss: 3.0968 - accuracy30: 0.4479 - val_loss: 3.2409 - val_accuracy30: 0.4085 - 241s/epoch - 19ms/step
testing model in sample: results/universal/W7/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 445s - 445s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0719157
{'0': {'precision': 0.3590125356609326, 'recall': 0.4542836773879001, 'f1-score': 0.40106798067338467, 'support': 2688963}, '1': {'precision': 0.5139494336799684, 'recall': 0.28745675503574564, 'f1-score': 0.3686975182831053, 'support': 4149038}, '2': {'precision': 0.3542532845391493, 'recall': 0.5023096134049797, 'f1-score': 0.4154857298428332, 'support': 2667546}, 'accuracy': 0.394943605033987, 'macro avg': {'precision': 0.4090717512933501, 'recall': 0.4146833486095418, 'f1-score': 0.3950837429331077, 'support': 9505547}, 'weighted avg': {'precision': 0.4253047286499521, 'recall': 0.394943605033987, 'f1-score': 0.39098478720657276, 'support': 9505547}}
[[1221552  591850  875561]
 [1389446 1192669 1566923]
 [ 791535  536077 1339934]]
Evaluating performance on  train set...
12475/12475 - 153s - 153s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759957
{'0': {'precision': 0.38851559581818074, 'recall': 0.4596888359030892, 'f1-score': 0.4211161255298498, 'support': 1002365}, '1': {'precision': 0.43540933156675093, 'recall': 0.27563348559933437, 'f1-score': 0.33757008389605075, 'support': 1197028}, '2': {'precision': 0.3866366768989406, 'recall': 0.4861007260852282, 'f1-score': 0.4307008470798038, 'support': 993685}, 'accuracy': 0.3989091403341854, 'macro avg': {'precision': 0.40352053476129074, 'recall': 0.4071410158625506, 'f1-score': 0.3964623521685681, 'support': 3193078}, 'weighted avg': {'precision': 0.40551050204013156, 'recall': 0.3989091403341854, 'f1-score': 0.3927789671229906, 'support': 3193078}}
[[460776 222853 318736]
 [419539 329941 447548]
 [305676 204978 483031]]
Evaluating performance on  val set...
3866/3866 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0777026
{'0': {'precision': 0.37962837485666634, 'recall': 0.4755594730914255, 'f1-score': 0.4222133659886817, 'support': 306315}, '1': {'precision': 0.4466308858221015, 'recall': 0.26768041250942337, 'f1-score': 0.33474016170698156, 'support': 372743}, '2': {'precision': 0.38830728321520924, 'recall': 0.4783793282453578, 'f1-score': 0.42866285192574116, 'support': 310143}, 'accuracy': 0.39811221379679157, 'macro avg': {'precision': 0.4048555146313257, 'recall': 0.4072064046154022, 'f1-score': 0.3952054598738015, 'support': 989201}, 'weighted avg': {'precision': 0.4075968257779985, 'recall': 0.39811221379679157, 'f1-score': 0.3912744954592379, 'support': 989201}}
[[145671  63562  97082]
 [136331  99776 136636]
 [101718  60059 148366]]
testing model out of sample: results/universal/W7/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 183s - 183s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0612531
{'0': {'precision': 0.3404774636580914, 'recall': 0.5568169607758653, 'f1-score': 0.42256726747493, 'support': 939957}, '1': {'precision': 0.6403362212997571, 'recall': 0.23620006099420554, 'f1-score': 0.3451025532724682, 'support': 1888704}, '2': {'precision': 0.3410978175696775, 'recall': 0.5556496780798159, 'f1-score': 0.42270738071935454, 'support': 945576}, 'accuracy': 0.3960813801571019, 'macro avg': {'precision': 0.4406371675091753, 'recall': 0.4495555666166289, 'f1-score': 0.3967924004889176, 'support': 3774237}, 'weighted avg': {'precision': 0.490688228579093, 'recall': 0.3960813801571019, 'f1-score': 0.38383747179653555, 'support': 3774237}}
[[523384 133431 283142]
 [710796 446112 731796]
 [303026 117141 525409]]
Evaluating performance on  train set...
5285/5285 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0663624
{'0': {'precision': 0.37489372082928246, 'recall': 0.5430388725631572, 'f1-score': 0.44356604168015223, 'support': 384873}, '1': {'precision': 0.5975050868085269, 'recall': 0.21364910509236357, 'f1-score': 0.31475255471619207, 'support': 588273}, '2': {'precision': 0.3611680634476579, 'recall': 0.5565583554900881, 'f1-score': 0.4380632382374597, 'support': 379493}, 'accuracy': 0.4035777469080812, 'macro avg': {'precision': 0.44452229036182245, 'recall': 0.43774877771520293, 'f1-score': 0.3987939448779347, 'support': 1352639}, 'weighted avg': {'precision': 0.46785826288520665, 'recall': 0.4035777469080812, 'f1-score': 0.3860002227117302, 'support': 1352639}}
[[209001  44937 130935]
 [219937 125684 242652]
 [128556  39727 211210]]
Evaluating performance on  val set...
1714/1714 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0691357
{'0': {'precision': 0.3631532031552214, 'recall': 0.5421856167135396, 'f1-score': 0.4349674157190197, 'support': 119472}, '1': {'precision': 0.613282799347759, 'recall': 0.21007502679528403, 'f1-score': 0.31295117727753163, 'support': 198729}, '2': {'precision': 0.35099980687624943, 'recall': 0.5611866811316031, 'f1-score': 0.43187751471499625, 'support': 119830}, 'accuracy': 0.39670936531889295, 'macro avg': {'precision': 0.4424786031264099, 'recall': 0.4378157748801422, 'f1-score': 0.3932653692371825, 'support': 438031}, 'weighted avg': {'precision': 0.4733090209983366, 'recall': 0.39670936531889295, 'f1-score': 0.37876493715802606, 'support': 438031}}
[[64776 13917 40779]
 [73420 41748 83561]
 [40175 12408 67247]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
695/695 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1195222
{'0': {'precision': 0.3139882442114898, 'recall': 0.40708670177260253, 'f1-score': 0.35452747164022447, 'support': 53932}, '1': {'precision': 0.4372045096375318, 'recall': 0.2086974133441352, 'f1-score': 0.2825303564433999, 'support': 69124}, '2': {'precision': 0.33208, 'recall': 0.45396715454860287, 'f1-score': 0.3835734581828542, 'support': 54863}, 'accuracy': 0.3444657400277654, 'macro avg': {'precision': 0.3610909179496739, 'recall': 0.35658375655511354, 'f1-score': 0.34021042875549284, 'support': 177919}, 'weighted avg': {'precision': 0.36743823622546673, 'recall': 0.3444657400277654, 'f1-score': 0.33551219709856783, 'support': 177919}}
[[21955  9233 22744]
 [27348 14426 27350]
 [20620  9337 24906]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.112489
{'0': {'precision': 0.3636785418392709, 'recall': 0.4480646741793239, 'f1-score': 0.40148535679660485, 'support': 24492}, '1': {'precision': 0.37536800785083413, 'recall': 0.16120874952585662, 'f1-score': 0.22555060883922518, 'support': 23727}, '2': {'precision': 0.3557810869771412, 'recall': 0.47331230283911674, 'f1-score': 0.40621615767814595, 'support': 23775}, 'accuracy': 0.361863488624052, 'macro avg': {'precision': 0.36494254555574873, 'recall': 0.36086190884809904, 'f1-score': 0.344417374437992, 'support': 71994}, 'weighted avg': {'precision': 0.36492300624893315, 'recall': 0.361863488624052, 'f1-score': 0.3450649749060847, 'support': 71994}}
[[10974  3294 10224]
 [ 9750  3825 10152]
 [ 9451  3071 11253]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1226271
{'0': {'precision': 0.3619076365831573, 'recall': 0.3767478397486253, 'f1-score': 0.3691786621507198, 'support': 6365}, '1': {'precision': 0.328125, 'recall': 0.16165413533834586, 'f1-score': 0.2165987047253538, 'support': 5586}, '2': {'precision': 0.3728368017524644, 'recall': 0.5191398505414061, 'f1-score': 0.4339899279658316, 'support': 6557}, 'accuracy': 0.36227577263885885, 'macro avg': {'precision': 0.35428981277854055, 'recall': 0.3525139418761258, 'f1-score': 0.3399224316139684, 'support': 18508}, 'weighted avg': {'precision': 0.35558349178423954, 'recall': 0.36227577263885885, 'f1-score': 0.3460889619006438, 'support': 18508}}
[[2398  956 3011]
 [1968  903 2715]
 [2260  893 3404]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
2006/2006 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9933893
{'0': {'precision': 0.28495184659333894, 'recall': 0.6019658387337686, 'f1-score': 0.386803150215755, 'support': 83018}, '1': {'precision': 0.7965862612360048, 'recall': 0.3863635713038425, 'f1-score': 0.5203465172853833, 'support': 349329}, '2': {'precision': 0.29738005518796545, 'recall': 0.6188470942725185, 'f1-score': 0.40171868549418227, 'support': 80978}, 'accuracy': 0.45790678420104225, 'macro avg': {'precision': 0.45963938767243645, 'recall': 0.5357255014367098, 'f1-score': 0.43628945099844024, 'support': 513325}, 'weighted avg': {'precision': 0.6350909395817643, 'recall': 0.45790678420104225, 'f1-score': 0.4800353152005944, 'support': 513325}}
[[ 49974  19201  13843]
 [109802 134968 104559]
 [ 15601  15264  50113]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0021986
{'0': {'precision': 0.31842324639752295, 'recall': 0.5649032367108933, 'f1-score': 0.40727483206653364, 'support': 23666}, '1': {'precision': 0.7925058548009367, 'recall': 0.35258892045142964, 'f1-score': 0.4880448148654188, 'support': 91177}, '2': {'precision': 0.2764935891606802, 'recall': 0.6699717962277455, 'f1-score': 0.39144148203457907, 'support': 22692}, 'accuracy': 0.44148762133275166, 'macro avg': {'precision': 0.4624742301197133, 'recall': 0.5291546511300228, 'f1-score': 0.42892037632217717, 'support': 137535}, 'weighted avg': {'precision': 0.6257920049272037, 'recall': 0.44148762133275166, 'f1-score': 0.4582078625149929, 'support': 137535}}
[[13369  5093  5204]
 [24451 32148 34578]
 [ 4165  3324 15203]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.998047
{'0': {'precision': 0.3308903139835096, 'recall': 0.5590263120866751, 'f1-score': 0.41571622894213656, 'support': 7107}, '1': {'precision': 0.7733413132694938, 'recall': 0.36433577700797554, 'f1-score': 0.49531789058649583, 'support': 24826}, '2': {'precision': 0.3016224669316479, 'recall': 0.6504145004917803, 'f1-score': 0.41212606837606847, 'support': 7117}, 'accuracy': 0.4519078104993598, 'macro avg': {'precision': 0.4686180313948838, 'recall': 0.5245921965288103, 'f1-score': 0.4410533959682336, 'support': 39050}, 'weighted avg': {'precision': 0.606843943709649, 'recall': 0.4519078104993598, 'f1-score': 0.46566858948590495, 'support': 39050}}
[[3973 1549 1585]
 [6648 9045 9133]
 [1386 1102 4629]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
930/930 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0802681
{'0': {'precision': 0.387172444383786, 'recall': 0.602111881989308, 'f1-score': 0.47129247462554846, 'support': 75383}, '1': {'precision': 0.43113119351823, 'recall': 0.09836939776740218, 'f1-score': 0.16018911617136242, 'support': 84386}, '2': {'precision': 0.4170658623612672, 'recall': 0.5412876898082409, 'f1-score': 0.47112595685455816, 'support': 78171}, 'accuracy': 0.40347566613431957, 'macro avg': {'precision': 0.4117898334210944, 'recall': 0.41392298985498366, 'f1-score': 0.3675358492171563, 'support': 237940}, 'weighted avg': {'precision': 0.4125834781787632, 'recall': 0.40347566613431957, 'f1-score': 0.3609042050315709, 'support': 237940}}
[[45389  5783 24211]
 [41155  8301 34930]
 [30688  5170 42313]]
Evaluating performance on  train set...
381/381 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0732121
{'0': {'precision': 0.4173127471119652, 'recall': 0.5741331631567752, 'f1-score': 0.48332054233819394, 'support': 32907}, '1': {'precision': 0.4549125168236878, 'recall': 0.10628262373435633, 'f1-score': 0.17230831973898858, 'support': 31802}, '2': {'precision': 0.41598054309748533, 'recall': 0.5681935936118985, 'f1-score': 0.48031638068738086, 'support': 32811}, 'accuracy': 0.41956521739130437, 'macro avg': {'precision': 0.42940193567771273, 'recall': 0.41620312683434335, 'f1-score': 0.37864841425485446, 'support': 97520}, 'weighted avg': {'precision': 0.4291260872519683, 'recall': 0.41956521739130437, 'f1-score': 0.3808863724138219, 'support': 97520}}
[[18893  2147 11867]
 [14115  3380 14307]
 [12265  1903 18643]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0724431
{'0': {'precision': 0.4221084379603002, 'recall': 0.6059202577527185, 'f1-score': 0.49758154533052207, 'support': 9932}, '1': {'precision': 0.40445859872611467, 'recall': 0.0701424942008174, 'f1-score': 0.11955191565471146, 'support': 9053}, '2': {'precision': 0.43433962264150944, 'recall': 0.5702536662703132, 'f1-score': 0.49310256190557794, 'support': 10092}, 'accuracy': 0.4267290298173814, 'macro avg': {'precision': 0.42030221977597476, 'recall': 0.41543880607461636, 'f1-score': 0.37007867429693714, 'support': 29077}, 'weighted avg': {'precision': 0.4208584163354999, 'recall': 0.4267290298173814, 'f1-score': 0.3783290729922599, 'support': 29077}}
[[6018  465 3449]
 [4372  635 4046]
 [3867  470 5755]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.100549
{'0': {'precision': 0.38326302923363936, 'recall': 0.4833845262242828, 'f1-score': 0.4275403920282129, 'support': 86275}, '1': {'precision': 0.3829672416205305, 'recall': 0.19892238694406378, 'f1-score': 0.26183920140478417, 'support': 96324}, '2': {'precision': 0.39985387838456393, 'recall': 0.5055592035703553, 'f1-score': 0.4465360890614632, 'support': 89851}, 'accuracy': 0.3901266287392182, 'macro avg': {'precision': 0.38869471641291126, 'recall': 0.39595537224623395, 'f1-score': 0.3786385608314868, 'support': 272450}, 'weighted avg': {'precision': 0.38862993303622567, 'recall': 0.3901266287392182, 'f1-score': 0.3752217313144064, 'support': 272450}}
[[41704 15992 28579]
 [37563 19161 39600]
 [29546 14880 45425]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0923764
{'0': {'precision': 0.4024416409200137, 'recall': 0.5274153638510853, 'f1-score': 0.4565302049359879, 'support': 35564}, '1': {'precision': 0.40056538031687594, 'recall': 0.1798990227051286, 'f1-score': 0.24828850855745718, 'support': 33869}, '2': {'precision': 0.39168892264719574, 'recall': 0.48152052772673876, 'f1-score': 0.4319840025941739, 'support': 33199}, 'accuracy': 0.39788759840985266, 'macro avg': {'precision': 0.3982319812946951, 'recall': 0.3962783047609842, 'f1-score': 0.37893423869587295, 'support': 102632}, 'weighted avg': {'precision': 0.3983442194110598, 'recall': 0.39788759840985266, 'f1-score': 0.37986944234546705, 'support': 102632}}
[[18757  4737 12070]
 [15019  6093 12757]
 [12832  4381 15986]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0995805
{'0': {'precision': 0.38592524553098284, 'recall': 0.5392437555533617, 'f1-score': 0.44988056996952475, 'support': 10129}, '1': {'precision': 0.34285123111938753, 'recall': 0.15791480034308586, 'f1-score': 0.2162338509722041, 'support': 10493}, '2': {'precision': 0.40137152077450583, 'recall': 0.4624035691049354, 'f1-score': 0.4297313639112033, 'support': 10759}, 'accuracy': 0.38539243491284536, 'macro avg': {'precision': 0.3767159991416254, 'recall': 0.38652070833379426, 'f1-score': 0.3652819282843107, 'support': 31381}, 'weighted avg': {'precision': 0.37681816934233986, 'recall': 0.38539243491284536, 'f1-score': 0.36484694037134857, 'support': 31381}}
[[5462 1472 3195]
 [4611 1657 4225]
 [4080 1704 4975]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1171108
{'0': {'precision': 0.30263921700978735, 'recall': 0.6107559301100658, 'f1-score': 0.40472887786941725, 'support': 110116}, '1': {'precision': 0.5361235499453475, 'recall': 0.07776419624911138, 'f1-score': 0.13582684199242478, 'support': 195527}, '2': {'precision': 0.33221437191699765, 'recall': 0.4903880245942043, 'f1-score': 0.3960940310340131, 'support': 115637}, 'accuracy': 0.33034086593239653, 'macro avg': {'precision': 0.39032571295737756, 'recall': 0.39296938365112716, 'f1-score': 0.3122165836319517, 'support': 421280}, 'weighted avg': {'precision': 0.41912343974501415, 'recall': 0.33034086593239653, 'f1-score': 0.2775542762922564, 'support': 421280}}
[[ 67254   6602  36260]
 [102595  15205  77727]
 [ 52376   6554  56707]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.095236
{'0': {'precision': 0.38736838864601936, 'recall': 0.5559114606344437, 'f1-score': 0.4565824805863996, 'support': 45268}, '1': {'precision': 0.3724454192004785, 'recall': 0.08416878815869511, 'f1-score': 0.1373075085449667, 'support': 44387}, '2': {'precision': 0.3972048855781491, 'recall': 0.5267666429334282, 'f1-score': 0.4529020162987336, 'support': 44944}, 'accuracy': 0.39061211450307953, 'macro avg': {'precision': 0.3856728978082156, 'recall': 0.3889489639088557, 'f1-score': 0.34893066847669996, 'support': 134599}, 'weighted avg': {'precision': 0.3857317172988208, 'recall': 0.39061211450307953, 'f1-score': 0.3500655453123787, 'support': 134599}}
[[25165  3400 16703]
 [21425  3736 19226]
 [18374  2895 23675]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950506
{'0': {'precision': 0.37820865924865044, 'recall': 0.5611310885910428, 'f1-score': 0.45185916419874955, 'support': 12236}, '1': {'precision': 0.4184566428003182, 'recall': 0.08481135117703967, 'f1-score': 0.14103767261026948, 'support': 12404}, '2': {'precision': 0.39793715519309186, 'recall': 0.5223551637279596, 'f1-score': 0.4517358747447243, 'support': 12704}, 'accuracy': 0.3897279348757498, 'macro avg': {'precision': 0.3982008190806869, 'recall': 0.38943253449868065, 'f1-score': 0.3482109038512478, 'support': 37344}, 'weighted avg': {'precision': 0.3982886399805771, 'recall': 0.38972793487574975, 'f1-score': 0.34857627937421437, 'support': 37344}}
[[6866  761 4609]
 [5921 1052 5431]
 [5367  701 6636]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/EXC
Evaluating performance on  test set...
5928/5928 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99541223
{'0': {'precision': 0.32302134619275646, 'recall': 0.5549512622568544, 'f1-score': 0.408352383845166, 'support': 276172}, '1': {'precision': 0.7436984884953171, 'recall': 0.3583832895538002, 'f1-score': 0.48368300075688614, 'support': 967347}, '2': {'precision': 0.3099666173264049, 'recall': 0.6525621330491992, 'f1-score': 0.4202938912684563, 'support': 274049}, 'accuracy': 0.44727946293016196, 'macro avg': {'precision': 0.4588954840048261, 'recall': 0.5219655616199512, 'f1-score': 0.4374430919568361, 'support': 1517568}, 'weighted avg': {'precision': 0.5888171037363132, 'recall': 0.44727946293016196, 'f1-score': 0.45852700827421766, 'support': 1517568}}
[[153262  68262  54648]
 [277202 346681 343464]
 [ 44000  51215 178834]]
Evaluating performance on  train set...
1254/1254 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9974342
{'0': {'precision': 0.3412396717258558, 'recall': 0.5635370140135991, 'f1-score': 0.4250798870004168, 'support': 65151}, '1': {'precision': 0.733492709099563, 'recall': 0.3567437602592702, 'f1-score': 0.4800223704144191, 'support': 190072}, '2': {'precision': 0.3339645577156844, 'recall': 0.6143011423269398, 'f1-score': 0.43269478014913854, 'support': 65743}, 'accuracy': 0.45147461101798947, 'macro avg': {'precision': 0.4695656461803677, 'recall': 0.5115273055332697, 'f1-score': 0.4459323458546582, 'support': 320966}, 'weighted avg': {'precision': 0.572036801326264, 'recall': 0.45147461101798947, 'f1-score': 0.4591758773163464, 'support': 320966}}
[[36715 13812 14624]
 [56346 67807 65919]
 [14532 10825 40386]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9944328
{'0': {'precision': 0.32351447435246317, 'recall': 0.5677894539313192, 'f1-score': 0.4121783847293408, 'support': 21316}, '1': {'precision': 0.7401260893751159, 'recall': 0.3607537733859549, 'f1-score': 0.48507251073482943, 'support': 66386}, '2': {'precision': 0.33122052634247756, 'recall': 0.6073736575387048, 'f1-score': 0.42867221210480555, 'support': 21509}, 'accuracy': 0.449734916812409, 'macro avg': {'precision': 0.46495369669001896, 'recall': 0.5119722949519929, 'f1-score': 0.44197436918965866, 'support': 109211}, 'weighted avg': {'precision': 0.5782775307034448, 'recall': 0.449734916812409, 'f1-score': 0.4597369198770754, 'support': 109211}}
[[12103  4764  4449]
 [20508 23949 21929]
 [ 4800  3645 13064]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/AAL
Evaluating performance on  test set...
5331/5331 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0418375
{'0': {'precision': 0.2726248315845344, 'recall': 0.560636082751209, 'f1-score': 0.36685584313553127, 'support': 238208}, '1': {'precision': 0.7746230977649412, 'recall': 0.2840350647178231, 'f1-score': 0.4156584807122153, 'support': 884764}, '2': {'precision': 0.26972307021369385, 'recall': 0.6143054020833592, 'f1-score': 0.37485747188265905, 'support': 241629}, 'accuracy': 0.39079994811670227, 'macro avg': {'precision': 0.4389903331877232, 'recall': 0.48632551651746375, 'f1-score': 0.3857905985768018, 'support': 1364601}, 'weighted avg': {'precision': 0.5975907698189097, 'recall': 0.39079994811670227, 'f1-score': 0.3999147683344993, 'support': 1364601}}
[[133548  39956  64704]
 [296278 251304 337182]
 [ 60034  33161 148434]]
Evaluating performance on  train set...
2013/2013 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0564144
{'0': {'precision': 0.30562028822255866, 'recall': 0.563852504337547, 'f1-score': 0.3963890908725359, 'support': 104898}, '1': {'precision': 0.7326278831618471, 'recall': 0.2442092943872824, 'f1-score': 0.36631394158092356, 'support': 307605}, '2': {'precision': 0.28876046778931236, 'recall': 0.6158043712976743, 'f1-score': 0.3931613315903381, 'support': 102807}, 'accuracy': 0.3834119268013429, 'macro avg': {'precision': 0.44233621305790605, 'recall': 0.47462205667416785, 'f1-score': 0.3852881213479325, 'support': 515310}, 'weighted avg': {'precision': 0.5571511408782787, 'recall': 0.3834119268013429, 'f1-score': 0.37779231893647547, 'support': 515310}}
[[ 59147  15153  30598]
 [107148  75120 125337]
 [ 27236  12262  63309]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0589895
{'0': {'precision': 0.29331529524112687, 'recall': 0.5406618553071643, 'f1-score': 0.3803087209542284, 'support': 34086}, '1': {'precision': 0.7230256129654238, 'recall': 0.2516710654005569, 'f1-score': 0.3733769291836543, 'support': 110259}, '2': {'precision': 0.27335766423357666, 'recall': 0.6244640304907099, 'f1-score': 0.380258195532347, 'support': 33584}, 'accuracy': 0.37739772605927085, 'macro avg': {'precision': 0.4298995241467091, 'recall': 0.47226565039947704, 'f1-score': 0.37798128189007657, 'support': 177929}, 'weighted avg': {'precision': 0.5558310899806336, 'recall': 0.37739772605927085, 'f1-score': 0.37600369324879424, 'support': 177929}}
[[18429  5761  9896]
 [36658 27749 45852]
 [ 7743  4869 20972]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/WBA
Evaluating performance on  test set...
4192/4192 - 51s - 51s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0571665
{'0': {'precision': 0.3938197122841784, 'recall': 0.5323452833967555, 'f1-score': 0.45272293235183747, 'support': 319552}, '1': {'precision': 0.5415790329432868, 'recall': 0.23492180496971848, 'f1-score': 0.32769758315971204, 'support': 439542}, '2': {'precision': 0.3859321243868333, 'recall': 0.5536489296324483, 'f1-score': 0.45482166049117106, 'support': 314051}, 'accuracy': 0.41676008367927914, 'macro avg': {'precision': 0.44044362320476615, 'recall': 0.4403053393329741, 'f1-score': 0.4117473920009069, 'support': 1073145}, 'weighted avg': {'precision': 0.45203115850476994, 'recall': 0.41676008367927914, 'f1-score': 0.40212885199576315, 'support': 1073145}}
[[170112  46918 102522]
 [162150 103258 174134]
 [ 99692  40485 173874]]
Evaluating performance on  train set...
1230/1230 - 15s - 15s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0573888
{'0': {'precision': 0.4278651153151553, 'recall': 0.5449317986859346, 'f1-score': 0.47935453644621895, 'support': 106083}, '1': {'precision': 0.48054632042411716, 'recall': 0.20559544060971274, 'f1-score': 0.2879816915154983, 'support': 104049}, '2': {'precision': 0.4221512388811251, 'recall': 0.5451186327397718, 'f1-score': 0.4758186167065314, 'support': 104735}, 'accuracy': 0.43285895314529627, 'macro avg': {'precision': 0.4435208915401325, 'recall': 0.4318819573451396, 'f1-score': 0.41438494822274957, 'support': 314867}, 'weighted avg': {'precision': 0.44337319924285884, 'recall': 0.43285895314529627, 'f1-score': 0.4149384887304128, 'support': 314867}}
[[57808 12366 35909]
 [40416 21392 42241]
 [36884 10758 57093]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0605011
{'0': {'precision': 0.41104742514439996, 'recall': 0.5458125183661475, 'f1-score': 0.4689397477814106, 'support': 34030}, '1': {'precision': 0.5021350510241007, 'recall': 0.20488438708915335, 'f1-score': 0.2910234899328859, 'support': 33863}, '2': {'precision': 0.4221456488055318, 'recall': 0.5313809967396367, 'f1-score': 0.4705063601098037, 'support': 34352}, 'accuracy': 0.42805027140691476, 'macro avg': {'precision': 0.4451093749913442, 'recall': 0.42735930073164585, 'f1-score': 0.4101565326080334, 'support': 102245}, 'weighted avg': {'precision': 0.44494391352399315, 'recall': 0.42805027140691476, 'f1-score': 0.41054117598993295, 'support': 102245}}
[[18574  3555 11901]
 [13839  6938 13086]
 [12774  3324 18254]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
6143/6143 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0536845
{'0': {'precision': 0.39990311383967064, 'recall': 0.551747931077743, 'f1-score': 0.46371139268119765, 'support': 462318}, '1': {'precision': 0.5378552302718418, 'recall': 0.2395469252698491, 'f1-score': 0.3314669652855543, 'support': 654903}, '2': {'precision': 0.3935824735052678, 'recall': 0.5558320667023959, 'f1-score': 0.46084349965490057, 'support': 455276}, 'accuracy': 0.42290700713578466, 'macro avg': {'precision': 0.44378027253892677, 'recall': 0.44904230768332937, 'f1-score': 0.4186739525405508, 'support': 1572497}, 'weighted avg': {'precision': 0.4555265071173002, 'recall': 0.42290700713578466, 'f1-score': 0.4078047962933321, 'support': 1572497}}
[[255083  71800 135435]
 [243557 156880 254466]
 [139222  62997 253057]]
Evaluating performance on  train set...
2083/2083 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0616223
{'0': {'precision': 0.4235618104111157, 'recall': 0.5343470119791549, 'f1-score': 0.47254808075971594, 'support': 177308}, '1': {'precision': 0.4952692867540029, 'recall': 0.21835996282198814, 'f1-score': 0.3030901076622997, 'support': 180752}, '2': {'precision': 0.41079011486251304, 'recall': 0.5390394848021193, 'f1-score': 0.46625645685389483, 'support': 175156}, 'accuracy': 0.42877370521514735, 'macro avg': {'precision': 0.4432070706758772, 'recall': 0.43058215320108745, 'f1-score': 0.41396488175863677, 'support': 533216}, 'weighted avg': {'precision': 0.4436741676142351, 'recall': 0.42877370521514735, 'f1-score': 0.4130377074210461, 'support': 533216}}
[[94744 20781 61783]
 [67642 39469 73641]
 [61298 19442 94416]]
Evaluating performance on  val set...
685/685 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.067325
{'0': {'precision': 0.40661577608142496, 'recall': 0.5480977257136826, 'f1-score': 0.4668734268248832, 'support': 56853}, '1': {'precision': 0.504172738111008, 'recall': 0.1858791736532795, 'f1-score': 0.2716178604562647, 'support': 61427}, '2': {'precision': 0.40231384485643884, 'recall': 0.5366565306804001, 'f1-score': 0.459874683696831, 'support': 56893}, 'accuracy': 0.4173645481895041, 'macro avg': {'precision': 0.4377007863496239, 'recall': 0.4235444766824541, 'f1-score': 0.3994553236593263, 'support': 175173}, 'weighted avg': {'precision': 0.4394283769583185, 'recall': 0.4173645481895041, 'f1-score': 0.3961311139792425, 'support': 175173}}
[[31161  5826 19866]
 [24516 11418 25493]
 [20958  5403 30532]]
testing model on single stock: results/universal/W7/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
23942/23942 - 278s - 278s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0987349
{'0': {'precision': 0.3645725911274371, 'recall': 0.4191328654754343, 'f1-score': 0.3899535303873161, 'support': 1923946}, '1': {'precision': 0.40732525573556316, 'recall': 0.2560452968348301, 'f1-score': 0.3144357723116396, 'support': 2296496}, '2': {'precision': 0.3605861571157538, 'recall': 0.4673263415342104, 'f1-score': 0.4070754092674489, 'support': 1908617}, 'accuracy': 0.3730332829232024, 'macro avg': {'precision': 0.37749466799291803, 'recall': 0.3808348346148249, 'f1-score': 0.37048823732213493, 'support': 6129059}, 'weighted avg': {'precision': 0.37935018545926297, 'recall': 0.3730332829232024, 'f1-score': 0.3669896267526478, 'support': 6129059}}
[[806389 441543 676014]
 [802847 588007 905642]
 [602639 414031 891947]]
Evaluating performance on  train set...
9052/9052 - 108s - 108s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0931237
{'0': {'precision': 0.3904577483728686, 'recall': 0.43258656226640463, 'f1-score': 0.4104439406128867, 'support': 771901}, '1': {'precision': 0.3584003458252059, 'recall': 0.2600696011241083, 'f1-score': 0.30141815440271535, 'support': 777861}, '2': {'precision': 0.39498130804673265, 'recall': 0.46196612608104093, 'f1-score': 0.4258557234341746, 'support': 767316}, 'accuracy': 0.38440052514416867, 'macro avg': {'precision': 0.381279800748269, 'recall': 0.38487409649051796, 'f1-score': 0.37923927281659225, 'support': 2317078}, 'weighted avg': {'precision': 0.3811938377542288, 'recall': 0.38440052514416867, 'f1-score': 0.3789468569843119, 'support': 2317078}}
[[333914 187162 250825]
 [283417 202298 292146]
 [237855 174987 354474]]
Evaluating performance on  val set...
2763/2763 - 34s - 34s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0966623
{'0': {'precision': 0.3831934426946472, 'recall': 0.4498337847030586, 'f1-score': 0.413848073463829, 'support': 233733}, '1': {'precision': 0.36141774791042275, 'recall': 0.24557815958680299, 'f1-score': 0.29244449353805363, 'support': 237175}, '2': {'precision': 0.3946411750853644, 'recall': 0.4536856086562947, 'f1-score': 0.4221086146301916, 'support': 236406}, 'accuracy': 0.38263062798134917, 'macro avg': {'precision': 0.3797507885634781, 'recall': 0.38303251764871876, 'f1-score': 0.37613372721069144, 'support': 707314}, 'weighted avg': {'precision': 0.379717846584732, 'recall': 0.38263062798134917, 'f1-score': 0.37590021356861886, 'support': 707314}}
[[105141  52466  76126]
 [ 90534  58245  88396]
 [ 78706  50446 107254]]
training model: results/universal/W7/deepLOB_L2/h10
Epoch 1/50
12475/12475 - 565s - loss: 2.9329 - accuracy10: 0.4995 - val_loss: 3.5926 - val_accuracy10: 0.4299 - 565s/epoch - 45ms/step
Epoch 2/50
12475/12475 - 557s - loss: 2.8343 - accuracy10: 0.5283 - val_loss: 3.4060 - val_accuracy10: 0.4342 - 557s/epoch - 45ms/step
Epoch 3/50
12475/12475 - 559s - loss: 2.7913 - accuracy10: 0.5392 - val_loss: 3.4139 - val_accuracy10: 0.4440 - 559s/epoch - 45ms/step
Epoch 4/50
12475/12475 - 568s - loss: 2.7675 - accuracy10: 0.5453 - val_loss: 3.4179 - val_accuracy10: 0.4550 - 568s/epoch - 45ms/step
Epoch 5/50
12475/12475 - 561s - loss: 2.7512 - accuracy10: 0.5490 - val_loss: 3.3613 - val_accuracy10: 0.4655 - 561s/epoch - 45ms/step
Epoch 6/50
12475/12475 - 559s - loss: 2.7389 - accuracy10: 0.5520 - val_loss: 3.3148 - val_accuracy10: 0.4679 - 559s/epoch - 45ms/step
Epoch 7/50
12475/12475 - 560s - loss: 2.7291 - accuracy10: 0.5544 - val_loss: 3.2274 - val_accuracy10: 0.4753 - 560s/epoch - 45ms/step
Epoch 8/50
12475/12475 - 561s - loss: 2.7216 - accuracy10: 0.5561 - val_loss: 3.2596 - val_accuracy10: 0.4770 - 561s/epoch - 45ms/step
Epoch 9/50
12475/12475 - 560s - loss: 2.7154 - accuracy10: 0.5574 - val_loss: 3.2529 - val_accuracy10: 0.4788 - 560s/epoch - 45ms/step
Epoch 10/50
12475/12475 - 562s - loss: 2.7096 - accuracy10: 0.5589 - val_loss: 3.2994 - val_accuracy10: 0.4770 - 562s/epoch - 45ms/step
Epoch 11/50
12475/12475 - 560s - loss: 2.7058 - accuracy10: 0.5597 - val_loss: 3.2563 - val_accuracy10: 0.4783 - 560s/epoch - 45ms/step
Epoch 12/50
12475/12475 - 560s - loss: 2.7013 - accuracy10: 0.5607 - val_loss: 3.2509 - val_accuracy10: 0.4717 - 560s/epoch - 45ms/step
Epoch 13/50
12475/12475 - 564s - loss: 2.6973 - accuracy10: 0.5615 - val_loss: 3.1830 - val_accuracy10: 0.4804 - 564s/epoch - 45ms/step
Epoch 14/50
12475/12475 - 562s - loss: 2.6943 - accuracy10: 0.5624 - val_loss: 3.2204 - val_accuracy10: 0.4743 - 562s/epoch - 45ms/step
Epoch 15/50
12475/12475 - 561s - loss: 2.6912 - accuracy10: 0.5631 - val_loss: 3.2070 - val_accuracy10: 0.4833 - 561s/epoch - 45ms/step
Epoch 16/50
12475/12475 - 560s - loss: 2.6883 - accuracy10: 0.5639 - val_loss: 3.1911 - val_accuracy10: 0.4821 - 560s/epoch - 45ms/step
Epoch 17/50
12475/12475 - 562s - loss: 2.6858 - accuracy10: 0.5645 - val_loss: 3.2112 - val_accuracy10: 0.4835 - 562s/epoch - 45ms/step
Epoch 18/50
12475/12475 - 562s - loss: 2.6831 - accuracy10: 0.5651 - val_loss: 3.1898 - val_accuracy10: 0.4847 - 562s/epoch - 45ms/step
Epoch 19/50
12475/12475 - 561s - loss: 2.6812 - accuracy10: 0.5656 - val_loss: 3.1389 - val_accuracy10: 0.4884 - 561s/epoch - 45ms/step
Epoch 20/50
12475/12475 - 560s - loss: 2.6789 - accuracy10: 0.5662 - val_loss: 3.1225 - val_accuracy10: 0.4914 - 560s/epoch - 45ms/step
Epoch 21/50
12475/12475 - 559s - loss: 2.6766 - accuracy10: 0.5666 - val_loss: 3.1285 - val_accuracy10: 0.4926 - 559s/epoch - 45ms/step
Epoch 22/50
12475/12475 - 560s - loss: 2.6746 - accuracy10: 0.5669 - val_loss: 3.1439 - val_accuracy10: 0.4862 - 560s/epoch - 45ms/step
Epoch 23/50
12475/12475 - 560s - loss: 2.6732 - accuracy10: 0.5674 - val_loss: 3.1841 - val_accuracy10: 0.4849 - 560s/epoch - 45ms/step
Epoch 24/50
12475/12475 - 561s - loss: 2.6713 - accuracy10: 0.5679 - val_loss: 3.1291 - val_accuracy10: 0.4876 - 561s/epoch - 45ms/step
Epoch 25/50
12475/12475 - 562s - loss: 2.6694 - accuracy10: 0.5682 - val_loss: 3.2626 - val_accuracy10: 0.4741 - 562s/epoch - 45ms/step
Epoch 26/50
12475/12475 - 563s - loss: 2.6677 - accuracy10: 0.5685 - val_loss: 3.1457 - val_accuracy10: 0.4863 - 563s/epoch - 45ms/step
Epoch 27/50
12475/12475 - 562s - loss: 2.6661 - accuracy10: 0.5688 - val_loss: 3.1866 - val_accuracy10: 0.4853 - 562s/epoch - 45ms/step
Epoch 28/50
12475/12475 - 564s - loss: 2.6647 - accuracy10: 0.5691 - val_loss: 3.2447 - val_accuracy10: 0.4844 - 564s/epoch - 45ms/step
Epoch 29/50
12475/12475 - 568s - loss: 2.6633 - accuracy10: 0.5695 - val_loss: 3.1354 - val_accuracy10: 0.4862 - 568s/epoch - 45ms/step
Epoch 30/50
12475/12475 - 564s - loss: 2.6627 - accuracy10: 0.5697 - val_loss: 3.1937 - val_accuracy10: 0.4880 - 564s/epoch - 45ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 645s - 645s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9780167
{'0': {'precision': 0.41336553586347424, 'recall': 0.506543239507726, 'f1-score': 0.45523539560243803, 'support': 2416540}, '1': {'precision': 0.5724701470005734, 'recall': 0.6607408439933348, 'f1-score': 0.6134463783610826, 'support': 4691838}, '2': {'precision': 0.48652514682970943, 'recall': 0.22914332340227783, 'f1-score': 0.3115520487501783, 'support': 2397194}, 'accuracy': 0.5126963427345561, 'macro avg': {'precision': 0.4907869432312524, 'recall': 0.4654758023011129, 'f1-score': 0.46007794090456633, 'support': 9505572}, 'weighted avg': {'precision': 0.5103476891688049, 'recall': 0.5126963427345561, 'f1-score': 0.4970912085877268, 'support': 9505572}}
[[1224082 1000399  192059]
 [1204080 3100089  387669]
 [ 533096 1314797  549301]]
Evaluating performance on  train set...
12475/12475 - 224s - 224s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.994052
{'0': {'precision': 0.44564393518944306, 'recall': 0.590473509161542, 'f1-score': 0.5079365079365079, 'support': 951914}, '1': {'precision': 0.5473762663571127, 'recall': 0.5757275611478184, 'f1-score': 0.5611940679787157, 'support': 1297348}, '2': {'precision': 0.5086573447283804, 'recall': 0.30571760353117433, 'f1-score': 0.3819014933630515, 'support': 943822}, 'accuracy': 0.5003131768534745, 'macro avg': {'precision': 0.5005591820916454, 'recall': 0.49063955794684494, 'f1-score': 0.4836773564260917, 'support': 3193084}, 'weighted avg': {'precision': 0.5056034221912171, 'recall': 0.5003131768534745, 'f1-score': 0.49232118728753327, 'support': 3193084}}
[[562080 267786 122048]
 [393756 746919 156673]
 [305440 349839 288543]]
Evaluating performance on  val set...
3866/3866 - 69s - 69s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0150357
{'0': {'precision': 0.432454369894617, 'recall': 0.5562250825036259, 'f1-score': 0.4865924278899566, 'support': 285442}, '1': {'precision': 0.5310332408080131, 'recall': 0.6164277905258478, 'f1-score': 0.5705529658755293, 'support': 416185}, '2': {'precision': 0.50946356348144, 'recall': 0.24616882552377642, 'f1-score': 0.33194460400113474, 'support': 287575}, 'accuracy': 0.49141631335157027, 'macro avg': {'precision': 0.4909837247280233, 'recall': 0.47294056618441677, 'f1-score': 0.46302999925554017, 'support': 989202}, 'weighted avg': {'precision': 0.49631692399056737, 'recall': 0.4914163133515702, 'f1-score': 0.47695867113117285, 'support': 989202}}
[[158770  96787  29885]
 [121360 256548  38277]
 [ 87007 129776  70792]]
testing model out of sample: results/universal/W7/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 259s - 259s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8277332
{'0': {'precision': 0.3612410656515022, 'recall': 0.6717041489899591, 'f1-score': 0.46981605441270546, 'support': 713981}, '1': {'precision': 0.7950950900568537, 'recall': 0.6332686098495979, 'f1-score': 0.7050147835758093, 'support': 2344847}, '2': {'precision': 0.5070657251456232, 'recall': 0.41041242099201325, 'f1-score': 0.4536480192692606, 'support': 715434}, 'accuracy': 0.5982957727894884, 'macro avg': {'precision': 0.5544672936179931, 'recall': 0.5717950599438567, 'f1-score': 0.5428262857525917, 'support': 3774262}, 'weighted avg': {'precision': 0.65842478713277, 'recall': 0.5982957727894884, 'f1-score': 0.6128739217327541, 'support': 3774262}}
[[ 479584  144495   89902]
 [ 664391 1484918  195538]
 [ 183626  238185  293623]]
Evaluating performance on  train set...
5285/5285 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8444971
{'0': {'precision': 0.41307108592147834, 'recall': 0.6251082309878476, 'f1-score': 0.49743648633130466, 'support': 294509}, '1': {'precision': 0.7650786564978517, 'recall': 0.6614163064948272, 'f1-score': 0.7094809477591276, 'support': 766995}, '2': {'precision': 0.49753369388282276, 'recall': 0.41677944096008135, 'f1-score': 0.45359036612968645, 'support': 291142}, 'accuracy': 0.600855656247089, 'macro avg': {'precision': 0.5585611454340509, 'recall': 0.567767992814252, 'f1-score': 0.5535026000733729, 'support': 1352646}, 'weighted avg': {'precision': 0.6308506521947731, 'recall': 0.600855656247089, 'f1-score': 0.608235316598125, 'support': 1352646}}
[[184100  65634  44775]
 [181922 507303  77770]
 [ 79664  90136 121342]]
Evaluating performance on  val set...
1714/1714 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8257186
{'0': {'precision': 0.39947180448555675, 'recall': 0.6458842660707766, 'f1-score': 0.49363572953435775, 'support': 90397}, '1': {'precision': 0.7766611060974832, 'recall': 0.6620394113167669, 'f1-score': 0.7147842865831918, 'support': 257388}, '2': {'precision': 0.511976708888705, 'recall': 0.4111402896430985, 'f1-score': 0.4560510806708332, 'support': 90249}, 'accuracy': 0.6070122410589133, 'macro avg': {'precision': 0.5627032064905816, 'recall': 0.5730213223435473, 'f1-score': 0.5548236989294609, 'support': 438034}, 'weighted avg': {'precision': 0.6442871728833757, 'recall': 0.6070122410589133, 'f1-score': 0.6158385901031745, 'support': 438034}}
[[ 58386  19589  12422]
 [ 64040 170401  22947]
 [ 23732  29412  37105]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0334002
{'0': {'precision': 0.4002402892538565, 'recall': 0.6684334065268418, 'f1-score': 0.5006841303037821, 'support': 52828}, '1': {'precision': 0.6100287448099648, 'recall': 0.2888488664641104, 'f1-score': 0.3920580716191755, 'support': 72737}, '2': {'precision': 0.46727957144925436, 'recall': 0.49313394067877536, 'f1-score': 0.47985875574966314, 'support': 52359}, 'accuracy': 0.46166902722510733, 'macro avg': {'precision': 0.4925162018376919, 'recall': 0.48347207122324254, 'f1-score': 0.45753365255754025, 'support': 177924}, 'weighted avg': {'precision': 0.505731918647606, 'recall': 0.46166902722510733, 'f1-score': 0.4501483430192036, 'support': 177924}}
[[35312  6164 11352]
 [33643 21010 18084]
 [19272  7267 25820]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0437597
{'0': {'precision': 0.4317948115286306, 'recall': 0.6291793313069909, 'f1-score': 0.5121262805770437, 'support': 23359}, '1': {'precision': 0.5162921348314606, 'recall': 0.28673946957878316, 'f1-score': 0.3687061183550652, 'support': 25640}, '2': {'precision': 0.46675660862599605, 'recall': 0.48141061877636215, 'f1-score': 0.4739703741758712, 'support': 22997}, 'accuracy': 0.4600255569753875, 'macro avg': {'precision': 0.4716145183286957, 'recall': 0.4657764732207121, 'f1-score': 0.4516009243693267, 'support': 71996}, 'weighted avg': {'precision': 0.47305443452619533, 'recall': 0.4600255569753875, 'f1-score': 0.4488621500853595, 'support': 71996}}
[[14697  3298  5364]
 [11004  7352  7284]
 [ 8336  3590 11071]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0506105
{'0': {'precision': 0.4235217106698669, 'recall': 0.6614414721417619, 'f1-score': 0.5163950781509811, 'support': 5869}, '1': {'precision': 0.5142927550517497, 'recall': 0.3240180096258345, 'f1-score': 0.39756167254024194, 'support': 6441}, '2': {'precision': 0.48902346707040123, 'recall': 0.4169086802194256, 'f1-score': 0.45009580212506534, 'support': 6198}, 'accuracy': 0.4621244867084504, 'macro avg': {'precision': 0.4756126442640059, 'recall': 0.467456053995674, 'f1-score': 0.4546841842720961, 'support': 18508}, 'weighted avg': {'precision': 0.47704646661509165, 'recall': 0.4621244867084504, 'f1-score': 0.4528372178555739, 'support': 18508}}
[[3882  811 1176]
 [2830 2087 1524]
 [2454 1160 2584]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
2006/2006 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70511556
{'0': {'precision': 0.23282074999036498, 'recall': 0.7501396965996813, 'f1-score': 0.3553511992588272, 'support': 48319}, '1': {'precision': 0.9155126401086904, 'recall': 0.6787548115549267, 'f1-score': 0.7795537804710095, 'support': 416965}, '2': {'precision': 0.47958279224125494, 'recall': 0.4842442659118345, 'f1-score': 0.4819022566513738, 'support': 48046}, 'accuracy': 0.6672686186273937, 'macro avg': {'precision': 0.5426387274467701, 'recall': 0.6377129246888141, 'f1-score': 0.5389357454604035, 'support': 513330}, 'weighted avg': {'precision': 0.8104502535167005, 'recall': 0.6672686186273937, 'f1-score': 0.7117650098263373, 'support': 513330}}
[[ 36246   8478   3595]
 [112296 283017  21652]
 [  7140  17640  23266]]
Evaluating performance on  train set...
538/538 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.701077
{'0': {'precision': 0.2770558270090446, 'recall': 0.7401235853641602, 'f1-score': 0.40318462905879465, 'support': 14403}, '1': {'precision': 0.9169269509212852, 'recall': 0.6937549233333944, 'f1-score': 0.7898798598364758, 'support': 109174}, '2': {'precision': 0.43331915669238713, 'recall': 0.5108882521489971, 'f1-score': 0.4689174529077221, 'support': 13960}, 'accuracy': 0.680049732072097, 'macro avg': {'precision': 0.5424339782075723, 'recall': 0.6482555869488507, 'f1-score': 0.5539939806009975, 'support': 137537}, 'weighted avg': {'precision': 0.8008328918306884, 'recall': 0.680049732072097, 'f1-score': 0.7168071113424971, 'support': 137537}}
[[10660  2396  1347]
 [25454 75740  7980]
 [ 2362  4466  7132]]
Evaluating performance on  val set...
153/153 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7091602
{'0': {'precision': 0.2831407205982325, 'recall': 0.7633447880870561, 'f1-score': 0.41306638566912535, 'support': 4365}, '1': {'precision': 0.9064878111698698, 'recall': 0.6960942916570372, 'f1-score': 0.7874803914245163, 'support': 30289}, '2': {'precision': 0.513547104151131, 'recall': 0.4699727024567789, 'f1-score': 0.4907946311913529, 'support': 4396}, 'accuracy': 0.678156209987196, 'macro avg': {'precision': 0.5677252119730778, 'recall': 0.643137260733624, 'f1-score': 0.5637804694283315, 'support': 39050}, 'weighted avg': {'precision': 0.792575457817768, 'recall': 0.678156209987196, 'f1-score': 0.7122294890658155, 'support': 39050}}
[[ 3332   660   373]
 [ 7621 21084  1584]
 [  815  1515  2066]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
930/930 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0224131
{'0': {'precision': 0.4136930332015961, 'recall': 0.6213046594982079, 'f1-score': 0.4966762939531472, 'support': 69750}, '1': {'precision': 0.5792432432432433, 'recall': 0.4189952871501856, 'f1-score': 0.48625690482384754, 'support': 95908}, '2': {'precision': 0.48092954744891564, 'recall': 0.42457149971640823, 'f1-score': 0.4509966716383915, 'support': 72287}, 'accuracy': 0.4799932757570027, 'macro avg': {'precision': 0.491288607964585, 'recall': 0.4882904821216006, 'f1-score': 0.4779766234717954, 'support': 237945}, 'weighted avg': {'precision': 0.5008472724168361, 'recall': 0.4799932757570027, 'f1-score': 0.4785992356796823, 'support': 237945}}
[[43336 12881 13533]
 [36131 40185 19592]
 [25287 16309 30691]]
Evaluating performance on  train set...
381/381 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0076058
{'0': {'precision': 0.46996556561663055, 'recall': 0.5862979698338955, 'f1-score': 0.521725587914655, 'support': 31426}, '1': {'precision': 0.5268049246951948, 'recall': 0.5042620137299771, 'f1-score': 0.5152870337893137, 'support': 34960}, '2': {'precision': 0.5107838403347819, 'recall': 0.4077083667897864, 'f1-score': 0.45346241091682, 'support': 31135}, 'accuracy': 0.4998718224792609, 'macro avg': {'precision': 0.5025181102155357, 'recall': 0.49942278345121965, 'f1-score': 0.49682501087359615, 'support': 97521}, 'weighted avg': {'precision': 0.5033735595536928, 'recall': 0.4998718224792609, 'f1-score': 0.49762343691077354, 'support': 97521}}
[[18425  7149  5852]
 [11025 17629  6306]
 [ 9755  8686 12694]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0273931
{'0': {'precision': 0.47386496900653374, 'recall': 0.5799077396207073, 'f1-score': 0.5215507306504402, 'support': 9755}, '1': {'precision': 0.4888817618131281, 'recall': 0.4692662904053361, 'f1-score': 0.4788732394366197, 'support': 9745}, '2': {'precision': 0.5102119460500963, 'recall': 0.4147436566774564, 'f1-score': 0.45755097339016243, 'support': 9577}, 'accuracy': 0.4884272792929119, 'macro avg': {'precision': 0.4909862256232527, 'recall': 0.4879725622344999, 'f1-score': 0.4859916478257407, 'support': 29077}, 'weighted avg': {'precision': 0.4908692557295953, 'recall': 0.4884272792929119, 'f1-score': 0.4861682005696079, 'support': 29077}}
[[5657 2231 1867]
 [3226 4573 1946]
 [3055 2550 3972]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1888711
{'0': {'precision': 0.3499875301355059, 'recall': 0.6206059781376151, 'f1-score': 0.4475701756179339, 'support': 88188}, '1': {'precision': 0.38786740034894646, 'recall': 0.029943532093456977, 'f1-score': 0.05559509839755305, 'support': 96515}, '2': {'precision': 0.36231323704051477, 'recall': 0.44850259823137933, 'f1-score': 0.400826972334109, 'support': 87752}, 'accuracy': 0.35593767778165203, 'macro avg': {'precision': 0.36672272250832244, 'recall': 0.3663507028208171, 'f1-score': 0.30133074878319865, 'support': 272455}, 'weighted avg': {'precision': 0.3673760203668415, 'recall': 0.35593767778165203, 'f1-score': 0.2936611478794551, 'support': 272455}}
[[54730  2589 30869]
 [55224  2890 38401]
 [46423  1972 39357]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1691592
{'0': {'precision': 0.3794649184975195, 'recall': 0.6053933346524578, 'f1-score': 0.46651491553851687, 'support': 35377}, '1': {'precision': 0.412858249419055, 'recall': 0.047168141592920355, 'f1-score': 0.08466364863791596, 'support': 33900}, '2': {'precision': 0.3704010019140339, 'recall': 0.4699445360515665, 'f1-score': 0.41427703041995934, 'support': 33355}, 'accuracy': 0.37698768415309064, 'macro avg': {'precision': 0.38757472327686954, 'recall': 0.37416867076564825, 'f1-score': 0.32181853153213075, 'support': 102632}, 'weighted avg': {'precision': 0.3875492097575348, 'recall': 0.37698768415309064, 'f1-score': 0.32340991314102036, 'support': 102632}}
[[21417  1214 12746]
 [18403  1599 13898]
 [16620  1060 15675]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1765163
{'0': {'precision': 0.35518042259106103, 'recall': 0.6245641996214762, 'f1-score': 0.4528383648707208, 'support': 10039}, '1': {'precision': 0.42048517520215634, 'recall': 0.028904947192884937, 'f1-score': 0.054091539528432736, 'support': 10794}, '2': {'precision': 0.38379793623902664, 'recall': 0.4725066363291619, 'f1-score': 0.4235574063057703, 'support': 10548}, 'accuracy': 0.36856696727319077, 'macro avg': {'precision': 0.3864878446774147, 'recall': 0.37532526104784103, 'f1-score': 0.3101624369016413, 'support': 31381}, 'weighted avg': {'precision': 0.3872621610201393, 'recall': 0.36856696727319077, 'f1-score': 0.3058408573442636, 'support': 31381}}
[[6270  240 3529]
 [6009  312 4473]
 [5374  190 4984]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
1646/1646 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0466518
{'0': {'precision': 0.40477088486689033, 'recall': 0.6406090111321281, 'f1-score': 0.49608735978580276, 'support': 128996}, '1': {'precision': 0.5630901034553903, 'recall': 0.3551761534409568, 'f1-score': 0.43559517837870704, 'support': 161365}, '2': {'precision': 0.46189324386416636, 'recall': 0.40693837646268066, 'f1-score': 0.432677822398902, 'support': 130924}, 'accuracy': 0.45866100145981936, 'macro avg': {'precision': 0.47658474406214896, 'recall': 0.4675745136785885, 'f1-score': 0.4547867868544706, 'support': 421285}, 'weighted avg': {'precision': 0.48316405917144106, 'recall': 0.45866100145981936, 'f1-score': 0.45321103823246334, 'support': 421285}}
[[82636 19398 26962]
 [68945 57313 35107]
 [52574 25072 53278]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0719641
{'0': {'precision': 0.4336002537064933, 'recall': 0.5929483704490752, 'f1-score': 0.5009067428697037, 'support': 46117}, '1': {'precision': 0.4853104925053533, 'recall': 0.26508222414559407, 'f1-score': 0.34287961996399335, 'support': 42749}, '2': {'precision': 0.4489778976860019, 'recall': 0.4730397516071194, 'f1-score': 0.46069485407638494, 'support': 45734}, 'accuracy': 0.44807578008915305, 'macro avg': {'precision': 0.45596288129928286, 'recall': 0.4436901154005963, 'f1-score': 0.43482707230336065, 'support': 134600}, 'weighted avg': {'precision': 0.4552484124596234, 'recall': 0.44807578008915305, 'f1-score': 0.4370542020140584, 'support': 134600}}
[[27345  5852 12920]
 [17786 11332 13631]
 [17934  6166 21634]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0561814
{'0': {'precision': 0.43975937801486864, 'recall': 0.6087195600942655, 'f1-score': 0.5106256795492735, 'support': 12730}, '1': {'precision': 0.48338937457969067, 'recall': 0.3126304801670146, 'f1-score': 0.3796946806824785, 'support': 11496}, '2': {'precision': 0.4837686111789114, 'recall': 0.45316667936895055, 'f1-score': 0.46796788918621124, 'support': 13121}, 'accuracy': 0.4629287492971323, 'macro avg': {'precision': 0.4689724545911569, 'recall': 0.4581722398767436, 'f1-score': 0.4527627498059877, 'support': 37347}, 'weighted avg': {'precision': 0.4686510048886363, 'recall': 0.4629287492971323, 'f1-score': 0.45533621505878125, 'support': 37347}}
[[7749 1755 3226]
 [4783 3594 3119]
 [5089 2086 5946]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
5929/5929 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66334856
{'0': {'precision': 0.32658844627917405, 'recall': 0.6558640489713635, 'f1-score': 0.4360467742907054, 'support': 176593}, '1': {'precision': 0.908937418007319, 'recall': 0.7223202933503202, 'f1-score': 0.8049542850782426, 'support': 1166387}, '2': {'precision': 0.414961317165349, 'recall': 0.5609617796818888, 'f1-score': 0.47704053675584185, 'support': 174593}, 'accuracy': 0.6960231896587512, 'macro avg': {'precision': 0.5501623938172807, 'recall': 0.6463820406678575, 'f1-score': 0.5726805320415966, 'support': 1517573}, 'weighted avg': {'precision': 0.7843414207546726, 'recall': 0.6960231896587512, 'f1-score': 0.7243005510480796, 'support': 1517573}}
[[115821  33528  27244]
 [213044 842505 110838]
 [ 25774  50879  97940]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72571325
{'0': {'precision': 0.32402537209278104, 'recall': 0.7687175685693106, 'f1-score': 0.45588763271078026, 'support': 40470}, '1': {'precision': 0.9076056104829935, 'recall': 0.6400652212894966, 'f1-score': 0.750711034919579, 'support': 239799}, '2': {'precision': 0.41427164473095174, 'recall': 0.5684414850487727, 'f1-score': 0.47926334106728535, 'support': 40699}, 'accuracy': 0.6472047057650607, 'macro avg': {'precision': 0.5486342091022421, 'recall': 0.6590747583025266, 'f1-score': 0.5619540028992148, 'support': 320968}, 'weighted avg': {'precision': 0.7714683901999925, 'recall': 0.6472047057650607, 'f1-score': 0.6791177521640253, 'support': 320968}}
[[ 31110   5269   4091]
 [ 57693 153487  28619]
 [  7208  10356  23135]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6856814
{'0': {'precision': 0.31299801581052566, 'recall': 0.7672946263125386, 'f1-score': 0.44462340335100553, 'support': 12952}, '1': {'precision': 0.9054602486781897, 'recall': 0.6734330655635191, 'f1-score': 0.7723978124590525, 'support': 83156}, '2': {'precision': 0.45269967334913214, 'recall': 0.5394184537892086, 'f1-score': 0.4922691182615963, 'support': 13103}, 'accuracy': 0.6684857752424206, 'macro avg': {'precision': 0.5570526459459492, 'recall': 0.6600487152217555, 'f1-score': 0.5697634446905514, 'support': 109211}, 'weighted avg': {'precision': 0.7808748803669516, 'recall': 0.6684857752424206, 'f1-score': 0.6999155494375923, 'support': 109211}}
[[ 9938  1852  1162]
 [19773 56000  7383]
 [ 2040  3995  7068]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
5331/5331 - 98s - 98s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75711274
{'0': {'precision': 0.25267538644470866, 'recall': 0.7949749225751638, 'f1-score': 0.38346878542603785, 'support': 145948}, '1': {'precision': 0.9064693381426229, 'recall': 0.6421896160419917, 'f1-score': 0.751779718372073, 'support': 1070690}, '2': {'precision': 0.45412831545122817, 'recall': 0.4508136894463668, 'f1-score': 0.4524649320346203, 'support': 147968}, 'accuracy': 0.6377789633051592, 'macro avg': {'precision': 0.5377576800128532, 'recall': 0.6293260760211741, 'f1-score': 0.5292378119442437, 'support': 1364606}, 'weighted avg': {'precision': 0.787495864401479, 'recall': 0.6377789633051592, 'f1-score': 0.6799324200703009, 'support': 1364606}}
[[116025  17651  12272]
 [315194 687586  67910]
 [ 27967  53295  66706]]
Evaluating performance on  train set...
2013/2013 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7036176
{'0': {'precision': 0.3396075257940522, 'recall': 0.6267192330092738, 'f1-score': 0.4405105543251215, 'support': 66963}, '1': {'precision': 0.8518499135010976, 'recall': 0.7653071353192556, 'f1-score': 0.8062628394676119, 'support': 382828}, '2': {'precision': 0.49780343918664494, 'recall': 0.3631812701271348, 'f1-score': 0.4199677029376208, 'support': 65521}, 'accuracy': 0.6961685347905735, 'macro avg': {'precision': 0.5630869594939316, 'recall': 0.5850692128185547, 'f1-score': 0.5555803655767847, 'support': 515312}, 'weighted avg': {'precision': 0.740269422358675, 'recall': 0.6961685347905735, 'f1-score': 0.7096178672748857, 'support': 515312}}
[[ 41967  20253   4743]
 [ 70584 292981  19263]
 [ 11024  30701  23796]]
Evaluating performance on  val set...
696/696 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6982088
{'0': {'precision': 0.31291526167720823, 'recall': 0.7299851051945634, 'f1-score': 0.4380542714690725, 'support': 21484}, '1': {'precision': 0.8908592169793024, 'recall': 0.7111019367014885, 'f1-score': 0.7908952262254217, 'support': 135643}, '2': {'precision': 0.47975635972769615, 'recall': 0.4505816748389578, 'f1-score': 0.46471156944892045, 'support': 20802}, 'accuracy': 0.682924087697902, 'macro avg': {'precision': 0.5611769461280689, 'recall': 0.6305562389116699, 'f1-score': 0.5645536890478048, 'support': 177929}, 'weighted avg': {'precision': 0.7730127188128534, 'recall': 0.682924087697902, 'f1-score': 0.7101567996606111, 'support': 177929}}
[[15683  4166  1635]
 [30658 96456  8529]
 [ 3778  7651  9373]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
4192/4192 - 77s - 77s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8356629
{'0': {'precision': 0.4063506533885949, 'recall': 0.5993695205952153, 'f1-score': 0.48433789560036267, 'support': 224591}, '1': {'precision': 0.7179150075349096, 'recall': 0.6937803830266378, 'f1-score': 0.7056413901160583, 'support': 629669}, '2': {'precision': 0.5386126439539347, 'recall': 0.3281922426789712, 'f1-score': 0.4078622404660115, 'support': 218890}, 'accuracy': 0.5994530121604622, 'macro avg': {'precision': 0.5542927682924798, 'recall': 0.5404473821002748, 'f1-score': 0.5326138420608107, 'support': 1073150}, 'weighted avg': {'precision': 0.6161379547218689, 'recall': 0.5994530121604622, 'f1-score': 0.5985886470664629, 'support': 1073150}}
[[134613  70061  19917]
 [151196 436852  41621]
 [ 45464 101588  71838]]
Evaluating performance on  train set...
1230/1230 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8902753
{'0': {'precision': 0.4396458982914866, 'recall': 0.6225455390454552, 'f1-score': 0.5153488968564819, 'support': 77461}, '1': {'precision': 0.6725998235968991, 'recall': 0.630518168536881, 'f1-score': 0.6508795235619902, 'support': 160855}, '2': {'precision': 0.5288839860268432, 'recall': 0.37577562670637876, 'f1-score': 0.439373458275101, 'support': 76551}, 'accuracy': 0.5666233679617109, 'macro avg': {'precision': 0.547043235971743, 'recall': 0.542946444762905, 'f1-score': 0.535200626231191, 'support': 314867}, 'weighted avg': {'precision': 0.5803499686108005, 'recall': 0.5666233679617109, 'f1-score': 0.5661156750830704, 'support': 314867}}
[[ 48223  20121   9117]
 [ 42926 101422  16507]
 [ 18537  29248  28766]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.899031
{'0': {'precision': 0.4276072283910298, 'recall': 0.6242352006356774, 'f1-score': 0.5075427205478567, 'support': 25170}, '1': {'precision': 0.6658282651273064, 'recall': 0.6292450073063809, 'f1-score': 0.6470199338876089, 'support': 51325}, '2': {'precision': 0.5332431160273006, 'recall': 0.3519611650485437, 'f1-score': 0.4240396762270154, 'support': 25750}, 'accuracy': 0.55817888405301, 'macro avg': {'precision': 0.542226203181879, 'recall': 0.5351471243302007, 'f1-score': 0.5262007768874937, 'support': 102245}, 'weighted avg': {'precision': 0.5737935340013126, 'recall': 0.55817888405301, 'f1-score': 0.5565276546121251, 'support': 102245}}
[[15712  6388  3070]
 [14166 32296  4863]
 [ 6866  9821  9063]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
6143/6143 - 114s - 114s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7777394
{'0': {'precision': 0.4291747674707046, 'recall': 0.6396563219879985, 'f1-score': 0.5136908085063189, 'support': 316459}, '1': {'precision': 0.751667958799424, 'recall': 0.7188298008678733, 'f1-score': 0.7348822201059312, 'support': 944147}, '2': {'precision': 0.5918733359940589, 'recall': 0.37562520840280095, 'f1-score': 0.459582180187001, 'support': 311896}, 'accuracy': 0.6348239938645547, 'macro avg': {'precision': 0.5909053540880626, 'recall': 0.5780371104195575, 'f1-score': 0.5693850695997503, 'support': 1572502}, 'weighted avg': {'precision': 0.6550733748121239, 'recall': 0.6348239938645547, 'f1-score': 0.6357643848510595, 'support': 1572502}}
[[202425  88078  25956]
 [210637 678681  54829]
 [ 58599 136141 117156]]
Evaluating performance on  train set...
2083/2083 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86686355
{'0': {'precision': 0.43792114001998905, 'recall': 0.6435204194434794, 'f1-score': 0.5211769295210811, 'support': 126644}, '1': {'precision': 0.7166087212847319, 'recall': 0.6319609141864125, 'f1-score': 0.6716282062199009, 'support': 280818}, '2': {'precision': 0.5241082559215023, 'recall': 0.41455210528408415, 'f1-score': 0.46293673381493006, 'support': 125755}, 'accuracy': 0.583432261161966, 'macro avg': {'precision': 0.5595460390754078, 'recall': 0.563344479637992, 'f1-score': 0.5519139565186374, 'support': 533217}, 'weighted avg': {'precision': 0.6050181192156961, 'recall': 0.583432261161966, 'f1-score': 0.5866763993597812, 'support': 533217}}
[[ 81498  29282  15864]
 [ 71880 177466  31472]
 [ 32724  40899  52132]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8493846
{'0': {'precision': 0.4392933674802697, 'recall': 0.6216869252200498, 'f1-score': 0.5148124706506871, 'support': 40559}, '1': {'precision': 0.7059849958321756, 'recall': 0.6753027226433348, 'f1-score': 0.690303089579326, 'support': 94063}, '2': {'precision': 0.5478974063815245, 'recall': 0.37560109491751126, 'f1-score': 0.445676664228237, 'support': 40551}, 'accuracy': 0.5935104154179012, 'macro avg': {'precision': 0.5643919232313233, 'recall': 0.557530247593632, 'f1-score': 0.5502640748194167, 'support': 175173}, 'weighted avg': {'precision': 0.6076401847360687, 'recall': 0.5935104154179012, 'f1-score': 0.5930416954858375, 'support': 175173}}
[[25215 10717  4627]
 [22601 63521  7941]
 [ 9583 15737 15231]]
testing model on single stock: results/universal/W7/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
23942/23942 - 428s - 428s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0942669
{'0': {'precision': 0.44966587560762045, 'recall': 0.4698514888636607, 'f1-score': 0.4595371209045195, 'support': 1878849}, '1': {'precision': 0.4307413835923786, 'recall': 0.644295307647813, 'f1-score': 0.5163073121497578, 'support': 2382302}, '2': {'precision': 0.5259997211470153, 'recall': 0.16965351169995604, 'f1-score': 0.2565579965195652, 'support': 1867913}, 'accuracy': 0.4461666577474146, 'macro avg': {'precision': 0.4688023267823381, 'recall': 0.4279334360704765, 'f1-score': 0.4108008098579475, 'support': 6129064}, 'weighted avg': {'precision': 0.46557387187689303, 'recall': 0.4461666577474146, 'f1-score': 0.41974252828428255, 'support': 6129064}}
[[ 882780  885655  110414]
 [ 672240 1534906  175156]
 [ 408171 1142844  316898]]
Evaluating performance on  train set...
9052/9052 - 164s - 164s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0550549
{'0': {'precision': 0.46887613108161275, 'recall': 0.5744673254246668, 'f1-score': 0.5163285690790134, 'support': 784203}, '1': {'precision': 0.43262303309297273, 'recall': 0.5501910777314827, 'f1-score': 0.4843750821388039, 'support': 753620}, '2': {'precision': 0.5360748819287526, 'recall': 0.2736953277288494, 'f1-score': 0.3623773479114102, 'support': 779257}, 'accuracy': 0.4654189756072298, 'macro avg': {'precision': 0.47919134870111274, 'recall': 0.46611791029499966, 'f1-score': 0.4543603330430758, 'support': 2317080}, 'weighted avg': {'precision': 0.4796845784734554, 'recall': 0.4654189756072298, 'f1-score': 0.45416051550240677, 'support': 2317080}}
[[450499 239005  94699]
 [249110 414635  89875]
 [261197 304781 213279]]
Evaluating performance on  val set...
2763/2763 - 51s - 51s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0922511
{'0': {'precision': 0.45902717159147893, 'recall': 0.5305646670902815, 'f1-score': 0.4922102001270585, 'support': 232916}, '1': {'precision': 0.42068700230225575, 'recall': 0.609040773664809, 'f1-score': 0.49763742094316404, 'support': 240621}, '2': {'precision': 0.5313551578900453, 'recall': 0.20398412168809726, 'f1-score': 0.2947972947911129, 'support': 233778}, 'accuracy': 0.4493217307705902, 'macro avg': {'precision': 0.47035644392792664, 'recall': 0.44786318748106263, 'f1-score': 0.42821497195377844, 'support': 707315}, 'weighted avg': {'precision': 0.4698897181320783, 'recall': 0.4493217307705902, 'f1-score': 0.4288086168386586, 'support': 707315}}
[[123577  87347  21992]
 [ 74006 146548  20067]
 [ 71632 114459  47687]]
training model: results/universal/W7/deepLOB_L2/h20
Epoch 1/50
12475/12475 - 569s - loss: 3.0390 - accuracy20: 0.4624 - val_loss: 3.3262 - val_accuracy20: 0.4277 - 569s/epoch - 46ms/step
Epoch 2/50
12475/12475 - 565s - loss: 2.9474 - accuracy20: 0.4934 - val_loss: 3.1833 - val_accuracy20: 0.4379 - 565s/epoch - 45ms/step
Epoch 3/50
12475/12475 - 564s - loss: 2.9155 - accuracy20: 0.5025 - val_loss: 3.2193 - val_accuracy20: 0.4343 - 564s/epoch - 45ms/step
Epoch 4/50
12475/12475 - 563s - loss: 2.8997 - accuracy20: 0.5064 - val_loss: 3.1735 - val_accuracy20: 0.4402 - 563s/epoch - 45ms/step
Epoch 5/50
12475/12475 - 564s - loss: 2.8881 - accuracy20: 0.5094 - val_loss: 3.1488 - val_accuracy20: 0.4378 - 564s/epoch - 45ms/step
Epoch 6/50
12475/12475 - 563s - loss: 2.8802 - accuracy20: 0.5115 - val_loss: 3.1485 - val_accuracy20: 0.4407 - 563s/epoch - 45ms/step
Epoch 7/50
12475/12475 - 566s - loss: 2.8744 - accuracy20: 0.5130 - val_loss: 3.1449 - val_accuracy20: 0.4470 - 566s/epoch - 45ms/step
Epoch 8/50
12475/12475 - 567s - loss: 2.8693 - accuracy20: 0.5142 - val_loss: 3.1373 - val_accuracy20: 0.4473 - 567s/epoch - 45ms/step
Epoch 9/50
12475/12475 - 566s - loss: 2.8652 - accuracy20: 0.5152 - val_loss: 3.1388 - val_accuracy20: 0.4502 - 566s/epoch - 45ms/step
Epoch 10/50
12475/12475 - 565s - loss: 2.8614 - accuracy20: 0.5163 - val_loss: 3.1384 - val_accuracy20: 0.4460 - 565s/epoch - 45ms/step
Epoch 11/50
12475/12475 - 565s - loss: 2.8581 - accuracy20: 0.5172 - val_loss: 3.1720 - val_accuracy20: 0.4453 - 565s/epoch - 45ms/step
Epoch 12/50
12475/12475 - 568s - loss: 2.8551 - accuracy20: 0.5182 - val_loss: 3.1480 - val_accuracy20: 0.4488 - 568s/epoch - 46ms/step
Epoch 13/50
12475/12475 - 567s - loss: 2.8528 - accuracy20: 0.5187 - val_loss: 3.1897 - val_accuracy20: 0.4426 - 567s/epoch - 45ms/step
Epoch 14/50
12475/12475 - 569s - loss: 2.8502 - accuracy20: 0.5194 - val_loss: 3.1495 - val_accuracy20: 0.4491 - 569s/epoch - 46ms/step
Epoch 15/50
12475/12475 - 568s - loss: 2.8477 - accuracy20: 0.5202 - val_loss: 3.1853 - val_accuracy20: 0.4455 - 568s/epoch - 46ms/step
Epoch 16/50
12475/12475 - 565s - loss: 2.8456 - accuracy20: 0.5207 - val_loss: 3.1611 - val_accuracy20: 0.4483 - 565s/epoch - 45ms/step
Epoch 17/50
12475/12475 - 567s - loss: 2.8434 - accuracy20: 0.5214 - val_loss: 3.1923 - val_accuracy20: 0.4455 - 567s/epoch - 45ms/step
Epoch 18/50
12475/12475 - 566s - loss: 2.8412 - accuracy20: 0.5219 - val_loss: 3.1843 - val_accuracy20: 0.4445 - 566s/epoch - 45ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 652s - 652s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0138264
{'0': {'precision': 0.36979163838753976, 'recall': 0.7208451407620599, 'f1-score': 0.4888199457823991, 'support': 2551007}, '1': {'precision': 0.6313490310599923, 'recall': 0.3911409328026655, 'f1-score': 0.48302958006546176, 'support': 4425116}, '2': {'precision': 0.4509367941665429, 'recall': 0.3193474151880508, 'f1-score': 0.3739022503159737, 'support': 2529449}, 'accuracy': 0.46051915655365083, 'macro avg': {'precision': 0.4840258212046917, 'recall': 0.4771111629175921, 'f1-score': 0.44858392538794484, 'support': 9505572}, 'weighted avg': {'precision': 0.5131469605473421, 'recall': 0.46051915655365083, 'f1-score': 0.4555445689971067, 'support': 9505572}}
[[1838881  396844  315282]
 [2026005 1730844  668267]
 [1107863  613813  807773]]
Evaluating performance on  train set...
12475/12475 - 228s - 228s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.040659
{'0': {'precision': 0.4013079934600327, 'recall': 0.6789900372157804, 'f1-score': 0.5044610314506582, 'support': 985066}, '1': {'precision': 0.5758164880147034, 'recall': 0.32639816262164745, 'f1-score': 0.41663132728489216, 'support': 1229578}, '2': {'precision': 0.4529134465837985, 'recall': 0.38393769674175215, 'f1-score': 0.41558297886463075, 'support': 978440}, 'accuracy': 0.452804248181382, 'macro avg': {'precision': 0.4766793093528449, 'recall': 0.46310863219306003, 'f1-score': 0.44555844586672705, 'support': 3193084}, 'weighted avg': {'precision': 0.48432010503365885, 'recall': 0.452804248181382, 'f1-score': 0.4434055397188381, 'support': 3193084}}
[[668850 126334 189882]
 [564358 401332 263888]
 [433467 169313 375660]]
Evaluating performance on  val set...
3866/3866 - 69s - 69s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.046718
{'0': {'precision': 0.3905311524467488, 'recall': 0.6831443392853529, 'f1-score': 0.4969642096946543, 'support': 296482}, '1': {'precision': 0.5502710283916455, 'recall': 0.3688917010993032, 'f1-score': 0.4416854800922517, 'support': 393522}, '2': {'precision': 0.4592169854665925, 'recall': 0.31734837799717913, 'f1-score': 0.37532388731982375, 'support': 299198}, 'accuracy': 0.44748898607160115, 'macro avg': {'precision': 0.46667305543499565, 'recall': 0.45646147279394506, 'f1-score': 0.43799119236890993, 'support': 989202}, 'weighted avg': {'precision': 0.47485348431572894, 'recall': 0.44748898607160115, 'f1-score': 0.4381815369902914, 'support': 989202}}
[[202540  48338  45604]
 [182144 145167  66211]
 [133943  70305  94950]]
testing model out of sample: results/universal/W7/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 264s - 264s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96639407
{'0': {'precision': 0.3461190263659869, 'recall': 0.6997846694436963, 'f1-score': 0.46315696067254253, 'support': 857751}, '1': {'precision': 0.7589628703535558, 'recall': 0.4224836680083475, 'f1-score': 0.5428081710640928, 'support': 2057618}, '2': {'precision': 0.4705510212749786, 'recall': 0.49014952968530423, 'f1-score': 0.48015036847919007, 'support': 858893}, 'accuracy': 0.5009024280773301, 'macro avg': {'precision': 0.5252109726648405, 'recall': 0.5374726223791161, 'f1-score': 0.4953718334052752, 'support': 3774262}, 'weighted avg': {'precision': 0.5995059650526446, 'recall': 0.5009024280773301, 'f1-score': 0.5104476053693643, 'support': 3774262}}
[[600241 111549 145961]
 [860589 869310 327719]
 [273374 164533 420986]]
Evaluating performance on  train set...
5285/5285 - 100s - 100s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9517188
{'0': {'precision': 0.40433064074582425, 'recall': 0.6184352414821613, 'f1-score': 0.4889727391053928, 'support': 348680}, '1': {'precision': 0.7349147249860348, 'recall': 0.4766195201882019, 'f1-score': 0.5782332690921395, 'support': 659717}, '2': {'precision': 0.4623900643457248, 'recall': 0.5258286879555205, 'f1-score': 0.49207315747123936, 'support': 344249}, 'accuracy': 0.5256999983735582, 'macro avg': {'precision': 0.533878476692528, 'recall': 0.5402944832086279, 'f1-score': 0.5197597218895905, 'support': 1352646}, 'weighted avg': {'precision': 0.5803403571221275, 'recall': 0.5256999983735582, 'f1-score': 0.5332962391070865, 'support': 1352646}}
[[215636  49440  83604]
 [218424 314434 126859]
 [ 99256  63977 181016]]
Evaluating performance on  val set...
1714/1714 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93948936
{'0': {'precision': 0.3907636651404669, 'recall': 0.6428365523205535, 'f1-score': 0.48606252790482646, 'support': 107539}, '1': {'precision': 0.744379978098069, 'recall': 0.49130415263748595, 'f1-score': 0.5919263107507661, 'support': 222750}, '2': {'precision': 0.47672757547872574, 'recall': 0.5048679753120795, 'f1-score': 0.4903944106378184, 'support': 107745}, 'accuracy': 0.5318422770835141, 'macro avg': {'precision': 0.5372904062390872, 'recall': 0.5463362267567063, 'f1-score': 0.522794416431137, 'support': 438034}, 'weighted avg': {'precision': 0.5917302915454984, 'recall': 0.5318422770835141, 'f1-score': 0.5409621391998384, 'support': 438034}}
[[ 69130  15727  22682]
 [ 76286 109438  37026]
 [ 31494  21854  54397]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0972122
{'0': {'precision': 0.37852549853070344, 'recall': 0.6379385964912281, 'f1-score': 0.475129473734356, 'support': 54720}, '1': {'precision': 0.563910887425061, 'recall': 0.1118960199735644, 'f1-score': 0.1867379076236811, 'support': 68090}, '2': {'precision': 0.4393146054964539, 'recall': 0.5754436259389629, 'f1-score': 0.4982483150833425, 'support': 55114}, 'accuracy': 0.41726804703131676, 'macro avg': {'precision': 0.4605836638174061, 'recall': 0.4417594141345851, 'f1-score': 0.38670523214712654, 'support': 177924}, 'weighted avg': {'precision': 0.4683010317422273, 'recall': 0.41726804703131676, 'f1-score': 0.3719258029852282, 'support': 177924}}
[[34908  2640 17172]
 [37166  7619 23305]
 [20147  3252 31715]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0854101
{'0': {'precision': 0.41686760988931176, 'recall': 0.5921508748761968, 'f1-score': 0.4892844355787428, 'support': 24232}, '1': {'precision': 0.4602516654330126, 'recall': 0.12899879673042614, 'f1-score': 0.20151672284158675, 'support': 24101}, '2': {'precision': 0.43121349772874756, 'recall': 0.5616363098508219, 'f1-score': 0.4878585980948185, 'support': 23663}, 'accuracy': 0.4270792821823435, 'macro avg': {'precision': 0.4361109243503573, 'recall': 0.42759532715248155, 'f1-score': 0.39288658550504935, 'support': 71996}, 'weighted avg': {'precision': 0.43610570459739695, 'recall': 0.4270792821823435, 'f1-score': 0.3924842072735551, 'support': 71996}}
[[14349  1787  8096]
 [11558  3109  9434]
 [ 8514  1859 13290]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0878271
{'0': {'precision': 0.41196423065063215, 'recall': 0.6463473633284954, 'f1-score': 0.5032015065913372, 'support': 6201}, '1': {'precision': 0.44735746982937996, 'recall': 0.18186432075790898, 'f1-score': 0.25859995188838103, 'support': 5911}, '2': {'precision': 0.4571831869510665, 'recall': 0.45575359599749843, 'f1-score': 0.4564672721578453, 'support': 6396}, 'accuracy': 0.43213745407391396, 'macro avg': {'precision': 0.4388349624770262, 'recall': 0.4279884266946343, 'f1-score': 0.40608957687918784, 'support': 18508}, 'weighted avg': {'precision': 0.4388947407696702, 'recall': 0.43213745407391396, 'f1-score': 0.4089313556681803, 'support': 18508}}
[[4008  563 1630]
 [3005 1075 1831]
 [2716  765 2915]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
2006/2006 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8606976
{'0': {'precision': 0.24644973567036868, 'recall': 0.7935402058779651, 'f1-score': 0.37609551048402207, 'support': 67030}, '1': {'precision': 0.8892271114393271, 'recall': 0.5190590090682087, 'f1-score': 0.6554937048359738, 'support': 380450}, '2': {'precision': 0.4451441829632085, 'recall': 0.5098709187547457, 'f1-score': 0.47531410369846044, 'support': 65850}, 'accuracy': 0.5537217774141391, 'macro avg': {'precision': 0.5269403433576348, 'recall': 0.6074900445669732, 'f1-score': 0.5023011063394854, 'support': 513330}, 'weighted avg': {'precision': 0.7483270503909845, 'recall': 0.5537217774141391, 'f1-score': 0.5958967833579449, 'support': 513330}}
[[ 53191   8313   5526]
 [146650 197476  36324]
 [ 15988  16287  33575]]
Evaluating performance on  train set...
538/538 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89435184
{'0': {'precision': 0.2644551551431365, 'recall': 0.7908288879770209, 'f1-score': 0.3963648983893981, 'support': 19496}, '1': {'precision': 0.9010984782901444, 'recall': 0.47219169934574634, 'f1-score': 0.6196668827474897, 'support': 99197}, '2': {'precision': 0.3915978719501009, 'recall': 0.5663871789428996, 'f1-score': 0.46304692075750015, 'support': 18844}, 'accuracy': 0.5302645833484808, 'macro avg': {'precision': 0.5190505017944607, 'recall': 0.6098025887552223, 'f1-score': 0.49302623396479595, 'support': 137537}, 'weighted avg': {'precision': 0.7410468001675603, 'recall': 0.5302645833484808, 'f1-score': 0.5665550506529644, 'support': 137537}}
[[15418  1912  2166]
 [37941 46840 14416]
 [ 4942  3229 10673]]
Evaluating performance on  val set...
153/153 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8913204
{'0': {'precision': 0.26945973267437945, 'recall': 0.8154316791298436, 'f1-score': 0.40506542845082316, 'support': 5884}, '1': {'precision': 0.8873342175066313, 'recall': 0.49115401556305976, 'f1-score': 0.6323126358567244, 'support': 27244}, '2': {'precision': 0.48685918234912395, 'recall': 0.5067544748395812, 'f1-score': 0.4966076452093331, 'support': 5922}, 'accuracy': 0.542381562099872, 'macro avg': {'precision': 0.5478843775100449, 'recall': 0.6044467231774949, 'f1-score': 0.5113285698389602, 'support': 39050}, 'weighted avg': {'precision': 0.7335010132311965, 'recall': 0.542381562099872, 'f1-score': 0.5774914444869377, 'support': 39050}}
[[ 4798   540   546]
 [11246 13381  2617]
 [ 1762  1159  3001]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
930/930 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0806123
{'0': {'precision': 0.40383897772883237, 'recall': 0.6040733530284672, 'f1-score': 0.48406663539268846, 'support': 73453}, '1': {'precision': 0.5735254438508446, 'recall': 0.2399124143613359, 'f1-score': 0.3383070324126022, 'support': 88599}, '2': {'precision': 0.44662125041204265, 'recall': 0.5355829918437801, 'f1-score': 0.48707333001803443, 'support': 75893}, 'accuracy': 0.44663262518649266, 'macro avg': {'precision': 0.47466189066390657, 'recall': 0.4598562530778611, 'f1-score': 0.4364823326077751, 'support': 237945}, 'weighted avg': {'precision': 0.4806673466068968, 'recall': 0.44663262518649266, 'f1-score': 0.4307519282577149, 'support': 237945}}
[[44371  7532 21550]
 [38530 21256 28813]
 [26972  8274 40647]]
Evaluating performance on  train set...
381/381 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0452616
{'0': {'precision': 0.44593027383967243, 'recall': 0.5776081424936387, 'f1-score': 0.5032990516895953, 'support': 32619}, '1': {'precision': 0.5377982330846955, 'recall': 0.3121468926553672, 'f1-score': 0.3950185541372812, 'support': 32568}, '2': {'precision': 0.4645970247752083, 'recall': 0.5225459268881054, 'f1-score': 0.4918705695695842, 'support': 32334}, 'accuracy': 0.4706986187590365, 'macro avg': {'precision': 0.4827751772331921, 'recall': 0.4707669873457038, 'f1-score': 0.46339605846548687, 'support': 97521}, 'weighted avg': {'precision': 0.4827995268358633, 'recall': 0.4706986187590365, 'f1-score': 0.4633486021951049, 'support': 97521}}
[[18841  4088  9690]
 [12621 10166  9781]
 [10789  4649 16896]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0629536
{'0': {'precision': 0.44235257507390696, 'recall': 0.5746917323630483, 'f1-score': 0.4999120801828732, 'support': 9894}, '1': {'precision': 0.4914028917545916, 'recall': 0.2696183533447684, 'f1-score': 0.34819327149383905, 'support': 9328}, '2': {'precision': 0.4586222422332283, 'recall': 0.5167935058346017, 'f1-score': 0.48597328244274807, 'support': 9855}, 'accuracy': 0.457199848677649, 'macro avg': {'precision': 0.4641259030205756, 'recall': 0.4537011971808062, 'f1-score': 0.4446928780398201, 'support': 29077}, 'weighted avg': {'precision': 0.46360232311712113, 'recall': 0.457199848677649, 'f1-score': 0.44651592861358325, 'support': 29077}}
[[5686 1196 3012]
 [3813 2515 3000]
 [3355 1407 5093]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2186513
{'0': {'precision': 0.36722596948919484, 'recall': 0.45477138320638794, 'f1-score': 0.40633673951929594, 'support': 86914}, '1': {'precision': 0.3652694610778443, 'recall': 0.010074734712415871, 'f1-score': 0.01960863101217503, 'support': 96876}, '2': {'precision': 0.3594348407945778, 'recall': 0.6573281452658885, 'f1-score': 0.4647427974514979, 'support': 88665}, 'accuracy': 0.3625699656824063, 'macro avg': {'precision': 0.363976757120539, 'recall': 0.37405808772823074, 'f1-score': 0.29689605599432295, 'support': 272455}, 'weighted avg': {'precision': 0.3639948335784345, 'recall': 0.3625699656824063, 'f1-score': 0.28783607293884356, 'support': 272455}}
[[39526   896 46492]
 [38525   976 57375]
 [29583   800 58282]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1990402
{'0': {'precision': 0.3957767872705994, 'recall': 0.44754181449569186, 'f1-score': 0.42007056678075405, 'support': 35514}, '1': {'precision': 0.3520280420630946, 'recall': 0.020716685330347144, 'f1-score': 0.039130555787481563, 'support': 33934}, '2': {'precision': 0.35584364045241085, 'recall': 0.6485053037608486, 'f1-score': 0.459534486440316, 'support': 33184}, 'accuracy': 0.3713948865850807, 'macro avg': {'precision': 0.367882823262035, 'recall': 0.3722546011956292, 'f1-score': 0.3062452030028506, 'support': 102632}, 'weighted avg': {'precision': 0.3684002237827375, 'recall': 0.3713948865850807, 'f1-score': 0.30687733637442066, 'support': 102632}}
[[15894   631 18989]
 [13264   703 19967]
 [11001   663 21520]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1991982
{'0': {'precision': 0.37387200927229075, 'recall': 0.4456725550182572, 'f1-score': 0.4066270484422835, 'support': 10133}, '1': {'precision': 0.3606060606060606, 'recall': 0.011313938011028713, 'f1-score': 0.021939528023598824, 'support': 10518}, '2': {'precision': 0.37687117857895847, 'recall': 0.6663560111835974, 'f1-score': 0.4814490606693152, 'support': 10730}, 'accuracy': 0.3755457123737293, 'macro avg': {'precision': 0.3704497494857699, 'recall': 0.37444750140429445, 'f1-score': 0.3033385457117325, 'support': 31381}, 'weighted avg': {'precision': 0.3704511443728018, 'recall': 0.3755457123737293, 'f1-score': 0.30327460114717897, 'support': 31381}}
[[4516  113 5504]
 [4081  119 6318]
 [3482   98 7150]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0915335
{'0': {'precision': 0.3837391703067307, 'recall': 0.6216233121447392, 'f1-score': 0.4745377278533144, 'support': 127899}, '1': {'precision': 0.5735045238560177, 'recall': 0.21635276495432668, 'f1-score': 0.3141815393941555, 'support': 162896}, '2': {'precision': 0.42052303338399455, 'recall': 0.4919304161238409, 'f1-score': 0.45343260177016154, 'support': 130490}, 'accuracy': 0.42474809214664655, 'macro avg': {'precision': 0.45925557584891435, 'recall': 0.4433021644076356, 'f1-score': 0.41405062300587714, 'support': 421285}, 'weighted avg': {'precision': 0.4685082537649996, 'recall': 0.42474809214664655, 'f1-score': 0.405996503793987, 'support': 421285}}
[[79505 12275 36119]
 [75316 35243 52337]
 [52364 13934 64192]]
Evaluating performance on  train set...
526/526 - 17s - 17s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1107415
{'0': {'precision': 0.4215217003036256, 'recall': 0.516433260393873, 'f1-score': 0.46417543514603204, 'support': 45700}, '1': {'precision': 0.4608733788609736, 'recall': 0.16887827723954268, 'f1-score': 0.24718157227103948, 'support': 43558}, '2': {'precision': 0.4118182253507638, 'recall': 0.5690088659520974, 'f1-score': 0.4778175959107704, 'support': 45342}, 'accuracy': 0.4216716196136701, 'macro avg': {'precision': 0.4314044348384543, 'recall': 0.41810680119517113, 'f1-score': 0.39639153444261394, 'support': 134600}, 'weighted avg': {'precision': 0.4309875654840736, 'recall': 0.4216716196136701, 'f1-score': 0.3985494631867887, 'support': 134600}}
[[23601  4214 17885]
 [17238  7356 18964]
 [15151  4391 25800]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0970919
{'0': {'precision': 0.41679445500828066, 'recall': 0.5427749820273184, 'f1-score': 0.4715148150718201, 'support': 12519}, '1': {'precision': 0.47352279697403393, 'recall': 0.19541005737428283, 'f1-score': 0.2766529295825121, 'support': 11852}, '2': {'precision': 0.43812294929734413, 'recall': 0.5453914919852034, 'f1-score': 0.48590751484774614, 'support': 12976}, 'accuracy': 0.43344846975660695, 'macro avg': {'precision': 0.44281340042655293, 'recall': 0.42785884379560163, 'f1-score': 0.4113584198340261, 'support': 37347}, 'weighted avg': {'precision': 0.44220754979160987, 'recall': 0.43344846975660695, 'f1-score': 0.4146764239151847, 'support': 37347}}
[[6795 1233 4491]
 [4951 2316 4585]
 [4557 1342 7077]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
5929/5929 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7686774
{'0': {'precision': 0.36224009354177916, 'recall': 0.6951950665924371, 'f1-score': 0.47629875655026316, 'support': 233510}, '1': {'precision': 0.8795182482915052, 'recall': 0.6299134186370117, 'f1-score': 0.7340780754418545, 'support': 1051381}, '2': {'precision': 0.4540639448343862, 'recall': 0.6174908243869315, 'f1-score': 0.5233149581778548, 'support': 232682}, 'accuracy': 0.6380536554089985, 'macro avg': {'precision': 0.5652740955558901, 'recall': 0.6475331032054601, 'f1-score': 0.5778972633899908, 'support': 1517573}, 'weighted avg': {'precision': 0.7346914886215467, 'recall': 0.6380536554089985, 'f1-score': 0.6620981229745944, 'support': 1517573}}
[[162335  36768  34407]
 [250759 662279 138343]
 [ 35048  53955 143679]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88596344
{'0': {'precision': 0.3449482321749199, 'recall': 0.7555731167184313, 'f1-score': 0.4736548021589987, 'support': 54413}, '1': {'precision': 0.8804655496756272, 'recall': 0.47289003040546923, 'f1-score': 0.6153052260398941, 'support': 211804}, '2': {'precision': 0.4089680087248932, 'recall': 0.6575039725301821, 'f1-score': 0.5042759586762388, 'support': 54751}, 'accuracy': 0.5523042795543481, 'macro avg': {'precision': 0.5447939301918134, 'recall': 0.6286557065513608, 'f1-score': 0.5310786622917104, 'support': 320968}, 'weighted avg': {'precision': 0.7092520154237403, 'recall': 0.5523042795543481, 'f1-score': 0.5723520720430513, 'support': 320968}}
[[ 41113   5074   8226]
 [ 67845 100160  43799]
 [ 10228   8524  35999]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8125515
{'0': {'precision': 0.34809862097785205, 'recall': 0.7564131668558456, 'f1-score': 0.47678328682836085, 'support': 17620}, '1': {'precision': 0.87044207122495, 'recall': 0.5541770506013652, 'f1-score': 0.6772041907347027, 'support': 73832}, '2': {'precision': 0.45837688673328597, 'recall': 0.6173207950898136, 'f1-score': 0.5261061522219023, 'support': 17759}, 'accuracy': 0.5970735548616898, 'macro avg': {'precision': 0.5589725263120294, 'recall': 0.6426370041823415, 'f1-score': 0.5600312099283219, 'support': 109211}, 'weighted avg': {'precision': 0.7191609987620906, 'recall': 0.5970735548616898, 'f1-score': 0.6202981428752511, 'support': 109211}}
[[13328  2222  2070]
 [22032 40916 10884]
 [ 2928  3868 10963]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
5331/5331 - 96s - 96s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9940106
{'0': {'precision': 0.2351962206887385, 'recall': 0.8578339780428437, 'f1-score': 0.3691742640746737, 'support': 198022}, '1': {'precision': 0.9113466704127423, 'recall': 0.35929495042976056, 'f1-score': 0.515396712022013, 'support': 966003}, '2': {'precision': 0.40320822897348146, 'recall': 0.5256978477522797, 'f1-score': 0.45637702988123685, 'support': 200581}, 'accuracy': 0.4560986834295027, 'macro avg': {'precision': 0.5165837066916541, 'recall': 0.580942258741628, 'f1-score': 0.44698266865930786, 'support': 1364606}, 'weighted avg': {'precision': 0.73853812268719, 'recall': 0.4560986834295027, 'f1-score': 0.48550274376237834, 'support': 1364606}}
[[169870   9375  18777]
 [481630 347080 137293]
 [ 70748  24388 105445]]
Evaluating performance on  train set...
2013/2013 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8841336
{'0': {'precision': 0.3229945973758683, 'recall': 0.7097919493441881, 'f1-score': 0.44396195056402277, 'support': 88440}, '1': {'precision': 0.836149497345277, 'recall': 0.5429264206674602, 'f1-score': 0.6583649932640974, 'support': 340245}, '2': {'precision': 0.4311790873194382, 'recall': 0.4979163540235723, 'f1-score': 0.4621508394852728, 'support': 86627}, 'accuracy': 0.5639981215263763, 'macro avg': {'precision': 0.5301077273468612, 'recall': 0.5835449080117402, 'f1-score': 0.5214925944377976, 'support': 515312}, 'weighted avg': {'precision': 0.6800017828294053, 'recall': 0.5639981215263763, 'f1-score': 0.5885834849821384, 'support': 515312}}
[[ 62774  14389  11277]
 [109892 184728  45625]
 [ 21684  21810  43133]]
Evaluating performance on  val set...
696/696 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8808298
{'0': {'precision': 0.3072754655368981, 'recall': 0.7655165158847044, 'f1-score': 0.4385275950384171, 'support': 28518}, '1': {'precision': 0.8640441404616401, 'recall': 0.5272954794306273, 'f1-score': 0.6549178400155424, 'support': 121467}, '2': {'precision': 0.4420699129903832, 'recall': 0.5181792155740051, 'f1-score': 0.4771083543386217, 'support': 27944}, 'accuracy': 0.5640452090440569, 'macro avg': {'precision': 0.5377965063296405, 'recall': 0.6036637369631123, 'f1-score': 0.5235179297975271, 'support': 177929}, 'weighted avg': {'precision': 0.7085350504090878, 'recall': 0.5640452090440569, 'f1-score': 0.5923101410231717, 'support': 177929}}
[[21831  3748  2939]
 [42082 64049 15336]
 [ 7134  6330 14480]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
4192/4192 - 75s - 75s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9239264
{'0': {'precision': 0.4334776279497395, 'recall': 0.6300609013398295, 'f1-score': 0.5136011483459904, 'support': 287350}, '1': {'precision': 0.6696879628812179, 'recall': 0.5404036206330171, 'f1-score': 0.5981395206210067, 'support': 505326}, '2': {'precision': 0.5074844376983134, 'recall': 0.4482091031610773, 'f1-score': 0.4760085424129287, 'support': 280474}, 'accuracy': 0.5403149606299212, 'macro avg': {'precision': 0.5368833428430902, 'recall': 0.5395578750446414, 'f1-score': 0.5292497371266419, 'support': 1073150}, 'weighted avg': {'precision': 0.5640467093148849, 'recall': 0.5403149606299212, 'f1-score': 0.5435836195306109, 'support': 1073150}}
[[181048  59945  46357]
 [156600 273080  75646]
 [ 80016  74747 125711]]
Evaluating performance on  train set...
1230/1230 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96136683
{'0': {'precision': 0.4568290731838605, 'recall': 0.6301043557168784, 'f1-score': 0.5296552321927753, 'support': 96976}, '1': {'precision': 0.6158038147138964, 'recall': 0.44061437640794593, 'f1-score': 0.5136829639816446, 'support': 122075}, '2': {'precision': 0.5075403681662081, 'recall': 0.49666026550889203, 'f1-score': 0.5020413761090422, 'support': 95816}, 'accuracy': 0.516030577990072, 'macro avg': {'precision': 0.5267244186879884, 'recall': 0.5224596658779055, 'f1-score': 0.5151265240944873, 'support': 314867}, 'weighted avg': {'precision': 0.5338958823836426, 'recall': 0.516030577990072, 'f1-score': 0.5150596604866494, 'support': 314867}}
[[61105 14610 21261]
 [43374 53788 24913]
 [29280 18948 47588]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9635728
{'0': {'precision': 0.44500883886415, 'recall': 0.6363636363636364, 'f1-score': 0.5237555965235712, 'support': 31251}, '1': {'precision': 0.6156816593725866, 'recall': 0.4265005604809946, 'f1-score': 0.5039206537934772, 'support': 39252}, '2': {'precision': 0.508282562160382, 'recall': 0.48623275155944806, 'f1-score': 0.4970132191218381, 'support': 31742}, 'accuracy': 0.5091887133845175, 'macro avg': {'precision': 0.5229910201323729, 'recall': 0.5163656494680263, 'f1-score': 0.5082298231462955, 'support': 102245}, 'weighted avg': {'precision': 0.5301737278608359, 'recall': 0.5091887133845175, 'f1-score': 0.5078387525162606, 'support': 102245}}
[[19887  4365  6999]
 [14579 16741  7932]
 [10223  6085 15434]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
6143/6143 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8767367
{'0': {'precision': 0.4501101511592414, 'recall': 0.6721795980250559, 'f1-score': 0.5391742385477886, 'support': 403657}, '1': {'precision': 0.702102114074458, 'recall': 0.5930831703431214, 'f1-score': 0.6430044453556882, 'support': 772030}, '2': {'precision': 0.5637823147247127, 'recall': 0.451152300190265, 'f1-score': 0.5012178801605921, 'support': 396815}, 'accuracy': 0.5775712844880324, 'macro avg': {'precision': 0.5719981933194708, 'recall': 0.5721383561861475, 'f1-score': 0.5611321880213563, 'support': 1572502}, 'weighted avg': {'precision': 0.6025119762218913, 'recall': 0.5775712844880324, 'f1-score': 0.580572203198064, 'support': 1572502}}
[[271330  79691  52636]
 [228271 457878  85881]
 [103207 114584 179024]]
Evaluating performance on  train set...
2083/2083 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94245523
{'0': {'precision': 0.46619642623728585, 'recall': 0.6106830533518508, 'f1-score': 0.5287467398764585, 'support': 157689}, '1': {'precision': 0.6594836963090087, 'recall': 0.49777189901708135, 'f1-score': 0.567329210951085, 'support': 219245}, '2': {'precision': 0.5070607797880525, 'recall': 0.5229231586288976, 'f1-score': 0.5148698240695533, 'support': 156283}, 'accuracy': 0.5385349679398819, 'macro avg': {'precision': 0.5442469674447823, 'recall': 0.5437927036659432, 'f1-score': 0.536981924965699, 'support': 533217}, 'weighted avg': {'precision': 0.5576482578421472, 'recall': 0.5385349679398819, 'f1-score': 0.5405436027628743, 'support': 533217}}
[[ 96298  24925  36466]
 [ 67129 109134  42982]
 [ 43134  31425  81724]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.929438
{'0': {'precision': 0.46056333812260536, 'recall': 0.610490606463388, 'f1-score': 0.5250334831901589, 'support': 50407}, '1': {'precision': 0.6540110226576853, 'recall': 0.5326180720293293, 'f1-score': 0.5871052572931292, 'support': 74192}, '2': {'precision': 0.5187124499332443, 'recall': 0.49165579151342587, 'f1-score': 0.504821845497919, 'support': 50574}, 'accuracy': 0.5432001507081571, 'macro avg': {'precision': 0.5444289369045117, 'recall': 0.5449214900020477, 'f1-score': 0.5389868619937357, 'support': 175173}, 'weighted avg': {'precision': 0.559283482161572, 'recall': 0.5432001507081571, 'f1-score': 0.5454878094824541, 'support': 175173}}
[[30773  8916 10718]
 [22323 39516 12353]
 [13720 11989 24865]]
testing model on single stock: results/universal/W7/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
23942/23942 - 422s - 422s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0940194
{'0': {'precision': 0.3708013419529999, 'recall': 0.7477362524204471, 'f1-score': 0.4957573303197162, 'support': 1876203}, '1': {'precision': 0.4404463023987869, 'recall': 0.24975293622178737, 'f1-score': 0.3187565303374625, 'support': 2391083}, '2': {'precision': 0.45112758405732234, 'recall': 0.2398314944101821, 'f1-score': 0.31317224427846063, 'support': 1861778}, 'accuracy': 0.3991797116166514, 'macro avg': {'precision': 0.4207917428030364, 'recall': 0.41244022768413885, 'f1-score': 0.37589536831187975, 'support': 6129064}, 'weighted avg': {'precision': 0.4223714530384927, 'recall': 0.3991797116166514, 'f1-score': 0.3712429672548691, 'support': 6129064}}
[[1402905  290779  182519]
 [1433164  597180  360739]
 [ 947372  467893  446513]]
Evaluating performance on  train set...
9052/9052 - 161s - 161s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0744773
{'0': {'precision': 0.4070031549099569, 'recall': 0.6873888324534108, 'f1-score': 0.5112782744918233, 'support': 778667}, '1': {'precision': 0.4524646851421873, 'recall': 0.26218776555008866, 'f1-score': 0.3319955166258458, 'support': 762568}, '2': {'precision': 0.464218316208568, 'recall': 0.33513266180744866, 'f1-score': 0.3892525917886149, 'support': 775845}, 'accuracy': 0.42950351304227735, 'macro avg': {'precision': 0.4412287187535708, 'recall': 0.42823641993698264, 'f1-score': 0.410842127635428, 'support': 2317080}, 'weighted avg': {'precision': 0.44112265229625885, 'recall': 0.42950351304227735, 'f1-score': 0.41141624560321627, 'support': 2317080}}
[[535247 104098 139322]
 [401860 199936 160772]
 [377986 137848 260011]]
Evaluating performance on  val set...
2763/2763 - 48s - 48s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0966265
{'0': {'precision': 0.39385090399639533, 'recall': 0.6906871507897441, 'f1-score': 0.5016472359208762, 'support': 231594}, '1': {'precision': 0.4244441891193198, 'recall': 0.3044512024262803, 'f1-score': 0.3545708897026006, 'support': 242676}, '2': {'precision': 0.45860869838872104, 'recall': 0.2501276577485035, 'f1-score': 0.3237049110229377, 'support': 233045}, 'accuracy': 0.41301683125622957, 'macro avg': {'precision': 0.4256345971681454, 'recall': 0.4150886703215093, 'f1-score': 0.3933076788821382, 'support': 707315}, 'weighted avg': {'precision': 0.42568358993498046, 'recall': 0.41301683125622957, 'f1-score': 0.3925579779513629, 'support': 707315}}
[[159959  41081  30554]
 [130534  73883  38259]
 [115648  59106  58291]]
training model: results/universal/W7/deepLOB_L2/h30
Epoch 1/50
12475/12475 - 574s - loss: 3.1333 - accuracy30: 0.4279 - val_loss: 3.6090 - val_accuracy30: 0.3880 - 574s/epoch - 46ms/step
Epoch 2/50
12475/12475 - 570s - loss: 3.0696 - accuracy30: 0.4527 - val_loss: 3.6878 - val_accuracy30: 0.3850 - 570s/epoch - 46ms/step
Epoch 3/50
12475/12475 - 569s - loss: 3.0303 - accuracy30: 0.4656 - val_loss: 3.3645 - val_accuracy30: 0.3930 - 569s/epoch - 46ms/step
Epoch 4/50
12475/12475 - 569s - loss: 3.0081 - accuracy30: 0.4723 - val_loss: 3.3786 - val_accuracy30: 0.4042 - 569s/epoch - 46ms/step
Epoch 5/50
12475/12475 - 571s - loss: 2.9947 - accuracy30: 0.4765 - val_loss: 3.3100 - val_accuracy30: 0.4080 - 571s/epoch - 46ms/step
Epoch 6/50
12475/12475 - 574s - loss: 2.9863 - accuracy30: 0.4790 - val_loss: 3.3893 - val_accuracy30: 0.4120 - 574s/epoch - 46ms/step
Epoch 7/50
12475/12475 - 566s - loss: 2.9790 - accuracy30: 0.4815 - val_loss: 3.3960 - val_accuracy30: 0.3974 - 566s/epoch - 45ms/step
Epoch 8/50
12475/12475 - 570s - loss: 2.9737 - accuracy30: 0.4830 - val_loss: 3.3496 - val_accuracy30: 0.4058 - 570s/epoch - 46ms/step
Epoch 9/50
12475/12475 - 567s - loss: 2.9690 - accuracy30: 0.4843 - val_loss: 3.2558 - val_accuracy30: 0.4143 - 567s/epoch - 45ms/step
Epoch 10/50
12475/12475 - 572s - loss: 2.9650 - accuracy30: 0.4855 - val_loss: 3.2601 - val_accuracy30: 0.4176 - 572s/epoch - 46ms/step
Epoch 11/50
12475/12475 - 572s - loss: 2.9619 - accuracy30: 0.4866 - val_loss: 3.2622 - val_accuracy30: 0.4142 - 572s/epoch - 46ms/step
Epoch 12/50
12475/12475 - 570s - loss: 2.9590 - accuracy30: 0.4875 - val_loss: 3.2651 - val_accuracy30: 0.4144 - 570s/epoch - 46ms/step
Epoch 13/50
12475/12475 - 569s - loss: 2.9563 - accuracy30: 0.4883 - val_loss: 3.2473 - val_accuracy30: 0.4137 - 569s/epoch - 46ms/step
Epoch 14/50
12475/12475 - 569s - loss: 2.9536 - accuracy30: 0.4890 - val_loss: 3.2504 - val_accuracy30: 0.4104 - 569s/epoch - 46ms/step
Epoch 15/50
12475/12475 - 568s - loss: 2.9513 - accuracy30: 0.4900 - val_loss: 3.2824 - val_accuracy30: 0.4034 - 568s/epoch - 46ms/step
Epoch 16/50
12475/12475 - 568s - loss: 2.9490 - accuracy30: 0.4907 - val_loss: 3.3311 - val_accuracy30: 0.3902 - 568s/epoch - 46ms/step
Epoch 17/50
12475/12475 - 569s - loss: 2.9469 - accuracy30: 0.4912 - val_loss: 3.3410 - val_accuracy30: 0.3896 - 569s/epoch - 46ms/step
Epoch 18/50
12475/12475 - 569s - loss: 2.9453 - accuracy30: 0.4916 - val_loss: 3.3185 - val_accuracy30: 0.3949 - 569s/epoch - 46ms/step
Epoch 19/50
12475/12475 - 573s - loss: 2.9435 - accuracy30: 0.4923 - val_loss: 3.3867 - val_accuracy30: 0.3851 - 573s/epoch - 46ms/step
Epoch 20/50
12475/12475 - 570s - loss: 2.9422 - accuracy30: 0.4926 - val_loss: 3.3818 - val_accuracy30: 0.3861 - 570s/epoch - 46ms/step
Epoch 21/50
12475/12475 - 567s - loss: 2.9404 - accuracy30: 0.4931 - val_loss: 3.5603 - val_accuracy30: 0.3634 - 567s/epoch - 45ms/step
Epoch 22/50
12475/12475 - 573s - loss: 2.9389 - accuracy30: 0.4936 - val_loss: 3.4503 - val_accuracy30: 0.3810 - 573s/epoch - 46ms/step
Epoch 23/50
12475/12475 - 570s - loss: 2.9373 - accuracy30: 0.4941 - val_loss: 3.5937 - val_accuracy30: 0.3616 - 570s/epoch - 46ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 650s - 650s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0563562
{'0': {'precision': 0.36684110531981523, 'recall': 0.5848621072572662, 'f1-score': 0.45087892748613506, 'support': 2688974}, '1': {'precision': 0.5688868668348854, 'recall': 0.362550351972732, 'f1-score': 0.4428642739178584, 'support': 4149043}, '2': {'precision': 0.4040292722984907, 'recall': 0.3899064874013844, 'f1-score': 0.3968422695276835, 'support': 2667555}, 'accuracy': 0.4331157556851918, 'macro avg': {'precision': 0.44658574815106383, 'recall': 0.44577298221046086, 'f1-score': 0.4301951569772256, 'support': 9505572}, 'weighted avg': {'precision': 0.4654672619844086, 'recall': 0.4331157556851918, 'f1-score': 0.4322163052467537, 'support': 9505572}}
[[1572679  593612  522683]
 [1633275 1504237 1011531]
 [1081131  546327 1040097]]
Evaluating performance on  train set...
12475/12475 - 225s - 225s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1091497
{'0': {'precision': 0.371019709993666, 'recall': 0.7531618359246806, 'f1-score': 0.49714014067861, 'support': 1002503}, '1': {'precision': 0.5488540753724803, 'recall': 0.20931404334398437, 'f1-score': 0.3030538026751321, 'support': 1196752}, '2': {'precision': 0.42255478353821485, 'recall': 0.29831590746496633, 'f1-score': 0.34972933503356624, 'support': 993829}, 'accuracy': 0.40776221358410863, 'macro avg': {'precision': 0.447476189634787, 'recall': 0.42026392891121045, 'f1-score': 0.3833077594624361, 'support': 3193084}, 'weighted avg': {'precision': 0.45371114029788984, 'recall': 0.40776221358410863, 'f1-score': 0.3785167825891434, 'support': 3193084}}
[[755047  97682 149774]
 [690879 250497 255376]
 [589133 108221 296475]]
Evaluating performance on  val set...
3866/3866 - 69s - 69s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0912985
{'0': {'precision': 0.37249475641606505, 'recall': 0.6950797946133331, 'f1-score': 0.4850501138952164, 'support': 306349}, '1': {'precision': 0.5122136386014475, 'recall': 0.298501379567387, 'f1-score': 0.37718920787013666, 'support': 372943}, '2': {'precision': 0.4257437116656344, 'recall': 0.27504436771966057, 'f1-score': 0.33419064459090175, 'support': 309910}, 'accuracy': 0.41397004858461667, 'macro avg': {'precision': 0.43681736889438233, 'recall': 0.42287518063346025, 'f1-score': 0.39880998878541823, 'support': 989202}, 'weighted avg': {'precision': 0.4418532522543844, 'recall': 0.41397004858461667, 'f1-score': 0.3971218363464332, 'support': 989202}}
[[212937  50868  42544]
 [189190 111324  72429]
 [169524  55147  85239]]
testing model out of sample: results/universal/W7/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 260s - 260s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1009555
{'0': {'precision': 0.35335621301890024, 'recall': 0.7745325101838682, 'f1-score': 0.4853065183264396, 'support': 939967}, '1': {'precision': 0.722116781686539, 'recall': 0.28182531030455193, 'f1-score': 0.4054233559852358, 'support': 1888709}, '2': {'precision': 0.3798781736281736, 'recall': 0.3924180349539862, 'f1-score': 0.38604629871420204, 'support': 945586}, 'accuracy': 0.4322397332246675, 'macro avg': {'precision': 0.4851170561112043, 'recall': 0.48292528514746874, 'f1-score': 0.4255920576752925, 'support': 3774262}, 'weighted avg': {'precision': 0.5445353626201648, 'recall': 0.4322397332246675, 'f1-score': 0.420463345890464, 'support': 3774262}}
[[728035  90835 121097]
 [871785 532286 484638]
 [460523 113998 371065]]
Evaluating performance on  train set...
5285/5285 - 98s - 98s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.028316
{'0': {'precision': 0.3960933168664295, 'recall': 0.7262059194363927, 'f1-score': 0.5126000304610072, 'support': 384665}, '1': {'precision': 0.7140333026470921, 'recall': 0.3758284056867139, 'f1-score': 0.4924551357095358, 'support': 588178}, '2': {'precision': 0.4406112347842561, 'recall': 0.39189263907868027, 'f1-score': 0.4148264170978427, 'support': 379803}, 'accuracy': 0.47997924068825104, 'macro avg': {'precision': 0.5169126180992593, 'recall': 0.49797565473392896, 'f1-score': 0.4732938610894619, 'support': 1352646}, 'weighted avg': {'precision': 0.5468447653129874, 'recall': 0.47997924068825104, 'f1-score': 0.47638693732259485, 'support': 1352646}}
[[279346  42734  62585]
 [240743 221054 126381]
 [185164  45797 148842]]
Evaluating performance on  val set...
1714/1714 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0240793
{'0': {'precision': 0.39275723200836177, 'recall': 0.7485290055826644, 'f1-score': 0.5151909672216142, 'support': 119477}, '1': {'precision': 0.7315538626263774, 'recall': 0.3881219774585013, 'f1-score': 0.5071684528951352, 'support': 198922}, '2': {'precision': 0.4357787659598832, 'recall': 0.38171939649768044, 'f1-score': 0.40696166716422566, 'support': 119635}, 'accuracy': 0.4846769885442683, 'macro avg': {'precision': 0.5200299535315408, 'recall': 0.506123459846282, 'f1-score': 0.4764403624269917, 'support': 438034}, 'weighted avg': {'precision': 0.5583630629942834, 'recall': 0.4846769885442683, 'f1-score': 0.4819883690049974, 'support': 438034}}
[[89432 13089 16956]
 [79545 77206 42171]
 [58726 15242 45667]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2596971
{'0': {'precision': 0.32147284741127, 'recall': 0.9327325991026069, 'f1-score': 0.47814846497481234, 'support': 53934}, '1': {'precision': 0.6736725663716814, 'recall': 0.01762025316455696, 'f1-score': 0.034342266645989876, 'support': 69125}, '2': {'precision': 0.4552215995924605, 'recall': 0.16287250524013488, 'f1-score': 0.2399087187059534, 'support': 54865}, 'accuracy': 0.33980800791349114, 'macro avg': {'precision': 0.48345567112513727, 'recall': 0.3710751191690996, 'f1-score': 0.2507998167755852, 'support': 177924}, 'weighted avg': {'precision': 0.4995484912904513, 'recall': 0.33980800791349114, 'f1-score': 0.23226186654783906, 'support': 177924}}
[[50306   248  3380]
 [60593  1218  7314]
 [45587   342  8936]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1661286
{'0': {'precision': 0.36882445452737755, 'recall': 0.8331155573703553, 'f1-score': 0.5112957185279856, 'support': 24490}, '1': {'precision': 0.49839400428265523, 'recall': 0.03930591910833404, 'f1-score': 0.07286530484464272, 'support': 23686}, '2': {'precision': 0.4369640083732865, 'recall': 0.2716624685138539, 'f1-score': 0.3350332651634782, 'support': 23820}, 'accuracy': 0.3862020112228457, 'macro avg': {'precision': 0.4347274890611064, 'recall': 0.38136131499751436, 'f1-score': 0.3063980961787022, 'support': 71996}, 'weighted avg': {'precision': 0.433995693597785, 'recall': 0.3862020112228457, 'f1-score': 0.30873954293981093, 'support': 71996}}
[[20403   440  3647]
 [18064   931  4691]
 [16852   497  6471]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1446368
{'0': {'precision': 0.37541231445849366, 'recall': 0.8589622641509433, 'f1-score': 0.5224751338944146, 'support': 6360}, '1': {'precision': 0.47579529737206083, 'recall': 0.061133819086547005, 'f1-score': 0.10834645669291337, 'support': 5627}, '2': {'precision': 0.4713888029693783, 'recall': 0.2337064867351633, 'f1-score': 0.3124871847447201, 'support': 6521}, 'accuracy': 0.3960989842230387, 'macro avg': {'precision': 0.4408654715999776, 'recall': 0.3846008566575512, 'f1-score': 0.31443625844401607, 'support': 18508}, 'weighted avg': {'precision': 0.43974761413615315, 'recall': 0.3960989842230387, 'f1-score': 0.3225813861627307, 'support': 18508}}
[[5463  166  731]
 [4305  344  978]
 [4784  213 1524]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
2006/2006 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9778766
{'0': {'precision': 0.2988345887560149, 'recall': 0.7091629626952867, 'f1-score': 0.420482018062286, 'support': 83019}, '1': {'precision': 0.851097360431776, 'recall': 0.4622490546161355, 'f1-score': 0.5991091851140047, 'support': 349329}, '2': {'precision': 0.3560075835374042, 'recall': 0.556506384134746, 'f1-score': 0.434230050295801, 'support': 80982}, 'accuracy': 0.5170514094247365, 'macro avg': {'precision': 0.5019798442417317, 'recall': 0.575972800482056, 'f1-score': 0.48460708449069717, 'support': 513330}, 'weighted avg': {'precision': 0.6836774485734977, 'recall': 0.5170514094247365, 'f1-score': 0.5442094308091434, 'support': 513330}}
[[ 58874  13397  10748]
 [117077 161477  70775]
 [ 21061  14854  45067]]
Evaluating performance on  train set...
538/538 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0408509
{'0': {'precision': 0.30437100213219614, 'recall': 0.7266480020361415, 'f1-score': 0.42903298519798627, 'support': 23574}, '1': {'precision': 0.8739798920412393, 'recall': 0.3742987991936191, 'f1-score': 0.5241291490553157, 'support': 91272}, '2': {'precision': 0.3213574274331246, 'recall': 0.5971971266140761, 'f1-score': 0.4178602815337887, 'support': 22691}, 'accuracy': 0.47146586009582875, 'macro avg': {'precision': 0.4999027738688533, 'recall': 0.5660479759479456, 'f1-score': 0.45700747192903024, 'support': 137537}, 'weighted avg': {'precision': 0.6851760333331207, 'recall': 0.47146586009582875, 'f1-score': 0.49029720681647343, 'support': 137537}}
[[17130  2453  3991]
 [32483 34163 24626]
 [ 6667  2473 13551]]
Evaluating performance on  val set...
153/153 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0141
{'0': {'precision': 0.33669743044950534, 'recall': 0.7118192026951151, 'f1-score': 0.4571557358575614, 'support': 7124}, '1': {'precision': 0.8515187510605804, 'recall': 0.4050367261280168, 'f1-score': 0.548955256536484, 'support': 24778}, '2': {'precision': 0.34073588461853643, 'recall': 0.5817011751538892, 'f1-score': 0.4297452328045062, 'support': 7148}, 'accuracy': 0.4933418693982074, 'macro avg': {'precision': 0.5096506887095408, 'recall': 0.5661857013256737, 'f1-score': 0.4786187417328505, 'support': 39050}, 'weighted avg': {'precision': 0.6641010041371225, 'recall': 0.4933418693982074, 'f1-score': 0.5103869329781532, 'support': 39050}}
[[ 5071   864  1189]
 [ 7886 10036  6856]
 [ 2104   886  4158]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
930/930 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2075374
{'0': {'precision': 0.34867504936090615, 'recall': 0.8901770909332095, 'f1-score': 0.5010808489984878, 'support': 75385}, '1': {'precision': 0.6215443279313632, 'recall': 0.06180973598141916, 'f1-score': 0.11243802543651649, 'support': 84388}, '2': {'precision': 0.491548270563179, 'recall': 0.23324208156373125, 'f1-score': 0.31636663340996835, 'support': 78172}, 'accuracy': 0.38057114038958584, 'macro avg': {'precision': 0.4872558826184828, 'recall': 0.39507630282611994, 'f1-score': 0.3099618359483242, 'support': 237945}, 'weighted avg': {'precision': 0.4923871598394949, 'recall': 0.38057114038958584, 'f1-score': 0.30256324931900985, 'support': 237945}}
[[67106  1525  6754]
 [67066  5216 12106]
 [58288  1651 18233]]
Evaluating performance on  train set...
381/381 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1331689
{'0': {'precision': 0.3870461178352913, 'recall': 0.7926818168026942, 'f1-score': 0.5201274138960781, 'support': 32959}, '1': {'precision': 0.5744112030553787, 'recall': 0.14223118872742174, 'f1-score': 0.22800545757744203, 'support': 31723}, '2': {'precision': 0.4566207985562824, 'recall': 0.30820061512226316, 'f1-score': 0.3680095993018689, 'support': 32839}, 'accuracy': 0.41795100542447267, 'macro avg': {'precision': 0.4726927064823175, 'recall': 0.4143712068841264, 'f1-score': 0.372047490258463, 'support': 97521}, 'weighted avg': {'precision': 0.4714232831497719, 'recall': 0.41795100542447267, 'f1-score': 0.3738780754586612, 'support': 97521}}
[[26126  1537  5296]
 [20463  4512  6748]
 [20912  1806 10121]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1485119
{'0': {'precision': 0.3799449681988362, 'recall': 0.8482376636455187, 'f1-score': 0.5248138571295057, 'support': 9930}, '1': {'precision': 0.5178211163416274, 'recall': 0.08472711267605634, 'f1-score': 0.14562647754137115, 'support': 9088}, '2': {'precision': 0.4764803541781959, 'recall': 0.2567849686847599, 'f1-score': 0.33372093023255817, 'support': 10059}, 'accuracy': 0.40499363758296936, 'macro avg': {'precision': 0.4580821462395532, 'recall': 0.396583248335445, 'f1-score': 0.33472042163447835, 'support': 29077}, 'weighted avg': {'precision': 0.45643387289629694, 'recall': 0.40499363758296936, 'f1-score': 0.3401916933109081, 'support': 29077}}
[[8423  306 1201]
 [6681  770 1637]
 [7065  411 2583]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3133609
{'0': {'precision': 0.32420732621122267, 'recall': 0.8776035328071212, 'f1-score': 0.47349463138870995, 'support': 86277}, '1': {'precision': 0.4068441064638783, 'recall': 0.0011108227355307553, 'f1-score': 0.0022155961403072847, 'support': 96325}, '2': {'precision': 0.3861619271871038, 'recall': 0.16609350828575561, 'f1-score': 0.23228015564202334, 'support': 89853}, 'accuracy': 0.33307518672808356, 'macro avg': {'precision': 0.37240445328740157, 'recall': 0.3482692879428025, 'f1-score': 0.23599679439034685, 'support': 272455}, 'weighted avg': {'precision': 0.3738551382143898, 'recall': 0.33307518672808356, 'f1-score': 0.22732628300248317, 'support': 272455}}
[[75717    58 10502]
 [82997   107 13221]
 [74831    98 14924]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2483811
{'0': {'precision': 0.3583903780948116, 'recall': 0.7906845448129852, 'f1-score': 0.4932206374361684, 'support': 35425}, '1': {'precision': 0.415, 'recall': 0.0048663227016885555, 'f1-score': 0.00961984237366713, 'support': 34112}, '2': {'precision': 0.3664908418822943, 'recall': 0.26662637860704036, 'f1-score': 0.3086825718883369, 'support': 33095}, 'accuracy': 0.3605113414919323, 'macro avg': {'precision': 0.37996040665903524, 'recall': 0.35405908204057135, 'f1-score': 0.2705076838993908, 'support': 102632}, 'weighted avg': {'precision': 0.3798179277038665, 'recall': 0.3605113414919323, 'f1-score': 0.27297863103974696, 'support': 102632}}
[[28010   107  7308]
 [26001   166  7945]
 [24144   127  8824]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2943147
{'0': {'precision': 0.33172012755580566, 'recall': 0.8733702094033978, 'f1-score': 0.4808178580168031, 'support': 10124}, '1': {'precision': 0.16666666666666666, 'recall': 0.00019083969465648855, 'f1-score': 0.0003812428516965307, 'support': 10480}, '2': {'precision': 0.40814594823928724, 'recall': 0.17852834740651388, 'f1-score': 0.2484022981085792, 'support': 10777}, 'accuracy': 0.34313756731780376, 'macro avg': {'precision': 0.3021775808205865, 'recall': 0.3506964655015227, 'f1-score': 0.24320046632569295, 'support': 31381}, 'weighted avg': {'precision': 0.30284535617782865, 'recall': 0.34313756731780376, 'f1-score': 0.2405540609401884, 'support': 31381}}
[[8842    4 1278]
 [8966    2 1512]
 [8847    6 1924]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2767845
{'0': {'precision': 0.2878037930574297, 'recall': 0.8813069853608921, 'f1-score': 0.4339083993016045, 'support': 110116}, '1': {'precision': 0.6483170004260759, 'recall': 0.07782005646250154, 'f1-score': 0.13896017315226625, 'support': 195528}, '2': {'precision': 0.37946222368855165, 'recall': 0.19891733900606187, 'f1-score': 0.2610106603275824, 'support': 115641}, 'accuracy': 0.32107718053099443, 'macro avg': {'precision': 0.43852767239068574, 'recall': 0.38601479360981855, 'f1-score': 0.2779597442604844, 'support': 421285}, 'weighted avg': {'precision': 0.4802860769910856, 'recall': 0.32107718053099443, 'f1-score': 0.2495564660611077, 'support': 421285}}
[[ 97046   3484   9586]
 [152281  15216  28031]
 [ 87868   4770  23003]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1924078
{'0': {'precision': 0.3683721844755642, 'recall': 0.7451937950236444, 'f1-score': 0.4930263157894737, 'support': 45254}, '1': {'precision': 0.46183830001257387, 'recall': 0.08273454217817322, 'f1-score': 0.1403300985711011, 'support': 44395}, '2': {'precision': 0.41175465086464774, 'recall': 0.32152788592022424, 'f1-score': 0.36109029131064807, 'support': 44951}, 'accuracy': 0.3852080237741456, 'macro avg': {'precision': 0.4139883784509286, 'recall': 0.38315207437401394, 'f1-score': 0.33148223522374093, 'support': 134600}, 'weighted avg': {'precision': 0.41368803474243815, 'recall': 0.3852080237741456, 'f1-score': 0.33263549261148456, 'support': 134600}}
[[33723  2065  9466]
 [29540  3673 11182]
 [28283  2215 14453]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1897835
{'0': {'precision': 0.3608669130575191, 'recall': 0.8191740653254053, 'f1-score': 0.501021272355901, 'support': 12277}, '1': {'precision': 0.4830357142857143, 'recall': 0.08770365566993596, 'f1-score': 0.14845304246415586, 'support': 12337}, '2': {'precision': 0.43478861563967947, 'recall': 0.24715306683421032, 'f1-score': 0.31515697761754546, 'support': 12733}, 'accuracy': 0.3825206843923207, 'macro avg': {'precision': 0.42623041432763764, 'recall': 0.38467692927651714, 'f1-score': 0.32154376414586744, 'support': 37347}, 'weighted avg': {'precision': 0.42642616921546733, 'recall': 0.3825206843923207, 'f1-score': 0.3211877029372612, 'support': 37347}}
[[10057   504  1716]
 [ 8880  1082  2375]
 [ 8932   654  3147]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
5929/5929 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8538627
{'0': {'precision': 0.3821438533572425, 'recall': 0.6944824639538841, 'f1-score': 0.49300709187043906, 'support': 276174}, '1': {'precision': 0.8387748952825225, 'recall': 0.5553978506183918, 'f1-score': 0.6682870187532536, 'support': 967348}, '2': {'precision': 0.4446793197206376, 'recall': 0.6087078682435021, 'f1-score': 0.5139227130382276, 'support': 274051}, 'accuracy': 0.590336016784695, 'macro avg': {'precision': 0.5551993561201342, 'recall': 0.619529394271926, 'f1-score': 0.5584056078873068, 'support': 1517573}, 'weighted avg': {'precision': 0.6845075829680688, 'recall': 0.590336016784695, 'f1-score': 0.6085129908333822, 'support': 1517573}}
[[191798  47746  36630]
 [258392 537263 171693]
 [ 51710  55524 166817]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0779307
{'0': {'precision': 0.3178205309901738, 'recall': 0.8261216595803466, 'f1-score': 0.4590414212791, 'support': 65149}, '1': {'precision': 0.8347915060205232, 'recall': 0.2960230529365676, 'f1-score': 0.4370611047060057, 'support': 190171}, '2': {'precision': 0.40035396968689124, 'recall': 0.513420058493785, 'f1-score': 0.44989188179075784, 'support': 65648}, 'accuracy': 0.4480851673687097, 'macro avg': {'precision': 0.5176553355658627, 'recall': 0.5451882570035664, 'f1-score': 0.44866480259195446, 'support': 320968}, 'weighted avg': {'precision': 0.6410024135331647, 'recall': 0.4480851673687097, 'f1-score': 0.4441468905116946, 'support': 320968}}
[[53821  4619  6709]
 [90102 56295 43774]
 [25421  6522 33705]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97227573
{'0': {'precision': 0.33202432468498005, 'recall': 0.8140306599364368, 'f1-score': 0.4716666892340189, 'support': 21396}, '1': {'precision': 0.8305972307000353, 'recall': 0.3899723969410381, 'f1-score': 0.5307521760551815, 'support': 66297}, '2': {'precision': 0.45444258009130994, 'recall': 0.5412213030950832, 'f1-score': 0.4940502704422527, 'support': 21518}, 'accuracy': 0.5028522767853055, 'macro avg': {'precision': 0.5390213784921084, 'recall': 0.581741453324186, 'f1-score': 0.49882304524381765, 'support': 109211}, 'weighted avg': {'precision': 0.6588053629495645, 'recall': 0.5028522767853055, 'f1-score': 0.5119450533202501, 'support': 109211}}
[[17417  1949  2030]
 [28492 25854 11951]
 [ 6548  3324 11646]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
5331/5331 - 95s - 95s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1697711
{'0': {'precision': 0.29107800046441773, 'recall': 0.731454311130142, 'f1-score': 0.41643722335350525, 'support': 238209}, '1': {'precision': 0.884713415782535, 'recall': 0.23892106943651703, 'f1-score': 0.37623742991901754, 'support': 884765}, '2': {'precision': 0.27044881913666446, 'recall': 0.5899301417030857, 'f1-score': 0.3708735742236284, 'support': 241632}, 'accuracy': 0.3870523799543604, 'macro avg': {'precision': 0.48208007846120576, 'recall': 0.5201018407565816, 'f1-score': 0.38784940916538374, 'support': 1364606}, 'weighted avg': {'precision': 0.6723185694574797, 'recall': 0.3870523799543604, 'f1-score': 0.3823050226269843, 'support': 1364606}}
[[174239  14116  49854]
 [338704 211389 334672]
 [ 85656  13430 142546]]
Evaluating performance on  train set...
2013/2013 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9741987
{'0': {'precision': 0.3547061263406252, 'recall': 0.6275840378182096, 'f1-score': 0.45324265910436257, 'support': 104923}, '1': {'precision': 0.784781634588331, 'recall': 0.48967145002828405, 'f1-score': 0.603058936579116, 'support': 307594}, '2': {'precision': 0.37871429089985115, 'recall': 0.5074760445546962, 'f1-score': 0.43374074997921347, 'support': 102795}, 'accuracy': 0.5213035985965784, 'macro avg': {'precision': 0.5060673506096024, 'recall': 0.5415771774670632, 'f1-score': 0.496680781887564, 'support': 515312}, 'weighted avg': {'precision': 0.616210933447408, 'recall': 0.5213035985965784, 'f1-score': 0.5387789736187725, 'support': 515312}}
[[ 65848  21737  17338]
 [ 88733 150620  68241]
 [ 31060  19569  52166]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98866504
{'0': {'precision': 0.3549850312981947, 'recall': 0.6885447826852015, 'f1-score': 0.4684544475038908, 'support': 34098}, '1': {'precision': 0.8209435591490698, 'recall': 0.47402774000543924, 'f1-score': 0.6010172121490762, 'support': 110310}, '2': {'precision': 0.36250415834996674, 'recall': 0.5201217147459801, 'f1-score': 0.42723942315939084, 'support': 33521}, 'accuracy': 0.5238212995071068, 'macro avg': {'precision': 0.5128109162657437, 'recall': 0.5608980791455402, 'f1-score': 0.4989036942707859, 'support': 177929}, 'weighted avg': {'precision': 0.6452802269387731, 'recall': 0.5238212995071068, 'f1-score': 0.5428741864838122, 'support': 177929}}
[[23478  5779  4841]
 [32200 52290 25820]
 [10460  5626 17435]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
4192/4192 - 75s - 75s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0110838
{'0': {'precision': 0.40270145134295443, 'recall': 0.7702648996260425, 'f1-score': 0.5288929094030611, 'support': 319555}, '1': {'precision': 0.6353835827248616, 'recall': 0.3531895627959039, 'f1-score': 0.4540096012259621, 'support': 439543}, '2': {'precision': 0.48961602978009605, 'recall': 0.3392368142855323, 'f1-score': 0.4007847312220326, 'support': 314052}, 'accuracy': 0.47330009784279925, 'macro avg': {'precision': 0.509233687949304, 'recall': 0.48756375890249287, 'f1-score': 0.46122908061701856, 'support': 1073150}, 'weighted avg': {'precision': 0.5234389989936451, 'recall': 0.47330009784279925, 'f1-score': 0.460731828938825, 'support': 1073150}}
[[246142  39244  34169]
 [207413 155242  76888]
 [157672  49842 106538]]
Evaluating performance on  train set...
1230/1230 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0198114
{'0': {'precision': 0.4292712607454327, 'recall': 0.7777139196140873, 'f1-score': 0.5531969078072172, 'support': 106138}, '1': {'precision': 0.5988762853811088, 'recall': 0.2722689723644005, 'f1-score': 0.3743472844382008, 'support': 103743}, '2': {'precision': 0.5144342337324793, 'recall': 0.36951593545806105, 'f1-score': 0.43009584416592295, 'support': 104986}, 'accuracy': 0.4750736025051847, 'macro avg': {'precision': 0.5141939266196736, 'recall': 0.473166275812183, 'f1-score': 0.45254667880378036, 'support': 314867}, 'weighted avg': {'precision': 0.5135489206869224, 'recall': 0.4750736025051847, 'f1-score': 0.45322363418814376, 'support': 314867}}
[[82545  8090 15503]
 [54383 28246 21114]
 [55363 10829 38794]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0263803
{'0': {'precision': 0.4208580692658323, 'recall': 0.7899100370435703, 'f1-score': 0.5491390322415819, 'support': 34014}, '1': {'precision': 0.5972204988211937, 'recall': 0.2837435519528371, 'f1-score': 0.3847091501308874, 'support': 33925}, '2': {'precision': 0.507852463429956, 'recall': 0.3299131347286189, 'f1-score': 0.3999858637263217, 'support': 34306}, 'accuracy': 0.4676218886009096, 'macro avg': {'precision': 0.5086436771723273, 'recall': 0.46785557457500876, 'f1-score': 0.444611348699597, 'support': 102245}, 'weighted avg': {'precision': 0.5085643151346774, 'recall': 0.4676218886009096, 'f1-score': 0.44453604579051015, 'support': 102245}}
[[26868  2660  4486]
 [17817  9626  6482]
 [19156  3832 11318]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
6143/6143 - 110s - 110s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9598619
{'0': {'precision': 0.43731964505372933, 'recall': 0.7336104844448578, 'f1-score': 0.5479785148282099, 'support': 462323}, '1': {'precision': 0.6440143366093102, 'recall': 0.4573700227361915, 'f1-score': 0.5348774917277228, 'support': 654903}, '2': {'precision': 0.5370157754373277, 'recall': 0.3914241031813669, 'f1-score': 0.45280458785879174, 'support': 455276}, 'accuracy': 0.5194931389594417, 'macro avg': {'precision': 0.5394499190334557, 'recall': 0.5274682034541387, 'f1-score': 0.5118868648049082, 'support': 1572502}, 'weighted avg': {'precision': 0.5522665443520117, 'recall': 0.5194931389594417, 'f1-score': 0.5149672346476396, 'support': 1572502}}
[[339165  71576  51582]
 [253313 299533 102057]
 [183076  93994 178206]]
Evaluating performance on  train set...
2083/2083 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0012026
{'0': {'precision': 0.4369552623741151, 'recall': 0.7541050277057597, 'f1-score': 0.5533055933158715, 'support': 177039}, '1': {'precision': 0.6152234286802819, 'recall': 0.3394346719769886, 'f1-score': 0.4374930932087081, 'support': 180780}, '2': {'precision': 0.5127443547315518, 'recall': 0.3740065451145395, 'f1-score': 0.4325222442366081, 'support': 175398}, 'accuracy': 0.48848592599260715, 'macro avg': {'precision': 0.5216410152619829, 'recall': 0.489182081599096, 'f1-score': 0.4744403102537292, 'support': 533217}, 'weighted avg': {'precision': 0.5223249605010287, 'recall': 0.48848592599260715, 'f1-score': 0.47431009686475, 'support': 533217}}
[[133506  16781  26752]
 [ 83830  61363  35587]
 [ 88201  21597  65600]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99140406
{'0': {'precision': 0.4333295593729736, 'recall': 0.7410582271351123, 'f1-score': 0.5468763192590717, 'support': 56812}, '1': {'precision': 0.6078483644797527, 'recall': 0.3703866146848603, 'f1-score': 0.4602961512450667, 'support': 61560}, '2': {'precision': 0.5156400444389582, 'recall': 0.36770479392968436, 'f1-score': 0.42928493618070834, 'support': 56801}, 'accuracy': 0.489733006798993, 'macro avg': {'precision': 0.5189393227638949, 'recall': 0.49304987858321897, 'f1-score': 0.47881913556161554, 'support': 175173}, 'weighted avg': {'precision': 0.521349376951061, 'recall': 0.489733006798993, 'f1-score': 0.4783201873598848, 'support': 175173}}
[[42101  6357  8354]
 [27494 22801 11265]
 [27562  8353 20886]]
testing model on single stock: results/universal/W7/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
23942/23942 - 423s - 423s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1095947
{'0': {'precision': 0.3644749004239636, 'recall': 0.5197565008220072, 'f1-score': 0.4284810483203184, 'support': 1923949}, '1': {'precision': 0.41429149526665116, 'recall': 0.2830831988532104, 'f1-score': 0.3363441854906365, 'support': 2296498}, '2': {'precision': 0.38905005761881506, 'recall': 0.3702214745022181, 'f1-score': 0.3794023083795811, 'support': 1908617}, 'accuracy': 0.38451156652957125, 'macro avg': {'precision': 0.3892721511031432, 'recall': 0.3910203913924786, 'f1-score': 0.38140918073017865, 'support': 6129064}, 'weighted avg': {'precision': 0.3907934823840815, 'recall': 0.38451156652957125, 'f1-score': 0.37867497049112475, 'support': 6129064}}
[[999985 493224 430740]
 [967502 650100 678896]
 [776145 425861 706611]]
Evaluating performance on  train set...
9052/9052 - 161s - 161s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1234906
{'0': {'precision': 0.37254433148836724, 'recall': 0.7425361006038458, 'f1-score': 0.4961572407586875, 'support': 772217}, '1': {'precision': 0.4352067159958058, 'recall': 0.16923573613358475, 'f1-score': 0.24370402407163702, 'support': 777454}, '2': {'precision': 0.424024524088862, 'recall': 0.26279597971876795, 'f1-score': 0.32448635302806145, 'support': 767409}, 'accuracy': 0.391287309890034, 'macro avg': {'precision': 0.41059185719101166, 'recall': 0.3915226054853995, 'f1-score': 0.35478253928612863, 'support': 2317080}, 'weighted avg': {'precision': 0.4106196178868512, 'recall': 0.391287309890034, 'f1-score': 0.35459434806241197, 'support': 2317080}}
[[573399  82525 116293]
 [488232 131573 157649]
 [477512  88225 201672]]
Evaluating performance on  val set...
2763/2763 - 49s - 49s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1144053
{'0': {'precision': 0.37329865731220513, 'recall': 0.660286446632519, 'f1-score': 0.47694968325036585, 'support': 233691}, '1': {'precision': 0.41423651121269295, 'recall': 0.27552502916243793, 'f1-score': 0.3309332867992382, 'support': 237463}, '2': {'precision': 0.41528021820480965, 'recall': 0.23918428529689492, 'f1-score': 0.3035412972217744, 'support': 236161}, 'accuracy': 0.39051342047037035, 'macro avg': {'precision': 0.4009384622432359, 'recall': 0.39166525369728394, 'f1-score': 0.3704747557571262, 'support': 707315}, 'weighted avg': {'precision': 0.4010594612011795, 'recall': 0.39051342047037035, 'f1-score': 0.3700301503642086, 'support': 707315}}
[[154303  45610  33778]
 [126281  65427  45755]
 [132766  46909  56486]]
training model: results/universal/W7/deepOF_L2/h10
Epoch 1/50
12475/12475 - 278s - loss: 2.8372 - accuracy10: 0.5297 - val_loss: 3.0362 - val_accuracy10: 0.5012 - 278s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 263s - loss: 2.7678 - accuracy10: 0.5473 - val_loss: 2.9591 - val_accuracy10: 0.5128 - 263s/epoch - 21ms/step
Epoch 3/50
12475/12475 - 262s - loss: 2.7461 - accuracy10: 0.5524 - val_loss: 2.9172 - val_accuracy10: 0.5219 - 262s/epoch - 21ms/step
Epoch 4/50
12475/12475 - 262s - loss: 2.7327 - accuracy10: 0.5552 - val_loss: 2.8872 - val_accuracy10: 0.5265 - 262s/epoch - 21ms/step
Epoch 5/50
12475/12475 - 264s - loss: 2.7223 - accuracy10: 0.5576 - val_loss: 2.8684 - val_accuracy10: 0.5295 - 264s/epoch - 21ms/step
Epoch 6/50
12475/12475 - 262s - loss: 2.7143 - accuracy10: 0.5597 - val_loss: 2.8584 - val_accuracy10: 0.5300 - 262s/epoch - 21ms/step
Epoch 7/50
12475/12475 - 264s - loss: 2.7070 - accuracy10: 0.5613 - val_loss: 2.8526 - val_accuracy10: 0.5297 - 264s/epoch - 21ms/step
Epoch 8/50
12475/12475 - 264s - loss: 2.7015 - accuracy10: 0.5624 - val_loss: 2.8460 - val_accuracy10: 0.5302 - 264s/epoch - 21ms/step
Epoch 9/50
12475/12475 - 264s - loss: 2.6961 - accuracy10: 0.5637 - val_loss: 2.8409 - val_accuracy10: 0.5297 - 264s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 263s - loss: 2.6915 - accuracy10: 0.5650 - val_loss: 2.8389 - val_accuracy10: 0.5280 - 263s/epoch - 21ms/step
Epoch 11/50
12475/12475 - 265s - loss: 2.6874 - accuracy10: 0.5656 - val_loss: 2.8314 - val_accuracy10: 0.5298 - 265s/epoch - 21ms/step
Epoch 12/50
12475/12475 - 262s - loss: 2.6835 - accuracy10: 0.5665 - val_loss: 2.8313 - val_accuracy10: 0.5283 - 262s/epoch - 21ms/step
Epoch 13/50
12475/12475 - 263s - loss: 2.6802 - accuracy10: 0.5673 - val_loss: 2.8238 - val_accuracy10: 0.5306 - 263s/epoch - 21ms/step
Epoch 14/50
12475/12475 - 262s - loss: 2.6769 - accuracy10: 0.5679 - val_loss: 2.8311 - val_accuracy10: 0.5282 - 262s/epoch - 21ms/step
Epoch 15/50
12475/12475 - 262s - loss: 2.6743 - accuracy10: 0.5684 - val_loss: 2.8254 - val_accuracy10: 0.5302 - 262s/epoch - 21ms/step
Epoch 16/50
12475/12475 - 262s - loss: 2.6715 - accuracy10: 0.5692 - val_loss: 2.8237 - val_accuracy10: 0.5293 - 262s/epoch - 21ms/step
Epoch 17/50
12475/12475 - 263s - loss: 2.6693 - accuracy10: 0.5696 - val_loss: 2.8256 - val_accuracy10: 0.5292 - 263s/epoch - 21ms/step
Epoch 18/50
12475/12475 - 262s - loss: 2.6670 - accuracy10: 0.5701 - val_loss: 2.8278 - val_accuracy10: 0.5278 - 262s/epoch - 21ms/step
Epoch 19/50
12475/12475 - 265s - loss: 2.6649 - accuracy10: 0.5706 - val_loss: 2.8320 - val_accuracy10: 0.5269 - 265s/epoch - 21ms/step
Epoch 20/50
12475/12475 - 265s - loss: 2.6625 - accuracy10: 0.5712 - val_loss: 2.8198 - val_accuracy10: 0.5299 - 265s/epoch - 21ms/step
Epoch 21/50
12475/12475 - 266s - loss: 2.6605 - accuracy10: 0.5715 - val_loss: 2.8192 - val_accuracy10: 0.5303 - 266s/epoch - 21ms/step
Epoch 22/50
12475/12475 - 265s - loss: 2.6589 - accuracy10: 0.5718 - val_loss: 2.8221 - val_accuracy10: 0.5303 - 265s/epoch - 21ms/step
Epoch 23/50
12475/12475 - 264s - loss: 2.6574 - accuracy10: 0.5721 - val_loss: 2.8188 - val_accuracy10: 0.5303 - 264s/epoch - 21ms/step
Epoch 24/50
12475/12475 - 265s - loss: 2.6554 - accuracy10: 0.5726 - val_loss: 2.8205 - val_accuracy10: 0.5305 - 265s/epoch - 21ms/step
Epoch 25/50
12475/12475 - 267s - loss: 2.6540 - accuracy10: 0.5729 - val_loss: 2.8200 - val_accuracy10: 0.5303 - 267s/epoch - 21ms/step
Epoch 26/50
12475/12475 - 265s - loss: 2.6522 - accuracy10: 0.5733 - val_loss: 2.8252 - val_accuracy10: 0.5283 - 265s/epoch - 21ms/step
Epoch 27/50
12475/12475 - 264s - loss: 2.6510 - accuracy10: 0.5735 - val_loss: 2.8249 - val_accuracy10: 0.5278 - 264s/epoch - 21ms/step
Epoch 28/50
12475/12475 - 266s - loss: 2.6493 - accuracy10: 0.5739 - val_loss: 2.8232 - val_accuracy10: 0.5293 - 266s/epoch - 21ms/step
Epoch 29/50
12475/12475 - 265s - loss: 2.6481 - accuracy10: 0.5744 - val_loss: 2.8235 - val_accuracy10: 0.5290 - 265s/epoch - 21ms/step
Epoch 30/50
12475/12475 - 266s - loss: 2.6468 - accuracy10: 0.5746 - val_loss: 2.8235 - val_accuracy10: 0.5299 - 266s/epoch - 21ms/step
Epoch 31/50
12475/12475 - 266s - loss: 2.6455 - accuracy10: 0.5750 - val_loss: 2.8272 - val_accuracy10: 0.5282 - 266s/epoch - 21ms/step
Epoch 32/50
12475/12475 - 265s - loss: 2.6442 - accuracy10: 0.5751 - val_loss: 2.8321 - val_accuracy10: 0.5271 - 265s/epoch - 21ms/step
Epoch 33/50
12475/12475 - 266s - loss: 2.6432 - accuracy10: 0.5754 - val_loss: 2.8303 - val_accuracy10: 0.5279 - 266s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 278s - 278s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92607087
{'0': {'precision': 0.43371186622569535, 'recall': 0.5518973272016787, 'f1-score': 0.4857187236925894, 'support': 2416531}, '1': {'precision': 0.7360560755498093, 'recall': 0.5352261271188428, 'f1-score': 0.6197781135169401, 'support': 4691830}, '2': {'precision': 0.4339503265167942, 'recall': 0.5464840859240793, 'f1-score': 0.4837589226036831, 'support': 2397186}, 'accuracy': 0.5423034571287692, 'macro avg': {'precision': 0.5345727560974329, 'recall': 0.5445358467482002, 'f1-score': 0.5297519199377375, 'support': 9505547}, 'weighted avg': {'precision': 0.5830056696548442, 'recall': 0.5423034571287692, 'f1-score': 0.5513946768204286, 'support': 9505547}}
[[1333677  438435  644419]
 [1116249 2511190 1064391]
 [ 625104  462058 1310024]]
Evaluating performance on  train set...
12475/12475 - 96s - 96s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9400705
{'0': {'precision': 0.47593776190259435, 'recall': 0.5598091850682276, 'f1-score': 0.5144776557886261, 'support': 952546}, '1': {'precision': 0.6832795197134425, 'recall': 0.5014396951687486, 'f1-score': 0.5784045194442604, 'support': 1296455}, '2': {'precision': 0.4721366274273371, 'recall': 0.560736041657619, 'f1-score': 0.5126363229646215, 'support': 944077}, 'accuracy': 0.5363840156739046, 'macro avg': {'precision': 0.5437846363477913, 'recall': 0.5406616406315318, 'f1-score': 0.5351728327325027, 'support': 3193078}, 'weighted avg': {'precision': 0.5589989007130668, 'recall': 0.5363840156739046, 'f1-score': 0.5398888552808332, 'support': 3193078}}
[[533244 153528 265774]
 [320274 650094 326087]
 [266889 147810 529378]]
Evaluating performance on  val set...
3866/3866 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94596255
{'0': {'precision': 0.45529329997219903, 'recall': 0.5739936561344479, 'f1-score': 0.5077990434330983, 'support': 285315}, '1': {'precision': 0.6950379107277709, 'recall': 0.49332875042964724, 'f1-score': 0.5770646303163897, 'support': 416039}, '2': {'precision': 0.46603551145714267, 'recall': 0.5410860630821235, 'f1-score': 0.5007644092346423, 'support': 287847}, 'accuracy': 0.5304917807402135, 'macro avg': {'precision': 0.5387889073857042, 'recall': 0.5361361565487396, 'f1-score': 0.5285426943280435, 'support': 989201}, 'weighted avg': {'precision': 0.5592511623919134, 'recall': 0.5304917807402135, 'f1-score': 0.5348838190764859, 'support': 989201}}
[[163769  42789  78757]
 [111100 205244  99695]
 [ 84831  47266 155750]]
testing model out of sample: results/universal/W7/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 111s - 111s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7271471
{'0': {'precision': 0.4775918724859548, 'recall': 0.4795966245316713, 'f1-score': 0.47859214911523623, 'support': 713975}, '1': {'precision': 0.7774211116371834, 'recall': 0.8108932805649852, 'f1-score': 0.7938044995259504, 'support': 2344840}, '2': {'precision': 0.5069137009846811, 'recall': 0.43325617607509975, 'f1-score': 0.46719959243011294, 'support': 715422}, 'accuracy': 0.6766390133952902, 'macro avg': {'precision': 0.5873088950359399, 'recall': 0.574582027057252, 'f1-score': 0.5798654136904332, 'support': 3774237}, 'weighted avg': {'precision': 0.669426427210415, 'recall': 0.6766390133952902, 'f1-score': 0.6722662724011547, 'support': 3774237}}
[[ 342420  262044  109511]
 [ 251430 1901415  191995]
 [ 123122  282339  309961]]
Evaluating performance on  train set...
5285/5285 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78901494
{'0': {'precision': 0.5097866761133438, 'recall': 0.4241828758838696, 'f1-score': 0.46306173022154823, 'support': 295151}, '1': {'precision': 0.7331248566160279, 'recall': 0.7792730762810883, 'f1-score': 0.7554948997039762, 'support': 766848}, '2': {'precision': 0.46975826479544824, 'recall': 0.47184489402697494, 'f1-score': 0.47079926738543454, 'support': 290640}, 'accuracy': 0.6357342942204092, 'macro avg': {'precision': 0.5708899325082734, 'recall': 0.558433615397311, 'f1-score': 0.5631186324369862, 'support': 1352639}, 'weighted avg': {'precision': 0.6278023326016523, 'recall': 0.6357342942204092, 'f1-score': 0.6305126383741099, 'support': 1352639}}
[[125198 112851  57102]
 [ 71572 597584  97692]
 [ 48819 104684 137137]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74973917
{'0': {'precision': 0.5112781954887218, 'recall': 0.4413823659725299, 'f1-score': 0.4737661843560142, 'support': 90280}, '1': {'precision': 0.7536330256017735, 'recall': 0.8113152545271513, 'f1-score': 0.7814110891074283, 'support': 257281}, '2': {'precision': 0.49532001924927815, 'recall': 0.45507903172322317, 'f1-score': 0.4743476006682413, 'support': 90470}, 'accuracy': 0.661494277802256, 'macro avg': {'precision': 0.5867437467799245, 'recall': 0.5692588840743015, 'f1-score': 0.5765082913772279, 'support': 438031}, 'weighted avg': {'precision': 0.6503312689970662, 'recall': 0.661494277802256, 'f1-score': 0.6545839563244724, 'support': 438031}}
[[ 39848  34112  16320]
 [ 22916 208736  25629]
 [ 15174  34125  41171]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0095686
{'0': {'precision': 0.4203186480036122, 'recall': 0.6167606860258206, 'f1-score': 0.49993478644478706, 'support': 52826}, '1': {'precision': 0.6717615982355808, 'recall': 0.36011933403907226, 'f1-score': 0.4688803365255526, 'support': 72737}, '2': {'precision': 0.451743173047174, 'recall': 0.5298724119489647, 'f1-score': 0.4876985417563968, 'support': 52356}, 'accuracy': 0.4862718428048719, 'macro avg': {'precision': 0.514607806428789, 'recall': 0.5022508106712859, 'f1-score': 0.48550455490891214, 'support': 177919}, 'weighted avg': {'precision': 0.5323610285487109, 'recall': 0.4862718428048719, 'f1-score': 0.48363833496585157, 'support': 177919}}
[[32581  6301 13944]
 [26818 26194 19725]
 [18116  6498 27742]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0499994
{'0': {'precision': 0.4433400969838704, 'recall': 0.5498165998464557, 'f1-score': 0.49087066618433833, 'support': 23446}, '1': {'precision': 0.5752912923596905, 'recall': 0.2523211359912616, 'f1-score': 0.3507877538845351, 'support': 25634}, '2': {'precision': 0.4274168087390289, 'recall': 0.5908178406214541, 'f1-score': 0.4960064483036564, 'support': 22914}, 'accuracy': 0.45694085618245966, 'macro avg': {'precision': 0.4820160660275299, 'recall': 0.46431852548639047, 'f1-score': 0.44588828945750997, 'support': 71994}, 'weighted avg': {'precision': 0.4852542942144934, 'recall': 0.45694085618245966, 'f1-score': 0.44262770062594314, 'support': 71994}}
[[12891  2451  8104]
 [ 9134  6468 10032]
 [ 7052  2324 13538]]
Evaluating performance on  val set...
73/73 - 1s - 752ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0502452
{'0': {'precision': 0.44403669724770645, 'recall': 0.5374103177314656, 'f1-score': 0.4862817837545405, 'support': 5854}, '1': {'precision': 0.5656424581005587, 'recall': 0.25092936802973975, 'f1-score': 0.34763948497854075, 'support': 6456}, '2': {'precision': 0.4324103283093819, 'recall': 0.5971281058405937, 'f1-score': 0.5015924645930745, 'support': 6198}, 'accuracy': 0.45747784741733305, 'macro avg': {'precision': 0.480696494552549, 'recall': 0.46182259720059965, 'f1-score': 0.4451712444420519, 'support': 18508}, 'weighted avg': {'precision': 0.4825620137263253, 'recall': 0.45747784741733305, 'f1-score': 0.4430475563360934, 'support': 18508}}
[[3146  635 2073]
 [2051 1620 2785]
 [1888  609 3701]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50587237
{'0': {'precision': 0.5484208830164357, 'recall': 0.4226375263876816, 'f1-score': 0.4773827056595834, 'support': 48318}, '1': {'precision': 0.8939842573516504, 'recall': 0.9282932257615802, 'f1-score': 0.9108157651372002, 'support': 416962}, '2': {'precision': 0.5304115942028985, 'recall': 0.4760953272973254, 'f1-score': 0.5017878688164966, 'support': 48045}, 'accuracy': 0.8383733502167243, 'macro avg': {'precision': 0.6576055781903282, 'recall': 0.6090086931488624, 'f1-score': 0.6299954465377601, 'support': 513325}, 'weighted avg': {'precision': 0.8274284112071792, 'recall': 0.8383733502167243, 'f1-score': 0.8317345517800333, 'support': 513325}}
[[ 20421  24449   3448]
 [ 13096 387063  16803]
 [  3719  21452  22874]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5247648
{'0': {'precision': 0.6087832820621619, 'recall': 0.39573851882498967, 'f1-score': 0.47966902085335783, 'support': 14502}, '1': {'precision': 0.8817364601280118, 'recall': 0.9055678307188764, 'f1-score': 0.8934932653079687, 'support': 109073}, '2': {'precision': 0.44762851992291913, 'recall': 0.5158309455587392, 'f1-score': 0.4793157386760741, 'support': 13960}, 'accuracy': 0.8122514269095139, 'macro avg': {'precision': 0.6460494207043642, 'recall': 0.6057124317008684, 'f1-score': 0.6174926749458002, 'support': 137535}, 'weighted avg': {'precision': 0.8088930832888506, 'recall': 0.8122514269095139, 'f1-score': 0.8078190917167953, 'support': 137535}}
[[ 5739  7413  1350]
 [ 2764 98773  7536]
 [  924  5835  7201]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53883755
{'0': {'precision': 0.5519658640658336, 'recall': 0.4168968692449355, 'f1-score': 0.475016393442623, 'support': 4344}, '1': {'precision': 0.8767061550347669, 'recall': 0.8980116727668415, 'f1-score': 0.8872310273492857, 'support': 30327}, '2': {'precision': 0.4756641870350691, 'recall': 0.5110755880337977, 'f1-score': 0.49273447820343463, 'support': 4379}, 'accuracy': 0.801101152368758, 'macro avg': {'precision': 0.6347787353785564, 'recall': 0.6086613766818583, 'f1-score': 0.6183272996651145, 'support': 39050}, 'weighted avg': {'precision': 0.7956092382142874, 'recall': 0.801101152368758, 'f1-score': 0.7971372819357075, 'support': 39050}}
[[ 1811  2043   490]
 [ 1116 27234  1977]
 [  354  1787  2238]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98546404
{'0': {'precision': 0.45453092961947117, 'recall': 0.48944772609967313, 'f1-score': 0.47134355972220304, 'support': 69748}, '1': {'precision': 0.5692401350379103, 'recall': 0.5362278040184763, 'f1-score': 0.5522410497605396, 'support': 95907}, '2': {'precision': 0.4815627198609444, 'recall': 0.4829217680016601, 'f1-score': 0.4822412864188321, 'support': 72285}, 'accuracy': 0.5063209212406489, 'macro avg': {'precision': 0.5017779281727753, 'recall': 0.5028657660399366, 'f1-score': 0.5019419653005249, 'support': 237940}, 'weighted avg': {'precision': 0.5089791464878882, 'recall': 0.5063209212406489, 'f1-score': 0.507261764947775, 'support': 237940}}
[[34138 19538 16072]
 [22970 51428 21509]
 [17998 19379 34908]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.989237
{'0': {'precision': 0.5143942271173566, 'recall': 0.4313925340807746, 'f1-score': 0.4692512905796348, 'support': 31396}, '1': {'precision': 0.5156178343949045, 'recall': 0.5778158458244111, 'f1-score': 0.5449478290138001, 'support': 35025}, '2': {'precision': 0.4904508453350031, 'recall': 0.5037139457860381, 'f1-score': 0.49699392439600887, 'support': 31099}, 'accuracy': 0.5070447087776866, 'macro avg': {'precision': 0.5068209689490881, 'recall': 0.5043074418970747, 'f1-score': 0.503731014663148, 'support': 97520}, 'weighted avg': {'precision': 0.5071981813303047, 'recall': 0.5070447087776866, 'f1-score': 0.505285329009824, 'support': 97520}}
[[13544  9949  7903]
 [ 6415 20238  8372]
 [ 6371  9063 15665]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0136071
{'0': {'precision': 0.5159491701244814, 'recall': 0.41020618556701033, 'f1-score': 0.4570411210659316, 'support': 9700}, '1': {'precision': 0.47812442311242387, 'recall': 0.5293276108726752, 'f1-score': 0.5024248302618818, 'support': 9786}, '2': {'precision': 0.4831450004747887, 'recall': 0.5304973412574289, 'f1-score': 0.5057151376602723, 'support': 9591}, 'accuracy': 0.4899748942463115, 'macro avg': {'precision': 0.492406197903898, 'recall': 0.4900103792323714, 'f1-score': 0.48839369632936186, 'support': 29077}, 'weighted avg': {'precision': 0.492398674359093, 'recall': 0.4899748942463115, 'f1-score': 0.4883702633896888, 'support': 29077}}
[[3979 3000 2721]
 [1884 5180 2722]
 [1849 2654 5088]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2314403
{'0': {'precision': 0.38740454695680915, 'recall': 0.5051028507926428, 'f1-score': 0.43849304010553053, 'support': 88186}, '1': {'precision': 0.6024096385542169, 'recall': 0.0005180649238962627, 'f1-score': 0.001035239554432896, 'support': 96513}, '2': {'precision': 0.3699432616002389, 'recall': 0.663525201992, 'f1-score': 0.4750346740638003, 'support': 87751}, 'accuracy': 0.3773830060561571, 'macro avg': {'precision': 0.45325248237042165, 'recall': 0.38971537256951305, 'f1-score': 0.3048543179079212, 'support': 272450}, 'weighted avg': {'precision': 0.4579442465494545, 'recall': 0.3773830060561571, 'f1-score': 0.2952968581157491, 'support': 272450}}
[[44543     9 43634]
 [40933    50 55530]
 [29502    24 58225]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.201981
{'0': {'precision': 0.4061209119748043, 'recall': 0.5005766688233143, 'f1-score': 0.4484287982259406, 'support': 35549}, '1': {'precision': 0.7794117647058824, 'recall': 0.007861868454623668, 'f1-score': 0.015566716597644432, 'support': 33707}, '2': {'precision': 0.37419410004275333, 'recall': 0.6555908437200384, 'f1-score': 0.47644554768048253, 'support': 33376}, 'accuracy': 0.38916712136565595, 'macro avg': {'precision': 0.51990892557448, 'recall': 0.38800979366599214, 'f1-score': 0.3134803541680225, 'support': 102632}, 'weighted avg': {'precision': 0.5183366487621837, 'recall': 0.38916712136565595, 'f1-score': 0.315376775897133, 'support': 102632}}
[[17795    57 17697]
 [14545   265 18897]
 [11477    18 21881]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2175988
{'0': {'precision': 0.3573275602862469, 'recall': 0.5874443895205141, 'f1-score': 0.444361352078971, 'support': 10115}, '1': {'precision': 0.5714285714285714, 'recall': 0.00037407649864397267, 'f1-score': 0.0007476635514018691, 'support': 10693}, '2': {'precision': 0.3964055612071889, 'recall': 0.552823228979476, 'f1-score': 0.46172683466308556, 'support': 10573}, 'accuracy': 0.3757369108696345, 'macro avg': {'precision': 0.4417205643073357, 'recall': 0.38021389833287805, 'f1-score': 0.30227861676448614, 'support': 31381}, 'weighted avg': {'precision': 0.4434482644028141, 'recall': 0.3757369108696345, 'f1-score': 0.2990518997331741, 'support': 31381}}
[[5942    2 4171]
 [5960    4 4729]
 [4727    1 5845]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0475361
{'0': {'precision': 0.41960205500837333, 'recall': 0.5730022636360818, 'f1-score': 0.48444868278327785, 'support': 128996}, '1': {'precision': 0.6129449141134026, 'recall': 0.28216950497012966, 'f1-score': 0.3864407930472569, 'support': 161364}, '2': {'precision': 0.43156502244777306, 'recall': 0.5631607088298197, 'f1-score': 0.488658242781539, 'support': 130920}, 'accuracy': 0.45854538549183443, 'macro avg': {'precision': 0.48803733052318304, 'recall': 0.472777492478677, 'f1-score': 0.4531825728706913, 'support': 421280}, 'weighted avg': {'precision': 0.4973763828041153, 'recall': 0.45854538549183443, 'f1-score': 0.4482166529589545, 'support': 421280}}
[[73915 14477 40604]
 [59324 45532 56508]
 [42916 14275 73729]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0555112
{'0': {'precision': 0.45492776106012744, 'recall': 0.5271821529131471, 'f1-score': 0.4883970583809055, 'support': 46170}, '1': {'precision': 0.5278770347683058, 'recall': 0.21791659837504976, 'f1-score': 0.30848525024859136, 'support': 42709}, '2': {'precision': 0.4355313952572284, 'recall': 0.6045713035870516, 'f1-score': 0.5063149700050373, 'support': 45720}, 'accuracy': 0.4553377068180299, 'macro avg': {'precision': 0.47277873036188717, 'recall': 0.4498900182917495, 'f1-score': 0.4343990928781781, 'support': 134599}, 'weighted avg': {'precision': 0.47148649244961804, 'recall': 0.4553377068180299, 'f1-score': 0.43739633405109846, 'support': 134599}}
[[24340  4364 17466]
 [15044  9307 18358]
 [14119  3960 27641]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0354983
{'0': {'precision': 0.45752778713371506, 'recall': 0.533417105159821, 'f1-score': 0.49256653854521726, 'support': 12733}, '1': {'precision': 0.5446927374301676, 'recall': 0.2534222838329579, 'f1-score': 0.34590823084200567, 'support': 11542}, '2': {'precision': 0.45460914239009864, 'recall': 0.5958374780013773, 'f1-score': 0.5157295185111597, 'support': 13069}, 'accuracy': 0.46872322193658955, 'macro avg': {'precision': 0.48560988898466045, 'recall': 0.46089228899805207, 'f1-score': 0.45140142929946087, 'support': 37344}, 'weighted avg': {'precision': 0.48344665196253184, 'recall': 0.46872322193658955, 'f1-score': 0.45534467687170693, 'support': 37344}}
[[6792 1217 4724]
 [3999 2925 4618]
 [4054 1228 7787]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/EXC
Evaluating performance on  test set...
5928/5928 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5809805
{'0': {'precision': 0.43269658690219437, 'recall': 0.4294475400924164, 'f1-score': 0.431065941374077, 'support': 176592}, '1': {'precision': 0.8712757278052211, 'recall': 0.8368396054136452, 'f1-score': 0.853710545281527, 'support': 1166386}, '2': {'precision': 0.3919807581435572, 'recall': 0.498459247379575, 'f1-score': 0.43885367341895987, 'support': 174590}, 'accuracy': 0.7505040960273279, 'macro avg': {'precision': 0.5653176909503242, 'recall': 0.5882487976285455, 'f1-score': 0.5745433866915213, 'support': 1517568}, 'weighted avg': {'precision': 0.7650994797533531, 'recall': 0.7505040960273279, 'f1-score': 0.7568018616826966, 'support': 1517568}}
[[ 75837  74045  26710]
 [ 82028 976078 108280]
 [ 17401  70163  87026]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5660238
{'0': {'precision': 0.4821075244502233, 'recall': 0.42135428246745227, 'f1-score': 0.44968822916803985, 'support': 40479}, '1': {'precision': 0.842242418319815, 'recall': 0.8629057490060948, 'f1-score': 0.8524488824507576, 'support': 239711}, '2': {'precision': 0.46382138213821383, 'recall': 0.45494898960172653, 'f1-score': 0.4593423463576487, 'support': 40776}, 'accuracy': 0.7553915367982902, 'macro avg': {'precision': 0.5960571083027507, 'recall': 0.5797363403584245, 'f1-score': 0.587159819325482, 'support': 320966}, 'weighted avg': {'precision': 0.7487484141564824, 'recall': 0.7553915367982902, 'f1-score': 0.7517134132734498, 'support': 320966}}
[[ 17056  19707   3716]
 [ 15134 206848  17729]
 [  3188  19037  18551]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54037267
{'0': {'precision': 0.4690440420653119, 'recall': 0.4595243628476257, 'f1-score': 0.4642354046016591, 'support': 12909}, '1': {'precision': 0.8576918529029206, 'recall': 0.8718463406132433, 'f1-score': 0.8647111768106958, 'support': 83197}, '2': {'precision': 0.4815741203935301, 'recall': 0.440747806180847, 'f1-score': 0.4602573807721423, 'support': 13105}, 'accuracy': 0.7713783410096052, 'macro avg': {'precision': 0.6027700051205875, 'recall': 0.590706169880572, 'f1-score': 0.5964013207281657, 'support': 109211}, 'weighted avg': {'precision': 0.7666197312792907, 'recall': 0.7713783410096052, 'f1-score': 0.7688407174198679, 'support': 109211}}
[[ 5932  5794  1183]
 [ 5627 72535  5035]
 [ 1088  6241  5776]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/AAL
Evaluating performance on  test set...
5331/5331 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5396247
{'0': {'precision': 0.4840240130980535, 'recall': 0.45575821525474824, 'f1-score': 0.4694660394603579, 'support': 145948}, '1': {'precision': 0.8663410925515976, 'recall': 0.9046452461319192, 'f1-score': 0.8850789345875265, 'support': 1070686}, '2': {'precision': 0.5216534892030307, 'recall': 0.3848087749295451, 'f1-score': 0.4429017027201519, 'support': 147967}, 'accuracy': 0.8002683568310444, 'macro avg': {'precision': 0.6240061982842272, 'recall': 0.5817374121054041, 'f1-score': 0.5991488922560121, 'support': 1364601}, 'weighted avg': {'precision': 0.7880758679791672, 'recall': 0.8002683568310444, 'f1-score': 0.7926815896597859, 'support': 1364601}}
[[ 66517  68345  11086]
 [ 60969 968591  41126]
 [  9939  81089  56939]]
Evaluating performance on  train set...
2013/2013 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6068121
{'0': {'precision': 0.5428765383436255, 'recall': 0.3701143590815443, 'f1-score': 0.4401498473119807, 'support': 66982}, '1': {'precision': 0.8366475407352035, 'recall': 0.8653006320848352, 'f1-score': 0.8507328923310804, 'support': 382860}, '2': {'precision': 0.4183950483222934, 'recall': 0.4708254414370379, 'f1-score': 0.4430645393129222, 'support': 65468}, 'accuracy': 0.7508179542411364, 'macro avg': {'precision': 0.5993063758003742, 'recall': 0.5687468108678058, 'f1-score': 0.5779824263186611, 'support': 515310}, 'weighted avg': {'precision': 0.74532479626007, 'recall': 0.7508179542411364, 'f1-score': 0.7455711348319787, 'support': 515310}}
[[ 24791  35037   7154]
 [ 15877 331289  35694]
 [  4998  29646  30824]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5500269
{'0': {'precision': 0.536096961180397, 'recall': 0.42578125, 'f1-score': 0.47461317160407435, 'support': 21504}, '1': {'precision': 0.8521001609879503, 'recall': 0.9020931553745472, 'f1-score': 0.876384279601184, 'support': 135537}, '2': {'precision': 0.49651517769713727, 'recall': 0.4126771351972424, 'f1-score': 0.4507307380585113, 'support': 20888}, 'accuracy': 0.7870723715639384, 'macro avg': {'precision': 0.6282374332884949, 'recall': 0.5801838468572632, 'f1-score': 0.6005760630879232, 'support': 177929}, 'weighted avg': {'precision': 0.7721649512152875, 'recall': 0.7870723715639384, 'f1-score': 0.7778576926922867, 'support': 177929}}
[[  9156  10704   1644]
 [  6173 122267   7097]
 [  1750  10518   8620]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/WBA
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7845294
{'0': {'precision': 0.5285378574345722, 'recall': 0.35150430341646294, 'f1-score': 0.42221461577956526, 'support': 224589}, '1': {'precision': 0.6968863066156081, 'recall': 0.8381432755039163, 'f1-score': 0.7610153947315296, 'support': 629668}, '2': {'precision': 0.514572145937699, 'recall': 0.39137367055297684, 'f1-score': 0.444596102446999, 'support': 218888}, 'accuracy': 0.6451719012808148, 'macro avg': {'precision': 0.5799987699959598, 'recall': 0.5270070831577854, 'f1-score': 0.5426087043193646, 'support': 1073145}, 'weighted avg': {'precision': 0.6244677687147785, 'recall': 0.6451719012808148, 'f1-score': 0.6255711498311488, 'support': 1073145}}
[[ 78944 118777  26868]
 [ 47969 527752  53947]
 [ 22450 110771  85667]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8526448
{'0': {'precision': 0.5540403851196943, 'recall': 0.38026792831246303, 'f1-score': 0.4509941449133935, 'support': 77782}, '1': {'precision': 0.636834441659036, 'recall': 0.7917190240989338, 'f1-score': 0.7058803954465412, 'support': 160754}, '2': {'precision': 0.5203472334901833, 'recall': 0.42013074635469205, 'f1-score': 0.4648995005834982, 'support': 76331}, 'accuracy': 0.5999961888670454, 'macro avg': {'precision': 0.5704073534229712, 'recall': 0.5307058995886963, 'f1-score': 0.5405913469811443, 'support': 314867}, 'weighted avg': {'precision': 0.5881425419284203, 'recall': 0.5999961888670454, 'f1-score': 0.5844962077585325, 'support': 314867}}
[[ 29578  37281  10923]
 [ 14844 127272  18638]
 [  8964  35298  32069]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8637478
{'0': {'precision': 0.5232422568053936, 'recall': 0.41053175834228217, 'f1-score': 0.4600846891018498, 'support': 25143}, '1': {'precision': 0.6380295629409699, 'recall': 0.7781411828836196, 'f1-score': 0.7011542644633899, 'support': 51366}, '2': {'precision': 0.5236513687600645, 'recall': 0.404336338203295, 'f1-score': 0.45632345202596036, 'support': 25736}, 'accuracy': 0.5936525013448091, 'macro avg': {'precision': 0.5616410628354759, 'recall': 0.5310030931430655, 'f1-score': 0.5391874685304, 'support': 102245}, 'weighted avg': {'precision': 0.5810122570227678, 'recall': 0.5936525013448091, 'f1-score': 0.5802468545929328, 'support': 102245}}
[[10322 11016  3805]
 [ 5735 39970  5661]
 [ 3670 11660 10406]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
6143/6143 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7329798
{'0': {'precision': 0.5393497077517647, 'recall': 0.42688896121747977, 'f1-score': 0.47657466808013, 'support': 316457}, '1': {'precision': 0.7204647224065511, 'recall': 0.857859907260106, 'f1-score': 0.7831821012365447, 'support': 944146}, '2': {'precision': 0.589626289636905, 'recall': 0.3739860337165832, 'f1-score': 0.4576778276743552, 'support': 311894}, 'accuracy': 0.6751561370228369, 'macro avg': {'precision': 0.6164802399317403, 'recall': 0.552911634064723, 'f1-score': 0.5724781989970099, 'support': 1572497}, 'weighted avg': {'precision': 0.6580653433661677, 'recall': 0.6751561370228369, 'f1-score': 0.656917378077909, 'support': 1572497}}
[[135092 153538  27827]
 [ 80845 809945  53356]
 [ 34535 160715 116644]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8249532
{'0': {'precision': 0.5483154712833196, 'recall': 0.3922945649865914, 'f1-score': 0.45736526506885733, 'support': 127157}, '1': {'precision': 0.6562367407145847, 'recall': 0.8212173045399472, 'f1-score': 0.729515708567259, 'support': 280620}, '2': {'precision': 0.5454695186226283, 'recall': 0.3960251596393466, 'f1-score': 0.4588866154606463, 'support': 125439}, 'accuracy': 0.6189049090799976, 'macro avg': {'precision': 0.5833405768735108, 'recall': 0.536512343055295, 'f1-score': 0.5485891963655876, 'support': 533216}, 'weighted avg': {'precision': 0.6044425814450498, 'recall': 0.6189049090799976, 'f1-score': 0.6009500302040316, 'support': 533216}}
[[ 49883  61003  16271]
 [ 25046 230450  25124]
 [ 16046  59716  49677]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8159694
{'0': {'precision': 0.5355372432884826, 'recall': 0.4109017263948233, 'f1-score': 0.4650129271189994, 'support': 40489}, '1': {'precision': 0.6693711613623674, 'recall': 0.8165815240527884, 'f1-score': 0.735684424500441, 'support': 93960}, '2': {'precision': 0.541498490655632, 'recall': 0.39202927020921324, 'f1-score': 0.45479795461990963, 'support': 40724}, 'accuracy': 0.6241144468611031, 'macro avg': {'precision': 0.5821356317688274, 'recall': 0.5398375068856083, 'f1-score': 0.55183176874645, 'support': 175173}, 'weighted avg': {'precision': 0.6087094831884786, 'recall': 0.6241144468611031, 'f1-score': 0.607822032140363, 'support': 175173}}
[[16637 18652  5200]
 [ 8916 76726  8318]
 [ 5513 19246 15965]]
testing model on single stock: results/universal/W7/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
23942/23942 - 177s - 177s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0579242
{'0': {'precision': 0.4287104394354465, 'recall': 0.5927931293996421, 'f1-score': 0.49757359788580796, 'support': 1878846}, '1': {'precision': 0.5633293650036914, 'recall': 0.2603990847504157, 'f1-score': 0.3561621578173801, 'support': 2382301}, '2': {'precision': 0.43467387247092776, 'recall': 0.5654500854429974, 'f1-score': 0.49151182987594827, 'support': 1867912}, 'accuracy': 0.4552618925678477, 'macro avg': {'precision': 0.4755712256366886, 'recall': 0.4728807665310184, 'f1-score': 0.4484158618597121, 'support': 6129059}, 'weighted avg': {'precision': 0.4828528402719089, 'recall': 0.4552618925678477, 'f1-score': 0.4407610489621822, 'support': 6129059}}
[[1113767  221205  543874]
 [ 932144  620349  829808]
 [ 552036  259665 1056211]]
Evaluating performance on  train set...
9052/9052 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0168389
{'0': {'precision': 0.473286967719517, 'recall': 0.5904997743020578, 'f1-score': 0.5254358539708366, 'support': 784234}, '1': {'precision': 0.5503918917545162, 'recall': 0.28752406367414135, 'f1-score': 0.37772502672920055, 'support': 753210}, '2': {'precision': 0.47587200721157663, 'recall': 0.5768976211914821, 'f1-score': 0.521537516936933, 'support': 779634}, 'accuracy': 0.4874350367143445, 'macro avg': {'precision': 0.4998502888952032, 'recall': 0.48497381972256043, 'f1-score': 0.47489946587899, 'support': 2317078}, 'weighted avg': {'precision': 0.4992211764564496, 'recall': 0.4874350367143445, 'f1-score': 0.4761079727852385, 'support': 2317078}}
[[463090  89178 231966]
 [273232 216566 263412]
 [242133  87732 449769]]
Evaluating performance on  val set...
2763/2763 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0311149
{'0': {'precision': 0.45451909386800293, 'recall': 0.5992422810604628, 'f1-score': 0.5169425736704123, 'support': 232804}, '1': {'precision': 0.5591029248742219, 'recall': 0.27267358685164855, 'f1-score': 0.36657106276871126, 'support': 240456}, '2': {'precision': 0.4651852793760795, 'recall': 0.562690661129483, 'f1-score': 0.5093132392438033, 'support': 234054}, 'accuracy': 0.4761279997285505, 'macro avg': {'precision': 0.49293576603943484, 'recall': 0.47820217634719814, 'f1-score': 0.4642756252276423, 'support': 707314}, 'weighted avg': {'precision': 0.4936025462686888, 'recall': 0.4761279997285505, 'f1-score': 0.4632982116681545, 'support': 707314}}
[[139506  24179  69119]
 [ 92596  65566  82294]
 [ 74829  27525 131700]]
training model: results/universal/W7/deepOF_L2/h20
Epoch 1/50
12475/12475 - 277s - loss: 2.9737 - accuracy20: 0.4877 - val_loss: 3.0727 - val_accuracy20: 0.4709 - 277s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 279s - loss: 2.9147 - accuracy20: 0.5039 - val_loss: 3.0574 - val_accuracy20: 0.4734 - 279s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 268s - loss: 2.8968 - accuracy20: 0.5086 - val_loss: 3.0697 - val_accuracy20: 0.4729 - 268s/epoch - 21ms/step
Epoch 4/50
12475/12475 - 269s - loss: 2.8852 - accuracy20: 0.5118 - val_loss: 3.0849 - val_accuracy20: 0.4751 - 269s/epoch - 22ms/step
Epoch 5/50
12475/12475 - 266s - loss: 2.8770 - accuracy20: 0.5143 - val_loss: 3.0952 - val_accuracy20: 0.4755 - 266s/epoch - 21ms/step
Epoch 6/50
12475/12475 - 266s - loss: 2.8705 - accuracy20: 0.5160 - val_loss: 3.1080 - val_accuracy20: 0.4733 - 266s/epoch - 21ms/step
Epoch 7/50
12475/12475 - 267s - loss: 2.8649 - accuracy20: 0.5177 - val_loss: 3.1155 - val_accuracy20: 0.4754 - 267s/epoch - 21ms/step
Epoch 8/50
12475/12475 - 266s - loss: 2.8606 - accuracy20: 0.5190 - val_loss: 3.1132 - val_accuracy20: 0.4746 - 266s/epoch - 21ms/step
Epoch 9/50
12475/12475 - 266s - loss: 2.8565 - accuracy20: 0.5200 - val_loss: 3.1165 - val_accuracy20: 0.4755 - 266s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 266s - loss: 2.8528 - accuracy20: 0.5210 - val_loss: 3.1359 - val_accuracy20: 0.4749 - 266s/epoch - 21ms/step
Epoch 11/50
12475/12475 - 267s - loss: 2.8497 - accuracy20: 0.5216 - val_loss: 3.1232 - val_accuracy20: 0.4765 - 267s/epoch - 21ms/step
Epoch 12/50
12475/12475 - 266s - loss: 2.8469 - accuracy20: 0.5224 - val_loss: 3.1210 - val_accuracy20: 0.4775 - 266s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 276s - 276s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0012426
{'0': {'precision': 0.3963342547954089, 'recall': 0.4925556556906966, 'f1-score': 0.43923702235899714, 'support': 2550997}, '1': {'precision': 0.6569469987267885, 'recall': 0.4827319546858722, 'f1-score': 0.5565239366240573, 'support': 4425110}, '2': {'precision': 0.39966396452461617, 'recall': 0.48722444493642864, 'f1-score': 0.4391218809476429, 'support': 2529440}, 'accuracy': 0.4865637926991471, 'macro avg': {'precision': 0.4843150726822712, 'recall': 0.48750401843766583, 'f1-score': 0.47829427997689916, 'support': 9505547}, 'weighted avg': {'precision': 0.5185431461170376, 'recall': 0.4865637926991471, 'f1-score': 0.4938068702480165, 'support': 9505547}}
[[1256508  552630  741859]
 [1179629 2136142 1109339]
 [ 734187  562848 1232405]]
Evaluating performance on  train set...
12475/12475 - 103s - 103s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0182458
{'0': {'precision': 0.4254815978974247, 'recall': 0.52014655362378, 'f1-score': 0.4680757154292941, 'support': 984759}, '1': {'precision': 0.6091931516700811, 'recall': 0.40991418152007364, 'f1-score': 0.49006989552862107, 'support': 1229572}, '2': {'precision': 0.43481692381049103, 'recall': 0.5161691427917531, 'f1-score': 0.4720133905568171, 'support': 978747}, 'accuracy': 0.47647974775436114, 'macro avg': {'precision': 0.4898305577926656, 'recall': 0.48207662597853557, 'f1-score': 0.47671966717157743, 'support': 3193078}, 'weighted avg': {'precision': 0.49908565793817183, 'recall': 0.47647974775436114, 'f1-score': 0.4777520890509618, 'support': 3193078}}
[[512219 161409 311131]
 [380017 504019 345536]
 [311621 161927 505199]]
Evaluating performance on  val set...
3866/3866 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0239097
{'0': {'precision': 0.41279633847970976, 'recall': 0.5277701935166365, 'f1-score': 0.4632561249654197, 'support': 296667}, '1': {'precision': 0.6094727042144077, 'recall': 0.42302251981805045, 'f1-score': 0.49941282651200924, 'support': 393076}, '2': {'precision': 0.4316317539805209, 'recall': 0.4858577830613976, 'f1-score': 0.4571423185140848, 'support': 299458}, 'accuracy': 0.4734588824718131, 'macro avg': {'precision': 0.48463359889154606, 'recall': 0.4788834987986948, 'f1-score': 0.47327042333050456, 'support': 989201}, 'weighted avg': {'precision': 0.4966510606166405, 'recall': 0.4734588824718131, 'f1-score': 0.47577279585922533, 'support': 989201}}
[[156572  50636  89459]
 [124670 166280 102126]
 [ 98054  55910 145494]]
testing model out of sample: results/universal/W7/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 112s - 112s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84551805
{'0': {'precision': 0.46335826699075944, 'recall': 0.44248788387170485, 'f1-score': 0.4526826522141542, 'support': 857741}, '1': {'precision': 0.6981172978249709, 'recall': 0.7653221009167891, 'f1-score': 0.7301765929181996, 'support': 2057616}, '2': {'precision': 0.4893986011586478, 'recall': 0.3985457805514158, 'f1-score': 0.4393242448899966, 'support': 858880}, 'accuracy': 0.608489080044523, 'macro avg': {'precision': 0.5502913886581261, 'recall': 0.5354519217799699, 'f1-score': 0.5407278300074502, 'support': 3774237}, 'weighted avg': {'precision': 0.5972686335626209, 'recall': 0.608489080044523, 'f1-score': 0.6009252515562523, 'support': 3774237}}
[[ 379540  332056  146145]
 [ 271889 1574739  210988]
 [ 167678  348899  342303]]
Evaluating performance on  train set...
5285/5285 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90119296
{'0': {'precision': 0.48460118068846536, 'recall': 0.4118841484544822, 'f1-score': 0.4452934993118631, 'support': 349171}, '1': {'precision': 0.6475947990243097, 'recall': 0.7257408915107713, 'f1-score': 0.6844444952836325, 'support': 659577}, '2': {'precision': 0.45573645222201875, 'recall': 0.41969403095748364, 'f1-score': 0.43697328882732733, 'support': 343891}, 'accuracy': 0.5669132710205753, 'macro avg': {'precision': 0.5293108106449314, 'recall': 0.5191063569742457, 'f1-score': 0.5222370944742742, 'support': 1352639}, 'weighted avg': {'precision': 0.5567420264455715, 'recall': 0.5669132710205753, 'f1-score': 0.5597935624967442, 'support': 1352639}}
[[143818 130188  75165]
 [ 83695 478682  97200]
 [ 69263 130299 144329]]
Evaluating performance on  val set...
1714/1714 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8705939
{'0': {'precision': 0.4872036886357472, 'recall': 0.4177915879764441, 'f1-score': 0.4498357240163474, 'support': 107489}, '1': {'precision': 0.6704895082771112, 'recall': 0.7617182059564832, 'f1-score': 0.7131983165316007, 'support': 222581}, '2': {'precision': 0.4762447575008065, 'recall': 0.4102036846639064, 'f1-score': 0.4407641663888211, 'support': 107961}, 'accuracy': 0.5906842209797937, 'macro avg': {'precision': 0.544645984804555, 'recall': 0.5299044928656113, 'f1-score': 0.5345994023122564, 'support': 438031}, 'weighted avg': {'precision': 0.5776374795257415, 'recall': 0.5906842209797937, 'f1-score': 0.5814248918414836, 'support': 438031}}
[[ 44908  40822  21759]
 [ 26092 169544  26945]
 [ 21175  42500  44286]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0874
{'0': {'precision': 0.3766439271397426, 'recall': 0.587247340911583, 'f1-score': 0.4589379570383912, 'support': 54718}, '1': {'precision': 0.5979254643106063, 'recall': 0.21419025099502123, 'f1-score': 0.31539792387543253, 'support': 68089}, '2': {'precision': 0.39940481426100216, 'recall': 0.494356945855712, 'f1-score': 0.4418370822048879, 'support': 55112}, 'accuracy': 0.4157060235275603, 'macro avg': {'precision': 0.4579914019037837, 'recall': 0.4319315125874388, 'f1-score': 0.40539098770623716, 'support': 177919}, 'weighted avg': {'precision': 0.4683780117257272, 'recall': 0.4157060235275603, 'f1-score': 0.3987085226786167, 'support': 177919}}
[[32133  4763 17822]
 [30358 14584 23147]
 [22823  5044 27245]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1009835
{'0': {'precision': 0.4020804222946747, 'recall': 0.5337372738139401, 'f1-score': 0.45864768179081217, 'support': 24261}, '1': {'precision': 0.4806237635284534, 'recall': 0.17107116228978544, 'f1-score': 0.2523293111348709, 'support': 24142}, '2': {'precision': 0.39437748429285807, 'recall': 0.5215124411851978, 'f1-score': 0.4491211418767226, 'support': 23591}, 'accuracy': 0.408117343111926, 'macro avg': {'precision': 0.42569389003866204, 'recall': 0.40877362576297444, 'f1-score': 0.3866993782674686, 'support': 71994}, 'weighted avg': {'precision': 0.4258945364384231, 'recall': 0.408117343111926, 'f1-score': 0.386340563038013, 'support': 71994}}
[[12949  2290  9022]
 [10141  4130  9871]
 [ 9115  2173 12303]]
Evaluating performance on  val set...
73/73 - 1s - 762ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0981115
{'0': {'precision': 0.41099873577749685, 'recall': 0.5278454294528333, 'f1-score': 0.462150828061696, 'support': 6159}, '1': {'precision': 0.49130938586326767, 'recall': 0.21453870804520156, 'f1-score': 0.2986616576661188, 'support': 5929}, '2': {'precision': 0.41640654263953053, 'recall': 0.5194704049844237, 'f1-score': 0.46226349712384784, 'support': 6420}, 'accuracy': 0.4245731575534904, 'macro avg': {'precision': 0.4395715547600983, 'recall': 0.4206181808274862, 'f1-score': 0.4076919942838875, 'support': 18508}, 'weighted avg': {'precision': 0.4386019324715098, 'recall': 0.4245731575534904, 'f1-score': 0.4098164885384432, 'support': 18508}}
[[3251  613 2295]
 [2278 1272 2379]
 [2381  704 3335]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6245181
{'0': {'precision': 0.5301735405899978, 'recall': 0.3933313441742503, 'f1-score': 0.4516140083419693, 'support': 67030}, '1': {'precision': 0.82356111736033, 'recall': 0.9237243362448054, 'f1-score': 0.8707717962409359, 'support': 380449}, '2': {'precision': 0.6144646924829157, 'recall': 0.3441211311241381, 'f1-score': 0.4411713167578512, 'support': 65846}, 'accuracy': 0.7801178590561535, 'macro avg': {'precision': 0.6560664501444146, 'recall': 0.5537256038477313, 'f1-score': 0.5878523737802522, 'support': 513325}, 'weighted avg': {'precision': 0.7584290227547807, 'recall': 0.7801178590561535, 'f1-score': 0.7609317929391078, 'support': 513325}}
[[ 26365  36668   3997]
 [ 18799 351430  10220]
 [  4565  38622  22659]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63313687
{'0': {'precision': 0.5703984006854206, 'recall': 0.40837294893421255, 'f1-score': 0.4759748577556675, 'support': 19563}, '1': {'precision': 0.8193075814303457, 'recall': 0.9115822599679251, 'f1-score': 0.8629853140576361, 'support': 99143}, '2': {'precision': 0.5441754916792738, 'recall': 0.38207021084497317, 'f1-score': 0.44893756435458204, 'support': 18829}, 'accuracy': 0.7675137237794016, 'macro avg': {'precision': 0.64462715793168, 'recall': 0.5673418065823702, 'f1-score': 0.5959659120559619, 'support': 137535}, 'weighted avg': {'precision': 0.7462362001758585, 'recall': 0.7675137237794016, 'f1-score': 0.7512523687288527, 'support': 137535}}
[[ 7989  9896  1678]
 [ 4418 90377  4348]
 [ 1599 10036  7194]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6547668
{'0': {'precision': 0.532094943240454, 'recall': 0.438509950671883, 'f1-score': 0.4807907497202536, 'support': 5879}, '1': {'precision': 0.8055940365459463, 'recall': 0.8953407382968583, 'f1-score': 0.8480997274163584, 'support': 27279}, '2': {'precision': 0.5523540005145356, 'recall': 0.36439239646978955, 'f1-score': 0.4391042028837304, 'support': 5892}, 'accuracy': 0.7464532650448144, 'macro avg': {'precision': 0.6300143267669788, 'recall': 0.5660810284795103, 'f1-score': 0.5893315600067808, 'support': 39050}, 'weighted avg': {'precision': 0.7262088518637425, 'recall': 0.7464532650448144, 'f1-score': 0.7310904800304008, 'support': 39050}}
[[ 2578  2757   544]
 [ 1659 24424  1196]
 [  608  3137  2147]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554157
{'0': {'precision': 0.41179978252481675, 'recall': 0.47950987066031314, 'f1-score': 0.44308296168628164, 'support': 73450}, '1': {'precision': 0.49840783267048083, 'recall': 0.42574972629487917, 'f1-score': 0.4592225563360563, 'support': 88599}, '2': {'precision': 0.4449237586341718, 'recall': 0.4498425373232663, 'f1-score': 0.44736962803283953, 'support': 75891}, 'accuracy': 0.45002941918130623, 'macro avg': {'precision': 0.4517104579431564, 'recall': 0.45170071142615287, 'f1-score': 0.44989171535172584, 'support': 237940}, 'weighted avg': {'precision': 0.4546139302333599, 'recall': 0.45002941918130623, 'f1-score': 0.45045991109403993, 'support': 237940}}
[[35220 19394 18836]
 [27123 37721 23755]
 [23184 18568 34139]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0475854
{'0': {'precision': 0.4573485782859429, 'recall': 0.42100095124121634, 'f1-score': 0.4384227008372211, 'support': 32589}, '1': {'precision': 0.460582270199542, 'recall': 0.47515032519327527, 'f1-score': 0.4677528955196835, 'support': 32596}, '2': {'precision': 0.45447571841623885, 'recall': 0.4763878150610793, 'f1-score': 0.4651738664331335, 'support': 32335}, 'accuracy': 0.45746513535684985, 'macro avg': {'precision': 0.45746885563390793, 'recall': 0.4575130304985236, 'f1-score': 0.4571164875966794, 'support': 97520}, 'weighted avg': {'precision': 0.45747687502229234, 'recall': 0.45746513535684985, 'f1-score': 0.457096264879606, 'support': 97520}}
[[13720  9563  9306]
 [ 7924 15488  9184]
 [ 8355  8576 15404]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0653868
{'0': {'precision': 0.4512820512820513, 'recall': 0.4280936454849498, 'f1-score': 0.43938211889530343, 'support': 9867}, '1': {'precision': 0.43043956043956044, 'recall': 0.4181255337318531, 'f1-score': 0.42419319904700026, 'support': 9368}, '2': {'precision': 0.4493736460393708, 'recall': 0.4847591952855111, 'f1-score': 0.46639620704824275, 'support': 9842}, 'accuracy': 0.44406231729545687, 'macro avg': {'precision': 0.4436984192536609, 'recall': 0.443659458167438, 'f1-score': 0.44332384166351546, 'support': 29077}, 'weighted avg': {'precision': 0.44392107942763315, 'recall': 0.44406231729545687, 'f1-score': 0.4436323116408523, 'support': 29077}}
[[4224 2742 2901]
 [2506 3917 2945]
 [2630 2441 4771]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1980582
{'0': {'precision': 0.3457661166089496, 'recall': 0.6456300625920471, 'f1-score': 0.4503487186895561, 'support': 86912}, '1': {'precision': 0.32894736842105265, 'recall': 0.005677477961062824, 'f1-score': 0.011162299839668785, 'support': 96874}, '2': {'precision': 0.36503152306160824, 'recall': 0.4466638094378778, 'f1-score': 0.40174278236523364, 'support': 88664}, 'accuracy': 0.3533345567994127, 'macro avg': {'precision': 0.34658166936387014, 'recall': 0.3659904499969959, 'f1-score': 0.2877512669648195, 'support': 272450}, 'weighted avg': {'precision': 0.34605552231922376, 'recall': 0.3533345567994127, 'f1-score': 0.27837095441015175, 'support': 272450}}
[[56113   689 30110]
 [57545   550 38779]
 [48628   433 39603]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1667899
{'0': {'precision': 0.36970121534000194, 'recall': 0.6372648132547037, 'f1-score': 0.4679354998350379, 'support': 35610}, '1': {'precision': 0.4697508896797153, 'recall': 0.015682547225852442, 'f1-score': 0.030351805012646588, 'support': 33668}, '2': {'precision': 0.3733240293076808, 'recall': 0.44912154464232174, 'f1-score': 0.4077299945563419, 'support': 33354}, 'accuracy': 0.37221334476576506, 'macro avg': {'precision': 0.404258711442466, 'recall': 0.367356301707626, 'f1-score': 0.30200576646800875, 'support': 102632}, 'weighted avg': {'precision': 0.4036994592867966, 'recall': 0.37221334476576506, 'f1-score': 0.3048220239177227, 'support': 102632}}
[[22693   324 12593]
 [20587   528 12553]
 [18102   272 14980]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1816676
{'0': {'precision': 0.3480561083337378, 'recall': 0.704835856103794, 'f1-score': 0.46599733567274254, 'support': 10174}, '1': {'precision': 0.4014084507042254, 'recall': 0.0054296056391693655, 'f1-score': 0.010714285714285713, 'support': 10498}, '2': {'precision': 0.38980819857089133, 'recall': 0.38715099449061535, 'f1-score': 0.3884750527055516, 'support': 10709}, 'accuracy': 0.36244861540422546, 'macro avg': {'precision': 0.3797575858696181, 'recall': 0.3658054854111929, 'f1-score': 0.28839555803086, 'support': 31381}, 'weighted avg': {'precision': 0.38015247315815565, 'recall': 0.36244861540422546, 'f1-score': 0.2872347855067336, 'support': 31381}}
[[7171   51 2952]
 [6903   57 3538]
 [6529   34 4146]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
1646/1646 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0998555
{'0': {'precision': 0.37099616677910086, 'recall': 0.5546842014730489, 'f1-score': 0.4446150519708825, 'support': 127898}, '1': {'precision': 0.547037037037037, 'recall': 0.2448126411943817, 'f1-score': 0.33825001272286215, 'support': 162896}, '2': {'precision': 0.3944017765673817, 'recall': 0.4750164768634183, 'f1-score': 0.430971725367904, 'support': 130486}, 'accuracy': 0.41019037219901255, 'macro avg': {'precision': 0.43747832679450654, 'recall': 0.42483777317694965, 'f1-score': 0.4046122633538829, 'support': 421280}, 'weighted avg': {'precision': 0.44631533218066366, 'recall': 0.41019037219901255, 'f1-score': 0.3992611245390989, 'support': 421280}}
[[70943 17007 39948]
 [67791 39879 55226]
 [52489 16014 61983]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.110135
{'0': {'precision': 0.39640217910103853, 'recall': 0.5259996942497106, 'f1-score': 0.4520967075871908, 'support': 45789}, '1': {'precision': 0.4444271723923519, 'recall': 0.19753569783509903, 'f1-score': 0.27350563625057794, 'support': 43420}, '2': {'precision': 0.40100108175501, 'recall': 0.4818462216347213, 'f1-score': 0.4377220281994576, 'support': 45390}, 'accuracy': 0.40515159845169724, 'macro avg': {'precision': 0.4139434777494668, 'recall': 0.40179387123984367, 'f1-score': 0.38777479067907544, 'support': 134599}, 'weighted avg': {'precision': 0.4134453176100363, 'recall': 0.40515159845169724, 'f1-score': 0.3896379150638813, 'support': 134599}}
[[24085  5660 16044]
 [18217  8577 16626]
 [18457  5062 21871]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0981431
{'0': {'precision': 0.3950994488377666, 'recall': 0.5273468735007196, 'f1-score': 0.4517432700869923, 'support': 12506}, '1': {'precision': 0.47314532063948267, 'recall': 0.22138174483106404, 'f1-score': 0.301631835098769, 'support': 11898}, '2': {'precision': 0.4153795160755718, 'recall': 0.4842349304482226, 'f1-score': 0.44717216770740414, 'support': 12940}, 'accuracy': 0.41492609254498714, 'macro avg': {'precision': 0.42787476185094037, 'recall': 0.4109878495933354, 'f1-score': 0.40018242429772183, 'support': 37344}, 'weighted avg': {'precision': 0.42699249330954303, 'recall': 0.41492609254498714, 'f1-score': 0.4023330323438006, 'support': 37344}}
[[6595 1468 4443]
 [4888 2634 4376]
 [5209 1465 6266]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/EXC
Evaluating performance on  test set...
5928/5928 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6754224
{'0': {'precision': 0.47156580120242003, 'recall': 0.4259254500916457, 'f1-score': 0.4475851454493088, 'support': 233508}, '1': {'precision': 0.7996096426195357, 'recall': 0.844783047042934, 'f1-score': 0.8215758615123695, 'support': 1051380}, '2': {'precision': 0.4806695833737486, 'recall': 0.4046544610624033, 'f1-score': 0.43939864150661634, 'support': 232680}, 'accuracy': 0.7128510880566802, 'macro avg': {'precision': 0.5839483423985682, 'recall': 0.5584543193989943, 'f1-score': 0.5695198828227649, 'support': 1517568}, 'weighted avg': {'precision': 0.700232326870299, 'recall': 0.7128510880566802, 'f1-score': 0.7054329145884809, 'support': 1517568}}
[[ 99457 106418  27633]
 [ 89097 888188  74095]
 [ 22354 116171  94155]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.690697
{'0': {'precision': 0.5255211907522658, 'recall': 0.40831785839048335, 'f1-score': 0.4595646055790084, 'support': 54389}, '1': {'precision': 0.7648540197637343, 'recall': 0.8678159019529128, 'f1-score': 0.8130883924482214, 'support': 211735}, '2': {'precision': 0.536042007850477, 'recall': 0.3760074395536268, 'f1-score': 0.4419843319651488, 'support': 54842}, 'accuracy': 0.7059190069976259, 'macro avg': {'precision': 0.6088057394554923, 'recall': 0.5507137332990076, 'f1-score': 0.5715457766641262, 'support': 320966}, 'weighted avg': {'precision': 0.6852020267350284, 'recall': 0.7059190069976259, 'f1-score': 0.6897734801863548, 'support': 320966}}
[[ 22208  27261   4920]
 [ 15060 183747  12928]
 [  4991  29230  20621]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6701896
{'0': {'precision': 0.5223287184948526, 'recall': 0.41858215748748295, 'f1-score': 0.46473579482644267, 'support': 17576}, '1': {'precision': 0.7772164960823604, 'recall': 0.8764494959745619, 'f1-score': 0.8238556147692152, 'support': 73905}, '2': {'precision': 0.5387356809503606, 'recall': 0.3580936266215454, 'f1-score': 0.4302219210570896, 'support': 17730}, 'accuracy': 0.7186089313347557, 'macro avg': {'precision': 0.6127602985091912, 'recall': 0.5510417600278634, 'f1-score': 0.5729377768842492, 'support': 109211}, 'weighted avg': {'precision': 0.6974793594279173, 'recall': 0.7186089313347557, 'f1-score': 0.7021552792276475, 'support': 109211}}
[[ 7357  8730  1489]
 [ 5184 64774  3947]
 [ 1544  9837  6349]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/AAL
Evaluating performance on  test set...
5331/5331 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6757386
{'0': {'precision': 0.49166230290335716, 'recall': 0.42673251826826447, 'f1-score': 0.4569021684766593, 'support': 198021}, '1': {'precision': 0.8016578376383694, 'recall': 0.8793097736857688, 'f1-score': 0.8386902484479715, 'support': 966002}, '2': {'precision': 0.5259090704276123, 'recall': 0.3491359969687603, 'f1-score': 0.41966704221300666, 'support': 200578}, 'accuracy': 0.7357066277981622, 'macro avg': {'precision': 0.6064097369897796, 'recall': 0.5517260963075978, 'f1-score': 0.5717531530458791, 'support': 1364601}, 'weighted avg': {'precision': 0.7161421726100122, 'recall': 0.7357066277981622, 'f1-score': 0.721697153730764, 'support': 1364601}}
[[ 84502  95812  17707]
 [ 71165 849415  45422]
 [ 16203 114346  70029]]
Evaluating performance on  train set...
2013/2013 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7447729
{'0': {'precision': 0.5192625407547115, 'recall': 0.40165565909707773, 'f1-score': 0.45294954119665093, 'support': 88424}, '1': {'precision': 0.7673249305470022, 'recall': 0.8239872322040026, 'f1-score': 0.7946472860856082, 'support': 340231}, '2': {'precision': 0.41700385002084406, 'recall': 0.3924759102186833, 'f1-score': 0.40436827117999197, 'support': 86655}, 'accuracy': 0.6789544157885544, 'macro avg': {'precision': 0.567863773774186, 'recall': 0.5393729338399212, 'f1-score': 0.5506550328207503, 'support': 515310}, 'weighted avg': {'precision': 0.6658486502730162, 'recall': 0.6789544157885544, 'f1-score': 0.6703843968913225, 'support': 515310}}
[[ 35516  40777  12131]
 [ 24468 280346  35417]
 [  8413  44232  34010]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70452845
{'0': {'precision': 0.5192122538293217, 'recall': 0.41590128304003365, 'f1-score': 0.4618498909996886, 'support': 28526}, '1': {'precision': 0.7816734201676266, 'recall': 0.8598027665411645, 'f1-score': 0.8188787320020402, 'support': 121379}, '2': {'precision': 0.47208827893175076, 'recall': 0.36333143020268344, 'f1-score': 0.41063074689466045, 'support': 28024}, 'accuracy': 0.7104406813953881, 'macro avg': {'precision': 0.5909913176428997, 'recall': 0.5463451599279606, 'f1-score': 0.5637864566321297, 'support': 177929}, 'weighted avg': {'precision': 0.6908350451474744, 'recall': 0.7104406813953881, 'f1-score': 0.6973395436005863, 'support': 177929}}
[[ 11864  13878   2784]
 [  8415 104362   8602]
 [  2571  15271  10182]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/WBA
Evaluating performance on  test set...
4192/4192 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91451514
{'0': {'precision': 0.5185101067454009, 'recall': 0.35752939825367935, 'f1-score': 0.4232288735730676, 'support': 287347}, '1': {'precision': 0.5894030155669585, 'recall': 0.7821619749666057, 'f1-score': 0.6722373783072202, 'support': 505325}, '2': {'precision': 0.5143256874226482, 'recall': 0.37486674296634614, 'f1-score': 0.43366000131987065, 'support': 280473}, 'accuracy': 0.5620125891654902, 'macro avg': {'precision': 0.5407462699116691, 'recall': 0.5048527053955437, 'f1-score': 0.5097087510667194, 'support': 1073145}, 'weighted avg': {'precision': 0.5507987000944294, 'recall': 0.5620125891654902, 'f1-score': 0.5432088132338915, 'support': 1073145}}
[[102735 141619  42993]
 [ 53789 395246  56290]
 [ 41611 133722 105140]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9760584
{'0': {'precision': 0.5302166476624858, 'recall': 0.36898676779751843, 'f1-score': 0.43514720627107834, 'support': 97036}, '1': {'precision': 0.5091236111514026, 'recall': 0.7187968446661588, 'f1-score': 0.5960588790696726, 'support': 122079}, '2': {'precision': 0.5126361975381086, 'recall': 0.4014433118890467, 'f1-score': 0.4502767446627815, 'support': 95752}, 'accuracy': 0.5144838931993508, 'macro avg': {'precision': 0.5173254854506656, 'recall': 0.49640897478424134, 'f1-score': 0.49382761000117753, 'support': 314867}, 'weighted avg': {'precision': 0.5166922704983311, 'recall': 0.5144838931993508, 'f1-score': 0.5021361878527046, 'support': 314867}}
[[35805 43196 18035]
 [15820 87750 18509]
 [15904 41409 38439]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9743415
{'0': {'precision': 0.5153898768809849, 'recall': 0.3858660862885674, 'f1-score': 0.44132074090343365, 'support': 31244}, '1': {'precision': 0.5199492029795865, 'recall': 0.6986730509640119, 'f1-score': 0.5962052552650453, 'support': 39263}, '2': {'precision': 0.5046370813213765, 'recall': 0.4148969689331401, 'f1-score': 0.4553880204730945, 'support': 31738}, 'accuracy': 0.5149982884248618, 'macro avg': {'precision': 0.5133253870606493, 'recall': 0.4998120353952398, 'f1-score': 0.4976380055471911, 'support': 102245}, 'weighted avg': {'precision': 0.513802910233604, 'recall': 0.5149982884248618, 'f1-score': 0.5051644301436102, 'support': 102245}}
[[12056 12514  6674]
 [ 5579 27432  6252]
 [ 5757 12813 13168]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8656432
{'0': {'precision': 0.5491144672079424, 'recall': 0.38804520703374673, 'f1-score': 0.4547383823046976, 'support': 403654}, '1': {'precision': 0.6188458948853781, 'recall': 0.8202764141289847, 'f1-score': 0.7054642796868134, 'support': 772030}, '2': {'precision': 0.5641472545126628, 'recall': 0.3752195618591125, 'f1-score': 0.45068461430190837, 'support': 396813}, 'accuracy': 0.5970160833375199, 'macro avg': {'precision': 0.5773692055353278, 'recall': 0.5278470610072813, 'f1-score': 0.5369624254311397, 'support': 1572497}, 'weighted avg': {'precision': 0.5871431308801521, 'recall': 0.5970160833375199, 'f1-score': 0.5768113189865635, 'support': 1572497}}
[[156636 195107  51911]
 [ 75631 633278  63121]
 [ 52985 194936 148892]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94548106
{'0': {'precision': 0.5456406096732815, 'recall': 0.3658954638601462, 'f1-score': 0.4380461284509261, 'support': 158108}, '1': {'precision': 0.5455712204731988, 'recall': 0.7757541471248426, 'f1-score': 0.640613049915796, 'support': 219188}, '2': {'precision': 0.5281062271696415, 'recall': 0.3912904053360698, 'f1-score': 0.44951850460128356, 'support': 155920}, 'accuracy': 0.5418010712356719, 'macro avg': {'precision': 0.5397726857720406, 'recall': 0.5109800054403528, 'f1-score': 0.5093925609893352, 'support': 533216}, 'weighted avg': {'precision': 0.5404847812661158, 'recall': 0.5418010712356719, 'f1-score': 0.5246695817445363, 'support': 533216}}
[[ 57851  71740  28517]
 [ 23153 170036  25999]
 [ 25020  69890  61010]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9335603
{'0': {'precision': 0.5385203431580735, 'recall': 0.37714897582835955, 'f1-score': 0.4436151603498542, 'support': 50431}, '1': {'precision': 0.5622507666833231, 'recall': 0.7753996243598579, 'f1-score': 0.6518430169818822, 'support': 74007}, '2': {'precision': 0.5255484109973274, 'recall': 0.3914654577707697, 'f1-score': 0.44870433544947247, 'support': 50735}, 'accuracy': 0.5495481609608787, 'macro avg': {'precision': 0.5421065069462413, 'recall': 0.5146713526529957, 'f1-score': 0.5147208375937363, 'support': 175173}, 'weighted avg': {'precision': 0.5447889260770034, 'recall': 0.5495481609608787, 'f1-score': 0.5330611268198332, 'support': 175173}}
[[19020 22127  9284]
 [ 7976 57385  8646]
 [ 8323 22551 19861]]
testing model on single stock: results/universal/W7/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
23942/23942 - 179s - 179s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1199311
{'0': {'precision': 0.3813295216921114, 'recall': 0.5181510499946701, 'f1-score': 0.43933420749311447, 'support': 1876200}, '1': {'precision': 0.48052323210027015, 'recall': 0.20940227060385214, 'f1-score': 0.291691365184542, 'support': 2391082}, '2': {'precision': 0.3824918006171752, 'recall': 0.5213545983219258, 'f1-score': 0.4412560791441147, 'support': 1861777}, 'accuracy': 0.3986744131521658, 'macro avg': {'precision': 0.41478151813651887, 'recall': 0.4163026396401494, 'f1-score': 0.39076055060725706, 'support': 6129059}, 'weighted avg': {'precision': 0.4203802470384377, 'recall': 0.3986744131521658, 'f1-score': 0.3823192487146002, 'support': 6129059}}
[[972155 267285 636760]
 [960099 500698 930285]
 [617129 274002 970646]]
Evaluating performance on  train set...
9052/9052 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0854706
{'0': {'precision': 0.41625257865384463, 'recall': 0.5455696186264796, 'f1-score': 0.4722177575660164, 'support': 778161}, '1': {'precision': 0.4675509550248211, 'recall': 0.18554237712449226, 'f1-score': 0.2656603929384432, 'support': 762947}, '2': {'precision': 0.4264756903416033, 'recall': 0.5465249945229841, 'f1-score': 0.47909447126559496, 'support': 775970}, 'accuracy': 0.4273429724851731, 'macro avg': {'precision': 0.43675974134008966, 'recall': 0.4258789967579853, 'f1-score': 0.4056575405900182, 'support': 2317078}, 'weighted avg': {'precision': 0.4365672898260441, 'recall': 0.4273429724851731, 'f1-score': 0.4065073247963595, 'support': 2317078}}
[[424541  80411 273209]
 [324285 141559 297103]
 [271086  80797 424087]]
Evaluating performance on  val set...
2763/2763 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0991976
{'0': {'precision': 0.40202620396824645, 'recall': 0.5481763980085765, 'f1-score': 0.46386165632021725, 'support': 231794}, '1': {'precision': 0.46535642277035555, 'recall': 0.2039887498915876, 'f1-score': 0.2836428163287574, 'support': 242131}, '2': {'precision': 0.42067993139658455, 'recall': 0.5139188222238409, 'f1-score': 0.46264845536985105, 'support': 233389}, 'accuracy': 0.41904868276324236, 'macro avg': {'precision': 0.4293541860450622, 'recall': 0.422027990041335, 'f1-score': 0.40338430933960856, 'support': 707314}, 'weighted avg': {'precision': 0.42986077814540946, 'recall': 0.41904868276324236, 'f1-score': 0.40176799536825364, 'support': 707314}}
[[127064  26734  77996]
 [105561  49392  87178]
 [ 83434  30012 119943]]
training model: results/universal/W7/deepOF_L2/h30
Epoch 1/50
12475/12475 - 272s - loss: 3.0613 - accuracy30: 0.4584 - val_loss: 3.1483 - val_accuracy30: 0.4498 - 272s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 265s - loss: 3.0085 - accuracy30: 0.4744 - val_loss: 3.1356 - val_accuracy30: 0.4535 - 265s/epoch - 21ms/step
Epoch 3/50
12475/12475 - 266s - loss: 2.9925 - accuracy30: 0.4792 - val_loss: 3.1455 - val_accuracy30: 0.4530 - 266s/epoch - 21ms/step
Epoch 4/50
12475/12475 - 265s - loss: 2.9824 - accuracy30: 0.4821 - val_loss: 3.1400 - val_accuracy30: 0.4558 - 265s/epoch - 21ms/step
Epoch 5/50
12475/12475 - 264s - loss: 2.9754 - accuracy30: 0.4844 - val_loss: 3.1376 - val_accuracy30: 0.4563 - 264s/epoch - 21ms/step
Epoch 6/50
12475/12475 - 267s - loss: 2.9696 - accuracy30: 0.4859 - val_loss: 3.1445 - val_accuracy30: 0.4565 - 267s/epoch - 21ms/step
Epoch 7/50
12475/12475 - 264s - loss: 2.9656 - accuracy30: 0.4874 - val_loss: 3.1420 - val_accuracy30: 0.4568 - 264s/epoch - 21ms/step
Epoch 8/50
12475/12475 - 265s - loss: 2.9614 - accuracy30: 0.4885 - val_loss: 3.1438 - val_accuracy30: 0.4568 - 265s/epoch - 21ms/step
Epoch 9/50
12475/12475 - 266s - loss: 2.9584 - accuracy30: 0.4894 - val_loss: 3.1402 - val_accuracy30: 0.4579 - 266s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 266s - loss: 2.9554 - accuracy30: 0.4904 - val_loss: 3.1375 - val_accuracy30: 0.4592 - 266s/epoch - 21ms/step
Epoch 11/50
12475/12475 - 265s - loss: 2.9529 - accuracy30: 0.4912 - val_loss: 3.1493 - val_accuracy30: 0.4573 - 265s/epoch - 21ms/step
Epoch 12/50
12475/12475 - 266s - loss: 2.9505 - accuracy30: 0.4920 - val_loss: 3.1567 - val_accuracy30: 0.4581 - 266s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 281s - 281s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0499582
{'0': {'precision': 0.41515149123731027, 'recall': 0.44996602779584544, 'f1-score': 0.4318582466214395, 'support': 2688963}, '1': {'precision': 0.6605152277559575, 'recall': 0.36762931551844064, 'f1-score': 0.47235529801303994, 'support': 4149038}, '2': {'precision': 0.38275354066894013, 'recall': 0.6143777839257505, 'f1-score': 0.4716635939634188, 'support': 2667546}, 'accuracy': 0.4601661535101557, 'macro avg': {'precision': 0.4861400865540693, 'recall': 0.4773243757466788, 'f1-score': 0.4586257128659661, 'support': 9505547}, 'weighted avg': {'precision': 0.5131574706081978, 'recall': 0.4601661535101557, 'f1-score': 0.46070523461617674, 'support': 9505547}}
[[1209942  409139 1069882]
 [1050675 1525308 1573055]
 [ 653842  374823 1638881]]
Evaluating performance on  train set...
12475/12475 - 97s - 97s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0636308
{'0': {'precision': 0.4370520046582588, 'recall': 0.43955345607637936, 'f1-score': 0.43829916133913166, 'support': 1002365}, '1': {'precision': 0.6086944617469694, 'recall': 0.2971559562516499, 'f1-score': 0.3993533176153587, 'support': 1197028}, '2': {'precision': 0.3986876204232902, 'recall': 0.6421964707125497, 'f1-score': 0.4919582976299094, 'support': 993685}, 'accuracy': 0.4492336234817941, 'macro avg': {'precision': 0.4814780289428395, 'recall': 0.4596352943468596, 'f1-score': 0.4432035921947999, 'support': 3193078}, 'weighted avg': {'precision': 0.48945871504098676, 'recall': 0.4492336234817941, 'f1-score': 0.44039776758179816, 'support': 3193078}}
[[440593 119646 442126]
 [320987 355704 520337]
 [246522 109022 638141]]
Evaluating performance on  val set...
3866/3866 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0595015
{'0': {'precision': 0.4247442839057847, 'recall': 0.4666079036286176, 'f1-score': 0.4446930016287582, 'support': 306315}, '1': {'precision': 0.6099878626928223, 'recall': 0.3155042482353793, 'f1-score': 0.4158949812302289, 'support': 372743}, '2': {'precision': 0.4084639955120776, 'recall': 0.6056980167213188, 'f1-score': 0.48790199001615486, 'support': 310143}, 'accuracy': 0.4532789594834619, 'macro avg': {'precision': 0.4810653807035616, 'recall': 0.46260338952843855, 'f1-score': 0.44949665762504737, 'support': 989201}, 'weighted avg': {'precision': 0.4894419841755249, 'recall': 0.4532789594834619, 'f1-score': 0.44738881852342705, 'support': 989201}}
[[142929  37962 125424]
 [108517 117602 146624]
 [ 85060  37230 187853]]
testing model out of sample: results/universal/W7/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 112s - 112s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9218762
{'0': {'precision': 0.46996698280803356, 'recall': 0.4038706025913951, 'f1-score': 0.43441905387482416, 'support': 939957}, '1': {'precision': 0.6524867961175133, 'recall': 0.6652228194571516, 'f1-score': 0.658793259215253, 'support': 1888704}, '2': {'precision': 0.4397438385406559, 'recall': 0.48407743005321624, 'f1-score': 0.46084686395346147, 'support': 945576}, 'accuracy': 0.5547510662419981, 'macro avg': {'precision': 0.520732539155401, 'recall': 0.5177236173672543, 'f1-score': 0.5180197256811796, 'support': 3774237}, 'weighted avg': {'precision': 0.5537316275860635, 'recall': 0.5547510662419981, 'f1-score': 0.5533214868874322, 'support': 3774237}}
[[ 379621  334028  226308]
 [ 275429 1256409  356866]
 [ 152711  335133  457732]]
Evaluating performance on  train set...
5285/5285 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9620015
{'0': {'precision': 0.4962518586532729, 'recall': 0.3763449241697911, 'f1-score': 0.4280599511489454, 'support': 384873}, '1': {'precision': 0.6049587773171434, 'recall': 0.6141842307908063, 'f1-score': 0.6095365988003546, 'support': 588273}, '2': {'precision': 0.42805981226147044, 'recall': 0.522837048377704, 'f1-score': 0.4707251396780584, 'support': 379493}, 'accuracy': 0.5208825118897208, 'macro avg': {'precision': 0.5097568160772956, 'recall': 0.5044554011127671, 'f1-score': 0.5027738965424527, 'support': 1352639}, 'weighted avg': {'precision': 0.5243975360304495, 'recall': 0.5208825118897208, 'f1-score': 0.5189555650816474, 'support': 1352639}}
[[144845 120618 119410]
 [ 81271 361308 145694]
 [ 65762 115318 198413]]
Evaluating performance on  val set...
1714/1714 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93253994
{'0': {'precision': 0.5014224828593541, 'recall': 0.3850358242935583, 'f1-score': 0.435588718497441, 'support': 119472}, '1': {'precision': 0.6281184581996966, 'recall': 0.6582934549059272, 'f1-score': 0.6428520534145772, 'support': 198729}, '2': {'precision': 0.44316518614053646, 'recall': 0.5104147542351665, 'f1-score': 0.4744186407285025, 'support': 119830}, 'accuracy': 0.5433085786165819, 'macro avg': {'precision': 0.5242353757331957, 'recall': 0.5179146778115506, 'f1-score': 0.5176198042135068, 'support': 438031}, 'weighted avg': {'precision': 0.5429656444565812, 'recall': 0.5433085786165819, 'f1-score': 0.5402439252423875, 'support': 438031}}
[[ 46001  38851  34620]
 [ 25676 130822  42231]
 [ 20064  38603  61163]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1413449
{'0': {'precision': 0.36423457112212654, 'recall': 0.4659571312022547, 'f1-score': 0.4088638693197533, 'support': 53932}, '1': {'precision': 0.6495949830154167, 'recall': 0.10789306174411203, 'f1-score': 0.1850505551764779, 'support': 69124}, '2': {'precision': 0.3610176101145273, 'recall': 0.6412153910650165, 'f1-score': 0.4619485644126665, 'support': 54863}, 'accuracy': 0.38088680804186176, 'macro avg': {'precision': 0.4582823880840235, 'recall': 0.40502186133712775, 'f1-score': 0.35195432963629925, 'support': 177919}, 'weighted avg': {'precision': 0.47410907007924674, 'recall': 0.38088680804186176, 'f1-score': 0.33827845741907225, 'support': 177919}}
[[25130  2126 26676]
 [26077  7458 35589]
 [17787  1897 35179]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1354883
{'0': {'precision': 0.40327946768060835, 'recall': 0.41572758451739344, 'f1-score': 0.40940892641737037, 'support': 24492}, '1': {'precision': 0.47146471745853247, 'recall': 0.07067897332153243, 'f1-score': 0.12292918926843573, 'support': 23727}, '2': {'precision': 0.3713908634142953, 'recall': 0.67465825446898, 'f1-score': 0.4790633773370766, 'support': 23775}, 'accuracy': 0.3875184043114704, 'macro avg': {'precision': 0.41537834951781205, 'recall': 0.3870216041026353, 'f1-score': 0.33713383100762756, 'support': 71994}, 'weighted avg': {'precision': 0.4152204607501588, 'recall': 0.3875184043114704, 'f1-score': 0.33799644547844826, 'support': 71994}}
[[10182  1059 13251]
 [ 8152  1677 13898]
 [ 6914   821 16040]]
Evaluating performance on  val set...
73/73 - 1s - 749ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1114101
{'0': {'precision': 0.41204819277108434, 'recall': 0.4298507462686567, 'f1-score': 0.4207612456747405, 'support': 6365}, '1': {'precision': 0.44795164539959703, 'recall': 0.11940565699964197, 'f1-score': 0.1885512367491166, 'support': 5586}, '2': {'precision': 0.39618460352635126, 'recall': 0.6271160591734025, 'f1-score': 0.4855928200283419, 'support': 6557}, 'accuracy': 0.40604063107845256, 'macro avg': {'precision': 0.41872814723234425, 'recall': 0.3921241541472337, 'f1-score': 0.36496843415073305, 'support': 18508}, 'weighted avg': {'precision': 0.4172642686142417, 'recall': 0.40604063107845256, 'f1-score': 0.37364516199082165, 'support': 18508}}
[[2736  412 3217]
 [1869  667 3050]
 [2035  410 4112]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7574028
{'0': {'precision': 0.5159790635525546, 'recall': 0.39304729094895086, 'f1-score': 0.44620086559959526, 'support': 83018}, '1': {'precision': 0.7812175121536779, 'recall': 0.8238823573193179, 'f1-score': 0.8019829017911877, 'support': 349329}, '2': {'precision': 0.45790227598281075, 'recall': 0.4618661858776458, 'f1-score': 0.4598756893339973, 'support': 80978}, 'accuracy': 0.6970963814347636, 'macro avg': {'precision': 0.5850329505630144, 'recall': 0.5595986113819715, 'f1-score': 0.5693531522415934, 'support': 513325}, 'weighted avg': {'precision': 0.6873179617312115, 'recall': 0.6970963814347636, 'f1-score': 0.6904756287557579, 'support': 513325}}
[[ 32630  42522   7866]
 [ 25111 287806  36412]
 [  5498  38079  37401]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7601021
{'0': {'precision': 0.5670883011559644, 'recall': 0.39592664582100906, 'f1-score': 0.4662967478663316, 'support': 23666}, '1': {'precision': 0.7809061146900412, 'recall': 0.810994000679996, 'f1-score': 0.7956657179596162, 'support': 91177}, '2': {'precision': 0.43324975305827823, 'recall': 0.5025559668605676, 'f1-score': 0.46533643448810535, 'support': 22692}, 'accuracy': 0.6886828807212709, 'macro avg': {'precision': 0.5937480563014279, 'recall': 0.5698255377871909, 'f1-score': 0.5757663001046843, 'support': 137535}, 'weighted avg': {'precision': 0.6867538586588824, 'recall': 0.6886828807212709, 'f1-score': 0.6844890854896034, 'support': 137535}}
[[ 9370 11278  3018]
 [ 5333 73944 11900]
 [ 1820  9468 11404]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7675241
{'0': {'precision': 0.5448288033886339, 'recall': 0.4343604896580836, 'f1-score': 0.4833633445549205, 'support': 7107}, '1': {'precision': 0.7645177449809256, 'recall': 0.799162168694111, 'f1-score': 0.7814561711010891, 'support': 24826}, '2': {'precision': 0.4634736983721243, 'recall': 0.4840522692145567, 'f1-score': 0.4735395189003437, 'support': 7117}, 'accuracy': 0.6753393085787452, 'macro avg': {'precision': 0.590940082247228, 'recall': 0.5725249758555838, 'f1-score': 0.5794530115187845, 'support': 39050}, 'weighted avg': {'precision': 0.6696685826861433, 'recall': 0.6753393085787452, 'f1-score': 0.6710851459544482, 'support': 39050}}
[[ 3087  3070   950]
 [ 1948 19840  3038]
 [  631  3041  3445]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0851074
{'0': {'precision': 0.40996456826675726, 'recall': 0.4481912367509916, 'f1-score': 0.42822649640356153, 'support': 75383}, '1': {'precision': 0.48317451170066067, 'recall': 0.27819780532315785, 'f1-score': 0.3530942371759681, 'support': 84386}, '2': {'precision': 0.4171178500294555, 'recall': 0.5706336109298845, 'f1-score': 0.48194606508492155, 'support': 78171}, 'accuracy': 0.42812894006892493, 'macro avg': {'precision': 0.4367523099989578, 'recall': 0.43234088433467804, 'f1-score': 0.4210889328881504, 'support': 237940}, 'weighted avg': {'precision': 0.4382787377014268, 'recall': 0.42812894006892493, 'f1-score': 0.41922927683648953, 'support': 237940}}
[[33786 12869 28728]
 [27304 23476 33606]
 [21322 12242 44607]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738931
{'0': {'precision': 0.44705923127577724, 'recall': 0.39198346856291977, 'f1-score': 0.4177137305699482, 'support': 32907}, '1': {'precision': 0.45862589992000713, 'recall': 0.324507892585372, 'f1-score': 0.38008249852681203, 'support': 31802}, '2': {'precision': 0.41882378425213906, 'recall': 0.589284081558014, 'f1-score': 0.48964242301458666, 'support': 32811}, 'accuracy': 0.43636177194421655, 'macro avg': {'precision': 0.4415029718159745, 'recall': 0.4352584809021019, 'f1-score': 0.42914621737044895, 'support': 97520}, 'weighted avg': {'precision': 0.44133127746046974, 'recall': 0.43636177194421655, 'f1-score': 0.429642605532676, 'support': 97520}}
[[12899  6483 13525]
 [ 8177 10320 13305]
 [ 7777  5699 19335]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.086343
{'0': {'precision': 0.4339784946236559, 'recall': 0.4063632702376158, 'f1-score': 0.4197171381031614, 'support': 9932}, '1': {'precision': 0.4072449952335558, 'recall': 0.23594388600463934, 'f1-score': 0.29878304657994126, 'support': 9053}, '2': {'precision': 0.4186622625928984, 'recall': 0.6028537455410226, 'f1-score': 0.49415204678362573, 'support': 10092}, 'accuracy': 0.4215015304192317, 'macro avg': {'precision': 0.41996191748337003, 'recall': 0.41505363392775924, 'f1-score': 0.4042174104889095, 'support': 29077}, 'weighted avg': {'precision': 0.42033919952330234, 'recall': 0.4215015304192317, 'f1-score': 0.40789957672624955, 'support': 29077}}
[[4036 1642 4254]
 [2723 2136 4194]
 [2541 1467 6084]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2043905
{'0': {'precision': 0.3518761750238224, 'recall': 0.47509707331208345, 'f1-score': 0.4043065268640081, 'support': 86275}, '1': {'precision': 0.2807017543859649, 'recall': 0.0008305302935924588, 'f1-score': 0.0016561603991346562, 'support': 96324}, '2': {'precision': 0.35994809799714794, 'recall': 0.6236547172541207, 'f1-score': 0.45645117277388825, 'support': 89851}, 'accuracy': 0.35641402092126995, 'macro avg': {'precision': 0.33084200913564504, 'recall': 0.36652744028659884, 'f1-score': 0.28747128667901034, 'support': 272450}, 'weighted avg': {'precision': 0.32937467183995484, 'recall': 0.35641402092126995, 'f1-score': 0.27914724875898395, 'support': 272450}}
[[40989   100 45186]
 [41788    80 54456]
 [33710   105 56036]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1724503
{'0': {'precision': 0.3747639445442402, 'recall': 0.45756945225508944, 'f1-score': 0.4120477046565214, 'support': 35564}, '1': {'precision': 0.8103896103896104, 'recall': 0.01842392748531105, 'f1-score': 0.03602875371690869, 'support': 33869}, '2': {'precision': 0.3564339493497604, 'recall': 0.6274285370041266, 'f1-score': 0.45460993681729395, 'support': 33199}, 'accuracy': 0.3675949021747603, 'macro avg': {'precision': 0.5138625014278703, 'recall': 0.36780730558150904, 'f1-score': 0.3008954650635747, 'support': 102632}, 'weighted avg': {'precision': 0.5125929663508435, 'recall': 0.3675949021747603, 'f1-score': 0.3017277040342179, 'support': 102632}}
[[16273    89 19202]
 [14837   624 18408]
 [12312    57 20830]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1882117
{'0': {'precision': 0.3554220887554221, 'recall': 0.5258169612005134, 'f1-score': 0.4241458947200764, 'support': 10129}, '1': {'precision': 0.3125, 'recall': 0.0004765081482893357, 'f1-score': 0.0009515653249595585, 'support': 10493}, '2': {'precision': 0.3744200244200244, 'recall': 0.5700343898131797, 'f1-score': 0.45196949040126755, 'support': 10759}, 'accuracy': 0.365316592842803, 'macro avg': {'precision': 0.34744737105848217, 'recall': 0.36544261972066083, 'f1-score': 0.29235565014876785, 'support': 31381}, 'weighted avg': {'precision': 0.34758350211079037, 'recall': 0.365316592842803, 'f1-score': 0.292179927019588, 'support': 31381}}
[[5326    4 4799]
 [5040    5 5448]
 [4619    7 6133]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2039015
{'0': {'precision': 0.31776210323821735, 'recall': 0.45002542773075666, 'f1-score': 0.37250155976336696, 'support': 110116}, '1': {'precision': 0.6012922562893082, 'recall': 0.12517452832601125, 'f1-score': 0.207212431899285, 'support': 195527}, '2': {'precision': 0.3221310088769777, 'recall': 0.6257426256302049, 'f1-score': 0.4253121849863194, 'support': 115637}, 'accuracy': 0.3474862324344854, 'macro avg': {'precision': 0.41372845613483444, 'recall': 0.4003141938956576, 'f1-score': 0.33500872554965716, 'support': 421280}, 'weighted avg': {'precision': 0.45055503757397974, 'recall': 0.3474862324344854, 'f1-score': 0.3102825485713479, 'support': 421280}}
[[ 49555   8385  52176]
 [ 70961  24475 100091]
 [ 35434   7844  72359]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1410517
{'0': {'precision': 0.3881577583884272, 'recall': 0.41373597243085625, 'f1-score': 0.4005389279183909, 'support': 45268}, '1': {'precision': 0.44567583613694833, 'recall': 0.10147115146326627, 'f1-score': 0.16530563558622208, 'support': 44387}, '2': {'precision': 0.37526560163689304, 'recall': 0.6365922036311855, 'f1-score': 0.4721832554915585, 'support': 44944}, 'accuracy': 0.3851737382892889, 'macro avg': {'precision': 0.40303306538742284, 'recall': 0.38393310917510265, 'f1-score': 0.3460092729987238, 'support': 134599}, 'weighted avg': {'precision': 0.40282079321025094, 'recall': 0.3851737382892889, 'f1-score': 0.346888325103366, 'support': 134599}}
[[18729  3043 23496]
 [15748  4504 24135]
 [13774  2559 28611]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1318318
{'0': {'precision': 0.38390379278445885, 'recall': 0.40699575024517815, 'f1-score': 0.39511266264677875, 'support': 12236}, '1': {'precision': 0.4855027760641579, 'recall': 0.12689455014511447, 'f1-score': 0.20120158506966637, 'support': 12404}, '2': {'precision': 0.381590156176053, 'recall': 0.6346819899244333, 'f1-score': 0.4766211503221612, 'support': 12704}, 'accuracy': 0.3914149528706084, 'macro avg': {'precision': 0.4169989083415566, 'recall': 0.38952409677157523, 'f1-score': 0.3576451326795354, 'support': 37344}, 'weighted avg': {'precision': 0.4168633404796227, 'recall': 0.3914149528706084, 'f1-score': 0.3584323611568889, 'support': 37344}}
[[4980  834 6422]
 [4185 1574 6645]
 [3807  834 8063]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/EXC
Evaluating performance on  test set...
5928/5928 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.751047
{'0': {'precision': 0.5073219872561385, 'recall': 0.4485827672609823, 'f1-score': 0.4761476493558405, 'support': 276172}, '1': {'precision': 0.7551585834334943, 'recall': 0.774848115515942, 'f1-score': 0.7648766579792196, 'support': 967347}, '2': {'precision': 0.4628048845631991, 'recall': 0.47421081631387085, 'f1-score': 0.46843843042829436, 'support': 274049}, 'accuracy': 0.6611828926282052, 'macro avg': {'precision': 0.5750951517509441, 'recall': 0.5658805663635983, 'f1-score': 0.5698209125877848, 'support': 1517568}, 'weighted avg': {'precision': 0.6572619703913122, 'recall': 0.6611828926282052, 'f1-score': 0.658800707780191, 'support': 1517568}}
[[123886 121258  31028]
 [ 97982 749547 119818]
 [ 22328 121764 129957]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77517754
{'0': {'precision': 0.5479617304492512, 'recall': 0.40438366256849473, 'f1-score': 0.4653495950755535, 'support': 65151}, '1': {'precision': 0.7076903356939797, 'recall': 0.8133233721957995, 'f1-score': 0.7568387941691247, 'support': 190072}, '2': {'precision': 0.5218301710045369, 'recall': 0.43213726176170847, 'f1-score': 0.47276721082322404, 'support': 65743}, 'accuracy': 0.6522373086245895, 'macro avg': {'precision': 0.5924940790492559, 'recall': 0.5499480988420009, 'f1-score': 0.5649852000226341, 'support': 320966}, 'weighted avg': {'precision': 0.6371984980305594, 'recall': 0.6522373086245895, 'f1-score': 0.6394851463869458, 'support': 320966}}
[[ 26346  31878   6927]
 [ 16376 154590  19106]
 [  5358  31975  28410]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7596875
{'0': {'precision': 0.5479092443277704, 'recall': 0.411240382811034, 'f1-score': 0.469837866809594, 'support': 21316}, '1': {'precision': 0.7167671454055391, 'recall': 0.8291959148013135, 'f1-score': 0.7688933896707056, 'support': 66386}, '2': {'precision': 0.5382928166697131, 'recall': 0.41075828722860197, 'f1-score': 0.4659564368967882, 'support': 21509}, 'accuracy': 0.6652077171713472, 'macro avg': {'precision': 0.6009897354676742, 'recall': 0.5503981949469832, 'f1-score': 0.5682292311256959, 'support': 109211}, 'weighted avg': {'precision': 0.648658810566076, 'recall': 0.6652077171713472, 'f1-score': 0.6508600556427996, 'support': 109211}}
[[ 8766 10632  1918]
 [ 5679 55047  5660]
 [ 1554 11120  8835]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/AAL
Evaluating performance on  test set...
5331/5331 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77241546
{'0': {'precision': 0.5115778555685206, 'recall': 0.4141128761418592, 'f1-score': 0.4577143745374484, 'support': 238208}, '1': {'precision': 0.7558947494354317, 'recall': 0.806953040584834, 'f1-score': 0.7805898569445758, 'support': 884764}, '2': {'precision': 0.4500437845711092, 'recall': 0.4232604530085379, 'f1-score': 0.43624141034554825, 'support': 241629}, 'accuracy': 0.670437732348137, 'macro avg': {'precision': 0.5725054631916872, 'recall': 0.5481087899117436, 'f1-score': 0.5581818806091908, 'support': 1364601}, 'weighted avg': {'precision': 0.6590893818272806, 'recall': 0.670437732348137, 'f1-score': 0.6632543913275101, 'support': 1364601}}
[[ 98645 109794  29769]
 [ 75593 713963  95208]
 [ 18587 120770 102272]]
Evaluating performance on  train set...
2013/2013 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.844493
{'0': {'precision': 0.5274381501081884, 'recall': 0.38574615340616597, 'f1-score': 0.44559950665139636, 'support': 104898}, '1': {'precision': 0.7185227935889706, 'recall': 0.7244745696591408, 'f1-score': 0.721486407298651, 'support': 307605}, '2': {'precision': 0.3876937690265418, 'recall': 0.48435417821743654, 'f1-score': 0.4306669088330176, 'support': 102807}, 'accuracy': 0.6076167743688266, 'macro avg': {'precision': 0.5445515709079003, 'recall': 0.5315249670942478, 'f1-score': 0.5325842742610217, 'support': 515310}, 'weighted avg': {'precision': 0.6136229537643277, 'recall': 0.6076167743688266, 'f1-score': 0.6073060803442893, 'support': 515310}}
[[ 40464  43706  20728]
 [ 26837 222852  57916]
 [  9417  43595  49795]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8035564
{'0': {'precision': 0.532498134548168, 'recall': 0.39778794813119756, 'f1-score': 0.45538967908781003, 'support': 34086}, '1': {'precision': 0.7300733287858118, 'recall': 0.7765624574864637, 'f1-score': 0.7526006530748576, 'support': 110259}, '2': {'precision': 0.4195987040300119, 'recall': 0.4396141019533111, 'f1-score': 0.4293732732296059, 'support': 33584}, 'accuracy': 0.6404015084668604, 'macro avg': {'precision': 0.5607233891213306, 'recall': 0.5379881691903241, 'f1-score': 0.5457878684640912, 'support': 177929}, 'weighted avg': {'precision': 0.6336217786248874, 'recall': 0.6404015084668604, 'f1-score': 0.6346547219222887, 'support': 177929}}
[[13559 15693  4834]
 [ 9048 85623 15588]
 [ 2856 15964 14764]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/WBA
Evaluating performance on  test set...
4192/4192 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96006113
{'0': {'precision': 0.5236856271308092, 'recall': 0.36532395353494895, 'f1-score': 0.43040009438275156, 'support': 319552}, '1': {'precision': 0.5460745841852748, 'recall': 0.6768863953842864, 'f1-score': 0.6044844652856226, 'support': 439542}, '2': {'precision': 0.48681198856547836, 'recall': 0.47338808027995455, 'f1-score': 0.480006199127602, 'support': 314051}, 'accuracy': 0.524559122951698, 'macro avg': {'precision': 0.5188573999605208, 'recall': 0.50519947639973, 'f1-score': 0.5049635862653253, 'support': 1073145}, 'weighted avg': {'precision': 0.5220648619001584, 'recall': 0.524559122951698, 'f1-score': 0.5162191023980848, 'support': 1073145}}
[[116740 128855  73957]
 [ 59256 297520  82766]
 [ 46924 118459 148668]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0054682
{'0': {'precision': 0.5315409619304722, 'recall': 0.3637906167811996, 'f1-score': 0.43195084141543594, 'support': 106083}, '1': {'precision': 0.4652141730281801, 'recall': 0.5979970975213601, 'f1-score': 0.5233141011623408, 'support': 104049}, '2': {'precision': 0.4879280474768698, 'recall': 0.5055425597937652, 'f1-score': 0.4965791485151301, 'support': 104735}, 'accuracy': 0.48833634518701546, 'macro avg': {'precision': 0.49489439414517405, 'recall': 0.4891100913654416, 'f1-score': 0.4839480303643023, 'support': 314867}, 'weighted avg': {'precision': 0.4951159486588602, 'recall': 0.48833634518701546, 'f1-score': 0.4836396546524286, 'support': 314867}}
[[38592 37408 30083]
 [16343 62221 25485]
 [17669 34118 52948]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0022434
{'0': {'precision': 0.5211349160393747, 'recall': 0.3702615339406406, 'f1-score': 0.4329301814183617, 'support': 34030}, '1': {'precision': 0.48097887095567143, 'recall': 0.5693825118861294, 'f1-score': 0.5214604462474645, 'support': 33863}, '2': {'precision': 0.478146392838336, 'recall': 0.5286446204005589, 'f1-score': 0.5021290715036223, 'support': 34352}, 'accuracy': 0.48942246564624187, 'macro avg': {'precision': 0.4934200599444607, 'recall': 0.4894295554091097, 'f1-score': 0.48550656638981615, 'support': 102245}, 'weighted avg': {'precision': 0.49339227919970996, 'recall': 0.48942246564624187, 'f1-score': 0.4855001910043247, 'support': 102245}}
[[12600 10580 10850]
 [ 5612 19281  8970]
 [ 5966 10226 18160]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92665035
{'0': {'precision': 0.5611208668766962, 'recall': 0.37253795006900015, 'f1-score': 0.447784166321096, 'support': 462318}, '1': {'precision': 0.5537191771258887, 'recall': 0.744850764158967, 'f1-score': 0.6352190037659585, 'support': 654903}, '2': {'precision': 0.529156645302201, 'recall': 0.4470057723227229, 'f1-score': 0.48462442446518567, 'support': 455276}, 'accuracy': 0.5491565325720812, 'macro avg': {'precision': 0.5479988964349286, 'recall': 0.52146482885023, 'f1-score': 0.5225425315174134, 'support': 1572497}, 'weighted avg': {'precision': 0.5487838438080207, 'recall': 0.5491565325720812, 'f1-score': 0.5365119176070835, 'support': 1572497}}
[[172231 200895  89192]
 [ 75206 487805  91892]
 [ 59504 192261 203511]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9866449
{'0': {'precision': 0.5548783724015922, 'recall': 0.3537855031921853, 'f1-score': 0.4320803973026402, 'support': 177308}, '1': {'precision': 0.4857777830977261, 'recall': 0.6735748428786403, 'f1-score': 0.564466214320983, 'support': 180752}, '2': {'precision': 0.49994986345163595, 'recall': 0.48391148461942496, 'f1-score': 0.49179994952029776, 'support': 175156}, 'accuracy': 0.5049342105263158, 'macro avg': {'precision': 0.5135353396503181, 'recall': 0.5037572768967502, 'f1-score': 0.496115520381307, 'support': 533216}, 'weighted avg': {'precision': 0.5134108852453723, 'recall': 0.5049342105263158, 'f1-score': 0.4965744092714024, 'support': 533216}}
[[ 62729  66356  48223]
 [ 22448 121750  36554]
 [ 27873  62523  84760]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97705644
{'0': {'precision': 0.5499342793529869, 'recall': 0.36059662638734985, 'f1-score': 0.4355798240768282, 'support': 56853}, '1': {'precision': 0.5032723239046034, 'recall': 0.6647402607973693, 'f1-score': 0.5728454988005218, 'support': 61427}, '2': {'precision': 0.49408904314734226, 'recall': 0.492925315943965, 'f1-score': 0.49350649350649356, 'support': 56893}, 'accuracy': 0.5102270327048118, 'macro avg': {'precision': 0.5157652154683109, 'recall': 0.5060874010428947, 'f1-score': 0.5006439387946146, 'support': 175173}, 'weighted avg': {'precision': 0.5154340597941759, 'recall': 0.5102270327048118, 'f1-score': 0.5025275877453974, 'support': 175173}}
[[20501 20341 16011]
 [ 7890 40833 12704]
 [ 8888 19961 28044]]
testing model on single stock: results/universal/W7/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
23942/23942 - 180s - 180s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1573609
{'0': {'precision': 0.3950422436332479, 'recall': 0.4656206567128183, 'f1-score': 0.42743756896191815, 'support': 1923946}, '1': {'precision': 0.47209410737842317, 'recall': 0.08290369327880388, 'f1-score': 0.1410396402669847, 'support': 2296496}, '2': {'precision': 0.36630417432020396, 'recall': 0.6636821321407071, 'f1-score': 0.47206362628297804, 'support': 1908617}, 'accuracy': 0.38389775657242003, 'macro avg': {'precision': 0.41114684177729166, 'recall': 0.4040688273774431, 'f1-score': 0.34684694517062703, 'support': 6129059}, 'weighted avg': {'precision': 0.4149636262215516, 'recall': 0.38389775657242003, 'f1-score': 0.33402393955971293, 'support': 6129059}}
[[ 895829  116439  911678]
 [ 826405  190388 1279703]
 [ 545445   96457 1266715]]
Evaluating performance on  train set...
9052/9052 - 70s - 70s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1246082
{'0': {'precision': 0.42291824178903303, 'recall': 0.45364237123672596, 'f1-score': 0.43774185422772594, 'support': 771901}, '1': {'precision': 0.4708056171470806, 'recall': 0.0827101500139485, 'f1-score': 0.1407020559554036, 'support': 777861}, '2': {'precision': 0.38782000329772626, 'recall': 0.6835593158490113, 'f1-score': 0.4948723041207908, 'support': 767316}, 'accuracy': 0.4052561027293859, 'macro avg': {'precision': 0.42718128741128, 'recall': 0.4066372790332286, 'f1-score': 0.3577720714346401, 'support': 2317078}, 'weighted avg': {'precision': 0.4273713856698997, 'recall': 0.4052561027293859, 'f1-score': 0.3569424308877434, 'support': 2317078}}
[[350167  38874 382860]
 [268443  64337 445081]
 [209368  33442 524506]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1249379
{'0': {'precision': 0.4100756527455445, 'recall': 0.4830682873192917, 'f1-score': 0.44358929027442195, 'support': 233733}, '1': {'precision': 0.4630650939978262, 'recall': 0.0970001054073996, 'f1-score': 0.16040047828709078, 'support': 237175}, '2': {'precision': 0.3954040727710276, 'recall': 0.6394127052612878, 'f1-score': 0.48863990845335636, 'support': 236406}, 'accuracy': 0.4058678323912718, 'macro avg': {'precision': 0.42284827317146617, 'recall': 0.4064936993293264, 'f1-score': 0.3642098923382897, 'support': 707314}, 'weighted avg': {'precision': 0.4229402661895797, 'recall': 0.4058678323912718, 'f1-score': 0.36368832685239705, 'support': 707314}}
[[112909  13621 107203]
 [ 90238  23006 123931]
 [ 72190  13055 151161]]
training model: results/universal/W7/deepVOL_L2/h10
Epoch 1/50
12475/12475 - 403s - loss: 2.8932 - accuracy10: 0.5090 - val_loss: 3.0042 - val_accuracy10: 0.5102 - 403s/epoch - 32ms/step
Epoch 2/50
12475/12475 - 386s - loss: 2.8079 - accuracy10: 0.5369 - val_loss: 2.9586 - val_accuracy10: 0.5249 - 386s/epoch - 31ms/step
Epoch 3/50
12475/12475 - 388s - loss: 2.7799 - accuracy10: 0.5432 - val_loss: 2.9423 - val_accuracy10: 0.5265 - 388s/epoch - 31ms/step
Epoch 4/50
12475/12475 - 378s - loss: 2.7630 - accuracy10: 0.5468 - val_loss: 2.9242 - val_accuracy10: 0.5313 - 378s/epoch - 30ms/step
Epoch 5/50
12475/12475 - 386s - loss: 2.7517 - accuracy10: 0.5492 - val_loss: 2.9068 - val_accuracy10: 0.5344 - 386s/epoch - 31ms/step
Epoch 6/50
12475/12475 - 382s - loss: 2.7432 - accuracy10: 0.5511 - val_loss: 2.8992 - val_accuracy10: 0.5340 - 382s/epoch - 31ms/step
Epoch 7/50
12475/12475 - 380s - loss: 2.7360 - accuracy10: 0.5528 - val_loss: 2.8929 - val_accuracy10: 0.5333 - 380s/epoch - 30ms/step
Epoch 8/50
12475/12475 - 377s - loss: 2.7301 - accuracy10: 0.5539 - val_loss: 2.8862 - val_accuracy10: 0.5340 - 377s/epoch - 30ms/step
Epoch 9/50
12475/12475 - 380s - loss: 2.7253 - accuracy10: 0.5553 - val_loss: 2.8806 - val_accuracy10: 0.5331 - 380s/epoch - 30ms/step
Epoch 10/50
12475/12475 - 380s - loss: 2.7207 - accuracy10: 0.5563 - val_loss: 2.8790 - val_accuracy10: 0.5325 - 380s/epoch - 30ms/step
Epoch 11/50
12475/12475 - 383s - loss: 2.7170 - accuracy10: 0.5570 - val_loss: 2.8714 - val_accuracy10: 0.5342 - 383s/epoch - 31ms/step
Epoch 12/50
12475/12475 - 386s - loss: 2.7135 - accuracy10: 0.5578 - val_loss: 2.8755 - val_accuracy10: 0.5333 - 386s/epoch - 31ms/step
Epoch 13/50
12475/12475 - 383s - loss: 2.7101 - accuracy10: 0.5586 - val_loss: 2.8625 - val_accuracy10: 0.5342 - 383s/epoch - 31ms/step
Epoch 14/50
12475/12475 - 383s - loss: 2.7074 - accuracy10: 0.5589 - val_loss: 2.8611 - val_accuracy10: 0.5342 - 383s/epoch - 31ms/step
Epoch 15/50
12475/12475 - 382s - loss: 2.7045 - accuracy10: 0.5596 - val_loss: 2.8591 - val_accuracy10: 0.5335 - 382s/epoch - 31ms/step
Epoch 16/50
12475/12475 - 383s - loss: 2.7016 - accuracy10: 0.5605 - val_loss: 2.8464 - val_accuracy10: 0.5350 - 383s/epoch - 31ms/step
Epoch 17/50
12475/12475 - 381s - loss: 2.6995 - accuracy10: 0.5606 - val_loss: 2.8552 - val_accuracy10: 0.5331 - 381s/epoch - 31ms/step
Epoch 18/50
12475/12475 - 381s - loss: 2.6969 - accuracy10: 0.5613 - val_loss: 2.8457 - val_accuracy10: 0.5328 - 381s/epoch - 31ms/step
Epoch 19/50
12475/12475 - 385s - loss: 2.6955 - accuracy10: 0.5618 - val_loss: 2.8546 - val_accuracy10: 0.5324 - 385s/epoch - 31ms/step
Epoch 20/50
12475/12475 - 381s - loss: 2.6930 - accuracy10: 0.5624 - val_loss: 2.8423 - val_accuracy10: 0.5343 - 381s/epoch - 31ms/step
Epoch 21/50
12475/12475 - 380s - loss: 2.6913 - accuracy10: 0.5626 - val_loss: 2.8531 - val_accuracy10: 0.5332 - 380s/epoch - 30ms/step
Epoch 22/50
12475/12475 - 376s - loss: 2.6893 - accuracy10: 0.5631 - val_loss: 2.8466 - val_accuracy10: 0.5330 - 376s/epoch - 30ms/step
Epoch 23/50
12475/12475 - 385s - loss: 2.6871 - accuracy10: 0.5637 - val_loss: 2.8452 - val_accuracy10: 0.5328 - 385s/epoch - 31ms/step
Epoch 24/50
12475/12475 - 391s - loss: 2.6857 - accuracy10: 0.5639 - val_loss: 2.8404 - val_accuracy10: 0.5362 - 391s/epoch - 31ms/step
Epoch 25/50
12475/12475 - 377s - loss: 2.6841 - accuracy10: 0.5645 - val_loss: 2.8319 - val_accuracy10: 0.5356 - 377s/epoch - 30ms/step
Epoch 26/50
12475/12475 - 380s - loss: 2.6821 - accuracy10: 0.5647 - val_loss: 2.8446 - val_accuracy10: 0.5330 - 380s/epoch - 30ms/step
Epoch 27/50
12475/12475 - 385s - loss: 2.6808 - accuracy10: 0.5650 - val_loss: 2.8407 - val_accuracy10: 0.5315 - 385s/epoch - 31ms/step
Epoch 28/50
12475/12475 - 382s - loss: 2.6791 - accuracy10: 0.5652 - val_loss: 2.8437 - val_accuracy10: 0.5340 - 382s/epoch - 31ms/step
Epoch 29/50
12475/12475 - 379s - loss: 2.6781 - accuracy10: 0.5655 - val_loss: 2.8379 - val_accuracy10: 0.5336 - 379s/epoch - 30ms/step
Epoch 30/50
12475/12475 - 383s - loss: 2.6761 - accuracy10: 0.5660 - val_loss: 2.8408 - val_accuracy10: 0.5318 - 383s/epoch - 31ms/step
Epoch 31/50
12475/12475 - 378s - loss: 2.6752 - accuracy10: 0.5663 - val_loss: 2.8427 - val_accuracy10: 0.5351 - 378s/epoch - 30ms/step
Epoch 32/50
12475/12475 - 388s - loss: 2.6737 - accuracy10: 0.5663 - val_loss: 2.8450 - val_accuracy10: 0.5349 - 388s/epoch - 31ms/step
Epoch 33/50
12475/12475 - 377s - loss: 2.6727 - accuracy10: 0.5668 - val_loss: 2.8402 - val_accuracy10: 0.5337 - 377s/epoch - 30ms/step
Epoch 34/50
12475/12475 - 380s - loss: 2.6714 - accuracy10: 0.5670 - val_loss: 2.8364 - val_accuracy10: 0.5357 - 380s/epoch - 30ms/step
Epoch 35/50
12475/12475 - 380s - loss: 2.6703 - accuracy10: 0.5672 - val_loss: 2.8400 - val_accuracy10: 0.5340 - 380s/epoch - 30ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 573s - 573s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8964043
{'0': {'precision': 0.45525653906351454, 'recall': 0.5512836534880449, 'f1-score': 0.4986894512240773, 'support': 2416540}, '1': {'precision': 0.726832559343054, 'recall': 0.5549829299306583, 'f1-score': 0.6293880308495345, 'support': 4691838}, '2': {'precision': 0.45370070358499665, 'recall': 0.5671831316113757, 'f1-score': 0.5041345097292561, 'support': 2397194}, 'accuracy': 0.5571192349076941, 'macro avg': {'precision': 0.5452632673305218, 'recall': 0.557816571676693, 'f1-score': 0.5440706639342894, 'support': 9505572}, 'weighted avg': {'precision': 0.5889108896236096, 'recall': 0.5571192349076941, 'f1-score': 0.5645739055221469, 'support': 9505572}}
[[1332199  470617  613724]
 [1064525 2603890 1023423]
 [ 529536  508010 1359648]]
Evaluating performance on  train set...
12475/12475 - 193s - 193s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9432575
{'0': {'precision': 0.47567356788929843, 'recall': 0.5292526425706524, 'f1-score': 0.5010347828248926, 'support': 951914}, '1': {'precision': 0.6795407247059208, 'recall': 0.5139438300286431, 'f1-score': 0.5852539294795892, 'support': 1297348}, '2': {'precision': 0.4697471264367816, 'recall': 0.5737321232181491, 'f1-score': 0.5165584582833311, 'support': 943822}, 'accuracy': 0.5361800691745034, 'macro avg': {'precision': 0.5416538063440003, 'recall': 0.5389761986058149, 'f1-score': 0.5342823901959376, 'support': 3193084}, 'weighted avg': {'precision': 0.5567529075925866, 'recall': 0.5361800691745034, 'f1-score': 0.5398415063225244, 'support': 3193084}}
[[503803 151473 296638]
 [315973 666764 314611]
 [239360 162961 541501]]
Evaluating performance on  val set...
3866/3866 - 65s - 65s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9383776
{'0': {'precision': 0.46609051163306964, 'recall': 0.5295962051835399, 'f1-score': 0.49581813649602485, 'support': 285442}, '1': {'precision': 0.6885159206422091, 'recall': 0.5224191164986725, 'f1-score': 0.5940762599560091, 'support': 416185}, '2': {'precision': 0.4622425039317297, 'recall': 0.5611092758410849, 'f1-score': 0.5069000939279802, 'support': 287575}, 'accuracy': 0.5357378978206676, 'macro avg': {'precision': 0.5389496454023361, 'recall': 0.5377081991744325, 'f1-score': 0.5322648301266714, 'support': 989202}, 'weighted avg': {'precision': 0.558552443608294, 'recall': 0.5357378978206676, 'f1-score': 0.540379763970179, 'support': 989202}}
[[151169  45829  88444]
 [ 99484 217423  99278]
 [ 73681  52533 161361]]
testing model out of sample: results/universal/W7/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 231s - 231s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7194647
{'0': {'precision': 0.46497501292434945, 'recall': 0.5139660579203088, 'f1-score': 0.48824465852264753, 'support': 713981}, '1': {'precision': 0.8023557347646835, 'recall': 0.7856461423709095, 'f1-score': 0.7939130260527089, 'support': 2344847}, '2': {'precision': 0.4948667711598746, 'recall': 0.47661000176116874, 'f1-score': 0.48556683854596094, 'support': 715434}, 'accuracy': 0.6756724890852834, 'macro avg': {'precision': 0.5873991729496358, 'recall': 0.5920740673507957, 'f1-score': 0.5892415077071057, 'support': 3774262}, 'weighted avg': {'precision': 0.6802467014363331, 'recall': 0.6756724890852834, 'f1-score': 0.6776405592684254, 'support': 3774262}}
[[ 366962  206898  140121]
 [ 294691 1842220  207936]
 [ 127555  246896  340983]]
Evaluating performance on  train set...
5285/5285 - 88s - 88s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.779318
{'0': {'precision': 0.4806147927083951, 'recall': 0.4954211925611781, 'f1-score': 0.48790568659284284, 'support': 294509}, '1': {'precision': 0.7662618646955796, 'recall': 0.7563543439005469, 'f1-score': 0.7612758706439915, 'support': 766995}, '2': {'precision': 0.4882049139342297, 'recall': 0.4896201853391129, 'f1-score': 0.48891152542837935, 'support': 291142}, 'accuracy': 0.6421303134744789, 'macro avg': {'precision': 0.5783605237794015, 'recall': 0.5804652406002794, 'f1-score': 0.5793643608884046, 'support': 1352646}, 'weighted avg': {'precision': 0.6442198150518186, 'recall': 0.6421303134744789, 'f1-score': 0.6431321140887039, 'support': 1352646}}
[[145906  82515  66088]
 [103526 580120  83349]
 [ 54150  94443 142549]]
Evaluating performance on  val set...
1714/1714 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7425424
{'0': {'precision': 0.484404363322173, 'recall': 0.49615584587984113, 'f1-score': 0.4902096870269473, 'support': 90397}, '1': {'precision': 0.7804059908881195, 'recall': 0.7872977761200989, 'f1-score': 0.7838367350096412, 'support': 257388}, '2': {'precision': 0.502826900434818, 'recall': 0.47794435395406043, 'f1-score': 0.49006998727504086, 'support': 90249}, 'accuracy': 0.6634781774930714, 'macro avg': {'precision': 0.5892124182150368, 'recall': 0.5871326586513335, 'f1-score': 0.5880388031038765, 'support': 438034}, 'weighted avg': {'precision': 0.6621300249553406, 'recall': 0.6634781774930714, 'f1-score': 0.6627156360246502, 'support': 438034}}
[[ 44851  26365  19181]
 [ 31279 202641  23468]
 [ 16460  30655  43134]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0303962
{'0': {'precision': 0.42546523016650345, 'recall': 0.5344892859847051, 'f1-score': 0.4737862122775667, 'support': 52828}, '1': {'precision': 0.7281083696178036, 'recall': 0.24829179097295737, 'f1-score': 0.37030582011666885, 'support': 72737}, '2': {'precision': 0.419111290415538, 'recall': 0.6944364865639145, 'f1-score': 0.5227367482783903, 'support': 52359}, 'accuracy': 0.4645579011263236, 'macro avg': {'precision': 0.5242282967332818, 'recall': 0.4924058545071923, 'f1-score': 0.455609593557542, 'support': 177924}, 'weighted avg': {'precision': 0.5473187637136833, 'recall': 0.4645579011263236, 'f1-score': 0.4458874905191749, 'support': 177924}}
[[28236  3393 21199]
 [25481 18060 29196]
 [12648  3351 36360]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0661335
{'0': {'precision': 0.43821790381501147, 'recall': 0.4981377627466929, 'f1-score': 0.46626061868889246, 'support': 23359}, '1': {'precision': 0.634427542033627, 'recall': 0.1545241809672387, 'f1-score': 0.24851811196487378, 'support': 25640}, '2': {'precision': 0.4126486045206388, 'recall': 0.7033526112101578, 'f1-score': 0.5201382747809309, 'support': 22997}, 'accuracy': 0.44131618423245733, 'macro avg': {'precision': 0.4950980167897591, 'recall': 0.4520048516413631, 'f1-score': 0.4116390018115657, 'support': 71996}, 'weighted avg': {'precision': 0.4999268591465939, 'recall': 0.44131618423245733, 'f1-score': 0.4059254137434062, 'support': 71996}}
[[11636  1240 10483]
 [ 9138  3962 12540]
 [ 5779  1043 16175]]
Evaluating performance on  val set...
73/73 - 1s - 682ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0634347
{'0': {'precision': 0.42416317991631797, 'recall': 0.5527347077866758, 'f1-score': 0.4799881630539321, 'support': 5869}, '1': {'precision': 0.6749688667496887, 'recall': 0.16829684831547898, 'f1-score': 0.2694171741021499, 'support': 6441}, '2': {'precision': 0.4288956127080182, 'recall': 0.6403678606001936, 'f1-score': 0.5137199068081801, 'support': 6198}, 'accuracy': 0.44829263021396154, 'macro avg': {'precision': 0.5093425531246749, 'recall': 0.4537998055674494, 'f1-score': 0.4210417479880874, 'support': 18508}, 'weighted avg': {'precision': 0.5130312935610498, 'recall': 0.44829263021396154, 'f1-score': 0.4180031624028839, 'support': 18508}}
[[3244  225 2400]
 [2472 1084 2885]
 [1932  297 3969]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
2006/2006 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46621057
{'0': {'precision': 0.476423674268924, 'recall': 0.49328421531902567, 'f1-score': 0.484707365681051, 'support': 48319}, '1': {'precision': 0.8971526737936878, 'recall': 0.9268235943064765, 'f1-score': 0.9117468031897324, 'support': 416965}, '2': {'precision': 0.6050205862471578, 'recall': 0.40983640677683886, 'f1-score': 0.48865892396267613, 'support': 48046}, 'accuracy': 0.8376268677069332, 'macro avg': {'precision': 0.6595323114365899, 'recall': 0.6099814054674471, 'f1-score': 0.6283710309444865, 'support': 513330}, 'weighted avg': {'precision': 0.8302074673839754, 'recall': 0.8376268677069332, 'f1-score': 0.8319505730330592, 'support': 513330}}
[[ 23835  20676   3808]
 [ 21465 386453   9047]
 [  4729  23626  19691]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46167883
{'0': {'precision': 0.5418363426815214, 'recall': 0.4896202180101368, 'f1-score': 0.5144065942081845, 'support': 14403}, '1': {'precision': 0.889400881365417, 'recall': 0.9317145107809551, 'f1-score': 0.910066117329182, 'support': 109174}, '2': {'precision': 0.5727792003151467, 'recall': 0.4166189111747851, 'f1-score': 0.48237538359459237, 'support': 13960}, 'accuracy': 0.8331358107272951, 'macro avg': {'precision': 0.6680054747873617, 'recall': 0.6126512133219589, 'f1-score': 0.635616031710653, 'support': 137537}, 'weighted avg': {'precision': 0.8208665181167936, 'recall': 0.8331358107272951, 'f1-score': 0.8252216990675753, 'support': 137537}}
[[  7052   5950   1401]
 [  4518 101719   2937]
 [  1445   6699   5816]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4815589
{'0': {'precision': 0.5264389330837623, 'recall': 0.5154639175257731, 'f1-score': 0.5208936219469845, 'support': 4365}, '1': {'precision': 0.8826683488408769, 'recall': 0.9239327808775463, 'f1-score': 0.9028293060618768, 'support': 30289}, '2': {'precision': 0.5848257896450667, 'recall': 0.40855323020928114, 'f1-score': 0.4810499531270925, 'support': 4396}, 'accuracy': 0.8202560819462228, 'macro avg': {'precision': 0.664644357189902, 'recall': 0.6159833095375336, 'f1-score': 0.6349242937119847, 'support': 39050}, 'weighted avg': {'precision': 0.8093198907101576, 'recall': 0.8202560819462228, 'f1-score': 0.8126553932151978, 'support': 39050}}
[[ 2250  1646   469]
 [ 1498 27985   806]
 [  526  2074  1796]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0204539
{'0': {'precision': 0.4266390675330138, 'recall': 0.5525878136200717, 'f1-score': 0.48151363911775175, 'support': 69750}, '1': {'precision': 0.6126301465236241, 'recall': 0.40368895191224924, 'f1-score': 0.4866818347516749, 'support': 95908}, '2': {'precision': 0.4575978011041869, 'recall': 0.5343146070524437, 'f1-score': 0.4929894762369729, 'support': 72287}, 'accuracy': 0.4870201096892139, 'macro avg': {'precision': 0.498955671720275, 'recall': 0.4968637908615882, 'f1-score': 0.48706165003546653, 'support': 237945}, 'weighted avg': {'precision': 0.5110112811852899, 'recall': 0.4870201096892139, 'f1-score': 0.4870830990546929, 'support': 237945}}
[[38543 12294 18913]
 [30322 38717 26869]
 [21476 12187 38624]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99927884
{'0': {'precision': 0.4836269875376021, 'recall': 0.5371666772735951, 'f1-score': 0.5089927786404548, 'support': 31426}, '1': {'precision': 0.581592987804878, 'recall': 0.4365274599542334, 'f1-score': 0.4987254901960784, 'support': 34960}, '2': {'precision': 0.47924455685067074, 'recall': 0.5599164926931106, 'f1-score': 0.5164491712461673, 'support': 31135}, 'accuracy': 0.5083520472513613, 'macro avg': {'precision': 0.5148215107310502, 'recall': 0.5112035433069797, 'f1-score': 0.5080558133609001, 'support': 97521}, 'weighted avg': {'precision': 0.5173473594565361, 'recall': 0.5083520472513613, 'f1-score': 0.5076926523062648, 'support': 97521}}
[[16881  5376  9169]
 [ 9925 15261  9774]
 [ 8099  5603 17433]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0214847
{'0': {'precision': 0.48312897162803187, 'recall': 0.5533572526909277, 'f1-score': 0.5158639143730887, 'support': 9755}, '1': {'precision': 0.5362167015863514, 'recall': 0.3676757311441765, 'f1-score': 0.43623303098557253, 'support': 9745}, '2': {'precision': 0.47602922830155053, 'recall': 0.5577947165083011, 'f1-score': 0.5136785422376076, 'support': 9577}, 'accuracy': 0.4925886439453864, 'macro avg': {'precision': 0.4984583005053113, 'recall': 0.4929425667811351, 'f1-score': 0.48859182919875627, 'support': 29077}, 'weighted avg': {'precision': 0.4985826183799702, 'recall': 0.4925886439453864, 'f1-score': 0.4884562633928346, 'support': 29077}}
[[5398 1515 2842]
 [3124 3583 3038]
 [2651 1584 5342]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2360885
{'0': {'precision': 0.3369897857795795, 'recall': 0.5768812083276637, 'f1-score': 0.42544971022855566, 'support': 88188}, '1': {'precision': 0.35723598435462844, 'recall': 0.0028389369528052633, 'f1-score': 0.00563310787195987, 'support': 96515}, '2': {'precision': 0.35252895081261076, 'recall': 0.4849803993071383, 'f1-score': 0.40828112858198146, 'support': 87752}, 'accuracy': 0.34393202547209634, 'macro avg': {'precision': 0.3489182403156062, 'recall': 0.3549001815292024, 'f1-score': 0.27978798222749895, 'support': 272455}, 'weighted avg': {'precision': 0.3491666761484456, 'recall': 0.34393202547209634, 'f1-score': 0.2712034062403851, 'support': 272455}}
[[50874   258 37056]
 [55133   274 41108]
 [44959   235 42558]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2101996
{'0': {'precision': 0.3605319725275685, 'recall': 0.5831472425587246, 'f1-score': 0.44558197801248406, 'support': 35377}, '1': {'precision': 0.6267123287671232, 'recall': 0.01079646017699115, 'f1-score': 0.021227235819510498, 'support': 33900}, '2': {'precision': 0.354897717893234, 'recall': 0.47695997601558987, 'f1-score': 0.40697347215471597, 'support': 33355}, 'accuracy': 0.3595857042637774, 'macro avg': {'precision': 0.44738067306264195, 'recall': 0.35696789291710185, 'f1-score': 0.29126089532890354, 'support': 102632}, 'weighted avg': {'precision': 0.44662192023581426, 'recall': 0.3595857042637774, 'f1-score': 0.29286730351303303, 'support': 102632}}
[[20630   119 14628]
 [19244   366 14290]
 [17347    99 15909]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2311141
{'0': {'precision': 0.33796068796068796, 'recall': 0.5480625560314772, 'f1-score': 0.41810099167901515, 'support': 10039}, '1': {'precision': 0.39166666666666666, 'recall': 0.004354270891235872, 'f1-score': 0.008612790910756826, 'support': 10794}, '2': {'precision': 0.3597223149322475, 'recall': 0.510902540766022, 'f1-score': 0.42218653296251324, 'support': 10548}, 'accuracy': 0.34855485803511677, 'macro avg': {'precision': 0.36311655651986735, 'recall': 0.35443978922957836, 'f1-score': 0.28296677185076174, 'support': 31381}, 'weighted avg': {'precision': 0.36374839311502793, 'recall': 0.34855485803511677, 'f1-score': 0.2786241952214694, 'support': 31381}}
[[5502   40 4497]
 [5652   47 5095]
 [5126   33 5389]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
1646/1646 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0692781
{'0': {'precision': 0.4174653449055983, 'recall': 0.5507380073800738, 'f1-score': 0.47492922155408407, 'support': 128996}, '1': {'precision': 0.6295895969136623, 'recall': 0.23462956651070555, 'f1-score': 0.3418585017674864, 'support': 161365}, '2': {'precision': 0.42591584106570596, 'recall': 0.6212611896978399, 'f1-score': 0.5053681934537863, 'support': 130924}, 'accuracy': 0.45157553675065576, 'macro avg': {'precision': 0.4909902609616555, 'recall': 0.4688762545295398, 'f1-score': 0.4407186389251189, 'support': 421285}, 'weighted avg': {'precision': 0.5013415870802477, 'recall': 0.45157553675065576, 'f1-score': 0.43341868891853397, 'support': 421285}}
[[71043 11274 46679]
 [60549 37861 62955]
 [38585 11001 81338]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0842993
{'0': {'precision': 0.45162393777905807, 'recall': 0.543942580827027, 'f1-score': 0.4935029165560048, 'support': 46117}, '1': {'precision': 0.555933682373473, 'recall': 0.14903272591171723, 'f1-score': 0.2350532199450276, 'support': 42749}, '2': {'precision': 0.43344280726670215, 'recall': 0.6406393492806227, 'f1-score': 0.5170563840112944, 'support': 45734}, 'accuracy': 0.4513744427934621, 'macro avg': {'precision': 0.48033347580641106, 'recall': 0.4445382186731223, 'f1-score': 0.415204173504109, 'support': 134600}, 'weighted avg': {'precision': 0.47857521154439653, 'recall': 0.4513744427934621, 'f1-score': 0.41942214538347544, 'support': 134600}}
[[25085  2528 18504]
 [16585  6371 19793]
 [13874  2561 29299]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0630443
{'0': {'precision': 0.45786461417012037, 'recall': 0.5467399842890809, 'f1-score': 0.4983709856431921, 'support': 12730}, '1': {'precision': 0.570873786407767, 'recall': 0.17901878914405012, 'f1-score': 0.27256473081252897, 'support': 11496}, '2': {'precision': 0.45429049134350896, 'recall': 0.6419480222544014, 'f1-score': 0.5320573558208578, 'support': 13121}, 'accuracy': 0.4669986879802929, 'macro avg': {'precision': 0.4943429639737988, 'recall': 0.4559022652291775, 'f1-score': 0.43433102409219293, 'support': 37347}, 'weighted avg': {'precision': 0.4913949480238708, 'recall': 0.4669986879802929, 'f1-score': 0.4406991554444572, 'support': 37347}}
[[6960  753 5017]
 [4337 2058 5101]
 [3904  794 8423]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
5929/5929 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5329655
{'0': {'precision': 0.4490540395550946, 'recall': 0.49770942223077924, 'f1-score': 0.47213149978513114, 'support': 176593}, '1': {'precision': 0.8779641835550638, 'recall': 0.892594824873734, 'f1-score': 0.8852190556034302, 'support': 1166387}, '2': {'precision': 0.5151299054564703, 'recall': 0.40132765918450336, 'f1-score': 0.4511630153083399, 'support': 174593}, 'accuracy': 0.7901247584135985, 'macro avg': {'precision': 0.6140493761888762, 'recall': 0.5972106354296722, 'f1-score': 0.6028378568989671, 'support': 1517573}, 'weighted avg': {'precision': 0.786310698565904, 'recall': 0.7901247584135985, 'f1-score': 0.7872128858917513, 'support': 1517573}}
[[  87892   61698   27003]
 [  86326 1041111   38950]
 [  21509   83015   70069]]
Evaluating performance on  train set...
1254/1254 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5353576
{'0': {'precision': 0.4733408577878104, 'recall': 0.5181368915245861, 'f1-score': 0.49472690810428216, 'support': 40470}, '1': {'precision': 0.8580217393066442, 'recall': 0.8828643989341073, 'f1-score': 0.8702658152139285, 'support': 239799}, '2': {'precision': 0.5530642250885518, 'recall': 0.40666846851273986, 'f1-score': 0.4687008849557522, 'support': 40699}, 'accuracy': 0.7764948530694649, 'macro avg': {'precision': 0.6281422740610021, 'recall': 0.6025565863238111, 'f1-score': 0.6112312027579876, 'support': 320968}, 'weighted avg': {'precision': 0.7708494942659256, 'recall': 0.7764948530694649, 'f1-score': 0.7719963594821891, 'support': 320968}}
[[ 20969  15306   4195]
 [ 18909 211710   9180]
 [  4422  19726  16551]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51715827
{'0': {'precision': 0.4597859628389469, 'recall': 0.5406886967263743, 'f1-score': 0.4969662562537701, 'support': 12952}, '1': {'precision': 0.8677376864091828, 'recall': 0.8872721150608495, 'f1-score': 0.8773961851305712, 'support': 83156}, '2': {'precision': 0.5684763181411975, 'recall': 0.38838433946424483, 'f1-score': 0.46148265699387886, 'support': 13103}, 'accuracy': 0.7863127340652498, 'macro avg': {'precision': 0.6319999891297757, 'recall': 0.6054483837504895, 'f1-score': 0.6119483661260733, 'support': 109211}, 'weighted avg': {'precision': 0.7834511911651405, 'recall': 0.7863127340652498, 'f1-score': 0.7823778866259571, 'support': 109211}}
[[ 7003  4663  1286]
 [ 6797 73782  2577]
 [ 1431  6583  5089]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
5331/5331 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49708378
{'0': {'precision': 0.4963571647062095, 'recall': 0.48920163345849205, 'f1-score': 0.4927534231448763, 'support': 145948}, '1': {'precision': 0.8701786532295007, 'recall': 0.9225751618115421, 'f1-score': 0.8956112156311626, 'support': 1070690}, '2': {'precision': 0.5975561318660779, 'recall': 0.34569636678200694, 'f1-score': 0.43800145566639553, 'support': 147968}, 'accuracy': 0.8136722248033499, 'macro avg': {'precision': 0.654697316600596, 'recall': 0.5858243873506804, 'f1-score': 0.6087886981474782, 'support': 1364606}, 'weighted avg': {'precision': 0.800636303387788, 'recall': 0.8136722248033499, 'f1-score': 0.8029046834451286, 'support': 1364606}}
[[ 71398  62659  11891]
 [ 60339 987792  22559]
 [ 12107  84709  51152]]
Evaluating performance on  train set...
2013/2013 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5650357
{'0': {'precision': 0.47561360054041885, 'recall': 0.47314188432417903, 'f1-score': 0.4743745227507524, 'support': 66963}, '1': {'precision': 0.8469165664989785, 'recall': 0.8944669668885243, 'f1-score': 0.8700425585974718, 'support': 382828}, '2': {'precision': 0.5634028169014085, 'recall': 0.3815723203247814, 'f1-score': 0.4549938123316591, 'support': 65521}, 'accuracy': 0.7745036017014935, 'macro avg': {'precision': 0.6286443279802686, 'recall': 0.5830603905124949, 'f1-score': 0.5998036312266277, 'support': 515312}, 'weighted avg': {'precision': 0.762618772353169, 'recall': 0.7745036017014935, 'f1-score': 0.7658541686735302, 'support': 515312}}
[[ 31683  28144   7136]
 [ 28163 342427  12238]
 [  6769  33751  25001]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5179996
{'0': {'precision': 0.4986130711956786, 'recall': 0.4769130515732638, 'f1-score': 0.48752170913329995, 'support': 21484}, '1': {'precision': 0.8586105843820031, 'recall': 0.9179979799915956, 'f1-score': 0.8873116992318326, 'support': 135643}, '2': {'precision': 0.6170781060299474, 'recall': 0.3665032208441496, 'f1-score': 0.45987272672437196, 'support': 20802}, 'accuracy': 0.8002630262632848, 'macro avg': {'precision': 0.658100587202543, 'recall': 0.5871380841363364, 'f1-score': 0.6115687116965015, 'support': 177929}, 'weighted avg': {'precision': 0.7869047624644155, 'recall': 0.8002630262632848, 'f1-score': 0.78906647977139, 'support': 177929}}
[[ 10246   9411   1827]
 [  8219 124520   2904]
 [  2084  11094   7624]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
4192/4192 - 38s - 38s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7998999
{'0': {'precision': 0.46968350009524934, 'recall': 0.4610736850541651, 'f1-score': 0.4653387707413524, 'support': 224591}, '1': {'precision': 0.7261605721554081, 'recall': 0.7570628377766732, 'f1-score': 0.7412897878448124, 'support': 629669}, '2': {'precision': 0.4767214886015565, 'recall': 0.4273287952853031, 'f1-score': 0.4506758596100708, 'support': 218890}, 'accuracy': 0.6278619018776499, 'macro avg': {'precision': 0.5575218536174046, 'recall': 0.5484884393720472, 'f1-score': 0.5524348060654118, 'support': 1073150}, 'weighted avg': {'precision': 0.621606536754797, 'recall': 0.6278619018776499, 'f1-score': 0.6242617883726178, 'support': 1073150}}
[[103553  86067  34971]
 [ 85268 476699  67702]
 [ 31653  93699  93538]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87590384
{'0': {'precision': 0.4866096719369625, 'recall': 0.48791004505493085, 'f1-score': 0.4872589909043441, 'support': 77461}, '1': {'precision': 0.6709634150843558, 'recall': 0.6779335426315626, 'f1-score': 0.6744304705594948, 'support': 160855}, '2': {'precision': 0.47799070614546085, 'recall': 0.46626432051834726, 'f1-score': 0.47205470031211977, 'support': 76551}, 'accuracy': 0.5797241374929732, 'macro avg': {'precision': 0.545187931055593, 'recall': 0.5440359694016136, 'f1-score': 0.5445813872586529, 'support': 314867}, 'weighted avg': {'precision': 0.5786943645331021, 'recall': 0.5797241374929732, 'f1-score': 0.5791821353139007, 'support': 314867}}
[[ 37794  25167  14500]
 [ 27326 109049  24480]
 [ 12548  28310  35693]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88331324
{'0': {'precision': 0.48198109102417025, 'recall': 0.4840683353198252, 'f1-score': 0.4830224583242483, 'support': 25170}, '1': {'precision': 0.6691294820330832, 'recall': 0.6722844617632733, 'f1-score': 0.6707032616724333, 'support': 51325}, '2': {'precision': 0.4738375526595535, 'recall': 0.46737864077669905, 'f1-score': 0.47058593520889946, 'support': 25750}, 'accuracy': 0.5743459337864932, 'macro avg': {'precision': 0.5416493752389356, 'recall': 0.5412438126199325, 'f1-score': 0.5414372184018603, 'support': 102245}, 'weighted avg': {'precision': 0.5738750228119699, 'recall': 0.5743459337864932, 'f1-score': 0.5741024794658725, 'support': 102245}}
[[12184  7696  5290]
 [ 8746 34505  8074]
 [ 4349  9366 12035]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
6143/6143 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73798966
{'0': {'precision': 0.49573648158442707, 'recall': 0.4987755127836465, 'f1-score': 0.4972513538460569, 'support': 316459}, '1': {'precision': 0.7498571083064743, 'recall': 0.8045452667857865, 'f1-score': 0.7762391474959532, 'support': 944147}, '2': {'precision': 0.5532480568067757, 'recall': 0.4276649908944007, 'f1-score': 0.48241753075078575, 'support': 311896}, 'accuracy': 0.6682586095280006, 'macro avg': {'precision': 0.5996138822325591, 'recall': 0.5769952568212778, 'f1-score': 0.5853026773642652, 'support': 1572502}, 'weighted avg': {'precision': 0.6597202842271521, 'recall': 0.6682586095280006, 'f1-score': 0.6618164089766997, 'support': 1572502}}
[[157842 117434  41183]
 [118010 759609  66528]
 [ 42547 135962 133387]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83099204
{'0': {'precision': 0.5056680635090238, 'recall': 0.4783171725466662, 'f1-score': 0.49161249482628494, 'support': 126644}, '1': {'precision': 0.6869891074306351, 'recall': 0.7559771809499392, 'f1-score': 0.7198339877525278, 'support': 280818}, '2': {'precision': 0.5245055313442842, 'recall': 0.4354578346785416, 'f1-score': 0.4758515815085158, 'support': 125755}, 'accuracy': 0.6144383993758639, 'macro avg': {'precision': 0.572387567427981, 'recall': 0.556584062725049, 'f1-score': 0.5624326880291095, 'support': 533217}, 'weighted avg': {'precision': 0.6056032093869725, 'recall': 0.6144383993758639, 'f1-score': 0.6080879439329069, 'support': 533217}}
[[ 60576  45303  20765]
 [ 39647 212292  28879]
 [ 19571  51423  54761]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82196045
{'0': {'precision': 0.5012600409513309, 'recall': 0.4707956310559925, 'f1-score': 0.48555045579952444, 'support': 40559}, '1': {'precision': 0.6952879784659936, 'recall': 0.7606604084496561, 'f1-score': 0.7265065746052699, 'support': 94063}, '2': {'precision': 0.5174997073627531, 'recall': 0.4360928213854159, 'f1-score': 0.4733214672858423, 'support': 40551}, 'accuracy': 0.618411513189818, 'macro avg': {'precision': 0.5713492422600259, 'recall': 0.5558496202970215, 'f1-score': 0.5617928325635456, 'support': 175173}, 'weighted avg': {'precision': 0.6092069539978123, 'recall': 0.618411513189818, 'f1-score': 0.6121062474455344, 'support': 175173}}
[[19095 14435  7029]
 [13054 71550  9459]
 [ 5945 16922 17684]]
testing model on single stock: results/universal/W7/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
23942/23942 - 227s - 227s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0242002
{'0': {'precision': 0.4615628098708339, 'recall': 0.5673404302314875, 'f1-score': 0.5090143230668253, 'support': 1878849}, '1': {'precision': 0.5344056627061249, 'recall': 0.2935249183352908, 'f1-score': 0.3789239873382224, 'support': 2382302}, '2': {'precision': 0.45142749735877247, 'recall': 0.6068799778148126, 'f1-score': 0.5177366994164952, 'support': 1867913}, 'accuracy': 0.4729614505575403, 'macro avg': {'precision': 0.48246532331191044, 'recall': 0.489248442127197, 'f1-score': 0.468558336607181, 'support': 6129064}, 'weighted avg': {'precision': 0.48678718213956484, 'recall': 0.4729614505575403, 'f1-score': 0.46110785206040716, 'support': 6129064}}
[[1065947  301886  511016]
 [ 816509  699265  866528]
 [ 426974  307340 1133599]]
Evaluating performance on  train set...
9052/9052 - 79s - 79s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0256978
{'0': {'precision': 0.4814966943960494, 'recall': 0.532155577063592, 'f1-score': 0.5055602566579825, 'support': 784203}, '1': {'precision': 0.5340059193990475, 'recall': 0.32392452429606433, 'f1-score': 0.4032439102349679, 'support': 753620}, '2': {'precision': 0.471084714602574, 'recall': 0.6004373396709943, 'f1-score': 0.5279533942722255, 'support': 779257}, 'accuracy': 0.48739318452535085, 'macro avg': {'precision': 0.4955291094658903, 'recall': 0.4855058136768835, 'f1-score': 0.4789191870550587, 'support': 2317080}, 'weighted avg': {'precision': 0.49507343495262707, 'recall': 0.48739318452535085, 'f1-score': 0.4798133529026309, 'support': 2317080}}
[[417318 105219 261666]
 [245836 244116 263668]
 [203556 107806 467895]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0234609
{'0': {'precision': 0.47213430785461113, 'recall': 0.5341582373044359, 'f1-score': 0.5012348165904559, 'support': 232916}, '1': {'precision': 0.5510026273874512, 'recall': 0.33642117687151163, 'f1-score': 0.417768717664211, 'support': 240621}, '2': {'precision': 0.46168744337071005, 'recall': 0.5863212107212826, 'f1-score': 0.5165933310092055, 'support': 233778}, 'accuracy': 0.48413083279726854, 'macro avg': {'precision': 0.4949414595375908, 'recall': 0.48563354163241, 'f1-score': 0.4785322884212908, 'support': 707315}, 'weighted avg': {'precision': 0.4955116246498072, 'recall': 0.48413083279726854, 'f1-score': 0.4779167568773923, 'support': 707315}}
[[124414  31455  77047]
 [ 76900  80950  82771]
 [ 62200  34509 137069]]
training model: results/universal/W7/deepVOL_L2/h20
Epoch 1/50
12475/12475 - 385s - loss: 3.0249 - accuracy20: 0.4652 - val_loss: 3.1424 - val_accuracy20: 0.4520 - 385s/epoch - 31ms/step
Epoch 2/50
12475/12475 - 382s - loss: 2.9562 - accuracy20: 0.4917 - val_loss: 3.1039 - val_accuracy20: 0.4684 - 382s/epoch - 31ms/step
Epoch 3/50
12475/12475 - 383s - loss: 2.9305 - accuracy20: 0.4987 - val_loss: 3.1527 - val_accuracy20: 0.4681 - 383s/epoch - 31ms/step
Epoch 4/50
12475/12475 - 382s - loss: 2.9142 - accuracy20: 0.5031 - val_loss: 3.1168 - val_accuracy20: 0.4752 - 382s/epoch - 31ms/step
Epoch 5/50
12475/12475 - 377s - loss: 2.9043 - accuracy20: 0.5060 - val_loss: 3.1205 - val_accuracy20: 0.4758 - 377s/epoch - 30ms/step
Epoch 6/50
12475/12475 - 382s - loss: 2.8951 - accuracy20: 0.5081 - val_loss: 3.1183 - val_accuracy20: 0.4762 - 382s/epoch - 31ms/step
Epoch 7/50
12475/12475 - 384s - loss: 2.8881 - accuracy20: 0.5100 - val_loss: 3.1272 - val_accuracy20: 0.4761 - 384s/epoch - 31ms/step
Epoch 8/50
12475/12475 - 381s - loss: 2.8825 - accuracy20: 0.5115 - val_loss: 3.1052 - val_accuracy20: 0.4786 - 381s/epoch - 31ms/step
Epoch 9/50
12475/12475 - 380s - loss: 2.8779 - accuracy20: 0.5126 - val_loss: 3.0866 - val_accuracy20: 0.4802 - 380s/epoch - 30ms/step
Epoch 10/50
12475/12475 - 379s - loss: 2.8737 - accuracy20: 0.5136 - val_loss: 3.0719 - val_accuracy20: 0.4825 - 379s/epoch - 30ms/step
Epoch 11/50
12475/12475 - 381s - loss: 2.8699 - accuracy20: 0.5147 - val_loss: 3.0884 - val_accuracy20: 0.4803 - 381s/epoch - 31ms/step
Epoch 12/50
12475/12475 - 377s - loss: 2.8668 - accuracy20: 0.5155 - val_loss: 3.0893 - val_accuracy20: 0.4799 - 377s/epoch - 30ms/step
Epoch 13/50
12475/12475 - 379s - loss: 2.8635 - accuracy20: 0.5162 - val_loss: 3.0745 - val_accuracy20: 0.4827 - 379s/epoch - 30ms/step
Epoch 14/50
12475/12475 - 385s - loss: 2.8610 - accuracy20: 0.5168 - val_loss: 3.1013 - val_accuracy20: 0.4788 - 385s/epoch - 31ms/step
Epoch 15/50
12475/12475 - 384s - loss: 2.8584 - accuracy20: 0.5175 - val_loss: 3.0893 - val_accuracy20: 0.4803 - 384s/epoch - 31ms/step
Epoch 16/50
12475/12475 - 390s - loss: 2.8561 - accuracy20: 0.5180 - val_loss: 3.0896 - val_accuracy20: 0.4788 - 390s/epoch - 31ms/step
Epoch 17/50
12475/12475 - 389s - loss: 2.8537 - accuracy20: 0.5187 - val_loss: 3.0850 - val_accuracy20: 0.4774 - 389s/epoch - 31ms/step
Epoch 18/50
12475/12475 - 385s - loss: 2.8517 - accuracy20: 0.5193 - val_loss: 3.0847 - val_accuracy20: 0.4810 - 385s/epoch - 31ms/step
Epoch 19/50
12475/12475 - 390s - loss: 2.8498 - accuracy20: 0.5199 - val_loss: 3.0932 - val_accuracy20: 0.4776 - 390s/epoch - 31ms/step
Epoch 20/50
12475/12475 - 392s - loss: 2.8480 - accuracy20: 0.5202 - val_loss: 3.0775 - val_accuracy20: 0.4790 - 392s/epoch - 31ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 567s - 567s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0119972
{'0': {'precision': 0.4431741376829012, 'recall': 0.4611190796418826, 'f1-score': 0.4519685574862127, 'support': 2551007}, '1': {'precision': 0.6657993881072078, 'recall': 0.47771787225464823, 'f1-score': 0.5562911519750448, 'support': 4425116}, '2': {'precision': 0.40438996312500614, 'recall': 0.5877248365157788, 'f1-score': 0.4791179912895549, 'support': 2529449}, 'accuracy': 0.502536301865895, 'macro avg': {'precision': 0.5044544963050384, 'recall': 0.5088539294707699, 'f1-score': 0.49579256691693746, 'support': 9505572}, 'weighted avg': {'precision': 0.5364920322930639, 'recall': 0.502536301865895, 'f1-score': 0.507758223822807, 'support': 9505572}}
[[1176318  526853  847836]
 [ 969411 2113957 1341748]
 [ 508573  534256 1486620]]
Evaluating performance on  train set...
12475/12475 - 194s - 194s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0306545
{'0': {'precision': 0.4613683165969255, 'recall': 0.4266729335902366, 'f1-score': 0.44334285837850607, 'support': 985066}, '1': {'precision': 0.6083402903534467, 'recall': 0.43795594911424895, 'f1-score': 0.5092749819720773, 'support': 1229578}, '2': {'precision': 0.42267193261645974, 'recall': 0.6034401700666366, 'f1-score': 0.4971332512959203, 'support': 978440}, 'accuracy': 0.485183603062118, 'macro avg': {'precision': 0.49746017985561064, 'recall': 0.4893563509237074, 'f1-score': 0.4832503638821679, 'support': 3193084}, 'weighted avg': {'precision': 0.5061060734507223, 'recall': 0.485183603062118, 'f1-score': 0.48521440347724165, 'support': 3193084}}
[[420301 173989 390776]
 [275384 538501 415693]
 [215303 172707 590430]]
Evaluating performance on  val set...
3866/3866 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.033989
{'0': {'precision': 0.45373484081528626, 'recall': 0.4323399059639371, 'f1-score': 0.442779075069432, 'support': 296482}, '1': {'precision': 0.6175907179283998, 'recall': 0.4317573096294489, 'f1-score': 0.5082190080357984, 'support': 393522}, '2': {'precision': 0.41520752382474996, 'recall': 0.5989311425878515, 'f1-score': 0.49042744329058946, 'support': 299198}, 'accuracy': 0.4824959917185772, 'macro avg': {'precision': 0.495511027522812, 'recall': 0.48767611939374583, 'f1-score': 0.48047517546527335, 'support': 989202}, 'weighted avg': {'precision': 0.5072664716494053, 'recall': 0.4824959917185772, 'f1-score': 0.4832241507727002, 'support': 989202}}
[[128181  51653 116648]
 [ 87874 169906 135742]
 [ 66447  53552 179199]]
testing model out of sample: results/universal/W7/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 240s - 240s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83081114
{'0': {'precision': 0.4989533855557927, 'recall': 0.43879750650246985, 'f1-score': 0.4669459731726804, 'support': 857751}, '1': {'precision': 0.7195095309822322, 'recall': 0.7619174210178955, 'f1-score': 0.7401064838244292, 'support': 2057618}, '2': {'precision': 0.4895015760417868, 'recall': 0.47932163843458964, 'f1-score': 0.48435812424555447, 'support': 858893}, 'accuracy': 0.6241750042789822, 'macro avg': {'precision': 0.5693214975266039, 'recall': 0.5600121886516517, 'f1-score': 0.563803527080888, 'support': 3774262}, 'weighted avg': {'precision': 0.6170432801659568, 'recall': 0.6241750042789822, 'f1-score': 0.619827558573393, 'support': 3774262}}
[[ 376379  293727  187645]
 [ 248183 1567735  241700]
 [ 129775  317432  411686]]
Evaluating performance on  train set...
5285/5285 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89011276
{'0': {'precision': 0.5090903297302465, 'recall': 0.41238097969484916, 'f1-score': 0.45566078244652786, 'support': 348680}, '1': {'precision': 0.6774033291167776, 'recall': 0.7151323976796111, 'f1-score': 0.6957567516948365, 'support': 659717}, '2': {'precision': 0.46896522199806284, 'recall': 0.5091430911927123, 'f1-score': 0.48822896108725605, 'support': 344249}, 'accuracy': 0.5846659066747693, 'macro avg': {'precision': 0.5518196269483623, 'recall': 0.5455521561890575, 'f1-score': 0.5465488317428735, 'support': 1352646}, 'weighted avg': {'precision': 0.5809686473422363, 'recall': 0.5846659066747693, 'f1-score': 0.5810498018007998, 'support': 1352646}}
[[143789 111985  92906]
 [ 82368 471785 105564]
 [ 56286 112691 175272]]
Evaluating performance on  val set...
1714/1714 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8521188
{'0': {'precision': 0.508749752676589, 'recall': 0.4303833957912943, 'f1-score': 0.46629691758222386, 'support': 107539}, '1': {'precision': 0.6987877355164878, 'recall': 0.7564130190796857, 'f1-score': 0.7264594098764952, 'support': 222750}, '2': {'precision': 0.4942467977459152, 'recall': 0.48597150679845935, 'f1-score': 0.49007422105332127, 'support': 107745}, 'accuracy': 0.6098499203258194, 'macro avg': {'precision': 0.5672614286463307, 'recall': 0.5575893072231465, 'f1-score': 0.5609435161706801, 'support': 438034}, 'weighted avg': {'precision': 0.6018209293400032, 'recall': 0.6098499203258194, 'f1-score': 0.6044439123840939, 'support': 438034}}
[[ 46283  35180  26076]
 [ 26755 168491  27504]
 [ 17936  37448  52361]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0710334
{'0': {'precision': 0.4246679447985215, 'recall': 0.44932383040935675, 'f1-score': 0.4366481081897049, 'support': 54720}, '1': {'precision': 0.6468625317373957, 'recall': 0.2619180496401821, 'f1-score': 0.3728622203637884, 'support': 68090}, '2': {'precision': 0.42057388840217613, 'recall': 0.7055376129477083, 'f1-score': 0.5270005624411299, 'support': 55114}, 'accuracy': 0.45697039185270116, 'macro avg': {'precision': 0.4973681216460311, 'recall': 0.47225983099908236, 'f1-score': 0.445503630331541, 'support': 177924}, 'weighted avg': {'precision': 0.5084317405789658, 'recall': 0.45697039185270116, 'f1-score': 0.4402255011302097, 'support': 177924}}
[[24587  5122 25011]
 [21695 17834 28561]
 [11615  4614 38885]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1266416
{'0': {'precision': 0.45446888160973326, 'recall': 0.40079234070650377, 'f1-score': 0.42594623042848995, 'support': 24232}, '1': {'precision': 0.5512, 'recall': 0.14294012696568606, 'f1-score': 0.22701064215347105, 'support': 24101}, '2': {'precision': 0.395844600685055, 'recall': 0.7423403625913874, 'f1-score': 0.5163509163861902, 'support': 23663}, 'accuracy': 0.42673204066892606, 'macro avg': {'precision': 0.46717116076492937, 'recall': 0.42869094342119246, 'f1-score': 0.3897692629893837, 'support': 71996}, 'weighted avg': {'precision': 0.46758197573722865, 'recall': 0.42673204066892606, 'f1-score': 0.38906500745500294, 'support': 71996}}
[[ 9712  1534 12986]
 [ 6832  3445 13824]
 [ 4826  1271 17566]]
Evaluating performance on  val set...
73/73 - 1s - 673ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0992007
{'0': {'precision': 0.4444913465597298, 'recall': 0.5094339622641509, 'f1-score': 0.4747520288548241, 'support': 6201}, '1': {'precision': 0.5829326923076923, 'recall': 0.16410082896295042, 'f1-score': 0.2561056105610561, 'support': 5911}, '2': {'precision': 0.42220396426003903, 'recall': 0.6427454659161976, 'f1-score': 0.5096386288972912, 'support': 6396}, 'accuracy': 0.44521288091636047, 'macro avg': {'precision': 0.48320933437582037, 'recall': 0.438760085714433, 'f1-score': 0.4134987561043904, 'support': 18508}, 'weighted avg': {'precision': 0.4810040274289423, 'recall': 0.44521288091636047, 'f1-score': 0.41697786175611845, 'support': 18508}}
[[3159  335 2707]
 [2022  970 2919]
 [1926  359 4111]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5822349
{'0': {'precision': 0.5591033773358478, 'recall': 0.38922870356556766, 'f1-score': 0.4589512199412458, 'support': 67030}, '1': {'precision': 0.8352237798483625, 'recall': 0.9106452884741754, 'f1-score': 0.8713054303336667, 'support': 380450}, '2': {'precision': 0.5285860280364821, 'recall': 0.416294608959757, 'f1-score': 0.4657678551707147, 'support': 65850}, 'accuracy': 0.779144020415717, 'macro avg': {'precision': 0.6409710617402308, 'recall': 0.5720562003331667, 'f1-score': 0.5986748351485424, 'support': 513330}, 'weighted avg': {'precision': 0.7598328100292866, 'recall': 0.779144020415717, 'f1-score': 0.7654383427933235, 'support': 513330}}
[[ 26090  34189   6751]
 [ 16298 346455  17697]
 [  4276  34161  27413]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57387984
{'0': {'precision': 0.6043930987307137, 'recall': 0.40787853918752565, 'f1-score': 0.4870609132392123, 'support': 19496}, '1': {'precision': 0.8289476063877886, 'recall': 0.924120689133744, 'f1-score': 0.8739507014391061, 'support': 99197}, '2': {'precision': 0.5626359286646369, 'recall': 0.4118552324347272, 'f1-score': 0.4755806115570807, 'support': 18844}, 'accuracy': 0.780757178068447, 'macro avg': {'precision': 0.6653255445943796, 'recall': 0.5812848202519989, 'f1-score': 0.6121974087451331, 'support': 137537}, 'weighted avg': {'precision': 0.760629321589535, 'recall': 0.780757178068447, 'f1-score': 0.7645278604255459, 'support': 137537}}
[[ 7952  9380  2164]
 [ 3658 91670  3869]
 [ 1547  9536  7761]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6017094
{'0': {'precision': 0.5873797270082792, 'recall': 0.4461250849762067, 'f1-score': 0.5070993914807302, 'support': 5884}, '1': {'precision': 0.8153200078130086, 'recall': 0.919284980179122, 'f1-score': 0.8641868810600047, 'support': 27244}, '2': {'precision': 0.5982397100698938, 'recall': 0.39023978385680513, 'f1-score': 0.4723556463975473, 'support': 5922}, 'accuracy': 0.7677592829705506, 'macro avg': {'precision': 0.6669798149637273, 'recall': 0.585216616337378, 'f1-score': 0.6145473063127608, 'support': 39050}, 'weighted avg': {'precision': 0.748053679119289, 'recall': 0.7677592829705506, 'f1-score': 0.7509595478882884, 'support': 39050}}
[[ 2625  2626   633]
 [ 1280 25045   919]
 [  564  3047  2311]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1002189
{'0': {'precision': 0.4416869692089579, 'recall': 0.4368643894735409, 'f1-score': 0.4392624431911515, 'support': 73453}, '1': {'precision': 0.5088056515932551, 'recall': 0.4601067732141446, 'f1-score': 0.48323237591721097, 'support': 88599}, '2': {'precision': 0.4556383915468154, 'recall': 0.5113646844900057, 'f1-score': 0.4818958452330693, 'support': 75893}, 'accuracy': 0.4692807161318792, 'macro avg': {'precision': 0.4687103374496761, 'recall': 0.4694452823925637, 'f1-score': 0.4681302214471439, 'support': 237945}, 'weighted avg': {'precision': 0.471128493242047, 'recall': 0.4692807161318792, 'f1-score': 0.469232683586047, 'support': 237945}}
[[32089 20118 21246]
 [22714 40765 25120]
 [17848 19236 38809]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088294
{'0': {'precision': 0.4793940437252539, 'recall': 0.4268677764493087, 'f1-score': 0.4516087182148417, 'support': 32619}, '1': {'precision': 0.47597168756984976, 'recall': 0.4707688528617047, 'f1-score': 0.4733559740660697, 'support': 32568}, '2': {'precision': 0.4651169203617913, 'recall': 0.5216490381641615, 'f1-score': 0.4917636082684626, 'support': 32334}, 'accuracy': 0.47295454312404506, 'macro avg': {'precision': 0.47349421721896495, 'recall': 0.47309522249172503, 'f1-score': 0.47224276684979133, 'support': 97521}, 'weighted avg': {'precision': 0.47351740380048485, 'recall': 0.47295454312404506, 'f1-score': 0.47218513604850393, 'support': 97521}}
[[13924  8713  9982]
 [ 7821 15332  9415]
 [ 7300  8167 16867]]
Evaluating performance on  val set...
114/114 - 1s - 963ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1161367
{'0': {'precision': 0.4701918092275791, 'recall': 0.4583586011724277, 'f1-score': 0.46419980551717077, 'support': 9894}, '1': {'precision': 0.4388523610280932, 'recall': 0.39354631217838765, 'f1-score': 0.4149663708811394, 'support': 9328}, '2': {'precision': 0.4602873407427487, 'recall': 0.5168949771689497, 'f1-score': 0.4869515342701462, 'support': 9855}, 'accuracy': 0.4574061973381023, 'macro avg': {'precision': 0.45644383699947366, 'recall': 0.45626663017325503, 'f1-score': 0.4553725702228188, 'support': 29077}, 'weighted avg': {'precision': 0.45678110971515323, 'recall': 0.4574061973381023, 'f1-score': 0.4561167435979794, 'support': 29077}}
[[4535 2396 2963]
 [2647 3671 3010]
 [2463 2298 5094]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2941537
{'0': {'precision': 0.3719747663826902, 'recall': 0.2903674897024645, 'f1-score': 0.3261437063840786, 'support': 86914}, '1': {'precision': 0.4120754716981132, 'recall': 0.005636070853462158, 'f1-score': 0.011120049693994969, 'support': 96876}, '2': {'precision': 0.3303555616772594, 'recall': 0.7574127333220549, 'f1-score': 0.46005295445437383, 'support': 88665}, 'accuracy': 0.3411168816868841, 'macro avg': {'precision': 0.37146859991935427, 'recall': 0.35113876462599386, 'f1-score': 0.26577223684414913, 'support': 272455}, 'weighted avg': {'precision': 0.3726891197361978, 'recall': 0.3411168816868841, 'f1-score': 0.2577097694574088, 'support': 272455}}
[[25237   400 61277]
 [21479   546 74851]
 [21130   379 67156]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2551905
{'0': {'precision': 0.38585369328299735, 'recall': 0.30506279213831167, 'f1-score': 0.340734683608001, 'support': 35514}, '1': {'precision': 0.531578947368421, 'recall': 0.01190546354688513, 'f1-score': 0.023289329567072116, 'support': 33934}, '2': {'precision': 0.3345935983955335, 'recall': 0.7440634040501446, 'f1-score': 0.46160892893866023, 'support': 33184}, 'accuracy': 0.3500759996882064, 'macro avg': {'precision': 0.4173420796823173, 'recall': 0.3536772199117804, 'f1-score': 0.2752109807045778, 'support': 102632}, 'weighted avg': {'precision': 0.41746201995878235, 'recall': 0.3500759996882064, 'f1-score': 0.274857572307702, 'support': 102632}}
[[10834   181 24499]
 [ 8926   404 24604]
 [ 8318   175 24691]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2693216
{'0': {'precision': 0.3548058417298766, 'recall': 0.30928648968716077, 'f1-score': 0.3304861330802489, 'support': 10133}, '1': {'precision': 0.30386740331491713, 'recall': 0.005229131013500666, 'f1-score': 0.01028133470417796, 'support': 10518}, '2': {'precision': 0.34617963964769527, 'recall': 0.7216216216216216, 'f1-score': 0.46789739251291657, 'support': 10730}, 'accuracy': 0.3483636595392116, 'macro avg': {'precision': 0.33495096156416304, 'recall': 0.34537908077409435, 'f1-score': 0.2695549534324478, 'support': 31381}, 'weighted avg': {'precision': 0.33478322793202603, 'recall': 0.3483636595392116, 'f1-score': 0.2701473530666423, 'support': 31381}}
[[3134   66 6933]
 [2772   55 7691]
 [2927   60 7743]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.159504
{'0': {'precision': 0.4152733154110113, 'recall': 0.44566415687378325, 'f1-score': 0.4299323422261444, 'support': 127899}, '1': {'precision': 0.5378527853692022, 'recall': 0.254923386700717, 'f1-score': 0.34590155058454075, 'support': 162896}, '2': {'precision': 0.39842567655776306, 'recall': 0.6314813395662503, 'f1-score': 0.4885846508690844, 'support': 130490}, 'accuracy': 0.42946698790604937, 'macro avg': {'precision': 0.4505172591126589, 'recall': 0.44402296104691685, 'f1-score': 0.42147284789325656, 'support': 421285}, 'weighted avg': {'precision': 0.4574520232794355, 'recall': 0.42946698790604937, 'f1-score': 0.41560773992500993, 'support': 421285}}
[[57000 18901 51998]
 [48951 41526 72419]
 [31308 16780 82402]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1638227
{'0': {'precision': 0.4477201343008773, 'recall': 0.4522757111597374, 'f1-score': 0.4499863930767975, 'support': 45700}, '1': {'precision': 0.4566092315432021, 'recall': 0.1666972771936269, 'f1-score': 0.24423141607803567, 'support': 43558}, '2': {'precision': 0.40963423545144967, 'recall': 0.6552864893476247, 'f1-score': 0.5041272534464475, 'support': 45342}, 'accuracy': 0.42824665676077267, 'macro avg': {'precision': 0.43798786709850973, 'recall': 0.424753159233663, 'f1-score': 0.39944835420042696, 'support': 134600}, 'weighted avg': {'precision': 0.43776694315712117, 'recall': 0.42824665676077267, 'f1-score': 0.40164003054164593, 'support': 134600}}
[[20669  4478 20553]
 [14029  7261 22268]
 [11467  4163 29712]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1395711
{'0': {'precision': 0.4475009686168152, 'recall': 0.4612988257848071, 'f1-score': 0.45429515418502203, 'support': 12519}, '1': {'precision': 0.4752215954875101, 'recall': 0.1990381370232872, 'f1-score': 0.2805661274976213, 'support': 11852}, '2': {'precision': 0.4311530958003902, 'recall': 0.6471948212083847, 'f1-score': 0.5175325075491465, 'support': 12976}, 'accuracy': 0.4426593836184968, 'macro avg': {'precision': 0.45129188663490516, 'recall': 0.43584392800549293, 'f1-score': 0.4174645964105966, 'support': 37347}, 'weighted avg': {'precision': 0.4506180830304373, 'recall': 0.4426593836184968, 'f1-score': 0.4211340294080334, 'support': 37347}}
[[5775 1348 5396]
 [3809 2359 5684]
 [3321 1257 8398]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
5929/5929 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61445683
{'0': {'precision': 0.5313875477478526, 'recall': 0.4694488458738384, 'f1-score': 0.49850159844657377, 'support': 233510}, '1': {'precision': 0.8133258539017701, 'recall': 0.8936132572302524, 'f1-score': 0.8515813607583608, 'support': 1051381}, '2': {'precision': 0.5784399761711069, 'recall': 0.3880919022528601, 'f1-score': 0.46452243470209237, 'support': 232682}, 'accuracy': 0.7508376862266263, 'macro avg': {'precision': 0.6410511259402432, 'recall': 0.5837180017856504, 'f1-score': 0.6048684646356757, 'support': 1517573}, 'weighted avg': {'precision': 0.7339299173160985, 'recall': 0.7508376862266263, 'f1-score': 0.7379068947985354, 'support': 1517573}}
[[109621  96645  27244]
 [ 73286 939528  38567]
 [ 23385 118995  90302]]
Evaluating performance on  train set...
1254/1254 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64868605
{'0': {'precision': 0.5339119779434289, 'recall': 0.480455038318049, 'f1-score': 0.5057749230977576, 'support': 54413}, '1': {'precision': 0.784564178304043, 'recall': 0.8702904572151612, 'f1-score': 0.8252068825811246, 'support': 211804}, '2': {'precision': 0.5873003022452504, 'recall': 0.3974904567953097, 'f1-score': 0.47410328188482365, 'support': 54751}, 'accuracy': 0.723551880561302, 'macro avg': {'precision': 0.6352588194975741, 'recall': 0.58274531744284, 'f1-score': 0.601695029187902, 'support': 320968}, 'weighted avg': {'precision': 0.7084222181824201, 'recall': 0.723551880561302, 'f1-score': 0.711162727235135, 'support': 320968}}
[[ 26143  22980   5290]
 [ 17470 184331  10003]
 [  5352  27636  21763]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64603853
{'0': {'precision': 0.5190565923044191, 'recall': 0.48461975028376847, 'f1-score': 0.5012473951454316, 'support': 17620}, '1': {'precision': 0.7913218491386854, 'recall': 0.8573653700292556, 'f1-score': 0.8230208157268603, 'support': 73832}, '2': {'precision': 0.5404981983393389, 'recall': 0.3885353905062222, 'f1-score': 0.4520884520884521, 'support': 17759}, 'accuracy': 0.7209896439003397, 'macro avg': {'precision': 0.6169588799274811, 'recall': 0.5768401702730821, 'f1-score': 0.5921188876535813, 'support': 109211}, 'weighted avg': {'precision': 0.7066079371704279, 'recall': 0.7209896439003397, 'f1-score': 0.7107882062232456, 'support': 109211}}
[[ 8539  7427  1654]
 [ 6319 63301  4212]
 [ 1593  9266  6900]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
5331/5331 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6246174
{'0': {'precision': 0.5592958915479319, 'recall': 0.40835361727484826, 'f1-score': 0.4720521187850626, 'support': 198022}, '1': {'precision': 0.8108048810090656, 'recall': 0.8990085952114021, 'f1-score': 0.8526316667918451, 'support': 966003}, '2': {'precision': 0.533638609872697, 'recall': 0.3962389259202018, 'f1-score': 0.45478760689751857, 'support': 200581}, 'accuracy': 0.7539069885373507, 'macro avg': {'precision': 0.6345797941432315, 'recall': 0.567867046135484, 'f1-score': 0.5931571308248088, 'support': 1364606}, 'weighted avg': {'precision': 0.7335674945825977, 'recall': 0.7539069885373507, 'f1-score': 0.7389262583200495, 'support': 1364606}}
[[ 80863  94869  22290]
 [ 50390 868445  47168]
 [ 13327 107776  79478]]
Evaluating performance on  train set...
2013/2013 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70500183
{'0': {'precision': 0.5452391636004666, 'recall': 0.34348710990502035, 'f1-score': 0.42146300856716723, 'support': 88440}, '1': {'precision': 0.7796725196595928, 'recall': 0.8508809828212024, 'f1-score': 0.8137218665898408, 'support': 340245}, '2': {'precision': 0.46328035615165897, 'recall': 0.47210454015491704, 'f1-score': 0.4676508255957553, 'support': 86627}, 'accuracy': 0.7001253609463781, 'macro avg': {'precision': 0.5960640131372394, 'recall': 0.5554908776270466, 'f1-score': 0.5676119002509211, 'support': 515312}, 'weighted avg': {'precision': 0.6862506898592565, 'recall': 0.7001253609463781, 'f1-score': 0.6882241691333099, 'support': 515312}}
[[ 30378  42355  15707]
 [ 19064 289508  31673]
 [  6273  39457  40897]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6499366
{'0': {'precision': 0.5549135903466612, 'recall': 0.38056665965355213, 'f1-score': 0.45149346867459855, 'support': 28518}, '1': {'precision': 0.7925255572314396, 'recall': 0.8954448533346505, 'f1-score': 0.8408475965180822, 'support': 121467}, '2': {'precision': 0.5494084240416469, 'recall': 0.4154380188949327, 'f1-score': 0.47312222358071476, 'support': 27944}, 'accuracy': 0.7375357586453023, 'macro avg': {'precision': 0.6322825238732492, 'recall': 0.5638165106277118, 'f1-score': 0.5884877629244651, 'support': 177929}, 'weighted avg': {'precision': 0.7162598375259634, 'recall': 0.7375357586453023, 'f1-score': 0.7206911361366813, 'support': 177929}}
[[ 10853  14226   3439]
 [  6618 108767   6082]
 [  2087  14248  11609]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
4192/4192 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91786146
{'0': {'precision': 0.5038411192015053, 'recall': 0.4286375500261006, 'f1-score': 0.4632067843778793, 'support': 287350}, '1': {'precision': 0.6220682577221568, 'recall': 0.7172854751190321, 'f1-score': 0.6662922794117647, 'support': 505326}, '2': {'precision': 0.4940532323100936, 'recall': 0.43335567646198936, 'f1-score': 0.46171817128530457, 'support': 280474}, 'accuracy': 0.5657894982062154, 'macro avg': {'precision': 0.539987536411252, 'recall': 0.5264262338690407, 'f1-score': 0.5304057450249829, 'support': 1073150}, 'weighted avg': {'precision': 0.5569539172372924, 'recall': 0.5657894982062154, 'f1-score': 0.5584468380469529, 'support': 1073150}}
[[123169 106050  58131]
 [ 76523 362463  66340]
 [ 44768 114161 121545]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9869695
{'0': {'precision': 0.5185610640870617, 'recall': 0.4422228180168289, 'f1-score': 0.4773592466439591, 'support': 96976}, '1': {'precision': 0.5446191104287845, 'recall': 0.6189719434773705, 'f1-score': 0.5794199742347096, 'support': 122075}, '2': {'precision': 0.4910410378267292, 'recall': 0.47879268598146446, 'f1-score': 0.4848395176546433, 'support': 95816}, 'accuracy': 0.521877491131176, 'macro avg': {'precision': 0.5180737374475252, 'recall': 0.5133291491585547, 'f1-score': 0.5138729128444374, 'support': 314867}, 'weighted avg': {'precision': 0.5202893403783395, 'recall': 0.521877491131176, 'f1-score': 0.5192048289622097, 'support': 314867}}
[[42885 30310 23781]
 [22745 75561 23769]
 [17070 32870 45876]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9894476
{'0': {'precision': 0.5107125436193763, 'recall': 0.435538062781991, 'f1-score': 0.4701392007184553, 'support': 31251}, '1': {'precision': 0.5450089023516081, 'recall': 0.6004789564862937, 'f1-score': 0.571400865465036, 'support': 39252}, '2': {'precision': 0.4796117105141126, 'recall': 0.4887530716400983, 'f1-score': 0.48413924386400164, 'support': 31742}, 'accuracy': 0.5153797251699349, 'macro avg': {'precision': 0.5117777188283658, 'recall': 0.508256696969461, 'f1-score': 0.508559770015831, 'support': 102245}, 'weighted avg': {'precision': 0.5142236984781008, 'recall': 0.5153797251699349, 'f1-score': 0.513360015762308, 'support': 102245}}
[[13611  9157  8483]
 [ 7332 23570  8350]
 [ 5708 10520 15514]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
6143/6143 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8537801
{'0': {'precision': 0.5312775149988738, 'recall': 0.449941410653104, 'f1-score': 0.4872383691295693, 'support': 403657}, '1': {'precision': 0.6492246044962531, 'recall': 0.775648614691139, 'f1-score': 0.7068280297781278, 'support': 772030}, '2': {'precision': 0.5591371340523883, 'recall': 0.4343787407230069, 'f1-score': 0.4889248181083266, 'support': 396815}, 'accuracy': 0.6059222818158578, 'macro avg': {'precision': 0.579879751182505, 'recall': 0.5533229220224166, 'f1-score': 0.5609970723386745, 'support': 1572502}, 'weighted avg': {'precision': 0.5962146700800006, 'recall': 0.6059222818158578, 'f1-score': 0.5954728985368528, 'support': 1572502}}
[[181622 154583  67452]
 [104751 598824  68455]
 [ 55486 168961 172368]]
Evaluating performance on  train set...
2083/2083 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9316006
{'0': {'precision': 0.532561850940967, 'recall': 0.43805845683592387, 'f1-score': 0.48070954362621604, 'support': 157689}, '1': {'precision': 0.5769024879185141, 'recall': 0.7127414536249401, 'f1-score': 0.6376679711250851, 'support': 219245}, '2': {'precision': 0.5302659057154273, 'recall': 0.4500489496618314, 'f1-score': 0.4868754412925198, 'support': 156283}, 'accuracy': 0.5545153286560631, 'macro avg': {'precision': 0.546576748191636, 'recall': 0.5336162867075651, 'f1-score': 0.5350843186812736, 'support': 533217}, 'weighted avg': {'precision': 0.5501206417268183, 'recall': 0.5545153286560631, 'f1-score': 0.5470539689201818, 'support': 533217}}
[[ 69077  54986  33626]
 [ 34300 156265  28680]
 [ 26330  59618  70335]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.926072
{'0': {'precision': 0.5249318083935494, 'recall': 0.4352371694407523, 'f1-score': 0.47589505536816307, 'support': 50407}, '1': {'precision': 0.5927060917766086, 'recall': 0.7090791459995687, 'f1-score': 0.6456910359555941, 'support': 74192}, '2': {'precision': 0.5202151501568804, 'recall': 0.45897101277336183, 'f1-score': 0.48767779481900125, 'support': 50574}, 'accuracy': 0.5580711639350813, 'macro avg': {'precision': 0.5459510167756795, 'recall': 0.5344291094045609, 'f1-score': 0.5364212953809194, 'support': 175173}, 'weighted avg': {'precision': 0.5522748884292549, 'recall': 0.5580711639350813, 'f1-score': 0.5512114777433542, 'support': 175173}}
[[21939 16896 11572]
 [11748 52608  9836]
 [ 8107 19255 23212]]
testing model on single stock: results/universal/W7/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
23942/23942 - 232s - 232s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1503317
{'0': {'precision': 0.427035649317801, 'recall': 0.475581800050421, 'f1-score': 0.45000322768058876, 'support': 1876203}, '1': {'precision': 0.45532863378287686, 'recall': 0.1943629727617151, 'f1-score': 0.2724339546766057, 'support': 2391083}, '2': {'precision': 0.39095354409842503, 'recall': 0.6339380957342927, 'f1-score': 0.4836420468934272, 'support': 1861778}, 'accuracy': 0.413974792888441, 'macro avg': {'precision': 0.42443927573303436, 'recall': 0.43462762284880957, 'f1-score': 0.40202640975020726, 'support': 6129064}, 'weighted avg': {'precision': 0.42711298649075075, 'recall': 0.413974792888441, 'f1-score': 0.390947741158382, 'support': 6129064}}
[[ 892288  289599  694316]
 [ 782007  464738 1144338]
 [ 415198  266328 1180252]]
Evaluating performance on  train set...
9052/9052 - 67s - 67s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1067399
{'0': {'precision': 0.4509299320567247, 'recall': 0.42710555346508844, 'f1-score': 0.43869452062203124, 'support': 778667}, '1': {'precision': 0.4661277118297176, 'recall': 0.24490274965642408, 'f1-score': 0.32110004986159113, 'support': 762568}, '2': {'precision': 0.4159908253534436, 'recall': 0.6321004839884256, 'f1-score': 0.5017654467639274, 'support': 775845}, 'accuracy': 0.43578124190791856, 'macro avg': {'precision': 0.44434948974662863, 'recall': 0.434702929036646, 'f1-score': 0.4205200057491833, 'support': 2317080}, 'weighted avg': {'precision': 0.4442327136981547, 'recall': 0.43578124190791856, 'f1-score': 0.42111182270642716, 'support': 2317080}}
[[332573 111152 334942]
 [222266 186755 353547]
 [182688 102745 490412]]
Evaluating performance on  val set...
2763/2763 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1138574
{'0': {'precision': 0.4434484891323555, 'recall': 0.4334265999982728, 'f1-score': 0.4383802740013189, 'support': 231594}, '1': {'precision': 0.478949844424453, 'recall': 0.23912953897377573, 'f1-score': 0.3189927412949134, 'support': 242676}, '2': {'precision': 0.40712133677235735, 'recall': 0.6285438434637087, 'f1-score': 0.4941628137245144, 'support': 233045}, 'accuracy': 0.43105122894325726, 'macro avg': {'precision': 0.44317322344305526, 'recall': 0.43369999414525245, 'f1-score': 0.4171786096735823, 'support': 707315}, 'weighted avg': {'precision': 0.44365980329242466, 'recall': 0.43105122894325726, 'f1-score': 0.4157981897570041, 'support': 707315}}
[[100379  32293  98922]
 [ 70254  58031 114391]
 [ 55727  30839 146479]]
training model: results/universal/W7/deepVOL_L2/h30
Epoch 1/50
12475/12475 - 385s - loss: 3.1219 - accuracy30: 0.4276 - val_loss: 3.2176 - val_accuracy30: 0.4228 - 385s/epoch - 31ms/step
Epoch 2/50
12475/12475 - 384s - loss: 3.0597 - accuracy30: 0.4559 - val_loss: 3.2637 - val_accuracy30: 0.4299 - 384s/epoch - 31ms/step
Epoch 3/50
12475/12475 - 394s - loss: 3.0329 - accuracy30: 0.4653 - val_loss: 3.2512 - val_accuracy30: 0.4388 - 394s/epoch - 32ms/step
Epoch 4/50
12475/12475 - 382s - loss: 3.0187 - accuracy30: 0.4697 - val_loss: 3.2126 - val_accuracy30: 0.4446 - 382s/epoch - 31ms/step
Epoch 5/50
12475/12475 - 380s - loss: 3.0086 - accuracy30: 0.4728 - val_loss: 3.2289 - val_accuracy30: 0.4466 - 380s/epoch - 30ms/step
Epoch 6/50
12475/12475 - 383s - loss: 3.0015 - accuracy30: 0.4748 - val_loss: 3.2133 - val_accuracy30: 0.4510 - 383s/epoch - 31ms/step
Epoch 7/50
12475/12475 - 379s - loss: 2.9959 - accuracy30: 0.4767 - val_loss: 3.1958 - val_accuracy30: 0.4521 - 379s/epoch - 30ms/step
Epoch 8/50
12475/12475 - 380s - loss: 2.9907 - accuracy30: 0.4783 - val_loss: 3.1957 - val_accuracy30: 0.4529 - 380s/epoch - 30ms/step
Epoch 9/50
12475/12475 - 379s - loss: 2.9865 - accuracy30: 0.4795 - val_loss: 3.1926 - val_accuracy30: 0.4537 - 379s/epoch - 30ms/step
Epoch 10/50
12475/12475 - 384s - loss: 2.9829 - accuracy30: 0.4808 - val_loss: 3.1788 - val_accuracy30: 0.4536 - 384s/epoch - 31ms/step
Epoch 11/50
12475/12475 - 380s - loss: 2.9797 - accuracy30: 0.4818 - val_loss: 3.1785 - val_accuracy30: 0.4541 - 380s/epoch - 30ms/step
Epoch 12/50
12475/12475 - 381s - loss: 2.9771 - accuracy30: 0.4822 - val_loss: 3.1702 - val_accuracy30: 0.4558 - 381s/epoch - 31ms/step
Epoch 13/50
12475/12475 - 380s - loss: 2.9743 - accuracy30: 0.4833 - val_loss: 3.1842 - val_accuracy30: 0.4534 - 380s/epoch - 30ms/step
Epoch 14/50
12475/12475 - 384s - loss: 2.9717 - accuracy30: 0.4842 - val_loss: 3.1704 - val_accuracy30: 0.4542 - 384s/epoch - 31ms/step
Epoch 15/50
12475/12475 - 382s - loss: 2.9694 - accuracy30: 0.4851 - val_loss: 3.1726 - val_accuracy30: 0.4535 - 382s/epoch - 31ms/step
Epoch 16/50
12475/12475 - 380s - loss: 2.9673 - accuracy30: 0.4856 - val_loss: 3.1791 - val_accuracy30: 0.4523 - 380s/epoch - 30ms/step
Epoch 17/50
12475/12475 - 379s - loss: 2.9652 - accuracy30: 0.4863 - val_loss: 3.1683 - val_accuracy30: 0.4529 - 379s/epoch - 30ms/step
Epoch 18/50
12475/12475 - 380s - loss: 2.9634 - accuracy30: 0.4869 - val_loss: 3.1573 - val_accuracy30: 0.4531 - 380s/epoch - 30ms/step
Epoch 19/50
12475/12475 - 379s - loss: 2.9615 - accuracy30: 0.4873 - val_loss: 3.1619 - val_accuracy30: 0.4533 - 379s/epoch - 30ms/step
Epoch 20/50
12475/12475 - 382s - loss: 2.9597 - accuracy30: 0.4878 - val_loss: 3.1787 - val_accuracy30: 0.4520 - 382s/epoch - 31ms/step
Epoch 21/50
12475/12475 - 383s - loss: 2.9583 - accuracy30: 0.4882 - val_loss: 3.1646 - val_accuracy30: 0.4523 - 383s/epoch - 31ms/step
Epoch 22/50
12475/12475 - 380s - loss: 2.9568 - accuracy30: 0.4888 - val_loss: 3.1707 - val_accuracy30: 0.4516 - 380s/epoch - 30ms/step
Epoch 23/50
12475/12475 - 382s - loss: 2.9549 - accuracy30: 0.4895 - val_loss: 3.1585 - val_accuracy30: 0.4536 - 382s/epoch - 31ms/step
Epoch 24/50
12475/12475 - 379s - loss: 2.9536 - accuracy30: 0.4900 - val_loss: 3.1624 - val_accuracy30: 0.4516 - 379s/epoch - 30ms/step
Epoch 25/50
12475/12475 - 381s - loss: 2.9521 - accuracy30: 0.4903 - val_loss: 3.1650 - val_accuracy30: 0.4502 - 381s/epoch - 31ms/step
Epoch 26/50
12475/12475 - 386s - loss: 2.9511 - accuracy30: 0.4906 - val_loss: 3.1773 - val_accuracy30: 0.4498 - 386s/epoch - 31ms/step
Epoch 27/50
12475/12475 - 383s - loss: 2.9496 - accuracy30: 0.4909 - val_loss: 3.1589 - val_accuracy30: 0.4522 - 383s/epoch - 31ms/step
Epoch 28/50
12475/12475 - 386s - loss: 2.9482 - accuracy30: 0.4915 - val_loss: 3.1694 - val_accuracy30: 0.4518 - 386s/epoch - 31ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 574s - 574s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0439447
{'0': {'precision': 0.4424204153249908, 'recall': 0.44372054173822434, 'f1-score': 0.44306952477324846, 'support': 2688974}, '1': {'precision': 0.6565222399429268, 'recall': 0.38326814159313366, 'f1-score': 0.48398997198986976, 'support': 4149043}, '2': {'precision': 0.3906860638611937, 'recall': 0.642446734931426, 'f1-score': 0.48589104208899786, 'support': 2667555}, 'accuracy': 0.47310261812755716, 'macro avg': {'precision': 0.49654290637637044, 'recall': 0.48981180608759467, 'f1-score': 0.4709835129507054, 'support': 9505572}, 'weighted avg': {'precision': 0.5213544814494981, 'recall': 0.47310261812755716, 'f1-score': 0.47294773175586946, 'support': 9505572}}
[[1193153  390688 1105133]
 [ 991197 1590196 1567650]
 [ 512526  441267 1713762]]
Evaluating performance on  train set...
12475/12475 - 197s - 197s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0721669
{'0': {'precision': 0.4412401287560632, 'recall': 0.4056945465499854, 'f1-score': 0.4227214191948431, 'support': 1002503}, '1': {'precision': 0.6063963479168462, 'recall': 0.3116727609396099, 'f1-score': 0.411727662233084, 'support': 1196752}, '2': {'precision': 0.39503513983480654, 'recall': 0.6583355889192205, 'f1-score': 0.49377808653284117, 'support': 993829}, 'accuracy': 0.4490887179917597, 'macro avg': {'precision': 0.48089053883590527, 'recall': 0.4585676321362719, 'f1-score': 0.44274238932025606, 'support': 3193084}, 'weighted avg': {'precision': 0.4887588215491378, 'recall': 0.4490887179917597, 'f1-score': 0.440716992130712, 'support': 3193084}}
[[406710 115624 480169]
 [301959 372995 521798]
 [213074 126482 654273]]
Evaluating performance on  val set...
3866/3866 - 60s - 60s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0659405
{'0': {'precision': 0.4401788402691707, 'recall': 0.4103914163258245, 'f1-score': 0.42476354256233884, 'support': 306349}, '1': {'precision': 0.610471998319233, 'recall': 0.3194402361755013, 'f1-score': 0.41941446103800084, 'support': 372943}, '2': {'precision': 0.3995594323758199, 'recall': 0.6555128908392759, 'f1-score': 0.49648986674324397, 'support': 309910}, 'accuracy': 0.45289637505787494, 'macro avg': {'precision': 0.48340342365474126, 'recall': 0.46178151444686727, 'f1-score': 0.4468892901145279, 'support': 989202}, 'weighted avg': {'precision': 0.4916559708678109, 'recall': 0.45289637505787494, 'f1-score': 0.44521821472836065, 'support': 989202}}
[[125723  35665 144961]
 [ 93486 119133 160324]
 [ 66409  40351 203150]]
testing model out of sample: results/universal/W7/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 232s - 232s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91369796
{'0': {'precision': 0.46992226828465644, 'recall': 0.4603055213640479, 'f1-score': 0.4650641855905687, 'support': 939967}, '1': {'precision': 0.6736847838816067, 'recall': 0.6548536592984944, 'f1-score': 0.664135762428637, 'support': 1888709}, '2': {'precision': 0.47013215201018854, 'recall': 0.5059444619526939, 'f1-score': 0.48738132907362564, 'support': 945586}, 'accuracy': 0.5690950972666975, 'macro avg': {'precision': 0.5379130680588172, 'recall': 0.5403678808717455, 'f1-score': 0.5388604256976105, 'support': 3774262}, 'weighted avg': {'precision': 0.5719413014580533, 'recall': 0.5690950972666975, 'f1-score': 0.5702744378877916, 'support': 3774262}}
[[ 432672  276897  230398]
 [ 343077 1236828  308804]
 [ 144982  322190  478414]]
Evaluating performance on  train set...
5285/5285 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94483536
{'0': {'precision': 0.4924657162989864, 'recall': 0.42514655609426383, 'f1-score': 0.45633675481027475, 'support': 384665}, '1': {'precision': 0.6345182987245152, 'recall': 0.6173386287824434, 'f1-score': 0.6258105824473837, 'support': 588178}, '2': {'precision': 0.4659733979313468, 'recall': 0.5500246180256607, 'f1-score': 0.5045223242210614, 'support': 379803}, 'accuracy': 0.543782334771995, 'macro avg': {'precision': 0.5309858043182828, 'recall': 0.530836600967456, 'f1-score': 0.5288898871595733, 'support': 1352646}, 'weighted avg': {'precision': 0.5467965181739027, 'recall': 0.543782334771995, 'f1-score': 0.5435597243166086, 'support': 1352646}}
[[163539 101810 119316]
 [104979 363105 120094]
 [ 63564 107338 208901]]
Evaluating performance on  val set...
1714/1714 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9194569
{'0': {'precision': 0.48563507831631475, 'recall': 0.43985871757744166, 'f1-score': 0.4616148129929905, 'support': 119477}, '1': {'precision': 0.6539747877540519, 'recall': 0.6517227858155458, 'f1-score': 0.6528468447145853, 'support': 198922}, '2': {'precision': 0.4831435910686872, 'recall': 0.5313913152505537, 'f1-score': 0.5061202068331363, 'support': 119635}, 'accuracy': 0.5610706018254291, 'macro avg': {'precision': 0.5409178190463513, 'recall': 0.540990939547847, 'f1-score': 0.540193954846904, 'support': 438034}, 'weighted avg': {'precision': 0.5614018055655776, 'recall': 0.5610706018254291, 'f1-score': 0.5606132035430138, 'support': 438034}}
[[ 52553  32783  34141]
 [ 35412 129642  33868]
 [ 20250  35812  63573]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.131908
{'0': {'precision': 0.39347536617842876, 'recall': 0.40543998220046723, 'f1-score': 0.39936808269715457, 'support': 53934}, '1': {'precision': 0.6436709303138324, 'recall': 0.13322242314647378, 'f1-score': 0.22075462652219774, 'support': 69125}, '2': {'precision': 0.38487454069213184, 'recall': 0.7579148819830493, 'f1-score': 0.5105089989441894, 'support': 54865}, 'accuracy': 0.4083709898608395, 'macro avg': {'precision': 0.474006945728131, 'recall': 0.4321924291099968, 'f1-score': 0.3768772360545139, 'support': 177924}, 'weighted avg': {'precision': 0.4880263209712285, 'recall': 0.4083709898608395, 'f1-score': 0.36424685797086515, 'support': 177924}}
[[21867  2446 29621]
 [23077  9209 36839]
 [10630  2652 41583]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1476449
{'0': {'precision': 0.4356118476171702, 'recall': 0.3609228256431196, 'f1-score': 0.39476563721221053, 'support': 24490}, '1': {'precision': 0.5455522708949208, 'recall': 0.08570463564975091, 'f1-score': 0.14813733717663372, 'support': 23686}, '2': {'precision': 0.3819814938312771, 'recall': 0.7694794290512175, 'f1-score': 0.5105286613559133, 'support': 23820}, 'accuracy': 0.4055503083504639, 'macro avg': {'precision': 0.4543818707811227, 'recall': 0.4053689634480293, 'f1-score': 0.35114387858158586, 'support': 71996}, 'weighted avg': {'precision': 0.4540375079118647, 'recall': 0.4055503083504639, 'f1-score': 0.35192766455345625, 'support': 71996}}
[[ 8839   901 14750]
 [ 6751  2030 14905]
 [ 4701   790 18329]]
Evaluating performance on  val set...
73/73 - 1s - 684ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1152236
{'0': {'precision': 0.42888552975127114, 'recall': 0.49072327044025155, 'f1-score': 0.45772530615237955, 'support': 6360}, '1': {'precision': 0.6156156156156156, 'recall': 0.10929447307623956, 'f1-score': 0.18563235738001813, 'support': 5627}, '2': {'precision': 0.4176114151681001, 'recall': 0.655267596994326, 'f1-score': 0.5101175908792455, 'support': 6521}, 'accuracy': 0.43273179165766157, 'macro avg': {'precision': 0.4873708535116623, 'recall': 0.418428446836939, 'f1-score': 0.3844917514705477, 'support': 18508}, 'weighted avg': {'precision': 0.4816849511885852, 'recall': 0.43273179165766157, 'f1-score': 0.3934602891846799, 'support': 18508}}
[[3121  205 3034]
 [2087  615 2925]
 [2069  179 4273]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6967251
{'0': {'precision': 0.5002980935875216, 'recall': 0.4346474903335381, 'f1-score': 0.465167844067447, 'support': 83019}, '1': {'precision': 0.782934143376626, 'recall': 0.8647263754225959, 'f1-score': 0.8218001175267156, 'support': 349329}, '2': {'precision': 0.560813982882525, 'recall': 0.3835296732607246, 'f1-score': 0.45553078525123936, 'support': 80982}, 'accuracy': 0.719258566614069, 'macro avg': {'precision': 0.6146820732822244, 'recall': 0.5609678463389529, 'f1-score': 0.580832915615134, 'support': 513330}, 'weighted avg': {'precision': 0.7021831702120439, 'recall': 0.719258566614069, 'f1-score': 0.7063412942032246, 'support': 513330}}
[[ 36084  39061   7874]
 [ 30806 302074  16449]
 [  5235  44688  31059]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68345344
{'0': {'precision': 0.5308834215716807, 'recall': 0.43386782048019, 'f1-score': 0.4774976657329598, 'support': 23574}, '1': {'precision': 0.7807331876669095, 'recall': 0.8808396879656412, 'f1-score': 0.8277708278634934, 'support': 91272}, '2': {'precision': 0.5853164225941423, 'recall': 0.39456172050592747, 'f1-score': 0.471371785084371, 'support': 22691}, 'accuracy': 0.7240015414034042, 'macro avg': {'precision': 0.6323110106109108, 'recall': 0.5697564096505862, 'f1-score': 0.5922134262269415, 'support': 137537}, 'weighted avg': {'precision': 0.7056685853984649, 'recall': 0.7240015414034042, 'f1-score': 0.7089345132443999, 'support': 137537}}
[[10228 10652  2694]
 [ 7227 80396  3649]
 [ 1811 11927  8953]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7106255
{'0': {'precision': 0.5410509031198686, 'recall': 0.462521055586749, 'f1-score': 0.498713485696988, 'support': 7124}, '1': {'precision': 0.7596396522714526, 'recall': 0.8746065057712487, 'f1-score': 0.8130792030915843, 'support': 24778}, '2': {'precision': 0.6035649819494585, 'recall': 0.3742305540011192, 'f1-score': 0.4620034542314336, 'support': 7148}, 'accuracy': 0.7078361075544174, 'macro avg': {'precision': 0.63475184578026, 'recall': 0.5704527051197056, 'f1-score': 0.5912653810066686, 'support': 39050}, 'weighted avg': {'precision': 0.6911928406858573, 'recall': 0.7078361075544174, 'f1-score': 0.6914650974943638, 'support': 39050}}
[[ 3295  3004   825]
 [ 2175 21671   932]
 [  620  3853  2675]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1255729
{'0': {'precision': 0.4334080126515551, 'recall': 0.43625389666379255, 'f1-score': 0.4348262982183585, 'support': 75385}, '1': {'precision': 0.46345987920621223, 'recall': 0.38191449021187845, 'f1-score': 0.41875422275349516, 'support': 84388}, '2': {'precision': 0.43935152661442856, 'recall': 0.5200199559944737, 'f1-score': 0.47629425238873563, 'support': 78172}, 'accuracy': 0.4445018806867133, 'macro avg': {'precision': 0.44540647282406526, 'recall': 0.446062780956715, 'f1-score': 0.44329159112019645, 'support': 237945}, 'weighted avg': {'precision': 0.4460186297618964, 'recall': 0.4445018806867133, 'f1-score': 0.4427497368662722, 'support': 237945}}
[[32887 18419 24079]
 [24364 32229 27795]
 [18629 18892 40651]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1057605
{'0': {'precision': 0.46690267851178946, 'recall': 0.424163354470706, 'f1-score': 0.4445080364382124, 'support': 32959}, '1': {'precision': 0.45602133249676485, 'recall': 0.36657945339343695, 'f1-score': 0.40643785824129736, 'support': 31723}, '2': {'precision': 0.4341698749940587, 'recall': 0.5563202289960109, 'f1-score': 0.48771306912983703, 'support': 32839}, 'accuracy': 0.4499338603992986, 'macro avg': {'precision': 0.4523646286675376, 'recall': 0.449021012286718, 'f1-score': 0.4462196546031156, 'support': 97521}, 'weighted avg': {'precision': 0.4523406716173422, 'recall': 0.4499338603992986, 'f1-score': 0.44667279895725476, 'support': 97521}}
[[13980  6735 12244]
 [ 8529 11629 11565]
 [ 7433  7137 18269]]
Evaluating performance on  val set...
114/114 - 1s - 976ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1207515
{'0': {'precision': 0.46252322940326246, 'recall': 0.4511581067472306, 'f1-score': 0.4567699836867863, 'support': 9930}, '1': {'precision': 0.4153588298034436, 'recall': 0.29995598591549294, 'f1-score': 0.3483483483483483, 'support': 9088}, '2': {'precision': 0.4374805113813533, 'recall': 0.5579083407893429, 'f1-score': 0.49040940271770006, 'support': 10059}, 'accuracy': 0.4408295216150222, 'macro avg': {'precision': 0.4384541901960198, 'recall': 0.4363408111506888, 'f1-score': 0.4318425782509449, 'support': 29077}, 'weighted avg': {'precision': 0.4391186565743757, 'recall': 0.4408295216150222, 'f1-score': 0.43452020186872514, 'support': 29077}}
[[4480 1846 3604]
 [2750 2726 3612]
 [2456 1991 5612]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1065/1065 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3409852
{'0': {'precision': 0.3748381128584644, 'recall': 0.14089502416634792, 'f1-score': 0.20480679319669434, 'support': 86277}, '1': {'precision': 0.4684095860566449, 'recall': 0.0022320269919543214, 'f1-score': 0.004442883121177054, 'support': 96325}, '2': {'precision': 0.3302138032942905, 'recall': 0.8804157902351619, 'f1-score': 0.4802880222452257, 'support': 89853}, 'accuracy': 0.33575819860160394, 'macro avg': {'precision': 0.3911538340698, 'recall': 0.3411809471311547, 'f1-score': 0.22984589952103238, 'support': 272455}, 'weighted avg': {'precision': 0.39320314219741953, 'recall': 0.33575819860160394, 'f1-score': 0.2248202311430469, 'support': 272455}}
[[12156   117 74004]
 [ 9656   215 86454]
 [10618   127 79108]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3172244
{'0': {'precision': 0.38223083310268474, 'recall': 0.1559350741002117, 'f1-score': 0.22150490205906528, 'support': 35425}, '1': {'precision': 0.34024896265560167, 'recall': 0.002403846153846154, 'f1-score': 0.004773964428143103, 'support': 34112}, '2': {'precision': 0.3264763074403848, 'recall': 0.867502643903913, 'f1-score': 0.4744121486524448, 'support': 33095}, 'accuracy': 0.33435965390911215, 'macro avg': {'precision': 0.3496520343995571, 'recall': 0.34194718805265695, 'f1-score': 0.2335636717132177, 'support': 102632}, 'weighted avg': {'precision': 0.35029847680557746, 'recall': 0.33435965390911215, 'f1-score': 0.23102278713917557, 'support': 102632}}
[[ 5524    74 29827]
 [ 4628    82 29402]
 [ 4300    85 28710]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3109486
{'0': {'precision': 0.37324263038548755, 'recall': 0.16258395890952193, 'f1-score': 0.22650337140498145, 'support': 10124}, '1': {'precision': 0.32857142857142857, 'recall': 0.0021946564885496184, 'f1-score': 0.004360189573459716, 'support': 10480}, '2': {'precision': 0.34753354893870114, 'recall': 0.8674955924654356, 'f1-score': 0.4962577631509103, 'support': 10777}, 'accuracy': 0.35110417131385235, 'macro avg': {'precision': 0.3497825359652058, 'recall': 0.34409140262116905, 'f1-score': 0.24237377470978383, 'support': 31381}, 'weighted avg': {'precision': 0.3494951090903295, 'recall': 0.35110417131385235, 'f1-score': 0.24495665633062205, 'support': 31381}}
[[1646   32 8446]
 [1351   23 9106]
 [1413   15 9349]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2656342
{'0': {'precision': 0.3476903736401883, 'recall': 0.44205201787206216, 'f1-score': 0.3892338385635522, 'support': 110116}, '1': {'precision': 0.5601742242142741, 'recall': 0.1585194959289718, 'f1-score': 0.24711092685532507, 'support': 195528}, '2': {'precision': 0.3367912796023952, 'recall': 0.6580624518985481, 'f1-score': 0.44555232234758224, 'support': 115641}, 'accuracy': 0.3697520680774298, 'macro avg': {'precision': 0.41488529248561923, 'recall': 0.419544655233194, 'f1-score': 0.36063236258881987, 'support': 421285}, 'weighted avg': {'precision': 0.4433172300471941, 'recall': 0.3697520680774298, 'f1-score': 0.33873053819155413, 'support': 421285}}
[[ 48677  12264  49175]
 [ 63854  30995 100679]
 [ 27470  12072  76099]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1899678
{'0': {'precision': 0.43134352153415173, 'recall': 0.418504441596323, 'f1-score': 0.42482699835129706, 'support': 45254}, '1': {'precision': 0.42959174675954503, 'recall': 0.10974208807298119, 'f1-score': 0.17482417109229223, 'support': 44395}, '2': {'precision': 0.3900468797257788, 'recall': 0.6885497541767702, 'f1-score': 0.4979928078968327, 'support': 44951}, 'accuracy': 0.4068499257057949, 'macro avg': {'precision': 0.4169940493398252, 'recall': 0.4055987612820248, 'f1-score': 0.3658813257801407, 'support': 134600}, 'weighted avg': {'precision': 0.4169743136066121, 'recall': 0.4068499257057949, 'f1-score': 0.36680323006539706, 'support': 134600}}
[[18939  3246 23069]
 [14191  4872 25332]
 [10777  3223 30951]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1750363
{'0': {'precision': 0.42734833659491195, 'recall': 0.4268958214547528, 'f1-score': 0.42712195917036805, 'support': 12277}, '1': {'precision': 0.4533664459161148, 'recall': 0.13317662316608575, 'f1-score': 0.20587682476035338, 'support': 12337}, '2': {'precision': 0.4057505009553101, 'recall': 0.6838137124008482, 'f1-score': 0.5093004211511465, 'support': 12733}, 'accuracy': 0.4174632500602458, 'macro avg': {'precision': 0.4288217611554456, 'recall': 0.41462871900722886, 'f1-score': 0.380766401693956, 'support': 37347}, 'weighted avg': {'precision': 0.4285794976920986, 'recall': 0.4174632500602458, 'f1-score': 0.3820548087482431, 'support': 37347}}
[[5241  986 6050]
 [3992 1643 6702]
 [3031  995 8707]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
5929/5929 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70502466
{'0': {'precision': 0.495566986061827, 'recall': 0.5264181277021008, 'f1-score': 0.5105268979757384, 'support': 276174}, '1': {'precision': 0.7685313018872111, 'recall': 0.8234730417595323, 'f1-score': 0.7950541232856136, 'support': 967348}, '2': {'precision': 0.5977954534557253, 'recall': 0.4094420381607803, 'f1-score': 0.48600770107026675, 'support': 274051}, 'accuracy': 0.69464599067063, 'macro avg': {'precision': 0.6206312471349211, 'recall': 0.5864444025408044, 'f1-score': 0.5971962407772062, 'support': 1517573}, 'weighted avg': {'precision': 0.6880238225387667, 'recall': 0.69464599067063, 'f1-score': 0.6874655572151396, 'support': 1517573}}
[[145383 102189  28602]
 [123870 796585  46893]
 [ 24114 137729 112208]]
Evaluating performance on  train set...
1254/1254 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7525111
{'0': {'precision': 0.5039352670675628, 'recall': 0.5248123532210779, 'f1-score': 0.5141619735783515, 'support': 65149}, '1': {'precision': 0.7292813109713079, 'recall': 0.7881695947331612, 'f1-score': 0.757582803046768, 'support': 190171}, '2': {'precision': 0.5855693064106066, 'recall': 0.42452169144528396, 'f1-score': 0.4922068861984617, 'support': 65648}, 'accuracy': 0.660336856010568, 'macro avg': {'precision': 0.6062619614831591, 'recall': 0.579167879799841, 'f1-score': 0.5879838876078604, 'support': 320968}, 'weighted avg': {'precision': 0.6541477303972756, 'recall': 0.660336856010568, 'f1-score': 0.653896386306484, 'support': 320968}}
[[ 34191  24136   6822]
 [ 27382 149887  12902]
 [  6275  31504  27869]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7494018
{'0': {'precision': 0.4825741746761387, 'recall': 0.5397270517853805, 'f1-score': 0.5095530159290474, 'support': 21396}, '1': {'precision': 0.7351166389799946, 'recall': 0.7809553976801363, 'f1-score': 0.7573430460476275, 'support': 66297}, '2': {'precision': 0.5968350168350168, 'recall': 0.41188772190724043, 'f1-score': 0.48740651121865375, 'support': 21518}, 'accuracy': 0.6609773740740401, 'macro avg': {'precision': 0.6048419434970501, 'recall': 0.5775233904575857, 'f1-score': 0.5847675243984428, 'support': 109211}, 'weighted avg': {'precision': 0.658394124658535, 'recall': 0.6609773740740401, 'f1-score': 0.6556114453767519, 'support': 109211}}
[[11548  7947  1901]
 [10436 51775  4086]
 [ 1946 10709  8863]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
5331/5331 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7331328
{'0': {'precision': 0.4880471752285878, 'recall': 0.46383218098392587, 'f1-score': 0.47563167376597887, 'support': 238209}, '1': {'precision': 0.7683853671593599, 'recall': 0.8241137477183207, 'f1-score': 0.7952744698012051, 'support': 884765}, '2': {'precision': 0.5365697741993428, 'recall': 0.4203209839756324, 'f1-score': 0.4713840812783989, 'support': 241632}, 'accuracy': 0.6897221615616522, 'macro avg': {'precision': 0.5976674388624302, 'recall': 0.5694223042259596, 'f1-score': 0.580763408281861, 'support': 1364606}, 'weighted avg': {'precision': 0.6784010451501118, 'recall': 0.6897221615616522, 'f1-score': 0.6821252727726871, 'support': 1364606}}
[[110489  98625  29095]
 [ 96994 729147  58624]
 [ 18907 121162 101563]]
Evaluating performance on  train set...
2013/2013 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79723257
{'0': {'precision': 0.4879690469104146, 'recall': 0.4062788902337905, 'f1-score': 0.44339274291271624, 'support': 104923}, '1': {'precision': 0.7315837909138317, 'recall': 0.7753369701619668, 'f1-score': 0.7528251976060003, 'support': 307594}, '2': {'precision': 0.4870248322937507, 'recall': 0.48308769881803587, 'f1-score': 0.4850482762662447, 'support': 102795}, 'accuracy': 0.6418946191821654, 'macro avg': {'precision': 0.5688592233726657, 'recall': 0.5549011864045977, 'f1-score': 0.5604220722616537, 'support': 515312}, 'weighted avg': {'precision': 0.6331963519711684, 'recall': 0.6418946191821654, 'f1-score': 0.6364050287123909, 'support': 515312}}
[[ 42628  43274  19021]
 [ 35821 238489  33284]
 [  8909  44227  49659]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7651127
{'0': {'precision': 0.4835635403586722, 'recall': 0.44046571646430877, 'f1-score': 0.46100956152063477, 'support': 34098}, '1': {'precision': 0.7433332495538744, 'recall': 0.8043241773184662, 'f1-score': 0.772626931567329, 'support': 110310}, '2': {'precision': 0.5329892035333891, 'recall': 0.4373974523433072, 'f1-score': 0.4804850073734229, 'support': 33521}, 'accuracy': 0.6654676865491291, 'macro avg': {'precision': 0.5866286644819785, 'recall': 0.5607291153753606, 'f1-score': 0.5713738334871289, 'support': 177929}, 'weighted avg': {'precision': 0.6539235956425351, 'recall': 0.6654676865491291, 'f1-score': 0.6578709416794742, 'support': 177929}}
[[15019 14673  4406]
 [13144 88725  8441]
 [ 2896 15963 14662]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
4192/4192 - 43s - 43s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96633625
{'0': {'precision': 0.4956479149174363, 'recall': 0.4433540392107775, 'f1-score': 0.4680448302348054, 'support': 319555}, '1': {'precision': 0.5640616803050144, 'recall': 0.6213362515157789, 'f1-score': 0.5913153054452825, 'support': 439543}, '2': {'precision': 0.4911590837116014, 'recall': 0.47408709385706826, 'f1-score': 0.482472115465628, 'support': 314052}, 'accuracy': 0.5252462377114103, 'macro avg': {'precision': 0.5169562263113506, 'recall': 0.5129257948612082, 'f1-score': 0.5139440837152386, 'support': 1073150}, 'weighted avg': {'precision': 0.5223553325775, 'recall': 0.5252462377114103, 'f1-score': 0.5227562799545549, 'support': 1073150}}
[[141676  96703  81176]
 [ 93367 273104  73072]
 [ 50797 114367 148888]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0088913
{'0': {'precision': 0.5268316450245881, 'recall': 0.4380617686408261, 'f1-score': 0.4783633071319808, 'support': 106138}, '1': {'precision': 0.489711276299079, 'recall': 0.531515379350896, 'f1-score': 0.5097576984589215, 'support': 103743}, '2': {'precision': 0.4869138877681688, 'recall': 0.5287847903529994, 'f1-score': 0.5069863013698631, 'support': 104986}, 'accuracy': 0.49910279578361655, 'macro avg': {'precision': 0.5011522696972787, 'recall': 0.4994539794482405, 'f1-score': 0.49836910232025505, 'support': 314867}, 'weighted avg': {'precision': 0.5012913881033708, 'recall': 0.49910279578361655, 'f1-score': 0.49825094862025715, 'support': 314867}}
[[46495 26891 32752]
 [22855 55141 25747]
 [18904 30567 55515]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0111543
{'0': {'precision': 0.511982035718045, 'recall': 0.4289998236020462, 'f1-score': 0.46683196032952096, 'support': 34014}, '1': {'precision': 0.49513248847926267, 'recall': 0.5067354458364038, 'f1-score': 0.5008667783523928, 'support': 33925}, '2': {'precision': 0.47539975399754, 'recall': 0.5407800384772343, 'f1-score': 0.5059866357561708, 'support': 34306}, 'accuracy': 0.49229791187833144, 'macro avg': {'precision': 0.49417142606494924, 'recall': 0.4921717693052281, 'f1-score': 0.4912284581460282, 'support': 102245}, 'weighted avg': {'precision': 0.4941169797565864, 'recall': 0.49229791187833144, 'f1-score': 0.4912622160546183, 'support': 102245}}
[[14592  8074 11348]
 [ 7610 17191  9124]
 [ 6299  9455 18552]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
6143/6143 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91923016
{'0': {'precision': 0.5172876430974838, 'recall': 0.47285772068445653, 'f1-score': 0.4940758494672502, 'support': 462323}, '1': {'precision': 0.5816506944602214, 'recall': 0.6645823885369284, 'f1-score': 0.6203571596556969, 'support': 654903}, '2': {'precision': 0.5440664925337828, 'recall': 0.4799330515994693, 'f1-score': 0.5099914224195778, 'support': 455276}, 'accuracy': 0.554754143396956, 'macro avg': {'precision': 0.5476682766971627, 'recall': 0.5391243869402847, 'f1-score': 0.541474810514175, 'support': 1572502}, 'weighted avg': {'precision': 0.5518461510565017, 'recall': 0.554754143396956, 'f1-score': 0.5512764045557577, 'support': 1572502}}
[[218613 145378  98332]
 [134891 435237  84775]
 [ 69110 167664 218502]]
Evaluating performance on  train set...
2083/2083 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9689311
{'0': {'precision': 0.5264075834431707, 'recall': 0.44666994278096916, 'f1-score': 0.4832717616825714, 'support': 177039}, '1': {'precision': 0.5168851112633824, 'recall': 0.5883449496625733, 'f1-score': 0.5503048741052327, 'support': 180780}, '2': {'precision': 0.5187279231698096, 'recall': 0.5241222818960307, 'f1-score': 0.5214111508139073, 'support': 175398}, 'accuracy': 0.5201803393365177, 'macro avg': {'precision': 0.520673539292121, 'recall': 0.5197123914465244, 'f1-score': 0.5183292622005705, 'support': 533217}, 'weighted avg': {'precision': 0.520652947763346, 'recall': 0.5201803393365177, 'f1-score': 0.5185441154121538, 'support': 533217}}
[[ 79078  47549  50412]
 [ 39539 106361  34880]
 [ 31605  51863  91930]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96599877
{'0': {'precision': 0.5183520755821245, 'recall': 0.4365098922762797, 'f1-score': 0.4739235958491792, 'support': 56812}, '1': {'precision': 0.5323402876001886, 'recall': 0.5869233268356076, 'f1-score': 0.5583008838617961, 'support': 61560}, '2': {'precision': 0.5116298625943928, 'recall': 0.5355715568387881, 'f1-score': 0.5233270256322037, 'support': 56801}, 'accuracy': 0.5214901839895417, 'macro avg': {'precision': 0.520774075258902, 'recall': 0.519668258650225, 'f1-score': 0.5185171684477262, 'support': 175173}, 'weighted avg': {'precision': 0.5210881474191991, 'recall': 0.5214901839895417, 'f1-score': 0.5195951894461507, 'support': 175173}}
[[24799 14991 17022]
 [13413 36131 12016]
 [ 9630 16750 30421]]
testing model on single stock: results/universal/W7/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
23942/23942 - 238s - 238s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1573933
{'0': {'precision': 0.42610000397472075, 'recall': 0.4457602566388194, 'f1-score': 0.4357084631702589, 'support': 1923949}, '1': {'precision': 0.42393886793184704, 'recall': 0.0951818812818474, 'f1-score': 0.15546016628836143, 'support': 2296498}, '2': {'precision': 0.3728467961715637, 'recall': 0.7034014681835067, 'f1-score': 0.48736149923874955, 'support': 1908617}, 'accuracy': 0.3946326877970274, 'macro avg': {'precision': 0.4076285560260438, 'recall': 0.4147812020347245, 'f1-score': 0.3595100428991233, 'support': 6129064}, 'weighted avg': {'precision': 0.4087069693583706, 'recall': 0.3946326877970274, 'f1-score': 0.34678725259866927, 'support': 6129064}}
[[ 857620  152686  913643]
 [ 733341  218585 1344572]
 [ 421759  144334 1342524]]
Evaluating performance on  train set...
9052/9052 - 88s - 88s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1375008
{'0': {'precision': 0.4238677216540539, 'recall': 0.40124602281483057, 'f1-score': 0.41224676877185723, 'support': 772217}, '1': {'precision': 0.4503065272268301, 'recall': 0.11242980292081589, 'f1-score': 0.17993462087932446, 'support': 777454}, '2': {'precision': 0.3831724338094465, 'recall': 0.6950179109184281, 'f1-score': 0.49399756874095513, 'support': 767409}, 'accuracy': 0.4016352478119012, 'macro avg': {'precision': 0.4191155608967769, 'recall': 0.4028979122180248, 'f1-score': 0.36205965279737895, 'support': 2317080}, 'weighted avg': {'precision': 0.41926064075837266, 'recall': 0.4016352478119012, 'f1-score': 0.3613742443125569, 'support': 2317080}}
[[309849  54152 408216]
 [239658  87409 450387]
 [181497  52549 533363]]
Evaluating performance on  val set...
2763/2763 - 27s - 27s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1315055
{'0': {'precision': 0.42521645507155353, 'recall': 0.4055997021708153, 'f1-score': 0.41517648888197795, 'support': 233691}, '1': {'precision': 0.4620079092551304, 'recall': 0.11955125640626119, 'f1-score': 0.1899501522197317, 'support': 237463}, '2': {'precision': 0.3870455222504362, 'recall': 0.693188121662764, 'f1-score': 0.49673579429511205, 'support': 236161}, 'accuracy': 0.40558732672147485, 'macro avg': {'precision': 0.42475662885904003, 'recall': 0.4061130267466135, 'f1-score': 0.3672874784656073, 'support': 707315}, 'weighted avg': {'precision': 0.42482359392599156, 'recall': 0.40558732672147485, 'f1-score': 0.36679381007952666, 'support': 707315}}
[[ 94785  16639 122267]
 [ 72087  28389 136987]
 [ 56038  16419 163704]]
training model: results/universal/W7/deepVOL_L3/h10
Epoch 1/50
12475/12475 - 631s - loss: 2.9619 - accuracy10: 0.4757 - val_loss: 2.9424 - val_accuracy10: 0.4954 - 631s/epoch - 51ms/step
Epoch 2/50
12475/12475 - 613s - loss: 2.8084 - accuracy10: 0.5352 - val_loss: 2.8934 - val_accuracy10: 0.5114 - 613s/epoch - 49ms/step
Epoch 3/50
12475/12475 - 612s - loss: 2.7751 - accuracy10: 0.5439 - val_loss: 2.8613 - val_accuracy10: 0.5212 - 612s/epoch - 49ms/step
Epoch 4/50
12475/12475 - 611s - loss: 2.7569 - accuracy10: 0.5480 - val_loss: 2.8523 - val_accuracy10: 0.5226 - 611s/epoch - 49ms/step
Epoch 5/50
12475/12475 - 621s - loss: 2.7452 - accuracy10: 0.5505 - val_loss: 2.8387 - val_accuracy10: 0.5281 - 621s/epoch - 50ms/step
Epoch 6/50
12475/12475 - 611s - loss: 2.7358 - accuracy10: 0.5525 - val_loss: 2.8229 - val_accuracy10: 0.5320 - 611s/epoch - 49ms/step
Epoch 7/50
12475/12475 - 605s - loss: 2.7280 - accuracy10: 0.5542 - val_loss: 2.8208 - val_accuracy10: 0.5268 - 605s/epoch - 49ms/step
Epoch 8/50
12475/12475 - 607s - loss: 2.7205 - accuracy10: 0.5560 - val_loss: 2.8158 - val_accuracy10: 0.5295 - 607s/epoch - 49ms/step
Epoch 9/50
12475/12475 - 613s - loss: 2.7140 - accuracy10: 0.5575 - val_loss: 2.8092 - val_accuracy10: 0.5312 - 613s/epoch - 49ms/step
Epoch 10/50
12475/12475 - 617s - loss: 2.7083 - accuracy10: 0.5587 - val_loss: 2.8025 - val_accuracy10: 0.5334 - 617s/epoch - 49ms/step
Epoch 11/50
12475/12475 - 612s - loss: 2.7034 - accuracy10: 0.5598 - val_loss: 2.7977 - val_accuracy10: 0.5329 - 612s/epoch - 49ms/step
Epoch 12/50
12475/12475 - 615s - loss: 2.6992 - accuracy10: 0.5610 - val_loss: 2.7916 - val_accuracy10: 0.5377 - 615s/epoch - 49ms/step
Epoch 13/50
12475/12475 - 613s - loss: 2.6955 - accuracy10: 0.5618 - val_loss: 2.7871 - val_accuracy10: 0.5387 - 613s/epoch - 49ms/step
Epoch 14/50
12475/12475 - 611s - loss: 2.6921 - accuracy10: 0.5625 - val_loss: 2.7869 - val_accuracy10: 0.5352 - 611s/epoch - 49ms/step
Epoch 15/50
12475/12475 - 609s - loss: 2.6891 - accuracy10: 0.5631 - val_loss: 2.7839 - val_accuracy10: 0.5378 - 609s/epoch - 49ms/step
Epoch 16/50
12475/12475 - 617s - loss: 2.6863 - accuracy10: 0.5639 - val_loss: 2.7929 - val_accuracy10: 0.5356 - 617s/epoch - 49ms/step
Epoch 17/50
12475/12475 - 622s - loss: 2.6834 - accuracy10: 0.5644 - val_loss: 2.7893 - val_accuracy10: 0.5376 - 622s/epoch - 50ms/step
Epoch 18/50
12475/12475 - 619s - loss: 2.6807 - accuracy10: 0.5652 - val_loss: 2.7909 - val_accuracy10: 0.5358 - 619s/epoch - 50ms/step
Epoch 19/50
12475/12475 - 618s - loss: 2.6785 - accuracy10: 0.5656 - val_loss: 2.7891 - val_accuracy10: 0.5396 - 618s/epoch - 50ms/step
Epoch 20/50
12475/12475 - 616s - loss: 2.6764 - accuracy10: 0.5662 - val_loss: 2.7892 - val_accuracy10: 0.5361 - 616s/epoch - 49ms/step
Epoch 21/50
12475/12475 - 615s - loss: 2.6743 - accuracy10: 0.5666 - val_loss: 2.7916 - val_accuracy10: 0.5368 - 615s/epoch - 49ms/step
Epoch 22/50
12475/12475 - 619s - loss: 2.6724 - accuracy10: 0.5669 - val_loss: 2.7967 - val_accuracy10: 0.5367 - 619s/epoch - 50ms/step
Epoch 23/50
12475/12475 - 627s - loss: 2.6702 - accuracy10: 0.5677 - val_loss: 2.7974 - val_accuracy10: 0.5359 - 627s/epoch - 50ms/step
Epoch 24/50
12475/12475 - 624s - loss: 2.6688 - accuracy10: 0.5677 - val_loss: 2.7849 - val_accuracy10: 0.5389 - 624s/epoch - 50ms/step
Epoch 25/50
12475/12475 - 615s - loss: 2.6669 - accuracy10: 0.5682 - val_loss: 2.7910 - val_accuracy10: 0.5375 - 615s/epoch - 49ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 994s - 994s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89658105
{'0': {'precision': 0.4554370773074638, 'recall': 0.5789364132188998, 'f1-score': 0.5098141249716446, 'support': 2416540}, '1': {'precision': 0.7374317832936068, 'recall': 0.5260676093249597, 'f1-score': 0.6140706953147275, 'support': 4691838}, '2': {'precision': 0.45484795540081246, 'recall': 0.5856747513968414, 'f1-score': 0.5120368089276821, 'support': 2397194}, 'accuracy': 0.5545403264527374, 'macro avg': {'precision': 0.5492389386672943, 'recall': 0.5635595913135669, 'f1-score': 0.545307209738018, 'support': 9505572}, 'weighted avg': {'precision': 0.5944777618496165, 'recall': 0.5545403264527374, 'f1-score': 0.5618344708412734, 'support': 9505572}}
[[1399023  430729  586788]
 [1127685 2468224 1095929]
 [ 545117  448101 1403976]]
Evaluating performance on  train set...
12475/12475 - 347s - 347s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9341948
{'0': {'precision': 0.4783042541411012, 'recall': 0.5780763808495305, 'f1-score': 0.5234787216281638, 'support': 951914}, '1': {'precision': 0.7038810501180204, 'recall': 0.47396303844458076, 'f1-score': 0.56648176860934, 'support': 1297348}, '2': {'precision': 0.4738855475536493, 'recall': 0.586959193576755, 'f1-score': 0.5243962062598889, 'support': 943822}, 'accuracy': 0.5384008062424915, 'macro avg': {'precision': 0.5520236172709235, 'recall': 0.5463328709569554, 'f1-score': 0.5381188988324642, 'support': 3193084}, 'weighted avg': {'precision': 0.5686498675412754, 'recall': 0.5384008062424915, 'f1-score': 0.5412220253354948, 'support': 3193084}}
[[550279 127675 273960]
 [341371 614895 341082]
 [258829 131008 553985]]
Evaluating performance on  val set...
3866/3866 - 108s - 108s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93102556
{'0': {'precision': 0.46898136899226106, 'recall': 0.5882911414578093, 'f1-score': 0.5219043948649652, 'support': 285442}, '1': {'precision': 0.7189444786741089, 'recall': 0.4738277448730733, 'f1-score': 0.5712001575724572, 'support': 416185}, '2': {'precision': 0.46790546220842255, 'recall': 0.5806241849952186, 'f1-score': 0.5182060962684679, 'support': 287575}, 'accuracy': 0.5379042905291336, 'macro avg': {'precision': 0.5519437699582642, 'recall': 0.5475810237753671, 'f1-score': 0.5371035495686302, 'support': 989202}, 'weighted avg': {'precision': 0.5738350721889566, 'recall': 0.5379042905291336, 'f1-score': 0.5415693558977268, 'support': 989202}}
[[167923  36887  80632]
 [109738 197200 109247]
 [ 80398  40204 166973]]
testing model out of sample: results/universal/W7/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 402s - 402s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73378336
{'0': {'precision': 0.44109223002359116, 'recall': 0.5724578105019601, 'f1-score': 0.49826191531263886, 'support': 713981}, '1': {'precision': 0.8208462219345751, 'recall': 0.7356032184615883, 'f1-score': 0.775890442754657, 'support': 2344847}, '2': {'precision': 0.48412041205728495, 'recall': 0.505009546652801, 'f1-score': 0.49434440371667154, 'support': 715434}, 'accuracy': 0.661030421311504, 'macro avg': {'precision': 0.5820196213384837, 'recall': 0.6043568585387832, 'f1-score': 0.5894989205946558, 'support': 3774262}, 'weighted avg': {'precision': 0.6851793742270377, 'recall': 0.661030421311504, 'f1-score': 0.670002430066433, 'support': 3774262}}
[[ 408724  173297  131960]
 [ 366927 1724877  253043]
 [ 150967  203166  361301]]
Evaluating performance on  train set...
5285/5285 - 149s - 149s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78725797
{'0': {'precision': 0.4636928058526317, 'recall': 0.5475044905249076, 'f1-score': 0.502125340599455, 'support': 294509}, '1': {'precision': 0.7845784884556359, 'recall': 0.7118781739124767, 'f1-score': 0.7464623810340834, 'support': 766995}, '2': {'precision': 0.4795505225240387, 'recall': 0.5089337848884736, 'f1-score': 0.4938054365521735, 'support': 291142}, 'accuracy': 0.6324078879470312, 'macro avg': {'precision': 0.5759406056107688, 'recall': 0.5894388164419526, 'f1-score': 0.5807977193952373, 'support': 1352646}, 'weighted avg': {'precision': 0.6490587933136807, 'recall': 0.6324078879470312, 'f1-score': 0.6388817534554604, 'support': 1352646}}
[[161245  71934  61330]
 [121509 546007  99479]
 [ 64987  77983 148172]]
Evaluating performance on  val set...
1714/1714 - 46s - 46s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7448326
{'0': {'precision': 0.4687559210277009, 'recall': 0.5473632974545616, 'f1-score': 0.5050190606931254, 'support': 90397}, '1': {'precision': 0.7990826557651335, 'recall': 0.7533490294807839, 'f1-score': 0.7755422012018919, 'support': 257388}, '2': {'precision': 0.49763418354282407, 'recall': 0.49527418586355526, 'f1-score': 0.4964513800188815, 'support': 90249}, 'accuracy': 0.6576681262185127, 'macro avg': {'precision': 0.5884909201118861, 'recall': 0.5986621709329668, 'f1-score': 0.592337547304633, 'support': 438034}, 'weighted avg': {'precision': 0.6688051681508138, 'recall': 0.6576681262185127, 'f1-score': 0.6622127613558606, 'support': 438034}}
[[ 49480  23118  17799]
 [ 36161 193903  27324]
 [ 19915  25636  44698]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1173716
{'0': {'precision': 0.3817886563568709, 'recall': 0.6720110547436965, 'f1-score': 0.4869354108658976, 'support': 52828}, '1': {'precision': 0.7944325481798715, 'recall': 0.056106245789625635, 'f1-score': 0.10481033464314148, 'support': 72737}, '2': {'precision': 0.41684941291462513, 'recall': 0.6353253499875857, 'f1-score': 0.5034049636803873, 'support': 52359}, 'accuracy': 0.40942762078190686, 'macro avg': {'precision': 0.5310235391504559, 'recall': 0.4544808835069693, 'f1-score': 0.36505023639647544, 'support': 177924}, 'weighted avg': {'precision': 0.5607989355330194, 'recall': 0.40942762078190686, 'f1-score': 0.33556571170557775, 'support': 177924}}
[[35501   519 16808]
 [38928  4081 29728]
 [18557   537 33265]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1051538
{'0': {'precision': 0.4217204963724474, 'recall': 0.6445053298514491, 'f1-score': 0.5098377865826814, 'support': 23359}, '1': {'precision': 0.6763122476446837, 'recall': 0.039196567862714506, 'f1-score': 0.0740986507409865, 'support': 25640}, '2': {'precision': 0.41935020539484646, 'recall': 0.6347784493629604, 'f1-score': 0.5050512039856075, 'support': 22997}, 'accuracy': 0.4258292127340408, 'macro avg': {'precision': 0.5057943164706592, 'recall': 0.439493449025708, 'f1-score': 0.3629958804364251, 'support': 71996}, 'weighted avg': {'precision': 0.5116313653236149, 'recall': 0.4258292127340408, 'f1-score': 0.3531286849247287, 'support': 71996}}
[[15055   232  8072]
 [12494  1005 12141]
 [ 8150   249 14598]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0947541
{'0': {'precision': 0.3999801842861389, 'recall': 0.6878514227295962, 'f1-score': 0.5058263375516853, 'support': 5869}, '1': {'precision': 0.7679324894514767, 'recall': 0.05651296382549294, 'f1-score': 0.10527838033261026, 'support': 6441}, '2': {'precision': 0.4308021659740587, 'recall': 0.5519522426589223, 'f1-score': 0.4839097531650047, 'support': 6198}, 'accuracy': 0.4226280527339529, 'macro avg': {'precision': 0.5329049465705581, 'recall': 0.4321055430713372, 'f1-score': 0.36500482368310005, 'support': 18508}, 'weighted avg': {'precision': 0.5383536141581763, 'recall': 0.4226280527339529, 'f1-score': 0.3590914995099353, 'support': 18508}}
[[4037   48 1784]
 [3341  364 2736]
 [2715   62 3421]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50497305
{'0': {'precision': 0.4098396904367054, 'recall': 0.5370351207599495, 'f1-score': 0.4648942078578211, 'support': 48319}, '1': {'precision': 0.9032561779342895, 'recall': 0.8858177544877868, 'f1-score': 0.8944519784956653, 'support': 416965}, '2': {'precision': 0.532676399026764, 'recall': 0.45566748532656204, 'f1-score': 0.4911717856101227, 'support': 48046}, 'accuracy': 0.8127267060175716, 'macro avg': {'precision': 0.6152574224659196, 'recall': 0.6261734535247662, 'f1-score': 0.6168393239878697, 'support': 513330}, 'weighted avg': {'precision': 0.8221265589430232, 'recall': 0.8127267060175716, 'f1-score': 0.8162726356424738, 'support': 513330}}
[[ 25949  17901   4469]
 [ 32872 369355  14738]
 [  4494  21659  21893]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48905244
{'0': {'precision': 0.47645670269598706, 'recall': 0.5325279455668958, 'f1-score': 0.5029343300219664, 'support': 14403}, '1': {'precision': 0.8964712531563642, 'recall': 0.900782237529082, 'f1-score': 0.8986215750686471, 'support': 109174}, '2': {'precision': 0.5373935264054515, 'recall': 0.45193409742120344, 'f1-score': 0.49097276264591444, 'support': 13960}, 'accuracy': 0.8166602441524826, 'macro avg': {'precision': 0.6367738274192676, 'recall': 0.6284147601723937, 'f1-score': 0.6308428892455094, 'support': 137537}, 'weighted avg': {'precision': 0.8160405716981126, 'recall': 0.8166602441524826, 'f1-score': 0.8158085079534078, 'support': 137537}}
[[ 7670  5220  1513]
 [ 6914 98342  3918]
 [ 1514  6137  6309]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5168575
{'0': {'precision': 0.45721401885785445, 'recall': 0.588774341351661, 'f1-score': 0.5147206088523932, 'support': 4365}, '1': {'precision': 0.8928571428571429, 'recall': 0.8831589025718908, 'f1-score': 0.8879815432621289, 'support': 30289}, '2': {'precision': 0.5563562986451427, 'recall': 0.4390354868061874, 'f1-score': 0.4907819453273999, 'support': 4396}, 'accuracy': 0.8002560819462228, 'macro avg': {'precision': 0.6354758201200467, 'recall': 0.6369895769099131, 'f1-score': 0.631161365813974, 'support': 39050}, 'weighted avg': {'precision': 0.8062799354970187, 'recall': 0.8002560819462228, 'f1-score': 0.801544324024752, 'support': 39050}}
[[ 2570  1309   486]
 [ 2486 26750  1053]
 [  565  1901  1930]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0368618
{'0': {'precision': 0.39745009254362773, 'recall': 0.6896200716845878, 'f1-score': 0.5042720706175894, 'support': 69750}, '1': {'precision': 0.6774978528485542, 'recall': 0.24674688242899445, 'f1-score': 0.3617450587749736, 'support': 95908}, '2': {'precision': 0.4586722933004842, 'recall': 0.520245687329672, 'f1-score': 0.4875225242743619, 'support': 72287}, 'accuracy': 0.4596566433419488, 'macro avg': {'precision': 0.5112067462308887, 'recall': 0.48553754714775144, 'f1-score': 0.4511798845556416, 'support': 237945}, 'weighted avg': {'precision': 0.5289274920327356, 'recall': 0.4596566433419488, 'f1-score': 0.4417355386109724, 'support': 237945}}
[[48101  5067 16582]
 [44441 23665 27802]
 [28482  6198 37607]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0006192
{'0': {'precision': 0.4529626130381968, 'recall': 0.6407433335454719, 'f1-score': 0.5307327358987876, 'support': 31426}, '1': {'precision': 0.6440298507462686, 'recall': 0.3209096109839817, 'f1-score': 0.4283696067201222, 'support': 34960}, '2': {'precision': 0.4761410497377058, 'recall': 0.5451421230126867, 'f1-score': 0.5083106226228624, 'support': 31135}, 'accuracy': 0.4955650577824264, 'macro avg': {'precision': 0.5243778378407238, 'recall': 0.5022650225140467, 'f1-score': 0.48913765508059076, 'support': 97521}, 'weighted avg': {'precision': 0.5288577664606741, 'recall': 0.4955650577824264, 'f1-score': 0.48687830974511737, 'support': 97521}}
[[20136  2888  8402]
 [13469 11219 10272]
 [10849  3313 16973]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.017342
{'0': {'precision': 0.4549137389117832, 'recall': 0.6676576114812917, 'f1-score': 0.5411266201395813, 'support': 9755}, '1': {'precision': 0.6023738872403561, 'recall': 0.2708055413032324, 'f1-score': 0.3736372646184341, 'support': 9745}, '2': {'precision': 0.48424703728682916, 'recall': 0.5247989975984129, 'f1-score': 0.5037081579474845, 'support': 9577}, 'accuracy': 0.4876018846510988, 'macro avg': {'precision': 0.5138448878129895, 'recall': 0.48775405012764567, 'f1-score': 0.4728240142351667, 'support': 29077}, 'weighted avg': {'precision': 0.5139956298908993, 'recall': 0.4876018846510988, 'f1-score': 0.47266906324006314, 'support': 29077}}
[[6513  774 2468]
 [4221 2639 2885]
 [3583  968 5026]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.234487
{'0': {'precision': 0.3673794322288917, 'recall': 0.2616455753617272, 'f1-score': 0.30562601410642737, 'support': 88188}, '1': {'precision': 0.35990888382687924, 'recall': 0.0016370512355592395, 'f1-score': 0.003259277595560781, 'support': 96515}, '2': {'precision': 0.3271082984001644, 'recall': 0.7798568693591029, 'f1-score': 0.46089553847138176, 'support': 87752}, 'accuracy': 0.33644455047622546, 'macro avg': {'precision': 0.35146553815197845, 'recall': 0.3477131653187964, 'f1-score': 0.25659361005778997, 'support': 272455}, 'weighted avg': {'precision': 0.3517625688394927, 'recall': 0.33644455047622546, 'f1-score': 0.2485240549855714, 'support': 272455}}
[[23074   138 64976]
 [20558   158 75799]
 [19175   143 68434]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2072508
{'0': {'precision': 0.3836354342782998, 'recall': 0.2758006614467027, 'f1-score': 0.32090116757112314, 'support': 35377}, '1': {'precision': 0.4416243654822335, 'recall': 0.0025663716814159293, 'f1-score': 0.005103088248232983, 'support': 33900}, '2': {'precision': 0.33578348614321707, 'recall': 0.7751761355119172, 'f1-score': 0.4685883088521797, 'support': 33355}, 'accuracy': 0.3478447267908644, 'macro avg': {'precision': 0.3870144286345834, 'recall': 0.3511810562133453, 'f1-score': 0.2648641882238453, 'support': 102632}, 'weighted avg': {'precision': 0.387237849097924, 'recall': 0.3478447267908644, 'f1-score': 0.26458880601121654, 'support': 102632}}
[[ 9757    51 25569]
 [ 8236    87 25577]
 [ 7440    59 25856]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.219829
{'0': {'precision': 0.3621215975578733, 'recall': 0.2835939834644885, 'f1-score': 0.31808278867102396, 'support': 10039}, '1': {'precision': 0.3389830508474576, 'recall': 0.0018528812303131369, 'f1-score': 0.0036856168801253112, 'support': 10794}, '2': {'precision': 0.34317988064791133, 'recall': 0.7632726583238528, 'f1-score': 0.47347682898141613, 'support': 10548}, 'accuracy': 0.3479175297154329, 'macro avg': {'precision': 0.34809484301774746, 'recall': 0.34957317433955143, 'f1-score': 0.26508174484418845, 'support': 31381}, 'weighted avg': {'precision': 0.34779590037937336, 'recall': 0.3479175297154329, 'f1-score': 0.2621729472027169, 'support': 31381}}
[[2847   24 7168]
 [2533   20 8241]
 [2482   15 8051]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
1646/1646 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0922935
{'0': {'precision': 0.3976200661450499, 'recall': 0.670121554156718, 'f1-score': 0.4990978559283134, 'support': 128996}, '1': {'precision': 0.7222539283947799, 'recall': 0.11764013261859758, 'f1-score': 0.2023256309686221, 'support': 161365}, '2': {'precision': 0.4305887917297763, 'recall': 0.5841022272463414, 'f1-score': 0.49573292277773273, 'support': 130924}, 'accuracy': 0.43177184091529486, 'macro avg': {'precision': 0.5168209287565354, 'recall': 0.4572879713405524, 'f1-score': 0.39905213655822275, 'support': 421285}, 'weighted avg': {'precision': 0.5322105229863389, 'recall': 0.43177184091529486, 'f1-score': 0.3843793148256697, 'support': 421285}}
[[86443  3347 39206]
 [80460 18983 61922]
 [50498  3953 76473]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860002
{'0': {'precision': 0.4317705884866875, 'recall': 0.6572196803781686, 'f1-score': 0.5211582440634833, 'support': 46117}, '1': {'precision': 0.643324607329843, 'recall': 0.0689840698028024, 'f1-score': 0.12460651131345996, 'support': 42749}, '2': {'precision': 0.4452264330731039, 'recall': 0.5823457384003149, 'f1-score': 0.5046374806969012, 'support': 45734}, 'accuracy': 0.4449554234769688, 'macro avg': {'precision': 0.5067738762965448, 'recall': 0.43618316286042863, 'f1-score': 0.3834674120246148, 'support': 134600}, 'weighted avg': {'precision': 0.5035321958257752, 'recall': 0.4449554234769688, 'f1-score': 0.3895999185423985, 'support': 134600}}
[[30309   758 15050]
 [21664  2949 18136]
 [18224   877 26633]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0676136
{'0': {'precision': 0.43567251461988304, 'recall': 0.6671641791044776, 'f1-score': 0.527122641509434, 'support': 12730}, '1': {'precision': 0.6554921540656206, 'recall': 0.07994084899095337, 'f1-score': 0.1425027135990076, 'support': 11496}, '2': {'precision': 0.46617226916296883, 'recall': 0.5844828900236263, 'f1-score': 0.5186663059651022, 'support': 13121}, 'accuracy': 0.45735935952017565, 'macro avg': {'precision': 0.5191123126161575, 'recall': 0.443862639373019, 'f1-score': 0.39609722035784795, 'support': 37347}, 'weighted avg': {'precision': 0.5140518718487911, 'recall': 0.45735935952017565, 'f1-score': 0.40575957968558096, 'support': 37347}}
[[8493  217 4020]
 [5815  919 4762]
 [5186  266 7669]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
5929/5929 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5381332
{'0': {'precision': 0.4289956572558038, 'recall': 0.5112830066876943, 'f1-score': 0.46653869306746515, 'support': 176593}, '1': {'precision': 0.8837024475347749, 'recall': 0.8694095527470728, 'f1-score': 0.8764977360821017, 'support': 1166387}, '2': {'precision': 0.48661841651784316, 'recall': 0.44478873723459705, 'f1-score': 0.46476428729599195, 'support': 174593}, 'accuracy': 0.7788844424617465, 'macro avg': {'precision': 0.5997721737694739, 'recall': 0.6084937655564547, 'f1-score': 0.6026002388151862, 'support': 1517573}, 'weighted avg': {'precision': 0.7851067763920532, 'recall': 0.7788844424617465, 'f1-score': 0.7814237756815168, 'support': 1517573}}
[[  90289   57083   29221]
 [  99612 1014068   52707]
 [  20565   76371   77657]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54881585
{'0': {'precision': 0.455931855500821, 'recall': 0.5488757104027675, 'f1-score': 0.4981051687408902, 'support': 40470}, '1': {'precision': 0.8650587029914171, 'recall': 0.8591028319550957, 'f1-score': 0.8620704806181437, 'support': 239799}, '2': {'precision': 0.5290909090909091, 'recall': 0.4433032752647485, 'f1-score': 0.4824128664821722, 'support': 40699}, 'accuracy': 0.767263403205304, 'macro avg': {'precision': 0.6166938225277158, 'recall': 0.6170939392075373, 'f1-score': 0.6141961719470688, 'support': 320968}, 'weighted avg': {'precision': 0.770872002878318, 'recall': 0.767263403205304, 'f1-score': 0.7680381739414894, 'support': 320968}}
[[ 22213  13855   4402]
 [ 22131 206012  11656]
 [  4376  18281  18042]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5297289
{'0': {'precision': 0.44601813889924213, 'recall': 0.5543545398394071, 'f1-score': 0.49432013769363164, 'support': 12952}, '1': {'precision': 0.8747426761678543, 'recall': 0.8635817018615614, 'f1-score': 0.869126359295859, 'support': 83156}, '2': {'precision': 0.5255037211835178, 'recall': 0.441883538121041, 'f1-score': 0.4800795986899382, 'support': 13103}, 'accuracy': 0.7763137412897968, 'macro avg': {'precision': 0.6154215120835381, 'recall': 0.6199399266073365, 'f1-score': 0.6145086985598096, 'support': 109211}, 'weighted avg': {'precision': 0.7819963572635055, 'recall': 0.7763137412897968, 'f1-score': 0.7779984519750632, 'support': 109211}}
[[ 7180  4308  1464]
 [ 7580 71812  3764]
 [ 1338  5975  5790]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
5331/5331 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50620216
{'0': {'precision': 0.4798533311684797, 'recall': 0.4859950119220544, 'f1-score': 0.4829046445446004, 'support': 145948}, '1': {'precision': 0.8768634985330802, 'recall': 0.8985719489301291, 'f1-score': 0.8875850078901714, 'support': 1070690}, '2': {'precision': 0.5277733646618114, 'recall': 0.4265652032871972, 'f1-score': 0.47180269172263517, 'support': 147968}, 'accuracy': 0.8032648251583241, 'macro avg': {'precision': 0.6281633981211238, 'recall': 0.6037107213797935, 'f1-score': 0.614097448052469, 'support': 1364606}, 'weighted avg': {'precision': 0.7965494673510449, 'recall': 0.8032648251583241, 'f1-score': 0.7992190125565459, 'support': 1364606}}
[[ 70930  60368  14650]
 [ 66773 962092  41825]
 [ 10113  74737  63118]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5785346
{'0': {'precision': 0.46572811918063317, 'recall': 0.46685483027940805, 'f1-score': 0.46629079410536367, 'support': 66963}, '1': {'precision': 0.8537693804207692, 'recall': 0.8631918250493694, 'f1-score': 0.8584547482013455, 'support': 382828}, '2': {'precision': 0.4926064056008113, 'recall': 0.45962363211794693, 'f1-score': 0.4755438000868501, 'support': 65521}, 'accuracy': 0.7603762380848884, 'macro avg': {'precision': 0.6040346350674045, 'recall': 0.5965567624822415, 'f1-score': 0.6000964474645197, 'support': 515312}, 'weighted avg': {'precision': 0.7574235428512935, 'recall': 0.7603762380848884, 'f1-score': 0.7588079651077264, 'support': 515312}}
[[ 31262  27247   8454]
 [ 29809 330454  22565]
 [  6054  29352  30115]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51879764
{'0': {'precision': 0.4985710062087316, 'recall': 0.4709551293986222, 'f1-score': 0.48436976399061704, 'support': 21484}, '1': {'precision': 0.8656331297364551, 'recall': 0.9027299602633383, 'f1-score': 0.8837924351946417, 'support': 135643}, '2': {'precision': 0.5622102725755609, 'recall': 0.43726564753389097, 'f1-score': 0.49192828749898593, 'support': 20802}, 'accuracy': 0.796177126831489, 'macro avg': {'precision': 0.6421381361735825, 'recall': 0.6036502457319505, 'f1-score': 0.6200301622280816, 'support': 177929}, 'weighted avg': {'precision': 0.785838577209714, 'recall': 0.796177126831489, 'f1-score': 0.7897506844484885, 'support': 177929}}
[[ 10118   9147   2219]
 [  8330 122449   4864]
 [  1846   9860   9096]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
4192/4192 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8065591
{'0': {'precision': 0.45045758158287746, 'recall': 0.5143705669416851, 'f1-score': 0.4802971844805508, 'support': 224591}, '1': {'precision': 0.7332696200409999, 'recall': 0.7225780529135148, 'f1-score': 0.7278845776970413, 'support': 629669}, '2': {'precision': 0.48162381182946407, 'recall': 0.431709991319841, 'f1-score': 0.4553030029270408, 'support': 218890}, 'accuracy': 0.6196757210082467, 'macro avg': {'precision': 0.5551170044844471, 'recall': 0.556219537058347, 'f1-score': 0.5544949217015444, 'support': 1073150}, 'weighted avg': {'precision': 0.6227540448755792, 'recall': 0.6196757210082467, 'f1-score': 0.6204706270552017, 'support': 1073150}}
[[115523  76697  32371]
 [105347 454985  69337]
 [ 35587  88806  94497]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8752743
{'0': {'precision': 0.4759648649599512, 'recall': 0.5239539897496804, 'f1-score': 0.49880785586117055, 'support': 77461}, '1': {'precision': 0.6777315496383537, 'recall': 0.658245003263809, 'f1-score': 0.6678461611239888, 'support': 160855}, '2': {'precision': 0.48402529782187936, 'recall': 0.4638868205510052, 'f1-score': 0.4737421373159815, 'support': 76551}, 'accuracy': 0.5779551366132367, 'macro avg': {'precision': 0.5459072374733948, 'recall': 0.5486952711881649, 'f1-score': 0.5467987181003803, 'support': 314867}, 'weighted avg': {'precision': 0.5810003696649786, 'recall': 0.5779551366132367, 'f1-score': 0.5790698419463997, 'support': 314867}}
[[ 40586  23615  13260]
 [ 30378 105882  24595]
 [ 14307  26733  35511]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8821203
{'0': {'precision': 0.4738906238652044, 'recall': 0.5184743742550656, 'f1-score': 0.4951809971920771, 'support': 25170}, '1': {'precision': 0.6764561014653367, 'recall': 0.6422016561130054, 'f1-score': 0.6588839691757203, 'support': 51325}, '2': {'precision': 0.4736153342827451, 'recall': 0.4778640776699029, 'f1-score': 0.4757302197908411, 'support': 25750}, 'accuracy': 0.5703555186072669, 'macro avg': {'precision': 0.5413206865377621, 'recall': 0.546180036012658, 'f1-score': 0.5432650620528795, 'support': 102245}, 'weighted avg': {'precision': 0.5755052204819433, 'recall': 0.5703555186072669, 'f1-score': 0.5724581013925628, 'support': 102245}}
[[13050  7253  4867]
 [ 9555 32961  8809]
 [ 4933  8512 12305]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
6143/6143 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7461071
{'0': {'precision': 0.48152419628528204, 'recall': 0.5290574766399438, 'f1-score': 0.5041729591045491, 'support': 316459}, '1': {'precision': 0.7631891594430414, 'recall': 0.7579487092581981, 'f1-score': 0.7605599074508546, 'support': 944147}, '2': {'precision': 0.5237062060319008, 'recall': 0.48213827686151794, 'f1-score': 0.502063315059529, 'support': 311896}, 'accuracy': 0.657180086257442, 'macro avg': {'precision': 0.5894731872534081, 'recall': 0.5897148209198867, 'f1-score': 0.5889320605383109, 'support': 1572502}, 'weighted avg': {'precision': 0.6590053887304684, 'recall': 0.657180086257442, 'f1-score': 0.6576919871129419, 'support': 1572502}}
[[167425 104429  44605]
 [136374 715615  92158]
 [ 43899 117620 150377]]
Evaluating performance on  train set...
2083/2083 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83182186
{'0': {'precision': 0.49315519990188866, 'recall': 0.508030384384574, 'f1-score': 0.5004822875989856, 'support': 126644}, '1': {'precision': 0.7017028422776085, 'recall': 0.7127249677727211, 'f1-score': 0.707170959301966, 'support': 280818}, '2': {'precision': 0.5082536333004323, 'recall': 0.47498707804858653, 'f1-score': 0.4910575923117079, 'support': 125755}, 'accuracy': 0.6080395036167264, 'macro avg': {'precision': 0.5677038918266432, 'recall': 0.5652474767352939, 'f1-score': 0.56623694640422, 'support': 533217}, 'weighted avg': {'precision': 0.606547374811351, 'recall': 0.6080395036167264, 'f1-score': 0.607111852774957, 'support': 533217}}
[[ 64339  40801  21504]
 [ 44384 200146  36288]
 [ 21741  44282  59732]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8228627
{'0': {'precision': 0.4917914225790121, 'recall': 0.5029709805468576, 'f1-score': 0.4973183812774256, 'support': 40559}, '1': {'precision': 0.7113996353634247, 'recall': 0.7176466836056685, 'f1-score': 0.714509505059486, 'support': 94063}, '2': {'precision': 0.5014818441873051, 'recall': 0.47986486153239133, 'f1-score': 0.4904352647629609, 'support': 40551}, 'accuracy': 0.6128969647148819, 'macro avg': {'precision': 0.568224300709914, 'recall': 0.5668275085616391, 'f1-score': 0.5674210503666242, 'support': 175173}, 'weighted avg': {'precision': 0.6119581355186665, 'recall': 0.6128969647148819, 'f1-score': 0.6123505575747653, 'support': 175173}}
[[20400 12901  7258]
 [14473 67504 12086]
 [ 6608 14484 19459]]
testing model on single stock: results/universal/W7/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
23942/23942 - 500s - 500s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0188425
{'0': {'precision': 0.46151866650210105, 'recall': 0.6090015749003779, 'f1-score': 0.5251009441493236, 'support': 1878849}, '1': {'precision': 0.5379700350642588, 'recall': 0.26411093135966807, 'f1-score': 0.35428784113378053, 'support': 2382302}, '2': {'precision': 0.46015370268155176, 'recall': 0.610999013337345, 'f1-score': 0.5249549464186657, 'support': 1867913}, 'accuracy': 0.47555499502044685, 'macro avg': {'precision': 0.4865474680826372, 'recall': 0.49470383986579697, 'f1-score': 0.46811457723392325, 'support': 6129064}, 'weighted avg': {'precision': 0.4908185097674727, 'recall': 0.47555499502044685, 'f1-score': 0.45866321271117894, 'support': 6129064}}
[[1144222  279128  455499]
 [ 869659  629192  883451]
 [ 465373  261247 1141293]]
Evaluating performance on  train set...
9052/9052 - 193s - 193s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0101393
{'0': {'precision': 0.481984992619321, 'recall': 0.5995717945480953, 'f1-score': 0.5343863778560604, 'support': 784203}, '1': {'precision': 0.554282076634476, 'recall': 0.27151084100740425, 'f1-score': 0.3644826434503796, 'support': 753620}, '2': {'precision': 0.48167893007543156, 'recall': 0.6010687103227819, 'f1-score': 0.5347915294160631, 'support': 779257}, 'accuracy': 0.493374851105702, 'macro avg': {'precision': 0.5059819997764096, 'recall': 0.49071711529276046, 'f1-score': 0.4778868502408344, 'support': 2317080}, 'weighted avg': {'precision': 0.5053963668816415, 'recall': 0.493374851105702, 'f1-score': 0.47926219779597784, 'support': 2317080}}
[[470186  85023 228994]
 [273980 204616 275024]
 [231354  79516 468387]]
Evaluating performance on  val set...
2763/2763 - 51s - 51s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0100718
{'0': {'precision': 0.4719932705383237, 'recall': 0.6094901166085628, 'f1-score': 0.5320012067088515, 'support': 232916}, '1': {'precision': 0.5769349259301639, 'recall': 0.2723993333915161, 'f1-score': 0.3700702933122547, 'support': 240621}, '2': {'precision': 0.4733818303469323, 'recall': 0.5931781433667839, 'f1-score': 0.5265522092508881, 'support': 233778}, 'accuracy': 0.48942408969129736, 'macro avg': {'precision': 0.5074366756051399, 'recall': 0.4916891977889543, 'f1-score': 0.4762079030906648, 'support': 707315}, 'weighted avg': {'precision': 0.508152239027578, 'recall': 0.48942408969129736, 'f1-score': 0.475113067704122, 'support': 707315}}
[[141960  24191  66765]
 [ 87574  65545  87502]
 [ 71233  23873 138672]]
training model: results/universal/W7/deepVOL_L3/h20
Epoch 1/50
12475/12475 - 1023s - loss: 3.0772 - accuracy20: 0.4333 - val_loss: 3.1541 - val_accuracy20: 0.4483 - 1023s/epoch - 82ms/step
Epoch 2/50
12475/12475 - 1074s - loss: 2.9671 - accuracy20: 0.4865 - val_loss: 3.1873 - val_accuracy20: 0.4545 - 1074s/epoch - 86ms/step
Epoch 3/50
12475/12475 - 1130s - loss: 2.9322 - accuracy20: 0.4976 - val_loss: 3.1116 - val_accuracy20: 0.4688 - 1130s/epoch - 91ms/step
Epoch 4/50
12475/12475 - 1171s - loss: 2.9119 - accuracy20: 0.5029 - val_loss: 3.0776 - val_accuracy20: 0.4691 - 1171s/epoch - 94ms/step
Epoch 5/50
12475/12475 - 1102s - loss: 2.8990 - accuracy20: 0.5063 - val_loss: 3.0385 - val_accuracy20: 0.4771 - 1102s/epoch - 88ms/step
Epoch 6/50
12475/12475 - 1106s - loss: 2.8891 - accuracy20: 0.5091 - val_loss: 3.0414 - val_accuracy20: 0.4799 - 1106s/epoch - 89ms/step
Epoch 7/50
12475/12475 - 1111s - loss: 2.8811 - accuracy20: 0.5114 - val_loss: 3.0346 - val_accuracy20: 0.4768 - 1111s/epoch - 89ms/step
Epoch 8/50
12475/12475 - 1092s - loss: 2.8750 - accuracy20: 0.5128 - val_loss: 3.0460 - val_accuracy20: 0.4756 - 1092s/epoch - 87ms/step
Epoch 9/50
12475/12475 - 1110s - loss: 2.8695 - accuracy20: 0.5144 - val_loss: 3.0428 - val_accuracy20: 0.4770 - 1110s/epoch - 89ms/step
Epoch 10/50
12475/12475 - 1158s - loss: 2.8652 - accuracy20: 0.5154 - val_loss: 3.0470 - val_accuracy20: 0.4808 - 1158s/epoch - 93ms/step
Epoch 11/50
12475/12475 - 1091s - loss: 2.8609 - accuracy20: 0.5164 - val_loss: 3.0449 - val_accuracy20: 0.4773 - 1091s/epoch - 87ms/step
Epoch 12/50
12475/12475 - 1127s - loss: 2.8575 - accuracy20: 0.5174 - val_loss: 3.0517 - val_accuracy20: 0.4788 - 1127s/epoch - 90ms/step
Epoch 13/50
12475/12475 - 1174s - loss: 2.8542 - accuracy20: 0.5185 - val_loss: 3.0359 - val_accuracy20: 0.4805 - 1174s/epoch - 94ms/step
Epoch 14/50
12475/12475 - 1014s - loss: 2.8516 - accuracy20: 0.5191 - val_loss: 3.0357 - val_accuracy20: 0.4805 - 1014s/epoch - 81ms/step
Epoch 15/50
12475/12475 - 1154s - loss: 2.8491 - accuracy20: 0.5200 - val_loss: 3.0327 - val_accuracy20: 0.4798 - 1154s/epoch - 92ms/step
Epoch 16/50
12475/12475 - 1149s - loss: 2.8465 - accuracy20: 0.5204 - val_loss: 3.0245 - val_accuracy20: 0.4791 - 1149s/epoch - 92ms/step
Epoch 17/50
12475/12475 - 1099s - loss: 2.8442 - accuracy20: 0.5212 - val_loss: 3.0323 - val_accuracy20: 0.4790 - 1099s/epoch - 88ms/step
Epoch 18/50
12475/12475 - 1157s - loss: 2.8423 - accuracy20: 0.5216 - val_loss: 3.0244 - val_accuracy20: 0.4801 - 1157s/epoch - 93ms/step
Epoch 19/50
12475/12475 - 1091s - loss: 2.8402 - accuracy20: 0.5222 - val_loss: 3.0341 - val_accuracy20: 0.4771 - 1091s/epoch - 87ms/step
Epoch 20/50
12475/12475 - 1128s - loss: 2.8385 - accuracy20: 0.5224 - val_loss: 3.0234 - val_accuracy20: 0.4780 - 1128s/epoch - 90ms/step
Epoch 21/50
12475/12475 - 1077s - loss: 2.8373 - accuracy20: 0.5229 - val_loss: 3.0262 - val_accuracy20: 0.4780 - 1077s/epoch - 86ms/step
Epoch 22/50
12475/12475 - 1059s - loss: 2.8352 - accuracy20: 0.5236 - val_loss: 3.0231 - val_accuracy20: 0.4775 - 1059s/epoch - 85ms/step
Epoch 23/50
12475/12475 - 1084s - loss: 2.8341 - accuracy20: 0.5239 - val_loss: 3.0336 - val_accuracy20: 0.4770 - 1084s/epoch - 87ms/step
Epoch 24/50
12475/12475 - 1124s - loss: 2.8323 - accuracy20: 0.5244 - val_loss: 3.0351 - val_accuracy20: 0.4766 - 1124s/epoch - 90ms/step
Epoch 25/50
12475/12475 - 1107s - loss: 2.8309 - accuracy20: 0.5246 - val_loss: 3.0335 - val_accuracy20: 0.4753 - 1107s/epoch - 89ms/step
Epoch 26/50
12475/12475 - 1080s - loss: 2.8295 - accuracy20: 0.5252 - val_loss: 3.0526 - val_accuracy20: 0.4746 - 1080s/epoch - 87ms/step
Epoch 27/50
12475/12475 - 1087s - loss: 2.8285 - accuracy20: 0.5255 - val_loss: 3.0451 - val_accuracy20: 0.4748 - 1087s/epoch - 87ms/step
Epoch 28/50
12475/12475 - 1077s - loss: 2.8270 - accuracy20: 0.5259 - val_loss: 3.0506 - val_accuracy20: 0.4744 - 1077s/epoch - 86ms/step
Epoch 29/50
12475/12475 - 1119s - loss: 2.8258 - accuracy20: 0.5261 - val_loss: 3.0388 - val_accuracy20: 0.4748 - 1119s/epoch - 90ms/step
Epoch 30/50
12475/12475 - 1090s - loss: 2.8245 - accuracy20: 0.5264 - val_loss: 3.0470 - val_accuracy20: 0.4743 - 1090s/epoch - 87ms/step
Epoch 31/50
12475/12475 - 1097s - loss: 2.8235 - accuracy20: 0.5268 - val_loss: 3.0546 - val_accuracy20: 0.4744 - 1097s/epoch - 88ms/step
Epoch 32/50
12475/12475 - 1097s - loss: 2.8222 - accuracy20: 0.5272 - val_loss: 3.0575 - val_accuracy20: 0.4734 - 1097s/epoch - 88ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 2002s - 2002s/epoch - 54ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0095973
{'0': {'precision': 0.4053057770155509, 'recall': 0.6529354878289241, 'f1-score': 0.5001478094400763, 'support': 2551007}, '1': {'precision': 0.7658594340307064, 'recall': 0.3506805245331422, 'f1-score': 0.4810790442108219, 'support': 4425116}, '2': {'precision': 0.4293979410360344, 'recall': 0.572047509161086, 'f1-score': 0.49056296088860835, 'support': 2529449}, 'accuracy': 0.4907027162594739, 'macro avg': {'precision': 0.5335210506940973, 'recall': 0.5252211738410507, 'f1-score': 0.4905966048465022, 'support': 9505572}, 'weighted avg': {'precision': 0.5795647965364936, 'recall': 0.4907027162594739, 'f1-score': 0.4887202084814092, 'support': 9505572}}
[[1665643  190572  694792]
 [1645318 1551802 1227996]
 [ 798635  283849 1446965]]
Evaluating performance on  train set...
12475/12475 - 690s - 690s/epoch - 55ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.02343
{'0': {'precision': 0.42513260844827894, 'recall': 0.6295882712427391, 'f1-score': 0.5075437666129815, 'support': 985066}, '1': {'precision': 0.732226376041909, 'recall': 0.29692382264484235, 'f1-score': 0.42251452682645696, 'support': 1229578}, '2': {'precision': 0.4497440263370436, 'recall': 0.56798270716651, 'f1-score': 0.5019949288970667, 'support': 978440}, 'accuracy': 0.48260991568026396, 'macro avg': {'precision': 0.5357010036090771, 'recall': 0.49816493368469716, 'f1-score': 0.4773510741121683, 'support': 3193084}, 'weighted avg': {'precision': 0.5509284021979339, 'recall': 0.48260991568026396, 'f1-score': 0.4731007994461312, 'support': 3193084}}
[[620186  54370 310510]
 [495060 365091 369427]
 [343560  79143 555737]]
Evaluating performance on  val set...
3866/3866 - 227s - 227s/epoch - 59ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0313497
{'0': {'precision': 0.41498076688578744, 'recall': 0.6313199452243307, 'f1-score': 0.5007845870450165, 'support': 296482}, '1': {'precision': 0.7394874933848518, 'recall': 0.29472049847276643, 'f1-score': 0.4214667153621545, 'support': 393522}, '2': {'precision': 0.44303996643239274, 'recall': 0.5646428117835012, 'f1-score': 0.49650413361586326, 'support': 299198}, 'accuracy': 0.47724731652382424, 'macro avg': {'precision': 0.532502742234344, 'recall': 0.4968944184935327, 'f1-score': 0.4729184786743448, 'support': 989202}, 'weighted avg': {'precision': 0.5525621632146566, 'recall': 0.47724731652382424, 'f1-score': 0.46793585583998554, 'support': 989202}}
[[187175  15984  93323]
 [158486 115979 119057]
 [105384  24874 168940]]
testing model out of sample: results/universal/W7/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 789s - 789s/epoch - 54ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86559355
{'0': {'precision': 0.42661891097364363, 'recall': 0.63766757485564, 'f1-score': 0.5112177030720169, 'support': 857751}, '1': {'precision': 0.7808553931410391, 'recall': 0.6171432209477172, 'f1-score': 0.6894135767531769, 'support': 2057618}, '2': {'precision': 0.4981015245543086, 'recall': 0.5021987604975241, 'f1-score': 0.5001417513744665, 'support': 858893}, 'accuracy': 0.5956502224805803, 'macro avg': {'precision': 0.5685252762229971, 'recall': 0.5856698521002938, 'f1-score': 0.56692434373322, 'support': 3774262}, 'weighted avg': {'precision': 0.6360053495384412, 'recall': 0.5956502224805803, 'f1-score': 0.6058444088573379, 'support': 3774262}}
[[ 546960  137426  173365]
 [ 526515 1269845  261258]
 [ 208606  218952  431335]]
Evaluating performance on  train set...
5285/5285 - 300s - 300s/epoch - 57ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8956617
{'0': {'precision': 0.449501553749596, 'recall': 0.6102472180796146, 'f1-score': 0.5176832094359108, 'support': 348680}, '1': {'precision': 0.7460703277300258, 'recall': 0.5969347462624125, 'f1-score': 0.6632220687796827, 'support': 659717}, '2': {'precision': 0.493793962985727, 'recall': 0.5040973249014521, 'f1-score': 0.49889245214401423, 'support': 344249}, 'accuracy': 0.5767392207569461, 'macro avg': {'precision': 0.5631219481551163, 'recall': 0.5704264297478264, 'f1-score': 0.5599325767865359, 'support': 1352646}, 'weighted avg': {'precision': 0.6054174988314401, 'recall': 0.5767392207569461, 'f1-score': 0.5838836493608557, 'support': 1352646}}
[[212781  54680  81219]
 [169231 393808  96678]
 [ 91359  79355 173535]]
Evaluating performance on  val set...
1714/1714 - 86s - 86s/epoch - 50ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8614959
{'0': {'precision': 0.4493877354797503, 'recall': 0.6084676256985838, 'f1-score': 0.5169664936439841, 'support': 107539}, '1': {'precision': 0.7590404260058766, 'recall': 0.6424736251402918, 'f1-score': 0.6959094755064529, 'support': 222750}, '2': {'precision': 0.5085527265726525, 'recall': 0.4903336581743932, 'f1-score': 0.49927704011718566, 'support': 107745}, 'accuracy': 0.5967025390723094, 'macro avg': {'precision': 0.5723269626860931, 'recall': 0.5804249696710896, 'f1-score': 0.5707176697558741, 'support': 438034}, 'weighted avg': {'precision': 0.6214060463414628, 'recall': 0.5967025390723094, 'f1-score': 0.6036118203529155, 'support': 438034}}
[[ 65434  18501  23604]
 [ 52189 143111  27450]
 [ 27984  26930  52831]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
696/696 - 16s - 16s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2240667
{'0': {'precision': 0.36831324267513194, 'recall': 0.6276133040935673, 'f1-score': 0.46420750993484905, 'support': 54720}, '1': {'precision': 0.611764705882353, 'recall': 0.0007636951094140108, 'f1-score': 0.0015254858819215254, 'support': 68090}, '2': {'precision': 0.426455464270938, 'recall': 0.6545705265449795, 'f1-score': 0.5164448961770537, 'support': 55114}, 'accuracy': 0.39607360446033135, 'macro avg': {'precision': 0.4688444709428076, 'recall': 0.4276491752493203, 'f1-score': 0.32739263066460805, 'support': 177924}, 'weighted avg': {'precision': 0.47949026506003184, 'recall': 0.39607360446033135, 'f1-score': 0.30332416810119556, 'support': 177924}}
[[34343    17 20360]
 [39879    52 28159]
 [19022    16 36076]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.204746
{'0': {'precision': 0.4139049416204741, 'recall': 0.5793166061406405, 'f1-score': 0.48283689894751325, 'support': 24232}, '1': {'precision': 0.45, 'recall': 0.0003734284884444629, 'f1-score': 0.0007462377181708885, 'support': 24101}, '2': {'precision': 0.40864424592748294, 'recall': 0.6572708447787685, 'f1-score': 0.5039612462129192, 'support': 23663}, 'accuracy': 0.4111339518862159, 'macro avg': {'precision': 0.42418306251598564, 'recall': 0.41232029313595114, 'f1-score': 0.32918146095953443, 'support': 71996}, 'weighted avg': {'precision': 0.4242588940598, 'recall': 0.4111339518862159, 'f1-score': 0.3283977412589322, 'support': 71996}}
[[14038     6 10188]
 [11773     9 12319]
 [ 8105     5 15553]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1898756
{'0': {'precision': 0.41093603255765415, 'recall': 0.6350588614739558, 'f1-score': 0.4989863152559554, 'support': 6201}, '1': {'precision': 0.5454545454545454, 'recall': 0.0010150566739976314, 'f1-score': 0.002026342451874367, 'support': 5911}, '2': {'precision': 0.4204621943010994, 'recall': 0.5859912445278299, 'f1-score': 0.4896146309601568, 'support': 6396}, 'accuracy': 0.41560406310784526, 'macro avg': {'precision': 0.45895092410443294, 'recall': 0.4073550542252611, 'f1-score': 0.3302090962226622, 'support': 18508}, 'weighted avg': {'precision': 0.4571899908591778, 'recall': 0.41560406310784526, 'f1-score': 0.3370308531854534, 'support': 18508}}
[[3938    3 2260]
 [2999    6 2906]
 [2646    2 3748]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
2006/2006 - 45s - 45s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6670377
{'0': {'precision': 0.3643538448552376, 'recall': 0.6439653886319558, 'f1-score': 0.4653908355795148, 'support': 67030}, '1': {'precision': 0.859087433233483, 'recall': 0.7854829806807728, 'f1-score': 0.8206380851951932, 'support': 380450}, '2': {'precision': 0.5824150108496787, 'recall': 0.41574791192103266, 'f1-score': 0.48516693839937625, 'support': 65850}, 'accuracy': 0.7195741530789161, 'macro avg': {'precision': 0.6019520963127998, 'recall': 0.6150654270779204, 'f1-score': 0.5903986197246948, 'support': 513330}, 'weighted avg': {'precision': 0.7589941765701919, 'recall': 0.7195741530789161, 'f1-score': 0.7312160795492276, 'support': 513330}}
[[ 43165  18829   5036]
 [ 67020 298837  14593]
 [  8285  30188  27377]]
Evaluating performance on  train set...
538/538 - 12s - 12s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63621753
{'0': {'precision': 0.427057723605388, 'recall': 0.6325913007796471, 'f1-score': 0.509891472868217, 'support': 19496}, '1': {'precision': 0.8617871451709147, 'recall': 0.8153169954736534, 'f1-score': 0.8379082597321867, 'support': 99197}, '2': {'precision': 0.5651586765698852, 'recall': 0.4441732116323498, 'f1-score': 0.4974148689605991, 'support': 18844}, 'accuracy': 0.738564895264547, 'macro avg': {'precision': 0.6180011817820626, 'recall': 0.6306938359618834, 'f1-score': 0.6150715338536675, 'support': 137537}, 'weighted avg': {'precision': 0.7595226515062332, 'recall': 0.738564895264547, 'f1-score': 0.7447604323664615, 'support': 137537}}
[[12333  5224  1939]
 [13819 80877  4501]
 [ 2727  7747  8370]]
Evaluating performance on  val set...
153/153 - 4s - 4s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68201405
{'0': {'precision': 0.4100167996640067, 'recall': 0.6636641740312712, 'f1-score': 0.5068795430944963, 'support': 5884}, '1': {'precision': 0.8496016737748451, 'recall': 0.7750697401262663, 'f1-score': 0.8106261276824446, 'support': 27244}, '2': {'precision': 0.5537243150684932, 'recall': 0.43684566024991556, 'f1-score': 0.48838965452142724, 'support': 5922}, 'accuracy': 0.7069910371318822, 'macro avg': {'precision': 0.604447596169115, 'recall': 0.625193191469151, 'f1-score': 0.6019651084327894, 'support': 39050}, 'weighted avg': {'precision': 0.7384953199329196, 'recall': 0.7069910371318822, 'f1-score': 0.715990294192687, 'support': 39050}}
[[ 3905  1342   637]
 [ 4680 21116  1448]
 [  939  2396  2587]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
930/930 - 21s - 21s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1475995
{'0': {'precision': 0.38386211127153574, 'recall': 0.6985691530638639, 'f1-score': 0.4954665276208684, 'support': 73453}, '1': {'precision': 0.7065666615643655, 'recall': 0.05209991083420806, 'f1-score': 0.09704410713534878, 'support': 88599}, '2': {'precision': 0.4500455294201905, 'recall': 0.5795923207673962, 'f1-score': 0.5066692775525249, 'support': 75893}, 'accuracy': 0.419907961923974, 'macro avg': {'precision': 0.5134914340853639, 'recall': 0.443420461555156, 'f1-score': 0.3663933041029141, 'support': 237945}, 'weighted avg': {'precision': 0.5251307179031114, 'recall': 0.419907961923974, 'f1-score': 0.3506867771237646, 'support': 237945}}
[[51312   887 21254]
 [51485  4616 32498]
 [30876  1030 43987]]
Evaluating performance on  train set...
381/381 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0778196
{'0': {'precision': 0.43633043335522, 'recall': 0.6519206597381894, 'f1-score': 0.5227705734128204, 'support': 32619}, '1': {'precision': 0.6777003484320557, 'recall': 0.14333087693441415, 'f1-score': 0.23661800486618007, 'support': 32568}, '2': {'precision': 0.4611547366159868, 'recall': 0.5975443805282366, 'f1-score': 0.5205641847745551, 'support': 32334}, 'accuracy': 0.46404364188226127, 'macro avg': {'precision': 0.5250618394677541, 'recall': 0.4642653057336134, 'f1-score': 0.4266509210178519, 'support': 97521}, 'weighted avg': {'precision': 0.5251687801303353, 'recall': 0.46404364188226127, 'f1-score': 0.4264758448655675, 'support': 97521}}
[[21265   961 10393]
 [15717  4668 12183]
 [11754  1259 19321]]
Evaluating performance on  val set...
114/114 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0926877
{'0': {'precision': 0.43260784056640883, 'recall': 0.6669698807357994, 'f1-score': 0.5248131064100525, 'support': 9894}, '1': {'precision': 0.6123348017621145, 'recall': 0.10430960548885077, 'f1-score': 0.1782540991114775, 'support': 9328}, '2': {'precision': 0.4626450874611738, 'recall': 0.5743277524099442, 'f1-score': 0.5124722712662411, 'support': 9855}, 'accuracy': 0.4550675791862985, 'macro avg': {'precision': 0.5025292432632323, 'recall': 0.4485357462115314, 'f1-score': 0.40517982559592375, 'support': 29077}, 'weighted avg': {'precision': 0.5004453121825126, 'recall': 0.4550675791862985, 'f1-score': 0.40945315351176964, 'support': 29077}}
[[6599  272 3023]
 [4804  973 3551]
 [3851  344 5660]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1065/1065 - 24s - 24s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3652792
{'0': {'precision': 0.327103007686978, 'recall': 0.6898428331454081, 'f1-score': 0.44377912076118287, 'support': 86914}, '1': {'precision': 0.4857142857142857, 'recall': 0.00017548205954003056, 'f1-score': 0.0003508373662432541, 'support': 96876}, '2': {'precision': 0.3547120271983663, 'recall': 0.3565442959454125, 'f1-score': 0.3556258015164129, 'support': 88665}, 'accuracy': 0.33615459433667944, 'macro avg': {'precision': 0.3891764401998767, 'recall': 0.3488542037167868, 'f1-score': 0.26658525321461296, 'support': 272455}, 'weighted avg': {'precision': 0.3924847400286517, 'recall': 0.33615459433667944, 'f1-score': 0.2574229429226198, 'support': 272455}}
[[59957     6 26951]
 [66300    17 30559]
 [57040    12 31613]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3211343
{'0': {'precision': 0.3559200304869111, 'recall': 0.683758517767641, 'f1-score': 0.4681511470985155, 'support': 35514}, '1': {'precision': 0.2, 'recall': 2.9468969175458244e-05, 'f1-score': 5.8929255428857655e-05, 'support': 33934}, '2': {'precision': 0.34972820557541934, 'recall': 0.3625542430086789, 'f1-score': 0.35602574535769776, 'support': 33184}, 'accuracy': 0.35383700989944655, 'macro avg': {'precision': 0.3018827453541102, 'recall': 0.3487807432484984, 'f1-score': 0.2747452739038807, 'support': 102632}, 'weighted avg': {'precision': 0.3023650005507724, 'recall': 0.35383700989944655, 'f1-score': 0.27712875007171495, 'support': 102632}}
[[24283     3 11228]
 [22791     1 11142]
 [21152     1 12031]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3346989
{'0': {'precision': 0.3303333817196497, 'recall': 0.6737392677390703, 'f1-score': 0.4433116883116884, 'support': 10133}, '1': {'precision': 0.2, 'recall': 9.507510933637573e-05, 'f1-score': 0.0001900598688586905, 'support': 10518}, '2': {'precision': 0.36950228779531236, 'recall': 0.3687791239515377, 'f1-score': 0.36914035169550813, 'support': 10730}, 'accuracy': 0.3436792963895351, 'macro avg': {'precision': 0.299945223171654, 'recall': 0.34753782226664814, 'f1-score': 0.2708806999586851, 'support': 31381}, 'weighted avg': {'precision': 0.30004230920011826, 'recall': 0.3436792963895351, 'f1-score': 0.2694290290639494, 'support': 31381}}
[[6827    2 3304]
 [7069    1 3448]
 [6771    2 3957]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
1646/1646 - 43s - 43s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.229303
{'0': {'precision': 0.38170905973135183, 'recall': 0.6265568925480262, 'f1-score': 0.4744034880520011, 'support': 127899}, '1': {'precision': 0.746998799519808, 'recall': 0.030559375306944307, 'f1-score': 0.05871667846190139, 'support': 162896}, '2': {'precision': 0.40408245025185535, 'recall': 0.6338263468465016, 'f1-score': 0.49352718463112866, 'support': 130490}, 'accuracy': 0.3983574065062843, 'macro avg': {'precision': 0.5109301031676717, 'recall': 0.4303142049004907, 'f1-score': 0.3422157837150104, 'support': 421285}, 'weighted avg': {'precision': 0.529883671173964, 'recall': 0.3983574065062843, 'f1-score': 0.3195955376897083, 'support': 421285}}
[[80136   719 47044]
 [82989  4978 74929]
 [46815   967 82708]]
Evaluating performance on  train set...
526/526 - 12s - 12s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1994613
{'0': {'precision': 0.4199987874010974, 'recall': 0.6063238512035011, 'f1-score': 0.4962480075935311, 'support': 45700}, '1': {'precision': 0.6630785791173305, 'recall': 0.014142063455622389, 'f1-score': 0.02769348348955875, 'support': 43558}, '2': {'precision': 0.417788085144098, 'recall': 0.6237704556481849, 'f1-score': 0.5004113624501277, 'support': 45342}, 'accuracy': 0.42056463595839527, 'macro avg': {'precision': 0.5002884838875087, 'recall': 0.41474545676910274, 'f1-score': 0.3414509511777392, 'support': 134600}, 'weighted avg': {'precision': 0.4979173008174334, 'recall': 0.42056463595839527, 'f1-score': 0.3460212384626765, 'support': 134600}}
[[27709   146 17845]
 [21373   616 21569]
 [16892   167 28283]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1846246
{'0': {'precision': 0.4190111991259219, 'recall': 0.612668743509865, 'f1-score': 0.49766415779911766, 'support': 12519}, '1': {'precision': 0.6608187134502924, 'recall': 0.009534255821802227, 'f1-score': 0.018797305165100225, 'support': 11852}, '2': {'precision': 0.4358009644427958, 'recall': 0.6337854500616523, 'f1-score': 0.5164693691713504, 'support': 12976}, 'accuracy': 0.4286020296141591, 'macro avg': {'precision': 0.5052102923396701, 'recall': 0.41866281646443987, 'f1-score': 0.34431027737852277, 'support': 37347}, 'weighted avg': {'precision': 0.5015818648962433, 'recall': 0.4286020296141591, 'f1-score': 0.3522304277899527, 'support': 37347}}
[[7670   21 4828]
 [5920  113 5819]
 [4715   37 8224]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
5929/5929 - 122s - 122s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6523703
{'0': {'precision': 0.4287388078485898, 'recall': 0.6127232238448033, 'f1-score': 0.5044796959236706, 'support': 233510}, '1': {'precision': 0.835386531390926, 'recall': 0.8013213097820866, 'f1-score': 0.817999416473412, 'support': 1051381}, '2': {'precision': 0.5638982828530531, 'recall': 0.42495336983522575, 'f1-score': 0.48466415541956365, 'support': 232682}, 'accuracy': 0.7145949486449745, 'macro avg': {'precision': 0.6093412073641896, 'recall': 0.6129993011540386, 'f1-score': 0.6023810892722155, 'support': 1517573}, 'weighted avg': {'precision': 0.7311894096902499, 'recall': 0.7145949486449745, 'f1-score': 0.7186492664917625, 'support': 1517573}}
[[143077  61939  28494]
 [160911 842494  47976]
 [ 29728 104075  98879]]
Evaluating performance on  train set...
1254/1254 - 32s - 32s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6898971
{'0': {'precision': 0.4426436882381674, 'recall': 0.6495139029276092, 'f1-score': 0.5264867119532833, 'support': 54413}, '1': {'precision': 0.8140804138537131, 'recall': 0.7697257842155956, 'f1-score': 0.7912820214139414, 'support': 211804}, '2': {'precision': 0.5828540662245173, 'recall': 0.4349874888129897, 'f1-score': 0.49818014475170475, 'support': 54751}, 'accuracy': 0.6922465790982278, 'macro avg': {'precision': 0.6131927227721325, 'recall': 0.6180757253187315, 'f1-score': 0.6053162927063098, 'support': 320968}, 'weighted avg': {'precision': 0.7116687706058978, 'recall': 0.6922465790982278, 'f1-score': 0.6963942817551065, 'support': 320968}}
[[ 35342  13606   5465]
 [ 37193 163031  11580]
 [  7308  23627  23816]]
Evaluating performance on  val set...
427/427 - 10s - 10s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6740062
{'0': {'precision': 0.4321904761904762, 'recall': 0.6438706015891033, 'f1-score': 0.5172099384545247, 'support': 17620}, '1': {'precision': 0.8157231814322106, 'recall': 0.780677754903023, 'f1-score': 0.79781579603023, 'support': 73832}, '2': {'precision': 0.5914966262905454, 'recall': 0.40970775381496705, 'f1-score': 0.48409846972721227, 'support': 17759}, 'accuracy': 0.6982813086593841, 'macro avg': {'precision': 0.6131367613044107, 'recall': 0.6114187034356977, 'f1-score': 0.5997080680706556, 'support': 109211}, 'weighted avg': {'precision': 0.7173824862721975, 'recall': 0.6982813086593841, 'f1-score': 0.7015289640417013, 'support': 109211}}
[[11345  4681  1594]
 [12762 57639  3431]
 [ 2143  8340  7276]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
5331/5331 - 108s - 108s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6549053
{'0': {'precision': 0.4360901178408969, 'recall': 0.6148407752673946, 'f1-score': 0.510263782134565, 'support': 198022}, '1': {'precision': 0.833450259136157, 'recall': 0.8252055117841249, 'f1-score': 0.8293073942105126, 'support': 966003}, '2': {'precision': 0.587947491257589, 'recall': 0.3780368030870322, 'f1-score': 0.46018510089516, 'support': 200581}, 'accuracy': 0.7289503343822319, 'macro avg': {'precision': 0.619162622744881, 'recall': 0.6060276967128506, 'f1-score': 0.5999187590800792, 'support': 1364606}, 'weighted avg': {'precision': 0.7397021438681448, 'recall': 0.7289503343822319, 'f1-score': 0.7287534080298933, 'support': 1364606}}
[[121752  59057  17213]
 [132923 797151  35929]
 [ 24515 100239  75827]]
Evaluating performance on  train set...
2013/2013 - 44s - 44s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7090932
{'0': {'precision': 0.4371602687464128, 'recall': 0.5856286748077792, 'f1-score': 0.5006186085174661, 'support': 88440}, '1': {'precision': 0.8037654890922727, 'recall': 0.7905979514761422, 'f1-score': 0.7971273462178997, 'support': 340245}, '2': {'precision': 0.5549264055336605, 'recall': 0.3982245720156533, 'f1-score': 0.4636942846389591, 'support': 86627}, 'accuracy': 0.6894599776446114, 'macro avg': {'precision': 0.598617387790782, 'recall': 0.591483732766525, 'f1-score': 0.5871467464581083, 'support': 515312}, 'weighted avg': {'precision': 0.6990158442580369, 'recall': 0.6894599776446114, 'f1-score': 0.6901872039591802, 'support': 515312}}
[[ 51793  26632  10015]
 [ 53595 268997  17653]
 [ 13088  39042  34497]]
Evaluating performance on  val set...
696/696 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6623347
{'0': {'precision': 0.4599851691289715, 'recall': 0.5655375552282769, 'f1-score': 0.5073293488518402, 'support': 28518}, '1': {'precision': 0.8101255781114892, 'recall': 0.8407386368314028, 'f1-score': 0.8251482684507361, 'support': 121467}, '2': {'precision': 0.6138013087447948, 'recall': 0.3692384769539078, 'f1-score': 0.4610984493006212, 'support': 27944}, 'accuracy': 0.7225803550854555, 'macro avg': {'precision': 0.6279706853284185, 'recall': 0.5918382230045293, 'f1-score': 0.5978586888677325, 'support': 177929}, 'weighted avg': {'precision': 0.7231729758569587, 'recall': 0.7225803550854555, 'f1-score': 0.7170345371565, 'support': 177929}}
[[ 16128   9859   2531]
 [ 15384 102122   3961]
 [  3550  14076  10318]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
4192/4192 - 85s - 85s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9231644
{'0': {'precision': 0.44070517562808864, 'recall': 0.6219349225682965, 'f1-score': 0.5158659827441381, 'support': 287350}, '1': {'precision': 0.6780973040435632, 'recall': 0.5418957267189893, 'f1-score': 0.60239365651326, 'support': 505326}, '2': {'precision': 0.5033225047098826, 'recall': 0.4734128653636344, 'f1-score': 0.48790973780087854, 'support': 280474}, 'accuracy': 0.5454288776033174, 'macro avg': {'precision': 0.5407083281271782, 'recall': 0.5457478382169735, 'f1-score': 0.535389792352759, 'support': 1073150}, 'weighted avg': {'precision': 0.5688540340733806, 'recall': 0.5454288776033174, 'f1-score': 0.5493036973514526, 'support': 1073150}}
[[178713  52504  56133]
 [156598 273834  74894]
 [ 70205  77489 132780]]
Evaluating performance on  train set...
1230/1230 - 27s - 27s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9573824
{'0': {'precision': 0.4759989907591384, 'recall': 0.6225251608645438, 'f1-score': 0.5394899108148201, 'support': 96976}, '1': {'precision': 0.6236130489668461, 'recall': 0.4613229571984436, 'f1-score': 0.5303299259349942, 'support': 122075}, '2': {'precision': 0.5031156313629992, 'recall': 0.5131815145695917, 'f1-score': 0.5080987243540396, 'support': 95816}, 'accuracy': 0.52675256536887, 'macro avg': {'precision': 0.5342425570296613, 'recall': 0.5323432108775263, 'f1-score': 0.5259728537012845, 'support': 314867}, 'weighted avg': {'precision': 0.5414812235488733, 'recall': 0.52675256536887, 'f1-score': 0.5263860190886916, 'support': 314867}}
[[60370 13972 22634]
 [39831 56316 25928]
 [26627 20018 49171]]
Evaluating performance on  val set...
400/400 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9637642
{'0': {'precision': 0.4651758733228575, 'recall': 0.6157242968225016, 'f1-score': 0.5299658477470529, 'support': 31251}, '1': {'precision': 0.6296544783629654, 'recall': 0.4303729746254968, 'f1-score': 0.5112816089344895, 'support': 39252}, '2': {'precision': 0.49320137440897477, 'recall': 0.5290781929305022, 'f1-score': 0.5105102366513155, 'support': 31742}, 'accuracy': 0.5176683456403736, 'macro avg': {'precision': 0.5293439086982659, 'recall': 0.5250584881261668, 'f1-score': 0.5172525644442859, 'support': 102245}, 'weighted avg': {'precision': 0.5370199699584861, 'recall': 0.5176683456403736, 'f1-score': 0.5167529400325277, 'support': 102245}}
[[19242  3943  8066]
 [13168 16893  9191]
 [ 8955  5993 16794]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
6143/6143 - 138s - 138s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8678627
{'0': {'precision': 0.45857516615042254, 'recall': 0.6422110851539797, 'f1-score': 0.5350758237199136, 'support': 403657}, '1': {'precision': 0.7053460971345358, 'recall': 0.6004080152325687, 'f1-score': 0.6486603353901936, 'support': 772030}, '2': {'precision': 0.5509184927006257, 'recall': 0.48596449226969746, 'f1-score': 0.5164070188593349, 'support': 396815}, 'accuracy': 0.5822593548370686, 'macro avg': {'precision': 0.5716132519951946, 'recall': 0.5761945308854153, 'f1-score': 0.5667143926564807, 'support': 1572502}, 'weighted avg': {'precision': 0.6030314396385859, 'recall': 0.5822593548370686, 'f1-score': 0.586129869275376, 'support': 1572502}}
[[259233  76999  67425]
 [218730 463533  89767]
 [ 87338 116639 192838]]
Evaluating performance on  train set...
2083/2083 - 45s - 45s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9242124
{'0': {'precision': 0.47423526099661195, 'recall': 0.6195803131480319, 'f1-score': 0.5372511389662558, 'support': 157689}, '1': {'precision': 0.6455950490879047, 'recall': 0.5452803940796825, 'f1-score': 0.5912126659462988, 'support': 219245}, '2': {'precision': 0.5343435125791256, 'recall': 0.48558064536769835, 'f1-score': 0.5087963956232568, 'support': 156283}, 'accuracy': 0.5497555404272557, 'macro avg': {'precision': 0.551391274221214, 'recall': 0.5501471175318042, 'f1-score': 0.5457534001786039, 'support': 533217}, 'weighted avg': {'precision': 0.5623113625127779, 'recall': 0.5497555404272557, 'f1-score': 0.5510987888515101, 'support': 533217}}
[[ 97701  26931  33057]
 [ 66619 119550  33076]
 [ 41698  38697  75888]]
Evaluating performance on  val set...
685/685 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9223993
{'0': {'precision': 0.4624747053922152, 'recall': 0.6166207074414268, 'f1-score': 0.5285380266122518, 'support': 50407}, '1': {'precision': 0.6587847851144409, 'recall': 0.5392495147724822, 'f1-score': 0.5930537643972073, 'support': 74192}, '2': {'precision': 0.526156451783635, 'recall': 0.4914185154427176, 'f1-score': 0.5081945424245212, 'support': 50574}, 'accuracy': 0.5477042694935863, 'macro avg': {'precision': 0.5491386474300971, 'recall': 0.5490962458855422, 'f1-score': 0.54326211114466, 'support': 175173}, 'weighted avg': {'precision': 0.564004496380273, 'recall': 0.5477042694935863, 'f1-score': 0.5499893932522656, 'support': 175173}}
[[31082  8269 11056]
 [22858 40008 11326]
 [13268 12453 24853]]
testing model on single stock: results/universal/W7/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
23942/23942 - 497s - 497s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1260824
{'0': {'precision': 0.40428939252837576, 'recall': 0.6610681253574373, 'f1-score': 0.5017335989725022, 'support': 1876203}, '1': {'precision': 0.5142885001950136, 'recall': 0.057352254187746726, 'f1-score': 0.10319629789470794, 'support': 2391083}, '2': {'precision': 0.4136680826274105, 'recall': 0.6209247289419039, 'f1-score': 0.49653687751363884, 'support': 1861778}, 'accuracy': 0.41335120664427716, 'macro avg': {'precision': 0.4440819917836, 'recall': 0.446448369495696, 'f1-score': 0.36715559146028304, 'support': 6129064}, 'weighted avg': {'precision': 0.4500513612812013, 'recall': 0.41335120664427716, 'f1-score': 0.3446768432986775, 'support': 6129064}}
[[1240298   57283  578622]
 [1194026  137134 1059923]
 [ 633523   72231 1156024]]
Evaluating performance on  train set...
9052/9052 - 211s - 211s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0885653
{'0': {'precision': 0.4222171611857373, 'recall': 0.6261636874299283, 'f1-score': 0.5043530791188228, 'support': 778667}, '1': {'precision': 0.5664290799152774, 'recall': 0.08451705290544581, 'f1-score': 0.1470871831035738, 'support': 762568}, '2': {'precision': 0.44112903610378584, 'recall': 0.5961577376924515, 'f1-score': 0.5070584043631978, 'support': 775845}, 'accuracy': 0.4378566989486768, 'macro avg': {'precision': 0.47659175906826684, 'recall': 0.43561282600927526, 'f1-score': 0.3861662221951982, 'support': 2317080}, 'weighted avg': {'precision': 0.4760107626313245, 'recall': 0.4378566989486768, 'f1-score': 0.3876800998827436, 'support': 2317080}}
[[487573  21561 269533]
 [381672  64450 316446]
 [285547  27772 462526]]
Evaluating performance on  val set...
2763/2763 - 62s - 62s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1021149
{'0': {'precision': 0.41316109086894115, 'recall': 0.6301458587010026, 'f1-score': 0.499089458753764, 'support': 231594}, '1': {'precision': 0.5916865437198208, 'recall': 0.08381957836786497, 'f1-score': 0.14683780057317344, 'support': 242676}, '2': {'precision': 0.43241459554476813, 'recall': 0.5932287755583685, 'f1-score': 0.5002143791417235, 'support': 233045}, 'accuracy': 0.4305408481369687, 'macro avg': {'precision': 0.47908741004451, 'recall': 0.4357314042090787, 'f1-score': 0.38204721282288695, 'support': 707315}, 'weighted avg': {'precision': 0.480755834078428, 'recall': 0.4305408481369687, 'f1-score': 0.37860443252242304, 'support': 707315}}
[[145938   5968  79688]
 [120558  20341 101777]
 [ 86727   8069 138249]]
training model: results/universal/W7/deepVOL_L3/h30
Epoch 1/50
12475/12475 - 1247s - loss: 3.1425 - accuracy30: 0.4204 - val_loss: 3.1613 - val_accuracy30: 0.4320 - 1247s/epoch - 100ms/step
Epoch 2/50
12475/12475 - 1163s - loss: 3.0518 - accuracy30: 0.4583 - val_loss: 3.2318 - val_accuracy30: 0.4306 - 1163s/epoch - 93ms/step
Epoch 3/50
12475/12475 - 1160s - loss: 3.0252 - accuracy30: 0.4674 - val_loss: 3.2739 - val_accuracy30: 0.4398 - 1160s/epoch - 93ms/step
Epoch 4/50
12475/12475 - 1129s - loss: 3.0099 - accuracy30: 0.4717 - val_loss: 3.2442 - val_accuracy30: 0.4417 - 1129s/epoch - 90ms/step
Epoch 5/50
12475/12475 - 1228s - loss: 2.9991 - accuracy30: 0.4751 - val_loss: 3.2516 - val_accuracy30: 0.4465 - 1228s/epoch - 98ms/step
Epoch 6/50
12475/12475 - 1265s - loss: 2.9910 - accuracy30: 0.4776 - val_loss: 3.1757 - val_accuracy30: 0.4532 - 1265s/epoch - 101ms/step
Epoch 7/50
12475/12475 - 1233s - loss: 2.9842 - accuracy30: 0.4799 - val_loss: 3.1899 - val_accuracy30: 0.4536 - 1233s/epoch - 99ms/step
Epoch 8/50
12475/12475 - 1212s - loss: 2.9796 - accuracy30: 0.4815 - val_loss: 3.1559 - val_accuracy30: 0.4565 - 1212s/epoch - 97ms/step
Epoch 9/50
12475/12475 - 1252s - loss: 2.9744 - accuracy30: 0.4831 - val_loss: 3.1392 - val_accuracy30: 0.4564 - 1252s/epoch - 100ms/step
Epoch 10/50
12475/12475 - 1254s - loss: 2.9705 - accuracy30: 0.4838 - val_loss: 3.1652 - val_accuracy30: 0.4543 - 1254s/epoch - 101ms/step
Epoch 11/50
12475/12475 - 1239s - loss: 2.9675 - accuracy30: 0.4847 - val_loss: 3.1912 - val_accuracy30: 0.4524 - 1239s/epoch - 99ms/step
Epoch 12/50
12475/12475 - 1276s - loss: 2.9644 - accuracy30: 0.4857 - val_loss: 3.1697 - val_accuracy30: 0.4549 - 1276s/epoch - 102ms/step
Epoch 13/50
12475/12475 - 1276s - loss: 2.9616 - accuracy30: 0.4867 - val_loss: 3.1687 - val_accuracy30: 0.4532 - 1276s/epoch - 102ms/step
Epoch 14/50
12475/12475 - 1276s - loss: 2.9590 - accuracy30: 0.4877 - val_loss: 3.1600 - val_accuracy30: 0.4546 - 1276s/epoch - 102ms/step
Epoch 15/50
12475/12475 - 1235s - loss: 2.9569 - accuracy30: 0.4882 - val_loss: 3.1536 - val_accuracy30: 0.4543 - 1235s/epoch - 99ms/step
Epoch 16/50
12475/12475 - 1225s - loss: 2.9546 - accuracy30: 0.4889 - val_loss: 3.1699 - val_accuracy30: 0.4531 - 1225s/epoch - 98ms/step
Epoch 17/50
12475/12475 - 1263s - loss: 2.9526 - accuracy30: 0.4898 - val_loss: 3.1515 - val_accuracy30: 0.4545 - 1263s/epoch - 101ms/step
Epoch 18/50
12475/12475 - 1246s - loss: 2.9509 - accuracy30: 0.4904 - val_loss: 3.1292 - val_accuracy30: 0.4567 - 1246s/epoch - 100ms/step
Epoch 19/50
12475/12475 - 1309s - loss: 2.9489 - accuracy30: 0.4907 - val_loss: 3.1486 - val_accuracy30: 0.4536 - 1309s/epoch - 105ms/step
Epoch 20/50
12475/12475 - 1226s - loss: 2.9476 - accuracy30: 0.4915 - val_loss: 3.1310 - val_accuracy30: 0.4550 - 1226s/epoch - 98ms/step
Epoch 21/50
12475/12475 - 1201s - loss: 2.9458 - accuracy30: 0.4919 - val_loss: 3.1378 - val_accuracy30: 0.4540 - 1201s/epoch - 96ms/step
Epoch 22/50
12475/12475 - 1177s - loss: 2.9444 - accuracy30: 0.4925 - val_loss: 3.1259 - val_accuracy30: 0.4553 - 1177s/epoch - 94ms/step
Epoch 23/50
12475/12475 - 1161s - loss: 2.9430 - accuracy30: 0.4928 - val_loss: 3.1288 - val_accuracy30: 0.4545 - 1161s/epoch - 93ms/step
Epoch 24/50
12475/12475 - 1123s - loss: 2.9414 - accuracy30: 0.4933 - val_loss: 3.1364 - val_accuracy30: 0.4567 - 1123s/epoch - 90ms/step
Epoch 25/50
12475/12475 - 1115s - loss: 2.9401 - accuracy30: 0.4938 - val_loss: 3.1187 - val_accuracy30: 0.4562 - 1115s/epoch - 89ms/step
Epoch 26/50
12475/12475 - 1100s - loss: 2.9394 - accuracy30: 0.4938 - val_loss: 3.1302 - val_accuracy30: 0.4568 - 1100s/epoch - 88ms/step
Epoch 27/50
12475/12475 - 1100s - loss: 2.9379 - accuracy30: 0.4944 - val_loss: 3.1243 - val_accuracy30: 0.4580 - 1100s/epoch - 88ms/step
Epoch 28/50
12475/12475 - 1197s - loss: 2.9367 - accuracy30: 0.4948 - val_loss: 3.1240 - val_accuracy30: 0.4576 - 1197s/epoch - 96ms/step
Epoch 29/50
12475/12475 - 1124s - loss: 2.9354 - accuracy30: 0.4950 - val_loss: 3.1165 - val_accuracy30: 0.4569 - 1124s/epoch - 90ms/step
Epoch 30/50
12475/12475 - 1140s - loss: 2.9344 - accuracy30: 0.4952 - val_loss: 3.1193 - val_accuracy30: 0.4576 - 1140s/epoch - 91ms/step
Epoch 31/50
12475/12475 - 1175s - loss: 2.9334 - accuracy30: 0.4958 - val_loss: 3.1109 - val_accuracy30: 0.4575 - 1175s/epoch - 94ms/step
Epoch 32/50
12475/12475 - 1158s - loss: 2.9321 - accuracy30: 0.4961 - val_loss: 3.1209 - val_accuracy30: 0.4567 - 1158s/epoch - 93ms/step
Epoch 33/50
12475/12475 - 1172s - loss: 2.9311 - accuracy30: 0.4964 - val_loss: 3.1186 - val_accuracy30: 0.4556 - 1172s/epoch - 94ms/step
Epoch 34/50
12475/12475 - 1164s - loss: 2.9301 - accuracy30: 0.4966 - val_loss: 3.1266 - val_accuracy30: 0.4560 - 1164s/epoch - 93ms/step
Epoch 35/50
12475/12475 - 1166s - loss: 2.9289 - accuracy30: 0.4970 - val_loss: 3.1267 - val_accuracy30: 0.4560 - 1166s/epoch - 94ms/step
Epoch 36/50
12475/12475 - 1078s - loss: 2.9280 - accuracy30: 0.4973 - val_loss: 3.1219 - val_accuracy30: 0.4564 - 1078s/epoch - 86ms/step
Epoch 37/50
12475/12475 - 1091s - loss: 2.9273 - accuracy30: 0.4974 - val_loss: 3.1060 - val_accuracy30: 0.4587 - 1091s/epoch - 87ms/step
Epoch 38/50
12475/12475 - 1109s - loss: 2.9262 - accuracy30: 0.4977 - val_loss: 3.1082 - val_accuracy30: 0.4569 - 1109s/epoch - 89ms/step
Epoch 39/50
12475/12475 - 1123s - loss: 2.9253 - accuracy30: 0.4980 - val_loss: 3.1122 - val_accuracy30: 0.4570 - 1123s/epoch - 90ms/step
Epoch 40/50
12475/12475 - 1134s - loss: 2.9242 - accuracy30: 0.4984 - val_loss: 3.1213 - val_accuracy30: 0.4566 - 1134s/epoch - 91ms/step
Epoch 41/50
12475/12475 - 1111s - loss: 2.9235 - accuracy30: 0.4985 - val_loss: 3.1143 - val_accuracy30: 0.4565 - 1111s/epoch - 89ms/step
Epoch 42/50
12475/12475 - 1142s - loss: 2.9229 - accuracy30: 0.4988 - val_loss: 3.1122 - val_accuracy30: 0.4563 - 1142s/epoch - 92ms/step
Epoch 43/50
12475/12475 - 1127s - loss: 2.9217 - accuracy30: 0.4991 - val_loss: 3.1212 - val_accuracy30: 0.4554 - 1127s/epoch - 90ms/step
Epoch 44/50
12475/12475 - 1126s - loss: 2.9207 - accuracy30: 0.4994 - val_loss: 3.1108 - val_accuracy30: 0.4568 - 1126s/epoch - 90ms/step
Epoch 45/50
12475/12475 - 1120s - loss: 2.9198 - accuracy30: 0.4996 - val_loss: 3.1109 - val_accuracy30: 0.4561 - 1120s/epoch - 90ms/step
Epoch 46/50
12475/12475 - 1122s - loss: 2.9194 - accuracy30: 0.4998 - val_loss: 3.1178 - val_accuracy30: 0.4556 - 1122s/epoch - 90ms/step
Epoch 47/50
12475/12475 - 1123s - loss: 2.9187 - accuracy30: 0.5001 - val_loss: 3.1121 - val_accuracy30: 0.4567 - 1123s/epoch - 90ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 2020s - 2020s/epoch - 54ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0325813
{'0': {'precision': 0.4162761367371293, 'recall': 0.5614435096806439, 'f1-score': 0.47808292706870364, 'support': 2688974}, '1': {'precision': 0.6766675954041661, 'recall': 0.34535457935721564, 'f1-score': 0.4573095546190582, 'support': 4149043}, '2': {'precision': 0.4135151460689452, 'recall': 0.5830646415912699, 'f1-score': 0.48386704892204074, 'support': 2667555}, 'accuracy': 0.4731914081551326, 'macro avg': {'precision': 0.5021529594034135, 'recall': 0.49662091020970983, 'f1-score': 0.47308651020326753, 'support': 9505572}, 'weighted avg': {'precision': 0.5291583772146504, 'recall': 0.4731914081551326, 'f1-score': 0.4706388561197785, 'support': 9505572}}
[[1509707  301328  877939]
 [1388142 1432891 1328010]
 [ 728847  383351 1555357]]
Evaluating performance on  train set...
12475/12475 - 676s - 676s/epoch - 54ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0542256
{'0': {'precision': 0.42366164896703074, 'recall': 0.5361051288624573, 'f1-score': 0.47329661363607345, 'support': 1002503}, '1': {'precision': 0.6222943045613935, 'recall': 0.29079541960239047, 'f1-score': 0.39636922554754045, 'support': 1196752}, '2': {'precision': 0.4195826323125592, 'recall': 0.576400970388266, 'f1-score': 0.48564622101648935, 'support': 993829}, 'accuracy': 0.4567061185988217, 'macro avg': {'precision': 0.48851286194699445, 'recall': 0.4677671729510379, 'f1-score': 0.45177068673336773, 'support': 3193084}, 'weighted avg': {'precision': 0.4968386098002465, 'recall': 0.4567061185988217, 'f1-score': 0.4483083553890444, 'support': 3193084}}
[[537447  96796 368260]
 [424575 348010 424167]
 [306554 114431 572844]]
Evaluating performance on  val set...
3866/3866 - 207s - 207s/epoch - 54ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0515013
{'0': {'precision': 0.41986016980473223, 'recall': 0.5377037300595073, 'f1-score': 0.47153068205564197, 'support': 306349}, '1': {'precision': 0.6323393947664699, 'recall': 0.298187658703877, 'f1-score': 0.40526667747795675, 'support': 372943}, '2': {'precision': 0.422374662413332, 'recall': 0.573782711109677, 'f1-score': 0.48657227330749353, 'support': 309910}, 'accuracy': 0.4587061085602334, 'macro avg': {'precision': 0.49152474232817805, 'recall': 0.46989136662435377, 'f1-score': 0.4544565442803641, 'support': 989202}, 'weighted avg': {'precision': 0.5007555844917593, 'recall': 0.4587061085602334, 'f1-score': 0.45126064912571023, 'support': 989202}}
[[164725  28781 112843]
 [131397 111207 130339]
 [ 96211  35878 177821]]
testing model out of sample: results/universal/W7/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 770s - 770s/epoch - 52ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9380862
{'0': {'precision': 0.43936489694748304, 'recall': 0.5498980283350373, 'f1-score': 0.4884563736825543, 'support': 939967}, '1': {'precision': 0.705142708602139, 'recall': 0.5917327656086777, 'f1-score': 0.6434789668049649, 'support': 1888709}, '2': {'precision': 0.4749210172972119, 'recall': 0.5087194607365169, 'f1-score': 0.49123957219579, 'support': 945586}, 'accuracy': 0.5605162015779509, 'macro avg': {'precision': 0.5398095409489446, 'recall': 0.5501167515600772, 'f1-score': 0.5410583042277698, 'support': 3774262}, 'weighted avg': {'precision': 0.5812729877184662, 'recall': 0.5605162015779509, 'f1-score': 0.566729773987825, 'support': 3774262}}
[[ 516886  202253  220828]
 [ 460084 1117611  311014]
 [ 199469  265079  481038]]
Evaluating performance on  train set...
5285/5285 - 300s - 300s/epoch - 57ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.944258
{'0': {'precision': 0.47449730857744665, 'recall': 0.5059857278411085, 'f1-score': 0.4897358896002677, 'support': 384665}, '1': {'precision': 0.6644227318940255, 'recall': 0.6044326717422277, 'f1-score': 0.6330095704429112, 'support': 588178}, '2': {'precision': 0.48150630121114824, 'recall': 0.5164703806973615, 'f1-score': 0.49837585827981984, 'support': 379803}, 'accuracy': 0.5517378530672474, 'macro avg': {'precision': 0.5401421138942067, 'recall': 0.542296260093566, 'f1-score': 0.5403737727743329, 'support': 1352646}, 'weighted avg': {'precision': 0.5590515763346843, 'recall': 0.5517378530672474, 'f1-score': 0.5544622947905868, 'support': 1352646}}
[[194635  82350 107680]
 [129119 355514 103545]
 [ 86438  97208 196157]]
Evaluating performance on  val set...
1714/1714 - 100s - 100s/epoch - 58ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91800755
{'0': {'precision': 0.4701854209162155, 'recall': 0.5131950082442646, 'f1-score': 0.4907496708459559, 'support': 119477}, '1': {'precision': 0.6825809309763582, 'recall': 0.6351383959541931, 'f1-score': 0.658005614320162, 'support': 198922}, '2': {'precision': 0.4915858714458264, 'recall': 0.5034897814184812, 'f1-score': 0.49746662427168026, 'support': 119635}, 'accuracy': 0.5659218234200998, 'macro avg': {'precision': 0.5481174077794667, 'recall': 0.5506077285389797, 'f1-score': 0.5487406364792661, 'support': 438034}, 'weighted avg': {'precision': 0.5724842893860003, 'recall': 0.5659218234200998, 'f1-score': 0.5685392248779776, 'support': 438034}}
[[ 61315  26385  31777]
 [ 42059 126343  30520]
 [ 27032  32368  60235]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2902743
{'0': {'precision': 0.361441141379996, 'recall': 0.5392331367968257, 'f1-score': 0.432789178410393, 'support': 53934}, '1': {'precision': 0.6005267778753293, 'recall': 0.01979023508137432, 'f1-score': 0.03831771774295197, 'support': 69125}, '2': {'precision': 0.39252169527851904, 'recall': 0.6809623621616695, 'f1-score': 0.4979906296027245, 'support': 54865}, 'accuracy': 0.381129021379915, 'macro avg': {'precision': 0.4514965381779481, 'recall': 0.41332857801328987, 'f1-score': 0.3230325085853565, 'support': 177924}, 'weighted avg': {'precision': 0.46391202339918614, 'recall': 0.381129021379915, 'f1-score': 0.29963928239316323, 'support': 177924}}
[[29083   573 24278]
 [34214  1368 33543]
 [17167   337 37361]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2492117
{'0': {'precision': 0.41491023993888676, 'recall': 0.4879134340547162, 'f1-score': 0.4484602826099195, 'support': 24490}, '1': {'precision': 0.5536105032822757, 'recall': 0.010681415181964029, 'f1-score': 0.020958455867125043, 'support': 23686}, '2': {'precision': 0.3867337388862892, 'recall': 0.6939126784214945, 'f1-score': 0.4966646634615385, 'support': 23820}, 'accuracy': 0.39906383687982666, 'macro avg': {'precision': 0.4517514940358172, 'recall': 0.39750250921939156, 'f1-score': 0.32202780064619435, 'support': 71996}, 'weighted avg': {'precision': 0.45121906518582594, 'recall': 0.39906383687982666, 'f1-score': 0.3237647451308336, 'support': 71996}}
[[11949   120 12421]
 [ 9643   253 13790]
 [ 7207    84 16529]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2217375
{'0': {'precision': 0.4179577894351592, 'recall': 0.5386792452830189, 'f1-score': 0.4707013807790067, 'support': 6360}, '1': {'precision': 0.7261904761904762, 'recall': 0.021681180024880044, 'f1-score': 0.042105263157894736, 'support': 5627}, '2': {'precision': 0.4072759538598048, 'recall': 0.6334917957368502, 'f1-score': 0.4957993278924629, 'support': 6521}, 'accuracy': 0.4149016641452345, 'macro avg': {'precision': 0.5171414064951467, 'recall': 0.3979507403482498, 'f1-score': 0.3362019906097881, 'support': 18508}, 'weighted avg': {'precision': 0.5079064104955267, 'recall': 0.4149016641452345, 'f1-score': 0.34923787090613284, 'support': 18508}}
[[3426   34 2900]
 [2393  122 3112]
 [2378   12 4131]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
2006/2006 - 42s - 42s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73211396
{'0': {'precision': 0.3958541292340454, 'recall': 0.573218178971079, 'f1-score': 0.4683051639727409, 'support': 83019}, '1': {'precision': 0.7948707441577296, 'recall': 0.7773932310229039, 'f1-score': 0.7860348463118165, 'support': 349329}, '2': {'precision': 0.6137449966968485, 'recall': 0.3900496406608876, 'f1-score': 0.4769720947088669, 'support': 80982}, 'accuracy': 0.6832661251047085, 'macro avg': {'precision': 0.6014899566962079, 'recall': 0.5802203502182902, 'f1-score': 0.5771040349978082, 'support': 513330}, 'weighted avg': {'precision': 0.7017651675593884, 'recall': 0.6832661251047085, 'f1-score': 0.6858924033444899, 'support': 513330}}
[[ 47588  29334   6097]
 [ 63981 271566  13782]
 [  8647  40748  31587]]
Evaluating performance on  train set...
538/538 - 15s - 15s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7119693
{'0': {'precision': 0.4405729281942644, 'recall': 0.5910749130397897, 'f1-score': 0.5048459267042265, 'support': 23574}, '1': {'precision': 0.8025150647701579, 'recall': 0.7893877640459287, 'f1-score': 0.7958972886092869, 'support': 91272}, '2': {'precision': 0.583968755811791, 'recall': 0.41514256753779033, 'f1-score': 0.4852918448302509, 'support': 22691}, 'accuracy': 0.6936533441910177, 'macro avg': {'precision': 0.6090189162587377, 'recall': 0.5985350815411695, 'f1-score': 0.5953450200479214, 'support': 137537}, 'weighted avg': {'precision': 0.7044217646093691, 'recall': 0.6936533441910177, 'f1-score': 0.6947667351557435, 'support': 137537}}
[[13934  7298  2342]
 [14854 72049  4369]
 [ 2839 10432  9420]]
Evaluating performance on  val set...
153/153 - 5s - 5s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7537536
{'0': {'precision': 0.4270076528141044, 'recall': 0.6187535092644582, 'f1-score': 0.5053017710781222, 'support': 7124}, '1': {'precision': 0.7891935621221153, 'recall': 0.7480426184518525, 'f1-score': 0.7680672965357203, 'support': 24778}, '2': {'precision': 0.5731730585766075, 'recall': 0.4202574146614438, 'f1-score': 0.4849463233513601, 'support': 7148}, 'accuracy': 0.6644558258642765, 'macro avg': {'precision': 0.5964580911709424, 'recall': 0.5956845141259182, 'f1-score': 0.5861051303217342, 'support': 39050}, 'weighted avg': {'precision': 0.6835769942026899, 'recall': 0.6644558258642765, 'f1-score': 0.6683057006411817, 'support': 39050}}
[[ 4408  1878   838]
 [ 4844 18535  1399]
 [ 1071  3073  3004]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
930/930 - 22s - 22s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1724218
{'0': {'precision': 0.3903662947679454, 'recall': 0.6098693374013398, 'f1-score': 0.4760326984504993, 'support': 75385}, '1': {'precision': 0.5623801571101626, 'recall': 0.10774043702896147, 'f1-score': 0.18083635821192381, 'support': 84388}, '2': {'precision': 0.43821391484942884, 'recall': 0.5830220539323543, 'f1-score': 0.5003513086246267, 'support': 78172}, 'accuracy': 0.4229674924877598, 'macro avg': {'precision': 0.46365345557584564, 'recall': 0.4335439427875518, 'f1-score': 0.38574012176234995, 'support': 237945}, 'weighted avg': {'precision': 0.4670909579142387, 'recall': 0.4229674924877598, 'f1-score': 0.37932970252488196, 'support': 237945}}
[[45975  3611 25799]
 [42667  9092 32629]
 [29132  3464 45576]]
Evaluating performance on  train set...
381/381 - 10s - 10s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1314989
{'0': {'precision': 0.42765512119370735, 'recall': 0.5765344822355047, 'f1-score': 0.4910585073392599, 'support': 32959}, '1': {'precision': 0.6080570098894706, 'recall': 0.13179711880969644, 'f1-score': 0.2166377367289308, 'support': 31723}, '2': {'precision': 0.4298883406907297, 'recall': 0.6049514297024879, 'f1-score': 0.5026122376693528, 'support': 32839}, 'accuracy': 0.44143312722388, 'macro avg': {'precision': 0.4885334905913026, 'recall': 0.4377610102492297, 'f1-score': 0.4034361605791812, 'support': 97521}, 'weighted avg': {'precision': 0.48709078951292495, 'recall': 0.44143312722388, 'f1-score': 0.40568164332267326, 'support': 97521}}
[[19002  1211 12746]
 [13942  4181 13600]
 [11489  1484 19866]]
Evaluating performance on  val set...
114/114 - 3s - 3s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1490971
{'0': {'precision': 0.4180993488916526, 'recall': 0.5755287009063444, 'f1-score': 0.48434255688800376, 'support': 9930}, '1': {'precision': 0.5289855072463768, 'recall': 0.08032570422535211, 'f1-score': 0.13947267863966373, 'support': 9088}, '2': {'precision': 0.43006843455945254, 'recall': 0.5997614076946018, 'f1-score': 0.5009341138373397, 'support': 10059}, 'accuracy': 0.429136430856003, 'macro avg': {'precision': 0.4590510968991606, 'recall': 0.4185386042754328, 'f1-score': 0.3749164497883357, 'support': 29077}, 'weighted avg': {'precision': 0.4568973830719371, 'recall': 0.429136430856003, 'f1-score': 0.38229341212865636, 'support': 29077}}
[[5715  302 3913]
 [4276  730 4082]
 [3678  348 6033]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1065/1065 - 25s - 25s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1815436
{'0': {'precision': 0.3335224558050645, 'recall': 0.5178205083625995, 'f1-score': 0.40572313364724905, 'support': 86277}, '1': {'precision': 0.4061775444394105, 'recall': 0.3164495198546587, 'f1-score': 0.355742803624884, 'support': 96325}, '2': {'precision': 0.36393148116047086, 'recall': 0.25701979900504157, 'f1-score': 0.3012719326854087, 'support': 89853}, 'accuracy': 0.36061734965407133, 'macro avg': {'precision': 0.3678771604683153, 'recall': 0.36376327574076656, 'f1-score': 0.35424595665251396, 'support': 272455}, 'weighted avg': {'precision': 0.3692378714442075, 'recall': 0.36061734965407133, 'f1-score': 0.35360587006453426, 'support': 272455}}
[[44676 21901 19700]
 [45180 30482 20663]
 [44096 22663 23094]]
Evaluating performance on  train set...
401/401 - 10s - 10s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1741172
{'0': {'precision': 0.36284808040863403, 'recall': 0.4973041637261821, 'f1-score': 0.4195672624647224, 'support': 35425}, '1': {'precision': 0.3651247871916543, 'recall': 0.2954971857410882, 'f1-score': 0.32664171486900306, 'support': 34112}, '2': {'precision': 0.34895931704000305, 'recall': 0.27913582112101526, 'f1-score': 0.31016653236637126, 'support': 33095}, 'accuracy': 0.3598780107568789, 'macro avg': {'precision': 0.3589773948800971, 'recall': 0.35731239019609523, 'f1-score': 0.3521251699000323, 'support': 102632}, 'weighted avg': {'precision': 0.35912618468505414, 'recall': 0.3598780107568789, 'f1-score': 0.3534037516475298, 'support': 102632}}
[[17617  9065  8743]
 [15540 10080  8492]
 [15395  8462  9238]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2026548
{'0': {'precision': 0.324815192454754, 'recall': 0.50345713156855, 'f1-score': 0.3948713975828943, 'support': 10124}, '1': {'precision': 0.3572014211533206, 'recall': 0.24942748091603054, 'f1-score': 0.2937408697606473, 'support': 10480}, '2': {'precision': 0.35838012184924145, 'recall': 0.2783706040642108, 'f1-score': 0.3133486526007938, 'support': 10777}, 'accuracy': 0.3413211816067047, 'macro avg': {'precision': 0.3467989118191053, 'recall': 0.34375173884959714, 'f1-score': 0.33398697331477845, 'support': 31381}, 'weighted avg': {'precision': 0.3471579132362896, 'recall': 0.3413211816067047, 'f1-score': 0.33310094558170744, 'support': 31381}}
[[5097 2339 2688]
 [5183 2614 2683]
 [5412 2365 3000]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
1646/1646 - 35s - 35s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4115121
{'0': {'precision': 0.3309762356470521, 'recall': 0.5751026190562679, 'f1-score': 0.4201517317790833, 'support': 110116}, '1': {'precision': 0.6528138528138528, 'recall': 0.030849801562947508, 'f1-score': 0.05891545553992812, 'support': 195528}, '2': {'precision': 0.33555195099407364, 'recall': 0.640421649760898, 'f1-score': 0.44036997285557566, 'support': 115641}, 'accuracy': 0.34043224895260926, 'macro avg': {'precision': 0.4397806798183262, 'recall': 0.4154580234600378, 'f1-score': 0.30647905339152903, 'support': 421285}, 'weighted avg': {'precision': 0.4816044467341668, 'recall': 0.34043224895260926, 'f1-score': 0.2580435413517885, 'support': 421285}}
[[ 63328   1515  45273]
 [ 88120   6032 101376]
 [ 39889   1693  74059]]
Evaluating performance on  train set...
526/526 - 12s - 12s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2761451
{'0': {'precision': 0.4054967446945977, 'recall': 0.5408803641667035, 'f1-score': 0.4635049281839098, 'support': 45254}, '1': {'precision': 0.5278030993618961, 'recall': 0.013042009235274243, 'f1-score': 0.0254550250593511, 'support': 44395}, '2': {'precision': 0.3914820891441072, 'recall': 0.6369824920468955, 'f1-score': 0.48493111244718057, 'support': 44951}, 'accuracy': 0.3988781575037147, 'macro avg': {'precision': 0.44159397773353365, 'recall': 0.39696828848295773, 'f1-score': 0.32463035523014716, 'support': 134600}, 'weighted avg': {'precision': 0.4411566097302932, 'recall': 0.3988781575037147, 'f1-score': 0.32617879861187044, 'support': 134600}}
[[24477   258 20519]
 [19828   579 23988]
 [16058   260 28633]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.267757
{'0': {'precision': 0.4004222378606615, 'recall': 0.5561619288099698, 'f1-score': 0.4656142384670462, 'support': 12277}, '1': {'precision': 0.6686567164179105, 'recall': 0.01815676420523628, 'f1-score': 0.03535353535353536, 'support': 12337}, '2': {'precision': 0.4079158316633267, 'recall': 0.6394408230581953, 'f1-score': 0.4980882757776894, 'support': 12733}, 'accuracy': 0.4068332128417276, 'macro avg': {'precision': 0.4923315953139662, 'recall': 0.40458650535780044, 'f1-score': 0.3330186831994237, 'support': 37347}, 'weighted avg': {'precision': 0.4915841703277973, 'recall': 0.4068332128417276, 'f1-score': 0.3345559372049645, 'support': 37347}}
[[6828   48 5401]
 [5696  224 6417]
 [4528   63 8142]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
5929/5929 - 124s - 124s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7223389
{'0': {'precision': 0.44407392369251725, 'recall': 0.6138267903568041, 'f1-score': 0.5153309145958698, 'support': 276174}, '1': {'precision': 0.7842506423219066, 'recall': 0.7557269979366268, 'f1-score': 0.7697246610052156, 'support': 967348}, '2': {'precision': 0.587411557327546, 'recall': 0.436539184312409, 'f1-score': 0.500860347404514, 'support': 274051}, 'accuracy': 0.6722628829057976, 'macro avg': {'precision': 0.6052453744473233, 'recall': 0.6020309908686133, 'f1-score': 0.5953053076685331, 'support': 1517573}, 'weighted avg': {'precision': 0.6867977269283522, 'recall': 0.6722628829057976, 'f1-score': 0.6748761940600073, 'support': 1517573}}
[[169523  76742  29909]
 [182177 731051  54120]
 [ 30045 124372 119634]]
Evaluating performance on  train set...
1254/1254 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7752011
{'0': {'precision': 0.4567688558961863, 'recall': 0.618628067967275, 'f1-score': 0.5255176550357273, 'support': 65149}, '1': {'precision': 0.7483608360836084, 'recall': 0.7154192805422488, 'f1-score': 0.7315193926408241, 'support': 190171}, '2': {'precision': 0.5771503740207724, 'recall': 0.44778211065074336, 'f1-score': 0.5043017301275508, 'support': 65648}, 'accuracy': 0.6410327509284415, 'macro avg': {'precision': 0.5940933553335224, 'recall': 0.5939431530534224, 'f1-score': 0.5871129259347008, 'support': 320968}, 'weighted avg': {'precision': 0.6541565841621351, 'recall': 0.6410327509284415, 'f1-score': 0.6432327338090844, 'support': 320968}}
[[ 40303  17743   7103]
 [ 39685 136052  14434]
 [  8247  28005  29396]]
Evaluating performance on  val set...
427/427 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7656034
{'0': {'precision': 0.44271941489361705, 'recall': 0.6224060572069545, 'f1-score': 0.5174061698655684, 'support': 21396}, '1': {'precision': 0.7469733656174334, 'recall': 0.7259151997827956, 'f1-score': 0.7362937464142283, 'support': 66297}, '2': {'precision': 0.6034142691967626, 'recall': 0.41230597639185795, 'f1-score': 0.4898815604207504, 'support': 21518}, 'accuracy': 0.6438454001886257, 'macro avg': {'precision': 0.5977023499026043, 'recall': 0.586875744460536, 'f1-score': 0.581193825566849, 'support': 109211}, 'weighted avg': {'precision': 0.6590800017029306, 'recall': 0.6438454001886257, 'f1-score': 0.6448595867962156, 'support': 109211}}
[[13317  6114  1965]
 [14305 48126  3866]
 [ 2458 10188  8872]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
5331/5331 - 101s - 101s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7289592
{'0': {'precision': 0.4746202193845443, 'recall': 0.5002371866722081, 'f1-score': 0.48709212610495123, 'support': 238209}, '1': {'precision': 0.7704213906644163, 'recall': 0.8218713443682786, 'f1-score': 0.7953151454433298, 'support': 884765}, '2': {'precision': 0.5575081472576301, 'recall': 0.3915168520725732, 'f1-score': 0.4599959642225901, 'support': 241632}, 'accuracy': 0.6895228366283015, 'macro avg': {'precision': 0.6008499191021969, 'recall': 0.5712084610376866, 'f1-score': 0.5808010785902904, 'support': 1364606}, 'weighted avg': {'precision': 0.6810848685911765, 'recall': 0.6895228366283015, 'f1-score': 0.6821357063889026, 'support': 1364606}}
[[119161  92377  26671]
 [109187 727163  48415]
 [ 22718 124311  94603]]
Evaluating performance on  train set...
2013/2013 - 42s - 42s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77051187
{'0': {'precision': 0.49655372326719915, 'recall': 0.4408089742001277, 'f1-score': 0.46702378488087365, 'support': 104923}, '1': {'precision': 0.7248665110490425, 'recall': 0.8217780580895596, 'f1-score': 0.7702860834481161, 'support': 307594}, '2': {'precision': 0.5548944860449285, 'recall': 0.39648815603871784, 'f1-score': 0.4625039008198814, 'support': 102795}, 'accuracy': 0.6593714099419381, 'macro avg': {'precision': 0.5921049067870567, 'recall': 0.5530250627761351, 'f1-score': 0.5666045897162905, 'support': 515312}, 'weighted avg': {'precision': 0.6444733959212514, 'recall': 0.6593714099419381, 'f1-score': 0.6471419307487026, 'support': 515312}}
[[ 46251  44528  14144]
 [ 36271 252774  18549]
 [ 10622  51416  40757]]
Evaluating performance on  val set...
696/696 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.741697
{'0': {'precision': 0.4957543474855084, 'recall': 0.46401548477916593, 'f1-score': 0.47936012603578076, 'support': 34098}, '1': {'precision': 0.7399006489864595, 'recall': 0.837158915782794, 'f1-score': 0.7855307927866622, 'support': 110310}, '2': {'precision': 0.5897000565930957, 'recall': 0.3730198979744041, 'f1-score': 0.45697578803106437, 'support': 33521}, 'accuracy': 0.678208723704399, 'macro avg': {'precision': 0.6084516843550212, 'recall': 0.558064766178788, 'f1-score': 0.5739555689511691, 'support': 177929}, 'weighted avg': {'precision': 0.6648157856634633, 'recall': 0.678208723704399, 'f1-score': 0.6649585436913267, 'support': 177929}}
[[15822 14710  3566]
 [12829 92347  5134]
 [ 3264 17753 12504]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
4192/4192 - 86s - 86s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96328133
{'0': {'precision': 0.4529095420236765, 'recall': 0.5695232432601587, 'f1-score': 0.50456619738615, 'support': 319555}, '1': {'precision': 0.6063639426289716, 'recall': 0.4995756956657255, 'f1-score': 0.5478141445993836, 'support': 439543}, '2': {'precision': 0.5017643272754323, 'recall': 0.4939850725357584, 'f1-score': 0.4978443123380426, 'support': 314052}, 'accuracy': 0.5187681125658109, 'macro avg': {'precision': 0.5203459373093602, 'recall': 0.5210280038205476, 'f1-score': 0.516741551441192, 'support': 1073150}, 'weighted avg': {'precision': 0.5300588227608872, 'recall': 0.5187681125658109, 'f1-score': 0.520312655028435, 'support': 1073150}}
[[181994  59966  77595]
 [143507 219585  76451]
 [ 76332  82583 155137]]
Evaluating performance on  train set...
1230/1230 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97831905
{'0': {'precision': 0.49845486445518267, 'recall': 0.5607699410201813, 'f1-score': 0.5277793788379259, 'support': 106138}, '1': {'precision': 0.5495241495635472, 'recall': 0.4302362569040803, 'f1-score': 0.4826184271703989, 'support': 103743}, '2': {'precision': 0.5013787126762783, 'recall': 0.5455584554131027, 'f1-score': 0.5225364126939236, 'support': 104986}, 'accuracy': 0.5126894847665839, 'macro avg': {'precision': 0.5164525755650028, 'recall': 0.5121882177791214, 'f1-score': 0.5109780729007495, 'support': 314867}, 'weighted avg': {'precision': 0.516256170957093, 'recall': 0.5126894847665839, 'f1-score': 0.511151498963444, 'support': 314867}}
[[59519 15883 30736]
 [32884 44634 26225]
 [27004 20706 57276]]
Evaluating performance on  val set...
400/400 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98512495
{'0': {'precision': 0.4815949327656923, 'recall': 0.545422473099312, 'f1-score': 0.5115253115694276, 'support': 34014}, '1': {'precision': 0.5623800383877159, 'recall': 0.39728813559322035, 'f1-score': 0.4656336909018673, 'support': 33925}, '2': {'precision': 0.485122116859924, 'recall': 0.5622048621232437, 'f1-score': 0.5208268636161105, 'support': 34306}, 'accuracy': 0.5019022935106852, 'macro avg': {'precision': 0.5096990293377774, 'recall': 0.5016384902719254, 'f1-score': 0.4993286220291351, 'support': 102245}, 'weighted avg': {'precision': 0.5095829838759066, 'recall': 0.5019022935106852, 'f1-score': 0.4994193485723766, 'support': 102245}}
[[18552  4524 10938]
 [10915 13478  9532]
 [ 9055  5964 19287]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
6143/6143 - 134s - 134s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91756344
{'0': {'precision': 0.4841695788873017, 'recall': 0.5615857311879358, 'f1-score': 0.5200121373685745, 'support': 462323}, '1': {'precision': 0.6098906294837346, 'recall': 0.5711731355635873, 'f1-score': 0.5898972663497423, 'support': 654903}, '2': {'precision': 0.5415437142965233, 'recall': 0.5030662718878219, 'f1-score': 0.5215963489120979, 'support': 455276}, 'accuracy': 0.5486358681896748, 'macro avg': {'precision': 0.5452013075558532, 'recall': 0.545275046213115, 'f1-score': 0.5438352508768048, 'support': 1572502}, 'weighted avg': {'precision': 0.5531400222134943, 'recall': 0.5486358681896748, 'f1-score': 0.5495760006386008, 'support': 1572502}}
[[259634 103825  98864]
 [185810 374063  95030]
 [ 90802 135440 229034]]
Evaluating performance on  train set...
2083/2083 - 41s - 41s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95306414
{'0': {'precision': 0.5063666653942425, 'recall': 0.5244946028841103, 'f1-score': 0.5152712421202167, 'support': 177039}, '1': {'precision': 0.5479010473703423, 'recall': 0.5396725301471401, 'f1-score': 0.5437556605219523, 'support': 180780}, '2': {'precision': 0.5254722747780527, 'recall': 0.5146181826474646, 'f1-score': 0.5199885935830264, 'support': 175398}, 'accuracy': 0.5263916941882948, 'macro avg': {'precision': 0.5265799958475458, 'recall': 0.526261771892905, 'f1-score': 0.5263384987417318, 'support': 533217}, 'weighted avg': {'precision': 0.5267329913897394, 'recall': 0.5263916941882948, 'f1-score': 0.5264802380272108, 'support': 533217}}
[[92856 36343 47840]
 [49546 97562 33672]
 [40975 44160 90263]]
Evaluating performance on  val set...
685/685 - 16s - 16s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9515253
{'0': {'precision': 0.4957164454896691, 'recall': 0.5194325142575512, 'f1-score': 0.5072974506197246, 'support': 56812}, '1': {'precision': 0.5625876637816017, 'recall': 0.5342755035737492, 'f1-score': 0.548066187865558, 'support': 61560}, '2': {'precision': 0.5155733547856806, 'recall': 0.5190225524198517, 'f1-score': 0.5172922040322155, 'support': 56801}, 'accuracy': 0.524515764415749, 'macro avg': {'precision': 0.5246258213523172, 'recall': 0.5242435234170507, 'f1-score': 0.5242186141724994, 'support': 175173}, 'weighted avg': {'precision': 0.525655331636359, 'recall': 0.524515764415749, 'f1-score': 0.52486542886658, 'support': 175173}}
[[29510 11375 15927]
 [16897 32890 11773]
 [13123 14197 29481]]
testing model on single stock: results/universal/W7/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
23942/23942 - 491s - 491s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1400921
{'0': {'precision': 0.41166515038254786, 'recall': 0.553872270002999, 'f1-score': 0.4722963740389503, 'support': 1923949}, '1': {'precision': 0.44276069865346757, 'recall': 0.07844901236578478, 'f1-score': 0.13328277961600135, 'support': 2296498}, '2': {'precision': 0.39117284198822955, 'recall': 0.6422346652052245, 'f1-score': 0.4862065689729066, 'support': 1908617}, 'accuracy': 0.4032524378926374, 'macro avg': {'precision': 0.41519956367474836, 'recall': 0.4248519825246695, 'f1-score': 0.3639285742092861, 'support': 6129064}, 'weighted avg': {'precision': 0.4169349430038081, 'recall': 0.4032524378926374, 'f1-score': 0.349603119891033, 'support': 6129064}}
[[1065622  113654  744673]
 [ 953191  180158 1163149]
 [ 569752  113085 1225780]]
Evaluating performance on  train set...
9052/9052 - 211s - 211s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1181767
{'0': {'precision': 0.41398751457160254, 'recall': 0.5256501734616047, 'f1-score': 0.4631840796019901, 'support': 772217}, '1': {'precision': 0.4785474492104366, 'recall': 0.11019430088468257, 'f1-score': 0.17913865153056477, 'support': 777454}, '2': {'precision': 0.4044139625451599, 'recall': 0.6100149985209973, 'f1-score': 0.4863792187174506, 'support': 767409}, 'accuracy': 0.4141928634315604, 'macro avg': {'precision': 0.43231630877573307, 'recall': 0.4152864909557615, 'f1-score': 0.3762339832833352, 'support': 2317080}, 'weighted avg': {'precision': 0.43247869719699306, 'recall': 0.4141928634315604, 'f1-score': 0.37555995970868233, 'support': 2317080}}
[[405916  46777 319524]
 [321884  85671 369899]
 [252703  46575 468131]]
Evaluating performance on  val set...
2763/2763 - 64s - 64s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1151413
{'0': {'precision': 0.41430156701862936, 'recall': 0.5272132859202965, 'f1-score': 0.46398692453551404, 'support': 233691}, '1': {'precision': 0.5000790624945095, 'recall': 0.11986288390191314, 'f1-score': 0.19337590868944904, 'support': 237463}, '2': {'precision': 0.4071973667065136, 'recall': 0.6086864469577957, 'f1-score': 0.4879603651861319, 'support': 236161}, 'accuracy': 0.4176583276192361, 'macro avg': {'precision': 0.4405259987398842, 'recall': 0.41858753892666845, 'f1-score': 0.381774399470365, 'support': 707315}, 'weighted avg': {'precision': 0.44072719966925794, 'recall': 0.4176583276192361, 'f1-score': 0.3811405096590254, 'support': 707315}}
[[123205  14075  96411]
 [ 96141  28463 112859]
 [ 78034  14379 143748]]
