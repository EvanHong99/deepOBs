This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W8/deepLOB_L1/h10
Epoch 1/50
7696/7696 - 142s - loss: 2.8986 - accuracy10: 0.5086 - val_loss: 3.4337 - val_accuracy10: 0.4283 - 142s/epoch - 18ms/step
Epoch 2/50
7696/7696 - 126s - loss: 2.8370 - accuracy10: 0.5270 - val_loss: 3.5234 - val_accuracy10: 0.4361 - 126s/epoch - 16ms/step
Epoch 3/50
7696/7696 - 127s - loss: 2.7892 - accuracy10: 0.5363 - val_loss: 3.5999 - val_accuracy10: 0.4403 - 127s/epoch - 16ms/step
Epoch 4/50
7696/7696 - 126s - loss: 2.7585 - accuracy10: 0.5422 - val_loss: 3.7127 - val_accuracy10: 0.4340 - 126s/epoch - 16ms/step
Epoch 5/50
7696/7696 - 126s - loss: 2.7412 - accuracy10: 0.5457 - val_loss: 3.6614 - val_accuracy10: 0.4375 - 126s/epoch - 16ms/step
Epoch 6/50
7696/7696 - 125s - loss: 2.7295 - accuracy10: 0.5481 - val_loss: 3.7316 - val_accuracy10: 0.4382 - 125s/epoch - 16ms/step
Epoch 7/50
7696/7696 - 124s - loss: 2.7207 - accuracy10: 0.5503 - val_loss: 3.6814 - val_accuracy10: 0.4387 - 124s/epoch - 16ms/step
Epoch 8/50
7696/7696 - 123s - loss: 2.7144 - accuracy10: 0.5513 - val_loss: 3.7039 - val_accuracy10: 0.4449 - 123s/epoch - 16ms/step
Epoch 9/50
7696/7696 - 124s - loss: 2.7083 - accuracy10: 0.5529 - val_loss: 3.7230 - val_accuracy10: 0.4454 - 124s/epoch - 16ms/step
Epoch 10/50
7696/7696 - 126s - loss: 2.7030 - accuracy10: 0.5541 - val_loss: 3.7400 - val_accuracy10: 0.4422 - 126s/epoch - 16ms/step
Epoch 11/50
7696/7696 - 125s - loss: 2.6983 - accuracy10: 0.5547 - val_loss: 3.7230 - val_accuracy10: 0.4400 - 125s/epoch - 16ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 134s - 134s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1027297
{'0': {'precision': 0.29168757161881753, 'recall': 0.13618840772509846, 'f1-score': 0.18568215020099482, 'support': 1383128}, '1': {'precision': 0.49604824041424683, 'recall': 0.6558005507821661, 'f1-score': 0.564846205100051, 'support': 3172216}, '2': {'precision': 0.2585860027109938, 'recall': 0.20629129838420515, 'f1-score': 0.22949729796468832, 'support': 1405624}, 'accuracy': 0.429238170713213, 'macro avg': {'precision': 0.34877393824801944, 'recall': 0.3327600856304899, 'f1-score': 0.3266752177552447, 'support': 5960968}, 'weighted avg': {'precision': 0.39263557597466564, 'recall': 0.429238170713213, 'f1-score': 0.3977916439670842, 'support': 5960968}}
[[ 188366 1083344  111418]
 [ 371901 2080341  719974]
 [  85513 1030143  289968]]
Evaluating performance on  train set...
7696/7696 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1032435
{'0': {'precision': 0.3532297801379302, 'recall': 0.22441629004354716, 'f1-score': 0.27446050750954804, 'support': 521963}, '1': {'precision': 0.452169581756746, 'recall': 0.6749284303008787, 'f1-score': 0.5415360559242695, 'support': 926719}, '2': {'precision': 0.28379307229743794, 'recall': 0.13873709192431616, 'f1-score': 0.18636598705956545, 'support': 520798}, 'accuracy': 0.4137437293092593, 'macro avg': {'precision': 0.36306414473070475, 'recall': 0.34602727075624734, 'f1-score': 0.334120850164461, 'support': 1969480}, 'weighted avg': {'precision': 0.3814234634687965, 'recall': 0.4137437293092593, 'f1-score': 0.3768350099619884, 'support': 1969480}}
[[117137 377026  27800]
 [146703 625469 154547]
 [ 67777 380767  72254]]
Evaluating performance on  val set...
2338/2338 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0639392
{'0': {'precision': 0.3508547270925245, 'recall': 0.2605653986451277, 'f1-score': 0.2990434824862727, 'support': 153520}, '1': {'precision': 0.4758786622132458, 'recall': 0.6688363014028166, 'f1-score': 0.5560946339790844, 'support': 290986}, '2': {'precision': 0.28557485326166887, 'recall': 0.13935174915510784, 'f1-score': 0.18730460785646322, 'support': 153274}, 'accuracy': 0.42822275753621736, 'macro avg': {'precision': 0.3707694141891464, 'recall': 0.35625114973435074, 'f1-score': 0.34748090810727345, 'support': 597780}, 'weighted avg': {'precision': 0.3949754862405182, 'recall': 0.4282227575362173, 'f1-score': 0.3955198150806684, 'support': 597780}}
[[ 40002 106036   7482]
 [ 50412 194622  45952]
 [ 23599 108316  21359]]
testing model out of sample: results/universal/W8/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 92s - 92s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91952735
{'0': {'precision': 0.3466993741965185, 'recall': 0.41713955518948265, 'f1-score': 0.3786715161351089, 'support': 626469}, '1': {'precision': 0.7225461968354229, 'recall': 0.5921902808578061, 'f1-score': 0.6509058545138325, 'support': 2370559}, '2': {'precision': 0.2666890670041941, 'recall': 0.3960619087453208, 'f1-score': 0.31874832262521097, 'support': 619234}, 'accuracy': 0.5282808601810378, 'macro avg': {'precision': 0.44531154601204515, 'recall': 0.46846391493086986, 'f1-score': 0.4494418977580508, 'support': 3616262}, 'weighted avg': {'precision': 0.5793766430072758, 'recall': 0.5282808601810378, 'f1-score': 0.5468675932287544, 'support': 3616262}}
[[ 261325  282183   82961]
 [ 375324 1403822  591413]
 [ 117102  256877  245255]]
Evaluating performance on  train set...
4550/4550 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9405962
{'0': {'precision': 0.36304096274010644, 'recall': 0.33598776590731905, 'f1-score': 0.34899086977414706, 'support': 233446}, '1': {'precision': 0.661399877827518, 'recall': 0.6238379842628026, 'f1-score': 0.6420700459361143, 'support': 697710}, '2': {'precision': 0.3152009378825233, 'recall': 0.39233889139251915, 'f1-score': 0.3495650178772872, 'support': 232995}, 'accuracy': 0.5197830865583588, 'macro avg': {'precision': 0.4465472594833826, 'recall': 0.4507215471875469, 'f1-score': 0.4468753111958495, 'support': 1164151}, 'weighted avg': {'precision': 0.5322814754003586, 'recall': 0.5197830865583588, 'f1-score': 0.5247567675290408, 'support': 1164151}}
[[ 78435 117782  37229]
 [101079 435258 161373]
 [ 36536 105046  91413]]
Evaluating performance on  val set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97582304
{'0': {'precision': 0.33595169129559627, 'recall': 0.26387906988701365, 'f1-score': 0.29558544030409495, 'support': 77797}, '1': {'precision': 0.6450690475881938, 'recall': 0.609657323415825, 'f1-score': 0.6268634788576609, 'support': 244954}, '2': {'precision': 0.2902166594416108, 'recall': 0.4019442528295138, 'f1-score': 0.33706300448310406, 'support': 78282}, 'accuracy': 0.5020334984901492, 'macro avg': {'precision': 0.4237457994418003, 'recall': 0.4251602153774508, 'f1-score': 0.41983730788162, 'support': 401033}, 'weighted avg': {'precision': 0.5158353994435622, 'recall': 0.5020334984901492, 'f1-score': 0.5060290380501941, 'support': 401033}}
[[ 20529  44454  12814]
 [ 31476 149338  64140]
 [  9102  37715  31465]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1807486
{'0': {'precision': 0.46616541353383456, 'recall': 0.011635666027191592, 'f1-score': 0.02270461619840091, 'support': 47956}, '1': {'precision': 0.4278361378594819, 'recall': 0.7525592403547292, 'f1-score': 0.5455325306185725, 'support': 70138}, '2': {'precision': 0.34669805476396975, 'recall': 0.2987614776852445, 'f1-score': 0.3209497046510294, 'support': 46830}, 'accuracy': 0.40826077465984334, 'macro avg': {'precision': 0.41356653538576205, 'recall': 0.35431879468905514, 'f1-score': 0.29639561715600093, 'support': 164924}, 'weighted avg': {'precision': 0.415942309871296, 'recall': 0.40826077465984334, 'f1-score': 0.32973647180364085, 'support': 164924}}
[[  558 37985  9413]
 [  404 52783 16951]
 [  235 32604 13991]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1013063
{'0': {'precision': 0.4279715762273902, 'recall': 0.23237460540161348, 'f1-score': 0.3012048192771084, 'support': 17106}, '1': {'precision': 0.4347044548967914, 'recall': 0.6368504213483146, 'f1-score': 0.5167102896925022, 'support': 22784}, '2': {'precision': 0.39435355836267, 'recall': 0.3309198331788693, 'f1-score': 0.3598626814903467, 'support': 17264}, 'accuracy': 0.4233824404241173, 'macro avg': {'precision': 0.41900986316228384, 'recall': 0.40004828664293246, 'f1-score': 0.39259259681998576, 'support': 57154}, 'weighted avg': {'precision': 0.42050089083681574, 'recall': 0.4233824404241173, 'f1-score': 0.40483266634281995, 'support': 57154}}
[[ 3975  9763  3368]
 [ 2868 14510  5406]
 [ 2445  9106  5713]]
Evaluating performance on  val set...
68/68 - 1s - 620ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1284893
{'0': {'precision': 0.39794945159752027, 'recall': 0.3153817082388511, 'f1-score': 0.35188699135568197, 'support': 5292}, '1': {'precision': 0.42021851362708607, 'recall': 0.533862111043319, 'f1-score': 0.47027208599261, 'support': 6556}, '2': {'precision': 0.378022910479423, 'recall': 0.3306735943588792, 'f1-score': 0.3527665049985153, 'support': 5389}, 'accuracy': 0.4032604281487498, 'macro avg': {'precision': 0.3987302919013431, 'recall': 0.3933058045470164, 'f1-score': 0.3916418607822691, 'support': 17237}, 'weighted avg': {'precision': 0.4001895073253388, 'recall': 0.4032604281487498, 'f1-score': 0.39718909609902064, 'support': 17237}}
[[1669 2473 1150]
 [1274 3500 1782]
 [1251 2356 1782]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
2179/2179 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8709094
{'0': {'precision': 0.2583246560471454, 'recall': 0.23460292549445685, 'f1-score': 0.24589299647820495, 'support': 49701}, '1': {'precision': 0.8507549341830861, 'recall': 0.5553227496172133, 'f1-score': 0.6720020874295625, 'support': 459133}, '2': {'precision': 0.14972199785863216, 'recall': 0.6513913292199567, 'f1-score': 0.2434801866403965, 'support': 48946}, 'accuracy': 0.5351751586647066, 'macro avg': {'precision': 0.41960052936295456, 'recall': 0.4804390014438756, 'f1-score': 0.3871250901827213, 'support': 557780}, 'weighted avg': {'precision': 0.7364497684278222, 'recall': 0.5351751586647066, 'f1-score': 0.5964302116265578, 'support': 557780}}
[[ 11660  29609   8432]
 [ 31533 254967 172633]
 [  1944  15119  31883]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8509025
{'0': {'precision': 0.2473538631753642, 'recall': 0.37240421987784567, 'f1-score': 0.29726315789473684, 'support': 18010}, '1': {'precision': 0.8114995559598848, 'recall': 0.6202115683872463, 'f1-score': 0.7030767642836365, 'support': 120812}, '2': {'precision': 0.20670598862851375, 'recall': 0.42595127292636187, 'f1-score': 0.27833926622900385, 'support': 18265}, 'accuracy': 0.5692132385238753, 'macro avg': {'precision': 0.4218531359212543, 'recall': 0.4728556870638179, 'f1-score': 0.4262263961357924, 'support': 157087}, 'weighted avg': {'precision': 0.6764990884841756, 'recall': 0.5692132385238753, 'f1-score': 0.6071647317600544, 'support': 157087}}
[[ 6707  9380  1923]
 [17948 74929 27935]
 [ 2460  8025  7780]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79274416
{'0': {'precision': 0.2417434284430465, 'recall': 0.4224577934825285, 'f1-score': 0.3075164332666476, 'support': 5094}, '1': {'precision': 0.8465910990737955, 'recall': 0.6619173354944968, 'f1-score': 0.7429502039379089, 'support': 38251}, '2': {'precision': 0.247769459542611, 'recall': 0.4632790028763183, 'f1-score': 0.3228651610316718, 'support': 5215}, 'accuracy': 0.6154654036243822, 'macro avg': {'precision': 0.4453679956864843, 'recall': 0.5158847106177812, 'f1-score': 0.45777726607874275, 'support': 48560}, 'weighted avg': {'precision': 0.7188326788854066, 'recall': 0.6154654036243822, 'f1-score': 0.6521585415294363, 'support': 48560}}
[[ 2152  2443   499]
 [ 6096 25319  6836]
 [  654  2145  2416]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0278715
{'0': {'precision': 0.3964844261650905, 'recall': 0.5971042318718602, 'f1-score': 0.4765403204223319, 'support': 76042}, '1': {'precision': 0.5651211016932091, 'recall': 0.3830820987696444, 'f1-score': 0.45662739292584625, 'support': 146543}, '2': {'precision': 0.33205750783436594, 'recall': 0.3707631079889954, 'f1-score': 0.3503445142727341, 'support': 74878}, 'accuracy': 0.43469271808594684, 'macro avg': {'precision': 0.4312210118975552, 'recall': 0.4503164795435, 'f1-score': 0.4278374092069708, 'support': 297463}, 'weighted avg': {'precision': 0.4633443904334166, 'recall': 0.43469271808594684, 'f1-score': 0.4349640917586424, 'support': 297463}}
[[45405 19912 10725]
 [45286 56138 45119]
 [23828 23288 27762]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1044365
{'0': {'precision': 0.461149568328537, 'recall': 0.42777777777777776, 'f1-score': 0.4438372571770782, 'support': 27720}, '1': {'precision': 0.3871011220810729, 'recall': 0.4126288567221005, 'f1-score': 0.3994575611113043, 'support': 27841}, '2': {'precision': 0.43911177326096984, 'recall': 0.4417758109988937, 'f1-score': 0.4404397637515121, 'support': 28021}, 'accuracy': 0.42742456509774834, 'macro avg': {'precision': 0.4291208212235265, 'recall': 0.4273941484995906, 'f1-score': 0.42791152734663157, 'support': 83582}, 'weighted avg': {'precision': 0.4290959700948988, 'recall': 0.42742456509774834, 'f1-score': 0.42791545246499907, 'support': 83582}}
[[11858  9027  6835]
 [ 7376 11488  8977]
 [ 6480  9162 12379]]
Evaluating performance on  val set...
125/125 - 1s - 856ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0779164
{'0': {'precision': 0.45091122868900646, 'recall': 0.39208669870156426, 'f1-score': 0.41944657114732575, 'support': 9781}, '1': {'precision': 0.43875421415957616, 'recall': 0.4546664448511063, 'f1-score': 0.44656862745098036, 'support': 12022}, '2': {'precision': 0.4423307784652322, 'recall': 0.4795274802282511, 'f1-score': 0.46017869151695645, 'support': 9989}, 'accuracy': 0.44322471061902363, 'macro avg': {'precision': 0.44399874043793824, 'recall': 0.44209354126030725, 'f1-score': 0.44206463003842084, 'support': 31792}, 'weighted avg': {'precision': 0.44361814407784356, 'recall': 0.44322471061902363, 'f1-score': 0.44250062598045287, 'support': 31792}}
[[3835 3611 2335]
 [2852 5466 3704]
 [1818 3381 4790]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1223/1223 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.198049
{'0': {'precision': 0.3582534055532562, 'recall': 0.38881131172673744, 'f1-score': 0.37290738893649705, 'support': 102407}, '1': {'precision': 0.3404453865738874, 'recall': 0.2723017240584945, 'f1-score': 0.302584423829125, 'support': 108523}, '2': {'precision': 0.37177860804587715, 'recall': 0.41906702055767214, 'f1-score': 0.39400901502350444, 'support': 102103}, 'accuracy': 0.3582881038101414, 'macro avg': {'precision': 0.3568258000576736, 'recall': 0.360060018780968, 'f1-score': 0.35650027592970884, 'support': 313033}, 'weighted avg': {'precision': 0.35649124024290885, 'recall': 0.3582881038101414, 'f1-score': 0.35541044831366936, 'support': 313033}}
[[39817 28450 34140]
 [40810 29551 38162]
 [30515 28800 42788]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1907254
{'0': {'precision': 0.40209811786485655, 'recall': 0.4127708095781072, 'f1-score': 0.40736457128567416, 'support': 31572}, '1': {'precision': 0.33469177811189366, 'recall': 0.2808992495184964, 'f1-score': 0.30544522279194053, 'support': 30114}, '2': {'precision': 0.3721061212390692, 'recall': 0.4221908317357818, 'f1-score': 0.3955694208104872, 'support': 29733}, 'accuracy': 0.3723952351261773, 'macro avg': {'precision': 0.3696320057386065, 'recall': 0.3719536302774618, 'f1-score': 0.3694597382960339, 'support': 91419}, 'weighted avg': {'precision': 0.37013948179363226, 'recall': 0.3723952351261773, 'f1-score': 0.36995544988181905, 'support': 91419}}
[[13032  8347 10193]
 [10666  8459 10989]
 [ 8712  8468 12553]]
Evaluating performance on  val set...
99/99 - 1s - 733ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2095499
{'0': {'precision': 0.38316198944151153, 'recall': 0.48442622950819675, 'f1-score': 0.42788436675802866, 'support': 8540}, '1': {'precision': 0.3225864553314121, 'recall': 0.2196737397277076, 'f1-score': 0.2613644655235316, 'support': 8153}, '2': {'precision': 0.3893815243012684, 'recall': 0.4050204319906597, 'f1-score': 0.3970470413185304, 'support': 8565}, 'accuracy': 0.3720405416105788, 'macro avg': {'precision': 0.3650433230247307, 'recall': 0.3697068004088547, 'f1-score': 0.36209862453336356, 'support': 25258}, 'weighted avg': {'precision': 0.3657179315776338, 'recall': 0.3720405416105788, 'f1-score': 0.3636766524831788, 'support': 25258}}
[[4137 1755 2648]
 [3570 1791 2792]
 [3090 2006 3469]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1208298
{'0': {'precision': 0.43754697415113547, 'recall': 0.3758478662373535, 'f1-score': 0.40435736360159485, 'support': 122366}, '1': {'precision': 0.3770230994917285, 'recall': 0.4408039359363551, 'f1-score': 0.4064264422559366, 'support': 124189}, '2': {'precision': 0.4371456451151601, 'recall': 0.42376378106856283, 'f1-score': 0.43035071011552317, 'support': 122632}, 'accuracy': 0.4136142388545642, 'macro avg': {'precision': 0.41723857291934136, 'recall': 0.4134718610807571, 'f1-score': 0.4137115053243516, 'support': 369187}, 'weighted avg': {'precision': 0.417054336944471, 'recall': 0.4136142388545642, 'f1-score': 0.4136875211605016, 'support': 369187}}
[[45991 45350 31025]
 [33560 54743 35886]
 [25560 45105 51967]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1606408
{'0': {'precision': 0.4280909990108803, 'recall': 0.3094154374091462, 'f1-score': 0.3592049022726958, 'support': 41963}, '1': {'precision': 0.35413256955810146, 'recall': 0.5402102938352218, 'f1-score': 0.42781368821292776, 'support': 41656}, '2': {'precision': 0.43016225553704734, 'recall': 0.32678742999086074, 'f1-score': 0.3714160152348484, 'support': 42673}, 'accuracy': 0.39141038228866437, 'macro avg': {'precision': 0.404128608035343, 'recall': 0.39213772041174294, 'f1-score': 0.3861448685734907, 'support': 126292}, 'weighted avg': {'precision': 0.4043965004872697, 'recall': 0.39141038228866437, 'f1-score': 0.38596077287859515, 'support': 126292}}
[[12984 20675  8304]
 [ 8984 22503 10169]
 [ 8362 20366 13945]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1716805
{'0': {'precision': 0.4345349354695149, 'recall': 0.3779807990089811, 'f1-score': 0.40428967744606853, 'support': 12916}, '1': {'precision': 0.3494707063332725, 'recall': 0.6010830324909747, 'f1-score': 0.44197587858503085, 'support': 12742}, '2': {'precision': 0.457074244546728, 'recall': 0.18286629303442753, 'f1-score': 0.26122262251958595, 'support': 12490}, 'accuracy': 0.38861801405054003, 'macro avg': {'precision': 0.41369329544983846, 'recall': 0.38731004151146115, 'f1-score': 0.3691627261835618, 'support': 38148}, 'weighted avg': {'precision': 0.4135017898975423, 'recall': 0.38861801405054003, 'f1-score': 0.3700359828586955, 'support': 38148}}
[[4882 6929 1105]
 [3475 7659 1608]
 [2878 7328 2284]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
5521/5521 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8667136
{'0': {'precision': 0.20991017003529033, 'recall': 0.5114437583053232, 'f1-score': 0.2976548461206014, 'support': 127930}, '1': {'precision': 0.8654111672931808, 'recall': 0.48604411722611923, 'f1-score': 0.6224815747333482, 'support': 1152883}, '2': {'precision': 0.1837344091325488, 'recall': 0.6297199181868268, 'f1-score': 0.2844688710878967, 'support': 132497}, 'accuracy': 0.5018127657767935, 'macro avg': {'precision': 0.41968524882034, 'recall': 0.5424025979060897, 'f1-score': 0.4015350973139487, 'support': 1413310}, 'weighted avg': {'precision': 0.7421697213222253, 'recall': 0.5018127657767935, 'f1-score': 0.5613904110209708, 'support': 1413310}}
[[ 65429  50063  12438]
 [234293 560352 358238]
 [ 11978  37083  83436]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8709334
{'0': {'precision': 0.23189033005358756, 'recall': 0.5433991528962596, 'f1-score': 0.32506311948540895, 'support': 33526}, '1': {'precision': 0.8510076070999599, 'recall': 0.48608988310089457, 'f1-score': 0.618752471356523, 'support': 262363}, '2': {'precision': 0.1891971926915218, 'recall': 0.5663839721048433, 'f1-score': 0.2836445970343623, 'support': 33841}, 'accuracy': 0.5001577047887665, 'macro avg': {'precision': 0.4240317099483564, 'recall': 0.5319576693673325, 'f1-score': 0.40915339595876477, 'support': 329730}, 'weighted avg': {'precision': 0.7201343105717319, 'recall': 0.5001577047887665, 'f1-score': 0.5544980365590608, 'support': 329730}}
[[ 18218  11983   3325]
 [ 56016 127532  78815]
 [  4329  10345  19167]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84923047
{'0': {'precision': 0.21462941077156847, 'recall': 0.5086525957787337, 'f1-score': 0.3018789515865713, 'support': 9997}, '1': {'precision': 0.8729842498966282, 'recall': 0.5039219728119948, 'f1-score': 0.6389918764058081, 'support': 92173}, '2': {'precision': 0.18200753252682036, 'recall': 0.6525163666121113, 'f1-score': 0.28462430840621095, 'support': 9776}, 'accuracy': 0.5173208511246494, 'macro avg': {'precision': 0.423207064398339, 'recall': 0.55503031173428, 'f1-score': 0.40849837879953016, 'support': 111946}, 'weighted avg': {'precision': 0.7538503664551434, 'recall': 0.5173208511246494, 'f1-score': 0.5779408763327195, 'support': 111946}}
[[ 5085  4036   876]
 [17932 46448 27793]
 [  675  2722  6379]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
5918/5918 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8236256
{'0': {'precision': 0.26406563662340327, 'recall': 0.33530312308634413, 'f1-score': 0.29545094309716274, 'support': 130640}, '1': {'precision': 0.8640937648954512, 'recall': 0.6224943433506486, 'f1-score': 0.7236617564586856, 'support': 1255160}, '2': {'precision': 0.1671521624792653, 'recall': 0.5755603368212494, 'f1-score': 0.2590670145650515, 'support': 129208}, 'accuracy': 0.5937268978117607, 'macro avg': {'precision': 0.4317705213327066, 'recall': 0.5111192677527474, 'f1-score': 0.42605990470696664, 'support': 1515008}, 'weighted avg': {'precision': 0.7529140844961063, 'recall': 0.5937268978117608, 'f1-score': 0.6471137659080469, 'support': 1515008}}
[[ 43804  74781  12055]
 [115346 781330 358484]
 [  6733  48108  74367]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8077063
{'0': {'precision': 0.2508918567362551, 'recall': 0.40245010949055904, 'f1-score': 0.3090922072461584, 'support': 48406}, '1': {'precision': 0.8323917919747446, 'recall': 0.6545395157668386, 'f1-score': 0.7328291732251668, 'support': 367385}, '2': {'precision': 0.18843100343755115, 'recall': 0.3798465599736017, 'f1-score': 0.2519010886810001, 'support': 48488}, 'accuracy': 0.599568362988634, 'macro avg': {'precision': 0.42390488404951693, 'recall': 0.4789453950769998, 'f1-score': 0.43127415638410843, 'support': 464279}, 'weighted avg': {'precision': 0.704510805370255, 'recall': 0.599568362988634, 'f1-score': 0.638423325580631, 'support': 464279}}
[[ 19481  25688   3237]
 [ 50828 240468  76089]
 [  7338  22732  18418]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82464284
{'0': {'precision': 0.23491869918699188, 'recall': 0.4307222180815383, 'f1-score': 0.30402188494620824, 'support': 13417}, '1': {'precision': 0.8787737834186103, 'recall': 0.5834025689476432, 'f1-score': 0.7012545127550232, 'support': 136009}, '2': {'precision': 0.15306933177218365, 'recall': 0.5506167268351384, 'f1-score': 0.2395458412407565, 'support': 13296}, 'accuracy': 0.5681346099482553, 'macro avg': {'precision': 0.42225393812592865, 'recall': 0.52158050462144, 'f1-score': 0.41494074631399597, 'support': 162722}, 'weighted avg': {'precision': 0.7663884264648702, 'recall': 0.5681346099482553, 'f1-score': 0.6307751143714945, 'support': 162722}}
[[ 5779  6380  1258]
 [17412 79348 39249]
 [ 1409  4566  7321]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
3755/3755 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0568936
{'0': {'precision': 0.44706004895578355, 'recall': 0.03745086319353248, 'f1-score': 0.06911210589030949, 'support': 229207}, '1': {'precision': 0.5434250798377233, 'recall': 0.768528719392757, 'f1-score': 0.6366653779097334, 'support': 511031}, '2': {'precision': 0.353725951670726, 'recall': 0.35103768247142697, 'f1-score': 0.35237668996821686, 'support': 220925}, 'accuracy': 0.49822870834603494, 'macro avg': {'precision': 0.4480703601547443, 'recall': 0.3856724216859055, 'f1-score': 0.3527180579227533, 'support': 961163}, 'weighted avg': {'precision': 0.4768423883237442, 'recall': 0.49822870834603494, 'f1-score': 0.4359776056970747, 'support': 961163}}
[[  8584 188135  32488]
 [  9084 392742 109205]
 [  1533 141839  77553]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0083196
{'0': {'precision': 0.4314576558744521, 'recall': 0.29762810384847954, 'f1-score': 0.35226013482316004, 'support': 102534}, '1': {'precision': 0.5222646285116188, 'recall': 0.6987955015016294, 'f1-score': 0.5977693711011253, 'support': 187796}, '2': {'precision': 0.3880845849126507, 'recall': 0.2674004182580436, 'f1-score': 0.31663266077231167, 'support': 101851}, 'accuracy': 0.4818769904712365, 'macro avg': {'precision': 0.44726895643290715, 'recall': 0.4212746745360509, 'f1-score': 0.42222072223219903, 'support': 392181}, 'weighted avg': {'precision': 0.4636764415444334, 'recall': 0.4818769904712365, 'f1-score': 0.46056971299370836, 'support': 392181}}
[[ 30517  62320   9697]
 [ 23319 131231  33246]
 [ 16894  57722  27235]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0089506
{'0': {'precision': 0.38946138319345586, 'recall': 0.24059064807219033, 'f1-score': 0.2974381858380155, 'support': 30475}, '1': {'precision': 0.5160160567804991, 'recall': 0.7596478306298282, 'f1-score': 0.6145670218810193, 'support': 58381}, '2': {'precision': 0.4184232137968793, 'recall': 0.20028171782356602, 'f1-score': 0.27089656394691947, 'support': 30527}, 'accuracy': 0.4841141536064599, 'macro avg': {'precision': 0.4413002179236114, 'recall': 0.4001733988418615, 'f1-score': 0.3943005905553181, 'support': 119383}, 'weighted avg': {'precision': 0.45875522068720187, 'recall': 0.4841141536064599, 'f1-score': 0.44573453025520315, 'support': 119383}}
[[ 7332 21114  2029]
 [ 7563 44349  6469]
 [ 3931 20482  6114]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
4960/4960 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9159991
{'0': {'precision': 0.34160512036225693, 'recall': 0.5032008498186118, 'f1-score': 0.4069478505978711, 'support': 249465}, '1': {'precision': 0.6842847916327952, 'recall': 0.5923122310462229, 'f1-score': 0.6349854251617351, 'support': 774529}, '2': {'precision': 0.33131129222233247, 'recall': 0.312557492083391, 'f1-score': 0.32166127360120633, 'support': 245686}, 'accuracy': 0.5206705626614581, 'macro avg': {'precision': 0.4524004014057949, 'recall': 0.46935685764940854, 'f1-score': 0.4545315164536041, 'support': 1269680}, 'weighted avg': {'precision': 0.5486543718658746, 'recall': 0.520670562661458, 'f1-score': 0.5295519686696469, 'support': 1269680}}
[[125531 103882  20052]
 [180830 458763 134936]
 [ 61113 107782  76791]]
Evaluating performance on  train set...
1691/1691 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96637005
{'0': {'precision': 0.41082706766917293, 'recall': 0.305869660359691, 'f1-score': 0.35066306497628374, 'support': 98251}, '1': {'precision': 0.6033625169756335, 'recall': 0.6140461427299154, 'f1-score': 0.6086574516503124, 'support': 238044}, '2': {'precision': 0.35016817814109935, 'recall': 0.4259184455561425, 'f1-score': 0.3843464931957529, 'support': 96549}, 'accuracy': 0.5021300976795335, 'macro avg': {'precision': 0.4547859209286352, 'recall': 0.44861141621524964, 'f1-score': 0.44788900327411635, 'support': 432844}, 'weighted avg': {'precision': 0.5031821733646686, 'recall': 0.5021300976795335, 'f1-score': 0.5000612710103144, 'support': 432844}}
[[ 30052  52694  15505]
 [ 31066 146170  60808]
 [ 12032  43395  41122]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0507714
{'0': {'precision': 0.3550718817765641, 'recall': 0.12148608172350306, 'f1-score': 0.18103271774292615, 'support': 36391}, '1': {'precision': 0.5415519920379417, 'recall': 0.6869565217391305, 'f1-score': 0.605649319673807, 'support': 77625}, '2': {'precision': 0.3795255619653869, 'recall': 0.4112021121827685, 'f1-score': 0.39472935578141566, 'support': 37118}, 'accuracy': 0.48307462252041233, 'macro avg': {'precision': 0.4253831452599643, 'recall': 0.40654823854846733, 'f1-score': 0.3938037977327163, 'support': 151134}, 'weighted avg': {'precision': 0.45685698810795317, 'recall': 0.48307462252041233, 'f1-score': 0.451606218977574, 'support': 151134}}
[[ 4421 25016  6954]
 [ 6301 53325 17999]
 [ 1729 20126 15263]]
testing model on single stock: results/universal/W8/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
10609/10609 - 69s - 69s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2782519
{'0': {'precision': 0.3976671811350353, 'recall': 0.07194098065759374, 'f1-score': 0.12184016085660988, 'support': 873883}, '1': {'precision': 0.3457526783765107, 'recall': 0.8957386732096878, 'f1-score': 0.4989225981992971, 'support': 940646}, '2': {'precision': 0.45070690998292806, 'recall': 0.06035046213018211, 'f1-score': 0.10644742366309493, 'support': 901153}, 'accuracy': 0.35343828916640463, 'macro avg': {'precision': 0.39804225649815805, 'recall': 0.3426767053324879, 'f1-score': 0.24240339423966728, 'support': 2715682}, 'weighted avg': {'precision': 0.3972855979484435, 'recall': 0.35343828916640463, 'f1-score': 0.2473445001189027, 'support': 2715682}}
[[ 62868 786989  24026]
 [ 55818 842573  42255]
 [ 39406 807362  54385]]
Evaluating performance on  train set...
3903/3903 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2488389
{'0': {'precision': 0.3991157589056293, 'recall': 0.14548006220247917, 'f1-score': 0.21323478139599747, 'support': 336321}, '1': {'precision': 0.3275285793122917, 'recall': 0.8693778905151182, 'f1-score': 0.4758034358474028, 'support': 325634}, '2': {'precision': 0.4676235255299843, 'recall': 0.01681656917071087, 'f1-score': 0.03246561731346873, 'support': 337108}, 'accuracy': 0.3380127179166879, 'macro avg': {'precision': 0.39808928791596837, 'recall': 0.3438915072961028, 'f1-score': 0.24050127818562303, 'support': 999063}, 'weighted avg': {'precision': 0.3988988522155669, 'recall': 0.3380127179166879, 'f1-score': 0.23782036794869318, 'support': 999063}}
[[ 48928 284883   2510]
 [ 38591 283099   3944]
 [ 35072 296367   5669]]
Evaluating performance on  val set...
1144/1144 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2007115
{'0': {'precision': 0.41102067331575526, 'recall': 0.21638803387852817, 'f1-score': 0.28351520902525174, 'support': 99414}, '1': {'precision': 0.3272454501158308, 'recall': 0.8142574552261028, 'f1-score': 0.4668617945669075, 'support': 94028}, '2': {'precision': 0.47102479077846204, 'recall': 0.03007329293988366, 'f1-score': 0.05653690155793942, 'support': 99191}, 'accuracy': 0.3453404093181562, 'macro avg': {'precision': 0.4030969714033494, 'recall': 0.3535729273481716, 'f1-score': 0.2689713017166996, 'support': 292633}, 'weighted avg': {'precision': 0.40444127771854255, 'recall': 0.3453404093181562, 'f1-score': 0.26549095150583535, 'support': 292633}}
[[21512 76464  1438]
 [15553 76563  1912]
 [15273 80935  2983]]
training model: results/universal/W8/deepLOB_L1/h20
Epoch 1/50
7696/7696 - 130s - loss: 2.9932 - accuracy20: 0.4760 - val_loss: 3.3164 - val_accuracy20: 0.3827 - 130s/epoch - 17ms/step
Epoch 2/50
7696/7696 - 123s - loss: 2.9330 - accuracy20: 0.4951 - val_loss: 3.5246 - val_accuracy20: 0.4141 - 123s/epoch - 16ms/step
Epoch 3/50
7696/7696 - 121s - loss: 2.8876 - accuracy20: 0.5063 - val_loss: 3.4806 - val_accuracy20: 0.4194 - 121s/epoch - 16ms/step
Epoch 4/50
7696/7696 - 124s - loss: 2.8577 - accuracy20: 0.5135 - val_loss: 3.4853 - val_accuracy20: 0.4259 - 124s/epoch - 16ms/step
Epoch 5/50
7696/7696 - 121s - loss: 2.8430 - accuracy20: 0.5171 - val_loss: 3.5255 - val_accuracy20: 0.4311 - 121s/epoch - 16ms/step
Epoch 6/50
7696/7696 - 126s - loss: 2.8314 - accuracy20: 0.5189 - val_loss: 3.4787 - val_accuracy20: 0.4290 - 126s/epoch - 16ms/step
Epoch 7/50
7696/7696 - 123s - loss: 2.8205 - accuracy20: 0.5215 - val_loss: 3.4961 - val_accuracy20: 0.4248 - 123s/epoch - 16ms/step
Epoch 8/50
7696/7696 - 124s - loss: 2.8132 - accuracy20: 0.5230 - val_loss: 3.4825 - val_accuracy20: 0.4277 - 124s/epoch - 16ms/step
Epoch 9/50
7696/7696 - 123s - loss: 2.8061 - accuracy20: 0.5241 - val_loss: 3.4957 - val_accuracy20: 0.4320 - 123s/epoch - 16ms/step
Epoch 10/50
7696/7696 - 123s - loss: 2.8009 - accuracy20: 0.5252 - val_loss: 3.4898 - val_accuracy20: 0.4276 - 123s/epoch - 16ms/step
Epoch 11/50
7696/7696 - 123s - loss: 2.7955 - accuracy20: 0.5264 - val_loss: 3.5299 - val_accuracy20: 0.4244 - 123s/epoch - 16ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 141s - 141s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0677232
{'0': {'precision': 0.3361098419256125, 'recall': 0.5710997637673529, 'f1-score': 0.42317067658686947, 'support': 1532811}, '1': {'precision': 0.4830656782173415, 'recall': 0.3271724289474773, 'f1-score': 0.39012179231253646, 'support': 2876147}, '2': {'precision': 0.3183068033291422, 'recall': 0.2888802262872018, 'f1-score': 0.3028804532685074, 'support': 1552010}, 'accuracy': 0.37992638108441446, 'macro avg': {'precision': 0.3791607744906987, 'recall': 0.39571747300067733, 'f1-score': 0.37205764072263775, 'support': 5960968}, 'weighted avg': {'precision': 0.4023803023190988, 'recall': 0.37992638108441446, 'f1-score': 0.3759056889453822, 'support': 5960968}}
[[ 875388  469988  187435]
 [1162400  940996  772751]
 [ 566682  536983  448345]]
Evaluating performance on  train set...
7696/7696 - 53s - 53s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0919291
{'0': {'precision': 0.3650456746836779, 'recall': 0.5562415013696085, 'f1-score': 0.4408040390280788, 'support': 559649}, '1': {'precision': 0.43227398369180603, 'recall': 0.4042734279117665, 'f1-score': 0.4178050945114303, 'support': 850652}, '2': {'precision': 0.32042695362733103, 'recall': 0.18403409283968103, 'f1-score': 0.233792020792014, 'support': 559179}, 'accuracy': 0.384925970306883, 'macro avg': {'precision': 0.37258220400093833, 'recall': 0.38151634070701873, 'f1-score': 0.3641337181105077, 'support': 1969480}, 'weighted avg': {'precision': 0.3814144845689345, 'recall': 0.384925970306883, 'f1-score': 0.3720951049458842, 'support': 1969480}}
[[311300 202846  45503]
 [334008 343896 172748]
 [207462 248809 102908]]
Evaluating performance on  val set...
2338/2338 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0875646
{'0': {'precision': 0.35558983977892644, 'recall': 0.5992905448205549, 'f1-score': 0.44634203875315925, 'support': 165761}, '1': {'precision': 0.4442526179950648, 'recall': 0.3806684672770811, 'f1-score': 0.4100100390092966, 'support': 267687}, '2': {'precision': 0.30752903124368275, 'recall': 0.16663218362826474, 'f1-score': 0.21614688168478216, 'support': 164332}, 'accuracy': 0.3824517380976279, 'macro avg': {'precision': 0.369123829672558, 'recall': 0.3821970652419669, 'f1-score': 0.35749965314907933, 'support': 597780}, 'weighted avg': {'precision': 0.38208109797446627, 'recall': 0.3824517380976279, 'f1-score': 0.36679097554128215, 'support': 597780}}
[[ 99339  56023  10399]
 [114527 101900  51260]
 [ 65498  71451  27383]]
testing model out of sample: results/universal/W8/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 91s - 91s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0267661
{'0': {'precision': 0.3051012280672521, 'recall': 0.6149566810816766, 'f1-score': 0.407852672620872, 'support': 744363}, '1': {'precision': 0.6798533843698409, 'recall': 0.27872990368015943, 'f1-score': 0.3953656833044057, 'support': 2133413}, '2': {'precision': 0.29197538970199044, 'recall': 0.4907608268809429, 'f1-score': 0.3661261115643097, 'support': 738486}, 'accuracy': 0.3912374158730756, 'macro avg': {'precision': 0.42564333404636107, 'recall': 0.461482470547593, 'f1-score': 0.3897814891631958, 'support': 3616262}, 'weighted avg': {'precision': 0.5235057225875513, 'recall': 0.3912374158730756, 'f1-score': 0.39196488946051833, 'support': 3616262}}
[[457751 130885 155727]
 [815645 594646 723122]
 [226929 149137 362420]]
Evaluating performance on  train set...
4550/4550 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0230237
{'0': {'precision': 0.3371223676917326, 'recall': 0.5734253723707482, 'f1-score': 0.42461149640517476, 'support': 273652}, '1': {'precision': 0.6368728762443939, 'recall': 0.3455600019441699, 'f1-score': 0.44802611402620646, 'support': 617230}, '2': {'precision': 0.345571398333622, 'recall': 0.46003388602439355, 'f1-score': 0.39467107865605955, 'support': 273269}, 'accuracy': 0.42599456599702273, 'macro avg': {'precision': 0.4398555474232495, 'recall': 0.45967308677977053, 'f1-score': 0.42243622969581357, 'support': 1164151}, 'weighted avg': {'precision': 0.49803264870204617, 'recall': 0.42599456599702273, 'f1-score': 0.4299977533566754, 'support': 1164151}}
[[156919  56307  60426]
 [226296 213290 177644]
 [ 82251  65305 125713]]
Evaluating performance on  val set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0369447
{'0': {'precision': 0.31792933947772656, 'recall': 0.5703970721167626, 'f1-score': 0.40828677839851024, 'support': 90714}, '1': {'precision': 0.6146405699344424, 'recall': 0.29655311115885125, 'f1-score': 0.400076464621238, 'support': 218777}, '2': {'precision': 0.315399278217695, 'recall': 0.457298289309825, 'f1-score': 0.3733195403733908, 'support': 91542}, 'accuracy': 0.39518942331429086, 'macro avg': {'precision': 0.41598972920995464, 'recall': 0.4414161575284796, 'f1-score': 0.39389426113104636, 'support': 401033}, 'weighted avg': {'precision': 0.4792177770820212, 'recall': 0.39518942331429086, 'f1-score': 0.39582596165638245, 'support': 401033}}
[[51743 20189 18782]
 [81815 64879 72083]
 [29192 20488 41862]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0822085
{'0': {'precision': 0.41998355263157894, 'recall': 0.37376269325770745, 'f1-score': 0.39552737305774727, 'support': 54655}, '1': {'precision': 0.39715506021667, 'recall': 0.3804657043514909, 'f1-score': 0.38863128817298803, 'support': 56946}, '2': {'precision': 0.3954091137354004, 'recall': 0.45775744050409767, 'f1-score': 0.42430510890538353, 'support': 53323}, 'accuracy': 0.4032342169726662, 'macro avg': {'precision': 0.4041825755278831, 'recall': 0.40399527937109864, 'f1-score': 0.40282125671203967, 'support': 164924}, 'weighted avg': {'precision': 0.4041558129798586, 'recall': 0.4032342169726662, 'f1-score': 0.4024506271551255, 'support': 164924}}
[[20428 16790 17437]
 [15395 21666 19885]
 [12817 16097 24409]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0983727
{'0': {'precision': 0.4121848190567435, 'recall': 0.5007671551769748, 'f1-score': 0.4521784827059049, 'support': 18901}, '1': {'precision': 0.4052198838349551, 'recall': 0.28433811464563596, 'f1-score': 0.33418351477449454, 'support': 18893}, '2': {'precision': 0.4045094105283271, 'recall': 0.43739669421487604, 'f1-score': 0.42031071623566785, 'support': 19360}, 'accuracy': 0.40775798719249745, 'macro avg': {'precision': 0.40730470447334194, 'recall': 0.40750065467916224, 'f1-score': 0.4022242379053558, 'support': 57154}, 'weighted avg': {'precision': 0.4072825474702335, 'recall': 0.40775798719249745, 'f1-score': 0.4023790130626267, 'support': 57154}}
[[9465 3854 5582]
 [6637 5372 6884]
 [6861 4031 8468]]
Evaluating performance on  val set...
68/68 - 1s - 582ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1242872
{'0': {'precision': 0.40606060606060607, 'recall': 0.5712136409227683, 'f1-score': 0.4746822254636382, 'support': 5982}, '1': {'precision': 0.3348380244291025, 'recall': 0.2396427213987077, 'f1-score': 0.2793531236154187, 'support': 5262}, '2': {'precision': 0.41020569620253167, 'recall': 0.34607041548473216, 'f1-score': 0.3754185899176396, 'support': 5993}, 'accuracy': 0.3917154957359169, 'macro avg': {'precision': 0.3837014422307467, 'recall': 0.3856422592687361, 'f1-score': 0.37648464633223216, 'support': 17237}, 'weighted avg': {'precision': 0.38575941099624383, 'recall': 0.3917154957359169, 'f1-score': 0.3805412089437971, 'support': 17237}}
[[3417 1191 1374]
 [2393 1261 1608]
 [2605 1314 2074]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0423478
{'0': {'precision': 0.20285904846598488, 'recall': 0.6615864269141531, 'f1-score': 0.3105084053630981, 'support': 68960}, '1': {'precision': 0.851060216684969, 'recall': 0.17842774714646148, 'f1-score': 0.29500637692534093, 'support': 421319}, '2': {'precision': 0.19840195625416585, 'recall': 0.7187893512688701, 'f1-score': 0.3109693959301394, 'support': 67501}, 'accuracy': 0.30355516511886405, 'macro avg': {'precision': 0.41744040713503994, 'recall': 0.5196011751098283, 'f1-score': 0.3054947260728595, 'support': 557780}, 'weighted avg': {'precision': 0.6919382729119388, 'recall': 0.30355516511886405, 'f1-score': 0.29885473941039, 'support': 557780}}
[[ 45623   7521  15816]
 [165930  75175 180214]
 [ 13347   5635  48519]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99939865
{'0': {'precision': 0.2556423611111111, 'recall': 0.6329145313274922, 'f1-score': 0.36418549346016643, 'support': 24196}, '1': {'precision': 0.8153143139434358, 'recall': 0.30397745586488256, 'f1-score': 0.44284640978855855, 'support': 108587}, '2': {'precision': 0.23988500476207272, 'recall': 0.5596198156682027, 'f1-score': 0.33581886866990934, 'support': 24304}, 'accuracy': 0.3941955731537301, 'macro avg': {'precision': 0.43694722660553986, 'recall': 0.4988372676201925, 'f1-score': 0.3809502573062114, 'support': 157087}, 'weighted avg': {'precision': 0.640079848321998, 'recall': 0.3941955731537301, 'f1-score': 0.4141713641716111, 'support': 157087}}
[[15314  3544  5338]
 [37820 33008 37759]
 [ 6770  3933 13601]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9599149
{'0': {'precision': 0.22365283738674296, 'recall': 0.6250555308751666, 'f1-score': 0.3294310465933037, 'support': 6753}, '1': {'precision': 0.8269491634907306, 'recall': 0.36544774628186466, 'f1-score': 0.5068894520114032, 'support': 35031}, '2': {'precision': 0.28185273827960017, 'recall': 0.5909090909090909, 'f1-score': 0.3816604708798017, 'support': 6776}, 'accuracy': 0.4330107084019769, 'macro avg': {'precision': 0.4441515797190245, 'recall': 0.5271374560220408, 'f1-score': 0.40599365649483615, 'support': 48560}, 'weighted avg': {'precision': 0.6669896604550871, 'recall': 0.4330107084019769, 'f1-score': 0.46473689459920886, 'support': 48560}}
[[ 4221  1241  1291]
 [13318 12802  8911]
 [ 1334  1438  4004]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0590641
{'0': {'precision': 0.3596522235666798, 'recall': 0.6903404271976409, 'f1-score': 0.47292229993966345, 'support': 76639}, '1': {'precision': 0.5685171931976962, 'recall': 0.22991420597457188, 'f1-score': 0.3274174317103449, 'support': 145115}, '2': {'precision': 0.32487918752931677, 'recall': 0.3933746318139191, 'f1-score': 0.35586091528259045, 'support': 75709}, 'accuracy': 0.3901426395887892, 'macro avg': {'precision': 0.4176828680978976, 'recall': 0.43787642166204394, 'f1-score': 0.3854002156441996, 'support': 297463}, 'weighted avg': {'precision': 0.4526950836287791, 'recall': 0.3901426395887892, 'f1-score': 0.37214492821914724, 'support': 297463}}
[[52907 11299 12433]
 [62295 33364 49456]
 [31904 14023 29782]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0858706
{'0': {'precision': 0.4219162182125145, 'recall': 0.5763811308515622, 'f1-score': 0.4871986231475699, 'support': 27749}, '1': {'precision': 0.40885370858985637, 'recall': 0.25016144076917557, 'f1-score': 0.3104008546818313, 'support': 27874}, '2': {'precision': 0.4314616164086795, 'recall': 0.441646696949104, 'f1-score': 0.4364947506097776, 'support': 27959}, 'accuracy': 0.4225192026991457, 'macro avg': {'precision': 0.42074384773701684, 'recall': 0.42272975618994724, 'f1-score': 0.4113647428130596, 'support': 83582}, 'weighted avg': {'precision': 0.42075299401286154, 'recall': 0.4225192026991457, 'f1-score': 0.4112768867629639, 'support': 83582}}
[[15994  4877  6878]
 [11508  6973  9393]
 [10406  5205 12348]]
Evaluating performance on  val set...
125/125 - 1s - 875ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.064029
{'0': {'precision': 0.4130291549991764, 'recall': 0.5103806228373703, 'f1-score': 0.45657319737800445, 'support': 9826}, '1': {'precision': 0.46273969456883685, 'recall': 0.3368720220680431, 'f1-score': 0.38989938080495357, 'support': 11963}, '2': {'precision': 0.4387167534960241, 'recall': 0.4798560431870439, 'f1-score': 0.45836516424751717, 'support': 10003}, 'accuracy': 0.4354869149471565, 'macro avg': {'precision': 0.4381618676880124, 'recall': 0.44236956269748573, 'f1-score': 0.43494591414349176, 'support': 31792}, 'weighted avg': {'precision': 0.4398170334791656, 'recall': 0.4354869149471565, 'f1-score': 0.4320483539246932, 'support': 31792}}
[[5015 2341 2470]
 [4262 4030 3671]
 [2865 2338 4800]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1409713
{'0': {'precision': 0.3602255504741987, 'recall': 0.5217403807442342, 'f1-score': 0.4261938226991727, 'support': 104322}, '1': {'precision': 0.3426265325653202, 'recall': 0.17581328119932918, 'f1-score': 0.23238298185024617, 'support': 107927}, '2': {'precision': 0.37099150673361175, 'recall': 0.3922348785521511, 'f1-score': 0.3813175524141624, 'support': 100784}, 'accuracy': 0.36077665932984704, 'macro avg': {'precision': 0.3579478632577102, 'recall': 0.3632628468319048, 'f1-score': 0.34663145232119374, 'support': 313033}, 'weighted avg': {'precision': 0.35762399386450316, 'recall': 0.36077665932984704, 'f1-score': 0.3449236925700599, 'support': 313033}}
[[54429 18696 31197]
 [53125 18975 35827]
 [43543 17710 39531]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1441878
{'0': {'precision': 0.39292648125190055, 'recall': 0.5338630224058478, 'f1-score': 0.45267866767273907, 'support': 31465}, '1': {'precision': 0.34448818897637795, 'recall': 0.21515201860774216, 'f1-score': 0.26487492585547445, 'support': 30095}, '2': {'precision': 0.38052356722013925, 'recall': 0.3806892394252989, 'f1-score': 0.38060638529406843, 'support': 29859}, 'accuracy': 0.37891466762926745, 'macro avg': {'precision': 0.37264607914947256, 'recall': 0.3765680934796296, 'f1-score': 0.366053326274094, 'support': 91419}, 'weighted avg': {'precision': 0.37292966422145596, 'recall': 0.37891466762926745, 'f1-score': 0.3673139197588995, 'support': 91419}}
[[16798  6166  8501]
 [13616  6475 10004]
 [12337  6155 11367]]
Evaluating performance on  val set...
99/99 - 1s - 710ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1566179
{'0': {'precision': 0.38102853295177175, 'recall': 0.5258450458822163, 'f1-score': 0.4418740849194729, 'support': 8609}, '1': {'precision': 0.3331196581196581, 'recall': 0.18798987097552153, 'f1-score': 0.2403453326138904, 'support': 8293}, '2': {'precision': 0.3785213291939749, 'recall': 0.39396840593585447, 'f1-score': 0.3860904239723216, 'support': 8356}, 'accuracy': 0.371288304695542, 'macro avg': {'precision': 0.36422317342180155, 'recall': 0.3692677742645308, 'f1-score': 0.35610328050189494, 'support': 25258}, 'weighted avg': {'precision': 0.36446908669383893, 'recall': 0.371288304695542, 'f1-score': 0.35725114510853806, 'support': 25258}}
[[4527 1529 2553]
 [3882 1559 2852]
 [3472 1592 3292]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.097427
{'0': {'precision': 0.3912176585114119, 'recall': 0.5562624552860442, 'f1-score': 0.4593651985002737, 'support': 119929}, '1': {'precision': 0.41732080638819974, 'recall': 0.24142934454387877, 'f1-score': 0.30589287488820427, 'support': 127499}, '2': {'precision': 0.4176954732510288, 'recall': 0.42847756634006523, 'f1-score': 0.42301782608519384, 'support': 121759}, 'accuracy': 0.40539076403015273, 'macro avg': {'precision': 0.4087446460502135, 'recall': 0.4087231220566627, 'f1-score': 0.3960919664912239, 'support': 369187}, 'weighted avg': {'precision': 0.4089648638464416, 'recall': 0.40539076403015273, 'f1-score': 0.3943759450701612, 'support': 369187}}
[[66712 20468 32749]
 [56735 30782 39982]
 [47077 22511 52171]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1114963
{'0': {'precision': 0.39469888207717274, 'recall': 0.4733996539792388, 'f1-score': 0.4304818092428712, 'support': 41616}, '1': {'precision': 0.3643591896714601, 'recall': 0.33140006682896556, 'f1-score': 0.3470989675774317, 'support': 41898}, '2': {'precision': 0.4275672850796969, 'recall': 0.3825097012483052, 'f1-score': 0.4037854111144013, 'support': 42778}, 'accuracy': 0.3955040699331707, 'macro avg': {'precision': 0.39554178560944325, 'recall': 0.3957698073521698, 'f1-score': 0.39378872931156805, 'support': 126292}, 'weighted avg': {'precision': 0.3957668207528405, 'recall': 0.3955040699331707, 'f1-score': 0.3937764532485226, 'support': 126292}}
[[19701 11936  9979]
 [16085 13885 11928]
 [14128 12287 16363]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1102765
{'0': {'precision': 0.3987150020894275, 'recall': 0.5970744680851063, 'f1-score': 0.4781383112002005, 'support': 12784}, '1': {'precision': 0.3832153690596562, 'recall': 0.4064343163538874, 'f1-score': 0.39448347645068954, 'support': 13055}, '2': {'precision': 0.4488173710740597, 'recall': 0.188073767162239, 'f1-score': 0.265071277265701, 'support': 12309}, 'accuracy': 0.3998636887910244, 'macro avg': {'precision': 0.41024924740771446, 'recall': 0.3971941838670776, 'f1-score': 0.3792310216388637, 'support': 38148}, 'weighted avg': {'precision': 0.4095769699679053, 'recall': 0.3998636887910244, 'f1-score': 0.38076083431138275, 'support': 38148}}
[[7633 4018 1133]
 [6039 5306 1710]
 [5472 4522 2315]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
5521/5521 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9800167
{'0': {'precision': 0.2239795213867675, 'recall': 0.715865112594772, 'f1-score': 0.34120347023146563, 'support': 176740}, '1': {'precision': 0.8375732672669044, 'recall': 0.26313641290832085, 'f1-score': 0.400461682251091, 'support': 1053522}, '2': {'precision': 0.2535385198126189, 'recall': 0.7167136488789826, 'f1-score': 0.37457173202987604, 'support': 183048}, 'accuracy': 0.3784979940706568, 'macro avg': {'precision': 0.43836376948876365, 'recall': 0.5652383914606918, 'f1-score': 0.3720789615041442, 'support': 1413310}, 'weighted avg': {'precision': 0.6851983805832558, 'recall': 0.3784979940706568, 'f1-score': 0.38969801398267045, 'support': 1413310}}
[[126522  24176  26042]
 [416089 277220 360213]
 [ 22271  29584 131193]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99094486
{'0': {'precision': 0.23915045116935732, 'recall': 0.6878531073446328, 'f1-score': 0.3549077658847643, 'support': 45312}, '1': {'precision': 0.8262940131067422, 'recall': 0.2491824831576876, 'f1-score': 0.3828963156692627, 'support': 238833}, '2': {'precision': 0.24494025655921745, 'recall': 0.6844356696281672, 'f1-score': 0.3607708006914774, 'support': 45585}, 'accuracy': 0.36963879537803657, 'macro avg': {'precision': 0.43679490694510564, 'recall': 0.5404904200434958, 'f1-score': 0.36619162741516814, 'support': 329730}, 'weighted avg': {'precision': 0.6652359957266867, 'recall': 0.36963879537803657, 'f1-score': 0.37599124555705715, 'support': 329730}}
[[31168  5795  8349]
 [91491 59513 87829]
 [ 7669  6716 31200]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0058455
{'0': {'precision': 0.21071743419671718, 'recall': 0.7303215480867161, 'f1-score': 0.3270671792532743, 'support': 13746}, '1': {'precision': 0.8369781312127237, 'recall': 0.19873958505440556, 'f1-score': 0.32120853758559526, 'support': 84734}, '2': {'precision': 0.22578308890095963, 'recall': 0.7408287538987078, 'f1-score': 0.34608846487424116, 'support': 13466}, 'accuracy': 0.3292212316652672, 'macro avg': {'precision': 0.42449288477013347, 'recall': 0.5566299623466099, 'f1-score': 0.3314547272377036, 'support': 111946}, 'weighted avg': {'precision': 0.6865580002482208, 'recall': 0.3292212316652672, 'f1-score': 0.3249207380146666, 'support': 111946}}
[[10039  1691  2016]
 [35702 16840 32192]
 [ 1901  1589  9976]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
5918/5918 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0141684
{'0': {'precision': 0.21077749711379043, 'recall': 0.6793896119884055, 'f1-score': 0.32173743674814925, 'support': 178706}, '1': {'precision': 0.8523504582149678, 'recall': 0.2289905639713073, 'f1-score': 0.36099659242230303, 'support': 1159598}, '2': {'precision': 0.19667292472165468, 'recall': 0.6983656283955089, 'f1-score': 0.3069132836418533, 'support': 176704}, 'accuracy': 0.3368642277796553, 'macro avg': {'precision': 0.419933626683471, 'recall': 0.5355819347850739, 'f1-score': 0.32988243760410185, 'support': 1515008}, 'weighted avg': {'precision': 0.7001969511279099, 'recall': 0.3368642277796553, 'f1-score': 0.35005765106447123, 'support': 1515008}}
[[121411  22310  34985]
 [424992 265537 469069]
 [ 29612  23688 123404]]
Evaluating performance on  train set...
1814/1814 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97203976
{'0': {'precision': 0.24036135816368856, 'recall': 0.6963558330081935, 'f1-score': 0.3573694074679225, 'support': 64075}, '1': {'precision': 0.800479643986175, 'recall': 0.37132862556591373, 'f1-score': 0.5073202053924667, 'support': 336182}, '2': {'precision': 0.2291417068061974, 'recall': 0.4391459185904845, 'f1-score': 0.3011477139444834, 'support': 64022}, 'accuracy': 0.4255372308461076, 'macro avg': {'precision': 0.4233275696520203, 'recall': 0.5022767923881972, 'f1-score': 0.38861244226829084, 'support': 464279}, 'weighted avg': {'precision': 0.6443929448716074, 'recall': 0.4255372308461076, 'f1-score': 0.45819527700996826, 'support': 464279}}
[[ 44619  12772   6684]
 [123450 124834  87898]
 [ 17564  18343  28115]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.002931
{'0': {'precision': 0.19194185211773152, 'recall': 0.7069905800694101, 'f1-score': 0.30191608737076114, 'support': 18153}, '1': {'precision': 0.8539471149877556, 'recall': 0.24511894607146242, 'f1-score': 0.38090270320027003, 'support': 126612}, '2': {'precision': 0.1835503654540872, 'recall': 0.608342150693323, 'f1-score': 0.28201156546881456, 'support': 17957}, 'accuracy': 0.33672767050552477, 'macro avg': {'precision': 0.40981311085319144, 'recall': 0.5201505589447318, 'f1-score': 0.3216101186799486, 'support': 162722}, 'weighted avg': {'precision': 0.7061140256190431, 'recall': 0.33672767050552477, 'f1-score': 0.3611780673342112, 'support': 162722}}
[[12834  2484  2835]
 [49821 31035 45756]
 [ 4209  2824 10924]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
3755/3755 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0528487
{'0': {'precision': 0.39414940282503447, 'recall': 0.5906716288129109, 'f1-score': 0.472802392075415, 'support': 287510}, '1': {'precision': 0.5286959401605842, 'recall': 0.3277286098766978, 'f1-score': 0.40463292536100065, 'support': 399425}, '2': {'precision': 0.39765126191613165, 'recall': 0.4099435506221101, 'f1-score': 0.4037038566578026, 'support': 274228}, 'accuracy': 0.4298386433934723, 'macro avg': {'precision': 0.44016553496725014, 'recall': 0.44278126310390625, 'f1-score': 0.4270463913647394, 'support': 961163}, 'weighted avg': {'precision': 0.4510612465914771, 'recall': 0.42983864339347233, 'f1-score': 0.4247591960588123, 'support': 961163}}
[[169824  64086  53600]
 [151835 130903 116687]
 [109203  52607 112418]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0697256
{'0': {'precision': 0.435143363989784, 'recall': 0.5552763819095478, 'f1-score': 0.4879241024194117, 'support': 124574}, '1': {'precision': 0.4378735164557672, 'recall': 0.43347082187595476, 'f1-score': 0.4356610462844062, 'support': 144012}, '2': {'precision': 0.4295815821116149, 'recall': 0.31507747077147136, 'f1-score': 0.3635260401594429, 'support': 123595}, 'accuracy': 0.4348502349680377, 'macro avg': {'precision': 0.43419948751905535, 'recall': 0.43460822485232464, 'f1-score': 0.4290370629544203, 'support': 392181}, 'weighted avg': {'precision': 0.4343931141961909, 'recall': 0.4348502349680377, 'f1-score': 0.4295289079935337, 'support': 392181}}
[[69173 36338 19063]
 [48941 62425 32646]
 [40852 43801 38942]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0595291
{'0': {'precision': 0.43624997219070505, 'recall': 0.5191274190559394, 'f1-score': 0.4740939532409758, 'support': 37773}, '1': {'precision': 0.41777193044838745, 'recall': 0.5321466585139389, 'f1-score': 0.46807366313755566, 'support': 44157}, '2': {'precision': 0.4556300857708379, 'recall': 0.22126398419352256, 'f1-score': 0.29787386998795856, 'support': 37453}, 'accuracy': 0.4304968044026369, 'macro avg': {'precision': 0.4365506628033102, 'recall': 0.42417935392113365, 'f1-score': 0.4133471621221634, 'support': 119383}, 'weighted avg': {'precision': 0.4354953296092755, 'recall': 0.4304968044026369, 'f1-score': 0.4165831792767432, 'support': 119383}}
[[19609 14506  3658]
 [14416 23498  6243]
 [10924 18242  8287]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
4960/4960 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0065377
{'0': {'precision': 0.3519020132641106, 'recall': 0.624712976332076, 'f1-score': 0.45020352221784204, 'support': 314434}, '1': {'precision': 0.6466551539712148, 'recall': 0.37721709571520595, 'f1-score': 0.4764840128932076, 'support': 644255}, '2': {'precision': 0.3943574695008416, 'recall': 0.42564575823737666, 'f1-score': 0.40940469121140144, 'support': 310991}, 'accuracy': 0.4503709596118707, 'macro avg': {'precision': 0.46430487891205563, 'recall': 0.4758586100948862, 'f1-score': 0.445364075440817, 'support': 1269680}, 'weighted avg': {'precision': 0.5118631447750209, 'recall': 0.4503709596118707, 'f1-score': 0.4535455204115079, 'support': 1269680}}
[[196431  59878  58125]
 [256063 243024 145168]
 [105704  72915 132372]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0297643
{'0': {'precision': 0.39709880528588437, 'recall': 0.5526374360115736, 'f1-score': 0.4621318131371968, 'support': 121311}, '1': {'precision': 0.5620104556719306, 'recall': 0.3229859187142315, 'f1-score': 0.41021967683903016, 'support': 192383}, '2': {'precision': 0.39447395001792057, 'recall': 0.5080486781368023, 'f1-score': 0.444115111608371, 'support': 119150}, 'accuracy': 0.43829185572631246, 'macro avg': {'precision': 0.4511944036585785, 'recall': 0.46122401095420246, 'f1-score': 0.43882220052819937, 'support': 432844}, 'weighted avg': {'precision': 0.469673327587316, 'recall': 0.43829185572631246, 'f1-score': 0.43409930603392227, 'support': 432844}}
[[67041 22919 31351]
 [68676 62137 61570]
 [33110 25506 60534]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401999
{'0': {'precision': 0.40449718036753063, 'recall': 0.5171370738474834, 'f1-score': 0.453933840410453, 'support': 43969}, '1': {'precision': 0.5413875988891741, 'recall': 0.37487274783873314, 'f1-score': 0.44299954170485795, 'support': 61885}, '2': {'precision': 0.4170347608987901, 'recall': 0.47957155477031804, 'f1-score': 0.44612223934257833, 'support': 45280}, 'accuracy': 0.447629256156788, 'macro avg': {'precision': 0.4543065133851649, 'recall': 0.4571937921521782, 'f1-score': 0.44768520715262977, 'support': 151134}, 'weighted avg': {'precision': 0.46430612604929206, 'recall': 0.447629256156788, 'f1-score': 0.44711619268228386, 'support': 151134}}
[[22738 10155 11076]
 [19407 23199 19279]
 [14068  9497 21715]]
testing model on single stock: results/universal/W8/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
10609/10609 - 61s - 61s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1154304
{'0': {'precision': 0.3882140805203995, 'recall': 0.5343473933823981, 'f1-score': 0.4497070122012838, 'support': 895279}, '1': {'precision': 0.35786824187883215, 'recall': 0.49065500014542135, 'f1-score': 0.41387161500069125, 'support': 893954}, '2': {'precision': 0.45224894565516816, 'recall': 0.1258180428712212, 'f1-score': 0.19686672431497595, 'support': 926449}, 'accuracy': 0.3805957398546663, 'macro avg': {'precision': 0.39944375601813326, 'recall': 0.38360681213301356, 'f1-score': 0.35348178383898365, 'support': 2715682}, 'weighted avg': {'precision': 0.40007012733746333, 'recall': 0.3805957398546663, 'f1-score': 0.3516547260569412, 'support': 2715682}}
[[478390 355625  61264]
 [375416 438623  79915]
 [378478 431407 116564]]
Evaluating performance on  train set...
3903/3903 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1435543
{'0': {'precision': 0.3886397543543127, 'recall': 0.5364289947381339, 'f1-score': 0.45072894949286646, 'support': 334102}, '1': {'precision': 0.3500559059935444, 'recall': 0.5545704519559438, 'f1-score': 0.42919523688591665, 'support': 329125}, '2': {'precision': 0.47575757575757577, 'recall': 0.02337450422229898, 'f1-score': 0.04455973843149721, 'support': 335836}, 'accuracy': 0.36994163531228763, 'macro avg': {'precision': 0.40481774536847764, 'recall': 0.3714579836387923, 'f1-score': 0.3081613082700934, 'support': 999063}, 'weighted avg': {'precision': 0.40521367569565797, 'recall': 0.36994163531228763, 'f1-score': 0.30710084362990453, 'support': 999063}}
[[179222 150862   4018]
 [141970 182523   4632]
 [139960 188026   7850]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1456211
{'0': {'precision': 0.3907176132103884, 'recall': 0.6166565533980582, 'f1-score': 0.47834972287488386, 'support': 98880}, '1': {'precision': 0.35458113309880906, 'recall': 0.49303460700519525, 'f1-score': 0.41250005477099155, 'support': 95472}, '2': {'precision': 0.4724038713052576, 'recall': 0.018375881401288142, 'f1-score': 0.035375695369427244, 'support': 98281}, 'accuracy': 0.3753917022345395, 'macro avg': {'precision': 0.4059008725381517, 'recall': 0.37602234726818057, 'f1-score': 0.3087418243384342, 'support': 292633}, 'weighted avg': {'precision': 0.406362414386637, 'recall': 0.3753917022345395, 'f1-score': 0.3080930193914128, 'support': 292633}}
[[60975 37042   863]
 [47247 47071  1154]
 [47837 48638  1806]]
training model: results/universal/W8/deepLOB_L1/h30
Epoch 1/50
7696/7696 - 121s - loss: 3.0369 - accuracy30: 0.4619 - val_loss: 3.4738 - val_accuracy30: 0.3869 - 121s/epoch - 16ms/step
Epoch 2/50
7696/7696 - 120s - loss: 2.9783 - accuracy30: 0.4813 - val_loss: 3.6164 - val_accuracy30: 0.4155 - 120s/epoch - 16ms/step
Epoch 3/50
7696/7696 - 123s - loss: 2.9535 - accuracy30: 0.4893 - val_loss: 3.5421 - val_accuracy30: 0.4091 - 123s/epoch - 16ms/step
Epoch 4/50
7696/7696 - 122s - loss: 2.9264 - accuracy30: 0.4954 - val_loss: 3.5379 - val_accuracy30: 0.4085 - 122s/epoch - 16ms/step
Epoch 5/50
7696/7696 - 122s - loss: 2.9119 - accuracy30: 0.4984 - val_loss: 3.5990 - val_accuracy30: 0.4064 - 122s/epoch - 16ms/step
Epoch 6/50
7696/7696 - 122s - loss: 2.8996 - accuracy30: 0.5010 - val_loss: 3.5850 - val_accuracy30: 0.4080 - 122s/epoch - 16ms/step
Epoch 7/50
7696/7696 - 124s - loss: 2.8915 - accuracy30: 0.5028 - val_loss: 3.4846 - val_accuracy30: 0.4146 - 124s/epoch - 16ms/step
Epoch 8/50
7696/7696 - 122s - loss: 2.8863 - accuracy30: 0.5036 - val_loss: 3.5778 - val_accuracy30: 0.4047 - 122s/epoch - 16ms/step
Epoch 9/50
7696/7696 - 119s - loss: 2.8804 - accuracy30: 0.5047 - val_loss: 3.5371 - val_accuracy30: 0.4094 - 119s/epoch - 15ms/step
Epoch 10/50
7696/7696 - 121s - loss: 2.8756 - accuracy30: 0.5057 - val_loss: 3.5876 - val_accuracy30: 0.4102 - 121s/epoch - 16ms/step
Epoch 11/50
7696/7696 - 122s - loss: 2.8713 - accuracy30: 0.5065 - val_loss: 3.5940 - val_accuracy30: 0.4116 - 122s/epoch - 16ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 147s - 147s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1072466
{'0': {'precision': 0.37466197524150424, 'recall': 0.16937669708163117, 'f1-score': 0.23328859184772793, 'support': 1635160}, '1': {'precision': 0.4114674431824821, 'recall': 0.6072564565001352, 'f1-score': 0.4905475597264586, 'support': 2667583}, '2': {'precision': 0.33117379917421946, 'recall': 0.25660389874715434, 'f1-score': 0.2891585996935173, 'support': 1658225}, 'accuracy': 0.38959645480398486, 'macro avg': {'precision': 0.37243440586606863, 'recall': 0.3444123507763069, 'f1-score': 0.3376649170892346, 'support': 5960968}, 'weighted avg': {'precision': 0.37903516762019573, 'recall': 0.38959645480398486, 'f1-score': 0.36395607623464826, 'support': 5960968}}
[[ 276958 1186167  172035]
 [ 360373 1619907  687303]
 [ 101890 1130828  425507]]
Evaluating performance on  train set...
7696/7696 - 46s - 46s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1352141
{'0': {'precision': 0.39755011540628465, 'recall': 0.1883914929972423, 'f1-score': 0.2556400115932273, 'support': 580557}, '1': {'precision': 0.3911869964960618, 'recall': 0.6460945093374157, 'f1-score': 0.48731953503251857, 'support': 808682}, '2': {'precision': 0.3475921667015123, 'recall': 0.21489346668022424, 'f1-score': 0.26559002136392584, 'support': 580241}, 'accuracy': 0.38413540630014015, 'macro avg': {'precision': 0.37877642620128626, 'recall': 0.3497931563382941, 'f1-score': 0.33618318932989055, 'support': 1969480}, 'weighted avg': {'precision': 0.38021894685369073, 'recall': 0.38413540630014015, 'f1-score': 0.35370064891541025, 'support': 1969480}}
[[109372 409627  61558]
 [113720 522485 172477]
 [ 52023 403528 124690]]
Evaluating performance on  val set...
2338/2338 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1180608
{'0': {'precision': 0.37989117674081485, 'recall': 0.21463259891567654, 'f1-score': 0.2742935906271537, 'support': 173380}, '1': {'precision': 0.3972361625567511, 'recall': 0.6226009258857285, 'f1-score': 0.4850178629624847, 'support': 253379}, '2': {'precision': 0.35421738368356476, 'recall': 0.212699025265903, 'f1-score': 0.2657947134793489, 'support': 171021}, 'accuracy': 0.38700357991234235, 'macro avg': {'precision': 0.37711490766037686, 'recall': 0.34997751668910265, 'f1-score': 0.3417020556896624, 'support': 597780}, 'weighted avg': {'precision': 0.3798980310996294, 'recall': 0.38700357991234235, 'f1-score': 0.36118110598624753, 'support': 597780}}
[[ 37213 120369  15798]
 [ 45105 157754  50520]
 [ 15639 119006  36376]]
testing model out of sample: results/universal/W8/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 89s - 89s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0054233
{'0': {'precision': 0.39050519269051287, 'recall': 0.4054720248517913, 'f1-score': 0.39784789741660137, 'support': 829236}, '1': {'precision': 0.6180717976890105, 'recall': 0.461052683084959, 'f1-score': 0.5281386267120559, 'support': 1961958}, '2': {'precision': 0.3256685878850985, 'recall': 0.509862217417231, 'f1-score': 0.3974625646558953, 'support': 825068}, 'accuracy': 0.4594437571171558, 'macro avg': {'precision': 0.4447485260882073, 'recall': 0.4587956417846604, 'f1-score': 0.44114969626151757, 'support': 3616262}, 'weighted avg': {'precision': 0.499175834739139, 'recall': 0.4594437571171558, 'f1-score': 0.4684475975867885, 'support': 3616262}}
[[336232 296761 196243]
 [382591 904566 674801]
 [142195 262202 420671]]
Evaluating performance on  train set...
4550/4550 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0301703
{'0': {'precision': 0.4086927858353739, 'recall': 0.31690217986635993, 'f1-score': 0.35699154721016807, 'support': 301257}, '1': {'precision': 0.5541082821034734, 'recall': 0.5256939114863136, 'f1-score': 0.5395272429250078, 'support': 562896}, '2': {'precision': 0.3731602626827128, 'recall': 0.4932266215108101, 'f1-score': 0.4248738733306342, 'support': 299998}, 'accuracy': 0.4632964280406923, 'macro avg': {'precision': 0.44532044354052003, 'recall': 0.4452742376211612, 'f1-score': 0.44046422115527006, 'support': 1164151}, 'weighted avg': {'precision': 0.4698481817475675, 'recall': 0.4632964280406923, 'f1-score': 0.462745160827807, 'support': 1164151}}
[[ 95469 127239  78549]
 [ 96977 295911 170008]
 [ 41150 110881 147967]]
Evaluating performance on  val set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0437351
{'0': {'precision': 0.3778924497555676, 'recall': 0.27887120695875256, 'f1-score': 0.32091703761791635, 'support': 99788}, '1': {'precision': 0.5217930509242106, 'recall': 0.5053576412423747, 'f1-score': 0.5134438548164951, 'support': 200648}, '2': {'precision': 0.3447713523465975, 'recall': 0.4560473970396732, 'f1-score': 0.3926783131189496, 'support': 100597}, 'accuracy': 0.4366323968351732, 'macro avg': {'precision': 0.4148189510087919, 'recall': 0.4134254150802668, 'f1-score': 0.409013068517787, 'support': 401033}, 'weighted avg': {'precision': 0.4415816842755091, 'recall': 0.4366323968351732, 'f1-score': 0.4352445115386109, 'support': 401033}}
[[ 27828  49767  22193]
 [ 34254 101399  64995]
 [ 11558  43162  45877]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1756535
{'0': {'precision': 0.4469437652811736, 'recall': 0.01682900333265821, 'f1-score': 0.032436652707786215, 'support': 54311}, '1': {'precision': 0.3608875883930749, 'recall': 0.6660781360890412, 'f1-score': 0.4681350632919092, 'support': 57771}, '2': {'precision': 0.383304001564361, 'recall': 0.4080466295749593, 'f1-score': 0.39528851001420773, 'support': 52842}, 'accuracy': 0.3696005432805413, 'macro avg': {'precision': 0.3970451184128698, 'recall': 0.36365125633221956, 'f1-score': 0.2986200753379677, 'support': 164924}, 'weighted avg': {'precision': 0.39640895052209574, 'recall': 0.3696005432805413, 'f1-score': 0.3013153527250141, 'support': 164924}}
[[  914 37335 16062]
 [  662 38480 18629]
 [  469 30811 21562]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1720648
{'0': {'precision': 0.4136826783114993, 'recall': 0.22467587224623167, 'f1-score': 0.29119846989309744, 'support': 18974}, '1': {'precision': 0.35413515879964974, 'recall': 0.47282002231787024, 'f1-score': 0.4049607463875298, 'support': 18819}, '2': {'precision': 0.39989872485384154, 'recall': 0.4486855017819327, 'f1-score': 0.4228896894168046, 'support': 19361}, 'accuracy': 0.38226545823564406, 'macro avg': {'precision': 0.3892388539883302, 'recall': 0.38206046544867817, 'f1-score': 0.373016301899144, 'support': 57154}, 'weighted avg': {'precision': 0.38940623409784486, 'recall': 0.38226545823564406, 'f1-score': 0.37326737115192826, 'support': 57154}}
[[4263 8496 6215]
 [3100 8898 6821]
 [2942 7732 8687]]
Evaluating performance on  val set...
68/68 - 1s - 567ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1922033
{'0': {'precision': 0.41720683559222155, 'recall': 0.23674970740678816, 'f1-score': 0.30207999999999996, 'support': 5981}, '1': {'precision': 0.32973189275710285, 'recall': 0.45760829322473157, 'f1-score': 0.38328552600976823, 'support': 5402}, '2': {'precision': 0.39127009139615504, 'recall': 0.4241544243252477, 'f1-score': 0.4070491803278688, 'support': 5854}, 'accuracy': 0.36961188141788015, 'macro avg': {'precision': 0.3794029399151598, 'recall': 0.37283747498558917, 'f1-score': 0.36413823544587903, 'support': 17237}, 'weighted avg': {'precision': 0.3809839811674907, 'recall': 0.36961188141788015, 'f1-score': 0.36317890544434134, 'support': 17237}}
[[1416 2667 1898]
 [ 965 2472 1965]
 [1013 2358 2483]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
2179/2179 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9314956
{'0': {'precision': 0.3738504788678706, 'recall': 0.276287062469188, 'f1-score': 0.31774830414093347, 'support': 85194}, '1': {'precision': 0.7568012713449797, 'recall': 0.5033556530439467, 'f1-score': 0.6045916834477838, 'support': 389790}, '2': {'precision': 0.24668670351408947, 'recall': 0.7018575776607565, 'f1-score': 0.3650624132277093, 'support': 82796}, 'accuracy': 0.49813905123883967, 'macro avg': {'precision': 0.4591128179089799, 'recall': 0.49383343105796373, 'f1-score': 0.42913413360547553, 'support': 557780}, 'weighted avg': {'precision': 0.6225896546279565, 'recall': 0.49813905123883967, 'f1-score': 0.525224548889698, 'support': 557780}}
[[ 23538  41479  20177]
 [ 36309 196203 157278]
 [  3114  21571  58111]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9469526
{'0': {'precision': 0.3556163273574395, 'recall': 0.36238216472854884, 'f1-score': 0.3589673681519979, 'support': 29066}, '1': {'precision': 0.7220126542328559, 'recall': 0.48594028159896424, 'f1-score': 0.5809084478516109, 'support': 98864}, '2': {'precision': 0.29201201398348897, 'recall': 0.6102136708166135, 'f1-score': 0.3950003330151189, 'support': 29157}, 'accuracy': 0.4861446204969221, 'macro avg': {'precision': 0.45654699852459474, 'recall': 0.48617870571470884, 'f1-score': 0.4449587163395759, 'support': 157087}, 'weighted avg': {'precision': 0.574405250025559, 'recall': 0.4861446204969221, 'f1-score': 0.5053359158990207, 'support': 157087}}
[[10533 10518  8015]
 [15700 48042 35122]
 [ 3386  7979 17792]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89848965
{'0': {'precision': 0.32172786177105833, 'recall': 0.4611193660227836, 'f1-score': 0.3790137906467865, 'support': 8076}, '1': {'precision': 0.7719920927307036, 'recall': 0.529620268770805, 'f1-score': 0.6282402837190595, 'support': 32444}, '2': {'precision': 0.3260677666870374, 'recall': 0.5972636815920398, 'f1-score': 0.4218386260816093, 'support': 8040}, 'accuracy': 0.5294275123558484, 'macro avg': {'precision': 0.47326257372959973, 'recall': 0.5293344387952095, 'f1-score': 0.47636423348248513, 'support': 48560}, 'weighted avg': {'precision': 0.6232778112104982, 'recall': 0.5294275123558484, 'f1-score': 0.5526179096363417, 'support': 48560}}
[[ 3724  2681  1671]
 [ 7007 17183  8254]
 [  844  2394  4802]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
1162/1162 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1004741
{'0': {'precision': 0.38178742170644314, 'recall': 0.5070947054813543, 'f1-score': 0.4356086690126717, 'support': 79214}, '1': {'precision': 0.5029934302403245, 'recall': 0.29762802963346197, 'f1-score': 0.37397184828046987, 'support': 139167}, '2': {'precision': 0.319308845072473, 'recall': 0.44375458384967503, 'f1-score': 0.3713839722729317, 'support': 79082}, 'accuracy': 0.39225718828896367, 'macro avg': {'precision': 0.4013632323397469, 'recall': 0.4161591063214971, 'f1-score': 0.39365482985535777, 'support': 297463}, 'weighted avg': {'precision': 0.4218829824728815, 'recall': 0.39225718828896367, 'f1-score': 0.38969765184949356, 'support': 297463}}
[[40169 20059 18986]
 [41923 41420 55824]
 [23121 20868 35093]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1544107
{'0': {'precision': 0.43692105139417875, 'recall': 0.3299481570911157, 'f1-score': 0.3759736187258492, 'support': 28162}, '1': {'precision': 0.35700389105058367, 'recall': 0.365713231223473, 'f1-score': 0.3613060837541704, 'support': 27095}, '2': {'precision': 0.41013918226800544, 'recall': 0.5004060017652251, 'f1-score': 0.4507982952738375, 'support': 28325}, 'accuracy': 0.3993084635447824, 'macro avg': {'precision': 0.4013547082375893, 'recall': 0.3986891300266046, 'f1-score': 0.39602599925128573, 'support': 83582}, 'weighted avg': {'precision': 0.4019380179359154, 'recall': 0.3993084635447824, 'f1-score': 0.39657604631987825, 'support': 83582}}
[[ 9292  9291  9579]
 [ 6380  9909 10806]
 [ 5595  8556 14174]]
Evaluating performance on  val set...
125/125 - 1s - 928ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1351194
{'0': {'precision': 0.43563676329166096, 'recall': 0.3142092746730083, 'f1-score': 0.365091244027402, 'support': 10092}, '1': {'precision': 0.39434165767858625, 'recall': 0.412479389047991, 'f1-score': 0.4032066508313539, 'support': 11523}, '2': {'precision': 0.407223113964687, 'recall': 0.4985752186302447, 'f1-score': 0.44829261827980743, 'support': 10177}, 'accuracy': 0.40884499245093103, 'macro avg': {'precision': 0.4124005116449781, 'recall': 0.40842129411708133, 'f1-score': 0.40553017104618777, 'support': 31792}, 'weighted avg': {'precision': 0.41157381628675177, 'recall': 0.40884499245093103, 'f1-score': 0.4055399172272217, 'support': 31792}}
[[3171 3837 3084]
 [2468 4753 4302]
 [1640 3463 5074]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1223/1223 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2217734
{'0': {'precision': 0.370492778530588, 'recall': 0.31636579147891364, 'f1-score': 0.3412965819598929, 'support': 106301}, '1': {'precision': 0.3289730748252095, 'recall': 0.3120132435381316, 'f1-score': 0.32026878943379467, 'support': 106316}, '2': {'precision': 0.36137761782799543, 'recall': 0.43699211281070743, 'f1-score': 0.39560409839390925, 'support': 100416}, 'accuracy': 0.35358252963745035, 'macro avg': {'precision': 0.35361449039459764, 'recall': 0.35512371594258424, 'f1-score': 0.35238982326253226, 'support': 313033}, 'weighted avg': {'precision': 0.3534673633307447, 'recall': 0.35358252963745035, 'f1-score': 0.35157585852189605, 'support': 313033}}
[[33630 35218 37453]
 [33051 33172 40093]
 [24090 32445 43881]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2273103
{'0': {'precision': 0.402810992238305, 'recall': 0.3059884628868279, 'f1-score': 0.34778671303339853, 'support': 31377}, '1': {'precision': 0.3336465576645994, 'recall': 0.35464109734984683, 'f1-score': 0.3438236338400955, 'support': 30036}, '2': {'precision': 0.3765213977228111, 'recall': 0.44744384456442043, 'f1-score': 0.40893031189083817, 'support': 30006}, 'accuracy': 0.3684026296502915, 'macro avg': {'precision': 0.3709929825419052, 'recall': 0.3693578016003651, 'f1-score': 0.36684688625477735, 'support': 91419}, 'weighted avg': {'precision': 0.3714578979155961, 'recall': 0.3684026296502915, 'f1-score': 0.3665534877811674, 'support': 91419}}
[[ 9601 11154 10622]
 [ 7774 10652 11610]
 [ 6460 10120 13426]]
Evaluating performance on  val set...
99/99 - 1s - 725ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2484468
{'0': {'precision': 0.397270201715183, 'recall': 0.38089171974522296, 'f1-score': 0.3889085964289938, 'support': 8635}, '1': {'precision': 0.33237616654702085, 'recall': 0.27615412143624, 'f1-score': 0.301667969768048, 'support': 8383}, '2': {'precision': 0.3591971240263631, 'recall': 0.43652912621359224, 'f1-score': 0.3941054015558234, 'support': 8240}, 'accuracy': 0.3642806239607253, 'macro avg': {'precision': 0.3629478307628557, 'recall': 0.3645249891316851, 'f1-score': 0.3615606559176217, 'support': 25258}, 'weighted avg': {'precision': 0.3633115012254143, 'recall': 0.3642806239607253, 'f1-score': 0.3616492528921487, 'support': 25258}}
[[3289 2260 3086]
 [2737 2315 3331]
 [2253 2390 3597]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1767867
{'0': {'precision': 0.40060534857324914, 'recall': 0.33235313553161966, 'f1-score': 0.36330146003196356, 'support': 121064}, '1': {'precision': 0.35672679158048426, 'recall': 0.3798830655610262, 'f1-score': 0.36794095501035323, 'support': 123488}, '2': {'precision': 0.4071405151371635, 'recall': 0.44833313274762304, 'f1-score': 0.4267450740797312, 'support': 124635}, 'accuracy': 0.3874052986697798, 'macro avg': {'precision': 0.38815755176363226, 'recall': 0.386856444613423, 'f1-score': 0.38599582970734936, 'support': 369187}, 'weighted avg': {'precision': 0.3881347990651974, 'recall': 0.3874052986697798, 'f1-score': 0.3862714367449435, 'support': 369187}}
[[40236 42330 38498]
 [33708 46911 42869]
 [26494 42263 55878]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1874647
{'0': {'precision': 0.4055864161052673, 'recall': 0.2475295135966916, 'f1-score': 0.3074327350912294, 'support': 41591}, '1': {'precision': 0.352115436002494, 'recall': 0.4731198238307243, 'f1-score': 0.4037461828357828, 'support': 41778}, '2': {'precision': 0.4104837628981105, 'recall': 0.4281853551708874, 'f1-score': 0.4191477473573782, 'support': 42923}, 'accuracy': 0.38355556963228077, 'macro avg': {'precision': 0.3893952050019573, 'recall': 0.3829448975327678, 'f1-score': 0.3767755550947968, 'support': 126292}, 'weighted avg': {'precision': 0.38956242574685623, 'recall': 0.38355556963228077, 'f1-score': 0.3772623893161356, 'support': 126292}}
[[10295 18781 12515]
 [ 8132 19766 13880]
 [ 6956 17588 18379]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1727084
{'0': {'precision': 0.4034708831469341, 'recall': 0.40547244399658944, 'f1-score': 0.40446918735018944, 'support': 12901}, '1': {'precision': 0.3483182406209573, 'recall': 0.5073806532663316, 'f1-score': 0.41306571209409354, 'support': 12736}, '2': {'precision': 0.42663248378826724, 'recall': 0.22612101350811287, 'f1-score': 0.29558039912234874, 'support': 12511}, 'accuracy': 0.38067526475830976, 'macro avg': {'precision': 0.3928072025187195, 'recall': 0.37965803692367794, 'f1-score': 0.3710384328555439, 'support': 38148}, 'weighted avg': {'precision': 0.3926538214507215, 'recall': 0.38067526475830976, 'f1-score': 0.3716280871514856, 'support': 38148}}
[[5231 5948 1722]
 [4194 6462 2080]
 [3540 6142 2829]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
5521/5521 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9246618
{'0': {'precision': 0.3372417348175599, 'recall': 0.5616652589959441, 'f1-score': 0.4214384082761839, 'support': 215486}, '1': {'precision': 0.7925767608881861, 'recall': 0.39465422668785566, 'f1-score': 0.526929926749504, 'support': 975350}, '2': {'precision': 0.2914897470114864, 'recall': 0.7452016864892077, 'f1-score': 0.41906134081530777, 'support': 222474}, 'accuracy': 0.47529912050434797, 'macro avg': {'precision': 0.4737694142390774, 'recall': 0.5671737240576692, 'f1-score': 0.45580989194699856, 'support': 1413310}, 'weighted avg': {'precision': 0.6442744381472022, 'recall': 0.47529912050434797, 'f1-score': 0.4938657715840653, 'support': 1413310}}
[[121031  59177  35278]
 [222729 384926 367695]
 [ 15125  41561 165788]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9452572
{'0': {'precision': 0.33414521678470505, 'recall': 0.5195705329729928, 'f1-score': 0.40672087500899473, 'support': 54393}, '1': {'precision': 0.772145384367964, 'recall': 0.3808300019036741, 'f1-score': 0.5100822302020697, 'support': 220626}, '2': {'precision': 0.28531297217210166, 'recall': 0.7109904772349254, 'f1-score': 0.4072149029830043, 'support': 54711}, 'accuracy': 0.4584993782791981, 'macro avg': {'precision': 0.46386785777492356, 'recall': 0.5371303373705308, 'f1-score': 0.44133933606468956, 'support': 329730}, 'weighted avg': {'precision': 0.6191134151234183, 'recall': 0.4584993782791981, 'f1-score': 0.47596307655363246, 'support': 329730}}
[[28261 13999 12133]
 [51299 84021 85306]
 [ 5017 10795 38899]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93772596
{'0': {'precision': 0.30107431935246504, 'recall': 0.6094494756911344, 'f1-score': 0.40304182509505704, 'support': 16784}, '1': {'precision': 0.78855334896466, 'recall': 0.3547112268886206, 'f1-score': 0.4893158273002962, 'support': 78695}, '2': {'precision': 0.27922108428074793, 'recall': 0.7218679783810045, 'f1-score': 0.4026829722725656, 'support': 16467}, 'accuracy': 0.44691190395369196, 'macro avg': {'precision': 0.45628291753262434, 'recall': 0.5620095603202532, 'f1-score': 0.43168020822263964, 'support': 111946}, 'weighted avg': {'precision': 0.640544287135197, 'recall': 0.44691190395369196, 'f1-score': 0.4636373209065494, 'support': 111946}}
[[10229  4244  2311]
 [22407 27914 28374]
 [ 1339  3241 11887]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
5918/5918 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91351926
{'0': {'precision': 0.34934030235385927, 'recall': 0.44408608104242225, 'f1-score': 0.39105623172859894, 'support': 216726}, '1': {'precision': 0.7872944996955551, 'recall': 0.4685469437659575, 'f1-score': 0.5874697536009544, 'support': 1084521}, '2': {'precision': 0.24172398353044947, 'recall': 0.6717782944503441, 'f1-score': 0.3555216649109277, 'support': 213761}, 'accuracy': 0.4937228054241298, 'macro avg': {'precision': 0.4594529285266213, 'recall': 0.5281371064195747, 'f1-score': 0.44468255008016033, 'support': 1515008}, 'weighted avg': {'precision': 0.6476663522012545, 'recall': 0.4937228054241298, 'f1-score': 0.5266454065824719, 'support': 1515008}}
[[ 96245  81065  39416]
 [165322 508149 411050]
 [ 13938  56223 143600]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9055338
{'0': {'precision': 0.3421265789531294, 'recall': 0.4118267102350585, 'f1-score': 0.3737548877754792, 'support': 75896}, '1': {'precision': 0.7344486621531099, 'recall': 0.5577121797189173, 'f1-score': 0.6339937738209538, 'support': 312577}, '2': {'precision': 0.28258656555671946, 'recall': 0.5053425850196555, 'f1-score': 0.3624768176829038, 'support': 75806}, 'accuracy': 0.5253134429944064, 'macro avg': {'precision': 0.45305393555431955, 'recall': 0.4916271583245438, 'f1-score': 0.4567418264264456, 'support': 464279}, 'weighted avg': {'precision': 0.5965369002144228, 'recall': 0.5253134429944064, 'f1-score': 0.5471199223818227, 'support': 464279}}
[[ 31256  33838  10802]
 [ 51797 174328  86452]
 [  8305  29193  38308]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9091994
{'0': {'precision': 0.31345353675450766, 'recall': 0.45208219676304784, 'f1-score': 0.3702159344750559, 'support': 21996}, '1': {'precision': 0.7975384787128644, 'recall': 0.4800477074391688, 'f1-score': 0.5993435471523998, 'support': 119059}, '2': {'precision': 0.23193730513187832, 'recall': 0.6351594590852448, 'f1-score': 0.3397940791585393, 'support': 21667}, 'accuracy': 0.4969211292879881, 'macro avg': {'precision': 0.4476431068664168, 'recall': 0.5224297877624872, 'f1-score': 0.4364511869286651, 'support': 162722}, 'weighted avg': {'precision': 0.6567903745149365, 'recall': 0.4969211292879881, 'f1-score': 0.533811232582312, 'support': 162722}}
[[ 9944  8311  3741]
 [20073 57154 41832]
 [ 1707  6198 13762]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
3755/3755 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.109386
{'0': {'precision': 0.5073309123921924, 'recall': 0.07314606962178577, 'f1-score': 0.1278578251643053, 'support': 305594}, '1': {'precision': 0.38628618764014455, 'recall': 0.7440728045029629, 'f1-score': 0.5085553332631357, 'support': 363494}, '2': {'precision': 0.4253663573545749, 'recall': 0.31593255157065825, 'f1-score': 0.36257190456731525, 'support': 292075}, 'accuracy': 0.40065524786118484, 'macro avg': {'precision': 0.439661152462304, 'recall': 0.3777171418984689, 'f1-score': 0.3329950209982521, 'support': 961163}, 'weighted avg': {'precision': 0.43664692997543997, 'recall': 0.40065524786118484, 'f1-score': 0.343154684022283, 'support': 961163}}
[[ 22353 238802  44439]
 [ 12810 270466  80218]
 [  8897 190902  92276]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1278058
{'0': {'precision': 0.4803235294117647, 'recall': 0.24903548500236364, 'f1-score': 0.3280074716048887, 'support': 131154}, '1': {'precision': 0.3626344923657826, 'recall': 0.6045099342301258, 'f1-score': 0.4533266120370397, 'support': 130911}, '2': {'precision': 0.4343812822666654, 'recall': 0.3537151464846752, 'f1-score': 0.38991989630150514, 'support': 130116}, 'accuracy': 0.40242388081013614, 'macro avg': {'precision': 0.42577976801473755, 'recall': 0.4024201885723882, 'f1-score': 0.39041799331447785, 'support': 392181}, 'weighted avg': {'precision': 0.4257961276297857, 'recall': 0.40242388081013614, 'f1-score': 0.3903803327198797, 'support': 392181}}
[[32662 72541 25951]
 [17796 79137 33978]
 [17542 66550 46024]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1174139
{'0': {'precision': 0.508031751984499, 'recall': 0.20411340749855603, 'f1-score': 0.2912217843067001, 'support': 39821}, '1': {'precision': 0.3616205750765286, 'recall': 0.69289384634666, 'f1-score': 0.4752228439791296, 'support': 39895}, '2': {'precision': 0.46217801202583325, 'recall': 0.3139133284594247, 'f1-score': 0.3738834091489138, 'support': 39667}, 'accuracy': 0.4039352336597338, 'macro avg': {'precision': 0.44394344636228694, 'recall': 0.4036401941015469, 'f1-score': 0.3801093458115812, 'support': 119383}, 'weighted avg': {'precision': 0.4438688962539187, 'recall': 0.4039352336597338, 'f1-score': 0.38017633351594815, 'support': 119383}}
[[ 8128 25103  6590]
 [ 4352 27643  7900]
 [ 3519 23696 12452]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
4960/4960 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0206833
{'0': {'precision': 0.4207549069481538, 'recall': 0.4436817062983172, 'f1-score': 0.4319142715324099, 'support': 357921}, '1': {'precision': 0.5414393552073622, 'recall': 0.48482166420411804, 'f1-score': 0.5115687418543328, 'support': 557011}, '2': {'precision': 0.4173691393195778, 'recall': 0.46295116533426545, 'f1-score': 0.4389800585107165, 'support': 354748}, 'accuracy': 0.46711376094764034, 'macro avg': {'precision': 0.4598544671583646, 'recall': 0.46381817861223357, 'f1-score': 0.4608210239658197, 'support': 1269680}, 'weighted avg': {'precision': 0.47275341910445134, 'recall': 0.46711376094764034, 'f1-score': 0.46883301481218503, 'support': 1269680}}
[[158803 116097  83021]
 [140721 270051 146239]
 [ 77900 112617 164231]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0757948
{'0': {'precision': 0.4724732565616414, 'recall': 0.29577557562539336, 'f1-score': 0.3638041310893959, 'support': 136634}, '1': {'precision': 0.4422560190601345, 'recall': 0.5090729091725237, 'f1-score': 0.47331801134284673, 'support': 162627}, '2': {'precision': 0.4268574497851504, 'recall': 0.5116294738102902, 'f1-score': 0.46541480106913635, 'support': 133583}, 'accuracy': 0.44253125837484175, 'macro avg': {'precision': 0.4471955751356422, 'recall': 0.4388259862027358, 'f1-score': 0.43417898116712633, 'support': 432844}, 'weighted avg': {'precision': 0.4470423045332396, 'recall': 0.44253125837484175, 'f1-score': 0.4363091720091767, 'support': 432844}}
[[40413 56656 39565]
 [27636 82789 52202]
 [17486 47752 68345]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1195688
{'0': {'precision': 0.4431793299759142, 'recall': 0.1658404686795854, 'f1-score': 0.2413618340637391, 'support': 48818}, '1': {'precision': 0.36183010869822624, 'recall': 0.5884686488984748, 'f1-score': 0.44812365268143894, 'support': 51928}, '2': {'precision': 0.44935140047922, 'recall': 0.43172977693101533, 'f1-score': 0.4403643724696356, 'support': 50388}, 'accuracy': 0.39969828099567273, 'macro avg': {'precision': 0.4181202797177868, 'recall': 0.39534629816969186, 'f1-score': 0.3766166197382712, 'support': 151134}, 'weighted avg': {'precision': 0.4172863867997446, 'recall': 0.39969828099567273, 'f1-score': 0.3787502947832081, 'support': 151134}}
[[ 8096 28912 11810]
 [ 6522 30558 14848]
 [ 3650 24984 21754]]
testing model on single stock: results/universal/W8/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
10609/10609 - 65s - 65s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2243783
{'0': {'precision': 0.41868719334970633, 'recall': 0.08259835137141835, 'f1-score': 0.13797673711198344, 'support': 922585}, '1': {'precision': 0.30742561922662726, 'recall': 0.8831826266794615, 'f1-score': 0.45609119007991256, 'support': 832633}, '2': {'precision': 0.45918014386660927, 'recall': 0.06772455813023705, 'f1-score': 0.11803945657608088, 'support': 960464}, 'accuracy': 0.32279847198604256, 'macro avg': {'precision': 0.39509765214764764, 'recall': 0.34450184539370565, 'f1-score': 0.23736912792265896, 'support': 2715682}, 'weighted avg': {'precision': 0.39889546625442973, 'recall': 0.32279847198604256, 'f1-score': 0.2284599200124153, 'support': 2715682}}
[[ 76204 811783  34598]
 [ 55252 735367  42014]
 [ 50551 844866  65047]]
Evaluating performance on  train set...
3903/3903 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2219843
{'0': {'precision': 0.41248659769915097, 'recall': 0.08509207423326269, 'f1-score': 0.1410805654323129, 'support': 334567}, '1': {'precision': 0.33061750560654524, 'recall': 0.9166750445551342, 'f1-score': 0.4859626823607695, 'support': 328245}, '2': {'precision': 0.4275115299779427, 'recall': 0.0253620063583454, 'f1-score': 0.04788334610709182, 'support': 336251}, 'accuracy': 0.33820790080305246, 'macro avg': {'precision': 0.39020521109454626, 'recall': 0.3423763750489141, 'f1-score': 0.22497553130005807, 'support': 999063}, 'weighted avg': {'precision': 0.3906451606423674, 'recall': 0.33820790080305246, 'f1-score': 0.22302552013072163, 'support': 999063}}
[[ 28469 301166   4932]
 [ 20863 300894   6488]
 [ 19686 308037   8528]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2122378
{'0': {'precision': 0.4212465894192268, 'recall': 0.11880396546210426, 'f1-score': 0.18533733484039444, 'support': 100064}, '1': {'precision': 0.3233983678829378, 'recall': 0.8806325961558928, 'f1-score': 0.4730694688216427, 'support': 93962}, '2': {'precision': 0.42407580720636406, 'recall': 0.036762095997241576, 'f1-score': 0.06765899864682003, 'support': 98607}, 'accuracy': 0.33577552770876834, 'macro avg': {'precision': 0.38957358816950954, 'recall': 0.34539955253841287, 'f1-score': 0.2420219341029524, 'support': 292633}, 'weighted avg': {'precision': 0.39078169341072283, 'recall': 0.33577552770876834, 'f1-score': 0.23807225904957882, 'support': 292633}}
[[11888 85996  2180]
 [ 8473 82746  2743]
 [ 7860 87122  3625]]
training model: results/universal/W8/deepOF_L1/h10
Epoch 1/50
7695/7695 - 123s - loss: 2.9754 - accuracy10: 0.4993 - val_loss: 3.2848 - val_accuracy10: 0.4719 - 123s/epoch - 16ms/step
Epoch 2/50
7695/7695 - 109s - loss: 2.9659 - accuracy10: 0.5005 - val_loss: 3.3032 - val_accuracy10: 0.4692 - 109s/epoch - 14ms/step
Epoch 3/50
7695/7695 - 108s - loss: 2.9581 - accuracy10: 0.5043 - val_loss: 3.2747 - val_accuracy10: 0.4730 - 108s/epoch - 14ms/step
Epoch 4/50
7695/7695 - 110s - loss: 2.9470 - accuracy10: 0.5072 - val_loss: 3.2870 - val_accuracy10: 0.4739 - 110s/epoch - 14ms/step
Epoch 5/50
7695/7695 - 112s - loss: 2.9380 - accuracy10: 0.5087 - val_loss: 3.2856 - val_accuracy10: 0.4766 - 112s/epoch - 15ms/step
Epoch 6/50
7695/7695 - 107s - loss: 2.9297 - accuracy10: 0.5104 - val_loss: 3.3024 - val_accuracy10: 0.4748 - 107s/epoch - 14ms/step
Epoch 7/50
7695/7695 - 109s - loss: 2.9227 - accuracy10: 0.5108 - val_loss: 3.3150 - val_accuracy10: 0.4745 - 109s/epoch - 14ms/step
Epoch 8/50
7695/7695 - 110s - loss: 2.9162 - accuracy10: 0.5115 - val_loss: 3.3047 - val_accuracy10: 0.4738 - 110s/epoch - 14ms/step
Epoch 9/50
7695/7695 - 112s - loss: 2.9100 - accuracy10: 0.5125 - val_loss: 3.3162 - val_accuracy10: 0.4729 - 112s/epoch - 15ms/step
Epoch 10/50
7695/7695 - 110s - loss: 2.9039 - accuracy10: 0.5132 - val_loss: 3.3206 - val_accuracy10: 0.4726 - 110s/epoch - 14ms/step
Epoch 11/50
7695/7695 - 111s - loss: 2.8983 - accuracy10: 0.5141 - val_loss: 3.4200 - val_accuracy10: 0.4770 - 111s/epoch - 14ms/step
Epoch 12/50
7695/7695 - 112s - loss: 2.8915 - accuracy10: 0.5150 - val_loss: 3.5227 - val_accuracy10: 0.4837 - 112s/epoch - 14ms/step
Epoch 13/50
7695/7695 - 110s - loss: 2.8869 - accuracy10: 0.5157 - val_loss: 3.5518 - val_accuracy10: 0.4836 - 110s/epoch - 14ms/step
testing model in sample: results/universal/W8/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 155s - 155s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0150567
{'0': {'precision': 0.38214403856648316, 'recall': 0.13113024818508287, 'f1-score': 0.1952587297400591, 'support': 1383121}, '1': {'precision': 0.5370906530915895, 'recall': 0.8222687933885756, 'f1-score': 0.6497661592030542, 'support': 3172206}, '2': {'precision': 0.35905472802709487, 'recall': 0.16087466278130017, 'f1-score': 0.22219481842170813, 'support': 1405616}, 'accuracy': 0.5059439420910417, 'macro avg': {'precision': 0.42609647322838917, 'recall': 0.37142456811831953, 'f1-score': 0.3557399024549405, 'support': 5960943}, 'weighted avg': {'precision': 0.45915666491655843, 'recall': 0.5059439420910417, 'f1-score': 0.4434833801041768, 'support': 5960943}}
[[ 181369 1125172   76580]
 [ 236721 2608406  327079]
 [  56519 1122969  226128]]
Evaluating performance on  train set...
7695/7695 - 42s - 42s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0456169
{'0': {'precision': 0.39268121041520054, 'recall': 0.11137126056483991, 'f1-score': 0.17352717791080838, 'support': 521068}, '1': {'precision': 0.47736198351561204, 'recall': 0.8402370116781177, 'f1-score': 0.6088304681181432, 'support': 927718}, '2': {'precision': 0.392834815042438, 'recall': 0.1424014227466616, 'f1-score': 0.20903007911996832, 'support': 520683}, 'accuracy': 0.46290700691404635, 'macro avg': {'precision': 0.4209593363244169, 'recall': 0.36466989832987307, 'f1-score': 0.33046257504964, 'support': 1969469}, 'weighted avg': {'precision': 0.43261068215468534, 'recall': 0.46290700691404635, 'f1-score': 0.38796287346877717, 'support': 1969469}}
[[ 58032 431877  31159]
 [ 64774 779503  83441]
 [ 24978 421559  74146]]
Evaluating performance on  val set...
2338/2338 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0401381
{'0': {'precision': 0.3857500057348657, 'recall': 0.10949841443482904, 'f1-score': 0.17057707718369292, 'support': 153573}, '1': {'precision': 0.49016835367490075, 'recall': 0.8413713916400527, 'f1-score': 0.6194537283929369, 'support': 290887}, '2': {'precision': 0.38196064139941693, 'recall': 0.13672147613798682, 'f1-score': 0.2013650401779067, 'support': 153319}, 'accuracy': 0.47261947977429786, 'macro avg': {'precision': 0.41929300026972777, 'recall': 0.36253042740428953, 'f1-score': 0.33046528191817887, 'support': 597779}, 'weighted avg': {'precision': 0.4355894253643379, 'recall': 0.47261947977429786, 'f1-score': 0.3969027964522072, 'support': 597779}}
[[ 16816 128908   7849]
 [ 20074 244744  26069]
 [  6703 125654  20962]]
testing model out of sample: results/universal/W8/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 83s - 83s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9664686
{'0': {'precision': 0.3210005379933496, 'recall': 0.15810426842894998, 'f1-score': 0.2118599293700415, 'support': 626460}, '1': {'precision': 0.6718175275016219, 'recall': 0.7985255767217283, 'f1-score': 0.7297119659473814, 'support': 2370554}, '2': {'precision': 0.29527927824974337, 'recall': 0.23367349081025737, 'f1-score': 0.2608888496232603, 'support': 619223}, 'accuracy': 0.5908600570150684, 'macro avg': {'precision': 0.4293657812482383, 'recall': 0.3967677786536452, 'f1-score': 0.40082024831356106, 'support': 3616237}, 'weighted avg': {'precision': 0.5465674524750548, 'recall': 0.5908600570150684, 'f1-score': 0.5597232059756728, 'support': 3616237}}
[[  99046  477466   49948]
 [ 182219 1892948  295387]
 [  27289  447238  144696]]
Evaluating performance on  train set...
4550/4550 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9865198
{'0': {'precision': 0.35704415857384736, 'recall': 0.15730086598645288, 'f1-score': 0.21838786284394657, 'support': 233260}, '1': {'precision': 0.6164744305671321, 'recall': 0.8045521841511987, 'f1-score': 0.6980669389988372, 'support': 697731}, '2': {'precision': 0.3436907241109446, 'recall': 0.22226272989294538, 'f1-score': 0.26995025134790196, 'support': 233152}, 'accuracy': 0.5582424152359289, 'macro avg': {'precision': 0.43906977108397466, 'recall': 0.39470526001019896, 'f1-score': 0.39546835106356193, 'support': 1164143}, 'weighted avg': {'precision': 0.5098597174495627, 'recall': 0.5582424152359289, 'f1-score': 0.5162110988975088, 'support': 1164143}}
[[ 36692 179026  17542]
 [ 54955 561361  81415]
 [ 11119 170212  51821]]
Evaluating performance on  val set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98820466
{'0': {'precision': 0.35652126912058807, 'recall': 0.16933661942904088, 'f1-score': 0.2296137712565053, 'support': 77904}, '1': {'precision': 0.6286065345590565, 'recall': 0.8019054305587303, 'f1-score': 0.7047588640142636, 'support': 244984}, '2': {'precision': 0.3259358496427462, 'recall': 0.21482960289732664, 'f1-score': 0.2589687222800725, 'support': 78141}, 'accuracy': 0.564629989352391, 'macro avg': {'precision': 0.4370212177741302, 'recall': 0.39535721762836595, 'f1-score': 0.3977804525169471, 'support': 401029}, 'weighted avg': {'precision': 0.5167754188323538, 'recall': 0.564629989352391, 'f1-score': 0.5255942879575399, 'support': 401029}}
[[ 13192  58687   6025]
 [ 19838 196454  28692]
 [  3972  57382  16787]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0854348
{'0': {'precision': 0.3224986380969675, 'recall': 0.03703472005004692, 'f1-score': 0.06643971418951779, 'support': 47955}, '1': {'precision': 0.44249867898708795, 'recall': 0.9312925945992186, 'f1-score': 0.599939380579742, 'support': 70138}, '2': {'precision': 0.312849635531446, 'recall': 0.0788237304061846, 'f1-score': 0.12592112445414846, 'support': 46826}, 'accuracy': 0.42921676701896083, 'macro avg': {'precision': 0.3592823175385005, 'recall': 0.34905034835181675, 'f1-score': 0.2641000730744694, 'support': 164919}, 'weighted avg': {'precision': 0.37079348995647526, 'recall': 0.42921676701896083, 'f1-score': 0.31021924303900844, 'support': 164919}}
[[ 1776 41278  4901]
 [ 1613 65319  3206]
 [ 2118 41017  3691]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1058626
{'0': {'precision': 0.31224279835390945, 'recall': 0.03561788522473888, 'f1-score': 0.06394185189086696, 'support': 17042}, '1': {'precision': 0.40787891512224916, 'recall': 0.9344527526345708, 'f1-score': 0.5678828625335495, 'support': 22869}, '2': {'precision': 0.3347532836350728, 'recall': 0.05468885924723076, 'f1-score': 0.09401794616151546, 'support': 17243}, 'accuracy': 0.40102180074885396, 'macro avg': {'precision': 0.35162499903707717, 'recall': 0.34158649903551347, 'f1-score': 0.24194755352864397, 'support': 57154}, 'weighted avg': {'precision': 0.357300898435763, 'recall': 0.40102180074885396, 'f1-score': 0.27465727103731863, 'support': 57154}}
[[  607 15458   977]
 [  602 21370   897]
 [  735 15565   943]]
Evaluating performance on  val set...
68/68 - 1s - 566ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1147276
{'0': {'precision': 0.32045779685264664, 'recall': 0.04260174971472042, 'f1-score': 0.07520564042303172, 'support': 5258}, '1': {'precision': 0.3926368542791056, 'recall': 0.9297124600638977, 'f1-score': 0.5521073316167502, 'support': 6573}, '2': {'precision': 0.3611111111111111, 'recall': 0.0649518874907476, 'f1-score': 0.1101003764115433, 'support': 5404}, 'accuracy': 0.3879315346678271, 'macro avg': {'precision': 0.35806858741428776, 'recall': 0.3457553657564552, 'f1-score': 0.24580444948377508, 'support': 17235}, 'weighted avg': {'precision': 0.36073185862908164, 'recall': 0.3879315346678271, 'f1-score': 0.2680252499094389, 'support': 17235}}
[[ 224 4695  339]
 [ 180 6111  282]
 [ 295 4758  351]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
2179/2179 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84800375
{'0': {'precision': 0.3231800460545815, 'recall': 0.285217006378398, 'f1-score': 0.303014108593416, 'support': 49699}, '1': {'precision': 0.8622069458622457, 'recall': 0.8719758152339632, 'f1-score': 0.8670638659138505, 'support': 459132}, '2': {'precision': 0.31139572408229127, 'recall': 0.3154421379535796, 'f1-score': 0.3134058706508059, 'support': 48944}, 'accuracy': 0.7708592174263816, 'macro avg': {'precision': 0.49892757199970617, 'recall': 0.49087831985531355, 'f1-score': 0.49449461505269077, 'support': 557775}, 'weighted avg': {'precision': 0.7658455056178116, 'recall': 0.7708592174263816, 'f1-score': 0.7682230325863928, 'support': 557775}}
[[ 14175  32978   2546]
 [ 27185 400352  31595]
 [  2501  31004  15439]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8650129
{'0': {'precision': 0.3509992076767321, 'recall': 0.22186978297161936, 'f1-score': 0.2718810733403798, 'support': 17970}, '1': {'precision': 0.8044857187684445, 'recall': 0.8909095422089474, 'f1-score': 0.8454948765262456, 'support': 120863}, '2': {'precision': 0.378430712241118, 'recall': 0.2462878746370062, 'f1-score': 0.29838361711308037, 'support': 18251}, 'accuracy': 0.739476967737007, 'macro avg': {'precision': 0.5113052128954315, 'recall': 0.4530223999391909, 'f1-score': 0.47191985565990197, 'support': 157084}, 'weighted avg': {'precision': 0.7031063133009984, 'recall': 0.739476967737007, 'f1-score': 0.7163081507056676, 'support': 157084}}
[[  3987  13233    750]
 [  6552 107678   6633]
 [   820  12936   4495]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86275
{'0': {'precision': 0.3438485804416404, 'recall': 0.23625615763546798, 'f1-score': 0.28007474889044615, 'support': 5075}, '1': {'precision': 0.8297244574494026, 'recall': 0.8897110733429207, 'f1-score': 0.8586713772001766, 'support': 38245}, '2': {'precision': 0.3379276396751169, 'recall': 0.26202290076335877, 'f1-score': 0.29517359991400616, 'support': 5240}, 'accuracy': 0.7536861614497529, 'macro avg': {'precision': 0.50383355918872, 'recall': 0.4626633772472491, 'f1-score': 0.47797324200154295, 'support': 48560}, 'weighted avg': {'precision': 0.7258769409553406, 'recall': 0.7536861614497529, 'f1-score': 0.7373965369684753, 'support': 48560}}
[[ 1199  3512   364]
 [ 1892 34027  2326]
 [  396  3471  1373]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0430647
{'0': {'precision': 0.47182288671650374, 'recall': 0.08632185268473587, 'f1-score': 0.1459428812824475, 'support': 76041}, '1': {'precision': 0.46995496883775084, 'recall': 0.7491981820911411, 'f1-score': 0.5775966834842354, 'support': 146542}, '2': {'precision': 0.26965752052874026, 'recall': 0.17981969949916526, 'f1-score': 0.21576058651496333, 'support': 74875}, 'accuracy': 0.4364212762810212, 'macro avg': {'precision': 0.40381179202766493, 'recall': 0.33844657809168077, 'f1-score': 0.3131000504272154, 'support': 297458}, 'weighted avg': {'precision': 0.42001436176475593, 'recall': 0.4364212762810212, 'f1-score': 0.3761703828508673, 'support': 297458}}
[[  6564  64593   4884]
 [  5171 109789  31582]
 [  2177  59234  13464]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0961883
{'0': {'precision': 0.5412262156448203, 'recall': 0.12908337835404285, 'f1-score': 0.20845086806060428, 'support': 27765}, '1': {'precision': 0.345750397335957, 'recall': 0.8234615523270485, 'f1-score': 0.4870154790840476, 'support': 27739}, '2': {'precision': 0.49307021569527304, 'recall': 0.19132416838806182, 'f1-score': 0.275678033510379, 'support': 28078}, 'accuracy': 0.38044076475796224, 'macro avg': {'precision': 0.4600156095586834, 'recall': 0.3812896996897177, 'f1-score': 0.3237147935516769, 'support': 83582}, 'weighted avg': {'precision': 0.46017493796956793, 'recall': 0.38044076475796224, 'f1-score': 0.32348410603861466, 'support': 83582}}
[[ 3584 21817  2364]
 [ 1738 22842  3159]
 [ 1300 21406  5372]]
Evaluating performance on  val set...
125/125 - 1s - 807ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0722958
{'0': {'precision': 0.5206167084976694, 'recall': 0.14823889739663093, 'f1-score': 0.23076923076923078, 'support': 9795}, '1': {'precision': 0.3951835607537362, 'recall': 0.8103089349654425, 'f1-score': 0.5312696202877187, 'support': 12009}, '2': {'precision': 0.4720255766156657, 'recall': 0.20694833800560672, 'f1-score': 0.28774274378784714, 'support': 9988}, 'accuracy': 0.41677151484650227, 'macro avg': {'precision': 0.4626086152890238, 'recall': 0.3884987234558934, 'f1-score': 0.34992719828159896, 'support': 31792}, 'weighted avg': {'precision': 0.4579702912702428, 'recall': 0.41677151484650227, 'f1-score': 0.3621784099890805, 'support': 31792}}
[[1452 7409  934]
 [ 900 9731 1378]
 [ 437 7484 2067]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1115607
{'0': {'precision': 0.44348694891969526, 'recall': 0.03467570259555104, 'f1-score': 0.06432213598036464, 'support': 102406}, '1': {'precision': 0.3549041201251595, 'recall': 0.9354410667059831, 'f1-score': 0.5145784121899045, 'support': 108521}, '2': {'precision': 0.4899399557568735, 'recall': 0.09110586576037454, 'f1-score': 0.1536415965380264, 'support': 102101}, 'accuracy': 0.3653602872586478, 'macro avg': {'precision': 0.42944367493390945, 'recall': 0.35374087835396956, 'f1-score': 0.2441807149027652, 'support': 313028}, 'weighted avg': {'precision': 0.42792860042521846, 'recall': 0.3653602872586478, 'f1-score': 0.2495511493367842, 'support': 313028}}
[[  3551  94303   4552]
 [  1874 101515   5132]
 [  2582  90217   9302]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1112317
{'0': {'precision': 0.449455205811138, 'recall': 0.04725536992840095, 'f1-score': 0.08551930663134556, 'support': 31425}, '1': {'precision': 0.3356894452047055, 'recall': 0.885159069089946, 'f1-score': 0.48677383531467894, 'support': 30207}, '2': {'precision': 0.43346726542188607, 'recall': 0.12314923619271445, 'f1-score': 0.19180589327267497, 'support': 29785}, 'accuracy': 0.34885196407670344, 'macro avg': {'precision': 0.40620397214590986, 'recall': 0.3518545584036872, 'f1-score': 0.25469967840623314, 'support': 91417}, 'weighted avg': {'precision': 0.4066543795410529, 'recall': 0.34885196407670344, 'f1-score': 0.25273592423036373, 'support': 91417}}
[[ 1485 27757  2183]
 [  858 26738  2611]
 [  961 25156  3668]]
Evaluating performance on  val set...
99/99 - 1s - 696ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1169052
{'0': {'precision': 0.4725609756097561, 'recall': 0.0364063417498532, 'f1-score': 0.06760440519027368, 'support': 8515}, '1': {'precision': 0.3270127021840446, 'recall': 0.8782672720579212, 'f1-score': 0.4765773264524722, 'support': 8149}, '2': {'precision': 0.44935543278084716, 'recall': 0.1419760269987199, 'f1-score': 0.21577644145737532, 'support': 8593}, 'accuracy': 0.3439442530783545, 'macro avg': {'precision': 0.4163097035248826, 'recall': 0.3522165469354981, 'f1-score': 0.2533193910333737, 'support': 25257}, 'weighted avg': {'precision': 0.4177057628103366, 'recall': 0.3439442530783545, 'f1-score': 0.24996821098703734, 'support': 25257}}
[[ 310 7549  656]
 [ 153 7157  839]
 [ 193 7180 1220]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1103117
{'0': {'precision': 0.5004316546762589, 'recall': 0.07105906197134755, 'f1-score': 0.12444717972205126, 'support': 122363}, '1': {'precision': 0.3482079754484041, 'recall': 0.8807372693013817, 'f1-score': 0.4990942318310207, 'support': 124188}, '2': {'precision': 0.45618549863369856, 'recall': 0.14021740016798362, 'f1-score': 0.21450313115940223, 'support': 122631}, 'accuracy': 0.36639651987366667, 'macro avg': {'precision': 0.43494170958612055, 'recall': 0.3640045771469043, 'f1-score': 0.2793481809041581, 'support': 369182}, 'weighted avg': {'precision': 0.4345283748912097, 'recall': 0.36639651987366667, 'f1-score': 0.28038739210516445, 'support': 369182}}
[[  8695 103505  10163]
 [  4476 109377  10335]
 [  4204 101232  17195]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.116638
{'0': {'precision': 0.5097560975609756, 'recall': 0.06440067316125056, 'f1-score': 0.11435425829668133, 'support': 42189}, '1': {'precision': 0.3315265822087073, 'recall': 0.867330016583748, 'f1-score': 0.47969533025827804, 'support': 41607}, '2': {'precision': 0.4239345887016848, 'recall': 0.12079636646035817, 'f1-score': 0.18801853445907585, 'support': 42493}, 'accuracy': 0.3479083688999042, 'macro avg': {'precision': 0.42173908949045585, 'recall': 0.3508423520684522, 'f1-score': 0.2606893743380117, 'support': 126289}, 'weighted avg': {'precision': 0.42216011674538856, 'recall': 0.3479083688999042, 'f1-score': 0.2595051587557457, 'support': 126289}}
[[ 2717 36791  2681]
 [ 1226 36087  4294]
 [ 1387 35973  5133]]
Evaluating performance on  val set...
150/150 - 1s - 967ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1085818
{'0': {'precision': 0.49506726457399103, 'recall': 0.08505392912172573, 'f1-score': 0.14516765285996053, 'support': 12980}, '1': {'precision': 0.3423497768812275, 'recall': 0.8843360176851414, 'f1-score': 0.493610082848581, 'support': 12666}, '2': {'precision': 0.4721875, 'recall': 0.12086066229403296, 'f1-score': 0.19245955929180997, 'support': 12502}, 'accuracy': 0.3621683967704729, 'macro avg': {'precision': 0.43653484715173946, 'recall': 0.3634168697003, 'f1-score': 0.2770790983334505, 'support': 38148}, 'weighted avg': {'precision': 0.43686336094023365, 'recall': 0.3621683967704729, 'f1-score': 0.2763571053200331, 'support': 38148}}
[[ 1104 11081   795]
 [  571 11201   894]
 [  555 10436  1511]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/EXC
Evaluating performance on  test set...
5521/5521 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90553534
{'0': {'precision': 0.25738319743694865, 'recall': 0.39750644883920894, 'f1-score': 0.31245411004986073, 'support': 127930}, '1': {'precision': 0.8723732566027328, 'recall': 0.7105660789780012, 'f1-score': 0.7831997479828349, 'support': 1152878}, '2': {'precision': 0.24282125883224606, 'recall': 0.5070680845604052, 'f1-score': 0.3283868791882341, 'support': 132497}, 'accuracy': 0.663150558442799, 'macro avg': {'precision': 0.4575259042906425, 'recall': 0.5383802041258717, 'f1-score': 0.47468024574030987, 'support': 1413305}, 'weighted avg': {'precision': 0.7576850404585354, 'recall': 0.663150558442799, 'f1-score': 0.6979500459458057, 'support': 1413305}}
[[ 50853  64359  12718]
 [136900 819196 196782]
 [  9824  55488  67185]]
Evaluating performance on  train set...
1288/1288 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90610653
{'0': {'precision': 0.25611540395958116, 'recall': 0.33259114119463246, 'f1-score': 0.2893859943688167, 'support': 33684}, '1': {'precision': 0.8398015240120503, 'recall': 0.7408216566580879, 'f1-score': 0.787212491744963, 'support': 262275}, '2': {'precision': 0.2569979678889845, 'recall': 0.41570671325772157, 'f1-score': 0.31763055480133945, 'support': 33769}, 'accuracy': 0.665821525621118, 'macro avg': {'precision': 0.4509716319535386, 'recall': 0.49637317037014733, 'f1-score': 0.464743013638373, 'support': 329728}, 'weighted avg': {'precision': 0.7204862806764307, 'recall': 0.665821525621118, 'f1-score': 0.6882639639697442, 'support': 329728}}
[[ 11203  19874   2607]
 [ 29998 194299  37978]
 [  2541  17190  14038]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8945414
{'0': {'precision': 0.24234074657219706, 'recall': 0.36686860661436094, 'f1-score': 0.29187737041719347, 'support': 10069}, '1': {'precision': 0.8721236112884689, 'recall': 0.7415256997676489, 'f1-score': 0.801539797666831, 'support': 92102}, '2': {'precision': 0.2521611482629261, 'recall': 0.4744757033248082, 'f1-score': 0.32930985515478556, 'support': 9775}, 'accuracy': 0.6845086023618531, 'macro avg': {'precision': 0.45554183537453063, 'recall': 0.5276233365689393, 'f1-score': 0.47424234107960334, 'support': 111946}, 'weighted avg': {'precision': 0.7613432641487513, 'recall': 0.6845086023618531, 'f1-score': 0.7144635406497707, 'support': 111946}}
[[ 3694  5545   830]
 [10881 68296 12925]
 [  668  4469  4638]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/AAL
Evaluating performance on  test set...
5918/5918 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9022727
{'0': {'precision': 0.24696709751079146, 'recall': 0.30963188634328187, 'f1-score': 0.2747719291095216, 'support': 130639}, '1': {'precision': 0.8691343315670896, 'recall': 0.7729855524165086, 'f1-score': 0.8182451086101703, 'support': 1255158}, '2': {'precision': 0.22511078663834388, 'recall': 0.4092766589786852, 'f1-score': 0.2904615824034582, 'support': 129206}, 'accuracy': 0.7020118111977336, 'macro avg': {'precision': 0.44707073857207497, 'recall': 0.49729803257949184, 'f1-score': 0.46115954004105003, 'support': 1515003}, 'weighted avg': {'precision': 0.7605596215262881, 'recall': 0.7020118111977336, 'f1-score': 0.7263696529286635, 'support': 1515003}}
[[ 40450  78177  12012]
 [114921 970219 170018]
 [  8416  67909  52881]]
Evaluating performance on  train set...
1814/1814 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9105389
{'0': {'precision': 0.26979309250332284, 'recall': 0.281760172370929, 'f1-score': 0.2756468072600505, 'support': 48268}, '1': {'precision': 0.825901206972341, 'recall': 0.7822958564422988, 'f1-score': 0.8035073645431383, 'support': 367462}, '2': {'precision': 0.24834744024191954, 'recall': 0.33664284095824665, 'f1-score': 0.2858317155499589, 'support': 48547}, 'accuracy': 0.683658677901339, 'macro avg': {'precision': 0.44801391323919443, 'recall': 0.4668996232571581, 'f1-score': 0.4549952957843826, 'support': 464277}, 'weighted avg': {'precision': 0.7076943408500642, 'recall': 0.683658677901339, 'f1-score': 0.6944983610589857, 'support': 464277}}
[[ 13600  31342   3326]
 [ 33860 287464  46138]
 [  2949  29255  16343]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90662926
{'0': {'precision': 0.24538755926200947, 'recall': 0.31966664186323385, 'f1-score': 0.2776449298778518, 'support': 13439}, '1': {'precision': 0.8767205515769465, 'recall': 0.773019303429924, 'f1-score': 0.8216106412485106, 'support': 136038}, '2': {'precision': 0.21894170261606047, 'recall': 0.41769858048927816, 'f1-score': 0.2872945392225598, 'support': 13244}, 'accuracy': 0.70665740746431, 'macro avg': {'precision': 0.44701660448500546, 'recall': 0.5034615085941453, 'f1-score': 0.4621833701163074, 'support': 162721}, 'weighted avg': {'precision': 0.7710420763994438, 'recall': 0.70665740746431, 'f1-score': 0.7331964989414821, 'support': 162721}}
[[  4296   7862   1281]
 [ 12424 105160  18454]
 [   787   6925   5532]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/WBA
Evaluating performance on  test set...
3755/3755 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99820787
{'0': {'precision': 0.43088784021071114, 'recall': 0.13703829742676893, 'f1-score': 0.20794301262487505, 'support': 229206}, '1': {'precision': 0.554155060173718, 'recall': 0.8432026362496062, 'f1-score': 0.6687836748250635, 'support': 511029}, '2': {'precision': 0.44311528731478134, 'recall': 0.22199589902364172, 'f1-score': 0.2957994951794767, 'support': 220923}, 'accuracy': 0.5320197095586782, 'macro avg': {'precision': 0.4760527292330701, 'recall': 0.4007456109000056, 'f1-score': 0.3908420608764717, 'support': 961158}, 'weighted avg': {'precision': 0.49923711103512075, 'recall': 0.5320197095586782, 'f1-score': 0.47315691133758453, 'support': 961158}}
[[ 31410 182992  14804]
 [ 33296 430901  46832]
 [  8190 163689  49044]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0236669
{'0': {'precision': 0.4769395086901641, 'recall': 0.14376585365853659, 'f1-score': 0.2209345037744477, 'support': 102500}, '1': {'precision': 0.5018977324369642, 'recall': 0.8527504126950317, 'f1-score': 0.6318888044904362, 'support': 187790}, '2': {'precision': 0.4581675194239151, 'recall': 0.18983589824120603, 'f1-score': 0.2684450119358241, 'support': 101888}, 'accuracy': 0.49522410742061, 'macro avg': {'precision': 0.4790015868503478, 'recall': 0.39545072153159144, 'f1-score': 0.3737561067335693, 'support': 392178}, 'weighted avg': {'precision': 0.48401350160932843, 'recall': 0.49522410742061, 'f1-score': 0.43005857189403063, 'support': 392178}}
[[ 14736  81127   6637]
 [ 11415 160138  16237]
 [  4746  77800  19342]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0164661
{'0': {'precision': 0.47869477461314197, 'recall': 0.14004527113473084, 'f1-score': 0.21669500774092032, 'support': 30483}, '1': {'precision': 0.5134683735093133, 'recall': 0.8642121321197785, 'f1-score': 0.6441923160463542, 'support': 58341}, '2': {'precision': 0.4804432855280313, 'recall': 0.1929382505972054, 'f1-score': 0.2753146085778992, 'support': 30559}, 'accuracy': 0.5074759387852542, 'macro avg': {'precision': 0.49086881121682885, 'recall': 0.3990652179505716, 'f1-score': 0.37873397745505794, 'support': 119383}, 'weighted avg': {'precision': 0.49613577775638373, 'recall': 0.5074759387852542, 'f1-score': 0.440612792063852, 'support': 119383}}
[[ 4269 24493  1721]
 [ 3267 50419  4655]
 [ 1382 23281  5896]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
4960/4960 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96790546
{'0': {'precision': 0.38273990587756684, 'recall': 0.16594110525851632, 'f1-score': 0.2315089522648405, 'support': 249462}, '1': {'precision': 0.634375885291121, 'recall': 0.8239831226243596, 'f1-score': 0.7168536965762885, 'support': 774528}, '2': {'precision': 0.3696372183956834, 'recall': 0.23394183609092944, 'f1-score': 0.28653615103520136, 'support': 245685}, 'accuracy': 0.5805186366589875, 'macro avg': {'precision': 0.46225100318812373, 'recall': 0.40795535465793514, 'f1-score': 0.4116329332921101, 'support': 1269675}, 'weighted avg': {'precision': 0.5337076559626159, 'recall': 0.5805186366589875, 'f1-score': 0.5382271686997182, 'support': 1269675}}
[[ 41396 190144  17922]
 [ 56235 638198  80095]
 [ 10526 177683  57476]]
Evaluating performance on  train set...
1691/1691 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99323374
{'0': {'precision': 0.4192052637032432, 'recall': 0.16513939344463038, 'f1-score': 0.23693997071742312, 'support': 97996}, '1': {'precision': 0.5783115999952279, 'recall': 0.8144958706848026, 'f1-score': 0.6763783510369247, 'support': 238054}, '2': {'precision': 0.4090500500330727, 'recall': 0.24917605975762208, 'f1-score': 0.30969746776927426, 'support': 96791}, 'accuracy': 0.5410647327771629, 'macro avg': {'precision': 0.4688556379105146, 'recall': 0.40960377462901837, 'f1-score': 0.4076719298412073, 'support': 432841}, 'weighted avg': {'precision': 0.5044397181410221, 'recall': 0.5410647327771629, 'f1-score': 0.49489227903785565, 'support': 432841}}
[[ 16183  73618   8195]
 [ 17512 193894  26648]
 [  4909  67764  24118]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0136367
{'0': {'precision': 0.44498724024790376, 'recall': 0.1675175669740887, 'f1-score': 0.2434043910901948, 'support': 36432}, '1': {'precision': 0.5364825144460403, 'recall': 0.8268810007979613, 'f1-score': 0.6507540996890415, 'support': 77698}, '2': {'precision': 0.4143358623032499, 'recall': 0.1977677485609275, 'f1-score': 0.2677398701179914, 'support': 37003}, 'accuracy': 0.5139049711181543, 'macro avg': {'precision': 0.4652685389990647, 'recall': 0.3973887721109925, 'f1-score': 0.38729945363240925, 'support': 151133}, 'weighted avg': {'precision': 0.4845206768670458, 'recall': 0.5139049711181543, 'f1-score': 0.45878252418606896, 'support': 151133}}
[[ 6103 27653  2676]
 [ 5783 64247  7668]
 [ 1829 27856  7318]]
testing model on single stock: results/universal/W8/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
10609/10609 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1011903
{'0': {'precision': 0.5332677294495834, 'recall': 0.09301734791962284, 'f1-score': 0.1584043807426606, 'support': 873880}, '1': {'precision': 0.35845972756841443, 'recall': 0.9107049835963795, 'f1-score': 0.5144345055348261, 'support': 940646}, '2': {'precision': 0.4903537904471967, 'recall': 0.09437375090301181, 'f1-score': 0.15828406634362785, 'support': 901151}, 'accuracy': 0.3766950193266725, 'macro avg': {'precision': 0.46069374915506484, 'recall': 0.36603202747300473, 'f1-score': 0.2770409842070382, 'support': 2715677}, 'weighted avg': {'precision': 0.45847813304932894, 'recall': 0.3766950193266725, 'f1-score': 0.28168483394981614, 'support': 2715677}}
[[ 81286 750546  42048]
 [ 37652 856651  46343]
 [ 33492 782614  85045]]
Evaluating performance on  train set...
3903/3903 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.122678
{'0': {'precision': 0.45655664889982234, 'recall': 0.0796598398159105, 'f1-score': 0.1356512911617283, 'support': 335489}, '1': {'precision': 0.33461941764782394, 'recall': 0.8901657465330406, 'f1-score': 0.4863983536478246, 'support': 326583}, '2': {'precision': 0.45597234419214094, 'recall': 0.09706816226000771, 'f1-score': 0.1600620460011401, 'support': 336990}, 'accuracy': 0.35047774812774385, 'macro avg': {'precision': 0.4157161369132624, 'recall': 0.35563124953631964, 'f1-score': 0.2607038969368977, 'support': 999062}, 'weighted avg': {'precision': 0.4164995436977298, 'recall': 0.35047774812774385, 'f1-score': 0.2585407696738028, 'support': 999062}}
[[ 26725 289671  19093]
 [ 15935 290713  19935]
 [ 15876 288403  32711]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1283541
{'0': {'precision': 0.48069422776911075, 'recall': 0.07437318341362352, 'f1-score': 0.1288159212646431, 'support': 99431}, '1': {'precision': 0.326896806492452, 'recall': 0.9032535885167464, 'f1-score': 0.4800562837469379, 'support': 94050}, '2': {'precision': 0.45569110369432614, 'recall': 0.07986727448765532, 'f1-score': 0.1359134986698704, 'support': 99152}, 'accuracy': 0.34263053039130925, 'macro avg': {'precision': 0.4210940459852963, 'recall': 0.3524980154726751, 'f1-score': 0.24826190122715044, 'support': 292633}, 'weighted avg': {'precision': 0.42279318028187324, 'recall': 0.34263053039130925, 'f1-score': 0.24410672950001958, 'support': 292633}}
[[ 7395 87770  4266]
 [ 3906 84951  5193]
 [ 4083 87150  7919]]
training model: results/universal/W8/deepOF_L1/h20
Epoch 1/50
7695/7695 - 112s - loss: 3.0448 - accuracy20: 0.4705 - val_loss: 3.2233 - val_accuracy20: 0.4219 - 112s/epoch - 14ms/step
Epoch 2/50
7695/7695 - 109s - loss: 3.0295 - accuracy20: 0.4727 - val_loss: 3.2215 - val_accuracy20: 0.4345 - 109s/epoch - 14ms/step
Epoch 3/50
7695/7695 - 109s - loss: 3.0149 - accuracy20: 0.4776 - val_loss: 3.2376 - val_accuracy20: 0.4364 - 109s/epoch - 14ms/step
Epoch 4/50
7695/7695 - 108s - loss: 3.0054 - accuracy20: 0.4803 - val_loss: 3.2553 - val_accuracy20: 0.4416 - 108s/epoch - 14ms/step
Epoch 5/50
7695/7695 - 111s - loss: 2.9955 - accuracy20: 0.4825 - val_loss: 3.2796 - val_accuracy20: 0.4407 - 111s/epoch - 14ms/step
Epoch 6/50
7695/7695 - 109s - loss: 2.9884 - accuracy20: 0.4840 - val_loss: 3.2685 - val_accuracy20: 0.4447 - 109s/epoch - 14ms/step
Epoch 7/50
7695/7695 - 107s - loss: 2.9810 - accuracy20: 0.4852 - val_loss: 3.3475 - val_accuracy20: 0.4456 - 107s/epoch - 14ms/step
Epoch 8/50
7695/7695 - 110s - loss: 2.9738 - accuracy20: 0.4860 - val_loss: 3.3675 - val_accuracy20: 0.4477 - 110s/epoch - 14ms/step
Epoch 9/50
7695/7695 - 111s - loss: 2.9681 - accuracy20: 0.4868 - val_loss: 3.3893 - val_accuracy20: 0.4536 - 111s/epoch - 14ms/step
Epoch 10/50
7695/7695 - 109s - loss: 2.9614 - accuracy20: 0.4874 - val_loss: 3.3528 - val_accuracy20: 0.4572 - 109s/epoch - 14ms/step
Epoch 11/50
7695/7695 - 108s - loss: 2.9558 - accuracy20: 0.4889 - val_loss: 3.3657 - val_accuracy20: 0.4600 - 108s/epoch - 14ms/step
Epoch 12/50
7695/7695 - 112s - loss: 2.9498 - accuracy20: 0.4905 - val_loss: 3.4172 - val_accuracy20: 0.4631 - 112s/epoch - 15ms/step
testing model in sample: results/universal/W8/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 124s - 124s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401801
{'0': {'precision': 0.39894680090055323, 'recall': 0.2717893581750012, 'f1-score': 0.32331489363023114, 'support': 1532801}, '1': {'precision': 0.500778765735609, 'recall': 0.6422273309175972, 'f1-score': 0.5627508217852807, 'support': 2876142}, '2': {'precision': 0.3820758903308752, 'recall': 0.3023537371134021, 'f1-score': 0.3375718077367295, 'support': 1552000}, 'accuracy': 0.45848265953893536, 'macro avg': {'precision': 0.42726715232234574, 'recall': 0.4054568087353336, 'f1-score': 0.40787917438408045, 'support': 5960943}, 'weighted avg': {'precision': 0.44368796648467085, 'recall': 0.45848265953893536, 'f1-score': 0.4425541582850024, 'support': 5960943}}
[[ 416599  924178  192024]
 [ 462115 1847137  566890]
 [ 165533  917214  469253]]
Evaluating performance on  train set...
7695/7695 - 46s - 46s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0647333
{'0': {'precision': 0.39167619099043965, 'recall': 0.2333876131251039, 'f1-score': 0.29248972898866943, 'support': 559447}, '1': {'precision': 0.44570672758973123, 'recall': 0.6535911141099593, 'f1-score': 0.5299927746628971, 'support': 850697}, '2': {'precision': 0.38911117572439063, 'recall': 0.27036696017521117, 'f1-score': 0.31904865384899395, 'support': 559325}, 'accuracy': 0.4253933420632668, 'macro avg': {'precision': 0.40883136476818716, 'recall': 0.38578189580342476, 'f1-score': 0.38051038583352015, 'support': 1969469}, 'weighted avg': {'precision': 0.41428580720157304, 'recall': 0.4253933420632668, 'f1-score': 0.4026200225314617, 'support': 1969469}}
[[130568 350859  78020]
 [135295 556008 159394]
 [ 67494 340608 151223]]
Evaluating performance on  val set...
2338/2338 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0585297
{'0': {'precision': 0.3919989788646251, 'recall': 0.22228589006640892, 'f1-score': 0.28369848039291157, 'support': 165791}, '1': {'precision': 0.46020774646978174, 'recall': 0.6660563075014387, 'f1-score': 0.5443204392725007, 'support': 267602}, '2': {'precision': 0.3834906024882585, 'recall': 0.2717019697541153, 'f1-score': 0.31805962549803635, 'support': 164386}, 'accuracy': 0.4345334981657101, 'macro avg': {'precision': 0.41189910927422174, 'recall': 0.386681389107321, 'f1-score': 0.3820261817211496, 'support': 597779}, 'weighted avg': {'precision': 0.420193587021937, 'recall': 0.4345334981657101, 'f1-score': 0.4098177462743608, 'support': 597779}}
[[ 36853 106826  22112]
 [ 39673 178238  49691]
 [ 17487 102235  44664]]
testing model out of sample: results/universal/W8/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 77s - 77s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0180558
{'0': {'precision': 0.32132362772041895, 'recall': 0.2905865899647076, 'f1-score': 0.3051831283602222, 'support': 744353}, '1': {'precision': 0.6137449322059205, 'recall': 0.6049924768328638, 'f1-score': 0.6093372763075029, 'support': 2133410}, '2': {'precision': 0.3074213695734203, 'recall': 0.3497279525074681, 'f1-score': 0.32721283436010323, 'support': 738474}, 'accuracy': 0.48814859203088734, 'macro avg': {'precision': 0.4141633098332533, 'recall': 0.4151023397683465, 'f1-score': 0.4139110796759428, 'support': 3616237}, 'weighted avg': {'precision': 0.49099947557540397, 'recall': 0.48814859203088734, 'f1-score': 0.48911849152385456, 'support': 3616237}}
[[ 216299  416412  111642]
 [ 372519 1290697  470194]
 [  84332  395877  258265]]
Evaluating performance on  train set...
4550/4550 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0318823
{'0': {'precision': 0.34847413096200486, 'recall': 0.277387981938173, 'f1-score': 0.30889403257623416, 'support': 273505}, '1': {'precision': 0.5541827689111508, 'recall': 0.611955556707645, 'f1-score': 0.5816380740026701, 'support': 617236}, '2': {'precision': 0.3523743718118626, 'recall': 0.34135083137650785, 'f1-score': 0.3467750176033115, 'support': 273402}, 'accuracy': 0.469799672377019, 'macro avg': {'precision': 0.41834375722833944, 'recall': 0.4102314566741086, 'f1-score': 0.4124357080607386, 'support': 1164143}, 'weighted avg': {'precision': 0.4584581367946318, 'recall': 0.469799672377019, 'f1-score': 0.4624011001978757, 'support': 1164143}}
[[ 75867 155983  41655]
 [109647 377721 129868]
 [ 32198 147878  93326]]
Evaluating performance on  val set...
1570/1570 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0315012
{'0': {'precision': 0.3284507632166791, 'recall': 0.31134270747173975, 'f1-score': 0.3196680009285104, 'support': 90675}, '1': {'precision': 0.5633127297987284, 'recall': 0.5815268528414956, 'f1-score': 0.5722749001566478, 'support': 218934}, '2': {'precision': 0.3312674032156651, 'recall': 0.3227302559614964, 'f1-score': 0.32694310853039604, 'support': 91420}, 'accuracy': 0.4614404444566353, 'macro avg': {'precision': 0.40767696541035753, 'recall': 0.40519993875824395, 'f1-score': 0.40629533653851807, 'support': 401029}, 'weighted avg': {'precision': 0.45731118732661047, 'recall': 0.4614404444566353, 'f1-score': 0.45923229481393374, 'support': 401029}}
[[ 28231  48971  13473]
 [ 45531 127316  46087]
 [ 12190  49726  29504]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1255738
{'0': {'precision': 0.3538763394878503, 'recall': 0.12870290743417562, 'f1-score': 0.18875620555481015, 'support': 54653}, '1': {'precision': 0.3713726825775239, 'recall': 0.7467952094967162, 'f1-score': 0.4960602826331659, 'support': 56946}, '2': {'precision': 0.3654557961282715, 'recall': 0.20924606151537883, 'f1-score': 0.26612124175601376, 'support': 53320}, 'accuracy': 0.36816861610851387, 'macro avg': {'precision': 0.3635682727312153, 'recall': 0.3615813928154235, 'f1-score': 0.31697924331466326, 'support': 164919}, 'weighted avg': {'precision': 0.36366152725670536, 'recall': 0.36816861610851387, 'f1-score': 0.3198802222148204, 'support': 164919}}
[[ 7034 36492 11127]
 [ 6174 42527  8245]
 [ 6669 35494 11157]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1297165
{'0': {'precision': 0.3395181804578782, 'recall': 0.12019918419240345, 'f1-score': 0.17754303599374022, 'support': 18877}, '1': {'precision': 0.3491561181434599, 'recall': 0.766405304425617, 'f1-score': 0.4797496500041175, 'support': 19003}, '2': {'precision': 0.3838337709784222, 'recall': 0.17443187714018885, 'f1-score': 0.23986016480576464, 'support': 19274}, 'accuracy': 0.3533435979983903, 'macro avg': {'precision': 0.35750268985992006, 'recall': 0.35367878858606977, 'f1-score': 0.29905095026787415, 'support': 57154}, 'weighted avg': {'precision': 0.3576671887780671, 'recall': 0.3533435979983903, 'f1-score': 0.2990381654118415, 'support': 57154}}
[[ 2269 13593  3015]
 [ 2057 14564  2382]
 [ 2357 13555  3362]]
Evaluating performance on  val set...
68/68 - 1s - 589ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1400065
{'0': {'precision': 0.356532877882152, 'recall': 0.13963210702341136, 'f1-score': 0.20067291516462385, 'support': 5980}, '1': {'precision': 0.32195882208186366, 'recall': 0.746765601217656, 'f1-score': 0.44993408608929897, 'support': 5256}, '2': {'precision': 0.37971872686898595, 'recall': 0.1710285047507918, 'f1-score': 0.23583496149867833, 'support': 5999}, 'accuracy': 0.33571221351900205, 'macro avg': {'precision': 0.35273680894433385, 'recall': 0.35247540433061975, 'f1-score': 0.29548065425086706, 'support': 17235}, 'weighted avg': {'precision': 0.35405946162370705, 'recall': 0.33571221351900205, 'f1-score': 0.2889266912213738, 'support': 17235}}
[[ 835 4186  959]
 [ 614 3925  717]
 [ 893 4080 1026]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
2179/2179 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.948981
{'0': {'precision': 0.34191594593879765, 'recall': 0.37494380555998663, 'f1-score': 0.35766902991526894, 'support': 68957}, '1': {'precision': 0.8137185458264848, 'recall': 0.7062052891165344, 'f1-score': 0.7561593912847901, 'support': 421318}, '2': {'precision': 0.28623418536384393, 'recall': 0.49404444444444445, 'f1-score': 0.36246644131169636, 'support': 67500}, 'accuracy': 0.639576890323159, 'macro avg': {'precision': 0.4806228923763755, 'recall': 0.5250645130403219, 'f1-score': 0.49209828750391854, 'support': 557775}, 'weighted avg': {'precision': 0.6915558705332511, 'recall': 0.639576890323159, 'f1-score': 0.659251186413396, 'support': 557775}}
[[ 25855  37466   5636]
 [ 46259 297537  77522]
 [  3504  30648  33348]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96706915
{'0': {'precision': 0.3622464275007495, 'recall': 0.30070510161758607, 'f1-score': 0.3286193454809174, 'support': 24110}, '1': {'precision': 0.7451327098915438, 'recall': 0.7251854305854637, 'f1-score': 0.7350237614435018, 'support': 108666}, '2': {'precision': 0.33529205122473094, 'recall': 0.43191541879216716, 'f1-score': 0.3775192822854677, 'support': 24308}, 'accuracy': 0.6146520333070205, 'macro avg': {'precision': 0.4808903962056747, 'recall': 0.4859353169984057, 'f1-score': 0.4803874630699623, 'support': 157084}, 'weighted avg': {'precision': 0.6229446130814618, 'recall': 0.6146520333070205, 'f1-score': 0.6173247637847242, 'support': 157084}}
[[ 7250 14471  2389]
 [11438 78803 18425]
 [ 1326 12483 10499]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96071064
{'0': {'precision': 0.350896002450605, 'recall': 0.3387049083382614, 'f1-score': 0.34469269540359593, 'support': 6764}, '1': {'precision': 0.7844988200223575, 'recall': 0.7220555031581354, 'f1-score': 0.7519830934769991, 'support': 34989}, '2': {'precision': 0.30752009769003763, 'recall': 0.4439547524607022, 'f1-score': 0.36335217025369726, 'support': 6807}, 'accuracy': 0.629674629324547, 'macro avg': {'precision': 0.48097164005433335, 'recall': 0.5015717213190329, 'f1-score': 0.4866759863780974, 'support': 48560}, 'weighted avg': {'precision': 0.6572400963614959, 'recall': 0.629674629324547, 'f1-score': 0.6407738070900652, 'support': 48560}}
[[ 2291  3689   784]
 [ 3704 25264  6021]
 [  534  3251  3022]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
1162/1162 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0386132
{'0': {'precision': 0.4105425249391863, 'recall': 0.24004071140571787, 'f1-score': 0.30294945901882314, 'support': 76637}, '1': {'precision': 0.49513436348974565, 'recall': 0.6262180079110217, 'f1-score': 0.5530144897549338, 'support': 145114}, '2': {'precision': 0.336849110927847, 'recall': 0.30752770549618924, 'f1-score': 0.3215212948130144, 'support': 75707}, 'accuracy': 0.44561248983049706, 'macro avg': {'precision': 0.41417533311892624, 'recall': 0.39126214160430955, 'f1-score': 0.39249508119559046, 'support': 297458}, 'weighted avg': {'precision': 0.43305445188305536, 'recall': 0.44561248983049706, 'f1-score': 0.42966971815695626, 'support': 297458}}
[[18396 47841 10400]
 [18806 90873 35435]
 [ 7607 44818 23282]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0784036
{'0': {'precision': 0.4683747917504452, 'recall': 0.293674807290541, 'f1-score': 0.36099980074830085, 'support': 27762}, '1': {'precision': 0.3449712273469037, 'recall': 0.5776227798950169, 'f1-score': 0.43196300379103597, 'support': 27814}, '2': {'precision': 0.44783961638524716, 'recall': 0.3134685424551882, 'f1-score': 0.36879581591715854, 'support': 28006}, 'accuracy': 0.39479792299777466, 'macro avg': {'precision': 0.42039521182753203, 'recall': 0.39492204321358204, 'f1-score': 0.38725287348549847, 'support': 83582}, 'weighted avg': {'precision': 0.42042840542805715, 'recall': 0.39479792299777466, 'f1-score': 0.38722680812129584, 'support': 83582}}
[[ 8153 15117  4492]
 [ 5416 16066  6332]
 [ 3838 15389  8779]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637296
{'0': {'precision': 0.4331227684702005, 'recall': 0.3214758944042401, 'f1-score': 0.3690399578774937, 'support': 9811}, '1': {'precision': 0.38938933083762284, 'recall': 0.5568381430363865, 'f1-score': 0.4582974768510551, 'support': 11955}, '2': {'precision': 0.44308065821418935, 'recall': 0.3276481149012567, 'f1-score': 0.3767201834862385, 'support': 10026}, 'accuracy': 0.41192752893809764, 'macro avg': {'precision': 0.42186425250733756, 'recall': 0.4019873841139611, 'f1-score': 0.4013525394049291, 'support': 31792}, 'weighted avg': {'precision': 0.41981767774535667, 'recall': 0.41192752893809764, 'f1-score': 0.4050262305650315, 'support': 31792}}
[[3154 5077 1580]
 [2749 6657 2549]
 [1379 5362 3285]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1223/1223 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0946634
{'0': {'precision': 0.39724746125066807, 'recall': 0.19949194785276073, 'f1-score': 0.2656022666360364, 'support': 104320}, '1': {'precision': 0.35631409500618394, 'recall': 0.6860285192769187, 'f1-score': 0.46902357755507973, 'support': 107927}, '2': {'precision': 0.4422913157844937, 'recall': 0.23190879233188796, 'f1-score': 0.30427537363953555, 'support': 100781}, 'accuracy': 0.37767867411222, 'macro avg': {'precision': 0.3986176240137819, 'recall': 0.37247641982052243, 'f1-score': 0.3463004059435506, 'support': 313028}, 'weighted avg': {'precision': 0.39763640180903675, 'recall': 0.37767867411222, 'f1-score': 0.34818965888362846, 'support': 313028}}
[[20811 69896 13613]
 [18028 74041 15858]
 [13549 63860 23372]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0945308
{'0': {'precision': 0.4289683712681052, 'recall': 0.23106072668216412, 'f1-score': 0.30034355726644313, 'support': 31403}, '1': {'precision': 0.335005274944937, 'recall': 0.5999535947495774, 'f1-score': 0.42993895341932115, 'support': 30169}, '2': {'precision': 0.42499877887949983, 'recall': 0.2915396213771151, 'f1-score': 0.3458404547080568, 'support': 29845}, 'accuracy': 0.37254558780095604, 'macro avg': {'precision': 0.396324141697514, 'recall': 0.3741846476029522, 'f1-score': 0.35870765513127373, 'support': 91417}, 'weighted avg': {'precision': 0.3966631639454892, 'recall': 0.37254558780095604, 'f1-score': 0.3579654264010804, 'support': 91417}}
[[ 7256 18847  5300]
 [ 5597 18100  6472]
 [ 4062 17082  8701]]
Evaluating performance on  val set...
99/99 - 1s - 699ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0938889
{'0': {'precision': 0.44307968843618933, 'recall': 0.17271984117715755, 'f1-score': 0.24855054197126292, 'support': 8563}, '1': {'precision': 0.3334194214876033, 'recall': 0.6177772460820672, 'f1-score': 0.43309430955675765, 'support': 8359}, '2': {'precision': 0.41284403669724773, 'recall': 0.31853629274145173, 'f1-score': 0.3596099146688338, 'support': 8335}, 'accuracy': 0.3681355663776379, 'macro avg': {'precision': 0.39644771554034675, 'recall': 0.3696777933335588, 'f1-score': 0.3470849220656181, 'support': 25257}, 'weighted avg': {'precision': 0.3968087802258987, 'recall': 0.3681355663776379, 'f1-score': 0.3462771613116994, 'support': 25257}}
[[1479 5397 1687]
 [1106 5164 2089]
 [ 753 4927 2655]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0925416
{'0': {'precision': 0.43028094835178116, 'recall': 0.20777812984673882, 'f1-score': 0.28023414699978066, 'support': 119926}, '1': {'precision': 0.35556155623277486, 'recall': 0.6506325539808155, 'f1-score': 0.459831599252784, 'support': 127499}, '2': {'precision': 0.4209378687599405, 'recall': 0.26953686441025976, 'f1-score': 0.3286384506386409, 'support': 121757}, 'accuracy': 0.381088460434149, 'macro avg': {'precision': 0.40226012444816556, 'recall': 0.37598251607927136, 'f1-score': 0.3562347322970685, 'support': 369182}, 'weighted avg': {'precision': 0.4013948349506811, 'recall': 0.381088460434149, 'f1-score': 0.3582229394191358, 'support': 369182}}
[[24918 75747 19261]
 [18659 82955 25885]
 [14334 74605 32818]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0942434
{'0': {'precision': 0.4442784417884019, 'recall': 0.1918472676877494, 'f1-score': 0.26797723745473356, 'support': 41851}, '1': {'precision': 0.3368652932634325, 'recall': 0.655813507750545, 'f1-score': 0.4451002869988699, 'support': 41739}, '2': {'precision': 0.43510515968693203, 'recall': 0.27471369352912245, 'f1-score': 0.3367883085934135, 'support': 42699}, 'accuracy': 0.3732074844206542, 'macro avg': {'precision': 0.40541629824625547, 'recall': 0.37412482298913896, 'f1-score': 0.34995527768233897, 'support': 126289}, 'weighted avg': {'precision': 0.40567644653359464, 'recall': 0.3732074844206542, 'f1-score': 0.34978248487512015, 'support': 126289}}
[[ 8029 27532  6290]
 [ 5427 27373  8939]
 [ 4616 26353 11730]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0882943
{'0': {'precision': 0.4425749817117776, 'recall': 0.23692042606516292, 'f1-score': 0.3086262306789777, 'support': 12768}, '1': {'precision': 0.3521220159151194, 'recall': 0.6507352941176471, 'f1-score': 0.4569707401032702, 'support': 13056}, '2': {'precision': 0.4310368823938761, 'recall': 0.2512982797792924, 'f1-score': 0.317494489722692, 'support': 12324}, 'accuracy': 0.383191779385551, 'macro avg': {'precision': 0.40857796000692437, 'recall': 0.3796513333207008, 'f1-score': 0.36103048683498, 'support': 38148}, 'weighted avg': {'precision': 0.407890346673637, 'recall': 0.383191779385551, 'f1-score': 0.3622615022396964, 'support': 38148}}
[[3025 8026 1717]
 [2189 8496 2371]
 [1621 7606 3097]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/EXC
Evaluating performance on  test set...
5521/5521 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96150637
{'0': {'precision': 0.2997686492277014, 'recall': 0.5256535023197918, 'f1-score': 0.3818032749830991, 'support': 176740}, '1': {'precision': 0.8318059577412138, 'recall': 0.566040511808034, 'f1-score': 0.6736589179162648, 'support': 1053520}, '2': {'precision': 0.28646725489688724, 'recall': 0.6048294135321916, 'f1-score': 0.3887904620598228, 'support': 183045}, 'accuracy': 0.566013705463435, 'macro avg': {'precision': 0.4726806206219341, 'recall': 0.5655078092200059, 'f1-score': 0.48141755165306227, 'support': 1413305}, 'weighted avg': {'precision': 0.6946425027411834, 'recall': 0.566013705463435, 'f1-score': 0.6002661875188982, 'support': 1413305}}
[[ 92904  63546  20290]
 [201716 596335 255469]
 [ 15299  57035 110711]]
Evaluating performance on  train set...
1288/1288 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9688017
{'0': {'precision': 0.29085686931546195, 'recall': 0.4684244146346836, 'f1-score': 0.3588774322021027, 'support': 45399}, '1': {'precision': 0.79145832377632, 'recall': 0.578096466685654, 'f1-score': 0.6681576577884921, 'support': 238756}, '2': {'precision': 0.29237056226511476, 'recall': 0.5274833783161083, 'f1-score': 0.3762148457674069, 'support': 45573}, 'accuracy': 0.5560007036102484, 'macro avg': {'precision': 0.4582285851189656, 'recall': 0.5246680865454819, 'f1-score': 0.4677499785860006, 'support': 329728}, 'weighted avg': {'precision': 0.6535515279130063, 'recall': 0.5560007036102484, 'f1-score': 0.5852234734497845, 'support': 329728}}
[[ 21266  19248   4885]
 [ 47435 138024  53297]
 [  4414  17120  24039]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9592396
{'0': {'precision': 0.28238225562681263, 'recall': 0.5000723379629629, 'f1-score': 0.36094504633859803, 'support': 13824}, '1': {'precision': 0.830122591943958, 'recall': 0.587776793622675, 'f1-score': 0.68823895457374, 'support': 84675}, '2': {'precision': 0.27942566339512903, 'recall': 0.5716516695173645, 'f1-score': 0.37536928974290107, 'support': 13447}, 'accuracy': 0.5750093795222697, 'macro avg': {'precision': 0.46397683698863323, 'recall': 0.5531669337010007, 'f1-score': 0.4748510968850797, 'support': 111946}, 'weighted avg': {'precision': 0.6963332291490003, 'recall': 0.5750093795222697, 'f1-score': 0.6102400142773212, 'support': 111946}}
[[ 6913  5511  1400]
 [16482 49770 18423]
 [ 1086  4674  7687]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/AAL
Evaluating performance on  test set...
5918/5918 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9680716
{'0': {'precision': 0.2511185968321338, 'recall': 0.4396799194202736, 'f1-score': 0.31966427785360774, 'support': 178705}, '1': {'precision': 0.8245678508234654, 'recall': 0.5746746498999221, 'f1-score': 0.6773068152885987, 'support': 1159597}, '2': {'precision': 0.2299049857719811, 'recall': 0.512555107215013, 'f1-score': 0.3174284402480014, 'support': 176701}, 'accuracy': 0.5515058386022998, 'macro avg': {'precision': 0.43519714447586005, 'recall': 0.5089698921784029, 'f1-score': 0.43813317779673594, 'support': 1515003}, 'weighted avg': {'precision': 0.6875676126378095, 'recall': 0.5515058386022998, 'f1-score': 0.5931463361341888, 'support': 1515003}}
[[ 78573  75571  24561]
 [214395 666391 278811]
 [ 19924  66208  90569]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9781378
{'0': {'precision': 0.2539426313944968, 'recall': 0.37382943797389195, 'f1-score': 0.30243853081048266, 'support': 63965}, '1': {'precision': 0.764433127847762, 'recall': 0.5937916389073951, 'f1-score': 0.6683930538304703, 'support': 336224}, '2': {'precision': 0.259518651784403, 'recall': 0.44115903133191864, 'f1-score': 0.3267950436913403, 'support': 64088}, 'accuracy': 0.5424175653758424, 'macro avg': {'precision': 0.4259648036755539, 'recall': 0.4695933694044019, 'f1-score': 0.43254220944409777, 'support': 464277}, 'weighted avg': {'precision': 0.6244036119605187, 'recall': 0.5424175653758424, 'f1-score': 0.5708206685114257, 'support': 464277}}
[[ 23912  32001   8052]
 [ 63958 199647  72619]
 [  6293  29522  28273]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9714174
{'0': {'precision': 0.2125522598520644, 'recall': 0.4731538080290765, 'f1-score': 0.2933324229285446, 'support': 18159}, '1': {'precision': 0.8307957762737402, 'recall': 0.5398542428286051, 'f1-score': 0.654446603428637, 'support': 126649}, '2': {'precision': 0.22384440388990276, 'recall': 0.49986043655445767, 'f1-score': 0.3092171150326346, 'support': 17913}, 'accuracy': 0.5280080628806362, 'macro avg': {'precision': 0.42239748000523586, 'recall': 0.5042894958040464, 'f1-score': 0.4189987137966054, 'support': 162721}, 'weighted avg': {'precision': 0.6949866062943713, 'recall': 0.5280080628806362, 'f1-score': 0.5761434450819038, 'support': 162721}}
[[ 8592  7154  2413]
 [29643 68372 28634]
 [ 2188  6771  8954]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/WBA
Evaluating performance on  test set...
3755/3755 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0563601
{'0': {'precision': 0.43147608309040575, 'recall': 0.2455644866769388, 'f1-score': 0.3129951367430809, 'support': 287509}, '1': {'precision': 0.43865130044690936, 'recall': 0.6475099142765582, 'f1-score': 0.5229998311475195, 'support': 399424}, '2': {'precision': 0.42834401031145997, 'recall': 0.3247807457379889, 'f1-score': 0.36944181155617867, 'support': 274225}, 'accuracy': 0.4352000399518081, 'macro avg': {'precision': 0.4328237979495917, 'recall': 0.4059517155638286, 'f1-score': 0.40181225981559304, 'support': 961158}, 'weighted avg': {'precision': 0.43356425315151714, 'recall': 0.4352000399518081, 'f1-score': 0.41637044492177805, 'support': 961158}}
[[ 70602 174267  42640]
 [ 64572 258631  76221]
 [ 28455 156707  89063]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0713235
{'0': {'precision': 0.4660224733247301, 'recall': 0.237921919316091, 'f1-score': 0.3150162497406957, 'support': 124461}, '1': {'precision': 0.39083826990180964, 'recall': 0.6683967664712209, 'f1-score': 0.49325225628880504, 'support': 144115}, '2': {'precision': 0.4443633177570093, 'recall': 0.2954321127489846, 'f1-score': 0.3549067441611834, 'support': 123602}, 'accuracy': 0.41423537271341077, 'macro avg': {'precision': 0.4337413536611831, 'recall': 0.4005835995120988, 'f1-score': 0.38772508339689465, 'support': 392178}, 'weighted avg': {'precision': 0.4315680000427622, 'recall': 0.41423537271341077, 'f1-score': 0.3930854605965874, 'support': 392178}}
[[29612 76484 18365]
 [20494 96326 27295]
 [13436 73650 36516]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0676538
{'0': {'precision': 0.47219660391688817, 'recall': 0.23075903390864022, 'f1-score': 0.3100156717481123, 'support': 37719}, '1': {'precision': 0.3976191413684031, 'recall': 0.6850817484905362, 'f1-score': 0.503189050925157, 'support': 44221}, '2': {'precision': 0.4505028474494123, 'recall': 0.29789279705151833, 'f1-score': 0.35863798591685153, 'support': 37443}, 'accuracy': 0.4201016895202835, 'macro avg': {'precision': 0.44010619757823455, 'recall': 0.40457785981689826, 'f1-score': 0.39061423619670693, 'support': 119383}, 'weighted avg': {'precision': 0.4377681736146822, 'recall': 0.4201016895202835, 'f1-score': 0.3968193649875869, 'support': 119383}}
[[ 8704 23688  5327]
 [ 5648 30295  8278]
 [ 4081 22208 11154]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
4960/4960 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0371268
{'0': {'precision': 0.36804501956367336, 'recall': 0.2785117290860981, 'f1-score': 0.3170792200198055, 'support': 314432}, '1': {'precision': 0.5348289389606444, 'recall': 0.6339906310244097, 'f1-score': 0.5802033867487525, 'support': 644254}, '2': {'precision': 0.37402902660149984, 'recall': 0.32236188418239875, 'f1-score': 0.3462787922330701, 'support': 310989}, 'accuracy': 0.4696280544233761, 'macro avg': {'precision': 0.42563432837527254, 'recall': 0.4116214147643022, 'f1-score': 0.414520466333876, 'support': 1269675}, 'weighted avg': {'precision': 0.4541396245388543, 'recall': 0.4696280544233761, 'f1-score': 0.4577447782727616, 'support': 1269675}}
[[ 87573 180522  46337]
 [114361 408451 121442]
 [ 36007 174731 100251]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0494155
{'0': {'precision': 0.41230222836073055, 'recall': 0.27619991738950844, 'f1-score': 0.3307987988582228, 'support': 121050}, '1': {'precision': 0.47767960383091046, 'recall': 0.6224955314461488, 'f1-score': 0.5405565156184434, 'support': 192456}, '2': {'precision': 0.4088441573879621, 'recall': 0.3458499182972305, 'f1-score': 0.37471797642124, 'support': 119335}, 'accuracy': 0.4493774850349204, 'macro avg': {'precision': 0.43294199652653437, 'recall': 0.41484845571096257, 'f1-score': 0.4153577636326354, 'support': 432841}, 'weighted avg': {'precision': 0.44041786267899896, 'recall': 0.4493774850349204, 'f1-score': 0.4361728881688188, 'support': 432841}}
[[ 33434  68004  19612]
 [ 32589 119803  40064]
 [ 15068  62995  41272]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0629272
{'0': {'precision': 0.4291799418201967, 'recall': 0.2819346179220602, 'f1-score': 0.3403127703101616, 'support': 43957}, '1': {'precision': 0.43991670635667846, 'recall': 0.6404108484633494, 'f1-score': 0.5215592806350583, 'support': 62018}, '2': {'precision': 0.4150872583974479, 'recall': 0.29390141281721954, 'f1-score': 0.34413732303064876, 'support': 45158}, 'accuracy': 0.43261233483091055, 'macro avg': {'precision': 0.428061302191441, 'recall': 0.40541562640087636, 'f1-score': 0.40200312465862287, 'support': 151133}, 'weighted avg': {'precision': 0.42937497047058437, 'recall': 0.43261233483091055, 'f1-score': 0.41583072621046935, 'support': 151133}}
[[12393 24806  6758]
 [10357 39717 11944]
 [ 6126 25760 13272]]
testing model on single stock: results/universal/W8/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
10609/10609 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0878453
{'0': {'precision': 0.46629966653478777, 'recall': 0.2303828432604507, 'f1-score': 0.30839712918660284, 'support': 895275}, '1': {'precision': 0.3430132530147125, 'recall': 0.6940420805120627, 'f1-score': 0.45911847530051814, 'support': 893953}, '2': {'precision': 0.4580072154917814, 'recall': 0.2296618594223751, 'f1-score': 0.3059226961801, 'support': 926449}, 'accuracy': 0.38276532886643, 'macro avg': {'precision': 0.4224400450137606, 'recall': 0.38469559439829615, 'f1-score': 0.35781276688907365, 'support': 2715677}, 'weighted avg': {'precision': 0.4228869955132141, 'recall': 0.38276532886643, 'f1-score': 0.3571677906231917, 'support': 2715677}}
[[206256 579093 109926]
 [131652 620441 141860]
 [104417 609262 212770]]
Evaluating performance on  train set...
3903/3903 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1062782
{'0': {'precision': 0.4088812103685064, 'recall': 0.19552554224513133, 'f1-score': 0.2645460859774779, 'support': 334074}, '1': {'precision': 0.33739477248632754, 'recall': 0.6829487736746598, 'f1-score': 0.45165835954123357, 'support': 328991}, '2': {'precision': 0.4148848423323393, 'recall': 0.21407631615758474, 'f1-score': 0.2824244946679022, 'support': 335997}, 'accuracy': 0.3622728118975599, 'macro avg': {'precision': 0.3870536083957244, 'recall': 0.36418354402579195, 'f1-score': 0.3328763133955379, 'support': 999062}, 'weighted avg': {'precision': 0.3873598309582757, 'recall': 0.3622728118975599, 'f1-score': 0.33217486745127034, 'support': 999062}}
[[ 65320 221311  47443]
 [ 50308 224684  53999]
 [ 44125 219943  71929]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1057866
{'0': {'precision': 0.4227910817506193, 'recall': 0.17597881137473337, 'f1-score': 0.24851707769727682, 'support': 98921}, '1': {'precision': 0.33204316093876024, 'recall': 0.70801610772038, 'f1-score': 0.45207405671431916, 'support': 95358}, '2': {'precision': 0.41943191971242755, 'recall': 0.20523822111962908, 'f1-score': 0.27561253677951403, 'support': 98354}, 'accuracy': 0.3591836874173453, 'macro avg': {'precision': 0.39142205413393566, 'recall': 0.3630777134049142, 'f1-score': 0.32540122373037, 'support': 292633}, 'weighted avg': {'precision': 0.39209075999647136, 'recall': 0.3591836874173453, 'f1-score': 0.32395536793686525, 'support': 292633}}
[[17408 68709 12804]
 [12706 67515 15137]
 [11060 67108 20186]]
training model: results/universal/W8/deepOF_L1/h30
Epoch 1/50
7695/7695 - 124s - loss: 3.0857 - accuracy30: 0.4577 - val_loss: 3.2189 - val_accuracy30: 0.3651 - 124s/epoch - 16ms/step
Epoch 2/50
7695/7695 - 114s - loss: 3.0727 - accuracy30: 0.4593 - val_loss: 3.2191 - val_accuracy30: 0.4135 - 114s/epoch - 15ms/step
Epoch 3/50
7695/7695 - 112s - loss: 3.0636 - accuracy30: 0.4625 - val_loss: 3.2127 - val_accuracy30: 0.4041 - 112s/epoch - 14ms/step
Epoch 4/50
7695/7695 - 106s - loss: 3.0545 - accuracy30: 0.4650 - val_loss: 3.2182 - val_accuracy30: 0.4097 - 106s/epoch - 14ms/step
Epoch 5/50
7695/7695 - 106s - loss: 3.0458 - accuracy30: 0.4675 - val_loss: 3.2364 - val_accuracy30: 0.4144 - 106s/epoch - 14ms/step
Epoch 6/50
7695/7695 - 108s - loss: 3.0384 - accuracy30: 0.4686 - val_loss: 3.2186 - val_accuracy30: 0.4132 - 108s/epoch - 14ms/step
Epoch 7/50
7695/7695 - 105s - loss: 3.0324 - accuracy30: 0.4695 - val_loss: 3.2217 - val_accuracy30: 0.4184 - 105s/epoch - 14ms/step
Epoch 8/50
7695/7695 - 107s - loss: 3.0271 - accuracy30: 0.4709 - val_loss: 3.2153 - val_accuracy30: 0.4225 - 107s/epoch - 14ms/step
Epoch 9/50
7695/7695 - 107s - loss: 3.0218 - accuracy30: 0.4722 - val_loss: 3.2134 - val_accuracy30: 0.4109 - 107s/epoch - 14ms/step
Epoch 10/50
7695/7695 - 107s - loss: 3.0167 - accuracy30: 0.4732 - val_loss: 3.2204 - val_accuracy30: 0.4283 - 107s/epoch - 14ms/step
Epoch 11/50
7695/7695 - 106s - loss: 3.0121 - accuracy30: 0.4740 - val_loss: 3.2190 - val_accuracy30: 0.4273 - 106s/epoch - 14ms/step
Epoch 12/50
7695/7695 - 107s - loss: 3.0066 - accuracy30: 0.4751 - val_loss: 3.2279 - val_accuracy30: 0.4298 - 107s/epoch - 14ms/step
Epoch 13/50
7695/7695 - 110s - loss: 3.0021 - accuracy30: 0.4759 - val_loss: 3.2502 - val_accuracy30: 0.4322 - 110s/epoch - 14ms/step
testing model in sample: results/universal/W8/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 125s - 125s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.054514
{'0': {'precision': 0.3851917936912221, 'recall': 0.45310638547703325, 'f1-score': 0.416398044733947, 'support': 1635148}, '1': {'precision': 0.47689656597451213, 'recall': 0.4152921374429258, 'f1-score': 0.4439675002925519, 'support': 2667580}, '2': {'precision': 0.39576309938477977, 'recall': 0.4091984453161984, 'f1-score': 0.40236864990098503, 'support': 1658215}, 'accuracy': 0.4239698316189234, 'macro avg': {'precision': 0.4192838196835047, 'recall': 0.4258656560787191, 'f1-score': 0.4209113983091613, 'support': 5960943}, 'weighted avg': {'precision': 0.4291712972895792, 'recall': 0.4239698316189234, 'f1-score': 0.424832947618622, 'support': 5960943}}
[[ 740896  589339  304913]
 [ 828699 1107825  731056]
 [ 353852  625824  678539]]
Evaluating performance on  train set...
7695/7695 - 42s - 42s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738022
{'0': {'precision': 0.3746706969192313, 'recall': 0.40235388575504566, 'f1-score': 0.38801915446527674, 'support': 580402}, '1': {'precision': 0.42904026377076, 'recall': 0.41642996786172254, 'f1-score': 0.4226410737335257, 'support': 808693}, '2': {'precision': 0.3882717248186666, 'recall': 0.3754837397953733, 'f1-score': 0.3817706741133096, 'support': 580374}, 'accuracy': 0.40021548955581426, 'macro avg': {'precision': 0.3973275618362193, 'recall': 0.3980891978040472, 'f1-score': 0.39747696743737065, 'support': 1969469}, 'weighted avg': {'precision': 0.4010036684419972, 'recall': 0.40021548955581426, 'f1-score': 0.40039408812658617, 'support': 1969469}}
[[233527 222852 124023]
 [252614 336764 219315]
 [137145 225308 217921]]
Evaluating performance on  val set...
2338/2338 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0694418
{'0': {'precision': 0.37549130080818643, 'recall': 0.40193798225920946, 'f1-score': 0.3882648083623693, 'support': 173273}, '1': {'precision': 0.44056475122692124, 'recall': 0.42569038977434115, 'f1-score': 0.4329998675767754, 'support': 253480}, '2': {'precision': 0.3808041582028916, 'recall': 0.3726860243471753, 'f1-score': 0.37670135872295407, 'support': 171026}, 'accuracy': 0.40364081039983, 'macro avg': {'precision': 0.39895340341266644, 'recall': 0.4001047987935753, 'f1-score': 0.39932201155403285, 'support': 597779}, 'weighted avg': {'precision': 0.40460482764825234, 'recall': 0.40364081039983, 'f1-score': 0.4039257671308055, 'support': 597779}}
[[ 69645  68399  35229]
 [ 77164 107904  68412]
 [ 38668  68619  63739]]
testing model out of sample: results/universal/W8/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 72s - 72s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0484486
{'0': {'precision': 0.32704196568778526, 'recall': 0.4299780759406965, 'f1-score': 0.37151163093594514, 'support': 829226}, '1': {'precision': 0.5654630195976447, 'recall': 0.3967539503984293, 'f1-score': 0.46631829166452005, 'support': 1961954}, '2': {'precision': 0.3169523037291014, 'recall': 0.441558583225159, 'f1-score': 0.36902043884048225, 'support': 825057}, 'accuracy': 0.414594784578555, 'macro avg': {'precision': 0.4031524296715104, 'recall': 0.42276353652142823, 'f1-score': 0.4022834538136491, 'support': 3616237}, 'weighted avg': {'precision': 0.4540929842399483, 'recall': 0.414594784578555, 'f1-score': 0.4223796829376154, 'support': 3616237}}
[[356549 298902 173775]
 [572208 778413 611333]
 [161467 299279 364311]]
Evaluating performance on  train set...
4550/4550 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0580457
{'0': {'precision': 0.3527506748086198, 'recall': 0.4237142306644609, 'f1-score': 0.384989662093841, 'support': 301026}, '1': {'precision': 0.5064176195101092, 'recall': 0.3953498282909713, 'f1-score': 0.44404379289816326, 'support': 563162}, '2': {'precision': 0.3519136976109779, 'recall': 0.42577386607991197, 'f1-score': 0.38533638071100446, 'support': 299955}, 'accuracy': 0.41052344943877167, 'macro avg': {'precision': 0.4036939973099023, 'recall': 0.41494597501178143, 'f1-score': 0.4047899452343362, 'support': 1164143}, 'weighted avg': {'precision': 0.42687243512213924, 'recall': 0.41052344943877167, 'f1-score': 0.41364683083929155, 'support': 1164143}}
[[127549 108682  64795]
 [170114 222646 170402]
 [ 63921 108321 127713]]
Evaluating performance on  val set...
1570/1570 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0553406
{'0': {'precision': 0.34476976654198377, 'recall': 0.45509263895843766, 'f1-score': 0.39232293406892266, 'support': 99850}, '1': {'precision': 0.5202180579216354, 'recall': 0.3803843605036448, 'f1-score': 0.43944544059957347, 'support': 200697}, '2': {'precision': 0.3349744443900129, 'recall': 0.4083019844350232, 'f1-score': 0.3680211697165411, 'support': 100482}, 'accuracy': 0.40598061486825143, 'macro avg': {'precision': 0.39998742295121065, 'recall': 0.4145929946323686, 'f1-score': 0.3999298481283457, 'support': 401029}, 'weighted avg': {'precision': 0.4301194349563568, 'recall': 0.40598061486825143, 'f1-score': 0.4098165712062021, 'support': 401029}}
[[45441 34339 20070]
 [62974 76342 61381]
 [23386 36069 41027]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1083462
{'0': {'precision': 0.37711522965350525, 'recall': 0.31022482461470474, 'f1-score': 0.34041521442642825, 'support': 54309}, '1': {'precision': 0.37607201681149544, 'recall': 0.45846531997022727, 'f1-score': 0.41320135102457894, 'support': 57771}, '2': {'precision': 0.35625815517414433, 'recall': 0.33586933893525617, 'f1-score': 0.34576343834628953, 'support': 52839}, 'accuracy': 0.3703696966389561, 'macro avg': {'precision': 0.36981513387971504, 'recall': 0.3681864945067294, 'f1-score': 0.36646000126576556, 'support': 164919}, 'weighted avg': {'precision': 0.3700673188153926, 'recall': 0.3703696966389561, 'f1-score': 0.36762567957061, 'support': 164919}}
[[16848 21442 16019]
 [15236 26486 16049]
 [12592 22500 17747]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1131525
{'0': {'precision': 0.35263924973068883, 'recall': 0.29419539014590823, 'f1-score': 0.3207770124218232, 'support': 18916}, '1': {'precision': 0.34633830694275275, 'recall': 0.4823473282442748, 'f1-score': 0.40318149592343144, 'support': 18864}, '2': {'precision': 0.38295477120720484, 'recall': 0.2984928254361515, 'f1-score': 0.33548948513415516, 'support': 19374}, 'accuracy': 0.35775273821604786, 'macro avg': {'precision': 0.3606441092935488, 'recall': 0.3583451812754448, 'f1-score': 0.3531493311598033, 'support': 57154}, 'weighted avg': {'precision': 0.3608359101277633, 'recall': 0.35775273821604786, 'f1-score': 0.3529622946960832, 'support': 57154}}
[[5565 8496 4855]
 [5302 9099 4463]
 [4914 8677 5783]]
Evaluating performance on  val set...
68/68 - 1s - 567ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1151136
{'0': {'precision': 0.37965643698127777, 'recall': 0.32794264754918306, 'f1-score': 0.3519098309329994, 'support': 5998}, '1': {'precision': 0.3265197060788243, 'recall': 0.45334817288072715, 'f1-score': 0.3796210003106555, 'support': 5391}, '2': {'precision': 0.37097833223900195, 'recall': 0.289941840574752, 'f1-score': 0.3254920787325972, 'support': 5846}, 'accuracy': 0.3542790832608065, 'macro avg': {'precision': 0.359051491766368, 'recall': 0.35707755366822075, 'f1-score': 0.35234096999208403, 'support': 17235}, 'weighted avg': {'precision': 0.3600920437919264, 'recall': 0.3542790832608065, 'f1-score': 0.35161698119417684, 'support': 17235}}
[[1967 2517 1514]
 [1587 2444 1360]
 [1627 2524 1695]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.010237
{'0': {'precision': 0.2828064398309457, 'recall': 0.5726074350576938, 'f1-score': 0.3786168891648556, 'support': 85191}, '1': {'precision': 0.7661526934134811, 'recall': 0.4669398058949842, 'f1-score': 0.5802438829999202, 'support': 389789}, '2': {'precision': 0.296097478422745, 'recall': 0.5283048493266501, 'f1-score': 0.3794985250737464, 'support': 82795}, 'accuracy': 0.49218771009815787, 'macro avg': {'precision': 0.4483522038890573, 'recall': 0.5226173634264427, 'f1-score': 0.4461197657461741, 'support': 557775}, 'weighted avg': {'precision': 0.6225554145571184, 'recall': 0.49218771009815787, 'f1-score': 0.5196504230182062, 'support': 557775}}
[[ 48781  27854   8556]
 [112353 182008  95428]
 [ 11355  27699  43741]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0230289
{'0': {'precision': 0.2987652391372304, 'recall': 0.527092237694747, 'f1-score': 0.38136565414733903, 'support': 29012}, '1': {'precision': 0.6895854251247799, 'recall': 0.47915592360036807, 'f1-score': 0.5654269725930963, 'support': 98901}, '2': {'precision': 0.35321014551225155, 'recall': 0.4501731171368825, 'f1-score': 0.39584024114544086, 'support': 29171}, 'accuracy': 0.48262712943393343, 'macro avg': {'precision': 0.44718693659142067, 'recall': 0.48547375947733257, 'f1-score': 0.44754428929529205, 'support': 157084}, 'weighted avg': {'precision': 0.5549384940722994, 'recall': 0.48262712943393343, 'f1-score': 0.499939707729661, 'support': 157084}}
[[15292 10289  3431]
 [30896 47389 20616]
 [ 4996 11043 13132]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0131692
{'0': {'precision': 0.29822437449556094, 'recall': 0.5485587034516888, 'f1-score': 0.3863883926626291, 'support': 8083}, '1': {'precision': 0.7438149197355997, 'recall': 0.4860995402511648, 'f1-score': 0.5879564836067104, 'support': 32409}, '2': {'precision': 0.31721547314578, 'recall': 0.4919434804164601, 'f1-score': 0.38571428571428573, 'support': 8068}, 'accuracy': 0.4974670510708402, 'macro avg': {'precision': 0.4530849224589802, 'recall': 0.5088672413731046, 'f1-score': 0.4533530539945417, 'support': 48560}, 'weighted avg': {'precision': 0.598767293865297, 'recall': 0.4974670510708402, 'f1-score': 0.520803169527281, 'support': 48560}}
[[ 4434  2586  1063]
 [ 9175 15754  7480]
 [ 1259  2840  3969]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
1162/1162 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.055947
{'0': {'precision': 0.3909507795781107, 'recall': 0.4036055598338615, 'f1-score': 0.3971773943075796, 'support': 79211}, '1': {'precision': 0.4847049778344866, 'recall': 0.4258295848123823, 'f1-score': 0.45336383248925133, 'support': 139166}, '2': {'precision': 0.34506160285160725, 'recall': 0.40763268041628203, 'f1-score': 0.37374639134618726, 'support': 79081}, 'accuracy': 0.41507372469390635, 'macro avg': {'precision': 0.4069057867547348, 'recall': 0.4123559416875086, 'f1-score': 0.40809587271433934, 'support': 297458}, 'weighted avg': {'precision': 0.42261385392755896, 'recall': 0.41507372469390635, 'f1-score': 0.4172349981064375, 'support': 297458}}
[[31970 31754 15487]
 [34207 59261 45698]
 [15598 31247 32236]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0762268
{'0': {'precision': 0.4557179364318799, 'recall': 0.4053055861358713, 'f1-score': 0.4290359566189877, 'support': 28159}, '1': {'precision': 0.333627259557851, 'recall': 0.3904182789754929, 'f1-score': 0.3597955475555706, 'support': 27135}, '2': {'precision': 0.4348864994026284, 'recall': 0.4117647058823529, 'f1-score': 0.42300987797791983, 'support': 28288}, 'accuracy': 0.40265846713407194, 'macro avg': {'precision': 0.4080772317974531, 'recall': 0.4024961903312391, 'f1-score': 0.40394712738415933, 'support': 83582}, 'weighted avg': {'precision': 0.40903072856822215, 'recall': 0.40265846713407194, 'f1-score': 0.40451746923492954, 'support': 83582}}
[[11413 10389  6357]
 [ 7762 10594  8779]
 [ 5869 10771 11648]]
Evaluating performance on  val set...
125/125 - 1s - 842ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0652925
{'0': {'precision': 0.4352514360576439, 'recall': 0.4272007912957468, 'f1-score': 0.4311885389107972, 'support': 10110}, '1': {'precision': 0.37245528723316573, 'recall': 0.3940530170910359, 'f1-score': 0.3829498750052964, 'support': 11468}, '2': {'precision': 0.4378594905505341, 'recall': 0.4173683179949089, 'f1-score': 0.42736842105263156, 'support': 10214}, 'accuracy': 0.412084801207851, 'macro avg': {'precision': 0.4151887379471146, 'recall': 0.41287404212723056, 'f1-score': 0.4138356116562418, 'support': 31792}, 'weighted avg': {'precision': 0.4134375342543998, 'recall': 0.412084801207851, 'f1-score': 0.4125605922112631, 'support': 31792}}
[[4319 3686 2105]
 [3581 4519 3368]
 [2023 3928 4263]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0913048
{'0': {'precision': 0.39409253622772256, 'recall': 0.38734136727532714, 'f1-score': 0.39068778851582475, 'support': 106299}, '1': {'precision': 0.34613224712286506, 'recall': 0.43480755483652506, 'f1-score': 0.3854353834801496, 'support': 106316}, '2': {'precision': 0.4202301425390349, 'recall': 0.3138637427424736, 'f1-score': 0.35934097257853037, 'support': 100413}, 'accuracy': 0.3798925335752712, 'macro avg': {'precision': 0.38681830862987415, 'recall': 0.3786708882847753, 'f1-score': 0.37848804819150156, 'support': 313028}, 'weighted avg': {'precision': 0.38618784197054995, 'recall': 0.3798925335752712, 'f1-score': 0.3788484561797897, 'support': 313028}}
[[41174 45308 19817]
 [36425 46227 23664]
 [26879 42018 31516]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885817
{'0': {'precision': 0.4197747018598659, 'recall': 0.40505562462146566, 'f1-score': 0.4122838324518997, 'support': 31371}, '1': {'precision': 0.32897268180069256, 'recall': 0.3706235411803935, 'f1-score': 0.3485582576791006, 'support': 29990}, '2': {'precision': 0.41532950765744364, 'recall': 0.3780609528879425, 'f1-score': 0.3958199076896282, 'support': 30056}, 'accuracy': 0.3848846494634477, 'macro avg': {'precision': 0.3880256304393341, 'recall': 0.3845800395632672, 'f1-score': 0.38555399927354284, 'support': 91417}, 'weighted avg': {'precision': 0.3885249634247541, 'recall': 0.3848846494634477, 'f1-score': 0.3859652077968457, 'support': 91417}}
[[12707 11595  7069]
 [ 9948 11115  8927]
 [ 7616 11077 11363]]
Evaluating performance on  val set...
99/99 - 1s - 680ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0878041
{'0': {'precision': 0.4367866549604917, 'recall': 0.34677044609665425, 'f1-score': 0.3866079523377801, 'support': 8608}, '1': {'precision': 0.32033934707903783, 'recall': 0.3558816511572417, 'f1-score': 0.3371764439923138, 'support': 8382}, '2': {'precision': 0.39776094830424763, 'recall': 0.43836942058787953, 'f1-score': 0.41707906548509616, 'support': 8267}, 'accuracy': 0.37977590370986264, 'macro avg': {'precision': 0.38496231678125903, 'recall': 0.3803405059472585, 'f1-score': 0.38028782060506333, 'support': 25257}, 'weighted avg': {'precision': 0.385367767064482, 'recall': 0.37977590370986264, 'f1-score': 0.3801768555898355, 'support': 25257}}
[[2985 3307 2316]
 [2228 2983 3171]
 [1621 3022 3624]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.088999
{'0': {'precision': 0.4175559032860532, 'recall': 0.3416485631448089, 'f1-score': 0.3758075214203291, 'support': 121063}, '1': {'precision': 0.3429538669867356, 'recall': 0.4512090439402037, 'f1-score': 0.38970313095600295, 'support': 123486}, '2': {'precision': 0.4225353420891308, 'recall': 0.36499963893992765, 'f1-score': 0.3916657698185497, 'support': 124633}, 'accuracy': 0.38617809102285594, 'macro avg': {'precision': 0.39434837078730656, 'recall': 0.38595241534164676, 'f1-score': 0.38572547406496055, 'support': 369182}, 'weighted avg': {'precision': 0.3942836292908054, 'recall': 0.38617809102285594, 'f1-score': 0.385809022879603, 'support': 369182}}
[[41361 52780 26922]
 [32519 55718 35249]
 [25175 53967 45491]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08691
{'0': {'precision': 0.41725907317333905, 'recall': 0.3739909454571586, 'f1-score': 0.39444198825238425, 'support': 41747}, '1': {'precision': 0.3383094802137439, 'recall': 0.43294359562919926, 'f1-score': 0.37982065131889453, 'support': 41823}, '2': {'precision': 0.42533027808424567, 'recall': 0.3519511224513682, 'f1-score': 0.3851770251575549, 'support': 42719}, 'accuracy': 0.3860589600044343, 'macro avg': {'precision': 0.3936329438237762, 'recall': 0.38629522117924203, 'f1-score': 0.38647988824294455, 'support': 126289}, 'weighted avg': {'precision': 0.39384361320643674, 'recall': 0.3860589600044343, 'f1-score': 0.38646585309399867, 'support': 126289}}
[[15613 17482  8652]
 [12054 18107 11662]
 [ 9751 17933 15035]]
Evaluating performance on  val set...
150/150 - 1s - 930ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0838654
{'0': {'precision': 0.42102309172546504, 'recall': 0.4079397141081417, 'f1-score': 0.41437815656565663, 'support': 12872}, '1': {'precision': 0.33781414377556984, 'recall': 0.4063110208544872, 'f1-score': 0.368910006382526, 'support': 12803}, '2': {'precision': 0.4181181278583244, 'recall': 0.3445041289184639, 'f1-score': 0.37775824175824174, 'support': 12473}, 'accuracy': 0.38665198699800774, 'macro avg': {'precision': 0.39231845445311975, 'recall': 0.38625162129369756, 'f1-score': 0.3870154682354748, 'support': 38148}, 'weighted avg': {'precision': 0.3921471932532685, 'recall': 0.38665198699800774, 'f1-score': 0.38714504017193985, 'support': 38148}}
[[5251 5073 2548]
 [4169 5202 3432]
 [3052 5124 4297]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/EXC
Evaluating performance on  test set...
5521/5521 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9982586
{'0': {'precision': 0.2934550876039347, 'recall': 0.6585764272388925, 'f1-score': 0.40600043199448416, 'support': 215486}, '1': {'precision': 0.7865598762750303, 'recall': 0.38795178746457676, 'f1-score': 0.5196156315335945, 'support': 975348}, '2': {'precision': 0.31808506132966, 'recall': 0.641458886776254, 'f1-score': 0.42528221816924744, 'support': 222471}, 'accuracy': 0.4691188384672806, 'macro avg': {'precision': 0.4660333417362083, 'recall': 0.5626623671599078, 'f1-score': 0.45029942723244204, 'support': 1413305}, 'weighted avg': {'precision': 0.6376329008187126, 'recall': 0.4691188384672806, 'f1-score': 0.48744357122639653, 'support': 1413305}}
[[141914  48207  25365]
 [316390 378388 280570]
 [ 25293  54472 142706]]
Evaluating performance on  train set...
1288/1288 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.012792
{'0': {'precision': 0.28807263020988294, 'recall': 0.6216042702276354, 'f1-score': 0.3936940181465432, 'support': 54517}, '1': {'precision': 0.7448308355834224, 'recall': 0.3727058396808125, 'f1-score': 0.4968119760913316, 'support': 220560}, '2': {'precision': 0.3116146473334972, 'recall': 0.5800259830561197, 'f1-score': 0.40542026909500184, 'support': 54651}, 'accuracy': 0.44822095788043476, 'macro avg': {'precision': 0.4481727043756008, 'recall': 0.524778697654856, 'f1-score': 0.4319754211109588, 'support': 329728}, 'weighted avg': {'precision': 0.5975070263030583, 'recall': 0.44822095788043476, 'f1-score': 0.464614741120894, 'support': 329728}}
[[33888 13662  6967]
 [75297 82204 63059]
 [ 8452 14500 31699]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0086721
{'0': {'precision': 0.27302196843128945, 'recall': 0.6496766154393876, 'f1-score': 0.3844722241730459, 'support': 16853}, '1': {'precision': 0.7839970540270398, 'recall': 0.37892675981133755, 'f1-score': 0.5109147475509312, 'support': 78659}, '2': {'precision': 0.29794530672579456, 'recall': 0.6132408421565048, 'f1-score': 0.4010425993354424, 'support': 16434}, 'accuracy': 0.45408500527039825, 'macro avg': {'precision': 0.4516547763947079, 'recall': 0.5472814058024099, 'f1-score': 0.43214319035313986, 'support': 111946}, 'weighted avg': {'precision': 0.6357180844104939, 'recall': 0.45408500527039825, 'f1-score': 0.47574980436170744, 'support': 111946}}
[[10949  3953  1951]
 [27057 29806 21796]
 [ 2097  4259 10078]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/AAL
Evaluating performance on  test set...
5918/5918 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0189976
{'0': {'precision': 0.25592747414175165, 'recall': 0.5675348944514939, 'f1-score': 0.35277330832351006, 'support': 216725}, '1': {'precision': 0.7818706987785554, 'recall': 0.3698991258805739, 'f1-score': 0.5022067462401438, 'support': 1084520}, '2': {'precision': 0.23663347534436557, 'recall': 0.5771105642829742, 'f1-score': 0.335642835668003, 'support': 213758}, 'accuracy': 0.4274077345061363, 'macro avg': {'precision': 0.4248105494215575, 'recall': 0.5048481948716806, 'f1-score': 0.39687429674388564, 'support': 1515003}, 'weighted avg': {'precision': 0.6297034332574596, 'recall': 0.4274077345061363, 'f1-score': 0.45732872934607693, 'support': 1515003}}
[[122999  56180  37546]
 [322944 401163 360413]
 [ 34658  55738 123362]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0288482
{'0': {'precision': 0.26572503951351495, 'recall': 0.5232637881465461, 'f1-score': 0.3524620017588899, 'support': 75826}, '1': {'precision': 0.7212080577819766, 'recall': 0.3785418819442001, 'f1-score': 0.49649005761088943, 'support': 312581}, '2': {'precision': 0.25924477786024813, 'recall': 0.515605641228417, 'f1-score': 0.34501644867396347, 'support': 75870}, 'accuracy': 0.42457627666242354, 'macro avg': {'precision': 0.41539262505191327, 'recall': 0.47247043710638775, 'f1-score': 0.3979895026812476, 'support': 464277}, 'weighted avg': {'precision': 0.5713263936226797, 'recall': 0.42457627666242354, 'f1-score': 0.4482141919680118, 'support': 464277}}
[[ 39677  22608  13541]
 [ 96020 118325  98236]
 [ 13619  23132  39119]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0190587
{'0': {'precision': 0.23549061321987086, 'recall': 0.5736691367004592, 'f1-score': 0.3339110646573965, 'support': 21997}, '1': {'precision': 0.7917383502599108, 'recall': 0.3593957308163848, 'f1-score': 0.49437747988656777, 'support': 119086}, '2': {'precision': 0.22600675405788154, 'recall': 0.5752842222016822, 'f1-score': 0.3245216121799885, 'support': 21638}, 'accuracy': 0.4170697082736709, 'macro avg': {'precision': 0.41774523917922113, 'recall': 0.5027830299061754, 'f1-score': 0.3842700522413176, 'support': 162721}, 'weighted avg': {'precision': 0.6413147309957146, 'recall': 0.4170697082736709, 'f1-score': 0.45009849314711164, 'support': 162721}}
[[12619  5605  3773]
 [37430 42799 38857]
 [ 3537  5653 12448]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/WBA
Evaluating performance on  test set...
3755/3755 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0686246
{'0': {'precision': 0.4165251898952193, 'recall': 0.3877752035393597, 'f1-score': 0.40163635778210477, 'support': 305592}, '1': {'precision': 0.3958856463103997, 'recall': 0.4211541318426164, 'f1-score': 0.40812915145383366, 'support': 363494}, '2': {'precision': 0.4156171110896525, 'recall': 0.4126174367964064, 'f1-score': 0.41411184187919653, 'support': 292072}, 'accuracy': 0.4079474966654806, 'macro avg': {'precision': 0.4093426490984238, 'recall': 0.4071822573927942, 'f1-score': 0.4079591170383783, 'support': 961158}, 'weighted avg': {'precision': 0.4084437145823988, 'recall': 0.4079474966654806, 'f1-score': 0.4078828137592877, 'support': 961158}}
[[118501 120644  66447]
 [107404 153087 103003]
 [ 58594 112964 120514]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0766058
{'0': {'precision': 0.43253621782434354, 'recall': 0.40805540090148495, 'f1-score': 0.4199393280562609, 'support': 131117}, '1': {'precision': 0.35512613717014, 'recall': 0.4202758009834764, 'f1-score': 0.3849640151912546, 'support': 130964}, '2': {'precision': 0.43702639833644663, 'recall': 0.38124630083706773, 'f1-score': 0.40723513787568405, 'support': 130097}, 'accuracy': 0.40324291520687033, 'macro avg': {'precision': 0.4082295844436434, 'recall': 0.403192500907343, 'f1-score': 0.40404616037439983, 'support': 392178}, 'weighted avg': {'precision': 0.40817540516092526, 'recall': 0.40324291520687033, 'f1-score': 0.40404531078865485, 'support': 392178}}
[[53503 49653 27961]
 [39991 55041 35932]
 [30202 50296 49599]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0742781
{'0': {'precision': 0.4402460920997043, 'recall': 0.41867764859503304, 'f1-score': 0.42919106763627, 'support': 39823}, '1': {'precision': 0.35734660309396404, 'recall': 0.42980566963838523, 'f1-score': 0.3902411295915236, 'support': 39932}, '2': {'precision': 0.44110268203811004, 'recall': 0.372691026546886, 'f1-score': 0.4040213377102996, 'support': 39628}, 'accuracy': 0.4071350192238426, 'macro avg': {'precision': 0.41289845907725947, 'recall': 0.4070581149267681, 'f1-score': 0.40781784497936435, 'support': 119383}, 'weighted avg': {'precision': 0.41280166995502643, 'recall': 0.4071350192238426, 'f1-score': 0.40780799815812685, 'support': 119383}}
[[16673 15309  7841]
 [11897 17163 10872]
 [ 9302 15557 14769]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
4960/4960 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0622245
{'0': {'precision': 0.37323573905313445, 'recall': 0.4011868640303086, 'f1-score': 0.3867068835505763, 'support': 357918}, '1': {'precision': 0.46365241769253634, 'recall': 0.42280852622300097, 'f1-score': 0.44228952612037703, 'support': 557011}, '2': {'precision': 0.38585979151746636, 'recall': 0.4100765054433313, 'f1-score': 0.3975997463635419, 'support': 354746}, 'accuracy': 0.41315612262980683, 'macro avg': {'precision': 0.4075826494210457, 'recall': 0.411357298565547, 'f1-score': 0.4088653853448318, 'support': 1269675}, 'weighted avg': {'precision': 0.41642901032422647, 'recall': 0.41315612262980683, 'f1-score': 0.4141346448531896, 'support': 1269675}}
[[143592 136566  77760]
 [167725 235509 153777]
 [ 73405 135868 145473]]
Evaluating performance on  train set...
1691/1691 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0699102
{'0': {'precision': 0.41231035589286646, 'recall': 0.4051239936060068, 'f1-score': 0.4086855857888372, 'support': 136378}, '1': {'precision': 0.4046080479441626, 'recall': 0.40816790469344244, 'f1-score': 0.4063801804557272, 'support': 162759}, '2': {'precision': 0.4171512599425172, 'recall': 0.42009962304792675, 'f1-score': 0.41862025019284305, 'support': 133704}, 'accuracy': 0.4108945317102585, 'macro avg': {'precision': 0.4113565545931821, 'recall': 0.411130507115792, 'f1-score': 0.4112286721458025, 'support': 432841}, 'weighted avg': {'precision': 0.41090944492470827, 'recall': 0.4108945317102585, 'f1-score': 0.41088750035529814, 'support': 432841}}
[[55250 50010 31118]
 [48964 66433 47362]
 [29787 47748 56169]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782025
{'0': {'precision': 0.4219398493282716, 'recall': 0.43891310130337813, 'f1-score': 0.43025914634146334, 'support': 48873}, '1': {'precision': 0.3734987851440472, 'recall': 0.4142716895416659, 'f1-score': 0.3928300888024898, 'support': 51949}, '2': {'precision': 0.42916061301963726, 'recall': 0.364015821589712, 'f1-score': 0.39391299671990104, 'support': 50311}, 'accuracy': 0.40551037827608793, 'macro avg': {'precision': 0.4081997491639853, 'recall': 0.405733537478252, 'f1-score': 0.40566741062128475, 'support': 151133}, 'weighted avg': {'precision': 0.40769292111782135, 'recall': 0.40551037827608793, 'f1-score': 0.40529429257886646, 'support': 151133}}
[[21451 17316 10106]
 [16174 21521 14254]
 [13214 18783 18314]]
testing model on single stock: results/universal/W8/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
10609/10609 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0836641
{'0': {'precision': 0.4446038761242399, 'recall': 0.4235134080513343, 'f1-score': 0.4338024509880115, 'support': 922580}, '1': {'precision': 0.3211327757675757, 'recall': 0.4179416381527035, 'f1-score': 0.3631968739302145, 'support': 832633}, '2': {'precision': 0.4512587258470942, 'recall': 0.3538893701377667, 'f1-score': 0.39668644080654214, 'support': 960464}, 'accuracy': 0.39718088712317406, 'macro avg': {'precision': 0.40566512591296994, 'recall': 0.39844813878060154, 'f1-score': 0.39789525524158936, 'support': 2715677}, 'weighted avg': {'precision': 0.4091009907961766, 'recall': 0.39718088712317406, 'f1-score': 0.3990276508017966, 'support': 2715677}}
[[390725 346796 185059]
 [256376 347992 228265]
 [231715 388851 339898]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0994712
{'0': {'precision': 0.39257986190909183, 'recall': 0.3524888975282982, 'f1-score': 0.3714557642187003, 'support': 334385}, '1': {'precision': 0.3369164272737527, 'recall': 0.42764364349727974, 'f1-score': 0.3768969215672851, 'support': 328278}, '2': {'precision': 0.39824062719301356, 'recall': 0.33401407257453203, 'f1-score': 0.3633106726268905, 'support': 336399}, 'accuracy': 0.3709629632595374, 'macro avg': {'precision': 0.3759123054586193, 'recall': 0.37138220453336995, 'f1-score': 0.37055445280429194, 'support': 999062}, 'weighted avg': {'precision': 0.37619568833981, 'recall': 0.3709629632595374, 'f1-score': 0.37050108031088025, 'support': 999062}}
[[117867 138041  78477]
 [ 96585 140386  91307]
 [ 85785 138252 112362]]
Evaluating performance on  val set...
1144/1144 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0985181
{'0': {'precision': 0.4039998141782031, 'recall': 0.3481872960582948, 'f1-score': 0.37402290199451643, 'support': 99906}, '1': {'precision': 0.3293447737909516, 'recall': 0.4487024166294714, 'f1-score': 0.3798684648534849, 'support': 94098}, '2': {'precision': 0.39898377357045284, 'recall': 0.31686420829573453, 'f1-score': 0.35321375693667423, 'support': 98629}, 'accuracy': 0.3699514408832907, 'macro avg': {'precision': 0.3774427871798692, 'recall': 0.37125130699450026, 'f1-score': 0.36903504126155856, 'support': 292633}, 'weighted avg': {'precision': 0.3783034058460554, 'recall': 0.3699514408832907, 'f1-score': 0.3688890674850568, 'support': 292633}}
[[34786 43104 22016]
 [26815 42222 25061]
 [24503 42874 31252]]
training model: results/universal/W8/deepLOB_L2/h10
Epoch 1/50
7696/7696 - 325s - loss: 2.8960 - accuracy10: 0.5067 - val_loss: 3.1975 - val_accuracy10: 0.4184 - 325s/epoch - 42ms/step
Epoch 2/50
7696/7696 - 319s - loss: 2.7794 - accuracy10: 0.5392 - val_loss: 3.1675 - val_accuracy10: 0.4546 - 319s/epoch - 41ms/step
Epoch 3/50
7696/7696 - 330s - loss: 2.7201 - accuracy10: 0.5535 - val_loss: 3.1356 - val_accuracy10: 0.4733 - 330s/epoch - 43ms/step
Epoch 4/50
7696/7696 - 328s - loss: 2.6898 - accuracy10: 0.5601 - val_loss: 3.0954 - val_accuracy10: 0.4782 - 328s/epoch - 43ms/step
Epoch 5/50
7696/7696 - 321s - loss: 2.6697 - accuracy10: 0.5640 - val_loss: 3.0946 - val_accuracy10: 0.4795 - 321s/epoch - 42ms/step
Epoch 6/50
7696/7696 - 320s - loss: 2.6563 - accuracy10: 0.5665 - val_loss: 3.0811 - val_accuracy10: 0.4789 - 320s/epoch - 42ms/step
Epoch 7/50
7696/7696 - 318s - loss: 2.6456 - accuracy10: 0.5683 - val_loss: 3.0857 - val_accuracy10: 0.4812 - 318s/epoch - 41ms/step
Epoch 8/50
7696/7696 - 316s - loss: 2.6366 - accuracy10: 0.5700 - val_loss: 3.0776 - val_accuracy10: 0.4789 - 316s/epoch - 41ms/step
Epoch 9/50
7696/7696 - 314s - loss: 2.6287 - accuracy10: 0.5714 - val_loss: 3.0755 - val_accuracy10: 0.4832 - 314s/epoch - 41ms/step
Epoch 10/50
7696/7696 - 315s - loss: 2.6222 - accuracy10: 0.5722 - val_loss: 3.0670 - val_accuracy10: 0.4872 - 315s/epoch - 41ms/step
Epoch 11/50
7696/7696 - 316s - loss: 2.6160 - accuracy10: 0.5732 - val_loss: 3.0591 - val_accuracy10: 0.4891 - 316s/epoch - 41ms/step
Epoch 12/50
7696/7696 - 316s - loss: 2.6115 - accuracy10: 0.5745 - val_loss: 3.0828 - val_accuracy10: 0.4866 - 316s/epoch - 41ms/step
Epoch 13/50
7696/7696 - 316s - loss: 2.6068 - accuracy10: 0.5753 - val_loss: 3.0853 - val_accuracy10: 0.4881 - 316s/epoch - 41ms/step
Epoch 14/50
7696/7696 - 315s - loss: 2.6025 - accuracy10: 0.5763 - val_loss: 3.0571 - val_accuracy10: 0.4942 - 315s/epoch - 41ms/step
Epoch 15/50
7696/7696 - 315s - loss: 2.5992 - accuracy10: 0.5770 - val_loss: 3.0846 - val_accuracy10: 0.4894 - 315s/epoch - 41ms/step
Epoch 16/50
7696/7696 - 314s - loss: 2.5956 - accuracy10: 0.5776 - val_loss: 3.0631 - val_accuracy10: 0.4932 - 314s/epoch - 41ms/step
Epoch 17/50
7696/7696 - 316s - loss: 2.5920 - accuracy10: 0.5783 - val_loss: 3.0770 - val_accuracy10: 0.4936 - 316s/epoch - 41ms/step
Epoch 18/50
7696/7696 - 314s - loss: 2.5893 - accuracy10: 0.5784 - val_loss: 3.0674 - val_accuracy10: 0.4921 - 314s/epoch - 41ms/step
Epoch 19/50
7696/7696 - 314s - loss: 2.5867 - accuracy10: 0.5790 - val_loss: 3.0782 - val_accuracy10: 0.4927 - 314s/epoch - 41ms/step
Epoch 20/50
7696/7696 - 314s - loss: 2.5841 - accuracy10: 0.5796 - val_loss: 3.0604 - val_accuracy10: 0.4923 - 314s/epoch - 41ms/step
Epoch 21/50
7696/7696 - 314s - loss: 2.5818 - accuracy10: 0.5803 - val_loss: 3.0677 - val_accuracy10: 0.4942 - 314s/epoch - 41ms/step
Epoch 22/50
7696/7696 - 315s - loss: 2.5797 - accuracy10: 0.5806 - val_loss: 3.0456 - val_accuracy10: 0.4980 - 315s/epoch - 41ms/step
Epoch 23/50
7696/7696 - 315s - loss: 2.5775 - accuracy10: 0.5809 - val_loss: 3.0580 - val_accuracy10: 0.4933 - 315s/epoch - 41ms/step
Epoch 24/50
7696/7696 - 317s - loss: 2.5750 - accuracy10: 0.5815 - val_loss: 3.0737 - val_accuracy10: 0.4987 - 317s/epoch - 41ms/step
Epoch 25/50
7696/7696 - 320s - loss: 2.5729 - accuracy10: 0.5818 - val_loss: 3.0484 - val_accuracy10: 0.4948 - 320s/epoch - 42ms/step
Epoch 26/50
7696/7696 - 322s - loss: 2.5711 - accuracy10: 0.5823 - val_loss: 3.0203 - val_accuracy10: 0.5014 - 322s/epoch - 42ms/step
Epoch 27/50
7696/7696 - 316s - loss: 2.5696 - accuracy10: 0.5826 - val_loss: 3.0414 - val_accuracy10: 0.5013 - 316s/epoch - 41ms/step
Epoch 28/50
7696/7696 - 318s - loss: 2.5678 - accuracy10: 0.5830 - val_loss: 3.0196 - val_accuracy10: 0.5039 - 318s/epoch - 41ms/step
Epoch 29/50
7696/7696 - 317s - loss: 2.5661 - accuracy10: 0.5833 - val_loss: 3.0430 - val_accuracy10: 0.5026 - 317s/epoch - 41ms/step
Epoch 30/50
7696/7696 - 316s - loss: 2.5642 - accuracy10: 0.5837 - val_loss: 3.0167 - val_accuracy10: 0.5007 - 316s/epoch - 41ms/step
Epoch 31/50
7696/7696 - 316s - loss: 2.5628 - accuracy10: 0.5837 - val_loss: 3.0301 - val_accuracy10: 0.5018 - 316s/epoch - 41ms/step
Epoch 32/50
7696/7696 - 315s - loss: 2.5611 - accuracy10: 0.5845 - val_loss: 3.0452 - val_accuracy10: 0.4996 - 315s/epoch - 41ms/step
Epoch 33/50
7696/7696 - 314s - loss: 2.5594 - accuracy10: 0.5849 - val_loss: 3.0143 - val_accuracy10: 0.5057 - 314s/epoch - 41ms/step
Epoch 34/50
7696/7696 - 319s - loss: 2.5583 - accuracy10: 0.5851 - val_loss: 3.0322 - val_accuracy10: 0.5010 - 319s/epoch - 41ms/step
Epoch 35/50
7696/7696 - 318s - loss: 2.5564 - accuracy10: 0.5855 - val_loss: 3.0229 - val_accuracy10: 0.5042 - 318s/epoch - 41ms/step
Epoch 36/50
7696/7696 - 313s - loss: 2.5554 - accuracy10: 0.5857 - val_loss: 3.0205 - val_accuracy10: 0.5047 - 313s/epoch - 41ms/step
Epoch 37/50
7696/7696 - 313s - loss: 2.5536 - accuracy10: 0.5858 - val_loss: 3.0005 - val_accuracy10: 0.5082 - 313s/epoch - 41ms/step
Epoch 38/50
7696/7696 - 314s - loss: 2.5528 - accuracy10: 0.5861 - val_loss: 3.0387 - val_accuracy10: 0.5018 - 314s/epoch - 41ms/step
Epoch 39/50
7696/7696 - 314s - loss: 2.5514 - accuracy10: 0.5863 - val_loss: 2.9944 - val_accuracy10: 0.5053 - 314s/epoch - 41ms/step
Epoch 40/50
7696/7696 - 314s - loss: 2.5495 - accuracy10: 0.5868 - val_loss: 3.0328 - val_accuracy10: 0.5042 - 314s/epoch - 41ms/step
Epoch 41/50
7696/7696 - 316s - loss: 2.5491 - accuracy10: 0.5867 - val_loss: 3.0140 - val_accuracy10: 0.5049 - 316s/epoch - 41ms/step
Epoch 42/50
7696/7696 - 314s - loss: 2.5473 - accuracy10: 0.5872 - val_loss: 3.0152 - val_accuracy10: 0.5046 - 314s/epoch - 41ms/step
Epoch 43/50
7696/7696 - 316s - loss: 2.5468 - accuracy10: 0.5873 - val_loss: 3.0195 - val_accuracy10: 0.5037 - 316s/epoch - 41ms/step
Epoch 44/50
7696/7696 - 314s - loss: 2.5454 - accuracy10: 0.5875 - val_loss: 3.0025 - val_accuracy10: 0.5043 - 314s/epoch - 41ms/step
Epoch 45/50
7696/7696 - 315s - loss: 2.5440 - accuracy10: 0.5877 - val_loss: 3.0345 - val_accuracy10: 0.4995 - 315s/epoch - 41ms/step
Epoch 46/50
7696/7696 - 315s - loss: 2.5428 - accuracy10: 0.5882 - val_loss: 3.0418 - val_accuracy10: 0.4997 - 315s/epoch - 41ms/step
Epoch 47/50
7696/7696 - 316s - loss: 2.5420 - accuracy10: 0.5881 - val_loss: 3.0115 - val_accuracy10: 0.5040 - 316s/epoch - 41ms/step
Epoch 48/50
7696/7696 - 315s - loss: 2.5408 - accuracy10: 0.5884 - val_loss: 2.9986 - val_accuracy10: 0.5088 - 315s/epoch - 41ms/step
Epoch 49/50
7696/7696 - 315s - loss: 2.5393 - accuracy10: 0.5890 - val_loss: 3.0175 - val_accuracy10: 0.5026 - 315s/epoch - 41ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 330s - 330s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9895101
{'0': {'precision': 0.3921467030120075, 'recall': 0.5411653874406418, 'f1-score': 0.45475939857618275, 'support': 1383128}, '1': {'precision': 0.7486504396976407, 'recall': 0.5220848769440669, 'f1-score': 0.6151699218002763, 'support': 3172216}, '2': {'precision': 0.37839632746914603, 'recall': 0.4953415707187697, 'f1-score': 0.42904269482075, 'support': 1405624}, 'accuracy': 0.5202059464167564, 'macro avg': {'precision': 0.5063978233929314, 'recall': 0.5195306117011596, 'f1-score': 0.4996573383990697, 'support': 5960968}, 'weighted avg': {'precision': 0.5786229598383976, 'recall': 0.5202059464167564, 'f1-score': 0.5340600779860226, 'support': 5960968}}
[[ 748501  271032  363595]
 [ 735870 1656166  780180]
 [ 424356  285004  696264]]
Evaluating performance on  train set...
7696/7696 - 117s - 117s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.011488
{'0': {'precision': 0.43256374550146914, 'recall': 0.4868046202508607, 'f1-score': 0.4580841319046636, 'support': 521963}, '1': {'precision': 0.6517215175845719, 'recall': 0.5330644995948071, 'f1-score': 0.586451223442806, 'support': 926719}, '2': {'precision': 0.404312322937097, 'recall': 0.48448726761623506, 'f1-score': 0.44078366976163225, 'support': 520798}, 'accuracy': 0.5079589536324309, 'macro avg': {'precision': 0.496199195341046, 'recall': 0.5014521291539676, 'f1-score': 0.49510634170303397, 'support': 1969480}, 'weighted avg': {'precision': 0.5282155860981753, 'recall': 0.5079589536324309, 'f1-score': 0.5139111403637336, 'support': 1969480}}
[[254094 131106 136763]
 [197729 494001 234989]
 [135591 132887 252320]]
Evaluating performance on  val set...
2338/2338 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0081207
{'0': {'precision': 0.41166116276828335, 'recall': 0.5286086503387181, 'f1-score': 0.46286214576803847, 'support': 153520}, '1': {'precision': 0.6819686459747457, 'recall': 0.5040998536012041, 'f1-score': 0.57969720082675, 'support': 290986}, '2': {'precision': 0.39773652016922206, 'recall': 0.48150371230606626, 'f1-score': 0.4356297719498626, 'support': 153274}, 'accuracy': 0.5046003546455218, 'macro avg': {'precision': 0.497122109637417, 'recall': 0.5047374054153294, 'f1-score': 0.4927297061815503, 'support': 597780}, 'weighted avg': {'precision': 0.5396704766272066, 'recall': 0.5046003546455218, 'f1-score': 0.5127523235369621, 'support': 597780}}
[[ 81152  33499  38869]
 [ 71416 146686  72884]
 [ 44565  34907  73802]]
testing model out of sample: results/universal/W8/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 202s - 202s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8931134
{'0': {'precision': 0.38151427181183145, 'recall': 0.5907363333221596, 'f1-score': 0.46361368324195595, 'support': 626469}, '1': {'precision': 0.8900298288590045, 'recall': 0.5632616610681278, 'f1-score': 0.6899093310295795, 'support': 2370559}, '2': {'precision': 0.3459498277942746, 'recall': 0.640247467031849, 'f1-score': 0.44918699762696096, 'support': 619234}, 'accuracy': 0.581204016744362, 'macro avg': {'precision': 0.5391646428217035, 'recall': 0.5980818204740455, 'f1-score': 0.5342366706328321, 'support': 3616262}, 'weighted avg': {'precision': 0.7087702663917101, 'recall': 0.581204016744362, 'f1-score': 0.6094863247385248, 'support': 3616262}}
[[ 370078   86221  170170]
 [ 455934 1335245  579380]
 [ 144012   78759  396463]]
Evaluating performance on  train set...
4550/4550 - 69s - 69s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.883969
{'0': {'precision': 0.403449160148737, 'recall': 0.566096656186013, 'f1-score': 0.47113033062152854, 'support': 233446}, '1': {'precision': 0.8447378827949282, 'recall': 0.5878187212452165, 'f1-score': 0.6932399608525226, 'support': 697710}, '2': {'precision': 0.39554239001951097, 'recall': 0.596017081911629, 'f1-score': 0.4755136282701, 'support': 232995}, 'accuracy': 0.5851036506432585, 'macro avg': {'precision': 0.5479098109877254, 'recall': 0.5833108197809528, 'f1-score': 0.5466279732480503, 'support': 1164151}, 'weighted avg': {'precision': 0.6663440223884421, 'recall': 0.5851036506432585, 'f1-score': 0.6051244572804377, 'support': 1164151}}
[[132153  39127  62166]
 [137533 410127 150050]
 [ 57872  36254 138869]]
Evaluating performance on  val set...
1570/1570 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89399564
{'0': {'precision': 0.39684217125354876, 'recall': 0.5695720914688227, 'f1-score': 0.467770880837767, 'support': 77797}, '1': {'precision': 0.8366006979440364, 'recall': 0.5862325171256644, 'f1-score': 0.6893886476508697, 'support': 244954}, '2': {'precision': 0.3768464328488792, 'recall': 0.5667330931759536, 'f1-score': 0.45268329515481426, 'support': 78282}, 'accuracy': 0.5791942308987041, 'macro avg': {'precision': 0.5367631006821548, 'recall': 0.5741792339234802, 'f1-score': 0.536614274547817, 'support': 401033}, 'weighted avg': {'precision': 0.6615468308530016, 'recall': 0.5791942308987041, 'f1-score': 0.6001915845442047, 'support': 401033}}
[[ 44311  14136  19350]
 [ 47342 143600  54012]
 [ 20006  13911  44365]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1939465
{'0': {'precision': 0.38027289119847796, 'recall': 0.558491116857119, 'f1-score': 0.45246521999881745, 'support': 47956}, '1': {'precision': 0.688281207357677, 'recall': 0.1797884171205338, 'f1-score': 0.28510383341435014, 'support': 70138}, '2': {'precision': 0.368678779604054, 'recall': 0.5996796925048046, 'f1-score': 0.45662672151672334, 'support': 46830}, 'accuracy': 0.40913390410128303, 'macro avg': {'precision': 0.47907762605340304, 'recall': 0.4459864088274858, 'f1-score': 0.3980652583099637, 'support': 164924}, 'weighted avg': {'precision': 0.5079688907668065, 'recall': 0.40913390410128303, 'f1-score': 0.3824723152901162, 'support': 164924}}
[[26783  2998 18175]
 [27614 12610 29914]
 [16034  2713 28083]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1407921
{'0': {'precision': 0.394988716831375, 'recall': 0.5934759733426868, 'f1-score': 0.4743038684358064, 'support': 17106}, '1': {'precision': 0.6763383142318294, 'recall': 0.20461727528089887, 'f1-score': 0.3141827004077231, 'support': 22784}, '2': {'precision': 0.39793965552343336, 'recall': 0.5660912882298424, 'f1-score': 0.46735050092054614, 'support': 17264}, 'accuracy': 0.430188613220422, 'macro avg': {'precision': 0.4897555621955459, 'recall': 0.45472817895114276, 'f1-score': 0.41861235658802526, 'support': 57154}, 'weighted avg': {'precision': 0.5080379213096556, 'recall': 0.430188613220422, 'f1-score': 0.40837246155028134, 'support': 57154}}
[[10152  1134  5820]
 [ 9156  4662  8966]
 [ 6394  1097  9773]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1651267
{'0': {'precision': 0.3925997116770783, 'recall': 0.6175359032501889, 'f1-score': 0.4800235017626321, 'support': 5292}, '1': {'precision': 0.5595166163141994, 'recall': 0.14124466137888958, 'f1-score': 0.2255510900012179, 'support': 6556}, '2': {'precision': 0.40148801322678423, 'recall': 0.5407311189460011, 'f1-score': 0.4608207480034791, 'support': 5389}, 'accuracy': 0.41236874166038173, 'macro avg': {'precision': 0.4512014470726873, 'recall': 0.43317056119169317, 'f1-score': 0.38879844658910967, 'support': 17237}, 'weighted avg': {'precision': 0.4588645073986267, 'recall': 0.41236874166038173, 'f1-score': 0.3772327161551652, 'support': 17237}}
[[3268  388 1636]
 [2922  926 2708]
 [2134  341 2914]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8268257
{'0': {'precision': 0.2516960208741031, 'recall': 0.6210740226554797, 'f1-score': 0.35822004050109957, 'support': 49701}, '1': {'precision': 0.9366375314527877, 'recall': 0.6161656861955033, 'f1-score': 0.743331673614277, 'support': 459133}, '2': {'precision': 0.26093163035311795, 'recall': 0.7095574714992032, 'f1-score': 0.3815519154499412, 'support': 48946}, 'accuracy': 0.6247983075764638, 'macro avg': {'precision': 0.48308839422666955, 'recall': 0.648932393450062, 'f1-score': 0.49436787652177255, 'support': 557780}, 'weighted avg': {'precision': 0.8163116340514904, 'recall': 0.6247983075764638, 'f1-score': 0.6772695965938216, 'support': 557780}}
[[ 30868  11076   7757]
 [ 85618 282902  90613]
 [  6154   8062  34730]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7590144
{'0': {'precision': 0.36996743370432666, 'recall': 0.5740144364242088, 'f1-score': 0.44993798011011255, 'support': 18010}, '1': {'precision': 0.9256883979413678, 'recall': 0.6714482005098831, 'f1-score': 0.778332685674261, 'support': 120812}, '2': {'precision': 0.31317900416736927, 'recall': 0.7117985217629346, 'f1-score': 0.43497607815584327, 'support': 18265}, 'accuracy': 0.6649690935596199, 'macro avg': {'precision': 0.5362782786043546, 'recall': 0.6524203862323422, 'f1-score': 0.5544155813134056, 'support': 157087}, 'weighted avg': {'precision': 0.7907566808470748, 'recall': 0.6649690935596199, 'f1-score': 0.7007591303607454, 'support': 157087}}
[[10338  3719  3953]
 [15134 81119 24559]
 [ 2471  2793 13001]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75497115
{'0': {'precision': 0.3197350436336873, 'recall': 0.5969768354927365, 'f1-score': 0.41643272851763097, 'support': 5094}, '1': {'precision': 0.9282963702488768, 'recall': 0.6806358003712322, 'f1-score': 0.7854050711193569, 'support': 38251}, '2': {'precision': 0.31518676724529676, 'recall': 0.6650047938638542, 'f1-score': 0.42767295597484284, 'support': 5215}, 'accuracy': 0.6701812191103789, 'macro avg': {'precision': 0.5210727270426203, 'recall': 0.6475391432426076, 'f1-score': 0.5431702518706102, 'support': 48560}, 'weighted avg': {'precision': 0.798613957204366, 'recall': 0.6701812191103789, 'f1-score': 0.7082815518917656, 'support': 48560}}
[[ 3041  1079   974]
 [ 5655 26035  6561]
 [  815   932  3468]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0625399
{'0': {'precision': 0.4220185161514161, 'recall': 0.6078482943636412, 'f1-score': 0.4981677875495775, 'support': 76042}, '1': {'precision': 0.7260196471737901, 'recall': 0.38530670178718873, 'f1-score': 0.5034349018121838, 'support': 146543}, '2': {'precision': 0.3841056596922798, 'recall': 0.5651192606640134, 'f1-score': 0.45735315575298713, 'support': 74878}, 'accuracy': 0.4874589444737665, 'macro avg': {'precision': 0.5107146076724953, 'recall': 0.5194247522716144, 'f1-score': 0.48631861503824947, 'support': 297463}, 'weighted avg': {'precision': 0.5622389767716093, 'recall': 0.4874589444737665, 'f1-score': 0.4904886500626296, 'support': 297463}}
[[46222 10222 19598]
 [41827 56464 48252]
 [21477 11086 42315]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1036923
{'0': {'precision': 0.45792846183929486, 'recall': 0.5491341991341991, 'f1-score': 0.49940125654106715, 'support': 27720}, '1': {'precision': 0.5471894067246528, 'recall': 0.302790848029884, 'f1-score': 0.3898536314657664, 'support': 27841}, '2': {'precision': 0.45473021325318447, 'recall': 0.5669319438992184, 'f1-score': 0.5046699282038248, 'support': 28021}, 'accuracy': 0.4730444354047522, 'macro avg': {'precision': 0.4866160272723774, 'recall': 0.47295233035443385, 'f1-score': 0.46464160540355276, 'support': 83582}, 'weighted avg': {'precision': 0.4865888892389963, 'recall': 0.4730444354047522, 'f1-score': 0.4646774884922132, 'support': 83582}}
[[15222  3512  8986]
 [ 9348  8430 10063]
 [ 8671  3464 15886]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0727212
{'0': {'precision': 0.4669705908643962, 'recall': 0.5340967181269809, 'f1-score': 0.4982830980541778, 'support': 9781}, '1': {'precision': 0.5860355323642689, 'recall': 0.3923639993345533, 'f1-score': 0.47003138857057447, 'support': 12022}, '2': {'precision': 0.45755017521503666, 'recall': 0.5751326459105015, 'f1-score': 0.5096473719228211, 'support': 9989}, 'accuracy': 0.4933945646703573, 'macro avg': {'precision': 0.5035187661479005, 'recall': 0.5005311211240119, 'f1-score': 0.4926539528491911, 'support': 31792}, 'weighted avg': {'precision': 0.5090345753507455, 'recall': 0.4933945646703573, 'f1-score': 0.4911704810518501, 'support': 31792}}
[[5224 1729 2828]
 [3322 4717 3983]
 [2641 1603 5745]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3521434
{'0': {'precision': 0.3579226140150196, 'recall': 0.5622076615856338, 'f1-score': 0.4373877073496845, 'support': 102407}, '1': {'precision': 0.4392304082590333, 'recall': 0.00862489979082775, 'f1-score': 0.016917599002295444, 'support': 108523}, '2': {'precision': 0.36524799061621105, 'recall': 0.5367521032682683, 'f1-score': 0.43469535869664366, 'support': 102103}, 'accuracy': 0.36198739430028143, 'macro avg': {'precision': 0.3874670042967547, 'recall': 0.3691948882149099, 'f1-score': 0.2963335550162079, 'support': 313033}, 'weighted avg': {'precision': 0.38849992912829695, 'recall': 0.36198739430028143, 'f1-score': 0.2907399914772201, 'support': 313033}}
[[57574   660 44173]
 [56518   936 51069]
 [46764   535 54804]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3169779
{'0': {'precision': 0.38505829559658217, 'recall': 0.5952109464082098, 'f1-score': 0.46760808709175733, 'support': 31572}, '1': {'precision': 0.4470046082949309, 'recall': 0.009663279537756525, 'f1-score': 0.0189176011701609, 'support': 30114}, '2': {'precision': 0.36637674252353153, 'recall': 0.5171022096660276, 'f1-score': 0.42888225612987807, 'support': 29733}, 'accuracy': 0.37692383421389425, 'macro avg': {'precision': 0.39947988213834823, 'recall': 0.373992145203998, 'f1-score': 0.3051359814639321, 'support': 91419}, 'weighted avg': {'precision': 0.3993878402544439, 'recall': 0.37692383421389425, 'f1-score': 0.30721144716972243, 'support': 91419}}
[[18792   190 12590]
 [15823   291 14000]
 [14188   170 15375]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3383062
{'0': {'precision': 0.3725518854136218, 'recall': 0.5969555035128805, 'f1-score': 0.45878329733621315, 'support': 8540}, '1': {'precision': 0.41414141414141414, 'recall': 0.005028823745860419, 'f1-score': 0.009936984973339795, 'support': 8153}, '2': {'precision': 0.3827450980392157, 'recall': 0.512784588441331, 'f1-score': 0.4383233532934132, 'support': 8565}, 'accuracy': 0.3773457914324175, 'macro avg': {'precision': 0.3898127991980839, 'recall': 0.37158963856669064, 'f1-score': 0.30234787853432205, 'support': 25258}, 'weighted avg': {'precision': 0.3894330436152174, 'recall': 0.3773457914324175, 'f1-score': 0.3069627491763791, 'support': 25258}}
[[5098   40 3402]
 [4431   41 3681]
 [4155   18 4392]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1420684
{'0': {'precision': 0.43292774523058436, 'recall': 0.5652550545086054, 'f1-score': 0.4903202024569886, 'support': 122366}, '1': {'precision': 0.5955470860671556, 'recall': 0.19880182624870157, 'f1-score': 0.29809532433819314, 'support': 124189}, '2': {'precision': 0.4321070712002048, 'recall': 0.5918357361863136, 'f1-score': 0.49951306801562306, 'support': 122632}, 'accuracy': 0.45081489868278135, 'macro avg': {'precision': 0.4868606341659816, 'recall': 0.4519642056478735, 'f1-score': 0.4293095316036016, 'support': 369187}, 'weighted avg': {'precision': 0.4873578644424186, 'recall': 0.45081489868278135, 'f1-score': 0.4287121937797908, 'support': 369187}}
[[69168  8415 44783]
 [48898 24689 50602]
 [41702  8352 72578]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0901777
{'0': {'precision': 0.43872405063291137, 'recall': 0.516216667063842, 'f1-score': 0.47432612932185947, 'support': 41963}, '1': {'precision': 0.5466484734777418, 'recall': 0.3077587862492798, 'f1-score': 0.39380721263132035, 'support': 41656}, '2': {'precision': 0.44593659403347985, 'recall': 0.5587139408993977, 'f1-score': 0.49599534003203727, 'support': 42673}, 'accuracy': 0.46181864251100624, 'macro avg': {'precision': 0.4771030393813777, 'recall': 0.4608964647375065, 'f1-score': 0.45470956066173907, 'support': 126292}, 'weighted avg': {'precision': 0.4767587687667339, 'recall': 0.46181864251100624, 'f1-score': 0.4550897108232556, 'support': 126292}}
[[21662  5623 14678]
 [13891 12820 14945]
 [13822  5009 23842]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.10605
{'0': {'precision': 0.44951491196550486, 'recall': 0.5811396717249923, 'f1-score': 0.5069224015668266, 'support': 12916}, '1': {'precision': 0.563020030816641, 'recall': 0.28676816826243917, 'f1-score': 0.3799916805324459, 'support': 12742}, '2': {'precision': 0.4441176470588235, 'recall': 0.5319455564451562, 'f1-score': 0.48408014571949, 'support': 12490}, 'accuracy': 0.4667086085771207, 'macro avg': {'precision': 0.4855508632803231, 'recall': 0.46661779881086246, 'f1-score': 0.4569980759395875, 'support': 38148}, 'weighted avg': {'precision': 0.4856601983689003, 'recall': 0.4667086085771207, 'f1-score': 0.4570468897981018, 'support': 38148}}
[[7506 1376 4034]
 [4806 3654 4282]
 [4386 1460 6644]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
5521/5521 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8213622
{'0': {'precision': 0.31033017163824916, 'recall': 0.6848901743140781, 'f1-score': 0.4271256836994355, 'support': 127930}, '1': {'precision': 0.9540122596431357, 'recall': 0.587772566687166, 'f1-score': 0.7273936348642457, 'support': 1152883}, '2': {'precision': 0.25039817055487146, 'recall': 0.7950066793965146, 'f1-score': 0.38084425973162, 'support': 132497}, 'accuracy': 0.6159915375961396, 'macro avg': {'precision': 0.5049135339454188, 'recall': 0.6892231401325862, 'f1-score': 0.5117878594317671, 'support': 1413310}, 'weighted avg': {'precision': 0.8297840255823896, 'recall': 0.6159915375961396, 'f1-score': 0.6677251746188206, 'support': 1413310}}
[[ 87618  18839  21473]
 [181385 677633 293865]
 [ 13335  13826 105336]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91793674
{'0': {'precision': 0.2792551816819145, 'recall': 0.6446041877945475, 'f1-score': 0.38968930883387126, 'support': 33526}, '1': {'precision': 0.9520081335113115, 'recall': 0.5246471491788095, 'f1-score': 0.6764860547978866, 'support': 262363}, '2': {'precision': 0.24680061250058002, 'recall': 0.785851481930203, 'f1-score': 0.37563208000225995, 'support': 33841}, 'accuracy': 0.5636520789737057, 'macro avg': {'precision': 0.4926879758979353, 'recall': 0.65170093963452, 'f1-score': 0.48060248121133925, 'support': 329730}, 'weighted avg': {'precision': 0.8112273638465661, 'recall': 0.5636520789737057, 'f1-score': 0.6164480022511108, 'support': 329730}}
[[ 21611   3717   8198]
 [ 51752 137648  72963]
 [  4025   3222  26594]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8821256
{'0': {'precision': 0.2505837912087912, 'recall': 0.7299189756927078, 'f1-score': 0.3730858705933482, 'support': 9997}, '1': {'precision': 0.9580454096742349, 'recall': 0.5264556865893483, 'f1-score': 0.679512403464428, 'support': 92173}, '2': {'precision': 0.24024117354549976, 'recall': 0.7907119476268413, 'f1-score': 0.3685163996948894, 'support': 9776}, 'accuracy': 0.5677022850302824, 'macro avg': {'precision': 0.48295679147617526, 'recall': 0.6823622033029658, 'f1-score': 0.47370489125088855, 'support': 111946}, 'weighted avg': {'precision': 0.8321834046700939, 'recall': 0.5677022850302824, 'f1-score': 0.6249893032021302, 'support': 111946}}
[[ 7297  1210  1490]
 [20692 48525 22956]
 [ 1131   915  7730]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
5918/5918 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72949237
{'0': {'precision': 0.3142671409206585, 'recall': 0.6512936313533374, 'f1-score': 0.423961273702542, 'support': 130640}, '1': {'precision': 0.9459056366493983, 'recall': 0.6573839191816183, 'f1-score': 0.7756841580300348, 'support': 1255160}, '2': {'precision': 0.2519289812290635, 'recall': 0.7252414711163395, 'f1-score': 0.37395593476013933, 'support': 129208}, 'accuracy': 0.6626460058296721, 'macro avg': {'precision': 0.5040339195997068, 'recall': 0.6779730072170983, 'f1-score': 0.5245337888309053, 'support': 1515008}, 'weighted avg': {'precision': 0.8322530428838517, 'recall': 0.6626460058296721, 'f1-score': 0.7110933585881835, 'support': 1515008}}
[[ 85085  25584  19971]
 [171758 825122 258280]
 [ 13898  21603  93707]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73617667
{'0': {'precision': 0.32286517398468545, 'recall': 0.6193240507375118, 'f1-score': 0.4244543710489243, 'support': 48406}, '1': {'precision': 0.9283073076994832, 'recall': 0.6771942240428978, 'f1-score': 0.783112733911456, 'support': 367385}, '2': {'precision': 0.31210295781321007, 'recall': 0.6656904801187923, 'f1-score': 0.4249649461190581, 'support': 48488}, 'accuracy': 0.6699592271026689, 'macro avg': {'precision': 0.521091813165793, 'recall': 0.6540695849664006, 'f1-score': 0.5441773503598127, 'support': 464279}, 'weighted avg': {'precision': 0.8008288982907352, 'recall': 0.6699592271026689, 'f1-score': 0.7083148502096269, 'support': 464279}}
[[ 29979   9994   8433]
 [ 55884 248791  62710]
 [  6990   9220  32278]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77995074
{'0': {'precision': 0.26871516794697997, 'recall': 0.6648282030260118, 'f1-score': 0.38273405989873854, 'support': 13417}, '1': {'precision': 0.954209256025537, 'recall': 0.6307817864994228, 'f1-score': 0.7594968085765632, 'support': 136009}, '2': {'precision': 0.24705941743651874, 'recall': 0.7361612515042117, 'f1-score': 0.3699588010734399, 'support': 13296}, 'accuracy': 0.6421995796511842, 'macro avg': {'precision': 0.48999461380301196, 'recall': 0.6772570803432155, 'f1-score': 0.5040632231829139, 'support': 162722}, 'weighted avg': {'precision': 0.8399067128314416, 'recall': 0.6421995796511842, 'f1-score': 0.6966022820419097, 'support': 162722}}
[[ 8920  2204  2293]
 [22680 85792 27537]
 [ 1595  1913  9788]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
3755/3755 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89544225
{'0': {'precision': 0.43249417782813615, 'recall': 0.5112540192926045, 'f1-score': 0.4685876749961012, 'support': 229207}, '1': {'precision': 0.7086260243754138, 'recall': 0.6682021247243318, 'f1-score': 0.6878206483971357, 'support': 511031}, '2': {'precision': 0.4725420832593346, 'recall': 0.44561729093583796, 'f1-score': 0.45868490572191345, 'support': 220925}, 'accuracy': 0.5796134474589638, 'macro avg': {'precision': 0.5378874284876282, 'recall': 0.5416911449842581, 'f1-score': 0.5383644097050501, 'support': 961163}, 'weighted avg': {'precision': 0.5885129979245083, 'recall': 0.5796134474589638, 'f1-score': 0.5828732606129051, 'support': 961163}}
[[117183  71042  40982]
 [100652 341472  68907]
 [ 53112  69365  98448]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91571254
{'0': {'precision': 0.47589173382297933, 'recall': 0.5459847465231046, 'f1-score': 0.5085343143934232, 'support': 102534}, '1': {'precision': 0.7063898590908804, 'recall': 0.5955504909582738, 'f1-score': 0.6462520765619357, 'support': 187796}, '2': {'precision': 0.45938597095064365, 'recall': 0.5241774749388813, 'f1-score': 0.4896476770900686, 'support': 101851}, 'accuracy': 0.5640558823604407, 'macro avg': {'precision': 0.5472225212881677, 'recall': 0.5552375708067533, 'f1-score': 0.5481446893484758, 'support': 392181}, 'weighted avg': {'precision': 0.5819792227082148, 'recall': 0.5640558823604407, 'f1-score': 0.5695755733228819, 'support': 392181}}
[[ 55982  23649  22903]
 [ 36029 111842  39925]
 [ 25625  22838  53388]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9533077
{'0': {'precision': 0.4682739519073398, 'recall': 0.48820344544708777, 'f1-score': 0.4780310697704307, 'support': 30475}, '1': {'precision': 0.6605854900296988, 'recall': 0.5867319847210565, 'f1-score': 0.6214723091577085, 'support': 58381}, '2': {'precision': 0.4400536957798473, 'recall': 0.5154453434664396, 'f1-score': 0.47477520970369924, 'support': 30527}, 'accuracy': 0.543352068552474, 'macro avg': {'precision': 0.5229710459056286, 'recall': 0.5301269245448612, 'f1-score': 0.5247595295439461, 'support': 119383}, 'weighted avg': {'precision': 0.5551025635883787, 'recall': 0.543352068552474, 'f1-score': 0.5473445512243358, 'support': 119383}}
[[14878  8932  6665]
 [10770 34254 13357]
 [ 6124  8668 15735]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
4960/4960 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9376757
{'0': {'precision': 0.395775361189644, 'recall': 0.5701360912352434, 'f1-score': 0.4672184326408062, 'support': 249465}, '1': {'precision': 0.8493455839153992, 'recall': 0.5375602462916172, 'f1-score': 0.658407241979953, 'support': 774529}, '2': {'precision': 0.37972502047112144, 'recall': 0.6493003264329266, 'f1-score': 0.4792021508283393, 'support': 245686}, 'accuracy': 0.5655826664986453, 'macro avg': {'precision': 0.5416153218587215, 'recall': 0.5856655546532624, 'f1-score': 0.5349426084830328, 'support': 1269680}, 'weighted avg': {'precision': 0.6693560642233104, 'recall': 0.5655826664986453, 'f1-score': 0.586166127410561, 'support': 1269680}}
[[142229  39004  68232]
 [165825 416356 192348]
 [ 51314  34848 159524]]
Evaluating performance on  train set...
1691/1691 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90558636
{'0': {'precision': 0.4363657900971334, 'recall': 0.5624064895013792, 'f1-score': 0.4914332469172585, 'support': 98251}, '1': {'precision': 0.788766518540952, 'recall': 0.5689368352069365, 'f1-score': 0.661055046431317, 'support': 238044}, '2': {'precision': 0.42428612847828834, 'recall': 0.5911195351583134, 'f1-score': 0.493997282114757, 'support': 96549}, 'accuracy': 0.5724025283936014, 'macro avg': {'precision': 0.5498061457054579, 'recall': 0.5741542866222097, 'f1-score': 0.5488285251544441, 'support': 432844}, 'weighted avg': {'precision': 0.6274752885585709, 'recall': 0.5724025283936014, 'f1-score': 0.5852892474112189, 'support': 432844}}
[[ 55257  18824  24170]
 [ 49341 135432  53271]
 [ 22032  17445  57072]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8945075
{'0': {'precision': 0.4598960793575815, 'recall': 0.5350773542908961, 'f1-score': 0.4946463273678729, 'support': 36391}, '1': {'precision': 0.7415493602858102, 'recall': 0.6257004830917874, 'f1-score': 0.6787169078345199, 'support': 77625}, '2': {'precision': 0.4460920177383592, 'recall': 0.520340535589202, 'f1-score': 0.48036411570124604, 'support': 37118}, 'accuracy': 0.5780036259213678, 'macro avg': {'precision': 0.5491791524605836, 'recall': 0.5603727909906285, 'f1-score': 0.551242450301213, 'support': 151134}, 'weighted avg': {'precision': 0.6011677771414783, 'recall': 0.5780036259213678, 'f1-score': 0.5856804538786621, 'support': 151134}}
[[19472  8365  8554]
 [13627 48570 15428]
 [ 9241  8563 19314]]
testing model on single stock: results/universal/W8/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
10609/10609 - 150s - 150s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1019233
{'0': {'precision': 0.4245664704834242, 'recall': 0.5207985508357527, 'f1-score': 0.4677846071619455, 'support': 873883}, '1': {'precision': 0.4935983135590024, 'recall': 0.37562589964768894, 'f1-score': 0.42660641012561024, 'support': 940646}, '2': {'precision': 0.434635056870475, 'recall': 0.4475344364386514, 'f1-score': 0.4409904371173904, 'support': 901153}, 'accuracy': 0.4462028322903786, 'macro avg': {'precision': 0.4509332803043005, 'recall': 0.44798629564069764, 'f1-score': 0.44512715146831533, 'support': 2715682}, 'weighted avg': {'precision': 0.451818506579742, 'recall': 0.4462028322903786, 'f1-score': 0.4446302934213818, 'support': 2715682}}
[[455117 169536 249230]
 [311944 353331 275371]
 [304896 192960 403297]]
Evaluating performance on  train set...
3903/3903 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0914024
{'0': {'precision': 0.4667271061632437, 'recall': 0.4377871140963544, 'f1-score': 0.4517941416534211, 'support': 336321}, '1': {'precision': 0.444763275071805, 'recall': 0.5012160892290117, 'f1-score': 0.4713052266820676, 'support': 325634}, '2': {'precision': 0.453665161229195, 'recall': 0.4261067669708224, 'f1-score': 0.4394543379763759, 'support': 337108}, 'accuracy': 0.454519885132369, 'macro avg': {'precision': 0.4550518474880813, 'recall': 0.45503665676539623, 'f1-score': 0.4541845687706216, 'support': 999063}, 'weighted avg': {'precision': 0.45516081223938015, 'recall': 0.454519885132369, 'f1-score': 0.45398982513309843, 'support': 999063}}
[[147237  99695  89389]
 [ 78824 163213  83597]
 [ 89406 104058 143644]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0926442
{'0': {'precision': 0.450122750313499, 'recall': 0.512714507011085, 'f1-score': 0.4793841581551079, 'support': 99414}, '1': {'precision': 0.451339965727342, 'recall': 0.4033585740417748, 'f1-score': 0.42600247107716505, 'support': 94028}, '2': {'precision': 0.44605350083365664, 'recall': 0.428839310018046, 'f1-score': 0.43727705418547036, 'support': 99191}, 'accuracy': 0.4491462001893156, 'macro avg': {'precision': 0.4491720722914992, 'recall': 0.4483041303569686, 'f1-score': 0.44755456113924774, 'support': 292633}, 'weighted avg': {'precision': 0.4491345480457362, 'recall': 0.4491462001893156, 'f1-score': 0.4479590658981952, 'support': 292633}}
[[50971 21960 26483]
 [29758 37927 26343]
 [32509 24145 42537]]
training model: results/universal/W8/deepLOB_L2/h20
Epoch 1/50
7696/7696 - 320s - loss: 2.9734 - accuracy20: 0.4814 - val_loss: 3.3012 - val_accuracy20: 0.4001 - 320s/epoch - 42ms/step
Epoch 2/50
7696/7696 - 317s - loss: 2.8879 - accuracy20: 0.5048 - val_loss: 3.1822 - val_accuracy20: 0.4293 - 317s/epoch - 41ms/step
Epoch 3/50
7696/7696 - 318s - loss: 2.8300 - accuracy20: 0.5207 - val_loss: 3.1453 - val_accuracy20: 0.4468 - 318s/epoch - 41ms/step
Epoch 4/50
7696/7696 - 320s - loss: 2.7957 - accuracy20: 0.5288 - val_loss: 3.1145 - val_accuracy20: 0.4457 - 320s/epoch - 42ms/step
Epoch 5/50
7696/7696 - 317s - loss: 2.7760 - accuracy20: 0.5330 - val_loss: 3.1090 - val_accuracy20: 0.4507 - 317s/epoch - 41ms/step
Epoch 6/50
7696/7696 - 317s - loss: 2.7604 - accuracy20: 0.5361 - val_loss: 3.1231 - val_accuracy20: 0.4476 - 317s/epoch - 41ms/step
Epoch 7/50
7696/7696 - 314s - loss: 2.7488 - accuracy20: 0.5386 - val_loss: 3.1152 - val_accuracy20: 0.4488 - 314s/epoch - 41ms/step
Epoch 8/50
7696/7696 - 316s - loss: 2.7405 - accuracy20: 0.5403 - val_loss: 3.1319 - val_accuracy20: 0.4450 - 316s/epoch - 41ms/step
Epoch 9/50
7696/7696 - 316s - loss: 2.7339 - accuracy20: 0.5418 - val_loss: 3.0926 - val_accuracy20: 0.4578 - 316s/epoch - 41ms/step
Epoch 10/50
7696/7696 - 314s - loss: 2.7283 - accuracy20: 0.5428 - val_loss: 3.1116 - val_accuracy20: 0.4550 - 314s/epoch - 41ms/step
Epoch 11/50
7696/7696 - 314s - loss: 2.7230 - accuracy20: 0.5443 - val_loss: 3.1285 - val_accuracy20: 0.4574 - 314s/epoch - 41ms/step
Epoch 12/50
7696/7696 - 312s - loss: 2.7196 - accuracy20: 0.5447 - val_loss: 3.1272 - val_accuracy20: 0.4582 - 312s/epoch - 41ms/step
Epoch 13/50
7696/7696 - 313s - loss: 2.7155 - accuracy20: 0.5455 - val_loss: 3.1418 - val_accuracy20: 0.4572 - 313s/epoch - 41ms/step
Epoch 14/50
7696/7696 - 314s - loss: 2.7119 - accuracy20: 0.5462 - val_loss: 3.1136 - val_accuracy20: 0.4650 - 314s/epoch - 41ms/step
Epoch 15/50
7696/7696 - 315s - loss: 2.7092 - accuracy20: 0.5467 - val_loss: 3.1244 - val_accuracy20: 0.4635 - 315s/epoch - 41ms/step
Epoch 16/50
7696/7696 - 313s - loss: 2.7062 - accuracy20: 0.5476 - val_loss: 3.1397 - val_accuracy20: 0.4618 - 313s/epoch - 41ms/step
Epoch 17/50
7696/7696 - 316s - loss: 2.7032 - accuracy20: 0.5483 - val_loss: 3.1420 - val_accuracy20: 0.4601 - 316s/epoch - 41ms/step
Epoch 18/50
7696/7696 - 315s - loss: 2.7007 - accuracy20: 0.5486 - val_loss: 3.1511 - val_accuracy20: 0.4602 - 315s/epoch - 41ms/step
Epoch 19/50
7696/7696 - 313s - loss: 2.6984 - accuracy20: 0.5491 - val_loss: 3.1448 - val_accuracy20: 0.4612 - 313s/epoch - 41ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 333s - 333s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0467179
{'0': {'precision': 0.4002601111461461, 'recall': 0.5515481034517629, 'f1-score': 0.4638806469711124, 'support': 1532811}, '1': {'precision': 0.64624431737799, 'recall': 0.4034070581232461, 'f1-score': 0.4967354399508684, 'support': 2876147}, '2': {'precision': 0.3785789282987112, 'recall': 0.5008840149225843, 'f1-score': 0.4312271143040835, 'support': 1552010}, 'accuracy': 0.4668795403699533, 'macro avg': {'precision': 0.4750277856076159, 'recall': 0.4852797254991977, 'f1-score': 0.4639477337420215, 'support': 5960968}, 'weighted avg': {'precision': 0.513301705097003, 'recall': 0.4668795403699533, 'f1-score': 0.47123123248504084, 'support': 5960968}}
[[ 845419  320480  366912]
 [ 806770 1160258  909119]
 [ 459985  314648  777377]]
Evaluating performance on  train set...
7696/7696 - 112s - 112s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0585718
{'0': {'precision': 0.42138116356670957, 'recall': 0.4937076631960389, 'f1-score': 0.45468615394489026, 'support': 559649}, '1': {'precision': 0.5617897815669923, 'recall': 0.42449321226541525, 'f1-score': 0.4835852397061226, 'support': 850652}, '2': {'precision': 0.39670080415849496, 'recall': 0.476038978573945, 'f1-score': 0.4327636927924201, 'support': 559179}, 'accuracy': 0.45879623047708024, 'macro avg': {'precision': 0.4599572497640656, 'recall': 0.4647466180117997, 'f1-score': 0.4570116954811443, 'support': 1969480}, 'weighted avg': {'precision': 0.47501873948809514, 'recall': 0.45879623047708024, 'f1-score': 0.46094388958891136, 'support': 1969480}}
[[276303 143641 139705]
 [224440 361096 265116]
 [154965 138023 266191]]
Evaluating performance on  val set...
2338/2338 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0567394
{'0': {'precision': 0.4080183062087001, 'recall': 0.5270902081913116, 'f1-score': 0.45997325583844, 'support': 165761}, '1': {'precision': 0.5931178239475123, 'recall': 0.38904392069842764, 'f1-score': 0.4698795996128779, 'support': 267687}, '2': {'precision': 0.39542249628714654, 'recall': 0.5006450356595186, 'f1-score': 0.44185578139223886, 'support': 164332}, 'accuracy': 0.45800294422697313, 'macro avg': {'precision': 0.4655195421477864, 'recall': 0.47225972151641926, 'f1-score': 0.45723621228118555, 'support': 597780}, 'weighted avg': {'precision': 0.4874435796687033, 'recall': 0.45800294422697313, 'f1-score': 0.45942877230813595, 'support': 597780}}
[[ 87371  35976  42414]
 [ 80170 104142  83375]
 [ 46594  35466  82272]]
testing model out of sample: results/universal/W8/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 200s - 200s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9901756
{'0': {'precision': 0.39544527475544367, 'recall': 0.5727850524542462, 'f1-score': 0.46787450481196574, 'support': 744363}, '1': {'precision': 0.8106616898482087, 'recall': 0.43855831008810764, 'f1-score': 0.5691910484480301, 'support': 2133413}, '2': {'precision': 0.34087319192967297, 'recall': 0.6388015480320548, 'f1-score': 0.4445359542409137, 'support': 738486}, 'accuracy': 0.5070794096224223, 'macro avg': {'precision': 0.5156600521777751, 'recall': 0.5500483035248028, 'f1-score': 0.4938671691669699, 'support': 3616262}, 'weighted avg': {'precision': 0.6292578078668801, 'recall': 0.5070794096224223, 'f1-score': 0.5228801538637305, 'support': 3616262}}
[[426360 116225 201778]
 [487377 935626 710410]
 [164440 102300 471746]]
Evaluating performance on  train set...
4550/4550 - 67s - 67s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9569261
{'0': {'precision': 0.4288646823163262, 'recall': 0.5206722406560157, 'f1-score': 0.47033017816912454, 'support': 273652}, '1': {'precision': 0.7553629579871202, 'recall': 0.5028255269510555, 'f1-score': 0.6037502042594912, 'support': 617230}, '2': {'precision': 0.3949420963129744, 'recall': 0.6085139551138256, 'f1-score': 0.47900010513990077, 'support': 273269}, 'accuracy': 0.5318296337846207, 'macro avg': {'precision': 0.5263899122054736, 'recall': 0.5440039075736323, 'f1-score': 0.5176934958561722, 'support': 1164151}, 'weighted avg': {'precision': 0.5940103889624005, 'recall': 0.5318296337846207, 'f1-score': 0.5431042985170297, 'support': 1164151}}
[[142483  53773  77396]
 [129511 310359 177360]
 [ 60239  46742 166288]]
Evaluating performance on  val set...
1570/1570 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.976383
{'0': {'precision': 0.41053736689340004, 'recall': 0.5129748440152567, 'f1-score': 0.4560748396328585, 'support': 90714}, '1': {'precision': 0.7405396840705709, 'recall': 0.4913496391302559, 'f1-score': 0.5907412292271169, 'support': 218777}, '2': {'precision': 0.3742711804946501, 'recall': 0.5827161303008455, 'f1-score': 0.4557925722122298, 'support': 91542}, 'accuracy': 0.5170970967476491, 'macro avg': {'precision': 0.5084494104862071, 'recall': 0.5290135378154527, 'f1-score': 0.5008695470240684, 'support': 401033}, 'weighted avg': {'precision': 0.5822864192401035, 'recall': 0.5170970967476491, 'f1-score': 0.5294754560211454, 'support': 401033}}
[[ 46534  19629  24551]
 [ 46650 107496  64631]
 [ 20165  18034  53343]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1267726
{'0': {'precision': 0.41354817494245316, 'recall': 0.4601957734882444, 'f1-score': 0.435626759038753, 'support': 54655}, '1': {'precision': 0.46952410319662863, 'recall': 0.24064903592877462, 'f1-score': 0.31820556581101317, 'support': 56946}, '2': {'precision': 0.39123296448069195, 'recall': 0.5496689983684339, 'f1-score': 0.4571116656269495, 'support': 53323}, 'accuracy': 0.4133176493415149, 'macro avg': {'precision': 0.4247684142065913, 'recall': 0.41683793592848434, 'f1-score': 0.4036479968255719, 'support': 164924}, 'weighted avg': {'precision': 0.42566097382502804, 'recall': 0.4133176493415149, 'f1-score': 0.40202929841722757, 'support': 164924}}
[[25152  8310 21193]
 [18828 13704 24414]
 [16840  7173 29310]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1087583
{'0': {'precision': 0.417191924728236, 'recall': 0.4832548542405164, 'f1-score': 0.44779997548719197, 'support': 18901}, '1': {'precision': 0.4195890896209706, 'recall': 0.2507807124331763, 'f1-score': 0.3139307603114129, 'support': 18893}, '2': {'precision': 0.4223548064085447, 'recall': 0.5228822314049587, 'f1-score': 0.4672728951255539, 'support': 19360}, 'accuracy': 0.4198306330265598, 'macro avg': {'precision': 0.41971194025258374, 'recall': 0.4189725993595504, 'f1-score': 0.40966787697471957, 'support': 57154}, 'weighted avg': {'precision': 0.4197331821319034, 'recall': 0.4198306330265598, 'f1-score': 0.4101438996549265, 'support': 57154}}
[[ 9134  3372  6395]
 [ 6705  4738  7450]
 [ 6055  3182 10123]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.12668
{'0': {'precision': 0.4229031347077097, 'recall': 0.5006686726847208, 'f1-score': 0.45851194121249234, 'support': 5982}, '1': {'precision': 0.35334645669291337, 'recall': 0.20467502850627137, 'f1-score': 0.2592057761732852, 'support': 5262}, '2': {'precision': 0.41508372027578444, 'recall': 0.4922409477724011, 'f1-score': 0.450381679389313, 'support': 5993}, 'accuracy': 0.4073794743864942, 'macro avg': {'precision': 0.39711110389213583, 'recall': 0.39919488298779776, 'f1-score': 0.38936646559169685, 'support': 17237}, 'weighted avg': {'precision': 0.39895064933297014, 'recall': 0.4073794743864942, 'f1-score': 0.39484229454876774, 'support': 17237}}
[[2995  996 1991]
 [2019 1077 2166]
 [2068  975 2950]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93929696
{'0': {'precision': 0.34324313359568337, 'recall': 0.6134425754060325, 'f1-score': 0.440186259462553, 'support': 68960}, '1': {'precision': 0.9078868825548425, 'recall': 0.46207268127001155, 'f1-score': 0.612441034304311, 'support': 421319}, '2': {'precision': 0.24444464637010854, 'recall': 0.7970696730418808, 'f1-score': 0.374146395738585, 'support': 67501}, 'accuracy': 0.5213274050700993, 'macro avg': {'precision': 0.4985248875068781, 'recall': 0.6241949765726417, 'f1-score': 0.4755912298351497, 'support': 557780}, 'weighted avg': {'precision': 0.7577903439322147, 'recall': 0.5213274050700993, 'f1-score': 0.5623069031577788, 'support': 557780}}
[[ 42303  12226  14431]
 [ 74770 194680 151869]
 [  6172   7526  53803]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95219964
{'0': {'precision': 0.3739645889418099, 'recall': 0.5970821623408827, 'f1-score': 0.4598904946838989, 'support': 24196}, '1': {'precision': 0.8939623160500619, 'recall': 0.4788786871356608, 'f1-score': 0.6236694551887499, 'support': 108587}, '2': {'precision': 0.29210277505929966, 'recall': 0.7245720868992759, 'f1-score': 0.4163563499663085, 'support': 24304}, 'accuracy': 0.5350983849713853, 'macro avg': {'precision': 0.5200098933503905, 'recall': 0.6001776454586065, 'f1-score': 0.49997209994631914, 'support': 157087}, 'weighted avg': {'precision': 0.7207496422492333, 'recall': 0.5350983849713853, 'f1-score': 0.5663678742959861, 'support': 157087}}
[[14447  3704  6045]
 [19955 52000 36632]
 [ 4230  2464 17610]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9401992
{'0': {'precision': 0.3065111899760991, 'recall': 0.62668443654672, 'f1-score': 0.4116731517509728, 'support': 6753}, '1': {'precision': 0.8994492525570417, 'recall': 0.48950929177014646, 'f1-score': 0.6339840283939663, 'support': 35031}, '2': {'precision': 0.3090260071392147, 'recall': 0.7154663518299882, 'f1-score': 0.4316239316239317, 'support': 6776}, 'accuracy': 0.5401153212520593, 'macro avg': {'precision': 0.5049954832241185, 'recall': 0.6105533600489516, 'f1-score': 0.4924270372562902, 'support': 48560}, 'weighted avg': {'precision': 0.7346053759598361, 'recall': 0.5401153212520593, 'f1-score': 0.5748312819836721, 'support': 48560}}
[[ 4232  1002  1519]
 [ 8562 17148  9321]
 [ 1013   915  4848]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1222005
{'0': {'precision': 0.41611610981773944, 'recall': 0.5177520583514921, 'f1-score': 0.46140339657087037, 'support': 76639}, '1': {'precision': 0.5949287656587724, 'recall': 0.3527960582985908, 'f1-score': 0.4429313619040615, 'support': 145115}, '2': {'precision': 0.3450379574497419, 'recall': 0.5288935265292105, 'f1-score': 0.41762619941593654, 'support': 75709}, 'accuracy': 0.44011524122327816, 'macro avg': {'precision': 0.45202761097541794, 'recall': 0.4664805477264311, 'f1-score': 0.4406536526302895, 'support': 297463}, 'weighted avg': {'precision': 0.4852579617951039, 'recall': 0.44011524122327816, 'f1-score': 0.44124997537200916, 'support': 297463}}
[[39680 17684 19275]
 [37185 51196 56734]
 [18493 17174 40042]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1259937
{'0': {'precision': 0.4567518719339014, 'recall': 0.4462503153266784, 'f1-score': 0.45144002916514764, 'support': 27749}, '1': {'precision': 0.4459251440383516, 'recall': 0.36374399081581404, 'f1-score': 0.40066388729722796, 'support': 27874}, '2': {'precision': 0.43843007055196537, 'recall': 0.5289888765692621, 'f1-score': 0.4794709286304767, 'support': 27959}, 'accuracy': 0.44641190686990023, 'macro avg': {'precision': 0.4470356955080728, 'recall': 0.4463277275705848, 'f1-score': 0.4438582816976175, 'support': 83582}, 'weighted avg': {'precision': 0.4470124129810395, 'recall': 0.44641190686990023, 'f1-score': 0.4438831597402086, 'support': 83582}}
[[12383  6501  8865]
 [ 7656 10139 10079]
 [ 7072  6097 14790]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1104963
{'0': {'precision': 0.4533288725326196, 'recall': 0.4136983513128435, 'f1-score': 0.43260788591496835, 'support': 9826}, '1': {'precision': 0.4757598359127354, 'recall': 0.42656524283206554, 'f1-score': 0.44982149940499805, 'support': 11963}, '2': {'precision': 0.4359864451607571, 'recall': 0.5273417974607618, 'f1-score': 0.47733236811148316, 'support': 10003}, 'accuracy': 0.4542966784096628, 'macro avg': {'precision': 0.45502505120203735, 'recall': 0.4558684638685569, 'f1-score': 0.45325391781048313, 'support': 31792}, 'weighted avg': {'precision': 0.45631280918069406, 'recall': 0.4542966784096628, 'f1-score': 0.45315725222073594, 'support': 31792}}
[[4065 2937 2824]
 [2860 5103 4000]
 [2042 2686 5275]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2094669
{'0': {'precision': 0.36324593705086444, 'recall': 0.40943425164394853, 'f1-score': 0.3849596005569851, 'support': 104322}, '1': {'precision': 0.3355665238043663, 'recall': 0.20095064256395526, 'f1-score': 0.2513705536689113, 'support': 107927}, '2': {'precision': 0.360700225509307, 'recall': 0.46817947293221146, 'f1-score': 0.4074715348511867, 'support': 100784}, 'accuracy': 0.35646720952743, 'macro avg': {'precision': 0.353170895454846, 'recall': 0.35952145571337174, 'f1-score': 0.3479338963590277, 'support': 313033}, 'weighted avg': {'precision': 0.3528830582954005, 'recall': 0.35646720952743, 'f1-score': 0.3461489247573655, 'support': 313033}}
[[42713 22175 39434]
 [42043 21688 44196]
 [32831 20768 47185]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.20352
{'0': {'precision': 0.38628353797180537, 'recall': 0.43194025107262035, 'f1-score': 0.40783807709042896, 'support': 31465}, '1': {'precision': 0.3378101100540944, 'recall': 0.18052832696461207, 'f1-score': 0.23530685607865218, 'support': 30095}, '2': {'precision': 0.3647638971906754, 'recall': 0.49050537526373955, 'f1-score': 0.41839139563782834, 'support': 29859}, 'accuracy': 0.3683041818440368, 'macro avg': {'precision': 0.36295251507219173, 'recall': 0.3676579844336573, 'f1-score': 0.3538454429356365, 'support': 91419}, 'weighted avg': {'precision': 0.36329747635149373, 'recall': 0.3683041818440368, 'f1-score': 0.35448794683476414, 'support': 91419}}
[[13591  5506 12368]
 [11524  5433 13138]
 [10069  5144 14646]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.206202
{'0': {'precision': 0.37891284905097883, 'recall': 0.4429085840399582, 'f1-score': 0.4084190231362468, 'support': 8609}, '1': {'precision': 0.3433229441380964, 'recall': 0.17267575063306403, 'f1-score': 0.22978177150192555, 'support': 8293}, '2': {'precision': 0.373911465892598, 'recall': 0.4932982288176161, 'f1-score': 0.42538699690402476, 'support': 8356}, 'accuracy': 0.3708527991131523, 'macro avg': {'precision': 0.36538241969389107, 'recall': 0.3696275211635461, 'f1-score': 0.3545292638473991, 'support': 25258}, 'weighted avg': {'precision': 0.3655729710276213, 'recall': 0.3708527991131523, 'f1-score': 0.35538021012651233, 'support': 25258}}
[[3813 1382 3414]
 [3373 1432 3488]
 [2877 1357 4122]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1376704
{'0': {'precision': 0.42186424445575077, 'recall': 0.4701364974276447, 'f1-score': 0.4446942002752572, 'support': 119929}, '1': {'precision': 0.4574341287753912, 'recall': 0.28295123883324574, 'f1-score': 0.34963293194097833, 'support': 127499}, '2': {'precision': 0.41906822664343296, 'recall': 0.5392209200141262, 'f1-score': 0.47161205051216115, 'support': 121759}, 'accuracy': 0.4282761852394586, 'macro avg': {'precision': 0.43278886662485827, 'recall': 0.4307695520916723, 'f1-score': 0.4219797275761323, 'support': 369187}, 'weighted avg': {'precision': 0.4332261947629388, 'recall': 0.4282761852394586, 'f1-score': 0.42074231105825594, 'support': 369187}}
[[56383 21382 42164]
 [42573 36076 48850]
 [34696 21408 65655]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1115196
{'0': {'precision': 0.42803809888479394, 'recall': 0.42978662053056516, 'f1-score': 0.4289105776839884, 'support': 41616}, '1': {'precision': 0.45255337745036833, 'recall': 0.34603083679411906, 'f1-score': 0.3921876268022831, 'support': 41898}, '2': {'precision': 0.43445778540118163, 'recall': 0.5328907382299313, 'f1-score': 0.4786662187132538, 'support': 42778}, 'accuracy': 0.4369239540113388, 'macro avg': {'precision': 0.4383497539121146, 'recall': 0.4362360651848718, 'f1-score': 0.4332548077331751, 'support': 126292}, 'weighted avg': {'precision': 0.43834565986362445, 'recall': 0.4369239540113388, 'f1-score': 0.43358093381033236, 'support': 126292}}
[[17886  9090 14640]
 [12366 14498 15034]
 [11534  8448 22796]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1238779
{'0': {'precision': 0.4263962520034521, 'recall': 0.541066958698373, 'f1-score': 0.4769358063848859, 'support': 12784}, '1': {'precision': 0.4530929946743138, 'recall': 0.3388739946380697, 'f1-score': 0.3877470528945178, 'support': 13055}, '2': {'precision': 0.43471468508469, 'recall': 0.42952311316922576, 'f1-score': 0.4321033059539863, 'support': 12309}, 'accuracy': 0.4358813043934151, 'macro avg': {'precision': 0.43806797725415203, 'recall': 0.4364880221685561, 'f1-score': 0.4322620550777967, 'support': 38148}, 'weighted avg': {'precision': 0.4382164671750222, 'recall': 0.4358813043934151, 'f1-score': 0.4319478011258763, 'support': 38148}}
[[6917 2683 3184]
 [4940 4424 3691]
 [4365 2657 5287]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
5521/5521 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.001239
{'0': {'precision': 0.32357621774788975, 'recall': 0.73397646260043, 'f1-score': 0.44914514822278084, 'support': 176740}, '1': {'precision': 0.9285689664087141, 'recall': 0.40911532934290884, 'f1-score': 0.5679842392056348, 'support': 1053522}, '2': {'precision': 0.27888617717122854, 'recall': 0.8352781784012937, 'f1-score': 0.4181565078505537, 'support': 183048}, 'accuracy': 0.5049359305460231, 'macro avg': {'precision': 0.5103437871092774, 'recall': 0.6594566567815442, 'f1-score': 0.4784286317596565, 'support': 1413310}, 'weighted avg': {'precision': 0.7687671157159026, 'recall': 0.5049359305460231, 'f1-score': 0.5337176681706923, 'support': 1413310}}
[[129723  19073  27944]
 [255112 431012 367398]
 [ 16069  14083 152896]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0408052
{'0': {'precision': 0.3260086381593761, 'recall': 0.7029705155367232, 'f1-score': 0.4454404340712358, 'support': 45312}, '1': {'precision': 0.9261543690582108, 'recall': 0.3879112182989788, 'f1-score': 0.5468002101125519, 'support': 238833}, '2': {'precision': 0.27593548044942456, 'recall': 0.7989689590874192, 'f1-score': 0.4102018290760012, 'support': 45585}, 'accuracy': 0.4880356655445364, 'macro avg': {'precision': 0.5093661625556705, 'recall': 0.6299502309743737, 'f1-score': 0.4674808244199296, 'support': 329730}, 'weighted avg': {'precision': 0.7537890052887039, 'recall': 0.4880356655445364, 'f1-score': 0.5139865402264775, 'support': 329730}}
[[31853  3919  9540]
 [60157 92646 86030]
 [ 5696  3468 36421]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0099854
{'0': {'precision': 0.29178986929007655, 'recall': 0.7681507347592027, 'f1-score': 0.42292672180722174, 'support': 13746}, '1': {'precision': 0.9314167812929849, 'recall': 0.3995680600467345, 'f1-score': 0.5592316078094546, 'support': 84734}, '2': {'precision': 0.2757745692608288, 'recall': 0.8070696569137086, 'f1-score': 0.4110827423167848, 'support': 13466}, 'accuracy': 0.49384524681542885, 'macro avg': {'precision': 0.4996604066146301, 'recall': 0.658262817239882, 'f1-score': 0.46441369064448706, 'support': 111946}, 'weighted avg': {'precision': 0.7740088385382907, 'recall': 0.49384524681542885, 'f1-score': 0.5246736996598915, 'support': 111946}}
[[10559  1374  1813]
 [24149 33857 26728]
 [ 1479  1119 10868]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
5918/5918 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9246221
{'0': {'precision': 0.33895845025448496, 'recall': 0.6860709769117993, 'f1-score': 0.4537422027804455, 'support': 178706}, '1': {'precision': 0.9266723988508335, 'recall': 0.46842267751410405, 'f1-score': 0.6222864285051456, 'support': 1159598}, '2': {'precision': 0.24641662537711612, 'recall': 0.7908762676566461, 'f1-score': 0.3757570543008751, 'support': 176704}, 'accuracy': 0.5317054431395741, 'macro avg': {'precision': 0.5040158248274782, 'recall': 0.6484566406941831, 'f1-score': 0.4839285618621554, 'support': 1515008}, 'weighted avg': {'precision': 0.7780052465362854, 'recall': 0.5317054431395741, 'f1-score': 0.5736513117653332, 'support': 1515008}}
[[122605  24634  31467]
 [220501 543182 395915]
 [ 18605  18348 139751]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8838747
{'0': {'precision': 0.355019843676886, 'recall': 0.6394069449863441, 'f1-score': 0.45654874997910594, 'support': 64075}, '1': {'precision': 0.9039846836197577, 'recall': 0.5323039306090154, 'f1-score': 0.6700527951473396, 'support': 336182}, '2': {'precision': 0.30308311080778433, 'recall': 0.7144575302239855, 'f1-score': 0.42561447094784155, 'support': 64022}, 'accuracy': 0.5722033518638577, 'macro avg': {'precision': 0.5206958793681427, 'recall': 0.6287228019397816, 'f1-score': 0.517405338691429, 'support': 464279}, 'weighted avg': {'precision': 0.7453605748103831, 'recall': 0.5722033518638577, 'f1-score': 0.6068802155431472, 'support': 464279}}
[[ 40970  10730  12375]
 [ 64428 178951  92803]
 [ 10004   8277  45741]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9292052
{'0': {'precision': 0.30325950380645, 'recall': 0.6780697405387539, 'f1-score': 0.4190868543801709, 'support': 18153}, '1': {'precision': 0.9328831500661587, 'recall': 0.4844564496256279, 'f1-score': 0.6377317883376742, 'support': 126612}, '2': {'precision': 0.24628427512326628, 'recall': 0.7732917525199087, 'f1-score': 0.3735858701354606, 'support': 17957}, 'accuracy': 0.5379297206278192, 'macro avg': {'precision': 0.4941423096652917, 'recall': 0.6452726475614301, 'f1-score': 0.4768015042844352, 'support': 162722}, 'weighted avg': {'precision': 0.786874533850146, 'recall': 0.5379297206278192, 'f1-score': 0.5841905969850132, 'support': 162722}}
[[12309  2560  3284]
 [26062 61338 39212]
 [ 2218  1853 13886]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
3755/3755 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9503243
{'0': {'precision': 0.4904526043734805, 'recall': 0.4897429654620709, 'f1-score': 0.4900975280367001, 'support': 287510}, '1': {'precision': 0.5992805450295491, 'recall': 0.6014320585842148, 'f1-score': 0.60035437419716, 'support': 399425}, '2': {'precision': 0.48777497163354194, 'recall': 0.4859642341409338, 'f1-score': 0.48686791928949025, 'support': 274228}, 'accuracy': 0.5350788575923127, 'macro avg': {'precision': 0.5258360403455239, 'recall': 0.5257130860624065, 'f1-score': 0.5257732738411168, 'support': 961163}, 'weighted avg': {'precision': 0.5349136565837116, 'recall': 0.5350788575923127, 'f1-score': 0.5349948988573745, 'support': 961163}}
[[140806  85430  61274]
 [ 80527 240227  78671]
 [ 65761  75202 133265]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9704985
{'0': {'precision': 0.5083027943197435, 'recall': 0.49881195112944915, 'f1-score': 0.5035126528429393, 'support': 124574}, '1': {'precision': 0.5903381098957622, 'recall': 0.5100547176624171, 'f1-score': 0.5472677219033003, 'support': 144012}, '2': {'precision': 0.4737261693675862, 'recall': 0.5577086451717302, 'f1-score': 0.5122983563792034, 'support': 123595}, 'accuracy': 0.5215015515795003, 'macro avg': {'precision': 0.5241223578610307, 'recall': 0.5221917713211988, 'f1-score': 0.521026243708481, 'support': 392181}, 'weighted avg': {'precision': 0.52753006924069, 'recall': 0.5215015515795003, 'f1-score': 0.5223486597736302, 'support': 392181}}
[[62139 26775 35660]
 [29642 73454 40916]
 [30467 24198 68930]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99558574
{'0': {'precision': 0.503936109526526, 'recall': 0.4677415084848966, 'f1-score': 0.48516469182925326, 'support': 37773}, '1': {'precision': 0.5384067055035273, 'recall': 0.4960481916796884, 'f1-score': 0.5163602074493164, 'support': 44157}, '2': {'precision': 0.46817140238313476, 'recall': 0.5455103730008277, 'f1-score': 0.5038905947492386, 'support': 37453}, 'accuracy': 0.5026092492230887, 'macro avg': {'precision': 0.5035047391377293, 'recall': 0.5031000243884709, 'f1-score': 0.501805164675936, 'support': 119383}, 'weighted avg': {'precision': 0.5054658292514033, 'recall': 0.5026092492230887, 'f1-score': 0.5025779049776692, 'support': 119383}}
[[17668  9721 10384]
 [ 9428 21904 12825]
 [ 7964  9058 20431]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
4960/4960 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9766539
{'0': {'precision': 0.42819098389696686, 'recall': 0.5803825286069573, 'f1-score': 0.49280407006495847, 'support': 314434}, '1': {'precision': 0.7801709401709401, 'recall': 0.4533856935530186, 'f1-score': 0.5734934791465217, 'support': 644255}, '2': {'precision': 0.4200755936532029, 'recall': 0.6336260534870785, 'f1-score': 0.5052110173598025, 'support': 310991}, 'accuracy': 0.5289836809274778, 'macro avg': {'precision': 0.5428125059070367, 'recall': 0.5557980918823514, 'f1-score': 0.5238361888570942, 'support': 1269680}, 'weighted avg': {'precision': 0.6048032274559662, 'recall': 0.5289836809274778, 'f1-score': 0.5367860215755859, 'support': 1269680}}
[[182492  44422  87520]
 [167644 292096 184515]
 [ 76057  37882 197052]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9372855
{'0': {'precision': 0.49238441624446105, 'recall': 0.5111160570764399, 'f1-score': 0.5015754114473158, 'support': 121311}, '1': {'precision': 0.6947116202767737, 'recall': 0.5304938586049703, 'f1-score': 0.6015974535058505, 'support': 192383}, '2': {'precision': 0.455431189105749, 'recall': 0.6116156105749055, 'f1-score': 0.5220929857680693, 'support': 119150}, 'accuracy': 0.547393518219035, 'macro avg': {'precision': 0.5475090752089946, 'recall': 0.5510751754187719, 'f1-score': 0.5417552835737451, 'support': 432844}, 'weighted avg': {'precision': 0.5721391026436506, 'recall': 0.547393518219035, 'f1-score': 0.5516793969424708, 'support': 432844}}
[[ 62004  24052  35255]
 [ 38443 102058  51882]
 [ 25479  20797  72874]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9433311
{'0': {'precision': 0.4984922635819863, 'recall': 0.4586868020650913, 'f1-score': 0.47776185343551236, 'support': 43969}, '1': {'precision': 0.6368138744859646, 'recall': 0.5755352670275511, 'f1-score': 0.6046258965326995, 'support': 61885}, '2': {'precision': 0.4734044496401564, 'recall': 0.5723719081272085, 'f1-score': 0.5182052666306761, 'support': 45280}, 'accuracy': 0.5405931160427171, 'macro avg': {'precision': 0.5362368625693691, 'recall': 0.5355313257399503, 'f1-score': 0.5335310055329626, 'support': 151134}, 'weighted avg': {'precision': 0.5476146098145126, 'recall': 0.5405931160427171, 'f1-score': 0.5418259227815658, 'support': 151134}}
[[20168 10493 13308]
 [10747 35617 15521]
 [ 9543  9820 25917]]
testing model on single stock: results/universal/W8/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
10609/10609 - 155s - 155s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1079727
{'0': {'precision': 0.4136971761954016, 'recall': 0.546819483088512, 'f1-score': 0.4710333211940267, 'support': 895279}, '1': {'precision': 0.4183673312777508, 'recall': 0.30492732288238544, 'f1-score': 0.35275148122338673, 'support': 893954}, '2': {'precision': 0.4426463659019818, 'recall': 0.42081431357797355, 'f1-score': 0.431454334983765, 'support': 926449}, 'accuracy': 0.42420651607957044, 'macro avg': {'precision': 0.4249036244583781, 'recall': 0.4241870398496237, 'f1-score': 0.4184130458003928, 'support': 2715682}, 'weighted avg': {'precision': 0.42511046084027454, 'recall': 0.42420651607957044, 'f1-score': 0.4185947675766944, 'support': 2715682}}
[[489556 181618 224105]
 [354576 272591 266787]
 [339236 197350 389863]]
Evaluating performance on  train set...
3903/3903 - 59s - 59s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1021763
{'0': {'precision': 0.4264580566622399, 'recall': 0.46135311970595805, 'f1-score': 0.4432198199389828, 'support': 334102}, '1': {'precision': 0.40013368206916594, 'recall': 0.4183395366502089, 'f1-score': 0.4090341267778232, 'support': 329125}, '2': {'precision': 0.43877651836483, 'recall': 0.3834937290820519, 'f1-score': 0.40927674030243466, 'support': 335836}, 'accuracy': 0.4210104868261561, 'macro avg': {'precision': 0.4217894190320786, 'recall': 0.4210621284794063, 'f1-score': 0.42051022900641355, 'support': 999063}, 'weighted avg': {'precision': 0.42192678397613864, 'recall': 0.4210104868261561, 'f1-score': 0.42054790199738507, 'support': 999063}}
[[154139 103734  76229]
 [102936 137686  88503]
 [104365 102680 128791]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.107378
{'0': {'precision': 0.4269870609981516, 'recall': 0.5139563106796117, 'f1-score': 0.4664525011473153, 'support': 98880}, '1': {'precision': 0.39318787011645007, 'recall': 0.31086601307189543, 'f1-score': 0.347214179169957, 'support': 95472}, '2': {'precision': 0.4257209823703251, 'recall': 0.4250669000111924, 'f1-score': 0.42539368976279335, 'support': 98281}, 'accuracy': 0.4178441939220799, 'macro avg': {'precision': 0.41529863782830895, 'recall': 0.4166297412542332, 'f1-score': 0.41302012336002186, 'support': 292633}, 'weighted avg': {'precision': 0.4155348056972142, 'recall': 0.4178441939220799, 'f1-score': 0.413761170649714, 'support': 292633}}
[[50820 22645 25415]
 [34854 29679 30939]
 [33346 23159 41776]]
training model: results/universal/W8/deepLOB_L2/h30
Epoch 1/50
7696/7696 - 319s - loss: 3.0308 - accuracy30: 0.4632 - val_loss: 3.2530 - val_accuracy30: 0.4029 - 319s/epoch - 41ms/step
Epoch 2/50
7696/7696 - 312s - loss: 2.9422 - accuracy30: 0.4900 - val_loss: 3.1485 - val_accuracy30: 0.4350 - 312s/epoch - 41ms/step
Epoch 3/50
7696/7696 - 313s - loss: 2.8968 - accuracy30: 0.5013 - val_loss: 3.1197 - val_accuracy30: 0.4457 - 313s/epoch - 41ms/step
Epoch 4/50
7696/7696 - 314s - loss: 2.8662 - accuracy30: 0.5082 - val_loss: 3.0866 - val_accuracy30: 0.4520 - 314s/epoch - 41ms/step
Epoch 5/50
7696/7696 - 314s - loss: 2.8478 - accuracy30: 0.5126 - val_loss: 3.1081 - val_accuracy30: 0.4458 - 314s/epoch - 41ms/step
Epoch 6/50
7696/7696 - 312s - loss: 2.8347 - accuracy30: 0.5156 - val_loss: 3.1305 - val_accuracy30: 0.4460 - 312s/epoch - 41ms/step
Epoch 7/50
7696/7696 - 313s - loss: 2.8270 - accuracy30: 0.5174 - val_loss: 3.1395 - val_accuracy30: 0.4454 - 313s/epoch - 41ms/step
Epoch 8/50
7696/7696 - 312s - loss: 2.8188 - accuracy30: 0.5193 - val_loss: 3.1479 - val_accuracy30: 0.4446 - 312s/epoch - 41ms/step
Epoch 9/50
7696/7696 - 313s - loss: 2.8124 - accuracy30: 0.5207 - val_loss: 3.1721 - val_accuracy30: 0.4430 - 313s/epoch - 41ms/step
Epoch 10/50
7696/7696 - 315s - loss: 2.8077 - accuracy30: 0.5217 - val_loss: 3.1635 - val_accuracy30: 0.4444 - 315s/epoch - 41ms/step
Epoch 11/50
7696/7696 - 315s - loss: 2.8039 - accuracy30: 0.5227 - val_loss: 3.1669 - val_accuracy30: 0.4434 - 315s/epoch - 41ms/step
Epoch 12/50
7696/7696 - 314s - loss: 2.8002 - accuracy30: 0.5236 - val_loss: 3.1705 - val_accuracy30: 0.4452 - 314s/epoch - 41ms/step
Epoch 13/50
7696/7696 - 314s - loss: 2.7968 - accuracy30: 0.5241 - val_loss: 3.1747 - val_accuracy30: 0.4461 - 314s/epoch - 41ms/step
Epoch 14/50
7696/7696 - 316s - loss: 2.7940 - accuracy30: 0.5250 - val_loss: 3.1607 - val_accuracy30: 0.4476 - 316s/epoch - 41ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 335s - 335s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0423658
{'0': {'precision': 0.41729411373332853, 'recall': 0.3682251278162382, 'f1-score': 0.39122702599443027, 'support': 1635160}, '1': {'precision': 0.5178273499049887, 'recall': 0.4973952075717981, 'f1-score': 0.5074056723729471, 'support': 2667583}, '2': {'precision': 0.3844894841230276, 'recall': 0.45347766437003423, 'f1-score': 0.41614374393674347, 'support': 1658225}, 'accuracy': 0.4497454104769561, 'macro avg': {'precision': 0.43987031592044823, 'recall': 0.43969933325269017, 'f1-score': 0.43825881410137363, 'support': 5960968}, 'weighted avg': {'precision': 0.45315796920293755, 'recall': 0.4497454104769561, 'f1-score': 0.4501492860455218, 'support': 5960968}}
[[ 602107  626761  406292]
 [ 543243 1326843  797497]
 [ 297534  608723  751968]]
Evaluating performance on  train set...
7696/7696 - 113s - 113s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0485753
{'0': {'precision': 0.41704151219008756, 'recall': 0.4524258599930756, 'f1-score': 0.4340136751345867, 'support': 580557}, '1': {'precision': 0.5398239546577203, 'recall': 0.3997356191927111, 'f1-score': 0.45933620129235775, 'support': 808682}, '2': {'precision': 0.395845537914967, 'recall': 0.5054089593806711, 'f1-score': 0.4439675629767395, 'support': 580241}, 'accuracy': 0.4464005727400126, 'macro avg': {'precision': 0.45090366825425826, 'recall': 0.4525234795221526, 'f1-score': 0.44577247980122797, 'support': 1969480}, 'weighted avg': {'precision': 0.46121214496129614, 'recall': 0.4464005727400126, 'f1-score': 0.4473438561639636, 'support': 1969480}}
[[262659 138533 179365]
 [217205 323259 268218]
 [149951 137031 293259]]
Evaluating performance on  val set...
2338/2338 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0411966
{'0': {'precision': 0.4136566056407719, 'recall': 0.48699965393932404, 'f1-score': 0.44734186134606263, 'support': 173380}, '1': {'precision': 0.5802467632120629, 'recall': 0.376037477454722, 'f1-score': 0.45633823053989014, 'support': 253379}, '2': {'precision': 0.3941199286999952, 'recall': 0.5287771677162454, 'f1-score': 0.4516248245828693, 'support': 171021}, 'accuracy': 0.45191876610124126, 'macro avg': {'precision': 0.46267443251761, 'recall': 0.4639380997034304, 'f1-score': 0.45176830548960734, 'support': 597780}, 'weighted avg': {'precision': 0.47867929878568743, 'recall': 0.45191876610124126, 'f1-score': 0.45238045026788126, 'support': 597780}}
[[84436 33949 54995]
 [74073 95280 84026]
 [45612 34977 90432]]
testing model out of sample: results/universal/W8/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 199s - 199s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96940243
{'0': {'precision': 0.4161459237105615, 'recall': 0.4916501454350752, 'f1-score': 0.45075807412796326, 'support': 829236}, '1': {'precision': 0.7477018679981224, 'recall': 0.4587279646149408, 'f1-score': 0.5686062243714014, 'support': 1961958}, '2': {'precision': 0.3661905383365076, 'recall': 0.6359548546301638, 'f1-score': 0.4647641993051204, 'support': 825068}, 'accuracy': 0.5067124561218186, 'macro avg': {'precision': 0.5100127766817305, 'recall': 0.5287776548933932, 'f1-score': 0.4947094992681617, 'support': 3616262}, 'weighted avg': {'precision': 0.5846299128249383, 'recall': 0.5067124561218186, 'f1-score': 0.517890689752324, 'support': 3616262}}
[[407694 160157 261385]
 [415167 900005 646786]
 [156829 143533 524706]]
Evaluating performance on  train set...
4550/4550 - 68s - 68s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9801325
{'0': {'precision': 0.43313334367952344, 'recall': 0.4354222474498518, 'f1-score': 0.4342747795916611, 'support': 301257}, '1': {'precision': 0.6711170319186832, 'recall': 0.4886515448679685, 'f1-score': 0.5655307118992547, 'support': 562896}, '2': {'precision': 0.4041063422586876, 'recall': 0.608114054093694, 'f1-score': 0.48555185602159034, 'support': 299998}, 'accuracy': 0.5056620661752642, 'macro avg': {'precision': 0.5027855726189648, 'recall': 0.5107292821371715, 'f1-score': 0.49511911583750207, 'support': 1164151}, 'weighted avg': {'precision': 0.5407242178898468, 'recall': 0.5056620661752642, 'f1-score': 0.5109542306654833, 'support': 1164151}}
[[131174  70587  99496]
 [118317 275060 169519]
 [ 53358  64207 182433]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9854805
{'0': {'precision': 0.42237397901466484, 'recall': 0.4078346093718684, 'f1-score': 0.41497698084541224, 'support': 99788}, '1': {'precision': 0.6495892484860518, 'recall': 0.5217744507794745, 'f1-score': 0.578708514825215, 'support': 200648}, '2': {'precision': 0.39064329115335306, 'recall': 0.5572929610226945, 'f1-score': 0.4593194023981091, 'support': 100597}, 'accuracy': 0.5023327257357874, 'macro avg': {'precision': 0.4875355062180233, 'recall': 0.49563400705801247, 'f1-score': 0.4843349660229121, 'support': 401033}, 'weighted avg': {'precision': 0.528096643688421, 'recall': 0.5023327257357874, 'f1-score': 0.5080194970745409, 'support': 401033}}
[[ 40697  28835  30256]
 [ 38761 104693  57194]
 [ 16895  27640  56062]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1289147
{'0': {'precision': 0.41074234330053905, 'recall': 0.3128647971865736, 'f1-score': 0.35518394648829427, 'support': 54311}, '1': {'precision': 0.4377253814147018, 'recall': 0.24583268421872564, 'f1-score': 0.31484437350359135, 'support': 57771}, '2': {'precision': 0.36763253210405006, 'recall': 0.6338707846031566, 'f1-score': 0.4653634544848283, 'support': 52842}, 'accuracy': 0.3922352113700856, 'macro avg': {'precision': 0.405366752273097, 'recall': 0.39752275533615195, 'f1-score': 0.3784639248255713, 'support': 164924}, 'weighted avg': {'precision': 0.40638171932615336, 'recall': 0.3922352113700856, 'f1-score': 0.37635520167646325, 'support': 164924}}
[[16992  9972 27347]
 [13301 14202 30268]
 [11076  8271 33495]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1049497
{'0': {'precision': 0.42146011008286455, 'recall': 0.3672393802044904, 'f1-score': 0.39248598867828877, 'support': 18974}, '1': {'precision': 0.4360337552742616, 'recall': 0.27456294170784845, 'f1-score': 0.3369526231699762, 'support': 18819}, '2': {'precision': 0.40127211428174203, 'recall': 0.596301843913021, 'f1-score': 0.47972242998421005, 'support': 19361}, 'accuracy': 0.4143192077544879, 'macro avg': {'precision': 0.41958865987962274, 'recall': 0.41270138860845323, 'f1-score': 0.40305368061082497, 'support': 57154}, 'weighted avg': {'precision': 0.4194200366348358, 'recall': 0.4143192077544879, 'f1-score': 0.40375208264586765, 'support': 57154}}
[[ 6968  3469  8537]
 [ 4963  5167  8689]
 [ 4602  3214 11545]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.131788
{'0': {'precision': 0.4226286533978842, 'recall': 0.3940812573148303, 'f1-score': 0.40785603045509605, 'support': 5981}, '1': {'precision': 0.3691545370083617, 'recall': 0.22065901517956313, 'f1-score': 0.27621364847642216, 'support': 5402}, '2': {'precision': 0.39295457241133913, 'recall': 0.5659378202938162, 'f1-score': 0.463843192159608, 'support': 5854}, 'accuracy': 0.3980971166676336, 'macro avg': {'precision': 0.3949125876058617, 'recall': 0.3935593642627366, 'f1-score': 0.3826376236970421, 'support': 17237}, 'weighted avg': {'precision': 0.39579224063281865, 'recall': 0.3980971166676336, 'f1-score': 0.3856141494531477, 'support': 17237}}
[[2357 1070 2554]
 [1646 1192 2564]
 [1574  967 3313]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83927363
{'0': {'precision': 0.44739887209344814, 'recall': 0.4311453858252929, 'f1-score': 0.43912178034944677, 'support': 85194}, '1': {'precision': 0.8334582460904547, 'recall': 0.6362092408732908, 'f1-score': 0.7215970180306139, 'support': 389790}, '2': {'precision': 0.329678904232626, 'recall': 0.7093217063626263, 'f1-score': 0.45014103075083545, 'support': 82796}, 'accuracy': 0.6157409731435333, 'macro avg': {'precision': 0.5368453408055096, 'recall': 0.5922254443537366, 'f1-score': 0.5369532763769653, 'support': 557780}, 'weighted avg': {'precision': 0.6997122231122881, 'recall': 0.6157409731435333, 'f1-score': 0.6381579106373301, 'support': 557780}}
[[ 36731  30404  18059]
 [ 40450 247988 101352]
 [  4918  19149  58729]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92239946
{'0': {'precision': 0.4002270213632924, 'recall': 0.4730957132044313, 'f1-score': 0.43362134207870834, 'support': 29066}, '1': {'precision': 0.8265843056508808, 'recall': 0.5116321411231591, 'f1-score': 0.6320458833672793, 'support': 98864}, '2': {'precision': 0.3353538636548306, 'recall': 0.7077545700860857, 'f1-score': 0.4550787280024699, 'support': 29157}, 'accuracy': 0.5409040849974854, 'macro avg': {'precision': 0.5207217302230013, 'recall': 0.564160808137892, 'f1-score': 0.5069153178161525, 'support': 157087}, 'weighted avg': {'precision': 0.6565173566202043, 'recall': 0.5409040849974854, 'f1-score': 0.5624841814691888, 'support': 157087}}
[[13751  6105  9210]
 [16593 50582 31689]
 [ 4014  4507 20636]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9234629
{'0': {'precision': 0.33715561028166846, 'recall': 0.54247152055473, 'f1-score': 0.4158519221642145, 'support': 8076}, '1': {'precision': 0.8348927082273976, 'recall': 0.5060720009863149, 'f1-score': 0.6301669545192862, 'support': 32444}, '2': {'precision': 0.34918238993710693, 'recall': 0.690547263681592, 'f1-score': 0.46382623224728486, 'support': 8040}, 'accuracy': 0.542668863261944, 'macro avg': {'precision': 0.507076902815391, 'recall': 0.5796969284075457, 'f1-score': 0.5032817029769284, 'support': 48560}, 'weighted avg': {'precision': 0.6716959256478332, 'recall': 0.542668863261944, 'f1-score': 0.5669835194211302, 'support': 48560}}
[[ 4381  1721  1974]
 [ 7651 16419  8374]
 [  962  1526  5552]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1049252
{'0': {'precision': 0.3961202694070579, 'recall': 0.44622162749009014, 'f1-score': 0.4196809679008828, 'support': 79214}, '1': {'precision': 0.5254718364439975, 'recall': 0.36050931614535053, 'f1-score': 0.4276332331820409, 'support': 139167}, '2': {'precision': 0.3391159358592309, 'recall': 0.4834981411699249, 'f1-score': 0.39863632098585233, 'support': 79082}, 'accuracy': 0.4160315736747091, 'macro avg': {'precision': 0.42023601390342874, 'recall': 0.43007636160178847, 'f1-score': 0.41531684068959196, 'support': 297463}, 'weighted avg': {'precision': 0.4414820549877873, 'recall': 0.4160315736747091, 'f1-score': 0.41780658397766707, 'support': 297463}}
[[35347 22969 20898]
 [35378 50171 53618]
 [18508 22338 38236]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1332937
{'0': {'precision': 0.45069499082087594, 'recall': 0.36613166678502945, 'f1-score': 0.4040360501567398, 'support': 28162}, '1': {'precision': 0.3955537590945837, 'recall': 0.3611736482745894, 'f1-score': 0.3775827143821742, 'support': 27095}, '2': {'precision': 0.42003114225336446, 'recall': 0.5333097969991174, 'f1-score': 0.46994042526715296, 'support': 28325}, 'accuracy': 0.42117920126342995, 'macro avg': {'precision': 0.42209329738960805, 'recall': 0.4202050373529121, 'f1-score': 0.4171863966020224, 'support': 83582}, 'weighted avg': {'precision': 0.42242807707989527, 'recall': 0.42117920126342995, 'f1-score': 0.41779485339416655, 'support': 83582}}
[[10311  7764 10087]
 [ 6538  9786 10771]
 [ 6029  7190 15106]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1235687
{'0': {'precision': 0.44572250179726813, 'recall': 0.3686087990487515, 'f1-score': 0.4035144809632282, 'support': 10092}, '1': {'precision': 0.4345519984845615, 'recall': 0.3981602013364575, 'f1-score': 0.41556088945247044, 'support': 11523}, '2': {'precision': 0.4133302296710118, 'recall': 0.5234351970128721, 'f1-score': 0.46191198786039456, 'support': 10177}, 'accuracy': 0.4288814796175138, 'macro avg': {'precision': 0.43120157665094716, 'recall': 0.43006806579936036, 'f1-score': 0.42699578609203104, 'support': 31792}, 'weighted avg': {'precision': 0.43130460222815553, 'recall': 0.4288814796175138, 'f1-score': 0.4265744392141718, 'support': 31792}}
[[3720 3028 3344]
 [2718 4588 4217]
 [1908 2942 5327]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2229488
{'0': {'precision': 0.3669549434123425, 'recall': 0.32331774865711516, 'f1-score': 0.34375703262136115, 'support': 106301}, '1': {'precision': 0.3324660085201908, 'recall': 0.1225873810150871, 'f1-score': 0.17912683741418528, 'support': 106316}, '2': {'precision': 0.3446817485513842, 'recall': 0.6184472594008923, 'f1-score': 0.4426561363992758, 'support': 100416}, 'accuracy': 0.3498161535684736, 'macro avg': {'precision': 0.3480342334946392, 'recall': 0.3547841296910315, 'f1-score': 0.32184666881160745, 'support': 313033}, 'weighted avg': {'precision': 0.3480965139906777, 'recall': 0.3498161535684736, 'f1-score': 0.3195686198064725, 'support': 313033}}
[[34369 14374 57558]
 [32771 13033 60512]
 [26520 11794 62102]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.203274
{'0': {'precision': 0.38391733456978205, 'recall': 0.36944258533320584, 'f1-score': 0.37654090399701157, 'support': 31377}, '1': {'precision': 0.3383467149157526, 'recall': 0.0996137967772007, 'f1-score': 0.15391342369916924, 'support': 30036}, '2': {'precision': 0.35393837577793896, 'recall': 0.617876424715057, 'f1-score': 0.4500655435257562, 'support': 30006}, 'accuracy': 0.3623316815979173, 'macro avg': {'precision': 0.3587341417544912, 'recall': 0.36231093560848787, 'f1-score': 0.326839957073979, 'support': 91419}, 'weighted avg': {'precision': 0.359105120812943, 'recall': 0.3623316815979173, 'f1-score': 0.3275285688749201, 'support': 91419}}
[[11592  3220 16565]
 [ 9767  2992 17277]
 [ 8835  2631 18540]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2062881
{'0': {'precision': 0.36755602988260405, 'recall': 0.3988419224088014, 'f1-score': 0.3825603998889197, 'support': 8635}, '1': {'precision': 0.3348623853211009, 'recall': 0.07837289753071693, 'f1-score': 0.12701788303528275, 'support': 8383}, '2': {'precision': 0.3507827086026138, 'recall': 0.5928398058252428, 'f1-score': 0.4407651357935577, 'support': 8240}, 'accuracy': 0.355768469395835, 'macro avg': {'precision': 0.3510670412687729, 'recall': 0.3566848752549204, 'f1-score': 0.31678113957258675, 'support': 25258}, 'weighted avg': {'precision': 0.35123316228793305, 'recall': 0.355768469395835, 'f1-score': 0.31673547729291757, 'support': 25258}}
[[3444  733 4458]
 [3143  657 4583]
 [2783  572 4885]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1475406
{'0': {'precision': 0.4102460807926699, 'recall': 0.39535287120861695, 'f1-score': 0.40266180967724297, 'support': 121064}, '1': {'precision': 0.4301193981027151, 'recall': 0.25554709769370304, 'f1-score': 0.32060998902751253, 'support': 123488}, '2': {'precision': 0.40372871895060003, 'recall': 0.5803185301079151, 'f1-score': 0.4761788765080566, 'support': 124635}, 'accuracy': 0.41103289119064323, 'macro avg': {'precision': 0.41469806594866165, 'recall': 0.41040616633674504, 'f1-score': 0.399816891737604, 'support': 369187}, 'weighted avg': {'precision': 0.41469321683699567, 'recall': 0.41103289119064323, 'f1-score': 0.40003545608425223, 'support': 369187}}
[[47863 20851 52350]
 [37459 31557 54472]
 [31347 20960 72328]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.127701
{'0': {'precision': 0.41494622153932115, 'recall': 0.3571205308840855, 'f1-score': 0.3838678830796268, 'support': 41591}, '1': {'precision': 0.4272207718902138, 'recall': 0.28986547943893914, 'f1-score': 0.3453881695282642, 'support': 41778}, '2': {'precision': 0.41214139756399737, 'recall': 0.5967663024485707, 'f1-score': 0.4875611473818451, 'support': 42923}, 'accuracy': 0.4163209071041713, 'macro avg': {'precision': 0.4181027969978441, 'recall': 0.4145841042571985, 'f1-score': 0.40560573332991207, 'support': 126292}, 'weighted avg': {'precision': 0.4180534231440687, 'recall': 0.4163209071041713, 'f1-score': 0.4063809520855439, 'support': 126292}}
[[14853  8359 18379]
 [11511 12110 18157]
 [ 9431  7877 25615]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1312866
{'0': {'precision': 0.4171794709128973, 'recall': 0.5097279280675917, 'f1-score': 0.45883337984928835, 'support': 12901}, '1': {'precision': 0.42560359348680515, 'recall': 0.2975816582914573, 'f1-score': 0.35026107850838684, 'support': 12736}, '2': {'precision': 0.4128338278931751, 'recall': 0.4448085684597554, 'f1-score': 0.42822515486129814, 'support': 12511}, 'accuracy': 0.41761035965188215, 'macro avg': {'precision': 0.41853896409762587, 'recall': 0.41737271827293476, 'f1-score': 0.41243987107299107, 'support': 38148}, 'weighted avg': {'precision': 0.4185667332931412, 'recall': 0.41761035965188215, 'f1-score': 0.41254743215340733, 'support': 38148}}
[[6576 2516 3809]
 [4840 3790 4106]
 [4347 2599 5565]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
5521/5521 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93405783
{'0': {'precision': 0.3710268053317709, 'recall': 0.6465153188606221, 'f1-score': 0.47147829588930756, 'support': 215486}, '1': {'precision': 0.8658404179931216, 'recall': 0.4096334649100323, 'f1-score': 0.5561497028451557, 'support': 975350}, '2': {'precision': 0.31550603592756193, 'recall': 0.8174078768755001, 'f1-score': 0.4552810519042231, 'support': 222474}, 'accuracy': 0.5099397867417622, 'macro avg': {'precision': 0.5174577530841514, 'recall': 0.6245188868820515, 'f1-score': 0.49430301687956213, 'support': 1413310}, 'weighted avg': {'precision': 0.7037666355578476, 'recall': 0.5099397867417622, 'f1-score': 0.5273618537188346, 'support': 1413310}}
[[139315  35866  40305]
 [221589 399536 354225]
 [ 14581  26041 181852]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9468261
{'0': {'precision': 0.36649471874232376, 'recall': 0.6034600040446381, 'f1-score': 0.4560313987009829, 'support': 54393}, '1': {'precision': 0.8652583113277812, 'recall': 0.4054508534805508, 'f1-score': 0.5521636744658328, 'support': 220626}, '2': {'precision': 0.314756735022115, 'recall': 0.7869349856518799, 'f1-score': 0.44965952291431677, 'support': 54711}, 'accuracy': 0.5014132775301003, 'macro avg': {'precision': 0.51550325503074, 'recall': 0.598615281059023, 'f1-score': 0.48595153202704416, 'support': 329730}, 'weighted avg': {'precision': 0.6916382590645352, 'recall': 0.5014132775301003, 'f1-score': 0.5192973064944245, 'support': 329730}}
[[32824  7586 13983]
 [51425 89453 79748]
 [ 5313  6344 43054]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8933803
{'0': {'precision': 0.3565096525096525, 'recall': 0.6876787416587226, 'f1-score': 0.46957830712585696, 'support': 16784}, '1': {'precision': 0.8701710249401292, 'recall': 0.45710655060677297, 'f1-score': 0.5993635136711265, 'support': 78695}, '2': {'precision': 0.32904373299853523, 'recall': 0.7639521467176777, 'f1-score': 0.45997184592040075, 'support': 16467}, 'accuracy': 0.53681239168885, 'macro avg': {'precision': 0.5185748034827723, 'recall': 0.6362458129943911, 'f1-score': 0.5096378889057948, 'support': 111946}, 'weighted avg': {'precision': 0.7135594837392345, 'recall': 0.53681239168885, 'f1-score': 0.5594006967816707, 'support': 111946}}
[[11542  2852  2390]
 [19461 35972 23262]
 [ 1372  2515 12580]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
5918/5918 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88941306
{'0': {'precision': 0.36928572918311586, 'recall': 0.5718880060537268, 'f1-score': 0.448780222863919, 'support': 216726}, '1': {'precision': 0.8653664964895093, 'recall': 0.509827841046877, 'f1-score': 0.6416372153043031, 'support': 1084521}, '2': {'precision': 0.2903428151662451, 'recall': 0.7340534522200027, 'f1-score': 0.41610293318200264, 'support': 213761}, 'accuracy': 0.550342968485975, 'macro avg': {'precision': 0.5083316802796234, 'recall': 0.6052564331068688, 'f1-score': 0.5021734571167417, 'support': 1515008}, 'weighted avg': {'precision': 0.7132674729077279, 'recall': 0.550342968485975, 'f1-score': 0.5822265995026837, 'support': 1515008}}
[[123943  47873  44910]
 [192987 552919 338615]
 [ 18699  38150 156912]]
Evaluating performance on  train set...
1814/1814 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9103504
{'0': {'precision': 0.362553503521427, 'recall': 0.5602535047960366, 'f1-score': 0.44022611270434525, 'support': 75896}, '1': {'precision': 0.8464916066111423, 'recall': 0.502039497467824, 'f1-score': 0.6302742584258607, 'support': 312577}, '2': {'precision': 0.32613094243656143, 'recall': 0.6952879719283434, 'f1-score': 0.4439998483693386, 'support': 75806}, 'accuracy': 0.5431087772653943, 'macro avg': {'precision': 0.5117253508563769, 'recall': 0.5858603247307347, 'f1-score': 0.5048334064998482, 'support': 464279}, 'weighted avg': {'precision': 0.6824190838812421, 'recall': 0.5431087772653943, 'f1-score': 0.5687926665459246, 'support': 464279}}
[[ 42521  15187  18188]
 [ 64933 156926  90718]
 [  9828  13271  52707]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8923952
{'0': {'precision': 0.33898490483482824, 'recall': 0.563557010365521, 'f1-score': 0.42333173963527077, 'support': 21996}, '1': {'precision': 0.8803583126833575, 'recall': 0.519213163221596, 'f1-score': 0.6531908261436942, 'support': 119059}, '2': {'precision': 0.2845573512585812, 'recall': 0.7346194673928094, 'f1-score': 0.41021609989304536, 'support': 21667}, 'accuracy': 0.5538894556359927, 'macro avg': {'precision': 0.5013001895922556, 'recall': 0.6057965469933088, 'f1-score': 0.49557955522400343, 'support': 162722}, 'weighted avg': {'precision': 0.7278450144801221, 'recall': 0.5538894556359927, 'f1-score': 0.58976661884221, 'support': 162722}}
[[12396  4831  4769]
 [21992 61817 35250]
 [ 2180  3570 15917]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
3755/3755 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0221462
{'0': {'precision': 0.5496093932731441, 'recall': 0.23067861279998952, 'f1-score': 0.32496496533412006, 'support': 305594}, '1': {'precision': 0.4496358140033086, 'recall': 0.8314800244295641, 'f1-score': 0.5836524479616251, 'support': 363494}, '2': {'precision': 0.5200881051786681, 'recall': 0.2861833433193529, 'f1-score': 0.3692070531281471, 'support': 292075}, 'accuracy': 0.47475714316926476, 'macro avg': {'precision': 0.5064444374850402, 'recall': 0.4494473268496355, 'f1-score': 0.42594148880796406, 'support': 961163}, 'weighted avg': {'precision': 0.5028304115153115, 'recall': 0.47475714316926476, 'f1-score': 0.4362399057996215, 'support': 961163}}
[[ 70494 192271  42829]
 [ 26955 302238  34301]
 [ 30813 177675  83587]]
Evaluating performance on  train set...
1532/1532 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0022557
{'0': {'precision': 0.5020453171130793, 'recall': 0.43045580005184747, 'f1-score': 0.4635025409883172, 'support': 131154}, '1': {'precision': 0.5167800947790776, 'recall': 0.4889734246931121, 'f1-score': 0.5024923659028645, 'support': 130911}, '2': {'precision': 0.4663548523694037, 'recall': 0.558632297334686, 'f1-score': 0.5083398023624195, 'support': 130116}, 'accuracy': 0.4925149357057073, 'macro avg': {'precision': 0.4950600880871869, 'recall': 0.49268717402654855, 'f1-score': 0.49144490308453376, 'support': 392181}, 'weighted avg': {'precision': 0.4951226053255256, 'recall': 0.4925149357057073, 'f1-score': 0.4913933415889098, 'support': 392181}}
[[56456 30824 43874]
 [27598 64012 39301]
 [28398 29031 72687]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0276937
{'0': {'precision': 0.5088458836303251, 'recall': 0.40014062931618993, 'f1-score': 0.4479932522668166, 'support': 39821}, '1': {'precision': 0.462457016345565, 'recall': 0.4921669382128086, 'f1-score': 0.47684965939310037, 'support': 39895}, '2': {'precision': 0.46026177895683057, 'recall': 0.5292308467996067, 'f1-score': 0.4923426909636717, 'support': 39667}, 'accuracy': 0.4737860499401087, 'macro avg': {'precision': 0.4771882263109069, 'recall': 0.4738461381095351, 'f1-score': 0.4723952008745296, 'support': 119383}, 'weighted avg': {'precision': 0.4772009296552281, 'recall': 0.4737860499401087, 'f1-score': 0.4723722304051717, 'support': 119383}}
[[15934 11222 12665]
 [ 8307 19635 11953]
 [ 7073 11601 20993]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
4960/4960 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9607471
{'0': {'precision': 0.4628266349990691, 'recall': 0.5139569905090788, 'f1-score': 0.48705358738547205, 'support': 357921}, '1': {'precision': 0.6910166785930534, 'recall': 0.45075231907448865, 'f1-score': 0.5456048833542855, 'support': 557011}, '2': {'precision': 0.4399129064333691, 'recall': 0.6310451362657435, 'f1-score': 0.5184234842397055, 'support': 354748}, 'accuracy': 0.5189433558061873, 'macro avg': {'precision': 0.5312520733418306, 'recall': 0.531918148616437, 'f1-score': 0.5170273183264876, 'support': 1269680}, 'weighted avg': {'precision': 0.5565319505046327, 'recall': 0.5189433558061873, 'f1-score': 0.5215048854197251, 'support': 1269680}}
[[183956  58579 115386]
 [136307 251074 169630]
 [ 77199  53687 223862]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9660663
{'0': {'precision': 0.5147040113415365, 'recall': 0.41451615264136304, 'f1-score': 0.4592089900758902, 'support': 136634}, '1': {'precision': 0.5717246604592332, 'recall': 0.5614381375786308, 'f1-score': 0.5665347099848601, 'support': 162627}, '2': {'precision': 0.47523987615339813, 'recall': 0.5802684473323702, 'f1-score': 0.5225287170360784, 'support': 133583}, 'accuracy': 0.520871260777555, 'macro avg': {'precision': 0.5205561826513893, 'recall': 0.5187409125174547, 'f1-score': 0.516090805698943, 'support': 432844}, 'weighted avg': {'precision': 0.5239483569561842, 'recall': 0.520871260777555, 'f1-score': 0.5190746667126436, 'support': 432844}}
[[56637 35645 44352]
 [30083 91305 41239]
 [23318 32751 77514]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0036526
{'0': {'precision': 0.5152667967845447, 'recall': 0.3190626408292023, 'f1-score': 0.3940946525484838, 'support': 48818}, '1': {'precision': 0.4841014805358689, 'recall': 0.6353412417193036, 'f1-score': 0.5495049092680653, 'support': 51928}, '2': {'precision': 0.4922280774917542, 'recall': 0.5153409541954433, 'f1-score': 0.5035194198289737, 'support': 50388}, 'accuracy': 0.49317162253364566, 'macro avg': {'precision': 0.4971987849373893, 'recall': 0.4899149455813164, 'f1-score': 0.4823729938818409, 'support': 151134}, 'weighted avg': {'precision': 0.496877635312696, 'recall': 0.49317162253364566, 'f1-score': 0.4839740905615302, 'support': 151134}}
[[15576 17539 15703]
 [ 7852 32992 11084]
 [ 6801 17620 25967]]
testing model on single stock: results/universal/W8/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
10609/10609 - 149s - 149s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.126826
{'0': {'precision': 0.4206877488271798, 'recall': 0.34806982554452975, 'f1-score': 0.3809489915274545, 'support': 922585}, '1': {'precision': 0.3331800843479973, 'recall': 0.43692839462284105, 'f1-score': 0.37806580072723944, 'support': 832633}, '2': {'precision': 0.42490871013404674, 'recall': 0.38066080561062154, 'f1-score': 0.4015695448978807, 'support': 960464}, 'accuracy': 0.38684058000899957, 'macro avg': {'precision': 0.39292551443640794, 'recall': 0.3885530085926641, 'f1-score': 0.38686144571752484, 'support': 2715682}, 'weighted avg': {'precision': 0.39535058202427115, 'recall': 0.38684058000899957, 'f1-score': 0.3873579375553096, 'support': 2715682}}
[[321124 353839 247622]
 [221619 363801 247213]
 [220588 374265 365611]]
Evaluating performance on  train set...
3903/3903 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1060454
{'0': {'precision': 0.40772095428266525, 'recall': 0.4430801603266311, 'f1-score': 0.4246657948374916, 'support': 334567}, '1': {'precision': 0.38598779382921317, 'recall': 0.35432984508522597, 'f1-score': 0.36948193046660566, 'support': 328245}, '2': {'precision': 0.41422919696670435, 'recall': 0.41165082036930745, 'f1-score': 0.412935983854632, 'support': 336251}, 'accuracy': 0.40334293232759094, 'macro avg': {'precision': 0.4026459816928609, 'recall': 0.4030202752603882, 'f1-score': 0.40236123638624305, 'support': 999063}, 'weighted avg': {'precision': 0.4027709179563349, 'recall': 0.40334293232759094, 'f1-score': 0.40258711888490506, 'support': 999063}}
[[148240  90474  95853]
 [112051 116307  99887]
 [103291  94542 138418]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1085933
{'0': {'precision': 0.41621772481626507, 'recall': 0.491825231851615, 'f1-score': 0.45087377751311236, 'support': 100064}, '1': {'precision': 0.38603129154310256, 'recall': 0.24105489453183201, 'f1-score': 0.2967845069315233, 'support': 93962}, '2': {'precision': 0.401337734838141, 'recall': 0.4709807620148671, 'f1-score': 0.43337921381080136, 'support': 98607}, 'accuracy': 0.4042811302894752, 'macro avg': {'precision': 0.4011955837325029, 'recall': 0.40128696279943804, 'f1-score': 0.3936791660851457, 'support': 292633}, 'weighted avg': {'precision': 0.401511082657022, 'recall': 0.4042811302894752, 'f1-score': 0.3955019551780338, 'support': 292633}}
[[49214 17436 33414]
 [35450 22650 35862]
 [33577 18588 46442]]
training model: results/universal/W8/deepOF_L2/h10
Epoch 1/50
7695/7695 - 178s - loss: 2.7810 - accuracy10: 0.5425 - val_loss: 2.9235 - val_accuracy10: 0.5587 - 178s/epoch - 23ms/step
Epoch 2/50
7695/7695 - 173s - loss: 2.6764 - accuracy10: 0.5653 - val_loss: 2.8452 - val_accuracy10: 0.5654 - 173s/epoch - 22ms/step
Epoch 3/50
7695/7695 - 173s - loss: 2.6479 - accuracy10: 0.5706 - val_loss: 2.8343 - val_accuracy10: 0.5670 - 173s/epoch - 22ms/step
Epoch 4/50
7695/7695 - 173s - loss: 2.6335 - accuracy10: 0.5737 - val_loss: 2.8338 - val_accuracy10: 0.5647 - 173s/epoch - 22ms/step
Epoch 5/50
7695/7695 - 172s - loss: 2.6228 - accuracy10: 0.5757 - val_loss: 2.8153 - val_accuracy10: 0.5657 - 172s/epoch - 22ms/step
Epoch 6/50
7695/7695 - 172s - loss: 2.6148 - accuracy10: 0.5774 - val_loss: 2.8226 - val_accuracy10: 0.5667 - 172s/epoch - 22ms/step
Epoch 7/50
7695/7695 - 173s - loss: 2.6084 - accuracy10: 0.5786 - val_loss: 2.8190 - val_accuracy10: 0.5639 - 173s/epoch - 23ms/step
Epoch 8/50
7695/7695 - 174s - loss: 2.6029 - accuracy10: 0.5796 - val_loss: 2.8096 - val_accuracy10: 0.5651 - 174s/epoch - 23ms/step
Epoch 9/50
7695/7695 - 174s - loss: 2.5984 - accuracy10: 0.5806 - val_loss: 2.8014 - val_accuracy10: 0.5644 - 174s/epoch - 23ms/step
Epoch 10/50
7695/7695 - 171s - loss: 2.5944 - accuracy10: 0.5813 - val_loss: 2.8012 - val_accuracy10: 0.5650 - 171s/epoch - 22ms/step
Epoch 11/50
7695/7695 - 173s - loss: 2.5904 - accuracy10: 0.5822 - val_loss: 2.7979 - val_accuracy10: 0.5669 - 173s/epoch - 22ms/step
Epoch 12/50
7695/7695 - 172s - loss: 2.5874 - accuracy10: 0.5826 - val_loss: 2.7921 - val_accuracy10: 0.5651 - 172s/epoch - 22ms/step
Epoch 13/50
7695/7695 - 171s - loss: 2.5844 - accuracy10: 0.5833 - val_loss: 2.7895 - val_accuracy10: 0.5638 - 171s/epoch - 22ms/step
Epoch 14/50
7695/7695 - 172s - loss: 2.5812 - accuracy10: 0.5841 - val_loss: 2.7780 - val_accuracy10: 0.5646 - 172s/epoch - 22ms/step
Epoch 15/50
7695/7695 - 171s - loss: 2.5789 - accuracy10: 0.5846 - val_loss: 2.7840 - val_accuracy10: 0.5646 - 171s/epoch - 22ms/step
Epoch 16/50
7695/7695 - 172s - loss: 2.5760 - accuracy10: 0.5852 - val_loss: 2.7810 - val_accuracy10: 0.5660 - 172s/epoch - 22ms/step
Epoch 17/50
7695/7695 - 172s - loss: 2.5736 - accuracy10: 0.5855 - val_loss: 2.7705 - val_accuracy10: 0.5665 - 172s/epoch - 22ms/step
Epoch 18/50
7695/7695 - 172s - loss: 2.5714 - accuracy10: 0.5859 - val_loss: 2.7530 - val_accuracy10: 0.5671 - 172s/epoch - 22ms/step
Epoch 19/50
7695/7695 - 170s - loss: 2.5692 - accuracy10: 0.5863 - val_loss: 2.7611 - val_accuracy10: 0.5689 - 170s/epoch - 22ms/step
Epoch 20/50
7695/7695 - 170s - loss: 2.5668 - accuracy10: 0.5873 - val_loss: 2.7618 - val_accuracy10: 0.5671 - 170s/epoch - 22ms/step
Epoch 21/50
7695/7695 - 170s - loss: 2.5652 - accuracy10: 0.5873 - val_loss: 2.7492 - val_accuracy10: 0.5651 - 170s/epoch - 22ms/step
Epoch 22/50
7695/7695 - 171s - loss: 2.5632 - accuracy10: 0.5876 - val_loss: 2.7643 - val_accuracy10: 0.5686 - 171s/epoch - 22ms/step
Epoch 23/50
7695/7695 - 171s - loss: 2.5614 - accuracy10: 0.5877 - val_loss: 2.7540 - val_accuracy10: 0.5668 - 171s/epoch - 22ms/step
Epoch 24/50
7695/7695 - 170s - loss: 2.5597 - accuracy10: 0.5883 - val_loss: 2.7564 - val_accuracy10: 0.5655 - 170s/epoch - 22ms/step
Epoch 25/50
7695/7695 - 170s - loss: 2.5581 - accuracy10: 0.5885 - val_loss: 2.7635 - val_accuracy10: 0.5665 - 170s/epoch - 22ms/step
Epoch 26/50
7695/7695 - 169s - loss: 2.5563 - accuracy10: 0.5888 - val_loss: 2.7547 - val_accuracy10: 0.5683 - 169s/epoch - 22ms/step
Epoch 27/50
7695/7695 - 171s - loss: 2.5547 - accuracy10: 0.5892 - val_loss: 2.7699 - val_accuracy10: 0.5669 - 171s/epoch - 22ms/step
Epoch 28/50
7695/7695 - 171s - loss: 2.5531 - accuracy10: 0.5894 - val_loss: 2.7475 - val_accuracy10: 0.5681 - 171s/epoch - 22ms/step
Epoch 29/50
7695/7695 - 172s - loss: 2.5520 - accuracy10: 0.5898 - val_loss: 2.7582 - val_accuracy10: 0.5649 - 172s/epoch - 22ms/step
Epoch 30/50
7695/7695 - 171s - loss: 2.5501 - accuracy10: 0.5900 - val_loss: 2.7595 - val_accuracy10: 0.5688 - 171s/epoch - 22ms/step
Epoch 31/50
7695/7695 - 173s - loss: 2.5487 - accuracy10: 0.5903 - val_loss: 2.7493 - val_accuracy10: 0.5686 - 173s/epoch - 23ms/step
Epoch 32/50
7695/7695 - 174s - loss: 2.5474 - accuracy10: 0.5904 - val_loss: 2.7570 - val_accuracy10: 0.5671 - 174s/epoch - 23ms/step
Epoch 33/50
7695/7695 - 170s - loss: 2.5461 - accuracy10: 0.5908 - val_loss: 2.7539 - val_accuracy10: 0.5686 - 170s/epoch - 22ms/step
Epoch 34/50
7695/7695 - 170s - loss: 2.5446 - accuracy10: 0.5911 - val_loss: 2.7568 - val_accuracy10: 0.5666 - 170s/epoch - 22ms/step
Epoch 35/50
7695/7695 - 170s - loss: 2.5437 - accuracy10: 0.5912 - val_loss: 2.7469 - val_accuracy10: 0.5640 - 170s/epoch - 22ms/step
Epoch 36/50
7695/7695 - 170s - loss: 2.5424 - accuracy10: 0.5914 - val_loss: 2.7692 - val_accuracy10: 0.5671 - 170s/epoch - 22ms/step
Epoch 37/50
7695/7695 - 171s - loss: 2.5407 - accuracy10: 0.5916 - val_loss: 2.7702 - val_accuracy10: 0.5655 - 171s/epoch - 22ms/step
Epoch 38/50
7695/7695 - 173s - loss: 2.5397 - accuracy10: 0.5919 - val_loss: 2.7649 - val_accuracy10: 0.5658 - 173s/epoch - 22ms/step
Epoch 39/50
7695/7695 - 177s - loss: 2.5388 - accuracy10: 0.5921 - val_loss: 2.7683 - val_accuracy10: 0.5660 - 177s/epoch - 23ms/step
Epoch 40/50
7695/7695 - 175s - loss: 2.5374 - accuracy10: 0.5923 - val_loss: 2.7603 - val_accuracy10: 0.5670 - 175s/epoch - 23ms/step
Epoch 41/50
7695/7695 - 175s - loss: 2.5362 - accuracy10: 0.5927 - val_loss: 2.7635 - val_accuracy10: 0.5647 - 175s/epoch - 23ms/step
Epoch 42/50
7695/7695 - 178s - loss: 2.5353 - accuracy10: 0.5928 - val_loss: 2.7570 - val_accuracy10: 0.5664 - 178s/epoch - 23ms/step
Epoch 43/50
7695/7695 - 174s - loss: 2.5341 - accuracy10: 0.5932 - val_loss: 2.7651 - val_accuracy10: 0.5661 - 174s/epoch - 23ms/step
Epoch 44/50
7695/7695 - 179s - loss: 2.5335 - accuracy10: 0.5931 - val_loss: 2.7681 - val_accuracy10: 0.5654 - 179s/epoch - 23ms/step
Epoch 45/50
7695/7695 - 179s - loss: 2.5320 - accuracy10: 0.5932 - val_loss: 2.7662 - val_accuracy10: 0.5634 - 179s/epoch - 23ms/step
testing model in sample: results/universal/W8/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 189s - 189s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8739408
{'0': {'precision': 0.43096815900102375, 'recall': 0.4781461636400575, 'f1-score': 0.4533330225811714, 'support': 1383121}, '1': {'precision': 0.7897779347083522, 'recall': 0.6486962069928623, 'f1-score': 0.7123186100600477, 'support': 3172206}, '2': {'precision': 0.4097333585227298, 'recall': 0.5307793878271164, 'f1-score': 0.4624669299870324, 'support': 1405616}, 'accuracy': 0.5813180901075551, 'macro avg': {'precision': 0.5434931507440353, 'recall': 0.5525405861533454, 'f1-score': 0.5427061875427506, 'support': 5960943}, 'weighted avg': {'precision': 0.6169069522504046, 'recall': 0.5813180901075551, 'f1-score': 0.5933099357820212, 'support': 5960943}}
[[ 661334  285384  436403]
 [ 476011 2057798  638397]
 [ 397186  262358  746072]]
Evaluating performance on  train set...
7695/7695 - 65s - 65s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91338825
{'0': {'precision': 0.46270648559003597, 'recall': 0.5017099495651239, 'f1-score': 0.48141951772417524, 'support': 521068}, '1': {'precision': 0.7475422226716985, 'recall': 0.605541770236214, 'f1-score': 0.6690908224700901, 'support': 927718}, '2': {'precision': 0.436396798706251, 'recall': 0.5472830877904599, 'f1-score': 0.4855900598891169, 'support': 520683}, 'accuracy': 0.5626684146843641, 'macro avg': {'precision': 0.5488818356559951, 'recall': 0.5515116025305993, 'f1-score': 0.5453668000277941, 'support': 1969469}, 'weighted avg': {'precision': 0.5899226203137691, 'recall': 0.5626684146843641, 'f1-score': 0.5709246472298131, 'support': 1969469}}
[[261425  97236 162407]
 [160328 561772 205618]
 [143238  92484 284961]]
Evaluating performance on  val set...
2338/2338 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90784085
{'0': {'precision': 0.45124088282656055, 'recall': 0.49631120053655264, 'f1-score': 0.472704156782486, 'support': 153573}, '1': {'precision': 0.7603417073359007, 'recall': 0.609508159525864, 'f1-score': 0.6766208266468728, 'support': 290887}, '2': {'precision': 0.427753787975573, 'recall': 0.545953208669506, 'f1-score': 0.47967931599637825, 'support': 153319}, 'accuracy': 0.5641265417487065, 'macro avg': {'precision': 0.5464454593793447, 'recall': 0.5505908562439742, 'f1-score': 0.5430014331419124, 'support': 597779}, 'weighted avg': {'precision': 0.5956293502093055, 'recall': 0.5641265417487065, 'f1-score': 0.5737216444867322, 'support': 597779}}
[[ 76220  28836  48517]
 [ 50126 177298  63463]
 [ 42566  27048  83705]]
testing model out of sample: results/universal/W8/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 113s - 113s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69834435
{'0': {'precision': 0.49464475644549355, 'recall': 0.39271142610861026, 'f1-score': 0.4378233938974376, 'support': 626460}, '1': {'precision': 0.8060690223791738, 'recall': 0.8347247099201284, 'f1-score': 0.8201466371256487, 'support': 2370554}, '2': {'precision': 0.4435047519226802, 'recall': 0.47560894863401393, 'f1-score': 0.4589961582519657, 'support': 619223}, 'accuracy': 0.6966595386309028, 'macro avg': {'precision': 0.5814061769157826, 'recall': 0.5676816948875842, 'f1-score': 0.572322063091684, 'support': 3616237}, 'weighted avg': {'precision': 0.6900359800532159, 'recall': 0.6966595386309028, 'f1-score': 0.6920734765633448, 'support': 3616237}}
[[ 246018  248360  132082]
 [ 154337 1978760  237457]
 [  97008  227707  294508]]
Evaluating performance on  train set...
4550/4550 - 39s - 39s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74744964
{'0': {'precision': 0.4980904219186354, 'recall': 0.4243676584069279, 'f1-score': 0.4582830819801155, 'support': 233260}, '1': {'precision': 0.7793271914556853, 'recall': 0.8143568223283758, 'f1-score': 0.79645702623449, 'support': 697731}, '2': {'precision': 0.47705816389141614, 'recall': 0.48353005764479823, 'f1-score': 0.4802723088097779, 'support': 233152}, 'accuracy': 0.6699572131602389, 'macro avg': {'precision': 0.584825259088579, 'recall': 0.5740848461267006, 'f1-score': 0.578337472341461, 'support': 1164143}, 'weighted avg': {'precision': 0.6624378426584355, 'recall': 0.6699572131602389, 'f1-score': 0.6653721393487879, 'support': 1164143}}
[[ 98988  83647  50625]
 [ 56575 568202  72954]
 [ 43172  77244 112736]]
Evaluating performance on  val set...
1570/1570 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7373334
{'0': {'precision': 0.5035339922132375, 'recall': 0.4316338057095913, 'f1-score': 0.464819883331951, 'support': 77904}, '1': {'precision': 0.7926099762545638, 'recall': 0.8161471769584953, 'f1-score': 0.8042063940568295, 'support': 244984}, '2': {'precision': 0.4609098670569582, 'recall': 0.48361295606659754, 'f1-score': 0.4719885593670183, 'support': 78141}, 'accuracy': 0.6766568003810198, 'macro avg': {'precision': 0.5856846118415865, 'recall': 0.5771313129115614, 'f1-score': 0.5803382789185997, 'support': 401029}, 'weighted avg': {'precision': 0.6718218195537625, 'recall': 0.6766568003810198, 'f1-score': 0.6735440216298791, 'support': 401029}}
[[ 33626  26370  17908]
 [ 18749 199943  26292]
 [ 14405  25946  37790]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98070985
{'0': {'precision': 0.48972492560122255, 'recall': 0.507871963298926, 'f1-score': 0.49863339031805665, 'support': 47955}, '1': {'precision': 0.6363445157219476, 'recall': 0.5176366591576607, 'f1-score': 0.570884961318322, 'support': 70138}, '2': {'precision': 0.4451344331102816, 'recall': 0.5526203391278349, 'f1-score': 0.49308777713202295, 'support': 46826}, 'accuracy': 0.5247303221581504, 'macro avg': {'precision': 0.5237346248111506, 'recall': 0.5260429871948071, 'f1-score': 0.5208687095894672, 'support': 164919}, 'weighted avg': {'precision': 0.5394196873358111, 'recall': 0.5247303221581504, 'f1-score': 0.5277865006556611, 'support': 164919}}
[[24355 10940 12660]
 [14236 36306 19596]
 [11141  9808 25877]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9843927
{'0': {'precision': 0.48976235040553573, 'recall': 0.5066893557094237, 'f1-score': 0.4980820811582499, 'support': 17042}, '1': {'precision': 0.5928294022923178, 'recall': 0.5473348200620928, 'f1-score': 0.5691744537662279, 'support': 22869}, '2': {'precision': 0.47232332011516104, 'recall': 0.5042625993156643, 'f1-score': 0.48777067205205876, 'support': 17243}, 'accuracy': 0.5222206669699408, 'macro avg': {'precision': 0.5183050242710049, 'recall': 0.5194289250290604, 'f1-score': 0.5183424023255122, 'support': 57154}, 'weighted avg': {'precision': 0.5257412706963621, 'recall': 0.5222206669699408, 'f1-score': 0.5234173480154042, 'support': 57154}}
[[ 8635  4221  4186]
 [ 4824 12517  5528]
 [ 4172  4376  8695]]
Evaluating performance on  val set...
68/68 - 1s - 838ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0180806
{'0': {'precision': 0.4875842497339482, 'recall': 0.5228223659186002, 'f1-score': 0.5045888399412629, 'support': 5258}, '1': {'precision': 0.5281399570886285, 'recall': 0.48684010345352197, 'f1-score': 0.506649778340722, 'support': 6573}, '2': {'precision': 0.4674972914409534, 'recall': 0.47908956328645447, 'f1-score': 0.4732224456223725, 'support': 5404}, 'accuracy': 0.49538729329852044, 'macro avg': {'precision': 0.49440716608784335, 'recall': 0.49625067755285884, 'f1-score': 0.4948203546347858, 'support': 17235}, 'weighted avg': {'precision': 0.4967529611831486, 'recall': 0.49538729329852044, 'f1-score': 0.49553995994128386, 'support': 17235}}
[[2749 1354 1155]
 [1579 3200 1794]
 [1310 1505 2589]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47089726
{'0': {'precision': 0.5991178071205568, 'recall': 0.4208736594297672, 'f1-score': 0.49442159504562, 'support': 49699}, '1': {'precision': 0.9064828646179617, 'recall': 0.9146171471385135, 'f1-score': 0.9105318392339848, 'support': 459132}, '2': {'precision': 0.4376782419057205, 'recall': 0.5330581889506375, 'f1-score': 0.4806824253366988, 'support': 48944}, 'accuracy': 0.8371422168437094, 'macro avg': {'precision': 0.647759637881413, 'recall': 0.6228496651729727, 'f1-score': 0.6285452865387678, 'support': 557775}, 'weighted avg': {'precision': 0.8379589805310244, 'recall': 0.8371422168437094, 'f1-score': 0.8357367825539503, 'support': 557775}}
[[ 20917  24174   4608]
 [ 10290 419930  28912]
 [  3706  19148  26090]]
Evaluating performance on  train set...
614/614 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5199327
{'0': {'precision': 0.604275949769512, 'recall': 0.42309404563160824, 'f1-score': 0.4977088242995548, 'support': 17970}, '1': {'precision': 0.8794713516935739, 'recall': 0.9194708057883719, 'f1-score': 0.89902638508553, 'support': 120863}, '2': {'precision': 0.5146621100209459, 'recall': 0.5115884061147334, 'f1-score': 0.5131206550710302, 'support': 18251}, 'accuracy': 0.8152962746046701, 'macro avg': {'precision': 0.6661364704946773, 'recall': 0.6180510858449045, 'f1-score': 0.6366186214853716, 'support': 157084}, 'weighted avg': {'precision': 0.8056038996147975, 'recall': 0.8152962746046701, 'f1-score': 0.8082797651508542, 'support': 157084}}
[[  7603   8203   2164]
 [  3092 111130   6641]
 [  1887   7027   9337]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.52978325
{'0': {'precision': 0.5268482490272374, 'recall': 0.4001970443349754, 'f1-score': 0.45487122060470325, 'support': 5075}, '1': {'precision': 0.8878404296125815, 'recall': 0.9078049418224604, 'f1-score': 0.8977117000646413, 'support': 38245}, '2': {'precision': 0.4642857142857143, 'recall': 0.4961832061068702, 'f1-score': 0.47970479704797053, 'support': 5240}, 'accuracy': 0.810337726523888, 'macro avg': {'precision': 0.6263247976418445, 'recall': 0.601395064088102, 'f1-score': 0.6107625725724383, 'support': 48560}, 'weighted avg': {'precision': 0.8044083450824454, 'recall': 0.810337726523888, 'f1-score': 0.8063243111629415, 'support': 48560}}
[[ 2031  2389   655]
 [ 1181 34719  2345]
 [  643  1997  2600]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9717889
{'0': {'precision': 0.47246019967620073, 'recall': 0.3684196683368183, 'f1-score': 0.4140035614798614, 'support': 76041}, '1': {'precision': 0.6328229585006694, 'recall': 0.7225846514992289, 'f1-score': 0.6747315767674517, 'support': 146542}, '2': {'precision': 0.436047660727899, 'recall': 0.41251419031719533, 'f1-score': 0.4239545944313666, 'support': 74875}, 'accuracy': 0.553997539148384, 'macro avg': {'precision': 0.5137769396349231, 'recall': 0.5011728367177476, 'f1-score': 0.5042299108928932, 'support': 297458}, 'weighted avg': {'precision': 0.5422969179688713, 'recall': 0.553997539148384, 'f1-score': 0.5449554552212232, 'support': 297458}}
[[ 28015  30878  17148]
 [ 17854 105889  22799]
 [ 13427  30561  30887]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1074898
{'0': {'precision': 0.4675263774912075, 'recall': 0.4309022150189087, 'f1-score': 0.4484678099522069, 'support': 27765}, '1': {'precision': 0.47820889405014005, 'recall': 0.5047406179025921, 'f1-score': 0.49111668449760604, 'support': 27739}, '2': {'precision': 0.45768614613080727, 'recall': 0.4680532801481587, 'f1-score': 0.4628116636145936, 'support': 28078}, 'accuracy': 0.46788782273695295, 'macro avg': {'precision': 0.46780713922405165, 'recall': 0.4678987043565532, 'f1-score': 0.4674653860214688, 'support': 83582}, 'weighted avg': {'precision': 0.4677660021794288, 'recall': 0.46788782273695295, 'f1-score': 0.46744060139231747, 'support': 83582}}
[[11964  7573  8228]
 [ 6394 14001  7344]
 [ 7232  7704 13142]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0706917
{'0': {'precision': 0.4700378967314069, 'recall': 0.40520673813169983, 'f1-score': 0.43522122923405887, 'support': 9795}, '1': {'precision': 0.53203279186276, 'recall': 0.5836455991339828, 'f1-score': 0.5566453559941229, 'support': 12009}, '2': {'precision': 0.45989777865146453, 'recall': 0.4684621545855026, 'f1-score': 0.4641404622557286, 'support': 9988}, 'accuracy': 0.4924823855057876, 'macro avg': {'precision': 0.4873228224152104, 'recall': 0.4857714972837284, 'f1-score': 0.4853356824946368, 'support': 31792}, 'weighted avg': {'precision': 0.4902699424111362, 'recall': 0.4924823855057876, 'f1-score': 0.49017302961409304, 'support': 31792}}
[[3969 3102 2724]
 [2229 7009 2771]
 [2246 3063 4679]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3124092
{'0': {'precision': 0.36313305837327686, 'recall': 0.4771693064859481, 'f1-score': 0.4124133332770677, 'support': 102406}, '1': {'precision': 0.4669879518072289, 'recall': 0.008929147353968356, 'f1-score': 0.017523237730116818, 'support': 108521}, '2': {'precision': 0.3436628342064086, 'recall': 0.5937062320643285, 'f1-score': 0.43533496834704427, 'support': 102101}, 'accuracy': 0.3528502242610885, 'macro avg': {'precision': 0.3912612814623048, 'recall': 0.359934895301415, 'f1-score': 0.28842384645140956, 'support': 313028}, 'weighted avg': {'precision': 0.39278697921321604, 'recall': 0.3528502242610885, 'f1-score': 0.2829886613736885, 'support': 313028}}
[[48865   737 52804]
 [44586   969 62966]
 [41114   369 60618]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3137751
{'0': {'precision': 0.38205227243465945, 'recall': 0.472140015910899, 'f1-score': 0.4223455735838315, 'support': 31425}, '1': {'precision': 0.4580335731414868, 'recall': 0.006323037706491873, 'f1-score': 0.012473876698014629, 'support': 30207}, '2': {'precision': 0.34538483657624847, 'recall': 0.604901796206144, 'f1-score': 0.4397071384990848, 'support': 29785}, 'accuracy': 0.36147543673496174, 'macro avg': {'precision': 0.3951568940507982, 'recall': 0.361121616607845, 'f1-score': 0.29150886292697703, 'support': 91417}, 'weighted avg': {'precision': 0.39521205205342147, 'recall': 0.36147543673496174, 'f1-score': 0.292567959607995, 'support': 91417}}
[[14837   135 16453]
 [12321   191 17695]
 [11677    91 18017]]
Evaluating performance on  val set...
99/99 - 1s - 972ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3131882
{'0': {'precision': 0.3623255384046585, 'recall': 0.4603640634174985, 'f1-score': 0.4055032585083273, 'support': 8515}, '1': {'precision': 0.3484848484848485, 'recall': 0.0028224322002699718, 'f1-score': 0.005599513085818624, 'support': 8149}, '2': {'precision': 0.3579181742276649, 'recall': 0.5986267892470616, 'f1-score': 0.44798606575223165, 'support': 8593}, 'accuracy': 0.35978144672763984, 'macro avg': {'precision': 0.356242853705724, 'recall': 0.35393776162161, 'f1-score': 0.2863629457821259, 'support': 25257}, 'weighted avg': {'precision': 0.3563604490223313, 'recall': 0.35978144672763984, 'f1-score': 0.2909306307694369, 'support': 25257}}
[[3920   28 4567]
 [3465   23 4661]
 [3434   15 5144]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1123875
{'0': {'precision': 0.455984147235267, 'recall': 0.4118401804467037, 'f1-score': 0.43278941944349025, 'support': 122363}, '1': {'precision': 0.5110604456748907, 'recall': 0.30323380680903145, 'f1-score': 0.38062605496427016, 'support': 124188}, '2': {'precision': 0.39781272468766726, 'recall': 0.6000684981774592, 'f1-score': 0.47844348363187156, 'support': 122631}, 'accuracy': 0.4378301217285783, 'macro avg': {'precision': 0.45495243919927497, 'recall': 0.43838082847773147, 'f1-score': 0.43061965267987734, 'support': 369182}, 'weighted avg': {'precision': 0.45518832195718, 'recall': 0.4378301217285783, 'f1-score': 0.4304072329813659, 'support': 369182}}
[[50394 18503 53466]
 [28604 37658 57926]
 [31519 17525 73587]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0744935
{'0': {'precision': 0.4508064897592356, 'recall': 0.4518002322880372, 'f1-score': 0.4513028139834973, 'support': 42189}, '1': {'precision': 0.5476457818699004, 'recall': 0.3516715937222102, 'f1-score': 0.4283058909623125, 'support': 41607}, '2': {'precision': 0.4250728761193248, 'recall': 0.5730826253735909, 'f1-score': 0.48810406686576735, 'support': 42493}, 'accuracy': 0.4596203944919985, 'macro avg': {'precision': 0.47450838258282024, 'recall': 0.45885148379461277, 'f1-score': 0.4559042572705257, 'support': 126289}, 'weighted avg': {'precision': 0.4740523305090055, 'recall': 0.4596203944919985, 'f1-score': 0.4561089543645587, 'support': 126289}}
[[19061  6516 16612]
 [10650 14632 16325]
 [12571  5570 24352]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.089379
{'0': {'precision': 0.4597170971709717, 'recall': 0.46070878274268107, 'f1-score': 0.46021240572571953, 'support': 12980}, '1': {'precision': 0.5104490884837706, 'recall': 0.3625453971261645, 'f1-score': 0.4239682393130828, 'support': 12666}, '2': {'precision': 0.42021803766105054, 'recall': 0.5426331786914094, 'f1-score': 0.4736437897088599, 'support': 12502}, 'accuracy': 0.45496487364999477, 'macro avg': {'precision': 0.46346140777193096, 'recall': 0.45529578618675165, 'f1-score': 0.4526081449158874, 'support': 38148}, 'weighted avg': {'precision': 0.4636164932068025, 'recall': 0.45496487364999477, 'f1-score': 0.4525803031456305, 'support': 38148}}
[[5980 2305 4695]
 [3409 4592 4665]
 [3619 2099 6784]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/EXC
Evaluating performance on  test set...
5521/5521 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48469827
{'0': {'precision': 0.49896144145332255, 'recall': 0.4731884624403971, 'f1-score': 0.4857333140757146, 'support': 127930}, '1': {'precision': 0.9110774929351677, 'recall': 0.8666259569529473, 'f1-score': 0.8882959688500636, 'support': 1152878}, '2': {'precision': 0.39211380365899856, 'recall': 0.5781338445398764, 'f1-score': 0.4672915440245722, 'support': 132497}, 'accuracy': 0.8039665889528446, 'macro avg': {'precision': 0.6007175793491629, 'recall': 0.6393160879777402, 'f1-score': 0.6137736089834501, 'support': 1413305}, 'weighted avg': {'precision': 0.825120718987508, 'recall': 0.8039665889528446, 'f1-score': 0.8123876095777299, 'support': 1413305}}
[[ 60535  52955  14440]
 [ 49451 999114 104313]
 [ 11336  44560  76601]]
Evaluating performance on  train set...
1288/1288 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50821906
{'0': {'precision': 0.46559040864171886, 'recall': 0.465770098563116, 'f1-score': 0.46568023626838423, 'support': 33684}, '1': {'precision': 0.8957543221181621, 'recall': 0.8690191592793823, 'f1-score': 0.8821842305920785, 'support': 262275}, '2': {'precision': 0.42768853405155827, 'recall': 0.5266664692469425, 'f1-score': 0.4720449086300479, 'support': 33769}, 'accuracy': 0.7927625194099379, 'macro avg': {'precision': 0.5963444216038131, 'recall': 0.620485242363147, 'f1-score': 0.6066364584968369, 'support': 329728}, 'weighted avg': {'precision': 0.8038732721049341, 'recall': 0.7927625194099379, 'f1-score': 0.7976311586414552, 'support': 329728}}
[[ 15689  14279   3716]
 [ 14270 227922  20083]
 [  3738  12246  17785]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4723919
{'0': {'precision': 0.4507177955487041, 'recall': 0.46459429933459134, 'f1-score': 0.45755086071987483, 'support': 10069}, '1': {'precision': 0.9120894021401372, 'recall': 0.8764087641962173, 'f1-score': 0.8938931678119169, 'support': 92102}, '2': {'precision': 0.41865625956535046, 'recall': 0.5596930946291561, 'f1-score': 0.47900888674867576, 'support': 9775}, 'accuracy': 0.8117127900952245, 'macro avg': {'precision': 0.593821152418064, 'recall': 0.6335653860533216, 'f1-score': 0.6101509717601558, 'support': 111946}, 'weighted avg': {'precision': 0.8275052305267016, 'recall': 0.8117127900952245, 'f1-score': 0.818419059424811, 'support': 111946}}
[[ 4678  4392   999]
 [ 4785 80719  6598]
 [  916  3388  5471]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/AAL
Evaluating performance on  test set...
5918/5918 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46506575
{'0': {'precision': 0.5231560025852319, 'recall': 0.3965508002970017, 'f1-score': 0.45113927798557024, 'support': 130639}, '1': {'precision': 0.904707005951114, 'recall': 0.9109339222631733, 'f1-score': 0.9078097862010237, 'support': 1255158}, '2': {'precision': 0.4203848024076435, 'recall': 0.4951395446031918, 'f1-score': 0.4547102221843149, 'support': 129206}, 'accuracy': 0.8311178261693212, 'macro avg': {'precision': 0.6160826036479964, 'recall': 0.6008747557211223, 'f1-score': 0.6045530954569697, 'support': 1515003}, 'weighted avg': {'precision': 0.8305006999835659, 'recall': 0.8311178261693212, 'f1-score': 0.8297887124532479, 'support': 1515003}}
[[  51805   65185   13649]
 [  37234 1143366   74558]
 [   9985   55246   63975]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49966
{'0': {'precision': 0.5240399002493765, 'recall': 0.4353609016325516, 'f1-score': 0.47560202788339667, 'support': 48268}, '1': {'precision': 0.8864900992462378, 'recall': 0.9096015370296793, 'f1-score': 0.8978971234540044, 'support': 367462}, '2': {'precision': 0.4857536862204307, 'recall': 0.47162543514532307, 'f1-score': 0.4785853138521352, 'support': 48547}, 'accuracy': 0.8145008260155037, 'macro avg': {'precision': 0.6320945619053483, 'recall': 0.6055292912691846, 'f1-score': 0.6173614883965121, 'support': 464277}, 'weighted avg': {'precision': 0.8069055046004888, 'recall': 0.8145008260155037, 'f1-score': 0.8101484947393707, 'support': 464277}}
[[ 21014  21827   5427]
 [ 14406 334244  18812]
 [  4680  20971  22896]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45409036
{'0': {'precision': 0.5251665433012583, 'recall': 0.42235285363494307, 'f1-score': 0.46818163071720215, 'support': 13439}, '1': {'precision': 0.9089440084635841, 'recall': 0.9220732442405798, 'f1-score': 0.9154615550227886, 'support': 136038}, '2': {'precision': 0.44910136592379585, 'recall': 0.4716852914527333, 'f1-score': 0.4601163732783384, 'support': 13244}, 'accuracy': 0.8441442714830907, 'macro avg': {'precision': 0.6277373058962128, 'recall': 0.6053704631094187, 'f1-score': 0.6145865196727763, 'support': 162721}, 'weighted avg': {'precision': 0.8398211459436054, 'recall': 0.8441442714830907, 'f1-score': 0.8414601262596525, 'support': 162721}}
[[  5676   6561   1202]
 [  4140 125437   6461]
 [   992   6005   6247]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/WBA
Evaluating performance on  test set...
3755/3755 - 33s - 33s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87924564
{'0': {'precision': 0.5201952697370096, 'recall': 0.3565831609992758, 'f1-score': 0.4231237154498061, 'support': 229206}, '1': {'precision': 0.6842776250869234, 'recall': 0.7278667159789366, 'f1-score': 0.7053994316387747, 'support': 511029}, '2': {'precision': 0.44415265299854106, 'recall': 0.5236394580917333, 'f1-score': 0.48063184615991844, 'support': 220923}, 'accuracy': 0.592385435068948, 'macro avg': {'precision': 0.5495418492741581, 'recall': 0.5360297783566486, 'f1-score': 0.5363849977494998, 'support': 961158}, 'weighted avg': {'precision': 0.5899562028556002, 'recall': 0.592385435068948, 'f1-score': 0.5864225130764217, 'support': 961158}}
[[ 81731  94368  53107]
 [ 47399 371961  91669]
 [ 27986  77253 115684]]
Evaluating performance on  train set...
1532/1532 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8824964
{'0': {'precision': 0.510367644650208, 'recall': 0.456009756097561, 'f1-score': 0.48165990838970957, 'support': 102500}, '1': {'precision': 0.6715945356794238, 'recall': 0.7071036796421535, 'f1-score': 0.68889182872514, 'support': 187790}, '2': {'precision': 0.48550682374897935, 'recall': 0.4902147456030151, 'f1-score': 0.4878494266570295, 'support': 101888}, 'accuracy': 0.5851297115085496, 'macro avg': {'precision': 0.5558230013595371, 'recall': 0.5511093937809098, 'f1-score': 0.5528003879239597, 'support': 392178}, 'weighted avg': {'precision': 0.5811104669053883, 'recall': 0.5851297115085496, 'f1-score': 0.5824986090741211, 'support': 392178}}
[[ 46741  33385  22374]
 [ 24448 132787  30555]
 [ 20394  31547  49947]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9243652
{'0': {'precision': 0.4969022007677981, 'recall': 0.42886198864941116, 'f1-score': 0.4603817439075926, 'support': 30483}, '1': {'precision': 0.6472937819921121, 'recall': 0.6610959702439108, 'f1-score': 0.6541220765564845, 'support': 58341}, '2': {'precision': 0.4600316521842993, 'recall': 0.5041395333616938, 'f1-score': 0.48107669248063956, 'support': 30559}, 'accuracy': 0.5616210013150951, 'macro avg': {'precision': 0.5347425449814032, 'recall': 0.5313658307516719, 'f1-score': 0.5318601709815722, 'support': 119383}, 'weighted avg': {'precision': 0.56095879296304, 'recall': 0.5616210013150951, 'f1-score': 0.5603576339464822, 'support': 119383}}
[[13073 10917  6493]
 [ 8182 38569 11590]
 [ 5054 10099 15406]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
4960/4960 - 43s - 43s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7557141
{'0': {'precision': 0.5120318689484477, 'recall': 0.3673705814913694, 'f1-score': 0.427802868512878, 'support': 249462}, '1': {'precision': 0.7347353560704522, 'recall': 0.8466653239134028, 'f1-score': 0.7867391940723962, 'support': 774528}, '2': {'precision': 0.5057626708112145, 'recall': 0.4079532735006207, 'f1-score': 0.4516229326111788, 'support': 245685}, 'accuracy': 0.6676031267844134, 'macro avg': {'precision': 0.5841766319433713, 'recall': 0.540663059635131, 'f1-score': 0.555388331732151, 'support': 1269675}, 'weighted avg': {'precision': 0.6466724962974038, 'recall': 0.6676031267844134, 'f1-score': 0.6513706845374148, 'support': 1269675}}
[[ 91645 122489  35328]
 [ 56146 655766  62616]
 [ 31192 114265 100228]]
Evaluating performance on  train set...
1691/1691 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8166533
{'0': {'precision': 0.5240496986099151, 'recall': 0.3912404587942365, 'f1-score': 0.4480097220680428, 'support': 97996}, '1': {'precision': 0.7020017900412583, 'recall': 0.810521982407353, 'f1-score': 0.7523688458748937, 'support': 238054}, '2': {'precision': 0.5145238488199373, 'recall': 0.4509200235559091, 'f1-score': 0.48062681356921433, 'support': 96791}, 'accuracy': 0.6351824341963909, 'macro avg': {'precision': 0.5801917791570369, 'recall': 0.5508941549191663, 'f1-score': 0.5603351271707169, 'support': 432841}, 'weighted avg': {'precision': 0.6197896831459807, 'recall': 0.6351824341963909, 'f1-score': 0.6226949939397138, 'support': 432841}}
[[ 38340  43368  16288]
 [ 20213 192948  24893]
 [ 14608  38538  43645]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8502279
{'0': {'precision': 0.5289975144987572, 'recall': 0.42061923583662714, 'f1-score': 0.4686238532110092, 'support': 36432}, '1': {'precision': 0.6947153760997494, 'recall': 0.7672913073695591, 'f1-score': 0.7292019594772281, 'support': 77698}, '2': {'precision': 0.4806327372764787, 'recall': 0.4721509066832419, 'f1-score': 0.47635406868158087, 'support': 37003}, 'accuracy': 0.6114614280137363, 'macro avg': {'precision': 0.5681152092916618, 'recall': 0.5533538166298094, 'f1-score': 0.558059960456606, 'support': 151133}, 'weighted avg': {'precision': 0.6023521396244275, 'recall': 0.6114614280137363, 'f1-score': 0.604480607617593, 'support': 151133}}
[[15324 12884  8224]
 [ 7426 59617 10655]
 [ 6218 13314 17471]]
testing model on single stock: results/universal/W8/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
10609/10609 - 88s - 88s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.106848
{'0': {'precision': 0.41355936570570395, 'recall': 0.5142696937794663, 'f1-score': 0.45844877606897594, 'support': 873880}, '1': {'precision': 0.5314919757321657, 'recall': 0.28246970698860147, 'f1-score': 0.368888083650396, 'support': 940646}, '2': {'precision': 0.41386081263484575, 'recall': 0.5185335199095379, 'f1-score': 0.4603217682427364, 'support': 901151}, 'accuracy': 0.43539456275543814, 'macro avg': {'precision': 0.45297071802423844, 'recall': 0.43842430689253514, 'f1-score': 0.42921954265403617, 'support': 2715677}, 'weighted avg': {'precision': 0.45450845025905623, 'recall': 0.43539456275543814, 'f1-score': 0.4280486002342242, 'support': 2715677}}
[[449410 113260 311210]
 [324361 265704 350581]
 [312917 120957 467277]]
Evaluating performance on  train set...
3903/3903 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.08467
{'0': {'precision': 0.4547050362679342, 'recall': 0.5258026343635708, 'f1-score': 0.4876761561163062, 'support': 335489}, '1': {'precision': 0.5198662277022063, 'recall': 0.2751184231879798, 'f1-score': 0.35981770635184435, 'support': 326583}, '2': {'precision': 0.4334919059516068, 'recall': 0.5637941778687795, 'f1-score': 0.4901305988197736, 'support': 336990}, 'accuracy': 0.45667135773355405, 'macro avg': {'precision': 0.4693543899739157, 'recall': 0.4549050784734434, 'f1-score': 0.4458748204293081, 'support': 999062}, 'weighted avg': {'precision': 0.46885022905564877, 'recall': 0.45667135773355405, 'f1-score': 0.44670845495983563, 'support': 999062}}
[[176401  41295 117793]
 [106235  89849 130499]
 [105310  41687 189993]]
Evaluating performance on  val set...
1144/1144 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0960402
{'0': {'precision': 0.4478718784854961, 'recall': 0.5290402389596806, 'f1-score': 0.48508405492387563, 'support': 99431}, '1': {'precision': 0.5071403767688167, 'recall': 0.2484529505582137, 'f1-score': 0.33351412300358246, 'support': 94050}, '2': {'precision': 0.42617693987885924, 'recall': 0.5549257705341294, 'f1-score': 0.4821035845403009, 'support': 99152}, 'accuracy': 0.44763235861984124, 'macro avg': {'precision': 0.460396398377724, 'recall': 0.44413965335067457, 'f1-score': 0.4335672541559196, 'support': 292633}, 'weighted avg': {'precision': 0.4595694850808597, 'recall': 0.44763235861984124, 'f1-score': 0.43536077799825285, 'support': 292633}}
[[52603 11118 35710]
 [32309 23367 38374]
 [32539 11591 55022]]
training model: results/universal/W8/deepOF_L2/h20
Epoch 1/50
7695/7695 - 180s - loss: 2.8790 - accuracy20: 0.5124 - val_loss: 2.9741 - val_accuracy20: 0.5149 - 180s/epoch - 23ms/step
Epoch 2/50
7695/7695 - 177s - loss: 2.7888 - accuracy20: 0.5328 - val_loss: 2.9793 - val_accuracy20: 0.5159 - 177s/epoch - 23ms/step
Epoch 3/50
7695/7695 - 175s - loss: 2.7625 - accuracy20: 0.5379 - val_loss: 2.9589 - val_accuracy20: 0.5181 - 175s/epoch - 23ms/step
Epoch 4/50
7695/7695 - 173s - loss: 2.7489 - accuracy20: 0.5405 - val_loss: 2.9491 - val_accuracy20: 0.5204 - 173s/epoch - 22ms/step
Epoch 5/50
7695/7695 - 173s - loss: 2.7387 - accuracy20: 0.5427 - val_loss: 2.9577 - val_accuracy20: 0.5199 - 173s/epoch - 22ms/step
Epoch 6/50
7695/7695 - 172s - loss: 2.7321 - accuracy20: 0.5441 - val_loss: 2.9458 - val_accuracy20: 0.5203 - 172s/epoch - 22ms/step
Epoch 7/50
7695/7695 - 173s - loss: 2.7257 - accuracy20: 0.5455 - val_loss: 2.9260 - val_accuracy20: 0.5209 - 173s/epoch - 22ms/step
Epoch 8/50
7695/7695 - 173s - loss: 2.7210 - accuracy20: 0.5467 - val_loss: 2.9222 - val_accuracy20: 0.5220 - 173s/epoch - 22ms/step
Epoch 9/50
7695/7695 - 172s - loss: 2.7168 - accuracy20: 0.5477 - val_loss: 2.9199 - val_accuracy20: 0.5220 - 172s/epoch - 22ms/step
Epoch 10/50
7695/7695 - 174s - loss: 2.7130 - accuracy20: 0.5485 - val_loss: 2.9166 - val_accuracy20: 0.5246 - 174s/epoch - 23ms/step
Epoch 11/50
7695/7695 - 171s - loss: 2.7100 - accuracy20: 0.5491 - val_loss: 2.9090 - val_accuracy20: 0.5253 - 171s/epoch - 22ms/step
Epoch 12/50
7695/7695 - 171s - loss: 2.7069 - accuracy20: 0.5500 - val_loss: 2.8980 - val_accuracy20: 0.5265 - 171s/epoch - 22ms/step
Epoch 13/50
7695/7695 - 172s - loss: 2.7040 - accuracy20: 0.5507 - val_loss: 2.8946 - val_accuracy20: 0.5268 - 172s/epoch - 22ms/step
Epoch 14/50
7695/7695 - 171s - loss: 2.7017 - accuracy20: 0.5510 - val_loss: 2.8974 - val_accuracy20: 0.5263 - 171s/epoch - 22ms/step
Epoch 15/50
7695/7695 - 170s - loss: 2.6986 - accuracy20: 0.5519 - val_loss: 2.8943 - val_accuracy20: 0.5261 - 170s/epoch - 22ms/step
Epoch 16/50
7695/7695 - 170s - loss: 2.6967 - accuracy20: 0.5519 - val_loss: 2.8883 - val_accuracy20: 0.5261 - 170s/epoch - 22ms/step
Epoch 17/50
7695/7695 - 169s - loss: 2.6941 - accuracy20: 0.5529 - val_loss: 2.8866 - val_accuracy20: 0.5272 - 169s/epoch - 22ms/step
Epoch 18/50
7695/7695 - 169s - loss: 2.6924 - accuracy20: 0.5533 - val_loss: 2.8926 - val_accuracy20: 0.5278 - 169s/epoch - 22ms/step
Epoch 19/50
7695/7695 - 170s - loss: 2.6903 - accuracy20: 0.5535 - val_loss: 2.8860 - val_accuracy20: 0.5270 - 170s/epoch - 22ms/step
Epoch 20/50
7695/7695 - 169s - loss: 2.6889 - accuracy20: 0.5543 - val_loss: 2.8953 - val_accuracy20: 0.5282 - 169s/epoch - 22ms/step
Epoch 21/50
7695/7695 - 169s - loss: 2.6867 - accuracy20: 0.5543 - val_loss: 2.8911 - val_accuracy20: 0.5282 - 169s/epoch - 22ms/step
Epoch 22/50
7695/7695 - 169s - loss: 2.6853 - accuracy20: 0.5547 - val_loss: 2.8908 - val_accuracy20: 0.5282 - 169s/epoch - 22ms/step
Epoch 23/50
7695/7695 - 170s - loss: 2.6833 - accuracy20: 0.5551 - val_loss: 2.8857 - val_accuracy20: 0.5294 - 170s/epoch - 22ms/step
Epoch 24/50
7695/7695 - 170s - loss: 2.6810 - accuracy20: 0.5557 - val_loss: 2.8868 - val_accuracy20: 0.5291 - 170s/epoch - 22ms/step
Epoch 25/50
7695/7695 - 170s - loss: 2.6796 - accuracy20: 0.5561 - val_loss: 2.8852 - val_accuracy20: 0.5291 - 170s/epoch - 22ms/step
Epoch 26/50
7695/7695 - 170s - loss: 2.6785 - accuracy20: 0.5563 - val_loss: 2.8889 - val_accuracy20: 0.5285 - 170s/epoch - 22ms/step
Epoch 27/50
7695/7695 - 169s - loss: 2.6769 - accuracy20: 0.5564 - val_loss: 2.8905 - val_accuracy20: 0.5290 - 169s/epoch - 22ms/step
Epoch 28/50
7695/7695 - 170s - loss: 2.6753 - accuracy20: 0.5567 - val_loss: 2.8922 - val_accuracy20: 0.5293 - 170s/epoch - 22ms/step
Epoch 29/50
7695/7695 - 172s - loss: 2.6737 - accuracy20: 0.5572 - val_loss: 2.8895 - val_accuracy20: 0.5289 - 172s/epoch - 22ms/step
Epoch 30/50
7695/7695 - 169s - loss: 2.6723 - accuracy20: 0.5574 - val_loss: 2.8867 - val_accuracy20: 0.5284 - 169s/epoch - 22ms/step
Epoch 31/50
7695/7695 - 170s - loss: 2.6710 - accuracy20: 0.5579 - val_loss: 2.8905 - val_accuracy20: 0.5293 - 170s/epoch - 22ms/step
Epoch 32/50
7695/7695 - 170s - loss: 2.6699 - accuracy20: 0.5579 - val_loss: 2.8896 - val_accuracy20: 0.5299 - 170s/epoch - 22ms/step
Epoch 33/50
7695/7695 - 170s - loss: 2.6681 - accuracy20: 0.5583 - val_loss: 2.8861 - val_accuracy20: 0.5298 - 170s/epoch - 22ms/step
Epoch 34/50
7695/7695 - 172s - loss: 2.6669 - accuracy20: 0.5587 - val_loss: 2.8826 - val_accuracy20: 0.5307 - 172s/epoch - 22ms/step
Epoch 35/50
7695/7695 - 171s - loss: 2.6659 - accuracy20: 0.5587 - val_loss: 2.8927 - val_accuracy20: 0.5298 - 171s/epoch - 22ms/step
Epoch 36/50
7695/7695 - 171s - loss: 2.6648 - accuracy20: 0.5591 - val_loss: 2.8932 - val_accuracy20: 0.5296 - 171s/epoch - 22ms/step
Epoch 37/50
7695/7695 - 171s - loss: 2.6631 - accuracy20: 0.5595 - val_loss: 2.8992 - val_accuracy20: 0.5298 - 171s/epoch - 22ms/step
Epoch 38/50
7695/7695 - 170s - loss: 2.6619 - accuracy20: 0.5597 - val_loss: 2.9014 - val_accuracy20: 0.5292 - 170s/epoch - 22ms/step
Epoch 39/50
7695/7695 - 170s - loss: 2.6602 - accuracy20: 0.5598 - val_loss: 2.8988 - val_accuracy20: 0.5289 - 170s/epoch - 22ms/step
Epoch 40/50
7695/7695 - 169s - loss: 2.6596 - accuracy20: 0.5598 - val_loss: 2.8977 - val_accuracy20: 0.5294 - 169s/epoch - 22ms/step
Epoch 41/50
7695/7695 - 170s - loss: 2.6581 - accuracy20: 0.5602 - val_loss: 2.9040 - val_accuracy20: 0.5288 - 170s/epoch - 22ms/step
Epoch 42/50
7695/7695 - 169s - loss: 2.6571 - accuracy20: 0.5605 - val_loss: 2.9009 - val_accuracy20: 0.5300 - 169s/epoch - 22ms/step
Epoch 43/50
7695/7695 - 171s - loss: 2.6558 - accuracy20: 0.5608 - val_loss: 2.9094 - val_accuracy20: 0.5287 - 171s/epoch - 22ms/step
Epoch 44/50
7695/7695 - 170s - loss: 2.6553 - accuracy20: 0.5608 - val_loss: 2.9070 - val_accuracy20: 0.5290 - 170s/epoch - 22ms/step
testing model in sample: results/universal/W8/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 180s - 180s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92202485
{'0': {'precision': 0.4168912036909592, 'recall': 0.49400541883780086, 'f1-score': 0.45218416359348146, 'support': 1532801}, '1': {'precision': 0.7319927525470045, 'recall': 0.6254948469164596, 'f1-score': 0.6745663015696217, 'support': 2876142}, '2': {'precision': 0.42899078914140665, 'recall': 0.466284793814433, 'f1-score': 0.4468610235133788, 'support': 1552000}, 'accuracy': 0.5502313979516328, 'macro avg': {'precision': 0.5259582484597901, 'recall': 0.5285950198562311, 'f1-score': 0.5245371628921606, 'support': 5960943}, 'weighted avg': {'precision': 0.5720772800464986, 'recall': 0.5502313979516328, 'f1-score': 0.5580971195936735, 'support': 5960943}}
[[ 757212  336132  439457]
 [ 553339 1799012  523791]
 [ 505779  322547  723674]]
Evaluating performance on  train set...
7695/7695 - 63s - 63s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9684434
{'0': {'precision': 0.4342341481107632, 'recall': 0.5521148562777171, 'f1-score': 0.4861304126802259, 'support': 559447}, '1': {'precision': 0.6919883115158996, 'recall': 0.5575792555986444, 'f1-score': 0.6175549650491681, 'support': 850697}, '2': {'precision': 0.45016405064528914, 'recall': 0.46091985875832475, 'f1-score': 0.455478465814027, 'support': 559325}, 'accuracy': 0.5285759765703344, 'macro avg': {'precision': 0.5254621700906507, 'recall': 0.5235379902115621, 'f1-score': 0.5197212811811404, 'support': 1969469}, 'weighted avg': {'precision': 0.550093136640861, 'recall': 0.5285759765703344, 'f1-score': 0.5341931505276687, 'support': 1969469}}
[[308879 103880 146688]
 [208169 474331 168197]
 [194271 107250 257804]]
Evaluating performance on  val set...
2338/2338 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96096593
{'0': {'precision': 0.4285872939994882, 'recall': 0.5353728489483748, 'f1-score': 0.4760653275764971, 'support': 165791}, '1': {'precision': 0.7037255512152979, 'recall': 0.566176635451155, 'f1-score': 0.6275018171501701, 'support': 267602}, '2': {'precision': 0.43894220078342827, 'recall': 0.4683063034564987, 'f1-score': 0.45314905126718447, 'support': 164386}, 'accuracy': 0.5307195468559451, 'macro avg': {'precision': 0.5237516819994048, 'recall': 0.5232852626186761, 'f1-score': 0.5189053986646172, 'support': 597779}, 'weighted avg': {'precision': 0.5546033461091305, 'recall': 0.5307195468559451, 'f1-score': 0.5375555982041227, 'support': 597779}}
[[ 88760  31692  45339]
 [ 63031 151510  53061]
 [ 55308  32095  76983]]
testing model out of sample: results/universal/W8/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 111s - 111s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78304213
{'0': {'precision': 0.48037534474699983, 'recall': 0.4169836085835618, 'f1-score': 0.4464403993156315, 'support': 744353}, '1': {'precision': 0.747742754710182, 'recall': 0.818954631317937, 'f1-score': 0.7817302785661826, 'support': 2133410}, '2': {'precision': 0.47397099399549186, 'recall': 0.4066114717647473, 'f1-score': 0.4377149237826877, 'support': 738474}, 'accuracy': 0.6520095336671794, 'macro avg': {'precision': 0.5673630311508913, 'recall': 0.5475165705554154, 'f1-score': 0.5552952005548341, 'support': 3616237}, 'weighted avg': {'precision': 0.6368017237627235, 'recall': 0.6520095336671794, 'f1-score': 0.6424638470247289, 'support': 3616237}}
[[ 310383  297550  136420]
 [ 189412 1747166  196832]
 [ 146331  291871  300272]]
Evaluating performance on  train set...
4550/4550 - 39s - 39s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8287081
{'0': {'precision': 0.488145698823208, 'recall': 0.44422588252499956, 'f1-score': 0.465151358532318, 'support': 273505}, '1': {'precision': 0.7147062833010898, 'recall': 0.7984304220751868, 'f1-score': 0.7542520611764202, 'support': 617236}, '2': {'precision': 0.5039432176656151, 'recall': 0.41602475475673184, 'f1-score': 0.45578293989653496, 'support': 273402}, 'accuracy': 0.625404267345163, 'macro avg': {'precision': 0.5689317332633043, 'recall': 0.5528936864523061, 'f1-score': 0.5583954532017578, 'support': 1164143}, 'weighted avg': {'precision': 0.6119796454838344, 'recall': 0.625404267345163, 'f1-score': 0.6162341867633641, 'support': 1164143}}
[[121498  98166  53841]
 [ 66295 492820  58121]
 [ 61104  98556 113742]]
Evaluating performance on  val set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8186094
{'0': {'precision': 0.48637389550518634, 'recall': 0.44679349324510614, 'f1-score': 0.4657442907151192, 'support': 90675}, '1': {'precision': 0.7310758300952254, 'recall': 0.8009263065581408, 'f1-score': 0.7644086785560152, 'support': 218934}, '2': {'precision': 0.4868838355953313, 'recall': 0.4147779479326187, 'f1-score': 0.4479477380523446, 'support': 91420}, 'accuracy': 0.6328270524076812, 'macro avg': {'precision': 0.5681111870652477, 'recall': 0.5541659159119553, 'f1-score': 0.5593669024411597, 'support': 401029}, 'weighted avg': {'precision': 0.6200804156585336, 'recall': 0.6328270524076812, 'f1-score': 0.6247373516736231, 'support': 401029}}
[[ 40513  31534  18628]
 [ 22250 175350  21334]
 [ 20533  32968  37919]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0098503
{'0': {'precision': 0.47288919801620904, 'recall': 0.5722467202166395, 'f1-score': 0.5178451680202667, 'support': 54653}, '1': {'precision': 0.5771197319466504, 'recall': 0.4657921539704281, 'f1-score': 0.5155140077934446, 'support': 56946}, '2': {'precision': 0.4828101927227292, 'recall': 0.47830082520630157, 'f1-score': 0.48054493037628837, 'support': 53320}, 'accuracy': 0.5051146320314821, 'macro avg': {'precision': 0.5109397075618629, 'recall': 0.5054465664644564, 'f1-score': 0.5046347020633332, 'support': 164919}, 'weighted avg': {'precision': 0.512087225065576, 'recall': 0.5051146320314821, 'f1-score': 0.5049806774433561, 'support': 164919}}
[[31275 10011 13367]
 [16469 26525 13952]
 [18392  9425 25503]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0363078
{'0': {'precision': 0.45556558751451054, 'recall': 0.5613180060390952, 'f1-score': 0.5029428517182457, 'support': 18877}, '1': {'precision': 0.5416408476886851, 'recall': 0.4599800031573962, 'f1-score': 0.4974815742295325, 'support': 19003}, '2': {'precision': 0.48893394154417974, 'recall': 0.45045138528587736, 'f1-score': 0.46890443142232185, 'support': 19274}, 'accuracy': 0.4902369038037583, 'macro avg': {'precision': 0.49538012558245853, 'recall': 0.4905831314941229, 'f1-score': 0.48977628579003335, 'support': 57154}, 'weighted avg': {'precision': 0.4954373344553665, 'recall': 0.4902369038037583, 'f1-score': 0.4896482937012801, 'support': 57154}}
[[10596  3624  4657]
 [ 5844  8741  4418]
 [ 6819  3773  8682]]
Evaluating performance on  val set...
68/68 - 1s - 752ms/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0555828
{'0': {'precision': 0.47666528181692286, 'recall': 0.5755852842809365, 'f1-score': 0.5214756457844102, 'support': 5980}, '1': {'precision': 0.4548053661755003, 'recall': 0.393455098934551, 'f1-score': 0.4219116596960114, 'support': 5256}, '2': {'precision': 0.4933235778306201, 'recall': 0.44957492915485914, 'f1-score': 0.47043432757718473, 'support': 5999}, 'accuracy': 0.47618218740934143, 'macro avg': {'precision': 0.47493140860768107, 'recall': 0.47287177079011555, 'f1-score': 0.47127387768586876, 'support': 17235}, 'weighted avg': {'precision': 0.4757971298688435, 'recall': 0.47618218740934143, 'f1-score': 0.47334653764366347, 'support': 17235}}
[[3442 1175 1363]
 [1781 2068 1407]
 [1998 1304 2697]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55661845
{'0': {'precision': 0.6434728917808544, 'recall': 0.3929405281552272, 'f1-score': 0.4879260979957863, 'support': 68957}, '1': {'precision': 0.8483316881420918, 'recall': 0.9158711472094713, 'f1-score': 0.8808086018952749, 'support': 421318}, '2': {'precision': 0.5235424718361977, 'recall': 0.4716148148148148, 'f1-score': 0.4962238416273723, 'support': 67500}, 'accuracy': 0.7974595491013401, 'macro avg': {'precision': 0.6717823505863812, 'recall': 0.5934754967265045, 'f1-score': 0.6216528471728112, 'support': 557775}, 'weighted avg': {'precision': 0.7837003939440196, 'recall': 0.7974595491013401, 'f1-score': 0.785695930765374, 'support': 557775}}
[[ 27096  37291   4570]
 [ 11044 385873  24401]
 [  3969  31697  31834]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61509347
{'0': {'precision': 0.611367410961432, 'recall': 0.4122355868934052, 'f1-score': 0.49243193697822474, 'support': 24110}, '1': {'precision': 0.8129600195622937, 'recall': 0.917839986748385, 'f1-score': 0.8622223374871949, 'support': 108666}, '2': {'precision': 0.5965163708521662, 'recall': 0.44520322527562944, 'f1-score': 0.5098704358068316, 'support': 24308}, 'accuracy': 0.7670991316747727, 'macro avg': {'precision': 0.6736146004586306, 'recall': 0.5917595996391399, 'f1-score': 0.6215082367574171, 'support': 157084}, 'weighted avg': {'precision': 0.7485250038623334, 'recall': 0.7670991316747727, 'f1-score': 0.7509403699900753, 'support': 157084}}
[[ 9939 11867  2304]
 [ 3912 99738  5016]
 [ 2406 11080 10822]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6153338
{'0': {'precision': 0.5625267665952891, 'recall': 0.3883796570076878, 'f1-score': 0.4595067343012069, 'support': 6764}, '1': {'precision': 0.828035135417756, 'recall': 0.9052559375803824, 'f1-score': 0.8649253833235482, 'support': 34989}, '2': {'precision': 0.5404398722951401, 'recall': 0.4476274423387689, 'f1-score': 0.48967456809963844, 'support': 6807}, 'accuracy': 0.7691103789126853, 'macro avg': {'precision': 0.6436672581027284, 'recall': 0.5804210123089464, 'f1-score': 0.6047022285747978, 'support': 48560}, 'weighted avg': {'precision': 0.7507377803355728, 'recall': 0.7691103789126853, 'f1-score': 0.7558524005966891, 'support': 48560}}
[[ 2627  3515   622]
 [ 1346 31674  1969]
 [  697  3063  3047]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
1162/1162 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0553837
{'0': {'precision': 0.40063316993464054, 'recall': 0.4095149862338035, 'f1-score': 0.4050253915198131, 'support': 76637}, '1': {'precision': 0.614054054054054, 'recall': 0.6419229019942941, 'f1-score': 0.6276792873651512, 'support': 145114}, '2': {'precision': 0.3924238379164071, 'recall': 0.3494789121217325, 'f1-score': 0.36970844482948945, 'support': 75707}, 'accuracy': 0.5076145203692622, 'macro avg': {'precision': 0.4690370206350339, 'recall': 0.46697226678327675, 'f1-score': 0.46747104123815125, 'support': 297458}, 'weighted avg': {'precision': 0.5026605293568116, 'recall': 0.5076145203692622, 'f1-score': 0.5046578013343619, 'support': 297458}}
[[31384 28441 16812]
 [27810 93152 24152]
 [19142 30107 26458]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1812016
{'0': {'precision': 0.40967500569309345, 'recall': 0.4536056480080686, 'f1-score': 0.4305225551699971, 'support': 27762}, '1': {'precision': 0.4449976103234029, 'recall': 0.4017041777522111, 'f1-score': 0.4222440572918635, 'support': 27814}, '2': {'precision': 0.4239048134126555, 'recall': 0.4198028993787046, 'f1-score': 0.42184388511149784, 'support': 28006}, 'accuracy': 0.42500777679404655, 'macro avg': {'precision': 0.426192476476384, 'recall': 0.42503757504632805, 'f1-score': 0.4248701658577862, 'support': 83582}, 'weighted avg': {'precision': 0.42619749761936326, 'recall': 0.42500777679404655, 'f1-score': 0.42485969745373353, 'support': 83582}}
[[12593  6943  8226]
 [ 8889 11173  7752]
 [ 9257  6992 11757]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1395512
{'0': {'precision': 0.4148380355276907, 'recall': 0.4451126286820915, 'f1-score': 0.42944242305044744, 'support': 9811}, '1': {'precision': 0.506285328608791, 'recall': 0.5019657047260561, 'f1-score': 0.5041162634408602, 'support': 11955}, '2': {'precision': 0.4240331491712707, 'recall': 0.39806503091960904, 'f1-score': 0.4106389546249614, 'support': 10026}, 'accuracy': 0.45165450427780574, 'macro avg': {'precision': 0.4483855044359175, 'recall': 0.4483811214425855, 'f1-score': 0.44806588037208966, 'support': 31792}, 'weighted avg': {'precision': 0.45212548514316275, 'recall': 0.45165450427780574, 'f1-score': 0.45159271832704095, 'support': 31792}}
[[4367 2872 2572]
 [3105 6001 2849]
 [3055 2980 3991]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2930032
{'0': {'precision': 0.3591062746629675, 'recall': 0.5111963190184049, 'f1-score': 0.42186202150129337, 'support': 104320}, '1': {'precision': 0.4784155214227971, 'recall': 0.027416679792822928, 'f1-score': 0.05186132922041504, 'support': 107927}, '2': {'precision': 0.33507430166539304, 'recall': 0.5264484377015509, 'f1-score': 0.40950594700565757, 'support': 100781}, 'accuracy': 0.34930741019972655, 'macro avg': {'precision': 0.3908653659170525, 'recall': 0.35502047883759297, 'f1-score': 0.294409765909122, 'support': 313028}, 'weighted avg': {'precision': 0.39250495722292883, 'recall': 0.34930741019972655, 'f1-score': 0.2903136543918239, 'support': 313028}}
[[53328  1829 49163]
 [48846  2959 56122]
 [46328  1397 53056]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2799039
{'0': {'precision': 0.3742012420124201, 'recall': 0.5295990828901698, 'f1-score': 0.43854074650282804, 'support': 31403}, '1': {'precision': 0.46053702196908053, 'recall': 0.018760979813716067, 'f1-score': 0.03605325179947768, 'support': 30169}, '2': {'precision': 0.3459032878628891, 'recall': 0.5301725582174569, 'f1-score': 0.41865879956078267, 'support': 29845}, 'accuracy': 0.3612019646236477, 'macro avg': {'precision': 0.39354718394812993, 'recall': 0.3595108736404476, 'f1-score': 0.2977509326210295, 'support': 91417}, 'weighted avg': {'precision': 0.39345490056520277, 'recall': 0.3612019646236477, 'f1-score': 0.2992228741794011, 'support': 91417}}
[[16631   335 14437]
 [14119   566 15484]
 [13694   328 15823]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2839465
{'0': {'precision': 0.35680985680985683, 'recall': 0.5005255167581455, 'f1-score': 0.416622114216282, 'support': 8563}, '1': {'precision': 0.42323651452282157, 'recall': 0.012202416557004426, 'f1-score': 0.023720930232558137, 'support': 8359}, '2': {'precision': 0.352891418025223, 'recall': 0.5505698860227954, 'f1-score': 0.4301045034912601, 'support': 8335}, 'accuracy': 0.3554262184740864, 'macro avg': {'precision': 0.3776459297859671, 'recall': 0.3544326064459818, 'f1-score': 0.29014918264670003, 'support': 25257}, 'weighted avg': {'precision': 0.3775011599952213, 'recall': 0.3554262184740864, 'f1-score': 0.29103771059300904, 'support': 25257}}
[[4286   74 4203]
 [4045  102 4212]
 [3681   65 4589]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
1443/1443 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.176853
{'0': {'precision': 0.3923379915309976, 'recall': 0.4426896586228174, 'f1-score': 0.41599573739534484, 'support': 119926}, '1': {'precision': 0.49260673789957055, 'recall': 0.2599863528341399, 'f1-score': 0.34034601365573186, 'support': 127499}, '2': {'precision': 0.38420761943640663, 'recall': 0.5256289166125973, 'f1-score': 0.44392729189715985, 'support': 121757}, 'accuracy': 0.4069456257347325, 'macro avg': {'precision': 0.42305078295565823, 'recall': 0.40943497602318485, 'f1-score': 0.4000896809827455, 'support': 369182}, 'weighted avg': {'precision': 0.4242849314634038, 'recall': 0.4069456257347325, 'f1-score': 0.3990815816521086, 'support': 369182}}
[[53090 17807 49029]
 [40805 33148 53546]
 [41422 16336 63999]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1375984
{'0': {'precision': 0.3983310152990264, 'recall': 0.47903275907385723, 'f1-score': 0.4349703301114112, 'support': 41851}, '1': {'precision': 0.5121717382242601, 'recall': 0.29437696159467164, 'f1-score': 0.37386845988832934, 'support': 41739}, '2': {'precision': 0.4118609170851854, 'recall': 0.5012763764959367, 'f1-score': 0.4521908142138843, 'support': 42699}, 'accuracy': 0.42552399654760115, 'macro avg': {'precision': 0.440787890202824, 'recall': 0.4248953657214885, 'f1-score': 0.42034320140454157, 'support': 126289}, 'weighted avg': {'precision': 0.4405303454904408, 'recall': 0.42552399654760115, 'f1-score': 0.42059826674445355, 'support': 126289}}
[[20048  6188 15615]
 [14502 12287 14950]
 [15780  5515 21404]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1512457
{'0': {'precision': 0.4019481712920419, 'recall': 0.5138627819548872, 'f1-score': 0.4510673404145612, 'support': 12768}, '1': {'precision': 0.49071765031864784, 'recall': 0.27129289215686275, 'f1-score': 0.3494130413337279, 'support': 13056}, '2': {'precision': 0.3938522626138153, 'recall': 0.4668127231418371, 'f1-score': 0.42723998366195093, 'support': 12324}, 'accuracy': 0.4156443325993499, 'macro avg': {'precision': 0.4288393614081683, 'recall': 0.417322799084529, 'f1-score': 0.40924012180341335, 'support': 38148}, 'weighted avg': {'precision': 0.4297137249153224, 'recall': 0.4156443325993499, 'f1-score': 0.4085789563991861, 'support': 38148}}
[[6561 1827 4380]
 [5040 3542 4474]
 [4722 1849 5753]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/EXC
Evaluating performance on  test set...
5521/5521 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.53164893
{'0': {'precision': 0.5731622867455216, 'recall': 0.4636245332126287, 'f1-score': 0.5126070133842974, 'support': 176740}, '1': {'precision': 0.8535861130057716, 'recall': 0.8873424329865593, 'f1-score': 0.8701370082324081, 'support': 1053520}, '2': {'precision': 0.5262247443751106, 'recall': 0.5035537709306455, 'f1-score': 0.5146397025158848, 'support': 183045}, 'accuracy': 0.7846480412932807, 'macro avg': {'precision': 0.6509910480421346, 'recall': 0.6181735790432779, 'f1-score': 0.6324612413775301, 'support': 1413305}, 'weighted avg': {'precision': 0.7761194877732592, 'recall': 0.7846480412932807, 'f1-score': 0.7793838759542827, 'support': 1413305}}
[[ 81941  80636  14163]
 [ 49864 934833  68823]
 [ 11158  79714  92173]]
Evaluating performance on  train set...
1288/1288 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56553984
{'0': {'precision': 0.5238130021913806, 'recall': 0.4738650631071169, 'f1-score': 0.49758873122159386, 'support': 45399}, '1': {'precision': 0.8403949651560265, 'recall': 0.878356983698839, 'f1-score': 0.8589567414913465, 'support': 238756}, '2': {'precision': 0.544187948973592, 'recall': 0.4670967458802361, 'f1-score': 0.5027039792183257, 'support': 45573}, 'accuracy': 0.765822132181677, 'macro avg': {'precision': 0.6361319721069997, 'recall': 0.6064395975620639, 'f1-score': 0.619749817310422, 'support': 329728}, 'weighted avg': {'precision': 0.7558660598610135, 'recall': 0.765822132181677, 'f1-score': 0.7599622568455024, 'support': 329728}}
[[ 21513  20072   3814]
 [ 15027 209713  14016]
 [  4530  19756  21287]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5292051
{'0': {'precision': 0.5075079747918774, 'recall': 0.4718605324074074, 'f1-score': 0.4890354987442366, 'support': 13824}, '1': {'precision': 0.858333907531179, 'recall': 0.8826926483613817, 'f1-score': 0.8703428761069677, 'support': 84675}, '2': {'precision': 0.5344153141905951, 'recall': 0.47750427604670187, 'f1-score': 0.5043594375932762, 'support': 13447}, 'accuracy': 0.7832883711789613, 'macro avg': {'precision': 0.6334190655045505, 'recall': 0.610685818938497, 'f1-score': 0.6212459374814935, 'support': 111946}, 'weighted avg': {'precision': 0.7761018401161849, 'recall': 0.7832883711789613, 'f1-score': 0.7792938660275006, 'support': 111946}}
[[ 6523  6334   967]
 [ 5306 74742  4627]
 [ 1024  6002  6421]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/AAL
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54477304
{'0': {'precision': 0.5680895307332089, 'recall': 0.38829915223412886, 'f1-score': 0.46129505107145347, 'support': 178705}, '1': {'precision': 0.8520640841849144, 'recall': 0.910818154927962, 'f1-score': 0.8804620295320766, 'support': 1159597}, '2': {'precision': 0.49494448720792183, 'recall': 0.42939202381423985, 'f1-score': 0.45984381770853844, 'support': 176701}, 'accuracy': 0.793032753070456, 'macro avg': {'precision': 0.6383660340420151, 'recall': 0.5761697769921102, 'f1-score': 0.6005336327706895, 'support': 1515003}, 'weighted avg': {'precision': 0.7769150168365206, 'recall': 0.793032753070456, 'f1-score': 0.7819599846296991, 'support': 1515003}}
[[  69391   94829   14485]
 [  40476 1056182   62939]
 [  12281   88546   75874]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5837174
{'0': {'precision': 0.5486517250853711, 'recall': 0.43705151254592356, 'f1-score': 0.48653399350847115, 'support': 63965}, '1': {'precision': 0.8320321024835232, 'recall': 0.9071422623013229, 'f1-score': 0.867965281730222, 'support': 336224}, '2': {'precision': 0.5548377435985197, 'recall': 0.4047091499188616, 'f1-score': 0.46802905219470387, 'support': 64088}, 'accuracy': 0.7730212782455301, 'macro avg': {'precision': 0.6451738570558047, 'recall': 0.5829676415887027, 'f1-score': 0.607509442477799, 'support': 464277}, 'weighted avg': {'precision': 0.7547264037034955, 'recall': 0.7730212782455301, 'f1-score': 0.7602077028935005, 'support': 464277}}
[[ 27956  29906   6103]
 [ 16514 305003  14707]
 [  6484  31667  25937]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54078364
{'0': {'precision': 0.5432311144353029, 'recall': 0.3999669585329589, 'f1-score': 0.46071870341590276, 'support': 18159}, '1': {'precision': 0.8599697167626625, 'recall': 0.9148275943750049, 'f1-score': 0.8865508441829235, 'support': 126649}, '2': {'precision': 0.49948710934828694, 'recall': 0.4077485624965109, 'f1-score': 0.4489795918367347, 'support': 17913}, 'accuracy': 0.8015498921466805, 'macro avg': {'precision': 0.6342293135154174, 'recall': 0.5741810384681583, 'f1-score': 0.598749713145187, 'support': 162721}, 'weighted avg': {'precision': 0.7849395656065349, 'recall': 0.8015498921466805, 'f1-score': 0.790860062492388, 'support': 162721}}
[[  7263   9536   1360]
 [  4828 115862   5959]
 [  1279   9330   7304]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/WBA
Evaluating performance on  test set...
3755/3755 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9459121
{'0': {'precision': 0.5320362645944041, 'recall': 0.38862783425910147, 'f1-score': 0.44916294990563216, 'support': 287509}, '1': {'precision': 0.5723070815383164, 'recall': 0.7290473281525397, 'f1-score': 0.6412379987668457, 'support': 399424}, '2': {'precision': 0.5043989600957373, 'recall': 0.44573251891694776, 'f1-score': 0.47325454211071427, 'support': 274225}, 'accuracy': 0.5463867543109457, 'macro avg': {'precision': 0.5362474354094859, 'recall': 0.5211358937761963, 'f1-score': 0.5212184969277307, 'support': 961158}, 'weighted avg': {'precision': 0.540886308979259, 'recall': 0.5463867543109457, 'f1-score': 0.5358561899231735, 'support': 961158}}
[[111734 114386  61389]
 [ 49515 291199  58710]
 [ 48763 103231 122231]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95270175
{'0': {'precision': 0.5201504334080289, 'recall': 0.4811708085263657, 'f1-score': 0.49990191781965393, 'support': 124461}, '1': {'precision': 0.5525118638520701, 'recall': 0.7028553585678105, 'f1-score': 0.6186809998625724, 'support': 144115}, '2': {'precision': 0.5408263439827561, 'recall': 0.4100499991909516, 'f1-score': 0.4664451766091774, 'support': 123602}, 'accuracy': 0.5402189821968596, 'macro avg': {'precision': 0.5378295470809517, 'recall': 0.5313587220950425, 'f1-score': 0.5283426980971346, 'support': 392178}, 'weighted avg': {'precision': 0.5385587873883655, 'recall': 0.5402189821968596, 'f1-score': 0.5330055781002354, 'support': 392178}}
[[ 59887  40441  24133]
 [ 23925 101292  18898]
 [ 31322  41597  50683]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9911496
{'0': {'precision': 0.5060272536687631, 'recall': 0.4607492245287521, 'f1-score': 0.4823279630323467, 'support': 37719}, '1': {'precision': 0.5190962099125365, 'recall': 0.6442188100676149, 'f1-score': 0.5749286081876066, 'support': 44221}, '2': {'precision': 0.5205079744023343, 'recall': 0.4192505942365729, 'f1-score': 0.4644241294636254, 'support': 37443}, 'accuracy': 0.5156931891475336, 'macro avg': {'precision': 0.515210479327878, 'recall': 0.5080728762776466, 'f1-score': 0.5072269002278595, 'support': 119383}, 'weighted avg': {'precision': 0.5154098620843919, 'recall': 0.5156931891475336, 'f1-score': 0.5110131182813948, 'support': 119383}}
[[17379 13140  7200]
 [ 8472 28488  7261]
 [ 8493 13252 15698]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
4960/4960 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8593975
{'0': {'precision': 0.5126738870410119, 'recall': 0.3980383675961734, 'f1-score': 0.44814127858263086, 'support': 314432}, '1': {'precision': 0.646703779525098, 'recall': 0.8350402170572476, 'f1-score': 0.7289027870832602, 'support': 644254}, '2': {'precision': 0.5609942480663382, 'recall': 0.34936927029573395, 'f1-score': 0.4305843701638519, 'support': 310989}, 'accuracy': 0.6078594916021817, 'macro avg': {'precision': 0.5734573048774827, 'recall': 0.5274826183163851, 'f1-score': 0.5358761452765809, 'support': 1269675}, 'weighted avg': {'precision': 0.5925182528096911, 'recall': 0.6078594916021817, 'f1-score': 0.5863039733709167, 'support': 1269675}}
[[125156 146655  42621]
 [ 63873 537978  42403]
 [ 55095 147244 108650]]
Evaluating performance on  train set...
1691/1691 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90611845
{'0': {'precision': 0.5364928909952607, 'recall': 0.4161420900454358, 'f1-score': 0.46871525273907283, 'support': 121050}, '1': {'precision': 0.6037617116487205, 'recall': 0.8076131687242798, 'f1-score': 0.690965831799632, 'support': 192456}, '2': {'precision': 0.5650472334682861, 'recall': 0.3859471236435245, 'f1-score': 0.4586322786228185, 'support': 119335}, 'accuracy': 0.5818787961399221, 'macro avg': {'precision': 0.5684339453707558, 'recall': 0.5365674608044134, 'f1-score': 0.5394377877205078, 'support': 432841}, 'weighted avg': {'precision': 0.5742754037579166, 'recall': 0.5818787961399221, 'f1-score': 0.5647556133507426, 'support': 432841}}
[[ 50374  51567  19109]
 [ 20682 155430  16344]
 [ 22839  50439  46057]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93943
{'0': {'precision': 0.5256970946265913, 'recall': 0.4293286621015993, 'f1-score': 0.47265077138849937, 'support': 43957}, '1': {'precision': 0.5870665094803026, 'recall': 0.7708407236608726, 'f1-score': 0.6665179505054026, 'support': 62018}, '2': {'precision': 0.5350866812614639, 'recall': 0.4005270383985119, 'f1-score': 0.4581306990881459, 'support': 45158}, 'accuracy': 0.5608636101976405, 'macro avg': {'precision': 0.5492834284561193, 'recall': 0.5335654747203279, 'f1-score': 0.5324331403273493, 'support': 151133}, 'weighted avg': {'precision': 0.553685841780787, 'recall': 0.5608636101976405, 'f1-score': 0.5478663582526041, 'support': 151133}}
[[18872 16051  9034]
 [ 7531 47806  6681]
 [ 9496 17575 18087]]
testing model on single stock: results/universal/W8/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
10609/10609 - 84s - 84s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1488706
{'0': {'precision': 0.3795218765512778, 'recall': 0.539706794001843, 'f1-score': 0.44565741215143384, 'support': 895275}, '1': {'precision': 0.4690572673751816, 'recall': 0.20587659530199015, 'f1-score': 0.28615518808262, 'support': 893953}, '2': {'precision': 0.4040906030778079, 'recall': 0.4580511177625536, 'f1-score': 0.4293821953929249, 'support': 926449}, 'accuracy': 0.4019590695064251, 'macro avg': {'precision': 0.4175565823347558, 'recall': 0.40121150235546227, 'f1-score': 0.3870649318756596, 'support': 2715677}, 'weighted avg': {'precision': 0.41737693197759634, 'recall': 0.4019590695064251, 'f1-score': 0.3875998265093666, 'support': 2715677}}
[[483186 101941 310148]
 [394255 184044 315654]
 [395703 106385 424361]]
Evaluating performance on  train set...
3903/3903 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1345419
{'0': {'precision': 0.40701596081517705, 'recall': 0.602192927315505, 'f1-score': 0.485731221335986, 'support': 334074}, '1': {'precision': 0.4906847759289943, 'recall': 0.19173472830563754, 'f1-score': 0.27572867308936405, 'support': 328991}, '2': {'precision': 0.4238217501780797, 'recall': 0.474578642071209, 'f1-score': 0.4477663910546128, 'support': 335997}, 'accuracy': 0.42411081594535677, 'macro avg': {'precision': 0.44050749564075037, 'recall': 0.4228354325641172, 'f1-score': 0.40307542849332095, 'support': 999062}, 'weighted avg': {'precision': 0.4402200882483865, 'recall': 0.42411081594535677, 'f1-score': 0.40380936120092437, 'support': 999062}}
[[201177  30915 101982]
 [151115  63079 114797]
 [141981  34559 159457]]
Evaluating performance on  val set...
1144/1144 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1429356
{'0': {'precision': 0.40508213911219854, 'recall': 0.5857906814528765, 'f1-score': 0.47895822226630463, 'support': 98921}, '1': {'precision': 0.47160127737226276, 'recall': 0.17345162440487427, 'f1-score': 0.25362263282987046, 'support': 95358}, '2': {'precision': 0.4113229296748784, 'recall': 0.4788925717306871, 'f1-score': 0.4425433960491391, 'support': 98354}, 'accuracy': 0.4154965434520372, 'macro avg': {'precision': 0.42933544871977986, 'recall': 0.4127116258628127, 'f1-score': 0.39170808371510474, 'support': 292633}, 'weighted avg': {'precision': 0.4288557350538901, 'recall': 0.4154965434520372, 'f1-score': 0.39329086774633387, 'support': 292633}}
[[57947  8738 32236]
 [43644 16540 35174]
 [41459  9794 47101]]
training model: results/universal/W8/deepOF_L2/h30
Epoch 1/50
7695/7695 - 175s - loss: 2.9453 - accuracy30: 0.4913 - val_loss: 3.0381 - val_accuracy30: 0.4918 - 175s/epoch - 23ms/step
Epoch 2/50
7695/7695 - 167s - loss: 2.8636 - accuracy30: 0.5109 - val_loss: 2.9931 - val_accuracy30: 0.4981 - 167s/epoch - 22ms/step
Epoch 3/50
7695/7695 - 169s - loss: 2.8411 - accuracy30: 0.5159 - val_loss: 2.9821 - val_accuracy30: 0.5005 - 169s/epoch - 22ms/step
Epoch 4/50
7695/7695 - 172s - loss: 2.8301 - accuracy30: 0.5188 - val_loss: 2.9689 - val_accuracy30: 0.5010 - 172s/epoch - 22ms/step
Epoch 5/50
7695/7695 - 169s - loss: 2.8224 - accuracy30: 0.5206 - val_loss: 2.9774 - val_accuracy30: 0.5006 - 169s/epoch - 22ms/step
Epoch 6/50
7695/7695 - 170s - loss: 2.8164 - accuracy30: 0.5218 - val_loss: 2.9700 - val_accuracy30: 0.5015 - 170s/epoch - 22ms/step
Epoch 7/50
7695/7695 - 170s - loss: 2.8111 - accuracy30: 0.5232 - val_loss: 2.9615 - val_accuracy30: 0.5027 - 170s/epoch - 22ms/step
Epoch 8/50
7695/7695 - 171s - loss: 2.8071 - accuracy30: 0.5242 - val_loss: 2.9691 - val_accuracy30: 0.5007 - 171s/epoch - 22ms/step
Epoch 9/50
7695/7695 - 169s - loss: 2.8036 - accuracy30: 0.5250 - val_loss: 2.9689 - val_accuracy30: 0.5031 - 169s/epoch - 22ms/step
Epoch 10/50
7695/7695 - 170s - loss: 2.8001 - accuracy30: 0.5255 - val_loss: 2.9586 - val_accuracy30: 0.5033 - 170s/epoch - 22ms/step
Epoch 11/50
7695/7695 - 170s - loss: 2.7972 - accuracy30: 0.5265 - val_loss: 2.9634 - val_accuracy30: 0.5037 - 170s/epoch - 22ms/step
Epoch 12/50
7695/7695 - 170s - loss: 2.7944 - accuracy30: 0.5269 - val_loss: 2.9629 - val_accuracy30: 0.5048 - 170s/epoch - 22ms/step
Epoch 13/50
7695/7695 - 170s - loss: 2.7918 - accuracy30: 0.5276 - val_loss: 2.9567 - val_accuracy30: 0.5045 - 170s/epoch - 22ms/step
Epoch 14/50
7695/7695 - 170s - loss: 2.7898 - accuracy30: 0.5281 - val_loss: 2.9603 - val_accuracy30: 0.5058 - 170s/epoch - 22ms/step
Epoch 15/50
7695/7695 - 170s - loss: 2.7872 - accuracy30: 0.5288 - val_loss: 2.9565 - val_accuracy30: 0.5056 - 170s/epoch - 22ms/step
Epoch 16/50
7695/7695 - 170s - loss: 2.7847 - accuracy30: 0.5294 - val_loss: 2.9701 - val_accuracy30: 0.5041 - 170s/epoch - 22ms/step
Epoch 17/50
7695/7695 - 170s - loss: 2.7827 - accuracy30: 0.5298 - val_loss: 2.9596 - val_accuracy30: 0.5047 - 170s/epoch - 22ms/step
Epoch 18/50
7695/7695 - 169s - loss: 2.7806 - accuracy30: 0.5304 - val_loss: 2.9645 - val_accuracy30: 0.5055 - 169s/epoch - 22ms/step
Epoch 19/50
7695/7695 - 169s - loss: 2.7789 - accuracy30: 0.5305 - val_loss: 2.9562 - val_accuracy30: 0.5054 - 169s/epoch - 22ms/step
Epoch 20/50
7695/7695 - 168s - loss: 2.7770 - accuracy30: 0.5314 - val_loss: 2.9625 - val_accuracy30: 0.5060 - 168s/epoch - 22ms/step
Epoch 21/50
7695/7695 - 170s - loss: 2.7748 - accuracy30: 0.5313 - val_loss: 2.9733 - val_accuracy30: 0.5038 - 170s/epoch - 22ms/step
Epoch 22/50
7695/7695 - 170s - loss: 2.7727 - accuracy30: 0.5321 - val_loss: 2.9766 - val_accuracy30: 0.5060 - 170s/epoch - 22ms/step
Epoch 23/50
7695/7695 - 169s - loss: 2.7713 - accuracy30: 0.5324 - val_loss: 2.9777 - val_accuracy30: 0.5044 - 169s/epoch - 22ms/step
Epoch 24/50
7695/7695 - 169s - loss: 2.7697 - accuracy30: 0.5327 - val_loss: 2.9788 - val_accuracy30: 0.5053 - 169s/epoch - 22ms/step
Epoch 25/50
7695/7695 - 170s - loss: 2.7676 - accuracy30: 0.5330 - val_loss: 2.9809 - val_accuracy30: 0.5056 - 170s/epoch - 22ms/step
Epoch 26/50
7695/7695 - 169s - loss: 2.7663 - accuracy30: 0.5334 - val_loss: 3.0003 - val_accuracy30: 0.5035 - 169s/epoch - 22ms/step
Epoch 27/50
7695/7695 - 169s - loss: 2.7647 - accuracy30: 0.5340 - val_loss: 2.9902 - val_accuracy30: 0.5058 - 169s/epoch - 22ms/step
Epoch 28/50
7695/7695 - 170s - loss: 2.7636 - accuracy30: 0.5341 - val_loss: 2.9984 - val_accuracy30: 0.5047 - 170s/epoch - 22ms/step
Epoch 29/50
7695/7695 - 170s - loss: 2.7616 - accuracy30: 0.5347 - val_loss: 2.9968 - val_accuracy30: 0.5045 - 170s/epoch - 22ms/step
testing model in sample: results/universal/W8/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94455576
{'0': {'precision': 0.41083910413209185, 'recall': 0.5654631874301287, 'f1-score': 0.4759066763465967, 'support': 1635148}, '1': {'precision': 0.6719509889598851, 'recall': 0.6142394979719447, 'f1-score': 0.6418004833872595, 'support': 2667580}, '2': {'precision': 0.4618461739248709, 'recall': 0.3542544241850423, 'f1-score': 0.40095804557610376, 'support': 1658215}, 'accuracy': 0.5285370116775148, 'macro avg': {'precision': 0.5148787556722826, 'recall': 0.5113190365290385, 'f1-score': 0.5062217351033199, 'support': 5960943}, 'weighted avg': {'precision': 0.5418783591569022, 'recall': 0.5285370116775149, 'f1-score': 0.5292965608015291, 'support': 5960943}}
[[ 924616  410909  299623]
 [ 644183 1638533  384864]
 [ 681756  389029  587430]]
Evaluating performance on  train set...
7695/7695 - 62s - 62s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99611044
{'0': {'precision': 0.41302487742356947, 'recall': 0.6013056467758554, 'f1-score': 0.48969085545308816, 'support': 580402}, '1': {'precision': 0.6278295925386744, 'recall': 0.5338181485433904, 'f1-score': 0.5770197260962432, 'support': 808693}, '2': {'precision': 0.46336466866718395, 'recall': 0.3488061146777767, 'f1-score': 0.3980060181212098, 'support': 580374}, 'accuracy': 0.4991863289038822, 'macro avg': {'precision': 0.5014063795431426, 'recall': 0.4946433033323408, 'f1-score': 0.48823886655684706, 'support': 1969469}, 'weighted avg': {'precision': 0.5160612671731929, 'recall': 0.4991863289038822, 'f1-score': 0.4985311827724689, 'support': 1969469}}
[[348999 126598 104805]
 [247354 431695 129644]
 [248630 129306 202438]]
Evaluating performance on  val set...
2338/2338 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98643875
{'0': {'precision': 0.41361514879435723, 'recall': 0.5902131318785963, 'f1-score': 0.4863801848632787, 'support': 173273}, '1': {'precision': 0.6456553055202026, 'recall': 0.5463744674136026, 'f1-score': 0.5918804742907328, 'support': 253480}, '2': {'precision': 0.4517063416212083, 'recall': 0.35925531790487997, 'f1-score': 0.40021104192178425, 'support': 171026}, 'accuracy': 0.5055463641245344, 'macro avg': {'precision': 0.5036589319785895, 'recall': 0.4986143057323596, 'f1-score': 0.49282390035859863, 'support': 597779}, 'weighted avg': {'precision': 0.5229065813660473, 'recall': 0.5055463641245344, 'f1-score': 0.5064629404022974, 'support': 597779}}
[[102268  37797  33208]
 [ 73613 138495  41372]
 [ 71373  38211  61442]]
testing model out of sample: results/universal/W8/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 111s - 111s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84997547
{'0': {'precision': 0.47798884951627457, 'recall': 0.38585379619066457, 'f1-score': 0.4270078886224205, 'support': 829226}, '1': {'precision': 0.6691197212926403, 'recall': 0.8293588942452269, 'f1-score': 0.7406717538905244, 'support': 1961954}, '2': {'precision': 0.497319682905188, 'recall': 0.3104573380990647, 'f1-score': 0.3822751599124846, 'support': 825057}, 'accuracy': 0.6092711843831032, 'macro avg': {'precision': 0.5481427512380342, 'recall': 0.5085566761783188, 'f1-score': 0.5166516008084766, 'support': 3616237}, 'weighted avg': {'precision': 0.5860954304202597, 'recall': 0.6092711843831032, 'f1-score': 0.5869772225369244, 'support': 3616237}}
[[ 319960  408550  100716]
 [ 176600 1627164  158190]
 [ 172828  396084  256145]]
Evaluating performance on  train set...
4550/4550 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89317167
{'0': {'precision': 0.48422960303906876, 'recall': 0.41539933427677345, 'f1-score': 0.447181379780175, 'support': 301026}, '1': {'precision': 0.6275708727070595, 'recall': 0.8099197033890781, 'f1-score': 0.7071796135998227, 'support': 563162}, '2': {'precision': 0.5269890011724638, 'recall': 0.31467720158023704, 'f1-score': 0.3940550864705207, 'support': 299955}, 'accuracy': 0.5802989838877183, 'macro avg': {'precision': 0.546263158972864, 'recall': 0.5133320797486962, 'f1-score': 0.5161386932835063, 'support': 1164143}, 'weighted avg': {'precision': 0.5645893624293391, 'recall': 0.5802989838877183, 'f1-score': 0.5592686646280357, 'support': 1164143}}
[[125046 136490  39490]
 [ 61815 456116  45231]
 [ 71376 134190  94389]]
Evaluating performance on  val set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88130766
{'0': {'precision': 0.4854985910266371, 'recall': 0.41928893340010015, 'f1-score': 0.44997124938871363, 'support': 99850}, '1': {'precision': 0.6488195515482263, 'recall': 0.8174860610771462, 'f1-score': 0.7234521029969111, 'support': 200697}, '2': {'precision': 0.502599877272874, 'recall': 0.3097470193666527, 'f1-score': 0.38328161174326386, 'support': 100482}, 'accuracy': 0.591121839068995, 'macro avg': {'precision': 0.5456393399492457, 'recall': 0.5155073379479663, 'f1-score': 0.5189016547096296, 'support': 401029}, 'weighted avg': {'precision': 0.5715183009688003, 'recall': 0.591121839068995, 'f1-score': 0.5701263471664662, 'support': 401029}}
[[ 41866  43726  14258]
 [ 20086 164067  16544]
 [ 24281  45077  31124]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0742096
{'0': {'precision': 0.414151225343694, 'recall': 0.6123846876208363, 'f1-score': 0.4941276102605247, 'support': 54309}, '1': {'precision': 0.490804573761273, 'recall': 0.40790361946305237, 'f1-score': 0.445530515011722, 'support': 57771}, '2': {'precision': 0.44492104256598, 'recall': 0.30820038229338176, 'f1-score': 0.3641506691562035, 'support': 52839}, 'accuracy': 0.4432964061145168, 'macro avg': {'precision': 0.449958947223649, 'recall': 0.44282956312575683, 'f1-score': 0.4346029314761501, 'support': 164919}, 'weighted avg': {'precision': 0.4508612888514785, 'recall': 0.4432964061145168, 'f1-score': 0.43546029854610846, 'support': 164919}}
[[33258 12237  8814]
 [22703 23565 11503]
 [24343 12211 16285]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0740929
{'0': {'precision': 0.4186162844389718, 'recall': 0.5751215901882004, 'f1-score': 0.484544806698735, 'support': 18916}, '1': {'precision': 0.4542153693111166, 'recall': 0.48409669211195927, 'f1-score': 0.4686802330057225, 'support': 18864}, '2': {'precision': 0.4756351143657897, 'recall': 0.27154949932899763, 'f1-score': 0.34572038771151636, 'support': 19374}, 'accuracy': 0.4421737761136578, 'macro avg': {'precision': 0.4494889227052927, 'recall': 0.4435892605430524, 'f1-score': 0.43298180913865797, 'support': 57154}, 'weighted avg': {'precision': 0.44969414334701524, 'recall': 0.4421737761136578, 'f1-score': 0.4322500659701183, 'support': 57154}}
[[10879  5192  2845]
 [ 6777  9132  2955]
 [ 8332  5781  5261]]
Evaluating performance on  val set...
68/68 - 1s - 759ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1059436
{'0': {'precision': 0.4295694144544646, 'recall': 0.5638546182060686, 'f1-score': 0.48763607526494124, 'support': 5998}, '1': {'precision': 0.3880061506919528, 'recall': 0.42125765164162493, 'f1-score': 0.403948772678762, 'support': 5391}, '2': {'precision': 0.4531205471644343, 'recall': 0.27198084160109476, 'f1-score': 0.33992517370390163, 'support': 5846}, 'accuracy': 0.42024949231215547, 'macro avg': {'precision': 0.42356537077028394, 'recall': 0.41903103714959605, 'f1-score': 0.41050334054920157, 'support': 17235}, 'weighted avg': {'precision': 0.42455707716863816, 'recall': 0.42024949231215547, 'f1-score': 0.4113566335029494, 'support': 17235}}
[[3382 1719  897]
 [2098 2271 1022]
 [2393 1863 1590]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64347416
{'0': {'precision': 0.7079652914891406, 'recall': 0.3198812081088378, 'f1-score': 0.4406587809157281, 'support': 85191}, '1': {'precision': 0.786113939159894, 'recall': 0.9191459995022948, 'f1-score': 0.8474408692186423, 'support': 389789}, '2': {'precision': 0.5540602225685098, 'recall': 0.4251464460414276, 'f1-score': 0.4811175047496685, 'support': 82795}, 'accuracy': 0.7542898122002599, 'macro avg': {'precision': 0.6827131510725147, 'recall': 0.5547245512175201, 'f1-score': 0.5897390516280129, 'support': 557775}, 'weighted avg': {'precision': 0.7397324252718517, 'recall': 0.7542898122002599, 'f1-score': 0.7309352606025834, 'support': 557775}}
[[ 27251  53221   4719]
 [  7904 358273  23612]
 [  3337  44258  35200]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7041481
{'0': {'precision': 0.656964656964657, 'recall': 0.33765338480628704, 'f1-score': 0.4460533205837488, 'support': 29012}, '1': {'precision': 0.7360847222556258, 'recall': 0.9283728172617062, 'f1-score': 0.8211216340693441, 'support': 98901}, '2': {'precision': 0.6292154163799036, 'recall': 0.37609269479962976, 'f1-score': 0.4707876499238311, 'support': 29171}, 'accuracy': 0.7167120776145247, 'macro avg': {'precision': 0.6740882652000622, 'recall': 0.5473729656225409, 'f1-score': 0.579320868192308, 'support': 157084}, 'weighted avg': {'precision': 0.7016259877191848, 'recall': 0.7167120776145247, 'f1-score': 0.686791756027323, 'support': 157084}}
[[ 9796 17075  2141]
 [ 2760 91817  4324]
 [ 2355 15845 10971]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6952262
{'0': {'precision': 0.6177777777777778, 'recall': 0.3267351230978597, 'f1-score': 0.4274154393914873, 'support': 8083}, '1': {'precision': 0.767043534762833, 'recall': 0.9106112499614305, 'f1-score': 0.8326843857570115, 'support': 32409}, '2': {'precision': 0.5679862306368331, 'recall': 0.4090233019335647, 'f1-score': 0.4755728491137051, 'support': 8068}, 'accuracy': 0.7300864909390444, 'macro avg': {'precision': 0.6509358477258146, 'recall': 0.5487898916642849, 'f1-score': 0.5785575580874013, 'support': 48560}, 'weighted avg': {'precision': 0.7091253007554449, 'recall': 0.7300864909390444, 'f1-score': 0.7058935132053079, 'support': 48560}}
[[ 2641  4792   650]
 [ 1037 29512  1860]
 [  597  4171  3300]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0942854
{'0': {'precision': 0.38953251364323754, 'recall': 0.3739632121801265, 'f1-score': 0.38158911732879885, 'support': 79211}, '1': {'precision': 0.5485794981601502, 'recall': 0.6866763433597287, 'f1-score': 0.609908573069743, 'support': 139166}, '2': {'precision': 0.4132672512390393, 'recall': 0.24673436097166196, 'f1-score': 0.3089908547448434, 'support': 79081}, 'accuracy': 0.4864417833778214, 'macro avg': {'precision': 0.4504597543474757, 'recall': 0.435791305503839, 'f1-score': 0.43349618171446175, 'support': 297458}, 'weighted avg': {'precision': 0.4702528151012392, 'recall': 0.4864417833778214, 'f1-score': 0.4691079003981481, 'support': 297458}}
[[29622 38773 10816]
 [26718 95562 16886]
 [19705 39864 19512]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1864494
{'0': {'precision': 0.40474266534062653, 'recall': 0.46248091196420327, 'f1-score': 0.43168973232783625, 'support': 28159}, '1': {'precision': 0.38404537553746226, 'recall': 0.4641238253178552, 'f1-score': 0.42030436523828596, 'support': 27135}, '2': {'precision': 0.4452801805189921, 'recall': 0.29298642533936653, 'f1-score': 0.35342530010021106, 'support': 28288}, 'accuracy': 0.4056495417673662, 'macro avg': {'precision': 0.41135607379902694, 'recall': 0.40653038754047505, 'f1-score': 0.4018064658887777, 'support': 83582}, 'weighted avg': {'precision': 0.4117430275066042, 'recall': 0.4056495417673662, 'f1-score': 0.40150516872765907, 'support': 83582}}
[[13023 10268  4868]
 [ 9084 12594  5457]
 [10069  9931  8288]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1671238
{'0': {'precision': 0.40348086460185273, 'recall': 0.4265084075173096, 'f1-score': 0.41467519353752946, 'support': 10110}, '1': {'precision': 0.4397512131774998, 'recall': 0.5610394140216254, 'f1-score': 0.4930457105636231, 'support': 11468}, '2': {'precision': 0.45613222119246216, 'recall': 0.28911298218131976, 'f1-score': 0.3539069990412272, 'support': 10214}, 'accuracy': 0.4308945646703573, 'macro avg': {'precision': 0.43312143299060485, 'recall': 0.42555360124008496, 'f1-score': 0.42054263438079326, 'support': 31792}, 'weighted avg': {'precision': 0.4334798993804765, 'recall': 0.4308945646703573, 'f1-score': 0.4234216313416944, 'support': 31792}}
[[4312 4168 1630]
 [3143 6434 1891]
 [3232 4029 2953]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2079979
{'0': {'precision': 0.3524169252214578, 'recall': 0.7372976227433936, 'f1-score': 0.47688848729345984, 'support': 106299}, '1': {'precision': 0.40961139127855234, 'recall': 0.0649384852703262, 'f1-score': 0.11210431026783901, 'support': 106316}, '2': {'precision': 0.3589851320764946, 'recall': 0.2637805861790804, 'f1-score': 0.3041057199935704, 'support': 100413}, 'accuracy': 0.3570447372120066, 'macro avg': {'precision': 0.37367114952550157, 'recall': 0.3553388980642667, 'f1-score': 0.2976995058516231, 'support': 313028}, 'weighted avg': {'precision': 0.3739492488738495, 'recall': 0.3570447372120066, 'f1-score': 0.29756896770562835, 'support': 313028}}
[[78374  5627 22298]
 [74414  6904 24998]
 [69602  4324 26487]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2019882
{'0': {'precision': 0.3585195640241512, 'recall': 0.7287303560613305, 'f1-score': 0.4805961991254625, 'support': 31371}, '1': {'precision': 0.38289655172413795, 'recall': 0.046282094031343785, 'f1-score': 0.08258218057414846, 'support': 29990}, '2': {'precision': 0.37620177300536894, 'recall': 0.30073862124035133, 'f1-score': 0.33426400162712866, 'support': 30056}, 'accuracy': 0.3641335856569347, 'macro avg': {'precision': 0.37253929625121934, 'recall': 0.35858369044434185, 'f1-score': 0.29914746044224655, 'support': 91417}, 'weighted avg': {'precision': 0.3723301499574249, 'recall': 0.3641335856569347, 'f1-score': 0.3019138868163315, 'support': 91417}}
[[22861  1328  7182]
 [20796  1388  7806]
 [20108   909  9039]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2139319
{'0': {'precision': 0.348501914845686, 'recall': 0.7188661710037175, 'f1-score': 0.4694280078895465, 'support': 8608}, '1': {'precision': 0.35856573705179284, 'recall': 0.03221188260558339, 'f1-score': 0.059113300492610835, 'support': 8382}, '2': {'precision': 0.36588618850029636, 'recall': 0.298657312205153, 'f1-score': 0.32887112887112885, 'support': 8267}, 'accuracy': 0.3534465692679257, 'macro avg': {'precision': 0.35765128013259173, 'recall': 0.349911788604818, 'f1-score': 0.28580414575109536, 'support': 25257}, 'weighted avg': {'precision': 0.3575319163515755, 'recall': 0.3534465692679257, 'f1-score': 0.28725112242229495, 'support': 25257}}
[[6188  277 2143]
 [5976  270 2136]
 [5592  206 2469]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1606654
{'0': {'precision': 0.3780819270122371, 'recall': 0.5170531045819119, 'f1-score': 0.43677976450065414, 'support': 121063}, '1': {'precision': 0.4222032996274614, 'recall': 0.3212185996793159, 'f1-score': 0.3648521863904781, 'support': 123486}, '2': {'precision': 0.4083249749247743, 'recall': 0.3593029133536062, 'f1-score': 0.3822486267781463, 'support': 124633}, 'accuracy': 0.3982940663412626, 'macro avg': {'precision': 0.4028700671881576, 'recall': 0.3991915392049446, 'f1-score': 0.3946268592230928, 'support': 369182}, 'weighted avg': {'precision': 0.4030497033644071, 'recall': 0.3982940663412626, 'f1-score': 0.39431174547945996, 'support': 369182}}
[[62596 27551 30916]
 [49847 39666 33973]
 [53119 26733 44781]]
Evaluating performance on  train set...
494/494 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1383612
{'0': {'precision': 0.37838460652148864, 'recall': 0.5506503461326563, 'f1-score': 0.44854634146341466, 'support': 41747}, '1': {'precision': 0.44349687191307213, 'recall': 0.3220476771154628, 'f1-score': 0.3731386699541507, 'support': 41823}, '2': {'precision': 0.42117386111585053, 'recall': 0.3467075540157775, 'f1-score': 0.38032997367914234, 'support': 42719}, 'accuracy': 0.40595776354235125, 'macro avg': {'precision': 0.4143517798501371, 'recall': 0.40646852575463216, 'f1-score': 0.40067166169890256, 'support': 126289}, 'weighted avg': {'precision': 0.4144218262515422, 'recall': 0.40595776354235125, 'f1-score': 0.4004985300078779, 'support': 126289}}
[[22988  8915  9844]
 [17843 13469 10511]
 [19922  7986 14811]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1429694
{'0': {'precision': 0.3907204550242258, 'recall': 0.5763673088875078, 'f1-score': 0.4657250470809793, 'support': 12872}, '1': {'precision': 0.44314057585289135, 'recall': 0.286104819183004, 'f1-score': 0.3477146518581803, 'support': 12803}, '2': {'precision': 0.3990269873324766, 'recall': 0.3485127876212619, 'f1-score': 0.37206316600333805, 'support': 12473}, 'accuracy': 0.404451085246933, 'macro avg': {'precision': 0.41096267273653125, 'recall': 0.4036616385639246, 'f1-score': 0.39516762164749925, 'support': 38148}, 'weighted avg': {'precision': 0.4110293096024531, 'recall': 0.404451085246933, 'f1-score': 0.3954951075633397, 'support': 38148}}
[[7419 2310 3143]
 [5736 3663 3404]
 [5833 2293 4347]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/EXC
Evaluating performance on  test set...
5521/5521 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6157702
{'0': {'precision': 0.64852106547972, 'recall': 0.39081425243403284, 'f1-score': 0.4877180078936015, 'support': 215486}, '1': {'precision': 0.7937505003040929, 'recall': 0.8844832818645243, 'f1-score': 0.8366641822492334, 'support': 975348}, '2': {'precision': 0.5471875651674135, 'recall': 0.4835776348377991, 'f1-score': 0.5134198721007923, 'support': 222471}, 'accuracy': 0.7461064667569987, 'macro avg': {'precision': 0.6631530436504088, 'recall': 0.5862917230454521, 'f1-score': 0.6126006874145424, 'support': 1413305}, 'weighted avg': {'precision': 0.732795495732994, 'recall': 0.7461064667569987, 'f1-score': 0.7325780152504388, 'support': 1413305}}
[[ 84215 117982  13289]
 [ 36931 862679  75738]
 [  8711 106178 107582]]
Evaluating performance on  train set...
1288/1288 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.63927865
{'0': {'precision': 0.5737643800596506, 'recall': 0.39521617110259183, 'f1-score': 0.4680402741422194, 'support': 54517}, '1': {'precision': 0.7739749277673398, 'recall': 0.8890324628219078, 'f1-score': 0.8275234855710392, 'support': 220560}, '2': {'precision': 0.582543525291027, 'recall': 0.4138808073045324, 'f1-score': 0.4839375688657345, 'support': 54651}, 'accuracy': 0.7286308715062112, 'macro avg': {'precision': 0.6434276110393391, 'recall': 0.566043147076344, 'f1-score': 0.593167109526331, 'support': 329728}, 'weighted avg': {'precision': 0.7091433210911914, 'recall': 0.7286308715062112, 'f1-score': 0.711138889263396, 'support': 329728}}
[[ 21546  29728   3243]
 [ 11509 196085  12966]
 [  4497  27535  22619]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.60486907
{'0': {'precision': 0.575706166765629, 'recall': 0.4027176170414763, 'f1-score': 0.47391941903498364, 'support': 16853}, '1': {'precision': 0.8009326092436012, 'recall': 0.8887349190810969, 'f1-score': 0.8425524734694861, 'support': 78659}, '2': {'precision': 0.5679223300970874, 'recall': 0.444931240111963, 'f1-score': 0.49895936401787844, 'support': 16434}, 'accuracy': 0.750415378843371, 'macro avg': {'precision': 0.6481870353687725, 'recall': 0.5787945920781787, 'f1-score': 0.6051437521741161, 'support': 111946}, 'weighted avg': {'precision': 0.7328191245047533, 'recall': 0.750415378843371, 'f1-score': 0.736615843066324, 'support': 111946}}
[[ 6787  9224   842]
 [ 4031 69907  4721]
 [  971  8151  7312]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/AAL
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6254163
{'0': {'precision': 0.6176747128759853, 'recall': 0.3243372938055139, 'f1-score': 0.42533416433200416, 'support': 216725}, '1': {'precision': 0.7971386982135655, 'recall': 0.9094115369011175, 'f1-score': 0.8495819387549859, 'support': 1084520}, '2': {'precision': 0.5007960569256953, 'recall': 0.3840651577952638, 'f1-score': 0.4347310367469704, 'support': 213758}, 'accuracy': 0.75159191103912, 'macro avg': {'precision': 0.6385364893384154, 'recall': 0.5392713295006317, 'f1-score': 0.5698823799446534, 'support': 1515003}, 'weighted avg': {'precision': 0.7296537212605828, 'recall': 0.75159191103912, 'f1-score': 0.7303592058473612, 'support': 1515003}}
[[ 70292 131143  15290]
 [ 31699 986275  66546]
 [ 11810 119851  82097]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6636607
{'0': {'precision': 0.58177468913039, 'recall': 0.37206235328251525, 'f1-score': 0.4538646546384704, 'support': 75826}, '1': {'precision': 0.7715185111751494, 'recall': 0.908756450328075, 'f1-score': 0.8345329659030148, 'support': 312581}, '2': {'precision': 0.5594840444528476, 'recall': 0.3510214841175695, 'f1-score': 0.43138874715520237, 'support': 75870}, 'accuracy': 0.7299607777253665, 'macro avg': {'precision': 0.6375924149194624, 'recall': 0.5439467625760531, 'f1-score': 0.5732621225655626, 'support': 464277}, 'weighted avg': {'precision': 0.705879743713942, 'recall': 0.7299607777253665, 'f1-score': 0.7064820238009035, 'support': 464277}}
[[ 28212  41788   5826]
 [ 13378 284060  15143]
 [  6903  42335  26632]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6159993
{'0': {'precision': 0.6099499049922267, 'recall': 0.32104377869709505, 'f1-score': 0.4206701414743112, 'support': 21997}, '1': {'precision': 0.8078095771162599, 'recall': 0.9210654484994037, 'f1-score': 0.8607279062102735, 'support': 119086}, '2': {'precision': 0.5060868433044724, 'recall': 0.3592753489231907, 'f1-score': 0.4202275737182086, 'support': 21638}, 'accuracy': 0.765248492818997, 'macro avg': {'precision': 0.6412821084709863, 'recall': 0.5337948587065632, 'f1-score': 0.5672085404675978, 'support': 162721}, 'weighted avg': {'precision': 0.740940545326068, 'recall': 0.765248492818997, 'f1-score': 0.742663877318119, 'support': 162721}}
[[  7062  13508   1427]
 [  3240 109686   6160]
 [  1276  12588   7774]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/WBA
Evaluating performance on  test set...
3755/3755 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98917335
{'0': {'precision': 0.5079905768496116, 'recall': 0.41773344851959476, 'f1-score': 0.4584620246800075, 'support': 305592}, '1': {'precision': 0.5080777718066374, 'recall': 0.7100612389750587, 'f1-score': 0.5923237478671659, 'support': 363494}, '2': {'precision': 0.5156913352124955, 'recall': 0.35641554137336, 'f1-score': 0.4215089029933089, 'support': 292072}, 'accuracy': 0.5096539798867616, 'macro avg': {'precision': 0.5105865612895815, 'recall': 0.4947367429560045, 'f1-score': 0.4907648918468275, 'support': 961158}, 'weighted avg': {'precision': 0.510363621385758, 'recall': 0.5096539798867616, 'f1-score': 0.49785717204486896, 'support': 961158}}
[[127656 127954  49982]
 [ 57609 258103  47782]
 [ 66031 121942 104099]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0086608
{'0': {'precision': 0.5013670813213521, 'recall': 0.4782980086487641, 'f1-score': 0.48956093067552425, 'support': 131117}, '1': {'precision': 0.47778535101976616, 'recall': 0.6958248068171405, 'f1-score': 0.5665508215882173, 'support': 130964}, '2': {'precision': 0.5449819286574826, 'recall': 0.3198920805245317, 'f1-score': 0.40314635693908296, 'support': 130097}, 'accuracy': 0.49839103672312063, 'macro avg': {'precision': 0.5080447869995336, 'recall': 0.4980049653301455, 'f1-score': 0.48641936973427485, 'support': 392178}, 'weighted avg': {'precision': 0.5079605237548177, 'recall': 0.49839103672312063, 'f1-score': 0.4866046895658754, 'support': 392178}}
[[62713 49149 19255]
 [24344 91128 15492]
 [38027 50453 41617]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0400277
{'0': {'precision': 0.48881298488098074, 'recall': 0.4635763252391834, 'f1-score': 0.4758602912746488, 'support': 39823}, '1': {'precision': 0.4484312206022815, 'recall': 0.6231343283582089, 'f1-score': 0.5215413797801322, 'support': 39932}, '2': {'precision': 0.5232518084739924, 'recall': 0.3449833451095185, 'f1-score': 0.415816287734773, 'support': 39628}, 'accuracy': 0.4775805600462377, 'macro avg': {'precision': 0.4868320046524182, 'recall': 0.47723133290230363, 'f1-score': 0.4710726529298513, 'support': 119383}, 'weighted avg': {'precision': 0.48673745561941806, 'recall': 0.4775805600462377, 'f1-score': 0.47120898793935617, 'support': 119383}}
[[18461 15098  6264]
 [ 8857 24883  6192]
 [10449 15508 13671]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
4960/4960 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94134957
{'0': {'precision': 0.5311427337895777, 'recall': 0.34716052280131204, 'f1-score': 0.4198818295635601, 'support': 357918}, '1': {'precision': 0.5486633268814756, 'recall': 0.8651373132667038, 'f1-score': 0.6714795608756569, 'support': 557011}, '2': {'precision': 0.5925328387408216, 'recall': 0.2629656148342758, 'f1-score': 0.3642689512712278, 'support': 354746}, 'accuracy': 0.5508748301730758, 'macro avg': {'precision': 0.5574462998039582, 'recall': 0.49175448363409724, 'f1-score': 0.4852101139034816, 'support': 1269675}, 'weighted avg': {'precision': 0.5559814186890559, 'recall': 0.5508748301730758, 'f1-score': 0.5147204755109014, 'support': 1269675}}
[[124255 198940  34723]
 [ 45693 481891  29427]
 [ 63991 197469  93286]]
Evaluating performance on  train set...
1691/1691 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98734134
{'0': {'precision': 0.548444805408609, 'recall': 0.3664154042440863, 'f1-score': 0.439320943154045, 'support': 136378}, '1': {'precision': 0.49727475356427325, 'recall': 0.8402668976830774, 'f1-score': 0.6247932751610398, 'support': 162759}, '2': {'precision': 0.5921056576619794, 'recall': 0.2954062705678215, 'f1-score': 0.3941619679656704, 'support': 133704}, 'accuracy': 0.5226607460938312, 'macro avg': {'precision': 0.5459417388782872, 'recall': 0.5006961908316617, 'f1-score': 0.48609206209358496, 'support': 432841}, 'weighted avg': {'precision': 0.5426903693028621, 'recall': 0.5226607460938312, 'f1-score': 0.4951136145196043, 'support': 432841}}
[[ 49971  70352  16055]
 [ 14844 136761  11154]
 [ 26299  67908  39497]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0137902
{'0': {'precision': 0.5324773618056494, 'recall': 0.4030650870623862, 'f1-score': 0.45882051520939116, 'support': 48873}, '1': {'precision': 0.47602545808701957, 'recall': 0.8091397331998691, 'f1-score': 0.5994110558926496, 'support': 51949}, '2': {'precision': 0.5635160241523456, 'recall': 0.2893800560513605, 'f1-score': 0.38239195240784274, 'support': 50311}, 'accuracy': 0.5048004075880185, 'macro avg': {'precision': 0.5240062813483382, 'recall': 0.5005282921045385, 'f1-score': 0.48020784116996124, 'support': 151133}, 'weighted avg': {'precision': 0.5234056580417165, 'recall': 0.5048004075880185, 'f1-score': 0.4817032779074511, 'support': 151133}}
[[19699 21964  7210]
 [ 5848 42034  4067]
 [11448 24304 14559]]
testing model on single stock: results/universal/W8/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
10609/10609 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1312422
{'0': {'precision': 0.3775465409821795, 'recall': 0.6581467189837196, 'f1-score': 0.4798351535458583, 'support': 922580}, '1': {'precision': 0.41113150440522106, 'recall': 0.18320796797628727, 'f1-score': 0.2534664816768716, 'support': 832633}, '2': {'precision': 0.4263600315054727, 'recall': 0.32688679638174883, 'f1-score': 0.3700552319482522, 'support': 960464}, 'accuracy': 0.3953713935788387, 'macro avg': {'precision': 0.40501269229762443, 'recall': 0.3894138277805852, 'f1-score': 0.36778562239032736, 'support': 2715677}, 'weighted avg': {'precision': 0.4051078265149515, 'recall': 0.3953713935788387, 'f1-score': 0.3716036926682896, 'support': 2715677}}
[[607193 106136 209251]
 [466922 152545 213166]
 [534145 112356 313963]]
Evaluating performance on  train set...
3903/3903 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1365255
{'0': {'precision': 0.38472898565617925, 'recall': 0.6941609222901745, 'f1-score': 0.4950715092389873, 'support': 334385}, '1': {'precision': 0.44469016955032303, 'recall': 0.1561938357124145, 'f1-score': 0.23118559548043996, 'support': 328278}, '2': {'precision': 0.42253174577703606, 'recall': 0.35223350842303336, 'f1-score': 0.3841933758085696, 'support': 336399}, 'accuracy': 0.40226032018032915, 'macro avg': {'precision': 0.41731696699451276, 'recall': 0.4008627554752075, 'f1-score': 0.37015016017599894, 'support': 999062}, 'weighted avg': {'precision': 0.4171601543206844, 'recall': 0.40226032018032915, 'f1-score': 0.3710279231505489, 'support': 999062}}
[[232117  29498  72770]
 [187833  51275  89170]
 [183376  34532 118491]]
Evaluating performance on  val set...
1144/1144 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1397287
{'0': {'precision': 0.3882614910617166, 'recall': 0.6824014573699277, 'f1-score': 0.49492738630630234, 'support': 99906}, '1': {'precision': 0.42658247343292777, 'recall': 0.14717634806265809, 'f1-score': 0.21884753047889194, 'support': 94098}, '2': {'precision': 0.41055867573159915, 'recall': 0.3520566973202608, 'f1-score': 0.37906377590008955, 'support': 98629}, 'accuracy': 0.39895705542437115, 'macro avg': {'precision': 0.40846754674208113, 'recall': 0.39387816758428223, 'f1-score': 0.36427956422842794, 'support': 292633}, 'weighted avg': {'precision': 0.4080988874796601, 'recall': 0.39895705542437115, 'f1-score': 0.36710149413282217, 'support': 292633}}
[[68176  8391 23339]
 [53736 13849 26513]
 [53681 10225 34723]]
training model: results/universal/W8/deepVOL_L2/h10
Epoch 1/50
7696/7696 - 253s - loss: 2.8107 - accuracy10: 0.5207 - val_loss: 2.9186 - val_accuracy10: 0.5374 - 253s/epoch - 33ms/step
Epoch 2/50
7696/7696 - 250s - loss: 2.7229 - accuracy10: 0.5509 - val_loss: 2.8953 - val_accuracy10: 0.5473 - 250s/epoch - 32ms/step
Epoch 3/50
7696/7696 - 249s - loss: 2.6847 - accuracy10: 0.5608 - val_loss: 2.9624 - val_accuracy10: 0.5475 - 249s/epoch - 32ms/step
Epoch 4/50
7696/7696 - 244s - loss: 2.6644 - accuracy10: 0.5649 - val_loss: 2.9388 - val_accuracy10: 0.5504 - 244s/epoch - 32ms/step
Epoch 5/50
7696/7696 - 244s - loss: 2.6510 - accuracy10: 0.5676 - val_loss: 2.9012 - val_accuracy10: 0.5541 - 244s/epoch - 32ms/step
Epoch 6/50
7696/7696 - 245s - loss: 2.6402 - accuracy10: 0.5698 - val_loss: 2.9042 - val_accuracy10: 0.5526 - 245s/epoch - 32ms/step
Epoch 7/50
7696/7696 - 249s - loss: 2.6313 - accuracy10: 0.5715 - val_loss: 2.8831 - val_accuracy10: 0.5538 - 249s/epoch - 32ms/step
Epoch 8/50
7696/7696 - 253s - loss: 2.6243 - accuracy10: 0.5728 - val_loss: 2.8815 - val_accuracy10: 0.5563 - 253s/epoch - 33ms/step
Epoch 9/50
7696/7696 - 249s - loss: 2.6180 - accuracy10: 0.5740 - val_loss: 2.8332 - val_accuracy10: 0.5586 - 249s/epoch - 32ms/step
Epoch 10/50
7696/7696 - 250s - loss: 2.6119 - accuracy10: 0.5752 - val_loss: 2.8509 - val_accuracy10: 0.5572 - 250s/epoch - 32ms/step
Epoch 11/50
7696/7696 - 250s - loss: 2.6073 - accuracy10: 0.5765 - val_loss: 2.8261 - val_accuracy10: 0.5591 - 250s/epoch - 32ms/step
Epoch 12/50
7696/7696 - 246s - loss: 2.6031 - accuracy10: 0.5770 - val_loss: 2.8186 - val_accuracy10: 0.5597 - 246s/epoch - 32ms/step
Epoch 13/50
7696/7696 - 248s - loss: 2.5991 - accuracy10: 0.5780 - val_loss: 2.7949 - val_accuracy10: 0.5639 - 248s/epoch - 32ms/step
Epoch 14/50
7696/7696 - 246s - loss: 2.5959 - accuracy10: 0.5783 - val_loss: 2.7858 - val_accuracy10: 0.5638 - 246s/epoch - 32ms/step
Epoch 15/50
7696/7696 - 248s - loss: 2.5923 - accuracy10: 0.5792 - val_loss: 2.7911 - val_accuracy10: 0.5628 - 248s/epoch - 32ms/step
Epoch 16/50
7696/7696 - 248s - loss: 2.5890 - accuracy10: 0.5796 - val_loss: 2.7806 - val_accuracy10: 0.5650 - 248s/epoch - 32ms/step
Epoch 17/50
7696/7696 - 250s - loss: 2.5864 - accuracy10: 0.5804 - val_loss: 2.7849 - val_accuracy10: 0.5635 - 250s/epoch - 32ms/step
Epoch 18/50
7696/7696 - 254s - loss: 2.5834 - accuracy10: 0.5810 - val_loss: 2.7788 - val_accuracy10: 0.5644 - 254s/epoch - 33ms/step
Epoch 19/50
7696/7696 - 247s - loss: 2.5811 - accuracy10: 0.5814 - val_loss: 2.7558 - val_accuracy10: 0.5653 - 247s/epoch - 32ms/step
Epoch 20/50
7696/7696 - 247s - loss: 2.5790 - accuracy10: 0.5818 - val_loss: 2.7506 - val_accuracy10: 0.5664 - 247s/epoch - 32ms/step
Epoch 21/50
7696/7696 - 246s - loss: 2.5766 - accuracy10: 0.5823 - val_loss: 2.7539 - val_accuracy10: 0.5677 - 246s/epoch - 32ms/step
Epoch 22/50
7696/7696 - 250s - loss: 2.5742 - accuracy10: 0.5831 - val_loss: 2.7538 - val_accuracy10: 0.5663 - 250s/epoch - 33ms/step
Epoch 23/50
7696/7696 - 250s - loss: 2.5727 - accuracy10: 0.5829 - val_loss: 2.7445 - val_accuracy10: 0.5663 - 250s/epoch - 32ms/step
Epoch 24/50
7696/7696 - 249s - loss: 2.5709 - accuracy10: 0.5831 - val_loss: 2.7440 - val_accuracy10: 0.5677 - 249s/epoch - 32ms/step
Epoch 25/50
7696/7696 - 246s - loss: 2.5684 - accuracy10: 0.5840 - val_loss: 2.7379 - val_accuracy10: 0.5691 - 246s/epoch - 32ms/step
Epoch 26/50
7696/7696 - 248s - loss: 2.5670 - accuracy10: 0.5843 - val_loss: 2.7188 - val_accuracy10: 0.5692 - 248s/epoch - 32ms/step
Epoch 27/50
7696/7696 - 246s - loss: 2.5652 - accuracy10: 0.5847 - val_loss: 2.7187 - val_accuracy10: 0.5683 - 246s/epoch - 32ms/step
Epoch 28/50
7696/7696 - 246s - loss: 2.5638 - accuracy10: 0.5849 - val_loss: 2.7185 - val_accuracy10: 0.5689 - 246s/epoch - 32ms/step
Epoch 29/50
7696/7696 - 248s - loss: 2.5625 - accuracy10: 0.5854 - val_loss: 2.7152 - val_accuracy10: 0.5703 - 248s/epoch - 32ms/step
Epoch 30/50
7696/7696 - 246s - loss: 2.5612 - accuracy10: 0.5852 - val_loss: 2.7099 - val_accuracy10: 0.5695 - 246s/epoch - 32ms/step
Epoch 31/50
7696/7696 - 248s - loss: 2.5597 - accuracy10: 0.5859 - val_loss: 2.7011 - val_accuracy10: 0.5700 - 248s/epoch - 32ms/step
Epoch 32/50
7696/7696 - 247s - loss: 2.5581 - accuracy10: 0.5862 - val_loss: 2.7118 - val_accuracy10: 0.5696 - 247s/epoch - 32ms/step
Epoch 33/50
7696/7696 - 247s - loss: 2.5564 - accuracy10: 0.5863 - val_loss: 2.7047 - val_accuracy10: 0.5711 - 247s/epoch - 32ms/step
Epoch 34/50
7696/7696 - 244s - loss: 2.5553 - accuracy10: 0.5867 - val_loss: 2.7040 - val_accuracy10: 0.5702 - 244s/epoch - 32ms/step
Epoch 35/50
7696/7696 - 247s - loss: 2.5537 - accuracy10: 0.5869 - val_loss: 2.7039 - val_accuracy10: 0.5704 - 247s/epoch - 32ms/step
Epoch 36/50
7696/7696 - 246s - loss: 2.5528 - accuracy10: 0.5872 - val_loss: 2.7026 - val_accuracy10: 0.5706 - 246s/epoch - 32ms/step
Epoch 37/50
7696/7696 - 248s - loss: 2.5517 - accuracy10: 0.5873 - val_loss: 2.7046 - val_accuracy10: 0.5701 - 248s/epoch - 32ms/step
Epoch 38/50
7696/7696 - 250s - loss: 2.5503 - accuracy10: 0.5876 - val_loss: 2.6994 - val_accuracy10: 0.5704 - 250s/epoch - 32ms/step
Epoch 39/50
7696/7696 - 248s - loss: 2.5490 - accuracy10: 0.5880 - val_loss: 2.7106 - val_accuracy10: 0.5700 - 248s/epoch - 32ms/step
Epoch 40/50
7696/7696 - 248s - loss: 2.5481 - accuracy10: 0.5878 - val_loss: 2.7099 - val_accuracy10: 0.5693 - 248s/epoch - 32ms/step
Epoch 41/50
7696/7696 - 247s - loss: 2.5466 - accuracy10: 0.5883 - val_loss: 2.6991 - val_accuracy10: 0.5701 - 247s/epoch - 32ms/step
Epoch 42/50
7696/7696 - 247s - loss: 2.5454 - accuracy10: 0.5886 - val_loss: 2.6959 - val_accuracy10: 0.5692 - 247s/epoch - 32ms/step
Epoch 43/50
7696/7696 - 248s - loss: 2.5443 - accuracy10: 0.5888 - val_loss: 2.6983 - val_accuracy10: 0.5697 - 248s/epoch - 32ms/step
Epoch 44/50
7696/7696 - 245s - loss: 2.5434 - accuracy10: 0.5891 - val_loss: 2.7109 - val_accuracy10: 0.5693 - 245s/epoch - 32ms/step
Epoch 45/50
7696/7696 - 246s - loss: 2.5423 - accuracy10: 0.5892 - val_loss: 2.7025 - val_accuracy10: 0.5710 - 246s/epoch - 32ms/step
Epoch 46/50
7696/7696 - 244s - loss: 2.5414 - accuracy10: 0.5895 - val_loss: 2.7024 - val_accuracy10: 0.5700 - 244s/epoch - 32ms/step
Epoch 47/50
7696/7696 - 246s - loss: 2.5404 - accuracy10: 0.5897 - val_loss: 2.7017 - val_accuracy10: 0.5693 - 246s/epoch - 32ms/step
Epoch 48/50
7696/7696 - 245s - loss: 2.5394 - accuracy10: 0.5901 - val_loss: 2.7059 - val_accuracy10: 0.5692 - 245s/epoch - 32ms/step
Epoch 49/50
7696/7696 - 246s - loss: 2.5385 - accuracy10: 0.5902 - val_loss: 2.7021 - val_accuracy10: 0.5701 - 246s/epoch - 32ms/step
Epoch 50/50
7696/7696 - 245s - loss: 2.5372 - accuracy10: 0.5905 - val_loss: 2.7043 - val_accuracy10: 0.5703 - 245s/epoch - 32ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 364s - 364s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8502084
{'0': {'precision': 0.4442645054265171, 'recall': 0.5212388152072693, 'f1-score': 0.47968328953058986, 'support': 1383128}, '1': {'precision': 0.8123423185110547, 'recall': 0.6340845011815085, 'f1-score': 0.7122291522929518, 'support': 3172216}, '2': {'precision': 0.4323614278863272, 'recall': 0.5727648361154903, 'f1-score': 0.4927568431054823, 'support': 1405624}, 'accuracy': 0.5934413672410253, 'macro avg': {'precision': 0.5629894172746329, 'recall': 0.5760293841680895, 'f1-score': 0.5615564283096747, 'support': 5960968}, 'weighted avg': {'precision': 0.6373356771636288, 'recall': 0.5934413672410253, 'f1-score': 0.6065187644498854, 'support': 5960968}}
[[ 720940  228346  433842]
 [ 537616 2011453  623147]
 [ 364216  236316  805092]]
Evaluating performance on  train set...
7696/7696 - 125s - 125s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88821256
{'0': {'precision': 0.465994851594857, 'recall': 0.5285470426064682, 'f1-score': 0.49530382202369677, 'support': 521963}, '1': {'precision': 0.7545288389997735, 'recall': 0.6040601304170952, 'f1-score': 0.6709620041818712, 'support': 926719}, '2': {'precision': 0.4537354061113384, 'recall': 0.5537022031574622, 'f1-score': 0.4987590133680636, 'support': 520798}, 'accuracy': 0.5707308528139408, 'macro avg': {'precision': 0.5580863655686562, 'recall': 0.5621031253936751, 'f1-score': 0.5550082798578773, 'support': 1969480}, 'weighted avg': {'precision': 0.5985197990860583, 'recall': 0.5707308528139408, 'f1-score': 0.5788716834151325, 'support': 1969480}}
[[275882  87430 158651]
 [178403 559794 188522]
 [137743  94688 288367]]
Evaluating performance on  val set...
2338/2338 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8899315
{'0': {'precision': 0.45551881322264703, 'recall': 0.5168381969775925, 'f1-score': 0.48424502450367096, 'support': 153520}, '1': {'precision': 0.7618729096989967, 'recall': 0.6027987600778044, 'f1-score': 0.6730645260314342, 'support': 290986}, '2': {'precision': 0.4414420471235597, 'recall': 0.5569046283126949, 'f1-score': 0.4924964949024631, 'support': 153274}, 'accuracy': 0.5689551339957845, 'macro avg': {'precision': 0.5529445900150679, 'recall': 0.5588471951226973, 'f1-score': 0.5499353484791895, 'support': 597780}, 'weighted avg': {'precision': 0.601035810897704, 'recall': 0.5689551339957845, 'f1-score': 0.57827387683306, 'support': 597780}}
[[ 79345  26514  47661]
 [ 55236 175406  60344]
 [ 39605  28310  85359]]
testing model out of sample: results/universal/W8/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 220s - 220s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6809839
{'0': {'precision': 0.4661620395554164, 'recall': 0.5157078801983818, 'f1-score': 0.48968490104750056, 'support': 626469}, '1': {'precision': 0.838567687357702, 'recall': 0.810723546640265, 'f1-score': 0.8244105778026577, 'support': 2370559}, '2': {'precision': 0.47318579010806777, 'recall': 0.4824541288107565, 'f1-score': 0.4777750146530017, 'support': 619234}, 'accuracy': 0.703404509960838, 'macro avg': {'precision': 0.5926385056737288, 'recall': 0.6029618518831344, 'f1-score': 0.5972901645010533, 'support': 3616262}, 'weighted avg': {'precision': 0.7114868819474386, 'recall': 0.703404509960838, 'f1-score': 0.7070673691793499, 'support': 3616262}}
[[ 323075  177697  125697]
 [ 241777 1921868  206914]
 [ 128201  192281  298752]]
Evaluating performance on  train set...
4550/4550 - 74s - 74s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7271884
{'0': {'precision': 0.48486628622580286, 'recall': 0.5197390402919733, 'f1-score': 0.5016973962231384, 'support': 233446}, '1': {'precision': 0.8107015631743338, 'recall': 0.794242593627725, 'f1-score': 0.8023876836644936, 'support': 697710}, '2': {'precision': 0.49375786777792247, 'recall': 0.48819502564432715, 'f1-score': 0.49096068973703233, 'support': 232995}, 'accuracy': 0.6779438406186139, 'macro avg': {'precision': 0.5964419057260196, 'recall': 0.6007255531880085, 'f1-score': 0.5983485898748881, 'support': 1164151}, 'weighted avg': {'precision': 0.6819285445784526, 'recall': 0.6779438406186139, 'f1-score': 0.6797610851457763, 'support': 1164151}}
[[121331  61757  50358]
 [ 77294 554151  66265]
 [ 51611  67637 113747]]
Evaluating performance on  val set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7125141
{'0': {'precision': 0.49103444915460703, 'recall': 0.5181433731377817, 'f1-score': 0.5042248059591342, 'support': 77797}, '1': {'precision': 0.821271168722559, 'recall': 0.8018117687402533, 'f1-score': 0.8114248178077438, 'support': 244954}, '2': {'precision': 0.4863957087892118, 'recall': 0.4957716971973123, 'f1-score': 0.49103895035837875, 'support': 78282}, 'accuracy': 0.6870432109078305, 'macro avg': {'precision': 0.5995671088887926, 'recall': 0.6052422796917823, 'f1-score': 0.602229524708419, 'support': 401033}, 'weighted avg': {'precision': 0.6918400575004645, 'recall': 0.6870432109078305, 'f1-score': 0.6892910138627879, 'support': 401033}}
[[ 40310  19817  17670]
 [ 25236 196407  23311]
 [ 16546  22926  38810]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0235038
{'0': {'precision': 0.42590862301053134, 'recall': 0.5608057385937109, 'f1-score': 0.48413605638113066, 'support': 47956}, '1': {'precision': 0.7482932136542908, 'recall': 0.39224101057914396, 'f1-score': 0.5146908880012722, 'support': 70138}, '2': {'precision': 0.4240317470083367, 'recall': 0.5886824685030964, 'f1-score': 0.49297235435070275, 'support': 46830}, 'accuracy': 0.49703499793844436, 'macro avg': {'precision': 0.5327445278910529, 'recall': 0.513909739225317, 'f1-score': 0.4972664329110352, 'support': 164924}, 'weighted avg': {'precision': 0.5624776870363204, 'recall': 0.49703499793844436, 'f1-score': 0.4996393100864043, 'support': 164924}}
[[26894  4669 16393]
 [21574 27511 21053]
 [14677  4585 27568]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0249172
{'0': {'precision': 0.444093903683771, 'recall': 0.5595697416111306, 'f1-score': 0.49518882565959654, 'support': 17106}, '1': {'precision': 0.6980761358984855, 'recall': 0.37425386235955055, 'f1-score': 0.4872710648875682, 'support': 22784}, '2': {'precision': 0.4418644430190293, 'recall': 0.5985287303058388, 'f1-score': 0.5084011906811975, 'support': 17264}, 'accuracy': 0.4974629947160304, 'macro avg': {'precision': 0.5280114942004286, 'recall': 0.5107841114255066, 'f1-score': 0.4969536937427874, 'support': 57154}, 'weighted avg': {'precision': 0.5446685226057004, 'recall': 0.4974629947160304, 'f1-score': 0.4960234130603563, 'support': 57154}}
[[ 9572  1870  5664]
 [ 6869  8527  7388]
 [ 5113  1818 10333]]
Evaluating performance on  val set...
68/68 - 1s - 634ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.043263
{'0': {'precision': 0.44100101847810275, 'recall': 0.5727513227513228, 'f1-score': 0.498314837648993, 'support': 5292}, '1': {'precision': 0.6380839739798936, 'recall': 0.3291641244661379, 'f1-score': 0.43429261420809023, 'support': 6556}, '2': {'precision': 0.45173302778573476, 'recall': 0.5852662831694192, 'f1-score': 0.509902190607065, 'support': 5389}, 'accuracy': 0.48401694030283693, 'macro avg': {'precision': 0.510272673414577, 'recall': 0.4957272434622933, 'f1-score': 0.48083654748804944, 'support': 17237}, 'weighted avg': {'precision': 0.5193157283712727, 'recall': 0.48401694030283693, 'f1-score': 0.47758701657876573, 'support': 17237}}
[[3031  613 1648]
 [2218 2158 2180]
 [1624  611 3154]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43263915
{'0': {'precision': 0.5494820125016392, 'recall': 0.5058449528178508, 'f1-score': 0.5267613011366612, 'support': 49701}, '1': {'precision': 0.9127222518808196, 'recall': 0.92720627791947, 'f1-score': 0.919907255345999, 'support': 459133}, '2': {'precision': 0.5325279014186419, 'recall': 0.49619989376047074, 'f1-score': 0.51372246253424, 'support': 48946}, 'accuracy': 0.8518394349026498, 'macro avg': {'precision': 0.6649107219337003, 'recall': 0.6430837081659305, 'f1-score': 0.6534636730056335, 'support': 557780}, 'weighted avg': {'precision': 0.8469931188622345, 'recall': 0.8518394349026498, 'f1-score': 0.8492326740789715, 'support': 557780}}
[[ 25141  20377   4183]
 [ 16285 425711  17137]
 [  4328  20331  24287]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4917484
{'0': {'precision': 0.5554379630206063, 'recall': 0.49539144919489175, 'f1-score': 0.5236991166025886, 'support': 18010}, '1': {'precision': 0.8857742181540809, 'recall': 0.9227560176141443, 'f1-score': 0.9038870060161837, 'support': 120812}, '2': {'precision': 0.5819488396624473, 'recall': 0.4832740213523132, 'f1-score': 0.5280411569407472, 'support': 18265}, 'accuracy': 0.8226587814395845, 'macro avg': {'precision': 0.6743870069457115, 'recall': 0.6338071627204498, 'f1-score': 0.6518757598531731, 'support': 157087}, 'weighted avg': {'precision': 0.8125744849291574, 'recall': 0.8226587814395845, 'f1-score': 0.8165977438767215, 'support': 157087}}
[[  8922   6938   2150]
 [  5141 111480   4191]
 [  2000   7438   8827]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49719024
{'0': {'precision': 0.4796812749003984, 'recall': 0.47271299568119357, 'f1-score': 0.476171643266759, 'support': 5094}, '1': {'precision': 0.8917122851686824, 'recall': 0.9155839063031032, 'f1-score': 0.9034904419162603, 'support': 38251}, '2': {'precision': 0.5427901524032825, 'recall': 0.4439117929050815, 'f1-score': 0.4883966244725738, 'support': 5215}, 'accuracy': 0.8184719934102141, 'macro avg': {'precision': 0.6380612374907878, 'recall': 0.6107362316297927, 'f1-score': 0.6226862365518643, 'support': 48560}, 'weighted avg': {'precision': 0.8110179917445022, 'recall': 0.8184719934102141, 'f1-score': 0.8140860716878957, 'support': 48560}}
[[ 2408  2075   611]
 [ 1890 35022  1339]
 [  722  2178  2315]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
1162/1162 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9269862
{'0': {'precision': 0.46196547444431907, 'recall': 0.5384392835538255, 'f1-score': 0.49727944034201327, 'support': 76042}, '1': {'precision': 0.6960329275768457, 'recall': 0.5966030448400811, 'f1-score': 0.6424939004673859, 'support': 146543}, '2': {'precision': 0.4379265596462559, 'recall': 0.486738427842624, 'f1-score': 0.46104413606405986, 'support': 74878}, 'accuracy': 0.5540789946985003, 'macro avg': {'precision': 0.5319749872224735, 'recall': 0.5405935854121768, 'f1-score': 0.5336058256244863, 'support': 297463}, 'weighted avg': {'precision': 0.5712259906165842, 'recall': 0.5540789946985003, 'f1-score': 0.5596970704890497, 'support': 297463}}
[[40944 17920 17178]
 [29515 87428 29600]
 [18171 20261 36446]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0522251
{'0': {'precision': 0.4725581103940856, 'recall': 0.5441919191919192, 'f1-score': 0.5058515811005667, 'support': 27720}, '1': {'precision': 0.5487856388595564, 'recall': 0.373334291153335, 'f1-score': 0.44436844017870497, 'support': 27841}, '2': {'precision': 0.46687041564792175, 'recall': 0.5451625566539381, 'f1-score': 0.502988097002025, 'support': 28021}, 'accuracy': 0.48760498671962865, 'macro avg': {'precision': 0.4960713883005213, 'recall': 0.48756292233306403, 'f1-score': 0.4844027060937656, 'support': 83582}, 'weighted avg': {'precision': 0.4960425415577921, 'recall': 0.48760498671962865, 'f1-score': 0.48441167999350077, 'support': 83582}}
[[15085  4017  8618]
 [ 8621 10394  8826]
 [ 8216  4529 15276]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0090829
{'0': {'precision': 0.4911483480071949, 'recall': 0.5304161128718945, 'f1-score': 0.5100275265434526, 'support': 9781}, '1': {'precision': 0.6002510197678067, 'recall': 0.47737481284312094, 'f1-score': 0.5318074410415605, 'support': 12022}, '2': {'precision': 0.4755742200891327, 'recall': 0.5555110621683852, 'f1-score': 0.5124440134829386, 'support': 9989}, 'accuracy': 0.5182435832913941, 'macro avg': {'precision': 0.5223245292880447, 'recall': 0.5211006626278002, 'f1-score': 0.5180929936893173, 'support': 31792}, 'weighted avg': {'precision': 0.5275116581522803, 'recall': 0.5182435832913941, 'f1-score': 0.5190227586815621, 'support': 31792}}
[[5188 1856 2737]
 [2901 5739 3382]
 [2474 1966 5549]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1223/1223 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.257188
{'0': {'precision': 0.3483127999604176, 'recall': 0.2749714374993897, 'f1-score': 0.3073271087197341, 'support': 102407}, '1': {'precision': 0.3683597792342187, 'recall': 0.07872063986436055, 'f1-score': 0.12971947006794973, 'support': 108523}, '2': {'precision': 0.3369282812671952, 'recall': 0.6896663173462092, 'f1-score': 0.4526968820315011, 'support': 102103}, 'accuracy': 0.3421971485434443, 'macro avg': {'precision': 0.3512002868206105, 'recall': 0.34778613156998645, 'f1-score': 0.296581153606395, 'support': 313033}, 'weighted avg': {'precision': 0.3515494070261155, 'recall': 0.3421971485434443, 'f1-score': 0.29316941989792855, 'support': 313033}}
[[28159  7543 66705]
 [28105  8543 71875]
 [24580  7106 70417]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2311059
{'0': {'precision': 0.37730300147046103, 'recall': 0.2763207905739263, 'f1-score': 0.31901122609426996, 'support': 31572}, '1': {'precision': 0.3671125843494732, 'recall': 0.10297536029753603, 'f1-score': 0.16083607790254403, 'support': 30114}, '2': {'precision': 0.33764411027568925, 'recall': 0.6796488749873878, 'f1-score': 0.4511570275610329, 'support': 29733}, 'accuracy': 0.3503976197508177, 'macro avg': {'precision': 0.3606865653652078, 'recall': 0.3529816752862834, 'f1-score': 0.310334777185949, 'support': 91419}, 'weighted avg': {'precision': 0.36104760562194405, 'recall': 0.3503976197508177, 'f1-score': 0.30988625975648054, 'support': 91419}}
[[ 8724  2830 20018]
 [ 7389  3101 19624]
 [ 7009  2516 20208]]
Evaluating performance on  val set...
99/99 - 1s - 905ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2230179
{'0': {'precision': 0.3763373190685966, 'recall': 0.2800936768149883, 'f1-score': 0.32116004296455425, 'support': 8540}, '1': {'precision': 0.38031533683707597, 'recall': 0.09763277321231449, 'f1-score': 0.1553777083739996, 'support': 8153}, '2': {'precision': 0.35409601998929147, 'recall': 0.6949211908931698, 'f1-score': 0.4691416410498936, 'support': 8565}, 'accuracy': 0.3618655475492913, 'macro avg': {'precision': 0.3702495586316547, 'recall': 0.3575492136401575, 'f1-score': 0.31522646412948246, 'support': 25258}, 'weighted avg': {'precision': 0.3700793434668927, 'recall': 0.3618655475492913, 'f1-score': 0.3178279902954648, 'support': 25258}}
[[2392  656 5492]
 [1992  796 5365]
 [1972  641 5952]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0902767
{'0': {'precision': 0.45238002035543723, 'recall': 0.5666525015118579, 'f1-score': 0.5031091052887441, 'support': 122366}, '1': {'precision': 0.5945368960750346, 'recall': 0.2735830065464735, 'f1-score': 0.3747297833855384, 'support': 124189}, '2': {'precision': 0.4494406792471845, 'recall': 0.5818628090547329, 'f1-score': 0.5071500660990206, 'support': 122632}, 'accuracy': 0.47312066784583423, 'macro avg': {'precision': 0.49878586522588547, 'recall': 0.4740327723710214, 'f1-score': 0.4616629849244343, 'support': 369187}, 'weighted avg': {'precision': 0.4992231187309321, 'recall': 0.47312066784583423, 'f1-score': 0.4612664930035028, 'support': 369187}}
[[69339 10729 42298]
 [45102 33976 45111]
 [38835 12442 71355]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0572242
{'0': {'precision': 0.45856254840823785, 'recall': 0.5502466458546815, 'f1-score': 0.5002383118852637, 'support': 41963}, '1': {'precision': 0.5914144533662755, 'recall': 0.32180238140964085, 'f1-score': 0.41680917881906654, 'support': 41656}, '2': {'precision': 0.4593508906950988, 'recall': 0.5734539404307173, 'f1-score': 0.510099430929898, 'support': 42673}, 'accuracy': 0.4827384157349634, 'macro avg': {'precision': 0.5031092974898708, 'recall': 0.48183432256501324, 'f1-score': 0.4757156405447427, 'support': 126292}, 'weighted avg': {'precision': 0.5026486336974029, 'recall': 0.4827384157349634, 'f1-score': 0.47605213671966473, 'support': 126292}}
[[23090  4441 14432]
 [13881 13405 14370]
 [13382  4820 24471]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0780337
{'0': {'precision': 0.46519068338878933, 'recall': 0.5628677609166924, 'f1-score': 0.5093890134529148, 'support': 12916}, '1': {'precision': 0.5709186840471757, 'recall': 0.28873018364463976, 'f1-score': 0.38350880850620245, 'support': 12742}, '2': {'precision': 0.4526001492908684, 'recall': 0.5825460368294636, 'f1-score': 0.5094167891899462, 'support': 12490}, 'accuracy': 0.477744573765335, 'macro avg': {'precision': 0.4962365055756111, 'recall': 0.47804799379693197, 'f1-score': 0.4674382037163545, 'support': 38148}, 'weighted avg': {'precision': 0.4963831551699083, 'recall': 0.477744573765335, 'f1-score': 0.46735224475008674, 'support': 38148}}
[[7270 1400 4246]
 [4509 3679 4554]
 [3849 1365 7276]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
5521/5521 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46096373
{'0': {'precision': 0.5036976658021489, 'recall': 0.5313374501680607, 'f1-score': 0.5171485088253196, 'support': 127930}, '1': {'precision': 0.91698361300941, 'recall': 0.8892064502642506, 'f1-score': 0.9028814409450588, 'support': 1152883}, '2': {'precision': 0.4562094763092269, 'recall': 0.5522842026611924, 'f1-score': 0.49967053264458156, 'support': 132497}, 'accuracy': 0.8252265957220992, 'macro avg': {'precision': 0.6256302517069287, 'recall': 0.6576093676978346, 'f1-score': 0.6399001608049867, 'support': 1413310}, 'weighted avg': {'precision': 0.8363764836346875, 'recall': 0.8252265957220992, 'f1-score': 0.8301648750655516, 'support': 1413310}}
[[  67974   45928   14028]
 [  54536 1025151   73196]
 [  12440   46881   73176]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4907991
{'0': {'precision': 0.45945327399872854, 'recall': 0.5389250134224184, 'f1-score': 0.4960261355369179, 'support': 33526}, '1': {'precision': 0.9043023628949572, 'recall': 0.8807644370585791, 'f1-score': 0.8923782142008932, 'support': 262363}, '2': {'precision': 0.4863640274153308, 'recall': 0.5011672231908041, 'f1-score': 0.49365467458376994, 'support': 33841}, 'accuracy': 0.8070481909441057, 'macro avg': {'precision': 0.6167065547696722, 'recall': 0.6402855578906005, 'f1-score': 0.6273530081071937, 'support': 329730}, 'weighted avg': {'precision': 0.8161773461682383, 'recall': 0.8070481909441057, 'f1-score': 0.8111562959845601, 'support': 329730}}
[[ 18068  11905   3553]
 [ 16925 231080  14358]
 [  4332  12549  16960]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46160963
{'0': {'precision': 0.421434386795944, 'recall': 0.5695708712613784, 'f1-score': 0.484430832057172, 'support': 9997}, '1': {'precision': 0.9215614863711376, 'recall': 0.8784893623946275, 'f1-score': 0.8995101034226108, 'support': 92173}, '2': {'precision': 0.48987701040681175, 'recall': 0.5296644844517185, 'f1-score': 0.508994396933058, 'support': 9776}, 'accuracy': 0.8204402122451896, 'macro avg': {'precision': 0.6109576278579644, 'recall': 0.6592415727025749, 'f1-score': 0.6309784441376136, 'support': 111946}, 'weighted avg': {'precision': 0.8392010800012766, 'recall': 0.8204402122451896, 'f1-score': 0.828339815761755, 'support': 111946}}
[[ 5694  3392   911]
 [ 6719 80973  4481]
 [ 1098  3500  5178]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
5918/5918 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.44236532
{'0': {'precision': 0.4900118580680471, 'recall': 0.4934476423759951, 'f1-score': 0.49172374864605106, 'support': 130640}, '1': {'precision': 0.9098179120349965, 'recall': 0.9242702125625418, 'f1-score': 0.9169871214714073, 'support': 1255160}, '2': {'precision': 0.5137235358177824, 'recall': 0.4308092378180918, 'f1-score': 0.4686271373367794, 'support': 129208}, 'accuracy': 0.8450351417286245, 'macro avg': {'precision': 0.6378511019736086, 'recall': 0.6161756975855429, 'f1-score': 0.6257793358180792, 'support': 1515008}, 'weighted avg': {'precision': 0.8398367468843728, 'recall': 0.8450351417286245, 'f1-score': 0.8420778775228792, 'support': 1515008}}
[[  64464   53836   12340]
 [  54703 1160107   40350]
 [  12389   61155   55664]]
Evaluating performance on  train set...
1814/1814 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48163724
{'0': {'precision': 0.5189714080201403, 'recall': 0.4769656654133785, 'f1-score': 0.49708269640665703, 'support': 48406}, '1': {'precision': 0.8910758314106659, 'recall': 0.9187963580440138, 'f1-score': 0.9047238069201379, 'support': 367385}, '2': {'precision': 0.5251238499646143, 'recall': 0.4437799043062201, 'f1-score': 0.48103727714748784, 'support': 48488}, 'accuracy': 0.8231214420639313, 'macro avg': {'precision': 0.6450570297984736, 'recall': 0.6131806425878709, 'f1-score': 0.6276145934914276, 'support': 464279}, 'weighted avg': {'precision': 0.8140610054224177, 'recall': 0.8231214420639313, 'f1-score': 0.8179742704320956, 'support': 464279}}
[[ 23088  19679   5639]
 [ 16013 337552  13820]
 [  5387  21583  21518]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.42441258
{'0': {'precision': 0.5102398597497808, 'recall': 0.47723037936945667, 'f1-score': 0.4931833936686436, 'support': 13417}, '1': {'precision': 0.9111190459187317, 'recall': 0.9380555698519951, 'f1-score': 0.9243911186462782, 'support': 136009}, '2': {'precision': 0.5451049985211476, 'recall': 0.41583935018050544, 'f1-score': 0.4717778062204019, 'support': 13296}, 'accuracy': 0.8573886751637763, 'macro avg': {'precision': 0.6554879680632201, 'recall': 0.6103750998006524, 'f1-score': 0.6297841061784412, 'support': 162722}, 'weighted avg': {'precision': 0.8481581751389533, 'recall': 0.8573886751637763, 'f1-score': 0.8518535352338362, 'support': 162722}}
[[  6403   5889   1125]
 [  4936 127584   3489]
 [  1210   6557   5529]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
3755/3755 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85706437
{'0': {'precision': 0.47345991052922337, 'recall': 0.4973015658335042, 'f1-score': 0.4850879656818936, 'support': 229207}, '1': {'precision': 0.7075113876566733, 'recall': 0.6975486809997828, 'f1-score': 0.7024947135878037, 'support': 511031}, '2': {'precision': 0.4823089957936827, 'recall': 0.4728210931311531, 'f1-score': 0.47751791983616154, 'support': 220925}, 'accuracy': 0.5981420425047572, 'macro avg': {'precision': 0.5544267646598597, 'recall': 0.5558904466548135, 'f1-score': 0.5550335330352864, 'support': 961163}, 'weighted avg': {'precision': 0.5999343426182329, 'recall': 0.5981420425047572, 'f1-score': 0.5989387645689052, 'support': 961163}}
[[113985  73804  41418]
 [ 83859 356469  70703]
 [ 42905  73562 104458]]
Evaluating performance on  train set...
1532/1532 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8720991
{'0': {'precision': 0.4917342037083137, 'recall': 0.5201494138529659, 'f1-score': 0.505542837914054, 'support': 102534}, '1': {'precision': 0.6916390476559344, 'recall': 0.6656265309165265, 'f1-score': 0.6783835193431181, 'support': 187796}, '2': {'precision': 0.4921981959238365, 'recall': 0.49769761710734306, 'f1-score': 0.4949326303456356, 'support': 101851}, 'accuracy': 0.5839803560090876, 'macro avg': {'precision': 0.5585238157626948, 'recall': 0.5611578539589451, 'f1-score': 0.5596196625342692, 'support': 392181}, 'weighted avg': {'precision': 0.5875792042186153, 'recall': 0.5839803560090876, 'f1-score': 0.5855521406559042, 'support': 392181}}
[[ 53333  26351  22850]
 [ 33346 125002  29448]
 [ 21780  29380  50691]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91903985
{'0': {'precision': 0.4670519883199374, 'recall': 0.5091058244462674, 'f1-score': 0.48717304612679374, 'support': 30475}, '1': {'precision': 0.665236209595727, 'recall': 0.6186773093986057, 'f1-score': 0.6411125705562852, 'support': 58381}, '2': {'precision': 0.46424424989802004, 'recall': 0.484652930192944, 'f1-score': 0.47422911725110584, 'support': 30527}, 'accuracy': 0.5564360084769189, 'macro avg': {'precision': 0.5321774826045615, 'recall': 0.5374786880126057, 'f1-score': 0.5341715779780616, 'support': 119383}, 'weighted avg': {'precision': 0.5632506195446176, 'recall': 0.5564360084769189, 'f1-score': 0.5591431261124703, 'support': 119383}}
[[15515  8645  6315]
 [11503 36119 10759]
 [ 6201  9531 14795]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
4960/4960 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7443546
{'0': {'precision': 0.47329786281706476, 'recall': 0.4874551540296234, 'f1-score': 0.48027220019273603, 'support': 249465}, '1': {'precision': 0.7688881693873864, 'recall': 0.7910446219573444, 'f1-score': 0.7798090464605247, 'support': 774529}, '2': {'precision': 0.49933535582779465, 'recall': 0.4388080720920199, 'f1-score': 0.46711915960233197, 'support': 245686}, 'accuracy': 0.6632371936235902, 'macro avg': {'precision': 0.5805071293440819, 'recall': 0.5724359493596626, 'f1-score': 0.5757334687518642, 'support': 1269680}, 'weighted avg': {'precision': 0.6586518985311335, 'recall': 0.6632371936235902, 'f1-score': 0.660450241961095, 'support': 1269680}}
[[121603  90499  37363]
 [ 91109 612687  70733]
 [ 44215  93662 107809]]
Evaluating performance on  train set...
1691/1691 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79255724
{'0': {'precision': 0.4943475818294714, 'recall': 0.5104986208791769, 'f1-score': 0.5022933023553918, 'support': 98251}, '1': {'precision': 0.7339306210942482, 'recall': 0.7736048797701265, 'f1-score': 0.7532456908188058, 'support': 238044}, '2': {'precision': 0.5263883883635099, 'recall': 0.4387305927560099, 'f1-score': 0.47857869167325723, 'support': 96549}, 'accuracy': 0.6391864043396697, 'macro avg': {'precision': 0.5848888637624098, 'recall': 0.5742780311351044, 'f1-score': 0.578039228282485, 'support': 432844}, 'weighted avg': {'precision': 0.6332540073056231, 'recall': 0.6391864043396697, 'f1-score': 0.6350156882788087, 'support': 432844}}
[[ 50157  31896  16198]
 [ 31978 184152  21914]
 [ 19326  34864  42359]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83051467
{'0': {'precision': 0.5047198287690028, 'recall': 0.5054271660575417, 'f1-score': 0.5050732497631567, 'support': 36391}, '1': {'precision': 0.7180981748896912, 'recall': 0.7379967793880837, 'f1-score': 0.7279115126333379, 'support': 77625}, '2': {'precision': 0.4931550005728033, 'recall': 0.463898916967509, 'f1-score': 0.4780797956520532, 'support': 37118}, 'accuracy': 0.6146796882236956, 'macro avg': {'precision': 0.5719910014104991, 'recall': 0.569107620804378, 'f1-score': 0.5703548526828492, 'support': 151134}, 'weighted avg': {'precision': 0.611474303768883, 'recall': 0.6146796882236956, 'f1-score': 0.6128972809249196, 'support': 151134}}
[[18393 10059  7939]
 [10580 57287  9758]
 [ 7469 12430 17219]]
testing model on single stock: results/universal/W8/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
10609/10609 - 76s - 76s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0895123
{'0': {'precision': 0.43322555779195754, 'recall': 0.5556579084385438, 'f1-score': 0.48686263962408965, 'support': 873883}, '1': {'precision': 0.5359795092307186, 'recall': 0.207778484148128, 'f1-score': 0.2994657158748424, 'support': 940646}, '2': {'precision': 0.4327725491024905, 'recall': 0.5907864702220378, 'f1-score': 0.4995826559409947, 'support': 901153}, 'accuracy': 0.4468177791066848, 'macro avg': {'precision': 0.4673258720417222, 'recall': 0.45140762093623654, 'f1-score': 0.42863700381330894, 'support': 2715682}, 'weighted avg': {'precision': 0.4686666968006948, 'recall': 0.4468177791066848, 'f1-score': 0.4261738381101398, 'support': 2715682}}
[[485580  80733 307570]
 [354977 195446 390223]
 [280291  88473 532389]]
Evaluating performance on  train set...
3903/3903 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0567948
{'0': {'precision': 0.4605527254077139, 'recall': 0.5553593144644551, 'f1-score': 0.5035322662173546, 'support': 336321}, '1': {'precision': 0.5185096392798461, 'recall': 0.2723149302591253, 'f1-score': 0.3570903628891802, 'support': 325634}, '2': {'precision': 0.45355866411039314, 'recall': 0.5684350415890457, 'f1-score': 0.5045405596117947, 'support': 337108}, 'accuracy': 0.4675160625506099, 'macro avg': {'precision': 0.477540342932651, 'recall': 0.4653697621042087, 'f1-score': 0.45505439623944316, 'support': 999063}, 'weighted avg': {'precision': 0.47708320214043315, 'recall': 0.4675160625506099, 'f1-score': 0.4561413019050401, 'support': 999063}}
[[186779  39553 109989]
 [116082  88675 120877]
 [102693  42791 191624]]
Evaluating performance on  val set...
1144/1144 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0778489
{'0': {'precision': 0.4593856361208048, 'recall': 0.5362826161305249, 'f1-score': 0.49486469051232435, 'support': 99414}, '1': {'precision': 0.48442541840554143, 'recall': 0.23949249159824734, 'f1-score': 0.3205232218853637, 'support': 94028}, '2': {'precision': 0.4403806536912339, 'recall': 0.5775725620267967, 'f1-score': 0.49973177252565604, 'support': 99191}, 'accuracy': 0.4549145175014438, 'macro avg': {'precision': 0.4613972360725267, 'recall': 0.451115889918523, 'f1-score': 0.4383732283077813, 'support': 292633}, 'weighted avg': {'precision': 0.46098941093942625, 'recall': 0.4549145175014438, 'f1-score': 0.4404955357004218, 'support': 292633}}
[[53314 11663 34437]
 [33144 22519 38365]
 [29597 12304 57290]]
training model: results/universal/W8/deepVOL_L2/h20
Epoch 1/50
7696/7696 - 247s - loss: 2.9079 - accuracy20: 0.4945 - val_loss: 2.9858 - val_accuracy20: 0.5099 - 247s/epoch - 32ms/step
Epoch 2/50
7696/7696 - 245s - loss: 2.8223 - accuracy20: 0.5218 - val_loss: 3.0794 - val_accuracy20: 0.5103 - 245s/epoch - 32ms/step
Epoch 3/50
7696/7696 - 247s - loss: 2.7897 - accuracy20: 0.5300 - val_loss: 3.0618 - val_accuracy20: 0.5186 - 247s/epoch - 32ms/step
Epoch 4/50
7696/7696 - 248s - loss: 2.7727 - accuracy20: 0.5342 - val_loss: 3.0393 - val_accuracy20: 0.5224 - 248s/epoch - 32ms/step
Epoch 5/50
7696/7696 - 250s - loss: 2.7615 - accuracy20: 0.5361 - val_loss: 3.0062 - val_accuracy20: 0.5286 - 250s/epoch - 32ms/step
Epoch 6/50
7696/7696 - 247s - loss: 2.7528 - accuracy20: 0.5379 - val_loss: 3.0305 - val_accuracy20: 0.5247 - 247s/epoch - 32ms/step
Epoch 7/50
7696/7696 - 253s - loss: 2.7450 - accuracy20: 0.5392 - val_loss: 3.0294 - val_accuracy20: 0.5276 - 253s/epoch - 33ms/step
Epoch 8/50
7696/7696 - 250s - loss: 2.7390 - accuracy20: 0.5404 - val_loss: 3.0085 - val_accuracy20: 0.5280 - 250s/epoch - 33ms/step
Epoch 9/50
7696/7696 - 258s - loss: 2.7333 - accuracy20: 0.5416 - val_loss: 2.9776 - val_accuracy20: 0.5313 - 258s/epoch - 34ms/step
Epoch 10/50
7696/7696 - 246s - loss: 2.7292 - accuracy20: 0.5427 - val_loss: 2.9644 - val_accuracy20: 0.5315 - 246s/epoch - 32ms/step
Epoch 11/50
7696/7696 - 249s - loss: 2.7242 - accuracy20: 0.5436 - val_loss: 2.9557 - val_accuracy20: 0.5328 - 249s/epoch - 32ms/step
Epoch 12/50
7696/7696 - 246s - loss: 2.7205 - accuracy20: 0.5439 - val_loss: 2.9597 - val_accuracy20: 0.5335 - 246s/epoch - 32ms/step
Epoch 13/50
7696/7696 - 245s - loss: 2.7176 - accuracy20: 0.5453 - val_loss: 2.9313 - val_accuracy20: 0.5356 - 245s/epoch - 32ms/step
Epoch 14/50
7696/7696 - 251s - loss: 2.7142 - accuracy20: 0.5458 - val_loss: 2.9353 - val_accuracy20: 0.5347 - 251s/epoch - 33ms/step
Epoch 15/50
7696/7696 - 246s - loss: 2.7112 - accuracy20: 0.5464 - val_loss: 2.9368 - val_accuracy20: 0.5360 - 246s/epoch - 32ms/step
Epoch 16/50
7696/7696 - 244s - loss: 2.7086 - accuracy20: 0.5469 - val_loss: 2.9296 - val_accuracy20: 0.5369 - 244s/epoch - 32ms/step
Epoch 17/50
7696/7696 - 248s - loss: 2.7060 - accuracy20: 0.5476 - val_loss: 2.9368 - val_accuracy20: 0.5367 - 248s/epoch - 32ms/step
Epoch 18/50
7696/7696 - 244s - loss: 2.7038 - accuracy20: 0.5484 - val_loss: 2.9310 - val_accuracy20: 0.5367 - 244s/epoch - 32ms/step
Epoch 19/50
7696/7696 - 245s - loss: 2.7016 - accuracy20: 0.5487 - val_loss: 2.9285 - val_accuracy20: 0.5369 - 245s/epoch - 32ms/step
Epoch 20/50
7696/7696 - 244s - loss: 2.6998 - accuracy20: 0.5494 - val_loss: 2.9338 - val_accuracy20: 0.5373 - 244s/epoch - 32ms/step
Epoch 21/50
7696/7696 - 248s - loss: 2.6978 - accuracy20: 0.5497 - val_loss: 2.9112 - val_accuracy20: 0.5386 - 248s/epoch - 32ms/step
Epoch 22/50
7696/7696 - 244s - loss: 2.6955 - accuracy20: 0.5502 - val_loss: 2.9300 - val_accuracy20: 0.5385 - 244s/epoch - 32ms/step
Epoch 23/50
7696/7696 - 247s - loss: 2.6938 - accuracy20: 0.5504 - val_loss: 2.9098 - val_accuracy20: 0.5393 - 247s/epoch - 32ms/step
Epoch 24/50
7696/7696 - 255s - loss: 2.6921 - accuracy20: 0.5512 - val_loss: 2.8981 - val_accuracy20: 0.5391 - 255s/epoch - 33ms/step
Epoch 25/50
7696/7696 - 249s - loss: 2.6902 - accuracy20: 0.5517 - val_loss: 2.9102 - val_accuracy20: 0.5388 - 249s/epoch - 32ms/step
Epoch 26/50
7696/7696 - 246s - loss: 2.6884 - accuracy20: 0.5519 - val_loss: 2.9082 - val_accuracy20: 0.5392 - 246s/epoch - 32ms/step
Epoch 27/50
7696/7696 - 247s - loss: 2.6868 - accuracy20: 0.5523 - val_loss: 2.9210 - val_accuracy20: 0.5387 - 247s/epoch - 32ms/step
Epoch 28/50
7696/7696 - 240s - loss: 2.6856 - accuracy20: 0.5526 - val_loss: 2.9225 - val_accuracy20: 0.5379 - 240s/epoch - 31ms/step
Epoch 29/50
7696/7696 - 243s - loss: 2.6844 - accuracy20: 0.5527 - val_loss: 2.9162 - val_accuracy20: 0.5383 - 243s/epoch - 32ms/step
Epoch 30/50
7696/7696 - 246s - loss: 2.6827 - accuracy20: 0.5530 - val_loss: 2.9018 - val_accuracy20: 0.5381 - 246s/epoch - 32ms/step
Epoch 31/50
7696/7696 - 247s - loss: 2.6813 - accuracy20: 0.5534 - val_loss: 2.8900 - val_accuracy20: 0.5373 - 247s/epoch - 32ms/step
Epoch 32/50
7696/7696 - 243s - loss: 2.6801 - accuracy20: 0.5538 - val_loss: 2.8937 - val_accuracy20: 0.5376 - 243s/epoch - 32ms/step
Epoch 33/50
7696/7696 - 244s - loss: 2.6791 - accuracy20: 0.5542 - val_loss: 2.8842 - val_accuracy20: 0.5389 - 244s/epoch - 32ms/step
Epoch 34/50
7696/7696 - 245s - loss: 2.6772 - accuracy20: 0.5547 - val_loss: 2.8967 - val_accuracy20: 0.5383 - 245s/epoch - 32ms/step
Epoch 35/50
7696/7696 - 244s - loss: 2.6759 - accuracy20: 0.5550 - val_loss: 2.8924 - val_accuracy20: 0.5375 - 244s/epoch - 32ms/step
Epoch 36/50
7696/7696 - 248s - loss: 2.6746 - accuracy20: 0.5550 - val_loss: 2.8957 - val_accuracy20: 0.5377 - 248s/epoch - 32ms/step
Epoch 37/50
7696/7696 - 244s - loss: 2.6735 - accuracy20: 0.5555 - val_loss: 2.8941 - val_accuracy20: 0.5376 - 244s/epoch - 32ms/step
Epoch 38/50
7696/7696 - 253s - loss: 2.6723 - accuracy20: 0.5557 - val_loss: 2.8902 - val_accuracy20: 0.5369 - 253s/epoch - 33ms/step
Epoch 39/50
7696/7696 - 246s - loss: 2.6711 - accuracy20: 0.5561 - val_loss: 2.8761 - val_accuracy20: 0.5378 - 246s/epoch - 32ms/step
Epoch 40/50
7696/7696 - 246s - loss: 2.6703 - accuracy20: 0.5563 - val_loss: 2.8843 - val_accuracy20: 0.5379 - 246s/epoch - 32ms/step
Epoch 41/50
7696/7696 - 247s - loss: 2.6685 - accuracy20: 0.5567 - val_loss: 2.8792 - val_accuracy20: 0.5377 - 247s/epoch - 32ms/step
Epoch 42/50
7696/7696 - 249s - loss: 2.6682 - accuracy20: 0.5569 - val_loss: 2.8883 - val_accuracy20: 0.5374 - 249s/epoch - 32ms/step
Epoch 43/50
7696/7696 - 246s - loss: 2.6666 - accuracy20: 0.5569 - val_loss: 2.8796 - val_accuracy20: 0.5378 - 246s/epoch - 32ms/step
Epoch 44/50
7696/7696 - 249s - loss: 2.6657 - accuracy20: 0.5574 - val_loss: 2.8832 - val_accuracy20: 0.5361 - 249s/epoch - 32ms/step
Epoch 45/50
7696/7696 - 248s - loss: 2.6647 - accuracy20: 0.5576 - val_loss: 2.8813 - val_accuracy20: 0.5370 - 248s/epoch - 32ms/step
Epoch 46/50
7696/7696 - 251s - loss: 2.6633 - accuracy20: 0.5581 - val_loss: 2.8835 - val_accuracy20: 0.5360 - 251s/epoch - 33ms/step
Epoch 47/50
7696/7696 - 245s - loss: 2.6623 - accuracy20: 0.5586 - val_loss: 2.8738 - val_accuracy20: 0.5365 - 245s/epoch - 32ms/step
Epoch 48/50
7696/7696 - 255s - loss: 2.6617 - accuracy20: 0.5584 - val_loss: 2.8694 - val_accuracy20: 0.5373 - 255s/epoch - 33ms/step
Epoch 49/50
7696/7696 - 245s - loss: 2.6605 - accuracy20: 0.5586 - val_loss: 2.8814 - val_accuracy20: 0.5370 - 245s/epoch - 32ms/step
Epoch 50/50
7696/7696 - 248s - loss: 2.6597 - accuracy20: 0.5591 - val_loss: 2.8656 - val_accuracy20: 0.5372 - 248s/epoch - 32ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 378s - 378s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9360185
{'0': {'precision': 0.43987787090289376, 'recall': 0.5695829427111366, 'f1-score': 0.496397539683352, 'support': 1532811}, '1': {'precision': 0.7763557889242405, 'recall': 0.5905668242965328, 'f1-score': 0.6708353031177293, 'support': 2876147}, '2': {'precision': 0.45109778764921793, 'recall': 0.5197833776844222, 'f1-score': 0.4830109803390919, 'support': 1552010}, 'accuracy': 0.5667416768551685, 'macro avg': {'precision': 0.5557771491587841, 'recall': 0.5599777148973639, 'f1-score': 0.5500812743800577, 'support': 5960968}, 'weighted avg': {'precision': 0.6051485748343366, 'recall': 0.5667416768551685, 'f1-score': 0.5770778211444517, 'support': 5960968}}
[[ 873063  235305  424443]
 [ 620418 1698557  557172]
 [ 491304  253997  806709]]
Evaluating performance on  train set...
7696/7696 - 129s - 129s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9771734
{'0': {'precision': 0.44743772083824085, 'recall': 0.5756250792907698, 'f1-score': 0.5035006130664027, 'support': 559649}, '1': {'precision': 0.7213269354338562, 'recall': 0.5305083629968542, 'f1-score': 0.6113743112728397, 'support': 850652}, '2': {'precision': 0.4555455107922433, 'recall': 0.5082504886628432, 'f1-score': 0.4804569195124817, 'support': 559179}, 'accuracy': 0.5370092613278632, 'macro avg': {'precision': 0.5414367223547801, 'recall': 0.5381279769834891, 'f1-score': 0.531777281283908, 'support': 1969480}, 'weighted avg': {'precision': 0.5680371247686583, 'recall': 0.5370092613278632, 'f1-score': 0.543550487961763, 'support': 1969480}}
[[322148  80937 156564]
 [216267 451278 183107]
 [181569  93407 284203]]
Evaluating performance on  val set...
2338/2338 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97595435
{'0': {'precision': 0.4402303648224662, 'recall': 0.5662912265249365, 'f1-score': 0.49536660791370707, 'support': 165761}, '1': {'precision': 0.7346444298119265, 'recall': 0.5334924744197515, 'f1-score': 0.618115084217201, 'support': 267687}, '2': {'precision': 0.44472841434363514, 'recall': 0.5146289219385147, 'f1-score': 0.47713212954839723, 'support': 164332}, 'accuracy': 0.5374017196962093, 'macro avg': {'precision': 0.5398677363260093, 'recall': 0.5381375409610676, 'f1-score': 0.5302046072264351, 'support': 597780}, 'weighted avg': {'precision': 0.5733060637229754, 'recall': 0.5374017196962093, 'f1-score': 0.5453208771725068, 'support': 597780}}
[[ 93869  24424  47468]
 [ 66755 142809  58123]
 [ 52603  27159  84570]]
testing model out of sample: results/universal/W8/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 227s - 227s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7872816
{'0': {'precision': 0.4665653547850897, 'recall': 0.5452648774858503, 'f1-score': 0.502854516305681, 'support': 744363}, '1': {'precision': 0.7896539033261798, 'recall': 0.7743957686580142, 'f1-score': 0.7819504103911324, 'support': 2133413}, '2': {'precision': 0.49473439618681314, 'recall': 0.4382357959392595, 'f1-score': 0.4647743812637464, 'support': 738486}, 'accuracy': 0.6585839189748973, 'macro avg': {'precision': 0.5836512180993608, 'recall': 0.5859654806943747, 'f1-score': 0.5831931026535199, 'support': 3616262}, 'weighted avg': {'precision': 0.6629238465971559, 'recall': 0.6585839189748973, 'f1-score': 0.6597306392420023, 'support': 3616262}}
[[ 405875  204467  134021]
 [ 284808 1652106  196499]
 [ 179238  235617  323631]]
Evaluating performance on  train set...
4550/4550 - 75s - 75s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8240245
{'0': {'precision': 0.4824415971070882, 'recall': 0.5518834139710289, 'f1-score': 0.5148314365434734, 'support': 273652}, '1': {'precision': 0.7569055496921154, 'recall': 0.757560390778154, 'f1-score': 0.7572328286615158, 'support': 617230}, '2': {'precision': 0.5155005871109855, 'recall': 0.4401889713066612, 'f1-score': 0.4748773723636292, 'support': 273269}, 'accuracy': 0.634714053417469, 'macro avg': {'precision': 0.5849492446367297, 'recall': 0.583210925351948, 'f1-score': 0.5823138791895395, 'support': 1164151}, 'weighted avg': {'precision': 0.6357218696777697, 'recall': 0.634714053417469, 'f1-score': 0.6339733726777528, 'support': 1164151}}
[[151024  69510  53118]
 [ 89703 467589  59938]
 [ 72314  80665 120290]]
Evaluating performance on  val set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8123808
{'0': {'precision': 0.4790410496358111, 'recall': 0.5473796767863836, 'f1-score': 0.5109353857868282, 'support': 90714}, '1': {'precision': 0.773490203301637, 'recall': 0.7677909469459769, 'f1-score': 0.770630037940827, 'support': 218777}, '2': {'precision': 0.5082467929138669, 'recall': 0.4453474907692644, 'f1-score': 0.4747227154959099, 'support': 91542}, 'accuracy': 0.6443310151533664, 'macro avg': {'precision': 0.5869260152837716, 'recall': 0.5868393715005417, 'f1-score': 0.5854293797411884, 'support': 401033}, 'weighted avg': {'precision': 0.6463396376390631, 'recall': 0.6443310151533664, 'f1-score': 0.6443414562362031, 'support': 401033}}
[[ 49655  22467  18592]
 [ 29949 167975  20853]
 [ 24051  26723  40768]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0727755
{'0': {'precision': 0.42593409444732744, 'recall': 0.600695270332083, 'f1-score': 0.4984400501005807, 'support': 54655}, '1': {'precision': 0.6906041810245808, 'recall': 0.26395181399922735, 'f1-score': 0.3819288282450992, 'support': 56946}, '2': {'precision': 0.4331936015980871, 'recall': 0.5368227594096356, 'f1-score': 0.4794727056498216, 'support': 53323}, 'accuracy': 0.4637711915791516, 'macro avg': {'precision': 0.516577292356665, 'recall': 0.4671566145803154, 'f1-score': 0.45328052799850055, 'support': 164924}, 'weighted avg': {'precision': 0.5196681868173174, 'recall': 0.4637711915791516, 'f1-score': 0.45207782417876163, 'support': 164924}}
[[32831  3340 18484]
 [22945 15031 18970]
 [21304  3394 28625]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.071449
{'0': {'precision': 0.41858159543957796, 'recall': 0.6254695518755622, 'f1-score': 0.5015272357033769, 'support': 18901}, '1': {'precision': 0.6655042138913106, 'recall': 0.24241782670830467, 'f1-score': 0.35538312318137727, 'support': 18893}, '2': {'precision': 0.46057469699033093, 'recall': 0.5240702479338843, 'f1-score': 0.490275193892097, 'support': 19360}, 'accuracy': 0.46449942261259053, 'macro avg': {'precision': 0.5148868354404065, 'recall': 0.463985875505917, 'f1-score': 0.44906185092561707, 'support': 57154}, 'weighted avg': {'precision': 0.5144295759209294, 'recall': 0.46449942261259053, 'f1-score': 0.4494059450265298, 'support': 57154}}
[[11822  1133  5946]
 [ 8376  4580  5937]
 [ 8045  1169 10146]]
Evaluating performance on  val set...
68/68 - 1s - 706ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901182
{'0': {'precision': 0.42755765819041985, 'recall': 0.6043129388164493, 'f1-score': 0.5007965643831821, 'support': 5982}, '1': {'precision': 0.5365079365079365, 'recall': 0.19270239452679588, 'f1-score': 0.2835570469798657, 'support': 5262}, '2': {'precision': 0.4553105049332559, 'recall': 0.5236108793592524, 'f1-score': 0.4870779976717113, 'support': 5993}, 'accuracy': 0.4506004525149388, 'macro avg': {'precision': 0.4731253665438708, 'recall': 0.44020873756749923, 'f1-score': 0.42381053634491966, 'support': 17237}, 'weighted avg': {'precision': 0.47046646918053353, 'recall': 0.4506004525149388, 'f1-score': 0.4297093850086915, 'support': 17237}}
[[3615  429 1938]
 [2432 1014 1816]
 [2408  447 3138]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5361453
{'0': {'precision': 0.6149316913604003, 'recall': 0.4634280742459397, 'f1-score': 0.528537170263789, 'support': 68960}, '1': {'precision': 0.8548679375613424, 'recall': 0.9282254064022748, 'f1-score': 0.8900376880991179, 'support': 421319}, '2': {'precision': 0.6106088503630759, 'recall': 0.43725278144027496, 'f1-score': 0.5095909805072601, 'support': 67501}, 'accuracy': 0.8113449747212162, 'macro avg': {'precision': 0.6934694930949395, 'recall': 0.609635420696163, 'f1-score': 0.6427219462900556, 'support': 557780}, 'weighted avg': {'precision': 0.7956443437017792, 'recall': 0.8113449747212162, 'f1-score': 0.7993036909692778, 'support': 557780}}
[[ 31958  32626   4376]
 [ 15794 391079  14446]
 [  4218  33768  29515]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5962324
{'0': {'precision': 0.5995516396433971, 'recall': 0.4752851711026616, 'f1-score': 0.5302349171219771, 'support': 24196}, '1': {'precision': 0.8209384029419491, 'recall': 0.9210126442391815, 'f1-score': 0.8681009153208832, 'support': 108587}, '2': {'precision': 0.6451933839074742, 'recall': 0.4269256089532587, 'f1-score': 0.5138414301985836, 'support': 24304}, 'accuracy': 0.7759139839706659, 'macro avg': {'precision': 0.6885611421642736, 'recall': 0.6077411414317005, 'f1-score': 0.6373924208804813, 'support': 157087}, 'weighted avg': {'precision': 0.7596476464351367, 'recall': 0.7759139839706659, 'f1-score': 0.7612497550158732, 'support': 157087}}
[[ 11500  10333   2363]
 [  5234 100010   3343]
 [  2447  11481  10376]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5968657
{'0': {'precision': 0.5294953802416489, 'recall': 0.4412853546571894, 'f1-score': 0.4813827639124465, 'support': 6753}, '1': {'precision': 0.8344447059438822, 'recall': 0.9109074819445634, 'f1-score': 0.8710012010044764, 'support': 35031}, '2': {'precision': 0.5996589213387338, 'recall': 0.41514167650531286, 'f1-score': 0.4906252725211477, 'support': 6776}, 'accuracy': 0.7764209225700165, 'macro avg': {'precision': 0.6545330025080883, 'recall': 0.5891115043690219, 'f1-score': 0.6143364124793569, 'support': 48560}, 'weighted avg': {'precision': 0.75927519867552, 'recall': 0.7764209225700165, 'f1-score': 0.7637417158915127, 'support': 48560}}
[[ 2980  3107   666]
 [ 1909 31910  1212]
 [  739  3224  2813]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0567617
{'0': {'precision': 0.41416712884249957, 'recall': 0.5943840603348165, 'f1-score': 0.48817420938132955, 'support': 76639}, '1': {'precision': 0.6841717692393048, 'recall': 0.46738104262136926, 'f1-score': 0.5553699518522158, 'support': 145115}, '2': {'precision': 0.3963981300159605, 'recall': 0.4625473853835079, 'f1-score': 0.42692560895325876, 'support': 75709}, 'accuracy': 0.49887212863448566, 'macro avg': {'precision': 0.49824567603258824, 'recall': 0.5081041627798979, 'f1-score': 0.490156590062268, 'support': 297463}, 'weighted avg': {'precision': 0.541364293730314, 'recall': 0.49887212863448566, 'f1-score': 0.5053663975823961, 'support': 297463}}
[[45553 14062 17024]
 [40991 67824 36300]
 [23443 17247 35019]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.156203
{'0': {'precision': 0.43627692387444594, 'recall': 0.6065804173123356, 'f1-score': 0.5075229911050806, 'support': 27749}, '1': {'precision': 0.5211772143007656, 'recall': 0.26619789050728276, 'f1-score': 0.3524019852295124, 'support': 27874}, '2': {'precision': 0.4513717331946431, 'recall': 0.49665581744697596, 'f1-score': 0.4729322412002112, 'support': 27959}, 'accuracy': 0.4562944174583044, 'macro avg': {'precision': 0.46960862378995155, 'recall': 0.4564780417555314, 'f1-score': 0.444285739178268, 'support': 83582}, 'weighted avg': {'precision': 0.4696399263047135, 'recall': 0.4562944174583044, 'f1-score': 0.4442202980088896, 'support': 83582}}
[[16832  3201  7716]
 [11292  7420  9162]
 [10457  3616 13886]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1144717
{'0': {'precision': 0.4454209065679926, 'recall': 0.5880317524933849, 'f1-score': 0.5068865689972805, 'support': 9826}, '1': {'precision': 0.5746865830888237, 'recall': 0.3601939312881384, 'f1-score': 0.44283438672216235, 'support': 11963}, '2': {'precision': 0.45151033386327505, 'recall': 0.5110466859942018, 'f1-score': 0.47943728018757326, 'support': 10003}, 'accuracy': 0.47807624559637646, 'macro avg': {'precision': 0.49053927450669715, 'recall': 0.48642412325857504, 'f1-score': 0.476386078635672, 'support': 31792}, 'weighted avg': {'precision': 0.495978211218641, 'recall': 0.47807624559637646, 'f1-score': 0.47414778274537, 'support': 31792}}
[[5778 1472 2576]
 [4020 4309 3634]
 [3174 1717 5112]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1223/1223 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2743443
{'0': {'precision': 0.3515198307168797, 'recall': 0.35351124403289813, 'f1-score': 0.35251272492651803, 'support': 104322}, '1': {'precision': 0.37768693129368325, 'recall': 0.02653645519656805, 'f1-score': 0.04958878019219115, 'support': 107927}, '2': {'precision': 0.3288171260166453, 'recall': 0.6542705191300207, 'f1-score': 0.43767278085496863, 'support': 100784}, 'accuracy': 0.33760977277156085, 'macro avg': {'precision': 0.35267462934240273, 'recall': 0.3447727394531623, 'f1-score': 0.27992476199122596, 'support': 313033}, 'weighted avg': {'precision': 0.35323232516137676, 'recall': 0.33760977277156085, 'f1-score': 0.275489211409896, 'support': 313033}}
[[36879  2552 64891]
 [35357  2864 69706]
 [32677  2167 65940]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2512476
{'0': {'precision': 0.36758297565610565, 'recall': 0.35655490227236614, 'f1-score': 0.36198496434678806, 'support': 31465}, '1': {'precision': 0.3562062937062937, 'recall': 0.027080910450240903, 'f1-score': 0.05033505234227836, 'support': 30095}, '2': {'precision': 0.33538645282375024, 'recall': 0.6583274724538665, 'f1-score': 0.444381647808837, 'support': 29859}, 'accuracy': 0.3466566031131384, 'macro avg': {'precision': 0.3530585740620498, 'recall': 0.3473210950588245, 'f1-score': 0.28556722149930114, 'support': 91419}, 'weighted avg': {'precision': 0.35332185686755085, 'recall': 0.3466566031131384, 'f1-score': 0.28630243084409823, 'support': 91419}}
[[11219   748 19498]
 [ 9825   815 19455]
 [ 9477   725 19657]]
Evaluating performance on  val set...
99/99 - 1s - 870ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.252684
{'0': {'precision': 0.3643503093764874, 'recall': 0.3556742943431293, 'f1-score': 0.35996003056486214, 'support': 8609}, '1': {'precision': 0.34265734265734266, 'recall': 0.02363439044977692, 'f1-score': 0.04421883812746756, 'support': 8293}, '2': {'precision': 0.3415428080088441, 'recall': 0.6655098133078028, 'f1-score': 0.4514165110804449, 'support': 8356}, 'accuracy': 0.34915670282682715, 'macro avg': {'precision': 0.3495168200142247, 'recall': 0.3482728327002363, 'f1-score': 0.28519845992425824, 'support': 25258}, 'weighted avg': {'precision': 0.34968251087977764, 'recall': 0.34915670282682715, 'f1-score': 0.2865483844450148, 'support': 25258}}
[[3062  174 5373]
 [2749  196 5348]
 [2593  202 5561]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2135288
{'0': {'precision': 0.4120994436976308, 'recall': 0.6467159736177238, 'f1-score': 0.5034140769011086, 'support': 119929}, '1': {'precision': 0.5885990393741551, 'recall': 0.16051106283186534, 'f1-score': 0.25223703995858704, 'support': 127499}, '2': {'precision': 0.4371695700049928, 'recall': 0.5249632470700318, 'f1-score': 0.477060865022204, 'support': 121759}, 'accuracy': 0.43865033167473394, 'macro avg': {'precision': 0.47928935102559295, 'recall': 0.4440634278398736, 'f1-score': 0.4109039939606332, 'support': 369187}, 'weighted avg': {'precision': 0.481321912143755, 'recall': 0.43865033167473394, 'f1-score': 0.4079785340507426, 'support': 369187}}
[[77560  6257 36112]
 [60854 20465 46180]
 [49793  8047 63919]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.172428
{'0': {'precision': 0.41788764334078515, 'recall': 0.6243512110726643, 'f1-score': 0.5006696019962811, 'support': 41616}, '1': {'precision': 0.5630773672055427, 'recall': 0.18621413909971837, 'f1-score': 0.2798722961581232, 'support': 41898}, '2': {'precision': 0.44746214608328855, 'recall': 0.5257141521342746, 'f1-score': 0.4834420714339457, 'support': 42778}, 'accuracy': 0.44558641877553606, 'macro avg': {'precision': 0.4761423855432055, 'recall': 0.4454265007688858, 'f1-score': 0.42132798986278336, 'support': 126292}, 'weighted avg': {'precision': 0.476072620447842, 'recall': 0.44558641877553606, 'f1-score': 0.42158363596198967, 'support': 126292}}
[[25983  2844 12789]
 [19115  7802 14981]
 [17079  3210 22489]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1991719
{'0': {'precision': 0.4266062299056554, 'recall': 0.6331351689612015, 'f1-score': 0.5097458827974934, 'support': 12784}, '1': {'precision': 0.5606573223779604, 'recall': 0.17770968977403293, 'f1-score': 0.269877275635433, 'support': 13055}, '2': {'precision': 0.4359912216532553, 'recall': 0.5326184092940125, 'f1-score': 0.47948511665325827, 'support': 12309}, 'accuracy': 0.44484638775296215, 'macro avg': {'precision': 0.47441825797895704, 'recall': 0.4478210893430823, 'f1-score': 0.4197027583620616, 'support': 38148}, 'weighted avg': {'precision': 0.475509367046453, 'recall': 0.44484638775296215, 'f1-score': 0.4178940311415721, 'support': 38148}}
[[8094  883 3807]
 [6061 2320 4674]
 [4818  935 6556]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
5521/5521 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.53801745
{'0': {'precision': 0.5686578315614129, 'recall': 0.5253762589113953, 'f1-score': 0.5461609043961086, 'support': 176740}, '1': {'precision': 0.8635265333903598, 'recall': 0.8911432319401019, 'f1-score': 0.8771175534407075, 'support': 1053522}, '2': {'precision': 0.5701229062632442, 'recall': 0.5070801101350465, 'f1-score': 0.5367567333130937, 'support': 183048}, 'accuracy': 0.7956598340066935, 'macro avg': {'precision': 0.6674357570716722, 'recall': 0.6411998669955147, 'f1-score': 0.6533450637166367, 'support': 1413310}, 'weighted avg': {'precision': 0.7886512112744671, 'recall': 0.7956598340066935, 'f1-score': 0.7916475252410472, 'support': 1413310}}
[[ 92855  69965  13920]
 [ 58616 938839  56067]
 [ 11817  78411  92820]]
Evaluating performance on  train set...
1289/1289 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5729426
{'0': {'precision': 0.5142155434375391, 'recall': 0.5452418785310734, 'f1-score': 0.5292744060498297, 'support': 45312}, '1': {'precision': 0.8525299790493116, 'recall': 0.8757500010467565, 'f1-score': 0.8639840056508962, 'support': 238833}, '2': {'precision': 0.5830352721069719, 'recall': 0.4648678293298234, 'f1-score': 0.5172889382529202, 'support': 45585}, 'accuracy': 0.7735268249780123, 'macro avg': {'precision': 0.6499269315312741, 'recall': 0.6286199029692178, 'f1-score': 0.6368491166512154, 'support': 329730}, 'weighted avg': {'precision': 0.7687807905544607, 'recall': 0.7735268249780123, 'f1-score': 0.7700572897789395, 'support': 329730}}
[[ 24706  16790   3816]
 [ 18336 209158  11339]
 [  5004  19390  21191]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5447523
{'0': {'precision': 0.4754390273854845, 'recall': 0.5632911392405063, 'f1-score': 0.5156499733617474, 'support': 13746}, '1': {'precision': 0.8709956197466556, 'recall': 0.8682819175301532, 'f1-score': 0.8696366516158011, 'support': 84734}, '2': {'precision': 0.5853440571939231, 'recall': 0.48641021832764, 'f1-score': 0.531310837118754, 'support': 13466}, 'accuracy': 0.7848962892823326, 'macro avg': {'precision': 0.6439262347753544, 'recall': 0.6393277583660998, 'f1-score': 0.6388658206987675, 'support': 111946}, 'weighted avg': {'precision': 0.7880636270007625, 'recall': 0.7848962892823326, 'f1-score': 0.7854728914341289, 'support': 111946}}
[[ 7743  5122   881]
 [ 7402 73573  3759]
 [ 1141  5775  6550]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
5918/5918 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.554067
{'0': {'precision': 0.5288879518296427, 'recall': 0.47725873781518247, 'f1-score': 0.5017486991384458, 'support': 178706}, '1': {'precision': 0.8595526257951026, 'recall': 0.91397449805881, 'f1-score': 0.8859285760559054, 'support': 1159598}, '2': {'precision': 0.5711422181727822, 'recall': 0.3902231981166244, 'f1-score': 0.4636591647222577, 'support': 176704}, 'accuracy': 0.8013726660189253, 'macro avg': {'precision': 0.6531942652658426, 'recall': 0.5938188113302056, 'f1-score': 0.6171121466388696, 'support': 1515008}, 'weighted avg': {'precision': 0.7869094226607521, 'recall': 0.8013726660189253, 'f1-score': 0.7913601360577586, 'support': 1515008}}
[[  85289   79375   14042]
 [  62021 1059843   37734]
 [  13951   93799   68954]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59037113
{'0': {'precision': 0.5397738437628397, 'recall': 0.47157237612173236, 'f1-score': 0.5033734819331301, 'support': 64075}, '1': {'precision': 0.8395608326568799, 'recall': 0.9075708990963228, 'f1-score': 0.8722421622734231, 'support': 336182}, '2': {'precision': 0.5722624484794475, 'recall': 0.4012058354940489, 'f1-score': 0.471705216377276, 'support': 64022}, 'accuracy': 0.7775733987537666, 'macro avg': {'precision': 0.650532374966389, 'recall': 0.5934497035707014, 'f1-score': 0.6157736201946098, 'support': 464279}, 'weighted avg': {'precision': 0.7613280707503685, 'recall': 0.7775733987537666, 'f1-score': 0.7661024552374224, 'support': 464279}}
[[ 30216  27094   6765]
 [ 18639 305109  12434]
 [  7124  31212  25686]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5425108
{'0': {'precision': 0.5211346285146794, 'recall': 0.4625130832369305, 'f1-score': 0.4900770487975718, 'support': 18153}, '1': {'precision': 0.8656913023851283, 'recall': 0.9239250623953496, 'f1-score': 0.8938607249150877, 'support': 126612}, '2': {'precision': 0.5866573767636301, 'recall': 0.3751183382524921, 'f1-score': 0.4576242399538028, 'support': 17957}, 'accuracy': 0.8118877594916484, 'macro avg': {'precision': 0.6578277692211459, 'recall': 0.5871854946282574, 'f1-score': 0.6138540045554874, 'support': 162722}, 'weighted avg': {'precision': 0.7964606543894331, 'recall': 0.8118877594916484, 'f1-score': 0.8006749010374863, 'support': 162722}}
[[  8396   8440   1317]
 [  6203 116980   3429]
 [  1512   9709   6736]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
3755/3755 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94275045
{'0': {'precision': 0.5031323809459723, 'recall': 0.5201210392681994, 'f1-score': 0.5114856822317385, 'support': 287510}, '1': {'precision': 0.610028312338435, 'recall': 0.6699780935094198, 'f1-score': 0.6385993129722719, 'support': 399425}, '2': {'precision': 0.5263975637798701, 'recall': 0.4324139037589159, 'f1-score': 0.47479954754301845, 'support': 274228}, 'accuracy': 0.557372682885213, 'macro avg': {'precision': 0.5465194190214259, 'recall': 0.5408376788455117, 'f1-score': 0.5416281809156763, 'support': 961163}, 'weighted avg': {'precision': 0.5541922656425416, 'recall': 0.557372682885213, 'f1-score': 0.5538426982790887, 'support': 961163}}
[[149540  83879  54091]
 [ 79223 267606  52596]
 [ 68455  87193 118580]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9408462
{'0': {'precision': 0.5204603285645099, 'recall': 0.5434681394191404, 'f1-score': 0.5317154581688952, 'support': 124574}, '1': {'precision': 0.5888579708658186, 'recall': 0.6377454656556398, 'f1-score': 0.6123274884992332, 'support': 144012}, '2': {'precision': 0.5340425130968982, 'recall': 0.45858651239936893, 'f1-score': 0.4934465691886457, 'support': 123595}, 'accuracy': 0.5513372651913274, 'macro avg': {'precision': 0.5477869375090756, 'recall': 0.5466000391580497, 'f1-score': 0.5458298386189248, 'support': 392181}, 'weighted avg': {'precision': 0.5498568861753493, 'recall': 0.5513372651913274, 'f1-score': 0.5492564822838286, 'support': 392181}}
[[67702 29624 27248]
 [29964 91843 22205]
 [32415 34501 56679]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9969536
{'0': {'precision': 0.49870878776482386, 'recall': 0.5265930691234479, 'f1-score': 0.5122717556465528, 'support': 37773}, '1': {'precision': 0.5506733425414365, 'recall': 0.5778472269402359, 'f1-score': 0.5639331218989314, 'support': 44157}, '2': {'precision': 0.5088052590314215, 'recall': 0.4505113075054068, 'f1-score': 0.4778871344615167, 'support': 37453}, 'accuracy': 0.5216823165777372, 'macro avg': {'precision': 0.519395796445894, 'recall': 0.5183172011896969, 'f1-score': 0.5180306706690003, 'support': 119383}, 'weighted avg': {'precision': 0.5210967490626532, 'recall': 0.5216823165777372, 'f1-score': 0.5205929046574097, 'support': 119383}}
[[19891  9754  8128]
 [10480 25516  8161]
 [ 9514 11066 16873]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
4960/4960 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8414904
{'0': {'precision': 0.493681428973749, 'recall': 0.5240527423879097, 'f1-score': 0.5084139139664184, 'support': 314434}, '1': {'precision': 0.6950058015857667, 'recall': 0.7586545700072176, 'f1-score': 0.7254367496814497, 'support': 644255}, '2': {'precision': 0.5456358587725557, 'recall': 0.40817901482679564, 'f1-score': 0.4670027978228119, 'support': 310991}, 'accuracy': 0.6147115808707706, 'macro avg': {'precision': 0.5781076964440238, 'recall': 0.563628775740641, 'f1-score': 0.56695115382356, 'support': 1269680}, 'weighted avg': {'precision': 0.6085620238911426, 'recall': 0.6147115808707706, 'f1-score': 0.6083915166718018, 'support': 1269680}}
[[164780 101315  48339]
 [ 98121 488767  57367]
 [ 70877 113174 126940]]
Evaluating performance on  train set...
1691/1691 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87626296
{'0': {'precision': 0.5157431906614786, 'recall': 0.5463066003907313, 'f1-score': 0.5305851223524984, 'support': 121311}, '1': {'precision': 0.6509157341858872, 'recall': 0.7408035013488717, 'f1-score': 0.6929568014236641, 'support': 192383}, '2': {'precision': 0.5635758952619622, 'recall': 0.4039110365086026, 'f1-score': 0.47056867959949933, 'support': 119150}, 'accuracy': 0.5935556459140013, 'macro avg': {'precision': 0.5767449400364426, 'recall': 0.5636737127494019, 'f1-score': 0.564703534458554, 'support': 432844}, 'weighted avg': {'precision': 0.588989362940646, 'recall': 0.5935556459140013, 'f1-score': 0.5862324030834967, 'support': 432844}}
[[ 66273  35047  19991]
 [ 32588 142518  17277]
 [ 29639  41385  48126]]
Evaluating performance on  val set...
591/591 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9100097
{'0': {'precision': 0.5049715305515424, 'recall': 0.5405626691532671, 'f1-score': 0.522161319024133, 'support': 43969}, '1': {'precision': 0.6311557788944724, 'recall': 0.7002019875575665, 'f1-score': 0.6638884633062663, 'support': 61885}, '2': {'precision': 0.5400864138262121, 'recall': 0.4223719081272085, 'f1-score': 0.47403056102911106, 'support': 45280}, 'accuracy': 0.5705202006166713, 'macro avg': {'precision': 0.558737907757409, 'recall': 0.5543788549460141, 'f1-score': 0.5533601144531701, 'support': 151134}, 'weighted avg': {'precision': 0.567160807109956, 'recall': 0.5705202006166713, 'f1-score': 0.5657744279333475, 'support': 151134}}
[[23768 11262  8939]
 [11206 43332  7347]
 [12094 14061 19125]]
testing model on single stock: results/universal/W8/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
10609/10609 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1839641
{'0': {'precision': 0.4107663910628906, 'recall': 0.6273921313914433, 'f1-score': 0.4964783239146489, 'support': 895279}, '1': {'precision': 0.4981184513485277, 'recall': 0.10986918790004854, 'f1-score': 0.18002954729583587, 'support': 893954}, '2': {'precision': 0.4341862699616535, 'recall': 0.5394619671455202, 'f1-score': 0.4811326521722179, 'support': 926449}, 'accuracy': 0.4270356396662054, 'macro avg': {'precision': 0.447690370791024, 'recall': 0.4255744288123373, 'f1-score': 0.3858801744609009, 'support': 2715682}, 'weighted avg': {'precision': 0.4475107694866039, 'recall': 0.4270356396662054, 'f1-score': 0.3870738973678006, 'support': 2715682}}
[[561691  46650 286938]
 [431376  98218 364360]
 [374355  52310 499784]]
Evaluating performance on  train set...
3903/3903 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1595253
{'0': {'precision': 0.42031622511849304, 'recall': 0.6195054205003262, 'f1-score': 0.5008323896357811, 'support': 334102}, '1': {'precision': 0.4927715073990469, 'recall': 0.14923509304975313, 'f1-score': 0.22909048507462684, 'support': 329125}, '2': {'precision': 0.4338352737655853, 'recall': 0.5257059993568289, 'f1-score': 0.47537258175258146, 'support': 335836}, 'accuracy': 0.43305176950802904, 'macro avg': {'precision': 0.4489743354277084, 'recall': 0.4314821709689694, 'f1-score': 0.4017651521543298, 'support': 999063}, 'weighted avg': {'precision': 0.4487298767120683, 'recall': 0.43305176950802904, 'f1-score': 0.40275311497647326, 'support': 999063}}
[[206978  23263 103861]
 [153466  49117 126542]
 [131990  27295 176551]]
Evaluating performance on  val set...
1144/1144 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1711373
{'0': {'precision': 0.42156807879567965, 'recall': 0.6094660194174757, 'f1-score': 0.49839558040292425, 'support': 98880}, '1': {'precision': 0.4691173500302969, 'recall': 0.12163775766716943, 'f1-score': 0.19318455920883, 'support': 95472}, '2': {'precision': 0.4224020620207163, 'recall': 0.5369196487622226, 'f1-score': 0.47282567302996775, 'support': 98281}, 'accuracy': 0.42594649270588075, 'macro avg': {'precision': 0.43769583028223097, 'recall': 0.4226744752822893, 'f1-score': 0.38813527088057403, 'support': 292633}, 'weighted avg': {'precision': 0.4373612009953332, 'recall': 0.42594649270588075, 'f1-score': 0.39023230872145254, 'support': 292633}}
[[60264  6251 32365]
 [44067 11613 39792]
 [38621  6891 52769]]
training model: results/universal/W8/deepVOL_L2/h30
Epoch 1/50
7696/7696 - 250s - loss: 2.9761 - accuracy30: 0.4749 - val_loss: 3.0957 - val_accuracy30: 0.4903 - 250s/epoch - 33ms/step
Epoch 2/50
7696/7696 - 244s - loss: 2.9047 - accuracy30: 0.4975 - val_loss: 3.1928 - val_accuracy30: 0.4873 - 244s/epoch - 32ms/step
Epoch 3/50
7696/7696 - 249s - loss: 2.8833 - accuracy30: 0.5036 - val_loss: 3.1578 - val_accuracy30: 0.4951 - 249s/epoch - 32ms/step
Epoch 4/50
7696/7696 - 246s - loss: 2.8681 - accuracy30: 0.5077 - val_loss: 3.1269 - val_accuracy30: 0.4987 - 246s/epoch - 32ms/step
Epoch 5/50
7696/7696 - 247s - loss: 2.8575 - accuracy30: 0.5104 - val_loss: 3.1133 - val_accuracy30: 0.5018 - 247s/epoch - 32ms/step
Epoch 6/50
7696/7696 - 248s - loss: 2.8491 - accuracy30: 0.5124 - val_loss: 3.1077 - val_accuracy30: 0.5001 - 248s/epoch - 32ms/step
Epoch 7/50
7696/7696 - 251s - loss: 2.8418 - accuracy30: 0.5141 - val_loss: 3.0951 - val_accuracy30: 0.5025 - 251s/epoch - 33ms/step
Epoch 8/50
7696/7696 - 250s - loss: 2.8351 - accuracy30: 0.5156 - val_loss: 3.0698 - val_accuracy30: 0.5042 - 250s/epoch - 33ms/step
Epoch 9/50
7696/7696 - 251s - loss: 2.8292 - accuracy30: 0.5169 - val_loss: 3.0613 - val_accuracy30: 0.5028 - 251s/epoch - 33ms/step
Epoch 10/50
7696/7696 - 252s - loss: 2.8238 - accuracy30: 0.5180 - val_loss: 3.0603 - val_accuracy30: 0.5016 - 252s/epoch - 33ms/step
Epoch 11/50
7696/7696 - 258s - loss: 2.8188 - accuracy30: 0.5194 - val_loss: 3.0342 - val_accuracy30: 0.5053 - 258s/epoch - 34ms/step
Epoch 12/50
7696/7696 - 254s - loss: 2.8153 - accuracy30: 0.5199 - val_loss: 3.0349 - val_accuracy30: 0.5040 - 254s/epoch - 33ms/step
Epoch 13/50
7696/7696 - 250s - loss: 2.8119 - accuracy30: 0.5207 - val_loss: 3.0302 - val_accuracy30: 0.5054 - 250s/epoch - 33ms/step
Epoch 14/50
7696/7696 - 245s - loss: 2.8083 - accuracy30: 0.5213 - val_loss: 3.0283 - val_accuracy30: 0.5049 - 245s/epoch - 32ms/step
Epoch 15/50
7696/7696 - 248s - loss: 2.8055 - accuracy30: 0.5222 - val_loss: 3.0228 - val_accuracy30: 0.5054 - 248s/epoch - 32ms/step
Epoch 16/50
7696/7696 - 248s - loss: 2.8027 - accuracy30: 0.5231 - val_loss: 3.0103 - val_accuracy30: 0.5069 - 248s/epoch - 32ms/step
Epoch 17/50
7696/7696 - 248s - loss: 2.8002 - accuracy30: 0.5234 - val_loss: 3.0072 - val_accuracy30: 0.5055 - 248s/epoch - 32ms/step
Epoch 18/50
7696/7696 - 247s - loss: 2.7978 - accuracy30: 0.5241 - val_loss: 3.0032 - val_accuracy30: 0.5077 - 247s/epoch - 32ms/step
Epoch 19/50
7696/7696 - 244s - loss: 2.7956 - accuracy30: 0.5246 - val_loss: 2.9985 - val_accuracy30: 0.5077 - 244s/epoch - 32ms/step
Epoch 20/50
7696/7696 - 245s - loss: 2.7935 - accuracy30: 0.5253 - val_loss: 3.0048 - val_accuracy30: 0.5064 - 245s/epoch - 32ms/step
Epoch 21/50
7696/7696 - 244s - loss: 2.7917 - accuracy30: 0.5256 - val_loss: 2.9819 - val_accuracy30: 0.5089 - 244s/epoch - 32ms/step
Epoch 22/50
7696/7696 - 249s - loss: 2.7894 - accuracy30: 0.5260 - val_loss: 2.9890 - val_accuracy30: 0.5084 - 249s/epoch - 32ms/step
Epoch 23/50
7696/7696 - 248s - loss: 2.7876 - accuracy30: 0.5267 - val_loss: 2.9914 - val_accuracy30: 0.5090 - 248s/epoch - 32ms/step
Epoch 24/50
7696/7696 - 248s - loss: 2.7858 - accuracy30: 0.5272 - val_loss: 3.0036 - val_accuracy30: 0.5080 - 248s/epoch - 32ms/step
Epoch 25/50
7696/7696 - 249s - loss: 2.7841 - accuracy30: 0.5277 - val_loss: 2.9840 - val_accuracy30: 0.5104 - 249s/epoch - 32ms/step
Epoch 26/50
7696/7696 - 250s - loss: 2.7823 - accuracy30: 0.5278 - val_loss: 2.9762 - val_accuracy30: 0.5111 - 250s/epoch - 32ms/step
Epoch 27/50
7696/7696 - 247s - loss: 2.7805 - accuracy30: 0.5284 - val_loss: 2.9792 - val_accuracy30: 0.5106 - 247s/epoch - 32ms/step
Epoch 28/50
7696/7696 - 255s - loss: 2.7790 - accuracy30: 0.5289 - val_loss: 2.9799 - val_accuracy30: 0.5111 - 255s/epoch - 33ms/step
Epoch 29/50
7696/7696 - 249s - loss: 2.7774 - accuracy30: 0.5291 - val_loss: 2.9659 - val_accuracy30: 0.5115 - 249s/epoch - 32ms/step
Epoch 30/50
7696/7696 - 250s - loss: 2.7762 - accuracy30: 0.5293 - val_loss: 2.9753 - val_accuracy30: 0.5106 - 250s/epoch - 32ms/step
Epoch 31/50
7696/7696 - 250s - loss: 2.7745 - accuracy30: 0.5299 - val_loss: 2.9683 - val_accuracy30: 0.5119 - 250s/epoch - 32ms/step
Epoch 32/50
7696/7696 - 247s - loss: 2.7734 - accuracy30: 0.5303 - val_loss: 2.9711 - val_accuracy30: 0.5119 - 247s/epoch - 32ms/step
Epoch 33/50
7696/7696 - 248s - loss: 2.7718 - accuracy30: 0.5307 - val_loss: 2.9743 - val_accuracy30: 0.5110 - 248s/epoch - 32ms/step
Epoch 34/50
7696/7696 - 246s - loss: 2.7706 - accuracy30: 0.5307 - val_loss: 2.9694 - val_accuracy30: 0.5118 - 246s/epoch - 32ms/step
Epoch 35/50
7696/7696 - 245s - loss: 2.7690 - accuracy30: 0.5313 - val_loss: 2.9653 - val_accuracy30: 0.5121 - 245s/epoch - 32ms/step
Epoch 36/50
7696/7696 - 248s - loss: 2.7676 - accuracy30: 0.5316 - val_loss: 2.9602 - val_accuracy30: 0.5129 - 248s/epoch - 32ms/step
Epoch 37/50
7696/7696 - 248s - loss: 2.7664 - accuracy30: 0.5319 - val_loss: 2.9793 - val_accuracy30: 0.5101 - 248s/epoch - 32ms/step
Epoch 38/50
7696/7696 - 246s - loss: 2.7649 - accuracy30: 0.5323 - val_loss: 2.9669 - val_accuracy30: 0.5120 - 246s/epoch - 32ms/step
Epoch 39/50
7696/7696 - 245s - loss: 2.7636 - accuracy30: 0.5325 - val_loss: 2.9661 - val_accuracy30: 0.5119 - 245s/epoch - 32ms/step
Epoch 40/50
7696/7696 - 248s - loss: 2.7626 - accuracy30: 0.5330 - val_loss: 2.9704 - val_accuracy30: 0.5113 - 248s/epoch - 32ms/step
Epoch 41/50
7696/7696 - 249s - loss: 2.7611 - accuracy30: 0.5332 - val_loss: 2.9599 - val_accuracy30: 0.5131 - 249s/epoch - 32ms/step
Epoch 42/50
7696/7696 - 245s - loss: 2.7602 - accuracy30: 0.5336 - val_loss: 2.9684 - val_accuracy30: 0.5118 - 245s/epoch - 32ms/step
Epoch 43/50
7696/7696 - 248s - loss: 2.7588 - accuracy30: 0.5338 - val_loss: 2.9619 - val_accuracy30: 0.5125 - 248s/epoch - 32ms/step
Epoch 44/50
7696/7696 - 244s - loss: 2.7578 - accuracy30: 0.5342 - val_loss: 2.9646 - val_accuracy30: 0.5118 - 244s/epoch - 32ms/step
Epoch 45/50
7696/7696 - 248s - loss: 2.7561 - accuracy30: 0.5345 - val_loss: 2.9623 - val_accuracy30: 0.5132 - 248s/epoch - 32ms/step
Epoch 46/50
7696/7696 - 245s - loss: 2.7555 - accuracy30: 0.5349 - val_loss: 2.9589 - val_accuracy30: 0.5126 - 245s/epoch - 32ms/step
Epoch 47/50
7696/7696 - 246s - loss: 2.7539 - accuracy30: 0.5352 - val_loss: 2.9690 - val_accuracy30: 0.5126 - 246s/epoch - 32ms/step
Epoch 48/50
7696/7696 - 250s - loss: 2.7533 - accuracy30: 0.5355 - val_loss: 2.9656 - val_accuracy30: 0.5115 - 250s/epoch - 33ms/step
Epoch 49/50
7696/7696 - 254s - loss: 2.7521 - accuracy30: 0.5356 - val_loss: 2.9769 - val_accuracy30: 0.5108 - 254s/epoch - 33ms/step
Epoch 50/50
7696/7696 - 247s - loss: 2.7513 - accuracy30: 0.5360 - val_loss: 2.9750 - val_accuracy30: 0.5108 - 247s/epoch - 32ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 377s - 377s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9506805
{'0': {'precision': 0.45964669247941375, 'recall': 0.47320873798282737, 'f1-score': 0.46632913131756304, 'support': 1635160}, '1': {'precision': 0.7122061848174575, 'recall': 0.5728466555679804, 'f1-score': 0.6349698910826743, 'support': 2667583}, '2': {'precision': 0.4448728466340487, 'recall': 0.5719658068115002, 'f1-score': 0.500476758611337, 'support': 1658225}, 'accuracy': 0.5452698286587011, 'macro avg': {'precision': 0.53890857464364, 'recall': 0.5393404001207694, 'f1-score': 0.5339252603371915, 'support': 5960968}, 'weighted avg': {'precision': 0.568559380439266, 'recall': 0.5452698286587011, 'f1-score': 0.5512964844598234, 'support': 5960968}}
[[ 773772  303969  557419]
 [ 513381 1528116  626086]
 [ 396253  313524  948448]]
Evaluating performance on  train set...
7696/7696 - 126s - 126s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0053301
{'0': {'precision': 0.45033875533344186, 'recall': 0.48613658951661937, 'f1-score': 0.46755346598048647, 'support': 580557}, '1': {'precision': 0.651005299502168, 'recall': 0.5012860432159983, 'f1-score': 0.5664190272058752, 'support': 808682}, '2': {'precision': 0.438095251321392, 'recall': 0.5436723706184154, 'f1-score': 0.4852070459850113, 'support': 580241}, 'accuracy': 0.5093080407010988, 'macro avg': {'precision': 0.5131464353856673, 'recall': 0.510365001117011, 'f1-score': 0.5063931797237909, 'support': 1969480}, 'weighted avg': {'precision': 0.5291266786736118, 'recall': 0.5093080407010988, 'f1-score': 0.5133493769307247, 'support': 1969480}}
[[282230 103939 194388]
 [193076 405381 210225]
 [151400 113380 315461]]
Evaluating performance on  val set...
2338/2338 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9986833
{'0': {'precision': 0.4467156759043791, 'recall': 0.4871669165993771, 'f1-score': 0.4660652209899024, 'support': 173380}, '1': {'precision': 0.6680625724697697, 'recall': 0.5093516037240655, 'f1-score': 0.5780102695476338, 'support': 253379}, '2': {'precision': 0.4312626440728299, 'recall': 0.5434654223750299, 'f1-score': 0.48090609695837655, 'support': 171021}, 'accuracy': 0.5126769045468232, 'macro avg': {'precision': 0.5153469641489928, 'recall': 0.5133279808994908, 'f1-score': 0.508327195831971, 'support': 597780}, 'weighted avg': {'precision': 0.5361162285290549, 'recall': 0.5126769045468232, 'f1-score': 0.517760871408976, 'support': 597780}}
[[ 84465  30948  57967]
 [ 59715 129059  64605]
 [ 44900  33177  92944]]
testing model out of sample: results/universal/W8/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 233s - 233s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84042543
{'0': {'precision': 0.47972784032013116, 'recall': 0.4799731318949009, 'f1-score': 0.4798504547602743, 'support': 829236}, '1': {'precision': 0.7300220850938468, 'recall': 0.7527663691067801, 'f1-score': 0.7412197914099776, 'support': 1961958}, '2': {'precision': 0.48828711307395506, 'recall': 0.4518609375227254, 'f1-score': 0.4693683565132766, 'support': 825068}, 'accuracy': 0.6215597763657611, 'macro avg': {'precision': 0.5660123461626443, 'recall': 0.5615334795081355, 'f1-score': 0.5634795342278428, 'support': 3616262}, 'weighted avg': {'precision': 0.617474712073395, 'recall': 0.6215597763657611, 'f1-score': 0.6192615973041842, 'support': 3616262}}
[[ 398011  255709  175516]
 [ 269876 1476896  215186]
 [ 161773  290479  372816]]
Evaluating performance on  train set...
4550/4550 - 77s - 77s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87279755
{'0': {'precision': 0.496310075628202, 'recall': 0.48621276849998507, 'f1-score': 0.4912095374632159, 'support': 301257}, '1': {'precision': 0.6918291950055492, 'recall': 0.7342155566925329, 'f1-score': 0.7123924504364898, 'support': 562896}, '2': {'precision': 0.5035451332646149, 'recall': 0.45594637297581986, 'f1-score': 0.47856510588869183, 'support': 299998}, 'accuracy': 0.5983287391412282, 'macro avg': {'precision': 0.5638948012994555, 'recall': 0.5587915660561126, 'f1-score': 0.5607223645961326, 'support': 1164151}, 'weighted avg': {'precision': 0.5927128902474736, 'recall': 0.5983287391412282, 'f1-score': 0.594898554435679, 'support': 1164151}}
[[146475  86091  68691]
 [ 83443 413287  66166]
 [ 65210  98005 136783]]
Evaluating performance on  val set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8605612
{'0': {'precision': 0.49336619044648244, 'recall': 0.47549805587846233, 'f1-score': 0.4842673579571549, 'support': 99788}, '1': {'precision': 0.711196746891106, 'recall': 0.7496262110761134, 'f1-score': 0.7299060023584334, 'support': 200648}, '2': {'precision': 0.49668519530036737, 'recall': 0.4609978428780182, 'f1-score': 0.4781765876493818, 'support': 100597}, 'accuracy': 0.609014719486925, 'macro avg': {'precision': 0.5670827108793186, 'recall': 0.5620407032775313, 'f1-score': 0.5641166493216566, 'support': 401033}, 'weighted avg': {'precision': 0.6031854507586939, 'recall': 0.609014719486925, 'f1-score': 0.6056393884413711, 'support': 401033}}
[[ 47449  28186  24153]
 [ 27396 150411  22841]
 [ 21329  32893  46375]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0721198
{'0': {'precision': 0.4127753168450843, 'recall': 0.49413562630038116, 'f1-score': 0.4498059952902529, 'support': 54311}, '1': {'precision': 0.6176408076514347, 'recall': 0.301812327984629, 'f1-score': 0.40548365716677714, 'support': 57771}, '2': {'precision': 0.41911046625184856, 'recall': 0.5685061125619773, 'f1-score': 0.4825088339222615, 'support': 52842}, 'accuracy': 0.4505954257718707, 'macro avg': {'precision': 0.48317553024945586, 'recall': 0.4548180222823291, 'f1-score': 0.4459328287930972, 'support': 164924}, 'weighted avg': {'precision': 0.486567161781697, 'recall': 0.4505954257718707, 'f1-score': 0.4447584437105027, 'support': 164924}}
[[26837  5457 22017]
 [20715 17436 19620]
 [17464  5337 30041]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0699275
{'0': {'precision': 0.41676724137931037, 'recall': 0.5095920733635502, 'f1-score': 0.458528951486698, 'support': 18974}, '1': {'precision': 0.5788513150831991, 'recall': 0.28651894362080876, 'f1-score': 0.38330845240634104, 'support': 18819}, '2': {'precision': 0.43808596128089616, 'recall': 0.5575125251794846, 'f1-score': 0.49063636363636365, 'support': 19361}, 'accuracy': 0.45237428701403226, 'macro avg': {'precision': 0.4779015059144685, 'recall': 0.4512078473879478, 'f1-score': 0.44415792250980085, 'support': 57154}, 'weighted avg': {'precision': 0.4773581347384468, 'recall': 0.45237428701403226, 'f1-score': 0.4446376583914893, 'support': 57154}}
[[ 9669  1945  7360]
 [ 6942  5392  6485]
 [ 6589  1978 10794]]
Evaluating performance on  val set...
68/68 - 1s - 668ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.095197
{'0': {'precision': 0.429639029892837, 'recall': 0.5094465808393245, 'f1-score': 0.466151610188939, 'support': 5981}, '1': {'precision': 0.47924123120973516, 'recall': 0.24787115883006294, 'f1-score': 0.3267447535383114, 'support': 5402}, '2': {'precision': 0.43055366616786833, 'recall': 0.5406559617355654, 'f1-score': 0.47936387731919733, 'support': 5854}, 'accuracy': 0.438069269594477, 'macro avg': {'precision': 0.4464779757568135, 'recall': 0.4326579004683176, 'f1-score': 0.42408674701548255, 'support': 17237}, 'weighted avg': {'precision': 0.44549476884206934, 'recall': 0.438069269594477, 'f1-score': 0.4269492415722332, 'support': 17237}}
[[3047  721 2213]
 [2090 1339 1973]
 [1955  734 3165]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6283103
{'0': {'precision': 0.6049935263183134, 'recall': 0.44426837570720945, 'f1-score': 0.5123210720449394, 'support': 85194}, '1': {'precision': 0.8038374661121275, 'recall': 0.902929782703507, 'f1-score': 0.8505070496392717, 'support': 389790}, '2': {'precision': 0.6168043500993412, 'recall': 0.4274481859027006, 'f1-score': 0.5049581234751096, 'support': 82796}, 'accuracy': 0.7622951701387644, 'macro avg': {'precision': 0.6752117808432607, 'recall': 0.5915487814378056, 'f1-score': 0.6225954150531069, 'support': 557780}, 'weighted avg': {'precision': 0.745703606023582, 'recall': 0.7622951701387644, 'f1-score': 0.74756057420835, 'support': 557780}}
[[ 37849  42835   4510]
 [ 20360 351953  17477]
 [  4352  43053  35391]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69086725
{'0': {'precision': 0.5865812664667939, 'recall': 0.44426477671506226, 'f1-score': 0.5055990602975724, 'support': 29066}, '1': {'precision': 0.7592987097771746, 'recall': 0.8940868263473054, 'f1-score': 0.821198636182053, 'support': 98864}, '2': {'precision': 0.6418350393911785, 'recall': 0.41074184586891654, 'f1-score': 0.5009201940772963, 'support': 29157}, 'accuracy': 0.7211417876717997, 'macro avg': {'precision': 0.6625716718783823, 'recall': 0.5830311496437613, 'f1-score': 0.6092392968523073, 'support': 157087}, 'weighted avg': {'precision': 0.7055380965838229, 'recall': 0.7211417876717997, 'f1-score': 0.7033558114473092, 'support': 157087}}
[[12913 13486  2667]
 [ 6455 88393  4016]
 [ 2646 14535 11976]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6837581
{'0': {'precision': 0.5337575663510787, 'recall': 0.4258296186230807, 'f1-score': 0.473724085680832, 'support': 8076}, '1': {'precision': 0.781364537235631, 'recall': 0.8870669461225497, 'f1-score': 0.8308673874446064, 'support': 32444}, '2': {'precision': 0.617335352006056, 'recall': 0.40572139303482585, 'f1-score': 0.4896427499249475, 'support': 8040}, 'accuracy': 0.730663097199341, 'macro avg': {'precision': 0.6441524851975886, 'recall': 0.5728726525934854, 'f1-score': 0.5980780743501287, 'support': 48560}, 'weighted avg': {'precision': 0.7130270465826363, 'recall': 0.730663097199341, 'f1-score': 0.7149749782456299, 'support': 48560}}
[[ 3439  3972   665]
 [ 2307 28780  1357]
 [  697  4081  3262]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0758603
{'0': {'precision': 0.4239746127072954, 'recall': 0.47056075946171133, 'f1-score': 0.44605461551348635, 'support': 79214}, '1': {'precision': 0.6216005793952561, 'recall': 0.493378458973751, 'f1-score': 0.550116774227147, 'support': 139167}, '2': {'precision': 0.3921279709340465, 'recall': 0.491312814546926, 'f1-score': 0.43615259840486736, 'support': 79082}, 'accuracy': 0.4867529743194952, 'macro avg': {'precision': 0.479234387678866, 'recall': 0.4850840109941294, 'f1-score': 0.4774413293818336, 'support': 297463}, 'weighted avg': {'precision': 0.507966627785982, 'recall': 0.4867529743194952, 'f1-score': 0.4921072241563098, 'support': 297463}}
[[37275 19911 22028]
 [32302 68662 38203]
 [18341 21887 38854]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1508356
{'0': {'precision': 0.45342872570194387, 'recall': 0.47709679710247854, 'f1-score': 0.46496176073640866, 'support': 28162}, '1': {'precision': 0.44429427664825477, 'recall': 0.27905517623177706, 'f1-score': 0.3428014417518645, 'support': 27095}, '2': {'precision': 0.4311708003899058, 'recall': 0.5621888790820829, 'f1-score': 0.48803959728458246, 'support': 28325}, 'accuracy': 0.441733866143428, 'macro avg': {'precision': 0.44296460091336815, 'recall': 0.43944695080544616, 'f1-score': 0.43193426659095185, 'support': 83582}, 'weighted avg': {'precision': 0.4429246263555154, 'recall': 0.441733866143428, 'f1-score': 0.43318154343293186, 'support': 83582}}
[[13436  4650 10076]
 [ 8602  7561 10932]
 [ 7594  4807 15924]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.127594
{'0': {'precision': 0.45892999204455054, 'recall': 0.4572929052715022, 'f1-score': 0.45810998610283904, 'support': 10092}, '1': {'precision': 0.4978917378917379, 'recall': 0.3791547340102404, 'f1-score': 0.43048576214405365, 'support': 11523}, '2': {'precision': 0.42689607283388625, 'recall': 0.54367691854181, 'f1-score': 0.4782608695652174, 'support': 10177}, 'accuracy': 0.4566243080020131, 'macro avg': {'precision': 0.46123926759005823, 'recall': 0.46004151927451753, 'f1-score': 0.4556188726040367, 'support': 31792}, 'weighted avg': {'precision': 0.4627972228444438, 'recall': 0.4566243080020131, 'f1-score': 0.45454813432627705, 'support': 31792}}
[[4615 2169 3308]
 [3034 4369 4120]
 [2407 2237 5533]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1223/1223 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1715226
{'0': {'precision': 0.37129612669606754, 'recall': 0.24789983161023885, 'f1-score': 0.29730248090526534, 'support': 106301}, '1': {'precision': 0.35797570056829314, 'recall': 0.06872907182362015, 'f1-score': 0.11531784609557476, 'support': 106316}, '2': {'precision': 0.3274787049736519, 'recall': 0.7228429732313576, 'f1-score': 0.4507489194694222, 'support': 100416}, 'accuracy': 0.3394019160919136, 'macro avg': {'precision': 0.3522501774126709, 'recall': 0.3464906255550722, 'f1-score': 0.28778974882342073, 'support': 313033}, 'weighted avg': {'precision': 0.352716153837364, 'recall': 0.3394019160919136, 'f1-score': 0.28471786247983194, 'support': 313033}}
[[26352  6861 73088]
 [23034  7307 75975]
 [21587  6244 72585]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1599222
{'0': {'precision': 0.3796353842966646, 'recall': 0.2336106064952035, 'f1-score': 0.289237446976423, 'support': 31377}, '1': {'precision': 0.3461724415793715, 'recall': 0.07151418298042349, 'f1-score': 0.11853977539251125, 'support': 30036}, '2': {'precision': 0.33323217916426423, 'recall': 0.7319202826101446, 'f1-score': 0.45796146467595295, 'support': 30006}, 'accuracy': 0.3439110031831457, 'macro avg': {'precision': 0.35301333501343346, 'recall': 0.34568169069525717, 'f1-score': 0.28857956234829574, 'support': 91419}, 'weighted avg': {'precision': 0.35341033785490283, 'recall': 0.3439110031831457, 'f1-score': 0.2885336284200805, 'support': 91419}}
[[ 7330  2093 21954]
 [ 5898  2148 21990]
 [ 6080  1964 21962]]
Evaluating performance on  val set...
99/99 - 1s - 948ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1609358
{'0': {'precision': 0.3854495268138801, 'recall': 0.2264041690793283, 'f1-score': 0.2852557087619465, 'support': 8635}, '1': {'precision': 0.35262529832935563, 'recall': 0.070499821066444, 'f1-score': 0.11750671040858933, 'support': 8383}, '2': {'precision': 0.3342517558076715, 'recall': 0.7508495145631068, 'f1-score': 0.46257943925233647, 'support': 8240}, 'accuracy': 0.34575184100087103, 'macro avg': {'precision': 0.35744219365030244, 'recall': 0.34925116823629304, 'f1-score': 0.28844728614095744, 'support': 25258}, 'weighted avg': {'precision': 0.35785291819574216, 'recall': 0.34575184100087103, 'f1-score': 0.2874295818336315, 'support': 25258}}
[[1955  564 6116]
 [1585  591 6207]
 [1532  521 6187]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1726298
{'0': {'precision': 0.41641397541649877, 'recall': 0.4866269080816758, 'f1-score': 0.4487908555235182, 'support': 121064}, '1': {'precision': 0.49179135723572576, 'recall': 0.18072201347499353, 'f1-score': 0.2643145197107783, 'support': 123488}, '2': {'precision': 0.41232703160735146, 'recall': 0.603201347935973, 'f1-score': 0.48982623482730986, 'support': 124635}, 'accuracy': 0.4236606381048087, 'macro avg': {'precision': 0.44017745475319203, 'recall': 0.4235167564975475, 'f1-score': 0.40097720335386877, 'support': 369187}, 'weighted avg': {'precision': 0.4402469540545321, 'recall': 0.4236606381048087, 'f1-score': 0.40093930804943173, 'support': 369187}}
[[58913 10737 51414]
 [45434 22317 55737]
 [37130 12325 75180]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.155623
{'0': {'precision': 0.4231548480463097, 'recall': 0.4921257002716934, 'f1-score': 0.45504162915040963, 'support': 41591}, '1': {'precision': 0.4911376980170599, 'recall': 0.21224089233567905, 'f1-score': 0.29639657708249767, 'support': 41778}, '2': {'precision': 0.4220952762744705, 'recall': 0.58872865363558, 'f1-score': 0.49167728692200685, 'support': 42923}, 'accuracy': 0.4323710132074874, 'macro avg': {'precision': 0.44546260744594673, 'recall': 0.43103174874765077, 'f1-score': 0.41437183105163805, 'support': 126292}, 'weighted avg': {'precision': 0.44528378342555264, 'recall': 0.4323710132074874, 'f1-score': 0.41501248520809375, 'support': 126292}}
[[20468  4377 16746]
 [15059  8867 17852]
 [12843  4810 25270]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1754825
{'0': {'precision': 0.4340681362725451, 'recall': 0.5036818851251841, 'f1-score': 0.46629112697786224, 'support': 12901}, '1': {'precision': 0.4760508308895406, 'recall': 0.19119032663316582, 'f1-score': 0.2728138479636995, 'support': 12736}, '2': {'precision': 0.41045230581852404, 'recall': 0.5925985133082887, 'f1-score': 0.4849872440635834, 'support': 12511}, 'accuracy': 0.42851525636992766, 'macro avg': {'precision': 0.44019042432686994, 'recall': 0.4291569083555462, 'f1-score': 0.4080307396683817, 'support': 38148}, 'weighted avg': {'precision': 0.44033934167864236, 'recall': 0.42851525636992766, 'f1-score': 0.4078288352544451, 'support': 38148}}
[[6498 1327 5076]
 [4728 2435 5573]
 [3744 1353 7414]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
5521/5521 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.61526865
{'0': {'precision': 0.5808387925900386, 'recall': 0.5159639141289921, 'f1-score': 0.5464827084521164, 'support': 215486}, '1': {'precision': 0.8147563513186548, 'recall': 0.8631229814938227, 'f1-score': 0.838242557004879, 'support': 975350}, '2': {'precision': 0.5920367680580146, 'recall': 0.5020047286424482, 'f1-score': 0.5433162416446939, 'support': 222474}, 'accuracy': 0.7533471071456368, 'macro avg': {'precision': 0.6625439706555692, 'recall': 0.6270305414217544, 'f1-score': 0.6426805023672298, 'support': 1413310}, 'weighted avg': {'precision': 0.7440321113242288, 'recall': 0.7533471071456368, 'f1-score': 0.7473328487252502, 'support': 1413310}}
[[111183  91111  13192]
 [ 69736 841847  63767]
 [ 10499 100292 111683]]
Evaluating performance on  train set...
1289/1289 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6471104
{'0': {'precision': 0.5286308291846133, 'recall': 0.5212251576489622, 'f1-score': 0.5249018736577057, 'support': 54393}, '1': {'precision': 0.7998304550450274, 'recall': 0.8510193721501546, 'f1-score': 0.8246312904614249, 'support': 220626}, '2': {'precision': 0.6020844920561991, 'recall': 0.45508215898082655, 'f1-score': 0.5183627581612259, 'support': 54711}, 'accuracy': 0.7309192369514451, 'macro avg': {'precision': 0.6435152587619465, 'recall': 0.6091088962599811, 'f1-score': 0.6226319740934522, 'support': 329730}, 'weighted avg': {'precision': 0.7222814281730191, 'recall': 0.7309192369514451, 'f1-score': 0.724369137066584, 'support': 329730}}
[[ 28351  22103   3939]
 [ 20353 187757  12516]
 [  4927  24886  24898]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6220977
{'0': {'precision': 0.490353612770231, 'recall': 0.5527287893231649, 'f1-score': 0.5196762176847884, 'support': 16784}, '1': {'precision': 0.821015735699903, 'recall': 0.8393671770760531, 'f1-score': 0.8300900414077375, 'support': 78695}, '2': {'precision': 0.6038336117076275, 'recall': 0.4610432987186494, 'f1-score': 0.5228650137741047, 'support': 16467}, 'accuracy': 0.7407410715880871, 'macro avg': {'precision': 0.6384009867259205, 'recall': 0.6177130883726225, 'f1-score': 0.6242104242888769, 'support': 111946}, 'weighted avg': {'precision': 0.7394927593806739, 'recall': 0.7407410715880871, 'f1-score': 0.7383577763209187, 'support': 111946}}
[[ 9277  6691   816]
 [ 8476 66054  4165]
 [ 1166  7709  7592]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6419246
{'0': {'precision': 0.5186921096901032, 'recall': 0.47233373014774416, 'f1-score': 0.4944286397380229, 'support': 216726}, '1': {'precision': 0.813452507016638, 'recall': 0.8875116295581182, 'f1-score': 0.8488698198237923, 'support': 1084521}, '2': {'precision': 0.5780137358344557, 'recall': 0.36340118169357366, 'f1-score': 0.4462450524767776, 'support': 213761}, 'accuracy': 0.7541696149459277, 'macro avg': {'precision': 0.6367194508470656, 'recall': 0.574415513799812, 'f1-score': 0.5965145040128642, 'support': 1515008}, 'weighted avg': {'precision': 0.7380668529226232, 'recall': 0.7541696149459277, 'f1-score': 0.741357455474473, 'support': 1515008}}
[[102367 100231  14128]
 [ 79412 962525  42584]
 [ 15577 120503  77681]]
Evaluating performance on  train set...
1814/1814 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67254305
{'0': {'precision': 0.5271977775786361, 'recall': 0.4650837988826816, 'f1-score': 0.4941967098354918, 'support': 75896}, '1': {'precision': 0.7926610153874505, 'recall': 0.8807045943879428, 'f1-score': 0.8343666129694652, 'support': 312577}, '2': {'precision': 0.5773051630054569, 'recall': 0.3809988655251563, 'f1-score': 0.45904557555529063, 'support': 75806}, 'accuracy': 0.7311724200319205, 'macro avg': {'precision': 0.6323879853238478, 'recall': 0.5755957529319269, 'f1-score': 0.5958696327867492, 'support': 464279}, 'weighted avg': {'precision': 0.7141029422409002, 'recall': 0.7311724200319205, 'f1-score': 0.7174775838932524, 'support': 464279}}
[[ 35298  33222   7376]
 [ 23518 275288  13771]
 [  8138  38786  28882]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6256482
{'0': {'precision': 0.5060366671635117, 'recall': 0.46303873431533005, 'f1-score': 0.48358379032832416, 'support': 21996}, '1': {'precision': 0.82515737844205, 'recall': 0.897277820240385, 'f1-score': 0.8597077143454959, 'support': 119059}, '2': {'precision': 0.5878903274942879, 'recall': 0.3562560575991139, 'f1-score': 0.4436589361151824, 'support': 21667}, 'accuracy': 0.7665404800825949, 'macro avg': {'precision': 0.6396947910332832, 'recall': 0.5721908707182763, 'f1-score': 0.5956501469296674, 'support': 162722}, 'weighted avg': {'precision': 0.7504271983916089, 'recall': 0.7665404800825949, 'f1-score': 0.7534666976999415, 'support': 162722}}
[[ 10185  10391   1420]
 [  8239 106829   3991]
 [  1703  12245   7719]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
3755/3755 - 34s - 34s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9866215
{'0': {'precision': 0.5111143321180226, 'recall': 0.45002192451422474, 'f1-score': 0.47862652937993005, 'support': 305594}, '1': {'precision': 0.5463888569126281, 'recall': 0.6528966090224323, 'f1-score': 0.5949132913201076, 'support': 363494}, '2': {'precision': 0.5055131796419731, 'recall': 0.4460977488658735, 'f1-score': 0.4739506130176912, 'support': 292075}, 'accuracy': 0.5255528978955702, 'macro avg': {'precision': 0.5210054562242079, 'recall': 0.5163387608008435, 'f1-score': 0.5158301445725763, 'support': 961163}, 'weighted avg': {'precision': 0.522752442934032, 'recall': 0.5255528978955702, 'f1-score': 0.5211831217302203, 'support': 961163}}
[[137524  97218  70852]
 [ 69570 237324  56600]
 [ 61973  99808 130294]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9854081
{'0': {'precision': 0.5271850522609561, 'recall': 0.4726352227152813, 'f1-score': 0.4984220280858899, 'support': 131154}, '1': {'precision': 0.5192170956523987, 'recall': 0.6135924406657959, 'f1-score': 0.5624735222343207, 'support': 130911}, '2': {'precision': 0.5179828512327762, 'recall': 0.4772818100771619, 'f1-score': 0.49680010239672334, 'support': 130116}, 'accuracy': 0.5212287183723842, 'macro avg': {'precision': 0.5214616663820437, 'recall': 0.5211698244860797, 'f1-score': 0.519231884238978, 'support': 392181}, 'weighted avg': {'precision': 0.5214722646537913, 'recall': 0.5212287183723842, 'f1-score': 0.5192644622361767, 'support': 392181}}
[[61988 35343 33823]
 [26618 80326 23967]
 [28977 39037 62102]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0328863
{'0': {'precision': 0.5057511515771893, 'recall': 0.4714848949046985, 'f1-score': 0.4880172593054689, 'support': 39821}, '1': {'precision': 0.48422475633953294, 'recall': 0.5566612357438275, 'f1-score': 0.5179225261783157, 'support': 39895}, '2': {'precision': 0.500975355111685, 'recall': 0.45967680943857614, 'f1-score': 0.47943836769036596, 'support': 39667}, 'accuracy': 0.49602539725086486, 'macro avg': {'precision': 0.49698375434280245, 'recall': 0.49594098002903403, 'f1-score': 0.4951260510580502, 'support': 119383}, 'weighted avg': {'precision': 0.49697069660115867, 'recall': 0.49602539725086486, 'f1-score': 0.4951604181153157, 'support': 119383}}
[[18775 11342  9704]
 [ 9228 22208  8459]
 [ 9120 12313 18234]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
4960/4960 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8955733
{'0': {'precision': 0.5104495017211118, 'recall': 0.4818437588182867, 'f1-score': 0.49573430834856796, 'support': 357921}, '1': {'precision': 0.6195123290931811, 'recall': 0.728942516395547, 'f1-score': 0.6697871680583828, 'support': 557011}, '2': {'precision': 0.5460573917573512, 'recall': 0.4254823142061407, 'f1-score': 0.4782877350419225, 'support': 354748}, 'accuracy': 0.5744990863839707, 'macro avg': {'precision': 0.558673074190548, 'recall': 0.5454228631399914, 'f1-score': 0.5479364038162912, 'support': 1269680}, 'weighted avg': {'precision': 0.5682443967434162, 'recall': 0.5744990863839707, 'f1-score': 0.567217060264356, 'support': 1269680}}
[[172462 119103  66356]
 [ 91861 406029  59121]
 [ 73540 130269 150939]]
Evaluating performance on  train set...
1691/1691 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92501086
{'0': {'precision': 0.5316550506165442, 'recall': 0.4935301608677196, 'f1-score': 0.5118837059247731, 'support': 136634}, '1': {'precision': 0.5650336851123486, 'recall': 0.7137560183733328, 'f1-score': 0.6307467009365346, 'support': 162627}, '2': {'precision': 0.5581152561247216, 'recall': 0.4202106555474873, 'f1-score': 0.4794434550882093, 'support': 133583}, 'accuracy': 0.5536451931873839, 'macro avg': {'precision': 0.5516013306178714, 'recall': 0.5424989449295133, 'f1-score': 0.5406912873165056, 'support': 432844}, 'weighted avg': {'precision': 0.5523620508858053, 'recall': 0.5536451931873839, 'f1-score': 0.546530983609752, 'support': 432844}}
[[ 67433  42059  27142]
 [ 29250 116076  17301]
 [ 30153  47297  56133]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9520467
{'0': {'precision': 0.5249937487213293, 'recall': 0.4730836986357491, 'f1-score': 0.49768880173259056, 'support': 48818}, '1': {'precision': 0.5408964526872193, 'recall': 0.6818286858727469, 'f1-score': 0.6032405908711431, 'support': 51928}, '2': {'precision': 0.5391387789372676, 'recall': 0.44601889338731443, 'f1-score': 0.48817785887285087, 'support': 50388}, 'accuracy': 0.535782815250043, 'macro avg': {'precision': 0.535009660115272, 'recall': 0.5336437592986035, 'f1-score': 0.5297024171588616, 'support': 151134}, 'weighted avg': {'precision': 0.535173690984893, 'recall': 0.535782815250043, 'f1-score': 0.5307843058386831, 'support': 151134}}
[[23095 13663 12060]
 [ 9371 35406  7151]
 [11525 16389 22474]]
testing model on single stock: results/universal/W8/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
10609/10609 - 95s - 95s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.153131
{'0': {'precision': 0.4229035936819952, 'recall': 0.49922229388078065, 'f1-score': 0.4579047285753131, 'support': 922585}, '1': {'precision': 0.40843513776573004, 'recall': 0.10785183868523107, 'f1-score': 0.17064339253528982, 'support': 832633}, '2': {'precision': 0.4254914561204716, 'recall': 0.6231935814356394, 'f1-score': 0.5057067373211074, 'support': 960464}, 'accuracy': 0.42307273090148256, 'macro avg': {'precision': 0.4189433958560656, 'recall': 0.41008923800055036, 'f1-score': 0.37808495281057014, 'support': 2715682}, 'weighted avg': {'precision': 0.41938279664249695, 'recall': 0.42307273090148256, 'f1-score': 0.3867361751574269, 'support': 2715682}}
[[460575  65980 396030]
 [330679  89801 412153]
 [297824  64085 598555]]
Evaluating performance on  train set...
3903/3903 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.16666
{'0': {'precision': 0.41396442440367015, 'recall': 0.5120289807422729, 'f1-score': 0.45780408610483836, 'support': 334567}, '1': {'precision': 0.4230223242945107, 'recall': 0.14253073161815108, 'f1-score': 0.2132202478340724, 'support': 328245}, '2': {'precision': 0.40941718301965896, 'recall': 0.5779224448403127, 'f1-score': 0.4792907581015521, 'support': 336251}, 'accuracy': 0.4128067999715734, 'macro avg': {'precision': 0.4154679772392799, 'recall': 0.4108273857335789, 'f1-score': 0.3834383640134876, 'support': 999063}, 'weighted avg': {'precision': 0.41540997477141856, 'recall': 0.4128067999715734, 'f1-score': 0.3846770590328513, 'support': 999063}}
[[171308  30719 132540]
 [133684  46785 147776]
 [108831  33093 194327]]
Evaluating performance on  val set...
1144/1144 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1667786
{'0': {'precision': 0.42058857302209607, 'recall': 0.5124620243044452, 'f1-score': 0.46200210824106025, 'support': 100064}, '1': {'precision': 0.40861818052745535, 'recall': 0.12251761350333114, 'f1-score': 0.18851271134400457, 'support': 93962}, '2': {'precision': 0.4035134490451669, 'recall': 0.5832851623109921, 'f1-score': 0.4770241970598602, 'support': 98607}, 'accuracy': 0.4111190467240537, 'macro avg': {'precision': 0.4109067341982395, 'recall': 0.4060882667062562, 'f1-score': 0.3758463388816417, 'support': 292633}, 'weighted avg': {'precision': 0.4109912659187465, 'recall': 0.4111190467240537, 'f1-score': 0.37924887262140783, 'support': 292633}}
[[51279  8220 40565]
 [37993 11512 44457]
 [32650  8441 57516]]
training model: results/universal/W8/deepVOL_L3/h10
Epoch 1/50
7696/7696 - 461s - loss: 2.8600 - accuracy10: 0.5082 - val_loss: 2.8450 - val_accuracy10: 0.5436 - 461s/epoch - 60ms/step
Epoch 2/50
7696/7696 - 433s - loss: 2.7205 - accuracy10: 0.5496 - val_loss: 2.8256 - val_accuracy10: 0.5481 - 433s/epoch - 56ms/step
Epoch 3/50
7696/7696 - 427s - loss: 2.6796 - accuracy10: 0.5600 - val_loss: 2.7647 - val_accuracy10: 0.5617 - 427s/epoch - 55ms/step
Epoch 4/50
7696/7696 - 436s - loss: 2.6588 - accuracy10: 0.5641 - val_loss: 2.8190 - val_accuracy10: 0.5595 - 436s/epoch - 57ms/step
Epoch 5/50
7696/7696 - 430s - loss: 2.6430 - accuracy10: 0.5680 - val_loss: 2.7696 - val_accuracy10: 0.5627 - 430s/epoch - 56ms/step
Epoch 6/50
7696/7696 - 425s - loss: 2.6322 - accuracy10: 0.5702 - val_loss: 2.7712 - val_accuracy10: 0.5617 - 425s/epoch - 55ms/step
Epoch 7/50
7696/7696 - 438s - loss: 2.6241 - accuracy10: 0.5718 - val_loss: 2.7621 - val_accuracy10: 0.5611 - 438s/epoch - 57ms/step
Epoch 8/50
7696/7696 - 431s - loss: 2.6174 - accuracy10: 0.5733 - val_loss: 2.7719 - val_accuracy10: 0.5628 - 431s/epoch - 56ms/step
Epoch 9/50
7696/7696 - 432s - loss: 2.6117 - accuracy10: 0.5745 - val_loss: 2.7500 - val_accuracy10: 0.5663 - 432s/epoch - 56ms/step
Epoch 10/50
7696/7696 - 422s - loss: 2.6072 - accuracy10: 0.5753 - val_loss: 2.7380 - val_accuracy10: 0.5684 - 422s/epoch - 55ms/step
Epoch 11/50
7696/7696 - 429s - loss: 2.6024 - accuracy10: 0.5764 - val_loss: 2.7236 - val_accuracy10: 0.5698 - 429s/epoch - 56ms/step
Epoch 12/50
7696/7696 - 420s - loss: 2.5990 - accuracy10: 0.5771 - val_loss: 2.6997 - val_accuracy10: 0.5712 - 420s/epoch - 55ms/step
Epoch 13/50
7696/7696 - 423s - loss: 2.5952 - accuracy10: 0.5781 - val_loss: 2.7198 - val_accuracy10: 0.5691 - 423s/epoch - 55ms/step
Epoch 14/50
7696/7696 - 420s - loss: 2.5918 - accuracy10: 0.5789 - val_loss: 2.7063 - val_accuracy10: 0.5713 - 420s/epoch - 55ms/step
Epoch 15/50
7696/7696 - 418s - loss: 2.5893 - accuracy10: 0.5791 - val_loss: 2.6945 - val_accuracy10: 0.5699 - 418s/epoch - 54ms/step
Epoch 16/50
7696/7696 - 428s - loss: 2.5863 - accuracy10: 0.5800 - val_loss: 2.7118 - val_accuracy10: 0.5726 - 428s/epoch - 56ms/step
Epoch 17/50
7696/7696 - 425s - loss: 2.5835 - accuracy10: 0.5808 - val_loss: 2.7066 - val_accuracy10: 0.5720 - 425s/epoch - 55ms/step
Epoch 18/50
7696/7696 - 418s - loss: 2.5808 - accuracy10: 0.5811 - val_loss: 2.6964 - val_accuracy10: 0.5714 - 418s/epoch - 54ms/step
Epoch 19/50
7696/7696 - 421s - loss: 2.5788 - accuracy10: 0.5818 - val_loss: 2.6686 - val_accuracy10: 0.5737 - 421s/epoch - 55ms/step
Epoch 20/50
7696/7696 - 417s - loss: 2.5765 - accuracy10: 0.5822 - val_loss: 2.6858 - val_accuracy10: 0.5726 - 417s/epoch - 54ms/step
Epoch 21/50
7696/7696 - 419s - loss: 2.5743 - accuracy10: 0.5824 - val_loss: 2.6702 - val_accuracy10: 0.5726 - 419s/epoch - 54ms/step
Epoch 22/50
7696/7696 - 428s - loss: 2.5724 - accuracy10: 0.5832 - val_loss: 2.6747 - val_accuracy10: 0.5730 - 428s/epoch - 56ms/step
Epoch 23/50
7696/7696 - 417s - loss: 2.5701 - accuracy10: 0.5836 - val_loss: 2.6806 - val_accuracy10: 0.5745 - 417s/epoch - 54ms/step
Epoch 24/50
7696/7696 - 421s - loss: 2.5685 - accuracy10: 0.5839 - val_loss: 2.6675 - val_accuracy10: 0.5746 - 421s/epoch - 55ms/step
Epoch 25/50
7696/7696 - 416s - loss: 2.5667 - accuracy10: 0.5840 - val_loss: 2.6730 - val_accuracy10: 0.5724 - 416s/epoch - 54ms/step
Epoch 26/50
7696/7696 - 419s - loss: 2.5650 - accuracy10: 0.5845 - val_loss: 2.6715 - val_accuracy10: 0.5718 - 419s/epoch - 54ms/step
Epoch 27/50
7696/7696 - 417s - loss: 2.5635 - accuracy10: 0.5851 - val_loss: 2.6600 - val_accuracy10: 0.5717 - 417s/epoch - 54ms/step
Epoch 28/50
7696/7696 - 429s - loss: 2.5614 - accuracy10: 0.5855 - val_loss: 2.6779 - val_accuracy10: 0.5730 - 429s/epoch - 56ms/step
Epoch 29/50
7696/7696 - 418s - loss: 2.5600 - accuracy10: 0.5857 - val_loss: 2.6704 - val_accuracy10: 0.5720 - 418s/epoch - 54ms/step
Epoch 30/50
7696/7696 - 427s - loss: 2.5584 - accuracy10: 0.5858 - val_loss: 2.6779 - val_accuracy10: 0.5747 - 427s/epoch - 55ms/step
Epoch 31/50
7696/7696 - 436s - loss: 2.5570 - accuracy10: 0.5864 - val_loss: 2.6710 - val_accuracy10: 0.5709 - 436s/epoch - 57ms/step
Epoch 32/50
7696/7696 - 437s - loss: 2.5555 - accuracy10: 0.5866 - val_loss: 2.6723 - val_accuracy10: 0.5737 - 437s/epoch - 57ms/step
Epoch 33/50
7696/7696 - 436s - loss: 2.5542 - accuracy10: 0.5869 - val_loss: 2.6610 - val_accuracy10: 0.5738 - 436s/epoch - 57ms/step
Epoch 34/50
7696/7696 - 428s - loss: 2.5529 - accuracy10: 0.5872 - val_loss: 2.6582 - val_accuracy10: 0.5731 - 428s/epoch - 56ms/step
Epoch 35/50
7696/7696 - 434s - loss: 2.5511 - accuracy10: 0.5876 - val_loss: 2.6596 - val_accuracy10: 0.5726 - 434s/epoch - 56ms/step
Epoch 36/50
7696/7696 - 429s - loss: 2.5501 - accuracy10: 0.5878 - val_loss: 2.6585 - val_accuracy10: 0.5735 - 429s/epoch - 56ms/step
Epoch 37/50
7696/7696 - 428s - loss: 2.5494 - accuracy10: 0.5879 - val_loss: 2.6546 - val_accuracy10: 0.5744 - 428s/epoch - 56ms/step
Epoch 38/50
7696/7696 - 412s - loss: 2.5479 - accuracy10: 0.5883 - val_loss: 2.6520 - val_accuracy10: 0.5706 - 412s/epoch - 54ms/step
Epoch 39/50
7696/7696 - 421s - loss: 2.5461 - accuracy10: 0.5887 - val_loss: 2.6668 - val_accuracy10: 0.5719 - 421s/epoch - 55ms/step
Epoch 40/50
7696/7696 - 428s - loss: 2.5448 - accuracy10: 0.5890 - val_loss: 2.6581 - val_accuracy10: 0.5724 - 428s/epoch - 56ms/step
Epoch 41/50
7696/7696 - 420s - loss: 2.5439 - accuracy10: 0.5893 - val_loss: 2.6536 - val_accuracy10: 0.5711 - 420s/epoch - 55ms/step
Epoch 42/50
7696/7696 - 423s - loss: 2.5432 - accuracy10: 0.5893 - val_loss: 2.6533 - val_accuracy10: 0.5721 - 423s/epoch - 55ms/step
Epoch 43/50
7696/7696 - 418s - loss: 2.5421 - accuracy10: 0.5893 - val_loss: 2.6559 - val_accuracy10: 0.5729 - 418s/epoch - 54ms/step
Epoch 44/50
7696/7696 - 420s - loss: 2.5407 - accuracy10: 0.5897 - val_loss: 2.6596 - val_accuracy10: 0.5698 - 420s/epoch - 55ms/step
Epoch 45/50
7696/7696 - 426s - loss: 2.5396 - accuracy10: 0.5901 - val_loss: 2.6621 - val_accuracy10: 0.5723 - 426s/epoch - 55ms/step
Epoch 46/50
7696/7696 - 452s - loss: 2.5387 - accuracy10: 0.5902 - val_loss: 2.6607 - val_accuracy10: 0.5709 - 452s/epoch - 59ms/step
Epoch 47/50
7696/7696 - 458s - loss: 2.5376 - accuracy10: 0.5904 - val_loss: 2.6582 - val_accuracy10: 0.5716 - 458s/epoch - 60ms/step
Epoch 48/50
7696/7696 - 453s - loss: 2.5364 - accuracy10: 0.5908 - val_loss: 2.6570 - val_accuracy10: 0.5715 - 453s/epoch - 59ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 716s - 716s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8425842
{'0': {'precision': 0.4491331038978834, 'recall': 0.5284774800307709, 'f1-score': 0.4855854362633906, 'support': 1383128}, '1': {'precision': 0.8270125775983784, 'recall': 0.6281744370496839, 'f1-score': 0.7140087908103175, 'support': 3172216}, '2': {'precision': 0.4315912957198464, 'recall': 0.5907483082246746, 'f1-score': 0.4987810837167382, 'support': 1405624}, 'accuracy': 0.5962164198834821, 'macro avg': {'precision': 0.5692456590720361, 'recall': 0.5824667417683765, 'f1-score': 0.5661251035968154, 'support': 5960968}, 'weighted avg': {'precision': 0.6460907332570486, 'recall': 0.5962164198834821, 'f1-score': 0.610255848656713, 'support': 5960968}}
[[ 730952  206854  445322]
 [ 531230 1992705  648281]
 [ 365291  209963  830370]]
Evaluating performance on  train set...
7696/7696 - 243s - 243s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88143086
{'0': {'precision': 0.4680520591671191, 'recall': 0.5449964844251413, 'f1-score': 0.5036021785678562, 'support': 521963}, '1': {'precision': 0.778848417679723, 'recall': 0.5854244922139289, 'f1-score': 0.6684248233988853, 'support': 926719}, '2': {'precision': 0.45062227688088785, 'recall': 0.5755129627993963, 'f1-score': 0.5054674113948814, 'support': 520798}, 'accuracy': 0.5720890793508947, 'macro avg': {'precision': 0.5658409179092433, 'recall': 0.5686446464794889, 'f1-score': 0.5591648044538743, 'support': 1969480}, 'weighted avg': {'precision': 0.609685127189814, 'recall': 0.5720890793508947, 'f1-score': 0.5816510473662271, 'support': 1969480}}
[[284468  74335 163160]
 [181943 542524 202252]
 [141359  79713 299726]]
Evaluating performance on  val set...
2338/2338 - 76s - 76s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.882033
{'0': {'precision': 0.45758372002012637, 'recall': 0.5331422615945806, 'f1-score': 0.4924817232768736, 'support': 153520}, '1': {'precision': 0.7925791694176371, 'recall': 0.5816912153849326, 'f1-score': 0.6709543412209368, 'support': 290986}, '2': {'precision': 0.4385996522992564, 'recall': 0.5876143377219881, 'f1-score': 0.5022879179528362, 'support': 153274}, 'accuracy': 0.5707417444544816, 'macro avg': {'precision': 0.5629208472456733, 'recall': 0.5674826049005004, 'f1-score': 0.5552413274835488, 'support': 597780}, 'weighted avg': {'precision': 0.6157844323934668, 'recall': 0.5707417444544816, 'f1-score': 0.5818725826027705, 'support': 597780}}
[[ 81848  21471  50201]
 [ 56640 169264  65082]
 [ 40382  22826  90066]]
testing model out of sample: results/universal/W8/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 445s - 445s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68607515
{'0': {'precision': 0.4683914166095316, 'recall': 0.5125345388199576, 'f1-score': 0.4894697247440699, 'support': 626469}, '1': {'precision': 0.8517196659657752, 'recall': 0.7865292532267706, 'f1-score': 0.8178274070350613, 'support': 2370559}, '2': {'precision': 0.4483984709459505, 'recall': 0.5370312353649832, 'f1-score': 0.4887288930822879, 'support': 619234}, 'accuracy': 0.696340309413422, 'macro avg': {'precision': 0.5895031845070858, 'recall': 0.6120316758039038, 'f1-score': 0.5986753416204731, 'support': 3616262}, 'weighted avg': {'precision': 0.716250094921735, 'recall': 0.696340309413422, 'f1-score': 0.7045903412317024, 'support': 3616262}}
[[ 321087  158728  146654]
 [ 243612 1864514  262433]
 [ 120811  165875  332548]]
Evaluating performance on  train set...
4550/4550 - 150s - 150s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72749364
{'0': {'precision': 0.4841064693301258, 'recall': 0.5206685914515562, 'f1-score': 0.5017223124598832, 'support': 233446}, '1': {'precision': 0.8279576035016482, 'recall': 0.7686058677674106, 'f1-score': 0.7971785447504656, 'support': 697710}, '2': {'precision': 0.47505266053455625, 'recall': 0.5410802806927187, 'f1-score': 0.5059212559242657, 'support': 232995}, 'accuracy': 0.673349934845222, 'macro avg': {'precision': 0.5957055777887766, 'recall': 0.6101182466372285, 'f1-score': 0.6016073710448714, 'support': 1164151}, 'weighted avg': {'precision': 0.6883745433535895, 'recall': 0.673349934845222, 'f1-score': 0.6796383222077131, 'support': 1164151}}
[[121548  54316  57582]
 [ 79718 536264  81728]
 [ 49811  57115 126069]]
Evaluating performance on  val set...
1570/1570 - 50s - 50s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7146032
{'0': {'precision': 0.487703422608188, 'recall': 0.5154183323264393, 'f1-score': 0.5011780145611349, 'support': 77797}, '1': {'precision': 0.8389611303689888, 'recall': 0.7785788352098761, 'f1-score': 0.8076429560555436, 'support': 244954}, '2': {'precision': 0.4671716343684078, 'recall': 0.5460003576812038, 'f1-score': 0.5035194053235791, 'support': 78282}, 'accuracy': 0.6821284033982241, 'macro avg': {'precision': 0.5979453957818616, 'recall': 0.6133325084058397, 'f1-score': 0.6041134586467525, 'support': 401033}, 'weighted avg': {'precision': 0.6982464729303627, 'recall': 0.6821284033982241, 'f1-score': 0.6888261682803726, 'support': 401033}}
[[ 40098  17343  20356]
 [ 25845 190716  28393]
 [ 16275  19265  42742]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0431584
{'0': {'precision': 0.42195565679125563, 'recall': 0.5948786387521895, 'f1-score': 0.49371349457015534, 'support': 47956}, '1': {'precision': 0.8008772270310135, 'recall': 0.29417719353274974, 'f1-score': 0.43029791138778534, 'support': 70138}, '2': {'precision': 0.3987030411449016, 'recall': 0.6091821481956011, 'f1-score': 0.4819651636228481, 'support': 46830}, 'accuracy': 0.4710593970556135, 'macro avg': {'precision': 0.5405119749890569, 'recall': 0.4994126601601801, 'f1-score': 0.4686588565269296, 'support': 164924}, 'weighted avg': {'precision': 0.5764988470046715, 'recall': 0.4710593970556135, 'f1-score': 0.46340852675766303, 'support': 164924}}
[[28528  2531 16897]
 [23378 20633 26127]
 [15703  2599 28528]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0493246
{'0': {'precision': 0.4257188827921944, 'recall': 0.6032386297205659, 'f1-score': 0.4991655581085983, 'support': 17106}, '1': {'precision': 0.7604179941378871, 'recall': 0.2618943117977528, 'f1-score': 0.3896053018184193, 'support': 22784}, '2': {'precision': 0.42165310355832136, 'recall': 0.61225671918443, 'f1-score': 0.49938580742700556, 'support': 17264}, 'accuracy': 0.46988837176750536, 'macro avg': {'precision': 0.5359299934961342, 'recall': 0.49246322023424954, 'f1-score': 0.4627188891180077, 'support': 57154}, 'weighted avg': {'precision': 0.5579159808116975, 'recall': 0.46988837176750536, 'f1-score': 0.45555673816454434, 'support': 57154}}
[[10319   960  5827]
 [ 8146  5967  8671]
 [ 5774   920 10570]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.052708
{'0': {'precision': 0.42777704223487356, 'recall': 0.6105442176870748, 'f1-score': 0.503075126508369, 'support': 5292}, '1': {'precision': 0.6998149861239593, 'recall': 0.23078096400244053, 'f1-score': 0.34709795824730444, 'support': 6556}, '2': {'precision': 0.43352831693698485, 'recall': 0.6051215438856931, 'f1-score': 0.5051506467353419, 'support': 5389}, 'accuracy': 0.4644079596217439, 'macro avg': {'precision': 0.5203734484319392, 'recall': 0.4821489085250694, 'f1-score': 0.4517745771636718, 'support': 17237}, 'weighted avg': {'precision': 0.5330432938741683, 'recall': 0.4644079596217439, 'f1-score': 0.4443989452345753, 'support': 17237}}
[[3231  317 1744]
 [2526 1513 2517]
 [1796  332 3261]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
2179/2179 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.44263956
{'0': {'precision': 0.5292006664672961, 'recall': 0.49846079555743344, 'f1-score': 0.513370978604362, 'support': 49701}, '1': {'precision': 0.9120085636016896, 'recall': 0.9259648075829879, 'f1-score': 0.9189336987675242, 'support': 459133}, '2': {'precision': 0.5409868993684023, 'recall': 0.4952396518612348, 'f1-score': 0.5171034526895139, 'support': 48946}, 'accuracy': 0.8500752985047868, 'macro avg': {'precision': 0.660732043145796, 'recall': 0.6398884183338854, 'f1-score': 0.6498027100204666, 'support': 557780}, 'weighted avg': {'precision': 0.8453407704340625, 'recall': 0.8500752985047868, 'f1-score': 0.8475348390390225, 'support': 557780}}
[[ 24774  20563   4364]
 [ 17789 425141  16203]
 [  4251  20455  24240]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5002414
{'0': {'precision': 0.5423274114701323, 'recall': 0.5051082731815658, 'f1-score': 0.5230565777368905, 'support': 18010}, '1': {'precision': 0.8888461969485936, 'recall': 0.9191139952984803, 'f1-score': 0.9037267333501533, 'support': 120812}, '2': {'precision': 0.5871189965555339, 'recall': 0.49460717218724337, 'f1-score': 0.5369071674789017, 'support': 18265}, 'accuracy': 0.8222895592888018, 'macro avg': {'precision': 0.6727642016580866, 'recall': 0.6396098135557632, 'f1-score': 0.6545634928553151, 'support': 157087}, 'weighted avg': {'precision': 0.8140351009212564, 'recall': 0.8222895592888018, 'f1-score': 0.8174316938291664, 'support': 157087}}
[[  9097   6692   2221]
 [  5640 111040   4132]
 [  2037   7194   9034]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5060378
{'0': {'precision': 0.4839886501824078, 'recall': 0.46878680800942285, 'f1-score': 0.4762664539289988, 'support': 5094}, '1': {'precision': 0.8968955300785779, 'recall': 0.9101199968628271, 'f1-score': 0.9034593724859211, 'support': 38251}, '2': {'precision': 0.5296196217002702, 'recall': 0.4885906040268456, 'f1-score': 0.5082784759624974, 'support': 5215}, 'accuracy': 0.8185543657331137, 'macro avg': {'precision': 0.636834600653752, 'recall': 0.6224991362996986, 'f1-score': 0.6293347674591391, 'support': 48560}, 'weighted avg': {'precision': 0.8141382914380514, 'recall': 0.8185543657331137, 'f1-score': 0.8162067138677453, 'support': 48560}}
[[ 2388  2011   695]
 [ 1870 34813  1568]
 [  676  1991  2548]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
1162/1162 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95717955
{'0': {'precision': 0.4608613140355089, 'recall': 0.5301280871097551, 'f1-score': 0.49307394519090225, 'support': 76042}, '1': {'precision': 0.7106182132901265, 'recall': 0.48185174317435836, 'f1-score': 0.5742914074254808, 'support': 146543}, '2': {'precision': 0.3897943502824859, 'recall': 0.5758834370576137, 'f1-score': 0.46490892330582256, 'support': 74878}, 'accuracy': 0.5178627257843833, 'macro avg': {'precision': 0.5204246258693738, 'recall': 0.5292877557805756, 'f1-score': 0.5107580919740685, 'support': 297463}, 'weighted avg': {'precision': 0.5660131251030049, 'recall': 0.5178627257843833, 'f1-score': 0.525995384359911, 'support': 297463}}
[[40312 14121 21609]
 [30036 70612 45895]
 [17123 14634 43121]]
Evaluating performance on  train set...
327/327 - 8s - 8s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0364573
{'0': {'precision': 0.4714100666173205, 'recall': 0.5514069264069265, 'f1-score': 0.5082801276935356, 'support': 27720}, '1': {'precision': 0.5953274336283186, 'recall': 0.302036564778564, 'f1-score': 0.4007529905161321, 'support': 27841}, '2': {'precision': 0.45494558906920857, 'recall': 0.6012633382106277, 'f1-score': 0.5179696867218004, 'support': 28021}, 'accuracy': 0.48505659113206195, 'macro avg': {'precision': 0.5072276964382826, 'recall': 0.48490227646537276, 'f1-score': 0.47566760164382266, 'support': 83582}, 'weighted avg': {'precision': 0.5071669555357187, 'recall': 0.48505659113206195, 'f1-score': 0.4757114897975163, 'support': 83582}}
[[15285  2780  9655]
 [ 8902  8409 10530]
 [ 8237  2936 16848]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0016422
{'0': {'precision': 0.4753940455341506, 'recall': 0.5550557202740006, 'f1-score': 0.5121456535069101, 'support': 9781}, '1': {'precision': 0.6348072256672957, 'recall': 0.39169855265346865, 'f1-score': 0.48446502057613167, 'support': 12022}, '2': {'precision': 0.46194225721784776, 'recall': 0.5990589648613475, 'f1-score': 0.5216405875430414, 'support': 9989}, 'accuracy': 0.5071087065928536, 'macro avg': {'precision': 0.5240478428064314, 'recall': 0.5152710792629389, 'f1-score': 0.5060837538753611, 'support': 31792}, 'weighted avg': {'precision': 0.5314488812811662, 'recall': 0.5071087065928536, 'f1-score': 0.5046616426549064, 'support': 31792}}
[[5429 1274 3078]
 [3421 4709 3892]
 [2570 1435 5984]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.217712
{'0': {'precision': 0.34000395948130796, 'recall': 0.603738025720898, 'f1-score': 0.4350200000703608, 'support': 102407}, '1': {'precision': 0.38201649374833735, 'recall': 0.11908996249642932, 'f1-score': 0.18157550894249547, 'support': 108523}, '2': {'precision': 0.34986647493837303, 'recall': 0.33361409557015953, 'f1-score': 0.34154705383955924, 'support': 102103}, 'accuracy': 0.34761191312098083, 'macro avg': {'precision': 0.3572956427226728, 'recall': 0.35214736126249563, 'f1-score': 0.31938085428413854, 'support': 313033}, 'weighted avg': {'precision': 0.3577858504384069, 'recall': 0.34761191312098083, 'f1-score': 0.31666690394416047, 'support': 313033}}
[[61827 10726 29854]
 [62156 12924 33443]
 [57859 10181 34063]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1950444
{'0': {'precision': 0.35998073217726395, 'recall': 0.5917585202077791, 'f1-score': 0.4476471152003067, 'support': 31572}, '1': {'precision': 0.36702508960573477, 'recall': 0.1360164707445042, 'f1-score': 0.19847846101662064, 'support': 30114}, '2': {'precision': 0.3484608060933037, 'recall': 0.3323579860760771, 'f1-score': 0.34021896302416854, 'support': 29733}, 'accuracy': 0.35726708889836906, 'macro avg': {'precision': 0.35848887595876744, 'recall': 0.35337765900945345, 'f1-score': 0.3287815130803653, 'support': 91419}, 'weighted avg': {'precision': 0.3585544621168452, 'recall': 0.35726708889836906, 'f1-score': 0.3306295794501822, 'support': 91419}}
[[18683  3735  9154]
 [16695  4096  9323]
 [16522  3329  9882]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1931356
{'0': {'precision': 0.3555936856554564, 'recall': 0.6066744730679157, 'f1-score': 0.4483773258329727, 'support': 8540}, '1': {'precision': 0.3565186997553303, 'recall': 0.12510732245799092, 'f1-score': 0.18521881242055566, 'support': 8153}, '2': {'precision': 0.37306758655934585, 'recall': 0.3409223584354933, 'f1-score': 0.35627135187896536, 'support': 8565}, 'accuracy': 0.3611133106342545, 'macro avg': {'precision': 0.3617266573233775, 'recall': 0.35756805132046665, 'f1-score': 0.32995583004416457, 'support': 25258}, 'weighted avg': {'precision': 0.3618176781013383, 'recall': 0.3611133106342545, 'f1-score': 0.3321995197213443, 'support': 25258}}
[[5181  927 2432]
 [4658 1020 2475]
 [4731  914 2920]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
1443/1443 - 27s - 27s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0835806
{'0': {'precision': 0.44840582662727924, 'recall': 0.5755847212460977, 'f1-score': 0.5040975100022188, 'support': 122366}, '1': {'precision': 0.6632524707996406, 'recall': 0.1783249724210679, 'f1-score': 0.28107806243217687, 'support': 124189}, '2': {'precision': 0.4365309833543153, 'recall': 0.6362042533759541, 'f1-score': 0.5177845545316685, 'support': 122632}, 'accuracy': 0.46208831838607534, 'macro avg': {'precision': 0.516063093593745, 'recall': 0.46337131568103995, 'f1-score': 0.4343200423220213, 'support': 369187}, 'weighted avg': {'precision': 0.5167325935851387, 'recall': 0.46208831838607534, 'f1-score': 0.4336234886267628, 'support': 369187}}
[[70432  5377 46557]
 [47894 22146 54149]
 [38746  5867 78019]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0536915
{'0': {'precision': 0.4551878728011854, 'recall': 0.5710268569930653, 'f1-score': 0.5065694202209186, 'support': 41963}, '1': {'precision': 0.6365316275764037, 'recall': 0.21499903975417706, 'f1-score': 0.32142985321035067, 'support': 41656}, '2': {'precision': 0.4437227257468949, 'recall': 0.6195252267241581, 'f1-score': 0.5170899631306661, 'support': 42673}, 'accuracy': 0.46998226332625975, 'macro avg': {'precision': 0.511814075374828, 'recall': 0.46851704115713355, 'f1-score': 0.44836307885397847, 'support': 126292}, 'weighted avg': {'precision': 0.5111281004376845, 'recall': 0.46998226332625975, 'f1-score': 0.44905801272238693, 'support': 126292}}
[[23962  2644 15357]
 [14914  8956 17786]
 [13766  2470 26437]]
Evaluating performance on  val set...
150/150 - 7s - 7s/epoch - 44ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0627961
{'0': {'precision': 0.46865539858728555, 'recall': 0.5753329204087952, 'f1-score': 0.5165438620881412, 'support': 12916}, '1': {'precision': 0.6356303295690251, 'recall': 0.2164495369643698, 'f1-score': 0.32293191265148413, 'support': 12742}, '2': {'precision': 0.4394808667075141, 'recall': 0.6317053642914331, 'f1-score': 0.5183457609302632, 'support': 12490}, 'accuracy': 0.4739173744364056, 'macro avg': {'precision': 0.5145888649546083, 'recall': 0.4744959405548661, 'f1-score': 0.45260717855662946, 'support': 38148}, 'weighted avg': {'precision': 0.5148755062571759, 'recall': 0.4739173744364056, 'f1-score': 0.4524645461820968, 'support': 38148}}
[[7431  821 4664]
 [4585 2758 5399]
 [3840  760 7890]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
5521/5521 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4567089
{'0': {'precision': 0.5104718206610503, 'recall': 0.5252716329242555, 'f1-score': 0.5177659890048504, 'support': 127930}, '1': {'precision': 0.916559012205758, 'recall': 0.8978777551581557, 'f1-score': 0.9071222135174309, 'support': 1152883}, '2': {'precision': 0.4766623327160737, 'recall': 0.5478539136735171, 'f1-score': 0.509784643044002, 'support': 132497}, 'accuracy': 0.8313356588434243, 'macro avg': {'precision': 0.6345643885276273, 'recall': 0.6570011005853095, 'f1-score': 0.6448909485220944, 'support': 1413310}, 'weighted avg': {'precision': 0.8385607494349157, 'recall': 0.8313356588434243, 'f1-score': 0.8346282964879665, 'support': 1413310}}
[[  67198   46738   13994]
 [  52032 1035148   65703]
 [  12409   47499   72589]]
Evaluating performance on  train set...
1289/1289 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4921174
{'0': {'precision': 0.46545961735835156, 'recall': 0.5275606991588618, 'f1-score': 0.49456833275078654, 'support': 33526}, '1': {'precision': 0.9059540841984617, 'recall': 0.8857537076493256, 'f1-score': 0.8957400226643746, 'support': 262363}, '2': {'precision': 0.49494576636947013, 'recall': 0.51508525161786, 'f1-score': 0.5048147236421031, 'support': 33841}, 'accuracy': 0.8112910563188063, 'macro avg': {'precision': 0.6221198226420944, 'recall': 0.6427998861420158, 'f1-score': 0.631707693019088, 'support': 329730}, 'weighted avg': {'precision': 0.8189830776812129, 'recall': 0.8112910563188063, 'f1-score': 0.8148284128009843, 'support': 329730}}
[[ 17687  11884   3955]
 [ 16142 232389  13832]
 [  4170  12240  17431]]
Evaluating performance on  val set...
438/438 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46251777
{'0': {'precision': 0.4252325845246199, 'recall': 0.5623687106131839, 'f1-score': 0.48427943836678433, 'support': 9997}, '1': {'precision': 0.9207930847702447, 'recall': 0.8852592407754982, 'f1-score': 0.902676600899391, 'support': 92173}, '2': {'precision': 0.5081610446137106, 'recall': 0.5254705400981997, 'f1-score': 0.5166708574302239, 'support': 9776}, 'accuracy': 0.8250049130830936, 'macro avg': {'precision': 0.6180622379695251, 'recall': 0.657699497162294, 'f1-score': 0.6345422988987998, 'support': 111946}, 'weighted avg': {'precision': 0.8405042924460367, 'recall': 0.8250049130830936, 'f1-score': 0.8316038642049755, 'support': 111946}}
[[ 5622  3442   933]
 [ 6537 81597  4039]
 [ 1062  3577  5137]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
5918/5918 - 94s - 94s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4437357
{'0': {'precision': 0.49640685025518855, 'recall': 0.481697795468463, 'f1-score': 0.4889417230943751, 'support': 130640}, '1': {'precision': 0.9113247307146924, 'recall': 0.9206372095987763, 'f1-score': 0.915957300925115, 'support': 1255160}, '2': {'precision': 0.49533067782092755, 'recall': 0.461000866819392, 'f1-score': 0.4775495969309832, 'support': 129208}, 'accuracy': 0.8435869645572829, 'macro avg': {'precision': 0.6343540862636029, 'recall': 0.6211119572955437, 'f1-score': 0.6274828736501578, 'support': 1515008}, 'weighted avg': {'precision': 0.8400679244869186, 'recall': 0.8435869645572829, 'f1-score': 0.8417457471211208, 'support': 1515008}}
[[  62929   54448   13263]
 [  52188 1155547   47425]
 [  11652   57991   59565]]
Evaluating performance on  train set...
1814/1814 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48195532
{'0': {'precision': 0.5213169438859441, 'recall': 0.4713671858860472, 'f1-score': 0.4950853819949227, 'support': 48406}, '1': {'precision': 0.8957749264373775, 'recall': 0.912320862310655, 'f1-score': 0.9039721882096564, 'support': 367385}, '2': {'precision': 0.5091713422529133, 'recall': 0.48661524500907444, 'f1-score': 0.4976378284894757, 'support': 48488}, 'accuracy': 0.8218872703697561, 'macro avg': {'precision': 0.6420877375254116, 'recall': 0.6234344310685922, 'f1-score': 0.632231799564685, 'support': 464279}, 'weighted avg': {'precision': 0.8163579213750745, 'recall': 0.8218872703697561, 'f1-score': 0.8189049868592991, 'support': 464279}}
[[ 22817  19125   6464]
 [ 15931 335173  16281]
 [  5020  19873  23595]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43021885
{'0': {'precision': 0.5029888312096901, 'recall': 0.47663412089140644, 'f1-score': 0.48945696682101714, 'support': 13417}, '1': {'precision': 0.9151713713322774, 'recall': 0.9303649023226405, 'f1-score': 0.9227055958231855, 'support': 136009}, '2': {'precision': 0.5278085341964057, 'recall': 0.4660800240673887, 'f1-score': 0.49502735950792826, 'support': 13296}, 'accuracy': 0.8550165312619068, 'macro avg': {'precision': 0.6486562455794577, 'recall': 0.6243596824271452, 'f1-score': 0.6357299740507103, 'support': 162722}, 'weighted avg': {'precision': 0.8495340916566139, 'recall': 0.8550165312619068, 'f1-score': 0.8520371755396973, 'support': 162722}}
[[  6395   5779   1243]
 [  5170 126538   4301]
 [  1149   5950   6197]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
3755/3755 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85295707
{'0': {'precision': 0.4855661131652067, 'recall': 0.47957086825445994, 'f1-score': 0.48254987005689404, 'support': 229207}, '1': {'precision': 0.721313553422591, 'recall': 0.6792484213286474, 'f1-score': 0.6996492854695342, 'support': 511031}, '2': {'precision': 0.4608234045993603, 'recall': 0.5288898947606654, 'f1-score': 0.4925160490808924, 'support': 220925}, 'accuracy': 0.5970714644654445, 'macro avg': {'precision': 0.5559010237290526, 'recall': 0.5625697281145908, 'f1-score': 0.5582384015357735, 'support': 961163}, 'weighted avg': {'precision': 0.6052211219954069, 'recall': 0.5970714644654445, 'f1-score': 0.6002679984686345, 'support': 961163}}
[[109921  67470  51816]
 [ 79018 347117  84896]
 [ 37438  66642 116845]]
Evaluating performance on  train set...
1532/1532 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86837184
{'0': {'precision': 0.5006978367062107, 'recall': 0.5178282325862641, 'f1-score': 0.5091189782141761, 'support': 102534}, '1': {'precision': 0.7077196220200204, 'recall': 0.6452746597371616, 'f1-score': 0.6750561246943084, 'support': 187796}, '2': {'precision': 0.47379321747757, 'recall': 0.534555379917723, 'f1-score': 0.5023435625841929, 'support': 101851}, 'accuracy': 0.5832001040335967, 'macro avg': {'precision': 0.5607368920679336, 'recall': 0.5658860907470495, 'f1-score': 0.5621728884975591, 'support': 392181}, 'weighted avg': {'precision': 0.5928430472639274, 'recall': 0.5832001040335967, 'f1-score': 0.5868184320455793, 'support': 392181}}
[[ 53095  23925  25514]
 [ 31662 121180  34954]
 [ 21285  26121  54445]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9122666
{'0': {'precision': 0.479547711329639, 'recall': 0.4912551271534044, 'f1-score': 0.4853308263364347, 'support': 30475}, '1': {'precision': 0.676744095560484, 'recall': 0.5958445384628561, 'f1-score': 0.6337228897005912, 'support': 58381}, '2': {'precision': 0.44238615962134814, 'recall': 0.5327415075179349, 'f1-score': 0.4833776694556317, 'support': 30527}, 'accuracy': 0.5530100600588024, 'macro avg': {'precision': 0.5328926555038237, 'recall': 0.5399470577113985, 'f1-score': 0.5341437951642193, 'support': 119383}, 'weighted avg': {'precision': 0.5664787770490628, 'recall': 0.5530100600588024, 'f1-score': 0.5573984827964211, 'support': 119383}}
[[14971  7947  7557]
 [10653 34786 12942]
 [ 5595  8669 16263]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
4960/4960 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75019544
{'0': {'precision': 0.48270855869411394, 'recall': 0.47581424247890486, 'f1-score': 0.4792366063948547, 'support': 249465}, '1': {'precision': 0.781092355452076, 'recall': 0.7692558961639913, 'f1-score': 0.7751289418410339, 'support': 774529}, '2': {'precision': 0.47338937720797286, 'recall': 0.5028695163745593, 'f1-score': 0.4876843401648403, 'support': 245686}, 'accuracy': 0.6600545019217441, 'macro avg': {'precision': 0.5790634304513876, 'recall': 0.5826465516724851, 'f1-score': 0.5806832961335763, 'support': 1269680}, 'weighted avg': {'precision': 0.6629250788382003, 'recall': 0.6600545019217441, 'f1-score': 0.66137122661397, 'support': 1269680}}
[[118699  82303  48463]
 [ 89743 595811  88975]
 [ 37460  84678 123548]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7930796
{'0': {'precision': 0.5036507562646568, 'recall': 0.5005750577602264, 'f1-score': 0.5021081969556207, 'support': 98251}, '1': {'precision': 0.7493481712993189, 'recall': 0.7473492295542, 'f1-score': 0.7483473655650504, 'support': 238044}, '2': {'precision': 0.498977337805776, 'recall': 0.5053599726563713, 'f1-score': 0.5021483741824601, 'support': 96549}, 'accuracy': 0.6373566458123481, 'macro avg': {'precision': 0.5839920884565839, 'recall': 0.5844280866569326, 'f1-score': 0.5842013122343771, 'support': 432844}, 'weighted avg': {'precision': 0.6377304283537342, 'recall': 0.6373566458123481, 'f1-score': 0.6375372100031326, 'support': 432844}}
[[ 49182  28566  20503]
 [ 31653 177902  28489]
 [ 16816  30941  48792]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8347065
{'0': {'precision': 0.5109787975602672, 'recall': 0.48344370860927155, 'f1-score': 0.49683003628867145, 'support': 36391}, '1': {'precision': 0.7346027018402298, 'recall': 0.7117294685990339, 'f1-score': 0.7229852191607835, 'support': 77625}, '2': {'precision': 0.47026219394640445, 'recall': 0.525728756937335, 'f1-score': 0.4964510138143333, 'support': 37118}, 'accuracy': 0.6110802334352297, 'macro avg': {'precision': 0.5719478977823005, 'recall': 0.5736339780485468, 'f1-score': 0.5720887564212628, 'support': 151134}, 'weighted avg': {'precision': 0.6158359883763163, 'recall': 0.6110802334352297, 'f1-score': 0.6128941086631552, 'support': 151134}}
[[17593  9177  9621]
 [10016 55248 12361]
 [ 6821 10783 19514]]
testing model on single stock: results/universal/W8/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
10609/10609 - 152s - 152s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0786598
{'0': {'precision': 0.4490055640771729, 'recall': 0.5349446092898019, 'f1-score': 0.48822209202381583, 'support': 873883}, '1': {'precision': 0.5764018871525627, 'recall': 0.18300508374032315, 'f1-score': 0.27780749892882817, 'support': 940646}, '2': {'precision': 0.42365948391148117, 'recall': 0.6468468728395733, 'f1-score': 0.5119872676864405, 'support': 901153}, 'accuracy': 0.45017421038251165, 'macro avg': {'precision': 0.4830223117137389, 'recall': 0.45493218862323276, 'f1-score': 0.4260056195463615, 'support': 2715682}, 'weighted avg': {'precision': 0.48472187605185163, 'recall': 0.45017421038251165, 'f1-score': 0.42322568007553674, 'support': 2715682}}
[[467479  61469 344935]
 [320458 172143 448045]
 [253206  65039 582908]]
Evaluating performance on  train set...
3903/3903 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0461744
{'0': {'precision': 0.4703762119971286, 'recall': 0.5533225698068215, 'f1-score': 0.5084889794234297, 'support': 336321}, '1': {'precision': 0.5583554576721173, 'recall': 0.22733805438007088, 'f1-score': 0.3231169443365385, 'support': 325634}, '2': {'precision': 0.4431996533935364, 'recall': 0.6190330695207471, 'f1-score': 0.5165633404665336, 'support': 337108}, 'accuracy': 0.46924368132940564, 'macro avg': {'precision': 0.4906437743542608, 'recall': 0.46656456456921314, 'f1-score': 0.4493897547421673, 'support': 999063}, 'weighted avg': {'precision': 0.4898820873707431, 'recall': 0.46924368132940564, 'f1-score': 0.450793413106825, 'support': 999063}}
[[186094  27961 122266]
 [111701  74029 139904]
 [ 97833  30594 208681]]
Evaluating performance on  val set...
1144/1144 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0664582
{'0': {'precision': 0.4675785999652597, 'recall': 0.5415434445852697, 'f1-score': 0.5018503500284311, 'support': 99414}, '1': {'precision': 0.5332030018288453, 'recall': 0.17984004764538222, 'f1-score': 0.26896343306134785, 'support': 94028}, '2': {'precision': 0.4334917923706432, 'recall': 0.6370940911977901, 'f1-score': 0.5159325631710006, 'support': 99191}, 'accuracy': 0.45770982766810303, 'macro avg': {'precision': 0.4780911313882494, 'recall': 0.45282586114281403, 'f1-score': 0.42891544875359316, 'support': 292633}, 'weighted avg': {'precision': 0.4771107673090372, 'recall': 0.45770982766810303, 'f1-score': 0.4317931034952093, 'support': 292633}}
[[53837  7106 38471]
 [33004 16910 44114]
 [28299  7698 63194]]
training model: results/universal/W8/deepVOL_L3/h20
Epoch 1/50
7696/7696 - 427s - loss: 2.9624 - accuracy20: 0.4769 - val_loss: 2.9250 - val_accuracy20: 0.5053 - 427s/epoch - 55ms/step
Epoch 2/50
7696/7696 - 445s - loss: 2.8336 - accuracy20: 0.5182 - val_loss: 2.9165 - val_accuracy20: 0.5115 - 445s/epoch - 58ms/step
Epoch 3/50
7696/7696 - 454s - loss: 2.7994 - accuracy20: 0.5261 - val_loss: 2.9722 - val_accuracy20: 0.5142 - 454s/epoch - 59ms/step
Epoch 4/50
7696/7696 - 425s - loss: 2.7766 - accuracy20: 0.5315 - val_loss: 2.9237 - val_accuracy20: 0.5182 - 425s/epoch - 55ms/step
Epoch 5/50
7696/7696 - 423s - loss: 2.7629 - accuracy20: 0.5342 - val_loss: 2.9375 - val_accuracy20: 0.5195 - 423s/epoch - 55ms/step
Epoch 6/50
7696/7696 - 432s - loss: 2.7507 - accuracy20: 0.5365 - val_loss: 2.9205 - val_accuracy20: 0.5244 - 432s/epoch - 56ms/step
Epoch 7/50
7696/7696 - 423s - loss: 2.7424 - accuracy20: 0.5385 - val_loss: 2.9081 - val_accuracy20: 0.5218 - 423s/epoch - 55ms/step
Epoch 8/50
7696/7696 - 449s - loss: 2.7362 - accuracy20: 0.5400 - val_loss: 2.8973 - val_accuracy20: 0.5274 - 449s/epoch - 58ms/step
Epoch 9/50
7696/7696 - 449s - loss: 2.7307 - accuracy20: 0.5411 - val_loss: 2.9021 - val_accuracy20: 0.5264 - 449s/epoch - 58ms/step
Epoch 10/50
7696/7696 - 448s - loss: 2.7256 - accuracy20: 0.5422 - val_loss: 2.8874 - val_accuracy20: 0.5282 - 448s/epoch - 58ms/step
Epoch 11/50
7696/7696 - 459s - loss: 2.7222 - accuracy20: 0.5428 - val_loss: 2.8863 - val_accuracy20: 0.5262 - 459s/epoch - 60ms/step
Epoch 12/50
7696/7696 - 425s - loss: 2.7184 - accuracy20: 0.5437 - val_loss: 2.8551 - val_accuracy20: 0.5296 - 425s/epoch - 55ms/step
Epoch 13/50
7696/7696 - 424s - loss: 2.7154 - accuracy20: 0.5445 - val_loss: 2.8707 - val_accuracy20: 0.5299 - 424s/epoch - 55ms/step
Epoch 14/50
7696/7696 - 422s - loss: 2.7127 - accuracy20: 0.5451 - val_loss: 2.8897 - val_accuracy20: 0.5293 - 422s/epoch - 55ms/step
Epoch 15/50
7696/7696 - 424s - loss: 2.7099 - accuracy20: 0.5458 - val_loss: 2.8699 - val_accuracy20: 0.5299 - 424s/epoch - 55ms/step
Epoch 16/50
7696/7696 - 424s - loss: 2.7081 - accuracy20: 0.5461 - val_loss: 2.8844 - val_accuracy20: 0.5325 - 424s/epoch - 55ms/step
Epoch 17/50
7696/7696 - 423s - loss: 2.7059 - accuracy20: 0.5466 - val_loss: 2.8715 - val_accuracy20: 0.5317 - 423s/epoch - 55ms/step
Epoch 18/50
7696/7696 - 416s - loss: 2.7039 - accuracy20: 0.5468 - val_loss: 2.8517 - val_accuracy20: 0.5334 - 416s/epoch - 54ms/step
Epoch 19/50
7696/7696 - 418s - loss: 2.7019 - accuracy20: 0.5475 - val_loss: 2.8883 - val_accuracy20: 0.5285 - 418s/epoch - 54ms/step
Epoch 20/50
7696/7696 - 422s - loss: 2.6999 - accuracy20: 0.5482 - val_loss: 2.8691 - val_accuracy20: 0.5323 - 422s/epoch - 55ms/step
Epoch 21/50
7696/7696 - 415s - loss: 2.6980 - accuracy20: 0.5483 - val_loss: 2.8676 - val_accuracy20: 0.5340 - 415s/epoch - 54ms/step
Epoch 22/50
7696/7696 - 419s - loss: 2.6964 - accuracy20: 0.5487 - val_loss: 2.8488 - val_accuracy20: 0.5334 - 419s/epoch - 54ms/step
Epoch 23/50
7696/7696 - 422s - loss: 2.6949 - accuracy20: 0.5489 - val_loss: 2.8674 - val_accuracy20: 0.5310 - 422s/epoch - 55ms/step
Epoch 24/50
7696/7696 - 423s - loss: 2.6933 - accuracy20: 0.5495 - val_loss: 2.8644 - val_accuracy20: 0.5340 - 423s/epoch - 55ms/step
Epoch 25/50
7696/7696 - 425s - loss: 2.6915 - accuracy20: 0.5499 - val_loss: 2.8668 - val_accuracy20: 0.5344 - 425s/epoch - 55ms/step
Epoch 26/50
7696/7696 - 426s - loss: 2.6902 - accuracy20: 0.5502 - val_loss: 2.8548 - val_accuracy20: 0.5347 - 426s/epoch - 55ms/step
Epoch 27/50
7696/7696 - 428s - loss: 2.6887 - accuracy20: 0.5505 - val_loss: 2.8489 - val_accuracy20: 0.5368 - 428s/epoch - 56ms/step
Epoch 28/50
7696/7696 - 426s - loss: 2.6872 - accuracy20: 0.5509 - val_loss: 2.8645 - val_accuracy20: 0.5335 - 426s/epoch - 55ms/step
Epoch 29/50
7696/7696 - 421s - loss: 2.6859 - accuracy20: 0.5511 - val_loss: 2.8615 - val_accuracy20: 0.5353 - 421s/epoch - 55ms/step
Epoch 30/50
7696/7696 - 431s - loss: 2.6847 - accuracy20: 0.5515 - val_loss: 2.8652 - val_accuracy20: 0.5341 - 431s/epoch - 56ms/step
Epoch 31/50
7696/7696 - 430s - loss: 2.6835 - accuracy20: 0.5516 - val_loss: 2.8540 - val_accuracy20: 0.5349 - 430s/epoch - 56ms/step
Epoch 32/50
7696/7696 - 468s - loss: 2.6821 - accuracy20: 0.5521 - val_loss: 2.8436 - val_accuracy20: 0.5351 - 468s/epoch - 61ms/step
Epoch 33/50
7696/7696 - 452s - loss: 2.6805 - accuracy20: 0.5524 - val_loss: 2.8536 - val_accuracy20: 0.5344 - 452s/epoch - 59ms/step
Epoch 34/50
7696/7696 - 435s - loss: 2.6798 - accuracy20: 0.5524 - val_loss: 2.8376 - val_accuracy20: 0.5359 - 435s/epoch - 56ms/step
Epoch 35/50
7696/7696 - 398s - loss: 2.6784 - accuracy20: 0.5528 - val_loss: 2.8530 - val_accuracy20: 0.5352 - 398s/epoch - 52ms/step
Epoch 36/50
7696/7696 - 390s - loss: 2.6773 - accuracy20: 0.5534 - val_loss: 2.8430 - val_accuracy20: 0.5351 - 390s/epoch - 51ms/step
Epoch 37/50
7696/7696 - 402s - loss: 2.6760 - accuracy20: 0.5537 - val_loss: 2.8437 - val_accuracy20: 0.5341 - 402s/epoch - 52ms/step
Epoch 38/50
7696/7696 - 693s - loss: 2.6750 - accuracy20: 0.5539 - val_loss: 2.8360 - val_accuracy20: 0.5338 - 693s/epoch - 90ms/step
Epoch 39/50
7696/7696 - 391s - loss: 2.6738 - accuracy20: 0.5540 - val_loss: 2.8426 - val_accuracy20: 0.5335 - 391s/epoch - 51ms/step
Epoch 40/50
7696/7696 - 387s - loss: 2.6731 - accuracy20: 0.5542 - val_loss: 2.8440 - val_accuracy20: 0.5345 - 387s/epoch - 50ms/step
Epoch 41/50
7696/7696 - 387s - loss: 2.6716 - accuracy20: 0.5545 - val_loss: 2.8393 - val_accuracy20: 0.5353 - 387s/epoch - 50ms/step
Epoch 42/50
7696/7696 - 396s - loss: 2.6703 - accuracy20: 0.5546 - val_loss: 2.8439 - val_accuracy20: 0.5357 - 396s/epoch - 51ms/step
Epoch 43/50
7696/7696 - 391s - loss: 2.6694 - accuracy20: 0.5551 - val_loss: 2.8551 - val_accuracy20: 0.5316 - 391s/epoch - 51ms/step
Epoch 44/50
7696/7696 - 391s - loss: 2.6684 - accuracy20: 0.5553 - val_loss: 2.8459 - val_accuracy20: 0.5340 - 391s/epoch - 51ms/step
Epoch 45/50
7696/7696 - 398s - loss: 2.6673 - accuracy20: 0.5557 - val_loss: 2.8436 - val_accuracy20: 0.5341 - 398s/epoch - 52ms/step
Epoch 46/50
7696/7696 - 390s - loss: 2.6661 - accuracy20: 0.5555 - val_loss: 2.8576 - val_accuracy20: 0.5314 - 390s/epoch - 51ms/step
Epoch 47/50
7696/7696 - 392s - loss: 2.6653 - accuracy20: 0.5560 - val_loss: 2.8524 - val_accuracy20: 0.5317 - 392s/epoch - 51ms/step
Epoch 48/50
7696/7696 - 396s - loss: 2.6643 - accuracy20: 0.5565 - val_loss: 2.8536 - val_accuracy20: 0.5327 - 396s/epoch - 51ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 663s - 663s/epoch - 28ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9251493
{'0': {'precision': 0.44202637449947507, 'recall': 0.5386260928451061, 'f1-score': 0.48556842910074693, 'support': 1532811}, '1': {'precision': 0.7729910109783615, 'recall': 0.5884942598552856, 'f1-score': 0.6682419305233627, 'support': 2876147}, '2': {'precision': 0.4517207177484938, 'recall': 0.5540260694196558, 'f1-score': 0.49767010329565636, 'support': 1552010}, 'accuracy': 0.5666968854722925, 'macro avg': {'precision': 0.5555793677421101, 'recall': 0.5603821407066825, 'f1-score': 0.550493487639922, 'support': 5960968}, 'weighted avg': {'precision': 0.6042397371581489, 'recall': 0.5666968854722925, 'f1-score': 0.5768585958091395, 'support': 5960968}}
[[ 825612  244250  462949]
 [ 602846 1692596  580705]
 [ 439331  252825  859854]]
Evaluating performance on  train set...
7696/7696 - 242s - 242s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9655531
{'0': {'precision': 0.44456397016637983, 'recall': 0.5427526896322517, 'f1-score': 0.48877589196278076, 'support': 559649}, '1': {'precision': 0.7120268076862662, 'recall': 0.527556509594993, 'f1-score': 0.6060655579407112, 'support': 850652}, '2': {'precision': 0.4524092280439114, 'recall': 0.5307084135849165, 'f1-score': 0.48844080004213525, 'support': 559179}, 'accuracy': 0.5327695635396145, 'macro avg': {'precision': 0.5363333352988525, 'recall': 0.5336725376040538, 'f1-score': 0.5277607499818757, 'support': 1969480}, 'weighted avg': {'precision': 0.5623131735686315, 'recall': 0.5327695635396145, 'f1-score': 0.5393401589664385, 'support': 1969480}}
[[303751  86988 168910]
 [211599 448767 190286]
 [167906  94512 296761]]
Evaluating performance on  val set...
2338/2338 - 91s - 91s/epoch - 39ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96235424
{'0': {'precision': 0.4386519581453168, 'recall': 0.5407061974770905, 'f1-score': 0.4843617852018579, 'support': 165761}, '1': {'precision': 0.725255086454451, 'recall': 0.5321252059308073, 'f1-score': 0.6138580580101748, 'support': 267687}, '2': {'precision': 0.44379091601116466, 'recall': 0.532148333860721, 'f1-score': 0.48396987121660734, 'support': 164332}, 'accuracy': 0.5345110241225869, 'macro avg': {'precision': 0.5358993202036442, 'recall': 0.5349932457562062, 'f1-score': 0.5273965714762133, 'support': 597780}, 'weighted avg': {'precision': 0.5684060931643836, 'recall': 0.5345110241225869, 'f1-score': 0.5422427192749546, 'support': 597780}}
[[ 89628  26023  50110]
 [ 65753 142443  59491]
 [ 48945  27938  87449]]
testing model out of sample: results/universal/W8/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 407s - 407s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7837566
{'0': {'precision': 0.4674944547346276, 'recall': 0.5218367919953034, 'f1-score': 0.49317315578713755, 'support': 744363}, '1': {'precision': 0.79185450921677, 'recall': 0.7642819275967663, 'f1-score': 0.7778239444346385, 'support': 2133413}, '2': {'precision': 0.48475447713309266, 'recall': 0.4767199378187264, 'f1-score': 0.48070363725241205, 'support': 738486}, 'accuracy': 0.6556538215427975, 'macro avg': {'precision': 0.58136781369483, 'recall': 0.5876128858035986, 'f1-score': 0.5839002458247294, 'support': 3616262}, 'weighted avg': {'precision': 0.6623753128731872, 'recall': 0.6556538215427975, 'f1-score': 0.6585563962979732, 'support': 3616262}}
[[ 388436  202180  153747]
 [ 282436 1630529  220448]
 [ 160017  226418  352051]]
Evaluating performance on  train set...
4550/4550 - 154s - 154s/epoch - 34ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8155543
{'0': {'precision': 0.485152108214081, 'recall': 0.5226857468609767, 'f1-score': 0.5032200184704693, 'support': 273652}, '1': {'precision': 0.7594836803901053, 'recall': 0.7514573173695381, 'f1-score': 0.7554491802103854, 'support': 617230}, '2': {'precision': 0.507201658024677, 'recall': 0.4800141984637848, 'f1-score': 0.4932335633307639, 'support': 273269}, 'accuracy': 0.6339632917035677, 'macro avg': {'precision': 0.5839458155429544, 'recall': 0.5847190875647664, 'f1-score': 0.5839675873372062, 'support': 1164151}, 'weighted avg': {'precision': 0.6357778730172717, 'recall': 0.6339632917035677, 'f1-score': 0.6346071124910527, 'support': 1164151}}
[[143034  69588  61030]
 [ 86990 463822  66418]
 [ 64799  77297 131173]]
Evaluating performance on  val set...
1570/1570 - 60s - 60s/epoch - 38ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.805301
{'0': {'precision': 0.481329254097263, 'recall': 0.5150913861146019, 'f1-score': 0.49763833197544083, 'support': 90714}, '1': {'precision': 0.7769948998875456, 'recall': 0.761126626656367, 'f1-score': 0.7689789095006535, 'support': 218777}, '2': {'precision': 0.501009515098107, 'recall': 0.4906381770116449, 'f1-score': 0.49576961073795867, 'support': 91542}, 'accuracy': 0.6437300671017099, 'macro avg': {'precision': 0.5864445563609718, 'recall': 0.5889520632608712, 'f1-score': 0.5874622840713509, 'support': 401033}, 'weighted avg': {'precision': 0.6471171404846673, 'recall': 0.6437300671017099, 'f1-score': 0.6452371855603375, 'support': 401033}}
[[ 46726  22191  21797]
 [ 29324 166517  22936]
 [ 21027  25601  44914]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
645/645 - 25s - 25s/epoch - 39ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0341009
{'0': {'precision': 0.43111371858805125, 'recall': 0.5646875857652548, 'f1-score': 0.48894204873102887, 'support': 54655}, '1': {'precision': 0.6676525474455125, 'recall': 0.33298212341516525, 'f1-score': 0.44435070945668864, 'support': 56946}, '2': {'precision': 0.44295746450241785, 'recall': 0.5394107608349118, 'f1-score': 0.4864490051328886, 'support': 53323}, 'accuracy': 0.4765103926657127, 'macro avg': {'precision': 0.5139079101786606, 'recall': 0.479026823338444, 'f1-score': 0.473247254440202, 'support': 164924}, 'weighted avg': {'precision': 0.5166166424287825, 'recall': 0.4765103926657127, 'f1-score': 0.47273922215575653, 'support': 164924}}
[[30863  4701 19091]
 [20904 18962 17080]
 [19822  4738 28763]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0659184
{'0': {'precision': 0.4195886530041576, 'recall': 0.6033543198772552, 'f1-score': 0.49496527777777777, 'support': 18901}, '1': {'precision': 0.6356215709888934, 'recall': 0.25141586831101465, 'f1-score': 0.3603125237047713, 'support': 18893}, '2': {'precision': 0.44720469291618525, 'recall': 0.5197830578512397, 'f1-score': 0.48077014953896136, 'support': 19360}, 'accuracy': 0.4587080519298737, 'macro avg': {'precision': 0.5008049723030787, 'recall': 0.45818441534650317, 'f1-score': 0.4453493170071701, 'support': 57154}, 'weighted avg': {'precision': 0.5003556413546225, 'recall': 0.4587080519298737, 'f1-score': 0.44564568220433065, 'support': 57154}}
[[11404  1279  6218]
 [ 7922  4750  6221]
 [ 7853  1444 10063]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0648894
{'0': {'precision': 0.4285887341005451, 'recall': 0.5914409896355733, 'f1-score': 0.4970148205380347, 'support': 5982}, '1': {'precision': 0.5415750109986801, 'recall': 0.233941467122767, 'f1-score': 0.32674187126741866, 'support': 5262}, '2': {'precision': 0.4617677746310926, 'recall': 0.5169364258301351, 'f1-score': 0.48779719729176513, 'support': 5993}, 'accuracy': 0.45640192608922664, 'macro avg': {'precision': 0.4773105065767726, 'recall': 0.4474396275294918, 'f1-score': 0.43718462969907285, 'support': 17237}, 'weighted avg': {'precision': 0.47461622026040806, 'recall': 0.45640192608922664, 'f1-score': 0.44183019008164, 'support': 17237}}
[[3538  499 1945]
 [2365 1231 1666]
 [2352  543 3098]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
2179/2179 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5514111
{'0': {'precision': 0.5539198386690194, 'recall': 0.4779727378190255, 'f1-score': 0.5131514420270112, 'support': 68960}, '1': {'precision': 0.853952265774273, 'recall': 0.9175873862797548, 'f1-score': 0.8846269138271509, 'support': 421319}, '2': {'precision': 0.6401229148375768, 'recall': 0.4320528584761707, 'f1-score': 0.5158984972713845, 'support': 67501}, 'accuracy': 0.8044784682132741, 'macro avg': {'precision': 0.6826650064269564, 'recall': 0.6092043275249837, 'f1-score': 0.6378922843751822, 'support': 557780}, 'weighted avg': {'precision': 0.7909813252766642, 'recall': 0.8044784682132741, 'f1-score': 0.7940777987974468, 'support': 557780}}
[[ 32961  31613   4386]
 [ 22712 386597  12010]
 [  3832  34505  29164]]
Evaluating performance on  train set...
614/614 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61634094
{'0': {'precision': 0.5504309340787328, 'recall': 0.4883038518763432, 'f1-score': 0.5175094719782746, 'support': 24196}, '1': {'precision': 0.8194509384810634, 'recall': 0.9038282667354287, 'f1-score': 0.8595739090451272, 'support': 108587}, '2': {'precision': 0.6511290526050209, 'recall': 0.4247448979591837, 'f1-score': 0.5141192290452713, 'support': 24304}, 'accuracy': 0.7657030817317793, 'macro avg': {'precision': 0.6736703083882724, 'recall': 0.6056256721903185, 'f1-score': 0.630400870022891, 'support': 157087}, 'weighted avg': {'precision': 0.7519717508917013, 'recall': 0.7657030817317793, 'f1-score': 0.7534383175449645, 'support': 157087}}
[[11815  9903  2478]
 [ 7390 98144  3053]
 [ 2260 11721 10323]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61449903
{'0': {'precision': 0.4973072780427758, 'recall': 0.4786021027691396, 'f1-score': 0.48777543012375485, 'support': 6753}, '1': {'precision': 0.8378046173578453, 'recall': 0.8950358254117782, 'f1-score': 0.8654751224898212, 'support': 35031}, '2': {'precision': 0.6221695061462152, 'recall': 0.425767414403778, 'f1-score': 0.5055638307193551, 'support': 6776}, 'accuracy': 0.7716433278418452, 'macro avg': {'precision': 0.6524271338489455, 'recall': 0.5998017808615653, 'f1-score': 0.6196047944443104, 'support': 48560}, 'weighted avg': {'precision': 0.7603638832976174, 'recall': 0.7716433278418452, 'f1-score': 0.762728727605457, 'support': 48560}}
[[ 3232  2857   664]
 [ 2589 31354  1088]
 [  678  3213  2885]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
1162/1162 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0770717
{'0': {'precision': 0.418472950796346, 'recall': 0.5756207674943566, 'f1-score': 0.48462577859802924, 'support': 76639}, '1': {'precision': 0.6766995564406626, 'recall': 0.41211452985563174, 'f1-score': 0.5122595731741267, 'support': 145115}, '2': {'precision': 0.3732395724813829, 'recall': 0.5110753014833112, 'f1-score': 0.43141539885269575, 'support': 75709}, 'accuracy': 0.47942769352827075, 'macro avg': {'precision': 0.48947069323946385, 'recall': 0.4996035329444332, 'f1-score': 0.4761002502082839, 'support': 297463}, 'weighted avg': {'precision': 0.532934178038818, 'recall': 0.47942769352827075, 'f1-score': 0.48456383294351396, 'support': 297463}}
[[44115 13517 19007]
 [39343 59804 45968]
 [21961 15055 38693]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1455117
{'0': {'precision': 0.4441489361702128, 'recall': 0.5777505495693539, 'f1-score': 0.5022163051139479, 'support': 27749}, '1': {'precision': 0.5358711566617862, 'recall': 0.2626103178589366, 'f1-score': 0.352482303654837, 'support': 27874}, '2': {'precision': 0.4498610536273872, 'recall': 0.5442612396723774, 'f1-score': 0.49257910496075097, 'support': 27959}, 'accuracy': 0.4614510301261037, 'macro avg': {'precision': 0.4766270488197954, 'recall': 0.4615407023668893, 'f1-score': 0.44909257124317864, 'support': 83582}, 'weighted avg': {'precision': 0.4766484009588905, 'recall': 0.4614510301261037, 'f1-score': 0.44905734701585875, 'support': 83582}}
[[16032  3051  8666]
 [10611  7320  9943]
 [ 9453  3289 15217]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1006778
{'0': {'precision': 0.44921339249697456, 'recall': 0.5666598819458579, 'f1-score': 0.5011475631159714, 'support': 9826}, '1': {'precision': 0.5885659446120098, 'recall': 0.3588564741285631, 'f1-score': 0.4458638417198941, 'support': 11963}, '2': {'precision': 0.4507146988349996, 'recall': 0.5453363990802759, 'f1-score': 0.4935311680086854, 'support': 10003}, 'accuracy': 0.4817564167086059, 'macro avg': {'precision': 0.4961646786479947, 'recall': 0.49028425171823226, 'f1-score': 0.4801808576148503, 'support': 31792}, 'weighted avg': {'precision': 0.5021226825149486, 'recall': 0.4817564167086059, 'f1-score': 0.47794845770204797, 'support': 31792}}
[[5568 1405 2853]
 [3875 4293 3795]
 [2952 1596 5455]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1576246
{'0': {'precision': 0.3464951091765719, 'recall': 0.41663311669638237, 'f1-score': 0.3783409717053808, 'support': 104322}, '1': {'precision': 0.36774052690311, 'recall': 0.1404560489960807, 'f1-score': 0.2032732368302838, 'support': 107927}, '2': {'precision': 0.33673790069138904, 'recall': 0.48905580250833464, 'f1-score': 0.39884930974768973, 'support': 100784}, 'accuracy': 0.3447304277823744, 'macro avg': {'precision': 0.3503245122570236, 'recall': 0.3487149894002659, 'f1-score': 0.3268211727611181, 'support': 313033}, 'weighted avg': {'precision': 0.35067864158050827, 'recall': 0.3447304277823744, 'f1-score': 0.32458426528590256, 'support': 313033}}
[[43464 13678 47180]
 [42865 15159 49903]
 [39110 12385 49289]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1488186
{'0': {'precision': 0.36266703402672545, 'recall': 0.4183378356904497, 'f1-score': 0.38851829988193626, 'support': 31465}, '1': {'precision': 0.36425725668753556, 'recall': 0.14886193719887025, 'f1-score': 0.2113506628296457, 'support': 30095}, '2': {'precision': 0.3399883245767659, 'recall': 0.48762517164004154, 'f1-score': 0.4006383798360024, 'support': 29859}, 'accuracy': 0.3522571894245179, 'macro avg': {'precision': 0.3556375384303423, 'recall': 0.35160831484312044, 'f1-score': 0.33350244751586144, 'support': 91419}, 'weighted avg': {'precision': 0.3557832808190852, 'recall': 0.3522571894245179, 'f1-score': 0.33415359922080207, 'support': 91419}}
[[13163  4072 14230]
 [11580  4480 14035]
 [11552  3747 14560]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1500456
{'0': {'precision': 0.3568820917612235, 'recall': 0.42014171216169127, 'f1-score': 0.3859368331199317, 'support': 8609}, '1': {'precision': 0.3579705606013154, 'recall': 0.13782708308211744, 'f1-score': 0.19902489987811248, 'support': 8293}, '2': {'precision': 0.34392288348700756, 'recall': 0.4910244135950215, 'f1-score': 0.4045154293601499, 'support': 8356}, 'accuracy': 0.3508987251563861, 'macro avg': {'precision': 0.3529251786165155, 'recall': 0.34966440294627676, 'f1-score': 0.3298257207860647, 'support': 25258}, 'weighted avg': {'precision': 0.3529522290544191, 'recall': 0.3508987251563861, 'f1-score': 0.3307140161038915, 'support': 25258}}
[[3617 1056 3936]
 [3259 1143 3891]
 [3259  994 4103]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2144332
{'0': {'precision': 0.4185179944342248, 'recall': 0.5918835310892278, 'f1-score': 0.49032766105886294, 'support': 119929}, '1': {'precision': 0.5810527492801834, 'recall': 0.1630287296370952, 'f1-score': 0.254618060659513, 'support': 127499}, '2': {'precision': 0.43006971661599697, 'recall': 0.5785855665700277, 'f1-score': 0.49339379825959057, 'support': 121759}, 'accuracy': 0.4393925029862915, 'macro avg': {'precision': 0.47654682011013505, 'recall': 0.44449927576545023, 'f1-score': 0.4127798399926555, 'support': 369187}, 'weighted avg': {'precision': 0.478459283941264, 'recall': 0.4393925029862915, 'f1-score': 0.40993639987714925, 'support': 369187}}
[[70984  7021 41924]
 [55279 20786 51434]
 [43345  7966 70448]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1618861
{'0': {'precision': 0.42424242424242425, 'recall': 0.5789600153787005, 'f1-score': 0.4896706602038431, 'support': 41616}, '1': {'precision': 0.556441371525328, 'recall': 0.1882428755549191, 'f1-score': 0.28131687829932944, 'support': 41898}, '2': {'precision': 0.4410302756439223, 'recall': 0.5703866473420918, 'f1-score': 0.49743636789904494, 'support': 42778}, 'accuracy': 0.4464336616729484, 'macro avg': {'precision': 0.47390469047055817, 'recall': 0.44586317942523707, 'f1-score': 0.4228079688007392, 'support': 126292}, 'weighted avg': {'precision': 0.4737865141334101, 'recall': 0.4464336616729484, 'f1-score': 0.4231786788396239, 'support': 126292}}
[[24094  3003 14519]
 [17605  7887 16406]
 [15094  3284 24400]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.195215
{'0': {'precision': 0.43594438404760544, 'recall': 0.5959793491864831, 'f1-score': 0.5035524272165494, 'support': 12784}, '1': {'precision': 0.5657732972707156, 'recall': 0.17625430869398698, 'f1-score': 0.2687770120313048, 'support': 13055}, '2': {'precision': 0.43200433630450497, 'recall': 0.5827443334145747, 'f1-score': 0.4961781897416387, 'support': 12309}, 'accuracy': 0.448070672119115, 'macro avg': {'precision': 0.4779073392076087, 'recall': 0.45165933043168155, 'f1-score': 0.42283587632983094, 'support': 38148}, 'weighted avg': {'precision': 0.4791030926157579, 'recall': 0.448070672119115, 'f1-score': 0.42082823369861805, 'support': 38148}}
[[7619  865 4300]
 [5623 2301 5131]
 [4235  901 7173]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
5521/5521 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.537711
{'0': {'precision': 0.5404002965159377, 'recall': 0.5320866810003395, 'f1-score': 0.5362112663608553, 'support': 176740}, '1': {'precision': 0.863739496615126, 'recall': 0.8856502284717358, 'f1-score': 0.8745576489301325, 'support': 1053522}, '2': {'precision': 0.5838457765873165, 'recall': 0.50727677986102, 'f1-score': 0.5428746821012014, 'support': 183048}, 'accuracy': 0.7924298278509315, 'macro avg': {'precision': 0.6626618565727934, 'recall': 0.6416712297776984, 'f1-score': 0.6512145324640631, 'support': 1413310}, 'weighted avg': {'precision': 0.7870535919734118, 'recall': 0.7924298278509315, 'f1-score': 0.789287436897814, 'support': 1413310}}
[[ 94041  68120  14579]
 [ 68863 933052  51607]
 [ 11117  79075  92856]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5796719
{'0': {'precision': 0.4894901476360304, 'recall': 0.5421963276836158, 'f1-score': 0.5144969267981111, 'support': 45312}, '1': {'precision': 0.8529105599709191, 'recall': 0.8645203970975536, 'f1-score': 0.858676237271712, 'support': 238833}, '2': {'precision': 0.5822186623948739, 'recall': 0.4783810463968411, 'f1-score': 0.5252167630057804, 'support': 45585}, 'accuracy': 0.7668425681618294, 'macro avg': {'precision': 0.6415397900006078, 'recall': 0.6283659237260034, 'f1-score': 0.6327966423585344, 'support': 329730}, 'weighted avg': {'precision': 0.7655457588465976, 'recall': 0.7668425681618294, 'f1-score': 0.7652779931004438, 'support': 329730}}
[[ 24568  16563   4181]
 [ 20890 206476  11467]
 [  4733  19045  21807]]
Evaluating performance on  val set...
438/438 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5531938
{'0': {'precision': 0.4462988192552225, 'recall': 0.571948203113633, 'f1-score': 0.5013710860276768, 'support': 13746}, '1': {'precision': 0.8696521104342935, 'recall': 0.8576132367172563, 'f1-score': 0.8635907186785109, 'support': 84734}, '2': {'precision': 0.5975485188968335, 'recall': 0.47787019159364325, 'f1-score': 0.5310501341035693, 'support': 13466}, 'accuracy': 0.7768566987654763, 'macro avg': {'precision': 0.6378331495287831, 'recall': 0.6358105438081775, 'f1-score': 0.6320039796032523, 'support': 111946}, 'weighted avg': {'precision': 0.7849366109596276, 'recall': 0.7768566987654763, 'f1-score': 0.7791119290629416, 'support': 111946}}
[[ 7862  4963   921]
 [ 8652 72669  3413]
 [ 1102  5929  6435]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
5918/5918 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54871786
{'0': {'precision': 0.5039222231494618, 'recall': 0.4730619005517442, 'f1-score': 0.4880046642114135, 'support': 178706}, '1': {'precision': 0.8583993078475148, 'recall': 0.9095013961735015, 'f1-score': 0.8832117858044601, 'support': 1159598}, '2': {'precision': 0.5774396155629558, 'recall': 0.3876143154654111, 'f1-score': 0.46385772672940107, 'support': 176704}, 'accuracy': 0.7971495860087867, 'macro avg': {'precision': 0.6465870488533109, 'recall': 0.5900592040635523, 'f1-score': 0.611691392248425, 'support': 1515008}, 'weighted avg': {'precision': 0.7838162803232371, 'recall': 0.7971495860087867, 'f1-score': 0.7876826377562609, 'support': 1515008}}
[[  84539   78318   15849]
 [  70669 1054656   34273]
 [  12554   95657   68493]]
Evaluating performance on  train set...
1814/1814 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.58415836
{'0': {'precision': 0.5295639984184609, 'recall': 0.4598673429574717, 'f1-score': 0.49226091532530886, 'support': 64075}, '1': {'precision': 0.8384609453311743, 'recall': 0.9056760921167701, 'f1-score': 0.870773357890733, 'support': 336182}, '2': {'precision': 0.5801780024173168, 'recall': 0.4123738714816782, 'f1-score': 0.4820911738658048, 'support': 64022}, 'accuracy': 0.776125993206671, 'macro avg': {'precision': 0.6494009820556507, 'recall': 0.5926391021853067, 'f1-score': 0.6150418156939489, 'support': 464279}, 'weighted avg': {'precision': 0.7602141100345895, 'recall': 0.776125993206671, 'f1-score': 0.7649374369401332, 'support': 464279}}
[[ 29466  27250   7359]
 [ 19965 304472  11745]
 [  6211  31410  26401]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.53739476
{'0': {'precision': 0.5055024791389527, 'recall': 0.4605299399548284, 'f1-score': 0.4819693868726759, 'support': 18153}, '1': {'precision': 0.8664930038701995, 'recall': 0.919517897197738, 'f1-score': 0.8922183222721212, 'support': 126612}, '2': {'precision': 0.5959066305818674, 'recall': 0.39238180096898145, 'f1-score': 0.47318760283402167, 'support': 17957}, 'accuracy': 0.8101424515431226, 'macro avg': {'precision': 0.6559673711970065, 'recall': 0.5908098793738493, 'f1-score': 0.6157917706596062, 'support': 162722}, 'weighted avg': {'precision': 0.7963612423346671, 'recall': 0.8101424515431226, 'f1-score': 0.8002099672048526, 'support': 162722}}
[[  8360   8327   1466]
 [  6878 116422   3312]
 [  1300   9611   7046]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
3755/3755 - 63s - 63s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92540795
{'0': {'precision': 0.5100937133235589, 'recall': 0.4973427011234392, 'f1-score': 0.5036375131420683, 'support': 287510}, '1': {'precision': 0.6136952119278659, 'recall': 0.6699230143331039, 'f1-score': 0.6405776076490881, 'support': 399425}, '2': {'precision': 0.5211115150376401, 'recall': 0.4652260163075981, 'f1-score': 0.49158554042312164, 'support': 274228}, 'accuracy': 0.5598977488729799, 'macro avg': {'precision': 0.5483001467630216, 'recall': 0.544163910588047, 'f1-score': 0.545266887071426, 'support': 961163}, 'weighted avg': {'precision': 0.5562902671947278, 'recall': 0.5598977488729799, 'f1-score': 0.5571063928988785, 'support': 961163}}
[[142991  84490  60029]
 [ 74629 267584  57212]
 [ 62703  83947 127578]]
Evaluating performance on  train set...
1532/1532 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9335854
{'0': {'precision': 0.5247316806958937, 'recall': 0.5094160900348387, 'f1-score': 0.5169604744370946, 'support': 124574}, '1': {'precision': 0.5852187894797289, 'recall': 0.6368844262978085, 'f1-score': 0.609959499630908, 'support': 144012}, '2': {'precision': 0.5236951718958757, 'recall': 0.48522998503175696, 'f1-score': 0.5037293374546431, 'support': 123595}, 'accuracy': 0.548601283590995, 'macro avg': {'precision': 0.5445485473571661, 'recall': 0.5438435004548013, 'f1-score': 0.5435497705075486, 'support': 392181}, 'weighted avg': {'precision': 0.5466163773156674, 'recall': 0.548601283590995, 'f1-score': 0.5469406959186691, 'support': 392181}}
[[63460 30748 30366]
 [28114 91719 24179]
 [29364 34259 59972]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9759711
{'0': {'precision': 0.5059049858387218, 'recall': 0.5012575119794562, 'f1-score': 0.5035705262038059, 'support': 37773}, '1': {'precision': 0.550817494160756, 'recall': 0.5821274090178228, 'f1-score': 0.5660398132652162, 'support': 44157}, '2': {'precision': 0.5050722584301501, 'recall': 0.47590313192534645, 'f1-score': 0.4900540258169171, 'support': 37453}, 'accuracy': 0.5232151981437894, 'macro avg': {'precision': 0.5205982461432093, 'recall': 0.5197626843075418, 'f1-score': 0.5198881217619797, 'support': 119383}, 'weighted avg': {'precision': 0.5222558355438124, 'recall': 0.5232151981437894, 'f1-score': 0.5224360499365027, 'support': 119383}}
[[18934  9989  8850]
 [ 9836 25705  8616]
 [ 8656 10973 17824]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
4960/4960 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8378397
{'0': {'precision': 0.4985395645246946, 'recall': 0.5015678966015126, 'f1-score': 0.5000491456582189, 'support': 314434}, '1': {'precision': 0.702497971228329, 'recall': 0.739021039805667, 'f1-score': 0.7202968218728372, 'support': 644255}, '2': {'precision': 0.5281110070903456, 'recall': 0.46798781958320335, 'f1-score': 0.4962349359078177, 'support': 310991}, 'accuracy': 0.6138302564425682, 'macro avg': {'precision': 0.5763828476144565, 'recall': 0.5695255853301276, 'f1-score': 0.5721936344796247, 'support': 1269680}, 'weighted avg': {'precision': 0.6092742975328418, 'recall': 0.6138302564425682, 'f1-score': 0.6108719370191616, 'support': 1269680}}
[[157710  98579  58145]
 [ 96236 476118  71901]
 [ 62398 103053 145540]]
Evaluating performance on  train set...
1691/1691 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86664665
{'0': {'precision': 0.5207884822389667, 'recall': 0.5104895681347941, 'f1-score': 0.5155875998551347, 'support': 121311}, '1': {'precision': 0.6564764865513139, 'recall': 0.7255422776440745, 'f1-score': 0.6892836155513746, 'support': 192383}, '2': {'precision': 0.5428342990257529, 'recall': 0.4615526647083508, 'f1-score': 0.4989045582171742, 'support': 119150}, 'accuracy': 0.592601491530436, 'macro avg': {'precision': 0.5733664226053444, 'recall': 0.5658615034957398, 'f1-score': 0.5679252578745612, 'support': 432844}, 'weighted avg': {'precision': 0.5871653394987828, 'recall': 0.592601491530436, 'f1-score': 0.5881966141340129, 'support': 432844}}
[[ 61928  34953  24430]
 [ 30916 139582  21885]
 [ 26068  38088  54994]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9036383
{'0': {'precision': 0.5109254347877109, 'recall': 0.49509881962291613, 'f1-score': 0.5028876362964332, 'support': 43969}, '1': {'precision': 0.6393994265881998, 'recall': 0.6847055021410681, 'f1-score': 0.661277359447544, 'support': 61885}, '2': {'precision': 0.5217833731689424, 'recall': 0.48694787985865723, 'f1-score': 0.5037641225995865, 'support': 45280}, 'accuracy': 0.5702952346923922, 'macro avg': {'precision': 0.557369411514951, 'recall': 0.5555840672075472, 'f1-score': 0.5559763727811878, 'support': 151134}, 'weighted avg': {'precision': 0.5667848736464417, 'recall': 0.5702952346923922, 'f1-score': 0.5680062417526063, 'support': 151134}}
[[21769 10961 11239]
 [10543 42373  8969]
 [10295 12936 22049]]
testing model on single stock: results/universal/W8/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
10609/10609 - 154s - 154s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1767082
{'0': {'precision': 0.4167378288282054, 'recall': 0.5718072243401219, 'f1-score': 0.4821099461598516, 'support': 895279}, '1': {'precision': 0.5040819397154623, 'recall': 0.10118753313928905, 'f1-score': 0.16854247659080515, 'support': 893954}, '2': {'precision': 0.42885783801721644, 'recall': 0.6053954400080307, 'f1-score': 0.5020599597093812, 'support': 926449}, 'accuracy': 0.42834617602502795, 'macro avg': {'precision': 0.44989253552029473, 'recall': 0.4261300658291472, 'f1-score': 0.3842374608200127, 'support': 2715682}, 'weighted avg': {'precision': 0.4496246645097237, 'recall': 0.42834617602502795, 'f1-score': 0.3856950405898404, 'support': 2715682}}
[[511927  46256 337096]
 [393643  90457 409854]
 [322845  42736 560868]]
Evaluating performance on  train set...
3903/3903 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1436266
{'0': {'precision': 0.41932306176792006, 'recall': 0.5707867657182537, 'f1-score': 0.48346970724503574, 'support': 334102}, '1': {'precision': 0.4839094877326777, 'recall': 0.14652183820736803, 'f1-score': 0.22493586454592096, 'support': 329125}, '2': {'precision': 0.4263345515884172, 'recall': 0.5644391905572959, 'f1-score': 0.48576162037564985, 'support': 335836}, 'accuracy': 0.4288858660564949, 'macro avg': {'precision': 0.4431890336963383, 'recall': 0.4272492648276392, 'f1-score': 0.3980557307222022, 'support': 999063}, 'weighted avg': {'precision': 0.44295692483862464, 'recall': 0.4288858660564949, 'f1-score': 0.39907038103616477, 'support': 999063}}
[[190701  25565 117836]
 [143671  48224 137230]
 [120411  25866 189559]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1548463
{'0': {'precision': 0.42106096118048697, 'recall': 0.565038430420712, 'f1-score': 0.4825388325826636, 'support': 98880}, '1': {'precision': 0.45126014188844904, 'recall': 0.12059033014915368, 'f1-score': 0.19032111418770922, 'support': 95472}, '2': {'precision': 0.4175587112899746, 'recall': 0.5711378598101362, 'f1-score': 0.4824201796227064, 'support': 98281}, 'accuracy': 0.4220850006663637, 'macro avg': {'precision': 0.42995993811963684, 'recall': 0.418922206793334, 'f1-score': 0.38509337546435973, 'support': 292633}, 'weighted avg': {'precision': 0.42973726070603985, 'recall': 0.4220850006663637, 'f1-score': 0.38716246921229647, 'support': 292633}}
[[55871  7175 35834]
 [41496 11513 42463]
 [35324  6825 56132]]
training model: results/universal/W8/deepVOL_L3/h30
Epoch 1/50
7696/7696 - 477s - loss: 3.0075 - accuracy30: 0.4635 - val_loss: 3.0489 - val_accuracy30: 0.4768 - 477s/epoch - 62ms/step
Epoch 2/50
7696/7696 - 410s - loss: 2.8999 - accuracy30: 0.4975 - val_loss: 3.0903 - val_accuracy30: 0.4868 - 410s/epoch - 53ms/step
Epoch 3/50
7696/7696 - 408s - loss: 2.8710 - accuracy30: 0.5059 - val_loss: 3.0504 - val_accuracy30: 0.4917 - 408s/epoch - 53ms/step
Epoch 4/50
7696/7696 - 428s - loss: 2.8559 - accuracy30: 0.5093 - val_loss: 3.0367 - val_accuracy30: 0.4963 - 428s/epoch - 56ms/step
Epoch 5/50
7696/7696 - 434s - loss: 2.8434 - accuracy30: 0.5129 - val_loss: 3.0250 - val_accuracy30: 0.4968 - 434s/epoch - 56ms/step
Epoch 6/50
7696/7696 - 435s - loss: 2.8338 - accuracy30: 0.5152 - val_loss: 2.9990 - val_accuracy30: 0.5015 - 435s/epoch - 57ms/step
Epoch 7/50
7696/7696 - 401s - loss: 2.8272 - accuracy30: 0.5163 - val_loss: 3.0025 - val_accuracy30: 0.4989 - 401s/epoch - 52ms/step
Epoch 8/50
7696/7696 - 404s - loss: 2.8213 - accuracy30: 0.5173 - val_loss: 3.0017 - val_accuracy30: 0.5000 - 404s/epoch - 52ms/step
Epoch 9/50
7696/7696 - 411s - loss: 2.8158 - accuracy30: 0.5187 - val_loss: 2.9796 - val_accuracy30: 0.5034 - 411s/epoch - 53ms/step
Epoch 10/50
7696/7696 - 415s - loss: 2.8122 - accuracy30: 0.5194 - val_loss: 2.9827 - val_accuracy30: 0.5033 - 415s/epoch - 54ms/step
Epoch 11/50
7696/7696 - 413s - loss: 2.8080 - accuracy30: 0.5206 - val_loss: 2.9800 - val_accuracy30: 0.5025 - 413s/epoch - 54ms/step
Epoch 12/50
7696/7696 - 412s - loss: 2.8043 - accuracy30: 0.5215 - val_loss: 2.9827 - val_accuracy30: 0.5022 - 412s/epoch - 54ms/step
Epoch 13/50
7696/7696 - 413s - loss: 2.8008 - accuracy30: 0.5223 - val_loss: 2.9623 - val_accuracy30: 0.5059 - 413s/epoch - 54ms/step
Epoch 14/50
7696/7696 - 409s - loss: 2.7986 - accuracy30: 0.5230 - val_loss: 2.9770 - val_accuracy30: 0.5038 - 409s/epoch - 53ms/step
Epoch 15/50
7696/7696 - 406s - loss: 2.7960 - accuracy30: 0.5233 - val_loss: 2.9711 - val_accuracy30: 0.5044 - 406s/epoch - 53ms/step
Epoch 16/50
7696/7696 - 409s - loss: 2.7935 - accuracy30: 0.5242 - val_loss: 2.9602 - val_accuracy30: 0.5057 - 409s/epoch - 53ms/step
Epoch 17/50
7696/7696 - 412s - loss: 2.7910 - accuracy30: 0.5247 - val_loss: 2.9575 - val_accuracy30: 0.5067 - 412s/epoch - 54ms/step
Epoch 18/50
7696/7696 - 411s - loss: 2.7893 - accuracy30: 0.5252 - val_loss: 2.9525 - val_accuracy30: 0.5065 - 411s/epoch - 53ms/step
Epoch 19/50
7696/7696 - 410s - loss: 2.7873 - accuracy30: 0.5256 - val_loss: 2.9551 - val_accuracy30: 0.5072 - 410s/epoch - 53ms/step
Epoch 20/50
7696/7696 - 411s - loss: 2.7850 - accuracy30: 0.5265 - val_loss: 2.9473 - val_accuracy30: 0.5067 - 411s/epoch - 53ms/step
Epoch 21/50
7696/7696 - 410s - loss: 2.7827 - accuracy30: 0.5265 - val_loss: 2.9362 - val_accuracy30: 0.5100 - 410s/epoch - 53ms/step
Epoch 22/50
7696/7696 - 415s - loss: 2.7814 - accuracy30: 0.5269 - val_loss: 2.9393 - val_accuracy30: 0.5079 - 415s/epoch - 54ms/step
Epoch 23/50
7696/7696 - 416s - loss: 2.7799 - accuracy30: 0.5272 - val_loss: 2.9336 - val_accuracy30: 0.5096 - 416s/epoch - 54ms/step
Epoch 24/50
7696/7696 - 417s - loss: 2.7784 - accuracy30: 0.5280 - val_loss: 2.9463 - val_accuracy30: 0.5062 - 417s/epoch - 54ms/step
Epoch 25/50
7696/7696 - 422s - loss: 2.7767 - accuracy30: 0.5283 - val_loss: 2.9427 - val_accuracy30: 0.5041 - 422s/epoch - 55ms/step
Epoch 26/50
7696/7696 - 411s - loss: 2.7751 - accuracy30: 0.5289 - val_loss: 2.9382 - val_accuracy30: 0.5069 - 411s/epoch - 53ms/step
Epoch 27/50
7696/7696 - 420s - loss: 2.7738 - accuracy30: 0.5291 - val_loss: 2.9307 - val_accuracy30: 0.5077 - 420s/epoch - 55ms/step
Epoch 28/50
7696/7696 - 419s - loss: 2.7721 - accuracy30: 0.5294 - val_loss: 2.9381 - val_accuracy30: 0.5075 - 419s/epoch - 54ms/step
Epoch 29/50
7696/7696 - 429s - loss: 2.7709 - accuracy30: 0.5299 - val_loss: 2.9278 - val_accuracy30: 0.5065 - 429s/epoch - 56ms/step
Epoch 30/50
7696/7696 - 414s - loss: 2.7693 - accuracy30: 0.5302 - val_loss: 2.9243 - val_accuracy30: 0.5094 - 414s/epoch - 54ms/step
Epoch 31/50
7696/7696 - 426s - loss: 2.7684 - accuracy30: 0.5304 - val_loss: 2.9260 - val_accuracy30: 0.5088 - 426s/epoch - 55ms/step
Epoch 32/50
7696/7696 - 415s - loss: 2.7667 - accuracy30: 0.5309 - val_loss: 2.9256 - val_accuracy30: 0.5092 - 415s/epoch - 54ms/step
Epoch 33/50
7696/7696 - 420s - loss: 2.7656 - accuracy30: 0.5309 - val_loss: 2.9307 - val_accuracy30: 0.5083 - 420s/epoch - 55ms/step
Epoch 34/50
7696/7696 - 414s - loss: 2.7644 - accuracy30: 0.5317 - val_loss: 2.9362 - val_accuracy30: 0.5086 - 414s/epoch - 54ms/step
Epoch 35/50
7696/7696 - 417s - loss: 2.7628 - accuracy30: 0.5318 - val_loss: 2.9399 - val_accuracy30: 0.5094 - 417s/epoch - 54ms/step
Epoch 36/50
7696/7696 - 422s - loss: 2.7618 - accuracy30: 0.5320 - val_loss: 2.9370 - val_accuracy30: 0.5087 - 422s/epoch - 55ms/step
Epoch 37/50
7696/7696 - 423s - loss: 2.7606 - accuracy30: 0.5324 - val_loss: 2.9376 - val_accuracy30: 0.5078 - 423s/epoch - 55ms/step
Epoch 38/50
7696/7696 - 420s - loss: 2.7592 - accuracy30: 0.5331 - val_loss: 2.9420 - val_accuracy30: 0.5053 - 420s/epoch - 55ms/step
Epoch 39/50
7696/7696 - 418s - loss: 2.7579 - accuracy30: 0.5336 - val_loss: 2.9279 - val_accuracy30: 0.5080 - 418s/epoch - 54ms/step
Epoch 40/50
7696/7696 - 419s - loss: 2.7570 - accuracy30: 0.5334 - val_loss: 2.9350 - val_accuracy30: 0.5084 - 419s/epoch - 54ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 709s - 709s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93649507
{'0': {'precision': 0.4332066464793022, 'recall': 0.5350081949167054, 'f1-score': 0.4787555324490536, 'support': 1635160}, '1': {'precision': 0.698323649086548, 'recall': 0.587713671889497, 'f1-score': 0.6382619684169686, 'support': 2667583}, '2': {'precision': 0.45653222108130986, 'recall': 0.46706930603506763, 'f1-score': 0.4617406563820619, 'support': 1658225}, 'accuracy': 0.5396950629495075, 'macro avg': {'precision': 0.52935417221572, 'recall': 0.5299303909470899, 'f1-score': 0.5262527190826947, 'support': 5960968}, 'weighted avg': {'precision': 0.5583374406909904, 'recall': 0.5396950629495075, 'f1-score': 0.5454027890879772, 'support': 5960968}}
[[ 874824  331919  428417]
 [ 606233 1567775  493575]
 [ 538358  345361  774506]]
Evaluating performance on  train set...
7696/7696 - 238s - 238s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9892172
{'0': {'precision': 0.4311340469759118, 'recall': 0.5344557037465744, 'f1-score': 0.47726697660825457, 'support': 580557}, '1': {'precision': 0.6324646467086116, 'recall': 0.5181022948451925, 'f1-score': 0.5695998607880429, 'support': 808682}, '2': {'precision': 0.44659785880654346, 'recall': 0.4520587135345486, 'f1-score': 0.44931169421802586, 'support': 580241}, 'accuracy': 0.5034653817251254, 'macro avg': {'precision': 0.5033988508303556, 'recall': 0.5015389040421051, 'f1-score': 0.4987261772047744, 'support': 1969480}, 'weighted avg': {'precision': 0.5183576642218126, 'recall': 0.5034653817251254, 'f1-score': 0.5069434091868494, 'support': 1969480}}
[[310282 116129 154146]
 [218815 418980 170887]
 [190591 127347 262303]]
Evaluating performance on  val set...
2338/2338 - 69s - 69s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98142576
{'0': {'precision': 0.4285779040936309, 'recall': 0.54532818087438, 'f1-score': 0.47995512587850997, 'support': 173380}, '1': {'precision': 0.652395043006888, 'recall': 0.5229557303486082, 'f1-score': 0.5805479247994463, 'support': 253379}, '2': {'precision': 0.44175064057634633, 'recall': 0.44960560399015326, 'f1-score': 0.44564351185077217, 'support': 171021}, 'accuracy': 0.5084596339790558, 'macro avg': {'precision': 0.5075745292256217, 'recall': 0.5059631717377139, 'f1-score': 0.5020488541762428, 'support': 597780}, 'weighted avg': {'precision': 0.527215157609494, 'recall': 0.5084596339790558, 'f1-score': 0.5127767262250424, 'support': 597780}}
[[ 94549  33644  45187]
 [ 68890 132506  51983]
 [ 57172  36957  76892]]
testing model out of sample: results/universal/W8/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 451s - 451s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8281886
{'0': {'precision': 0.4765997965508268, 'recall': 0.48590148039882497, 'f1-score': 0.48120569239294525, 'support': 829236}, '1': {'precision': 0.7227365480348863, 'recall': 0.7679568064148162, 'f1-score': 0.7446607978111396, 'support': 1961958}, '2': {'precision': 0.49293863535666815, 'recall': 0.4099286361851387, 'f1-score': 0.44761764853797914, 'support': 825068}, 'accuracy': 0.6215935128594112, 'macro avg': {'precision': 0.5640916599807938, 'recall': 0.5545956409995932, 'f1-score': 0.5578280462473546, 'support': 3616262}, 'weighted avg': {'precision': 0.6138660183356478, 'recall': 0.6215935128594112, 'f1-score': 0.6164767074766812, 'support': 3616262}}
[[ 402927  280265  146044]
 [ 253394 1506699  201865]
 [ 189099  297750  338219]]
Evaluating performance on  train set...
4550/4550 - 152s - 152s/epoch - 33ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8604971
{'0': {'precision': 0.4892521500644442, 'recall': 0.49267236943871845, 'f1-score': 0.490956303132546, 'support': 301257}, '1': {'precision': 0.6867385838267499, 'recall': 0.7520749836559506, 'f1-score': 0.7179233236047775, 'support': 562896}, '2': {'precision': 0.5103626943005182, 'recall': 0.4156727711518077, 'f1-score': 0.4581765674142442, 'support': 299998}, 'accuracy': 0.5982574425482605, 'macro avg': {'precision': 0.5621178093972374, 'recall': 0.5534733747488256, 'f1-score': 0.5556853980505225, 'support': 1164151}, 'weighted avg': {'precision': 0.5901818788271224, 'recall': 0.5982574425482605, 'f1-score': 0.5922532764630831, 'support': 1164151}}
[[148421  93397  59439]
 [ 79358 423340  60198]
 [ 75584  99713 124701]]
Evaluating performance on  val set...
1570/1570 - 48s - 48s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8474612
{'0': {'precision': 0.4853918920265946, 'recall': 0.48798452719765906, 'f1-score': 0.48668475680753986, 'support': 99788}, '1': {'precision': 0.7078706472238834, 'recall': 0.7669351301782226, 'f1-score': 0.7362201522349644, 'support': 200648}, '2': {'precision': 0.5036004896665947, 'recall': 0.41711979482489536, 'f1-score': 0.45629869670887724, 'support': 100597}, 'accuracy': 0.609775255402922, 'macro avg': {'precision': 0.5656210096390242, 'recall': 0.5573464840669257, 'f1-score': 0.5597345352504605, 'support': 401033}, 'weighted avg': {'precision': 0.6012717512142841, 'recall': 0.609775255402922, 'f1-score': 0.6039120960389166, 'support': 401033}}
[[ 48695  30270  20823]
 [ 26226 153884  20538]
 [ 25400  33236  41961]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0575052
{'0': {'precision': 0.4108803807051698, 'recall': 0.5595919795253264, 'f1-score': 0.4738421721404127, 'support': 54311}, '1': {'precision': 0.5864814994658638, 'recall': 0.31360024926000934, 'f1-score': 0.40867564458279754, 'support': 57771}, '2': {'precision': 0.4322983434612503, 'recall': 0.491389425078536, 'f1-score': 0.45995376725978016, 'support': 52842}, 'accuracy': 0.45157163299459147, 'macro avg': {'precision': 0.476553407877428, 'recall': 0.45486055128795727, 'f1-score': 0.44749052799433015, 'support': 164924}, 'weighted avg': {'precision': 0.47925381464977973, 'recall': 0.45157163299459147, 'f1-score': 0.4465652048449713, 'support': 164924}}
[[30392  6746 17173]
 [22728 18117 16926]
 [20848  6028 25966]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.072917
{'0': {'precision': 0.40624196805581053, 'recall': 0.5831137345841678, 'f1-score': 0.478867753035123, 'support': 18974}, '1': {'precision': 0.5659147869674186, 'recall': 0.2399702428396833, 'f1-score': 0.33702750102615775, 'support': 18819}, '2': {'precision': 0.4346597383654679, 'recall': 0.49253654253396, 'f1-score': 0.4617917675544794, 'support': 19361}, 'accuracy': 0.4394443083598698, 'macro avg': {'precision': 0.4689388311295657, 'recall': 0.43854017331927037, 'f1-score': 0.42589567387192, 'support': 57154}, 'weighted avg': {'precision': 0.46844372523925926, 'recall': 0.4394443083598698, 'f1-score': 0.4263797406921993, 'support': 57154}}
[[11064  1664  6246]
 [ 8146  4516  6157]
 [ 8025  1800  9536]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852796
{'0': {'precision': 0.4084733201581028, 'recall': 0.5529175723123223, 'f1-score': 0.4698444270796334, 'support': 5981}, '1': {'precision': 0.48064918851435706, 'recall': 0.21380970011106998, 'f1-score': 0.29596412556053814, 'support': 5402}, '2': {'precision': 0.42757494805580293, 'recall': 0.4921421250427058, 'f1-score': 0.45759212198221094, 'support': 5854}, 'accuracy': 0.42600220455995824, 'macro avg': {'precision': 0.4388991522427543, 'recall': 0.41962313248869937, 'f1-score': 0.4078002248741275, 'support': 17237}, 'weighted avg': {'precision': 0.4375801815941776, 'recall': 0.42600220455995824, 'f1-score': 0.41118999864971734, 'support': 17237}}
[[3307  608 2066]
 [2456 1155 1791]
 [2333  640 2881]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6308129
{'0': {'precision': 0.5853209835069028, 'recall': 0.42947860177946806, 'f1-score': 0.49543346535323785, 'support': 85194}, '1': {'precision': 0.7992048163342848, 'recall': 0.9065855973729444, 'f1-score': 0.8495153566551915, 'support': 389790}, '2': {'precision': 0.646863878584744, 'recall': 0.4149113483743176, 'f1-score': 0.5055517538244189, 'support': 82796}, 'accuracy': 0.7607300369321238, 'macro avg': {'precision': 0.6771298928086438, 'recall': 0.5836585158422434, 'f1-score': 0.6168335252776161, 'support': 557780}, 'weighted avg': {'precision': 0.7439234517536132, 'recall': 0.7607300369321238, 'f1-score': 0.7443762998450597, 'support': 557780}}
[[ 36589  43986   4619]
 [ 22277 353378  14135]
 [  3645  44798  34353]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6961174
{'0': {'precision': 0.5672656629431763, 'recall': 0.4420284868919012, 'f1-score': 0.4968771149569758, 'support': 29066}, '1': {'precision': 0.7549783401537592, 'recall': 0.8919930409451368, 'f1-score': 0.8177864329763064, 'support': 98864}, '2': {'precision': 0.6555127041742287, 'recall': 0.3964056658778338, 'f1-score': 0.4940477462651479, 'support': 29157}, 'accuracy': 0.716749317257316, 'macro avg': {'precision': 0.6592522357570547, 'recall': 0.576809064571624, 'f1-score': 0.60290376473281, 'support': 157087}, 'weighted avg': {'precision': 0.7017837650198654, 'recall': 0.716749317257316, 'f1-score': 0.6983188823452097, 'support': 157087}}
[[12848 13628  2590]
 [ 7194 88186  3484]
 [ 2607 14992 11558]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.685771
{'0': {'precision': 0.5237138884597559, 'recall': 0.4197622585438336, 'f1-score': 0.46601140971888094, 'support': 8076}, '1': {'precision': 0.7820491803278689, 'recall': 0.882227838737517, 'f1-score': 0.8291234575053589, 'support': 32444}, '2': {'precision': 0.6169127027519592, 'recall': 0.4210199004975124, 'f1-score': 0.5004805204406003, 'support': 8040}, 'accuracy': 0.7289538714991762, 'macro avg': {'precision': 0.6408919238465279, 'recall': 0.5743366659262876, 'f1-score': 0.5985384625549467, 'support': 48560}, 'weighted avg': {'precision': 0.7117441330289151, 'recall': 0.7289538714991762, 'f1-score': 0.7143215194509055, 'support': 48560}}
[[ 3390  3943   743]
 [ 2462 28623  1359]
 [  621  4034  3385]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
1162/1162 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0877328
{'0': {'precision': 0.4084363524503489, 'recall': 0.53636983361527, 'f1-score': 0.4637415411482209, 'support': 79214}, '1': {'precision': 0.5921048551316375, 'recall': 0.41160619974562934, 'f1-score': 0.4856258742740876, 'support': 139167}, '2': {'precision': 0.3549237801725029, 'recall': 0.433967274474596, 'f1-score': 0.3904856180593482, 'support': 79082}, 'accuracy': 0.45077539055277466, 'macro avg': {'precision': 0.45182166258482975, 'recall': 0.46064776927849843, 'f1-score': 0.4466176778272189, 'support': 297463}, 'weighted avg': {'precision': 0.48013842387358563, 'recall': 0.45077539055277466, 'f1-score': 0.454504601019241, 'support': 297463}}
[[42488 19142 17584]
 [37094 57282 44791]
 [24444 20319 34319]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1296152
{'0': {'precision': 0.42593536274641275, 'recall': 0.5639159150628507, 'f1-score': 0.48530872308891165, 'support': 28162}, '1': {'precision': 0.44903755127800565, 'recall': 0.26259457464476843, 'f1-score': 0.3313926408942711, 'support': 27095}, '2': {'precision': 0.43494680152370946, 'recall': 0.4676081200353045, 'f1-score': 0.45068649301597563, 'support': 28325}, 'accuracy': 0.43359814314086764, 'macro avg': {'precision': 0.4366399051827093, 'recall': 0.43137286991430784, 'f1-score': 0.42246261899971954, 'support': 83582}, 'weighted avg': {'precision': 0.4364783361333913, 'recall': 0.43359814314086764, 'f1-score': 0.4236802514816314, 'support': 83582}}
[[15881  4406  7875]
 [10648  7115  9332]
 [10756  4324 13245]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1055598
{'0': {'precision': 0.4266420130235549, 'recall': 0.5258620689655172, 'f1-score': 0.4710842838755492, 'support': 10092}, '1': {'precision': 0.49993838570548366, 'recall': 0.35207845179206804, 'f1-score': 0.4131785314186781, 'support': 11523}, '2': {'precision': 0.43504182238832534, 'recall': 0.48039697356784905, 'f1-score': 0.4565958440345552, 'support': 10177}, 'accuracy': 0.4483203321590337, 'macro avg': {'precision': 0.45387407370578803, 'recall': 0.45277916477514474, 'f1-score': 0.4469528864429275, 'support': 31792}, 'weighted avg': {'precision': 0.4558971389143178, 'recall': 0.4483203321590337, 'f1-score': 0.4454584397065029, 'support': 31792}}
[[5307 2067 2718]
 [3835 4057 3631]
 [3297 1991 4889]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1223/1223 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1354262
{'0': {'precision': 0.35678776786989086, 'recall': 0.2585864667312631, 'f1-score': 0.29985164499520034, 'support': 106301}, '1': {'precision': 0.3542918692557807, 'recall': 0.33104142368034917, 'f1-score': 0.34227225207264594, 'support': 106316}, '2': {'precision': 0.3366312723653687, 'recall': 0.45810428616953475, 'f1-score': 0.3880843812086879, 'support': 100416}, 'accuracy': 0.3471966214424677, 'macro avg': {'precision': 0.34923696983034674, 'recall': 0.3492440588603824, 'f1-score': 0.34340275942551135, 'support': 313033}, 'weighted avg': {'precision': 0.34947419834322807, 'recall': 0.3471966214424677, 'f1-score': 0.34256269367588027, 'support': 313033}}
[[27488 33950 44863]
 [25334 35195 45787]
 [24221 30194 46001]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1334364
{'0': {'precision': 0.3636950308841154, 'recall': 0.2514580743856965, 'f1-score': 0.2973375289706242, 'support': 31377}, '1': {'precision': 0.34627046694966646, 'recall': 0.3421893727526968, 'f1-score': 0.3442178237717271, 'support': 30036}, '2': {'precision': 0.3422321004919711, 'recall': 0.45670865826834633, 'f1-score': 0.3912689688646519, 'support': 30006}, 'accuracy': 0.34863649788337214, 'macro avg': {'precision': 0.350732532775251, 'recall': 0.3501187018022465, 'f1-score': 0.34427477386900107, 'support': 91419}, 'weighted avg': {'precision': 0.3509254655674767, 'recall': 0.34863649788337214, 'f1-score': 0.34357084283433, 'support': 91419}}
[[ 7890 10133 13354]
 [ 6773 10278 12985]
 [ 7031  9271 13704]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1319097
{'0': {'precision': 0.37030232169701016, 'recall': 0.2567458019687319, 'f1-score': 0.30324169060320066, 'support': 8635}, '1': {'precision': 0.34653588279115966, 'recall': 0.3329357032088751, 'f1-score': 0.33959968364056703, 'support': 8383}, '2': {'precision': 0.342961576179014, 'recall': 0.46686893203883495, 'f1-score': 0.3954360898391325, 'support': 8240}, 'accuracy': 0.350581993823739, 'macro avg': {'precision': 0.3532665935557279, 'recall': 0.35218347907214725, 'f1-score': 0.3460924880276334, 'support': 25258}, 'weighted avg': {'precision': 0.35349490224907154, 'recall': 0.350581993823739, 'f1-score': 0.34538560165460297, 'support': 25258}}
[[2217 2778 3640]
 [1862 2791 3730]
 [1908 2485 3847]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1607175
{'0': {'precision': 0.4011676972479499, 'recall': 0.6243144122117227, 'f1-score': 0.48846249543573017, 'support': 121064}, '1': {'precision': 0.49126342434444964, 'recall': 0.16187807722207825, 'f1-score': 0.24351470041844572, 'support': 123488}, '2': {'precision': 0.4278147775374578, 'recall': 0.4808681349540659, 'f1-score': 0.4527926988659973, 'support': 124635}, 'accuracy': 0.4212093058531313, 'macro avg': {'precision': 0.44008196637661906, 'recall': 0.4223535414626223, 'f1-score': 0.39492329824005773, 'support': 369187}, 'weighted avg': {'precision': 0.44029935681227744, 'recall': 0.4212093058531313, 'f1-score': 0.3944889308016475, 'support': 369187}}
[[75582  9808 35674]
 [59014 19990 44484]
 [53809 10893 59933]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1438664
{'0': {'precision': 0.4046494733018525, 'recall': 0.589262099973552, 'f1-score': 0.4798104877786153, 'support': 41591}, '1': {'precision': 0.47346394128707464, 'recall': 0.1868447508257935, 'f1-score': 0.26794816785377157, 'support': 41778}, '2': {'precision': 0.4223684477751376, 'recall': 0.48451878946019616, 'f1-score': 0.4513139905818016, 'support': 42923}, 'accuracy': 0.42054128527539353, 'macro avg': {'precision': 0.4334939541213549, 'recall': 0.4202085467531805, 'f1-score': 0.3996908820713962, 'support': 126292}, 'weighted avg': {'precision': 0.4334357969391646, 'recall': 0.42054128527539353, 'f1-score': 0.4000402794439705, 'support': 126292}}
[[24508  4250 12833]
 [18363  7806 15609]
 [17695  4431 20797]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1595256
{'0': {'precision': 0.41733261339092875, 'recall': 0.5991008448957446, 'f1-score': 0.49196397313898355, 'support': 12901}, '1': {'precision': 0.47802085463095484, 'recall': 0.18357412060301506, 'f1-score': 0.2652748624269586, 'support': 12736}, '2': {'precision': 0.4207776345253444, 'recall': 0.4956438334265846, 'f1-score': 0.45515267175572527, 'support': 12511}, 'accuracy': 0.42644437454126033, 'macro avg': {'precision': 0.43871036751574266, 'recall': 0.42610626630844806, 'f1-score': 0.40413050244055576, 'support': 38148}, 'weighted avg': {'precision': 0.43872367189584766, 'recall': 0.42644437454126033, 'f1-score': 0.4042094721000222, 'support': 38148}}
[[7729 1251 3921]
 [5783 2338 4615]
 [5008 1302 6201]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
5521/5521 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6053472
{'0': {'precision': 0.5622560738879012, 'recall': 0.5107756420370697, 'f1-score': 0.5352809294770476, 'support': 215486}, '1': {'precision': 0.8109985273754313, 'recall': 0.8701020146614036, 'f1-score': 0.8395113021637853, 'support': 975350}, '2': {'precision': 0.6251409804643444, 'recall': 0.48084720012226145, 'f1-score': 0.5435813789231118, 'support': 222474}, 'accuracy': 0.7540419299375225, 'macro avg': {'precision': 0.6661318605758924, 'recall': 0.6205749522735783, 'f1-score': 0.6394578701879815, 'support': 1413310}, 'weighted avg': {'precision': 0.7438165303445528, 'recall': 0.7540419299375225, 'f1-score': 0.7465422438313459, 'support': 1413310}}
[[110065  91938  13483]
 [ 76032 848654  50664]
 [  9659 105839 106976]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64537185
{'0': {'precision': 0.5193945127719962, 'recall': 0.5046605261706469, 'f1-score': 0.5119215240155536, 'support': 54393}, '1': {'precision': 0.7956487335112338, 'recall': 0.8568119804556127, 'f1-score': 0.8250984260560613, 'support': 220626}, '2': {'precision': 0.6173970580750242, 'recall': 0.4434208842828682, 'f1-score': 0.5161427583639169, 'support': 54711}, 'accuracy': 0.730127680223213, 'macro avg': {'precision': 0.6441467681194181, 'recall': 0.6016311303030426, 'f1-score': 0.6177209028118439, 'support': 329730}, 'weighted avg': {'precision': 0.7205005115009229, 'recall': 0.730127680223213, 'f1-score': 0.7221720779294297, 'support': 329730}}
[[ 27450  22846   4097]
 [ 20654 189035  10937]
 [  4746  25705  24260]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.61941624
{'0': {'precision': 0.48222573839662447, 'recall': 0.5447449952335558, 'f1-score': 0.51158236347359, 'support': 16784}, '1': {'precision': 0.8170894689733812, 'recall': 0.8468263549145435, 'f1-score': 0.8316921886505173, 'support': 78695}, '2': {'precision': 0.6344622385578017, 'recall': 0.4402744883706807, 'f1-score': 0.5198250519825052, 'support': 16467}, 'accuracy': 0.741732621085166, 'macro avg': {'precision': 0.6445924819759358, 'recall': 0.61061527950626, 'f1-score': 0.6210332013688709, 'support': 111946}, 'weighted avg': {'precision': 0.7400194936526583, 'recall': 0.741732621085166, 'f1-score': 0.73782336399147, 'support': 111946}}
[[ 9143  6802   839]
 [ 8716 66641  3338]
 [ 1101  8116  7250]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
5918/5918 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.61915344
{'0': {'precision': 0.5624944138714744, 'recall': 0.40654097800909905, 'f1-score': 0.4719683740264193, 'support': 216726}, '1': {'precision': 0.8075469971501033, 'recall': 0.9113332060882178, 'f1-score': 0.8563067892610763, 'support': 1084521}, '2': {'precision': 0.5781387116445793, 'recall': 0.36367719088140493, 'f1-score': 0.44649036404414366, 'support': 213761}, 'accuracy': 0.7618494423791822, 'macro avg': {'precision': 0.6493933742220523, 'recall': 0.5605171249929072, 'f1-score': 0.5915885091105464, 'support': 1515008}, 'weighted avg': {'precision': 0.7401230557045199, 'recall': 0.7618494423791822, 'f1-score': 0.7435028329447116, 'support': 1515008}}
[[ 88108 112628  15990]
 [ 55425 988360  40736]
 [ 13105 122916  77740]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6544042
{'0': {'precision': 0.5551157448312423, 'recall': 0.41390850637714766, 'f1-score': 0.4742236915598629, 'support': 75896}, '1': {'precision': 0.7867782636548478, 'recall': 0.9037037274015682, 'f1-score': 0.8411973073538542, 'support': 312577}, '2': {'precision': 0.5822355576563432, 'recall': 0.373730311584835, 'f1-score': 0.4552444462298639, 'support': 75806}, 'accuracy': 0.7371041981222498, 'macro avg': {'precision': 0.6413765220474777, 'recall': 0.5637808484545169, 'f1-score': 0.5902218150478603, 'support': 464279}, 'weighted avg': {'precision': 0.7155111529314272, 'recall': 0.7371041981222498, 'f1-score': 0.718190726968642, 'support': 464279}}
[[ 31414  36843   7639]
 [ 17411 282477  12689]
 [  7765  39710  28331]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6050599
{'0': {'precision': 0.5431229570027659, 'recall': 0.39279869067103107, 'f1-score': 0.45588856057408184, 'support': 21996}, '1': {'precision': 0.819528574206189, 'recall': 0.9204596040618517, 'f1-score': 0.8670667494787978, 'support': 119059}, '2': {'precision': 0.5971585701191567, 'recall': 0.3608252180735681, 'f1-score': 0.44984032912339245, 'support': 21667}, 'accuracy': 0.7746156020697877, 'macro avg': {'precision': 0.6532700337760372, 'recall': 0.5580278376021502, 'f1-score': 0.590931879725424, 'support': 162722}, 'weighted avg': {'precision': 0.752556014659476, 'recall': 0.7746156020697877, 'f1-score': 0.7559304538765518, 'support': 162722}}
[[  8640  11754   1602]
 [  5798 109589   3672]
 [  1470  12379   7818]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
3755/3755 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97173876
{'0': {'precision': 0.5077941288711688, 'recall': 0.4571948402128314, 'f1-score': 0.4811678952778969, 'support': 305594}, '1': {'precision': 0.544494717623285, 'recall': 0.6760414202160145, 'f1-score': 0.6031791616654762, 'support': 363494}, '2': {'precision': 0.510813436269748, 'recall': 0.4104836086621587, 'f1-score': 0.45518553180341814, 'support': 292075}, 'accuracy': 0.5257641003659109, 'macro avg': {'precision': 0.521034094254734, 'recall': 0.5145732896970016, 'f1-score': 0.5131775295822637, 'support': 961163}, 'weighted avg': {'precision': 0.5225911071321939, 'recall': 0.5257641003659109, 'f1-score': 0.5194148569820808, 'support': 961163}}
[[139716 103009  62869]
 [ 65810 245737  51947]
 [ 69617 102566 119892]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9787364
{'0': {'precision': 0.5177611468325076, 'recall': 0.48687802125745305, 'f1-score': 0.5018449024500462, 'support': 131154}, '1': {'precision': 0.5141524395932456, 'recall': 0.6314824575474941, 'f1-score': 0.5668092808951786, 'support': 130911}, '2': {'precision': 0.5186323046314718, 'recall': 0.43073872544498754, 'f1-score': 0.4706168837984558, 'support': 130116}, 'accuracy': 0.5165217080888671, 'macro avg': {'precision': 0.5168486303524084, 'recall': 0.5163664014166449, 'f1-score': 0.5130903557145602, 'support': 392181}, 'weighted avg': {'precision': 0.5168455800273106, 'recall': 0.5165217080888671, 'f1-score': 0.5131694869448595, 'support': 392181}}
[[63856 37429 29869]
 [26093 82668 22150]
 [33382 40688 56046]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0161747
{'0': {'precision': 0.497954457738325, 'recall': 0.48599984932573265, 'f1-score': 0.4919045319370663, 'support': 39821}, '1': {'precision': 0.48404221434183425, 'recall': 0.5713748590048878, 'f1-score': 0.5240952775095415, 'support': 39895}, '2': {'precision': 0.49830964846671655, 'recall': 0.4198956311291502, 'f1-score': 0.45575439172549664, 'support': 39667}, 'accuracy': 0.4925659432247472, 'macro avg': {'precision': 0.49343544018229196, 'recall': 0.4924234464865902, 'f1-score': 0.4905847337240348, 'support': 119383}, 'weighted avg': {'precision': 0.49342333019353307, 'recall': 0.4925659432247472, 'f1-score': 0.4906504353139421, 'support': 119383}}
[[19353 11646  8822]
 [ 9153 22795  7947]
 [10359 12652 16656]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
4960/4960 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89052165
{'0': {'precision': 0.516366315698227, 'recall': 0.4660022742448753, 'f1-score': 0.48989326393824933, 'support': 357921}, '1': {'precision': 0.6107340292179096, 'recall': 0.7592381479001312, 'f1-score': 0.6769372122263724, 'support': 557011}, '2': {'precision': 0.5508718929103876, 'recall': 0.3947619155005807, 'f1-score': 0.45993119473204536, 'support': 354748}, 'accuracy': 0.5747408795917082, 'macro avg': {'precision': 0.5593240792755081, 'recall': 0.5400007792151956, 'f1-score': 0.542253890298889, 'support': 1269680}, 'weighted avg': {'precision': 0.5674064509922944, 'recall': 0.5747408795917082, 'f1-score': 0.5635784070870374, 'support': 1269680}}
[[166792 131767  59362]
 [ 79293 422904  54814]
 [ 76926 137781 140041]]
Evaluating performance on  train set...
1691/1691 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91935986
{'0': {'precision': 0.53756754085398, 'recall': 0.4776629535840274, 'f1-score': 0.5058478852279862, 'support': 136634}, '1': {'precision': 0.5593055076463148, 'recall': 0.7477663610593567, 'f1-score': 0.639949270099881, 'support': 162627}, '2': {'precision': 0.5604025060897129, 'recall': 0.39439150191266853, 'f1-score': 0.46296475302512374, 'support': 133583}, 'accuracy': 0.5534465072866899, 'macro avg': {'precision': 0.5524251848633359, 'recall': 0.5399402721853509, 'f1-score': 0.536253969450997, 'support': 432844}, 'weighted avg': {'precision': 0.5527821296818762, 'recall': 0.5534465072866899, 'f1-score': 0.5429976400322728, 'support': 432844}}
[[ 65265  46374  24995]
 [ 24688 121607  16332]
 [ 31455  49444  52684]]
Evaluating performance on  val set...
591/591 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9487457
{'0': {'precision': 0.5208080362070868, 'recall': 0.48322340120447377, 'f1-score': 0.5013122522924569, 'support': 48818}, '1': {'precision': 0.5395587480759364, 'recall': 0.7087890925897397, 'f1-score': 0.612703195358864, 'support': 51928}, '2': {'precision': 0.5389379119710823, 'recall': 0.40241724220052394, 'f1-score': 0.4607780757169477, 'support': 50388}, 'accuracy': 0.5337845885108579, 'macro avg': {'precision': 0.5331015654180352, 'recall': 0.5314765786649124, 'f1-score': 0.5249311744560895, 'support': 151134}, 'weighted avg': {'precision': 0.5332950685487295, 'recall': 0.5337845885108579, 'f1-score': 0.5260708956305915, 'support': 151134}}
[[23590 14606 10622]
 [ 8397 36806  6725]
 [13308 16803 20277]]
testing model on single stock: results/universal/W8/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
10609/10609 - 151s - 151s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1361864
{'0': {'precision': 0.39830688236074485, 'recall': 0.6085607288217346, 'f1-score': 0.48148122738697885, 'support': 922585}, '1': {'precision': 0.4127247121199569, 'recall': 0.10171828404591218, 'f1-score': 0.16321205580821707, 'support': 832633}, '2': {'precision': 0.4246243480251361, 'recall': 0.48670538406436886, 'f1-score': 0.4535503432216751, 'support': 960464}, 'accuracy': 0.4100649486942875, 'macro avg': {'precision': 0.4118853141686127, 'recall': 0.3989947989773386, 'f1-score': 0.3660812088056236, 'support': 2715682}, 'weighted avg': {'precision': 0.4120351978217547, 'recall': 0.4100649486942875, 'f1-score': 0.37402091949081007, 'support': 2715682}}
[[561449  58748 302388]
 [416904  84694 331035]
 [431236  61765 467463]]
Evaluating performance on  train set...
3903/3903 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1395739
{'0': {'precision': 0.3978956784391277, 'recall': 0.5929694201759289, 'f1-score': 0.47623025589322576, 'support': 334567}, '1': {'precision': 0.41484382300223416, 'recall': 0.14877606665752716, 'f1-score': 0.219008709223166, 'support': 328245}, '2': {'precision': 0.41029024091380556, 'recall': 0.4670290943372659, 'f1-score': 0.4368249323367668, 'support': 336251}, 'accuracy': 0.40464114875638474, 'macro avg': {'precision': 0.4076765807850558, 'recall': 0.40292486039024067, 'f1-score': 0.37735463248438617, 'support': 999063}, 'weighted avg': {'precision': 0.40763563251488644, 'recall': 0.40464114875638474, 'f1-score': 0.37845687619855517, 'support': 999063}}
[[198388  32144 104035]
 [157733  48835 121677]
 [142472  36740 157039]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1417125
{'0': {'precision': 0.4024453486516675, 'recall': 0.6049228493763991, 'f1-score': 0.48333546264652344, 'support': 100064}, '1': {'precision': 0.3943442289434423, 'recall': 0.12377344032694068, 'f1-score': 0.18841025807183245, 'support': 93962}, '2': {'precision': 0.4075026833314114, 'recall': 0.46587970428062914, 'f1-score': 0.43474022901485754, 'support': 98607}, 'accuracy': 0.40357717687342165, 'macro avg': {'precision': 0.4014307536421737, 'recall': 0.39819199799465627, 'f1-score': 0.36882864991107117, 'support': 292633}, 'weighted avg': {'precision': 0.4015482905302022, 'recall': 0.40357717687342165, 'f1-score': 0.3722625751903419, 'support': 292633}}
[[60531  8448 31085]
 [46623 11630 35709]
 [43254  9414 45939]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        73 (peak)  17.07 (ave)

============================================
