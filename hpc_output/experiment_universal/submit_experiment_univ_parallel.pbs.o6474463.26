This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W8/deepLOB_L1/h300
Epoch 1/50
7696/7696 - 134s - loss: 3.2412 - accuracy300: 0.3988 - val_loss: 3.5772 - val_accuracy300: 0.3290 - 134s/epoch - 17ms/step
Epoch 2/50
7696/7696 - 122s - loss: 3.2131 - accuracy300: 0.4146 - val_loss: 3.5344 - val_accuracy300: 0.3287 - 122s/epoch - 16ms/step
Epoch 3/50
7696/7696 - 117s - loss: 3.2006 - accuracy300: 0.4224 - val_loss: 3.5753 - val_accuracy300: 0.3287 - 117s/epoch - 15ms/step
Epoch 4/50
7696/7696 - 115s - loss: 3.1928 - accuracy300: 0.4261 - val_loss: 3.5757 - val_accuracy300: 0.3318 - 115s/epoch - 15ms/step
Epoch 5/50
7696/7696 - 117s - loss: 3.1860 - accuracy300: 0.4291 - val_loss: 3.5771 - val_accuracy300: 0.3321 - 117s/epoch - 15ms/step
Epoch 6/50
7696/7696 - 117s - loss: 3.1804 - accuracy300: 0.4314 - val_loss: 3.5828 - val_accuracy300: 0.3319 - 117s/epoch - 15ms/step
Epoch 7/50
7696/7696 - 117s - loss: 3.1750 - accuracy300: 0.4338 - val_loss: 3.5639 - val_accuracy300: 0.3321 - 117s/epoch - 15ms/step
Epoch 8/50
7696/7696 - 118s - loss: 3.1711 - accuracy300: 0.4350 - val_loss: 3.6072 - val_accuracy300: 0.3304 - 118s/epoch - 15ms/step
Epoch 9/50
7696/7696 - 116s - loss: 3.1675 - accuracy300: 0.4365 - val_loss: 3.5973 - val_accuracy300: 0.3293 - 116s/epoch - 15ms/step
Epoch 10/50
7696/7696 - 118s - loss: 3.1646 - accuracy300: 0.4371 - val_loss: 3.5403 - val_accuracy300: 0.3307 - 118s/epoch - 15ms/step
Epoch 11/50
7696/7696 - 116s - loss: 3.1621 - accuracy300: 0.4385 - val_loss: 3.5846 - val_accuracy300: 0.3283 - 116s/epoch - 15ms/step
Epoch 12/50
7696/7696 - 117s - loss: 3.1589 - accuracy300: 0.4397 - val_loss: 3.6082 - val_accuracy300: 0.3305 - 117s/epoch - 15ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 123s - 123s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2143016
{'0': {'precision': 0.3453360428231562, 'recall': 0.013369407227251141, 'f1-score': 0.025742224915185512, 'support': 2084610}, '1': {'precision': 0.3085348761254407, 'recall': 0.9794769833827083, 'f1-score': 0.46925470057567004, 'support': 1837303}, '2': {'precision': 0.346547771772277, 'recall': 0.008081194474891555, 'f1-score': 0.015794084550782034, 'support': 2039055}, 'accuracy': 0.3093363359776466, 'macro avg': {'precision': 0.333472896906958, 'recall': 0.33364252836161695, 'f1-score': 0.1702636700138792, 'support': 5960968}, 'weighted avg': {'precision': 0.33440759764363787, 'recall': 0.3093363359776466, 'f1-score': 0.15903970222385358, 'support': 5960968}}
[[  27870 2039754   16986]
 [  23622 1799596   14085]
 [  29212 1993365   16478]]
Evaluating performance on  train set...
7696/7696 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.178852
{'0': {'precision': 0.3373898447335292, 'recall': 0.04292984768599883, 'f1-score': 0.07616799726076712, 'support': 655488}, '1': {'precision': 0.3315862055740833, 'recall': 0.9545810025025762, 'f1-score': 0.49220022178339945, 'support': 652128}, '2': {'precision': 0.3411805236564079, 'recall': 0.004488837585969323, 'f1-score': 0.008861091724676844, 'support': 661864}, 'accuracy': 0.3318744033958202, 'macro avg': {'precision': 0.33671885798800677, 'recall': 0.3339998959248481, 'f1-score': 0.19240977025628114, 'support': 1969480}, 'weighted avg': {'precision': 0.33674205867672286, 'recall': 0.3318744033958202, 'f1-score': 0.19130409652948596, 'support': 1969480}}
[[ 28140 624462   2886]
 [ 26768 622509   2851]
 [ 28497 630396   2971]]
Evaluating performance on  val set...
2338/2338 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1798073
{'0': {'precision': 0.3335306053432533, 'recall': 0.03911149005358621, 'f1-score': 0.07001291112619627, 'support': 201731}, '1': {'precision': 0.3283217052364924, 'recall': 0.9549761345016742, 'f1-score': 0.48864633482701963, 'support': 196518}, '2': {'precision': 0.3484126984126984, 'recall': 0.0044003187474628, 'f1-score': 0.008690875076094649, 'support': 199531}, 'accuracy': 0.32861253303891064, 'macro avg': {'precision': 0.33675500299748135, 'recall': 0.3328293144342411, 'f1-score': 0.1891167070097702, 'support': 597780}, 'weighted avg': {'precision': 0.3367856427835474, 'recall': 0.32861253303891064, 'f1-score': 0.18716864732300043, 'support': 597780}}
[[  7890 193053    788]
 [  7994 187670    854]
 [  7772 190881    878]]
testing model out of sample: results/universal/W8/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 76s - 76s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2000034
{'0': {'precision': 0.32952322893647285, 'recall': 0.02156357081296806, 'f1-score': 0.040478294750817295, 'support': 1203233}, '1': {'precision': 0.3322533265444477, 'recall': 0.9696333100931659, 'f1-score': 0.49491850325587794, 'support': 1201942}, '2': {'precision': 0.3426081126382836, 'recall': 0.00843870010990127, 'f1-score': 0.01647168988739779, 'support': 1211087}, 'accuracy': 0.33227929834729897, 'macro avg': {'precision': 0.33479488937306806, 'recall': 0.3332118603386784, 'f1-score': 0.18395616263136436, 'support': 3616262}, 'weighted avg': {'precision': 0.33481276590224013, 'recall': 0.33227929834729897, 'f1-score': 0.18348139740951996, 'support': 3616262}}
[[  25946 1167475    9812]
 [  26701 1165443    9798]
 [  26091 1174776   10220]]
Evaluating performance on  train set...
4550/4550 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2004805
{'0': {'precision': 0.34669447460145136, 'recall': 0.030730777120195705, 'f1-score': 0.05645722208135702, 'support': 394881}, '1': {'precision': 0.32483657626723, 'recall': 0.964248593666939, 'f1-score': 0.4859620126624459, 'support': 378111}, '2': {'precision': 0.3511834319526627, 'recall': 0.00606914323842734, 'f1-score': 0.011932076628660608, 'support': 391159}, 'accuracy': 0.32564675888265354, 'macro avg': {'precision': 0.3409048276071147, 'recall': 0.33368283800852067, 'f1-score': 0.18478377045748784, 'support': 1164151}, 'weighted avg': {'precision': 0.34110343380991465, 'recall': 0.32564675888265354, 'f1-score': 0.18099783107561535, 'support': 1164151}}
[[ 12135 380531   2215]
 [ 11347 364593   2171]
 [ 11520 377265   2374]]
Evaluating performance on  val set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2117281
{'0': {'precision': 0.3078331637843337, 'recall': 0.011154773402537656, 'f1-score': 0.021529398372132733, 'support': 135637}, '1': {'precision': 0.32446370056784646, 'recall': 0.978614508678504, 'f1-score': 0.4873458594612772, 'support': 130322}, '2': {'precision': 0.36313032089063524, 'recall': 0.008210314346210225, 'f1-score': 0.016057569790339395, 'support': 135074}, 'accuracy': 0.3245543384210277, 'macro avg': {'precision': 0.3318090617476051, 'recall': 0.3326598654757506, 'f1-score': 0.1749776092079164, 'support': 401033}, 'weighted avg': {'precision': 0.33186244071086474, 'recall': 0.3245543384210277, 'f1-score': 0.1710608111690904, 'support': 401033}}
[[  1513 133121   1003]
 [  1845 127535    942]
 [  1557 132408   1109]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2282772
{'0': {'precision': 0.2841459476913142, 'recall': 0.015547153810819406, 'f1-score': 0.02948123084138763, 'support': 56602}, '1': {'precision': 0.3054405824564903, 'recall': 0.9661645240160895, 'f1-score': 0.4641470114615895, 'support': 50716}, '2': {'precision': 0.3741981468282252, 'recall': 0.009113633996458701, 'f1-score': 0.01779389584639631, 'support': 57606}, 'accuracy': 0.3056256214983871, 'macro avg': {'precision': 0.32126155899200987, 'recall': 0.3302751039411225, 'f1-score': 0.17047404604979113, 'support': 164924}, 'weighted avg': {'precision': 0.3221484559995748, 'recall': 0.3056256214983871, 'f1-score': 0.15906363916408586, 'support': 164924}}
[[  880 55261   461]
 [ 1299 49000   417]
 [  918 56163   525]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1930321
{'0': {'precision': 0.3707865168539326, 'recall': 0.029430280138495437, 'f1-score': 0.054532199270959904, 'support': 19062}, '1': {'precision': 0.330300503860514, 'recall': 0.9683315621679065, 'f1-score': 0.4925804794983377, 'support': 18820}, '2': {'precision': 0.3361884368308351, 'recall': 0.008146533831465338, 'f1-score': 0.015907594103044733, 'support': 19272}, 'accuracy': 0.3314203730272597, 'macro avg': {'precision': 0.3457584858484273, 'recall': 0.33530279204595576, 'f1-score': 0.1876734242907808, 'support': 57154}, 'weighted avg': {'precision': 0.3457887745657065, 'recall': 0.3314203730272597, 'f1-score': 0.18575127830450416, 'support': 57154}}
[[  561 18346   155]
 [  441 18224   155]
 [  511 18604   157]]
Evaluating performance on  val set...
68/68 - 1s - 548ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2141848
{'0': {'precision': 0.36507936507936506, 'recall': 0.007462686567164179, 'f1-score': 0.014626391096979332, 'support': 6164}, '1': {'precision': 0.3084781587599812, 'recall': 0.9881512130900884, 'f1-score': 0.47017763658329226, 'support': 5317}, '2': {'precision': 0.3670886075949367, 'recall': 0.005038220986796386, 'f1-score': 0.009940017137960583, 'support': 5756}, 'accuracy': 0.30916052677380057, 'macro avg': {'precision': 0.3468820438114277, 'recall': 0.33355070688134963, 'f1-score': 0.1649146816060774, 'support': 17237}, 'weighted avg': {'precision': 0.3482908627831109, 'recall': 0.30916052677380057, 'f1-score': 0.1535827758357746, 'support': 17237}}
[[  46 6092   26]
 [  39 5254   24]
 [  41 5686   29]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2010732
{'0': {'precision': 0.34615384615384615, 'recall': 0.0007078216918511372, 'f1-score': 0.0014127545574415539, 'support': 190726}, '1': {'precision': 0.3447074439669769, 'recall': 0.9904675678769526, 'f1-score': 0.5114259039098341, 'support': 192186}, '2': {'precision': 0.3304970025140205, 'recall': 0.00977308598485715, 'f1-score': 0.01898477552085937, 'support': 174868}, 'accuracy': 0.3445767148338054, 'macro avg': {'precision': 0.3404527642116146, 'recall': 0.3336494918512203, 'f1-score': 0.17727447799604504, 'support': 557780}, 'weighted avg': {'precision': 0.3407469488389645, 'recall': 0.3445767148338054, 'f1-score': 0.1826493913735157, 'support': 557780}}
[[   135 188840   1751]
 [   121 190354   1711]
 [   134 173025   1709]]
Evaluating performance on  train set...
614/614 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1904713
{'0': {'precision': 0.35793444942230607, 'recall': 0.028478162989644305, 'f1-score': 0.05275871057433314, 'support': 53304}, '1': {'precision': 0.3345690637202289, 'recall': 0.966079780963608, 'f1-score': 0.49701410048860173, 'support': 52594}, '2': {'precision': 0.35137895812053116, 'recall': 0.006720193791634922, 'f1-score': 0.01318816132495016, 'support': 51189}, 'accuracy': 0.3353046401038915, 'macro avg': {'precision': 0.3479608237543554, 'recall': 0.3337593792482958, 'f1-score': 0.18765365746262833, 'support': 157087}, 'weighted avg': {'precision': 0.3479753303363117, 'recall': 0.3353046401038915, 'f1-score': 0.18860439565091094, 'support': 157087}}
[[ 1518 51493   293]
 [ 1442 50810   342]
 [ 1281 49564   344]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1691804
{'0': {'precision': 0.33842394624312766, 'recall': 0.03408391780484804, 'f1-score': 0.06193057962103852, 'support': 16254}, '1': {'precision': 0.3517362675074534, 'recall': 0.9615362063910876, 'f1-score': 0.5150601463613806, 'support': 17055}, '2': {'precision': 0.36666666666666664, 'recall': 0.007212641793980723, 'f1-score': 0.01414700019291364, 'support': 15251}, 'accuracy': 0.35137973640856673, 'macro avg': {'precision': 0.35227562680574925, 'recall': 0.3342775886633054, 'f1-score': 0.19704590872511094, 'support': 48560}, 'weighted avg': {'precision': 0.3519694851299165, 'recall': 0.35137973640856673, 'f1-score': 0.20606932325568023, 'support': 48560}}
[[  554 15612    88]
 [  554 16399   102]
 [  529 14612   110]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981326
{'0': {'precision': 0.28140930502677935, 'recall': 0.05529071683951619, 'f1-score': 0.09242246028970764, 'support': 78874}, '1': {'precision': 0.4592422380163523, 'recall': 0.9475251018038017, 'f1-score': 0.618643234047046, 'support': 136046}, '2': {'precision': 0.24940991345397326, 'recall': 0.0038404225676314163, 'f1-score': 0.007564368721216025, 'support': 82543}, 'accuracy': 0.4490810621825235, 'macro avg': {'precision': 0.33002048549903495, 'recall': 0.33555208040364976, 'f1-score': 0.23954335435265658, 'support': 297463}, 'weighted avg': {'precision': 0.3538624619669881, 'recall': 0.4490810621825235, 'f1-score': 0.3095445559259812, 'support': 297463}}
[[  4361  74206    307]
 [  6492 128907    647]
 [  4644  77582    317]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.189741
{'0': {'precision': 0.3779128672745694, 'recall': 0.02634832055946032, 'f1-score': 0.04926205962954403, 'support': 28313}, '1': {'precision': 0.338561671750917, 'recall': 0.9686572438162544, 'f1-score': 0.5017525556196176, 'support': 28300}, '2': {'precision': 0.3004694835680751, 'recall': 0.007119285105120694, 'f1-score': 0.013909011880614313, 'support': 26969}, 'accuracy': 0.3391998277141011, 'macro avg': {'precision': 0.33898134086452053, 'recall': 0.3340416164936118, 'f1-score': 0.18830787570992533, 'support': 83582}, 'weighted avg': {'precision': 0.33960067746695766, 'recall': 0.3391998277141011, 'f1-score': 0.19106346055053416, 'support': 83582}}
[[  746 27334   233]
 [  673 27413   214]
 [  555 26222   192]]
Evaluating performance on  val set...
125/125 - 1s - 824ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1480236
{'0': {'precision': 0.30904359141184123, 'recall': 0.04803802588996764, 'f1-score': 0.08315098468271336, 'support': 9888}, '1': {'precision': 0.37679135494596844, 'recall': 0.9451997664525815, 'f1-score': 0.5387980220616204, 'support': 11989}, '2': {'precision': 0.3888888888888889, 'recall': 0.0070600100857286935, 'f1-score': 0.013868251609707775, 'support': 9915}, 'accuracy': 0.3735845495722194, 'macro avg': {'precision': 0.3582412784155662, 'recall': 0.33343260080942594, 'f1-score': 0.21193908611801382, 'support': 31792}, 'weighted avg': {'precision': 0.3594932033109221, 'recall': 0.3735845495722194, 'f1-score': 0.2333716072518146, 'support': 31792}}
[[  475  9369    44]
 [  591 11332    66]
 [  471  9374    70]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1834382
{'0': {'precision': 0.28876870833857377, 'recall': 0.02272479833720988, 'f1-score': 0.04213385205439231, 'support': 101035}, '1': {'precision': 0.3572394457467244, 'recall': 0.9635538354527458, 'f1-score': 0.5212313584933876, 'support': 112138}, '2': {'precision': 0.3239221671117894, 'recall': 0.008501902663729221, 'f1-score': 0.016568924971458125, 'support': 99860}, 'accuracy': 0.35522133449189064, 'macro avg': {'precision': 0.32331010706569585, 'recall': 0.3315935121512283, 'f1-score': 0.1933113785064127, 'support': 313033}, 'weighted avg': {'precision': 0.3245112528772279, 'recall': 0.35522133449189064, 'f1-score': 0.20560582644225, 'support': 313033}}
[[  2296  97778    961]
 [  3276 108051    811]
 [  2379  96632    849]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1959299
{'0': {'precision': 0.31694644284572343, 'recall': 0.02646597470213263, 'f1-score': 0.048852610503619276, 'support': 29963}, '1': {'precision': 0.329709366126277, 'recall': 0.9629286988700192, 'f1-score': 0.4912227475370601, 'support': 30266}, '2': {'precision': 0.3244274809160305, 'recall': 0.0054504648925937805, 'f1-score': 0.010720817304660403, 'support': 31190}, 'accuracy': 0.32932978921230815, 'macro avg': {'precision': 0.323694429962677, 'recall': 0.3316150461549152, 'f1-score': 0.1835987251151133, 'support': 91419}, 'weighted avg': {'precision': 0.3237242047269747, 'recall': 0.32932978921230815, 'f1-score': 0.18229799863495513, 'support': 91419}}
[[  793 28982   188]
 [  956 29144   166]
 [  753 30267   170]]
Evaluating performance on  val set...
99/99 - 1s - 676ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1678683
{'0': {'precision': 0.3101851851851852, 'recall': 0.07970497263859148, 'f1-score': 0.12682188150671966, 'support': 8406}, '1': {'precision': 0.3495814440181374, 'recall': 0.9024198086662915, 'f1-score': 0.5039439363942051, 'support': 8885}, '2': {'precision': 0.22839506172839505, 'recall': 0.0046441571482364755, 'f1-score': 0.009103210727026693, 'support': 7967}, 'accuracy': 0.34543510966822394, 'macro avg': {'precision': 0.2960538969772392, 'recall': 0.32892297948437316, 'f1-score': 0.21328967620931716, 'support': 25258}, 'weighted avg': {'precision': 0.298244962133104, 'recall': 0.34543510966822394, 'f1-score': 0.22235061725671942, 'support': 25258}}
[[ 670 7686   50]
 [ 792 8018   75]
 [ 698 7232   37]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2087324
{'0': {'precision': 0.319826168663378, 'recall': 0.02255632869449967, 'f1-score': 0.04214061315133788, 'support': 120720}, '1': {'precision': 0.334083069666731, 'recall': 0.9684930173714175, 'f1-score': 0.49679573180243985, 'support': 123306}, '2': {'precision': 0.3298070939639079, 'recall': 0.008469091809749044, 'f1-score': 0.016514118792599806, 'support': 125161}, 'accuracy': 0.3337170593764136, 'macro avg': {'precision': 0.32790544409800565, 'recall': 0.3331728126252221, 'f1-score': 0.18515015458212583, 'support': 369187}, 'weighted avg': {'precision': 0.32797159097418277, 'recall': 0.3337170593764136, 'f1-score': 0.18530455554356395, 'support': 369187}}
[[  2723 116854   1143]
 [  2874 119421   1011]
 [  2917 121184   1060]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1771673
{'0': {'precision': 0.3245220069292955, 'recall': 0.06088400982233136, 'f1-score': 0.10253187650767265, 'support': 41538}, '1': {'precision': 0.3257254204261448, 'recall': 0.9359966890641738, 'f1-score': 0.48327268384963956, 'support': 41076}, '2': {'precision': 0.3448275862068966, 'recall': 0.0036631713906314393, 'f1-score': 0.007249331702233701, 'support': 43678}, 'accuracy': 0.32572134418648846, 'macro avg': {'precision': 0.33169167118744564, 'recall': 0.3335146234257122, 'f1-score': 0.19768463068651532, 'support': 126292}, 'weighted avg': {'precision': 0.3319360830741316, 'recall': 0.32572134418648846, 'f1-score': 0.19341299653401375, 'support': 126292}}
[[ 2529 38851   158]
 [ 2483 38447   146]
 [ 2781 40737   160]]
Evaluating performance on  val set...
150/150 - 1s - 944ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2020535
{'0': {'precision': 0.27552986512524086, 'recall': 0.011353711790393014, 'f1-score': 0.021808754003355194, 'support': 12595}, '1': {'precision': 0.3222628614144219, 'recall': 0.9798684958194659, 'f1-score': 0.48501285760205726, 'support': 12319}, '2': {'precision': 0.36627906976744184, 'recall': 0.004760465467734623, 'f1-score': 0.009398776667163957, 'support': 13234}, 'accuracy': 0.32182552165251127, 'macro avg': {'precision': 0.32135726543570153, 'recall': 0.33199422435919784, 'f1-score': 0.17207346275752547, 'support': 38148}, 'weighted avg': {'precision': 0.3221031784187637, 'recall': 0.32182552165251127, 'f1-score': 0.1670844620919904, 'support': 38148}}
[[  143 12391    61]
 [  200 12071    48]
 [  176 12995    63]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
5521/5521 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2089684
{'0': {'precision': 0.27946370176586005, 'recall': 0.008869101362641012, 'f1-score': 0.017192576572951767, 'support': 481785}, '1': {'precision': 0.3231032632674268, 'recall': 0.9793962688707019, 'f1-score': 0.4859059411477886, 'support': 456859}, '2': {'precision': 0.3439799711706244, 'recall': 0.009551979707836668, 'f1-score': 0.018587794943906593, 'support': 474666}, 'accuracy': 0.32282584853995233, 'macro avg': {'precision': 0.3155156454013037, 'recall': 0.33260578331372653, 'f1-score': 0.17389543755488235, 'support': 1413310}, 'weighted avg': {'precision': 0.3152384475479787, 'recall': 0.32282584853995233, 'f1-score': 0.16917493129312144, 'support': 1413310}}
[[  4273 472669   4843]
 [  5609 447446   3804]
 [  5408 464724   4534]]
Evaluating performance on  train set...
1289/1289 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.193173
{'0': {'precision': 0.31607181957521346, 'recall': 0.026172884275418157, 'f1-score': 0.04834266864257069, 'support': 110305}, '1': {'precision': 0.33280215739151753, 'recall': 0.9655578048913935, 'f1-score': 0.49499326825984513, 'support': 109662}, '2': {'precision': 0.3574363188167625, 'recall': 0.0079261681987555, 'f1-score': 0.015508436054439958, 'support': 109763}, 'accuracy': 0.3325205471143056, 'macro avg': {'precision': 0.3354367652611645, 'recall': 0.33321895245518907, 'f1-score': 0.18628145765228524, 'support': 329730}, 'weighted avg': {'precision': 0.33540574077092417, 'recall': 0.3325205471143056, 'f1-score': 0.1859601562344142, 'support': 329730}}
[[  2887 106633    785]
 [  2998 105885    779]
 [  3249 105644    870]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2188232
{'0': {'precision': 0.3958333333333333, 'recall': 0.0009884507335344917, 'f1-score': 0.0019719771665801765, 'support': 38444}, '1': {'precision': 0.3194868827858034, 'recall': 0.9882277277557183, 'f1-score': 0.48286651181855444, 'support': 35762}, '2': {'precision': 0.37987012987012986, 'recall': 0.012400635930047695, 'f1-score': 0.024017243148927437, 'support': 37740}, 'accuracy': 0.32021689028638806, 'macro avg': {'precision': 0.3650634486630889, 'recall': 0.33387227147310017, 'f1-score': 0.16961857737802066, 'support': 111946}, 'weighted avg': {'precision': 0.3660622556424639, 'recall': 0.32021689028638806, 'f1-score': 0.16302943957164767, 'support': 111946}}
[[   38 38028   378]
 [   35 35341   386]
 [   23 37249   468]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
5918/5918 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2082403
{'0': {'precision': 0.43944954128440367, 'recall': 0.0018709804679794778, 'f1-score': 0.0037260968746292865, 'support': 512031}, '1': {'precision': 0.3291871911296861, 'recall': 0.9869165963096138, 'f1-score': 0.4937001250494705, 'support': 498647}, '2': {'precision': 0.33816614420062696, 'recall': 0.011978268197410425, 'f1-score': 0.02313699506313745, 'support': 504330}, 'accuracy': 0.32945172566745523, 'macro avg': {'precision': 0.36893429220490553, 'recall': 0.33358861499166786, 'f1-score': 0.17352107232907907, 'support': 1515008}, 'weighted avg': {'precision': 0.3694418279463483, 'recall': 0.32945172566745523, 'f1-score': 0.17145694549767973, 'support': 1515008}}
[[   958 505209   5864]
 [   565 492123   5959]
 [   657 497632   6041]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1928738
{'0': {'precision': 0.3629558336006844, 'recall': 0.021957831130433658, 'f1-score': 0.04141044411908248, 'support': 154569}, '1': {'precision': 0.3309071056127422, 'recall': 0.9759322033898306, 'f1-score': 0.49423505778147525, 'support': 153400}, '2': {'precision': 0.34806849860613304, 'recall': 0.005591452882093276, 'f1-score': 0.011006101208278501, 'support': 156310}, 'accuracy': 0.3316454114874892, 'macro avg': {'precision': 0.34731047927318653, 'recall': 0.3344938291341191, 'f1-score': 0.18221720103627873, 'support': 464279}, 'weighted avg': {'precision': 0.34735462353874175, 'recall': 0.3316454114874892, 'f1-score': 0.1807895521455564, 'support': 464279}}
[[  3394 150353    822]
 [  2877 149708    815]
 [  3080 152356    874]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1790587
{'0': {'precision': 0.30991337824831566, 'recall': 0.006118648576749135, 'f1-score': 0.01200037268238144, 'support': 52626}, '1': {'precision': 0.3628091999675266, 'recall': 0.9849954223322369, 'f1-score': 0.5302925887555736, 'support': 58982}, '2': {'precision': 0.3337628865979381, 'recall': 0.01013420980553273, 'f1-score': 0.019671135077659208, 'support': 51114}, 'accuracy': 0.36219441747274495, 'macro avg': {'precision': 0.3354951549379268, 'recall': 0.3337494269048396, 'f1-score': 0.18732136550520473, 'support': 162722}, 'weighted avg': {'precision': 0.33657815084467696, 'recall': 0.36219441747274495, 'f1-score': 0.20227578004894065, 'support': 162722}}
[[  322 51794   510]
 [  361 58097   524]
 [  356 50240   518]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
3755/3755 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1292977
{'0': {'precision': 0.31384615384615383, 'recall': 0.0007278643603356739, 'f1-score': 0.0014523604416884401, 'support': 280272}, '1': {'precision': 0.42561563835362093, 'recall': 0.9909216272121352, 'f1-score': 0.5954686137478448, 'support': 408994}, '2': {'precision': 0.28516284680337756, 'recall': 0.008694468861370298, 'f1-score': 0.016874444567378213, 'support': 271897}, 'accuracy': 0.42432865185197516, 'macro avg': {'precision': 0.3415415463343841, 'recall': 0.33344798681128035, 'f1-score': 0.20459847291897046, 'support': 961163}, 'weighted avg': {'precision': 0.35329226591209606, 'recall': 0.42432865185197516, 'f1-score': 0.25858075792704815, 'support': 961163}}
[[   204 277587   2481]
 [   268 405281   3445]
 [   178 269355   2364]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1951895
{'0': {'precision': 0.3264858942755409, 'recall': 0.027558357287628794, 'f1-score': 0.050826499140099776, 'support': 129761}, '1': {'precision': 0.33090916778537677, 'recall': 0.9653917615585658, 'f1-score': 0.4928747286571506, 'support': 129709}, '2': {'precision': 0.33061079545454547, 'recall': 0.007015243649735139, 'f1-score': 0.013738959764474975, 'support': 132711}, 'accuracy': 0.3307834902761735, 'macro avg': {'precision': 0.3293352858384877, 'recall': 0.3333217874986432, 'f1-score': 0.18581339585390844, 'support': 392181}, 'weighted avg': {'precision': 0.32934467158513564, 'recall': 0.3307834902761735, 'f1-score': 0.18447833174889164, 'support': 392181}}
[[  3576 125271    914]
 [  3518 125220    971]
 [  3859 127921    931]]
Evaluating performance on  val set...
467/467 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1748838
{'0': {'precision': 0.27744701119314125, 'recall': 0.03105258949276328, 'f1-score': 0.05585386901908141, 'support': 37517}, '1': {'precision': 0.3590587906472998, 'recall': 0.9525453576476586, 'f1-score': 0.5215289759464123, 'support': 43157}, '2': {'precision': 0.31313131313131315, 'recall': 0.005605931437133483, 'f1-score': 0.01101466930612659, 'support': 38709}, 'accuracy': 0.35592169739410134, 'macro avg': {'precision': 0.3165457049905847, 'recall': 0.3297346261925184, 'f1-score': 0.19613250475720678, 'support': 119383}, 'weighted avg': {'precision': 0.31852005517451054, 'recall': 0.35592169739410134, 'f1-score': 0.2096568393580246, 'support': 119383}}
[[ 1165 36130   222]
 [ 1794 41109   254]
 [ 1240 37252   217]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
4960/4960 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2082695
{'0': {'precision': 0.3487246963562753, 'recall': 0.0396017526195041, 'f1-score': 0.07112628662733327, 'support': 435006}, '1': {'precision': 0.3097554326115659, 'recall': 0.9563814285387321, 'f1-score': 0.46794995427199143, 'support': 393227}, '2': {'precision': 0.35761696616480493, 'recall': 0.005003998214961253, 'f1-score': 0.009869890801208156, 'support': 441447}, 'accuracy': 0.31150447356814315, 'macro avg': {'precision': 0.33869903171088206, 'recall': 0.33366239312439916, 'f1-score': 0.1829820439001776, 'support': 1269680}, 'weighted avg': {'precision': 0.33974739432397194, 'recall': 0.31150447356814315, 'f1-score': 0.1727269483599356, 'support': 1269680}}
[[ 17227 415650   2129]
 [ 15313 376075   1839]
 [ 16860 422378   2209]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2175093
{'0': {'precision': 0.3346930450744442, 'recall': 0.03251672732316594, 'f1-score': 0.0592746887567125, 'support': 151399}, '1': {'precision': 0.31459643479684507, 'recall': 0.9571622166062338, 'f1-score': 0.4735486887144093, 'support': 136515}, '2': {'precision': 0.3484033010405454, 'recall': 0.006699786103636239, 'f1-score': 0.013146760359335758, 'support': 144930}, 'accuracy': 0.31549703819389896, 'macro avg': {'precision': 0.33256426030394487, 'recall': 0.3321262433443453, 'f1-score': 0.18199004594348586, 'support': 432844}, 'weighted avg': {'precision': 0.3329453915205555, 'recall': 0.31549703819389896, 'f1-score': 0.1744877780951189, 'support': 432844}}
[[  4923 145480    996]
 [  5028 130667    820]
 [  4758 139201    971]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2626294
{'0': {'precision': 0.3178114086146682, 'recall': 0.010043411080862335, 'f1-score': 0.019471488178025034, 'support': 54364}, '1': {'precision': 0.2751167120921823, 'recall': 0.977586000239722, 'f1-score': 0.42939197548738306, 'support': 41715}, '2': {'precision': 0.36784511784511786, 'recall': 0.007937517028426119, 'f1-score': 0.015539711608555733, 'support': 55055}, 'accuracy': 0.27633093810790427, 'macro avg': {'precision': 0.32025774618398944, 'recall': 0.3318556427830035, 'f1-score': 0.1548010584246546, 'support': 151134}, 'weighted avg': {'precision': 0.3242533515014237, 'recall': 0.27633093810790427, 'f1-score': 0.13118274553294013, 'support': 151134}}
[[  546 53369   449]
 [  633 40780   302]
 [  539 54079   437]]
testing model on single stock: results/universal/W8/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
10609/10609 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2535897
{'0': {'precision': 0.3669952926547651, 'recall': 0.020042840844709697, 'f1-score': 0.03800983729913061, 'support': 1030792}, '1': {'precision': 0.2456019260847194, 'recall': 0.9723605435854696, 'f1-score': 0.39215267842866164, 'support': 667126}, '2': {'precision': 0.3814240123252999, 'recall': 0.006811009232002704, 'f1-score': 0.013383040297778438, 'support': 1017764}, 'accuracy': 0.2490273161585193, 'macro avg': {'precision': 0.3313404103549281, 'recall': 0.3330714645540607, 'f1-score': 0.14784851867519022, 'support': 2715682}, 'weighted avg': {'precision': 0.3425816685192271, 'recall': 0.2490273161585193, 'f1-score': 0.11577801104263054, 'support': 2715682}}
[[  20660 1003033    7099]
 [  14296  648687    4143]
 [  21339  989493    6932]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1641039
{'0': {'precision': 0.34096755308769006, 'recall': 0.05786455118845117, 'f1-score': 0.09893854691087293, 'support': 332155}, '1': {'precision': 0.3310356994074187, 'recall': 0.944215921939272, 'f1-score': 0.4902078505584778, 'support': 329897}, '2': {'precision': 0.354577056778679, 'recall': 0.0018159644640679384, 'f1-score': 0.0036134228029415147, 'support': 337011}, 'accuracy': 0.33163674362878015, 'macro avg': {'precision': 0.34219343642459593, 'recall': 0.3346321458639303, 'f1-score': 0.19758660675743075, 'support': 999063}, 'weighted avg': {'precision': 0.34227884548350834, 'recall': 0.33163674362878015, 'f1-score': 0.19598243109504934, 'support': 999063}}
[[ 19220 312315    620]
 [ 17909 311494    494]
 [ 19240 317159    612]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1693217
{'0': {'precision': 0.35331230283911674, 'recall': 0.05427751953318168, 'f1-score': 0.09409908867227353, 'support': 101110}, '1': {'precision': 0.3133933183310637, 'recall': 0.9465737134378511, 'f1-score': 0.4708851416259165, 'support': 91659}, '2': {'precision': 0.3794466403162055, 'recall': 0.0009613073780341264, 'f1-score': 0.0019177562252164966, 'support': 99864}, 'accuracy': 0.3155693308683573, 'macro avg': {'precision': 0.348717420495462, 'recall': 0.33393751344968897, 'f1-score': 0.1889673288411355, 'support': 292633}, 'weighted avg': {'precision': 0.3497274210137189, 'recall': 0.3155693308683573, 'f1-score': 0.18065882815546597, 'support': 292633}}
[[ 5488 95533    89]
 [ 4829 86762    68]
 [ 5216 94552    96]]
training model: results/universal/W8/deepLOB_L1/h500
Epoch 1/50
7696/7696 - 117s - loss: 3.2220 - accuracy500: 0.4118 - val_loss: 3.4655 - val_accuracy500: 0.3314 - 117s/epoch - 15ms/step
Epoch 2/50
7696/7696 - 116s - loss: 3.1890 - accuracy500: 0.4288 - val_loss: 3.5155 - val_accuracy500: 0.3286 - 116s/epoch - 15ms/step
Epoch 3/50
7696/7696 - 115s - loss: 3.1785 - accuracy500: 0.4341 - val_loss: 3.4731 - val_accuracy500: 0.3285 - 115s/epoch - 15ms/step
Epoch 4/50
7696/7696 - 114s - loss: 3.1634 - accuracy500: 0.4400 - val_loss: 3.5025 - val_accuracy500: 0.3315 - 114s/epoch - 15ms/step
Epoch 5/50
7696/7696 - 114s - loss: 3.1541 - accuracy500: 0.4432 - val_loss: 3.5224 - val_accuracy500: 0.3309 - 114s/epoch - 15ms/step
Epoch 6/50
7696/7696 - 116s - loss: 3.1481 - accuracy500: 0.4448 - val_loss: 3.4956 - val_accuracy500: 0.3291 - 116s/epoch - 15ms/step
Epoch 7/50
7696/7696 - 115s - loss: 3.1433 - accuracy500: 0.4465 - val_loss: 3.5218 - val_accuracy500: 0.3349 - 115s/epoch - 15ms/step
Epoch 8/50
7696/7696 - 116s - loss: 3.1396 - accuracy500: 0.4476 - val_loss: 3.5501 - val_accuracy500: 0.3348 - 116s/epoch - 15ms/step
Epoch 9/50
7696/7696 - 116s - loss: 3.1342 - accuracy500: 0.4496 - val_loss: 3.5598 - val_accuracy500: 0.3316 - 116s/epoch - 15ms/step
Epoch 10/50
7696/7696 - 116s - loss: 3.1299 - accuracy500: 0.4513 - val_loss: 3.5732 - val_accuracy500: 0.3343 - 116s/epoch - 15ms/step
Epoch 11/50
7696/7696 - 116s - loss: 3.1267 - accuracy500: 0.4524 - val_loss: 3.5110 - val_accuracy500: 0.3355 - 116s/epoch - 15ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.181512
{'0': {'precision': 0.34574610803684974, 'recall': 0.2496375198045361, 'f1-score': 0.28993474746801146, 'support': 2142186}, '1': {'precision': 0.28325884582278604, 'recall': 0.7262896682590404, 'f1-score': 0.4075643127486098, 'support': 1715887}, '2': {'precision': 0.35241869363213996, 'recall': 0.0024528091036404576, 'f1-score': 0.0048717114412964915, 'support': 2102895}, 'accuracy': 0.2996424406237376, 'macro avg': {'precision': 0.3271412158305919, 'recall': 0.3261266657224056, 'f1-score': 0.2341235905526393, 'support': 5960968}, 'weighted avg': {'precision': 0.33011285283177305, 'recall': 0.2996424406237376, 'f1-score': 0.2232310524867989, 'support': 5960968}}
[[ 534770 1602093    5323]
 [ 465501 1246231    4155]
 [ 546442 1551295    5158]]
Evaluating performance on  train set...
7696/7696 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1604675
{'0': {'precision': 0.32650673392315155, 'recall': 0.6035593829587084, 'f1-score': 0.42376815858899314, 'support': 653765}, '1': {'precision': 0.31786845166793354, 'recall': 0.36872257135295167, 'f1-score': 0.34141219130800277, 'support': 649868}, '2': {'precision': 0.3296426068675543, 'recall': 0.0035323430157378497, 'f1-score': 0.0069897857595002545, 'support': 665847}, 'accuracy': 0.32321171070536386, 'macro avg': {'precision': 0.32467259748621313, 'recall': 0.325271432442466, 'f1-score': 0.2573900452188321, 'support': 1969480}, 'weighted avg': {'precision': 0.3247165499049222, 'recall': 0.32321171070536386, 'f1-score': 0.2556876820376385, 'support': 1969480}}
[[394586 256866   2313]
 [407777 239621   2470]
 [406145 257350   2352]]
Evaluating performance on  val set...
2338/2338 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1571901
{'0': {'precision': 0.339070723301197, 'recall': 0.5733983115508627, 'f1-score': 0.4261461437291583, 'support': 203145}, '1': {'precision': 0.3214886059087521, 'recall': 0.4222565897043355, 'f1-score': 0.36504620980557223, 'support': 192042}, '2': {'precision': 0.33117529880478086, 'recall': 0.003282443124885855, 'f1-score': 0.006500456987013749, 'support': 202593}, 'accuracy': 0.3316253471176687, 'macro avg': {'precision': 0.3305782093382433, 'recall': 0.3329791147933614, 'f1-score': 0.26589760350724806, 'support': 597780}, 'weighted avg': {'precision': 0.3307464857501208, 'recall': 0.3316253471176687, 'f1-score': 0.2642955764222819, 'support': 597780}}
[[116483  85948    714]
 [110322  81091    629]
 [116731  85197    665]]
testing model out of sample: results/universal/W8/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 76s - 76s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1686883
{'0': {'precision': 0.34248369262588496, 'recall': 0.27610048121127684, 'f1-score': 0.30573013775782154, 'support': 1247477}, '1': {'precision': 0.3104061202434446, 'recall': 0.7229161426833732, 'f1-score': 0.43432257904927124, 'support': 1117243}, '2': {'precision': 0.37095648126599956, 'recall': 0.0025472577028977056, 'f1-score': 0.005059771326269546, 'support': 1251542}, 'accuracy': 0.3194707684343668, 'macro avg': {'precision': 0.3412820980451097, 'recall': 0.33385462719918263, 'f1-score': 0.24837082937778743, 'support': 3616262}, 'weighted avg': {'precision': 0.3424274045690328, 'recall': 0.3194707684343668, 'f1-score': 0.24140056571390042, 'support': 3616262}}
[[344429 900130   2918]
 [307082 807673   2488]
 [354169 894185   3188]]
Evaluating performance on  train set...
4550/4550 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1620781
{'0': {'precision': 0.32726669165283506, 'recall': 0.3915619274576879, 'f1-score': 0.3565388833150564, 'support': 390255}, '1': {'precision': 0.3230209897428951, 'recall': 0.5828592378416608, 'f1-score': 0.41567474850493724, 'support': 384592}, '2': {'precision': 0.32466340269277844, 'recall': 0.002725376569467563, 'f1-score': 0.005405377866990004, 'support': 389304}, 'accuracy': 0.32472849312503277, 'macro avg': {'precision': 0.3249836946961695, 'recall': 0.32571551395627213, 'f1-score': 0.2592063365623279, 'support': 1164151}, 'weighted avg': {'precision': 0.3249935039012002, 'recall': 0.32472849312503277, 'f1-score': 0.25865252876152567, 'support': 1164151}}
[[152809 236355   1091]
 [159313 224163   1116]
 [154803 233440   1061]]
Evaluating performance on  val set...
1570/1570 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1744132
{'0': {'precision': 0.30348555088601015, 'recall': 0.20489813230368714, 'f1-score': 0.24463264504299997, 'support': 136746}, '1': {'precision': 0.3009882001105224, 'recall': 0.7160876693683104, 'f1-score': 0.4238306014180632, 'support': 129304}, '2': {'precision': 0.3290083410565338, 'recall': 0.002629960809879763, 'f1-score': 0.005218209345739443, 'support': 134983}, 'accuracy': 0.30163851852590684, 'macro avg': {'precision': 0.31116069735102214, 'recall': 0.3078719208272924, 'f1-score': 0.2245604852689342, 'support': 401033}, 'weighted avg': {'precision': 0.31127100829453797, 'recall': 0.30163851852590684, 'f1-score': 0.22182687538663223, 'support': 401033}}
[[ 28019 108375    352]
 [ 36339  92593    372]
 [ 27966 106662    355]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2261015
{'0': {'precision': 0.34950258059690326, 'recall': 0.14723955379088674, 'f1-score': 0.20719242622441963, 'support': 63468}, '1': {'precision': 0.2130137631634258, 'recall': 0.7691965454069615, 'f1-score': 0.33363415007917724, 'support': 38210}, '2': {'precision': 0.2727272727272727, 'recall': 0.0009012427663409544, 'f1-score': 0.0017965487353242455, 'support': 63246}, 'accuracy': 0.23521743348451407, 'macro avg': {'precision': 0.2784145388292006, 'recall': 0.30577911398806307, 'f1-score': 0.18087437501297368, 'support': 164924}, 'weighted avg': {'precision': 0.28843827924806487, 'recall': 0.23521743348451407, 'f1-score': 0.15772037000952646, 'support': 164924}}
[[ 9345 54031    92]
 [ 8759 29391    60]
 [ 8634 54555    57]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1525202
{'0': {'precision': 0.3558027256615535, 'recall': 0.3080260303687636, 'f1-score': 0.3301950998185118, 'support': 18901}, '1': {'precision': 0.3375854102148159, 'recall': 0.7277592327663859, 'f1-score': 0.46122332477039585, 'support': 18873}, '2': {'precision': 0.26666666666666666, 'recall': 0.0014447884416924665, 'f1-score': 0.0028740056453682317, 'support': 19380}, 'accuracy': 0.34267067921755257, 'macro avg': {'precision': 0.3200182675143453, 'recall': 0.34574335052561395, 'f1-score': 0.2647641434114253, 'support': 57154}, 'weighted avg': {'precision': 0.31956252868938734, 'recall': 0.34267067921755257, 'f1-score': 0.26247303109963627, 'support': 57154}}
[[ 5822 13038    41]
 [ 5102 13735    36]
 [ 5439 13913    28]]
Evaluating performance on  val set...
68/68 - 1s - 555ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1740711
{'0': {'precision': 0.35908200391827594, 'recall': 0.387789028260541, 'f1-score': 0.3728838189348252, 'support': 6617}, '1': {'precision': 0.26934953680645485, 'recall': 0.5416666666666666, 'f1-score': 0.3597897678131861, 'support': 4992}, '2': {'precision': 0.2692307692307692, 'recall': 0.0024875621890547263, 'f1-score': 0.004929577464788733, 'support': 5628}, 'accuracy': 0.306549863665371, 'macro avg': {'precision': 0.2992207699851666, 'recall': 0.31064775237208747, 'f1-score': 0.2458677214042667, 'support': 17237}, 'weighted avg': {'precision': 0.3037575724833686, 'recall': 0.306549863665371, 'f1-score': 0.248952045761269, 'support': 17237}}
[[2566 4031   20]
 [2270 2704   18]
 [2310 3304   14]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
2179/2179 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1956518
{'0': {'precision': 0.3341404358353511, 'recall': 0.0006494148207756272, 'f1-score': 0.0012963102126700233, 'support': 212499}, '1': {'precision': 0.2773233292807103, 'recall': 0.998286896373392, 'f1-score': 0.43406401126584787, 'support': 154690}, '2': {'precision': 0.36311787072243346, 'recall': 0.0010021459565247048, 'f1-score': 0.0019987756191233645, 'support': 190591}, 'accuracy': 0.27744630499480083, 'macro avg': {'precision': 0.3248605452794983, 'recall': 0.33331281905023075, 'f1-score': 0.14578636569921374, 'support': 557780}, 'weighted avg': {'precision': 0.3282847222558512, 'recall': 0.27744630499480083, 'f1-score': 0.12155648314858998, 'support': 557780}}
[[   138 212162    199]
 [   129 154425    136]
 [   146 190254    191]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1593052
{'0': {'precision': 0.33824193014650583, 'recall': 0.41840949687406964, 'f1-score': 0.37407881822567496, 'support': 53744}, '1': {'precision': 0.31301385822228633, 'recall': 0.5444877634524821, 'f1-score': 0.3975087889868183, 'support': 51812}, '2': {'precision': 0.3786610878661088, 'recall': 0.0035124488172168207, 'f1-score': 0.00696033378838278, 'support': 51531}, 'accuracy': 0.3238905829253853, 'macro avg': {'precision': 0.3433056254116336, 'recall': 0.32213656971458954, 'f1-score': 0.25951598033362533, 'support': 157087}, 'weighted avg': {'precision': 0.34318010296737067, 'recall': 0.3238905829253853, 'f1-score': 0.26137675518760217, 'support': 157087}}
[[22487 31110   147]
 [23451 28211   150]
 [20544 30806   181]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.162564
{'0': {'precision': 0.3342444357672784, 'recall': 0.30527817403708984, 'f1-score': 0.3191053122087605, 'support': 16824}, '1': {'precision': 0.3102677222457243, 'recall': 0.6493802175562864, 'f1-score': 0.41990757780231464, 'support': 15812}, '2': {'precision': 0.34, 'recall': 0.0021351419241396634, 'f1-score': 0.004243634548177734, 'support': 15924}, 'accuracy': 0.3179159802306425, 'macro avg': {'precision': 0.32817071933766756, 'recall': 0.31893117783917196, 'f1-score': 0.2477521748530843, 'support': 48560}, 'weighted avg': {'precision': 0.3283245801379342, 'recall': 0.3179159802306425, 'f1-score': 0.24867755414653145, 'support': 48560}}
[[ 5136 11646    42]
 [ 5520 10268    24]
 [ 4710 11180    34]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1148198
{'0': {'precision': 0.2592083731269094, 'recall': 0.6322249315479028, 'f1-score': 0.36767303868366225, 'support': 73409}, '1': {'precision': 0.5077676935531978, 'recall': 0.40979930948156096, 'f1-score': 0.4535534724045931, 'support': 145398}, '2': {'precision': 0.29186155285313375, 'recall': 0.003966639544344996, 'f1-score': 0.007826904985888995, 'support': 78656}, 'accuracy': 0.3573789009053227, 'macro avg': {'precision': 0.35294587317774706, 'recall': 0.3486636268579362, 'f1-score': 0.27635113869138145, 'support': 297463}, 'weighted avg': {'precision': 0.38933681456630653, 'recall': 0.3573789009053227, 'f1-score': 0.3144993189606172, 'support': 297463}}
[[46411 26740   258]
 [85315 59584   499]
 [47323 31021   312]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1401522
{'0': {'precision': 0.35512472292466674, 'recall': 0.405078166731954, 'f1-score': 0.37846020761245674, 'support': 28081}, '1': {'precision': 0.35545550228043504, 'recall': 0.6301440862444283, 'f1-score': 0.4545216643612845, 'support': 28941}, '2': {'precision': 0.34285714285714286, 'recall': 0.0031626506024096386, 'f1-score': 0.006267487409065474, 'support': 26560}, 'accuracy': 0.35529180924122417, 'macro avg': {'precision': 0.35114578935408153, 'recall': 0.34612830119293064, 'f1-score': 0.27974978646093557, 'support': 83582}, 'weighted avg': {'precision': 0.35134096755559036, 'recall': 0.35529180924122417, 'f1-score': 0.28652481447955436, 'support': 83582}}
[[11375 16619    87]
 [10630 18237    74]
 [10026 16450    84]]
Evaluating performance on  val set...
125/125 - 1s - 854ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1444504
{'0': {'precision': 0.289596167008898, 'recall': 0.43506426735218506, 'f1-score': 0.347729607561126, 'support': 9725}, '1': {'precision': 0.363360205631499, 'recall': 0.49967866323907456, 'f1-score': 0.4207535682878983, 'support': 12448}, '2': {'precision': 0.28125, 'recall': 0.0018712963925563988, 'f1-score': 0.0037178560363523706, 'support': 9619}, 'accuracy': 0.3292966784096628, 'macro avg': {'precision': 0.3114021242134657, 'recall': 0.31220474232793866, 'f1-score': 0.2574003439617922, 'support': 31792}, 'weighted avg': {'precision': 0.3159528911003533, 'recall': 0.3292966784096628, 'f1-score': 0.2722374468040193, 'support': 31792}}
[[4231 5473   21]
 [6203 6220   25]
 [4176 5425   18]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.153235
{'0': {'precision': 0.31669630554345135, 'recall': 0.2665589500604667, 'f1-score': 0.28947269272792836, 'support': 100882}, '1': {'precision': 0.3404881395890971, 'recall': 0.7026121841417369, 'f1-score': 0.4586924382793775, 'support': 110176}, '2': {'precision': 0.3159947984395319, 'recall': 0.002382936994361363, 'f1-score': 0.0047302032235459, 'support': 101975}, 'accuracy': 0.33397437330888435, 'macro avg': {'precision': 0.32439308119069343, 'recall': 0.32385135706552165, 'f1-score': 0.25096511141028394, 'support': 313033}, 'weighted avg': {'precision': 0.32484162223814766, 'recall': 0.33397437330888435, 'f1-score': 0.2562728042774042, 'support': 313033}}
[[26891 73729   262]
 [32501 77411   264]
 [25519 76213   243]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1622533
{'0': {'precision': 0.32548438849808714, 'recall': 0.4408156443255892, 'f1-score': 0.37447110606275735, 'support': 29915}, '1': {'precision': 0.32113949540016584, 'recall': 0.5380900400251397, 'f1-score': 0.40222538171478023, 'support': 30231}, '2': {'precision': 0.356, 'recall': 0.002845905413615579, 'f1-score': 0.005646670684896743, 'support': 31273}, 'accuracy': 0.3231603933536792, 'macro avg': {'precision': 0.3342079612994177, 'recall': 0.32725052992144815, 'f1-score': 0.26078105282081143, 'support': 91419}, 'weighted avg': {'precision': 0.3344865024487545, 'recall': 0.3231603933536792, 'f1-score': 0.2574800313372021, 'support': 91419}}
[[13187 16647    81]
 [13884 16267    80]
 [13444 17740    89]]
Evaluating performance on  val set...
99/99 - 1s - 727ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1411831
{'0': {'precision': 0.32507507507507505, 'recall': 0.6403746610796155, 'f1-score': 0.4312391069798323, 'support': 8114}, '1': {'precision': 0.3863685932388222, 'recall': 0.3803951041442989, 'f1-score': 0.3833585803938541, 'support': 9314}, '2': {'precision': 0.2980769230769231, 'recall': 0.003959131545338442, 'f1-score': 0.007814469372321654, 'support': 7830}, 'accuracy': 0.34721672341436377, 'macro avg': {'precision': 0.3365068637969401, 'recall': 0.34157629892308433, 'f1-score': 0.2741373855820027, 'support': 25258}, 'weighted avg': {'precision': 0.33930788440406434, 'recall': 0.34721672341436377, 'f1-score': 0.28232097660178934, 'support': 25258}}
[[5196 2886   32]
 [5730 3543   41]
 [5058 2741   31]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1666441
{'0': {'precision': 0.29491354808147796, 'recall': 0.25026799772201935, 'f1-score': 0.270762734900241, 'support': 119404}, '1': {'precision': 0.32879067050152794, 'recall': 0.6957090217520504, 'f1-score': 0.4465450550456616, 'support': 126195}, '2': {'precision': 0.2958083832335329, 'recall': 0.0019985759135191117, 'f1-score': 0.003970327029568488, 'support': 123588}, 'accuracy': 0.31941807268403277, 'macro avg': {'precision': 0.306504200605513, 'recall': 0.3159918651291963, 'f1-score': 0.2404260389918237, 'support': 369187}, 'weighted avg': {'precision': 0.3067929326496518, 'recall': 0.31941807268403277, 'f1-score': 0.24153773452598806, 'support': 369187}}
[[29883 89258   263]
 [38075 87795   325]
 [33370 89971   247]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1608201
{'0': {'precision': 0.32246678758762687, 'recall': 0.6429950392219154, 'f1-score': 0.429524066047977, 'support': 40921}, '1': {'precision': 0.3265167624304393, 'recall': 0.3448572452514634, 'f1-score': 0.3354364927202798, 'support': 41855}, '2': {'precision': 0.336734693877551, 'recall': 0.0037917087967644083, 'f1-score': 0.007498977412171068, 'support': 43516}, 'accuracy': 0.3239397586545466, 'macro avg': {'precision': 0.3285727479652057, 'recall': 0.3305479977567144, 'f1-score': 0.25748651206014267, 'support': 126292}, 'weighted avg': {'precision': 0.3287252513633075, 'recall': 0.3239397586545466, 'f1-score': 0.25292634696278954, 'support': 126292}}
[[26312 14451   158]
 [27254 14434   167]
 [28030 15321   165]]
Evaluating performance on  val set...
150/150 - 1s - 945ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1596695
{'0': {'precision': 0.32560782763391977, 'recall': 0.5398607128226137, 'f1-score': 0.40621435837366304, 'support': 12205}, '1': {'precision': 0.33586540625703354, 'recall': 0.4735422451408171, 'f1-score': 0.3929946999374527, 'support': 12605}, '2': {'precision': 0.36428571428571427, 'recall': 0.0038236617183985606, 'f1-score': 0.007567888410743434, 'support': 13338}, 'accuracy': 0.33052846807172065, 'macro avg': {'precision': 0.3419196493922225, 'recall': 0.3390755398939432, 'f1-score': 0.2689256489072864, 'support': 38148}, 'weighted avg': {'precision': 0.342520442468406, 'recall': 0.33052846807172065, 'f1-score': 0.2624642165325743, 'support': 38148}}
[[6589 5562   54]
 [6601 5969   35]
 [7046 6241   51]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
5521/5521 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1758765
{'0': {'precision': 0.3357511034291182, 'recall': 0.3511942355459867, 'f1-score': 0.343299081928217, 'support': 495589}, '1': {'precision': 0.2851896895906769, 'recall': 0.6025529590576613, 'f1-score': 0.3871434849215407, 'support': 421080}, '2': {'precision': 0.3684910680349677, 'recall': 0.0039042286077871136, 'f1-score': 0.007726592588607758, 'support': 496641}, 'accuracy': 0.304045113952353, 'macro avg': {'precision': 0.3298106203515876, 'recall': 0.3192171410704784, 'f1-score': 0.24605638647945516, 'support': 1413310}, 'weighted avg': {'precision': 0.33219180548508814, 'recall': 0.304045113952353, 'f1-score': 0.23844094361059093, 'support': 1413310}}
[[174048 319675   1866]
 [165900 253723   1457]
 [178436 316266   1939]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1683055
{'0': {'precision': 0.30890608674092834, 'recall': 0.318337774208855, 'f1-score': 0.31355101967445914, 'support': 109588}, '1': {'precision': 0.31135729708190857, 'recall': 0.6169517356616263, 'f1-score': 0.4138544774855503, 'support': 108921}, '2': {'precision': 0.31649484536082473, 'recall': 0.0027602700928781435, 'f1-score': 0.005472809761923862, 'support': 111221}, 'accuracy': 0.31053286021896703, 'macro avg': {'precision': 0.31225274306122053, 'recall': 0.3126832599877865, 'f1-score': 0.24429276897397778, 'support': 329730}, 'weighted avg': {'precision': 0.3122755635977912, 'recall': 0.31053286021896703, 'f1-score': 0.24276700349018648, 'support': 329730}}
[[34886 74387   315]
 [41374 67199   348]
 [36674 74240   307]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1642011
{'0': {'precision': 0.418436873747495, 'recall': 0.05382136873308416, 'f1-score': 0.09537512846865365, 'support': 38795}, '1': {'precision': 0.31676029962546814, 'recall': 0.9486021927487872, 'f1-score': 0.47493033278816255, 'support': 35663}, '2': {'precision': 0.3974358974358974, 'recall': 0.001653862569355527, 'f1-score': 0.003294017638933163, 'support': 37488}, 'accuracy': 0.3214049631072124, 'macro avg': {'precision': 0.37754435693628685, 'recall': 0.3346924746837423, 'f1-score': 0.1911998262985831, 'support': 111946}, 'weighted avg': {'precision': 0.37901272046928036, 'recall': 0.3214049631072124, 'f1-score': 0.18545552945539803, 'support': 111946}}
[[ 2088 36659    48]
 [ 1787 33830    46]
 [ 1115 36311    62]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
5918/5918 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.163567
{'0': {'precision': 0.5299884659746251, 'recall': 0.012350680218560771, 'f1-score': 0.024138836772983115, 'support': 520862}, '1': {'precision': 0.32406232928730366, 'recall': 0.9921353150055171, 'f1-score': 0.4885492426505999, 'support': 490293}, '2': {'precision': 0.3806629834254144, 'recall': 0.0013674623352446051, 'f1-score': 0.0027251351196350138, 'support': 503853}, 'accuracy': 0.32577979786245354, 'macro avg': {'precision': 0.4115712595624477, 'recall': 0.3352844858531075, 'f1-score': 0.17180440484773932, 'support': 1515008}, 'weighted avg': {'precision': 0.4136839740553056, 'recall': 0.32577979786245354, 'f1-score': 0.16731155487731653, 'support': 1515008}}
[[  6433 513893    536]
 [  3271 486437    585]
 [  2434 500730    689]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1552937
{'0': {'precision': 0.33782845487881613, 'recall': 0.40327917683854714, 'f1-score': 0.36766368437054464, 'support': 154429}, '1': {'precision': 0.3393027038088844, 'recall': 0.6167334473172451, 'f1-score': 0.4377644631066005, 'support': 153238}, '2': {'precision': 0.36838340486409155, 'recall': 0.003288381477792251, 'f1-score': 0.006518574773748497, 'support': 156612}, 'accuracy': 0.3388048996400871, 'macro avg': {'precision': 0.348504854517264, 'recall': 0.3411003352111948, 'f1-score': 0.27064890741696457, 'support': 464279}, 'weighted avg': {'precision': 0.3486219277359554, 'recall': 0.3388048996400871, 'f1-score': 0.2689782931031866, 'support': 464279}}
[[62278 91705   446]
 [58294 94507   437]
 [63776 92321   515]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436749
{'0': {'precision': 0.3456439393939394, 'recall': 0.16269826529475132, 'f1-score': 0.22125123127825627, 'support': 53842}, '1': {'precision': 0.35316569540007164, 'recall': 0.8485295667755877, 'f1-score': 0.49874796705991686, 'support': 56922}, '2': {'precision': 0.35609756097560974, 'recall': 0.0042149428384464374, 'f1-score': 0.00833127270652236, 'support': 51958}, 'accuracy': 0.3520052605056477, 'macro avg': {'precision': 0.3516357319232069, 'recall': 0.3384809249695951, 'f1-score': 0.24277682368156517, 'support': 162722}, 'weighted avg': {'precision': 0.3516130318677382, 'recall': 0.3520052605056477, 'f1-score': 0.25033625964991796, 'support': 162722}}
[[ 8760 44895   187]
 [ 8413 48300   209]
 [ 8171 43568   219]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
3755/3755 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1335397
{'0': {'precision': 0.29934640522875816, 'recall': 0.0007390553646060253, 'f1-score': 0.0014744704140106882, 'support': 309855}, '1': {'precision': 0.3675727675700577, 'recall': 0.9981631382316314, 'f1-score': 0.5372892162351773, 'support': 353320}, '2': {'precision': 0.3354632587859425, 'recall': 0.0010570895472300898, 'f1-score': 0.0021075379607730315, 'support': 297988}, 'accuracy': 0.3674870963613872, 'macro avg': {'precision': 0.3341274771949195, 'recall': 0.3333197610478225, 'f1-score': 0.18029040820332035, 'support': 961163}, 'weighted avg': {'precision': 0.3356234230709204, 'recall': 0.3674870963613872, 'f1-score': 0.19863427840251965, 'support': 961163}}
[[   229 309361    265]
 [   290 352671    359]
 [   246 297427    315]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.148105
{'0': {'precision': 0.3428308336105446, 'recall': 0.5465326293298902, 'f1-score': 0.42135357413727725, 'support': 130113}, '1': {'precision': 0.3600067799946416, 'recall': 0.5081185368112363, 'f1-score': 0.42142790850990974, 'support': 129580}, '2': {'precision': 0.3395822174611676, 'recall': 0.004785339049574301, 'f1-score': 0.009437683748278814, 'support': 132488}, 'accuracy': 0.3508252567054498, 'macro avg': {'precision': 0.3474732770221179, 'recall': 0.35314550173023357, 'f1-score': 0.28407305546515527, 'support': 392181}, 'weighted avg': {'precision': 0.3474084558718286, 'recall': 0.3508252567054498, 'f1-score': 0.28222322300386715, 'support': 392181}}
[[71111 58365   637]
 [63142 65842   596]
 [73170 58684   634]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1646459
{'0': {'precision': 0.32870354152800646, 'recall': 0.4770098874005541, 'f1-score': 0.3892074618662962, 'support': 39343}, '1': {'precision': 0.3312311533348465, 'recall': 0.5323761628058472, 'f1-score': 0.40837905635674954, 'support': 38377}, '2': {'precision': 0.2784184514003295, 'recall': 0.0040563569594124285, 'f1-score': 0.007996214809557606, 'support': 41663}, 'accuracy': 0.3297538175452116, 'macro avg': {'precision': 0.31278438208772746, 'recall': 0.33781413572193797, 'f1-score': 0.26852757767753443, 'support': 119383}, 'weighted avg': {'precision': 0.3119672763003082, 'recall': 0.3297538175452116, 'f1-score': 0.26233298305134956, 'support': 119383}}
[[18767 20357   219]
 [17727 20431   219]
 [20600 20894   169]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
4960/4960 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1808692
{'0': {'precision': 0.3673377561362021, 'recall': 0.5363571419459363, 'f1-score': 0.4360414768926555, 'support': 470334}, '1': {'precision': 0.24985515267340602, 'recall': 0.45551431985798385, 'f1-score': 0.32270350324233643, 'support': 317147}, '2': {'precision': 0.39464248048934825, 'recall': 0.003880140771756059, 'f1-score': 0.007684725017455949, 'support': 482199}, 'accuracy': 0.31393973284607146, 'macro avg': {'precision': 0.33727846309965215, 'recall': 0.33191720085855875, 'f1-score': 0.2554765683841493, 'support': 1269680}, 'weighted avg': {'precision': 0.34836215247067004, 'recall': 0.31393973284607146, 'f1-score': 0.24505004934654384, 'support': 1269680}}
[[252267 216333   1734]
 [171546 144465   1136]
 [262931 217397   1871]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1754624
{'0': {'precision': 0.30850020729002836, 'recall': 0.31692164166492026, 'f1-score': 0.31265422630083634, 'support': 147923}, '1': {'precision': 0.29789492874071055, 'recall': 0.5881850584042065, 'f1-score': 0.39548877889511624, 'support': 141685}, '2': {'precision': 0.2973451327433628, 'recall': 0.0023457789941076267, 'f1-score': 0.004654835626116952, 'support': 143236}, 'accuracy': 0.3016167487593683, 'macro avg': {'precision': 0.30124675625803393, 'recall': 0.30248415968774484, 'f1-score': 0.23759928027402313, 'support': 432844}, 'weighted avg': {'precision': 0.3013373099204766, 'recall': 0.3016167487593683, 'f1-score': 0.2378462420423886, 'support': 432844}}
[[ 46880 100665    378]
 [ 57932  83337    416]
 [ 47149  95751    336]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2170938
{'0': {'precision': 0.23662781414657513, 'recall': 0.10905679121364313, 'f1-score': 0.14930297573322923, 'support': 54357}, '1': {'precision': 0.23394805215442924, 'recall': 0.6954673217280393, 'f1-score': 0.350119504857486, 'support': 42337}, '2': {'precision': 0.4, 'recall': 0.0016531961792799412, 'f1-score': 0.0032927833165645294, 'support': 54440}, 'accuracy': 0.23463945902311856, 'macro avg': {'precision': 0.2901919554336681, 'recall': 0.2687257697069874, 'f1-score': 0.16757175463575993, 'support': 151134}, 'weighted avg': {'precision': 0.2947254540846365, 'recall': 0.23463945902311856, 'f1-score': 0.15296313505125453, 'support': 151134}}
[[ 5928 48362    67]
 [12825 29444    68]
 [ 6299 48051    90]]
testing model on single stock: results/universal/W8/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
10609/10609 - 71s - 71s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2016926
{'0': {'precision': 0.3541409744506513, 'recall': 0.3257892376199601, 'f1-score': 0.3393740005313534, 'support': 1023361}, '1': {'precision': 0.23104128405318905, 'recall': 0.6033333284068925, 'f1-score': 0.3341302691274822, 'support': 676621}, '2': {'precision': 0.3553921568627451, 'recall': 0.002569656394604706, 'f1-score': 0.005102419837269951, 'support': 1015700}, 'accuracy': 0.2740519692659155, 'macro avg': {'precision': 0.3135248051221951, 'recall': 0.31056407414048576, 'f1-score': 0.2262022298320352, 'support': 2715682}, 'weighted avg': {'precision': 0.3239382446610597, 'recall': 0.2740519692659155, 'f1-score': 0.2130456368653574, 'support': 2715682}}
[[333400 687242   2719]
 [266378 408228   2015]
 [341655 671435   2610]]
Evaluating performance on  train set...
3903/3903 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1624566
{'0': {'precision': 0.32433613014795365, 'recall': 0.7663110425084366, 'f1-score': 0.45577041640602856, 'support': 330405}, '1': {'precision': 0.29225909107827447, 'recall': 0.19074528427931156, 'f1-score': 0.23083452761547793, 'support': 329324}, '2': {'precision': 0.33189531205061834, 'recall': 0.00340077917332186, 'f1-score': 0.006732572758750449, 'support': 339334}, 'accuracy': 0.3174614613893218, 'macro avg': {'precision': 0.3161635110922822, 'recall': 0.32015236865369, 'f1-score': 0.231112505593419, 'support': 999063}, 'weighted avg': {'precision': 0.31632997699962945, 'recall': 0.3174614613893218, 'f1-score': 0.22910743891985927, 'support': 999063}}
[[253193  76083   1129]
 [265313  62817   1194]
 [262144  76036   1154]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1521585
{'0': {'precision': 0.34115626101162827, 'recall': 0.8514025322527456, 'f1-score': 0.48712282557424846, 'support': 100069}, '1': {'precision': 0.3117955344963745, 'recall': 0.14028381928592962, 'f1-score': 0.19350526870781135, 'support': 92876}, '2': {'precision': 0.3324324324324324, 'recall': 0.0037015488323569536, 'f1-score': 0.007321573840750808, 'support': 99688}, 'accuracy': 0.33693055807103095, 'macro avg': {'precision': 0.3284614093134784, 'recall': 0.33179596679034407, 'f1-score': 0.2293165560409369, 'support': 292633}, 'weighted avg': {'precision': 0.3288658909602889, 'recall': 0.33693055807103095, 'f1-score': 0.230485838650914, 'support': 292633}}
[[85199 14463   407]
 [79513 13029   334]
 [85024 14295   369]]
training model: results/universal/W8/deepLOB_L1/h1000
Epoch 1/50
7696/7696 - 118s - loss: 3.1744 - accuracy1000: 0.4364 - val_loss: 3.3864 - val_accuracy1000: 0.3292 - 118s/epoch - 15ms/step
Epoch 2/50
7696/7696 - 119s - loss: 3.1240 - accuracy1000: 0.4572 - val_loss: 3.5371 - val_accuracy1000: 0.3279 - 119s/epoch - 16ms/step
Epoch 3/50
7696/7696 - 116s - loss: 3.1035 - accuracy1000: 0.4649 - val_loss: 3.4126 - val_accuracy1000: 0.3313 - 116s/epoch - 15ms/step
Epoch 4/50
7696/7696 - 117s - loss: 3.0898 - accuracy1000: 0.4700 - val_loss: 3.5756 - val_accuracy1000: 0.3349 - 117s/epoch - 15ms/step
Epoch 5/50
7696/7696 - 115s - loss: 3.0745 - accuracy1000: 0.4746 - val_loss: 3.4116 - val_accuracy1000: 0.3313 - 115s/epoch - 15ms/step
Epoch 6/50
7696/7696 - 114s - loss: 3.0609 - accuracy1000: 0.4784 - val_loss: 3.5481 - val_accuracy1000: 0.3318 - 114s/epoch - 15ms/step
Epoch 7/50
7696/7696 - 120s - loss: 3.0535 - accuracy1000: 0.4804 - val_loss: 3.5151 - val_accuracy1000: 0.3217 - 120s/epoch - 16ms/step
Epoch 8/50
7696/7696 - 117s - loss: 3.0464 - accuracy1000: 0.4826 - val_loss: 3.5326 - val_accuracy1000: 0.3326 - 117s/epoch - 15ms/step
Epoch 9/50
7696/7696 - 118s - loss: 3.0431 - accuracy1000: 0.4831 - val_loss: 3.5464 - val_accuracy1000: 0.3221 - 118s/epoch - 15ms/step
Epoch 10/50
7696/7696 - 118s - loss: 3.0367 - accuracy1000: 0.4853 - val_loss: 3.5827 - val_accuracy1000: 0.3224 - 118s/epoch - 15ms/step
Epoch 11/50
7696/7696 - 119s - loss: 3.0338 - accuracy1000: 0.4857 - val_loss: 3.5479 - val_accuracy1000: 0.3340 - 119s/epoch - 15ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 120s - 120s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1197377
{'0': {'precision': 0.31383703149747527, 'recall': 0.1977843182803321, 'f1-score': 0.24264837013861365, 'support': 2087845}, '1': {'precision': 0.29773751859903325, 'recall': 0.32781478364202543, 'f1-score': 0.3120530765916486, 'support': 1840399}, '2': {'precision': 0.3474883203219715, 'recall': 0.44768743813719913, 'f1-score': 0.39127489552494854, 'support': 2032724}, 'accuracy': 0.32314852218632945, 'macro avg': {'precision': 0.3196876234728267, 'recall': 0.3244288466865189, 'f1-score': 0.31532544741840357, 'support': 5960968}, 'weighted avg': {'precision': 0.3203417225117041, 'recall': 0.32314852218632945, 'f1-score': 0.31475898330427254, 'support': 5960968}}
[[412943 724513 950389]
 [478638 603310 758451]
 [424207 698492 910025]]
Evaluating performance on  train set...
7696/7696 - 44s - 44s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1312617
{'0': {'precision': 0.3211116073848017, 'recall': 0.5318660263384752, 'f1-score': 0.4004521288217558, 'support': 646127}, '1': {'precision': 0.31919987185310505, 'recall': 0.2232703485471956, 'f1-score': 0.26275310225240683, 'support': 651533}, '2': {'precision': 0.3498326024957446, 'recall': 0.23096960495370783, 'f1-score': 0.278238260674661, 'support': 671820}, 'accuracy': 0.32713762008245834, 'macro avg': {'precision': 0.33004802724455046, 'recall': 0.32870199327979294, 'f1-score': 0.3138144972496079, 'support': 1969480}, 'weighted avg': {'precision': 0.330276351453927, 'recall': 0.32713762008245834, 'f1-score': 0.3132102270119436, 'support': 1969480}}
[[343653 152274 150200]
 [367880 145468 138185]
 [358665 157985 155170]]
Evaluating performance on  val set...
2338/2338 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1301569
{'0': {'precision': 0.33282152373971013, 'recall': 0.4892888869471507, 'f1-score': 0.3961654560890482, 'support': 206001}, '1': {'precision': 0.2941387684754792, 'recall': 0.2435695055628237, 'f1-score': 0.26647622089343914, 'support': 184978}, '2': {'precision': 0.3567866137121976, 'recall': 0.24456844986242812, 'f1-score': 0.29020708174823123, 'support': 206801}, 'accuracy': 0.3285924587640938, 'macro avg': {'precision': 0.327915635309129, 'recall': 0.3258089474574675, 'f1-score': 0.31761625291023954, 'support': 597780}, 'weighted avg': {'precision': 0.3291421531822032, 'recall': 0.3285924587640938, 'f1-score': 0.3193780876256191, 'support': 597780}}
[[100794  54306  50901]
 [ 99644  45055  40279]
 [102409  53815  50577]]
testing model out of sample: results/universal/W8/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 73s - 73s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250898
{'0': {'precision': 0.313615738462019, 'recall': 0.2319127415218465, 'f1-score': 0.2666459712360987, 'support': 1255580}, '1': {'precision': 0.28803234104361825, 'recall': 0.30781783708678284, 'f1-score': 0.2975965955377652, 'support': 1105472}, '2': {'precision': 0.3568113140411159, 'recall': 0.42820882561483736, 'f1-score': 0.38926327117822873, 'support': 1255210}, 'accuracy': 0.32325119142363024, 'macro avg': {'precision': 0.3194864645155844, 'recall': 0.3226464680744889, 'f1-score': 0.3178352793173642, 'support': 3616262}, 'weighted avg': {'precision': 0.32078827986298053, 'recall': 0.32325119142363024, 'f1-score': 0.31866806189445607, 'support': 3616262}}
[[291185 421707 542688]
 [338992 340284 426196]
 [298300 419418 537492]]
Evaluating performance on  train set...
4550/4550 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.129435
{'0': {'precision': 0.3149663967924958, 'recall': 0.34214780777135745, 'f1-score': 0.3279949251918026, 'support': 392158}, '1': {'precision': 0.3042674876392171, 'recall': 0.26851669204731055, 'f1-score': 0.2852763821903799, 'support': 380211}, '2': {'precision': 0.3464070956476815, 'recall': 0.3559836848043044, 'f1-score': 0.3511301053002599, 'support': 391782}, 'accuracy': 0.32275624038462364, 'macro avg': {'precision': 0.32188032669313144, 'recall': 0.3222160615409908, 'f1-score': 0.32146713756081413, 'support': 1164151}, 'weighted avg': {'precision': 0.32205315523775346, 'recall': 0.32275624038462364, 'f1-score': 0.3218289614810277, 'support': 1164151}}
[[134176 116456 141526]
 [156499 102093 121619]
 [135326 116988 139468]]
Evaluating performance on  val set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1224726
{'0': {'precision': 0.31851188577877, 'recall': 0.18241914182145166, 'f1-score': 0.23197870230576126, 'support': 142348}, '1': {'precision': 0.28067754814466883, 'recall': 0.32227184629645234, 'f1-score': 0.30004001161121263, 'support': 118670}, '2': {'precision': 0.36133499953615533, 'recall': 0.47291361639824303, 'f1-score': 0.4096626307746562, 'support': 140015}, 'accuracy': 0.32522510616333317, 'macro avg': {'precision': 0.32017481115319807, 'recall': 0.32586820150538237, 'f1-score': 0.3138937815638767, 'support': 401033}, 'weighted avg': {'precision': 0.32226738077719036, 'recall': 0.32522510616333317, 'f1-score': 0.3141546100735765, 'support': 401033}}
[[25967 49574 66807]
 [30197 38244 50229]
 [25362 48438 66215]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.116055
{'0': {'precision': 0.3396570733376421, 'recall': 0.1475158099829929, 'f1-score': 0.2056961296709875, 'support': 60563}, '1': {'precision': 0.27370482341624297, 'recall': 0.3383230354375013, 'f1-score': 0.30260271761321017, 'support': 47097}, '2': {'precision': 0.355263976120888, 'recall': 0.4988299804414641, 'f1-score': 0.4149808598885733, 'support': 57264}, 'accuracy': 0.32398559336421623, 'macro avg': {'precision': 0.3228752909582577, 'recall': 0.3282229419539861, 'f1-score': 0.30775990239092366, 'support': 164924}, 'weighted avg': {'precision': 0.32624217051229015, 'recall': 0.32398559336421623, 'f1-score': 0.3060362279192394, 'support': 164924}}
[[ 8934 21580 30049]
 [ 9372 15934 21791]
 [ 7997 20702 28565]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1201936
{'0': {'precision': 0.35025608194622276, 'recall': 0.2965954678521089, 'f1-score': 0.32120002348382554, 'support': 18446}, '1': {'precision': 0.3433288948069241, 'recall': 0.3362545644235785, 'f1-score': 0.33975490842008166, 'support': 19170}, '2': {'precision': 0.3458412056768751, 'recall': 0.4028559729757396, 'f1-score': 0.37217769581767035, 'support': 19538}, 'accuracy': 0.34622248661511007, 'macro avg': {'precision': 0.34647539414334066, 'recall': 0.34523533508380905, 'f1-score': 0.34437754257385916, 'support': 57154}, 'weighted avg': {'precision': 0.3464234187903479, 'recall': 0.34622248661511007, 'f1-score': 0.34485014257062074, 'support': 57154}}
[[5471 5920 7055]
 [4891 6446 7833]
 [5258 6409 7871]]
Evaluating performance on  val set...
68/68 - 1s - 588ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1276346
{'0': {'precision': 0.3586654309545876, 'recall': 0.2780971543546996, 'f1-score': 0.3132842224560835, 'support': 6958}, '1': {'precision': 0.26397876223660194, 'recall': 0.34017532606371603, 'f1-score': 0.2972720478325859, 'support': 4677}, '2': {'precision': 0.3181427343078246, 'recall': 0.33023920028561227, 'f1-score': 0.32407812910571954, 'support': 5602}, 'accuracy': 0.3118872193537158, 'macro avg': {'precision': 0.31359564249967137, 'recall': 0.316170560234676, 'f1-score': 0.3115447997981296, 'support': 17237}, 'weighted avg': {'precision': 0.3198038137236782, 'recall': 0.3118872193537158, 'f1-score': 0.31244756435648163, 'support': 17237}}
[[1935 2505 2518]
 [1639 1591 1447]
 [1821 1931 1850]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1113977
{'0': {'precision': 0.3655793025871766, 'recall': 0.004572913344464664, 'f1-score': 0.009032837839715764, 'support': 213212}, '1': {'precision': 0.27863205914188177, 'recall': 0.41047772756617174, 'f1-score': 0.3319420407886253, 'support': 154900}, '2': {'precision': 0.34033207307075825, 'recall': 0.5866039606048463, 'f1-score': 0.43075279141436823, 'support': 189668}, 'accuracy': 0.3152102979669404, 'macro avg': {'precision': 0.32818114493327216, 'recall': 0.3338848671718276, 'f1-score': 0.2572425566809031, 'support': 557780}, 'weighted avg': {'precision': 0.33284826250399646, 'recall': 0.3152102979669404, 'f1-score': 0.24210934773857062, 'support': 557780}}
[[   975  87159 125078]
 [   739  63583  90578]
 [   953  77455 111260]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1270891
{'0': {'precision': 0.318273273027661, 'recall': 0.36812032920253523, 'f1-score': 0.3413868126469453, 'support': 52855}, '1': {'precision': 0.285218007798653, 'recall': 0.22978942157572066, 'f1-score': 0.25452091483281847, 'support': 52522}, '2': {'precision': 0.3613602043289398, 'recall': 0.37484045639141367, 'f1-score': 0.36797691482595946, 'support': 51710}, 'accuracy': 0.32408155989992804, 'macro avg': {'precision': 0.3216171617184179, 'recall': 0.32425006905655657, 'f1-score': 0.32129488076857443, 'support': 157087}, 'weighted avg': {'precision': 0.32140463703124605, 'recall': 0.32408155989992804, 'f1-score': 0.32109616796395596, 'support': 157087}}
[[19457 15198 18200]
 [24397 12069 16056]
 [17279 15048 19383]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1182978
{'0': {'precision': 0.33256880733944955, 'recall': 0.2803327670045111, 'f1-score': 0.3042248148265887, 'support': 17069}, '1': {'precision': 0.3024484215759384, 'recall': 0.3138380190869229, 'f1-score': 0.3080379746835443, 'support': 15508}, '2': {'precision': 0.34469026548672566, 'recall': 0.3899142839266721, 'f1-score': 0.36591022517100663, 'support': 15983}, 'accuracy': 0.3271004942339374, 'macro avg': {'precision': 0.3265691648007045, 'recall': 0.328028356672702, 'f1-score': 0.32605767156037985, 'support': 48560}, 'weighted avg': {'precision': 0.3269392835162902, 'recall': 0.3271004942339374, 'f1-score': 0.32574566319142606, 'support': 48560}}
[[4785 5867 6417]
 [5210 4867 5431]
 [4393 5358 6232]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1314347
{'0': {'precision': 0.25580688313267663, 'recall': 0.5774245793186746, 'f1-score': 0.35454537793172025, 'support': 72858}, '1': {'precision': 0.5221857151630535, 'recall': 0.2318815877387949, 'f1-score': 0.3211523752868191, 'support': 146674}, '2': {'precision': 0.27650984956756197, 'recall': 0.24081559328123597, 'f1-score': 0.257431310955954, 'support': 77931}, 'accuracy': 0.3188564628205861, 'macro avg': {'precision': 0.35150081595443067, 'recall': 0.35004058677956845, 'f1-score': 0.3110430213914978, 'support': 297463}, 'weighted avg': {'precision': 0.3925776804636406, 'recall': 0.3188564628205861, 'f1-score': 0.3126373704705346, 'support': 297463}}
[[42070 15047 15741]
 [79300 34011 33363]
 [43090 16074 18767]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1203727
{'0': {'precision': 0.38309565217391306, 'recall': 0.3687682057119898, 'f1-score': 0.3757954177115853, 'support': 29867}, '1': {'precision': 0.3209766022380468, 'recall': 0.2911668081650733, 'f1-score': 0.3053458754306508, 'support': 27091}, '2': {'precision': 0.3273953134811779, 'recall': 0.3720703125, 'f1-score': 0.3483061127617306, 'support': 26624}, 'accuracy': 0.344667512143763, 'macro avg': {'precision': 0.3438225226310459, 'recall': 0.344001775459021, 'f1-score': 0.34314913530132224, 'support': 83582}, 'weighted avg': {'precision': 0.3452186810656848, 'recall': 0.344667512143763, 'f1-score': 0.3442045990554425, 'support': 83582}}
[[11014  8475 10378]
 [ 9230  7888  9973]
 [ 8506  8212  9906]]
Evaluating performance on  val set...
125/125 - 1s - 822ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1208117
{'0': {'precision': 0.28476429732525493, 'recall': 0.3974425079921625, 'f1-score': 0.3317980284964056, 'support': 9697}, '1': {'precision': 0.386920384951881, 'recall': 0.2783853961759383, 'f1-score': 0.3237999359355695, 'support': 12709}, '2': {'precision': 0.30283080974325216, 'recall': 0.2940549754954187, 'f1-score': 0.2983783783783784, 'support': 9386}, 'accuracy': 0.31932561650729746, 'macro avg': {'precision': 0.3248384973401294, 'recall': 0.32329429322117315, 'f1-score': 0.31799211427011786, 'support': 31792}, 'weighted avg': {'precision': 0.3309354725643752, 'recall': 0.31932561650729746, 'f1-score': 0.31873422016841524, 'support': 31792}}
[[3854 2887 2956]
 [5773 3538 3398]
 [3907 2719 2760]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1214626
{'0': {'precision': 0.3313484511780378, 'recall': 0.27473455966935756, 'f1-score': 0.30039736868467626, 'support': 98233}, '1': {'precision': 0.3513975866809226, 'recall': 0.30999820337765, 'f1-score': 0.3294022193055722, 'support': 111320}, '2': {'precision': 0.34171046416602313, 'recall': 0.4404425976034016, 'f1-score': 0.38484499216833645, 'support': 103480}, 'accuracy': 0.3420533937316513, 'macro avg': {'precision': 0.34148550067499456, 'recall': 0.34172512021680307, 'f1-score': 0.3382148600528616, 'support': 313033}, 'weighted avg': {'precision': 0.34190366698013486, 'recall': 0.3420533937316513, 'f1-score': 0.3386280346183232, 'support': 313033}}
[[26988 30362 40883]
 [29892 34509 46919]
 [24569 33334 45577]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1289283
{'0': {'precision': 0.32562127516023837, 'recall': 0.3880922066608591, 'f1-score': 0.3541227185178391, 'support': 29846}, '1': {'precision': 0.3107568205167231, 'recall': 0.27044837406450756, 'f1-score': 0.289204837196126, 'support': 30198}, '2': {'precision': 0.3623757018196577, 'recall': 0.34148207171314743, 'f1-score': 0.3516187788188576, 'support': 31375}, 'accuracy': 0.33323488552707864, 'macro avg': {'precision': 0.3329179324988731, 'recall': 0.33334088414617136, 'f1-score': 0.3316487781776076, 'support': 91419}, 'weighted avg': {'precision': 0.3333252900271086, 'recall': 0.33323488552707864, 'f1-score': 0.3318193539195758, 'support': 91419}}
[[11583  8720  9543]
 [12722  8167  9309]
 [11267  9394 10714]]
Evaluating performance on  val set...
99/99 - 1s - 700ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1339474
{'0': {'precision': 0.3226566479877738, 'recall': 0.6236307692307692, 'f1-score': 0.4252801208611356, 'support': 8125}, '1': {'precision': 0.37538534503201326, 'recall': 0.16883532423208192, 'f1-score': 0.23291399985286548, 'support': 9376}, '2': {'precision': 0.29304852913621887, 'recall': 0.2016243393064329, 'f1-score': 0.23888804032381242, 'support': 7757}, 'accuracy': 0.32520389579539155, 'macro avg': {'precision': 0.3303635073853353, 'recall': 0.3313634775897613, 'f1-score': 0.2990273870126045, 'support': 25258}, 'weighted avg': {'precision': 0.3331370536238209, 'recall': 0.32520389579539155, 'f1-score': 0.2966290748835619, 'support': 25258}}
[[5067 1350 1708]
 [5728 1583 2065]
 [4909 1284 1564]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1263604
{'0': {'precision': 0.32152168399695663, 'recall': 0.2540682667179709, 'f1-score': 0.2838425405582099, 'support': 124746}, '1': {'precision': 0.28657629498387016, 'recall': 0.3113479942615359, 'f1-score': 0.29844900516998274, 'support': 110134}, '2': {'precision': 0.3707057592177957, 'recall': 0.4166648052595918, 'f1-score': 0.39234396087848145, 'support': 134307}, 'accuracy': 0.33030686345943927, 'macro avg': {'precision': 0.32626791273287414, 'recall': 0.3273603554130329, 'f1-score': 0.3248785022022247, 'support': 369187}, 'weighted avg': {'precision': 0.32898968833383185, 'recall': 0.33030686345943927, 'f1-score': 0.3276717345236196, 'support': 369187}}
[[31694 41456 51596]
 [32443 34290 43401]
 [34438 43908 55961]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302402
{'0': {'precision': 0.321916235599195, 'recall': 0.58978546507312, 'f1-score': 0.4164992049207542, 'support': 40413}, '1': {'precision': 0.3319949438619972, 'recall': 0.2161390260431794, 'f1-score': 0.2618230861699944, 'support': 41316}, '2': {'precision': 0.356368082672662, 'recall': 0.202746673249108, 'f1-score': 0.25845300074374966, 'support': 44563}, 'accuracy': 0.33097900104519684, 'macro avg': {'precision': 0.3367597540446181, 'recall': 0.3362237214551358, 'f1-score': 0.31225843061149944, 'support': 126292}, 'weighted avg': {'precision': 0.3373700218383934, 'recall': 0.33097900104519684, 'f1-score': 0.31012974748048683, 'support': 126292}}
[[23835  8536  8042]
 [24110  8930  8276]
 [26096  9432  9035]]
Evaluating performance on  val set...
150/150 - 1s - 944ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1338285
{'0': {'precision': 0.32755558277699515, 'recall': 0.42427608092026975, 'f1-score': 0.3696944559657127, 'support': 12605}, '1': {'precision': 0.29214285714285715, 'recall': 0.27963421929749593, 'f1-score': 0.28575171389895637, 'support': 11701}, '2': {'precision': 0.3914885603992091, 'recall': 0.30039011703511054, 'f1-score': 0.33994195315374237, 'support': 13842}, 'accuracy': 0.3349585823634266, 'macro avg': {'precision': 0.3370623334396871, 'recall': 0.33476680575095874, 'f1-score': 0.33179604100613713, 'support': 38148}, 'weighted avg': {'precision': 0.3398916416425094, 'recall': 0.3349585823634266, 'f1-score': 0.33315130379924507, 'support': 38148}}
[[5348 3796 3461]
 [5427 3272 3002]
 [5552 4132 4158]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
5521/5521 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1269516
{'0': {'precision': 0.2510799480773732, 'recall': 0.23602091029111713, 'f1-score': 0.24331764924231747, 'support': 449922}, '1': {'precision': 0.32971900479246724, 'recall': 0.28001085839489653, 'f1-score': 0.30283870656562956, 'support': 515730}, '2': {'precision': 0.3448571128578515, 'recall': 0.4255413731017875, 'f1-score': 0.3809741893421542, 'support': 447658}, 'accuracy': 0.31210279414990344, 'macro avg': {'precision': 0.30855202190923064, 'recall': 0.31385771392926703, 'f1-score': 0.30904351505003375, 'support': 1413310}, 'weighted avg': {'precision': 0.3094794632233601, 'recall': 0.31210279414990344, 'f1-score': 0.3086393736491103, 'support': 1413310}}
[[106191 147702 196029]
 [205452 144410 165868]
 [111294 145867 190497]]
Evaluating performance on  train set...
1289/1289 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233544
{'0': {'precision': 0.2877302711947227, 'recall': 0.27235892691951896, 'f1-score': 0.27983366995366515, 'support': 108100}, '1': {'precision': 0.30225769941025793, 'recall': 0.27866361556064073, 'f1-score': 0.2899815213457032, 'support': 109250}, '2': {'precision': 0.35547784627771684, 'recall': 0.40072076882007474, 'f1-score': 0.37674587870143017, 'support': 112380}, 'accuracy': 0.3181967063961423, 'macro avg': {'precision': 0.3151552722942325, 'recall': 0.3172477704334115, 'f1-score': 0.31552035666693284, 'support': 329730}, 'weighted avg': {'precision': 0.31563368920453105, 'recall': 0.3181967063961423, 'f1-score': 0.3162260115169259, 'support': 329730}}
[[29442 34891 43767]
 [40923 30444 37883]
 [31960 35387 45033]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1157657
{'0': {'precision': 0.45535545023696683, 'recall': 0.05508795266380754, 'f1-score': 0.09828552723106511, 'support': 43603}, '1': {'precision': 0.23532182775898247, 'recall': 0.41620905131603864, 'f1-score': 0.30065520401603124, 'support': 26405}, '2': {'precision': 0.38204739115209524, 'recall': 0.5463064523820879, 'f1-score': 0.449645264800259, 'support': 41938}, 'accuracy': 0.3242902828149286, 'macro avg': {'precision': 0.35757488971601487, 'recall': 0.33920115212064467, 'f1-score': 0.2828619986824518, 'support': 111946}, 'weighted avg': {'precision': 0.3759923538920101, 'recall': 0.3242902828149286, 'f1-score': 0.27764786255062884, 'support': 111946}}
[[ 2402 18055 23146]
 [ 1503 10990 13912]
 [ 1370 17657 22911]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
5918/5918 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1167616
{'0': {'precision': 0.5462451751600137, 'recall': 0.01896915052818395, 'f1-score': 0.03666505423509252, 'support': 589378}, '1': {'precision': 0.24310605652161504, 'recall': 0.4136621930094384, 'f1-score': 0.3062382645519556, 'support': 370614}, '2': {'precision': 0.36631844568041994, 'recall': 0.5701961745246984, 'f1-score': 0.4460653830242626, 'support': 555016}, 'accuracy': 0.31746168997127405, 'macro avg': {'precision': 0.3852232257873496, 'recall': 0.33427583935410693, 'f1-score': 0.26298956727043693, 'support': 1515008}, 'weighted avg': {'precision': 0.4061734296617076, 'recall': 0.31746168997127405, 'f1-score': 0.2525921903634984, 'support': 1515008}}
[[ 11180 244208 333990]
 [  3848 153309 213457]
 [  5439 233109 316468]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1316329
{'0': {'precision': 0.28293453526494944, 'recall': 0.29280413120199295, 'f1-score': 0.287784738494891, 'support': 154144}, '1': {'precision': 0.2871341057963018, 'recall': 0.2639532842158654, 'f1-score': 0.27505615845663345, 'support': 153781}, '2': {'precision': 0.36664585781433606, 'recall': 0.3831497755094209, 'f1-score': 0.37471618096864384, 'support': 156354}, 'accuracy': 0.3136734592777188, 'macro avg': {'precision': 0.31223816629186246, 'recall': 0.31330239697575973, 'f1-score': 0.31251902597338943, 'support': 464279}, 'weighted avg': {'precision': 0.31251677844581416, 'recall': 0.3136734592777188, 'f1-score': 0.312844379335157, 'support': 464279}}
[[45134 49531 59479]
 [69184 40591 44006]
 [45203 51244 59907]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1237656
{'0': {'precision': 0.3607963523091508, 'recall': 0.13237486335177395, 'f1-score': 0.19368676158739775, 'support': 60374}, '1': {'precision': 0.25853982857450897, 'recall': 0.32467561773665804, 'f1-score': 0.28785787167637, 'support': 44315}, '2': {'precision': 0.3589024964672633, 'recall': 0.5251839470646011, 'f1-score': 0.42640588165341053, 'support': 58033}, 'accuracy': 0.32483622374356264, 'macro avg': {'precision': 0.32607955911697434, 'recall': 0.327411476051011, 'f1-score': 0.30265017163905944, 'support': 162722}, 'weighted avg': {'precision': 0.33227283375988936, 'recall': 0.32483622374356264, 'f1-score': 0.3023296091334194, 'support': 162722}}
[[ 7992 20867 31515]
 [ 7000 14388 22927]
 [ 7159 20396 30478]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
3755/3755 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057528
{'0': {'precision': 0.3304862023653088, 'recall': 0.004681261613964988, 'f1-score': 0.009231757490479177, 'support': 322349}, '1': {'precision': 0.35677859035723825, 'recall': 0.4036647404553761, 'f1-score': 0.3787762512761865, 'support': 344199}, '2': {'precision': 0.3074696076097785, 'recall': 0.5919114776912241, 'f1-score': 0.40471117918726357, 'support': 294615}, 'accuracy': 0.32755734459191627, 'macro avg': {'precision': 0.3315781334441085, 'recall': 0.3334191599201884, 'f1-score': 0.2642397293179764, 'support': 961163}, 'weighted avg': {'precision': 0.33284665484894954, 'recall': 0.32755734459191627, 'f1-score': 0.2627902226412859, 'support': 961163}}
[[  1509 131658 189182]
 [  1661 138941 203597]
 [  1396 118833 174386]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1380765
{'0': {'precision': 0.3380310367598503, 'recall': 0.47062203596301033, 'f1-score': 0.3934563785256995, 'support': 130523}, '1': {'precision': 0.32869899650766987, 'recall': 0.23114047017680203, 'f1-score': 0.2714193804498104, 'support': 128675}, '2': {'precision': 0.3271960459087992, 'recall': 0.2951956265086515, 'f1-score': 0.3103731815306768, 'support': 132983}, 'accuracy': 0.3325632807300711, 'macro avg': {'precision': 0.33130869305877314, 'recall': 0.332319377549488, 'f1-score': 0.3250829801687289, 'support': 392181}, 'weighted avg': {'precision': 0.3312951931881458, 'recall': 0.3325632807300711, 'f1-score': 0.32524358006426424, 'support': 392181}}
[[61427 30189 38907]
 [57119 29742 41814]
 [63174 30553 39256]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1340117
{'0': {'precision': 0.3045282266108119, 'recall': 0.4003251691403996, 'f1-score': 0.3459167950693374, 'support': 38134}, '1': {'precision': 0.3177440321437012, 'recall': 0.26566707012820195, 'f1-score': 0.28938128102675864, 'support': 40483}, '2': {'precision': 0.3354328484677305, 'recall': 0.29132119903841436, 'f1-score': 0.31182471019154273, 'support': 40766}, 'accuracy': 0.317440506604793, 'macro avg': {'precision': 0.31923503574074785, 'recall': 0.31910447943567194, 'f1-score': 0.31570759542921295, 'support': 119383}, 'weighted avg': {'precision': 0.3195628066599571, 'recall': 0.317440506604793, 'f1-score': 0.3151039896689547, 'support': 119383}}
[[15266 11256 11612]
 [17811 10755 11917]
 [17053 11837 11876]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
4960/4960 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1347684
{'0': {'precision': 0.31888423681979666, 'recall': 0.4830713051576458, 'f1-score': 0.38417048430116585, 'support': 408035}, '1': {'precision': 0.3354151276335612, 'recall': 0.24126760922884863, 'f1-score': 0.28065624569804387, 'support': 430953}, '2': {'precision': 0.3427409556543811, 'recall': 0.27181605416399657, 'f1-score': 0.3031858482711111, 'support': 430692}, 'accuracy': 0.3293381009388192, 'macro avg': {'precision': 0.33234677336924634, 'recall': 0.332051656183497, 'f1-score': 0.32267085942344026, 'support': 1269680}, 'weighted avg': {'precision': 0.3325876384148199, 'recall': 0.3293381009388192, 'f1-score': 0.32156478323492277, 'support': 1269680}}
[[197110  99781 111144]
 [213624 103975 113354]
 [207390 106233 117069]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297336
{'0': {'precision': 0.3295898569080277, 'recall': 0.3277088580461926, 'f1-score': 0.3286466660396878, 'support': 149288}, '1': {'precision': 0.3137413078201384, 'recall': 0.28009477649024506, 'f1-score': 0.29596484218937275, 'support': 138853}, '2': {'precision': 0.32974957306508107, 'recall': 0.3656247624444552, 'f1-score': 0.3467617459011827, 'support': 144703}, 'accuracy': 0.32511020136585006, 'macro avg': {'precision': 0.32436024593108237, 'recall': 0.3244761323269643, 'f1-score': 0.32379108471008106, 'support': 432844}, 'weighted avg': {'precision': 0.32455915952184095, 'recall': 0.32511020136585006, 'f1-score': 0.3242185975302712, 'support': 432844}}
[[48923 43963 56402]
 [48824 38892 51137]
 [50689 41107 52907]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1180363
{'0': {'precision': 0.28141563373815787, 'recall': 0.12791668247524376, 'f1-score': 0.1758852298663189, 'support': 52714}, '1': {'precision': 0.2803871229891214, 'recall': 0.3353583105063179, 'f1-score': 0.30541891742362515, 'support': 45268}, '2': {'precision': 0.36888949746679445, 'recall': 0.506848284166165, 'f1-score': 0.42700226656733925, 'support': 53152}, 'accuracy': 0.3233157330580809, 'macro avg': {'precision': 0.31023075139802453, 'recall': 0.3233744257159089, 'f1-score': 0.30276880461909444, 'support': 151134}, 'weighted avg': {'precision': 0.31187107182831036, 'recall': 0.3233157330580809, 'f1-score': 0.30299827989527844, 'support': 151134}}
[[ 6743 19606 26365]
 [10362 15181 19725]
 [ 6856 19356 26940]]
testing model on single stock: results/universal/W8/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
10609/10609 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1223364
{'0': {'precision': 0.34505086385848915, 'recall': 0.2762832265575439, 'f1-score': 0.3068615337988583, 'support': 1004129}, '1': {'precision': 0.2546634671580525, 'recall': 0.3111347567378369, 'f1-score': 0.2800809636999302, 'support': 714250}, '2': {'precision': 0.37355960652102566, 'recall': 0.3891926525840191, 'f1-score': 0.38121592541920757, 'support': 997303}, 'accuracy': 0.3269141968757756, 'macro avg': {'precision': 0.32442464584585573, 'recall': 0.3255368786264666, 'f1-score': 0.3227194743059987, 'support': 2715682}, 'weighted avg': {'precision': 0.3317476333956768, 'recall': 0.3269141968757756, 'f1-score': 0.32712378675520215, 'support': 2715682}}
[[277424 327178 399527]
 [240653 222228 251369]
 [285932 323228 388143]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1322309
{'0': {'precision': 0.32132958364214137, 'recall': 0.6821057687275056, 'f1-score': 0.4368607547013553, 'support': 324803}, '1': {'precision': 0.3328689741744868, 'recall': 0.19714223543918183, 'f1-score': 0.2476269651916934, 'support': 330888}, '2': {'precision': 0.3609470580469128, 'recall': 0.11943023892454831, 'f1-score': 0.1794755649504253, 'support': 343372}, 'accuracy': 0.32809842822724894, 'macro avg': {'precision': 0.3383818719545137, 'recall': 0.3328927476970786, 'f1-score': 0.2879877616144913, 'support': 999063}, 'weighted avg': {'precision': 0.33876770043335663, 'recall': 0.32809842822724894, 'f1-score': 0.2857250830585967, 'support': 999063}}
[[221550  63572  39681]
 [232731  65232  32925]
 [235198  67165  41009]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1356139
{'0': {'precision': 0.3381699924455991, 'recall': 0.7410315938225497, 'f1-score': 0.4644074873008141, 'support': 99070}, '1': {'precision': 0.3241839905804235, 'recall': 0.18019226230071025, 'f1-score': 0.23163440519125872, 'support': 93206}, '2': {'precision': 0.3549759838206792, 'recall': 0.08395029743814582, 'f1-score': 0.13578744630956316, 'support': 100357}, 'accuracy': 0.3370569963059532, 'macro avg': {'precision': 0.3391099889489006, 'recall': 0.3350580511871353, 'f1-score': 0.277276446267212, 'support': 292633}, 'weighted avg': {'precision': 0.33947886597176785, 'recall': 0.3370569963059532, 'f1-score': 0.27756878713759875, 'support': 292633}}
[[73414 17585  8071]
 [69173 16795  7238]
 [74505 17427  8425]]
training model: results/universal/W8/deepOF_L1/h300
Epoch 1/50
7695/7695 - 112s - loss: 3.2666 - accuracy300: 0.3801 - val_loss: 3.3045 - val_accuracy300: 0.3293 - 112s/epoch - 15ms/step
Epoch 2/50
7695/7695 - 107s - loss: 3.2661 - accuracy300: 0.3787 - val_loss: 3.2970 - val_accuracy300: 0.3302 - 107s/epoch - 14ms/step
Epoch 3/50
7695/7695 - 105s - loss: 3.2631 - accuracy300: 0.3814 - val_loss: 3.2956 - val_accuracy300: 0.3312 - 105s/epoch - 14ms/step
Epoch 4/50
7695/7695 - 102s - loss: 3.2609 - accuracy300: 0.3832 - val_loss: 3.2961 - val_accuracy300: 0.3315 - 102s/epoch - 13ms/step
Epoch 5/50
7695/7695 - 105s - loss: 3.2591 - accuracy300: 0.3846 - val_loss: 3.3004 - val_accuracy300: 0.3303 - 105s/epoch - 14ms/step
Epoch 6/50
7695/7695 - 105s - loss: 3.2568 - accuracy300: 0.3859 - val_loss: 3.3068 - val_accuracy300: 0.3302 - 105s/epoch - 14ms/step
Epoch 7/50
7695/7695 - 103s - loss: 3.2552 - accuracy300: 0.3870 - val_loss: 3.3076 - val_accuracy300: 0.3304 - 103s/epoch - 13ms/step
Epoch 8/50
7695/7695 - 103s - loss: 3.2531 - accuracy300: 0.3885 - val_loss: 3.3143 - val_accuracy300: 0.3301 - 103s/epoch - 13ms/step
Epoch 9/50
7695/7695 - 104s - loss: 3.2518 - accuracy300: 0.3893 - val_loss: 3.3159 - val_accuracy300: 0.3304 - 104s/epoch - 14ms/step
Epoch 10/50
7695/7695 - 103s - loss: 3.2508 - accuracy300: 0.3898 - val_loss: 3.3167 - val_accuracy300: 0.3301 - 103s/epoch - 13ms/step
Epoch 11/50
7695/7695 - 102s - loss: 3.2494 - accuracy300: 0.3907 - val_loss: 3.3206 - val_accuracy300: 0.3306 - 102s/epoch - 13ms/step
Epoch 12/50
7695/7695 - 103s - loss: 3.2491 - accuracy300: 0.3908 - val_loss: 3.3203 - val_accuracy300: 0.3309 - 103s/epoch - 13ms/step
Epoch 13/50
7695/7695 - 103s - loss: 3.2476 - accuracy300: 0.3917 - val_loss: 3.3186 - val_accuracy300: 0.3312 - 103s/epoch - 13ms/step
testing model in sample: results/universal/W8/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001118
{'0': {'precision': 0.43472188718052895, 'recall': 0.032850474216359324, 'f1-score': 0.06108496277858083, 'support': 2084597}, '1': {'precision': 0.30769197092767503, 'recall': 0.9563256340002896, 'f1-score': 0.4655848431651817, 'support': 1837302}, '2': {'precision': 0.4183114801708096, 'recall': 0.019072663463858552, 'f1-score': 0.036481953909286664, 'support': 2039044}, 'accuracy': 0.31277417012710906, 'macro avg': {'precision': 0.38690844609300457, 'recall': 0.3360829238935025, 'f1-score': 0.18771725328434974, 'support': 5960943}, 'weighted avg': {'precision': 0.38995483251452606, 'recall': 0.31277417012710906, 'f1-score': 0.1773453970114164, 'support': 5960943}}
[[  68480 1992926   23191]
 [  49355 1757059   30888]
 [  39691 1960463   38890]]
Evaluating performance on  train set...
7695/7695 - 43s - 43s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986834
{'0': {'precision': 0.39225107340012266, 'recall': 0.023412901808596325, 'f1-score': 0.04418826943673488, 'support': 655536}, '1': {'precision': 0.3307684948543782, 'recall': 0.9652303430334137, 'f1-score': 0.49269764512023384, 'support': 651919}, '2': {'precision': 0.40140265502558414, 'recall': 0.016945260976353974, 'f1-score': 0.03251777999046323, 'support': 662014}, 'accuracy': 0.3329922938619496, 'macro avg': {'precision': 0.37480740776002835, 'recall': 0.33519616860612134, 'f1-score': 0.18980123151581066, 'support': 1969469}, 'weighted avg': {'precision': 0.37497576418491546, 'recall': 0.3329922938619496, 'f1-score': 0.18872761292776058, 'support': 1969469}}
[[ 15348 632968   7220]
 [ 13158 629252   9509]
 [ 10622 640174  11218]]
Evaluating performance on  val set...
2338/2338 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987272
{'0': {'precision': 0.40952053617460044, 'recall': 0.02362669231264965, 'f1-score': 0.04467587493379703, 'support': 201721}, '1': {'precision': 0.3284119684363387, 'recall': 0.965323036065874, 'f1-score': 0.4900905322157792, 'support': 196557}, '2': {'precision': 0.39234620886981403, 'recall': 0.01649615791399542, 'f1-score': 0.03166112685134855, 'support': 199501}, 'accuracy': 0.33088817104649043, 'macro avg': {'precision': 0.376759571160251, 'recall': 0.335148628764173, 'f1-score': 0.18880917800030828, 'support': 597779}, 'weighted avg': {'precision': 0.37711934406085657, 'recall': 0.33088817104649043, 'f1-score': 0.18679012373507312, 'support': 597779}}
[[  4766 194807   2148]
 [  3867 189741   2949]
 [  3005 193205   3291]]
testing model out of sample: results/universal/W8/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 71s - 71s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965087
{'0': {'precision': 0.4167324968309665, 'recall': 0.03770533358266326, 'f1-score': 0.06915374009881937, 'support': 1203225}, '1': {'precision': 0.33237785512739854, 'recall': 0.9507438385078801, 'f1-score': 0.4925584212102991, 'support': 1201941}, '2': {'precision': 0.3907823728030937, 'recall': 0.02236202501752581, 'f1-score': 0.04230329755469695, 'support': 1211071}, 'accuracy': 0.336036603795603, 'macro avg': {'precision': 0.3799642415871529, 'recall': 0.3369370657026897, 'f1-score': 0.2013384862879385, 'support': 3616237}, 'weighted avg': {'precision': 0.3800046095104208, 'recall': 0.336036603795603, 'f1-score': 0.20089003213871062, 'support': 3616237}}
[[  45368 1140088   17769]
 [  34752 1142738   24451]
 [  28746 1155243   27082]]
Evaluating performance on  train set...
4550/4550 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991399
{'0': {'precision': 0.41089756161338825, 'recall': 0.03183329492708299, 'f1-score': 0.05908882595565165, 'support': 394901}, '1': {'precision': 0.32447509424153, 'recall': 0.9540233836779707, 'f1-score': 0.48425059970548323, 'support': 378127}, '2': {'precision': 0.38699605106070345, 'recall': 0.021548649374224974, 'f1-score': 0.040824136035244, 'support': 391115}, 'accuracy': 0.3279159003661921, 'macro avg': {'precision': 0.3741229023052073, 'recall': 0.3358017759930929, 'f1-score': 0.1947211872321263, 'support': 1164143}, 'weighted avg': {'precision': 0.37479640598239444, 'recall': 0.3279159003661921, 'f1-score': 0.19104989244360226, 'support': 1164143}}
[[ 12571 376575   5755]
 [  9790 360742   7595]
 [  8233 374454   8428]]
Evaluating performance on  val set...
1570/1570 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988467
{'0': {'precision': 0.4029770992366412, 'recall': 0.03892780768379913, 'f1-score': 0.07099724295608903, 'support': 135610}, '1': {'precision': 0.32552332237498555, 'recall': 0.9505447742311438, 'f1-score': 0.4849654870251165, 'support': 130421}, '2': {'precision': 0.40504722966304807, 'recall': 0.021281796767359515, 'f1-score': 0.04043887367954339, 'support': 134998}, 'accuracy': 0.3294599642419875, 'macro avg': {'precision': 0.3778492170915582, 'recall': 0.3369181262274341, 'f1-score': 0.19880053455358296, 'support': 401029}, 'weighted avg': {'precision': 0.3784847668497816, 'recall': 0.3294599642419875, 'f1-score': 0.19533945667163458, 'support': 401029}}
[[  5279 128397   1934]
 [  4164 123971   2286]
 [  3657 128468   2873]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1058581
{'0': {'precision': 0.3355728429985856, 'recall': 0.016766488224589673, 'f1-score': 0.031937269683151324, 'support': 56601}, '1': {'precision': 0.3071609572970436, 'recall': 0.9679785472040382, 'f1-score': 0.4663414726822804, 'support': 50716}, '2': {'precision': 0.3451015004413063, 'recall': 0.013575917502864484, 'f1-score': 0.026124139774169844, 'support': 57602}, 'accuracy': 0.30816946501009584, 'macro avg': {'precision': 0.3292784335789785, 'recall': 0.3327736509771641, 'f1-score': 0.1748009607132005, 'support': 164919}, 'weighted avg': {'precision': 0.3301637180995515, 'recall': 0.30816946501009584, 'f1-score': 0.16349515961873592, 'support': 164919}}
[[  949 54954   698]
 [  838 49092   786]
 [ 1041 55779   782]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102828
{'0': {'precision': 0.3715415019762846, 'recall': 0.014766717285437504, 'f1-score': 0.02840451248992748, 'support': 19097}, '1': {'precision': 0.3287036208408656, 'recall': 0.9782666595642678, 'f1-score': 0.4920690209527892, 'support': 18773}, '2': {'precision': 0.3950381679389313, 'recall': 0.010734287492221531, 'f1-score': 0.02090064620355412, 'support': 19284}, 'accuracy': 0.3298806732687126, 'macro avg': {'precision': 0.3650944302520272, 'recall': 0.33458922144730896, 'f1-score': 0.18045805988209027, 'support': 57154}, 'weighted avg': {'precision': 0.3653986976908183, 'recall': 0.3298806732687126, 'f1-score': 0.17816952036176284, 'support': 57154}}
[[  282 18656   159]
 [  250 18365   158]
 [  227 18850   207]]
Evaluating performance on  val set...
68/68 - 1s - 582ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047183
{'0': {'precision': 0.4119170984455959, 'recall': 0.025828460038986353, 'f1-score': 0.04860898807704066, 'support': 6156}, '1': {'precision': 0.31039233303384245, 'recall': 0.9715035620547432, 'f1-score': 0.47047074311135323, 'support': 5334}, '2': {'precision': 0.42207792207792205, 'recall': 0.011314186248912098, 'f1-score': 0.022037633497202915, 'support': 5745}, 'accuracy': 0.31366405570060923, 'macro avg': {'precision': 0.38146245118578676, 'recall': 0.3362154027808805, 'f1-score': 0.18037245489519893, 'support': 17235}, 'weighted avg': {'precision': 0.3838834943296354, 'recall': 0.31366405570060923, 'f1-score': 0.1703123921554773, 'support': 17235}}
[[ 159 5947   50]
 [ 113 5182   39]
 [ 114 5566   65]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0912622
{'0': {'precision': 0.4111807732497388, 'recall': 0.020632124243663553, 'f1-score': 0.039292632756175984, 'support': 190722}, '1': {'precision': 0.34353467511809593, 'recall': 0.9653044446525761, 'f1-score': 0.5067323306196421, 'support': 192186}, '2': {'precision': 0.43078992418684275, 'recall': 0.020146740093899936, 'f1-score': 0.03849326668305608, 'support': 174867}, 'accuracy': 0.3459746313477657, 'macro avg': {'precision': 0.39516845751822577, 'recall': 0.3353611029967132, 'f1-score': 0.1948394100196247, 'support': 557775}, 'weighted avg': {'precision': 0.39402037771639764, 'recall': 0.3459746313477657, 'f1-score': 0.2001022477917725, 'support': 557775}}
[[  3935 185090   1697]
 [  3710 185518   2958]
 [  1925 169419   3523]]
Evaluating performance on  train set...
614/614 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946025
{'0': {'precision': 0.39134162023146163, 'recall': 0.017124957797201485, 'f1-score': 0.03281398817546319, 'support': 53314}, '1': {'precision': 0.33404877665735283, 'recall': 0.971214946158822, 'f1-score': 0.49711511775675454, 'support': 52562}, '2': {'precision': 0.4606625258799172, 'recall': 0.017380096859865645, 'f1-score': 0.03349642453895371, 'support': 51208}, 'accuracy': 0.33645692750375594, 'macro avg': {'precision': 0.39535097425624394, 'recall': 0.33524000027196305, 'f1-score': 0.18780851015705716, 'support': 157084}, 'weighted avg': {'precision': 0.39476882155370835, 'recall': 0.33645692750375594, 'f1-score': 0.18839662023444728, 'support': 157084}}
[[  913 52014   387]
 [  858 51049   655]
 [  562 49756   890]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.08894
{'0': {'precision': 0.4433497536945813, 'recall': 0.022179779434415625, 'f1-score': 0.04224608343601479, 'support': 16231}, '1': {'precision': 0.35087868601336114, 'recall': 0.965969659696597, 'f1-score': 0.5147717518532969, 'support': 17073}, '2': {'precision': 0.435656836461126, 'recall': 0.021303093864708966, 'f1-score': 0.04061992250968629, 'support': 15256}, 'accuracy': 0.3537273476112026, 'macro avg': {'precision': 0.4099617587230228, 'recall': 0.3364841776652405, 'f1-score': 0.19921258593299931, 'support': 48560}, 'weighted avg': {'precision': 0.40842138294015246, 'recall': 0.3537273476112026, 'f1-score': 0.207868448052905, 'support': 48560}}
[[  360 15731   140]
 [  300 16492   281]
 [  152 14779   325]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0725541
{'0': {'precision': 0.335289663006437, 'recall': 0.022453818163376566, 'f1-score': 0.042089002435981224, 'support': 78873}, '1': {'precision': 0.4528191593006572, 'recall': 0.9394984049512665, 'f1-score': 0.6111003535646923, 'support': 136046}, '2': {'precision': 0.2520431843406316, 'recall': 0.030264481033208543, 'f1-score': 0.054040021633315304, 'support': 82539}, 'accuracy': 0.44404252028857855, 'macro avg': {'precision': 0.34671733554924195, 'recall': 0.3307389013826172, 'f1-score': 0.23574312587799628, 'support': 297458}, 'weighted avg': {'precision': 0.3659438620874722, 'recall': 0.44404252028857855, 'f1-score': 0.30564938221795174, 'support': 297458}}
[[  1771  75538   1564]
 [  2382 127815   5849]
 [  1129  78912   2498]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000851
{'0': {'precision': 0.36228518346493266, 'recall': 0.02755015541113309, 'f1-score': 0.05120630231413097, 'support': 28312}, '1': {'precision': 0.3373740672813607, 'recall': 0.9487759211502456, 'f1-score': 0.49775281940081356, 'support': 28307}, '2': {'precision': 0.36862314865606144, 'recall': 0.024923042688128175, 'f1-score': 0.04668936288473564, 'support': 26963}, 'accuracy': 0.33869732717570766, 'macro avg': {'precision': 0.35609413313411825, 'recall': 0.33374970641650226, 'f1-score': 0.19854949486656007, 'support': 83582}, 'weighted avg': {'precision': 0.3558930367065401, 'recall': 0.33869732717570766, 'f1-score': 0.20098259411545108, 'support': 83582}}
[[  780 27021   511]
 [  810 26857   640]
 [  563 25728   672]]
Evaluating performance on  val set...
125/125 - 1s - 784ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926371
{'0': {'precision': 0.33974358974358976, 'recall': 0.03213094877235526, 'f1-score': 0.058709498753807814, 'support': 9897}, '1': {'precision': 0.37655222790357923, 'recall': 0.9460293626960293, 'f1-score': 0.5386880729587231, 'support': 11988}, '2': {'precision': 0.34552845528455284, 'recall': 0.025739376198647423, 'f1-score': 0.04790981681540629, 'support': 9907}, 'accuracy': 0.37474836436839454, 'macro avg': {'precision': 0.3539414243105739, 'recall': 0.334633229222344, 'f1-score': 0.21510246284264575, 'support': 31792}, 'weighted avg': {'precision': 0.3554259191716306, 'recall': 0.37474836436839454, 'f1-score': 0.23633250764298686, 'support': 31792}}
[[  318  9368   211]
 [  375 11341   272]
 [  243  9409   255]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1223/1223 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959275
{'0': {'precision': 0.36115384615384616, 'recall': 0.027881979155325486, 'f1-score': 0.05176738673012781, 'support': 101033}, '1': {'precision': 0.35905964879337693, 'recall': 0.9549126968556599, 'f1-score': 0.5218840696254816, 'support': 112138}, '2': {'precision': 0.37948278325475066, 'recall': 0.02659803519032216, 'f1-score': 0.04971176162311896, 'support': 99857}, 'accuracy': 0.359568473107837, 'macro avg': {'precision': 0.36656542606732456, 'recall': 0.33646423706710255, 'f1-score': 0.2077877393262428, 'support': 313028}, 'weighted avg': {'precision': 0.3662506220604, 'recall': 0.359568473107837, 'f1-score': 0.2195245075953814, 'support': 313028}}
[[  2817  96300   1916]
 [  2629 107082   2427]
 [  2354  94847   2656]]
Evaluating performance on  train set...
358/358 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001211
{'0': {'precision': 0.39298496778811737, 'recall': 0.036634191912451625, 'f1-score': 0.06702069218091926, 'support': 29972}, '1': {'precision': 0.3311223599231978, 'recall': 0.9419066534260179, 'f1-score': 0.48999095957639155, 'support': 30210}, '2': {'precision': 0.36830357142857145, 'recall': 0.03169521370257724, 'f1-score': 0.05836747929133627, 'support': 31235}, 'accuracy': 0.3341063478346478, 'macro avg': {'precision': 0.36413696637996223, 'recall': 0.3367453530136823, 'f1-score': 0.2051263770162157, 'support': 91417}, 'weighted avg': {'precision': 0.3641085793823543, 'recall': 0.3341063478346478, 'f1-score': 0.2038404157926227, 'support': 91417}}
[[ 1098 28067   807]
 [  864 28455   891]
 [  832 29413   990]]
Evaluating performance on  val set...
99/99 - 1s - 658ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099226
{'0': {'precision': 0.39853300733496333, 'recall': 0.019326535451742944, 'f1-score': 0.03686531720004523, 'support': 8434}, '1': {'precision': 0.3509080994924709, 'recall': 0.9434983647231308, 'f1-score': 0.5115568056744527, 'support': 8867}, '2': {'precision': 0.36742800397219466, 'recall': 0.04650578179989945, 'f1-score': 0.08256164230726319, 'support': 7956}, 'accuracy': 0.3523379657124758, 'macro avg': {'precision': 0.3722897035998763, 'recall': 0.3364435606582577, 'f1-score': 0.2103279217272537, 'support': 25257}, 'weighted avg': {'precision': 0.37201515230097015, 'recall': 0.3523379657124758, 'f1-score': 0.21791015193321217, 'support': 25257}}
[[ 163 7995  276]
 [ 140 8366  361]
 [ 106 7480  370]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995553
{'0': {'precision': 0.3603031905517363, 'recall': 0.016932023393363044, 'f1-score': 0.03234407513193187, 'support': 120718}, '1': {'precision': 0.33408196217780545, 'recall': 0.9614779491671127, 'f1-score': 0.4958665933325944, 'support': 123306}, '2': {'precision': 0.39129428108358416, 'recall': 0.027005864587161827, 'f1-score': 0.050524679362611735, 'support': 125158}, 'accuracy': 0.3358235233570434, 'macro avg': {'precision': 0.3618931446043753, 'recall': 0.3351386123825459, 'f1-score': 0.19291178260904598, 'support': 369182}, 'weighted avg': {'precision': 0.3620517810109383, 'recall': 0.3358235233570434, 'f1-score': 0.19332309278055593, 'support': 369182}}
[[  2044 116218   2456]
 [  1948 118556   2802]
 [  1681 120097   3380]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999553
{'0': {'precision': 0.3740354062641852, 'recall': 0.019839645583030363, 'f1-score': 0.03768062922992501, 'support': 41533}, '1': {'precision': 0.32309465020576134, 'recall': 0.9550641072427803, 'f1-score': 0.4828447199621164, 'support': 41103}, '2': {'precision': 0.31979891724671305, 'recall': 0.01894486060522759, 'f1-score': 0.03577066978092087, 'support': 43653}, 'accuracy': 0.32391578047177505, 'macro avg': {'precision': 0.3389763245722199, 'recall': 0.33128287114367944, 'f1-score': 0.18543200632432078, 'support': 126289}, 'weighted avg': {'precision': 0.3387084708117775, 'recall': 0.32391578047177505, 'f1-score': 0.18190700018494, 'support': 126289}}
[[  824 40130   579]
 [  667 39256  1180]
 [  712 42114   827]]
Evaluating performance on  val set...
150/150 - 1s - 900ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003968
{'0': {'precision': 0.4155672823218997, 'recall': 0.025049701789264415, 'f1-score': 0.04725118127953199, 'support': 12575}, '1': {'precision': 0.32454377579839233, 'recall': 0.9688690717470612, 'f1-score': 0.4862181899550438, 'support': 12335}, '2': {'precision': 0.39045936395759717, 'recall': 0.016694364707659767, 'f1-score': 0.03201970443349753, 'support': 13238}, 'accuracy': 0.32733039739960157, 'macro avg': {'precision': 0.3768568073592964, 'recall': 0.33687104608132845, 'f1-score': 0.18849635855602445, 'support': 38148}, 'weighted avg': {'precision': 0.37742233170131406, 'recall': 0.32733039739960157, 'f1-score': 0.18390379115487626, 'support': 38148}}
[[  315 12084   176]
 [  215 11951   169]
 [  228 12789   221]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/EXC
Evaluating performance on  test set...
5521/5521 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0892298
{'0': {'precision': 0.47029110178239625, 'recall': 0.07092167668150731, 'f1-score': 0.12325589784286846, 'support': 481785}, '1': {'precision': 0.32375406871055296, 'recall': 0.9250665960394783, 'f1-score': 0.4796430468356327, 'support': 456859}, '2': {'precision': 0.4697824792263407, 'recall': 0.03489859078373829, 'f1-score': 0.06497072101223325, 'support': 474661}, 'accuracy': 0.33493053516403043, 'macro avg': {'precision': 0.42127588323976334, 'recall': 0.34362895450157466, 'f1-score': 0.22262322189691144, 'support': 1413305}, 'weighted avg': {'precision': 0.4227513381197409, 'recall': 0.33493053516403043, 'f1-score': 0.218884920723336, 'support': 1413305}}
[[ 34169 440799   6817]
 [ 22355 422625  11879]
 [ 16131 441965  16565]]
Evaluating performance on  train set...
1288/1288 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0906466
{'0': {'precision': 0.41856278801843316, 'recall': 0.05267259267313634, 'f1-score': 0.0935701695788296, 'support': 110361}, '1': {'precision': 0.33160559773400416, 'recall': 0.9354220823642085, 'f1-score': 0.4896360255238086, 'support': 109635}, '2': {'precision': 0.4491783323189288, 'recall': 0.02690190646301899, 'f1-score': 0.05076351630210483, 'support': 109732}, 'accuracy': 0.33761160714285715, 'macro avg': {'precision': 0.39978223935712204, 'recall': 0.33833219383345464, 'f1-score': 0.21132323713491433, 'support': 329728}, 'weighted avg': {'precision': 0.3998381220827183, 'recall': 0.33761160714285715, 'f1-score': 0.21101673292548564, 'support': 329728}}
[[  5813 103259   1289]
 [  4749 102555   2331]
 [  3326 103454   2952]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942982
{'0': {'precision': 0.43484093522422385, 'recall': 0.05903934221482098, 'f1-score': 0.10396334478808705, 'support': 38432}, '1': {'precision': 0.32001185547790006, 'recall': 0.9358067492381246, 'f1-score': 0.47693074950128245, 'support': 35767}, '2': {'precision': 0.4454332552693208, 'recall': 0.025194055156701194, 'f1-score': 0.047690687528208216, 'support': 37747}, 'accuracy': 0.3277562396155289, 'macro avg': {'precision': 0.4000953486571482, 'recall': 0.3400133822032156, 'f1-score': 0.20952826060585925, 'support': 111946}, 'weighted avg': {'precision': 0.40172440233743484, 'recall': 0.3277562396155289, 'f1-score': 0.20415273226765948, 'support': 111946}}
[[ 2269 35668   495]
 [ 1607 33471   689]
 [ 1342 35454   951]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/AAL
Evaluating performance on  test set...
5918/5918 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946202
{'0': {'precision': 0.46238914788460866, 'recall': 0.05152637838872408, 'f1-score': 0.09272044520433607, 'support': 512029}, '1': {'precision': 0.33226698775905206, 'recall': 0.9529406574189757, 'f1-score': 0.4927308407193204, 'support': 498647}, '2': {'precision': 0.4455385057677795, 'recall': 0.02458325649826402, 'f1-score': 0.04659553437538757, 'support': 504327}, 'accuracy': 0.33924817310592786, 'macro avg': {'precision': 0.4133982138038134, 'recall': 0.3430167641019879, 'f1-score': 0.21068227343301468, 'support': 1515003}, 'weighted avg': {'precision': 0.4139514493671915, 'recall': 0.33924817310592786, 'f1-score': 0.20902512961006284, 'support': 1515003}}
[[ 26383 478252   7394]
 [ 15431 475181   8035]
 [ 15244 476685  12398]]
Evaluating performance on  train set...
1814/1814 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954154
{'0': {'precision': 0.4373921524495461, 'recall': 0.03770412287793048, 'f1-score': 0.06942377079438418, 'support': 154625}, '1': {'precision': 0.3311036335206251, 'recall': 0.9542128603104213, 'f1-score': 0.49161952984697266, 'support': 153340}, '2': {'precision': 0.4204759269507471, 'recall': 0.024303956190183735, 'f1-score': 0.04595184672234755, 'support': 156312}, 'accuracy': 0.3358943044777148, 'macro avg': {'precision': 0.3963239043069728, 'recall': 0.3387403131261785, 'f1-score': 0.20233171578790146, 'support': 464277}, 'weighted avg': {'precision': 0.3965921762871925, 'recall': 0.3358943044777148, 'f1-score': 0.20096281816820566, 'support': 464277}}
[[  5830 146619   2176]
 [  3961 146319   3060]
 [  3538 148975   3799]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904175
{'0': {'precision': 0.4171686746987952, 'recall': 0.05259560247598071, 'f1-score': 0.09341381984959363, 'support': 52666}, '1': {'precision': 0.36550071371511633, 'recall': 0.9468880935013825, 'f1-score': 0.5274172898763658, 'support': 58951}, '2': {'precision': 0.4167907115212861, 'recall': 0.027395115842204134, 'f1-score': 0.051411049703468416, 'support': 51104}, 'accuracy': 0.3686678425034261, 'macro avg': {'precision': 0.39982003331173255, 'recall': 0.3422929372731891, 'f1-score': 0.2240807198098093, 'support': 162721}, 'weighted avg': {'precision': 0.39833156456444085, 'recall': 0.3686678425034261, 'f1-score': 0.23745441077516968, 'support': 162721}}
[[ 2770 49028   868]
 [ 2040 55820  1091]
 [ 1830 47874  1400]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/WBA
Evaluating performance on  test set...
3755/3755 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0846857
{'0': {'precision': 0.3251448952296032, 'recall': 0.026021429412457317, 'f1-score': 0.0481864822810779, 'support': 280269}, '1': {'precision': 0.42443970221285315, 'recall': 0.9594711889934546, 'f1-score': 0.5885316292051418, 'support': 408993}, '2': {'precision': 0.3075132275132275, 'recall': 0.016031865124900697, 'f1-score': 0.030474952022400033, 'support': 271896}, 'accuracy': 0.4203981031214431, 'macro avg': {'precision': 0.35236594165189467, 'recall': 0.33384149451027084, 'f1-score': 0.2223976878362066, 'support': 961158}, 'weighted avg': {'precision': 0.3624092170862477, 'recall': 0.4203981031214431, 'f1-score': 0.27310443379862254, 'support': 961158}}
[[  7293 269550   3426]
 [ 10186 392417   6390]
 [  4951 262586   4359]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994207
{'0': {'precision': 0.38275234495310095, 'recall': 0.021057009504151326, 'f1-score': 0.0399179448244647, 'support': 129838}, '1': {'precision': 0.3304249091776062, 'recall': 0.96720338068138, 'f1-score': 0.49257262918127104, 'support': 129678}, '2': {'precision': 0.3893171806167401, 'recall': 0.015987999577874598, 'f1-score': 0.030714647744551443, 'support': 132662}, 'accuracy': 0.33219609463049943, 'macro avg': {'precision': 0.3674981449158157, 'recall': 0.3347494632544687, 'f1-score': 0.1877350739167624, 'support': 392178}, 'weighted avg': {'precision': 0.3676703847521593, 'recall': 0.33219609463049943, 'f1-score': 0.18648003234800367, 'support': 392178}}
[[  2734 125572   1532]
 [  2458 125425   1795]
 [  1951 128590   2121]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936035
{'0': {'precision': 0.39704433497536945, 'recall': 0.021515135337141635, 'f1-score': 0.04081839359870354, 'support': 37462}, '1': {'precision': 0.3626404930854094, 'recall': 0.9718681318681318, 'f1-score': 0.5281925226476893, 'support': 43225}, '2': {'precision': 0.38451356717405694, 'recall': 0.015014471780028944, 'f1-score': 0.028900440221851915, 'support': 38696}, 'accuracy': 0.3635023412043591, 'macro avg': {'precision': 0.3813994650782786, 'recall': 0.3361325796617675, 'f1-score': 0.19930378548941494, 'support': 119383}, 'weighted avg': {'precision': 0.38052609823703054, 'recall': 0.3635023412043591, 'f1-score': 0.21341892804893312, 'support': 119383}}
[[  806 36249   407]
 [  693 42009   523]
 [  531 37584   581]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
4960/4960 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022252
{'0': {'precision': 0.3733294900686547, 'recall': 0.03275142297542091, 'f1-score': 0.06021988054932096, 'support': 435004}, '1': {'precision': 0.30735409855289814, 'recall': 0.9464684430836211, 'f1-score': 0.464022531853735, 'support': 393226}, '2': {'precision': 0.3984958757884522, 'recall': 0.01860480920612987, 'f1-score': 0.035549880425490475, 'support': 441445}, 'accuracy': 0.31081654754169374, 'macro avg': {'precision': 0.35972648813666835, 'recall': 0.3326082250883906, 'f1-score': 0.18659743094284878, 'support': 1269675}, 'weighted avg': {'precision': 0.36164644979449095, 'recall': 0.31081654754169374, 'f1-score': 0.17670264437247662, 'support': 1269675}}
[[ 14247 415164   5593]
 [ 14246 372176   6804]
 [  9669 423563   8213]]
Evaluating performance on  train set...
1691/1691 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022831
{'0': {'precision': 0.38990788293796363, 'recall': 0.031605587640583084, 'f1-score': 0.05847152523517583, 'support': 151334}, '1': {'precision': 0.3149038053764301, 'recall': 0.9512605780211414, 'f1-score': 0.47317011890608585, 'support': 136604}, '2': {'precision': 0.38543113243277366, 'recall': 0.021069267026907656, 'f1-score': 0.0399544574150657, 'support': 144903}, 'accuracy': 0.3183201221695727, 'macro avg': {'precision': 0.36341427358238915, 'recall': 0.334645144229544, 'f1-score': 0.19053203385210912, 'support': 432841}, 'weighted avg': {'precision': 0.3647380131944105, 'recall': 0.3183201221695727, 'f1-score': 0.1831508139612521, 'support': 432841}}
[[  4783 144264   2287]
 [  4077 129946   2581]
 [  3407 138443   3053]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080191
{'0': {'precision': 0.4032010524007893, 'recall': 0.033857426909198025, 'f1-score': 0.06246921548312584, 'support': 54316}, '1': {'precision': 0.2755474832063556, 'recall': 0.9506134455791261, 'f1-score': 0.42725083842118844, 'support': 41813}, '2': {'precision': 0.4049978457561396, 'recall': 0.017089666206094103, 'f1-score': 0.03279546445704318, 'support': 55004}, 'accuracy': 0.28138791660325674, 'macro avg': {'precision': 0.36124879378776154, 'recall': 0.3338535128981394, 'f1-score': 0.1741718394537858, 'support': 151133}, 'weighted avg': {'precision': 0.36853788904792023, 'recall': 0.28138791660325674, 'f1-score': 0.15259141909498133, 'support': 151133}}
[[ 1839 51793   684]
 [ 1368 39748   697]
 [ 1354 52710   940]]
testing model on single stock: results/universal/W8/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
10609/10609 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135281
{'0': {'precision': 0.4443924817388206, 'recall': 0.019358975851484495, 'f1-score': 0.03710169825563451, 'support': 1030788}, '1': {'precision': 0.2457548094498869, 'recall': 0.9734038247647371, 'f1-score': 0.392432395193514, 'support': 667126}, '2': {'precision': 0.42596313136653624, 'recall': 0.01187408070444691, 'f1-score': 0.023104114769236066, 'support': 1017763}, 'accuracy': 0.25092196163240327, 'macro avg': {'precision': 0.3720368075184146, 'recall': 0.33487896044022286, 'f1-score': 0.15087940273946154, 'support': 2715677}, 'weighted avg': {'precision': 0.38868885178342666, 'recall': 0.25092196163240327, 'f1-score': 0.1191453742758359, 'support': 2715677}}
[[  19955 1001720    9113]
 [  10570  649383    7173]
 [  14379  991299   12085]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015302
{'0': {'precision': 0.3585421056739249, 'recall': 0.013835224107140168, 'f1-score': 0.026642386563978847, 'support': 332051}, '1': {'precision': 0.32997935090233377, 'recall': 0.975290600726426, 'f1-score': 0.4931175485458287, 'support': 329834}, '2': {'precision': 0.36977520196698277, 'recall': 0.012488989462507823, 'f1-score': 0.024161921019035186, 'support': 337177}, 'accuracy': 0.33079928973377026, 'macro avg': {'precision': 0.3527655528477472, 'recall': 0.33387160476535804, 'f1-score': 0.1813072853762809, 'support': 999062}, 'weighted avg': {'precision': 0.35290339061066694, 'recall': 0.33079928973377026, 'f1-score': 0.17980906955870188, 'support': 999062}}
[[  4594 324164   3293]
 [  4266 321684   3884]
 [  3953 329013   4211]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040577
{'0': {'precision': 0.379454253611557, 'recall': 0.01168422925604476, 'f1-score': 0.022670387525532954, 'support': 101162}, '1': {'precision': 0.3126378304441281, 'recall': 0.9778663028649386, 'f1-score': 0.47379623435719403, 'support': 91625}, '2': {'precision': 0.3834355828220859, 'recall': 0.011267351721651343, 'f1-score': 0.021891418563922942, 'support': 99846}, 'accuracy': 0.3140589065484754, 'macro avg': {'precision': 0.3585092222925903, 'recall': 0.3336059612808782, 'f1-score': 0.17278601348221664, 'support': 292633}, 'weighted avg': {'precision': 0.3598920887963748, 'recall': 0.3140589065484754, 'f1-score': 0.16365458541507388, 'support': 292633}}
[[ 1182 99174   806]
 [ 1025 89597  1003]
 [  908 97813  1125]]
training model: results/universal/W8/deepOF_L1/h500
Epoch 1/50
7695/7695 - 109s - loss: 3.2722 - accuracy500: 0.3752 - val_loss: 3.2908 - val_accuracy500: 0.3539 - 109s/epoch - 14ms/step
Epoch 2/50
7695/7695 - 107s - loss: 3.2706 - accuracy500: 0.3748 - val_loss: 3.2905 - val_accuracy500: 0.3605 - 107s/epoch - 14ms/step
Epoch 3/50
7695/7695 - 106s - loss: 3.2690 - accuracy500: 0.3759 - val_loss: 3.2916 - val_accuracy500: 0.3599 - 106s/epoch - 14ms/step
Epoch 4/50
7695/7695 - 108s - loss: 3.2672 - accuracy500: 0.3770 - val_loss: 3.2926 - val_accuracy500: 0.3591 - 108s/epoch - 14ms/step
Epoch 5/50
7695/7695 - 107s - loss: 3.2657 - accuracy500: 0.3785 - val_loss: 3.2935 - val_accuracy500: 0.3591 - 107s/epoch - 14ms/step
Epoch 6/50
7695/7695 - 105s - loss: 3.2641 - accuracy500: 0.3796 - val_loss: 3.2958 - val_accuracy500: 0.3579 - 105s/epoch - 14ms/step
Epoch 7/50
7695/7695 - 104s - loss: 3.2625 - accuracy500: 0.3807 - val_loss: 3.3015 - val_accuracy500: 0.3568 - 104s/epoch - 13ms/step
Epoch 8/50
7695/7695 - 110s - loss: 3.2611 - accuracy500: 0.3825 - val_loss: 3.2980 - val_accuracy500: 0.3561 - 110s/epoch - 14ms/step
Epoch 9/50
7695/7695 - 111s - loss: 3.2600 - accuracy500: 0.3834 - val_loss: 3.2921 - val_accuracy500: 0.3597 - 111s/epoch - 14ms/step
Epoch 10/50
7695/7695 - 115s - loss: 3.2589 - accuracy500: 0.3842 - val_loss: 3.2902 - val_accuracy500: 0.3620 - 115s/epoch - 15ms/step
Epoch 11/50
7695/7695 - 117s - loss: 3.2581 - accuracy500: 0.3848 - val_loss: 3.2883 - val_accuracy500: 0.3613 - 117s/epoch - 15ms/step
Epoch 12/50
7695/7695 - 118s - loss: 3.2576 - accuracy500: 0.3848 - val_loss: 3.2887 - val_accuracy500: 0.3606 - 118s/epoch - 15ms/step
Epoch 13/50
7695/7695 - 117s - loss: 3.2569 - accuracy500: 0.3854 - val_loss: 3.2900 - val_accuracy500: 0.3578 - 117s/epoch - 15ms/step
Epoch 14/50
7695/7695 - 115s - loss: 3.2561 - accuracy500: 0.3863 - val_loss: 3.2907 - val_accuracy500: 0.3538 - 115s/epoch - 15ms/step
Epoch 15/50
7695/7695 - 116s - loss: 3.2554 - accuracy500: 0.3868 - val_loss: 3.2904 - val_accuracy500: 0.3549 - 116s/epoch - 15ms/step
Epoch 16/50
7695/7695 - 110s - loss: 3.2539 - accuracy500: 0.3878 - val_loss: 3.2940 - val_accuracy500: 0.3452 - 110s/epoch - 14ms/step
Epoch 17/50
7695/7695 - 110s - loss: 3.2532 - accuracy500: 0.3878 - val_loss: 3.2962 - val_accuracy500: 0.3444 - 110s/epoch - 14ms/step
Epoch 18/50
7695/7695 - 108s - loss: 3.2524 - accuracy500: 0.3880 - val_loss: 3.3041 - val_accuracy500: 0.3338 - 108s/epoch - 14ms/step
Epoch 19/50
7695/7695 - 111s - loss: 3.2519 - accuracy500: 0.3887 - val_loss: 3.3051 - val_accuracy500: 0.3368 - 111s/epoch - 14ms/step
Epoch 20/50
7695/7695 - 110s - loss: 3.2513 - accuracy500: 0.3895 - val_loss: 3.3240 - val_accuracy500: 0.3279 - 110s/epoch - 14ms/step
Epoch 21/50
7695/7695 - 111s - loss: 3.2502 - accuracy500: 0.3902 - val_loss: 3.3334 - val_accuracy500: 0.3246 - 111s/epoch - 14ms/step
testing model in sample: results/universal/W8/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 135s - 135s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936172
{'0': {'precision': 0.38347970025626493, 'recall': 0.6558010541642101, 'f1-score': 0.4839623761124452, 'support': 2142171}, '1': {'precision': 0.3067656351348524, 'recall': 0.06835543661459632, 'f1-score': 0.11179909904929303, 'support': 1715884}, '2': {'precision': 0.38926526326452077, 'recall': 0.35452292276145947, 'f1-score': 0.37108268578287545, 'support': 2102888}, 'accuracy': 0.3804179976221883, 'macro avg': {'precision': 0.35983686621854605, 'recall': 0.3595598045134219, 'f1-score': 0.3222813869815379, 'support': 5960943}, 'weighted avg': {'precision': 0.36343823267412484, 'recall': 0.3804179976221883, 'f1-score': 0.33701207668196953, 'support': 5960943}}
[[1404838  123392  613941]
 [1042854  117290  555740]
 [1215704  141662  745522]]
Evaluating performance on  train set...
7695/7695 - 46s - 46s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971737
{'0': {'precision': 0.34930377246691685, 'recall': 0.6493038026966745, 'f1-score': 0.4542410320128166, 'support': 653694}, '1': {'precision': 0.34991957294115567, 'recall': 0.0609234225569926, 'f1-score': 0.10377832036497507, 'support': 649865}, '2': {'precision': 0.36511525990988813, 'recall': 0.3515685302818699, 'f1-score': 0.35821386521287757, 'support': 665910}, 'accuracy': 0.3544869200784577, 'macro avg': {'precision': 0.35477953510598687, 'recall': 0.3539319185118457, 'f1-score': 0.3054110725302231, 'support': 1969469}, 'weighted avg': {'precision': 0.35485309300881934, 'recall': 0.3544869200784577, 'f1-score': 0.30613060186704033, 'support': 1969469}}
[[424446  34755 194493]
 [397676  39592 212597]
 [392998  38799 234113]]
Evaluating performance on  val set...
2338/2338 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961729
{'0': {'precision': 0.35872425987783146, 'recall': 0.6477933579335793, 'f1-score': 0.46174888301267436, 'support': 203250}, '1': {'precision': 0.332168952698372, 'recall': 0.054015321277815415, 'f1-score': 0.09292047298448187, 'support': 191890}, '2': {'precision': 0.3706005282122471, 'recall': 0.36493468680757407, 'f1-score': 0.3677457854691929, 'support': 202639}, 'accuracy': 0.3613024211288787, 'macro avg': {'precision': 0.35383124692948353, 'recall': 0.3555811220063229, 'f1-score': 0.3074717138221164, 'support': 597779}, 'weighted avg': {'precision': 0.354225770041874, 'recall': 0.3613024211288787, 'f1-score': 0.31148736950446587, 'support': 597779}}
[[131664   9934  61652]
 [117586  10365  63939]
 [117784  10905  73950]]
testing model out of sample: results/universal/W8/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 89s - 89s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947001
{'0': {'precision': 0.36653112416601774, 'recall': 0.6531381967312989, 'f1-score': 0.4695551245437468, 'support': 1247468}, '1': {'precision': 0.35125182300096414, 'recall': 0.0903254275275277, 'f1-score': 0.143698394989388, 'support': 1117238}, '2': {'precision': 0.3845365848807026, 'recall': 0.3398269799150001, 'f1-score': 0.36080198579201783, 'support': 1251531}, 'accuracy': 0.3708241467580803, 'macro avg': {'precision': 0.3674398440158948, 'recall': 0.3610968680579423, 'f1-score': 0.3246851684417175, 'support': 3616237}, 'weighted avg': {'precision': 0.368042025243206, 'recall': 0.3708241467580803, 'f1-score': 0.331243546704976, 'support': 3616237}}
[[814769  87584 345115]
 [680725 100915 335598]
 [727425  98802 425304]]
Evaluating performance on  train set...
4550/4550 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962235
{'0': {'precision': 0.35402059947753917, 'recall': 0.6372374419278047, 'f1-score': 0.45516943475380073, 'support': 390247}, '1': {'precision': 0.363535366004197, 'recall': 0.08426937063955757, 'f1-score': 0.13682256569235934, 'support': 384422}, '2': {'precision': 0.3669585895374772, 'recall': 0.35104782347473773, 'f1-score': 0.35882691805511635, 'support': 389474}, 'accuracy': 0.358889758388789, 'macro avg': {'precision': 0.36150485167307106, 'recall': 0.3575182120140334, 'f1-score': 0.3169396395004255, 'support': 1164143}, 'weighted avg': {'precision': 0.3614910703031295, 'recall': 0.358889758388789, 'f1-score': 0.3178130743693455, 'support': 1164143}}
[[248680  27136 114431]
 [230595  32395 121432]
 [223170  29580 136724]]
Evaluating performance on  val set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966585
{'0': {'precision': 0.35800551162046323, 'recall': 0.6706837294332724, 'f1-score': 0.46682411385060163, 'support': 136750}, '1': {'precision': 0.3411673204382524, 'recall': 0.07804172435932145, 'f1-score': 0.12702629541262456, 'support': 129277}, '2': {'precision': 0.36826261592247833, 'recall': 0.3144397860772433, 'f1-score': 0.3392295613190396, 'support': 135002}, 'accuracy': 0.35971214051851613, 'macro avg': {'precision': 0.35581181599373135, 'recall': 0.3543884132899457, 'f1-score': 0.31102665686075526, 'support': 401029}, 'weighted avg': {'precision': 0.3560304393776029, 'recall': 0.35971214051851613, 'f1-score': 0.3143324926584377, 'support': 401029}}
[[91716  9399 35635]
 [82002 10089 37186]
 [82468 10084 42450]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094673
{'0': {'precision': 0.3943599690461594, 'recall': 0.6182740636866403, 'f1-score': 0.4815610235012579, 'support': 63467}, '1': {'precision': 0.2383853769992384, 'recall': 0.03276714910099715, 'f1-score': 0.05761487310462254, 'support': 38209}, '2': {'precision': 0.38978458879063893, 'recall': 0.37080783644039655, 'f1-score': 0.3800594779874724, 'support': 63243}, 'accuracy': 0.38772367040789724, 'macro avg': {'precision': 0.3408433116120122, 'recall': 0.340616349742678, 'f1-score': 0.3064117915311176, 'support': 164919}, 'weighted avg': {'precision': 0.35646867719367004, 'recall': 0.38772367040789724, 'f1-score': 0.34441599652781413, 'support': 164919}}
[[39240  1796 22431]
 [22675  1252 14282]
 [37588  2204 23451]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003149
{'0': {'precision': 0.33995264871263686, 'recall': 0.6083249483662554, 'f1-score': 0.43616273992368004, 'support': 18883}, '1': {'precision': 0.30874060150375937, 'recall': 0.03478951548848292, 'f1-score': 0.06253271784133632, 'support': 18885}, '2': {'precision': 0.33754002637031455, 'recall': 0.36975136696585165, 'f1-score': 0.35291221505588105, 'support': 19386}, 'accuracy': 0.33789411064842356, 'macro avg': {'precision': 0.3287444255289036, 'recall': 0.3376219436068633, 'f1-score': 0.2838692242736325, 'support': 57154}, 'weighted avg': {'precision': 0.32882113371337324, 'recall': 0.33789411064842356, 'f1-score': 0.28446911144426984, 'support': 57154}}
[[11487   695  6701]
 [10861   657  7367]
 [11442   776  7168]]
Evaluating performance on  val set...
68/68 - 1s - 550ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958693
{'0': {'precision': 0.3846370287000563, 'recall': 0.6206113801452785, 'f1-score': 0.47492762015055007, 'support': 6608}, '1': {'precision': 0.31891891891891894, 'recall': 0.035492279927812315, 'f1-score': 0.06387585709130279, 'support': 4987}, '2': {'precision': 0.33416417414423394, 'recall': 0.35656028368794324, 'f1-score': 0.3449991422199348, 'support': 5640}, 'accuracy': 0.36489701189440094, 'macro avg': {'precision': 0.34590670725440303, 'recall': 0.3375546479203447, 'f1-score': 0.2946008731539292, 'support': 17235}, 'weighted avg': {'precision': 0.34910450110078906, 'recall': 0.36489701189440094, 'f1-score': 0.31347059909426134, 'support': 17235}}
[[4101  201 2306]
 [3109  177 1701]
 [3452  177 2011]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
2179/2179 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0889676
{'0': {'precision': 0.4161775166228545, 'recall': 0.6332872148181613, 'f1-score': 0.5022749073427815, 'support': 212496}, '1': {'precision': 0.3025858388729646, 'recall': 0.06414806482684612, 'f1-score': 0.10585493084706347, 'support': 154689}, '2': {'precision': 0.39493927025110226, 'recall': 0.41781835353376356, 'f1-score': 0.40605678941209167, 'support': 190590}, 'accuracy': 0.40182152301555285, 'macro avg': {'precision': 0.3712342085823071, 'recall': 0.37175121105959036, 'f1-score': 0.33806220920064556, 'support': 557775}, 'weighted avg': {'precision': 0.377417836795962, 'recall': 0.40182152301555285, 'f1-score': 0.3594574256690667, 'support': 557775}}
[[134571  10632  67293]
 [ 90060   9923  54706]
 [ 98719  12239  79632]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944598
{'0': {'precision': 0.37103632870680164, 'recall': 0.639507412988076, 'f1-score': 0.4696095238745722, 'support': 53757}, '1': {'precision': 0.3507228158390949, 'recall': 0.0538589243658546, 'f1-score': 0.09337818163562427, 'support': 51802}, '2': {'precision': 0.36717131474103587, 'recall': 0.40244541484716156, 'f1-score': 0.384, 'support': 51525}, 'accuracy': 0.3686180642204171, 'macro avg': {'precision': 0.36297681976231083, 'recall': 0.3652705840670307, 'f1-score': 0.31566256850339885, 'support': 157084}, 'weighted avg': {'precision': 0.36306972842823076, 'recall': 0.3686180642204171, 'f1-score': 0.3174580208042448, 'support': 157084}}
[[34378  2304 17075]
 [30348  2790 18664]
 [27928  2861 20736]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0928987
{'0': {'precision': 0.37975037583470267, 'recall': 0.6452417726030653, 'f1-score': 0.4781125514448577, 'support': 16834}, '1': {'precision': 0.3281201126055677, 'recall': 0.06630427912268504, 'f1-score': 0.110316542223157, 'support': 15821}, '2': {'precision': 0.37183770883054895, 'recall': 0.3918264696636278, 'f1-score': 0.3815704882902189, 'support': 15905}, 'accuracy': 0.3736202635914333, 'macro avg': {'precision': 0.35990273242360643, 'recall': 0.36779084046312605, 'f1-score': 0.32333319398607785, 'support': 48560}, 'weighted avg': {'precision': 0.36033741530650637, 'recall': 0.3736202635914333, 'f1-score': 0.3266627537436415, 'support': 48560}}
[[10862   920  5052]
 [ 9296  1049  5476]
 [ 8445  1228  6232]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
1162/1162 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925417
{'0': {'precision': 0.28251061350203943, 'recall': 0.6934991690052584, 'f1-score': 0.4014731803108032, 'support': 73406}, '1': {'precision': 0.6462483708806553, 'recall': 0.16710683778318822, 'f1-score': 0.2655482390229241, 'support': 145398}, '2': {'precision': 0.2822659603846057, 'recall': 0.28589772929539503, 'f1-score': 0.28407023749368365, 'support': 78654}, 'accuracy': 0.3284194743459581, 'macro avg': {'precision': 0.40367498158910015, 'recall': 0.38216791202794725, 'f1-score': 0.3170305522758037, 'support': 297458}, 'weighted avg': {'precision': 0.4602415856091516, 'recall': 0.3284194743459581, 'f1-score': 0.3039890794370235, 'support': 297458}}
[[50907  5727 16772]
 [80694 24297 40407]
 [48594  7573 22487]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983977
{'0': {'precision': 0.34751800586282544, 'recall': 0.6372503648855505, 'f1-score': 0.4497625687796789, 'support': 28091}, '1': {'precision': 0.3527991218441273, 'recall': 0.11104201216141514, 'f1-score': 0.16891785357649655, 'support': 28944}, '2': {'precision': 0.3359174251992509, 'recall': 0.29054130410215845, 'f1-score': 0.3115860063020118, 'support': 26547}, 'accuracy': 0.34490679811442654, 'macro avg': {'precision': 0.3454115176354012, 'recall': 0.3462778937163747, 'f1-score': 0.31008880955272905, 'support': 83582}, 'weighted avg': {'precision': 0.34566229537596094, 'recall': 0.34490679811442654, 'f1-score': 0.30862042524476063, 'support': 83582}}
[[17901  2956  7234]
 [17716  3214  8014]
 [15894  2940  7713]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007056
{'0': {'precision': 0.3123291909451864, 'recall': 0.6230840448513527, 'f1-score': 0.41608847976918323, 'support': 9721}, '1': {'precision': 0.41100786275911366, 'recall': 0.13875482625482624, 'f1-score': 0.2074688796680498, 'support': 12432}, '2': {'precision': 0.3184589124603755, 'recall': 0.27098246706089846, 'f1-score': 0.2928086990639538, 'support': 9639}, 'accuracy': 0.32693759436336184, 'macro avg': {'precision': 0.3472653220548918, 'recall': 0.3442737793890258, 'f1-score': 0.30545535283372893, 'support': 31792}, 'weighted avg': {'precision': 0.3527751406707668, 'recall': 0.32693759436336184, 'f1-score': 0.2971323689653647, 'support': 31792}}
[[6057 1198 2466]
 [7583 1725 3124]
 [5753 1274 2612]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1223/1223 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990502
{'0': {'precision': 0.34253554797420127, 'recall': 0.6817672657341964, 'f1-score': 0.4559775114034158, 'support': 100879}, '1': {'precision': 0.3318969675531402, 'recall': 0.0936773889050247, 'f1-score': 0.14611426104068012, 'support': 110176}, '2': {'precision': 0.3662164493628768, 'recall': 0.29142027791670344, 'f1-score': 0.3245649004199455, 'support': 101973}, 'accuracy': 0.3476174655302401, 'macro avg': {'precision': 0.3468829882967394, 'recall': 0.35562164418530817, 'f1-score': 0.3088855576213472, 'support': 313028}, 'weighted avg': {'precision': 0.3465054686229502, 'recall': 0.3476174655302401, 'f1-score': 0.30410601220276223, 'support': 313028}}
[[68776 10240 21863]
 [70289 10321 29566]
 [61720 10536 29717]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09952
{'0': {'precision': 0.3439571737511965, 'recall': 0.649897846401179, 'f1-score': 0.4498383002399416, 'support': 29857}, '1': {'precision': 0.3354083139902933, 'recall': 0.10502494301100135, 'f1-score': 0.1599617581201097, 'support': 30269}, '2': {'precision': 0.36928501469147895, 'recall': 0.30123677734811927, 'f1-score': 0.33180794142495074, 'support': 31291}, 'accuracy': 0.35014275244210596, 'macro avg': {'precision': 0.34955016747765627, 'recall': 0.3520531889200999, 'f1-score': 0.3138693332616674, 'support': 91417}, 'weighted avg': {'precision': 0.34979600060790367, 'recall': 0.35014275244210596, 'f1-score': 0.3134570909341771, 'support': 91417}}
[[19404  2931  7522]
 [18513  3179  8577]
 [18497  3368  9426]]
Evaluating performance on  val set...
99/99 - 1s - 830ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011896
{'0': {'precision': 0.3335042109117539, 'recall': 0.5614597460239181, 'f1-score': 0.41845079481760544, 'support': 8111}, '1': {'precision': 0.3540925266903915, 'recall': 0.10681696188942566, 'f1-score': 0.16412371134020617, 'support': 9315}, '2': {'precision': 0.31835759781619655, 'recall': 0.3574256161409782, 'f1-score': 0.3367623172712507, 'support': 7831}, 'accuracy': 0.3305222314605852, 'macro avg': {'precision': 0.335318111806114, 'recall': 0.341900774684774, 'f1-score': 0.30644560780968744, 'support': 25257}, 'weighted avg': {'precision': 0.33640111214019347, 'recall': 0.3305222314605852, 'f1-score': 0.29932503759158974, 'support': 25257}}
[[4554  909 2648]
 [4975  995 3345]
 [4126  906 2799]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990255
{'0': {'precision': 0.33971278353329915, 'recall': 0.6044487994439001, 'f1-score': 0.4349657682850393, 'support': 119403}, '1': {'precision': 0.343829822871739, 'recall': 0.13013296987178471, 'f1-score': 0.1888063648278875, 'support': 126194}, '2': {'precision': 0.3672120917341948, 'recall': 0.32377715742201724, 'f1-score': 0.3441294850184045, 'support': 123585}, 'accuracy': 0.3483620544880303, 'macro avg': {'precision': 0.350251566046411, 'recall': 0.35278630891256735, 'f1-score': 0.3226338727104438, 'support': 369182}, 'weighted avg': {'precision': 0.3503255644009546, 'recall': 0.3483620544880303, 'f1-score': 0.32041564984107707, 'support': 369182}}
[[72173 14618 32612]
 [73431 16422 36341]
 [66849 16722 40014]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977432
{'0': {'precision': 0.34027692834601364, 'recall': 0.6788599038531931, 'f1-score': 0.4533255114761311, 'support': 40979}, '1': {'precision': 0.39531464418741424, 'recall': 0.09648325358851674, 'f1-score': 0.15510941886850504, 'support': 41800}, '2': {'precision': 0.36644045087816385, 'recall': 0.2891519190990577, 'f1-score': 0.32324036843389903, 'support': 43510}, 'accuracy': 0.35183586852378274, 'macro avg': {'precision': 0.3673440078038639, 'recall': 0.35483169218025584, 'f1-score': 0.3105584329261784, 'support': 126289}, 'weighted avg': {'precision': 0.3675077353643953, 'recall': 0.35183586852378274, 'f1-score': 0.30980202768287685, 'support': 126289}}
[[27819  2836 10324]
 [26339  4033 11428]
 [27596  3333 12581]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998785
{'0': {'precision': 0.3374483862812842, 'recall': 0.6558840389812464, 'f1-score': 0.44562526081513415, 'support': 12211}, '1': {'precision': 0.3280738314974695, 'recall': 0.08736324718566672, 'f1-score': 0.13798284605271394, 'support': 12614}, '2': {'precision': 0.37213930348258706, 'recall': 0.30878931171658036, 'f1-score': 0.3375174337517434, 'support': 13323}, 'accuracy': 0.34667610359651885, 'macro avg': {'precision': 0.34588717375378025, 'recall': 0.35067886596116443, 'f1-score': 0.3070418468731972, 'support': 38148}, 'weighted avg': {'precision': 0.34646423130146664, 'recall': 0.34667610359651885, 'f1-score': 0.30614423953541503, 'support': 38148}}
[[8009 1039 3163]
 [7734 1102 3778]
 [7991 1218 4114]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/EXC
Evaluating performance on  test set...
5521/5521 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0902838
{'0': {'precision': 0.3959243243764402, 'recall': 0.6628873176913082, 'f1-score': 0.4957505243937405, 'support': 495588}, '1': {'precision': 0.3124350752780509, 'recall': 0.10714141526886879, 'f1-score': 0.15956440314990708, 'support': 421079}, '2': {'precision': 0.41221208912570734, 'recall': 0.36450090407902735, 'f1-score': 0.3868911180143471, 'support': 496638}, 'accuracy': 0.3924552732778841, 'macro avg': {'precision': 0.3735238295933995, 'recall': 0.37817654567973474, 'f1-score': 0.3474020151859982, 'support': 1413305}, 'weighted avg': {'precision': 0.37677315275279627, 'recall': 0.3924552732778841, 'f1-score': 0.35733409367802005, 'support': 1413305}}
[[328519  41803 125266]
 [243100  45115 132864]
 [258133  57480 181025]]
Evaluating performance on  train set...
1288/1288 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0916018
{'0': {'precision': 0.36899509987188883, 'recall': 0.6750658896701413, 'f1-score': 0.4771675369045317, 'support': 109653}, '1': {'precision': 0.36924976844705154, 'recall': 0.07691530313191912, 'f1-score': 0.12731143552311436, 'support': 108847}, '2': {'precision': 0.3947185480234481, 'recall': 0.3777556011076348, 'f1-score': 0.38605082783586614, 'support': 111228}, 'accuracy': 0.3773170613354037, 'macro avg': {'precision': 0.3776544721141295, 'recall': 0.3765789313032317, 'f1-score': 0.3301766000878374, 'support': 329728}, 'weighted avg': {'precision': 0.37775652626395245, 'recall': 0.3773170613354037, 'f1-score': 0.33093938405323403, 'support': 329728}}
[[74023  6528 29102]
 [65146  8372 35329]
 [61438  7773 42017]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925868
{'0': {'precision': 0.37856514274997477, 'recall': 0.6761924395083361, 'f1-score': 0.4853871480892309, 'support': 38807}, '1': {'precision': 0.33034665099882493, 'recall': 0.06309086318624288, 'f1-score': 0.10594747379578377, 'support': 35647}, '2': {'precision': 0.38921303146199154, 'recall': 0.3718659980795903, 'f1-score': 0.3803418220506595, 'support': 37492}, 'accuracy': 0.3790398942347203, 'macro avg': {'precision': 0.36604160840359706, 'recall': 0.37038310025805643, 'f1-score': 0.32389214797855803, 'support': 111946}, 'weighted avg': {'precision': 0.3667770133673947, 'recall': 0.3790398942347203, 'f1-score': 0.32938116812231266, 'support': 111946}}
[[26241  2158 10408]
 [21927  2249 11471]
 [21149  2401 13942]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/AAL
Evaluating performance on  test set...
5918/5918 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094072
{'0': {'precision': 0.36838827700239585, 'recall': 0.6916676266175171, 'f1-score': 0.48073359972404617, 'support': 520860}, '1': {'precision': 0.3421341889926388, 'recall': 0.06285030145301168, 'f1-score': 0.10619289095197973, 'support': 490292}, '2': {'precision': 0.3822525979037797, 'recall': 0.3391181122990725, 'f1-score': 0.3593957381111137, 'support': 503851}, 'accuracy': 0.37091807738994576, 'macro avg': {'precision': 0.3642583546329381, 'recall': 0.3645453467898671, 'f1-score': 0.3154407429290465, 'support': 1515003}, 'weighted avg': {'precision': 0.3645027286780713, 'recall': 0.37091807738994576, 'f1-score': 0.3191692225599009, 'support': 1515003}}
[[360262  28686 131912]
 [315259  30815 144218]
 [302420  30566 170865]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939662
{'0': {'precision': 0.3571611812272594, 'recall': 0.6402510509032262, 'f1-score': 0.4585322181865412, 'support': 154391}, '1': {'precision': 0.3854092416400657, 'recall': 0.08116698756649153, 'f1-score': 0.1340938743382107, 'support': 153215}, '2': {'precision': 0.38371111841130584, 'recall': 0.380223525732267, 'f1-score': 0.381959361114139, 'support': 156671}, 'accuracy': 0.3680022917353218, 'macro avg': {'precision': 0.3754271804262103, 'recall': 0.3672138547339949, 'f1-score': 0.3248618178796303, 'support': 464277}, 'weighted avg': {'precision': 0.37544257742976317, 'recall': 0.3680022917353218, 'f1-score': 0.3256254255969615, 'support': 464277}}
[[98849  9228 46314]
 [91416 12436 49363]
 [86498 10603 59570]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957409
{'0': {'precision': 0.3534814222628293, 'recall': 0.6899556017907897, 'f1-score': 0.4674675745580637, 'support': 53831}, '1': {'precision': 0.35494091454016097, 'recall': 0.07282918086938188, 'f1-score': 0.12085957546069513, 'support': 56914}, '2': {'precision': 0.3659263448695917, 'recall': 0.3236493766353702, 'f1-score': 0.3434918884702952, 'support': 51976}, 'accuracy': 0.3571020335420751, 'macro avg': {'precision': 0.358116227224194, 'recall': 0.3621447197651806, 'f1-score': 0.310606346163018, 'support': 162721}, 'weighted avg': {'precision': 0.3579670316241357, 'recall': 0.3571020335420751, 'f1-score': 0.3066364100450292, 'support': 162721}}
[[37141  3600 13090]
 [36710  4145 16059]
 [31221  3933 16822]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/WBA
Evaluating performance on  test set...
3755/3755 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994157
{'0': {'precision': 0.3327855439184083, 'recall': 0.6182552258988998, 'f1-score': 0.43267630192275985, 'support': 309851}, '1': {'precision': 0.37347029539618093, 'recall': 0.0736782520095098, 'f1-score': 0.12307605023840312, 'support': 353320}, '2': {'precision': 0.33005497010842033, 'recall': 0.3497937829502629, 'f1-score': 0.3396378269617707, 'support': 297987}, 'accuracy': 0.334838809019953, 'macro avg': {'precision': 0.34543693647433654, 'recall': 0.34724242028622415, 'f1-score': 0.29846339304097785, 'support': 961158}, 'weighted avg': {'precision': 0.3468946299315401, 'recall': 0.334838809019953, 'f1-score': 0.2900231512822645, 'support': 961158}}
[[191567  22149  96135]
 [211849  26032 115439]
 [172231  21522 104234]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098576
{'0': {'precision': 0.34421875726857903, 'recall': 0.6255523874666646, 'f1-score': 0.4440776910906214, 'support': 130117}, '1': {'precision': 0.34159743856005537, 'recall': 0.060922440601584985, 'f1-score': 0.10340333850677459, 'support': 129591}, '2': {'precision': 0.3577596283643658, 'recall': 0.35811881935532575, 'f1-score': 0.3579391337480619, 'support': 132470}, 'accuracy': 0.3486427081580303, 'macro avg': {'precision': 0.3478586080643334, 'recall': 0.34819788247452516, 'f1-score': 0.30180672111515267, 'support': 392178}, 'weighted avg': {'precision': 0.3479264101234117, 'recall': 0.3486427081580303, 'f1-score': 0.3024096099721952, 'support': 392178}}
[[81395  7101 41621]
 [78154  7895 43542]
 [76914  8116 47440]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981264
{'0': {'precision': 0.34339813604352043, 'recall': 0.620371781197623, 'f1-score': 0.4420858329487771, 'support': 39378}, '1': {'precision': 0.3069466882067851, 'recall': 0.0495785820525533, 'f1-score': 0.08536831936737582, 'support': 38323}, '2': {'precision': 0.3734484234555571, 'recall': 0.3767813444652368, 'f1-score': 0.3751074806534824, 'support': 41682}, 'accuracy': 0.3520936816799712, 'macro avg': {'precision': 0.3412644159019542, 'recall': 0.3489105692384711, 'f1-score': 0.3008538776565451, 'support': 119383}, 'weighted avg': {'precision': 0.34218881180523947, 'recall': 0.3520936816799712, 'f1-score': 0.30419118334747275, 'support': 119383}}
[[24429  2055 12894]
 [22968  1900 13455]
 [23742  2235 15705]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
4960/4960 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947692
{'0': {'precision': 0.3883585465593017, 'recall': 0.6213058010086492, 'f1-score': 0.4779596673484459, 'support': 470332}, '1': {'precision': 0.26427635274293204, 'recall': 0.08901291207491842, 'f1-score': 0.13317137027820694, 'support': 317145}, '2': {'precision': 0.41110753741417033, 'recall': 0.34989983367828154, 'f1-score': 0.378042222530932, 'support': 482198}, 'accuracy': 0.38527260913225825, 'macro avg': {'precision': 0.3545808122388014, 'recall': 0.35340618225394976, 'f1-score': 0.3297244200525283, 'support': 1269675}, 'weighted avg': {'precision': 0.36600437760609983, 'recall': 0.38527260913225825, 'f1-score': 0.35389021923734937, 'support': 1269675}}
[[292220  36669 141443]
 [188673  28230 100242]
 [271556  41921 168721]]
Evaluating performance on  train set...
1691/1691 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973077
{'0': {'precision': 0.3573138056224651, 'recall': 0.6248419572287243, 'f1-score': 0.45464205596442203, 'support': 147903}, '1': {'precision': 0.33844676102494564, 'recall': 0.08461766658661657, 'f1-score': 0.13538635400480295, 'support': 141578}, '2': {'precision': 0.3576795890578734, 'recall': 0.3463099888392857, 'f1-score': 0.35190297806586973, 'support': 143360}, 'accuracy': 0.3558881898895899, 'macro avg': {'precision': 0.35114671856842805, 'recall': 0.35192320421820883, 'f1-score': 0.3139771293450316, 'support': 432841}, 'weighted avg': {'precision': 0.35126373243917736, 'recall': 0.3558881898895899, 'f1-score': 0.31618877178021715, 'support': 432841}}
[[92416 11514 43973]
 [84415 11980 45183]
 [81810 11903 49647]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959285
{'0': {'precision': 0.37408646740022994, 'recall': 0.6702035712315416, 'f1-score': 0.48016178863395326, 'support': 54379}, '1': {'precision': 0.30562072834846477, 'recall': 0.07077722655327191, 'f1-score': 0.11493679627107592, 'support': 42330}, '2': {'precision': 0.38502710335717216, 'recall': 0.3106166397177716, 'f1-score': 0.3438421641411573, 'support': 54424}, 'accuracy': 0.37282393653272283, 'macro avg': {'precision': 0.35491143303528894, 'recall': 0.3505324791675284, 'f1-score': 0.3129802496820622, 'support': 151133}, 'weighted avg': {'precision': 0.3588500758593977, 'recall': 0.37282393653272283, 'f1-score': 0.3287783504032788, 'support': 151133}}
[[36445  3293 14641]
 [26974  2996 12360]
 [34005  3514 16905]]
testing model on single stock: results/universal/W8/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
10609/10609 - 70s - 70s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936455
{'0': {'precision': 0.39261870238763585, 'recall': 0.6649312019168286, 'f1-score': 0.49371556767400915, 'support': 1023357}, '1': {'precision': 0.24817309070067345, 'recall': 0.038396736720759064, 'f1-score': 0.06650411811008505, 'support': 676620}, '2': {'precision': 0.3998986165141168, 'recall': 0.34562666141577236, 'f1-score': 0.37078722297477495, 'support': 1015700}, 'accuracy': 0.389403820852038, 'macro avg': {'precision': 0.3468968032008087, 'recall': 0.34965153335112004, 'f1-score': 0.3103356362529564, 'support': 2715677}, 'weighted avg': {'precision': 0.3593523820552231, 'recall': 0.389403820852038, 'f1-score': 0.34129754052462635, 'support': 2715677}}
[[680462  38970 303925]
 [427763  25980 222877]
 [624912  39735 351053]]
Evaluating performance on  train set...
3903/3903 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098725
{'0': {'precision': 0.3421230120225116, 'recall': 0.6511368108746329, 'f1-score': 0.4485611555803972, 'support': 330310}, '1': {'precision': 0.3506117192530586, 'recall': 0.05290324147730723, 'f1-score': 0.0919346158310733, 'support': 329356}, '2': {'precision': 0.3577820599166854, 'recall': 0.33808589376421644, 'f1-score': 0.3476552321741291, 'support': 339396}, 'accuracy': 0.34757202255715863, 'macro avg': {'precision': 0.3501722637307519, 'recall': 0.3473753153720522, 'f1-score': 0.2960503345285332, 'support': 999062}, 'weighted avg': {'precision': 0.35024105162137037, 'recall': 0.34757202255715863, 'f1-score': 0.29671456607336755, 'support': 999062}}
[[215077  15674  99559]
 [205524  17424 106408]
 [208053  16598 114745]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968275
{'0': {'precision': 0.35646239388748696, 'recall': 0.6588893328006392, 'f1-score': 0.46263627214805925, 'support': 100120}, '1': {'precision': 0.3453140745717165, 'recall': 0.04431798585963097, 'f1-score': 0.07855423528063271, 'support': 92784}, '2': {'precision': 0.3664882607513955, 'recall': 0.3515426806646011, 'f1-score': 0.35885992701813285, 'support': 99729}, 'accuracy': 0.3592862049051201, 'macro avg': {'precision': 0.35608824307019965, 'recall': 0.35158333310829043, 'f1-score': 0.30001681148227494, 'support': 292633}, 'weighted avg': {'precision': 0.35634444415890637, 'recall': 0.3592862049051201, 'f1-score': 0.30549002127351765, 'support': 292633}}
[[65968  3822 30330]
 [58399  4112 30273]
 [60696  3974 35059]]
training model: results/universal/W8/deepOF_L1/h1000
Epoch 1/50
7695/7695 - 119s - loss: 3.2750 - accuracy1000: 0.3694 - val_loss: 3.2919 - val_accuracy1000: 0.3448 - 119s/epoch - 15ms/step
Epoch 2/50
7695/7695 - 116s - loss: 3.2724 - accuracy1000: 0.3712 - val_loss: 3.2929 - val_accuracy1000: 0.3448 - 116s/epoch - 15ms/step
Epoch 3/50
7695/7695 - 115s - loss: 3.2669 - accuracy1000: 0.3744 - val_loss: 3.2964 - val_accuracy1000: 0.3449 - 115s/epoch - 15ms/step
Epoch 4/50
7695/7695 - 113s - loss: 3.2645 - accuracy1000: 0.3768 - val_loss: 3.2978 - val_accuracy1000: 0.3460 - 113s/epoch - 15ms/step
Epoch 5/50
7695/7695 - 114s - loss: 3.2643 - accuracy1000: 0.3776 - val_loss: 3.2988 - val_accuracy1000: 0.3468 - 114s/epoch - 15ms/step
Epoch 6/50
7695/7695 - 114s - loss: 3.2621 - accuracy1000: 0.3791 - val_loss: 3.3035 - val_accuracy1000: 0.3448 - 114s/epoch - 15ms/step
Epoch 7/50
7695/7695 - 113s - loss: 3.2607 - accuracy1000: 0.3798 - val_loss: 3.3094 - val_accuracy1000: 0.3450 - 113s/epoch - 15ms/step
Epoch 8/50
7695/7695 - 113s - loss: 3.2598 - accuracy1000: 0.3810 - val_loss: 3.3138 - val_accuracy1000: 0.3456 - 113s/epoch - 15ms/step
Epoch 9/50
7695/7695 - 111s - loss: 3.2589 - accuracy1000: 0.3820 - val_loss: 3.3107 - val_accuracy1000: 0.3460 - 111s/epoch - 14ms/step
Epoch 10/50
7695/7695 - 112s - loss: 3.2583 - accuracy1000: 0.3825 - val_loss: 3.3099 - val_accuracy1000: 0.3462 - 112s/epoch - 15ms/step
Epoch 11/50
7695/7695 - 110s - loss: 3.2576 - accuracy1000: 0.3837 - val_loss: 3.3069 - val_accuracy1000: 0.3463 - 110s/epoch - 14ms/step
testing model in sample: results/universal/W8/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 140s - 140s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971907
{'0': {'precision': 0.3503499300106358, 'recall': 0.9982340558521148, 'f1-score': 0.5186643698401661, 'support': 2087835}, '1': {'precision': 0.3890353189246178, 'recall': 0.00040100065420702936, 'f1-score': 0.0008011754916291817, 'support': 1840396}, '2': {'precision': 0.3592610597958191, 'recall': 0.0018177685771521002, 'f1-score': 0.0036172348760179283, 'support': 2032712}, 'accuracy': 0.35037761642746795, 'macro avg': {'precision': 0.3662154362436909, 'recall': 0.33348427502782463, 'f1-score': 0.17436092673593773, 'support': 5960943}, 'weighted avg': {'precision': 0.3653324915723948, 'recall': 0.35037761642746795, 'f1-score': 0.1831443282572297, 'support': 5960943}}
[[2084148     601    3086]
 [1836154     738    3504]
 [2028459     558    3695]]
Evaluating performance on  train set...
7695/7695 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100242
{'0': {'precision': 0.32813843387873504, 'recall': 0.9981584477726503, 'f1-score': 0.49390774320019604, 'support': 646194}, '1': {'precision': 0.30781758957654726, 'recall': 0.00029008685722354643, 'f1-score': 0.0005796274743422838, 'support': 651529}, '2': {'precision': 0.35743222187597384, 'recall': 0.001707490628898423, 'f1-score': 0.003398745101525287, 'support': 671746}, 'accuracy': 0.3281798291823837, 'macro avg': {'precision': 0.3311294151104187, 'recall': 0.33338534175292406, 'f1-score': 0.1659620385920212, 'support': 1969469}, 'weighted avg': {'precision': 0.33140752089895875, 'recall': 0.3281798291823837, 'f1-score': 0.16340493693742195, 'support': 1969469}}
[[645004    219    971]
 [650249    189   1091]
 [670393    206   1147]]
Evaluating performance on  val set...
2338/2338 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976686
{'0': {'precision': 0.3446826982381808, 'recall': 0.9983446441227585, 'f1-score': 0.5124424720988121, 'support': 205998}, '1': {'precision': 0.4367816091954023, 'recall': 0.0004109085404096109, 'f1-score': 0.0008210446713120509, 'support': 184956}, '2': {'precision': 0.37302423603793466, 'recall': 0.0017115919255409162, 'f1-score': 0.003407548586444887, 'support': 206825}, 'accuracy': 0.3447544995725845, 'macro avg': {'precision': 0.3848295144905059, 'recall': 0.3334890481962363, 'f1-score': 0.1722236884521897, 'support': 597779}, 'weighted avg': {'precision': 0.382984453118225, 'recall': 0.3447544995725845, 'f1-score': 0.17802356346079362, 'support': 597779}}
[[205657     46    295]
 [184580     76    300]
 [206419     52    354]]
testing model out of sample: results/universal/W8/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 89s - 89s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972472
{'0': {'precision': 0.3472713801780714, 'recall': 0.9982286873011853, 'f1-score': 0.5152824029535344, 'support': 1255566}, '1': {'precision': 0.359375, 'recall': 0.0002912788225822501, 'f1-score': 0.0005820858558560187, 'support': 1105470}, '2': {'precision': 0.3455917777420909, 'recall': 0.0017144664480031485, 'f1-score': 0.0034120060756539414, 'support': 1255201}, 'accuracy': 0.3472714869075229, 'macro avg': {'precision': 0.3507460526400541, 'recall': 0.3334114775239236, 'f1-score': 0.17309216496168148, 'support': 3616237}, 'weighted avg': {'precision': 0.3503884186761848, 'recall': 0.3472714869075229, 'f1-score': 0.18026951702446425, 'support': 3616237}}
[[1253342     300    1924]
 [1102997     322    2151]
 [1252775     274    2152]]
Evaluating performance on  train set...
4550/4550 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993066
{'0': {'precision': 0.3368822746050698, 'recall': 0.9980719155111337, 'f1-score': 0.5037367418391515, 'support': 392099}, '1': {'precision': 0.3834808259587021, 'recall': 0.00034190371991247264, 'f1-score': 0.0006831983140767756, 'support': 380224}, '2': {'precision': 0.352309846010266, 'recall': 0.0019269052115767444, 'f1-score': 0.003832847247076502, 'support': 391820}, 'accuracy': 0.3369242438428956, 'macro avg': {'precision': 0.3575576488580126, 'recall': 0.333446908147541, 'f1-score': 0.16941759580010163, 'support': 1164143}, 'weighted avg': {'precision': 0.3572944736372054, 'recall': 0.3369242438428956, 'f1-score': 0.17117847836778688, 'support': 1164143}}
[[391343    113    643]
 [379349    130    745]
 [390969     96    755]]
Evaluating performance on  val set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961894
{'0': {'precision': 0.3552156161138625, 'recall': 0.9982164424346263, 'f1-score': 0.5239746855038757, 'support': 142412}, '1': {'precision': 0.31451612903225806, 'recall': 0.0003288669269493798, 'f1-score': 0.0006570468272219555, 'support': 118589}, '2': {'precision': 0.33712660028449504, 'recall': 0.001692518639129317, 'f1-score': 0.0033681278467430774, 'support': 140028}, 'accuracy': 0.3551713217747345, 'macro avg': {'precision': 0.3356194484768718, 'recall': 0.3334126093335683, 'f1-score': 0.17599995339261362, 'support': 401029}, 'weighted avg': {'precision': 0.3368641248699, 'recall': 0.3551713217747345, 'f1-score': 0.18744238856615136, 'support': 401029}}
[[142158     42    212]
 [118296     39    254]
 [139748     43    237]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
645/645 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949292
{'0': {'precision': 0.36731879215019136, 'recall': 0.9982992073976222, 'f1-score': 0.5370375305351988, 'support': 60560}, '1': {'precision': 0.34545454545454546, 'recall': 0.00040342272331571013, 'f1-score': 0.0008059043094672549, 'support': 47097}, '2': {'precision': 0.38686131386861317, 'recall': 0.001851140372323705, 'f1-score': 0.0036846496106785315, 'support': 57262}, 'accuracy': 0.3673439688574391, 'macro avg': {'precision': 0.36654488382445, 'recall': 0.3335179234977539, 'f1-score': 0.18050936148511484, 'support': 164919}, 'weighted avg': {'precision': 0.36786029101942674, 'recall': 0.3673439688574391, 'f1-score': 0.19871536287802674, 'support': 164919}}
[[60457    12    91]
 [47001    19    77]
 [57132    24   106]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009248
{'0': {'precision': 0.32232682309962063, 'recall': 0.9959839357429718, 'f1-score': 0.4870359066903745, 'support': 18426}, '1': {'precision': 0.3090909090909091, 'recall': 0.0008854166666666666, 'f1-score': 0.0017657751233445857, 'support': 19200}, '2': {'precision': 0.3558282208588957, 'recall': 0.00297009422367882, 'f1-score': 0.005891016200294551, 'support': 19528}, 'accuracy': 0.3224096301221262, 'macro avg': {'precision': 0.32908198434980845, 'recall': 0.3332798155444391, 'f1-score': 0.1648975660046712, 'support': 57154}, 'weighted avg': {'precision': 0.3293269586365185, 'recall': 0.3224096301221262, 'f1-score': 0.15962253321560013, 'support': 57154}}
[[18352    24    50]
 [19128    17    55]
 [19456    14    58]]
Evaluating performance on  val set...
68/68 - 1s - 619ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0914965
{'0': {'precision': 0.40472725155731504, 'recall': 0.9972744226079472, 'f1-score': 0.5757826735133345, 'support': 6971}, '1': {'precision': 0.4666666666666667, 'recall': 0.0015008576329331046, 'f1-score': 0.002992092327420389, 'support': 4664}, '2': {'precision': 0.32558139534883723, 'recall': 0.0025, 'f1-score': 0.004961899698741804, 'support': 5600}, 'accuracy': 0.404583695967508, 'macro avg': {'precision': 0.39899177119093965, 'recall': 0.33375842674696005, 'f1-score': 0.19457888851316554, 'support': 17235}, 'weighted avg': {'precision': 0.3957727193439435, 'recall': 0.404583695967508, 'f1-score': 0.2353073846237016, 'support': 17235}}
[[6952    3   16]
 [4644    7   13]
 [5581    5   14]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
2179/2179 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.092862
{'0': {'precision': 0.3823846543674455, 'recall': 0.9979832185018597, 'f1-score': 0.5529156039804123, 'support': 213211}, '1': {'precision': 0.4205607476635514, 'recall': 0.0008715412723211403, 'f1-score': 0.0017394777701183488, 'support': 154898}, '2': {'precision': 0.3755020080321285, 'recall': 0.0019718874231543873, 'f1-score': 0.003923172944792355, 'support': 189666}, 'accuracy': 0.3823943346331406, 'macro avg': {'precision': 0.39281580335437516, 'recall': 0.33360888239911174, 'f1-score': 0.1861927515651077, 'support': 557775}, 'weighted avg': {'precision': 0.39064604381578216, 'recall': 0.3823943346331406, 'f1-score': 0.21317058489113078, 'support': 557775}}
[[212781     98    332]
 [154473    135    290]
 [189204     88    374]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995139
{'0': {'precision': 0.3365206741257671, 'recall': 0.9981835726854743, 'f1-score': 0.5033465797144315, 'support': 52851}, '1': {'precision': 0.3235294117647059, 'recall': 0.0004190077135510904, 'f1-score': 0.0008369315047648033, 'support': 52505}, '2': {'precision': 0.352, 'recall': 0.0017012063099288586, 'f1-score': 0.0033860479433606523, 'support': 51728}, 'accuracy': 0.33653968577321686, 'macro avg': {'precision': 0.3373500286301576, 'recall': 0.3334345955696514, 'f1-score': 0.16918985305418566, 'support': 157084}, 'weighted avg': {'precision': 0.33727573726749255, 'recall': 0.33653968577321686, 'f1-score': 0.17074601271395723, 'support': 157084}}
[[52755    21    75]
 [52396    22    87]
 [51615    25    88]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097547
{'0': {'precision': 0.35142503097893435, 'recall': 0.9972455019633124, 'f1-score': 0.5197074049753371, 'support': 17063}, '1': {'precision': 0.2558139534883721, 'recall': 0.0007089456045372519, 'f1-score': 0.0014139726203483513, 'support': 15516}, '2': {'precision': 0.32989690721649484, 'recall': 0.002002377823665603, 'f1-score': 0.003980594601318572, 'support': 15981}, 'accuracy': 0.3512973640856672, 'macro avg': {'precision': 0.3123786305612671, 'recall': 0.33331894179717175, 'f1-score': 0.1750339907323347, 'support': 48560}, 'weighted avg': {'precision': 0.31379030230943045, 'recall': 0.3512973640856672, 'f1-score': 0.18437645248342613, 'support': 48560}}
[[17016    16    31]
 [15471    11    34]
 [15933    16    32]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
1162/1162 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1152453
{'0': {'precision': 0.24525777226521422, 'recall': 0.9987784122103877, 'f1-score': 0.3938119669221111, 'support': 72856}, '1': {'precision': 0.8085106382978723, 'recall': 0.0005181559103862989, 'f1-score': 0.001035648097677968, 'support': 146674}, '2': {'precision': 0.16766467065868262, 'recall': 0.0014372241043014065, 'f1-score': 0.0028500178126113287, 'support': 77928}, 'accuracy': 0.24526151591149004, 'macro avg': {'precision': 0.4071443604072564, 'recall': 0.3335779307416918, 'f1-score': 0.13256587761080016, 'support': 297458}, 'weighted avg': {'precision': 0.502665122716304, 'recall': 0.24526151591149004, 'f1-score': 0.0977131679069224, 'support': 297458}}
[[ 72767      6     83]
 [146125     76    473]
 [ 77804     12    112]]
Evaluating performance on  train set...
327/327 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974631
{'0': {'precision': 0.35683901503804444, 'recall': 0.9988260942478618, 'f1-score': 0.5258232541714488, 'support': 29815}, '1': {'precision': 0.3333333333333333, 'recall': 7.37300007373e-05, 'f1-score': 0.00014742739200943535, 'support': 27126}, '2': {'precision': 0.33884297520661155, 'recall': 0.0015389812694718667, 'f1-score': 0.0030640460354233612, 'support': 26641}, 'accuracy': 0.35681127515493766, 'macro avg': {'precision': 0.34300510785932975, 'recall': 0.33347960183935704, 'f1-score': 0.1763449091996272, 'support': 83582}, 'weighted avg': {'precision': 0.34347432384770205, 'recall': 0.35681127515493766, 'f1-score': 0.1885938203080461, 'support': 83582}}
[[29780     4    31]
 [27075     2    49]
 [26600     0    41]]
Evaluating performance on  val set...
125/125 - 1s - 937ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057777
{'0': {'precision': 0.30480811645346273, 'recall': 0.9982457950675885, 'f1-score': 0.4670158584566366, 'support': 9691}, '1': {'precision': 0.5, 'recall': 7.868439688409789e-05, 'f1-score': 0.00015734403272755883, 'support': 12709}, '2': {'precision': 0.34615384615384615, 'recall': 0.0019165247018739352, 'f1-score': 0.0038119440914866584, 'support': 9392}, 'accuracy': 0.30488802214393557, 'macro avg': {'precision': 0.3836539875357696, 'recall': 0.33341366805544886, 'f1-score': 0.15699504886028362, 'support': 31792}, 'weighted avg': {'precision': 0.395051345609821, 'recall': 0.30488802214393557, 'f1-score': 0.14354718635261837, 'support': 31792}}
[[ 9674     1    16]
 [12690     1    18]
 [ 9374     0    18]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1223/1223 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031386
{'0': {'precision': 0.3137670012823916, 'recall': 0.9988190980352235, 'f1-score': 0.4775252052067643, 'support': 98230}, '1': {'precision': 0.6666666666666666, 'recall': 1.796622349982034e-05, 'f1-score': 3.593147867017598e-05, 'support': 111320}, '2': {'precision': 0.3201219512195122, 'recall': 0.0010147084404414466, 'f1-score': 0.002023004450609792, 'support': 103478}, 'accuracy': 0.3137770423093142, 'macro avg': {'precision': 0.43351853972285675, 'recall': 0.3332839242330549, 'f1-score': 0.15986138037868142, 'support': 313028}, 'weighted avg': {'precision': 0.4413670506714905, 'recall': 0.3137770423093142, 'f1-score': 0.1505317008517009, 'support': 313028}}
[[ 98114      1    115]
 [111210      2    108]
 [103373      0    105]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004716
{'0': {'precision': 0.3263419602860804, 'recall': 0.998927182513075, 'f1-score': 0.49196324640265493, 'support': 29828}, '1': {'precision': 1.0, 'recall': 3.3053480531499964e-05, 'f1-score': 6.610477607007106e-05, 'support': 30254}, '2': {'precision': 0.36283185840707965, 'recall': 0.0013084410403701931, 'f1-score': 0.002607479012973798, 'support': 31335}, 'accuracy': 0.32639443429559056, 'macro avg': {'precision': 0.5630579395643868, 'recall': 0.3334228923446589, 'f1-score': 0.16487894339723294, 'support': 91417}, 'weighted avg': {'precision': 0.5617933674764982, 'recall': 0.32639443429559056, 'f1-score': 0.16143589269463174, 'support': 91417}}
[[29796     0    32]
 [30213     1    40]
 [31294     0    41]]
Evaluating performance on  val set...
99/99 - 1s - 771ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102624
{'0': {'precision': 0.32138609150741415, 'recall': 0.9983988175883729, 'f1-score': 0.4862481629225278, 'support': 8119}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9383}, '2': {'precision': 0.22857142857142856, 'recall': 0.0010315925209542231, 'f1-score': 0.0020539152759948653, 'support': 7755}, 'accuracy': 0.32125747317575326, 'macro avg': {'precision': 0.18331917335961423, 'recall': 0.33314347003644235, 'f1-score': 0.16276735939950757, 'support': 25257}, 'weighted avg': {'precision': 0.17349269927228583, 'recall': 0.32125747317575326, 'f1-score': 0.1569377577595654, 'support': 25257}}
[[8106    0   13]
 [9369    0   14]
 [7747    0    8]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980293
{'0': {'precision': 0.3378992460682418, 'recall': 0.9984528189958555, 'f1-score': 0.504921515210482, 'support': 124743}, '1': {'precision': 0.38461538461538464, 'recall': 4.539965314664996e-05, 'f1-score': 9.078858969004775e-05, 'support': 110133}, '2': {'precision': 0.38028169014084506, 'recall': 0.0016082676872217175, 'f1-score': 0.0032029894568263713, 'support': 134306}, 'accuracy': 0.33796609802211375, 'macro avg': {'precision': 0.3675987736081572, 'recall': 0.3333688287787413, 'f1-score': 0.1694050977523328, 'support': 369182}, 'weighted avg': {'precision': 0.3672538869235043, 'recall': 0.33796609802211375, 'f1-score': 0.17180036971910337, 'support': 369182}}
[[124550      2    191]
 [109967      5    161]
 [134084      6    216]]
Evaluating performance on  train set...
494/494 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100824
{'0': {'precision': 0.3201418304697539, 'recall': 0.9985649602889873, 'f1-score': 0.48484229621042385, 'support': 40417}, '1': {'precision': 0.6756756756756757, 'recall': 0.0006055761451444904, 'f1-score': 0.0012100677637947724, 'support': 41283}, '2': {'precision': 0.27956989247311825, 'recall': 0.0011662069120186593, 'f1-score': 0.002322724734785036, 'support': 44589}, 'accuracy': 0.3201862394982936, 'macro avg': {'precision': 0.42512913287284926, 'recall': 0.3334455811153835, 'f1-score': 0.16279169623633455, 'support': 126289}, 'weighted avg': {'precision': 0.4220386036511401, 'recall': 0.3201862394982936, 'f1-score': 0.15638253756565315, 'support': 126289}}
[[40359     5    53]
 [41177    25    81]
 [44530     7    52]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988263
{'0': {'precision': 0.3303409717300575, 'recall': 0.998730259503214, 'f1-score': 0.49646928872933843, 'support': 12601}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11703}, '2': {'precision': 0.3877551020408163, 'recall': 0.0013724357122219012, 'f1-score': 0.0027351903836464408, 'support': 13844}, 'accuracy': 0.33039739960155184, 'macro avg': {'precision': 0.2393653579236246, 'recall': 0.333367565071812, 'f1-score': 0.16640149303766164, 'support': 38148}, 'weighted avg': {'precision': 0.24983506913661305, 'recall': 0.33039739960155184, 'f1-score': 0.1649857261966445, 'support': 38148}}
[[12585     1    15]
 [11688     0    15]
 [13824     1    19]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
5521/5521 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023536
{'0': {'precision': 0.31855782981448844, 'recall': 0.9971328363583021, 'f1-score': 0.482855857465435, 'support': 449922}, '1': {'precision': 0.4778481012658228, 'recall': 0.000878366587167704, 'f1-score': 0.0017535099230081405, 'support': 515730}, '2': {'precision': 0.33680297397769515, 'recall': 0.0030358335585822056, 'f1-score': 0.006017427959122227, 'support': 447653}, 'accuracy': 0.3187167667276349, 'macro avg': {'precision': 0.3777363016860021, 'recall': 0.3336823455013507, 'f1-score': 0.16354226511585515, 'support': 1413305}, 'weighted avg': {'precision': 0.382463543878819, 'recall': 0.3187167667276349, 'f1-score': 0.1562617626438323, 'support': 1413305}}
[[448632    272   1018]
 [513619    453   1658]
 [446071    223   1359]]
Evaluating performance on  train set...
1288/1288 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998778
{'0': {'precision': 0.32809122006841507, 'recall': 0.9977899019789163, 'f1-score': 0.4938091369861447, 'support': 108140}, '1': {'precision': 0.4657534246575342, 'recall': 0.0006225566938577458, 'f1-score': 0.0012434513088239328, 'support': 109227}, '2': {'precision': 0.4200848656294201, 'recall': 0.002643265901869866, 'f1-score': 0.005253475784483673, 'support': 112361}, 'accuracy': 0.3283494274068323, 'macro avg': {'precision': 0.40464317011845646, 'recall': 0.33368524152488127, 'f1-score': 0.16676868802648412, 'support': 329728}, 'weighted avg': {'precision': 0.40504230590139195, 'recall': 0.3283494274068323, 'f1-score': 0.16415537753060394, 'support': 329728}}
[[107901     54    185]
 [108934     68    225]
 [112040     24    297]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0897863
{'0': {'precision': 0.3896429466747842, 'recall': 0.9978676082819343, 'f1-score': 0.5604455748366118, 'support': 43613}, '1': {'precision': 0.28, 'recall': 0.0002651113467656416, 'f1-score': 0.0005297211396571947, 'support': 26404}, '2': {'precision': 0.36681222707423583, 'recall': 0.0020033866774785947, 'f1-score': 0.003985008776507424, 'support': 41929}, 'accuracy': 0.38957175781180214, 'macro avg': {'precision': 0.34548505791634, 'recall': 0.33337870210205955, 'f1-score': 0.18832010158425883, 'support': 111946}, 'weighted avg': {'precision': 0.35523098370931516, 'recall': 0.38957175781180214, 'f1-score': 0.21996129424285674, 'support': 111946}}
[[43520    11    82]
 [26334     7    63]
 [41838     7    84]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
5918/5918 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0904036
{'0': {'precision': 0.38908027729269196, 'recall': 0.9979978825062439, 'f1-score': 0.5598837961940588, 'support': 589376}, '1': {'precision': 0.2972972972972973, 'recall': 0.0004155277877462474, 'f1-score': 0.0008298956433173192, 'support': 370613}, '2': {'precision': 0.37137614678899084, 'recall': 0.0018233774283171235, 'f1-score': 0.003628937549642395, 'support': 555014}, 'accuracy': 0.38901705145138327, 'macro avg': {'precision': 0.35258457379299335, 'recall': 0.33341226257410245, 'f1-score': 0.18811420979567287, 'support': 1515003}, 'weighted avg': {'precision': 0.3601417168724061, 'recall': 0.38901705145138327, 'f1-score': 0.21934197722704415, 'support': 1515003}}
[[588196    205    975]
 [369721    154    738]
 [553843    159   1012]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999256
{'0': {'precision': 0.3321798262183604, 'recall': 0.998041199667912, 'f1-score': 0.49845724253767, 'support': 154176}, '1': {'precision': 0.29457364341085274, 'recall': 0.0002471528640464127, 'f1-score': 0.0004938913439043411, 'support': 153751}, '2': {'precision': 0.37486457204767065, 'recall': 0.0022129836904381194, 'f1-score': 0.0043999923699554275, 'support': 156350}, 'accuracy': 0.33225423615643246, 'macro avg': {'precision': 0.3338726805589613, 'recall': 0.33350044540746554, 'f1-score': 0.16778370875050994, 'support': 464277}, 'weighted avg': {'precision': 0.334100601526152, 'recall': 0.33225423615643246, 'f1-score': 0.16717179382253905, 'support': 464277}}
[[153874     44    258]
 [153394     38    319]
 [155957     47    346]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0934843
{'0': {'precision': 0.37122163919887663, 'recall': 0.998178385718544, 'f1-score': 0.5411792169080346, 'support': 60386}, '1': {'precision': 0.3469387755102041, 'recall': 0.00038368655065790957, 'f1-score': 0.000766525385517179, 'support': 44307}, '2': {'precision': 0.39, 'recall': 0.002016268008547598, 'f1-score': 0.00401179536414758, 'support': 58028}, 'accuracy': 0.3712489475851304, 'macro avg': {'precision': 0.3693868049030269, 'recall': 0.3335261134259165, 'f1-score': 0.18198584588589975, 'support': 162721}, 'weighted avg': {'precision': 0.37130626182972065, 'recall': 0.3712489475851304, 'f1-score': 0.20247175898535189, 'support': 162721}}
[[60276    16    94]
 [44201    17    89]
 [57895    16   117]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
3755/3755 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009365
{'0': {'precision': 0.33539126601420055, 'recall': 0.9983682181003701, 'f1-score': 0.5021054914399564, 'support': 322347}, '1': {'precision': 0.4155844155844156, 'recall': 0.0001859394883177706, 'f1-score': 0.0003717126661090977, 'support': 344198}, '2': {'precision': 0.32013651877133104, 'recall': 0.0015919188902051165, 'f1-score': 0.003168084085950324, 'support': 294613}, 'accuracy': 0.3353808635000697, 'macro avg': {'precision': 0.3570374001233157, 'recall': 0.3333820254929643, 'f1-score': 0.16854842939733863, 'support': 961158}, 'weighted avg': {'precision': 0.35943317675760106, 'recall': 0.3353808635000697, 'f1-score': 0.16949710699204415, 'support': 961158}}
[[321821     59    467]
 [343605     64    529]
 [294113     31    469]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998048
{'0': {'precision': 0.332905816948044, 'recall': 0.997993321283049, 'f1-score': 0.4992681599779299, 'support': 130564}, '1': {'precision': 0.31313131313131315, 'recall': 0.00024100881625798828, 'f1-score': 0.00048164692173237523, 'support': 128626}, '2': {'precision': 0.34575260804769004, 'recall': 0.0017445183024032244, 'f1-score': 0.0034715208104205476, 'support': 132988}, 'accuracy': 0.3329228054607857, 'macro avg': {'precision': 0.3305965793756824, 'recall': 0.33332628280057003, 'f1-score': 0.1677404425700276, 'support': 392178}, 'weighted avg': {'precision': 0.3307765637182068, 'recall': 0.3329228054607857, 'f1-score': 0.16755164992898477, 'support': 392178}}
[[130302     38    224]
 [128380     31    215]
 [132726     30    232]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011465
{'0': {'precision': 0.3195686833934715, 'recall': 0.9984531487598972, 'f1-score': 0.4841715825874694, 'support': 38142}, '1': {'precision': 0.5714285714285714, 'recall': 0.0003954522985664854, 'f1-score': 0.0007903576368306659, 'support': 40460}, '2': {'precision': 0.3567567567567568, 'recall': 0.0016184007258282043, 'f1-score': 0.0032221842503539523, 'support': 40781}, 'accuracy': 0.3196853823408693, 'macro avg': {'precision': 0.4159180038595999, 'recall': 0.333489000594764, 'f1-score': 0.16272804149155135, 'support': 119383}, 'weighted avg': {'precision': 0.41762969618196133, 'recall': 0.3196853823408693, 'f1-score': 0.1560578496850566, 'support': 119383}}
[[38083     2    57]
 [40382    16    62]
 [40705    10    66]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
4960/4960 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012836
{'0': {'precision': 0.32143426395418384, 'recall': 0.9983604186936776, 'f1-score': 0.48629874110413485, 'support': 408031}, '1': {'precision': 0.3867403314917127, 'recall': 0.00016243070590064347, 'f1-score': 0.00032472502748565415, 'support': 430953}, '2': {'precision': 0.3593173431734317, 'recall': 0.0018087213338565235, 'f1-score': 0.003599324491347067, 'support': 430691}, 'accuracy': 0.32150825998779214, 'macro avg': {'precision': 0.3558306462064427, 'recall': 0.3334438569111449, 'f1-score': 0.16340759687432252, 'support': 1269675}, 'weighted avg': {'precision': 0.3564508997038976, 'recall': 0.32150825998779214, 'f1-score': 0.1576112780993042, 'support': 1269675}}
[[407362     51    618]
 [430112     70    771]
 [429852     60    779]]
Evaluating performance on  train set...
1691/1691 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983536
{'0': {'precision': 0.34483173716875826, 'recall': 0.997943255284226, 'f1-score': 0.5125542376788854, 'support': 149265}, '1': {'precision': 0.37, 'recall': 0.0002664477474363406, 'f1-score': 0.0005325120175009354, 'support': 138864}, '2': {'precision': 0.31640625, 'recall': 0.0016791973022278733, 'f1-score': 0.0033406653835578773, 'support': 144712}, 'accuracy': 0.3447871158231314, 'macro avg': {'precision': 0.3437459957229194, 'recall': 0.33329630011129674, 'f1-score': 0.17214247169331476, 'support': 432841}, 'weighted avg': {'precision': 0.34340270560897584, 'recall': 0.3447871158231314, 'f1-score': 0.17804179688366517, 'support': 432841}}
[[148958     34    273]
 [138575     37    252]
 [144440     29    243]]
Evaluating performance on  val set...
591/591 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969036
{'0': {'precision': 0.3491151322330483, 'recall': 0.9982563538843507, 'f1-score': 0.5173130091880981, 'support': 52763}, '1': {'precision': 0.2631578947368421, 'recall': 0.00022120957395036056, 'f1-score': 0.00044204756431792056, 'support': 45206}, '2': {'precision': 0.3244444444444444, 'recall': 0.0013731096230531939, 'f1-score': 0.0027346457135364963, 'support': 53164}, 'accuracy': 0.34905679103835696, 'macro avg': {'precision': 0.3122391571381116, 'recall': 0.33328355769378476, 'f1-score': 0.17349656748865083, 'support': 151133}, 'weighted avg': {'precision': 0.3147257181153716, 'recall': 0.34905679103835696, 'f1-score': 0.18169661298788903, 'support': 151133}}
[[52671    14    78]
 [45122    10    74]
 [53077    14    73]]
testing model on single stock: results/universal/W8/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
10609/10609 - 70s - 70s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0933905
{'0': {'precision': 0.36980317884565317, 'recall': 0.9987133076061248, 'f1-score': 0.5397484934445698, 'support': 1004125}, '1': {'precision': 0.24130879345603273, 'recall': 0.00016520826041302065, 'f1-score': 0.0003301904611333648, 'support': 714250}, '2': {'precision': 0.4167158889545186, 'recall': 0.0014148171767428522, 'f1-score': 0.002820059798858385, 'support': 997302}, 'accuracy': 0.3698385338167978, 'macro avg': {'precision': 0.34260928708540145, 'recall': 0.33343111101442685, 'f1-score': 0.1809662479015205, 'support': 2715677}, 'weighted avg': {'precision': 0.3532360483851659, 'recall': 0.3698385338167978, 'f1-score': 0.20069516580742636, 'support': 2715677}}
[[1002833     180    1112]
 [ 713269     118     863]
 [ 995700     191    1411]]
Evaluating performance on  train set...
3903/3903 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10061
{'0': {'precision': 0.3251509013977179, 'recall': 0.9983836754297114, 'f1-score': 0.49054306202544185, 'support': 324811}, '1': {'precision': 0.29874213836477986, 'recall': 0.0002870810505353306, 'f1-score': 0.0005736108804927015, 'support': 330917}, '2': {'precision': 0.37393162393162394, 'recall': 0.0015291232444208846, 'f1-score': 0.0030457912965788513, 'support': 343334}, 'accuracy': 0.3252110479629893, 'macro avg': {'precision': 0.3326082212313739, 'recall': 0.3333999599082225, 'f1-score': 0.1647208214008378, 'support': 999062}, 'weighted avg': {'precision': 0.3331673928205579, 'recall': 0.3252110479629893, 'f1-score': 0.16072007925464624, 'support': 999062}}
[[324286    107    418]
 [330361     95    461]
 [342693    116    525]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988177
{'0': {'precision': 0.3386241393595568, 'recall': 0.9984252127477009, 'f1-score': 0.5057268497213274, 'support': 99061}, '1': {'precision': 0.38372093023255816, 'recall': 0.0003541038490015345, 'f1-score': 0.0007075547550895701, 'support': 93193}, '2': {'precision': 0.3803418803418803, 'recall': 0.0017732792715607847, 'f1-score': 0.00353010005255486, 'support': 100379}, 'accuracy': 0.3387041106095348, 'macro avg': {'precision': 0.3675623166446651, 'recall': 0.33351753195608774, 'f1-score': 0.16998816817632392, 'support': 292633}, 'weighted avg': {'precision': 0.367295855652293, 'recall': 0.3387041106095348, 'f1-score': 0.17263293792467319, 'support': 292633}}
[[ 98905     23    133]
 [ 93003     33    157]
 [100171     30    178]]
training model: results/universal/W8/deepLOB_L2/h300
Epoch 1/50
7696/7696 - 317s - loss: 3.2401 - accuracy300: 0.3982 - val_loss: 3.4913 - val_accuracy300: 0.3311 - 317s/epoch - 41ms/step
Epoch 2/50
7696/7696 - 310s - loss: 3.2116 - accuracy300: 0.4165 - val_loss: 3.5876 - val_accuracy300: 0.3320 - 310s/epoch - 40ms/step
Epoch 3/50
7696/7696 - 311s - loss: 3.1970 - accuracy300: 0.4240 - val_loss: 3.5561 - val_accuracy300: 0.3352 - 311s/epoch - 40ms/step
Epoch 4/50
7696/7696 - 314s - loss: 3.1843 - accuracy300: 0.4305 - val_loss: 3.5921 - val_accuracy300: 0.3374 - 314s/epoch - 41ms/step
Epoch 5/50
7696/7696 - 310s - loss: 3.1747 - accuracy300: 0.4339 - val_loss: 3.6135 - val_accuracy300: 0.3387 - 310s/epoch - 40ms/step
Epoch 6/50
7696/7696 - 310s - loss: 3.1670 - accuracy300: 0.4375 - val_loss: 3.6103 - val_accuracy300: 0.3392 - 310s/epoch - 40ms/step
Epoch 7/50
7696/7696 - 311s - loss: 3.1617 - accuracy300: 0.4393 - val_loss: 3.6474 - val_accuracy300: 0.3387 - 311s/epoch - 40ms/step
Epoch 8/50
7696/7696 - 309s - loss: 3.1572 - accuracy300: 0.4413 - val_loss: 3.6751 - val_accuracy300: 0.3402 - 309s/epoch - 40ms/step
Epoch 9/50
7696/7696 - 312s - loss: 3.1532 - accuracy300: 0.4431 - val_loss: 3.7266 - val_accuracy300: 0.3394 - 312s/epoch - 40ms/step
Epoch 10/50
7696/7696 - 310s - loss: 3.1488 - accuracy300: 0.4447 - val_loss: 3.7348 - val_accuracy300: 0.3388 - 310s/epoch - 40ms/step
Epoch 11/50
7696/7696 - 317s - loss: 3.1453 - accuracy300: 0.4456 - val_loss: 3.7096 - val_accuracy300: 0.3390 - 317s/epoch - 41ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 314s - 314s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2090968
{'0': {'precision': 0.33891082501459835, 'recall': 0.07016132513995424, 'f1-score': 0.11625544578537347, 'support': 2084610}, '1': {'precision': 0.3074585944443282, 'recall': 0.9198047355281084, 'f1-score': 0.4608658374157741, 'support': 1837303}, '2': {'precision': 0.3505643958986217, 'recall': 0.00565065679935068, 'f1-score': 0.011122040308467213, 'support': 2039055}, 'accuracy': 0.30997331305922127, 'macro avg': {'precision': 0.3323112717858494, 'recall': 0.33187223915580444, 'f1-score': 0.19608110783653823, 'support': 5960968}, 'weighted avg': {'precision': 0.33320285852249054, 'recall': 0.30997331305922127, 'f1-score': 0.1865092888304958, 'support': 5960968}}
[[ 146259 1927332   11019]
 [ 137017 1689960   10326]
 [ 148280 1879253   11522]]
Evaluating performance on  train set...
7696/7696 - 110s - 110s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1672946
{'0': {'precision': 0.33042542185686924, 'recall': 0.1802855277289592, 'f1-score': 0.2332862516569888, 'support': 655488}, '1': {'precision': 0.32984734453255754, 'recall': 0.8035876392364689, 'f1-score': 0.4677131951934718, 'support': 652128}, '2': {'precision': 0.3281804797782974, 'recall': 0.011450992953235106, 'f1-score': 0.02212982401840697, 'support': 661864}, 'accuracy': 0.32993277413327377, 'macro avg': {'precision': 0.3294844153892414, 'recall': 0.33177471997288777, 'f1-score': 0.24104309028962254, 'support': 1969480}, 'weighted avg': {'precision': 0.3294795748550004, 'recall': 0.32993277413327377, 'f1-score': 0.23994767295193836, 'support': 1969480}}
[[118175 529751   7562]
 [120133 524042   7953]
 [119337 534948   7579]]
Evaluating performance on  val set...
2338/2338 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1655445
{'0': {'precision': 0.337435475424553, 'recall': 0.17887186401693345, 'f1-score': 0.23380536306116298, 'support': 201731}, '1': {'precision': 0.3294428426261742, 'recall': 0.8116661069215034, 'f1-score': 0.4686626805153595, 'support': 196518}, '2': {'precision': 0.32868705035971224, 'recall': 0.010990773363537496, 'f1-score': 0.02127030159600006, 'support': 199531}, 'accuracy': 0.3308641975308642, 'macro avg': {'precision': 0.3318551228034798, 'recall': 0.3338429147673248, 'f1-score': 0.2412461150575075, 'support': 597780}, 'weighted avg': {'precision': 0.3318878187383398, 'recall': 0.3308641975308642, 'f1-score': 0.2400724796630205, 'support': 597780}}
[[ 36084 163367   2280]
 [ 34812 159507   2199]
 [ 36040 161298   2193]]
testing model out of sample: results/universal/W8/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 194s - 194s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2017014
{'0': {'precision': 0.3274091965067227, 'recall': 0.08269304448930506, 'f1-score': 0.132037626457156, 'support': 1203233}, '1': {'precision': 0.3315307111130795, 'recall': 0.9092693324636297, 'f1-score': 0.4858973207577033, 'support': 1201942}, '2': {'precision': 0.34902331442974166, 'recall': 0.004573577290483673, 'f1-score': 0.009028841271536003, 'support': 1211087}, 'accuracy': 0.3312611199077943, 'macro avg': {'precision': 0.33598774068318127, 'recall': 0.33217865141447284, 'f1-score': 0.2089879294954651, 'support': 3616262}, 'weighted avg': {'precision': 0.3360176432238104, 'recall': 0.3312611199077943, 'f1-score': 0.20845479093884772, 'support': 3616262}}
[[  99499 1098768    4966]
 [ 103688 1092889    5365]
 [ 100711 1104837    5539]]
Evaluating performance on  train set...
4550/4550 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1917516
{'0': {'precision': 0.3430032185479507, 'recall': 0.12198611733661534, 'f1-score': 0.17996813103264048, 'support': 394881}, '1': {'precision': 0.32516334724080925, 'recall': 0.8739338448233456, 'f1-score': 0.4739753476707084, 'support': 378111}, '2': {'precision': 0.34729096989966557, 'recall': 0.0066366873828801074, 'f1-score': 0.013024478594399876, 'support': 391159}, 'accuracy': 0.3274575205450152, 'macro avg': {'precision': 0.33848584522947517, 'recall': 0.33418554984761367, 'f1-score': 0.22232265243258295, 'support': 1164151}, 'weighted avg': {'precision': 0.3386496088797641, 'recall': 0.3274575205450152, 'f1-score': 0.21936667172551175, 'support': 1164151}}
[[ 48170 344208   2503]
 [ 45291 330444   2376]
 [ 46975 341588   2596]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.208462
{'0': {'precision': 0.3207126948775056, 'recall': 0.06157611861070357, 'f1-score': 0.10331582951403707, 'support': 135637}, '1': {'precision': 0.321958807122935, 'recall': 0.9211951934439312, 'f1-score': 0.47715231656471957, 'support': 130322}, '2': {'precision': 0.30222643297015633, 'recall': 0.004723336837585324, 'f1-score': 0.009301308452090243, 'support': 135074}, 'accuracy': 0.3217740185969733, 'macro avg': {'precision': 0.3149659783235323, 'recall': 0.32916488296407337, 'f1-score': 0.19658981817694895, 'support': 401033}, 'weighted avg': {'precision': 0.31489118517425313, 'recall': 0.3217740185969733, 'f1-score': 0.193134376235872, 'support': 401033}}
[[  8352 126626    659]
 [  9456 120052    814]
 [  8234 126202    638]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.224902
{'0': {'precision': 0.31800601633003867, 'recall': 0.05229497190911982, 'f1-score': 0.08981945076619632, 'support': 56602}, '1': {'precision': 0.30388157428352314, 'recall': 0.9297460367536872, 'f1-score': 0.4580518250479636, 'support': 50716}, '2': {'precision': 0.32662192393736017, 'recall': 0.0025344582161580392, 'f1-score': 0.0050298864830413586, 'support': 57606}, 'accuracy': 0.30474036525914966, 'macro avg': {'precision': 0.31616983818364064, 'recall': 0.3281918222929883, 'f1-score': 0.18430038743240043, 'support': 164924}, 'weighted avg': {'precision': 0.3166720247387377, 'recall': 0.30474036525914966, 'f1-score': 0.17343909044252412, 'support': 164924}}
[[ 2960 53499   143]
 [ 3405 47153   158]
 [ 2943 54517   146]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1986976
{'0': {'precision': 0.3544165757906216, 'recall': 0.1022977651872836, 'f1-score': 0.15876893014167073, 'support': 19062}, '1': {'precision': 0.3311470943131836, 'recall': 0.9040913921360255, 'f1-score': 0.4847440243867696, 'support': 18820}, '2': {'precision': 0.32222222222222224, 'recall': 0.004514321295143213, 'f1-score': 0.008903899293828677, 'support': 19272}, 'accuracy': 0.3333449977254435, 'macro avg': {'precision': 0.33592863077534246, 'recall': 0.3369678262061508, 'f1-score': 0.217472284607423, 'support': 57154}, 'weighted avg': {'precision': 0.3358985154033246, 'recall': 0.3333449977254435, 'f1-score': 0.21557427008626165, 'support': 57154}}
[[ 1950 17013    99]
 [ 1721 17015    84]
 [ 1831 17354    87]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.188778
{'0': {'precision': 0.3294979079497908, 'recall': 0.10220635950681375, 'f1-score': 0.15601783060921248, 'support': 6164}, '1': {'precision': 0.30314208550161387, 'recall': 0.8655256723716381, 'f1-score': 0.44901941652844174, 'support': 5317}, '2': {'precision': 0.3819444444444444, 'recall': 0.009555246699096595, 'f1-score': 0.01864406779661017, 'support': 5756}, 'accuracy': 0.3067239078725996, 'macro avg': {'precision': 0.33819481263194967, 'recall': 0.32576242619251616, 'f1-score': 0.20789377164475478, 'support': 17237}, 'weighted avg': {'precision': 0.3388816960861411, 'recall': 0.3067239078725996, 'f1-score': 0.20052476647874912, 'support': 17237}}
[[ 630 5495   39]
 [ 665 4602   50]
 [ 617 5084   55]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1874152
{'0': {'precision': 0.25, 'recall': 2.097249457336703e-05, 'f1-score': 4.194147067766931e-05, 'support': 190726}, '1': {'precision': 0.34456000817572063, 'recall': 0.9999583736588513, 'f1-score': 0.5125190849873656, 'support': 192186}, '2': {'precision': 0.3333333333333333, 'recall': 2.8592995859734198e-05, 'f1-score': 5.7181086783735404e-05, 'support': 174868}, 'accuracy': 0.34455699379683746, 'macro avg': {'precision': 0.309297780503018, 'recall': 0.33333597971642814, 'f1-score': 0.1708727358482757, 'support': 557780}, 'weighted avg': {'precision': 0.30870673574633795, 'recall': 0.34455699379683746, 'f1-score': 0.1766233843784324, 'support': 557780}}
[[     4 190715      7]
 [     5 192178      3]
 [     7 174856      5]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1763277
{'0': {'precision': 0.3564751033261169, 'recall': 0.13591850517784781, 'f1-score': 0.19680013038517954, 'support': 53304}, '1': {'precision': 0.33591040622031765, 'recall': 0.8674183366923983, 'f1-score': 0.4842813695881788, 'support': 52594}, '2': {'precision': 0.37473684210526315, 'recall': 0.006954619156459395, 'f1-score': 0.01365580467596233, 'support': 51189}, 'accuracy': 0.3388058846371756, 'macro avg': {'precision': 0.35570745055056596, 'recall': 0.3367638203422352, 'f1-score': 0.23157910154977354, 'support': 157087}, 'weighted avg': {'precision': 0.35554071962016615, 'recall': 0.3388058846371756, 'f1-score': 0.23337103317098248, 'support': 157087}}
[[ 7245 45742   317]
 [ 6696 45621   277]
 [ 6383 44450   356]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1681831
{'0': {'precision': 0.34562306900102985, 'recall': 0.10323612649194044, 'f1-score': 0.15898431948458006, 'support': 16254}, '1': {'precision': 0.3541292432407535, 'recall': 0.9016124303723249, 'f1-score': 0.5085239016485605, 'support': 17055}, '2': {'precision': 0.2826855123674912, 'recall': 0.005245557668349617, 'f1-score': 0.010299987125016095, 'support': 15251}, 'accuracy': 0.3528624382207578, 'macro avg': {'precision': 0.3274792748697582, 'recall': 0.33669803817753835, 'f1-score': 0.22593606941938557, 'support': 48560}, 'weighted avg': {'precision': 0.32884407652657327, 'recall': 0.3528624382207578, 'f1-score': 0.2350513050898308, 'support': 48560}}
[[ 1678 14463   113]
 [ 1588 15377    90]
 [ 1589 13582    80]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027396
{'0': {'precision': 0.28668748225943796, 'recall': 0.20488373862109185, 'f1-score': 0.2389790153946259, 'support': 78874}, '1': {'precision': 0.4614402794572081, 'recall': 0.8078444055687047, 'f1-score': 0.5873732704116809, 'support': 136046}, '2': {'precision': 0.26755738266529633, 'recall': 0.009461735095647118, 'f1-score': 0.01827712901640495, 'support': 82543}, 'accuracy': 0.4264227819930546, 'macro avg': {'precision': 0.3385617147939808, 'recall': 0.3407299597618146, 'f1-score': 0.28154313827423727, 'support': 297463}, 'weighted avg': {'precision': 0.3613030251564322, 'recall': 0.4264227819930546, 'f1-score': 0.3370760863269192, 'support': 297463}}
[[ 16160  61895    819]
 [ 24823 109904   1319]
 [ 15385  66377    781]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1879154
{'0': {'precision': 0.3561869466749022, 'recall': 0.12220534736693392, 'f1-score': 0.18197596444631445, 'support': 28313}, '1': {'precision': 0.3398097937161076, 'recall': 0.8812720848056537, 'f1-score': 0.4904910810863965, 'support': 28300}, '2': {'precision': 0.3270042194092827, 'recall': 0.00574733953798806, 'f1-score': 0.01129614109244616, 'support': 26969}, 'accuracy': 0.34164054461486926, 'macro avg': {'precision': 0.34100031993343083, 'recall': 0.3364082572368586, 'f1-score': 0.2279210622083857, 'support': 83582}, 'weighted avg': {'precision': 0.34122556264053616, 'recall': 0.34164054461486926, 'f1-score': 0.23136355561287958, 'support': 83582}}
[[ 3460 24674   179]
 [ 3220 24940   140]
 [ 3034 23780   155]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1533341
{'0': {'precision': 0.30133825565297645, 'recall': 0.13207928802588997, 'f1-score': 0.1836591196737449, 'support': 9888}, '1': {'precision': 0.3726820276497696, 'recall': 0.8431895904579197, 'f1-score': 0.5168993199365955, 'support': 11989}, '2': {'precision': 0.32432432432432434, 'recall': 0.010892586989409985, 'f1-score': 0.021077283372365342, 'support': 9915}, 'accuracy': 0.3624496728736789, 'macro avg': {'precision': 0.3327815358756901, 'recall': 0.3287204884910732, 'f1-score': 0.24054524099423527, 'support': 31792}, 'weighted avg': {'precision': 0.3354112096459925, 'recall': 0.3624496728736789, 'f1-score': 0.2586219359175527, 'support': 31792}}
[[ 1306  8484    98]
 [ 1753 10109   127]
 [ 1275  8532   108]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1917084
{'0': {'precision': 0.29977159546186394, 'recall': 0.07923986737269263, 'f1-score': 0.12534640134020134, 'support': 101035}, '1': {'precision': 0.3535592946976098, 'recall': 0.8992402218694823, 'f1-score': 0.5075588462535453, 'support': 112138}, '2': {'precision': 0.31569506726457397, 'recall': 0.0035249349088724213, 'f1-score': 0.0069720227779153255, 'support': 99860}, 'accuracy': 0.348835426296908, 'macro avg': {'precision': 0.3230086524746826, 'recall': 0.3273350080503491, 'f1-score': 0.21329242345722066, 'support': 313033}, 'weighted avg': {'precision': 0.32411970863560824, 'recall': 0.348835426296908, 'f1-score': 0.22450423359578683, 'support': 313033}}
[[  8006  92665    364]
 [ 10900 100839    399]
 [  7801  91707    352]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1916933
{'0': {'precision': 0.32054589331779976, 'recall': 0.12855855555184728, 'f1-score': 0.1835159599809433, 'support': 29963}, '1': {'precision': 0.32809839648293565, 'recall': 0.8531685719949779, 'f1-score': 0.47393730269436896, 'support': 30266}, '2': {'precision': 0.35428571428571426, 'recall': 0.007951266431548573, 'f1-score': 0.01555346503606146, 'support': 31190}, 'accuracy': 0.32730613986151674, 'macro avg': {'precision': 0.3343100013621499, 'recall': 0.3298927979927912, 'f1-score': 0.22433557590379125, 'support': 91419}, 'weighted avg': {'precision': 0.3345575219375096, 'recall': 0.32730613986151674, 'f1-score': 0.22236064370351385, 'support': 91419}}
[[ 3852 25885   226]
 [ 4218 25822   226]
 [ 3947 26995   248]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.16205
{'0': {'precision': 0.3328882106066387, 'recall': 0.20758981679752558, 'f1-score': 0.255715123094959, 'support': 8406}, '1': {'precision': 0.3529978206882571, 'recall': 0.7839054586381542, 'f1-score': 0.4867906066536204, 'support': 8885}, '2': {'precision': 0.2771929824561403, 'recall': 0.00991590310028869, 'f1-score': 0.019146873485215706, 'support': 7967}, 'accuracy': 0.3479689603294006, 'macro avg': {'precision': 0.321026337917012, 'recall': 0.33380372617865617, 'f1-score': 0.2538842010779317, 'support': 25258}, 'weighted avg': {'precision': 0.3223945057566964, 'recall': 0.3479689603294006, 'f1-score': 0.26238098843575725, 'support': 25258}}
[[1745 6552  109]
 [1823 6965   97]
 [1674 6214   79]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.213577
{'0': {'precision': 0.3150539419087137, 'recall': 0.07861994698475812, 'f1-score': 0.12583778050316552, 'support': 120720}, '1': {'precision': 0.33312912305001374, 'recall': 0.9128509561578512, 'f1-score': 0.4881253618333322, 'support': 123306}, '2': {'precision': 0.3395744680851064, 'recall': 0.0031878939925376114, 'f1-score': 0.006316489361702128, 'support': 125161}, 'accuracy': 0.3316747339424194, 'macro avg': {'precision': 0.3292525110146113, 'recall': 0.3315529323783823, 'f1-score': 0.20675987723273329, 'support': 369187}, 'weighted avg': {'precision': 0.3294038292627447, 'recall': 0.3316747339424194, 'f1-score': 0.20631956394337558, 'support': 369187}}
[[  9491 110859    370]
 [ 10340 112560    406]
 [ 10294 114468    399]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1646765
{'0': {'precision': 0.33283809829746225, 'recall': 0.1995522172468583, 'f1-score': 0.24951085156979017, 'support': 41538}, '1': {'precision': 0.32656824719123645, 'recall': 0.7932612717888792, 'f1-score': 0.46266675186187023, 'support': 41076}, '2': {'precision': 0.3538175046554935, 'recall': 0.013050048079124502, 'f1-score': 0.025171675241228555, 'support': 43678}, 'accuracy': 0.3281522186678491, 'macro avg': {'precision': 0.33774128338139736, 'recall': 0.33528784570495396, 'f1-score': 0.24578309289096298, 'support': 126292}, 'weighted avg': {'precision': 0.33805456574486004, 'recall': 0.3281522186678491, 'f1-score': 0.2412514623505092, 'support': 126292}}
[[ 8289 32744   505]
 [ 7956 32584   536]
 [ 8659 34449   570]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.194631
{'0': {'precision': 0.31308243727598567, 'recall': 0.13870583564906708, 'f1-score': 0.192242090784044, 'support': 12595}, '1': {'precision': 0.3186291248874678, 'recall': 0.8331845117298482, 'f1-score': 0.4609718853857901, 'support': 12319}, '2': {'precision': 0.36338028169014086, 'recall': 0.009747619767266133, 'f1-score': 0.018985944513945103, 'support': 13234}, 'accuracy': 0.3182342455698857, 'macro avg': {'precision': 0.3316972812845314, 'recall': 0.3272126557153938, 'f1-score': 0.2240666402279264, 'support': 38148}, 'weighted avg': {'precision': 0.3323225368267558, 'recall': 0.3182342455698857, 'f1-score': 0.21891742107555132, 'support': 38148}}
[[ 1747 10715   133]
 [ 1962 10264    93]
 [ 1871 11234   129]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2095582
{'0': {'precision': 0.310687759640804, 'recall': 0.09220710482891746, 'f1-score': 0.14220890534291764, 'support': 481785}, '1': {'precision': 0.31699056931288894, 'recall': 0.8733898204916616, 'f1-score': 0.4651560775042521, 'support': 456859}, '2': {'precision': 0.3329296773635499, 'recall': 0.00810885970345464, 'f1-score': 0.01583211133894251, 'support': 474666}, 'accuracy': 0.31648329099772876, 'macro avg': {'precision': 0.32020266877241427, 'recall': 0.3245685950080112, 'f1-score': 0.20773236472870404, 'support': 1413310}, 'weighted avg': {'precision': 0.3201952119631989, 'recall': 0.31648329099772876, 'f1-score': 0.20415890557199987, 'support': 1413310}}
[[ 44424 433970   3391]
 [ 53522 399016   4321]
 [ 45040 425777   3849]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1913211
{'0': {'precision': 0.3238617369793408, 'recall': 0.08782920085218258, 'f1-score': 0.13818384099159173, 'support': 110305}, '1': {'precision': 0.33103770477477296, 'recall': 0.8981324433258558, 'f1-score': 0.48376655271326974, 'support': 109662}, '2': {'precision': 0.35745422842197033, 'recall': 0.007470641290781046, 'f1-score': 0.014635408765182005, 'support': 109763}, 'accuracy': 0.33057046674551904, 'macro avg': {'precision': 0.337451223392028, 'recall': 0.33114409515627313, 'f1-score': 0.2121952674900145, 'support': 329730}, 'weighted avg': {'precision': 0.3374308499463139, 'recall': 0.33057046674551904, 'f1-score': 0.21199042445792857, 'support': 329730}}
[[ 9688 99914   703]
 [10400 98491   771]
 [ 9826 99117   820]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2289723
{'0': {'precision': 0.37221269296740994, 'recall': 0.005644573925710124, 'f1-score': 0.01112050631614011, 'support': 38444}, '1': {'precision': 0.3193054394057928, 'recall': 0.9929254515966669, 'f1-score': 0.4832175492790997, 'support': 35762}, '2': {'precision': 0.23076923076923078, 'recall': 0.0009538950715421304, 'f1-score': 0.0018999366687777071, 'support': 37740}, 'accuracy': 0.31945759562646275, 'macro avg': {'precision': 0.3074291210474778, 'recall': 0.33317464019797305, 'f1-score': 0.16541266408800584, 'support': 111946}, 'weighted avg': {'precision': 0.3076266830587948, 'recall': 0.31945759562646275, 'f1-score': 0.15882699115659804, 'support': 111946}}
[[  217 38172    55]
 [  188 35509    65]
 [  178 37526    36]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
5918/5918 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2169793
{'0': {'precision': 0.47861987614273077, 'recall': 0.003169729957756464, 'f1-score': 0.006297752133203473, 'support': 512031}, '1': {'precision': 0.3293595835503169, 'recall': 0.998191105130483, 'f1-score': 0.4952937910282014, 'support': 498647}, '2': {'precision': 0.12568306010928962, 'recall': 9.12101203577023e-05, 'f1-score': 0.00018228795155895825, 'support': 504330}, 'accuracy': 0.32964446392362284, 'macro avg': {'precision': 0.3112208399341124, 'recall': 0.3338173484028657, 'f1-score': 0.16725794370432126, 'support': 1515008}, 'weighted avg': {'precision': 0.31200371203635324, 'recall': 0.32964446392362284, 'f1-score': 0.16520925342966217, 'support': 1515008}}
[[  1623 510214    194]
 [   776 497745    126]
 [   992 503292     46]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.179094
{'0': {'precision': 0.3507628613049145, 'recall': 0.11839372707334589, 'f1-score': 0.17703309938522113, 'support': 154569}, '1': {'precision': 0.33396096306113765, 'recall': 0.8902998696219036, 'f1-score': 0.48572231330888804, 'support': 153400}, '2': {'precision': 0.384055678582727, 'recall': 0.007766617618834367, 'f1-score': 0.01522533877632924, 'support': 156310}, 'accuracy': 0.33619009259518523, 'macro avg': {'precision': 0.35625983431625974, 'recall': 0.338820071438028, 'f1-score': 0.22599358382347948, 'support': 464279}, 'weighted avg': {'precision': 0.35642021190250667, 'recall': 0.33619009259518523, 'f1-score': 0.22454925746067708, 'support': 464279}}
[[ 18300 135145   1124]
 [ 16005 136572    823]
 [ 17867 137229   1214]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1781194
{'0': {'precision': 0.3325239251535495, 'recall': 0.04423668908904344, 'f1-score': 0.07808543109665085, 'support': 52626}, '1': {'precision': 0.36305777754804025, 'recall': 0.9526465701400427, 'f1-score': 0.5257499485375301, 'support': 58982}, '2': {'precision': 0.2837696335078534, 'recall': 0.005301874241890676, 'f1-score': 0.010409264629626073, 'support': 51114}, 'accuracy': 0.36127874534482124, 'macro avg': {'precision': 0.32645044540314777, 'recall': 0.3340617111569923, 'f1-score': 0.20474821475460236, 'support': 162722}, 'weighted avg': {'precision': 0.3282769322377406, 'recall': 0.36127874534482124, 'f1-score': 0.2190924798970739, 'support': 162722}}
[[ 2328 50005   293]
 [ 2402 56189   391]
 [ 2271 48572   271]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
3755/3755 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1177747
{'0': {'precision': 0.36666666666666664, 'recall': 3.924758805731575e-05, 'f1-score': 7.848677497841615e-05, 'support': 280272}, '1': {'precision': 0.4255219973447534, 'recall': 0.9999559895744192, 'f1-score': 0.5969973213829547, 'support': 408994}, '2': {'precision': 0.29411764705882354, 'recall': 1.8389316542661376e-05, 'f1-score': 3.6776333693741396e-05, 'support': 271897}, 'accuracy': 0.4255178362046812, 'macro avg': {'precision': 0.36210210369008117, 'recall': 0.33333787549300636, 'f1-score': 0.19903752816387563, 'support': 961163}, 'weighted avg': {'precision': 0.3711878730916327, 'recall': 0.4255178362046812, 'f1-score': 0.25406754055441094, 'support': 961163}}
[[    11 280258      3]
 [     9 408976      9]
 [    10 271882      5]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1858687
{'0': {'precision': 0.32870123846986277, 'recall': 0.14747111998212098, 'f1-score': 0.20359829341731478, 'support': 129761}, '1': {'precision': 0.3306704914758801, 'recall': 0.8424858722216654, 'f1-score': 0.4749327984736507, 'support': 129709}, '2': {'precision': 0.3286532951289398, 'recall': 0.008642840457836955, 'f1-score': 0.016842754458484155, 'support': 132711}, 'accuracy': 0.33036021632868495, 'macro avg': {'precision': 0.32934167502489425, 'recall': 0.33286661088720776, 'f1-score': 0.23179128211648323, 'support': 392181}, 'weighted avg': {'precision': 0.32933632081561715, 'recall': 0.33036021632868495, 'f1-score': 0.23014219275355724, 'support': 392181}}
[[ 19136 109478   1147]
 [ 19235 109278   1196]
 [ 19846 111718   1147]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.16947
{'0': {'precision': 0.2997241998588929, 'recall': 0.1245568675533758, 'f1-score': 0.1759810198086917, 'support': 37517}, '1': {'precision': 0.3595708187966554, 'recall': 0.8549482123409876, 'f1-score': 0.5062323781822173, 'support': 43157}, '2': {'precision': 0.3370118845500849, 'recall': 0.01025601281355757, 'f1-score': 0.019906235114197608, 'support': 38709}, 'accuracy': 0.3515324627459521, 'macro avg': {'precision': 0.33210230106854444, 'recall': 0.32992036423597365, 'f1-score': 0.23403987770170223, 'support': 119383}, 'weighted avg': {'precision': 0.33344901428145196, 'recall': 0.3515324627459521, 'f1-score': 0.24476098875391067, 'support': 119383}}
[[ 4673 32492   352]
 [ 5831 36897   429]
 [ 5087 33225   397]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
4960/4960 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2005489
{'0': {'precision': 0.33722748282567694, 'recall': 0.15866217937223853, 'f1-score': 0.21579496992208508, 'support': 435006}, '1': {'precision': 0.30848146662151765, 'recall': 0.8270744379200818, 'f1-score': 0.44936076611348835, 'support': 393227}, '2': {'precision': 0.37233149995338866, 'recall': 0.009047518728182545, 'f1-score': 0.01766576583350657, 'support': 441447}, 'accuracy': 0.3136546216369479, 'macro avg': {'precision': 0.3393468164668611, 'recall': 0.33159471200683427, 'f1-score': 0.22760716728969332, 'support': 1269680}, 'weighted avg': {'precision': 0.3405297742180467, 'recall': 0.3136546216369479, 'f1-score': 0.21924531534901645, 'support': 1269680}}
[[ 69019 362513   3474]
 [ 64740 325228   3259]
 [ 70907 366546   3994]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2140107
{'0': {'precision': 0.33344855632370884, 'recall': 0.10831643537936182, 'f1-score': 0.163516619386875, 'support': 151399}, '1': {'precision': 0.3116287600880411, 'recall': 0.871186316521994, 'f1-score': 0.45905182812092915, 'support': 136515}, '2': {'precision': 0.31867588932806323, 'recall': 0.004450424342786172, 'f1-score': 0.008778257141690596, 'support': 144930}, 'accuracy': 0.3141408914066038, 'macro avg': {'precision': 0.32125106857993774, 'recall': 0.3279843920813807, 'f1-score': 0.21044890154983156, 'support': 432844}, 'weighted avg': {'precision': 0.3216204332336554, 'recall': 0.3141408914066038, 'f1-score': 0.20491434739080905, 'support': 432844}}
[[ 16399 134366    634]
 [ 16840 118930    745]
 [ 15941 128344    645]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2586738
{'0': {'precision': 0.31548440518906984, 'recall': 0.04204988595394011, 'f1-score': 0.07420873234864471, 'support': 54364}, '1': {'precision': 0.2717830914343392, 'recall': 0.9359463022893444, 'f1-score': 0.4212439984895075, 'support': 41715}, '2': {'precision': 0.39914163090128757, 'recall': 0.001689219871038053, 'f1-score': 0.003364201996816669, 'support': 55055}, 'accuracy': 0.2740746622202813, 'macro avg': {'precision': 0.3288030425082322, 'recall': 0.3265618027047742, 'f1-score': 0.16627231094498965, 'support': 151134}, 'weighted avg': {'precision': 0.33389686207043046, 'recall': 0.2740746622202813, 'f1-score': 0.14418789328229434, 'support': 151134}}
[[ 2286 52005    73]
 [ 2605 39043    67]
 [ 2355 52607    93]]
testing model on single stock: results/universal/W8/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
10609/10609 - 142s - 142s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2476263
{'0': {'precision': 0.35821881960123625, 'recall': 0.09096597567695519, 'f1-score': 0.14508827891510662, 'support': 1030792}, '1': {'precision': 0.2420426318763162, 'recall': 0.8829531452829, 'f1-score': 0.3799344094382296, 'support': 667126}, '2': {'precision': 0.36402601241501625, 'recall': 0.0072600327777362925, 'f1-score': 0.014236143891212662, 'support': 1017764}, 'accuracy': 0.2541523639365728, 'macro avg': {'precision': 0.32142915463085625, 'recall': 0.3270597179125305, 'f1-score': 0.1797529440815163, 'support': 2715682}, 'weighted avg': {'precision': 0.33185571684279436, 'recall': 0.2541523639365728, 'f1-score': 0.1537400162396205, 'support': 2715682}}
[[ 93767 929772   7253]
 [ 72429 589041   5656]
 [ 95563 914812   7389]]
Evaluating performance on  train set...
3903/3903 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1481252
{'0': {'precision': 0.33095270066131793, 'recall': 0.2374493835709232, 'f1-score': 0.2765102977034605, 'support': 332155}, '1': {'precision': 0.3278764196921227, 'recall': 0.7406675416872539, 'f1-score': 0.4545389436988492, 'support': 329897}, '2': {'precision': 0.3234744506733681, 'recall': 0.014895656224870999, 'f1-score': 0.028479845686891894, 'support': 337011}, 'accuracy': 0.32854184370755396, 'macro avg': {'precision': 0.32743452367560294, 'recall': 0.3310041938276827, 'f1-score': 0.2531763623630672, 'support': 999063}, 'weighted avg': {'precision': 0.3274142767885656, 'recall': 0.32854184370755396, 'f1-score': 0.2516291095935865, 'support': 999063}}
[[ 78870 248290   4995]
 [ 80049 244344   5504]
 [ 79393 252598   5020]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1393296
{'0': {'precision': 0.3450787671660035, 'recall': 0.2736227870635941, 'f1-score': 0.3052244281041245, 'support': 101110}, '1': {'precision': 0.31274291190876385, 'recall': 0.7084628896234958, 'f1-score': 0.43393162621618736, 'support': 91659}, '2': {'precision': 0.3439767779390421, 'recall': 0.016612593126652246, 'f1-score': 0.031694479734828584, 'support': 99864}, 'accuracy': 0.32211678108757386, 'macro avg': {'precision': 0.33393281900460314, 'recall': 0.3328994232712474, 'f1-score': 0.2569501780183801, 'support': 292633}, 'weighted avg': {'precision': 0.3345744111665619, 'recall': 0.32211678108757386, 'f1-score': 0.2521934244504087, 'support': 292633}}
[[27666 71805  1639]
 [25197 64937  1525]
 [27310 70895  1659]]
training model: results/universal/W8/deepLOB_L2/h500
Epoch 1/50
7696/7696 - 314s - loss: 3.2198 - accuracy500: 0.4128 - val_loss: 3.4840 - val_accuracy500: 0.3234 - 314s/epoch - 41ms/step
Epoch 2/50
7696/7696 - 309s - loss: 3.1853 - accuracy500: 0.4317 - val_loss: 3.4379 - val_accuracy500: 0.3273 - 309s/epoch - 40ms/step
Epoch 3/50
7696/7696 - 309s - loss: 3.1697 - accuracy500: 0.4380 - val_loss: 3.4906 - val_accuracy500: 0.3305 - 309s/epoch - 40ms/step
Epoch 4/50
7696/7696 - 308s - loss: 3.1596 - accuracy500: 0.4415 - val_loss: 3.4994 - val_accuracy500: 0.3269 - 308s/epoch - 40ms/step
Epoch 5/50
7696/7696 - 309s - loss: 3.1506 - accuracy500: 0.4453 - val_loss: 3.4521 - val_accuracy500: 0.3287 - 309s/epoch - 40ms/step
Epoch 6/50
7696/7696 - 308s - loss: 3.1430 - accuracy500: 0.4479 - val_loss: 3.4754 - val_accuracy500: 0.3280 - 308s/epoch - 40ms/step
Epoch 7/50
7696/7696 - 308s - loss: 3.1364 - accuracy500: 0.4511 - val_loss: 3.4836 - val_accuracy500: 0.3271 - 308s/epoch - 40ms/step
Epoch 8/50
7696/7696 - 308s - loss: 3.1311 - accuracy500: 0.4524 - val_loss: 3.5142 - val_accuracy500: 0.3287 - 308s/epoch - 40ms/step
Epoch 9/50
7696/7696 - 308s - loss: 3.1254 - accuracy500: 0.4548 - val_loss: 3.4719 - val_accuracy500: 0.3290 - 308s/epoch - 40ms/step
Epoch 10/50
7696/7696 - 308s - loss: 3.1219 - accuracy500: 0.4560 - val_loss: 3.5695 - val_accuracy500: 0.3307 - 308s/epoch - 40ms/step
Epoch 11/50
7696/7696 - 312s - loss: 3.1163 - accuracy500: 0.4580 - val_loss: 3.6021 - val_accuracy500: 0.3299 - 312s/epoch - 40ms/step
Epoch 12/50
7696/7696 - 309s - loss: 3.1120 - accuracy500: 0.4592 - val_loss: 3.5466 - val_accuracy500: 0.3310 - 309s/epoch - 40ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 318s - 318s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1876558
{'0': {'precision': 0.3486452332673288, 'recall': 0.12312422917524435, 'f1-score': 0.18198157794873562, 'support': 2142186}, '1': {'precision': 0.2870465094807859, 'recall': 0.8099274602581639, 'f1-score': 0.42386940221575087, 'support': 1715887}, '2': {'precision': 0.36217951367362405, 'recall': 0.06250621167485776, 'f1-score': 0.10661281034300964, 'support': 2102895}, 'accuracy': 0.29943844690996496, 'macro avg': {'precision': 0.33262375214057965, 'recall': 0.33185263370275536, 'f1-score': 0.23748793016916536, 'support': 5960968}, 'weighted avg': {'precision': 0.33568839827560876, 'recall': 0.29943844690996496, 'f1-score': 0.22502149505008778, 'support': 5960968}}
[[ 263755 1744950  133481]
 [ 228143 1389744   98000]
 [ 264616 1706835  131444]]
Evaluating performance on  train set...
7696/7696 - 107s - 107s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1451628
{'0': {'precision': 0.3280119920031301, 'recall': 0.3039150153342562, 'f1-score': 0.3155040643047808, 'support': 653765}, '1': {'precision': 0.3265386665037661, 'recall': 0.6251284876313343, 'f1-score': 0.4289916319118301, 'support': 649868}, '2': {'precision': 0.3359358020563404, 'recall': 0.060356207957683976, 'f1-score': 0.10232763021705282, 'support': 665847}, 'accuracy': 0.3275626053577594, 'macro avg': {'precision': 0.33016215352107886, 'recall': 0.3297999036410915, 'f1-score': 0.2822744421445546, 'support': 1969480}, 'weighted avg': {'precision': 0.3302047424026667, 'recall': 0.3275626053577594, 'f1-score': 0.28088022932176315, 'support': 1969480}}
[[198689 415653  39423]
 [203598 406251  40019]
 [203450 422209  40188]]
Evaluating performance on  val set...
2338/2338 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1466113
{'0': {'precision': 0.3414537917064151, 'recall': 0.28543651086662236, 'f1-score': 0.31094237229966515, 'support': 203145}, '1': {'precision': 0.32185605115646815, 'recall': 0.6583768134054009, 'f1-score': 0.4323514727908138, 'support': 192042}, '2': {'precision': 0.3348041448417217, 'recall': 0.0580523512658384, 'f1-score': 0.09894792635063793, 'support': 202593}, 'accuracy': 0.32818428184281845, 'macro avg': {'precision': 0.33270466256820164, 'recall': 0.3339552251792872, 'f1-score': 0.2807472571470389, 'support': 597780}, 'weighted avg': {'precision': 0.33290422297217886, 'recall': 0.32818428184281845, 'f1-score': 0.278099279001746, 'support': 597780}}
[[ 57985 133097  12063]
 [ 54302 126436  11304]
 [ 57531 133301  11761]]
testing model out of sample: results/universal/W8/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 189s - 189s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1748472
{'0': {'precision': 0.34108838079957216, 'recall': 0.14927970615891115, 'f1-score': 0.20767082774817613, 'support': 1247477}, '1': {'precision': 0.30899259023900594, 'recall': 0.7764282255516481, 'f1-score': 0.44206001038062015, 'support': 1117243}, '2': {'precision': 0.3486005089058524, 'recall': 0.0732320609296372, 'f1-score': 0.12103728129979088, 'support': 1251542}, 'accuracy': 0.3167179258582481, 'macro avg': {'precision': 0.33289382664814354, 'recall': 0.3329799975467322, 'f1-score': 0.2569227064761957, 'support': 3616262}, 'weighted avg': {'precision': 0.3337722478703573, 'recall': 0.3167179258582481, 'f1-score': 0.2501025297605621, 'support': 3616262}}
[[186223 971413  89841]
 [168361 867459  81423]
 [191383 968506  91653]]
Evaluating performance on  train set...
4550/4550 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1610724
{'0': {'precision': 0.325130381328204, 'recall': 0.21006777619761438, 'f1-score': 0.25523038605230386, 'support': 390255}, '1': {'precision': 0.32448759646426845, 'recall': 0.7022298955776511, 'f1-score': 0.4438706708467042, 'support': 384592}, '2': {'precision': 0.33102894495815716, 'recall': 0.06777222941454493, 'f1-score': 0.11251004782444612, 'support': 389304}, 'accuracy': 0.32507466814871955, 'macro avg': {'precision': 0.3268823075835432, 'recall': 0.3266899670632702, 'f1-score': 0.27053703490781805, 'support': 1164151}, 'weighted avg': {'precision': 0.3268905692239363, 'recall': 0.32507466814871955, 'f1-score': 0.2698229482338336, 'support': 1164151}}
[[ 81980 281625  26650]
 [ 87851 270072  26669]
 [ 82314 280606  26384]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1827191
{'0': {'precision': 0.29832307036907946, 'recall': 0.11266143068170184, 'f1-score': 0.16355606514215343, 'support': 136746}, '1': {'precision': 0.3081083449661657, 'recall': 0.7613066881148302, 'f1-score': 0.4386789720188412, 'support': 129304}, '2': {'precision': 0.3459003780149199, 'recall': 0.07660223880044154, 'f1-score': 0.12542759407069556, 'support': 134983}, 'accuracy': 0.3096652893901499, 'macro avg': {'precision': 0.3174439311167217, 'recall': 0.31685678586565785, 'f1-score': 0.24255421041056338, 'support': 401033}, 'weighted avg': {'precision': 0.317492073579439, 'recall': 0.3096652893901499, 'f1-score': 0.23942961405245416, 'support': 401033}}
[[ 15406 111837   9503]
 [ 20814  98440  10050]
 [ 15422 109221  10340]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2355454
{'0': {'precision': 0.3620803159973667, 'recall': 0.08665784332261928, 'f1-score': 0.13984591522794884, 'support': 63468}, '1': {'precision': 0.2235687805982398, 'recall': 0.8270348076419786, 'f1-score': 0.3519865447376335, 'support': 38210}, '2': {'precision': 0.38755067970426904, 'recall': 0.05138664895803687, 'f1-score': 0.0907415680142953, 'support': 63246}, 'accuracy': 0.24466420896897964, 'macro avg': {'precision': 0.3243999254332918, 'recall': 0.3216930999742116, 'f1-score': 0.19419134265995922, 'support': 164924}, 'weighted avg': {'precision': 0.33975714202272445, 'recall': 0.24466420896897964, 'f1-score': 0.17016436439053476, 'support': 164924}}
[[ 5500 54667  3301]
 [ 4774 31601  1835]
 [ 4916 55080  3250]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.154656
{'0': {'precision': 0.35369302115145346, 'recall': 0.16544098195862653, 'f1-score': 0.22543435945497803, 'support': 18901}, '1': {'precision': 0.335928983024451, 'recall': 0.8000317914481004, 'f1-score': 0.47317455343152615, 'support': 18873}, '2': {'precision': 0.34759358288770054, 'recall': 0.06037151702786378, 'f1-score': 0.10287523080981271, 'support': 19380}, 'accuracy': 0.3393638240543094, 'macro avg': {'precision': 0.34573852902120167, 'recall': 0.34194809681153027, 'f1-score': 0.26716138123210564, 'support': 57154}, 'weighted avg': {'precision': 0.34575888171899993, 'recall': 0.3393638240543094, 'f1-score': 0.2656835942902667, 'support': 57154}}
[[ 3127 14583  1191]
 [ 2769 15099  1005]
 [ 2945 15265  1170]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1810153
{'0': {'precision': 0.3631975867269985, 'recall': 0.1819555689889678, 'f1-score': 0.24244865082561415, 'support': 6617}, '1': {'precision': 0.28278005153857816, 'recall': 0.7473958333333334, 'f1-score': 0.4103156274056967, 'support': 4992}, '2': {'precision': 0.33791208791208793, 'recall': 0.04371002132196162, 'f1-score': 0.07740717432347388, 'support': 5628}, 'accuracy': 0.3005743458838545, 'macro avg': {'precision': 0.3279632420592215, 'recall': 0.32435380788142093, 'f1-score': 0.24339048418492826, 'support': 17237}, 'weighted avg': {'precision': 0.33165200901678726, 'recall': 0.3005743458838545, 'f1-score': 0.23717734591952416, 'support': 17237}}
[[1204 5125  288]
 [1067 3731  194]
 [1044 4338  246]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2245197
{'0': {'precision': 0.3841059602649007, 'recall': 0.001364712304528492, 'f1-score': 0.002719761411274818, 'support': 212499}, '1': {'precision': 0.27734966479597867, 'recall': 0.9555627383799857, 'f1-score': 0.4299170070777388, 'support': 154690}, '2': {'precision': 0.3393168785838943, 'recall': 0.04284567476953267, 'f1-score': 0.07608417149219453, 'support': 190591}, 'accuracy': 0.2801678080963821, 'macro avg': {'precision': 0.3335908345482579, 'recall': 0.33325770848468234, 'f1-score': 0.16957364666040273, 'support': 557780}, 'weighted avg': {'precision': 0.3391948354258024, 'recall': 0.2801678080963821, 'f1-score': 0.14626334170077585, 'support': 557780}}
[[   290 202984   9225]
 [   199 147816   6675]
 [   266 182159   8166]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1627922
{'0': {'precision': 0.3271468360361298, 'recall': 0.23384935992855016, 'f1-score': 0.2727400961361096, 'support': 53744}, '1': {'precision': 0.31635898339344826, 'recall': 0.6585154018374122, 'f1-score': 0.4273930390013842, 'support': 51812}, '2': {'precision': 0.349228352277978, 'recall': 0.07333449768100755, 'f1-score': 0.1212150372081088, 'support': 51531}, 'accuracy': 0.32126146657584653, 'macro avg': {'precision': 0.33091139056918534, 'recall': 0.32189975314898994, 'f1-score': 0.2737827241152008, 'support': 157087}, 'weighted avg': {'precision': 0.33083232492022635, 'recall': 0.32126146657584653, 'f1-score': 0.2740428166929781, 'support': 157087}}
[[12568 37851  3325]
 [13976 34119  3717]
 [11873 35879  3779]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.167867
{'0': {'precision': 0.33280212483399735, 'recall': 0.14895387541607227, 'f1-score': 0.20579781555391313, 'support': 16824}, '1': {'precision': 0.32278761638976555, 'recall': 0.7826966860612193, 'f1-score': 0.45707532362011344, 'support': 15812}, '2': {'precision': 0.34845667534399405, 'recall': 0.058841999497613665, 'f1-score': 0.10068231880943426, 'support': 15924}, 'accuracy': 0.3257619439868204, 'macro avg': {'precision': 0.33468213885591896, 'recall': 0.33016418699163513, 'f1-score': 0.25451848599448695, 'support': 48560}, 'weighted avg': {'precision': 0.33467472892792227, 'recall': 0.3257619439868204, 'f1-score': 0.25314832600250614, 'support': 48560}}
[[ 2506 13375   943]
 [ 2627 12376   809]
 [ 2397 12590   937]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925046
{'0': {'precision': 0.25783283866327655, 'recall': 0.3467286027598796, 'f1-score': 0.2957450269566834, 'support': 73409}, '1': {'precision': 0.5019718467210368, 'recall': 0.6180483913121226, 'f1-score': 0.553995154399571, 'support': 145398}, '2': {'precision': 0.2858953559115798, 'recall': 0.07169192432872254, 'f1-score': 0.11463712136613133, 'support': 78656}, 'accuracy': 0.40662200004706467, 'macro avg': {'precision': 0.3485666804319643, 'recall': 0.34548963946690825, 'f1-score': 0.32145910090746194, 'support': 297463}, 'weighted avg': {'precision': 0.3845867840288002, 'recall': 0.40662200004706467, 'f1-score': 0.37408696732510066, 'support': 297463}}
[[25453 42905  5051]
 [46501 89863  9034]
 [26765 46252  5639]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1444176
{'0': {'precision': 0.35048196089231615, 'recall': 0.22659449449805918, 'f1-score': 0.27524007267064626, 'support': 28081}, '1': {'precision': 0.34641530110785773, 'recall': 0.6990428803427663, 'f1-score': 0.4632593712074374, 'support': 28941}, '2': {'precision': 0.31995445488186736, 'recall': 0.08463855421686747, 'f1-score': 0.13386530101828142, 'support': 26560}, 'accuracy': 0.345074298293891, 'macro avg': {'precision': 0.33895057229401376, 'recall': 0.33675864301923103, 'f1-score': 0.29078824829878835, 'support': 83582}, 'weighted avg': {'precision': 0.3393730647130008, 'recall': 0.345074298293891, 'f1-score': 0.2954184912759256, 'support': 83582}}
[[ 6363 19386  2332]
 [ 6264 20231  2446]
 [ 5528 18784  2248]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1342871
{'0': {'precision': 0.2932810912784792, 'recall': 0.20781491002570693, 'f1-score': 0.24325950890707754, 'support': 9725}, '1': {'precision': 0.3838848430646054, 'recall': 0.7241323907455013, 'f1-score': 0.50176737454424, 'support': 12448}, '2': {'precision': 0.30985915492957744, 'recall': 0.04574280070693419, 'f1-score': 0.07971736570341516, 'support': 9619}, 'accuracy': 0.3609398590840463, 'macro avg': {'precision': 0.3290083630908873, 'recall': 0.32589670049271413, 'f1-score': 0.27491474971824426, 'support': 31792}, 'weighted avg': {'precision': 0.3337724065934519, 'recall': 0.3609398590840463, 'f1-score': 0.29499560717001694, 'support': 31792}}
[[2021 7286  418]
 [2872 9014  562]
 [1998 7181  440]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1522441
{'0': {'precision': 0.32129003878913903, 'recall': 0.15928510537063104, 'f1-score': 0.2129811260735871, 'support': 100882}, '1': {'precision': 0.34980942811827914, 'recall': 0.7647128231193726, 'f1-score': 0.48003304560863747, 'support': 110176}, '2': {'precision': 0.38118655538010376, 'recall': 0.08285364059818583, 'f1-score': 0.13612050910262607, 'support': 101975}, 'accuracy': 0.34747454741193423, 'macro avg': {'precision': 0.35076200742917396, 'recall': 0.33561718969606313, 'f1-score': 0.27637822692828357, 'support': 313033}, 'weighted avg': {'precision': 0.3508399569066888, 'recall': 0.34747454741193423, 'f1-score': 0.2819350410636359, 'support': 313033}}
[[16069 77909  6904]
 [19111 84253  6812]
 [14834 78692  8449]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1526082
{'0': {'precision': 0.32157506152584087, 'recall': 0.2227644994150092, 'f1-score': 0.2632015482444014, 'support': 29915}, '1': {'precision': 0.32524574816664065, 'recall': 0.6895239985445404, 'f1-score': 0.4420012510469566, 'support': 30231}, '2': {'precision': 0.33802603693611866, 'recall': 0.07140344706296166, 'f1-score': 0.1179017397502574, 'support': 31273}, 'accuracy': 0.3253371837364224, 'macro avg': {'precision': 0.32828228220953337, 'recall': 0.32789731500750374, 'f1-score': 0.27436817968053845, 'support': 91419}, 'weighted avg': {'precision': 0.3284165264493648, 'recall': 0.3253371837364224, 'f1-score': 0.27262336323238723, 'support': 91419}}
[[ 6664 21093  2158]
 [ 7171 20845  2215]
 [ 6888 22152  2233]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1336212
{'0': {'precision': 0.33044554455445546, 'recall': 0.3290608824254375, 'f1-score': 0.3297517599110782, 'support': 8114}, '1': {'precision': 0.371356406580654, 'recall': 0.5840669959201202, 'f1-score': 0.4540333013395652, 'support': 9314}, '2': {'precision': 0.24752866745749308, 'recall': 0.07994891443167305, 'f1-score': 0.12086108697750748, 'support': 7830}, 'accuracy': 0.3458706152506137, 'macro avg': {'precision': 0.3164435395308675, 'recall': 0.3310255975924103, 'f1-score': 0.3015487160760503, 'support': 25258}, 'weighted avg': {'precision': 0.31982730958901073, 'recall': 0.3458706152506137, 'f1-score': 0.3108248578521293, 'support': 25258}}
[[2670 4640  804]
 [2775 5440 1099]
 [2635 4569  626]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1722492
{'0': {'precision': 0.29276196196829113, 'recall': 0.15511205654751933, 'f1-score': 0.20278430148850093, 'support': 119404}, '1': {'precision': 0.33040288018931907, 'recall': 0.7257736043424858, 'f1-score': 0.4540864008091245, 'support': 126195}, '2': {'precision': 0.3106894150417827, 'recall': 0.07219956630093537, 'f1-score': 0.11717047036268614, 'support': 123588}, 'accuracy': 0.3224192617833239, 'macro avg': {'precision': 0.31128475239979764, 'recall': 0.3176950757303135, 'f1-score': 0.2580137242201039, 'support': 369187}, 'weighted avg': {'precision': 0.3116296733052269, 'recall': 0.3224192617833239, 'f1-score': 0.26002419959593404, 'support': 369187}}
[[18521 91457  9426]
 [24235 91589 10371]
 [20507 94158  8923]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1412425
{'0': {'precision': 0.32139479317039177, 'recall': 0.31555924830771487, 'f1-score': 0.3184502891527639, 'support': 40921}, '1': {'precision': 0.33023837495736535, 'recall': 0.624584876358858, 'f1-score': 0.43204204402723606, 'support': 41855}, '2': {'precision': 0.3431612253703437, 'recall': 0.054830407206544717, 'f1-score': 0.0945530919970675, 'support': 43516}, 'accuracy': 0.32813638235200965, 'macro avg': {'precision': 0.33159813116603365, 'recall': 0.3316581772910392, 'f1-score': 0.28168180839235585, 'support': 126292}, 'weighted avg': {'precision': 0.33182566907153266, 'recall': 0.32813638235200965, 'f1-score': 0.2789487567425063, 'support': 126292}}
[[12913 25716  2292]
 [13438 26142  2275]
 [13827 27303  2386]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1437882
{'0': {'precision': 0.3245941406978914, 'recall': 0.28504711183941006, 'f1-score': 0.30353793133534007, 'support': 12205}, '1': {'precision': 0.3294786042388589, 'recall': 0.6487108290360968, 'f1-score': 0.43700398150869785, 'support': 12605}, '2': {'precision': 0.38208269525267996, 'recall': 0.07482381166591692, 'f1-score': 0.125141065830721, 'support': 13338}, 'accuracy': 0.33170808430324, 'macro avg': {'precision': 0.3453851467298101, 'recall': 0.33619391751380795, 'f1-score': 0.28856099289158627, 'support': 38148}, 'weighted avg': {'precision': 0.3463082804584467, 'recall': 0.33170808430324, 'f1-score': 0.28526389784300926, 'support': 38148}}
[[3479 7874  852]
 [3666 8177  762]
 [3573 8767  998]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1719282
{'0': {'precision': 0.33816286388670336, 'recall': 0.17345219526664232, 'f1-score': 0.2292938413340286, 'support': 495589}, '1': {'precision': 0.29756068692329113, 'recall': 0.728384155029923, 'f1-score': 0.42251489680890414, 'support': 421080}, '2': {'precision': 0.3729249273578512, 'recall': 0.09639155848993539, 'f1-score': 0.1531879489928161, 'support': 496641}, 'accuracy': 0.31170868386978084, 'macro avg': {'precision': 0.3362161593892819, 'recall': 0.33274263626216694, 'f1-score': 0.2683322290452496, 'support': 1413310}, 'weighted avg': {'precision': 0.3382813809060556, 'recall': 0.31170868386978084, 'f1-score': 0.2601180876502143, 'support': 1413310}}
[[ 85961 362333  47295]
 [ 81170 306708  33202]
 [ 87069 361700  47872]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1657617
{'0': {'precision': 0.3127515826432359, 'recall': 0.16093915392196226, 'f1-score': 0.2125183002873823, 'support': 109588}, '1': {'precision': 0.32247618511926524, 'recall': 0.736901056729189, 'f1-score': 0.4486278016879996, 'support': 108921}, '2': {'precision': 0.33280137490793027, 'recall': 0.07312467969178482, 'f1-score': 0.11990358177489145, 'support': 111221}, 'accuracy': 0.3215782610014254, 'macro avg': {'precision': 0.3226763808901438, 'recall': 0.3236549634476454, 'f1-score': 0.26034989458342445, 'support': 329730}, 'weighted avg': {'precision': 0.32272693026633104, 'recall': 0.3215782610014254, 'f1-score': 0.25927346783167277, 'support': 329730}}
[[17637 83864  8087]
 [20439 80264  8218]
 [18317 84771  8133]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1813575
{'0': {'precision': 0.4417227456258412, 'recall': 0.04229926536924861, 'f1-score': 0.07720536344389556, 'support': 38795}, '1': {'precision': 0.3186877504860918, 'recall': 0.9007935395227546, 'f1-score': 0.4708097928436911, 'support': 35663}, '2': {'precision': 0.3608455634845833, 'recall': 0.07148954332052923, 'f1-score': 0.11933652454636534, 'support': 37488}, 'accuracy': 0.3255676844192736, 'macro avg': {'precision': 0.3737520198655055, 'recall': 0.33819411607084415, 'f1-score': 0.22245056027798402, 'support': 111946}, 'weighted avg': {'precision': 0.37544328199355104, 'recall': 0.3255676844192736, 'f1-score': 0.21670590596523884, 'support': 111946}}
[[ 1641 34659  2495]
 [ 1286 32125  2252]
 [  788 34020  2680]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
5918/5918 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.184366
{'0': {'precision': 0.5102836402742305, 'recall': 0.0072879188729452335, 'f1-score': 0.014370595550642531, 'support': 520862}, '1': {'precision': 0.3226767852161388, 'recall': 0.9248102665141048, 'f1-score': 0.4784254927852847, 'support': 490293}, '2': {'precision': 0.3271851584099413, 'recall': 0.06646978384568515, 'f1-score': 0.11049233439016586, 'support': 503853}, 'accuracy': 0.32390258005238254, 'macro avg': {'precision': 0.38671519463343684, 'recall': 0.3328559897442451, 'f1-score': 0.20109614090869768, 'support': 1515008}, 'weighted avg': {'precision': 0.38867567043528267, 'recall': 0.32390258005238254, 'f1-score': 0.1965175506884205, 'support': 1515008}}
[[  3796 483222  33844]
 [  1839 453428  35026]
 [  1804 468558  33491]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1537083
{'0': {'precision': 0.3323727283915166, 'recall': 0.20986343238640412, 'f1-score': 0.25727860536562713, 'support': 154429}, '1': {'precision': 0.33083405571095365, 'recall': 0.7247549563424216, 'f1-score': 0.45429351549797004, 'support': 153238}, '2': {'precision': 0.3535109738044668, 'recall': 0.07014149618164636, 'f1-score': 0.1170572125784555, 'support': 156612}, 'accuracy': 0.33267496483795306, 'macro avg': {'precision': 0.33890591930231234, 'recall': 0.3349199616368241, 'f1-score': 0.27620977781401757, 'support': 464279}, 'weighted avg': {'precision': 0.33899529750704593, 'recall': 0.33267496483795306, 'f1-score': 0.2750046236254998, 'support': 464279}}
[[ 32409 111838  10182]
 [ 32271 111060   9907]
 [ 32828 112799  10985]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1602113
{'0': {'precision': 0.35021478634411035, 'recall': 0.08630808662382526, 'f1-score': 0.1384869842499739, 'support': 53842}, '1': {'precision': 0.3494262566635545, 'recall': 0.8152911001018939, 'f1-score': 0.4891901293389693, 'support': 56922}, '2': {'precision': 0.3299681509524668, 'recall': 0.10568151199045382, 'f1-score': 0.1600897972273648, 'support': 51958}, 'accuracy': 0.3475006452723049, 'macro avg': {'precision': 0.34320306465337724, 'recall': 0.335760232905391, 'f1-score': 0.26258897027210265, 'support': 162722}, 'weighted avg': {'precision': 0.34347409136644524, 'recall': 0.3475006452723049, 'f1-score': 0.2680648125794873, 'support': 162722}}
[[ 4647 44144  5051]
 [ 4415 46408  6099]
 [ 4207 42260  5491]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
3755/3755 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1577713
{'0': {'precision': 0.32926829268292684, 'recall': 0.0013070629810717916, 'f1-score': 0.0026037899609431506, 'support': 309855}, '1': {'precision': 0.3677209242565628, 'recall': 0.9558360692856335, 'f1-score': 0.5311156596208452, 'support': 353320}, '2': {'precision': 0.31117264627979774, 'recall': 0.043367518155093494, 'f1-score': 0.07612556624391048, 'support': 297988}, 'accuracy': 0.3652283743756262, 'macro avg': {'precision': 0.3360539544064291, 'recall': 0.33350355014059957, 'f1-score': 0.20328167194189958, 'support': 961163}, 'weighted avg': {'precision': 0.3377931717172024, 'recall': 0.3652283743756262, 'f1-score': 0.2196766702728626, 'support': 961163}}
[[   405 296013  13437]
 [   434 337716  15170]
 [   391 284674  12923]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1432647
{'0': {'precision': 0.3425428336599861, 'recall': 0.2914850937262226, 'f1-score': 0.3149581450969971, 'support': 130113}, '1': {'precision': 0.33678773631758435, 'recall': 0.6279981478623244, 'f1-score': 0.43844355125483564, 'support': 129580}, '2': {'precision': 0.3264973141221949, 'recall': 0.09817492905017813, 'f1-score': 0.15095806784814828, 'support': 132488}, 'accuracy': 0.3373671850497602, 'macro avg': {'precision': 0.3352759613665885, 'recall': 0.33921939021290837, 'f1-score': 0.301453254733327, 'support': 392181}, 'weighted avg': {'precision': 0.3352207443538971, 'recall': 0.3373671850497602, 'f1-score': 0.30035569545101026, 'support': 392181}}
[[37926 79128 13059]
 [34432 81376 13772]
 [38361 81120 13007]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1547331
{'0': {'precision': 0.3314821365405023, 'recall': 0.23818722517347432, 'f1-score': 0.277195213938148, 'support': 39343}, '1': {'precision': 0.3213646098162736, 'recall': 0.6686296479662298, 'f1-score': 0.43409121667343353, 'support': 38377}, '2': {'precision': 0.31643884253506127, 'recall': 0.08556752994263495, 'f1-score': 0.13470876079276012, 'support': 41663}, 'accuracy': 0.32329561160299203, 'macro avg': {'precision': 0.32309519629727906, 'recall': 0.33079480102744635, 'f1-score': 0.2819983971347806, 'support': 119383}, 'weighted avg': {'precision': 0.3229798449140194, 'recall': 0.32329561160299203, 'f1-score': 0.27790540550290815, 'support': 119383}}
[[ 9371 26205  3767]
 [ 8783 25660  3934]
 [10116 27982  3565]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
4960/4960 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1758577
{'0': {'precision': 0.3658413088409851, 'recall': 0.2811236270395081, 'f1-score': 0.3179357333246769, 'support': 470334}, '1': {'precision': 0.2500009321065982, 'recall': 0.6342736964246863, 'f1-score': 0.35864201052616557, 'support': 317147}, '2': {'precision': 0.3901304616334723, 'recall': 0.08384505152437065, 'f1-score': 0.13802615430047233, 'support': 482199}, 'accuracy': 0.2944127654212085, 'macro avg': {'precision': 0.3353242341936851, 'recall': 0.33308079166285504, 'f1-score': 0.27153463271710493, 'support': 1269680}, 'weighted avg': {'precision': 0.34613065515439, 'recall': 0.2944127654212085, 'f1-score': 0.2597775002263593, 'support': 1269680}}
[[132222 300123  37989]
 [ 90776 201158  25213]
 [138421 303348  40430]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1792367
{'0': {'precision': 0.3040368557443133, 'recall': 0.17845771110645403, 'f1-score': 0.22490500451548043, 'support': 147923}, '1': {'precision': 0.3090049590135309, 'recall': 0.6869534530825423, 'f1-score': 0.42626684214099114, 'support': 141685}, '2': {'precision': 0.3200373747462706, 'recall': 0.06934709151330672, 'f1-score': 0.11399356182541187, 'support': 143236}, 'accuracy': 0.308799475099574, 'macro avg': {'precision': 0.3110263965013716, 'recall': 0.31158608523410103, 'f1-score': 0.2550551361606278, 'support': 432844}, 'weighted avg': {'precision': 0.3109579544576221, 'recall': 0.308799475099574, 'f1-score': 0.25411516004221946, 'support': 432844}}
[[ 26398 111297  10228]
 [ 33478  97331  10876]
 [ 26949 106354   9933]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.226696
{'0': {'precision': 0.24234501191098715, 'recall': 0.07673344739407988, 'f1-score': 0.11656047395484015, 'support': 54357}, '1': {'precision': 0.2502111991328881, 'recall': 0.7415499444929967, 'f1-score': 0.37417094231009884, 'support': 42337}, '2': {'precision': 0.3830039057876672, 'recall': 0.05944158706833211, 'f1-score': 0.10291147895498418, 'support': 54440}, 'accuracy': 0.2567390527611259, 'macro avg': {'precision': 0.29185337227718083, 'recall': 0.29257499298513623, 'f1-score': 0.19788096507330774, 'support': 151134}, 'weighted avg': {'precision': 0.29521531873182216, 'recall': 0.2567390527611259, 'f1-score': 0.1838081026218802, 'support': 151134}}
[[ 4171 47349  2837]
 [ 8566 31395  2376]
 [ 4474 46730  3236]]
testing model on single stock: results/universal/W8/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
10609/10609 - 142s - 142s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2026086
{'0': {'precision': 0.3572410112734307, 'recall': 0.1569944525929755, 'f1-score': 0.21812909046352197, 'support': 1023361}, '1': {'precision': 0.24227178494219737, 'recall': 0.7587393829041664, 'f1-score': 0.3672709166624339, 'support': 676621}, '2': {'precision': 0.36763514847105105, 'recall': 0.05318204194151816, 'f1-score': 0.09292200190774201, 'support': 1015700}, 'accuracy': 0.26809398154864966, 'macro avg': {'precision': 0.32238264822889307, 'recall': 0.32297195914622007, 'f1-score': 0.22610733634456595, 'support': 2715682}, 'weighted avg': {'precision': 0.33248359573735453, 'recall': 0.26809398154864966, 'f1-score': 0.20845919970990218, 'support': 2715682}}
[[160662 805744  56955]
 [127283 513379  35959]
 [161785 799898  54017]]
Evaluating performance on  train set...
3903/3903 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1358293
{'0': {'precision': 0.3258151650133209, 'recall': 0.3734658979131672, 'f1-score': 0.3480170123474896, 'support': 330405}, '1': {'precision': 0.3268662714414272, 'recall': 0.5779384435996162, 'f1-score': 0.41756763872190683, 'support': 329324}, '2': {'precision': 0.3431619888573531, 'recall': 0.038481260351158446, 'f1-score': 0.06920235514830969, 'support': 339334}, 'accuracy': 0.32708848190754736, 'macro avg': {'precision': 0.3319478084373671, 'recall': 0.3299618672879806, 'f1-score': 0.278262335405902, 'support': 999063}, 'weighted avg': {'precision': 0.3320535320588631, 'recall': 0.32708848190754736, 'f1-score': 0.2762431578399181, 'support': 999063}}
[[123395 193929  13081]
 [127082 190329  11913]
 [128250 198026  13058]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.12806
{'0': {'precision': 0.34104381812086576, 'recall': 0.41681239944438336, 'f1-score': 0.3751405315465216, 'support': 100069}, '1': {'precision': 0.3197435558659394, 'recall': 0.5471919548645506, 'f1-score': 0.40363117953768385, 'support': 92876}, '2': {'precision': 0.34805514092545436, 'recall': 0.039764063879303424, 'f1-score': 0.0713739117909198, 'support': 99688}, 'accuracy': 0.32974749942761067, 'macro avg': {'precision': 0.3362808383040865, 'recall': 0.3345894727294125, 'f1-score': 0.2833818742917084, 'support': 292633}, 'weighted avg': {'precision': 0.33667199946253024, 'recall': 0.32974749942761067, 'f1-score': 0.28070214159265705, 'support': 292633}}
[[41710 54350  4009]
 [38639 50821  3416]
 [41952 53772  3964]]
training model: results/universal/W8/deepLOB_L2/h1000
Epoch 1/50
7696/7696 - 313s - loss: 3.1760 - accuracy1000: 0.4358 - val_loss: 3.4861 - val_accuracy1000: 0.3176 - 313s/epoch - 41ms/step
Epoch 2/50
7696/7696 - 308s - loss: 3.1290 - accuracy1000: 0.4566 - val_loss: 3.4743 - val_accuracy1000: 0.3205 - 308s/epoch - 40ms/step
Epoch 3/50
7696/7696 - 308s - loss: 3.1078 - accuracy1000: 0.4639 - val_loss: 3.6172 - val_accuracy1000: 0.3233 - 308s/epoch - 40ms/step
Epoch 4/50
7696/7696 - 310s - loss: 3.0876 - accuracy1000: 0.4707 - val_loss: 3.4629 - val_accuracy1000: 0.3281 - 310s/epoch - 40ms/step
Epoch 5/50
7696/7696 - 309s - loss: 3.0744 - accuracy1000: 0.4746 - val_loss: 3.4263 - val_accuracy1000: 0.3294 - 309s/epoch - 40ms/step
Epoch 6/50
7696/7696 - 309s - loss: 3.0643 - accuracy1000: 0.4775 - val_loss: 3.4910 - val_accuracy1000: 0.3297 - 309s/epoch - 40ms/step
Epoch 7/50
7696/7696 - 309s - loss: 3.0533 - accuracy1000: 0.4809 - val_loss: 3.4932 - val_accuracy1000: 0.3263 - 309s/epoch - 40ms/step
Epoch 8/50
7696/7696 - 310s - loss: 3.0480 - accuracy1000: 0.4821 - val_loss: 3.5371 - val_accuracy1000: 0.3330 - 310s/epoch - 40ms/step
Epoch 9/50
7696/7696 - 309s - loss: 3.0423 - accuracy1000: 0.4837 - val_loss: 3.5073 - val_accuracy1000: 0.3300 - 309s/epoch - 40ms/step
Epoch 10/50
7696/7696 - 311s - loss: 3.0353 - accuracy1000: 0.4859 - val_loss: 3.5507 - val_accuracy1000: 0.3365 - 311s/epoch - 40ms/step
Epoch 11/50
7696/7696 - 311s - loss: 3.0291 - accuracy1000: 0.4879 - val_loss: 3.6411 - val_accuracy1000: 0.3404 - 311s/epoch - 40ms/step
Epoch 12/50
7696/7696 - 309s - loss: 3.0247 - accuracy1000: 0.4890 - val_loss: 3.6608 - val_accuracy1000: 0.3406 - 309s/epoch - 40ms/step
Epoch 13/50
7696/7696 - 310s - loss: 3.0203 - accuracy1000: 0.4905 - val_loss: 3.6691 - val_accuracy1000: 0.3415 - 310s/epoch - 40ms/step
Epoch 14/50
7696/7696 - 310s - loss: 3.0162 - accuracy1000: 0.4919 - val_loss: 3.7866 - val_accuracy1000: 0.3422 - 310s/epoch - 40ms/step
Epoch 15/50
7696/7696 - 314s - loss: 3.0129 - accuracy1000: 0.4927 - val_loss: 3.7461 - val_accuracy1000: 0.3394 - 314s/epoch - 41ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 320s - 320s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1351569
{'0': {'precision': 0.3163146935103692, 'recall': 0.12681449053928812, 'f1-score': 0.18104556482162737, 'support': 2087845}, '1': {'precision': 0.3109532906637556, 'recall': 0.4928007459252043, 'f1-score': 0.3813057393461318, 'support': 1840399}, '2': {'precision': 0.35137539987559174, 'recall': 0.381543682270687, 'f1-score': 0.3658386503876322, 'support': 2032724}, 'accuracy': 0.3266737885524633, 'macro avg': {'precision': 0.32621446134990556, 'recall': 0.3337196395783932, 'f1-score': 0.3093966515184638, 'support': 5960968}, 'weighted avg': {'precision': 0.3266153055666721, 'recall': 0.3266737885524633, 'f1-score': 0.30588971177876506, 'support': 5960968}}
[[ 264769 1015186  807890]
 [ 309663  906950  623786]
 [ 262611  994540  775573]]
Evaluating performance on  train set...
7696/7696 - 109s - 109s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1457477
{'0': {'precision': 0.3228431635255704, 'recall': 0.35242297566887004, 'f1-score': 0.3369852026040102, 'support': 646127}, '1': {'precision': 0.33324755588800375, 'recall': 0.46908138191004906, 'f1-score': 0.3896661747315341, 'support': 651533}, '2': {'precision': 0.3540171329285898, 'recall': 0.18287934268107528, 'f1-score': 0.24117282757090935, 'support': 671820}, 'accuracy': 0.33318134736072463, 'macro avg': {'precision': 0.33670261744738794, 'recall': 0.33479456675333147, 'f1-score': 0.3226080683021512, 'support': 1969480}, 'weighted avg': {'precision': 0.33691901151255665, 'recall': 0.33318134736072463, 'f1-score': 0.3217297656452313, 'support': 1969480}}
[[227710 298942 119475]
 [241197 305622 104714]
 [236420 312538 122862]]
Evaluating performance on  val set...
2338/2338 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1441092
{'0': {'precision': 0.33705156592907537, 'recall': 0.33325566380745725, 'f1-score': 0.3351428669065275, 'support': 206001}, '1': {'precision': 0.3118553538561478, 'recall': 0.46714744456097484, 'f1-score': 0.3740228710925665, 'support': 184978}, '2': {'precision': 0.359673187532583, 'recall': 0.2035048186420762, 'f1-score': 0.2599363824464964, 'support': 206801}, 'accuracy': 0.32980026096557263, 'macro avg': {'precision': 0.3361933691059354, 'recall': 0.3346359756701694, 'f1-score': 0.32303404014853015, 'support': 597780}, 'weighted avg': {'precision': 0.3370807222280499, 'recall': 0.32980026096557263, 'f1-score': 0.32115639901115833, 'support': 597780}}
[[68651 95350 42000]
 [65642 86412 32924]
 [69388 95328 42085]]
testing model out of sample: results/universal/W8/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 198s - 198s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1416374
{'0': {'precision': 0.31633827764915934, 'recall': 0.1783653769572628, 'f1-score': 0.22811149913090245, 'support': 1255580}, '1': {'precision': 0.30191916547515957, 'recall': 0.40685969432061597, 'f1-score': 0.3466207765004535, 'support': 1105472}, '2': {'precision': 0.35904316999635555, 'recall': 0.4057799093378797, 'f1-score': 0.38098354745342883, 'support': 1255210}, 'accuracy': 0.3271507982552149, 'macro avg': {'precision': 0.3257668710402248, 'recall': 0.3303349935385862, 'f1-score': 0.31857194102826164, 'support': 3616262}, 'weighted avg': {'precision': 0.3267533645952678, 'recall': 0.3271507982552149, 'f1-score': 0.31740127173233196, 'support': 3616262}}
[[223952 521870 509758]
 [256196 449772 399504]
 [227803 518068 509339]]
Evaluating performance on  train set...
4550/4550 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.149994
{'0': {'precision': 0.31056566867526897, 'recall': 0.2510212720383111, 'f1-score': 0.27763675951309214, 'support': 392158}, '1': {'precision': 0.3206644120576934, 'recall': 0.4029999132060882, 'f1-score': 0.35714826810186395, 'support': 380211}, '2': {'precision': 0.34852779921211874, 'recall': 0.328567928082454, 'f1-score': 0.33825366857305017, 'support': 391782}, 'accuracy': 0.32675486255648967, 'macro avg': {'precision': 0.3265859599816937, 'recall': 0.32752970444228446, 'f1-score': 0.3243462320626687, 'support': 1164151}, 'weighted avg': {'precision': 0.3266396425379063, 'recall': 0.32675486255648967, 'f1-score': 0.32400511212145133, 'support': 1164151}}
[[ 98440 162421 131297]
 [117665 153225 109321]
 [100865 162190 128727]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1432508
{'0': {'precision': 0.3124156131091199, 'recall': 0.1430438081321831, 'f1-score': 0.19623754360941384, 'support': 142348}, '1': {'precision': 0.2862085749975076, 'recall': 0.4112581107272268, 'f1-score': 0.33752321146378317, 'support': 118670}, '2': {'precision': 0.36412077078469557, 'recall': 0.42997535978288043, 'f1-score': 0.394317396586901, 'support': 140015}, 'accuracy': 0.32258941284133724, 'macro avg': {'precision': 0.3209149862971077, 'recall': 0.32809242621409673, 'f1-score': 0.3093593838866993, 'support': 401033}, 'weighted avg': {'precision': 0.3227127917433986, 'recall': 0.32258941284133724, 'f1-score': 0.3072022792269837, 'support': 401033}}
[[20362 62145 59841]
 [24572 48804 45294]
 [20242 59570 60203]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1357944
{'0': {'precision': 0.332871368442665, 'recall': 0.1070785793306144, 'f1-score': 0.1620338559560247, 'support': 60563}, '1': {'precision': 0.28840219558152874, 'recall': 0.4484786716776015, 'f1-score': 0.3510533095109486, 'support': 47097}, '2': {'precision': 0.35726552545565343, 'recall': 0.4504749930148086, 'f1-score': 0.3984922915314981, 'support': 57264}, 'accuracy': 0.3238036913972496, 'macro avg': {'precision': 0.3261796964932824, 'recall': 0.3353440813410082, 'f1-score': 0.3038598189994905, 'support': 164924}, 'weighted avg': {'precision': 0.328642404634795, 'recall': 0.3238036913972496, 'f1-score': 0.29811353543790825, 'support': 164924}}
[[ 6485 27075 27003]
 [ 6570 21122 19405]
 [ 6427 25041 25796]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402873
{'0': {'precision': 0.3441771459814106, 'recall': 0.20475983953160576, 'f1-score': 0.25676410605030586, 'support': 18446}, '1': {'precision': 0.32974101921470345, 'recall': 0.41178925404277517, 'f1-score': 0.3662259336580839, 'support': 19170}, '2': {'precision': 0.3431205035971223, 'recall': 0.3905722182413758, 'f1-score': 0.3653118866389009, 'support': 19538}, 'accuracy': 0.3377191447667705, 'macro avg': {'precision': 0.3390128895977454, 'recall': 0.33570710393858555, 'f1-score': 0.3294339754490969, 'support': 57154}, 'weighted avg': {'precision': 0.3389739191027669, 'recall': 0.3377191447667705, 'f1-score': 0.33058553188893613, 'support': 57154}}
[[3777 7915 6754]
 [3421 7894 7855]
 [3776 8131 7631]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1463604
{'0': {'precision': 0.39030159668835007, 'recall': 0.18970968669157803, 'f1-score': 0.2553191489361702, 'support': 6958}, '1': {'precision': 0.28162034044386985, 'recall': 0.5589052811631388, 'f1-score': 0.3745253958019915, 'support': 4677}, '2': {'precision': 0.3194839273999563, 'recall': 0.26079971438771865, 'f1-score': 0.28717444717444723, 'support': 5602}, 'accuracy': 0.31298949933283055, 'macro avg': {'precision': 0.33046862151072537, 'recall': 0.33647156074747847, 'f1-score': 0.305672997304203, 'support': 17237}, 'weighted avg': {'precision': 0.3377969370138698, 'recall': 0.31298949933283055, 'f1-score': 0.29801689200760223, 'support': 17237}}
[[1320 3627 2011]
 [ 962 2614 1101]
 [1100 3041 1461]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1352179
{'0': {'precision': 0.37509819324430477, 'recall': 0.004479109993808979, 'f1-score': 0.008852510683265511, 'support': 213212}, '1': {'precision': 0.2779101589295901, 'recall': 0.4969335054874112, 'f1-score': 0.3564664094952741, 'support': 154900}, '2': {'precision': 0.339938761428325, 'recall': 0.4987135415568256, 'f1-score': 0.4042964242056402, 'support': 189668}, 'accuracy': 0.3092975725196314, 'macro avg': {'precision': 0.33098237120074, 'recall': 0.3333753856793486, 'f1-score': 0.2565384481280599, 'support': 557780}, 'weighted avg': {'precision': 0.33615264907093434, 'recall': 0.3092975725196314, 'f1-score': 0.23985478598166612, 'support': 557780}}
[[   955 105798 106459]
 [   718  76975  77207]
 [   873  94205  94590]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1440499
{'0': {'precision': 0.3197797117761743, 'recall': 0.30101220319742694, 'f1-score': 0.3101122719476065, 'support': 52855}, '1': {'precision': 0.3086573808640518, 'recall': 0.34850158029016415, 'f1-score': 0.3273715839175848, 'support': 52522}, '2': {'precision': 0.363986508994004, 'recall': 0.3380970798684974, 'f1-score': 0.35056445629724686, 'support': 51710}, 'accuracy': 0.3290978884312515, 'macro avg': {'precision': 0.33080786721141003, 'recall': 0.32920362111869617, 'f1-score': 0.3293494373874794, 'support': 157087}, 'weighted avg': {'precision': 0.3306129851849699, 'recall': 0.3290978884312515, 'f1-score': 0.32919899482096393, 'support': 157087}}
[[15910 21179 15766]
 [19435 18304 14783]
 [14408 19819 17483]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1330632
{'0': {'precision': 0.3382768361581921, 'recall': 0.16837541742339915, 'f1-score': 0.22483864658713082, 'support': 17069}, '1': {'precision': 0.31482779773902375, 'recall': 0.46330925973691, 'f1-score': 0.3749021654056875, 'support': 15508}, '2': {'precision': 0.33801183157406334, 'recall': 0.36463742726647064, 'f1-score': 0.3508201655379985, 'support': 15983}, 'accuracy': 0.32716227347611204, 'macro avg': {'precision': 0.33037215515709306, 'recall': 0.33210736814225994, 'f1-score': 0.3168536591769389, 'support': 48560}, 'weighted avg': {'precision': 0.3307009865685588, 'recall': 0.32716227347611204, 'f1-score': 0.31422801370471515, 'support': 48560}}
[[2874 8033 6162]
 [3071 7185 5252]
 [2551 7604 5828]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1272964
{'0': {'precision': 0.26603564423978854, 'recall': 0.4282028054571907, 'f1-score': 0.3281789110493983, 'support': 72858}, '1': {'precision': 0.5214746309180384, 'recall': 0.41903132116121466, 'f1-score': 0.4646737281408061, 'support': 146674}, '2': {'precision': 0.28235445109332136, 'recall': 0.22584080789416278, 'f1-score': 0.25095534135629954, 'support': 77931}, 'accuracy': 0.3706645868561804, 'macro avg': {'precision': 0.3566215754170494, 'recall': 0.3576916448375227, 'f1-score': 0.3479359935155013, 'support': 297463}, 'weighted avg': {'precision': 0.39626360156203794, 'recall': 0.3706645868561804, 'f1-score': 0.37525075121880513, 'support': 297463}}
[[31198 27758 13902]
 [54382 61461 30831]
 [31690 28641 17600]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1412473
{'0': {'precision': 0.38620601625324424, 'recall': 0.3039140188167543, 'f1-score': 0.34015364436949597, 'support': 29867}, '1': {'precision': 0.31339728530409816, 'recall': 0.35454579011479825, 'f1-score': 0.33270406484351994, 'support': 27091}, '2': {'precision': 0.3233665182970337, 'recall': 0.35745943509615385, 'f1-score': 0.3395593613415396, 'support': 26624}, 'accuracy': 0.33738125433705823, 'macro avg': {'precision': 0.3409899399514587, 'recall': 0.3386397480092354, 'f1-score': 0.3374723568515185, 'support': 83582}, 'weighted avg': {'precision': 0.34259016447021123, 'recall': 0.33738125433705823, 'f1-score': 0.337549749388824, 'support': 83582}}
[[ 9077 10805  9985]
 [ 7557  9605  9929]
 [ 6869 10238  9517]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1201693
{'0': {'precision': 0.2856955380577428, 'recall': 0.2245024234299268, 'f1-score': 0.2514292313911185, 'support': 9697}, '1': {'precision': 0.40448193067783045, 'recall': 0.5169564875285231, 'f1-score': 0.45385465598231556, 'support': 12709}, '2': {'precision': 0.29902888132173033, 'recall': 0.25261027061581076, 'f1-score': 0.2738665896621426, 'support': 9386}, 'accuracy': 0.34971061902365375, 'macro avg': {'precision': 0.3297354500191012, 'recall': 0.33135639385808685, 'f1-score': 0.3263834923451922, 'support': 31792}, 'weighted avg': {'precision': 0.33711737448465773, 'recall': 0.34971061902365375, 'f1-score': 0.33897395225993315, 'support': 31792}}
[[2177 4890 2630]
 [3211 6570 2928]
 [2232 4783 2371]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1355494
{'0': {'precision': 0.330046403712297, 'recall': 0.23169403357323914, 'f1-score': 0.272260202281196, 'support': 98233}, '1': {'precision': 0.35385923665649544, 'recall': 0.3812791951131872, 'f1-score': 0.367057846808437, 'support': 111320}, '2': {'precision': 0.34927936709982516, 'recall': 0.41896984924623115, 'f1-score': 0.38096367862148345, 'support': 103480}, 'accuracy': 0.34679730252082047, 'macro avg': {'precision': 0.3443950024895392, 'recall': 0.3439810259775525, 'f1-score': 0.3400939092370388, 'support': 313033}, 'weighted avg': {'precision': 0.3448725454120206, 'recall': 0.34679730252082047, 'f1-score': 0.34190624445715, 'support': 313033}}
[[22760 37804 37669]
 [25773 42444 43103]
 [20427 39698 43355]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1433226
{'0': {'precision': 0.32317299829008994, 'recall': 0.2912953159552369, 'f1-score': 0.30640727426517234, 'support': 29846}, '1': {'precision': 0.3184989677790263, 'recall': 0.40360288760845087, 'f1-score': 0.3560359307675454, 'support': 30198}, '2': {'precision': 0.36274285714285714, 'recall': 0.30349003984063744, 'f1-score': 0.33048156182212585, 'support': 31375}, 'accuracy': 0.33257856681871384, 'macro avg': {'precision': 0.3348049410706578, 'recall': 0.33279608113477505, 'f1-score': 0.3309749222849479, 'support': 91419}, 'weighted avg': {'precision': 0.3352094234110437, 'recall': 0.33257856681871384, 'f1-score': 0.33106316572272576, 'support': 91419}}
[[ 8694 12643  8509]
 [ 9791 12188  8219]
 [ 8417 13436  9522]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1369764
{'0': {'precision': 0.340443242118406, 'recall': 0.4027076923076923, 'f1-score': 0.3689670726206586, 'support': 8125}, '1': {'precision': 0.38220822672702226, 'recall': 0.41424914675767915, 'f1-score': 0.3975841949022418, 'support': 9376}, '2': {'precision': 0.27821330902461255, 'recall': 0.19672553822354003, 'f1-score': 0.23047877964053765, 'support': 7757}, 'accuracy': 0.3437326787552459, 'macro avg': {'precision': 0.33362159262334695, 'recall': 0.33789412576297045, 'f1-score': 0.3323433490544793, 'support': 25258}, 'weighted avg': {'precision': 0.33683531214302515, 'recall': 0.3437326787552459, 'f1-score': 0.3370587841522654, 'support': 25258}}
[[3272 3148 1705]
 [3238 3884 2254]
 [3101 3130 1526]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1532807
{'0': {'precision': 0.31836531212762337, 'recall': 0.20989049749090152, 'f1-score': 0.2529905115272383, 'support': 124746}, '1': {'precision': 0.29581477649316956, 'recall': 0.35823633028855756, 'f1-score': 0.32404684856349686, 'support': 110134}, '2': {'precision': 0.36232101112840315, 'recall': 0.4142896498321011, 'f1-score': 0.3865665316557708, 'support': 134307}, 'accuracy': 0.3285028996145585, 'macro avg': {'precision': 0.32550036658306536, 'recall': 0.3274721592038534, 'f1-score': 0.32120129724883534, 'support': 369187}, 'weighted avg': {'precision': 0.32762884896432887, 'recall': 0.3285028996145585, 'f1-score': 0.3227814661343998, 'support': 369187}}
[[26183 44574 53989]
 [26740 39454 43940]
 [29319 49346 55642]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1480494
{'0': {'precision': 0.3208439672621667, 'recall': 0.3608492316828743, 'f1-score': 0.33967274209514936, 'support': 40413}, '1': {'precision': 0.3318822485790321, 'recall': 0.48898731726207767, 'f1-score': 0.3954007241413054, 'support': 41316}, '2': {'precision': 0.35620554943403787, 'recall': 0.15959428225209255, 'f1-score': 0.2204280246090905, 'support': 44563}, 'accuracy': 0.3317549805213315, 'macro avg': {'precision': 0.33631058842507894, 'recall': 0.3364769437323482, 'f1-score': 0.31850049694851507, 'support': 126292}, 'weighted avg': {'precision': 0.3369326808561608, 'recall': 0.3317549805213315, 'f1-score': 0.3158276447088362, 'support': 126292}}
[[14583 19517  6313]
 [14572 20203  6541]
 [16297 21154  7112]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1507521
{'0': {'precision': 0.3352960154863688, 'recall': 0.32978976596588655, 'f1-score': 0.33252009758828943, 'support': 12605}, '1': {'precision': 0.3087211093990755, 'recall': 0.428083069823092, 'f1-score': 0.35873379646207826, 'support': 11701}, '2': {'precision': 0.38929133858267717, 'recall': 0.26788036410923277, 'f1-score': 0.31737065091796124, 'support': 13842}, 'accuracy': 0.3374750969906679, 'macro avg': {'precision': 0.34443615448937387, 'recall': 0.3419177332994037, 'f1-score': 0.3362081816561096, 'support': 38148}, 'weighted avg': {'precision': 0.3467369897490217, 'recall': 0.3374750969906679, 'f1-score': 0.33506355595338116, 'support': 38148}}
[[4157 5201 3247]
 [4122 5009 2570]
 [4119 6015 3708]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
5521/5521 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1237094
{'0': {'precision': 0.25863929757619225, 'recall': 0.16511750925716012, 'f1-score': 0.2015584218265876, 'support': 449922}, '1': {'precision': 0.3725797621582165, 'recall': 0.4750567157233436, 'f1-score': 0.4176236459247769, 'support': 515730}, '2': {'precision': 0.364598630511253, 'recall': 0.38157030590316715, 'f1-score': 0.3728914571131054, 'support': 447658}, 'accuracy': 0.3467774232121757, 'macro avg': {'precision': 0.33193923008188725, 'recall': 0.340581510294557, 'f1-score': 0.3306911749548233, 'support': 1413310}, 'weighted avg': {'precision': 0.33377925898729865, 'recall': 0.3467774232121757, 'f1-score': 0.334671413268275, 'support': 1413310}}
[[ 74290 207778 167854]
 [140900 245001 129829]
 [ 72044 204801 170813]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1391832
{'0': {'precision': 0.29253635554777635, 'recall': 0.18553191489361703, 'f1-score': 0.227058910103646, 'support': 108100}, '1': {'precision': 0.3227299375797496, 'recall': 0.4282929061784897, 'f1-score': 0.36809251283261546, 'support': 109250}, '2': {'precision': 0.3588298073778252, 'recall': 0.3709823812066204, 'f1-score': 0.3648049141167103, 'support': 112380}, 'accuracy': 0.32917235313741544, 'macro avg': {'precision': 0.32469870016845037, 'recall': 0.32826906742624234, 'f1-score': 0.3199854456843239, 'support': 329730}, 'weighted avg': {'precision': 0.32513486631007876, 'recall': 0.32917235313741544, 'f1-score': 0.3207349997197807, 'support': 329730}}
[[20056 47942 40102]
 [28066 46791 34393]
 [20437 50252 41691]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1315662
{'0': {'precision': 0.4488858879135719, 'recall': 0.07623328670045638, 'f1-score': 0.1303324968632371, 'support': 43603}, '1': {'precision': 0.2389530212693983, 'recall': 0.4280249952660481, 'f1-score': 0.3066903653853982, 'support': 26405}, '2': {'precision': 0.38984679349440104, 'recall': 0.5321188421002432, 'f1-score': 0.45000554541696497, 'support': 41938}, 'accuracy': 0.32999839208189663, 'macro avg': {'precision': 0.35922856755912375, 'recall': 0.34545904135558253, 'f1-score': 0.2956761358885334, 'support': 111946}, 'weighted avg': {'precision': 0.37725082381578734, 'recall': 0.32999839208189663, 'f1-score': 0.2916886670575621, 'support': 111946}}
[[ 3324 18464 21815]
 [ 1991 11302 13112]
 [ 2090 17532 22316]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
5918/5918 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.133379
{'0': {'precision': 0.5439534268324954, 'recall': 0.017438723535659627, 'f1-score': 0.03379403655924231, 'support': 589378}, '1': {'precision': 0.24269993052820688, 'recall': 0.44397675209247356, 'f1-score': 0.31383948113032106, 'support': 370614}, '2': {'precision': 0.37001735644266265, 'recall': 0.5454365279559508, 'f1-score': 0.4409200411315247, 'support': 555016}, 'accuracy': 0.31521153683676917, 'macro avg': {'precision': 0.38555690460112163, 'recall': 0.335617334528028, 'f1-score': 0.262851186273696, 'support': 1515008}, 'weighted avg': {'precision': 0.4065376076930578, 'recall': 0.31521153683676917, 'f1-score': 0.25144979081793645, 'support': 1515008}}
[[ 10278 266126 312974]
 [  3630 164544 202440]
 [  4987 247303 302726]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1466955
{'0': {'precision': 0.27957042749927435, 'recall': 0.21870458791779115, 'f1-score': 0.24542003210436467, 'support': 154144}, '1': {'precision': 0.3237932593299513, 'recall': 0.4191935284593025, 'f1-score': 0.36536864746607123, 'support': 153781}, '2': {'precision': 0.3710754889214683, 'recall': 0.34318917328626064, 'f1-score': 0.3565879624399418, 'support': 156354}, 'accuracy': 0.3270339601834242, 'macro avg': {'precision': 0.32481305858356463, 'recall': 0.32702909655445145, 'f1-score': 0.3224588806701259, 'support': 464279}, 'weighted avg': {'precision': 0.32503406827423736, 'recall': 0.3270339601834242, 'f1-score': 0.3225877881274185, 'support': 464279}}
[[33712 66418 54014]
 [52386 64464 36931]
 [34487 68208 53659]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1470158
{'0': {'precision': 0.34204504396001445, 'recall': 0.09408023321297247, 'f1-score': 0.1475707976097688, 'support': 60374}, '1': {'precision': 0.25913283462851333, 'recall': 0.4025724923840686, 'f1-score': 0.31530576175326974, 'support': 44315}, '2': {'precision': 0.36426343647681536, 'recall': 0.4850171454172626, 'f1-score': 0.41605569680127713, 'support': 58033}, 'accuracy': 0.317516992170696, 'macro avg': {'precision': 0.3218137716884477, 'recall': 0.3272232903381012, 'f1-score': 0.2929774187214385, 'support': 162722}, 'weighted avg': {'precision': 0.32738903811201625, 'recall': 0.317516992170696, 'f1-score': 0.28900317363022116, 'support': 162722}}
[[ 5680 26264 28430]
 [ 5781 17840 20694]
 [ 5145 24741 28147]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
3755/3755 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297591
{'0': {'precision': 0.3328831870357866, 'recall': 0.004588194782673438, 'f1-score': 0.009051629170848736, 'support': 322349}, '1': {'precision': 0.35898824031069326, 'recall': 0.4989700725452427, 'f1-score': 0.41755965441829873, 'support': 344199}, '2': {'precision': 0.3067868686573031, 'recall': 0.4980669687558339, 'f1-score': 0.3796972782470654, 'support': 294615}, 'accuracy': 0.3328904670695813, 'macro avg': {'precision': 0.3328860986679277, 'recall': 0.3338750786945834, 'f1-score': 0.268769520612071, 'support': 961163}, 'weighted avg': {'precision': 0.33423255898736265, 'recall': 0.3328904670695813, 'f1-score': 0.26895116929540264, 'support': 961163}}
[[  1479 160211 160659]
 [  1545 171745 170909]
 [  1419 146458 146738]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1618817
{'0': {'precision': 0.34000014124593037, 'recall': 0.36884686990032406, 'f1-score': 0.3538365427017493, 'support': 130523}, '1': {'precision': 0.32214141934434454, 'recall': 0.36938799300563435, 'f1-score': 0.3441507193489295, 'support': 128675}, '2': {'precision': 0.3240292322175529, 'recall': 0.2510621658407466, 'f1-score': 0.282916701974409, 'support': 132983}, 'accuracy': 0.32908529480010507, 'macro avg': {'precision': 0.3287235976026093, 'recall': 0.3297656762489017, 'f1-score': 0.32696798800836263, 'support': 392181}, 'weighted avg': {'precision': 0.32872516760873915, 'recall': 0.32908529480010507, 'f1-score': 0.3266107043787097, 'support': 392181}}
[[48143 49130 33250]
 [44744 47531 36400]
 [48710 50886 33387]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1516442
{'0': {'precision': 0.31833143814710635, 'recall': 0.278963654481565, 'f1-score': 0.2973501788908766, 'support': 38134}, '1': {'precision': 0.33600615325449473, 'recall': 0.43163797149420746, 'f1-score': 0.37786523657123083, 'support': 40483}, '2': {'precision': 0.32608951707891637, 'recall': 0.27164794191237795, 'f1-score': 0.29638947621978967, 'support': 40766}, 'accuracy': 0.32823768878316006, 'macro avg': {'precision': 0.3268090361601725, 'recall': 0.3274165226293835, 'f1-score': 0.32386829722729904, 'support': 119383}, 'weighted avg': {'precision': 0.32697413716980284, 'recall': 0.32823768878316006, 'f1-score': 0.324324933043346, 'support': 119383}}
[[10638 16366 11130]
 [11253 17474 11756]
 [11527 18165 11074]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
4960/4960 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1525795
{'0': {'precision': 0.31871989046827365, 'recall': 0.36740720771502444, 'f1-score': 0.34133613235868354, 'support': 408035}, '1': {'precision': 0.3355513229776871, 'recall': 0.37854940097876105, 'f1-score': 0.35575584241693375, 'support': 430953}, '2': {'precision': 0.34341089232223493, 'recall': 0.24967958541138446, 'f1-score': 0.2891386472715539, 'support': 430692}, 'accuracy': 0.33125433180013863, 'macro avg': {'precision': 0.3325607019227319, 'recall': 0.33187873136838997, 'f1-score': 0.32874354068239037, 'support': 1269680}, 'weighted avg': {'precision': 0.33280830117389676, 'recall': 0.33125433180013863, 'f1-score': 0.3285243829900135, 'support': 1269680}}
[[149915 155552 102568]
 [164781 163137 103035]
 [155670 167487 107535]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1568247
{'0': {'precision': 0.3195163631055122, 'recall': 0.24923637532822465, 'f1-score': 0.2800341688649389, 'support': 149288}, '1': {'precision': 0.31390189268864327, 'recall': 0.37039170921766185, 'f1-score': 0.33981512682775344, 'support': 138853}, '2': {'precision': 0.3303594839792333, 'recall': 0.34827888848192506, 'f1-score': 0.3390826058434677, 'support': 144703}, 'accuracy': 0.3212127232906082, 'macro avg': {'precision': 0.3212592465911296, 'recall': 0.3226356576759372, 'f1-score': 0.31964396717872007, 'support': 432844}, 'weighted avg': {'precision': 0.3213402212599433, 'recall': 0.3212127232906082, 'f1-score': 0.31895177274096526, 'support': 432844}}
[[37208 57875 54205]
 [39473 51430 47950]
 [39770 54536 50397]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1404246
{'0': {'precision': 0.2783300198807157, 'recall': 0.13279204765337482, 'f1-score': 0.17980067810541456, 'support': 52714}, '1': {'precision': 0.28381967267536434, 'recall': 0.37772819651851197, 'f1-score': 0.3241086490892204, 'support': 45268}, '2': {'precision': 0.3717180321883842, 'recall': 0.4597381095725467, 'f1-score': 0.4110690554293885, 'support': 53152}, 'accuracy': 0.32113885690843885, 'macro avg': {'precision': 0.3112892415814881, 'recall': 0.3234194512481445, 'f1-score': 0.3049927942080078, 'support': 151134}, 'weighted avg': {'precision': 0.31281772769553795, 'recall': 0.32113885690843885, 'f1-score': 0.30435842171055166, 'support': 151134}}
[[ 7000 22044 23670]
 [10537 17099 17632]
 [ 7613 21103 24436]]
testing model on single stock: results/universal/W8/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
10609/10609 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1427779
{'0': {'precision': 0.34857588647684123, 'recall': 0.1641970304612256, 'f1-score': 0.22323770838622325, 'support': 1004129}, '1': {'precision': 0.2687269485418789, 'recall': 0.520352817640882, 'f1-score': 0.3544199986935565, 'support': 714250}, '2': {'precision': 0.3736172974934827, 'recall': 0.3220445541625765, 'f1-score': 0.3459192586521281, 'support': 997303}, 'accuracy': 0.3158370530864807, 'macro avg': {'precision': 0.330306710837401, 'recall': 0.3355314674215613, 'f1-score': 0.3078589885773026, 'support': 2715682}, 'weighted avg': {'precision': 0.3367710324516213, 'recall': 0.3158370530864807, 'f1-score': 0.3027932782124586, 'support': 2715682}}
[[164875 503319 335935]
 [140060 371662 202528]
 [168061 508066 321176]]
Evaluating performance on  train set...
3903/3903 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1420447
{'0': {'precision': 0.3242286159411805, 'recall': 0.41776091969593876, 'f1-score': 0.3650996093119369, 'support': 324803}, '1': {'precision': 0.3425735583028205, 'recall': 0.5454322912888954, 'f1-score': 0.42083209457687, 'support': 330888}, '2': {'precision': 0.39380292174560344, 'recall': 0.06162704006150763, 'f1-score': 0.10657580954251623, 'support': 343372}, 'accuracy': 0.3376443727772923, 'macro avg': {'precision': 0.35353503199653485, 'recall': 0.3416067503487806, 'f1-score': 0.29750250447710774, 'support': 999063}, 'weighted avg': {'precision': 0.3542167046010895, 'recall': 0.3376443727772923, 'f1-score': 0.2947050259972887, 'support': 999063}}
[[135690 167699  21414]
 [139251 180477  11160]
 [143560 178651  21161]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1482558
{'0': {'precision': 0.33619528853228203, 'recall': 0.488916927425053, 'f1-score': 0.3984223340900866, 'support': 99070}, '1': {'precision': 0.3241446818997029, 'recall': 0.5080466922730297, 'f1-score': 0.3957758721561941, 'support': 93206}, '2': {'precision': 0.5030327537403962, 'recall': 0.012395747182558267, 'f1-score': 0.024195273752795877, 'support': 100357}, 'accuracy': 0.3315893969579644, 'macro avg': {'precision': 0.3877909080574604, 'recall': 0.33645312229354696, 'f1-score': 0.2727978266663588, 'support': 292633}, 'weighted avg': {'precision': 0.38957313263767873, 'recall': 0.3315893969579644, 'f1-score': 0.26924014607547486, 'support': 292633}}
[[48437 49746   887]
 [45511 47353   342]
 [50126 48987  1244]]
training model: results/universal/W8/deepOF_L2/h300
Epoch 1/50
7695/7695 - 176s - loss: 3.2564 - accuracy300: 0.3858 - val_loss: 3.7944 - val_accuracy300: 0.3287 - 176s/epoch - 23ms/step
Epoch 2/50
7695/7695 - 168s - loss: 3.2344 - accuracy300: 0.3976 - val_loss: 3.8116 - val_accuracy300: 0.3286 - 168s/epoch - 22ms/step
Epoch 3/50
7695/7695 - 167s - loss: 3.2240 - accuracy300: 0.4025 - val_loss: 3.8623 - val_accuracy300: 0.3287 - 167s/epoch - 22ms/step
Epoch 4/50
7695/7695 - 169s - loss: 3.2200 - accuracy300: 0.4046 - val_loss: 3.8310 - val_accuracy300: 0.3286 - 169s/epoch - 22ms/step
Epoch 5/50
7695/7695 - 170s - loss: 3.2159 - accuracy300: 0.4071 - val_loss: 3.8630 - val_accuracy300: 0.3286 - 170s/epoch - 22ms/step
Epoch 6/50
7695/7695 - 171s - loss: 3.2134 - accuracy300: 0.4087 - val_loss: 3.8634 - val_accuracy300: 0.3286 - 171s/epoch - 22ms/step
Epoch 7/50
7695/7695 - 170s - loss: 3.2119 - accuracy300: 0.4095 - val_loss: 3.8718 - val_accuracy300: 0.3286 - 170s/epoch - 22ms/step
Epoch 8/50
7695/7695 - 168s - loss: 3.2097 - accuracy300: 0.4103 - val_loss: 3.8841 - val_accuracy300: 0.3286 - 168s/epoch - 22ms/step
Epoch 9/50
7695/7695 - 169s - loss: 3.2079 - accuracy300: 0.4116 - val_loss: 3.8989 - val_accuracy300: 0.3286 - 169s/epoch - 22ms/step
Epoch 10/50
7695/7695 - 169s - loss: 3.2060 - accuracy300: 0.4127 - val_loss: 3.9240 - val_accuracy300: 0.3285 - 169s/epoch - 22ms/step
Epoch 11/50
7695/7695 - 168s - loss: 3.2045 - accuracy300: 0.4136 - val_loss: 3.9417 - val_accuracy300: 0.3286 - 168s/epoch - 22ms/step
testing model in sample: results/universal/W8/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2843391
{'0': {'precision': 0.3886799432764042, 'recall': 0.0030240857105713957, 'f1-score': 0.0060014775211156045, 'support': 2084597}, '1': {'precision': 0.30825701760116814, 'recall': 0.9964148517772256, 'f1-score': 0.4708492268614621, 'support': 1837302}, '2': {'precision': 0.35172413793103446, 'recall': 0.0010004688471656326, 'f1-score': 0.0019952622302728228, 'support': 2039044}, 'accuracy': 0.3085181321143316, 'macro avg': {'precision': 0.349553699602869, 'recall': 0.33347980211165423, 'f1-score': 0.1596153222042835, 'support': 5960943}, 'weighted avg': {'precision': 0.3512503427344083, 'recall': 0.3085181321143316, 'f1-score': 0.1479080265867611, 'support': 5960943}}
[[   6304 2076303    1990]
 [   4817 1830715    1770]
 [   5098 2031906    2040]]
Evaluating performance on  train set...
7695/7695 - 62s - 62s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2646749
{'0': {'precision': 0.3581873461705516, 'recall': 0.0037740108857484563, 'f1-score': 0.007469321888826661, 'support': 655536}, '1': {'precision': 0.33114255948098964, 'recall': 0.9956022143855295, 'f1-score': 0.4969852107059955, 'support': 651919}, '2': {'precision': 0.35578446909667194, 'recall': 0.0013564667816692699, 'f1-score': 0.0027026294959806665, 'support': 662014}, 'accuracy': 0.33126898671672417, 'macro avg': {'precision': 0.3483714582494044, 'recall': 0.3335775640176491, 'f1-score': 0.16905238736360095, 'support': 1969469}, 'weighted avg': {'precision': 0.3484274826961532, 'recall': 0.33126898671672417, 'f1-score': 0.16790296751820308, 'support': 1969469}}
[[  2474 652216    846]
 [  2087 649052    780]
 [  2346 658770    898]]
Evaluating performance on  val set...
2338/2338 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2675215
{'0': {'precision': 0.35583796664019063, 'recall': 0.004441778496041562, 'f1-score': 0.008774034342118793, 'support': 201721}, '1': {'precision': 0.32869621699483226, 'recall': 0.9937677111474026, 'f1-score': 0.49399863432892444, 'support': 196557}, '2': {'precision': 0.30861723446893785, 'recall': 0.0015438519105167392, 'f1-score': 0.0030723345253592283, 'support': 199501}, 'accuracy': 0.3287770229466074, 'macro avg': {'precision': 0.33105047270132026, 'recall': 0.3332511138513203, 'f1-score': 0.16861500106546748, 'support': 597779}, 'weighted avg': {'precision': 0.3311541216507551, 'recall': 0.3287770229466074, 'f1-score': 0.16641891126898173, 'support': 597779}}
[[   896 200490    335]
 [   870 195332    355]
 [   752 198441    308]]
testing model out of sample: results/universal/W8/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 109s - 109s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2613071
{'0': {'precision': 0.38457750640141813, 'recall': 0.003245444534480251, 'f1-score': 0.006436570931258906, 'support': 1203225}, '1': {'precision': 0.33253232667080124, 'recall': 0.9965763710531549, 'f1-score': 0.4986708159218996, 'support': 1201941}, '2': {'precision': 0.35046847303114714, 'recall': 0.001142790141948738, 'f1-score': 0.002278151799970371, 'support': 1211071}, 'accuracy': 0.3326980504872883, 'macro avg': {'precision': 0.35585943536778886, 'recall': 0.333654868576528, 'f1-score': 0.16912851288437628, 'support': 3616237}, 'weighted avg': {'precision': 0.35585602146462747, 'recall': 0.3326980504872883, 'f1-score': 0.16864949553839806, 'support': 3616237}}
[[   3905 1198015    1305]
 [   2855 1197826    1260]
 [   3394 1206293    1384]]
Evaluating performance on  train set...
4550/4550 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2671087
{'0': {'precision': 0.3976695548252166, 'recall': 0.00337046500262091, 'f1-score': 0.006684277133846247, 'support': 394901}, '1': {'precision': 0.32514444759737005, 'recall': 0.9969613383863094, 'f1-score': 0.4903638530019303, 'support': 378127}, '2': {'precision': 0.36838288614938364, 'recall': 0.0012988507216547562, 'f1-score': 0.0025885746024143044, 'support': 391115}, 'accuracy': 0.325404181445063, 'macro avg': {'precision': 0.3637322961906568, 'recall': 0.33387688470352833, 'f1-score': 0.16654556824606362, 'support': 1164143}, 'weighted avg': {'precision': 0.3642731794315645, 'recall': 0.325404181445063, 'f1-score': 0.16241292583824943, 'support': 1164143}}
[[  1331 393061    509]
 [   787 376978    362]
 [  1229 389378    508]]
Evaluating performance on  val set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2635304
{'0': {'precision': 0.39396346306592533, 'recall': 0.003657547378511909, 'f1-score': 0.007247806296531719, 'support': 135610}, '1': {'precision': 0.32538875418311525, 'recall': 0.9960282469847648, 'f1-score': 0.4905285615837023, 'support': 130421}, '2': {'precision': 0.3608058608058608, 'recall': 0.001459280878235233, 'f1-score': 0.0029068051702768106, 'support': 134998}, 'accuracy': 0.32565225956227606, 'macro avg': {'precision': 0.36005269268496715, 'recall': 0.33371502508050394, 'f1-score': 0.16689439101683692, 'support': 401029}, 'weighted avg': {'precision': 0.3605000674084812, 'recall': 0.32565225956227606, 'f1-score': 0.1629570764871312, 'support': 401029}}
[[   496 134936    178]
 [   347 129903    171]
 [   416 134385    197]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2568111
{'0': {'precision': 0.29876160990712075, 'recall': 0.0034098337485203444, 'f1-score': 0.006742711408458086, 'support': 56601}, '1': {'precision': 0.3071855958719877, 'recall': 0.993059389541762, 'f1-score': 0.4692247133959723, 'support': 50716}, '2': {'precision': 0.325, 'recall': 0.0018054928648310823, 'f1-score': 0.0035910362211249614, 'support': 57602}, 'accuracy': 0.3071871646080803, 'macro avg': {'precision': 0.3103157352597028, 'recall': 0.3327582387183711, 'f1-score': 0.1598528203418518, 'support': 164919}, 'weighted avg': {'precision': 0.3105165600239916, 'recall': 0.3071871646080803, 'f1-score': 0.14786468291360916, 'support': 164919}}
[[  193 56292   116]
 [  252 50364   100]
 [  201 57297   104]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2078179
{'0': {'precision': 0.3181818181818182, 'recall': 0.0010996491595538565, 'f1-score': 0.0021917236340865207, 'support': 19097}, '1': {'precision': 0.32851833672253, 'recall': 0.9982421562882864, 'f1-score': 0.494348233245842, 'support': 18773}, '2': {'precision': 0.4090909090909091, 'recall': 0.0009334163036714375, 'f1-score': 0.0018625827814569536, 'support': 19284}, 'accuracy': 0.3285684291563145, 'macro avg': {'precision': 0.35193035466508577, 'recall': 0.3334250739171705, 'f1-score': 0.1661341798871285, 'support': 57154}, 'weighted avg': {'precision': 0.3522500963715458, 'recall': 0.3285684291563145, 'f1-score': 0.1637360950296035, 'support': 57154}}
[[   21 19066    10]
 [   17 18740    16]
 [   28 19238    18]]
Evaluating performance on  val set...
68/68 - 1s - 734ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2402891
{'0': {'precision': 0.3448275862068966, 'recall': 0.0016244314489928524, 'f1-score': 0.0032336297493936947, 'support': 6156}, '1': {'precision': 0.30943659515088084, 'recall': 0.9977502812148481, 'f1-score': 0.47237385168419643, 'support': 5334}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5745}, 'accuracy': 0.30937046707281696, 'macro avg': {'precision': 0.21808806045259246, 'recall': 0.3331249042212803, 'f1-score': 0.15853582714453004, 'support': 17235}, 'weighted avg': {'precision': 0.21893202316358884, 'recall': 0.30937046707281696, 'f1-score': 0.14734832315757304, 'support': 17235}}
[[  10 6140    6]
 [  11 5322    1]
 [   8 5737    0]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.277746
{'0': {'precision': 0.33282751643904906, 'recall': 0.003450047713425824, 'f1-score': 0.006829303732764571, 'support': 190722}, '1': {'precision': 0.34454832252612916, 'recall': 0.9950516686959509, 'f1-score': 0.5118593393886917, 'support': 192186}, '2': {'precision': 0.3741851368970013, 'recall': 0.0016412473479844683, 'f1-score': 0.003268159923477231, 'support': 174867}, 'accuracy': 0.3445475326072341, 'macro avg': {'precision': 0.3505203252873932, 'recall': 0.33338098791912035, 'f1-score': 0.17398560101497781, 'support': 557775}, 'weighted avg': {'precision': 0.3498319677953707, 'recall': 0.3445475326072341, 'f1-score': 0.1797251414775028, 'support': 557775}}
[[   658 189852    212]
 [   683 191235    268]
 [   636 173944    287]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2859474
{'0': {'precision': 0.4078549848942598, 'recall': 0.005064335821735379, 'f1-score': 0.010004446420631391, 'support': 53314}, '1': {'precision': 0.3349276782112603, 'recall': 0.9951676115825121, 'f1-score': 0.5011809005504482, 'support': 52562}, '2': {'precision': 0.3673469387755102, 'recall': 0.0017575378847055148, 'f1-score': 0.0034983382893125766, 'support': 51208}, 'accuracy': 0.33528557968984746, 'macro avg': {'precision': 0.37004320062701007, 'recall': 0.3339964950963177, 'f1-score': 0.1715612284201307, 'support': 157084}, 'weighted avg': {'precision': 0.37024745567727557, 'recall': 0.33528557968984746, 'f1-score': 0.1722364496595536, 'support': 157084}}
[[  270 52963    81]
 [  180 52308    74]
 [  212 50906    90]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2636449
{'0': {'precision': 0.2777777777777778, 'recall': 0.0024644199371572917, 'f1-score': 0.004885496183206107, 'support': 16231}, '1': {'precision': 0.35152693867417034, 'recall': 0.9951385228137996, 'f1-score': 0.5195321458604083, 'support': 17073}, '2': {'precision': 0.3333333333333333, 'recall': 0.0018353434714210803, 'f1-score': 0.003650586701434159, 'support': 15256}, 'accuracy': 0.3512767710049423, 'macro avg': {'precision': 0.3208793499284271, 'recall': 0.3331460954074593, 'f1-score': 0.17602274291501618, 'support': 48560}, 'weighted avg': {'precision': 0.32116070569251554, 'recall': 0.3512767710049423, 'f1-score': 0.1854399127994532, 'support': 48560}}
[[   40 16166    25]
 [   52 16990    31]
 [   52 15176    28]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
1162/1162 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037569
{'0': {'precision': 0.28383705650459923, 'recall': 0.0027385797421170745, 'f1-score': 0.005424818544842656, 'support': 78873}, '1': {'precision': 0.4574166554190849, 'recall': 0.9964276788733223, 'f1-score': 0.627003325578276, 'support': 136046}, '2': {'precision': 0.29673590504451036, 'recall': 0.0012115484801124316, 'f1-score': 0.0024132438824267578, 'support': 82539}, 'accuracy': 0.45679053849619106, 'macro avg': {'precision': 0.3459965389893982, 'recall': 0.3334592690318506, 'f1-score': 0.2116137960018485, 'support': 297458}, 'weighted avg': {'precision': 0.3668049651624798, 'recall': 0.45679053849619106, 'f1-score': 0.2888755820368628, 'support': 297458}}
[[   216  78585     72]
 [   321 135560    165]
 [   224  82215    100]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2061728
{'0': {'precision': 0.3393939393939394, 'recall': 0.0019779598756710934, 'f1-score': 0.003932998560241598, 'support': 28312}, '1': {'precision': 0.33867677761512804, 'recall': 0.9971385169745999, 'f1-score': 0.5056202921656262, 'support': 28307}, '2': {'precision': 0.3333333333333333, 'recall': 0.0009271965285761971, 'f1-score': 0.001849249204822842, 'support': 26963}, 'accuracy': 0.3386733985786413, 'macro avg': {'precision': 0.3371346834474669, 'recall': 0.3333478911262824, 'f1-score': 0.17046751331023025, 'support': 83582}, 'weighted avg': {'precision': 0.3371959443748571, 'recall': 0.3386733985786413, 'f1-score': 0.17316893555884735, 'support': 83582}}
[[   56 28230    26]
 [   57 28226    24]
 [   52 26886    25]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1701984
{'0': {'precision': 0.32323232323232326, 'recall': 0.0032333030211175104, 'f1-score': 0.0064025610244097635, 'support': 9897}, '1': {'precision': 0.37716164522145995, 'recall': 0.9951618284951619, 'f1-score': 0.5470093307962126, 'support': 11988}, '2': {'precision': 0.41935483870967744, 'recall': 0.0026244069849601292, 'f1-score': 0.005216170127394924, 'support': 9907}, 'accuracy': 0.3770759939607448, 'macro avg': {'precision': 0.37324960238782023, 'recall': 0.33367317950041314, 'f1-score': 0.18620935398267244, 'support': 31792}, 'weighted avg': {'precision': 0.37352140453705146, 'recall': 0.3770759939607448, 'f1-score': 0.20988269380648217, 'support': 31792}}
[[   32  9855    10]
 [   32 11930    26]
 [   35  9846    26]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1667566
{'0': {'precision': 0.4054794520547945, 'recall': 0.0014648679144437955, 'f1-score': 0.0029191897276080393, 'support': 101033}, '1': {'precision': 0.35821803156435933, 'recall': 0.9980738019226311, 'f1-score': 0.5272140167083157, 'support': 112138}, '2': {'precision': 0.18468468468468469, 'recall': 0.0004105871396096418, 'f1-score': 0.0008193527113580271, 'support': 99857}, 'accuracy': 0.3581500696423323, 'macro avg': {'precision': 0.3161273894346129, 'recall': 0.33331641899222814, 'f1-score': 0.17698418638242727, 'support': 313028}, 'weighted avg': {'precision': 0.3181144104092118, 'recall': 0.3581500696423323, 'f1-score': 0.1900707860162177, 'support': 313028}}
[[   148 100778    107]
 [   142 111922     74]
 [    75  99741     41]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1848178
{'0': {'precision': 0.35714285714285715, 'recall': 0.0025023355131456025, 'f1-score': 0.004969849579219402, 'support': 29972}, '1': {'precision': 0.3308190601668863, 'recall': 0.9973849718636213, 'f1-score': 0.496842278835848, 'support': 30210}, '2': {'precision': 0.4094488188976378, 'recall': 0.0016647991035697134, 'f1-score': 0.003316115043683438, 'support': 31235}, 'accuracy': 0.3309887657656672, 'macro avg': {'precision': 0.3658035787357938, 'recall': 0.3338507021601122, 'f1-score': 0.16837608115291694, 'support': 91417}, 'weighted avg': {'precision': 0.3663154925254063, 'recall': 0.3309887657656672, 'f1-score': 0.16695079064734988, 'support': 91417}}
[[   75 29851    46]
 [   50 30131    29]
 [   85 31098    52]]
Evaluating performance on  val set...
99/99 - 1s - 965ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1642709
{'0': {'precision': 0.16666666666666666, 'recall': 0.00023713540431586437, 'f1-score': 0.0004735969689793986, 'support': 8434}, '1': {'precision': 0.35107183896659666, 'recall': 0.9992105559941356, 'f1-score': 0.5195871452029087, 'support': 8867}, '2': {'precision': 0.375, 'recall': 0.0003770739064856712, 'f1-score': 0.0007533902561526871, 'support': 7956}, 'accuracy': 0.3509918042522865, 'macro avg': {'precision': 0.29757950187775445, 'recall': 0.33327492176831236, 'f1-score': 0.17360471080934695, 'support': 25257}, 'weighted avg': {'precision': 0.2970313442920172, 'recall': 0.3509918042522865, 'f1-score': 0.18280743976832226, 'support': 25257}}
[[   2 8429    3]
 [   5 8860    2]
 [   5 7948    3]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.201642
{'0': {'precision': 0.359375, 'recall': 0.0022863201842310177, 'f1-score': 0.004543733434305188, 'support': 120718}, '1': {'precision': 0.3338395996239682, 'recall': 0.9964721911342513, 'f1-score': 0.5001261803972646, 'support': 123306}, '2': {'precision': 0.2833333333333333, 'recall': 0.0008149698780741143, 'f1-score': 0.0016252649022450963, 'support': 125158}, 'accuracy': 0.3338434701583501, 'macro avg': {'precision': 0.32551597765243384, 'recall': 0.33319116039885216, 'f1-score': 0.1687650595779383, 'support': 369182}, 'weighted avg': {'precision': 0.32506701370751107, 'recall': 0.3338434701583501, 'f1-score': 0.16907781017878107, 'support': 369182}}
[[   276 120317    125]
 [   302 122871    133]
 [   190 124866    102]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2244983
{'0': {'precision': 0.35555555555555557, 'recall': 0.002696650855945874, 'f1-score': 0.005352705027719365, 'support': 41533}, '1': {'precision': 0.3255342653007701, 'recall': 0.9965452643359366, 'f1-score': 0.4907566045647877, 'support': 41103}, '2': {'precision': 0.3333333333333333, 'recall': 0.001122488717842989, 'f1-score': 0.0022374429223744295, 'support': 43653}, 'accuracy': 0.32561822486519015, 'macro avg': {'precision': 0.338141051396553, 'recall': 0.33345480130324184, 'f1-score': 0.16611558417162717, 'support': 126289}, 'weighted avg': {'precision': 0.3381032694498052, 'recall': 0.32561822486519015, 'f1-score': 0.16225921268862012, 'support': 126289}}
[[  112 41375    46]
 [   90 40961    52]
 [  113 43491    49]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2345946
{'0': {'precision': 0.3404255319148936, 'recall': 0.001272365805168986, 'f1-score': 0.0025352559023926477, 'support': 12575}, '1': {'precision': 0.32318882440984165, 'recall': 0.9978111066072153, 'f1-score': 0.4882383275814194, 'support': 12335}, '2': {'precision': 0.3333333333333333, 'recall': 0.0004532406707961928, 'f1-score': 0.0009052504526252263, 'support': 13238}, 'accuracy': 0.32321484743630075, 'macro avg': {'precision': 0.3323158965526895, 'recall': 0.3331789043610602, 'f1-score': 0.1638929446454791, 'support': 38148}, 'weighted avg': {'precision': 0.3323910003038652, 'recall': 0.32321484743630075, 'f1-score': 0.15901972106483298, 'support': 38148}}
[[   16 12554     5]
 [   20 12308     7]
 [   11 13221     6]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/EXC
Evaluating performance on  test set...
5521/5521 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2798462
{'0': {'precision': 0.3873081841432225, 'recall': 0.0050292142760775035, 'f1-score': 0.009929493628609072, 'support': 481785}, '1': {'precision': 0.3232281530938365, 'recall': 0.9939609376197033, 'f1-score': 0.48782086092163873, 'support': 456859}, '2': {'precision': 0.37517369152385366, 'recall': 0.0017064810464731673, 'f1-score': 0.003397508493771235, 'support': 474661}, 'accuracy': 0.3235911568981925, 'macro avg': {'precision': 0.36190334292030424, 'recall': 0.33356554431408464, 'f1-score': 0.16704928768133967, 'support': 1413305}, 'weighted avg': {'precision': 0.36251855323807913, 'recall': 0.3235911568981925, 'f1-score': 0.16221685805032907, 'support': 1413305}}
[[  2423 478734    628]
 [  2038 454100    721]
 [  1795 472056    810]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2757354
{'0': {'precision': 0.36363636363636365, 'recall': 0.0036244687887931424, 'f1-score': 0.007177398372524919, 'support': 110361}, '1': {'precision': 0.33252002059173835, 'recall': 0.9956856843161399, 'f1-score': 0.4985454030626459, 'support': 109635}, '2': {'precision': 0.3489736070381232, 'recall': 0.0010844603215105894, 'f1-score': 0.0021622014481298773, 'support': 109732}, 'accuracy': 0.3326408433618012, 'macro avg': {'precision': 0.34837666375540843, 'recall': 0.3334648711421479, 'f1-score': 0.1692950009611002, 'support': 329728}, 'weighted avg': {'precision': 0.34841043839878716, 'recall': 0.3326408433618012, 'f1-score': 0.16888888057996165, 'support': 329728}}
[[   400 109849    112]
 [   363 109162    110]
 [   337 109276    119]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2948637
{'0': {'precision': 0.3290155440414508, 'recall': 0.0033045378850957534, 'f1-score': 0.006543356174970374, 'support': 38432}, '1': {'precision': 0.31943808626183745, 'recall': 0.9949674280761596, 'f1-score': 0.48361101296442266, 'support': 35767}, '2': {'precision': 0.4, 'recall': 0.0016425146369247888, 'f1-score': 0.00327159516648198, 'support': 37747}, 'accuracy': 0.31958265592339163, 'macro avg': {'precision': 0.34948454343442936, 'recall': 0.33330482686606006, 'f1-score': 0.16447532143529167, 'support': 111946}, 'weighted avg': {'precision': 0.3498907278502866, 'recall': 0.31958265592339163, 'f1-score': 0.15786434770303687, 'support': 111946}}
[[  127 38260    45]
 [  132 35587    48]
 [  127 37558    62]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/AAL
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2794496
{'0': {'precision': 0.4157923799006074, 'recall': 0.0044118594845213846, 'f1-score': 0.008731075905090615, 'support': 512029}, '1': {'precision': 0.32960859762572975, 'recall': 0.9965185792755196, 'f1-score': 0.4953689165627403, 'support': 498647}, '2': {'precision': 0.3842290306378704, 'recall': 0.0015168729812205177, 'f1-score': 0.0030218163288684187, 'support': 504327}, 'accuracy': 0.32998944556545434, 'macro avg': {'precision': 0.3765433360547359, 'recall': 0.3341491039137538, 'f1-score': 0.1690406029322331, 'support': 1515003}, 'weighted avg': {'precision': 0.37691883725834907, 'recall': 0.32998944556545434, 'f1-score': 0.16700215891688505, 'support': 1515003}}
[[  2259 509082    688]
 [  1198 496911    538]
 [  1976 501586    765]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2803875
{'0': {'precision': 0.4440914866581957, 'recall': 0.004520614389652385, 'f1-score': 0.008950121319598717, 'support': 154625}, '1': {'precision': 0.33091355214502244, 'recall': 0.9973653319420894, 'f1-score': 0.49694639993631223, 'support': 153340}, '2': {'precision': 0.4074074074074074, 'recall': 0.0014074415272020062, 'f1-score': 0.0028051921556626626, 'support': 156312}, 'accuracy': 0.3313862198644344, 'macro avg': {'precision': 0.39413748207020854, 'recall': 0.33443112928631463, 'f1-score': 0.16956723780385788, 'support': 464277}, 'weighted avg': {'precision': 0.39436068742821184, 'recall': 0.3313862198644344, 'f1-score': 0.168055188328332, 'support': 464277}}
[[   699 153722    204]
 [   288 152936    116]
 [   587 155505    220]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2367187
{'0': {'precision': 0.43859649122807015, 'recall': 0.005696274636387802, 'f1-score': 0.011246485473289597, 'support': 52666}, '1': {'precision': 0.3629587971002849, 'recall': 0.9962511238146936, 'f1-score': 0.532071027360029, 'support': 58951}, '2': {'precision': 0.36403508771929827, 'recall': 0.0016241390106449592, 'f1-score': 0.0032338502298761007, 'support': 51104}, 'accuracy': 0.363278249273296, 'macro avg': {'precision': 0.38853012534921777, 'recall': 0.3345238458205755, 'f1-score': 0.18218378768773155, 'support': 162721}, 'weighted avg': {'precision': 0.3877775823506705, 'recall': 0.363278249273296, 'f1-score': 0.19741575592569446, 'support': 162721}}
[[  300 52286    80]
 [  156 58730    65]
 [  228 50793    83]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/WBA
Evaluating performance on  test set...
3755/3755 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.162283
{'0': {'precision': 0.3694029850746269, 'recall': 0.0021193924408336277, 'f1-score': 0.004214604242275886, 'support': 280269}, '1': {'precision': 0.42563341626642587, 'recall': 0.9980244160658006, 'f1-score': 0.5967621321360616, 'support': 408993}, '2': {'precision': 0.27205882352941174, 'recall': 0.0005443257716185601, 'f1-score': 0.0010864777565702541, 'support': 271896}, 'accuracy': 0.42545242301473846, 'macro avg': {'precision': 0.3556984082901548, 'recall': 0.33356271142608435, 'f1-score': 0.20068773804496923, 'support': 961158}, 'weighted avg': {'precision': 0.36579313591031637, 'recall': 0.42545242301473846, 'f1-score': 0.25547117808019393, 'support': 961158}}
[[   594 279492    183]
 [   595 408185    213]
 [   419 271329    148]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.259867
{'0': {'precision': 0.3527227722772277, 'recall': 0.0043900861073029466, 'f1-score': 0.008672235154502715, 'support': 129838}, '1': {'precision': 0.3308873317465529, 'recall': 0.9948410678758155, 'f1-score': 0.49660293398721245, 'support': 129678}, '2': {'precision': 0.35014836795252224, 'recall': 0.001778957048740408, 'f1-score': 0.0035399292014159714, 'support': 132662}, 'accuracy': 0.33101040853897973, 'macro avg': {'precision': 0.34458615732543424, 'recall': 0.3336700370106196, 'f1-score': 0.1696050327810437, 'support': 392178}, 'weighted avg': {'precision': 0.3446317985773747, 'recall': 0.33101040853897973, 'f1-score': 0.16827582125795507, 'support': 392178}}
[[   570 129045    223]
 [   454 129009    215]
 [   592 131834    236]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2347196
{'0': {'precision': 0.2835820895522388, 'recall': 0.003550264267791362, 'f1-score': 0.00701273364793968, 'support': 37462}, '1': {'precision': 0.36227635702011524, 'recall': 0.9949797570850203, 'f1-score': 0.5311564088155563, 'support': 43225}, '2': {'precision': 0.4393939393939394, 'recall': 0.0022482943973537316, 'f1-score': 0.004473697742582404, 'support': 38696}, 'accuracy': 0.3620951056683112, 'macro avg': {'precision': 0.3617507953220978, 'recall': 0.33359277191672176, 'f1-score': 0.18088094673535945, 'support': 119383}, 'weighted avg': {'precision': 0.36257872268068597, 'recall': 0.3620951056683112, 'f1-score': 0.19596643581429937, 'support': 119383}}
[[  133 37276    53]
 [  159 43008    58]
 [  177 38432    87]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
4960/4960 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2944154
{'0': {'precision': 0.37249398556535684, 'recall': 0.0021356125460915303, 'f1-score': 0.0042468765571499765, 'support': 435004}, '1': {'precision': 0.30969213929310974, 'recall': 0.9972356863483086, 'f1-score': 0.47261378482483335, 'support': 393226}, '2': {'precision': 0.3357664233576642, 'recall': 0.0007294226913885082, 'f1-score': 0.0014556830408404989, 'support': 441445}, 'accuracy': 0.30983519404572035, 'macro avg': {'precision': 0.33931751607204363, 'recall': 0.3333669071952629, 'f1-score': 0.15943878147427462, 'support': 1269675}, 'weighted avg': {'precision': 0.34027430926943425, 'recall': 0.30983519404572035, 'f1-score': 0.14833247913155748, 'support': 1269675}}
[[   929 433738    337]
 [   787 392139    300]
 [   778 440345    322]]
Evaluating performance on  train set...
1691/1691 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2851664
{'0': {'precision': 0.33553719008264465, 'recall': 0.0026828075647243846, 'f1-score': 0.005323054331864905, 'support': 151334}, '1': {'precision': 0.31558191809929875, 'recall': 0.9958859184211297, 'f1-score': 0.4792852399297501, 'support': 136604}, '2': {'precision': 0.3613138686131387, 'recall': 0.0013664313368253246, 'f1-score': 0.0027225663625550876, 'support': 144903}, 'accuracy': 0.3156956018491779, 'macro avg': {'precision': 0.33747765893169407, 'recall': 0.3333117191075598, 'f1-score': 0.1624436202080567, 'support': 432841}, 'weighted avg': {'precision': 0.3378686422211694, 'recall': 0.3156956018491779, 'f1-score': 0.154034271368136, 'support': 432841}}
[[   406 150757    171]
 [   383 136042    179]
 [   421 144284    198]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.3221768
{'0': {'precision': 0.35764705882352943, 'recall': 0.002798438765741218, 'f1-score': 0.00555342430719205, 'support': 54316}, '1': {'precision': 0.2765828798479744, 'recall': 0.9955277066940904, 'f1-score': 0.4328962010046071, 'support': 41813}, '2': {'precision': 0.36231884057971014, 'recall': 0.0013635371972947421, 'f1-score': 0.00271684990309902, 'support': 55004}, 'accuracy': 0.2769282684787571, 'macro avg': {'precision': 0.3321829264170713, 'recall': 0.33322989421904214, 'f1-score': 0.14705549173829938, 'support': 151133}, 'weighted avg': {'precision': 0.3369198196911896, 'recall': 0.2769282684787571, 'f1-score': 0.12275126054101446, 'support': 151133}}
[[  152 54089    75]
 [  130 41626    57]
 [  143 54786    75]]
testing model on single stock: results/universal/W8/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
10609/10609 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.3447381
{'0': {'precision': 0.41348973607038125, 'recall': 0.0024621939719903607, 'f1-score': 0.004895238425885743, 'support': 1030788}, '1': {'precision': 0.24568080347249513, 'recall': 0.9970650221997044, 'f1-score': 0.3942233893818894, 'support': 667126}, '2': {'precision': 0.36585365853658536, 'recall': 0.0007516484682583273, 'f1-score': 0.0015002147366191634, 'support': 1017763}, 'accuracy': 0.24615261682446035, 'macro avg': {'precision': 0.34167473269315396, 'recall': 0.33342628821331766, 'f1-score': 0.13353961418146476, 'support': 2715677}, 'weighted avg': {'precision': 0.3544135134020278, 'recall': 0.24615261682446035, 'f1-score': 0.09926419413734033, 'support': 2715677}}
[[   2538 1027433     817]
 [   1449  665168     509]
 [   2151 1014847     765]]
Evaluating performance on  train set...
3903/3903 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2667568
{'0': {'precision': 0.35637342908438063, 'recall': 0.003586798413496722, 'f1-score': 0.0071021160250810235, 'support': 332051}, '1': {'precision': 0.3301882998318895, 'recall': 0.9956523584591037, 'f1-score': 0.4959159419458207, 'support': 329834}, '2': {'precision': 0.3494718309859155, 'recall': 0.001177423133843649, 'f1-score': 0.002346939077126803, 'support': 337177}, 'accuracy': 0.33029781935455454, 'macro avg': {'precision': 0.34534451996739524, 'recall': 0.3334721933354814, 'f1-score': 0.1684549990160095, 'support': 999062}, 'weighted avg': {'precision': 0.3453993293148845, 'recall': 0.33029781935455454, 'f1-score': 0.16687606715219916, 'support': 999062}}
[[  1191 330477    383]
 [  1078 328400    356]
 [  1073 335707    397]]
Evaluating performance on  val set...
1144/1144 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2801774
{'0': {'precision': 0.35251798561151076, 'recall': 0.005328087621834286, 'f1-score': 0.010497511953335736, 'support': 101162}, '1': {'precision': 0.3125897212573541, 'recall': 0.9910177353342429, 'f1-score': 0.47526877217959324, 'support': 91625}, '2': {'precision': 0.25120772946859904, 'recall': 0.0015624061054023196, 'f1-score': 0.0031054973274806654, 'support': 99846}, 'accuracy': 0.31266808596433077, 'macro avg': {'precision': 0.30543847877915464, 'recall': 0.33263607635382647, 'f1-score': 0.16295726048680323, 'support': 292633}, 'weighted avg': {'precision': 0.3054492987023284, 'recall': 0.31266808596433077, 'f1-score': 0.15349780114115025, 'support': 292633}}
[[   539 100407    216]
 [   574  90802    249]
 [   416  99274    156]]
training model: results/universal/W8/deepOF_L2/h500
Epoch 1/50
7695/7695 - 173s - loss: 3.2641 - accuracy500: 0.3811 - val_loss: 3.4515 - val_accuracy500: 0.3210 - 173s/epoch - 22ms/step
Epoch 2/50
7695/7695 - 169s - loss: 3.2432 - accuracy500: 0.3913 - val_loss: 3.4416 - val_accuracy500: 0.3222 - 169s/epoch - 22ms/step
Epoch 3/50
7695/7695 - 170s - loss: 3.2358 - accuracy500: 0.3954 - val_loss: 3.4443 - val_accuracy500: 0.3217 - 170s/epoch - 22ms/step
Epoch 4/50
7695/7695 - 170s - loss: 3.2310 - accuracy500: 0.3973 - val_loss: 3.4734 - val_accuracy500: 0.3218 - 170s/epoch - 22ms/step
Epoch 5/50
7695/7695 - 172s - loss: 3.2284 - accuracy500: 0.3990 - val_loss: 3.4854 - val_accuracy500: 0.3226 - 172s/epoch - 22ms/step
Epoch 6/50
7695/7695 - 170s - loss: 3.2260 - accuracy500: 0.4005 - val_loss: 3.5048 - val_accuracy500: 0.3228 - 170s/epoch - 22ms/step
Epoch 7/50
7695/7695 - 169s - loss: 3.2242 - accuracy500: 0.4010 - val_loss: 3.4936 - val_accuracy500: 0.3241 - 169s/epoch - 22ms/step
Epoch 8/50
7695/7695 - 174s - loss: 3.2225 - accuracy500: 0.4023 - val_loss: 3.4984 - val_accuracy500: 0.3246 - 174s/epoch - 23ms/step
Epoch 9/50
7695/7695 - 172s - loss: 3.2211 - accuracy500: 0.4032 - val_loss: 3.4911 - val_accuracy500: 0.3251 - 172s/epoch - 22ms/step
Epoch 10/50
7695/7695 - 171s - loss: 3.2198 - accuracy500: 0.4041 - val_loss: 3.4965 - val_accuracy500: 0.3260 - 171s/epoch - 22ms/step
Epoch 11/50
7695/7695 - 169s - loss: 3.2185 - accuracy500: 0.4049 - val_loss: 3.5087 - val_accuracy500: 0.3244 - 169s/epoch - 22ms/step
Epoch 12/50
7695/7695 - 168s - loss: 3.2173 - accuracy500: 0.4058 - val_loss: 3.5088 - val_accuracy500: 0.3256 - 168s/epoch - 22ms/step
testing model in sample: results/universal/W8/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.167018
{'0': {'precision': 0.3797224992016475, 'recall': 0.02719904246673118, 'f1-score': 0.05076206257851937, 'support': 2142171}, '1': {'precision': 0.2890116976177466, 'recall': 0.9755991663772143, 'f1-score': 0.4459230571187955, 'support': 1715884}, '2': {'precision': 0.3745832516179643, 'recall': 0.002724824146602197, 'f1-score': 0.005410292302136027, 'support': 2102888}, 'accuracy': 0.2915662840594181, 'macro avg': {'precision': 0.3477724828124528, 'recall': 0.3351743443301826, 'f1-score': 0.1673651373331503, 'support': 5960943}, 'weighted avg': {'precision': 0.3517979786790143, 'recall': 0.2915662840594181, 'f1-score': 0.14851182037066465, 'support': 5960943}}
[[  58265 2078331    5575]
 [  37877 1674015    3992]
 [  57299 2039859    5730]]
Evaluating performance on  train set...
7695/7695 - 62s - 62s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1428059
{'0': {'precision': 0.3633802144272786, 'recall': 0.02328000562954532, 'f1-score': 0.043756730062840275, 'support': 653694}, '1': {'precision': 0.3312702115527883, 'recall': 0.9798296569287468, 'f1-score': 0.4951390592577933, 'support': 649865}, '2': {'precision': 0.37108078199926225, 'recall': 0.003021429322280789, 'f1-score': 0.005994053612817503, 'support': 665910}, 'accuracy': 0.3320626016454181, 'macro avg': {'precision': 0.3552437359931097, 'recall': 0.3353770306268576, 'f1-score': 0.18162994764448367, 'support': 1969469}, 'weighted avg': {'precision': 0.3553885770538693, 'recall': 0.3320626016454181, 'f1-score': 0.1799310153587467, 'support': 1969469}}
[[ 15218 636605   1871]
 [ 11569 636757   1539]
 [ 15092 648806   2012]]
Evaluating performance on  val set...
2338/2338 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1492552
{'0': {'precision': 0.356976003397749, 'recall': 0.02481180811808118, 'f1-score': 0.04639865303136946, 'support': 203250}, '1': {'precision': 0.3216450596107119, 'recall': 0.9747459481994893, 'f1-score': 0.48368465489977547, 'support': 191890}, '2': {'precision': 0.31188351338656645, 'recall': 0.003276763110753606, 'f1-score': 0.0064853883419284265, 'support': 202639}, 'accuracy': 0.32244525150599135, 'macro avg': {'precision': 0.33016819213167575, 'recall': 0.3342781731427747, 'f1-score': 0.17885623209102444, 'support': 597779}, 'weighted avg': {'precision': 0.3303488520815091, 'recall': 0.32244525150599135, 'f1-score': 0.17323955385780326, 'support': 597779}}
[[  5043 197495    712]
 [  4093 187044    753]
 [  4991 196984    664]]
testing model out of sample: results/universal/W8/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 114s - 114s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1686965
{'0': {'precision': 0.36704751358969195, 'recall': 0.011691682672421256, 'f1-score': 0.02266152062920873, 'support': 1247468}, '1': {'precision': 0.30931736279888344, 'recall': 0.9877599938419567, 'f1-score': 0.47110731647447424, 'support': 1117238}, '2': {'precision': 0.3533774532177088, 'recall': 0.0024745691477078874, 'f1-score': 0.004914722346752149, 'support': 1251531}, 'accuracy': 0.3100584945068589, 'macro avg': {'precision': 0.3432474432020947, 'recall': 0.3339754152206953, 'f1-score': 0.16622785315014504, 'support': 3616237}, 'weighted avg': {'precision': 0.34448073421748, 'recall': 0.3100584945068589, 'f1-score': 0.1550671167937664, 'support': 3616237}}
[[  14585 1229843    3040]
 [  11048 1103563    2627]
 [  14103 1234331    3097]]
Evaluating performance on  train set...
4550/4550 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1522954
{'0': {'precision': 0.3671647846372304, 'recall': 0.01391426455552509, 'f1-score': 0.026812431487571474, 'support': 390247}, '1': {'precision': 0.3311052253233112, 'recall': 0.9872848068008595, 'f1-score': 0.4959005308730856, 'support': 384422}, '2': {'precision': 0.3478964401294498, 'recall': 0.002760132897189543, 'f1-score': 0.005476813971734546, 'support': 389474}, 'accuracy': 0.3316078866599722, 'macro avg': {'precision': 0.3487221500299971, 'recall': 0.3346530680845247, 'f1-score': 0.17606325877746387, 'support': 1164143}, 'weighted avg': {'precision': 0.34881084777603827, 'recall': 0.3316078866599722, 'f1-score': 0.1745761658789779, 'support': 1164143}}
[[  5430 383712   1105]
 [  3978 379534    910]
 [  5381 383018   1075]]
Evaluating performance on  val set...
1570/1570 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1557814
{'0': {'precision': 0.38653846153846155, 'recall': 0.01469835466179159, 'f1-score': 0.02831983092638253, 'support': 136750}, '1': {'precision': 0.3232486980485927, 'recall': 0.9871516201644531, 'f1-score': 0.48701983899066736, 'support': 129277}, '2': {'precision': 0.3674059787849566, 'recall': 0.0028221804121420424, 'f1-score': 0.005601334911312197, 'support': 135002}, 'accuracy': 0.32418353784888376, 'macro avg': {'precision': 0.35906437945733694, 'recall': 0.33489071841279555, 'f1-score': 0.17364700160945404, 'support': 401029}, 'weighted avg': {'precision': 0.3596954297592923, 'recall': 0.32418353784888376, 'f1-score': 0.16853991112881184, 'support': 401029}}
[[  2010 134403    337]
 [  1342 127616    319]
 [  1848 132773    381]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1838067
{'0': {'precision': 0.37502009323259927, 'recall': 0.0367592607181685, 'f1-score': 0.06695557341292618, 'support': 63467}, '1': {'precision': 0.23163856139928082, 'recall': 0.955926614148499, 'f1-score': 0.37291336974832817, 'support': 38209}, '2': {'precision': 0.3952802359882006, 'recall': 0.006356434704236042, 'f1-score': 0.012511671335200748, 'support': 63243}, 'accuracy': 0.23805625792055493, 'macro avg': {'precision': 0.3339796302066936, 'recall': 0.33301410319030117, 'f1-score': 0.15079353816548505, 'support': 164919}, 'weighted avg': {'precision': 0.34957031036023906, 'recall': 0.23805625792055493, 'f1-score': 0.1169628238878732, 'support': 164919}}
[[ 2333 60748   386]
 [ 1455 36525   229]
 [ 2433 60408   402]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1229689
{'0': {'precision': 0.3516778523489933, 'recall': 0.04162474183127681, 'f1-score': 0.07443886731698078, 'support': 18883}, '1': {'precision': 0.3321442944426152, 'recall': 0.9614508869473127, 'f1-score': 0.4937254422101672, 'support': 18885}, '2': {'precision': 0.3359683794466403, 'recall': 0.004384607448674301, 'f1-score': 0.008656245226335353, 'support': 19386}, 'accuracy': 0.33292507960947615, 'macro avg': {'precision': 0.33993017541274956, 'recall': 0.33582007874242126, 'f1-score': 0.1922735182511611, 'support': 57154}, 'weighted avg': {'precision': 0.33989503605009963, 'recall': 0.33292507960947615, 'f1-score': 0.19066809108099683, 'support': 57154}}
[[  786 18000    97]
 [  657 18157    71]
 [  792 18509    85]]
Evaluating performance on  val set...
68/68 - 1s - 710ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1505226
{'0': {'precision': 0.39109697933227344, 'recall': 0.03722760290556901, 'f1-score': 0.06798397125880891, 'support': 6608}, '1': {'precision': 0.29020746386015844, 'recall': 0.9621014638058953, 'f1-score': 0.445910780669145, 'support': 4987}, '2': {'precision': 0.3287671232876712, 'recall': 0.00425531914893617, 'f1-score': 0.008401890425345702, 'support': 5640}, 'accuracy': 0.29405279953582825, 'macro avg': {'precision': 0.3366905221600344, 'recall': 0.33452812862013354, 'f1-score': 0.17409888078443322, 'support': 17235}, 'weighted avg': {'precision': 0.3415073998863208, 'recall': 0.29405279953582825, 'f1-score': 0.15784054582385756, 'support': 17235}}
[[ 246 6327   35]
 [ 175 4798   14]
 [ 208 5408   24]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.204466
{'0': {'precision': 0.3948412698412698, 'recall': 0.003745952864995106, 'f1-score': 0.007421496233310957, 'support': 212496}, '1': {'precision': 0.2773798594188809, 'recall': 0.9941430870973372, 'f1-score': 0.43374013893628843, 'support': 154689}, '2': {'precision': 0.4078751857355126, 'recall': 0.002880528883991815, 'f1-score': 0.005720656885628542, 'support': 190590}, 'accuracy': 0.27811931334319395, 'macro avg': {'precision': 0.3600321049985545, 'recall': 0.333589856282108, 'f1-score': 0.14896076401840933, 'support': 557775}, 'weighted avg': {'precision': 0.366719080631382, 'recall': 0.27811931334319395, 'f1-score': 0.12507223631633024, 'support': 557775}}
[[   796 211265    435]
 [   544 153783    362]
 [   676 189365    549]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1627365
{'0': {'precision': 0.3592592592592593, 'recall': 0.005413248507171159, 'f1-score': 0.010665787014129418, 'support': 53757}, '1': {'precision': 0.3303633329053794, 'recall': 0.9934751553994055, 'f1-score': 0.49584260677708086, 'support': 51802}, '2': {'precision': 0.31983805668016196, 'recall': 0.0030664725861232413, 'f1-score': 0.006074703473730752, 'support': 51525}, 'accuracy': 0.33047923404038604, 'macro avg': {'precision': 0.33648688294826684, 'recall': 0.3339849588308999, 'f1-score': 0.170861032421647, 'support': 157084}, 'weighted avg': {'precision': 0.3367996564997696, 'recall': 0.33047923404038604, 'f1-score': 0.16915789338996254, 'support': 157084}}
[[  291 53275   191]
 [  193 51464   145]
 [  326 51041   158]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.171452
{'0': {'precision': 0.3546511627906977, 'recall': 0.0036236188665795415, 'f1-score': 0.0071739386099023885, 'support': 16834}, '1': {'precision': 0.32576370310458536, 'recall': 0.9928575943366412, 'f1-score': 0.4905683947532792, 'support': 15821}, '2': {'precision': 0.31952662721893493, 'recall': 0.0033951587551084563, 'f1-score': 0.00671892497200448, 'support': 15905}, 'accuracy': 0.32584431630971994, 'macro avg': {'precision': 0.3333138310380727, 'recall': 0.33329212398610975, 'f1-score': 0.16815375277839537, 'support': 48560}, 'weighted avg': {'precision': 0.3337350952873437, 'recall': 0.32584431630971994, 'f1-score': 0.16451633355911155, 'support': 48560}}
[[   61 16719    54]
 [   52 15708    61]
 [   59 15792    54]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0360154
{'0': {'precision': 0.3032554074721433, 'recall': 0.018908536086968367, 'f1-score': 0.035597502019670955, 'support': 73406}, '1': {'precision': 0.4908982015434898, 'recall': 0.9865197595565276, 'f1-score': 0.6555772144435583, 'support': 145398}, '2': {'precision': 0.3075801749271137, 'recall': 0.002682635339588578, 'f1-score': 0.005318880766322157, 'support': 78654}, 'accuracy': 0.4875881637071452, 'macro avg': {'precision': 0.36724459464758225, 'recall': 0.33603697699436147, 'f1-score': 0.23216453240985047, 'support': 297458}, 'weighted avg': {'precision': 0.3961190965703988, 'recall': 0.4875881637071452, 'f1-score': 0.330638400401787, 'support': 297458}}
[[  1388  71806    212]
 [  1697 143438    263]
 [  1492  76951    211]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1164942
{'0': {'precision': 0.3609467455621302, 'recall': 0.03040119611263394, 'f1-score': 0.05607906228453229, 'support': 28091}, '1': {'precision': 0.34804896426498017, 'recall': 0.9735005527915975, 'f1-score': 0.5127705844350825, 'support': 28944}, '2': {'precision': 0.29343629343629346, 'recall': 0.0028628470260293067, 'f1-score': 0.005670372304707902, 'support': 26547}, 'accuracy': 0.3482448374051829, 'macro avg': {'precision': 0.33414400108780123, 'recall': 0.3355881986434202, 'f1-score': 0.19150667300810756, 'support': 83582}, 'weighted avg': {'precision': 0.33503789731191724, 'recall': 0.3482448374051829, 'f1-score': 0.19821827795574296, 'support': 83582}}
[[  854 27126   111]
 [  695 28177    72]
 [  817 25654    76]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958024
{'0': {'precision': 0.32968536251709984, 'recall': 0.02479168809793231, 'f1-score': 0.046115575966322236, 'support': 9721}, '1': {'precision': 0.3933335486579891, 'recall': 0.9795688545688546, 'f1-score': 0.5612886871154333, 'support': 12432}, '2': {'precision': 0.41, 'recall': 0.004253553273161116, 'f1-score': 0.008419755621727077, 'support': 9639}, 'accuracy': 0.39192249622546554, 'macro avg': {'precision': 0.3776729703916963, 'recall': 0.33620469864664937, 'f1-score': 0.20527467290116086, 'support': 31792}, 'weighted avg': {'precision': 0.37892501528512984, 'recall': 0.39192249622546554, 'f1-score': 0.23614080575696758, 'support': 31792}}
[[  241  9447    33]
 [  228 12178    26]
 [  262  9336    41]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081784
{'0': {'precision': 0.30960899565550726, 'recall': 0.07205662229007029, 'f1-score': 0.11690536117789913, 'support': 100879}, '1': {'precision': 0.35205641239405305, 'recall': 0.9198918094684868, 'f1-score': 0.509224832686858, 'support': 110176}, '2': {'precision': 0.3143712574850299, 'recall': 0.005148421641022623, 'f1-score': 0.010130930212363592, 'support': 101973}, 'accuracy': 0.3486716843221693, 'macro avg': {'precision': 0.32534555517819674, 'recall': 0.3323656177998599, 'f1-score': 0.21208704135904025, 'support': 313028}, 'weighted avg': {'precision': 0.3261005194557038, 'recall': 0.3486716843221693, 'f1-score': 0.22020628328110556, 'support': 313028}}
[[  7269  93054    556]
 [  8237 101350    589]
 [  7972  93476    525]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146476
{'0': {'precision': 0.33116225213489653, 'recall': 0.07663194560739525, 'f1-score': 0.12446281890877442, 'support': 29857}, '1': {'precision': 0.3322739230320561, 'recall': 0.9221976279361723, 'f1-score': 0.4885279756383556, 'support': 30269}, '2': {'precision': 0.38276553106212424, 'recall': 0.006103991563069253, 'f1-score': 0.012016357345077068, 'support': 31291}, 'accuracy': 0.3324655151667633, 'macro avg': {'precision': 0.34873390207635896, 'recall': 0.3349778550355456, 'f1-score': 0.20833571729740238, 'support': 91417}, 'weighted avg': {'precision': 0.3491935523011458, 'recall': 0.3324655151667633, 'f1-score': 0.20651895726660763, 'support': 91417}}
[[ 2288 27398   171]
 [ 2218 27914   137]
 [ 2403 28697   191]]
Evaluating performance on  val set...
99/99 - 1s - 936ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014314
{'0': {'precision': 0.32983193277310924, 'recall': 0.07742571816052275, 'f1-score': 0.1254118821767349, 'support': 8111}, '1': {'precision': 0.3687564588356872, 'recall': 0.9193773483628556, 'f1-score': 0.5263837241464089, 'support': 9315}, '2': {'precision': 0.31007751937984496, 'recall': 0.005107904482186183, 'f1-score': 0.010050251256281407, 'support': 7831}, 'accuracy': 0.3655224294255058, 'macro avg': {'precision': 0.3362219703295472, 'recall': 0.3339703236685215, 'f1-score': 0.2206152858598084, 'support': 25257}, 'weighted avg': {'precision': 0.33806272617653255, 'recall': 0.3655224294255058, 'f1-score': 0.23752558436660076, 'support': 25257}}
[[ 628 7441   42]
 [ 704 8564   47]
 [ 572 7219   40]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1142453
{'0': {'precision': 0.350921764054459, 'recall': 0.04511611936048508, 'f1-score': 0.07995309972245722, 'support': 119403}, '1': {'precision': 0.3434472554943965, 'recall': 0.9602120544558378, 'f1-score': 0.5059330950631304, 'support': 126194}, '2': {'precision': 0.2861356932153392, 'recall': 0.002354654691103289, 'f1-score': 0.004670872056628304, 'support': 123585}, 'accuracy': 0.34360017552318367, 'macro avg': {'precision': 0.32683490425473155, 'recall': 0.3358942761691421, 'f1-score': 0.196852355614072, 'support': 369182}, 'weighted avg': {'precision': 0.3266794534925108, 'recall': 0.34360017552318367, 'f1-score': 0.20036082660496896, 'support': 369182}}
[[  5387 113625    391]
 [  4686 121173    335]
 [  5278 118016    291]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118061
{'0': {'precision': 0.3409299761073332, 'recall': 0.04526708802069353, 'f1-score': 0.07992244722102543, 'support': 40979}, '1': {'precision': 0.3340586872202058, 'recall': 0.9622248803827751, 'f1-score': 0.49594022231675516, 'support': 41800}, '2': {'precision': 0.348993288590604, 'recall': 0.003585382670650425, 'f1-score': 0.0070978456218577235, 'support': 43510}, 'accuracy': 0.33440758894282163, 'macro avg': {'precision': 0.34132731730604765, 'recall': 0.33702578369137304, 'f1-score': 0.19432017171987948, 'support': 126289}, 'weighted avg': {'precision': 0.34143370050664895, 'recall': 0.33440758894282163, 'f1-score': 0.1925288071052728, 'support': 126289}}
[[ 1855 38945   179]
 [ 1467 40221   112]
 [ 2119 41235   156]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1221794
{'0': {'precision': 0.35023348899266177, 'recall': 0.042994021783637704, 'f1-score': 0.07658643326039387, 'support': 12211}, '1': {'precision': 0.332895923890757, 'recall': 0.9653559537022356, 'f1-score': 0.4950704368507715, 'support': 12614}, '2': {'precision': 0.37142857142857144, 'recall': 0.0019515124221271486, 'f1-score': 0.003882625251997312, 'support': 13323}, 'accuracy': 0.33364789766173847, 'macro avg': {'precision': 0.3515193281039967, 'recall': 0.3367671626360002, 'f1-score': 0.1918464984543876, 'support': 38148}, 'weighted avg': {'precision': 0.35190293528337685, 'recall': 0.33364789766173847, 'f1-score': 0.18957071519373653, 'support': 38148}}
[[  525 11664    22]
 [  415 12177    22]
 [  559 12738    26]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/EXC
Evaluating performance on  test set...
5521/5521 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1808203
{'0': {'precision': 0.3780214861235452, 'recall': 0.003408072834693334, 'f1-score': 0.006755243412737772, 'support': 495588}, '1': {'precision': 0.29803000039165, 'recall': 0.9939417543976309, 'f1-score': 0.4585618228174301, 'support': 421079}, '2': {'precision': 0.375718708536046, 'recall': 0.003421002822981729, 'f1-score': 0.006780269774124032, 'support': 496638}, 'accuracy': 0.2985314564089139, 'macro avg': {'precision': 0.3505900650170804, 'recall': 0.333590276685102, 'f1-score': 0.15736577866809728, 'support': 1413305}, 'weighted avg': {'precision': 0.35337968433553685, 'recall': 0.2985314564089139, 'f1-score': 0.1413749409947987, 'support': 1413305}}
[[  1689 492402   1497]
 [  1225 418528   1326]
 [  1554 493385   1699]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1557852
{'0': {'precision': 0.35124905374716126, 'recall': 0.004231530373086008, 'f1-score': 0.008362319101771588, 'support': 109653}, '1': {'precision': 0.33031969770039865, 'recall': 0.9942396207520648, 'f1-score': 0.495888596899207, 'support': 108847}, '2': {'precision': 0.36942675159235666, 'recall': 0.002607257165461934, 'f1-score': 0.005177970414148358, 'support': 111228}, 'accuracy': 0.3304966517857143, 'macro avg': {'precision': 0.35033183434663884, 'recall': 0.3336928027635376, 'f1-score': 0.16980962880504233, 'support': 329728}, 'weighted avg': {'precision': 0.35047196280645687, 'recall': 0.3304966517857143, 'f1-score': 0.1682261584590312, 'support': 329728}}
[[   464 108931    258]
 [   390 108220    237]
 [   467 110471    290]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1666653
{'0': {'precision': 0.36075949367088606, 'recall': 0.00293761434792692, 'f1-score': 0.005827773943715972, 'support': 38807}, '1': {'precision': 0.3184014369106421, 'recall': 0.994585799646534, 'f1-score': 0.4823771913712524, 'support': 35647}, '2': {'precision': 0.3464285714285714, 'recall': 0.002587218606636082, 'f1-score': 0.00513607963570899, 'support': 37492}, 'accuracy': 0.31859110642631266, 'macro avg': {'precision': 0.34186316733669986, 'recall': 0.3333702108670324, 'f1-score': 0.16444701498355913, 'support': 111946}, 'weighted avg': {'precision': 0.3424718140214008, 'recall': 0.31859110642631266, 'f1-score': 0.15734389850416114, 'support': 111946}}
[[  114 38603    90]
 [  100 35454    93]
 [  102 37293    97]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/AAL
Evaluating performance on  test set...
5918/5918 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1742176
{'0': {'precision': 0.3606291926902614, 'recall': 0.0029931267519103023, 'f1-score': 0.005936978158089656, 'support': 520860}, '1': {'precision': 0.32359052601470245, 'recall': 0.9944951171954672, 'f1-score': 0.48829785795796227, 'support': 490292}, '2': {'precision': 0.34594454521896867, 'recall': 0.0026495928359773027, 'f1-score': 0.005258907644127553, 'support': 503851}, 'accuracy': 0.32375315428418294, 'macro avg': {'precision': 0.3433880879746442, 'recall': 0.33337927892778496, 'f1-score': 0.1664979145867265, 'support': 1515003}, 'weighted avg': {'precision': 0.34375883911686816, 'recall': 0.32375315428418294, 'f1-score': 0.16181523976701637, 'support': 1515003}}
[[  1559 518083   1218]
 [  1393 487593   1306]
 [  1371 501145   1335]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1711339
{'0': {'precision': 0.34903225806451615, 'recall': 0.003504090264328879, 'f1-score': 0.006938521620356417, 'support': 154391}, '1': {'precision': 0.3302039445894573, 'recall': 0.9949221681950201, 'f1-score': 0.4958429561200924, 'support': 153215}, '2': {'precision': 0.34935304990757854, 'recall': 0.002412699223212975, 'f1-score': 0.004792301889662954, 'support': 156671}, 'accuracy': 0.3303114304606948, 'macro avg': {'precision': 0.342863084187184, 'recall': 0.33361298589418736, 'f1-score': 0.16919125987670391, 'support': 464277}, 'weighted avg': {'precision': 0.3429270207380134, 'recall': 0.3303114304606948, 'f1-score': 0.167556520229914, 'support': 464277}}
[[   541 153459    391]
 [   465 152437    313]
 [   544 155749    378]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1545311
{'0': {'precision': 0.34146341463414637, 'recall': 0.002860805112295889, 'f1-score': 0.0056740724365351315, 'support': 53831}, '1': {'precision': 0.34993172395469685, 'recall': 0.9950802965878343, 'f1-score': 0.5177800024684924, 'support': 56914}, '2': {'precision': 0.36768149882903983, 'recall': 0.0030206249038017548, 'f1-score': 0.005992023357441368, 'support': 51976}, 'accuracy': 0.3499548306610702, 'macro avg': {'precision': 0.353025545805961, 'recall': 0.3336539088679773, 'f1-score': 0.17648203275415633, 'support': 162721}, 'weighted avg': {'precision': 0.3527998524681296, 'recall': 0.3499548306610702, 'f1-score': 0.18489201430577046, 'support': 162721}}
[[  154 53552   125]
 [  135 56634   145]
 [  162 51657   157]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/WBA
Evaluating performance on  test set...
3755/3755 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1248238
{'0': {'precision': 0.3716304632295211, 'recall': 0.013748543654853462, 'f1-score': 0.02651611818968361, 'support': 309851}, '1': {'precision': 0.3687387339904074, 'recall': 0.990048681082305, 'f1-score': 0.5373457145709962, 'support': 353320}, '2': {'precision': 0.34258373205741627, 'recall': 0.0012013946917147392, 'f1-score': 0.002394392573370074, 'support': 297987}, 'accuracy': 0.3687447849365037, 'macro avg': {'precision': 0.36098430975911494, 'recall': 0.3349995398096244, 'f1-score': 0.18875207511134995, 'support': 961158}, 'weighted avg': {'precision': 0.36156213517466884, 'recall': 0.3687447849365037, 'f1-score': 0.20681774637382913, 'support': 961158}}
[[  4260 305208    383]
 [  3212 349804    304]
 [  3991 293638    358]]
Evaluating performance on  train set...
1532/1532 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1383514
{'0': {'precision': 0.4029407164085719, 'recall': 0.019797566805259882, 'f1-score': 0.03774082484799648, 'support': 130117}, '1': {'precision': 0.3326233886466062, 'recall': 0.9869975538424737, 'f1-score': 0.49756480876357634, 'support': 129591}, '2': {'precision': 0.38621794871794873, 'recall': 0.0036385596738884277, 'f1-score': 0.007209201453805771, 'support': 132470}, 'accuracy': 0.3339402006231864, 'macro avg': {'precision': 0.3739273512577089, 'recall': 0.33681122677387393, 'f1-score': 0.1808382783551262, 'support': 392178}, 'weighted avg': {'precision': 0.37405649073049274, 'recall': 0.3339402006231864, 'f1-score': 0.17937173160098993, 'support': 392178}}
[[  2576 127088    453]
 [  1372 127906    313]
 [  2445 129543    482]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1502861
{'0': {'precision': 0.3620885357548241, 'recall': 0.016201940169637868, 'f1-score': 0.031016042780748657, 'support': 39378}, '1': {'precision': 0.3220823067020197, 'recall': 0.9857787751480834, 'f1-score': 0.4855284803619165, 'support': 38323}, '2': {'precision': 0.39939024390243905, 'recall': 0.003142843433616429, 'f1-score': 0.006236610330873602, 'support': 41682}, 'accuracy': 0.3228851679049781, 'macro avg': {'precision': 0.3611870287864276, 'recall': 0.33504118625044593, 'f1-score': 0.17426037782451295, 'support': 119383}, 'weighted avg': {'precision': 0.36226989392992665, 'recall': 0.3228851679049781, 'f1-score': 0.16826693982678873, 'support': 119383}}
[[  638 38631   109]
 [  457 37778    88]
 [  667 40884   131]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
4960/4960 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2071128
{'0': {'precision': 0.42183046553362186, 'recall': 0.008496126140683602, 'f1-score': 0.016656766811517176, 'support': 470332}, '1': {'precision': 0.25026588345640544, 'recall': 0.9927698686720585, 'f1-score': 0.399757493421533, 'support': 317145}, '2': {'precision': 0.3982176360225141, 'recall': 0.0017606875184053023, 'f1-score': 0.0035058740941093882, 'support': 482198}, 'accuracy': 0.2517943568235966, 'macro avg': {'precision': 0.3567713283375138, 'recall': 0.3343422274437158, 'f1-score': 0.1399733781090532, 'support': 1269675}, 'weighted avg': {'precision': 0.37000861462888174, 'recall': 0.2517943568235966, 'f1-score': 0.10735489489483366, 'support': 1269675}}
[[  3996 465476    860]
 [  1870 314852    423]
 [  3607 477742    849]]
Evaluating performance on  train set...
1691/1691 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1530656
{'0': {'precision': 0.389062945029906, 'recall': 0.009235782911773257, 'f1-score': 0.018043245670809834, 'support': 147903}, '1': {'precision': 0.32803313673573264, 'recall': 0.9923293167017474, 'f1-score': 0.49307203122148435, 'support': 141578}, '2': {'precision': 0.3649425287356322, 'recall': 0.0026576450892857144, 'f1-score': 0.005276862136782915, 'support': 143360}, 'accuracy': 0.328617205856192, 'macro avg': {'precision': 0.360679536833757, 'recall': 0.33474091490093544, 'f1-score': 0.17213071300969238, 'support': 432841}, 'weighted avg': {'precision': 0.36111184733209184, 'recall': 0.328617205856192, 'f1-score': 0.16919213558016521, 'support': 432841}}
[[  1366 146174    363]
 [   786 140492    300]
 [  1359 141620    381]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.178933
{'0': {'precision': 0.4214963119072708, 'recall': 0.014711561448353224, 'f1-score': 0.028430797661566892, 'support': 54379}, '1': {'precision': 0.28129051326316074, 'recall': 0.9892747460429955, 'f1-score': 0.4380311818452833, 'support': 42330}, '2': {'precision': 0.3269230769230769, 'recall': 0.002186535352050566, 'f1-score': 0.004344016938015624, 'support': 54424}, 'accuracy': 0.28316118915127736, 'macro avg': {'precision': 0.3432366340311695, 'recall': 0.33539094761446636, 'f1-score': 0.15693533214828861, 'support': 151133}, 'weighted avg': {'precision': 0.34817039898696256, 'recall': 0.28316118915127736, 'f1-score': 0.13447967718091847, 'support': 151133}}
[[  800 53436   143]
 [  352 41876   102]
 [  746 53559   119]]
testing model on single stock: results/universal/W8/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
10609/10609 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1738627
{'0': {'precision': 0.3939068869341343, 'recall': 0.04305828757706255, 'f1-score': 0.07763069922068037, 'support': 1023357}, '1': {'precision': 0.2504504400430512, 'recall': 0.9612426472761668, 'f1-score': 0.39736736392726496, 'support': 676620}, '2': {'precision': 0.37478286045165027, 'recall': 0.0025489809983262773, 'f1-score': 0.005063523852737314, 'support': 1015700}, 'accuracy': 0.2566759596225913, 'macro avg': {'precision': 0.3397133958096119, 'recall': 0.33561663861718527, 'f1-score': 0.16002052900022756, 'support': 2715677}, 'weighted avg': {'precision': 0.35101158871063287, 'recall': 0.2566759596225913, 'f1-score': 0.13015305075679806, 'support': 2715677}}
[[ 44064 976509   2784]
 [ 24689 650396   1535]
 [ 43111 970000   2589]]
Evaluating performance on  train set...
3903/3903 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1395721
{'0': {'precision': 0.36040703052728956, 'recall': 0.02948745118222276, 'f1-score': 0.05451467110694447, 'support': 330310}, '1': {'precision': 0.33120812186929227, 'recall': 0.9750816745406187, 'f1-score': 0.4944614448973622, 'support': 329356}, '2': {'precision': 0.3583887043189369, 'recall': 0.0025427524190031704, 'f1-score': 0.005049677593006519, 'support': 339396}, 'accuracy': 0.33206347554005655, 'macro avg': {'precision': 0.35000128557183957, 'recall': 0.33570395938061487, 'f1-score': 0.18467526453243777, 'support': 999062}, 'weighted avg': {'precision': 0.35009551071993683, 'recall': 0.33206347554005655, 'f1-score': 0.18274584063382102, 'support': 999062}}
[[  9740 319744    826]
 [  7488 321149    719]
 [  9797 328736    863]]
Evaluating performance on  val set...
1144/1144 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1429504
{'0': {'precision': 0.3579184593321041, 'recall': 0.03489812225329605, 'f1-score': 0.06359549334740905, 'support': 100120}, '1': {'precision': 0.3178641190467735, 'recall': 0.9646167442662528, 'f1-score': 0.4781623810617757, 'support': 92784}, '2': {'precision': 0.29515757109915447, 'recall': 0.0038504346779773186, 'f1-score': 0.007601702464614471, 'support': 99729}, 'accuracy': 0.31909934969740256, 'macro avg': {'precision': 0.32364671649267734, 'recall': 0.33445510039917536, 'f1-score': 0.18311985895793306, 'support': 292633}, 'weighted avg': {'precision': 0.3238297457160118, 'recall': 0.31909934969740256, 'f1-score': 0.17595797242099123, 'support': 292633}}
[[ 3494 96174   452]
 [ 2818 89501   465]
 [ 3450 95895   384]]
training model: results/universal/W8/deepOF_L2/h1000
Epoch 1/50
7695/7695 - 174s - loss: 3.2733 - accuracy1000: 0.3716 - val_loss: 3.2938 - val_accuracy1000: 0.3439 - 174s/epoch - 23ms/step
Epoch 2/50
7695/7695 - 170s - loss: 3.2624 - accuracy1000: 0.3792 - val_loss: 3.3097 - val_accuracy1000: 0.3207 - 170s/epoch - 22ms/step
Epoch 3/50
7695/7695 - 168s - loss: 3.2459 - accuracy1000: 0.3901 - val_loss: 3.3109 - val_accuracy1000: 0.3181 - 168s/epoch - 22ms/step
Epoch 4/50
7695/7695 - 168s - loss: 3.2390 - accuracy1000: 0.3950 - val_loss: 3.3055 - val_accuracy1000: 0.3237 - 168s/epoch - 22ms/step
Epoch 5/50
7695/7695 - 169s - loss: 3.2345 - accuracy1000: 0.3973 - val_loss: 3.3061 - val_accuracy1000: 0.3234 - 169s/epoch - 22ms/step
Epoch 6/50
7695/7695 - 169s - loss: 3.2335 - accuracy1000: 0.3981 - val_loss: 3.3051 - val_accuracy1000: 0.3255 - 169s/epoch - 22ms/step
Epoch 7/50
7695/7695 - 168s - loss: 3.2315 - accuracy1000: 0.3994 - val_loss: 3.3015 - val_accuracy1000: 0.3332 - 168s/epoch - 22ms/step
Epoch 8/50
7695/7695 - 169s - loss: 3.2294 - accuracy1000: 0.4009 - val_loss: 3.3039 - val_accuracy1000: 0.3326 - 169s/epoch - 22ms/step
Epoch 9/50
7695/7695 - 169s - loss: 3.2285 - accuracy1000: 0.4013 - val_loss: 3.3064 - val_accuracy1000: 0.3303 - 169s/epoch - 22ms/step
Epoch 10/50
7695/7695 - 169s - loss: 3.2276 - accuracy1000: 0.4019 - val_loss: 3.3076 - val_accuracy1000: 0.3323 - 169s/epoch - 22ms/step
Epoch 11/50
7695/7695 - 168s - loss: 3.2261 - accuracy1000: 0.4029 - val_loss: 3.3115 - val_accuracy1000: 0.3297 - 168s/epoch - 22ms/step
testing model in sample: results/universal/W8/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 177s - 177s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974315
{'0': {'precision': 0.35042971940314105, 'recall': 0.873825278338566, 'f1-score': 0.5002460233536418, 'support': 2087835}, '1': {'precision': 0.32085769752195337, 'recall': 0.059540990091262964, 'f1-score': 0.10044295951033838, 'support': 1840396}, '2': {'precision': 0.36394699396954766, 'recall': 0.07398785464935514, 'f1-score': 0.12297563153427626, 'support': 2032712}, 'accuracy': 0.34967252664553244, 'macro avg': {'precision': 0.3450781369648807, 'recall': 0.3357847076930614, 'f1-score': 0.24122153813275213, 'support': 5960943}, 'weighted avg': {'precision': 0.3459090412883494, 'recall': 0.34967252664553244, 'f1-score': 0.24815872572625525, 'support': 5960943}}
[[1824403  117345  146087]
 [1614064  109579  116753]
 [1767721  114595  150396]]
Evaluating performance on  train set...
7695/7695 - 62s - 62s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991111
{'0': {'precision': 0.3286300777873812, 'recall': 0.894378468385655, 'f1-score': 0.48065022367448235, 'support': 646194}, '1': {'precision': 0.3404392889540831, 'recall': 0.054144942128439406, 'f1-score': 0.09343032055840488, 'support': 651529}, '2': {'precision': 0.35622673892562984, 'recall': 0.05685184578694923, 'f1-score': 0.09805469649645102, 'support': 671746}, 'accuracy': 0.33075361937659337, 'macro avg': {'precision': 0.34176536855569806, 'recall': 0.3351250854336812, 'f1-score': 0.22404508024311276, 'support': 1969469}, 'weighted avg': {'precision': 0.3419493990233103, 'recall': 0.33075361937659337, 'f1-score': 0.22205665796867602, 'support': 1969469}}
[[577942  33079  35173]
 [582408  35277  33844]
 [598290  35266  38190]]
Evaluating performance on  val set...
2338/2338 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984875
{'0': {'precision': 0.34469748496115593, 'recall': 0.8856736473169643, 'f1-score': 0.4962559194009471, 'support': 205998}, '1': {'precision': 0.3096342249930899, 'recall': 0.054510261900127595, 'f1-score': 0.09270080039721033, 'support': 184956}, '2': {'precision': 0.3550748844719114, 'recall': 0.061670494379306176, 'f1-score': 0.10508883734917424, 'support': 206825}, 'accuracy': 0.3434111937689347, 'macro avg': {'precision': 0.33646886480871907, 'recall': 0.33395146786546603, 'f1-score': 0.23134851904911055, 'support': 597779}, 'weighted avg': {'precision': 0.33743919275476925, 'recall': 0.3434111937689347, 'f1-score': 0.236054285794191, 'support': 597779}}
[[182447  11256  12295]
 [164002  10082  10872]
 [182847  11223  12755]]
testing model out of sample: results/universal/W8/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 109s - 109s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982058
{'0': {'precision': 0.3482411355912669, 'recall': 0.8904048054821491, 'f1-score': 0.500668625819436, 'support': 1255566}, '1': {'precision': 0.31232230774564873, 'recall': 0.06518856233095426, 'f1-score': 0.10786360785687236, 'support': 1105470}, '2': {'precision': 0.37082384369060056, 'recall': 0.051756650926823675, 'f1-score': 0.09083523957069112, 'support': 1255201}, 'accuracy': 0.34704334920526503, 'macro avg': {'precision': 0.3437957623425054, 'recall': 0.33578333957997564, 'f1-score': 0.23312249108233316, 'support': 3616237}, 'weighted avg': {'precision': 0.34509937557125053, 'recall': 0.34704334920526503, 'f1-score': 0.2383358640397501, 'support': 3616237}}
[[1117962   78406   59198]
 [ 982378   72064   51028]
 [1109970   80266   64965]]
Evaluating performance on  train set...
4550/4550 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982033
{'0': {'precision': 0.33757147382094227, 'recall': 0.8888035929701428, 'f1-score': 0.48930339003278406, 'support': 392099}, '1': {'precision': 0.333927030862995, 'recall': 0.06311542669584246, 'f1-score': 0.10616470171868433, 'support': 380224}, '2': {'precision': 0.3624177878676593, 'recall': 0.05541064774641417, 'f1-score': 0.09612464192895692, 'support': 391820}, 'accuracy': 0.33862506582095153, 'macro avg': {'precision': 0.3446387641838655, 'recall': 0.3357765558041332, 'f1-score': 0.23053091122680844, 'support': 1164143}, 'weighted avg': {'precision': 0.3447437697420981, 'recall': 0.33862506582095153, 'f1-score': 0.23183173774643967, 'support': 1164143}}
[[348499  23497  20103]
 [338134  23998  18092]
 [345738  24371  21711]]
Evaluating performance on  val set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977029
{'0': {'precision': 0.3562530748794647, 'recall': 0.8898196781170126, 'f1-score': 0.5088001413322573, 'support': 142412}, '1': {'precision': 0.30136175251628183, 'recall': 0.06438202531432088, 'f1-score': 0.10609766265529028, 'support': 118589}, '2': {'precision': 0.37145429986492573, 'recall': 0.05302510926386152, 'f1-score': 0.0928026397195298, 'support': 140028}, 'accuracy': 0.3535430106052181, 'macro avg': {'precision': 0.3430230424202241, 'recall': 0.33574227089839837, 'f1-score': 0.23590014790235914, 'support': 401029}, 'weighted avg': {'precision': 0.34532890257406196, 'recall': 0.3535430106052181, 'f1-score': 0.24446169598379155, 'support': 401029}}
[[126721   8633   7058]
 [105448   7635   5506]
 [123536   9067   7425]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970207
{'0': {'precision': 0.36777407057576395, 'recall': 0.8936922060766183, 'f1-score': 0.5211028254244876, 'support': 60560}, '1': {'precision': 0.26345654993514916, 'recall': 0.03450325923094889, 'f1-score': 0.061015676335304615, 'support': 47097}, '2': {'precision': 0.3697152717860224, 'recall': 0.07483147637176488, 'f1-score': 0.12446987741823043, 'support': 57262}, 'accuracy': 0.3640089983567691, 'macro avg': {'precision': 0.33364863076564516, 'recall': 0.3343423138931107, 'f1-score': 0.23552945972600756, 'support': 164919}, 'weighted avg': {'precision': 0.3386574423770166, 'recall': 0.3640089983567691, 'f1-score': 0.25199665615722583, 'support': 164919}}
[[54122  2360  4078]
 [42245  1625  3227]
 [50794  2183  4285]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999846
{'0': {'precision': 0.32152305551745086, 'recall': 0.8904265711494627, 'f1-score': 0.47244978763227985, 'support': 18426}, '1': {'precision': 0.3392210144927536, 'recall': 0.039010416666666665, 'f1-score': 0.06997384155455905, 'support': 19200}, '2': {'precision': 0.35511871330099565, 'recall': 0.07123105284719378, 'f1-score': 0.11866069524418853, 'support': 19528}, 'accuracy': 0.32450922070196314, 'macro avg': {'precision': 0.33862092777040004, 'recall': 0.33355601355444103, 'f1-score': 0.22036144147700917, 'support': 57154}, 'weighted avg': {'precision': 0.33894715212526266, 'recall': 0.32450922070196314, 'f1-score': 0.21636392206124566, 'support': 57154}}
[[16407   715  1304]
 [17229   749  1222]
 [17393   744  1391]]
Evaluating performance on  val set...
68/68 - 1s - 708ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0943497
{'0': {'precision': 0.4061791566811322, 'recall': 0.8995839908191078, 'f1-score': 0.5596608656849621, 'support': 6971}, '1': {'precision': 0.24924924924924924, 'recall': 0.0355917667238422, 'f1-score': 0.062288930581613514, 'support': 4664}, '2': {'precision': 0.3415929203539823, 'recall': 0.06892857142857142, 'f1-score': 0.11471025260029717, 'support': 5600}, 'accuracy': 0.39588047577603713, 'macro avg': {'precision': 0.3323404420947879, 'recall': 0.33470144299050714, 'f1-score': 0.24555334962229095, 'support': 17235}, 'weighted avg': {'precision': 0.3427266465741208, 'recall': 0.39588047577603713, 'f1-score': 0.2804925373649075, 'support': 17235}}
[[6271  231  469]
 [4223  166  275]
 [4945  269  386]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
2179/2179 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964768
{'0': {'precision': 0.38294723879316434, 'recall': 0.889686742241254, 'f1-score': 0.5354298037134679, 'support': 213211}, '1': {'precision': 0.27677298311444654, 'recall': 0.07142764916267479, 'f1-score': 0.1135508767248413, 'support': 154898}, '2': {'precision': 0.35894010242707636, 'recall': 0.04249575569685658, 'f1-score': 0.07599436170864743, 'support': 189666}, 'accuracy': 0.3743713863116848, 'macro avg': {'precision': 0.33955344144489574, 'recall': 0.3345367157002617, 'f1-score': 0.24165834738231892, 'support': 557775}, 'weighted avg': {'precision': 0.34529851416023444, 'recall': 0.3743713863116848, 'f1-score': 0.2620445057421165, 'support': 557775}}
[[189691  15270   8250]
 [137689  11064   6145]
 [167965  13641   8060]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982896
{'0': {'precision': 0.3379918143832979, 'recall': 0.8968988287828045, 'f1-score': 0.49096568046111533, 'support': 52851}, '1': {'precision': 0.33641796799691537, 'recall': 0.06646986001333206, 'f1-score': 0.11100685443470792, 'support': 52505}, '2': {'precision': 0.3457611386138614, 'recall': 0.0432067738942159, 'f1-score': 0.07681468243057464, 'support': 51728}, 'accuracy': 0.33820758320389094, 'macro avg': {'precision': 0.3400569736646915, 'recall': 0.3355251542301175, 'f1-score': 0.22626240577546597, 'support': 157084}, 'weighted avg': {'precision': 0.34002420978500386, 'recall': 0.33820758320389094, 'f1-score': 0.22758468057162734, 'support': 157084}}
[[47402  3380  2069]
 [46855  3490  2160]
 [45989  3504  2235]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971601
{'0': {'precision': 0.35314822962739967, 'recall': 0.8937467033933072, 'f1-score': 0.5062576768582147, 'support': 17063}, '1': {'precision': 0.32786413356361543, 'recall': 0.07340809486981181, 'f1-score': 0.11995787256450764, 'support': 15516}, '2': {'precision': 0.36153441933788755, 'recall': 0.043051123208810466, 'f1-score': 0.07694028181614852, 'support': 15981}, 'accuracy': 0.351668039538715, 'macro avg': {'precision': 0.3475155941763009, 'recall': 0.3367353071573098, 'f1-score': 0.23438527707962362, 'support': 48560}, 'weighted avg': {'precision': 0.34782927705815814, 'recall': 0.351668039538715, 'f1-score': 0.24153879189963937, 'support': 48560}}
[[15250  1194   619]
 [13781  1139   596]
 [14152  1141   688]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038235
{'0': {'precision': 0.24251334975798242, 'recall': 0.8795569342264192, 'f1-score': 0.38019774958245944, 'support': 72856}, '1': {'precision': 0.48493359077877246, 'recall': 0.056506265595811116, 'f1-score': 0.10121820901902115, 'support': 146674}, '2': {'precision': 0.28493490390576565, 'recall': 0.05897751770865414, 'f1-score': 0.09772693444470433, 'support': 77928}, 'accuracy': 0.25874241069327436, 'macro avg': {'precision': 0.3374606148141735, 'recall': 0.3316802391769615, 'f1-score': 0.193047631015395, 'support': 297458}, 'weighted avg': {'precision': 0.3731622928125038, 'recall': 0.25874241069327436, 'f1-score': 0.16863366048532058, 'support': 297458}}
[[ 64081   4397   4378]
 [131230   8288   7156]
 [ 68926   4406   4596]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968919
{'0': {'precision': 0.3555208707422857, 'recall': 0.8632902901224216, 'f1-score': 0.5036345670315909, 'support': 29815}, '1': {'precision': 0.34759238521836505, 'recall': 0.05721448057214481, 'f1-score': 0.09825583235731697, 'support': 27126}, '2': {'precision': 0.3324899538621819, 'recall': 0.08385571112195488, 'f1-score': 0.13393285371702637, 'support': 26641}, 'accuracy': 0.3532459141920509, 'macro avg': {'precision': 0.34520106994094424, 'recall': 0.33478682727217374, 'f1-score': 0.24527441770197808, 'support': 83582}, 'weighted avg': {'precision': 0.3456068371594005, 'recall': 0.3532459141920509, 'f1-score': 0.2542324601044096, 'support': 83582}}
[[25739  1570  2506]
 [23595  1552  1979]
 [23064  1343  2234]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991315
{'0': {'precision': 0.305710230374495, 'recall': 0.8667836136621607, 'f1-score': 0.45200172191132154, 'support': 9691}, '1': {'precision': 0.41304347826086957, 'recall': 0.0672751593359037, 'f1-score': 0.11570471615129575, 'support': 12709}, '2': {'precision': 0.33184855233853006, 'recall': 0.07932282793867121, 'f1-score': 0.1280398728194552, 'support': 9392}, 'accuracy': 0.3145445395067942, 'macro avg': {'precision': 0.3502007536579648, 'recall': 0.33779386697891184, 'f1-score': 0.23191543696069084, 'support': 31792}, 'weighted avg': {'precision': 0.356338985006923, 'recall': 0.3145445395067942, 'f1-score': 0.22186054385159026, 'support': 31792}}
[[ 8400   608   683]
 [11037   855   817]
 [ 8040   607   745]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101285
{'0': {'precision': 0.3136502428343044, 'recall': 0.8428484169805558, 'f1-score': 0.4571723597168385, 'support': 98230}, '1': {'precision': 0.3452639751552795, 'recall': 0.03994789795185052, 'f1-score': 0.07161030595813205, 'support': 111320}, '2': {'precision': 0.3403626112431596, 'recall': 0.11901080422891823, 'f1-score': 0.17635686667621367, 'support': 103478}, 'accuracy': 0.3180386419106278, 'macro avg': {'precision': 0.3330922764109145, 'recall': 0.3339357063871082, 'f1-score': 0.23504651078372807, 'support': 313028}, 'weighted avg': {'precision': 0.33372315369270195, 'recall': 0.3180386419106278, 'f1-score': 0.2272280946246519, 'support': 313028}}
[[82793  4220 11217]
 [94223  4447 12650]
 [86950  4213 12315]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001155
{'0': {'precision': 0.3264818729935009, 'recall': 0.8387085959501139, 'f1-score': 0.47000582411182296, 'support': 29828}, '1': {'precision': 0.3313502327987584, 'recall': 0.042341508560851455, 'f1-score': 0.07508792497069167, 'support': 30254}, '2': {'precision': 0.35038901601830663, 'recall': 0.12216371469602681, 'f1-score': 0.1811642214860388, 'support': 31335}, 'accuracy': 0.3295448330179288, 'macro avg': {'precision': 0.33607370727018865, 'recall': 0.3344046064023307, 'f1-score': 0.24208599018951782, 'support': 91417}, 'weighted avg': {'precision': 0.33628768246253343, 'recall': 0.3295448330179288, 'f1-score': 0.2403034958917465, 'support': 91417}}
[[25017  1225  3586]
 [25462  1281  3511]
 [26147  1360  3828]]
Evaluating performance on  val set...
99/99 - 1s - 987ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101016
{'0': {'precision': 0.32038463378462423, 'recall': 0.8248552777435645, 'f1-score': 0.4615119564468335, 'support': 8119}, '1': {'precision': 0.37652270210409744, 'recall': 0.036235745497175745, 'f1-score': 0.06610927474236827, 'support': 9383}, '2': {'precision': 0.31237322515212984, 'recall': 0.13900709219858157, 'f1-score': 0.19239693021595577, 'support': 7755}, 'accuracy': 0.32129706615987647, 'macro avg': {'precision': 0.33642685368028385, 'recall': 0.3333660384797739, 'f1-score': 0.24000605380171916, 'support': 25257}, 'weighted avg': {'precision': 0.3387801289383093, 'recall': 0.32129706615987647, 'f1-score': 0.23198943236030484, 'support': 25257}}
[[6697  319 1103]
 [7773  340 1270]
 [6433  244 1078]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985149
{'0': {'precision': 0.33596601241612845, 'recall': 0.8589900836119061, 'f1-score': 0.4830160272086152, 'support': 124743}, '1': {'precision': 0.319706498951782, 'recall': 0.04431006147113036, 'f1-score': 0.07783280301761605, 'support': 110133}, '2': {'precision': 0.3745497169649494, 'recall': 0.09754590264023945, 'f1-score': 0.15478131424115685, 'support': 134306}, 'accuracy': 0.3389493528936947, 'macro avg': {'precision': 0.34340740944428666, 'recall': 0.333615349241092, 'f1-score': 0.23854338148912935, 'support': 369182}, 'weighted avg': {'precision': 0.34515203455904186, 'recall': 0.3389493528936947, 'f1-score': 0.24273363156192934, 'support': 369182}}
[[107153   5221  12369]
 [ 95745   4880   9508]
 [116042   5163  13101]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995489
{'0': {'precision': 0.3190973910968772, 'recall': 0.8603557908800752, 'f1-score': 0.46553316821741747, 'support': 40417}, '1': {'precision': 0.3331372549019608, 'recall': 0.041154954824019575, 'f1-score': 0.0732595994222021, 'support': 41283}, '2': {'precision': 0.37614603798297314, 'recall': 0.10305232232164883, 'f1-score': 0.16178153331572923, 'support': 44589}, 'accuracy': 0.3251827158343165, 'macro avg': {'precision': 0.34279356132727035, 'recall': 0.3348543560085812, 'f1-score': 0.23352476698511626, 'support': 126289}, 'weighted avg': {'precision': 0.34382915564857525, 'recall': 0.3251827158343165, 'f1-score': 0.2300557205441898, 'support': 126289}}
[[34773  1645  3999]
 [35962  1699  3622]
 [38238  1756  4595]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992693
{'0': {'precision': 0.32677687944974054, 'recall': 0.8596143163241012, 'f1-score': 0.47354040525475966, 'support': 12601}, '1': {'precision': 0.32478055367994596, 'recall': 0.041100572502777065, 'f1-score': 0.07296723300970874, 'support': 11703}, '2': {'precision': 0.37396987780619495, 'recall': 0.09505923143600116, 'f1-score': 0.15158670736623858, 'support': 13844}, 'accuracy': 0.3310527419523959, 'macro avg': {'precision': 0.3418424369786271, 'recall': 0.33192470675429314, 'f1-score': 0.23269811521023565, 'support': 38148}, 'weighted avg': {'precision': 0.3432909003358381, 'recall': 0.3310527419523959, 'f1-score': 0.2338152603362183, 'support': 38148}}
[[10832   506  1263]
 [10282   481   940]
 [12034   494  1316]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
5521/5521 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984508
{'0': {'precision': 0.3199845009601606, 'recall': 0.8755184231933535, 'f1-score': 0.46867693933131305, 'support': 449922}, '1': {'precision': 0.3622514394017822, 'recall': 0.08820312954452911, 'f1-score': 0.14186429815547408, 'support': 515730}, '2': {'precision': 0.3525261078182331, 'recall': 0.044641720261005734, 'f1-score': 0.07924796913199601, 'support': 447653}, 'accuracy': 0.32504519548151317, 'macro avg': {'precision': 0.3449206827267253, 'recall': 0.33612109099962945, 'f1-score': 0.2299297355395944, 'support': 1413305}, 'weighted avg': {'precision': 0.34571544799376924, 'recall': 0.32504519548151317, 'f1-score': 0.2260710402293851, 'support': 1413305}}
[[393915  39603  16404]
 [449941  45489  20300]
 [387188  40481  19984]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098571
{'0': {'precision': 0.3299180045950445, 'recall': 0.8870260773071944, 'f1-score': 0.4809520466897976, 'support': 108140}, '1': {'precision': 0.3365591397849462, 'recall': 0.07737097970282072, 'f1-score': 0.12581790571473234, 'support': 109227}, '2': {'precision': 0.3692141312184571, 'recall': 0.04557631206557435, 'f1-score': 0.08113696318653896, 'support': 112361}, 'accuracy': 0.33207674204192544, 'macro avg': {'precision': 0.3452304251994826, 'recall': 0.33665778969186316, 'f1-score': 0.22930230519702297, 'support': 329728}, 'weighted avg': {'precision': 0.3455088654164508, 'recall': 0.33207674204192544, 'f1-score': 0.22706441987680903, 'support': 329728}}
[[95923  7993  4224]
 [96251  8451  4525]
 [98574  8666  5121]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0963619
{'0': {'precision': 0.39301194790429494, 'recall': 0.8877169651250774, 'f1-score': 0.5448200163237736, 'support': 43613}, '1': {'precision': 0.24140302613480055, 'recall': 0.07976064232692016, 'f1-score': 0.11990434980642223, 'support': 26404}, '2': {'precision': 0.4241137762683082, 'recall': 0.04765198311431229, 'f1-score': 0.08567753001715266, 'support': 41929}, 'accuracy': 0.3825058510353206, 'macro avg': {'precision': 0.35284291676913454, 'recall': 0.33837653018876995, 'f1-score': 0.2501339653824495, 'support': 111946}, 'weighted avg': {'precision': 0.36890198945176406, 'recall': 0.3825058510353206, 'f1-score': 0.27262754346119294, 'support': 111946}}
[[38716  3295  1602]
 [23187  2106  1111]
 [36608  3323  1998]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965415
{'0': {'precision': 0.3912530842413172, 'recall': 0.8991526631556086, 'f1-score': 0.5452490480193348, 'support': 589376}, '1': {'precision': 0.2538271419308154, 'recall': 0.07287925679887106, 'f1-score': 0.11324377809082982, 'support': 370613}, '2': {'precision': 0.39921664264863466, 'recall': 0.038932351256004354, 'f1-score': 0.07094592376136849, 'support': 555014}, 'accuracy': 0.3818850523728336, 'macro avg': {'precision': 0.34809895627358917, 'recall': 0.3369880904034947, 'f1-score': 0.2431462499571777, 'support': 1515003}, 'weighted avg': {'precision': 0.36055218506709574, 'recall': 0.3818850523728336, 'f1-score': 0.2658095727767617, 'support': 1515003}}
[[529939  40128  19309]
 [330394  27010  13209]
 [494133  39273  21608]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984895
{'0': {'precision': 0.33308246888961324, 'recall': 0.9013724574512246, 'f1-score': 0.4864193209660483, 'support': 154176}, '1': {'precision': 0.3332787475845806, 'recall': 0.0661849353825341, 'f1-score': 0.11043823663475939, 'support': 153751}, '2': {'precision': 0.3694309927360775, 'recall': 0.039034218100415734, 'f1-score': 0.07060797130791925, 'support': 156350}, 'accuracy': 0.33438873775784717, 'macro avg': {'precision': 0.3452640697367571, 'recall': 0.3355305369780581, 'f1-score': 0.22248850963624234, 'support': 464277}, 'weighted avg': {'precision': 0.3453882039336163, 'recall': 0.33438873775784717, 'f1-score': 0.2218798925298594, 'support': 464277}}
[[138970   9931   5275]
 [138433  10176   5142]
 [139821  10426   6103]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976343
{'0': {'precision': 0.3726589953834493, 'recall': 0.8956380618024046, 'f1-score': 0.526323984507289, 'support': 60386}, '1': {'precision': 0.277077458948416, 'recall': 0.07540569210282799, 'f1-score': 0.11854874478843253, 'support': 44307}, '2': {'precision': 0.3779143321886861, 'recall': 0.036034328255325015, 'f1-score': 0.06579506301033652, 'support': 58028}, 'accuracy': 0.36575488105407417, 'macro avg': {'precision': 0.3425502621735171, 'recall': 0.3356926940535192, 'f1-score': 0.23688926410201935, 'support': 162721}, 'weighted avg': {'precision': 0.34850738341761367, 'recall': 0.36575488105407417, 'f1-score': 0.2510622186451782, 'support': 162721}}
[[54084  4360  1942]
 [39466  3341  1500]
 [51580  4357  2091]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
3755/3755 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977345
{'0': {'precision': 0.33554980855937705, 'recall': 0.8879437376491793, 'f1-score': 0.48704687017432213, 'support': 322347}, '1': {'precision': 0.3646638027987242, 'recall': 0.057464017803706004, 'f1-score': 0.09928294811977803, 'support': 344198}, '2': {'precision': 0.32261235694544915, 'recall': 0.05903677027150873, 'f1-score': 0.09980890952181473, 'support': 294613}, 'accuracy': 0.3364670532836433, 'macro avg': {'precision': 0.34094198943451676, 'recall': 0.3348148419081314, 'f1-score': 0.22871290927197163, 'support': 961158}, 'weighted avg': {'precision': 0.342010179442063, 'recall': 0.3364670532836433, 'f1-score': 0.2294899401534024, 'support': 961158}}
[[286226  17914  18207]
 [306106  19779  18313]
 [260674  16546  17393]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983901
{'0': {'precision': 0.3335699364057108, 'recall': 0.8854354952360528, 'f1-score': 0.48458301197142956, 'support': 130564}, '1': {'precision': 0.3450254270439431, 'recall': 0.06171380591793261, 'f1-score': 0.10470016421227568, 'support': 128626}, '2': {'precision': 0.36368865879021195, 'recall': 0.06180256865281078, 'f1-score': 0.10565150044669541, 'support': 132988}, 'accuracy': 0.3359775408105503, 'macro avg': {'precision': 0.34742800741328866, 'recall': 0.3363172899355988, 'f1-score': 0.2316448922101335, 'support': 392178}, 'weighted avg': {'precision': 0.34754038500635465, 'recall': 0.3359775408105503, 'f1-score': 0.23149345817055272, 'support': 392178}}
[[115606   7353   7605]
 [113913   7938   6775]
 [117053   7716   8219]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995136
{'0': {'precision': 0.3195394469200276, 'recall': 0.8855067904147659, 'f1-score': 0.46961575628645513, 'support': 38142}, '1': {'precision': 0.3438386855862584, 'recall': 0.05689569945625309, 'f1-score': 0.09763545753366557, 'support': 40460}, '2': {'precision': 0.36628988410359137, 'recall': 0.06277433118363944, 'f1-score': 0.1071802386435001, 'support': 40781}, 'accuracy': 0.3236390440850037, 'macro avg': {'precision': 0.34322267220329244, 'recall': 0.33505894035155276, 'f1-score': 0.22481048415454027, 'support': 119383}, 'weighted avg': {'precision': 0.3437445412401453, 'recall': 0.3236390440850037, 'f1-score': 0.21974093547833995, 'support': 119383}}
[[33775  2085  2282]
 [36011  2302  2147]
 [35913  2308  2560]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
4960/4960 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989292
{'0': {'precision': 0.3223577427175625, 'recall': 0.889275569748377, 'f1-score': 0.47318749388713194, 'support': 408031}, '1': {'precision': 0.35180410867815354, 'recall': 0.06997746854065293, 'f1-score': 0.1167351173080124, 'support': 430953}, '2': {'precision': 0.36674380731979084, 'recall': 0.04967366394932794, 'f1-score': 0.08749637033613755, 'support': 430691}, 'accuracy': 0.32638509854884123, 'macro avg': {'precision': 0.346968552905169, 'recall': 0.3363089007461193, 'f1-score': 0.22580632717709395, 'support': 1269675}, 'weighted avg': {'precision': 0.34740878199880604, 'recall': 0.32638509854884123, 'f1-score': 0.22136878694464462, 'support': 1269675}}
[[362852  26255  18924]
 [382779  30157  18017]
 [379988  29309  21394]]
Evaluating performance on  train set...
1691/1691 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097526
{'0': {'precision': 0.3461984416345824, 'recall': 0.8861487957659197, 'f1-score': 0.4978845618182229, 'support': 149265}, '1': {'precision': 0.34103238260059243, 'recall': 0.07379162345892384, 'f1-score': 0.12133016795827388, 'support': 138864}, '2': {'precision': 0.3639697013557196, 'recall': 0.05213112941566698, 'f1-score': 0.09119977756151815, 'support': 144712}, 'accuracy': 0.34669081718229094, 'macro avg': {'precision': 0.3504001751969648, 'recall': 0.3373571828801702, 'f1-score': 0.23680483577933828, 'support': 432841}, 'weighted avg': {'precision': 0.35048254345273094, 'recall': 0.34669081718229094, 'f1-score': 0.2411112481803646, 'support': 432841}}
[[132271   9813   7181]
 [122615  10247   6002]
 [127181   9987   7544]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097583
{'0': {'precision': 0.3483487066297807, 'recall': 0.8853931732464038, 'f1-score': 0.49998394605875734, 'support': 52763}, '1': {'precision': 0.3117534129692833, 'recall': 0.0646595584656904, 'f1-score': 0.10710490637939249, 'support': 45206}, '2': {'precision': 0.37712418300653594, 'recall': 0.054266044691896775, 'f1-score': 0.0948794685434275, 'support': 53164}, 'accuracy': 0.347534952657593, 'macro avg': {'precision': 0.3457421008685333, 'recall': 0.334772925467997, 'f1-score': 0.23398944032719246, 'support': 151133}, 'weighted avg': {'precision': 0.3475248798075603, 'recall': 0.347534952657593, 'f1-score': 0.23996486147517626, 'support': 151133}}
[[46716  3212  2835]
 [40353  2923  1930]
 [47038  3241  2885]]
testing model on single stock: results/universal/W8/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
10609/10609 - 86s - 86s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965403
{'0': {'precision': 0.36931855483086173, 'recall': 0.8683779409934023, 'f1-score': 0.5182338114338797, 'support': 1004125}, '1': {'precision': 0.26594043573855686, 'recall': 0.04098144907245362, 'f1-score': 0.07101888110870104, 'support': 714250}, '2': {'precision': 0.37943453767977303, 'recall': 0.09306609231707146, 'f1-score': 0.14947065663056117, 'support': 997302}, 'accuracy': 0.36603984936352885, 'macro avg': {'precision': 0.33823117608306386, 'recall': 0.33414182746097576, 'f1-score': 0.2462411163910473, 'support': 2715677}, 'weighted avg': {'precision': 0.3458440651789282, 'recall': 0.36603984936352885, 'f1-score': 0.26518770330083663, 'support': 2715677}}
[[871960  40183  91982]
 [625162  29271  59817]
 [863875  40612  92815]]
Evaluating performance on  train set...
3903/3903 - 33s - 33s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995805
{'0': {'precision': 0.3252286992244618, 'recall': 0.9059545397169431, 'f1-score': 0.47863292349882325, 'support': 324811}, '1': {'precision': 0.3375584365511591, 'recall': 0.04233085637788327, 'f1-score': 0.07522790435401366, 'support': 330917}, '2': {'precision': 0.35611013207511416, 'recall': 0.05473678691886035, 'f1-score': 0.09488850234911274, 'support': 343334}, 'accuracy': 0.32737207500635596, 'macro avg': {'precision': 0.3396324226169117, 'recall': 0.3343407276712289, 'f1-score': 0.21624977673398324, 'support': 999062}, 'weighted avg': {'precision': 0.33992525014250746, 'recall': 0.32737207500635596, 'f1-score': 0.21313780326468595, 'support': 999062}}
[[294264  13237  17310]
 [300239  14008  16670]
 [310288  14253  18793]]
Evaluating performance on  val set...
1144/1144 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986451
{'0': {'precision': 0.33875969289385827, 'recall': 0.892157357587749, 'f1-score': 0.49105981975174195, 'support': 99061}, '1': {'precision': 0.33756523093698887, 'recall': 0.04650563883553486, 'f1-score': 0.08174890599064433, 'support': 93193}, '2': {'precision': 0.3564288358808907, 'recall': 0.06713555624184342, 'f1-score': 0.11298895092466846, 'support': 100379}, 'accuracy': 0.33984888922302, 'macro avg': {'precision': 0.3442512532372459, 'recall': 0.33526618422170906, 'f1-score': 0.2285992255556849, 'support': 292633}, 'weighted avg': {'precision': 0.3444401712088425, 'recall': 0.33984888922302, 'f1-score': 0.23102322877215054, 'support': 292633}}
[[88378  4251  6432]
 [83123  4334  5736]
 [89386  4254  6739]]
training model: results/universal/W8/deepVOL_L2/h300
Epoch 1/50
7696/7696 - 251s - loss: 3.2652 - accuracy300: 0.3766 - val_loss: 3.5937 - val_accuracy300: 0.3305 - 251s/epoch - 33ms/step
Epoch 2/50
7696/7696 - 245s - loss: 3.2622 - accuracy300: 0.3780 - val_loss: 3.6762 - val_accuracy300: 0.3289 - 245s/epoch - 32ms/step
Epoch 3/50
7696/7696 - 248s - loss: 3.2532 - accuracy300: 0.3844 - val_loss: 3.7400 - val_accuracy300: 0.3300 - 248s/epoch - 32ms/step
Epoch 4/50
7696/7696 - 249s - loss: 3.2473 - accuracy300: 0.3889 - val_loss: 3.6520 - val_accuracy300: 0.3294 - 249s/epoch - 32ms/step
Epoch 5/50
7696/7696 - 246s - loss: 3.2429 - accuracy300: 0.3920 - val_loss: 3.6212 - val_accuracy300: 0.3297 - 246s/epoch - 32ms/step
Epoch 6/50
7696/7696 - 248s - loss: 3.2372 - accuracy300: 0.3957 - val_loss: 3.6223 - val_accuracy300: 0.3289 - 248s/epoch - 32ms/step
Epoch 7/50
7696/7696 - 247s - loss: 3.2331 - accuracy300: 0.3974 - val_loss: 3.7116 - val_accuracy300: 0.3288 - 247s/epoch - 32ms/step
Epoch 8/50
7696/7696 - 248s - loss: 3.2285 - accuracy300: 0.4005 - val_loss: 3.7144 - val_accuracy300: 0.3290 - 248s/epoch - 32ms/step
Epoch 9/50
7696/7696 - 247s - loss: 3.2243 - accuracy300: 0.4031 - val_loss: 3.7267 - val_accuracy300: 0.3290 - 247s/epoch - 32ms/step
Epoch 10/50
7696/7696 - 246s - loss: 3.2203 - accuracy300: 0.4048 - val_loss: 3.6568 - val_accuracy300: 0.3291 - 246s/epoch - 32ms/step
Epoch 11/50
7696/7696 - 246s - loss: 3.2176 - accuracy300: 0.4064 - val_loss: 3.6681 - val_accuracy300: 0.3293 - 246s/epoch - 32ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 367s - 367s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.21414
{'0': {'precision': 0.3670413649086951, 'recall': 0.003962851564561237, 'f1-score': 0.007841045371472016, 'support': 2084610}, '1': {'precision': 0.3099244415385348, 'recall': 0.9739291777132024, 'f1-score': 0.4702163112283336, 'support': 1837303}, '2': {'precision': 0.36531015984367604, 'recall': 0.029522499393101215, 'f1-score': 0.05463007540017633, 'support': 2039055}, 'accuracy': 0.3116711916588044, 'macro avg': {'precision': 0.3474253220969687, 'recall': 0.3358048428902883, 'f1-score': 0.1775624773333273, 'support': 5960968}, 'weighted avg': {'precision': 0.34884446853169426, 'recall': 0.3116711916588044, 'f1-score': 0.16636041147271413, 'support': 5960968}}
[[   8261 2013527   62822]
 [   6134 1789403   41766]
 [   8112 1970745   60198]]
Evaluating performance on  train set...
7696/7696 - 126s - 126s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1994545
{'0': {'precision': 0.3480939545629573, 'recall': 0.004137375512595196, 'f1-score': 0.008177554241880113, 'support': 655488}, '1': {'precision': 0.3317346064415444, 'recall': 0.9700488247705972, 'f1-score': 0.494396775068365, 'support': 652128}, '2': {'precision': 0.34395032417130855, 'recall': 0.02845448611799403, 'f1-score': 0.0525607052003924, 'support': 661864}, 'accuracy': 0.33213894022787743, 'macro avg': {'precision': 0.3412596283919367, 'recall': 0.33421356213372877, 'f1-score': 0.18504501150354583, 'support': 1969480}, 'weighted avg': {'precision': 0.3412845892699566, 'recall': 0.33213894022787743, 'f1-score': 0.18408834179247152, 'support': 1969480}}
[[  2712 633903  18873]
 [  2483 632596  17049]
 [  2596 640435  18833]]
Evaluating performance on  val set...
2338/2338 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2001307
{'0': {'precision': 0.3419953596287703, 'recall': 0.0036533799961334648, 'f1-score': 0.00722953022767625, 'support': 201731}, '1': {'precision': 0.32974876350473875, 'recall': 0.9716310974058356, 'f1-score': 0.492391441693507, 'support': 196518}, '2': {'precision': 0.3476975073933249, 'recall': 0.028872706496734842, 'f1-score': 0.05331790837575197, 'support': 199531}, 'accuracy': 0.33029040784235003, 'macro avg': {'precision': 0.339813876842278, 'recall': 0.334719061299568, 'f1-score': 0.18431296009897843, 'support': 597780}, 'weighted avg': {'precision': 0.3398726366679936, 'recall': 0.33029040784235003, 'f1-score': 0.18210842998629287, 'support': 597780}}
[[   737 195112   5882]
 [   649 190943   4926]
 [   769 193001   5761]]
testing model out of sample: results/universal/W8/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 227s - 227s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2093164
{'0': {'precision': 0.35944935418082935, 'recall': 0.0035155285800838243, 'f1-score': 0.006962957232133966, 'support': 1203233}, '1': {'precision': 0.3336653651171536, 'recall': 0.9818368939599414, 'f1-score': 0.49806826776332674, 'support': 1201942}, '2': {'precision': 0.3519295549908398, 'recall': 0.01966828146945678, 'f1-score': 0.037254520160372735, 'support': 1211087}, 'accuracy': 0.33409111397348973, 'macro avg': {'precision': 0.34834809142960754, 'recall': 0.335006901336494, 'f1-score': 0.1807619150519445, 'support': 3616262}, 'weighted avg': {'precision': 0.3483611115632371, 'recall': 0.33409111397348973, 'f1-score': 0.18033695978575284, 'support': 3616262}}
[[   4230 1173609   25394]
 [   3361 1180111   18470]
 [   4177 1183090   23820]]
Evaluating performance on  train set...
4550/4550 - 74s - 74s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2097878
{'0': {'precision': 0.3610652839971718, 'recall': 0.003879649818552931, 'f1-score': 0.007676812218759082, 'support': 394881}, '1': {'precision': 0.3259474447535123, 'recall': 0.9777578541750968, 'f1-score': 0.4889106064352998, 'support': 378111}, '2': {'precision': 0.3497838195769875, 'recall': 0.022957416293629955, 'f1-score': 0.04308690311684323, 'support': 391159}, 'accuracy': 0.3266011024343062, 'macro avg': {'precision': 0.3455988494425572, 'recall': 0.3348649734290932, 'f1-score': 0.1798914405903007, 'support': 1164151}, 'weighted avg': {'precision': 0.345868554659316, 'recall': 0.3266011024343062, 'f1-score': 0.17587730073838767, 'support': 1164151}}
[[  1532 383829   9520]
 [  1237 369701   7173]
 [  1474 380705   8980]]
Evaluating performance on  val set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.203548
{'0': {'precision': 0.3706199460916442, 'recall': 0.004054940761001792, 'f1-score': 0.00802211185741061, 'support': 135637}, '1': {'precision': 0.3267514359805842, 'recall': 0.9803947146299167, 'f1-score': 0.49014470292167933, 'support': 130322}, '2': {'precision': 0.36742113287205347, 'recall': 0.02319469327923953, 'f1-score': 0.04363479362957083, 'support': 135074}, 'accuracy': 0.32777851199277863, 'macro avg': {'precision': 0.3549308383147607, 'recall': 0.33588144955671934, 'f1-score': 0.18060053613622026, 'support': 401033}, 'weighted avg': {'precision': 0.35528677283279375, 'recall': 0.32777851199277863, 'f1-score': 0.1766903453702896, 'support': 401033}}
[[   550 131847   3240]
 [   401 127767   2154]
 [   533 131408   3133]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2081596
{'0': {'precision': 0.37375745526838966, 'recall': 0.0033214374050386914, 'f1-score': 0.006584362139917695, 'support': 56602}, '1': {'precision': 0.30819420815494775, 'recall': 0.9751360517390961, 'f1-score': 0.468361563194007, 'support': 50716}, '2': {'precision': 0.37809812847749114, 'recall': 0.025952157761344304, 'f1-score': 0.048570500324886294, 'support': 57606}, 'accuracy': 0.31007009289127113, 'macro avg': {'precision': 0.3533499306336095, 'recall': 0.3348032156351597, 'f1-score': 0.17450547521960366, 'support': 164924}, 'weighted avg': {'precision': 0.35511215913367417, 'recall': 0.31007009289127113, 'f1-score': 0.16325134817556133, 'support': 164924}}
[[  188 55088  1326]
 [  128 49455  1133]
 [  187 55924  1495]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2188675
{'0': {'precision': 0.3129251700680272, 'recall': 0.002413178050571818, 'f1-score': 0.004789421625279816, 'support': 19062}, '1': {'precision': 0.33067608296328, 'recall': 0.9852284803400637, 'f1-score': 0.4951597612593967, 'support': 18820}, '2': {'precision': 0.3822269807280514, 'recall': 0.01852428393524284, 'f1-score': 0.03533603880035633, 'support': 19272}, 'accuracy': 0.3314728627917556, 'macro avg': {'precision': 0.3419427445864529, 'recall': 0.33538864744195945, 'f1-score': 0.17842840722834427, 'support': 57154}, 'weighted avg': {'precision': 0.3421384653007082, 'recall': 0.3314728627917556, 'f1-score': 0.1765615495273016, 'support': 57154}}
[[   46 18667   349]
 [   50 18542   228]
 [   51 18864   357]]
Evaluating performance on  val set...
68/68 - 1s - 714ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2386897
{'0': {'precision': 0.3333333333333333, 'recall': 0.0022712524334847503, 'f1-score': 0.0045117628101836935, 'support': 6164}, '1': {'precision': 0.30825428621928946, 'recall': 0.9840135414707541, 'f1-score': 0.4694481830417227, 'support': 5317}, '2': {'precision': 0.36486486486486486, 'recall': 0.014072272411396804, 'f1-score': 0.027099364335898293, 'support': 5756}, 'accuracy': 0.3090444973023148, 'macro avg': {'precision': 0.3354841614724959, 'recall': 0.3334523554385453, 'f1-score': 0.16701977006260157, 'support': 17237}, 'weighted avg': {'precision': 0.3361267545777566, 'recall': 0.3090444973023148, 'f1-score': 0.15547081489309295, 'support': 17237}}
[[  14 6083   67]
 [  11 5232   74]
 [  17 5658   81]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2825382
{'0': {'precision': 0.4056603773584906, 'recall': 0.00022545431666369555, 'f1-score': 0.00045065817053743605, 'support': 190726}, '1': {'precision': 0.3446597935184753, 'recall': 0.999510890491503, 'f1-score': 0.5125706448359225, 'support': 192186}, '2': {'precision': 0.3958333333333333, 'recall': 0.0007605736898689297, 'f1-score': 0.0015182301773932101, 'support': 174868}, 'accuracy': 0.3447022123417835, 'macro avg': {'precision': 0.38205116807009976, 'recall': 0.33349897283267854, 'f1-score': 0.17151317772795105, 'support': 557780}, 'weighted avg': {'precision': 0.3815614606879961, 'recall': 0.3447022123417835, 'f1-score': 0.1772389545220892, 'support': 557780}}
[[    43 190552    131]
 [    22 192092     72]
 [    41 174694    133]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2760977
{'0': {'precision': 0.41044776119402987, 'recall': 0.0010318174996247936, 'f1-score': 0.002058460271716756, 'support': 53304}, '1': {'precision': 0.33505200746249586, 'recall': 0.9970909229189642, 'f1-score': 0.5015637702644541, 'support': 52594}, '2': {'precision': 0.3112128146453089, 'recall': 0.0026568208013440387, 'f1-score': 0.005268663076744276, 'support': 51189}, 'accuracy': 0.3350500041378344, 'macro avg': {'precision': 0.3522375277672782, 'recall': 0.33359318707331104, 'f1-score': 0.1696302978709717, 'support': 157087}, 'weighted avg': {'precision': 0.3528675543619001, 'recall': 0.3350500041378344, 'f1-score': 0.170342973599647, 'support': 157087}}
[[   55 53064   185]
 [   37 52441   116]
 [   42 51011   136]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2652249
{'0': {'precision': 0.2777777777777778, 'recall': 0.0006152331733727083, 'f1-score': 0.0012277470841006754, 'support': 16254}, '1': {'precision': 0.35113178294573644, 'recall': 0.9959542656112577, 'f1-score': 0.5192113709307657, 'support': 17055}, '2': {'precision': 0.31543624161073824, 'recall': 0.0030817651301553997, 'f1-score': 0.006103896103896104, 'support': 15251}, 'accuracy': 0.3509678747940692, 'macro avg': {'precision': 0.31478193411141747, 'recall': 0.33321708797159527, 'f1-score': 0.1755143380395875, 'support': 48560}, 'weighted avg': {'precision': 0.31536801233412076, 'recall': 0.3509678747940692, 'f1-score': 0.18468278937005153, 'support': 48560}}
[[   10 16195    49]
 [   16 16986    53]
 [   10 15194    47]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
1162/1162 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0714848
{'0': {'precision': 0.3084610259826782, 'recall': 0.005870121966681035, 'f1-score': 0.01152099533437014, 'support': 78874}, '1': {'precision': 0.46100777345918936, 'recall': 0.9764638431118886, 'f1-score': 0.6263183453322207, 'support': 136046}, '2': {'precision': 0.322994104075878, 'recall': 0.030529542178016306, 'f1-score': 0.05578615307986054, 'support': 82543}, 'accuracy': 0.4566181340200294, 'macro avg': {'precision': 0.36415430117258185, 'recall': 0.33762116908552864, 'f1-score': 0.2312084979154838, 'support': 297463}, 'weighted avg': {'precision': 0.3822617295062641, 'recall': 0.4566181340200294, 'f1-score': 0.30498438134739897, 'support': 297463}}
[[   463  75781   2630]
 [   550 132844   2652]
 [   488  79535   2520]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.188774
{'0': {'precision': 0.33532934131736525, 'recall': 0.00395578003037474, 'f1-score': 0.00781931790414354, 'support': 28313}, '1': {'precision': 0.339686953953683, 'recall': 0.9754416961130742, 'f1-score': 0.5038971943851195, 'support': 28300}, '2': {'precision': 0.34611503531786075, 'recall': 0.02543661240683748, 'f1-score': 0.04739041829297779, 'support': 26969}, 'accuracy': 0.3398219712378263, 'macro avg': {'precision': 0.34037711019630296, 'recall': 0.3349446961834288, 'f1-score': 0.18636897686074694, 'support': 83582}, 'weighted avg': {'precision': 0.34028495160555117, 'recall': 0.3398219712378263, 'f1-score': 0.18855436744588805, 'support': 83582}}
[[  112 27490   711]
 [  110 27605   585]
 [  112 26171   686]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1697744
{'0': {'precision': 0.3076923076923077, 'recall': 0.0028317152103559872, 'f1-score': 0.005611784747970739, 'support': 9888}, '1': {'precision': 0.3783229773877394, 'recall': 0.9852364667611978, 'f1-score': 0.5467126426141492, 'support': 11989}, '2': {'precision': 0.34237995824634654, 'recall': 0.01654059505799294, 'f1-score': 0.03155666730806234, 'support': 9915}, 'accuracy': 0.3775792652239557, 'macro avg': {'precision': 0.3427984144421312, 'recall': 0.3348695923431822, 'f1-score': 0.19462703155672745, 'support': 31792}, 'weighted avg': {'precision': 0.34514572849697006, 'recall': 0.3775792652239557, 'f1-score': 0.2177564027506419, 'support': 31792}}
[[   28  9691   169]
 [   31 11812   146]
 [   32  9719   164]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1223/1223 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2232261
{'0': {'precision': 0.3924050632911392, 'recall': 0.00030682436779333895, 'f1-score': 0.0006131692940641257, 'support': 101035}, '1': {'precision': 0.3582580351825406, 'recall': 0.9977795216608107, 'f1-score': 0.5272162694486067, 'support': 112138}, '2': {'precision': 0.34375, 'recall': 0.0022030843180452634, 'f1-score': 0.004378109452736319, 'support': 99860}, 'accuracy': 0.3582369909881706, 'macro avg': {'precision': 0.36480436615789325, 'recall': 0.3334298101155498, 'f1-score': 0.17740251606513568, 'support': 313033}, 'weighted avg': {'precision': 0.36465120328821554, 'recall': 0.3582369909881706, 'f1-score': 0.19045956047127258, 'support': 313033}}
[[    31 100806    198]
 [    27 111889    222]
 [    21  99619    220]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2580357
{'0': {'precision': 0.3333333333333333, 'recall': 0.00036711944731835933, 'f1-score': 0.0007334311241498865, 'support': 29963}, '1': {'precision': 0.33090259120765847, 'recall': 0.9970263662195202, 'f1-score': 0.49689195531002234, 'support': 30266}, '2': {'precision': 0.32124352331606215, 'recall': 0.0019878166078871433, 'f1-score': 0.003951183761909314, 'support': 31190}, 'accuracy': 0.3308830768221048, 'macro avg': {'precision': 0.3284931492856846, 'recall': 0.3331271007582419, 'f1-score': 0.16719219006536049, 'support': 91419}, 'weighted avg': {'precision': 0.3284038327304568, 'recall': 0.3308830768221048, 'f1-score': 0.16609397540686283, 'support': 91419}}
[[   11 29895    57]
 [   16 30176    74]
 [    6 31122    62]]
Evaluating performance on  val set...
99/99 - 1s - 907ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2317653
{'0': {'precision': 0.25, 'recall': 0.00023792529145848205, 'f1-score': 0.0004753981459472308, 'support': 8406}, '1': {'precision': 0.3517276946879835, 'recall': 0.9978615644344401, 'f1-score': 0.5201220227619383, 'support': 8885}, '2': {'precision': 0.27906976744186046, 'recall': 0.0015062131291577758, 'f1-score': 0.00299625468164794, 'support': 7967}, 'accuracy': 0.35157177923826116, 'macro avg': {'precision': 0.29359915404328135, 'recall': 0.33320190095168545, 'f1-score': 0.17453122519651118, 'support': 25258}, 'weighted avg': {'precision': 0.2949540503805541, 'recall': 0.35157177923826116, 'f1-score': 0.1840664949759816, 'support': 25258}}
[[   2 8387   17]
 [   5 8866   14]
 [   1 7954   12]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1993427
{'0': {'precision': 0.35989492119089317, 'recall': 0.003404572564612326, 'f1-score': 0.006745334887003331, 'support': 120720}, '1': {'precision': 0.33423509471254975, 'recall': 0.9819311306830162, 'f1-score': 0.49871488590493446, 'support': 123306}, '2': {'precision': 0.3381108616819202, 'recall': 0.01564385072027229, 'f1-score': 0.029904086993707616, 'support': 125161}, 'accuracy': 0.3343752624008971, 'macro avg': {'precision': 0.34408029252845435, 'recall': 0.3336598513226336, 'f1-score': 0.17845476926188178, 'support': 369187}, 'weighted avg': {'precision': 0.3439395239641729, 'recall': 0.3343752624008971, 'f1-score': 0.1789111208714617, 'support': 369187}}
[[   411 118330   1979]
 [   374 121078   1854]
 [   357 122846   1958]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2123837
{'0': {'precision': 0.29457364341085274, 'recall': 0.002744474938610429, 'f1-score': 0.0054382826475849735, 'support': 41538}, '1': {'precision': 0.32526979360889813, 'recall': 0.9810594994644074, 'f1-score': 0.48855831772415087, 'support': 41076}, '2': {'precision': 0.35203574975173785, 'recall': 0.016232428224735564, 'f1-score': 0.031033879016020307, 'support': 43678}, 'accuracy': 0.3256025718176923, 'macro avg': {'precision': 0.32395972892382957, 'recall': 0.33334546754258443, 'f1-score': 0.17501015979591872, 'support': 126292}, 'weighted avg': {'precision': 0.3244306806443441, 'recall': 0.3256025718176923, 'f1-score': 0.1714234837607635, 'support': 126292}}
[[  114 40768   656]
 [  129 40298   649]
 [  144 42825   709]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2217921
{'0': {'precision': 0.33043478260869563, 'recall': 0.003017070265978563, 'f1-score': 0.005979543666404406, 'support': 12595}, '1': {'precision': 0.3227192654673571, 'recall': 0.9814920042211218, 'f1-score': 0.48572863312242637, 'support': 12319}, '2': {'precision': 0.3509700176366843, 'recall': 0.015037025842526825, 'f1-score': 0.02883848996449533, 'support': 13234}, 'accuracy': 0.3231624200482332, 'macro avg': {'precision': 0.3347080219042457, 'recall': 0.33318203344320907, 'f1-score': 0.173515555584442, 'support': 38148}, 'weighted avg': {'precision': 0.3350671576924812, 'recall': 0.3231624200482332, 'f1-score': 0.16883327986011495, 'support': 38148}}
[[   38 12375   182]
 [   42 12091   186]
 [   35 13000   199]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
5521/5521 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2839937
{'0': {'precision': 0.41237113402061853, 'recall': 0.0009962950278651266, 'f1-score': 0.0019877875303603485, 'support': 481785}, '1': {'precision': 0.32334897790906225, 'recall': 0.9948342924184486, 'f1-score': 0.4880636234481529, 'support': 456859}, '2': {'precision': 0.3021231098212922, 'recall': 0.004167140684186354, 'f1-score': 0.008220891788043964, 'support': 474666}, 'accuracy': 0.32332396997120233, 'macro avg': {'precision': 0.3459477405836577, 'recall': 0.33333257604350003, 'f1-score': 0.1660907675888524, 'support': 1413310}, 'weighted avg': {'precision': 0.346567055740859, 'recall': 0.32332396997120233, 'f1-score': 0.1612074654404752, 'support': 1413310}}
[[   480 478789   2516]
 [   307 454499   2053]
 [   377 472311   1978]]
Evaluating performance on  train set...
1289/1289 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2707801
{'0': {'precision': 0.3861003861003861, 'recall': 0.0009065772177145188, 'f1-score': 0.0018089070583553416, 'support': 110305}, '1': {'precision': 0.33291697639560813, 'recall': 0.9964983312359796, 'f1-score': 0.4990934127415472, 'support': 109662}, '2': {'precision': 0.33170334148329256, 'recall': 0.003707989030912056, 'f1-score': 0.007333994053518335, 'support': 109763}, 'accuracy': 0.3329542352834137, 'macro avg': {'precision': 0.35024023465976223, 'recall': 0.3337042991615354, 'f1-score': 0.16941210461780695, 'support': 329730}, 'weighted avg': {'precision': 0.3503044867786641, 'recall': 0.3329542352834137, 'f1-score': 0.16903561856801555, 'support': 329730}}
[[   100 109702    503]
 [    67 109278    317]
 [    92 109264    407]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2906806
{'0': {'precision': 0.3150684931506849, 'recall': 0.0005982728124024555, 'f1-score': 0.0011942778513383701, 'support': 38444}, '1': {'precision': 0.31975899725644197, 'recall': 0.9972596610927801, 'f1-score': 0.4842494025635455, 'support': 35762}, '2': {'precision': 0.40412979351032446, 'recall': 0.0036301006889242183, 'f1-score': 0.007195567110480842, 'support': 37740}, 'accuracy': 0.3200114340842906, 'macro avg': {'precision': 0.3463190946391505, 'recall': 0.3338293448647022, 'f1-score': 0.1642130825084549, 'support': 111946}, 'weighted avg': {'precision': 0.3465918640920574, 'recall': 0.3200114340842906, 'f1-score': 0.15753310216482871, 'support': 111946}}
[[   23 38295   126]
 [   22 35664    76]
 [   28 37575   137]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
5918/5918 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2505723
{'0': {'precision': 0.40262172284644193, 'recall': 0.0016795858063281325, 'f1-score': 0.0033452166319503196, 'support': 512031}, '1': {'precision': 0.3298833483535252, 'recall': 0.9939375951324283, 'f1-score': 0.4953592304913024, 'support': 498647}, '2': {'precision': 0.3286124401913876, 'recall': 0.0068090337675728195, 'f1-score': 0.013341621663623297, 'support': 504330}, 'accuracy': 0.3299771354342683, 'macro avg': {'precision': 0.35370583713045156, 'recall': 0.3341420715687764, 'f1-score': 0.1706820229289587, 'support': 1515008}, 'weighted avg': {'precision': 0.3540438448766932, 'recall': 0.3299771354342683, 'f1-score': 0.16861351813171005, 'support': 1515008}}
[[   860 506670   4501]
 [   508 495624   2515]
 [   768 500128   3434]]
Evaluating performance on  train set...
1814/1814 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2404333
{'0': {'precision': 0.36387434554973824, 'recall': 0.0017985495151032873, 'f1-score': 0.0035794068227614226, 'support': 154569}, '1': {'precision': 0.3311925228276974, 'recall': 0.9923663624511082, 'f1-score': 0.4966372449387397, 'support': 153400}, '2': {'precision': 0.37435500515995873, 'recall': 0.009282835391209776, 'f1-score': 0.01811643963891976, 'support': 156310}, 'accuracy': 0.33160664169604914, 'macro avg': {'precision': 0.3564739578457981, 'recall': 0.33448258245247375, 'f1-score': 0.1727776971334736, 'support': 464279}, 'weighted avg': {'precision': 0.3566046656764562, 'recall': 0.33160664169604914, 'f1-score': 0.17138229251538326, 'support': 464279}}
[[   278 152849   1442]
 [   188 152229    983]
 [   298 154561   1451]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2069763
{'0': {'precision': 0.3836065573770492, 'recall': 0.0022232356629802758, 'f1-score': 0.004420849785569892, 'support': 52626}, '1': {'precision': 0.36385246768763574, 'recall': 0.9913193855752602, 'f1-score': 0.5323221609712353, 'support': 58982}, '2': {'precision': 0.3715116279069767, 'recall': 0.012501467308369527, 'f1-score': 0.024188969224363095, 'support': 51114}, 'accuracy': 0.3639704526738855, 'macro avg': {'precision': 0.37299021765722057, 'recall': 0.33534802951553666, 'f1-score': 0.18697732666038944, 'support': 162722}, 'weighted avg': {'precision': 0.37264703166451946, 'recall': 0.3639704526738855, 'f1-score': 0.201979279459169, 'support': 162722}}
[[  117 51859   650]
 [   81 58470   431]
 [  107 50368   639]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
3755/3755 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1082693
{'0': {'precision': 0.3274466519499632, 'recall': 0.004763230005137866, 'f1-score': 0.009389869491364486, 'support': 280272}, '1': {'precision': 0.42810238799842626, 'recall': 0.9790437023526017, 'f1-score': 0.5957177436031713, 'support': 408994}, '2': {'precision': 0.33391592309815105, 'recall': 0.02670128761994432, 'f1-score': 0.04944847244405546, 'support': 271897}, 'accuracy': 0.42554488676738494, 'macro avg': {'precision': 0.3631549876821802, 'recall': 0.33683607332589466, 'f1-score': 0.21818536184619708, 'support': 961163}, 'weighted avg': {'precision': 0.3721077214322299, 'recall': 0.42554488676738494, 'f1-score': 0.2702159692387665, 'support': 961163}}
[[  1335 271617   7320]
 [  1409 400423   7162]
 [  1333 263304   7260]]
Evaluating performance on  train set...
1532/1532 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1990435
{'0': {'precision': 0.3619744058500914, 'recall': 0.004577646596434984, 'f1-score': 0.00904095828069588, 'support': 129761}, '1': {'precision': 0.33251275343361675, 'recall': 0.979908872938655, 'f1-score': 0.49653585541029654, 'support': 129709}, '2': {'precision': 0.3669481302774427, 'recall': 0.02292198838076723, 'f1-score': 0.04314863015155921, 'support': 132711}, 'accuracy': 0.33336393145001925, 'macro avg': {'precision': 0.35381176318705027, 'recall': 0.33580283597195243, 'f1-score': 0.18290848128085055, 'support': 392181}, 'weighted avg': {'precision': 0.3539133995014659, 'recall': 0.33336393145001925, 'f1-score': 0.18181561807665111, 'support': 392181}}
[[   594 126074   3093]
 [   451 127103   2155]
 [   596 129073   3042]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1608217
{'0': {'precision': 0.3226381461675579, 'recall': 0.004824479569261935, 'f1-score': 0.009506801827827094, 'support': 37517}, '1': {'precision': 0.36401095341343953, 'recall': 0.9764117060963459, 'f1-score': 0.5303171406997231, 'support': 43157}, '2': {'precision': 0.3524027459954233, 'recall': 0.02784882068769537, 'f1-score': 0.051618463895805405, 'support': 38709}, 'accuracy': 0.36351909400835963, 'macro avg': {'precision': 0.3463506151921403, 'recall': 0.3363616687844344, 'f1-score': 0.1971474688077852, 'support': 119383}, 'weighted avg': {'precision': 0.3472453694493263, 'recall': 0.36351909400835963, 'f1-score': 0.21143431346418895, 'support': 119383}}
[[  181 36217  1119]
 [  156 42139   862]
 [  224 37407  1078]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
4960/4960 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1953071
{'0': {'precision': 0.35730337078651686, 'recall': 0.00511717079764417, 'f1-score': 0.010089838544452402, 'support': 435006}, '1': {'precision': 0.3113996498649211, 'recall': 0.969373923967581, 'f1-score': 0.4713755915628636, 'support': 393227}, '2': {'precision': 0.36522578841706693, 'recall': 0.03255656964482712, 'f1-score': 0.059783942528879065, 'support': 441447}, 'accuracy': 0.3132931132253796, 'macro avg': {'precision': 0.3446429363561683, 'recall': 0.3356825548033508, 'f1-score': 0.18041645754539837, 'support': 1269680}, 'weighted avg': {'precision': 0.34584122680450335, 'recall': 0.3132931132253796, 'f1-score': 0.1702304455665241, 'support': 1269680}}
[[  2226 418136  14644]
 [  1708 381184  10335]
 [  2296 424779  14372]]
Evaluating performance on  train set...
1691/1691 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1791018
{'0': {'precision': 0.3687757394234369, 'recall': 0.006505987490009841, 'f1-score': 0.012786395794119556, 'support': 151399}, '1': {'precision': 0.3161112011161702, 'recall': 0.9576237043548328, 'f1-score': 0.4753195945258076, 'support': 136515}, '2': {'precision': 0.33335339431872896, 'recall': 0.03821845028634513, 'f1-score': 0.06857489507632501, 'support': 144930}, 'accuracy': 0.3170980769053054, 'macro avg': {'precision': 0.33941344495277864, 'recall': 0.3341160473770626, 'f1-score': 0.18556029513208405, 'support': 432844}, 'weighted avg': {'precision': 0.3403052975944134, 'recall': 0.3170980769053054, 'f1-score': 0.17734486680405945, 'support': 432844}}
[[   985 144306   6108]
 [   816 130730   4969]
 [   870 138521   5539]]
Evaluating performance on  val set...
591/591 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1978538
{'0': {'precision': 0.372960372960373, 'recall': 0.00588624825252005, 'f1-score': 0.011589583861504474, 'support': 54364}, '1': {'precision': 0.27755558779037237, 'recall': 0.9632506292700468, 'f1-score': 0.43093851549177953, 'support': 41715}, '2': {'precision': 0.3653042688465032, 'recall': 0.03652710925438198, 'f1-score': 0.06641347424042272, 'support': 55055}, 'accuracy': 0.2812934217317083, 'macro avg': {'precision': 0.33860674319908285, 'recall': 0.3352213289256496, 'f1-score': 0.16964719119790225, 'support': 151134}, 'weighted avg': {'precision': 0.3438384187650518, 'recall': 0.2812934217317083, 'f1-score': 0.14730669561510237, 'support': 151134}}
[[  320 51864  2180]
 [  219 40182  1314]
 [  319 52725  2011]]
testing model on single stock: results/universal/W8/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
10609/10609 - 79s - 79s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.200082
{'0': {'precision': 0.3750663129973475, 'recall': 0.006172923344379856, 'f1-score': 0.012145946054285489, 'support': 1030792}, '1': {'precision': 0.24604797670451975, 'recall': 0.9453701399735582, 'f1-score': 0.39046982234233235, 'support': 667126}, '2': {'precision': 0.3731075564872705, 'recall': 0.04966377274102837, 'f1-score': 0.08765934495684756, 'support': 1017764}, 'accuracy': 0.2531923840862074, 'macro avg': {'precision': 0.33140728206304587, 'recall': 0.3337356120196555, 'f1-score': 0.16342503778448847, 'support': 2715682}, 'weighted avg': {'precision': 0.3426379806379582, 'recall': 0.2531923840862074, 'f1-score': 0.13338418868107565, 'support': 2715682}}
[[  6363 971652  52777]
 [  4295 630681  32150]
 [  6307 960911  50546]]
Evaluating performance on  train set...
3903/3903 - 34s - 34s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1587332
{'0': {'precision': 0.33864947404139806, 'recall': 0.00600924267284852, 'f1-score': 0.01180893894080444, 'support': 332155}, '1': {'precision': 0.3305753337471035, 'recall': 0.9509483262957832, 'f1-score': 0.4906035996728423, 'support': 329897}, '2': {'precision': 0.3363669292764647, 'recall': 0.044087581710982725, 'f1-score': 0.07795730659551973, 'support': 337011}, 'accuracy': 0.3308790336545343, 'macro avg': {'precision': 0.3351972456883221, 'recall': 0.33368171689320486, 'f1-score': 0.19345661506972214, 'support': 999063}, 'weighted avg': {'precision': 0.33521337706408844, 'recall': 0.3308790336545343, 'f1-score': 0.19222363723630767, 'support': 999063}}
[[  1996 315101  15058]
 [  1926 313715  14256]
 [  1972 320181  14858]]
Evaluating performance on  val set...
1144/1144 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1676198
{'0': {'precision': 0.3633597078514912, 'recall': 0.005904460488576797, 'f1-score': 0.011620098683250124, 'support': 101110}, '1': {'precision': 0.3141565527865359, 'recall': 0.9522687352033079, 'f1-score': 0.47245023613310055, 'support': 91659}, '2': {'precision': 0.3389843393644519, 'recall': 0.04465072498598093, 'f1-score': 0.07890778460068307, 'support': 99864}, 'accuracy': 0.3155488273708023, 'macro avg': {'precision': 0.33883353333415966, 'recall': 0.33427464022595527, 'f1-score': 0.18765937313901127, 'support': 292633}, 'weighted avg': {'precision': 0.3396298694918789, 'recall': 0.3155488273708023, 'f1-score': 0.17892469876244269, 'support': 292633}}
[[  597 95689  4824]
 [  504 87284  3871]
 [  542 94863  4459]]
training model: results/universal/W8/deepVOL_L2/h500
Epoch 1/50
7696/7696 - 254s - loss: 3.2700 - accuracy500: 0.3745 - val_loss: 3.4112 - val_accuracy500: 0.3220 - 254s/epoch - 33ms/step
Epoch 2/50
7696/7696 - 253s - loss: 3.2591 - accuracy500: 0.3791 - val_loss: 3.4204 - val_accuracy500: 0.3277 - 253s/epoch - 33ms/step
Epoch 3/50
7696/7696 - 252s - loss: 3.2581 - accuracy500: 0.3795 - val_loss: 3.4366 - val_accuracy500: 0.3266 - 252s/epoch - 33ms/step
Epoch 4/50
7696/7696 - 250s - loss: 3.2579 - accuracy500: 0.3800 - val_loss: 3.4002 - val_accuracy500: 0.3258 - 250s/epoch - 32ms/step
Epoch 5/50
7696/7696 - 254s - loss: 3.2549 - accuracy500: 0.3820 - val_loss: 3.4792 - val_accuracy500: 0.3231 - 254s/epoch - 33ms/step
Epoch 6/50
7696/7696 - 255s - loss: 3.2537 - accuracy500: 0.3825 - val_loss: 3.5007 - val_accuracy500: 0.3216 - 255s/epoch - 33ms/step
Epoch 7/50
7696/7696 - 249s - loss: 3.2490 - accuracy500: 0.3858 - val_loss: 3.5053 - val_accuracy500: 0.3224 - 249s/epoch - 32ms/step
Epoch 8/50
7696/7696 - 250s - loss: 3.2466 - accuracy500: 0.3884 - val_loss: 3.6395 - val_accuracy500: 0.3217 - 250s/epoch - 33ms/step
Epoch 9/50
7696/7696 - 248s - loss: 3.2415 - accuracy500: 0.3904 - val_loss: 3.5271 - val_accuracy500: 0.3216 - 248s/epoch - 32ms/step
Epoch 10/50
7696/7696 - 250s - loss: 3.2379 - accuracy500: 0.3929 - val_loss: 3.5204 - val_accuracy500: 0.3222 - 250s/epoch - 33ms/step
Epoch 11/50
7696/7696 - 246s - loss: 3.2352 - accuracy500: 0.3960 - val_loss: 3.5859 - val_accuracy500: 0.3217 - 246s/epoch - 32ms/step
Epoch 12/50
7696/7696 - 246s - loss: 3.2325 - accuracy500: 0.3982 - val_loss: 3.5535 - val_accuracy500: 0.3223 - 246s/epoch - 32ms/step
Epoch 13/50
7696/7696 - 248s - loss: 3.2293 - accuracy500: 0.4007 - val_loss: 3.5141 - val_accuracy500: 0.3230 - 248s/epoch - 32ms/step
Epoch 14/50
7696/7696 - 244s - loss: 3.2265 - accuracy500: 0.4025 - val_loss: 3.5477 - val_accuracy500: 0.3230 - 244s/epoch - 32ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 365s - 365s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1504399
{'0': {'precision': 0.3805950976536899, 'recall': 0.06777095919775407, 'f1-score': 0.11505462752948524, 'support': 2142186}, '1': {'precision': 0.2922016612494423, 'recall': 0.925978225838881, 'f1-score': 0.44422400786414334, 'support': 1715887}, '2': {'precision': 0.37930159803838676, 'recall': 0.025598995670254577, 'f1-score': 0.04796110510468772, 'support': 2102895}, 'accuracy': 0.29993182315355493, 'macro avg': {'precision': 0.35069945231383964, 'recall': 0.33978272690229655, 'f1-score': 0.2024132468327721, 'support': 5960968}, 'weighted avg': {'precision': 0.35469439792087837, 'recall': 0.29993182315355493, 'f1-score': 0.18613818772890267, 'support': 5960968}}
[[ 145178 1942237   54771]
 [  93692 1588874   33321]
 [ 142580 1906483   53832]]
Evaluating performance on  train set...
7696/7696 - 128s - 128s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1285565
{'0': {'precision': 0.3436365840267528, 'recall': 0.07371762024580698, 'f1-score': 0.12139363133050886, 'support': 653765}, '1': {'precision': 0.33271626312189106, 'recall': 0.9093369730468341, 'f1-score': 0.48717911725583185, 'support': 649868}, '2': {'precision': 0.35040867829296773, 'recall': 0.02794335635664049, 'f1-score': 0.051759174902113514, 'support': 665847}, 'accuracy': 0.3339708958709913, 'macro avg': {'precision': 0.34225384181387053, 'recall': 0.3369993165497605, 'f1-score': 0.22011064116281806, 'support': 1969480}, 'weighted avg': {'precision': 0.3423227405478019, 'recall': 0.3339708958709913, 'f1-score': 0.21854942283783058, 'support': 1969480}}
[[ 48194 587085  18486]
 [ 42913 590949  16006]
 [ 49140 598101  18606]]
Evaluating performance on  val set...
2338/2338 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1353
{'0': {'precision': 0.3507066512516811, 'recall': 0.07316941101183884, 'f1-score': 0.12107784040924051, 'support': 203145}, '1': {'precision': 0.3235229143887176, 'recall': 0.9074837795898814, 'f1-score': 0.47699463954094656, 'support': 192042}, '2': {'precision': 0.3450173465725565, 'recall': 0.0284708751042731, 'f1-score': 0.052601100719982134, 'support': 202593}, 'accuracy': 0.3260513901435311, 'macro avg': {'precision': 0.33974897073765176, 'recall': 0.3363746885686644, 'f1-score': 0.21689119355672307, 'support': 597780}, 'weighted avg': {'precision': 0.3400454841040764, 'recall': 0.3260513901435311, 'f1-score': 0.21221181246415233, 'support': 597780}}
[[ 14864 182403   5878]
 [ 12695 174275   5072]
 [ 14824 182001   5768]]
testing model out of sample: results/universal/W8/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 229s - 229s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1496754
{'0': {'precision': 0.3829583781179348, 'recall': 0.04141398999741078, 'f1-score': 0.07474489685195553, 'support': 1247477}, '1': {'precision': 0.3113640192973086, 'recall': 0.9543778748222186, 'f1-score': 0.4695411164213361, 'support': 1117243}, '2': {'precision': 0.3293923079629825, 'recall': 0.014959146397004654, 'f1-score': 0.028618597043672325, 'support': 1251542}, 'accuracy': 0.3143182103509093, 'macro avg': {'precision': 0.3412382351260754, 'recall': 0.336917003738878, 'f1-score': 0.190968203438988, 'support': 3616262}, 'weighted avg': {'precision': 0.34230079224453785, 'recall': 0.3143182103509093, 'f1-score': 0.18075334182239602, 'support': 3616262}}
[[  51663 1174433   21381]
 [  34236 1066272   16735]
 [  49006 1183814   18722]]
Evaluating performance on  train set...
4550/4550 - 78s - 78s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1330805
{'0': {'precision': 0.37116055931509256, 'recall': 0.0487681131567821, 'f1-score': 0.0862089270992816, 'support': 390255}, '1': {'precision': 0.3341920310412358, 'recall': 0.9495387319549029, 'f1-score': 0.4943844714661294, 'support': 384592}, '2': {'precision': 0.34285288566603755, 'recall': 0.017731644164971333, 'f1-score': 0.03371939097006141, 'support': 389304}, 'accuracy': 0.33597016194634544, 'macro avg': {'precision': 0.3494018253407886, 'recall': 0.3386794964255521, 'f1-score': 0.20477092984515746, 'support': 1164151}, 'weighted avg': {'precision': 0.34948116307854693, 'recall': 0.33597016194634544, 'f1-score': 0.20350184063531326, 'support': 1164151}}
[[ 19032 363822   7401]
 [ 13577 365185   5830]
 [ 18668 363733   6903]]
Evaluating performance on  val set...
1570/1570 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.131396
{'0': {'precision': 0.37780506866138214, 'recall': 0.049493221008292745, 'f1-score': 0.0875210138368033, 'support': 136746}, '1': {'precision': 0.32729625871807366, 'recall': 0.9505042380746148, 'f1-score': 0.4869249648882664, 'support': 129304}, '2': {'precision': 0.3618196160925585, 'recall': 0.0203877525318003, 'f1-score': 0.03860045305037556, 'support': 134983}, 'accuracy': 0.3302072398032082, 'macro avg': {'precision': 0.35564031449067146, 'recall': 0.3401284038715693, 'f1-score': 0.2043488105918151, 'support': 401033}, 'weighted avg': {'precision': 0.35613913217982807, 'recall': 0.3302072398032082, 'f1-score': 0.1998336774583108, 'support': 401033}}
[[  6768 127230   2748]
 [  4294 122904   2106]
 [  6852 125379   2752]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1562349
{'0': {'precision': 0.3652551878855861, 'recall': 0.08208861158379026, 'f1-score': 0.1340503267637524, 'support': 63468}, '1': {'precision': 0.23365007614230687, 'recall': 0.8874116723370845, 'f1-score': 0.3699061271020493, 'support': 38210}, '2': {'precision': 0.4067184395882247, 'recall': 0.03560699490876893, 'f1-score': 0.06548129625052701, 'support': 63246}, 'accuracy': 0.2508428124469453, 'macro avg': {'precision': 0.3352079012053725, 'recall': 0.3350357596098812, 'f1-score': 0.18981258337210957, 'support': 164924}, 'weighted avg': {'precision': 0.3506651554917221, 'recall': 0.2508428124469453, 'f1-score': 0.16239873710479963, 'support': 164924}}
[[ 5210 56149  2109]
 [ 3126 33908  1176]
 [ 5928 55066  2252]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1361719
{'0': {'precision': 0.3646425366437332, 'recall': 0.06449394211946458, 'f1-score': 0.10960258946232691, 'support': 18901}, '1': {'precision': 0.33529599879606464, 'recall': 0.9444179515710274, 'f1-score': 0.49489115948467344, 'support': 18873}, '2': {'precision': 0.3895705521472393, 'recall': 0.013106295149638804, 'f1-score': 0.025359424920127795, 'support': 19380}, 'accuracy': 0.33763166182594395, 'macro avg': {'precision': 0.36316969586234565, 'recall': 0.3406727296133769, 'f1-score': 0.20995105795570937, 'support': 57154}, 'weighted avg': {'precision': 0.3634046133428076, 'recall': 0.33763166182594395, 'f1-score': 0.20826442683510793, 'support': 57154}}
[[ 1219 17427   255]
 [  906 17824   143]
 [ 1218 17908   254]]
Evaluating performance on  val set...
68/68 - 1s - 649ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.148292
{'0': {'precision': 0.38685446009389673, 'recall': 0.06226386580021158, 'f1-score': 0.1072637334027597, 'support': 6617}, '1': {'precision': 0.28892787768657185, 'recall': 0.9236778846153846, 'f1-score': 0.440169920290201, 'support': 4992}, '2': {'precision': 0.39906103286384975, 'recall': 0.015103056147832267, 'f1-score': 0.029104605375791816, 'support': 5628}, 'accuracy': 0.29633927017462436, 'macro avg': {'precision': 0.3582811235481061, 'recall': 0.3336816021878095, 'f1-score': 0.19217941968958419, 'support': 17237}, 'weighted avg': {'precision': 0.36247951620412067, 'recall': 0.29633927017462436, 'f1-score': 0.1781570508249522, 'support': 17237}}
[[ 412 6135   70]
 [ 323 4611   58]
 [ 330 5213   85]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2363971
{'0': {'precision': 0.39141414141414144, 'recall': 0.002917660788991948, 'f1-score': 0.005792146036817496, 'support': 212499}, '1': {'precision': 0.2775237456940661, 'recall': 0.9957915831663327, 'f1-score': 0.43407285505355503, 'support': 154690}, '2': {'precision': 0.48257839721254353, 'recall': 0.002906747957668515, 'f1-score': 0.00577868873833701, 'support': 190591}, 'accuracy': 0.27826921008282834, 'macro avg': {'precision': 0.38383876144025036, 'recall': 0.333871997304331, 'f1-score': 0.14854789660956985, 'support': 557780}, 'weighted avg': {'precision': 0.3909791694949884, 'recall': 0.27826921008282834, 'f1-score': 0.1245633067772966, 'support': 557780}}
[[   620 211528    351]
 [   408 154039    243]
 [   556 189481    554]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1816483
{'0': {'precision': 0.4324786324786325, 'recall': 0.009415004465614767, 'f1-score': 0.018428815966784428, 'support': 53744}, '1': {'precision': 0.33089267545045914, 'recall': 0.9917200648498418, 'f1-score': 0.4962191812571825, 'support': 51812}, '2': {'precision': 0.33914421553090335, 'recall': 0.0041528400380353575, 'f1-score': 0.008205206855565354, 'support': 51531}, 'accuracy': 0.33168244348673026, 'macro avg': {'precision': 0.3675051744866649, 'recall': 0.3350959697844973, 'f1-score': 0.1742844013598441, 'support': 157087}, 'weighted avg': {'precision': 0.36835501024842154, 'recall': 0.33168244348673026, 'f1-score': 0.1726646318224305, 'support': 157087}}
[[  506 52973   265]
 [  277 51383   152]
 [  387 50930   214]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1829418
{'0': {'precision': 0.4028169014084507, 'recall': 0.008499762244412744, 'f1-score': 0.01664823330810874, 'support': 16824}, '1': {'precision': 0.324659828344149, 'recall': 0.9808373387300784, 'f1-score': 0.48784247113963064, 'support': 15812}, '2': {'precision': 0.1793103448275862, 'recall': 0.0048982667671439335, 'f1-score': 0.00953603520997616, 'support': 15924}, 'accuracy': 0.3239291598023064, 'macro avg': {'precision': 0.3022623581933953, 'recall': 0.33141178924721165, 'f1-score': 0.17134224655257183, 'support': 48560}, 'weighted avg': {'precision': 0.304074355150493, 'recall': 0.3239291598023064, 'f1-score': 0.16774519883688468, 'support': 48560}}
[[  143 16523   158]
 [  104 15509   199]
 [  108 15738    78]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
1162/1162 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0353922
{'0': {'precision': 0.35227722772277226, 'recall': 0.04846817147761174, 'f1-score': 0.08521237231915124, 'support': 73409}, '1': {'precision': 0.4943902063227487, 'recall': 0.9710174830465343, 'f1-score': 0.6551917766897928, 'support': 145398}, '2': {'precision': 0.2573981016192071, 'recall': 0.0058609641985353945, 'f1-score': 0.011460961875520528, 'support': 78656}, 'accuracy': 0.4881380205269227, 'macro avg': {'precision': 0.368021845221576, 'recall': 0.3417822062408939, 'f1-score': 0.25062170362815483, 'support': 297463}, 'weighted avg': {'precision': 0.39665293266650425, 'recall': 0.4881380205269227, 'f1-score': 0.34431308231275826, 'support': 297463}}
[[  3558  69227    624]
 [  3508 141184    706]
 [  3034  75161    461]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152651
{'0': {'precision': 0.37929389312977096, 'recall': 0.05662191517396104, 'f1-score': 0.0985343785827162, 'support': 28081}, '1': {'precision': 0.3507860105484152, 'recall': 0.9468228464807712, 'f1-score': 0.511914213923424, 'support': 28941}, '2': {'precision': 0.3163265306122449, 'recall': 0.015173192771084337, 'f1-score': 0.02895739024214989, 'support': 26560}, 'accuracy': 0.3516905553827379, 'macro avg': {'precision': 0.34880214476347704, 'recall': 0.33953931814193883, 'f1-score': 0.21313532758276335, 'support': 83582}, 'weighted avg': {'precision': 0.3494135387681559, 'recall': 0.3516905553827379, 'f1-score': 0.21956116669821932, 'support': 83582}}
[[ 1590 26032   459]
 [ 1127 27402   412]
 [ 1475 24682   403]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989068
{'0': {'precision': 0.3764093668690373, 'recall': 0.044627249357326475, 'f1-score': 0.07979407979407979, 'support': 9725}, '1': {'precision': 0.3969177855678286, 'recall': 0.9641709511568124, 'f1-score': 0.5623389401677366, 'support': 12448}, '2': {'precision': 0.3516209476309227, 'recall': 0.014658488408358457, 'f1-score': 0.028143712574850297, 'support': 9619}, 'accuracy': 0.395602667337695, 'macro avg': {'precision': 0.3749827000225962, 'recall': 0.34115222964083247, 'f1-score': 0.22342557751222222, 'support': 31792}, 'weighted avg': {'precision': 0.3769393426903486, 'recall': 0.395602667337695, 'f1-score': 0.25310477241013135, 'support': 31792}}
[[  434  9167   124]
 [  310 12002   136]
 [  409  9069   141]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1223/1223 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060513
{'0': {'precision': 0.318394613644732, 'recall': 0.06000079300568981, 'f1-score': 0.10097336791972841, 'support': 100882}, '1': {'precision': 0.3509764443274618, 'recall': 0.9319180220737728, 'f1-score': 0.5099114266345844, 'support': 110176}, '2': {'precision': 0.3099257258609048, 'recall': 0.004501103211571464, 'f1-score': 0.008873337457469842, 'support': 101975}, 'accuracy': 0.3488034807831762, 'macro avg': {'precision': 0.32643226127769953, 'recall': 0.33213997276367807, 'f1-score': 0.20658604400392758, 'support': 313033}, 'weighted avg': {'precision': 0.3271033470547707, 'recall': 0.3488034807831762, 'f1-score': 0.21490148077230037, 'support': 313033}}
[[  6053  94352    477]
 [  6956 102675    545]
 [  6002  95514    459]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125149
{'0': {'precision': 0.32, 'recall': 0.0593682099281297, 'f1-score': 0.10015508247568025, 'support': 29915}, '1': {'precision': 0.32936591531493575, 'recall': 0.9309318249479012, 'f1-score': 0.4865790087917218, 'support': 30231}, '2': {'precision': 0.33569739952718675, 'recall': 0.004540658075656317, 'f1-score': 0.008960121150933871, 'support': 31273}, 'accuracy': 0.32882661153589515, 'macro avg': {'precision': 0.32835443828070754, 'recall': 0.33161356431722905, 'f1-score': 0.19856473747277867, 'support': 91419}, 'weighted avg': {'precision': 0.32846701190452243, 'recall': 0.32882661153589515, 'f1-score': 0.19674377509922084, 'support': 91419}}
[[ 1776 28019   120]
 [ 1927 28143   161]
 [ 1847 29284   142]]
Evaluating performance on  val set...
99/99 - 1s - 912ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014671
{'0': {'precision': 0.3426892950391645, 'recall': 0.06470298249938378, 'f1-score': 0.10885341074020317, 'support': 8114}, '1': {'precision': 0.3686571585763257, 'recall': 0.9352587502684131, 'f1-score': 0.5288528670734298, 'support': 9314}, '2': {'precision': 0.25773195876288657, 'recall': 0.0031928480204342275, 'f1-score': 0.006307556452630252, 'support': 7830}, 'accuracy': 0.36665610895557843, 'macro avg': {'precision': 0.3230261374594589, 'recall': 0.3343848602627437, 'f1-score': 0.2146712780887544, 'support': 25258}, 'weighted avg': {'precision': 0.3259282188629773, 'recall': 0.36665610895557843, 'f1-score': 0.23194078492723216, 'support': 25258}}
[[ 525 7557   32]
 [ 563 8711   40]
 [ 444 7361   25]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1164337
{'0': {'precision': 0.37195094957722785, 'recall': 0.07036615188770895, 'f1-score': 0.11834386202136725, 'support': 119404}, '1': {'precision': 0.3451081587212646, 'recall': 0.9273029834779508, 'f1-score': 0.5030132393397524, 'support': 126195}, '2': {'precision': 0.31598562491681087, 'recall': 0.01920898469107033, 'f1-score': 0.03621635227801466, 'support': 123588}, 'accuracy': 0.3461579091354788, 'macro avg': {'precision': 0.34434824440510114, 'recall': 0.33895937335224335, 'f1-score': 0.21919115121304478, 'support': 369187}, 'weighted avg': {'precision': 0.34404078877470795, 'recall': 0.3461579091354788, 'f1-score': 0.2223382534721284, 'support': 369187}}
[[  8402 108432   2570]
 [  6605 117021   2569]
 [  7582 113632   2374]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1236161
{'0': {'precision': 0.35016356137107096, 'recall': 0.060164707607340974, 'f1-score': 0.10268601935268602, 'support': 40921}, '1': {'precision': 0.3355248514732823, 'recall': 0.9364233663839445, 'f1-score': 0.4940347515897876, 'support': 41855}, '2': {'precision': 0.3481814466693911, 'recall': 0.01957900542329258, 'f1-score': 0.03707329808759219, 'support': 43516}, 'accuracy': 0.3365850568523739, 'macro avg': {'precision': 0.34462328650458146, 'recall': 0.3387223598048594, 'f1-score': 0.21126468967668863, 'support': 126292}, 'weighted avg': {'precision': 0.3446291102092377, 'recall': 0.3365850568523739, 'f1-score': 0.20977671400644132, 'support': 126292}}
[[ 2462 37616   843]
 [ 1909 39194   752]
 [ 2660 40004   852]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1282678
{'0': {'precision': 0.3443708609271523, 'recall': 0.051126587464154036, 'f1-score': 0.08903474352571877, 'support': 12205}, '1': {'precision': 0.3352280682104556, 'recall': 0.9497818326061087, 'f1-score': 0.4955503125129352, 'support': 12605}, '2': {'precision': 0.43820224719101125, 'recall': 0.02046783625730994, 'f1-score': 0.03910894635054796, 'support': 13338}, 'accuracy': 0.3373440285204991, 'macro avg': {'precision': 0.3726003921095397, 'recall': 0.34045875210919085, 'f1-score': 0.20789800079640064, 'support': 38148}, 'weighted avg': {'precision': 0.3741569081063855, 'recall': 0.3373440285204991, 'f1-score': 0.20590111828616323, 'support': 38148}}
[[  624 11407   174]
 [  457 11972   176]
 [  731 12334   273]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
5521/5521 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2037749
{'0': {'precision': 0.3723036223036223, 'recall': 0.007383134008220521, 'f1-score': 0.014479133072294759, 'support': 495589}, '1': {'precision': 0.29831048316388065, 'recall': 0.9897952883062601, 'f1-score': 0.4584504118027197, 'support': 421080}, '2': {'precision': 0.4129714375887644, 'recall': 0.005269399828044805, 'f1-score': 0.010406021734549025, 'support': 496641}, 'accuracy': 0.29933914003297224, 'macro avg': {'precision': 0.36119518101875575, 'recall': 0.3341492740475085, 'f1-score': 0.16111185553652116, 'support': 1413310}, 'weighted avg': {'precision': 0.36454897075659143, 'recall': 0.29933914003297224, 'f1-score': 0.14532413661710658, 'support': 1413310}}
[[  3659 489869   2061]
 [  2638 416783   1659]
 [  3531 490493   2617]]
Evaluating performance on  train set...
1289/1289 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1777117
{'0': {'precision': 0.38945147679324893, 'recall': 0.008422455013322627, 'f1-score': 0.016488325979385127, 'support': 109588}, '1': {'precision': 0.33093759206520673, 'recall': 0.9900570137989919, 'f1-score': 0.49606119918946956, 'support': 108921}, '2': {'precision': 0.38430851063829785, 'recall': 0.005196860305158198, 'f1-score': 0.010255045464626304, 'support': 111221}, 'accuracy': 0.33160161344130046, 'macro avg': {'precision': 0.36823252649891786, 'recall': 0.3345587763724909, 'f1-score': 0.17426819021116033, 'support': 329730}, 'weighted avg': {'precision': 0.3683875861033423, 'recall': 0.33160161344130046, 'f1-score': 0.17280496453451696, 'support': 329730}}
[[   923 108215    450]
 [   607 107838    476]
 [   840 109803    578]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1920968
{'0': {'precision': 0.3970856102003643, 'recall': 0.00561928083515917, 'f1-score': 0.011081740544936967, 'support': 38795}, '1': {'precision': 0.31900525822948933, 'recall': 0.9934666180635392, 'f1-score': 0.4829377006276963, 'support': 35663}, '2': {'precision': 0.3333333333333333, 'recall': 0.0029609475032010245, 'f1-score': 0.0058697548980725, 'support': 37488}, 'accuracy': 0.3194307969914066, 'macro avg': {'precision': 0.34980806725439567, 'recall': 0.3340156154672998, 'f1-score': 0.1666297320235686, 'support': 111946}, 'weighted avg': {'precision': 0.3508622083143785, 'recall': 0.3194307969914066, 'f1-score': 0.159657055308321, 'support': 111946}}
[[  218 38446   131]
 [  142 35430    91]
 [  189 37188   111]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
5918/5918 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1625513
{'0': {'precision': 0.36482174106989673, 'recall': 0.020412316506099506, 'f1-score': 0.03866146671393897, 'support': 520862}, '1': {'precision': 0.3235036302400848, 'recall': 0.963487139322813, 'f1-score': 0.4843726849205368, 'support': 490293}, '2': {'precision': 0.28894697826850296, 'recall': 0.014698731574487003, 'f1-score': 0.02797440527003649, 'support': 503853}, 'accuracy': 0.32371380217134166, 'macro avg': {'precision': 0.32575744985949484, 'recall': 0.3328660624677999, 'f1-score': 0.18366951896817074, 'support': 1515008}, 'weighted avg': {'precision': 0.32621619748540637, 'recall': 0.32371380217134166, 'f1-score': 0.179350085083263, 'support': 1515008}}
[[ 10632 501112   9118]
 [  8795 472391   9107]
 [  9716 486731   7406]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1530167
{'0': {'precision': 0.35410537576892215, 'recall': 0.02572055766727752, 'f1-score': 0.04795769291138935, 'support': 154429}, '1': {'precision': 0.3319366999312542, 'recall': 0.9641929547501272, 'f1-score': 0.4938565001437271, 'support': 153238}, '2': {'precision': 0.3363544813695871, 'recall': 0.017061272444001737, 'f1-score': 0.032475266778482705, 'support': 156612}, 'accuracy': 0.3325478860771217, 'macro avg': {'precision': 0.34079885235658786, 'recall': 0.33565826162046886, 'f1-score': 0.19142981994453304, 'support': 464279}, 'weighted avg': {'precision': 0.3408006891006016, 'recall': 0.3325478860771217, 'f1-score': 0.18990662383685056, 'support': 464279}}
[[  3972 147666   2791]
 [  3006 147751   2481]
 [  4239 149701   2672]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1429527
{'0': {'precision': 0.3401178361006963, 'recall': 0.023587533895471937, 'f1-score': 0.044115603723773794, 'support': 53842}, '1': {'precision': 0.3505173818489745, 'recall': 0.9598924844524086, 'f1-score': 0.5135171966560622, 'support': 56922}, '2': {'precision': 0.33472803347280333, 'recall': 0.020016166904037878, 'f1-score': 0.037773540361391085, 'support': 51958}, 'accuracy': 0.349977261833065, 'macro avg': {'precision': 0.34178775047415805, 'recall': 0.33449872841730616, 'f1-score': 0.1984687802470757, 'support': 162722}, 'weighted avg': {'precision': 0.34203472243532484, 'recall': 0.349977261833065, 'f1-score': 0.20629254688271387, 'support': 162722}}
[[ 1270 51637   935]
 [ 1151 54639  1132]
 [ 1313 49605  1040]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
3755/3755 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095636
{'0': {'precision': 0.3705553281484514, 'recall': 0.043823723999935456, 'f1-score': 0.07837806637806638, 'support': 309855}, '1': {'precision': 0.3723416388840147, 'recall': 0.9609306011547606, 'f1-score': 0.5367163046571185, 'support': 353320}, '2': {'precision': 0.35478782142293736, 'recall': 0.015094567566479188, 'f1-score': 0.028957143684857696, 'support': 297988}, 'accuracy': 0.3720419949581913, 'macro avg': {'precision': 0.3658949294851345, 'recall': 0.3399496309070584, 'f1-score': 0.21468383824001416, 'support': 961163}, 'weighted avg': {'precision': 0.3663235917155745, 'recall': 0.3720419949581913, 'f1-score': 0.23153962631873287, 'support': 961163}}
[[ 13579 291896   4380]
 [ 10004 339516   3800]
 [ 13062 280428   4498]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162646
{'0': {'precision': 0.38680667463741747, 'recall': 0.05718875131616364, 'f1-score': 0.09964512889186473, 'support': 130113}, '1': {'precision': 0.3373475863916275, 'recall': 0.952484951381386, 'f1-score': 0.49823289460139714, 'support': 129580}, '2': {'precision': 0.3885044485242197, 'recall': 0.02076414467725379, 'f1-score': 0.03942136147711884, 'support': 132488}, 'accuracy': 0.3406972800824109, 'macro avg': {'precision': 0.37088623651775493, 'recall': 0.3434792824582678, 'f1-score': 0.21243312832346026, 'support': 392181}, 'weighted avg': {'precision': 0.3710385114980129, 'recall': 0.3406972800824109, 'f1-score': 0.21099696945373886, 'support': 392181}}
[[  7441 119995   2677]
 [  4504 123423   1653]
 [  7292 122445   2751]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1260284
{'0': {'precision': 0.3663147943910509, 'recall': 0.0590956459853087, 'f1-score': 0.10177281680892974, 'support': 39343}, '1': {'precision': 0.32596655082536924, 'recall': 0.9385308908981942, 'f1-score': 0.4838755180590167, 'support': 38377}, '2': {'precision': 0.3578740157480315, 'recall': 0.02181791997695797, 'f1-score': 0.04112843019704544, 'support': 41663}, 'accuracy': 0.3287905313151789, 'macro avg': {'precision': 0.35005178698815054, 'recall': 0.3398148189534869, 'f1-score': 0.2089255883549973, 'support': 119383}, 'weighted avg': {'precision': 0.35039868653713296, 'recall': 0.3287905313151789, 'f1-score': 0.2034399577457771, 'support': 119383}}
[[ 2325 36119   899]
 [ 1627 36018   732]
 [ 2395 38359   909]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
4960/4960 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1698477
{'0': {'precision': 0.4033976781397882, 'recall': 0.050385470750572994, 'f1-score': 0.0895819157783322, 'support': 470334}, '1': {'precision': 0.2527728514274135, 'recall': 0.9518488272000051, 'f1-score': 0.39946407481780194, 'support': 317147}, '2': {'precision': 0.38174622211561526, 'recall': 0.013202018253874438, 'f1-score': 0.02552142320220496, 'support': 482199}, 'accuracy': 0.26143595236595046, 'macro avg': {'precision': 0.345972250560939, 'recall': 0.3384787720681508, 'f1-score': 0.171522471266113, 'support': 1269680}, 'weighted avg': {'precision': 0.3575510692613703, 'recall': 0.26143595236595046, 'f1-score': 0.14265693596702125, 'support': 1269680}}
[[ 23698 439482   7154]
 [ 12115 301876   3156]
 [ 22933 452900   6366]]
Evaluating performance on  train set...
1691/1691 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.117515
{'0': {'precision': 0.3785677321762669, 'recall': 0.06429020503910818, 'f1-score': 0.1099142414645986, 'support': 147923}, '1': {'precision': 0.3331757904028848, 'recall': 0.9403536012986554, 'f1-score': 0.4920232802044404, 'support': 141685}, '2': {'precision': 0.34818692543411645, 'recall': 0.019038509871819934, 'f1-score': 0.03610294701723727, 'support': 143236}, 'accuracy': 0.3360818216262672, 'macro avg': {'precision': 0.3533101493377561, 'recall': 0.3412274387365279, 'f1-score': 0.21268015622875877, 'support': 432844}, 'weighted avg': {'precision': 0.3536557950703343, 'recall': 0.3360818216262672, 'f1-score': 0.21056640386581532, 'support': 432844}}
[[  9510 135306   3107]
 [  6453 133234   1998]
 [  9158 131351   2727]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1247565
{'0': {'precision': 0.40300840007814026, 'recall': 0.07590558713689129, 'f1-score': 0.12774982583791314, 'support': 54357}, '1': {'precision': 0.28775860065086006, 'recall': 0.9356827361409642, 'f1-score': 0.44015311026049864, 'support': 42337}, '2': {'precision': 0.40129950495049505, 'recall': 0.023824393828067596, 'f1-score': 0.04497849909834928, 'support': 54440}, 'accuracy': 0.29799383328701684, 'macro avg': {'precision': 0.36402216855983177, 'recall': 0.345137572368641, 'f1-score': 0.2042938117322537, 'support': 151134}, 'weighted avg': {'precision': 0.37010804007243825, 'recall': 0.29799383328701684, 'f1-score': 0.18544794025887168, 'support': 151134}}
[[ 4126 48895  1336]
 [ 2124 39614   599]
 [ 3988 49155  1297]]
testing model on single stock: results/universal/W8/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
10609/10609 - 92s - 92s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246544
{'0': {'precision': 0.3853997100417133, 'recall': 0.11845184641587866, 'f1-score': 0.18120935294333088, 'support': 1023361}, '1': {'precision': 0.25239841169898747, 'recall': 0.8507554450719088, 'f1-score': 0.3893007702641973, 'support': 676621}, '2': {'precision': 0.37999468782682316, 'recall': 0.04507334842965442, 'f1-score': 0.08058772481072507, 'support': 1015700}, 'accuracy': 0.27346316689509303, 'macro avg': {'precision': 0.3392642698558413, 'recall': 0.3380935466391473, 'f1-score': 0.2170326160060844, 'support': 2715682}, 'weighted avg': {'precision': 0.35024045628902156, 'recall': 0.27346316689509303, 'f1-score': 0.19542222292765685, 'support': 2715682}}
[[121219 854600  47542]
 [ 73827 575639  27155]
 [119482 850437  45781]]
Evaluating performance on  train set...
3903/3903 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110169
{'0': {'precision': 0.3369463485074028, 'recall': 0.11440807493833326, 'f1-score': 0.17081646301785844, 'support': 330405}, '1': {'precision': 0.3322249132527921, 'recall': 0.8509735093707109, 'f1-score': 0.4778819763877745, 'support': 329324}, '2': {'precision': 0.3462488172985946, 'recall': 0.04421602315123153, 'f1-score': 0.07841805015849289, 'support': 339334}, 'accuracy': 0.3333633614696971, 'macro avg': {'precision': 0.3384733596862632, 'recall': 0.3365325358200919, 'f1-score': 0.24237216318804197, 'support': 999063}, 'weighted avg': {'precision': 0.3385496127670149, 'recall': 0.3333633614696971, 'f1-score': 0.24065201902965577, 'support': 999063}}
[[ 37801 277667  14937]
 [ 35686 280246  13392]
 [ 38700 285630  15004]]
Evaluating performance on  val set...
1144/1144 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124547
{'0': {'precision': 0.3491697689534952, 'recall': 0.11809851202670157, 'f1-score': 0.1765000186685584, 'support': 100069}, '1': {'precision': 0.3196907796560413, 'recall': 0.8442224040656359, 'f1-score': 0.4637633155693829, 'support': 92876}, '2': {'precision': 0.3455083179297597, 'recall': 0.04687625391220608, 'f1-score': 0.08255235706146821, 'support': 99688}, 'accuracy': 0.3242935690779919, 'macro avg': {'precision': 0.33812295551309873, 'recall': 0.33639905666818115, 'f1-score': 0.24093856376646985, 'support': 292633}, 'weighted avg': {'precision': 0.33856640795304593, 'recall': 0.3242935690779919, 'f1-score': 0.23566768421780737, 'support': 292633}}
[[11818 83503  4748]
 [10364 78408  4104]
 [11664 83351  4673]]
training model: results/universal/W8/deepVOL_L2/h1000
Epoch 1/50
7696/7696 - 251s - loss: 3.2725 - accuracy1000: 0.3734 - val_loss: 3.3105 - val_accuracy1000: 0.3227 - 251s/epoch - 33ms/step
Epoch 2/50
7696/7696 - 245s - loss: 3.2647 - accuracy1000: 0.3768 - val_loss: 3.3302 - val_accuracy1000: 0.3267 - 245s/epoch - 32ms/step
Epoch 3/50
7696/7696 - 245s - loss: 3.2645 - accuracy1000: 0.3777 - val_loss: 3.3268 - val_accuracy1000: 0.3251 - 245s/epoch - 32ms/step
Epoch 4/50
7696/7696 - 245s - loss: 3.2623 - accuracy1000: 0.3807 - val_loss: 3.3212 - val_accuracy1000: 0.3263 - 245s/epoch - 32ms/step
Epoch 5/50
7696/7696 - 245s - loss: 3.2587 - accuracy1000: 0.3832 - val_loss: 3.3361 - val_accuracy1000: 0.3289 - 245s/epoch - 32ms/step
Epoch 6/50
7696/7696 - 250s - loss: 3.2554 - accuracy1000: 0.3859 - val_loss: 3.3444 - val_accuracy1000: 0.3260 - 250s/epoch - 32ms/step
Epoch 7/50
7696/7696 - 248s - loss: 3.2505 - accuracy1000: 0.3897 - val_loss: 3.3441 - val_accuracy1000: 0.3233 - 248s/epoch - 32ms/step
Epoch 8/50
7696/7696 - 244s - loss: 3.2473 - accuracy1000: 0.3915 - val_loss: 3.3406 - val_accuracy1000: 0.3257 - 244s/epoch - 32ms/step
Epoch 9/50
7696/7696 - 246s - loss: 3.2417 - accuracy1000: 0.3946 - val_loss: 3.3340 - val_accuracy1000: 0.3250 - 246s/epoch - 32ms/step
Epoch 10/50
7696/7696 - 247s - loss: 3.2403 - accuracy1000: 0.3953 - val_loss: 3.3544 - val_accuracy1000: 0.3172 - 247s/epoch - 32ms/step
Epoch 11/50
7696/7696 - 247s - loss: 3.2377 - accuracy1000: 0.3966 - val_loss: 3.3635 - val_accuracy1000: 0.3239 - 247s/epoch - 32ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 384s - 384s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013174
{'0': {'precision': 0.3634110619536232, 'recall': 0.4011020933067349, 'f1-score': 0.38132748057364935, 'support': 2087845}, '1': {'precision': 0.32697262784726344, 'recall': 0.6334582881212172, 'f1-score': 0.4313137314822146, 'support': 1840399}, '2': {'precision': 0.3481086302663066, 'recall': 0.01560074068097784, 'f1-score': 0.02986314295642479, 'support': 2032724}, 'accuracy': 0.3413819701766559, 'macro avg': {'precision': 0.3461641066890644, 'recall': 0.3500537073696433, 'f1-score': 0.28083478500409625, 'support': 5960968}, 'weighted avg': {'precision': 0.34694278400949075, 'recall': 0.3413819701766559, 'f1-score': 0.2769089787409332, 'support': 5960968}}
[[ 837439 1216133   34273]
 [ 649470 1165816   25113]
 [ 817476 1183536   31712]]
Evaluating performance on  train set...
7696/7696 - 128s - 128s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004412
{'0': {'precision': 0.33725245205222715, 'recall': 0.4595257588678387, 'f1-score': 0.38900709591539406, 'support': 646127}, '1': {'precision': 0.34348387854583895, 'recall': 0.5565443346691572, 'f1-score': 0.42479558717835625, 'support': 651533}, '2': {'precision': 0.34241943688100296, 'recall': 0.01703432467029859, 'f1-score': 0.032454153970061295, 'support': 671820}, 'accuracy': 0.3406802810894246, 'macro avg': {'precision': 0.341051922493023, 'recall': 0.34436813940243155, 'f1-score': 0.2820856123546039, 'support': 1969480}, 'weighted avg': {'precision': 0.34107643794968767, 'recall': 0.3406802810894246, 'f1-score': 0.2792207490727341, 'support': 1969480}}
[[296912 338077  11138]
 [278087 362607  10839]
 [305386 354990  11444]]
Evaluating performance on  val set...
2338/2338 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042675
{'0': {'precision': 0.34369393662568654, 'recall': 0.4547599283498624, 'f1-score': 0.391502219101828, 'support': 206001}, '1': {'precision': 0.3014756441089892, 'recall': 0.5143476521532291, 'f1-score': 0.38013940136125096, 'support': 184978}, '2': {'precision': 0.3655645664379289, 'recall': 0.017001852021992156, 'f1-score': 0.03249252607211012, 'support': 206801}, 'accuracy': 0.3217571681889658, 'macro avg': {'precision': 0.3369113823908682, 'recall': 0.3287031441750279, 'f1-score': 0.26804471551172965, 'support': 597780}, 'weighted avg': {'precision': 0.33819594874159525, 'recall': 0.3217571681889658, 'f1-score': 0.2637872824558125, 'support': 597780}}
[[ 93681 109015   3305]
 [ 87038  95143   2797]
 [ 91852 111433   3516]]
testing model out of sample: results/universal/W8/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 231s - 231s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017696
{'0': {'precision': 0.3726850524112021, 'recall': 0.3311927555392727, 'f1-score': 0.35071595683848844, 'support': 1255580}, '1': {'precision': 0.3240016001446974, 'recall': 0.719468245238233, 'f1-score': 0.44679559019731757, 'support': 1105472}, '2': {'precision': 0.3589030902565, 'recall': 0.013064746138096415, 'f1-score': 0.02521173770199446, 'support': 1255210}, 'accuracy': 0.3394637888515821, 'macro avg': {'precision': 0.3518632476041332, 'recall': 0.3545752489718674, 'f1-score': 0.2742410949126002, 'support': 3616262}, 'weighted avg': {'precision': 0.35301904091641517, 'recall': 0.3394637888515821, 'f1-score': 0.2671039822487416, 'support': 3616262}}
[[415839 823120  16621]
 [297448 795352  12672]
 [402505 836306  16399]]
Evaluating performance on  train set...
4550/4550 - 75s - 75s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996554
{'0': {'precision': 0.357461200735144, 'recall': 0.3570984144145982, 'f1-score': 0.3572797154804457, 'support': 392158}, '1': {'precision': 0.3479702694824982, 'recall': 0.6907769633177367, 'f1-score': 0.462807194065856, 'support': 380211}, '2': {'precision': 0.35767418090965875, 'recall': 0.016077818786978473, 'f1-score': 0.030772387412584, 'support': 391782}, 'accuracy': 0.3513109553657558, 'macro avg': {'precision': 0.354368550375767, 'recall': 0.3546510655064379, 'f1-score': 0.28361976565296193, 'support': 1164151}, 'weighted avg': {'precision': 0.3544331445261402, 'recall': 0.3513109553657558, 'f1-score': 0.2818625351965774, 'support': 1164151}}
[[140039 245628   6491]
 [112749 262641   4821]
 [138972 246511   6299]]
Evaluating performance on  val set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028701
{'0': {'precision': 0.37095467644051366, 'recall': 0.39247478011633463, 'f1-score': 0.381411416126764, 'support': 142348}, '1': {'precision': 0.308854362888827, 'recall': 0.6355523721243785, 'f1-score': 0.4156961522986447, 'support': 118670}, '2': {'precision': 0.3681592039800995, 'recall': 0.016383958861550547, 'f1-score': 0.031371798203027774, 'support': 140015}, 'accuracy': 0.3330972762839966, 'macro avg': {'precision': 0.34932274776981337, 'recall': 0.34813703703408794, 'f1-score': 0.2761597888761455, 'support': 401033}, 'weighted avg': {'precision': 0.3516025226633344, 'recall': 0.3330972762839966, 'f1-score': 0.2693452583241023, 'support': 401033}}
[[55868 84169  2311]
 [41623 75421  1626]
 [53115 84606  2294]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
645/645 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008539
{'0': {'precision': 0.36849083895853424, 'recall': 0.6057163614748279, 'f1-score': 0.45822065390500577, 'support': 60563}, '1': {'precision': 0.29340726469620787, 'recall': 0.39773233963946747, 'f1-score': 0.3376960519199567, 'support': 47097}, '2': {'precision': 0.3858731196860693, 'recall': 0.010303157306510198, 'f1-score': 0.020070416546187467, 'support': 57264}, 'accuracy': 0.3395867187310519, 'macro avg': {'precision': 0.34925707444693715, 'recall': 0.33791728614026856, 'f1-score': 0.27199570745705, 'support': 164924}, 'weighted avg': {'precision': 0.3530847599557741, 'recall': 0.3395867187310519, 'f1-score': 0.2716705922292932, 'support': 164924}}
[[36684 23326   553]
 [27979 18732   386]
 [34889 21785   590]]
Evaluating performance on  train set...
224/224 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009318
{'0': {'precision': 0.33011970468066804, 'recall': 0.49934945245581697, 'f1-score': 0.3974713040476396, 'support': 18446}, '1': {'precision': 0.3438581913862346, 'recall': 0.5181011997913406, 'f1-score': 0.4133682940025804, 'support': 19170}, '2': {'precision': 0.4048913043478261, 'recall': 0.007626164397584195, 'f1-score': 0.014970360695267759, 'support': 19538}, 'accuracy': 0.3375441788851174, 'macro avg': {'precision': 0.3596230668049096, 'recall': 0.3416922722149139, 'f1-score': 0.2752699862484959, 'support': 57154}, 'weighted avg': {'precision': 0.3602882721377602, 'recall': 0.3375441788851174, 'f1-score': 0.2720459946417813, 'support': 57154}}
[[9211 9134  101]
 [9120 9932  118]
 [9571 9818  149]]
Evaluating performance on  val set...
68/68 - 1s - 652ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008276
{'0': {'precision': 0.39546225614927905, 'recall': 0.5360735843633228, 'f1-score': 0.45515558267236117, 'support': 6958}, '1': {'precision': 0.2662430294384645, 'recall': 0.43895659610861665, 'f1-score': 0.33144979011947046, 'support': 4677}, '2': {'precision': 0.26595744680851063, 'recall': 0.004462691895751518, 'f1-score': 0.00877808988764045, 'support': 5602}, 'accuracy': 0.3369495851946394, 'macro avg': {'precision': 0.3092209107987514, 'recall': 0.32649762412256367, 'f1-score': 0.26512782089315734, 'support': 17237}, 'weighted avg': {'precision': 0.31831169252141667, 'recall': 0.3369495851946394, 'f1-score': 0.27651784371837407, 'support': 17237}}
[[3730 3183   45]
 [2600 2053   24]
 [3102 2475   25]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125652
{'0': {'precision': 0.3569772256728779, 'recall': 0.1617357372005328, 'f1-score': 0.2226124230178302, 'support': 213212}, '1': {'precision': 0.27456360953204273, 'recall': 0.8119496449322143, 'f1-score': 0.410361906502049, 'support': 154900}, '2': {'precision': 0.37789948453608246, 'recall': 0.006184490794440813, 'f1-score': 0.012169817193368331, 'support': 189668}, 'accuracy': 0.28941159596973715, 'macro avg': {'precision': 0.3364801065803344, 'recall': 0.32662329097572934, 'f1-score': 0.21504804890441584, 'support': 557780}, 'weighted avg': {'precision': 0.3412047237076782, 'recall': 0.28941159596973715, 'f1-score': 0.2031928791657585, 'support': 557780}}
[[ 34484 177477   1251]
 [ 28449 125771    680]
 [ 33667 154828   1173]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010556
{'0': {'precision': 0.36964474147027787, 'recall': 0.19882697947214076, 'f1-score': 0.25857169219413173, 'support': 52855}, '1': {'precision': 0.3434493026171446, 'recall': 0.8345264841399794, 'f1-score': 0.4866272163071354, 'support': 52522}, '2': {'precision': 0.29604628736740596, 'recall': 0.005936956101334365, 'f1-score': 0.01164047244393046, 'support': 51710}, 'accuracy': 0.3478772909279571, 'macro avg': {'precision': 0.3363801104849428, 'recall': 0.34643013990448485, 'f1-score': 0.2522797936483992, 'support': 157087}, 'weighted avg': {'precision': 0.3366591163001252, 'recall': 0.3478772909279571, 'f1-score': 0.2535370226427384, 'support': 157087}}
[[10509 41996   350]
 [ 8311 43831   380]
 [ 9610 41793   307]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045027
{'0': {'precision': 0.372947922394156, 'recall': 0.2781650946159705, 'f1-score': 0.31865771812080534, 'support': 17069}, '1': {'precision': 0.3170642511533701, 'recall': 0.7267861748774825, 'f1-score': 0.4415151989971795, 'support': 15508}, '2': {'precision': 0.3238434163701068, 'recall': 0.005693549396233498, 'f1-score': 0.01119035907525824, 'support': 15983}, 'accuracy': 0.3317545304777595, 'macro avg': {'precision': 0.3379518633058776, 'recall': 0.3368816062965622, 'f1-score': 0.25712109206441436, 'support': 48560}, 'weighted avg': {'precision': 0.3389388348038659, 'recall': 0.3317545304777595, 'f1-score': 0.2566936121448134, 'support': 48560}}
[[ 4748 12223    98]
 [ 4145 11271    92]
 [ 3838 12054    91]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
1162/1162 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0782799
{'0': {'precision': 0.3022758955088187, 'recall': 0.2738065826676549, 'f1-score': 0.28733777925014764, 'support': 72858}, '1': {'precision': 0.5163120815801111, 'recall': 0.8039598020098995, 'f1-score': 0.6288010280939469, 'support': 146674}, '2': {'precision': 0.3112410656270305, 'recall': 0.012292925793329997, 'f1-score': 0.023651693021763013, 'support': 77931}, 'accuracy': 0.46670342193819064, 'macro avg': {'precision': 0.3766096809053201, 'recall': 0.36335310349029476, 'f1-score': 0.31326350012195253, 'support': 297463}, 'weighted avg': {'precision': 0.4101622821461588, 'recall': 0.46670342193819064, 'f1-score': 0.3866256240411003, 'support': 297463}}
[[ 19949  52085    824]
 [ 27458 117920   1296]
 [ 18589  58384    958]]
Evaluating performance on  train set...
327/327 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969968
{'0': {'precision': 0.3845703726516785, 'recall': 0.4180868517092443, 'f1-score': 0.40062884001475846, 'support': 29867}, '1': {'precision': 0.3500485600459834, 'recall': 0.6519139197519471, 'f1-score': 0.4555091303002166, 'support': 27091}, '2': {'precision': 0.2943854324734446, 'recall': 0.007286658653846154, 'f1-score': 0.014221309973243413, 'support': 26624}, 'accuracy': 0.36302074609365653, 'macro avg': {'precision': 0.3430014550570355, 'recall': 0.3590958100383459, 'f1-score': 0.2901197600960728, 'support': 83582}, 'weighted avg': {'precision': 0.34465371269371886, 'recall': 0.36302074609365653, 'f1-score': 0.2953316212870186, 'support': 83582}}
[[12487 17111   269]
 [ 9234 17661   196]
 [10749 15681   194]]
Evaluating performance on  val set...
125/125 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0925709
{'0': {'precision': 0.32294617563739375, 'recall': 0.38795503764050737, 'f1-score': 0.3524782160592148, 'support': 9697}, '1': {'precision': 0.418379138823293, 'recall': 0.6552049728538831, 'f1-score': 0.5106709186802405, 'support': 12709}, '2': {'precision': 0.425, 'recall': 0.010867249094395908, 'f1-score': 0.021192603365884063, 'support': 9386}, 'accuracy': 0.38346124811273274, 'macro avg': {'precision': 0.38877510482022887, 'recall': 0.35134241986292886, 'f1-score': 0.2947805793684464, 'support': 31792}, 'weighted avg': {'precision': 0.3912254510713713, 'recall': 0.38346124811273274, 'f1-score': 0.3179105354122286, 'support': 31792}}
[[3762 5860   75]
 [4319 8327   63]
 [3568 5716  102]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1223/1223 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006691
{'0': {'precision': 0.3127277216092128, 'recall': 0.7994767542475543, 'f1-score': 0.4495909686800511, 'support': 98233}, '1': {'precision': 0.36221648784462857, 'recall': 0.19166367229608336, 'f1-score': 0.25068145502396844, 'support': 111320}, '2': {'precision': 0.3253333333333333, 'recall': 0.00943177425589486, 'f1-score': 0.0183320811419985, 'support': 103480}, 'accuracy': 0.32216092233087246, 'macro avg': {'precision': 0.33342584759572486, 'recall': 0.33352406693317754, 'f1-score': 0.23953483494867267, 'support': 313033}, 'weighted avg': {'precision': 0.3344938553987445, 'recall': 0.32216092233087246, 'f1-score': 0.23629308397577775, 'support': 313033}}
[[78535 18754   944]
 [88904 21336  1080]
 [83690 18814   976]]
Evaluating performance on  train set...
358/358 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003494
{'0': {'precision': 0.32767358312729655, 'recall': 0.8037257924009917, 'f1-score': 0.4655468545311635, 'support': 29846}, '1': {'precision': 0.34144793769829823, 'recall': 0.1960063580369561, 'f1-score': 0.24904802978983018, 'support': 30198}, '2': {'precision': 0.33181299885974913, 'recall': 0.009274900398406375, 'f1-score': 0.01804539253379635, 'support': 31375}, 'accuracy': 0.33032520591999476, 'macro avg': {'precision': 0.3336448398951146, 'recall': 0.3363356836121181, 'f1-score': 0.24421342561826334, 'support': 91419}, 'weighted avg': {'precision': 0.33364424708053175, 'recall': 0.33032520591999476, 'f1-score': 0.24044933782559705, 'support': 91419}}
[[23988  5566   292]
 [23985  5919   294]
 [25234  5850   291]]
Evaluating performance on  val set...
99/99 - 1s - 952ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994475
{'0': {'precision': 0.32052613361024573, 'recall': 0.7977846153846154, 'f1-score': 0.45731621278397067, 'support': 8125}, '1': {'precision': 0.3684210526315789, 'recall': 0.18888651877133106, 'f1-score': 0.2497355989564972, 'support': 9376}, '2': {'precision': 0.32456140350877194, 'recall': 0.009539770529844012, 'f1-score': 0.018534752661239825, 'support': 7757}, 'accuracy': 0.3296777258690316, 'macro avg': {'precision': 0.3378361965835322, 'recall': 0.3320703015619301, 'f1-score': 0.24186218813390256, 'support': 25258}, 'weighted avg': {'precision': 0.3395444386758442, 'recall': 0.3296777258690316, 'f1-score': 0.2455059498408075, 'support': 25258}}
[[6482 1573   70]
 [7521 1771   84]
 [6220 1463   74]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019251
{'0': {'precision': 0.3558685299236148, 'recall': 0.5475045292033411, 'f1-score': 0.4313602890093094, 'support': 124746}, '1': {'precision': 0.3220605291875925, 'recall': 0.5118128824886048, 'f1-score': 0.39534712456646687, 'support': 110134}, '2': {'precision': 0.3902765388046387, 'recall': 0.006514924761926035, 'f1-score': 0.012815912236633004, 'support': 134307}, 'accuracy': 0.3400498934144485, 'macro avg': {'precision': 0.3560685326386153, 'recall': 0.355277445484624, 'f1-score': 0.2798411086041364, 'support': 369187}, 'weighted avg': {'precision': 0.35830043054774996, 'recall': 0.3400498934144485, 'f1-score': 0.26835424203594394, 'support': 369187}}
[[68299 55612   835]
 [53234 56368   532]
 [70389 63043   875]]
Evaluating performance on  train set...
494/494 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995114
{'0': {'precision': 0.34097266369993645, 'recall': 0.5308687798480687, 'f1-score': 0.41524004916144897, 'support': 40413}, '1': {'precision': 0.3602326659102894, 'recall': 0.5456239713428211, 'f1-score': 0.4339573607969585, 'support': 41316}, '2': {'precision': 0.35435056746532156, 'recall': 0.006305679599667886, 'f1-score': 0.012390863391833496, 'support': 44563}, 'accuracy': 0.3506001963703164, 'macro avg': {'precision': 0.3518519656918491, 'recall': 0.36093281026351925, 'f1-score': 0.287196091116747, 'support': 126292}, 'weighted avg': {'precision': 0.35199399345019616, 'recall': 0.3506001963703164, 'f1-score': 0.27921525093259314, 'support': 126292}}
[[21454 18699   260]
 [18521 22543   252]
 [22945 21337   281]]
Evaluating performance on  val set...
150/150 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009746
{'0': {'precision': 0.35232424755557984, 'recall': 0.5117017056723523, 'f1-score': 0.4173136645962733, 'support': 12605}, '1': {'precision': 0.3426905967172879, 'recall': 0.5727715579864969, 'f1-score': 0.428818222535031, 'support': 11701}, '2': {'precision': 0.36619718309859156, 'recall': 0.007513365120647306, 'f1-score': 0.014724621265751097, 'support': 13842}, 'accuracy': 0.3474887281115655, 'macro avg': {'precision': 0.3537373424571531, 'recall': 0.3639955429264989, 'f1-score': 0.28695216946568514, 'support': 38148}, 'weighted avg': {'precision': 0.3544031461958104, 'recall': 0.3474887281115655, 'f1-score': 0.2747630012498414, 'support': 38148}}
[[6450 6061   94]
 [4913 6702   86]
 [6944 6794  104]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978335
{'0': {'precision': 0.3454849938065284, 'recall': 0.11096367814865687, 'f1-score': 0.1679763268615764, 'support': 449922}, '1': {'precision': 0.3688377581775544, 'recall': 0.9023927248754193, 'f1-score': 0.5236446326231065, 'support': 515730}, '2': {'precision': 0.3563905493879875, 'recall': 0.0055935557948255145, 'f1-score': 0.011014242858776646, 'support': 447658}, 'accuracy': 0.3663881243322413, 'macro avg': {'precision': 0.3569044337906901, 'recall': 0.3396499862729672, 'f1-score': 0.23421173411448648, 'support': 1413310}, 'weighted avg': {'precision': 0.35746090876471454, 'recall': 0.3663881243322413, 'f1-score': 0.24804615070055624, 'support': 1413310}}
[[ 49925 397783   2214]
 [ 48031 465391   2308]
 [ 46551 398603   2504]]
Evaluating performance on  train set...
1289/1289 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028005
{'0': {'precision': 0.3628039378484166, 'recall': 0.14148011100832564, 'f1-score': 0.20357392432864133, 'support': 108100}, '1': {'precision': 0.33578373914899423, 'recall': 0.8784256292906178, 'f1-score': 0.4858487342204717, 'support': 109250}, '2': {'precision': 0.3752821670428894, 'recall': 0.0059174230290087206, 'f1-score': 0.011651131824234353, 'support': 112380}, 'accuracy': 0.3394504594668365, 'macro avg': {'precision': 0.3579566146801001, 'recall': 0.3419410544426507, 'f1-score': 0.23369126345778246, 'support': 329730}, 'weighted avg': {'precision': 0.3581041734622915, 'recall': 0.3394504594668365, 'f1-score': 0.23168856224159196, 'support': 329730}}
[[15294 92191   615]
 [12790 95968   492]
 [14071 97644   665]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11731
{'0': {'precision': 0.41847229840921557, 'recall': 0.13996743343347934, 'f1-score': 0.209771942186399, 'support': 43603}, '1': {'precision': 0.2383101792077674, 'recall': 0.8737739064571104, 'f1-score': 0.3744846615809122, 'support': 26405}, '2': {'precision': 0.42413162705667273, 'recall': 0.005531975773761267, 'f1-score': 0.010921501706484642, 'support': 41938}, 'accuracy': 0.26268915369910495, 'macro avg': {'precision': 0.36030470155788524, 'recall': 0.339757771888117, 'f1-score': 0.1983927018245986, 'support': 111946}, 'weighted avg': {'precision': 0.3780971190129247, 'recall': 0.26268915369910495, 'f1-score': 0.1741284139028111, 'support': 111946}}
[[ 6103 37307   193]
 [ 3211 23072   122]
 [ 5270 36436   232]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
5918/5918 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1110095
{'0': {'precision': 0.3839108596597497, 'recall': 0.31293159907563567, 'f1-score': 0.34480631227279396, 'support': 589378}, '1': {'precision': 0.24463580904368573, 'recall': 0.6761482296945069, 'f1-score': 0.35928092200955875, 'support': 370614}, '2': {'precision': 0.3591343341782024, 'recall': 0.006637646482263574, 'f1-score': 0.01303438686371565, 'support': 555016}, 'accuracy': 0.2895753685789118, 'macro avg': {'precision': 0.32922700096054597, 'recall': 0.3319058250841354, 'f1-score': 0.2390405403820228, 'support': 1515008}, 'weighted avg': {'precision': 0.34076346263234897, 'recall': 0.2895753685789118, 'f1-score': 0.2268041407067932, 'support': 1515008}}
[[184435 400749   4194]
 [117644 250590   2380]
 [178332 373000   3684]]
Evaluating performance on  train set...
1814/1814 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002291
{'0': {'precision': 0.35555036448206445, 'recall': 0.33572503632966577, 'f1-score': 0.34535341165792993, 'support': 154144}, '1': {'precision': 0.3490562446467659, 'recall': 0.7155175216704275, 'f1-score': 0.4692128756041969, 'support': 153781}, '2': {'precision': 0.3608571428571429, 'recall': 0.008077823400744465, 'f1-score': 0.015801919251316826, 'support': 156354}, 'accuracy': 0.3511810786186754, 'macro avg': {'precision': 0.35515458399532446, 'recall': 0.3531067938002792, 'f1-score': 0.2767894021711479, 'support': 464279}, 'weighted avg': {'precision': 0.3551864966001766, 'recall': 0.3511810786186754, 'f1-score': 0.27539663605829545, 'support': 464279}}
[[ 51750 101123   1271]
 [ 42782 110033    966]
 [ 51017 104074   1263]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091502
{'0': {'precision': 0.36874778917580475, 'recall': 0.345330771524166, 'f1-score': 0.35665531929452415, 'support': 60374}, '1': {'precision': 0.2620498987242131, 'recall': 0.6159990973710933, 'f1-score': 0.367684495507994, 'support': 44315}, '2': {'precision': 0.3545499751367479, 'recall': 0.012286113073596058, 'f1-score': 0.02374925054959696, 'support': 58033}, 'accuracy': 0.3002667125526972, 'macro avg': {'precision': 0.32844922101225527, 'recall': 0.3245386606562851, 'f1-score': 0.24936302178403838, 'support': 162722}, 'weighted avg': {'precision': 0.33462665769087424, 'recall': 0.3002667125526972, 'f1-score': 0.24093169284220398, 'support': 162722}}
[[20849 38689   836]
 [16555 27298   462]
 [19136 38184   713]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
3755/3755 - 37s - 37s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957197
{'0': {'precision': 0.3613601611795551, 'recall': 0.2954530648458658, 'f1-score': 0.32509993070560805, 'support': 322349}, '1': {'precision': 0.3704797682470477, 'recall': 0.7386453766571083, 'f1-score': 0.49345769360287334, 'support': 344199}, '2': {'precision': 0.336062687092798, 'recall': 0.012955891587325833, 'f1-score': 0.02494991388129018, 'support': 294615}, 'accuracy': 0.3675724096745297, 'macro avg': {'precision': 0.35596753883980026, 'recall': 0.3490181110301, 'f1-score': 0.28116917939659053, 'support': 961163}, 'weighted avg': {'precision': 0.3568717906377781, 'recall': 0.3675724096745297, 'f1-score': 0.2933882193983474, 'support': 961163}}
[[ 95239 223443   3667]
 [ 86084 254241   3874]
 [ 82234 208564   3817]]
Evaluating performance on  train set...
1532/1532 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975688
{'0': {'precision': 0.36263557923778095, 'recall': 0.4108701148456594, 'f1-score': 0.3852489341144439, 'support': 130523}, '1': {'precision': 0.35816306123129227, 'recall': 0.6680551777734602, 'f1-score': 0.4663193041176295, 'support': 128675}, '2': {'precision': 0.3546281184425274, 'recall': 0.011437552168322266, 'f1-score': 0.022160382306661227, 'support': 132983}, 'accuracy': 0.359810903638881, 'macro avg': {'precision': 0.35847558630386683, 'recall': 0.36345428159581394, 'f1-score': 0.2912428735129115, 'support': 392181}, 'weighted avg': {'precision': 0.358452925275911, 'recall': 0.359810903638881, 'f1-score': 0.288730043538678, 'support': 392181}}
[[53628 75333  1562]
 [41507 85962  1206]
 [52749 78713  1521]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000354
{'0': {'precision': 0.33713965613823416, 'recall': 0.4103424765301306, 'f1-score': 0.37015659743577617, 'support': 38134}, '1': {'precision': 0.35530121997233055, 'recall': 0.6280414000938666, 'f1-score': 0.45384766426875633, 'support': 40483}, '2': {'precision': 0.3680851063829787, 'recall': 0.012731197566599618, 'f1-score': 0.02461115326251897, 'support': 40766}, 'accuracy': 0.34839131199584533, 'macro avg': {'precision': 0.3535086608311811, 'recall': 0.3503716913968656, 'f1-score': 0.28287180498901715, 'support': 119383}, 'weighted avg': {'precision': 0.3538652939038539, 'recall': 0.34839131199584533, 'f1-score': 0.2805421622266805, 'support': 119383}}
[[15648 21975   511]
 [14678 25425   380]
 [16088 24159   519]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
4960/4960 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962969
{'0': {'precision': 0.383402180683128, 'recall': 0.2624970897104415, 'f1-score': 0.31163359746987546, 'support': 408035}, '1': {'precision': 0.3656996418490776, 'recall': 0.8162398219759464, 'f1-score': 0.5050996598312223, 'support': 430953}, '2': {'precision': 0.370731192628284, 'recall': 0.02447456651156743, 'f1-score': 0.04591777838279336, 'support': 430692}, 'accuracy': 0.3697073278306345, 'macro avg': {'precision': 0.3732776717201632, 'recall': 0.36773715939931845, 'f1-score': 0.2875503452279637, 'support': 1269680}, 'weighted avg': {'precision': 0.37309544559596636, 'recall': 0.3697073278306345, 'f1-score': 0.28716530815174485, 'support': 1269680}}
[[107108 290845  10082]
 [ 71382 351761   7810]
 [100872 319279  10541]]
Evaluating performance on  train set...
1691/1691 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994942
{'0': {'precision': 0.3697920490793542, 'recall': 0.3036278870371363, 'f1-score': 0.33345962150331965, 'support': 149288}, '1': {'precision': 0.3433025109712399, 'recall': 0.7369088172383744, 'f1-score': 0.46839473112003754, 'support': 138853}, '2': {'precision': 0.34375767498976667, 'recall': 0.0290180576767586, 'f1-score': 0.053518398144253694, 'support': 144703}, 'accuracy': 0.3508169224940163, 'macro avg': {'precision': 0.35228407834678693, 'recall': 0.3565182539840898, 'f1-score': 0.28512425025587035, 'support': 432844}, 'weighted avg': {'precision': 0.3525909238037085, 'recall': 0.3508169224940163, 'f1-score': 0.28315930529674915, 'support': 432844}}
[[ 45328  99301   4659]
 [ 33174 102322   3357]
 [ 44075  96429   4199]]
Evaluating performance on  val set...
591/591 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986956
{'0': {'precision': 0.38855979939673657, 'recall': 0.40566073528853813, 'f1-score': 0.3969261610424324, 'support': 52714}, '1': {'precision': 0.3350971350820168, 'recall': 0.6854952725987452, 'f1-score': 0.45014542579657796, 'support': 45268}, '2': {'precision': 0.35087217615098654, 'recall': 0.023084738109572546, 'f1-score': 0.0433193878091405, 'support': 53152}, 'accuracy': 0.3549300620641285, 'macro avg': {'precision': 0.3581763702099133, 'recall': 0.3714135819989519, 'f1-score': 0.2967969915493836, 'support': 151134}, 'weighted avg': {'precision': 0.3592922590751885, 'recall': 0.3549300620641285, 'f1-score': 0.288507290808036, 'support': 151134}}
[[21384 30001  1329]
 [13296 31031   941]
 [20354 31571  1227]]
testing model on single stock: results/universal/W8/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
10609/10609 - 78s - 78s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1029483
{'0': {'precision': 0.37386423284994025, 'recall': 0.5766759051874809, 'f1-score': 0.4536336473725524, 'support': 1004129}, '1': {'precision': 0.2717216918318058, 'recall': 0.4185229261463073, 'f1-score': 0.32951146477893584, 'support': 714250}, '2': {'precision': 0.3516625191137229, 'recall': 0.023521437316442444, 'f1-score': 0.04409361199012413, 'support': 997303}, 'accuracy': 0.33194055857791893, 'macro avg': {'precision': 0.332416147931823, 'recall': 0.33957342288341025, 'f1-score': 0.2757462413805375, 'support': 2715682}, 'weighted avg': {'precision': 0.33884645623379994, 'recall': 0.33194055857791893, 'f1-score': 0.2705894710571766, 'support': 2715682}}
[[579057 398972  26100]
 [398172 298930  17148]
 [571614 402231  23458]]
Evaluating performance on  train set...
3903/3903 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007259
{'0': {'precision': 0.3285104271627888, 'recall': 0.5952284923476692, 'f1-score': 0.42336370623903713, 'support': 324803}, '1': {'precision': 0.33980027938037793, 'recall': 0.395511472159764, 'f1-score': 0.36554538522344165, 'support': 330888}, '2': {'precision': 0.3481545604784764, 'recall': 0.025767971762403457, 'f1-score': 0.047984467957026565, 'support': 343372}, 'accuracy': 0.33336236053181834, 'macro avg': {'precision': 0.33882175567388106, 'recall': 0.3388359787566122, 'f1-score': 0.2789645198065018, 'support': 999063}, 'weighted avg': {'precision': 0.3390011789626732, 'recall': 0.33336236053181834, 'f1-score': 0.2751987672796533, 'support': 999063}}
[[193332 123156   8315]
 [191767 130870   8251]
 [203412 131112   8848]]
Evaluating performance on  val set...
1144/1144 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012692
{'0': {'precision': 0.34072698683528213, 'recall': 0.616806298576764, 'f1-score': 0.43896657124487726, 'support': 99070}, '1': {'precision': 0.3144921536898356, 'recall': 0.35864643907044613, 'f1-score': 0.33512115409678295, 'support': 93206}, '2': {'precision': 0.36510431551871964, 'recall': 0.02545911097382345, 'f1-score': 0.047599087140794555, 'support': 100357}, 'accuracy': 0.331780762935144, 'macro avg': {'precision': 0.34010781868127915, 'recall': 0.33363728287367783, 'f1-score': 0.27389560416081826, 'support': 292633}, 'weighted avg': {'precision': 0.34073105922810604, 'recall': 0.331780762935144, 'f1-score': 0.27167346844055, 'support': 292633}}
[[61107 35585  2378]
 [57713 33428  2065]
 [60523 37279  2555]]
training model: results/universal/W8/deepVOL_L3/h300
Epoch 1/50
7696/7696 - 424s - loss: 3.2766 - accuracy300: 0.3712 - val_loss: 3.4355 - val_accuracy300: 0.3287 - 424s/epoch - 55ms/step
Epoch 2/50
7696/7696 - 430s - loss: 3.2809 - accuracy300: 0.3582 - val_loss: 3.3061 - val_accuracy300: 0.3288 - 430s/epoch - 56ms/step
Epoch 3/50
7696/7696 - 424s - loss: 3.2780 - accuracy300: 0.3619 - val_loss: 3.3035 - val_accuracy300: 0.3288 - 424s/epoch - 55ms/step
Epoch 4/50
7696/7696 - 418s - loss: 3.2776 - accuracy300: 0.3633 - val_loss: 3.3056 - val_accuracy300: 0.3289 - 418s/epoch - 54ms/step
Epoch 5/50
7696/7696 - 425s - loss: 3.2714 - accuracy300: 0.3697 - val_loss: 3.3160 - val_accuracy300: 0.3407 - 425s/epoch - 55ms/step
Epoch 6/50
7696/7696 - 432s - loss: 3.2531 - accuracy300: 0.3832 - val_loss: 3.6236 - val_accuracy300: 0.3288 - 432s/epoch - 56ms/step
Epoch 7/50
7696/7696 - 442s - loss: 3.2400 - accuracy300: 0.3910 - val_loss: 3.7373 - val_accuracy300: 0.3287 - 442s/epoch - 57ms/step
Epoch 8/50
7696/7696 - 449s - loss: 3.2359 - accuracy300: 0.3944 - val_loss: 3.6646 - val_accuracy300: 0.3287 - 449s/epoch - 58ms/step
Epoch 9/50
7696/7696 - 431s - loss: 3.2307 - accuracy300: 0.3975 - val_loss: 3.6429 - val_accuracy300: 0.3287 - 431s/epoch - 56ms/step
Epoch 10/50
7696/7696 - 431s - loss: 3.2281 - accuracy300: 0.3992 - val_loss: 3.6543 - val_accuracy300: 0.3288 - 431s/epoch - 56ms/step
Epoch 11/50
7696/7696 - 424s - loss: 3.2239 - accuracy300: 0.4024 - val_loss: 3.7041 - val_accuracy300: 0.3288 - 424s/epoch - 55ms/step
Epoch 12/50
7696/7696 - 432s - loss: 3.2204 - accuracy300: 0.4055 - val_loss: 3.6475 - val_accuracy300: 0.3287 - 432s/epoch - 56ms/step
Epoch 13/50
7696/7696 - 426s - loss: 3.2158 - accuracy300: 0.4082 - val_loss: 3.6533 - val_accuracy300: 0.3286 - 426s/epoch - 55ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 725s - 725s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046437
{'0': {'precision': 0.4057971014492754, 'recall': 9.402238308364634e-05, 'f1-score': 0.000188001206660806, 'support': 2084610}, '1': {'precision': 0.3082350256626225, 'recall': 0.9998840692036098, 'f1-score': 0.4712098354655368, 'support': 1837303}, '2': {'precision': 0.3516483516483517, 'recall': 7.846772156709849e-05, 'f1-score': 0.00015690043196650176, 'support': 2039055}, 'accuracy': 0.3082462445696739, 'macro avg': {'precision': 0.35522682625341656, 'recall': 0.3333521864360869, 'f1-score': 0.15718491236805468, 'support': 5960968}, 'weighted avg': {'precision': 0.35720375661763604, 'recall': 0.3082462445696739, 'f1-score': 0.14535677462721788, 'support': 5960968}}
[[    196 2084227     187]
 [    105 1837090     108]
 [    182 2038713     160]]
Evaluating performance on  train set...
7696/7696 - 250s - 250s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1012794
{'0': {'precision': 0.3741935483870968, 'recall': 8.848369459090022e-05, 'f1-score': 0.00017692555247291592, 'support': 655488}, '1': {'precision': 0.33113038479488155, 'recall': 0.9998880587860052, 'f1-score': 0.4975037261946044, 'support': 652128}, '2': {'precision': 0.3904109589041096, 'recall': 8.612041144404288e-05, 'f1-score': 0.00017220283681515383, 'support': 661864}, 'accuracy': 0.3311381684505555, 'macro avg': {'precision': 0.36524496402869594, 'recall': 0.3333542209640134, 'f1-score': 0.16595095152796416, 'support': 1969480}, 'weighted avg': {'precision': 0.3653846371249199, 'recall': 0.3311381684505555, 'f1-score': 0.1648486186154519, 'support': 1969480}}
[[    58 655375     55]
 [    39 652055     34]
 [    58 661749     57]]
Evaluating performance on  val set...
2338/2338 - 82s - 82s/epoch - 35ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015757
{'0': {'precision': 0.3333333333333333, 'recall': 6.444225230628907e-05, 'f1-score': 0.00012885959260544182, 'support': 201731}, '1': {'precision': 0.3287469320354888, 'recall': 0.9998829623749479, 'f1-score': 0.4948081593801269, 'support': 196518}, '2': {'precision': 0.3125, 'recall': 5.01175255975262e-05, 'f1-score': 0.00010021897846795248, 'support': 199531}, 'accuracy': 0.32874636153768944, 'macro avg': {'precision': 0.32486008845627407, 'recall': 0.33333250738428394, 'f1-score': 0.1650124126504001, 'support': 597780}, 'weighted avg': {'precision': 0.3248716814821788, 'recall': 0.32874636153768944, 'f1-score': 0.16274331967033417, 'support': 597780}}
[[    13 201709      9]
 [    10 196495     13]
 [    16 199505     10]]
testing model out of sample: results/universal/W8/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 449s - 449s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033843
{'0': {'precision': 0.3471698113207547, 'recall': 0.0001529213377625115, 'f1-score': 0.00030570801727582587, 'support': 1203233}, '1': {'precision': 0.33237542408161175, 'recall': 0.9997088045845807, 'f1-score': 0.49888532681545167, 'support': 1201942}, '2': {'precision': 0.37566137566137564, 'recall': 0.0001758750609989208, 'f1-score': 0.0003515855186381591, 'support': 1211087}, 'accuracy': 0.3323843792291598, 'macro avg': {'precision': 0.3517355370212474, 'recall': 0.33334586699444735, 'f1-score': 0.16651420678378856, 'support': 3616262}, 'weighted avg': {'precision': 0.3517944120260132, 'recall': 0.3323843792291598, 'f1-score': 0.16603466953140544, 'support': 3616262}}
[[    184 1202869     180]
 [    176 1201592     174]
 [    170 1210704     213]]
Evaluating performance on  train set...
4550/4550 - 145s - 145s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028115
{'0': {'precision': 0.3310810810810811, 'recall': 0.0001240880163897478, 'f1-score': 0.0002480830521303499, 'support': 394881}, '1': {'precision': 0.3248042067095987, 'recall': 0.9997725535623138, 'f1-score': 0.49031561007181734, 'support': 378111}, '2': {'precision': 0.38513513513513514, 'recall': 0.0001457207938459808, 'f1-score': 0.000291331358754124, 'support': 391159}, 'accuracy': 0.32481267464444047, 'macro avg': {'precision': 0.3470068076419383, 'recall': 0.33334745412418315, 'f1-score': 0.16361834149423396, 'support': 1164151}, 'weighted avg': {'precision': 0.34720474071308255, 'recall': 0.32481267464444047, 'f1-score': 0.15943433953716668, 'support': 1164151}}
[[    49 394780     52]
 [    47 378025     39]
 [    52 391050     57]]
Evaluating performance on  val set...
1570/1570 - 49s - 49s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102
{'0': {'precision': 0.28205128205128205, 'recall': 8.109881522003583e-05, 'f1-score': 0.00016215100681034227, 'support': 135637}, '1': {'precision': 0.32496938345384574, 'recall': 0.9997467810500146, 'f1-score': 0.49050068800129504, 'support': 130322}, '2': {'precision': 0.29850746268656714, 'recall': 0.00014806698550424212, 'f1-score': 0.00029598715415750956, 'support': 135074}, 'accuracy': 0.3249607887630195, 'macro avg': {'precision': 0.3018427093972316, 'recall': 0.333325315616913, 'f1-score': 0.16365294205408762, 'support': 401033}, 'weighted avg': {'precision': 0.3015408875304207, 'recall': 0.3249607887630195, 'f1-score': 0.15955047217230547, 'support': 401033}}
[[    11 135598     28]
 [    14 130289     19]
 [    14 135040     20]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050236
{'0': {'precision': 0.23076923076923078, 'recall': 0.00010600332143740504, 'f1-score': 0.0002119093028183937, 'support': 56602}, '1': {'precision': 0.30750242600679284, 'recall': 0.999704235349791, 'f1-score': 0.4703334013618064, 'support': 50716}, '2': {'precision': 0.4444444444444444, 'recall': 0.00013887442280318023, 'f1-score': 0.00027766208524226016, 'support': 57606}, 'accuracy': 0.307505275157042, 'macro avg': {'precision': 0.32757203374015603, 'recall': 0.33331637103134387, 'f1-score': 0.15694099091662236, 'support': 164924}, 'weighted avg': {'precision': 0.3289997799230383, 'recall': 0.307505275157042, 'f1-score': 0.14480256527798238, 'support': 164924}}
[[    6 56591     5]
 [   10 50701     5]
 [   10 57588     8]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021264
{'0': {'precision': 0.3448275862068966, 'recall': 0.0005246039240373518, 'f1-score': 0.0010476140589806716, 'support': 19062}, '1': {'precision': 0.32934666503230775, 'recall': 0.9993623804463337, 'f1-score': 0.4954232354761811, 'support': 18820}, '2': {'precision': 0.5, 'recall': 0.00046699875466998757, 'f1-score': 0.000933125972006221, 'support': 19272}, 'accuracy': 0.3294082653882493, 'macro avg': {'precision': 0.3913914170797348, 'recall': 0.333451327708347, 'f1-score': 0.16580132516905602, 'support': 57154}, 'weighted avg': {'precision': 0.3920531841023182, 'recall': 0.3294082653882493, 'f1-score': 0.16379987602943838, 'support': 57154}}
[[   10 19046     6]
 [    9 18808     3]
 [   10 19253     9]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046817
{'0': {'precision': 0.42857142857142855, 'recall': 0.0004866969500324465, 'f1-score': 0.0009722897423432184, 'support': 6164}, '1': {'precision': 0.3085273117780229, 'recall': 0.999623848034606, 'f1-score': 0.4715223562810504, 'support': 5317}, '2': {'precision': 0.3333333333333333, 'recall': 0.00017373175816539263, 'f1-score': 0.00034728251432540375, 'support': 5756}, 'accuracy': 0.3085803794163718, 'macro avg': {'precision': 0.35681069122759496, 'recall': 0.3334280922476012, 'f1-score': 0.15761397617923967, 'support': 17237}, 'weighted avg': {'precision': 0.3597389725070894, 'recall': 0.3085803794163718, 'f1-score': 0.145911499708221, 'support': 17237}}
[[   3 6160    1]
 [   1 5315    1]
 [   3 5752    1]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
2179/2179 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011674
{'0': {'precision': 0.6, 'recall': 1.5729370930025273e-05, 'f1-score': 3.145791717130409e-05, 'support': 190726}, '1': {'precision': 0.3445589073710858, 'recall': 1.0, 'f1-score': 0.5125233345778442, 'support': 192186}, '2': {'precision': 1.0, 'recall': 5.71859917194684e-06, 'f1-score': 1.1437132939514722e-05, 'support': 174868}, 'accuracy': 0.3445623722614651, 'macro avg': {'precision': 0.6481863024570286, 'recall': 0.33334048265670063, 'f1-score': 0.170855409875985, 'support': 557780}, 'weighted avg': {'precision': 0.6373892899925051, 'recall': 0.3445623722614651, 'f1-score': 0.17660692281984086, 'support': 557780}}
[[     3 190723      0]
 [     0 192186      0]
 [     2 174865      1]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030896
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 53304}, '1': {'precision': 0.33482515167527166, 'recall': 1.0, 'f1-score': 0.5016764199491589, 'support': 52594}, '2': {'precision': 0.4, 'recall': 3.9070894137412335e-05, 'f1-score': 7.813415634644684e-05, 'support': 51189}, 'accuracy': 0.3348208317683831, 'macro avg': {'precision': 0.2449417172250906, 'recall': 0.33334635696471243, 'f1-score': 0.16725151803516847, 'support': 157087}, 'weighted avg': {'precision': 0.2424477775195226, 'recall': 0.3348208317683831, 'f1-score': 0.16799079007260487, 'support': 157087}}
[[    0 53301     3]
 [    0 52594     0]
 [    3 51184     2]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979172
{'0': {'precision': 0.3333333333333333, 'recall': 6.152331733727083e-05, 'f1-score': 0.00012302392815402596, 'support': 16254}, '1': {'precision': 0.351216096546327, 'recall': 0.9999413661682791, 'f1-score': 0.5198439309882339, 'support': 17055}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15251}, 'accuracy': 0.3512149917627677, 'macro avg': {'precision': 0.22818314329322012, 'recall': 0.33333429649520546, 'f1-score': 0.17332231830546263, 'support': 48560}, 'weighted avg': {'precision': 0.23492566982285026, 'recall': 0.3512149917627677, 'f1-score': 0.18261816050108207, 'support': 48560}}
[[    1 16253     0]
 [    1 17054     0]
 [    1 15250     0]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
1162/1162 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0843484
{'0': {'precision': 0.3465909090909091, 'recall': 0.0007733853994979335, 'f1-score': 0.001543327008222644, 'support': 78874}, '1': {'precision': 0.4574643923556758, 'recall': 0.9988753803860458, 'f1-score': 0.6275320189423763, 'support': 136046}, '2': {'precision': 0.3217391304347826, 'recall': 0.0008965024290369868, 'f1-score': 0.0017880226643953946, 'support': 82543}, 'accuracy': 0.4572938483105462, 'macro avg': {'precision': 0.3752648106271225, 'recall': 0.33351508940486024, 'f1-score': 0.21028778953833147, 'support': 297463}, 'weighted avg': {'precision': 0.39040326067287323, 'recall': 0.4572938483105462, 'f1-score': 0.28790988518998417, 'support': 297463}}
[[    61  78743     70]
 [    67 135893     86]
 [    48  82421     74]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999452
{'0': {'precision': 0.4, 'recall': 0.0005651114329106771, 'f1-score': 0.0011286283638415689, 'support': 28313}, '1': {'precision': 0.33859842406533663, 'recall': 0.9991166077738516, 'f1-score': 0.5057868092946711, 'support': 28300}, '2': {'precision': 0.3888888888888889, 'recall': 0.0005191145389150506, 'f1-score': 0.0010368450286983891, 'support': 26969}, 'accuracy': 0.33864946998157497, 'macro avg': {'precision': 0.3758291043180752, 'recall': 0.3334002779152258, 'f1-score': 0.16931742756240367, 'support': 83582}, 'weighted avg': {'precision': 0.3756248934638256, 'recall': 0.33864946998157497, 'f1-score': 0.17197104916708866, 'support': 83582}}
[[   16 28287    10]
 [   13 28275    12]
 [   11 26944    14]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941911
{'0': {'precision': 0.13333333333333333, 'recall': 0.0002022653721682848, 'f1-score': 0.0004039180046450571, 'support': 9888}, '1': {'precision': 0.37709303789500187, 'recall': 0.9993327216615231, 'f1-score': 0.5475651836109778, 'support': 11989}, '2': {'precision': 0.2, 'recall': 0.00010085728693898134, 'f1-score': 0.00020161290322580645, 'support': 9915}, 'accuracy': 0.37695017614494214, 'macro avg': {'precision': 0.23680879040944505, 'recall': 0.33321194810687677, 'f1-score': 0.1827235715062829, 'support': 31792}, 'weighted avg': {'precision': 0.24604832760830325, 'recall': 0.37695017614494214, 'f1-score': 0.2066794136725411, 'support': 31792}}
[[    2  9883     3]
 [    7 11981     1]
 [    6  9908     1]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991523
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 101035}, '1': {'precision': 0.358225167001575, 'recall': 0.9999464944978509, 'f1-score': 0.5274826594285902, 'support': 112138}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 99860}, 'accuracy': 0.35821143457718513, 'macro avg': {'precision': 0.11940838900052499, 'recall': 0.3333154981659503, 'f1-score': 0.17582755314286339, 'support': 313033}, 'weighted avg': {'precision': 0.12832721718548082, 'recall': 0.35821143457718513, 'f1-score': 0.1889604305712281, 'support': 313033}}
[[     0 101033      2]
 [     1 112132      5]
 [     4  99856      0]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047428
{'0': {'precision': 0.5, 'recall': 0.00010012348563227981, 'f1-score': 0.00020020688044312455, 'support': 29963}, '1': {'precision': 0.33110163001859755, 'recall': 1.0, 'f1-score': 0.49748512442881093, 'support': 30266}, '2': {'precision': 0.3333333333333333, 'recall': 3.206155819172812e-05, 'f1-score': 6.411694931555156e-05, 'support': 31190}, 'accuracy': 0.3311127883700325, 'macro avg': {'precision': 0.38814498778397694, 'recall': 0.333377395014608, 'f1-score': 0.16591648275285656, 'support': 91419}, 'weighted avg': {'precision': 0.3872202561919244, 'recall': 0.3311127883700325, 'f1-score': 0.1647894133863886, 'support': 91419}}
[[    3 29958     2]
 [    0 30266     0]
 [    3 31186     1]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011072
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8406}, '1': {'precision': 0.3517579980994615, 'recall': 0.9998874507597074, 'f1-score': 0.5204299815471134, 'support': 8885}, '2': {'precision': 0.5, 'recall': 0.000125517760763148, 'f1-score': 0.0002509725185092232, 'support': 7967}, 'accuracy': 0.3517697363211656, 'macro avg': {'precision': 0.2839193326998205, 'recall': 0.3333376561734902, 'f1-score': 0.17356031802187422, 'support': 25258}, 'weighted avg': {'precision': 0.28145022619026505, 'recall': 0.3517697363211656, 'f1-score': 0.18315068034290383, 'support': 25258}}
[[   0 8406    0]
 [   0 8884    1]
 [   0 7966    1]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005474
{'0': {'precision': 0.2885572139303483, 'recall': 0.00048045062955599734, 'f1-score': 0.00095930400840218, 'support': 120720}, '1': {'precision': 0.3340075976756861, 'recall': 0.9989862618201871, 'f1-score': 0.5006309654686113, 'support': 123306}, '2': {'precision': 0.3544973544973545, 'recall': 0.0005353105200501753, 'f1-score': 0.0010690067810131632, 'support': 125161}, 'accuracy': 0.33399334212743137, 'macro avg': {'precision': 0.3256873887011296, 'recall': 0.33333400765659776, 'f1-score': 0.16755309208600888, 'support': 369187}, 'weighted avg': {'precision': 0.3260922272206583, 'recall': 0.33399334212743137, 'f1-score': 0.16788350338902858, 'support': 369187}}
[[    58 120598     64]
 [    67 123181     58]
 [    76 125018     67]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101992
{'0': {'precision': 0.35, 'recall': 0.0005055611729019212, 'f1-score': 0.0010096639261502958, 'support': 41538}, '1': {'precision': 0.32527676300211583, 'recall': 0.99929399162528, 'f1-score': 0.49079615225956114, 'support': 41076}, '2': {'precision': 0.3170731707317073, 'recall': 0.0002976326754888044, 'f1-score': 0.0005947071067499256, 'support': 43678}, 'accuracy': 0.32528584550090267, 'macro avg': {'precision': 0.3307833112446077, 'recall': 0.33336572849122353, 'f1-score': 0.16413350776415378, 'support': 126292}, 'weighted avg': {'precision': 0.33057113885514855, 'recall': 0.32528584550090267, 'f1-score': 0.1601673723386025, 'support': 126292}}
[[   21 41504    13]
 [   14 41047    15]
 [   25 43640    13]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101472
{'0': {'precision': 0.4, 'recall': 0.0006351726875744343, 'f1-score': 0.0012683313515655964, 'support': 12595}, '1': {'precision': 0.3229937542644203, 'recall': 0.9991070703790892, 'f1-score': 0.4881705503222607, 'support': 12319}, '2': {'precision': 0.5454545454545454, 'recall': 0.0009067553271875472, 'f1-score': 0.0018105009052504528, 'support': 13234}, 'accuracy': 0.3231624200482332, 'macro avg': {'precision': 0.4228160999063219, 'recall': 0.33354966613128373, 'f1-score': 0.1637497941930256, 'support': 38148}, 'weighted avg': {'precision': 0.4255925740098786, 'recall': 0.3231624200482332, 'f1-score': 0.15869004434761935, 'support': 38148}}
[[    8 12583     4]
 [    5 12308     6]
 [    7 13215    12]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
5521/5521 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1072314
{'0': {'precision': 0.2222222222222222, 'recall': 8.302458565542722e-06, 'f1-score': 1.6604296776898445e-05, 'support': 481785}, '1': {'precision': 0.32325537295458373, 'recall': 0.9999824891268422, 'f1-score': 0.4885738561958697, 'support': 456859}, '2': {'precision': 0.1, 'recall': 2.1067445319445675e-06, 'f1-score': 4.213400298308742e-06, 'support': 474666}, 'accuracy': 0.3232525065272304, 'macro avg': {'precision': 0.21515919839226863, 'recall': 0.33333096610997986, 'f1-score': 0.1628648912976483, 'support': 1413310}, 'weighted avg': {'precision': 0.21383281782906194, 'recall': 0.3232525065272304, 'f1-score': 0.15794083607048523, 'support': 1413310}}
[[     4 481775      6]
 [     5 456851      3]
 [     9 474656      1]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031393
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 110305}, '1': {'precision': 0.33258622572153007, 'recall': 0.9999726432127811, 'f1-score': 0.49915562454196616, 'support': 109662}, '2': {'precision': 0.5714285714285714, 'recall': 3.6442152637956325e-05, 'f1-score': 7.287965746560991e-05, 'support': 109763}, 'accuracy': 0.33258423558669215, 'macro avg': {'precision': 0.30133826571670047, 'recall': 0.33333636178847303, 'f1-score': 0.1664095013998106, 'support': 329730}, 'weighted avg': {'precision': 0.30083336357258583, 'recall': 0.33258423558669215, 'f1-score': 0.1660340387236936, 'support': 329730}}
[[     0 110303      2]
 [     2 109659      1]
 [     5 109754      4]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077092
{'0': {'precision': 0.5, 'recall': 2.6011861408802414e-05, 'f1-score': 5.2021016490662225e-05, 'support': 38444}, '1': {'precision': 0.3194633030801115, 'recall': 1.0, 'f1-score': 0.4842321909739618, 'support': 35762}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 37740}, 'accuracy': 0.31946652850481483, 'macro avg': {'precision': 0.27315443436003717, 'recall': 0.3333420039538029, 'f1-score': 0.16142807066348416, 'support': 111946}, 'weighted avg': {'precision': 0.2737627663762077, 'recall': 0.31946652850481483, 'f1-score': 0.15470951628078528, 'support': 111946}}
[[    1 38443     0]
 [    0 35762     0]
 [    1 37739     0]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
5918/5918 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105899
{'0': {'precision': 0.5, 'recall': 9.765033757721701e-06, 'f1-score': 1.9529686099355327e-05, 'support': 512031}, '1': {'precision': 0.3291414381773573, 'recall': 0.9999959891466308, 'f1-score': 0.495268752911403, 'support': 498647}, '2': {'precision': 0.36363636363636365, 'recall': 7.931314813713244e-06, 'f1-score': 1.586228365332186e-05, 'support': 504330}, 'accuracy': 0.32914281640757015, 'macro avg': {'precision': 0.39759260060457363, 'recall': 0.33333789516506745, 'f1-score': 0.16510138162705187, 'support': 1515008}, 'weighted avg': {'precision': 0.39836992147602657, 'recall': 0.32914281640757015, 'f1-score': 0.16302374473483333, 'support': 1515008}}
[[     5 512021      5]
 [     0 498645      2]
 [     5 504321      4]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028928
{'0': {'precision': 0.14285714285714285, 'recall': 6.469602572313983e-06, 'f1-score': 1.2938619190559984e-05, 'support': 154569}, '1': {'precision': 0.3304075680751983, 'recall': 0.999980443285528, 'f1-score': 0.49669886313962563, 'support': 153400}, '2': {'precision': 0.6666666666666666, 'recall': 2.5590173373424606e-05, 'f1-score': 5.117838225133703e-05, 'support': 156310}, 'accuracy': 0.3304090859160117, 'macro avg': {'precision': 0.379977125866336, 'recall': 0.33333750102049126, 'f1-score': 0.1655876600470225, 'support': 464279}, 'weighted avg': {'precision': 0.3811769934106169, 'recall': 0.3304090859160117, 'f1-score': 0.16413321560522434, 'support': 464279}}
[[     1 154567      1]
 [     2 153397      1]
 [     4 156302      4]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956002
{'0': {'precision': 0.5, 'recall': 1.9002014213506632e-05, 'f1-score': 3.8002584175723955e-05, 'support': 52626}, '1': {'precision': 0.3624737275531902, 'recall': 0.9999830456749517, 'f1-score': 0.5320793865584122, 'support': 58982}, '2': {'precision': 1.0, 'recall': 3.912822318738506e-05, 'f1-score': 7.825338445887784e-05, 'support': 51114}, 'accuracy': 0.36248325364732487, 'macro avg': {'precision': 0.6208245758510634, 'recall': 0.3333470586374508, 'f1-score': 0.17739854750901562, 'support': 162722}, 'weighted avg': {'precision': 0.6072099986390423, 'recall': 0.36248325364732487, 'f1-score': 0.19290019877752446, 'support': 162722}}
[[    1 52625     0]
 [    1 58981     0]
 [    0 51112     2]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
3755/3755 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0815711
{'0': {'precision': 0.3448275862068966, 'recall': 0.00010703887651995205, 'f1-score': 0.00021401132119889144, 'support': 280272}, '1': {'precision': 0.4255503362269735, 'recall': 0.999858188628684, 'f1-score': 0.5970077783747167, 'support': 408994}, '2': {'precision': 0.3305084745762712, 'recall': 0.00014343666903275873, 'f1-score': 0.0002867488925243093, 'support': 271897}, 'accuracy': 0.42553136148603304, 'macro avg': {'precision': 0.36696213233671376, 'recall': 0.33336955472474555, 'f1-score': 0.19916951286281334, 'support': 961163}, 'weighted avg': {'precision': 0.37512608596883, 'recall': 0.42553136148603304, 'f1-score': 0.254182221801333, 'support': 961163}}
[[    30 280203     39]
 [    18 408936     40]
 [    39 271819     39]]
Evaluating performance on  train set...
1532/1532 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099623
{'0': {'precision': 0.3055555555555556, 'recall': 8.477123326731453e-05, 'f1-score': 0.0001694954428838879, 'support': 129761}, '1': {'precision': 0.330707336045192, 'recall': 0.9997147460854683, 'f1-score': 0.4970046798284446, 'support': 129709}, '2': {'precision': 0.3, 'recall': 9.042204489454528e-05, 'f1-score': 0.00018078959857176216, 'support': 132711}, 'accuracy': 0.3307018952983444, 'macro avg': {'precision': 0.3120876305335825, 'recall': 0.3332966464545434, 'f1-score': 0.16578498828996674, 'support': 392181}, 'weighted avg': {'precision': 0.31199423810824656, 'recall': 0.3307018952983444, 'f1-score': 0.164495390348966, 'support': 392181}}
[[    11 129741      9]
 [    18 129672     19]
 [     7 132692     12]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934423
{'0': {'precision': 0.3333333333333333, 'recall': 7.99637497667724e-05, 'f1-score': 0.00015988914352715452, 'support': 37517}, '1': {'precision': 0.3615313730418028, 'recall': 0.9999768287879139, 'f1-score': 0.5310625311486706, 'support': 43157}, '2': {'precision': 0.5, 'recall': 5.1667570849156524e-05, 'f1-score': 0.00010332446465011752, 'support': 38709}, 'accuracy': 0.36153388673429215, 'macro avg': {'precision': 0.3982882354583787, 'recall': 0.3333694867028432, 'f1-score': 0.17710858158561596, 'support': 119383}, 'weighted avg': {'precision': 0.39756729293979665, 'recall': 0.36153388673429215, 'f1-score': 0.19206305591652942, 'support': 119383}}
[[    3 37513     1]
 [    0 43156     1]
 [    6 38701     2]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
4960/4960 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1054382
{'0': {'precision': 0.37623762376237624, 'recall': 8.735511694091575e-05, 'f1-score': 0.00017466967895253348, 'support': 435006}, '1': {'precision': 0.3097150572319598, 'recall': 0.9998753900418842, 'f1-score': 0.47293635089702957, 'support': 393227}, '2': {'precision': 0.34375, 'recall': 7.475416074862894e-05, 'f1-score': 0.00014947581549248882, 'support': 441447}, 'accuracy': 0.3097229223111335, 'macro avg': {'precision': 0.34323422699811196, 'recall': 0.3333458331065246, 'f1-score': 0.1577534987971582, 'support': 1269680}, 'weighted avg': {'precision': 0.3443397965018966, 'recall': 0.3097229223111335, 'f1-score': 0.14658284801120786, 'support': 1269680}}
[[    38 434925     43]
 [    29 393178     20]
 [    34 441380     33]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1036249
{'0': {'precision': 0.2916666666666667, 'recall': 4.62354440914405e-05, 'f1-score': 9.245623188022956e-05, 'support': 151399}, '1': {'precision': 0.3153987282104368, 'recall': 0.9998681463575432, 'f1-score': 0.47953331424526296, 'support': 136515}, '2': {'precision': 0.29545454545454547, 'recall': 8.969847512592287e-05, 'f1-score': 0.0001793425027936044, 'support': 144930}, 'accuracy': 0.31539538494238106, 'macro avg': {'precision': 0.30083998011054963, 'recall': 0.3333346934255868, 'f1-score': 0.15993503765997893, 'support': 432844}, 'weighted avg': {'precision': 0.3004198425322789, 'recall': 0.31539538494238106, 'f1-score': 0.1513327671959699, 'support': 432844}}
[[     7 151368     24]
 [    11 136497      7]
 [     6 144911     13]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1103965
{'0': {'precision': 0.3076923076923077, 'recall': 7.357810315650063e-05, 'f1-score': 0.00014712102543354725, 'support': 54364}, '1': {'precision': 0.2760115415668471, 'recall': 0.9998082224619441, 'f1-score': 0.4325981091271179, 'support': 41715}, '2': {'precision': 0.3333333333333333, 'recall': 9.081827263645445e-05, 'f1-score': 0.00018158707100054475, 'support': 55055}, 'accuracy': 0.2760199558008125, 'macro avg': {'precision': 0.3056790608641627, 'recall': 0.3333242062792457, 'f1-score': 0.14430893907451733, 'support': 151134}, 'weighted avg': {'precision': 0.30828849060113744, 'recall': 0.2760199558008125, 'f1-score': 0.11952191754243471, 'support': 151134}}
[[    4 54356     4]
 [    2 41707     6]
 [    7 55043     5]]
testing model on single stock: results/universal/W8/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
10609/10609 - 149s - 149s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11284
{'0': {'precision': 0.42702702702702705, 'recall': 0.00015328019619865113, 'f1-score': 0.0003064503928577662, 'support': 1030792}, '1': {'precision': 0.24566803033087795, 'recall': 0.9997901445903772, 'f1-score': 0.39441946829129104, 'support': 667126}, '2': {'precision': 0.3746130030959752, 'recall': 0.00011888807228394794, 'f1-score': 0.0002377007073069394, 'support': 1017764}, 'accuracy': 0.24570807627697205, 'macro avg': {'precision': 0.3491026868179601, 'recall': 0.3333541042862866, 'f1-score': 0.13165453979715191, 'support': 2715682}, 'weighted avg': {'precision': 0.3628315841577669, 'recall': 0.24570807627697205, 'f1-score': 0.09709726397984816, 'support': 2715682}}
[[    158 1030501     133]
 [     71  666986      69]
 [    141 1017502     121]]
Evaluating performance on  train set...
3903/3903 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100769
{'0': {'precision': 0.39814814814814814, 'recall': 0.00012945763273170658, 'f1-score': 0.0002588311066835609, 'support': 332155}, '1': {'precision': 0.33022377599974373, 'recall': 0.9998454062934795, 'f1-score': 0.49647451407447446, 'support': 329897}, '2': {'precision': 0.3939393939393939, 'recall': 0.00011572322565138823, 'f1-score': 0.00023137848180119247, 'support': 337011}, 'accuracy': 0.3302374324742284, 'macro avg': {'precision': 0.3741037726957619, 'recall': 0.3333635290506209, 'f1-score': 0.16565490788765308, 'support': 999063}, 'weighted avg': {'precision': 0.37429935876921144, 'recall': 0.3302374324742284, 'f1-score': 0.1641031665764798, 'support': 999063}}
[[    43 332075     37]
 [    28 329846     23]
 [    37 336935     39]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031196
{'0': {'precision': 0.38461538461538464, 'recall': 9.890218573830482e-05, 'f1-score': 0.00019775352001265623, 'support': 101110}, '1': {'precision': 0.31323781725714833, 'recall': 0.999890899966179, 'f1-score': 0.4770341839191141, 'support': 91659}, '2': {'precision': 0.38095238095238093, 'recall': 8.010894816951053e-05, 'f1-score': 0.00016018421184362016, 'support': 99864}, 'accuracy': 0.31324901839505453, 'macro avg': {'precision': 0.359601860941638, 'recall': 0.33335663703336227, 'f1-score': 0.15913070721699013, 'support': 292633}, 'weighted avg': {'precision': 0.3610083456133214, 'recall': 0.31324901839505453, 'f1-score': 0.14954044061463373, 'support': 292633}}
[[    10 101092      8]
 [     5  91649      5]
 [    11  99845      8]]
training model: results/universal/W8/deepVOL_L3/h500
Epoch 1/50
7696/7696 - 436s - loss: 3.2810 - accuracy500: 0.3660 - val_loss: 3.2975 - val_accuracy500: 0.3416 - 436s/epoch - 57ms/step
Epoch 2/50
7696/7696 - 426s - loss: 3.2698 - accuracy500: 0.3733 - val_loss: 3.3151 - val_accuracy500: 0.3361 - 426s/epoch - 55ms/step
Epoch 3/50
7696/7696 - 430s - loss: 3.2671 - accuracy500: 0.3762 - val_loss: 3.3414 - val_accuracy500: 0.3379 - 430s/epoch - 56ms/step
Epoch 4/50
7696/7696 - 430s - loss: 3.2600 - accuracy500: 0.3804 - val_loss: 3.3770 - val_accuracy500: 0.3247 - 430s/epoch - 56ms/step
Epoch 5/50
7696/7696 - 425s - loss: 3.2516 - accuracy500: 0.3846 - val_loss: 3.3887 - val_accuracy500: 0.3215 - 425s/epoch - 55ms/step
Epoch 6/50
7696/7696 - 424s - loss: 3.2481 - accuracy500: 0.3873 - val_loss: 3.4290 - val_accuracy500: 0.3222 - 424s/epoch - 55ms/step
Epoch 7/50
7696/7696 - 436s - loss: 3.2460 - accuracy500: 0.3884 - val_loss: 3.4464 - val_accuracy500: 0.3225 - 436s/epoch - 57ms/step
Epoch 8/50
7696/7696 - 444s - loss: 3.2457 - accuracy500: 0.3890 - val_loss: 3.4644 - val_accuracy500: 0.3214 - 444s/epoch - 58ms/step
Epoch 9/50
7696/7696 - 453s - loss: 3.2421 - accuracy500: 0.3905 - val_loss: 3.4565 - val_accuracy500: 0.3224 - 453s/epoch - 59ms/step
Epoch 10/50
7696/7696 - 435s - loss: 3.2385 - accuracy500: 0.3919 - val_loss: 3.4524 - val_accuracy500: 0.3218 - 435s/epoch - 56ms/step
Epoch 11/50
7696/7696 - 419s - loss: 3.2343 - accuracy500: 0.3947 - val_loss: 3.4142 - val_accuracy500: 0.3241 - 419s/epoch - 54ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 730s - 730s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963506
{'0': {'precision': 0.3667074417959892, 'recall': 0.8434262944487547, 'f1-score': 0.5111677982642754, 'support': 2142186}, '1': {'precision': 0.314371783819209, 'recall': 0.1302737301465656, 'f1-score': 0.1842113937715807, 'support': 1715887}, '2': {'precision': 0.3466917731006033, 'recall': 0.053233280786724964, 'f1-score': 0.09229499539737002, 'support': 2102895}, 'accuracy': 0.35938038922537413, 'macro avg': {'precision': 0.34259033290526714, 'recall': 0.3423111017940151, 'f1-score': 0.262558062477742, 'support': 5960968}, 'weighted avg': {'precision': 0.34458135006391033, 'recall': 0.35938038922537413, 'f1-score': 0.2692832978239849, 'support': 5960968}}
[[1806776  223515  111895]
 [1393299  223535   99053]
 [1726948  264003  111944]]
Evaluating performance on  train set...
7696/7696 - 247s - 247s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992196
{'0': {'precision': 0.3372259916492693, 'recall': 0.877622693169564, 'f1-score': 0.48723299732121583, 'support': 653765}, '1': {'precision': 0.36928042976297065, 'recall': 0.09646882136064555, 'f1-score': 0.15297522314783635, 'support': 649868}, '2': {'precision': 0.33319091796875, 'recall': 0.04919148092579827, 'f1-score': 0.08572651216840649, 'support': 665847}, 'accuracy': 0.3397876596868209, 'macro avg': {'precision': 0.34656577979366326, 'recall': 0.34109433181866927, 'f1-score': 0.24197824421248626, 'support': 1969480}, 'weighted avg': {'precision': 0.3464387848145323, 'recall': 0.3397876596868209, 'f1-score': 0.24119580993873496, 'support': 1969480}}
[[573759  48579  31427]
 [553053  62692  34123]
 [574596  58497  32754]]
Evaluating performance on  val set...
2338/2338 - 73s - 73s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992091
{'0': {'precision': 0.3423448302313763, 'recall': 0.8787516306086786, 'f1-score': 0.49273106170386016, 'support': 203145}, '1': {'precision': 0.3326464527524286, 'recall': 0.08237781318669875, 'f1-score': 0.1320534223706177, 'support': 192042}, '2': {'precision': 0.3441984918511311, 'recall': 0.04889112654435247, 'f1-score': 0.08562043480140037, 'support': 202593}, 'accuracy': 0.34166248452607983, 'macro avg': {'precision': 0.3397299249449787, 'recall': 0.3366735234465766, 'f1-score': 0.23680163962529274, 'support': 597780}, 'weighted avg': {'precision': 0.3398573650447172, 'recall': 0.34166248452607983, 'f1-score': 0.2388868072141071, 'support': 597780}}
[[178514  15012   9619]
 [166969  15820   9253]
 [175962  16726   9905]]
testing model out of sample: results/universal/W8/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 436s - 436s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097789
{'0': {'precision': 0.34878188478277866, 'recall': 0.8332618557296047, 'f1-score': 0.491735848003372, 'support': 1247477}, '1': {'precision': 0.3491894914793352, 'recall': 0.12183562573227132, 'f1-score': 0.18064310644566245, 'support': 1117243}, '2': {'precision': 0.33679878445137806, 'recall': 0.06623908746170724, 'f1-score': 0.11070544827153357, 'support': 1251542}, 'accuracy': 0.3480101828905096, 'macro avg': {'precision': 0.34492338690449725, 'recall': 0.34044552297452774, 'f1-score': 0.26102813424018934, 'support': 3616262}, 'weighted avg': {'precision': 0.34476061706863603, 'recall': 0.3480101828905096, 'f1-score': 0.26375409878350226, 'support': 3616262}}
[[1039475  126051   81951]
 [ 899831  136120   81292]
 [1040995  127646   82901]]
Evaluating performance on  train set...
4550/4550 - 144s - 144s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098735
{'0': {'precision': 0.3403811632572502, 'recall': 0.8595174949712368, 'f1-score': 0.4876471238166128, 'support': 390255}, '1': {'precision': 0.3798647907911566, 'recall': 0.10270884469775762, 'f1-score': 0.16169749416164017, 'support': 384592}, '2': {'precision': 0.3217770757760317, 'recall': 0.06174865914555206, 'f1-score': 0.10361392294579223, 'support': 389304}, 'accuracy': 0.34271413244501786, 'macro avg': {'precision': 0.3473410099414795, 'recall': 0.34132499960484886, 'f1-score': 0.25098618030801506, 'support': 1164151}, 'weighted avg': {'precision': 0.3472036816485344, 'recall': 0.34271413244501786, 'f1-score': 0.2515409131961012, 'support': 1164151}}
[[335431  30639  24185]
 [318608  39501  26483]
 [331418  33847  24039]]
Evaluating performance on  val set...
1570/1570 - 49s - 49s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987662
{'0': {'precision': 0.34563837155052757, 'recall': 0.872244891989528, 'f1-score': 0.49509064306245915, 'support': 136746}, '1': {'precision': 0.36249297796641905, 'recall': 0.08982707418177319, 'f1-score': 0.14397629938145354, 'support': 129304}, '2': {'precision': 0.3441553008116476, 'recall': 0.06094100738611529, 'f1-score': 0.10354659030116121, 'support': 134983}, 'accuracy': 0.34689663942867544, 'macro avg': {'precision': 0.35076221677619807, 'recall': 0.3410043245191388, 'f1-score': 0.24753784424835798, 'support': 401033}, 'weighted avg': {'precision': 0.3505735731186135, 'recall': 0.34689663942867544, 'f1-score': 0.25009265045534945, 'support': 401033}}
[[119276   9661   7809]
 [109822  11615   7867]
 [115991  10766   8226]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
645/645 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.092434
{'0': {'precision': 0.38498093962497426, 'recall': 0.9419865128883848, 'f1-score': 0.5465798760307912, 'support': 63468}, '1': {'precision': 0.22207903780068727, 'recall': 0.0270609788013609, 'f1-score': 0.04824336303830542, 'support': 38210}, '2': {'precision': 0.35358004827031375, 'recall': 0.02779622426714733, 'f1-score': 0.05154064909554663, 'support': 63246}, 'accuracy': 0.37943537629453566, 'macro avg': {'precision': 0.3202133418986584, 'recall': 0.3322812386522977, 'f1-score': 0.21545462938821444, 'support': 164924}, 'weighted avg': {'precision': 0.33519763068677927, 'recall': 0.37943537629453566, 'f1-score': 0.24128356313400623, 'support': 164924}}
[[59786  1659  2023]
 [35985  1034  1191]
 [59525  1963  1758]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995482
{'0': {'precision': 0.3337349397590361, 'recall': 0.9086291730596264, 'f1-score': 0.4881681613393783, 'support': 18901}, '1': {'precision': 0.3233799237611182, 'recall': 0.053939490277115455, 'f1-score': 0.09245719994550655, 'support': 18873}, '2': {'precision': 0.3448546739984289, 'recall': 0.045304437564499485, 'f1-score': 0.08008756727173219, 'support': 19380}, 'accuracy': 0.3336599363124191, 'macro avg': {'precision': 0.3339898458395277, 'recall': 0.3359577003004138, 'f1-score': 0.22023764285220568, 'support': 57154}, 'weighted avg': {'precision': 0.3340861003537579, 'recall': 0.3336599363124191, 'f1-score': 0.21912566409653397, 'support': 57154}}
[[17174   903   824]
 [17011  1018   844]
 [17275  1227   878]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956113
{'0': {'precision': 0.3827099331186525, 'recall': 0.9339579870031737, 'f1-score': 0.5429387217219416, 'support': 6617}, '1': {'precision': 0.28180039138943247, 'recall': 0.028846153846153848, 'f1-score': 0.05233508995093586, 'support': 4992}, '2': {'precision': 0.33391003460207613, 'recall': 0.034292821606254444, 'f1-score': 0.06219787302610377, 'support': 5628}, 'accuracy': 0.37808203283634045, 'macro avg': {'precision': 0.33280678637005373, 'recall': 0.33236565415186065, 'f1-score': 0.21915722823299374, 'support': 17237}, 'weighted avg': {'precision': 0.3375520598713613, 'recall': 0.37808203283634045, 'f1-score': 0.24388999942333767, 'support': 17237}}
[[6180  201  236]
 [4699  144  149]
 [5269  166  193]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
2179/2179 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971075
{'0': {'precision': 0.3866835992354996, 'recall': 0.7178810253224721, 'f1-score': 0.5026284791723298, 'support': 212499}, '1': {'precision': 0.2569832402234637, 'recall': 0.20102139763397764, 'f1-score': 0.22558343670881484, 'support': 154690}, '2': {'precision': 0.3443103856162763, 'recall': 0.07636247251968875, 'f1-score': 0.12500161040277247, 'support': 190591}, 'accuracy': 0.3553354369106099, 'macro avg': {'precision': 0.32932574169174655, 'recall': 0.33175496515871283, 'f1-score': 0.2844045087613057, 'support': 557780}, 'weighted avg': {'precision': 0.3362348529690985, 'recall': 0.3553354369106099, 'f1-score': 0.29676168551830884, 'support': 557780}}
[[152549  43902  16048]
 [111926  31096  11668]
 [130031  46006  14554]]
Evaluating performance on  train set...
614/614 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970834
{'0': {'precision': 0.3548764377729349, 'recall': 0.7847573682643644, 'f1-score': 0.4887392737744147, 'support': 53744}, '1': {'precision': 0.3728989177987566, 'recall': 0.18754342623330503, 'f1-score': 0.2495697958135354, 'support': 51812}, '2': {'precision': 0.3350024626498112, 'recall': 0.07919504764122567, 'f1-score': 0.12810572410654025, 'support': 51531}, 'accuracy': 0.35632483910189894, 'macro avg': {'precision': 0.3542592727405009, 'recall': 0.3504986140462984, 'f1-score': 0.2888049312314968, 'support': 157087}, 'weighted avg': {'precision': 0.3543013101241046, 'recall': 0.35632483910189894, 'f1-score': 0.2915513687278843, 'support': 157087}}
[[42176  7488  4080]
 [38074  9717  4021]
 [38597  8853  4081]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974075
{'0': {'precision': 0.35396412789186377, 'recall': 0.8093794579172611, 'f1-score': 0.49253083517198976, 'support': 16824}, '1': {'precision': 0.3226691042047532, 'recall': 0.13394889956994688, 'f1-score': 0.18930997497318555, 'support': 15812}, '2': {'precision': 0.35053885422575154, 'recall': 0.07761868877166542, 'f1-score': 0.12709511568123394, 'support': 15924}, 'accuracy': 0.3494851729818781, 'macro avg': {'precision': 0.34239069544078954, 'recall': 0.34031568208629115, 'f1-score': 0.2696453086088031, 'support': 48560}, 'weighted avg': {'precision': 0.3426506811785244, 'recall': 0.3494851729818781, 'f1-score': 0.27396150571082234, 'support': 48560}}
[[13617  2044  1163]
 [12567  2118  1127]
 [12286  2402  1236]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
1162/1162 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043072
{'0': {'precision': 0.25866812509654447, 'recall': 0.8440109523355447, 'f1-score': 0.39597873047524096, 'support': 73409}, '1': {'precision': 0.5691121479863662, 'recall': 0.11828223221777466, 'f1-score': 0.19585803196729248, 'support': 145398}, '2': {'precision': 0.27849334343543675, 'recall': 0.09813618795768918, 'f1-score': 0.14513081327028474, 'support': 78656}, 'accuracy': 0.29205312929675287, 'macro avg': {'precision': 0.36875787217278244, 'recall': 0.3534764575036695, 'f1-score': 0.2456558585709394, 'support': 297463}, 'weighted avg': {'precision': 0.41565340532903794, 'recall': 0.29205312929675287, 'f1-score': 0.23183111178877666, 'support': 297463}}
[[ 61958   5327   6124]
 [114326  17198  13874]
 [ 63243   7694   7719]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985804
{'0': {'precision': 0.34032074242917615, 'recall': 0.8932374203197891, 'f1-score': 0.4928624060519723, 'support': 28081}, '1': {'precision': 0.40411946446961894, 'recall': 0.06779309629936768, 'f1-score': 0.11610841519706473, 'support': 28941}, '2': {'precision': 0.2954409715309576, 'recall': 0.05587349397590361, 'f1-score': 0.09397460659215401, 'support': 26560}, 'accuracy': 0.34132947285300663, 'macro avg': {'precision': 0.3466270594765842, 'recall': 0.3389680035316868, 'f1-score': 0.23431514261373035, 'support': 83582}, 'weighted avg': {'precision': 0.3481500848655353, 'recall': 0.34132947285300663, 'f1-score': 0.23565275322020643, 'support': 83582}}
[[25083  1381  1617]
 [25057  1962  1922]
 [23564  1512  1484]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022662
{'0': {'precision': 0.3068724602552221, 'recall': 0.8852442159383034, 'f1-score': 0.4557558431933084, 'support': 9725}, '1': {'precision': 0.42782699322563833, 'recall': 0.06595437017994858, 'f1-score': 0.11428969165448596, 'support': 12448}, '2': {'precision': 0.27762506871907644, 'recall': 0.05250025990227675, 'f1-score': 0.08830215072565134, 'support': 9619}, 'accuracy': 0.3125, 'macro avg': {'precision': 0.33744150739997897, 'recall': 0.3345662820068429, 'f1-score': 0.21944922852448193, 'support': 31792}, 'weighted avg': {'precision': 0.34538250577703755, 'recall': 0.3125, 'f1-score': 0.21087953084423774, 'support': 31792}}
[[ 8609   555   561]
 [10874   821   753]
 [ 8571   543   505]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1223/1223 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017036
{'0': {'precision': 0.322307921958197, 'recall': 0.9738407248072005, 'f1-score': 0.4843218887188095, 'support': 100882}, '1': {'precision': 0.36, 'recall': 0.011436247458611676, 'f1-score': 0.022168267708223374, 'support': 110176}, '2': {'precision': 0.3161795849216434, 'recall': 0.014640843343956851, 'f1-score': 0.027985791540530658, 'support': 101975}, 'accuracy': 0.322636910485476, 'macro avg': {'precision': 0.3328291689599468, 'recall': 0.3333059385365897, 'f1-score': 0.1781586493225212, 'support': 313033}, 'weighted avg': {'precision': 0.3335777408623737, 'recall': 0.322636910485476, 'f1-score': 0.17300291960623246, 'support': 313033}}
[[ 98243   1135   1504]
 [107191   1260   1725]
 [ 99377   1105   1493]]
Evaluating performance on  train set...
358/358 - 12s - 12s/epoch - 34ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002119
{'0': {'precision': 0.32770220939244515, 'recall': 0.9752632458632793, 'f1-score': 0.4905669895076675, 'support': 29915}, '1': {'precision': 0.3436213991769547, 'recall': 0.011048261718103932, 'f1-score': 0.02140819792968625, 'support': 30231}, '2': {'precision': 0.3469675599435825, 'recall': 0.015732420938189492, 'f1-score': 0.030100027530512982, 'support': 31273}, 'accuracy': 0.3281702928275304, 'macro avg': {'precision': 0.3394303895043274, 'recall': 0.33401464283985755, 'f1-score': 0.18069173832262223, 'support': 91419}, 'weighted avg': {'precision': 0.33955683845381346, 'recall': 0.3281702928275304, 'f1-score': 0.17790416525772487, 'support': 91419}}
[[29175   322   418]
 [29389   334   508]
 [30465   316   492]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018003
{'0': {'precision': 0.3212846501404323, 'recall': 0.9727631254621641, 'f1-score': 0.48303295492793985, 'support': 8114}, '1': {'precision': 0.4043321299638989, 'recall': 0.012024908739531888, 'f1-score': 0.02335522886038995, 'support': 9314}, '2': {'precision': 0.2922705314009662, 'recall': 0.01545338441890166, 'f1-score': 0.02935468219311014, 'support': 7830}, 'accuracy': 0.32171985113627366, 'macro avg': {'precision': 0.3392957705017658, 'recall': 0.3334138062068659, 'f1-score': 0.17858095532714666, 'support': 25258}, 'weighted avg': {'precision': 0.342914378438229, 'recall': 0.32171985113627366, 'f1-score': 0.17288412223703495, 'support': 25258}}
[[7893   83  138]
 [9047  112  155]
 [7627   82  121]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993893
{'0': {'precision': 0.32694867536016775, 'recall': 0.929784596830927, 'f1-score': 0.4837810043401719, 'support': 119404}, '1': {'precision': 0.4222050126724866, 'recall': 0.0475216926185665, 'f1-score': 0.08542795888859607, 'support': 126195}, '2': {'precision': 0.3245346650236721, 'recall': 0.0404893678997961, 'f1-score': 0.07199637428330947, 'support': 123588}, 'accuracy': 0.33051272119549174, 'macro avg': {'precision': 0.3578961176854422, 'recall': 0.3392652191164299, 'f1-score': 0.21373511250402585, 'support': 369187}, 'weighted avg': {'precision': 0.3587009601850973, 'recall': 0.33051272119549174, 'f1-score': 0.20976864358470346, 'support': 369187}}
[[111020   3644   4740]
 [114523   5997   5675]
 [114021   4563   5004]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989884
{'0': {'precision': 0.3281313528897809, 'recall': 0.9269323819066005, 'f1-score': 0.4846854674861678, 'support': 40921}, '1': {'precision': 0.4052837573385519, 'recall': 0.0494803488233186, 'f1-score': 0.08819333546257851, 'support': 41855}, '2': {'precision': 0.3181736794986571, 'recall': 0.04083555473848699, 'f1-score': 0.07238141789372925, 'support': 43516}, 'accuracy': 0.33081271972888227, 'macro avg': {'precision': 0.35052959657566335, 'recall': 0.33908276182280206, 'f1-score': 0.2150867402808252, 'support': 126292}, 'weighted avg': {'precision': 0.35026969714686107, 'recall': 0.33081271972888227, 'f1-score': 0.21121603784761678, 'support': 126292}}
[[37931  1338  1652]
 [37628  2071  2156]
 [40038  1701  1777]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995252
{'0': {'precision': 0.3229377420660154, 'recall': 0.9154444899631299, 'f1-score': 0.47744802683588655, 'support': 12205}, '1': {'precision': 0.3705408515535098, 'recall': 0.051090836969456564, 'f1-score': 0.08979990239141045, 'support': 12605}, '2': {'precision': 0.3465783664459161, 'recall': 0.04708352076773129, 'f1-score': 0.08290429042904289, 'support': 13338}, 'accuracy': 0.3262294222501835, 'macro avg': {'precision': 0.34668565335514706, 'recall': 0.3378729492334393, 'f1-score': 0.21671740655211327, 'support': 38148}, 'weighted avg': {'precision': 0.34693260006824306, 'recall': 0.3262294222501835, 'f1-score': 0.2114123509205803, 'support': 38148}}
[[11173   491   541]
 [11318   644   643]
 [12107   603   628]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
5521/5521 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962096
{'0': {'precision': 0.3754009470878334, 'recall': 0.6484808984864474, 'f1-score': 0.47552428927702933, 'support': 495589}, '1': {'precision': 0.3109270806074661, 'recall': 0.327322599031063, 'f1-score': 0.31891425371718396, 'support': 421080}, '2': {'precision': 0.3614300259813215, 'recall': 0.08291099607160907, 'f1-score': 0.13488074238947603, 'support': 496641}, 'accuracy': 0.3540525433202907, 'macro avg': {'precision': 0.34925268455887365, 'recall': 0.35290483119637317, 'f1-score': 0.30977309512789647, 'support': 1413310}, 'weighted avg': {'precision': 0.35128225555744574, 'recall': 0.3540525433202907, 'f1-score': 0.3091609963382395, 'support': 1413310}}
[[321380 134457  39752]
 [250252 137829  32999]
 [284466 170998  41177]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975372
{'0': {'precision': 0.3536928539506834, 'recall': 0.6571887432930613, 'f1-score': 0.4598816772080164, 'support': 109588}, '1': {'precision': 0.35098570981537497, 'recall': 0.3089303256488648, 'f1-score': 0.3286179568438067, 'support': 108921}, '2': {'precision': 0.34156827727618483, 'recall': 0.09286016130047384, 'f1-score': 0.14602214084746, 'support': 111221}, 'accuracy': 0.3517938919722197, 'macro avg': {'precision': 0.34874894701408105, 'recall': 0.35299307674746666, 'f1-score': 0.31150725829976106, 'support': 329730}, 'weighted avg': {'precision': 0.3487088598079717, 'recall': 0.3517938919722197, 'f1-score': 0.31065307447442364, 'support': 329730}}
[[72020 27771  9797]
 [65160 33649 10112]
 [66443 34450 10328]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097879
{'0': {'precision': 0.3584412800900189, 'recall': 0.6897280577393994, 'f1-score': 0.47173104384464853, 'support': 38795}, '1': {'precision': 0.3291554655587753, 'recall': 0.26436362616717607, 'f1-score': 0.2932230274002426, 'support': 35663}, '2': {'precision': 0.3454692556634304, 'recall': 0.07973218096457534, 'f1-score': 0.1295622019939315, 'support': 37488}, 'accuracy': 0.34994550944205244, 'macro avg': {'precision': 0.3443553337707415, 'recall': 0.3446079549570502, 'f1-score': 0.29817209107960757, 'support': 111946}, 'weighted avg': {'precision': 0.3447675869224945, 'recall': 0.34994550944205244, 'f1-score': 0.3002791211876842, 'support': 111946}}
[[26758  9033  3004]
 [23576  9428  2659]
 [24317 10182  2989]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
5918/5918 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985842
{'0': {'precision': 0.3463570576009749, 'recall': 0.7966793507685337, 'f1-score': 0.48281142011435013, 'support': 520862}, '1': {'precision': 0.3563898411294187, 'recall': 0.15775872794431084, 'f1-score': 0.2187056869190259, 'support': 490293}, '2': {'precision': 0.32467519468300204, 'recall': 0.06437790387275653, 'f1-score': 0.10745015809288143, 'support': 503853}, 'accuracy': 0.3463645076461642, 'macro avg': {'precision': 0.3424740311377985, 'recall': 0.33960532752853373, 'f1-score': 0.2696557550420858, 'support': 1515008}, 'weighted avg': {'precision': 0.3423930731584518, 'recall': 0.3463645076461642, 'f1-score': 0.27250488034767023, 'support': 1515008}}
[[414960  71831  34071]
 [379547  77348  33398]
 [403563  67853  32437]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984507
{'0': {'precision': 0.3403725650818643, 'recall': 0.8287044531791309, 'f1-score': 0.4825486362616583, 'support': 154429}, '1': {'precision': 0.37173589387577577, 'recall': 0.1450162492332189, 'f1-score': 0.20864062492664903, 'support': 153238}, '2': {'precision': 0.3385942760942761, 'recall': 0.061642785993410464, 'f1-score': 0.10429765994684645, 'support': 156612}, 'accuracy': 0.34430159451536685, 'macro avg': {'precision': 0.35023424501730543, 'recall': 0.3451211628019201, 'f1-score': 0.2651623070450512, 'support': 464279}, 'weighted avg': {'precision': 0.35012435739380876, 'recall': 0.34430159451536685, 'f1-score': 0.26455092853942774, 'support': 464279}}
[[127976  17192   9261]
 [121419  22222   9597]
 [126593  20365   9654]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005483
{'0': {'precision': 0.3361232484556275, 'recall': 0.8286653541844656, 'f1-score': 0.47825620906625504, 'support': 53842}, '1': {'precision': 0.3644799842045511, 'recall': 0.12972137310705878, 'f1-score': 0.19134242883611252, 'support': 56922}, '2': {'precision': 0.33816723233569884, 'recall': 0.06328188151968898, 'f1-score': 0.10661305750555276, 'support': 51958}, 'accuracy': 0.3397758139649218, 'macro avg': {'precision': 0.3462568216652924, 'recall': 0.3405562029370712, 'f1-score': 0.2587372318026401, 'support': 162722}, 'weighted avg': {'precision': 0.34669541095818385, 'recall': 0.3397758139649218, 'f1-score': 0.25922288187600945, 'support': 162722}}
[[44617  6055  3170]
 [46273  7384  3265]
 [41850  6820  3288]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
3755/3755 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994446
{'0': {'precision': 0.3292647675763064, 'recall': 0.8308240951412758, 'f1-score': 0.4716209445242891, 'support': 309855}, '1': {'precision': 0.42425591847724775, 'recall': 0.11594871504585079, 'f1-score': 0.18212331233523457, 'support': 353320}, '2': {'precision': 0.30415815740819063, 'recall': 0.08446648858343289, 'f1-score': 0.13221586327713591, 'support': 297988}, 'accuracy': 0.3366463336603677, 'macro avg': {'precision': 0.35255961448724826, 'recall': 0.3437464329235198, 'f1-score': 0.26198670671221985, 'support': 961163}, 'weighted avg': {'precision': 0.35639940018861477, 'recall': 0.3366463336603677, 'f1-score': 0.25997739940684966, 'support': 961163}}
[[257435  26990  25430]
 [280200  40967  32153]
 [244213  28605  25170]]
Evaluating performance on  train set...
1532/1532 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977542
{'0': {'precision': 0.34080597653095157, 'recall': 0.8821409082874118, 'f1-score': 0.49166304345498046, 'support': 130113}, '1': {'precision': 0.43616492796820666, 'recall': 0.10163605494675104, 'f1-score': 0.16485682991707087, 'support': 129580}, '2': {'precision': 0.3216014602015713, 'recall': 0.061175351729968, 'f1-score': 0.10279662629209207, 'support': 132488}, 'accuracy': 0.3469137974557666, 'macro avg': {'precision': 0.3661907882335765, 'recall': 0.34831743832137696, 'f1-score': 0.2531054998880478, 'support': 392181}, 'weighted avg': {'precision': 0.365825661237229, 'recall': 0.3469137974557666, 'f1-score': 0.2523151835960911, 'support': 392181}}
[[114778   7740   7595]
 [106908  13170   9502]
 [115098   9285   8105]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991977
{'0': {'precision': 0.3332161353161971, 'recall': 0.8912894288691762, 'f1-score': 0.4850807176748883, 'support': 39343}, '1': {'precision': 0.3690527218174025, 'recall': 0.06730593845271908, 'f1-score': 0.11384873060648801, 'support': 38377}, '2': {'precision': 0.34256539376136524, 'recall': 0.0587811727432014, 'f1-score': 0.10034417766123085, 'support': 41663}, 'accuracy': 0.3358769674074198, 'macro avg': {'precision': 0.34827808363165497, 'recall': 0.3391255133550322, 'f1-score': 0.2330912086475357, 'support': 119383}, 'weighted avg': {'precision': 0.34799896733380264, 'recall': 0.3358769674074198, 'f1-score': 0.23147636500898938, 'support': 119383}}
[[35066  1975  2302]
 [33396  2583  2398]
 [36773  2441  2449]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
4960/4960 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095506
{'0': {'precision': 0.3738520911504839, 'recall': 0.8318875522501031, 'f1-score': 0.515870739944532, 'support': 470334}, '1': {'precision': 0.27813776248512717, 'recall': 0.10908821461341271, 'f1-score': 0.15671237840714777, 'support': 317147}, '2': {'precision': 0.365273767917743, 'recall': 0.0747782554505505, 'f1-score': 0.12414229989292735, 'support': 482199}, 'accuracy': 0.3638082036418625, 'macro avg': {'precision': 0.339087873851118, 'recall': 0.3385846741046888, 'f1-score': 0.26557513941486904, 'support': 1269680}, 'weighted avg': {'precision': 0.34668621386035076, 'recall': 0.3638082036418625, 'f1-score': 0.2773877686833162, 'support': 1269680}}
[[391265  43838  35231]
 [255124  34597  27426]
 [400188  45953  36058]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988078
{'0': {'precision': 0.34490059833485603, 'recall': 0.8600352886298953, 'f1-score': 0.4923526452262085, 'support': 147923}, '1': {'precision': 0.39007729065777236, 'recall': 0.08584536118855207, 'f1-score': 0.1407217150856733, 'support': 141685}, '2': {'precision': 0.3104310187160885, 'recall': 0.07109944427378592, 'f1-score': 0.11569966258052054, 'support': 143236}, 'accuracy': 0.3455425049209415, 'macro avg': {'precision': 0.34846963590290564, 'recall': 0.3389933646974111, 'f1-score': 0.24959134096413413, 'support': 432844}, 'weighted avg': {'precision': 0.3482818972450838, 'recall': 0.3455425049209415, 'f1-score': 0.2526101630404799, 'support': 432844}}
[[127219   9870  10834]
 [117734  12163  11788]
 [123904   9148  10184]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962393
{'0': {'precision': 0.3628692932520307, 'recall': 0.8900601578453557, 'f1-score': 0.515552571848726, 'support': 54357}, '1': {'precision': 0.3241792535264012, 'recall': 0.06134114368046862, 'f1-score': 0.10316199253197743, 'support': 42337}, '2': {'precision': 0.34817235041862366, 'recall': 0.06263776634827332, 'f1-score': 0.10617430021483948, 'support': 54440}, 'accuracy': 0.35986607910860563, 'macro avg': {'precision': 0.3450736323990185, 'recall': 0.3380130226246992, 'f1-score': 0.24162962153184764, 'support': 151134}, 'weighted avg': {'precision': 0.3467371073791321, 'recall': 0.35986607910860563, 'f1-score': 0.25256784925631154, 'support': 151134}}
[[48381  2657  3319]
 [36675  2597  3065]
 [48273  2757  3410]]
testing model on single stock: results/universal/W8/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
10609/10609 - 151s - 151s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945586
{'0': {'precision': 0.3772653438349558, 'recall': 0.9547930788841865, 'f1-score': 0.5408326437532346, 'support': 1023361}, '1': {'precision': 0.2610522233712513, 'recall': 0.01790810512827713, 'f1-score': 0.033516956946878236, 'support': 676621}, '2': {'precision': 0.37418207950376337, 'recall': 0.02922024219749926, 'f1-score': 0.05420737760235686, 'support': 1015700}, 'accuracy': 0.37518899488231683, 'macro avg': {'precision': 0.33749988223665683, 'recall': 0.33397380873665433, 'f1-score': 0.2095189927674899, 'support': 2715682}, 'weighted avg': {'precision': 0.3471572864989112, 'recall': 0.37518899488231683, 'f1-score': 0.23242918187807754, 'support': 2715682}}
[[977098  17162  29101]
 [643967  12117  20537]
 [968884  17137  29679]]
Evaluating performance on  train set...
3903/3903 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005601
{'0': {'precision': 0.3311398053952391, 'recall': 0.954921989679333, 'f1-score': 0.4917534803398981, 'support': 330405}, '1': {'precision': 0.35040510970489086, 'recall': 0.017991400566007943, 'f1-score': 0.03422550710070964, 'support': 329324}, '2': {'precision': 0.3329699158461381, 'recall': 0.028800532808383482, 'f1-score': 0.05301544679062072, 'support': 339334}, 'accuracy': 0.33151963389696143, 'macro avg': {'precision': 0.33817161031542264, 'recall': 0.3339046410179081, 'f1-score': 0.1929981447437428, 'support': 999063}, 'weighted avg': {'precision': 0.3381118840091174, 'recall': 0.33151963389696143, 'f1-score': 0.19191886116629944, 'support': 999063}}
[[315511   5366   9528]
 [313349   5925  10050]
 [323943   5618   9773]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996821
{'0': {'precision': 0.3421534448596724, 'recall': 0.9542815457334439, 'f1-score': 0.5037055010206611, 'support': 100069}, '1': {'precision': 0.32745641838351824, 'recall': 0.01779792411387226, 'f1-score': 0.033760875781218086, 'support': 92876}, '2': {'precision': 0.3437794533459001, 'recall': 0.02927132653880106, 'f1-score': 0.053949119952669725, 'support': 99688}, 'accuracy': 0.34194708047281064, 'macro avg': {'precision': 0.3377964388630302, 'recall': 0.3337835987953724, 'f1-score': 0.197138498918183, 'support': 292633}, 'weighted avg': {'precision': 0.3380428097056596, 'recall': 0.34194708047281064, 'f1-score': 0.20134079461487492, 'support': 292633}}
[[95494  1677  2898]
 [88551  1653  2672]
 [95052  1718  2918]]
training model: results/universal/W8/deepVOL_L3/h1000
Epoch 1/50
7696/7696 - 457s - loss: 3.2693 - accuracy1000: 0.3812 - val_loss: 3.3435 - val_accuracy1000: 0.3096 - 457s/epoch - 59ms/step
Epoch 2/50
7696/7696 - 420s - loss: 3.2723 - accuracy1000: 0.3724 - val_loss: 3.2953 - val_accuracy1000: 0.3428 - 420s/epoch - 55ms/step
Epoch 3/50
7696/7696 - 423s - loss: 3.2740 - accuracy1000: 0.3694 - val_loss: 3.2960 - val_accuracy1000: 0.3444 - 423s/epoch - 55ms/step
Epoch 4/50
7696/7696 - 428s - loss: 3.2757 - accuracy1000: 0.3661 - val_loss: 3.2964 - val_accuracy1000: 0.3449 - 428s/epoch - 56ms/step
Epoch 5/50
7696/7696 - 426s - loss: 3.2700 - accuracy1000: 0.3708 - val_loss: 3.2968 - val_accuracy1000: 0.3441 - 426s/epoch - 55ms/step
Epoch 6/50
7696/7696 - 426s - loss: 3.2761 - accuracy1000: 0.3670 - val_loss: 3.3028 - val_accuracy1000: 0.3467 - 426s/epoch - 55ms/step
Epoch 7/50
7696/7696 - 426s - loss: 3.2622 - accuracy1000: 0.3801 - val_loss: 3.3064 - val_accuracy1000: 0.3415 - 426s/epoch - 55ms/step
Epoch 8/50
7696/7696 - 428s - loss: 3.2532 - accuracy1000: 0.3879 - val_loss: 3.3113 - val_accuracy1000: 0.3415 - 428s/epoch - 56ms/step
Epoch 9/50
7696/7696 - 425s - loss: 3.2388 - accuracy1000: 0.3963 - val_loss: 3.3234 - val_accuracy1000: 0.3398 - 425s/epoch - 55ms/step
Epoch 10/50
7696/7696 - 441s - loss: 3.2267 - accuracy1000: 0.4044 - val_loss: 3.3398 - val_accuracy1000: 0.3253 - 441s/epoch - 57ms/step
Epoch 11/50
7696/7696 - 422s - loss: 3.2166 - accuracy1000: 0.4102 - val_loss: 3.3459 - val_accuracy1000: 0.3169 - 422s/epoch - 55ms/step
Epoch 12/50
7696/7696 - 419s - loss: 3.2106 - accuracy1000: 0.4136 - val_loss: 3.3587 - val_accuracy1000: 0.3261 - 419s/epoch - 54ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 722s - 722s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986406
{'0': {'precision': 0.35027742247061816, 'recall': 0.8500597506040918, 'f1-score': 0.49612183154321954, 'support': 2087845}, '1': {'precision': 0.3110567775631881, 'recall': 0.09442734972144627, 'f1-score': 0.14487505251995758, 'support': 1840399}, '2': {'precision': 0.3549863172140775, 'recall': 0.05858296551819135, 'f1-score': 0.10056912855515328, 'support': 2032724}, 'accuracy': 0.3468664820881441, 'macro avg': {'precision': 0.3387735057492946, 'recall': 0.3343566886145765, 'f1-score': 0.24718867087277682, 'support': 5960968}, 'weighted avg': {'precision': 0.3397741363753924, 'recall': 0.3468664820881441, 'f1-score': 0.25279160506048276, 'support': 5960968}}
[[1774793  196983  116069]
 [1566309  173784  100306]
 [1725719  187922  119083]]
Evaluating performance on  train set...
7696/7696 - 240s - 240s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993898
{'0': {'precision': 0.32758273332981563, 'recall': 0.8455489400690577, 'f1-score': 0.4722184887386852, 'support': 646127}, '1': {'precision': 0.33553739800048127, 'recall': 0.09416407150520388, 'f1-score': 0.14705822427991186, 'support': 651533}, '2': {'precision': 0.33902311808055996, 'recall': 0.059984817361793334, 'f1-score': 0.10193401189849852, 'support': 671820}, 'accuracy': 0.32901171882933566, 'macro avg': {'precision': 0.33404774980361895, 'recall': 0.3332326096453516, 'f1-score': 0.2404035749723652, 'support': 1969480}, 'weighted avg': {'precision': 0.33411674526195906, 'recall': 0.32901171882933566, 'f1-score': 0.23834093739803075, 'support': 1969480}}
[[546332  60025  39770]
 [551383  61351  38799]
 [570053  61468  40299]]
Evaluating performance on  val set...
2338/2338 - 73s - 73s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098854
{'0': {'precision': 0.34510843960047743, 'recall': 0.853398769908884, 'f1-score': 0.4914699144125948, 'support': 206001}, '1': {'precision': 0.31325825580762745, 'recall': 0.09338407810658565, 'f1-score': 0.14387746177968608, 'support': 184978}, '2': {'precision': 0.3610701495681483, 'recall': 0.05801712757675253, 'f1-score': 0.099970836978711, 'support': 206801}, 'accuracy': 0.343057646625849, 'macro avg': {'precision': 0.33981228165875105, 'recall': 0.33493332519740737, 'f1-score': 0.2451060710569973, 'support': 597780}, 'weighted avg': {'precision': 0.34077459485055356, 'recall': 0.343057646625849, 'f1-score': 0.2484718927063905, 'support': 597780}}
[[175801  18704  11496]
 [157969  17274   9735]
 [175638  19165  11998]]
testing model out of sample: results/universal/W8/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 439s - 439s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988253
{'0': {'precision': 0.35198965088397, 'recall': 0.8243520922601507, 'f1-score': 0.4933318176477752, 'support': 1255580}, '1': {'precision': 0.3205128534011939, 'recall': 0.1130214062409541, 'f1-score': 0.1671139597576659, 'support': 1105472}, '2': {'precision': 0.3423131002931074, 'recall': 0.0779694234430892, 'f1-score': 0.12700958788199687, 'support': 1255210}, 'accuracy': 0.3478315453913461, 'macro avg': {'precision': 0.33827186819275706, 'recall': 0.3384476406480647, 'f1-score': 0.26248512176247935, 'support': 3616262}, 'weighted avg': {'precision': 0.3390086165081321, 'recall': 0.3478315453913461, 'f1-score': 0.2664577598992499, 'support': 3616262}}
[[1035040  132869   87671]
 [ 880167  124942  100363]
 [1025334  132008   97868]]
Evaluating performance on  train set...
4550/4550 - 160s - 160s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991482
{'0': {'precision': 0.3361025721867528, 'recall': 0.8155131350119085, 'f1-score': 0.4760200136490526, 'support': 392158}, '1': {'precision': 0.3255817661455551, 'recall': 0.10741404115083467, 'f1-score': 0.1615352972819036, 'support': 380211}, '2': {'precision': 0.32313709298191284, 'recall': 0.07191244110244983, 'f1-score': 0.11764386570376913, 'support': 391782}, 'accuracy': 0.33399790920593636, 'macro avg': {'precision': 0.3282738104380736, 'recall': 0.3316132057550643, 'f1-score': 0.25173305887824177, 'support': 1164151}, 'weighted avg': {'precision': 0.3283030963802978, 'recall': 0.33399790920593636, 'f1-score': 0.2527020141034875, 'support': 1164151}}
[[319810  42144  30204]
 [310560  40840  28811]
 [321155  42453  28174]]
Evaluating performance on  val set...
1570/1570 - 53s - 53s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098744
{'0': {'precision': 0.35695588039706433, 'recall': 0.8295936718464608, 'f1-score': 0.49914196831622903, 'support': 142348}, '1': {'precision': 0.301335913897281, 'recall': 0.10758405662762283, 'f1-score': 0.15855884946410165, 'support': 118670}, '2': {'precision': 0.3385781513812552, 'recall': 0.06731421633396421, 'f1-score': 0.11230131306150655, 'support': 140015}, 'accuracy': 0.349804130832126, 'macro avg': {'precision': 0.3322899818918668, 'recall': 0.3348306482693493, 'f1-score': 0.2566673769472791, 'support': 401033}, 'weighted avg': {'precision': 0.3340810068762373, 'recall': 0.349804130832126, 'f1-score': 0.26329979807170567, 'support': 401033}}
[[118091  14581   9676]
 [ 97167  12767   8736]
 [115570  15020   9425]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
645/645 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986557
{'0': {'precision': 0.36878953599000663, 'recall': 0.8384492181695095, 'f1-score': 0.5122620476762134, 'support': 60563}, '1': {'precision': 0.28234359934206793, 'recall': 0.10569675350871606, 'f1-score': 0.15381287850698308, 'support': 47097}, '2': {'precision': 0.3035825869610498, 'recall': 0.050904582285554625, 'f1-score': 0.08718930398109652, 'support': 57264}, 'accuracy': 0.355751740195484, 'macro avg': {'precision': 0.3182385740977081, 'recall': 0.3316835179879267, 'f1-score': 0.251088076721431, 'support': 164924}, 'weighted avg': {'precision': 0.32146255503209786, 'recall': 0.355751740195484, 'f1-score': 0.2623090625720417, 'support': 164924}}
[[50779  6158  3626]
 [39058  4978  3061]
 [47854  6495  2915]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996534
{'0': {'precision': 0.3214578123962736, 'recall': 0.7875420145288952, 'f1-score': 0.4565582915599416, 'support': 18446}, '1': {'precision': 0.33834886817576565, 'recall': 0.1325508607198748, 'f1-score': 0.19047976011994003, 'support': 19170}, '2': {'precision': 0.31955984729395914, 'recall': 0.07283242911249872, 'f1-score': 0.11862781876537036, 'support': 19538}, 'accuracy': 0.3235294117647059, 'macro avg': {'precision': 0.3264555092886661, 'recall': 0.33097510145375625, 'f1-score': 0.255221956815084, 'support': 57154}, 'weighted avg': {'precision': 0.3264744183577784, 'recall': 0.3235294117647059, 'f1-score': 0.2517920280409374, 'support': 57154}}
[[14527  2401  1518]
 [15117  2541  1512]
 [15547  2568  1423]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966718
{'0': {'precision': 0.40305539691604797, 'recall': 0.8114400689853406, 'f1-score': 0.5385862825527045, 'support': 6958}, '1': {'precision': 0.2675397567820393, 'recall': 0.1223006200555912, 'f1-score': 0.16786500366837856, 'support': 4677}, '2': {'precision': 0.3226397800183318, 'recall': 0.06283470189218136, 'f1-score': 0.1051845211414911, 'support': 5602}, 'accuracy': 0.381156813830713, 'macro avg': {'precision': 0.3310783112388063, 'recall': 0.33219179697770435, 'f1-score': 0.270545269120858, 'support': 17237}, 'weighted avg': {'precision': 0.3401503128081542, 'recall': 0.381156813830713, 'f1-score': 0.29714171048287735, 'support': 17237}}
[[5646  899  413]
 [3779  572  326]
 [4583  667  352]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974742
{'0': {'precision': 0.38302536669827947, 'recall': 0.8694491867249499, 'f1-score': 0.5317810132918718, 'support': 213212}, '1': {'precision': 0.27429747628423123, 'recall': 0.09893479664299548, 'f1-score': 0.14541917730227263, 'support': 154900}, '2': {'precision': 0.3582464164203246, 'recall': 0.03386443680536516, 'f1-score': 0.06187950692929088, 'support': 189668}, 'accuracy': 0.3713381619993546, 'macro avg': {'precision': 0.3385230864676118, 'recall': 0.3340828067244368, 'f1-score': 0.24635989917447843, 'support': 557780}, 'weighted avg': {'precision': 0.3444048995491253, 'recall': 0.3713381619993546, 'f1-score': 0.2646994985305557, 'support': 557780}}
[[185377  21265   6570]
 [134639  15325   4936]
 [163965  19280   6423]]
Evaluating performance on  train set...
614/614 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986705
{'0': {'precision': 0.33685120181093753, 'recall': 0.8333554063002554, 'f1-score': 0.4797730045311956, 'support': 52855}, '1': {'precision': 0.33935218623256846, 'recall': 0.11629412436693196, 'f1-score': 0.17322499680946102, 'support': 52522}, '2': {'precision': 0.3499459589287859, 'recall': 0.05635273641462, 'f1-score': 0.09707347135932842, 'support': 51710}, 'accuracy': 0.3378319020670075, 'macro avg': {'precision': 0.34204978232409733, 'recall': 0.33533408902726913, 'f1-score': 0.25002382423332836, 'support': 157087}, 'weighted avg': {'precision': 0.3419979459358927, 'recall': 0.3378319020670075, 'f1-score': 0.25130147396610625, 'support': 157087}}
[[44047  6030  2778]
 [43779  6108  2635]
 [42935  5861  2914]]
Evaluating performance on  val set...
190/190 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981672
{'0': {'precision': 0.353774162726315, 'recall': 0.8459780889331536, 'f1-score': 0.4989116539405038, 'support': 17069}, '1': {'precision': 0.3118546055349029, 'recall': 0.09736909981944802, 'f1-score': 0.1484029484029484, 'support': 15508}, '2': {'precision': 0.37366425370561873, 'recall': 0.06782206093974848, 'f1-score': 0.11480618513026901, 'support': 15983}, 'accuracy': 0.3507825370675453, 'macro avg': {'precision': 0.3464310073222789, 'recall': 0.3370564165641167, 'f1-score': 0.2540402624912404, 'support': 48560}, 'weighted avg': {'precision': 0.34693344672956444, 'recall': 0.3507825370675453, 'f1-score': 0.2605499011919372, 'support': 48560}}
[[14440  1680   949]
 [13130  1510   868]
 [13247  1652  1084]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
1162/1162 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099556
{'0': {'precision': 0.2576078668264327, 'recall': 0.7140876773998738, 'f1-score': 0.37862600975183763, 'support': 72858}, '1': {'precision': 0.5066919720982969, 'recall': 0.1401543559185677, 'f1-score': 0.21957328633608372, 'support': 146674}, '2': {'precision': 0.30351356271618424, 'recall': 0.21393283802337965, 'f1-score': 0.25096905788756674, 'support': 77931}, 'accuracy': 0.30005748614113353, 'macro avg': {'precision': 0.3559378005469713, 'recall': 0.3560582904472737, 'f1-score': 0.28305611799182934, 'support': 297463}, 'weighted avg': {'precision': 0.39245367569351747, 'recall': 0.30005748614113353, 'f1-score': 0.2667555146986149, 'support': 297463}}
[[52027  9578 11253]
 [99112 20557 27005]
 [50823 10436 16672]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982867
{'0': {'precision': 0.35993824900927857, 'recall': 0.7572236916998695, 'f1-score': 0.48793959007551246, 'support': 29867}, '1': {'precision': 0.315927145901957, 'recall': 0.12037207928832454, 'f1-score': 0.17432443268382647, 'support': 27091}, '2': {'precision': 0.30133307758703365, 'recall': 0.11801382211538461, 'f1-score': 0.16960405926965533, 'support': 26624}, 'accuracy': 0.34719197913426336, 'macro avg': {'precision': 0.32573282416608973, 'recall': 0.33186986436785954, 'f1-score': 0.2772893606763314, 'support': 83582}, 'weighted avg': {'precision': 0.32700521464510574, 'recall': 0.34719197913426336, 'f1-score': 0.2848873371852573, 'support': 83582}}
[[22616  3702  3549]
 [20094  3261  3736]
 [20123  3359  3142]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990579
{'0': {'precision': 0.30708208311069096, 'recall': 0.7704444673610394, 'f1-score': 0.439134779286428, 'support': 9697}, '1': {'precision': 0.3976843694940851, 'recall': 0.12432134707687466, 'f1-score': 0.18942572832993645, 'support': 12709}, '2': {'precision': 0.28022922636103154, 'recall': 0.10419774131685489, 'f1-score': 0.15191053122087605, 'support': 9386}, 'accuracy': 0.3154567186713639, 'macro avg': {'precision': 0.32833189298860255, 'recall': 0.33298785191825636, 'f1-score': 0.26015701294574683, 'support': 31792}, 'weighted avg': {'precision': 0.33537295956370594, 'recall': 0.3154567186713639, 'f1-score': 0.2545147767402113, 'support': 31792}}
[[7471 1213 1013]
 [9630 1580 1499]
 [7228 1180  978]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1223/1223 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996587
{'0': {'precision': 0.31342250922509224, 'recall': 0.9407429275294453, 'f1-score': 0.47019316629396996, 'support': 98233}, '1': {'precision': 0.35224274406332456, 'recall': 0.05276679841897233, 'f1-score': 0.09178411825369542, 'support': 111320}, '2': {'precision': 0.3214049039098741, 'recall': 0.00468689601855431, 'f1-score': 0.009239063139947995, 'support': 103480}, 'accuracy': 0.3155290336801551, 'macro avg': {'precision': 0.32902338573276363, 'recall': 0.332732207322324, 'f1-score': 0.19040544922920447, 'support': 313033}, 'weighted avg': {'precision': 0.329866420072106, 'recall': 0.3155290336801551, 'f1-score': 0.18324570125922426, 'support': 313033}}
[[ 92412   5285    536]
 [104958   5874    488]
 [ 97478   5517    485]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995497
{'0': {'precision': 0.32682536368065707, 'recall': 0.9439455873483884, 'f1-score': 0.48554046601406314, 'support': 29846}, '1': {'precision': 0.3393387028401865, 'recall': 0.05301675607656136, 'f1-score': 0.09170580822545538, 'support': 30198}, '2': {'precision': 0.312625250501002, 'recall': 0.00497211155378486, 'f1-score': 0.009788542385643471, 'support': 31375}, 'accuracy': 0.32739364902263207, 'macro avg': {'precision': 0.3262631056739485, 'recall': 0.33397815165957817, 'f1-score': 0.19567827220838732, 'support': 91419}, 'weighted avg': {'precision': 0.3260853562962817, 'recall': 0.32739364902263207, 'f1-score': 0.19216889555560215, 'support': 91419}}
[[28173  1529   144]
 [28398  1601   199]
 [29631  1588   156]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985951
{'0': {'precision': 0.3228343145500421, 'recall': 0.9448615384615384, 'f1-score': 0.48124118476727784, 'support': 8125}, '1': {'precision': 0.40044411547002223, 'recall': 0.05770051194539249, 'f1-score': 0.10086697119418289, 'support': 9376}, '2': {'precision': 0.3228346456692913, 'recall': 0.005285548536805466, 'f1-score': 0.010400811770674784, 'support': 7757}, 'accuracy': 0.3269855095415314, 'macro avg': {'precision': 0.3487043585631186, 'recall': 0.3359491996479121, 'f1-score': 0.19750298924404516, 'support': 25258}, 'weighted avg': {'precision': 0.35164388228769944, 'recall': 0.3269855095415314, 'f1-score': 0.19544272884060163, 'support': 25258}}
[[7677  417   31]
 [8780  541   55]
 [7323  393   41]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993873
{'0': {'precision': 0.3414303218258721, 'recall': 0.790758821926154, 'f1-score': 0.4769327467001885, 'support': 124746}, '1': {'precision': 0.2990086215599572, 'recall': 0.134463471770752, 'f1-score': 0.18550553986258383, 'support': 110134}, '2': {'precision': 0.3699993495088792, 'recall': 0.08470146753333781, 'f1-score': 0.13784663108213727, 'support': 134307}, 'accuracy': 0.3381186228117458, 'macro avg': {'precision': 0.33681276429823614, 'recall': 0.33664125374341464, 'f1-score': 0.2667616392149698, 'support': 369187}, 'weighted avg': {'precision': 0.3391684568737892, 'recall': 0.3381186228117458, 'f1-score': 0.2666390935429366, 'support': 369187}}
[[ 98644  17282   8820]
 [ 84775  14809  10550]
 [105495  17436  11376]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000862
{'0': {'precision': 0.3235249353153062, 'recall': 0.7889787939524411, 'f1-score': 0.4588826204593864, 'support': 40413}, '1': {'precision': 0.338276880537925, 'recall': 0.13028850808403525, 'f1-score': 0.1881214069789792, 'support': 41316}, '2': {'precision': 0.31393775372124494, 'recall': 0.08329780311020353, 'f1-score': 0.13166155319488534, 'support': 44563}, 'accuracy': 0.32448611155100876, 'macro avg': {'precision': 0.32524652319149205, 'recall': 0.33418836838222665, 'f1-score': 0.259555193544417, 'support': 126292}, 'weighted avg': {'precision': 0.32496808132171645, 'recall': 0.32448611155100876, 'f1-score': 0.2548418045988056, 'support': 126292}}
[[31885  5042  3486]
 [31307  5383  4626]
 [35363  5488  3712]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000817
{'0': {'precision': 0.33100728155339804, 'recall': 0.7789765965886553, 'f1-score': 0.46459580307080833, 'support': 12605}, '1': {'precision': 0.31627811017123997, 'recall': 0.13101444320998204, 'f1-score': 0.18527918781725888, 'support': 11701}, '2': {'precision': 0.32471817431949407, 'recall': 0.08532004045658143, 'f1-score': 0.13513358887808227, 'support': 13842}, 'accuracy': 0.32853622732515464, 'macro avg': {'precision': 0.32400118868137734, 'recall': 0.33177036008507294, 'f1-score': 0.2616695265887165, 'support': 38148}, 'weighted avg': {'precision': 0.32420745307813514, 'recall': 0.32853622732515464, 'f1-score': 0.25937666487385186, 'support': 38148}}
[[ 9819  1534  1252]
 [ 8964  1533  1204]
 [10881  1780  1181]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
5521/5521 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.09924
{'0': {'precision': 0.31678782819601875, 'recall': 0.8569596507839137, 'f1-score': 0.4625771581795169, 'support': 449922}, '1': {'precision': 0.36671892193364586, 'recall': 0.09434587865743703, 'f1-score': 0.15008050437067788, 'support': 515730}, '2': {'precision': 0.3723866498740554, 'recall': 0.052839444397285426, 'f1-score': 0.09254701884666398, 'support': 447658}, 'accuracy': 0.323974216555462, 'macro avg': {'precision': 0.35196446666790665, 'recall': 0.33471499127954535, 'f1-score': 0.23506822713228623, 'support': 1413310}, 'weighted avg': {'precision': 0.3526187642879257, 'recall': 0.323974216555462, 'f1-score': 0.23133924761332914, 'support': 1413310}}
[[385565  43542  20815]
 [448022  48657  19051]
 [383521  40483  23654]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995352
{'0': {'precision': 0.3258958878647174, 'recall': 0.8304255319148937, 'f1-score': 0.4680917630679463, 'support': 108100}, '1': {'precision': 0.32982478058531406, 'recall': 0.09665903890160184, 'f1-score': 0.14950413047633204, 'support': 109250}, '2': {'precision': 0.33728661275831084, 'recall': 0.06680904075458266, 'f1-score': 0.11152703505644682, 'support': 112380}, 'accuracy': 0.3270463712734662, 'macro avg': {'precision': 0.33100242706944744, 'recall': 0.3312978705236927, 'f1-score': 0.2430409762002417, 'support': 329730}, 'weighted avg': {'precision': 0.33107989051314857, 'recall': 0.3270463712734662, 'f1-score': 0.2410076548746786, 'support': 329730}}
[[89769 10453  7878]
 [91816 10560  6874]
 [93868 11004  7508]]
Evaluating performance on  val set...
438/438 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985326
{'0': {'precision': 0.3897369376848441, 'recall': 0.8613398160677017, 'f1-score': 0.5366512345679012, 'support': 43603}, '1': {'precision': 0.22551757342320655, 'recall': 0.08869532285551979, 'f1-score': 0.12731720576243544, 'support': 26405}, '2': {'precision': 0.4037721324095458, 'recall': 0.05002622919547904, 'f1-score': 0.08902278609920651, 'support': 41938}, 'accuracy': 0.3751540921515731, 'macro avg': {'precision': 0.3396755478391988, 'recall': 0.33335378937290017, 'f1-score': 0.2509970754765144, 'support': 111946}, 'weighted avg': {'precision': 0.35626004420974006, 'recall': 0.3751540921515731, 'f1-score': 0.2724068050886126, 'support': 111946}}
[[37557  3985  2061]
 [23026  2342  1037]
 [35782  4058  2098]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
5918/5918 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981902
{'0': {'precision': 0.387299872458549, 'recall': 0.8758928904709711, 'f1-score': 0.5371044146580255, 'support': 589378}, '1': {'precision': 0.2394993179044109, 'recall': 0.08100341595298613, 'f1-score': 0.12106145014849899, 'support': 370614}, '2': {'precision': 0.3768565337655702, 'recall': 0.0385394294939245, 'f1-score': 0.06992766948633077, 'support': 555016}, 'accuracy': 0.3746798696772558, 'macro avg': {'precision': 0.3345519080428434, 'recall': 0.3318119119726272, 'f1-score': 0.2426978447642851, 'support': 1515008}, 'weighted avg': {'precision': 0.34731778999195506, 'recall': 0.3746798696772558, 'f1-score': 0.26418049897774726, 'support': 1515008}}
[[516232  50216  22930]
 [328154  30021  12439]
 [488514  45112  21390]]
Evaluating performance on  train set...
1814/1814 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990491
{'0': {'precision': 0.3315253739021791, 'recall': 0.8779258355823126, 'f1-score': 0.48130042554402236, 'support': 154144}, '1': {'precision': 0.323779487826416, 'recall': 0.08344984100766675, 'f1-score': 0.13269843239442444, 'support': 153781}, '2': {'precision': 0.3833667700164144, 'recall': 0.04033155531678115, 'f1-score': 0.07298484401312477, 'support': 156354}, 'accuracy': 0.3327008113655798, 'macro avg': {'precision': 0.34622387724833653, 'recall': 0.33390241063558684, 'f1-score': 0.2289945673171905, 'support': 464279}, 'weighted avg': {'precision': 0.3464182282880725, 'recall': 0.3327008113655798, 'f1-score': 0.22832724014640526, 'support': 464279}}
[[135327  13221   5596]
 [136401  12833   4547]
 [136467  13581   6306]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983617
{'0': {'precision': 0.37162048933080105, 'recall': 0.8815384105740882, 'f1-score': 0.5228351097794588, 'support': 60374}, '1': {'precision': 0.27882227740333454, 'recall': 0.08868329008236489, 'f1-score': 0.13456599897277866, 'support': 44315}, '2': {'precision': 0.393457771206801, 'recall': 0.03668602346940534, 'f1-score': 0.06711430552928567, 'support': 58033}, 'accuracy': 0.3643084524526493, 'macro avg': {'precision': 0.3479668459803122, 'recall': 0.3356359080419528, 'f1-score': 0.24150513809384103, 'support': 162722}, 'weighted avg': {'precision': 0.35413625374829977, 'recall': 0.3643084524526493, 'f1-score': 0.25456781292686154, 'support': 162722}}
[[53222  5108  2044]
 [39147  3930  1238]
 [50847  5057  2129]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
3755/3755 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982677
{'0': {'precision': 0.33447585488908466, 'recall': 0.7774058551445793, 'f1-score': 0.4677178977741983, 'support': 322349}, '1': {'precision': 0.3510948719900535, 'recall': 0.12060174492081616, 'f1-score': 0.1795334232925057, 'support': 344199}, '2': {'precision': 0.33340091772489594, 'recall': 0.10604687473482341, 'f1-score': 0.1609116075452263, 'support': 294615}, 'accuracy': 0.3364153634711282, 'macro avg': {'precision': 0.3396572148680114, 'recall': 0.33468482493340623, 'f1-score': 0.26938764287064343, 'support': 961163}, 'weighted avg': {'precision': 0.3400977488389235, 'recall': 0.3364153634711282, 'f1-score': 0.27047503352751723, 'support': 961163}}
[[250596  40274  31479]
 [271700  41511  30988]
 [226924  36448  31243]]
Evaluating performance on  train set...
1532/1532 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990515
{'0': {'precision': 0.3326339401042159, 'recall': 0.8089302268565693, 'f1-score': 0.47141922708571, 'support': 130523}, '1': {'precision': 0.3297053419846973, 'recall': 0.11017680202059452, 'f1-score': 0.1651618765800296, 'support': 128675}, '2': {'precision': 0.3516874449061831, 'recall': 0.08400321845649444, 'f1-score': 0.13561400207591034, 'support': 132983}, 'accuracy': 0.3338560511600511, 'macro avg': {'precision': 0.3380089089983654, 'recall': 0.3343700824445528, 'f1-score': 0.25739836858055, 'support': 392181}, 'weighted avg': {'precision': 0.33813383649402295, 'recall': 0.3338560511600511, 'f1-score': 0.25706909076141937, 'support': 392181}}
[[105584  14334  10605]
 [104510  14177   9988]
 [107324  14488  11171]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992007
{'0': {'precision': 0.3179701517304322, 'recall': 0.8039806996381182, 'f1-score': 0.45570956114599986, 'support': 38134}, '1': {'precision': 0.3493429647275801, 'recall': 0.11229404935404985, 'f1-score': 0.1699566322715717, 'support': 40483}, '2': {'precision': 0.3721982108754649, 'recall': 0.09083550017171171, 'f1-score': 0.146031746031746, 'support': 40766}, 'accuracy': 0.3259090490270809, 'macro avg': {'precision': 0.34650377577782576, 'recall': 0.3357034163879599, 'f1-score': 0.25723264648310584, 'support': 119383}, 'weighted avg': {'precision': 0.3471261173844193, 'recall': 0.3259090490270809, 'f1-score': 0.2530637771518705, 'support': 119383}}
[[30659  4206  3269]
 [32960  4546  2977]
 [32802  4261  3703]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
4960/4960 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992801
{'0': {'precision': 0.32411314155988913, 'recall': 0.7767642481649858, 'f1-score': 0.45737972834027807, 'support': 408035}, '1': {'precision': 0.3501880855868714, 'recall': 0.12809749555055888, 'f1-score': 0.18757921419518378, 'support': 430953}, '2': {'precision': 0.33813148066701953, 'recall': 0.1053188821710178, 'f1-score': 0.1606115703357228, 'support': 430692}, 'accuracy': 0.32883167412261355, 'macro avg': {'precision': 0.33747756927126, 'recall': 0.3367268752955208, 'f1-score': 0.2685235042903949, 'support': 1269680}, 'weighted avg': {'precision': 0.3377186656761927, 'recall': 0.32883167412261355, 'f1-score': 0.265136791159517, 'support': 1269680}}
[[316947  49780  41308]
 [328268  55204  47481]
 [332675  52657  45360]]
Evaluating performance on  train set...
1691/1691 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099003
{'0': {'precision': 0.34332153585343367, 'recall': 0.7732369647928835, 'f1-score': 0.4755127513295078, 'support': 149288}, '1': {'precision': 0.3249957038932274, 'recall': 0.12258287541500724, 'f1-score': 0.17801972535115518, 'support': 138853}, '2': {'precision': 0.3098031237991908, 'recall': 0.09471814682487578, 'f1-score': 0.14508002371072912, 'support': 144703}, 'accuracy': 0.3376782397353319, 'macro avg': {'precision': 0.3260401211819506, 'recall': 0.3301793290109222, 'f1-score': 0.2662041667971307, 'support': 432844}, 'weighted avg': {'precision': 0.3262372941297281, 'recall': 0.3376782397353319, 'f1-score': 0.2696131521187244, 'support': 432844}}
[[115435  17684  16169]
 [107466  17021  14366]
 [113329  17668  13706]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989032
{'0': {'precision': 0.3496572562083079, 'recall': 0.7925029403953409, 'f1-score': 0.4852286124129601, 'support': 52714}, '1': {'precision': 0.3057912419566084, 'recall': 0.11862684457011576, 'f1-score': 0.17094017094017094, 'support': 45268}, '2': {'precision': 0.33874858115777523, 'recall': 0.08983669476219146, 'f1-score': 0.14201165833928148, 'support': 53152}, 'accuracy': 0.3435428163087062, 'macro avg': {'precision': 0.3313990264408972, 'recall': 0.33365549324254934, 'f1-score': 0.2660601472308042, 'support': 151134}, 'weighted avg': {'precision': 0.33268195859538263, 'recall': 0.3435428163087062, 'f1-score': 0.27038697048252497, 'support': 151134}}
[[41776  5987  4951]
 [35528  5370  4370]
 [42173  6204  4775]]
testing model on single stock: results/universal/W8/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
10609/10609 - 150s - 150s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985732
{'0': {'precision': 0.37109763908080257, 'recall': 0.8574794672796026, 'f1-score': 0.5180116155841468, 'support': 1004129}, '1': {'precision': 0.2673026293583556, 'recall': 0.08870143507175358, 'f1-score': 0.13320143892454897, 'support': 714250}, '2': {'precision': 0.3597824166393215, 'recall': 0.05716818258844102, 'f1-score': 0.09865968258417973, 'support': 997303}, 'accuracy': 0.36137846772928495, 'macro avg': {'precision': 0.3327275616928265, 'recall': 0.3344496949799323, 'f1-score': 0.2499575790309585, 'support': 2715682}, 'weighted avg': {'precision': 0.3396431863942162, 'recall': 0.36137846772928495, 'f1-score': 0.2628007295099364, 'support': 2715682}}
[[861020  86921  56188]
 [605629  63355  45266]
 [853549  86740  57014]]
Evaluating performance on  train set...
3903/3903 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995835
{'0': {'precision': 0.3250709370209713, 'recall': 0.8592162018207959, 'f1-score': 0.47168664873393384, 'support': 324803}, '1': {'precision': 0.3376292610454079, 'recall': 0.08653683421580716, 'f1-score': 0.13776380392449308, 'support': 330888}, '2': {'precision': 0.3328131166361712, 'recall': 0.05403177894528383, 'f1-score': 0.09296999884745864, 'support': 343372}, 'accuracy': 0.3265689951484541, 'macro avg': {'precision': 0.33183777156751676, 'recall': 0.33326160499396235, 'f1-score': 0.23414015050196182, 'support': 999063}, 'weighted avg': {'precision': 0.33189117400165036, 'recall': 0.3265689951484541, 'f1-score': 0.23092930332315897, 'support': 999063}}
[[279076  27589  18138]
 [283199  28634  19055]
 [296233  28586  18553]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990005
{'0': {'precision': 0.33852408349579194, 'recall': 0.8623599475118603, 'f1-score': 0.4861911780606757, 'support': 99070}, '1': {'precision': 0.3212749003984064, 'recall': 0.08651803531961462, 'f1-score': 0.13632444677362096, 'support': 93206}, '2': {'precision': 0.3390937273266935, 'recall': 0.0512271191845113, 'f1-score': 0.08900777368029227, 'support': 100357}, 'accuracy': 0.33707408255391563, 'macro avg': {'precision': 0.3329642370736306, 'recall': 0.3333683673386621, 'f1-score': 0.23717446617152962, 'support': 292633}, 'weighted avg': {'precision': 0.33322543428727097, 'recall': 0.33707408255391563, 'f1-score': 0.2385437375131525, 'support': 292633}}
[[85434  8442  5194]
 [80316  8064  4826]
 [86622  8594  5141]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        66 (peak)  18.21 (ave)

============================================
