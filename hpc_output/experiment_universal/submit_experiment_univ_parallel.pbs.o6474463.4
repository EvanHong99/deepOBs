This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W1/deepLOB_L1/h50
Epoch 1/50
10622/10622 - 179s - loss: 3.0799 - accuracy50: 0.4605 - val_loss: 3.6727 - val_accuracy50: 0.3720 - 179s/epoch - 17ms/step
Epoch 2/50
10622/10622 - 161s - loss: 3.0118 - accuracy50: 0.4839 - val_loss: 3.6592 - val_accuracy50: 0.3787 - 161s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 159s - loss: 2.9783 - accuracy50: 0.4921 - val_loss: 3.6535 - val_accuracy50: 0.3819 - 159s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 159s - loss: 2.9625 - accuracy50: 0.4960 - val_loss: 3.6747 - val_accuracy50: 0.3801 - 159s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 160s - loss: 2.9524 - accuracy50: 0.4985 - val_loss: 3.6444 - val_accuracy50: 0.3845 - 160s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 160s - loss: 2.9452 - accuracy50: 0.5006 - val_loss: 3.6278 - val_accuracy50: 0.3841 - 160s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 160s - loss: 2.9388 - accuracy50: 0.5022 - val_loss: 3.6273 - val_accuracy50: 0.3868 - 160s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 161s - loss: 2.9338 - accuracy50: 0.5034 - val_loss: 3.6075 - val_accuracy50: 0.3885 - 161s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 159s - loss: 2.9293 - accuracy50: 0.5045 - val_loss: 3.6314 - val_accuracy50: 0.3876 - 159s/epoch - 15ms/step
Epoch 10/50
10622/10622 - 160s - loss: 2.9256 - accuracy50: 0.5056 - val_loss: 3.6216 - val_accuracy50: 0.3878 - 160s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 160s - loss: 2.9218 - accuracy50: 0.5063 - val_loss: 3.6464 - val_accuracy50: 0.3833 - 160s/epoch - 15ms/step
Epoch 12/50
10622/10622 - 159s - loss: 2.9191 - accuracy50: 0.5070 - val_loss: 3.6540 - val_accuracy50: 0.3855 - 159s/epoch - 15ms/step
Epoch 13/50
10622/10622 - 160s - loss: 2.9162 - accuracy50: 0.5076 - val_loss: 3.6715 - val_accuracy50: 0.3858 - 160s/epoch - 15ms/step
Epoch 14/50
10622/10622 - 161s - loss: 2.9138 - accuracy50: 0.5082 - val_loss: 3.6249 - val_accuracy50: 0.3877 - 161s/epoch - 15ms/step
Epoch 15/50
10622/10622 - 169s - loss: 2.9113 - accuracy50: 0.5090 - val_loss: 3.6686 - val_accuracy50: 0.3853 - 169s/epoch - 16ms/step
Epoch 16/50
10622/10622 - 165s - loss: 2.9094 - accuracy50: 0.5097 - val_loss: 3.6250 - val_accuracy50: 0.3878 - 165s/epoch - 16ms/step
Epoch 17/50
10622/10622 - 171s - loss: 2.9073 - accuracy50: 0.5099 - val_loss: 3.6667 - val_accuracy50: 0.3843 - 171s/epoch - 16ms/step
Epoch 18/50
10622/10622 - 167s - loss: 2.9057 - accuracy50: 0.5103 - val_loss: 3.6738 - val_accuracy50: 0.3849 - 167s/epoch - 16ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 218s - 218s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2544743
{'0': {'precision': 0.5016055440833639, 'recall': 0.10956506621993235, 'f1-score': 0.17984649041453607, 'support': 3163700}, '1': {'precision': 0.3075072516738975, 'recall': 0.9177167595786224, 'f1-score': 0.46065789759475173, 'support': 2715474}, '2': {'precision': 0.570636392886509, 'recall': 0.045351585597582025, 'f1-score': 0.08402522815713144, 'support': 3167607}, 'accuracy': 0.3296557084779658, 'macro avg': {'precision': 0.4599163962145901, 'recall': 0.35754447046537896, 'f1-score': 0.24150987205547306, 'support': 9046781}, 'weighted avg': {'precision': 0.46751537802346704, 'recall': 0.3296557084779658, 'f1-score': 0.2305840924440202, 'support': 9046781}}
[[ 346631 2759567   57502]
 [ 172849 2492036   50589]
 [ 171563 2852388  143656]]
Evaluating performance on  train set...
10622/10622 - 69s - 69s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1247472
{'0': {'precision': 0.49482081099957087, 'recall': 0.13892957719858626, 'f1-score': 0.21694738919745518, 'support': 846544}, '1': {'precision': 0.3934089309841325, 'recall': 0.9038254906143762, 'f1-score': 0.5482016421066876, 'support': 1021882}, '2': {'precision': 0.5374042361424065, 'recall': 0.08416775674988942, 'f1-score': 0.14554101388487717, 'support': 850088}, 'accuracy': 0.40932766945470944, 'macro avg': {'precision': 0.4752113260420366, 'recall': 0.3756409415209507, 'f1-score': 0.30356334839633997, 'support': 2718514}, 'weighted avg': {'precision': 0.47001633470807, 'recall': 0.40932766945470944, 'f1-score': 0.3191359582814009, 'support': 2718514}}
[[117610 699755  29179]
 [ 65868 923603  32411]
 [ 54204 724334  71550]]
Evaluating performance on  val set...
3064/3064 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1619297
{'0': {'precision': 0.49841822447589496, 'recall': 0.13031244434770564, 'f1-score': 0.20660705882352942, 'support': 252685}, '1': {'precision': 0.37078483121846634, 'recall': 0.9124827499686363, 'f1-score': 0.52730197099486, 'support': 278985}, '2': {'precision': 0.5374217370364425, 'recall': 0.06639218112872261, 'f1-score': 0.1181840969027689, 'support': 252108}, 'accuracy': 0.38816476093996005, 'macro avg': {'precision': 0.46887493091026794, 'recall': 0.36972912514835493, 'f1-score': 0.2840310422403861, 'support': 783778}, 'weighted avg': {'precision': 0.4655330137742559, 'recall': 0.38816476093996005, 'f1-score': 0.29231619328277625, 'support': 783778}}
[[ 32928 212592   7165]
 [ 17174 254569   7242]
 [ 15963 219407  16738]]
testing model out of sample: results/universal/W1/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 145s - 145s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0531898
{'0': {'precision': 0.5562116100413801, 'recall': 0.16277432805285125, 'f1-score': 0.2518462915134628, 'support': 1824139}, '1': {'precision': 0.4359573655829031, 'recall': 0.9263045100769963, 'f1-score': 0.5928805337007736, 'support': 2469337}, '2': {'precision': 0.6183329253212311, 'recall': 0.10910440156834947, 'f1-score': 0.18548084156099456, 'support': 1805720}, 'accuracy': 0.45600977571470075, 'macro avg': {'precision': 0.5368339669818382, 'recall': 0.39939441323273234, 'f1-score': 0.3434025555917437, 'support': 6099196}, 'weighted avg': {'precision': 0.5259167066112838, 'recall': 0.45600977571470075, 'f1-score': 0.3702702693970915, 'support': 6099196}}
[[ 296923 1468690   58526]
 [ 118899 2287358   63080]
 [ 118009 1490699  197012]]
Evaluating performance on  train set...
6711/6711 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0534534
{'0': {'precision': 0.5387241173321748, 'recall': 0.1386654046379555, 'f1-score': 0.2205596493456994, 'support': 500781}, '1': {'precision': 0.4467661837286208, 'recall': 0.9341586701432344, 'f1-score': 0.6044507098075953, 'support': 718333}, '2': {'precision': 0.5932841003796648, 'recall': 0.10288780401634803, 'f1-score': 0.1753638659084844, 'support': 498164}, 'accuracy': 0.46103950554307455, 'macro avg': {'precision': 0.5262581338134869, 'recall': 0.39190395959917934, 'f1-score': 0.33345807502059305, 'support': 1717278}, 'weighted avg': {'precision': 0.5160856167956445, 'recall': 0.46103950554307455, 'f1-score': 0.36802948525727475, 'support': 1717278}}
[[ 69441 415022  16318]
 [ 28477 671037  18819]
 [ 30981 415928  51255]]
Evaluating performance on  val set...
1720/1720 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0031301
{'0': {'precision': 0.56088531821046, 'recall': 0.11786515273145581, 'f1-score': 0.19479569157120874, 'support': 120833}, '1': {'precision': 0.48444122947282925, 'recall': 0.9535573863040253, 'f1-score': 0.6424797736602312, 'support': 200161}, '2': {'precision': 0.611108397244883, 'recall': 0.10525075930303973, 'f1-score': 0.17957367401133997, 'support': 118859}, 'accuracy': 0.49474938217995557, 'macro avg': {'precision': 0.5521449816427241, 'recall': 0.392224432779507, 'f1-score': 0.3389497130809267, 'support': 439853}, 'weighted avg': {'precision': 0.5396699114839845, 'recall': 0.49474938217995557, 'f1-score': 0.3944069702708479, 'support': 439853}}
[[ 14242 102620   3971]
 [  5306 190865   3990]
 [  5844 100505  12510]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3010534
{'0': {'precision': 0.3642523716307785, 'recall': 0.03986617884571014, 'f1-score': 0.07186678352322524, 'support': 60678}, '1': {'precision': 0.2862047091309377, 'recall': 0.9499236263055774, 'f1-score': 0.4398776524565092, 'support': 48446}, '2': {'precision': 0.5033288948069241, 'recall': 0.01872399445214979, 'f1-score': 0.036104876068580156, 'support': 60564}, 'accuracy': 0.2921420489368724, 'macro avg': {'precision': 0.3845953251895468, 'recall': 0.3361712665344791, 'f1-score': 0.18261643734943822, 'support': 169688}, 'weighted avg': {'precision': 0.3916080685107747, 'recall': 0.2921420489368724, 'f1-score': 0.16417013080328485, 'support': 169688}}
[[ 2419 57728   531]
 [ 1838 46020   588]
 [ 2384 57046  1134]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2415322
{'0': {'precision': 0.4551027767760548, 'recall': 0.057889908256880736, 'f1-score': 0.10271436129084767, 'support': 21800}, '1': {'precision': 0.3344908703931892, 'recall': 0.9512583625358394, 'f1-score': 0.49494447207028014, 'support': 21973}, '2': {'precision': 0.48691514670896113, 'recall': 0.02698901098901099, 'f1-score': 0.05114322602140685, 'support': 22750}, 'accuracy': 0.3424078890007967, 'macro avg': {'precision': 0.42550293129273503, 'recall': 0.3453790939272437, 'f1-score': 0.21626735312751155, 'support': 66523}, 'weighted avg': {'precision': 0.4261432589705276, 'recall': 0.3424078890007967, 'f1-score': 0.2146339815241007, 'support': 66523}}
[[ 1262 20213   325]
 [  749 20902   322]
 [  762 21374   614]]
Evaluating performance on  val set...
51/51 - 0s - 447ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1996074
{'0': {'precision': 0.49814126394052044, 'recall': 0.03277084861824407, 'f1-score': 0.061496099128040396, 'support': 4089}, '1': {'precision': 0.3826804454057518, 'recall': 0.9805008210180624, 'f1-score': 0.5505041774704696, 'support': 4872}, '2': {'precision': 0.49473684210526314, 'recall': 0.012094698919197119, 'f1-score': 0.02361215774930922, 'support': 3886}, 'accuracy': 0.3859266754884409, 'macro avg': {'precision': 0.4585195171505118, 'recall': 0.34178878951850117, 'f1-score': 0.2118708114492731, 'support': 12847}, 'weighted avg': {'precision': 0.4533249884557223, 'recall': 0.3859266754884409, 'f1-score': 0.2354846070665915, 'support': 12847}}
[[ 134 3924   31]
 [  78 4777   17]
 [  57 3782   47]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
1645/1645 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82095414
{'0': {'precision': 0.4516428679440928, 'recall': 0.2839969028892783, 'f1-score': 0.3487173499683091, 'support': 73617}, '1': {'precision': 0.705244592749536, 'recall': 0.8841634428525417, 'f1-score': 0.7846336160523603, 'support': 276329}, '2': {'precision': 0.5117372551792406, 'recall': 0.20368963188112124, 'f1-score': 0.29139406139909413, 'support': 71064}, 'accuracy': 0.6643595164010356, 'macro avg': {'precision': 0.5562082386242898, 'recall': 0.4572833258743137, 'f1-score': 0.4749150091399212, 'support': 421010}, 'weighted avg': {'precision': 0.6282373871912409, 'recall': 0.6643595164010356, 'f1-score': 0.6251542130163533, 'support': 421010}}
[[ 20907  49585   3125]
 [ 21323 244320  10686]
 [  4061  52528  14475]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.922742
{'0': {'precision': 0.5260791366906474, 'recall': 0.204066377634923, 'f1-score': 0.2940648450683997, 'support': 40134}, '1': {'precision': 0.5725958285529373, 'recall': 0.891189634055607, 'f1-score': 0.6972216625249065, 'support': 87363}, '2': {'precision': 0.48634412797502924, 'recall': 0.18972121458106087, 'f1-score': 0.27296118542309167, 'support': 39421}, 'accuracy': 0.5603110509351897, 'macro avg': {'precision': 0.528339697739538, 'recall': 0.42832574209053037, 'f1-score': 0.42141589767213256, 'support': 166918}, 'weighted avg': {'precision': 0.5410412376778798, 'recall': 0.5603110509351897, 'f1-score': 0.500088531408849, 'support': 166918}}
[[ 8190 28320  3624]
 [ 5231 77857  4275]
 [ 2147 29795  7479]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8736103
{'0': {'precision': 0.6305858987090367, 'recall': 0.18372070595042916, 'f1-score': 0.28454070201643017, 'support': 10369}, '1': {'precision': 0.6085508462031874, 'recall': 0.942711916227165, 'f1-score': 0.7396401799100449, 'support': 26166}, '2': {'precision': 0.6343692870201096, 'recall': 0.1778575089697591, 'f1-score': 0.277822257806245, 'support': 9755}, 'accuracy': 0.6115143659537697, 'macro avg': {'precision': 0.6245020106441113, 'recall': 0.43476337704911777, 'f1-score': 0.4340010465775734, 'support': 46290}, 'weighted avg': {'precision': 0.6189276089943351, 'recall': 0.6115143659537697, 'f1-score': 0.5403755370843492, 'support': 46290}}
[[ 1905  8161   303]
 [  802 24667   697]
 [  314  7706  1735]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.271241
{'0': {'precision': 0.458999439824191, 'recall': 0.17032026990294366, 'f1-score': 0.24844894341558985, 'support': 125082}, '1': {'precision': 0.2552300633992071, 'recall': 0.8086843002810872, 'f1-score': 0.38800217813904536, 'support': 85027}, '2': {'precision': 0.48452095661955297, 'recall': 0.07852975680903009, 'f1-score': 0.13515412372188837, 'support': 126156}, 'accuracy': 0.29729826178757823, 'macro avg': {'precision': 0.39958348661431703, 'recall': 0.35251144233102033, 'f1-score': 0.25720174842550786, 'support': 336265}, 'weighted avg': {'precision': 0.4170497682959278, 'recall': 0.29729826178757823, 'f1-score': 0.241231337109708, 'support': 336265}}
[[ 21304  98180   5598]
 [ 11325  68760   4942]
 [ 13785 102464   9907]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2287
{'0': {'precision': 0.4548069751749121, 'recall': 0.28394048912440967, 'f1-score': 0.3496136940675421, 'support': 45101}, '1': {'precision': 0.36815647006146457, 'recall': 0.8192296370100315, 'f1-score': 0.5080145195149864, 'support': 44161}, '2': {'precision': 0.49953904912419334, 'recall': 0.08474841362052016, 'f1-score': 0.14491203270358555, 'support': 44756}, 'accuracy': 0.3938053097345133, 'macro avg': {'precision': 0.4408341647868566, 'recall': 0.39597284658498705, 'f1-score': 0.33418008209537137, 'support': 134018}, 'weighted avg': {'precision': 0.4411928020441317, 'recall': 0.3938053097345133, 'f1-score': 0.3334480394284589, 'support': 134018}}
[[12806 30500  1795]
 [ 5978 36178  2005]
 [ 9373 31590  3793]]
Evaluating performance on  val set...
107/107 - 1s - 834ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2939911
{'0': {'precision': 0.46852387843704774, 'recall': 0.12753594642505417, 'f1-score': 0.20049543272952472, 'support': 10154}, '1': {'precision': 0.2530624568668047, 'recall': 0.8572472238457043, 'f1-score': 0.39076861595843876, 'support': 6844}, '2': {'precision': 0.5180032733224222, 'recall': 0.06222965001966182, 'f1-score': 0.11111111111111109, 'support': 10172}, 'accuracy': 0.2868973132131027, 'macro avg': {'precision': 0.41319653620875824, 'recall': 0.3490042734301401, 'f1-score': 0.23412505326635816, 'support': 27170}, 'weighted avg': {'precision': 0.4327743913390457, 'recall': 0.2868973132131027, 'f1-score': 0.2149603700322919, 'support': 27170}}
[[1295 8573  286]
 [ 674 5867  303]
 [ 795 8744  633]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2273182
{'0': {'precision': 0.3794399548956963, 'recall': 0.24588752120394938, 'f1-score': 0.29840220850994204, 'support': 114955}, '1': {'precision': 0.3241580324660128, 'recall': 0.7142575872640846, 'f1-score': 0.44593384337116665, 'support': 106659}, '2': {'precision': 0.3913832948167712, 'recall': 0.08458266073291892, 'f1-score': 0.13910339618213685, 'support': 112127}, 'accuracy': 0.3413784941017136, 'macro avg': {'precision': 0.36499376072616013, 'recall': 0.34824258973365096, 'f1-score': 0.2944798160210818, 'support': 333741}, 'weighted avg': {'precision': 0.36578522356482224, 'recall': 0.3413784941017136, 'f1-score': 0.2920316358586452, 'support': 333741}}
[[28266 79349  7340]
 [23069 76182  7408]
 [23159 79484  9484]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2401026
{'0': {'precision': 0.37139378044211313, 'recall': 0.23518595408980367, 'f1-score': 0.28799709460686396, 'support': 33718}, '1': {'precision': 0.32350098804252186, 'recall': 0.7019498607242339, 'f1-score': 0.4428909952606635, 'support': 31951}, '2': {'precision': 0.380039656311963, 'recall': 0.08825244804616754, 'f1-score': 0.14324149270091174, 'support': 32577}, 'accuracy': 0.3382631353948252, 'macro avg': {'precision': 0.35831147493219934, 'recall': 0.34179608762006836, 'f1-score': 0.29137652752281307, 'support': 98246}, 'weighted avg': {'precision': 0.3586852130526291, 'recall': 0.3382631353948252, 'f1-score': 0.29037186585963093, 'support': 98246}}
[[ 7930 23466  2322]
 [ 7155 22428  2368]
 [ 6267 23435  2875]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.241266
{'0': {'precision': 0.37158469945355194, 'recall': 0.22577471716674866, 'f1-score': 0.2808842652795839, 'support': 8132}, '1': {'precision': 0.3073667423173649, 'recall': 0.6847499316753212, 'f1-score': 0.4242834765674611, 'support': 7318}, '2': {'precision': 0.3885593220338983, 'recall': 0.11246014226146676, 'f1-score': 0.1744340878828229, 'support': 8154}, 'accuracy': 0.3289273004575496, 'macro avg': {'precision': 0.3558369212682717, 'recall': 0.3409949303678455, 'f1-score': 0.29320060990995594, 'support': 23604}, 'weighted avg': {'precision': 0.35753894713180684, 'recall': 0.3289273004575496, 'f1-score': 0.2885694322729535, 'support': 23604}}
[[1836 5562  734]
 [1598 5011  709]
 [1507 5730  917]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
2607/2607 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2007104
{'0': {'precision': 0.4272500743444867, 'recall': 0.1783054880345099, 'f1-score': 0.2516070786947713, 'support': 233672}, '1': {'precision': 0.30959266818493447, 'recall': 0.7724993609532611, 'f1-score': 0.44203289903013115, 'support': 203428}, '2': {'precision': 0.43756129716867376, 'recall': 0.11821712160964676, 'f1-score': 0.18614338135967085, 'support': 230212}, 'accuracy': 0.33871412472726403, 'macro avg': {'precision': 0.39146801323269836, 'recall': 0.3563406568658059, 'f1-score': 0.2932611196948578, 'support': 667312}, 'weighted avg': {'precision': 0.3949397853171297, 'recall': 0.33871412472726403, 'f1-score': 0.28707386947370744, 'support': 667312}}
[[ 41665 174136  17871]
 [ 29169 157148  17111]
 [ 26685 176312  27215]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1873212
{'0': {'precision': 0.43031667527865947, 'recall': 0.18892904020352935, 'f1-score': 0.26257530544451324, 'support': 61711}, '1': {'precision': 0.335835344295415, 'recall': 0.7901173441600238, 'f1-score': 0.4713330018755261, 'support': 60591}, '2': {'precision': 0.4724624185180258, 'recall': 0.11387027477636347, 'f1-score': 0.18351160026869218, 'support': 62378}, 'accuracy': 0.36081871345029237, 'macro avg': {'precision': 0.4128714793640334, 'recall': 0.36430555304663886, 'f1-score': 0.3058066358629105, 'support': 184680}, 'weighted avg': {'precision': 0.41355389017025257, 'recall': 0.36081871345029237, 'f1-score': 0.3043611067386119, 'support': 184680}}
[[11659 46502  3550]
 [ 8336 47874  4381]
 [ 7099 48176  7103]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2050093
{'0': {'precision': 0.4317051396505548, 'recall': 0.16606976401903548, 'f1-score': 0.23986678004535147, 'support': 20383}, '1': {'precision': 0.3055230955793187, 'recall': 0.792054872820806, 'f1-score': 0.44095465393794747, 'support': 17495}, '2': {'precision': 0.47088762214983715, 'recall': 0.1143351458230351, 'f1-score': 0.18399490891734946, 'support': 20230}, 'accuracy': 0.3365285330763406, 'macro avg': {'precision': 0.4027052857932369, 'recall': 0.35748659422095885, 'f1-score': 0.28827211430021615, 'support': 58108}, 'weighted avg': {'precision': 0.40735576882268615, 'recall': 0.3365285330763406, 'f1-score': 0.2809582717647616, 'support': 58108}}
[[ 3385 15764  1234]
 [ 2273 13857  1365]
 [ 2183 15734  2313]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
5343/5343 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92652917
{'0': {'precision': 0.6736424176276119, 'recall': 0.24594017094017093, 'f1-score': 0.3603281171339247, 'support': 346320}, '1': {'precision': 0.5361456986040651, 'recall': 0.9508023567092827, 'f1-score': 0.6856575681318811, 'support': 673142}, '2': {'precision': 0.7816340679426038, 'recall': 0.10681055445027231, 'f1-score': 0.18793916034814587, 'support': 348327}, 'accuracy': 0.5573988385635503, 'macro avg': {'precision': 0.6638073947247602, 'recall': 0.434517694033242, 'f1-score': 0.41130828187131724, 'support': 1367789}, 'weighted avg': {'precision': 0.6334765668584669, 'recall': 0.5573988385635503, 'f1-score': 0.4765340444760413, 'support': 1367789}}
[[ 85174 254783   6363]
 [ 29086 640025   4031]
 [ 12178 298944  37205]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8199409
{'0': {'precision': 0.5951991828396322, 'recall': 0.3307882262779938, 'f1-score': 0.4252431081352283, 'support': 70462}, '1': {'precision': 0.6386885883549758, 'recall': 0.9109968312225932, 'f1-score': 0.750917925378713, 'support': 187454}, '2': {'precision': 0.6876189670487712, 'recall': 0.2249622894784185, 'f1-score': 0.33901274217430294, 'support': 72261}, 'accuracy': 0.6370340756624477, 'macro avg': {'precision': 0.6405022460811264, 'recall': 0.4889157823263352, 'f1-score': 0.5050579252294148, 'support': 330177}, 'weighted avg': {'precision': 0.6401163304550319, 'recall': 0.6370340756624477, 'f1-score': 0.5912690721389529, 'support': 330177}}
[[ 23308  44808   2346]
 [ 11645 170770   5039]
 [  4207  51798  16256]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8290506
{'0': {'precision': 0.5663159787788868, 'recall': 0.31750352893728573, 'f1-score': 0.4068869722518332, 'support': 19836}, '1': {'precision': 0.6410442445189035, 'recall': 0.9097461434776097, 'f1-score': 0.7521165126681216, 'support': 53416}, '2': {'precision': 0.6628358965692074, 'recall': 0.20018374846876277, 'f1-score': 0.30749931396761926, 'support': 19592}, 'accuracy': 0.6334819697557192, 'macro avg': {'precision': 0.6233987066223327, 'recall': 0.4758111402945527, 'f1-score': 0.488834266295858, 'support': 92844}, 'weighted avg': {'precision': 0.6296771359039212, 'recall': 0.6334819697557192, 'f1-score': 0.5845352654077953, 'support': 92844}}
[[ 6298 12848   690]
 [ 3516 48595  1305]
 [ 1307 14363  3922]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
7177/7177 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89138067
{'0': {'precision': 0.6182263739302779, 'recall': 0.18479643619830535, 'f1-score': 0.28453993890366014, 'support': 435490}, '1': {'precision': 0.5777665007775268, 'recall': 0.9435850726764909, 'f1-score': 0.7166940964059575, 'support': 974937}, '2': {'precision': 0.6541281923844899, 'recall': 0.17583004814115155, 'f1-score': 0.277159466444013, 'support': 426662}, 'accuracy': 0.5854005984467818, 'macro avg': {'precision': 0.6167070223640982, 'recall': 0.43473718567198266, 'f1-score': 0.4261311672512102, 'support': 1837089}, 'weighted avg': {'precision': 0.6050926141142795, 'recall': 0.5854005984467818, 'f1-score': 0.51216860072257, 'support': 1837089}}
[[ 80477 339500  15513]
 [ 30847 919936  24154]
 [ 18850 332792  75020]]
Evaluating performance on  train set...
2257/2257 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8996318
{'0': {'precision': 0.6031616341030195, 'recall': 0.12601399743207237, 'f1-score': 0.2084732547931413, 'support': 134739}, '1': {'precision': 0.5709528776607329, 'recall': 0.9605048336504345, 'f1-score': 0.7161843186779742, 'support': 311152}, '2': {'precision': 0.6340120866853998, 'recall': 0.12507973633850733, 'f1-score': 0.2089393199419014, 'support': 131684}, 'accuracy': 0.5753590442799636, 'macro avg': {'precision': 0.6027088661497174, 'recall': 0.40386618914033806, 'f1-score': 0.37786563113767224, 'support': 577575}, 'weighted avg': {'precision': 0.5928438260492218, 'recall': 0.5753590442799636, 'f1-score': 0.4820943191967994, 'support': 577575}}
[[ 16979 114038   3722]
 [  6503 298863   5786]
 [  4668 110545  16471]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8720491
{'0': {'precision': 0.6875494071146245, 'recall': 0.09648879520745507, 'f1-score': 0.16922852417550346, 'support': 36056}, '1': {'precision': 0.5896071609436556, 'recall': 0.9802845239527178, 'f1-score': 0.7363345900171664, 'support': 91451}, '2': {'precision': 0.6932968976048867, 'recall': 0.12040423215432289, 'f1-score': 0.20517577660434802, 'support': 35821}, 'accuracy': 0.5965909090909091, 'macro avg': {'precision': 0.6568178218877222, 'recall': 0.39905918377149857, 'f1-score': 0.3702462969323393, 'support': 163328}, 'weighted avg': {'precision': 0.6339698892259001, 'recall': 0.5965909090909091, 'f1-score': 0.494647823723282, 'support': 163328}}
[[ 3479 31695   882]
 [  777 89648  1026]
 [  804 30704  4313]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
5696/5696 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2000513
{'0': {'precision': 0.5208861380707963, 'recall': 0.1649785040422641, 'f1-score': 0.2505888496322467, 'support': 546847}, '1': {'precision': 0.2759963224806357, 'recall': 0.8859166011014948, 'f1-score': 0.4208744372594519, 'support': 372403}, '2': {'precision': 0.5907414032106605, 'recall': 0.09808008552751246, 'f1-score': 0.16822926781126538, 'support': 538774}, 'accuracy': 0.32439726643731515, 'macro avg': {'precision': 0.46254128792069754, 'recall': 0.3829917302237571, 'f1-score': 0.2798975182343213, 'support': 1458024}, 'weighted avg': {'precision': 0.48415045925154687, 'recall': 0.32439726643731515, 'f1-score': 0.26364875972502755, 'support': 1458024}}
[[ 90218 432464  24165]
 [ 30041 329918  12444]
 [ 52942 432989  52843]]
Evaluating performance on  train set...
2222/2222 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0854232
{'0': {'precision': 0.5895463820436352, 'recall': 0.14407522686423216, 'f1-score': 0.23156086927802363, 'support': 182488}, '1': {'precision': 0.3916006107298056, 'recall': 0.9226362700739849, 'f1-score': 0.549832274713623, 'support': 205988}, '2': {'precision': 0.5632154207901605, 'recall': 0.12099831800291991, 'f1-score': 0.19920125751676993, 'support': 180143}, 'accuracy': 0.4188059139775491, 'macro avg': {'precision': 0.5147874711878672, 'recall': 0.39590327164704564, 'f1-score': 0.3268648005028055, 'support': 568619}, 'weighted avg': {'precision': 0.5094966617661246, 'recall': 0.4188059139775491, 'f1-score': 0.33660613284002333, 'support': 568619}}
[[ 26292 146753   9443]
 [  8475 190052   7461]
 [  9830 148516  21797]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0975186
{'0': {'precision': 0.5944968869250854, 'recall': 0.11171919230043405, 'f1-score': 0.18809175827667282, 'support': 52990}, '1': {'precision': 0.3853732003205571, 'recall': 0.9408490613773213, 'f1-score': 0.5467831814817901, 'support': 59289}, '2': {'precision': 0.5708347007985998, 'recall': 0.10118678250077567, 'f1-score': 0.171902024411537, 'support': 51568}, 'accuracy': 0.4084298156206705, 'macro avg': {'precision': 0.5169015960147475, 'recall': 0.3845850120595104, 'f1-score': 0.3022589880566666, 'support': 163847}, 'weighted avg': {'precision': 0.5113769892811463, 'recall': 0.4084298156206705, 'f1-score': 0.312790920265912, 'support': 163847}}
[[ 5920 44805  2265]
 [ 1849 55782  1658]
 [ 2189 44161  5218]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
12066/12066 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802876
{'0': {'precision': 0.5969324087383702, 'recall': 0.15596094579438866, 'f1-score': 0.24730764983291678, 'support': 969217}, '1': {'precision': 0.4030956903279002, 'recall': 0.9460759793312996, 'f1-score': 0.565323388516638, 'support': 1157499}, '2': {'precision': 0.7029949383691796, 'recall': 0.08690129982975203, 'f1-score': 0.15468151628956764, 'support': 962126}, 'accuracy': 0.43053416134590244, 'macro avg': {'precision': 0.5676743458118166, 'recall': 0.39631274165181346, 'f1-score': 0.3224375182130408, 'support': 3088842}, 'weighted avg': {'precision': 0.5573317136106075, 'recall': 0.43053416134590244, 'f1-score': 0.3376278695622329, 'support': 3088842}}
[[ 151160  799156   18901]
 [  45994 1095082   16423]
 [  56074  822442   83610]]
Evaluating performance on  train set...
2948/2948 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.090567
{'0': {'precision': 0.6234193339200519, 'recall': 0.11337236238049109, 'f1-score': 0.19185482951305738, 'support': 237430}, '1': {'precision': 0.39570431257741245, 'recall': 0.9523169409818296, 'f1-score': 0.5590949244933076, 'support': 280456}, '2': {'precision': 0.6416309012875536, 'recall': 0.09857309506500532, 'f1-score': 0.17089219766692065, 'support': 236596}, 'accuracy': 0.4205839238046766, 'macro avg': {'precision': 0.5535848492616727, 'recall': 0.388087466142442, 'f1-score': 0.3072806505577619, 'support': 754482}, 'weighted avg': {'precision': 0.5444840378721809, 'recall': 0.4205839238046766, 'f1-score': 0.3217916778852021, 'support': 754482}}
[[ 26918 203767   6745]
 [  7092 267083   6281]
 [  9168 204106  23322]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9998224
{'0': {'precision': 0.6228332976674513, 'recall': 0.11606947019999601, 'f1-score': 0.19567373144864447, 'support': 50151}, '1': {'precision': 0.4767461357412111, 'recall': 0.9656599454081184, 'f1-score': 0.6383426323973291, 'support': 79499}, '2': {'precision': 0.6569079357169553, 'recall': 0.10816410256410257, 'f1-score': 0.18574422741603117, 'support': 48750}, 'accuracy': 0.49250560538116595, 'macro avg': {'precision': 0.5854957897085392, 'recall': 0.3966311727240723, 'f1-score': 0.33992019708733495, 'support': 178400}, 'weighted avg': {'precision': 0.5670449306211461, 'recall': 0.49250560538116595, 'f1-score': 0.39022346034398964, 'support': 178400}}
[[ 5821 42830  1500]
 [ 1476 76769  1254]
 [ 2049 41428  5273]]
testing model on single stock: results/universal/W1/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
21353/21353 - 121s - 121s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.385984
{'0': {'precision': 0.45099480345845167, 'recall': 0.05865143487317966, 'f1-score': 0.10380334574734414, 'support': 2081961}, '1': {'precision': 0.23413623988817947, 'recall': 0.9338998446704239, 'f1-score': 0.37440589542388786, 'support': 1286941}, '2': {'precision': 0.47609865831123965, 'recall': 0.014127586938538083, 'f1-score': 0.027440902039776803, 'support': 2097315}, 'accuracy': 0.2476326863715802, 'macro avg': {'precision': 0.38707656721929024, 'recall': 0.33555962216071383, 'f1-score': 0.1685500477370029, 'support': 5466217}, 'weighted avg': {'precision': 0.4095706365585436, 'recall': 0.2476326863715802, 'f1-score': 0.1382135086184384, 'support': 5466217}}
[[ 122110 1943143   16708]
 [  69170 1201874   15897]
 [  79477 1988208   29630]]
Evaluating performance on  train set...
6073/6073 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2181331
{'0': {'precision': 0.446225722143455, 'recall': 0.10052102774068672, 'f1-score': 0.16407987136163207, 'support': 519742}, '1': {'precision': 0.33306563733236616, 'recall': 0.9090873379084942, 'f1-score': 0.4875176562412772, 'support': 509126}, '2': {'precision': 0.48818881177355966, 'recall': 0.044423857587989786, 'f1-score': 0.08143715498272079, 'support': 525686}, 'accuracy': 0.3463617217542781, 'macro avg': {'precision': 0.4224933904164603, 'recall': 0.3513440744123902, 'f1-score': 0.24434489419521, 'support': 1554554}, 'weighted avg': {'precision': 0.4233552830308611, 'recall': 0.3463617217542781, 'f1-score': 0.24206138031035293, 'support': 1554554}}
[[ 52245 456041  11456]
 [ 33259 462840  13027]
 [ 31578 470755  23353]]
Evaluating performance on  val set...
1786/1786 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2776067
{'0': {'precision': 0.4600850646163913, 'recall': 0.10458111776298665, 'f1-score': 0.17042355935284495, 'support': 161358}, '1': {'precision': 0.294684928294531, 'recall': 0.9084535678785506, 'f1-score': 0.44501539159576453, 'support': 132796}, '2': {'precision': 0.45472511678045274, 'recall': 0.031047786112525223, 'f1-score': 0.05812678344845008, 'support': 163039}, 'accuracy': 0.3118507938660478, 'macro avg': {'precision': 0.4031650365637917, 'recall': 0.34802749058468746, 'f1-score': 0.22452191146568654, 'support': 457193}, 'weighted avg': {'precision': 0.4101316378617792, 'recall': 0.3118507938660478, 'f1-score': 0.21013532857908881, 'support': 457193}}
[[ 16875 141213   3270]
 [  9357 120639   2800]
 [ 10446 147531   5062]]
training model: results/universal/W1/deepLOB_L1/h100
Epoch 1/50
10622/10622 - 170s - loss: 3.1890 - accuracy100: 0.4239 - val_loss: 3.4042 - val_accuracy100: 0.3546 - 170s/epoch - 16ms/step
Epoch 2/50
10622/10622 - 167s - loss: 3.1596 - accuracy100: 0.4362 - val_loss: 3.5096 - val_accuracy100: 0.3406 - 167s/epoch - 16ms/step
Epoch 3/50
10622/10622 - 161s - loss: 3.1405 - accuracy100: 0.4436 - val_loss: 3.5490 - val_accuracy100: 0.3407 - 161s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 161s - loss: 3.1296 - accuracy100: 0.4475 - val_loss: 3.6222 - val_accuracy100: 0.3312 - 161s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 161s - loss: 3.1225 - accuracy100: 0.4499 - val_loss: 3.5907 - val_accuracy100: 0.3344 - 161s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 161s - loss: 3.1176 - accuracy100: 0.4513 - val_loss: 3.5869 - val_accuracy100: 0.3318 - 161s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 163s - loss: 3.1127 - accuracy100: 0.4531 - val_loss: 3.6350 - val_accuracy100: 0.3391 - 163s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 161s - loss: 3.1085 - accuracy100: 0.4546 - val_loss: 3.6967 - val_accuracy100: 0.3457 - 161s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 163s - loss: 3.1052 - accuracy100: 0.4555 - val_loss: 3.7029 - val_accuracy100: 0.3419 - 163s/epoch - 15ms/step
Epoch 10/50
10622/10622 - 160s - loss: 3.1011 - accuracy100: 0.4570 - val_loss: 3.7009 - val_accuracy100: 0.3355 - 160s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 164s - loss: 3.0981 - accuracy100: 0.4575 - val_loss: 3.7382 - val_accuracy100: 0.3253 - 164s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 189s - 189s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1556042
{'0': {'precision': 0.4039551994528727, 'recall': 0.44938942708069374, 'f1-score': 0.4254627966330862, 'support': 3196506}, '1': {'precision': 0.313733888236331, 'recall': 0.6062802998494415, 'f1-score': 0.41349509234985987, 'support': 2650797}, '2': {'precision': 0.444333688236061, 'recall': 0.05113115326937707, 'f1-score': 0.09170900541364156, 'support': 3199478}, 'accuracy': 0.35451228453523964, 'macro avg': {'precision': 0.3873409253084216, 'recall': 0.3689336267331707, 'f1-score': 0.3102222981321959, 'support': 9046781}, 'weighted avg': {'precision': 0.3917996830792789, 'recall': 0.35451228453523964, 'f1-score': 0.30392101651990894, 'support': 9046781}}
[[1436476 1667117   92913]
 [ 932001 1607126  111670]
 [1187551 1848334  163593]]
Evaluating performance on  train set...
10622/10622 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198229
{'0': {'precision': 0.39752639915108307, 'recall': 0.2841149280858034, 'f1-score': 0.33138596441869766, 'support': 891340}, '1': {'precision': 0.35004941523994193, 'recall': 0.7160876070817896, 'f1-score': 0.4702323301252088, 'support': 936317}, '2': {'precision': 0.43582069779485266, 'recall': 0.0812419950676708, 'f1-score': 0.13695415843916728, 'support': 890857}, 'accuracy': 0.36641451910860123, 'macro avg': {'precision': 0.3944655040619592, 'recall': 0.36048151007842133, 'f1-score': 0.3128574843276913, 'support': 2718514}, 'weighted avg': {'precision': 0.393723305572078, 'recall': 0.36641451910860123, 'f1-score': 0.3154924568699843, 'support': 2718514}}
[[253243 600309  37788]
 [209929 670485  55903]
 [173875 644607  72375]]
Evaluating performance on  val set...
3064/3064 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.129322
{'0': {'precision': 0.38182713929632356, 'recall': 0.3012650530537157, 'f1-score': 0.3367954565011617, 'support': 259831}, '1': {'precision': 0.3380629104121065, 'recall': 0.6918852542893202, 'f1-score': 0.45419905729736176, 'support': 263853}, '2': {'precision': 0.4326290534788329, 'recall': 0.06447668919698263, 'f1-score': 0.11222758710687719, 'support': 260094}, 'accuracy': 0.35418702744909913, 'macro avg': {'precision': 0.38417303439575434, 'recall': 0.35254233218000613, 'f1-score': 0.3010740336351336, 'support': 783778}, 'weighted avg': {'precision': 0.3839526773741955, 'recall': 0.35418702744909913, 'f1-score': 0.30179643491423624, 'support': 783778}}
[[ 78278 172502   9051]
 [ 68355 182556  12942]
 [ 58376 184948  16770]]
testing model out of sample: results/universal/W1/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 122s - 122s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105204
{'0': {'precision': 0.4196840492107905, 'recall': 0.3169581646314907, 'f1-score': 0.3611584659780171, 'support': 1983776}, '1': {'precision': 0.36654185775374193, 'recall': 0.7289086084714562, 'f1-score': 0.48779113929720613, 'support': 2128961}, '2': {'precision': 0.4582702632066123, 'recall': 0.08473872352764392, 'f1-score': 0.14302981380973118, 'support': 1986459}, 'accuracy': 0.38511994039870173, 'macro avg': {'precision': 0.4148320567237149, 'recall': 0.37686849887686363, 'f1-score': 0.3306598063616515, 'support': 6099196}, 'weighted avg': {'precision': 0.41370166710687656, 'recall': 0.38511994039870173, 'f1-score': 0.3343176165553609, 'support': 6099196}}
[[ 628774 1285695   69307]
 [ 447464 1551818  129679]
 [ 421970 1396159  168330]]
Evaluating performance on  train set...
6711/6711 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1055497
{'0': {'precision': 0.41774345812313773, 'recall': 0.20376952576933868, 'f1-score': 0.27392311524008955, 'support': 555932}, '1': {'precision': 0.3632271741309592, 'recall': 0.8257030319383477, 'f1-score': 0.5045170480677449, 'support': 607796}, '2': {'precision': 0.46859625979669434, 'recall': 0.05454611146237919, 'f1-score': 0.09771758214196138, 'support': 553550}, 'accuracy': 0.37578947613607117, 'macro avg': {'precision': 0.41652229735026375, 'recall': 0.36133955639002185, 'f1-score': 0.2920525818165986, 'support': 1717278}, 'weighted avg': {'precision': 0.4148404855241102, 'recall': 0.37578947613607117, 'f1-score': 0.2987388393980004, 'support': 1717278}}
[[113282 429866  12784]
 [ 84480 501859  21457]
 [ 73414 449942  30194]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0849594
{'0': {'precision': 0.4105336802827965, 'recall': 0.24442950371610017, 'f1-score': 0.30641888332592787, 'support': 136837}, '1': {'precision': 0.3965959444616718, 'recall': 0.8114715701214993, 'f1-score': 0.5327952781963085, 'support': 168643}, '2': {'precision': 0.4981984686983936, 'recall': 0.04939236304912445, 'f1-score': 0.08987440333118928, 'support': 134373}, 'accuracy': 0.40225484423205027, 'macro avg': {'precision': 0.435109364480954, 'recall': 0.368431145628908, 'f1-score': 0.3096961882844752, 'support': 439853}, 'weighted avg': {'precision': 0.43197102192122366, 'recall': 0.40225484423205027, 'f1-score': 0.32706001331661244, 'support': 439853}}
[[ 33447 101074   2316]
 [ 27425 136849   4369]
 [ 20600 107136   6637]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1419678
{'0': {'precision': 0.32797059056051864, 'recall': 0.2969949707372076, 'f1-score': 0.311715147132029, 'support': 55873}, '1': {'precision': 0.3566300785517349, 'recall': 0.6862591344389202, 'f1-score': 0.46935119468723613, 'support': 59938}, '2': {'precision': 0.444326052210975, 'recall': 0.03095940753939529, 'f1-score': 0.057885513005153474, 'support': 53877}, 'accuracy': 0.3500247513082834, 'macro avg': {'precision': 0.37630890710774284, 'recall': 0.3380711709051743, 'f1-score': 0.2796506182748062, 'support': 169688}, 'weighted avg': {'precision': 0.3750374167271253, 'recall': 0.3500247513082834, 'f1-score': 0.2868036048928037, 'support': 169688}}
[[16594 38570   709]
 [17428 41133  1377]
 [16574 35635  1668]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1451375
{'0': {'precision': 0.3620918624353162, 'recall': 0.3610007761493859, 'f1-score': 0.36154549611339737, 'support': 21903}, '1': {'precision': 0.3297134823289863, 'recall': 0.6221754642759125, 'f1-score': 0.43101590721845495, 'support': 21862}, '2': {'precision': 0.44405594405594406, 'recall': 0.06696546269443712, 'f1-score': 0.11638029782359678, 'support': 22758}, 'accuracy': 0.34624114967755515, 'macro avg': {'precision': 0.37862042960674885, 'recall': 0.3500472343732452, 'f1-score': 0.30298056705181636, 'support': 66523}, 'weighted avg': {'precision': 0.37949159521401926, 'recall': 0.34624114967755515, 'f1-score': 0.30050333843709726, 'support': 66523}}
[[ 7907 13090   906]
 [ 7258 13602  1002]
 [ 6672 14562  1524]]
Evaluating performance on  val set...
51/51 - 0s - 432ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.063789
{'0': {'precision': 0.32382650029708854, 'recall': 0.31621700029010735, 'f1-score': 0.31997651548510203, 'support': 3447}, '1': {'precision': 0.47825136612021857, 'recall': 0.7147990852662529, 'f1-score': 0.573074908328968, 'support': 6122}, '2': {'precision': 0.24471299093655588, 'recall': 0.02471018913971934, 'f1-score': 0.044887780548628436, 'support': 3278}, 'accuracy': 0.4317739550089515, 'macro avg': {'precision': 0.34893028578462104, 'recall': 0.35190875823202655, 'f1-score': 0.31264640145423284, 'support': 12847}, 'weighted avg': {'precision': 0.3772284575544541, 'recall': 0.4317739550089515, 'f1-score': 0.3703950947540665, 'support': 12847}}
[[1090 2318   39]
 [1535 4376  211]
 [ 741 2456   81]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9935787
{'0': {'precision': 0.4316955777368608, 'recall': 0.2534733088660654, 'f1-score': 0.319405357281565, 'support': 105447}, '1': {'precision': 0.5392055535458977, 'recall': 0.8686452436452436, 'f1-score': 0.6653806502354154, 'support': 216216}, '2': {'precision': 0.5797921692336241, 'recall': 0.06290074184424291, 'f1-score': 0.11348921679909195, 'support': 99347}, 'accuracy': 0.5244340989525189, 'macro avg': {'precision': 0.5168977668387942, 'recall': 0.39500643145185066, 'f1-score': 0.3660917414386908, 'support': 421010}, 'weighted avg': {'precision': 0.521855737839841, 'recall': 0.5244340989525189, 'f1-score': 0.44849550509942554, 'support': 421010}}
[[ 26728  77799    920]
 [ 24792 187815   3609]
 [ 10394  82704   6249]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.064239
{'0': {'precision': 0.44096888033365417, 'recall': 0.21356432566811684, 'f1-score': 0.2877630063854286, 'support': 51488}, '1': {'precision': 0.4203205153696266, 'recall': 0.8194278626250097, 'f1-score': 0.5556326552068548, 'support': 64495}, '2': {'precision': 0.40986028189819657, 'recall': 0.1307352508098557, 'f1-score': 0.1982376231728737, 'support': 50935}, 'accuracy': 0.4223870403431625, 'macro avg': {'precision': 0.4237165592004925, 'recall': 0.3879091463676607, 'f1-score': 0.34721109492171903, 'support': 166918}, 'weighted avg': {'precision': 0.42349783011938735, 'recall': 0.4223870403431625, 'f1-score': 0.3639457883910026, 'support': 166918}}
[[10996 34798  5694]
 [ 7752 52849  3894]
 [ 6188 38088  6659]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0565445
{'0': {'precision': 0.6428571428571429, 'recall': 0.09519108729375264, 'f1-score': 0.1658272939442329, 'support': 14182}, '1': {'precision': 0.42315179606025494, 'recall': 0.9588803697090642, 'f1-score': 0.5871816310779522, 'support': 19042}, '2': {'precision': 0.6394230769230769, 'recall': 0.05089545384968621, 'f1-score': 0.09428611938182335, 'support': 13066}, 'accuracy': 0.43797796500324043, 'macro avg': {'precision': 0.5684773386134916, 'recall': 0.368322303617501, 'f1-score': 0.2824316814680028, 'support': 46290}, 'weighted avg': {'precision': 0.5515091471949946, 'recall': 0.43797796500324043, 'f1-score': 0.31896344215913547, 'support': 46290}}
[[ 1350 12690   142]
 [  550 18259   233]
 [  200 12201   665]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
1314/1314 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.164148
{'0': {'precision': 0.42161492712005116, 'recall': 0.2519929068783757, 'f1-score': 0.3154475518422915, 'support': 122936}, '1': {'precision': 0.2785826021900292, 'recall': 0.7483771119040454, 'f1-score': 0.40602341141999154, 'support': 93044}, '2': {'precision': 0.4263457194048454, 'recall': 0.045500270191628216, 'f1-score': 0.08222532714352249, 'support': 120285}, 'accuracy': 0.31547737647391194, 'macro avg': {'precision': 0.3755144162383086, 'recall': 0.34862342965801646, 'f1-score': 0.26789876346860186, 'support': 336265}, 'weighted avg': {'precision': 0.38373035307632825, 'recall': 0.31547737647391194, 'f1-score': 0.2570840735756152, 'support': 336265}}
[[30979 88579  3378]
 [19426 69632  3986]
 [23072 91740  5473]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1288743
{'0': {'precision': 0.3971441189459738, 'recall': 0.30010901728702694, 'f1-score': 0.3418744931062449, 'support': 44947}, '1': {'precision': 0.3515529273879921, 'recall': 0.7353793349380405, 'f1-score': 0.4756961715072482, 'support': 44868}, '2': {'precision': 0.36237495966440786, 'recall': 0.05081103092550279, 'f1-score': 0.08912521576952838, 'support': 44203}, 'accuracy': 0.36360787356922203, 'macro avg': {'precision': 0.3703573353327913, 'recall': 0.3620997943835234, 'f1-score': 0.3022319601276738, 'support': 134018}, 'weighted avg': {'precision': 0.3704127341279152, 'recall': 0.36360787356922203, 'f1-score': 0.30331276826615877, 'support': 134018}}
[[13489 30163  1295]
 [ 9216 32995  2657]
 [11260 30697  2246]]
Evaluating performance on  val set...
107/107 - 1s - 699ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1666535
{'0': {'precision': 0.4299826866279662, 'recall': 0.41964019481164894, 'f1-score': 0.424748490945674, 'support': 10061}, '1': {'precision': 0.2907783989678688, 'recall': 0.647203610009572, 'f1-score': 0.40127172530733357, 'support': 7313}, '2': {'precision': 0.4059590316573557, 'recall': 0.04450796243364639, 'f1-score': 0.08022079116835326, 'support': 9796}, 'accuracy': 0.34563857195436143, 'macro avg': {'precision': 0.3755733724177302, 'recall': 0.3704505890849558, 'f1-score': 0.3020803358071203, 'support': 27170}, 'weighted avg': {'precision': 0.38385325417487853, 'recall': 0.34563857195436143, 'f1-score': 0.2942119089018088, 'support': 27170}}
[[4222 5569  270]
 [2212 4733  368]
 [3385 5975  436]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1304/1304 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1497868
{'0': {'precision': 0.3802685077090294, 'recall': 0.33364238410596025, 'f1-score': 0.3554328501415711, 'support': 113250}, '1': {'precision': 0.3355455827670214, 'recall': 0.6093853333209139, 'f1-score': 0.4327862562596334, 'support': 107359}, '2': {'precision': 0.3892695802243541, 'recall': 0.13557614114485733, 'f1-score': 0.2011092608860975, 'support': 113132}, 'accuracy': 0.3552035860143045, 'macro avg': {'precision': 0.3683612235668017, 'recall': 0.35953461952391047, 'f1-score': 0.32977612242910065, 'support': 333741}, 'weighted avg': {'precision': 0.3689330734559849, 'recall': 0.3552035860143045, 'f1-score': 0.32800334051518065, 'support': 333741}}
[[37785 63644 11821]
 [29693 65423 12243]
 [31886 65908 15338]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1493901
{'0': {'precision': 0.35483377913641573, 'recall': 0.2806794825293193, 'f1-score': 0.31343031694062845, 'support': 33084}, '1': {'precision': 0.32662920081802227, 'recall': 0.6312513615286466, 'f1-score': 0.4305027909247193, 'support': 32133}, '2': {'precision': 0.3930827067669173, 'recall': 0.11871385751914984, 'f1-score': 0.1823551297553716, 'support': 33029}, 'accuracy': 0.340889196506728, 'macro avg': {'precision': 0.35818189557378516, 'recall': 0.34354823385903854, 'f1-score': 0.3087627458735731, 'support': 98246}, 'weighted avg': {'precision': 0.35846778067951063, 'recall': 0.340889196506728, 'f1-score': 0.30765509402049884, 'support': 98246}}
[[ 9286 20860  2938]
 [ 8733 20284  3116]
 [ 8151 20957  3921]]
Evaluating performance on  val set...
93/93 - 1s - 655ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1547077
{'0': {'precision': 0.33965317919075144, 'recall': 0.1872530274059911, 'f1-score': 0.24141331142152836, 'support': 7845}, '1': {'precision': 0.3173093751823114, 'recall': 0.7185889813713833, 'f1-score': 0.44022662889518416, 'support': 7569}, '2': {'precision': 0.41253507951356405, 'recall': 0.1076923076923077, 'f1-score': 0.17079783113865218, 'support': 8190}, 'accuracy': 0.33002880867649553, 'macro avg': {'precision': 0.3564992112955423, 'recall': 0.3378447721565607, 'f1-score': 0.2841459238184549, 'support': 23604}, 'weighted avg': {'precision': 0.35777648503314896, 'recall': 0.33002880867649553, 'f1-score': 0.2806641679052322, 'support': 23604}}
[[1469 5773  603]
 [1477 5439  653]
 [1379 5929  882]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1398602
{'0': {'precision': 0.40136655295646523, 'recall': 0.1718138831423952, 'f1-score': 0.24062351637917392, 'support': 230092}, '1': {'precision': 0.31136382043484984, 'recall': 0.8093918818693807, 'f1-score': 0.4497239640176164, 'support': 208989}, '2': {'precision': 0.4064506027869109, 'recall': 0.04549776323111234, 'f1-score': 0.08183498240595163, 'support': 228231}, 'accuracy': 0.3282887165224063, 'macro avg': {'precision': 0.373060325392742, 'recall': 0.34223450941429606, 'f1-score': 0.25739415426758067, 'support': 667312}, 'weighted avg': {'precision': 0.3749182899399041, 'recall': 0.3282887165224063, 'f1-score': 0.251801537386241, 'support': 667312}}
[[ 39533 184357   6202]
 [ 30873 169154   8962]
 [ 28090 189757  10384]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1346178
{'0': {'precision': 0.3830290324939668, 'recall': 0.2551018751522039, 'f1-score': 0.3062425695297121, 'support': 61595}, '1': {'precision': 0.3306945622467251, 'recall': 0.6913491060140871, 'f1-score': 0.44738869203512566, 'support': 60907}, '2': {'precision': 0.40900459418070445, 'recall': 0.10738524880182701, 'f1-score': 0.17010814873316946, 'support': 62178}, 'accuracy': 0.34924193199047, 'macro avg': {'precision': 0.3742427296404654, 'recall': 0.351278743322706, 'f1-score': 0.3079131367660024, 'support': 184680}, 'weighted avg': {'precision': 0.37451469902639706, 'recall': 0.34924193199047, 'f1-score': 0.30695851531241625, 'support': 184680}}
[[15713 42037  3845]
 [12996 42108  5803]
 [12314 43187  6677]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.142795
{'0': {'precision': 0.4043924825174825, 'recall': 0.18449651046859422, 'f1-score': 0.2533890182116938, 'support': 20060}, '1': {'precision': 0.3137225071720421, 'recall': 0.792304736813217, 'f1-score': 0.44947143902476994, 'support': 18219}, '2': {'precision': 0.41440217391304346, 'recall': 0.06152604770790257, 'f1-score': 0.10714442541606288, 'support': 19829}, 'accuracy': 0.33310387554209403, 'macro avg': {'precision': 0.37750572120085596, 'recall': 0.3461090983299046, 'f1-score': 0.27000162755084217, 'support': 58108}, 'weighted avg': {'precision': 0.37937984897070753, 'recall': 0.33310387554209403, 'f1-score': 0.2649630113666616, 'support': 58108}}
[[ 3701 15665   694]
 [ 2754 14435  1030]
 [ 2697 15912  1220]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
5343/5343 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1049274
{'0': {'precision': 0.4917942105652704, 'recall': 0.27375588177895355, 'f1-score': 0.35172501215385876, 'support': 461170}, '1': {'precision': 0.33813638827994247, 'recall': 0.8109588979141416, 'f1-score': 0.47727062512352014, 'support': 442216}, '2': {'precision': 0.5198297198297198, 'recall': 0.05653279586910507, 'f1-score': 0.10197549853566074, 'support': 464403}, 'accuracy': 0.37368409893631255, 'macro avg': {'precision': 0.4499201062249775, 'recall': 0.3804158585207334, 'f1-score': 0.3103237119376799, 'support': 1367789}, 'weighted avg': {'precision': 0.45163438113924753, 'recall': 0.37368409893631255, 'f1-score': 0.30751779555258457, 'support': 1367789}}
[[126248 325638   9284]
 [ 68630 358619  14967]
 [ 61831 376318  26254]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0445952
{'0': {'precision': 0.4376497765495801, 'recall': 0.41575741416793144, 'f1-score': 0.4264227941563154, 'support': 97516}, '1': {'precision': 0.4352318500276807, 'recall': 0.6846882695657397, 'f1-score': 0.5321774955941223, 'support': 133192}, '2': {'precision': 0.5590031063662656, 'recall': 0.15739577154691411, 'f1-score': 0.24563055006432585, 'support': 99469}, 'accuracy': 0.44640904726858627, 'macro avg': {'precision': 0.4772949109811755, 'recall': 0.4192804850935284, 'f1-score': 0.40141027993825457, 'support': 330177}, 'weighted avg': {'precision': 0.4732332541819745, 'recall': 0.44640904726858627, 'f1-score': 0.4146183876298713, 'support': 330177}}
[[40543 54086  2887]
 [32533 91195  9464]
 [19562 64251 15656]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.042824
{'0': {'precision': 0.4202915406683725, 'recall': 0.4010580444674633, 'f1-score': 0.4104495977283483, 'support': 27031}, '1': {'precision': 0.45038844997782634, 'recall': 0.6972031528095601, 'f1-score': 0.5472543482382525, 'support': 39330}, '2': {'precision': 0.5364034376520188, 'recall': 0.12491031982781407, 'f1-score': 0.20263399693721287, 'support': 26483}, 'accuracy': 0.44774029554952394, 'macro avg': {'precision': 0.4690278094327392, 'recall': 0.40772383903494586, 'f1-score': 0.3867793143012712, 'support': 92844}, 'weighted avg': {'precision': 0.46616098630792624, 'recall': 0.44774029554952394, 'f1-score': 0.409124259330637, 'support': 92844}}
[[10841 15629   561]
 [ 9611 27421  2298]
 [ 5342 17833  3308]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
7177/7177 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0767094
{'0': {'precision': 0.47850557518274506, 'recall': 0.15600841222678422, 'f1-score': 0.2353010225375626, 'support': 578206}, '1': {'precision': 0.3874381927055252, 'recall': 0.8962628828859969, 'f1-score': 0.5410083050283108, 'support': 694332}, '2': {'precision': 0.5866943572557997, 'recall': 0.04403499418121658, 'f1-score': 0.08192129492325233, 'support': 564551}, 'accuracy': 0.40137902954075716, 'macro avg': {'precision': 0.4842127083813566, 'recall': 0.36543542976466586, 'f1-score': 0.2860768741630419, 'support': 1837089}, 'weighted avg': {'precision': 0.47733365988520204, 'recall': 0.40137902954075716, 'f1-score': 0.30370906932352654, 'support': 1837089}}
[[ 90205 481747   6254]
 [ 60769 622304  11259]
 [ 37540 502151  24860]]
Evaluating performance on  train set...
2257/2257 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.066841
{'0': {'precision': 0.45383970550716185, 'recall': 0.1421469300623862, 'f1-score': 0.21648781039061518, 'support': 175199}, '1': {'precision': 0.40821238993562753, 'recall': 0.9015121015744384, 'f1-score': 0.561963087542619, 'support': 231003}, '2': {'precision': 0.5155838979673176, 'recall': 0.03774223477443938, 'f1-score': 0.07033569308061201, 'support': 171373}, 'accuracy': 0.41487945288490674, 'macro avg': {'precision': 0.459211997803369, 'recall': 0.36046708880375466, 'f1-score': 0.28292886367128206, 'support': 577575}, 'weighted avg': {'precision': 0.453911108728394, 'recall': 0.41487945288490674, 'f1-score': 0.31129679389609444, 'support': 577575}}
[[ 24904 148410   1885]
 [ 18559 208252   4192]
 [ 11411 153494   6468]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.049035
{'0': {'precision': 0.47353181379463954, 'recall': 0.13351475821645384, 'f1-score': 0.20829863322392592, 'support': 47770}, '1': {'precision': 0.43267971180612413, 'recall': 0.9250798652137762, 'f1-score': 0.5895937635098387, 'support': 68553}, '2': {'precision': 0.574597386812519, 'recall': 0.040229762791192426, 'f1-score': 0.07519484650866869, 'support': 47005}, 'accuracy': 0.4389082092476489, 'macro avg': {'precision': 0.4936029708044276, 'recall': 0.3662747954071408, 'f1-score': 0.2910290810808111, 'support': 163328}, 'weighted avg': {'precision': 0.4854713043418006, 'recall': 0.4389082092476489, 'f1-score': 0.3300314749408361, 'support': 163328}}
[[ 6378 40964   428]
 [ 4164 63417   972]
 [ 2927 42187  1891]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
5696/5696 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1580364
{'0': {'precision': 0.4295797089980473, 'recall': 0.365873118518532, 'f1-score': 0.39517533245583486, 'support': 548969}, '1': {'precision': 0.2532494680281909, 'recall': 0.6354776206161596, 'f1-score': 0.36216825484716475, 'support': 361270}, '2': {'precision': 0.5088521933900445, 'recall': 0.07796854605365244, 'f1-score': 0.13521834866451699, 'support': 547785}, 'accuracy': 0.32450906157923326, 'macro avg': {'precision': 0.39722712347209427, 'recall': 0.3597730950627813, 'f1-score': 0.29752064532250555, 'support': 1458024}, 'weighted avg': {'precision': 0.4156714686038495, 'recall': 0.32450906157923326, 'f1-score': 0.28933002175188804, 'support': 1458024}}
[[200853 327668  20448]
 [110915 229579  20776]
 [155789 349286  42710]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1163263
{'0': {'precision': 0.4480337622446214, 'recall': 0.18136271498129689, 'f1-score': 0.25820487550902765, 'support': 191412}, '1': {'precision': 0.34208527289268903, 'recall': 0.8248750019967732, 'f1-score': 0.4836113040560052, 'support': 187803}, '2': {'precision': 0.44415421586041165, 'recall': 0.08977635108023062, 'f1-score': 0.14936228523242331, 'support': 189404}, 'accuracy': 0.3633944697591885, 'macro avg': {'precision': 0.4114244169992407, 'recall': 0.3653380226861002, 'f1-score': 0.29705948826581874, 'support': 568619}, 'weighted avg': {'precision': 0.41174892872847824, 'recall': 0.3633944697591885, 'f1-score': 0.29639702443767413, 'support': 568619}}
[[ 34715 146155  10542]
 [ 22151 154914  10738]
 [ 20617 151783  17004]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1263355
{'0': {'precision': 0.44948102973083914, 'recall': 0.13417473348854306, 'f1-score': 0.2066594769479644, 'support': 57127}, '1': {'precision': 0.31467152502411316, 'recall': 0.8580696695760599, 'f1-score': 0.4604768601046562, 'support': 51328}, '2': {'precision': 0.4366671547810807, 'recall': 0.05383448873483535, 'f1-score': 0.09585188280484079, 'support': 55392}, 'accuracy': 0.33378700861169264, 'macro avg': {'precision': 0.400273236512011, 'recall': 0.34869296393314614, 'f1-score': 0.2543294066191538, 'support': 163847}, 'weighted avg': {'precision': 0.40291753806603076, 'recall': 0.33378700861169264, 'f1-score': 0.2487114180142688, 'support': 163847}}
[[ 7665 47927  1535]
 [ 4973 44043  2312]
 [ 4415 47995  2982]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
12066/12066 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063242
{'0': {'precision': 0.4148866867253706, 'recall': 0.4524099776355039, 'f1-score': 0.43283661606380486, 'support': 996669}, '1': {'precision': 0.37772888793979764, 'recall': 0.6051938269233996, 'f1-score': 0.46514174059681274, 'support': 1072658}, '2': {'precision': 0.44424529600005647, 'recall': 0.12350186117909005, 'f1-score': 0.19327308004027804, 'support': 1019515}, 'accuracy': 0.396906348722272, 'macro avg': {'precision': 0.4122869568884082, 'recall': 0.39370188857933125, 'f1-score': 0.36375047890029855, 'support': 3088842}, 'weighted avg': {'precision': 0.41167316282383926, 'recall': 0.396906348722272, 'f1-score': 0.36498391652213236, 'support': 3088842}}
[[450903 492797  52969]
 [318944 649166 104548]
 [316963 576640 125912]]
Evaluating performance on  train set...
2948/2948 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.120471
{'0': {'precision': 0.4295766960289536, 'recall': 0.20277222856418062, 'f1-score': 0.2755005048805116, 'support': 252288}, '1': {'precision': 0.3361592998472436, 'recall': 0.8222880444380227, 'f1-score': 0.4772245793555495, 'support': 249156}, '2': {'precision': 0.5098349274915149, 'recall': 0.05224116535856275, 'f1-score': 0.09477140583440277, 'support': 253038}, 'accuracy': 0.35687266230340814, 'macro avg': {'precision': 0.4251903077892374, 'recall': 0.35910047945358875, 'f1-score': 0.28249883002348797, 'support': 754482}, 'weighted avg': {'precision': 0.4256440344277139, 'recall': 0.35687266230340814, 'f1-score': 0.2815038737289046, 'support': 754482}}
[[ 51157 196304   4827]
 [ 36396 204878   7882]
 [ 31534 208285  13219]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0881381
{'0': {'precision': 0.3941543513957307, 'recall': 0.32438422313915566, 'f1-score': 0.35588194595449424, 'support': 55499}, '1': {'precision': 0.391909344337171, 'recall': 0.7272049798351745, 'f1-score': 0.5093285300529111, 'support': 68436}, '2': {'precision': 0.5229133995469594, 'recall': 0.055099605251078675, 'f1-score': 0.09969437246694571, 'support': 54465}, 'accuracy': 0.3966984304932735, 'macro avg': {'precision': 0.43632569842662033, 'recall': 0.3688962694084696, 'f1-score': 0.32163494949145033, 'support': 178400}, 'weighted avg': {'precision': 0.43260290663394296, 'recall': 0.3966984304932735, 'f1-score': 0.3365322499867808, 'support': 178400}}
[[18003 36613   883]
 [16814 49767  1855]
 [10858 40606  3001]]
testing model on single stock: results/universal/W1/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
21353/21353 - 111s - 111s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1804363
{'0': {'precision': 0.3912171545671613, 'recall': 0.5310011333201198, 'f1-score': 0.4505153610114179, 'support': 1967670}, '1': {'precision': 0.29306658714606665, 'recall': 0.5024387426693337, 'f1-score': 0.3701999271286638, 'support': 1523736}, '2': {'precision': 0.39831956629742254, 'recall': 0.036944801299972505, 'f1-score': 0.06761792752289411, 'support': 1974811}, 'accuracy': 0.3445487070857231, 'macro avg': {'precision': 0.3608677693368835, 'recall': 0.3567948924298086, 'f1-score': 0.29611107188765856, 'support': 5466217}, 'weighted avg': {'precision': 0.3664231092176078, 'recall': 0.3445487070857231, 'f1-score': 0.2897955100637374, 'support': 5466217}}
[[1044835  872579   50256]
 [ 698200  765584   59952]
 [ 927694  974158   72959]]
Evaluating performance on  train set...
6073/6073 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1412287
{'0': {'precision': 0.37906911848195296, 'recall': 0.3042947628611154, 'f1-score': 0.3375909984874648, 'support': 517840}, '1': {'precision': 0.3294933406434327, 'recall': 0.6766494310711132, 'f1-score': 0.4431806056871481, 'support': 518694}, '2': {'precision': 0.3994488862343727, 'recall': 0.05680668700050191, 'f1-score': 0.09946779473676205, 'support': 518020}, 'accuracy': 0.34606517367682305, 'macro avg': {'precision': 0.36933711511991946, 'recall': 0.3459169603109102, 'f1-score': 0.2934131329704583, 'support': 1554554}, 'weighted avg': {'precision': 0.3693187134017403, 'recall': 0.34606517367682305, 'f1-score': 0.29347295158133835, 'support': 1554554}}
[[157576 344722  15542]
 [139020 350974  28700]
 [119096 369497  29427]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1539563
{'0': {'precision': 0.365629329365283, 'recall': 0.37102169923069916, 'f1-score': 0.3683057779156087, 'support': 153646}, '1': {'precision': 0.31345307891583124, 'recall': 0.5959722752824319, 'f1-score': 0.41082941832084763, 'support': 146584}, '2': {'precision': 0.3944373090039417, 'recall': 0.05673948637577009, 'f1-score': 0.09920798476122579, 'support': 156963}, 'accuracy': 0.33524572773423916, 'macro avg': {'precision': 0.3578399057616853, 'recall': 0.3412444869629671, 'f1-score': 0.29278106033256074, 'support': 457193}, 'weighted avg': {'precision': 0.35879104315385885, 'recall': 0.33524572773423916, 'f1-score': 0.28955323445643527, 'support': 457193}}
[[ 57006  90489   6151]
 [ 51702  87360   7522]
 [ 47204 100853   8906]]
training model: results/universal/W1/deepLOB_L1/h200
Epoch 1/50
10622/10622 - 168s - loss: 3.2484 - accuracy200: 0.3942 - val_loss: 3.3941 - val_accuracy200: 0.3353 - 168s/epoch - 16ms/step
Epoch 2/50
10622/10622 - 159s - loss: 3.2320 - accuracy200: 0.4047 - val_loss: 3.3945 - val_accuracy200: 0.3358 - 159s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 161s - loss: 3.2245 - accuracy200: 0.4096 - val_loss: 3.4299 - val_accuracy200: 0.3330 - 161s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 162s - loss: 3.2187 - accuracy200: 0.4125 - val_loss: 3.4613 - val_accuracy200: 0.3377 - 162s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 162s - loss: 3.2151 - accuracy200: 0.4142 - val_loss: 3.5507 - val_accuracy200: 0.3416 - 162s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 162s - loss: 3.2120 - accuracy200: 0.4157 - val_loss: 3.5415 - val_accuracy200: 0.3350 - 162s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 166s - loss: 3.2085 - accuracy200: 0.4174 - val_loss: 3.6533 - val_accuracy200: 0.3387 - 166s/epoch - 16ms/step
Epoch 8/50
10622/10622 - 166s - loss: 3.2060 - accuracy200: 0.4187 - val_loss: 3.7357 - val_accuracy200: 0.3376 - 166s/epoch - 16ms/step
Epoch 9/50
10622/10622 - 165s - loss: 3.2029 - accuracy200: 0.4202 - val_loss: 3.7522 - val_accuracy200: 0.3355 - 165s/epoch - 16ms/step
Epoch 10/50
10622/10622 - 166s - loss: 3.2005 - accuracy200: 0.4212 - val_loss: 3.6974 - val_accuracy200: 0.3367 - 166s/epoch - 16ms/step
Epoch 11/50
10622/10622 - 167s - loss: 3.1976 - accuracy200: 0.4226 - val_loss: 3.6905 - val_accuracy200: 0.3314 - 167s/epoch - 16ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 196s - 196s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1494039
{'0': {'precision': 0.35872585285781583, 'recall': 0.7232878888611745, 'f1-score': 0.479591071331955, 'support': 3235377}, '1': {'precision': 0.2834457834930147, 'recall': 0.2574301588361437, 'f1-score': 0.26981230761281105, 'support': 2575988}, '2': {'precision': 0.34157260586939375, 'recall': 0.01940801430171576, 'f1-score': 0.03672909651850654, 'support': 3235416}, 'accuracy': 0.3389093866647153, 'macro avg': {'precision': 0.3279147474067414, 'recall': 0.33337535399967794, 'f1-score': 0.26204415848775753, 'support': 9046781}, 'weighted avg': {'precision': 0.3311559973389094, 'recall': 0.3389093866647153, 'f1-score': 0.26147699328603147, 'support': 9046781}}
[[2340109  835800   59468]
 [1851277  663137   61574]
 [2332005  840618   62793]]
Evaluating performance on  train set...
10622/10622 - 59s - 59s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1345953
{'0': {'precision': 0.3367503014743066, 'recall': 0.7113714155487284, 'f1-score': 0.45711206008905503, 'support': 912692}, '1': {'precision': 0.32756506414551656, 'recall': 0.254977970405865, 'f1-score': 0.2867492023006036, 'support': 891528}, '2': {'precision': 0.3569830087028595, 'recall': 0.03768590847145448, 'f1-score': 0.06817475816520151, 'support': 914294}, 'accuracy': 0.3351238948925773, 'macro avg': {'precision': 0.3404327914408942, 'recall': 0.3346784314753493, 'f1-score': 0.27067867351828667, 'support': 2718514}, 'weighted avg': {'precision': 0.3405427213616278, 'recall': 0.3351238948925773, 'f1-score': 0.27043422822812285, 'support': 2718514}}
[[649263 231279  32150]
 [634294 227320  29914]
 [644468 235370  34456]]
Evaluating performance on  val set...
3064/3064 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1323364
{'0': {'precision': 0.34541708876725274, 'recall': 0.6410669896816049, 'f1-score': 0.4489388082751228, 'support': 269131}, '1': {'precision': 0.3136938982752693, 'recall': 0.319489065063989, 'f1-score': 0.31656496172195714, 'support': 245589}, '2': {'precision': 0.34563601240999825, 'recall': 0.04389016494584811, 'f1-score': 0.07788961295939635, 'support': 269058}, 'accuracy': 0.3353028536141612, 'macro avg': {'precision': 0.3349156664841734, 'recall': 0.33481540656381403, 'f1-score': 0.28113112765215875, 'support': 783778}, 'weighted avg': {'precision': 0.3355520970575264, 'recall': 0.3353028536141612, 'f1-score': 0.2800857465734622, 'support': 783778}}
[[172531  84665  11935]
 [156704  78463  10422]
 [170251  86998  11809]]
testing model out of sample: results/universal/W1/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 129s - 129s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1329223
{'0': {'precision': 0.3406505084422555, 'recall': 0.727390713236859, 'f1-score': 0.4640008480398455, 'support': 2058026}, '1': {'precision': 0.3272361285600166, 'recall': 0.2345306481520715, 'f1-score': 0.2732340341632163, 'support': 1982436}, '2': {'precision': 0.34605819360293083, 'recall': 0.04771816077259131, 'f1-score': 0.08387126517642259, 'support': 2058734}, 'accuracy': 0.3377773070417806, 'macro avg': {'precision': 0.3379816102017343, 'recall': 0.3365465073871739, 'f1-score': 0.2737020491264948, 'support': 6099196}, 'weighted avg': {'precision': 0.3381157211859272, 'recall': 0.3377773070417806, 'f1-score': 0.27368581371711254, 'support': 6099196}}
[[1496989  467041   93996]
 [1425849  464942   91645]
 [1471663  488832   98239]]
Evaluating performance on  train set...
6711/6711 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232076
{'0': {'precision': 0.33865311422558547, 'recall': 0.6557450106904487, 'f1-score': 0.44664221390594766, 'support': 576683}, '1': {'precision': 0.33606779344476606, 'recall': 0.2540846313374222, 'f1-score': 0.28938171840371474, 'support': 566575}, '2': {'precision': 0.342356096315044, 'recall': 0.10274380683599875, 'f1-score': 0.158054263233497, 'support': 574020}, 'accuracy': 0.3383796915816775, 'macro avg': {'precision': 0.33902566799513184, 'recall': 0.3375244829546232, 'f1-score': 0.2980260651810532, 'support': 1717278}, 'weighted avg': {'precision': 0.3390379136917163, 'recall': 0.3383796915816775, 'f1-score': 0.29829400197743183, 'support': 1717278}}
[[378157 139535  58991]
 [368317 143958  54300]
 [370176 144867  58977]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1215918
{'0': {'precision': 0.34126783066316724, 'recall': 0.6788416313915205, 'f1-score': 0.45419990604186755, 'support': 148830}, '1': {'precision': 0.3436759279054852, 'recall': 0.2516402591745617, 'f1-score': 0.29054375287317935, 'support': 146928}, '2': {'precision': 0.3693509648565828, 'recall': 0.09284846802456713, 'f1-score': 0.14839339389301123, 'support': 144095}, 'accuracy': 0.34416952936549255, 'macro avg': {'precision': 0.35143157447507845, 'recall': 0.3411101195302164, 'f1-score': 0.2977123509360194, 'support': 439853}, 'weighted avg': {'precision': 0.35127220970166306, 'recall': 0.34416952936549255, 'f1-score': 0.2993507618030912, 'support': 439853}}
[[101032  35624  12174]
 [ 99285  36973  10670]
 [ 95732  34984  13379]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1278487
{'0': {'precision': 0.36061138136495785, 'recall': 0.6079880938900303, 'f1-score': 0.4527101903155866, 'support': 61817}, '1': {'precision': 0.30333554301605525, 'recall': 0.3591103114292824, 'f1-score': 0.3288749430284332, 'support': 52243}, '2': {'precision': 0.30973451327433627, 'recall': 0.02013374559574315, 'f1-score': 0.03780973600702181, 'support': 55628}, 'accuracy': 0.33865093583517986, 'macro avg': {'precision': 0.32456047921844977, 'recall': 0.32907738363835193, 'f1-score': 0.27313162311701383, 'support': 169688}, 'weighted avg': {'precision': 0.3262987603133407, 'recall': 0.33865093583517986, 'f1-score': 0.2785693713048163, 'support': 169688}}
[[37584 22654  1579]
 [32565 18761   917]
 [34074 20434  1120]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1458241
{'0': {'precision': 0.3286653850045533, 'recall': 0.745, 'f1-score': 0.4561117742048726, 'support': 21800}, '1': {'precision': 0.33321303981715383, 'recall': 0.25181818181818183, 'f1-score': 0.2868534147983224, 'support': 22000}, '2': {'precision': 0.37136929460580914, 'recall': 0.007877480966421687, 'f1-score': 0.015427709545356601, 'support': 22723}, 'accuracy': 0.3301113900455482, 'macro avg': {'precision': 0.34441590647583875, 'recall': 0.33489855426153453, 'f1-score': 0.2527976328495172, 'support': 66523}, 'weighted avg': {'precision': 0.34475620086893927, 'recall': 0.3301113900455482, 'f1-score': 0.2496065367952205, 'support': 66523}}
[[16241  5406   153]
 [16310  5540   150]
 [16864  5680   179]]
Evaluating performance on  val set...
51/51 - 0s - 440ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113952
{'0': {'precision': 0.3278707577870758, 'recall': 0.6893939393939394, 'f1-score': 0.4443919344675489, 'support': 4092}, '1': {'precision': 0.40795559666975023, 'recall': 0.26089528692565567, 'f1-score': 0.3182583593937936, 'support': 5071}, '2': {'precision': 0.328, 'recall': 0.08903365906623235, 'f1-score': 0.14005123825789922, 'support': 3684}, 'accuracy': 0.3480968319452012, 'macro avg': {'precision': 0.35460878481894204, 'recall': 0.3464409617952758, 'f1-score': 0.3009005107064139, 'support': 12847}, 'weighted avg': {'precision': 0.35951910730731046, 'recall': 0.3480968319452012, 'f1-score': 0.307331571422841, 'support': 12847}}
[[2821 1002  269]
 [3345 1323  403]
 [2438  918  328]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
1645/1645 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093429
{'0': {'precision': 0.3330760996738941, 'recall': 0.7064040969325801, 'f1-score': 0.45269995939910684, 'support': 132587}, '1': {'precision': 0.4006970099737313, 'recall': 0.23228738184509726, 'f1-score': 0.2940889556297215, 'support': 164826}, '2': {'precision': 0.2619628575301613, 'recall': 0.0938129566251608, 'f1-score': 0.1381516630028774, 'support': 123597}, 'accuracy': 0.34094677086054964, 'macro avg': {'precision': 0.3319119890592623, 'recall': 0.34416814513427935, 'f1-score': 0.29498019267723524, 'support': 421010}, 'weighted avg': {'precision': 0.3386728806810959, 'recall': 0.34094677086054964, 'f1-score': 0.2982607700758663, 'support': 421010}}
[[ 93660  27689  11238]
 [105110  38287  21429]
 [ 82427  29575  11595]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1261846
{'0': {'precision': 0.3428158714395341, 'recall': 0.6517120054921479, 'f1-score': 0.4492930249068212, 'support': 58265}, '1': {'precision': 0.2984969881279607, 'recall': 0.292286254223376, 'f1-score': 0.2953589753481733, 'support': 52387}, '2': {'precision': 0.3467874794069193, 'recall': 0.02992926456474603, 'f1-score': 0.05510290893622591, 'support': 56266}, 'accuracy': 0.32931139841119594, 'macro avg': {'precision': 0.32936677965813804, 'recall': 0.32464250809342327, 'f1-score': 0.26658496973040685, 'support': 166918}, 'weighted avg': {'precision': 0.33024522689460484, 'recall': 0.32931139841119594, 'f1-score': 0.2681043926476856, 'support': 166918}}
[[37972 18517  1776]
 [35679 15312  1396]
 [37114 17468  1684]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1139106
{'0': {'precision': 0.3651306055470368, 'recall': 0.8094102212415767, 'f1-score': 0.5032442252790034, 'support': 16769}, '1': {'precision': 0.32835985853227234, 'recall': 0.208593695148494, 'f1-score': 0.2551200034348031, 'support': 14243}, '2': {'precision': 0.3188405797101449, 'recall': 0.0014399790548501113, 'f1-score': 0.0028670098390564933, 'support': 15278}, 'accuracy': 0.3578742709008425, 'macro avg': {'precision': 0.33744368126315133, 'recall': 0.33981463181497357, 'f1-score': 0.2537437461842877, 'support': 46290}, 'weighted avg': {'precision': 0.33853858211935645, 'recall': 0.3578742709008425, 'f1-score': 0.26174937997292314, 'support': 46290}}
[[13573  3174    22]
 [11247  2971    25]
 [12353  2903    22]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
1314/1314 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1316926
{'0': {'precision': 0.3352663084821233, 'recall': 0.748557200658041, 'f1-score': 0.463112319000044, 'support': 112455}, '1': {'precision': 0.33739314823404676, 'recall': 0.22321592971565352, 'f1-score': 0.268677508891539, 'support': 114051}, '2': {'precision': 0.34073388837496144, 'recall': 0.030202534644083855, 'f1-score': 0.05548674343867166, 'support': 109759}, 'accuracy': 0.3359017441601118, 'macro avg': {'precision': 0.33779778169704383, 'recall': 0.33399188833925947, 'f1-score': 0.2624255237767516, 'support': 336265}, 'weighted avg': {'precision': 0.33777232100797244, 'recall': 0.3359017441601118, 'f1-score': 0.26411432612024455, 'support': 336265}}
[[84179 25454  2822]
 [85001 25458  3592]
 [81901 24543  3315]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1303872
{'0': {'precision': 0.33655643720659717, 'recall': 0.7140024237082736, 'f1-score': 0.4574748180618201, 'support': 45385}, '1': {'precision': 0.3249554835508071, 'recall': 0.24938951990501154, 'f1-score': 0.2822014348366162, 'support': 44637}, '2': {'precision': 0.3528904227782571, 'recall': 0.027888898990817347, 'f1-score': 0.051692541023318515, 'support': 43996}, 'accuracy': 0.3340148338282917, 'macro avg': {'precision': 0.3381341145118871, 'recall': 0.33042694753470087, 'f1-score': 0.26378959797391827, 'support': 134018}, 'weighted avg': {'precision': 0.3380547304274873, 'recall': 0.3340148338282917, 'f1-score': 0.26588506841916504, 'support': 134018}}
[[32405 11701  1279]
 [32534 11132   971]
 [31345 11424  1227]]
Evaluating performance on  val set...
107/107 - 1s - 888ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1326737
{'0': {'precision': 0.3335153109335451, 'recall': 0.7438565419526234, 'f1-score': 0.4605420964260014, 'support': 9034}, '1': {'precision': 0.36049419032210617, 'recall': 0.2587626689189189, 'f1-score': 0.3012722020773155, 'support': 9472}, '2': {'precision': 0.2972972972972973, 'recall': 0.007617728531855956, 'f1-score': 0.014854827819041188, 'support': 8664}, 'accuracy': 0.33997055576002944, 'macro avg': {'precision': 0.33043559951764956, 'recall': 0.3367456464677994, 'f1-score': 0.2588897087741194, 'support': 27170}, 'weighted avg': {'precision': 0.33137144179199185, 'recall': 0.33997055576002944, 'f1-score': 0.262896202628377, 'support': 27170}}
[[6720 2229   85]
 [6950 2451   71]
 [6479 2119   66]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1304/1304 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1493566
{'0': {'precision': 0.33668380514967383, 'recall': 0.7361040761376663, 'f1-score': 0.4620378840275763, 'support': 112533}, '1': {'precision': 0.3143600047275736, 'recall': 0.24898666042593026, 'f1-score': 0.2778802204403583, 'support': 106825}, '2': {'precision': 0.3510981912144703, 'recall': 0.009503160434679978, 'f1-score': 0.01850543501391738, 'support': 114383}, 'accuracy': 0.3311579937736149, 'macro avg': {'precision': 0.3340473336972392, 'recall': 0.3315312989994255, 'f1-score': 0.25280784649395066, 'support': 333741}, 'weighted avg': {'precision': 0.3344785643826082, 'recall': 0.3311579937736149, 'f1-score': 0.25108024163951514, 'support': 333741}}
[[82836 28653  1044]
 [79262 26598   965]
 [83937 29359  1087]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1307235
{'0': {'precision': 0.3319793857466245, 'recall': 0.6339444478508799, 'f1-score': 0.435762077867341, 'support': 32618}, '1': {'precision': 0.3304911541163697, 'recall': 0.31884281224967653, 'f1-score': 0.3245625039202158, 'support': 32458}, '2': {'precision': 0.33519913885898817, 'recall': 0.04694000602954477, 'f1-score': 0.08234827449424831, 'support': 33170}, 'accuracy': 0.3316572684893024, 'macro avg': {'precision': 0.3325565595739941, 'recall': 0.33324242204336707, 'f1-score': 0.28089095209393505, 'support': 98246}, 'weighted avg': {'precision': 0.3325747706832356, 'recall': 0.3316572684893024, 'f1-score': 0.27970430829849063, 'support': 98246}}
[[20678 10365  1575]
 [20596 10349  1513]
 [21013 10600  1557]]
Evaluating performance on  val set...
93/93 - 1s - 666ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1371772
{'0': {'precision': 0.2997095326115659, 'recall': 0.6253443526170799, 'f1-score': 0.4052124241342378, 'support': 7260}, '1': {'precision': 0.3517877739331027, 'recall': 0.22539721640596133, 'f1-score': 0.2747541475865175, 'support': 8119}, '2': {'precision': 0.33405039950829746, 'recall': 0.1321580547112462, 'f1-score': 0.1893893196271452, 'support': 8225}, 'accuracy': 0.3159210303338417, 'macro avg': {'precision': 0.32851590201765535, 'recall': 0.32763320791142914, 'f1-score': 0.28978529711596684, 'support': 23604}, 'weighted avg': {'precision': 0.32958908148104454, 'recall': 0.3159210303338417, 'f1-score': 0.285133802635264, 'support': 23604}}
[[4540 1452 1268]
 [5390 1830  899]
 [5218 1920 1087]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176758
{'0': {'precision': 0.3523884008561826, 'recall': 0.6315581631501749, 'f1-score': 0.45236962920827933, 'support': 230438}, '1': {'precision': 0.31073464840422044, 'recall': 0.2727521128245936, 'f1-score': 0.29050712890749647, 'support': 208607}, '2': {'precision': 0.360170205594877, 'recall': 0.11235526817279765, 'f1-score': 0.17127973954420236, 'support': 228267}, 'accuracy': 0.34178914810463473, 'macro avg': {'precision': 0.34109775161842665, 'recall': 0.3388885147158554, 'f1-score': 0.30471883255332605, 'support': 667312}, 'weighted avg': {'precision': 0.3420290260577991, 'recall': 0.34178914810463473, 'f1-score': 0.3056178902253219, 'support': 667312}}
[[145535  61775  23128]
 [129276  56898  22433]
 [138185  64435  25647]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1305902
{'0': {'precision': 0.33627692203983955, 'recall': 0.6478150769430556, 'f1-score': 0.4427335256268028, 'support': 61604}, '1': {'precision': 0.33091571626285454, 'recall': 0.309518737607944, 'f1-score': 0.3198597893453449, 'support': 61027}, '2': {'precision': 0.31189061974672194, 'recall': 0.04485164950281229, 'f1-score': 0.07842529448233106, 'support': 62049}, 'accuracy': 0.3334416287632662, 'macro avg': {'precision': 0.326361086016472, 'recall': 0.33406182135127066, 'f1-score': 0.2803395364848263, 'support': 184680}, 'weighted avg': {'precision': 0.3263119882303436, 'recall': 0.3334416287632662, 'f1-score': 0.2797295352741287, 'support': 184680}}
[[39908 18591  3105]
 [39103 18889  3035]
 [39665 19601  2783]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1311542
{'0': {'precision': 0.3520239478152086, 'recall': 0.7688329430132709, 'f1-score': 0.4829298191847992, 'support': 20496}, '1': {'precision': 0.29513764747944227, 'recall': 0.1920102343431994, 'f1-score': 0.23265809406376606, 'support': 17197}, '2': {'precision': 0.4290352504638219, 'recall': 0.045309821209894685, 'f1-score': 0.08196358158699216, 'support': 20415}, 'accuracy': 0.3439285468438081, 'macro avg': {'precision': 0.3587322819194909, 'recall': 0.33538433285545494, 'f1-score': 0.26585049827851914, 'support': 58108}, 'weighted avg': {'precision': 0.36224477862503285, 'recall': 0.3439285468438081, 'f1-score': 0.26799128064508626, 'support': 58108}}
[[15758  4035   703]
 [13367  3302   528]
 [15639  3851   925]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
5343/5343 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1346833
{'0': {'precision': 0.3515512257788245, 'recall': 0.6837487246757032, 'f1-score': 0.464353740534655, 'support': 480270}, '1': {'precision': 0.28652709105051594, 'recall': 0.26203510482448833, 'f1-score': 0.2737343437191048, 'support': 402053}, '2': {'precision': 0.3729830462251716, 'recall': 0.05071003942603602, 'f1-score': 0.08928153713082694, 'support': 485466}, 'accuracy': 0.33510578020440285, 'macro avg': {'precision': 0.337020454351504, 'recall': 0.3321646229754092, 'f1-score': 0.27578987379486225, 'support': 1367789}, 'weighted avg': {'precision': 0.34004453264478535, 'recall': 0.33510578020440285, 'f1-score': 0.2751989055085471, 'support': 1367789}}
[[328384 129549  22337]
 [277653 105352  19048]
 [328063 132785  24618]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1412692
{'0': {'precision': 0.3308046644810557, 'recall': 0.7312271818298567, 'f1-score': 0.45552939562951444, 'support': 109014}, '1': {'precision': 0.3315871212999235, 'recall': 0.26191718619831006, 'f1-score': 0.2926629670357773, 'support': 109233}, '2': {'precision': 0.37162393162393165, 'recall': 0.009711426784597516, 'f1-score': 0.018928213834835225, 'support': 111930}, 'accuracy': 0.3313707496282297, 'macro avg': {'precision': 0.344671905801637, 'recall': 0.3342852649375881, 'f1-score': 0.2557068588333757, 'support': 330177}, 'weighted avg': {'precision': 0.34490125714801156, 'recall': 0.3313707496282297, 'f1-score': 0.2536402305063892, 'support': 330177}}
[[79714 28356   944]
 [79729 28610   894]
 [81527 29316  1087]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1266643
{'0': {'precision': 0.330415060104332, 'recall': 0.7212119211855177, 'f1-score': 0.45320115312026876, 'support': 30299}, '1': {'precision': 0.3547692307692308, 'recall': 0.245580404685836, 'f1-score': 0.29024543738200126, 'support': 32865}, '2': {'precision': 0.34377368022227833, 'recall': 0.04585579514824798, 'f1-score': 0.08091798210410536, 'support': 29680}, 'accuracy': 0.33695230709577356, 'macro avg': {'precision': 0.3429859903652804, 'recall': 0.33754937367320054, 'f1-score': 0.2747881908687918, 'support': 92844}, 'weighted avg': {'precision': 0.3433064011064705, 'recall': 0.33695230709577356, 'f1-score': 0.2765079460902195, 'support': 92844}}
[[21852  7098  1349]
 [23545  8071  1249]
 [20738  7581  1361]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
7177/7177 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1160086
{'0': {'precision': 0.36112269484687126, 'recall': 0.7511960321776954, 'f1-score': 0.4877629566193486, 'support': 649021}, '1': {'precision': 0.3085677186564579, 'recall': 0.17586917886324943, 'f1-score': 0.22404383968960484, 'support': 562111}, '2': {'precision': 0.34268688602307984, 'recall': 0.09122831120987544, 'f1-score': 0.14409610949336105, 'support': 625957}, 'accuracy': 0.3502851522163597, 'macro avg': {'precision': 0.3374590998421363, 'recall': 0.33943117408360673, 'f1-score': 0.2853009686007715, 'support': 1837089}, 'weighted avg': {'precision': 0.3387602759301593, 'recall': 0.3502851522163597, 'f1-score': 0.28997173084697886, 'support': 1837089}}
[[487542 105099  56380]
 [410099  98858  53154]
 [452432 116420  57105]]
Evaluating performance on  train set...
2257/2257 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152045
{'0': {'precision': 0.345830200682436, 'recall': 0.6101474414570686, 'f1-score': 0.4414484247826809, 'support': 196010}, '1': {'precision': 0.3356219970266524, 'recall': 0.24732332347166136, 'f1-score': 0.2847853643078273, 'support': 188947}, '2': {'precision': 0.33712358676149506, 'recall': 0.16192671505259115, 'f1-score': 0.21877279613938613, 'support': 192618}, 'accuracy': 0.34197463532874517, 'macro avg': {'precision': 0.33952526149019446, 'recall': 0.3397991599937737, 'f1-score': 0.31500219507663146, 'support': 577575}, 'weighted avg': {'precision': 0.3395870980267235, 'recall': 0.34197463532874517, 'f1-score': 0.3159368470212537, 'support': 577575}}
[[119595  44469  31946]
 [112834  46731  29382]
 [113391  48037  31190]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112348
{'0': {'precision': 0.34891949267867833, 'recall': 0.5686455413221674, 'f1-score': 0.4324740077049191, 'support': 56362}, '1': {'precision': 0.32616961481236567, 'recall': 0.2611367417939797, 'f1-score': 0.29005260891936446, 'support': 52888}, '2': {'precision': 0.36203226913834535, 'recall': 0.1950146085284219, 'f1-score': 0.2534852418036727, 'support': 54078}, 'accuracy': 0.345360256661442, 'macro avg': {'precision': 0.3457071255431298, 'recall': 0.34159896388152305, 'f1-score': 0.3253372861426521, 'support': 163328}, 'weighted avg': {'precision': 0.3458943970722442, 'recall': 0.345360256661442, 'f1-score': 0.3270925824662704, 'support': 163328}}
[[32050 14423  9889]
 [30382 13811  8695]
 [29423 14109 10546]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
5696/5696 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1456721
{'0': {'precision': 0.35182563725073845, 'recall': 0.728220103918428, 'f1-score': 0.4744363916338438, 'support': 511940}, '1': {'precision': 0.3001813550477155, 'recall': 0.2664068231841526, 'f1-score': 0.2822874329179857, 'support': 436160}, '2': {'precision': 0.3420587194906261, 'recall': 0.007585444105396098, 'f1-score': 0.014841759523590264, 'support': 509924}, 'accuracy': 0.3380390171903892, 'macro avg': {'precision': 0.3313552372630267, 'recall': 0.3340707904026589, 'f1-score': 0.2571885280251399, 'support': 1458024}, 'weighted avg': {'precision': 0.3329606831089836, 'recall': 0.3380390171903892, 'f1-score': 0.256219117420458, 'support': 1458024}}
[[372805 135260   3875]
 [316399 116196   3565]
 [370426 135630   3868]]
Evaluating performance on  train set...
2222/2222 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1191651
{'0': {'precision': 0.3456314843825599, 'recall': 0.6829767441860465, 'f1-score': 0.45898576218913933, 'support': 193500}, '1': {'precision': 0.32472108485781903, 'recall': 0.23441932107235638, 'f1-score': 0.2722782880397122, 'support': 184379}, '2': {'precision': 0.3516452505032642, 'recall': 0.09799203103701373, 'f1-score': 0.1532721316314941, 'support': 190740}, 'accuracy': 0.34129883102745423, 'macro avg': {'precision': 0.3406659399145477, 'recall': 0.3384626987651389, 'f1-score': 0.29484539395344855, 'support': 568619}, 'weighted avg': {'precision': 0.3408684131448611, 'recall': 0.34129883102745423, 'f1-score': 0.2958945618093376, 'support': 568619}}
[[132156  44693  16651]
 [123346  43222  17811]
 [126859  45190  18691]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1246083
{'0': {'precision': 0.37233929895160434, 'recall': 0.6428856382978724, 'f1-score': 0.47156364877798984, 'support': 60160}, '1': {'precision': 0.3052091748919878, 'recall': 0.37526182815435444, 'f1-score': 0.3366296357279146, 'support': 46309}, '2': {'precision': 0.33662714097496704, 'recall': 0.017811704834605598, 'f1-score': 0.03383321746615023, 'support': 57378}, 'accuracy': 0.348349374721539, 'macro avg': {'precision': 0.3380585382728531, 'recall': 0.34531972376227743, 'f1-score': 0.28067550065735153, 'support': 163847}, 'weighted avg': {'precision': 0.3408598021316426, 'recall': 0.348349374721539, 'f1-score': 0.2801365497273715, 'support': 163847}}
[[38676 20263  1221]
 [28138 17378   793]
 [37059 19297  1022]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
12066/12066 - 60s - 60s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1466417
{'0': {'precision': 0.3261831114298949, 'recall': 0.7389950164045425, 'f1-score': 0.4525960259287006, 'support': 1004295}, '1': {'precision': 0.3398953107681268, 'recall': 0.2537305437793661, 'f1-score': 0.2905595211818851, 'support': 1045424}, '2': {'precision': 0.3364429550463424, 'recall': 0.010724428195699643, 'f1-score': 0.020786274791419136, 'support': 1039123}, 'accuracy': 0.32975755962914255, 'macro avg': {'precision': 0.33417379241478806, 'recall': 0.3344833294598694, 'f1-score': 0.25464727396733494, 'support': 3088842}, 'weighted avg': {'precision': 0.33427556217979587, 'recall': 0.32975755962914255, 'f1-score': 0.25248857628593474, 'support': 3088842}}
[[742169 251563  10563]
 [768752 265256  11416]
 [764393 263586  11144]]
Evaluating performance on  train set...
2948/2948 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1246094
{'0': {'precision': 0.33534111910971454, 'recall': 0.6728097060551682, 'f1-score': 0.4475932651039947, 'support': 251884}, '1': {'precision': 0.34149719447105514, 'recall': 0.24956793778304076, 'f1-score': 0.2883836177505958, 'support': 249964}, '2': {'precision': 0.3548411372495899, 'recall': 0.09332077234259838, 'f1-score': 0.14777716837734073, 'support': 252634}, 'accuracy': 0.3385488321788989, 'macro avg': {'precision': 0.3438931502767865, 'recall': 0.3385661387269358, 'f1-score': 0.2945846837439771, 'support': 754482}, 'weighted avg': {'precision': 0.3439101304371835, 'recall': 0.3385488321788989, 'f1-score': 0.29445452876371553, 'support': 754482}}
[[169470  59998  22416]
 [167132  62383  20449]
 [168764  60294  23576]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1259489
{'0': {'precision': 0.3334376001342753, 'recall': 0.7427012881079428, 'f1-score': 0.46024641954507167, 'support': 58846}, '1': {'precision': 0.3637154168287604, 'recall': 0.2551203852327448, 'f1-score': 0.29988962160020377, 'support': 62300}, '2': {'precision': 0.394816652881169, 'recall': 0.025011352918573374, 'f1-score': 0.04704259128463724, 'support': 57254}, 'accuracy': 0.3421020179372197, 'macro avg': {'precision': 0.36398988994806825, 'recall': 0.34094434208642027, 'f1-score': 0.26905954414330424, 'support': 178400}, 'weighted avg': {'precision': 0.36370948503358624, 'recall': 0.3421020179372197, 'f1-score': 0.2716376723747343, 'support': 178400}}
[[43705 13876  1265]
 [45476 15894   930]
 [41893 13929  1432]]
testing model on single stock: results/universal/W1/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
21353/21353 - 126s - 126s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1571742
{'0': {'precision': 0.36537963675619484, 'recall': 0.7317880910709308, 'f1-score': 0.48740126074895906, 'support': 1998047}, '1': {'precision': 0.2683008226519978, 'recall': 0.2571760642346759, 'f1-score': 0.2626206835066658, 'support': 1466124}, '2': {'precision': 0.365222094516936, 'recall': 0.010792958803144383, 'f1-score': 0.02096632560486316, 'support': 2002046}, 'accuracy': 0.34041952597198394, 'macro avg': {'precision': 0.33296751797504287, 'recall': 0.3332523713695837, 'f1-score': 0.256996089953496, 'support': 5466217}, 'weighted avg': {'precision': 0.33928389521142244, 'recall': 0.34041952597198394, 'f1-score': 0.25627607944088504, 'support': 5466217}}
[[1462147  514733   21167]
 [1072683  377052   16389]
 [1466890  513548   21608]]
Evaluating performance on  train set...
6073/6073 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1400796
{'0': {'precision': 0.3339790542617581, 'recall': 0.7280774896734996, 'f1-score': 0.45790901213119095, 'support': 519295}, '1': {'precision': 0.3304339170450456, 'recall': 0.25233349770304697, 'f1-score': 0.2861503369529902, 'support': 513071}, '2': {'precision': 0.3699442688133494, 'recall': 0.02173738193907175, 'f1-score': 0.04106201989252465, 'support': 522188}, 'accuracy': 0.3337954165632072, 'macro avg': {'precision': 0.3447857467067177, 'recall': 0.33404945643853945, 'f1-score': 0.26170712299223525, 'support': 1554554}, 'weighted avg': {'precision': 0.3448900270290923, 'recall': 0.3337954165632072, 'f1-score': 0.26119864220162964, 'support': 1554554}}
[[378087 130158  11050]
 [375324 129465   8282]
 [378657 132180  11351]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1378636
{'0': {'precision': 0.3391456097842391, 'recall': 0.6082396228733276, 'f1-score': 0.43547606756684804, 'support': 154643}, '1': {'precision': 0.3091973008617268, 'recall': 0.33526549256176547, 'f1-score': 0.32170417417427416, 'support': 144053}, '2': {'precision': 0.3412117880850704, 'recall': 0.050915790204230996, 'f1-score': 0.08860926279728573, 'support': 158497}, 'accuracy': 0.3290207855325869, 'macro avg': {'precision': 0.3298515662436788, 'recall': 0.331473635213108, 'f1-score': 0.281929834846136, 'support': 457193}, 'weighted avg': {'precision': 0.3304257460000871, 'recall': 0.3290207855325869, 'f1-score': 0.2793789039741383, 'support': 457193}}
[[94060 52588  7995]
 [88171 48296  7586]
 [95113 55314  8070]]
training model: results/universal/W1/deepOF_L1/h50
Epoch 1/50
10622/10622 - 152s - loss: 3.1617 - accuracy50: 0.4414 - val_loss: 3.4416 - val_accuracy50: 0.3671 - 152s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 141s - loss: 3.1439 - accuracy50: 0.4471 - val_loss: 3.4920 - val_accuracy50: 0.3696 - 141s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 139s - loss: 3.1308 - accuracy50: 0.4517 - val_loss: 3.5145 - val_accuracy50: 0.3715 - 139s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 143s - loss: 3.1201 - accuracy50: 0.4549 - val_loss: 3.5331 - val_accuracy50: 0.3732 - 143s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 143s - loss: 3.1109 - accuracy50: 0.4575 - val_loss: 3.5343 - val_accuracy50: 0.3743 - 143s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 144s - loss: 3.1020 - accuracy50: 0.4603 - val_loss: 3.5359 - val_accuracy50: 0.3769 - 144s/epoch - 14ms/step
Epoch 7/50
10622/10622 - 143s - loss: 3.0946 - accuracy50: 0.4620 - val_loss: 3.5309 - val_accuracy50: 0.3788 - 143s/epoch - 13ms/step
Epoch 8/50
10622/10622 - 142s - loss: 3.0872 - accuracy50: 0.4642 - val_loss: 3.5204 - val_accuracy50: 0.3811 - 142s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 143s - loss: 3.0804 - accuracy50: 0.4657 - val_loss: 3.5159 - val_accuracy50: 0.3828 - 143s/epoch - 13ms/step
Epoch 10/50
10622/10622 - 142s - loss: 3.0743 - accuracy50: 0.4675 - val_loss: 3.5174 - val_accuracy50: 0.3833 - 142s/epoch - 13ms/step
Epoch 11/50
10622/10622 - 143s - loss: 3.0695 - accuracy50: 0.4687 - val_loss: 3.5081 - val_accuracy50: 0.3847 - 143s/epoch - 13ms/step
testing model in sample: results/universal/W1/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 175s - 175s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1632752
{'0': {'precision': 0.5084089112618048, 'recall': 0.03090223527169407, 'f1-score': 0.058263108007400505, 'support': 3163687}, '1': {'precision': 0.3007844224662194, 'recall': 0.955118651607769, 'f1-score': 0.4574951967887808, 'support': 2715471}, '2': {'precision': 0.5138313989373411, 'recall': 0.03758242049654028, 'f1-score': 0.07004187061911034, 'support': 3167598}, 'accuracy': 0.31065367519583814, 'macro avg': {'precision': 0.4410082442217884, 'recall': 0.3412011024586678, 'f1-score': 0.19526672513843057, 'support': 9046756}, 'weighted avg': {'precision': 0.44798702997107653, 'recall': 0.31065367519583814, 'f1-score': 0.1822206397731064, 'support': 9046756}}
[[  97765 3018358   47564]
 [  56801 2593597   65073]
 [  37730 3010822  119046]]
Evaluating performance on  train set...
10622/10622 - 57s - 57s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104917
{'0': {'precision': 0.5144021777860126, 'recall': 0.042645152676310624, 'f1-score': 0.07876084565562752, 'support': 846333}, '1': {'precision': 0.37942686099654527, 'recall': 0.9556886356432002, 'f1-score': 0.5431948622045164, 'support': 1022108}, '2': {'precision': 0.5132893063036241, 'recall': 0.04461867846177374, 'f1-score': 0.08210060132212946, 'support': 850070}, 'accuracy': 0.3865491072134709, 'macro avg': {'precision': 0.46903944836206063, 'recall': 0.3476508222604282, 'f1-score': 0.23468543639409112, 'support': 2718511}, 'weighted avg': {'precision': 0.463306055771394, 'recall': 0.3865491072134709, 'f1-score': 0.25442346018474843, 'support': 2718511}}
[[ 36092 797023  13218]
 [ 22544 976817  22747]
 [ 11527 800614  37929]]
Evaluating performance on  val set...
3064/3064 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1170068
{'0': {'precision': 0.5198103623433796, 'recall': 0.04253592494358893, 'f1-score': 0.0786370073294521, 'support': 252610}, '1': {'precision': 0.3591563166969318, 'recall': 0.9542612984629503, 'f1-score': 0.5218888024136397, 'support': 278976}, '2': {'precision': 0.5039992687051511, 'recall': 0.043724969269201795, 'f1-score': 0.08046878705727391, 'support': 252190}, 'accuracy': 0.36743661454293064, 'macro avg': {'precision': 0.46098864924848754, 'recall': 0.3468407308919137, 'f1-score': 0.22699819893345521, 'support': 783776}, 'weighted avg': {'precision': 0.45753999077945284, 'recall': 0.36743661454293064, 'f1-score': 0.23699675464879547, 'support': 783776}}
[[ 10745 237477   4388]
 [  6296 266216   6464]
 [  3630 237533  11027]]
testing model out of sample: results/universal/W1/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 143s - 143s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0875275
{'0': {'precision': 0.46946075485803235, 'recall': 0.05439354169544748, 'f1-score': 0.09749135708821936, 'support': 1824132}, '1': {'precision': 0.40966425415769625, 'recall': 0.9381184871050147, 'f1-score': 0.5702901492437371, 'support': 2469332}, '2': {'precision': 0.5201092971182966, 'recall': 0.06714876776797121, 'f1-score': 0.11894157098693223, 'support': 1805707}, 'accuracy': 0.41595784082787646, 'macro avg': {'precision': 0.4664114353780084, 'recall': 0.35322026552281116, 'f1-score': 0.2622410257729629, 'support': 6099171}, 'weighted avg': {'precision': 0.4602462262986252, 'recall': 0.41595784082787646, 'f1-score': 0.29526085533960006, 'support': 6099171}}
[[  99221 1691052   33859]
 [  74790 2316526   78016]
 [  37340 1647116  121251]]
Evaluating performance on  train set...
6711/6711 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0756154
{'0': {'precision': 0.5136770120988953, 'recall': 0.03899238720059417, 'f1-score': 0.07248272828997544, 'support': 500867}, '1': {'precision': 0.42227334593734234, 'recall': 0.963907131676721, 'f1-score': 0.5872717099097975, 'support': 718092}, '2': {'precision': 0.5157758212156736, 'recall': 0.041497847746907075, 'f1-score': 0.0768153519264201, 'support': 498315}, 'accuracy': 0.4264799909624207, 'macro avg': {'precision': 0.4839087264173037, 'recall': 0.34813245554140737, 'f1-score': 0.24552326337539768, 'support': 1717274}, 'weighted avg': {'precision': 0.47606485854841085, 'recall': 0.4264799909624207, 'f1-score': 0.289003132568347, 'support': 1717274}}
[[ 19530 474837   6500]
 [ 13004 692174  12914]
 [  5486 472150  20679]]
Evaluating performance on  val set...
1720/1720 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0491253
{'0': {'precision': 0.5125468704932218, 'recall': 0.04413481360057621, 'f1-score': 0.08127143837182711, 'support': 120789}, '1': {'precision': 0.46149328014345925, 'recall': 0.9610246323125617, 'f1-score': 0.6235512480807479, 'support': 200306}, '2': {'precision': 0.505353666450357, 'recall': 0.05246050725858062, 'f1-score': 0.0950535534466449, 'support': 118756}, 'accuracy': 0.4639298307836063, 'macro avg': {'precision': 0.493131272362346, 'recall': 0.3525399843905728, 'f1-score': 0.26662541329974, 'support': 439851}, 'weighted avg': {'precision': 0.48735521102691615, 'recall': 0.4639298307836063, 'f1-score': 0.3319440716530523, 'support': 439851}}
[[  5331 113565   1893]
 [  3602 192499   4205]
 [  1468 111058   6230]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
663/663 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2008915
{'0': {'precision': 0.40150801131008484, 'recall': 0.007020782174464789, 'f1-score': 0.013800252680682886, 'support': 60677}, '1': {'precision': 0.2861805268610507, 'recall': 0.9864792337544381, 'f1-score': 0.44365533599773477, 'support': 48444}, '2': {'precision': 0.44580526638089407, 'recall': 0.012020739077309203, 'f1-score': 0.023410241980866626, 'support': 60562}, 'accuracy': 0.288437851758868, 'macro avg': {'precision': 0.37783126818400986, 'recall': 0.33517358500207073, 'f1-score': 0.16028861021976143, 'support': 169683}, 'weighted avg': {'precision': 0.3843926002491615, 'recall': 0.288437851758868, 'f1-score': 0.13995254741974922, 'support': 169683}}
[[  426 59732   519]
 [  269 47789   386]
 [  366 59468   728]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1592656
{'0': {'precision': 0.48819641170915956, 'recall': 0.02372756895681307, 'f1-score': 0.04525560224089636, 'support': 21789}, '1': {'precision': 0.3314119701441795, 'recall': 0.9775731607256815, 'f1-score': 0.49500859790649626, 'support': 21938}, '2': {'precision': 0.4555112881806109, 'recall': 0.015046499385857169, 'f1-score': 0.02913074865174742, 'support': 22796}, 'accuracy': 0.33531259865009094, 'macro avg': {'precision': 0.42503989001131665, 'recall': 0.33878240968945056, 'f1-score': 0.18979831626638002, 'support': 66523}, 'weighted avg': {'precision': 0.4252914441789921, 'recall': 0.33531259865009094, 'f1-score': 0.18804980960517173, 'support': 66523}}
[[  517 21071   201]
 [  283 21446   209]
 [  259 22194   343]]
Evaluating performance on  val set...
51/51 - 0s - 402ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1323794
{'0': {'precision': 0.5242718446601942, 'recall': 0.026399413346370082, 'f1-score': 0.05026762857807773, 'support': 4091}, '1': {'precision': 0.3793737018693082, 'recall': 0.9785699567277972, 'f1-score': 0.5467733578953429, 'support': 4853}, '2': {'precision': 0.36585365853658536, 'recall': 0.011529592621060722, 'f1-score': 0.022354694485842024, 'support': 3903}, 'accuracy': 0.38156768117070133, 'macro avg': {'precision': 0.42316640168869596, 'recall': 0.338832987565076, 'f1-score': 0.2064652269864209, 'support': 12847}, 'weighted avg': {'precision': 0.4214076065186347, 'recall': 0.38156768117070133, 'f1-score': 0.229344309718787, 'support': 12847}}
[[ 108 3950   33]
 [  59 4749   45]
 [  39 3819   45]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
1645/1645 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8986407
{'0': {'precision': 0.521455938697318, 'recall': 0.07395332409596, 'f1-score': 0.12953577462107693, 'support': 73614}, '1': {'precision': 0.6721525142493345, 'recall': 0.9704591266208035, 'f1-score': 0.7942188228848134, 'support': 276329}, '2': {'precision': 0.5809983619277523, 'recall': 0.094832681320537, 'f1-score': 0.16305149949794945, 'support': 71062}, 'accuracy': 0.6659042054132374, 'macro avg': {'precision': 0.591535604958135, 'recall': 0.3797483773457668, 'f1-score': 0.36226869900127995, 'support': 421005}, 'weighted avg': {'precision': 0.6304167294368918, 'recall': 0.6659042054132374, 'f1-score': 0.5714613966086314, 'support': 421005}}
[[  5444  67536    634]
 [  3937 268166   4226]
 [  1059  63264   6739]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98360753
{'0': {'precision': 0.594488188976378, 'recall': 0.08287182557501373, 'f1-score': 0.14546569164075843, 'support': 40086}, '1': {'precision': 0.5366273839223619, 'recall': 0.9621672329569505, 'f1-score': 0.6889873759922668, 'support': 87411}, '2': {'precision': 0.5659352596132957, 'recall': 0.0660815301489054, 'f1-score': 0.118344539342177, 'support': 39421}, 'accuracy': 0.5393726260798716, 'macro avg': {'precision': 0.5656836108373452, 'recall': 0.3703735295602899, 'f1-score': 0.3175992023250674, 'support': 166918}, 'weighted avg': {'precision': 0.5574445156817144, 'recall': 0.5393726260798716, 'f1-score': 0.4236899155476308, 'support': 166918}}
[[ 3322 36230   534]
 [ 1843 84104  1464]
 [  423 36393  2605]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9517889
{'0': {'precision': 0.6005665722379604, 'recall': 0.08190862551917319, 'f1-score': 0.14415639609009775, 'support': 10353}, '1': {'precision': 0.5829035316973888, 'recall': 0.964080789534083, 'f1-score': 0.726531082892518, 'support': 26142}, '2': {'precision': 0.6142595978062158, 'recall': 0.10290964777947932, 'f1-score': 0.17628541448058763, 'support': 9795}, 'accuracy': 0.5845538993303089, 'macro avg': {'precision': 0.599243233913855, 'recall': 0.3829663542775785, 'f1-score': 0.3489909644877345, 'support': 46290}, 'weighted avg': {'precision': 0.593488930838726, 'recall': 0.5845538993303089, 'f1-score': 0.4798475345114354, 'support': 46290}}
[[  848  9379   126]
 [  432 25203   507]
 [  132  8655  1008]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.183163
{'0': {'precision': 0.5377456767831099, 'recall': 0.06190388628168947, 'f1-score': 0.11102667049039291, 'support': 125081}, '1': {'precision': 0.251243975766113, 'recall': 0.9061945029226011, 'f1-score': 0.3934134106023667, 'support': 85027}, '2': {'precision': 0.519791872488968, 'recall': 0.06255945208954278, 'f1-score': 0.11167792832631689, 'support': 126152}, 'accuracy': 0.2756378992446321, 'macro avg': {'precision': 0.4362605083460636, 'recall': 0.34355261376461105, 'f1-score': 0.20537266980635882, 'support': 336260}, 'weighted avg': {'precision': 0.4585650176155408, 'recall': 0.2756378992446321, 'f1-score': 0.18267555775030572, 'support': 336260}}
[[  7743 114231   3107]
 [  3792  77051   4184]
 [  2864 115396   7892]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1355044
{'0': {'precision': 0.5416666666666666, 'recall': 0.05417627238872141, 'f1-score': 0.0985007254554248, 'support': 45112}, '1': {'precision': 0.33070480048873024, 'recall': 0.9323316790173817, 'f1-score': 0.48823065192753856, 'support': 44127}, '2': {'precision': 0.4974519796158369, 'recall': 0.05667835369257911, 'f1-score': 0.10176219402177183, 'support': 44779}, 'accuracy': 0.34415526272590247, 'macro avg': {'precision': 0.45660781559041125, 'recall': 0.34772876836622735, 'f1-score': 0.2294978571349117, 'support': 134018}, 'weighted avg': {'precision': 0.45743168524414946, 'recall': 0.34415526272590247, 'f1-score': 0.227913623471866, 'support': 134018}}
[[ 2444 41633  1035]
 [ 1457 41141  1529]
 [  611 41630  2538]]
Evaluating performance on  val set...
107/107 - 1s - 832ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1910632
{'0': {'precision': 0.5460358056265985, 'recall': 0.042135385829879614, 'f1-score': 0.07823378526932943, 'support': 10134}, '1': {'precision': 0.2512264598828929, 'recall': 0.9213580963435868, 'f1-score': 0.3948022879880627, 'support': 6892}, '2': {'precision': 0.5152877697841727, 'recall': 0.05648659305993691, 'f1-score': 0.10181236673773988, 'support': 10144}, 'accuracy': 0.27051895472948106, 'macro avg': {'precision': 0.4375166784312214, 'recall': 0.3399933584111345, 'f1-score': 0.191616146665044, 'support': 27170}, 'weighted avg': {'precision': 0.45977396954079847, 'recall': 0.27051895472948106, 'f1-score': 0.1673383583702888, 'support': 27170}}
[[ 427 9468  239]
 [ 242 6350  300]
 [ 113 9458  573]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1487842
{'0': {'precision': 0.4830494181143532, 'recall': 0.02491474702484515, 'f1-score': 0.04738544518989749, 'support': 114952}, '1': {'precision': 0.32084620290362514, 'recall': 0.9622438073093439, 'f1-score': 0.48123244571358903, 'support': 106658}, '2': {'precision': 0.4850586306896987, 'recall': 0.03430961596775057, 'f1-score': 0.06408622570945469, 'support': 112126}, 'accuracy': 0.3276302226909893, 'macro avg': {'precision': 0.42965141723589234, 'recall': 0.34048939010064655, 'f1-score': 0.1975680388709804, 'support': 333736}, 'weighted avg': {'precision': 0.4318862665253048, 'recall': 0.3276302226909893, 'f1-score': 0.19164871046062573, 'support': 333736}}
[[  2864 110290   1798]
 [  1741 102631   2286]
 [  1324 106955   3847]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1500171
{'0': {'precision': 0.4656643640796424, 'recall': 0.03402511801906119, 'f1-score': 0.06341652371202479, 'support': 33681}, '1': {'precision': 0.3251194502603747, 'recall': 0.9489188342212472, 'f1-score': 0.4843056499660122, 'support': 31910}, '2': {'precision': 0.4356360890902227, 'recall': 0.03534023396827341, 'f1-score': 0.06537688015182846, 'support': 32654}, 'accuracy': 0.33161992976741816, 'macro avg': {'precision': 0.40880663447674664, 'recall': 0.3394280620695273, 'f1-score': 0.20436635127662184, 'support': 98245}, 'weighted avg': {'precision': 0.41003474942772783, 'recall': 0.33161992976741816, 'f1-score': 0.20077298457975434, 'support': 98245}}
[[ 1146 31904   631]
 [  766 30280   864]
 [  549 30951  1154]]
Evaluating performance on  val set...
93/93 - 1s - 765ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1564319
{'0': {'precision': 0.4497936726272352, 'recall': 0.04051040634291377, 'f1-score': 0.07432662802591204, 'support': 8072}, '1': {'precision': 0.31050310503105033, 'recall': 0.940567066521265, 'f1-score': 0.46687867920698284, 'support': 7336}, '2': {'precision': 0.4442748091603053, 'recall': 0.035505124450951685, 'f1-score': 0.0657552818890521, 'support': 8196}, 'accuracy': 0.3185053380782918, 'macro avg': {'precision': 0.40152386227286363, 'recall': 0.3388608657717102, 'f1-score': 0.20232019637398233, 'support': 23604}, 'weighted avg': {'precision': 0.404586580233549, 'recall': 0.3185053380782918, 'f1-score': 0.19335353425056173, 'support': 23604}}
[[ 327 7575  170]
 [ 242 6900  194]
 [ 158 7747  291]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1702613
{'0': {'precision': 0.4174599593954433, 'recall': 0.03959840972991942, 'f1-score': 0.07233540236714146, 'support': 233671}, '1': {'precision': 0.3040837115448874, 'recall': 0.9215488678929931, 'f1-score': 0.4572789673189222, 'support': 203426}, '2': {'precision': 0.4314690685658428, 'recall': 0.05368576517093089, 'f1-score': 0.09549012184474646, 'support': 230210}, 'accuracy': 0.3133175584850751, 'macro avg': {'precision': 0.3843375798353912, 'recall': 0.33827768093128113, 'f1-score': 0.20836816384360338, 'support': 667307}, 'weighted avg': {'precision': 0.38773055512854737, 'recall': 0.3133175584850751, 'f1-score': 0.19767198300367067, 'support': 667307}}
[[  9253 217096   7322]
 [  6996 187467   8963]
 [  5916 211935  12359]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.148484
{'0': {'precision': 0.45513115508513574, 'recall': 0.04808752025931929, 'f1-score': 0.08698456441753763, 'support': 61700}, '1': {'precision': 0.3266155827506513, 'recall': 0.9159726230724828, 'f1-score': 0.4815286845094112, 'support': 60635}, '2': {'precision': 0.4519906323185012, 'recall': 0.05881881175413833, 'f1-score': 0.10409185744496643, 'support': 62344}, 'accuracy': 0.33665982596830174, 'macro avg': {'precision': 0.4112457900514294, 'recall': 0.3409596516953135, 'f1-score': 0.22420170212397175, 'support': 184679}, 'weighted avg': {'precision': 0.41187591502067505, 'recall': 0.33665982596830174, 'f1-score': 0.22229891958662984, 'support': 184679}}
[[ 2967 57145  1588]
 [ 2237 55540  2858]
 [ 1315 57362  3667]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1697496
{'0': {'precision': 0.41715686274509806, 'recall': 0.04171364148816235, 'f1-score': 0.07584332249008512, 'support': 20401}, '1': {'precision': 0.29885767790262174, 'recall': 0.9121513488797439, 'f1-score': 0.4502087564883774, 'support': 17496}, '2': {'precision': 0.43457067866516685, 'recall': 0.05734784760019792, 'f1-score': 0.10132447436289724, 'support': 20210}, 'accuracy': 0.30923985062040715, 'macro avg': {'precision': 0.3835284064376289, 'recall': 0.3370709459893681, 'f1-score': 0.20912551778045327, 'support': 58107}, 'weighted avg': {'precision': 0.38759365489992664, 'recall': 0.30923985062040715, 'f1-score': 0.19742715425878174, 'support': 58107}}
[[  851 18900   650]
 [  679 15959   858]
 [  510 18541  1159]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/EXC
Evaluating performance on  test set...
5343/5343 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0104045
{'0': {'precision': 0.5024272270026814, 'recall': 0.08278205931525559, 'f1-score': 0.1421438841786901, 'support': 346319}, '1': {'precision': 0.5036127289541364, 'recall': 0.9311705405397376, 'f1-score': 0.6536866536063519, 'support': 673142}, '2': {'precision': 0.5178376906318083, 'recall': 0.09826224510009388, 'f1-score': 0.16518065050106295, 'support': 348323}, 'accuracy': 0.504250671158604, 'macro avg': {'precision': 0.507959215529542, 'recall': 0.3707382816516957, 'f1-score': 0.320337062762035, 'support': 1367784}, 'weighted avg': {'precision': 0.5069351245049879, 'recall': 0.504250671158604, 'f1-score': 0.39976143084818105, 'support': 1367784}}
[[ 28669 310033   7617]
 [ 22080 626810  24252]
 [  6312 307784  34227]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95562285
{'0': {'precision': 0.5020253327332348, 'recall': 0.11085240502016014, 'f1-score': 0.18160462384723627, 'support': 70436}, '1': {'precision': 0.5873748727305719, 'recall': 0.9322222814783212, 'f1-score': 0.7206698728321793, 'support': 187510}, '2': {'precision': 0.555353262465496, 'recall': 0.13091331976575155, 'f1-score': 0.2118801676040243, 'support': 72231}, 'accuracy': 0.5817031470998888, 'macro avg': {'precision': 0.5482511559764343, 'recall': 0.39132933542141096, 'f1-score': 0.37138488809447995, 'support': 330177}, 'weighted avg': {'precision': 0.5621622348717594, 'recall': 0.5817031470998888, 'f1-score': 0.4943670441195849, 'support': 330177}}
[[  7808  61334   1294]
 [  6432 174801   6277]
 [  1313  61462   9456]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95826894
{'0': {'precision': 0.4836856617647059, 'recall': 0.10624873813850191, 'f1-score': 0.17422612150306238, 'support': 19812}, '1': {'precision': 0.5922661763833699, 'recall': 0.9348973936488916, 'f1-score': 0.725145774182539, 'support': 53408}, '2': {'precision': 0.529973728206353, 'recall': 0.1130758255197717, 'f1-score': 0.18638444416446182, 'support': 19624}, 'accuracy': 0.5843673258368877, 'macro avg': {'precision': 0.535308522118143, 'recall': 0.38474065243572175, 'f1-score': 0.36191877995002103, 'support': 92844}, 'weighted avg': {'precision': 0.5559296962807165, 'recall': 0.5843673258368877, 'f1-score': 0.4937094670527241, 'support': 92844}}
[[ 2105 17355   352]
 [ 1861 49931  1616]
 [  386 17019  2219]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/AAL
Evaluating performance on  test set...
7177/7177 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99395996
{'0': {'precision': 0.5015066653565229, 'recall': 0.07031897622661526, 'f1-score': 0.12334331556402287, 'support': 435487}, '1': {'precision': 0.5433714074059244, 'recall': 0.9464642330735217, 'f1-score': 0.6903870311748304, 'support': 974937}, '2': {'precision': 0.5186855256227438, 'recall': 0.09463038484976327, 'f1-score': 0.1600591475537214, 'support': 426660}, 'accuracy': 0.5409338930609596, 'macro avg': {'precision': 0.5211878661283971, 'recall': 0.3704711980499667, 'f1-score': 0.3245964980975249, 'support': 1837084}, 'weighted avg': {'precision': 0.527713969181826, 'recall': 0.5409338930609596, 'f1-score': 0.4327995384929573, 'support': 1837084}}
[[ 30623 396260   8604]
 [ 23332 922743  28862]
 [  7107 379178  40375]]
Evaluating performance on  train set...
2257/2257 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98574924
{'0': {'precision': 0.5221365084688915, 'recall': 0.046243418463206516, 'f1-score': 0.08496210338170182, 'support': 134657}, '1': {'precision': 0.5463477208260312, 'recall': 0.9720064157990659, 'f1-score': 0.6995120269906095, 'support': 311107}, '2': {'precision': 0.5356966606349729, 'recall': 0.04941203247098096, 'f1-score': 0.09047843965325629, 'support': 131810}, 'accuracy': 0.5456235910896267, 'macro avg': {'precision': 0.5347269633099653, 'recall': 0.35588728891108445, 'f1-score': 0.29165085667518925, 'support': 577574}, 'weighted avg': {'precision': 0.5382723478588292, 'recall': 0.5456235910896267, 'f1-score': 0.41724487817445577, 'support': 577574}}
[[  6227 127038   1392]
 [  4456 302398   4253]
 [  1243 124054   6513]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96861875
{'0': {'precision': 0.534549356223176, 'recall': 0.06906207546646705, 'f1-score': 0.12232070514866557, 'support': 36069}, '1': {'precision': 0.5718226459636241, 'recall': 0.9584526594232997, 'f1-score': 0.7162958636436044, 'support': 91486}, '2': {'precision': 0.509015777610819, 'recall': 0.07575757575757576, 'f1-score': 0.13188631496982675, 'support': 35772}, 'accuracy': 0.5687118480104331, 'macro avg': {'precision': 0.538462593265873, 'recall': 0.3677574368824475, 'f1-score': 0.3235009612540322, 'support': 163327}, 'weighted avg': {'precision': 0.5498352367638913, 'recall': 0.5687118480104331, 'f1-score': 0.45712506906026973, 'support': 163327}}
[[ 2491 32969   609]
 [ 1796 87685  2005]
 [  373 32689  2710]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/WBA
Evaluating performance on  test set...
5696/5696 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1974353
{'0': {'precision': 0.5136659043047033, 'recall': 0.04148166570356445, 'f1-score': 0.07676415597160767, 'support': 546844}, '1': {'precision': 0.2584182440015437, 'recall': 0.9385960907941129, 'f1-score': 0.40525889550208954, 'support': 372403}, '2': {'precision': 0.5458210904342148, 'recall': 0.062061502824942646, 'f1-score': 0.1114507226281265, 'support': 538772}, 'accuracy': 0.27822476936171614, 'macro avg': {'precision': 0.43930174624682056, 'recall': 0.34737975310754, 'f1-score': 0.19782459136727457, 'support': 1458019}, 'weighted avg': {'precision': 0.4603533751137199, 'recall': 0.27822476936171614, 'f1-score': 0.17348482790800632, 'support': 1458019}}
[[ 22684 509213  14947]
 [  9991 349536  12876]
 [ 11486 493849  33437]]
Evaluating performance on  train set...
2222/2222 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1143539
{'0': {'precision': 0.5637308964865291, 'recall': 0.058841909648560196, 'f1-score': 0.10656103880632575, 'support': 182421}, '1': {'precision': 0.36959210300234696, 'recall': 0.9502133505502454, 'f1-score': 0.532186542471772, 'support': 205999}, '2': {'precision': 0.5206433510371781, 'recall': 0.05766434699608209, 'f1-score': 0.10382901336957173, 'support': 180198}, 'accuracy': 0.3813948907702535, 'macro avg': {'precision': 0.48465545017535144, 'recall': 0.3555732023982959, 'f1-score': 0.24752553154922316, 'support': 568618}, 'weighted avg': {'precision': 0.4797436030244329, 'recall': 0.3813948907702535, 'f1-score': 0.25989090632709727, 'support': 568618}}
[[ 10734 167270   4417]
 [  5106 195743   5150]
 [  3201 166606  10391]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.115439
{'0': {'precision': 0.5687830687830688, 'recall': 0.05271496199619019, 'f1-score': 0.09648744282385432, 'support': 53021}, '1': {'precision': 0.3688799463447351, 'recall': 0.9552636460212806, 'f1-score': 0.5322347281985756, 'support': 59303}, '2': {'precision': 0.5288300055980594, 'recall': 0.05500562866348356, 'f1-score': 0.09964663068511453, 'support': 51522}, 'accuracy': 0.38010692967786824, 'macro avg': {'precision': 0.4888310069086211, 'recall': 0.35432807889365137, 'f1-score': 0.2427896005691815, 'support': 163846}, 'weighted avg': {'precision': 0.4838660333267344, 'recall': 0.38010692967786824, 'f1-score': 0.25519677318019474, 'support': 163846}}
[[ 2795 49011  1215]
 [ 1343 56650  1310]
 [  776 47912  2834]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
12066/12066 - 59s - 59s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1087315
{'0': {'precision': 0.45355147574764404, 'recall': 0.05268588219756999, 'f1-score': 0.0944053584617532, 'support': 969216}, '1': {'precision': 0.3773128222878104, 'recall': 0.9342486984858721, 'f1-score': 0.5375333258274883, 'support': 1157498}, '2': {'precision': 0.5447526243682916, 'recall': 0.062404702932992974, 'f1-score': 0.11198127459574389, 'support': 962123}, 'accuracy': 0.38606634147415353, 'macro avg': {'precision': 0.458538974134582, 'recall': 0.3497797612054783, 'f1-score': 0.24797331962832847, 'support': 3088837}, 'weighted avg': {'precision': 0.45338980771915727, 'recall': 0.38606634147415353, 'f1-score': 0.2659359148260052, 'support': 3088837}}
[[  51064  903688   14464]
 [  40395 1081391   35712]
 [  21128  880954   60041]]
Evaluating performance on  train set...
2948/2948 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1085664
{'0': {'precision': 0.5208170236993809, 'recall': 0.030798496689940197, 'f1-score': 0.05815783199554956, 'support': 237609}, '1': {'precision': 0.37375853913062634, 'recall': 0.9685998180423497, 'f1-score': 0.5393827230399535, 'support': 280285}, '2': {'precision': 0.54482121276747, 'recall': 0.032394139974470174, 'f1-score': 0.061152270270054626, 'support': 236586}, 'accuracy': 0.37968667161488706, 'macro avg': {'precision': 0.47979892519915907, 'recall': 0.3439308182355867, 'f1-score': 0.21956427510185259, 'support': 754480}, 'weighted avg': {'precision': 0.47371275019645115, 'recall': 0.37968667161488706, 'f1-score': 0.23786910434205685, 'support': 754480}}
[[  7318 228002   2289]
 [  4687 271484   4114]
 [  2046 226876   7664]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0562518
{'0': {'precision': 0.5145985401459854, 'recall': 0.028147083483051862, 'f1-score': 0.05337472082371201, 'support': 50094}, '1': {'precision': 0.450383935556779, 'recall': 0.9765893011975522, 'f1-score': 0.6164658475255222, 'support': 79579}, '2': {'precision': 0.5529790660225443, 'recall': 0.035237137521292095, 'f1-score': 0.06625250810310233, 'support': 48727}, 'accuracy': 0.45315582959641254, 'macro avg': {'precision': 0.505987180575103, 'recall': 0.3466578407339654, 'f1-score': 0.24536435881744553, 'support': 178400}, 'weighted avg': {'precision': 0.49643729499902706, 'recall': 0.45315582959641254, 'f1-score': 0.30807048714975577, 'support': 178400}}
[[ 1410 48258   426]
 [  901 77716   962]
 [  429 46581  1717]]
testing model on single stock: results/universal/W1/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
21353/21353 - 106s - 106s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2137226
{'0': {'precision': 0.510269430190651, 'recall': 0.018293356542254936, 'f1-score': 0.03532046089278618, 'support': 2081958}, '1': {'precision': 0.2349333716727998, 'recall': 0.9687996089946765, 'f1-score': 0.37816253649576365, 'support': 1286939}, '2': {'precision': 0.48238687408388103, 'recall': 0.019457258447109757, 'f1-score': 0.03740574203072444, 'support': 2097315}, 'accuracy': 0.24252260980730347, 'macro avg': {'precision': 0.40919655864911064, 'recall': 0.33551674132801373, 'f1-score': 0.15029624647309142, 'support': 5466212}, 'weighted avg': {'precision': 0.4347474389151616, 'recall': 0.24252260980730347, 'f1-score': 0.1168376668380066, 'support': 5466212}}
[[  38086 2021338   22534]
 [  18899 1246786   21254]
 [  17654 2038853   40808]]
Evaluating performance on  train set...
6073/6073 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1433264
{'0': {'precision': 0.4820307425849751, 'recall': 0.025704769399798735, 'f1-score': 0.04880686416171772, 'support': 519709}, '1': {'precision': 0.32857182939016766, 'recall': 0.9657809683512738, 'f1-score': 0.49032755229501934, 'support': 509278}, '2': {'precision': 0.4832625489081363, 'recall': 0.027496070902607854, 'f1-score': 0.052031706539878916, 'support': 525566}, 'accuracy': 0.33428323125683074, 'macro avg': {'precision': 0.4312883736277597, 'recall': 0.3396606028845601, 'f1-score': 0.19705537433220532, 'support': 1554553}, 'weighted avg': {'precision': 0.4321734184075513, 'recall': 0.33428323125683074, 'f1-score': 0.19454113023078853, 'support': 1554553}}
[[ 13359 499956   6394]
 [  8369 491851   9058]
 [  5986 505129  14451]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1643317
{'0': {'precision': 0.498443370907139, 'recall': 0.02877559621200853, 'f1-score': 0.05441004998037114, 'support': 161352}, '1': {'precision': 0.2912155405066008, 'recall': 0.9605307748499476, 'f1-score': 0.4469299974595499, 'support': 132787}, '2': {'precision': 0.4668148297807859, 'recall': 0.02834047824940357, 'f1-score': 0.05343679171099496, 'support': 163053}, 'accuracy': 0.29923970673152633, 'macro avg': {'precision': 0.4188245803981752, 'recall': 0.3392156164371199, 'f1-score': 0.18492561305030533, 'support': 457192}, 'weighted avg': {'precision': 0.42697604332557265, 'recall': 0.29923970673152633, 'f1-score': 0.1680665741219159, 'support': 457192}}
[[  4643 154199   2510]
 [  2473 127546   2768]
 [  2199 156233   4621]]
training model: results/universal/W1/deepOF_L1/h100
Epoch 1/50
10622/10622 - 148s - loss: 3.2295 - accuracy100: 0.4071 - val_loss: 3.3154 - val_accuracy100: 0.3510 - 148s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 142s - loss: 3.2205 - accuracy100: 0.4110 - val_loss: 3.3309 - val_accuracy100: 0.3525 - 142s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 142s - loss: 3.2129 - accuracy100: 0.4154 - val_loss: 3.3600 - val_accuracy100: 0.3511 - 142s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 144s - loss: 3.2077 - accuracy100: 0.4177 - val_loss: 3.3745 - val_accuracy100: 0.3527 - 144s/epoch - 14ms/step
Epoch 5/50
10622/10622 - 142s - loss: 3.2032 - accuracy100: 0.4199 - val_loss: 3.3777 - val_accuracy100: 0.3541 - 142s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 143s - loss: 3.1995 - accuracy100: 0.4218 - val_loss: 3.3801 - val_accuracy100: 0.3553 - 143s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 143s - loss: 3.1960 - accuracy100: 0.4231 - val_loss: 3.3820 - val_accuracy100: 0.3574 - 143s/epoch - 13ms/step
Epoch 8/50
10622/10622 - 143s - loss: 3.1926 - accuracy100: 0.4243 - val_loss: 3.3834 - val_accuracy100: 0.3589 - 143s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 142s - loss: 3.1900 - accuracy100: 0.4252 - val_loss: 3.3854 - val_accuracy100: 0.3602 - 142s/epoch - 13ms/step
Epoch 10/50
10622/10622 - 144s - loss: 3.1866 - accuracy100: 0.4266 - val_loss: 3.3823 - val_accuracy100: 0.3606 - 144s/epoch - 14ms/step
Epoch 11/50
10622/10622 - 143s - loss: 3.1841 - accuracy100: 0.4274 - val_loss: 3.3835 - val_accuracy100: 0.3619 - 143s/epoch - 13ms/step
testing model in sample: results/universal/W1/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 174s - 174s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1203179
{'0': {'precision': 0.455619667581176, 'recall': 0.06244871335634813, 'f1-score': 0.1098421099114432, 'support': 3196495}, '1': {'precision': 0.2931705875884115, 'recall': 0.8920598070312571, 'f1-score': 0.4413077811344523, 'support': 2650792}, '2': {'precision': 0.44705886687754814, 'recall': 0.07584508554388243, 'f1-score': 0.1296881304662678, 'support': 3199469}, 'accuracy': 0.3102709965870639, 'macro avg': {'precision': 0.39861637401571187, 'recall': 0.34345120197716256, 'f1-score': 0.2269460071707211, 'support': 9046756}, 'weighted avg': {'precision': 0.4049928198891839, 'recall': 0.3102709965870639, 'f1-score': 0.21398366928268153, 'support': 9046756}}
[[ 199617 2852693  144185]
 [ 130175 2364665  155952]
 [ 108330 2848475  242664]]
Evaluating performance on  train set...
10622/10622 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973511
{'0': {'precision': 0.4495673379984846, 'recall': 0.07923068636296306, 'f1-score': 0.1347188420342631, 'support': 891132}, '1': {'precision': 0.3458473250958798, 'recall': 0.8900626934810953, 'f1-score': 0.49813626733522387, 'support': 936461}, '2': {'precision': 0.44360053100501284, 'recall': 0.07538965426672264, 'f1-score': 0.1288767749913895, 'support': 890918}, 'accuracy': 0.35728382191574726, 'macro avg': {'precision': 0.4130050646997924, 'recall': 0.34822767803692706, 'f1-score': 0.25391062812029214, 'support': 2718511}, 'weighted avg': {'precision': 0.4118828545603833, 'recall': 0.35728382191574726, 'f1-score': 0.25799273823297636, 'support': 2718511}}
[[ 70605 786172  34355]
 [ 53062 833509  49890]
 [ 33384 790368  67166]]
Evaluating performance on  val set...
3064/3064 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101015
{'0': {'precision': 0.4564219180478419, 'recall': 0.0803185963292162, 'f1-score': 0.13659921995654792, 'support': 259890}, '1': {'precision': 0.33884880182442106, 'recall': 0.8927102562839023, 'f1-score': 0.49123718221487994, 'support': 263809}, '2': {'precision': 0.4429079415250889, 'recall': 0.07327445333497387, 'f1-score': 0.12574561866554052, 'support': 260077}, 'accuracy': 0.3514218348099457, 'macro avg': {'precision': 0.41272622046578394, 'recall': 0.34876776864936415, 'f1-score': 0.25119400694565613, 'support': 783776}, 'weighted avg': {'precision': 0.4123640230754359, 'recall': 0.3514218348099457, 'f1-score': 0.25236432902144273, 'support': 783776}}
[[ 20874 228827  10189]
 [ 14523 235505  13781]
 [ 10337 230683  19057]]
testing model out of sample: results/universal/W1/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992855
{'0': {'precision': 0.4193868947871622, 'recall': 0.10105203728254787, 'f1-score': 0.1628621439188094, 'support': 1983770}, '1': {'precision': 0.3529476117533683, 'recall': 0.8486238553656607, 'f1-score': 0.4985467302188777, 'support': 2128955}, '2': {'precision': 0.432538584501701, 'recall': 0.10938178032526431, 'f1-score': 0.17460809190026458, 'support': 1986446}, 'accuracy': 0.36470972858442563, 'macro avg': {'precision': 0.4016243636807439, 'recall': 0.35301922432449095, 'f1-score': 0.2786723220126506, 'support': 6099171}, 'weighted avg': {'precision': 0.40047922317334383, 'recall': 0.36470972858442563, 'f1-score': 0.2838605664602386, 'support': 6099171}}
[[ 200464 1660743  122563]
 [ 159778 1806682  162495]
 [ 117751 1651414  217281]]
Evaluating performance on  train set...
6711/6711 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092774
{'0': {'precision': 0.4489051094890511, 'recall': 0.08318150179230165, 'f1-score': 0.14035534959097926, 'support': 555989}, '1': {'precision': 0.35636429567790623, 'recall': 0.8862131781223619, 'f1-score': 0.5083220027740796, 'support': 607689}, '2': {'precision': 0.4410605795919952, 'recall': 0.08209235615864277, 'f1-score': 0.13842109912066694, 'support': 553596}, 'accuracy': 0.3669979281116467, 'macro avg': {'precision': 0.41544332825298413, 'recall': 0.35049567869110215, 'f1-score': 0.2623661504952419, 'support': 1717274}, 'weighted avg': {'precision': 0.41362900621317816, 'recall': 0.3669979281116467, 'f1-score': 0.26994357731865815, 'support': 1717274}}
[[ 46248 485622  24119]
 [ 35674 538542  33473]
 [ 21102 487048  45446]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0811857
{'0': {'precision': 0.4433720464557469, 'recall': 0.08089820315525645, 'f1-score': 0.13683020127177561, 'support': 136851}, '1': {'precision': 0.3891638747040345, 'recall': 0.8827291858087081, 'f1-score': 0.5401811220279283, 'support': 168695}, '2': {'precision': 0.44225221033038625, 'recall': 0.10614645768958714, 'f1-score': 0.17120211360634083, 'support': 134305}, 'accuracy': 0.3961318719293579, 'macro avg': {'precision': 0.42492937716338924, 'recall': 0.3565912822178505, 'f1-score': 0.28273781230201495, 'support': 439851}, 'weighted avg': {'precision': 0.4222397832018912, 'recall': 0.3961318719293579, 'f1-score': 0.30202160304886144, 'support': 439851}}
[[ 11071 118761   7019]
 [  8823 148912  10960]
 [  5076 114973  14256]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1078291
{'0': {'precision': 0.3890564411891426, 'recall': 0.016161652318651226, 'f1-score': 0.031034127229611297, 'support': 55873}, '1': {'precision': 0.35299951650694866, 'recall': 0.9501626762325853, 'f1-score': 0.5147585882735773, 'support': 59935}, '2': {'precision': 0.3610006626905235, 'recall': 0.040445475638051044, 'f1-score': 0.07274123282869589, 'support': 53875}, 'accuracy': 0.35377733774155334, 'macro avg': {'precision': 0.3676855401288716, 'recall': 0.33558993472976256, 'f1-score': 0.20617798277729485, 'support': 169683}, 'weighted avg': {'precision': 0.36741268873639016, 'recall': 0.35377733774155334, 'f1-score': 0.21513622282446043, 'support': 169683}}
[[  903 53251  1719]
 [  849 56948  2138]
 [  569 51127  2179]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1114036
{'0': {'precision': 0.4366683095120749, 'recall': 0.04048805008454051, 'f1-score': 0.0741050518568083, 'support': 21883}, '1': {'precision': 0.32863307987796203, 'recall': 0.9538863907497477, 'f1-score': 0.488848129989536, 'support': 21794}, '2': {'precision': 0.4137651821862348, 'recall': 0.02236715398756894, 'f1-score': 0.042440098002574644, 'support': 22846}, 'accuracy': 0.33350871127279286, 'macro avg': {'precision': 0.3930221905254239, 'recall': 0.338913864940619, 'f1-score': 0.20179775994963964, 'support': 66523}, 'weighted avg': {'precision': 0.39340861524795573, 'recall': 0.33350871127279286, 'f1-score': 0.19910682731899199, 'support': 66523}}
[[  886 20660   337]
 [  618 20789   387]
 [  525 21810   511]]
Evaluating performance on  val set...
51/51 - 0s - 406ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0605015
{'0': {'precision': 0.37037037037037035, 'recall': 0.05224963715529753, 'f1-score': 0.09157975069956756, 'support': 3445}, '1': {'precision': 0.47633258725026945, 'recall': 0.9367460058689273, 'f1-score': 0.6315326702203661, 'support': 6134}, '2': {'precision': 0.26174496644295303, 'recall': 0.02386780905752754, 'f1-score': 0.04374649467190128, 'support': 3268}, 'accuracy': 0.46734646220907605, 'macro avg': {'precision': 0.3694826413545309, 'recall': 0.33762115069391746, 'f1-score': 0.25561963853061165, 'support': 12847}, 'weighted avg': {'precision': 0.3933317168564372, 'recall': 0.46734646220907605, 'f1-score': 0.3372209219957585, 'support': 12847}}
[[ 180 3204   61]
 [ 229 5746  159]
 [  77 3113   78]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0215651
{'0': {'precision': 0.4603427660422479, 'recall': 0.10953681575054057, 'f1-score': 0.17696538832794523, 'support': 105444}, '1': {'precision': 0.5285256453597652, 'recall': 0.9038415288415288, 'f1-score': 0.667012531336875, 'support': 216216}, '2': {'precision': 0.4746559633027523, 'recall': 0.12498867582666465, 'f1-score': 0.19787259471734192, 'support': 99345}, 'accuracy': 0.5211149511288464, 'macro avg': {'precision': 0.4878414582349218, 'recall': 0.37945567347291137, 'f1-score': 0.34728350479405407, 'support': 421005}, 'weighted avg': {'precision': 0.4987370226813879, 'recall': 0.5211149511288464, 'f1-score': 0.4335729333489625, 'support': 421005}}
[[ 11550  90653   3241]
 [ 10289 195425  10502]
 [  3251  83677  12417]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.063371
{'0': {'precision': 0.5479029772045104, 'recall': 0.13135222388611215, 'f1-score': 0.21190349198381075, 'support': 51419}, '1': {'precision': 0.3992875804763786, 'recall': 0.8925102625668035, 'f1-score': 0.5517399881255626, 'support': 64555}, '2': {'precision': 0.4968913930444919, 'recall': 0.10040436557788945, 'f1-score': 0.167053136941115, 'support': 50944}, 'accuracy': 0.4162822463724703, 'macro avg': {'precision': 0.4813606502417936, 'recall': 0.37475561734360174, 'f1-score': 0.31023220568349613, 'support': 166918}, 'weighted avg': {'precision': 0.47485752327364306, 'recall': 0.4162822463724703, 'f1-score': 0.32964566790932925, 'support': 166918}}
[[ 6754 42617  2048]
 [ 3808 57616  3131]
 [ 1765 44064  5115]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.052315
{'0': {'precision': 0.5556950109821148, 'recall': 0.12492945823927765, 'f1-score': 0.20399700512584226, 'support': 14176}, '1': {'precision': 0.4277949916188348, 'recall': 0.8856406751143593, 'f1-score': 0.5769184662545168, 'support': 19019}, '2': {'precision': 0.5261464199517297, 'recall': 0.14982817869415807, 'f1-score': 0.2332382310984308, 'support': 13095}, 'accuracy': 0.4445236552171095, 'macro avg': {'precision': 0.5032121408508932, 'recall': 0.386799437349265, 'f1-score': 0.33805123415959665, 'support': 46290}, 'weighted avg': {'precision': 0.4947861911978608, 'recall': 0.4445236552171095, 'f1-score': 0.36548992202619457, 'support': 46290}}
[[ 1771 11814   591]
 [  999 16844  1176]
 [  417 10716  1962]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1241044
{'0': {'precision': 0.45050852313422146, 'recall': 0.10232966746925229, 'f1-score': 0.16677714437226568, 'support': 122936}, '1': {'precision': 0.2733264086686186, 'recall': 0.8116892189632751, 'f1-score': 0.408945444700149, 'support': 93043}, '2': {'precision': 0.45908395516563116, 'recall': 0.12224707144104223, 'f1-score': 0.19307990282975512, 'support': 120281}, 'accuracy': 0.30573365847855827, 'macro avg': {'precision': 0.3943062956561571, 'recall': 0.3454219859578565, 'f1-score': 0.2562674973007233, 'support': 336260}, 'weighted avg': {'precision': 0.40454975927276576, 'recall': 0.30573365847855827, 'f1-score': 0.24319356992818236, 'support': 336260}}
[[ 12580 102049   8307]
 [  8503  75522   9018]
 [  6841  98736  14704]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062089
{'0': {'precision': 0.40964785335262904, 'recall': 0.09440170750144515, 'f1-score': 0.15344307319805578, 'support': 44978}, '1': {'precision': 0.325528578381009, 'recall': 0.8053511705685619, 'f1-score': 0.46364756623536657, 'support': 44850}, '2': {'precision': 0.40346593146908233, 'recall': 0.11590857660104097, 'f1-score': 0.1800826228355454, 'support': 44190}, 'accuracy': 0.33941709322628305, 'macro avg': {'precision': 0.37954745440090676, 'recall': 0.3385538182236827, 'f1-score': 0.2657244207563226, 'support': 134018}, 'weighted avg': {'precision': 0.3794584115574144, 'recall': 0.33941709322628305, 'f1-score': 0.2660389424932553, 'support': 134018}}
[[ 4246 37682  3050]
 [ 4207 36120  4523]
 [ 1912 37156  5122]]
Evaluating performance on  val set...
107/107 - 1s - 681ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1280785
{'0': {'precision': 0.46296296296296297, 'recall': 0.0672176857199761, 'f1-score': 0.1173913043478261, 'support': 10042}, '1': {'precision': 0.26588163726427394, 'recall': 0.8322905331882481, 'f1-score': 0.4030165316472371, 'support': 7352}, '2': {'precision': 0.4592290585618977, 'recall': 0.12673895253682488, 'f1-score': 0.19865319865319864, 'support': 9776}, 'accuracy': 0.29565697460434304, 'macro avg': {'precision': 0.3960245529297115, 'recall': 0.342082390481683, 'f1-score': 0.23968701154942063, 'support': 27170}, 'weighted avg': {'precision': 0.4082907305021026, 'recall': 0.29565697460434304, 'f1-score': 0.22391809675984642, 'support': 27170}}
[[ 675 8659  708]
 [ 482 6119  751]
 [ 301 8236 1239]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1304/1304 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1121488
{'0': {'precision': 0.4306049822064057, 'recall': 0.05235412545916926, 'f1-score': 0.09335758205594528, 'support': 113248}, '1': {'precision': 0.3228484995079539, 'recall': 0.9075802455336351, 'f1-score': 0.4762745045324678, 'support': 107358}, '2': {'precision': 0.42975889023450403, 'recall': 0.06900910456996376, 'f1-score': 0.11892213014867171, 'support': 113130}, 'accuracy': 0.3331135987726826, 'macro avg': {'precision': 0.39440412398295455, 'recall': 0.34298115852092276, 'f1-score': 0.2295180722456949, 'support': 333736}, 'weighted avg': {'precision': 0.3956544858430478, 'recall': 0.3331135987726826, 'f1-score': 0.22520225056328236, 'support': 333736}}
[[  5929 102591   4728]
 [  4291  97436   5631]
 [  3549 101774   7807]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1130061
{'0': {'precision': 0.4076567910734898, 'recall': 0.06400845793686755, 'f1-score': 0.11064407487664153, 'support': 33105}, '1': {'precision': 0.3263012551354165, 'recall': 0.8968488505925903, 'f1-score': 0.47850693752904466, 'support': 32147}, '2': {'precision': 0.3974413646055437, 'recall': 0.056496832661473644, 'f1-score': 0.09893055223840988, 'support': 32993}, 'accuracy': 0.33400173036795766, 'macro avg': {'precision': 0.37713313693815004, 'recall': 0.33911804706364385, 'f1-score': 0.22936052154803202, 'support': 98245}, 'weighted avg': {'precision': 0.37760565382214684, 'recall': 0.33400173036795766, 'f1-score': 0.2270797529598379, 'support': 98245}}
[[ 2119 29749  1237]
 [ 1727 28831  1589]
 [ 1352 29777  1864]]
Evaluating performance on  val set...
93/93 - 1s - 601ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1177917
{'0': {'precision': 0.370258880192655, 'recall': 0.07854406130268199, 'f1-score': 0.12959645980402484, 'support': 7830}, '1': {'precision': 0.3158703481392557, 'recall': 0.8732244789592459, 'f1-score': 0.4639255236617533, 'support': 7533}, '2': {'precision': 0.4033989266547406, 'recall': 0.05472636815920398, 'f1-score': 0.09637781814296399, 'support': 8241}, 'accuracy': 0.3238434163701068, 'macro avg': {'precision': 0.3631760516622171, 'recall': 0.33549830280704396, 'f1-score': 0.22996660053624737, 'support': 23604}, 'weighted avg': {'precision': 0.36447165391472713, 'recall': 0.3238434163701068, 'f1-score': 0.2246966975650597, 'support': 23604}}
[[ 615 6922  293]
 [ 581 6578  374]
 [ 465 7325  451]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1300173
{'0': {'precision': 0.36140452698781195, 'recall': 0.08118996914250945, 'f1-score': 0.13259280289587622, 'support': 230090}, '1': {'precision': 0.30897876646734773, 'recall': 0.8166649919373747, 'f1-score': 0.44833392437316943, 'support': 208989}, '2': {'precision': 0.36931494718198493, 'recall': 0.10232749706433918, 'f1-score': 0.16025306727417452, 'support': 228228}, 'accuracy': 0.31875733358109537, 'macro avg': {'precision': 0.34656608021238156, 'recall': 0.3333941527147411, 'f1-score': 0.24705993151440675, 'support': 667307}, 'weighted avg': {'precision': 0.34769115685182417, 'recall': 0.31875733358109537, 'f1-score': 0.2409376397624883, 'support': 667307}}
[[ 18681 192145  19264]
 [ 17697 170674  20618]
 [ 15312 189562  23354]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1157494
{'0': {'precision': 0.37784620371120653, 'recall': 0.07572632638809945, 'f1-score': 0.1261668335182229, 'support': 61577}, '1': {'precision': 0.32391848409009655, 'recall': 0.8327069211705428, 'f1-score': 0.4664071226000984, 'support': 60929}, '2': {'precision': 0.3851394371577741, 'recall': 0.09729303717047592, 'f1-score': 0.15534354575687923, 'support': 62173}, 'accuracy': 0.33272868057548505, 'macro avg': {'precision': 0.36230137498635906, 'recall': 0.3352420949097061, 'f1-score': 0.2493058339584002, 'support': 184679}, 'weighted avg': {'precision': 0.3625097560061552, 'recall': 0.33272868057548505, 'f1-score': 0.248240833829485, 'support': 184679}}
[[ 4663 52869  4045]
 [ 4581 50736  5612]
 [ 3097 53027  6049]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1247084
{'0': {'precision': 0.3782516990860089, 'recall': 0.0803544757542567, 'f1-score': 0.13255040446762206, 'support': 20086}, '1': {'precision': 0.30791583372833503, 'recall': 0.8224252766004293, 'f1-score': 0.4480731743889639, 'support': 18167}, '2': {'precision': 0.39289072785405305, 'recall': 0.10521809207212653, 'f1-score': 0.1659846648921378, 'support': 19854}, 'accuracy': 0.3208563512141394, 'macro avg': {'precision': 0.35968608688946563, 'recall': 0.33599928147560415, 'f1-score': 0.2488694145829079, 'support': 58107}, 'weighted avg': {'precision': 0.361263240057112, 'recall': 0.3208563512141394, 'f1-score': 0.2426215829423214, 'support': 58107}}
[[ 1614 16967  1505]
 [ 1503 14941  1723]
 [ 1150 16615  2089]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/EXC
Evaluating performance on  test set...
5343/5343 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904188
{'0': {'precision': 0.4896344968601512, 'recall': 0.14590963399534662, 'f1-score': 0.224822751906127, 'support': 461169}, '1': {'precision': 0.33126655859020254, 'recall': 0.798482638535554, 'f1-score': 0.46826427747795774, 'support': 442215}, '2': {'precision': 0.4524673903128706, 'recall': 0.16021963824289406, 'f1-score': 0.23664336998783483, 'support': 464400}, 'accuracy': 0.3617501008931235, 'macro avg': {'precision': 0.42445614858774144, 'recall': 0.36820397025793156, 'f1-score': 0.3099101331239732, 'support': 1367784}, 'weighted avg': {'precision': 0.4258136873590878, 'recall': 0.3617501008931235, 'f1-score': 0.3075426764467652, 'support': 1367784}}
[[ 67289 352787  41093]
 [ 40168 353101  48946]
 [ 29970 360024  74406]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0559698
{'0': {'precision': 0.4742904745490061, 'recall': 0.16936443459707862, 'f1-score': 0.24959939531368103, 'support': 97488}, '1': {'precision': 0.4187674960511706, 'recall': 0.80359674987058, 'f1-score': 0.5506054351653604, 'support': 133287}, '2': {'precision': 0.47902406991134794, 'recall': 0.19080098991971992, 'f1-score': 0.27290190294614913, 'support': 99402}, 'accuracy': 0.4318471607652865, 'macro avg': {'precision': 0.4573606801705082, 'recall': 0.3879207247957928, 'f1-score': 0.3577022444750635, 'support': 330177}, 'weighted avg': {'precision': 0.45330184605933693, 'recall': 0.4318471607652865, 'f1-score': 0.3781259368274551, 'support': 330177}}
[[ 16511  74151   6826]
 [ 12377 107109  13801]
 [  5924  74512  18966]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0569272
{'0': {'precision': 0.46107042253521124, 'recall': 0.1515499425947187, 'f1-score': 0.22811907682015828, 'support': 27001}, '1': {'precision': 0.4383961443202356, 'recall': 0.8316022043324783, 'f1-score': 0.5741286205203731, 'support': 39377}, '2': {'precision': 0.4563295233987492, 'recall': 0.15990327212272348, 'f1-score': 0.23682148852825965, 'support': 26466}, 'accuracy': 0.442354917926845, 'macro avg': {'precision': 0.45193203008473204, 'recall': 0.38101847301664016, 'f1-score': 0.346356395289597, 'support': 92844}, 'weighted avg': {'precision': 0.4501023719361774, 'recall': 0.442354917926845, 'f1-score': 0.3773493537421992, 'support': 92844}}
[[ 4092 21270  1639]
 [ 3228 32746  3403]
 [ 1555 20679  4232]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/AAL
Evaluating performance on  test set...
7177/7177 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081009
{'0': {'precision': 0.44632545673124296, 'recall': 0.11750371409349311, 'f1-score': 0.18603116537472653, 'support': 578203}, '1': {'precision': 0.3883721239173176, 'recall': 0.8421072340033299, 'f1-score': 0.5315830337677263, 'support': 694332}, '2': {'precision': 0.44061870960906874, 'recall': 0.1399719067786853, 'f1-score': 0.21245345413972497, 'support': 564549}, 'accuracy': 0.39827465701078446, 'macro avg': {'precision': 0.4251054300858765, 'recall': 0.36652761829183605, 'f1-score': 0.31002255109405924, 'support': 1837084}, 'weighted avg': {'precision': 0.42266807804826784, 'recall': 0.39827465701078446, 'f1-score': 0.3247533994070514, 'support': 1837084}}
[[ 67941 469178  41084]
 [ 50394 584702  59236]
 [ 33888 451640  79021]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0679601
{'0': {'precision': 0.4675770777479893, 'recall': 0.09556615943104374, 'f1-score': 0.15869690909263245, 'support': 175198}, '1': {'precision': 0.4081140026250604, 'recall': 0.8953886658785525, 'f1-score': 0.5606749585811011, 'support': 230931}, '2': {'precision': 0.4612799407593062, 'recall': 0.09446761352037096, 'f1-score': 0.15681945816146708, 'support': 171445}, 'accuracy': 0.4150325326278537, 'macro avg': {'precision': 0.44565700704411865, 'recall': 0.36180747960998905, 'f1-score': 0.29206377527840016, 'support': 577574}, 'weighted avg': {'precision': 0.4419327792646125, 'recall': 0.4150325326278537, 'f1-score': 0.318862209766707, 'support': 577574}}
[[ 16743 150922   7533]
 [ 12776 206773  11382]
 [  6289 148960  16196]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0588348
{'0': {'precision': 0.47249911000356, 'recall': 0.111046037356983, 'f1-score': 0.1798289440257431, 'support': 47809}, '1': {'precision': 0.4303475394668363, 'recall': 0.8687455312194481, 'f1-score': 0.5755746223564955, 'support': 68531}, '2': {'precision': 0.458500036371572, 'recall': 0.13414348649626492, 'f1-score': 0.2075608390687259, 'support': 46987}, 'accuracy': 0.4356168912672124, 'macro avg': {'precision': 0.4537822286139894, 'recall': 0.371311685024232, 'f1-score': 0.3209881351503215, 'support': 163327}, 'weighted avg': {'precision': 0.4507852246496477, 'recall': 0.4356168912672124, 'f1-score': 0.3538594817449776, 'support': 163327}}
[[ 5309 39983  2517]
 [ 4068 59536  4927]
 [ 1859 38825  6303]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/WBA
Evaluating performance on  test set...
5696/5696 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.144738
{'0': {'precision': 0.443871640407785, 'recall': 0.06979459640634791, 'f1-score': 0.12062245784589037, 'support': 548968}, '1': {'precision': 0.2484573360374305, 'recall': 0.8593011282482811, 'f1-score': 0.38546249216193895, 'support': 361268}, '2': {'precision': 0.45202352806433405, 'recall': 0.10086840957094324, 'f1-score': 0.16493239007790814, 'support': 547783}, 'accuracy': 0.2770930968663646, 'macro avg': {'precision': 0.3814508348365165, 'recall': 0.34332137807519075, 'f1-score': 0.2236724466952458, 'support': 1458019}, 'weighted avg': {'precision': 0.39851457068845914, 'recall': 0.2770930968663646, 'f1-score': 0.20289193247217552, 'support': 1458019}}
[[ 38315 473539  37114]
 [ 20961 310438  29869]
 [ 27044 465485  55254]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050884
{'0': {'precision': 0.4727986974388132, 'recall': 0.09566040399709265, 'f1-score': 0.15912530661238977, 'support': 191239}, '1': {'precision': 0.33630814599695313, 'recall': 0.8776444290694271, 'f1-score': 0.48627759740738447, 'support': 187895}, '2': {'precision': 0.43318344869398273, 'recall': 0.09049840619788478, 'f1-score': 0.14971842668180035, 'support': 189484}, 'accuracy': 0.35234023544805126, 'macro avg': {'precision': 0.41409676404324963, 'recall': 0.35460107975480154, 'f1-score': 0.26504044356719153, 'support': 568618}, 'weighted avg': {'precision': 0.4144953233698711, 'recall': 0.35234023544805126, 'f1-score': 0.26409529778776186, 'support': 568618}}
[[ 18294 162043  10902]
 [ 11454 164905  11536]
 [  8945 163391  17148]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1120799
{'0': {'precision': 0.4854051847315779, 'recall': 0.08321522929679982, 'f1-score': 0.14207405415901184, 'support': 57153}, '1': {'precision': 0.31804435131831676, 'recall': 0.8870879763110731, 'f1-score': 0.4682196527631397, 'support': 51332}, '2': {'precision': 0.44348385910052424, 'recall': 0.08710102779935333, 'f1-score': 0.1456049762961621, 'support': 55361}, 'accuracy': 0.33637684166839593, 'macro avg': {'precision': 0.41564446505013963, 'recall': 0.35246807780240874, 'f1-score': 0.2519662277394379, 'support': 163846}, 'weighted avg': {'precision': 0.41880744777718, 'recall': 0.33637684166839593, 'f1-score': 0.2454466189331404, 'support': 163846}}
[[ 4756 49357  3040]
 [ 2785 45536  3011]
 [ 2257 48282  4822]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
12066/12066 - 59s - 59s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003164
{'0': {'precision': 0.41155637632091924, 'recall': 0.1006212700718795, 'f1-score': 0.16170688269293254, 'support': 996668}, '1': {'precision': 0.35023080646944243, 'recall': 0.8565644530958667, 'f1-score': 0.49717672790475065, 'support': 1072656}, '2': {'precision': 0.44089343049893576, 'recall': 0.09589774725775935, 'f1-score': 0.15753122822282106, 'support': 1019513}, 'accuracy': 0.361577512830881, 'macro avg': {'precision': 0.40089353776309916, 'recall': 0.35102782347516853, 'f1-score': 0.27213827960683473, 'support': 3088837}, 'weighted avg': {'precision': 0.3999430304763785, 'recall': 0.361577512830881, 'f1-score': 0.27682678324765303, 'support': 3088837}}
[[100286 844037  52345]
 [ 82219 918799  71638]
 [ 61170 860574  97769]]
Evaluating performance on  train set...
2948/2948 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021323
{'0': {'precision': 0.4620601949978805, 'recall': 0.07774823362512037, 'f1-score': 0.13310041890677207, 'support': 252353}, '1': {'precision': 0.33249851915742656, 'recall': 0.8988181471597407, 'f1-score': 0.4854246045678964, 'support': 249185}, '2': {'precision': 0.45362488611219576, 'recall': 0.06889326406844257, 'f1-score': 0.11961957323832961, 'support': 252942}, 'accuracy': 0.3459574806489238, 'macro avg': {'precision': 0.41606120008916764, 'recall': 0.3484865482844346, 'f1-score': 0.2460481989043327, 'support': 754480}, 'weighted avg': {'precision': 0.4164413978203988, 'recall': 0.3459574806489238, 'f1-score': 0.24494437784392095, 'support': 754480}}
[[ 19620 223400   9333]
 [ 13557 223972  11656]
 [  9285 226231  17426]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0818638
{'0': {'precision': 0.4431307029944737, 'recall': 0.06216084659900124, 'f1-score': 0.10902766798418971, 'support': 55469}, '1': {'precision': 0.38975118557150146, 'recall': 0.9141013851790224, 'f1-score': 0.546491384989943, 'support': 68511}, '2': {'precision': 0.45184663379289525, 'recall': 0.08250643145902242, 'f1-score': 0.13953416100812654, 'support': 54420}, 'accuracy': 0.3955381165919282, 'macro avg': {'precision': 0.42824284078629016, 'recall': 0.35292288774568203, 'f1-score': 0.2650177379940864, 'support': 178400}, 'weighted avg': {'precision': 0.425290102298761, 'recall': 0.3955381165919282, 'f1-score': 0.2863328253056236, 'support': 178400}}
[[ 3448 49850  2171]
 [ 2609 62626  3276]
 [ 1724 48206  4490]]
testing model on single stock: results/universal/W1/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
21353/21353 - 107s - 107s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1293887
{'0': {'precision': 0.4357401871071148, 'recall': 0.038962405204948404, 'f1-score': 0.07152893626073424, 'support': 1967666}, '1': {'precision': 0.2772501625833615, 'recall': 0.924133789668151, 'f1-score': 0.42653515215364457, 'support': 1523735}, '2': {'precision': 0.4381248905776083, 'recall': 0.04688651217762105, 'f1-score': 0.08470789717805015, 'support': 1974811}, 'accuracy': 0.2885713177608186, 'macro avg': {'precision': 0.38370508008936155, 'recall': 0.3366609023502401, 'f1-score': 0.19425732853080965, 'support': 5466212}, 'weighted avg': {'precision': 0.39242180522356684, 'recall': 0.2885713177608186, 'f1-score': 0.17525000550606706, 'support': 5466212}}
[[  76665 1833269   57732]
 [  54587 1408135   61013]
 [  44690 1837529   92592]]
Evaluating performance on  train set...
6073/6073 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1058844
{'0': {'precision': 0.40857099514563106, 'recall': 0.0520061558543372, 'f1-score': 0.0922677419189073, 'support': 517881}, '1': {'precision': 0.331838063773794, 'recall': 0.9159565503290736, 'f1-score': 0.4871783300341543, 'support': 518577}, '2': {'precision': 0.4182072339681985, 'recall': 0.046196160935735725, 'f1-score': 0.08320166862208317, 'support': 518095}, 'accuracy': 0.3382715159920569, 'macro avg': {'precision': 0.3862054309625411, 'recall': 0.3380529557063822, 'f1-score': 0.22088258019171492, 'support': 1554553}, 'weighted avg': {'precision': 0.38618549513422257, 'recall': 0.3382715159920569, 'f1-score': 0.22098285218425198, 'support': 1554553}}
[[ 26933 477654  13294]
 [ 23581 474994  20002]
 [ 15406 478755  23934]]
Evaluating performance on  val set...
1786/1786 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1101348
{'0': {'precision': 0.4329596208185216, 'recall': 0.06179665647563911, 'f1-score': 0.10815610911243682, 'support': 153730}, '1': {'precision': 0.32031879194630875, 'recall': 0.9118991729672189, 'f1-score': 0.47410190368746324, 'support': 146548}, '2': {'precision': 0.4130747922437673, 'recall': 0.047516473992123075, 'f1-score': 0.08522896138634234, 'support': 156914}, 'accuracy': 0.3293867784213197, 'macro avg': {'precision': 0.38878440166953254, 'recall': 0.3404041011449937, 'f1-score': 0.2224956580620808, 'support': 457192}, 'weighted avg': {'precision': 0.3900290879558642, 'recall': 0.3293867784213197, 'f1-score': 0.21758723180287887, 'support': 457192}}
[[  9500 139605   4625]
 [  6942 133637   5969]
 [  5500 143958   7456]]
training model: results/universal/W1/deepOF_L1/h200
Epoch 1/50
10622/10622 - 151s - loss: 3.2716 - accuracy200: 0.3794 - val_loss: 3.2822 - val_accuracy200: 0.3773 - 151s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 144s - loss: 3.2662 - accuracy200: 0.3825 - val_loss: 3.2813 - val_accuracy200: 0.3786 - 144s/epoch - 14ms/step
Epoch 3/50
10622/10622 - 141s - loss: 3.2633 - accuracy200: 0.3845 - val_loss: 3.2805 - val_accuracy200: 0.3794 - 141s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 143s - loss: 3.2611 - accuracy200: 0.3861 - val_loss: 3.2808 - val_accuracy200: 0.3795 - 143s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 143s - loss: 3.2593 - accuracy200: 0.3872 - val_loss: 3.2808 - val_accuracy200: 0.3790 - 143s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 143s - loss: 3.2576 - accuracy200: 0.3883 - val_loss: 3.2800 - val_accuracy200: 0.3802 - 143s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 146s - loss: 3.2562 - accuracy200: 0.3896 - val_loss: 3.2795 - val_accuracy200: 0.3805 - 146s/epoch - 14ms/step
Epoch 8/50
10622/10622 - 144s - loss: 3.2546 - accuracy200: 0.3902 - val_loss: 3.2810 - val_accuracy200: 0.3802 - 144s/epoch - 14ms/step
Epoch 9/50
10622/10622 - 145s - loss: 3.2534 - accuracy200: 0.3913 - val_loss: 3.2811 - val_accuracy200: 0.3806 - 145s/epoch - 14ms/step
Epoch 10/50
10622/10622 - 143s - loss: 3.2520 - accuracy200: 0.3922 - val_loss: 3.2828 - val_accuracy200: 0.3798 - 143s/epoch - 13ms/step
Epoch 11/50
10622/10622 - 143s - loss: 3.2509 - accuracy200: 0.3929 - val_loss: 3.2820 - val_accuracy200: 0.3802 - 143s/epoch - 14ms/step
Epoch 12/50
10622/10622 - 144s - loss: 3.2499 - accuracy200: 0.3938 - val_loss: 3.2821 - val_accuracy200: 0.3797 - 144s/epoch - 14ms/step
Epoch 13/50
10622/10622 - 144s - loss: 3.2489 - accuracy200: 0.3945 - val_loss: 3.2822 - val_accuracy200: 0.3801 - 144s/epoch - 14ms/step
Epoch 14/50
10622/10622 - 142s - loss: 3.2475 - accuracy200: 0.3952 - val_loss: 3.2833 - val_accuracy200: 0.3797 - 142s/epoch - 13ms/step
Epoch 15/50
10622/10622 - 146s - loss: 3.2466 - accuracy200: 0.3957 - val_loss: 3.2837 - val_accuracy200: 0.3791 - 146s/epoch - 14ms/step
Epoch 16/50
10622/10622 - 147s - loss: 3.2453 - accuracy200: 0.3968 - val_loss: 3.2842 - val_accuracy200: 0.3786 - 147s/epoch - 14ms/step
Epoch 17/50
10622/10622 - 147s - loss: 3.2446 - accuracy200: 0.3973 - val_loss: 3.2869 - val_accuracy200: 0.3777 - 147s/epoch - 14ms/step
testing model in sample: results/universal/W1/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 181s - 181s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908755
{'0': {'precision': 0.39514988602997814, 'recall': 0.5296031422720026, 'f1-score': 0.45260218654090534, 'support': 3235366}, '1': {'precision': 0.311613475177305, 'recall': 0.00627681982743695, 'f1-score': 0.012305765040485198, 'support': 2575986}, '2': {'precision': 0.39403366647777033, 'recall': 0.5673668574310967, 'f1-score': 0.46507493497629354, 'support': 3235404}, 'accuracy': 0.3940959610273561, 'macro avg': {'precision': 0.36693234256168444, 'recall': 0.3677489398435121, 'f1-score': 0.309994295519228, 'support': 9046756}, 'weighted avg': {'precision': 0.3709644160061568, 'recall': 0.3940959610273561, 'f1-score': 0.33169221202005694, 'support': 9046756}}
[[1713460   18551 1503355]
 [1240193   16169 1319624]
 [1382575   17168 1835661]]
Evaluating performance on  train set...
10622/10622 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924877
{'0': {'precision': 0.37737097171727313, 'recall': 0.5519632003348611, 'f1-score': 0.448266932448186, 'support': 912617}, '1': {'precision': 0.3520485584218513, 'recall': 0.006765585690875993, 'f1-score': 0.013276035677144948, 'support': 891571}, '2': {'precision': 0.37773886343113305, 'recall': 0.5645630701622949, 'f1-score': 0.45263074361961314, 'support': 914323}, 'accuracy': 0.37739630260830287, 'macro avg': {'precision': 0.36905279785675243, 'recall': 0.374430618729344, 'f1-score': 0.30472457058164804, 'support': 2718511}, 'weighted avg': {'precision': 0.36918989115930556, 'recall': 0.3773963026083028, 'f1-score': 0.3070737072218172, 'support': 2718511}}
[[503731   5697 403189]
 [438387   6032 447152]
 [392725   5405 516193]]
Evaluating performance on  val set...
3064/3064 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0929819
{'0': {'precision': 0.38098196356624914, 'recall': 0.5494904655148697, 'f1-score': 0.4499777746655544, 'support': 268971}, '1': {'precision': 0.33921380632790027, 'recall': 0.007201859700119284, 'f1-score': 0.014104271146440445, 'support': 245631}, '2': {'precision': 0.3798256123535676, 'recall': 0.5512010818281112, 'f1-score': 0.44974067820757263, 'support': 269174}, 'accuracy': 0.38012774057894094, 'macro avg': {'precision': 0.36667379408257234, 'recall': 0.3692978023477001, 'f1-score': 0.30460757467318916, 'support': 783776}, 'weighted avg': {'precision': 0.3674949291177138, 'recall': 0.38012774057894094, 'f1-score': 0.31329603811724943, 'support': 783776}}
[[147797   1757 119417]
 [121024   1769 122838]
 [119116   1689 148369]]
testing model out of sample: results/universal/W1/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 127s - 127s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956712
{'0': {'precision': 0.3706314140219719, 'recall': 0.5670127438084877, 'f1-score': 0.44825690695385684, 'support': 2058019}, '1': {'precision': 0.348706071896083, 'recall': 0.008734234618238535, 'f1-score': 0.017041618358296214, 'support': 1982429}, '2': {'precision': 0.3762529545408324, 'recall': 0.530195660125233, 'f1-score': 0.440152216858618, 'support': 2058723}, 'accuracy': 0.3731267741140558, 'macro avg': {'precision': 0.36519681348629573, 'recall': 0.3686475461839864, 'f1-score': 0.3018169140569237, 'support': 6099171}, 'weighted avg': {'precision': 0.36540246744813853, 'recall': 0.3731267741140558, 'f1-score': 0.30536224057015504, 'support': 6099171}}
[[1166923   16616  874480]
 [1030077   17315  935037]
 [ 951473   15724 1091526]]
Evaluating performance on  train set...
6711/6711 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911087
{'0': {'precision': 0.38204675175334046, 'recall': 0.5530497447564088, 'f1-score': 0.45191241616420086, 'support': 576704}, '1': {'precision': 0.3553272611734802, 'recall': 0.005921723812919419, 'f1-score': 0.011649305555555555, 'support': 566558}, '2': {'precision': 0.3815007382614144, 'recall': 0.580212608795635, 'f1-score': 0.4603274755029167, 'support': 574012}, 'accuracy': 0.38162226878180183, 'macro avg': {'precision': 0.3729582503960784, 'recall': 0.37972802578832104, 'f1-score': 0.307963065740891, 'support': 1717274}, 'weighted avg': {'precision': 0.3730490266142701, 'recall': 0.38162226878180183, 'f1-score': 0.3094749004392333, 'support': 1717274}}
[[318946   3147 254611]
 [277866   3355 285337]
 [238023   2940 333049]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903015
{'0': {'precision': 0.3891402070566344, 'recall': 0.5507490762512597, 'f1-score': 0.4560507569878476, 'support': 148850}, '1': {'precision': 0.36163643380934, 'recall': 0.006379748214419456, 'f1-score': 0.012538304050527894, 'support': 146871}, '2': {'precision': 0.37540877255696337, 'recall': 0.5901963505168945, 'f1-score': 0.45891406791593725, 'support': 144130}, 'accuracy': 0.3819043266924481, 'macro avg': {'precision': 0.3753951378076459, 'recall': 0.3824417249941912, 'f1-score': 0.3091677096514376, 'support': 439851}, 'weighted avg': {'precision': 0.37545689535553345, 'recall': 0.3819043266924481, 'f1-score': 0.30889540558182255, 'support': 439851}}
[[81979   840 66031]
 [70437   937 75497]
 [58251   814 85065]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10408
{'0': {'precision': 0.3789171974522293, 'recall': 0.4811783166442888, 'f1-score': 0.4239685854173051, 'support': 61817}, '1': {'precision': 0.3300395256916996, 'recall': 0.003196722880496162, 'f1-score': 0.006332113674711357, 'support': 52241}, '2': {'precision': 0.3297197745845143, 'recall': 0.5374921348314606, 'f1-score': 0.4087162171398887, 'support': 55625}, 'accuracy': 0.35248080243748636, 'macro avg': {'precision': 0.34622549924281437, 'recall': 0.34062239145208184, 'f1-score': 0.2796723054106351, 'support': 169683}, 'weighted avg': {'precision': 0.3477412688237958, 'recall': 0.35248080243748636, 'f1-score': 0.29038914666541993, 'support': 169683}}
[[29745   179 31893]
 [23188   167 28886]
 [25567   160 29898]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905229
{'0': {'precision': 0.376216081807727, 'recall': 0.5552293577981652, 'f1-score': 0.44852055657458356, 'support': 21800}, '1': {'precision': 0.35658914728682173, 'recall': 0.0020920502092050207, 'f1-score': 0.004159696161323868, 'support': 21988}, '2': {'precision': 0.39128020805937874, 'recall': 0.5889597536837475, 'f1-score': 0.4701875131680595, 'support': 22735}, 'accuracy': 0.3839273634682741, 'macro avg': {'precision': 0.37469514571797585, 'recall': 0.3820937205637059, 'f1-score': 0.3076225886346557, 'support': 66523}, 'weighted avg': {'precision': 0.37487708437955386, 'recall': 0.3839273634682741, 'f1-score': 0.3090498721404168, 'support': 66523}}
[[12104    45  9651]
 [10762    46 11180]
 [ 9307    38 13390]]
Evaluating performance on  val set...
51/51 - 0s - 462ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1040695
{'0': {'precision': 0.34460065809153456, 'recall': 0.5649828347229033, 'f1-score': 0.42809364548494977, 'support': 4078}, '1': {'precision': 0.4222222222222222, 'recall': 0.0037571682815898755, 'f1-score': 0.007448059584476675, 'support': 5057}, '2': {'precision': 0.31082406801831264, 'recall': 0.5121228448275862, 'f1-score': 0.3868538868538869, 'support': 3712}, 'accuracy': 0.3287927142523546, 'macro avg': {'precision': 0.3592156494440231, 'recall': 0.3602876159440265, 'f1-score': 0.2741318639744378, 'support': 12847}, 'weighted avg': {'precision': 0.36539567229384545, 'recall': 0.3287927142523546, 'f1-score': 0.2505979879822489, 'support': 12847}}
[[2304   13 1761]
 [2584   19 2454]
 [1798   13 1901]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
1645/1645 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0841023
{'0': {'precision': 0.3837041143992423, 'recall': 0.6263774390381874, 'f1-score': 0.4758894956707104, 'support': 132583}, '1': {'precision': 0.43009605122732125, 'recall': 0.004890005217623433, 'f1-score': 0.00967006598680264, 'support': 164826}, '2': {'precision': 0.36949421794213994, 'recall': 0.6059662124987863, 'f1-score': 0.4590673384575779, 'support': 123596}, 'accuracy': 0.3770691559482666, 'macro avg': {'precision': 0.39443146118956784, 'recall': 0.41241121891819904, 'f1-score': 0.314875633371697, 'support': 421005}, 'weighted avg': {'precision': 0.3976951858048383, 'recall': 0.3770691559482666, 'f1-score': 0.28842323028195227, 'support': 421005}}
[[83047   546 48990]
 [85209   806 78811]
 [48179   522 74895]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.074479
{'0': {'precision': 0.4332934624635053, 'recall': 0.5779253083560634, 'f1-score': 0.4952662373937844, 'support': 58293}, '1': {'precision': 0.3364595545134818, 'recall': 0.005481806895234457, 'f1-score': 0.010787851450909639, 'support': 52355}, '2': {'precision': 0.407375953982381, 'recall': 0.639363781766483, 'f1-score': 0.4976622586178276, 'support': 56270}, 'accuracy': 0.4190860182844271, 'macro avg': {'precision': 0.39237632365312275, 'recall': 0.40759029900592697, 'f1-score': 0.33457211582084057, 'support': 166918}, 'weighted avg': {'precision': 0.3941837352144588, 'recall': 0.4190860182844271, 'f1-score': 0.3441139243912185, 'support': 166918}}
[[33689   300 24304]
 [24035   287 28033]
 [20027   266 35977]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0737734
{'0': {'precision': 0.4500802113805794, 'recall': 0.5699689292543021, 'f1-score': 0.5029791721592407, 'support': 16736}, '1': {'precision': 0.40082644628099173, 'recall': 0.006787963610916725, 'f1-score': 0.013349848609964217, 'support': 14290}, '2': {'precision': 0.39579142190391886, 'recall': 0.6444575471698113, 'f1-score': 0.49040331023480727, 'support': 15264}, 'accuracy': 0.42067401166558654, 'macro avg': {'precision': 0.41556602652183, 'recall': 0.40707148001167665, 'f1-score': 0.33557744366800407, 'support': 46290}, 'weighted avg': {'precision': 0.4169737005608591, 'recall': 0.42067401166558654, 'f1-score': 0.3476808141999901, 'support': 46290}}
[[9539   67 7130]
 [6306   97 7887]
 [5349   78 9837]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096832
{'0': {'precision': 0.3748641260652838, 'recall': 0.5182741387589592, 'f1-score': 0.4350555557629074, 'support': 112454}, '1': {'precision': 0.3405693950177936, 'recall': 0.008391130128278195, 'f1-score': 0.016378712807742665, 'support': 114049}, '2': {'precision': 0.36196656833824975, 'recall': 0.586942062920816, 'f1-score': 0.44778474413690517, 'support': 109757}, 'accuracy': 0.36775114494736216, 'macro avg': {'precision': 0.35913336314044236, 'recall': 0.3712024439360178, 'f1-score': 0.2997396709025184, 'support': 336260}, 'weighted avg': {'precision': 0.3590225837329181, 'recall': 0.36775114494736216, 'f1-score': 0.2972081824986812, 'support': 336260}}
[[58282   975 53197]
 [52735   957 60357]
 [44458   878 64421]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954417
{'0': {'precision': 0.3728674616800458, 'recall': 0.5312017980697192, 'f1-score': 0.4381696732857727, 'support': 45382}, '1': {'precision': 0.3633572159672467, 'recall': 0.007953043439299236, 'f1-score': 0.015565396588766604, 'support': 44637}, '2': {'precision': 0.36699420951044043, 'recall': 0.5704220550467056, 'f1-score': 0.4466352869993861, 'support': 43999}, 'accuracy': 0.3698010714978585, 'macro avg': {'precision': 0.3677396290525776, 'recall': 0.36985896551857467, 'f1-score': 0.3001234522913085, 'support': 134018}, 'weighted avg': {'precision': 0.3677716830526026, 'recall': 0.3698010714978585, 'f1-score': 0.3001933674079132, 'support': 134018}}
[[24107   338 20937]
 [21929   355 22353]
 [18617   284 25098]]
Evaluating performance on  val set...
107/107 - 1s - 711ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097865
{'0': {'precision': 0.3663126202224638, 'recall': 0.48628844232263796, 'f1-score': 0.41785918717801945, 'support': 9007}, '1': {'precision': 0.4, 'recall': 0.008406893652795292, 'f1-score': 0.016467682173734045, 'support': 9516}, '2': {'precision': 0.35948844334909746, 'recall': 0.6241471030415173, 'f1-score': 0.4562130177514793, 'support': 8647}, 'accuracy': 0.3627898417372102, 'macro avg': {'precision': 0.37526702119052047, 'recall': 0.3729474796723169, 'f1-score': 0.29684662903441095, 'support': 27170}, 'weighted avg': {'precision': 0.3759394309894508, 'recall': 0.3627898417372102, 'f1-score': 0.28948244854526006, 'support': 27170}}
[[4380   69 4558]
 [4378   80 5058]
 [3199   51 5397]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940431
{'0': {'precision': 0.37532700781353767, 'recall': 0.5775423879429851, 'f1-score': 0.45497789585324105, 'support': 112532}, '1': {'precision': 0.3167317708333333, 'recall': 0.009108440050924886, 'f1-score': 0.017707650869913376, 'support': 106824}, '2': {'precision': 0.3770023428125179, 'recall': 0.5191379611820248, 'f1-score': 0.4367981815707492, 'support': 114380}, 'accuracy': 0.3755783014118944, 'macro avg': {'precision': 0.3563537071531296, 'recall': 0.36859626305864496, 'f1-score': 0.3031612427646346, 'support': 333736}, 'weighted avg': {'precision': 0.35714571248432536, 'recall': 0.3755783014118944, 'f1-score': 0.3087834416447337, 'support': 333736}}
[[64992  1024 46516]
 [54243   973 51608]
 [53926  1075 59379]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970237
{'0': {'precision': 0.3624799791410586, 'recall': 0.5964573565014863, 'f1-score': 0.4509238343469447, 'support': 32631}, '1': {'precision': 0.3300970873786408, 'recall': 0.010499984558846237, 'f1-score': 0.020352578492113377, 'support': 32381}, '2': {'precision': 0.3734289193722571, 'recall': 0.48903198627869887, 'f1-score': 0.42348281522787085, 'support': 33233}, 'accuracy': 0.3669906865489338, 'macro avg': {'precision': 0.3553353286306522, 'recall': 0.3653297757796772, 'f1-score': 0.29825307602230966, 'support': 98245}, 'weighted avg': {'precision': 0.3555104205125744, 'recall': 0.3669906865489338, 'f1-score': 0.2997275879810281, 'support': 98245}}
[[19463   362 12806]
 [17578   340 14463]
 [16653   328 16252]]
Evaluating performance on  val set...
93/93 - 1s - 622ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001468
{'0': {'precision': 0.33447847379577517, 'recall': 0.6295226303480533, 'f1-score': 0.4368496420047732, 'support': 7269}, '1': {'precision': 0.3422818791946309, 'recall': 0.012583271650629163, 'f1-score': 0.02427415516420752, 'support': 8106}, '2': {'precision': 0.37932467532467534, 'recall': 0.44367480860371855, 'f1-score': 0.40898398118068785, 'support': 8229}, 'accuracy': 0.3528639213692594, 'macro avg': {'precision': 0.35202834277169376, 'recall': 0.3619269035341337, 'f1-score': 0.2900359261165562, 'support': 23604}, 'weighted avg': {'precision': 0.35279290340704633, 'recall': 0.3528639213692594, 'f1-score': 0.2854497343937317, 'support': 23604}}
[[4576  101 2592]
 [4622  102 3382]
 [4483   95 3651]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
2607/2607 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103003
{'0': {'precision': 0.35892888703826303, 'recall': 0.5199621586904823, 'f1-score': 0.42469300336548776, 'support': 230436}, '1': {'precision': 0.31542513167795333, 'recall': 0.010047697802066106, 'f1-score': 0.019475029036004645, 'support': 208605}, '2': {'precision': 0.3602883359186883, 'recall': 0.5158762145917483, 'f1-score': 0.42426775378440557, 'support': 228266}, 'accuracy': 0.35916152535489665, 'macro avg': {'precision': 0.34488078487830154, 'recall': 0.34862869036143224, 'f1-score': 0.28947859539529935, 'support': 667307}, 'weighted avg': {'precision': 0.3457943253915273, 'recall': 0.35916152535489665, 'f1-score': 0.2978734651980819, 'support': 667307}}
[[119818   2373 108245]
 [105670   2096 100839]
 [108333   2176 117757]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992267
{'0': {'precision': 0.3617388455027033, 'recall': 0.5367486183816021, 'f1-score': 0.43219929791593265, 'support': 61703}, '1': {'precision': 0.353110599078341, 'recall': 0.010067499876825042, 'f1-score': 0.01957684630738523, 'support': 60889}, '2': {'precision': 0.3638004989714186, 'recall': 0.5354905213651812, 'f1-score': 0.4332562306564587, 'support': 62087}, 'accuracy': 0.36267794389183394, 'macro avg': {'precision': 0.35954998118415427, 'recall': 0.3607688798745361, 'f1-score': 0.2950107916265922, 'support': 184679}, 'weighted avg': {'precision': 0.3595872017445019, 'recall': 0.36267794389183394, 'f1-score': 0.29651225892973604, 'support': 184679}}
[[33119   554 28030]
 [30165   613 30111]
 [28271   569 33247]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0999532
{'0': {'precision': 0.371540052024278, 'recall': 0.5433838950397503, 'f1-score': 0.44132385272039454, 'support': 20503}, '1': {'precision': 0.3375224416517056, 'recall': 0.010945505356311131, 'f1-score': 0.021203406079061637, 'support': 17176}, '2': {'precision': 0.37251487447395154, 'recall': 0.5026434305854709, 'f1-score': 0.4279046507751292, 'support': 20428}, 'accuracy': 0.3716763901079044, 'macro avg': {'precision': 0.36052578938331165, 'recall': 0.3523242769938441, 'f1-score': 0.2968106365248618, 'support': 58107}, 'weighted avg': {'precision': 0.3618274046193634, 'recall': 0.3716763901079044, 'f1-score': 0.31242171960649406, 'support': 58107}}
[[11141   186  9176]
 [ 8868   188  8120]
 [ 9977   183 10268]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/EXC
Evaluating performance on  test set...
5343/5343 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0840303
{'0': {'precision': 0.4020391799782221, 'recall': 0.5773484804317589, 'f1-score': 0.47400374543679813, 'support': 480268}, '1': {'precision': 0.31361175560711524, 'recall': 0.010085760050938685, 'f1-score': 0.019543016323599578, 'support': 402052}, '2': {'precision': 0.40800703584824816, 'recall': 0.5590363034128174, 'f1-score': 0.47172807221093854, 'support': 485464}, 'accuracy': 0.4041054727939499, 'macro avg': {'precision': 0.3745526571445285, 'recall': 0.38215684796517163, 'f1-score': 0.3217582779904454, 'support': 1367784}, 'weighted avg': {'precision': 0.37816461817521374, 'recall': 0.4041054727939499, 'f1-score': 0.339610008934296, 'support': 1367784}}
[[277282   4758 198228]
 [202452   4055 195545]
 [209955   4117 271392]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.080789
{'0': {'precision': 0.3927488495427899, 'recall': 0.6060644983714849, 'f1-score': 0.47662786041293126, 'support': 108995}, '1': {'precision': 0.35645604395604397, 'recall': 0.009498101294779704, 'f1-score': 0.01850316853391802, 'support': 109285}, '2': {'precision': 0.41129432769015095, 'recall': 0.5846894912285405, 'f1-score': 0.4828983496206194, 'support': 111897}, 'accuracy': 0.4013635110864779, 'macro avg': {'precision': 0.3868330737296615, 'recall': 0.4000840302982684, 'f1-score': 0.32600979285582293, 'support': 330177}, 'weighted avg': {'precision': 0.3870213885437128, 'recall': 0.4013635110864779, 'f1-score': 0.3271186334797249, 'support': 330177}}
[[66058   975 41962]
 [56563  1038 51684]
 [45573   899 65425]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0865383
{'0': {'precision': 0.37826776914724797, 'recall': 0.5988958312671493, 'f1-score': 0.4636746394338439, 'support': 30249}, '1': {'precision': 0.3637640449438202, 'recall': 0.007881443612683342, 'f1-score': 0.015428605468517305, 'support': 32862}, '2': {'precision': 0.3816003616636528, 'recall': 0.5677866343793092, 'f1-score': 0.4564368080245495, 'support': 29733}, 'accuracy': 0.3797445176855801, 'macro avg': {'precision': 0.37454405858490697, 'recall': 0.3915213030863806, 'f1-score': 0.3118466843089702, 'support': 92844}, 'weighted avg': {'precision': 0.37420144917522197, 'recall': 0.3797445176855801, 'f1-score': 0.3027007088679365, 'support': 92844}}
[[18116   240 11893]
 [17138   259 15465]
 [12638   213 16882]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/AAL
Evaluating performance on  test set...
7177/7177 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0874344
{'0': {'precision': 0.40086076905826873, 'recall': 0.5591115206180405, 'f1-score': 0.46694238272202265, 'support': 649019}, '1': {'precision': 0.3376683697166744, 'recall': 0.009053388126879081, 'f1-score': 0.01763398310062182, 'support': 562110}, '2': {'precision': 0.38776647730743385, 'recall': 0.5679242118043629, 'f1-score': 0.4608645317945902, 'support': 625955}, 'accuracy': 0.3938077953974886, 'macro avg': {'precision': 0.375431872027459, 'recall': 0.3786963735164275, 'f1-score': 0.31514696587241153, 'support': 1837084}, 'weighted avg': {'precision': 0.37706353551489386, 'recall': 0.3938077953974886, 'f1-score': 0.32739231005878755, 'support': 1837084}}
[[362874   5422 280723]
 [276463   5089 280558]
 [265900   4560 355495]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0841081
{'0': {'precision': 0.3961954042600608, 'recall': 0.5805376832373246, 'f1-score': 0.4709707596529571, 'support': 195989}, '1': {'precision': 0.3680456490727532, 'recall': 0.005460057457581385, 'f1-score': 0.01076048025941933, 'support': 189009}, '2': {'precision': 0.39737683029023857, 'recall': 0.5934384346959123, 'f1-score': 0.4760093884002858, 'support': 192576}, 'accuracy': 0.39664700973381767, 'macro avg': {'precision': 0.3872059612076842, 'recall': 0.3931453917969394, 'f1-score': 0.3192468761042207, 'support': 577574}, 'weighted avg': {'precision': 0.38737741248929153, 'recall': 0.39664700973381767, 'f1-score': 0.3220486029626497, 'support': 577574}}
[[113779    947  81263]
 [ 95931   1032  92046]
 [ 77469    825 114282]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0807698
{'0': {'precision': 0.4136364210074594, 'recall': 0.5816000567899482, 'f1-score': 0.4834448320880385, 'support': 56348}, '1': {'precision': 0.3993993993993994, 'recall': 0.0075415351465779575, 'f1-score': 0.014803546915000186, 'support': 52907}, '2': {'precision': 0.39514314251675714, 'recall': 0.6072643882231099, 'f1-score': 0.4787600877736548, 'support': 54072}, 'accuracy': 0.40414016053683716, 'macro avg': {'precision': 0.40272632097453864, 'recall': 0.3988019933865454, 'f1-score': 0.3256694889255645, 'support': 163327}, 'weighted avg': {'precision': 0.402902086471425, 'recall': 0.40414016053683716, 'f1-score': 0.33008551018034843, 'support': 163327}}
[[32772   293 23283]
 [25528   399 26980]
 [20929   307 32836]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/WBA
Evaluating performance on  test set...
5696/5696 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968771
{'0': {'precision': 0.3790094157983462, 'recall': 0.5190989551489533, 'f1-score': 0.4381283998611823, 'support': 511939}, '1': {'precision': 0.3115898663474965, 'recall': 0.007162509170946442, 'f1-score': 0.014003128740032185, 'support': 436160}, '2': {'precision': 0.3757101673604872, 'recall': 0.5502667085032946, 'f1-score': 0.44653555079725415, 'support': 509920}, 'accuracy': 0.3768558571596118, 'macro avg': {'precision': 0.35543648316877663, 'recall': 0.3588427242743981, 'f1-score': 0.2995556931328229, 'support': 1458019}, 'weighted avg': {'precision': 0.35768729074242056, 'recall': 0.3768558571596118, 'f1-score': 0.31419345535985616, 'support': 1458019}}
[[265747   3534 242658]
 [209455   3124 223581]
 [225960   3368 280592]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943614
{'0': {'precision': 0.375429814094372, 'recall': 0.5497087208010049, 'f1-score': 0.44615381388197234, 'support': 193457}, '1': {'precision': 0.3399322740296952, 'recall': 0.007077543848231427, 'f1-score': 0.013866383317837691, 'support': 184386}, '2': {'precision': 0.37108593797177436, 'recall': 0.5475927139300223, 'f1-score': 0.442383101979284, 'support': 190775}, 'accuracy': 0.3730395450020928, 'macro avg': {'precision': 0.3621493420319472, 'recall': 0.3681263261930862, 'f1-score': 0.30080109972636465, 'support': 568618}, 'weighted avg': {'precision': 0.3624616133169536, 'recall': 0.3730395450020928, 'f1-score': 0.3047106873273541, 'support': 568618}}
[[106345   1328  85784]
 [ 91815   1305  91266]
 [ 85102   1206 104467]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895314
{'0': {'precision': 0.40802123779633054, 'recall': 0.5470345607557463, 'f1-score': 0.4674108443408627, 'support': 60126}, '1': {'precision': 0.3088071348940914, 'recall': 0.005978976451034989, 'f1-score': 0.01173082623978317, 'support': 46329}, '2': {'precision': 0.3877067696567806, 'recall': 0.5562370406509731, 'f1-score': 0.4569273379183991, 'support': 57391}, 'accuracy': 0.3972693871074057, 'macro avg': {'precision': 0.36817838078240084, 'recall': 0.36975019261925146, 'f1-score': 0.31202300283301504, 'support': 163846}, 'weighted avg': {'precision': 0.3728518847797494, 'recall': 0.3972693871074057, 'f1-score': 0.33489092639537416, 'support': 163846}}
[[32891   325 26910]
 [22547   277 23505]
 [25173   295 31923]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
12066/12066 - 64s - 64s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098411
{'0': {'precision': 0.35585433130322613, 'recall': 0.5936076423912146, 'f1-score': 0.4449632665490858, 'support': 1004293}, '1': {'precision': 0.36535680343787447, 'recall': 0.008457812332603804, 'f1-score': 0.016532897043356316, 'support': 1045424}, '2': {'precision': 0.3772074091934747, 'recall': 0.5043450227115251, 'f1-score': 0.43160831385952086, 'support': 1039120}, 'accuracy': 0.36553337065050695, 'macro avg': {'precision': 0.36613951464485844, 'recall': 0.36880349247844785, 'f1-score': 0.29770149248398764, 'support': 3088837}, 'weighted avg': {'precision': 0.36625388386174823, 'recall': 0.36553337065050695, 'f1-score': 0.2954672623737478, 'support': 3088837}}
[[596156   7572 400565]
 [571867   8842 464715]
 [507258   7787 524075]]
Evaluating performance on  train set...
2948/2948 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09366
{'0': {'precision': 0.3782641618690215, 'recall': 0.5395465194774253, 'f1-score': 0.4447346628829165, 'support': 251830}, '1': {'precision': 0.3506634172759274, 'recall': 0.005179274901513788, 'f1-score': 0.010207781561357045, 'support': 250035}, '2': {'precision': 0.37531251356672785, 'recall': 0.5817785958870217, 'f1-score': 0.4562758654947702, 'support': 252615}, 'accuracy': 0.37659712649772026, 'macro avg': {'precision': 0.3680800309038923, 'recall': 0.3755014634219869, 'f1-score': 0.30373943664634795, 'support': 754480}, 'weighted avg': {'precision': 0.36812899220220696, 'recall': 0.37659712649772026, 'f1-score': 0.30459649106465403, 'support': 754480}}
[[135874   1202 114754]
 [118877   1295 129863]
 [104453   1196 146966]]
Evaluating performance on  val set...
697/697 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935887
{'0': {'precision': 0.379845990440786, 'recall': 0.5341854228197033, 'f1-score': 0.44398515864170535, 'support': 58914}, '1': {'precision': 0.40791268758526605, 'recall': 0.004805914972273568, 'f1-score': 0.009499904683230604, 'support': 62215}, '2': {'precision': 0.3657438169066076, 'recall': 0.6055071502156414, 'f1-score': 0.4560314558868009, 'support': 57271}, 'accuracy': 0.3724663677130045, 'macro avg': {'precision': 0.38450083164421994, 'recall': 0.38149949600253946, 'f1-score': 0.3031721730705789, 'support': 178400}, 'weighted avg': {'precision': 0.38510677509531455, 'recall': 0.3724663677130045, 'f1-score': 0.2963304692610852, 'support': 178400}}
[[31471   232 27211]
 [28990   299 32926]
 [22391   202 34678]]
testing model on single stock: results/universal/W1/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
21353/21353 - 103s - 103s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913445
{'0': {'precision': 0.40000970555384663, 'recall': 0.5115603059792477, 'f1-score': 0.4489596734838738, 'support': 1998044}, '1': {'precision': 0.29998359849106115, 'recall': 0.004990028128589397, 'f1-score': 0.009816760951941346, 'support': 1466124}, '2': {'precision': 0.3981066214552416, 'recall': 0.5739978741725956, 'f1-score': 0.4701394869319216, 'support': 2002044}, 'accuracy': 0.3985584532762359, 'macro avg': {'precision': 0.3660333085000498, 'recall': 0.3635160694268109, 'f1-score': 0.3096386404559122, 'support': 5466212}, 'weighted avg': {'precision': 0.37248411117652885, 'recall': 0.3985584532762359, 'f1-score': 0.3389319165914987, 'support': 5466212}}
[[1022120    8714  967210]
 [ 688601    7316  770207]
 [ 844517    8358 1149169]]
Evaluating performance on  train set...
6073/6073 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959197
{'0': {'precision': 0.37010673791389187, 'recall': 0.5362346193771294, 'f1-score': 0.4379454697452167, 'support': 519241}, '1': {'precision': 0.3576890399320306, 'recall': 0.005742803470235636, 'f1-score': 0.011304116010072822, 'support': 513164}, '2': {'precision': 0.3703394441337827, 'recall': 0.5631564230831105, 'f1-score': 0.4468344081838572, 'support': 522148}, 'accuracy': 0.3701597822653843, 'macro avg': {'precision': 0.3660450739932351, 'recall': 0.36837794864349177, 'f1-score': 0.2986946646463822, 'support': 1554553}, 'weighted avg': {'precision': 0.36608576951985167, 'recall': 0.3701597822653843, 'f1-score': 0.3000951409238242, 'support': 1554553}}
[[278435   2652 238154]
 [248418   2947 261799]
 [225457   2640 294051]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097368
{'0': {'precision': 0.3681367896151121, 'recall': 0.5343842785155669, 'f1-score': 0.4359488540715684, 'support': 154591}, '1': {'precision': 0.3342830009496676, 'recall': 0.007331093277054233, 'f1-score': 0.014347533677982107, 'support': 144044}, '2': {'precision': 0.37508600792579366, 'recall': 0.5432178964031862, 'f1-score': 0.44376035261355995, 'support': 158557}, 'accuracy': 0.37139320023097516, 'macro avg': {'precision': 0.3591685994968578, 'recall': 0.36164442273193576, 'f1-score': 0.29801891345437015, 'support': 457192}, 'weighted avg': {'precision': 0.3598807660476862, 'recall': 0.37139320023097516, 'f1-score': 0.305827214103128, 'support': 457192}}
[[82611  1028 70952]
 [70441  1056 72547]
 [71351  1075 86131]]
training model: results/universal/W1/deepLOB_L2/h50
Epoch 1/50
10622/10622 - 424s - loss: 3.0808 - accuracy50: 0.4598 - val_loss: 3.4885 - val_accuracy50: 0.3968 - 424s/epoch - 40ms/step
Epoch 2/50
10622/10622 - 420s - loss: 3.0236 - accuracy50: 0.4797 - val_loss: 3.3767 - val_accuracy50: 0.4285 - 420s/epoch - 39ms/step
Epoch 3/50
10622/10622 - 418s - loss: 2.9769 - accuracy50: 0.4939 - val_loss: 3.3196 - val_accuracy50: 0.4343 - 418s/epoch - 39ms/step
Epoch 4/50
10622/10622 - 419s - loss: 2.9395 - accuracy50: 0.5035 - val_loss: 3.2432 - val_accuracy50: 0.4488 - 419s/epoch - 39ms/step
Epoch 5/50
10622/10622 - 419s - loss: 2.9142 - accuracy50: 0.5095 - val_loss: 3.2452 - val_accuracy50: 0.4506 - 419s/epoch - 39ms/step
Epoch 6/50
10622/10622 - 419s - loss: 2.8968 - accuracy50: 0.5136 - val_loss: 3.2190 - val_accuracy50: 0.4573 - 419s/epoch - 39ms/step
Epoch 7/50
10622/10622 - 418s - loss: 2.8853 - accuracy50: 0.5163 - val_loss: 3.2299 - val_accuracy50: 0.4555 - 418s/epoch - 39ms/step
Epoch 8/50
10622/10622 - 417s - loss: 2.8777 - accuracy50: 0.5180 - val_loss: 3.2474 - val_accuracy50: 0.4570 - 417s/epoch - 39ms/step
Epoch 9/50
10622/10622 - 419s - loss: 2.8717 - accuracy50: 0.5193 - val_loss: 3.2827 - val_accuracy50: 0.4534 - 419s/epoch - 39ms/step
Epoch 10/50
10622/10622 - 420s - loss: 2.8674 - accuracy50: 0.5205 - val_loss: 3.3124 - val_accuracy50: 0.4529 - 420s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 419s - loss: 2.8631 - accuracy50: 0.5215 - val_loss: 3.3617 - val_accuracy50: 0.4459 - 419s/epoch - 39ms/step
Epoch 12/50
10622/10622 - 428s - loss: 2.8597 - accuracy50: 0.5223 - val_loss: 3.3914 - val_accuracy50: 0.4418 - 428s/epoch - 40ms/step
Epoch 13/50
10622/10622 - 422s - loss: 2.8566 - accuracy50: 0.5229 - val_loss: 3.4465 - val_accuracy50: 0.4403 - 422s/epoch - 40ms/step
Epoch 14/50
10622/10622 - 432s - loss: 2.8542 - accuracy50: 0.5236 - val_loss: 3.4183 - val_accuracy50: 0.4422 - 432s/epoch - 41ms/step
Epoch 15/50
10622/10622 - 430s - loss: 2.8515 - accuracy50: 0.5243 - val_loss: 3.4419 - val_accuracy50: 0.4411 - 430s/epoch - 40ms/step
Epoch 16/50
10622/10622 - 427s - loss: 2.8491 - accuracy50: 0.5248 - val_loss: 3.4985 - val_accuracy50: 0.4416 - 427s/epoch - 40ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 508s - 508s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0910363
{'0': {'precision': 0.4451255188268779, 'recall': 0.5576568574770048, 'f1-score': 0.4950771052174842, 'support': 3163700}, '1': {'precision': 0.38885736894754913, 'recall': 0.5562863058162222, 'f1-score': 0.4577421085007287, 'support': 2715474}, '2': {'precision': 0.48619896780092875, 'recall': 0.18397515853450255, 'f1-score': 0.26694116846796073, 'support': 3167607}, 'accuracy': 0.42640592272544237, 'macro avg': {'precision': 0.4400606185251186, 'recall': 0.43263944060924314, 'f1-score': 0.40658679406205794, 'support': 9046781}, 'weighted avg': {'precision': 0.44261742743602034, 'recall': 0.42640592272544237, 'f1-score': 0.4039919774716282, 'support': 9046781}}
[[1764259 1094997  304444]
 [ 893492 1510581  311401]
 [1305758 1279088  582761]]
Evaluating performance on  train set...
10622/10622 - 151s - 151s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0418253
{'0': {'precision': 0.456536850101041, 'recall': 0.45154297945529115, 'f1-score': 0.4540261831968586, 'support': 846544}, '1': {'precision': 0.472239923148289, 'recall': 0.674444798910246, 'f1-score': 0.5555140901037998, 'support': 1021882}, '2': {'precision': 0.490637654221472, 'recall': 0.24344420812904075, 'f1-score': 0.32542118620880517, 'support': 850088}, 'accuracy': 0.47025801596019, 'macro avg': {'precision': 0.47313814249026737, 'recall': 0.456477328831526, 'f1-score': 0.44498715316982124, 'support': 2718514}, 'weighted avg': {'precision': 0.4731030226735556, 'recall': 0.47025801596019, 'f1-score': 0.45196001786031753, 'support': 2718514}}
[[382251 359793 104500]
 [222332 689203 110347]
 [232701 410438 206949]]
Evaluating performance on  val set...
3064/3064 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0594639
{'0': {'precision': 0.4687012318800522, 'recall': 0.4362110928626551, 'f1-score': 0.45187289639933254, 'support': 252685}, '1': {'precision': 0.4452608515876373, 'recall': 0.6716203380110042, 'f1-score': 0.5355023370996529, 'support': 278985}, '2': {'precision': 0.47049571579482763, 'recall': 0.23849699335205546, 'f1-score': 0.3165386954038268, 'support': 252108}, 'accuracy': 0.45640857487706976, 'macro avg': {'precision': 0.4614859330875057, 'recall': 0.4487761414085716, 'f1-score': 0.43463797630093737, 'support': 783778}, 'weighted avg': {'precision': 0.4609348608603334, 'recall': 0.45640857487706976, 'f1-score': 0.4381094643678184, 'support': 783778}}
[[110224 107604  34857]
 [ 58802 187372  32811]
 [ 66143 125838  60127]]
testing model out of sample: results/universal/W1/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 320s - 320s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9764641
{'0': {'precision': 0.47926864420310894, 'recall': 0.49859084203561244, 'f1-score': 0.48873884282420965, 'support': 1824139}, '1': {'precision': 0.5387061012788534, 'recall': 0.7163027970665811, 'f1-score': 0.6149385676095264, 'support': 2469337}, '2': {'precision': 0.5039902843356696, 'recall': 0.25625013844892897, 'f1-score': 0.33975457307279283, 'support': 1805720}, 'accuracy': 0.5149872212665407, 'macro avg': {'precision': 0.5073216766058773, 'recall': 0.4903812591837074, 'f1-score': 0.4811439945021763, 'support': 6099196}, 'weighted avg': {'precision': 0.5106517104241675, 'recall': 0.5149872212665407, 'f1-score': 0.4957243166844809, 'support': 6099196}}
[[ 909499  722242  192398]
 [ 437553 1768793  262991]
 [ 550629  792375  462716]]
Evaluating performance on  train set...
6711/6711 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9881808
{'0': {'precision': 0.4829652919358404, 'recall': 0.4318893887747339, 'f1-score': 0.4560015686241437, 'support': 500781}, '1': {'precision': 0.5452086651261623, 'recall': 0.7186708671326529, 'f1-score': 0.6200362837337535, 'support': 718333}, '2': {'precision': 0.4927351579913262, 'recall': 0.3190656089159393, 'f1-score': 0.38732371199337184, 'support': 498164}, 'accuracy': 0.5191203753847659, 'macro avg': {'precision': 0.5069697050177763, 'recall': 0.4898752882744421, 'f1-score': 0.4877871881170897, 'support': 1717278}, 'weighted avg': {'precision': 0.5118356696775855, 'recall': 0.5191203753847659, 'f1-score': 0.5046941584309307, 'support': 1717278}}
[[216282 213364  71135]
 [109589 516245  92499]
 [121950 217267 158947]]
Evaluating performance on  val set...
1720/1720 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9517548
{'0': {'precision': 0.47532544882157746, 'recall': 0.46233230988223417, 'f1-score': 0.468738856282225, 'support': 120833}, '1': {'precision': 0.5991278901075215, 'recall': 0.722128686407442, 'f1-score': 0.6549029824541531, 'support': 200161}, '2': {'precision': 0.47149958677176235, 'recall': 0.32159112898476344, 'f1-score': 0.3823776559561442, 'support': 118859}, 'accuracy': 0.542524434299641, 'macro avg': {'precision': 0.5153176419002872, 'recall': 0.5020173750914799, 'f1-score': 0.5020064982308409, 'support': 439853}, 'weighted avg': {'precision': 0.5306295670448404, 'recall': 0.542524434299641, 'f1-score': 0.5301184347985513, 'support': 439853}}
[[ 55865  47776  17192]
 [ 29966 144542  25653]
 [ 31699  48936  38224]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1570476
{'0': {'precision': 0.38126447237843203, 'recall': 0.6078315040047464, 'f1-score': 0.4685987269239077, 'support': 60678}, '1': {'precision': 0.3062083165480507, 'recall': 0.2824175370515626, 'f1-score': 0.2938321450047247, 'support': 48446}, '2': {'precision': 0.41616554651574106, 'recall': 0.19425731457631595, 'f1-score': 0.26487606096764754, 'support': 60564}, 'accuracy': 0.36731530809485646, 'macro avg': {'precision': 0.3678794451474079, 'recall': 0.3615021185442083, 'f1-score': 0.34243564429875994, 'support': 169688}, 'weighted avg': {'precision': 0.37229258355125117, 'recall': 0.36731530809485646, 'f1-score': 0.3459913453257294, 'support': 169688}}
[[36882 15257  8539]
 [26798 13682  7966]
 [33056 15743 11765]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1517372
{'0': {'precision': 0.36555157927493387, 'recall': 0.5388532110091743, 'f1-score': 0.4355984054880875, 'support': 21800}, '1': {'precision': 0.3665597759812113, 'recall': 0.36936239930824194, 'f1-score': 0.36795575100875005, 'support': 21973}, '2': {'precision': 0.4198579243896464, 'recall': 0.22602197802197802, 'f1-score': 0.2938537588936194, 'support': 22750}, 'accuracy': 0.3758850322444869, 'macro avg': {'precision': 0.38398975988193057, 'recall': 0.3780791961131314, 'f1-score': 0.36580263846348565, 'support': 66523}, 'weighted avg': {'precision': 0.3844566565803282, 'recall': 0.3758850322444869, 'f1-score': 0.3647807520915385, 'support': 66523}}
[[11747  6820  3233]
 [ 9985  8116  3872]
 [10403  7205  5142]]
Evaluating performance on  val set...
51/51 - 1s - 873ms/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1726406
{'0': {'precision': 0.35007299270072995, 'recall': 0.586451455123502, 'f1-score': 0.4384313008501691, 'support': 4089}, '1': {'precision': 0.39767441860465114, 'recall': 0.3158866995073892, 'f1-score': 0.3520933424845573, 'support': 4872}, '2': {'precision': 0.3638928067700987, 'recall': 0.19917653113741637, 'f1-score': 0.2574422085481457, 'support': 3886}, 'accuracy': 0.36670039697983964, 'macro avg': {'precision': 0.3705467393584933, 'recall': 0.3671715619227692, 'f1-score': 0.3493222839609573, 'support': 12847}, 'weighted avg': {'precision': 0.3723052605046897, 'recall': 0.36670039697983964, 'f1-score': 0.35094300429510383, 'support': 12847}}
[[2398 1186  505]
 [2485 1539  848]
 [1967 1145  774]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
1645/1645 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9434184
{'0': {'precision': 0.36486280616822114, 'recall': 0.5855984351440564, 'f1-score': 0.4495987401640499, 'support': 73617}, '1': {'precision': 0.8041578937011747, 'recall': 0.5915629557520202, 'f1-score': 0.6816692903535201, 'support': 276329}, '2': {'precision': 0.35486041373769833, 'recall': 0.4972559945964201, 'f1-score': 0.41416047443801135, 'support': 71064}, 'accuracy': 0.5746015534072825, 'macro avg': {'precision': 0.5079603712023647, 'recall': 0.5581391284974989, 'f1-score': 0.5151428349851938, 'support': 421010}, 'weighted avg': {'precision': 0.6515048389636674, 'recall': 0.5746015534072825, 'f1-score': 0.5959359724097232, 'support': 421010}}
[[ 43110  21127   9380]
 [ 58000 163466  54863]
 [ 17044  18683  35337]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90292186
{'0': {'precision': 0.46046678787366285, 'recall': 0.5427069317785419, 'f1-score': 0.49821583786998486, 'support': 40134}, '1': {'precision': 0.6957328589625335, 'recall': 0.7252383732243627, 'f1-score': 0.7101792849897159, 'support': 87363}, '2': {'precision': 0.48991172761664564, 'recall': 0.3547855204079044, 'f1-score': 0.4115405552531301, 'support': 39421}, 'accuracy': 0.5938604584286895, 'macro avg': {'precision': 0.5487037914842806, 'recall': 0.5409102751369363, 'f1-score': 0.5399785593709436, 'support': 166918}, 'weighted avg': {'precision': 0.5905564051596662, 'recall': 0.5938604584286895, 'f1-score': 0.5886850282190307, 'support': 166918}}
[[21781 13490  4863]
 [14305 63359  9699]
 [11216 14219 13986]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85618013
{'0': {'precision': 0.5440492647982909, 'recall': 0.4174944546243611, 'f1-score': 0.47244352286369096, 'support': 10369}, '1': {'precision': 0.6976918318846241, 'recall': 0.8190399755407781, 'f1-score': 0.753511593973595, 'support': 26166}, '2': {'precision': 0.49868697478991597, 'recall': 0.3893388006150692, 'f1-score': 0.4372805250129526, 'support': 9755}, 'accuracy': 0.6385396413912292, 'macro avg': {'precision': 0.5801426904909436, 'recall': 0.5419577435934029, 'f1-score': 0.5544118806167462, 'support': 46290}, 'weighted avg': {'precision': 0.6213381451471631, 'recall': 0.6385396413912292, 'f1-score': 0.6239106238493854, 'support': 46290}}
[[ 4329  4761  1279]
 [ 2196 21431  2539]
 [ 1432  4525  3798]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1547903
{'0': {'precision': 0.42094705878583194, 'recall': 0.5251355111047153, 'f1-score': 0.4673043472074501, 'support': 125082}, '1': {'precision': 0.29246905810782464, 'recall': 0.40992861091182803, 'f1-score': 0.3413776554588104, 'support': 85027}, '2': {'precision': 0.4652983668856165, 'recall': 0.22516566790323092, 'f1-score': 0.30347480035255464, 'support': 126156}, 'accuracy': 0.3834654216168795, 'macro avg': {'precision': 0.3929048279264244, 'recall': 0.3867432633065915, 'f1-score': 0.37071893433960507, 'support': 336265}, 'weighted avg': {'precision': 0.40509969037397664, 'recall': 0.3834654216168795, 'f1-score': 0.37399921841813877, 'support': 336265}}
[[65685 40999 18398]
 [35927 34855 14245]
 [54429 43321 28406]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1507665
{'0': {'precision': 0.45895541935145895, 'recall': 0.38850579809760316, 'f1-score': 0.42080236314076774, 'support': 45101}, '1': {'precision': 0.39250779605000136, 'recall': 0.6669459477819796, 'f1-score': 0.4941819981711256, 'support': 44161}, '2': {'precision': 0.4650514373617921, 'recall': 0.21614978997229423, 'f1-score': 0.295127978278776, 'support': 44756}, 'accuracy': 0.4226969511558149, 'macro avg': {'precision': 0.4388382175877508, 'recall': 0.4238671786172923, 'f1-score': 0.40337077986355646, 'support': 134018}, 'weighted avg': {'precision': 0.4390956981905313, 'recall': 0.4226969511558149, 'f1-score': 0.4030124788990415, 'support': 134018}}
[[17522 22150  5429]
 [ 9009 29453  5699]
 [11647 23435  9674]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1239376
{'0': {'precision': 0.43411517182264475, 'recall': 0.5486507780185149, 'f1-score': 0.48470874842302175, 'support': 10154}, '1': {'precision': 0.3171607438777389, 'recall': 0.5033606078316774, 'f1-score': 0.38913362701908955, 'support': 6844}, '2': {'precision': 0.4929496402877698, 'recall': 0.16840346047974833, 'f1-score': 0.25104418553528246, 'support': 10172}, 'accuracy': 0.39488406330511594, 'macro avg': {'precision': 0.4147418519960511, 'recall': 0.4068049487766469, 'f1-score': 0.3749621869924646, 'support': 27170}, 'weighted avg': {'precision': 0.42668153576715395, 'recall': 0.39488406330511594, 'f1-score': 0.373153648511995, 'support': 27170}}
[[5571 3611  972]
 [2609 3445  790]
 [4653 3806 1713]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1785982
{'0': {'precision': 0.3648003550310052, 'recall': 0.5291548866947936, 'f1-score': 0.431869251440357, 'support': 114955}, '1': {'precision': 0.3192957328256275, 'recall': 0.34277463692702914, 'f1-score': 0.33061887041567, 'support': 106659}, '2': {'precision': 0.3621435238984245, 'recall': 0.16953989672425018, 'f1-score': 0.2309561414165958, 'support': 112127}, 'accuracy': 0.348770453735082, 'macro avg': {'precision': 0.34874653725168575, 'recall': 0.34715647344869094, 'f1-score': 0.33114808775754095, 'support': 333741}, 'weighted avg': {'precision': 0.34936509234465185, 'recall': 0.348770453735082, 'f1-score': 0.3320102329878853, 'support': 333741}}
[[60829 39636 14490]
 [51106 36560 18993]
 [54811 38306 19010]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1933253
{'0': {'precision': 0.34805851474448046, 'recall': 0.534877513494276, 'f1-score': 0.4217036500105221, 'support': 33718}, '1': {'precision': 0.31837683232034325, 'recall': 0.3344496259897969, 'f1-score': 0.32621537052583377, 'support': 31951}, '2': {'precision': 0.3890875174879527, 'recall': 0.15366669736317035, 'f1-score': 0.22031996127016262, 'support': 32577}, 'accuracy': 0.34329132992691813, 'macro avg': {'precision': 0.3518409548509254, 'recall': 0.34099794561574776, 'f1-score': 0.3227463272688395, 'support': 98246}, 'weighted avg': {'precision': 0.3520102520899244, 'recall': 0.34329132992691813, 'f1-score': 0.32387348444744607, 'support': 98246}}
[[18035 11899  3784]
 [17189 10686  4076]
 [16592 10979  5006]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1751356
{'0': {'precision': 0.3616870876531574, 'recall': 0.5662813575996065, 'f1-score': 0.44143021472392635, 'support': 8132}, '1': {'precision': 0.32682183430313105, 'recall': 0.32235583492757586, 'f1-score': 0.32457347275729226, 'support': 7318}, '2': {'precision': 0.3916256157635468, 'recall': 0.17549668874172186, 'f1-score': 0.24237804878048783, 'support': 8154}, 'accuracy': 0.355660057617353, 'macro avg': {'precision': 0.36004484590661173, 'recall': 0.35471129375630134, 'f1-score': 0.3361272454205688, 'support': 23604}, 'weighted avg': {'precision': 0.36121999877824734, 'recall': 0.355660057617353, 'f1-score': 0.3364383066229847, 'support': 23604}}
[[4605 2440 1087]
 [3823 2359 1136]
 [4304 2419 1431]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
2607/2607 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1404675
{'0': {'precision': 0.4041137742587891, 'recall': 0.6028450135232292, 'f1-score': 0.4838688070731652, 'support': 233672}, '1': {'precision': 0.3756679729248308, 'recall': 0.3317537408812946, 'f1-score': 0.3523478369827397, 'support': 203428}, '2': {'precision': 0.44632187461802286, 'recall': 0.26963842023873646, 'f1-score': 0.33617932741388223, 'support': 230212}, 'accuracy': 0.40525271537152036, 'macro avg': {'precision': 0.40870120726721426, 'recall': 0.40141239154775343, 'f1-score': 0.39079865715659573, 'support': 667312}, 'weighted avg': {'precision': 0.41000328130517133, 'recall': 0.40525271537152036, 'f1-score': 0.39282453034072534, 'support': 667312}}
[[140868  54793  38011]
 [ 96946  67488  38994]
 [110771  57367  62074]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1278391
{'0': {'precision': 0.41269423228864893, 'recall': 0.5078511124434866, 'f1-score': 0.4553544834400041, 'support': 61711}, '1': {'precision': 0.405535858680102, 'recall': 0.5380171972735225, 'f1-score': 0.4624758824197026, 'support': 60591}, '2': {'precision': 0.46795979545053784, 'recall': 0.21271922793292508, 'f1-score': 0.29248454255893663, 'support': 62378}, 'accuracy': 0.4180636777128005, 'macro avg': {'precision': 0.42872996213976294, 'recall': 0.4195291792166447, 'f1-score': 0.40343830280621445, 'support': 184680}, 'weighted avg': {'precision': 0.42901230833151677, 'recall': 0.4180636777128005, 'f1-score': 0.4026795403671196, 'support': 184680}}
[[31340 23215  7156]
 [20062 32599  7930]
 [24538 24571 13269]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.128719
{'0': {'precision': 0.42116775445404836, 'recall': 0.5856841485551685, 'f1-score': 0.4899852241011328, 'support': 20383}, '1': {'precision': 0.3783226262745329, 'recall': 0.3669048299514147, 'f1-score': 0.372526260809007, 'support': 17495}, '2': {'precision': 0.45459518599562365, 'recall': 0.28754325259515573, 'f1-score': 0.3522679101314116, 'support': 20230}, 'accuracy': 0.41601844840641566, 'macro avg': {'precision': 0.4180285222414016, 'recall': 0.4133774103672463, 'f1-score': 0.4049264650138505, 'support': 58108}, 'weighted avg': {'precision': 0.41990564635508515, 'recall': 0.41601844840641566, 'f1-score': 0.40667542468619505, 'support': 58108}}
[[11938  5121  3324]
 [ 7421  6419  3655]
 [ 8986  5427  5817]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
5343/5343 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9493035
{'0': {'precision': 0.47354662726601127, 'recall': 0.5534159159159159, 'f1-score': 0.5103754605213229, 'support': 346320}, '1': {'precision': 0.6063579995219549, 'recall': 0.7047339194404747, 'f1-score': 0.6518552107702191, 'support': 673142}, '2': {'precision': 0.5205777371959824, 'recall': 0.27006519735765533, 'f1-score': 0.35563444177289844, 'support': 348327}, 'accuracy': 0.5557260659356085, 'macro avg': {'precision': 0.5334941213279829, 'recall': 0.509405010904682, 'f1-score': 0.5059550376881469, 'support': 1367789}, 'weighted avg': {'precision': 0.5508853967485027, 'recall': 0.5557260659356085, 'f1-score': 0.5405961211674167, 'support': 1367789}}
[[191659 130361  24300]
 [136422 474386  62334]
 [ 76650 177606  94071]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8431279
{'0': {'precision': 0.47083692076737976, 'recall': 0.6053617552723454, 'f1-score': 0.5296915358633023, 'support': 70462}, '1': {'precision': 0.7213161542852483, 'recall': 0.7550012269676828, 'f1-score': 0.7377743951707493, 'support': 187454}, '2': {'precision': 0.5575100864553314, 'recall': 0.3346480120673669, 'f1-score': 0.41824345359576603, 'support': 72261}, 'accuracy': 0.6310706075832053, 'macro avg': {'precision': 0.5832210538359864, 'recall': 0.5650036647691318, 'f1-score': 0.5619031282099393, 'support': 330177}, 'weighted avg': {'precision': 0.6320123626232196, 'recall': 0.6310706075832053, 'f1-score': 0.623437055496359, 'support': 330177}}
[[ 42655  22767   5040]
 [ 31773 141528  14153]
 [ 16166  31913  24182]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8531915
{'0': {'precision': 0.46514702347568304, 'recall': 0.5853498689251865, 'f1-score': 0.518371355864101, 'support': 19836}, '1': {'precision': 0.7279087615342055, 'recall': 0.7635165493485098, 'f1-score': 0.7452875873726529, 'support': 53416}, '2': {'precision': 0.5431536319919008, 'recall': 0.32860351163740303, 'f1-score': 0.40947686436635394, 'support': 19592}, 'accuracy': 0.6336758433501357, 'macro avg': {'precision': 0.5787364723339298, 'recall': 0.5591566433036997, 'f1-score': 0.5577119358677026, 'support': 92844}, 'weighted avg': {'precision': 0.6327829124311758, 'recall': 0.6336758433501357, 'f1-score': 0.6259442366623965, 'support': 92844}}
[[11611  6787  1438]
 [ 8655 40784  3977]
 [ 4696  8458  6438]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
7177/7177 - 97s - 97s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87923
{'0': {'precision': 0.5389938618941398, 'recall': 0.40670279455326186, 'f1-score': 0.463595400036383, 'support': 435490}, '1': {'precision': 0.6698978066630499, 'recall': 0.7447188895282464, 'f1-score': 0.7053296515143788, 'support': 974937}, '2': {'precision': 0.47092012866824595, 'recall': 0.46870825149650075, 'f1-score': 0.46981158671239953, 'support': 426662}, 'accuracy': 0.6004875104036875, 'macro avg': {'precision': 0.5599372657418118, 'recall': 0.5400433118593364, 'f1-score': 0.5462455460877204, 'support': 1837089}, 'weighted avg': {'precision': 0.592654095032295, 'recall': 0.6004875104036875, 'f1-score': 0.5933266632319959, 'support': 1837089}}
[[177115 189518  68857]
 [ 93062 726054 155821]
 [ 58426 168256 199980]]
Evaluating performance on  train set...
2257/2257 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91968155
{'0': {'precision': 0.4866751221415867, 'recall': 0.48128604190323515, 'f1-score': 0.4839655802915078, 'support': 134739}, '1': {'precision': 0.7004761402263345, 'recall': 0.7040128297423767, 'f1-score': 0.7022400320577038, 'support': 311152}, '2': {'precision': 0.449686562060712, 'recall': 0.44941678563834636, 'f1-score': 0.449551633376252, 'support': 131684}, 'accuracy': 0.5940077046271047, 'macro avg': {'precision': 0.5456126081428777, 'recall': 0.5449052190946527, 'f1-score': 0.5452524152418211, 'support': 577575}, 'weighted avg': {'precision': 0.5934211080887201, 'recall': 0.5940077046271047, 'f1-score': 0.5937084985798112, 'support': 577575}}
[[ 64848  48187  21704]
 [ 41377 219055  50720]
 [ 27022  45481  59181]]
Evaluating performance on  val set...
638/638 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86729217
{'0': {'precision': 0.5311806400801891, 'recall': 0.4115265143110717, 'f1-score': 0.46375996249413975, 'support': 36056}, '1': {'precision': 0.7043590937620214, 'recall': 0.7608227356726553, 'f1-score': 0.7315029463867995, 'support': 91451}, '2': {'precision': 0.43649623074401833, 'recall': 0.4461349487730661, 'f1-score': 0.44126296025292333, 'support': 35821}, 'accuracy': 0.6146955818965517, 'macro avg': {'precision': 0.5573453215287429, 'recall': 0.5394947329189311, 'f1-score': 0.5455086230446208, 'support': 163328}, 'weighted avg': {'precision': 0.6073810009541745, 'recall': 0.6146955818965517, 'f1-score': 0.6087412180209631, 'support': 163328}}
[[14838 14967  6251]
 [ 7493 69578 14380]
 [ 5603 14237 15981]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
5696/5696 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0198858
{'0': {'precision': 0.4902558019528606, 'recall': 0.535100311421659, 'f1-score': 0.5116974071337702, 'support': 546847}, '1': {'precision': 0.3976909313631805, 'recall': 0.5867057998995712, 'f1-score': 0.4740519113649135, 'support': 372403}, '2': {'precision': 0.5404209047431172, 'recall': 0.3127099674446057, 'f1-score': 0.39617603591168343, 'support': 538774}, 'accuracy': 0.4661027527667583, 'macro avg': {'precision': 0.47612254601971943, 'recall': 0.47817202625527866, 'f1-score': 0.4606417848034557, 'support': 1458024}, 'weighted avg': {'precision': 0.48515041108721585, 'recall': 0.4661027527667583, 'f1-score': 0.4593942853610023, 'support': 1458024}}
[[292618 161542  92687]
 [103322 218491  50590]
 [200928 169366 168480]]
Evaluating performance on  train set...
2222/2222 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9712946
{'0': {'precision': 0.5192895094843297, 'recall': 0.4434483363289641, 'f1-score': 0.4783816696421182, 'support': 182488}, '1': {'precision': 0.5156777462706721, 'recall': 0.7045119133153388, 'f1-score': 0.5954830264707451, 'support': 205988}, '2': {'precision': 0.5097248125451985, 'recall': 0.3717047012651061, 'f1-score': 0.4299087021842136, 'support': 180143}, 'accuracy': 0.5152923134823142, 'macro avg': {'precision': 0.5148973561000668, 'recall': 0.5065549836364697, 'f1-score': 0.5012577994323589, 'support': 568619}, 'weighted avg': {'precision': 0.5149509399297408, 'recall': 0.5152923134823142, 'f1-score': 0.5054462040907488, 'support': 568619}}
[[ 80924  67164  34400]
 [ 30862 145121  30005]
 [ 44050  69133  66960]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9724894
{'0': {'precision': 0.5167341274430438, 'recall': 0.42160785053783734, 'f1-score': 0.46434918160561184, 'support': 52990}, '1': {'precision': 0.5267325721000332, 'recall': 0.6955759078412521, 'f1-score': 0.5994926698792729, 'support': 59289}, '2': {'precision': 0.4860815728531594, 'recall': 0.3988907849829352, 'f1-score': 0.4381909975928253, 'support': 51568}, 'accuracy': 0.5135950002136139, 'macro avg': {'precision': 0.5098494241320788, 'recall': 0.505358181120675, 'f1-score': 0.5006776163592367, 'support': 163847}, 'weighted avg': {'precision': 0.5107047637694769, 'recall': 0.5135950002136139, 'f1-score': 0.5050188126826881, 'support': 163847}}
[[22341 18697 11952]
 [ 8253 41240  9796]
 [12641 18357 20570]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.969543
{'0': {'precision': 0.5055634246957744, 'recall': 0.504516532417405, 'f1-score': 0.5050394360334781, 'support': 969217}, '1': {'precision': 0.4994701749150044, 'recall': 0.8009968043168936, 'f1-score': 0.6152774662449582, 'support': 1157499}, '2': {'precision': 0.6054477142286487, 'recall': 0.1669854052379834, 'f1-score': 0.2617726489529404, 'support': 962126}, 'accuracy': 0.5104825691958346, 'macro avg': {'precision': 0.5368271046131425, 'recall': 0.4908329139907606, 'f1-score': 0.46069651707712556, 'support': 3088842}, 'weighted avg': {'precision': 0.5343924620577096, 'recall': 0.5104825691958346, 'f1-score': 0.4705757467107833, 'support': 3088842}}
[[488986 421276  58955]
 [184603 927153  45743]
 [293621 507844 160661]]
Evaluating performance on  train set...
2948/2948 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96292955
{'0': {'precision': 0.5402439458900937, 'recall': 0.38316977635513627, 'f1-score': 0.44834757582029827, 'support': 237430}, '1': {'precision': 0.49691241142747067, 'recall': 0.8094103887953904, 'f1-score': 0.615783584366968, 'support': 280456}, '2': {'precision': 0.5532165099996131, 'recall': 0.302228270976686, 'f1-score': 0.3909023072234325, 'support': 236596}, 'accuracy': 0.5162296781102796, 'macro avg': {'precision': 0.5301242891057258, 'recall': 0.49826947870907085, 'f1-score': 0.4850111558035663, 'support': 754482}, 'weighted avg': {'precision': 0.5282047825287497, 'recall': 0.5162296781102796, 'f1-score': 0.49257276932262267, 'support': 754482}}
[[ 90976 113054  33400]
 [ 29103 227004  24349]
 [ 48319 116771  71506]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9291009
{'0': {'precision': 0.5116868080179463, 'recall': 0.4229825925704373, 'f1-score': 0.46312549122347396, 'support': 50151}, '1': {'precision': 0.5740433063045166, 'recall': 0.7996704361061145, 'f1-score': 0.6683276827249074, 'support': 79499}, '2': {'precision': 0.5353666450356911, 'recall': 0.2876923076923077, 'f1-score': 0.3742644802326978, 'support': 48750}, 'accuracy': 0.5538733183856502, 'macro avg': {'precision': 0.540365586452718, 'recall': 0.5034484454562865, 'f1-score': 0.5019058847270264, 'support': 178400}, 'weighted avg': {'precision': 0.5459450552819547, 'recall': 0.5538733183856502, 'f1-score': 0.5302857756201786, 'support': 178400}}
[[21213 22826  6112]
 [ 9866 63573  6060]
 [10378 24347 14025]]
testing model on single stock: results/universal/W1/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
21353/21353 - 289s - 289s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1514653
{'0': {'precision': 0.439311260534592, 'recall': 0.5647973232927994, 'f1-score': 0.49421313200321354, 'support': 2081961}, '1': {'precision': 0.27641129374968126, 'recall': 0.4801447774218088, 'f1-score': 0.35084627345282804, 'support': 1286941}, '2': {'precision': 0.48002281353723536, 'recall': 0.1268097543764289, 'f1-score': 0.20062065979424992, 'support': 2097315}, 'accuracy': 0.37681709306454536, 'macro avg': {'precision': 0.3985817892738362, 'recall': 0.3905839516970124, 'f1-score': 0.3485600217500972, 'support': 5466217}, 'weighted avg': {'precision': 0.4165793244683142, 'recall': 0.37681709306454536, 'f1-score': 0.34781195836509526, 'support': 5466217}}
[[1175886  742402  163673]
 [ 544599  617918  124424]
 [ 956173  875182  265960]]
Evaluating performance on  train set...
6073/6073 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1152683
{'0': {'precision': 0.4457347792673555, 'recall': 0.4218246745500652, 'f1-score': 0.43345024337586646, 'support': 519742}, '1': {'precision': 0.38315931769682987, 'recall': 0.6446832414765696, 'f1-score': 0.480650248873516, 'support': 509126}, '2': {'precision': 0.47081974532184173, 'recall': 0.18455694083540364, 'f1-score': 0.265169798428425, 'support': 525686}, 'accuracy': 0.41457807191001406, 'macro avg': {'precision': 0.43323794742867566, 'recall': 0.41702161895401285, 'f1-score': 0.3930900968926025, 'support': 1554554}, 'weighted avg': {'precision': 0.43372363074357523, 'recall': 0.41457807191001406, 'f1-score': 0.3920030347336164, 'support': 1554554}}
[[219240 244224  56278]
 [128134 328225  52767]
 [144488 284179  97019]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1470276
{'0': {'precision': 0.46163448224115466, 'recall': 0.4194214107760384, 'f1-score': 0.4395166920486685, 'support': 161358}, '1': {'precision': 0.3286373817619285, 'recall': 0.6143031416608934, 'f1-score': 0.4281987486352566, 'support': 132796}, '2': {'precision': 0.44620121227670695, 'recall': 0.170670821091886, 'f1-score': 0.24690218765666522, 'support': 163039}, 'accuracy': 0.38732001583576303, 'macro avg': {'precision': 0.4121576920932634, 'recall': 0.4014651245096059, 'f1-score': 0.37153920944686347, 'support': 457193}, 'weighted avg': {'precision': 0.4175005872406343, 'recall': 0.38732001583576303, 'f1-score': 0.367541281674723, 'support': 457193}}
[[67677 74675 19006]
 [35689 81577 15530]
 [43237 91976 27826]]
training model: results/universal/W1/deepLOB_L2/h100
Epoch 1/50
10622/10622 - 431s - loss: 3.1768 - accuracy100: 0.4277 - val_loss: 3.2848 - val_accuracy100: 0.3868 - 431s/epoch - 41ms/step
Epoch 2/50
10622/10622 - 419s - loss: 3.1471 - accuracy100: 0.4412 - val_loss: 3.3811 - val_accuracy100: 0.3851 - 419s/epoch - 39ms/step
Epoch 3/50
10622/10622 - 426s - loss: 3.1320 - accuracy100: 0.4478 - val_loss: 3.3214 - val_accuracy100: 0.4001 - 426s/epoch - 40ms/step
Epoch 4/50
10622/10622 - 418s - loss: 3.1214 - accuracy100: 0.4520 - val_loss: 3.3196 - val_accuracy100: 0.4042 - 418s/epoch - 39ms/step
Epoch 5/50
10622/10622 - 417s - loss: 3.1118 - accuracy100: 0.4555 - val_loss: 3.3259 - val_accuracy100: 0.4015 - 417s/epoch - 39ms/step
Epoch 6/50
10622/10622 - 416s - loss: 3.1029 - accuracy100: 0.4577 - val_loss: 3.3113 - val_accuracy100: 0.4005 - 416s/epoch - 39ms/step
Epoch 7/50
10622/10622 - 416s - loss: 3.0947 - accuracy100: 0.4605 - val_loss: 3.4531 - val_accuracy100: 0.3979 - 416s/epoch - 39ms/step
Epoch 8/50
10622/10622 - 418s - loss: 3.0877 - accuracy100: 0.4621 - val_loss: 3.4979 - val_accuracy100: 0.3983 - 418s/epoch - 39ms/step
Epoch 9/50
10622/10622 - 420s - loss: 3.0827 - accuracy100: 0.4636 - val_loss: 3.4008 - val_accuracy100: 0.3922 - 420s/epoch - 40ms/step
Epoch 10/50
10622/10622 - 420s - loss: 3.0772 - accuracy100: 0.4651 - val_loss: 3.7337 - val_accuracy100: 0.3938 - 420s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 418s - loss: 3.0729 - accuracy100: 0.4663 - val_loss: 3.6345 - val_accuracy100: 0.3944 - 418s/epoch - 39ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 471s - 471s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101243
{'0': {'precision': 0.3846454367777769, 'recall': 0.6850160769289968, 'f1-score': 0.49265735886312023, 'support': 3196506}, '1': {'precision': 0.35714290011219296, 'recall': 0.22396433978158267, 'f1-score': 0.27529264252817914, 'support': 2650797}, '2': {'precision': 0.4183952003782953, 'recall': 0.22123640168802536, 'f1-score': 0.28942987906228185, 'support': 3199478}, 'accuracy': 0.3859033395414347, 'macro avg': {'precision': 0.3867278457560884, 'recall': 0.3767389394662016, 'f1-score': 0.35245996015119374, 'support': 9046781}, 'weighted avg': {'precision': 0.3885228363146442, 'recall': 0.3859033395414347, 'f1-score': 0.3570940476052552, 'support': 9046781}}
[[2189658  501669  505179]
 [1578333  593684  478780]
 [1924675  566962  707841]]
Evaluating performance on  train set...
10622/10622 - 143s - 143s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089849
{'0': {'precision': 0.38086140958261094, 'recall': 0.4717111315547378, 'f1-score': 0.42144581912075285, 'support': 891340}, '1': {'precision': 0.3898225735937045, 'recall': 0.4571037373026443, 'f1-score': 0.42079069449626577, 'support': 936317}, '2': {'precision': 0.4157724200404153, 'recall': 0.2411195062731729, 'f1-score': 0.3052278057510766, 'support': 890857}, 'accuracy': 0.3911151459952018, 'macro avg': {'precision': 0.3954854677389103, 'recall': 0.38997812504351836, 'f1-score': 0.38248810645603176, 'support': 2718514}, 'weighted avg': {'precision': 0.39538817245629243, 'recall': 0.3911151459952018, 'f1-score': 0.3831355381880464, 'support': 2718514}}
[[420455 314304 156581]
 [363071 427994 145252]
 [320432 355622 214803]]
Evaluating performance on  val set...
3064/3064 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933536
{'0': {'precision': 0.3679262380499298, 'recall': 0.5000481081934026, 'f1-score': 0.4239314677625386, 'support': 259831}, '1': {'precision': 0.3952743060990781, 'recall': 0.3636721962607967, 'f1-score': 0.37881530404985286, 'support': 263853}, '2': {'precision': 0.4129090289753252, 'recall': 0.2982729320937815, 'f1-score': 0.3463518297773551, 'support': 260094}, 'accuracy': 0.3871797881542988, 'macro avg': {'precision': 0.3920365243747777, 'recall': 0.38733107884932694, 'f1-score': 0.3830328671965822, 'support': 783778}, 'weighted avg': {'precision': 0.39206014308671544, 'recall': 0.3871797881542988, 'f1-score': 0.382998916062693, 'support': 783778}}
[[129928  69207  60696]
 [118288  95956  49609]
 [104920  77595  77579]]
testing model out of sample: results/universal/W1/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 319s - 319s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0796664
{'0': {'precision': 0.39532468715013275, 'recall': 0.48147673930927687, 'f1-score': 0.4341681835672, 'support': 1983776}, '1': {'precision': 0.40387884006894414, 'recall': 0.42825960644652483, 'f1-score': 0.4157120580698698, 'support': 2128961}, '2': {'precision': 0.4158213046656126, 'recall': 0.29842246932858923, 'f1-score': 0.3474735799062215, 'support': 1986459}, 'accuracy': 0.40328167843761703, 'macro avg': {'precision': 0.4050082772948966, 'recall': 0.4027196050281303, 'f1-score': 0.39911794051443045, 'support': 6099196}, 'weighted avg': {'precision': 0.4049861488059589, 'recall': 0.40328167843761703, 'f1-score': 0.39949022813033497, 'support': 6099196}}
[[955142 634875 393759]
 [778154 911748 439059]
 [682799 710856 592804]]
Evaluating performance on  train set...
6711/6711 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0769912
{'0': {'precision': 0.40125698467216897, 'recall': 0.3519908909722772, 'f1-score': 0.37501281612714366, 'support': 555932}, '1': {'precision': 0.40555490173002234, 'recall': 0.5272788896274407, 'f1-score': 0.45847511153297843, 'support': 607796}, '2': {'precision': 0.4087058641455499, 'recall': 0.32441152560744285, 'f1-score': 0.36171258454758226, 'support': 553550}, 'accuracy': 0.40514057712263246, 'macro avg': {'precision': 0.40517258351591373, 'recall': 0.4012271020690536, 'f1-score': 0.3984001707359015, 'support': 1717278}, 'weighted avg': {'precision': 0.40517922907790005, 'recall': 0.40514057712263246, 'f1-score': 0.40026539963873503, 'support': 1717278}}
[[195683 230326 129923]
 [157437 320478 129881]
 [134555 239417 179578]]
Evaluating performance on  val set...
1720/1720 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0649831
{'0': {'precision': 0.39903169591751914, 'recall': 0.3999356899084312, 'f1-score': 0.3994831814996496, 'support': 136837}, '1': {'precision': 0.4546550661822508, 'recall': 0.5075633142199795, 'f1-score': 0.4796545917609712, 'support': 168643}, '2': {'precision': 0.3920026564602667, 'recall': 0.33384682934815774, 'f1-score': 0.36059498977135257, 'support': 134373}, 'accuracy': 0.4210111105301089, 'macro avg': {'precision': 0.4152298061866789, 'recall': 0.41378194449218947, 'f1-score': 0.41324425434399115, 'support': 439853}, 'weighted avg': {'precision': 0.41821078282283924, 'recall': 0.4210111105301089, 'f1-score': 0.4183413549203006, 'support': 439853}}
[[54726 49634 32477]
 [45945 85597 37101]
 [36476 53037 44860]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1116786
{'0': {'precision': 0.3534668071654373, 'recall': 0.4502711506452132, 'f1-score': 0.3960392922360053, 'support': 55873}, '1': {'precision': 0.3953206376972926, 'recall': 0.3317928526143682, 'f1-score': 0.3607815391313814, 'support': 59938}, '2': {'precision': 0.32876968075175805, 'recall': 0.29417005401191604, 'f1-score': 0.3105089925943341, 'support': 53877}, 'accuracy': 0.3588586110980152, 'macro avg': {'precision': 0.3591857085381626, 'recall': 0.35874468575716584, 'f1-score': 0.35577660798724026, 'support': 169688}, 'weighted avg': {'precision': 0.36040912373837436, 'recall': 0.3588586110980152, 'f1-score': 0.3564289770730046, 'support': 169688}}
[[25158 14113 16602]
 [24295 19887 15756]
 [21722 16306 15849]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1170784
{'0': {'precision': 0.3635722442399409, 'recall': 0.4942245354517646, 'f1-score': 0.418948468370842, 'support': 21903}, '1': {'precision': 0.33966082769209294, 'recall': 0.4452474613484585, 'f1-score': 0.3853523357086302, 'support': 21862}, '2': {'precision': 0.41626498578667653, 'recall': 0.14799191493101327, 'f1-score': 0.2183539174689617, 'support': 22758}, 'accuracy': 0.3596801106384258, 'macro avg': {'precision': 0.3731660192395701, 'recall': 0.36248797057707877, 'f1-score': 0.3408849071828113, 'support': 66523}, 'weighted avg': {'precision': 0.37374060741585835, 'recall': 0.3596801106384258, 'f1-score': 0.33928264690027893, 'support': 66523}}
[[10825  8743  2335]
 [ 9740  9734  2388]
 [ 9209 10181  3368]]
Evaluating performance on  val set...
51/51 - 1s - 909ms/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0743217
{'0': {'precision': 0.31852957641351, 'recall': 0.49521322889469105, 'f1-score': 0.387690211219623, 'support': 3447}, '1': {'precision': 0.5078011611030478, 'recall': 0.457203528258739, 'f1-score': 0.48117586384734395, 'support': 6122}, '2': {'precision': 0.3426113360323887, 'recall': 0.20652837095790116, 'f1-score': 0.2577084126379901, 'support': 3278}, 'accuracy': 0.40344049194364445, 'macro avg': {'precision': 0.3896473578496488, 'recall': 0.3863150427037771, 'f1-score': 0.3755248292349857, 'support': 12847}, 'weighted avg': {'precision': 0.41486807174316165, 'recall': 0.40344049194364445, 'f1-score': 0.39907332242350835, 'support': 12847}}
[[1707 1380  360]
 [2384 2799  939]
 [1268 1333  677]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
1645/1645 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0418981
{'0': {'precision': 0.3609208335550774, 'recall': 0.4502072131023168, 'f1-score': 0.4006498438686809, 'support': 105447}, '1': {'precision': 0.5982582379758673, 'recall': 0.42606005106005107, 'f1-score': 0.4976850226095225, 'support': 216216}, '2': {'precision': 0.3461087124986162, 'recall': 0.4720424371143567, 'f1-score': 0.3993834152323689, 'support': 99347}, 'accuracy': 0.44295859955820527, 'macro avg': {'precision': 0.43509592800985364, 'recall': 0.44943656709224156, 'f1-score': 0.4325727605701908, 'support': 421010}, 'weighted avg': {'precision': 0.4793137563921817, 'recall': 0.44295859955820527, 'f1-score': 0.45018487230244286, 'support': 421010}}
[[47473 31087 26887]
 [62383 92121 61712]
 [21677 30774 46896]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0552413
{'0': {'precision': 0.42094903339191564, 'recall': 0.34889683032939717, 'f1-score': 0.3815511400443911, 'support': 51488}, '1': {'precision': 0.4513228583631173, 'recall': 0.622621908675091, 'f1-score': 0.5233108966631698, 'support': 64495}, '2': {'precision': 0.41778899316680373, 'recall': 0.289290271915186, 'f1-score': 0.34186348661315025, 'support': 50935}, 'accuracy': 0.4364718005248086, 'macro avg': {'precision': 0.43002029497394556, 'recall': 0.42026967030655804, 'f1-score': 0.415575174440237, 'support': 166918}, 'weighted avg': {'precision': 0.43172080871064444, 'recall': 0.4364718005248086, 'f1-score': 0.42421463275103677, 'support': 166918}}
[[17964 23645  9879]
 [13684 40156 10655]
 [11027 25173 14735]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0291882
{'0': {'precision': 0.5301993001673513, 'recall': 0.2457340290509096, 'f1-score': 0.33582269332690917, 'support': 14182}, '1': {'precision': 0.47350620067643745, 'recall': 0.7719777334313622, 'f1-score': 0.5869786571365824, 'support': 19042}, '2': {'precision': 0.435770295202952, 'recall': 0.28922393999693863, 'f1-score': 0.3476860796761432, 'support': 13066}, 'accuracy': 0.47448693022251026, 'macro avg': {'precision': 0.4798252653489136, 'recall': 0.4356452341597368, 'f1-score': 0.4234958100465449, 'support': 46290}, 'weighted avg': {'precision': 0.4802239409240845, 'recall': 0.47448693022251026, 'f1-score': 0.4424876073235151, 'support': 46290}}
[[ 3485  8262  2435]
 [ 1884 14700  2458]
 [ 1204  8083  3779]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1176314
{'0': {'precision': 0.39928371893130865, 'recall': 0.4534391878701113, 'f1-score': 0.42464177706002, 'support': 122936}, '1': {'precision': 0.2969760182834705, 'recall': 0.41617944198443746, 'f1-score': 0.3466153467451384, 'support': 93044}, '2': {'precision': 0.4190359773029096, 'recall': 0.23084341355946295, 'f1-score': 0.2976912232174925, 'support': 120285}, 'accuracy': 0.3635049737558176, 'macro avg': {'precision': 0.3717652381725629, 'recall': 0.3668206811380039, 'f1-score': 0.35631611567421695, 'support': 336265}, 'weighted avg': {'precision': 0.3780408976419998, 'recall': 0.3635049737558176, 'f1-score': 0.3576406364382893, 'support': 336265}}
[[55744 46055 21137]
 [36961 38723 17360]
 [46905 45613 27767]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198286
{'0': {'precision': 0.39049960820341, 'recall': 0.3215342514517098, 'f1-score': 0.3526770462199229, 'support': 44947}, '1': {'precision': 0.356840455297892, 'recall': 0.5429036284211465, 'f1-score': 0.4306335133606174, 'support': 44868}, '2': {'precision': 0.3695818548667641, 'recall': 0.24034567789516548, 'f1-score': 0.2912719845371424, 'support': 44203}, 'accuracy': 0.3688683609664373, 'macro avg': {'precision': 0.3723073061226887, 'recall': 0.36826118592267393, 'f1-score': 0.3581941813725609, 'support': 134018}, 'weighted avg': {'precision': 0.37233155373830423, 'recall': 0.3688683609664373, 'f1-score': 0.35852299845100183, 'support': 134018}}
[[14452 21701  8794]
 [11181 24359  9328]
 [11376 22203 10624]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1079574
{'0': {'precision': 0.4115208991921321, 'recall': 0.5822482854587019, 'f1-score': 0.48221929535726044, 'support': 10061}, '1': {'precision': 0.3263621353880022, 'recall': 0.40544236291535624, 'f1-score': 0.36162946700817167, 'support': 7313}, '2': {'precision': 0.42233766233766235, 'recall': 0.16598611678236014, 'f1-score': 0.23831159314084713, 'support': 9796}, 'accuracy': 0.38457857931542144, 'macro avg': {'precision': 0.3867402323059322, 'recall': 0.3845589217188061, 'f1-score': 0.360720118502093, 'support': 27170}, 'weighted avg': {'precision': 0.39249973511682884, 'recall': 0.38457857931542144, 'f1-score': 0.36182204597820744, 'support': 27170}}
[[5858 2987 1216]
 [3340 2965 1008]
 [5037 3133 1626]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1196765
{'0': {'precision': 0.36557331257169007, 'recall': 0.5431434878587197, 'f1-score': 0.4370091187137889, 'support': 113250}, '1': {'precision': 0.346283748347983, 'recall': 0.3075103158561462, 'f1-score': 0.3257472976906417, 'support': 107359}, '2': {'precision': 0.3743442062043796, 'recall': 0.2321005551037726, 'f1-score': 0.28654051812566844, 'support': 113132}, 'accuracy': 0.36190638848688056, 'macro avg': {'precision': 0.3620670890413509, 'recall': 0.3609181196062128, 'f1-score': 0.34976564484336636, 'support': 333741}, 'weighted avg': {'precision': 0.3623413465050709, 'recall': 0.36190638848688056, 'f1-score': 0.35021195694775087, 'support': 333741}}
[[61511 30691 21048]
 [51507 33014 22838]
 [55241 31633 26258]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1204982
{'0': {'precision': 0.35402896398069067, 'recall': 0.4322633297062024, 'f1-score': 0.3892540725921692, 'support': 33084}, '1': {'precision': 0.3334701869631127, 'recall': 0.3286029938069897, 'f1-score': 0.3310186999388686, 'support': 32133}, '2': {'precision': 0.36709054110818345, 'recall': 0.2910472614974719, 'f1-score': 0.32467576330721426, 'support': 33029}, 'accuracy': 0.3508845143822649, 'macro avg': {'precision': 0.35152989735066226, 'recall': 0.3506378616702213, 'f1-score': 0.3483161786127507, 'support': 98246}, 'weighted avg': {'precision': 0.35169600028790043, 'recall': 0.3508845143822649, 'f1-score': 0.3484968488187709, 'support': 98246}}
[[14301 10505  8278]
 [13278 10559  8296]
 [12816 10600  9613]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1236819
{'0': {'precision': 0.34219269102990035, 'recall': 0.36762268961121736, 'f1-score': 0.3544521600196645, 'support': 7845}, '1': {'precision': 0.3315932818883341, 'recall': 0.38604835513277846, 'f1-score': 0.35675477687564866, 'support': 7569}, '2': {'precision': 0.3785355122564425, 'recall': 0.29413919413919415, 'f1-score': 0.3310430122303147, 'support': 8190}, 'accuracy': 0.3480342314861888, 'macro avg': {'precision': 0.35077382839155896, 'recall': 0.34927007962773, 'f1-score': 0.34741664970854264, 'support': 23604}, 'weighted avg': {'precision': 0.35140387464508693, 'recall': 0.3480342314861888, 'f1-score': 0.3470681397937778, 'support': 23604}}
[[2884 2933 2028]
 [2720 2922 1927]
 [2824 2957 2409]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003066
{'0': {'precision': 0.396881926763019, 'recall': 0.3245006345287972, 'f1-score': 0.35706002328912234, 'support': 230092}, '1': {'precision': 0.3497077883678155, 'recall': 0.41029910665154623, 'f1-score': 0.3775881353096075, 'support': 208989}, '2': {'precision': 0.38500068380743985, 'recall': 0.39470536430195724, 'f1-score': 0.38979262897136613, 'support': 228231}, 'accuracy': 0.3753821300980651, 'macro avg': {'precision': 0.37719679964609143, 'recall': 0.37650170182743353, 'f1-score': 0.3748135958566987, 'support': 667312}, 'weighted avg': {'precision': 0.3780443455864929, 'recall': 0.3753821300980651, 'f1-score': 0.3746840805974179, 'support': 667312}}
[[74665 77865 77562]
 [56903 85748 66338]
 [56561 81586 90084]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025741
{'0': {'precision': 0.3820967525796221, 'recall': 0.4166247260329572, 'f1-score': 0.39861443350212805, 'support': 61595}, '1': {'precision': 0.36938425202947744, 'recall': 0.46991314627218544, 'f1-score': 0.4136281523231447, 'support': 60907}, '2': {'precision': 0.3969677290438605, 'recall': 0.25560487632281514, 'f1-score': 0.31097501320758414, 'support': 62178}, 'accuracy': 0.37998700454840806, 'macro avg': {'precision': 0.3828162445509867, 'recall': 0.3807142495426526, 'f1-score': 0.3744058663442857, 'support': 184680}, 'weighted avg': {'precision': 0.3829109571691053, 'recall': 0.37998700454840806, 'f1-score': 0.37405950983501474, 'support': 184680}}
[[25662 23453 12480]
 [20623 28621 11663]
 [20876 25409 15893]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1013116
{'0': {'precision': 0.3947186653206525, 'recall': 0.37033898305084745, 'f1-score': 0.3821403770479155, 'support': 20060}, '1': {'precision': 0.34770948738239693, 'recall': 0.434107250672375, 'f1-score': 0.38613450506529967, 'support': 18219}, '2': {'precision': 0.3948370715192552, 'recall': 0.329366079983862, 'f1-score': 0.35914215012372835, 'support': 19829}, 'accuracy': 0.3763509327459214, 'macro avg': {'precision': 0.3790884080741015, 'recall': 0.3779374379023615, 'f1-score': 0.37580567741231446, 'support': 58108}, 'weighted avg': {'precision': 0.38001996055805554, 'recall': 0.3763509327459214, 'f1-score': 0.3755446789799905, 'support': 58108}}
[[7429 7367 5264]
 [5564 7909 4746]
 [5828 7470 6531]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
5343/5343 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0687399
{'0': {'precision': 0.44269532233631376, 'recall': 0.48033263221805406, 'f1-score': 0.4607466293934364, 'support': 461170}, '1': {'precision': 0.3748060394729112, 'recall': 0.4905069016046457, 'f1-score': 0.4249212981736475, 'support': 442216}, '2': {'precision': 0.44037272459601295, 'recall': 0.27374715494947277, 'f1-score': 0.33762057023880343, 'support': 464403}, 'accuracy': 0.4134804417932883, 'macro avg': {'precision': 0.4192913621350793, 'recall': 0.4148622295907242, 'f1-score': 0.40776283260196244, 'support': 1367789}, 'weighted avg': {'precision': 0.41995764242434536, 'recall': 0.4134804417932883, 'f1-score': 0.4073592678045662, 'support': 1367789}}
[[221515 165121  74534]
 [138284 216910  87022]
 [140579 196695 127129]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0460889
{'0': {'precision': 0.39151343502451225, 'recall': 0.5585237294392715, 'f1-score': 0.4603389257490597, 'support': 97516}, '1': {'precision': 0.46530295379003145, 'recall': 0.46350381404288543, 'f1-score': 0.4644016414098673, 'support': 133192}, '2': {'precision': 0.4550919741033809, 'recall': 0.2671284520805477, 'f1-score': 0.33665072376548094, 'support': 99469}, 'accuracy': 0.43240746629837934, 'macro avg': {'precision': 0.43730278763930824, 'recall': 0.42971866518756824, 'f1-score': 0.42046376364146937, 'support': 330177}, 'weighted avg': {'precision': 0.44043346060792055, 'recall': 0.43240746629837934, 'f1-score': 0.4247155463531287, 'support': 330177}}
[[54465 29874 13177]
 [52819 61735 18638]
 [31830 41068 26571]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0400712
{'0': {'precision': 0.3847698264735408, 'recall': 0.49628204653915875, 'f1-score': 0.43346904484942483, 'support': 27031}, '1': {'precision': 0.47637444975180293, 'recall': 0.5172896008136283, 'f1-score': 0.495989663326751, 'support': 39330}, '2': {'precision': 0.4257743435269465, 'recall': 0.24551599139070346, 'f1-score': 0.3114432150213153, 'support': 26483}, 'accuracy': 0.43365214768859595, 'macro avg': {'precision': 0.4289728732507634, 'recall': 0.41969587958116356, 'f1-score': 0.4136339743991637, 'support': 92844}, 'weighted avg': {'precision': 0.43527101619672587, 'recall': 0.43365214768859595, 'f1-score': 0.4251467609471308, 'support': 92844}}
[[13415  9702  3914]
 [14130 20345  4855]
 [ 7320 12661  6502]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
7177/7177 - 98s - 98s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0529113
{'0': {'precision': 0.4537640824560656, 'recall': 0.331438968118629, 'f1-score': 0.38307314050412783, 'support': 578206}, '1': {'precision': 0.4477549387537386, 'recall': 0.5077686178946095, 'f1-score': 0.4758771352617588, 'support': 694332}, '2': {'precision': 0.4102014792144861, 'recall': 0.45583835649923565, 'f1-score': 0.4318174763048583, 'support': 564551}, 'accuracy': 0.43631201319043333, 'macro avg': {'precision': 0.43724016680809674, 'recall': 0.4316819808374914, 'f1-score': 0.430255917356915, 'support': 1837089}, 'weighted avg': {'precision': 0.43810580352251316, 'recall': 0.43631201319043333, 'f1-score': 0.4331281170505518, 'support': 1837089}}
[[191640 219438 167128]
 [138884 352560 202888]
 [ 91810 215397 257344]]
Evaluating performance on  train set...
2257/2257 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0483463
{'0': {'precision': 0.4158082537394125, 'recall': 0.32924274681933113, 'f1-score': 0.36749659153170827, 'support': 175199}, '1': {'precision': 0.49350799460604894, 'recall': 0.49904546694198776, 'f1-score': 0.49626128394870406, 'support': 231003}, '2': {'precision': 0.3926920172468393, 'recall': 0.4703307989006436, 'f1-score': 0.4280191594889387, 'support': 171373}, 'accuracy': 0.43901830931047914, 'macro avg': {'precision': 0.43400275519743353, 'recall': 0.43287300422065417, 'f1-score': 0.43059234498978366, 'support': 577575}, 'weighted avg': {'precision': 0.4400256704263776, 'recall': 0.43901830931047914, 'f1-score': 0.4369541758816849, 'support': 577575}}
[[ 57683  58247  59269]
 [ 50338 115281  65384]
 [ 30704  60067  80602]]
Evaluating performance on  val set...
638/638 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0417411
{'0': {'precision': 0.4603174603174603, 'recall': 0.26468494871258114, 'f1-score': 0.33610675456551214, 'support': 47770}, '1': {'precision': 0.5252649609249544, 'recall': 0.5725788805741543, 'f1-score': 0.5479023736573585, 'support': 68553}, '2': {'precision': 0.3721291631224236, 'recall': 0.4839697904478247, 'f1-score': 0.42074405615099364, 'support': 47005}, 'accuracy': 0.4570251273510972, 'macro avg': {'precision': 0.4525705281216128, 'recall': 0.44041120657818666, 'f1-score': 0.4349177281246214, 'support': 163328}, 'weighted avg': {'precision': 0.4621974508854758, 'recall': 0.4570251273510972, 'f1-score': 0.44936107370631406, 'support': 163328}}
[[12644 17617 17509]
 [ 8427 39252 20874]
 [ 6397 17859 22749]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
5696/5696 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1058031
{'0': {'precision': 0.41120853042399774, 'recall': 0.558049725940809, 'f1-score': 0.4735060159678757, 'support': 548969}, '1': {'precision': 0.26302063059556247, 'recall': 0.2805519417610098, 'f1-score': 0.2715035761163644, 'support': 361270}, '2': {'precision': 0.45818048646504106, 'recall': 0.27407103151784, 'f1-score': 0.34298050727907203, 'support': 547785}, 'accuracy': 0.3825993262113655, 'macro avg': {'precision': 0.37746988249486707, 'recall': 0.3708908997398863, 'f1-score': 0.3626633664544374, 'support': 1458024}, 'weighted avg': {'precision': 0.39213798725661786, 'recall': 0.3825993262113655, 'f1-score': 0.37441482321504593, 'support': 1458024}}
[[306352 136113 106504]
 [188881 101355  71034]
 [249771 147882 150132]]
Evaluating performance on  train set...
2222/2222 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0816036
{'0': {'precision': 0.41706136402186816, 'recall': 0.33398115060706746, 'f1-score': 0.3709260967698886, 'support': 191412}, '1': {'precision': 0.39334714907071416, 'recall': 0.5113975815082826, 'f1-score': 0.44467079813597726, 'support': 187803}, '2': {'precision': 0.4116234642550432, 'recall': 0.3719984794407721, 'f1-score': 0.39080912431532966, 'support': 189404}, 'accuracy': 0.4052414710025518, 'macro avg': {'precision': 0.40734399244920855, 'recall': 0.4057924038520407, 'f1-score': 0.40213533974039856, 'support': 568619}, 'weighted avg': {'precision': 0.4074177174361802, 'recall': 0.4052414710025518, 'f1-score': 0.4019053660167345, 'support': 568619}}
[[63928 71803 55681]
 [46729 96042 45032]
 [42625 76321 70458]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0860006
{'0': {'precision': 0.42953511874684186, 'recall': 0.29760008402331645, 'f1-score': 0.3515981262990269, 'support': 57127}, '1': {'precision': 0.382887814372168, 'recall': 0.49058993142144636, 'f1-score': 0.4300988949049482, 'support': 51328}, '2': {'precision': 0.3985914770687681, 'recall': 0.4209633160023108, 'f1-score': 0.40947204832606043, 'support': 55392}, 'accuracy': 0.39976319371120617, 'macro avg': {'precision': 0.4036714700625927, 'recall': 0.4030511104823578, 'f1-score': 0.3970563565100118, 'support': 163847}, 'weighted avg': {'precision': 0.40446085410498006, 'recall': 0.39976319371120617, 'f1-score': 0.395755417796132, 'support': 163847}}
[[17001 19666 20460]
 [11424 25181 14723]
 [11155 20919 23318]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
12066/12066 - 162s - 162s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0851167
{'0': {'precision': 0.38150842314428973, 'recall': 0.6110433855171576, 'f1-score': 0.469735073669921, 'support': 996669}, '1': {'precision': 0.3974825295405233, 'recall': 0.3868278612568032, 'f1-score': 0.3920828248438624, 'support': 1072658}, '2': {'precision': 0.44957547685016974, 'recall': 0.19782837918029653, 'f1-score': 0.2747551997907551, 'support': 1019515}, 'accuracy': 0.3967930376497082, 'macro avg': {'precision': 0.40952214317832764, 'recall': 0.39856654198475244, 'f1-score': 0.3788576994348462, 'support': 3088842}, 'weighted avg': {'precision': 0.40952220153687874, 'recall': 0.3967930376497082, 'f1-score': 0.37841307920106176, 'support': 3088842}}
[[609008 277109 110552]
 [521344 414934 136380]
 [465964 351862 201689]]
Evaluating performance on  train set...
2948/2948 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081262
{'0': {'precision': 0.40676845731309935, 'recall': 0.34635813039066465, 'f1-score': 0.37414045574042837, 'support': 252288}, '1': {'precision': 0.3735138843788953, 'recall': 0.572464640626756, 'f1-score': 0.4520683840868176, 'support': 249156}, '2': {'precision': 0.4413095554964067, 'recall': 0.27519977236620585, 'f1-score': 0.338999883163921, 'support': 253038}, 'accuracy': 0.39716123114931834, 'macro avg': {'precision': 0.4071972990628005, 'recall': 0.3980075144612088, 'f1-score': 0.3884029076637223, 'support': 754482}, 'weighted avg': {'precision': 0.4073710350129161, 'recall': 0.39716123114931834, 'f1-score': 0.3880895104713016, 'support': 754482}}
[[ 87382 117769  47137]
 [ 65502 142633  41021]
 [ 61936 121466  69636]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0677762
{'0': {'precision': 0.37850198510121913, 'recall': 0.4861348853132489, 'f1-score': 0.42561918283640954, 'support': 55499}, '1': {'precision': 0.42908737507059086, 'recall': 0.4774095505289614, 'f1-score': 0.4519605198541974, 'support': 68436}, '2': {'precision': 0.42933238636363635, 'recall': 0.2441751583585789, 'f1-score': 0.3113025362530869, 'support': 54465}, 'accuracy': 0.40891816143497756, 'macro avg': {'precision': 0.41230724884514885, 'recall': 0.40257319806692976, 'f1-score': 0.3962940796478979, 'support': 178400}, 'weighted avg': {'precision': 0.4134254130872139, 'recall': 0.40891816143497756, 'f1-score': 0.4008234405941935, 'support': 178400}}
[[26980 20325  8194]
 [26281 32672  9483]
 [18020 23146 13299]]
testing model on single stock: results/universal/W1/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
21353/21353 - 284s - 284s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1116179
{'0': {'precision': 0.37440550870947975, 'recall': 0.7890916667937204, 'f1-score': 0.5078487049984275, 'support': 1967670}, '1': {'precision': 0.33519131161236426, 'recall': 0.0987434831230607, 'f1-score': 0.15254806953829214, 'support': 1523736}, '2': {'precision': 0.4111217969709609, 'recall': 0.1811834145140978, 'f1-score': 0.25152049825666406, 'support': 1974811}, 'accuracy': 0.37703113506104863, 'macro avg': {'precision': 0.373572872430935, 'recall': 0.35633952147695963, 'f1-score': 0.30397242426446125, 'support': 5466217}, 'weighted avg': {'precision': 0.3767390505556914, 'recall': 0.37703113506104863, 'f1-score': 0.3162016973224802, 'support': 5466217}}
[[1552672  138430  276568]
 [1137339  150459  235938]
 [1457022  159986  357803]]
Evaluating performance on  train set...
6073/6073 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038297
{'0': {'precision': 0.37025206163641106, 'recall': 0.521079870230187, 'f1-score': 0.4329047111011287, 'support': 517840}, '1': {'precision': 0.36568682533402924, 'recall': 0.42413253286137875, 'f1-score': 0.39274722214287755, 'support': 518694}, '2': {'precision': 0.41294107150823034, 'recall': 0.17869773367823635, 'f1-score': 0.2494482544900901, 'support': 518020}, 'accuracy': 0.3746412154225585, 'macro avg': {'precision': 0.3829599861595569, 'recall': 0.3746367122566007, 'f1-score': 0.35836672924469876, 'support': 1554554}, 'weighted avg': {'precision': 0.3829539685596651, 'recall': 0.3746412154225585, 'f1-score': 0.358373004752323, 'support': 1554554}}
[[269836 178499  69505]
 [236603 219995  62096]
 [222351 203100  92569]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1120297
{'0': {'precision': 0.3529539307763412, 'recall': 0.6039011754292334, 'f1-score': 0.4455205229837732, 'support': 153646}, '1': {'precision': 0.3463957783641161, 'recall': 0.22390574687551165, 'f1-score': 0.27199648619755196, 'support': 146584}, '2': {'precision': 0.41747358270722007, 'recall': 0.26478851703904743, 'f1-score': 0.324046172018447, 'support': 156963}, 'accuracy': 0.3656442683943105, 'macro avg': {'precision': 0.37227443061589244, 'recall': 0.36419847978126413, 'f1-score': 0.3471877270665907, 'support': 457193}, 'weighted avg': {'precision': 0.37300208967823373, 'recall': 0.3656442683943105, 'f1-score': 0.34818126809832667, 'support': 457193}}
[[92787 28629 32230]
 [87999 32821 25764]
 [82101 33300 41562]]
training model: results/universal/W1/deepLOB_L2/h200
Epoch 1/50
10622/10622 - 419s - loss: 3.2488 - accuracy200: 0.3938 - val_loss: 3.3668 - val_accuracy200: 0.3383 - 419s/epoch - 39ms/step
Epoch 2/50
10622/10622 - 416s - loss: 3.2204 - accuracy200: 0.4113 - val_loss: 3.4100 - val_accuracy200: 0.3366 - 416s/epoch - 39ms/step
Epoch 3/50
10622/10622 - 418s - loss: 3.2103 - accuracy200: 0.4174 - val_loss: 3.4856 - val_accuracy200: 0.3364 - 418s/epoch - 39ms/step
Epoch 4/50
10622/10622 - 417s - loss: 3.2044 - accuracy200: 0.4205 - val_loss: 3.5250 - val_accuracy200: 0.3407 - 417s/epoch - 39ms/step
Epoch 5/50
10622/10622 - 418s - loss: 3.1990 - accuracy200: 0.4226 - val_loss: 3.5045 - val_accuracy200: 0.3379 - 418s/epoch - 39ms/step
Epoch 6/50
10622/10622 - 420s - loss: 3.1956 - accuracy200: 0.4243 - val_loss: 3.4747 - val_accuracy200: 0.3348 - 420s/epoch - 40ms/step
Epoch 7/50
10622/10622 - 423s - loss: 3.1915 - accuracy200: 0.4261 - val_loss: 3.4817 - val_accuracy200: 0.3364 - 423s/epoch - 40ms/step
Epoch 8/50
10622/10622 - 419s - loss: 3.1878 - accuracy200: 0.4281 - val_loss: 3.4733 - val_accuracy200: 0.3382 - 419s/epoch - 39ms/step
Epoch 9/50
10622/10622 - 419s - loss: 3.1846 - accuracy200: 0.4294 - val_loss: 3.4526 - val_accuracy200: 0.3381 - 419s/epoch - 39ms/step
Epoch 10/50
10622/10622 - 418s - loss: 3.1819 - accuracy200: 0.4307 - val_loss: 3.4617 - val_accuracy200: 0.3360 - 418s/epoch - 39ms/step
Epoch 11/50
10622/10622 - 419s - loss: 3.1787 - accuracy200: 0.4318 - val_loss: 3.4877 - val_accuracy200: 0.3365 - 419s/epoch - 39ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 469s - 469s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.130677
{'0': {'precision': 0.3601903125023751, 'recall': 0.8495757990490753, 'f1-score': 0.5058977427653414, 'support': 3235377}, '1': {'precision': 0.290181792889994, 'recall': 0.1295697029644548, 'f1-score': 0.17914775328632565, 'support': 2575988}, '2': {'precision': 0.34105821740982084, 'recall': 0.02796981902790862, 'f1-score': 0.051699793387072306, 'support': 3235416}, 'accuracy': 0.3507282866690373, 'macro avg': {'precision': 0.33047677426739663, 'recall': 0.3357051070138129, 'f1-score': 0.24558176314624644, 'support': 9046781}, 'weighted avg': {'precision': 0.3334137835916797, 'recall': 0.3507282866690373, 'f1-score': 0.2504230756452118, 'support': 9046781}}
[[2748698  404356   82323]
 [2149702  333770   92516]
 [2732838  412084   90494]]
Evaluating performance on  train set...
10622/10622 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1238606
{'0': {'precision': 0.3339302507724297, 'recall': 0.7633133631060642, 'f1-score': 0.46460680114412767, 'support': 912692}, '1': {'precision': 0.32595138062510626, 'recall': 0.1505471505101354, 'f1-score': 0.205965174503452, 'support': 891528}, '2': {'precision': 0.358416111035515, 'recall': 0.08642734175221536, 'f1-score': 0.1392712493522882, 'support': 914294}, 'accuracy': 0.334707490930707, 'macro avg': {'precision': 0.339432580811017, 'recall': 0.33342928512280506, 'f1-score': 0.2699477416666226, 'support': 2718514}, 'weighted avg': {'precision': 0.3395487206345214, 'recall': 0.334707490930707, 'f1-score': 0.2703688479440793, 'support': 2718514}}
[[696670 138236  77786]
 [693647 134217  63664]
 [695957 139317  79020]]
Evaluating performance on  val set...
3064/3064 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1230487
{'0': {'precision': 0.34280026988038037, 'recall': 0.6833995340559058, 'f1-score': 0.4565768650741934, 'support': 269131}, '1': {'precision': 0.3066905395892633, 'recall': 0.1632076355211349, 'f1-score': 0.21304291207900478, 'support': 245589}, '2': {'precision': 0.3514997597638822, 'recall': 0.15226456749102424, 'f1-score': 0.21248411607582793, 'support': 269058}, 'accuracy': 0.3380727706059624, 'macro avg': {'precision': 0.333663523077842, 'recall': 0.332957245689355, 'f1-score': 0.29403463107634203, 'support': 783778}, 'weighted avg': {'precision': 0.3344720376470312, 'recall': 0.3380727706059624, 'f1-score': 0.2964749397303619, 'support': 783778}}
[[183924  45038  40169]
 [170092  40082  35415]
 [182518  45572  40968]]
testing model out of sample: results/universal/W1/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 319s - 319s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1224267
{'0': {'precision': 0.33855819748983906, 'recall': 0.774453772692862, 'f1-score': 0.4711497815770322, 'support': 2058026}, '1': {'precision': 0.3249458699481852, 'recall': 0.12672691577433018, 'f1-score': 0.18234168271293028, 'support': 1982436}, '2': {'precision': 0.35768026497949257, 'recall': 0.10742427142117437, 'f1-score': 0.16522540143127912, 'support': 2058734}, 'accuracy': 0.3387712085330591, 'macro avg': {'precision': 0.3403947774725056, 'recall': 0.3362016532961221, 'f1-score': 0.2729056219070805, 'support': 6099196}, 'weighted avg': {'precision': 0.34058824904563073, 'recall': 0.3387712085330591, 'f1-score': 0.27401552074745045, 'support': 6099196}}
[[1593846  257638  206542]
 [1540596  251228  190612]
 [1573304  264272  221158]]
Evaluating performance on  train set...
6711/6711 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1197261
{'0': {'precision': 0.33566217219597755, 'recall': 0.6490793035341773, 'f1-score': 0.44249455176078456, 'support': 576683}, '1': {'precision': 0.3428279175254572, 'recall': 0.15794378502404802, 'f1-score': 0.21625638441712855, 'support': 566575}, '2': {'precision': 0.34534921900652, 'recall': 0.20521933033692205, 'f1-score': 0.25745144920251245, 'support': 574020}, 'accuracy': 0.3386755085664639, 'macro avg': {'precision': 0.3412797695759849, 'recall': 0.3374141396317158, 'f1-score': 0.3054007951268085, 'support': 1717278}, 'weighted avg': {'precision': 0.3412643465499479, 'recall': 0.3386755085664639, 'f1-score': 0.30599985993265233, 'support': 1717278}}
[[374313  84814 117556]
 [371340  89487 105748]
 [369495  86725 117800]]
Evaluating performance on  val set...
1720/1720 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1145935
{'0': {'precision': 0.33816229358727584, 'recall': 0.6952764899549821, 'f1-score': 0.4550173580956443, 'support': 148830}, '1': {'precision': 0.3525745738636364, 'recall': 0.13514782750735055, 'f1-score': 0.19539675667165238, 'support': 146928}, '2': {'precision': 0.36337254295000776, 'recall': 0.19551684652486206, 'f1-score': 0.25423797641984053, 'support': 144095}, 'accuracy': 0.3444514417316694, 'macro avg': {'precision': 0.3513698034669733, 'recall': 0.34198038799573155, 'f1-score': 0.3015506970623791, 'support': 439853}, 'weighted avg': {'precision': 0.35123538482086514, 'recall': 0.3444514417316694, 'f1-score': 0.3025190445031504, 'support': 439853}}
[[103478  18402  26950]
 [104662  19857  22409]
 [ 97861  18061  28173]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1208116
{'0': {'precision': 0.35639708473193255, 'recall': 0.6217707103224033, 'f1-score': 0.4530864124764975, 'support': 61817}, '1': {'precision': 0.3078402050843837, 'recall': 0.22066114120552036, 'f1-score': 0.25706035165178226, 'support': 52243}, '2': {'precision': 0.33114700336148234, 'recall': 0.14521464010929747, 'f1-score': 0.20189447901826996, 'support': 55628}, 'accuracy': 0.3420512941398331, 'macro avg': {'precision': 0.33179476439259953, 'recall': 0.32921549721240706, 'f1-score': 0.30401374771551654, 'support': 169688}, 'weighted avg': {'precision': 0.3331699349635205, 'recall': 0.3420512941398331, 'f1-score': 0.31038749228131646, 'support': 169688}}
[[38436 13387  9994]
 [34393 11528  6322]
 [35017 12533  8078]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1301448
{'0': {'precision': 0.3297209570179572, 'recall': 0.866697247706422, 'f1-score': 0.47770628168337487, 'support': 21800}, '1': {'precision': 0.3343156516044532, 'recall': 0.13922727272727273, 'f1-score': 0.19658558500738077, 'support': 22000}, '2': {'precision': 0.9310344827586207, 'recall': 0.0023764467719931347, 'f1-score': 0.004740792765901409, 'support': 22723}, 'accuracy': 0.33087804218089983, 'macro avg': {'precision': 0.5316903637936771, 'recall': 0.3361003224018959, 'f1-score': 0.22634421981888567, 'support': 66523}, 'weighted avg': {'precision': 0.5366378207539283, 'recall': 0.33087804218089983, 'f1-score': 0.22318002562842215, 'support': 66523}}
[[18894  2904     2]
 [18935  3063     2]
 [19474  3195    54]]
Evaluating performance on  val set...
51/51 - 1s - 847ms/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016178
{'0': {'precision': 0.3358916959812387, 'recall': 0.770039100684262, 'f1-score': 0.46775031544570633, 'support': 4092}, '1': {'precision': 0.3801857585139319, 'recall': 0.12108065470321436, 'f1-score': 0.18366736464253663, 'support': 5071}, '2': {'precision': 0.33927606699081575, 'recall': 0.17046688382193267, 'f1-score': 0.22691960252935858, 'support': 3684}, 'accuracy': 0.3419475363898186, 'macro avg': {'precision': 0.35178450716199544, 'recall': 0.35386221306980303, 'f1-score': 0.2927790942058672, 'support': 12847}, 'weighted avg': {'precision': 0.35434605994968027, 'recall': 0.3419475363898186, 'f1-score': 0.2865558739491158, 'support': 12847}}
[[3151  481  460]
 [3694  614  763]
 [2536  520  628]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
1645/1645 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064898
{'0': {'precision': 0.3422575301556193, 'recall': 0.6638433632256556, 'f1-score': 0.4516552791126688, 'support': 132587}, '1': {'precision': 0.40086611331649225, 'recall': 0.16848070086030117, 'f1-score': 0.23724802542492343, 'support': 164826}, '2': {'precision': 0.2803032706277956, 'recall': 0.21447122502973373, 'f1-score': 0.2430076180523088, 'support': 123597}, 'accuracy': 0.33798484596565403, 'macro avg': {'precision': 0.34114230469996903, 'recall': 0.34893176303856355, 'f1-score': 0.31063697419663366, 'support': 421010}, 'weighted avg': {'precision': 0.34701479889796183, 'recall': 0.33798484596565403, 'f1-score': 0.30646130519182696, 'support': 421010}}
[[88017 20609 23961]
 [92956 27770 44100]
 [76193 20896 26508]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1250935
{'0': {'precision': 0.33442371487446754, 'recall': 0.6211447695872307, 'f1-score': 0.4347685062828861, 'support': 58265}, '1': {'precision': 0.2946496236043046, 'recall': 0.2226506576058946, 'f1-score': 0.25363965511617537, 'support': 52387}, '2': {'precision': 0.3344843823575577, 'recall': 0.11362101446699606, 'f1-score': 0.16962283925231164, 'support': 56266}, 'accuracy': 0.32499790316203164, 'macro avg': {'precision': 0.32118590694544324, 'recall': 0.3191388138867071, 'f1-score': 0.28601033355045774, 'support': 166918}, 'weighted avg': {'precision': 0.3219611176544764, 'recall': 0.32499790316203164, 'f1-score': 0.28854411330422125, 'support': 166918}}
[[36191 14439  7635]
 [35638 11664  5085]
 [36390 13483  6393]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136048
{'0': {'precision': 0.3683686494766403, 'recall': 0.8604567952769993, 'f1-score': 0.5158833729598312, 'support': 16769}, '1': {'precision': 0.34416501836677027, 'recall': 0.17103138383767466, 'f1-score': 0.22850710567046575, 'support': 14243}, '2': {'precision': 0.6190476190476191, 'recall': 0.0017017934284592224, 'f1-score': 0.0033942558746736288, 'support': 15278}, 'accuracy': 0.3648952257507021, 'macro avg': {'precision': 0.4438604289636765, 'recall': 0.34439665751437776, 'f1-score': 0.24926157816832353, 'support': 46290}, 'weighted avg': {'precision': 0.44365793397021425, 'recall': 0.3648952257507021, 'f1-score': 0.25831351109270073, 'support': 46290}}
[[14429  2337     3]
 [11794  2436    13]
 [12947  2305    26]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1193575
{'0': {'precision': 0.3396633100841172, 'recall': 0.8197679071628652, 'f1-score': 0.48031323756975164, 'support': 112455}, '1': {'precision': 0.35326472335613945, 'recall': 0.1616206784684045, 'f1-score': 0.2217770558864225, 'support': 114051}, '2': {'precision': 0.365959460525278, 'recall': 0.04227443763153819, 'f1-score': 0.0757934628138323, 'support': 109759}, 'accuracy': 0.3427653784961266, 'macro avg': {'precision': 0.35296249798851154, 'recall': 0.3412210077542693, 'f1-score': 0.25929458542333544, 'support': 336265}, 'weighted avg': {'precision': 0.35285972945978455, 'recall': 0.3427653784961266, 'f1-score': 0.2605877353182526, 'support': 336265}}
[[92187 17042  3226]
 [90805 18433  4813]
 [88415 16704  4640]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.118797
{'0': {'precision': 0.3347043536158423, 'recall': 0.686724688773824, 'f1-score': 0.450055233460647, 'support': 45385}, '1': {'precision': 0.317103414069604, 'recall': 0.17187535004592602, 'f1-score': 0.22292281094274383, 'support': 44637}, '2': {'precision': 0.3569376271998084, 'recall': 0.13553504864078553, 'f1-score': 0.19646799116997793, 'support': 43996}, 'accuracy': 0.33429837782984373, 'macro avg': {'precision': 0.3362484649617516, 'recall': 0.33137836248684516, 'f1-score': 0.2898153451911229, 'support': 134018}, 'weighted avg': {'precision': 0.33614089173814476, 'recall': 0.33429837782984373, 'f1-score': 0.29115617321685944, 'support': 134018}}
[[31167  8351  5867]
 [32089  7672  4876]
 [29862  8171  5963]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211069
{'0': {'precision': 0.336895294897283, 'recall': 0.900376355988488, 'f1-score': 0.4903249140997047, 'support': 9034}, '1': {'precision': 0.4035029742233972, 'recall': 0.12890625, 'f1-score': 0.1953912626020163, 'support': 9472}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8664}, 'accuracy': 0.34431358115568644, 'macro avg': {'precision': 0.24679942304022673, 'recall': 0.3430942019961627, 'f1-score': 0.22857205890057367, 'support': 27170}, 'weighted avg': {'precision': 0.25268650224313854, 'recall': 0.34431358115568644, 'f1-score': 0.2311498459088344, 'support': 27170}}
[[8134  900    0]
 [8251 1221    0]
 [7759  905    0]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.129265
{'0': {'precision': 0.33878242406210274, 'recall': 0.8904143673411354, 'f1-score': 0.4908192730363139, 'support': 112533}, '1': {'precision': 0.3498643630330006, 'recall': 0.12435291364380997, 'f1-score': 0.18348826608837382, 'support': 106825}, '2': {'precision': 0.25, 'recall': 8.742557897589676e-06, 'f1-score': 1.748450435801271e-05, 'support': 114383}, 'accuracy': 0.34004212847687276, 'macro avg': {'precision': 0.31288226236503447, 'recall': 0.33825867451428104, 'f1-score': 0.2247750078763486, 'support': 333741}, 'weighted avg': {'precision': 0.31190118417569584, 'recall': 0.34004212847687276, 'f1-score': 0.22423525790222965, 'support': 333741}}
[[100201  12331      1]
 [ 93539  13284      2]
 [102028  12354      1]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221563
{'0': {'precision': 0.33221206014571386, 'recall': 0.657029860813048, 'f1-score': 0.44129396260604564, 'support': 32618}, '1': {'precision': 0.33242550464594683, 'recall': 0.1917863084601639, 'f1-score': 0.24324007502344483, 'support': 32458}, '2': {'precision': 0.34437041972018656, 'recall': 0.15583358456436538, 'f1-score': 0.2145703611457036, 'support': 33170}, 'accuracy': 0.33411029456669994, 'macro avg': {'precision': 0.3363359948372824, 'recall': 0.33488325127919244, 'f1-score': 0.29970146625839805, 'support': 98246}, 'weighted avg': {'precision': 0.33638750513760995, 'recall': 0.33411029456669994, 'f1-score': 0.2993151039899635, 'support': 98246}}
[[21431  6132  5055]
 [21447  6225  4786]
 [21632  6369  5169]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.132562
{'0': {'precision': 0.29478000520697734, 'recall': 0.6238292011019284, 'f1-score': 0.40037128712871284, 'support': 7260}, '1': {'precision': 0.3493490390576565, 'recall': 0.1388101983002833, 'f1-score': 0.198677831643896, 'support': 8119}, '2': {'precision': 0.36378141204627046, 'recall': 0.2217629179331307, 'f1-score': 0.27554951280308176, 'support': 8225}, 'accuracy': 0.3168954414506016, 'macro avg': {'precision': 0.33597015210363484, 'recall': 0.3281341057784475, 'f1-score': 0.29153287719189686, 'support': 23604}, 'weighted avg': {'precision': 0.33759404338215315, 'recall': 0.3168954414506016, 'f1-score': 0.28750023735284674, 'support': 23604}}
[[4529  929 1802]
 [5604 1127 1388]
 [5231 1170 1824]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1168029
{'0': {'precision': 0.3508886313145948, 'recall': 0.5675235855197494, 'f1-score': 0.4336561960122425, 'support': 230438}, '1': {'precision': 0.31444104542129414, 'recall': 0.1813266093659369, 'f1-score': 0.23001310416749007, 'support': 208607}, '2': {'precision': 0.34990361888152005, 'recall': 0.2671914906666316, 'f1-score': 0.30300440911631377, 'support': 228267}, 'accuracy': 0.3440609490013667, 'macro avg': {'precision': 0.33841109853913637, 'recall': 0.33868056185077267, 'f1-score': 0.3222245697653488, 'support': 667312}, 'weighted avg': {'precision': 0.33915788560118876, 'recall': 0.3440609490013667, 'f1-score': 0.32530378229897006, 'support': 667312}}
[[130779  40528  59131]
 [116595  37826  54186]
 [125334  41942  60991]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1220684
{'0': {'precision': 0.33473950813457337, 'recall': 0.6736575547042399, 'f1-score': 0.44724406054499116, 'support': 61604}, '1': {'precision': 0.33600375528086374, 'recall': 0.17593851901617316, 'f1-score': 0.2309479254049171, 'support': 61027}, '2': {'precision': 0.33623208571031027, 'recall': 0.15578010926848135, 'f1-score': 0.21291452360760818, 'support': 62049}, 'accuracy': 0.3351905999566818, 'macro avg': {'precision': 0.33565844970858244, 'recall': 0.3351253943296315, 'f1-score': 0.2970355031858388, 'support': 184680}, 'weighted avg': {'precision': 0.33565875308039084, 'recall': 0.3351905999566818, 'f1-score': 0.2970392864675546, 'support': 184680}}
[[41500 10498  9606]
 [40814 10737  9476]
 [41663 10720  9666]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121638
{'0': {'precision': 0.3543579645559125, 'recall': 0.8341139734582358, 'f1-score': 0.4974032964315328, 'support': 20496}, '1': {'precision': 0.31037615845902233, 'recall': 0.09931964877594929, 'f1-score': 0.15048458149779734, 'support': 17197}, '2': {'precision': 0.4178899082568807, 'recall': 0.08924810188586824, 'f1-score': 0.1470837537840565, 'support': 20415}, 'accuracy': 0.3549597301576375, 'macro avg': {'precision': 0.3608746770906052, 'recall': 0.34089390804001773, 'f1-score': 0.2649905439044622, 'support': 58108}, 'weighted avg': {'precision': 0.36366218275662576, 'recall': 0.3549597301576375, 'f1-score': 0.27165581581158926, 'support': 58108}}
[[17096  1916  1484]
 [14435  1708  1054]
 [16714  1879  1822]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
5343/5343 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.123837
{'0': {'precision': 0.35364018120310825, 'recall': 0.7034897037083307, 'f1-score': 0.47067485243741214, 'support': 480270}, '1': {'precision': 0.2978596932983839, 'recall': 0.17947385046250122, 'f1-score': 0.22398604394171734, 'support': 402053}, '2': {'precision': 0.375598029880923, 'recall': 0.13163640708103141, 'f1-score': 0.19494881087479105, 'support': 485466}, 'accuracy': 0.3464920393423255, 'macro avg': {'precision': 0.3423659681274717, 'recall': 0.3381999870839545, 'f1-score': 0.29653656908464016, 'support': 1367789}, 'weighted avg': {'precision': 0.34503730200366, 'recall': 0.3464920393423255, 'f1-score': 0.30029945534373836, 'support': 1367789}}
[[337865  84242  58163]
 [281821  72158  48074]
 [335706  85855  63905]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1284522
{'0': {'precision': 0.33137252823735985, 'recall': 0.8603849046911406, 'f1-score': 0.47846636110197127, 'support': 109014}, '1': {'precision': 0.33534210016572324, 'recall': 0.14264004467514396, 'f1-score': 0.2001464392148803, 'support': 109233}, '2': {'precision': 0.5187406296851574, 'recall': 0.003091217725364067, 'f1-score': 0.006145812055383359, 'support': 111930}, 'accuracy': 0.3323096399809799, 'macro avg': {'precision': 0.3951517526960802, 'recall': 0.33537205569721623, 'f1-score': 0.22825287079074497, 'support': 330177}, 'weighted avg': {'precision': 0.39620357293612113, 'recall': 0.3323096399809799, 'f1-score': 0.22627266171565064, 'support': 330177}}
[[93794 15057   163]
 [93494 15581   158]
 [95759 15825   346]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1188276
{'0': {'precision': 0.32889980407847896, 'recall': 0.7867586388989736, 'f1-score': 0.46387810502349747, 'support': 30299}, '1': {'precision': 0.355909596146721, 'recall': 0.14614331355545412, 'f1-score': 0.2072044866264021, 'support': 32865}, '2': {'precision': 0.35671663513316837, 'recall': 0.08258086253369272, 'f1-score': 0.13411397772974745, 'support': 29680}, 'accuracy': 0.33488432208866487, 'macro avg': {'precision': 0.34717534511945614, 'recall': 0.33849427166270685, 'f1-score': 0.2683988564598823, 'support': 92844}, 'weighted avg': {'precision': 0.34735312752453856, 'recall': 0.33488432208866487, 'f1-score': 0.2676028716567851, 'support': 92844}}
[[23838  4236  2225]
 [25867  4803  2195]
 [22773  4456  2451]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
7177/7177 - 95s - 95s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1106045
{'0': {'precision': 0.36354249274414424, 'recall': 0.6851349956318825, 'f1-score': 0.4750281891985294, 'support': 649021}, '1': {'precision': 0.3096938602811398, 'recall': 0.11393657124660432, 'f1-score': 0.1665860332521797, 'support': 562111}, '2': {'precision': 0.36195344084806624, 'recall': 0.235423519506931, 'f1-score': 0.2852883810298182, 'support': 625957}, 'accuracy': 0.3571285876732156, 'macro avg': {'precision': 0.3450632646244501, 'recall': 0.344831695461806, 'f1-score': 0.30896753449350906, 'support': 1837089}, 'weighted avg': {'precision': 0.34652448937026026, 'recall': 0.3571285876732156, 'f1-score': 0.3160006789238391, 'support': 1837089}}
[[444667  69980 134374]
 [372667  64045 125399]
 [405816  72776 147365]]
Evaluating performance on  train set...
2257/2257 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1168368
{'0': {'precision': 0.3412655783409107, 'recall': 0.5445589510739248, 'f1-score': 0.41958473536903684, 'support': 196010}, '1': {'precision': 0.3449624927870744, 'recall': 0.15819780149989152, 'f1-score': 0.21691818125741572, 'support': 188947}, '2': {'precision': 0.3410196967740849, 'recall': 0.31540665981372457, 'f1-score': 0.32771348197934563, 'support': 192618}, 'accuracy': 0.34174436220404275, 'macro avg': {'precision': 0.3424159226340233, 'recall': 0.3393878041291803, 'f1-score': 0.3214054662019327, 'support': 577575}, 'weighted avg': {'precision': 0.342392981151317, 'recall': 0.34174436220404275, 'f1-score': 0.322646165512059, 'support': 577575}}
[[106739  27862  61409]
 [103067  29891  55989]
 [102968  28897  60753]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110084
{'0': {'precision': 0.3409679923171037, 'recall': 0.45984883432099644, 'f1-score': 0.39158451369216246, 'support': 56362}, '1': {'precision': 0.3391991838816628, 'recall': 0.15088488882166087, 'f1-score': 0.2088622503729683, 'support': 52888}, '2': {'precision': 0.350499302387559, 'recall': 0.4134398461481564, 'f1-score': 0.37937675515623537, 'support': 54078}, 'accuracy': 0.34443573667711597, 'macro avg': {'precision': 0.34355549286210846, 'recall': 0.34139118976360455, 'f1-score': 0.3266078397404554, 'support': 163328}, 'weighted avg': {'precision': 0.3435510487768441, 'recall': 0.34443573667711597, 'f1-score': 0.3283743707373022, 'support': 163328}}
[[25918  7888 22556]
 [26033  7980 18875]
 [24062  7658 22358]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
5696/5696 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1299556
{'0': {'precision': 0.3510652582759838, 'recall': 0.8528655701840059, 'f1-score': 0.49738982438772655, 'support': 511940}, '1': {'precision': 0.29610909650952777, 'recall': 0.14546725972120322, 'f1-score': 0.19509277722856763, 'support': 436160}, '2': {'precision': 0.3333333333333333, 'recall': 4.314368415685475e-05, 'f1-score': 8.627620149414694e-05, 'support': 509924}, 'accuracy': 0.3429881812645059, 'macro avg': {'precision': 0.32683589603961494, 'recall': 0.3327919911964553, 'f1-score': 0.23085629260592944, 'support': 1458024}, 'weighted avg': {'precision': 0.32842392067762216, 'recall': 0.3429881812645059, 'f1-score': 0.23303416591142226, 'support': 1458024}}
[[436616  75298     26]
 [372695  63447     18]
 [434378  75524     22]]
Evaluating performance on  train set...
2222/2222 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158731
{'0': {'precision': 0.34215750774554615, 'recall': 0.6101136950904392, 'f1-score': 0.43843598489983043, 'support': 193500}, '1': {'precision': 0.33638419923514595, 'recall': 0.15647660525330975, 'f1-score': 0.2135948205976746, 'support': 184379}, '2': {'precision': 0.3497467601259669, 'recall': 0.25270001048547763, 'f1-score': 0.2934068676686329, 'support': 190740}, 'accuracy': 0.3431260650804845, 'macro avg': {'precision': 0.34276282236888633, 'recall': 0.33976343694307554, 'f1-score': 0.3151458910553793, 'support': 568619}, 'weighted avg': {'precision': 0.3428312403313415, 'recall': 0.3431260650804845, 'f1-score': 0.31688035124434966, 'support': 568619}}
[[118057  28695  46748]
 [112662  28851  42866]
 [114318  28222  48200]]
Evaluating performance on  val set...
641/641 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189476
{'0': {'precision': 0.36844100773260163, 'recall': 0.613813164893617, 'f1-score': 0.4604794712722512, 'support': 60160}, '1': {'precision': 0.2957089552238806, 'recall': 0.21905029259971065, 'f1-score': 0.2516715666207684, 'support': 46309}, '2': {'precision': 0.3271369124769766, 'recall': 0.16715465857994352, 'f1-score': 0.22125588262434256, 'support': 57378}, 'accuracy': 0.34582262720708956, 'macro avg': {'precision': 0.3304289584778196, 'recall': 0.33333937202442376, 'f1-score': 0.31113564017245404, 'support': 163847}, 'weighted avg': {'precision': 0.33341995152038156, 'recall': 0.34582262720708956, 'f1-score': 0.31768859731090177, 'support': 163847}}
[[36927 12397 10836]
 [27274 10144  8891]
 [36024 11763  9591]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1311336
{'0': {'precision': 0.3249474356999677, 'recall': 0.8843865597259769, 'f1-score': 0.4752684466614263, 'support': 1004295}, '1': {'precision': 0.33443814818774725, 'recall': 0.11369932199758184, 'f1-score': 0.16970413423964797, 'support': 1045424}, '2': {'precision': 0.3394495412844037, 'recall': 3.5606949321687616e-05, 'f1-score': 7.120642936322207e-05, 'support': 1039123}, 'accuracy': 0.3260399852112863, 'macro avg': {'precision': 0.33294504172403955, 'recall': 0.33270716289096014, 'f1-score': 0.21501459577681248, 'support': 3088842}, 'weighted avg': {'precision': 0.3330382639369058, 'recall': 0.3260399852112863, 'f1-score': 0.2119876936766873, 'support': 3088842}}
[[888185 116065     45]
 [926533 118864     27]
 [918601 120485     37]]
Evaluating performance on  train set...
2948/2948 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1206204
{'0': {'precision': 0.3329719217303781, 'recall': 0.6973964205745502, 'f1-score': 0.45073866661534806, 'support': 251884}, '1': {'precision': 0.34615244480069957, 'recall': 0.15202989230449185, 'f1-score': 0.21127011130013232, 'support': 249964}, '2': {'precision': 0.35230542014905625, 'recall': 0.16335093455354385, 'f1-score': 0.2232084181831458, 'support': 252634}, 'accuracy': 0.33789142749595086, 'macro avg': {'precision': 0.34380992889337797, 'recall': 0.3375924158108619, 'f1-score': 0.29507239869954205, 'support': 754482}, 'weighted avg': {'precision': 0.34381241270067847, 'recall': 0.33789142749595086, 'f1-score': 0.29521422104443507, 'support': 754482}}
[[175663  35789  40432]
 [176525  38002  35437]
 [175373  35993  41268]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1159068
{'0': {'precision': 0.33200164383930797, 'recall': 0.8374400978826089, 'f1-score': 0.47549438196826505, 'support': 58846}, '1': {'precision': 0.3796691568836713, 'recall': 0.13704654895666132, 'f1-score': 0.2013964240222673, 'support': 62300}, '2': {'precision': 0.442305121005482, 'recall': 0.05777762252419045, 'f1-score': 0.10220443977569399, 'support': 57254}, 'accuracy': 0.34263452914798204, 'macro avg': {'precision': 0.3846586405761538, 'recall': 0.34408808978782024, 'f1-score': 0.25969841525540877, 'support': 178400}, 'weighted avg': {'precision': 0.3840476155003841, 'recall': 0.34263452914798204, 'f1-score': 0.259975070699604, 'support': 178400}}
[[49280  7084  2482]
 [52073  8538  1689]
 [47080  6866  3308]]
testing model on single stock: results/universal/W1/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
21353/21353 - 282s - 282s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1345539
{'0': {'precision': 0.3659153941685119, 'recall': 0.8934844876021435, 'f1-score': 0.5191992363930156, 'support': 1998047}, '1': {'precision': 0.2664296797951943, 'recall': 0.10668879303524122, 'f1-score': 0.15236480118759976, 'support': 1466124}, '2': {'precision': 0.3582089552238806, 'recall': 5.99386827275697e-05, 'f1-score': 0.00011985730987259667, 'support': 2002046}, 'accuracy': 0.3552297685949899, 'macro avg': {'precision': 0.33018467639586224, 'recall': 0.3334110731067041, 'f1-score': 0.22389463163016265, 'support': 5466217}, 'weighted avg': {'precision': 0.3364092405044314, 'recall': 0.3552297685949899, 'f1-score': 0.23069156023288598, 'support': 5466217}}
[[1785224  212693     130]
 [1309620  156419      85]
 [1783945  217981     120]]
Evaluating performance on  train set...
6073/6073 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1258131
{'0': {'precision': 0.33201401015339077, 'recall': 0.8212499638933554, 'f1-score': 0.4728605071981692, 'support': 519295}, '1': {'precision': 0.3249724527198723, 'recall': 0.1408304113855587, 'f1-score': 0.19650374753880795, 'support': 513071}, '2': {'precision': 0.40008802816901406, 'recall': 0.03655579982688227, 'f1-score': 0.06699070012282857, 'support': 522188}, 'accuracy': 0.33309618064087837, 'macro avg': {'precision': 0.35235816368075906, 'recall': 0.33287872503526544, 'f1-score': 0.24545165161993523, 'support': 1554554}, 'weighted avg': {'precision': 0.3525566329285208, 'recall': 0.33309618064087837, 'f1-score': 0.24531551239435662, 'support': 1554554}}
[[426471  74765  18059]
 [430251  72256  10564]
 [427775  75324  19089]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1258601
{'0': {'precision': 0.337043670550505, 'recall': 0.6741527259559114, 'f1-score': 0.44940608976224194, 'support': 154643}, '1': {'precision': 0.2985398850606319, 'recall': 0.15073618737547986, 'f1-score': 0.20032566528435747, 'support': 144053}, '2': {'precision': 0.35811718989127395, 'recall': 0.16978239335760298, 'f1-score': 0.23035439137134053, 'support': 158497}, 'accuracy': 0.3343817600006999, 'macro avg': {'precision': 0.3312335818341369, 'recall': 0.3315571022296648, 'f1-score': 0.29336204880598, 'support': 457193}, 'weighted avg': {'precision': 0.3322174894492659, 'recall': 0.3343817600006999, 'f1-score': 0.2949859227273674, 'support': 457193}}
[[104253  24903  25487]
 [ 99593  21714  22746]
 [105470  26117  26910]]
training model: results/universal/W1/deepOF_L2/h50
Epoch 1/50
10622/10622 - 237s - loss: 2.9756 - accuracy50: 0.4917 - val_loss: 3.2173 - val_accuracy50: 0.4523 - 237s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 227s - loss: 2.9142 - accuracy50: 0.5096 - val_loss: 3.2030 - val_accuracy50: 0.4549 - 227s/epoch - 21ms/step
Epoch 3/50
10622/10622 - 229s - loss: 2.8991 - accuracy50: 0.5133 - val_loss: 3.2037 - val_accuracy50: 0.4554 - 229s/epoch - 22ms/step
Epoch 4/50
10622/10622 - 229s - loss: 2.8904 - accuracy50: 0.5151 - val_loss: 3.2097 - val_accuracy50: 0.4562 - 229s/epoch - 22ms/step
Epoch 5/50
10622/10622 - 230s - loss: 2.8843 - accuracy50: 0.5166 - val_loss: 3.2002 - val_accuracy50: 0.4584 - 230s/epoch - 22ms/step
Epoch 6/50
10622/10622 - 229s - loss: 2.8793 - accuracy50: 0.5180 - val_loss: 3.2029 - val_accuracy50: 0.4586 - 229s/epoch - 22ms/step
Epoch 7/50
10622/10622 - 228s - loss: 2.8754 - accuracy50: 0.5189 - val_loss: 3.2062 - val_accuracy50: 0.4588 - 228s/epoch - 21ms/step
Epoch 8/50
10622/10622 - 228s - loss: 2.8717 - accuracy50: 0.5199 - val_loss: 3.1953 - val_accuracy50: 0.4604 - 228s/epoch - 21ms/step
Epoch 9/50
10622/10622 - 228s - loss: 2.8683 - accuracy50: 0.5208 - val_loss: 3.1951 - val_accuracy50: 0.4603 - 228s/epoch - 21ms/step
Epoch 10/50
10622/10622 - 230s - loss: 2.8656 - accuracy50: 0.5214 - val_loss: 3.2017 - val_accuracy50: 0.4612 - 230s/epoch - 22ms/step
Epoch 11/50
10622/10622 - 226s - loss: 2.8626 - accuracy50: 0.5223 - val_loss: 3.2023 - val_accuracy50: 0.4604 - 226s/epoch - 21ms/step
Epoch 12/50
10622/10622 - 226s - loss: 2.8601 - accuracy50: 0.5226 - val_loss: 3.1984 - val_accuracy50: 0.4626 - 226s/epoch - 21ms/step
Epoch 13/50
10622/10622 - 229s - loss: 2.8580 - accuracy50: 0.5232 - val_loss: 3.1901 - val_accuracy50: 0.4639 - 229s/epoch - 22ms/step
Epoch 14/50
10622/10622 - 228s - loss: 2.8559 - accuracy50: 0.5238 - val_loss: 3.1918 - val_accuracy50: 0.4641 - 228s/epoch - 21ms/step
Epoch 15/50
10622/10622 - 228s - loss: 2.8537 - accuracy50: 0.5244 - val_loss: 3.1847 - val_accuracy50: 0.4652 - 228s/epoch - 21ms/step
Epoch 16/50
10622/10622 - 227s - loss: 2.8520 - accuracy50: 0.5244 - val_loss: 3.1917 - val_accuracy50: 0.4646 - 227s/epoch - 21ms/step
Epoch 17/50
10622/10622 - 226s - loss: 2.8499 - accuracy50: 0.5251 - val_loss: 3.1773 - val_accuracy50: 0.4666 - 226s/epoch - 21ms/step
Epoch 18/50
10622/10622 - 226s - loss: 2.8482 - accuracy50: 0.5256 - val_loss: 3.1831 - val_accuracy50: 0.4665 - 226s/epoch - 21ms/step
Epoch 19/50
10622/10622 - 231s - loss: 2.8465 - accuracy50: 0.5256 - val_loss: 3.1816 - val_accuracy50: 0.4661 - 231s/epoch - 22ms/step
Epoch 20/50
10622/10622 - 227s - loss: 2.8447 - accuracy50: 0.5264 - val_loss: 3.1726 - val_accuracy50: 0.4683 - 227s/epoch - 21ms/step
Epoch 21/50
10622/10622 - 226s - loss: 2.8433 - accuracy50: 0.5265 - val_loss: 3.1738 - val_accuracy50: 0.4689 - 226s/epoch - 21ms/step
Epoch 22/50
10622/10622 - 226s - loss: 2.8415 - accuracy50: 0.5270 - val_loss: 3.1709 - val_accuracy50: 0.4695 - 226s/epoch - 21ms/step
Epoch 23/50
10622/10622 - 227s - loss: 2.8402 - accuracy50: 0.5272 - val_loss: 3.1782 - val_accuracy50: 0.4703 - 227s/epoch - 21ms/step
Epoch 24/50
10622/10622 - 226s - loss: 2.8386 - accuracy50: 0.5275 - val_loss: 3.1787 - val_accuracy50: 0.4707 - 226s/epoch - 21ms/step
Epoch 25/50
10622/10622 - 227s - loss: 2.8372 - accuracy50: 0.5282 - val_loss: 3.1797 - val_accuracy50: 0.4699 - 227s/epoch - 21ms/step
Epoch 26/50
10622/10622 - 227s - loss: 2.8357 - accuracy50: 0.5283 - val_loss: 3.1677 - val_accuracy50: 0.4725 - 227s/epoch - 21ms/step
Epoch 27/50
10622/10622 - 227s - loss: 2.8341 - accuracy50: 0.5287 - val_loss: 3.1789 - val_accuracy50: 0.4715 - 227s/epoch - 21ms/step
Epoch 28/50
10622/10622 - 227s - loss: 2.8325 - accuracy50: 0.5291 - val_loss: 3.1744 - val_accuracy50: 0.4724 - 227s/epoch - 21ms/step
Epoch 29/50
10622/10622 - 227s - loss: 2.8312 - accuracy50: 0.5293 - val_loss: 3.1653 - val_accuracy50: 0.4740 - 227s/epoch - 21ms/step
Epoch 30/50
10622/10622 - 227s - loss: 2.8306 - accuracy50: 0.5296 - val_loss: 3.1673 - val_accuracy50: 0.4745 - 227s/epoch - 21ms/step
Epoch 31/50
10622/10622 - 228s - loss: 2.8285 - accuracy50: 0.5299 - val_loss: 3.1751 - val_accuracy50: 0.4746 - 228s/epoch - 21ms/step
Epoch 32/50
10622/10622 - 230s - loss: 2.8271 - accuracy50: 0.5302 - val_loss: 3.1727 - val_accuracy50: 0.4729 - 230s/epoch - 22ms/step
Epoch 33/50
10622/10622 - 229s - loss: 2.8259 - accuracy50: 0.5308 - val_loss: 3.1806 - val_accuracy50: 0.4719 - 229s/epoch - 22ms/step
Epoch 34/50
10622/10622 - 229s - loss: 2.8246 - accuracy50: 0.5308 - val_loss: 3.1837 - val_accuracy50: 0.4732 - 229s/epoch - 22ms/step
Epoch 35/50
10622/10622 - 229s - loss: 2.8231 - accuracy50: 0.5315 - val_loss: 3.1767 - val_accuracy50: 0.4739 - 229s/epoch - 22ms/step
Epoch 36/50
10622/10622 - 229s - loss: 2.8221 - accuracy50: 0.5316 - val_loss: 3.1815 - val_accuracy50: 0.4734 - 229s/epoch - 22ms/step
Epoch 37/50
10622/10622 - 228s - loss: 2.8204 - accuracy50: 0.5320 - val_loss: 3.1718 - val_accuracy50: 0.4764 - 228s/epoch - 21ms/step
Epoch 38/50
10622/10622 - 227s - loss: 2.8195 - accuracy50: 0.5323 - val_loss: 3.1724 - val_accuracy50: 0.4746 - 227s/epoch - 21ms/step
Epoch 39/50
10622/10622 - 228s - loss: 2.8178 - accuracy50: 0.5331 - val_loss: 3.1606 - val_accuracy50: 0.4766 - 228s/epoch - 21ms/step
Epoch 40/50
10622/10622 - 226s - loss: 2.8168 - accuracy50: 0.5333 - val_loss: 3.1671 - val_accuracy50: 0.4777 - 226s/epoch - 21ms/step
Epoch 41/50
10622/10622 - 230s - loss: 2.8157 - accuracy50: 0.5334 - val_loss: 3.1611 - val_accuracy50: 0.4768 - 230s/epoch - 22ms/step
Epoch 42/50
10622/10622 - 227s - loss: 2.8141 - accuracy50: 0.5338 - val_loss: 3.1658 - val_accuracy50: 0.4765 - 227s/epoch - 21ms/step
Epoch 43/50
10622/10622 - 228s - loss: 2.8131 - accuracy50: 0.5339 - val_loss: 3.1618 - val_accuracy50: 0.4776 - 228s/epoch - 21ms/step
Epoch 44/50
10622/10622 - 227s - loss: 2.8121 - accuracy50: 0.5342 - val_loss: 3.1709 - val_accuracy50: 0.4773 - 227s/epoch - 21ms/step
Epoch 45/50
10622/10622 - 226s - loss: 2.8105 - accuracy50: 0.5349 - val_loss: 3.1597 - val_accuracy50: 0.4786 - 226s/epoch - 21ms/step
Epoch 46/50
10622/10622 - 227s - loss: 2.8096 - accuracy50: 0.5347 - val_loss: 3.1687 - val_accuracy50: 0.4771 - 227s/epoch - 21ms/step
Epoch 47/50
10622/10622 - 227s - loss: 2.8081 - accuracy50: 0.5352 - val_loss: 3.1758 - val_accuracy50: 0.4769 - 227s/epoch - 21ms/step
Epoch 48/50
10622/10622 - 226s - loss: 2.8070 - accuracy50: 0.5355 - val_loss: 3.1712 - val_accuracy50: 0.4781 - 226s/epoch - 21ms/step
Epoch 49/50
10622/10622 - 226s - loss: 2.8057 - accuracy50: 0.5355 - val_loss: 3.1811 - val_accuracy50: 0.4750 - 226s/epoch - 21ms/step
Epoch 50/50
10622/10622 - 227s - loss: 2.8048 - accuracy50: 0.5361 - val_loss: 3.1723 - val_accuracy50: 0.4770 - 227s/epoch - 21ms/step
testing model in sample: results/universal/W1/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 265s - 265s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.065445
{'0': {'precision': 0.4534170282454513, 'recall': 0.5437212973344077, 'f1-score': 0.49448003051685774, 'support': 3163687}, '1': {'precision': 0.47596335732144646, 'recall': 0.5068542437021054, 'f1-score': 0.49092333562979323, 'support': 2715471}, '2': {'precision': 0.4813674184240918, 'recall': 0.35883246548330944, 'f1-score': 0.4111646784647482, 'support': 3167598}, 'accuracy': 0.46791899770481266, 'macro avg': {'precision': 0.4702492679969965, 'recall': 0.4698026688399409, 'f1-score': 0.4655226815371331, 'support': 9046756}, 'weighted avg': {'precision': 0.46997097341556565, 'recall': 0.46791899770481266, 'f1-score': 0.4642407221558021, 'support': 9046756}}
[[1720164  743602  699921]
 [ 814414 1376348  524709]
 [1259201  771760 1136637]]
Evaluating performance on  train set...
10622/10622 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0395007
{'0': {'precision': 0.4676072245539898, 'recall': 0.4050509669361823, 'f1-score': 0.43408693185703323, 'support': 846333}, '1': {'precision': 0.49753897128364916, 'recall': 0.6902029922473946, 'f1-score': 0.5782449341416903, 'support': 1022108}, '2': {'precision': 0.480346151609612, 'recall': 0.3206735915865752, 'f1-score': 0.3845955781984203, 'support': 850070}, 'accuracy': 0.48587811489451393, 'macro avg': {'precision': 0.481830782482417, 'recall': 0.47197585025671734, 'f1-score': 0.4656424813990479, 'support': 2718511}, 'weighted avg': {'precision': 0.48284441046514903, 'recall': 0.48587811489451393, 'f1-score': 0.4728117824809921, 'support': 2718511}}
[[342808 346371 157154]
 [178898 705462 137748]
 [211405 366070 272595]]
Evaluating performance on  val set...
3064/3064 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0481244
{'0': {'precision': 0.4630509874434871, 'recall': 0.42613119037251096, 'f1-score': 0.44382461413501717, 'support': 252610}, '1': {'precision': 0.49751611880350916, 'recall': 0.6242795079146594, 'f1-score': 0.5537356545682023, 'support': 278976}, '2': {'precision': 0.463055900621118, 'recall': 0.3695229787065308, 'f1-score': 0.4110356386732534, 'support': 252190}, 'accuracy': 0.47844537214714405, 'macro avg': {'precision': 0.4745410022893714, 'recall': 0.47331122566456707, 'f1-score': 0.46953196912549094, 'support': 783776}, 'weighted avg': {'precision': 0.47532003311541415, 'recall': 0.47844537214714405, 'f1-score': 0.47239590324591885, 'support': 783776}}
[[107645  87103  57862]
 [ 54619 174159  50198]
 [ 70205  88795  93190]]
testing model out of sample: results/universal/W1/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 179s - 179s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9923162
{'0': {'precision': 0.49211737076512335, 'recall': 0.3593265180370719, 'f1-score': 0.41536693991979845, 'support': 1824132}, '1': {'precision': 0.5182787826865788, 'recall': 0.8084660142905045, 'f1-score': 0.631637346812509, 'support': 2469332}, '2': {'precision': 0.5352124370445631, 'recall': 0.2713042592181345, 'f1-score': 0.3600803664191262, 'support': 1805707}, 'accuracy': 0.5151070530732783, 'macro avg': {'precision': 0.5152028634987551, 'recall': 0.479698930515237, 'f1-score': 0.46902821771714454, 'support': 6099171}, 'weighted avg': {'precision': 0.515467802236725, 'recall': 0.5151070530732783, 'f1-score': 0.48655892381679233, 'support': 6099171}}
[[ 655459  933815  234858]
 [ 282385 1996371  190576]
 [ 394072  921739  489896]]
Evaluating performance on  train set...
6711/6711 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96723986
{'0': {'precision': 0.49719960278053627, 'recall': 0.3748599927725324, 'f1-score': 0.42744840021309244, 'support': 500867}, '1': {'precision': 0.544379566023847, 'recall': 0.806381355035288, 'f1-score': 0.6499707316963662, 'support': 718092}, '2': {'precision': 0.5180286283747055, 'recall': 0.2868667409168899, 'f1-score': 0.36925342098635483, 'support': 498315}, 'accuracy': 0.5297704384972928, 'macro avg': {'precision': 0.5198692657263629, 'recall': 0.48936936290823674, 'f1-score': 0.48222418429860453, 'support': 1717274}, 'weighted avg': {'precision': 0.5229724090154609, 'recall': 0.5297704384972928, 'f1-score': 0.5036110131601907, 'support': 1717274}}
[[187755 239053  74059]
 [ 80095 579056  58941]
 [109775 245590 142950]]
Evaluating performance on  val set...
1720/1720 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94258124
{'0': {'precision': 0.4896240301926887, 'recall': 0.3662502380183626, 'f1-score': 0.41904500288905094, 'support': 120789}, '1': {'precision': 0.5810640793261542, 'recall': 0.816221181592164, 'f1-score': 0.6788546657919432, 'support': 200306}, '2': {'precision': 0.5082932127759512, 'recall': 0.2915978982114588, 'f1-score': 0.37059352325506734, 'support': 118756}, 'accuracy': 0.5510093190648652, 'macro avg': {'precision': 0.526327107431598, 'recall': 0.49135643927399514, 'f1-score': 0.4894977306453538, 'support': 439851}, 'weighted avg': {'precision': 0.5363059018460119, 'recall': 0.5510093190648652, 'f1-score': 0.5242795719181389, 'support': 439851}}
[[ 44239  59022  17528]
 [ 20841 163494  15971]
 [ 25273  58854  34629]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2816589
{'0': {'precision': 0.38111106388404814, 'recall': 0.7388631606704352, 'f1-score': 0.5028489389384898, 'support': 60677}, '1': {'precision': 0.4328315819369497, 'recall': 0.03145900421104781, 'f1-score': 0.05865486385066872, 'support': 48444}, '2': {'precision': 0.4079172419477817, 'recall': 0.32685512367491165, 'f1-score': 0.36291468434030927, 'support': 60562}, 'accuracy': 0.3898504859060719, 'macro avg': {'precision': 0.40728662925625986, 'recall': 0.36572576285213154, 'f1-score': 0.30813949570982263, 'support': 169683}, 'weighted avg': {'precision': 0.40544458304890607, 'recall': 0.3898504859060719, 'f1-score': 0.3260885321768848, 'support': 169683}}
[[44832  1066 14779]
 [32967  1524 13953]
 [39836   931 19795]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.287805
{'0': {'precision': 0.3623212051993256, 'recall': 0.6115012162100142, 'f1-score': 0.4550313337772996, 'support': 21789}, '1': {'precision': 0.4555628703094141, 'recall': 0.06308688121068466, 'f1-score': 0.11082639333760412, 'support': 21938}, '2': {'precision': 0.38897832353711953, 'recall': 0.4557817160905422, 'f1-score': 0.41973862282101515, 'support': 22796}, 'accuracy': 0.37728304496189285, 'macro avg': {'precision': 0.4022874663486198, 'recall': 0.3767899378370803, 'f1-score': 0.3285321166453063, 'support': 66523}, 'weighted avg': {'precision': 0.402205325260259, 'recall': 0.37728304496189285, 'f1-score': 0.3294251431015108, 'support': 66523}}
[[13324   781  7684]
 [11917  1384  8637]
 [11533   873 10390]]
Evaluating performance on  val set...
51/51 - 1s - 559ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.343939
{'0': {'precision': 0.35097235084005823, 'recall': 0.6484967000733317, 'f1-score': 0.4554506437768241, 'support': 4091}, '1': {'precision': 0.49527186761229314, 'recall': 0.08633834741397074, 'f1-score': 0.1470433409370065, 'support': 4853}, '2': {'precision': 0.34826654660063033, 'recall': 0.3963617729951319, 'f1-score': 0.37076093469143195, 'support': 3903}, 'accuracy': 0.35953919202926754, 'macro avg': {'precision': 0.3981702550176605, 'recall': 0.3770656068274781, 'f1-score': 0.3244183064684209, 'support': 12847}, 'weighted avg': {'precision': 0.40465996669972737, 'recall': 0.35953919202926754, 'f1-score': 0.3132194166232536, 'support': 12847}}
[[2653  208 1230]
 [2769  419 1665]
 [2137  219 1547]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7408843
{'0': {'precision': 0.5029901096373534, 'recall': 0.3564811041377999, 'f1-score': 0.4172483424228452, 'support': 73614}, '1': {'precision': 0.7426470148763097, 'recall': 0.8993229085618955, 'f1-score': 0.8135099966445974, 'support': 276329}, '2': {'precision': 0.5861081065279037, 'recall': 0.2821339112324449, 'f1-score': 0.3809098595027976, 'support': 71062}, 'accuracy': 0.7002292134297693, 'macro avg': {'precision': 0.6105817436805222, 'recall': 0.5126459746440468, 'f1-score': 0.5372227328567467, 'support': 421005}, 'weighted avg': {'precision': 0.6743198659652161, 'recall': 0.7002292134297693, 'f1-score': 0.6712032868443559, 'support': 421005}}
[[ 26242  43287   4085]
 [ 17747 248509  10073]
 [  8183  42830  20049]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8229166
{'0': {'precision': 0.5633464163219123, 'recall': 0.39744549219178765, 'f1-score': 0.46607281290681174, 'support': 40086}, '1': {'precision': 0.6551682856751949, 'recall': 0.8765258377092128, 'f1-score': 0.749851973281789, 'support': 87411}, '2': {'precision': 0.5707371041349745, 'recall': 0.31407118033535425, 'f1-score': 0.4051772098046274, 'support': 39421}, 'accuracy': 0.6286380138750763, 'macro avg': {'precision': 0.5964172687106939, 'recall': 0.5293475034121182, 'f1-score': 0.5403673319977427, 'support': 166918}, 'weighted avg': {'precision': 0.613176810445485, 'recall': 0.6286380138750763, 'f1-score': 0.6002995267282446, 'support': 166918}}
[[15932 19447  4707]
 [ 6188 76618  4605]
 [ 6161 20879 12381]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8122733
{'0': {'precision': 0.6466023092939618, 'recall': 0.3299526707234618, 'f1-score': 0.43694039396265033, 'support': 10353}, '1': {'precision': 0.6713432579935423, 'recall': 0.8987453140540127, 'f1-score': 0.7685765223507091, 'support': 26142}, '2': {'precision': 0.5422628951747088, 'recall': 0.3327207759060745, 'f1-score': 0.4124011388801012, 'support': 9795}, 'accuracy': 0.6517606394469648, 'macro avg': {'precision': 0.6200694874874043, 'recall': 0.5204729202278497, 'f1-score': 0.5393060183978202, 'support': 46290}, 'weighted avg': {'precision': 0.638496310581634, 'recall': 0.6517606394469648, 'f1-score': 0.6190373839126841, 'support': 46290}}
[[ 3416  5901  1036]
 [  932 23495  1715]
 [  935  5601  3259]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.169638
{'0': {'precision': 0.41224326819894686, 'recall': 0.5282656838368737, 'f1-score': 0.4630981374730608, 'support': 125081}, '1': {'precision': 0.31697923422052227, 'recall': 0.2816752325731826, 'f1-score': 0.2982862551686345, 'support': 85027}, '2': {'precision': 0.45256375785458924, 'recall': 0.3602479548481197, 'f1-score': 0.40116343221330175, 'support': 126152}, 'accuracy': 0.4028787247962886, 'macro avg': {'precision': 0.3939287534246862, 'recall': 0.3900629570860587, 'f1-score': 0.3875159416183323, 'support': 336260}, 'weighted avg': {'precision': 0.4032814392390798, 'recall': 0.4028787247962886, 'f1-score': 0.398188106976934, 'support': 336260}}
[[66076 27339 31666]
 [37770 23950 23307]
 [56438 24268 45446]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0703832
{'0': {'precision': 0.4470318683607582, 'recall': 0.47574924632026955, 'f1-score': 0.4609437082536887, 'support': 45112}, '1': {'precision': 0.47476586400405396, 'recall': 0.5732544700523489, 'f1-score': 0.5193823915900131, 'support': 44127}, '2': {'precision': 0.4562593577168699, 'recall': 0.3334598807476719, 'f1-score': 0.3853121048693005, 'support': 44779}, 'accuracy': 0.46031130146696714, 'macro avg': {'precision': 0.4593523633605607, 'recall': 0.4608211990400968, 'f1-score': 0.45521273490433406, 'support': 134018}, 'weighted avg': {'precision': 0.45924676316316565, 'recall': 0.46031130146696714, 'f1-score': 0.45491478834466503, 'support': 134018}}
[[21462 13840  9810]
 [10846 25296  7985]
 [15702 14145 14932]]
Evaluating performance on  val set...
107/107 - 1s - 970ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.135326
{'0': {'precision': 0.4288979977928425, 'recall': 0.5369054667456088, 'f1-score': 0.4768624014022787, 'support': 10134}, '1': {'precision': 0.3410493827160494, 'recall': 0.288595473012188, 'f1-score': 0.312637535366237, 'support': 6892}, '2': {'precision': 0.4454461396208969, 'recall': 0.37992902208201895, 'f1-score': 0.4100872526069377, 'support': 10144}, 'accuracy': 0.415311004784689, 'macro avg': {'precision': 0.40513117337659627, 'recall': 0.4018099872799386, 'f1-score': 0.3998623964584844, 'support': 27170}, 'weighted avg': {'precision': 0.4127924289888133, 'recall': 0.415311004784689, 'f1-score': 0.41027407287447815, 'support': 27170}}
[[5441 1936 2757]
 [2862 1989 2041]
 [4383 1907 3854]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3790418
{'0': {'precision': 0.35748906180408185, 'recall': 0.5935085948917809, 'f1-score': 0.44621104850603505, 'support': 114952}, '1': {'precision': 0.7431944109853047, 'recall': 0.02892422509328883, 'f1-score': 0.05568139772040177, 'support': 106658}, '2': {'precision': 0.34558166354331843, 'recall': 0.42760822645951874, 'f1-score': 0.3822439071057856, 'support': 112126}, 'accuracy': 0.3573363377040535, 'macro avg': {'precision': 0.4820883787775683, 'recall': 0.3500136821481961, 'f1-score': 0.29471211777740747, 'support': 333736}, 'weighted avg': {'precision': 0.4767552847934642, 'recall': 0.3573363377040535, 'f1-score': 0.2999113050257439, 'support': 333736}}
[[68225   453 46274]
 [59053  3085 44520]
 [63567   613 47946]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4164948
{'0': {'precision': 0.35910842514471963, 'recall': 0.6280692378492325, 'f1-score': 0.4569490646736078, 'support': 33681}, '1': {'precision': 0.7473684210526316, 'recall': 0.008900031338138515, 'f1-score': 0.017590585320532672, 'support': 31910}, '2': {'precision': 0.35522870783921145, 'recall': 0.42380719054327187, 'f1-score': 0.38649946936267665, 'support': 32654}, 'accuracy': 0.3590717084838923, 'macro avg': {'precision': 0.48723518467885424, 'recall': 0.3535921532435477, 'f1-score': 0.2870130397856057, 'support': 98245}, 'weighted avg': {'precision': 0.4839258528054393, 'recall': 0.3590717084838923, 'f1-score': 0.29082976942764344, 'support': 98245}}
[[21154    55 12472]
 [18979   284 12647]
 [18774    41 13839]]
Evaluating performance on  val set...
93/93 - 1s - 911ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3858341
{'0': {'precision': 0.3517694426785336, 'recall': 0.6169474727452924, 'f1-score': 0.44806334068109227, 'support': 8072}, '1': {'precision': 0.5638297872340425, 'recall': 0.007224645583424209, 'f1-score': 0.014266487213997307, 'support': 7336}, '2': {'precision': 0.35892227092911366, 'recall': 0.4095900439238653, 'f1-score': 0.3825859023306172, 'support': 8196}, 'accuracy': 0.35544822911370955, 'macro avg': {'precision': 0.4248405002805633, 'recall': 0.3445873874175273, 'f1-score': 0.28163857674190224, 'support': 23604}, 'weighted avg': {'precision': 0.42016036235320603, 'recall': 0.35544822911370955, 'f1-score': 0.29050585882398744, 'support': 23604}}
[[4980   14 3078]
 [4365   53 2918]
 [4812   27 3357]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1823224
{'0': {'precision': 0.40021703614486565, 'recall': 0.5745000449349726, 'f1-score': 0.47177731818189805, 'support': 233671}, '1': {'precision': 0.383597842835131, 'recall': 0.24476222311798884, 'f1-score': 0.2988422271971575, 'support': 203426}, '2': {'precision': 0.424804160749014, 'recall': 0.37289431388732025, 'f1-score': 0.3971602330848113, 'support': 230210}, 'accuracy': 0.4044300449418334, 'macro avg': {'precision': 0.40287301324300356, 'recall': 0.39738552731342724, 'f1-score': 0.3892599261546223, 'support': 667307}, 'weighted avg': {'precision': 0.40363289411862424, 'recall': 0.4044300449418334, 'f1-score': 0.39331703981098004, 'support': 667307}}
[[134244  40172  59255]
 [ 96655  49791  56980]
 [104529  39837  85844]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1600413
{'0': {'precision': 0.403676720909648, 'recall': 0.4804538087520259, 'f1-score': 0.43873163873163873, 'support': 61700}, '1': {'precision': 0.4309899615893612, 'recall': 0.44042219840026386, 'f1-score': 0.4356550323417375, 'support': 60635}, '2': {'precision': 0.432348524816363, 'recall': 0.341765045553702, 'f1-score': 0.38175693834769675, 'support': 62344}, 'accuracy': 0.42049177221015926, 'macro avg': {'precision': 0.4223384024384574, 'recall': 0.4208803509019973, 'f1-score': 0.418714536473691, 'support': 184679}, 'weighted avg': {'precision': 0.4223234175637053, 'recall': 0.42049177221015926, 'f1-score': 0.41848796863818927, 'support': 184679}}
[[29644 17455 14601]
 [20556 26705 13374]
 [23235 17802 21307]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1689285
{'0': {'precision': 0.4115602919031623, 'recall': 0.5224743885103671, 'f1-score': 0.46043196544276455, 'support': 20401}, '1': {'precision': 0.3905638349014491, 'recall': 0.32504572473708276, 'f1-score': 0.35480550269831856, 'support': 17496}, '2': {'precision': 0.4234147447158157, 'recall': 0.36971796140524493, 'f1-score': 0.39474865942890347, 'support': 20210}, 'accuracy': 0.4098989794689108, 'macro avg': {'precision': 0.40851295717347563, 'recall': 0.40574602488423156, 'f1-score': 0.4033287091899955, 'support': 58107}, 'weighted avg': {'precision': 0.40936132240967177, 'recall': 0.4098989794689108, 'f1-score': 0.40578278020317277, 'support': 58107}}
[[10659  4292  5450]
 [ 7084  5687  4725]
 [ 8156  4582  7472]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/EXC
Evaluating performance on  test set...
5343/5343 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8446813
{'0': {'precision': 0.6320653035346331, 'recall': 0.3454358553818878, 'f1-score': 0.4467268745250556, 'support': 346319}, '1': {'precision': 0.5890407136458501, 'recall': 0.909436641897252, 'f1-score': 0.7149860577835526, 'support': 673142}, '2': {'precision': 0.6815508040594408, 'recall': 0.2724281772952116, 'f1-score': 0.3892614971880038, 'support': 348323}, 'accuracy': 0.6044112228246565, 'macro avg': {'precision': 0.634218940413308, 'recall': 0.5091002248581171, 'f1-score': 0.5169914764988707, 'support': 1367784}, 'weighted avg': {'precision': 0.6234932479413431, 'recall': 0.6044112228246565, 'f1-score': 0.5641138380418224, 'support': 1367784}}
[[119631 205888  20800]
 [ 37424 612180  23538]
 [ 32215 221215  94893]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.74964774
{'0': {'precision': 0.6124872751951137, 'recall': 0.38439150434436936, 'f1-score': 0.47234410027825996, 'support': 70436}, '1': {'precision': 0.6680966165602924, 'recall': 0.919433630206389, 'f1-score': 0.7738693467336684, 'support': 187510}, '2': {'precision': 0.7039504315748003, 'recall': 0.27211308164084674, 'f1-score': 0.3925033948398435, 'support': 72231}, 'accuracy': 0.6636834182877669, 'macro avg': {'precision': 0.6615114411100688, 'recall': 0.5253127387305351, 'f1-score': 0.546238947283924, 'support': 330177}, 'weighted avg': {'precision': 0.664077128055385, 'recall': 0.6636834182877669, 'f1-score': 0.6261162436084476, 'support': 330177}}
[[ 27075  39808   3553]
 [ 10394 172403   4713]
 [  6736  45840  19655]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76582056
{'0': {'precision': 0.5876062978866717, 'recall': 0.3522612558045629, 'f1-score': 0.4404683013032914, 'support': 19812}, '1': {'precision': 0.666075682113469, 'recall': 0.9214911623726783, 'f1-score': 0.7732371794871795, 'support': 53408}, '2': {'precision': 0.6704336770730329, 'recall': 0.24184671830411741, 'f1-score': 0.3554656780137064, 'support': 19624}, 'accuracy': 0.6563698246521046, 'macro avg': {'precision': 0.6413718856910579, 'recall': 0.5051997121604529, 'f1-score': 0.5230570529347258, 'support': 92844}, 'weighted avg': {'precision': 0.6502522132063255, 'recall': 0.6563698246521046, 'f1-score': 0.6139251619147502, 'support': 92844}}
[[ 6979 11887   946]
 [ 2806 49215  1387]
 [ 2092 12786  4746]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/AAL
Evaluating performance on  test set...
7177/7177 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85792047
{'0': {'precision': 0.586147992154807, 'recall': 0.2978366748031514, 'f1-score': 0.39497601135254556, 'support': 435487}, '1': {'precision': 0.6133057248379615, 'recall': 0.9029116753185078, 'f1-score': 0.7304505270005858, 'support': 974937}, '2': {'precision': 0.5845923709798055, 'recall': 0.24730698917170582, 'f1-score': 0.34757516614373596, 'support': 426660}, 'accuracy': 0.6072133881738668, 'macro avg': {'precision': 0.5946820293241913, 'recall': 0.48268511309778833, 'f1-score': 0.4910005681656225, 'support': 1837084}, 'weighted avg': {'precision': 0.6001992587808244, 'recall': 0.6072133881738668, 'f1-score': 0.562002926423148, 'support': 1837084}}
[[129704 276641  29142]
 [ 48818 880282  45837]
 [ 42760 278384 105516]]
Evaluating performance on  train set...
2257/2257 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.826256
{'0': {'precision': 0.567126537237031, 'recall': 0.3373311450574422, 'f1-score': 0.42303680524511994, 'support': 134657}, '1': {'precision': 0.6372739584880022, 'recall': 0.9105131032088638, 'f1-score': 0.7497753455840023, 'support': 311107}, '2': {'precision': 0.5909099488495876, 'recall': 0.2375161216903118, 'f1-score': 0.3388368481148974, 'support': 131810}, 'accuracy': 0.6232932922880877, 'macro avg': {'precision': 0.598436814858207, 'recall': 0.4951201233188726, 'f1-score': 0.5038829996480065, 'support': 577574}, 'weighted avg': {'precision': 0.6103387408122906, 'recall': 0.6232932922880877, 'f1-score': 0.5798171497894969, 'support': 577574}}
[[ 45424  78257  10976]
 [ 17142 283267  10698]
 [ 17529  82974  31307]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79860044
{'0': {'precision': 0.5724024967904733, 'recall': 0.35847958080346004, 'f1-score': 0.44086058167683867, 'support': 36069}, '1': {'precision': 0.6657979085051964, 'recall': 0.8991321076448856, 'f1-score': 0.7650697099063403, 'support': 91486}, '2': {'precision': 0.5825479930191972, 'recall': 0.27993961757799396, 'f1-score': 0.37815792454967706, 'support': 35772}, 'accuracy': 0.6441188535882003, 'macro avg': {'precision': 0.6069161327716223, 'recall': 0.5125171020087799, 'f1-score': 0.5280294053776187, 'support': 163327}, 'weighted avg': {'precision': 0.6269390849065047, 'recall': 0.6441188535882003, 'f1-score': 0.6087299287808163, 'support': 163327}}
[[12930 20096  3043]
 [ 5095 82258  4133]
 [ 4564 21194 10014]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/WBA
Evaluating performance on  test set...
5696/5696 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0569663
{'0': {'precision': 0.5121310600732423, 'recall': 0.3861558323763267, 'f1-score': 0.44031010014866956, 'support': 546844}, '1': {'precision': 0.36814956476231037, 'recall': 0.710252065638569, 'f1-score': 0.4849380443521218, 'support': 372403}, '2': {'precision': 0.5429131103104534, 'recall': 0.3297461634977319, 'f1-score': 0.410294190666776, 'support': 538772}, 'accuracy': 0.4480908685003419, 'macro avg': {'precision': 0.47439791171533535, 'recall': 0.47538468717087584, 'f1-score': 0.4451807783891892, 'support': 1458019}, 'weighted avg': {'precision': 0.486730407524905, 'recall': 0.4480908685003419, 'f1-score': 0.4406172626217371, 'support': 1458019}}
[[211167 235312 100365]
 [ 58695 264500  49208]
 [142468 218646 177658]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9606088
{'0': {'precision': 0.564025976205259, 'recall': 0.36851020441725457, 'f1-score': 0.4457721471981751, 'support': 182421}, '1': {'precision': 0.4945525672935103, 'recall': 0.8333875407162171, 'f1-score': 0.6207417719001691, 'support': 205999}, '2': {'precision': 0.5587119730976773, 'recall': 0.317173331557509, 'f1-score': 0.4046386825914887, 'support': 180198}, 'accuracy': 0.5206571019559705, 'macro avg': {'precision': 0.5390968388654822, 'recall': 0.5063570255636601, 'f1-score': 0.49038420056327764, 'support': 568618}, 'weighted avg': {'precision': 0.5371731057467238, 'recall': 0.5206571019559705, 'f1-score': 0.49612475591578586, 'support': 568618}}
[[ 67224  86868  28329]
 [ 17509 171677  16813]
 [ 34453  88591  57154]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9910358
{'0': {'precision': 0.5297737359435838, 'recall': 0.3669678052092567, 'f1-score': 0.4335918349155413, 'support': 53021}, '1': {'precision': 0.5016294561482971, 'recall': 0.765694821509873, 'f1-score': 0.6061512174284494, 'support': 59303}, '2': {'precision': 0.5085250560139898, 'recall': 0.3612243313535965, 'f1-score': 0.4224012709940989, 'support': 51522}, 'accuracy': 0.5094784126557865, 'macro avg': {'precision': 0.5133094160352902, 'recall': 0.49796231935757546, 'f1-score': 0.4873814411126965, 'support': 163846}, 'weighted avg': {'precision': 0.5129053674021947, 'recall': 0.5094784126557865, 'f1-score': 0.49252967182826685, 'support': 163846}}
[[19457 23244 10320]
 [ 6228 45408  7667]
 [11042 21869 18611]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
12066/12066 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99573076
{'0': {'precision': 0.5649249121140716, 'recall': 0.289656794770206, 'f1-score': 0.3829577394662409, 'support': 969216}, '1': {'precision': 0.47154998530130515, 'recall': 0.8993803876982941, 'f1-score': 0.6187080204102191, 'support': 1157498}, '2': {'precision': 0.6078103730541089, 'recall': 0.24271844660194175, 'f1-score': 0.34690603343905285, 'support': 962123}, 'accuracy': 0.5035215519627614, 'macro avg': {'precision': 0.5480950901564953, 'recall': 0.47725187635681393, 'f1-score': 0.4495239311051709, 'support': 3088837}, 'weighted avg': {'precision': 0.5432921089911124, 'recall': 0.5035215519627614, 'f1-score': 0.4600722984844399, 'support': 3088837}}
[[ 280740  588519   99957]
 [  65742 1041031   50725]
 [ 150469  578129  233525]]
Evaluating performance on  train set...
2948/2948 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98113173
{'0': {'precision': 0.558894559045497, 'recall': 0.32725612245327407, 'f1-score': 0.4128003737335396, 'support': 237609}, '1': {'precision': 0.48403067101325736, 'recall': 0.8650659150507519, 'f1-score': 0.6207390036532884, 'support': 280285}, '2': {'precision': 0.5678240882355512, 'recall': 0.27461895462960617, 'f1-score': 0.37019774534410993, 'support': 236586}, 'accuracy': 0.5105436857173152, 'macro avg': {'precision': 0.5369164394314352, 'recall': 0.4889803307112108, 'f1-score': 0.46791237424364596, 'support': 754480}, 'weighted avg': {'precision': 0.5338831296316515, 'recall': 0.5105436857173152, 'f1-score': 0.47668926866371036, 'support': 754480}}
[[ 77759 128607  31243]
 [ 19613 242465  18207]
 [ 41758 129857  64971]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9427906
{'0': {'precision': 0.5705078035081258, 'recall': 0.2473749351219707, 'f1-score': 0.3451089605235675, 'support': 50094}, '1': {'precision': 0.535026250466797, 'recall': 0.9181819324193569, 'f1-score': 0.6760923071228973, 'support': 79579}, '2': {'precision': 0.5785181501740427, 'recall': 0.23875879902312885, 'f1-score': 0.3380158926158897, 'support': 48727}, 'accuracy': 0.5442488789237668, 'macro avg': {'precision': 0.5613507347163219, 'recall': 0.4681052221881521, 'f1-score': 0.4530723867541182, 'support': 178400}, 'weighted avg': {'precision': 0.5568684181522638, 'recall': 0.5442488789237668, 'f1-score': 0.49081355592205766, 'support': 178400}}
[[12392 32543  5159]
 [ 3194 73068  3317]
 [ 6135 30958 11634]]
testing model on single stock: results/universal/W1/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
21353/21353 - 159s - 159s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1288279
{'0': {'precision': 0.4390868030816988, 'recall': 0.6219241694597105, 'f1-score': 0.5147518779625953, 'support': 2081958}, '1': {'precision': 0.31190809778821943, 'recall': 0.19270532635967982, 'f1-score': 0.23822731977454858, 'support': 1286939}, '2': {'precision': 0.46262279985112176, 'recall': 0.379883327015732, 'f1-score': 0.4171902915752941, 'support': 2097315}, 'accuracy': 0.4280029753694149, 'macro avg': {'precision': 0.40453923357368, 'recall': 0.39817094094504074, 'f1-score': 0.3900564964374793, 'support': 5466212}, 'weighted avg': {'precision': 0.4181749107607967, 'recall': 0.4280029753694149, 'f1-score': 0.41221512729433557, 'support': 5466212}}
[[1294820  259084  528054]
 [ 641515  248000  397424]
 [1012558  288022  796735]]
Evaluating performance on  train set...
6073/6073 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1292301
{'0': {'precision': 0.43776208983329945, 'recall': 0.40615228906946005, 'f1-score': 0.4213651984098071, 'support': 519709}, '1': {'precision': 0.4093281091779435, 'recall': 0.5587871457239465, 'f1-score': 0.4725207760832206, 'support': 509278}, '2': {'precision': 0.45044400075303803, 'recall': 0.32323247698671526, 'f1-score': 0.376379880470364, 'support': 525566}, 'accuracy': 0.4281224249028499, 'macro avg': {'precision': 0.43251139992142695, 'recall': 0.4293906372600406, 'f1-score': 0.4234219516544639, 'support': 1554553}, 'weighted avg': {'precision': 0.43273452267685314, 'recall': 0.4281224249028499, 'f1-score': 0.4229152624334842, 'support': 1554553}}
[[211081 200378 108250]
 [125691 284578  99009]
 [145410 210276 169880]]
Evaluating performance on  val set...
1786/1786 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1322433
{'0': {'precision': 0.44307234404422036, 'recall': 0.4520737270067926, 'f1-score': 0.4475277776073526, 'support': 161352}, '1': {'precision': 0.37110728369365, 'recall': 0.4202670442136655, 'f1-score': 0.3941602746111794, 'support': 132787}, '2': {'precision': 0.444596828076098, 'recall': 0.38769602521879387, 'f1-score': 0.4142013772859211, 'support': 163053}, 'accuracy': 0.4198761133178183, 'macro avg': {'precision': 0.4195921519379895, 'recall': 0.4200122654797506, 'f1-score': 0.41862980983481773, 'support': 457192}, 'weighted avg': {'precision': 0.42271447957169794, 'recall': 0.4198761133178183, 'f1-score': 0.4201421711838736, 'support': 457192}}
[[72943 46089 42320]
 [40331 55806 36650]
 [51356 48482 63215]]
training model: results/universal/W1/deepOF_L2/h100
Epoch 1/50
10622/10622 - 231s - loss: 3.1484 - accuracy100: 0.4378 - val_loss: 3.3499 - val_accuracy100: 0.3861 - 231s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 226s - loss: 3.1033 - accuracy100: 0.4542 - val_loss: 3.3134 - val_accuracy100: 0.3935 - 226s/epoch - 21ms/step
Epoch 3/50
10622/10622 - 227s - loss: 3.0898 - accuracy100: 0.4594 - val_loss: 3.2902 - val_accuracy100: 0.3996 - 227s/epoch - 21ms/step
Epoch 4/50
10622/10622 - 226s - loss: 3.0829 - accuracy100: 0.4616 - val_loss: 3.2971 - val_accuracy100: 0.4000 - 226s/epoch - 21ms/step
Epoch 5/50
10622/10622 - 227s - loss: 3.0779 - accuracy100: 0.4633 - val_loss: 3.2906 - val_accuracy100: 0.3995 - 227s/epoch - 21ms/step
Epoch 6/50
10622/10622 - 227s - loss: 3.0741 - accuracy100: 0.4647 - val_loss: 3.2955 - val_accuracy100: 0.3995 - 227s/epoch - 21ms/step
Epoch 7/50
10622/10622 - 227s - loss: 3.0705 - accuracy100: 0.4658 - val_loss: 3.2947 - val_accuracy100: 0.4017 - 227s/epoch - 21ms/step
Epoch 8/50
10622/10622 - 228s - loss: 3.0678 - accuracy100: 0.4667 - val_loss: 3.2998 - val_accuracy100: 0.4009 - 228s/epoch - 21ms/step
Epoch 9/50
10622/10622 - 230s - loss: 3.0653 - accuracy100: 0.4677 - val_loss: 3.2999 - val_accuracy100: 0.4023 - 230s/epoch - 22ms/step
Epoch 10/50
10622/10622 - 228s - loss: 3.0632 - accuracy100: 0.4684 - val_loss: 3.2989 - val_accuracy100: 0.4029 - 228s/epoch - 21ms/step
Epoch 11/50
10622/10622 - 227s - loss: 3.0608 - accuracy100: 0.4692 - val_loss: 3.3005 - val_accuracy100: 0.4068 - 227s/epoch - 21ms/step
Epoch 12/50
10622/10622 - 230s - loss: 3.0588 - accuracy100: 0.4698 - val_loss: 3.3084 - val_accuracy100: 0.4055 - 230s/epoch - 22ms/step
Epoch 13/50
10622/10622 - 228s - loss: 3.0568 - accuracy100: 0.4704 - val_loss: 3.3153 - val_accuracy100: 0.4042 - 228s/epoch - 22ms/step
testing model in sample: results/universal/W1/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 265s - 265s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032016
{'0': {'precision': 0.4166514744633054, 'recall': 0.434710831707855, 'f1-score': 0.4254896127849807, 'support': 3196495}, '1': {'precision': 0.34279576260191336, 'recall': 0.4874018783820081, 'f1-score': 0.4025048743707556, 'support': 2650792}, '2': {'precision': 0.43760980202305966, 'recall': 0.2657144044839941, 'f1-score': 0.3306561237765379, 'support': 3199469}, 'accuracy': 0.3903826962946718, 'macro avg': {'precision': 0.39901901302942616, 'recall': 0.3959423715246191, 'f1-score': 0.3862168703107581, 'support': 9046756}, 'weighted avg': {'precision': 0.40242310234437084, 'recall': 0.3903826962946718, 'f1-score': 0.3852161082320919, 'support': 9046756}}
[[1389551 1191213  615731]
 [ 881966 1292001  476825]
 [1063527 1285797  850145]]
Evaluating performance on  train set...
10622/10622 - 85s - 85s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104363
{'0': {'precision': 0.4064896423035045, 'recall': 0.3322134094612246, 'f1-score': 0.36561730632549333, 'support': 891132}, '1': {'precision': 0.3822164609400791, 'recall': 0.6577433550356074, 'f1-score': 0.48348086821547215, 'support': 936461}, '2': {'precision': 0.43049423271928344, 'recall': 0.18298317016829832, 'f1-score': 0.25680880525139294, 'support': 890918}, 'accuracy': 0.3954444179184855, 'macro avg': {'precision': 0.4064001119876224, 'recall': 0.3909799782217101, 'f1-score': 0.3686356599307861, 'support': 2718511}, 'weighted avg': {'precision': 0.4059949722401022, 'recall': 0.3954444179184855, 'f1-score': 0.37055941502805734, 'support': 2718511}}
[[296046 483204 111882]
 [216727 615951 103783]
 [215526 512369 163023]]
Evaluating performance on  val set...
3064/3064 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943371
{'0': {'precision': 0.40578478633875315, 'recall': 0.382192466043326, 'f1-score': 0.393635444944221, 'support': 259890}, '1': {'precision': 0.3865581481589913, 'recall': 0.6006011925294437, 'f1-score': 0.4703744880828508, 'support': 263809}, '2': {'precision': 0.43384038664105584, 'recall': 0.21537467749935596, 'f1-score': 0.2878498621492386, 'support': 260077}, 'accuracy': 0.40035163107826727, 'macro avg': {'precision': 0.4087277737129334, 'recall': 0.3993894453573752, 'f1-score': 0.3839532650587702, 'support': 783776}, 'weighted avg': {'precision': 0.4086229137734503, 'recall': 0.40035163107826727, 'f1-score': 0.3843624552313287, 'support': 783776}}
[[ 99328 123010  37552]
 [ 69819 158444  35546]
 [ 75633 128430  56014]]
testing model out of sample: results/universal/W1/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 186s - 186s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0867403
{'0': {'precision': 0.4445809099886158, 'recall': 0.28210024347580615, 'f1-score': 0.34517582396231583, 'support': 1983770}, '1': {'precision': 0.3983575959044294, 'recall': 0.7850480634865462, 'f1-score': 0.528525204790504, 'support': 2128955}, '2': {'precision': 0.48147091343581694, 'recall': 0.15629772971427364, 'f1-score': 0.23598780373329195, 'support': 1986446}, 'accuracy': 0.41668466091539325, 'macro avg': {'precision': 0.441469806442954, 'recall': 0.40781534555887533, 'f1-score': 0.36989627749537063, 'support': 6099171}, 'weighted avg': {'precision': 0.4404611114375635, 'recall': 0.41668466091539325, 'f1-score': 0.37361353705958955, 'support': 6099171}}
[[ 559622 1234465  189683]
 [ 312932 1671332  144691]
 [ 386209 1289760  310477]]
Evaluating performance on  train set...
6711/6711 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0692358
{'0': {'precision': 0.455360925693667, 'recall': 0.2918978612886226, 'f1-score': 0.3557505984269919, 'support': 555989}, '1': {'precision': 0.4109965504655875, 'recall': 0.7801358918789052, 'f1-score': 0.5383669339498903, 'support': 607689}, '2': {'precision': 0.46837237561601297, 'recall': 0.17545647006119985, 'f1-score': 0.2552820186654542, 'support': 553596}, 'accuracy': 0.4271327697269044, 'macro avg': {'precision': 0.4449099505917558, 'recall': 0.4158300744095758, 'f1-score': 0.3831331836807788, 'support': 1717274}, 'weighted avg': {'precision': 0.4438562641272743, 'recall': 0.4271327697269044, 'f1-score': 0.38798478728439406, 'support': 1717274}}
[[162292 330215  63482]
 [ 86841 474080  46768]
 [107270 349194  97132]]
Evaluating performance on  val set...
1720/1720 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0485622
{'0': {'precision': 0.4517011228374536, 'recall': 0.2739694996748288, 'f1-score': 0.34107025084714926, 'support': 136851}, '1': {'precision': 0.4400517129928895, 'recall': 0.8070897181303536, 'f1-score': 0.5695604430081889, 'support': 168695}, '2': {'precision': 0.4749088456593673, 'recall': 0.1677748408473251, 'f1-score': 0.24795325498481446, 'support': 134305}, 'accuracy': 0.4460101261563575, 'macro avg': {'precision': 0.45555389382990347, 'recall': 0.4162780195508358, 'f1-score': 0.3861946496133842, 'support': 439851}, 'weighted avg': {'precision': 0.45431954593952306, 'recall': 0.4460101261563575, 'f1-score': 0.4002700135788827, 'support': 439851}}
[[ 37493  85250  14108]
 [ 21737 136152  10806]
 [ 23774  87998  22533]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1392615
{'0': {'precision': 0.34345529988683515, 'recall': 0.5540601005852559, 'f1-score': 0.4240481620744211, 'support': 55873}, '1': {'precision': 0.39255315014186326, 'recall': 0.16851589221656796, 'f1-score': 0.23580500560328724, 'support': 59935}, '2': {'precision': 0.3456893348197696, 'recall': 0.3453364269141531, 'f1-score': 0.34551279075165975, 'support': 53875}, 'accuracy': 0.35160858777838677, 'macro avg': {'precision': 0.3605659282828227, 'recall': 0.35597080657199226, 'f1-score': 0.3351219861431227, 'support': 169683}, 'weighted avg': {'precision': 0.3615068329634955, 'recall': 0.35160858777838677, 'f1-score': 0.33262211047755413, 'support': 169683}}
[[30957  8668 16248]
 [30868 10100 18967]
 [28309  6961 18605]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1350738
{'0': {'precision': 0.34583846454209594, 'recall': 0.5261618608051912, 'f1-score': 0.4173553719008264, 'support': 21883}, '1': {'precision': 0.3639394228021716, 'recall': 0.1753234835275764, 'f1-score': 0.2366457126931533, 'support': 21794}, '2': {'precision': 0.3637763406801285, 'recall': 0.36194519828416355, 'f1-score': 0.3628584593106172, 'support': 22846}, 'accuracy': 0.3548246471145318, 'macro avg': {'precision': 0.3578514093414653, 'recall': 0.35447684753897707, 'f1-score': 0.3389531813015323, 'support': 66523}, 'weighted avg': {'precision': 0.3579290347594581, 'recall': 0.3548246471145318, 'f1-score': 0.33943611423343395, 'support': 66523}}
[[11514  3239  7130]
 [10641  3821  7332]
 [11138  3439  8269]]
Evaluating performance on  val set...
51/51 - 1s - 558ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1832112
{'0': {'precision': 0.2759621258399511, 'recall': 0.5245283018867924, 'f1-score': 0.36165315721004704, 'support': 3445}, '1': {'precision': 0.4886731391585761, 'recall': 0.19693511574828823, 'f1-score': 0.28073437136881246, 'support': 6134}, '2': {'precision': 0.28534099817089104, 'recall': 0.33414932680538556, 'f1-score': 0.30782241014799155, 'support': 3268}, 'accuracy': 0.3196855296956488, 'macro avg': {'precision': 0.34999208772313944, 'recall': 0.3518709148134887, 'f1-score': 0.31673664624228365, 'support': 12847}, 'weighted avg': {'precision': 0.3799100911605674, 'recall': 0.3196855296956488, 'f1-score': 0.30932384190305473, 'support': 12847}}
[[1807  671  967]
 [3158 1208 1768]
 [1583  593 1092]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
1645/1645 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.92816406
{'0': {'precision': 0.5384244760298723, 'recall': 0.21196085125753955, 'f1-score': 0.3041768172353253, 'support': 105444}, '1': {'precision': 0.5656234197086984, 'recall': 0.9415075665075665, 'f1-score': 0.7066920318406994, 'support': 216216}, '2': {'precision': 0.6969836165977645, 'recall': 0.1374603653933263, 'f1-score': 0.22963224537153812, 'support': 99345}, 'accuracy': 0.5690549993468011, 'macro avg': {'precision': 0.6003438374454452, 'recall': 0.43030959438614413, 'f1-score': 0.4135003648158542, 'support': 421005}, 'weighted avg': {'precision': 0.5898084373276676, 'recall': 0.5690549993468011, 'f1-score': 0.493306635525625, 'support': 421005}}
[[ 22350  79164   3930]
 [ 10640 203569   2007]
 [  8520  77169  13656]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0004811
{'0': {'precision': 0.5559463282235559, 'recall': 0.28283319395554174, 'f1-score': 0.37492588104875096, 'support': 51419}, '1': {'precision': 0.46091696756533335, 'recall': 0.9155293935403919, 'f1-score': 0.6131485304644625, 'support': 64555}, '2': {'precision': 0.5835461219278647, 'recall': 0.14354978015075376, 'f1-score': 0.23041779570231266, 'support': 50944}, 'accuracy': 0.48501659497477806, 'macro avg': {'precision': 0.5334698059055847, 'recall': 0.4473041225488958, 'f1-score': 0.406164069071842, 'support': 166918}, 'weighted avg': {'precision': 0.5276175890413272, 'recall': 0.48501659497477806, 'f1-score': 0.42295331507709005, 'support': 166918}}
[[14543 32866  4010]
 [ 4244 59102  1209]
 [ 7372 36259  7313]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9869776
{'0': {'precision': 0.6495037220843672, 'recall': 0.22157167042889392, 'f1-score': 0.33042289080580683, 'support': 14176}, '1': {'precision': 0.4741424663299663, 'recall': 0.9477364740522636, 'f1-score': 0.6320680284036119, 'support': 19019}, '2': {'precision': 0.6297265852239674, 'recall': 0.16533027873234057, 'f1-score': 0.26190044154116005, 'support': 13095}, 'accuracy': 0.5040181464679196, 'macro avg': {'precision': 0.5844575912127671, 'recall': 0.4448794744044993, 'f1-score': 0.40813045358352623, 'support': 46290}, 'weighted avg': {'precision': 0.5718589320567179, 'recall': 0.5040181464679196, 'f1-score': 0.4349743576204991, 'support': 46290}}
[[ 3141 10134   901]
 [  622 18025   372]
 [ 1073  9857  2165]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1418722
{'0': {'precision': 0.39046457766650555, 'recall': 0.4402127936487278, 'f1-score': 0.41384900682509035, 'support': 122936}, '1': {'precision': 0.27308186732879003, 'recall': 0.3333404984791978, 'f1-score': 0.30021731028908555, 'support': 93043}, '2': {'precision': 0.40951633427283646, 'recall': 0.28628794240154304, 'f1-score': 0.33699013544194784, 'support': 120281}, 'accuracy': 0.3555819901266877, 'macro avg': {'precision': 0.3576875930893773, 'recall': 0.35328041150982287, 'f1-score': 0.35035215085204124, 'support': 336260}, 'weighted avg': {'precision': 0.36479968983689165, 'recall': 0.3555819901266877, 'f1-score': 0.3549145636869376, 'support': 336260}}
[[54118 42244 26574]
 [38950 31015 23078]
 [45531 40315 34435]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1314404
{'0': {'precision': 0.38465381383836317, 'recall': 0.37660634087776246, 'f1-score': 0.3805875414256024, 'support': 44978}, '1': {'precision': 0.3689499372893906, 'recall': 0.5443924191750279, 'f1-score': 0.43982094445495235, 'support': 44850}, '2': {'precision': 0.39501764409342965, 'recall': 0.212785698121747, 'f1-score': 0.27658322793187634, 'support': 44190}, 'accuracy': 0.37874016923099885, 'macro avg': {'precision': 0.38287379840706115, 'recall': 0.37792815272484576, 'f1-score': 0.36566390460414366, 'support': 134018}, 'weighted avg': {'precision': 0.38281569355414735, 'recall': 0.37874016923099885, 'f1-score': 0.3661168547460414, 'support': 134018}}
[[16939 20690  7349]
 [13382 24416  7052]
 [13716 21071  9403]]
Evaluating performance on  val set...
107/107 - 1s - 979ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1247703
{'0': {'precision': 0.402779081776359, 'recall': 0.4272057359091814, 'f1-score': 0.4146329676702266, 'support': 10042}, '1': {'precision': 0.2884062599808368, 'recall': 0.36847116430903154, 'f1-score': 0.3235592714243058, 'support': 7352}, '2': {'precision': 0.40836373842267754, 'recall': 0.29766775777414073, 'f1-score': 0.34433794817181396, 'support': 9776}, 'accuracy': 0.3647037173352963, 'macro avg': {'precision': 0.36651636005995775, 'recall': 0.36444821933078453, 'f1-score': 0.3608433957554487, 'support': 27170}, 'weighted avg': {'precision': 0.3738400540816123, 'recall': 0.3647037173352963, 'f1-score': 0.3646963491418316, 'support': 27170}}
[[4290 3302 2450]
 [2877 2709 1766]
 [3484 3382 2910]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1456261
{'0': {'precision': 0.3450131138363932, 'recall': 0.587754309126872, 'f1-score': 0.43479851326369967, 'support': 113248}, '1': {'precision': 0.4558909796489328, 'recall': 0.09410570241621491, 'f1-score': 0.15600799882642702, 'support': 107358}, '2': {'precision': 0.34081197481647546, 'recall': 0.3574383452665076, 'f1-score': 0.34892721083445866, 'support': 113130}, 'accuracy': 0.35088213438166693, 'macro avg': {'precision': 0.38057202276726715, 'recall': 0.3464327856031981, 'f1-score': 0.31324457430819513, 'support': 333736}, 'weighted avg': {'precision': 0.37925680064446704, 'recall': 0.35088213438166693, 'f1-score': 0.31600697596242927, 'support': 333736}}
[[66562  6660 40026]
 [59069 10103 38186]
 [67295  5398 40437]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1661309
{'0': {'precision': 0.33882859878710503, 'recall': 0.6413230629814227, 'f1-score': 0.44339790111209737, 'support': 33105}, '1': {'precision': 0.36516968095915464, 'recall': 0.0558994618471397, 'f1-score': 0.09695694399482033, 'support': 32147}, '2': {'precision': 0.34212757631098356, 'recall': 0.3179765404782833, 'f1-score': 0.3296102549601772, 'support': 32993}, 'accuracy': 0.34117766807471117, 'macro avg': {'precision': 0.34870861868574776, 'recall': 0.33839968843561524, 'f1-score': 0.28998836668903166, 'support': 98245}, 'weighted avg': {'precision': 0.34855560712371453, 'recall': 0.34117766807471117, 'f1-score': 0.2918254724089633, 'support': 98245}}
[[21231  1561 10313]
 [20490  1797  9860]
 [20939  1563 10491]]
Evaluating performance on  val set...
93/93 - 1s - 897ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1672717
{'0': {'precision': 0.33200556398583714, 'recall': 0.6706257982120051, 'f1-score': 0.44413431447179225, 'support': 7830}, '1': {'precision': 0.358974358974359, 'recall': 0.0483207221558476, 'f1-score': 0.08517608517608517, 'support': 7533}, '2': {'precision': 0.3671390611160319, 'recall': 0.30178376410629776, 'f1-score': 0.3312687312687313, 'support': 8241}, 'accuracy': 0.3432469073038468, 'macro avg': {'precision': 0.3527063280254093, 'recall': 0.34024342815805014, 'f1-score': 0.2868597103055362, 'support': 23604}, 'weighted avg': {'precision': 0.35287876693866166, 'recall': 0.3432469073038468, 'f1-score': 0.29017068066137935, 'support': 23604}}
[[5251  320 2259]
 [5141  364 2028]
 [5424  330 2487]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
2607/2607 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1478857
{'0': {'precision': 0.3689037155549504, 'recall': 0.47099395888565343, 'f1-score': 0.41374426129367864, 'support': 230090}, '1': {'precision': 0.31776199979183917, 'recall': 0.3359985453779864, 'f1-score': 0.3266259198273376, 'support': 208989}, '2': {'precision': 0.38675528811803955, 'recall': 0.2585265611581401, 'f1-score': 0.30990028546142595, 'support': 228228}, 'accuracy': 0.3560490149211682, 'macro avg': {'precision': 0.357807001154943, 'recall': 0.35517302180726, 'f1-score': 0.3500901555274807, 'support': 667307}, 'weighted avg': {'precision': 0.35899249428394897, 'recall': 0.3560490149211682, 'f1-score': 0.3509442637199195, 'support': 667307}}
[[108371  74495  47224]
 [ 92437  70220  46332]
 [ 92957  76268  59003]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1604024
{'0': {'precision': 0.35951397712833544, 'recall': 0.36758854767202037, 'f1-score': 0.3635064278086031, 'support': 61577}, '1': {'precision': 0.3345692526807679, 'recall': 0.4665102003971836, 'f1-score': 0.3896741291145141, 'support': 60929}, '2': {'precision': 0.3840650671889451, 'recall': 0.22709214610843936, 'f1-score': 0.28541972001819377, 'support': 62173}, 'accuracy': 0.35292588762122384, 'macro avg': {'precision': 0.3593827656660162, 'recall': 0.35373029805921447, 'f1-score': 0.3462000923137703, 'support': 184679}, 'weighted avg': {'precision': 0.3595494863441772, 'recall': 0.35292588762122384, 'f1-score': 0.3458513992965077, 'support': 184679}}
[[22635 27847 11095]
 [20957 28424 11548]
 [19368 28686 14119]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1574527
{'0': {'precision': 0.3773094420202395, 'recall': 0.4046599621627004, 'f1-score': 0.3905063899298549, 'support': 20086}, '1': {'precision': 0.31142014327855033, 'recall': 0.40678152694445974, 'f1-score': 0.3527698880588109, 'support': 18167}, '2': {'precision': 0.381145305804441, 'recall': 0.24639871058728718, 'f1-score': 0.299305576799535, 'support': 19854}, 'accuracy': 0.35124855869344485, 'macro avg': {'precision': 0.35662496370107694, 'recall': 0.3526133998981491, 'f1-score': 0.34752728492940027, 'support': 58107}, 'weighted avg': {'precision': 0.3580199648373058, 'recall': 0.35124855869344485, 'f1-score': 0.3475466781329866, 'support': 58107}}
[[8128 7946 4012]
 [6846 7390 3931]
 [6568 8394 4892]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/EXC
Evaluating performance on  test set...
5343/5343 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0733765
{'0': {'precision': 0.5690333341054924, 'recall': 0.2663296969223864, 'f1-score': 0.3628374007036782, 'support': 461169}, '1': {'precision': 0.3710597636955939, 'recall': 0.8981649197788406, 'f1-score': 0.5251597565538862, 'support': 442215}, '2': {'precision': 0.6745768947755703, 'recall': 0.11844315245478036, 'f1-score': 0.20150565996263328, 'support': 464400}, 'accuracy': 0.4203953255777228, 'macro avg': {'precision': 0.5382233308588855, 'recall': 0.42764592305200244, 'f1-score': 0.3631676057400659, 'support': 1367784}, 'weighted avg': {'precision': 0.5408618882751354, 'recall': 0.4203953255777228, 'f1-score': 0.3605409271319435, 'support': 1367784}}
[[122823 317978  20368]
 [ 38866 397182   6167]
 [ 54156 355239  55005]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99697095
{'0': {'precision': 0.6046901964492565, 'recall': 0.2623810109962252, 'f1-score': 0.3659658485288542, 'support': 97488}, '1': {'precision': 0.45817714429644557, 'recall': 0.9280349921597755, 'f1-score': 0.6134766985981714, 'support': 133287}, '2': {'precision': 0.7313449508489723, 'recall': 0.13172773183638156, 'f1-score': 0.22324518779943056, 'support': 99402}, 'accuracy': 0.49176047998497774, 'macro avg': {'precision': 0.5980707638648916, 'recall': 0.44071457833079414, 'f1-score': 0.40089591164215205, 'support': 330177}, 'weighted avg': {'precision': 0.583675561009928, 'recall': 0.49176047998497774, 'f1-score': 0.4229148775507513, 'support': 330177}}
[[ 25579  68344   3565]
 [  8347 123695   1245]
 [  8375  77933  13094]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98857677
{'0': {'precision': 0.5874536198118906, 'recall': 0.25213880967371577, 'f1-score': 0.35283752267426793, 'support': 27001}, '1': {'precision': 0.47869971217587226, 'recall': 0.9334383015465881, 'f1-score': 0.6328512396694215, 'support': 39377}, '2': {'precision': 0.7108676207513417, 'recall': 0.12011637572734829, 'f1-score': 0.20550778977309456, 'support': 26466}, 'accuracy': 0.5034574124337599, 'macro avg': {'precision': 0.5923403175797016, 'recall': 0.43523116231588405, 'f1-score': 0.3970655173722613, 'support': 92844}, 'weighted avg': {'precision': 0.5765091573574511, 'recall': 0.5034574124337599, 'f1-score': 0.429599310438213, 'support': 92844}}
[[ 6808 19291   902]
 [ 2230 36756   391]
 [ 2551 20736  3179]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/AAL
Evaluating performance on  test set...
7177/7177 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0452878
{'0': {'precision': 0.563729079728621, 'recall': 0.22101926140127257, 'f1-score': 0.3175412506196445, 'support': 578203}, '1': {'precision': 0.42587469941657907, 'recall': 0.9228438268724471, 'f1-score': 0.582798900907997, 'support': 694332}, '2': {'precision': 0.631246692371664, 'recall': 0.11831745340085625, 'f1-score': 0.19928248043976046, 'support': 564549}, 'accuracy': 0.45471518994232163, 'macro avg': {'precision': 0.5402834905056214, 'recall': 0.42072684722485865, 'f1-score': 0.36654087732246726, 'support': 1837084}, 'weighted avg': {'precision': 0.5323752021210628, 'recall': 0.45471518994232163, 'f1-score': 0.38145449813240334, 'support': 1837084}}
[[127794 422418  27991]
 [ 42543 640760  11029]
 [ 56357 441396  66796]]
Evaluating performance on  train set...
2257/2257 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0053228
{'0': {'precision': 0.5598078260319869, 'recall': 0.2527311955615932, 'f1-score': 0.3482439548080364, 'support': 175198}, '1': {'precision': 0.4616061100978638, 'recall': 0.9228124418116234, 'f1-score': 0.6153859481686935, 'support': 230931}, '2': {'precision': 0.6072466523616807, 'recall': 0.1304033363469334, 'f1-score': 0.21470071352431072, 'support': 171445}, 'accuracy': 0.4843379376495479, 'macro avg': {'precision': 0.5428868628305105, 'recall': 0.4353156579067167, 'f1-score': 0.3927768721670135, 'support': 577574}, 'weighted avg': {'precision': 0.5346254755759611, 'recall': 0.4843379376495479, 'f1-score': 0.41541464924179133, 'support': 577574}}
[[ 44278 119945  10975]
 [ 14340 213106   3485]
 [ 20477 128611  22357]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98347896
{'0': {'precision': 0.5683632265940464, 'recall': 0.2531950051245581, 'f1-score': 0.35032630558409417, 'support': 47809}, '1': {'precision': 0.4836597808047357, 'recall': 0.9227794720637376, 'f1-score': 0.6346684597705764, 'support': 68531}, '2': {'precision': 0.6201454158538748, 'recall': 0.1488496818268883, 'f1-score': 0.24007551703424013, 'support': 46987}, 'accuracy': 0.5041297519699743, 'macro avg': {'precision': 0.5573894744175524, 'recall': 0.4416080530050613, 'f1-score': 0.4083567607963035, 'support': 163327}, 'weighted avg': {'precision': 0.5477192294800622, 'recall': 0.5041297519699743, 'f1-score': 0.4379168348105039, 'support': 163327}}
[[12105 32654  3050]
 [ 4058 63239  1234]
 [ 5135 34858  6994]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/WBA
Evaluating performance on  test set...
5696/5696 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1172643
{'0': {'precision': 0.4542950176286025, 'recall': 0.3070087873974439, 'f1-score': 0.3664044802142711, 'support': 548968}, '1': {'precision': 0.2923244451747737, 'recall': 0.699234363408882, 'f1-score': 0.41228678634322763, 'support': 361268}, '2': {'precision': 0.48558225093658164, 'recall': 0.19757641255752734, 'f1-score': 0.280870621331105, 'support': 547783}, 'accuracy': 0.3630803165116504, 'macro avg': {'precision': 0.410733904579986, 'recall': 0.401273187787951, 'f1-score': 0.3531872959628679, 'support': 1458019}, 'weighted avg': {'precision': 0.42591666985254123, 'recall': 0.3630803165116504, 'f1-score': 0.345637820211897, 'support': 1458019}}
[[168538 305379  75051]
 [ 69052 252611  39605]
 [133398 306156 108229]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0756345
{'0': {'precision': 0.4766938797675724, 'recall': 0.27540407552852714, 'f1-score': 0.3491126025354213, 'support': 191239}, '1': {'precision': 0.39012279900542957, 'recall': 0.8183453524574895, 'f1-score': 0.5283634145712888, 'support': 187895}, '2': {'precision': 0.49228028503562943, 'recall': 0.1662515040847776, 'f1-score': 0.24856002146159795, 'support': 189484}, 'accuracy': 0.4184408513272531, 'macro avg': {'precision': 0.4530323212695438, 'recall': 0.4200003106902648, 'f1-score': 0.37534534618943605, 'support': 568618}, 'weighted avg': {'precision': 0.4532811513558965, 'recall': 0.4184408513272531, 'f1-score': 0.3748367724619572, 'support': 568618}}
[[ 52668 117766  20805]
 [ 22447 153763  11685]
 [ 35371 122611  31502]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.070832
{'0': {'precision': 0.47941903212197917, 'recall': 0.27837558833307086, 'f1-score': 0.35222882697395363, 'support': 57153}, '1': {'precision': 0.38311627206684984, 'recall': 0.7931309904153354, 'f1-score': 0.5166624365482233, 'support': 51332}, '2': {'precision': 0.4811823548704493, 'recall': 0.21200845360452303, 'f1-score': 0.29433375547001367, 'support': 55361}, 'accuracy': 0.4172210490338489, 'macro avg': {'precision': 0.44790588635309275, 'recall': 0.42783834411764315, 'f1-score': 0.38774167299739687, 'support': 163846}, 'weighted avg': {'precision': 0.44984373599957256, 'recall': 0.4172210490338489, 'f1-score': 0.38418308275765783, 'support': 163846}}
[[15910 33019  8224]
 [ 6188 40713  4431]
 [11088 32536 11737]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
12066/12066 - 90s - 90s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0892687
{'0': {'precision': 0.46793414901258845, 'recall': 0.23921606793837066, 'f1-score': 0.3165872384612218, 'support': 996668}, '1': {'precision': 0.394309534258493, 'recall': 0.8568991363493982, 'f1-score': 0.5400913649300044, 'support': 1072656}, '2': {'precision': 0.5296657617233129, 'recall': 0.12898119003877342, 'f1-score': 0.20744625049003024, 'support': 1019513}, 'accuracy': 0.41733344945039186, 'macro avg': {'precision': 0.46396981499813145, 'recall': 0.4083654647755141, 'f1-score': 0.3547082846270855, 'support': 3088837}, 'weighted avg': {'precision': 0.46274199963917695, 'recall': 0.41733344945039186, 'f1-score': 0.3581797168639426, 'support': 3088837}}
[[238419 686921  71328]
 [108058 919158  45440]
 [163037 724978 131498]]
Evaluating performance on  train set...
2948/2948 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0788566
{'0': {'precision': 0.4873160517426293, 'recall': 0.264680824083724, 'f1-score': 0.34304188836616883, 'support': 252353}, '1': {'precision': 0.38536025751817987, 'recall': 0.81960792182515, 'f1-score': 0.5242367810751739, 'support': 249185}, '2': {'precision': 0.49379539086178303, 'recall': 0.17069130472598462, 'f1-score': 0.2536892915796308, 'support': 252942}, 'accuracy': 0.4164484148022479, 'macro avg': {'precision': 0.4554905667075307, 'recall': 0.41832668354495284, 'f1-score': 0.37365598700699126, 'support': 754480}, 'weighted avg': {'precision': 0.45581494158948743, 'recall': 0.4164484148022479, 'f1-score': 0.37293005611523167, 'support': 754480}}
[[ 66793 158558  27002]
 [ 27693 204234  17258]
 [ 42577 167190  43175]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0513055
{'0': {'precision': 0.49608666814061464, 'recall': 0.20225711658764356, 'f1-score': 0.28735720506121615, 'support': 55469}, '1': {'precision': 0.4302003038708688, 'recall': 0.9009648085708865, 'f1-score': 0.5823399829239644, 'support': 68511}, '2': {'precision': 0.5413313825896123, 'recall': 0.12238147739801543, 'f1-score': 0.1996313115417472, 'support': 54420}, 'accuracy': 0.4462163677130045, 'macro avg': {'precision': 0.4892061182003653, 'recall': 0.4085344675188485, 'f1-score': 0.35644283317564257, 'support': 178400}, 'weighted avg': {'precision': 0.48458597676073745, 'recall': 0.4462163677130045, 'f1-score': 0.3738791891914025, 'support': 178400}}
[[11219 40791  3459]
 [ 4601 61726  2184]
 [ 6795 40965  6660]]
testing model on single stock: results/universal/W1/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
21353/21353 - 160s - 160s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1177803
{'0': {'precision': 0.4016973924663296, 'recall': 0.5133218747490682, 'f1-score': 0.4507010201219916, 'support': 1967666}, '1': {'precision': 0.2950733301423214, 'recall': 0.28118078274765623, 'f1-score': 0.28795959310824565, 'support': 1523735}, '2': {'precision': 0.4219341339883662, 'recall': 0.3204382596613043, 'f1-score': 0.3642480263099198, 'support': 1974811}, 'accuracy': 0.37892712540238105, 'macro avg': {'precision': 0.3729016188656724, 'recall': 0.3716469723860096, 'f1-score': 0.36763621318005235, 'support': 5466212}, 'weighted avg': {'precision': 0.37928642929047807, 'recall': 0.37892712540238105, 'f1-score': 0.3741026131348858, 'support': 5466212}}
[[1010046  481601  476019]
 [ 704342  428445  390948]
 [ 800057  541949  632805]]
Evaluating performance on  train set...
6073/6073 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1449668
{'0': {'precision': 0.3733955970647098, 'recall': 0.3512563697065542, 'f1-score': 0.3619877897350994, 'support': 517881}, '1': {'precision': 0.34053026766453237, 'recall': 0.5345262130792534, 'f1-score': 0.41602424167836705, 'support': 518577}, '2': {'precision': 0.3957509452430005, 'recall': 0.1935417249732192, 'f1-score': 0.25995341355258605, 'support': 518095}, 'accuracy': 0.3598301248011486, 'macro avg': {'precision': 0.3698922699907475, 'recall': 0.35977476925300894, 'f1-score': 0.34598848165535084, 'support': 1554553}, 'weighted avg': {'precision': 0.36988268382860634, 'recall': 0.3598301248011486, 'f1-score': 0.34600799426405704, 'support': 1554553}}
[[181909 262509  73463]
 [161746 277193  79638]
 [143520 274302 100273]]
Evaluating performance on  val set...
1786/1786 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1317186
{'0': {'precision': 0.3806447293542664, 'recall': 0.4438040720744162, 'f1-score': 0.40980514644049876, 'support': 153730}, '1': {'precision': 0.3324524790642031, 'recall': 0.4266588421541065, 'f1-score': 0.3737101155628872, 'support': 146548}, '2': {'precision': 0.40325326271987894, 'recall': 0.23098002727608755, 'f1-score': 0.2937198380829278, 'support': 156914}, 'accuracy': 0.3652644840679627, 'macro avg': {'precision': 0.3721168237127828, 'recall': 0.3671476471682034, 'f1-score': 0.35907836669543797, 'support': 457192}, 'weighted avg': {'precision': 0.3729567503629969, 'recall': 0.3652644840679627, 'f1-score': 0.35839334426401254, 'support': 457192}}
[[68226 60279 25225]
 [55612 62526 28410]
 [55400 65270 36244]]
training model: results/universal/W1/deepOF_L2/h200
Epoch 1/50
10622/10622 - 231s - loss: 3.2455 - accuracy200: 0.3939 - val_loss: 3.2873 - val_accuracy200: 0.3762 - 231s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 228s - loss: 3.2255 - accuracy200: 0.4052 - val_loss: 3.2825 - val_accuracy200: 0.3793 - 228s/epoch - 21ms/step
Epoch 3/50
10622/10622 - 228s - loss: 3.2172 - accuracy200: 0.4089 - val_loss: 3.2847 - val_accuracy200: 0.3805 - 228s/epoch - 21ms/step
Epoch 4/50
10622/10622 - 226s - loss: 3.2113 - accuracy200: 0.4118 - val_loss: 3.2915 - val_accuracy200: 0.3826 - 226s/epoch - 21ms/step
Epoch 5/50
10622/10622 - 226s - loss: 3.2076 - accuracy200: 0.4134 - val_loss: 3.2944 - val_accuracy200: 0.3827 - 226s/epoch - 21ms/step
Epoch 6/50
10622/10622 - 227s - loss: 3.2045 - accuracy200: 0.4145 - val_loss: 3.3010 - val_accuracy200: 0.3846 - 227s/epoch - 21ms/step
Epoch 7/50
10622/10622 - 228s - loss: 3.2019 - accuracy200: 0.4155 - val_loss: 3.3029 - val_accuracy200: 0.3847 - 228s/epoch - 21ms/step
Epoch 8/50
10622/10622 - 226s - loss: 3.1999 - accuracy200: 0.4167 - val_loss: 3.3066 - val_accuracy200: 0.3849 - 226s/epoch - 21ms/step
Epoch 9/50
10622/10622 - 227s - loss: 3.1973 - accuracy200: 0.4176 - val_loss: 3.3152 - val_accuracy200: 0.3831 - 227s/epoch - 21ms/step
Epoch 10/50
10622/10622 - 227s - loss: 3.1955 - accuracy200: 0.4183 - val_loss: 3.3193 - val_accuracy200: 0.3832 - 227s/epoch - 21ms/step
Epoch 11/50
10622/10622 - 227s - loss: 3.1935 - accuracy200: 0.4197 - val_loss: 3.3217 - val_accuracy200: 0.3847 - 227s/epoch - 21ms/step
Epoch 12/50
10622/10622 - 227s - loss: 3.1918 - accuracy200: 0.4203 - val_loss: 3.3216 - val_accuracy200: 0.3844 - 227s/epoch - 21ms/step
testing model in sample: results/universal/W1/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 262s - 262s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931162
{'0': {'precision': 0.3982110707855857, 'recall': 0.473765873783677, 'f1-score': 0.43271514705990294, 'support': 3235366}, '1': {'precision': 0.29555689659473355, 'recall': 0.21617431150635136, 'f1-score': 0.2497084704660011, 'support': 2575986}, '2': {'precision': 0.4088334844865494, 'recall': 0.4186911433626218, 'f1-score': 0.4137036006034065, 'support': 3235404}, 'accuracy': 0.3807224379656089, 'macro avg': {'precision': 0.3675338172889562, 'recall': 0.36954377621755014, 'f1-score': 0.3653757393764368, 'support': 9046756}, 'weighted avg': {'precision': 0.37278008582485017, 'recall': 0.3807224379656089, 'f1-score': 0.3738064431815234, 'support': 9046756}}
[[1532806  683671 1018889]
 [1079233  556862  939891]
 [1237191  643578 1354635]]
Evaluating performance on  train set...
10622/10622 - 86s - 86s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950372
{'0': {'precision': 0.38485304048769986, 'recall': 0.45834780636345807, 'f1-score': 0.4183974613843857, 'support': 912617}, '1': {'precision': 0.3367868906961743, 'recall': 0.20905906540253102, 'f1-score': 0.25797883751669537, 'support': 891571}, '2': {'precision': 0.3915518274415818, 'recall': 0.4617197642408645, 'f1-score': 0.4237507007538782, 'support': 914323}, 'accuracy': 0.3777244234067841, 'macro avg': {'precision': 0.3710639195418186, 'recall': 0.3763755453356179, 'f1-score': 0.3667089998849864, 'support': 2718511}, 'weighted avg': {'precision': 0.3713421404943778, 'recall': 0.3777244234067841, 'f1-score': 0.3675865568045227, 'support': 2718511}}
[[418296 186615 307706]
 [356873 186391 348307]
 [311729 180433 422161]]
Evaluating performance on  val set...
3064/3064 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0938002
{'0': {'precision': 0.39071855802116934, 'recall': 0.44808919920734946, 'f1-score': 0.41744193295880405, 'support': 268971}, '1': {'precision': 0.3243190896985837, 'recall': 0.21814836075251087, 'f1-score': 0.2608439555946073, 'support': 245631}, '2': {'precision': 0.3966029326875014, 'recall': 0.45689033859139444, 'f1-score': 0.4246174030883965, 'support': 269174}, 'accuracy': 0.3790496264238762, 'macro avg': {'precision': 0.3705468601357515, 'recall': 0.3743759661837516, 'f1-score': 0.36763443054726924, 'support': 783776}, 'weighted avg': {'precision': 0.37193022163793, 'recall': 0.3790496264238762, 'f1-score': 0.37082929391233915, 'support': 783776}}
[[120523  57834  90614]
 [ 95553  53584  96494]
 [ 92389  53802 122983]]
testing model out of sample: results/universal/W1/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 180s - 180s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095804
{'0': {'precision': 0.38686955453628113, 'recall': 0.44840305167250644, 'f1-score': 0.4153697548890753, 'support': 2058019}, '1': {'precision': 0.32706391217637315, 'recall': 0.263643742096186, 'f1-score': 0.2919493359773213, 'support': 1982429}, '2': {'precision': 0.3994043840772703, 'recall': 0.410476300114197, 'f1-score': 0.4048646597593589, 'support': 2058723}, 'accuracy': 0.37554841469439043, 'macro avg': {'precision': 0.3711126169299748, 'recall': 0.3741743646276299, 'f1-score': 0.3707279168752519, 'support': 6099171}, 'weighted avg': {'precision': 0.37166179959699575, 'recall': 0.37554841469439043, 'f1-score': 0.3717081984900918, 'support': 6099171}}
[[922822 548619 586578]
 [775616 522655 684158]
 [686919 526747 845057]]
Evaluating performance on  train set...
6711/6711 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0884485
{'0': {'precision': 0.39579692271165423, 'recall': 0.4162516646321163, 'f1-score': 0.4057666757943631, 'support': 576704}, '1': {'precision': 0.3410842194425941, 'recall': 0.2928243886768874, 'f1-score': 0.31511727957726543, 'support': 566558}, '2': {'precision': 0.40434998478466294, 'recall': 0.43982355769565795, 'f1-score': 0.4213414420443565, 'support': 574012}, 'accuracy': 0.38340998582637364, 'macro avg': {'precision': 0.38041037564630376, 'recall': 0.38296653700155386, 'f1-score': 0.3807417991386617, 'support': 1717274}, 'weighted avg': {'precision': 0.38060519473343973, 'recall': 0.38340998582637364, 'f1-score': 0.3810658779617078, 'support': 1717274}}
[[240054 165514 171136]
 [199886 165902 200770]
 [166568 154980 252464]]
Evaluating performance on  val set...
1720/1720 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.087064
{'0': {'precision': 0.40325462884321384, 'recall': 0.3987168290225059, 'f1-score': 0.4009728908031416, 'support': 148850}, '1': {'precision': 0.34505223391542345, 'recall': 0.3047231924614117, 'f1-score': 0.32363617956727986, 'support': 146871}, '2': {'precision': 0.3991262249111805, 'recall': 0.451300908901686, 'f1-score': 0.42361307843347956, 'support': 144130}, 'accuracy': 0.38456204487428697, 'macro avg': {'precision': 0.38247769588993924, 'recall': 0.38491364346186785, 'f1-score': 0.382740716267967, 'support': 439851}, 'weighted avg': {'precision': 0.38246742862276767, 'recall': 0.38456204487428697, 'f1-score': 0.3825680449058681, 'support': 439851}}
[[59349 45061 44440]
 [48631 44755 53485]
 [39195 39889 65046]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131773
{'0': {'precision': 0.3703811350733399, 'recall': 0.6184382936732614, 'f1-score': 0.4632956645560033, 'support': 61817}, '1': {'precision': 0.3404761904761905, 'recall': 0.04927164487662947, 'f1-score': 0.08608551696459923, 'support': 52241}, '2': {'precision': 0.3378321025379849, 'recall': 0.35775280898876405, 'f1-score': 0.34750720335283336, 'support': 55625}, 'accuracy': 0.35774945044583134, 'macro avg': {'precision': 0.3495631426958384, 'recall': 0.3418209158462184, 'f1-score': 0.298962794957812, 'support': 169683}, 'weighted avg': {'precision': 0.35050404576280914, 'recall': 0.35774945044583134, 'f1-score': 0.3092049867936531, 'support': 169683}}
[[38230  2850 20737]
 [31399  2574 18268]
 [33589  2136 19900]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1240392
{'0': {'precision': 0.3408074304111228, 'recall': 0.5487155963302752, 'f1-score': 0.4204643315348249, 'support': 21800}, '1': {'precision': 0.36967032967032964, 'recall': 0.038248135346552664, 'f1-score': 0.06932366154226599, 'support': 21988}, '2': {'precision': 0.35754228275412536, 'recall': 0.4584121398724434, 'f1-score': 0.401742348315473, 'support': 22735}, 'accuracy': 0.3491273694812321, 'macro avg': {'precision': 0.35600668094519267, 'recall': 0.3484586238497571, 'f1-score': 0.297176780464188, 'support': 66523}, 'weighted avg': {'precision': 0.3560668789767258, 'recall': 0.3491273694812321, 'f1-score': 0.29800254628328254, 'support': 66523}}
[[11962   709  9129]
 [11549   841  9598]
 [11588   725 10422]]
Evaluating performance on  val set...
51/51 - 1s - 584ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1434066
{'0': {'precision': 0.3313503043718871, 'recall': 0.5872976949485041, 'f1-score': 0.42366884839908014, 'support': 4078}, '1': {'precision': 0.4519230769230769, 'recall': 0.06505833498121416, 'f1-score': 0.11374243733794298, 'support': 5057}, '2': {'precision': 0.2976896340216725, 'recall': 0.3922413793103448, 'f1-score': 0.33848657445077296, 'support': 3712}, 'accuracy': 0.3253677901455593, 'macro avg': {'precision': 0.3603210051055455, 'recall': 0.34819913641335437, 'f1-score': 0.291965953395932, 'support': 12847}, 'weighted avg': {'precision': 0.3690858147985525, 'recall': 0.3253677901455593, 'f1-score': 0.2770591759749899, 'support': 12847}}
[[2395  216 1467]
 [2760  329 1968]
 [2073  183 1456]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0657387
{'0': {'precision': 0.3975350991379551, 'recall': 0.5366902242368932, 'f1-score': 0.45674891519244104, 'support': 132583}, '1': {'precision': 0.4271912196630082, 'recall': 0.1676616553213692, 'f1-score': 0.24081109813694904, 'support': 164826}, '2': {'precision': 0.38890831368922074, 'recall': 0.5579630408751092, 'f1-score': 0.4583441336177962, 'support': 123596}, 'accuracy': 0.3984584506122255, 'macro avg': {'precision': 0.404544877496728, 'recall': 0.4207716401444572, 'f1-score': 0.38530138231572875, 'support': 421005}, 'weighted avg': {'precision': 0.4066130520063073, 'recall': 0.3984584506122255, 'f1-score': 0.37267626993291125, 'support': 421005}}
[[71156 19520 41907]
 [70738 27635 66453]
 [37099 17535 68962]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0615608
{'0': {'precision': 0.4391165402305717, 'recall': 0.5044344947077694, 'f1-score': 0.46951467782239714, 'support': 58293}, '1': {'precision': 0.3681226600106971, 'recall': 0.19719224524878234, 'f1-score': 0.25681592039800993, 'support': 52355}, '2': {'precision': 0.4229790429570707, 'recall': 0.5405366980629109, 'f1-score': 0.47458632069215706, 'support': 56270}, 'accuracy': 0.42023628368420424, 'macro avg': {'precision': 0.41007274773277985, 'recall': 0.41405447933982087, 'f1-score': 0.40030563963752136, 'support': 166918}, 'weighted avg': {'precision': 0.41140867426949235, 'recall': 0.42023628368420424, 'f1-score': 0.4045099323744982, 'support': 166918}}
[[29405  9084 19804]
 [20342 10324 21689]
 [17217  8637 30416]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0652606
{'0': {'precision': 0.47561053778603934, 'recall': 0.44335564053537285, 'f1-score': 0.4589170300275226, 'support': 16736}, '1': {'precision': 0.3380027112516945, 'recall': 0.20937718684394682, 'f1-score': 0.2585774781782041, 'support': 14290}, '2': {'precision': 0.4094426890140587, 'recall': 0.5857573375262054, 'f1-score': 0.4819816177461524, 'support': 15264}, 'accuracy': 0.4180816591056384, 'macro avg': {'precision': 0.4076853126839309, 'recall': 0.4128300549685084, 'f1-score': 0.39982537531729306, 'support': 46290}, 'weighted avg': {'precision': 0.4113115124062316, 'recall': 0.4180816591056384, 'f1-score': 0.4046764958086936, 'support': 46290}}
[[7420 3273 6043]
 [4445 2992 6853]
 [3736 2587 8941]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
1314/1314 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097113
{'0': {'precision': 0.357296720295052, 'recall': 0.4970743592935778, 'f1-score': 0.4157515219355822, 'support': 112454}, '1': {'precision': 0.35922889546609393, 'recall': 0.12025532884988031, 'f1-score': 0.18019024095435796, 'support': 114049}, '2': {'precision': 0.34995128288405325, 'recall': 0.4515885091611469, 'f1-score': 0.3943259703012439, 'support': 109757}, 'accuracy': 0.35442217331826564, 'macro avg': {'precision': 0.3554922995483997, 'recall': 0.35630606576820173, 'f1-score': 0.33008924439706133, 'support': 336260}, 'weighted avg': {'precision': 0.35555446570682614, 'recall': 0.35442217331826564, 'f1-score': 0.32886300470083013, 'support': 336260}}
[[55898 12769 43787]
 [52052 13715 48282]
 [48497 11695 49565]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952705
{'0': {'precision': 0.3764312279733, 'recall': 0.5107311268784981, 'f1-score': 0.43341592258426437, 'support': 45382}, '1': {'precision': 0.3709853833151039, 'recall': 0.16717073280014338, 'f1-score': 0.23048292690460379, 'support': 44637}, '2': {'precision': 0.3728382794137318, 'recall': 0.44344189640673654, 'f1-score': 0.40508668120004154, 'support': 43999}, 'accuracy': 0.3742109268904177, 'macro avg': {'precision': 0.3734182969007119, 'recall': 0.37378125202845935, 'f1-score': 0.3563285102296366, 'support': 134018}, 'weighted avg': {'precision': 0.3734378068531495, 'recall': 0.3742109268904177, 'f1-score': 0.3565249197352633, 'support': 134018}}
[[23178  6421 15783]
 [20138  7462 17037]
 [18257  6231 19511]]
Evaluating performance on  val set...
107/107 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003562
{'0': {'precision': 0.3561916912526912, 'recall': 0.495947596313978, 'f1-score': 0.41460924447744574, 'support': 9007}, '1': {'precision': 0.4042732639865055, 'recall': 0.15111391340899538, 'f1-score': 0.21999541038782225, 'support': 9516}, '2': {'precision': 0.3560332369942196, 'recall': 0.45588065224933505, 'f1-score': 0.3998174349612049, 'support': 8647}, 'accuracy': 0.3624217887375782, 'macro avg': {'precision': 0.37216606407780545, 'recall': 0.36764738732410285, 'f1-score': 0.34480736327549094, 'support': 27170}, 'weighted avg': {'precision': 0.3729813155501507, 'recall': 0.3624217887375782, 'f1-score': 0.34174027053251416, 'support': 27170}}
[[4467 1087 3453]
 [4401 1438 3677]
 [3673 1032 3942]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1251624
{'0': {'precision': 0.3461439854850956, 'recall': 0.6238847616677923, 'f1-score': 0.4452526969349121, 'support': 112532}, '1': {'precision': 0.5529669198094993, 'recall': 0.04021568186924287, 'f1-score': 0.07497840182210083, 'support': 106824}, '2': {'precision': 0.3485679018361066, 'recall': 0.3752666550096171, 'f1-score': 0.3614248845365252, 'support': 114380}, 'accuracy': 0.3518529616223602, 'macro avg': {'precision': 0.41589293571023384, 'recall': 0.3464556995155507, 'f1-score': 0.2938853277645127, 'support': 333736}, 'weighted avg': {'precision': 0.4131757132234838, 'recall': 0.3518529616223602, 'f1-score': 0.29800335469056793, 'support': 333736}}
[[70207  1742 40583]
 [62893  4296 39635]
 [69726  1731 42923]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1402291
{'0': {'precision': 0.33709466098919094, 'recall': 0.6307805461064632, 'f1-score': 0.43938051680524276, 'support': 32631}, '1': {'precision': 0.3961038961038961, 'recall': 0.009419103795435596, 'f1-score': 0.018400651564055386, 'support': 32381}, '2': {'precision': 0.34595633667444736, 'recall': 0.37908103391207537, 'f1-score': 0.3617620032161728, 'support': 33233}, 'accuracy': 0.34084177311822483, 'macro avg': {'precision': 0.3597182979225115, 'recall': 0.3397602279379914, 'f1-score': 0.273181057195157, 'support': 98245}, 'weighted avg': {'precision': 0.3595413820467246, 'recall': 0.34084177311822483, 'f1-score': 0.274372169525682, 'support': 98245}}
[[20583   223 11825]
 [20084   305 11992]
 [20393   242 12598]]
Evaluating performance on  val set...
93/93 - 1s - 864ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1464357
{'0': {'precision': 0.31090363454484826, 'recall': 0.6413536937680562, 'f1-score': 0.41879266978081203, 'support': 7269}, '1': {'precision': 0.3597122302158273, 'recall': 0.00616827041697508, 'f1-score': 0.012128562765312309, 'support': 8106}, '2': {'precision': 0.3729634002361275, 'recall': 0.38388625592417064, 'f1-score': 0.3783460087430385, 'support': 8229}, 'accuracy': 0.33346043043551943, 'macro avg': {'precision': 0.34785975499893435, 'recall': 0.3438027400364006, 'f1-score': 0.2697557470963876, 'support': 23604}, 'weighted avg': {'precision': 0.34930103703520976, 'recall': 0.33346043043551943, 'f1-score': 0.26503674599045957, 'support': 23604}}
[[4662   50 2557]
 [5302   50 2754]
 [5031   39 3159]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1102072
{'0': {'precision': 0.3654974835047623, 'recall': 0.5918389487753649, 'f1-score': 0.45191144747785683, 'support': 230436}, '1': {'precision': 0.31883339343671113, 'recall': 0.06781237266604348, 'f1-score': 0.11183802223952755, 'support': 208605}, '2': {'precision': 0.37425790929579944, 'recall': 0.40956603261107655, 'f1-score': 0.3911167263166041, 'support': 228266}, 'accuracy': 0.3656742698637958, 'macro avg': {'precision': 0.35286292874575764, 'recall': 0.3564057846841617, 'f1-score': 0.3182887320113295, 'support': 667307}, 'weighted avg': {'precision': 0.3539066337833763, 'recall': 0.3656742698637958, 'f1-score': 0.3248059552644734, 'support': 667307}}
[[136381  14699  79356]
 [117504  14146  76955]
 [119253  15523  93490]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1063435
{'0': {'precision': 0.35981058089952644, 'recall': 0.5442847187332869, 'f1-score': 0.43322733986493894, 'support': 61703}, '1': {'precision': 0.3566728997853037, 'recall': 0.08458013762748608, 'f1-score': 0.13673534409515717, 'support': 60889}, '2': {'precision': 0.3691841564588697, 'recall': 0.4572776909820091, 'f1-score': 0.4085359273035995, 'support': 62087}, 'accuracy': 0.36346850481105053, 'macro avg': {'precision': 0.36188921238123334, 'recall': 0.3620475157809273, 'f1-score': 0.3261662037545652, 'support': 184679}, 'weighted avg': {'precision': 0.3619273723072612, 'recall': 0.36346850481105053, 'f1-score': 0.3271724182868379, 'support': 184679}}
[[33584  4639 23480]
 [30708  5150 25031]
 [29046  4650 28391]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041534
{'0': {'precision': 0.37645023407286793, 'recall': 0.5412378676291274, 'f1-score': 0.44404873852063786, 'support': 20503}, '1': {'precision': 0.30122448979591837, 'recall': 0.06445039590125756, 'f1-score': 0.1061819576998705, 'support': 17176}, '2': {'precision': 0.37841628596617777, 'recall': 0.4622576855296652, 'f1-score': 0.4161561852716936, 'support': 20428}, 'accuracy': 0.372536871633366, 'macro avg': {'precision': 0.35203033661165467, 'recall': 0.35598198302001666, 'f1-score': 0.32212896049740064, 'support': 58107}, 'weighted avg': {'precision': 0.3549052416343605, 'recall': 0.372536871633366, 'f1-score': 0.334371954223618, 'support': 58107}}
[[11097  1241  8165]
 [ 8723  1107  7346]
 [ 9658  1327  9443]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/EXC
Evaluating performance on  test set...
5343/5343 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.079128
{'0': {'precision': 0.42701725171772414, 'recall': 0.46559629207026076, 'f1-score': 0.44547307271651493, 'support': 480268}, '1': {'precision': 0.32010248132640734, 'recall': 0.2939768985106404, 'f1-score': 0.30648394248596506, 'support': 402052}, '2': {'precision': 0.4459135627769074, 'recall': 0.4361991826376415, 'f1-score': 0.4410028822764986, 'support': 485464}, 'accuracy': 0.40471594930193655, 'macro avg': {'precision': 0.39767776527367965, 'recall': 0.3985907910728475, 'f1-score': 0.3976532991596595, 'support': 1367784}, 'weighted avg': {'precision': 0.40229710693365417, 'recall': 0.40471594930193655, 'f1-score': 0.4030314486594817, 'support': 1367784}}
[[223611 129293 127364]
 [148093 118194 135765]
 [151954 121751 211759]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0672898
{'0': {'precision': 0.4135392174065626, 'recall': 0.5405660810128905, 'f1-score': 0.46859665168807413, 'support': 108995}, '1': {'precision': 0.3631727355009399, 'recall': 0.19092281648899667, 'f1-score': 0.2502743842098634, 'support': 109285}, '2': {'precision': 0.4390786948176584, 'recall': 0.5110950248889604, 'f1-score': 0.47235770007474803, 'support': 111897}, 'accuracy': 0.41485021670195077, 'macro avg': {'precision': 0.40526354924172026, 'recall': 0.4141946407969492, 'f1-score': 0.3970762453242285, 'support': 330177}, 'weighted avg': {'precision': 0.4055237891023906, 'recall': 0.41485021670195077, 'f1-score': 0.3976089724432067, 'support': 330177}}
[[58919 18002 32074]
 [47434 20865 40986]
 [36122 18585 57190]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0676067
{'0': {'precision': 0.40961984060295875, 'recall': 0.5318192336936758, 'f1-score': 0.46278875751560655, 'support': 30249}, '1': {'precision': 0.39500191253346933, 'recall': 0.18854604102002312, 'f1-score': 0.25525253357501854, 'support': 32862}, '2': {'precision': 0.41179886498614227, 'recall': 0.5247031917398177, 'f1-score': 0.4614451773196486, 'support': 29733}, 'accuracy': 0.4080392917151351, 'macro avg': {'precision': 0.4054735393741901, 'recall': 0.4150228221511722, 'f1-score': 0.3931621561367579, 'support': 92844}, 'weighted avg': {'precision': 0.4051436717580752, 'recall': 0.4080392917151351, 'f1-score': 0.3889013327913161, 'support': 92844}}
[[16087  4786  9376]
 [13758  6196 12908]
 [ 9428  4704 15601]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/AAL
Evaluating performance on  test set...
7177/7177 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0770437
{'0': {'precision': 0.4329036758082274, 'recall': 0.42650369249590536, 'f1-score': 0.4296798539011815, 'support': 649019}, '1': {'precision': 0.33122116726913015, 'recall': 0.31868495490206544, 'f1-score': 0.32483215391519976, 'support': 562110}, '2': {'precision': 0.42626574810642104, 'recall': 0.44728774432666885, 'f1-score': 0.4365237998721527, 'support': 625955}, 'accuracy': 0.400595182365096, 'macro avg': {'precision': 0.3967968637279262, 'recall': 0.3974921305748798, 'f1-score': 0.39701193589617795, 'support': 1837084}, 'weighted avg': {'precision': 0.399529154605334, 'recall': 0.400595182365096, 'f1-score': 0.39993056729324145, 'support': 1837084}}
[[276809 189490 182720]
 [188851 179136 194123]
 [173764 172209 279982]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.06719
{'0': {'precision': 0.433342631138525, 'recall': 0.420120516967789, 'f1-score': 0.42662915351893016, 'support': 195989}, '1': {'precision': 0.35923919296300555, 'recall': 0.36343771989693613, 'f1-score': 0.36132626036551846, 'support': 189009}, '2': {'precision': 0.4391001645046779, 'recall': 0.4476985709538053, 'f1-score': 0.44335768262612396, 'support': 192576}, 'accuracy': 0.4107664126155263, 'macro avg': {'precision': 0.41056066286873616, 'recall': 0.4104189359395101, 'f1-score': 0.4104376988368575, 'support': 577574}, 'weighted avg': {'precision': 0.4110122388414402, 'recall': 0.4107664126155263, 'f1-score': 0.4108366813669873, 'support': 577574}}
[[82339 62936 50714]
 [60899 68693 59417]
 [46771 59589 86216]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0653557
{'0': {'precision': 0.44954853273137696, 'recall': 0.42411443174558106, 'f1-score': 0.43646126310406547, 'support': 56348}, '1': {'precision': 0.35170210641908756, 'recall': 0.33294271079441284, 'f1-score': 0.3420654031381078, 'support': 52907}, '2': {'precision': 0.4329749342565161, 'recall': 0.4810992750406865, 'f1-score': 0.4557702752422167, 'support': 54072}, 'accuracy': 0.4134466438494554, 'macro avg': {'precision': 0.41140852446899356, 'recall': 0.41271880586022675, 'f1-score': 0.41143231382813, 'support': 163327}, 'weighted avg': {'precision': 0.41236589609666885, 'recall': 0.4134466438494554, 'f1-score': 0.4122758873922431, 'support': 163327}}
[[23898 17136 15314]
 [16538 17615 18754]
 [12724 15334 26014]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/WBA
Evaluating performance on  test set...
5696/5696 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992026
{'0': {'precision': 0.39362990064052994, 'recall': 0.4325085605902266, 'f1-score': 0.4121544020058784, 'support': 511939}, '1': {'precision': 0.2938491126487759, 'recall': 0.19687270726338957, 'f1-score': 0.23577867535812447, 'support': 436160}, '2': {'precision': 0.39857582819767345, 'recall': 0.47156416692814557, 'f1-score': 0.4320088248662885, 'support': 509920}, 'accuracy': 0.37567823190232774, 'macro avg': {'precision': 0.36201828049565976, 'recall': 0.36698181159392057, 'f1-score': 0.3599806340767638, 'support': 1458019}, 'weighted avg': {'precision': 0.36551067783853297, 'recall': 0.37567823190232774, 'f1-score': 0.3663361584646735, 'support': 1458019}}
[[221418 108048 182473]
 [169927  85868 180365]
 [171158  98302 240460]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921692
{'0': {'precision': 0.3946117203149437, 'recall': 0.45518125474911736, 'f1-score': 0.4227379214993471, 'support': 193457}, '1': {'precision': 0.33444589215913756, 'recall': 0.20324753506231494, 'f1-score': 0.2528403724193766, 'support': 184386}, '2': {'precision': 0.39384695796720837, 'recall': 0.48187131437557335, 'f1-score': 0.433435174969589, 'support': 190775}, 'accuracy': 0.38244128747243317, 'macro avg': {'precision': 0.3743015234804299, 'recall': 0.38010003472900183, 'f1-score': 0.3696711562961042, 'support': 568618}, 'weighted avg': {'precision': 0.37484513901216104, 'recall': 0.38244128747243317, 'f1-score': 0.371234168621538, 'support': 568618}}
[[88058 37980 67419]
 [72845 37476 74065]
 [62248 36598 91929]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0852784
{'0': {'precision': 0.42970234325522483, 'recall': 0.4062468815487476, 'f1-score': 0.4176455501410618, 'support': 60126}, '1': {'precision': 0.29946451384924844, 'recall': 0.23779921863195838, 'f1-score': 0.2650930003128083, 'support': 46329}, '2': {'precision': 0.40586501075299447, 'recall': 0.4965412695370354, 'f1-score': 0.446647440519106, 'support': 57391}, 'accuracy': 0.39024449788215765, 'macro avg': {'precision': 0.37834395595248926, 'recall': 0.3801957899059138, 'f1-score': 0.3764619969909921, 'support': 163846}, 'weighted avg': {'precision': 0.38452677138783115, 'recall': 0.39024449788215765, 'f1-score': 0.38466848881330995, 'support': 163846}}
[[24426 13687 22013]
 [15609 11017 19703]
 [16809 12085 28497]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
12066/12066 - 91s - 91s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013817
{'0': {'precision': 0.3736475150940056, 'recall': 0.4140395283049867, 'f1-score': 0.39280788531007693, 'support': 1004293}, '1': {'precision': 0.32346904484942485, 'recall': 0.2992422213379452, 'f1-score': 0.31088435610760284, 'support': 1045424}, '2': {'precision': 0.3989837964500279, 'recall': 0.38736238355531605, 'f1-score': 0.3930872135521318, 'support': 1039120}, 'accuracy': 0.3662116194541829, 'macro avg': {'precision': 0.36536678546448614, 'recall': 0.3668813777327493, 'f1-score': 0.36559315165660383, 'support': 3088837}, 'weighted avg': {'precision': 0.36518791026723724, 'recall': 0.3662116194541829, 'f1-score': 0.3651746472887494, 'support': 3088837}}
[[415817 328611 259865]
 [386117 312835 346472]
 [310925 325679 402516]]
Evaluating performance on  train set...
2948/2948 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958579
{'0': {'precision': 0.3940489518844838, 'recall': 0.35359567962514393, 'f1-score': 0.37272790059584726, 'support': 251830}, '1': {'precision': 0.32490068021937557, 'recall': 0.33525706401103844, 'f1-score': 0.32999763798126125, 'support': 250035}, '2': {'precision': 0.3997441755576751, 'recall': 0.42804267363379056, 'f1-score': 0.4134097221823965, 'support': 252615}, 'accuracy': 0.37244459760364756, 'macro avg': {'precision': 0.3728979358871782, 'recall': 0.3722984724233243, 'f1-score': 0.372045086919835, 'support': 754480}, 'weighted avg': {'precision': 0.3730400594319574, 'recall': 0.37244459760364756, 'f1-score': 0.3721881608376669, 'support': 754480}}
[[ 89046  90472  72312]
 [ 76153  83826  90056]
 [ 60778  83707 108130]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946699
{'0': {'precision': 0.39340327169274536, 'recall': 0.30043792646909057, 'f1-score': 0.3406925490347044, 'support': 58914}, '1': {'precision': 0.3398200460347353, 'recall': 0.3915454472394117, 'f1-score': 0.3638536221060493, 'support': 62215}, '2': {'precision': 0.39395363154739726, 'recall': 0.42457788409491715, 'f1-score': 0.4086928752710221, 'support': 57271}, 'accuracy': 0.3720627802690583, 'macro avg': {'precision': 0.37572564975829265, 'recall': 0.37218708593447314, 'f1-score': 0.3710796821372586, 'support': 178400}, 'weighted avg': {'precision': 0.3748934021575585, 'recall': 0.3720627802690583, 'f1-score': 0.370599571708549, 'support': 178400}}
[[17700 25271 15943]
 [16391 24360 21464]
 [10901 22054 24316]]
testing model on single stock: results/universal/W1/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
21353/21353 - 161s - 161s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951053
{'0': {'precision': 0.39763612027042405, 'recall': 0.47384942473739317, 'f1-score': 0.43241026296829566, 'support': 1998044}, '1': {'precision': 0.27933888177847027, 'recall': 0.2191294870010995, 'f1-score': 0.24559787419789345, 'support': 1466124}, '2': {'precision': 0.4087625490995551, 'recall': 0.3950942137135847, 'f1-score': 0.40181217700246086, 'support': 2002044}, 'accuracy': 0.3766848047605911, 'macro avg': {'precision': 0.3619125170494832, 'recall': 0.36269104181735917, 'f1-score': 0.35994010472288335, 'support': 5466212}, 'weighted avg': {'precision': 0.36998208482357564, 'recall': 0.3766848047605911, 'f1-score': 0.37109744870258465, 'support': 5466212}}
[[946772 424796 626476]
 [627226 321271 517627]
 [807003 404045 790996]]
Evaluating performance on  train set...
6073/6073 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027344
{'0': {'precision': 0.3732496736429865, 'recall': 0.42675559133427443, 'f1-score': 0.39821334224685423, 'support': 519241}, '1': {'precision': 0.33147083685545226, 'recall': 0.22924250337124194, 'f1-score': 0.27103761934603904, 'support': 513164}, '2': {'precision': 0.3797349078679424, 'recall': 0.4407007208684128, 'f1-score': 0.4079526577704972, 'support': 522148}, 'accuracy': 0.3662396843336959, 'macro avg': {'precision': 0.3614851394554604, 'recall': 0.3655662718579764, 'f1-score': 0.35906787312113014, 'support': 1554553}, 'weighted avg': {'precision': 0.36163659713729907, 'recall': 0.3662396843336959, 'f1-score': 0.35950341177511425, 'support': 1554553}}
[[221589 121157 176495]
 [196153 117639 199372]
 [175933 116104 230111]]
Evaluating performance on  val set...
1786/1786 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023414
{'0': {'precision': 0.3740832774412033, 'recall': 0.44016145829964226, 'f1-score': 0.404441155580123, 'support': 154591}, '1': {'precision': 0.3210596000889121, 'recall': 0.2306309183305101, 'f1-score': 0.26843408735561597, 'support': 144044}, '2': {'precision': 0.3888698121882657, 'recall': 0.42140050581179006, 'f1-score': 0.40448213864119287, 'support': 158557}, 'accuracy': 0.36763985371572555, 'macro avg': {'precision': 0.36133756323946037, 'recall': 0.36406429414731417, 'f1-score': 0.35911912719231065, 'support': 457192}, 'weighted avg': {'precision': 0.3625055726899315, 'recall': 0.36763985371572555, 'f1-score': 0.3616046580383531, 'support': 457192}}
[[68045 35849 50697]
 [56515 33221 54308]
 [57338 34403 66816]]
training model: results/universal/W1/deepVOL_L2/h50
Epoch 1/50
10622/10622 - 335s - loss: 3.0148 - accuracy50: 0.4785 - val_loss: 3.3201 - val_accuracy50: 0.4568 - 335s/epoch - 32ms/step
Epoch 2/50
10622/10622 - 335s - loss: 2.9553 - accuracy50: 0.4996 - val_loss: 3.2790 - val_accuracy50: 0.4575 - 335s/epoch - 32ms/step
Epoch 3/50
10622/10622 - 329s - loss: 2.9322 - accuracy50: 0.5061 - val_loss: 3.2503 - val_accuracy50: 0.4569 - 329s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 330s - loss: 2.9183 - accuracy50: 0.5093 - val_loss: 3.2488 - val_accuracy50: 0.4571 - 330s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 327s - loss: 2.9081 - accuracy50: 0.5108 - val_loss: 3.2480 - val_accuracy50: 0.4589 - 327s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 327s - loss: 2.9006 - accuracy50: 0.5126 - val_loss: 3.2303 - val_accuracy50: 0.4603 - 327s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 330s - loss: 2.8940 - accuracy50: 0.5138 - val_loss: 3.2228 - val_accuracy50: 0.4609 - 330s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 327s - loss: 2.8888 - accuracy50: 0.5151 - val_loss: 3.2396 - val_accuracy50: 0.4601 - 327s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 328s - loss: 2.8841 - accuracy50: 0.5163 - val_loss: 3.2272 - val_accuracy50: 0.4578 - 328s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 328s - loss: 2.8797 - accuracy50: 0.5174 - val_loss: 3.2324 - val_accuracy50: 0.4578 - 328s/epoch - 31ms/step
Epoch 11/50
10622/10622 - 332s - loss: 2.8761 - accuracy50: 0.5182 - val_loss: 3.2215 - val_accuracy50: 0.4586 - 332s/epoch - 31ms/step
Epoch 12/50
10622/10622 - 327s - loss: 2.8726 - accuracy50: 0.5191 - val_loss: 3.2198 - val_accuracy50: 0.4581 - 327s/epoch - 31ms/step
Epoch 13/50
10622/10622 - 328s - loss: 2.8700 - accuracy50: 0.5196 - val_loss: 3.2252 - val_accuracy50: 0.4587 - 328s/epoch - 31ms/step
Epoch 14/50
10622/10622 - 329s - loss: 2.8676 - accuracy50: 0.5202 - val_loss: 3.2122 - val_accuracy50: 0.4614 - 329s/epoch - 31ms/step
Epoch 15/50
10622/10622 - 329s - loss: 2.8651 - accuracy50: 0.5207 - val_loss: 3.2248 - val_accuracy50: 0.4587 - 329s/epoch - 31ms/step
Epoch 16/50
10622/10622 - 326s - loss: 2.8627 - accuracy50: 0.5214 - val_loss: 3.2231 - val_accuracy50: 0.4603 - 326s/epoch - 31ms/step
Epoch 17/50
10622/10622 - 331s - loss: 2.8608 - accuracy50: 0.5219 - val_loss: 3.2293 - val_accuracy50: 0.4588 - 331s/epoch - 31ms/step
Epoch 18/50
10622/10622 - 329s - loss: 2.8586 - accuracy50: 0.5224 - val_loss: 3.2354 - val_accuracy50: 0.4582 - 329s/epoch - 31ms/step
Epoch 19/50
10622/10622 - 331s - loss: 2.8572 - accuracy50: 0.5227 - val_loss: 3.2247 - val_accuracy50: 0.4591 - 331s/epoch - 31ms/step
Epoch 20/50
10622/10622 - 330s - loss: 2.8554 - accuracy50: 0.5234 - val_loss: 3.2386 - val_accuracy50: 0.4590 - 330s/epoch - 31ms/step
Epoch 21/50
10622/10622 - 335s - loss: 2.8540 - accuracy50: 0.5234 - val_loss: 3.2204 - val_accuracy50: 0.4622 - 335s/epoch - 31ms/step
Epoch 22/50
10622/10622 - 330s - loss: 2.8525 - accuracy50: 0.5238 - val_loss: 3.2219 - val_accuracy50: 0.4605 - 330s/epoch - 31ms/step
Epoch 23/50
10622/10622 - 328s - loss: 2.8509 - accuracy50: 0.5242 - val_loss: 3.2202 - val_accuracy50: 0.4615 - 328s/epoch - 31ms/step
Epoch 24/50
10622/10622 - 330s - loss: 2.8495 - accuracy50: 0.5245 - val_loss: 3.2291 - val_accuracy50: 0.4602 - 330s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 559s - 559s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0855798
{'0': {'precision': 0.4426633626810395, 'recall': 0.4676426336251857, 'f1-score': 0.4548102760467918, 'support': 3163700}, '1': {'precision': 0.4118732202061711, 'recall': 0.6147652306742764, 'f1-score': 0.49327070306290277, 'support': 2715474}, '2': {'precision': 0.4999464096590988, 'recall': 0.260644707503172, 'f1-score': 0.3426502959935456, 'support': 3167607}, 'accuracy': 0.43932532466520413, 'macro avg': {'precision': 0.45149433084876983, 'recall': 0.447684190600878, 'f1-score': 0.43024375836774675, 'support': 9046781}, 'weighted avg': {'precision': 0.4534782977659309, 'recall': 0.43932532466520413, 'f1-score': 0.42708323718674024, 'support': 9046781}}
[[1479481 1193857  490362]
 [ 710660 1669379  335435]
 [1152085 1189902  825620]]
Evaluating performance on  train set...
10622/10622 - 171s - 171s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0508896
{'0': {'precision': 0.4476185870699695, 'recall': 0.3936369521253473, 'f1-score': 0.41889582444215795, 'support': 846544}, '1': {'precision': 0.47184168567698737, 'recall': 0.7381772063702071, 'f1-score': 0.5756980815279089, 'support': 1021882}, '2': {'precision': 0.5017582745465783, 'recall': 0.22155823867646643, 'f1-score': 0.3073859852985338, 'support': 850088}, 'accuracy': 0.46933913159910157, 'macro avg': {'precision': 0.4737395157645117, 'recall': 0.4511241323906736, 'f1-score': 0.4339932970895335, 'support': 2718514}, 'weighted avg': {'precision': 0.47365363676930966, 'recall': 0.46933913159910157, 'f1-score': 0.44296788290401473, 'support': 2718514}}
[[333231 416026  97287]
 [177815 754330  89737]
 [233407 428337 188344]]
Evaluating performance on  val set...
3064/3064 - 50s - 50s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0631273
{'0': {'precision': 0.4476231080793008, 'recall': 0.41549755624591883, 'f1-score': 0.4309624719078063, 'support': 252685}, '1': {'precision': 0.45931758530183725, 'recall': 0.7012921841676075, 'f1-score': 0.5550803398288939, 'support': 278985}, '2': {'precision': 0.49490549200941025, 'recall': 0.24198756088660414, 'f1-score': 0.3250430232991811, 'support': 252108}, 'accuracy': 0.4614150945803531, 'macro avg': {'precision': 0.4672820617968494, 'recall': 0.4529257671000435, 'f1-score': 0.43702861167862705, 'support': 783778}, 'weighted avg': {'precision': 0.4669944746853823, 'recall': 0.4614150945803531, 'f1-score': 0.44107232831120285, 'support': 783778}}
[[104990 114410  33285]
 [ 54357 195650  28978]
 [ 75203 115898  61007]]
testing model out of sample: results/universal/W1/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 375s - 375s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99342304
{'0': {'precision': 0.49545177971258164, 'recall': 0.32050408439269157, 'f1-score': 0.3892228146227849, 'support': 1824139}, '1': {'precision': 0.4922886502283954, 'recall': 0.8749263466266451, 'f1-score': 0.6300637591320383, 'support': 2469337}, '2': {'precision': 0.600153059397225, 'recall': 0.1763224641694172, 'f1-score': 0.27256613531270213, 'support': 1805720}, 'accuracy': 0.5022827598916316, 'macro avg': {'precision': 0.5292978297794008, 'recall': 0.45725096506291796, 'f1-score': 0.43061756968917503, 'support': 6099196}, 'weighted avg': {'precision': 0.5251688706342477, 'recall': 0.5022827598916316, 'f1-score': 0.4521931071708263, 'support': 6099196}}
[[ 584644 1116771  122724]
 [ 219449 2160488   89400]
 [ 375929 1111402  318389]]
Evaluating performance on  train set...
6711/6711 - 105s - 105s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97442603
{'0': {'precision': 0.49488733556676523, 'recall': 0.36164710721852467, 'f1-score': 0.4179039729559785, 'support': 500781}, '1': {'precision': 0.5180682292324275, 'recall': 0.8625219779684352, 'f1-score': 0.6473249360592435, 'support': 718333}, '2': {'precision': 0.5800431187051517, 'recall': 0.18092435422872788, 'f1-score': 0.2758171154725965, 'support': 498164}, 'accuracy': 0.5187360462313032, 'macro avg': {'precision': 0.5309995611681148, 'recall': 0.4683644798052293, 'f1-score': 0.4470153414959395, 'support': 1717278}, 'weighted avg': {'precision': 0.5292866270273716, 'recall': 0.5187360462313032, 'f1-score': 0.4726522964175882, 'support': 1717278}}
[[181106 283583  36092]
 [ 69592 619578  29163]
 [115256 292778  90130]]
Evaluating performance on  val set...
1720/1720 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9470854
{'0': {'precision': 0.4919285816176121, 'recall': 0.34248094477502006, 'f1-score': 0.40382128934361844, 'support': 120833}, '1': {'precision': 0.5533870846206013, 'recall': 0.8805711402321131, 'f1-score': 0.6796525695776657, 'support': 200161}, '2': {'precision': 0.5756346541302888, 'recall': 0.18028083695807637, 'f1-score': 0.27457010327772224, 'support': 118859}, 'accuracy': 0.5435156745549081, 'macro avg': {'precision': 0.5403167734561675, 'recall': 0.4677776406550698, 'f1-score': 0.4526813207330022, 'support': 439853}, 'weighted avg': {'precision': 0.5425155174629185, 'recall': 0.5435156745549081, 'f1-score': 0.4944151881196204, 'support': 439853}}
[[ 41383  70933   8517]
 [ 16625 176256   7280]
 [ 26116  71315  21428]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2079662
{'0': {'precision': 0.3905831188426378, 'recall': 0.7252546227627806, 'f1-score': 0.5077301151441033, 'support': 60678}, '1': {'precision': 0.36818158839290227, 'recall': 0.15033232877843372, 'f1-score': 0.21349319184487078, 'support': 48446}, '2': {'precision': 0.46751886564438594, 'recall': 0.28744798890429957, 'f1-score': 0.35600862976861175, 'support': 60564}, 'accuracy': 0.40485479232473714, 'macro avg': {'precision': 0.4087611909599754, 'recall': 0.387678313481838, 'f1-score': 0.3590773122525286, 'support': 169688}, 'weighted avg': {'precision': 0.4116469066480995, 'recall': 0.40485479232473714, 'f1-score': 0.36957383994234544, 'support': 169688}}
[[44007  6566 10105]
 [31440  7283  9723]
 [37223  5932 17409]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2684808
{'0': {'precision': 0.3629991451947735, 'recall': 0.6817889908256881, 'f1-score': 0.47375886524822697, 'support': 21800}, '1': {'precision': 0.3773677736777368, 'recall': 0.13962590451918264, 'f1-score': 0.20383350496628241, 'support': 21973}, '2': {'precision': 0.4146033929390188, 'recall': 0.317978021978022, 'f1-score': 0.35991840390069163, 'support': 22750}, 'accuracy': 0.37829021541421765, 'macro avg': {'precision': 0.38499010393717636, 'recall': 0.3797976391076309, 'f1-score': 0.345836924705067, 'support': 66523}, 'weighted avg': {'precision': 0.3853931819916367, 'recall': 0.37829021541421765, 'f1-score': 0.34566872443780655, 'support': 66523}}
[[14863  2494  4443]
 [13134  3068  5771]
 [12948  2568  7234]]
Evaluating performance on  val set...
51/51 - 1s - 940ms/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2937535
{'0': {'precision': 0.3482111229188806, 'recall': 0.7212032281731474, 'f1-score': 0.4696607740086001, 'support': 4089}, '1': {'precision': 0.47332506203473945, 'recall': 0.15660919540229884, 'f1-score': 0.2353485502776064, 'support': 4872}, '2': {'precision': 0.38900939985538685, 'recall': 0.27689140504374676, 'f1-score': 0.32351172579675286, 'support': 3886}, 'accuracy': 0.37269401416673154, 'macro avg': {'precision': 0.4035151949363356, 'recall': 0.3849012762063977, 'f1-score': 0.3428403500276531, 'support': 12847}, 'weighted avg': {'precision': 0.4079991835982398, 'recall': 0.37269401416673154, 'f1-score': 0.3365943495228338, 'support': 12847}}
[[2949  456  684]
 [3103  763 1006]
 [2417  393 1076]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7336848
{'0': {'precision': 0.5533406130170904, 'recall': 0.2959914150264205, 'f1-score': 0.385677369110411, 'support': 73617}, '1': {'precision': 0.7278067068227203, 'recall': 0.9681104770038613, 'f1-score': 0.8309336149527484, 'support': 276329}, '2': {'precision': 0.8151439744045503, 'recall': 0.16133344590791399, 'f1-score': 0.26935591866461484, 'support': 71064}, 'accuracy': 0.714405833590651, 'macro avg': {'precision': 0.6987637647481204, 'recall': 0.4751451126460653, 'f1-score': 0.49532230090925805, 'support': 421010}, 'weighted avg': {'precision': 0.712041915382484, 'recall': 0.714405833590651, 'f1-score': 0.6582859665377576, 'support': 421010}}
[[ 21790  50461   1366]
 [  7578 267517   1234]
 [ 10011  49588  11465]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8339031
{'0': {'precision': 0.5665356116739755, 'recall': 0.3733991129715453, 'f1-score': 0.4501246508275013, 'support': 40134}, '1': {'precision': 0.6323806738148202, 'recall': 0.9404095555326626, 'f1-score': 0.7562315905743742, 'support': 87363}, '2': {'precision': 0.6742819224571049, 'recall': 0.18043682301311484, 'f1-score': 0.2846908144886932, 'support': 39421}, 'accuracy': 0.6245941120789849, 'macro avg': {'precision': 0.6243994026486336, 'recall': 0.4980818305057742, 'f1-score': 0.4970156852968562, 'support': 166918}, 'weighted avg': {'precision': 0.6264446057979907, 'recall': 0.6245941120789849, 'f1-score': 0.5712670879211275, 'support': 166918}}
[[14986 23283  1865]
 [ 3635 82157  1571]
 [ 7831 24477  7113]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80646735
{'0': {'precision': 0.6008907159986296, 'recall': 0.3383161346320764, 'f1-score': 0.4328993644721416, 'support': 10369}, '1': {'precision': 0.6599589106042248, 'recall': 0.9575785370327906, 'f1-score': 0.7813883864529408, 'support': 26166}, '2': {'precision': 0.7172164119066774, 'recall': 0.18277806253203485, 'f1-score': 0.29131606894861534, 'support': 9755}, 'accuracy': 0.6555843594728883, 'macro avg': {'precision': 0.6593553461698439, 'recall': 0.49289091139896724, 'f1-score': 0.5018679399578992, 'support': 46290}, 'weighted avg': {'precision': 0.6587938385657718, 'recall': 0.6555843594728883, 'f1-score': 0.6000503409534031, 'support': 46290}}
[[ 3508  6448   413]
 [  820 25056   290]
 [ 1510  6462  1783]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
1314/1314 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.237021
{'0': {'precision': 0.4106693830449556, 'recall': 0.460905645896292, 'f1-score': 0.4343397434690072, 'support': 125082}, '1': {'precision': 0.27963724890021496, 'recall': 0.4620179472402884, 'f1-score': 0.34840294622387574, 'support': 85027}, '2': {'precision': 0.46397111913357403, 'recall': 0.20374774089222866, 'f1-score': 0.28315230562471083, 'support': 126156}, 'accuracy': 0.3647093809941564, 'macro avg': {'precision': 0.38475925035958153, 'recall': 0.37555711134293635, 'f1-score': 0.3552983317725313, 'support': 336265}, 'weighted avg': {'precision': 0.3975341014904402, 'recall': 0.3647093809941564, 'f1-score': 0.3558892640315194, 'support': 336265}}
[[57651 50650 16781]
 [32828 39284 12915]
 [49904 50548 25704]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1109443
{'0': {'precision': 0.4559065934065934, 'recall': 0.44154231613489725, 'f1-score': 0.4486094997803584, 'support': 45101}, '1': {'precision': 0.42771092400979827, 'recall': 0.7235569846697312, 'f1-score': 0.5376215634148804, 'support': 44161}, '2': {'precision': 0.5200562983814215, 'recall': 0.181629278755921, 'f1-score': 0.2692301323132462, 'support': 44756}, 'accuracy': 0.4476712083451477, 'macro avg': {'precision': 0.46789127193260444, 'recall': 0.4489095265201832, 'f1-score': 0.418487065169495, 'support': 134018}, 'weighted avg': {'precision': 0.4680388087778236, 'recall': 0.4476712083451477, 'f1-score': 0.4180356870970327, 'support': 134018}}
[[19914 20932  4255]
 [ 8961 31953  3247]
 [14805 21822  8129]]
Evaluating performance on  val set...
107/107 - 3s - 3s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1923018
{'0': {'precision': 0.4376702677313293, 'recall': 0.4588339570612566, 'f1-score': 0.4480023078032598, 'support': 10154}, '1': {'precision': 0.3057269419395665, 'recall': 0.5647282291057861, 'f1-score': 0.3966950631222416, 'support': 6844}, '2': {'precision': 0.4962657738861705, 'recall': 0.18944160440424695, 'f1-score': 0.2742084667378157, 'support': 10172}, 'accuracy': 0.38465218991534783, 'macro avg': {'precision': 0.4132209945190221, 'recall': 0.4043345968570966, 'f1-score': 0.3729686125544391, 'support': 27170}, 'weighted avg': {'precision': 0.426371532614959, 'recall': 0.38465218991534783, 'f1-score': 0.37001269669120285, 'support': 27170}}
[[4659 4324 1171]
 [2194 3865  785]
 [3792 4453 1927]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2485669
{'0': {'precision': 0.3488685912502229, 'recall': 0.7489104432169109, 'f1-score': 0.4759998562451794, 'support': 114955}, '1': {'precision': 0.32353802428731376, 'recall': 0.17610328242342418, 'f1-score': 0.2280680452177714, 'support': 106659}, '2': {'precision': 0.3712734315556478, 'recall': 0.09573965235848636, 'f1-score': 0.15222523946937416, 'support': 112127}, 'accuracy': 0.3464033487045344, 'macro avg': {'precision': 0.34789334903106145, 'recall': 0.3402511259996072, 'f1-score': 0.28543104697744165, 'support': 333741}, 'weighted avg': {'precision': 0.34830064960454393, 'recall': 0.3464033487045344, 'f1-score': 0.2879856911063651, 'support': 333741}}
[[86091 19423  9441]
 [79138 18783  8738]
 [81543 19849 10735]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2490126
{'0': {'precision': 0.3472700374687185, 'recall': 0.7449136959487515, 'f1-score': 0.4737045593851667, 'support': 33718}, '1': {'precision': 0.34278877020953713, 'recall': 0.1838127132171137, 'f1-score': 0.23930405019965775, 'support': 31951}, '2': {'precision': 0.3818575005690872, 'recall': 0.102986769806919, 'f1-score': 0.16222227594710248, 'support': 32577}, 'accuracy': 0.349581662357755, 'macro avg': {'precision': 0.35730543608244764, 'recall': 0.343904392990928, 'f1-score': 0.29174362851064234, 'support': 98246}, 'weighted avg': {'precision': 0.35728138465051323, 'recall': 0.349581662357755, 'f1-score': 0.29419100141285215, 'support': 98246}}
[[25117  5814  2787]
 [23434  5873  2644]
 [23776  5446  3355]]
Evaluating performance on  val set...
93/93 - 1s - 810ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2788424
{'0': {'precision': 0.35157471521107886, 'recall': 0.7742252828332513, 'f1-score': 0.4835637480798772, 'support': 8132}, '1': {'precision': 0.28640308582449375, 'recall': 0.12175457775348456, 'f1-score': 0.17086969028670054, 'support': 7318}, '2': {'precision': 0.3485493230174081, 'recall': 0.11049791513367672, 'f1-score': 0.1677996089021324, 'support': 8154}, 'accuracy': 0.34265378749364517, 'macro avg': {'precision': 0.3288423746843269, 'recall': 0.3354925919068042, 'f1-score': 0.27407768242290337, 'support': 23604}, 'weighted avg': {'precision': 0.33032429020691767, 'recall': 0.34265378749364517, 'f1-score': 0.2775378242624819, 'support': 23604}}
[[6296 1054  782]
 [5525  891  902]
 [6087 1166  901]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2355762
{'0': {'precision': 0.4017729287419025, 'recall': 0.45386695881406414, 'f1-score': 0.4262341201104409, 'support': 233672}, '1': {'precision': 0.3408047050332841, 'recall': 0.5292585091531156, 'f1-score': 0.4146222645832731, 'support': 203428}, '2': {'precision': 0.4655533314269374, 'recall': 0.17679790801522074, 'f1-score': 0.25627367088846703, 'support': 230212}, 'accuracy': 0.381265435058863, 'macro avg': {'precision': 0.4027103217340413, 'recall': 0.3866411253274668, 'f1-score': 0.36571001852739365, 'support': 667312}, 'weighted avg': {'precision': 0.4051901762218376, 'recall': 0.381265435058863, 'f1-score': 0.3640606368185628, 'support': 667312}}
[[106056 103988  23628]
 [ 72666 107666  23096]
 [ 85248 104263  40701]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1953428
{'0': {'precision': 0.4071257842844338, 'recall': 0.44162304937531394, 'f1-score': 0.42367334882744784, 'support': 61711}, '1': {'precision': 0.38989771597746975, 'recall': 0.6020696142991533, 'f1-score': 0.4732929408254084, 'support': 60591}, '2': {'precision': 0.4850064110518261, 'recall': 0.18798294270415852, 'f1-score': 0.2709491075038993, 'support': 62378}, 'accuracy': 0.4085932423651722, 'macro avg': {'precision': 0.42734330377124324, 'recall': 0.41055853545954196, 'f1-score': 0.3893051323855852, 'support': 184680}, 'weighted avg': {'precision': 0.42777865329953635, 'recall': 0.4085932423651722, 'f1-score': 0.38836832377583486, 'support': 184680}}
[[27253 28219  6239]
 [17899 36480  6212]
 [21788 28864 11726]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2063519
{'0': {'precision': 0.41850706713780916, 'recall': 0.46484815777854094, 'f1-score': 0.44046207842316903, 'support': 20383}, '1': {'precision': 0.35378512641803217, 'recall': 0.5454701343240926, 'f1-score': 0.4291978681778318, 'support': 17495}, '2': {'precision': 0.48022133270543915, 'recall': 0.20163124073158675, 'f1-score': 0.28401336861161397, 'support': 20230}, 'accuracy': 0.39748399531906103, 'macro avg': {'precision': 0.41750450875376016, 'recall': 0.40398317761140673, 'f1-score': 0.3845577717375383, 'support': 58108}, 'weighted avg': {'precision': 0.4205062624214303, 'recall': 0.39748399531906103, 'f1-score': 0.38260387029812715, 'support': 58108}}
[[9475 8630 2278]
 [5815 9543 2137]
 [7350 8801 4079]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
5343/5343 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84691334
{'0': {'precision': 0.6541037114701715, 'recall': 0.3026362901362901, 'f1-score': 0.4138125724257876, 'support': 346320}, '1': {'precision': 0.5757355812379308, 'recall': 0.9615638305142155, 'f1-score': 0.7202325150537808, 'support': 673142}, '2': {'precision': 0.7687764827329581, 'recall': 0.18386745787722455, 'f1-score': 0.29675930645265913, 'support': 348327}, 'accuracy': 0.5966739021881299, 'macro avg': {'precision': 0.6662052584803534, 'recall': 0.4826891928425767, 'f1-score': 0.4769347979774092, 'support': 1367789}, 'weighted avg': {'precision': 0.6447387746815745, 'recall': 0.5966739021881299, 'f1-score': 0.5348044213468351, 'support': 1367789}}
[[104809 230498  11013]
 [ 17623 647269   8250]
 [ 37801 246480  64046]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77103066
{'0': {'precision': 0.625, 'recall': 0.3240044279185944, 'f1-score': 0.4267688569025142, 'support': 70462}, '1': {'precision': 0.6543190042027086, 'recall': 0.9559625294738976, 'f1-score': 0.7768883108437654, 'support': 187454}, '2': {'precision': 0.7662554353321873, 'recall': 0.2097258548871452, 'f1-score': 0.3293169200013038, 'support': 72261}, 'accuracy': 0.6577805237796697, 'macro avg': {'precision': 0.6818581465116319, 'recall': 0.496564270759879, 'f1-score': 0.5109913625825279, 'support': 330177}, 'weighted avg': {'precision': 0.6725600166769754, 'recall': 0.6577805237796697, 'f1-score': 0.6042170671251672, 'support': 330177}}
[[ 22830  45559   2073]
 [  5705 179199   2550]
 [  7993  49113  15155]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77581495
{'0': {'precision': 0.6125387461253875, 'recall': 0.308832425892317, 'f1-score': 0.4106310956195328, 'support': 19836}, '1': {'precision': 0.6572638603696098, 'recall': 0.9587763965852928, 'f1-score': 0.779892794054943, 'support': 53416}, '2': {'precision': 0.7523867560430632, 'recall': 0.18905675786035117, 'f1-score': 0.30218233734448297, 'support': 19592}, 'accuracy': 0.6574899831976219, 'macro avg': {'precision': 0.6740631208460202, 'recall': 0.485555193445987, 'f1-score': 0.4975687423396529, 'support': 92844}, 'weighted avg': {'precision': 0.6677812918232945, 'recall': 0.6574899831976219, 'f1-score': 0.6001937470725195, 'support': 92844}}
[[ 6126 13108   602]
 [ 1585 51214   617]
 [ 2290 13598  3704]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
7177/7177 - 53s - 53s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85001546
{'0': {'precision': 0.590838057465566, 'recall': 0.25176927139543964, 'f1-score': 0.3530823009619008, 'support': 435490}, '1': {'precision': 0.5998361314757307, 'recall': 0.962672459861509, 'f1-score': 0.7391264629237764, 'support': 974937}, '2': {'precision': 0.7187615143699336, 'recall': 0.14630550646647697, 'f1-score': 0.2431228213666725, 'support': 426662}, 'accuracy': 0.6045493713151622, 'macro avg': {'precision': 0.6364785677704101, 'recall': 0.4535824125744752, 'f1-score': 0.4451105284174499, 'support': 1837089}, 'weighted avg': {'precision': 0.6253233944584821, 'recall': 0.6045493713151622, 'f1-score': 0.5324166748804022, 'support': 1837089}}
[[109643 312009  13838]
 [ 25805 938545  10587]
 [ 50124 314115  62423]]
Evaluating performance on  train set...
2257/2257 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.828424
{'0': {'precision': 0.5677166319401887, 'recall': 0.3093981697949369, 'f1-score': 0.4005188067444877, 'support': 134739}, '1': {'precision': 0.6228726694633459, 'recall': 0.9481796678150871, 'f1-score': 0.7518466276508041, 'support': 311152}, '2': {'precision': 0.6610686522124184, 'recall': 0.15304820631208044, 'f1-score': 0.2485524538912629, 'support': 131684}, 'accuracy': 0.6178764662597931, 'macro avg': {'precision': 0.6172193178719844, 'recall': 0.4702086813073681, 'f1-score': 0.4669726294288516, 'support': 577575}, 'weighted avg': {'precision': 0.6187141280661181, 'recall': 0.6178764662597931, 'f1-score': 0.5551391018083637, 'support': 577575}}
[[ 41688  87344   5707]
 [ 11498 295028   4626]
 [ 20245  91285  20154]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8045224
{'0': {'precision': 0.587796721670961, 'recall': 0.2973707566008431, 'f1-score': 0.3949389469031438, 'support': 36056}, '1': {'precision': 0.6427100073046019, 'recall': 0.9621217919979005, 'f1-score': 0.7706294257524602, 'support': 91451}, '2': {'precision': 0.6906070599731281, 'recall': 0.15784037296557885, 'f1-score': 0.25695328122159605, 'support': 35821}, 'accuracy': 0.6389780074451411, 'macro avg': {'precision': 0.6403712629828969, 'recall': 0.4724443071881075, 'f1-score': 0.47417388462573334, 'support': 163328}, 'weighted avg': {'precision': 0.6410922007854056, 'recall': 0.6389780074451411, 'f1-score': 0.5750335139759672, 'support': 163328}}
[[10722 23910  1424]
 [ 2355 87987  1109]
 [ 5164 25003  5654]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
5696/5696 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0927995
{'0': {'precision': 0.4911445586766768, 'recall': 0.34716840359369255, 'f1-score': 0.4067928805674804, 'support': 546847}, '1': {'precision': 0.3358948439559257, 'recall': 0.8048350845723584, 'f1-score': 0.4739771410950293, 'support': 372403}, '2': {'precision': 0.5838979739911816, 'recall': 0.19417603670555744, 'f1-score': 0.29143498657276895, 'support': 538774}, 'accuracy': 0.4075296428591025, 'macro avg': {'precision': 0.47031245887459466, 'recall': 0.4487265082905361, 'f1-score': 0.3907350027450929, 'support': 1458024}, 'weighted avg': {'precision': 0.48576581941827307, 'recall': 0.4075296428591025, 'f1-score': 0.3813253890818355, 'support': 1458024}}
[[189848 305197  51802]
 [ 49929 299723  22751]
 [146765 287392 104617]]
Evaluating performance on  train set...
2222/2222 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9932215
{'0': {'precision': 0.5397247881982499, 'recall': 0.3400223576344746, 'f1-score': 0.41720736651717577, 'support': 182488}, '1': {'precision': 0.45919053348383176, 'recall': 0.8986057440239237, 'f1-score': 0.6077955254780469, 'support': 205988}, '2': {'precision': 0.604712352615336, 'recall': 0.16968186385260597, 'f1-score': 0.26500383630050584, 'support': 180143}, 'accuracy': 0.48840963808806953, 'macro avg': {'precision': 0.5345425580991392, 'recall': 0.46943665517033467, 'f1-score': 0.43000224276524285, 'support': 568619}, 'weighted avg': {'precision': 0.5311390124093184, 'recall': 0.48840963808806953, 'f1-score': 0.4380305770398814, 'support': 568619}}
[[ 62050 107366  13072]
 [ 13977 185102   6909]
 [ 38939 110637  30567]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0036609
{'0': {'precision': 0.5107883269510102, 'recall': 0.36499339498018496, 'f1-score': 0.4257553244180287, 'support': 52990}, '1': {'precision': 0.46504348139862156, 'recall': 0.8694867513366729, 'f1-score': 0.605979746210496, 'support': 59289}, '2': {'precision': 0.5854593522802379, 'recall': 0.17177319267762953, 'f1-score': 0.265615160874389, 'support': 51568}, 'accuracy': 0.48673457554914035, 'macro avg': {'precision': 0.5204303868766232, 'recall': 0.46875111299816247, 'f1-score': 0.4324500771676379, 'support': 163847}, 'weighted avg': {'precision': 0.5177366951617314, 'recall': 0.48673457554914035, 'f1-score': 0.4405692532054657, 'support': 163847}}
[[19341 29589  4060]
 [ 5526 51551  2212]
 [12998 29712  8858]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
12066/12066 - 99s - 99s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9880626
{'0': {'precision': 0.5597099478812599, 'recall': 0.2752324814773162, 'f1-score': 0.369008335056691, 'support': 969217}, '1': {'precision': 0.4546074748126868, 'recall': 0.9222573842396408, 'f1-score': 0.6090141640554468, 'support': 1157499}, '2': {'precision': 0.651110471458005, 'recall': 0.17868137853046276, 'f1-score': 0.2804108442794485, 'support': 962126}, 'accuracy': 0.4876215746872129, 'macro avg': {'precision': 0.5551426313839839, 'recall': 0.4587237480824733, 'f1-score': 0.4194777811305288, 'support': 3088842}, 'weighted avg': {'precision': 0.5487941459957634, 'recall': 0.4876215746872129, 'f1-score': 0.43135032524223166, 'support': 3088842}}
[[ 266760  643584   58873]
 [  56742 1067512   33245]
 [ 153102  637110  171914]]
Evaluating performance on  train set...
2948/2948 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.981854
{'0': {'precision': 0.5499305043399331, 'recall': 0.32661837173061536, 'f1-score': 0.4098286149146774, 'support': 237430}, '1': {'precision': 0.4635834613982676, 'recall': 0.9024303277519469, 'f1-score': 0.61251471739575, 'support': 280456}, '2': {'precision': 0.6336586738547668, 'recall': 0.1808314595343962, 'f1-score': 0.28136724594314655, 'support': 236596}, 'accuracy': 0.4949422252618353, 'macro avg': {'precision': 0.5490575465309891, 'recall': 0.46996005300565286, 'f1-score': 0.43457019275119135, 'support': 754482}, 'weighted avg': {'precision': 0.5440896807275525, 'recall': 0.4949422252618353, 'f1-score': 0.44488722135491504, 'support': 754482}}
[[ 77549 144568  15313]
 [ 17942 253092   9422]
 [ 45525 148287  42784]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93064666
{'0': {'precision': 0.5612422360248447, 'recall': 0.27026380331399175, 'f1-score': 0.3648403117050914, 'support': 50151}, '1': {'precision': 0.5275954239281514, 'recall': 0.9310683153247211, 'f1-score': 0.6735306696270144, 'support': 79499}, '2': {'precision': 0.6268004299534217, 'recall': 0.17942564102564101, 'f1-score': 0.2789889163543577, 'support': 48750}, 'accuracy': 0.5399103139013453, 'macro avg': {'precision': 0.5718793633021392, 'recall': 0.4602525865547846, 'f1-score': 0.43911996589548785, 'support': 178400}, 'weighted avg': {'precision': 0.5641630546299069, 'recall': 0.5399103139013453, 'f1-score': 0.4789396348053531, 'support': 178400}}
[[13554 33639  2958]
 [ 3230 74019  2250]
 [ 7366 32637  8747]]
testing model on single stock: results/universal/W1/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
21353/21353 - 155s - 155s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1605366
{'0': {'precision': 0.4290699782631651, 'recall': 0.5171946064311483, 'f1-score': 0.4690288152566271, 'support': 2081961}, '1': {'precision': 0.2707433582398048, 'recall': 0.3389378378651391, 'f1-score': 0.3010267301809675, 'support': 1286941}, '2': {'precision': 0.4714423309883335, 'recall': 0.30245957331159123, 'f1-score': 0.3685021201769569, 'support': 2097315}, 'accuracy': 0.3928356667874693, 'macro avg': {'precision': 0.3904185558304345, 'recall': 0.3861973392026263, 'f1-score': 0.37951922187151715, 'support': 5466217}, 'weighted avg': {'precision': 0.40805199676998677, 'recall': 0.3928356667874693, 'f1-score': 0.3909044164520474, 'support': 5466217}}
[[1076779  588238  416944]
 [ 556487  436193  294261]
 [ 876299  586663  634353]]
Evaluating performance on  train set...
6073/6073 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1421825
{'0': {'precision': 0.4212987507031595, 'recall': 0.40059298652023506, 'f1-score': 0.4106850503974595, 'support': 519742}, '1': {'precision': 0.3895997284281748, 'recall': 0.5928630633674179, 'f1-score': 0.47020465387985594, 'support': 509126}, '2': {'precision': 0.46193895807875857, 'recall': 0.25097301430892205, 'f1-score': 0.32524131232489367, 'support': 525686}, 'accuracy': 0.4129673205305187, 'macro avg': {'precision': 0.4242791457366976, 'recall': 0.414809688065525, 'f1-score': 0.40204367220073634, 'support': 1554554}, 'weighted avg': {'precision': 0.4246599666143953, 'recall': 0.4129673205305187, 'f1-score': 0.4012845411518262, 'support': 1554554}}
[[208205 234095  77442]
 [131052 301842  76232]
 [154941 238812 131933]]
Evaluating performance on  val set...
1786/1786 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1579341
{'0': {'precision': 0.42794743729150925, 'recall': 0.4317108541256089, 'f1-score': 0.42982090795501876, 'support': 161358}, '1': {'precision': 0.34033330956431385, 'recall': 0.5031702762131389, 'f1-score': 0.4060340898733023, 'support': 132796}, '2': {'precision': 0.46610998960053834, 'recall': 0.28040530179895606, 'f1-score': 0.35015950459748546, 'support': 163039}, 'accuracy': 0.3985100384301597, 'macro avg': {'precision': 0.4114635788187871, 'recall': 0.4050954773792346, 'f1-score': 0.3953381674752688, 'support': 457193}, 'weighted avg': {'precision': 0.4161081892283306, 'recall': 0.3985100384301597, 'f1-score': 0.3945038540281466, 'support': 457193}}
[[69660 64206 27492]
 [41104 66819 24873]
 [52013 65309 45717]]
training model: results/universal/W1/deepVOL_L2/h100
Epoch 1/50
10622/10622 - 329s - loss: 3.1751 - accuracy100: 0.4273 - val_loss: 3.3860 - val_accuracy100: 0.3873 - 329s/epoch - 31ms/step
Epoch 2/50
10622/10622 - 329s - loss: 3.1348 - accuracy100: 0.4438 - val_loss: 3.4176 - val_accuracy100: 0.3865 - 329s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 327s - loss: 3.1223 - accuracy100: 0.4473 - val_loss: 3.4399 - val_accuracy100: 0.3876 - 327s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 328s - loss: 3.1126 - accuracy100: 0.4512 - val_loss: 3.4336 - val_accuracy100: 0.3883 - 328s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 329s - loss: 3.1055 - accuracy100: 0.4538 - val_loss: 3.4358 - val_accuracy100: 0.3889 - 329s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 327s - loss: 3.0996 - accuracy100: 0.4558 - val_loss: 3.4573 - val_accuracy100: 0.3843 - 327s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 329s - loss: 3.0952 - accuracy100: 0.4572 - val_loss: 3.4589 - val_accuracy100: 0.3856 - 329s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 333s - loss: 3.0912 - accuracy100: 0.4586 - val_loss: 3.4532 - val_accuracy100: 0.3876 - 333s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 329s - loss: 3.0871 - accuracy100: 0.4602 - val_loss: 3.4466 - val_accuracy100: 0.3893 - 329s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 335s - loss: 3.0848 - accuracy100: 0.4608 - val_loss: 3.4229 - val_accuracy100: 0.3914 - 335s/epoch - 32ms/step
Epoch 11/50
10622/10622 - 327s - loss: 3.0816 - accuracy100: 0.4616 - val_loss: 3.4256 - val_accuracy100: 0.3916 - 327s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 547s - 547s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1345438
{'0': {'precision': 0.3944251292545073, 'recall': 0.4916915532146663, 'f1-score': 0.4377200164873115, 'support': 3196506}, '1': {'precision': 0.3386877654335737, 'recall': 0.46092929786777337, 'f1-score': 0.3904646888678751, 'support': 2650797}, '2': {'precision': 0.40624737876306494, 'recall': 0.1846779380886507, 'f1-score': 0.2539235538717269, 'support': 3199478}, 'accuracy': 0.3740996935816176, 'macro avg': {'precision': 0.3797867578170486, 'recall': 0.37909959639036345, 'f1-score': 0.36070275307563787, 'support': 9046781}, 'weighted avg': {'precision': 0.38227457431222467, 'recall': 0.3740996935816176, 'f1-score': 0.35887241099050504, 'support': 9046781}}
[[1571695 1152528  472283]
 [1037657 1221830  391310]
 [1375422 1233183  590873]]
Evaluating performance on  train set...
10622/10622 - 170s - 170s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.126394
{'0': {'precision': 0.39265989478491803, 'recall': 0.41668274732425337, 'f1-score': 0.4043147987276373, 'support': 891340}, '1': {'precision': 0.38310443381071585, 'recall': 0.5766519245084731, 'f1-score': 0.4603624808103786, 'support': 936317}, '2': {'precision': 0.3898483305348344, 'recall': 0.15897949951563495, 'f1-score': 0.22585550178727054, 'support': 890857}, 'accuracy': 0.38733035768806046, 'macro avg': {'precision': 0.3885375530434894, 'recall': 0.3841047237827871, 'f1-score': 0.36351092710842886, 'support': 2718514}, 'weighted avg': {'precision': 0.3884474308262557, 'recall': 0.38733035768806046, 'f1-score': 0.365137764381028, 'support': 2718514}}
[[371406 411172 108762]
 [283488 539929 112900]
 [290978 458251 141628]]
Evaluating performance on  val set...
3064/3064 - 47s - 47s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1286877
{'0': {'precision': 0.3903670675011631, 'recall': 0.4424067951861017, 'f1-score': 0.4147609597690781, 'support': 259831}, '1': {'precision': 0.3816342481718528, 'recall': 0.520001667595214, 'f1-score': 0.44020084380063207, 'support': 263853}, '2': {'precision': 0.39634954388560156, 'recall': 0.19778618499465578, 'f1-score': 0.26388739272505296, 'support': 260094}, 'accuracy': 0.3873520308046411, 'macro avg': {'precision': 0.3894502865195391, 'recall': 0.38673154925865716, 'f1-score': 0.3729497320982544, 'support': 783778}, 'weighted avg': {'precision': 0.3894124931628143, 'recall': 0.3873520308046411, 'f1-score': 0.37325823855800677, 'support': 783778}}
[[114951 106432  38448]
 [ 86748 137204  39901]
 [ 92770 115881  51443]]
testing model out of sample: results/universal/W1/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 374s - 374s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920411
{'0': {'precision': 0.4235169019885442, 'recall': 0.3519585880663946, 'f1-score': 0.3844361627356692, 'support': 1983776}, '1': {'precision': 0.39308665466391285, 'recall': 0.7665837936909131, 'f1-score': 0.5196887778058352, 'support': 2128961}, '2': {'precision': 0.4754131830322179, 'recall': 0.07150562886019797, 'f1-score': 0.12431358323009824, 'support': 1986459}, 'accuracy': 0.4053447372407773, 'macro avg': {'precision': 0.4306722465615583, 'recall': 0.39668267020583525, 'f1-score': 0.3428128412572009, 'support': 6099196}, 'weighted avg': {'precision': 0.4297972420155315, 'recall': 0.4053447372407773, 'f1-score': 0.34692707194244643, 'support': 6099196}}
[[ 698207 1193051   92518]
 [ 432717 1632027   64217]
 [ 517669 1326747  142043]]
Evaluating performance on  train set...
6711/6711 - 106s - 106s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0809494
{'0': {'precision': 0.42941392639640297, 'recall': 0.3930552657519265, 'f1-score': 0.41043094761141374, 'support': 555932}, '1': {'precision': 0.4095655516144321, 'recall': 0.7521224226549698, 'f1-score': 0.5303376495913158, 'support': 607796}, '2': {'precision': 0.47875707194416145, 'recall': 0.0797994761087526, 'f1-score': 0.13679747791940738, 'support': 553550}, 'accuracy': 0.41916451500572416, 'macro avg': {'precision': 0.4392455166516655, 'recall': 0.4083257215052163, 'f1-score': 0.359188691707379, 'support': 1717278}, 'weighted avg': {'precision': 0.4382943379657464, 'recall': 0.41916451500572416, 'f1-score': 0.3646660840823674, 'support': 1717278}}
[[218512 309222  28198]
 [130764 457137  19895]
 [159585 349792  44173]]
Evaluating performance on  val set...
1720/1720 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.065283
{'0': {'precision': 0.42726362710791316, 'recall': 0.3649524616879937, 'f1-score': 0.3936575252839767, 'support': 136837}, '1': {'precision': 0.43815998217320595, 'recall': 0.7811886648126516, 'f1-score': 0.5614236950101639, 'support': 168643}, '2': {'precision': 0.4641047486659791, 'recall': 0.077024402223661, 'f1-score': 0.13212147516499229, 'support': 134373}, 'accuracy': 0.4365799483009096, 'macro avg': {'precision': 0.4431761193156994, 'recall': 0.40772184290810215, 'f1-score': 0.36240089848637763, 'support': 439853}, 'weighted avg': {'precision': 0.4426961603278711, 'recall': 0.4365799483009096, 'f1-score': 0.3780823365243117, 'support': 439853}}
[[ 49939  80220   6678]
 [ 31628 131742   5273]
 [ 35314  88709  10350]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1952156
{'0': {'precision': 0.33176436436021317, 'recall': 0.8590911531508958, 'f1-score': 0.4786740728182933, 'support': 55873}, '1': {'precision': 0.4025278269010715, 'recall': 0.12911675397911174, 'f1-score': 0.195518164822394, 'support': 59938}, '2': {'precision': 0.35789655768898115, 'recall': 0.03840228669005327, 'f1-score': 0.06936203023902913, 'support': 53877}, 'accuracy': 0.34067229267832727, 'macro avg': {'precision': 0.36406291631675525, 'recall': 0.34220339794002025, 'f1-score': 0.24785142262657212, 'support': 169688}, 'weighted avg': {'precision': 0.3650569047740786, 'recall': 0.34067229267832727, 'f1-score': 0.2486972699123646, 'support': 169688}}
[[48000  5986  1887]
 [50374  7739  1825]
 [46307  5501  2069]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.192599
{'0': {'precision': 0.3349369768113153, 'recall': 0.7946400036524677, 'f1-score': 0.4712460063897764, 'support': 21903}, '1': {'precision': 0.3187314906219151, 'recall': 0.11815021498490531, 'f1-score': 0.17239538143228994, 'support': 21862}, '2': {'precision': 0.38797644871397585, 'recall': 0.1100272431672379, 'f1-score': 0.17143639600164318, 'support': 22758}, 'accuracy': 0.33810862408490294, 'macro avg': {'precision': 0.34721497204906876, 'recall': 0.3409391539348703, 'f1-score': 0.2716925946079032, 'support': 66523}, 'weighted avg': {'precision': 0.34775642215334857, 'recall': 0.33810862408490294, 'f1-score': 0.27046523167977077, 'support': 66523}}
[[17405  2651  1847]
 [17176  2583  2103]
 [17384  2870  2504]]
Evaluating performance on  val set...
51/51 - 0s - 499ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2325948
{'0': {'precision': 0.27238261883931175, 'recall': 0.8128807658833769, 'f1-score': 0.4080384447356924, 'support': 3447}, '1': {'precision': 0.5132858068697342, 'recall': 0.12936948709572035, 'f1-score': 0.2066536203522505, 'support': 6122}, '2': {'precision': 0.2723697148475909, 'recall': 0.08450274557657109, 'f1-score': 0.1289871944121071, 'support': 3278}, 'accuracy': 0.3013154822137464, 'macro avg': {'precision': 0.3526793801855457, 'recall': 0.3422509995185561, 'f1-score': 0.24789308650001662, 'support': 12847}, 'weighted avg': {'precision': 0.3871772804597201, 'recall': 0.3013154822137464, 'f1-score': 0.24087039823175033, 'support': 12847}}
[[2802  387  258]
 [4848  792  482]
 [2637  364  277]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97347623
{'0': {'precision': 0.48952665384772737, 'recall': 0.22694813508207914, 'f1-score': 0.3101216201330888, 'support': 105447}, '1': {'precision': 0.5628793955686597, 'recall': 0.9606458356458356, 'f1-score': 0.7098376006452229, 'support': 216216}, '2': {'precision': 0.689987163029525, 'recall': 0.021641317805268404, 'f1-score': 0.04196636834759865, 'support': 99347}, 'accuracy': 0.5553027244008456, 'macro avg': {'precision': 0.5807977374819707, 'recall': 0.40307842951106104, 'f1-score': 0.35397519637530345, 'support': 421010}, 'weighted avg': {'precision': 0.5745013257310964, 'recall': 0.5553027244008456, 'f1-score': 0.452124353187597, 'support': 421010}}
[[ 23931  80747    769]
 [  8312 207707    197]
 [ 16643  80554   2150]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0283487
{'0': {'precision': 0.5210915789802354, 'recall': 0.32413377874456184, 'f1-score': 0.39966473088666704, 'support': 51488}, '1': {'precision': 0.4589823943393493, 'recall': 0.933343670051942, 'f1-score': 0.6153563067990145, 'support': 64495}, '2': {'precision': 0.574331550802139, 'recall': 0.042171394915087854, 'f1-score': 0.07857338820301783, 'support': 50935}, 'accuracy': 0.4734839861488875, 'macro avg': {'precision': 0.5181351747072412, 'recall': 0.4332162812371972, 'f1-score': 0.36453147529623314, 'support': 166918}, 'weighted avg': {'precision': 0.5133395456544989, 'recall': 0.4734839861488875, 'f1-score': 0.38502425262114254, 'support': 166918}}
[[16689 33509  1290]
 [ 3997 60196   302]
 [11341 37446  2148]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0231762
{'0': {'precision': 0.5276747881355932, 'recall': 0.280989987307855, 'f1-score': 0.36670654274408765, 'support': 14182}, '1': {'precision': 0.4737175762058218, 'recall': 0.941812834786262, 'f1-score': 0.6303690685413005, 'support': 19042}, '2': {'precision': 0.5909090909090909, 'recall': 0.0397979488749426, 'f1-score': 0.07457335436684354, 'support': 13066}, 'accuracy': 0.48474832577230503, 'macro avg': {'precision': 0.5307671517501685, 'recall': 0.4208669236563532, 'f1-score': 0.3572163218840772, 'support': 46290}, 'weighted avg': {'precision': 0.5233275461928801, 'recall': 0.48474832577230503, 'f1-score': 0.39270890992692314, 'support': 46290}}
[[ 3985  9915   282]
 [ 1030 17934    78]
 [ 2537 10009   520]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1931027
{'0': {'precision': 0.3740988051645274, 'recall': 0.4803312292574998, 'f1-score': 0.42061100782813715, 'support': 122936}, '1': {'precision': 0.2733880968203835, 'recall': 0.42887236146339364, 'f1-score': 0.3339177004665174, 'support': 93044}, '2': {'precision': 0.3544888779345616, 'recall': 0.09565614997713763, 'f1-score': 0.15065829530649522, 'support': 120285}, 'accuracy': 0.32849092233803695, 'macro avg': {'precision': 0.3339919266398242, 'recall': 0.3349532468993437, 'f1-score': 0.30172900120038326, 'support': 336265}, 'weighted avg': {'precision': 0.33921766307709944, 'recall': 0.32849092233803695, 'f1-score': 0.30005860387345784, 'support': 336265}}
[[59050 52380 11506]
 [43694 39904  9446]
 [55102 53677 11506]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.164869
{'0': {'precision': 0.3627901254818338, 'recall': 0.393663648296883, 'f1-score': 0.37759685869460835, 'support': 44947}, '1': {'precision': 0.3569915662186621, 'recall': 0.6198181331906927, 'f1-score': 0.4530459643721134, 'support': 44868}, '2': {'precision': 0.3891082368958475, 'recall': 0.06465624505124086, 'f1-score': 0.11088694032746177, 'support': 44203}, 'accuracy': 0.3608619737647182, 'macro avg': {'precision': 0.36962997619878113, 'recall': 0.3593793421796055, 'f1-score': 0.3138432544647278, 'support': 134018}, 'weighted avg': {'precision': 0.36952929277140434, 'recall': 0.3608619737647182, 'f1-score': 0.314887908792023, 'support': 134018}}
[[17694 25140  2113]
 [14684 27810  2374]
 [16394 24951  2858]]
Evaluating performance on  val set...
107/107 - 1s - 897ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.167503
{'0': {'precision': 0.4053916149332426, 'recall': 0.4738097604611868, 'f1-score': 0.4369385884509624, 'support': 10061}, '1': {'precision': 0.29143027769483426, 'recall': 0.5338438397374539, 'f1-score': 0.3770341397460041, 'support': 7313}, '2': {'precision': 0.42133995037220845, 'recall': 0.08666802776643528, 'f1-score': 0.14376428752857506, 'support': 9796}, 'accuracy': 0.35038645564961357, 'macro avg': {'precision': 0.37272061433342846, 'recall': 0.3647738759883587, 'f1-score': 0.31924567190851383, 'support': 27170}, 'weighted avg': {'precision': 0.3804681933188012, 'recall': 0.35038645564961357, 'f1-score': 0.3151124314684425, 'support': 27170}}
[[4767 4650  644]
 [2887 3904  522]
 [4105 4842  849]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1304/1304 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2240957
{'0': {'precision': 0.33803099047933677, 'recall': 0.8492980132450331, 'f1-score': 0.4835880328515872, 'support': 113250}, '1': {'precision': 0.30421674391894665, 'recall': 0.13816261328812676, 'f1-score': 0.19002414855525024, 'support': 107359}, '2': {'precision': 0.32432432432432434, 'recall': 0.0012728494148428384, 'f1-score': 0.0025357469888004506, 'support': 113132}, 'accuracy': 0.3330726521464249, 'macro avg': {'precision': 0.3221906862408693, 'recall': 0.3295778253160009, 'f1-score': 0.22538264279854595, 'support': 333741}, 'weighted avg': {'precision': 0.3225071973225901, 'recall': 0.3330726521464249, 'f1-score': 0.22608556159873175, 'support': 333741}}
[[96183 16950   117]
 [92343 14833   183]
 [96013 16975   144]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2198107
{'0': {'precision': 0.3345670852610707, 'recall': 0.8415246040382057, 'f1-score': 0.47878313657039184, 'support': 33084}, '1': {'precision': 0.31288715324535415, 'recall': 0.1446176827560452, 'f1-score': 0.19780781100351175, 'support': 32133}, '2': {'precision': 0.22905027932960895, 'recall': 0.0012413333737018983, 'f1-score': 0.002469284509756685, 'support': 33029}, 'accuracy': 0.33109744926002077, 'macro avg': {'precision': 0.2921681726120113, 'recall': 0.3291278733893176, 'f1-score': 0.22635341069455342, 'support': 98246}, 'weighted avg': {'precision': 0.2920029519775653, 'recall': 0.33109744926002077, 'f1-score': 0.22675506055557926, 'support': 98246}}
[[27841  5188    55]
 [27403  4647    83]
 [27971  5017    41]]
Evaluating performance on  val set...
93/93 - 1s - 805ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.240824
{'0': {'precision': 0.3314473620581266, 'recall': 0.8736775015933715, 'f1-score': 0.4805777590800729, 'support': 7845}, '1': {'precision': 0.27078965758211043, 'recall': 0.10239133306909763, 'f1-score': 0.14859553254721503, 'support': 7569}, '2': {'precision': 0.3968253968253968, 'recall': 0.0030525030525030525, 'f1-score': 0.006058403004967891, 'support': 8190}, 'accuracy': 0.3242670733773937, 'macro avg': {'precision': 0.3330208054885446, 'recall': 0.32637377923832406, 'f1-score': 0.2117438982107519, 'support': 23604}, 'weighted avg': {'precision': 0.33468104870297394, 'recall': 0.3242670733773937, 'f1-score': 0.20947595434857352, 'support': 23604}}
[[6854  978   13]
 [6769  775   25]
 [7056 1109   25]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1988459
{'0': {'precision': 0.35321459644466413, 'recall': 0.45344905516054446, 'f1-score': 0.3971043562159477, 'support': 230092}, '1': {'precision': 0.31010783441070466, 'recall': 0.5084478130427917, 'f1-score': 0.3852484573384284, 'support': 208989}, '2': {'precision': 0.37461564742056713, 'recall': 0.04804342968308424, 'f1-score': 0.08516471780692113, 'support': 228231}, 'accuracy': 0.33201860598940225, 'macro avg': {'precision': 0.345979359425312, 'recall': 0.33664676596214016, 'f1-score': 0.28917251045376574, 'support': 667312}, 'weighted avg': {'precision': 0.34703389562490694, 'recall': 0.33201860598940225, 'f1-score': 0.28670315248479283, 'support': 667312}}
[[104335 117035   8722]
 [ 93146 106260   9583]
 [ 97906 119360  10965]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1968641
{'0': {'precision': 0.34531493286134435, 'recall': 0.4212679600616933, 'f1-score': 0.37952873378285484, 'support': 61595}, '1': {'precision': 0.3263565422539471, 'recall': 0.5314660055494442, 'f1-score': 0.40438994834252584, 'support': 60907}, '2': {'precision': 0.3760023186165588, 'recall': 0.06259448679597285, 'f1-score': 0.10732258820609686, 'support': 62178}, 'accuracy': 0.3368529348061512, 'macro avg': {'precision': 0.3492245979106168, 'recall': 0.3384428174690368, 'f1-score': 0.29708042344382585, 'support': 184680}, 'weighted avg': {'precision': 0.3493943219384668, 'recall': 0.3368529348061512, 'f1-score': 0.2960816267626806, 'support': 184680}}
[[25948 32719  2928]
 [25006 32370  3531]
 [24189 34097  3892]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.194917
{'0': {'precision': 0.36651873175802646, 'recall': 0.4569790628115653, 'f1-score': 0.4067804131259568, 'support': 20060}, '1': {'precision': 0.30938792249068725, 'recall': 0.4968988418683792, 'f1-score': 0.38133951137320976, 'support': 18219}, '2': {'precision': 0.3722627737226277, 'recall': 0.0720157345302335, 'f1-score': 0.12068455525036975, 'support': 19829}, 'accuracy': 0.33812900117023476, 'macro avg': {'precision': 0.34938980932378055, 'recall': 0.3419645464033927, 'f1-score': 0.3029348265831788, 'support': 58108}, 'weighted avg': {'precision': 0.3505662363025715, 'recall': 0.33812900117023476, 'f1-score': 0.30117528896321993, 'support': 58108}}
[[ 9167  9732  1161]
 [ 7919  9053  1247]
 [ 7925 10476  1428]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
5343/5343 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0684764
{'0': {'precision': 0.5695712778982069, 'recall': 0.2330268664483813, 'f1-score': 0.33073938942551095, 'support': 461170}, '1': {'precision': 0.3667403052333257, 'recall': 0.9422612478969553, 'f1-score': 0.5279828382737918, 'support': 442216}, '2': {'precision': 0.6478850274853256, 'recall': 0.05989410059797202, 'f1-score': 0.10965141376013875, 'support': 464403}, 'accuracy': 0.4035439676733765, 'macro avg': {'precision': 0.5280655368722861, 'recall': 0.4117274049811029, 'f1-score': 0.32279121381981385, 'support': 1367789}, 'weighted avg': {'precision': 0.5305842987965572, 'recall': 0.4035439676733765, 'f1-score': 0.31944399942966034, 'support': 1367789}}
[[107465 341866  11839]
 [ 22255 416683   3278]
 [ 58957 377631  27815]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0200286
{'0': {'precision': 0.5400777320530407, 'recall': 0.24224742606341523, 'f1-score': 0.33447074814521155, 'support': 97516}, '1': {'precision': 0.4533076378227369, 'recall': 0.946588383686708, 'f1-score': 0.6130394509397769, 'support': 133192}, '2': {'precision': 0.6630958112662494, 'recall': 0.05538408951532638, 'f1-score': 0.10222960371878972, 'support': 99469}, 'accuracy': 0.47008119887212013, 'macro avg': {'precision': 0.552160393714009, 'recall': 0.41473996642181654, 'f1-score': 0.34991326760125935, 'support': 330177}, 'weighted avg': {'precision': 0.5421354251404938, 'recall': 0.47008119887212013, 'f1-score': 0.3768792995211765, 'support': 330177}}
[[ 23623  71752   2141]
 [  6456 126078    658]
 [ 13661  80299   5509]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0059079
{'0': {'precision': 0.5189902206049579, 'recall': 0.25326477007879844, 'f1-score': 0.34041072050121823, 'support': 27031}, '1': {'precision': 0.4754915967477985, 'recall': 0.9308415967454869, 'f1-score': 0.629448780991025, 'support': 39330}, '2': {'precision': 0.6314403911244829, 'recall': 0.06339916172639051, 'f1-score': 0.11522887928076317, 'support': 26483}, 'accuracy': 0.4861380379992245, 'macro avg': {'precision': 0.5419740694924131, 'recall': 0.41583517618355864, 'f1-score': 0.36169612692433545, 'support': 92844}, 'weighted avg': {'precision': 0.5326391046423379, 'recall': 0.4861380379992245, 'f1-score': 0.3986199339993741, 'support': 92844}}
[[ 6846 19439   746]
 [ 2486 36610   234]
 [ 3859 20945  1679]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
7177/7177 - 67s - 67s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0488104
{'0': {'precision': 0.498290204157409, 'recall': 0.2878005416754582, 'f1-score': 0.36486421301432637, 'support': 578206}, '1': {'precision': 0.4258323223694355, 'recall': 0.8988481014845924, 'f1-score': 0.57788817230188, 'support': 694332}, '2': {'precision': 0.5946233980763594, 'recall': 0.039532300890442136, 'f1-score': 0.07413583486689564, 'support': 564551}, 'accuracy': 0.4424527064284855, 'macro avg': {'precision': 0.5062486415344013, 'recall': 0.4087269813501642, 'f1-score': 0.338962740061034, 'support': 1837089}, 'weighted avg': {'precision': 0.500508482630869, 'recall': 0.4424527064284855, 'f1-score': 0.3560341318851789, 'support': 1837089}}
[[166408 400644  11154]
 [ 66172 624099   4061]
 [101378 440855  22318]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0148603
{'0': {'precision': 0.5072006831206792, 'recall': 0.35259333671995846, 'f1-score': 0.41599633661399427, 'support': 175199}, '1': {'precision': 0.4668379994996475, 'recall': 0.8885772046250482, 'f1-score': 0.6120952507331969, 'support': 231003}, '2': {'precision': 0.5812566030700391, 'recall': 0.05457685866501724, 'f1-score': 0.09978449195578884, 'support': 171373}, 'accuracy': 0.47853698653854476, 'macro avg': {'precision': 0.5184317618967885, 'recall': 0.43191580000334134, 'f1-score': 0.37595869310099334, 'support': 577575}, 'weighted avg': {'precision': 0.5130307210637557, 'recall': 0.47853698653854476, 'f1-score': 0.4006031236177038, 'support': 577575}}
[[ 61774 108522   4903]
 [ 23904 205264   1835]
 [ 36116 125904   9353]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.00496
{'0': {'precision': 0.511270421175984, 'recall': 0.3105296211011095, 'f1-score': 0.386382579704105, 'support': 47770}, '1': {'precision': 0.4846565888672851, 'recall': 0.919930564672589, 'f1-score': 0.6348490491961706, 'support': 68553}, '2': {'precision': 0.6043405676126878, 'recall': 0.05390915860014892, 'f1-score': 0.09898824172819251, 'support': 47005}, 'accuracy': 0.49245689655172414, 'macro avg': {'precision': 0.533422525885319, 'recall': 0.4281231147912825, 'f1-score': 0.37340662354282267, 'support': 163328}, 'weighted avg': {'precision': 0.5268850383083742, 'recall': 0.49245689655172414, 'f1-score': 0.4079597191200765, 'support': 163328}}
[[14834 31681  1255]
 [ 5085 63064   404]
 [ 9095 35376  2534]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
5696/5696 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.131632
{'0': {'precision': 0.43241270402645093, 'recall': 0.3830762757095574, 'f1-score': 0.40625208272360847, 'support': 548969}, '1': {'precision': 0.2902493339353722, 'recall': 0.6796993938051873, 'f1-score': 0.4067891233545711, 'support': 361270}, '2': {'precision': 0.460780101212642, 'recall': 0.10571483337440785, 'f1-score': 0.17197432368021312, 'support': 547785}, 'accuracy': 0.3523679994293647, 'macro avg': {'precision': 0.3944807130581551, 'recall': 0.3894968342963842, 'f1-score': 0.3283385099194642, 'support': 1458024}, 'weighted avg': {'precision': 0.40784512074581475, 'recall': 0.3523679994293647, 'f1-score': 0.3183661318964352, 'support': 1458024}}
[[210297 293066  45606]
 [ 93554 245555  22161]
 [182483 307393  57909]]
Evaluating performance on  train set...
2222/2222 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0874721
{'0': {'precision': 0.4446623165844126, 'recall': 0.35067811840427976, 'f1-score': 0.3921172309247094, 'support': 191412}, '1': {'precision': 0.3885658367193881, 'recall': 0.8055515620091266, 'f1-score': 0.5242530040111236, 'support': 187803}, '2': {'precision': 0.48382882564790625, 'recall': 0.07234799687440603, 'f1-score': 0.12587380469029882, 'support': 189404}, 'accuracy': 0.40820303225885873, 'macro avg': {'precision': 0.4390189929839023, 'recall': 0.4095258924292708, 'f1-score': 0.3474146798753773, 'support': 568619}, 'weighted avg': {'precision': 0.4391809771894412, 'recall': 0.40820303225885873, 'f1-score': 0.3470746359541677, 'support': 568619}}
[[ 67124 114835   9453]
 [ 31352 151285   5166]
 [ 52479 123222  13703]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904441
{'0': {'precision': 0.43838220348552714, 'recall': 0.4077406480298283, 'f1-score': 0.4225065979811538, 'support': 57127}, '1': {'precision': 0.37929971287071473, 'recall': 0.766949812967581, 'f1-score': 0.5075750738166768, 'support': 51328}, '2': {'precision': 0.49906164284683124, 'recall': 0.06240973425765454, 'f1-score': 0.11094529758179689, 'support': 55392}, 'accuracy': 0.4035227987085513, 'macro avg': {'precision': 0.43891451973435774, 'recall': 0.412366731751688, 'f1-score': 0.34700898979320915, 'support': 163847}, 'weighted avg': {'precision': 0.44038754643855194, 'recall': 0.4035227987085513, 'f1-score': 0.3438258236976121, 'support': 163847}}
[[23293 31517  2317]
 [10809 39366  1153]
 [19032 32903  3457]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
12066/12066 - 111s - 111s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0780188
{'0': {'precision': 0.4468030836691258, 'recall': 0.32163336072457355, 'f1-score': 0.3740238465550374, 'support': 996669}, '1': {'precision': 0.39206764118002974, 'recall': 0.796197856166644, 'f1-score': 0.5254102152707372, 'support': 1072658}, '2': {'precision': 0.49240937084017466, 'recall': 0.09324826020215495, 'f1-score': 0.15680259149484324, 'support': 1019515}, 'accuracy': 0.41105307425889703, 'macro avg': {'precision': 0.4437600318964434, 'recall': 0.4036931590311241, 'f1-score': 0.3520788844402059, 'support': 3088842}, 'weighted avg': {'precision': 0.4428481658053189, 'recall': 0.41105307425889703, 'f1-score': 0.3548987089277813, 'support': 3088842}}
[[320562 616989  59118]
 [179729 854048  38881]
 [217166 707281  95068]]
Evaluating performance on  train set...
2948/2948 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0785991
{'0': {'precision': 0.4522024478492406, 'recall': 0.37798072044647385, 'f1-score': 0.4117737230847621, 'support': 252288}, '1': {'precision': 0.3850191227927415, 'recall': 0.7596044245372378, 'f1-score': 0.5110190680368724, 'support': 249156}, '2': {'precision': 0.49001786983840284, 'recall': 0.10078328156245307, 'f1-score': 0.16718183039913992, 'support': 253038}, 'accuracy': 0.41103962718792497, 'macro avg': {'precision': 0.44241314682679495, 'recall': 0.4127894755153882, 'f1-score': 0.36332487384025813, 'support': 754482}, 'weighted avg': {'precision': 0.44269872239457975, 'recall': 0.41103962718792497, 'f1-score': 0.36251678895711364, 'support': 754482}}
[[ 95360 140542  16386]
 [ 49741 189260  10155]
 [ 65778 161758  25502]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0506133
{'0': {'precision': 0.451803709653863, 'recall': 0.33443845835060093, 'f1-score': 0.38436131330178813, 'support': 55499}, '1': {'precision': 0.4354958749663505, 'recall': 0.8037290315038869, 'f1-score': 0.5649025870656985, 'support': 68436}, '2': {'precision': 0.4822984749455338, 'recall': 0.09754888460479207, 'f1-score': 0.16227608008429925, 'support': 54465}, 'accuracy': 0.44214125560538114, 'macro avg': {'precision': 0.45653268652191575, 'recall': 0.41190545815309326, 'f1-score': 0.37051332681726196, 'support': 178400}, 'weighted avg': {'precision': 0.4548578263407253, 'recall': 0.44214125560538114, 'f1-score': 0.38581675267463805, 'support': 178400}}
[[18561 33617  3321]
 [11050 55004  2382]
 [11471 37681  5313]]
testing model on single stock: results/universal/W1/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
21353/21353 - 169s - 169s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1587393
{'0': {'precision': 0.3809971253372446, 'recall': 0.5763735789029665, 'f1-score': 0.4587495224363402, 'support': 1967670}, '1': {'precision': 0.2792649453438311, 'recall': 0.22128177059543122, 'f1-score': 0.24691498157154146, 'support': 1523736}, '2': {'precision': 0.3921315224224235, 'recall': 0.2545929711754695, 'f1-score': 0.30873712182967883, 'support': 1974811}, 'accuracy': 0.3611384253497437, 'macro avg': {'precision': 0.3507978643678331, 'recall': 0.35074944022462234, 'f1-score': 0.33813387527918687, 'support': 5466217}, 'weighted avg': {'precision': 0.35666134518576786, 'recall': 0.3611384253497437, 'f1-score': 0.3455037338381915, 'support': 5466217}}
[[1134113  419566  413991]
 [ 821171  337175  365390]
 [1021413  450625  502773]]
Evaluating performance on  train set...
6073/6073 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1680222
{'0': {'precision': 0.37086604384900684, 'recall': 0.45513092847211495, 'f1-score': 0.4087003040736505, 'support': 517840}, '1': {'precision': 0.3317812640101822, 'recall': 0.3809413642725769, 'f1-score': 0.35466590321859776, 'support': 518694}, '2': {'precision': 0.37243204144590825, 'recall': 0.23258561445504033, 'f1-score': 0.28634647057844914, 'support': 518020}, 'accuracy': 0.3562185681552394, 'macro avg': {'precision': 0.35835978310169914, 'recall': 0.35621930239991073, 'f1-score': 0.34990422595689913, 'support': 1554554}, 'weighted avg': {'precision': 0.3583468115041848, 'recall': 0.3562185681552394, 'f1-score': 0.34989948252335706, 'support': 1554554}}
[[235685 185918  96237]
 [214317 197592 106785]
 [185497 212039 120484]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.172461
{'0': {'precision': 0.3706826706676669, 'recall': 0.48239459536857454, 'f1-score': 0.41922419936877114, 'support': 153646}, '1': {'precision': 0.307366773431499, 'recall': 0.28936309556295364, 'f1-score': 0.2980933439219627, 'support': 146584}, '2': {'precision': 0.38568493437879997, 'recall': 0.29300535795059984, 'f1-score': 0.33301714649829117, 'support': 156963}, 'accuracy': 0.3554844452999062, 'macro avg': {'precision': 0.35457812615932194, 'recall': 0.35492101629404266, 'f1-score': 0.3501115632630083, 'support': 457193}, 'weighted avg': {'precision': 0.3555330573499305, 'recall': 0.3554844452999062, 'f1-score': 0.3507910366682834, 'support': 457193}}
[[74118 44586 34942]
 [65856 42416 38312]
 [59976 50996 45991]]
training model: results/universal/W1/deepVOL_L2/h200
Epoch 1/50
10622/10622 - 334s - loss: 3.2609 - accuracy200: 0.3833 - val_loss: 3.2822 - val_accuracy200: 0.3753 - 334s/epoch - 31ms/step
Epoch 2/50
10622/10622 - 328s - loss: 3.2416 - accuracy200: 0.3951 - val_loss: 3.2803 - val_accuracy200: 0.3770 - 328s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 330s - loss: 3.2310 - accuracy200: 0.4005 - val_loss: 3.3007 - val_accuracy200: 0.3742 - 330s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 328s - loss: 3.2252 - accuracy200: 0.4032 - val_loss: 3.3449 - val_accuracy200: 0.3691 - 328s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 336s - loss: 3.2198 - accuracy200: 0.4056 - val_loss: 3.3565 - val_accuracy200: 0.3772 - 336s/epoch - 32ms/step
Epoch 6/50
10622/10622 - 339s - loss: 3.2166 - accuracy200: 0.4073 - val_loss: 3.3415 - val_accuracy200: 0.3808 - 339s/epoch - 32ms/step
Epoch 7/50
10622/10622 - 335s - loss: 3.2149 - accuracy200: 0.4083 - val_loss: 3.3660 - val_accuracy200: 0.3796 - 335s/epoch - 32ms/step
Epoch 8/50
10622/10622 - 333s - loss: 3.2125 - accuracy200: 0.4096 - val_loss: 3.4318 - val_accuracy200: 0.3771 - 333s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 332s - loss: 3.2101 - accuracy200: 0.4107 - val_loss: 3.4442 - val_accuracy200: 0.3780 - 332s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 334s - loss: 3.2085 - accuracy200: 0.4115 - val_loss: 3.4308 - val_accuracy200: 0.3780 - 334s/epoch - 31ms/step
Epoch 11/50
10622/10622 - 328s - loss: 3.2072 - accuracy200: 0.4122 - val_loss: 3.4350 - val_accuracy200: 0.3787 - 328s/epoch - 31ms/step
Epoch 12/50
10622/10622 - 328s - loss: 3.2068 - accuracy200: 0.4126 - val_loss: 3.4102 - val_accuracy200: 0.3808 - 328s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 546s - 546s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927763
{'0': {'precision': 0.38268285832456483, 'recall': 0.6523208887248688, 'f1-score': 0.482378972933574, 'support': 3235377}, '1': {'precision': 0.29917068033119254, 'recall': 0.08678301296434611, 'f1-score': 0.13453910912495595, 'support': 2575988}, '2': {'precision': 0.3976773743132122, 'recall': 0.3422561426413172, 'f1-score': 0.36789122543973474, 'support': 3235416}, 'accuracy': 0.3804001666449094, 'macro avg': {'precision': 0.3598436376563232, 'recall': 0.36045334811017743, 'f1-score': 0.32826976916608824, 'support': 9046781}, 'weighted avg': {'precision': 0.3642660456015791, 'recall': 0.3804001666449094, 'f1-score': 0.34239030678390575, 'support': 9046781}}
[[2110504  245117  879756]
 [1555012  223552  797424]
 [1849505  278570 1107341]]
Evaluating performance on  train set...
10622/10622 - 167s - 167s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934573
{'0': {'precision': 0.36997157060290375, 'recall': 0.6266648551756782, 'f1-score': 0.465261302344764, 'support': 912692}, '1': {'precision': 0.3451876098489124, 'recall': 0.09604858176075233, 'f1-score': 0.15028132776878825, 'support': 891528}, '2': {'precision': 0.385255556721337, 'recall': 0.3895606883562618, 'f1-score': 0.3873961621814167, 'support': 914294}, 'accuracy': 0.3729077724080141, 'macro avg': {'precision': 0.36680491239105106, 'recall': 0.37075804176423083, 'f1-score': 0.3343129307649897, 'support': 2718514}, 'weighted avg': {'precision': 0.3669840788486154, 'recall': 0.3729077724080141, 'f1-score': 0.33577692329272385, 'support': 2718514}}
[[571952  73515 267225]
 [504785  85630 301113]
 [469198  88923 356173]]
Evaluating performance on  val set...
3064/3064 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934418
{'0': {'precision': 0.37519885476874726, 'recall': 0.6476139872404145, 'f1-score': 0.4751290096583459, 'support': 269131}, '1': {'precision': 0.32822181607453305, 'recall': 0.08994295347104309, 'f1-score': 0.14119429316560558, 'support': 245589}, '2': {'precision': 0.39370653796081667, 'recall': 0.36866400553040607, 'f1-score': 0.38077397015750425, 'support': 269058}, 'accuracy': 0.37711443801688743, 'macro avg': {'precision': 0.3657090696013657, 'recall': 0.3687403154139546, 'f1-score': 0.33236575766048526, 'support': 783778}, 'weighted avg': {'precision': 0.3668324503384347, 'recall': 0.37711443801688743, 'f1-score': 0.33810338338821194, 'support': 783778}}
[[174293  20454  74384]
 [145132  22089  78368]
 [145110  24756  99192]]
testing model out of sample: results/universal/W1/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 369s - 369s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904691
{'0': {'precision': 0.3782671538523295, 'recall': 0.6433222903889455, 'f1-score': 0.47640995737954267, 'support': 2058026}, '1': {'precision': 0.3583561735131668, 'recall': 0.08679422690064144, 'f1-score': 0.13974264431182856, 'support': 1982436}, '2': {'precision': 0.38945654559226406, 'recall': 0.40084683111077, 'f1-score': 0.3950696068319275, 'support': 2058734}, 'accuracy': 0.38058704786663683, 'macro avg': {'precision': 0.3753599576525868, 'recall': 0.37698778280011896, 'f1-score': 0.33707406950776625, 'support': 6099196}, 'weighted avg': {'precision': 0.3755723293204853, 'recall': 0.38058704786663683, 'f1-score': 0.33952641622215063, 'support': 6099196}}
[[1323974  138399  595653]
 [1112317  172064  698055]
 [1063812  169685  825237]]
Evaluating performance on  train set...
6711/6711 - 109s - 109s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876069
{'0': {'precision': 0.38080251929697995, 'recall': 0.6517098648650992, 'f1-score': 0.48071628427532176, 'support': 576683}, '1': {'precision': 0.3761937812326485, 'recall': 0.0956660636279398, 'f1-score': 0.1525409657287995, 'support': 566575}, '2': {'precision': 0.3934100461231953, 'recall': 0.40179610466534266, 'f1-score': 0.397558856685823, 'support': 574020}, 'accuracy': 0.38471988810198465, 'macro avg': {'precision': 0.38346878221760794, 'recall': 0.3830573443861272, 'f1-score': 0.34360536889664806, 'support': 1717278}, 'weighted avg': {'precision': 0.3834961872878268, 'recall': 0.38471988810198465, 'f1-score': 0.3446463190801583, 'support': 1717278}}
[[375830  40523 160330]
 [317086  54202 195287]
 [294026  49355 230639]]
Evaluating performance on  val set...
1720/1720 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0855979
{'0': {'precision': 0.390195823936921, 'recall': 0.6463884969428206, 'f1-score': 0.4866330448330458, 'support': 148830}, '1': {'precision': 0.3854332218994903, 'recall': 0.09573396493520636, 'f1-score': 0.1533730959208819, 'support': 146928}, '2': {'precision': 0.3881551676859404, 'recall': 0.42240882750962905, 'f1-score': 0.4045582341329185, 'support': 144095}, 'accuracy': 0.389073167626457, 'macro avg': {'precision': 0.38792807117411715, 'recall': 0.388177096462552, 'f1-score': 0.3481881249622821, 'support': 439853}, 'weighted avg': {'precision': 0.387936414646452, 'recall': 0.389073167626457, 'f1-score': 0.3484237166674967, 'support': 439853}}
[[96202 10080 42548]
 [79466 14066 53396]
 [70880 12348 60867]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103536
{'0': {'precision': 0.3687545305662201, 'recall': 0.8887522849701538, 'f1-score': 0.5212400085386969, 'support': 61817}, '1': {'precision': 0.36470588235294116, 'recall': 0.022548475393832666, 'f1-score': 0.0424711120725398, 'support': 52243}, '2': {'precision': 0.3405266170578134, 'recall': 0.10694254691881785, 'f1-score': 0.16276779118443732, 'support': 55628}, 'accuracy': 0.365771297911461, 'macro avg': {'precision': 0.35799567665899157, 'recall': 0.3394144357609348, 'f1-score': 0.2421596372652247, 'support': 169688}, 'weighted avg': {'precision': 0.3582542247033896, 'recall': 0.365771297911461, 'f1-score': 0.25632194736133496, 'support': 169688}}
[[54940  1062  5815]
 [45359  1178  5706]
 [48689   990  5949]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1116452
{'0': {'precision': 0.3320513082792905, 'recall': 0.7445412844036697, 'f1-score': 0.4592747697400999, 'support': 21800}, '1': {'precision': 0.35093859370028635, 'recall': 0.05013636363636364, 'f1-score': 0.08773813785148947, 'support': 22000}, '2': {'precision': 0.3607145320366922, 'recall': 0.23016327069489065, 'f1-score': 0.2810166030841975, 'support': 22723}, 'accuracy': 0.33919095651128184, 'macro avg': {'precision': 0.34790147800542304, 'recall': 0.34161363957830804, 'f1-score': 0.276009836891929, 'support': 66523}, 'weighted avg': {'precision': 0.348088388878502, 'recall': 0.33919095651128184, 'f1-score': 0.2755132703718889, 'support': 66523}}
[[16231  1007  4562]
 [16190  1103  4707]
 [16460  1033  5230]]
Evaluating performance on  val set...
51/51 - 1s - 539ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192789
{'0': {'precision': 0.3113673805601318, 'recall': 0.7390029325513197, 'f1-score': 0.43813387423935096, 'support': 4092}, '1': {'precision': 0.3767019667170953, 'recall': 0.049102741076710706, 'f1-score': 0.08688066992323795, 'support': 5071}, '2': {'precision': 0.27607113985448667, 'recall': 0.18539630836047774, 'f1-score': 0.2218252679441377, 'support': 3684}, 'accuracy': 0.3079318128746011, 'macro avg': {'precision': 0.32138016237723793, 'recall': 0.32450066066283606, 'f1-score': 0.24894660403557553, 'support': 12847}, 'weighted avg': {'precision': 0.32703487769116363, 'recall': 0.3079318128746011, 'f1-score': 0.23745777050473785, 'support': 12847}}
[[3024  233  835]
 [3866  249  956]
 [2822  179  683]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.08046
{'0': {'precision': 0.3786811688864908, 'recall': 0.603430200547565, 'f1-score': 0.46533959548078463, 'support': 132587}, '1': {'precision': 0.4108107244431662, 'recall': 0.15598873964059068, 'f1-score': 0.2261182347457478, 'support': 164826}, '2': {'precision': 0.3545118453780599, 'recall': 0.42205716967240303, 'f1-score': 0.38534698958052466, 'support': 123597}, 'accuracy': 0.3750100947720957, 'macro avg': {'precision': 0.38133457956923894, 'recall': 0.39382536995351963, 'f1-score': 0.35893493993568565, 'support': 421010}, 'weighted avg': {'precision': 0.3841644834075545, 'recall': 0.3750100947720957, 'f1-score': 0.34820046311820985, 'support': 421010}}
[[80007 17339 35241]
 [79375 25711 59740]
 [51896 19536 52165]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0738125
{'0': {'precision': 0.4244778492447785, 'recall': 0.604839955376298, 'f1-score': 0.4988569365900614, 'support': 58265}, '1': {'precision': 0.36311360448807856, 'recall': 0.14826197339034494, 'f1-score': 0.21055342450899334, 'support': 52387}, '2': {'precision': 0.4041532012926759, 'recall': 0.44897451391604165, 'f1-score': 0.42538645471996767, 'support': 56266}, 'accuracy': 0.4090032231395056, 'macro avg': {'precision': 0.39724821834184426, 'recall': 0.4006921475608949, 'f1-score': 0.3782656052730075, 'support': 166918}, 'weighted avg': {'precision': 0.39836757155308405, 'recall': 0.4090032231395056, 'f1-score': 0.3836072557869509, 'support': 166918}}
[[35241  6229 16795]
 [24171  7767 20449]
 [23610  7394 25262]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0729802
{'0': {'precision': 0.4525715777565051, 'recall': 0.6202516548392868, 'f1-score': 0.52330758974617, 'support': 16769}, '1': {'precision': 0.3552888222055514, 'recall': 0.166257108755178, 'f1-score': 0.22651616606083796, 'support': 14243}, '2': {'precision': 0.3972240581625909, 'recall': 0.43271370598245845, 'f1-score': 0.41421008113780894, 'support': 15278}, 'accuracy': 0.4186649384316267, 'macro avg': {'precision': 0.40169481937488244, 'recall': 0.4064074898589744, 'f1-score': 0.38801127898160565, 'support': 46290}, 'weighted avg': {'precision': 0.40437115235862103, 'recall': 0.4186649384316267, 'f1-score': 0.3959800463443829, 'support': 46290}}
[[10401  1969  4399]
 [ 6242  2368  5633]
 [ 6339  2328  6611]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008395
{'0': {'precision': 0.3491715218991989, 'recall': 0.628322440087146, 'f1-score': 0.4488872794729586, 'support': 112455}, '1': {'precision': 0.3619392501482846, 'recall': 0.1016562765780221, 'f1-score': 0.15873059335724649, 'support': 114051}, '2': {'precision': 0.34077724225260864, 'recall': 0.3162929691414827, 'f1-score': 0.3280789294624631, 'support': 109759}, 'accuracy': 0.34784470581238014, 'macro avg': {'precision': 0.3506293381000307, 'recall': 0.3487572286022169, 'f1-score': 0.31189893409755604, 'support': 336265}, 'weighted avg': {'precision': 0.3507620068881403, 'recall': 0.34784470581238014, 'f1-score': 0.31104223494859523, 'support': 336265}}
[[70658 10114 31683]
 [66983 11594 35474]
 [64718 10325 34716]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963068
{'0': {'precision': 0.366028396509053, 'recall': 0.6191472953619037, 'f1-score': 0.4600712209897262, 'support': 45385}, '1': {'precision': 0.37845445240532244, 'recall': 0.13253578869547686, 'f1-score': 0.19631983274983825, 'support': 44637}, '2': {'precision': 0.35303729334871203, 'recall': 0.3339394490408219, 'f1-score': 0.34322291267579313, 'support': 43996}, 'accuracy': 0.3634437165156919, 'macro avg': {'precision': 0.3658400474210291, 'recall': 0.36187417769940083, 'f1-score': 0.33320465547178585, 'support': 134018}, 'weighted avg': {'precision': 0.36590233346080137, 'recall': 0.3634437165156919, 'f1-score': 0.3338648241665854, 'support': 134018}}
[[28100  4756 12529]
 [24326  5916 14395]
 [24344  4960 14692]]
Evaluating performance on  val set...
107/107 - 1s - 885ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974337
{'0': {'precision': 0.35814213766088415, 'recall': 0.6375913216736773, 'f1-score': 0.4586535016124537, 'support': 9034}, '1': {'precision': 0.4101497504159734, 'recall': 0.10409628378378379, 'f1-score': 0.1660491748063321, 'support': 9472}, '2': {'precision': 0.332719106299666, 'recall': 0.3334487534626039, 'f1-score': 0.3330835302934225, 'support': 8664}, 'accuracy': 0.35461906514538094, 'macro avg': {'precision': 0.36700366479217456, 'recall': 0.3583787863066883, 'f1-score': 0.31926206890406944, 'support': 27170}, 'weighted avg': {'precision': 0.36816609659730715, 'recall': 0.35461906514538094, 'f1-score': 0.316603946403927, 'support': 27170}}
[[5760  692 2582]
 [5274  986 3212]
 [5049  726 2889]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1214297
{'0': {'precision': 0.33732989776206723, 'recall': 0.9760603556290155, 'f1-score': 0.5013808182660574, 'support': 112533}, '1': {'precision': 0.3010989010989011, 'recall': 0.005129885326468523, 'f1-score': 0.010087900961848221, 'support': 106825}, '2': {'precision': 0.3371908687381103, 'recall': 0.018595420648173242, 'f1-score': 0.035247035818743735, 'support': 114383}, 'accuracy': 0.3371296903886547, 'macro avg': {'precision': 0.32520655586635955, 'recall': 0.3332618872012191, 'f1-score': 0.1822385850155498, 'support': 333741}, 'weighted avg': {'precision': 0.32568530277556573, 'recall': 0.3371296903886547, 'f1-score': 0.18436808585172046, 'support': 333741}}
[[109839    587   2107]
 [104203    548   2074]
 [111571    685   2127]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221309
{'0': {'precision': 0.3328439597315436, 'recall': 0.9730823471702741, 'f1-score': 0.49602275391082845, 'support': 32618}, '1': {'precision': 0.3437037037037037, 'recall': 0.007147698564298478, 'f1-score': 0.014004165031841367, 'support': 32458}, '2': {'precision': 0.35052012663952964, 'recall': 0.02336448598130841, 'f1-score': 0.04380882394505525, 'support': 33170}, 'accuracy': 0.3333163691142642, 'macro avg': {'precision': 0.34235593002492565, 'recall': 0.33453151057196034, 'f1-score': 0.18461191429590837, 'support': 98246}, 'weighted avg': {'precision': 0.3423996060294719, 'recall': 0.3333163691142642, 'f1-score': 0.18409865099774433, 'support': 98246}}
[[31740   208   670]
 [31460   232   766]
 [32160   235   775]]
Evaluating performance on  val set...
93/93 - 1s - 810ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.131713
{'0': {'precision': 0.3074982602644398, 'recall': 0.9738292011019284, 'f1-score': 0.46740711357926745, 'support': 7260}, '1': {'precision': 0.3402777777777778, 'recall': 0.0060352260130557955, 'f1-score': 0.01186009923756505, 'support': 8119}, '2': {'precision': 0.33760683760683763, 'recall': 0.019209726443768997, 'f1-score': 0.036351087081559874, 'support': 8225}, 'accuracy': 0.30829520420267753, 'macro avg': {'precision': 0.3284609585496851, 'recall': 0.3330247178529177, 'f1-score': 0.17187276663279746, 'support': 23604}, 'weighted avg': {'precision': 0.32926490792297286, 'recall': 0.30829520420267753, 'f1-score': 0.16050904429508142, 'support': 23604}}
[[7070   41  149]
 [7909   49  161]
 [8013   54  158]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997913
{'0': {'precision': 0.36168047194637704, 'recall': 0.7031782952464437, 'f1-score': 0.47767058979593346, 'support': 230438}, '1': {'precision': 0.3320014773528523, 'recall': 0.09480027036484874, 'f1-score': 0.1474868834670157, 'support': 208607}, '2': {'precision': 0.379029481183755, 'recall': 0.2652244958754441, 'f1-score': 0.3120753822204353, 'support': 228267}, 'accuracy': 0.36318393794806625, 'macro avg': {'precision': 0.35757047682766147, 'recall': 0.3544010204955788, 'f1-score': 0.3124109518277948, 'support': 667312}, 'weighted avg': {'precision': 0.35833714868292177, 'recall': 0.36318393794806625, 'f1-score': 0.31780750674963315, 'support': 667312}}
[[162039  18551  49848]
 [139492  19776  49339]
 [146486  21239  60542]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988585
{'0': {'precision': 0.3549950121134388, 'recall': 0.6469709759106551, 'f1-score': 0.45844164807103915, 'support': 61604}, '1': {'precision': 0.35101865290544537, 'recall': 0.10700181886705884, 'f1-score': 0.16400853949516514, 'support': 61027}, '2': {'precision': 0.3638695288541957, 'recall': 0.3155248271527341, 'f1-score': 0.33797710912009943, 'support': 62049}, 'accuracy': 0.3571799870045484, 'macro avg': {'precision': 0.35662773129102665, 'recall': 0.3564992073101494, 'f1-score': 0.32014243222876787, 'support': 184680}, 'weighted avg': {'precision': 0.356662705506665, 'recall': 0.3571799870045484, 'f1-score': 0.3206732189264283, 'support': 184680}}
[[39856  5722 16026]
 [36296  6530 18201]
 [36120  6351 19578]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965288
{'0': {'precision': 0.37575588686080535, 'recall': 0.6578844652615145, 'f1-score': 0.4783171635834767, 'support': 20496}, '1': {'precision': 0.32600896860986545, 'recall': 0.08454963074954934, 'f1-score': 0.13427529205337765, 'support': 17197}, '2': {'precision': 0.3845071215447841, 'recall': 0.33455792309576293, 'f1-score': 0.35779768453035776, 'support': 20415}, 'accuracy': 0.3746127899772837, 'macro avg': {'precision': 0.36209065900515164, 'recall': 0.3589973397022756, 'f1-score': 0.3234633800557374, 'support': 58108}, 'weighted avg': {'precision': 0.36410789868210386, 'recall': 0.3746127899772837, 'f1-score': 0.33415640724058865, 'support': 58108}}
[[13484  1424  5588]
 [10398  1454  5345]
 [12003  1582  6830]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
5343/5343 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0780617
{'0': {'precision': 0.4322822887624835, 'recall': 0.52138588710517, 'f1-score': 0.4726715021212135, 'support': 480270}, '1': {'precision': 0.2969581484986067, 'recall': 0.17016413258948448, 'f1-score': 0.21635288146366688, 'support': 402053}, '2': {'precision': 0.41661202068305686, 'recall': 0.4789769005450433, 'f1-score': 0.4456230524221831, 'support': 485466}, 'accuracy': 0.4030943369189254, 'macro avg': {'precision': 0.38195081931471564, 'recall': 0.39017564007989924, 'f1-score': 0.3782158120023545, 'support': 1367789}, 'weighted avg': {'precision': 0.3869427963927105, 'recall': 0.4030943369189254, 'f1-score': 0.3877280107838668, 'support': 1367789}}
[[250406  75734 154130]
 [162157  68415 171481]
 [166702  86237 232527]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0759192
{'0': {'precision': 0.4120486884964855, 'recall': 0.5511860861907645, 'f1-score': 0.47156832352975797, 'support': 109014}, '1': {'precision': 0.34404216486013334, 'recall': 0.1691155603160217, 'f1-score': 0.2267641336303989, 'support': 109233}, '2': {'precision': 0.4113716726109385, 'recall': 0.480201911909229, 'f1-score': 0.4431299157419163, 'support': 111930}, 'accuracy': 0.400721431232339, 'macro avg': {'precision': 0.3891541753225191, 'recall': 0.40016785280533834, 'f1-score': 0.3804874576340244, 'support': 330177}, 'weighted avg': {'precision': 0.3893204700426291, 'recall': 0.400721431232339, 'f1-score': 0.3809387307387101, 'support': 330177}}
[[60087 15902 33025]
 [46876 18473 43884]
 [38862 19319 53749]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.076278
{'0': {'precision': 0.40150014467270584, 'recall': 0.5953661837024324, 'f1-score': 0.4795820705056628, 'support': 30299}, '1': {'precision': 0.368976230041182, 'recall': 0.15539327552107104, 'f1-score': 0.21868710658159554, 'support': 32865}, '2': {'precision': 0.3978399953043376, 'recall': 0.45673854447439355, 'f1-score': 0.4252595915550397, 'support': 29680}, 'accuracy': 0.3953082590151221, 'macro avg': {'precision': 0.3894387900060752, 'recall': 0.4024993345659657, 'f1-score': 0.3745095895474327, 'support': 92844}, 'weighted avg': {'precision': 0.38881723907171717, 'recall': 0.3953082590151221, 'f1-score': 0.36986465026720944, 'support': 92844}}
[[18039  3884  8376]
 [15616  5107 12142]
 [11274  4850 13556]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
7177/7177 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.082274
{'0': {'precision': 0.4073420664533371, 'recall': 0.659214416790828, 'f1-score': 0.5035378191216416, 'support': 649021}, '1': {'precision': 0.3439494615560865, 'recall': 0.11216290021010085, 'f1-score': 0.16916169070466597, 'support': 562111}, '2': {'precision': 0.4061864075353135, 'recall': 0.39158280840377213, 'f1-score': 0.39875094455954035, 'support': 625957}, 'accuracy': 0.400637094882175, 'macro avg': {'precision': 0.38582597851491235, 'recall': 0.38765337513490034, 'f1-score': 0.3571501514619493, 'support': 1837089}, 'weighted avg': {'precision': 0.38755147747221114, 'recall': 0.400637094882175, 'f1-score': 0.36552132805296517, 'support': 1837089}}
[[427844  53832 167345]
 [308070  63048 190993]
 [314417  66426 245114]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0765247
{'0': {'precision': 0.40405989478950133, 'recall': 0.6634304372225907, 'f1-score': 0.5022352420916846, 'support': 196010}, '1': {'precision': 0.39079037353046536, 'recall': 0.12701974627805682, 'f1-score': 0.19172315176884577, 'support': 188947}, '2': {'precision': 0.40868110945299235, 'recall': 0.41231349095100145, 'f1-score': 0.41048926470740255, 'support': 192618}, 'accuracy': 0.40420378305847726, 'macro avg': {'precision': 0.4011771259243197, 'recall': 0.40092122481721626, 'f1-score': 0.36814921952264434, 'support': 577575}, 'weighted avg': {'precision': 0.40126007293557975, 'recall': 0.40420378305847726, 'f1-score': 0.3700580277004193, 'support': 577575}}
[[130039  16314  49657]
 [ 99693  24000  65254]
 [ 92099  21100  79419]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0756304
{'0': {'precision': 0.42088326927887565, 'recall': 0.6567368084879883, 'f1-score': 0.512999972281509, 'support': 56362}, '1': {'precision': 0.3884478195834772, 'recall': 0.12766601119346543, 'f1-score': 0.19217304681941083, 'support': 52888}, '2': {'precision': 0.4059655172413793, 'recall': 0.435408114205407, 'f1-score': 0.4201716661610664, 'support': 54078}, 'accuracy': 0.41213386559561127, 'macro avg': {'precision': 0.405098868701244, 'recall': 0.4066036446289536, 'f1-score': 0.3751148950873287, 'support': 163328}, 'weighted avg': {'precision': 0.40544091856023606, 'recall': 0.41213386559561127, 'f1-score': 0.37837600350566686, 'support': 163328}}
[[37015  4811 14536]
 [26218  6752 19918]
 [24713  5819 23546]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
5696/5696 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957693
{'0': {'precision': 0.3744545705923051, 'recall': 0.6374965816306598, 'f1-score': 0.4717886000805203, 'support': 511940}, '1': {'precision': 0.30896498128745065, 'recall': 0.10391370139398386, 'f1-score': 0.1555212034595344, 'support': 436160}, '2': {'precision': 0.39272801691793435, 'recall': 0.3386975313968356, 'f1-score': 0.3637171552099939, 'support': 509924}, 'accuracy': 0.3733772557927716, 'macro avg': {'precision': 0.3587158562658967, 'recall': 0.3600359381404931, 'f1-score': 0.33034231958334953, 'support': 1458024}, 'weighted avg': {'precision': 0.3612546023976423, 'recall': 0.3733772557927716, 'f1-score': 0.33938240432217376, 'support': 1458024}}
[[326360  47174 138406]
 [262183  45323 128654]
 [283018  54196 172710]]
Evaluating performance on  train set...
2222/2222 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913512
{'0': {'precision': 0.377113742092697, 'recall': 0.6334263565891473, 'f1-score': 0.4727645819993983, 'support': 193500}, '1': {'precision': 0.35683565502017206, 'recall': 0.10169813265068148, 'f1-score': 0.15828504138405503, 'support': 184379}, '2': {'precision': 0.38525032058831227, 'recall': 0.38588654713222187, 'f1-score': 0.3855681714008826, 'support': 190740}, 'accuracy': 0.3779736519532411, 'macro avg': {'precision': 0.3730665725670604, 'recall': 0.37367034545735023, 'f1-score': 0.3388725982614453, 'support': 568619}, 'weighted avg': {'precision': 0.37326778823942897, 'recall': 0.3779736519532411, 'f1-score': 0.34154268020456335, 'support': 568619}}
[[122568  15215  55717]
 [103894  18751  61734]
 [ 98554  18582  73604]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0887496
{'0': {'precision': 0.39782056884640776, 'recall': 0.7112034574468085, 'f1-score': 0.5102348683151373, 'support': 60160}, '1': {'precision': 0.3181436018160417, 'recall': 0.08171197823317282, 'f1-score': 0.13002766180437433, 'support': 46309}, '2': {'precision': 0.40820233322823296, 'recall': 0.3158876224336854, 'f1-score': 0.3561603458439772, 'support': 57378}, 'accuracy': 0.39485007354422114, 'macro avg': {'precision': 0.3747221679635608, 'recall': 0.36960101937122225, 'f1-score': 0.3321409586544963, 'support': 163847}, 'weighted avg': {'precision': 0.37893663572887215, 'recall': 0.39485007354422114, 'f1-score': 0.34881901403243976, 'support': 163847}}
[[42786  3709 13665]
 [29913  3784 12612]
 [34852  4401 18125]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
12066/12066 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914474
{'0': {'precision': 0.3688678611157706, 'recall': 0.6065289581248537, 'f1-score': 0.45874465668746256, 'support': 1004295}, '1': {'precision': 0.37805041068219286, 'recall': 0.0730411775509267, 'f1-score': 0.1224285616940769, 'support': 1045424}, '2': {'precision': 0.3878154593282072, 'recall': 0.46110614431592795, 'f1-score': 0.4212970676898985, 'support': 1039123}, 'accuracy': 0.3770471263988252, 'macro avg': {'precision': 0.3782445770420569, 'recall': 0.38022542666390274, 'f1-score': 0.3341567620238126, 'support': 3088842}, 'weighted avg': {'precision': 0.37834990739564806, 'recall': 0.3770471263988252, 'f1-score': 0.33232007157942495, 'support': 3088842}}
[[609134  55309 339852]
 [552563  76359 416502]
 [489664  70313 479146]]
Evaluating performance on  train set...
2948/2948 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896976
{'0': {'precision': 0.3779403783895054, 'recall': 0.6414381223102698, 'f1-score': 0.47563366598957874, 'support': 251884}, '1': {'precision': 0.3706984965195191, 'recall': 0.06796178649725561, 'f1-score': 0.11486488770787483, 'support': 249964}, '2': {'precision': 0.39606770546203396, 'recall': 0.44078785911635016, 'f1-score': 0.41723289739655633, 'support': 252634}, 'accuracy': 0.38425568800846144, 'macro avg': {'precision': 0.3815688601236862, 'recall': 0.3833959226412918, 'f1-score': 0.3359104836980033, 'support': 754482}, 'weighted avg': {'precision': 0.3816109356564672, 'recall': 0.38425568800846144, 'f1-score': 0.33655383815122414, 'support': 754482}}
[[161568  12677  77639]
 [140814  16988  92162]
 [125114  16162 111358]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0867748
{'0': {'precision': 0.38165215412935116, 'recall': 0.6271454304455698, 'f1-score': 0.47452810780229393, 'support': 58846}, '1': {'precision': 0.38619676945668135, 'recall': 0.07598715890850723, 'f1-score': 0.12698838488156872, 'support': 62300}, '2': {'precision': 0.3861672714705374, 'recall': 0.46838648828029483, 'f1-score': 0.4233215993938342, 'support': 57254}, 'accuracy': 0.3837219730941704, 'macro avg': {'precision': 0.38467206501885665, 'recall': 0.39050635921145727, 'f1-score': 0.34161269735923233, 'support': 178400}, 'weighted avg': {'precision': 0.3846882419272488, 'recall': 0.3837219730941704, 'f1-score': 0.3367282077441149, 'support': 178400}}
[[36905  3230 18711]
 [33650  4734 23916]
 [26143  4294 26817]]
testing model on single stock: results/universal/W1/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
21353/21353 - 174s - 174s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948703
{'0': {'precision': 0.38106251414305425, 'recall': 0.6725587536229127, 'f1-score': 0.4864877682431013, 'support': 1998047}, '1': {'precision': 0.274240352551176, 'recall': 0.05704633441646136, 'f1-score': 0.09444633592324775, 'support': 1466124}, '2': {'precision': 0.39698514901754006, 'recall': 0.32415888546017424, 'f1-score': 0.3568947597076567, 'support': 2002046}, 'accuracy': 0.37986453885749505, 'macro avg': {'precision': 0.3507626719039234, 'recall': 0.35125465783318277, 'f1-score': 0.31260962129133524, 'support': 5466217}, 'weighted avg': {'precision': 0.3582429503786069, 'recall': 0.37986453885749505, 'f1-score': 0.33387170538191857, 'support': 5466217}}
[[1343804  104111  550132]
 [ 946826   83637  435661]
 [1235836  117229  648981]]
Evaluating performance on  train set...
6073/6073 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09833
{'0': {'precision': 0.35931818891560674, 'recall': 0.6203968842372832, 'f1-score': 0.4550708485797443, 'support': 519295}, '1': {'precision': 0.3400215549904855, 'recall': 0.07870840487963654, 'f1-score': 0.12782727190715326, 'support': 513071}, '2': {'precision': 0.37648560024926925, 'recall': 0.3887335595609244, 'f1-score': 0.382511560595611, 'support': 522188}, 'accuracy': 0.3637982340915787, 'macro avg': {'precision': 0.3586084480517872, 'recall': 0.3626129495592814, 'f1-score': 0.3218032270275028, 'support': 1554554}, 'weighted avg': {'precision': 0.35871613387274986, 'recall': 0.3637982340915787, 'f1-score': 0.3226928298033997, 'support': 1554554}}
[[322169  35458 161668]
 [298172  40383 174516]
 [276271  42925 202992]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986336
{'0': {'precision': 0.36114667137188355, 'recall': 0.6220714807653758, 'f1-score': 0.45698717857363413, 'support': 154643}, '1': {'precision': 0.31142559472130577, 'recall': 0.07470167230116694, 'f1-score': 0.12049919656004525, 'support': 144053}, '2': {'precision': 0.38822407658637725, 'recall': 0.38276434254276104, 'f1-score': 0.3854748780836497, 'support': 158497}, 'accuracy': 0.36664384625311414, 'macro avg': {'precision': 0.35359878089318886, 'recall': 0.35984583186976793, 'f1-score': 0.32098708440577634, 'support': 457193}, 'weighted avg': {'precision': 0.35486752282747436, 'recall': 0.36664384625311414, 'f1-score': 0.32617461503096273, 'support': 457193}}
[[96199 10597 47847]
 [85538 10761 47754]
 [84634 13196 60667]]
training model: results/universal/W1/deepVOL_L3/h50
Epoch 1/50
10622/10622 - 559s - loss: 3.0587 - accuracy50: 0.4639 - val_loss: 3.2559 - val_accuracy50: 0.4506 - 559s/epoch - 53ms/step
Epoch 2/50
10622/10622 - 571s - loss: 2.9495 - accuracy50: 0.5012 - val_loss: 3.3065 - val_accuracy50: 0.4571 - 571s/epoch - 54ms/step
Epoch 3/50
10622/10622 - 597s - loss: 2.9260 - accuracy50: 0.5072 - val_loss: 3.2904 - val_accuracy50: 0.4556 - 597s/epoch - 56ms/step
Epoch 4/50
10622/10622 - 600s - loss: 2.9115 - accuracy50: 0.5103 - val_loss: 3.2850 - val_accuracy50: 0.4577 - 600s/epoch - 56ms/step
Epoch 5/50
10622/10622 - 596s - loss: 2.9009 - accuracy50: 0.5123 - val_loss: 3.2483 - val_accuracy50: 0.4566 - 596s/epoch - 56ms/step
Epoch 6/50
10622/10622 - 553s - loss: 2.8915 - accuracy50: 0.5144 - val_loss: 3.2331 - val_accuracy50: 0.4553 - 553s/epoch - 52ms/step
Epoch 7/50
10622/10622 - 547s - loss: 2.8849 - accuracy50: 0.5158 - val_loss: 3.2242 - val_accuracy50: 0.4550 - 547s/epoch - 51ms/step
Epoch 8/50
10622/10622 - 550s - loss: 2.8796 - accuracy50: 0.5169 - val_loss: 3.2316 - val_accuracy50: 0.4521 - 550s/epoch - 52ms/step
Epoch 9/50
10622/10622 - 548s - loss: 2.8750 - accuracy50: 0.5181 - val_loss: 3.2199 - val_accuracy50: 0.4581 - 548s/epoch - 52ms/step
Epoch 10/50
10622/10622 - 550s - loss: 2.8713 - accuracy50: 0.5188 - val_loss: 3.1958 - val_accuracy50: 0.4626 - 550s/epoch - 52ms/step
Epoch 11/50
10622/10622 - 561s - loss: 2.8677 - accuracy50: 0.5198 - val_loss: 3.2054 - val_accuracy50: 0.4624 - 561s/epoch - 53ms/step
Epoch 12/50
10622/10622 - 561s - loss: 2.8646 - accuracy50: 0.5204 - val_loss: 3.1853 - val_accuracy50: 0.4664 - 561s/epoch - 53ms/step
Epoch 13/50
10622/10622 - 563s - loss: 2.8622 - accuracy50: 0.5210 - val_loss: 3.1769 - val_accuracy50: 0.4684 - 563s/epoch - 53ms/step
Epoch 14/50
10622/10622 - 575s - loss: 2.8593 - accuracy50: 0.5215 - val_loss: 3.1770 - val_accuracy50: 0.4710 - 575s/epoch - 54ms/step
Epoch 15/50
10622/10622 - 604s - loss: 2.8574 - accuracy50: 0.5220 - val_loss: 3.1702 - val_accuracy50: 0.4706 - 604s/epoch - 57ms/step
Epoch 16/50
10622/10622 - 603s - loss: 2.8549 - accuracy50: 0.5229 - val_loss: 3.1700 - val_accuracy50: 0.4715 - 603s/epoch - 57ms/step
Epoch 17/50
10622/10622 - 586s - loss: 2.8532 - accuracy50: 0.5232 - val_loss: 3.1776 - val_accuracy50: 0.4713 - 586s/epoch - 55ms/step
Epoch 18/50
10622/10622 - 569s - loss: 2.8512 - accuracy50: 0.5236 - val_loss: 3.1678 - val_accuracy50: 0.4741 - 569s/epoch - 54ms/step
Epoch 19/50
10622/10622 - 574s - loss: 2.8494 - accuracy50: 0.5238 - val_loss: 3.1576 - val_accuracy50: 0.4763 - 574s/epoch - 54ms/step
Epoch 20/50
10622/10622 - 573s - loss: 2.8479 - accuracy50: 0.5242 - val_loss: 3.1570 - val_accuracy50: 0.4765 - 573s/epoch - 54ms/step
Epoch 21/50
10622/10622 - 579s - loss: 2.8464 - accuracy50: 0.5247 - val_loss: 3.1656 - val_accuracy50: 0.4751 - 579s/epoch - 54ms/step
Epoch 22/50
10622/10622 - 574s - loss: 2.8449 - accuracy50: 0.5249 - val_loss: 3.1649 - val_accuracy50: 0.4745 - 574s/epoch - 54ms/step
Epoch 23/50
10622/10622 - 588s - loss: 2.8436 - accuracy50: 0.5253 - val_loss: 3.1568 - val_accuracy50: 0.4769 - 588s/epoch - 55ms/step
Epoch 24/50
10622/10622 - 554s - loss: 2.8419 - accuracy50: 0.5259 - val_loss: 3.1527 - val_accuracy50: 0.4755 - 554s/epoch - 52ms/step
Epoch 25/50
10622/10622 - 567s - loss: 2.8406 - accuracy50: 0.5261 - val_loss: 3.1429 - val_accuracy50: 0.4781 - 567s/epoch - 53ms/step
Epoch 26/50
10622/10622 - 569s - loss: 2.8396 - accuracy50: 0.5265 - val_loss: 3.1537 - val_accuracy50: 0.4779 - 569s/epoch - 54ms/step
Epoch 27/50
10622/10622 - 583s - loss: 2.8383 - accuracy50: 0.5266 - val_loss: 3.1436 - val_accuracy50: 0.4790 - 583s/epoch - 55ms/step
Epoch 28/50
10622/10622 - 627s - loss: 2.8371 - accuracy50: 0.5269 - val_loss: 3.1524 - val_accuracy50: 0.4777 - 627s/epoch - 59ms/step
Epoch 29/50
10622/10622 - 606s - loss: 2.8364 - accuracy50: 0.5271 - val_loss: 3.1389 - val_accuracy50: 0.4784 - 606s/epoch - 57ms/step
Epoch 30/50
10622/10622 - 630s - loss: 2.8347 - accuracy50: 0.5274 - val_loss: 3.1418 - val_accuracy50: 0.4805 - 630s/epoch - 59ms/step
Epoch 31/50
10622/10622 - 581s - loss: 2.8336 - accuracy50: 0.5278 - val_loss: 3.1394 - val_accuracy50: 0.4825 - 581s/epoch - 55ms/step
Epoch 32/50
10622/10622 - 576s - loss: 2.8324 - accuracy50: 0.5280 - val_loss: 3.1475 - val_accuracy50: 0.4827 - 576s/epoch - 54ms/step
Epoch 33/50
10622/10622 - 587s - loss: 2.8316 - accuracy50: 0.5281 - val_loss: 3.1416 - val_accuracy50: 0.4832 - 587s/epoch - 55ms/step
Epoch 34/50
10622/10622 - 574s - loss: 2.8303 - accuracy50: 0.5286 - val_loss: 3.1297 - val_accuracy50: 0.4844 - 574s/epoch - 54ms/step
Epoch 35/50
10622/10622 - 636s - loss: 2.8295 - accuracy50: 0.5288 - val_loss: 3.1374 - val_accuracy50: 0.4833 - 636s/epoch - 60ms/step
Epoch 36/50
10622/10622 - 618s - loss: 2.8287 - accuracy50: 0.5288 - val_loss: 3.1319 - val_accuracy50: 0.4847 - 618s/epoch - 58ms/step
Epoch 37/50
10622/10622 - 620s - loss: 2.8273 - accuracy50: 0.5293 - val_loss: 3.1386 - val_accuracy50: 0.4852 - 620s/epoch - 58ms/step
Epoch 38/50
10622/10622 - 552s - loss: 2.8262 - accuracy50: 0.5296 - val_loss: 3.1329 - val_accuracy50: 0.4857 - 552s/epoch - 52ms/step
Epoch 39/50
10622/10622 - 544s - loss: 2.8252 - accuracy50: 0.5299 - val_loss: 3.1381 - val_accuracy50: 0.4847 - 544s/epoch - 51ms/step
Epoch 40/50
10622/10622 - 527s - loss: 2.8244 - accuracy50: 0.5300 - val_loss: 3.1262 - val_accuracy50: 0.4861 - 527s/epoch - 50ms/step
Epoch 41/50
10622/10622 - 537s - loss: 2.8233 - accuracy50: 0.5301 - val_loss: 3.1429 - val_accuracy50: 0.4835 - 537s/epoch - 51ms/step
Epoch 42/50
10622/10622 - 532s - loss: 2.8226 - accuracy50: 0.5308 - val_loss: 3.1387 - val_accuracy50: 0.4831 - 532s/epoch - 50ms/step
Epoch 43/50
10622/10622 - 545s - loss: 2.8213 - accuracy50: 0.5308 - val_loss: 3.1434 - val_accuracy50: 0.4840 - 545s/epoch - 51ms/step
Epoch 44/50
10622/10622 - 545s - loss: 2.8207 - accuracy50: 0.5311 - val_loss: 3.1347 - val_accuracy50: 0.4842 - 545s/epoch - 51ms/step
Epoch 45/50
10622/10622 - 563s - loss: 2.8198 - accuracy50: 0.5314 - val_loss: 3.1391 - val_accuracy50: 0.4826 - 563s/epoch - 53ms/step
Epoch 46/50
10622/10622 - 542s - loss: 2.8187 - accuracy50: 0.5316 - val_loss: 3.1468 - val_accuracy50: 0.4829 - 542s/epoch - 51ms/step
Epoch 47/50
10622/10622 - 544s - loss: 2.8179 - accuracy50: 0.5320 - val_loss: 3.1355 - val_accuracy50: 0.4836 - 544s/epoch - 51ms/step
Epoch 48/50
10622/10622 - 549s - loss: 2.8172 - accuracy50: 0.5321 - val_loss: 3.1475 - val_accuracy50: 0.4821 - 549s/epoch - 52ms/step
Epoch 49/50
10622/10622 - 545s - loss: 2.8160 - accuracy50: 0.5323 - val_loss: 3.1426 - val_accuracy50: 0.4830 - 545s/epoch - 51ms/step
Epoch 50/50
10622/10622 - 580s - loss: 2.8147 - accuracy50: 0.5328 - val_loss: 3.1525 - val_accuracy50: 0.4807 - 580s/epoch - 55ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1172s - 1172s/epoch - 33ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0682794
{'0': {'precision': 0.4517788807199017, 'recall': 0.49257135632329235, 'f1-score': 0.4712940756624014, 'support': 3163700}, '1': {'precision': 0.49130185672145177, 'recall': 0.5061933938605194, 'f1-score': 0.49863646793046945, 'support': 2715474}, '2': {'precision': 0.4594197825434699, 'recall': 0.4060510031705322, 'f1-score': 0.43108991466249014, 'support': 3167607}, 'accuracy': 0.4663662135736457, 'macro avg': {'precision': 0.4675001733282744, 'recall': 0.46827191778478133, 'f1-score': 0.46700681941845373, 'support': 9046781}, 'weighted avg': {'precision': 0.46631742076386656, 'recall': 0.4663662135736457, 'f1-score': 0.4654242058699629, 'support': 9046781}}
[[1558348  706944  898408]
 [ 725897 1374555  615022]
 [1165115  716282 1286210]]
Evaluating performance on  train set...
10622/10622 - 291s - 291s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.034122
{'0': {'precision': 0.4597596372969991, 'recall': 0.43016547279290857, 'f1-score': 0.4444704829802569, 'support': 846544}, '1': {'precision': 0.5265099005593897, 'recall': 0.6218124988990901, 'f1-score': 0.5702064805429811, 'support': 1021882}, '2': {'precision': 0.4559900501660622, 'recall': 0.3860012139919632, 'f1-score': 0.4180867912171641, 'support': 850088}, 'accuracy': 0.48839476272698984, 'macro avg': {'precision': 0.48075319600748373, 'recall': 0.4793263952279873, 'f1-score': 0.47758791824680075, 'support': 2718514}, 'weighted avg': {'precision': 0.4836721173276829, 'recall': 0.48839476272698984, 'f1-score': 0.48348403703879317, 'support': 2718514}}
[[364154 279651 202739]
 [197727 635419 188736]
 [230172 291781 328135]]
Evaluating performance on  val set...
3064/3064 - 85s - 85s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0450122
{'0': {'precision': 0.4584779842598847, 'recall': 0.4620179274590894, 'f1-score': 0.4602411490949517, 'support': 252685}, '1': {'precision': 0.5353508520985737, 'recall': 0.5634496478305285, 'f1-score': 0.5490409753184087, 'support': 278985}, '2': {'precision': 0.4535271788513634, 'recall': 0.42367556761387976, 'f1-score': 0.43809344123111754, 'support': 252108}, 'accuracy': 0.48578934341101687, 'macro avg': {'precision': 0.4824520050699406, 'recall': 0.48304771430116583, 'f1-score': 0.4824585218814926, 'support': 783778}, 'weighted avg': {'precision': 0.4842483419173402, 'recall': 0.48578934341101687, 'f1-score': 0.48472538466269616, 'support': 783778}}
[[116745  67656  68284]
 [ 61373 157194  60418]
 [ 76518  68778 106812]]
testing model out of sample: results/universal/W1/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 626s - 626s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98041815
{'0': {'precision': 0.49995945228924654, 'recall': 0.3548704347640174, 'f1-score': 0.41510207091580065, 'support': 1824139}, '1': {'precision': 0.5267874845915036, 'recall': 0.8080322774898687, 'f1-score': 0.6377809244656403, 'support': 2469337}, '2': {'precision': 0.506868015681461, 'recall': 0.28540083733912236, 'f1-score': 0.3651804701002175, 'support': 1805720}, 'accuracy': 0.5177716866288606, 'macro avg': {'precision': 0.5112049841874037, 'recall': 0.4827678498643362, 'f1-score': 0.47268782182721947, 'support': 6099196}, 'weighted avg': {'precision': 0.5128664623098703, 'recall': 0.5177716866288606, 'f1-score': 0.4904767103213036, 'support': 6099196}}
[[ 647333  886244  290562]
 [ 263207 1995304  210826]
 [ 384231  906135  515354]]
Evaluating performance on  train set...
6711/6711 - 185s - 185s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9595524
{'0': {'precision': 0.49772929163880264, 'recall': 0.3983138337916175, 'f1-score': 0.44250651942183183, 'support': 500781}, '1': {'precision': 0.5567751791761987, 'recall': 0.7955279793633315, 'f1-score': 0.6550753511927859, 'support': 718333}, '2': {'precision': 0.5107596550844712, 'recall': 0.29749439943472433, 'f1-score': 0.3759910290465064, 'support': 498164}, 'accuracy': 0.5352208553303542, 'macro avg': {'precision': 0.5217547086331575, 'recall': 0.49711207086322445, 'f1-score': 0.49119096655370803, 'support': 1717278}, 'weighted avg': {'precision': 0.5262080047580229, 'recall': 0.5352208553303542, 'f1-score': 0.5121280855778014, 'support': 1717278}}
[[199468 221222  80091]
 [ 85013 571454  61866]
 [116275 233688 148201]]
Evaluating performance on  val set...
1720/1720 - 46s - 46s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9350276
{'0': {'precision': 0.491503890741623, 'recall': 0.3842079564357419, 'f1-score': 0.43128274683215045, 'support': 120833}, '1': {'precision': 0.5945921041476998, 'recall': 0.8059362213418199, 'f1-score': 0.6843179176529478, 'support': 200161}, '2': {'precision': 0.4851736378237573, 'recall': 0.30243397639219577, 'f1-score': 0.37260430163254726, 'support': 118859}, 'accuracy': 0.554023730655469, 'macro avg': {'precision': 0.5237565442376934, 'recall': 0.4975260513899191, 'f1-score': 0.4960683220392152, 'support': 439853}, 'weighted avg': {'precision': 0.5367049746310341, 'recall': 0.554023730655469, 'f1-score': 0.5305734451078971, 'support': 439853}}
[[ 46425  53796  20612]
 [ 21312 161317  17532]
 [ 26718  56194  35947]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3277225
{'0': {'precision': 0.38086100375713994, 'recall': 0.6999901117373677, 'f1-score': 0.49331296929715035, 'support': 60678}, '1': {'precision': 0.4289327263530602, 'recall': 0.017504025100111464, 'f1-score': 0.033635444142554, 'support': 48446}, '2': {'precision': 0.39261434418935753, 'recall': 0.3642592959513903, 'f1-score': 0.3779056820323072, 'support': 60564}, 'accuracy': 0.3853130451180991, 'macro avg': {'precision': 0.40080269143318586, 'recall': 0.36058447759628987, 'f1-score': 0.3016180318240038, 'support': 169688}, 'weighted avg': {'precision': 0.3987804322542569, 'recall': 0.3853130451180991, 'f1-score': 0.32088436898630024, 'support': 169688}}
[[42474   662 17542]
 [31011   848 16587]
 [38036   467 22061]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.423153
{'0': {'precision': 0.34997020262216927, 'recall': 0.7542660550458715, 'f1-score': 0.47810537334263775, 'support': 21800}, '1': {'precision': 0.42873432155074115, 'recall': 0.017111910071451325, 'f1-score': 0.03291028446389496, 'support': 21973}, '2': {'precision': 0.3852213053263316, 'recall': 0.316, 'f1-score': 0.3471940500338066, 'support': 22750}, 'accuracy': 0.360897734618102, 'macro avg': {'precision': 0.38797527649974733, 'recall': 0.3624593217057743, 'f1-score': 0.2860699026134464, 'support': 66523}, 'weighted avg': {'precision': 0.3880419458047858, 'recall': 0.360897734618102, 'f1-score': 0.28628443482199795, 'support': 66523}}
[[16443   231  5126]
 [15250   376  6347]
 [15291   270  7189]]
Evaluating performance on  val set...
51/51 - 1s - 817ms/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.490739
{'0': {'precision': 0.3349619978284473, 'recall': 0.7544631939349474, 'f1-score': 0.46394465749304453, 'support': 4089}, '1': {'precision': 0.423728813559322, 'recall': 0.020525451559934318, 'f1-score': 0.03915426781519186, 'support': 4872}, '2': {'precision': 0.339605998235813, 'recall': 0.29722079258878026, 'f1-score': 0.3170028818443804, 'support': 3886}, 'accuracy': 0.33782205962481515, 'macro avg': {'precision': 0.36609893654119413, 'recall': 0.3574031460278873, 'f1-score': 0.2733672690508723, 'support': 12847}, 'weighted avg': {'precision': 0.3700299912762441, 'recall': 0.33782205962481515, 'f1-score': 0.2584029342361591, 'support': 12847}}
[[3085   85  919]
 [3445  100 1327]
 [2680   51 1155]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7177225
{'0': {'precision': 0.5463125967717989, 'recall': 0.349878424820354, 'f1-score': 0.4265675201218906, 'support': 73617}, '1': {'precision': 0.7487059973639879, 'recall': 0.9312486203040579, 'f1-score': 0.8300598358143961, 'support': 276329}, '2': {'precision': 0.6179298455009615, 'recall': 0.26227062929190587, 'f1-score': 0.3682453124691285, 'support': 71064}, 'accuracy': 0.7166718130210684, 'macro avg': {'precision': 0.6376494798789162, 'recall': 0.514465891472106, 'f1-score': 0.541624222801805, 'support': 421010}, 'weighted avg': {'precision': 0.691241634457194, 'recall': 0.7166718130210684, 'f1-score': 0.6815543820452618, 'support': 421010}}
[[ 25757  42974   4886]
 [ 12360 257331   6638]
 [  9030  43396  18638]]
Evaluating performance on  train set...
653/653 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81885743
{'0': {'precision': 0.5547953964194373, 'recall': 0.4324014551253301, 'f1-score': 0.48601114627383984, 'support': 40134}, '1': {'precision': 0.6722171079944406, 'recall': 0.8525691654361687, 'f1-score': 0.7517270961067798, 'support': 87363}, '2': {'precision': 0.5332984377516509, 'recall': 0.33598843256132516, 'f1-score': 0.4122508053597273, 'support': 39421}, 'accuracy': 0.6295426496842761, 'macro avg': {'precision': 0.5867703140551762, 'recall': 0.5403196843742747, 'f1-score': 0.5499963492467823, 'support': 166918}, 'weighted avg': {'precision': 0.6111756632611451, 'recall': 0.6295426496842761, 'f1-score': 0.6076639106616225, 'support': 166918}}
[[17354 17229  5551]
 [ 6840 74483  6040]
 [ 7086 19090 13245]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78905964
{'0': {'precision': 0.5940975826783331, 'recall': 0.38634390973092875, 'f1-score': 0.4682094436652641, 'support': 10369}, '1': {'precision': 0.6847301951779564, 'recall': 0.9117174959871589, 'f1-score': 0.782087007835295, 'support': 26166}, '2': {'precision': 0.5757382621627364, 'recall': 0.2778062532034854, 'f1-score': 0.374775273129581, 'support': 9755}, 'accuracy': 0.6604450205227911, 'macro avg': {'precision': 0.618188680006342, 'recall': 0.5252892196405243, 'f1-score': 0.5416905748767133, 'support': 46290}, 'weighted avg': {'precision': 0.6414598157099922, 'recall': 0.6604450205227911, 'f1-score': 0.625942647607745, 'support': 46290}}
[[ 4006  5397   966]
 [ 1279 23856  1031]
 [ 1458  5587  2710]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.179114
{'0': {'precision': 0.41811237963677733, 'recall': 0.4936441694248573, 'f1-score': 0.45274967003959526, 'support': 125082}, '1': {'precision': 0.3367306302452839, 'recall': 0.26850294612299624, 'f1-score': 0.2987711515056339, 'support': 85027}, '2': {'precision': 0.4398201808126635, 'recall': 0.4211056152699832, 'f1-score': 0.43025949203058184, 'support': 126156}, 'accuracy': 0.4095014348802284, 'macro avg': {'precision': 0.3982210635649082, 'recall': 0.39441757693927887, 'f1-score': 0.393926771191937, 'support': 336265}, 'weighted avg': {'precision': 0.4056785056375046, 'recall': 0.4095014348802284, 'f1-score': 0.4053775010886422, 'support': 336265}}
[[61746 23282 40054]
 [34588 22830 27609]
 [51344 21687 53125]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759071
{'0': {'precision': 0.4571730549384181, 'recall': 0.4699452340302876, 'f1-score': 0.46347116835407054, 'support': 45101}, '1': {'precision': 0.4860456889650165, 'recall': 0.5911550915966577, 'f1-score': 0.5334722903384013, 'support': 44161}, '2': {'precision': 0.46087904318623696, 'recall': 0.3495620698900706, 'f1-score': 0.39757566516734005, 'support': 44756}, 'accuracy': 0.46968317688668687, 'macro avg': {'precision': 0.46803259569655714, 'recall': 0.47022079850567194, 'f1-score': 0.4648397079532706, 'support': 134018}, 'weighted avg': {'precision': 0.46792466741784616, 'recall': 0.46968317688668687, 'f1-score': 0.46453147672551864, 'support': 134018}}
[[21195 13625 10281]
 [10035 26106  8020]
 [15131 13980 15645]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1306331
{'0': {'precision': 0.44911563416585193, 'recall': 0.4976363994484932, 'f1-score': 0.4721326792805419, 'support': 10154}, '1': {'precision': 0.34907145105445386, 'recall': 0.32407948568088835, 'f1-score': 0.33611153205031064, 'support': 6844}, '2': {'precision': 0.45561944589649767, 'recall': 0.4284309870232009, 'f1-score': 0.4416071338095962, 'support': 10172}, 'accuracy': 0.4280088332719912, 'macro avg': {'precision': 0.4179355103722678, 'recall': 0.4167156240508609, 'f1-score': 0.41661711504681626, 'support': 27170}, 'weighted avg': {'precision': 0.42634987721736906, 'recall': 0.4280088332719912, 'f1-score': 0.4264413071725492, 'support': 27170}}
[[5053 2110 2991]
 [2410 2218 2216]
 [3788 2026 4358]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2549163
{'0': {'precision': 0.34828128089583615, 'recall': 0.2911226131964682, 'f1-score': 0.3171471351945566, 'support': 114955}, '1': {'precision': 0.3117671944880938, 'recall': 0.09672882738446825, 'f1-score': 0.14764831736445536, 'support': 106659}, '2': {'precision': 0.3390838873680094, 'recall': 0.6186110392679729, 'f1-score': 0.43805397758670234, 'support': 112127}, 'accuracy': 0.33902337441309277, 'macro avg': {'precision': 0.3330441209173131, 'recall': 0.33548749328296984, 'f1-score': 0.30094981004857146, 'support': 333741}, 'weighted avg': {'precision': 0.333521835438856, 'recall': 0.33902337441309277, 'f1-score': 0.30359874619219657, 'support': 333741}}
[[33466 11835 69654]
 [30799 10317 65543]
 [31824 10940 69363]]
Evaluating performance on  train set...
384/384 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.263146
{'0': {'precision': 0.34894165043093484, 'recall': 0.31339343970579514, 'f1-score': 0.3302135904126498, 'support': 33718}, '1': {'precision': 0.32196620583717356, 'recall': 0.09840067603517887, 'f1-score': 0.15073353149870553, 'support': 31951}, '2': {'precision': 0.33807003677102304, 'recall': 0.6039537096724683, 'f1-score': 0.433489396860369, 'support': 32577}, 'accuracy': 0.3398204507053722, 'macro avg': {'precision': 0.3363259643463771, 'recall': 0.3385826084711474, 'f1-score': 0.3048121729239081, 'support': 98246}, 'weighted avg': {'precision': 0.33656397613972494, 'recall': 0.3398204507053722, 'f1-score': 0.30608892970674745, 'support': 98246}}
[[10567  3592 19559]
 [ 9843  3144 18964]
 [ 9873  3029 19675]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2857538
{'0': {'precision': 0.34479990826740053, 'recall': 0.36977373339891784, 'f1-score': 0.35685041238948556, 'support': 8132}, '1': {'precision': 0.27838479809976246, 'recall': 0.08007652364033889, 'f1-score': 0.12437652552265732, 'support': 7318}, '2': {'precision': 0.3628893410549382, 'recall': 0.5686779494726515, 'f1-score': 0.4430536976877508, 'support': 8154}, 'accuracy': 0.34866971699711913, 'macro avg': {'precision': 0.32869134914070036, 'recall': 0.33950940217063613, 'f1-score': 0.30809354519996457, 'support': 23604}, 'weighted avg': {'precision': 0.3304580788631811, 'recall': 0.34866971699711913, 'f1-score': 0.31455494061481204, 'support': 23604}}
[[3007  758 4367]
 [2958  586 3774]
 [2756  761 4637]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1966642
{'0': {'precision': 0.4126887972141095, 'recall': 0.5218639802800507, 'f1-score': 0.4608994238048533, 'support': 233672}, '1': {'precision': 0.4150567885797645, 'recall': 0.1958088365416757, 'f1-score': 0.2660872818121698, 'support': 203428}, '2': {'precision': 0.40629248186534134, 'recall': 0.48684256250760166, 'f1-score': 0.4429351960716509, 'support': 230212}, 'accuracy': 0.41038524708082574, 'macro avg': {'precision': 0.4113460225530718, 'recall': 0.4015051264431093, 'f1-score': 0.38997396722955796, 'support': 667312}, 'weighted avg': {'precision': 0.4112040452517019, 'recall': 0.41038524708082574, 'f1-score': 0.3953141725038073, 'support': 667312}}
[[121945  27915  83812]
 [ 83631  39833  79964]
 [ 89913  28222 112077]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.16148
{'0': {'precision': 0.41536115161812515, 'recall': 0.503103174474567, 'f1-score': 0.4550411115508069, 'support': 61711}, '1': {'precision': 0.4613886953313932, 'recall': 0.3715568318727204, 'f1-score': 0.4116286510947571, 'support': 60591}, '2': {'precision': 0.4284335694074159, 'recall': 0.41992369104491967, 'f1-score': 0.4241359488977226, 'support': 62378}, 'accuracy': 0.4318496859432532, 'macro avg': {'precision': 0.43506113878564473, 'recall': 0.43152789913073564, 'f1-score': 0.43026857051442885, 'support': 184680}, 'weighted avg': {'precision': 0.4348775376804546, 'recall': 0.4318496859432532, 'f1-score': 0.4303594642285922, 'support': 184680}}
[[31047 13067 17597]
 [20730 22513 17348]
 [22970 13214 26194]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1707714
{'0': {'precision': 0.4278904913224151, 'recall': 0.5152823431290782, 'f1-score': 0.46753767054686285, 'support': 20383}, '1': {'precision': 0.42471999207057193, 'recall': 0.2449271220348671, 'f1-score': 0.3106873549883991, 'support': 17495}, '2': {'precision': 0.418438205597921, 'recall': 0.48551655956500245, 'f1-score': 0.4494885934604032, 'support': 20230}, 'accuracy': 0.4235217181799408, 'macro avg': {'precision': 0.4236828963303027, 'recall': 0.4152420082429826, 'f1-score': 0.4092378729985551, 'support': 58108}, 'weighted avg': {'precision': 0.4236451615121048, 'recall': 0.4235217181799408, 'f1-score': 0.4140299074134836, 'support': 58108}}
[[10503  2850  7030]
 [ 6589  4285  6621]
 [ 7454  2954  9822]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
5343/5343 - 95s - 95s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8488219
{'0': {'precision': 0.6302375761765903, 'recall': 0.3263888888888889, 'f1-score': 0.4300582301164412, 'support': 346320}, '1': {'precision': 0.5831327195190387, 'recall': 0.9478386432580347, 'f1-score': 0.722045805880662, 'support': 673142}, '2': {'precision': 0.6934163361401574, 'recall': 0.1877115469085084, 'f1-score': 0.29544463547820826, 'support': 348327}, 'accuracy': 0.5969122430433349, 'macro avg': {'precision': 0.6355955439452621, 'recall': 0.4873130263518107, 'f1-score': 0.4825162238251038, 'support': 1367789}, 'weighted avg': {'precision': 0.62314482320201, 'recall': 0.5969122430433349, 'f1-score': 0.539475363274792, 'support': 1367789}}
[[113035 215333  17952]
 [ 24155 638030  10957]
 [ 42163 240779  65385]]
Evaluating performance on  train set...
1290/1290 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.757023
{'0': {'precision': 0.615222763193306, 'recall': 0.3568732082540944, 'f1-score': 0.45171778865585843, 'support': 70462}, '1': {'precision': 0.6669761730608161, 'recall': 0.9388383283365519, 'f1-score': 0.7798943088530184, 'support': 187454}, '2': {'precision': 0.6807373344338324, 'recall': 0.23968669129959452, 'f1-score': 0.3545402440022926, 'support': 72261}, 'accuracy': 0.6616299742259455, 'macro avg': {'precision': 0.6543120902293182, 'recall': 0.5117994092967469, 'f1-score': 0.5287174471703898, 'support': 330177}, 'weighted avg': {'precision': 0.6589433498050807, 'recall': 0.6616299742259455, 'f1-score': 0.6167682157383841, 'support': 330177}}
[[ 25146  41099   4217]
 [  7559 175989   3906]
 [  8168  46773  17320]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77225876
{'0': {'precision': 0.5907165701443513, 'recall': 0.3445251058681186, 'f1-score': 0.43521732208247094, 'support': 19836}, '1': {'precision': 0.6687792891383454, 'recall': 0.932417253257451, 'f1-score': 0.7788941973117312, 'support': 53416}, '2': {'precision': 0.6065862981476037, 'recall': 0.2105961616986525, 'f1-score': 0.3126468136697735, 'support': 19592}, 'accuracy': 0.6544957132394124, 'macro avg': {'precision': 0.6220273858101001, 'recall': 0.495846173608074, 'f1-score': 0.5089194443546585, 'support': 92844}, 'weighted avg': {'precision': 0.6389772860637742, 'recall': 0.6544957132394124, 'f1-score': 0.6070802595520393, 'support': 92844}}
[[ 6834 11676  1326]
 [ 2260 49806  1350]
 [ 2475 12991  4126]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
7177/7177 - 100s - 100s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84006584
{'0': {'precision': 0.5776096131616442, 'recall': 0.29603205584514, 'f1-score': 0.3914441522793935, 'support': 435490}, '1': {'precision': 0.6160766790599311, 'recall': 0.9262916475628682, 'f1-score': 0.7399875531949327, 'support': 974937}, '2': {'precision': 0.5951433685703671, 'recall': 0.2065053836526337, 'f1-score': 0.3066188509971168, 'support': 426662}, 'accuracy': 0.6097162412926103, 'macro avg': {'precision': 0.5962765535973141, 'recall': 0.47627636235354726, 'f1-score': 0.479350185490481, 'support': 1837089}, 'weighted avg': {'precision': 0.6020961529949754, 'recall': 0.6097162412926103, 'f1-score': 0.5567143841313584, 'support': 1837089}}
[[128919 275760  30811]
 [ 42735 903076  29126]
 [ 51540 287014  88108]]
Evaluating performance on  train set...
2257/2257 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81082004
{'0': {'precision': 0.5628896861611341, 'recall': 0.3598067374702202, 'f1-score': 0.4389992121920078, 'support': 134739}, '1': {'precision': 0.6508556508972042, 'recall': 0.9061069830822235, 'f1-score': 0.7575581293806117, 'support': 311152}, '2': {'precision': 0.5581527055552695, 'recall': 0.24697761307372193, 'f1-score': 0.3424320753028381, 'support': 131684}, 'accuracy': 0.6283859239059862, 'macro avg': {'precision': 0.5906326808712027, 'recall': 0.5042971112087219, 'f1-score': 0.5129964722918192, 'support': 577575}, 'weighted avg': {'precision': 0.6091988257628396, 'recall': 0.6283859239059862, 'f1-score': 0.5885969221811089, 'support': 577575}}
[[ 48480  72160  14099]
 [ 17568 281937  11647]
 [ 20079  79082  32523]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78501785
{'0': {'precision': 0.5754421057416921, 'recall': 0.3510650099844686, 'f1-score': 0.4360842678242296, 'support': 36056}, '1': {'precision': 0.6693729445990387, 'recall': 0.9258838066286864, 'f1-score': 0.777005418748595, 'support': 91451}, '2': {'precision': 0.570340411189754, 'recall': 0.2362022277435024, 'f1-score': 0.33405716993051165, 'support': 35821}, 'accuracy': 0.6477272727272727, 'macro avg': {'precision': 0.6050518205101616, 'recall': 0.5043836814522192, 'f1-score': 0.5157156188344454, 'support': 163328}, 'weighted avg': {'precision': 0.6269171825429647, 'recall': 0.6477272727272727, 'f1-score': 0.6045971223227434, 'support': 163328}}
[[12658 19764  3634]
 [ 4038 84673  2740]
 [ 5301 22059  8461]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
5696/5696 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0519199
{'0': {'precision': 0.5038984981528403, 'recall': 0.3858629561833566, 'f1-score': 0.4370514437685248, 'support': 546847}, '1': {'precision': 0.37309130015981085, 'recall': 0.7322148317816989, 'f1-score': 0.4943118936757829, 'support': 372403}, '2': {'precision': 0.5332788602148446, 'recall': 0.30526343142022444, 'f1-score': 0.38827030287434944, 'support': 538774}, 'accuracy': 0.4445434368707237, 'macro avg': {'precision': 0.4700895528424986, 'recall': 0.47444707312842666, 'f1-score': 0.43987788010621903, 'support': 1458024}, 'weighted avg': {'precision': 0.4813449477554505, 'recall': 0.4445434368707237, 'f1-score': 0.4336509187584387, 'support': 1458024}}
[[211008 233315 102524]
 [ 58307 272679  41417]
 [149436 224870 164468]]
Evaluating performance on  train set...
2222/2222 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95862764
{'0': {'precision': 0.5472689402182361, 'recall': 0.385866467932138, 'f1-score': 0.4526089807042127, 'support': 182488}, '1': {'precision': 0.5024003246181709, 'recall': 0.8174553857506263, 'f1-score': 0.6223253768356706, 'support': 205988}, '2': {'precision': 0.5347654311562393, 'recall': 0.3110695391994138, 'f1-score': 0.393337334301989, 'support': 180143}, 'accuracy': 0.518517671762639, 'macro avg': {'precision': 0.5281448986642154, 'recall': 0.5047971309607261, 'f1-score': 0.48942389728062413, 'support': 568619}, 'weighted avg': {'precision': 0.5270536184945837, 'recall': 0.518517671762639, 'f1-score': 0.4953127398267375, 'support': 568619}}
[[ 70416  81675  30397]
 [ 19248 168386  18354]
 [ 39004  85102  56037]]
Evaluating performance on  val set...
641/641 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9719054
{'0': {'precision': 0.5185444203557358, 'recall': 0.4197773164748066, 'f1-score': 0.4639627895335134, 'support': 52990}, '1': {'precision': 0.5231346686778686, 'recall': 0.7545919141830694, 'f1-score': 0.6178993163455562, 'support': 59289}, '2': {'precision': 0.5019616698185103, 'recall': 0.34486503257834317, 'f1-score': 0.4088416841960068, 'support': 51568}, 'accuracy': 0.517354605210959, 'macro avg': {'precision': 0.5145469196173715, 'recall': 0.5064114210787397, 'f1-score': 0.49690126335835877, 'support': 163847}, 'weighted avg': {'precision': 0.5149862957215788, 'recall': 0.517354605210959, 'f1-score': 0.5023172151752076, 'support': 163847}}
[[22244 20219 10527]
 [ 7432 44739  7118]
 [13221 20563 17784]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
12066/12066 - 164s - 164s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9764151
{'0': {'precision': 0.5659504273040926, 'recall': 0.3015939670888975, 'f1-score': 0.39349510099878104, 'support': 969217}, '1': {'precision': 0.47709656189867083, 'recall': 0.8887238779471948, 'f1-score': 0.6208826493967396, 'support': 1157499}, '2': {'precision': 0.5775600871723529, 'recall': 0.2498352606623249, 'f1-score': 0.3487930535371864, 'support': 962126}, 'accuracy': 0.5054904070845968, 'macro avg': {'precision': 0.5402023587917054, 'recall': 0.48005103523280573, 'f1-score': 0.45439026797756904, 'support': 3088842}, 'weighted avg': {'precision': 0.5362699500435204, 'recall': 0.5054904070845968, 'f1-score': 0.4647813169227598, 'support': 3088842}}
[[ 292310  558763  118144]
 [  71132 1028697   57670]
 [ 153052  568701  240373]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96243584
{'0': {'precision': 0.5616693248272195, 'recall': 0.3470791391146864, 'f1-score': 0.42903776669408666, 'support': 237430}, '1': {'precision': 0.4909737496072438, 'recall': 0.8580276406994324, 'f1-score': 0.6245642903675404, 'support': 280456}, '2': {'precision': 0.5656165524745406, 'recall': 0.2812304519095843, 'f1-score': 0.3756725780134036, 'support': 236596}, 'accuracy': 0.5163595685516685, 'macro avg': {'precision': 0.5394198756363346, 'recall': 0.495445743907901, 'f1-score': 0.4764248783583436, 'support': 754482}, 'weighted avg': {'precision': 0.5366281708017452, 'recall': 0.5163595685516685, 'f1-score': 0.48498422604270897, 'support': 754482}}
[[ 82407 122143  32880]
 [ 21597 240639  18220]
 [ 42714 127344  66538]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9251376
{'0': {'precision': 0.5556406050665209, 'recall': 0.3039620346553409, 'f1-score': 0.3929574923310907, 'support': 50151}, '1': {'precision': 0.5471599629170855, 'recall': 0.8834576535553906, 'f1-score': 0.6757817761955164, 'support': 79499}, '2': {'precision': 0.5389311626260839, 'recall': 0.24988717948717948, 'f1-score': 0.3414524763853463, 'support': 48750}, 'accuracy': 0.5474215246636771, 'macro avg': {'precision': 0.54724391020323, 'recall': 0.47910228923263704, 'f1-score': 0.47006391497065114, 'support': 178400}, 'weighted avg': {'precision': 0.5472953814722985, 'recall': 0.5474215246636771, 'f1-score': 0.5049158904005018, 'support': 178400}}
[[15244 28952  5955]
 [ 4798 70234  4467]
 [ 7393 29175 12182]]
testing model on single stock: results/universal/W1/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
21353/21353 - 305s - 305s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1431264
{'0': {'precision': 0.4339936381545332, 'recall': 0.5646292125548942, 'f1-score': 0.49076683152392525, 'support': 2081961}, '1': {'precision': 0.3294723402684688, 'recall': 0.15259518501625172, 'f1-score': 0.20858444132410828, 'support': 1286941}, '2': {'precision': 0.44801394572898173, 'recall': 0.46172940163971554, 'f1-score': 0.45476828533235714, 'support': 2097315}, 'accuracy': 0.4281405220466, 'macro avg': {'precision': 0.4038266413839946, 'recall': 0.3929845997369538, 'f1-score': 0.38470651939346356, 'support': 5466217}, 'weighted avg': {'precision': 0.41476503046437285, 'recall': 0.4281405220466, 'f1-score': 0.4105189419264374, 'support': 5466217}}
[[1175536  203422  703003]
 [ 600433  196381  490127]
 [ 932679  196244  968392]]
Evaluating performance on  train set...
6073/6073 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1291662
{'0': {'precision': 0.4293966566676826, 'recall': 0.46352998218346797, 'f1-score': 0.44581092321513993, 'support': 519742}, '1': {'precision': 0.4382536484895233, 'recall': 0.41960536291605616, 'f1-score': 0.4287268158958366, 'support': 509126}, '2': {'precision': 0.4380922268222554, 'recall': 0.4217156249167754, 'f1-score': 0.4297479648083154, 'support': 525686}, 'accuracy': 0.435004509331937, 'macro avg': {'precision': 0.4352475106598204, 'recall': 0.43495032333876643, 'f1-score': 0.4347619013064306, 'support': 1554554}, 'weighted avg': {'precision': 0.43523785890997413, 'recall': 0.435004509331937, 'f1-score': 0.43478394340221765, 'support': 1554554}}
[[240916 135910 142916]
 [154065 213632 141429]
 [166076 137920 221690]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1405389
{'0': {'precision': 0.4366583987798987, 'recall': 0.49859938769692236, 'f1-score': 0.465577754951462, 'support': 161358}, '1': {'precision': 0.39348047958268473, 'recall': 0.28741829573179917, 'f1-score': 0.33218884493705314, 'support': 132796}, '2': {'precision': 0.44113217198556365, 'recall': 0.47605174222118635, 'f1-score': 0.45792721780379014, 'support': 163039}, 'accuracy': 0.42921917002228815, 'macro avg': {'precision': 0.42375701678271566, 'recall': 0.4206898085499693, 'f1-score': 0.41856460589743505, 'support': 457193}, 'weighted avg': {'precision': 0.4257123531317046, 'recall': 0.42921917002228815, 'f1-score': 0.42410544540102546, 'support': 457193}}
[[80453 29881 51024]
 [47322 38168 47306]
 [56472 28952 77615]]
training model: results/universal/W1/deepVOL_L3/h100
Epoch 1/50
10622/10622 - 549s - loss: 3.1921 - accuracy100: 0.4195 - val_loss: 3.4145 - val_accuracy100: 0.3850 - 549s/epoch - 52ms/step
Epoch 2/50
10622/10622 - 550s - loss: 3.1329 - accuracy100: 0.4445 - val_loss: 3.4531 - val_accuracy100: 0.3836 - 550s/epoch - 52ms/step
Epoch 3/50
10622/10622 - 558s - loss: 3.1168 - accuracy100: 0.4491 - val_loss: 3.4844 - val_accuracy100: 0.3827 - 558s/epoch - 53ms/step
Epoch 4/50
10622/10622 - 540s - loss: 3.1064 - accuracy100: 0.4530 - val_loss: 3.4714 - val_accuracy100: 0.3847 - 540s/epoch - 51ms/step
Epoch 5/50
10622/10622 - 546s - loss: 3.0975 - accuracy100: 0.4562 - val_loss: 3.4236 - val_accuracy100: 0.3828 - 546s/epoch - 51ms/step
Epoch 6/50
10622/10622 - 551s - loss: 3.0913 - accuracy100: 0.4579 - val_loss: 3.3980 - val_accuracy100: 0.3828 - 551s/epoch - 52ms/step
Epoch 7/50
10622/10622 - 554s - loss: 3.0861 - accuracy100: 0.4596 - val_loss: 3.3727 - val_accuracy100: 0.3862 - 554s/epoch - 52ms/step
Epoch 8/50
10622/10622 - 548s - loss: 3.0817 - accuracy100: 0.4609 - val_loss: 3.3524 - val_accuracy100: 0.3875 - 548s/epoch - 52ms/step
Epoch 9/50
10622/10622 - 557s - loss: 3.0788 - accuracy100: 0.4618 - val_loss: 3.3418 - val_accuracy100: 0.3933 - 557s/epoch - 52ms/step
Epoch 10/50
10622/10622 - 556s - loss: 3.0745 - accuracy100: 0.4633 - val_loss: 3.3232 - val_accuracy100: 0.3947 - 556s/epoch - 52ms/step
Epoch 11/50
10622/10622 - 557s - loss: 3.0715 - accuracy100: 0.4643 - val_loss: 3.3125 - val_accuracy100: 0.3990 - 557s/epoch - 52ms/step
Epoch 12/50
10622/10622 - 570s - loss: 3.0688 - accuracy100: 0.4651 - val_loss: 3.3208 - val_accuracy100: 0.3996 - 570s/epoch - 54ms/step
Epoch 13/50
10622/10622 - 565s - loss: 3.0661 - accuracy100: 0.4660 - val_loss: 3.3224 - val_accuracy100: 0.3997 - 565s/epoch - 53ms/step
Epoch 14/50
10622/10622 - 567s - loss: 3.0637 - accuracy100: 0.4664 - val_loss: 3.3220 - val_accuracy100: 0.4004 - 567s/epoch - 53ms/step
Epoch 15/50
10622/10622 - 580s - loss: 3.0618 - accuracy100: 0.4672 - val_loss: 3.3264 - val_accuracy100: 0.4017 - 580s/epoch - 55ms/step
Epoch 16/50
10622/10622 - 562s - loss: 3.0601 - accuracy100: 0.4680 - val_loss: 3.3365 - val_accuracy100: 0.4015 - 562s/epoch - 53ms/step
Epoch 17/50
10622/10622 - 556s - loss: 3.0579 - accuracy100: 0.4686 - val_loss: 3.3340 - val_accuracy100: 0.4022 - 556s/epoch - 52ms/step
Epoch 18/50
10622/10622 - 569s - loss: 3.0562 - accuracy100: 0.4693 - val_loss: 3.3345 - val_accuracy100: 0.4024 - 569s/epoch - 54ms/step
Epoch 19/50
10622/10622 - 555s - loss: 3.0542 - accuracy100: 0.4702 - val_loss: 3.3417 - val_accuracy100: 0.4025 - 555s/epoch - 52ms/step
Epoch 20/50
10622/10622 - 560s - loss: 3.0529 - accuracy100: 0.4706 - val_loss: 3.3459 - val_accuracy100: 0.4045 - 560s/epoch - 53ms/step
Epoch 21/50
10622/10622 - 563s - loss: 3.0516 - accuracy100: 0.4707 - val_loss: 3.3426 - val_accuracy100: 0.4044 - 563s/epoch - 53ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1063s - 1063s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1135396
{'0': {'precision': 0.40371783654619736, 'recall': 0.5094199729329462, 'f1-score': 0.45045102115138913, 'support': 3196506}, '1': {'precision': 0.34531276880868517, 'recall': 0.4603800291006818, 'f1-score': 0.39462957336963245, 'support': 2650797}, '2': {'precision': 0.4350805274031129, 'recall': 0.20115531346050824, 'f1-score': 0.2751142084405028, 'support': 3199478}, 'accuracy': 0.38603012496931227, 'macro avg': {'precision': 0.3947037109193318, 'recall': 0.3903184384980454, 'f1-score': 0.3733982676538415, 'support': 9046781}, 'weighted avg': {'precision': 0.3976962760678469, 'recall': 0.38603012496931227, 'f1-score': 0.372085290713774, 'support': 9046781}}
[[1628364 1101989  466153]
 [1060920 1220374  369503]
 [1344137 1211749  643592]]
Evaluating performance on  train set...
10622/10622 - 313s - 313s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1037923
{'0': {'precision': 0.40299347680928654, 'recall': 0.4401171270222362, 'f1-score': 0.42073799194547373, 'support': 891340}, '1': {'precision': 0.38690391808720426, 'recall': 0.5888080639356116, 'f1-score': 0.4669659717937175, 'support': 936317}, '2': {'precision': 0.4356269562120862, 'recall': 0.15654476532148257, 'f1-score': 0.2303221080916373, 'support': 890857}, 'accuracy': 0.39840295102397855, 'macro avg': {'precision': 0.40850811703619233, 'recall': 0.3951566520931102, 'f1-score': 0.37267535727694284, 'support': 2718514}, 'weighted avg': {'precision': 0.4081458638142297, 'recall': 0.39840295102397855, 'f1-score': 0.37426065924282476, 'support': 2718514}}
[[392294 407659  91387]
 [295718 551311  89288]
 [285438 465960 139459]]
Evaluating performance on  val set...
3064/3064 - 87s - 87s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1040998
{'0': {'precision': 0.3999054170834439, 'recall': 0.4523748128591277, 'f1-score': 0.42452501385997005, 'support': 259831}, '1': {'precision': 0.38677836558730333, 'recall': 0.5389402432415019, 'f1-score': 0.4503537564053029, 'support': 263853}, '2': {'precision': 0.4312321503097356, 'recall': 0.20260751882011888, 'f1-score': 0.27568762343216624, 'support': 260094}, 'accuracy': 0.3986320105948368, 'macro avg': {'precision': 0.4059719776601609, 'recall': 0.3979741916402495, 'f1-score': 0.3835221312324797, 'support': 783778}, 'weighted avg': {'precision': 0.40588196073910654, 'recall': 0.3986320105948368, 'f1-score': 0.3838288970780299, 'support': 783778}}
[[117541 107464  34826]
 [ 86974 142201  34678]
 [ 89407 117990  52697]]
testing model out of sample: results/universal/W1/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 678s - 678s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883033
{'0': {'precision': 0.4421737756484971, 'recall': 0.36889548013485396, 'f1-score': 0.4022243627354661, 'support': 1983776}, '1': {'precision': 0.39785989868225446, 'recall': 0.7659440450059912, 'f1-score': 0.5236937403332802, 'support': 2128961}, '2': {'precision': 0.5147517549900749, 'recall': 0.08955181053321513, 'f1-score': 0.1525622361489594, 'support': 1986459}, 'accuracy': 0.4165076839635913, 'macro avg': {'precision': 0.4515951431069421, 'recall': 0.4081304452246868, 'f1-score': 0.35949344640590186, 'support': 6099196}, 'weighted avg': {'precision': 0.45034381387074185, 'recall': 0.4165076839635913, 'f1-score': 0.36331103535315445, 'support': 6099196}}
[[ 731806 1154261   97709]
 [ 428310 1630665   69986]
 [ 494903 1313665  177891]]
Evaluating performance on  train set...
6711/6711 - 198s - 198s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.073389
{'0': {'precision': 0.44376670441225347, 'recall': 0.401104811379809, 'f1-score': 0.4213586490794288, 'support': 555932}, '1': {'precision': 0.4123781508379487, 'recall': 0.7556054992135519, 'f1-score': 0.5335608910534497, 'support': 607796}, '2': {'precision': 0.5091328039240894, 'recall': 0.0930051485863969, 'f1-score': 0.15727948016478557, 'support': 553550}, 'accuracy': 0.42725988453820524, 'macro avg': {'precision': 0.4550925530580972, 'recall': 0.41657181972658597, 'f1-score': 0.37073300676588805, 'support': 1717278}, 'weighted avg': {'precision': 0.4537275651910725, 'recall': 0.42725988453820524, 'f1-score': 0.3759466947599426, 'support': 1717278}}
[[222987 304220  28725]
 [127631 459254  20911]
 [151869 350198  51483]]
Evaluating performance on  val set...
1720/1720 - 49s - 49s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0548118
{'0': {'precision': 0.44337874659400545, 'recall': 0.386474418468689, 'f1-score': 0.4129755731867308, 'support': 136837}, '1': {'precision': 0.4424751285754782, 'recall': 0.7774766815106467, 'f1-score': 0.5639798093198012, 'support': 168643}, '2': {'precision': 0.513729694071081, 'recall': 0.09272696151756678, 'f1-score': 0.15709809805392524, 'support': 134373}, 'accuracy': 0.44664922144443714, 'macro avg': {'precision': 0.46652785641352157, 'recall': 0.4188926871656342, 'f1-score': 0.37801782685348573, 'support': 439853}, 'weighted avg': {'precision': 0.46452417247910477, 'recall': 0.44664922144443714, 'f1-score': 0.392702398803855, 'support': 439853}}
[[ 52884  77296   6657]
 [ 32390 131116   5137]
 [ 34001  87912  12460]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1804396
{'0': {'precision': 0.33681813404337313, 'recall': 0.8603260966835502, 'f1-score': 0.4841078010755937, 'support': 55873}, '1': {'precision': 0.40782505762880816, 'recall': 0.10921285328172445, 'f1-score': 0.17228809432944242, 'support': 59938}, '2': {'precision': 0.3770371726789965, 'recall': 0.07643335746236798, 'f1-score': 0.12710072686306886, 'support': 53877}, 'accuracy': 0.3461234736693225, 'macro avg': {'precision': 0.3738934547837259, 'recall': 0.3486574358092142, 'f1-score': 0.261165540756035, 'support': 169688}, 'weighted avg': {'precision': 0.37466933230391775, 'recall': 0.3461234736693225, 'f1-score': 0.26061338944778845, 'support': 169688}}
[[48069  4751  3053]
 [49641  6546  3751]
 [45005  4754  4118]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1839951
{'0': {'precision': 0.3372890006926975, 'recall': 0.8447701228142264, 'f1-score': 0.4820937715767121, 'support': 21903}, '1': {'precision': 0.3202986834348595, 'recall': 0.07455859482206569, 'f1-score': 0.12096026121479722, 'support': 21862}, '2': {'precision': 0.40130778588807786, 'recall': 0.11595922313032779, 'f1-score': 0.17992772891525194, 'support': 22758}, 'accuracy': 0.3423176946319318, 'macro avg': {'precision': 0.3529651566718783, 'recall': 0.34509598025553995, 'f1-score': 0.26099392056892046, 'support': 66523}, 'weighted avg': {'precision': 0.3536066231328402, 'recall': 0.3423176946319318, 'f1-score': 0.26003830801641425, 'support': 66523}}
[[18503  1566  1834]
 [18129  1630  2103]
 [18226  1893  2639]]
Evaluating performance on  val set...
51/51 - 1s - 853ms/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2555033
{'0': {'precision': 0.2763025823524044, 'recall': 0.8784450246591239, 'f1-score': 0.4203803970567818, 'support': 3447}, '1': {'precision': 0.501532175689479, 'recall': 0.08020254818686703, 'f1-score': 0.13829038163638924, 'support': 6122}, '2': {'precision': 0.27502750275027504, 'recall': 0.0762660158633313, 'f1-score': 0.11941724385001193, 'support': 3278}, 'accuracy': 0.2933758854207208, 'macro avg': {'precision': 0.3509540869307195, 'recall': 0.34497119623644074, 'f1-score': 0.22602934084772766, 'support': 12847}, 'weighted avg': {'precision': 0.38330622985561846, 'recall': 0.2933758854207208, 'f1-score': 0.20916281391554767, 'support': 12847}}
[[3028  240  179]
 [5151  491  480]
 [2780  248  250]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
1645/1645 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9349196
{'0': {'precision': 0.4997326489145546, 'recall': 0.3102127134958794, 'f1-score': 0.38279970041660816, 'support': 105447}, '1': {'precision': 0.5724555725686711, 'recall': 0.912980537980538, 'f1-score': 0.7036866720850978, 'support': 216216}, '2': {'precision': 0.773994963156422, 'recall': 0.08352542099912429, 'f1-score': 0.1507795181160737, 'support': 99347}, 'accuracy': 0.5662810859599534, 'macro avg': {'precision': 0.6153943948798826, 'recall': 0.4355728908251806, 'f1-score': 0.4124219635392599, 'support': 421010}, 'weighted avg': {'precision': 0.6017991029032609, 'recall': 0.5662810859599534, 'f1-score': 0.49284551504158847, 'support': 421010}}
[[ 32711  70784   1952]
 [ 18344 197401    471]
 [ 14402  76647   8298]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98563385
{'0': {'precision': 0.5328706719446811, 'recall': 0.41308654443753884, 'f1-score': 0.4653946303144352, 'support': 51488}, '1': {'precision': 0.4748451364473464, 'recall': 0.8795255446158617, 'f1-score': 0.6167269169090267, 'support': 64495}, '2': {'precision': 0.6324231177094379, 'recall': 0.0936684009031118, 'f1-score': 0.16316968484413208, 'support': 50935}, 'accuracy': 0.49584226985705554, 'macro avg': {'precision': 0.5467129753671551, 'recall': 0.4620934966521708, 'f1-score': 0.41509707735586465, 'support': 166918}, 'weighted avg': {'precision': 0.5408287526377596, 'recall': 0.49584226985705554, 'f1-score': 0.43164361620204644, 'support': 166918}}
[[21269 28104  2115]
 [ 7112 56725   658]
 [11533 34631  4771]]
Evaluating performance on  val set...
181/181 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97816455
{'0': {'precision': 0.5728201473033975, 'recall': 0.34000846142998165, 'f1-score': 0.42672566371681414, 'support': 14182}, '1': {'precision': 0.4854314791579534, 'recall': 0.9142947169414978, 'f1-score': 0.6341632214471744, 'support': 19042}, '2': {'precision': 0.7164922770303936, 'recall': 0.11005663554262973, 'f1-score': 0.19080475021561732, 'support': 13066}, 'accuracy': 0.5113415424497731, 'macro avg': {'precision': 0.5915813011639148, 'recall': 0.45478660463803644, 'f1-score': 0.417231211793202, 'support': 46290}, 'weighted avg': {'precision': 0.5774251381910058, 'recall': 0.5113415424497731, 'f1-score': 0.4454658520619186, 'support': 46290}}
[[ 4822  8923   437]
 [ 1500 17410   132]
 [ 2096  9532  1438]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1759849
{'0': {'precision': 0.3870967741935484, 'recall': 0.5146092275655626, 'f1-score': 0.44183707676835404, 'support': 122936}, '1': {'precision': 0.2749853004274795, 'recall': 0.37195305446885346, 'f1-score': 0.3162020667160047, 'support': 93044}, '2': {'precision': 0.39851848698354586, 'recall': 0.1556470050297211, 'f1-score': 0.22386167973981255, 'support': 120285}, 'accuracy': 0.3467324877700623, 'macro avg': {'precision': 0.3535335205348579, 'recall': 0.3474030956880458, 'f1-score': 0.3273002744080571, 'support': 336265}, 'weighted avg': {'precision': 0.3601613534921811, 'recall': 0.3467324877700623, 'f1-score': 0.3291023154732775, 'support': 336265}}
[[63264 44440 15232]
 [45411 34608 13025]
 [54757 46806 18722]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1720668
{'0': {'precision': 0.37621148769725815, 'recall': 0.4344005161634814, 'f1-score': 0.4032174792970282, 'support': 44947}, '1': {'precision': 0.3618212431598148, 'recall': 0.5747303200499242, 'f1-score': 0.4440751519743753, 'support': 44868}, '2': {'precision': 0.40298645036408887, 'recall': 0.09890731398321381, 'f1-score': 0.1588316500762915, 'support': 44203}, 'accuracy': 0.3707263203450283, 'macro avg': {'precision': 0.38033972707372055, 'recall': 0.3693460500655397, 'f1-score': 0.33537476044923165, 'support': 134018}, 'weighted avg': {'precision': 0.3802249200933237, 'recall': 0.3707263203450283, 'f1-score': 0.33629076235335637, 'support': 134018}}
[[19525 22380  3042]
 [15646 25787  3435]
 [16728 23103  4372]]
Evaluating performance on  val set...
107/107 - 6s - 6s/epoch - 60ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1589394
{'0': {'precision': 0.4017815283638069, 'recall': 0.5110823973760064, 'f1-score': 0.44988844656371674, 'support': 10061}, '1': {'precision': 0.28758282419757336, 'recall': 0.45699439354574045, 'f1-score': 0.3530157388824337, 'support': 7313}, '2': {'precision': 0.4198473282442748, 'recall': 0.11790526745610454, 'f1-score': 0.18410775484179484, 'support': 9796}, 'accuracy': 0.3547662863452337, 'macro avg': {'precision': 0.3697372269352183, 'recall': 0.36199401945928383, 'f1-score': 0.3290039800959818, 'support': 27170}, 'weighted avg': {'precision': 0.3775576583623861, 'recall': 0.3547662863452337, 'f1-score': 0.3279886391518224, 'support': 27170}}
[[5142 4022  897]
 [3272 3342  699]
 [4384 4257 1155]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1304/1304 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1968657
{'0': {'precision': 0.3391375444737565, 'recall': 0.9376247240618102, 'f1-score': 0.49810956102412074, 'support': 113250}, '1': {'precision': 0.31043829591367056, 'recall': 0.05653927476969793, 'f1-score': 0.0956568330811901, 'support': 107359}, '2': {'precision': 0.3567467652495379, 'recall': 0.003411943570342609, 'f1-score': 0.006759241423993556, 'support': 113132}, 'accuracy': 0.33751322133031303, 'macro avg': {'precision': 0.33544086854565497, 'recall': 0.3325253141339502, 'f1-score': 0.20017521184310147, 'support': 333741}, 'weighted avg': {'precision': 0.33587466618982803, 'recall': 0.33751322133031303, 'f1-score': 0.20208849445984883, 'support': 333741}}
[[106186   6768    296]
 [100889   6070    400]
 [106031   6715    386]]
Evaluating performance on  train set...
384/384 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1956635
{'0': {'precision': 0.33687129574248276, 'recall': 0.9363136259218958, 'f1-score': 0.4954774110477531, 'support': 33084}, '1': {'precision': 0.30356835028443374, 'recall': 0.05480347306507329, 'f1-score': 0.09284546844519428, 'support': 32133}, '2': {'precision': 0.3346938775510204, 'recall': 0.004965333494807593, 'f1-score': 0.009785494793997434, 'support': 33029}, 'accuracy': 0.33489404148769414, 'macro avg': {'precision': 0.3250445078593123, 'recall': 0.3320274774939255, 'f1-score': 0.1993694580956483, 'support': 98246}, 'weighted avg': {'precision': 0.3252469905102158, 'recall': 0.33489404148769414, 'f1-score': 0.20050671999067882, 'support': 98246}}
[[30977  1965   142]
 [30188  1761   184]
 [30790  2075   164]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2168514
{'0': {'precision': 0.3311826016333529, 'recall': 0.935627788400255, 'f1-score': 0.48920287923220473, 'support': 7845}, '1': {'precision': 0.30243519245875883, 'recall': 0.050865371911745276, 'f1-score': 0.08708437005202443, 'support': 7569}, '2': {'precision': 0.27380952380952384, 'recall': 0.005616605616605617, 'f1-score': 0.011007418042593923, 'support': 8190}, 'accuracy': 0.3292238603626504, 'macro avg': {'precision': 0.30247577263387854, 'recall': 0.33070325530953526, 'f1-score': 0.19576488910894105, 'support': 23604}, 'weighted avg': {'precision': 0.30205725646220977, 'recall': 0.3292238603626504, 'f1-score': 0.1943352371746002, 'support': 23604}}
[[7340  469   36]
 [7098  385   86]
 [7725  419   46]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
2607/2607 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1871512
{'0': {'precision': 0.3669321946550836, 'recall': 0.541526867513864, 'f1-score': 0.4374520553235487, 'support': 230092}, '1': {'precision': 0.3125861783685401, 'recall': 0.3796611304901215, 'f1-score': 0.34287405768511936, 'support': 208989}, '2': {'precision': 0.38150007442187733, 'recall': 0.12353273656952823, 'f1-score': 0.1866324213759458, 'support': 228231}, 'accuracy': 0.3478732586855923, 'macro avg': {'precision': 0.35367281581516696, 'recall': 0.34824024485783794, 'f1-score': 0.322319511461538, 'support': 667312}, 'weighted avg': {'precision': 0.3548945303681334, 'recall': 0.3478732586855923, 'f1-score': 0.3220479010089956, 'support': 667312}}
[[124601  83353  22138]
 [106073  79345  23571]
 [108901  91136  28194]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1977111
{'0': {'precision': 0.3596616448214433, 'recall': 0.4949427713288416, 'f1-score': 0.4165949247735006, 'support': 61595}, '1': {'precision': 0.32981651947534285, 'recall': 0.43472835634656115, 'f1-score': 0.37507436892653767, 'support': 60907}, '2': {'precision': 0.39234059889997963, 'recall': 0.12390234488082602, 'f1-score': 0.18832962573642656, 'support': 62178}, 'accuracy': 0.3501624431448993, 'macro avg': {'precision': 0.36060625439892197, 'recall': 0.35119115751874297, 'f1-score': 0.3266663064788216, 'support': 184680}, 'weighted avg': {'precision': 0.3608211366843429, 'recall': 0.3501624431448993, 'f1-score': 0.32604926602053247, 'support': 184680}}
[[30486 25579  5530]
 [28027 26478  6402]
 [26250 28224  7704]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.190428
{'0': {'precision': 0.37396701803356963, 'recall': 0.5075772681954137, 'f1-score': 0.4306469008395542, 'support': 20060}, '1': {'precision': 0.30663291573708595, 'recall': 0.3922827817114002, 'f1-score': 0.34420979122017, 'support': 18219}, '2': {'precision': 0.3763369866631454, 'recall': 0.14372888194059205, 'f1-score': 0.2080140135756514, 'support': 19829}, 'accuracy': 0.3472671577063399, 'macro avg': {'precision': 0.352312306811267, 'recall': 0.3478629772824686, 'f1-score': 0.3276235685451252, 'support': 58108}, 'weighted avg': {'precision': 0.35366403218336345, 'recall': 0.3472671577063399, 'f1-score': 0.3275735680504117, 'support': 58108}}
[[10182  7579  2299]
 [ 8648  7147  2424]
 [ 8397  8582  2850]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
5343/5343 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0709177
{'0': {'precision': 0.6025027773701972, 'recall': 0.311637790836351, 'f1-score': 0.41079597830514286, 'support': 461170}, '1': {'precision': 0.374861333919044, 'recall': 0.9146819653743872, 'f1-score': 0.5317834644867007, 'support': 442216}, '2': {'precision': 0.7112478346574279, 'recall': 0.07691810776416173, 'f1-score': 0.13882314535215867, 'support': 464403}, 'accuracy': 0.4269123380872342, 'macro avg': {'precision': 0.5628706486488898, 'recall': 0.4344126213249666, 'f1-score': 0.36046752938133403, 'support': 1367789}, 'weighted avg': {'precision': 0.5658266835298218, 'recall': 0.4269123380872342, 'f1-score': 0.35756964196773927, 'support': 1367789}}
[[143718 305620  11832]
 [ 35059 404487   2670]
 [ 59758 368924  35721]]
Evaluating performance on  train set...
1290/1290 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9970709
{'0': {'precision': 0.5843078083741984, 'recall': 0.31769145576110586, 'f1-score': 0.4115958973268852, 'support': 97516}, '1': {'precision': 0.4625585111808775, 'recall': 0.9192443990630068, 'f1-score': 0.6154341078452318, 'support': 133192}, '2': {'precision': 0.7599486521181001, 'recall': 0.09522564819189898, 'f1-score': 0.16924410138207677, 'support': 99469}, 'accuracy': 0.49333539283475225, 'macro avg': {'precision': 0.6022716572243919, 'recall': 0.44405383433867057, 'f1-score': 0.3987580355180645, 'support': 330177}, 'weighted avg': {'precision': 0.5881081539300347, 'recall': 0.49333539283475225, 'f1-score': 0.4208125542851999, 'support': 330177}}
[[ 30980  64079   2457]
 [ 10221 122436    535]
 [ 11819  78178   9472]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9904011
{'0': {'precision': 0.5457543775485728, 'recall': 0.33668750693648036, 'f1-score': 0.4164550300867138, 'support': 27031}, '1': {'precision': 0.48495495372332426, 'recall': 0.9019323671497584, 'f1-score': 0.630760066502485, 'support': 39330}, '2': {'precision': 0.742469380999669, 'recall': 0.08469584261601783, 'f1-score': 0.15204718004338397, 'support': 26483}, 'accuracy': 0.5042544483219163, 'macro avg': {'precision': 0.5910595707571887, 'recall': 0.4411052389007522, 'f1-score': 0.39975409221086095, 'support': 92844}, 'weighted avg': {'precision': 0.5761102658919052, 'recall': 0.5042544483219163, 'f1-score': 0.4318174012634703, 'support': 92844}}
[[ 9101 17308   622]
 [ 3701 35473   156]
 [ 3874 20366  2243]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
7177/7177 - 124s - 124s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0385611
{'0': {'precision': 0.5404334535544925, 'recall': 0.3127985527649315, 'f1-score': 0.39625049432173576, 'support': 578206}, '1': {'precision': 0.43000781528703136, 'recall': 0.9009998098892172, 'f1-score': 0.5821709094614533, 'support': 694332}, '2': {'precision': 0.7201126358038961, 'recall': 0.060699564786883736, 'f1-score': 0.11196168184298312, 'support': 564551}, 'accuracy': 0.4576386881637199, 'macro avg': {'precision': 0.56351796821514, 'recall': 0.42483264248034414, 'f1-score': 0.3634610285420574, 'support': 1837089}, 'weighted avg': {'precision': 0.5539145683772149, 'recall': 0.4576386881637199, 'f1-score': 0.37915549256139547, 'support': 1837089}}
[[180862 386363  10981]
 [ 66401 625593   2338]
 [ 87398 442885  34268]]
Evaluating performance on  train set...
2257/2257 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99555016
{'0': {'precision': 0.5383528169673646, 'recall': 0.3608981786425722, 'f1-score': 0.4321163992236407, 'support': 175199}, '1': {'precision': 0.4686300978922144, 'recall': 0.8956723505755336, 'f1-score': 0.6153166723419315, 'support': 231003}, '2': {'precision': 0.670515574650913, 'recall': 0.072852783110525, 'f1-score': 0.13142589463822352, 'support': 171373}, 'accuracy': 0.48931653897762195, 'macro avg': {'precision': 0.559166163170164, 'recall': 0.4431411041095436, 'f1-score': 0.39295298873459855, 'support': 577575}, 'weighted avg': {'precision': 0.5496811656631805, 'recall': 0.48931653897762195, 'f1-score': 0.41616968901081614, 'support': 577575}}
[[ 63229 107088   4882]
 [ 22847 206903   1253]
 [ 31373 127515  12485]]
Evaluating performance on  val set...
638/638 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9839825
{'0': {'precision': 0.5464573899424603, 'recall': 0.33598492777894073, 'f1-score': 0.41612112884199065, 'support': 47770}, '1': {'precision': 0.48779843733010236, 'recall': 0.9161670532288886, 'f1-score': 0.6366322532905574, 'support': 68553}, '2': {'precision': 0.6980588122237171, 'recall': 0.07726837570471226, 'f1-score': 0.1391357646337726, 'support': 47005}, 'accuracy': 0.5050450626959248, 'macro avg': {'precision': 0.5774382131654265, 'recall': 0.44314011890418054, 'f1-score': 0.39729638225544023, 'support': 163328}, 'weighted avg': {'precision': 0.5654668535732861, 'recall': 0.5050450626959248, 'f1-score': 0.4289603362633471, 'support': 163328}}
[[16050 30460  1260]
 [ 5436 62806   311]
 [ 7885 35488  3632]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
5696/5696 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1152651
{'0': {'precision': 0.44162364120741704, 'recall': 0.39466891573112506, 'f1-score': 0.4168281116230749, 'support': 548969}, '1': {'precision': 0.29509624743875573, 'recall': 0.6788994380933927, 'f1-score': 0.41137898154072977, 'support': 361270}, '2': {'precision': 0.48352704646180034, 'recall': 0.12029719689294158, 'f1-score': 0.1926618513629473, 'support': 547785}, 'accuracy': 0.36201324532380813, 'macro avg': {'precision': 0.4067489783693244, 'recall': 0.39795518357248644, 'f1-score': 0.340289648175584, 'support': 1458024}, 'weighted avg': {'precision': 0.4210602659135043, 'recall': 0.36201324532380813, 'f1-score': 0.3312578315032395, 'support': 1458024}}
[[216661 284703  47605]
 [ 93222 245266  22782]
 [180718 301170  65897]]
Evaluating performance on  train set...
2222/2222 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0668544
{'0': {'precision': 0.46163040265264943, 'recall': 0.3753056234718826, 'f1-score': 0.4140160793015013, 'support': 191412}, '1': {'precision': 0.3941351373613964, 'recall': 0.7898169890789817, 'f1-score': 0.5258567817550776, 'support': 187803}, '2': {'precision': 0.5120573953843636, 'recall': 0.09910561550970412, 'f1-score': 0.1660694853624227, 'support': 189404}, 'accuracy': 0.42020931414532403, 'macro avg': {'precision': 0.4559409784661364, 'recall': 0.4214094093535228, 'f1-score': 0.3686474488063338, 'support': 568619}, 'weighted avg': {'precision': 0.45613509001600594, 'recall': 0.42020931414532403, 'f1-score': 0.3683650243146854, 'support': 568619}}
[[ 71838 107887  11687]
 [ 33273 148330   6200]
 [ 50507 120126  18771]]
Evaluating performance on  val set...
641/641 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.06375
{'0': {'precision': 0.45739866955445546, 'recall': 0.4140423967651023, 'f1-score': 0.4346419941381306, 'support': 57127}, '1': {'precision': 0.3889498393872004, 'recall': 0.7666770573566085, 'f1-score': 0.5160816508527702, 'support': 51328}, '2': {'precision': 0.5135036496350365, 'recall': 0.10160311958405546, 'f1-score': 0.16964070412346274, 'support': 55392}, 'accuracy': 0.41888469120582006, 'macro avg': {'precision': 0.45328405285889745, 'recall': 0.42744085790192204, 'f1-score': 0.3734547830381212, 'support': 163847}, 'weighted avg': {'precision': 0.45492334502485576, 'recall': 0.41888469120582006, 'f1-score': 0.3705650396827945, 'support': 163847}}
[[23653 29892  3582]
 [10226 39352  1750]
 [17833 31931  5628]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
12066/12066 - 168s - 168s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0817338
{'0': {'precision': 0.4670725253809928, 'recall': 0.3161490926275423, 'f1-score': 0.37706966124330454, 'support': 996669}, '1': {'precision': 0.3934860545448154, 'recall': 0.8244062879314749, 'f1-score': 0.5327110882732368, 'support': 1072658}, '2': {'precision': 0.5568140956490472, 'recall': 0.09113156746099861, 'f1-score': 0.15662838478558636, 'support': 1019515}, 'accuracy': 0.4183807394486348, 'macro avg': {'precision': 0.4724575585249518, 'recall': 0.410562316006672, 'f1-score': 0.35546971143404255, 'support': 3088842}, 'weighted avg': {'precision': 0.47113869657966306, 'recall': 0.4183807394486348, 'f1-score': 0.35835935941086455, 'support': 3088842}}
[[315096 635104  46469]
 [160871 884306  27481]
 [198652 727953  92910]]
Evaluating performance on  train set...
2948/2948 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0751034
{'0': {'precision': 0.4715307182851736, 'recall': 0.3615035197869102, 'f1-score': 0.4092509204477381, 'support': 252288}, '1': {'precision': 0.3849560610878856, 'recall': 0.7968020035640322, 'f1-score': 0.519114309322344, 'support': 249156}, '2': {'precision': 0.5379848722076432, 'recall': 0.09641239655703886, 'f1-score': 0.16352028419659165, 'support': 253038}, 'accuracy': 0.4163479049201969, 'macro avg': {'precision': 0.46482388386023415, 'recall': 0.4182393066359938, 'f1-score': 0.3639618379888913, 'support': 754482}, 'weighted avg': {'precision': 0.4652281569405509, 'recall': 0.4163479049201969, 'f1-score': 0.3631185193867767, 'support': 754482}}
[[ 91203 147747  13338]
 [ 43015 198528   7613]
 [ 59201 169441  24396]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0458443
{'0': {'precision': 0.4735632183908046, 'recall': 0.330348294563866, 'f1-score': 0.3891990574649203, 'support': 55499}, '1': {'precision': 0.4349969614099058, 'recall': 0.8367379741656438, 'f1-score': 0.5724124832563625, 'support': 68436}, '2': {'precision': 0.5729024238657551, 'recall': 0.08462315248324612, 'f1-score': 0.14746440569508876, 'support': 54465}, 'accuracy': 0.44958520179372197, 'macro avg': {'precision': 0.4938208678888218, 'recall': 0.4172364737375853, 'f1-score': 0.3696919821387905, 'support': 178400}, 'weighted avg': {'precision': 0.4890967916164121, 'recall': 0.44958520179372197, 'f1-score': 0.3856806505076291, 'support': 178400}}
[[18334 35060  2105]
 [ 9842 57263  1331]
 [10539 39317  4609]]
testing model on single stock: results/universal/W1/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
21353/21353 - 296s - 296s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1323843
{'0': {'precision': 0.3859986586147086, 'recall': 0.5738640117499377, 'f1-score': 0.4615467308017733, 'support': 1967670}, '1': {'precision': 0.29165353680713035, 'recall': 0.24114413520452363, 'f1-score': 0.26400468172900654, 'support': 1523736}, '2': {'precision': 0.4164290977899069, 'recall': 0.2701316733601342, 'f1-score': 0.32769331936460083, 'support': 1974811}, 'accuracy': 0.3713855487259287, 'macro avg': {'precision': 0.36469376440391527, 'recall': 0.36171327343819853, 'f1-score': 0.3510815772984602, 'support': 5466217}, 'weighted avg': {'precision': 0.37069324858349695, 'recall': 0.3713855487259287, 'f1-score': 0.35812289655231055, 'support': 5466217}}
[[1129175  433986  404509]
 [ 813232  367440  343064]
 [ 982927  458425  533459]]
Evaluating performance on  train set...
6073/6073 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1468006
{'0': {'precision': 0.37466041621915314, 'recall': 0.45807199134867915, 'f1-score': 0.4121886968186778, 'support': 517840}, '1': {'precision': 0.3372654505489835, 'recall': 0.4283411799635238, 'f1-score': 0.37738618055691203, 'support': 518694}, '2': {'precision': 0.40430132907946686, 'recall': 0.20500173738465696, 'f1-score': 0.2720566478327311, 'support': 518020}, 'accuracy': 0.3638220351303332, 'macro avg': {'precision': 0.3720757319492012, 'recall': 0.36380496956562, 'f1-score': 0.35387717506944033, 'support': 1554554}, 'weighted avg': {'precision': 0.37206034015655043, 'recall': 0.3638220351303332, 'f1-score': 0.35388061592500636, 'support': 1554554}}
[[237208 205725  74907]
 [214955 222178  81561]
 [180965 230860 106195]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1484035
{'0': {'precision': 0.3732181757605269, 'recall': 0.4739010452598831, 'f1-score': 0.4175763675621737, 'support': 153646}, '1': {'precision': 0.3172961946964901, 'recall': 0.33851579981444085, 'f1-score': 0.32756270402117693, 'support': 146584}, '2': {'precision': 0.40900190141044923, 'recall': 0.27545345081324896, 'f1-score': 0.3291989309943123, 'support': 156963}, 'accuracy': 0.36236337826694637, 'macro avg': {'precision': 0.3665054239558221, 'recall': 0.3626234319625243, 'f1-score': 0.35811266752588766, 'support': 457193}, 'weighted avg': {'precision': 0.3675738488720968, 'recall': 0.36236337826694637, 'f1-score': 0.3583747821649898, 'support': 457193}}
[[72813 50940 29893]
 [64381 49621 32582]
 [57901 55826 43236]]
training model: results/universal/W1/deepVOL_L3/h200
Epoch 1/50
10622/10622 - 547s - loss: 3.2746 - accuracy200: 0.3742 - val_loss: 3.2801 - val_accuracy200: 0.3742 - 547s/epoch - 52ms/step
Epoch 2/50
10622/10622 - 548s - loss: 3.2537 - accuracy200: 0.3885 - val_loss: 3.2881 - val_accuracy200: 0.3690 - 548s/epoch - 52ms/step
Epoch 3/50
10622/10622 - 549s - loss: 3.2449 - accuracy200: 0.3953 - val_loss: 3.2802 - val_accuracy200: 0.3711 - 549s/epoch - 52ms/step
Epoch 4/50
10622/10622 - 551s - loss: 3.2356 - accuracy200: 0.4009 - val_loss: 3.2818 - val_accuracy200: 0.3696 - 551s/epoch - 52ms/step
Epoch 5/50
10622/10622 - 556s - loss: 3.2254 - accuracy200: 0.4048 - val_loss: 3.2764 - val_accuracy200: 0.3730 - 556s/epoch - 52ms/step
Epoch 6/50
10622/10622 - 564s - loss: 3.2217 - accuracy200: 0.4071 - val_loss: 3.2800 - val_accuracy200: 0.3728 - 564s/epoch - 53ms/step
Epoch 7/50
10622/10622 - 543s - loss: 3.2156 - accuracy200: 0.4099 - val_loss: 3.2853 - val_accuracy200: 0.3756 - 543s/epoch - 51ms/step
Epoch 8/50
10622/10622 - 547s - loss: 3.2111 - accuracy200: 0.4117 - val_loss: 3.2860 - val_accuracy200: 0.3756 - 547s/epoch - 51ms/step
Epoch 9/50
10622/10622 - 537s - loss: 3.2061 - accuracy200: 0.4137 - val_loss: 3.3018 - val_accuracy200: 0.3757 - 537s/epoch - 51ms/step
Epoch 10/50
10622/10622 - 516s - loss: 3.2029 - accuracy200: 0.4148 - val_loss: 3.3319 - val_accuracy200: 0.3759 - 516s/epoch - 49ms/step
Epoch 11/50
10622/10622 - 549s - loss: 3.1989 - accuracy200: 0.4162 - val_loss: 3.3302 - val_accuracy200: 0.3762 - 549s/epoch - 52ms/step
Epoch 12/50
10622/10622 - 546s - loss: 3.1965 - accuracy200: 0.4175 - val_loss: 3.3397 - val_accuracy200: 0.3740 - 546s/epoch - 51ms/step
Epoch 13/50
10622/10622 - 549s - loss: 3.1931 - accuracy200: 0.4192 - val_loss: 3.3564 - val_accuracy200: 0.3749 - 549s/epoch - 52ms/step
Epoch 14/50
10622/10622 - 518s - loss: 3.1909 - accuracy200: 0.4202 - val_loss: 3.3605 - val_accuracy200: 0.3752 - 518s/epoch - 49ms/step
Epoch 15/50
10622/10622 - 531s - loss: 3.1888 - accuracy200: 0.4211 - val_loss: 3.3806 - val_accuracy200: 0.3739 - 531s/epoch - 50ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 999s - 999s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093335
{'0': {'precision': 0.37519677620763736, 'recall': 0.7852877732641358, 'f1-score': 0.507783478992616, 'support': 3235377}, '1': {'precision': 0.30506473107935284, 'recall': 0.051948999762421254, 'f1-score': 0.08877982146511916, 'support': 2575988}, '2': {'precision': 0.4120518299257052, 'recall': 0.2338864615863926, 'f1-score': 0.2983979917521773, 'support': 3235416}, 'accuracy': 0.37927766793514733, 'macro avg': {'precision': 0.3641044457375651, 'recall': 0.3570410782043165, 'f1-score': 0.2983204307366375, 'support': 9046781}, 'weighted avg': {'precision': 0.3684078557965405, 'recall': 0.37927766793514733, 'f1-score': 0.3135931311404404, 'support': 9046781}}
[[2540702  132112  562563]
 [1924983  133820  517185]
 [2305967  172729  756720]]
Evaluating performance on  train set...
10622/10622 - 304s - 304s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920488
{'0': {'precision': 0.3604285370904227, 'recall': 0.7508206492442138, 'f1-score': 0.487050414168548, 'support': 912692}, '1': {'precision': 0.349312732255806, 'recall': 0.06547635071472797, 'f1-score': 0.11028121956587657, 'support': 891528}, '2': {'precision': 0.4070713564994832, 'recall': 0.2894637829844667, 'f1-score': 0.3383387516795168, 'support': 914294}, 'accuracy': 0.3709000578992788, 'macro avg': {'precision': 0.37227087528190395, 'recall': 0.3685869276478028, 'f1-score': 0.3118901284713138, 'support': 2718514}, 'weighted avg': {'precision': 0.37247011520118156, 'recall': 0.3709000578992788, 'f1-score': 0.31347526713252877, 'support': 2718514}}
[[685268  46304 181120]
 [628785  58374 204369]
 [587206  62433 264655]]
Evaluating performance on  val set...
3064/3064 - 88s - 88s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921904
{'0': {'precision': 0.36506246400409553, 'recall': 0.7630893505393285, 'f1-score': 0.4938613313774881, 'support': 269131}, '1': {'precision': 0.33718571024989086, 'recall': 0.05345923473771219, 'f1-score': 0.0922868208880735, 'support': 245589}, '2': {'precision': 0.4059480899948979, 'recall': 0.2750150525165578, 'f1-score': 0.327893914719665, 'support': 269058}, 'accuracy': 0.3731860297175986, 'macro avg': {'precision': 0.3693987547496281, 'recall': 0.3638545459311995, 'f1-score': 0.30468068899507555, 'support': 783778}, 'weighted avg': {'precision': 0.3703629198475766, 'recall': 0.3731860297175986, 'f1-score': 0.3110581094859507, 'support': 783778}}
[[205371  10739  53021]
 [177199  13129  55261]
 [179994  15069  73995]]
testing model out of sample: results/universal/W1/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 728s - 728s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0907837
{'0': {'precision': 0.3699681681208277, 'recall': 0.7412258154172979, 'f1-score': 0.49357710922918346, 'support': 2058026}, '1': {'precision': 0.36626588932428555, 'recall': 0.09665482265253456, 'f1-score': 0.1529478533165495, 'support': 1982436}, '2': {'precision': 0.40788507324715156, 'recall': 0.2878390311715841, 'f1-score': 0.33750517932938545, 'support': 2058734}, 'accuracy': 0.37868237059441934, 'macro avg': {'precision': 0.3813730435640883, 'recall': 0.3752398897471389, 'f1-score': 0.3280100472917062, 'support': 6099196}, 'weighted avg': {'precision': 0.3815633506645655, 'recall': 0.37868237059441934, 'f1-score': 0.33018077172752763, 'support': 6099196}}
[[1525462  138270  394294]
 [1324881  191612  465943]
 [1272882  193268  592584]]
Evaluating performance on  train set...
6711/6711 - 216s - 216s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0885231
{'0': {'precision': 0.37068907142373464, 'recall': 0.7499215340143545, 'f1-score': 0.4961361524430117, 'support': 576683}, '1': {'precision': 0.37967394057347004, 'recall': 0.10054096986277192, 'f1-score': 0.15898209483832884, 'support': 566575}, '2': {'precision': 0.4159121489214578, 'recall': 0.2902494686596286, 'f1-score': 0.34189986322692123, 'support': 574020}, 'accuracy': 0.3820231785418552, 'macro avg': {'precision': 0.3887583869728875, 'recall': 0.3802373241789183, 'f1-score': 0.33233937016942056, 'support': 1717278}, 'weighted avg': {'precision': 0.38876975095480326, 'recall': 0.3820231785418552, 'f1-score': 0.33334493580645463, 'support': 1717278}}
[[432467  37777 106439]
 [382072  56964 127539]
 [352118  55293 166609]]
Evaluating performance on  val set...
1720/1720 - 54s - 54s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0859219
{'0': {'precision': 0.37892587186392823, 'recall': 0.7430491164415777, 'f1-score': 0.5019016238687833, 'support': 148830}, '1': {'precision': 0.3863788327442927, 'recall': 0.11012196449961886, 'f1-score': 0.1713946738416559, 'support': 146928}, '2': {'precision': 0.40929605864450536, 'recall': 0.30146084180575317, 'f1-score': 0.3471981328878694, 'support': 144095}, 'accuracy': 0.38696337185377844, 'macro avg': {'precision': 0.39153358775090874, 'recall': 0.3848773075823166, 'f1-score': 0.3401648101994363, 'support': 439853}, 'weighted avg': {'precision': 0.3913646655072078, 'recall': 0.38696337185377844, 'f1-score': 0.3408188878490663, 'support': 439853}}
[[110588  10248  27994]
 [ 96050  16180  34698]
 [ 85208  15448  43439]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097679
{'0': {'precision': 0.3662780938170288, 'recall': 0.9530388080948606, 'f1-score': 0.5291787552433734, 'support': 61817}, '1': {'precision': 0.4265402843601896, 'recall': 0.0017227188331451104, 'f1-score': 0.003431578144660083, 'support': 52243}, '2': {'precision': 0.3410565338276182, 'recall': 0.052922988423096284, 'f1-score': 0.09162776221599751, 'support': 55628}, 'accuracy': 0.36507001084343027, 'macro avg': {'precision': 0.3779583040016122, 'recall': 0.33589483845036733, 'f1-score': 0.2080793652013437, 'support': 169688}, 'weighted avg': {'precision': 0.37656316218636204, 'recall': 0.36507001084343027, 'f1-score': 0.2238731566548171, 'support': 169688}}
[[58914    64  2839]
 [49304    90  2849]
 [52627    57  2944]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1055859
{'0': {'precision': 0.3273826014683474, 'recall': 0.8672935779816514, 'f1-score': 0.47533688656476275, 'support': 21800}, '1': {'precision': 0.3645833333333333, 'recall': 0.003181818181818182, 'f1-score': 0.006308579668348954, 'support': 22000}, '2': {'precision': 0.3489917239771535, 'recall': 0.13176077102495268, 'f1-score': 0.19129768065938277, 'support': 22723}, 'accuracy': 0.33027674638846716, 'macro avg': {'precision': 0.3469858862596114, 'recall': 0.3340787223961408, 'f1-score': 0.22431438229749814, 'support': 66523}, 'weighted avg': {'precision': 0.34706662341259664, 'recall': 0.33027674638846716, 'f1-score': 0.22320084899115583, 'support': 66523}}
[[18907    55  2838]
 [19183    70  2747]
 [19662    67  2994]]
Evaluating performance on  val set...
51/51 - 1s - 893ms/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105469
{'0': {'precision': 0.3186649099692578, 'recall': 0.8866080156402737, 'f1-score': 0.4688247076306777, 'support': 4092}, '1': {'precision': 0.41935483870967744, 'recall': 0.0025635969236836916, 'f1-score': 0.005096040768326146, 'support': 5071}, '2': {'precision': 0.2508735150244584, 'recall': 0.09744842562432139, 'f1-score': 0.14037145650048877, 'support': 3684}, 'accuracy': 0.31135673698139643, 'macro avg': {'precision': 0.3296310879011312, 'recall': 0.3288733460627596, 'f1-score': 0.20476406829983085, 'support': 12847}, 'weighted avg': {'precision': 0.3389696604686761, 'recall': 0.31135673698139643, 'f1-score': 0.19159345933748856, 'support': 12847}}
[[3628   11  453]
 [4439   13  619]
 [3318    7  359]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876589
{'0': {'precision': 0.34651541113014955, 'recall': 0.7839908890011841, 'f1-score': 0.4806075387514015, 'support': 132587}, '1': {'precision': 0.37949512557298726, 'recall': 0.0713236989309939, 'f1-score': 0.12007926293640579, 'support': 164826}, '2': {'precision': 0.41237479734381594, 'recall': 0.30046036716101526, 'f1-score': 0.3476323536983211, 'support': 123597}, 'accuracy': 0.3630293817248996, 'macro avg': {'precision': 0.3794617780156509, 'recall': 0.3852583183643978, 'f1-score': 0.3161063851287094, 'support': 421010}, 'weighted avg': {'precision': 0.3787615263545045, 'recall': 0.3630293817248996, 'f1-score': 0.3004223471015878, 'support': 421010}}
[[103947   6704  21936]
 [122088  11756  30982]
 [ 73943  12518  37136]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0796577
{'0': {'precision': 0.39742660047228573, 'recall': 0.7336823135673217, 'f1-score': 0.5155734590868798, 'support': 58265}, '1': {'precision': 0.3422518491461967, 'recall': 0.07154446713879398, 'f1-score': 0.11834917427136948, 'support': 52387}, '2': {'precision': 0.43043074062596837, 'recall': 0.37029467173781677, 'f1-score': 0.39810453707330584, 'support': 56266}, 'accuracy': 0.40337770641872056, 'macro avg': {'precision': 0.3900363967481503, 'recall': 0.3918404841479775, 'f1-score': 0.34400905681051835, 'support': 166918}, 'weighted avg': {'precision': 0.3912353643693327, 'recall': 0.40337770641872056, 'f1-score': 0.3513078018501175, 'support': 166918}}
[[42748  2648 12869]
 [33938  3748 14701]
 [30876  4555 20835]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0722042
{'0': {'precision': 0.42194234913793105, 'recall': 0.7472121175979486, 'f1-score': 0.5393306790057033, 'support': 16769}, '1': {'precision': 0.34805194805194806, 'recall': 0.1034894334058836, 'f1-score': 0.15954107587401237, 'support': 14243}, '2': {'precision': 0.43021280038838094, 'recall': 0.348016756119911, 'f1-score': 0.38477403480840905, 'support': 15278}, 'accuracy': 0.4173903650896522, 'macro avg': {'precision': 0.40006903252608667, 'recall': 0.3995727690412478, 'f1-score': 0.36121526322937486, 'support': 46290}, 'weighted avg': {'precision': 0.40193662374447064, 'recall': 0.4173903650896522, 'f1-score': 0.37146159869784123, 'support': 46290}}
[[12530   997  3242]
 [ 8969  1474  3800]
 [ 8197  1764  5317]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987883
{'0': {'precision': 0.3501230339507199, 'recall': 0.749046285180739, 'f1-score': 0.4771937378023392, 'support': 112455}, '1': {'precision': 0.3970509669836521, 'recall': 0.03258191510815337, 'f1-score': 0.06022202414715177, 'support': 114051}, '2': {'precision': 0.34162785848335303, 'recall': 0.26867956158492695, 'f1-score': 0.30079405959781924, 'support': 109759}, 'accuracy': 0.3492483606679256, 'macro avg': {'precision': 0.3629339531392417, 'recall': 0.3501025872912731, 'f1-score': 0.2794032738491034, 'support': 336265}, 'weighted avg': {'precision': 0.3632667025639156, 'recall': 0.3492483606679256, 'f1-score': 0.2781914830504688, 'support': 336265}}
[[84234  2538 25683]
 [79186  3716 31149]
 [77164  3105 29490]]
Evaluating performance on  train set...
524/524 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958756
{'0': {'precision': 0.35893094038849405, 'recall': 0.7332598876280709, 'f1-score': 0.4819481252986922, 'support': 45385}, '1': {'precision': 0.39329726480312593, 'recall': 0.05862849205815803, 'f1-score': 0.10204519311380164, 'support': 44637}, '2': {'precision': 0.361041360002309, 'recall': 0.2843213019365397, 'f1-score': 0.3181211296618898, 'support': 43996}, 'accuracy': 0.36118282618752706, 'macro avg': {'precision': 0.37108985506464304, 'recall': 0.3587365605409229, 'f1-score': 0.30070481602479454, 'support': 134018}, 'weighted avg': {'precision': 0.37107005337499827, 'recall': 0.36118282618752706, 'f1-score': 0.30163309534768773, 'support': 134018}}
[[33279  1885 10221]
 [30103  2617 11917]
 [29335  2152 12509]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997739
{'0': {'precision': 0.35511616929773954, 'recall': 0.7495018817799425, 'f1-score': 0.48190455855663505, 'support': 9034}, '1': {'precision': 0.41494845360824745, 'recall': 0.033994932432432436, 'f1-score': 0.06284153005464481, 'support': 9472}, '2': {'precision': 0.33724580319366726, 'recall': 0.2852031394275162, 'f1-score': 0.3090488399724845, 'support': 8664}, 'accuracy': 0.3520058888479941, 'macro avg': {'precision': 0.3691034753665514, 'recall': 0.3562333178799637, 'f1-score': 0.2845983095279214, 'support': 27170}, 'weighted avg': {'precision': 0.3702763660244031, 'recall': 0.3520058888479941, 'f1-score': 0.280690463901356, 'support': 27170}}
[[6771  196 2067]
 [6361  322 2789]
 [5935  258 2471]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043438
{'0': {'precision': 0.33747054965874035, 'recall': 0.9877280442181404, 'f1-score': 0.5030629032294563, 'support': 112533}, '1': {'precision': 0.32432432432432434, 'recall': 0.00033699976597238474, 'f1-score': 0.0006732999177077878, 'support': 106825}, '2': {'precision': 0.35593618019709056, 'recall': 0.01326246033064354, 'f1-score': 0.025572084790762357, 'support': 114383}, 'accuracy': 0.3377019904656605, 'macro avg': {'precision': 0.3392436847267184, 'recall': 0.3337758347715854, 'f1-score': 0.17643609597930884, 'support': 333741}, 'weighted avg': {'precision': 0.3395913819703805, 'recall': 0.3377019904656605, 'f1-score': 0.17860590915545685, 'support': 333741}}
[[111152     34   1347]
 [105391     36   1398]
 [112825     41   1517]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.104691
{'0': {'precision': 0.33254716981132076, 'recall': 0.9855907780979827, 'f1-score': 0.4973006419676696, 'support': 32618}, '1': {'precision': 0.4444444444444444, 'recall': 0.0007394170928584632, 'f1-score': 0.0014763779527559055, 'support': 32458}, '2': {'precision': 0.35592105263157897, 'recall': 0.016309918601145612, 'f1-score': 0.031190544825598153, 'support': 33170}, 'accuracy': 0.33297029904525377, 'macro avg': {'precision': 0.3776375556291147, 'recall': 0.33421337126399564, 'f1-score': 0.17665585491534122, 'support': 98246}, 'weighted avg': {'precision': 0.3774067410222595, 'recall': 0.33297029904525377, 'f1-score': 0.17612384206132659, 'support': 98246}}
[[32148    13   457]
 [31912    24   522]
 [32612    17   541]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1103579
{'0': {'precision': 0.30679561350487866, 'recall': 0.9787878787878788, 'f1-score': 0.4671619222930774, 'support': 7260}, '1': {'precision': 0.6, 'recall': 0.0007390072669047912, 'f1-score': 0.0014761963341124369, 'support': 8119}, '2': {'precision': 0.33101851851851855, 'recall': 0.017386018237082065, 'f1-score': 0.03303684879288437, 'support': 8225}, 'accuracy': 0.30736315878664633, 'macro avg': {'precision': 0.41260471067446575, 'recall': 0.3323043014306219, 'f1-score': 0.16722498914002473, 'support': 23604}, 'weighted avg': {'precision': 0.4160889454694219, 'recall': 0.30736315878664633, 'f1-score': 0.15570703589247054, 'support': 23604}}
[[7106    2  152]
 [7976    6  137]
 [8080    2  143]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
2607/2607 - 39s - 39s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978317
{'0': {'precision': 0.36027802511463025, 'recall': 0.7515123373749121, 'f1-score': 0.48705833382551883, 'support': 230438}, '1': {'precision': 0.3492145248519186, 'recall': 0.01950078377043915, 'f1-score': 0.036938834810402436, 'support': 208607}, '2': {'precision': 0.3760736511855166, 'recall': 0.28829397153333597, 'f1-score': 0.32638485917064675, 'support': 228267}, 'accuracy': 0.3642269283333733, 'macro avg': {'precision': 0.3618554003840218, 'recall': 0.35310236422622904, 'f1-score': 0.28346067593552265, 'support': 667312}, 'weighted avg': {'precision': 0.3622226875469251, 'recall': 0.3642269283333733, 'f1-score': 0.29138594913876054, 'support': 667312}}
[[173177   3260  54001]
 [149361   4068  55178]
 [158138   4321  65808]]
Evaluating performance on  train set...
722/722 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098348
{'0': {'precision': 0.35322144447979636, 'recall': 0.7208460489578599, 'f1-score': 0.4741197070316671, 'support': 61604}, '1': {'precision': 0.38882282996432815, 'recall': 0.032149704229275565, 'f1-score': 0.0593888577785177, 'support': 61027}, '2': {'precision': 0.36964424824720854, 'recall': 0.3211816467630421, 'f1-score': 0.3437130808964929, 'support': 62049}, 'accuracy': 0.3589885206844271, 'macro avg': {'precision': 0.37056284089711095, 'recall': 0.35805913331672584, 'f1-score': 0.29240721523555924, 'support': 184680}, 'weighted avg': {'precision': 0.370503577374147, 'recall': 0.3589885206844271, 'f1-score': 0.29325886512981864, 'support': 184680}}
[[44407  1372 15825]
 [40905  1962 18160]
 [40408  1712 19929]]
Evaluating performance on  val set...
227/227 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963871
{'0': {'precision': 0.37358519621179065, 'recall': 0.7101873536299765, 'f1-score': 0.4896146924771691, 'support': 20496}, '1': {'precision': 0.33053691275167785, 'recall': 0.022910972844100715, 'f1-score': 0.04285170482353581, 'support': 17197}, '2': {'precision': 0.38288865370690134, 'recall': 0.33671320107763897, 'f1-score': 0.35831943286071727, 'support': 20415}, 'accuracy': 0.37557651270048875, 'macro avg': {'precision': 0.36233692089012326, 'recall': 0.3566038425172387, 'f1-score': 0.2969286100538074, 'support': 58108}, 'weighted avg': {'precision': 0.3641136734283378, 'recall': 0.37557651270048875, 'f1-score': 0.3112678930046456, 'support': 58108}}
[[14556   352  5588]
 [11312   394  5491]
 [13095   446  6874]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
5343/5343 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0874165
{'0': {'precision': 0.3976466114343116, 'recall': 0.7228454827492868, 'f1-score': 0.5130550376891013, 'support': 480270}, '1': {'precision': 0.2696896701511314, 'recall': 0.11890472151681494, 'f1-score': 0.16504291267632865, 'support': 402053}, '2': {'precision': 0.4492152434587873, 'recall': 0.2937795849760848, 'f1-score': 0.35523872505613646, 'support': 485466}, 'accuracy': 0.39303357462298644, 'macro avg': {'precision': 0.37218384168141005, 'recall': 0.37850992974739556, 'f1-score': 0.3444455584738555, 'support': 1367789}, 'weighted avg': {'precision': 0.37833759915293463, 'recall': 0.39303357462298644, 'f1-score': 0.3547456983637849, 'support': 1367789}}
[[347161  56035  77074]
 [256454  47806  97793]
 [269424  73422 142620]]
Evaluating performance on  train set...
1290/1290 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0840248
{'0': {'precision': 0.38160600889725127, 'recall': 0.6995340048067221, 'f1-score': 0.49382388271367095, 'support': 109014}, '1': {'precision': 0.30915022169128625, 'recall': 0.12319537136213415, 'f1-score': 0.17618255848967673, 'support': 109233}, '2': {'precision': 0.4405893262374584, 'recall': 0.34171357098186367, 'f1-score': 0.38490296415938335, 'support': 111930}, 'accuracy': 0.38756182290105007, 'macro avg': {'precision': 0.37711518560866536, 'recall': 0.38814764905024, 'f1-score': 0.3516364684542437, 'support': 330177}, 'weighted avg': {'precision': 0.3776306856797655, 'recall': 0.38756182290105007, 'f1-score': 0.3518138905496469, 'support': 330177}}
[[76259 12631 20124]
 [67337 13457 28439]
 [56241 17441 38248]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.085577
{'0': {'precision': 0.37084065898287427, 'recall': 0.7518399947192976, 'f1-score': 0.49669126865590285, 'support': 30299}, '1': {'precision': 0.33270231897775676, 'recall': 0.10695268522744561, 'f1-score': 0.16186967533962698, 'support': 32865}, '2': {'precision': 0.42784518728118553, 'recall': 0.3005727762803235, 'f1-score': 0.3530901822643526, 'support': 29680}, 'accuracy': 0.37930291672052047, 'macro avg': {'precision': 0.37712938841393884, 'recall': 0.3864551520756889, 'f1-score': 0.33721704208662745, 'support': 92844}, 'weighted avg': {'precision': 0.37556339664632793, 'recall': 0.37930291672052047, 'f1-score': 0.33226500623247635, 'support': 92844}}
[[22780  2817  4702]
 [22122  3515  7228]
 [16526  4233  8921]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
7177/7177 - 106s - 106s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0854398
{'0': {'precision': 0.3941120213562564, 'recall': 0.7606625979744878, 'f1-score': 0.5192117475383544, 'support': 649021}, '1': {'precision': 0.3247802535219013, 'recall': 0.12607652225272234, 'f1-score': 0.18164156362093867, 'support': 562111}, '2': {'precision': 0.4308997922065156, 'recall': 0.2521067741074866, 'f1-score': 0.3181016462639062, 'support': 625957}, 'accuracy': 0.39321067188361586, 'macro avg': {'precision': 0.38326402236155777, 'recall': 0.37961529811156564, 'f1-score': 0.33965165247439977, 'support': 1837089}, 'weighted avg': {'precision': 0.38543275395493753, 'recall': 0.39321067188361586, 'f1-score': 0.34739743189254074, 'support': 1837089}}
[[493686  60287  95048]
 [377869  70869 113373]
 [381099  87050 157808]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0812186
{'0': {'precision': 0.3865879377949773, 'recall': 0.7705882352941177, 'f1-score': 0.5148742666834834, 'support': 196010}, '1': {'precision': 0.373997178562777, 'recall': 0.13890667753391162, 'f1-score': 0.20257482903937885, 'support': 188947}, '2': {'precision': 0.44869311851915333, 'recall': 0.271822986429098, 'f1-score': 0.33854927774257376, 'support': 192618}, 'accuracy': 0.3976055057784703, 'macro avg': {'precision': 0.4030927449589692, 'recall': 0.39377263308570915, 'f1-score': 0.35199945782181197, 'support': 577575}, 'weighted avg': {'precision': 0.4031807430862084, 'recall': 0.3976055057784703, 'f1-score': 0.35390571963009504, 'support': 577575}}
[[151043  17015  27952]
 [126321  26246  36380]
 [113344  26916  52358]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.078772
{'0': {'precision': 0.3995996346897169, 'recall': 0.7685497320889961, 'f1-score': 0.5258097995302342, 'support': 56362}, '1': {'precision': 0.3614046572524081, 'recall': 0.1461390107396763, 'f1-score': 0.20812128066348926, 'support': 52888}, '2': {'precision': 0.44160877731731313, 'recall': 0.273900662006731, 'f1-score': 0.33810018375009987, 'support': 54078}, 'accuracy': 0.40322541144200624, 'macro avg': {'precision': 0.40087102308647937, 'recall': 0.3961964682784678, 'f1-score': 0.35734375464794105, 'support': 163328}, 'weighted avg': {'precision': 0.401140793880491, 'recall': 0.40322541144200624, 'f1-score': 0.3607868335477785, 'support': 163328}}
[[43317  5055  7990]
 [34420  7729 10739]
 [30664  8602 14812]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
5696/5696 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939586
{'0': {'precision': 0.37405866698009455, 'recall': 0.6962573739110052, 'f1-score': 0.4866620609430083, 'support': 511940}, '1': {'precision': 0.34523220593468207, 'recall': 0.09120047688921497, 'f1-score': 0.1442849862436319, 'support': 436160}, '2': {'precision': 0.3984313886416739, 'recall': 0.3046493202908669, 'f1-score': 0.3452856839622903, 'support': 509924}, 'accuracy': 0.3782982996164672, 'macro avg': {'precision': 0.3725740871854835, 'recall': 0.364035723697029, 'f1-score': 0.3254109103829768, 'support': 1458024}, 'weighted avg': {'precision': 0.37395941379289876, 'recall': 0.3782982996164672, 'f1-score': 0.3347973505154737, 'support': 1458024}}
[[356442  34471 121027]
 [282858  39778 113524]
 [313604  40972 155348]]
Evaluating performance on  train set...
2222/2222 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0919247
{'0': {'precision': 0.3695893511824498, 'recall': 0.7054056847545219, 'f1-score': 0.48504489906150833, 'support': 193500}, '1': {'precision': 0.3705438341214987, 'recall': 0.0883940145027362, 'f1-score': 0.1427376589027119, 'support': 184379}, '2': {'precision': 0.3975224862700155, 'recall': 0.323697179406522, 'f1-score': 0.356831389048625, 'support': 190740}, 'accuracy': 0.3772930556312751, 'macro avg': {'precision': 0.37921855719132136, 'recall': 0.37249895955459333, 'f1-score': 0.32820464900428176, 'support': 568619}, 'weighted avg': {'precision': 0.37926886030265367, 'recall': 0.3772930556312751, 'f1-score': 0.33104070375129874, 'support': 568619}}
[[136496  12104  44900]
 [119406  16298  48675]
 [113416  15582  61742]]
Evaluating performance on  val set...
641/641 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0894341
{'0': {'precision': 0.3942575456196489, 'recall': 0.7577792553191489, 'f1-score': 0.5186643153763013, 'support': 60160}, '1': {'precision': 0.33126127932624827, 'recall': 0.07134682243192468, 'f1-score': 0.11740667697173214, 'support': 46309}, '2': {'precision': 0.41615459038255365, 'recall': 0.27737111785004703, 'f1-score': 0.3328766693508748, 'support': 57378}, 'accuracy': 0.39553363808919295, 'macro avg': {'precision': 0.38055780510948356, 'recall': 0.3688323985337069, 'f1-score': 0.3229825538996361, 'support': 163847}, 'weighted avg': {'precision': 0.38412073834594146, 'recall': 0.39553363808919295, 'f1-score': 0.34019315917250076, 'support': 163847}}
[[45588  2958 11614]
 [32291  3304 10714]
 [37751  3712 15915]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
12066/12066 - 171s - 171s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911841
{'0': {'precision': 0.3597726490011287, 'recall': 0.71252570210944, 'f1-score': 0.47812674348292356, 'support': 1004295}, '1': {'precision': 0.3982169495589983, 'recall': 0.1080116775585791, 'f1-score': 0.1699314438183182, 'support': 1045424}, '2': {'precision': 0.4123103610490415, 'recall': 0.32389235922985055, 'f1-score': 0.36279185582062407, 'support': 1039123}, 'accuracy': 0.3771860133991962, 'macro avg': {'precision': 0.3900999865363895, 'recall': 0.3814765796326232, 'f1-score': 0.3369500143739553, 'support': 3088842}, 'weighted avg': {'precision': 0.39045849807426797, 'recall': 0.3771860133991962, 'f1-score': 0.3350174820092444, 'support': 3088842}}
[[715586  72037 216672]
 [669454 112918 263052]
 [603955  98604 336564]]
Evaluating performance on  train set...
2948/2948 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888512
{'0': {'precision': 0.3701910277223402, 'recall': 0.7341990757650347, 'f1-score': 0.49220634910073263, 'support': 251884}, '1': {'precision': 0.38784663188133905, 'recall': 0.10586324430718023, 'f1-score': 0.1663272489566048, 'support': 249964}, '2': {'precision': 0.4225064678375729, 'recall': 0.31222638283049786, 'f1-score': 0.3590901538034311, 'support': 252634}, 'accuracy': 0.38473283656866564, 'macro avg': {'precision': 0.3935147091470841, 'recall': 0.3840962343009043, 'f1-score': 0.3392079172869229, 'support': 754482}, 'weighted avg': {'precision': 0.3935579527597456, 'recall': 0.38473283656866564, 'f1-score': 0.33966762681025353, 'support': 754482}}
[[184933  17417  49534]
 [165222  26462  58280]
 [149406  24349  78879]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0852038
{'0': {'precision': 0.3729849330945106, 'recall': 0.7218842402202359, 'f1-score': 0.49184313816299835, 'support': 58846}, '1': {'precision': 0.4141870206168743, 'recall': 0.12221508828250402, 'f1-score': 0.18873864382831576, 'support': 62300}, '2': {'precision': 0.41368021680216804, 'recall': 0.33326929122856047, 'f1-score': 0.36914653846525897, 'support': 57254}, 'accuracy': 0.38775224215246634, 'macro avg': {'precision': 0.40028405683785095, 'recall': 0.3924562065771002, 'f1-score': 0.349909440152191, 'support': 178400}, 'weighted avg': {'precision': 0.40043368772478793, 'recall': 0.38775224215246634, 'f1-score': 0.3466173471532164, 'support': 178400}}
[[42480  4501 11865]
 [39507  7614 15179]
 [31905  6268 19081]]
testing model on single stock: results/universal/W1/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
21353/21353 - 307s - 307s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944014
{'0': {'precision': 0.3757479039225723, 'recall': 0.8115740020129657, 'f1-score': 0.5136723724374399, 'support': 1998047}, '1': {'precision': 0.300119559190463, 'recall': 0.02362760585052833, 'f1-score': 0.043806447859944815, 'support': 1466124}, '2': {'precision': 0.40625386386819573, 'recall': 0.2100685998223817, 'f1-score': 0.2769367835278826, 'support': 2002046}, 'accuracy': 0.3799283855726913, 'macro avg': {'precision': 0.36070710899374364, 'recall': 0.3484234025619586, 'f1-score': 0.2781385346084224, 'support': 5466217}, 'weighted avg': {'precision': 0.36663626488469225, 'recall': 0.3799283855726913, 'f1-score': 0.30094074329807735, 'support': 5466217}}
[[1621563   35291  341193]
 [1158011   34641  273472]
 [1535987   45492  420567]]
Evaluating performance on  train set...
6073/6073 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943656
{'0': {'precision': 0.3525789007092199, 'recall': 0.7658633339431344, 'f1-score': 0.4828631180207552, 'support': 519295}, '1': {'precision': 0.3639017663282671, 'recall': 0.048346135330197965, 'f1-score': 0.08535274028577082, 'support': 513071}, '2': {'precision': 0.4006194369262535, 'recall': 0.2749546140470482, 'f1-score': 0.3260994483169009, 'support': 522188}, 'accuracy': 0.3641507467736727, 'macro avg': {'precision': 0.37236670132124683, 'recall': 0.3630546944401269, 'f1-score': 0.29810510220780895, 'support': 1554554}, 'weighted avg': {'precision': 0.37245317044325976, 'recall': 0.3641507467736727, 'f1-score': 0.2990090002672501, 'support': 1554554}}
[[397709  18909 102677]
 [376131  24805 112135]
 [354160  24450 143578]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957195
{'0': {'precision': 0.3528071402624461, 'recall': 0.7599374042148691, 'f1-score': 0.48189199163488744, 'support': 154643}, '1': {'precision': 0.3356678339169585, 'recall': 0.032606054715972596, 'f1-score': 0.05943839135441581, 'support': 144053}, '2': {'precision': 0.39779115918730645, 'recall': 0.27633330599317335, 'f1-score': 0.326120625465376, 'support': 158497}, 'accuracy': 0.3631157957361552, 'macro avg': {'precision': 0.362088711122237, 'recall': 0.35629225497467165, 'f1-score': 0.2891503361515598, 'support': 457193}, 'weighted avg': {'precision': 0.363001661067767, 'recall': 0.3631157957361552, 'f1-score': 0.2947828217548328, 'support': 457193}}
[[117519   4112  33012]
 [106063   4697  33293]
 [109515   5184  43798]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        89 (peak)  21.99 (ave)

============================================
