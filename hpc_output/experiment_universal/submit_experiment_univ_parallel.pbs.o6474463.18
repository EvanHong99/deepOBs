This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W6/deepLOB_L1/h10
Epoch 1/50
9426/9426 - 168s - loss: 2.8087 - accuracy10: 0.5330 - val_loss: 3.8640 - val_accuracy10: 0.5074 - 168s/epoch - 18ms/step
Epoch 2/50
9426/9426 - 154s - loss: 2.7234 - accuracy10: 0.5535 - val_loss: 3.8439 - val_accuracy10: 0.5125 - 154s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 154s - loss: 2.6983 - accuracy10: 0.5592 - val_loss: 3.8562 - val_accuracy10: 0.5157 - 154s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 153s - loss: 2.6848 - accuracy10: 0.5624 - val_loss: 3.8607 - val_accuracy10: 0.5166 - 153s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 154s - loss: 2.6749 - accuracy10: 0.5648 - val_loss: 3.8745 - val_accuracy10: 0.5154 - 154s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 152s - loss: 2.6677 - accuracy10: 0.5663 - val_loss: 3.8622 - val_accuracy10: 0.5175 - 152s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 153s - loss: 2.6614 - accuracy10: 0.5679 - val_loss: 3.8182 - val_accuracy10: 0.5177 - 153s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 154s - loss: 2.6568 - accuracy10: 0.5691 - val_loss: 3.8422 - val_accuracy10: 0.5170 - 154s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 153s - loss: 2.6519 - accuracy10: 0.5699 - val_loss: 3.8788 - val_accuracy10: 0.5171 - 153s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 152s - loss: 2.6481 - accuracy10: 0.5707 - val_loss: 3.8714 - val_accuracy10: 0.5180 - 152s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 152s - loss: 2.6451 - accuracy10: 0.5715 - val_loss: 3.8849 - val_accuracy10: 0.5181 - 152s/epoch - 16ms/step
Epoch 12/50
9426/9426 - 152s - loss: 2.6414 - accuracy10: 0.5721 - val_loss: 3.8733 - val_accuracy10: 0.5188 - 152s/epoch - 16ms/step
Epoch 13/50
9426/9426 - 152s - loss: 2.6390 - accuracy10: 0.5726 - val_loss: 3.8661 - val_accuracy10: 0.5182 - 152s/epoch - 16ms/step
Epoch 14/50
9426/9426 - 152s - loss: 2.6366 - accuracy10: 0.5733 - val_loss: 3.9135 - val_accuracy10: 0.5197 - 152s/epoch - 16ms/step
Epoch 15/50
9426/9426 - 153s - loss: 2.6337 - accuracy10: 0.5739 - val_loss: 3.9033 - val_accuracy10: 0.5193 - 153s/epoch - 16ms/step
Epoch 16/50
9426/9426 - 153s - loss: 2.6316 - accuracy10: 0.5745 - val_loss: 3.9056 - val_accuracy10: 0.5198 - 153s/epoch - 16ms/step
Epoch 17/50
9426/9426 - 153s - loss: 2.6293 - accuracy10: 0.5748 - val_loss: 3.9240 - val_accuracy10: 0.5197 - 153s/epoch - 16ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 276s - 276s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.223543
{'0': {'precision': 0.508041299006679, 'recall': 0.14904955438039713, 'f1-score': 0.23048054567631257, 'support': 3133951}, '1': {'precision': 0.4377922588506243, 'recall': 0.885600964403171, 'f1-score': 0.585932041714864, 'support': 4497704}, '2': {'precision': 0.49426564694864994, 'recall': 0.1242071632840431, 'f1-score': 0.19852557105346766, 'support': 3186974}, 'accuracy': 0.44794308040325626, 'macro avg': {'precision': 0.4800330682686511, 'recall': 0.3862858940225371, 'f1-score': 0.33831271948154806, 'support': 10818629}, 'weighted avg': {'precision': 0.4747781162274163, 'recall': 0.44794308040325626, 'f1-score': 0.3688415101058083, 'support': 10818629}}
[[ 467114 2482144  184693]
 [ 294196 3983171  220337]
 [ 158131 2632998  395845]]
Evaluating performance on  train set...
9426/9426 - 63s - 63s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1604791
{'0': {'precision': 0.48153079687062, 'recall': 0.11683100365874582, 'f1-score': 0.18803916373411353, 'support': 646943}, '1': {'precision': 0.48022715589333426, 'recall': 0.8872298663299276, 'f1-score': 0.6231594388809689, 'support': 1121343}, '2': {'precision': 0.4639187053887648, 'recall': 0.1322274903597225, 'f1-score': 0.20579786160496855, 'support': 643913}, 'accuracy': 0.47907117115959336, 'macro avg': {'precision': 0.47522555271757305, 'recall': 0.3787627867827987, 'f1-score': 0.3389988214066837, 'support': 2412199}, 'weighted avg': {'precision': 0.4762234058358221, 'recall': 0.47907117115959336, 'f1-score': 0.39505116030492554, 'support': 2412199}}
[[ 75583 537565  33795]
 [ 61862 994889  64592]
 [ 19519 539251  85143]]
Evaluating performance on  val set...
3323/3323 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1027023
{'0': {'precision': 0.48274429183798445, 'recall': 0.10509200847477801, 'f1-score': 0.1726078065679018, 'support': 210035}, '1': {'precision': 0.5235806472628739, 'recall': 0.9110818570711359, 'f1-score': 0.6649993667412504, 'support': 432229}, '2': {'precision': 0.4636647857251792, 'recall': 0.11691189548013094, 'f1-score': 0.18673822329198864, 'support': 208037}, 'accuracy': 0.5176884420928589, 'macro avg': {'precision': 0.48999657494201254, 'recall': 0.37769525367534823, 'f1-score': 0.34144846553371355, 'support': 850301}, 'weighted avg': {'precision': 0.4988343750623425, 'recall': 0.5176884420928589, 'f1-score': 0.42635978518041096, 'support': 850301}}
[[ 22073 179752   8210]
 [ 18509 393796  19924]
 [  5142 178573  24322]]
testing model out of sample: results/universal/W6/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 118s - 118s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9374757
{'0': {'precision': 0.5120841523770111, 'recall': 0.20742288497091405, 'f1-score': 0.29525207321234853, 'support': 1026097}, '1': {'precision': 0.5873268730834418, 'recall': 0.9023093132442523, 'f1-score': 0.7115166942987172, 'support': 2434490}, '2': {'precision': 0.5249246386754621, 'recall': 0.16877261955422643, 'f1-score': 0.25542239150231655, 'support': 1024556}, 'accuracy': 0.5757711627031735, 'macro avg': {'precision': 0.5414452213786384, 'recall': 0.42616827258979767, 'f1-score': 0.4207303863377941, 'support': 4485143}, 'weighted avg': {'precision': 0.5558583304606517, 'recall': 0.5757711627031735, 'f1-score': 0.5120978500391856, 'support': 4485143}}
[[ 212836  750939   62322]
 [ 143653 2196663   94174]
 [  59138  792501  172917]]
Evaluating performance on  train set...
5153/5153 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9165124
{'0': {'precision': 0.521006740189341, 'recall': 0.166771667399912, 'f1-score': 0.25266615476495174, 'support': 284125}, '1': {'precision': 0.6131372335545866, 'recall': 0.9168919730433042, 'f1-score': 0.7348625835322706, 'support': 749350}, '2': {'precision': 0.49077342597261914, 'recall': 0.18430595496948868, 'f1-score': 0.26797578922141035, 'support': 285140}, 'accuracy': 0.5968459330433826, 'macro avg': {'precision': 0.5416391332388489, 'recall': 0.422656531804235, 'f1-score': 0.4185015091728776, 'support': 1318615}, 'weighted avg': {'precision': 0.5668254651298966, 'recall': 0.5968459330433826, 'f1-score': 0.5300020587746171, 'support': 1318615}}
[[ 47384 215819  20922]
 [ 28670 687073  33607]
 [ 14893 217694  52553]]
Evaluating performance on  val set...
1795/1795 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9044792
{'0': {'precision': 0.5314885186267823, 'recall': 0.16826562194733216, 'f1-score': 0.2556076226179319, 'support': 97251}, '1': {'precision': 0.6177999868365761, 'recall': 0.9222804193214369, 'f1-score': 0.7399416662118814, 'support': 264618}, '2': {'precision': 0.47905893737337085, 'recall': 0.1632808715459221, 'f1-score': 0.24355071795344832, 'support': 97023}, 'accuracy': 0.602010930676499, 'macro avg': {'precision': 0.5427824809455765, 'recall': 0.41794230427156376, 'f1-score': 0.4130333355944205, 'support': 458892}, 'weighted avg': {'precision': 0.5701745119166839, 'recall': 0.602010930676499, 'f1-score': 0.532347484909019, 'support': 458892}}
[[ 16364  74386   6501]
 [  9840 244052  10726]
 [  4585  76596  15842]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3444256
{'0': {'precision': 0.452253628724217, 'recall': 0.07153214113098115, 'f1-score': 0.12352634324465311, 'support': 82760}, '1': {'precision': 0.38068665662255996, 'recall': 0.924386873577159, 'f1-score': 0.5392826383874588, 'support': 100591}, '2': {'precision': 0.5067414911449603, 'recall': 0.07926718044598477, 'f1-score': 0.13709001646342064, 'support': 87716}, 'accuracy': 0.3905233761394784, 'macro avg': {'precision': 0.4465605921639124, 'recall': 0.3583953983847083, 'f1-score': 0.26663299936517754, 'support': 271067}, 'weighted avg': {'precision': 0.4433276585744759, 'recall': 0.3905233761394784, 'f1-score': 0.2821996330393068, 'support': 271067}}
[[ 5920 73854  2986]
 [ 3824 92985  3782]
 [ 3346 77417  6953]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2631782
{'0': {'precision': 0.5012987012987012, 'recall': 0.037845610824236875, 'f1-score': 0.07037802358089218, 'support': 15299}, '1': {'precision': 0.4579916352304412, 'recall': 0.9240155526141628, 'f1-score': 0.612430091018752, 'support': 24176}, '2': {'precision': 0.41683217477656404, 'recall': 0.11592101629384148, 'f1-score': 0.18139585133967154, 'support': 14484}, 'accuracy': 0.4558461053763042, 'macro avg': {'precision': 0.45870750376856884, 'recall': 0.3592607265774137, 'f1-score': 0.28806798864643857, 'support': 53959}, 'weighted avg': {'precision': 0.4592222210189909, 'recall': 0.4558461053763042, 'f1-score': 0.3430412122915032, 'support': 53959}}
[[  579 13892   828]
 [  316 22339  1521]
 [  260 12545  1679]]
Evaluating performance on  val set...
81/81 - 1s - 649ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2353796
{'0': {'precision': 0.45335276967930027, 'recall': 0.05375043207742827, 'f1-score': 0.09610630407911001, 'support': 5786}, '1': {'precision': 0.45117953678327694, 'recall': 0.9287610619469027, 'f1-score': 0.6073275706173822, 'support': 9040}, '2': {'precision': 0.47466467958271236, 'recall': 0.10961968680089486, 'f1-score': 0.1781070879351321, 'support': 5811}, 'accuracy': 0.4527789891941658, 'macro avg': {'precision': 0.45973232868176317, 'recall': 0.364043726941742, 'f1-score': 0.2938469875438748, 'support': 20637}, 'weighted avg': {'precision': 0.4584018312225806, 'recall': 0.4527789891941658, 'f1-score': 0.3431357562520676, 'support': 20637}}
[[ 311 5219  256]
 [ 195 8396  449]
 [ 180 4994  637]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6450863
{'0': {'precision': 0.3898905978620924, 'recall': 0.32541283718149894, 'f1-score': 0.35474569091916197, 'support': 66915}, '1': {'precision': 0.8010636491986404, 'recall': 0.9117527862208713, 'f1-score': 0.8528316274805392, 'support': 424410}, '2': {'precision': 0.5396112865035517, 'recall': 0.16122328666175387, 'f1-score': 0.24826944463357617, 'support': 67850}, 'accuracy': 0.750518174095766, 'macro avg': {'precision': 0.5768551778547616, 'recall': 0.46612963668804136, 'f1-score': 0.4852822543444258, 'support': 559175}, 'weighted avg': {'precision': 0.7201351607307245, 'recall': 0.750518174095766, 'f1-score': 0.7198697379984075, 'support': 559175}}
[[ 21775  42833   2307]
 [ 30427 386957   7026]
 [  3647  53264  10939]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57053113
{'0': {'precision': 0.41437072955697596, 'recall': 0.2786630104498629, 'f1-score': 0.33322993751938673, 'support': 13493}, '1': {'precision': 0.8440920665365919, 'recall': 0.9344071752162174, 'f1-score': 0.8869564461973495, 'support': 109265}, '2': {'precision': 0.4750160153747598, 'recall': 0.21944362237348328, 'f1-score': 0.3002024291497976, 'support': 13516}, 'accuracy': 0.7985675917636527, 'macro avg': {'precision': 0.5778262704894425, 'recall': 0.47750460267985456, 'f1-score': 0.5067962709555113, 'support': 136274}, 'weighted avg': {'precision': 0.7649378485099009, 'recall': 0.7985675917636527, 'f1-score': 0.7739341596569496, 'support': 136274}}
[[  3760   8930    803]
 [  4692 102098   2475]
 [   622   9928   2966]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56772655
{'0': {'precision': 0.4089952656496581, 'recall': 0.3278515707358212, 'f1-score': 0.36395552954944416, 'support': 4743}, '1': {'precision': 0.8568957232099952, 'recall': 0.914180252230083, 'f1-score': 0.8846115686079968, 'support': 39012}, '2': {'precision': 0.42158273381294964, 'recall': 0.26354845963570944, 'f1-score': 0.32433928324339284, 'support': 4447}, 'accuracy': 0.7964607277706319, 'macro avg': {'precision': 0.5624912408908677, 'recall': 0.5018600942005379, 'f1-score': 0.5243021271336114, 'support': 48202}, 'weighted avg': {'precision': 0.7726621077156726, 'recall': 0.7964607277706319, 'f1-score': 0.7816904772368689, 'support': 48202}}
[[ 1555  2895   293]
 [ 2033 35664  1315]
 [  214  3061  1172]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1825657
{'0': {'precision': 0.5086433756805807, 'recall': 0.24539494565871703, 'f1-score': 0.3310667641217598, 'support': 91367}, '1': {'precision': 0.4505600939625552, 'recall': 0.8032236137913792, 'f1-score': 0.577293363543711, 'support': 127993}, '2': {'precision': 0.4775370047605421, 'recall': 0.20098098251530047, 'f1-score': 0.2828984881875202, 'support': 91337}, 'accuracy': 0.4621383534440307, 'macro avg': {'precision': 0.4789134914678927, 'recall': 0.41653318065513223, 'f1-score': 0.3970862052843303, 'support': 310697}, 'weighted avg': {'precision': 0.4755712311872035, 'recall': 0.4621383534440307, 'f1-score': 0.41834065257516667, 'support': 310697}}
[[ 22421  60613   8333]
 [ 13435 102807  11751]
 [  8224  64756  18357]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1130226
{'0': {'precision': 0.4571337001228567, 'recall': 0.24224411231884058, 'f1-score': 0.31667560916945736, 'support': 35328}, '1': {'precision': 0.5090664091926704, 'recall': 0.7873153921890383, 'f1-score': 0.6183299074032308, 'support': 60940}, '2': {'precision': 0.4671484157865481, 'recall': 0.24224605096275798, 'f1-score': 0.3190463535932576, 'support': 34692}, 'accuracy': 0.49588423946243126, 'macro avg': {'precision': 0.47778284170069174, 'recall': 0.42393518515687895, 'f1-score': 0.41801729005531524, 'support': 130960}, 'weighted avg': {'precision': 0.4839526509973163, 'recall': 0.49588423946243126, 'f1-score': 0.4576733092299081, 'support': 130960}}
[[ 8558 23388  3382]
 [ 6757 47979  6204]
 [ 3406 22882  8404]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.125274
{'0': {'precision': 0.44160956407639596, 'recall': 0.26168466522678185, 'f1-score': 0.32863187588152326, 'support': 11575}, '1': {'precision': 0.4994624739635826, 'recall': 0.7485147517873326, 'f1-score': 0.5991375836221489, 'support': 19862}, '2': {'precision': 0.4464888071143821, 'recall': 0.24867634500426986, 'f1-score': 0.31943835015357613, 'support': 11710}, 'accuracy': 0.4822583261872204, 'macro avg': {'precision': 0.46252028171812026, 'recall': 0.4196252540061281, 'f1-score': 0.4157359365524161, 'support': 43147}, 'weighted avg': {'precision': 0.469565399526233, 'recall': 0.4822583261872204, 'f1-score': 0.4506595529128359, 'support': 43147}}
[[ 3029  7447  1099]
 [ 2484 14867  2511]
 [ 1346  7452  2912]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.461441
{'0': {'precision': 0.4103531524099528, 'recall': 0.336902390438247, 'f1-score': 0.37001788556520027, 'support': 100400}, '1': {'precision': 0.2614158436732166, 'recall': 0.5281700793465257, 'f1-score': 0.3497327469245408, 'support': 72719}, '2': {'precision': 0.4648481384394032, 'recall': 0.22048237823688885, 'f1-score': 0.2990989619991503, 'support': 106970}, 'accuracy': 0.3420984044357329, 'macro avg': {'precision': 0.3788723781741909, 'recall': 0.3618516160072205, 'f1-score': 0.3396165314962971, 'support': 280089}, 'weighted avg': {'precision': 0.392497244114888, 'recall': 0.3420984044357329, 'f1-score': 0.3376663392685928, 'support': 280089}}
[[33825 51879 14696]
 [21855 38408 12456]
 [26749 56636 23585]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3890074
{'0': {'precision': 0.43116022099447515, 'recall': 0.09789999247309131, 'f1-score': 0.15956815997709942, 'support': 39857}, '1': {'precision': 0.32890445972148774, 'recall': 0.8059064895799589, 'f1-score': 0.4671548837354864, 'support': 37044}, '2': {'precision': 0.4119761291197613, 'recall': 0.16129888750232324, 'f1-score': 0.23183041080730407, 'support': 37663}, 'accuracy': 0.34767466219754894, 'macro avg': {'precision': 0.3906802699452414, 'recall': 0.3550351231851245, 'f1-score': 0.2861844848399633, 'support': 114564}, 'weighted avg': {'precision': 0.3917892766064135, 'recall': 0.34767466219754894, 'f1-score': 0.2827818723817264, 'support': 114564}}
[[ 3902 31665  4290]
 [ 2809 29854  4381]
 [ 2339 29249  6075]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4633644
{'0': {'precision': 0.4143835616438356, 'recall': 0.06867753182518446, 'f1-score': 0.11782708492731446, 'support': 12333}, '1': {'precision': 0.302760736196319, 'recall': 0.8579293026849527, 'f1-score': 0.4475739406459414, 'support': 10354}, '2': {'precision': 0.44644437887282384, 'recall': 0.12518616581168293, 'f1-score': 0.1955411954765751, 'support': 12086}, 'accuracy': 0.32332556868835016, 'macro avg': {'precision': 0.38786289223765946, 'recall': 0.35059766677394005, 'f1-score': 0.2536474070166103, 'support': 34773}, 'weighted avg': {'precision': 0.39229010701944206, 'recall': 0.32332556868835016, 'f1-score': 0.24302340633211209, 'support': 34773}}
[[  847 10532   954]
 [  549  8883   922]
 [  648  9925  1513]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4228284
{'0': {'precision': 0.5257551010458058, 'recall': 0.1341790422626343, 'f1-score': 0.21379501769481643, 'support': 160733}, '1': {'precision': 0.2743943568890794, 'recall': 0.8663913152199219, 'f1-score': 0.41678799719591664, 'support': 115973}, '2': {'precision': 0.5467154805488585, 'recall': 0.11193652380052775, 'f1-score': 0.18582629369214426, 'support': 164093}, 'accuracy': 0.3185420112114592, 'macro avg': {'precision': 0.44895497949458124, 'recall': 0.3708356270943613, 'f1-score': 0.27213643619429245, 'support': 440799}, 'weighted avg': {'precision': 0.4674255494173003, 'recall': 0.3185420112114592, 'f1-score': 0.2567901991355879, 'support': 440799}}
[[ 21567 130726   8440]
 [  8706 100478   6789]
 [ 10748 134977  18368]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3376737
{'0': {'precision': 0.4742491597094221, 'recall': 0.16911210346227454, 'f1-score': 0.24931955824723906, 'support': 51729}, '1': {'precision': 0.3594006287588846, 'recall': 0.7847123778258599, 'f1-score': 0.49300396090655546, 'support': 53612}, '2': {'precision': 0.4595340964767716, 'recall': 0.19609594769254163, 'f1-score': 0.27488909316174415, 'support': 52612}, 'accuracy': 0.3870455135388375, 'macro avg': {'precision': 0.43106129498169277, 'recall': 0.3833068096602254, 'f1-score': 0.33907087077184617, 'support': 157953}, 'weighted avg': {'precision': 0.4303661796576571, 'recall': 0.3870455135388375, 'f1-score': 0.34054715485061604, 'support': 157953}}
[[ 8748 37426  5555]
 [ 4963 42070  6579]
 [ 4735 37560 10317]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3360888
{'0': {'precision': 0.5102908277404922, 'recall': 0.12311096718480138, 'f1-score': 0.19836507522393249, 'support': 18528}, '1': {'precision': 0.3805046693509286, 'recall': 0.8652509467427256, 'f1-score': 0.5285659902193328, 'support': 20861}, '2': {'precision': 0.46741289041343204, 'recall': 0.14337929888685827, 'f1-score': 0.2194439735548398, 'support': 18057}, 'accuracy': 0.39898339309960656, 'macro avg': {'precision': 0.45273612916828426, 'recall': 0.3772470709381284, 'f1-score': 0.3154583463327017, 'support': 57446}, 'weighted avg': {'precision': 0.4496823264613881, 'recall': 0.39898339309960656, 'f1-score': 0.324900307526969, 'support': 57446}}
[[ 2281 14935  1312]
 [ 1173 18050  1638]
 [ 1016 14452  2589]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.704865
{'0': {'precision': 0.45067073444299877, 'recall': 0.470122360258137, 'f1-score': 0.46019109090816535, 'support': 192301}, '1': {'precision': 0.7570726476852261, 'recall': 0.8162814753673339, 'f1-score': 0.7855629813506461, 'support': 755988}, '2': {'precision': 0.5201607675353299, 'recall': 0.3363796428271988, 'f1-score': 0.4085539714867617, 'support': 190832}, 'accuracy': 0.6774486643648919, 'macro avg': {'precision': 0.5759680498878516, 'recall': 0.5409278261508899, 'f1-score': 0.5514360145818576, 'support': 1139121}, 'weighted avg': {'precision': 0.6656585114949894, 'recall': 0.6774486643648919, 'f1-score': 0.6674765592108345, 'support': 1139121}}
[[ 90405  88594  13302]
 [ 92975 617099  45914]
 [ 17221 109419  64192]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6322688
{'0': {'precision': 0.4243983069175395, 'recall': 0.5201347999772808, 'f1-score': 0.4674146980510918, 'support': 52819}, '1': {'precision': 0.835309429590286, 'recall': 0.7969094288974857, 'f1-score': 0.8156577250972455, 'support': 278654}, '2': {'precision': 0.4659206135580096, 'recall': 0.47373748734675514, 'f1-score': 0.46979653675629957, 'support': 53346}, 'accuracy': 0.7141201447953454, 'macro avg': {'precision': 0.575209450021945, 'recall': 0.5969272387405072, 'f1-score': 0.5842896533015457, 'support': 384819}, 'weighted avg': {'precision': 0.7277021379323647, 'recall': 0.7141201447953454, 'f1-score': 0.7199135976014959, 'support': 384819}}
[[ 27473  20454   4892]
 [ 32515 222062  24077]
 [  4746  23328  25272]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6189962
{'0': {'precision': 0.4563174196304603, 'recall': 0.4871999543873653, 'f1-score': 0.47125327450710053, 'support': 17539}, '1': {'precision': 0.8279223158666178, 'recall': 0.8322703544666161, 'f1-score': 0.8300906414179319, 'support': 95016}, '2': {'precision': 0.4702519975414874, 'recall': 0.42609712630875474, 'f1-score': 0.44708700987553324, 'support': 17956}, 'accuracy': 0.7300150945131062, 'macro avg': {'precision': 0.5848305776795218, 'recall': 0.581855811720912, 'f1-score': 0.5828103086001886, 'support': 130511}, 'weighted avg': {'precision': 0.7287743014392362, 'recall': 0.7300150945131062, 'f1-score': 0.7291730039297172, 'support': 130511}}
[[ 8545  7643  1351]
 [ 8669 79079  7268]
 [ 1512  8793  7651]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
6203/6203 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63031334
{'0': {'precision': 0.4470810837725756, 'recall': 0.3103771814599362, 'f1-score': 0.3663931678738505, 'support': 202502}, '1': {'precision': 0.790488219198274, 'recall': 0.926315691434416, 'f1-score': 0.8530288599675404, 'support': 1181052}, '2': {'precision': 0.5095573599570313, 'recall': 0.15787000783085356, 'f1-score': 0.24105641539185862, 'support': 204320}, 'accuracy': 0.7488849870959534, 'macro avg': {'precision': 0.5823755543092936, 'recall': 0.4648542935750686, 'f1-score': 0.4868261477444165, 'support': 1587874}, 'weighted avg': {'precision': 0.7105445807873261, 'recall': 0.7488849870959534, 'f1-score': 0.7122224037902495, 'support': 1587874}}
[[  62852  128628   11022]
 [  67001 1094027   20024]
 [  10730  161334   32256]]
Evaluating performance on  train set...
1766/1766 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6324215
{'0': {'precision': 0.5432744978697505, 'recall': 0.15191898561824527, 'f1-score': 0.23744097891866733, 'support': 58755}, '1': {'precision': 0.7714097670765306, 'recall': 0.9623280385229667, 'f1-score': 0.8563569942936377, 'support': 333723}, '2': {'precision': 0.4780710870920806, 'recall': 0.15458807319409204, 'f1-score': 0.23363002653732368, 'support': 59513}, 'accuracy': 0.7506277779867299, 'macro avg': {'precision': 0.5975851173461205, 'recall': 0.42294503244510134, 'f1-score': 0.44247599991654285, 'support': 451991}, 'weighted avg': {'precision': 0.7031306362881765, 'recall': 0.7506277779867299, 'f1-score': 0.6939095992892285, 'support': 451991}}
[[  8926  46295   3534]
 [  6062 321151   6510]
 [  1442  48871   9200]]
Evaluating performance on  val set...
579/579 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5895342
{'0': {'precision': 0.5190256045519204, 'recall': 0.1688454419250347, 'f1-score': 0.2548009776536313, 'support': 17288}, '1': {'precision': 0.801581517382115, 'recall': 0.9631501055231056, 'f1-score': 0.8749696702107772, 'support': 114193}, '2': {'precision': 0.4263077510500191, 'recall': 0.13459104333674884, 'f1-score': 0.20459022401392646, 'support': 16591}, 'accuracy': 0.7775744232535523, 'macro avg': {'precision': 0.5823049576613515, 'recall': 0.42219553026162976, 'f1-score': 0.44478695729277834, 'support': 148072}, 'weighted avg': {'precision': 0.7265437406368545, 'recall': 0.7775744232535523, 'f1-score': 0.7274485875700357, 'support': 148072}}
[[  2919  13314   1055]
 [  2258 109985   1950]
 [   447  13911   2233]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9660091
{'0': {'precision': 0.5955622372560483, 'recall': 0.14033062188401993, 'f1-score': 0.227140725954162, 'support': 304880}, '1': {'precision': 0.5655708658734377, 'recall': 0.9360038007215168, 'f1-score': 0.7050951135654644, 'support': 709339}, '2': {'precision': 0.4940172205363531, 'recall': 0.12810399813192333, 'f1-score': 0.20345096485278918, 'support': 312621}, 'accuracy': 0.5628229477555696, 'macro avg': {'precision': 0.5517167745552797, 'recall': 0.40147947357915337, 'f1-score': 0.3785622681241385, 'support': 1326840}, 'weighted avg': {'precision': 0.5556032715502379, 'recall': 0.5628229477555696, 'f1-score': 0.4770772447119183, 'support': 1326840}}
[[ 42784 246453  15643]
 [ 20020 663944  25375]
 [  9034 263539  40048]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86413145
{'0': {'precision': 0.5263366673277987, 'recall': 0.23149971336706462, 'f1-score': 0.32156489375513914, 'support': 80242}, '1': {'precision': 0.6349920128832842, 'recall': 0.8855517973656447, 'f1-score': 0.739627907504439, 'support': 220851}, '2': {'precision': 0.5118852242045635, 'recall': 0.2418035861655038, 'f1-score': 0.3284530199062436, 'support': 79974}, 'accuracy': 0.6127242715847869, 'macro avg': {'precision': 0.5577379681385488, 'recall': 0.45295169896607107, 'f1-score': 0.4632152737219406, 'support': 381067}, 'weighted avg': {'precision': 0.5862760008542833, 'recall': 0.6127242715847869, 'f1-score': 0.5653028864187785, 'support': 381067}}
[[ 18576  56052   5614]
 [ 12450 195575  12826]
 [  4267  56369  19338]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8080538
{'0': {'precision': 0.5143734538940544, 'recall': 0.23433856676511736, 'f1-score': 0.32198638366039245, 'support': 25732}, '1': {'precision': 0.6706160920801222, 'recall': 0.898824913308255, 'f1-score': 0.7681288417437198, 'support': 81611}, '2': {'precision': 0.5230980594195432, 'recall': 0.23975756621669486, 'f1-score': 0.32880852786398596, 'support': 25409}, 'accuracy': 0.6438773050500181, 'macro avg': {'precision': 0.56936253513124, 'recall': 0.45764034876335574, 'f1-score': 0.47297458442269935, 'support': 132752}, 'weighted avg': {'precision': 0.6120955330100024, 'recall': 0.6438773050500181, 'f1-score': 0.5975639720109072, 'support': 132752}}
[[ 6030 18056  1646]
 [ 4349 73354  3908]
 [ 1344 17973  6092]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
7324/7324 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98409766
{'0': {'precision': 0.5667600953877103, 'recall': 0.20521345923660061, 'f1-score': 0.3013232747030556, 'support': 488735}, '1': {'precision': 0.531542544953687, 'recall': 0.887420905487077, 'f1-score': 0.6648542869813656, 'support': 908881}, '2': {'precision': 0.5377129898141936, 'recall': 0.20326563122262048, 'f1-score': 0.2950114002972139, 'support': 477090}, 'accuracy': 0.5354604935387202, 'macro avg': {'precision': 0.5453385433851969, 'recall': 0.43196666531543265, 'f1-score': 0.42039632066054505, 'support': 1874706}, 'weighted avg': {'precision': 0.542294047882611, 'recall': 0.5354604935387202, 'f1-score': 0.4759613767895905, 'support': 1874706}}
[[100295 356854  31586]
 [ 50534 806560  51787]
 [ 26133 353981  96976]]
Evaluating performance on  train set...
2046/2046 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94978005
{'0': {'precision': 0.5711612033137918, 'recall': 0.16869624595574487, 'f1-score': 0.26046301467865723, 'support': 123014}, '1': {'precision': 0.5710295551966554, 'recall': 0.9155251553815651, 'f1-score': 0.7033604865380773, 'support': 276899}, '2': {'precision': 0.5317920404876927, 'recall': 0.18666978900023418, 'f1-score': 0.2763389895343347, 'support': 123839}, 'accuracy': 0.5677820800684293, 'macro avg': {'precision': 0.5579942663327132, 'recall': 0.4236303967791814, 'f1-score': 0.41338749691702303, 'support': 523752}, 'weighted avg': {'precision': 0.5617829269784113, 'recall': 0.5677820800684293, 'f1-score': 0.49836937476998633, 'support': 523752}}
[[ 20752  94654   7608]
 [ 10646 253508  12745]
 [  4935  95787  23117]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93333477
{'0': {'precision': 0.5975208508684674, 'recall': 0.17717928937695693, 'f1-score': 0.2733143167142082, 'support': 44074}, '1': {'precision': 0.5727086470341389, 'recall': 0.9219367785261569, 'f1-score': 0.7065236423987272, 'support': 100662}, '2': {'precision': 0.5137804793810873, 'recall': 0.16582690506978195, 'f1-score': 0.2507289612512852, 'support': 44854}, 'accuracy': 0.5699192995411151, 'macro avg': {'precision': 0.5613366590945645, 'recall': 0.42164765765763196, 'f1-score': 0.41018897345474015, 'support': 189590}, 'weighted avg': {'precision': 0.5645352678468623, 'recall': 0.5699192995411151, 'f1-score': 0.49798161777502953, 'support': 189590}}
[[ 7809 33451  2814]
 [ 3633 92804  4225]
 [ 1627 35789  7438]]
testing model on single stock: results/universal/W6/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
29350/29350 - 187s - 187s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3818996
{'0': {'precision': 0.5464629893413232, 'recall': 0.11263051968956714, 'f1-score': 0.1867668536779444, 'support': 2469455}, '1': {'precision': 0.3513632351622518, 'recall': 0.8979886780307095, 'f1-score': 0.5050942071967067, 'support': 2535248}, '2': {'precision': 0.4886310392247241, 'recall': 0.10226168841962434, 'f1-score': 0.16912794064858178, 'support': 2508701}, 'accuracy': 0.3741718134683028, 'macro avg': {'precision': 0.4621524212427664, 'recall': 0.37096029537996694, 'f1-score': 0.28699633384107764, 'support': 7513404}, 'weighted avg': {'precision': 0.4613205781689113, 'recall': 0.3741718134683028, 'f1-score': 0.2882904809976067, 'support': 7513404}}
[[ 278136 2052398  138921]
 [ 129063 2276624  129561]
 [ 101776 2150381  256544]]
Evaluating performance on  train set...
5452/5452 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4264657
{'0': {'precision': 0.5634051388528419, 'recall': 0.047136789625910905, 'f1-score': 0.08699520300082955, 'support': 460532}, '1': {'precision': 0.3463442276091617, 'recall': 0.9369922759705507, 'f1-score': 0.5057471133900676, 'support': 475529}, '2': {'precision': 0.44623114151492355, 'recall': 0.06843718302010822, 'f1-score': 0.11867371992911509, 'support': 459414}, 'accuracy': 0.3573808201508447, 'macro avg': {'precision': 0.4519935026589757, 'recall': 0.3508554162055233, 'f1-score': 0.2371386787733374, 'support': 1395475}, 'weighted avg': {'precision': 0.45086271933561767, 'recall': 0.3573808201508447, 'f1-score': 0.24012029042380406, 'support': 1395475}}
[[ 21708 420491  18333]
 [  9277 445567  20685]
 [  7545 420428  31441]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3316189
{'0': {'precision': 0.5453387131025695, 'recall': 0.034311367644700975, 'f1-score': 0.06456073309617487, 'support': 149688}, '1': {'precision': 0.4132355812532673, 'recall': 0.9543775092612347, 'f1-score': 0.5767460804667252, 'support': 206236}, '2': {'precision': 0.42889082778929, 'recall': 0.05309202843275572, 'f1-score': 0.09448752680550467, 'support': 148139}, 'accuracy': 0.4162733626550649, 'macro avg': {'precision': 0.4624883740483756, 'recall': 0.34726030177956374, 'f1-score': 0.24526478012280153, 'support': 504063}, 'weighted avg': {'precision': 0.45706622576964373, 'recall': 0.4162733626550649, 'f1-score': 0.282915150289302, 'support': 504063}}
[[  5136 140649   3903]
 [  2839 196827   6570]
 [  1443 138831   7865]]
training model: results/universal/W6/deepLOB_L1/h20
Epoch 1/50
9426/9426 - 154s - loss: 2.9306 - accuracy20: 0.4968 - val_loss: 3.5907 - val_accuracy20: 0.4650 - 154s/epoch - 16ms/step
Epoch 2/50
9426/9426 - 152s - loss: 2.8560 - accuracy20: 0.5195 - val_loss: 3.6425 - val_accuracy20: 0.4735 - 152s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 154s - loss: 2.8274 - accuracy20: 0.5268 - val_loss: 3.5817 - val_accuracy20: 0.4751 - 154s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 152s - loss: 2.8124 - accuracy20: 0.5306 - val_loss: 3.6119 - val_accuracy20: 0.4756 - 152s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 149s - loss: 2.8021 - accuracy20: 0.5326 - val_loss: 3.5986 - val_accuracy20: 0.4773 - 149s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 153s - loss: 2.7940 - accuracy20: 0.5345 - val_loss: 3.5974 - val_accuracy20: 0.4765 - 153s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 155s - loss: 2.7878 - accuracy20: 0.5361 - val_loss: 3.5803 - val_accuracy20: 0.4774 - 155s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 153s - loss: 2.7825 - accuracy20: 0.5370 - val_loss: 3.6210 - val_accuracy20: 0.4764 - 153s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 152s - loss: 2.7781 - accuracy20: 0.5378 - val_loss: 3.6368 - val_accuracy20: 0.4769 - 152s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 150s - loss: 2.7733 - accuracy20: 0.5390 - val_loss: 3.6555 - val_accuracy20: 0.4777 - 150s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 150s - loss: 2.7697 - accuracy20: 0.5400 - val_loss: 3.6588 - val_accuracy20: 0.4766 - 150s/epoch - 16ms/step
Epoch 12/50
9426/9426 - 149s - loss: 2.7666 - accuracy20: 0.5406 - val_loss: 3.6456 - val_accuracy20: 0.4764 - 149s/epoch - 16ms/step
Epoch 13/50
9426/9426 - 149s - loss: 2.7643 - accuracy20: 0.5411 - val_loss: 3.6366 - val_accuracy20: 0.4768 - 149s/epoch - 16ms/step
Epoch 14/50
9426/9426 - 147s - loss: 2.7619 - accuracy20: 0.5412 - val_loss: 3.6966 - val_accuracy20: 0.4774 - 147s/epoch - 16ms/step
Epoch 15/50
9426/9426 - 147s - loss: 2.7595 - accuracy20: 0.5423 - val_loss: 3.6543 - val_accuracy20: 0.4770 - 147s/epoch - 16ms/step
Epoch 16/50
9426/9426 - 150s - loss: 2.7586 - accuracy20: 0.5421 - val_loss: 3.6997 - val_accuracy20: 0.4766 - 150s/epoch - 16ms/step
Epoch 17/50
9426/9426 - 149s - loss: 2.7557 - accuracy20: 0.5429 - val_loss: 3.6914 - val_accuracy20: 0.4769 - 149s/epoch - 16ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 216s - 216s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1776098
{'0': {'precision': 0.4494531167374587, 'recall': 0.2259433887178573, 'f1-score': 0.3007150894184859, 'support': 3141070}, '1': {'precision': 0.44237597794631506, 'recall': 0.8434599096859196, 'f1-score': 0.580363957787649, 'support': 4556986}, '2': {'precision': 0.5039330349526475, 'recall': 0.0889753260058329, 'f1-score': 0.15124632750173153, 'support': 3120573}, 'accuracy': 0.4465439197517541, 'macro avg': {'precision': 0.46525404321214037, 'recall': 0.3861262081365366, 'f1-score': 0.3441084582359555, 'support': 10818629}, 'weighted avg': {'precision': 0.46218653604902105, 'recall': 0.4465439197517541, 'f1-score': 0.37539440370990557, 'support': 10818629}}
[[ 709704 2323088  108278]
 [ 548309 3843635  165042]
 [ 321026 2521893  277654]]
Evaluating performance on  train set...
9426/9426 - 65s - 65s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1490948
{'0': {'precision': 0.47741948811171475, 'recall': 0.1664259121906257, 'f1-score': 0.24681382757184508, 'support': 694345}, '1': {'precision': 0.43965752574761136, 'recall': 0.863720707552827, 'f1-score': 0.582703162470443, 'support': 1025563}, '2': {'precision': 0.5052443952536614, 'recall': 0.11341617903453895, 'f1-score': 0.18524823197022514, 'support': 692291}, 'accuracy': 0.44767202042617543, 'macro avg': {'precision': 0.47410713637099583, 'recall': 0.3811875995926639, 'f1-score': 0.33825507400417104, 'support': 2412199}, 'weighted avg': {'precision': 0.469350361717992, 'recall': 0.44767202042617543, 'f1-score': 0.37195042128653016, 'support': 2412199}}
[[115557 554170  24618]
 [ 87494 885800  52269]
 [ 38994 574780  78517]]
Evaluating performance on  val set...
3323/3323 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1014874
{'0': {'precision': 0.48301514617823177, 'recall': 0.14883280729707085, 'f1-score': 0.22754999767684211, 'support': 230339}, '1': {'precision': 0.4748481585417747, 'recall': 0.8870893944854699, 'f1-score': 0.6185786778506384, 'support': 391221}, '2': {'precision': 0.5075621582585371, 'recall': 0.10754084313699774, 'f1-score': 0.1774781209641927, 'support': 228741}, 'accuracy': 0.4773944756033452, 'macro avg': {'precision': 0.4884751543261812, 'recall': 0.3811543483065128, 'f1-score': 0.3412022654972244, 'support': 850301}, 'weighted avg': {'precision': 0.4858609749143367, 'recall': 0.4773944756033452, 'f1-score': 0.39399122276671567, 'support': 850301}}
[[ 34282 189636   6421]
 [ 26728 347048  17445]
 [  9965 194177  24599]]
testing model out of sample: results/universal/W6/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 105s - 105s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0431921
{'0': {'precision': 0.503090439338661, 'recall': 0.26996108735895985, 'f1-score': 0.35137332339008687, 'support': 1239186}, '1': {'precision': 0.4926294031364812, 'recall': 0.8597997110318034, 'f1-score': 0.6263731149014763, 'support': 2011294}, '2': {'precision': 0.5778705192013479, 'recall': 0.14500879997213814, 'f1-score': 0.23184038692509154, 'support': 1234663}, 'accuracy': 0.5000685596869486, 'macro avg': {'precision': 0.5245301205588301, 'recall': 0.4249231994543005, 'f1-score': 0.4031956084055515, 'support': 4485143}, 'weighted avg': {'precision': 0.5189846880607814, 'recall': 0.5000685596869486, 'f1-score': 0.4417879515821931, 'support': 4485143}}
[[ 334532  848898   55756]
 [ 206955 1729310   75029]
 [ 123467  932159  179037]]
Evaluating performance on  train set...
5153/5153 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.021693
{'0': {'precision': 0.5271993326779277, 'recall': 0.20493564095586064, 'f1-score': 0.2951421173547034, 'support': 345406}, '1': {'precision': 0.5197497410688203, 'recall': 0.9029845403387856, 'f1-score': 0.6597521226042239, 'support': 628539}, '2': {'precision': 0.5466878884341367, 'recall': 0.14649084631676676, 'f1-score': 0.23106528643473645, 'support': 344670}, 'accuracy': 0.5223950887863402, 'macro avg': {'precision': 0.5312123207269616, 'recall': 0.4181370092038043, 'f1-score': 0.39531984213122123, 'support': 1318615}, 'weighted avg': {'precision': 0.5287424378694323, 'recall': 0.5223950887863402, 'f1-score': 0.45219041938095317, 'support': 1318615}}
[[ 70786 256513  18107]
 [ 37218 567561  23760]
 [ 26264 267915  50491]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0033761
{'0': {'precision': 0.5380142923590849, 'recall': 0.21541886766896925, 'f1-score': 0.3076541776987898, 'support': 118128}, '1': {'precision': 0.5292512914405283, 'recall': 0.9073893039399457, 'f1-score': 0.6685554654292005, 'support': 222998}, '2': {'precision': 0.5470976118077147, 'recall': 0.1359730312653907, 'f1-score': 0.2178120855578604, 'support': 117766}, 'accuracy': 0.5312927660538863, 'macro avg': {'precision': 0.5381210652024426, 'recall': 0.41959373429143515, 'f1-score': 0.3980072428952836, 'support': 458892}, 'weighted avg': {'precision': 0.5360869859762128, 'recall': 0.5312927660538863, 'f1-score': 0.4599774292225414, 'support': 458892}}
[[ 25447  86872   5809]
 [ 13205 202346   7447]
 [  8646  93107  16013]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.395572
{'0': {'precision': 0.47896827091429306, 'recall': 0.1159875904860393, 'f1-score': 0.1867512508637412, 'support': 96700}, '1': {'precision': 0.2718664747527155, 'recall': 0.9046419024281577, 'f1-score': 0.4180876391480599, 'support': 71824}, '2': {'precision': 0.5340882828749711, 'recall': 0.045073773928985886, 'f1-score': 0.08313173916562497, 'support': 102543}, 'accuracy': 0.2981292447992563, 'macro avg': {'precision': 0.4283076761806599, 'recall': 0.355234422281061, 'f1-score': 0.22932354305914204, 'support': 271067}, 'weighted avg': {'precision': 0.44494454976407805, 'recall': 0.2981292447992563, 'f1-score': 0.20884928996135532, 'support': 271067}}
[[11216 83180  2304]
 [ 5121 64975  1728]
 [ 7080 90841  4622]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3212042
{'0': {'precision': 0.5165421558164355, 'recall': 0.05284419696473414, 'f1-score': 0.09587955625990491, 'support': 18318}, '1': {'precision': 0.3487043999593537, 'recall': 0.9317910285652221, 'f1-score': 0.5074904982327453, 'support': 18414}, '2': {'precision': 0.46979166666666666, 'recall': 0.07853950194462181, 'f1-score': 0.1345799970159646, 'support': 17227}, 'accuracy': 0.3609963120146778, 'macro avg': {'precision': 0.44501274081415193, 'recall': 0.3543915758248594, 'f1-score': 0.24598335050287157, 'support': 53959}, 'weighted avg': {'precision': 0.44434038942092463, 'recall': 0.3609963120146778, 'f1-score': 0.24870107590245802, 'support': 53959}}
[[  968 16653   697]
 [  426 17158   830]
 [  480 15394  1353]]
Evaluating performance on  val set...
81/81 - 1s - 596ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3008443
{'0': {'precision': 0.46986970684039087, 'recall': 0.08232272792124412, 'f1-score': 0.14009955080733277, 'support': 7009}, '1': {'precision': 0.33362307817678055, 'recall': 0.9150648189539562, 'f1-score': 0.48897205191496135, 'support': 6711}, '2': {'precision': 0.5109780439121756, 'recall': 0.07402052913112621, 'f1-score': 0.1293092562192196, 'support': 6917}, 'accuracy': 0.35034161942142755, 'macro avg': {'precision': 0.43815694297644897, 'recall': 0.35713602533544214, 'f1-score': 0.25279361964717123, 'support': 20637}, 'weighted avg': {'precision': 0.43934178333232504, 'recall': 0.35034161942142755, 'f1-score': 0.2499336782128334, 'support': 20637}}
[[ 577 6217  215]
 [ 295 6141  275]
 [ 356 6049  512]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78243667
{'0': {'precision': 0.3751801742776649, 'recall': 0.5104858480053488, 'f1-score': 0.4324974981590227, 'support': 89740}, '1': {'precision': 0.7502349050838533, 'recall': 0.8199142587127192, 'f1-score': 0.7835284828288204, 'support': 378814}, '2': {'precision': 0.6309265840339776, 'recall': 0.16064709063020713, 'f1-score': 0.2560886582523418, 'support': 90621}, 'accuracy': 0.6634130638887646, 'macro avg': {'precision': 0.5854472211318319, 'recall': 0.49701573244942504, 'f1-score': 0.49070487974672833, 'support': 559175}, 'weighted avg': {'precision': 0.6707083688395502, 'recall': 0.6634130638887646, 'f1-score': 0.6417148378925971, 'support': 559175}}
[[ 45811  41914   2015]
 [ 61718 310595   6501]
 [ 14575  61488  14558]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.683611
{'0': {'precision': 0.4166219199331782, 'recall': 0.38512022942863444, 'f1-score': 0.4002521995815779, 'support': 18132}, '1': {'precision': 0.7945456160611175, 'recall': 0.8942590333739927, 'f1-score': 0.841458595969669, 'support': 100018}, '2': {'precision': 0.5602765375198041, 'recall': 0.21463253145001104, 'f1-score': 0.31036821318865443, 'support': 18124}, 'accuracy': 0.7361272142888592, 'macro avg': {'precision': 0.5904813578380333, 'recall': 0.4980039314175461, 'f1-score': 0.5173596695799672, 'support': 136274}, 'weighted avg': {'precision': 0.7131037765489981, 'recall': 0.7361272142888592, 'f1-score': 0.7121203768168447, 'support': 136274}}
[[ 6983 10427   722]
 [ 8245 89442  2331]
 [ 1533 12701  3890]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6825817
{'0': {'precision': 0.39588031874906027, 'recall': 0.4147763074984247, 'f1-score': 0.4051080852373259, 'support': 6348}, '1': {'precision': 0.8096708085812861, 'recall': 0.8713324586136624, 'f1-score': 0.8393707139975797, 'support': 35821}, '2': {'precision': 0.4873417721518987, 'recall': 0.2424995856124648, 'f1-score': 0.32385168788046487, 'support': 6033}, 'accuracy': 0.7325007261109497, 'macro avg': {'precision': 0.5642976331607484, 'recall': 0.5095361172415173, 'f1-score': 0.5227768290384568, 'support': 48202}, 'weighted avg': {'precision': 0.7148333929920271, 'recall': 0.7325007261109497, 'f1-score': 0.7176573939707209, 'support': 48202}}
[[ 2633  3413   302]
 [ 3372 31212  1237]
 [  646  3924  1463]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3040621
{'0': {'precision': 0.5331218274111675, 'recall': 0.2663388037532152, 'f1-score': 0.35521706568743505, 'support': 110412}, '1': {'precision': 0.31734532282432604, 'recall': 0.7727494348654759, 'f1-score': 0.4499212882913108, 'support': 90244}, '2': {'precision': 0.5222275000698539, 'recall': 0.16984578475295573, 'f1-score': 0.25632585887677434, 'support': 110041}, 'accuracy': 0.3792537423921055, 'macro avg': {'precision': 0.4575648834351158, 'recall': 0.40297800779054893, 'f1-score': 0.35382140428517334, 'support': 310697}, 'weighted avg': {'precision': 0.466589619005871, 'recall': 0.3792537423921055, 'f1-score': 0.3476997757747942, 'support': 310697}}
[[29407 72489  8516]
 [11925 69736  8583]
 [13828 77523 18690]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2314287
{'0': {'precision': 0.4844364937388193, 'recall': 0.2511942859793145, 'f1-score': 0.33083900919336606, 'support': 43122}, '1': {'precision': 0.37933324051961403, 'recall': 0.775517800061304, 'f1-score': 0.5094677492430835, 'support': 45674}, '2': {'precision': 0.5214478092360244, 'recall': 0.18826487050564464, 'f1-score': 0.2766480213288724, 'support': 42164}, 'accuracy': 0.41379810629199754, 'macro avg': {'precision': 0.46173918116481927, 'recall': 0.40499231884875436, 'f1-score': 0.372318259921774, 'support': 130960}, 'weighted avg': {'precision': 0.4596965664258243, 'recall': 0.41379810629199754, 'f1-score': 0.3756907216300817, 'support': 130960}}
[[10832 28988  3302]
 [ 6270 35421  3983]
 [ 5258 28968  7938]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2415001
{'0': {'precision': 0.4852941176470588, 'recall': 0.2769362065286964, 'f1-score': 0.35263753678967624, 'support': 14061}, '1': {'precision': 0.3757345780583633, 'recall': 0.7597609832280845, 'f1-score': 0.5028086100750462, 'support': 14727}, '2': {'precision': 0.5175898203592815, 'recall': 0.19263179887178772, 'f1-score': 0.28076942597573973, 'support': 14359}, 'accuracy': 0.4136788189213619, 'macro avg': {'precision': 0.4595395053549012, 'recall': 0.4097763295428562, 'f1-score': 0.37873852428015403, 'support': 43147}, 'weighted avg': {'precision': 0.4586468572517147, 'recall': 0.4136788189213619, 'f1-score': 0.37997698549054376, 'support': 43147}}
[[ 3894  9087  1080]
 [ 2040 11189  1498]
 [ 2090  9503  2766]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4203882
{'0': {'precision': 0.4106078166632813, 'recall': 0.33876500857632935, 'f1-score': 0.37124260674642834, 'support': 101442}, '1': {'precision': 0.2616661105264509, 'recall': 0.5529984539857332, 'f1-score': 0.35524057602341724, 'support': 73738}, '2': {'precision': 0.45101084812623277, 'recall': 0.17437016843168843, 'f1-score': 0.2515037568141666, 'support': 104909}, 'accuracy': 0.33359039448175404, 'macro avg': {'precision': 0.37442825843865496, 'recall': 0.355377876997917, 'f1-score': 0.32599564652800406, 'support': 280089}, 'weighted avg': {'precision': 0.38652967757402457, 'recall': 0.33359039448175404, 'f1-score': 0.32218091296696166, 'support': 280089}}
[[34365 55282 11795]
 [22489 40777 10472]
 [26839 59777 18293]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3336315
{'0': {'precision': 0.4007894948843954, 'recall': 0.12622098185969807, 'f1-score': 0.1919811684803581, 'support': 39415}, '1': {'precision': 0.32521532184950136, 'recall': 0.7714247311827958, 'f1-score': 0.45754145408163266, 'support': 37200}, '2': {'precision': 0.41255121846021137, 'recall': 0.15122928140398956, 'f1-score': 0.2213266486694948, 'support': 37949}, 'accuracy': 0.34400858908557663, 'macro avg': {'precision': 0.37951867839803605, 'recall': 0.3496249981488278, 'f1-score': 0.2902830904104952, 'support': 114564}, 'weighted avg': {'precision': 0.38014589315156994, 'recall': 0.34400858908557663, 'f1-score': 0.28793167869355735, 'support': 114564}}
[[ 4975 30543  3897]
 [ 4228 28697  4275]
 [ 3210 29000  5739]]
Evaluating performance on  val set...
136/136 - 1s - 913ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3836156
{'0': {'precision': 0.4346069066862601, 'recall': 0.09707064905226881, 'f1-score': 0.15869608961030252, 'support': 12187}, '1': {'precision': 0.3076009915854893, 'recall': 0.835625533529356, 'f1-score': 0.4496733360555329, 'support': 10543}, '2': {'precision': 0.43841642228739003, 'recall': 0.12413850369509258, 'f1-score': 0.193489937229017, 'support': 12043}, 'accuracy': 0.3303712650619734, 'macro avg': {'precision': 0.3935414401863799, 'recall': 0.35227822875890574, 'f1-score': 0.2672864542982841, 'support': 34773}, 'weighted avg': {'precision': 0.3974187041577748, 'recall': 0.3303712650619734, 'f1-score': 0.2589691582596639, 'support': 34773}}
[[ 1183 10097   907]
 [  725  8810  1008]
 [  814  9734  1495]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
1722/1722 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3711652
{'0': {'precision': 0.4956885140501494, 'recall': 0.16220915841584158, 'f1-score': 0.24443076808310252, 'support': 161600}, '1': {'precision': 0.2642068274478087, 'recall': 0.8392518939393939, 'f1-score': 0.40189284117223467, 'support': 114048}, '2': {'precision': 0.5389564810481984, 'recall': 0.0836870500330001, 'f1-score': 0.1448780104300427, 'support': 165151}, 'accuracy': 0.3079612249574069, 'macro avg': {'precision': 0.4329506075153855, 'recall': 0.36171603412941183, 'f1-score': 0.2637338732284599, 'support': 440799}, 'weighted avg': {'precision': 0.4520081169169233, 'recall': 0.3079612249574069, 'f1-score': 0.24787223921282117, 'support': 440799}}
[[ 26213 129556   5831]
 [ 12341  95715   5992]
 [ 14328 137002  13821]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3187827
{'0': {'precision': 0.4523184184136383, 'recall': 0.18027482775684214, 'f1-score': 0.2578011240695127, 'support': 52542}, '1': {'precision': 0.34377020641631434, 'recall': 0.788563930934814, 'f1-score': 0.47880705238485605, 'support': 52588}, '2': {'precision': 0.44848003906726897, 'recall': 0.13908714007155973, 'f1-score': 0.2123256990101871, 'support': 52823}, 'accuracy': 0.3690211645236241, 'macro avg': {'precision': 0.41485622129907385, 'recall': 0.36930863292107197, 'f1-score': 0.3163112918215187, 'support': 157953}, 'weighted avg': {'precision': 0.41489533632764725, 'recall': 0.3690211645236241, 'f1-score': 0.31617362335941873, 'support': 157953}}
[[ 9472 39084  3986]
 [ 6070 41469  5049]
 [ 5399 40077  7347]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3009479
{'0': {'precision': 0.47975479916115504, 'recall': 0.1565592756369762, 'f1-score': 0.23607858702123433, 'support': 18996}, '1': {'precision': 0.3557757885763001, 'recall': 0.8404067864874389, 'f1-score': 0.49991764371172304, 'support': 19863}, '2': {'precision': 0.4596718280563901, 'recall': 0.10701027599935439, 'f1-score': 0.17360565593087196, 'support': 18587}, 'accuracy': 0.37698012046095464, 'macro avg': {'precision': 0.43173413859794846, 'recall': 0.36799211270792315, 'f1-score': 0.30320062888794314, 'support': 57446}, 'weighted avg': {'precision': 0.43038883336421113, 'recall': 0.37698012046095464, 'f1-score': 0.3070922487708185, 'support': 57446}}
[[ 2974 15081   941]
 [ 1773 16693  1397]
 [ 1452 15146  1989]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8119841
{'0': {'precision': 0.47915919560839704, 'recall': 0.5613320730022541, 'f1-score': 0.5170008296717402, 'support': 247554}, '1': {'precision': 0.687204417370319, 'recall': 0.7642945270924232, 'f1-score': 0.7237023177915979, 'support': 646786}, '2': {'precision': 0.571761025190528, 'recall': 0.3031199316940449, 'f1-score': 0.3961959888079626, 'support': 244781}, 'accuracy': 0.6210867853371151, 'macro avg': {'precision': 0.5793748793897481, 'recall': 0.5429155105962408, 'f1-score': 0.5456330454237669, 'support': 1139121}, 'weighted avg': {'precision': 0.6171848357725676, 'recall': 0.6210867853371151, 'f1-score': 0.6084054293091921, 'support': 1139121}}
[[138960  97105  11489]
 [108367 494335  44084]
 [ 42681 127902  74198]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74450815
{'0': {'precision': 0.4509009202717812, 'recall': 0.59779928448239, 'f1-score': 0.5140615903171442, 'support': 70159}, '1': {'precision': 0.7701919780596503, 'recall': 0.7362505018065034, 'f1-score': 0.752838874251798, 'support': 244118}, '2': {'precision': 0.5156306144448437, 'recall': 0.4271923109636812, 'f1-score': 0.46726363530643095, 'support': 70542}, 'accuracy': 0.6543543847886929, 'macro avg': {'precision': 0.5789078375920917, 'recall': 0.5870806990841916, 'f1-score': 0.5780546999584577, 'support': 384819}, 'weighted avg': {'precision': 0.6653156361028998, 'recall': 0.6543543847886929, 'f1-score': 0.6569563321495226, 'support': 384819}}
[[ 41941  23576   4642]
 [ 40720 179732  23666]
 [ 10355  30052  30135]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.737732
{'0': {'precision': 0.47495508444125045, 'recall': 0.5634991686916485, 'f1-score': 0.5154522588570204, 'support': 23457}, '1': {'precision': 0.7596278384448115, 'recall': 0.7695400430946276, 'f1-score': 0.7645518148657537, 'support': 83073}, '2': {'precision': 0.5130641330166271, 'recall': 0.39631374838413747, 'f1-score': 0.4471944477120339, 'support': 23981}, 'accuracy': 0.6639287109898783, 'macro avg': {'precision': 0.5825490186342296, 'recall': 0.5764509867234712, 'f1-score': 0.5757328404782693, 'support': 130511}, 'weighted avg': {'precision': 0.6631577094094443, 'recall': 0.6639287109898783, 'f1-score': 0.6614672066180948, 'support': 130511}}
[[13218  8940  1299]
 [11424 63928  7721]
 [ 3188 11289  9504]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
6203/6203 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76615846
{'0': {'precision': 0.43228917536798306, 'recall': 0.4193172387778197, 'f1-score': 0.4257044107650623, 'support': 265100}, '1': {'precision': 0.7294706007974934, 'recall': 0.8683563251209191, 'f1-score': 0.7928773760376658, 'support': 1054217}, '2': {'precision': 0.5641516154992942, 'recall': 0.1592250434730802, 'f1-score': 0.24835489060675933, 'support': 268557}, 'accuracy': 0.6734526794947207, 'macro avg': {'precision': 0.5753037972215901, 'recall': 0.4822995357906063, 'f1-score': 0.48897889246982923, 'support': 1587874}, 'weighted avg': {'precision': 0.6518949451622909, 'recall': 0.6734526794947207, 'f1-score': 0.6394817802828168, 'support': 1587874}}
[[111161 144577   9362]
 [115107 915436  23674]
 [ 30877 194919  42761]]
Evaluating performance on  train set...
1766/1766 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7582859
{'0': {'precision': 0.5472219271220652, 'recall': 0.19860680915598852, 'f1-score': 0.29143956396280857, 'support': 77807}, '1': {'precision': 0.6935525624810467, 'recall': 0.950589499508328, 'f1-score': 0.801979097175895, 'support': 295929}, '2': {'precision': 0.5568350873326354, 'recall': 0.12914190786531213, 'f1-score': 0.2096593502344301, 'support': 78255}, 'accuracy': 0.6789205979765084, 'macro avg': {'precision': 0.5992031923119158, 'recall': 0.4261127388432096, 'f1-score': 0.4343593371243779, 'support': 451991}, 'weighted avg': {'precision': 0.6446923556116285, 'recall': 0.6789205979765084, 'f1-score': 0.6115427140231001, 'support': 451991}}
[[ 15453  59409   2945]
 [  9524 281307   5098]
 [  3262  64887  10106]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7107407
{'0': {'precision': 0.5301662707838479, 'recall': 0.2433705512909979, 'f1-score': 0.33360236750067257, 'support': 22928}, '1': {'precision': 0.7362455031562752, 'recall': 0.9475559093026867, 'f1-score': 0.8286413968431819, 'support': 103024}, '2': {'precision': 0.5474364150181671, 'recall': 0.12260397830018083, 'f1-score': 0.20033980941124327, 'support': 22120}, 'accuracy': 0.7152804041277216, 'macro avg': {'precision': 0.6046160629860968, 'recall': 0.4378434796312885, 'f1-score': 0.45419452458503257, 'support': 148072}, 'weighted avg': {'precision': 0.6761298724533067, 'recall': 0.7152804041277216, 'f1-score': 0.6581278225093474, 'support': 148072}}
[[ 5580 16467   881]
 [ 4042 97621  1361]
 [  903 18505  2712]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
5183/5183 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0723062
{'0': {'precision': 0.5799137002774482, 'recall': 0.19407130738982337, 'f1-score': 0.2908185788386649, 'support': 380185}, '1': {'precision': 0.4545617311471225, 'recall': 0.9133989110746592, 'f1-score': 0.6070294384663733, 'support': 561471}, '2': {'precision': 0.5961813240691453, 'recall': 0.1104900515078508, 'f1-score': 0.1864292441465712, 'support': 385184}, 'accuracy': 0.4742011094027916, 'macro avg': {'precision': 0.5435522518312387, 'recall': 0.4059867566574445, 'f1-score': 0.36142575381720315, 'support': 1326840}, 'weighted avg': {'precision': 0.5315917721949422, 'recall': 0.4742011094027916, 'f1-score': 0.3943232410978594, 'support': 1326840}}
[[ 73783 293642  12760]
 [ 32557 512847  16067]
 [ 20891 321734  42559]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9974033
{'0': {'precision': 0.5310107122574075, 'recall': 0.266300664892311, 'f1-score': 0.3547133774626514, 'support': 101821}, '1': {'precision': 0.5176474955370852, 'recall': 0.8629622962071177, 'f1-score': 0.6471202421506692, 'support': 177754}, '2': {'precision': 0.5674873043684852, 'recall': 0.1882808497221456, 'f1-score': 0.28275071209262753, 'support': 101492}, 'accuracy': 0.5238422639588314, 'macro avg': {'precision': 0.5387151707209926, 'recall': 0.43918127027385806, 'f1-score': 0.42819477723531607, 'support': 381067}, 'weighted avg': {'precision': 0.5344922970223788, 'recall': 0.5238422639588314, 'f1-score': 0.47194434994785595, 'support': 381067}}
[[ 27115  69507   5199]
 [ 14994 153395   9365]
 [  8954  73429  19109]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9438739
{'0': {'precision': 0.518020769700672, 'recall': 0.28334497737006775, 'f1-score': 0.3663210807414389, 'support': 32921}, '1': {'precision': 0.5614735092939677, 'recall': 0.8649778981678549, 'f1-score': 0.6809375677369842, 'support': 67189}, '2': {'precision': 0.5719498086677939, 'recall': 0.19689357269775137, 'f1-score': 0.2929419540098908, 'support': 32642}, 'accuracy': 0.5564661925997348, 'macro avg': {'precision': 0.5504813625541446, 'recall': 0.4484054827452247, 'f1-score': 0.44673353416277134, 'support': 132752}, 'weighted avg': {'precision': 0.5532737060820353, 'recall': 0.5564661925997348, 'f1-score': 0.5075131207104977, 'support': 132752}}
[[ 9328 22008  1585]
 [ 5847 58117  3225]
 [ 2832 23383  6427]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
7324/7324 - 47s - 47s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.106365
{'0': {'precision': 0.565890323257387, 'recall': 0.258435281330219, 'f1-score': 0.35482586996975646, 'support': 605374}, '1': {'precision': 0.40657320268455627, 'recall': 0.8563471329488767, 'f1-score': 0.5513693724444377, 'support': 680961}, '2': {'precision': 0.6046925793328901, 'recall': 0.16850932489874587, 'f1-score': 0.263569806946933, 'support': 588371}, 'accuracy': 0.4473954849453728, 'macro avg': {'precision': 0.5257187017582777, 'recall': 0.4277639130592805, 'f1-score': 0.38992168312037573, 'support': 1874706}, 'weighted avg': {'precision': 0.5201985595712434, 'recall': 0.4473954849453728, 'f1-score': 0.3975771274639234, 'support': 1874706}}
[[156450 419346  29578]
 [ 62585 583139  35237]
 [ 57432 431793  99146]]
Evaluating performance on  train set...
2046/2046 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.076026
{'0': {'precision': 0.5606266918218358, 'recall': 0.22245584798557452, 'f1-score': 0.31852245400145407, 'support': 153617}, '1': {'precision': 0.4540671190413186, 'recall': 0.8900080580177276, 'f1-score': 0.6013404632796293, 'support': 215934}, '2': {'precision': 0.5981946446180687, 'recall': 0.15342312955168902, 'f1-score': 0.2442116129032258, 'support': 154201}, 'accuracy': 0.47735187646061494, 'macro avg': {'precision': 0.5376294851604076, 'recall': 0.42196234518499703, 'f1-score': 0.3880248433947697, 'support': 523752}, 'weighted avg': {'precision': 0.527754609424716, 'recall': 0.47735187646061494, 'f1-score': 0.4132451815658082, 'support': 523752}}
[[ 34173 112301   7143]
 [ 15003 192183   8748]
 [ 11779 118764  23658]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554209
{'0': {'precision': 0.5821804617781765, 'recall': 0.22363695723147242, 'f1-score': 0.3231428459109195, 'support': 55134}, '1': {'precision': 0.4572466437855901, 'recall': 0.8991903194234363, 'f1-score': 0.6062231667709289, 'support': 78673}, '2': {'precision': 0.5846108921010367, 'recall': 0.14355628058727568, 'f1-score': 0.2305090600307998, 'support': 55783}, 'accuracy': 0.4804050846563637, 'macro avg': {'precision': 0.5413459992216011, 'recall': 0.4221278524140615, 'f1-score': 0.38662502423754935, 'support': 189590}, 'weighted avg': {'precision': 0.5310525459164188, 'recall': 0.4804050846563637, 'f1-score': 0.4133553444882116, 'support': 189590}}
[[12330 40022  2782]
 [ 5023 70742  2908]
 [ 3826 43949  8008]]
testing model on single stock: results/universal/W6/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
29350/29350 - 157s - 157s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2720753
{'0': {'precision': 0.43549147880290123, 'recall': 0.17931364438716035, 'f1-score': 0.25403029746569405, 'support': 2322149}, '1': {'precision': 0.3962286657634142, 'recall': 0.8578964614386483, 'f1-score': 0.5420881264652664, 'support': 2896177}, '2': {'precision': 0.447284768674085, 'recall': 0.05585256797372464, 'f1-score': 0.09930490594248285, 'support': 2295078}, 'accuracy': 0.40317264984020557, 'macro avg': {'precision': 0.42633497108013346, 'recall': 0.3643542245998444, 'f1-score': 0.29847444329114775, 'support': 7513404}, 'weighted avg': {'precision': 0.4239593508953262, 'recall': 0.40317264984020557, 'f1-score': 0.3178042695417578, 'support': 7513404}}
[[ 416393 1835466   70290]
 [ 323446 2484620   88111]
 [ 216306 1950586  128186]]
Evaluating performance on  train set...
5452/5452 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3325838
{'0': {'precision': 0.503847776436188, 'recall': 0.07451303520947984, 'f1-score': 0.12982631723951804, 'support': 464818}, '1': {'precision': 0.3382887498987684, 'recall': 0.9312972026248035, 'f1-score': 0.49629938931498285, 'support': 466473}, '2': {'precision': 0.4595299647473561, 'recall': 0.042123382107095465, 'f1-score': 0.07717263889930417, 'support': 464184}, 'accuracy': 0.35014099141869254, 'macro avg': {'precision': 0.43388883036077086, 'recall': 0.3493112066471263, 'f1-score': 0.23443278181793503, 'support': 1395475}, 'weighted avg': {'precision': 0.4337638015265991, 'recall': 0.35014099141869254, 'f1-score': 0.23481479666307234, 'support': 1395475}}
[[ 34635 420011  10172]
 [ 19223 434425  12825]
 [ 14883 429748  19553]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2573702
{'0': {'precision': 0.5002523659305994, 'recall': 0.05101463075675884, 'f1-score': 0.09258740278848175, 'support': 155426}, '1': {'precision': 0.3885142731064626, 'recall': 0.9501374649913924, 'f1-score': 0.551513072529046, 'support': 194595}, '2': {'precision': 0.4633057314499107, 'recall': 0.03704833746640527, 'f1-score': 0.0686102428468382, 'support': 154042}, 'accuracy': 0.39385552996351647, 'macro avg': {'precision': 0.4506907901623243, 'recall': 0.3460668110715188, 'f1-score': 0.23757023938812197, 'support': 504063}, 'weighted avg': {'precision': 0.4458246304257376, 'recall': 0.39385552996351647, 'f1-score': 0.2624295674215424, 'support': 504063}}
[[  7929 145153   2344]
 [  5436 184892   4267]
 [  2485 145850   5707]]
training model: results/universal/W6/deepLOB_L1/h30
Epoch 1/50
9426/9426 - 149s - loss: 2.9970 - accuracy30: 0.4784 - val_loss: 3.6099 - val_accuracy30: 0.4376 - 149s/epoch - 16ms/step
Epoch 2/50
9426/9426 - 147s - loss: 2.9244 - accuracy30: 0.5017 - val_loss: 3.5098 - val_accuracy30: 0.4433 - 147s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 146s - loss: 2.9027 - accuracy30: 0.5070 - val_loss: 3.5335 - val_accuracy30: 0.4427 - 146s/epoch - 15ms/step
Epoch 4/50
9426/9426 - 146s - loss: 2.8923 - accuracy30: 0.5094 - val_loss: 3.4770 - val_accuracy30: 0.4478 - 146s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 147s - loss: 2.8820 - accuracy30: 0.5121 - val_loss: 3.5366 - val_accuracy30: 0.4467 - 147s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 146s - loss: 2.8751 - accuracy30: 0.5137 - val_loss: 3.6054 - val_accuracy30: 0.4453 - 146s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 148s - loss: 2.8697 - accuracy30: 0.5150 - val_loss: 3.8081 - val_accuracy30: 0.4267 - 148s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 148s - loss: 2.8651 - accuracy30: 0.5164 - val_loss: 4.0611 - val_accuracy30: 0.3930 - 148s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 147s - loss: 2.8608 - accuracy30: 0.5169 - val_loss: 4.1306 - val_accuracy30: 0.3854 - 147s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 149s - loss: 2.8566 - accuracy30: 0.5181 - val_loss: 4.1445 - val_accuracy30: 0.3798 - 149s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 149s - loss: 2.8533 - accuracy30: 0.5191 - val_loss: 4.1844 - val_accuracy30: 0.3742 - 149s/epoch - 16ms/step
Epoch 12/50
9426/9426 - 150s - loss: 2.8502 - accuracy30: 0.5197 - val_loss: 4.0421 - val_accuracy30: 0.3851 - 150s/epoch - 16ms/step
Epoch 13/50
9426/9426 - 148s - loss: 2.8476 - accuracy30: 0.5206 - val_loss: 3.9484 - val_accuracy30: 0.3955 - 148s/epoch - 16ms/step
Epoch 14/50
9426/9426 - 148s - loss: 2.8451 - accuracy30: 0.5209 - val_loss: 3.9763 - val_accuracy30: 0.3910 - 148s/epoch - 16ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 232s - 232s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1446837
{'0': {'precision': 0.38957418272410077, 'recall': 0.3674021596166551, 'f1-score': 0.3781634591673866, 'support': 3134723}, '1': {'precision': 0.449189357493284, 'recall': 0.719436401022585, 'f1-score': 0.553065294646639, 'support': 4569987}, '2': {'precision': 0.4876370716539596, 'recall': 0.08501345089580044, 'f1-score': 0.14478537472188738, 'support': 3113919}, 'accuracy': 0.4348281099203975, 'macro avg': {'precision': 0.4421335372904481, 'recall': 0.39061733717834685, 'f1-score': 0.3586713761786377, 'support': 10818629}, 'weighted avg': {'precision': 0.4429821022240182, 'recall': 0.4348281099203975, 'f1-score': 0.3848721339059212, 'support': 10818629}}
[[1151704 1879998  103021]
 [1107045 3287815  175127]
 [ 697566 2151628  264725]]
Evaluating performance on  train set...
9426/9426 - 62s - 62s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1380007
{'0': {'precision': 0.4495559947514278, 'recall': 0.22708071493593462, 'f1-score': 0.3017438907181307, 'support': 727226}, '1': {'precision': 0.4178218681462393, 'recall': 0.8125921200484497, 'f1-score': 0.5518772720354252, 'support': 959346}, '2': {'precision': 0.5036600278061609, 'recall': 0.12431180206910714, 'f1-score': 0.19940666987943284, 'support': 725627}, 'accuracy': 0.4290276216846123, 'macro avg': {'precision': 0.45701263023460936, 'recall': 0.3879948790178305, 'f1-score': 0.3510092775443296, 'support': 2412199}, 'weighted avg': {'precision': 0.45321047755787364, 'recall': 0.4290276216846123, 'f1-score': 0.3704388069699405, 'support': 2412199}}
[[165139 528615  33472]
 [124368 779557  55421]
 [ 77831 557592  90204]]
Evaluating performance on  val set...
3323/3323 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1073529
{'0': {'precision': 0.4553850500626887, 'recall': 0.21020712591397062, 'f1-score': 0.28763914605037144, 'support': 245358}, '1': {'precision': 0.442078103370734, 'recall': 0.8370015675584517, 'f1-score': 0.5785723499706177, 'support': 361709}, '2': {'precision': 0.5093952918191047, 'recall': 0.10933504362054647, 'f1-score': 0.18002917672225588, 'support': 243234}, 'accuracy': 0.44798371400245324, 'macro avg': {'precision': 0.4689528150841758, 'recall': 0.38551457903098957, 'f1-score': 0.34874689091441496, 'support': 850301}, 'weighted avg': {'precision': 0.46517438908778674, 'recall': 0.44798371400245324, 'f1-score': 0.38061652109430705, 'support': 850301}}
[[ 51576 185370   8412]
 [ 41757 302751  17201]
 [ 19925 196715  26594]]
testing model out of sample: results/universal/W6/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 93s - 93s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08259
{'0': {'precision': 0.4711544754416448, 'recall': 0.37777749856616627, 'f1-score': 0.4193305579722718, 'support': 1353016}, '1': {'precision': 0.4513421537287481, 'recall': 0.7899914083580567, 'f1-score': 0.5744731868461296, 'support': 1787784}, '2': {'precision': 0.5835273026400729, 'recall': 0.11767011841472005, 'f1-score': 0.19584706029463286, 'support': 1344343}, 'accuracy': 0.46412388635100377, 'macro avg': {'precision': 0.5020079772701552, 'recall': 0.42847967511298096, 'f1-score': 0.3965502683710114, 'support': 4485143}, 'weighted avg': {'precision': 0.4969390428173666, 'recall': 0.46412388635100377, 'f1-score': 0.41418535611364005, 'support': 4485143}}
[[ 511139  786705   55172]
 [ 317720 1412334   57730]
 [ 256006  930148  158189]]
Evaluating performance on  train set...
5153/5153 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0740374
{'0': {'precision': 0.491365514726735, 'recall': 0.25524554628392243, 'f1-score': 0.33596839313291643, 'support': 380132}, '1': {'precision': 0.4750844297386965, 'recall': 0.8563658617208508, 'f1-score': 0.6111322212673064, 'support': 559665}, '2': {'precision': 0.5202093942523415, 'recall': 0.15424821418200824, 'f1-score': 0.23794340536952654, 'support': 378818}, 'accuracy': 0.4813664337202292, 'macro avg': {'precision': 0.4955531129059243, 'recall': 0.42195320739559383, 'f1-score': 0.3950146732565831, 'support': 1318615}, 'weighted avg': {'precision': 0.49274167632378996, 'recall': 0.4813664337202292, 'f1-score': 0.42459618369974717, 'support': 1318615}}
[[ 97027 258620  24485]
 [ 50980 479278  29407]
 [ 49457 270929  58432]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0529838
{'0': {'precision': 0.49863698013885344, 'recall': 0.2855934223986094, 'f1-score': 0.3631775591244302, 'support': 130017}, '1': {'precision': 0.48681288212914714, 'recall': 0.8546316740264954, 'f1-score': 0.620295049068616, 'support': 199280}, '2': {'precision': 0.5250751966682091, 'recall': 0.1400902812608511, 'f1-score': 0.22117182693654786, 'support': 129595}, 'accuracy': 0.49161458469530955, 'macro avg': {'precision': 0.5035083529787365, 'recall': 0.42677179256198533, 'f1-score': 0.4015481450431981, 'support': 458892}, 'weighted avg': {'precision': 0.5009685841322715, 'recall': 0.49161458469530955, 'f1-score': 0.4347306490305273, 'support': 458892}}
[[ 37132  85522   7363]
 [ 19911 170311   9058]
 [ 17424  94016  18155]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3401101
{'0': {'precision': 0.4427089841309509, 'recall': 0.2625666977216905, 'f1-score': 0.32963177096832075, 'support': 94456}, '1': {'precision': 0.289428644434695, 'recall': 0.7898871082339939, 'f1-score': 0.4236312764403484, 'support': 76002}, '2': {'precision': 0.5147502294480136, 'recall': 0.03902235386496238, 'f1-score': 0.0725451790531801, 'support': 100609}, 'accuracy': 0.3274467198146584, 'macro avg': {'precision': 0.4156292860045532, 'recall': 0.3638253866068822, 'f1-score': 0.27526940882061646, 'support': 271067}, 'weighted avg': {'precision': 0.42647087795243976, 'recall': 0.3274467198146584, 'f1-score': 0.2605673901653999, 'support': 271067}}
[[24801 67657  1998]
 [14266 60033  1703]
 [16954 79729  3926]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2772174
{'0': {'precision': 0.4835076427996782, 'recall': 0.0647699105507059, 'f1-score': 0.11423683710321231, 'support': 18558}, '1': {'precision': 0.3362925693376024, 'recall': 0.9075861295028617, 'f1-score': 0.49074635922330095, 'support': 17822}, '2': {'precision': 0.4488888888888889, 'recall': 0.08618237669947096, 'f1-score': 0.14460246253698578, 'support': 17579}, 'accuracy': 0.35011768194369797, 'macro avg': {'precision': 0.42289636700872313, 'recall': 0.3528461389176795, 'f1-score': 0.249861886287833, 'support': 53959}, 'weighted avg': {'precision': 0.4236060487330928, 'recall': 0.35011768194369797, 'f1-score': 0.24848598984371018, 'support': 53959}}
[[ 1202 16469   887]
 [  674 16175   973]
 [  610 15454  1515]]
Evaluating performance on  val set...
81/81 - 1s - 605ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2478393
{'0': {'precision': 0.457519309404816, 'recall': 0.1406228180421729, 'f1-score': 0.2151249732963042, 'support': 7161}, '1': {'precision': 0.32521547984034244, 'recall': 0.8624022089277497, 'f1-score': 0.4723179030496513, 'support': 6519}, '2': {'precision': 0.4865100087032202, 'recall': 0.08035072588759523, 'f1-score': 0.1379225265235628, 'support': 6957}, 'accuracy': 0.3483064398895188, 'macro avg': {'precision': 0.42308159931612616, 'recall': 0.36112525095250597, 'f1-score': 0.2751218009565061, 'support': 20637}, 'weighted avg': {'precision': 0.42549913351143015, 'recall': 0.3483064398895188, 'f1-score': 0.27034342979987097, 'support': 20637}}
[[1007 5898  256]
 [ 563 5622  334]
 [ 631 5767  559]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86466116
{'0': {'precision': 0.35992139151923136, 'recall': 0.6285902968970906, 'f1-score': 0.4577449048015768, 'support': 107512}, '1': {'precision': 0.7143025528978841, 'recall': 0.724037847903183, 'f1-score': 0.7191372541074351, 'support': 343163}, '2': {'precision': 0.6513216513216513, 'recall': 0.14148387096774193, 'f1-score': 0.23246939100015898, 'support': 108500}, 'accuracy': 0.5926498859927571, 'macro avg': {'precision': 0.5751818652462556, 'recall': 0.4980373385893386, 'f1-score': 0.4697838499697236, 'support': 559175}, 'weighted avg': {'precision': 0.6339454996620224, 'recall': 0.5926498859927571, 'f1-score': 0.5744486013498711, 'support': 559175}}
[[ 67581  38297   1634]
 [ 88116 248463   6584]
 [ 32069  61080  15351]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7666536
{'0': {'precision': 0.39759513088228016, 'recall': 0.3691706868826097, 'f1-score': 0.382856053747558, 'support': 21765}, '1': {'precision': 0.7525904398286654, 'recall': 0.853862482893872, 'f1-score': 0.8000343271376215, 'support': 92803}, '2': {'precision': 0.5230183775756451, 'recall': 0.2596056389938266, 'f1-score': 0.34698275862068967, 'support': 21706}, 'accuracy': 0.6817955002421592, 'macro avg': {'precision': 0.5577346494288635, 'recall': 0.4942129362567695, 'f1-score': 0.509957713168623, 'support': 136274}, 'weighted avg': {'precision': 0.6593256638443827, 'recall': 0.6817955002421592, 'f1-score': 0.6612417293818995, 'support': 136274}}
[[ 8035 12699  1031]
 [ 9454 79241  4108]
 [ 2720 13351  5635]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77952856
{'0': {'precision': 0.3913677811550152, 'recall': 0.41990607878945996, 'f1-score': 0.40513498206532, 'support': 7666}, '1': {'precision': 0.7717323148834293, 'recall': 0.8141010222489476, 'f1-score': 0.7923506862142627, 'support': 33260}, '2': {'precision': 0.4177059905949704, 'recall': 0.2807861462341946, 'f1-score': 0.335826415714638, 'support': 7276}, 'accuracy': 0.6709057715447492, 'macro avg': {'precision': 0.5269353622111383, 'recall': 0.5049310824242007, 'f1-score': 0.5111040279980735, 'support': 48202}, 'weighted avg': {'precision': 0.6577999043800301, 'recall': 0.6709057715447492, 'f1-score': 0.6618568025546414, 'support': 48202}}
[[ 3219  3918   529]
 [ 3864 27077  2319]
 [ 1142  4091  2043]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2576878
{'0': {'precision': 0.49965886395494524, 'recall': 0.3480218080648367, 'f1-score': 0.4102775655716832, 'support': 115737}, '1': {'precision': 0.29158745371606937, 'recall': 0.6881651319448736, 'f1-score': 0.40961426690111313, 'support': 80905}, '2': {'precision': 0.5103594512428786, 'recall': 0.17515233878392003, 'f1-score': 0.2607997493439862, 'support': 114055}, 'accuracy': 0.37313524108697543, 'macro avg': {'precision': 0.43386858963796443, 'recall': 0.40377975959787676, 'f1-score': 0.36023052727226085, 'support': 310697}, 'weighted avg': {'precision': 0.4494055240055701, 'recall': 0.37313524108697543, 'f1-score': 0.35523243636608276, 'support': 310697}}
[[40279 65079 10379]
 [16442 55676  8787]
 [23892 70186 19977]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2015628
{'0': {'precision': 0.4557909881629717, 'recall': 0.3147353684971098, 'f1-score': 0.37235207693335115, 'support': 44288}, '1': {'precision': 0.3669528949950932, 'recall': 0.6912855591246274, 'f1-score': 0.4794179160690102, 'support': 43273}, '2': {'precision': 0.4905080072117934, 'recall': 0.2131385515795295, 'f1-score': 0.2971553399617714, 'support': 43399}, 'accuracy': 0.4054902260232132, 'macro avg': {'precision': 0.4377506301232861, 'recall': 0.40638649306708885, 'f1-score': 0.3829751109880442, 'support': 130960}, 'weighted avg': {'precision': 0.43794121039912176, 'recall': 0.4054902260232132, 'f1-score': 0.3828102081878394, 'support': 130960}}
[[13939 25771  4578]
 [ 8329 29914  5030]
 [ 8314 25835  9250]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2203528
{'0': {'precision': 0.4517016787450693, 'recall': 0.33737581363480645, 'f1-score': 0.3862566677125823, 'support': 14595}, '1': {'precision': 0.3549198365293933, 'recall': 0.6646063281824871, 'f1-score': 0.4627286233925918, 'support': 13590}, '2': {'precision': 0.48911444542512506, 'recall': 0.22222964844272156, 'f1-score': 0.3056066176470589, 'support': 14962}, 'accuracy': 0.4005145201288618, 'macro avg': {'precision': 0.4319119868998625, 'recall': 0.4080705967533384, 'f1-score': 0.38486396958407765, 'support': 43147}, 'weighted avg': {'precision': 0.43419187688992195, 'recall': 0.4005145201288618, 'f1-score': 0.38237616219912757, 'support': 43147}}
[[4924 8032 1639]
 [2724 9032 1834]
 [3253 8384 3325]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3192983
{'0': {'precision': 0.39917491054514836, 'recall': 0.4697094284666977, 'f1-score': 0.4315792348234523, 'support': 100939}, '1': {'precision': 0.2709200069754117, 'recall': 0.4354005685230412, 'f1-score': 0.3340090297613563, 'support': 74931}, '2': {'precision': 0.4450368051649507, 'recall': 0.17461307439142576, 'f1-score': 0.2508166218730618, 'support': 104219}, 'accuracy': 0.35072780437646606, 'macro avg': {'precision': 0.3717105742285036, 'recall': 0.35990769046038823, 'f1-score': 0.33880162881929016, 'support': 280089}, 'weighted avg': {'precision': 0.38192829470517337, 'recall': 0.35072780437646606, 'f1-score': 0.33821629734791897, 'support': 280089}}
[[47412 41666 11861]
 [31474 32625 10832]
 [39889 46132 18198]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2557814
{'0': {'precision': 0.38652256834075016, 'recall': 0.18882476254561453, 'f1-score': 0.2537077284186734, 'support': 38639}, '1': {'precision': 0.3321186367398367, 'recall': 0.7107433647033943, 'f1-score': 0.4526986639277325, 'support': 37828}, '2': {'precision': 0.4022395656599932, 'recall': 0.15557655458435046, 'f1-score': 0.22437159297395515, 'support': 38097}, 'accuracy': 0.3501012534478545, 'macro avg': {'precision': 0.3736269235801933, 'recall': 0.35171489394445304, 'f1-score': 0.31025932844012033, 'support': 114564}, 'weighted avg': {'precision': 0.3737853954266746, 'recall': 0.3501012534478545, 'f1-score': 0.3096573317530477, 'support': 114564}}
[[ 7296 27029  4314]
 [ 6448 26886  4494]
 [ 5132 27038  5927]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2851849
{'0': {'precision': 0.4244737450844321, 'recall': 0.1526749313586821, 'f1-score': 0.22457471545710442, 'support': 12019}, '1': {'precision': 0.3128726893261777, 'recall': 0.7897460018814676, 'f1-score': 0.4481874966632855, 'support': 10630}, '2': {'precision': 0.4292426755113322, 'recall': 0.12809303860112173, 'f1-score': 0.1973065684157032, 'support': 12124}, 'accuracy': 0.3388548586547034, 'macro avg': {'precision': 0.3888630366406473, 'recall': 0.3568379906137571, 'f1-score': 0.2900229268453644, 'support': 34773}, 'weighted avg': {'precision': 0.3920203844248828, 'recall': 0.3388548586547034, 'f1-score': 0.28342511230212086, 'support': 34773}}
[[1835 9195  989]
 [1159 8395 1076]
 [1329 9242 1553]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2849596
{'0': {'precision': 0.4467298714063396, 'recall': 0.27606213027110815, 'f1-score': 0.3412467201351441, 'support': 158055}, '1': {'precision': 0.2823946087181804, 'recall': 0.7325050606043222, 'f1-score': 0.40763729898844325, 'support': 122021}, '2': {'precision': 0.5025924256086565, 'recall': 0.08323015374277484, 'f1-score': 0.1428106267248144, 'support': 160723}, 'accuracy': 0.33210374796676034, 'macro avg': {'precision': 0.4105723019110588, 'recall': 0.3639324482060684, 'f1-score': 0.29723154861613393, 'support': 440799}, 'weighted avg': {'precision': 0.4216074101725053, 'recall': 0.33210374796676034, 'f1-score': 0.2872715536331103, 'support': 440799}}
[[ 43633 108155   6267]
 [ 25668  89381   6972]
 [ 28371 118975  13377]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2686335
{'0': {'precision': 0.4204676489429853, 'recall': 0.24956273764258555, 'f1-score': 0.31321880219518017, 'support': 52600}, '1': {'precision': 0.3454614688942834, 'recall': 0.6933188131674978, 'f1-score': 0.4611464806272477, 'support': 52341}, '2': {'precision': 0.4268258945038731, 'recall': 0.17462084056440053, 'f1-score': 0.24784471218206158, 'support': 53012}, 'accuracy': 0.3714585984438409, 'macro avg': {'precision': 0.39758500411371395, 'recall': 0.372500797124828, 'f1-score': 0.34073666500149646, 'support': 157953}, 'weighted avg': {'precision': 0.3977467436340939, 'recall': 0.3714585984438409, 'f1-score': 0.3402969289609738, 'support': 157953}}
[[13127 33836  5637]
 [ 9258 36289  6794]
 [ 8835 34920  9257]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.267884
{'0': {'precision': 0.42763819095477384, 'recall': 0.2669664331276796, 'f1-score': 0.3287195004184639, 'support': 19126}, '1': {'precision': 0.34916382936110557, 'recall': 0.7165904536813441, 'f1-score': 0.46954062652549367, 'support': 19463}, '2': {'precision': 0.443725278676735, 'recall': 0.13087977939226814, 'f1-score': 0.20213767967566237, 'support': 18857}, 'accuracy': 0.37463008738641507, 'macro avg': {'precision': 0.40684243299753814, 'recall': 0.37147888873376395, 'f1-score': 0.3334659355398733, 'support': 57446}, 'weighted avg': {'precision': 0.40633135868578124, 'recall': 0.37463008738641507, 'f1-score': 0.3348791666036484, 'support': 57446}}
[[ 5106 12714  1306]
 [ 3728 13947  1788]
 [ 3106 13283  2468]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
4450/4450 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8830326
{'0': {'precision': 0.476994054369077, 'recall': 0.5813273246375189, 'f1-score': 0.5240179079716967, 'support': 285808}, '1': {'precision': 0.6365326276978335, 'recall': 0.7256489807365339, 'f1-score': 0.6781757287493663, 'support': 570510}, '2': {'precision': 0.5811202506854681, 'recall': 0.2885330070755968, 'f1-score': 0.38560741745388905, 'support': 282803}, 'accuracy': 0.5809180938636018, 'macro avg': {'precision': 0.5648823109174596, 'recall': 0.5318364374832165, 'f1-score': 0.5292670180583173, 'support': 1139121}, 'weighted avg': {'precision': 0.5827471325465956, 'recall': 0.5809180938636018, 'f1-score': 0.5668629405731154, 'support': 1139121}}
[[166148 103951  15709]
 [113412 413990  43108]
 [ 68763 132442  81598]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8342568
{'0': {'precision': 0.447026965043354, 'recall': 0.6121391472400048, 'f1-score': 0.5167134824300694, 'support': 82790}, '1': {'precision': 0.7069071654377902, 'recall': 0.6973849434477468, 'f1-score': 0.7021137703079172, 'support': 219001}, '2': {'precision': 0.5536201014458745, 'recall': 0.36939345762875175, 'f1-score': 0.4431216453437552, 'support': 83028}, 'accuracy': 0.6082781775328141, 'macro avg': {'precision': 0.5691847439756729, 'recall': 0.5596391827721678, 'f1-score': 0.5539829660272473, 'support': 384819}, 'weighted avg': {'precision': 0.6179235130199622, 'recall': 0.6082781775328141, 'f1-score': 0.6063469604962097, 'support': 384819}}
[[ 50679  26925   5186]
 [ 46730 152728  19543]
 [ 15960  36398  30670]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82092494
{'0': {'precision': 0.4664567625044881, 'recall': 0.6103722443079147, 'f1-score': 0.5287975327582698, 'support': 27670}, '1': {'precision': 0.6961909249519249, 'recall': 0.7346628858636491, 'f1-score': 0.7149096996089815, 'support': 74411}, '2': {'precision': 0.5743615740447373, 'recall': 0.31881814984171647, 'f1-score': 0.4100337020198593, 'support': 28430}, 'accuracy': 0.6177257089440736, 'macro avg': {'precision': 0.5790030871670501, 'recall': 0.5546177600044268, 'f1-score': 0.5512469781290369, 'support': 130511}, 'weighted avg': {'precision': 0.620945522486141, 'recall': 0.6177257089440736, 'f1-score': 0.6090385602550732, 'support': 130511}}
[[16889  9641  1140]
 [14167 54667  5577]
 [ 5151 14215  9064]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
6203/6203 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8619391
{'0': {'precision': 0.4023309839744852, 'recall': 0.5246002637633446, 'f1-score': 0.4554015000104457, 'support': 311643}, '1': {'precision': 0.6803102717133145, 'recall': 0.801420095159297, 'f1-score': 0.7359157035366412, 'support': 959654}, '2': {'precision': 0.6011679633149778, 'recall': 0.0969021754581034, 'f1-score': 0.16690151956170465, 'support': 316577}, 'accuracy': 0.6066293673175579, 'macro avg': {'precision': 0.5612697396675924, 'recall': 0.47430751146024835, 'f1-score': 0.4527395743695972, 'support': 1587874}, 'weighted avg': {'precision': 0.6099741280806256, 'recall': 0.6066293673175579, 'f1-score': 0.5674155005924859, 'support': 1587874}}
[[163488 141623   6532]
 [176748 769086  13820]
 [ 66116 219784  30677]]
Evaluating performance on  train set...
1766/1766 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85791117
{'0': {'precision': 0.5050373740656483, 'recall': 0.18584474885844748, 'f1-score': 0.2717063905203176, 'support': 91980}, '1': {'precision': 0.635294087412848, 'recall': 0.9226511501181283, 'f1-score': 0.7524716611267365, 'support': 267929}, '2': {'precision': 0.5135228251507321, 'recall': 0.16186659716339785, 'f1-score': 0.2461459700925628, 'support': 92082}, 'accuracy': 0.6177202643415466, 'macro avg': {'precision': 0.5512847622097428, 'recall': 0.42345416537999125, 'f1-score': 0.42344134057987226, 'support': 451991}, 'weighted avg': {'precision': 0.5839790084283204, 'recall': 0.6177202643415466, 'f1-score': 0.5514847568030062, 'support': 451991}}
[[ 17094  69993   4893]
 [ 11497 247205   9227]
 [  5256  71921  14905]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.815434
{'0': {'precision': 0.4869209809264305, 'recall': 0.2631617701200206, 'f1-score': 0.3416662683428134, 'support': 27162}, '1': {'precision': 0.6826111690528113, 'recall': 0.9133813314726125, 'f1-score': 0.7813123160193715, 'support': 94587}, '2': {'precision': 0.4800820152314001, 'recall': 0.12452987881320518, 'f1-score': 0.19776175680974933, 'support': 26323}, 'accuracy': 0.6538710897401264, 'macro avg': {'precision': 0.5498713884035472, 'recall': 0.4336909934686128, 'f1-score': 0.44024678039064474, 'support': 148072}, 'weighted avg': {'precision': 0.6107102572941414, 'recall': 0.6538710897401264, 'f1-score': 0.5969258870046653, 'support': 148072}}
[[ 7148 18970  1044]
 [ 5687 86394  2506]
 [ 1845 21200  3278]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
5183/5183 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1416637
{'0': {'precision': 0.5243941749395093, 'recall': 0.30101064514995723, 'f1-score': 0.38247469622072694, 'support': 426955}, '1': {'precision': 0.38888721096879103, 'recall': 0.8539865041227894, 'f1-score': 0.5344137956426709, 'support': 467402}, '2': {'precision': 0.6430868167202572, 'recall': 0.08231537424592411, 'f1-score': 0.14594919246229815, 'support': 432483}, 'accuracy': 0.4245221729824244, 'macro avg': {'precision': 0.5187894008761859, 'recall': 0.41243750783955696, 'f1-score': 0.3542792281085653, 'support': 1326840}, 'weighted avg': {'precision': 0.5153473598159236, 'recall': 0.4245221729824244, 'f1-score': 0.35890243393292953, 'support': 1326840}}
[[128518 287844  10593]
 [ 59082 399155   9165]
 [ 57479 339404  35600]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.059462
{'0': {'precision': 0.5213382831195925, 'recall': 0.29237175130549986, 'f1-score': 0.37464104019798594, 'support': 116239}, '1': {'precision': 0.4509433405178777, 'recall': 0.8199553059129069, 'f1-score': 0.5818770611836701, 'support': 149013}, '2': {'precision': 0.5499143054288067, 'recall': 0.2133229719811769, 'f1-score': 0.30739943511963275, 'support': 115815}, 'accuracy': 0.47465406345865685, 'macro avg': {'precision': 0.5073986430220924, 'recall': 0.4418833430665279, 'f1-score': 0.42130584550042965, 'support': 381067}, 'weighted avg': {'precision': 0.5024958497465434, 'recall': 0.47465406345865685, 'f1-score': 0.4352426527831489, 'support': 381067}}
[[ 33985  73024   9230]
 [ 15838 122184  10991]
 [ 15365  75744  24706]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0249172
{'0': {'precision': 0.4938439513242663, 'recall': 0.36348788198103266, 'f1-score': 0.41875569044006067, 'support': 37960}, '1': {'precision': 0.49295699040175217, 'recall': 0.8046651828744676, 'f1-score': 0.6113726090690598, 'support': 57061}, '2': {'precision': 0.5773778920308483, 'recall': 0.17857994752325673, 'f1-score': 0.27278800024291006, 'support': 37731}, 'accuracy': 0.5005649632397252, 'macro avg': {'precision': 0.5213929445856222, 'recall': 0.44891100412625234, 'f1-score': 0.43430543325067683, 'support': 132752}, 'weighted avg': {'precision': 0.5172048667123619, 'recall': 0.5005649632397252, 'f1-score': 0.460061336118172, 'support': 132752}}
[[13798 22179  1983]
 [ 8197 45915  2949]
 [ 5945 25048  6738]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
7324/7324 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1555783
{'0': {'precision': 0.5380293484059615, 'recall': 0.35508857938718663, 'f1-score': 0.42782273437541946, 'support': 673125}, '1': {'precision': 0.34154665486993085, 'recall': 0.7984967279798689, 'f1-score': 0.47844475125915553, 'support': 549202}, '2': {'precision': 0.6145297161503488, 'recall': 0.13798727426848503, 'f1-score': 0.22536974332333998, 'support': 652379}, 'accuracy': 0.40943753313852943, 'macro avg': {'precision': 0.49803523980874703, 'recall': 0.43052419387851354, 'f1-score': 0.3772124096526383, 'support': 1874706}, 'weighted avg': {'precision': 0.5070903879254064, 'recall': 0.40943753313852943, 'f1-score': 0.3722010171925743, 'support': 1874706}}
[[239019 403957  30149]
 [ 84349 438536  26317]
 [120881 441478  90020]]
Evaluating performance on  train set...
2046/2046 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1492243
{'0': {'precision': 0.5183782267115601, 'recall': 0.29952636272046135, 'f1-score': 0.37967251135788155, 'support': 172706}, '1': {'precision': 0.38825009683700445, 'recall': 0.8376163768928772, 'f1-score': 0.5305710636680302, 'support': 178300}, '2': {'precision': 0.5963403150688418, 'recall': 0.13564424067706343, 'f1-score': 0.22101594517989612, 'support': 172746}, 'accuracy': 0.42865516503994255, 'macro avg': {'precision': 0.5009895462058022, 'recall': 0.4242623267634673, 'f1-score': 0.3770865067352693, 'support': 523752}, 'weighted avg': {'precision': 0.499792700276785, 'recall': 0.42865516503994255, 'f1-score': 0.3787138986860774, 'support': 523752}}
[[ 51730 112550   8426]
 [ 21518 149347   7435]
 [ 26544 122770  23432]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.114821
{'0': {'precision': 0.5465585876651474, 'recall': 0.30572991464024657, 'f1-score': 0.392119123749211, 'support': 61973}, '1': {'precision': 0.3937572812775268, 'recall': 0.8511847176793969, 'f1-score': 0.5384350123607893, 'support': 65121}, '2': {'precision': 0.5941916336913511, 'recall': 0.13455261136712748, 'f1-score': 0.2194186410604321, 'support': 62496}, 'accuracy': 0.4366580515849992, 'macro avg': {'precision': 0.5115025008780084, 'recall': 0.43048908122892354, 'f1-score': 0.38332425905681083, 'support': 189590}, 'weighted avg': {'precision': 0.5097755346095294, 'recall': 0.4366580515849992, 'f1-score': 0.38544760951405443, 'support': 189590}}
[[18947 39897  3129]
 [ 7077 55430  2614]
 [ 8642 45445  8409]]
testing model on single stock: results/universal/W6/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
29350/29350 - 149s - 149s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1992158
{'0': {'precision': 0.36103305863509527, 'recall': 0.33533498169648285, 'f1-score': 0.34770985196729703, 'support': 2213509}, '1': {'precision': 0.4239825052197554, 'recall': 0.7045412287358208, 'f1-score': 0.5293874576177531, 'support': 3113981}, '2': {'precision': 0.40387586211772525, 'recall': 0.05226555116075015, 'f1-score': 0.09255372969706249, 'support': 2185914}, 'accuracy': 0.40600012990117396, 'macro avg': {'precision': 0.3962971419908586, 'recall': 0.3640472538643513, 'f1-score': 0.3232170130940375, 'support': 7513404}, 'weighted avg': {'precision': 0.3995873629899624, 'recall': 0.40600012990117396, 'f1-score': 0.34877345406626514, 'support': 7513404}}
[[ 742267 1408178   63064]
 [ 814486 2193928  105567]
 [ 499200 1572466  114248]]
Evaluating performance on  train set...
5452/5452 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2698417
{'0': {'precision': 0.4360830939816979, 'recall': 0.1395617292263886, 'f1-score': 0.21145160428370388, 'support': 467793}, '1': {'precision': 0.33440794238351973, 'recall': 0.8659542740302278, 'f1-score': 0.4824910064927408, 'support': 460701}, '2': {'precision': 0.4405661986242965, 'recall': 0.04978789286930303, 'f1-score': 0.08946540093967531, 'support': 466981}, 'accuracy': 0.34933051469929594, 'macro avg': {'precision': 0.4036857449965047, 'recall': 0.35176796537530647, 'f1-score': 0.26113600390537334, 'support': 1395475}, 'weighted avg': {'precision': 0.4040163644972378, 'recall': 0.34933051469929594, 'f1-score': 0.26011093849843914, 'support': 1395475}}
[[ 65286 389031  13476]
 [ 45708 398946  16047]
 [ 38716 405015  23250]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2224723
{'0': {'precision': 0.4325437127720897, 'recall': 0.09846103859587736, 'f1-score': 0.16040799291509308, 'support': 160043}, '1': {'precision': 0.36951277912772035, 'recall': 0.8943959387594113, 'f1-score': 0.5229661355988046, 'support': 186347}, '2': {'precision': 0.44530873130728416, 'recall': 0.04683744204778244, 'f1-score': 0.08475986617467304, 'support': 157673}, 'accuracy': 0.37656205672703613, 'macro avg': {'precision': 0.4157884077356981, 'recall': 0.34656480646769033, 'f1-score': 0.2560446648961902, 'support': 504063}, 'weighted avg': {'precision': 0.41323476404082476, 'recall': 0.37656205672703613, 'f1-score': 0.27077902813715726, 'support': 504063}}
[[ 15758 140438   3847]
 [ 14327 166668   5352]
 [  6346 143942   7385]]
training model: results/universal/W6/deepOF_L1/h10
Epoch 1/50
9426/9426 - 138s - loss: 2.9601 - accuracy10: 0.5260 - val_loss: 3.2568 - val_accuracy10: 0.5104 - 138s/epoch - 15ms/step
Epoch 2/50
9426/9426 - 134s - loss: 2.9508 - accuracy10: 0.5266 - val_loss: 3.2307 - val_accuracy10: 0.5117 - 134s/epoch - 14ms/step
Epoch 3/50
9426/9426 - 131s - loss: 2.9379 - accuracy10: 0.5285 - val_loss: 3.2615 - val_accuracy10: 0.5118 - 131s/epoch - 14ms/step
Epoch 4/50
9426/9426 - 134s - loss: 2.9280 - accuracy10: 0.5302 - val_loss: 3.2936 - val_accuracy10: 0.5126 - 134s/epoch - 14ms/step
Epoch 5/50
9426/9426 - 131s - loss: 2.9171 - accuracy10: 0.5322 - val_loss: 3.3010 - val_accuracy10: 0.5112 - 131s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 132s - loss: 2.9083 - accuracy10: 0.5333 - val_loss: 3.3122 - val_accuracy10: 0.5111 - 132s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 132s - loss: 2.8998 - accuracy10: 0.5342 - val_loss: 3.3523 - val_accuracy10: 0.5099 - 132s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 131s - loss: 2.8924 - accuracy10: 0.5348 - val_loss: 3.4138 - val_accuracy10: 0.5105 - 131s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 131s - loss: 2.8852 - accuracy10: 0.5357 - val_loss: 3.4603 - val_accuracy10: 0.5108 - 131s/epoch - 14ms/step
Epoch 10/50
9426/9426 - 133s - loss: 2.8783 - accuracy10: 0.5363 - val_loss: 3.5022 - val_accuracy10: 0.5100 - 133s/epoch - 14ms/step
Epoch 11/50
9426/9426 - 131s - loss: 2.8719 - accuracy10: 0.5363 - val_loss: 3.5448 - val_accuracy10: 0.5100 - 131s/epoch - 14ms/step
Epoch 12/50
9426/9426 - 135s - loss: 2.8663 - accuracy10: 0.5371 - val_loss: 3.5148 - val_accuracy10: 0.5091 - 135s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 209s - 209s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0923176
{'0': {'precision': 0.4909930886646709, 'recall': 0.04239010395543755, 'f1-score': 0.07804238437906905, 'support': 3133939}, '1': {'precision': 0.41858876491119634, 'recall': 0.9618600618093692, 'f1-score': 0.5833230576850511, 'support': 4497700}, '2': {'precision': 0.4992086638394597, 'recall': 0.03335367661709495, 'f1-score': 0.06252955972770932, 'support': 3186965}, 'accuracy': 0.42198633021413856, 'macro avg': {'precision': 0.46959683913844236, 'recall': 0.34586794746063393, 'f1-score': 0.24129833393060984, 'support': 10818604}, 'weighted avg': {'precision': 0.46331205177589285, 'recall': 0.42198633021413856, 'f1-score': 0.2835367397610846, 'support': 10818604}}
[[ 132848 2972884   28207]
 [  93115 4326158   78427]
 [  44607 3036061  106297]]
Evaluating performance on  train set...
9426/9426 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0425254
{'0': {'precision': 0.49110603870932884, 'recall': 0.0561747239233474, 'f1-score': 0.10081752557453456, 'support': 647284}, '1': {'precision': 0.46958000175731485, 'recall': 0.953438543658836, 'f1-score': 0.6292478400214763, 'support': 1121056}, '2': {'precision': 0.47527884941324594, 'recall': 0.04573114855944708, 'f1-score': 0.08343428246772108, 'support': 643850}, 'accuracy': 0.47038707564495336, 'macro avg': {'precision': 0.47865496329329654, 'recall': 0.35178147204721016, 'f1-score': 0.27116654935457735, 'support': 2412190}, 'weighted avg': {'precision': 0.4768773798103366, 'recall': 0.47038707564495336, 'f1-score': 0.3417636258064022, 'support': 2412190}}
[[  36361  603039    7884]
 [  27575 1068858   24623]
 [  10103  604303   29444]]
Evaluating performance on  val set...
3323/3323 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0099057
{'0': {'precision': 0.47757255936675463, 'recall': 0.0543152600016195, 'f1-score': 0.0975374008844486, 'support': 209941}, '1': {'precision': 0.513938558585407, 'recall': 0.9573934083422777, 'f1-score': 0.668838031583098, 'support': 432304}, '2': {'precision': 0.47002511729301927, 'recall': 0.047670545486005966, 'f1-score': 0.08656187542002321, 'support': 208053}, 'accuracy': 0.5118276180821312, 'macro avg': {'precision': 0.4871787450817269, 'recall': 0.35312640460996775, 'f1-score': 0.28431243596252326, 'support': 850298}, 'weighted avg': {'precision': 0.4942148412025974, 'recall': 0.5118276180821312, 'f1-score': 0.3853095194288869, 'support': 850298}}
[[ 11403 196280   2258]
 [  9494 413885   8925]
 [  2980 195155   9918]]
testing model out of sample: results/universal/W6/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 100s - 100s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9870202
{'0': {'precision': 0.46199740299856423, 'recall': 0.0787117259177106, 'f1-score': 0.1345071167279955, 'support': 1026086}, '1': {'precision': 0.5533894299132226, 'recall': 0.9463709543258261, 'f1-score': 0.6983938079768963, 'support': 2434483}, '2': {'precision': 0.4810108499710894, 'recall': 0.06901670881529336, 'f1-score': 0.12071317241885562, 'support': 1024549}, 'accuracy': 0.5474549387552345, 'macro avg': {'precision': 0.4987992276276254, 'recall': 0.3646997963529433, 'f1-score': 0.3178713657079158, 'support': 4485118}, 'weighted avg': {'precision': 0.51594749838993, 'recall': 0.5474549387552345, 'f1-score': 0.43742891096478326, 'support': 4485118}}
[[  80765  927885   17436]
 [  71701 2303924   58858]
 [  22351  931487   70711]]
Evaluating performance on  train set...
5152/5152 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9636243
{'0': {'precision': 0.4681487524644775, 'recall': 0.07264530467563157, 'f1-score': 0.1257736038600283, 'support': 284368}, '1': {'precision': 0.5810931452799759, 'recall': 0.956491969873512, 'f1-score': 0.7229660611710016, 'support': 749241}, '2': {'precision': 0.47537364130434784, 'recall': 0.06874712720306245, 'f1-score': 0.1201224951489346, 'support': 285001}, 'accuracy': 0.5740089943197761, 'macro avg': {'precision': 0.5082051796829338, 'recall': 0.36596146725073536, 'f1-score': 0.3229540533933215, 'support': 1318610}, 'weighted avg': {'precision': 0.5338859077732714, 'recall': 0.5740089943197761, 'f1-score': 0.46388002067346107, 'support': 1318610}}
[[ 20658 258241   5469]
 [ 16444 716643  16154]
 [  7025 258383  19593]]
Evaluating performance on  val set...
1795/1795 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9612706
{'0': {'precision': 0.45101948929053837, 'recall': 0.07197552914126172, 'f1-score': 0.1241402508652816, 'support': 97422}, '1': {'precision': 0.5880992460026951, 'recall': 0.9537067844287832, 'f1-score': 0.7275548671621944, 'support': 264488}, '2': {'precision': 0.45286942057111174, 'recall': 0.06737541117149073, 'f1-score': 0.11729963108242748, 'support': 96979}, 'accuracy': 0.579203249587591, 'macro avg': {'precision': 0.4973293852881151, 'recall': 0.36435257491384526, 'f1-score': 0.32299824970330115, 'support': 458889}, 'weighted avg': {'precision': 0.5304185491480282, 'recall': 0.579203249587591, 'f1-score': 0.4704822389478386, 'support': 458889}}
[[  7012  88570   1840]
 [  6190 252244   6054]
 [  2345  88100   6534]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1547738
{'0': {'precision': 0.480859010270775, 'recall': 0.012445776290192003, 'f1-score': 0.024263554021742968, 'support': 82759}, '1': {'precision': 0.37300152926456276, 'recall': 0.9869069869169285, 'f1-score': 0.5413861461733324, 'support': 100588}, '2': {'precision': 0.4620367038503059, 'recall': 0.0146383172775466, 'f1-score': 0.02837757199372334, 'support': 87715}, 'accuracy': 0.37476665855044233, 'macro avg': {'precision': 0.4386324144618812, 'recall': 0.33799702682822236, 'f1-score': 0.19800909072959957, 'support': 271062}, 'weighted avg': {'precision': 0.4347434835384248, 'recall': 0.37476665855044233, 'f1-score': 0.21749310440415118, 'support': 271062}}
[[ 1030 81002   727]
 [  549 99271   768]
 [  563 85868  1284]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.085844
{'0': {'precision': 0.43575418994413406, 'recall': 0.010238907849829351, 'f1-score': 0.020007695267410544, 'support': 15236}, '1': {'precision': 0.45213496678522364, 'recall': 0.9888463596328765, 'f1-score': 0.6205382509427139, 'support': 24297}, '2': {'precision': 0.4155844155844156, 'recall': 0.013309302647996672, 'f1-score': 0.02579258463191832, 'support': 14426}, 'accuracy': 0.4517133379047054, 'macro avg': {'precision': 0.4344911907712577, 'recall': 0.33746485671023413, 'f1-score': 0.22211284361401426, 'support': 53959}, 'weighted avg': {'precision': 0.43773781769844117, 'recall': 0.4517133379047054, 'f1-score': 0.291964991088594, 'support': 53959}}
[[  156 14952   128]
 [  129 24026   142]
 [   73 14161   192]]
Evaluating performance on  val set...
81/81 - 1s - 725ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0970713
{'0': {'precision': 0.5, 'recall': 0.011677829297612914, 'f1-score': 0.022822621245175364, 'support': 5823}, '1': {'precision': 0.4375922827049907, 'recall': 0.9888777666555444, 'f1-score': 0.6067078371831178, 'support': 8991}, '2': {'precision': 0.4010989010989011, 'recall': 0.012538646513225695, 'f1-score': 0.02431712191872085, 'support': 5822}, 'accuracy': 0.43768172126381083, 'macro avg': {'precision': 0.4462303946012973, 'recall': 0.3376980808221277, 'f1-score': 0.21794919344900465, 'support': 20636}, 'weighted avg': {'precision': 0.44490647489815727, 'recall': 0.43768172126381083, 'f1-score': 0.2776400742118076, 'support': 20636}}
[[  68 5699   56]
 [  47 8891   53]
 [  21 5728   73]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7960485
{'0': {'precision': 0.5143009605122733, 'recall': 0.07201781391039244, 'f1-score': 0.1263436631534791, 'support': 66914}, '1': {'precision': 0.7727918631256194, 'recall': 0.9828396664538217, 'f1-score': 0.8652504630906869, 'support': 424409}, '2': {'precision': 0.5522670652715496, 'recall': 0.0816837885241794, 'f1-score': 0.1423178654888164, 'support': 67847}, 'accuracy': 0.7645027451401184, 'macro avg': {'precision': 0.6131199629698141, 'recall': 0.3788470896294645, 'f1-score': 0.3779706639109941, 'support': 559170}, 'weighted avg': {'precision': 0.7151017041087292, 'recall': 0.7645027451401184, 'f1-score': 0.6891107961548848, 'support': 559170}}
[[  4819  61390    705]
 [  3495 417126   3788]
 [  1056  61249   5542]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7685502
{'0': {'precision': 0.4108556351300415, 'recall': 0.08068097705403404, 'f1-score': 0.1348759512466745, 'support': 13510}, '1': {'precision': 0.8153515916391372, 'recall': 0.9802694194304122, 'f1-score': 0.8902371117741413, 'support': 109272}, '2': {'precision': 0.46479500891265596, 'recall': 0.07732226258432798, 'f1-score': 0.13258755482107673, 'support': 13489}, 'accuracy': 0.8017039575551658, 'macro avg': {'precision': 0.5636674118939449, 'recall': 0.3794242196895914, 'f1-score': 0.3859002059472975, 'support': 136271}, 'weighted avg': {'precision': 0.7405491896839494, 'recall': 0.8017039575551658, 'f1-score': 0.7403529533511022, 'support': 136271}}
[[  1090  12191    229]
 [  1184 107116    972]
 [   379  12067   1043]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7538925
{'0': {'precision': 0.49065420560747663, 'recall': 0.11015526647083508, 'f1-score': 0.17991775188485262, 'support': 4766}, '1': {'precision': 0.8236953759341819, 'recall': 0.9814211296158485, 'f1-score': 0.8956674473067916, 'support': 38969}, '2': {'precision': 0.46714285714285714, 'recall': 0.07321988356471115, 'f1-score': 0.12659698025551686, 'support': 4466}, 'accuracy': 0.8111242505342213, 'macro avg': {'precision': 0.5938308128948385, 'recall': 0.38826542655046486, 'f1-score': 0.40072739314905376, 'support': 48201}, 'weighted avg': {'precision': 0.7577291560072273, 'recall': 0.8111242505342213, 'f1-score': 0.753638614829624, 'support': 48201}}
[[  525  4156    85]
 [  436 38245   288]
 [  109  4030   327]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0763171
{'0': {'precision': 0.5422522576400933, 'recall': 0.09923822866274107, 'f1-score': 0.1677722575332834, 'support': 91366}, '1': {'precision': 0.42340797797625124, 'recall': 0.939691072028502, 'f1-score': 0.5837766473808876, 'support': 127991}, '2': {'precision': 0.5604196086342546, 'recall': 0.06083100673345377, 'f1-score': 0.10974923209118115, 'support': 91335}, 'accuracy': 0.43417596848325674, 'macro avg': {'precision': 0.5086932814168664, 'recall': 0.3665867691415656, 'f1-score': 0.28709937900178406, 'support': 310692}, 'weighted avg': {'precision': 0.4986345166123132, 'recall': 0.43417596848325674, 'f1-score': 0.32208998966745583, 'support': 310692}}
[[  9067  80617   1682]
 [  5043 120272   2676]
 [  2611  83168   5556]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0382268
{'0': {'precision': 0.5104371799921229, 'recall': 0.07319139323431412, 'f1-score': 0.12802528894596465, 'support': 35414}, '1': {'precision': 0.4776199124025211, 'recall': 0.9554518106948531, 'f1-score': 0.6368736508771353, 'support': 60833}, '2': {'precision': 0.5497732155645739, 'recall': 0.06634402097197016, 'f1-score': 0.11840008225798163, 'support': 34713}, 'accuracy': 0.4812003665241295, 'macro avg': {'precision': 0.5126101026530726, 'recall': 0.3649957416337124, 'f1-score': 0.29443300736036054, 'support': 130960}, 'weighted avg': {'precision': 0.505619670550677, 'recall': 0.4812003665241295, 'f1-score': 0.3618421231060055, 'support': 130960}}
[[ 2592 32120   702]
 [ 1526 58123  1184]
 [  960 31450  2303]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0471879
{'0': {'precision': 0.5246455097906819, 'recall': 0.06710424043527075, 'f1-score': 0.11898928024502298, 'support': 11579}, '1': {'precision': 0.4710415113099677, 'recall': 0.9565875820292782, 'f1-score': 0.6312458361092604, 'support': 19810}, '2': {'precision': 0.5365853658536586, 'recall': 0.0654928978480905, 'f1-score': 0.11673741661613096, 'support': 11757}, 'accuracy': 0.4750614193668011, 'macro avg': {'precision': 0.5107574623181027, 'recall': 0.3630615734375464, 'f1-score': 0.28899084432347144, 'support': 43146}, 'weighted avg': {'precision': 0.5032873694724477, 'recall': 0.4750614193668011, 'f1-score': 0.35357249099423865, 'support': 43146}}
[[  777 10576   226]
 [  421 18950   439]
 [  283 10704   770]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1095/1095 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2075691
{'0': {'precision': 0.5656565656565656, 'recall': 0.020080081276519453, 'f1-score': 0.03878340162751774, 'support': 100398}, '1': {'precision': 0.2625121405656768, 'recall': 0.9812563601859237, 'f1-score': 0.41421165980715985, 'support': 72718}, '2': {'precision': 0.5659013605442177, 'recall': 0.024885947199162366, 'f1-score': 0.04767533490937746, 'support': 106968}, 'accuracy': 0.2714649890747062, 'macro avg': {'precision': 0.46469002225548667, 'recall': 0.34207412955386846, 'f1-score': 0.16689013211468504, 'support': 280084}, 'weighted avg': {'precision': 0.48704489528547373, 'recall': 0.2714649890747062, 'f1-score': 0.13965151404236895, 'support': 280084}}
[[  2016  97132   1250]
 [   571  71355    792]
 [   977 103329   2662]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1702087
{'0': {'precision': 0.5330444203683641, 'recall': 0.012339176886615002, 'f1-score': 0.024120011765859397, 'support': 39873}, '1': {'precision': 0.3261067394679086, 'recall': 0.988052116559442, 'f1-score': 0.4903675878722833, 'support': 36994}, '2': {'precision': 0.5592020592020592, 'recall': 0.023052843803056028, 'f1-score': 0.04428025477707006, 'support': 37696}, 'accuracy': 0.33093581697406665, 'macro avg': {'precision': 0.47278440634611063, 'recall': 0.3411480457497043, 'f1-score': 0.1862559514717376, 'support': 114563}, 'weighted avg': {'precision': 0.4748282928773201, 'recall': 0.33093581697406665, 'f1-score': 0.18131145534739654, 'support': 114563}}
[[  492 38968   413]
 [  170 36552   272]
 [  261 36566   869]]
Evaluating performance on  val set...
136/136 - 1s - 813ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1927413
{'0': {'precision': 0.5322033898305085, 'recall': 0.012675601485548199, 'f1-score': 0.02476145414399495, 'support': 12386}, '1': {'precision': 0.29846999054820417, 'recall': 0.9815444390480816, 'f1-score': 0.45774727639238066, 'support': 10295}, '2': {'precision': 0.5482315112540193, 'recall': 0.028200463116109825, 'f1-score': 0.05364165486864873, 'support': 12092}, 'accuracy': 0.3049204842837834, 'macro avg': {'precision': 0.45963496387757735, 'recall': 0.3408068345499133, 'f1-score': 0.17871679513500813, 'support': 34773}, 'weighted avg': {'precision': 0.46857720568308864, 'recall': 0.3049204842837834, 'f1-score': 0.1629953835492704, 'support': 34773}}
[[  157 12068   161]
 [   70 10105   120]
 [   68 11683   341]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2045888
{'0': {'precision': 0.5989932885906041, 'recall': 0.019989921048210985, 'f1-score': 0.03868870224871308, 'support': 160731}, '1': {'precision': 0.2667536497637351, 'recall': 0.9784172041527265, 'f1-score': 0.4192137317998604, 'support': 115972}, '2': {'precision': 0.6099403578528827, 'recall': 0.03739388510034067, 'f1-score': 0.07046758272992977, 'support': 164091}, 'accuracy': 0.27862901945126295, 'macro avg': {'precision': 0.49189576540240737, 'recall': 0.3452670034337593, 'f1-score': 0.17612333892616774, 'support': 440794}, 'weighted avg': {'precision': 0.5156569005006729, 'recall': 0.27862901945126295, 'f1-score': 0.15063413935572673, 'support': 440794}}
[[  3213 155244   2274]
 [   853 113469   1650]
 [  1298 156657   6136]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1422834
{'0': {'precision': 0.53912050256996, 'recall': 0.054628575837657456, 'f1-score': 0.09920482012120363, 'support': 51841}, '1': {'precision': 0.34833823865392627, 'recall': 0.9662621856884565, 'f1-score': 0.512073572483417, 'support': 53649}, '2': {'precision': 0.5400669930430302, 'recall': 0.03995272768861271, 'f1-score': 0.07440143407344302, 'support': 52462}, 'accuracy': 0.35939399311183146, 'macro avg': {'precision': 0.47584191142230553, 'recall': 0.35361449640490883, 'f1-score': 0.2285599422260212, 'support': 157952}, 'weighted avg': {'precision': 0.47463494433940207, 'recall': 0.35939399311183146, 'f1-score': 0.2311990997545275, 'support': 157952}}
[[ 2832 47998  1011]
 [ 1036 51839   774]
 [ 1385 48981  2096]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.122481
{'0': {'precision': 0.5340288127173373, 'recall': 0.05792962224497494, 'f1-score': 0.10452114730189598, 'support': 18557}, '1': {'precision': 0.37373493975903616, 'recall': 0.9652448657187994, 'f1-score': 0.5388367027886529, 'support': 20889}, '2': {'precision': 0.52834008097166, 'recall': 0.043502416800933384, 'f1-score': 0.08038601714491042, 'support': 17999}, 'accuracy': 0.38334058664809817, 'macro avg': {'precision': 0.47870127781601113, 'recall': 0.3555589682549026, 'f1-score': 0.24124795574515312, 'support': 57445}, 'weighted avg': {'precision': 0.47395795894561826, 'recall': 0.38334058664809817, 'f1-score': 0.25489123052702056, 'support': 57445}}
[[ 1075 17126   356]
 [  383 20163   343]
 [  555 16661   783]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/EXC
Evaluating performance on  test set...
4450/4450 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9073072
{'0': {'precision': 0.38247507430281824, 'recall': 0.0943592463740984, 'f1-score': 0.15137358282792046, 'support': 192297}, '1': {'precision': 0.6760343969894456, 'recall': 0.9293626353857468, 'f1-score': 0.782711187484856, 'support': 755988}, '2': {'precision': 0.39839306843772665, 'recall': 0.10938998380766228, 'f1-score': 0.17164893988792457, 'support': 190831}, 'accuracy': 0.6510372955871044, 'macro avg': {'precision': 0.4856341799099968, 'recall': 0.37770395518916916, 'f1-score': 0.36857790340023366, 'support': 1139116}, 'weighted avg': {'precision': 0.5799659110375991, 'recall': 0.6510372955871044, 'f1-score': 0.5737649983927137, 'support': 1139116}}
[[ 18145 170197   3955]
 [ 25833 702587  27568]
 [  3463 166493  20875]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8647922
{'0': {'precision': 0.3449344325789852, 'recall': 0.11782717169426174, 'f1-score': 0.17565263943872303, 'support': 52908}, '1': {'precision': 0.7379672527409283, 'recall': 0.9203601754222264, 'f1-score': 0.8191333733662114, 'support': 278642}, '2': {'precision': 0.3316870288536522, 'recall': 0.11977172035743786, 'f1-score': 0.17599271754272236, 'support': 53268}, 'accuracy': 0.6992006610917368, 'macro avg': {'precision': 0.4715295713911886, 'recall': 0.38598635582464197, 'f1-score': 0.39025957678255224, 'support': 384818}, 'weighted avg': {'precision': 0.6276909262303297, 'recall': 0.6992006610917368, 'f1-score': 0.6416362315354208, 'support': 384818}}
[[  6234  45494   1180]
 [ 10516 256451  11675]
 [  1323  45565   6380]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85971105
{'0': {'precision': 0.35015154216437866, 'recall': 0.11213245789323437, 'f1-score': 0.16986680505102922, 'support': 17515}, '1': {'precision': 0.7419574883783602, 'recall': 0.9262884538553735, 'f1-score': 0.823939249408486, 'support': 95114}, '2': {'precision': 0.33517375771354335, 'recall': 0.1154233307236327, 'f1-score': 0.17171381031613975, 'support': 17882}, 'accuracy': 0.7059251710583783, 'macro avg': {'precision': 0.47576092941876075, 'recall': 0.38461474749074687, 'f1-score': 0.3885066215918849, 'support': 130511}, 'weighted avg': {'precision': 0.6336402751190476, 'recall': 0.7059251710583783, 'f1-score': 0.6467957583252042, 'support': 130511}}
[[ 1964 15236   315]
 [ 3232 88103  3779]
 [  413 15405  2064]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/AAL
Evaluating performance on  test set...
6203/6203 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8440533
{'0': {'precision': 0.403239689012431, 'recall': 0.1411273197759978, 'f1-score': 0.20908003467840172, 'support': 202498}, '1': {'precision': 0.7639228407259487, 'recall': 0.944346226923116, 'f1-score': 0.8446065856507557, 'support': 1181052}, '2': {'precision': 0.40561354267169547, 'recall': 0.11316617642020566, 'f1-score': 0.1769604016469976, 'support': 204319}, 'accuracy': 0.7349611334436279, 'macro avg': {'precision': 0.5242586908033583, 'recall': 0.39954657437310653, 'f1-score': 0.4102156739920517, 'support': 1587869}, 'weighted avg': {'precision': 0.6718201456517136, 'recall': 0.7349611334436279, 'f1-score': 0.677649704328516, 'support': 1587869}}
[[  28578  169276    4644]
 [  36491 1115322   29239]
 [   5802  175395   23122]]
Evaluating performance on  train set...
1766/1766 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8382685
{'0': {'precision': 0.4526837680534598, 'recall': 0.07156000817828664, 'f1-score': 0.12358393408856846, 'support': 58692}, '1': {'precision': 0.7520850713769488, 'recall': 0.9695304800050328, 'f1-score': 0.8470757593603182, 'support': 333809}, '2': {'precision': 0.4208232445520581, 'recall': 0.08764792899408284, 'f1-score': 0.14507916191324188, 'support': 59488}, 'accuracy': 0.7368586403651416, 'macro avg': {'precision': 0.5418640279941556, 'recall': 0.37624613905913407, 'f1-score': 0.3719129517873762, 'support': 451989}, 'weighted avg': {'precision': 0.6696083632074551, 'recall': 0.7368586403651416, 'f1-score': 0.6607359241037496, 'support': 451989}}
[[  4200  53326   1166]
 [  4161 323638   6010]
 [   917  53357   5214]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.817114
{'0': {'precision': 0.38387356013929813, 'recall': 0.08291864367550052, 'f1-score': 0.1363787770640019, 'support': 17282}, '1': {'precision': 0.7854407496416524, 'recall': 0.9644567815830262, 'f1-score': 0.8657920181113565, 'support': 114199}, '2': {'precision': 0.4088035019455253, 'recall': 0.10131999276716291, 'f1-score': 0.16239192387576676, 'support': 16591}, 'accuracy': 0.7648576368253283, 'macro avg': {'precision': 0.526039270575492, 'recall': 0.38289847267522986, 'f1-score': 0.3881875730170417, 'support': 148072}, 'weighted avg': {'precision': 0.6963714269776367, 'recall': 0.7648576368253283, 'f1-score': 0.7018458932853053, 'support': 148072}}
[[  1433  15530    319]
 [  1947 110140   2112]
 [   353  14557   1681]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/WBA
Evaluating performance on  test set...
5183/5183 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.976944
{'0': {'precision': 0.5022217002368509, 'recall': 0.08415524949405825, 'f1-score': 0.14415502691283386, 'support': 304877}, '1': {'precision': 0.5493211653714208, 'recall': 0.9519396958854593, 'f1-score': 0.6966419182730426, 'support': 709338}, '2': {'precision': 0.5394009761551528, 'recall': 0.08024758492738789, 'f1-score': 0.13971024339443486, 'support': 312620}, 'accuracy': 0.5471599709082139, 'macro avg': {'precision': 0.5303146139211415, 'recall': 0.37211417676896846, 'f1-score': 0.3268357295267704, 'support': 1326835}, 'weighted avg': {'precision': 0.5361614332384714, 'recall': 0.5471599709082139, 'f1-score': 0.43847226931309147, 'support': 1326835}}
[[ 25657 273947   5273]
 [ 17942 675247  16149]
 [  7488 280045  25087]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94514453
{'0': {'precision': 0.47869256860931236, 'recall': 0.09655670000497586, 'f1-score': 0.16069894309700525, 'support': 80388}, '1': {'precision': 0.5939690926651895, 'recall': 0.9474115861256486, 'f1-score': 0.7301677099429909, 'support': 220695}, '2': {'precision': 0.4935307872174591, 'recall': 0.07916781275787052, 'f1-score': 0.1364478731198552, 'support': 79982}, 'accuracy': 0.585682232689961, 'macro avg': {'precision': 0.5220641494973203, 'recall': 0.3743786996294984, 'f1-score': 0.3424381753866171, 'support': 381065}, 'weighted avg': {'precision': 0.5485697362243612, 'recall': 0.585682232689961, 'f1-score': 0.4854185064790067, 'support': 381065}}
[[  7762  71291   1335]
 [  6443 209089   5163]
 [  2010  71640   6332]]
Evaluating performance on  val set...
519/519 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.920701
{'0': {'precision': 0.4408951452806353, 'recall': 0.09537380441147765, 'f1-score': 0.15682372576710746, 'support': 25615}, '1': {'precision': 0.6302388867162039, 'recall': 0.9467699689114097, 'f1-score': 0.7567379841321086, 'support': 81702}, '2': {'precision': 0.4774251229324989, 'recall': 0.08398207124321774, 'f1-score': 0.14283803664571354, 'support': 25434}, 'accuracy': 0.6171855579242341, 'macro avg': {'precision': 0.516186384976446, 'recall': 0.37537528152203503, 'f1-score': 0.3521332488483098, 'support': 132751}, 'weighted avg': {'precision': 0.5644261605977804, 'recall': 0.6171855579242341, 'f1-score': 0.5233632073516062, 'support': 132751}}
[[ 2443 22721   451]
 [ 2462 77353  1887]
 [  636 22662  2136]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
7324/7324 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0178638
{'0': {'precision': 0.4891562648522901, 'recall': 0.0800234075116833, 'f1-score': 0.13754514793752615, 'support': 488732}, '1': {'precision': 0.4953404661039026, 'recall': 0.941448816125341, 'f1-score': 0.6491386053060608, 'support': 908880}, '2': {'precision': 0.516837242465204, 'recall': 0.0729297887815481, 'f1-score': 0.1278227806248967, 'support': 477089}, 'accuracy': 0.4958486713347889, 'macro avg': {'precision': 0.5004446578071322, 'recall': 0.36480067080619083, 'f1-score': 0.30483551128949454, 'support': 1874701}, 'weighted avg': {'precision': 0.4991989259283407, 'recall': 0.4958486713347889, 'f1-score': 0.38309823988888203, 'support': 1874701}}
[[ 39110 441531   8091]
 [ 28780 855664  24436]
 [ 12064 430231  34794]]
Evaluating performance on  train set...
2046/2046 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.986987
{'0': {'precision': 0.4522784135187236, 'recall': 0.08951576896537727, 'f1-score': 0.1494517707330957, 'support': 123185}, '1': {'precision': 0.540376586506346, 'recall': 0.9356920040628512, 'f1-score': 0.6850983137332224, 'support': 276653}, '2': {'precision': 0.48280781150081165, 'recall': 0.07920943895667894, 'f1-score': 0.13609167989683932, 'support': 123912}, 'accuracy': 0.5340410501193318, 'macro avg': {'precision': 0.49182093717529374, 'recall': 0.3681390706616358, 'f1-score': 0.3235472547877191, 'support': 523750}, 'weighted avg': {'precision': 0.506036089154621, 'recall': 0.5340410501193318, 'f1-score': 0.4292278995825694, 'support': 523750}}
[[ 11027 109730   2428]
 [  9705 258862   8086]
 [  3649 110448   9815]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99032986
{'0': {'precision': 0.44747951328532404, 'recall': 0.08157352708177723, 'f1-score': 0.1379917679716665, 'support': 44181}, '1': {'precision': 0.5400476313448681, 'recall': 0.9354566148768875, 'f1-score': 0.6847708237828084, 'support': 100599}, '2': {'precision': 0.45021288284576294, 'recall': 0.07315331399241241, 'f1-score': 0.1258566738976023, 'support': 44810}, 'accuracy': 0.5326652249591223, 'macro avg': {'precision': 0.4792466758253184, 'recall': 0.3633944853170257, 'f1-score': 0.31620642188402576, 'support': 189590}, 'weighted avg': {'precision': 0.49724343753594563, 'recall': 0.5326652249591223, 'f1-score': 0.4252519223579012, 'support': 189590}}
[[ 3604 39717   860]
 [ 3350 94106  3143]
 [ 1100 40432  3278]]
testing model on single stock: results/universal/W6/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
29350/29350 - 186s - 186s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1585075
{'0': {'precision': 0.5167134681467243, 'recall': 0.033307781115898945, 'f1-score': 0.06258150614995762, 'support': 2469453}, '1': {'precision': 0.33903523607184, 'recall': 0.970217891984489, 'f1-score': 0.5024819799948296, 'support': 2535247}, '2': {'precision': 0.5228066280501342, 'recall': 0.02065094297881093, 'f1-score': 0.03973244808924634, 'support': 2508699}, 'accuracy': 0.34522338025705807, 'macro avg': {'precision': 0.45951844408956616, 'recall': 0.34139220535973297, 'f1-score': 0.20159864474467784, 'support': 7513399}, 'weighted avg': {'precision': 0.45879396983755294, 'recall': 0.34522338025705807, 'f1-score': 0.203387943756418, 'support': 7513399}}
[[  82252 2370140   17061]
 [  45279 2459742   30226]
 [  31652 2425240   51807]]
Evaluating performance on  train set...
5452/5452 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1344545
{'0': {'precision': 0.5762422573984859, 'recall': 0.04544457832633167, 'f1-score': 0.08424526593282756, 'support': 460605}, '1': {'precision': 0.34463353966448934, 'recall': 0.9663247471358893, 'f1-score': 0.5080679094430176, 'support': 475453}, '2': {'precision': 0.5626537515375154, 'recall': 0.03186225961276841, 'f1-score': 0.060309292154806744, 'support': 459415}, 'accuracy': 0.3547270352059839, 'macro avg': {'precision': 0.4945098495334969, 'recall': 0.34787719502499653, 'f1-score': 0.2175408225102173, 'support': 1395473}, 'weighted avg': {'precision': 0.4928570374100665, 'recall': 0.3547270352059839, 'f1-score': 0.2207661459008534, 'support': 1395473}}
[[ 20932 435008   4665]
 [  9298 459442   6713]
 [  6095 438682  14638]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0841296
{'0': {'precision': 0.5555267479042434, 'recall': 0.0429509752169933, 'f1-score': 0.07973702164609564, 'support': 149659}, '1': {'precision': 0.4140766273695187, 'recall': 0.9704690045775467, 'f1-score': 0.5804771227612211, 'support': 206224}, '2': {'precision': 0.5586470267321331, 'recall': 0.03455280437848818, 'f1-score': 0.06508033353670938, 'support': 148179}, 'accuracy': 0.4199523074542417, 'macro avg': {'precision': 0.5094168006686317, 'recall': 0.3493242613910094, 'f1-score': 0.24176482598134205, 'support': 504062}, 'weighted avg': {'precision': 0.4985733376874145, 'recall': 0.4199523074542417, 'f1-score': 0.2802933286579412, 'support': 504062}}
[[  6428 141914   1317]
 [  3362 200134   2728]
 [  1781 141278   5120]]
training model: results/universal/W6/deepOF_L1/h20
Epoch 1/50
9426/9426 - 136s - loss: 3.0508 - accuracy20: 0.4886 - val_loss: 3.1934 - val_accuracy20: 0.4641 - 136s/epoch - 14ms/step
Epoch 2/50
9426/9426 - 136s - loss: 3.0370 - accuracy20: 0.4908 - val_loss: 3.2024 - val_accuracy20: 0.4687 - 136s/epoch - 14ms/step
Epoch 3/50
9426/9426 - 131s - loss: 3.0259 - accuracy20: 0.4936 - val_loss: 3.2141 - val_accuracy20: 0.4683 - 131s/epoch - 14ms/step
Epoch 4/50
9426/9426 - 131s - loss: 3.0141 - accuracy20: 0.4960 - val_loss: 3.2466 - val_accuracy20: 0.4684 - 131s/epoch - 14ms/step
Epoch 5/50
9426/9426 - 132s - loss: 3.0043 - accuracy20: 0.4970 - val_loss: 3.3197 - val_accuracy20: 0.4674 - 132s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 133s - loss: 2.9947 - accuracy20: 0.4982 - val_loss: 3.3432 - val_accuracy20: 0.4673 - 133s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 133s - loss: 2.9872 - accuracy20: 0.4991 - val_loss: 3.3142 - val_accuracy20: 0.4682 - 133s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 130s - loss: 2.9806 - accuracy20: 0.5001 - val_loss: 3.3480 - val_accuracy20: 0.4679 - 130s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 131s - loss: 2.9745 - accuracy20: 0.5004 - val_loss: 3.3377 - val_accuracy20: 0.4691 - 131s/epoch - 14ms/step
Epoch 10/50
9426/9426 - 137s - loss: 2.9680 - accuracy20: 0.5012 - val_loss: 3.3518 - val_accuracy20: 0.4699 - 137s/epoch - 15ms/step
Epoch 11/50
9426/9426 - 137s - loss: 2.9621 - accuracy20: 0.5023 - val_loss: 3.3458 - val_accuracy20: 0.4697 - 137s/epoch - 15ms/step
testing model in sample: results/universal/W6/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 206s - 206s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.065047
{'0': {'precision': 0.4551666869492387, 'recall': 0.10121366749674791, 'f1-score': 0.16560286264726115, 'support': 3141058}, '1': {'precision': 0.42619646569932496, 'recall': 0.918048849425157, 'f1-score': 0.5821395403979529, 'support': 4556983}, '2': {'precision': 0.46994404371297255, 'recall': 0.04580615741454346, 'f1-score': 0.0834758020269633, 'support': 3120563}, 'accuracy': 0.42929679282095917, 'macro avg': {'precision': 0.4504357321205121, 'recall': 0.35502289144548277, 'f1-score': 0.2770727350240591, 'support': 10818604}, 'weighted avg': {'precision': 0.4472263710834036, 'recall': 0.42929679282095917, 'f1-score': 0.3173662410568898, 'support': 10818604}}
[[ 317918 2774292   48848]
 [ 261073 4183533  112377]
 [ 119474 2858148  142941]]
Evaluating performance on  train set...
9426/9426 - 56s - 56s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0582849
{'0': {'precision': 0.4550387721354376, 'recall': 0.12245806161716248, 'f1-score': 0.19298171951616694, 'support': 694352}, '1': {'precision': 0.43098572749365155, 'recall': 0.9004306885849486, 'f1-score': 0.58294725931107, 'support': 1025567}, '2': {'precision': 0.46173105300079825, 'recall': 0.05514458932990115, 'f1-score': 0.0985226124557874, 'support': 692271}, 'accuracy': 0.4339028020180832, 'macro avg': {'precision': 0.44925185087662917, 'recall': 0.35934444651067077, 'f1-score': 0.29148386376100816, 'support': 2412190}, 'weighted avg': {'precision': 0.44673298491834507, 'recall': 0.4339028020180832, 'f1-score': 0.3316708311728123, 'support': 2412190}}
[[ 85029 595980  13343]
 [ 70955 923452  31160]
 [ 30877 623219  38175]]
Evaluating performance on  val set...
3323/3323 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0431228
{'0': {'precision': 0.43577758607168066, 'recall': 0.12063934554360004, 'f1-score': 0.1889659347124498, 'support': 230298}, '1': {'precision': 0.46650991533579855, 'recall': 0.9036887761365031, 'f1-score': 0.6153556809959538, 'support': 391024}, '2': {'precision': 0.46513067400275104, 'recall': 0.059071693103207326, 'f1-score': 0.10482995938865984, 'support': 228976}, 'accuracy': 0.4641584479794143, 'macro avg': {'precision': 0.4558060584700767, 'recall': 0.36113327159443687, 'f1-score': 0.30305052503235447, 'support': 850298}, 'weighted avg': {'precision': 0.4578148376943791, 'recall': 0.4641584479794143, 'f1-score': 0.36239161025798877, 'support': 850298}}
[[ 27783 198209   4306]
 [ 26412 353364  11248]
 [  9560 205890  13526]]
testing model out of sample: results/universal/W6/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 109s - 109s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.049227
{'0': {'precision': 0.4339665515360843, 'recall': 0.13870668896105154, 'f1-score': 0.2102213242272732, 'support': 1239176}, '1': {'precision': 0.45966663437372973, 'recall': 0.8917270384584597, 'f1-score': 0.6066288081536001, 'support': 2011287}, '2': {'precision': 0.4909753075871497, 'recall': 0.07446776629908759, 'f1-score': 0.1293210091432775, 'support': 1234655}, 'accuracy': 0.4587043194850169, 'macro avg': {'precision': 0.46153616449898793, 'recall': 0.3683004979061996, 'f1-score': 0.31539038050805024, 'support': 4485118}, 'weighted avg': {'precision': 0.46118465108497186, 'recall': 0.4587043194850169, 'f1-score': 0.36571449979226384, 'support': 4485118}}
[[ 171882 1034484   32810]
 [ 155256 1793519   62512]
 [  68934 1073779   91942]]
Evaluating performance on  train set...
5152/5152 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0361214
{'0': {'precision': 0.4437870422992612, 'recall': 0.12656692744738798, 'f1-score': 0.19696106405547284, 'support': 345501}, '1': {'precision': 0.4918771336891084, 'recall': 0.9158724147697439, 'f1-score': 0.6400239285390638, 'support': 628474}, '2': {'precision': 0.4769850979762931, 'recall': 0.06900634004091286, 'f1-score': 0.12056964110987749, 'support': 344635}, 'accuracy': 0.4877204025451043, 'macro avg': {'precision': 0.47088309132155426, 'recall': 0.3704818940860149, 'f1-score': 0.3191848779014714, 'support': 1318610}, 'weighted avg': {'precision': 0.4753843940669535, 'recall': 0.4877204025451043, 'f1-score': 0.3881672073780664, 'support': 1318610}}
[[ 43729 292440   9332]
 [ 36127 575602  16745]
 [ 18680 302173  23782]]
Evaluating performance on  val set...
1795/1795 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0335646
{'0': {'precision': 0.4337325002892514, 'recall': 0.12695147143486066, 'f1-score': 0.19641360159279053, 'support': 118116}, '1': {'precision': 0.49986590919715285, 'recall': 0.9115774454509967, 'f1-score': 0.6456744963563499, 'support': 222873}, '2': {'precision': 0.4456813604833296, 'recall': 0.06757421543681086, 'f1-score': 0.11735505538534056, 'support': 117900}, 'accuracy': 0.4927727620404935, 'macro avg': {'precision': 0.4597599233232446, 'recall': 0.36870104410755605, 'f1-score': 0.31981438444482696, 'support': 458889}, 'weighted avg': {'precision': 0.4689221035711182, 'recall': 0.4927727620404935, 'f1-score': 0.3942983205570289, 'support': 458889}}
[[ 14995  99923   3198]
 [ 12996 203166   6711]
 [  6581 103352   7967]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1592454
{'0': {'precision': 0.4518794988003199, 'recall': 0.03505760201865602, 'f1-score': 0.06506717850287908, 'support': 96698}, '1': {'precision': 0.26758731922643575, 'recall': 0.9655676533652642, 'f1-score': 0.4190449142864048, 'support': 71822}, '2': {'precision': 0.4909008189262966, 'recall': 0.021045035205086698, 'f1-score': 0.04035983467055678, 'support': 102542}, 'accuracy': 0.2763094790121817, 'macro avg': {'precision': 0.40345587898435076, 'recall': 0.3405567635296689, 'f1-score': 0.17482397581994688, 'support': 271062}, 'weighted avg': {'precision': 0.4178101393438206, 'recall': 0.2763094790121817, 'f1-score': 0.14951224453275558, 'support': 271062}}
[[ 3390 91899  1409]
 [ 1644 69349   829]
 [ 2468 97916  2158]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1223162
{'0': {'precision': 0.42398489140698775, 'recall': 0.02454490788826327, 'f1-score': 0.04640347250930136, 'support': 18293}, '1': {'precision': 0.3440103967586576, 'recall': 0.9771986970684039, 'f1-score': 0.5088770779147348, 'support': 18420}, '2': {'precision': 0.4427083333333333, 'recall': 0.014786037341992346, 'f1-score': 0.02861631691168219, 'support': 17246}, 'accuracy': 0.34663355510665506, 'macro avg': {'precision': 0.40356787383299286, 'recall': 0.3388432140995532, 'f1-score': 0.1946322891119061, 'support': 53959}, 'weighted avg': {'precision': 0.40266823038731564, 'recall': 0.34663355510665506, 'f1-score': 0.19859321891178366, 'support': 53959}}
[[  449 17640   204]
 [  303 18000   117]
 [  307 16684   255]]
Evaluating performance on  val set...
81/81 - 1s - 579ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1313587
{'0': {'precision': 0.4161073825503356, 'recall': 0.026412950866231185, 'f1-score': 0.04967285351849379, 'support': 7042}, '1': {'precision': 0.3236635101959016, 'recall': 0.974065138721351, 'f1-score': 0.48587868075664703, 'support': 6632}, '2': {'precision': 0.4434782608695652, 'recall': 0.01465096236713588, 'f1-score': 0.028364849833147944, 'support': 6962}, 'accuracy': 0.32700135685210313, 'macro avg': {'precision': 0.3944163845386008, 'recall': 0.3383763506515727, 'f1-score': 0.18797212803609623, 'support': 20636}, 'weighted avg': {'precision': 0.3956319170242584, 'recall': 0.32700135685210313, 'f1-score': 0.1826720163691458, 'support': 20636}}
[[ 186 6773   83]
 [ 127 6460   45]
 [ 134 6726  102]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9356291
{'0': {'precision': 0.39817896629557364, 'recall': 0.11598208116962713, 'f1-score': 0.17963875488664707, 'support': 89738}, '1': {'precision': 0.6910269971944993, 'recall': 0.9519183557101902, 'f1-score': 0.8007585666288419, 'support': 378814}, '2': {'precision': 0.5458523082418073, 'recall': 0.06745900372994328, 'f1-score': 0.12007817947886894, 'support': 90618}, 'accuracy': 0.6744299586887709, 'macro avg': {'precision': 0.5450194239106269, 'recall': 0.37845314686992015, 'f1-score': 0.3668251669981193, 'support': 559170}, 'weighted avg': {'precision': 0.6205027620597052, 'recall': 0.6744299586887709, 'f1-score': 0.5907688586887211, 'support': 559170}}
[[ 10408  78482    848]
 [ 13976 360600   4238]
 [  1755  82750   6113]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91431606
{'0': {'precision': 0.3528895391367959, 'recall': 0.1327682060879617, 'f1-score': 0.1929445644348452, 'support': 18167}, '1': {'precision': 0.7483979153217553, 'recall': 0.9506965487584131, 'f1-score': 0.8375041296830605, 'support': 99993}, '2': {'precision': 0.4266777133388567, 'recall': 0.056871514549169014, 'f1-score': 0.10036540803897687, 'support': 18111}, 'accuracy': 0.7228610636158831, 'macro avg': {'precision': 0.5093217225991359, 'recall': 0.38011208979851463, 'f1-score': 0.37693803405229415, 'support': 136271}, 'weighted avg': {'precision': 0.6529126304976588, 'recall': 0.7228610636158831, 'f1-score': 0.6536056258960455, 'support': 136271}}
[[ 2412 15472   283]
 [ 3829 95063  1101]
 [  594 16487  1030]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90625405
{'0': {'precision': 0.38991935483870965, 'recall': 0.15185301507537688, 'f1-score': 0.21858047016274865, 'support': 6368}, '1': {'precision': 0.7591021444318258, 'recall': 0.9530585998658019, 'f1-score': 0.8450945150294391, 'support': 35768}, '2': {'precision': 0.4520884520884521, 'recall': 0.0606760098928277, 'f1-score': 0.10699229539177205, 'support': 6065}, 'accuracy': 0.7349225119810793, 'macro avg': {'precision': 0.5337033171196625, 'recall': 0.38852920827800214, 'f1-score': 0.39022242686131997, 'support': 48201}, 'weighted avg': {'precision': 0.6716974422847433, 'recall': 0.7349225119810793, 'f1-score': 0.6694502047492885, 'support': 48201}}
[[  967  5302    99]
 [ 1332 34089   347]
 [  181  5516   368]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1144176
{'0': {'precision': 0.524391393120779, 'recall': 0.15119870302777802, 'f1-score': 0.23472013272780956, 'support': 110411}, '1': {'precision': 0.29917126345711187, 'recall': 0.8828705037565657, 'f1-score': 0.44690380899226206, 'support': 90242}, '2': {'precision': 0.5486930188077781, 'recall': 0.06256872563363898, 'f1-score': 0.11232838718624324, 'support': 110039}, 'accuracy': 0.33232590475454793, 'macro avg': {'precision': 0.45741855846188967, 'recall': 0.3655459774726609, 'f1-score': 0.26465077630210493, 'support': 310692}, 'weighted avg': {'precision': 0.4675821146323179, 'recall': 0.33232590475454793, 'f1-score': 0.2530019488859608, 'support': 310692}}
[[16694 90899  2818]
 [ 7725 79672  2845]
 [ 7416 95738  6885]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0925283
{'0': {'precision': 0.4900800873680379, 'recall': 0.1246758659010928, 'f1-score': 0.19878183831672203, 'support': 43192}, '1': {'precision': 0.36270827313878456, 'recall': 0.9066952658189061, 'f1-score': 0.5181423621968455, 'support': 45689}, '2': {'precision': 0.5261330092029867, 'recall': 0.07200741462487227, 'f1-score': 0.12667753668631634, 'support': 42079}, 'accuracy': 0.3805818570555895, 'macro avg': {'precision': 0.45964045656993635, 'recall': 0.36779284878162377, 'f1-score': 0.28120057906662793, 'support': 130960}, 'weighted avg': {'precision': 0.4572271557673388, 'recall': 0.3805818570555895, 'f1-score': 0.287031579209003, 'support': 130960}}
[[ 5385 36469  1338]
 [ 2872 41426  1391]
 [ 2731 36318  3030]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0989577
{'0': {'precision': 0.49849488260084285, 'recall': 0.11752182243985523, 'f1-score': 0.19020272210417505, 'support': 14091}, '1': {'precision': 0.3489150354572256, 'recall': 0.897029702970297, 'f1-score': 0.502409362092703, 'support': 14645}, '2': {'precision': 0.48228255867464337, 'recall': 0.07272727272727272, 'f1-score': 0.12639450039196767, 'support': 14410}, 'accuracy': 0.36714875075325637, 'macro avg': {'precision': 0.4432308255775706, 'recall': 0.36242626604580835, 'f1-score': 0.2730021948629486, 'support': 43146}, 'weighted avg': {'precision': 0.44230852814863847, 'recall': 0.36714875075325637, 'f1-score': 0.27486386723371387, 'support': 43146}}
[[ 1656 12001   434]
 [  817 13137   691]
 [  849 12513  1048]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1354129
{'0': {'precision': 0.5165511003919204, 'recall': 0.0844538643533123, 'f1-score': 0.14517263291675495, 'support': 101440}, '1': {'precision': 0.2671348347722887, 'recall': 0.921884535579153, 'f1-score': 0.4142362676871702, 'support': 73737}, '2': {'precision': 0.5098538529672276, 'recall': 0.04389602219108353, 'f1-score': 0.08083272628336215, 'support': 104907}, 'accuracy': 0.28973093786149867, 'macro avg': {'precision': 0.4311799293771456, 'recall': 0.35007814070784965, 'f1-score': 0.21341387562909575, 'support': 280084}, 'weighted avg': {'precision': 0.4483794257743877, 'recall': 0.28973093786149867, 'f1-score': 0.19190946419550267, 'support': 280084}}
[[ 8567 90393  2480]
 [ 3813 67977  1947]
 [ 4205 96097  4605]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1132164
{'0': {'precision': 0.466464502318944, 'recall': 0.06651066968486914, 'f1-score': 0.11642143222847982, 'support': 39317}, '1': {'precision': 0.3307033236041804, 'recall': 0.9411827755298909, 'f1-score': 0.48943419099972824, 'support': 37319}, '2': {'precision': 0.5023662176920277, 'recall': 0.036385688295936934, 'f1-score': 0.06785661602006197, 'support': 37927}, 'accuracy': 0.3414627759398759, 'macro avg': {'precision': 0.43317801453838406, 'recall': 0.34802637783689905, 'f1-score': 0.22457074641609, 'support': 114563}, 'weighted avg': {'precision': 0.43412572741342204, 'recall': 0.3414627759398759, 'f1-score': 0.22185290102946756, 'support': 114563}}
[[ 2615 35966   736]
 [ 1564 35124   631]
 [ 1427 35120  1380]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1243392
{'0': {'precision': 0.4519177320733741, 'recall': 0.06662296156682783, 'f1-score': 0.11612626767604628, 'support': 12203}, '1': {'precision': 0.3054139124960655, 'recall': 0.9227769852591536, 'f1-score': 0.45893342792952585, 'support': 10515}, '2': {'precision': 0.44601328903654486, 'recall': 0.044545831605143096, 'f1-score': 0.08100158382985143, 'support': 12055}, 'accuracy': 0.3178615592557444, 'macro avg': {'precision': 0.4011149778686615, 'recall': 0.34464859281037485, 'f1-score': 0.2186870931451412, 'support': 34773}, 'weighted avg': {'precision': 0.40556953882963975, 'recall': 0.3178615592557444, 'f1-score': 0.20761073051501497, 'support': 34773}}
[[  813 11041   349]
 [  494  9703   318]
 [  492 11026   537]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
1722/1722 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1356897
{'0': {'precision': 0.495253897206359, 'recall': 0.07942548793920717, 'f1-score': 0.13689644506543514, 'support': 161598}, '1': {'precision': 0.2609521277129469, 'recall': 0.9121414855278964, 'f1-score': 0.4058077867565454, 'support': 114047}, '2': {'precision': 0.5579031661944068, 'recall': 0.054841385657799925, 'f1-score': 0.09986602934122822, 'support': 165149}, 'accuracy': 0.28566405168854386, 'macro avg': {'precision': 0.4380363970379042, 'recall': 0.3488027863749678, 'f1-score': 0.21419008705440293, 'support': 440794}, 'weighted avg': {'precision': 0.4581051388718353, 'recall': 0.28566405168854386, 'f1-score': 0.19259819159421956, 'support': 440794}}
[[ 12835 145078   3685]
 [  6528 104027   3492]
 [  6553 149539   9057]]
Evaluating performance on  train set...
617/617 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1063352
{'0': {'precision': 0.4660838342049801, 'recall': 0.11348043408024022, 'f1-score': 0.18252124472702816, 'support': 52617}, '1': {'precision': 0.33995630991218867, 'recall': 0.8985906397204072, 'f1-score': 0.4932902351285126, 'support': 52648}, '2': {'precision': 0.43569158722194345, 'recall': 0.04944293658777307, 'f1-score': 0.08880782736167456, 'support': 52687}, 'accuracy': 0.35381001823338737, 'macro avg': {'precision': 0.41391057711303736, 'recall': 0.35383800346280686, 'f1-score': 0.25487310240573846, 'support': 157952}, 'weighted avg': {'precision': 0.4139057154362267, 'recall': 0.35381001823338737, 'f1-score': 0.2548462990848645, 'support': 157952}}
[[ 5971 45177  1469]
 [ 3434 47309  1905]
 [ 3406 46676  2605]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0992393
{'0': {'precision': 0.4433395483737311, 'recall': 0.11300628399429688, 'f1-score': 0.18010435953543177, 'support': 18937}, '1': {'precision': 0.3560830860534125, 'recall': 0.9036144578313253, 'f1-score': 0.5108556832694765, 'support': 19920}, '2': {'precision': 0.48452611218568664, 'recall': 0.0539057456423499, 'f1-score': 0.09701781564678544, 'support': 18588}, 'accuracy': 0.3680389938201758, 'macro avg': {'precision': 0.4279829155376101, 'recall': 0.35684216248932404, 'f1-score': 0.2626592861505646, 'support': 57445}, 'weighted avg': {'precision': 0.42640904299843096, 'recall': 0.3680389938201758, 'f1-score': 0.267912762198501, 'support': 57445}}
[[ 2140 16327   470]
 [ 1324 18000   596]
 [ 1363 16223  1002]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/EXC
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9951342
{'0': {'precision': 0.39798639125993385, 'recall': 0.1857119773783074, 'f1-score': 0.25325011568208355, 'support': 247550}, '1': {'precision': 0.5793539177996825, 'recall': 0.8509306014663274, 'f1-score': 0.6893593143106219, 'support': 646786}, '2': {'precision': 0.3871655575173163, 'recall': 0.11645967807827437, 'f1-score': 0.1790584466568261, 'support': 244780}, 'accuracy': 0.5485393937052943, 'macro avg': {'precision': 0.45483528885897756, 'recall': 0.384367418974303, 'f1-score': 0.3738892922165105, 'support': 1139116}, 'weighted avg': {'precision': 0.4986409807284515, 'recall': 0.5485393937052943, 'f1-score': 0.4849286167304011, 'support': 1139116}}
[[ 45973 194280   7297]
 [ 58590 550370  37826]
 [ 10951 205322  28507]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9688358
{'0': {'precision': 0.3595649696048632, 'recall': 0.21574410486571205, 'f1-score': 0.2696777295920639, 'support': 70185}, '1': {'precision': 0.6522647601185718, 'recall': 0.8490337273792261, 'f1-score': 0.7377543974544237, 'support': 244134}, '2': {'precision': 0.36563151982025355, 'recall': 0.12926424488290614, 'f1-score': 0.1910021692883267, 'support': 70499}, 'accuracy': 0.6016688408546378, 'macro avg': {'precision': 0.4591537498478962, 'recall': 0.39801402570928146, 'f1-score': 0.3994780987782714, 'support': 384818}, 'weighted avg': {'precision': 0.5463692676909936, 'recall': 0.6016688408546378, 'f1-score': 0.5522187773238649, 'support': 384818}}
[[ 15142  52795   2248]
 [ 23293 207278  13563]
 [  3677  57709   9113]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96776634
{'0': {'precision': 0.35588320323793005, 'recall': 0.21034644794737067, 'f1-score': 0.2644113303799168, 'support': 23409}, '1': {'precision': 0.6545382837436254, 'recall': 0.8581718917228857, 'f1-score': 0.7426490100684237, 'support': 83157}, '2': {'precision': 0.37897214593958417, 'recall': 0.12102735435372729, 'f1-score': 0.18346416814383387, 'support': 23945}, 'accuracy': 0.6067304671636874, 'macro avg': {'precision': 0.4631312109737132, 'recall': 0.3965152313413279, 'f1-score': 0.3968415028640581, 'support': 130511}, 'weighted avg': {'precision': 0.5504118273585269, 'recall': 0.6067304671636874, 'f1-score': 0.5542760232419296, 'support': 130511}}
[[ 4924 17817   668]
 [ 7713 71363  4081]
 [ 1199 19848  2898]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/AAL
Evaluating performance on  test set...
6203/6203 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.956256
{'0': {'precision': 0.35365853658536583, 'recall': 0.2076304433111024, 'f1-score': 0.2616487455197133, 'support': 265096}, '1': {'precision': 0.6864931211103479, 'recall': 0.8891850539310218, 'f1-score': 0.7748021551440902, 'support': 1054217}, '2': {'precision': 0.4222109032074426, 'recall': 0.1049427307526177, 'f1-score': 0.16810266412571165, 'support': 268556}, 'accuracy': 0.6427602025104086, 'macro avg': {'precision': 0.48745418696771875, 'recall': 0.4005860759982473, 'f1-score': 0.4015178549298384, 'support': 1587869}, 'weighted avg': {'precision': 0.5862281166733526, 'recall': 0.6427602025104086, 'f1-score': 0.5865198064190281, 'support': 1587869}}
[[ 55042 202836   7218]
 [ 85473 937394  31350]
 [ 15121 225252  28183]]
Evaluating performance on  train set...
1766/1766 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9554401
{'0': {'precision': 0.386432384341637, 'recall': 0.1116911169111691, 'f1-score': 0.17329463279372012, 'support': 77777}, '1': {'precision': 0.6674855032502799, 'recall': 0.9449140084014586, 'f1-score': 0.7823326636709066, 'support': 295901}, '2': {'precision': 0.45377518358124647, 'recall': 0.06154946303839818, 'f1-score': 0.10839620838159064, 'support': 78311}, 'accuracy': 0.6484848082586081, 'macro avg': {'precision': 0.5025643570577211, 'recall': 0.37271819611700857, 'f1-score': 0.3546745016154058, 'support': 451989}, 'weighted avg': {'precision': 0.5820955108545375, 'recall': 0.6484848082586081, 'f1-score': 0.5607657921813426, 'support': 451989}}
[[  8687  67872   1218]
 [ 11716 279601   4584]
 [  2077  71414   4820]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93712306
{'0': {'precision': 0.36835057821059036, 'recall': 0.13227837034446582, 'f1-score': 0.194654401595317, 'support': 22876}, '1': {'precision': 0.7097445781714387, 'recall': 0.936206344431398, 'f1-score': 0.8073963419992216, 'support': 103051}, '2': {'precision': 0.3824203821656051, 'recall': 0.06778053736735154, 'f1-score': 0.11515151515151514, 'support': 22145}, 'accuracy': 0.682127613593387, 'macro avg': {'precision': 0.48683851284921137, 'recall': 0.37875508404773844, 'f1-score': 0.37240075291535124, 'support': 148072}, 'weighted avg': {'precision': 0.6080486230708555, 'recall': 0.682127613593387, 'f1-score': 0.6092032580993473, 'support': 148072}}
[[ 3026 19534   316]
 [ 4466 96477  2108]
 [  723 19921  1501]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/WBA
Evaluating performance on  test set...
5183/5183 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0542152
{'0': {'precision': 0.4689771481575175, 'recall': 0.1462878305653608, 'f1-score': 0.22301171677640283, 'support': 380182}, '1': {'precision': 0.43811056958854416, 'recall': 0.898653714973703, 'f1-score': 0.5890487881472972, 'support': 561471}, '2': {'precision': 0.5197333521943629, 'recall': 0.07630938101988151, 'f1-score': 0.13307948639006104, 'support': 385182}, 'accuracy': 0.44434839298028767, 'macro avg': {'precision': 0.4756070233134748, 'recall': 0.3737503088529818, 'f1-score': 0.31504666377125373, 'support': 1326835}, 'weighted avg': {'precision': 0.4706500671320849, 'recall': 0.44434839298028767, 'f1-score': 0.35179858487606525, 'support': 1326835}}
[[ 55616 313978  10588]
 [ 40330 504568  16573]
 [ 22644 333145  29393]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0363526
{'0': {'precision': 0.4529171376402052, 'recall': 0.15329906413702446, 'f1-score': 0.22906604319815888, 'support': 101938}, '1': {'precision': 0.4823779051412196, 'recall': 0.8941702774182657, 'f1-score': 0.6266805488182424, 'support': 177710}, '2': {'precision': 0.48104514172401724, 'recall': 0.08132758807694962, 'f1-score': 0.13913278172785776, 'support': 101417}, 'accuracy': 0.47965045333473294, 'macro avg': {'precision': 0.4721133948351473, 'recall': 0.3762656432107467, 'f1-score': 0.33162645791475304, 'support': 381065}, 'weighted avg': {'precision': 0.4741422062840671, 'recall': 0.47965045333473294, 'f1-score': 0.3905589964087962, 'support': 381065}}
[[ 15627  83331   2980]
 [ 12889 158903   5918]
 [  5987  87182   8248]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0204036
{'0': {'precision': 0.42536157024793386, 'recall': 0.15022803283672848, 'f1-score': 0.2220374780928414, 'support': 32890}, '1': {'precision': 0.5208398457851412, 'recall': 0.8930278261646344, 'f1-score': 0.6579462625664313, 'support': 67167}, '2': {'precision': 0.45821470440462236, 'recall': 0.08368507983116168, 'f1-score': 0.14152334152334153, 'support': 32694}, 'accuracy': 0.5096684770736191, 'macro avg': {'precision': 0.4681387068125658, 'recall': 0.3756469796108415, 'f1-score': 0.3405023607275381, 'support': 132751}, 'weighted avg': {'precision': 0.4817610678119927, 'recall': 0.5096684770736191, 'f1-score': 0.4227618127173217, 'support': 132751}}
[[ 4941 27005   944]
 [ 4894 59982  2291]
 [ 1781 28177  2736]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
7324/7324 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0809264
{'0': {'precision': 0.4793000621482778, 'recall': 0.1388614953095034, 'f1-score': 0.21533633895179052, 'support': 605373}, '1': {'precision': 0.37425077993343575, 'recall': 0.885766984502738, 'f1-score': 0.526181446239807, 'support': 680959}, '2': {'precision': 0.5235400168876515, 'recall': 0.07798167476532585, 'f1-score': 0.13574415649542093, 'support': 588369}, 'accuracy': 0.391057560645671, 'macro avg': {'precision': 0.45903028632312165, 'recall': 0.3675367181925224, 'f1-score': 0.2924206472290061, 'support': 1874701}, 'weighted avg': {'precision': 0.4550269454018281, 'recall': 0.391057560645671, 'f1-score': 0.3032667345797166, 'support': 1874701}}
[[ 84063 503589  17721]
 [ 53753 603171  24035]
 [ 37571 504916  45882]]
Evaluating performance on  train set...
2046/2046 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0617188
{'0': {'precision': 0.45376621851699644, 'recall': 0.15093541289659032, 'f1-score': 0.22652292632411916, 'support': 153622}, '1': {'precision': 0.4250787988917679, 'recall': 0.8779747562738629, 'f1-score': 0.5728213600656619, 'support': 215816}, '2': {'precision': 0.4835663295657347, 'recall': 0.08428378868785318, 'f1-score': 0.14354774623636923, 'support': 154312}, 'accuracy': 0.4308811455847255, 'macro avg': {'precision': 0.45413711565816633, 'recall': 0.37106465261943544, 'f1-score': 0.31429734420871674, 'support': 523750}, 'weighted avg': {'precision': 0.4507252840679551, 'recall': 0.4308811455847255, 'f1-score': 0.3447714738881553, 'support': 523750}}
[[ 23187 125266   5169]
 [ 17614 189481   8721]
 [ 10298 131008  13006]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0634139
{'0': {'precision': 0.44994707815720575, 'recall': 0.1464020300888164, 'f1-score': 0.2209214863035243, 'support': 55170}, '1': {'precision': 0.42565069506063297, 'recall': 0.8785755166931638, 'f1-score': 0.5734684305122596, 'support': 78625}, '2': {'precision': 0.45267885787616297, 'recall': 0.0758670131732234, 'f1-score': 0.12995425659288368, 'support': 55795}, 'accuracy': 0.42928424494962814, 'macro avg': {'precision': 0.44275887703133393, 'recall': 0.3669481866517345, 'f1-score': 0.30811472446955585, 'support': 189590}, 'weighted avg': {'precision': 0.4406750518290829, 'recall': 0.42928424494962814, 'f1-score': 0.3403554591222733, 'support': 189590}}
[[ 8077 45220  1873]
 [ 6302 69078  3245]
 [ 3572 47990  4233]]
testing model on single stock: results/universal/W6/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
29350/29350 - 203s - 203s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084563
{'0': {'precision': 0.4681060327767837, 'recall': 0.08505702478911766, 'f1-score': 0.14395649127052182, 'support': 2322148}, '1': {'precision': 0.38917709860260613, 'recall': 0.9322043730092276, 'f1-score': 0.5491110644223806, 'support': 2896175}, '2': {'precision': 0.48264075806022716, 'recall': 0.03242376287321204, 'f1-score': 0.060765317183686975, 'support': 2295076}, 'accuracy': 0.39552764334757146, 'macro avg': {'precision': 0.44664129647987233, 'recall': 0.3498950535571858, 'f1-score': 0.2512776242921964, 'support': 7513399}, 'weighted avg': {'precision': 0.44212129447561344, 'recall': 0.39552764334757146, 'f1-score': 0.274718677444791, 'support': 7513399}}
[[ 197515 2096694   27939]
 [ 144519 2699827   51829]
 [  79911 2140750   74415]]
Evaluating performance on  train set...
5452/5452 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0984284
{'0': {'precision': 0.5010064679616214, 'recall': 0.10550301778394604, 'f1-score': 0.17430129467554906, 'support': 464745}, '1': {'precision': 0.33802114984347975, 'recall': 0.9147061282859967, 'f1-score': 0.4936270210604507, 'support': 466411}, '2': {'precision': 0.518903831514844, 'recall': 0.039638867411703645, 'f1-score': 0.07365152285178057, 'support': 464317}, 'accuracy': 0.35404912886168344, 'macro avg': {'precision': 0.4526438164399817, 'recall': 0.3532826711605488, 'f1-score': 0.2471932795292601, 'support': 1395473}, 'weighted avg': {'precision': 0.4524866506266684, 'recall': 0.35404912886168344, 'f1-score': 0.24754071332787098, 'support': 1395473}}
[[ 49032 408750   6963]
 [ 29681 426629  10101]
 [ 19154 426758  18405]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0759209
{'0': {'precision': 0.4784550320882501, 'recall': 0.10408677973080784, 'f1-score': 0.17097774795102538, 'support': 155428}, '1': {'precision': 0.3904719374631966, 'recall': 0.9174866395428384, 'f1-score': 0.5478044825531758, 'support': 194417}, '2': {'precision': 0.523752792256143, 'recall': 0.04561105455299999, 'f1-score': 0.08391441540856681, 'support': 154217}, 'accuracy': 0.39992500922505564, 'macro avg': {'precision': 0.4642265872691966, 'recall': 0.3557281579422154, 'f1-score': 0.26756554863758936, 'support': 504062}, 'weighted avg': {'precision': 0.45837868309168406, 'recall': 0.39992500922505564, 'f1-score': 0.2896831399592425, 'support': 504062}}
[[ 16178 137009   2241]
 [ 11887 178375   4155]
 [  5748 141435   7034]]
training model: results/universal/W6/deepOF_L1/h30
Epoch 1/50
9426/9426 - 148s - loss: 3.1013 - accuracy30: 0.4653 - val_loss: 3.2065 - val_accuracy30: 0.4290 - 148s/epoch - 16ms/step
Epoch 2/50
9426/9426 - 130s - loss: 3.0871 - accuracy30: 0.4690 - val_loss: 3.2171 - val_accuracy30: 0.4349 - 130s/epoch - 14ms/step
Epoch 3/50
9426/9426 - 130s - loss: 3.0757 - accuracy30: 0.4726 - val_loss: 3.2093 - val_accuracy30: 0.4370 - 130s/epoch - 14ms/step
Epoch 4/50
9426/9426 - 132s - loss: 3.0674 - accuracy30: 0.4752 - val_loss: 3.2147 - val_accuracy30: 0.4369 - 132s/epoch - 14ms/step
Epoch 5/50
9426/9426 - 131s - loss: 3.0596 - accuracy30: 0.4769 - val_loss: 3.2485 - val_accuracy30: 0.4363 - 131s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 127s - loss: 3.0519 - accuracy30: 0.4787 - val_loss: 3.2929 - val_accuracy30: 0.4365 - 127s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 131s - loss: 3.0440 - accuracy30: 0.4807 - val_loss: 3.3447 - val_accuracy30: 0.4366 - 131s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 132s - loss: 3.0371 - accuracy30: 0.4820 - val_loss: 3.3413 - val_accuracy30: 0.4380 - 132s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 130s - loss: 3.0314 - accuracy30: 0.4829 - val_loss: 3.3278 - val_accuracy30: 0.4381 - 130s/epoch - 14ms/step
Epoch 10/50
9426/9426 - 131s - loss: 3.0250 - accuracy30: 0.4840 - val_loss: 3.3544 - val_accuracy30: 0.4388 - 131s/epoch - 14ms/step
Epoch 11/50
9426/9426 - 131s - loss: 3.0201 - accuracy30: 0.4848 - val_loss: 3.3464 - val_accuracy30: 0.4390 - 131s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 217s - 217s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.068083
{'0': {'precision': 0.4176129920222695, 'recall': 0.1891358974628905, 'f1-score': 0.2603568276995642, 'support': 3134709}, '1': {'precision': 0.43184270748928927, 'recall': 0.7831060240035851, 'f1-score': 0.5566961253440577, 'support': 4569984}, '2': {'precision': 0.4143291111456938, 'recall': 0.14791559553243494, 'f1-score': 0.21800378551762625, 'support': 3113911}, 'accuracy': 0.4281757609392117, 'macro avg': {'precision': 0.42126160355241754, 'recall': 0.3733858389996369, 'f1-score': 0.34501891285374936, 'support': 10818604}, 'weighted avg': {'precision': 0.4226786972855894, 'recall': 0.4281757609392117, 'f1-score': 0.3733457350366635, 'support': 10818604}}
[[ 592886 2327334  214489]
 [ 554620 3578782  436582]
 [ 272196 2381119  460596]]
Evaluating performance on  train set...
9426/9426 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0705432
{'0': {'precision': 0.43059458367127357, 'recall': 0.21668549346833663, 'f1-score': 0.2882943663581305, 'support': 727686}, '1': {'precision': 0.4056312221820298, 'recall': 0.7529938636873139, 'f1-score': 0.5272418575226632, 'support': 959045}, '2': {'precision': 0.4300823932820681, 'recall': 0.15750442133876622, 'f1-score': 0.2305697704452265, 'support': 725459}, 'accuracy': 0.4121138882094694, 'macro avg': {'precision': 0.42210273304512386, 'recall': 0.3757279261648056, 'f1-score': 0.3487019981086734, 'support': 2412190}, 'weighted avg': {'precision': 0.42051554340205166, 'recall': 0.4121138882094694, 'f1-score': 0.36593525245645186, 'support': 2412190}}
[[157679 517841  52166]
 [137642 722155  99248]
 [ 70868 540328 114263]]
Evaluating performance on  val set...
3323/3323 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.064195
{'0': {'precision': 0.4125491550434448, 'recall': 0.21421409998288243, 'f1-score': 0.28200072431692885, 'support': 245362}, '1': {'precision': 0.433202189259935, 'recall': 0.7550496741387558, 'f1-score': 0.5505384538617167, 'support': 361657}, '2': {'precision': 0.4244961910421957, 'recall': 0.1614812622544486, 'f1-score': 0.2339618371527943, 'support': 243279}, 'accuracy': 0.42916012974274903, 'macro avg': {'precision': 0.42341584511519176, 'recall': 0.3769150121253622, 'f1-score': 0.3555003384438133, 'support': 850298}, 'weighted avg': {'precision': 0.42475167388551344, 'recall': 0.42916012974274903, 'f1-score': 0.3824733788728326, 'support': 850298}}
[[ 52560 176216  16586]
 [ 51914 273069  36674]
 [ 22929 181065  39285]]
testing model out of sample: results/universal/W6/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 96s - 96s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0711542
{'0': {'precision': 0.418651633589706, 'recall': 0.22147146536782938, 'f1-score': 0.28969237610936016, 'support': 1353005}, '1': {'precision': 0.411470420004529, 'recall': 0.7460186678345949, 'f1-score': 0.5303974228529126, 'support': 1787781}, '2': {'precision': 0.4347284273044239, 'recall': 0.17074948747779567, 'f1-score': 0.24519360439747076, 'support': 1344332}, 'accuracy': 0.41535451241193655, 'macro avg': {'precision': 0.42161682696621966, 'recall': 0.37941320689340663, 'f1-score': 0.3550944677865812, 'support': 4485118}, 'weighted avg': {'precision': 0.4206079056529099, 'recall': 0.41535451241193655, 'f1-score': 0.37230041148306653, 'support': 4485118}}
[[ 299652  943692  109661]
 [ 265251 1333718  188812]
 [ 150852  963936  229544]]
Evaluating performance on  train set...
5152/5152 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0655488
{'0': {'precision': 0.42560494250900976, 'recall': 0.20218064767234534, 'f1-score': 0.2741352597920095, 'support': 380254}, '1': {'precision': 0.4456299462127009, 'recall': 0.788109186535639, 'f1-score': 0.5693343837173263, 'support': 559373}, '2': {'precision': 0.42255860557072344, 'recall': 0.16580427090397196, 'f1-score': 0.23815921878227517, 'support': 378983}, 'accuracy': 0.440284845405389, 'macro avg': {'precision': 0.431264498097478, 'recall': 0.3853647017039854, 'f1-score': 0.3605429540972036, 'support': 1318610}, 'weighted avg': {'precision': 0.4332242814226099, 'recall': 0.440284845405389, 'f1-score': 0.3890229912649121, 'support': 1318610}}
[[ 76880 272746  30628]
 [ 63285 440847  55241]
 [ 40472 275674  62837]]
Evaluating performance on  val set...
1795/1795 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0638299
{'0': {'precision': 0.4154844385791268, 'recall': 0.20338539864184144, 'f1-score': 0.2730896323833127, 'support': 130029}, '1': {'precision': 0.45259126152984486, 'recall': 0.7790699426057877, 'f1-score': 0.5725604524360879, 'support': 199149}, '2': {'precision': 0.4022162038449802, 'recall': 0.1625845148059918, 'f1-score': 0.23156530857622856, 'support': 129711}, 'accuracy': 0.4416885129083504, 'macro avg': {'precision': 0.42343063465131725, 'recall': 0.3816799520178737, 'f1-score': 0.3590717977985431, 'support': 458889}, 'weighted avg': {'precision': 0.42783764532021595, 'recall': 0.4416885129083504, 'f1-score': 0.3913168131990425, 'support': 458889}}
[[ 26446  93210  10373]
 [ 23028 155151  20970]
 [ 14177  94445  21089]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1210628
{'0': {'precision': 0.41053649655800195, 'recall': 0.07639697630592669, 'f1-score': 0.12882148690987316, 'support': 94454}, '1': {'precision': 0.2830528278220229, 'recall': 0.8670131578947369, 'f1-score': 0.4267764270031153, 'support': 76000}, '2': {'precision': 0.4160746218162486, 'recall': 0.08556973600508906, 'f1-score': 0.1419467596600137, 'support': 100608}, 'accuracy': 0.30147346363562577, 'macro avg': {'precision': 0.36988798206542445, 'recall': 0.3429932900685842, 'f1-score': 0.23251489119100074, 'support': 271062}, 'weighted avg': {'precision': 0.3768483399076683, 'recall': 0.30147346363562577, 'f1-score': 0.21723330002986982, 'support': 271062}}
[[ 7216 80627  6611]
 [ 4636 65893  5471]
 [ 5725 86274  8609]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1110471
{'0': {'precision': 0.41569767441860467, 'recall': 0.0539622641509434, 'f1-score': 0.09552438209752839, 'support': 18550}, '1': {'precision': 0.33557571643111356, 'recall': 0.9142985258673841, 'f1-score': 0.49095560571858543, 'support': 17841}, '2': {'precision': 0.38103331067301155, 'recall': 0.0638091985428051, 'f1-score': 0.10931253047294004, 'support': 17568}, 'accuracy': 0.34162975592579553, 'macro avg': {'precision': 0.37743556717424326, 'recall': 0.34402332952037756, 'f1-score': 0.23193083942968462, 'support': 53959}, 'weighted avg': {'precision': 0.37792011377557183, 'recall': 0.34162975592579553, 'f1-score': 0.23075888702316658, 'support': 53959}}
[[ 1001 16538  1011]
 [  719 16312   810]
 [  688 15759  1121]]
Evaluating performance on  val set...
81/81 - 1s - 574ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.112277
{'0': {'precision': 0.41306347746090155, 'recall': 0.0625522429646141, 'f1-score': 0.10865093768905022, 'support': 7178}, '1': {'precision': 0.31411056257798514, 'recall': 0.8985102420856611, 'f1-score': 0.46549021184226397, 'support': 6444}, '2': {'precision': 0.40949820788530467, 'recall': 0.06515540347875677, 'f1-score': 0.11242312423124232, 'support': 7014}, 'accuracy': 0.3244814886605931, 'macro avg': {'precision': 0.37889074930806377, 'recall': 0.3420726295096774, 'f1-score': 0.2288547579208522, 'support': 20636}, 'weighted avg': {'precision': 0.380951663916186, 'recall': 0.3244814886605931, 'f1-score': 0.22136320746275853, 'support': 20636}}
[[ 449 6368  361]
 [ 356 5790  298]
 [ 282 6275  457]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0060976
{'0': {'precision': 0.3827980445240831, 'recall': 0.1828109013115059, 'f1-score': 0.24744889929683414, 'support': 107510}, '1': {'precision': 0.6358351247377513, 'recall': 0.86020054609617, 'f1-score': 0.7311934229772225, 'support': 343163}, '2': {'precision': 0.45291809147866796, 'recall': 0.18189443026074453, 'f1-score': 0.259551522325245, 'support': 108497}, 'accuracy': 0.5983475508342723, 'macro avg': {'precision': 0.49051708691350077, 'recall': 0.4083019592228068, 'f1-score': 0.4127312815331005, 'support': 559170}, 'weighted avg': {'precision': 0.551692617358453, 'recall': 0.5983475508342723, 'f1-score': 0.5466715333266401, 'support': 559170}}
[[ 19654  84137   3719]
 [ 27855 295189  20119]
 [  3834  84928  19735]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99314225
{'0': {'precision': 0.3405568206861089, 'recall': 0.21263128927211852, 'f1-score': 0.26180257510729615, 'support': 21803}, '1': {'precision': 0.7060839378699542, 'recall': 0.8550624656412026, 'f1-score': 0.7734647711538836, 'support': 92771}, '2': {'precision': 0.38136332783865023, 'recall': 0.18126929990321242, 'f1-score': 0.2457357075913777, 'support': 21697}, 'accuracy': 0.6449941660367944, 'macro avg': {'precision': 0.47600136213157107, 'recall': 0.4163210182721779, 'f1-score': 0.4270010179508525, 'support': 136271}, 'weighted avg': {'precision': 0.5958987127537624, 'recall': 0.6449941660367944, 'f1-score': 0.607575415733292, 'support': 136271}}
[[ 4636 16284   883]
 [ 7949 79325  5497]
 [ 1028 16736  3933]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98832256
{'0': {'precision': 0.3607250755287009, 'recall': 0.2328090471857533, 'f1-score': 0.2829830936956866, 'support': 7693}, '1': {'precision': 0.7169505069170454, 'recall': 0.8641644594269203, 'f1-score': 0.7837041080933534, 'support': 33224}, '2': {'precision': 0.3865203761755486, 'recall': 0.16927512355848434, 'f1-score': 0.23544013748329196, 'support': 7284}, 'accuracy': 0.6583888301072592, 'macro avg': {'precision': 0.48806531954043164, 'recall': 0.4220828767237193, 'f1-score': 0.43404244642411066, 'support': 48201}, 'weighted avg': {'precision': 0.6101623631857619, 'recall': 0.6583888301072592, 'f1-score': 0.6209356691463411, 'support': 48201}}
[[ 1791  5593   309]
 [ 2865 28711  1648]
 [  309  5742  1233]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
1214/1214 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1013558
{'0': {'precision': 0.4911697818207661, 'recall': 0.23886464768652524, 'f1-score': 0.32141798289723805, 'support': 115735}, '1': {'precision': 0.2661685809627404, 'recall': 0.7137965984376545, 'f1-score': 0.3877489357702069, 'support': 80904}, '2': {'precision': 0.48787522700566177, 'recall': 0.16017114850113542, 'f1-score': 0.2411664917457111, 'support': 114053}, 'accuracy': 0.33364875825576457, 'macro avg': {'precision': 0.4150711965963894, 'recall': 0.3709441315417717, 'f1-score': 0.316777803471052, 'support': 310692}, 'weighted avg': {'precision': 0.43137020212594035, 'recall': 0.33364875825576457, 'f1-score': 0.30923072378187483, 'support': 310692}}
[[27645 78153  9937]
 [13916 57749  9239]
 [14723 81062 18268]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885371
{'0': {'precision': 0.4603921568627451, 'recall': 0.21221501683349528, 'f1-score': 0.29051765470096047, 'support': 44257}, '1': {'precision': 0.3484333710834277, 'recall': 0.7679755934083713, 'f1-score': 0.47937330034407893, 'support': 43267}, '2': {'precision': 0.4611739931560937, 'recall': 0.1613408232802284, 'f1-score': 0.23905034793286942, 'support': 43436}, 'accuracy': 0.3789554062309102, 'macro avg': {'precision': 0.4233331737007555, 'recall': 0.3805104778406983, 'f1-score': 0.33631376765930293, 'support': 130960}, 'weighted avg': {'precision': 0.42366215577022953, 'recall': 0.3789554062309102, 'f1-score': 0.3358420536262965, 'support': 130960}}
[[ 9392 30974  3891]
 [ 5742 33228  4297]
 [ 5266 31162  7008]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0948964
{'0': {'precision': 0.46137985725614594, 'recall': 0.19901484572757747, 'f1-score': 0.27808048943695635, 'support': 14617}, '1': {'precision': 0.3241767016961063, 'recall': 0.7483409526618493, 'f1-score': 0.452383605607435, 'support': 13562}, '2': {'precision': 0.43783881460065055, 'recall': 0.1618894902117993, 'f1-score': 0.2363787132335008, 'support': 14967}, 'accuracy': 0.3588049877161266, 'macro avg': {'precision': 0.40779845785096763, 'recall': 0.36974842953374204, 'f1-score': 0.3222809360926307, 'support': 43146}, 'weighted avg': {'precision': 0.4100868525481763, 'recall': 0.3588049877161266, 'f1-score': 0.318402845554949, 'support': 43146}}
[[ 2909 10340  1368]
 [ 1670 10149  1743]
 [ 1726 10818  2423]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1095/1095 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1046429
{'0': {'precision': 0.4799612915407855, 'recall': 0.20146229826525455, 'f1-score': 0.2838002861030669, 'support': 100937}, '1': {'precision': 0.26920672261783657, 'recall': 0.6780771643245119, 'f1-score': 0.385402799743616, 'support': 74931}, '2': {'precision': 0.4497754185381789, 'recall': 0.21138788669686037, 'f1-score': 0.2876054205070629, 'support': 104216}, 'accuracy': 0.3326644863683752, 'macro avg': {'precision': 0.39964781089893364, 'recall': 0.363642449762209, 'f1-score': 0.3189361687845819, 'support': 280084}, 'weighted avg': {'precision': 0.4123462134042081, 'recall': 0.3326644863683752, 'f1-score': 0.3123978990929086, 'support': 280084}}
[[20335 67505 13097]
 [10269 50809 13853]
 [11764 70422 22030]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0982543
{'0': {'precision': 0.42502966339848874, 'recall': 0.1759975175195883, 'f1-score': 0.24892107380586642, 'support': 38671}, '1': {'precision': 0.33753950548429074, 'recall': 0.7687218840963218, 'f1-score': 0.4691007153584058, 'support': 37790}, '2': {'precision': 0.4233541566554541, 'recall': 0.13873287491470265, 'f1-score': 0.20898236735984824, 'support': 38102}, 'accuracy': 0.35912118223161055, 'macro avg': {'precision': 0.3953077751794112, 'recall': 0.36115075884353764, 'f1-score': 0.3090013855080401, 'support': 114563}, 'weighted avg': {'precision': 0.3956127205329855, 'recall': 0.35912118223161055, 'f1-score': 0.308266971357993, 'support': 114563}}
[[ 6806 28486  3379]
 [ 4919 29050  3821]
 [ 4288 28528  5286]]
Evaluating performance on  val set...
136/136 - 1s - 932ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.103181
{'0': {'precision': 0.42231989298681444, 'recall': 0.18366159727416273, 'f1-score': 0.255994439939766, 'support': 12033}, '1': {'precision': 0.31101468890569645, 'recall': 0.7345116104164708, 'f1-score': 0.4369931204206052, 'support': 10637}, '2': {'precision': 0.43290337180357547, 'recall': 0.1580599851276543, 'f1-score': 0.23157002784166564, 'support': 12103}, 'accuracy': 0.3432548241451701, 'macro avg': {'precision': 0.3887459845653621, 'recall': 0.35874439760609594, 'f1-score': 0.30818586273401233, 'support': 34773}, 'weighted avg': {'precision': 0.3919554834825556, 'recall': 0.3432548241451701, 'f1-score': 0.30286052295392574, 'support': 34773}}
[[2210 8594 1229]
 [1547 7813 1277]
 [1476 8714 1913]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
1722/1722 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1037374
{'0': {'precision': 0.45909343136574876, 'recall': 0.16750710204804717, 'f1-score': 0.24545593613973601, 'support': 158053}, '1': {'precision': 0.27743992529815725, 'recall': 0.7694495209840929, 'f1-score': 0.4078291521241961, 'support': 122021}, '2': {'precision': 0.4936037929954824, 'recall': 0.13732578397212544, 'f1-score': 0.2148719296708432, 'support': 160720}, 'accuracy': 0.32313280126317506, 'macro avg': {'precision': 0.4100457165531295, 'recall': 0.3580941356680885, 'f1-score': 0.28938567264492515, 'support': 440794}, 'weighted avg': {'precision': 0.42139092828552804, 'recall': 0.32313280126317506, 'f1-score': 0.2792528586658125, 'support': 440794}}
[[ 26475 120675  10903]
 [ 16392  93889  11740]
 [ 14801 123848  22071]]
Evaluating performance on  train set...
617/617 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.096799
{'0': {'precision': 0.43219430884629123, 'recall': 0.2064650677789364, 'f1-score': 0.27943855687562547, 'support': 52745}, '1': {'precision': 0.3367108202719581, 'recall': 0.7323474834044345, 'f1-score': 0.4613206239794658, 'support': 52273}, '2': {'precision': 0.4082157284507633, 'recall': 0.1469943703479805, 'f1-score': 0.21615389957635944, 'support': 52934}, 'accuracy': 0.3605715660453809, 'macro avg': {'precision': 0.3923736191896709, 'recall': 0.3619356405104504, 'f1-score': 0.31897102681048356, 'support': 157952}, 'weighted avg': {'precision': 0.3925589096560119, 'recall': 0.3605715660453809, 'f1-score': 0.31842262320108955, 'support': 157952}}
[[10890 37116  4739]
 [ 7450 38282  6541]
 [ 6857 38296  7781]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0923463
{'0': {'precision': 0.4186746987951807, 'recall': 0.203439443834614, 'f1-score': 0.2738241812361487, 'support': 19131}, '1': {'precision': 0.3507492815921343, 'recall': 0.7573069428776535, 'f1-score': 0.47944293853170805, 'support': 19502}, '2': {'precision': 0.43809996689837805, 'recall': 0.14070805868594513, 'f1-score': 0.2130039430272793, 'support': 18812}, 'accuracy': 0.3709287144224911, 'macro avg': {'precision': 0.4025079824285644, 'recall': 0.3671514817994042, 'f1-score': 0.32209035426504534, 'support': 57445}, 'weighted avg': {'precision': 0.4019760593533413, 'recall': 0.3709287144224911, 'f1-score': 0.32371236443038226, 'support': 57445}}
[[ 3892 13734  1505]
 [ 2843 14769  1890]
 [ 2561 13604  2647]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/EXC
Evaluating performance on  test set...
4450/4450 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0386134
{'0': {'precision': 0.4030774003129405, 'recall': 0.3091594239408826, 'f1-score': 0.349926239814659, 'support': 285804}, '1': {'precision': 0.5120447669833996, 'recall': 0.6612872692853763, 'f1-score': 0.5771745341363097, 'support': 570510}, '2': {'precision': 0.39633666826860064, 'recall': 0.2566247763452875, 'f1-score': 0.31153388822829964, 'support': 282802}, 'accuracy': 0.4724751473949975, 'macro avg': {'precision': 0.4371529451883136, 'recall': 0.40902382319051545, 'f1-score': 0.4128782207264228, 'support': 1139116}, 'weighted avg': {'precision': 0.4559786674846423, 'recall': 0.4724751473949975, 'f1-score': 0.4542088506989933, 'support': 1139116}}
[[ 88359 175989  21456]
 [104157 377271  89082]
 [ 26695 183533  72574]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0219823
{'0': {'precision': 0.36809137803979364, 'recall': 0.3496674833741687, 'f1-score': 0.35864297253634897, 'support': 82853}, '1': {'precision': 0.5969736520107676, 'recall': 0.6682616139710079, 'f1-score': 0.6306093213127821, 'support': 219025}, '2': {'precision': 0.37907831681218407, 'recall': 0.2784904750421992, 'f1-score': 0.3210909697508897, 'support': 82940}, 'accuracy': 0.5156593506540754, 'macro avg': {'precision': 0.44804778228758174, 'recall': 0.43213985746245864, 'f1-score': 0.4367810878666736, 'support': 384818}, 'weighted avg': {'precision': 0.5007312149452259, 'recall': 0.5156593506540754, 'f1-score': 0.5053431436035347, 'support': 384818}}
[[ 28971  47684   6198]
 [ 41023 146366  31636]
 [  8712  51130  23098]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.02269
{'0': {'precision': 0.36645216312606604, 'recall': 0.34184356127725746, 'f1-score': 0.35372036894984005, 'support': 27653}, '1': {'precision': 0.594375753563914, 'recall': 0.6750392675428587, 'f1-score': 0.6321446755548851, 'support': 74489}, '2': {'precision': 0.364616990604961, 'recall': 0.2585568754626529, 'f1-score': 0.3025615641628511, 'support': 28369}, 'accuracy': 0.5139107048448024, 'macro avg': {'precision': 0.4418149690983137, 'recall': 0.4251465680942563, 'f1-score': 0.4294755362225254, 'support': 130511}, 'weighted avg': {'precision': 0.49614037575851566, 'recall': 0.5139107048448024, 'f1-score': 0.5015103946312087, 'support': 130511}}
[[ 9453 16267  1933]
 [13357 50283 10849]
 [ 2986 18048  7335]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/AAL
Evaluating performance on  test set...
6203/6203 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0184892
{'0': {'precision': 0.3407771593255013, 'recall': 0.2929190505681253, 'f1-score': 0.31504093099021246, 'support': 311639}, '1': {'precision': 0.6350843765794052, 'recall': 0.7398124740791994, 'f1-score': 0.6834597717802479, 'support': 959654}, '2': {'precision': 0.358348466779817, 'recall': 0.22875707571009804, 'f1-score': 0.27925046320664315, 'support': 316576}, 'accuracy': 0.5502141549460314, 'macro avg': {'precision': 0.44473666756157454, 'recall': 0.42049620011914096, 'f1-score': 0.4259170553257012, 'support': 1587869}, 'weighted avg': {'precision': 0.5221496481739109, 'recall': 0.5502141549460314, 'f1-score': 0.5305651405506165, 'support': 1587869}}
[[ 91285 195567  24787]
 [144805 709964 104885]
 [ 31783 212374  72419]]
Evaluating performance on  train set...
1766/1766 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0204747
{'0': {'precision': 0.3649792055069554, 'recall': 0.1661371746888328, 'f1-score': 0.22833644859813082, 'support': 91912}, '1': {'precision': 0.6107898799809555, 'recall': 0.8283141186174362, 'f1-score': 0.7031123276561232, 'support': 267937}, '2': {'precision': 0.36508377500427425, 'recall': 0.1854026481441285, 'f1-score': 0.2459188667837503, 'support': 92140}, 'accuracy': 0.5625999747781473, 'macro avg': {'precision': 0.446950953497395, 'recall': 0.3932846471501325, 'f1-score': 0.39245588101266815, 'support': 451989}, 'weighted avg': {'precision': 0.510715959543056, 'recall': 0.5625999747781473, 'f1-score': 0.5133656610762758, 'support': 451989}}
[[ 15270  71064   5578]
 [ 21870 221936  24131]
 [  4698  70359  17083]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0091003
{'0': {'precision': 0.34830917874396133, 'recall': 0.1858863393613495, 'f1-score': 0.24240532167815373, 'support': 27151}, '1': {'precision': 0.6583440928252003, 'recall': 0.813675033025099, 'f1-score': 0.727814118803645, 'support': 94625}, '2': {'precision': 0.31753953460405265, 'recall': 0.20082902342561607, 'f1-score': 0.24604561231858735, 'support': 26296}, 'accuracy': 0.589726619482414, 'macro avg': {'precision': 0.4413976020577381, 'recall': 0.40013013193735486, 'f1-score': 0.4054216842667954, 'support': 148072}, 'weighted avg': {'precision': 0.5409717697985442, 'recall': 0.589726619482414, 'f1-score': 0.5532509407734618, 'support': 148072}}
[[ 5047 20388  1716]
 [ 7997 76994  9634]
 [ 1446 19569  5281]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/WBA
Evaluating performance on  test set...
5183/5183 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0772973
{'0': {'precision': 0.45333158375790705, 'recall': 0.23466158880058835, 'f1-score': 0.3092458295843706, 'support': 426951}, '1': {'precision': 0.3700536468582745, 'recall': 0.7579749337829106, 'f1-score': 0.49731255623698917, 'support': 467402}, '2': {'precision': 0.47720215281192535, 'recall': 0.1638079735110363, 'f1-score': 0.24389479790477142, 'support': 432482}, 'accuracy': 0.3959135838291875, 'macro avg': {'precision': 0.4335291278093689, 'recall': 0.38548149869817844, 'f1-score': 0.35015106124204376, 'support': 1326835}, 'weighted avg': {'precision': 0.4317760151927561, 'recall': 0.3959135838291875, 'f1-score': 0.3541946131844646, 'support': 1326835}}
[[100189 293418  33344]
 [ 68854 354279  44269]
 [ 51963 309675  70844]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0698224
{'0': {'precision': 0.4368008595083107, 'recall': 0.23750246986761508, 'f1-score': 0.3076991569047553, 'support': 116403}, '1': {'precision': 0.4096946400318624, 'recall': 0.7527121374865736, 'f1-score': 0.5305924469461973, 'support': 148960}, '2': {'precision': 0.4467978955007257, 'recall': 0.17028227688371853, 'f1-score': 0.24658631522296898, 'support': 115702}, 'accuracy': 0.4184902838098487, 'macro avg': {'precision': 0.4310977983469663, 'recall': 0.38683229474596903, 'f1-score': 0.36162597302464056, 'support': 381065}, 'weighted avg': {'precision': 0.42924029793792945, 'recall': 0.4184902838098487, 'f1-score': 0.3762735640959357, 'support': 381065}}
[[ 27646  79413   9344]
 [ 21786 112124  15050]
 [ 13860  82140  19702]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0611569
{'0': {'precision': 0.4120420070011669, 'recall': 0.2327568023623708, 'f1-score': 0.29747443263188045, 'support': 37928}, '1': {'precision': 0.4469481009474302, 'recall': 0.7477818691916536, 'f1-score': 0.5594899177413641, 'support': 57030}, '2': {'precision': 0.42834695160276554, 'recall': 0.18032439869817163, 'f1-score': 0.2538033256987506, 'support': 37793}, 'accuracy': 0.4390852046312269, 'macro avg': {'precision': 0.42911235318378754, 'recall': 0.38695435675073203, 'f1-score': 0.3702558920239984, 'support': 132751}, 'weighted avg': {'precision': 0.431679578914626, 'recall': 0.4390852046312269, 'f1-score': 0.39760385517084496, 'support': 132751}}
[[ 8828 26017  3083]
 [ 8372 42646  6012]
 [ 4225 26753  6815]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
7324/7324 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0958704
{'0': {'precision': 0.4651448200385259, 'recall': 0.21846791972950005, 'f1-score': 0.2973005483813904, 'support': 673124}, '1': {'precision': 0.30445900986273344, 'recall': 0.7403177701465035, 'f1-score': 0.43147286500873117, 'support': 549202}, '2': {'precision': 0.48535983040440306, 'recall': 0.1659980839241234, 'f1-score': 0.24738718940392512, 'support': 652375}, 'accuracy': 0.35308723897837574, 'macro avg': {'precision': 0.4183212201018875, 'recall': 0.3749279246000423, 'f1-score': 0.32538686759801555, 'support': 1874701}, 'weighted avg': {'precision': 0.42510579465115667, 'recall': 0.35308723897837574, 'f1-score': 0.31923763438787617, 'support': 1874701}}
[[147056 468558  57510]
 [ 85302 406584  57316]
 [ 83793 460289 108293]]
Evaluating performance on  train set...
2046/2046 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0844747
{'0': {'precision': 0.4441142082891703, 'recall': 0.23522194571445107, 'f1-score': 0.30755144585652294, 'support': 172790}, '1': {'precision': 0.355721413347923, 'recall': 0.7339642245373621, 'f1-score': 0.4791965356282475, 'support': 178055}, '2': {'precision': 0.4610023130300694, 'recall': 0.17290419594575054, 'f1-score': 0.2514857731698597, 'support': 172905}, 'accuracy': 0.38420238663484485, 'macro avg': {'precision': 0.4202793115557209, 'recall': 0.3806967887325212, 'f1-score': 0.34607791821821005, 'support': 523750}, 'weighted avg': {'precision': 0.41963928446475285, 'recall': 0.38420238663484485, 'f1-score': 0.34739532427832137, 'support': 523750}}
[[ 40644 116633  15513]
 [ 27928 130686  19441]
 [ 22945 120064  29896]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852605
{'0': {'precision': 0.4363630767336637, 'recall': 0.2288384555785124, 'f1-score': 0.300229773085842, 'support': 61952}, '1': {'precision': 0.35461040510709385, 'recall': 0.7313430540174726, 'f1-score': 0.47762978142076506, 'support': 65016}, '2': {'precision': 0.4507886846564985, 'recall': 0.16566063044936286, 'f1-score': 0.24228411280434403, 'support': 62622}, 'accuracy': 0.3802943193206393, 'macro avg': {'precision': 0.413920722165752, 'recall': 0.37528071334844926, 'f1-score': 0.3400478891036503, 'support': 189590}, 'weighted avg': {'precision': 0.41309248609528987, 'recall': 0.3802943193206393, 'f1-score': 0.3419258847149121, 'support': 189590}}
[[14177 42393  5382]
 [10210 47549  7257]
 [ 8102 44146 10374]]
testing model on single stock: results/universal/W6/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
29350/29350 - 142s - 142s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0741457
{'0': {'precision': 0.4112805012251845, 'recall': 0.16462111933687132, 'f1-score': 0.23512854993198892, 'support': 2213507}, '1': {'precision': 0.42106968578358844, 'recall': 0.8033117125426062, 'f1-score': 0.5525242556755608, 'support': 3113978}, '2': {'precision': 0.4004354791727352, 'recall': 0.12577759234809788, 'f1-score': 0.1914274395181364, 'support': 2185914}, 'accuracy': 0.41802970932330363, 'macro avg': {'precision': 0.41092855539383605, 'recall': 0.3645701414091918, 'f1-score': 0.32636008170856207, 'support': 7513399}, 'weighted avg': {'precision': 0.4121824924302372, 'recall': 0.41802970932330363, 'f1-score': 0.3539611017385375, 'support': 7513399}}
[[ 364390 1706350  142767]
 [ 343589 2501495  268894]
 [ 178010 1732965  274939]]
Evaluating performance on  train set...
5452/5452 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0893619
{'0': {'precision': 0.46008175994173195, 'recall': 0.19168041439793485, 'f1-score': 0.270616080142763, 'support': 467956}, '1': {'precision': 0.3344209545852268, 'recall': 0.7718713829997459, 'f1-score': 0.4666577828484103, 'support': 460499}, '2': {'precision': 0.4515409540692521, 'recall': 0.1330805236628995, 'f1-score': 0.20557338008136802, 'support': 467018}, 'accuracy': 0.36352906863837564, 'macro avg': {'precision': 0.4153478895320703, 'recall': 0.3655441070201934, 'f1-score': 0.31428241435751375, 'support': 1395473}, 'weighted avg': {'precision': 0.4157560114085686, 'recall': 0.36352906863837564, 'f1-score': 0.3135412362417884, 'support': 1395473}}
[[ 89698 346007  32251]
 [ 61813 355446  43240]
 [ 43450 361417  62151]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0803373
{'0': {'precision': 0.433194829841991, 'recall': 0.1882477898222486, 'f1-score': 0.2624473014877531, 'support': 160055}, '1': {'precision': 0.3722377033244767, 'recall': 0.7708949575095154, 'f1-score': 0.5020522609832673, 'support': 186277}, '2': {'precision': 0.4436943407066935, 'recall': 0.13708869587269384, 'f1-score': 0.2094602448853069, 'support': 157730}, 'accuracy': 0.38755748300804266, 'macro avg': {'precision': 0.41637562462438704, 'recall': 0.3654104810681526, 'f1-score': 0.32465326911877573, 'support': 504062}, 'weighted avg': {'precision': 0.41395350078403087, 'recall': 0.38755748300804266, 'f1-score': 0.33441314021799273, 'support': 504062}}
[[ 30130 119824  10101]
 [ 25667 143600  17010]
 [ 13756 122351  21623]]
training model: results/universal/W6/deepLOB_L2/h10
Epoch 1/50
9426/9426 - 391s - loss: 2.8249 - accuracy10: 0.5300 - val_loss: 3.5300 - val_accuracy10: 0.5153 - 391s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 385s - loss: 2.6685 - accuracy10: 0.5720 - val_loss: 3.3308 - val_accuracy10: 0.5363 - 385s/epoch - 41ms/step
Epoch 3/50
9426/9426 - 382s - loss: 2.6148 - accuracy10: 0.5836 - val_loss: 3.1508 - val_accuracy10: 0.5455 - 382s/epoch - 41ms/step
Epoch 4/50
9426/9426 - 384s - loss: 2.5901 - accuracy10: 0.5883 - val_loss: 3.1357 - val_accuracy10: 0.5469 - 384s/epoch - 41ms/step
Epoch 5/50
9426/9426 - 383s - loss: 2.5757 - accuracy10: 0.5909 - val_loss: 3.0543 - val_accuracy10: 0.5506 - 383s/epoch - 41ms/step
Epoch 6/50
9426/9426 - 385s - loss: 2.5652 - accuracy10: 0.5925 - val_loss: 3.0722 - val_accuracy10: 0.5553 - 385s/epoch - 41ms/step
Epoch 7/50
9426/9426 - 387s - loss: 2.5577 - accuracy10: 0.5940 - val_loss: 3.0500 - val_accuracy10: 0.5558 - 387s/epoch - 41ms/step
Epoch 8/50
9426/9426 - 384s - loss: 2.5508 - accuracy10: 0.5954 - val_loss: 3.0778 - val_accuracy10: 0.5574 - 384s/epoch - 41ms/step
Epoch 9/50
9426/9426 - 384s - loss: 2.5448 - accuracy10: 0.5965 - val_loss: 3.0690 - val_accuracy10: 0.5587 - 384s/epoch - 41ms/step
Epoch 10/50
9426/9426 - 384s - loss: 2.5401 - accuracy10: 0.5975 - val_loss: 3.0671 - val_accuracy10: 0.5602 - 384s/epoch - 41ms/step
Epoch 11/50
9426/9426 - 384s - loss: 2.5359 - accuracy10: 0.5980 - val_loss: 3.0678 - val_accuracy10: 0.5576 - 384s/epoch - 41ms/step
Epoch 12/50
9426/9426 - 384s - loss: 2.5318 - accuracy10: 0.5988 - val_loss: 3.0920 - val_accuracy10: 0.5591 - 384s/epoch - 41ms/step
Epoch 13/50
9426/9426 - 385s - loss: 2.5285 - accuracy10: 0.5994 - val_loss: 3.0970 - val_accuracy10: 0.5603 - 385s/epoch - 41ms/step
Epoch 14/50
9426/9426 - 385s - loss: 2.5250 - accuracy10: 0.6001 - val_loss: 3.0987 - val_accuracy10: 0.5600 - 385s/epoch - 41ms/step
Epoch 15/50
9426/9426 - 387s - loss: 2.5223 - accuracy10: 0.6007 - val_loss: 3.1321 - val_accuracy10: 0.5604 - 387s/epoch - 41ms/step
Epoch 16/50
9426/9426 - 386s - loss: 2.5194 - accuracy10: 0.6012 - val_loss: 3.0998 - val_accuracy10: 0.5623 - 386s/epoch - 41ms/step
Epoch 17/50
9426/9426 - 391s - loss: 2.5172 - accuracy10: 0.6017 - val_loss: 3.1150 - val_accuracy10: 0.5616 - 391s/epoch - 41ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 564s - 564s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0661603
{'0': {'precision': 0.4767477554669746, 'recall': 0.4083452485377085, 'f1-score': 0.4399033317744456, 'support': 3133951}, '1': {'precision': 0.5261527470670355, 'recall': 0.7247480047597619, 'f1-score': 0.6096857054067887, 'support': 4497704}, '2': {'precision': 0.4837568902348456, 'recall': 0.2943208824420908, 'f1-score': 0.36597820891737143, 'support': 3186974}, 'accuracy': 0.5062960380654518, 'macro avg': {'precision': 0.49555246425628524, 'recall': 0.475804711913187, 'f1-score': 0.4718557486995352, 'support': 10818629}, 'weighted avg': {'precision': 0.49935200214252484, 'recall': 0.5062960380654518, 'f1-score': 0.48871112586031207, 'support': 10818629}}
[[1279734 1382785  471432]
 [ 708451 3259702  529551]
 [ 696115 1552866  937993]]
Evaluating performance on  train set...
9426/9426 - 138s - 138s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9638631
{'0': {'precision': 0.47556490929546563, 'recall': 0.3939898878262845, 'f1-score': 0.43095102433482063, 'support': 646943}, '1': {'precision': 0.5893795545226087, 'recall': 0.7345343931339474, 'f1-score': 0.6539995355032346, 'support': 1121343}, '2': {'precision': 0.4692824137902222, 'recall': 0.34888719438806176, 'f1-score': 0.4002266109284546, 'support': 643913}, 'accuracy': 0.5402568361897173, 'macro avg': {'precision': 0.5114089592027655, 'recall': 0.49247049178276464, 'f1-score': 0.49505905692217, 'support': 2412199}, 'weighted avg': {'precision': 0.5267961199852439, 'recall': 0.5402568361897173, 'f1-score': 0.5264365284119674, 'support': 2412199}}
[[254889 281153 110901]
 [154516 823665 143162]
 [126566 292694 224653]]
Evaluating performance on  val set...
3323/3323 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9360118
{'0': {'precision': 0.4692841297228776, 'recall': 0.3172614088128169, 'f1-score': 0.37858137090588867, 'support': 210035}, '1': {'precision': 0.6048580213354376, 'recall': 0.7696336895488272, 'f1-score': 0.6773691058698481, 'support': 432229}, '2': {'precision': 0.45998522064814407, 'recall': 0.35007714973778703, 'f1-score': 0.39757510249313527, 'support': 208037}, 'accuracy': 0.5552422024671263, 'macro avg': {'precision': 0.5113757905688198, 'recall': 0.47899074936647706, 'f1-score': 0.4845085264229574, 'support': 850301}, 'weighted avg': {'precision': 0.5359245905133798, 'recall': 0.5552422024671263, 'f1-score': 0.5351096154145429, 'support': 850301}}
[[ 66636 110541  32858]
 [ 46929 332658  52642]
 [ 28430 106778  72829]]
testing model out of sample: results/universal/W6/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 243s - 243s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84497476
{'0': {'precision': 0.46326528473417794, 'recall': 0.4738733277653087, 'f1-score': 0.4685092667980286, 'support': 1026097}, '1': {'precision': 0.7016249339942107, 'recall': 0.7679255203348545, 'f1-score': 0.7332796106866621, 'support': 2434490}, '2': {'precision': 0.5058436260961258, 'recall': 0.3806634288413713, 'f1-score': 0.43441542420862045, 'support': 1024556}, 'accuracy': 0.6121896224936418, 'macro avg': {'precision': 0.5569112816081714, 'recall': 0.5408207589805115, 'f1-score': 0.5454014338977704, 'support': 4485143}, 'weighted avg': {'precision': 0.6023707887592422, 'recall': 0.6121896224936418, 'f1-score': 0.6044357475156793, 'support': 4485143}}
[[ 486240  387525  152332]
 [ 336315 1869507  228668]
 [ 227038  407507  390011]]
Evaluating performance on  train set...
5153/5153 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8285999
{'0': {'precision': 0.4667512945747835, 'recall': 0.4244681038275407, 'f1-score': 0.44460665313698705, 'support': 284125}, '1': {'precision': 0.711504502755951, 'recall': 0.79740441716154, 'f1-score': 0.7520093835205696, 'support': 749350}, '2': {'precision': 0.48376207976044644, 'recall': 0.37394262467559797, 'f1-score': 0.4218217782612996, 'support': 285140}, 'accuracy': 0.6254767312672767, 'macro avg': {'precision': 0.5540059590303936, 'recall': 0.5319383818882262, 'f1-score': 0.5394792716396187, 'support': 1318615}, 'weighted avg': {'precision': 0.6095194807689325, 'recall': 0.6254767312672767, 'f1-score': 0.6143721698275176, 'support': 1318615}}
[[120602 119515  44008]
 [ 82039 597535  69776]
 [ 55745 122769 106626]]
Evaluating performance on  val set...
1795/1795 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81528825
{'0': {'precision': 0.4621313035204567, 'recall': 0.44948638060277013, 'f1-score': 0.45572114407243497, 'support': 97251}, '1': {'precision': 0.7260809456330142, 'recall': 0.7938877929694881, 'f1-score': 0.758471914331309, 'support': 264618}, '2': {'precision': 0.47756495758416473, 'recall': 0.3690259010750028, 'f1-score': 0.4163376842350069, 'support': 97023}, 'accuracy': 0.6310722348613618, 'macro avg': {'precision': 0.5552590689125452, 'recall': 0.537466691549087, 'f1-score': 0.5435102475462502, 'support': 458892}, 'weighted avg': {'precision': 0.6175997924345452, 'recall': 0.6310722348613618, 'f1-score': 0.6219742099366382, 'support': 458892}}
[[ 43713  38405  15133]
 [ 30506 210077  24035]
 [ 20371  40848  35804]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1109291
{'0': {'precision': 0.4183483337662191, 'recall': 0.44763170613823106, 'f1-score': 0.4324949069831245, 'support': 82760}, '1': {'precision': 0.4515707852593994, 'recall': 0.5054229503633526, 'f1-score': 0.4769816772837723, 'support': 100591}, '2': {'precision': 0.44759534943584023, 'recall': 0.3568220165078207, 'f1-score': 0.39708708918252, 'support': 87716}, 'accuracy': 0.439692031859282, 'macro avg': {'precision': 0.43917148948715296, 'recall': 0.43662555766980143, 'f1-score': 0.43552122448313896, 'support': 271067}, 'weighted avg': {'precision': 0.4401411408752622, 'recall': 0.439692031859282, 'f1-score': 0.43754582267966685, 'support': 271067}}
[[37046 29223 16491]
 [27613 50841 22137]
 [23894 32523 31299]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0828435
{'0': {'precision': 0.3992903225806452, 'recall': 0.4045362441989673, 'f1-score': 0.4018961654599175, 'support': 15299}, '1': {'precision': 0.5312692544670363, 'recall': 0.5706485771012575, 'f1-score': 0.5502552648372687, 'support': 24176}, '2': {'precision': 0.3838763910015211, 'recall': 0.33105495719414524, 'f1-score': 0.35551436515291934, 'support': 14484}, 'accuracy': 0.4592375692655535, 'macro avg': {'precision': 0.43814532268306755, 'recall': 0.4354132594981233, 'f1-score': 0.43588859848336853, 'support': 53959}, 'weighted avg': {'precision': 0.4542851755670489, 'recall': 0.4592375692655535, 'f1-score': 0.45591747035623287, 'support': 53959}}
[[ 6189  6176  2934]
 [ 5618 13796  4762]
 [ 3693  5996  4795]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.07712
{'0': {'precision': 0.3911504424778761, 'recall': 0.42015209125475284, 'f1-score': 0.4051329055912007, 'support': 5786}, '1': {'precision': 0.5329682865617157, 'recall': 0.5168141592920354, 'f1-score': 0.5247669324946647, 'support': 9040}, '2': {'precision': 0.40611739745403114, 'recall': 0.3952848046807778, 'f1-score': 0.400627888724165, 'support': 5811}, 'accuracy': 0.45549256190337745, 'macro avg': {'precision': 0.44341204216454094, 'recall': 0.4440836850758554, 'f1-score': 0.44350924227001015, 'support': 20637}, 'weighted avg': {'precision': 0.4574879084799281, 'recall': 0.45549256190337745, 'f1-score': 0.45626984168622275, 'support': 20637}}
[[2431 2123 1232]
 [2241 4672 2127]
 [1543 1971 2297]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6430583
{'0': {'precision': 0.33766272587322704, 'recall': 0.675244713442427, 'f1-score': 0.4501990245554952, 'support': 66915}, '1': {'precision': 0.8861805330444888, 'recall': 0.7922881176221107, 'f1-score': 0.8366081858250202, 'support': 424410}, '2': {'precision': 0.5352367263382551, 'recall': 0.36222549742078114, 'f1-score': 0.43205470782645383, 'support': 67850}, 'accuracy': 0.7260982697724326, 'macro avg': {'precision': 0.5863599950853237, 'recall': 0.6099194428284397, 'f1-score': 0.5729539727356564, 'support': 559175}, 'weighted avg': {'precision': 0.777957514576419, 'recall': 0.7260982697724326, 'f1-score': 0.741279312916623, 'support': 559175}}
[[ 45184  16659   5072]
 [ 71886 336255  16269]
 [ 16744  26529  24577]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56638056
{'0': {'precision': 0.34415757253127494, 'recall': 0.5749647965611798, 'f1-score': 0.43058137921465234, 'support': 13493}, '1': {'precision': 0.905966976324296, 'recall': 0.8541618999679678, 'f1-score': 0.8793020604667375, 'support': 109265}, '2': {'precision': 0.4980867942137191, 'recall': 0.3948653447765611, 'f1-score': 0.44051009038009165, 'support': 13516}, 'accuracy': 0.7809633532441992, 'macro avg': {'precision': 0.58273711435643, 'recall': 0.6079973471019029, 'f1-score': 0.5834645100204938, 'support': 136274}, 'weighted avg': {'precision': 0.8098855313913976, 'recall': 0.7809633532441992, 'f1-score': 0.7913520449111254, 'support': 136274}}
[[ 7758  4331  1404]
 [11961 93330  3974]
 [ 2823  5356  5337]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5718186
{'0': {'precision': 0.3384084691328655, 'recall': 0.599831330381615, 'f1-score': 0.4326996197718631, 'support': 4743}, '1': {'precision': 0.9133074104120625, 'recall': 0.8368707064492976, 'f1-score': 0.8734199226848941, 'support': 39012}, '2': {'precision': 0.4535573122529644, 'recall': 0.4128626040026985, 'f1-score': 0.4322542672160094, 'support': 4447}, 'accuracy': 0.7744284469524086, 'macro avg': {'precision': 0.568424397265964, 'recall': 0.616521546944537, 'f1-score': 0.5794579365575888, 'support': 48202}, 'weighted avg': {'precision': 0.8143228378839364, 'recall': 0.7744284469524086, 'f1-score': 0.789352870143783, 'support': 48202}}
[[ 2845  1409   489]
 [ 4641 32648  1723]
 [  921  1690  1836]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730413
{'0': {'precision': 0.46492868972583967, 'recall': 0.4270797990521742, 'f1-score': 0.4452012595837897, 'support': 91367}, '1': {'precision': 0.5231307858112907, 'recall': 0.6560827545256381, 'f1-score': 0.5821118486040587, 'support': 127993}, '2': {'precision': 0.46396763578178307, 'recall': 0.336512037837897, 'f1-score': 0.39009283996370164, 'support': 91337}, 'accuracy': 0.49479396325036934, 'macro avg': {'precision': 0.48400903710630444, 'recall': 0.4732248638052364, 'f1-score': 0.47246864938384997, 'support': 310697}, 'weighted avg': {'precision': 0.48862277463871895, 'recall': 0.49479396325036934, 'f1-score': 0.4854017098540894, 'support': 310697}}
[[39021 36314 16032]
 [24541 83974 19478]
 [20367 40234 30736]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0380192
{'0': {'precision': 0.4132308467741935, 'recall': 0.46413609601449274, 'f1-score': 0.4372066979522184, 'support': 35328}, '1': {'precision': 0.5741131351869607, 'recall': 0.5895635050869708, 'f1-score': 0.5817357512953368, 'support': 60940}, '2': {'precision': 0.44006968641114985, 'recall': 0.3640608785887236, 'f1-score': 0.39847299343765774, 'support': 34692}, 'accuracy': 0.49599114233353697, 'macro avg': {'precision': 0.4758045561241014, 'recall': 0.4725868265633957, 'f1-score': 0.47247181422840434, 'support': 130960}, 'weighted avg': {'precision': 0.4952044240539684, 'recall': 0.49599114233353697, 'f1-score': 0.49420006106851727, 'support': 130960}}
[[16397 13135  5796]
 [14738 35928 10274]
 [ 8545 13517 12630]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0265931
{'0': {'precision': 0.411253857747793, 'recall': 0.49503239740820737, 'f1-score': 0.4492708169985887, 'support': 11575}, '1': {'precision': 0.581528503858601, 'recall': 0.5880575974222133, 'f1-score': 0.5847748266453051, 'support': 19862}, '2': {'precision': 0.45678606638186003, 'recall': 0.3561058923996584, 'f1-score': 0.40021114256922113, 'support': 11710}, 'accuracy': 0.5001506477854776, 'macro avg': {'precision': 0.48318947599608464, 'recall': 0.4797319624100263, 'f1-score': 0.4780855954043717, 'support': 43147}, 'weighted avg': {'precision': 0.5019942842932723, 'recall': 0.5001506477854776, 'f1-score': 0.498333135399293, 'support': 43147}}
[[ 5730  4079  1766]
 [ 4989 11680  3193]
 [ 3214  4326  4170]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2460983
{'0': {'precision': 0.3939549865012964, 'recall': 0.5871812749003984, 'f1-score': 0.4715410087824543, 'support': 100400}, '1': {'precision': 0.2703932805097544, 'recall': 0.1797329446224508, 'f1-score': 0.21593312186095687, 'support': 72719}, '2': {'precision': 0.43737516441759633, 'recall': 0.33572029540992804, 'f1-score': 0.3798643945884767, 'support': 106970}, 'accuracy': 0.3853596535386966, 'macro avg': {'precision': 0.36724114380954903, 'recall': 0.3675448383109257, 'f1-score': 0.3557795084106293, 'support': 280089}, 'weighted avg': {'precision': 0.3784576721965849, 'recall': 0.3853596535386966, 'f1-score': 0.3701653840725437, 'support': 280089}}
[[58953 16332 25115]
 [38568 13070 21081]
 [52123 18935 35912]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1905557
{'0': {'precision': 0.3916067198400452, 'recall': 0.452091226133427, 'f1-score': 0.4196809130080354, 'support': 39857}, '1': {'precision': 0.35948061867481385, 'recall': 0.25410322859302453, 'f1-score': 0.29774312419933896, 'support': 37044}, '2': {'precision': 0.3787235046971628, 'recall': 0.42601492180654754, 'f1-score': 0.4009796448787315, 'support': 37663}, 'accuracy': 0.37949966830767085, 'macro avg': {'precision': 0.3766036144040073, 'recall': 0.3774031255109997, 'f1-score': 0.3728012273620353, 'support': 114564}, 'weighted avg': {'precision': 0.37698345403672817, 'recall': 0.37949966830767085, 'f1-score': 0.37410455996359454, 'support': 114564}}
[[18019  8968 12870]
 [14180  9413 13451]
 [13814  7804 16045]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2046437
{'0': {'precision': 0.401427161618462, 'recall': 0.42876834509040784, 'f1-score': 0.41464753391358894, 'support': 12333}, '1': {'precision': 0.3342615152569904, 'recall': 0.27824995170948424, 'f1-score': 0.30369472408158965, 'support': 10354}, '2': {'precision': 0.39419151066943997, 'recall': 0.42338242594737713, 'f1-score': 0.40826584752862327, 'support': 12086}, 'accuracy': 0.38207804906105314, 'macro avg': {'precision': 0.37662672918163076, 'recall': 0.3768002409157564, 'f1-score': 0.3755360351746006, 'support': 34773}, 'weighted avg': {'precision': 0.37891305067616315, 'recall': 0.38207804906105314, 'f1-score': 0.3793921790506431, 'support': 34773}}
[[5288 2993 4052]
 [3661 2881 3812]
 [4224 2745 5117]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
1722/1722 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1673361
{'0': {'precision': 0.48430230554502535, 'recall': 0.4371535403433022, 'f1-score': 0.45952167629112745, 'support': 160733}, '1': {'precision': 0.35073184486426906, 'recall': 0.5898959240512878, 'f1-score': 0.43990894710444073, 'support': 115973}, '2': {'precision': 0.517459939001977, 'recall': 0.31742365609745693, 'f1-score': 0.3934776696682178, 'support': 164093}, 'accuracy': 0.4327686768799385, 'macro avg': {'precision': 0.45083136313709044, 'recall': 0.4481577068306823, 'f1-score': 0.430969431021262, 'support': 440799}, 'weighted avg': {'precision': 0.4615036342919649, 'recall': 0.4327686768799385, 'f1-score': 0.4297759050422346, 'support': 440799}}
[[70265 61495 28973]
 [27962 68412 19599]
 [46858 65148 52087]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1452323
{'0': {'precision': 0.4615927613424886, 'recall': 0.4171547874499797, 'f1-score': 0.4382501675501127, 'support': 51729}, '1': {'precision': 0.43544289662488483, 'recall': 0.5818846526896964, 'f1-score': 0.4981238124131764, 'support': 53612}, '2': {'precision': 0.46344977503665136, 'recall': 0.34849464000608227, 'f1-score': 0.39783453034478267, 'support': 52612}, 'accuracy': 0.45019721056263573, 'macro avg': {'precision': 0.4534951443346749, 'recall': 0.44917802671525275, 'f1-score': 0.44473617010269056, 'support': 157953}, 'weighted avg': {'precision': 0.45333558773538474, 'recall': 0.45019721056263573, 'f1-score': 0.4451104256253106, 'support': 157953}}
[[21579 19707 10443]
 [11632 31196 10784]
 [13538 20739 18335]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1244344
{'0': {'precision': 0.460751936999873, 'recall': 0.3915695164075993, 'f1-score': 0.4233529789344692, 'support': 18528}, '1': {'precision': 0.45422522682796657, 'recall': 0.611955323330617, 'f1-score': 0.5214230282236655, 'support': 20861}, '2': {'precision': 0.45185730047811695, 'recall': 0.34020047626959077, 'f1-score': 0.388158726146847, 'support': 18057}, 'accuracy': 0.4554538174981722, 'macro avg': {'precision': 0.4556114881019855, 'recall': 0.44790843866926905, 'f1-score': 0.44431157776832725, 'support': 57446}, 'weighted avg': {'precision': 0.45558596978597665, 'recall': 0.4554538174981722, 'f1-score': 0.44790362955654606, 'support': 57446}}
[[ 7255  7726  3547]
 [ 4190 12766  3905]
 [ 4301  7613  6143]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
4450/4450 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67880726
{'0': {'precision': 0.42194150587201584, 'recall': 0.6892267850921212, 'f1-score': 0.5234371606064556, 'support': 192301}, '1': {'precision': 0.8667267094730468, 'recall': 0.738317274877379, 'f1-score': 0.7973853781465785, 'support': 755988}, '2': {'precision': 0.507565504173595, 'recall': 0.4814653726838266, 'f1-score': 0.494171052383885, 'support': 190832}, 'accuracy': 0.6870007663803933, 'macro avg': {'precision': 0.5987445731728859, 'recall': 0.6363364775511089, 'f1-score': 0.6049978637123063, 'support': 1139121}, 'weighted avg': {'precision': 0.7314714639219712, 'recall': 0.6870007663803933, 'f1-score': 0.7003425596969761, 'support': 1139121}}
[[132539  38579  21183]
 [129872 558159  67957]
 [ 51706  47247  91879]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6683634
{'0': {'precision': 0.37459067357512954, 'recall': 0.6843749408356842, 'f1-score': 0.4841714718153752, 'support': 52819}, '1': {'precision': 0.8975025092991675, 'recall': 0.7091697947992851, 'f1-score': 0.7922980544669078, 'support': 278654}, '2': {'precision': 0.4456837594293933, 'recall': 0.5692647996100926, 'f1-score': 0.49995061078002045, 'support': 53346}, 'accuracy': 0.686372034644859, 'macro avg': {'precision': 0.5725923141012301, 'recall': 0.6542698450816873, 'f1-score': 0.5921400456874345, 'support': 384819}, 'weighted avg': {'precision': 0.7630954158821041, 'recall': 0.686372034644859, 'f1-score': 0.7094785868730727, 'support': 384819}}
[[ 36148  10935   5736]
 [ 49007 197613  32034]
 [ 11345  11633  30368]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6403325
{'0': {'precision': 0.39414158937746047, 'recall': 0.6735845829294714, 'f1-score': 0.49729547702734, 'support': 17539}, '1': {'precision': 0.8868825473417021, 'recall': 0.7428117369706154, 'f1-score': 0.8084789543921145, 'support': 95016}, '2': {'precision': 0.4447890818858561, 'recall': 0.5191022499443083, 'f1-score': 0.47908100328947373, 'support': 17956}, 'accuracy': 0.7027300380810813, 'macro avg': {'precision': 0.5752710728683396, 'recall': 0.6451661899481317, 'f1-score': 0.5949518115696427, 'support': 130511}, 'weighted avg': {'precision': 0.7598402755986307, 'recall': 0.7027300380810813, 'f1-score': 0.7213405781671235, 'support': 130511}}
[[11814  4071  1654]
 [14456 70579  9981]
 [ 3704  4931  9321]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
6203/6203 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60893065
{'0': {'precision': 0.40552059019673226, 'recall': 0.5765424539016899, 'f1-score': 0.47614017773028877, 'support': 202502}, '1': {'precision': 0.8744013896312133, 'recall': 0.8311259792117536, 'f1-score': 0.8522146574222148, 'support': 1181052}, '2': {'precision': 0.4921632745109094, 'recall': 0.4272464761158966, 'f1-score': 0.45741308391626717, 'support': 204320}, 'accuracy': 0.7466895987968819, 'macro avg': {'precision': 0.5906950847796183, 'recall': 0.6116383030764467, 'f1-score': 0.5952559730229235, 'support': 1587874}, 'weighted avg': {'precision': 0.7654203298440628, 'recall': 0.7466895987968819, 'f1-score': 0.7534526071680323, 'support': 1587874}}
[[116751  62588  23163]
 [132537 981603  66912]
 [ 38616  78409  87295]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59439355
{'0': {'precision': 0.48790784505070217, 'recall': 0.3914390264658327, 'f1-score': 0.4343818760446866, 'support': 58755}, '1': {'precision': 0.838004381832551, 'recall': 0.8928362743952319, 'f1-score': 0.8645518089838411, 'support': 333723}, '2': {'precision': 0.48281738142573133, 'recall': 0.39991262413254247, 'f1-score': 0.4374718538329335, 'support': 59513}, 'accuracy': 0.7627563380686784, 'macro avg': {'precision': 0.6029098694363282, 'recall': 0.5613959749978691, 'f1-score': 0.5788018462871537, 'support': 451991}, 'weighted avg': {'precision': 0.7457278409858779, 'recall': 0.7627563380686784, 'f1-score': 0.7524003639755644, 'support': 451991}}
[[ 22999  28081   7675]
 [ 17944 297960  17819]
 [  6195  29518  23800]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5507746
{'0': {'precision': 0.5089351646728696, 'recall': 0.3986580286904211, 'f1-score': 0.4470969834576711, 'support': 17288}, '1': {'precision': 0.860830814092373, 'recall': 0.9151524173986146, 'f1-score': 0.8871608543583823, 'support': 114193}, '2': {'precision': 0.48739623791028863, 'recall': 0.3857513109517208, 'f1-score': 0.4306574254760783, 'support': 16591}, 'accuracy': 0.7955319033983468, 'macro avg': {'precision': 0.6190540722251772, 'recall': 0.5665205856802521, 'f1-score': 0.588305087764044, 'support': 148072}, 'weighted avg': {'precision': 0.77790342038795, 'recall': 0.7955319033983468, 'f1-score': 0.7846318644837417, 'support': 148072}}
[[  6892   8302   2094]
 [  5052 104504   4637]
 [  1598   8593   6400]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
5183/5183 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82933795
{'0': {'precision': 0.5154987804039431, 'recall': 0.41799396483862505, 'f1-score': 0.46165410537717383, 'support': 304880}, '1': {'precision': 0.6836147741299762, 'recall': 0.8127552552446714, 'f1-score': 0.7426124412144695, 'support': 709339}, '2': {'precision': 0.49958525189599134, 'recall': 0.3776009928955508, 'f1-score': 0.4301113663649166, 'support': 312621}, 'accuracy': 0.6195193090350004, 'macro avg': {'precision': 0.5662329354766369, 'recall': 0.5361167376596158, 'f1-score': 0.5447926376521867, 'support': 1326840}, 'weighted avg': {'precision': 0.6016254631071675, 'recall': 0.6195193090350004, 'f1-score': 0.6044247351228407, 'support': 1326840}}
[[127438 126766  50676]
 [ 65254 576519  67566]
 [ 54521 140054 118046]]
Evaluating performance on  train set...
1489/1489 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78653985
{'0': {'precision': 0.47429385530227947, 'recall': 0.47711921437651106, 'f1-score': 0.47570233968265796, 'support': 80242}, '1': {'precision': 0.7264911022476104, 'recall': 0.7843206505743692, 'f1-score': 0.7542991016412575, 'support': 220851}, '2': {'precision': 0.5109503197881, 'recall': 0.3955785630329857, 'f1-score': 0.4459228980195926, 'support': 79974}, 'accuracy': 0.6380479023373843, 'macro avg': {'precision': 0.5705784257793299, 'recall': 0.552339475994622, 'f1-score': 0.558641446447836, 'support': 381067}, 'weighted avg': {'precision': 0.6281502067468083, 'recall': 0.6380479023373843, 'f1-score': 0.630915969852042, 'support': 381067}}
[[ 38285  32468   9489]
 [ 26842 173218  20791]
 [ 15593  32745  31636]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7508026
{'0': {'precision': 0.46614167237312637, 'recall': 0.4761775221514068, 'f1-score': 0.4711061555615364, 'support': 25732}, '1': {'precision': 0.7555173170421868, 'recall': 0.8016198796730832, 'f1-score': 0.7778861131258843, 'support': 81611}, '2': {'precision': 0.508125786163522, 'recall': 0.39745759376598844, 'f1-score': 0.4460295026941083, 'support': 25409}, 'accuracy': 0.661180245872002, 'macro avg': {'precision': 0.5765949251929451, 'recall': 0.5584183318634928, 'f1-score': 0.5650072571271764, 'support': 132752}, 'weighted avg': {'precision': 0.6520749169523934, 'recall': 0.661180245872002, 'f1-score': 0.6549033597021559, 'support': 132752}}
[[12253 10505  2974]
 [ 9388 65421  6802]
 [ 4645 10665 10099]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
7324/7324 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8927447
{'0': {'precision': 0.5029906983544973, 'recall': 0.45751173949072604, 'f1-score': 0.479174524258529, 'support': 488735}, '1': {'precision': 0.6377218823314653, 'recall': 0.7533758544848005, 'f1-score': 0.690741211504939, 'support': 908881}, '2': {'precision': 0.527785103100014, 'recall': 0.3943260181517114, 'f1-score': 0.45139765338196125, 'support': 477090}, 'accuracy': 0.5848703743413634, 'macro avg': {'precision': 0.5561658945953255, 'recall': 0.5350712040424127, 'f1-score': 0.5404377963818098, 'support': 1874706}, 'weighted avg': {'precision': 0.5746199435717256, 'recall': 0.5848703743413634, 'f1-score': 0.5746758321674506, 'support': 1874706}}
[[223602 197517  67616]
 [123447 684729 100705]
 [ 97496 191465 188129]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8566292
{'0': {'precision': 0.48877643463062437, 'recall': 0.43420261108491714, 'f1-score': 0.459876104747022, 'support': 123014}, '1': {'precision': 0.6748213778891123, 'recall': 0.7899703501998924, 'f1-score': 0.7278698670819421, 'support': 276899}, '2': {'precision': 0.5216274564074177, 'recall': 0.3804617285346296, 'f1-score': 0.4399992529089856, 'support': 123839}, 'accuracy': 0.6095843070766317, 'macro avg': {'precision': 0.5617417563090514, 'recall': 0.534878229939813, 'f1-score': 0.5425817415793165, 'support': 523752}, 'weighted avg': {'precision': 0.5949028005999158, 'recall': 0.6095843070766317, 'f1-score': 0.5968601646494309, 'support': 523752}}
[[ 53413  52467  17134]
 [ 32082 218742  26075]
 [ 23784  52939  47116]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85165095
{'0': {'precision': 0.4739848558650312, 'recall': 0.48572854744293686, 'f1-score': 0.4797848498431197, 'support': 44074}, '1': {'precision': 0.6894707892624954, 'recall': 0.7596014384772805, 'f1-score': 0.722839059759977, 'support': 100662}, '2': {'precision': 0.503057602243236, 'recall': 0.3759753868105409, 'f1-score': 0.43033032649884534, 'support': 44854}, 'accuracy': 0.6051743235402711, 'macro avg': {'precision': 0.5555044157902542, 'recall': 0.5404351242435861, 'f1-score': 0.5443180787006473, 'support': 189590}, 'weighted avg': {'precision': 0.595274343674006, 'recall': 0.6051743235402711, 'f1-score': 0.5971332842994023, 'support': 189590}}
[[21408 16142  6524]
 [14064 76463 10135]
 [ 9694 18296 16864]]
testing model on single stock: results/universal/W6/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
29350/29350 - 398s - 398s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1915091
{'0': {'precision': 0.49771720020760135, 'recall': 0.37086401655425993, 'f1-score': 0.42502738123967404, 'support': 2469455}, '1': {'precision': 0.4149066114277463, 'recall': 0.7004565233854834, 'f1-score': 0.5211290090182092, 'support': 2535248}, '2': {'precision': 0.47895913555569114, 'recall': 0.2660010100845019, 'f1-score': 0.3420414221958879, 'support': 2508701}, 'accuracy': 0.44706500542230926, 'macro avg': {'precision': 0.46386098239701296, 'recall': 0.4457738500080817, 'f1-score': 0.42939927081792373, 'support': 7513404}, 'weighted avg': {'precision': 0.46351116588104824, 'recall': 0.44706500542230926, 'f1-score': 0.4297462145651774, 'support': 7513404}}
[[ 915832 1184157  369466]
 [ 402935 1775831  356482]
 [ 521298 1320086  667317]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1140214
{'0': {'precision': 0.5320419804573733, 'recall': 0.33518626284384145, 'f1-score': 0.4112715758119112, 'support': 460532}, '1': {'precision': 0.43215484890381195, 'recall': 0.7361906424213875, 'f1-score': 0.5446134866821871, 'support': 475529}, '2': {'precision': 0.4786188444083181, 'recall': 0.3076027286935096, 'f1-score': 0.3745113784230012, 'support': 459414}, 'accuracy': 0.46275354270051416, 'macro avg': {'precision': 0.48093855792316775, 'recall': 0.4596598779862462, 'f1-score': 0.4434654803056999, 'support': 1395475}, 'weighted avg': {'precision': 0.48041614380291936, 'recall': 0.46275354270051416, 'f1-score': 0.4446077489508085, 'support': 1395475}}
[[154364 224895  81273]
 [ 52779 350080  72670]
 [ 82992 235105 141317]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0778099
{'0': {'precision': 0.5395140804463353, 'recall': 0.23127438405216183, 'f1-score': 0.32376142713520845, 'support': 149688}, '1': {'precision': 0.47460756340379673, 'recall': 0.7815366861265735, 'f1-score': 0.5905742472679973, 'support': 206236}, '2': {'precision': 0.4632604425299391, 'recall': 0.3136176158877811, 'f1-score': 0.3740268731936271, 'support': 148139}, 'accuracy': 0.48061254247980906, 'macro avg': {'precision': 0.49246069546002375, 'recall': 0.4421428953555055, 'f1-score': 0.4294541825322777, 'support': 504063}, 'weighted avg': {'precision': 0.490547585948461, 'recall': 0.48061254247980906, 'f1-score': 0.44769966836012265, 'support': 504063}}
[[ 34619  91600  23469]
 [ 14696 161181  30359]
 [ 14852  86828  46459]]
training model: results/universal/W6/deepLOB_L2/h20
Epoch 1/50
9426/9426 - 386s - loss: 2.9100 - accuracy20: 0.5047 - val_loss: 3.3365 - val_accuracy20: 0.4847 - 386s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 386s - loss: 2.7835 - accuracy20: 0.5414 - val_loss: 3.1719 - val_accuracy20: 0.5045 - 386s/epoch - 41ms/step
Epoch 3/50
9426/9426 - 393s - loss: 2.7438 - accuracy20: 0.5503 - val_loss: 3.1114 - val_accuracy20: 0.5111 - 393s/epoch - 42ms/step
Epoch 4/50
9426/9426 - 399s - loss: 2.7233 - accuracy20: 0.5548 - val_loss: 3.0815 - val_accuracy20: 0.5118 - 399s/epoch - 42ms/step
Epoch 5/50
9426/9426 - 400s - loss: 2.7107 - accuracy20: 0.5574 - val_loss: 3.0741 - val_accuracy20: 0.5142 - 400s/epoch - 42ms/step
Epoch 6/50
9426/9426 - 405s - loss: 2.7024 - accuracy20: 0.5587 - val_loss: 3.0645 - val_accuracy20: 0.5142 - 405s/epoch - 43ms/step
Epoch 7/50
9426/9426 - 400s - loss: 2.6956 - accuracy20: 0.5599 - val_loss: 3.0727 - val_accuracy20: 0.5157 - 400s/epoch - 42ms/step
Epoch 8/50
9426/9426 - 399s - loss: 2.6903 - accuracy20: 0.5613 - val_loss: 3.0631 - val_accuracy20: 0.5188 - 399s/epoch - 42ms/step
Epoch 9/50
9426/9426 - 397s - loss: 2.6862 - accuracy20: 0.5622 - val_loss: 3.0787 - val_accuracy20: 0.5187 - 397s/epoch - 42ms/step
Epoch 10/50
9426/9426 - 396s - loss: 2.6823 - accuracy20: 0.5628 - val_loss: 3.0637 - val_accuracy20: 0.5191 - 396s/epoch - 42ms/step
Epoch 11/50
9426/9426 - 388s - loss: 2.6790 - accuracy20: 0.5635 - val_loss: 3.0584 - val_accuracy20: 0.5218 - 388s/epoch - 41ms/step
Epoch 12/50
9426/9426 - 384s - loss: 2.6762 - accuracy20: 0.5641 - val_loss: 3.0676 - val_accuracy20: 0.5211 - 384s/epoch - 41ms/step
Epoch 13/50
9426/9426 - 384s - loss: 2.6734 - accuracy20: 0.5648 - val_loss: 3.0888 - val_accuracy20: 0.5216 - 384s/epoch - 41ms/step
Epoch 14/50
9426/9426 - 384s - loss: 2.6707 - accuracy20: 0.5651 - val_loss: 3.0941 - val_accuracy20: 0.5216 - 384s/epoch - 41ms/step
Epoch 15/50
9426/9426 - 384s - loss: 2.6685 - accuracy20: 0.5658 - val_loss: 3.0840 - val_accuracy20: 0.5209 - 384s/epoch - 41ms/step
Epoch 16/50
9426/9426 - 384s - loss: 2.6662 - accuracy20: 0.5663 - val_loss: 3.0881 - val_accuracy20: 0.5222 - 384s/epoch - 41ms/step
Epoch 17/50
9426/9426 - 386s - loss: 2.6644 - accuracy20: 0.5665 - val_loss: 3.0798 - val_accuracy20: 0.5219 - 386s/epoch - 41ms/step
Epoch 18/50
9426/9426 - 388s - loss: 2.6623 - accuracy20: 0.5672 - val_loss: 3.0874 - val_accuracy20: 0.5218 - 388s/epoch - 41ms/step
Epoch 19/50
9426/9426 - 393s - loss: 2.6605 - accuracy20: 0.5675 - val_loss: 3.0898 - val_accuracy20: 0.5230 - 393s/epoch - 42ms/step
Epoch 20/50
9426/9426 - 388s - loss: 2.6589 - accuracy20: 0.5678 - val_loss: 3.0768 - val_accuracy20: 0.5237 - 388s/epoch - 41ms/step
Epoch 21/50
9426/9426 - 386s - loss: 2.6570 - accuracy20: 0.5684 - val_loss: 3.1165 - val_accuracy20: 0.5219 - 386s/epoch - 41ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 571s - 571s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0517489
{'0': {'precision': 0.4394539582303956, 'recall': 0.46436978481854907, 'f1-score': 0.4515684426096284, 'support': 3141070}, '1': {'precision': 0.5396507255146619, 'recall': 0.6154837868714101, 'f1-score': 0.5750780858266958, 'support': 4556986}, '2': {'precision': 0.44031598645424835, 'recall': 0.32483201001867285, 'f1-score': 0.3738589856670952, 'support': 3120573}, 'accuracy': 0.48777261887804824, 'macro avg': {'precision': 0.4731402233997686, 'recall': 0.4682285272362107, 'f1-score': 0.46683517136780645, 'support': 10818629}, 'weighted avg': {'precision': 0.481907145945794, 'recall': 0.48777261887804824, 'f1-score': 0.48117789514059506, 'support': 10818629}}
[[1458618 1114550  567902]
 [1031675 2804751  720560]
 [ 828867 1278044 1013662]]
Evaluating performance on  train set...
9426/9426 - 131s - 131s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9921784
{'0': {'precision': 0.4729338941145822, 'recall': 0.4157155304639624, 'f1-score': 0.4424826241450037, 'support': 694345}, '1': {'precision': 0.5679284126248481, 'recall': 0.6595694267441395, 'f1-score': 0.6103281089916092, 'support': 1025563}, '2': {'precision': 0.45347995782663075, 'recall': 0.40010775815372435, 'f1-score': 0.4251252587094036, 'support': 692291}, 'accuracy': 0.5149123268851368, 'macro avg': {'precision': 0.498114088188687, 'recall': 0.4917975717872755, 'f1-score': 0.49264533061533883, 'support': 2412199}, 'weighted avg': {'precision': 0.5077382690356487, 'recall': 0.5149123268851368, 'f1-score': 0.50886179563996, 'support': 2412199}}
[[288650 252407 153288]
 [168600 676430 180533]
 [153089 262211 276991]]
Evaluating performance on  val set...
3323/3323 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98226887
{'0': {'precision': 0.47694386881701056, 'recall': 0.344726685450575, 'f1-score': 0.4001975686954419, 'support': 230339}, '1': {'precision': 0.5728338888818477, 'recall': 0.6931708676170246, 'f1-score': 0.6272832099853463, 'support': 391221}, '2': {'precision': 0.44286393232260823, 'recall': 0.407373404855273, 'f1-score': 0.4243779474485997, 'support': 228741}, 'accuracy': 0.5218975398123723, 'macro avg': {'precision': 0.4975472300071555, 'recall': 0.4817569859742909, 'f1-score': 0.48395290870979596, 'support': 850301}, 'weighted avg': {'precision': 0.5118946812776799, 'recall': 0.5218975398123723, 'f1-score': 0.5111838143748586, 'support': 850301}}
[[ 79404 101726  49209]
 [ 52020 271183  68018]
 [ 35061 100497  93183]]
testing model out of sample: results/universal/W6/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 238s - 238s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90816253
{'0': {'precision': 0.49650502515147465, 'recall': 0.46739472524705733, 'f1-score': 0.481510301706185, 'support': 1239186}, '1': {'precision': 0.6380699831444414, 'recall': 0.7157740240859864, 'f1-score': 0.6746920871896882, 'support': 2011294}, '2': {'precision': 0.509317740699673, 'recall': 0.4382491416686173, 'f1-score': 0.47111832811285803, 'support': 1234663}, 'accuracy': 0.5707534854518573, 'macro avg': {'precision': 0.5479642496651963, 'recall': 0.540472630333887, 'f1-score': 0.5424402390029104, 'support': 4485143}, 'weighted avg': {'precision': 0.5635147361993479, 'recall': 0.5707534854518573, 'f1-score': 0.5652790423594036, 'support': 4485143}}
[[ 579189  405503  254494]
 [ 304864 1439632  266798]
 [ 282479  411094  541090]]
Evaluating performance on  train set...
5153/5153 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.901995
{'0': {'precision': 0.5053756198889074, 'recall': 0.41276063531033047, 'f1-score': 0.4543969607004158, 'support': 345406}, '1': {'precision': 0.644422745982338, 'recall': 0.7602137655738148, 'f1-score': 0.6975456473104309, 'support': 628539}, '2': {'precision': 0.4882080587868435, 'recall': 0.41789827951373776, 'f1-score': 0.45032530772140783, 'support': 344670}, 'accuracy': 0.5797226635522879, 'macro avg': {'precision': 0.5460021415526963, 'recall': 0.530290893465961, 'f1-score': 0.5340893052440848, 'support': 1318615}, 'weighted avg': {'precision': 0.567167271206836, 'recall': 0.5797226635522879, 'f1-score': 0.5692334032563534, 'support': 1318615}}
[[142570 131329  71507]
 [ 71227 477824  79488]
 [ 68310 132323 144037]]
Evaluating performance on  val set...
1795/1795 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8826083
{'0': {'precision': 0.500878903435888, 'recall': 0.44142794257077067, 'f1-score': 0.46927801651405043, 'support': 118128}, '1': {'precision': 0.6677487344140879, 'recall': 0.760087534417349, 'f1-score': 0.7109323389949941, 'support': 222998}, '2': {'precision': 0.4897176820208024, 'recall': 0.41979009221676883, 'f1-score': 0.45206569249620515, 'support': 117766}, 'accuracy': 0.5907272299364557, 'macro avg': {'precision': 0.5527817732902595, 'recall': 0.5404351897349629, 'f1-score': 0.54409201600175, 'support': 458892}, 'weighted avg': {'precision': 0.5791047739398577, 'recall': 0.5907272299364557, 'f1-score': 0.5822924165347959, 'support': 458892}}
[[ 52145  41211  24772]
 [ 26759 169498  26741]
 [ 25203  43126  49437]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1191853
{'0': {'precision': 0.45352966055849, 'recall': 0.4768252326783868, 'f1-score': 0.46488579249572765, 'support': 96700}, '1': {'precision': 0.34367993761401455, 'recall': 0.34361773223435066, 'f1-score': 0.3436488321091656, 'support': 71824}, '2': {'precision': 0.4697045773601533, 'recall': 0.4470124728162819, 'f1-score': 0.4580776687386325, 'support': 102543}, 'accuracy': 0.4302515614220838, 'macro avg': {'precision': 0.42230472517755263, 'recall': 0.42248514590967307, 'f1-score': 0.42220409778117524, 'support': 271067}, 'weighted avg': {'precision': 0.4305419047373423, 'recall': 0.4302515614220838, 'f1-score': 0.43018644186570537, 'support': 271067}}
[[46109 22186 28405]
 [23798 24680 23346]
 [31760 24945 45838]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1176718
{'0': {'precision': 0.43931297709923667, 'recall': 0.4398405939513047, 'f1-score': 0.43957662720279345, 'support': 18318}, '1': {'precision': 0.425508889461479, 'recall': 0.4484088193765613, 'f1-score': 0.4366588222850948, 'support': 18414}, '2': {'precision': 0.4090292339953127, 'recall': 0.3849770708771115, 'f1-score': 0.3966388564935259, 'support': 17227}, 'accuracy': 0.42524880001482607, 'macro avg': {'precision': 0.42461703351867613, 'recall': 0.42440882806832586, 'f1-score': 0.4242914353271381, 'support': 53959}, 'weighted avg': {'precision': 0.42493379082423216, 'recall': 0.42524880001482607, 'f1-score': 0.42487254751704956, 'support': 53959}}
[[8057 5639 4622]
 [5197 8257 4960]
 [5086 5509 6632]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1066498
{'0': {'precision': 0.4402471562982727, 'recall': 0.4472820659152518, 'f1-score': 0.44373673036093425, 'support': 7009}, '1': {'precision': 0.4234875444839858, 'recall': 0.3723737147966026, 'f1-score': 0.39628924833491913, 'support': 6711}, '2': {'precision': 0.42678923177938277, 'recall': 0.46985687436750034, 'f1-score': 0.44728874208642994, 'support': 6917}, 'accuracy': 0.4304889276542133, 'macro avg': {'precision': 0.4301746441872137, 'recall': 0.42983755169311827, 'f1-score': 0.42910490692742775, 'support': 20637}, 'weighted avg': {'precision': 0.43028629867444945, 'recall': 0.4304889276542133, 'f1-score': 0.42949770401159404, 'support': 20637}}
[[3135 1760 2114]
 [1961 2499 2251]
 [2025 1642 3250]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7161713
{'0': {'precision': 0.41872175114863097, 'recall': 0.6245598395364386, 'f1-score': 0.5013350030188509, 'support': 89740}, '1': {'precision': 0.8473060102165385, 'recall': 0.7548797034956469, 'f1-score': 0.7984269292732435, 'support': 378814}, '2': {'precision': 0.5092681149519516, 'recall': 0.4935721300802242, 'f1-score': 0.5012972894216275, 'support': 90621}, 'accuracy': 0.6916171144990387, 'macro avg': {'precision': 0.5917652921057069, 'recall': 0.62433722437077, 'f1-score': 0.600353073904574, 'support': 559175}, 'weighted avg': {'precision': 0.7237409661506805, 'recall': 0.6916171144990387, 'f1-score': 0.7025942927013967, 'support': 559175}}
[[ 56048  23268  10424]
 [ 60179 285959  32676]
 [ 17628  28265  44728]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6431405
{'0': {'precision': 0.43731593493724796, 'recall': 0.5323185528347673, 'f1-score': 0.48016317190259433, 'support': 18132}, '1': {'precision': 0.8719638188411909, 'recall': 0.8269611469935412, 'f1-score': 0.848866447037573, 'support': 100018}, '2': {'precision': 0.48632862976172014, 'recall': 0.5191458839108365, 'f1-score': 0.5022017026500493, 'support': 18124}, 'accuracy': 0.7468189089628249, 'macro avg': {'precision': 0.5985361278467197, 'recall': 0.6261418612463817, 'f1-score': 0.6104104405300722, 'support': 136274}, 'weighted avg': {'precision': 0.7628433145790232, 'recall': 0.7468189089628249, 'f1-score': 0.7537031758924763, 'support': 136274}}
[[ 9652  6147  2333]
 [ 9702 82711  7605]
 [ 2717  5998  9409]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6548674
{'0': {'precision': 0.4411532385466035, 'recall': 0.527882797731569, 'f1-score': 0.4806368330464716, 'support': 6348}, '1': {'precision': 0.8802261613691932, 'recall': 0.8040255715920829, 'f1-score': 0.8404020950963658, 'support': 35821}, '2': {'precision': 0.42328176515343646, 'recall': 0.5532902370296702, 'f1-score': 0.4796321574825778, 'support': 6033}, 'accuracy': 0.736276503049666, 'macro avg': {'precision': 0.5815537216897444, 'recall': 0.6283995354511074, 'f1-score': 0.6002236952084717, 'support': 48202}, 'weighted avg': {'precision': 0.7652105923793701, 'recall': 0.736276503049666, 'f1-score': 0.7478682807916333, 'support': 48202}}
[[ 3351  2039   958]
 [ 3430 28801  3590]
 [  815  1880  3338]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1237397
{'0': {'precision': 0.5075030291732687, 'recall': 0.39452233452885554, 'f1-score': 0.4439371394794236, 'support': 110412}, '1': {'precision': 0.4040260695889835, 'recall': 0.5962612472851381, 'f1-score': 0.48167178394636256, 'support': 90244}, '2': {'precision': 0.479707252162342, 'recall': 0.3996783017239029, 'f1-score': 0.43605123832563303, 'support': 110041}, 'accuracy': 0.4549448498054375, 'macro avg': {'precision': 0.4637454503081981, 'recall': 0.4634872945126322, 'f1-score': 0.4538867205838064, 'support': 310697}, 'weighted avg': {'precision': 0.4676029019149315, 'recall': 0.4549448498054375, 'f1-score': 0.4521044304619892, 'support': 310697}}
[[43560 38377 28475]
 [17208 53809 19227]
 [25064 40996 43981]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0949793
{'0': {'precision': 0.4604827027425176, 'recall': 0.4349288066416214, 'f1-score': 0.4473411169813121, 'support': 43122}, '1': {'precision': 0.4626570262955932, 'recall': 0.5015544948986295, 'f1-score': 0.48132117493801746, 'support': 45674}, '2': {'precision': 0.4462509516909399, 'recall': 0.43093634380039847, 'f1-score': 0.43845996066649773, 'support': 42164}, 'accuracy': 0.45687996334758707, 'macro avg': {'precision': 0.45646356024301693, 'recall': 0.4558065484468831, 'f1-score': 0.4557074175286091, 'support': 130960}, 'weighted avg': {'precision': 0.4566589588712932, 'recall': 0.45687996334758707, 'f1-score': 0.4563327181744759, 'support': 130960}}
[[18755 13230 11137]
 [11356 22908 11410]
 [10618 13376 18170]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0861745
{'0': {'precision': 0.4571021715913136, 'recall': 0.4565820354171112, 'f1-score': 0.45684195545435136, 'support': 14061}, '1': {'precision': 0.466633404016465, 'recall': 0.5080464453045427, 'f1-score': 0.4864601280842626, 'support': 14727}, '2': {'precision': 0.4634986225895317, 'recall': 0.42182603245351347, 'f1-score': 0.4416815546724031, 'support': 14359}, 'accuracy': 0.46258140774561385, 'macro avg': {'precision': 0.4624113993991035, 'recall': 0.4621515043917224, 'f1-score': 0.46166121273700567, 'support': 43147}, 'weighted avg': {'precision': 0.46248407762901306, 'recall': 0.46258140774561385, 'f1-score': 0.46190600703366647, 'support': 43147}}
[[6420 4215 3426]
 [3660 7482 3585]
 [3965 4337 6057]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2026044
{'0': {'precision': 0.3965898061034981, 'recall': 0.5115336842727864, 'f1-score': 0.4467873517446241, 'support': 101442}, '1': {'precision': 0.26988309697201995, 'recall': 0.1527841818329762, 'f1-score': 0.19511265824977053, 'support': 73738}, '2': {'precision': 0.41969451731130586, 'recall': 0.43006796366374667, 'f1-score': 0.424817923742179, 'support': 104909}, 'accuracy': 0.3865735534062387, 'macro avg': {'precision': 0.36205580679560795, 'recall': 0.3647952765898365, 'f1-score': 0.35557264457885784, 'support': 280089}, 'weighted avg': {'precision': 0.37188620414184653, 'recall': 0.3865735534062387, 'f1-score': 0.3723011017625397, 'support': 280089}}
[[51891 14847 34704]
 [34792 11266 27680]
 [44160 15631 45118]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1803
{'0': {'precision': 0.3905487804878049, 'recall': 0.3575034885195991, 'f1-score': 0.3732962447844228, 'support': 39415}, '1': {'precision': 0.3649985512645391, 'recall': 0.23704301075268816, 'f1-score': 0.28742319790087845, 'support': 37200}, '2': {'precision': 0.3763828808099402, 'recall': 0.5388020764710533, 'f1-score': 0.44318009406766806, 'support': 37949}, 'accuracy': 0.3784434901016026, 'macro avg': {'precision': 0.3773100708540948, 'recall': 0.37778285858111355, 'f1-score': 0.3679665122509898, 'support': 114564}, 'weighted avg': {'precision': 0.3775599685226083, 'recall': 0.3784434901016026, 'f1-score': 0.3685612918531532, 'support': 114564}}
[[14091  8152 17172]
 [11676  8818 16706]
 [10313  7189 20447]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1943576
{'0': {'precision': 0.3973608492906042, 'recall': 0.3286288668253057, 'f1-score': 0.3597413096200485, 'support': 12187}, '1': {'precision': 0.3442949093036864, 'recall': 0.2790477093806317, 'f1-score': 0.30825649622799667, 'support': 10543}, '2': {'precision': 0.38299585113629325, 'recall': 0.5135763514074566, 'f1-score': 0.4387769580022701, 'support': 12043}, 'accuracy': 0.37764932562620424, 'macro avg': {'precision': 0.3748838699101946, 'recall': 0.3737509758711313, 'f1-score': 0.3689249212834384, 'support': 34773}, 'weighted avg': {'precision': 0.37629646376003617, 'recall': 0.37764932562620424, 'f1-score': 0.3715039394154269, 'support': 34773}}
[[4005 2897 5285]
 [2922 2942 4679]
 [3152 2706 6185]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1484993
{'0': {'precision': 0.450184968539539, 'recall': 0.44053217821782176, 'f1-score': 0.4453062692542262, 'support': 161600}, '1': {'precision': 0.34059489468241444, 'recall': 0.4389555274971942, 'f1-score': 0.3835698305188637, 'support': 114048}, '2': {'precision': 0.4653965212264151, 'recall': 0.38234706420185166, 'f1-score': 0.4198038101126546, 'support': 165151}, 'accuracy': 0.41832445173423716, 'macro avg': {'precision': 0.4187254614827895, 'recall': 0.42061158997228915, 'f1-score': 0.41622663662858145, 'support': 440799}, 'weighted avg': {'precision': 0.42752991350205694, 'recall': 0.41832445173423716, 'f1-score': 0.41977836652627004, 'support': 440799}}
[[71190 47463 42947]
 [34398 50062 29588]
 [52547 49459 63145]]
Evaluating performance on  train set...
618/618 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1546735
{'0': {'precision': 0.43688058142756664, 'recall': 0.3901259944425412, 'f1-score': 0.41218165914277954, 'support': 52542}, '1': {'precision': 0.41132056089167396, 'recall': 0.45683425876625844, 'f1-score': 0.43288436416054776, 'support': 52588}, '2': {'precision': 0.41598419062458436, 'recall': 0.41444067924956934, 'f1-score': 0.41521100047415843, 'support': 52823}, 'accuracy': 0.42046684773318643, 'macro avg': {'precision': 0.42139511098127497, 'recall': 0.420466977486123, 'f1-score': 0.42009234125916195, 'support': 157953}, 'weighted avg': {'precision': 0.42138255092908006, 'recall': 0.42046684773318643, 'f1-score': 0.4200873826720688, 'support': 157953}}
[[20498 16788 15256]
 [13085 24024 15479]
 [13336 17595 21892]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.138168
{'0': {'precision': 0.4388838337882924, 'recall': 0.3808696567698463, 'f1-score': 0.4078239057523745, 'support': 18996}, '1': {'precision': 0.4277124297752809, 'recall': 0.4906106831797815, 'f1-score': 0.4570075269069337, 'support': 19863}, '2': {'precision': 0.4111239478461792, 'recall': 0.4020551998708775, 'f1-score': 0.4065390055489066, 'support': 18587}, 'accuracy': 0.4256693242349337, 'macro avg': {'precision': 0.42590673713658417, 'recall': 0.4245118466068351, 'f1-score': 0.4237901460694049, 'support': 57446}, 'weighted avg': {'precision': 0.4260392389006326, 'recall': 0.4256693242349337, 'f1-score': 0.42441430067823793, 'support': 57446}}
[[7235 6507 5254]
 [4668 9745 5450]
 [4582 6532 7473]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
4450/4450 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73658955
{'0': {'precision': 0.49867921917883146, 'recall': 0.6260856217229372, 'f1-score': 0.5551665159262476, 'support': 247554}, '1': {'precision': 0.8147498769131591, 'recall': 0.7112738989402987, 'f1-score': 0.759503660143236, 'support': 646786}, '2': {'precision': 0.5308937416090838, 'recall': 0.5718785363243062, 'f1-score': 0.5506245341315621, 'support': 244781}, 'accuracy': 0.662806672864428, 'macro avg': {'precision': 0.6147742792336914, 'recall': 0.636412685662514, 'f1-score': 0.6217649034003485, 'support': 1139121}, 'weighted avg': {'precision': 0.685064668528246, 'recall': 0.662806672864428, 'f1-score': 0.6702119003181114, 'support': 1139121}}
[[154990  51808  40756]
 [103807 460042  82937]
 [ 52004  52792 139985]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74589217
{'0': {'precision': 0.44709635611385273, 'recall': 0.6392052338260238, 'f1-score': 0.5261638821100056, 'support': 70159}, '1': {'precision': 0.8500656340246784, 'recall': 0.6631833785300552, 'f1-score': 0.7450847738443696, 'support': 244118}, '2': {'precision': 0.4722529341724783, 'recall': 0.6297241359757307, 'f1-score': 0.5397373121271399, 'support': 70542}, 'accuracy': 0.6526782721227382, 'macro avg': {'precision': 0.5898049747703366, 'recall': 0.6440375827772699, 'f1-score': 0.603661989360505, 'support': 384819}, 'weighted avg': {'precision': 0.7073398719341385, 'recall': 0.6526782721227382, 'f1-score': 0.6675291139428364, 'support': 384819}}
[[ 44846  14912  10401]
 [ 42982 161895  39241]
 [ 12477  13643  44422]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71954477
{'0': {'precision': 0.4727749352536163, 'recall': 0.6381463955322505, 'f1-score': 0.5431520891162757, 'support': 23457}, '1': {'precision': 0.8448635162899912, 'recall': 0.6929929098503725, 'f1-score': 0.7614292421947848, 'support': 83073}, '2': {'precision': 0.4761796216093002, 'recall': 0.6097744047370836, 'f1-score': 0.5347595538489669, 'support': 23981}, 'accuracy': 0.6678440897702109, 'macro avg': {'precision': 0.5979393577176358, 'recall': 0.6469712367065689, 'f1-score': 0.6131136283866758, 'support': 130511}, 'weighted avg': {'precision': 0.7102427538737359, 'recall': 0.6678440897702109, 'f1-score': 0.6805479909900307, 'support': 130511}}
[[14969  5206  3282]
 [12700 57569 12804]
 [ 3993  5365 14623]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
6203/6203 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70020235
{'0': {'precision': 0.4559963003571013, 'recall': 0.5616408902301019, 'f1-score': 0.5033349221964173, 'support': 265100}, '1': {'precision': 0.8283298707468063, 'recall': 0.7840084157246563, 'f1-score': 0.8055599685384103, 'support': 1054217}, '2': {'precision': 0.49434825666769117, 'recall': 0.4851260626235771, 'f1-score': 0.48969374408010463, 'support': 268557}, 'accuracy': 0.69633358818143, 'macro avg': {'precision': 0.5928914759238663, 'recall': 0.6102584561927785, 'f1-score': 0.5995295449383108, 'support': 1587874}, 'weighted avg': {'precision': 0.7096814579366237, 'recall': 0.69633358818143, 'f1-score': 0.7016802240327936, 'support': 1587874}}
[[148891  81213  34996]
 [129435 826515  98267]
 [ 48192  90081 130284]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68552065
{'0': {'precision': 0.5618877838243573, 'recall': 0.38483683987301914, 'f1-score': 0.4568067919174352, 'support': 77807}, '1': {'precision': 0.7797448353431093, 'recall': 0.8738109478962859, 'f1-score': 0.8241023140490601, 'support': 295929}, '2': {'precision': 0.5120318463740458, 'recall': 0.43886013673247715, 'f1-score': 0.4726306880345703, 'support': 78255}, 'accuracy': 0.714332807511654, 'macro avg': {'precision': 0.6178881551805042, 'recall': 0.5658359748339273, 'f1-score': 0.5845132646670218, 'support': 451991}, 'weighted avg': {'precision': 0.6958920958874707, 'recall': 0.714332807511654, 'f1-score': 0.7000233505647003, 'support': 451991}}
[[ 29943  36903  10961]
 [ 15575 258586  21768]
 [  7772  36140  34343]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63054866
{'0': {'precision': 0.5663759398496241, 'recall': 0.4106769016050244, 'f1-score': 0.47612064824412814, 'support': 22928}, '1': {'precision': 0.8087956592850282, 'recall': 0.9071866749495263, 'f1-score': 0.8551703944990644, 'support': 103024}, '2': {'precision': 0.5497797356828193, 'recall': 0.3949367088607595, 'f1-score': 0.4596685082872928, 'support': 22120}, 'accuracy': 0.7537819439191744, 'macro avg': {'precision': 0.6416504449391572, 'recall': 0.5709334284717701, 'f1-score': 0.5969865170101617, 'support': 148072}, 'weighted avg': {'precision': 0.7325649636957485, 'recall': 0.7537819439191744, 'f1-score': 0.7373942159836289, 'support': 148072}}
[[ 9416 10982  2530]
 [ 4938 93462  4624]
 [ 2271 11113  8736]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
5183/5183 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90261865
{'0': {'precision': 0.5526640637461251, 'recall': 0.4192301116561674, 'f1-score': 0.4767873355280378, 'support': 380185}, '1': {'precision': 0.6014815635341522, 'recall': 0.7736748647748504, 'f1-score': 0.6767974286446555, 'support': 561471}, '2': {'precision': 0.5145208009208313, 'recall': 0.42242149206612944, 'f1-score': 0.46394456958740843, 'support': 385184}, 'accuracy': 0.5701448554460221, 'macro avg': {'precision': 0.5562221427337029, 'recall': 0.5384421561657158, 'f1-score': 0.5391764445867006, 'support': 1326840}, 'weighted avg': {'precision': 0.5622488184078668, 'recall': 0.5701448554460221, 'f1-score': 0.5576961406863125, 'support': 1326840}}
[[159385 137388  83412]
 [ 56961 434396  70114]
 [ 72048 150426 162710]]
Evaluating performance on  train set...
1489/1489 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8745922
{'0': {'precision': 0.5264976017365528, 'recall': 0.44307166498070144, 'f1-score': 0.481195468993323, 'support': 101821}, '1': {'precision': 0.6430136401973805, 'recall': 0.7462841905104808, 'f1-score': 0.6908107151040473, 'support': 177754}, '2': {'precision': 0.5197691910460496, 'recall': 0.45619359161313205, 'f1-score': 0.4859106889856746, 'support': 101492}, 'accuracy': 0.5880042092335469, 'macro avg': {'precision': 0.5630934776599943, 'recall': 0.5485164823681048, 'f1-score': 0.5526389576943483, 'support': 381067}, 'weighted avg': {'precision': 0.579056107308448, 'recall': 0.5880042092335469, 'f1-score': 0.580229249311822, 'support': 381067}}
[[ 45114  37364  19343]
 [ 21664 132655  23435]
 [ 18909  36283  46300]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8435246
{'0': {'precision': 0.5156431450235672, 'recall': 0.4585826675981896, 'f1-score': 0.48544188813324973, 'support': 32921}, '1': {'precision': 0.6802334160574149, 'recall': 0.7547068716605396, 'f1-score': 0.7155375562673741, 'support': 67189}, '2': {'precision': 0.5126343807252238, 'recall': 0.4543226517982967, 'f1-score': 0.48172029039645287, 'support': 32642}, 'accuracy': 0.6074108111365554, 'macro avg': {'precision': 0.5695036472687354, 'recall': 0.5558707303523419, 'f1-score': 0.5608999115990255, 'support': 132752}, 'weighted avg': {'precision': 0.5982064482978431, 'recall': 0.6074108111365554, 'f1-score': 0.6009837816861843, 'support': 132752}}
[[15097 11936  5888]
 [ 8270 50708  8211]
 [ 5911 11901 14830]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
7324/7324 - 99s - 99s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9615011
{'0': {'precision': 0.5450234283206636, 'recall': 0.4451909067782891, 'f1-score': 0.49007465488820856, 'support': 605374}, '1': {'precision': 0.5344751323930239, 'recall': 0.7115605739535744, 'f1-score': 0.6104342436294599, 'support': 680961}, '2': {'precision': 0.5441603080833886, 'recall': 0.43804844222437883, 'f1-score': 0.4853725345077113, 'support': 588371}, 'accuracy': 0.5397043589768209, 'macro avg': {'precision': 0.5412196229323587, 'recall': 0.5315999743187475, 'f1-score': 0.5286271443417933, 'support': 1874706}, 'weighted avg': {'precision': 0.5409210180972435, 'recall': 0.5397043589768209, 'f1-score': 0.5323178624303179, 'support': 1874706}}
[[269507 216460 119407]
 [ 99920 484545  96496]
 [125060 205576 257735]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9417016
{'0': {'precision': 0.5310717526575058, 'recall': 0.42669105632840115, 'f1-score': 0.47319349843524966, 'support': 153617}, '1': {'precision': 0.5813433126453792, 'recall': 0.7604221660322136, 'f1-score': 0.6589323514953299, 'support': 215934}, '2': {'precision': 0.5346081084520306, 'recall': 0.4086743925136672, 'f1-score': 0.4632348076654489, 'support': 154201}, 'accuracy': 0.5589782950709496, 'macro avg': {'precision': 0.5490077245849719, 'recall': 0.5319292049580939, 'f1-score': 0.5317868858653428, 'support': 523752}, 'weighted avg': {'precision': 0.5528390177644513, 'recall': 0.5589782950709496, 'f1-score': 0.546838455249317, 'support': 523752}}
[[ 65547  58753  29317]
 [ 26191 164201  25542]
 [ 31686  59497  63018]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9316907
{'0': {'precision': 0.5220233306516492, 'recall': 0.47076214314216275, 'f1-score': 0.49506933450321394, 'support': 55134}, '1': {'precision': 0.6023221133361738, 'recall': 0.7187472195035145, 'f1-score': 0.6554044264660712, 'support': 78673}, '2': {'precision': 0.5187432050445749, 'recall': 0.42767509814818133, 'f1-score': 0.46882768514242484, 'support': 55783}, 'accuracy': 0.5609895036658051, 'macro avg': {'precision': 0.5476962163441326, 'recall': 0.5390614869312862, 'f1-score': 0.5397671487039034, 'support': 189590}, 'weighted avg': {'precision': 0.5543793140020379, 'recall': 0.5609895036658051, 'f1-score': 0.5538815332673943, 'support': 189590}}
[[25955 17785 11394]
 [11388 56546 10739]
 [12377 19549 23857]]
testing model on single stock: results/universal/W6/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
29350/29350 - 395s - 395s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1452509
{'0': {'precision': 0.4220054496001617, 'recall': 0.4460562177534689, 'f1-score': 0.43369765490016937, 'support': 2322149}, '1': {'precision': 0.45679637839896803, 'recall': 0.556928668379039, 'f1-score': 0.5019171609711957, 'support': 2896177}, '2': {'precision': 0.40651963476117514, 'recall': 0.2706278392281221, 'f1-score': 0.32493816955731886, 'support': 2295078}, 'accuracy': 0.4352068649576144, 'macro avg': {'precision': 0.4284404875867683, 'recall': 0.42453757512021, 'f1-score': 0.42018432847622794, 'support': 7513404}, 'weighted avg': {'precision': 0.4306858739253689, 'recall': 0.4352068649576144, 'f1-score': 0.42677193419256043, 'support': 7513404}}
[[1035809  887068  399272]
 [ 775720 1612964  507493]
 [ 642963 1031003  621112]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1107911
{'0': {'precision': 0.4768808574535287, 'recall': 0.3764699301662156, 'f1-score': 0.42076788515987085, 'support': 464818}, '1': {'precision': 0.43030407268802157, 'recall': 0.6221496206640041, 'f1-score': 0.5087416525479067, 'support': 466473}, '2': {'precision': 0.4420871883507868, 'recall': 0.33722834048566946, 'f1-score': 0.382603254679396, 'support': 464184}, 'accuracy': 0.4455414822909762, 'macro avg': {'precision': 0.44975737283077905, 'recall': 0.44528263043862976, 'f1-score': 0.43737093079572453, 'support': 1395475}, 'weighted avg': {'precision': 0.44973778644279216, 'recall': 0.4455414822909762, 'f1-score': 0.4374804571227154, 'support': 1395475}}
[[174990 185557 104271]
 [ 82980 290216  93277]
 [108977 198671 156536]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1039686
{'0': {'precision': 0.4773415954512955, 'recall': 0.27061109466884564, 'f1-score': 0.34540669050952827, 'support': 155426}, '1': {'precision': 0.4524324679865542, 'recall': 0.6716051286004265, 'f1-score': 0.5406508941831556, 'support': 194595}, '2': {'precision': 0.42562968675002166, 'recall': 0.35115098479635426, 'f1-score': 0.3848197802432336, 'support': 154042}, 'accuracy': 0.45002906382733904, 'macro avg': {'precision': 0.4518012500626238, 'recall': 0.43112240268854213, 'f1-score': 0.4236257883119725, 'support': 504063}, 'weighted avg': {'precision': 0.4519221587952368, 'recall': 0.45002906382733904, 'f1-score': 0.43282595552725217, 'support': 504063}}
[[ 42060  79422  33944]
 [ 24853 130691  39051]
 [ 21200  78750  54092]]
training model: results/universal/W6/deepLOB_L2/h30
Epoch 1/50
9426/9426 - 391s - loss: 3.0127 - accuracy30: 0.4738 - val_loss: 3.3323 - val_accuracy30: 0.4447 - 391s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 385s - loss: 2.9306 - accuracy30: 0.5027 - val_loss: 3.3390 - val_accuracy30: 0.4580 - 385s/epoch - 41ms/step
Epoch 3/50
9426/9426 - 388s - loss: 2.8717 - accuracy30: 0.5187 - val_loss: 3.1943 - val_accuracy30: 0.4783 - 388s/epoch - 41ms/step
Epoch 4/50
9426/9426 - 386s - loss: 2.8423 - accuracy30: 0.5250 - val_loss: 3.1702 - val_accuracy30: 0.4820 - 386s/epoch - 41ms/step
Epoch 5/50
9426/9426 - 385s - loss: 2.8248 - accuracy30: 0.5289 - val_loss: 3.1620 - val_accuracy30: 0.4842 - 385s/epoch - 41ms/step
Epoch 6/50
9426/9426 - 386s - loss: 2.8130 - accuracy30: 0.5316 - val_loss: 3.1426 - val_accuracy30: 0.4885 - 386s/epoch - 41ms/step
Epoch 7/50
9426/9426 - 385s - loss: 2.8041 - accuracy30: 0.5335 - val_loss: 3.1552 - val_accuracy30: 0.4896 - 385s/epoch - 41ms/step
Epoch 8/50
9426/9426 - 385s - loss: 2.7970 - accuracy30: 0.5353 - val_loss: 3.1524 - val_accuracy30: 0.4919 - 385s/epoch - 41ms/step
Epoch 9/50
9426/9426 - 383s - loss: 2.7922 - accuracy30: 0.5362 - val_loss: 3.1509 - val_accuracy30: 0.4914 - 383s/epoch - 41ms/step
Epoch 10/50
9426/9426 - 384s - loss: 2.7879 - accuracy30: 0.5371 - val_loss: 3.1211 - val_accuracy30: 0.4932 - 384s/epoch - 41ms/step
Epoch 11/50
9426/9426 - 384s - loss: 2.7843 - accuracy30: 0.5381 - val_loss: 3.1329 - val_accuracy30: 0.4928 - 384s/epoch - 41ms/step
Epoch 12/50
9426/9426 - 386s - loss: 2.7813 - accuracy30: 0.5387 - val_loss: 3.1329 - val_accuracy30: 0.4945 - 386s/epoch - 41ms/step
Epoch 13/50
9426/9426 - 383s - loss: 2.7784 - accuracy30: 0.5395 - val_loss: 3.1294 - val_accuracy30: 0.4944 - 383s/epoch - 41ms/step
Epoch 14/50
9426/9426 - 384s - loss: 2.7753 - accuracy30: 0.5401 - val_loss: 3.1329 - val_accuracy30: 0.4959 - 384s/epoch - 41ms/step
Epoch 15/50
9426/9426 - 383s - loss: 2.7729 - accuracy30: 0.5405 - val_loss: 3.1367 - val_accuracy30: 0.4954 - 383s/epoch - 41ms/step
Epoch 16/50
9426/9426 - 385s - loss: 2.7706 - accuracy30: 0.5410 - val_loss: 3.1189 - val_accuracy30: 0.4965 - 385s/epoch - 41ms/step
Epoch 17/50
9426/9426 - 384s - loss: 2.7685 - accuracy30: 0.5414 - val_loss: 3.1315 - val_accuracy30: 0.4952 - 384s/epoch - 41ms/step
Epoch 18/50
9426/9426 - 385s - loss: 2.7663 - accuracy30: 0.5420 - val_loss: 3.1233 - val_accuracy30: 0.4962 - 385s/epoch - 41ms/step
Epoch 19/50
9426/9426 - 385s - loss: 2.7642 - accuracy30: 0.5423 - val_loss: 3.1384 - val_accuracy30: 0.4959 - 385s/epoch - 41ms/step
Epoch 20/50
9426/9426 - 388s - loss: 2.7627 - accuracy30: 0.5429 - val_loss: 3.1230 - val_accuracy30: 0.4969 - 388s/epoch - 41ms/step
Epoch 21/50
9426/9426 - 389s - loss: 2.7608 - accuracy30: 0.5433 - val_loss: 3.1150 - val_accuracy30: 0.4978 - 389s/epoch - 41ms/step
Epoch 22/50
9426/9426 - 388s - loss: 2.7596 - accuracy30: 0.5436 - val_loss: 3.1390 - val_accuracy30: 0.4964 - 388s/epoch - 41ms/step
Epoch 23/50
9426/9426 - 386s - loss: 2.7574 - accuracy30: 0.5440 - val_loss: 3.1288 - val_accuracy30: 0.4959 - 386s/epoch - 41ms/step
Epoch 24/50
9426/9426 - 385s - loss: 2.7562 - accuracy30: 0.5444 - val_loss: 3.1145 - val_accuracy30: 0.4973 - 385s/epoch - 41ms/step
Epoch 25/50
9426/9426 - 386s - loss: 2.7542 - accuracy30: 0.5448 - val_loss: 3.1277 - val_accuracy30: 0.4952 - 386s/epoch - 41ms/step
Epoch 26/50
9426/9426 - 387s - loss: 2.7527 - accuracy30: 0.5451 - val_loss: 3.1598 - val_accuracy30: 0.4956 - 387s/epoch - 41ms/step
Epoch 27/50
9426/9426 - 386s - loss: 2.7516 - accuracy30: 0.5454 - val_loss: 3.1481 - val_accuracy30: 0.4940 - 386s/epoch - 41ms/step
Epoch 28/50
9426/9426 - 385s - loss: 2.7502 - accuracy30: 0.5457 - val_loss: 3.1554 - val_accuracy30: 0.4949 - 385s/epoch - 41ms/step
Epoch 29/50
9426/9426 - 384s - loss: 2.7487 - accuracy30: 0.5461 - val_loss: 3.1431 - val_accuracy30: 0.4941 - 384s/epoch - 41ms/step
Epoch 30/50
9426/9426 - 386s - loss: 2.7472 - accuracy30: 0.5465 - val_loss: 3.1658 - val_accuracy30: 0.4934 - 386s/epoch - 41ms/step
Epoch 31/50
9426/9426 - 385s - loss: 2.7463 - accuracy30: 0.5467 - val_loss: 3.1571 - val_accuracy30: 0.4933 - 385s/epoch - 41ms/step
Epoch 32/50
9426/9426 - 383s - loss: 2.7445 - accuracy30: 0.5471 - val_loss: 3.1696 - val_accuracy30: 0.4930 - 383s/epoch - 41ms/step
Epoch 33/50
9426/9426 - 385s - loss: 2.7431 - accuracy30: 0.5476 - val_loss: 3.1711 - val_accuracy30: 0.4932 - 385s/epoch - 41ms/step
Epoch 34/50
9426/9426 - 385s - loss: 2.7423 - accuracy30: 0.5479 - val_loss: 3.1830 - val_accuracy30: 0.4923 - 385s/epoch - 41ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 568s - 568s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1041236
{'0': {'precision': 0.40068514001029915, 'recall': 0.5269649024810167, 'f1-score': 0.45522987346404703, 'support': 3134723}, '1': {'precision': 0.5401574720729366, 'recall': 0.4968445205642817, 'f1-score': 0.5175964600777384, 'support': 4569987}, '2': {'precision': 0.4115375001655012, 'recall': 0.32940098955688957, 'f1-score': 0.36591663592770196, 'support': 3113919}, 'accuracy': 0.4573768080964788, 'macro avg': {'precision': 0.45079337074957904, 'recall': 0.4510701375340626, 'f1-score': 0.44624765648982917, 'support': 10818629}, 'weighted avg': {'precision': 0.4627244349032161, 'recall': 0.4573768080964788, 'f1-score': 0.4558676902098663, 'support': 10818629}}
[[1651889  899665  583169]
 [1415882 2270573  883532]
 [1054890 1033301 1025728]]
Evaluating performance on  train set...
9426/9426 - 132s - 132s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0279002
{'0': {'precision': 0.44876483643117465, 'recall': 0.48409022779713595, 'f1-score': 0.46575868047631236, 'support': 727226}, '1': {'precision': 0.5566441139915838, 'recall': 0.580764395744601, 'f1-score': 0.5684485033123123, 'support': 959346}, '2': {'precision': 0.45547628315986294, 'recall': 0.3934500783460373, 'f1-score': 0.42219723033719087, 'support': 725627}, 'accuracy': 0.4952721562358661, 'macro avg': {'precision': 0.48696174452754043, 'recall': 0.48610156729592474, 'f1-score': 0.4854681380419385, 'support': 2412199}, 'weighted avg': {'precision': 0.49368797932521713, 'recall': 0.4952721562358661, 'f1-score': 0.49349507635340417, 'support': 2412199}}
[[352043 220511 154672]
 [215550 557154 186642]
 [216878 223251 285498]]
Evaluating performance on  val set...
3323/3323 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.026745
{'0': {'precision': 0.4488152399292227, 'recall': 0.4331588943502963, 'f1-score': 0.4408481054926092, 'support': 245358}, '1': {'precision': 0.5548764557521679, 'recall': 0.6106649267781559, 'f1-score': 0.581435537685003, 'support': 361709}, '2': {'precision': 0.4455543899065108, 'recall': 0.394615884292492, 'f1-score': 0.41854096716522043, 'support': 243234}, 'accuracy': 0.49764259950299955, 'macro avg': {'precision': 0.4830820285293005, 'recall': 0.47947990180698136, 'f1-score': 0.4802748701142776, 'support': 850301}, 'weighted avg': {'precision': 0.4929997660201922, 'recall': 0.49764259950299955, 'f1-score': 0.494271405038246, 'support': 850301}}
[[106279  88409  50670]
 [ 72054 220883  68772]
 [ 58466  88784  95984]]
testing model out of sample: results/universal/W6/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 240s - 240s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9702144
{'0': {'precision': 0.46416355133354903, 'recall': 0.5396765448449982, 'f1-score': 0.49907984863381877, 'support': 1353016}, '1': {'precision': 0.585478839690172, 'recall': 0.6421916741619793, 'f1-score': 0.6125253184867568, 'support': 1787784}, '2': {'precision': 0.5250538614648426, 'recall': 0.37144761418774824, 'f1-score': 0.4350913176561409, 'support': 1344343}, 'accuracy': 0.5301155392369875, 'macro avg': {'precision': 0.5248987508295212, 'recall': 0.5177719443982419, 'f1-score': 0.5155654949255721, 'support': 4485143}, 'weighted avg': {'precision': 0.5307707907620779, 'recall': 0.5301155392369875, 'f1-score': 0.5251199240952791, 'support': 4485143}}
[[ 730191  400734  222091]
 [ 410077 1148100  229607]
 [ 432865  412125  499353]]
Evaluating performance on  train set...
5153/5153 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9618013
{'0': {'precision': 0.4858062831297854, 'recall': 0.460011259246788, 'f1-score': 0.47255702086260953, 'support': 380132}, '1': {'precision': 0.5968900987656937, 'recall': 0.7048127004547363, 'f1-score': 0.6463775335471217, 'support': 559665}, '2': {'precision': 0.49749840502333703, 'recall': 0.39111129882951706, 'f1-score': 0.4379363549838316, 'support': 378818}, 'accuracy': 0.5441193980047246, 'macro avg': {'precision': 0.5267315956396054, 'recall': 0.5186450861770138, 'f1-score': 0.5189569697978543, 'support': 1318615}, 'weighted avg': {'precision': 0.5363129965444985, 'recall': 0.5441193980047246, 'f1-score': 0.5363863613635979, 'support': 1318615}}
[[174865 135793  69474]
 [ 85030 394459  80176]
 [100053 130605 148160]]
Evaluating performance on  val set...
1795/1795 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94777566
{'0': {'precision': 0.4749075387021796, 'recall': 0.49973465008421974, 'f1-score': 0.4870048832407029, 'support': 130017}, '1': {'precision': 0.6196258672936029, 'recall': 0.7049177037334404, 'f1-score': 0.6595256707301329, 'support': 199280}, '2': {'precision': 0.5029307831849592, 'recall': 0.3700991550599946, 'f1-score': 0.42640979365403936, 'support': 129595}, 'accuracy': 0.5522279752098533, 'macro avg': {'precision': 0.5324880630602472, 'recall': 0.5249171696258849, 'f1-score': 0.5243134492082917, 'support': 458892}, 'weighted avg': {'precision': 0.5456674144255407, 'recall': 0.5522279752098533, 'f1-score': 0.544811778754048, 'support': 458892}}
[[ 64974  43006  22037]
 [ 33437 140476  25367]
 [ 38403  43229  47963]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
1059/1059 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1639458
{'0': {'precision': 0.4097129808855553, 'recall': 0.5736745151181503, 'f1-score': 0.4780249832386464, 'support': 94456}, '1': {'precision': 0.34233290430722263, 'recall': 0.30096576405884057, 'f1-score': 0.32031928301358353, 'support': 76002}, '2': {'precision': 0.4632672620949259, 'recall': 0.3315011579480961, 'f1-score': 0.3864613388025631, 'support': 100609}, 'accuracy': 0.40732733973519464, 'macro avg': {'precision': 0.40510438242923463, 'recall': 0.4020471457083623, 'f1-score': 0.394935201684931, 'support': 271067}, 'weighted avg': {'precision': 0.41069805873747794, 'recall': 0.40732733973519464, 'f1-score': 0.39982263720768313, 'support': 271067}}
[[54187 20263 20006]
 [34493 22874 18635]
 [43576 23681 33352]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1552482
{'0': {'precision': 0.41710271317829456, 'recall': 0.4638969716564285, 'f1-score': 0.4392571049543344, 'support': 18558}, '1': {'precision': 0.39862976157851465, 'recall': 0.40809112333071484, 'f1-score': 0.403304960212937, 'support': 17822}, '2': {'precision': 0.4123656627305294, 'recall': 0.35360373172535414, 'f1-score': 0.38073071387008856, 'support': 17579}, 'accuracy': 0.40953316406901535, 'macro avg': {'precision': 0.40936604582911285, 'recall': 0.4085306089041658, 'f1-score': 0.40776425967912, 'support': 53959}, 'weighted avg': {'precision': 0.4094580653302518, 'recall': 0.40953316406901535, 'f1-score': 0.40831556503604194, 'support': 53959}}
[[8609 5597 4352]
 [6043 7273 4506]
 [5988 5375 6216]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1399994
{'0': {'precision': 0.4177873206011979, 'recall': 0.5162686775590002, 'f1-score': 0.4618363522798251, 'support': 7161}, '1': {'precision': 0.39787343508832107, 'recall': 0.35588280411106, 'f1-score': 0.3757085020242915, 'support': 6519}, '2': {'precision': 0.43025012590229983, 'recall': 0.3684059220928561, 'f1-score': 0.39693356047700173, 'support': 6957}, 'accuracy': 0.415758104375636, 'macro avg': {'precision': 0.415303627197273, 'recall': 0.4135191345876388, 'f1-score': 0.41149280492703944, 'support': 20637}, 'weighted avg': {'precision': 0.41569811755915315, 'recall': 0.415758104375636, 'f1-score': 0.412749945418941, 'support': 20637}}
[[3697 1800 1664]
 [2469 2320 1730]
 [2683 1711 2563]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8049799
{'0': {'precision': 0.39277166235773875, 'recall': 0.6853374507031773, 'f1-score': 0.4993578600304296, 'support': 107512}, '1': {'precision': 0.8029198851738341, 'recall': 0.6748717081969793, 'f1-score': 0.7333482161941359, 'support': 343163}, '2': {'precision': 0.5445251611661696, 'recall': 0.41727188940092164, 'f1-score': 0.47248022374819976, 'support': 108500}, 'accuracy': 0.6269003442571646, 'macro avg': {'precision': 0.5800722362325809, 'recall': 0.5924936827670261, 'f1-score': 0.5683954333242551, 'support': 559175}, 'weighted avg': {'precision': 0.6739232682180767, 'recall': 0.6269003442571646, 'f1-score': 0.637741387648052, 'support': 559175}}
[[ 73682  24575   9255]
 [ 82957 231591  28615]
 [ 30956  32270  45274]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7072346
{'0': {'precision': 0.44906759465900065, 'recall': 0.5454628991500114, 'f1-score': 0.49259366831251816, 'support': 21765}, '1': {'precision': 0.8404304720332489, 'recall': 0.7800717649213926, 'f1-score': 0.8091270306972689, 'support': 92803}, '2': {'precision': 0.48639183087894006, 'recall': 0.5310513222150558, 'f1-score': 0.5077414381676028, 'support': 21706}, 'accuracy': 0.7029367304107901, 'macro avg': {'precision': 0.5919632991903966, 'recall': 0.61886199542882, 'f1-score': 0.6031540457257966, 'support': 136274}, 'weighted avg': {'precision': 0.7215319604246814, 'recall': 0.7029367304107901, 'f1-score': 0.7105665987458106, 'support': 136274}}
[[11872  7399  2494]
 [10732 72393  9678]
 [ 3833  6346 11527]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73549205
{'0': {'precision': 0.43736707783921736, 'recall': 0.5365249152100182, 'f1-score': 0.48189806678383124, 'support': 7666}, '1': {'precision': 0.8440816602447103, 'recall': 0.750841852074564, 'f1-score': 0.7947363396238424, 'support': 33260}, '2': {'precision': 0.4233608336951802, 'recall': 0.5360087960417812, 'f1-score': 0.4730713245997089, 'support': 7276}, 'accuracy': 0.684328451101614, 'macro avg': {'precision': 0.5682698572597026, 'recall': 0.6077918544421211, 'f1-score': 0.5832352436691275, 'support': 48202}, 'weighted avg': {'precision': 0.7158911552305016, 'recall': 0.684328451101614, 'f1-score': 0.6964281190332626, 'support': 48202}}
[[ 4113  2457  1096]
 [ 4071 24973  4216]
 [ 1220  2156  3900]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1439002
{'0': {'precision': 0.4849699398797595, 'recall': 0.4453718344176884, 'f1-score': 0.46432818073721766, 'support': 115737}, '1': {'precision': 0.3686582364423322, 'recall': 0.5369136641740313, 'f1-score': 0.4371550054092133, 'support': 80905}, '2': {'precision': 0.4840840840840841, 'recall': 0.3674718337644119, 'f1-score': 0.4177935056196576, 'support': 114055}, 'accuracy': 0.44061255821588236, 'macro avg': {'precision': 0.44590408680205856, 'recall': 0.4499191107853772, 'f1-score': 0.4397588972553628, 'support': 310697}, 'weighted avg': {'precision': 0.45435736669952026, 'recall': 0.44061255821588236, 'f1-score': 0.44016973015531474, 'support': 310697}}
[[51546 36966 27225]
 [20023 43439 17443]
 [34718 37425 41912]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1309491
{'0': {'precision': 0.4386677327049318, 'recall': 0.47075957369942195, 'f1-score': 0.4541474252853533, 'support': 44288}, '1': {'precision': 0.440218725588662, 'recall': 0.4558038499757354, 'f1-score': 0.44787574649742273, 'support': 43273}, '2': {'precision': 0.4514458798249929, 'recall': 0.4018064932371714, 'f1-score': 0.4251822592836418, 'support': 43399}, 'accuracy': 0.44296731826511915, 'macro avg': {'precision': 0.4434441127061956, 'recall': 0.4427899723041096, 'f1-score': 0.4424018103554726, 'support': 130960}, 'weighted avg': {'precision': 0.4434147922797729, 'recall': 0.44296731826511915, 'f1-score': 0.4424762768774547, 'support': 130960}}
[[20849 12741 10698]
 [13058 19724 10491]
 [13621 12340 17438]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1252209
{'0': {'precision': 0.433552014995314, 'recall': 0.4754367934224049, 'f1-score': 0.4535294117647059, 'support': 14595}, '1': {'precision': 0.4334225729181344, 'recall': 0.45268579838116263, 'f1-score': 0.44284480276418087, 'support': 13590}, '2': {'precision': 0.46393265369168984, 'recall': 0.4014837588557679, 'f1-score': 0.43045503403797925, 'support': 14962}, 'accuracy': 0.4426263703154333, 'macro avg': {'precision': 0.4436357472017127, 'recall': 0.4432021168864451, 'f1-score': 0.44227641618895536, 'support': 43147}, 'weighted avg': {'precision': 0.44404627875284763, 'recall': 0.4426263703154333, 'f1-score': 0.44216262668429657, 'support': 43147}}
[[6939 4109 3547]
 [4044 6152 3394]
 [5022 3933 6007]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.222217
{'0': {'precision': 0.3874300881600152, 'recall': 0.5668572107906755, 'f1-score': 0.46027551533433886, 'support': 100939}, '1': {'precision': 0.28781943105110896, 'recall': 0.1274639334854733, 'f1-score': 0.17668223650742265, 'support': 74931}, '2': {'precision': 0.4204940585976476, 'recall': 0.40032047899135476, 'f1-score': 0.41015936059143326, 'support': 104219}, 'accuracy': 0.38734116655777273, 'macro avg': {'precision': 0.3652478592695905, 'recall': 0.36488054108916784, 'f1-score': 0.34903903747773163, 'support': 280089}, 'weighted avg': {'precision': 0.3730845329515356, 'recall': 0.38734116655777273, 'f1-score': 0.3657591883563764, 'support': 280089}}
[[57218 12086 31635]
 [39517  9551 25863]
 [50951 11547 41721]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1939732
{'0': {'precision': 0.3685104172909051, 'recall': 0.4774450684541525, 'f1-score': 0.41596392333709137, 'support': 38639}, '1': {'precision': 0.3716131430961565, 'recall': 0.21137781537485462, 'f1-score': 0.269475103210043, 'support': 37828}, '2': {'precision': 0.38191504210673244, 'recall': 0.43092631965771583, 'f1-score': 0.40494308301370197, 'support': 38097}, 'accuracy': 0.37412276107677805, 'macro avg': {'precision': 0.37401286749793133, 'recall': 0.3732497344955743, 'f1-score': 0.36346070318694546, 'support': 114564}, 'weighted avg': {'precision': 0.3739924701466855, 'recall': 0.37412276107677805, 'f1-score': 0.3639297761218566, 'support': 114564}}
[[18448  7258 12933]
 [16196  7996 13636]
 [15417  6263 16417]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1880589
{'0': {'precision': 0.3816804130624288, 'recall': 0.47358349280306183, 'f1-score': 0.4226941927818209, 'support': 12019}, '1': {'precision': 0.3616724738675958, 'recall': 0.24412041392285982, 'f1-score': 0.2914911541701769, 'support': 10630}, '2': {'precision': 0.3942451714623571, 'recall': 0.4124876278455955, 'f1-score': 0.40316014349631185, 'support': 12124}, 'accuracy': 0.3821355649498174, 'macro avg': {'precision': 0.3791993527974606, 'recall': 0.3767305115238391, 'f1-score': 0.37244849681610326, 'support': 34773}, 'weighted avg': {'precision': 0.3799448923193136, 'recall': 0.3821355649498174, 'f1-score': 0.37577505684361345, 'support': 34773}}
[[5692 2440 3887]
 [4238 2595 3797]
 [4983 2140 5001]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
1722/1722 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1734802
{'0': {'precision': 0.4139658104534686, 'recall': 0.5328714687925089, 'f1-score': 0.46595243825188304, 'support': 158055}, '1': {'precision': 0.3562067694628485, 'recall': 0.34058891502282396, 'f1-score': 0.34822281433814295, 'support': 122021}, '2': {'precision': 0.4469396887481976, 'recall': 0.3355711379205216, 'f1-score': 0.3833303126899007, 'support': 160723}, 'accuracy': 0.407705099149499, 'macro avg': {'precision': 0.4057040895548382, 'recall': 0.4030105072452848, 'f1-score': 0.3991685217599756, 'support': 440799}, 'weighted avg': {'precision': 0.4099999319021272, 'recall': 0.407705099149499, 'f1-score': 0.4032373179220343, 'support': 440799}}
[[84223 37250 36582]
 [50304 41559 30158]
 [68927 37862 53934]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1834373
{'0': {'precision': 0.40577955574270974, 'recall': 0.4396768060836502, 'f1-score': 0.4220486522984835, 'support': 52600}, '1': {'precision': 0.4049903240416684, 'recall': 0.37584302936512487, 'f1-score': 0.38987266511420504, 'support': 52341}, '2': {'precision': 0.4099837739811015, 'recall': 0.40513468648607864, 'f1-score': 0.40754480677818156, 'support': 53012}, 'accuracy': 0.40693117572948917, 'macro avg': {'precision': 0.40691788458849315, 'recall': 0.40688484064495123, 'f1-score': 0.4064887080636233, 'support': 157953}, 'weighted avg': {'precision': 0.40692904224052506, 'recall': 0.40693117572948917, 'f1-score': 0.40651870855613886, 'support': 157953}}
[[23127 14410 15063]
 [16824 19672 15845]
 [17043 14492 21477]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.174837
{'0': {'precision': 0.40955781863069257, 'recall': 0.4857262365366517, 'f1-score': 0.4444019230309264, 'support': 19126}, '1': {'precision': 0.416988212907659, 'recall': 0.4053331963212249, 'f1-score': 0.4110781095305091, 'support': 19463}, '2': {'precision': 0.4191492047462762, 'recall': 0.35217691043113963, 'f1-score': 0.3827555401861618, 'support': 18857}, 'accuracy': 0.4146502802632037, 'macro avg': {'precision': 0.41523174542820923, 'recall': 0.41441211442967213, 'f1-score': 0.41274519091586576, 'support': 57446}, 'weighted avg': {'precision': 0.4152237054077381, 'recall': 0.4146502802632037, 'f1-score': 0.41287584247767034, 'support': 57446}}
[[9290 5527 4309]
 [6680 7889 4894]
 [6713 5503 6641]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
4450/4450 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79032826
{'0': {'precision': 0.5045513443908957, 'recall': 0.6553140569893076, 'f1-score': 0.5701344105251462, 'support': 285808}, '1': {'precision': 0.7481380117400578, 'recall': 0.694766086484023, 'f1-score': 0.7204649556492657, 'support': 570510}, '2': {'precision': 0.5638759859219998, 'recall': 0.47474743902999617, 'f1-score': 0.5154874689242759, 'support': 282803}, 'accuracy': 0.630244723782636, 'macro avg': {'precision': 0.6055217806843177, 'recall': 0.6082758608344423, 'f1-score': 0.602028945032896, 'support': 1139121}, 'weighted avg': {'precision': 0.6412759032290624, 'recall': 0.630244723782636, 'f1-score': 0.6318581082475221, 'support': 1139121}}
[[187294  65439  33075]
 [103372 396371  70767]
 [ 80543  68000 134260]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.817111
{'0': {'precision': 0.4533288339821727, 'recall': 0.665285662519628, 'f1-score': 0.5392262921645317, 'support': 82790}, '1': {'precision': 0.7938656801431456, 'recall': 0.6300473513819571, 'f1-score': 0.7025330312364756, 'support': 219001}, '2': {'precision': 0.5151098747639955, 'recall': 0.5553307318013201, 'f1-score': 0.5344646717553713, 'support': 83028}, 'accuracy': 0.6215077737845585, 'macro avg': {'precision': 0.5874347962964379, 'recall': 0.6168879152343018, 'f1-score': 0.5920746650521261, 'support': 384819}, 'weighted avg': {'precision': 0.660458591348967, 'recall': 0.6215077737845585, 'f1-score': 0.6311370121242089, 'support': 384819}}
[[ 55079  18415   9296]
 [ 46913 137981  34107]
 [ 19507  17413  46108]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78669935
{'0': {'precision': 0.473865504553639, 'recall': 0.656270328876039, 'f1-score': 0.5503477746965495, 'support': 27670}, '1': {'precision': 0.7870214722953471, 'recall': 0.6669444033812205, 'f1-score': 0.7220246019102489, 'support': 74411}, '2': {'precision': 0.5197377454345736, 'recall': 0.5325712275765037, 'f1-score': 0.5260762308467392, 'support': 28430}, 'accuracy': 0.6354100420654197, 'macro avg': {'precision': 0.5935415740945199, 'recall': 0.6185953199445877, 'f1-score': 0.5994828691511792, 'support': 130511}, 'weighted avg': {'precision': 0.6624043750233559, 'recall': 0.6354100420654197, 'f1-score': 0.6429423023466976, 'support': 130511}}
[[18159  6513  2998]
 [13790 49628 10993]
 [ 6372  6917 15141]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
6203/6203 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79584974
{'0': {'precision': 0.4106206311530901, 'recall': 0.6461560182644885, 'f1-score': 0.5021401488940175, 'support': 311643}, '1': {'precision': 0.785512596342019, 'recall': 0.698915442440713, 'f1-score': 0.7396881081084061, 'support': 959654}, '2': {'precision': 0.5231331918509426, 'recall': 0.4025592509879113, 'f1-score': 0.4549936806929102, 'support': 316577}, 'accuracy': 0.6294756384952458, 'macro avg': {'precision': 0.573088806448684, 'recall': 0.5825435705643709, 'f1-score': 0.5656073125651113, 'support': 1587874}, 'weighted avg': {'precision': 0.6596236772949504, 'recall': 0.6294756384952458, 'f1-score': 0.6363059339551892, 'support': 1587874}}
[[201370  79665  30608]
 [203375 670717  85562]
 [ 85659 103477 127441]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7672801
{'0': {'precision': 0.5301093022938471, 'recall': 0.422352685366384, 'f1-score': 0.47013548102116015, 'support': 91980}, '1': {'precision': 0.7371668028607511, 'recall': 0.8148016825352985, 'f1-score': 0.7740424588928776, 'support': 267929}, '2': {'precision': 0.5072672658123591, 'recall': 0.45482287526335224, 'f1-score': 0.4796156753166441, 'support': 92082}, 'accuracy': 0.6616016690597821, 'macro avg': {'precision': 0.5915144569889857, 'recall': 0.5639924143883449, 'f1-score': 0.5745978717435606, 'support': 451991}, 'weighted avg': {'precision': 0.6481943275843985, 'recall': 0.6616016690597821, 'f1-score': 0.6522153187287874, 'support': 451991}}
[[ 38848  40452  12680]
 [ 21619 218309  28001]
 [ 12816  37385  41881]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7200833
{'0': {'precision': 0.506481877992759, 'recall': 0.4789779839481629, 'f1-score': 0.4923461181857746, 'support': 27162}, '1': {'precision': 0.7738211413849637, 'recall': 0.8383287343926755, 'f1-score': 0.8047843539244591, 'support': 94587}, '2': {'precision': 0.526590669411942, 'recall': 0.398358849675189, 'f1-score': 0.45358595034172505, 'support': 26323}, 'accuracy': 0.694196066778324, 'macro avg': {'precision': 0.6022978962632216, 'recall': 0.5718885226720092, 'f1-score': 0.5835721408173196, 'support': 148072}, 'weighted avg': {'precision': 0.6808304558670744, 'recall': 0.694196066778324, 'f1-score': 0.6850382646122161, 'support': 148072}}
[[13010 11598  2554]
 [ 8419 79295  6873]
 [ 4258 11579 10486]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
5183/5183 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9613775
{'0': {'precision': 0.5240678885705081, 'recall': 0.506758323476713, 'f1-score': 0.5152677754915409, 'support': 426955}, '1': {'precision': 0.5329399612774383, 'recall': 0.7296673955182049, 'f1-score': 0.6159775822941302, 'support': 467402}, '2': {'precision': 0.5512497719394271, 'recall': 0.3493085277340381, 'f1-score': 0.4276374918085921, 'support': 432483}, 'accuracy': 0.5339611407554792, 'macro avg': {'precision': 0.5360858739291244, 'recall': 0.5285780822429853, 'f1-score': 0.5196276165314211, 'support': 1326840}, 'weighted avg': {'precision': 0.5360531520479468, 'recall': 0.5339611407554792, 'f1-score': 0.5221814630055525, 'support': 1326840}}
[[216363 139903  70689]
 [ 74063 341048  52291]
 [122427 158986 151070]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9258376
{'0': {'precision': 0.5285290656625088, 'recall': 0.48299624050447787, 'f1-score': 0.5047378452243958, 'support': 116239}, '1': {'precision': 0.5816437734763535, 'recall': 0.7055894452161892, 'f1-score': 0.6376493419855661, 'support': 149013}, '2': {'precision': 0.5399734254584109, 'recall': 0.4386133057030609, 'f1-score': 0.4840440230596979, 'support': 115815}, 'accuracy': 0.5565504228915125, 'macro avg': {'precision': 0.5500487548657578, 'recall': 0.5423996638079093, 'f1-score': 0.5421437367565533, 'support': 381067}, 'weighted avg': {'precision': 0.5527773224919558, 'recall': 0.5565504228915125, 'f1-score': 0.5504224252401615, 'support': 381067}}
[[ 56143  39247  20849]
 [ 21443 105142  22428]
 [ 28639  36378  50798]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9130415
{'0': {'precision': 0.5135367656943137, 'recall': 0.5031875658587988, 'f1-score': 0.5083094937129932, 'support': 37960}, '1': {'precision': 0.6108873065659794, 'recall': 0.7201941781602145, 'f1-score': 0.6610526654441334, 'support': 57061}, '2': {'precision': 0.5365905394895001, 'recall': 0.4022686915268612, 'f1-score': 0.4598209552085069, 'support': 37731}, 'accuracy': 0.5677805230806315, 'macro avg': {'precision': 0.5536715372499311, 'recall': 0.5418834785152915, 'f1-score': 0.5430610381218778, 'support': 132752}, 'weighted avg': {'precision': 0.5619334840243148, 'recall': 0.5677805230806315, 'f1-score': 0.5601818351906193, 'support': 132752}}
[[19101 13047  5812]
 [ 8670 41095  7296]
 [ 9424 13129 15178]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
7324/7324 - 99s - 99s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0134503
{'0': {'precision': 0.5289467442324978, 'recall': 0.5035706592386258, 'f1-score': 0.5159468688853592, 'support': 673125}, '1': {'precision': 0.4581890134974196, 'recall': 0.6724975509921668, 'f1-score': 0.5450334321565548, 'support': 549202}, '2': {'precision': 0.5666909774330636, 'recall': 0.37160454275812066, 'f1-score': 0.4488669870474452, 'support': 652379}, 'accuracy': 0.5071355188493556, 'macro avg': {'precision': 0.5179422450543271, 'recall': 0.5158909176629711, 'f1-score': 0.5032824293631197, 'support': 1874706}, 'weighted avg': {'precision': 0.5213526243416912, 'recall': 0.5071355188493556, 'f1-score': 0.5011247541047646, 'support': 1874706}}
[[338966 226758 107401]
 [101899 369337  77966]
 [199967 209985 242427]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0008434
{'0': {'precision': 0.5172736165628599, 'recall': 0.4837643162368418, 'f1-score': 0.4999581119249366, 'support': 172706}, '1': {'precision': 0.5108696939432099, 'recall': 0.7258160403813797, 'f1-score': 0.599663128824264, 'support': 178300}, '2': {'precision': 0.558600743699215, 'recall': 0.3521933937688861, 'f1-score': 0.4320086912991149, 'support': 172746}, 'accuracy': 0.5227703187768257, 'macro avg': {'precision': 0.5289146847350948, 'recall': 0.5205912501290358, 'f1-score': 0.5105433106827718, 'support': 523752}, 'weighted avg': {'precision': 0.5287242200950911, 'recall': 0.5227703187768257, 'f1-score': 0.5114891684129727, 'support': 523752}}
[[ 83549  62598  26559]
 [ 27371 129413  21516]
 [ 50598  61308  60840]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9957359
{'0': {'precision': 0.5041775292898201, 'recall': 0.518015910154422, 'f1-score': 0.511003048222401, 'support': 61973}, '1': {'precision': 0.5261496579481583, 'recall': 0.6885490087682928, 'f1-score': 0.5964933285442523, 'support': 65121}, '2': {'precision': 0.5473399680550436, 'recall': 0.3564068100358423, 'f1-score': 0.4317043152988148, 'support': 62496}, 'accuracy': 0.5233187404398966, 'macro avg': {'precision': 0.5258890517643406, 'recall': 0.5209905763195191, 'f1-score': 0.5130668973551561, 'support': 189590}, 'weighted avg': {'precision': 0.5259525530960918, 'recall': 0.5233187404398966, 'f1-score': 0.5142276852393683, 'support': 189590}}
[[32103 19911  9959]
 [11820 44839  8462]
 [19751 20471 22274]]
testing model on single stock: results/universal/W6/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
29350/29350 - 397s - 397s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1948119
{'0': {'precision': 0.37194718724672965, 'recall': 0.5046453391425109, 'f1-score': 0.42825237222677914, 'support': 2213509}, '1': {'precision': 0.4763897100288824, 'recall': 0.41479186931455264, 'f1-score': 0.44346199007093173, 'support': 3113981}, '2': {'precision': 0.36351593322626496, 'recall': 0.29914763343846096, 'f1-score': 0.32820555289960635, 'support': 2185914}, 'accuracy': 0.4076184376615446, 'macro avg': {'precision': 0.40395094350062566, 'recall': 0.4061949472985081, 'f1-score': 0.3999733050657724, 'support': 7513404}, 'weighted avg': {'precision': 0.41278114683878686, 'recall': 0.4076184376615446, 'f1-score': 0.40544895555455096, 'support': 7513404}}
[[1117037  657649  438823]
 [1116210 1291654  706117]
 [ 769967  762036  653911]]
Evaluating performance on  train set...
5452/5452 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.131643
{'0': {'precision': 0.43898286719261176, 'recall': 0.45034235227974767, 'f1-score': 0.444590061528494, 'support': 467793}, '1': {'precision': 0.4340827593634924, 'recall': 0.5073876548998157, 'f1-score': 0.46788136933272756, 'support': 460701}, '2': {'precision': 0.4274682026965386, 'recall': 0.3451703602502029, 'f1-score': 0.38193629103247767, 'support': 466981}, 'accuracy': 0.43398054425912325, 'macro avg': {'precision': 0.43351127641754755, 'recall': 0.4343001224765888, 'f1-score': 0.4314692406312331, 'support': 1395475}, 'weighted avg': {'precision': 0.4335118884090263, 'recall': 0.43398054425912325, 'f1-score': 0.4313130113460959, 'support': 1395475}}
[[210667 148045 109081]
 [120140 233754 106807]
 [149091 156702 161188]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1354287
{'0': {'precision': 0.4328104851341605, 'recall': 0.3712002399355173, 'f1-score': 0.3996448080079649, 'support': 160043}, '1': {'precision': 0.44448150683151244, 'recall': 0.5506125668779213, 'f1-score': 0.4918873699929768, 'support': 186347}, '2': {'precision': 0.4161738746690203, 'recall': 0.35886296322135053, 'f1-score': 0.3853994612322184, 'support': 157673}, 'accuracy': 0.4336680137205072, 'macro avg': {'precision': 0.43115528887823107, 'recall': 0.4268919233449297, 'f1-score': 0.4256438797443867, 'support': 504063}, 'weighted avg': {'precision': 0.4319211431240673, 'recall': 0.4336680137205072, 'f1-score': 0.42928994787351493, 'support': 504063}}
[[ 59408  63665  36970]
 [ 41335 102605  42407]
 [ 36518  64572  56583]]
training model: results/universal/W6/deepOF_L2/h10
Epoch 1/50
9426/9426 - 216s - loss: 2.6952 - accuracy10: 0.5713 - val_loss: 2.8755 - val_accuracy10: 0.5732 - 216s/epoch - 23ms/step
Epoch 2/50
9426/9426 - 209s - loss: 2.6071 - accuracy10: 0.5878 - val_loss: 2.8518 - val_accuracy10: 0.5749 - 209s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 209s - loss: 2.5844 - accuracy10: 0.5921 - val_loss: 2.8318 - val_accuracy10: 0.5753 - 209s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 211s - loss: 2.5713 - accuracy10: 0.5942 - val_loss: 2.8133 - val_accuracy10: 0.5797 - 211s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 211s - loss: 2.5621 - accuracy10: 0.5956 - val_loss: 2.7887 - val_accuracy10: 0.5803 - 211s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 211s - loss: 2.5548 - accuracy10: 0.5972 - val_loss: 2.7662 - val_accuracy10: 0.5823 - 211s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 211s - loss: 2.5483 - accuracy10: 0.5983 - val_loss: 2.7470 - val_accuracy10: 0.5836 - 211s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 210s - loss: 2.5433 - accuracy10: 0.5990 - val_loss: 2.7403 - val_accuracy10: 0.5851 - 210s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 210s - loss: 2.5383 - accuracy10: 0.6000 - val_loss: 2.7146 - val_accuracy10: 0.5856 - 210s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 210s - loss: 2.5341 - accuracy10: 0.6007 - val_loss: 2.7180 - val_accuracy10: 0.5865 - 210s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 210s - loss: 2.5305 - accuracy10: 0.6014 - val_loss: 2.7068 - val_accuracy10: 0.5881 - 210s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 212s - loss: 2.5267 - accuracy10: 0.6022 - val_loss: 2.6909 - val_accuracy10: 0.5862 - 212s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 209s - loss: 2.5234 - accuracy10: 0.6028 - val_loss: 2.6852 - val_accuracy10: 0.5881 - 209s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 209s - loss: 2.5208 - accuracy10: 0.6029 - val_loss: 2.6750 - val_accuracy10: 0.5871 - 209s/epoch - 22ms/step
Epoch 15/50
9426/9426 - 209s - loss: 2.5182 - accuracy10: 0.6034 - val_loss: 2.6705 - val_accuracy10: 0.5886 - 209s/epoch - 22ms/step
Epoch 16/50
9426/9426 - 209s - loss: 2.5154 - accuracy10: 0.6041 - val_loss: 2.6704 - val_accuracy10: 0.5893 - 209s/epoch - 22ms/step
Epoch 17/50
9426/9426 - 209s - loss: 2.5129 - accuracy10: 0.6045 - val_loss: 2.6715 - val_accuracy10: 0.5878 - 209s/epoch - 22ms/step
Epoch 18/50
9426/9426 - 210s - loss: 2.5114 - accuracy10: 0.6045 - val_loss: 2.6692 - val_accuracy10: 0.5883 - 210s/epoch - 22ms/step
Epoch 19/50
9426/9426 - 209s - loss: 2.5091 - accuracy10: 0.6051 - val_loss: 2.6633 - val_accuracy10: 0.5903 - 209s/epoch - 22ms/step
Epoch 20/50
9426/9426 - 208s - loss: 2.5067 - accuracy10: 0.6055 - val_loss: 2.6658 - val_accuracy10: 0.5903 - 208s/epoch - 22ms/step
Epoch 21/50
9426/9426 - 210s - loss: 2.5050 - accuracy10: 0.6058 - val_loss: 2.6588 - val_accuracy10: 0.5911 - 210s/epoch - 22ms/step
Epoch 22/50
9426/9426 - 210s - loss: 2.5033 - accuracy10: 0.6060 - val_loss: 2.6450 - val_accuracy10: 0.5911 - 210s/epoch - 22ms/step
Epoch 23/50
9426/9426 - 209s - loss: 2.5012 - accuracy10: 0.6065 - val_loss: 2.6520 - val_accuracy10: 0.5906 - 209s/epoch - 22ms/step
Epoch 24/50
9426/9426 - 209s - loss: 2.4996 - accuracy10: 0.6067 - val_loss: 2.6487 - val_accuracy10: 0.5917 - 209s/epoch - 22ms/step
Epoch 25/50
9426/9426 - 209s - loss: 2.4980 - accuracy10: 0.6071 - val_loss: 2.6427 - val_accuracy10: 0.5899 - 209s/epoch - 22ms/step
Epoch 26/50
9426/9426 - 210s - loss: 2.4964 - accuracy10: 0.6073 - val_loss: 2.6434 - val_accuracy10: 0.5911 - 210s/epoch - 22ms/step
Epoch 27/50
9426/9426 - 209s - loss: 2.4949 - accuracy10: 0.6075 - val_loss: 2.6432 - val_accuracy10: 0.5920 - 209s/epoch - 22ms/step
Epoch 28/50
9426/9426 - 210s - loss: 2.4932 - accuracy10: 0.6079 - val_loss: 2.6490 - val_accuracy10: 0.5919 - 210s/epoch - 22ms/step
Epoch 29/50
9426/9426 - 208s - loss: 2.4918 - accuracy10: 0.6080 - val_loss: 2.6441 - val_accuracy10: 0.5899 - 208s/epoch - 22ms/step
Epoch 30/50
9426/9426 - 211s - loss: 2.4903 - accuracy10: 0.6086 - val_loss: 2.6462 - val_accuracy10: 0.5902 - 211s/epoch - 22ms/step
Epoch 31/50
9426/9426 - 208s - loss: 2.4892 - accuracy10: 0.6087 - val_loss: 2.6301 - val_accuracy10: 0.5914 - 208s/epoch - 22ms/step
Epoch 32/50
9426/9426 - 210s - loss: 2.4877 - accuracy10: 0.6088 - val_loss: 2.6435 - val_accuracy10: 0.5894 - 210s/epoch - 22ms/step
Epoch 33/50
9426/9426 - 212s - loss: 2.4862 - accuracy10: 0.6092 - val_loss: 2.6397 - val_accuracy10: 0.5909 - 212s/epoch - 22ms/step
Epoch 34/50
9426/9426 - 210s - loss: 2.4851 - accuracy10: 0.6092 - val_loss: 2.6462 - val_accuracy10: 0.5901 - 210s/epoch - 22ms/step
Epoch 35/50
9426/9426 - 208s - loss: 2.4839 - accuracy10: 0.6095 - val_loss: 2.6392 - val_accuracy10: 0.5934 - 208s/epoch - 22ms/step
Epoch 36/50
9426/9426 - 209s - loss: 2.4830 - accuracy10: 0.6094 - val_loss: 2.6524 - val_accuracy10: 0.5908 - 209s/epoch - 22ms/step
Epoch 37/50
9426/9426 - 210s - loss: 2.4814 - accuracy10: 0.6099 - val_loss: 2.6489 - val_accuracy10: 0.5904 - 210s/epoch - 22ms/step
Epoch 38/50
9426/9426 - 209s - loss: 2.4802 - accuracy10: 0.6103 - val_loss: 2.6430 - val_accuracy10: 0.5881 - 209s/epoch - 22ms/step
Epoch 39/50
9426/9426 - 210s - loss: 2.4792 - accuracy10: 0.6103 - val_loss: 2.6474 - val_accuracy10: 0.5890 - 210s/epoch - 22ms/step
Epoch 40/50
9426/9426 - 210s - loss: 2.4780 - accuracy10: 0.6105 - val_loss: 2.6417 - val_accuracy10: 0.5878 - 210s/epoch - 22ms/step
Epoch 41/50
9426/9426 - 209s - loss: 2.4774 - accuracy10: 0.6107 - val_loss: 2.6408 - val_accuracy10: 0.5890 - 209s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 317s - 317s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92817014
{'0': {'precision': 0.4829234431933254, 'recall': 0.5041438266666964, 'f1-score': 0.4933055326068427, 'support': 3133939}, '1': {'precision': 0.6760408155364337, 'recall': 0.5901325121728883, 'f1-score': 0.6301722774806584, 'support': 4497700}, '2': {'precision': 0.48168596855448914, 'recall': 0.5472573435855116, 'f1-score': 0.512382325602165, 'support': 3186965}, 'accuracy': 0.5525930147734402, 'macro avg': {'precision': 0.5468834090947494, 'recall': 0.5471778941416988, 'f1-score': 0.5452867118965554, 'support': 10818604}, 'weighted avg': {'precision': 0.5628450501978187, 'recall': 0.5525930147734402, 'f1-score': 0.5558258568563759, 'support': 10818604}}
[[1579956  624249  929734]
 [ 896482 2654239  946979]
 [ 795211  647664 1744090]]
Evaluating performance on  train set...
9426/9426 - 76s - 76s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86409706
{'0': {'precision': 0.49406911095842615, 'recall': 0.4965826437854172, 'f1-score': 0.4953226886392303, 'support': 647284}, '1': {'precision': 0.7455913378009431, 'recall': 0.6431052507635657, 'f1-score': 0.6905665473827787, 'support': 1121056}, '2': {'precision': 0.463888011496842, 'recall': 0.5725401879319717, 'f1-score': 0.512518917235487, 'support': 643850}, 'accuracy': 0.5849526778570511, 'macro avg': {'precision': 0.5678494867520704, 'recall': 0.5707426941603182, 'f1-score': 0.5661360510858321, 'support': 2412190}, 'weighted avg': {'precision': 0.6029073039062552, 'recall': 0.5849526778570511, 'f1-score': 0.5906514525795945, 'support': 2412190}}
[[321430 124785 201069]
 [175145 720957 224954]
 [154002 121218 368630]]
Evaluating performance on  val set...
3323/3323 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8556396
{'0': {'precision': 0.48322751297165817, 'recall': 0.4759908736263998, 'f1-score': 0.47958189557947684, 'support': 209941}, '1': {'precision': 0.7428543321865058, 'recall': 0.6637736407713091, 'f1-score': 0.7010910263661652, 'support': 432304}, '2': {'precision': 0.4507188454929282, 'recall': 0.5572282062743628, 'f1-score': 0.498346125161465, 'support': 208053}, 'accuracy': 0.5913397420668989, 'macro avg': {'precision': 0.5589335635503639, 'recall': 0.5656642402240238, 'f1-score': 0.5596730157023689, 'support': 850298}, 'weighted avg': {'precision': 0.607271303100417, 'recall': 0.5913397420668989, 'f1-score': 0.5967916708968714, 'support': 850298}}
[[ 99930  50838  59173]
 [ 63240 286952  82112]
 [ 43627  48493 115933]]
testing model out of sample: results/universal/W6/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 133s - 133s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.804583
{'0': {'precision': 0.4907556001153973, 'recall': 0.4360151098445939, 'f1-score': 0.461768708465985, 'support': 1026086}, '1': {'precision': 0.7355802277044591, 'recall': 0.7736599516201181, 'f1-score': 0.7541396938335274, 'support': 2434483}, '2': {'precision': 0.4854946775481676, 'recall': 0.48000925285174256, 'f1-score': 0.4827363827237202, 'support': 1024549}, 'accuracy': 0.6293355046623077, 'macro avg': {'precision': 0.570610168456008, 'recall': 0.5632281047721516, 'f1-score': 0.5662149283410775, 'support': 4485118}, 'weighted avg': {'precision': 0.6224425079942021, 'recall': 0.6293355046623077, 'f1-score': 0.6252548426688352, 'support': 4485118}}
[[ 447389  341768  236929]
 [ 266770 1883462  284251]
 [ 197474  335282  491793]]
Evaluating performance on  train set...
5152/5152 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8042474
{'0': {'precision': 0.47942511051821846, 'recall': 0.43285461092668653, 'f1-score': 0.4549511839486392, 'support': 284368}, '1': {'precision': 0.7436519618968569, 'recall': 0.765313163588218, 'f1-score': 0.754327089414894, 'support': 749241}, '2': {'precision': 0.4658287482806052, 'recall': 0.47530710418559935, 'f1-score': 0.470520197081978, 'support': 285001}, 'accuracy': 0.6309348480596992, 'macro avg': {'precision': 0.5629686068985601, 'recall': 0.5578249595668346, 'f1-score': 0.5599328234818371, 'support': 1318610}, 'weighted avg': {'precision': 0.6266214866413333, 'recall': 0.6309348480596992, 'f1-score': 0.6284231636086273, 'support': 1318610}}
[[123090  98954  62324]
 [ 82824 573404  93013]
 [ 50831  98707 135463]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7915479
{'0': {'precision': 0.47632186928576903, 'recall': 0.4465315842417524, 'f1-score': 0.4609459022733654, 'support': 97422}, '1': {'precision': 0.757392188267773, 'recall': 0.7634372825988325, 'f1-score': 0.7604027212114023, 'support': 264488}, '2': {'precision': 0.4600786442289597, 'recall': 0.4789696738469153, 'f1-score': 0.46933414165908854, 'support': 96979}, 'accuracy': 0.6360405239611322, 'macro avg': {'precision': 0.5645975672608339, 'recall': 0.5629795135625001, 'f1-score': 0.5635609217146188, 'support': 458889}, 'weighted avg': {'precision': 0.6348884830074489, 'recall': 0.6360405239611322, 'f1-score': 0.6353153428018408, 'support': 458889}}
[[ 43502  32328  21592]
 [ 29649 201920  32919]
 [ 18178  32351  46450]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
1059/1059 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0956388
{'0': {'precision': 0.38306248638252155, 'recall': 0.6160780096424558, 'f1-score': 0.4723987769850829, 'support': 82759}, '1': {'precision': 0.5826975476839237, 'recall': 0.21259991251441523, 'f1-score': 0.3115348755900006, 'support': 100588}, '2': {'precision': 0.4313901699568442, 'recall': 0.49801060251952345, 'f1-score': 0.46231267462534925, 'support': 87715}, 'accuracy': 0.42814559030775245, 'macro avg': {'precision': 0.46571673467442976, 'recall': 0.44222950822546486, 'f1-score': 0.4154154424001442, 'support': 271062}, 'weighted avg': {'precision': 0.4727834886288975, 'recall': 0.42814559030775245, 'f1-score': 0.40944018971717894, 'support': 271062}}
[[50986  6900 24873]
 [46498 21385 32705]
 [35617  8415 43683]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.079835
{'0': {'precision': 0.37145479577787976, 'recall': 0.5312417957469152, 'f1-score': 0.4372062874736672, 'support': 15236}, '1': {'precision': 0.6368948247078464, 'recall': 0.3140305387496399, 'f1-score': 0.4206522038757339, 'support': 24297}, '2': {'precision': 0.37188568032096686, 'recall': 0.5204491889643699, 'f1-score': 0.43380037555972845, 'support': 14426}, 'accuracy': 0.43054912062862544, 'macro avg': {'precision': 0.46007843360223105, 'recall': 0.45524050782030834, 'f1-score': 0.4305529556363765, 'support': 53959}, 'weighted avg': {'precision': 0.49109400931649194, 'recall': 0.43054912062862544, 'f1-score': 0.4288416355259019, 'support': 53959}}
[[8094 2218 4924]
 [8910 7630 7757]
 [4786 2132 7508]]
Evaluating performance on  val set...
81/81 - 1s - 928ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0690811
{'0': {'precision': 0.37378041942357293, 'recall': 0.5723853683668212, 'f1-score': 0.4522388059701492, 'support': 5823}, '1': {'precision': 0.6469334596258584, 'recall': 0.3038594149705261, 'f1-score': 0.41350083245043134, 'support': 8991}, '2': {'precision': 0.403948772678762, 'recall': 0.5200961868773617, 'f1-score': 0.45472293137107667, 'support': 5822}, 'accuracy': 0.4406377204884668, 'macro avg': {'precision': 0.4748875505760644, 'recall': 0.46544699007156964, 'f1-score': 0.4401541899305524, 'support': 20636}, 'weighted avg': {'precision': 0.5013031533405364, 'recall': 0.4406377204884668, 'f1-score': 0.4360617105140732, 'support': 20636}}
[[3333  719 1771]
 [3562 2732 2697]
 [2022  772 3028]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5202921
{'0': {'precision': 0.546624294413085, 'recall': 0.3675912365125385, 'f1-score': 0.4395775251983702, 'support': 66914}, '1': {'precision': 0.8573773035294014, 'recall': 0.9244549479393698, 'f1-score': 0.8896535460566742, 'support': 424409}, '2': {'precision': 0.5412578015877225, 'recall': 0.45120639085000075, 'f1-score': 0.4921466810282462, 'support': 67847}, 'accuracy': 0.8003952286424522, 'macro avg': {'precision': 0.648419799843403, 'recall': 0.581084191767303, 'f1-score': 0.6071259174277636, 'support': 559170}, 'weighted avg': {'precision': 0.7818341114764545, 'recall': 0.8003952286424522, 'f1-score': 0.7875628846633657, 'support': 559170}}
[[ 24597  33979   8338]
 [ 14454 392347  17608]
 [  5947  31287  30613]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47060865
{'0': {'precision': 0.515929117846422, 'recall': 0.3943745373797187, 'f1-score': 0.447036120317154, 'support': 13510}, '1': {'precision': 0.8939165588042342, 'recall': 0.9227615491617249, 'f1-score': 0.9081100553879408, 'support': 109272}, '2': {'precision': 0.49003499163243575, 'recall': 0.4775743198161465, 'f1-score': 0.48372442275201805, 'support': 13489}, 'accuracy': 0.826309339477952, 'macro avg': {'precision': 0.633293556094364, 'recall': 0.5982368021191967, 'f1-score': 0.612956866152371, 'support': 136271}, 'weighted avg': {'precision': 0.8164637714399348, 'recall': 0.826309339477952, 'f1-score': 0.820390388977389, 'support': 136271}}
[[  5328   6333   1849]
 [  3585 100832   4855]
 [  1414   5633   6442]]
Evaluating performance on  val set...
189/189 - 4s - 4s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4622635
{'0': {'precision': 0.5608087091757388, 'recall': 0.37830465799412505, 'f1-score': 0.45182307981455955, 'support': 4766}, '1': {'precision': 0.8889968659653555, 'recall': 0.9390027970951269, 'f1-score': 0.9133158617246974, 'support': 38969}, '2': {'precision': 0.5040522875816994, 'recall': 0.4317062248096731, 'f1-score': 0.4650826197081172, 'support': 4466}, 'accuracy': 0.8365594074811726, 'macro avg': {'precision': 0.6512859542409313, 'recall': 0.5830045599663084, 'f1-score': 0.6100738537491247, 'support': 48201}, 'weighted avg': {'precision': 0.8208798716639775, 'recall': 0.8365594074811726, 'f1-score': 0.8261540962544838, 'support': 48201}}
[[ 1803  2377   586]
 [ 1066 36592  1311]
 [  346  2192  1928]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0394154
{'0': {'precision': 0.45631489816836757, 'recall': 0.44827397500164173, 'f1-score': 0.45225869855677386, 'support': 91366}, '1': {'precision': 0.5825092868728091, 'recall': 0.5219195099655445, 'f1-score': 0.5505523985346296, 'support': 127991}, '2': {'precision': 0.42995350938282295, 'recall': 0.5002025510483386, 'f1-score': 0.46242528834523494, 'support': 91335}, 'accuracy': 0.4938781816075084, 'macro avg': {'precision': 0.4895925648079998, 'recall': 0.4901320120051749, 'f1-score': 0.48841212847887944, 'support': 310692}, 'weighted avg': {'precision': 0.5005517261521666, 'recall': 0.4938781816075084, 'f1-score': 0.49573994182082587, 'support': 310692}}
[[40957 22906 27503]
 [28121 66801 33069]
 [20678 24971 45686]]
Evaluating performance on  train set...
512/512 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0186421
{'0': {'precision': 0.4187639017319371, 'recall': 0.47314621336194723, 'f1-score': 0.4442971349781908, 'support': 35414}, '1': {'precision': 0.615394941223848, 'recall': 0.5275261782256341, 'f1-score': 0.5680828465215081, 'support': 60833}, '2': {'precision': 0.42085051546391755, 'recall': 0.4704001382767263, 'f1-score': 0.4442479561438113, 'support': 34713}, 'accuracy': 0.4976786805131338, 'macro avg': {'precision': 0.4850031194732342, 'recall': 0.4903575099547692, 'f1-score': 0.4855426458811701, 'support': 130960}, 'weighted avg': {'precision': 0.5106552322747719, 'recall': 0.4976786805131338, 'f1-score': 0.5017845284222715, 'support': 130960}}
[[16756  9955  8703]
 [14974 32091 13768]
 [ 8283 10101 16329]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0153549
{'0': {'precision': 0.41394089781186555, 'recall': 0.4754296571379221, 'f1-score': 0.44255969129351236, 'support': 11579}, '1': {'precision': 0.6178202355203076, 'recall': 0.5190812720848057, 'f1-score': 0.5641630548088001, 'support': 19810}, '2': {'precision': 0.43028099674316445, 'recall': 0.4832014969805222, 'f1-score': 0.4552083333333333, 'support': 11757}, 'accuracy': 0.4975895795670514, 'macro avg': {'precision': 0.48734737669177924, 'recall': 0.4925708087344167, 'f1-score': 0.487310359811882, 'support': 43146}, 'weighted avg': {'precision': 0.512002368704637, 'recall': 0.4975895795670514, 'f1-score': 0.5018391775888822, 'support': 43146}}
[[ 5505  3231  2843]
 [ 4848 10283  4679]
 [ 2946  3130  5681]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1826918
{'0': {'precision': 0.3861082982305816, 'recall': 0.6418255343731947, 'f1-score': 0.48215975966089136, 'support': 100398}, '1': {'precision': 0.289002557544757, 'recall': 0.0015539481283863693, 'f1-score': 0.003091274672064999, 'support': 72718}, '2': {'precision': 0.43654367830357615, 'recall': 0.4603526288235734, 'f1-score': 0.44813213814442365, 'support': 106968}, 'accuracy': 0.40628525727995884, 'macro avg': {'precision': 0.37055151135963826, 'recall': 0.3679107037750515, 'f1-score': 0.31112772415912665, 'support': 280084}, 'weighted avg': {'precision': 0.3801587848148074, 'recall': 0.40628525727995884, 'f1-score': 0.34478394130000317, 'support': 280084}}
[[64438   145 35815]
 [44861   113 27744]
 [57592   133 49243]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2181829
{'0': {'precision': 0.38886783514921835, 'recall': 0.6176359942818449, 'f1-score': 0.4772535682102264, 'support': 39873}, '1': {'precision': 0.61082910321489, 'recall': 0.00975833919013894, 'f1-score': 0.01920979114008248, 'support': 36994}, '2': {'precision': 0.3731487697958217, 'recall': 0.5012998726655348, 'f1-score': 0.4278340012225769, 'support': 37696}, 'accuracy': 0.38306434014472385, 'macro avg': {'precision': 0.45761523605331006, 'recall': 0.3762314020458395, 'f1-score': 0.3080991201909619, 'support': 114563}, 'weighted avg': {'precision': 0.45537001528817955, 'recall': 0.38306434014472385, 'f1-score': 0.3130837098257625, 'support': 114563}}
[[24627    93 15153]
 [20041   361 16592]
 [18662   137 18897]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1966733
{'0': {'precision': 0.3896457765667575, 'recall': 0.6349911190053286, 'f1-score': 0.48294495103005747, 'support': 12386}, '1': {'precision': 0.6584362139917695, 'recall': 0.015541525012141816, 'f1-score': 0.030366293414310117, 'support': 10295}, '2': {'precision': 0.3984663645869641, 'recall': 0.4727092292424744, 'f1-score': 0.43242425388659833, 'support': 12092}, 'accuracy': 0.3951629137549248, 'macro avg': {'precision': 0.48218278504849704, 'recall': 0.37441395775331493, 'f1-score': 0.315245166110322, 'support': 34773}, 'weighted avg': {'precision': 0.472291970557234, 'recall': 0.3951629137549248, 'f1-score': 0.331385018035699, 'support': 34773}}
[[7865   30 4491]
 [5997  160 4138]
 [6323   53 5716]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0474153
{'0': {'precision': 0.4668923897209771, 'recall': 0.5164716202848237, 'f1-score': 0.4904321625852953, 'support': 160731}, '1': {'precision': 0.5032928283753652, 'recall': 0.25106922360569794, 'f1-score': 0.3350151013950813, 'support': 115972}, '2': {'precision': 0.46479024285616793, 'recall': 0.5810678221230903, 'f1-score': 0.5164652130226713, 'support': 164091}, 'accuracy': 0.4706915248392673, 'macro avg': {'precision': 0.47832515365083667, 'recall': 0.4495362220045373, 'f1-score': 0.447304159001016, 'support': 440794}, 'weighted avg': {'precision': 0.47568672061121897, 'recall': 0.4706915248392673, 'f1-score': 0.4592333755304987, 'support': 440794}}
[[83013 14569 63149]
 [40210 29117 46645]
 [54576 14167 95348]]
Evaluating performance on  train set...
617/617 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0601897
{'0': {'precision': 0.44824259131633354, 'recall': 0.5018421712544126, 'f1-score': 0.4735304556747754, 'support': 51841}, '1': {'precision': 0.5488425545887374, 'recall': 0.3115621912803594, 'f1-score': 0.3974840673451916, 'support': 53649}, '2': {'precision': 0.43530529680233815, 'recall': 0.5763219091914147, 'f1-score': 0.4959850392473692, 'support': 52462}, 'accuracy': 0.4619504659643436, 'macro avg': {'precision': 0.47746348090246965, 'recall': 0.46324209057539556, 'f1-score': 0.4556665207557788, 'support': 157952}, 'weighted avg': {'precision': 0.4781147745416676, 'recall': 0.4619504659643436, 'f1-score': 0.45515904965200626, 'support': 157952}}
[[26016  6857 18968]
 [16680 16715 20254]
 [15344  6883 30235]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.058487
{'0': {'precision': 0.43884827555276495, 'recall': 0.5272942824810045, 'f1-score': 0.47902286189846777, 'support': 18557}, '1': {'precision': 0.5612262228260869, 'recall': 0.316386614964814, 'f1-score': 0.4046532986376856, 'support': 20889}, '2': {'precision': 0.4246106452164984, 'recall': 0.5513639646647036, 'f1-score': 0.4797563510671727, 'support': 17999}, 'accuracy': 0.45814257115501783, 'macro avg': {'precision': 0.47489504786511677, 'recall': 0.4650149540368407, 'f1-score': 0.45447750386777536, 'support': 57445}, 'weighted avg': {'precision': 0.47888813684913467, 'recall': 0.45814257115501783, 'f1-score': 0.45220932311516265, 'support': 57445}}
[[9785 2609 6163]
 [6995 6609 7285]
 [5517 2558 9924]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/EXC
Evaluating performance on  test set...
4450/4450 - 38s - 38s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6221142
{'0': {'precision': 0.5305617268712801, 'recall': 0.40237237190387787, 'f1-score': 0.45766015147885597, 'support': 192297}, '1': {'precision': 0.8032483866362782, 'recall': 0.8633867204241337, 'f1-score': 0.832232547227549, 'support': 755988}, '2': {'precision': 0.5332665530294645, 'recall': 0.5049336847786785, 'f1-score': 0.5187135116802997, 'support': 190831}, 'accuracy': 0.7255117125911672, 'macro avg': {'precision': 0.6223588888456743, 'recall': 0.59023092570223, 'f1-score': 0.6028687367955682, 'support': 1139116}, 'weighted avg': {'precision': 0.7119866276039656, 'recall': 0.7255117125911672, 'f1-score': 0.7164776117707531, 'support': 1139116}}
[[ 77375  84504  30418]
 [ 49361 652710  53917]
 [ 19100  75374  96357]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5518471
{'0': {'precision': 0.5225170250677341, 'recall': 0.4046079987903531, 'f1-score': 0.4560648508154287, 'support': 52908}, '1': {'precision': 0.8371812158828514, 'recall': 0.8756899534169292, 'f1-score': 0.8560027082920395, 'support': 278642}, '2': {'precision': 0.5001717885092575, 'recall': 0.49192761132387175, 'f1-score': 0.4960154460618221, 'support': 53268}, 'accuracy': 0.7577997910700643, 'macro avg': {'precision': 0.6199566764866143, 'recall': 0.5907418545103847, 'f1-score': 0.6026943350564301, 'support': 384818}, 'weighted avg': {'precision': 0.7472683968749495, 'recall': 0.7577997910700643, 'f1-score': 0.7511850707390878, 'support': 384818}}
[[ 21407  24815   6686]
 [ 15138 244004  19500]
 [  4424  22640  26204]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56008077
{'0': {'precision': 0.5207366589327146, 'recall': 0.4100485298315729, 'f1-score': 0.45881112850161304, 'support': 17515}, '1': {'precision': 0.8367165834719911, 'recall': 0.8723531761885737, 'f1-score': 0.8541633424096273, 'support': 95114}, '2': {'precision': 0.4830238122365273, 'recall': 0.4741639637624427, 'f1-score': 0.4785528840726944, 'support': 17882}, 'accuracy': 0.7557523886875436, 'macro avg': {'precision': 0.6134923515470777, 'recall': 0.5855218899275297, 'f1-score': 0.597175784994645, 'support': 130511}, 'weighted avg': {'precision': 0.745849740726644, 'recall': 0.7557523886875436, 'f1-score': 0.7496414228581726, 'support': 130511}}
[[ 7182  8360  1973]
 [ 5039 82973  7102]
 [ 1571  7832  8479]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/AAL
Evaluating performance on  test set...
6203/6203 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5398059
{'0': {'precision': 0.5289470021887375, 'recall': 0.4129275350867663, 'f1-score': 0.46379166897775803, 'support': 202498}, '1': {'precision': 0.8466619456061519, 'recall': 0.9120843112750328, 'f1-score': 0.8781563281452209, 'support': 1181052}, '2': {'precision': 0.536190101223059, 'recall': 0.41325574224619344, 'f1-score': 0.46676414413766987, 'support': 204319}, 'accuracy': 0.784241017363523, 'macro avg': {'precision': 0.6372663496726495, 'recall': 0.5794225295359975, 'f1-score': 0.6029040470868829, 'support': 1587869}, 'weighted avg': {'precision': 0.7661943897910005, 'recall': 0.784241017363523, 'f1-score': 0.7723772907080447, 'support': 1587869}}
[[  83617   94593   24288]
 [  55083 1077219   48750]
 [  19382  100501   84436]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5688125
{'0': {'precision': 0.541251240372348, 'recall': 0.39032576841818306, 'f1-score': 0.45356273139440495, 'support': 58692}, '1': {'precision': 0.8437450599579955, 'recall': 0.8954072538487579, 'f1-score': 0.8688088341518219, 'support': 333809}, '2': {'precision': 0.49154561039429756, 'recall': 0.4578906670252824, 'f1-score': 0.4741216504355848, 'support': 59488}, 'accuracy': 0.7722378199469456, 'macro avg': {'precision': 0.625513970241547, 'recall': 0.5812078964307411, 'f1-score': 0.5988310719939371, 'support': 451989}, 'weighted avg': {'precision': 0.7581110995855835, 'recall': 0.7722378199469456, 'f1-score': 0.762941710288299, 'support': 451989}}
[[ 22909  28012   7771]
 [ 14509 298895  20405]
 [  4908  27341  27239]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.526544
{'0': {'precision': 0.524977497749775, 'recall': 0.40498784862863096, 'f1-score': 0.4572417848043379, 'support': 17282}, '1': {'precision': 0.8681547218105887, 'recall': 0.9028888168898151, 'f1-score': 0.8851811629973343, 'support': 114199}, '2': {'precision': 0.4862885048835462, 'recall': 0.4681453800253149, 'f1-score': 0.47704449835703094, 'support': 16591}, 'accuracy': 0.7960654276298017, 'macro avg': {'precision': 0.6264735748146366, 'recall': 0.592007348514587, 'f1-score': 0.6064891487195677, 'support': 148072}, 'weighted avg': {'precision': 0.7853144063474657, 'recall': 0.7960654276298017, 'f1-score': 0.7895044399370755, 'support': 148072}}
[[  6999   8227   2056]
 [  4941 103109   6149]
 [  1392   7432   7767]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/WBA
Evaluating performance on  test set...
5183/5183 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83438396
{'0': {'precision': 0.5172149931566015, 'recall': 0.4301045995598225, 'f1-score': 0.4696546956873673, 'support': 304877}, '1': {'precision': 0.7035447873370663, 'recall': 0.7752989407024578, 'f1-score': 0.7376810923521533, 'support': 709338}, '2': {'precision': 0.4861070628859864, 'recall': 0.453457872177084, 'f1-score': 0.4692151998450954, 'support': 312620}, 'accuracy': 0.6201509607449306, 'macro avg': {'precision': 0.5689556144598846, 'recall': 0.5529538041464548, 'f1-score': 0.558850329294872, 'support': 1326835}, 'weighted avg': {'precision': 0.609499144828198, 'recall': 0.6201509607449306, 'f1-score': 0.6128404821394845, 'support': 1326835}}
[[131129 110236  63512]
 [ 73038 549949  86351]
 [ 49362 121498 141760]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7788914
{'0': {'precision': 0.5269509117347194, 'recall': 0.39219784047370254, 'f1-score': 0.4496965461171453, 'support': 80388}, '1': {'precision': 0.720096175532429, 'recall': 0.8101542853259023, 'f1-score': 0.7624751860909912, 'support': 220695}, '2': {'precision': 0.4975047300446955, 'recall': 0.453689580155535, 'f1-score': 0.4745880198796757, 'support': 79982}, 'accuracy': 0.6471651817931324, 'macro avg': {'precision': 0.5815172724372814, 'recall': 0.5520139019850466, 'f1-score': 0.5622532506959373, 'support': 381065}, 'weighted avg': {'precision': 0.6326311224334297, 'recall': 0.6471651817931324, 'f1-score': 0.6360677736072129, 'support': 381065}}
[[ 31528  35614  13246]
 [ 18493 178797  23405]
 [  9810  33885  36287]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74683416
{'0': {'precision': 0.5167280540208717, 'recall': 0.3943392543431583, 'f1-score': 0.44731306600535836, 'support': 25615}, '1': {'precision': 0.7460287878621779, 'recall': 0.8329294264522288, 'f1-score': 0.7870877452709618, 'support': 81702}, '2': {'precision': 0.4991357350800582, 'recall': 0.4314303687976724, 'f1-score': 0.46282002615040696, 'support': 25434}, 'accuracy': 0.6713772400961198, 'macro avg': {'precision': 0.5872975256543692, 'recall': 0.5528996831976866, 'f1-score': 0.5657402791422425, 'support': 132751}, 'weighted avg': {'precision': 0.6544813328388221, 'recall': 0.6713772400961198, 'f1-score': 0.6593994146557451, 'support': 132751}}
[[10101 11703  3811]
 [ 6450 68052  7200]
 [ 2997 11464 10973]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
7324/7324 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8907226
{'0': {'precision': 0.5355164756629828, 'recall': 0.38636512444448085, 'f1-score': 0.4488751912121453, 'support': 488732}, '1': {'precision': 0.6384198278666268, 'recall': 0.7579493442478655, 'f1-score': 0.6930687092634689, 'support': 908880}, '2': {'precision': 0.5027796398995131, 'recall': 0.46690030581296155, 'f1-score': 0.4841761834171619, 'support': 477089}, 'accuracy': 0.5870093417563654, 'macro avg': {'precision': 0.5589053144763741, 'recall': 0.5370715915017693, 'f1-score': 0.5420400279642587, 'support': 1874701}, 'weighted avg': {'precision': 0.5770742571509587, 'recall': 0.5870093417563654, 'f1-score': 0.5762471399957573, 'support': 1874701}}
[[188829 202945  96958]
 [ 96663 688885 123332]
 [ 67119 187217 222753]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.847164
{'0': {'precision': 0.521586052578555, 'recall': 0.39926939156553154, 'f1-score': 0.4523040987300098, 'support': 123185}, '1': {'precision': 0.6771752446229473, 'recall': 0.7892377816253574, 'f1-score': 0.7289246321074702, 'support': 276653}, '2': {'precision': 0.506204563718253, 'recall': 0.43718929562915615, 'f1-score': 0.4691724765080327, 'support': 123912}, 'accuracy': 0.6142281622911695, 'macro avg': {'precision': 0.5683219536399183, 'recall': 0.541898822940015, 'f1-score': 0.5501337357818376, 'support': 523750}, 'weighted avg': {'precision': 0.6001316672783154, 'recall': 0.6142281622911695, 'f1-score': 0.6024102464105919, 'support': 523750}}
[[ 49184  52030  21971]
 [ 27434 218345  30874]
 [ 17679  52060  54173]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83677423
{'0': {'precision': 0.5313857321354197, 'recall': 0.4042914374957561, 'f1-score': 0.45920688990295006, 'support': 44181}, '1': {'precision': 0.6873820026274806, 'recall': 0.7853656596984065, 'f1-score': 0.7331143464261523, 'support': 100599}, '2': {'precision': 0.489509467066306, 'recall': 0.44829279178754744, 'f1-score': 0.46799538714224137, 'support': 44810}, 'accuracy': 0.616894350967878, 'macro avg': {'precision': 0.5694257339430688, 'recall': 0.5459832963272367, 'f1-score': 0.5534388744904478, 'support': 189590}, 'weighted avg': {'precision': 0.6042619037556732, 'recall': 0.616894350967878, 'f1-score': 0.6066230446583182, 'support': 189590}}
[[17862 17477  8842]
 [ 9485 79007 12107]
 [ 6267 18455 20088]]
testing model on single stock: results/universal/W6/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
29350/29350 - 231s - 231s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0121148
{'0': {'precision': 0.48192662405558934, 'recall': 0.519240495769711, 'f1-score': 0.4998882089593843, 'support': 2469453}, '1': {'precision': 0.565118177106325, 'recall': 0.4175932364775503, 'f1-score': 0.48028246198848445, 'support': 2535247}, '2': {'precision': 0.4786612954330641, 'recall': 0.568457594952603, 'f1-score': 0.5197091778156339, 'support': 2508699}, 'accuracy': 0.5013750767129498, 'macro avg': {'precision': 0.5085686988649928, 'recall': 0.5017637757332881, 'f1-score': 0.4999599495878342, 'support': 7513399}, 'weighted avg': {'precision': 0.5089076759932302, 'recall': 0.5013750767129498, 'f1-score': 0.4998907954795427, 'support': 7513399}}
[[1282240  395349  791864]
 [ 715170 1058702  761375]
 [ 663244  419366 1426089]]
Evaluating performance on  train set...
5452/5452 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98285276
{'0': {'precision': 0.5010148423317421, 'recall': 0.5176908631039611, 'f1-score': 0.5092163610562699, 'support': 460605}, '1': {'precision': 0.6266957672631016, 'recall': 0.41429541931589453, 'f1-score': 0.4988268662196982, 'support': 475453}, '2': {'precision': 0.46408856210500227, 'recall': 0.6113818660688048, 'f1-score': 0.5276487826871055, 'support': 459415}, 'accuracy': 0.5133076741721266, 'macro avg': {'precision': 0.5305997238999486, 'recall': 0.5144560494962201, 'f1-score': 0.5118973366543579, 'support': 1395473}, 'weighted avg': {'precision': 0.5316789152095562, 'recall': 0.5133076741721266, 'f1-score': 0.5117448331191459, 'support': 1395473}}
[[238451  58283 163871]
 [117999 196978 160476]
 [119486  59051 280878]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9744864
{'0': {'precision': 0.4865468460420528, 'recall': 0.48766195150308367, 'f1-score': 0.4871037605827919, 'support': 149659}, '1': {'precision': 0.64220058863482, 'recall': 0.4814231127317868, 'f1-score': 0.5503091577771679, 'support': 206224}, '2': {'precision': 0.44509563081242326, 'recall': 0.599146977641906, 'f1-score': 0.5107581318820403, 'support': 148179}, 'accuracy': 0.5178827207764124, 'macro avg': {'precision': 0.5246143551630987, 'recall': 0.5227440139589256, 'f1-score': 0.5160570167473334, 'support': 504062}, 'weighted avg': {'precision': 0.5380431655244569, 'recall': 0.5178827207764124, 'f1-score': 0.519916293397732, 'support': 504062}}
[[72983 28331 48345]
 [44604 99281 62339]
 [32415 26983 88781]]
training model: results/universal/W6/deepOF_L2/h20
Epoch 1/50
9426/9426 - 213s - loss: 2.8271 - accuracy20: 0.5330 - val_loss: 2.9798 - val_accuracy20: 0.5280 - 213s/epoch - 23ms/step
Epoch 2/50
9426/9426 - 206s - loss: 2.7463 - accuracy20: 0.5511 - val_loss: 2.9519 - val_accuracy20: 0.5309 - 206s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 209s - loss: 2.7266 - accuracy20: 0.5553 - val_loss: 2.9315 - val_accuracy20: 0.5323 - 209s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 208s - loss: 2.7155 - accuracy20: 0.5576 - val_loss: 2.9287 - val_accuracy20: 0.5329 - 208s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 208s - loss: 2.7075 - accuracy20: 0.5591 - val_loss: 2.9312 - val_accuracy20: 0.5324 - 208s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 208s - loss: 2.7011 - accuracy20: 0.5603 - val_loss: 2.9210 - val_accuracy20: 0.5322 - 208s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 212s - loss: 2.6961 - accuracy20: 0.5614 - val_loss: 2.9108 - val_accuracy20: 0.5336 - 212s/epoch - 23ms/step
Epoch 8/50
9426/9426 - 209s - loss: 2.6917 - accuracy20: 0.5622 - val_loss: 2.9002 - val_accuracy20: 0.5350 - 209s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 208s - loss: 2.6879 - accuracy20: 0.5630 - val_loss: 2.8879 - val_accuracy20: 0.5350 - 208s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 209s - loss: 2.6841 - accuracy20: 0.5639 - val_loss: 2.8762 - val_accuracy20: 0.5356 - 209s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 208s - loss: 2.6808 - accuracy20: 0.5645 - val_loss: 2.8729 - val_accuracy20: 0.5354 - 208s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 207s - loss: 2.6780 - accuracy20: 0.5650 - val_loss: 2.8789 - val_accuracy20: 0.5361 - 207s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 208s - loss: 2.6752 - accuracy20: 0.5655 - val_loss: 2.8687 - val_accuracy20: 0.5374 - 208s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 210s - loss: 2.6727 - accuracy20: 0.5659 - val_loss: 2.8591 - val_accuracy20: 0.5373 - 210s/epoch - 22ms/step
Epoch 15/50
9426/9426 - 209s - loss: 2.6700 - accuracy20: 0.5665 - val_loss: 2.8637 - val_accuracy20: 0.5358 - 209s/epoch - 22ms/step
Epoch 16/50
9426/9426 - 209s - loss: 2.6679 - accuracy20: 0.5670 - val_loss: 2.8593 - val_accuracy20: 0.5371 - 209s/epoch - 22ms/step
Epoch 17/50
9426/9426 - 207s - loss: 2.6657 - accuracy20: 0.5676 - val_loss: 2.8670 - val_accuracy20: 0.5358 - 207s/epoch - 22ms/step
Epoch 18/50
9426/9426 - 208s - loss: 2.6639 - accuracy20: 0.5679 - val_loss: 2.8636 - val_accuracy20: 0.5358 - 208s/epoch - 22ms/step
Epoch 19/50
9426/9426 - 208s - loss: 2.6616 - accuracy20: 0.5685 - val_loss: 2.8552 - val_accuracy20: 0.5356 - 208s/epoch - 22ms/step
Epoch 20/50
9426/9426 - 208s - loss: 2.6596 - accuracy20: 0.5687 - val_loss: 2.8613 - val_accuracy20: 0.5370 - 208s/epoch - 22ms/step
Epoch 21/50
9426/9426 - 209s - loss: 2.6584 - accuracy20: 0.5689 - val_loss: 2.8568 - val_accuracy20: 0.5362 - 209s/epoch - 22ms/step
Epoch 22/50
9426/9426 - 210s - loss: 2.6561 - accuracy20: 0.5695 - val_loss: 2.8578 - val_accuracy20: 0.5375 - 210s/epoch - 22ms/step
Epoch 23/50
9426/9426 - 207s - loss: 2.6545 - accuracy20: 0.5700 - val_loss: 2.8577 - val_accuracy20: 0.5362 - 207s/epoch - 22ms/step
Epoch 24/50
9426/9426 - 209s - loss: 2.6536 - accuracy20: 0.5699 - val_loss: 2.8625 - val_accuracy20: 0.5373 - 209s/epoch - 22ms/step
Epoch 25/50
9426/9426 - 209s - loss: 2.6520 - accuracy20: 0.5701 - val_loss: 2.8531 - val_accuracy20: 0.5379 - 209s/epoch - 22ms/step
Epoch 26/50
9426/9426 - 207s - loss: 2.6505 - accuracy20: 0.5706 - val_loss: 2.8577 - val_accuracy20: 0.5363 - 207s/epoch - 22ms/step
Epoch 27/50
9426/9426 - 208s - loss: 2.6492 - accuracy20: 0.5707 - val_loss: 2.8621 - val_accuracy20: 0.5352 - 208s/epoch - 22ms/step
Epoch 28/50
9426/9426 - 208s - loss: 2.6478 - accuracy20: 0.5710 - val_loss: 2.8692 - val_accuracy20: 0.5340 - 208s/epoch - 22ms/step
Epoch 29/50
9426/9426 - 208s - loss: 2.6461 - accuracy20: 0.5717 - val_loss: 2.8659 - val_accuracy20: 0.5344 - 208s/epoch - 22ms/step
Epoch 30/50
9426/9426 - 208s - loss: 2.6458 - accuracy20: 0.5717 - val_loss: 2.8629 - val_accuracy20: 0.5346 - 208s/epoch - 22ms/step
Epoch 31/50
9426/9426 - 209s - loss: 2.6445 - accuracy20: 0.5719 - val_loss: 2.8662 - val_accuracy20: 0.5328 - 209s/epoch - 22ms/step
Epoch 32/50
9426/9426 - 209s - loss: 2.6429 - accuracy20: 0.5722 - val_loss: 2.8634 - val_accuracy20: 0.5347 - 209s/epoch - 22ms/step
Epoch 33/50
9426/9426 - 210s - loss: 2.6413 - accuracy20: 0.5725 - val_loss: 2.8604 - val_accuracy20: 0.5345 - 210s/epoch - 22ms/step
Epoch 34/50
9426/9426 - 209s - loss: 2.6410 - accuracy20: 0.5727 - val_loss: 2.8610 - val_accuracy20: 0.5336 - 209s/epoch - 22ms/step
Epoch 35/50
9426/9426 - 209s - loss: 2.6391 - accuracy20: 0.5732 - val_loss: 2.8661 - val_accuracy20: 0.5327 - 209s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 327s - 327s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0322402
{'0': {'precision': 0.4399501697056033, 'recall': 0.48571086557459303, 'f1-score': 0.4616994117565172, 'support': 3141058}, '1': {'precision': 0.6266189641426833, 'recall': 0.47190125572116465, 'f1-score': 0.5383647395662455, 'support': 4556983}, '2': {'precision': 0.42128751904179884, 'recall': 0.5290808100974087, 'f1-score': 0.46907106439552515, 'support': 3120563}, 'accuracy': 0.49240382585405656, 'macro avg': {'precision': 0.49595221763002845, 'recall': 0.49556431046438876, 'f1-score': 0.4897117385727627, 'support': 10818604}, 'weighted avg': {'precision': 0.5131951600700603, 'recall': 0.49240382585405656, 'f1-score': 0.49611848301492534, 'support': 10818604}}
[[1525646  627333  988079]
 [1126636 2150446 1279901]
 [ 815488  654045 1651030]]
Evaluating performance on  train set...
9426/9426 - 75s - 75s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9535218
{'0': {'precision': 0.46751635429399246, 'recall': 0.47593007581169205, 'f1-score': 0.47168569797316584, 'support': 694352}, '1': {'precision': 0.687618094328751, 'recall': 0.5666816502481067, 'f1-score': 0.6213196775641986, 'support': 1025567}, '2': {'precision': 0.43996795903965474, 'recall': 0.5466616397335725, 'f1-score': 0.4875458960848224, 'support': 692271}, 'accuracy': 0.5348131780664044, 'macro avg': {'precision': 0.5317008025541328, 'recall': 0.5297577885977903, 'f1-score': 0.5268504238740623, 'support': 2412190}, 'weighted avg': {'precision': 0.5531887623924887, 'recall': 0.5348131780664044, 'f1-score': 0.5398557951687397, 'support': 2412190}}
[[330463 133295 230594]
 [193280 581170 251117]
 [183105 130728 378438]]
Evaluating performance on  val set...
3323/3323 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9509095
{'0': {'precision': 0.4569885328474976, 'recall': 0.46289590009466, 'f1-score': 0.459923248334135, 'support': 230298}, '1': {'precision': 0.6860308659255714, 'recall': 0.5828465771921928, 'f1-score': 0.6302432819208142, 'support': 391024}, '2': {'precision': 0.42970099574456133, 'recall': 0.5344839633848089, 'f1-score': 0.47639882597491573, 'support': 228976}, 'accuracy': 0.5373351460311562, 'macro avg': {'precision': 0.5242401315058768, 'recall': 0.5267421468905539, 'f1-score': 0.5221884520766217, 'support': 850298}, 'weighted avg': {'precision': 0.5549693091798409, 'recall': 0.5373351460311562, 'f1-score': 0.5426845069506119, 'support': 850298}}
[[106604  52700  70994]
 [ 71683 227907  91434]
 [ 54988  51604 122384]]
testing model out of sample: results/universal/W6/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 133s - 133s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90159
{'0': {'precision': 0.5125391581562102, 'recall': 0.4112821746063513, 'f1-score': 0.4563614457939209, 'support': 1239176}, '1': {'precision': 0.6553945836399302, 'recall': 0.7422048668340222, 'f1-score': 0.6961036647649709, 'support': 2011287}, '2': {'precision': 0.4911541958730847, 'recall': 0.4825639551129668, 'f1-score': 0.4868211835033149, 'support': 1234655}, 'accuracy': 0.5793020384302041, 'macro avg': {'precision': 0.5530293125564084, 'recall': 0.5453503321844467, 'f1-score': 0.5464287646874022, 'support': 4485118}, 'weighted avg': {'precision': 0.5707138170051418, 'recall': 0.5793020384302041, 'f1-score': 0.572255314322958, 'support': 4485118}}
[[ 509651  404334  325191]
 [ 226430 1492787  292070]
 [ 258284  380571  595800]]
Evaluating performance on  train set...
5152/5152 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9066887
{'0': {'precision': 0.5036327489607808, 'recall': 0.40326945508117196, 'f1-score': 0.44789769686137293, 'support': 345501}, '1': {'precision': 0.6655992720975624, 'recall': 0.7216623122038461, 'f1-score': 0.6924979616515661, 'support': 628474}, '2': {'precision': 0.46419359312161973, 'recall': 0.48562972420096623, 'f1-score': 0.4746697675078171, 'support': 344635}, 'accuracy': 0.5765472732650291, 'macro avg': {'precision': 0.5444752047266542, 'recall': 0.5368538304953281, 'f1-score': 0.5383551420069187, 'support': 1318610}, 'weighted avg': {'precision': 0.5705210898570552, 'recall': 0.5765472732650291, 'f1-score': 0.5714759340816195, 'support': 1318610}}
[[139330 117580  88591]
 [ 70334 453546 104594]
 [ 66986 110284 167365]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8893734
{'0': {'precision': 0.5051602669742914, 'recall': 0.4152274035693725, 'f1-score': 0.4558000780654635, 'support': 118116}, '1': {'precision': 0.6835025670762419, 'recall': 0.7245606242119952, 'f1-score': 0.7034329847059899, 'support': 222873}, '2': {'precision': 0.46374860602198503, 'recall': 0.49379983036471586, 'f1-score': 0.47830266184686165, 'support': 117900}, 'accuracy': 0.5856514320456581, 'macro avg': {'precision': 0.5508038133575062, 'recall': 0.5445292860486944, 'f1-score': 0.5458452415394383, 'support': 458889}, 'weighted avg': {'precision': 0.5811377879528834, 'recall': 0.5856514320456581, 'f1-score': 0.5818517886741748, 'support': 458889}}
[[ 49045  38318  30753]
 [ 24820 161485  36568]
 [ 23223  36458  58219]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0832641
{'0': {'precision': 0.43747131906793346, 'recall': 0.5323688183830069, 'f1-score': 0.48027727501725975, 'support': 96698}, '1': {'precision': 0.4874391059317986, 'recall': 0.1421013060065161, 'f1-score': 0.22005174644243203, 'support': 71822}, '2': {'precision': 0.44976217440543603, 'recall': 0.5809424430964872, 'f1-score': 0.5070044937700007, 'support': 102542}, 'accuracy': 0.447336771661096, 'macro avg': {'precision': 0.4582241998017227, 'recall': 0.4184708558286701, 'f1-score': 0.40244450507656415, 'support': 271062}, 'weighted avg': {'precision': 0.45536064061117715, 'recall': 0.447336771661096, 'f1-score': 0.4214373954031577, 'support': 271062}}
[[51479  5073 40146]
 [28883 10206 32733]
 [37312  5659 59571]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1027833
{'0': {'precision': 0.4437714408233276, 'recall': 0.45257748865686326, 'f1-score': 0.4481312078811334, 'support': 18293}, '1': {'precision': 0.5453983940704138, 'recall': 0.23968512486427795, 'f1-score': 0.333019045823119, 'support': 18420}, '2': {'precision': 0.39010585122022934, 'recall': 0.6154470601878697, 'f1-score': 0.47752733162370087, 'support': 17246}, 'accuracy': 0.4319575974350896, 'macro avg': {'precision': 0.45975856203799026, 'recall': 0.4359032245696703, 'f1-score': 0.4195591951093178, 'support': 53959}, 'weighted avg': {'precision': 0.46131164209681846, 'recall': 0.4319575974350896, 'f1-score': 0.41823071908326265, 'support': 53959}}
[[ 8279  1901  8113]
 [ 5524  4415  8481]
 [ 4853  1779 10614]]
Evaluating performance on  val set...
81/81 - 1s - 845ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0848472
{'0': {'precision': 0.439366398338094, 'recall': 0.4805452996307867, 'f1-score': 0.45903418339663593, 'support': 7042}, '1': {'precision': 0.5583214793741109, 'recall': 0.2367310012062726, 'f1-score': 0.33248623464633625, 'support': 6632}, '2': {'precision': 0.42195218336297174, 'recall': 0.6134731399023269, 'f1-score': 0.5, 'support': 6962}, 'accuracy': 0.4470343089746075, 'macro avg': {'precision': 0.47321335369172557, 'recall': 0.4435831469131288, 'f1-score': 0.43050680601432406, 'support': 20636}, 'weighted avg': {'precision': 0.4717211343709523, 'recall': 0.4470343089746075, 'f1-score': 0.4321848918227182, 'support': 20636}}
[[3384  626 3032]
 [2243 1570 2819]
 [2075  616 4271]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64677984
{'0': {'precision': 0.5737001798022175, 'recall': 0.34133811763132677, 'f1-score': 0.42801648850695173, 'support': 89738}, '1': {'precision': 0.7962738227905484, 'recall': 0.8902970851130106, 'f1-score': 0.8406646409707388, 'support': 378814}, '2': {'precision': 0.5237857820366272, 'recall': 0.47532499061996514, 'f1-score': 0.4983801170943929, 'support': 90618}, 'accuracy': 0.7349482268362036, 'macro avg': {'precision': 0.6312532615431311, 'recall': 0.5689867311214342, 'f1-score': 0.5890204155240278, 'support': 559170}, 'weighted avg': {'precision': 0.7163953692763654, 'recall': 0.7349482268362036, 'f1-score': 0.7189711329312838, 'support': 559170}}
[[ 30631  46296  12811]
 [ 15207 337257  26350]
 [  7554  39991  43073]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5779329
{'0': {'precision': 0.5767276422764228, 'recall': 0.3748555072383993, 'f1-score': 0.45437864887406165, 'support': 18167}, '1': {'precision': 0.8486641818647396, 'recall': 0.894902643185023, 'f1-score': 0.8711703028709951, 'support': 99993}, '2': {'precision': 0.4879087372516034, 'recall': 0.5124509966318812, 'f1-score': 0.4998788139929443, 'support': 18111}, 'accuracy': 0.7747429753946181, 'macro avg': {'precision': 0.6377668537975886, 'recall': 0.5940697156851011, 'f1-score': 0.608475921912667, 'support': 136271}, 'weighted avg': {'precision': 0.7644649540606618, 'recall': 0.7747429753946181, 'f1-score': 0.7662593964181719, 'support': 136271}}
[[ 6810  8822  2535]
 [ 3303 89484  7206]
 [ 1695  7135  9281]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5787743
{'0': {'precision': 0.6083620005292405, 'recall': 0.3610238693467337, 'f1-score': 0.4531388587759929, 'support': 6368}, '1': {'precision': 0.8420387096774193, 'recall': 0.9122399910534557, 'f1-score': 0.8757347218121797, 'support': 35768}, '2': {'precision': 0.49312411847672777, 'recall': 0.4611706512778236, 'f1-score': 0.4766124222544091, 'support': 6065}, 'accuracy': 0.7826601107860833, 'macro avg': {'precision': 0.6478416095611292, 'recall': 0.5781448372260043, 'f1-score': 0.6018286676141938, 'support': 48201}, 'weighted avg': {'precision': 0.7672639066756601, 'recall': 0.7826601107860833, 'f1-score': 0.7696836605762652, 'support': 48201}}
[[ 2299  3281   788]
 [ 1052 32629  2087]
 [  428  2840  2797]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0971237
{'0': {'precision': 0.4867094973213736, 'recall': 0.4295224207732925, 'f1-score': 0.45633127895731995, 'support': 110411}, '1': {'precision': 0.45987988052287304, 'recall': 0.47600895370226726, 'f1-score': 0.4678054331904884, 'support': 90242}, '2': {'precision': 0.4516341668961259, 'recall': 0.49188923926971345, 'f1-score': 0.4709029692978259, 'support': 110039}, 'accuracy': 0.4651133598547758, 'macro avg': {'precision': 0.4660745149134575, 'recall': 0.4658068712484244, 'f1-score': 0.46501322714854476, 'support': 310692}, 'weighted avg': {'precision': 0.46649393797709016, 'recall': 0.4651133598547758, 'f1-score': 0.4648249152906936, 'support': 310692}}
[[47424 23824 39163]
 [20729 42956 26557]
 [29285 26627 54127]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0939894
{'0': {'precision': 0.4561105608226027, 'recall': 0.44776810520466753, 'f1-score': 0.4519008341706195, 'support': 43192}, '1': {'precision': 0.4996804326450344, 'recall': 0.4448992098754624, 'f1-score': 0.47070129328810106, 'support': 45689}, '2': {'precision': 0.42447470654580394, 'recall': 0.48297250409943204, 'f1-score': 0.45183810042575895, 'support': 42079}, 'accuracy': 0.4580788026878436, 'macro avg': {'precision': 0.460088566671147, 'recall': 0.45854660639318734, 'f1-score': 0.45814674262815985, 'support': 130960}, 'weighted avg': {'precision': 0.4611461347503797, 'recall': 0.4580788026878436, 'f1-score': 0.4584397346239536, 'support': 130960}}
[[19340 10062 13790]
 [11597 20327 13765]
 [11465 10291 20323]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0878175
{'0': {'precision': 0.45056267251751714, 'recall': 0.4517777304662551, 'f1-score': 0.451169383416017, 'support': 14091}, '1': {'precision': 0.5009253547193091, 'recall': 0.44356435643564357, 'f1-score': 0.47050302393800025, 'support': 14645}, '2': {'precision': 0.43927970590067916, 'recall': 0.4892435808466343, 'f1-score': 0.46291736432581504, 'support': 14410}, 'accuracy': 0.46150280443146524, 'macro avg': {'precision': 0.4635892443791685, 'recall': 0.46152855591617764, 'f1-score': 0.46152992389327746, 'support': 43146}, 'weighted avg': {'precision': 0.46388891207382843, 'recall': 0.46150280443146524, 'f1-score': 0.46165539765498775, 'support': 43146}}
[[6366 3239 4486]
 [3636 6496 4513]
 [4127 3233 7050]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1943243
{'0': {'precision': 0.3815728210750815, 'recall': 0.5008970820189275, 'f1-score': 0.4331676626797726, 'support': 101440}, '1': {'precision': 0.40476190476190477, 'recall': 0.0013832946824525, 'f1-score': 0.0027571666058468147, 'support': 73737}, '2': {'precision': 0.3982545851230654, 'recall': 0.556797925781883, 'f1-score': 0.46436677438716584, 'support': 104907}, 'accuracy': 0.39032932977249685, 'macro avg': {'precision': 0.39486310365335053, 'recall': 0.35302610082775426, 'f1-score': 0.30009720122426176, 'support': 280084}, 'weighted avg': {'precision': 0.3939259982819092, 'recall': 0.39032932977249685, 'f1-score': 0.33154038822955206, 'support': 280084}}
[[50811    61 50568]
 [35945   102 37690]
 [46406    89 58412]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.267028
{'0': {'precision': 0.3881117308384311, 'recall': 0.4389195513391154, 'f1-score': 0.41195497785894175, 'support': 39317}, '1': {'precision': 0.5212527964205816, 'recall': 0.006243468474503604, 'f1-score': 0.01233914102631997, 'support': 37319}, '2': {'precision': 0.34372308045712974, 'recall': 0.6312389590529175, 'f1-score': 0.445086866395858, 'support': 37927}, 'accuracy': 0.3616438117018584, 'macro avg': {'precision': 0.4176958692387142, 'recall': 0.35880065962217883, 'f1-score': 0.2897936617603732, 'support': 114563}, 'weighted avg': {'precision': 0.41678733363731607, 'recall': 0.3616438117018584, 'f1-score': 0.29274833803441735, 'support': 114563}}
[[17257    72 21988]
 [13363   233 23723]
 [13844   142 23941]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2417463
{'0': {'precision': 0.3786471280910637, 'recall': 0.4743095960009834, 'f1-score': 0.42111390010549676, 'support': 12203}, '1': {'precision': 0.5179856115107914, 'recall': 0.0068473609129814554, 'f1-score': 0.01351605030974282, 'support': 10515}, '2': {'precision': 0.35983047343394664, 'recall': 0.5775197013687267, 'f1-score': 0.4433971276629621, 'support': 12055}, 'accuracy': 0.3687343628677422, 'macro avg': {'precision': 0.41882107101193394, 'recall': 0.3528922194275638, 'f1-score': 0.2926756926927339, 'support': 34773}, 'weighted avg': {'precision': 0.41425836040541364, 'recall': 0.3687343628677422, 'f1-score': 0.30558555678173677, 'support': 34773}}
[[5788   24 6391]
 [4448   72 5995]
 [5050   43 6962]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1050493
{'0': {'precision': 0.42876886117634355, 'recall': 0.4914850431317219, 'f1-score': 0.4579898683227951, 'support': 161598}, '1': {'precision': 0.4697856717602699, 'recall': 0.16605434601523933, 'f1-score': 0.2453760389740799, 'support': 114047}, '2': {'precision': 0.4273323205433758, 'recall': 0.5569637115574421, 'f1-score': 0.4836118150558892, 'support': 165149}, 'accuracy': 0.4318184911772846, 'macro avg': {'precision': 0.44196228449332975, 'recall': 0.40483436690146773, 'f1-score': 0.39565924078425474, 'support': 440794}, 'weighted avg': {'precision': 0.4388429568937786, 'recall': 0.4318184911772846, 'f1-score': 0.4125796982326642, 'support': 440794}}
[[79423 10549 71626]
 [43470 18938 51639]
 [62342 10825 91982]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1396112
{'0': {'precision': 0.41211931546785696, 'recall': 0.47553072200999674, 'f1-score': 0.44156004588370246, 'support': 52617}, '1': {'precision': 0.5032042351629981, 'recall': 0.20581978422732108, 'f1-score': 0.29214634277857165, 'support': 52648}, '2': {'precision': 0.38916848292715145, 'recall': 0.5591891737999886, 'f1-score': 0.45893825160446133, 'support': 52687}, 'accuracy': 0.4135370239059968, 'macro avg': {'precision': 0.43483067785266877, 'recall': 0.4135132266791022, 'f1-score': 0.39754821342224517, 'support': 157952}, 'weighted avg': {'precision': 0.43482386076033586, 'recall': 0.4135370239059968, 'f1-score': 0.39755473340732167, 'support': 157952}}
[[25021  5093 22503]
 [18072 10836 23740]
 [17620  5605 29462]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1321392
{'0': {'precision': 0.41631660402387793, 'recall': 0.4971748429001426, 'f1-score': 0.453167115902965, 'support': 18937}, '1': {'precision': 0.5145663956639567, 'recall': 0.22876506024096385, 'f1-score': 0.3167222685571309, 'support': 19920}, '2': {'precision': 0.39285439285439283, 'recall': 0.548956315902733, 'f1-score': 0.45796867286028453, 'support': 18588}, 'accuracy': 0.42085473061188966, 'macro avg': {'precision': 0.44124579751407583, 'recall': 0.4249654063479465, 'f1-score': 0.40928601910679346, 'support': 57445}, 'weighted avg': {'precision': 0.4427944570703046, 'recall': 0.42085473061188966, 'f1-score': 0.40740630089023355, 'support': 57445}}
[[ 9415  2117  7405]
 [ 6998  4557  8365]
 [ 6202  2182 10204]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/EXC
Evaluating performance on  test set...
4450/4450 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73435
{'0': {'precision': 0.5698875252645865, 'recall': 0.39523328620480713, 'f1-score': 0.46675714936562723, 'support': 247550}, '1': {'precision': 0.7333965614331942, 'recall': 0.8416848849542198, 'f1-score': 0.7838182614004169, 'support': 646786}, '2': {'precision': 0.5564497861397221, 'recall': 0.5118187760437944, 'f1-score': 0.5332019654116491, 'support': 244780}, 'accuracy': 0.6737794921676107, 'macro avg': {'precision': 0.6199112909458342, 'recall': 0.5829123157342738, 'f1-score': 0.5945924587258977, 'support': 1139116}, 'weighted avg': {'precision': 0.659839791481868, 'recall': 0.6737794921676107, 'f1-score': 0.6610613734132911, 'support': 1139116}}
[[ 97840 106851  42859]
 [ 45391 544390  57005]
 [ 28452  91045 125283]]
Evaluating performance on  train set...
1504/1504 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65970117
{'0': {'precision': 0.5704419321685509, 'recall': 0.3954121250979554, 'f1-score': 0.46706778306054614, 'support': 70185}, '1': {'precision': 0.7699493321050207, 'recall': 0.8558619446697305, 'f1-score': 0.8106357018015204, 'support': 244134}, '2': {'precision': 0.5375117682465699, 'recall': 0.49400700719159135, 'f1-score': 0.514841971439553, 'support': 70499}, 'accuracy': 0.7055906948219678, 'macro avg': {'precision': 0.6259676775067139, 'recall': 0.5817603589864258, 'f1-score': 0.5975151521005398, 'support': 384818}, 'weighted avg': {'precision': 0.690979422488012, 'recall': 0.7055906948219678, 'f1-score': 0.6937844199653703, 'support': 384818}}
[[ 27752  33507   8926]
 [ 14149 208945  21040]
 [  6749  28923  34827]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66734076
{'0': {'precision': 0.569357675744526, 'recall': 0.40099961553248753, 'f1-score': 0.4705734910767997, 'support': 23409}, '1': {'precision': 0.76816214985197, 'recall': 0.8517984054258811, 'f1-score': 0.8078212672779527, 'support': 83157}, '2': {'precision': 0.5312886810617522, 'recall': 0.48398413029860093, 'f1-score': 0.5065343765024695, 'support': 23945}, 'accuracy': 0.7034579460735111, 'macro avg': {'precision': 0.6229361688860827, 'recall': 0.5789273837523232, 'f1-score': 0.5949763782857406, 'support': 130511}, 'weighted avg': {'precision': 0.6890443042714217, 'recall': 0.7034579460735111, 'f1-score': 0.6920536477461757, 'support': 130511}}
[[ 9387 11272  2750]
 [ 4850 70833  7474]
 [ 2250 10106 11589]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/AAL
Evaluating performance on  test set...
6203/6203 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66178894
{'0': {'precision': 0.5606823451473998, 'recall': 0.3831140417056463, 'f1-score': 0.4551941125323819, 'support': 265096}, '1': {'precision': 0.7840828239366044, 'recall': 0.8801831122055516, 'f1-score': 0.8293583918435604, 'support': 1054217}, '2': {'precision': 0.5223127320277828, 'recall': 0.43430048109146696, 'f1-score': 0.4742578665837161, 'support': 268556}, 'accuracy': 0.7217849835219404, 'macro avg': {'precision': 0.6223593003705957, 'recall': 0.5658658783342216, 'f1-score': 0.5862701236532194, 'support': 1587869}, 'weighted avg': {'precision': 0.7025128064302683, 'recall': 0.7217849835219404, 'f1-score': 0.7068332777126347, 'support': 1587869}}
[[101562 128743  34791]
 [ 54435 927904  71878]
 [ 25143 126779 116634]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68627197
{'0': {'precision': 0.6003727661440631, 'recall': 0.3520320917494889, 'f1-score': 0.44382486910570423, 'support': 77777}, '1': {'precision': 0.7817421358291041, 'recall': 0.8584154835570005, 'f1-score': 0.8182866641753541, 'support': 295901}, '2': {'precision': 0.4876566700629749, 'recall': 0.5072722861411552, 'f1-score': 0.49727111133365043, 'support': 78311}, 'accuracy': 0.7104398558371996, 'macro avg': {'precision': 0.6232571906787141, 'recall': 0.5725732871492148, 'f1-score': 0.5864608815382363, 'support': 451989}, 'weighted avg': {'precision': 0.6995797549401781, 'recall': 0.7104398558371996, 'f1-score': 0.6982316097520853, 'support': 451989}}
[[ 27380  38457  11940]
 [ 12099 254006  29796]
 [  6126  32460  39725]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63904345
{'0': {'precision': 0.5878463037727969, 'recall': 0.3691641895436265, 'f1-score': 0.4535202191074593, 'support': 22876}, '1': {'precision': 0.8145426999005175, 'recall': 0.8660469088121415, 'f1-score': 0.8395055921888082, 'support': 103051}, '2': {'precision': 0.47160197191267245, 'recall': 0.5140663806728382, 'f1-score': 0.49191945380693114, 'support': 22145}, 'accuracy': 0.7366416337997731, 'macro avg': {'precision': 0.6246636585286623, 'recall': 0.5830924930095355, 'f1-score': 0.5949817550343995, 'support': 148072}, 'weighted avg': {'precision': 0.728231113786272, 'recall': 0.7366416337997731, 'f1-score': 0.727890321043179, 'support': 148072}}
[[ 8445 11278  3153]
 [ 4202 89247  9602]
 [ 1719  9042 11384]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/WBA
Evaluating performance on  test set...
5183/5183 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92708814
{'0': {'precision': 0.5557755090351958, 'recall': 0.4083754622785929, 'f1-score': 0.4708081766823242, 'support': 380182}, '1': {'precision': 0.6037933315842906, 'recall': 0.7542010183963197, 'f1-score': 0.6706678059275883, 'support': 561471}, '2': {'precision': 0.5039015216078718, 'recall': 0.4528352830609945, 'f1-score': 0.47700556110861186, 'support': 385182}, 'accuracy': 0.5676237060372993, 'macro avg': {'precision': 0.5544901207424527, 'recall': 0.538470587911969, 'f1-score': 0.5394938479061748, 'support': 1326835}, 'weighted avg': {'precision': 0.5610359133953696, 'recall': 0.5676237060372993, 'f1-score': 0.5571810164250609, 'support': 1326835}}
[[155257 134843  90082]
 [ 56368 423462  81641]
 [ 67727 143031 174424]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8958375
{'0': {'precision': 0.5425232211095925, 'recall': 0.38160450469893464, 'f1-score': 0.44805344390693386, 'support': 101938}, '1': {'precision': 0.6255321459109026, 'recall': 0.7780485059929098, 'f1-score': 0.6935039335521844, 'support': 177710}, '2': {'precision': 0.5132353607173589, 'recall': 0.44697634518867646, 'f1-score': 0.4778197648373309, 'support': 101417}, 'accuracy': 0.583884639103565, 'macro avg': {'precision': 0.5604302425792848, 'recall': 0.5355431186268403, 'f1-score': 0.5397923807654831, 'support': 381065}, 'weighted avg': {'precision': 0.5734398077524007, 'recall': 0.583884639103565, 'f1-score': 0.5704415338250726, 'support': 381065}}
[[ 38900  42573  20465]
 [ 16915 138267  22528]
 [ 15887  40199  45331]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86469424
{'0': {'precision': 0.5374748270729358, 'recall': 0.3732745515354211, 'f1-score': 0.4405727409746644, 'support': 32890}, '1': {'precision': 0.6544167391514448, 'recall': 0.8064972382271056, 'f1-score': 0.7225412323349539, 'support': 67167}, '2': {'precision': 0.5137286698853795, 'recall': 0.4263473420199425, 'f1-score': 0.465976900061845, 'support': 32694}, 'accuracy': 0.6055396946162365, 'macro avg': {'precision': 0.5685400787032534, 'recall': 0.5353730439274896, 'f1-score': 0.5430302911238211, 'support': 132751}, 'weighted avg': {'precision': 0.5907948061728089, 'recall': 0.6055396946162365, 'f1-score': 0.5894947169778044, 'support': 132751}}
[[12277 14683  5930]
 [ 5733 54170  7264]
 [ 4832 13923 13939]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
7324/7324 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9980973
{'0': {'precision': 0.5558870899381199, 'recall': 0.3791431068118334, 'f1-score': 0.4508105921034541, 'support': 605373}, '1': {'precision': 0.5243208088024754, 'recall': 0.7233621994863126, 'f1-score': 0.6079650856381855, 'support': 680959}, '2': {'precision': 0.522775264529246, 'recall': 0.46411010777250333, 'f1-score': 0.4916990182873688, 'support': 588369}, 'accuracy': 0.5308425183535934, 'macro avg': {'precision': 0.5343277210899472, 'recall': 0.5222051380235498, 'f1-score': 0.5168248986763361, 'support': 1874701}, 'weighted avg': {'precision': 0.5340290363925994, 'recall': 0.5308425183535934, 'f1-score': 0.520727474416058, 'support': 1874701}}
[[229523 236217 139633]
 [ 78737 492580 109642]
 [104635 210666 273068]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9601523
{'0': {'precision': 0.5438265614414151, 'recall': 0.3866633685279452, 'f1-score': 0.451972242512783, 'support': 153622}, '1': {'precision': 0.5729227437075335, 'recall': 0.7599158542462098, 'f1-score': 0.6533020230206485, 'support': 215816}, '2': {'precision': 0.5243043915521287, 'recall': 0.4358183420602416, 'f1-score': 0.4759838771891953, 'support': 154312}, 'accuracy': 0.5549479713603819, 'macro avg': {'precision': 0.547017898900359, 'recall': 0.5274658549447988, 'f1-score': 0.527086047574209, 'support': 523750}, 'weighted avg': {'precision': 0.5500641110203918, 'recall': 0.5549479713603819, 'f1-score': 0.5420065552197464, 'support': 523750}}
[[ 59400  62128  32094]
 [ 22891 164002  28923]
 [ 26935  60125  67252]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9451692
{'0': {'precision': 0.558656735920554, 'recall': 0.38747507703462025, 'f1-score': 0.45758013592336916, 'support': 55170}, '1': {'precision': 0.5842965402978344, 'recall': 0.7580286168521463, 'f1-score': 0.6599198352414908, 'support': 78625}, '2': {'precision': 0.5115161591176351, 'recall': 0.45217313379335067, 'f1-score': 0.48001750430472717, 'support': 55795}, 'accuracy': 0.560187773616752, 'macro avg': {'precision': 0.5514898117786745, 'recall': 0.5325589425600391, 'f1-score': 0.532505825156529, 'support': 189590}, 'weighted avg': {'precision': 0.5554166976086431, 'recall': 0.560187773616752, 'f1-score': 0.5480957318288767, 'support': 189590}}
[[21377 21051 12742]
 [ 7674 59600 11351]
 [ 9214 21352 25229]]
testing model on single stock: results/universal/W6/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
29350/29350 - 226s - 226s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1185968
{'0': {'precision': 0.4208664373457428, 'recall': 0.5129268246468356, 'f1-score': 0.4623586271066796, 'support': 2322148}, '1': {'precision': 0.5403577926403444, 'recall': 0.2918535654786054, 'f1-score': 0.3790031147200283, 'support': 2896175}, '2': {'precision': 0.40071932251079334, 'recall': 0.5445841444902042, 'f1-score': 0.46170440932066176, 'support': 2295076}, 'accuracy': 0.4373803387787604, 'macro avg': {'precision': 0.4539811841656269, 'recall': 0.44978817820521505, 'f1-score': 0.43435538371578986, 'support': 7513399}, 'weighted avg': {'precision': 0.46077230633971034, 'recall': 0.4373803387787604, 'f1-score': 0.43002790293964516, 'support': 7513399}}
[[1191092  339299  791757]
 [ 973489  845259 1077427]
 [ 665514  379700 1249862]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0611442
{'0': {'precision': 0.4522523440684876, 'recall': 0.515605331956234, 'f1-score': 0.48185539210511236, 'support': 464745}, '1': {'precision': 0.5843034202396232, 'recall': 0.3093966480207371, 'f1-score': 0.4045686602689723, 'support': 466411}, '2': {'precision': 0.42840909458275545, 'recall': 0.5708104592336701, 'f1-score': 0.4894627833986321, 'support': 464317}, 'accuracy': 0.465052351424929, 'macro avg': {'precision': 0.4883216196302888, 'recall': 0.46527081307021373, 'f1-score': 0.45862894525757225, 'support': 1395473}, 'weighted avg': {'precision': 0.488454584037723, 'recall': 0.465052351424929, 'f1-score': 0.4585549478978846, 'support': 1395473}}
[[239625  48205 176915]
 [145403 144306 176702]
 [144820  54460 265037]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0626214
{'0': {'precision': 0.43978967724955514, 'recall': 0.4945440975885941, 'f1-score': 0.4655625107886871, 'support': 155428}, '1': {'precision': 0.5926578882993531, 'recall': 0.36138300663007866, 'f1-score': 0.4489880689915199, 'support': 194417}, '2': {'precision': 0.4131511763645164, 'recall': 0.5645616242048542, 'f1-score': 0.4771325465610452, 'support': 154217}, 'accuracy': 0.4646055445560268, 'macro avg': {'precision': 0.48186624730447486, 'recall': 0.47349624280784236, 'f1-score': 0.46389437544708406, 'support': 504062}, 'weighted avg': {'precision': 0.4906010244581933, 'recall': 0.4646055445560268, 'f1-score': 0.4627095739591421, 'support': 504062}}
[[76866 23510 55052]
 [55541 70259 68617]
 [42372 24780 87065]]
training model: results/universal/W6/deepOF_L2/h30
Epoch 1/50
9426/9426 - 211s - loss: 2.9188 - accuracy30: 0.5082 - val_loss: 3.0560 - val_accuracy30: 0.4934 - 211s/epoch - 22ms/step
Epoch 2/50
9426/9426 - 207s - loss: 2.8407 - accuracy30: 0.5266 - val_loss: 3.0512 - val_accuracy30: 0.4968 - 207s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 208s - loss: 2.8224 - accuracy30: 0.5304 - val_loss: 3.0486 - val_accuracy30: 0.4999 - 208s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 207s - loss: 2.8126 - accuracy30: 0.5325 - val_loss: 3.0454 - val_accuracy30: 0.4999 - 207s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 207s - loss: 2.8052 - accuracy30: 0.5344 - val_loss: 3.0473 - val_accuracy30: 0.5013 - 207s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 206s - loss: 2.7998 - accuracy30: 0.5355 - val_loss: 3.0592 - val_accuracy30: 0.5019 - 206s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 207s - loss: 2.7949 - accuracy30: 0.5365 - val_loss: 3.0637 - val_accuracy30: 0.5029 - 207s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 206s - loss: 2.7911 - accuracy30: 0.5375 - val_loss: 3.0545 - val_accuracy30: 0.5032 - 206s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 209s - loss: 2.7875 - accuracy30: 0.5384 - val_loss: 3.0701 - val_accuracy30: 0.5022 - 209s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 207s - loss: 2.7841 - accuracy30: 0.5388 - val_loss: 3.0591 - val_accuracy30: 0.5039 - 207s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 208s - loss: 2.7811 - accuracy30: 0.5394 - val_loss: 3.0684 - val_accuracy30: 0.5021 - 208s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 208s - loss: 2.7784 - accuracy30: 0.5401 - val_loss: 3.0753 - val_accuracy30: 0.5027 - 208s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 208s - loss: 2.7757 - accuracy30: 0.5408 - val_loss: 3.0550 - val_accuracy30: 0.5041 - 208s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 207s - loss: 2.7735 - accuracy30: 0.5411 - val_loss: 3.0601 - val_accuracy30: 0.5026 - 207s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 315s - 315s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1072885
{'0': {'precision': 0.39611915480472853, 'recall': 0.5006566797747415, 'f1-score': 0.4422949263183733, 'support': 3134709}, '1': {'precision': 0.5515964876375049, 'recall': 0.44408295521384755, 'f1-score': 0.4920350622368159, 'support': 4569984}, '2': {'precision': 0.40265292460909063, 'recall': 0.4108624170697236, 'f1-score': 0.40671624828533326, 'support': 3113911}, 'accuracy': 0.4509134450248849, 'macro avg': {'precision': 0.4501228556837747, 'recall': 0.4518673506861042, 'f1-score': 0.44701541228017416, 'support': 10818604}, 'weighted avg': {'precision': 0.4636763462014867, 'recall': 0.4509134450248849, 'f1-score': 0.4530655200486333, 'support': 10818604}}
[[1569413  782813  782483]
 [1425005 2029452 1115527]
 [ 967554  866968 1279389]]
Evaluating performance on  train set...
9426/9426 - 75s - 75s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0264188
{'0': {'precision': 0.4354780025214135, 'recall': 0.5164603963797572, 'f1-score': 0.4725245710362898, 'support': 727686}, '1': {'precision': 0.6067875971805696, 'recall': 0.5299594909519365, 'f1-score': 0.5657772946593709, 'support': 959045}, '2': {'precision': 0.43809990921432446, 'recall': 0.4297100180713176, 'f1-score': 0.4338644073693916, 'support': 725459}, 'accuracy': 0.4957374833657382, 'macro avg': {'precision': 0.49345516963876923, 'recall': 0.49204330180100375, 'f1-score': 0.49072209102168407, 'support': 2412190}, 'weighted avg': {'precision': 0.5043762634450649, 'recall': 0.4957374833657382, 'f1-score': 0.49797331041978504, 'support': 2412190}}
[[375821 159907 191958]
 [242919 508255 207871]
 [244268 169454 311737]]
Evaluating performance on  val set...
3323/3323 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0196129
{'0': {'precision': 0.43139172169697637, 'recall': 0.5106577220596507, 'f1-score': 0.4676899187768753, 'support': 245362}, '1': {'precision': 0.6150871143202796, 'recall': 0.5356180026931595, 'f1-score': 0.5726084411783832, 'support': 361657}, '2': {'precision': 0.4325272230637634, 'recall': 0.4354465449134533, 'f1-score': 0.43398197460057353, 'support': 243279}, 'accuracy': 0.49975537987858376, 'macro avg': {'precision': 0.4930020196936731, 'recall': 0.49390742322208786, 'f1-score': 0.4914267781852773, 'support': 850298}, 'weighted avg': {'precision': 0.5098477080064544, 'recall': 0.49975537987858376, 'f1-score': 0.5026706938756001, 'support': 850298}}
[[125296  58696  61370]
 [ 90331 193710  77616]
 [ 74819  62525 105935]]
testing model out of sample: results/universal/W6/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 135s - 135s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9902081
{'0': {'precision': 0.488523539994621, 'recall': 0.4148343871604318, 'f1-score': 0.4486734598440719, 'support': 1353005}, '1': {'precision': 0.5688063000018662, 'recall': 0.7160793184400103, 'f1-score': 0.6340026252665938, 'support': 1787781}, '2': {'precision': 0.4899187958011487, 'recall': 0.3956046571828983, 'f1-score': 0.43773918490188973, 'support': 1344332}, 'accuracy': 0.5291477281088257, 'macro avg': {'precision': 0.5157495452658787, 'recall': 0.5088394542611135, 'f1-score': 0.5068050900041852, 'support': 4485118}, 'weighted avg': {'precision': 0.5209426825896237, 'recall': 0.5291477281088257, 'f1-score': 0.5192688522031287, 'support': 4485118}}
[[ 561273  491026  300706]
 [ 254583 1280193  253005]
 [ 333061  479447  531824]]
Evaluating performance on  train set...
5152/5152 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99247
{'0': {'precision': 0.47818107031790447, 'recall': 0.4035591999032226, 'f1-score': 0.43771250256714517, 'support': 380254}, '1': {'precision': 0.5826589647533699, 'recall': 0.6926237054702319, 'f1-score': 0.6329003296534556, 'support': 559373}, '2': {'precision': 0.465702788554874, 'recall': 0.4088943303525488, 'f1-score': 0.43545359515325904, 'support': 378983}, 'accuracy': 0.5277178240723186, 'macro avg': {'precision': 0.5088476078753827, 'recall': 0.5016924119086678, 'f1-score': 0.5020221424579533, 'support': 1318610}, 'weighted avg': {'precision': 0.5189156746259646, 'recall': 0.5277178240723186, 'f1-score': 0.5198647029086517, 'support': 1318610}}
[[153455 141938  84861]
 [ 79010 387435  92928]
 [ 88449 135570 154964]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9769605
{'0': {'precision': 0.4710989574431721, 'recall': 0.42396696121634403, 'f1-score': 0.44629203113552374, 'support': 130029}, '1': {'precision': 0.6002401065967748, 'recall': 0.6853863187864363, 'f1-score': 0.6399936232264599, 'support': 199149}, '2': {'precision': 0.4645234559273172, 'recall': 0.40994210205765125, 'f1-score': 0.43552938189294005, 'support': 129711}, 'accuracy': 0.5334536238611081, 'macro avg': {'precision': 0.5119541733224214, 'recall': 0.5064317940201438, 'f1-score': 0.5072716787516413, 'support': 458889}, 'weighted avg': {'precision': 0.5252850805266798, 'recall': 0.5334536238611081, 'f1-score': 0.527312592463891, 'support': 458889}}
[[ 55128  46276  28625]
 [ 29984 136494  32671]
 [ 31908  44629  53174]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1470141
{'0': {'precision': 0.3912711814678863, 'recall': 0.63535689330256, 'f1-score': 0.48429776743022457, 'support': 94454}, '1': {'precision': 0.4167109137423372, 'recall': 0.1135921052631579, 'f1-score': 0.17852083914927055, 'support': 76000}, '2': {'precision': 0.429182823199406, 'recall': 0.41365497773536897, 'f1-score': 0.4212758634651982, 'support': 100608}, 'accuracy': 0.40677778515616353, 'macro avg': {'precision': 0.41238830613654315, 'recall': 0.38753465876702897, 'f1-score': 0.3613648233482311, 'support': 271062}, 'weighted avg': {'precision': 0.4124753122725841, 'recall': 0.40677778515616353, 'f1-score': 0.37517308649573033, 'support': 271062}}
[[60012  5176 29266]
 [41282  8633 26085]
 [52083  6908 41617]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1633666
{'0': {'precision': 0.3931982211853904, 'recall': 0.5815094339622642, 'f1-score': 0.4691631871955463, 'support': 18550}, '1': {'precision': 0.44336175395858707, 'recall': 0.16321955047362816, 'f1-score': 0.23860051620303982, 'support': 17841}, '2': {'precision': 0.38788395049356117, 'recall': 0.4406306921675774, 'f1-score': 0.4125782811459027, 'support': 17568}, 'accuracy': 0.39733872013936505, 'macro avg': {'precision': 0.40814797521251284, 'recall': 0.39511989220115656, 'f1-score': 0.3734473281814963, 'support': 53959}, 'weighted avg': {'precision': 0.40805406507969066, 'recall': 0.39733872013936505, 'f1-score': 0.37450701783255874, 'support': 53959}}
[[10787  1812  5951]
 [ 8664  2912  6265]
 [ 7983  1844  7741]]
Evaluating performance on  val set...
81/81 - 1s - 811ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1502221
{'0': {'precision': 0.4009891921597362, 'recall': 0.6099191975480636, 'f1-score': 0.48386383731211324, 'support': 7178}, '1': {'precision': 0.4502027940513745, 'recall': 0.15502793296089384, 'f1-score': 0.23063603832390625, 'support': 6444}, '2': {'precision': 0.4116548873183091, 'recall': 0.44011976047904194, 'f1-score': 0.42541169985530214, 'support': 7014}, 'accuracy': 0.41015700717193254, 'macro avg': {'precision': 0.42094895784313996, 'recall': 0.40168896366266643, 'f1-score': 0.3799705251637739, 'support': 20636}, 'weighted avg': {'precision': 0.41998229336306764, 'recall': 0.41015700717193254, 'f1-score': 0.38492105630794193, 'support': 20636}}
[[4378  578 2222]
 [3255  999 2190]
 [3285  642 3087]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7663551
{'0': {'precision': 0.5334080320811464, 'recall': 0.33652683471304995, 'f1-score': 0.4126886356636895, 'support': 107510}, '1': {'precision': 0.7244572801514397, 'recall': 0.8698752487884767, 'f1-score': 0.7905345282359296, 'support': 343163}, '2': {'precision': 0.533513247663846, 'recall': 0.38992783210595683, 'f1-score': 0.4505575257995463, 'support': 108497}, 'accuracy': 0.6742046247116261, 'macro avg': {'precision': 0.5971261866321441, 'recall': 0.5321099718691612, 'f1-score': 0.5512602298997218, 'support': 559170}, 'weighted avg': {'precision': 0.6506754975936421, 'recall': 0.6742046247116261, 'f1-score': 0.6519206956916553, 'support': 559170}}
[[ 36180  57578  13752]
 [ 21415 298509  23239]
 [ 10233  55958  42306]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6892227
{'0': {'precision': 0.535151228093917, 'recall': 0.3627482456542678, 'f1-score': 0.4323984473238205, 'support': 21803}, '1': {'precision': 0.7909784911903863, 'recall': 0.8812020997941167, 'f1-score': 0.8336562582855744, 'support': 92771}, '2': {'precision': 0.5134241137879707, 'recall': 0.42922984744434717, 'f1-score': 0.46756702480168694, 'support': 21697}, 'accuracy': 0.7262880583543087, 'macro avg': {'precision': 0.6131846110240914, 'recall': 0.5577267309642439, 'f1-score': 0.5778739101370273, 'support': 136271}, 'weighted avg': {'precision': 0.7058547367320457, 'recall': 0.7262880583543087, 'f1-score': 0.7111675251633471, 'support': 136271}}
[[ 7909 11283  2611]
 [ 4806 81750  6215]
 [ 2064 10320  9313]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6889404
{'0': {'precision': 0.5589322381930185, 'recall': 0.35382815546600804, 'f1-score': 0.4333359866273979, 'support': 7693}, '1': {'precision': 0.7875204561051575, 'recall': 0.8980255237177943, 'f1-score': 0.8391506117283082, 'support': 33224}, '2': {'precision': 0.5224977043158862, 'recall': 0.39058209774848984, 'f1-score': 0.44701076282504515, 'support': 7284}, 'accuracy': 0.7344868363726894, 'macro avg': {'precision': 0.6229834662046874, 'recall': 0.547478592310764, 'f1-score': 0.5731657870602503, 'support': 48201}, 'weighted avg': {'precision': 0.7109877102195714, 'recall': 0.7344868363726894, 'f1-score': 0.715122509192828, 'support': 48201}}
[[ 2722  4149   822]
 [ 1610 29836  1778]
 [  538  3901  2845]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1720681
{'0': {'precision': 0.4695333197472998, 'recall': 0.4578735905300903, 'f1-score': 0.463630159757826, 'support': 115735}, '1': {'precision': 0.3785197428093443, 'recall': 0.464241570256106, 'f1-score': 0.41702104035974014, 'support': 80904}, '2': {'precision': 0.4299173469905177, 'recall': 0.37168684734290197, 'f1-score': 0.39868709383141004, 'support': 114053}, 'accuracy': 0.42789321900789207, 'macro avg': {'precision': 0.4259901365157206, 'recall': 0.4312673360430328, 'f1-score': 0.42644609798299205, 'support': 310692}, 'weighted avg': {'precision': 0.4312906776148419, 'recall': 0.42789321900789207, 'f1-score': 0.4276530000823652, 'support': 310692}}
[[52992 28461 34282]
 [21414 37559 21931]
 [38455 33206 42392]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.161748
{'0': {'precision': 0.4186276288992398, 'recall': 0.4691009331857107, 'f1-score': 0.4424294086307938, 'support': 44257}, '1': {'precision': 0.440374531835206, 'recall': 0.40763168234451197, 'f1-score': 0.42337098071221957, 'support': 43267}, '2': {'precision': 0.41200958443255803, 'recall': 0.3919099364582374, 'f1-score': 0.40170849409460435, 'support': 43436}, 'accuracy': 0.4231902871105681, 'macro avg': {'precision': 0.42367058172233457, 'recall': 0.42288085066282005, 'f1-score': 0.42250296114587255, 'support': 130960}, 'weighted avg': {'precision': 0.4236174110455109, 'recall': 0.4231902871105681, 'f1-score': 0.4226267616809857, 'support': 130960}}
[[20761 10806 12690]
 [14026 17637 11604]
 [14806 11607 17023]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1509286
{'0': {'precision': 0.41802527935519324, 'recall': 0.46835876034754054, 'f1-score': 0.441762921855843, 'support': 14617}, '1': {'precision': 0.4371766159549, 'recall': 0.41741631027871995, 'f1-score': 0.4270680095054883, 'support': 13562}, '2': {'precision': 0.4251808972503618, 'recall': 0.39259704683637336, 'f1-score': 0.4082398304790356, 'support': 14967}, 'accuracy': 0.4260649886432114, 'macro avg': {'precision': 0.4267942641868183, 'recall': 0.4261240391542113, 'f1-score': 0.425690253946789, 'support': 43146}, 'weighted avg': {'precision': 0.42652730874383205, 'recall': 0.4260649886432114, 'f1-score': 0.4255150075664028, 'support': 43146}}
[[6846 3530 4241]
 [4198 5661 3703]
 [5333 3758 5876]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1788867
{'0': {'precision': 0.37471438133265633, 'recall': 0.643381515202552, 'f1-score': 0.4735984247661762, 'support': 100937}, '1': {'precision': 0.32375776397515527, 'recall': 0.005565119910317492, 'f1-score': 0.01094215353127173, 'support': 74931}, '2': {'precision': 0.3963104808129835, 'recall': 0.4011476164888309, 'f1-score': 0.3987143783618815, 'support': 104216}, 'accuracy': 0.3826137872923837, 'macro avg': {'precision': 0.36492754204026506, 'recall': 0.3500314172005668, 'f1-score': 0.29441831888644315, 'support': 280084}, 'weighted avg': {'precision': 0.36911759182746096, 'recall': 0.3826137872923837, 'f1-score': 0.3219602989183141, 'support': 280084}}
[[64941   341 35655]
 [46487   417 28027]
 [61880   530 41806]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2494406
{'0': {'precision': 0.3510931891953727, 'recall': 0.6349202244576039, 'f1-score': 0.4521564583256602, 'support': 38671}, '1': {'precision': 0.39800995024875624, 'recall': 0.00846784863720561, 'f1-score': 0.016582888531896146, 'support': 37790}, '2': {'precision': 0.352051293752567, 'recall': 0.4049393732612461, 'f1-score': 0.37664778830192364, 'support': 38102}, 'accuracy': 0.3517889720066688, 'macro avg': {'precision': 0.367051477732232, 'recall': 0.3494424821186852, 'f1-score': 0.28179571171982665, 'support': 114563}, 'weighted avg': {'precision': 0.3668879056399978, 'recall': 0.3517889720066688, 'f1-score': 0.2833641209414196, 'support': 114563}}
[[24553   180 13938]
 [23011   320 14459]
 [22369   304 15429]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2206851
{'0': {'precision': 0.35993878118912903, 'recall': 0.6449763151333832, 'f1-score': 0.4620330406310463, 'support': 12033}, '1': {'precision': 0.47863247863247865, 'recall': 0.010529284572717871, 'f1-score': 0.020605280103026404, 'support': 10637}, '2': {'precision': 0.3775140633428373, 'recall': 0.4047756754523672, 'f1-score': 0.39066985645933017, 'support': 12103}, 'accuracy': 0.36729646564863544, 'macro avg': {'precision': 0.40536177438814835, 'recall': 0.35342709171948944, 'f1-score': 0.29110272573113427, 'support': 34773}, 'weighted avg': {'precision': 0.4023641830702218, 'recall': 0.36729646564863544, 'f1-score': 0.30216257484532666, 'support': 34773}}
[[7761   51 4221]
 [6668  112 3857]
 [7133   71 4899]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
1722/1722 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1694984
{'0': {'precision': 0.39430377542490946, 'recall': 0.5730356272895801, 'f1-score': 0.46715787790555235, 'support': 158053}, '1': {'precision': 0.41385428317969686, 'recall': 0.17587136640414355, 'f1-score': 0.24684399712437097, 'support': 122021}, '2': {'precision': 0.39144959935696166, 'recall': 0.38785465405674463, 'f1-score': 0.38964383493142984, 'support': 160720}, 'accuracy': 0.39557253501635686, 'macro avg': {'precision': 0.39986921932052266, 'recall': 0.3789205492501561, 'f1-score': 0.367881903320451, 'support': 440794}, 'weighted avg': {'precision': 0.39867509020938097, 'recall': 0.39557253501635686, 'f1-score': 0.377907622608063, 'support': 440794}}
[[90570 13609 53874]
 [57527 21460 43034]
 [81599 16785 62336]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1956688
{'0': {'precision': 0.3772368523872783, 'recall': 0.5491515783486587, 'f1-score': 0.44724265983154093, 'support': 52745}, '1': {'precision': 0.4364765669113495, 'recall': 0.20702848506877355, 'f1-score': 0.2808465361308991, 'support': 52273}, '2': {'precision': 0.37177167589044985, 'recall': 0.3959458948879737, 'f1-score': 0.38347818131918393, 'support': 52934}, 'accuracy': 0.3845851904376013, 'macro avg': {'precision': 0.39516169839635923, 'recall': 0.384041986101802, 'f1-score': 0.37052245909387466, 'support': 157952}, 'weighted avg': {'precision': 0.39501025155052827, 'recall': 0.3845851904376013, 'f1-score': 0.3708059355116415, 'support': 157952}}
[[28965  6174 17606]
 [23640 10822 17811]
 [24177  7798 20959]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.181157
{'0': {'precision': 0.38277993887190886, 'recall': 0.5760807067063928, 'f1-score': 0.45994616363750185, 'support': 19131}, '1': {'precision': 0.449654594934059, 'recall': 0.2202850989642088, 'f1-score': 0.29570484581497797, 'support': 19502}, '2': {'precision': 0.3824807581548772, 'recall': 0.3883159685307251, 'f1-score': 0.38537627601487695, 'support': 18812}, 'accuracy': 0.39380276786491425, 'macro avg': {'precision': 0.40497176398694834, 'recall': 0.39489392473377555, 'f1-score': 0.38034242848911887, 'support': 57445}, 'weighted avg': {'precision': 0.4053852370680138, 'recall': 0.39380276786491425, 'f1-score': 0.3797678555840302, 'support': 57445}}
[[11021  2424  5686]
 [ 9098  4296  6108]
 [ 8673  2834  7305]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/EXC
Evaluating performance on  test set...
4450/4450 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83727664
{'0': {'precision': 0.5730627286334139, 'recall': 0.37107598214160753, 'f1-score': 0.450463077998008, 'support': 285804}, '1': {'precision': 0.6467442544660879, 'recall': 0.8284359608069972, 'f1-score': 0.7264010082264206, 'support': 570510}, '2': {'precision': 0.5664191271320052, 'recall': 0.44717151929618604, 'f1-score': 0.4997806610204993, 'support': 282802}, 'accuracy': 0.6190300197697162, 'macro avg': {'precision': 0.5954087034105023, 'recall': 0.5488944874149303, 'f1-score': 0.558881582414976, 'support': 1139116}, 'weighted avg': {'precision': 0.6083156998066723, 'recall': 0.6190300197697162, 'f1-score': 0.6009064566254158, 'support': 1139116}}
[[106055 136099  43650]
 [ 44726 472631  53153]
 [ 34286 122055 126461]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7663873
{'0': {'precision': 0.5698108511697362, 'recall': 0.38686589501888885, 'f1-score': 0.4608461234319399, 'support': 82853}, '1': {'precision': 0.697782990662803, 'recall': 0.8311653920785298, 'f1-score': 0.758656184298535, 'support': 219025}, '2': {'precision': 0.549960102845997, 'recall': 0.4487340245960936, 'f1-score': 0.4942170050592906, 'support': 82940}, 'accuracy': 0.6530801573730959, 'macro avg': {'precision': 0.6058513148928454, 'recall': 0.5555884372311707, 'f1-score': 0.5712397709299218, 'support': 384818}, 'weighted avg': {'precision': 0.6383696940162196, 'recall': 0.6530801573730959, 'f1-score': 0.6375416769234046, 'support': 384818}}
[[ 32053  41553   9247]
 [ 15770 182046  21209]
 [  8429  37293  37218]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7711776
{'0': {'precision': 0.5600578871201157, 'recall': 0.3918562181318483, 'f1-score': 0.4610965724133529, 'support': 27653}, '1': {'precision': 0.6948072490622317, 'recall': 0.8255715609016097, 'f1-score': 0.7545660349576986, 'support': 74489}, '2': {'precision': 0.5441182961818584, 'recall': 0.43452359970390214, 'f1-score': 0.4831843838193791, 'support': 28369}, 'accuracy': 0.6486732919064293, 'macro avg': {'precision': 0.5996611441214018, 'recall': 0.5506504595791201, 'f1-score': 0.5662823303968102, 'support': 130511}, 'weighted avg': {'precision': 0.6335011598433256, 'recall': 0.6486732919064293, 'f1-score': 0.6333951213268032, 'support': 130511}}
[[10836 13932  2885]
 [ 5550 61496  7443]
 [ 2962 13080 12327]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/AAL
Evaluating performance on  test set...
6203/6203 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7720974
{'0': {'precision': 0.5371989032626098, 'recall': 0.3747027811024936, 'f1-score': 0.44147286162291527, 'support': 311639}, '1': {'precision': 0.7173628225271097, 'recall': 0.8535524261869382, 'f1-score': 0.7795541842573099, 'support': 959654}, '2': {'precision': 0.5246200607902736, 'recall': 0.3789200697462852, 'f1-score': 0.44002266929063094, 'support': 316576}, 'accuracy': 0.6649440224602912, 'macro avg': {'precision': 0.5930605955266643, 'recall': 0.5357250923452389, 'f1-score': 0.5536832383902853, 'support': 1587869}, 'weighted avg': {'precision': 0.6435759823184589, 'recall': 0.6649440224602912, 'f1-score': 0.6455085834007207, 'support': 1587869}}
[[116772 158478  36389]
 [ 68230 819115  72309]
 [ 32370 164249 119957]]
Evaluating performance on  train set...
1766/1766 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78664297
{'0': {'precision': 0.5755723129737131, 'recall': 0.32470188876316475, 'f1-score': 0.41518332255169965, 'support': 91912}, '1': {'precision': 0.7146119898205715, 'recall': 0.8279446287746747, 'f1-score': 0.7671149979165478, 'support': 267937}, '2': {'precision': 0.4834908815267312, 'recall': 0.4707293249403082, 'f1-score': 0.4770247679380582, 'support': 92140}, 'accuracy': 0.6527902227709081, 'macro avg': {'precision': 0.5912250614403386, 'recall': 0.5411252808260493, 'f1-score': 0.5531076961354352, 'support': 451989}, 'weighted avg': {'precision': 0.6392231779323554, 'recall': 0.6527902227709081, 'f1-score': 0.6364134588606152, 'support': 451989}}
[[ 29844  48050  14018]
 [ 13783 221837  32317]
 [  8224  40543  43373]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7514367
{'0': {'precision': 0.5170588235294118, 'recall': 0.35611947994549004, 'f1-score': 0.42175743168087937, 'support': 27151}, '1': {'precision': 0.7533721703092622, 'recall': 0.8145416116248348, 'f1-score': 0.7827636810488847, 'support': 94625}, '2': {'precision': 0.4617942654448714, 'recall': 0.4752814116215394, 'f1-score': 0.4684407796101949, 'support': 26296}, 'accuracy': 0.6702347506618402, 'macro avg': {'precision': 0.5774084197611818, 'recall': 0.5486475010639548, 'f1-score': 0.5576539641133197, 'support': 148072}, 'weighted avg': {'precision': 0.6582598177731058, 'recall': 0.6702347506618402, 'f1-score': 0.6607479340283643, 'support': 148072}}
[[ 9669 13854  3628]
 [ 6611 77076 10938]
 [ 2420 11378 12498]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/WBA
Evaluating performance on  test set...
5183/5183 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0213912
{'0': {'precision': 0.5456070693086168, 'recall': 0.4052127761733782, 'f1-score': 0.46504489005967425, 'support': 426951}, '1': {'precision': 0.5017893101830401, 'recall': 0.7367897441602732, 'f1-score': 0.5969957527953541, 'support': 467402}, '2': {'precision': 0.5119339120971532, 'recall': 0.3828691136278504, 'f1-score': 0.43809347426349005, 'support': 432482}, 'accuracy': 0.5147339345133344, 'macro avg': {'precision': 0.5197767638629367, 'recall': 0.5082905446538339, 'f1-score': 0.5000447057061729, 'support': 1326835}, 'weighted avg': {'precision': 0.5191956898771569, 'recall': 0.5147339345133344, 'f1-score': 0.5027421884713207, 'support': 1326835}}
[[173006 164018  89927]
 [ 55088 344377  67937]
 [ 88995 177903 165584]]
Evaluating performance on  train set...
1489/1489 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9859212
{'0': {'precision': 0.5419966902894102, 'recall': 0.3685901566110839, 'f1-score': 0.4387821889509317, 'support': 116403}, '1': {'precision': 0.5303903132596431, 'recall': 0.7763225026852847, 'f1-score': 0.6302133573121884, 'support': 148960}, '2': {'precision': 0.5243102749362138, 'recall': 0.38007986033084995, 'f1-score': 0.4406942718563354, 'support': 115702}, 'accuracy': 0.5314631362103578, 'macro avg': {'precision': 0.5322324261617558, 'recall': 0.5083308398757395, 'f1-score': 0.5032299393731519, 'support': 381065}, 'weighted avg': {'precision': 0.5320896152456522, 'recall': 0.5314631362103578, 'f1-score': 0.5141940442916578, 'support': 381065}}
[[ 42905  51864  21634]
 [ 15055 115641  18264]
 [ 21201  50525  43976]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.959112
{'0': {'precision': 0.5427781783225186, 'recall': 0.35728221894115164, 'f1-score': 0.430915508633574, 'support': 37928}, '1': {'precision': 0.5609272495838638, 'recall': 0.8036121339645801, 'f1-score': 0.6606888001499273, 'support': 57030}, '2': {'precision': 0.5284690004217629, 'recall': 0.36469716614187814, 'f1-score': 0.43156840028806714, 'support': 37793}, 'accuracy': 0.551137091246017, 'macro avg': {'precision': 0.5440581427760485, 'recall': 0.5085305063492033, 'f1-score': 0.5077242363571894, 'support': 132751}, 'weighted avg': {'precision': 0.5465013500773923, 'recall': 0.551137091246017, 'f1-score': 0.5298122819119364, 'support': 132751}}
[[13551 18076  6301]
 [ 5203 45830  5997]
 [ 6212 17798 13783]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
7324/7324 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0798578
{'0': {'precision': 0.55310237718345, 'recall': 0.35765327042268585, 'f1-score': 0.43440603327177246, 'support': 673124}, '1': {'precision': 0.4200205022299642, 'recall': 0.7169529608413662, 'f1-score': 0.5297132298486339, 'support': 549202}, '2': {'precision': 0.5291894680853183, 'recall': 0.40719218241042343, 'f1-score': 0.4602435647990131, 'support': 652375}, 'accuracy': 0.4801507013651777, 'macro avg': {'precision': 0.5007707824995774, 'recall': 0.4939328045581585, 'f1-score': 0.4747876093064731, 'support': 1874701}, 'weighted avg': {'precision': 0.505794024565567, 'recall': 0.4801507013651777, 'f1-score': 0.4713178728688544, 'support': 1874701}}
[[240745 285558 146821]
 [ 65934 393752  89516]
 [128584 258149 265642]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.048569
{'0': {'precision': 0.5464070299500832, 'recall': 0.36489958909659126, 'f1-score': 0.43757764190685056, 'support': 172790}, '1': {'precision': 0.4746693586245601, 'recall': 0.7552722473393053, 'f1-score': 0.5829619739557144, 'support': 178055}, '2': {'precision': 0.5281778559718502, 'recall': 0.38197854313062085, 'f1-score': 0.4433361302231918, 'support': 172905}, 'accuracy': 0.5032496420047733, 'macro avg': {'precision': 0.5164180815154978, 'recall': 0.5007167931888391, 'f1-score': 0.4879585820285855, 'support': 523750}, 'weighted avg': {'precision': 0.516000984327988, 'recall': 0.5032496420047733, 'f1-score': 0.4889038064229315, 'support': 523750}}
[[ 63051  75238  34501]
 [ 19077 134480  24498]
 [ 33264  73595  66046]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0327724
{'0': {'precision': 0.5524757166548211, 'recall': 0.37642045454545453, 'f1-score': 0.4477640598298803, 'support': 61952}, '1': {'precision': 0.4835814644555907, 'recall': 0.7458933185677372, 'f1-score': 0.5867549107980085, 'support': 65016}, '2': {'precision': 0.5213920207231884, 'recall': 0.3921305611446457, 'f1-score': 0.4476161831587966, 'support': 62622}, 'accuracy': 0.5083126747191308, 'macro avg': {'precision': 0.5191497339445333, 'recall': 0.5048147780859459, 'f1-score': 0.4940450512622285, 'support': 189590}, 'weighted avg': {'precision': 0.5185828324962902, 'recall': 0.5083126747191308, 'f1-score': 0.4953792759997585, 'support': 189590}}
[[23320 25824 12808]
 [ 6788 48495  9733]
 [12102 25964 24556]]
testing model on single stock: results/universal/W6/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
29350/29350 - 243s - 243s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1860595
{'0': {'precision': 0.36947867392804257, 'recall': 0.5373224480428569, 'f1-score': 0.4378670929368687, 'support': 2213507}, '1': {'precision': 0.4940278638407027, 'recall': 0.2934079816877319, 'f1-score': 0.36816134101623893, 'support': 3113978}, '2': {'precision': 0.3693389111207819, 'recall': 0.4131040836922221, 'f1-score': 0.3899975166546098, 'support': 2185914}, 'accuracy': 0.40009095750139184, 'macro avg': {'precision': 0.4109484829631757, 'recall': 0.41461150447427036, 'f1-score': 0.3986753168692392, 'support': 7513399}, 'weighted avg': {'precision': 0.4210582490083458, 'recall': 0.40009095750139184, 'f1-score': 0.39505012621864216, 'support': 7513399}}
[[1189367  425001  599139]
 [1257525  913666  942787]
 [ 772149  510755  903010]]
Evaluating performance on  train set...
5452/5452 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1238402
{'0': {'precision': 0.41800740166646433, 'recall': 0.5739727666703707, 'f1-score': 0.4837291560484604, 'support': 467956}, '1': {'precision': 0.5053910050373677, 'recall': 0.279307881233184, 'f1-score': 0.3597805305476806, 'support': 460499}, '2': {'precision': 0.4128149722019915, 'recall': 0.4405697424938653, 'f1-score': 0.42624102088695764, 'support': 467018}, 'accuracy': 0.43208933458404425, 'macro avg': {'precision': 0.4454044596352745, 'recall': 0.43128346346580665, 'f1-score': 0.42325023582769955, 'support': 1395473}, 'weighted avg': {'precision': 0.4451058148532894, 'recall': 0.43208933458404425, 'f1-score': 0.4235873890624003, 'support': 1395473}}
[[268594  54903 144459]
 [183674 128621 148204]
 [190290  70974 205754]]
Evaluating performance on  val set...
1969/1969 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1178488
{'0': {'precision': 0.4125912999102379, 'recall': 0.56574927368717, 'f1-score': 0.47718194369789524, 'support': 160055}, '1': {'precision': 0.530301467485583, 'recall': 0.3036016255361639, 'f1-score': 0.38613692382272413, 'support': 186277}, '2': {'precision': 0.4064164812192326, 'recall': 0.4585113802066823, 'f1-score': 0.4308950839792897, 'support': 157730}, 'accuracy': 0.43531549690315874, 'macro avg': {'precision': 0.4497697495383512, 'recall': 0.44262075981000537, 'f1-score': 0.43140465049996973, 'support': 504062}, 'weighted avg': {'precision': 0.45415908866102705, 'recall': 0.43531549690315874, 'f1-score': 0.42905211135444765, 'support': 504062}}
[[90551 22406 47098]
 [71194 56554 58529]
 [57724 27685 72321]]
training model: results/universal/W6/deepVOL_L2/h10
Epoch 1/50
9426/9426 - 332s - loss: 2.7626 - accuracy10: 0.5431 - val_loss: 2.9154 - val_accuracy10: 0.5474 - 332s/epoch - 35ms/step
Epoch 2/50
9426/9426 - 316s - loss: 2.6637 - accuracy10: 0.5694 - val_loss: 2.8120 - val_accuracy10: 0.5626 - 316s/epoch - 33ms/step
Epoch 3/50
9426/9426 - 311s - loss: 2.6227 - accuracy10: 0.5803 - val_loss: 2.7983 - val_accuracy10: 0.5633 - 311s/epoch - 33ms/step
Epoch 4/50
9426/9426 - 312s - loss: 2.5998 - accuracy10: 0.5849 - val_loss: 2.8174 - val_accuracy10: 0.5647 - 312s/epoch - 33ms/step
Epoch 5/50
9426/9426 - 312s - loss: 2.5851 - accuracy10: 0.5883 - val_loss: 2.7817 - val_accuracy10: 0.5660 - 312s/epoch - 33ms/step
Epoch 6/50
9426/9426 - 312s - loss: 2.5748 - accuracy10: 0.5902 - val_loss: 2.7901 - val_accuracy10: 0.5670 - 312s/epoch - 33ms/step
Epoch 7/50
9426/9426 - 309s - loss: 2.5672 - accuracy10: 0.5919 - val_loss: 2.7859 - val_accuracy10: 0.5665 - 309s/epoch - 33ms/step
Epoch 8/50
9426/9426 - 308s - loss: 2.5605 - accuracy10: 0.5929 - val_loss: 2.7548 - val_accuracy10: 0.5705 - 308s/epoch - 33ms/step
Epoch 9/50
9426/9426 - 309s - loss: 2.5548 - accuracy10: 0.5940 - val_loss: 2.7582 - val_accuracy10: 0.5709 - 309s/epoch - 33ms/step
Epoch 10/50
9426/9426 - 307s - loss: 2.5505 - accuracy10: 0.5947 - val_loss: 2.7626 - val_accuracy10: 0.5697 - 307s/epoch - 33ms/step
Epoch 11/50
9426/9426 - 309s - loss: 2.5462 - accuracy10: 0.5954 - val_loss: 2.7552 - val_accuracy10: 0.5704 - 309s/epoch - 33ms/step
Epoch 12/50
9426/9426 - 311s - loss: 2.5427 - accuracy10: 0.5961 - val_loss: 2.7580 - val_accuracy10: 0.5694 - 311s/epoch - 33ms/step
Epoch 13/50
9426/9426 - 309s - loss: 2.5391 - accuracy10: 0.5967 - val_loss: 2.7444 - val_accuracy10: 0.5730 - 309s/epoch - 33ms/step
Epoch 14/50
9426/9426 - 310s - loss: 2.5365 - accuracy10: 0.5973 - val_loss: 2.7415 - val_accuracy10: 0.5710 - 310s/epoch - 33ms/step
Epoch 15/50
9426/9426 - 311s - loss: 2.5334 - accuracy10: 0.5979 - val_loss: 2.7387 - val_accuracy10: 0.5770 - 311s/epoch - 33ms/step
Epoch 16/50
9426/9426 - 309s - loss: 2.5311 - accuracy10: 0.5984 - val_loss: 2.7394 - val_accuracy10: 0.5748 - 309s/epoch - 33ms/step
Epoch 17/50
9426/9426 - 311s - loss: 2.5286 - accuracy10: 0.5990 - val_loss: 2.7310 - val_accuracy10: 0.5728 - 311s/epoch - 33ms/step
Epoch 18/50
9426/9426 - 313s - loss: 2.5266 - accuracy10: 0.5992 - val_loss: 2.7254 - val_accuracy10: 0.5757 - 313s/epoch - 33ms/step
Epoch 19/50
9426/9426 - 315s - loss: 2.5243 - accuracy10: 0.5995 - val_loss: 2.7391 - val_accuracy10: 0.5741 - 315s/epoch - 33ms/step
Epoch 20/50
9426/9426 - 317s - loss: 2.5226 - accuracy10: 0.6001 - val_loss: 2.7143 - val_accuracy10: 0.5765 - 317s/epoch - 34ms/step
Epoch 21/50
9426/9426 - 317s - loss: 2.5205 - accuracy10: 0.6003 - val_loss: 2.7331 - val_accuracy10: 0.5770 - 317s/epoch - 34ms/step
Epoch 22/50
9426/9426 - 316s - loss: 2.5187 - accuracy10: 0.6008 - val_loss: 2.7147 - val_accuracy10: 0.5761 - 316s/epoch - 34ms/step
Epoch 23/50
9426/9426 - 321s - loss: 2.5170 - accuracy10: 0.6012 - val_loss: 2.7198 - val_accuracy10: 0.5782 - 321s/epoch - 34ms/step
Epoch 24/50
9426/9426 - 319s - loss: 2.5150 - accuracy10: 0.6014 - val_loss: 2.7307 - val_accuracy10: 0.5779 - 319s/epoch - 34ms/step
Epoch 25/50
9426/9426 - 317s - loss: 2.5139 - accuracy10: 0.6016 - val_loss: 2.7125 - val_accuracy10: 0.5797 - 317s/epoch - 34ms/step
Epoch 26/50
9426/9426 - 315s - loss: 2.5121 - accuracy10: 0.6020 - val_loss: 2.7240 - val_accuracy10: 0.5780 - 315s/epoch - 33ms/step
Epoch 27/50
9426/9426 - 314s - loss: 2.5105 - accuracy10: 0.6024 - val_loss: 2.7144 - val_accuracy10: 0.5803 - 314s/epoch - 33ms/step
Epoch 28/50
9426/9426 - 320s - loss: 2.5092 - accuracy10: 0.6025 - val_loss: 2.7220 - val_accuracy10: 0.5801 - 320s/epoch - 34ms/step
Epoch 29/50
9426/9426 - 322s - loss: 2.5075 - accuracy10: 0.6029 - val_loss: 2.7244 - val_accuracy10: 0.5792 - 322s/epoch - 34ms/step
Epoch 30/50
9426/9426 - 326s - loss: 2.5060 - accuracy10: 0.6033 - val_loss: 2.7123 - val_accuracy10: 0.5813 - 326s/epoch - 35ms/step
Epoch 31/50
9426/9426 - 323s - loss: 2.5051 - accuracy10: 0.6035 - val_loss: 2.7204 - val_accuracy10: 0.5818 - 323s/epoch - 34ms/step
Epoch 32/50
9426/9426 - 323s - loss: 2.5037 - accuracy10: 0.6037 - val_loss: 2.7193 - val_accuracy10: 0.5805 - 323s/epoch - 34ms/step
Epoch 33/50
9426/9426 - 321s - loss: 2.5024 - accuracy10: 0.6037 - val_loss: 2.7227 - val_accuracy10: 0.5804 - 321s/epoch - 34ms/step
Epoch 34/50
9426/9426 - 327s - loss: 2.5010 - accuracy10: 0.6043 - val_loss: 2.7189 - val_accuracy10: 0.5798 - 327s/epoch - 35ms/step
Epoch 35/50
9426/9426 - 318s - loss: 2.4998 - accuracy10: 0.6045 - val_loss: 2.7183 - val_accuracy10: 0.5803 - 318s/epoch - 34ms/step
Epoch 36/50
9426/9426 - 319s - loss: 2.4988 - accuracy10: 0.6043 - val_loss: 2.7224 - val_accuracy10: 0.5807 - 319s/epoch - 34ms/step
Epoch 37/50
9426/9426 - 321s - loss: 2.4976 - accuracy10: 0.6048 - val_loss: 2.7160 - val_accuracy10: 0.5821 - 321s/epoch - 34ms/step
Epoch 38/50
9426/9426 - 323s - loss: 2.4963 - accuracy10: 0.6050 - val_loss: 2.7176 - val_accuracy10: 0.5803 - 323s/epoch - 34ms/step
Epoch 39/50
9426/9426 - 320s - loss: 2.4951 - accuracy10: 0.6054 - val_loss: 2.7089 - val_accuracy10: 0.5825 - 320s/epoch - 34ms/step
Epoch 40/50
9426/9426 - 317s - loss: 2.4940 - accuracy10: 0.6055 - val_loss: 2.7136 - val_accuracy10: 0.5808 - 317s/epoch - 34ms/step
Epoch 41/50
9426/9426 - 321s - loss: 2.4931 - accuracy10: 0.6060 - val_loss: 2.7226 - val_accuracy10: 0.5793 - 321s/epoch - 34ms/step
Epoch 42/50
9426/9426 - 315s - loss: 2.4919 - accuracy10: 0.6058 - val_loss: 2.7190 - val_accuracy10: 0.5819 - 315s/epoch - 33ms/step
Epoch 43/50
9426/9426 - 315s - loss: 2.4912 - accuracy10: 0.6061 - val_loss: 2.7198 - val_accuracy10: 0.5823 - 315s/epoch - 33ms/step
Epoch 44/50
9426/9426 - 317s - loss: 2.4901 - accuracy10: 0.6063 - val_loss: 2.7302 - val_accuracy10: 0.5824 - 317s/epoch - 34ms/step
Epoch 45/50
9426/9426 - 316s - loss: 2.4889 - accuracy10: 0.6067 - val_loss: 2.7051 - val_accuracy10: 0.5812 - 316s/epoch - 33ms/step
Epoch 46/50
9426/9426 - 324s - loss: 2.4878 - accuracy10: 0.6069 - val_loss: 2.7144 - val_accuracy10: 0.5821 - 324s/epoch - 34ms/step
Epoch 47/50
9426/9426 - 324s - loss: 2.4870 - accuracy10: 0.6069 - val_loss: 2.7137 - val_accuracy10: 0.5822 - 324s/epoch - 34ms/step
Epoch 48/50
9426/9426 - 323s - loss: 2.4860 - accuracy10: 0.6072 - val_loss: 2.7119 - val_accuracy10: 0.5831 - 323s/epoch - 34ms/step
Epoch 49/50
9426/9426 - 323s - loss: 2.4853 - accuracy10: 0.6071 - val_loss: 2.7160 - val_accuracy10: 0.5830 - 323s/epoch - 34ms/step
Epoch 50/50
9426/9426 - 322s - loss: 2.4842 - accuracy10: 0.6076 - val_loss: 2.7179 - val_accuracy10: 0.5838 - 322s/epoch - 34ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 688s - 688s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9217648
{'0': {'precision': 0.5093005107468584, 'recall': 0.475841836710274, 'f1-score': 0.4920029904243077, 'support': 3133951}, '1': {'precision': 0.6540975894587909, 'recall': 0.6510508472767439, 'f1-score': 0.6525706622060073, 'support': 4497704}, '2': {'precision': 0.4966632589394255, 'recall': 0.532013753485281, 'f1-score': 0.5137310961849381, 'support': 3186974}, 'accuracy': 0.5652299381002898, 'macro avg': {'precision': 0.5533537863816916, 'recall': 0.5529688124907662, 'f1-score': 0.5527682496050844, 'support': 10818629}, 'weighted avg': {'precision': 0.5657753013297717, 'recall': 0.5652299381002898, 'f1-score': 0.5651576172972337, 'support': 10818629}}
[[1491265  769108  873578]
 [ 724752 2928234  844718]
 [ 712048  779412 1695514]]
Evaluating performance on  train set...
9426/9426 - 160s - 160s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87525016
{'0': {'precision': 0.4930340507958354, 'recall': 0.4784208191448087, 'f1-score': 0.48561752428589694, 'support': 646943}, '1': {'precision': 0.7348185160647547, 'recall': 0.6478677799745484, 'f1-score': 0.6886091835158138, 'support': 1121343}, '2': {'precision': 0.4644636179025253, 'recall': 0.5740045627281947, 'f1-score': 0.5134567257234026, 'support': 643913}, 'accuracy': 0.5827056557108266, 'macro avg': {'precision': 0.5641053949210385, 'recall': 0.5667643872825172, 'f1-score': 0.5625611445083711, 'support': 2412199}, 'weighted avg': {'precision': 0.5978041980690976, 'recall': 0.5827056557108266, 'f1-score': 0.5874123181031073, 'support': 2412199}}
[[309511 135771 201661]
 [170355 726482 224506]
 [147902 126402 369609]]
Evaluating performance on  val set...
3323/3323 - 54s - 54s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87454826
{'0': {'precision': 0.473801308334851, 'recall': 0.4582902849525079, 'f1-score': 0.4659167364482543, 'support': 210035}, '1': {'precision': 0.7298112353074374, 'recall': 0.6561984503584906, 'f1-score': 0.6910500072484866, 'support': 432229}, '2': {'precision': 0.44339483965804033, 'recall': 0.5509692987305143, 'f1-score': 0.4913631424058026, 'support': 208037}, 'accuracy': 0.5815669980395177, 'macro avg': {'precision': 0.5490024611001095, 'recall': 0.5551526780138376, 'f1-score': 0.5494432953675146, 'support': 850301}, 'weighted avg': {'precision': 0.5964981465148795, 'recall': 0.5815669980395177, 'f1-score': 0.5865833268214329, 'support': 850301}}
[[ 96257  54435  59343]
 [ 64056 283628  84545]
 [ 42846  50569 114622]]
testing model out of sample: results/universal/W6/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 291s - 291s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8002456
{'0': {'precision': 0.5073084955641421, 'recall': 0.43440240055277424, 'f1-score': 0.46803329812278055, 'support': 1026097}, '1': {'precision': 0.7416841637347256, 'recall': 0.7730875871332394, 'f1-score': 0.7570603560939957, 'support': 2434490}, '2': {'precision': 0.48330682732426516, 'recall': 0.5042437895049172, 'f1-score': 0.493553367190575, 'support': 1024556}, 'accuracy': 0.6341913736083777, 'macro avg': {'precision': 0.577433162207711, 'recall': 0.5705779257303103, 'f1-score': 0.5728823404691171, 'support': 4485143}, 'weighted avg': {'precision': 0.6290424441137042, 'recall': 0.6341913736083777, 'f1-score': 0.6307438788655054, 'support': 4485143}}
[[ 445739  336689  243669]
 [ 243771 1882074  308645]
 [ 189125  318805  516626]]
Evaluating performance on  train set...
5153/5153 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80749434
{'0': {'precision': 0.4775246957050446, 'recall': 0.4367479102507699, 'f1-score': 0.4562269755950499, 'support': 284125}, '1': {'precision': 0.755496654622857, 'recall': 0.7436351504637352, 'f1-score': 0.7495189769559528, 'support': 749350}, '2': {'precision': 0.45326263283587664, 'recall': 0.5105316686539946, 'f1-score': 0.4801956764477402, 'support': 285140}, 'accuracy': 0.6271026797056002, 'macro avg': {'precision': 0.5620946610545927, 'recall': 0.5636382431228332, 'f1-score': 0.561980542999581, 'support': 1318615}, 'weighted avg': {'precision': 0.6302456967618718, 'recall': 0.6271026797056002, 'f1-score': 0.6280836559611376, 'support': 1318615}}
[[124091  91434  68600]
 [ 85113 557243 106994]
 [ 50659  88908 145573]]
Evaluating performance on  val set...
1795/1795 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7934139
{'0': {'precision': 0.48190822495371094, 'recall': 0.4442627839302424, 'f1-score': 0.46232043016505714, 'support': 97251}, '1': {'precision': 0.7669479546273096, 'recall': 0.7483958007391788, 'f1-score': 0.7575583118957223, 'support': 264618}, '2': {'precision': 0.45043730465407444, 'recall': 0.5154241777722808, 'f1-score': 0.48074445790313586, 'support': 97023}, 'accuracy': 0.6346852854266364, 'macro avg': {'precision': 0.5664311614116982, 'recall': 0.5693609208139007, 'f1-score': 0.5668743999879718, 'support': 458892}, 'weighted avg': {'precision': 0.6396212382259769, 'recall': 0.6346852854266364, 'f1-score': 0.636463392411156, 'support': 458892}}
[[ 43205  30468  23578]
 [ 29144 198039  37435]
 [ 17305  29710  50008]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
1059/1059 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.141074
{'0': {'precision': 0.4109413854351687, 'recall': 0.5591106814886418, 'f1-score': 0.4737100737100737, 'support': 82760}, '1': {'precision': 0.6240762144933627, 'recall': 0.17713314312413636, 'f1-score': 0.2759443093648852, 'support': 100591}, '2': {'precision': 0.41252809507681887, 'recall': 0.6109945733959596, 'f1-score': 0.4925194824290545, 'support': 87716}, 'accuracy': 0.43415096636624895, 'macro avg': {'precision': 0.48251523166845006, 'recall': 0.44907946600291265, 'f1-score': 0.41405795516800453, 'support': 271067}, 'weighted avg': {'precision': 0.49054762821912906, 'recall': 0.43415096636624895, 'f1-score': 0.40640726700157453, 'support': 271067}}
[[46272  4800 31688]
 [38139 17818 44634]
 [28189  5933 53594]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1223304
{'0': {'precision': 0.3992306913655228, 'recall': 0.5155892541996209, 'f1-score': 0.450009983740765, 'support': 15299}, '1': {'precision': 0.6913194056529997, 'recall': 0.2559563203176704, 'f1-score': 0.37359253780903795, 'support': 24176}, '2': {'precision': 0.3645148514851485, 'recall': 0.6354598177299089, 'f1-score': 0.46328081743594907, 'support': 14484}, 'accuracy': 0.4314386849274449, 'macro avg': {'precision': 0.4850216495012236, 'recall': 0.4690017974157334, 'f1-score': 0.42896111299525064, 'support': 53959}, 'weighted avg': {'precision': 0.5207806187508838, 'recall': 0.4314386849274449, 'f1-score': 0.41933385153660285, 'support': 53959}}
[[ 7888  1437  5974]
 [ 7916  6188 10072]
 [ 3954  1326  9204]]
Evaluating performance on  val set...
81/81 - 1s - 775ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1175843
{'0': {'precision': 0.39410582719357, 'recall': 0.5084687175941929, 'f1-score': 0.4440419590974266, 'support': 5786}, '1': {'precision': 0.6956782713085234, 'recall': 0.25641592920353984, 'f1-score': 0.3747171031361138, 'support': 9040}, '2': {'precision': 0.37845528455284555, 'recall': 0.6408535536052314, 'f1-score': 0.47588013545460356, 'support': 5811}, 'accuracy': 0.4353345932063769, 'macro avg': {'precision': 0.48941312768497963, 'recall': 0.46857940013432137, 'f1-score': 0.4315463992293813, 'support': 20637}, 'weighted avg': {'precision': 0.5218021779962027, 'recall': 0.4353345932063769, 'f1-score': 0.42263937853442274, 'support': 20637}}
[[2942  504 2340]
 [2946 2318 3776]
 [1577  510 3724]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49611622
{'0': {'precision': 0.564640143048726, 'recall': 0.3775237241276246, 'f1-score': 0.45250100756795486, 'support': 66915}, '1': {'precision': 0.8606268891557285, 'recall': 0.9305035225371693, 'f1-score': 0.8942021716807487, 'support': 424410}, '2': {'precision': 0.5557175251052802, 'recall': 0.4551068533529845, 'f1-score': 0.5004051338562261, 'support': 67850}, 'accuracy': 0.8066455045379354, 'macro avg': {'precision': 0.6603281857699116, 'recall': 0.5877113666725928, 'f1-score': 0.6157027710349766, 'support': 559175}, 'weighted avg': {'precision': 0.7882093929039773, 'recall': 0.8066455045379354, 'f1-score': 0.7935618311558656, 'support': 559175}}
[[ 25262  33210   8443]
 [ 13251 394915  16244]
 [  6227  30744  30879]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43248168
{'0': {'precision': 0.537062125024192, 'recall': 0.4113243904246646, 'f1-score': 0.4658580601838251, 'support': 13493}, '1': {'precision': 0.8966420807453416, 'recall': 0.9301148583718483, 'f1-score': 0.9130717985346504, 'support': 109265}, '2': {'precision': 0.5189742775484281, 'recall': 0.4836490085824208, 'f1-score': 0.500689338235294, 'support': 13516}, 'accuracy': 0.8344658555557186, 'macro avg': {'precision': 0.6508928277726539, 'recall': 0.6083627524596446, 'f1-score': 0.6265397323179233, 'support': 136274}, 'weighted avg': {'precision': 0.8235806723288062, 'recall': 0.8344658555557186, 'f1-score': 0.8278903530279963, 'support': 136274}}
[[  5550   6195   1748]
 [  3325 101629   4311]
 [  1459   5520   6537]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43197006
{'0': {'precision': 0.5763803680981595, 'recall': 0.3961627661817415, 'f1-score': 0.46957390978383107, 'support': 4743}, '1': {'precision': 0.8941348259917254, 'recall': 0.9417615092791961, 'f1-score': 0.9173304037352376, 'support': 39012}, '2': {'precision': 0.509865005192108, 'recall': 0.4416460535192264, 'f1-score': 0.473310037353898, 'support': 4447}, 'accuracy': 0.8419360192523132, 'macro avg': {'precision': 0.6601267330939976, 'recall': 0.5931901096600547, 'f1-score': 0.6200714502909889, 'support': 48202}, 'weighted avg': {'precision': 0.8274164888504226, 'recall': 0.8419360192523132, 'f1-score': 0.8323076324786645, 'support': 48202}}
[[ 1879  2272   592]
 [  976 36740  1296]
 [  405  2078  1964]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0471414
{'0': {'precision': 0.4593680969275052, 'recall': 0.4506550505105782, 'f1-score': 0.4549698620449611, 'support': 91367}, '1': {'precision': 0.5993731383962466, 'recall': 0.48108880954427197, 'f1-score': 0.5337563440776328, 'support': 127993}, '2': {'precision': 0.42161262243406095, 'recall': 0.5462079989489473, 'f1-score': 0.4758902254061221, 'support': 91337}, 'accuracy': 0.4912825035323804, 'macro avg': {'precision': 0.49345128591927095, 'recall': 0.4926506196679325, 'f1-score': 0.4882054771762387, 'support': 310697}, 'weighted avg': {'precision': 0.5059446441709639, 'recall': 0.4912825035323804, 'f1-score': 0.49357635461851707, 'support': 310697}}
[[41175 19438 30754]
 [28731 61576 37686]
 [19728 21720 49889]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0578965
{'0': {'precision': 0.4129373281501849, 'recall': 0.49312160326086957, 'f1-score': 0.4494813973889262, 'support': 35328}, '1': {'precision': 0.6375619450104395, 'recall': 0.4159008861174926, 'f1-score': 0.5034113592801883, 'support': 60940}, '2': {'precision': 0.3933780778881658, 'recall': 0.5558341980860141, 'f1-score': 0.4607040890683423, 'support': 34692}, 'accuracy': 0.4738011606597434, 'macro avg': {'precision': 0.4812924503495967, 'recall': 0.48828556248812544, 'f1-score': 0.4711989485791523, 'support': 130960}, 'weighted avg': {'precision': 0.5122812090403341, 'recall': 0.4738011606597434, 'f1-score': 0.4775497350293952, 'support': 130960}}
[[17421  7174 10733]
 [16592 25345 19003]
 [ 8175  7234 19283]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0468959
{'0': {'precision': 0.40899268037643777, 'recall': 0.5068682505399568, 'f1-score': 0.4527006172839506, 'support': 11575}, '1': {'precision': 0.64533374064457, 'recall': 0.4254355049843923, 'f1-score': 0.5128049520572885, 'support': 19862}, '2': {'precision': 0.4143748408454291, 'recall': 0.5558497011101623, 'f1-score': 0.47479757823327745, 'support': 11710}, 'accuracy': 0.48267550467008136, 'macro avg': {'precision': 0.4895670872888123, 'recall': 0.4960511522115038, 'f1-score': 0.4801010491915055, 'support': 43147}, 'weighted avg': {'precision': 0.51924904207337, 'recall': 0.48267550467008136, 'f1-score': 0.4863657089469782, 'support': 43147}}
[[5867 2397 3311]
 [5524 8450 5888]
 [2954 2247 6509]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2814068
{'0': {'precision': 0.3883645826801279, 'recall': 0.2467430278884462, 'f1-score': 0.3017638317051185, 'support': 100400}, '1': {'precision': 0.23310225303292895, 'recall': 0.011097512342028906, 'f1-score': 0.02118638505664142, 'support': 72719}, '2': {'precision': 0.38793172303948054, 'recall': 0.7718706179302608, 'f1-score': 0.5163519475687051, 'support': 106970}, 'accuracy': 0.3861165558090464, 'macro avg': {'precision': 0.3364661862508458, 'recall': 0.3432370527202453, 'f1-score': 0.279767388110155, 'support': 280089}, 'weighted avg': {'precision': 0.34788878982366184, 'recall': 0.3861165558090464, 'f1-score': 0.3108722915557276, 'support': 280089}}
[[24773  1345 74282]
 [15922   807 55990]
 [23093  1310 82567]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.390191
{'0': {'precision': 0.3796420935941088, 'recall': 0.24058509170283765, 'f1-score': 0.2945250710281809, 'support': 39857}, '1': {'precision': 0.27416666666666667, 'recall': 0.008881330309901738, 'f1-score': 0.017205313251751907, 'support': 37044}, '2': {'precision': 0.33439266338274354, 'recall': 0.7822531396861642, 'f1-score': 0.46850972815240643, 'support': 37663}, 'accuracy': 0.34373799797493104, 'macro avg': {'precision': 0.32940047454783966, 'recall': 0.3439065205663012, 'f1-score': 0.2600800374774464, 'support': 114564}, 'weighted avg': {'precision': 0.3306610785706213, 'recall': 0.34373799797493104, 'f1-score': 0.26205196459160107, 'support': 114564}}
[[ 9589   443 29825]
 [ 7896   329 28819]
 [ 7773   428 29462]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3509334
{'0': {'precision': 0.3795289855072464, 'recall': 0.23781723830373794, 'f1-score': 0.2924081551268631, 'support': 12333}, '1': {'precision': 0.2286282306163022, 'recall': 0.01110681862082287, 'f1-score': 0.021184489269595652, 'support': 10354}, '2': {'precision': 0.35046341647200663, 'recall': 0.7696508356776436, 'f1-score': 0.48161955058506783, 'support': 12086}, 'accuracy': 0.35516061311937425, 'macro avg': {'precision': 0.3195402108651851, 'recall': 0.3395249642007348, 'f1-score': 0.2650707316605088, 'support': 34773}, 'weighted avg': {'precision': 0.32449453684015567, 'recall': 0.35516061311937425, 'f1-score': 0.2774125864161311, 'support': 34773}}
[[2933  192 9208]
 [2207  115 8032]
 [2588  196 9302]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0607032
{'0': {'precision': 0.47629183833573807, 'recall': 0.5401379928203915, 'f1-score': 0.5062096952876284, 'support': 160733}, '1': {'precision': 0.48922142629468707, 'recall': 0.2514550800617385, 'f1-score': 0.33217527992618834, 'support': 115973}, '2': {'precision': 0.47840491476087293, 'recall': 0.5799150481739014, 'f1-score': 0.5242917433416711, 'support': 164093}, 'accuracy': 0.4789938271184826, 'macro avg': {'precision': 0.48130605979709934, 'recall': 0.45716937368534377, 'f1-score': 0.45422557285182924, 'support': 440799}, 'weighted avg': {'precision': 0.48048019664461095, 'recall': 0.4789938271184826, 'f1-score': 0.46715299202518845, 'support': 440799}}
[[86818 14709 59206]
 [42266 29162 44545]
 [53195 15738 95160]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.10946
{'0': {'precision': 0.44561426489610795, 'recall': 0.5261072125886833, 'f1-score': 0.48252690555131994, 'support': 51729}, '1': {'precision': 0.5394112060778727, 'recall': 0.2012982168171305, 'f1-score': 0.2931851831728222, 'support': 53612}, '2': {'precision': 0.4230614129798499, 'recall': 0.6181479510377861, 'f1-score': 0.5023284550334016, 'support': 52612}, 'accuracy': 0.4465189011921268, 'macro avg': {'precision': 0.4693622946512768, 'recall': 0.44851779348119997, 'f1-score': 0.4260135145858479, 'support': 157953}, 'weighted avg': {'precision': 0.469938532023789, 'recall': 0.4465189011921268, 'f1-score': 0.4248566536485088, 'support': 157953}}
[[27215  4492 20022]
 [18491 10792 24329]
 [15367  4723 32522]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1108919
{'0': {'precision': 0.43902109248242294, 'recall': 0.5257448186528497, 'f1-score': 0.47848511641615094, 'support': 18528}, '1': {'precision': 0.5582426440951229, 'recall': 0.2655673265902881, 'f1-score': 0.35991554328406694, 'support': 20861}, '2': {'precision': 0.41517328491355493, 'recall': 0.5824887855125436, 'f1-score': 0.4848009955981655, 'support': 18057}, 'accuracy': 0.4491000243707134, 'macro avg': {'precision': 0.47081234049703363, 'recall': 0.4579336435852271, 'f1-score': 0.4410672184327944, 'support': 57446}, 'weighted avg': {'precision': 0.47481924948067317, 'recall': 0.4491000243707134, 'f1-score': 0.43741290886960693, 'support': 57446}}
[[ 9741  2184  6603]
 [ 7108  5540  8213]
 [ 5339  2200 10518]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
4450/4450 - 40s - 40s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6039614
{'0': {'precision': 0.5828463389480921, 'recall': 0.3879439004477356, 'f1-score': 0.4658301513907405, 'support': 192301}, '1': {'precision': 0.8074993109929108, 'recall': 0.8797705783689688, 'f1-score': 0.8420871377411393, 'support': 755988}, '2': {'precision': 0.5359459344129381, 'recall': 0.5265207093149996, 'f1-score': 0.5311915159076731, 'support': 190832}, 'accuracy': 0.7375643149410818, 'macro avg': {'precision': 0.6420971947846471, 'recall': 0.5980783960439013, 'f1-score': 0.6130362683465176, 'support': 1139121}, 'weighted avg': {'precision': 0.7240823033732637, 'recall': 0.7375643149410818, 'f1-score': 0.726486224372066, 'support': 1139121}}
[[ 74602  86819  30880]
 [ 34773 665096  56119]
 [ 18621  71734 100477]]
Evaluating performance on  train set...
1504/1504 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53988665
{'0': {'precision': 0.5841204526325634, 'recall': 0.35475870425415096, 'f1-score': 0.4414238262385451, 'support': 52819}, '1': {'precision': 0.8420805886689383, 'recall': 0.8895404336560753, 'f1-score': 0.8651601272571479, 'support': 278654}, '2': {'precision': 0.4981415186447646, 'recall': 0.5451580249690698, 'f1-score': 0.5205903675924352, 'support': 53346}, 'accuracy': 0.7683976103051045, 'macro avg': {'precision': 0.6414475199820887, 'recall': 0.5964857209597653, 'f1-score': 0.609058107029376, 'support': 384819}, 'weighted avg': {'precision': 0.7589948521153512, 'recall': 0.7683976103051045, 'f1-score': 0.7592330652290895, 'support': 384819}}
[[ 18738  26222   7859]
 [  9340 247874  21440]
 [  4001  20263  29082]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5486921
{'0': {'precision': 0.5855635130041462, 'recall': 0.3542961400307885, 'f1-score': 0.44147632410926785, 'support': 17539}, '1': {'precision': 0.8409257419283613, 'recall': 0.8818409531026353, 'f1-score': 0.8608974852944954, 'support': 95016}, '2': {'precision': 0.4736426456071076, 'recall': 0.5344174649142348, 'f1-score': 0.5021980322378061, 'support': 17956}, 'accuracy': 0.7631464014527511, 'macro avg': {'precision': 0.6333773001798718, 'recall': 0.5901848526825529, 'f1-score': 0.6015239472138565, 'support': 130511}, 'weighted avg': {'precision': 0.7560766992373525, 'recall': 0.7631464014527511, 'f1-score': 0.7551819890902396, 'support': 130511}}
[[ 6214  8854  2471]
 [ 3034 83789  8193]
 [ 1364  6996  9596]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
6203/6203 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.52342194
{'0': {'precision': 0.5813156364899247, 'recall': 0.38022834342376866, 'f1-score': 0.45974533892612435, 'support': 202502}, '1': {'precision': 0.8452772217882165, 'recall': 0.9289667178075139, 'f1-score': 0.8851481905481079, 'support': 1181052}, '2': {'precision': 0.5407120398894782, 'recall': 0.41663566953797965, 'f1-score': 0.47063343975895294, 'support': 204320}, 'accuracy': 0.7930616661019703, 'macro avg': {'precision': 0.6557682993892066, 'recall': 0.5752769102564207, 'f1-score': 0.6051756564110617, 'support': 1587874}, 'weighted avg': {'precision': 0.7724241447105487, 'recall': 0.7930616661019703, 'f1-score': 0.7775586827279691, 'support': 1587874}}
[[  76997  101464   24041]
 [  35627 1097158   48267]
 [  19829   99364   85127]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.556661
{'0': {'precision': 0.5191321840323593, 'recall': 0.4084758743936686, 'f1-score': 0.4572038176518774, 'support': 58755}, '1': {'precision': 0.8425933412703502, 'recall': 0.905547415071781, 'f1-score': 0.8729368265981108, 'support': 333723}, '2': {'precision': 0.5113262424898627, 'recall': 0.4047014937912725, 'f1-score': 0.451808358970511, 'support': 59513}, 'accuracy': 0.7749866700885637, 'macro avg': {'precision': 0.6243505892641908, 'recall': 0.572908261085574, 'f1-score': 0.5939830010734998, 'support': 451991}, 'weighted avg': {'precision': 0.7569286728516398, 'recall': 0.7749866700885637, 'f1-score': 0.7634456831139323, 'support': 451991}}
[[ 24000  27394   7361]
 [ 15864 302202  15657]
 [  6367  29061  24085]]
Evaluating performance on  val set...
579/579 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50396115
{'0': {'precision': 0.5352837287875297, 'recall': 0.40322767237390095, 'f1-score': 0.4599650291973211, 'support': 17288}, '1': {'precision': 0.8674385691939716, 'recall': 0.9178320912840542, 'f1-score': 0.8919240915666752, 'support': 114193}, '2': {'precision': 0.5085079454366475, 'recall': 0.4358989813754445, 'f1-score': 0.4694122610586441, 'support': 16591}, 'accuracy': 0.803750877951267, 'macro avg': {'precision': 0.6370767478060496, 'recall': 0.5856529150111333, 'f1-score': 0.6071004606075467, 'support': 148072}, 'weighted avg': {'precision': 0.7884411162001285, 'recall': 0.803750877951267, 'f1-score': 0.7941500218559929, 'support': 148072}}
[[  6971   8382   1935]
 [  4328 104810   5055]
 [  1724   7635   7232]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
5183/5183 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.823633
{'0': {'precision': 0.5331961469997853, 'recall': 0.41558974022566253, 'f1-score': 0.467104014097358, 'support': 304880}, '1': {'precision': 0.7051680088793185, 'recall': 0.7774435072652145, 'f1-score': 0.7395440869905142, 'support': 709339}, '2': {'precision': 0.48510735272573374, 'recall': 0.4766410445875357, 'f1-score': 0.48083693403852296, 'support': 312621}, 'accuracy': 0.6234240752464502, 'macro avg': {'precision': 0.5744905028682792, 'recall': 0.5565580973594709, 'f1-score': 0.5624950117087985, 'support': 1326840}, 'weighted avg': {'precision': 0.6138032899703152, 'recall': 0.6234240752464502, 'f1-score': 0.6159882563804406, 'support': 1326840}}
[[126705 112629  65546]
 [ 65257 551471  92611]
 [ 45671 117942 149008]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7761623
{'0': {'precision': 0.5077893005619261, 'recall': 0.41555544477954187, 'f1-score': 0.45706570533688806, 'support': 80242}, '1': {'precision': 0.7313582524723775, 'recall': 0.7825547541102372, 'f1-score': 0.7560908386961297, 'support': 220851}, '2': {'precision': 0.4889175485845061, 'recall': 0.48350713982044163, 'f1-score': 0.4861972928965253, 'support': 79974}, 'accuracy': 0.6425143085074279, 'macro avg': {'precision': 0.5760217005396032, 'recall': 0.5605391129034069, 'f1-score': 0.5664512789765144, 'support': 381067}, 'weighted avg': {'precision': 0.6334002222784035, 'recall': 0.6425143085074279, 'f1-score': 0.6364823677899903, 'support': 381067}}
[[ 33345  32974  13923]
 [ 21525 172828  26498]
 [ 10797  30509  38668]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7370691
{'0': {'precision': 0.5054809401540589, 'recall': 0.3978314938597855, 'f1-score': 0.44524182324286715, 'support': 25732}, '1': {'precision': 0.7570617612595703, 'recall': 0.8154292926198674, 'f1-score': 0.7851622874806801, 'support': 81611}, '2': {'precision': 0.4920518762450705, 'recall': 0.4763272856074619, 'f1-score': 0.4840619125704916, 'support': 25409}, 'accuracy': 0.6695793660359166, 'macro avg': {'precision': 0.5848648592195665, 'recall': 0.5631960240290382, 'f1-score': 0.5714886744313463, 'support': 132752}, 'weighted avg': {'precision': 0.6575731369298393, 'recall': 0.6695793660359166, 'f1-score': 0.6616425453158886, 'support': 132752}}
[[10237 11289  4206]
 [ 6775 66548  8288]
 [ 3240 10066 12103]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
7324/7324 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88338584
{'0': {'precision': 0.5378226891826776, 'recall': 0.39737485549428625, 'f1-score': 0.45705255453667215, 'support': 488735}, '1': {'precision': 0.6447459727385378, 'recall': 0.7442151392756587, 'f1-score': 0.6909188597846455, 'support': 908881}, '2': {'precision': 0.5015220667384284, 'recall': 0.4882873252426167, 'f1-score': 0.4948162151254792, 'support': 477090}, 'accuracy': 0.5886635024371821, 'macro avg': {'precision': 0.5613635762198813, 'recall': 0.5432924400041873, 'f1-score': 0.5475958764822656, 'support': 1874706}, 'weighted avg': {'precision': 0.5804223698363945, 'recall': 0.5886635024371821, 'f1-score': 0.5800442696164753, 'support': 1874706}}
[[194211 196419  98105]
 [ 99040 676403 133438]
 [ 67855 176278 232957]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8369605
{'0': {'precision': 0.526863352325953, 'recall': 0.3886224332189832, 'f1-score': 0.44730550968182603, 'support': 123014}, '1': {'precision': 0.685794126547721, 'recall': 0.7693057757521695, 'f1-score': 0.7251534849204364, 'support': 276899}, '2': {'precision': 0.49292057811874473, 'recall': 0.48718093653857025, 'f1-score': 0.49003395116879744, 'support': 123839}, 'accuracy': 0.613187157280545, 'macro avg': {'precision': 0.5685260189974729, 'recall': 0.5483697151699076, 'f1-score': 0.55416431525702, 'support': 523752}, 'weighted avg': {'precision': 0.6028617890597257, 'recall': 0.613187157280545, 'f1-score': 0.6043020919591272, 'support': 523752}}
[[ 47806  50779  24429]
 [ 26243 213020  37636]
 [ 16688  46819  60332]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8301381
{'0': {'precision': 0.5411137331821386, 'recall': 0.4005989926033489, 'f1-score': 0.46037312751782844, 'support': 44074}, '1': {'precision': 0.6928875423789944, 'recall': 0.7633863821501659, 'f1-score': 0.7264305228628417, 'support': 100662}, '2': {'precision': 0.47851575222007514, 'recall': 0.49134971240023184, 'f1-score': 0.4848478181958179, 'support': 44854}, 'accuracy': 0.6146895933329817, 'macro avg': {'precision': 0.5708390092604028, 'recall': 0.5517783623845821, 'f1-score': 0.5572171561921627, 'support': 189590}, 'weighted avg': {'precision': 0.6068876945899212, 'recall': 0.6146895933329817, 'f1-score': 0.6074254894878177, 'support': 189590}}
[[17656 16971  9447]
 [ 9247 76844 14571]
 [ 5726 17089 22039]]
testing model on single stock: results/universal/W6/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
29350/29350 - 259s - 259s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0054984
{'0': {'precision': 0.5053471794219601, 'recall': 0.5020322297834947, 'f1-score': 0.5036842504059248, 'support': 2469455}, '1': {'precision': 0.5463399284047494, 'recall': 0.5190947788934258, 'f1-score': 0.5323689990447136, 'support': 2535248}, '2': {'precision': 0.5027048698973232, 'recall': 0.5312853145910972, 'f1-score': 0.5166000972862561, 'support': 2508701}, 'accuracy': 0.5175571551855856, 'macro avg': {'precision': 0.5181306592413443, 'recall': 0.5174707744226725, 'f1-score': 0.5175511155789648, 'support': 7513404}, 'weighted avg': {'precision': 0.5182971046923638, 'recall': 0.5175571551855856, 'f1-score': 0.517675904468654, 'support': 7513404}}
[[1239746  535043  694666]
 [ 595387 1316034  623827]
 [ 618123  557742 1332836]]
Evaluating performance on  train set...
5452/5452 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99570763
{'0': {'precision': 0.4912642167517566, 'recall': 0.5275789738823795, 'f1-score': 0.508774409568771, 'support': 460532}, '1': {'precision': 0.5942298336940658, 'recall': 0.4289727860971676, 'f1-score': 0.4982560099265766, 'support': 475529}, '2': {'precision': 0.4768308713686993, 'recall': 0.5787568511190343, 'f1-score': 0.522872950775345, 'support': 459414}, 'accuracy': 0.5108260628101543, 'macro avg': {'precision': 0.5207749739381738, 'recall': 0.5117695370328604, 'f1-score': 0.509967790090231, 'support': 1395475}, 'weighted avg': {'precision': 0.5215995906732869, 'recall': 0.5108260628101543, 'f1-score': 0.5098315859040145, 'support': 1395475}}
[[242967  69574 147991]
 [127803 203989 143737]
 [123805  69720 265889]]
Evaluating performance on  val set...
1969/1969 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0053344
{'0': {'precision': 0.4645411774888563, 'recall': 0.5019774464218909, 'f1-score': 0.4825343004569113, 'support': 149688}, '1': {'precision': 0.6044123288618883, 'recall': 0.4660049651855156, 'f1-score': 0.5262604553108188, 'support': 206236}, '2': {'precision': 0.4442044047287824, 'recall': 0.5496459406368344, 'f1-score': 0.4913318167281153, 'support': 148139}, 'accuracy': 0.5012686906200217, 'macro avg': {'precision': 0.5043859703598423, 'recall': 0.5058761174147469, 'f1-score': 0.5000421908319485, 'support': 504063}, 'weighted avg': {'precision': 0.5157923060078391, 'recall': 0.5012686906200217, 'f1-score': 0.5030102380586602, 'support': 504063}}
[[75140 31600 42948]
 [51198 96107 58931]
 [35413 31302 81424]]
training model: results/universal/W6/deepVOL_L2/h20
Epoch 1/50
9426/9426 - 329s - loss: 2.8795 - accuracy20: 0.5115 - val_loss: 3.0023 - val_accuracy20: 0.5108 - 329s/epoch - 35ms/step
Epoch 2/50
9426/9426 - 327s - loss: 2.7974 - accuracy20: 0.5369 - val_loss: 3.0098 - val_accuracy20: 0.5174 - 327s/epoch - 35ms/step
Epoch 3/50
9426/9426 - 321s - loss: 2.7605 - accuracy20: 0.5460 - val_loss: 3.0492 - val_accuracy20: 0.5163 - 321s/epoch - 34ms/step
Epoch 4/50
9426/9426 - 316s - loss: 2.7404 - accuracy20: 0.5510 - val_loss: 3.0649 - val_accuracy20: 0.5196 - 316s/epoch - 34ms/step
Epoch 5/50
9426/9426 - 315s - loss: 2.7273 - accuracy20: 0.5538 - val_loss: 3.0576 - val_accuracy20: 0.5196 - 315s/epoch - 33ms/step
Epoch 6/50
9426/9426 - 318s - loss: 2.7186 - accuracy20: 0.5555 - val_loss: 3.0669 - val_accuracy20: 0.5221 - 318s/epoch - 34ms/step
Epoch 7/50
9426/9426 - 312s - loss: 2.7114 - accuracy20: 0.5572 - val_loss: 3.0393 - val_accuracy20: 0.5236 - 312s/epoch - 33ms/step
Epoch 8/50
9426/9426 - 315s - loss: 2.7057 - accuracy20: 0.5580 - val_loss: 3.0357 - val_accuracy20: 0.5264 - 315s/epoch - 33ms/step
Epoch 9/50
9426/9426 - 314s - loss: 2.7011 - accuracy20: 0.5593 - val_loss: 2.9856 - val_accuracy20: 0.5278 - 314s/epoch - 33ms/step
Epoch 10/50
9426/9426 - 313s - loss: 2.6973 - accuracy20: 0.5602 - val_loss: 2.9717 - val_accuracy20: 0.5287 - 313s/epoch - 33ms/step
Epoch 11/50
9426/9426 - 321s - loss: 2.6938 - accuracy20: 0.5609 - val_loss: 2.9651 - val_accuracy20: 0.5298 - 321s/epoch - 34ms/step
Epoch 12/50
9426/9426 - 311s - loss: 2.6901 - accuracy20: 0.5618 - val_loss: 2.9593 - val_accuracy20: 0.5306 - 311s/epoch - 33ms/step
Epoch 13/50
9426/9426 - 310s - loss: 2.6874 - accuracy20: 0.5623 - val_loss: 2.9526 - val_accuracy20: 0.5298 - 310s/epoch - 33ms/step
Epoch 14/50
9426/9426 - 310s - loss: 2.6849 - accuracy20: 0.5629 - val_loss: 2.9352 - val_accuracy20: 0.5313 - 310s/epoch - 33ms/step
Epoch 15/50
9426/9426 - 310s - loss: 2.6826 - accuracy20: 0.5633 - val_loss: 2.9228 - val_accuracy20: 0.5319 - 310s/epoch - 33ms/step
Epoch 16/50
9426/9426 - 313s - loss: 2.6805 - accuracy20: 0.5638 - val_loss: 2.9324 - val_accuracy20: 0.5318 - 313s/epoch - 33ms/step
Epoch 17/50
9426/9426 - 311s - loss: 2.6783 - accuracy20: 0.5644 - val_loss: 2.9193 - val_accuracy20: 0.5317 - 311s/epoch - 33ms/step
Epoch 18/50
9426/9426 - 311s - loss: 2.6760 - accuracy20: 0.5648 - val_loss: 2.9241 - val_accuracy20: 0.5323 - 311s/epoch - 33ms/step
Epoch 19/50
9426/9426 - 313s - loss: 2.6742 - accuracy20: 0.5651 - val_loss: 2.9249 - val_accuracy20: 0.5320 - 313s/epoch - 33ms/step
Epoch 20/50
9426/9426 - 311s - loss: 2.6725 - accuracy20: 0.5655 - val_loss: 2.9211 - val_accuracy20: 0.5329 - 311s/epoch - 33ms/step
Epoch 21/50
9426/9426 - 310s - loss: 2.6709 - accuracy20: 0.5657 - val_loss: 2.9194 - val_accuracy20: 0.5328 - 310s/epoch - 33ms/step
Epoch 22/50
9426/9426 - 309s - loss: 2.6692 - accuracy20: 0.5661 - val_loss: 2.9202 - val_accuracy20: 0.5329 - 309s/epoch - 33ms/step
Epoch 23/50
9426/9426 - 315s - loss: 2.6677 - accuracy20: 0.5665 - val_loss: 2.9146 - val_accuracy20: 0.5327 - 315s/epoch - 33ms/step
Epoch 24/50
9426/9426 - 311s - loss: 2.6658 - accuracy20: 0.5668 - val_loss: 2.9167 - val_accuracy20: 0.5321 - 311s/epoch - 33ms/step
Epoch 25/50
9426/9426 - 316s - loss: 2.6643 - accuracy20: 0.5672 - val_loss: 2.9136 - val_accuracy20: 0.5324 - 316s/epoch - 34ms/step
Epoch 26/50
9426/9426 - 312s - loss: 2.6633 - accuracy20: 0.5673 - val_loss: 2.9145 - val_accuracy20: 0.5333 - 312s/epoch - 33ms/step
Epoch 27/50
9426/9426 - 318s - loss: 2.6619 - accuracy20: 0.5677 - val_loss: 2.9167 - val_accuracy20: 0.5322 - 318s/epoch - 34ms/step
Epoch 28/50
9426/9426 - 321s - loss: 2.6604 - accuracy20: 0.5679 - val_loss: 2.9081 - val_accuracy20: 0.5328 - 321s/epoch - 34ms/step
Epoch 29/50
9426/9426 - 321s - loss: 2.6595 - accuracy20: 0.5682 - val_loss: 2.9095 - val_accuracy20: 0.5333 - 321s/epoch - 34ms/step
Epoch 30/50
9426/9426 - 314s - loss: 2.6582 - accuracy20: 0.5683 - val_loss: 2.9045 - val_accuracy20: 0.5324 - 314s/epoch - 33ms/step
Epoch 31/50
9426/9426 - 322s - loss: 2.6569 - accuracy20: 0.5685 - val_loss: 2.9087 - val_accuracy20: 0.5331 - 322s/epoch - 34ms/step
Epoch 32/50
9426/9426 - 317s - loss: 2.6556 - accuracy20: 0.5689 - val_loss: 2.9090 - val_accuracy20: 0.5319 - 317s/epoch - 34ms/step
Epoch 33/50
9426/9426 - 318s - loss: 2.6542 - accuracy20: 0.5692 - val_loss: 2.9138 - val_accuracy20: 0.5321 - 318s/epoch - 34ms/step
Epoch 34/50
9426/9426 - 315s - loss: 2.6535 - accuracy20: 0.5695 - val_loss: 2.9060 - val_accuracy20: 0.5324 - 315s/epoch - 33ms/step
Epoch 35/50
9426/9426 - 316s - loss: 2.6523 - accuracy20: 0.5698 - val_loss: 2.9076 - val_accuracy20: 0.5316 - 316s/epoch - 34ms/step
Epoch 36/50
9426/9426 - 312s - loss: 2.6513 - accuracy20: 0.5696 - val_loss: 2.9065 - val_accuracy20: 0.5323 - 312s/epoch - 33ms/step
Epoch 37/50
9426/9426 - 320s - loss: 2.6498 - accuracy20: 0.5702 - val_loss: 2.9301 - val_accuracy20: 0.5314 - 320s/epoch - 34ms/step
Epoch 38/50
9426/9426 - 317s - loss: 2.6490 - accuracy20: 0.5702 - val_loss: 2.9169 - val_accuracy20: 0.5308 - 317s/epoch - 34ms/step
Epoch 39/50
9426/9426 - 311s - loss: 2.6483 - accuracy20: 0.5705 - val_loss: 2.9170 - val_accuracy20: 0.5309 - 311s/epoch - 33ms/step
Epoch 40/50
9426/9426 - 325s - loss: 2.6469 - accuracy20: 0.5708 - val_loss: 2.9116 - val_accuracy20: 0.5317 - 325s/epoch - 34ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 716s - 716s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0167431
{'0': {'precision': 0.45115368793315036, 'recall': 0.4563371717281054, 'f1-score': 0.4537306260979145, 'support': 3141070}, '1': {'precision': 0.6213827560596854, 'recall': 0.5049006075506925, 'f1-score': 0.5571182904635209, 'support': 4556986}, '2': {'precision': 0.4293630925782996, 'recall': 0.5419328437437612, 'f1-score': 0.47912475087802703, 'support': 3120573}, 'accuracy': 0.5014824891397976, 'macro avg': {'precision': 0.5006331788570452, 'recall': 0.5010568743408531, 'f1-score': 0.49665788914648745, 'support': 10818629}, 'weighted avg': {'precision': 0.5165716199767941, 'recall': 0.5014824891397976, 'f1-score': 0.504604018579921, 'support': 10818629}}
[[1433387  737701  969982]
 [ 978564 2300825 1277597]
 [ 765208  664224 1691141]]
Evaluating performance on  train set...
9426/9426 - 162s - 162s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95871764
{'0': {'precision': 0.4779673325609181, 'recall': 0.45688526597008694, 'f1-score': 0.46718858610492586, 'support': 694345}, '1': {'precision': 0.6817186345899343, 'recall': 0.5660695637420616, 'f1-score': 0.61853473304687, 'support': 1025563}, '2': {'precision': 0.4481595991512961, 'recall': 0.5806127769969565, 'f1-score': 0.5058595962214666, 'support': 692291}, 'accuracy': 0.5388149982650685, 'macro avg': {'precision': 0.5359485221007162, 'recall': 0.5345225355697018, 'f1-score': 0.5305276384577541, 'support': 2412199}, 'weighted avg': {'precision': 0.5560389058402798, 'recall': 0.5388149982650685, 'f1-score': 0.5426328594674515, 'support': 2412199}}
[[317236 146514 230595]
 [180674 580540 264349]
 [165809 124529 401953]]
Evaluating performance on  val set...
3323/3323 - 59s - 59s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96815
{'0': {'precision': 0.46165519850133296, 'recall': 0.44507009234215655, 'f1-score': 0.4532109645603588, 'support': 230339}, '1': {'precision': 0.6764362187378911, 'recall': 0.5666975954767254, 'f1-score': 0.6167232751114783, 'support': 391221}, '2': {'precision': 0.4267015881045247, 'recall': 0.5605335291880337, 'f1-score': 0.4845462704898672, 'support': 228741}, 'accuracy': 0.532091576982739, 'macro avg': {'precision': 0.5215976684479162, 'recall': 0.5241004056689719, 'f1-score': 0.5181601700539015, 'support': 850301}, 'weighted avg': {'precision': 0.5510723833831456, 'recall': 0.532091576982739, 'f1-score': 0.536872066757982, 'support': 850301}}
[[102517  56900  70922]
 [ 68172 221704 101345]
 [ 51375  49149 128217]]
testing model out of sample: results/universal/W6/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 299s - 299s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89421886
{'0': {'precision': 0.5305670329120938, 'recall': 0.4110754963338837, 'f1-score': 0.46323971065194247, 'support': 1239186}, '1': {'precision': 0.6574484224230022, 'recall': 0.7472353619112869, 'f1-score': 0.6994723158993109, 'support': 2011294}, '2': {'precision': 0.5052281315119614, 'recall': 0.5070298534903857, 'f1-score': 0.5061273890551471, 'support': 1234663}, 'accuracy': 0.5882354252696068, 'macro avg': {'precision': 0.5644145289490191, 'recall': 0.5551135705785187, 'f1-score': 0.5562798052021335, 'support': 4485143}, 'weighted avg': {'precision': 0.5804898053667428, 'recall': 0.5882354252696068, 'f1-score': 0.5809806725830863, 'support': 4485143}}
[[ 509399  415724  314063]
 [ 209392 1502910  298992]
 [ 241312  367340  626011]]
Evaluating performance on  train set...
5153/5153 - 85s - 85s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90289193
{'0': {'precision': 0.5051651803596652, 'recall': 0.41623191258982184, 'f1-score': 0.45640662598967624, 'support': 345406}, '1': {'precision': 0.6758328540257275, 'recall': 0.706648274808723, 'f1-score': 0.690897127484081, 'support': 628539}, '2': {'precision': 0.47436036930197256, 'recall': 0.5186062030347869, 'f1-score': 0.4954975058524801, 'support': 344670}, 'accuracy': 0.581422932394975, 'macro avg': {'precision': 0.551786134562455, 'recall': 0.5471621301444439, 'f1-score': 0.5476004197754124, 'support': 1318615}, 'weighted avg': {'precision': 0.5784646610353273, 'recall': 0.581422932394975, 'f1-score': 0.5783981692992126, 'support': 1318615}}
[[143769 111726  89911]
 [ 76223 444156 108160]
 [ 64606 101316 178748]]
Evaluating performance on  val set...
1795/1795 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88602424
{'0': {'precision': 0.5057967811288151, 'recall': 0.4261986997155628, 'f1-score': 0.46259866033280345, 'support': 118128}, '1': {'precision': 0.6920905920314497, 'recall': 0.713679046448847, 'f1-score': 0.7027190519083699, 'support': 222998}, '2': {'precision': 0.4721638330757342, 'recall': 0.5188084846220471, 'f1-score': 0.4943883867522232, 'support': 117766}, 'accuracy': 0.5896659780514806, 'macro avg': {'precision': 0.5566837354119997, 'recall': 0.5528954102621523, 'f1-score': 0.5532353663311321, 'support': 458892}, 'weighted avg': {'precision': 0.5876947647137253, 'recall': 0.5896659780514806, 'f1-score': 0.5874431030384457, 'support': 458892}}
[[ 50346  37161  30621]
 [ 26168 159149  37681]
 [ 23024  33644  61098]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0970527
{'0': {'precision': 0.4390439360075285, 'recall': 0.6175491209927612, 'f1-score': 0.5132178277385311, 'support': 96700}, '1': {'precision': 0.5285636695798154, 'recall': 0.14904488750278458, 'f1-score': 0.2325227798473017, 'support': 71824}, '2': {'precision': 0.4714890503318873, 'recall': 0.5278371024838361, 'f1-score': 0.49807445442875486, 'support': 102543}, 'accuracy': 0.4594731191919341, 'macro avg': {'precision': 0.4796988853064104, 'recall': 0.4314770369931273, 'f1-score': 0.41460502067152927, 'support': 271067}, 'weighted avg': {'precision': 0.47503756379054396, 'recall': 0.4594731191919341, 'f1-score': 0.4331140598544137, 'support': 271067}}
[[59717  3978 33005]
 [33452 10705 27667]
 [42847  5570 54126]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1077131
{'0': {'precision': 0.43826072701938446, 'recall': 0.5837973577901517, 'f1-score': 0.5006671504482783, 'support': 18318}, '1': {'precision': 0.5838992877256916, 'recall': 0.19143043336591722, 'f1-score': 0.2883317655719602, 'support': 18414}, '2': {'precision': 0.417244164788912, 'recall': 0.5696871190572937, 'f1-score': 0.48169235299892016, 'support': 17227}, 'accuracy': 0.4453937248651754, 'macro avg': {'precision': 0.479801393177996, 'recall': 0.44830497007112086, 'f1-score': 0.4235637563397195, 'support': 53959}, 'weighted avg': {'precision': 0.4812514447736347, 'recall': 0.4453937248651754, 'f1-score': 0.42214785593257903, 'support': 53959}}
[[10694  1268  6356]
 [ 7538  3525  7351]
 [ 6169  1244  9814]]
Evaluating performance on  val set...
81/81 - 1s - 717ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0906883
{'0': {'precision': 0.44586329005258074, 'recall': 0.5928092452560993, 'f1-score': 0.5089416952474277, 'support': 7009}, '1': {'precision': 0.6225860621326617, 'recall': 0.22098047980926835, 'f1-score': 0.3261849774551853, 'support': 6711}, '2': {'precision': 0.445053715308863, 'recall': 0.5749602428798612, 'f1-score': 0.501734687440863, 'support': 6917}, 'accuracy': 0.46591074284052914, 'macro avg': {'precision': 0.5045010224980352, 'recall': 0.46291665598174303, 'f1-score': 0.4456204533811587, 'support': 20637}, 'weighted avg': {'precision': 0.5030608815109868, 'recall': 0.46591074284052914, 'f1-score': 0.44709495366184127, 'support': 20637}}
[[4155  442 2412]
 [2681 1483 2547]
 [2483  457 3977]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61932737
{'0': {'precision': 0.6059536197413409, 'recall': 0.3633831067528415, 'f1-score': 0.4543174788932542, 'support': 89740}, '1': {'precision': 0.793589199596673, 'recall': 0.9183213925567693, 'f1-score': 0.8514112153192489, 'support': 378814}, '2': {'precision': 0.5911499141855086, 'recall': 0.43709515454475234, 'f1-score': 0.502582061335059, 'support': 90621}, 'accuracy': 0.7512728573344659, 'macro avg': {'precision': 0.6635642445078408, 'recall': 0.5729332179514544, 'f1-score': 0.6027702518491873, 'support': 559175}, 'weighted avg': {'precision': 0.7306685264273384, 'recall': 0.7512728573344659, 'f1-score': 0.7311511202326123, 'support': 559175}}
[[ 32610  47369   9761]
 [ 13307 347873  17634]
 [  7899  43112  39610]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5401578
{'0': {'precision': 0.6049436632020264, 'recall': 0.38197661592764176, 'f1-score': 0.46827355397045406, 'support': 18132}, '1': {'precision': 0.8459552574762277, 'recall': 0.920614289427903, 'f1-score': 0.8817071477475665, 'support': 100018}, '2': {'precision': 0.5479349186483103, 'recall': 0.4831163098653719, 'f1-score': 0.5134881538822424, 'support': 18124}, 'accuracy': 0.7907597927704477, 'macro avg': {'precision': 0.6662779464421882, 'recall': 0.5952357384069722, 'f1-score': 0.6211562852000877, 'support': 136274}, 'weighted avg': {'precision': 0.7742516100578134, 'recall': 0.7907597927704477, 'f1-score': 0.7777256181294314, 'support': 136274}}
[[ 6926  9174  2032]
 [ 2748 92078  5192]
 [ 1775  7593  8756]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5492709
{'0': {'precision': 0.6281393464758304, 'recall': 0.36641461877756776, 'f1-score': 0.462839518455875, 'support': 6348}, '1': {'precision': 0.8432192648922687, 'recall': 0.928645208118143, 'f1-score': 0.8838729391133372, 'support': 35821}, '2': {'precision': 0.5304020598138245, 'recall': 0.4438919277308139, 'f1-score': 0.4833062624075077, 'support': 6033}, 'accuracy': 0.7939297124600639, 'macro avg': {'precision': 0.6672535570606413, 'recall': 0.5796505848755081, 'f1-score': 0.61000623999224, 'support': 48202}, 'weighted avg': {'precision': 0.7757417012985215, 'recall': 0.7939297124600639, 'f1-score': 0.7782893758815245, 'support': 48202}}
[[ 2326  3342   680]
 [  865 33265  1691]
 [  512  2843  2678]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
1214/1214 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0948931
{'0': {'precision': 0.5075597083156791, 'recall': 0.4122830851719016, 'f1-score': 0.4549870563423922, 'support': 110412}, '1': {'precision': 0.44951772329560724, 'recall': 0.5004099995567572, 'f1-score': 0.47360058729451243, 'support': 90244}, '2': {'precision': 0.46997926171712984, 'recall': 0.5148626421061241, 'f1-score': 0.4913981898686419, 'support': 110041}, 'accuracy': 0.47421120899139674, 'macro avg': {'precision': 0.47568556444280535, 'recall': 0.4758519089449276, 'f1-score': 0.47332861116851555, 'support': 310697}, 'weighted avg': {'precision': 0.47739098824338255, 'recall': 0.47421120899139674, 'f1-score': 0.4732893799296981, 'support': 310697}}
[[45521 27203 37688]
 [18879 45159 26206]
 [25286 28099 56656]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1032894
{'0': {'precision': 0.4531910610026173, 'recall': 0.4698065952414081, 'f1-score': 0.46134927412467974, 'support': 43122}, '1': {'precision': 0.4986459700159133, 'recall': 0.39105399132985946, 'f1-score': 0.43834439767832817, 'support': 45674}, '2': {'precision': 0.4434156786549824, 'recall': 0.530428801821459, 'f1-score': 0.48303492365175693, 'support': 42164}, 'accuracy': 0.4618585827733659, 'macro avg': {'precision': 0.46508423655783765, 'recall': 0.46376312946424214, 'f1-score': 0.46090953181825495, 'support': 130960}, 'weighted avg': {'precision': 0.46589675963554034, 'recall': 0.4618585827733659, 'f1-score': 0.4603079561638445, 'support': 130960}}
[[20259  9284 13579]
 [13319 17861 14494]
 [11125  8674 22365]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0868219
{'0': {'precision': 0.4476984742694595, 'recall': 0.492496977455373, 'f1-score': 0.4690304446476345, 'support': 14061}, '1': {'precision': 0.5066315252508077, 'recall': 0.4046309499558634, 'f1-score': 0.44992260938502776, 'support': 14727}, '2': {'precision': 0.4674875918828925, 'recall': 0.5182115746221881, 'f1-score': 0.49154445765622934, 'support': 14359}, 'accuracy': 0.4710640368971192, 'macro avg': {'precision': 0.47393919713438654, 'recall': 0.4717798340111415, 'f1-score': 0.4701658372296305, 'support': 43147}, 'weighted avg': {'precision': 0.4743992641647848, 'recall': 0.4710640368971192, 'f1-score': 0.4700010248241938, 'support': 43147}}
[[6925 3056 4080]
 [4372 5959 4396]
 [4171 2747 7441]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1095/1095 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.201863
{'0': {'precision': 0.37246401133736107, 'recall': 0.3938112418919185, 'f1-score': 0.38284027638022405, 'support': 101442}, '1': {'precision': 0.2906210292249047, 'recall': 0.09925682822967805, 'f1-score': 0.14797517235801946, 'support': 73738}, '2': {'precision': 0.37887151284465187, 'recall': 0.533224032256527, 'f1-score': 0.4429873534000111, 'support': 104909}, 'accuracy': 0.3684828750861333, 'macro avg': {'precision': 0.34731885113563915, 'recall': 0.3420973674593745, 'f1-score': 0.32460093404608487, 'support': 280089}, 'weighted avg': {'precision': 0.35331747848751716, 'recall': 0.3684828750861333, 'f1-score': 0.34353665025666874, 'support': 280089}}
[[39949  8878 52615]
 [27325  7319 39094]
 [39982  8987 55940]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.231584
{'0': {'precision': 0.356245821793525, 'recall': 0.3785614613725739, 'f1-score': 0.36706478554471766, 'support': 39415}, '1': {'precision': 0.34902475618904727, 'recall': 0.10005376344086021, 'f1-score': 0.15552398462309877, 'support': 37200}, '2': {'precision': 0.3350748194014448, 'recall': 0.5475770112519434, 'f1-score': 0.4157455109288251, 'support': 37949}, 'accuracy': 0.34411333403163297, 'macro avg': {'precision': 0.3467817991280057, 'recall': 0.34206407868845917, 'f1-score': 0.3127780936988805, 'support': 114564}, 'weighted avg': {'precision': 0.3468882399155911, 'recall': 0.34411333403163297, 'f1-score': 0.31450086540677963, 'support': 114564}}
[[14921  3533 20961]
 [13203  3722 20275]
 [13760  3409 20780]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2251198
{'0': {'precision': 0.35723719990676717, 'recall': 0.37728727332403383, 'f1-score': 0.3669885864793679, 'support': 12187}, '1': {'precision': 0.3312616532007458, 'recall': 0.10110974106041924, 'f1-score': 0.15493060097376646, 'support': 10543}, '2': {'precision': 0.3486940697923357, 'recall': 0.5409781615876442, 'f1-score': 0.42405701825755854, 'support': 12043}, 'accuracy': 0.35024300463002905, 'macro avg': {'precision': 0.34573097429994953, 'recall': 0.3397917253240324, 'f1-score': 0.3153254019035643, 'support': 34773}, 'weighted avg': {'precision': 0.3464027851341079, 'recall': 0.35024300463002905, 'f1-score': 0.32245828373641194, 'support': 34773}}
[[4598 1089 6500]
 [3808 1066 5669]
 [4465 1063 6515]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1252235
{'0': {'precision': 0.4617617283418774, 'recall': 0.5306373762376237, 'f1-score': 0.4938094579964527, 'support': 161600}, '1': {'precision': 0.4146275562760694, 'recall': 0.21528654601571268, 'f1-score': 0.28341557729489514, 'support': 114048}, '2': {'precision': 0.4665250819387578, 'recall': 0.5533239277994079, 'f1-score': 0.5062308014037654, 'support': 165151}, 'accuracy': 0.45754641004176505, 'macro avg': {'precision': 0.44763812218556825, 'recall': 0.43308261668424813, 'f1-score': 0.4278186122317044, 'support': 440799}, 'weighted avg': {'precision': 0.4513513475427311, 'recall': 0.45754641004176505, 'f1-score': 0.44402802922463125, 'support': 440799}}
[[85751 17393 58456]
 [43455 24553 46040]
 [56498 17271 91382]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1833873
{'0': {'precision': 0.4337055870763093, 'recall': 0.5048342278558106, 'f1-score': 0.46657461236048936, 'support': 52542}, '1': {'precision': 0.46749259949566935, 'recall': 0.16216627367460257, 'f1-score': 0.24080192009035722, 'support': 52588}, '2': {'precision': 0.40904114471942155, 'recall': 0.6082766976506446, 'f1-score': 0.48914938154138915, 'support': 52823}, 'accuracy': 0.42534171557362, 'macro avg': {'precision': 0.43674644376380006, 'recall': 0.4250923997270193, 'f1-score': 0.3988419713307452, 'support': 157953}, 'weighted avg': {'precision': 0.43670610982985897, 'recall': 0.42534171557362, 'f1-score': 0.39895660378414677, 'support': 157953}}
[[26525  4907 21110]
 [18749  8528 25311]
 [15885  4807 32131]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1776198
{'0': {'precision': 0.43224600596324153, 'recall': 0.5113181722467888, 'f1-score': 0.46846890298309496, 'support': 18996}, '1': {'precision': 0.48421506303200085, 'recall': 0.22624981120676635, 'f1-score': 0.3083996706011529, 'support': 19863}, '2': {'precision': 0.40861679769596015, 'recall': 0.5648571582288696, 'f1-score': 0.474198866330932, 'support': 18587}, 'accuracy': 0.43007346029314486, 'macro avg': {'precision': 0.4416926222304009, 'recall': 0.43414171389414163, 'f1-score': 0.4170224799717266, 'support': 57446}, 'weighted avg': {'precision': 0.4425698803233851, 'recall': 0.43007346029314486, 'f1-score': 0.4149760168977928, 'support': 57446}}
[[ 9713  2424  6859]
 [ 7033  4494  8336]
 [ 5725  2363 10499]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
4450/4450 - 41s - 41s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7151082
{'0': {'precision': 0.6210270105811163, 'recall': 0.3710422776444735, 'f1-score': 0.4645386753114735, 'support': 247554}, '1': {'precision': 0.7335754813790459, 'recall': 0.8521489333411669, 'f1-score': 0.7884290084449299, 'support': 646786}, '2': {'precision': 0.5521645788607041, 'recall': 0.5411204300987413, 'f1-score': 0.5465867215773337, 'support': 244781}, 'accuracy': 0.68075911163081, 'macro avg': {'precision': 0.6355890236069555, 'recall': 0.5881038803614606, 'f1-score': 0.599851468444579, 'support': 1139121}, 'weighted avg': {'precision': 0.6701337870645236, 'recall': 0.68075911163081, 'f1-score': 0.6660726087733789, 'support': 1139121}}
[[ 91853 113471  42230]
 [ 30429 551158  65199]
 [ 25623  86702 132456]]
Evaluating performance on  train set...
1504/1504 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65734106
{'0': {'precision': 0.6196342200725514, 'recall': 0.3505893755612252, 'f1-score': 0.4478084748077011, 'support': 70159}, '1': {'precision': 0.7755689842275045, 'recall': 0.8548611736946886, 'f1-score': 0.8132869830902153, 'support': 244118}, '2': {'precision': 0.523189606427604, 'recall': 0.5640185988489127, 'f1-score': 0.5428374571079686, 'support': 70542}, 'accuracy': 0.7096089330308535, 'macro avg': {'precision': 0.6394642702425534, 'recall': 0.5898230493682756, 'f1-score': 0.6013109716686283, 'support': 384819}, 'weighted avg': {'precision': 0.7008752368109061, 'recall': 0.7096089330308535, 'f1-score': 0.6970773959221375, 'support': 384819}}
[[ 24597  35217  10345]
 [  9516 208687  25915]
 [  5583  25172  39787]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6694444
{'0': {'precision': 0.6262355375067045, 'recall': 0.348424777251993, 'f1-score': 0.44773748219568316, 'support': 23457}, '1': {'precision': 0.7731547921312344, 'recall': 0.8430777749690032, 'f1-score': 0.8066037464225867, 'support': 83073}, '2': {'precision': 0.4995906824439979, 'recall': 0.5598598890788541, 'f1-score': 0.5280110116999313, 'support': 23981}, 'accuracy': 0.7021323873083495, 'macro avg': {'precision': 0.6329936706939789, 'recall': 0.5837874804332834, 'f1-score': 0.5941174134394004, 'support': 130511}, 'weighted avg': {'precision': 0.6964821295193685, 'recall': 0.7021323873083495, 'f1-score': 0.6909134342546126, 'support': 130511}}
[[ 8173 11906  3378]
 [ 2966 70037 10070]
 [ 1912  8643 13426]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
6203/6203 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65598375
{'0': {'precision': 0.6075488618679609, 'recall': 0.347551867219917, 'f1-score': 0.4421622451721887, 'support': 265100}, '1': {'precision': 0.7824402781852667, 'recall': 0.8980513499592588, 'f1-score': 0.8362690254668089, 'support': 1054217}, '2': {'precision': 0.5277783916865941, 'recall': 0.4446095242350786, 'f1-score': 0.4826372187213264, 'support': 268557}, 'accuracy': 0.7294533445348939, 'macro avg': {'precision': 0.639255843913274, 'recall': 0.5634042471380848, 'f1-score': 0.5870228297867747, 'support': 1587874}, 'weighted avg': {'precision': 0.7101707235996121, 'recall': 0.7294533445348939, 'f1-score': 0.7106620789583011, 'support': 1587874}}
[[ 92136 139167  33797]
 [ 34439 946741  73037]
 [ 25077 124077 119403]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6799314
{'0': {'precision': 0.5643466042154567, 'recall': 0.38713740408960634, 'f1-score': 0.4592398347334238, 'support': 77807}, '1': {'precision': 0.7795005368792428, 'recall': 0.8757708774739887, 'f1-score': 0.8248361727927486, 'support': 295929}, '2': {'precision': 0.515505223846747, 'recall': 0.4356910101590953, 'f1-score': 0.472249539454548, 'support': 78255}, 'accuracy': 0.7154633609961261, 'macro avg': {'precision': 0.6197841216471488, 'recall': 0.5661997639075634, 'f1-score': 0.5854418489935734, 'support': 451991}, 'weighted avg': {'precision': 0.6967567759191148, 'recall': 0.7154633609961261, 'f1-score': 0.7008566659723411, 'support': 451991}}
[[ 30122  37743   9942]
 [ 14661 259166  22102]
 [  8592  35568  34095]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62763864
{'0': {'precision': 0.5722818059212639, 'recall': 0.38865143056524776, 'f1-score': 0.46292111483415155, 'support': 22928}, '1': {'precision': 0.8137644914196428, 'recall': 0.879600869700264, 'f1-score': 0.8454028537710546, 'support': 103024}, '2': {'precision': 0.4959322675243591, 'recall': 0.47400542495479203, 'f1-score': 0.4847210022652674, 'support': 22120}, 'accuracy': 0.7429898968069588, 'macro avg': {'precision': 0.6273261882884219, 'recall': 0.5807525750734346, 'f1-score': 0.5976816569568245, 'support': 148072}, 'weighted avg': {'precision': 0.7288925115337055, 'recall': 0.7429898968069588, 'f1-score': 0.7322969062208537, 'support': 148072}}
[[ 8911 11365  2652]
 [ 4399 90620  8005]
 [ 2261  9374 10485]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92403275
{'0': {'precision': 0.5699233978123696, 'recall': 0.3841498217972829, 'f1-score': 0.45895004116622995, 'support': 380185}, '1': {'precision': 0.6032884037240149, 'recall': 0.7458996101312445, 'f1-score': 0.6670568972053122, 'support': 561471}, '2': {'precision': 0.5050214674375106, 'recall': 0.4934836337957963, 'f1-score': 0.4991858901634522, 'support': 385184}, 'accuracy': 0.5689691296614513, 'macro avg': {'precision': 0.559411089657965, 'recall': 0.5411776885747747, 'f1-score': 0.5417309428449981, 'support': 1326840}, 'weighted avg': {'precision': 0.5652011239019566, 'recall': 0.5689691296614513, 'f1-score': 0.5586939212326024, 'support': 1326840}}
[[146048 139254  94883]
 [ 51251 418801  91419]
 [ 58960 136142 190082]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8888852
{'0': {'precision': 0.5440830061693774, 'recall': 0.3811001659775488, 'f1-score': 0.44823583091237773, 'support': 101821}, '1': {'precision': 0.6393792095410599, 'recall': 0.7407315728478684, 'f1-score': 0.6863338415627402, 'support': 177754}, '2': {'precision': 0.5007898589812746, 'recall': 0.5122571237141844, 'f1-score': 0.5064585890467006, 'support': 101492}, 'accuracy': 0.5837871030553682, 'macro avg': {'precision': 0.5614173582305706, 'recall': 0.5446962875132005, 'f1-score': 0.5470094205072729, 'support': 381067}, 'weighted avg': {'precision': 0.5770047056073112, 'recall': 0.5837871030553682, 'f1-score': 0.5748067960017537, 'support': 381067}}
[[ 38804  39721  23296]
 [ 17556 131668  28530]
 [ 14960  34542  51990]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8535678
{'0': {'precision': 0.544825739658173, 'recall': 0.3708575073661189, 'f1-score': 0.4413157419121634, 'support': 32921}, '1': {'precision': 0.6701590847810177, 'recall': 0.7768235871943324, 'f1-score': 0.7195599426491672, 'support': 67189}, '2': {'precision': 0.5032655576093654, 'recall': 0.5004595306660131, 'f1-score': 0.5018586218549353, 'support': 32642}, 'accuracy': 0.6081942268289743, 'macro avg': {'precision': 0.5727501273495187, 'recall': 0.5493802084088215, 'f1-score': 0.5542447688054221, 'support': 132752}, 'weighted avg': {'precision': 0.5980408675886121, 'recall': 0.6081942268289743, 'f1-score': 0.5970285770514495, 'support': 132752}}
[[12209 13927  6785]
 [ 5656 52194  9339]
 [ 4544 11762 16336]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
7324/7324 - 66s - 66s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97899896
{'0': {'precision': 0.5695746232988705, 'recall': 0.37402167916032075, 'f1-score': 0.4515347431060201, 'support': 605374}, '1': {'precision': 0.5312186628205944, 'recall': 0.6993601689377218, 'f1-score': 0.6038023151141709, 'support': 680961}, '2': {'precision': 0.5227966666494454, 'recall': 0.5159601679892449, 'f1-score': 0.5193559203728162, 'support': 588371}, 'accuracy': 0.5367433613590611, 'macro avg': {'precision': 0.5411966509229701, 'recall': 0.5297806720290958, 'f1-score': 0.5248976595310024, 'support': 1874706}, 'weighted avg': {'precision': 0.5409612266729322, 'recall': 0.5367433613590611, 'f1-score': 0.5281293088629359, 'support': 1874706}}
[[226423 227826 151125]
 [ 78748 476237 125976]
 [ 92359 192436 303576]]
Evaluating performance on  train set...
2046/2046 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93911165
{'0': {'precision': 0.5574978001443501, 'recall': 0.3670622392052963, 'f1-score': 0.4426676087297849, 'support': 153617}, '1': {'precision': 0.5862899536040959, 'recall': 0.718052738336714, 'f1-score': 0.6455161043886619, 'support': 215934}, '2': {'precision': 0.5093457943925234, 'recall': 0.5223766382837984, 'f1-score': 0.5157789253618572, 'support': 154201}, 'accuracy': 0.5574966778169821, 'macro avg': {'precision': 0.5510445160469898, 'recall': 0.535830538608603, 'f1-score': 0.5346542128267681, 'support': 523752}, 'weighted avg': {'precision': 0.5551915892396458, 'recall': 0.5574966778169821, 'f1-score': 0.5478237230693696, 'support': 523752}}
[[ 56387  58481  38749]
 [ 22036 155052  38846]
 [ 22720  50930  80551]]
Evaluating performance on  val set...
741/741 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9303069
{'0': {'precision': 0.5645319392256167, 'recall': 0.37604744803569484, 'f1-score': 0.45140431090790334, 'support': 55134}, '1': {'precision': 0.5945159731994707, 'recall': 0.7195734241734776, 'f1-score': 0.651094051007792, 'support': 78673}, '2': {'precision': 0.49987856077165954, 'recall': 0.5165372963089113, 'f1-score': 0.5080714128278598, 'support': 55783}, 'accuracy': 0.5599345957065246, 'macro avg': {'precision': 0.5529754910655823, 'recall': 0.5373860561726946, 'f1-score': 0.536856591581185, 'support': 189590}, 'weighted avg': {'precision': 0.5579512888459971, 'recall': 0.5599345957065246, 'f1-score': 0.550941479900358, 'support': 189590}}
[[20733 19881 14520]
 [ 7754 56611 14308]
 [ 8239 18730 28814]]
testing model on single stock: results/universal/W6/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
29350/29350 - 246s - 246s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1015012
{'0': {'precision': 0.43001468853754304, 'recall': 0.48373381725289805, 'f1-score': 0.45529518339652925, 'support': 2322149}, '1': {'precision': 0.5440346778839263, 'recall': 0.3368430175365663, 'f1-score': 0.41607202338226534, 'support': 2896177}, '2': {'precision': 0.40954814937319295, 'recall': 0.5546064229625312, 'f1-score': 0.4711651858986366, 'support': 2295078}, 'accuracy': 0.448761174029774, 'macro avg': {'precision': 0.4611991719315541, 'recall': 0.4583944192506652, 'f1-score': 0.4475107975591437, 'support': 7513404}, 'weighted avg': {'precision': 0.4677139480094152, 'recall': 0.448761174029774, 'f1-score': 0.4450236313412824, 'support': 7513404}}
[[1123302  428517  770330]
 [ 855841  975557 1064779]
 [ 633098  389115 1272865]]
Evaluating performance on  train set...
5452/5452 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796206
{'0': {'precision': 0.4637276048774046, 'recall': 0.4986016032081374, 'f1-score': 0.480532701909201, 'support': 464818}, '1': {'precision': 0.5619207956290286, 'recall': 0.3091068507716417, 'f1-score': 0.39882446495868346, 'support': 466473}, '2': {'precision': 0.43855333837167637, 'recall': 0.603810127018596, 'f1-score': 0.5080817886254025, 'support': 464184}, 'accuracy': 0.47025421451477095, 'macro avg': {'precision': 0.4880672462927032, 'recall': 0.47050619366612506, 'f1-score': 0.4624796518310957, 'support': 1395475}, 'weighted avg': {'precision': 0.4881773302725477, 'recall': 0.47025421451477095, 'f1-score': 0.46238344008312354, 'support': 1395475}}
[[231759  58634 174425]
 [137888 144190 184395]
 [130127  53778 280279]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0984322
{'0': {'precision': 0.44390630969524203, 'recall': 0.48591612728887057, 'f1-score': 0.4639622067753816, 'support': 155426}, '1': {'precision': 0.5598298676748582, 'recall': 0.3348133302500064, 'f1-score': 0.4190240373020339, 'support': 194595}, '2': {'precision': 0.41171143839520474, 'recall': 0.5814453201075032, 'f1-score': 0.482074329233833, 'support': 154042}, 'accuracy': 0.4567762363037954, 'macro avg': {'precision': 0.4718158719217684, 'recall': 0.4673915925487934, 'f1-score': 0.45502019110374947, 'support': 504063}, 'weighted avg': {'precision': 0.4788201645114913, 'recall': 0.4567762363037954, 'f1-score': 0.45214877170690543, 'support': 504063}}
[[75524 26498 53404]
 [54865 65153 74577]
 [39746 24729 89567]]
training model: results/universal/W6/deepVOL_L2/h30
Epoch 1/50
9426/9426 - 314s - loss: 2.9639 - accuracy30: 0.4864 - val_loss: 3.1485 - val_accuracy30: 0.4789 - 314s/epoch - 33ms/step
Epoch 2/50
9426/9426 - 310s - loss: 2.8972 - accuracy30: 0.5089 - val_loss: 3.1635 - val_accuracy30: 0.4889 - 310s/epoch - 33ms/step
Epoch 3/50
9426/9426 - 309s - loss: 2.8654 - accuracy30: 0.5184 - val_loss: 3.1798 - val_accuracy30: 0.4902 - 309s/epoch - 33ms/step
Epoch 4/50
9426/9426 - 310s - loss: 2.8472 - accuracy30: 0.5231 - val_loss: 3.1422 - val_accuracy30: 0.4988 - 310s/epoch - 33ms/step
Epoch 5/50
9426/9426 - 310s - loss: 2.8334 - accuracy30: 0.5264 - val_loss: 3.1667 - val_accuracy30: 0.5003 - 310s/epoch - 33ms/step
Epoch 6/50
9426/9426 - 317s - loss: 2.8243 - accuracy30: 0.5286 - val_loss: 3.1322 - val_accuracy30: 0.5010 - 317s/epoch - 34ms/step
Epoch 7/50
9426/9426 - 309s - loss: 2.8171 - accuracy30: 0.5304 - val_loss: 3.1285 - val_accuracy30: 0.5024 - 309s/epoch - 33ms/step
Epoch 8/50
9426/9426 - 313s - loss: 2.8113 - accuracy30: 0.5317 - val_loss: 3.1376 - val_accuracy30: 0.5022 - 313s/epoch - 33ms/step
Epoch 9/50
9426/9426 - 314s - loss: 2.8061 - accuracy30: 0.5329 - val_loss: 3.1247 - val_accuracy30: 0.5041 - 314s/epoch - 33ms/step
Epoch 10/50
9426/9426 - 314s - loss: 2.8019 - accuracy30: 0.5338 - val_loss: 3.1204 - val_accuracy30: 0.5044 - 314s/epoch - 33ms/step
Epoch 11/50
9426/9426 - 323s - loss: 2.7984 - accuracy30: 0.5349 - val_loss: 3.1063 - val_accuracy30: 0.5037 - 323s/epoch - 34ms/step
Epoch 12/50
9426/9426 - 328s - loss: 2.7947 - accuracy30: 0.5358 - val_loss: 3.0886 - val_accuracy30: 0.5030 - 328s/epoch - 35ms/step
Epoch 13/50
9426/9426 - 329s - loss: 2.7917 - accuracy30: 0.5366 - val_loss: 3.0892 - val_accuracy30: 0.5048 - 329s/epoch - 35ms/step
Epoch 14/50
9426/9426 - 324s - loss: 2.7888 - accuracy30: 0.5374 - val_loss: 3.0770 - val_accuracy30: 0.5052 - 324s/epoch - 34ms/step
Epoch 15/50
9426/9426 - 325s - loss: 2.7890 - accuracy30: 0.5370 - val_loss: 3.0619 - val_accuracy30: 0.5060 - 325s/epoch - 34ms/step
Epoch 16/50
9426/9426 - 321s - loss: 2.7846 - accuracy30: 0.5381 - val_loss: 3.0741 - val_accuracy30: 0.5047 - 321s/epoch - 34ms/step
Epoch 17/50
9426/9426 - 318s - loss: 2.7820 - accuracy30: 0.5385 - val_loss: 3.0618 - val_accuracy30: 0.5060 - 318s/epoch - 34ms/step
Epoch 18/50
9426/9426 - 313s - loss: 2.7796 - accuracy30: 0.5393 - val_loss: 3.0642 - val_accuracy30: 0.5055 - 313s/epoch - 33ms/step
Epoch 19/50
9426/9426 - 313s - loss: 2.7776 - accuracy30: 0.5396 - val_loss: 3.0698 - val_accuracy30: 0.5054 - 313s/epoch - 33ms/step
Epoch 20/50
9426/9426 - 312s - loss: 2.7760 - accuracy30: 0.5399 - val_loss: 3.0546 - val_accuracy30: 0.5060 - 312s/epoch - 33ms/step
Epoch 21/50
9426/9426 - 313s - loss: 2.7746 - accuracy30: 0.5403 - val_loss: 3.0620 - val_accuracy30: 0.5063 - 313s/epoch - 33ms/step
Epoch 22/50
9426/9426 - 315s - loss: 2.7727 - accuracy30: 0.5406 - val_loss: 3.0610 - val_accuracy30: 0.5073 - 315s/epoch - 33ms/step
Epoch 23/50
9426/9426 - 317s - loss: 2.7712 - accuracy30: 0.5411 - val_loss: 3.0604 - val_accuracy30: 0.5066 - 317s/epoch - 34ms/step
Epoch 24/50
9426/9426 - 318s - loss: 2.7697 - accuracy30: 0.5414 - val_loss: 3.0639 - val_accuracy30: 0.5067 - 318s/epoch - 34ms/step
Epoch 25/50
9426/9426 - 312s - loss: 2.7684 - accuracy30: 0.5418 - val_loss: 3.0513 - val_accuracy30: 0.5075 - 312s/epoch - 33ms/step
Epoch 26/50
9426/9426 - 312s - loss: 2.7667 - accuracy30: 0.5422 - val_loss: 3.0569 - val_accuracy30: 0.5082 - 312s/epoch - 33ms/step
Epoch 27/50
9426/9426 - 315s - loss: 2.7655 - accuracy30: 0.5425 - val_loss: 3.0552 - val_accuracy30: 0.5083 - 315s/epoch - 33ms/step
Epoch 28/50
9426/9426 - 316s - loss: 2.7644 - accuracy30: 0.5429 - val_loss: 3.0431 - val_accuracy30: 0.5098 - 316s/epoch - 33ms/step
Epoch 29/50
9426/9426 - 314s - loss: 2.7632 - accuracy30: 0.5431 - val_loss: 3.0533 - val_accuracy30: 0.5083 - 314s/epoch - 33ms/step
Epoch 30/50
9426/9426 - 311s - loss: 2.7614 - accuracy30: 0.5435 - val_loss: 3.0600 - val_accuracy30: 0.5078 - 311s/epoch - 33ms/step
Epoch 31/50
9426/9426 - 328s - loss: 2.7605 - accuracy30: 0.5438 - val_loss: 3.0498 - val_accuracy30: 0.5078 - 328s/epoch - 35ms/step
Epoch 32/50
9426/9426 - 327s - loss: 2.7594 - accuracy30: 0.5442 - val_loss: 3.0579 - val_accuracy30: 0.5078 - 327s/epoch - 35ms/step
Epoch 33/50
9426/9426 - 334s - loss: 2.7582 - accuracy30: 0.5448 - val_loss: 3.0559 - val_accuracy30: 0.5073 - 334s/epoch - 35ms/step
Epoch 34/50
9426/9426 - 333s - loss: 2.7570 - accuracy30: 0.5446 - val_loss: 3.0545 - val_accuracy30: 0.5083 - 333s/epoch - 35ms/step
Epoch 35/50
9426/9426 - 327s - loss: 2.7561 - accuracy30: 0.5450 - val_loss: 3.0515 - val_accuracy30: 0.5076 - 327s/epoch - 35ms/step
Epoch 36/50
9426/9426 - 332s - loss: 2.7549 - accuracy30: 0.5454 - val_loss: 3.0523 - val_accuracy30: 0.5077 - 332s/epoch - 35ms/step
Epoch 37/50
9426/9426 - 320s - loss: 2.7539 - accuracy30: 0.5454 - val_loss: 3.0571 - val_accuracy30: 0.5077 - 320s/epoch - 34ms/step
Epoch 38/50
9426/9426 - 310s - loss: 2.7528 - accuracy30: 0.5458 - val_loss: 3.0528 - val_accuracy30: 0.5079 - 310s/epoch - 33ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 675s - 675s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0874099
{'0': {'precision': 0.41535692101874855, 'recall': 0.477192402646103, 'f1-score': 0.44413269237107045, 'support': 3134723}, '1': {'precision': 0.5695706681132187, 'recall': 0.447565168128487, 'f1-score': 0.5012506348750253, 'support': 4569987}, '2': {'precision': 0.4076072718207295, 'recall': 0.47465910320724464, 'f1-score': 0.43858523361959595, 'support': 3113919}, 'accuracy': 0.4639481583110023, 'macro avg': {'precision': 0.4641782869842322, 'recall': 0.4664722246606116, 'f1-score': 0.46132285362189723, 'support': 10818629}, 'weighted avg': {'precision': 0.47826905522373603, 'recall': 0.4639481583110023, 'f1-score': 0.4666636357560306, 'support': 10818629}}
[[1495866  802889  835968]
 [1212476 2045367 1312144]
 [ 893057  742812 1478050]]
Evaluating performance on  train set...
9426/9426 - 153s - 153s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.01143
{'0': {'precision': 0.45099777693074394, 'recall': 0.5238990355130317, 'f1-score': 0.4847226851840072, 'support': 727226}, '1': {'precision': 0.6238617714175303, 'recall': 0.5317612206649113, 'f1-score': 0.5741413927691967, 'support': 959346}, '2': {'precision': 0.4648147333010539, 'recall': 0.4802370915084472, 'f1-score': 0.47240007320396116, 'support': 725627}, 'accuracy': 0.5138916814077114, 'macro avg': {'precision': 0.5132247605497761, 'recall': 0.5119657825621301, 'f1-score': 0.5104213837190551, 'support': 2412199}, 'weighted avg': {'precision': 0.5239031791198002, 'recall': 0.5138916814077114, 'f1-score': 0.5165782076694142, 'support': 2412199}}
[[380993 163562 182671]
 [230644 510143 218559]
 [233141 144013 348473]]
Evaluating performance on  val set...
3323/3323 - 54s - 54s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0225594
{'0': {'precision': 0.4456775125586893, 'recall': 0.49790917760985987, 'f1-score': 0.4703477191219529, 'support': 245358}, '1': {'precision': 0.6184335184838988, 'recall': 0.5395967476617944, 'f1-score': 0.5763315950793436, 'support': 361709}, '2': {'precision': 0.4453296186715479, 'recall': 0.47710435218760533, 'f1-score': 0.4606697193260331, 'support': 243234}, 'accuracy': 0.509691274031196, 'macro avg': {'precision': 0.5031468832380454, 'recall': 0.5048700924864199, 'f1-score': 0.5024496778424432, 'support': 850301}, 'weighted avg': {'precision': 0.5190665624662593, 'recall': 0.509691274031196, 'f1-score': 0.5126636792188022, 'support': 850301}}
[[122166  63057  60135]
 [ 82126 195177  84406]
 [ 69821  57365 116048]]
testing model out of sample: results/universal/W6/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 282s - 282s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9467682
{'0': {'precision': 0.5195298012606321, 'recall': 0.43794308419116995, 'f1-score': 0.4752604213662823, 'support': 1353016}, '1': {'precision': 0.587416603555844, 'recall': 0.7288788802226667, 'f1-score': 0.6505462663974774, 'support': 1787784}, '2': {'precision': 0.5199949568670069, 'recall': 0.4356492353513947, 'f1-score': 0.47409989448022716, 'support': 1344343}, 'accuracy': 0.5532229407178322, 'macro avg': {'precision': 0.5423137872278277, 'recall': 0.5341570665884104, 'f1-score': 0.5333021940813288, 'support': 4485143}, 'weighted avg': {'precision': 0.5467289937140017, 'recall': 0.5532229407178322, 'f1-score': 0.5447817460994446, 'support': 4485143}}
[[ 592544  476790  283682]
 [ 227766 1303078  256940]
 [ 320229  438452  585662]]
Evaluating performance on  train set...
5153/5153 - 86s - 86s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9534035
{'0': {'precision': 0.49722209334694256, 'recall': 0.45109067376595496, 'f1-score': 0.47303433398253236, 'support': 380132}, '1': {'precision': 0.6075271854257873, 'recall': 0.6917906247487337, 'f1-score': 0.6469265761870746, 'support': 559665}, '2': {'precision': 0.49551656804206134, 'recall': 0.4401110823667302, 'f1-score': 0.46617333935429395, 'support': 378818}, 'accuracy': 0.5500976403271615, 'macro avg': {'precision': 0.5334219489382637, 'recall': 0.5276641269604729, 'f1-score': 0.528711416507967, 'support': 1318615}, 'weighted avg': {'precision': 0.5435493501075301, 'recall': 0.5500976403271615, 'f1-score': 0.5448690495517661, 'support': 1318615}}
[[171474 128978  79680]
 [ 82435 387171  90059]
 [ 90955 121141 166722]]
Evaluating performance on  val set...
1795/1795 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9348782
{'0': {'precision': 0.49879084557131503, 'recall': 0.45846312405300843, 'f1-score': 0.47777751060026774, 'support': 130017}, '1': {'precision': 0.6260791407320855, 'recall': 0.6990766760337214, 'f1-score': 0.6605673372135753, 'support': 199280}, '2': {'precision': 0.49526832774317203, 'recall': 0.44664531810640845, 'f1-score': 0.4697018262079711, 'support': 129595}, 'accuracy': 0.5596153343270311, 'macro avg': {'precision': 0.5400461046821908, 'recall': 0.5347283727310461, 'f1-score': 0.5360155580072714, 'support': 458892}, 'weighted avg': {'precision': 0.5530727044001902, 'recall': 0.5596153343270311, 'f1-score': 0.5548758002385273, 'support': 458892}}
[[ 59608  43104  27305]
 [ 28284 139312  31684]
 [ 31613  40099  57883]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1308457
{'0': {'precision': 0.42303062249353574, 'recall': 0.6287371898026595, 'f1-score': 0.5057676830904051, 'support': 94456}, '1': {'precision': 0.4859392575928009, 'recall': 0.11936527986105629, 'f1-score': 0.19165319897328642, 'support': 76002}, '2': {'precision': 0.4548838953317085, 'recall': 0.5064358059418144, 'f1-score': 0.4792775844229141, 'support': 100609}, 'accuracy': 0.4405257740706172, 'macro avg': {'precision': 0.45461792513934834, 'recall': 0.41817942520184337, 'f1-score': 0.39223282216220196, 'support': 271067}, 'weighted avg': {'precision': 0.4524916340212764, 'recall': 0.4405257740706172, 'f1-score': 0.4078639494795014, 'support': 271067}}
[[59388  3985 31083]
 [36954  9072 29976]
 [44045  5612 50952]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1237375
{'0': {'precision': 0.4349217926898452, 'recall': 0.5783489600172432, 'f1-score': 0.4964844111388657, 'support': 18558}, '1': {'precision': 0.5383573243014395, 'recall': 0.17837504208281899, 'f1-score': 0.267964765878535, 'support': 17822}, '2': {'precision': 0.41226043805612594, 'recall': 0.5482109335001991, 'f1-score': 0.4706140886338664, 'support': 17579}, 'accuracy': 0.4364239515187457, 'macro avg': {'precision': 0.46184651834913687, 'recall': 0.4349783118667538, 'f1-score': 0.411687755217089, 'support': 53959}, 'weighted avg': {'precision': 0.46170257237952966, 'recall': 0.4364239515187457, 'f1-score': 0.4125790104245271, 'support': 53959}}
[[10733  1342  6483]
 [ 7387  3179  7256]
 [ 6558  1384  9637]]
Evaluating performance on  val set...
81/81 - 1s - 813ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1098056
{'0': {'precision': 0.43484239475354347, 'recall': 0.5740818321463482, 'f1-score': 0.4948540475473969, 'support': 7161}, '1': {'precision': 0.5798090040927695, 'recall': 0.19558214450069028, 'f1-score': 0.2924982794218858, 'support': 6519}, '2': {'precision': 0.4371104185218166, 'recall': 0.5644674428633032, 'f1-score': 0.49269180101624743, 'support': 6957}, 'accuracy': 0.4512768328729951, 'macro avg': {'precision': 0.48392060578937657, 'recall': 0.4447104731701139, 'f1-score': 0.4266813759951767, 'support': 20637}, 'weighted avg': {'precision': 0.48140032311707937, 'recall': 0.4512768328729951, 'f1-score': 0.43020317767641686, 'support': 20637}}
[[4111  476 2574]
 [2761 1275 2483]
 [2582  448 3927]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.713882
{'0': {'precision': 0.6072518457752256, 'recall': 0.34425924547957437, 'f1-score': 0.4394106682812742, 'support': 107512}, '1': {'precision': 0.7250626237811653, 'recall': 0.918551825225913, 'f1-score': 0.8104182789091686, 'support': 343163}, '2': {'precision': 0.6305012128658287, 'recall': 0.3689216589861751, 'f1-score': 0.46547974835161005, 'support': 108500}, 'accuracy': 0.7014852237671569, 'macro avg': {'precision': 0.6542718941407398, 'recall': 0.5439109098972209, 'f1-score': 0.5717695651806843, 'support': 559175}, 'weighted avg': {'precision': 0.6840629627639728, 'recall': 0.7014852237671569, 'f1-score': 0.6721545854333851, 'support': 559175}}
[[ 37012  60538   9962]
 [ 14454 315213  13496]
 [  9484  58988  40028]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6127077
{'0': {'precision': 0.6142643764002987, 'recall': 0.3779002986446129, 'f1-score': 0.4679277485421704, 'support': 21765}, '1': {'precision': 0.7932418280058202, 'recall': 0.9222762195187656, 'f1-score': 0.8529062988908929, 'support': 92803}, '2': {'precision': 0.5978645311978645, 'recall': 0.4127430203630333, 'f1-score': 0.4883486413561909, 'support': 21706}, 'accuracy': 0.7541717422252228, 'macro avg': {'precision': 0.6684569118679944, 'recall': 0.5709731795088039, 'f1-score': 0.6030608962630847, 'support': 136274}, 'weighted avg': {'precision': 0.7335363534566938, 'recall': 0.7541717422252228, 'f1-score': 0.7333519696513594, 'support': 136274}}
[[ 8225 11633  1907]
 [ 3094 85590  4119]
 [ 2071 10676  8959]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6233159
{'0': {'precision': 0.639892578125, 'recall': 0.34189929559092097, 'f1-score': 0.4456725046760755, 'support': 7666}, '1': {'precision': 0.7879433703760085, 'recall': 0.9337342152736019, 'f1-score': 0.8546660428764069, 'support': 33260}, '2': {'precision': 0.587382779198636, 'recall': 0.3787795492028587, 'f1-score': 0.4605614973262032, 'support': 7276}, 'accuracy': 0.7558400066387286, 'macro avg': {'precision': 0.6717395758998815, 'recall': 0.5514710200224605, 'f1-score': 0.5869666816262286, 'support': 48202}, 'weighted avg': {'precision': 0.7341232750521051, 'recall': 0.7558400066387286, 'f1-score': 0.7301307717825307, 'support': 48202}}
[[ 2621  4374   671]
 [  939 31056  1265]
 [  536  3984  2756]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1140951
{'0': {'precision': 0.5012964036238294, 'recall': 0.425983047772104, 'f1-score': 0.4605812617359379, 'support': 115737}, '1': {'precision': 0.39453801757101703, 'recall': 0.4756937148507509, 'f1-score': 0.4313316746239885, 'support': 80905}, '2': {'precision': 0.4725742807118405, 'recall': 0.47566524922186665, 'f1-score': 0.47411472716467995, 'support': 114055}, 'accuracy': 0.45716566300929845, 'macro avg': {'precision': 0.4561362339688957, 'recall': 0.4591140039482405, 'f1-score': 0.4553425545082021, 'support': 310697}, 'weighted avg': {'precision': 0.4629529727174168, 'recall': 0.45716566300929845, 'f1-score': 0.45793276997123755, 'support': 310697}}
[[49302 29785 36650]
 [18520 38486 23899]
 [30527 29276 54252]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1269138
{'0': {'precision': 0.43857215427298657, 'recall': 0.5068415823699421, 'f1-score': 0.47024196082539016, 'support': 44288}, '1': {'precision': 0.4616891728960694, 'recall': 0.3539620548609988, 'f1-score': 0.40071158550144537, 'support': 43273}, '2': {'precision': 0.4460538174327282, 'recall': 0.4789741699117491, 'f1-score': 0.4619282007977689, 'support': 43399}, 'accuracy': 0.44709071472205253, 'macro avg': {'precision': 0.4487717148672614, 'recall': 0.44659260238089665, 'f1-score': 0.4442939157082015, 'support': 130960}, 'weighted avg': {'precision': 0.44869004864032236, 'recall': 0.44709071472205253, 'f1-score': 0.44451199134744424, 'support': 130960}}
[[22447  9222 12619]
 [14760 15317 13196]
 [13975  8637 20787]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1175193
{'0': {'precision': 0.4326639437258906, 'recall': 0.5225762247344982, 'f1-score': 0.47338857337926327, 'support': 14595}, '1': {'precision': 0.4550201539025284, 'recall': 0.36548933038999265, 'f1-score': 0.4053701134416061, 'support': 13590}, '2': {'precision': 0.4695610490995001, 'recall': 0.4582943456757118, 'f1-score': 0.46385929308303736, 'support': 14962}, 'accuracy': 0.4508077038959835, 'macro avg': {'precision': 0.4524150489093064, 'recall': 0.4487866336000675, 'f1-score': 0.44753932663463564, 'support': 43147}, 'weighted avg': {'precision': 0.4525002101383979, 'recall': 0.4508077038959835, 'f1-score': 0.4486603660335639, 'support': 43147}}
[[7627 3131 3837]
 [4714 4967 3909]
 [5287 2818 6857]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2291901
{'0': {'precision': 0.36383220956138546, 'recall': 0.7345129236469551, 'f1-score': 0.4866220132122593, 'support': 100939}, '1': {'precision': 0.27569099929128277, 'recall': 0.005191442794037181, 'f1-score': 0.010190982683188809, 'support': 74931}, '2': {'precision': 0.40472630173564755, 'recall': 0.2908682677822662, 'f1-score': 0.33847888833680406, 'support': 104219}, 'accuracy': 0.3743238756252477, 'macro avg': {'precision': 0.3480831701961053, 'recall': 0.3435242114077528, 'f1-score': 0.27843062807741736, 'support': 280089}, 'weighted avg': {'precision': 0.35546855502857755, 'recall': 0.3743238756252477, 'f1-score': 0.30404154100532205, 'support': 280089}}
[[74141   515 26283]
 [56239   389 18303]
 [73398   507 30314]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3054895
{'0': {'precision': 0.33954351631054047, 'recall': 0.7480783664173504, 'f1-score': 0.46708357572231923, 'support': 38639}, '1': {'precision': 0.28205128205128205, 'recall': 0.004361848366289521, 'f1-score': 0.008590841642152397, 'support': 37828}, '2': {'precision': 0.3660311958405546, 'recall': 0.2771871800929207, 'f1-score': 0.3154734342091505, 'support': 38097}, 'accuracy': 0.34592018435110505, 'macro avg': {'precision': 0.3292086647341257, 'recall': 0.3432091316255202, 'f1-score': 0.2637159505245407, 'support': 114564}, 'weighted avg': {'precision': 0.32936828577997, 'recall': 0.34592018435110505, 'f1-score': 0.26527712076254356, 'support': 114564}}
[[28905   208  9526]
 [28899   165  8764]
 [27325   212 10560]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2712928
{'0': {'precision': 0.35279805352798055, 'recall': 0.7479823612613362, 'f1-score': 0.47945388122983384, 'support': 12019}, '1': {'precision': 0.2967479674796748, 'recall': 0.006867356538099717, 'f1-score': 0.013424052960647295, 'support': 10630}, '2': {'precision': 0.3946932006633499, 'recall': 0.29445727482678985, 'f1-score': 0.3372856535500024, 'support': 12124}, 'accuracy': 0.3632991113795186, 'macro avg': {'precision': 0.34807974055700175, 'recall': 0.34976899754207524, 'f1-score': 0.27672119591349453, 'support': 34773}, 'weighted avg': {'precision': 0.3502709304490322, 'recall': 0.3632991113795186, 'f1-score': 0.2874214230901355, 'support': 34773}}
[[8990   93 2936]
 [8018   73 2539]
 [8474   80 3570]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
1722/1722 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1607121
{'0': {'precision': 0.43168781387443667, 'recall': 0.6042263768941192, 'f1-score': 0.5035883590573769, 'support': 158055}, '1': {'precision': 0.4017946339374911, 'recall': 0.18458298161791822, 'f1-score': 0.2529579900829417, 'support': 122021}, '2': {'precision': 0.4580774970033514, 'recall': 0.46603784150370514, 'f1-score': 0.46202338398527015, 'support': 160723}, 'accuracy': 0.43767567530779333, 'macro avg': {'precision': 0.4305199816050931, 'recall': 0.41828240000524747, 'f1-score': 0.4061899110418629, 'support': 440799}, 'weighted avg': {'precision': 0.43303498873745255, 'recall': 0.43767567530779333, 'f1-score': 0.4190541025342364, 'support': 440799}}
[[95501 17140 45414]
 [56299 22523 43199]
 [69427 16393 74903]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2095755
{'0': {'precision': 0.406092235874169, 'recall': 0.588764258555133, 'f1-score': 0.48065745260396864, 'support': 52600}, '1': {'precision': 0.4234632636300461, 'recall': 0.12806404157352744, 'f1-score': 0.1966554202728473, 'support': 52341}, '2': {'precision': 0.41117167453653797, 'recall': 0.5108466007696371, 'f1-score': 0.45562145110410096, 'support': 53012}, 'accuracy': 0.4099510613916798, 'macro avg': {'precision': 0.413575724680251, 'recall': 0.4092249669660992, 'f1-score': 0.3776447746603056, 'support': 157953}, 'weighted avg': {'precision': 0.4135532411487751, 'recall': 0.4099510613916798, 'f1-score': 0.3781449401113018, 'support': 157953}}
[[30969  4721 16910]
 [23766  6703 21872]
 [21526  4405 27081]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1978478
{'0': {'precision': 0.4106273116783242, 'recall': 0.5862699989543031, 'f1-score': 0.48297547003208924, 'support': 19126}, '1': {'precision': 0.4479990556014638, 'recall': 0.19498535683090992, 'f1-score': 0.2717118923176058, 'support': 19463}, '2': {'precision': 0.41937419235739337, 'recall': 0.4818900143182903, 'f1-score': 0.4484639111659469, 'support': 18857}, 'accuracy': 0.4194373846743028, 'macro avg': {'precision': 0.4260001865457272, 'recall': 0.4210484567011678, 'f1-score': 0.401050424505214, 'support': 57446}, 'weighted avg': {'precision': 0.4261602675140878, 'recall': 0.4194373846743028, 'f1-score': 0.40006965450801735, 'support': 57446}}
[[11213  2395  5518]
 [ 8605  3795  7063]
 [ 7489  2281  9087]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80052763
{'0': {'precision': 0.624856122884203, 'recall': 0.3741882662486704, 'f1-score': 0.46807495606846095, 'support': 285808}, '1': {'precision': 0.6554990962820044, 'recall': 0.8289407722914586, 'f1-score': 0.7320874878287024, 'support': 570510}, '2': {'precision': 0.5596258072891312, 'recall': 0.48779539113800063, 'f1-score': 0.5212475935515684, 'support': 282803}, 'accuracy': 0.6301481580973399, 'macro avg': {'precision': 0.6133270088184463, 'recall': 0.5636414765593766, 'f1-score': 0.5738033458162438, 'support': 1139121}, 'weighted avg': {'precision': 0.6240087974569188, 'recall': 0.6301481580973399, 'f1-score': 0.6135021502758108, 'support': 1139121}}
[[106946 138115  40747]
 [ 29784 472919  67807]
 [ 34423 110430 137950]]
Evaluating performance on  train set...
1504/1504 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7461316
{'0': {'precision': 0.6270497179588088, 'recall': 0.3464186495953618, 'f1-score': 0.4462840781775177, 'support': 82790}, '1': {'precision': 0.7049472343732567, 'recall': 0.8366719786667641, 'f1-score': 0.7651819495368785, 'support': 219001}, '2': {'precision': 0.5450870411076582, 'recall': 0.519680107915402, 'f1-score': 0.5320804508403931, 'support': 83028}, 'accuracy': 0.6628051109742502, 'macro avg': {'precision': 0.6256946644799078, 'recall': 0.5675902453925094, 'f1-score': 0.5811821595182631, 'support': 384819}, 'weighted avg': {'precision': 0.6536971466426399, 'recall': 0.6628051109742502, 'f1-score': 0.6462805803123515, 'support': 384819}}
[[ 28680  44270   9840]
 [  9599 183232  26170]
 [  7459  32421  43148]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7503639
{'0': {'precision': 0.6284415755499934, 'recall': 0.34481387784604267, 'f1-score': 0.4453001026789881, 'support': 27670}, '1': {'precision': 0.7009534849363017, 'recall': 0.8288962653371141, 'f1-score': 0.7595748873180463, 'support': 74411}, '2': {'precision': 0.529228855721393, 'recall': 0.5088638761871263, 'f1-score': 0.5188466090449377, 'support': 28430}, 'accuracy': 0.6565500226034587, 'macro avg': {'precision': 0.6195413054025627, 'recall': 0.560858006456761, 'f1-score': 0.574573866347324, 'support': 130511}, 'weighted avg': {'precision': 0.6481722194391482, 'recall': 0.6565500226034587, 'f1-score': 0.6405053204442409, 'support': 130511}}
[[ 9541 14949  3180]
 [ 3043 61679  9689]
 [ 2598 11365 14467]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
6203/6203 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7391158
{'0': {'precision': 0.6057995304814, 'recall': 0.33866635862188466, 'f1-score': 0.4344549091926959, 'support': 311643}, '1': {'precision': 0.7179532273971128, 'recall': 0.8890777300985564, 'f1-score': 0.7944043924653242, 'support': 959654}, '2': {'precision': 0.5442612034714669, 'recall': 0.38727702896925553, 'f1-score': 0.4525415157924266, 'support': 316577}, 'accuracy': 0.6810068053258634, 'macro avg': {'precision': 0.6226713204499932, 'recall': 0.5383403725632322, 'f1-score': 0.560466939150149, 'support': 1587874}, 'weighted avg': {'precision': 0.661312200195828, 'recall': 0.6810068053258634, 'f1-score': 0.6556014013438577, 'support': 1587874}}
[[105543 173248  32852]
 [ 36637 853207  69810]
 [ 32041 161933 122603]]
Evaluating performance on  train set...
1766/1766 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7555895
{'0': {'precision': 0.5841315128048367, 'recall': 0.37395085888236573, 'f1-score': 0.45598684908261744, 'support': 91980}, '1': {'precision': 0.7143804609730572, 'recall': 0.8764038234009757, 'f1-score': 0.7871410014665827, 'support': 267929}, '2': {'precision': 0.5442548632997469, 'recall': 0.3807041549922895, 'f1-score': 0.4480200392349818, 'support': 92082}, 'accuracy': 0.6731682710496448, 'macro avg': {'precision': 0.6142556123592136, 'recall': 0.543686279091877, 'f1-score': 0.5637159632613941, 'support': 451991}, 'weighted avg': {'precision': 0.653215960933307, 'recall': 0.6731682710496448, 'f1-score': 0.6506637366969581, 'support': 451991}}
[[ 34396  47663   9921]
 [ 13681 234814  19434]
 [ 10807  46219  35056]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7015257
{'0': {'precision': 0.595951126018208, 'recall': 0.3663205949488256, 'f1-score': 0.45373706051347534, 'support': 27162}, '1': {'precision': 0.75375751958272, 'recall': 0.8769492636408809, 'f1-score': 0.8107001314548485, 'support': 94587}, '2': {'precision': 0.516361931551805, 'recall': 0.41841735364510124, 'f1-score': 0.4622584097538455, 'support': 26323}, 'accuracy': 0.7017667080879572, 'macro avg': {'precision': 0.6220235257175776, 'recall': 0.5538957374116026, 'f1-score': 0.5755652005740565, 'support': 148072}, 'weighted avg': {'precision': 0.6826076646085382, 'recall': 0.7017667080879572, 'f1-score': 0.6832765647221436, 'support': 148072}}
[[ 9950 14530  2682]
 [ 4005 82948  7634]
 [ 2741 12568 11014]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9711154
{'0': {'precision': 0.5658605946688222, 'recall': 0.40825379723858485, 'f1-score': 0.4743072033437098, 'support': 426955}, '1': {'precision': 0.5159730316334966, 'recall': 0.7558012160837994, 'f1-score': 0.6132740075135237, 'support': 467402}, '2': {'precision': 0.5419019658894685, 'recall': 0.4186892895212066, 'f1-score': 0.47239353431633435, 'support': 432483}, 'accuracy': 0.5340847426969341, 'macro avg': {'precision': 0.5412451973972625, 'recall': 0.527581434281197, 'f1-score': 0.5199915817245226, 'support': 1326840}, 'weighted avg': {'precision': 0.5404775444229609, 'recall': 0.5340847426969341, 'f1-score': 0.5226368684733509, 'support': 1326840}}
[[174306 164571  88078]
 [ 49144 353263  64995]
 [ 84587 166820 181076]]
Evaluating performance on  train set...
1489/1489 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9449336
{'0': {'precision': 0.5430109350793274, 'recall': 0.4131057562436015, 'f1-score': 0.46923340010749015, 'support': 116239}, '1': {'precision': 0.5514574306038244, 'recall': 0.7507197358619718, 'f1-score': 0.6358427828459374, 'support': 149013}, '2': {'precision': 0.5421423718241459, 'recall': 0.42026507792600265, 'f1-score': 0.4734865803476755, 'support': 115815}, 'accuracy': 0.5473027052985433, 'macro avg': {'precision': 0.5455369125024325, 'recall': 0.5280301900105253, 'f1-score': 0.5261875877670343, 'support': 381067}, 'weighted avg': {'precision': 0.5460498888176281, 'recall': 0.5473027052985433, 'f1-score': 0.5356772171252884, 'support': 381067}}
[[ 48019  47521  20699]
 [ 16739 111867  20407]
 [ 23673  43469  48673]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9195455
{'0': {'precision': 0.5470873429809741, 'recall': 0.39238672286617493, 'f1-score': 0.4569999693185653, 'support': 37960}, '1': {'precision': 0.5821422062537426, 'recall': 0.7837051576383169, 'f1-score': 0.6680510012772727, 'support': 57061}, '2': {'precision': 0.5452835446565417, 'recall': 0.41488431263417347, 'f1-score': 0.4712292478815154, 'support': 37731}, 'accuracy': 0.56698204170182, 'macro avg': {'precision': 0.5581710312970861, 'recall': 0.5303253977128884, 'f1-score': 0.5320934061591178, 'support': 132752}, 'weighted avg': {'precision': 0.5616423511061118, 'recall': 0.56698204170182, 'f1-score': 0.5517606346498182, 'support': 132752}}
[[14895 16930  6135]
 [ 5423 44719  6919]
 [ 6908 15169 15654]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
7324/7324 - 66s - 66s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0179907
{'0': {'precision': 0.5583956881404118, 'recall': 0.42017901578458683, 'f1-score': 0.4795262941503092, 'support': 673125}, '1': {'precision': 0.4428321197165688, 'recall': 0.6914122672532147, 'f1-score': 0.5398828743138167, 'support': 549202}, '2': {'precision': 0.5533890472759172, 'recall': 0.43321136946468236, 'f1-score': 0.48598079414796713, 'support': 652379}, 'accuracy': 0.5041729209806765, 'macro avg': {'precision': 0.5182056183776326, 'recall': 0.5149342175008279, 'f1-score': 0.501796654204031, 'support': 1874706}, 'weighted avg': {'precision': 0.522798655717168, 'recall': 0.5041729209806765, 'f1-score': 0.4994540773829497, 'support': 1874706}}
[[282833 252447 137845]
 [ 79236 379725  90241]
 [144441 225320 282618]]
Evaluating performance on  train set...
2046/2046 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9857402
{'0': {'precision': 0.5447056354286913, 'recall': 0.42075550357254526, 'f1-score': 0.4747739389504495, 'support': 172706}, '1': {'precision': 0.5006756038085933, 'recall': 0.7128154795288839, 'f1-score': 0.5882026254954911, 'support': 178300}, '2': {'precision': 0.545469197576539, 'recall': 0.43101432160513126, 'f1-score': 0.4815340587560025, 'support': 172746}, 'accuracy': 0.5235645878201897, 'macro avg': {'precision': 0.5302834789379411, 'recall': 0.5215284349021868, 'f1-score': 0.5148368744006477, 'support': 523752}, 'weighted avg': {'precision': 0.5299684080174903, 'recall': 0.5235645878201897, 'f1-score': 0.5156179232539194, 'support': 523752}}
[[ 72667  66162  33877]
 [ 23039 127095  28166]
 [ 37700  60590  74456]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9761079
{'0': {'precision': 0.5509199917304114, 'recall': 0.4299937069368919, 'f1-score': 0.48300299973718314, 'support': 61973}, '1': {'precision': 0.5106252397391637, 'recall': 0.7154681285606793, 'f1-score': 0.5959351777240576, 'support': 65121}, '2': {'precision': 0.5376688344172086, 'recall': 0.429947516641065, 'f1-score': 0.4778120582194521, 'support': 62496}, 'accuracy': 0.5280341790178807, 'macro avg': {'precision': 0.5330713552955947, 'recall': 0.5251364507128787, 'f1-score': 0.5189167452268976, 'support': 189590}, 'weighted avg': {'precision': 0.532711336886443, 'recall': 0.5280341790178807, 'f1-score': 0.5200821878884102, 'support': 189590}}
[[26648 22596 12729]
 [ 8153 46592 10376]
 [13569 22057 26870]]
testing model on single stock: results/universal/W6/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
29350/29350 - 278s - 278s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1740166
{'0': {'precision': 0.38623943136075395, 'recall': 0.4986331657110949, 'f1-score': 0.435298349206825, 'support': 2213509}, '1': {'precision': 0.5165207395673085, 'recall': 0.2900412687167969, 'f1-score': 0.371483727435548, 'support': 3113981}, '2': {'precision': 0.37445845379637005, 'recall': 0.49801593292325314, 'f1-score': 0.42748825420436554, 'support': 2185914}, 'accuracy': 0.41200127132788283, 'macro avg': {'precision': 0.4257395415748108, 'recall': 0.4288967891170483, 'f1-score': 0.4114234436155795, 'support': 7513404}, 'weighted avg': {'precision': 0.43680789734750003, 'recall': 0.41200127132788283, 'f1-score': 0.4065777166246893, 'support': 7513404}}
[[1103729  439114  670666]
 [1062899  903183 1147899]
 [ 691001  406293 1088620]]
Evaluating performance on  train set...
5452/5452 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1177547
{'0': {'precision': 0.4366522791184357, 'recall': 0.5709234640107911, 'f1-score': 0.4948412731498852, 'support': 467793}, '1': {'precision': 0.5244553432097765, 'recall': 0.28085678129632885, 'f1-score': 0.36581304352742944, 'support': 460701}, '2': {'precision': 0.4413576109621686, 'recall': 0.5076480627691491, 'f1-score': 0.47218755882127394, 'support': 466981}, 'accuracy': 0.4539866353750515, 'macro avg': {'precision': 0.4674884110967936, 'recall': 0.45314276935875636, 'f1-score': 0.44428062516619615, 'support': 1395475}, 'weighted avg': {'precision': 0.4672141021533614, 'recall': 0.4539866353750515, 'f1-score': 0.4446631699332857, 'support': 1395475}}
[[267074  59782 140937]
 [172189 129391 159121]
 [172377  57542 237062]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1412703
{'0': {'precision': 0.426119214981155, 'recall': 0.5390051423679886, 'f1-score': 0.4759603182485296, 'support': 160043}, '1': {'precision': 0.5174202846333994, 'recall': 0.3082636157276479, 'f1-score': 0.3863508728271799, 'support': 186347}, '2': {'precision': 0.41797043053063454, 'recall': 0.5052608880404381, 'f1-score': 0.45748905319072575, 'support': 157673}, 'accuracy': 0.44314698757893356, 'macro avg': {'precision': 0.45383664338172963, 'recall': 0.4508432153786915, 'f1-score': 0.4399334147554785, 'support': 504063}, 'weighted avg': {'precision': 0.45732332465756426, 'recall': 0.44314698757893356, 'f1-score': 0.4370547229134399, 'support': 504063}}
[[86264 26800 46979]
 [64946 57444 63957]
 [51231 26776 79666]]
training model: results/universal/W6/deepVOL_L3/h10
Epoch 1/50
9426/9426 - 537s - loss: 2.7745 - accuracy10: 0.5328 - val_loss: 2.8985 - val_accuracy10: 0.5413 - 537s/epoch - 57ms/step
Epoch 2/50
9426/9426 - 533s - loss: 2.6560 - accuracy10: 0.5698 - val_loss: 2.8447 - val_accuracy10: 0.5558 - 533s/epoch - 57ms/step
Epoch 3/50
9426/9426 - 547s - loss: 2.6209 - accuracy10: 0.5792 - val_loss: 2.8088 - val_accuracy10: 0.5594 - 547s/epoch - 58ms/step
Epoch 4/50
9426/9426 - 544s - loss: 2.6000 - accuracy10: 0.5840 - val_loss: 2.7189 - val_accuracy10: 0.5645 - 544s/epoch - 58ms/step
Epoch 5/50
9426/9426 - 546s - loss: 2.5840 - accuracy10: 0.5870 - val_loss: 2.7072 - val_accuracy10: 0.5677 - 546s/epoch - 58ms/step
Epoch 6/50
9426/9426 - 541s - loss: 2.5719 - accuracy10: 0.5894 - val_loss: 2.6756 - val_accuracy10: 0.5695 - 541s/epoch - 57ms/step
Epoch 7/50
9426/9426 - 545s - loss: 2.5630 - accuracy10: 0.5912 - val_loss: 2.6823 - val_accuracy10: 0.5712 - 545s/epoch - 58ms/step
Epoch 8/50
9426/9426 - 534s - loss: 2.5560 - accuracy10: 0.5926 - val_loss: 2.6678 - val_accuracy10: 0.5747 - 534s/epoch - 57ms/step
Epoch 9/50
9426/9426 - 553s - loss: 2.5496 - accuracy10: 0.5941 - val_loss: 2.6595 - val_accuracy10: 0.5723 - 553s/epoch - 59ms/step
Epoch 10/50
9426/9426 - 561s - loss: 2.5450 - accuracy10: 0.5948 - val_loss: 2.6569 - val_accuracy10: 0.5734 - 561s/epoch - 60ms/step
Epoch 11/50
9426/9426 - 549s - loss: 2.5407 - accuracy10: 0.5955 - val_loss: 2.6526 - val_accuracy10: 0.5736 - 549s/epoch - 58ms/step
Epoch 12/50
9426/9426 - 547s - loss: 2.5366 - accuracy10: 0.5965 - val_loss: 2.6468 - val_accuracy10: 0.5770 - 547s/epoch - 58ms/step
Epoch 13/50
9426/9426 - 536s - loss: 2.5332 - accuracy10: 0.5972 - val_loss: 2.6310 - val_accuracy10: 0.5778 - 536s/epoch - 57ms/step
Epoch 14/50
9426/9426 - 546s - loss: 2.5298 - accuracy10: 0.5980 - val_loss: 2.6496 - val_accuracy10: 0.5772 - 546s/epoch - 58ms/step
Epoch 15/50
9426/9426 - 569s - loss: 2.5270 - accuracy10: 0.5984 - val_loss: 2.6428 - val_accuracy10: 0.5758 - 569s/epoch - 60ms/step
Epoch 16/50
9426/9426 - 568s - loss: 2.5243 - accuracy10: 0.5990 - val_loss: 2.6388 - val_accuracy10: 0.5761 - 568s/epoch - 60ms/step
Epoch 17/50
9426/9426 - 566s - loss: 2.5217 - accuracy10: 0.5995 - val_loss: 2.6389 - val_accuracy10: 0.5766 - 566s/epoch - 60ms/step
Epoch 18/50
9426/9426 - 541s - loss: 2.5194 - accuracy10: 0.6000 - val_loss: 2.6376 - val_accuracy10: 0.5763 - 541s/epoch - 57ms/step
Epoch 19/50
9426/9426 - 530s - loss: 2.5170 - accuracy10: 0.6006 - val_loss: 2.6385 - val_accuracy10: 0.5759 - 530s/epoch - 56ms/step
Epoch 20/50
9426/9426 - 528s - loss: 2.5145 - accuracy10: 0.6011 - val_loss: 2.6445 - val_accuracy10: 0.5784 - 528s/epoch - 56ms/step
Epoch 21/50
9426/9426 - 525s - loss: 2.5128 - accuracy10: 0.6015 - val_loss: 2.6363 - val_accuracy10: 0.5773 - 525s/epoch - 56ms/step
Epoch 22/50
9426/9426 - 537s - loss: 2.5108 - accuracy10: 0.6017 - val_loss: 2.6380 - val_accuracy10: 0.5778 - 537s/epoch - 57ms/step
Epoch 23/50
9426/9426 - 527s - loss: 2.5085 - accuracy10: 0.6023 - val_loss: 2.6355 - val_accuracy10: 0.5780 - 527s/epoch - 56ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1300s - 1300s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9009626
{'0': {'precision': 0.4971531310311778, 'recall': 0.54421367787818, 'f1-score': 0.5196200447189013, 'support': 3133951}, '1': {'precision': 0.6825190073879976, 'recall': 0.616996360809871, 'f1-score': 0.6481058309082499, 'support': 4497704}, '2': {'precision': 0.5044307830681747, 'recall': 0.5258182212970673, 'f1-score': 0.5149025060865042, 'support': 3186974}, 'accuracy': 0.5690531582144096, 'macro avg': {'precision': 0.5613676404957834, 'recall': 0.5623427533283728, 'f1-score': 0.5608761272378852, 'support': 10818629}, 'weighted avg': {'precision': 0.5763604438410108, 'recall': 0.5690531582144096, 'f1-score': 0.5716466334411445, 'support': 10818629}}
[[1705539  628128  800284]
 [ 876591 2775067  846046]
 [ 848481  662724 1675769]]
Evaluating performance on  train set...
9426/9426 - 307s - 307s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86772346
{'0': {'precision': 0.4679193102326338, 'recall': 0.5779782762932747, 'f1-score': 0.517158084800488, 'support': 646943}, '1': {'precision': 0.7590811236487675, 'recall': 0.619773789108239, 'f1-score': 0.6823902644023063, 'support': 1121343}, '2': {'precision': 0.477231282686485, 'recall': 0.5169735663047648, 'f1-score': 0.4963080966924572, 'support': 643913}, 'accuracy': 0.5811228675577761, 'macro avg': {'precision': 0.5680772388559622, 'recall': 0.5715752105687595, 'f1-score': 0.5652854819650838, 'support': 2412199}, 'weighted avg': {'precision': 0.6057555175522472, 'recall': 0.5811228675577761, 'f1-score': 0.5884027746368719, 'support': 2412199}}
[[373919 109634 163390]
 [225104 694979 201260]
 [200087 110940 332886]]
Evaluating performance on  val set...
3323/3323 - 107s - 107s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86777234
{'0': {'precision': 0.44970243808792476, 'recall': 0.5576451543790321, 'f1-score': 0.49789047472289233, 'support': 210035}, '1': {'precision': 0.7562847816477576, 'recall': 0.6175083115663225, 'f1-score': 0.6798871546020162, 'support': 432229}, '2': {'precision': 0.45208179458501274, 'recall': 0.514879564692819, 'f1-score': 0.4814415289051895, 'support': 208037}, 'accuracy': 0.5776119280113748, 'macro avg': {'precision': 0.5526896714402317, 'recall': 0.5633443435460579, 'f1-score': 0.5530730527433659, 'support': 850301}, 'weighted avg': {'precision': 0.6061279555953811, 'recall': 0.5776119280113748, 'f1-score': 0.586379437580041, 'support': 850301}}
[[117125  43050  49860]
 [ 85363 266905  79961]
 [ 57962  42961 107114]]
testing model out of sample: results/universal/W6/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 562s - 562s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80084395
{'0': {'precision': 0.4821215549012398, 'recall': 0.502186440463231, 'f1-score': 0.4919494887101902, 'support': 1026097}, '1': {'precision': 0.7557501541439353, 'recall': 0.7557262506726254, 'f1-score': 0.7557382022192679, 'support': 2434490}, '2': {'precision': 0.49004459589237104, 'recall': 0.46965612421380576, 'f1-score': 0.47963378744421215, 'support': 1024556}, 'accuracy': 0.6323742632063236, 'macro avg': {'precision': 0.5759721016458488, 'recall': 0.5758562717832207, 'f1-score': 0.5757738261245567, 'support': 4485143}, 'weighted avg': {'precision': 0.6324542617415924, 'recall': 0.6323742632063236, 'f1-score': 0.6323180030528653, 'support': 4485143}}
[[ 515292  295746  215059]
 [ 309001 1839808  285681]
 [ 244508  298859  481189]]
Evaluating performance on  train set...
5153/5153 - 168s - 168s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8133815
{'0': {'precision': 0.44922712610244075, 'recall': 0.5087725472943246, 'f1-score': 0.47714928430082965, 'support': 284125}, '1': {'precision': 0.7690750518494139, 'recall': 0.7234816841262427, 'f1-score': 0.7455819940644004, 'support': 749350}, '2': {'precision': 0.4650551724374193, 'recall': 0.4760854317177527, 'f1-score': 0.47050566422259693, 'support': 285140}, 'accuracy': 0.6237203429355801, 'macro avg': {'precision': 0.5611191167964246, 'recall': 0.56944655437944, 'f1-score': 0.5644123141959423, 'support': 1318615}, 'weighted avg': {'precision': 0.6344148058197578, 'recall': 0.6237203429355801, 'f1-score': 0.628259114867162, 'support': 1318615}}
[[144555  79902  59668]
 [110725 542141  96484]
 [ 66506  82883 135751]]
Evaluating performance on  val set...
1795/1795 - 58s - 58s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7977157
{'0': {'precision': 0.4504351367382894, 'recall': 0.5231617155607654, 'f1-score': 0.48408212974063286, 'support': 97251}, '1': {'precision': 0.7818378808290997, 'recall': 0.7281175127920247, 'f1-score': 0.7540220798584887, 'support': 264618}, '2': {'precision': 0.4640161603167744, 'recall': 0.47587685394184887, 'f1-score': 0.46987167092394905, 'support': 97023}, 'accuracy': 0.6313511675949897, 'macro avg': {'precision': 0.5654297259613879, 'recall': 0.575718694098213, 'f1-score': 0.5693252935076901, 'support': 458892}, 'weighted avg': {'precision': 0.6444084528703583, 'recall': 0.6313511675949897, 'f1-score': 0.6367372825315197, 'support': 458892}}
[[ 50878  26197  20176]
 [ 38789 192673  33156]
 [ 23286  27566  46171]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1376513
{'0': {'precision': 0.38642786634754506, 'recall': 0.6906114064765587, 'f1-score': 0.49556501608386144, 'support': 82760}, '1': {'precision': 0.670183887915937, 'recall': 0.15217067133242537, 'f1-score': 0.24802521246688436, 'support': 100591}, '2': {'precision': 0.4387914793512824, 'recall': 0.5018468694422911, 'f1-score': 0.4682057254689237, 'support': 87716}, 'accuracy': 0.4297166383218909, 'macro avg': {'precision': 0.4984677445382548, 'recall': 0.4482096490837584, 'f1-score': 0.40393198467322317, 'support': 271067}, 'weighted avg': {'precision': 0.5086722879990996, 'recall': 0.4297166383218909, 'f1-score': 0.3948514510935999, 'support': 271067}}
[[57155  2934 22671]
 [51654 15307 33630]
 [39097  4599 44020]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1235007
{'0': {'precision': 0.37802877093906206, 'recall': 0.647558663964965, 'f1-score': 0.4773767648050884, 'support': 15299}, '1': {'precision': 0.7086912582112178, 'recall': 0.23204831237591, 'f1-score': 0.34961984295151444, 'support': 24176}, '2': {'precision': 0.38682193990723934, 'recall': 0.5297569732118199, 'f1-score': 0.44714452214452216, 'support': 14484}, 'accuracy': 0.4297707518671584, 'macro avg': {'precision': 0.49118065635250635, 'recall': 0.4697879831842316, 'f1-score': 0.4247137099670417, 'support': 53959}, 'weighted avg': {'precision': 0.5285403918294921, 'recall': 0.4297707518671584, 'f1-score': 0.4120209363904097, 'support': 53959}}
[[ 9907  1023  4369]
 [10772  5610  7794]
 [ 5528  1283  7673]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1242906
{'0': {'precision': 0.36761363636363636, 'recall': 0.6709298306256481, 'f1-score': 0.4749785880337697, 'support': 5786}, '1': {'precision': 0.719155242682475, 'recall': 0.21471238938053097, 'f1-score': 0.3306925632507028, 'support': 9040}, '2': {'precision': 0.4108159392789374, 'recall': 0.5215969712614008, 'f1-score': 0.4596254454469633, 'support': 5811}, 'accuracy': 0.42903522798856425, 'macro avg': {'precision': 0.49919493944168297, 'recall': 0.46907973042252665, 'f1-score': 0.4217655322438119, 'support': 20637}, 'weighted avg': {'precision': 0.5337707669234616, 'recall': 0.42903522798856425, 'f1-score': 0.40745119666821966, 'support': 20637}}
[[3882  326 1578]
 [4330 1941 2769]
 [2348  432 3031]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49938798
{'0': {'precision': 0.539260553350677, 'recall': 0.4243891504147052, 'f1-score': 0.47497825650632236, 'support': 66915}, '1': {'precision': 0.8637172692033858, 'recall': 0.9261256803562593, 'f1-score': 0.8938334436250264, 'support': 424410}, '2': {'precision': 0.5711341809557137, 'recall': 0.43298452468680915, 'f1-score': 0.4925558312655087, 'support': 67850}, 'accuracy': 0.806246702731703, 'macro avg': {'precision': 0.6580373345032587, 'recall': 0.5944997851525912, 'f1-score': 0.6204558437989525, 'support': 559175}, 'weighted avg': {'precision': 0.7893885104446992, 'recall': 0.806246702731703, 'f1-score': 0.7950193320416378, 'support': 559175}}
[[ 28398  30846   7671]
 [ 16964 393057  14389]
 [  7299  31173  29378]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.44371453
{'0': {'precision': 0.5092838196286472, 'recall': 0.4411176165419106, 'f1-score': 0.47275615567911045, 'support': 13493}, '1': {'precision': 0.8990575860319834, 'recall': 0.9246144694092344, 'f1-score': 0.9116569510368352, 'support': 109265}, '2': {'precision': 0.514652914210871, 'recall': 0.46515241195620005, 'f1-score': 0.48865226177522153, 'support': 13516}, 'accuracy': 0.8311710230858418, 'macro avg': {'precision': 0.6409981066238338, 'recall': 0.6102948326357817, 'f1-score': 0.6243551228303891, 'support': 136274}, 'weighted avg': {'precision': 0.8223383954716831, 'recall': 0.8311710230858418, 'f1-score': 0.8262450616681973, 'support': 136274}}
[[  5952   5785   1756]
 [  4064 101028   4173]
 [  1671   5558   6287]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43219915
{'0': {'precision': 0.5774231678486997, 'recall': 0.41197554290533417, 'f1-score': 0.48086624830810876, 'support': 4743}, '1': {'precision': 0.8962733525193893, 'recall': 0.9419922075258895, 'f1-score': 0.9185642512560303, 'support': 39012}, '2': {'precision': 0.5110062893081762, 'recall': 0.4384978637283562, 'f1-score': 0.4719835410867724, 'support': 4447}, 'accuracy': 0.8433882411518194, 'macro avg': {'precision': 0.6615676032254217, 'recall': 0.5974885380531934, 'f1-score': 0.6238046802169704, 'support': 48202}, 'weighted avg': {'precision': 0.8293551944348005, 'recall': 0.8433882411518194, 'f1-score': 0.8342950083593729, 'support': 48202}}
[[ 1954  2201   588]
 [  985 36749  1278]
 [  445  2052  1950]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
1214/1214 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.050362
{'0': {'precision': 0.4389766278036663, 'recall': 0.5299506386332046, 'f1-score': 0.4801927911577883, 'support': 91367}, '1': {'precision': 0.62072231961064, 'recall': 0.4454071707046479, 'f1-score': 0.5186502665623466, 'support': 127993}, '2': {'precision': 0.4282924312771759, 'recall': 0.5090160613989949, 'f1-score': 0.46517817388650706, 'support': 91337}, 'accuracy': 0.48896835180256004, 'macro avg': {'precision': 0.495997126230494, 'recall': 0.4947912902456158, 'f1-score': 0.488007077202214, 'support': 310697}, 'weighted avg': {'precision': 0.5107066859416912, 'recall': 0.48896835180256004, 'f1-score': 0.49162160299616664, 'support': 310697}}
[[48420 15803 27144]
 [36068 57009 34916]
 [25814 19031 46492]]
Evaluating performance on  train set...
512/512 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0846955
{'0': {'precision': 0.37544775987718587, 'recall': 0.6022701539855072, 'f1-score': 0.46254850596202135, 'support': 35328}, '1': {'precision': 0.6540453760639748, 'recall': 0.3543157203807023, 'f1-score': 0.45963407235532655, 'support': 60940}, '2': {'precision': 0.41491423587556936, 'recall': 0.49365848034128906, 'f1-score': 0.450874052232519, 'support': 34692}, 'accuracy': 0.4581169822846671, 'macro avg': {'precision': 0.48146912393891, 'recall': 0.4834147849024995, 'f1-score': 0.4576855435166223, 'support': 130960}, 'weighted avg': {'precision': 0.5155432830579956, 'recall': 0.4581169822846671, 'f1-score': 0.45809969920594407, 'support': 130960}}
[[21277  5367  8684]
 [23882 21592 15466]
 [11512  6054 17126]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0687354
{'0': {'precision': 0.37872362703523377, 'recall': 0.6249676025917926, 'f1-score': 0.4716390663711044, 'support': 11575}, '1': {'precision': 0.666880910843816, 'recall': 0.3656731446984191, 'f1-score': 0.47234416154521514, 'support': 19862}, '2': {'precision': 0.4307107563664006, 'recall': 0.4838599487617421, 'f1-score': 0.4557410014076011, 'support': 11710}, 'accuracy': 0.4673094305513709, 'macro avg': {'precision': 0.49210509808181674, 'recall': 0.4915002320173179, 'f1-score': 0.4665747431079736, 'support': 43147}, 'weighted avg': {'precision': 0.5254812059045415, 'recall': 0.4673094305513709, 'f1-score': 0.4676489456124321, 'support': 43147}}
[[7234 1737 2604]
 [7714 7263 4885]
 [4153 1891 5666]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1095/1095 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1591915
{'0': {'precision': 0.3629500518045243, 'recall': 0.669910358565737, 'f1-score': 0.4708167665341323, 'support': 100400}, '1': {'precision': 0.27735191637630663, 'recall': 0.01094624513538415, 'f1-score': 0.021061265528053024, 'support': 72719}, '2': {'precision': 0.40057884600737703, 'recall': 0.34417126297092643, 'f1-score': 0.37023889137507104, 'support': 106970}, 'accuracy': 0.37442027355590546, 'macro avg': {'precision': 0.34696027139606933, 'recall': 0.3416759555573492, 'f1-score': 0.2873723078124188, 'support': 280089}, 'weighted avg': {'precision': 0.35509733822303624, 'recall': 0.37442027355590546, 'f1-score': 0.3156354292326822, 'support': 280089}}
[[67259  1039 32102]
 [48934   796 22989]
 [69119  1035 36816]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2042514
{'0': {'precision': 0.3545332065303535, 'recall': 0.673432521263517, 'f1-score': 0.4645178038333405, 'support': 39857}, '1': {'precision': 0.35985533453887886, 'recall': 0.010743980131735234, 'f1-score': 0.02086500655307995, 'support': 37044}, '2': {'precision': 0.3412450331125828, 'recall': 0.34203329527653137, 'f1-score': 0.3416387095063186, 'support': 37663}, 'accuracy': 0.3502059983939108, 'macro avg': {'precision': 0.35187785806060506, 'recall': 0.34206993222392795, 'f1-score': 0.2756738399642464, 'support': 114564}, 'weighted avg': {'precision': 0.351885607236634, 'recall': 0.3502059983939108, 'f1-score': 0.2806671216636485, 'support': 114564}}
[[26841   359 12657]
 [24435   398 12211]
 [24432   349 12882]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1879673
{'0': {'precision': 0.3596283635726181, 'recall': 0.6653693343063326, 'f1-score': 0.4668999459474837, 'support': 12333}, '1': {'precision': 0.3237597911227154, 'recall': 0.011976047904191617, 'f1-score': 0.023097699543634165, 'support': 10354}, '2': {'precision': 0.36216730038022815, 'recall': 0.34676485189475426, 'f1-score': 0.35429875729140253, 'support': 12086}, 'accuracy': 0.3600782216087194, 'macro avg': {'precision': 0.34851848502518723, 'recall': 0.34137007803509284, 'f1-score': 0.2814321342608401, 'support': 34773}, 'weighted avg': {'precision': 0.3498306006850468, 'recall': 0.3600782216087194, 'f1-score': 0.295616869268369, 'support': 34773}}
[[8206  121 4006]
 [6855  124 3375]
 [7757  138 4191]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0581447
{'0': {'precision': 0.4564586101602443, 'recall': 0.6454368424654552, 'f1-score': 0.5347425717312139, 'support': 160733}, '1': {'precision': 0.5270764727405781, 'recall': 0.22357790175299422, 'f1-score': 0.3139731302257715, 'support': 115973}, '2': {'precision': 0.4925240526511164, 'recall': 0.49322640210124746, 'f1-score': 0.4928749771633883, 'support': 164093}, 'accuracy': 0.47778465922109625, 'macro avg': {'precision': 0.49201971185064625, 'recall': 0.4540803821065656, 'f1-score': 0.4471968930401245, 'support': 440799}, 'weighted avg': {'precision': 0.48846379173208027, 'recall': 0.47778465922109625, 'f1-score': 0.4610729998058491, 'support': 440799}}
[[103743  10662  46328]
 [ 52980  25929  37064]
 [ 70555  12603  80935]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1333648
{'0': {'precision': 0.4137305893826111, 'recall': 0.6396992016083821, 'f1-score': 0.5024789121637525, 'support': 51729}, '1': {'precision': 0.5496172677746363, 'recall': 0.14866074759382228, 'f1-score': 0.23402287375390893, 'support': 53612}, '2': {'precision': 0.4355601071372302, 'recall': 0.5254504675739375, 'f1-score': 0.47630123533364355, 'support': 52612}, 'accuracy': 0.4349774933049705, 'macro avg': {'precision': 0.46630265476482585, 'recall': 0.43793680559204734, 'f1-score': 0.404267673750435, 'support': 157953}, 'weighted avg': {'precision': 0.46712401141359033, 'recall': 0.4349774933049705, 'f1-score': 0.40264082700795156, 'support': 157953}}
[[33091  2970 15668]
 [25485  7970 20157]
 [21406  3561 27645]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1233683
{'0': {'precision': 0.4111397627643115, 'recall': 0.645401554404145, 'f1-score': 0.5022997920735934, 'support': 18528}, '1': {'precision': 0.5777082199237887, 'recall': 0.20348976559129475, 'f1-score': 0.300967776241625, 'support': 20861}, '2': {'precision': 0.43244658068814545, 'recall': 0.5032397408207343, 'f1-score': 0.4651650883030458, 'support': 18057}, 'accuracy': 0.440239529297079, 'macro avg': {'precision': 0.47376485445874855, 'recall': 0.45071035360539136, 'f1-score': 0.4228108855394214, 'support': 57446}, 'weighted avg': {'precision': 0.4783249766356781, 'recall': 0.440239529297079, 'f1-score': 0.41751532442997213, 'support': 57446}}
[[11958  1468  5102]
 [ 9792  4245  6824]
 [ 7335  1635  9087]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
4450/4450 - 67s - 67s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5994081
{'0': {'precision': 0.556336291913215, 'recall': 0.44589991731712264, 'f1-score': 0.4950336143914049, 'support': 192301}, '1': {'precision': 0.8178149243963295, 'recall': 0.8727532712159453, 'f1-score': 0.8443914328550559, 'support': 755988}, '2': {'precision': 0.5406239479295253, 'recall': 0.5048943573404879, 'f1-score': 0.5221486403000118, 'support': 190832}, 'accuracy': 0.7390681060220995, 'macro avg': {'precision': 0.6382583880796898, 'recall': 0.6078491819578519, 'f1-score': 0.6205245625154908, 'support': 1139121}, 'weighted avg': {'precision': 0.7272367409318437, 'recall': 0.7390681060220995, 'f1-score': 0.7314305670319846, 'support': 1139121}}
[[ 85747  76421  30133]
 [ 44460 659791  51737]
 [ 23921  70561  96350]]
Evaluating performance on  train set...
1504/1504 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53637147
{'0': {'precision': 0.5432149505596789, 'recall': 0.42539616425907345, 'f1-score': 0.4771400055212249, 'support': 52819}, '1': {'precision': 0.8505851144669034, 'recall': 0.8837411269890258, 'f1-score': 0.8668461904007603, 'support': 278654}, '2': {'precision': 0.507322951427512, 'recall': 0.5129719191691973, 'f1-score': 0.5101317972522045, 'support': 53346}, 'accuracy': 0.7694318627718486, 'macro avg': {'precision': 0.6337076721513649, 'recall': 0.6073697368057654, 'f1-score': 0.6180393310580632, 'support': 384819}, 'weighted avg': {'precision': 0.7608113557987631, 'recall': 0.7694318627718486, 'f1-score': 0.7639064265220147, 'support': 384819}}
[[ 22469  22857   7493]
 [ 13314 246258  19082]
 [  5580  20401  27365]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5421823
{'0': {'precision': 0.5448741469142144, 'recall': 0.42334226580762874, 'f1-score': 0.47648078033754737, 'support': 17539}, '1': {'precision': 0.8508094467678093, 'recall': 0.8800096825797761, 'f1-score': 0.8651632495744802, 'support': 95016}, '2': {'precision': 0.49013812006234214, 'recall': 0.5079082200935621, 'f1-score': 0.498864972786697, 'support': 17956}, 'accuracy': 0.7674448897027837, 'macro avg': {'precision': 0.6286072379147886, 'recall': 0.6037533894936556, 'f1-score': 0.6135030008995749, 'support': 130511}, 'weighted avg': {'precision': 0.7600736960153397, 'recall': 0.7674448897027837, 'f1-score': 0.762533174822559, 'support': 130511}}
[[ 7425  7716  2398]
 [ 4312 83615  7089]
 [ 1890  6946  9120]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
6203/6203 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5271511
{'0': {'precision': 0.5667043466365227, 'recall': 0.38868258091278113, 'f1-score': 0.46110764489983624, 'support': 202502}, '1': {'precision': 0.8495464388404651, 'recall': 0.9241176510433071, 'f1-score': 0.8852644240713059, 'support': 1181052}, '2': {'precision': 0.5278912475724905, 'recall': 0.42439800313234144, 'f1-score': 0.4705208867473541, 'support': 204320}, 'accuracy': 0.7915319477490027, 'macro avg': {'precision': 0.648047344349826, 'recall': 0.57906607836281, 'f1-score': 0.6056309852394988, 'support': 1587874}, 'weighted avg': {'precision': 0.7720864652938515, 'recall': 0.7915319477490027, 'f1-score': 0.7778043890547928, 'support': 1587874}}
[[  78709   96692   27101]
 [  39172 1091431   50449]
 [  21008   96599   86713]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5576531
{'0': {'precision': 0.5243954273953603, 'recall': 0.39896179048591607, 'f1-score': 0.4531588308072997, 'support': 58755}, '1': {'precision': 0.8455346123639628, 'recall': 0.9032940492564192, 'f1-score': 0.8734605059377638, 'support': 333723}, '2': {'precision': 0.4957652156785503, 'recall': 0.42293280459731486, 'f1-score': 0.4564620113707461, 'support': 59513}, 'accuracy': 0.7744866601326132, 'macro avg': {'precision': 0.6218984184792912, 'recall': 0.57506288144655, 'f1-score': 0.5943604493719364, 'support': 451991}, 'weighted avg': {'precision': 0.7577356099108847, 'recall': 0.7744866601326132, 'f1-score': 0.7639192621310124, 'support': 451991}}
[[ 23441  27040   8274]
 [ 14947 301450  17326]
 [  6313  28030  25170]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50686514
{'0': {'precision': 0.5272111461781234, 'recall': 0.39617075428042575, 'f1-score': 0.45239274744872693, 'support': 17288}, '1': {'precision': 0.8698737842267724, 'recall': 0.9155640012960514, 'f1-score': 0.8921342753771588, 'support': 114193}, '2': {'precision': 0.5059100067159167, 'recall': 0.45404134771864263, 'f1-score': 0.4785743781963724, 'support': 16591}, 'accuracy': 0.8032106002485278, 'macro avg': {'precision': 0.6343316457069376, 'recall': 0.5885920344317066, 'f1-score': 0.6077004670074194, 'support': 148072}, 'weighted avg': {'precision': 0.7890855547217502, 'recall': 0.8032106002485278, 'f1-score': 0.7944546074524117, 'support': 148072}}
[[  6849   8273   2166]
 [  4451 104551   5191]
 [  1691   7367   7533]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
5183/5183 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8219329
{'0': {'precision': 0.5086213082288109, 'recall': 0.4649927840461821, 'f1-score': 0.48582952941015206, 'support': 304880}, '1': {'precision': 0.718226722251061, 'recall': 0.7568172622681116, 'f1-score': 0.7370171836591523, 'support': 709339}, '2': {'precision': 0.48406173085877735, 'recall': 0.4655413423922257, 'f1-score': 0.47462093232955205, 'support': 312621}, 'accuracy': 0.6211336709776613, 'macro avg': {'precision': 0.5703032537795497, 'recall': 0.5624504629021732, 'f1-score': 0.5658225484662854, 'support': 1326840}, 'weighted avg': {'precision': 0.6148914351017809, 'recall': 0.6211336709776613, 'f1-score': 0.6174755128364863, 'support': 1326840}}
[[141767  99035  64078]
 [ 81455 536840  91044]
 [ 55506 111577 145538]]
Evaluating performance on  train set...
1489/1489 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7879497
{'0': {'precision': 0.4784632556251744, 'recall': 0.47011540091224047, 'f1-score': 0.4742525961127455, 'support': 80242}, '1': {'precision': 0.7413299268911501, 'recall': 0.7594124545508057, 'f1-score': 0.7502622520348298, 'support': 220851}, '2': {'precision': 0.4844249674286391, 'recall': 0.4602745892415035, 'f1-score': 0.47204108719487564, 'support': 79974}, 'accuracy': 0.6357149792556165, 'macro avg': {'precision': 0.5680727166483212, 'recall': 0.5632674815681832, 'f1-score': 0.5655186451141504, 'support': 381067}, 'weighted avg': {'precision': 0.6320613083443347, 'recall': 0.6357149792556165, 'f1-score': 0.6337524880106283, 'support': 381067}}
[[ 37723  29256  13263]
 [ 27220 167717  25914]
 [ 13899  29265  36810]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74015164
{'0': {'precision': 0.47153790959100694, 'recall': 0.45969998445515314, 'f1-score': 0.46554370498642217, 'support': 25732}, '1': {'precision': 0.7692691029900333, 'recall': 0.7944272218205879, 'f1-score': 0.7816457794575956, 'support': 81611}, '2': {'precision': 0.49516804926024116, 'recall': 0.45574402770671807, 'f1-score': 0.4746387949584998, 'support': 25409}, 'accuracy': 0.6647206821742798, 'macro avg': {'precision': 0.5786583539470938, 'recall': 0.569957077994153, 'f1-score': 0.5739427598008392, 'support': 132752}, 'weighted avg': {'precision': 0.6590948476660907, 'recall': 0.6647206821742798, 'f1-score': 0.6616123407943004, 'support': 132752}}
[[11829  9940  3963]
 [ 8934 64834  7843]
 [ 4323  9506 11580]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
7324/7324 - 108s - 108s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8822791
{'0': {'precision': 0.5112073701178823, 'recall': 0.46459533284909, 'f1-score': 0.4867880721229448, 'support': 488735}, '1': {'precision': 0.6590594828250388, 'recall': 0.7152971621147323, 'f1-score': 0.6860277199012091, 'support': 908881}, '2': {'precision': 0.5025489869353161, 'recall': 0.46779643253893394, 'f1-score': 0.4845503849377109, 'support': 477090}, 'accuracy': 0.5869533676213764, 'macro avg': {'precision': 0.5576052799594123, 'recall': 0.5492296425009188, 'f1-score': 0.5524553923206216, 'support': 1874706}, 'weighted avg': {'precision': 0.5806844764037867, 'recall': 0.5869533676213764, 'f1-score': 0.5828124898893324, 'support': 1874706}}
[[227064 170103  91568]
 [129412 650120 129349]
 [ 87696 166213 223181]]
Evaluating performance on  train set...
2046/2046 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83791924
{'0': {'precision': 0.4957465095067705, 'recall': 0.4595168029655161, 'f1-score': 0.4769446249124613, 'support': 123014}, '1': {'precision': 0.7008837061770755, 'recall': 0.7421370246913135, 'f1-score': 0.7209206870421824, 'support': 276899}, '2': {'precision': 0.4967691000677931, 'recall': 0.46745371005902825, 'f1-score': 0.48166576527852895, 'support': 123839}, 'accuracy': 0.6108100780522079, 'macro avg': {'precision': 0.5644664385838797, 'recall': 0.5563691792386193, 'f1-score': 0.5598436924110576, 'support': 523752}, 'weighted avg': {'precision': 0.6044409320832901, 'recall': 0.6108100780522079, 'f1-score': 0.6070470186588356, 'support': 523752}}
[[ 56527  43616  22871]
 [ 35631 205497  35771]
 [ 21866  44084  57889]]
Evaluating performance on  val set...
741/741 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82866794
{'0': {'precision': 0.5075869771055379, 'recall': 0.47436130144756544, 'f1-score': 0.49041201928151723, 'support': 44074}, '1': {'precision': 0.7095128624083292, 'recall': 0.7419781049452624, 'f1-score': 0.7253824114990531, 'support': 100662}, '2': {'precision': 0.48570699928129274, 'recall': 0.46707094127614035, 'f1-score': 0.4762067123552343, 'support': 44854}, 'accuracy': 0.6147265151115565, 'macro avg': {'precision': 0.5676022795983866, 'recall': 0.5611367825563227, 'f1-score': 0.5640003810452682, 'support': 189590}, 'weighted avg': {'precision': 0.6096222054457503, 'recall': 0.6147265151115565, 'f1-score': 0.6118077932386358, 'support': 189590}}
[[20907 14418  8749]
 [12539 74689 13434]
 [ 7743 16161 20950]]
testing model on single stock: results/universal/W6/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
29350/29350 - 427s - 427s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98086524
{'0': {'precision': 0.5009037168344256, 'recall': 0.5597797894677166, 'f1-score': 0.5287077162738478, 'support': 2469455}, '1': {'precision': 0.576719553531821, 'recall': 0.4671606091396187, 'f1-score': 0.5161907804458477, 'support': 2535248}, '2': {'precision': 0.5065085566585348, 'recall': 0.5451442798484156, 'f1-score': 0.5251167167937411, 'support': 2508701}, 'accuracy': 0.5236405496097375, 'macro avg': {'precision': 0.5280439423415938, 'recall': 0.524028226151917, 'f1-score': 0.5233384045044788, 'support': 7513404}, 'weighted avg': {'precision': 0.5283576931715134, 'recall': 0.5236405496097375, 'f1-score': 0.5232851034992906, 'support': 7513404}}
[[1382351  420746  666358]
 [ 684781 1184368  666099]
 [ 692582  448515 1367604]]
Evaluating performance on  train set...
5452/5452 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9946402
{'0': {'precision': 0.4752123280489496, 'recall': 0.6101508689949884, 'f1-score': 0.5342934341350442, 'support': 460532}, '1': {'precision': 0.6265105608512834, 'recall': 0.3778781104832723, 'f1-score': 0.47142034491036183, 'support': 475529}, '2': {'precision': 0.4819496713114105, 'recall': 0.5427370519836139, 'f1-score': 0.5105403200129406, 'support': 459414}, 'accuracy': 0.5088066787294648, 'macro avg': {'precision': 0.5278908534038812, 'recall': 0.5102553438206249, 'f1-score': 0.5054180330194489, 'support': 1395475}, 'weighted avg': {'precision': 0.5289875136766686, 'recall': 0.5088066787294648, 'f1-score': 0.5050485602267218, 'support': 1395475}}
[[280994  51511 128027]
 [155846 179692 139991]
 [154462  55611 249341]]
Evaluating performance on  val set...
1969/1969 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0050606
{'0': {'precision': 0.448695447498094, 'recall': 0.585811821922933, 'f1-score': 0.5081667482810278, 'support': 149688}, '1': {'precision': 0.6333770741290017, 'recall': 0.3955274539847553, 'f1-score': 0.4869606745765241, 'support': 206236}, '2': {'precision': 0.4469676328797896, 'recall': 0.542625507125065, 'f1-score': 0.4901732412144569, 'support': 148139}, 'accuracy': 0.4952654727682849, 'macro avg': {'precision': 0.5096800515022951, 'recall': 0.5079882610109178, 'f1-score': 0.4951002213573363, 'support': 504063}, 'weighted avg': {'precision': 0.523749643541269, 'recall': 0.4952654727682849, 'f1-score': 0.4942022320204477, 'support': 504063}}
[[87689 22896 39103]
 [64308 81572 60356]
 [43434 24321 80384]]
training model: results/universal/W6/deepVOL_L3/h20
Epoch 1/50
9426/9426 - 544s - loss: 2.9032 - accuracy20: 0.5024 - val_loss: 3.0675 - val_accuracy20: 0.5005 - 544s/epoch - 58ms/step
Epoch 2/50
9426/9426 - 528s - loss: 2.7979 - accuracy20: 0.5359 - val_loss: 3.1437 - val_accuracy20: 0.5052 - 528s/epoch - 56ms/step
Epoch 3/50
9426/9426 - 535s - loss: 2.7653 - accuracy20: 0.5442 - val_loss: 3.1428 - val_accuracy20: 0.5087 - 535s/epoch - 57ms/step
Epoch 4/50
9426/9426 - 523s - loss: 2.7444 - accuracy20: 0.5492 - val_loss: 2.9788 - val_accuracy20: 0.5190 - 523s/epoch - 56ms/step
Epoch 5/50
9426/9426 - 540s - loss: 2.7297 - accuracy20: 0.5525 - val_loss: 2.9597 - val_accuracy20: 0.5255 - 540s/epoch - 57ms/step
Epoch 6/50
9426/9426 - 538s - loss: 2.7184 - accuracy20: 0.5546 - val_loss: 2.9439 - val_accuracy20: 0.5246 - 538s/epoch - 57ms/step
Epoch 7/50
9426/9426 - 547s - loss: 2.7106 - accuracy20: 0.5562 - val_loss: 2.9308 - val_accuracy20: 0.5279 - 547s/epoch - 58ms/step
Epoch 8/50
9426/9426 - 540s - loss: 2.7040 - accuracy20: 0.5576 - val_loss: 2.8797 - val_accuracy20: 0.5324 - 540s/epoch - 57ms/step
Epoch 9/50
9426/9426 - 557s - loss: 2.6985 - accuracy20: 0.5589 - val_loss: 2.8636 - val_accuracy20: 0.5335 - 557s/epoch - 59ms/step
Epoch 10/50
9426/9426 - 541s - loss: 2.6939 - accuracy20: 0.5599 - val_loss: 2.8731 - val_accuracy20: 0.5315 - 541s/epoch - 57ms/step
Epoch 11/50
9426/9426 - 530s - loss: 2.6897 - accuracy20: 0.5605 - val_loss: 2.8605 - val_accuracy20: 0.5325 - 530s/epoch - 56ms/step
Epoch 12/50
9426/9426 - 525s - loss: 2.6863 - accuracy20: 0.5614 - val_loss: 2.8644 - val_accuracy20: 0.5322 - 525s/epoch - 56ms/step
Epoch 13/50
9426/9426 - 529s - loss: 2.6832 - accuracy20: 0.5623 - val_loss: 2.8629 - val_accuracy20: 0.5322 - 529s/epoch - 56ms/step
Epoch 14/50
9426/9426 - 531s - loss: 2.6800 - accuracy20: 0.5627 - val_loss: 2.8498 - val_accuracy20: 0.5316 - 531s/epoch - 56ms/step
Epoch 15/50
9426/9426 - 526s - loss: 2.6775 - accuracy20: 0.5634 - val_loss: 2.8654 - val_accuracy20: 0.5296 - 526s/epoch - 56ms/step
Epoch 16/50
9426/9426 - 534s - loss: 2.6752 - accuracy20: 0.5637 - val_loss: 2.8575 - val_accuracy20: 0.5313 - 534s/epoch - 57ms/step
Epoch 17/50
9426/9426 - 530s - loss: 2.6728 - accuracy20: 0.5642 - val_loss: 2.8502 - val_accuracy20: 0.5296 - 530s/epoch - 56ms/step
Epoch 18/50
9426/9426 - 529s - loss: 2.6709 - accuracy20: 0.5647 - val_loss: 2.8465 - val_accuracy20: 0.5310 - 529s/epoch - 56ms/step
Epoch 19/50
9426/9426 - 532s - loss: 2.6687 - accuracy20: 0.5653 - val_loss: 2.8545 - val_accuracy20: 0.5289 - 532s/epoch - 56ms/step
Epoch 20/50
9426/9426 - 516s - loss: 2.6672 - accuracy20: 0.5657 - val_loss: 2.8454 - val_accuracy20: 0.5314 - 516s/epoch - 55ms/step
Epoch 21/50
9426/9426 - 531s - loss: 2.6651 - accuracy20: 0.5660 - val_loss: 2.8340 - val_accuracy20: 0.5293 - 531s/epoch - 56ms/step
Epoch 22/50
9426/9426 - 535s - loss: 2.6636 - accuracy20: 0.5662 - val_loss: 2.8371 - val_accuracy20: 0.5278 - 535s/epoch - 57ms/step
Epoch 23/50
9426/9426 - 523s - loss: 2.6622 - accuracy20: 0.5667 - val_loss: 2.8378 - val_accuracy20: 0.5280 - 523s/epoch - 55ms/step
Epoch 24/50
9426/9426 - 530s - loss: 2.6607 - accuracy20: 0.5669 - val_loss: 2.8417 - val_accuracy20: 0.5277 - 530s/epoch - 56ms/step
Epoch 25/50
9426/9426 - 525s - loss: 2.6589 - accuracy20: 0.5672 - val_loss: 2.8568 - val_accuracy20: 0.5266 - 525s/epoch - 56ms/step
Epoch 26/50
9426/9426 - 539s - loss: 2.6575 - accuracy20: 0.5677 - val_loss: 2.8519 - val_accuracy20: 0.5229 - 539s/epoch - 57ms/step
Epoch 27/50
9426/9426 - 552s - loss: 2.6559 - accuracy20: 0.5681 - val_loss: 2.8400 - val_accuracy20: 0.5281 - 552s/epoch - 59ms/step
Epoch 28/50
9426/9426 - 556s - loss: 2.6550 - accuracy20: 0.5683 - val_loss: 2.8504 - val_accuracy20: 0.5259 - 556s/epoch - 59ms/step
Epoch 29/50
9426/9426 - 535s - loss: 2.6538 - accuracy20: 0.5684 - val_loss: 2.8473 - val_accuracy20: 0.5270 - 535s/epoch - 57ms/step
Epoch 30/50
9426/9426 - 537s - loss: 2.6525 - accuracy20: 0.5686 - val_loss: 2.8451 - val_accuracy20: 0.5267 - 537s/epoch - 57ms/step
Epoch 31/50
9426/9426 - 536s - loss: 2.6512 - accuracy20: 0.5691 - val_loss: 2.8392 - val_accuracy20: 0.5252 - 536s/epoch - 57ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1315s - 1315s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99432164
{'0': {'precision': 0.44669573426194786, 'recall': 0.5436800198658419, 'f1-score': 0.4904391987895659, 'support': 3141070}, '1': {'precision': 0.6605009780525275, 'recall': 0.4419175305783252, 'f1-score': 0.5295392972457441, 'support': 4556986}, '2': {'precision': 0.42563173510833185, 'recall': 0.5383075480048055, 'f1-score': 0.4753842481431585, 'support': 3120573}, 'accuracy': 0.49926631184043746, 'macro avg': {'precision': 0.5109428158076025, 'recall': 0.5079683661496576, 'f1-score': 0.4984542480594895, 'support': 10818629}, 'weighted avg': {'precision': 0.5306782569687956, 'recall': 0.49926631184043746, 'f1-score': 0.5025662925978399, 'support': 10818629}}
[[1707737  527449  905884]
 [1182216 2013812 1360958]
 [ 933090  507655 1679828]]
Evaluating performance on  train set...
9426/9426 - 300s - 300s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9513956
{'0': {'precision': 0.4516957580254611, 'recall': 0.5926621492197682, 'f1-score': 0.5126652020109842, 'support': 694345}, '1': {'precision': 0.7216748902022447, 'recall': 0.5191236423310903, 'f1-score': 0.6038667644388337, 'support': 1025563}, '2': {'precision': 0.4617776619280337, 'recall': 0.5092367227076475, 'f1-score': 0.48434739361365964, 'support': 692291}, 'accuracy': 0.5374539994420029, 'macro avg': {'precision': 0.5450494367185797, 'recall': 0.5403408380861686, 'f1-score': 0.5336264533544925, 'support': 2412199}, 'weighted avg': {'precision': 0.5693727075919083, 'recall': 0.5374539994420029, 'f1-score': 0.543313081425162, 'support': 2412199}}
[[411512 106725 176108]
 [258376 532394 234793]
 [241150  98601 352540]]
Evaluating performance on  val set...
3323/3323 - 106s - 106s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9615149
{'0': {'precision': 0.4386873920552677, 'recall': 0.5712102596607609, 'f1-score': 0.49625373165290304, 'support': 230339}, '1': {'precision': 0.7227530666159979, 'recall': 0.5055914687606238, 'f1-score': 0.5949760412938002, 'support': 391221}, '2': {'precision': 0.4362138876641634, 'recall': 0.5276841493217219, 'f1-score': 0.4776089283347215, 'support': 228741}, 'accuracy': 0.5293102089730578, 'macro avg': {'precision': 0.5325514487784764, 'recall': 0.5348286259143689, 'f1-score': 0.522946233760475, 'support': 850301}, 'weighted avg': {'precision': 0.5687197751753603, 'recall': 0.5293102089730578, 'f1-score': 0.5366599051658324, 'support': 850301}}
[[131572  39119  59648]
 [ 97068 197798  96355]
 [ 71282  36756 120703]]
testing model out of sample: results/universal/W6/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 568s - 568s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86861706
{'0': {'precision': 0.5131177557562312, 'recall': 0.49164209408434245, 'f1-score': 0.502150415329354, 'support': 1239186}, '1': {'precision': 0.689986163500898, 'recall': 0.7152937362712761, 'f1-score': 0.7024120688640815, 'support': 2011294}, '2': {'precision': 0.5026683026099232, 'recall': 0.493749306490921, 'f1-score': 0.4981688873053613, 'support': 1234663}, 'accuracy': 0.5925153334018559, 'macro avg': {'precision': 0.5685907406223508, 'recall': 0.5668950456155132, 'f1-score': 0.5675771238329322, 'support': 4485143}, 'weighted avg': {'precision': 0.5895551879889207, 'recall': 0.5925153334018559, 'f1-score': 0.5908586720894593, 'support': 4485143}}
[[ 609236  332538  297412]
 [ 266898 1438666  305730]
 [ 311188  313861  609614]]
Evaluating performance on  train set...
5153/5153 - 166s - 166s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8894887
{'0': {'precision': 0.4867985857664234, 'recall': 0.4942878815075592, 'f1-score': 0.4905146482102378, 'support': 345406}, '1': {'precision': 0.7055898862368206, 'recall': 0.6739677251530931, 'f1-score': 0.6894163847770665, 'support': 628539}, '2': {'precision': 0.4704958846336984, 'recall': 0.5016943743290684, 'f1-score': 0.4855945352045437, 'support': 344670}, 'accuracy': 0.5818711299355763, 'macro avg': {'precision': 0.5542947855456475, 'recall': 0.5566499936632402, 'f1-score': 0.5551751893972826, 'support': 1318615}, 'weighted avg': {'precision': 0.5868276414096146, 'recall': 0.5818711299355763, 'f1-score': 0.5840382948017793, 'support': 1318615}}
[[170730  89793  84883]
 [ 95201 423615 109723]
 [ 84789  86962 172919]]
Evaluating performance on  val set...
1795/1795 - 60s - 60s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87138546
{'0': {'precision': 0.48720887397159346, 'recall': 0.5038178924556413, 'f1-score': 0.49537420458376163, 'support': 118128}, '1': {'precision': 0.7235159254978495, 'recall': 0.6849388783755909, 'f1-score': 0.7036990965340263, 'support': 222998}, '2': {'precision': 0.47110141766630315, 'recall': 0.5025559159689554, 'f1-score': 0.48632058998746897, 'support': 117766}, 'accuracy': 0.5915095490878028, 'macro avg': {'precision': 0.5606087390452487, 'recall': 0.5637708956000625, 'f1-score': 0.5617979637017523, 'support': 458892}, 'weighted avg': {'precision': 0.5979083177993422, 'recall': 0.5915095490878028, 'f1-score': 0.5942859883554947, 'support': 458892}}
[[ 59515  29668  28945]
 [ 32758 152740  37500]
 [ 29882  28700  59184]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
1059/1059 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.08916
{'0': {'precision': 0.4392057192562792, 'recall': 0.6683557394002069, 'f1-score': 0.5300756196381411, 'support': 96700}, '1': {'precision': 0.4938046647230321, 'recall': 0.07546224103363779, 'f1-score': 0.13091787439613528, 'support': 71824}, '2': {'precision': 0.45221756877606495, 'recall': 0.49806422671464656, 'f1-score': 0.4740349541957101, 'support': 102543}, 'accuracy': 0.44683786665289393, 'macro avg': {'precision': 0.4617426509184588, 'recall': 0.4139607357161637, 'f1-score': 0.37834281607666215, 'support': 271067}, 'weighted avg': {'precision': 0.45859498000919807, 'recall': 0.44683786665289393, 'f1-score': 0.40311186584027925, 'support': 271067}}
[[64630  2427 29643]
 [34181  5420 32223]
 [48341  3129 51073]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1248823
{'0': {'precision': 0.437664244860102, 'recall': 0.6182443498198493, 'f1-score': 0.5125130108159478, 'support': 18318}, '1': {'precision': 0.55064762537363, 'recall': 0.09004018681438036, 'f1-score': 0.1547724620770128, 'support': 18414}, '2': {'precision': 0.3819798978940651, 'recall': 0.5559296453242004, 'f1-score': 0.4528239438284593, 'support': 17227}, 'accuracy': 0.4180952204451528, 'macro avg': {'precision': 0.4567639227092657, 'recall': 0.4214047273194767, 'f1-score': 0.3733698055738066, 'support': 53959}, 'weighted avg': {'precision': 0.45844301621598676, 'recall': 0.4180952204451528, 'f1-score': 0.3713744051807023, 'support': 53959}}
[[11325   673  6320]
 [ 7581  1658  9175]
 [ 6970   680  9577]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1043832
{'0': {'precision': 0.43056222969726093, 'recall': 0.6391781994578399, 'f1-score': 0.5145285402549673, 'support': 7009}, '1': {'precision': 0.610223642172524, 'recall': 0.1138429444196096, 'f1-score': 0.1918874795931182, 'support': 6711}, '2': {'precision': 0.4105790645879733, 'recall': 0.5330345525516843, 'f1-score': 0.4638611058690319, 'support': 6917}, 'accuracy': 0.43276639046373017, 'macro avg': {'precision': 0.48378831215258605, 'recall': 0.4286852321430446, 'f1-score': 0.3900923752390391, 'support': 20637}, 'weighted avg': {'precision': 0.48228894317599075, 'recall': 0.43276639046373017, 'f1-score': 0.3926256085425486, 'support': 20637}}
[[4480  208 2321]
 [2975  764 2972]
 [2950  280 3687]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61985976
{'0': {'precision': 0.5664831936670893, 'recall': 0.4082794740361043, 'f1-score': 0.47454312321102465, 'support': 89740}, '1': {'precision': 0.8079711871027984, 'recall': 0.8954156921338704, 'f1-score': 0.8494489285347584, 'support': 378814}, '2': {'precision': 0.5627502175805048, 'recall': 0.46378874653777824, 'f1-score': 0.5084993890118932, 'support': 90621}, 'accuracy': 0.7472866276210489, 'macro avg': {'precision': 0.6457348661167975, 'recall': 0.5891613042359176, 'f1-score': 0.6108304802525587, 'support': 559175}, 'weighted avg': {'precision': 0.7294746484342237, 'recall': 0.7472866276210489, 'f1-score': 0.7340266811330443, 'support': 559175}}
[[ 36639  40776  12325]
 [ 19287 339196  20331]
 [  8752  39840  42029]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5539167
{'0': {'precision': 0.5567053558942805, 'recall': 0.43911317008603573, 'f1-score': 0.4909662699636184, 'support': 18132}, '1': {'precision': 0.8573116015889195, 'recall': 0.8998180327541042, 'f1-score': 0.8780506841630283, 'support': 100018}, '2': {'precision': 0.5297440423654016, 'recall': 0.4967446479805782, 'f1-score': 0.5127139155442922, 'support': 18124}, 'accuracy': 0.7849112816824926, 'macro avg': {'precision': 0.6479203332828672, 'recall': 0.6118919502735727, 'f1-score': 0.6272436232236464, 'support': 136274}, 'weighted avg': {'precision': 0.7737488758283032, 'recall': 0.7849112816824926, 'f1-score': 0.7779583834107962, 'support': 136274}}
[[ 7962  7840  2330]
 [ 4358 89998  5662]
 [ 1982  7139  9003]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5559814
{'0': {'precision': 0.5919459962756052, 'recall': 0.40059861373660993, 'f1-score': 0.4778278842540398, 'support': 6348}, '1': {'precision': 0.8504047322540473, 'recall': 0.9150498311046593, 'f1-score': 0.8815437369730383, 'support': 35821}, '2': {'precision': 0.5119358448340171, 'recall': 0.4549975136747887, 'f1-score': 0.4817902588854761, 'support': 6033}, 'accuracy': 0.7897182689514958, 'macro avg': {'precision': 0.6514288577878898, 'recall': 0.5902153195053527, 'f1-score': 0.6137206267041847, 'support': 48202}, 'weighted avg': {'precision': 0.7740037768207418, 'recall': 0.7897182689514958, 'f1-score': 0.7783426049378019, 'support': 48202}}
[[ 2543  3027   778]
 [ 1204 32778  1839]
 [  549  2739  2745]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0526222
{'0': {'precision': 0.4942889561270802, 'recall': 0.4734630293808644, 'f1-score': 0.48365190681494363, 'support': 110412}, '1': {'precision': 0.522674254206136, 'recall': 0.3277226186782501, 'f1-score': 0.40285231699675816, 'support': 90244}, '2': {'precision': 0.4491719075448424, 'recall': 0.6055561109041175, 'f1-score': 0.5157704900268582, 'support': 110041}, 'accuracy': 0.47791578290102577, 'macro avg': {'precision': 0.48871170595935287, 'recall': 0.4689139196544107, 'f1-score': 0.46742490461285335, 'support': 310697}, 'weighted avg': {'precision': 0.4865543391105279, 'recall': 0.47791578290102577, 'f1-score': 0.47155871901998564, 'support': 310697}}
[[52276 13506 44630]
 [23582 29575 37087]
 [29902 13503 66636]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1035314
{'0': {'precision': 0.4370341383422779, 'recall': 0.543875515977923, 'f1-score': 0.4846362077159919, 'support': 43122}, '1': {'precision': 0.5531744335185977, 'recall': 0.2266278407846915, 'f1-score': 0.32152952505203, 'support': 45674}, '2': {'precision': 0.41731530793390686, 'recall': 0.5798311355658856, 'f1-score': 0.4853297335927264, 'support': 42164}, 'accuracy': 0.4448075748320098, 'macro avg': {'precision': 0.4691746265982608, 'recall': 0.45011149744283335, 'f1-score': 0.4304984887869161, 'support': 130960}, 'weighted avg': {'precision': 0.47119088144356586, 'recall': 0.4448075748320098, 'f1-score': 0.42797392305711013, 'support': 130960}}
[[23453  4294 15375]
 [16562 10351 18761]
 [13649  4067 24448]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879673
{'0': {'precision': 0.4325341361143963, 'recall': 0.5722210369106038, 'f1-score': 0.4926675443161988, 'support': 14061}, '1': {'precision': 0.5674051176369569, 'recall': 0.22434983363889455, 'f1-score': 0.3215571776155718, 'support': 14727}, '2': {'precision': 0.4280525584873411, 'recall': 0.5581168605056063, 'f1-score': 0.4845077234666425, 'support': 14359}, 'accuracy': 0.4487913412288224, 'macro avg': {'precision': 0.47599727074623144, 'recall': 0.4515625770183682, 'f1-score': 0.4329108151328043, 'support': 43147}, 'weighted avg': {'precision': 0.4770770700781913, 'recall': 0.4487913412288224, 'f1-score': 0.431548364814057, 'support': 43147}}
[[8046 1311 4704]
 [5419 3304 6004]
 [5137 1208 8014]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1095/1095 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1827825
{'0': {'precision': 0.36450882901930987, 'recall': 0.8701326866583861, 'f1-score': 0.5137864597582058, 'support': 101442}, '1': {'precision': 0.27403462050599203, 'recall': 0.02790962597303968, 'f1-score': 0.050659708546671914, 'support': 73738}, '2': {'precision': 0.4413765900798738, 'recall': 0.1279966447111306, 'f1-score': 0.19844530487985104, 'support': 104909}, 'accuracy': 0.3704322554616568, 'macro avg': {'precision': 0.3599733465350586, 'recall': 0.3420129857808521, 'f1-score': 0.2542971577282429, 'support': 280089}, 'weighted avg': {'precision': 0.3694812940491671, 'recall': 0.3704322554616568, 'f1-score': 0.27374788059954763, 'support': 280089}}
[[88268  2728 10446]
 [65131  2058  6549]
 [88757  2724 13428]]
Evaluating performance on  train set...
448/448 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2085879
{'0': {'precision': 0.34737696377043925, 'recall': 0.8796397310668527, 'f1-score': 0.4980642566242646, 'support': 39415}, '1': {'precision': 0.3510795622596865, 'recall': 0.03190860215053763, 'f1-score': 0.05850028338384958, 'support': 37200}, '2': {'precision': 0.39885714285714285, 'recall': 0.11955519249519092, 'f1-score': 0.18396723704484633, 'support': 37949}, 'accuracy': 0.35259767466219755, 'macro avg': {'precision': 0.36577122296242287, 'recall': 0.343701175237527, 'f1-score': 0.24684392568432015, 'support': 114564}, 'weighted avg': {'precision': 0.3656318953367368, 'recall': 0.35259767466219755, 'f1-score': 0.25128998546960185, 'support': 114564}}
[[34671  1106  3638]
 [32813  1187  3200]
 [32324  1088  4537]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2046107
{'0': {'precision': 0.3522618220324961, 'recall': 0.8734717321736276, 'f1-score': 0.5020515964721973, 'support': 12187}, '1': {'precision': 0.3221476510067114, 'recall': 0.03186948686332163, 'f1-score': 0.05800103573278093, 'support': 10543}, '2': {'precision': 0.4024494446026773, 'recall': 0.11732956904425808, 'f1-score': 0.1816895975311817, 'support': 12043}, 'accuracy': 0.3564259626721882, 'macro avg': {'precision': 0.3589529725472949, 'recall': 0.3408902626937358, 'f1-score': 0.24724740991205332, 'support': 34773}, 'weighted avg': {'precision': 0.36051293161429354, 'recall': 0.3564259626721882, 'f1-score': 0.256466095792868, 'support': 34773}}
[[10645   371  1171]
 [ 9280   336   927]
 [10294   336  1413]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
1722/1722 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0978607
{'0': {'precision': 0.44613388210929206, 'recall': 0.6318564356435643, 'f1-score': 0.5229964683857784, 'support': 161600}, '1': {'precision': 0.4844447569163708, 'recall': 0.12083508698092031, 'f1-score': 0.19342433067826942, 'support': 114048}, '2': {'precision': 0.4578780132876242, 'recall': 0.5086920454614262, 'f1-score': 0.48194934457734556, 'support': 165151}, 'accuracy': 0.4534946767120615, 'macro avg': {'precision': 0.462818884104429, 'recall': 0.42046118936197024, 'f1-score': 0.3994567145471311, 'support': 440799}, 'weighted avg': {'precision': 0.4604461506449068, 'recall': 0.4534946767120615, 'f1-score': 0.42234738182852105, 'support': 440799}}
[[102108   7280  52212]
 [ 53011  13781  47256]
 [ 73754   7386  84011]]
Evaluating performance on  train set...
618/618 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1813366
{'0': {'precision': 0.4161963955998232, 'recall': 0.6091888394046667, 'f1-score': 0.4945306223348372, 'support': 52542}, '1': {'precision': 0.5141278610891871, 'recall': 0.061934281585152504, 'f1-score': 0.11055105816065035, 'support': 52588}, '2': {'precision': 0.4029607024306671, 'recall': 0.5699411241315336, 'f1-score': 0.47212137844513274, 'support': 52823}, 'accuracy': 0.4138636176584174, 'macro avg': {'precision': 0.4444283197065591, 'recall': 0.41368808170711757, 'f1-score': 0.3590676863135401, 'support': 157953}, 'weighted avg': {'precision': 0.44437484670160876, 'recall': 0.4138636176584174, 'f1-score': 0.3591964355148465, 'support': 157953}}
[[32008  1538 18996]
 [23721  3257 25610]
 [21177  1540 30106]]
Evaluating performance on  val set...
225/225 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1690313
{'0': {'precision': 0.41267792352777005, 'recall': 0.6227100442198358, 'f1-score': 0.49639110365086025, 'support': 18996}, '1': {'precision': 0.5340825800146591, 'recall': 0.11005386900266828, 'f1-score': 0.1825012522958758, 'support': 19863}, '2': {'precision': 0.40426910769978536, 'recall': 0.5369882175714209, 'f1-score': 0.46127183658378784, 'support': 18587}, 'accuracy': 0.4177140270863071, 'macro avg': {'precision': 0.45034320374740483, 'recall': 0.42325071026464167, 'f1-score': 0.380054730843508, 'support': 57446}, 'weighted avg': {'precision': 0.4519350699262021, 'recall': 0.4177140270863071, 'f1-score': 0.37649492403104806, 'support': 57446}}
[[11829   956  6211]
 [ 9180  2186  8497]
 [ 7655   951  9981]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
4450/4450 - 78s - 78s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69545424
{'0': {'precision': 0.5895362378780787, 'recall': 0.43760957205296624, 'f1-score': 0.5023370553103091, 'support': 247554}, '1': {'precision': 0.7552801678069393, 'recall': 0.8467530218650373, 'f1-score': 0.7984051373819615, 'support': 646786}, '2': {'precision': 0.5647226420666771, 'recall': 0.531185018445059, 'f1-score': 0.5474406610178412, 'support': 244781}, 'accuracy': 0.6900267838096217, 'macro avg': {'precision': 0.6365130159172318, 'recall': 0.6051825374543541, 'f1-score': 0.616060951236704, 'support': 1139121}, 'weighted avg': {'precision': 0.6783125458090689, 'recall': 0.6900267838096217, 'f1-score': 0.6801348452198017, 'support': 1139121}}
[[108332  95004  44218]
 [ 43116 547668  56002]
 [ 32310  82447 130024]]
Evaluating performance on  train set...
1504/1504 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6422996
{'0': {'precision': 0.5902891883010187, 'recall': 0.40964095839450393, 'f1-score': 0.4836470419951703, 'support': 70159}, '1': {'precision': 0.7847993518929877, 'recall': 0.8611163453739585, 'f1-score': 0.8211885345964158, 'support': 244118}, '2': {'precision': 0.545961859565867, 'recall': 0.5284086076380029, 'f1-score': 0.5370418395573998, 'support': 70542}, 'accuracy': 0.7178153885333105, 'macro avg': {'precision': 0.6403501332532912, 'recall': 0.5997219704688218, 'f1-score': 0.6139591387163287, 'support': 384819}, 'weighted avg': {'precision': 0.705555050153238, 'recall': 0.7178153885333105, 'f1-score': 0.7075614794332012, 'support': 384819}}
[[ 28740  31245  10174]
 [ 13079 210214  20825]
 [  6869  26398  37275]]
Evaluating performance on  val set...
510/510 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64897954
{'0': {'precision': 0.5890622109871139, 'recall': 0.4072984610137699, 'f1-score': 0.4816009678394999, 'support': 23457}, '1': {'precision': 0.7840706012134584, 'recall': 0.8555848470622224, 'f1-score': 0.8182681625346097, 'support': 83073}, '2': {'precision': 0.5342187632180019, 'recall': 0.5266669446645261, 'f1-score': 0.5304159754740356, 'support': 23981}, 'accuracy': 0.7145757828842013, 'macro avg': {'precision': 0.635783858472858, 'recall': 0.5965167509135062, 'f1-score': 0.610095035282715, 'support': 130511}, 'weighted avg': {'precision': 0.7031118411356994, 'recall': 0.7145757828842013, 'f1-score': 0.7048663367585233, 'support': 130511}}
[[ 9554 10568  3335]
 [ 4320 71076  7677]
 [ 2345  9006 12630]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
6203/6203 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6426099
{'0': {'precision': 0.5811065596767858, 'recall': 0.3906412674462467, 'f1-score': 0.46720804854390835, 'support': 265100}, '1': {'precision': 0.7875869071041157, 'recall': 0.8991763555321153, 'f1-score': 0.8396904775930207, 'support': 1054217}, '2': {'precision': 0.5421777950310559, 'recall': 0.41604575564963864, 'f1-score': 0.4708103245216871, 'support': 268557}, 'accuracy': 0.7325631630721329, 'macro avg': {'precision': 0.6369570872706524, 'recall': 0.5686211262093336, 'f1-score': 0.5925696168862054, 'support': 1587874}, 'weighted avg': {'precision': 0.7116084132097702, 'recall': 0.7325631630721329, 'f1-score': 0.7151148253628703, 'support': 1587874}}
[[103559 128713  32828]
 [ 44770 947927  61520]
 [ 29881 126944 111732]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6654186
{'0': {'precision': 0.5622429059471519, 'recall': 0.41457709460588377, 'f1-score': 0.477248685076824, 'support': 77807}, '1': {'precision': 0.7841453116031099, 'recall': 0.8817047332299301, 'f1-score': 0.8300682704604597, 'support': 295929}, '2': {'precision': 0.5271689940522368, 'recall': 0.4168040380806338, 'f1-score': 0.46553483625568237, 'support': 78255}, 'accuracy': 0.7208019628709421, 'macro avg': {'precision': 0.6245190705341662, 'recall': 0.5710286219721493, 'f1-score': 0.590950597264322, 'support': 451991}, 'weighted avg': {'precision': 0.7014550761629867, 'recall': 0.7208019628709421, 'f1-score': 0.7062197925623613, 'support': 451991}}
[[ 32257  35636   9914]
 [ 15666 260922  19341]
 [  9449  36189  32617]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61031425
{'0': {'precision': 0.5720953388512042, 'recall': 0.40095080251221216, 'f1-score': 0.4714721645254763, 'support': 22928}, '1': {'precision': 0.8146284829721362, 'recall': 0.8990138220220532, 'f1-score': 0.8547434477667036, 'support': 103024}, '2': {'precision': 0.5276123887037745, 'recall': 0.4366636528028933, 'f1-score': 0.47784896232715757, 'support': 22120}, 'accuracy': 0.7528229509968124, 'macro avg': {'precision': 0.6381120701757049, 'recall': 0.5788760924457196, 'f1-score': 0.6013548582064459, 'support': 148072}, 'weighted avg': {'precision': 0.7341973688275248, 'recall': 0.7528229509968124, 'f1-score': 0.7390932910856457, 'support': 148072}}
[[ 9193 11061  2674]
 [ 4430 92620  5974]
 [ 2446 10015  9659]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
5183/5183 - 84s - 84s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89805627
{'0': {'precision': 0.5422631262057186, 'recall': 0.464310796059813, 'f1-score': 0.5002685212344326, 'support': 380185}, '1': {'precision': 0.6340853305564629, 'recall': 0.6984243175515743, 'f1-score': 0.664701550029536, 'support': 561471}, '2': {'precision': 0.502227933532881, 'recall': 0.4992055744786907, 'f1-score': 0.5007121932165874, 'support': 385184}, 'accuracy': 0.5735092399987941, 'macro avg': {'precision': 0.5595254634316874, 'recall': 0.5539802293633593, 'f1-score': 0.5552274214935187, 'support': 1326840}, 'weighted avg': {'precision': 0.5694966956221685, 'recall': 0.5735092399987941, 'f1-score': 0.5699794678891836, 'support': 1326840}}
[[176524 111347  92314]
 [ 71060 392145  98266]
 [ 77948 114950 192286]]
Evaluating performance on  train set...
1489/1489 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8751053
{'0': {'precision': 0.5144416056813753, 'recall': 0.4667013680871333, 'f1-score': 0.4894100199286277, 'support': 101821}, '1': {'precision': 0.663917211030809, 'recall': 0.7095705300583953, 'f1-score': 0.6859851358737773, 'support': 177754}, '2': {'precision': 0.5032516866225004, 'recall': 0.48949670910022464, 'f1-score': 0.4962789071474951, 'support': 101492}, 'accuracy': 0.586062293507441, 'macro avg': {'precision': 0.5605368344448949, 'recall': 0.5552562024152511, 'f1-score': 0.5572246876499667, 'support': 381067}, 'weighted avg': {'precision': 0.5811862975286355, 'recall': 0.586062293507441, 'f1-score': 0.5829346501415074, 'support': 381067}}
[[ 47520  33054  21247]
 [ 23834 126129  27791]
 [ 21018  30794  49680]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8400814
{'0': {'precision': 0.5116658176260825, 'recall': 0.457641019410103, 'f1-score': 0.48314786903120294, 'support': 32921}, '1': {'precision': 0.6897250242947673, 'recall': 0.7500037208471625, 'f1-score': 0.718602495543672, 'support': 67189}, '2': {'precision': 0.509488858030814, 'recall': 0.472091170884137, 'f1-score': 0.49007759826994024, 'support': 32642}, 'accuracy': 0.6091659636013017, 'macro avg': {'precision': 0.5702932333172214, 'recall': 0.5599119703804675, 'f1-score': 0.563942654281605, 'support': 132752}, 'weighted avg': {'precision': 0.6012506052131134, 'recall': 0.6091659636013017, 'f1-score': 0.6040210846705691, 'support': 132752}}
[[15066 11819  6036]
 [ 7997 50392  8800]
 [ 6382 10850 15410]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
7324/7324 - 126s - 126s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9435828
{'0': {'precision': 0.5433540471547397, 'recall': 0.47360805056047994, 'f1-score': 0.5060893648155715, 'support': 605374}, '1': {'precision': 0.5625250056700755, 'recall': 0.648322003756456, 'f1-score': 0.6023838453577371, 'support': 680961}, '2': {'precision': 0.5265689226757639, 'recall': 0.5031621204988009, 'f1-score': 0.5145994917381373, 'support': 588371}, 'accuracy': 0.5463459337090723, 'macro avg': {'precision': 0.5441493251668597, 'recall': 0.5416973916052457, 'f1-score': 0.5410242339704819, 'support': 1874706}, 'weighted avg': {'precision': 0.5450496701520214, 'recall': 0.5463459337090723, 'f1-score': 0.5437378801838643, 'support': 1874706}}
[[286710 180560 138104]
 [111412 441482 128067]
 [129545 162780 296046]]
Evaluating performance on  train set...
2046/2046 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91733885
{'0': {'precision': 0.52332566882003, 'recall': 0.4666996491273752, 'f1-score': 0.4933932528594827, 'support': 153617}, '1': {'precision': 0.6151214091144571, 'recall': 0.6818426000537201, 'f1-score': 0.6467657976234926, 'support': 215934}, '2': {'precision': 0.5158852382276918, 'recall': 0.4931355827783218, 'f1-score': 0.5042539505706196, 'support': 154201}, 'accuracy': 0.5631825749591409, 'macro avg': {'precision': 0.551444105387393, 'recall': 0.5472259439864723, 'f1-score': 0.5481376670178649, 'support': 523752}, 'weighted avg': {'precision': 0.5589809017298187, 'recall': 0.5631825749591409, 'f1-score': 0.5598236961395595, 'support': 523752}}
[[ 71693  47574  34350]
 [ 31692 147233  37009]
 [ 33610  44549  76042]]
Evaluating performance on  val set...
741/741 - 31s - 31s/epoch - 42ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9097443
{'0': {'precision': 0.5361576436081218, 'recall': 0.47079841839881015, 'f1-score': 0.5013568717587182, 'support': 55134}, '1': {'precision': 0.624295256949027, 'recall': 0.6854448158834671, 'f1-score': 0.6534425514383346, 'support': 78673}, '2': {'precision': 0.5061681083251214, 'recall': 0.49723033899216607, 'f1-score': 0.5016594170788834, 'support': 55783}, 'accuracy': 0.5676459728888654, 'macro avg': {'precision': 0.55554033629409, 'recall': 0.5511578577581479, 'f1-score': 0.5521529467586453, 'support': 189590}, 'weighted avg': {'precision': 0.5639077581061303, 'recall': 0.5676459728888654, 'f1-score': 0.564555951683974, 'support': 189590}}
[[25957 16122 13055]
 [10741 53926 14006]
 [11715 16331 27737]]
testing model on single stock: results/universal/W6/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
29350/29350 - 418s - 418s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.077468
{'0': {'precision': 0.4317123666955462, 'recall': 0.5589860943462285, 'f1-score': 0.48717388636366205, 'support': 2322149}, '1': {'precision': 0.5734702293433327, 'recall': 0.2530466887900843, 'f1-score': 0.35114766430369926, 'support': 2896177}, '2': {'precision': 0.4033699568805583, 'recall': 0.5674591451793796, 'f1-score': 0.47154740301213804, 'support': 2295078}, 'accuracy': 0.4436444519687747, 'macro avg': {'precision': 0.46951751763981237, 'recall': 0.45983064277189745, 'f1-score': 0.4366229845598331, 'support': 7513404}, 'weighted avg': {'precision': 0.4776978907185211, 'recall': 0.4436444519687747, 'f1-score': 0.42996679169865987, 'support': 7513404}}
[[1298049  277621  746479]
 [ 983445  732868 1179864]
 [ 725251  267464 1302363]]
Evaluating performance on  train set...
5452/5452 - 101s - 101s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0751336
{'0': {'precision': 0.44616594357607536, 'recall': 0.6298787912688407, 'f1-score': 0.5223397432180612, 'support': 464818}, '1': {'precision': 0.612658375664156, 'recall': 0.22494335149086872, 'f1-score': 0.32906672437016166, 'support': 466473}, '2': {'precision': 0.44400997193632324, 'recall': 0.543308257070472, 'f1-score': 0.4886657146344913, 'support': 464184}, 'accuracy': 0.46572242426413946, 'macro avg': {'precision': 0.5009447637255182, 'recall': 0.4660434666100605, 'f1-score': 0.4466907274075714, 'support': 1395475}, 'weighted avg': {'precision': 0.5011031203322313, 'recall': 0.46572242426413946, 'f1-score': 0.44653215784027084, 'support': 1395475}}
[[292779  33307 138732]
 [184476 104930 177067]
 [178956  33033 252195]]
Evaluating performance on  val set...
1969/1969 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0961376
{'0': {'precision': 0.4260642950867473, 'recall': 0.6016753953649968, 'f1-score': 0.4988664066959355, 'support': 155426}, '1': {'precision': 0.6129059780444799, 'recall': 0.22149592743904006, 'f1-score': 0.3253975743529155, 'support': 194595}, '2': {'precision': 0.4134496455092392, 'recall': 0.5750509601277574, 'f1-score': 0.4810409103621302, 'support': 154042}, 'accuracy': 0.44676955063156787, 'macro avg': {'precision': 0.4841399728801554, 'recall': 0.4660740943105981, 'f1-score': 0.43510163047032707, 'support': 504063}, 'weighted avg': {'precision': 0.4943400293599264, 'recall': 0.44676955063156787, 'f1-score': 0.42645077107887575, 'support': 504063}}
[[93516 13465 48445]
 [74269 43102 77224]
 [51703 13757 88582]]
training model: results/universal/W6/deepVOL_L3/h30
Epoch 1/50
9426/9426 - 540s - loss: 3.0001 - accuracy30: 0.4783 - val_loss: 3.1003 - val_accuracy30: 0.4813 - 540s/epoch - 57ms/step
Epoch 2/50
9426/9426 - 543s - loss: 2.8963 - accuracy30: 0.5095 - val_loss: 3.0849 - val_accuracy30: 0.4919 - 543s/epoch - 58ms/step
Epoch 3/50
9426/9426 - 544s - loss: 2.8664 - accuracy30: 0.5176 - val_loss: 3.1155 - val_accuracy30: 0.4990 - 544s/epoch - 58ms/step
Epoch 4/50
9426/9426 - 528s - loss: 2.8438 - accuracy30: 0.5232 - val_loss: 3.0371 - val_accuracy30: 0.5032 - 528s/epoch - 56ms/step
Epoch 5/50
9426/9426 - 514s - loss: 2.8297 - accuracy30: 0.5266 - val_loss: 3.0744 - val_accuracy30: 0.5068 - 514s/epoch - 55ms/step
Epoch 6/50
9426/9426 - 521s - loss: 2.8198 - accuracy30: 0.5286 - val_loss: 3.0209 - val_accuracy30: 0.5086 - 521s/epoch - 55ms/step
Epoch 7/50
9426/9426 - 537s - loss: 2.8124 - accuracy30: 0.5303 - val_loss: 3.0149 - val_accuracy30: 0.5084 - 537s/epoch - 57ms/step
Epoch 8/50
9426/9426 - 517s - loss: 2.8069 - accuracy30: 0.5315 - val_loss: 3.0338 - val_accuracy30: 0.5088 - 517s/epoch - 55ms/step
Epoch 9/50
9426/9426 - 532s - loss: 2.8025 - accuracy30: 0.5325 - val_loss: 3.0016 - val_accuracy30: 0.5076 - 532s/epoch - 56ms/step
Epoch 10/50
9426/9426 - 533s - loss: 2.7988 - accuracy30: 0.5334 - val_loss: 2.9903 - val_accuracy30: 0.5079 - 533s/epoch - 57ms/step
Epoch 11/50
9426/9426 - 513s - loss: 2.7953 - accuracy30: 0.5345 - val_loss: 2.9859 - val_accuracy30: 0.5087 - 513s/epoch - 54ms/step
Epoch 12/50
9426/9426 - 527s - loss: 2.7925 - accuracy30: 0.5350 - val_loss: 3.0012 - val_accuracy30: 0.5075 - 527s/epoch - 56ms/step
Epoch 13/50
9426/9426 - 528s - loss: 2.7893 - accuracy30: 0.5359 - val_loss: 2.9915 - val_accuracy30: 0.5077 - 528s/epoch - 56ms/step
Epoch 14/50
9426/9426 - 521s - loss: 2.7868 - accuracy30: 0.5366 - val_loss: 2.9921 - val_accuracy30: 0.5069 - 521s/epoch - 55ms/step
Epoch 15/50
9426/9426 - 518s - loss: 2.7844 - accuracy30: 0.5370 - val_loss: 2.9831 - val_accuracy30: 0.5059 - 518s/epoch - 55ms/step
Epoch 16/50
9426/9426 - 524s - loss: 2.7823 - accuracy30: 0.5377 - val_loss: 2.9849 - val_accuracy30: 0.5060 - 524s/epoch - 56ms/step
Epoch 17/50
9426/9426 - 511s - loss: 2.7802 - accuracy30: 0.5379 - val_loss: 2.9769 - val_accuracy30: 0.5057 - 511s/epoch - 54ms/step
Epoch 18/50
9426/9426 - 532s - loss: 2.7783 - accuracy30: 0.5386 - val_loss: 2.9929 - val_accuracy30: 0.5052 - 532s/epoch - 56ms/step
Epoch 19/50
9426/9426 - 526s - loss: 2.7762 - accuracy30: 0.5390 - val_loss: 2.9985 - val_accuracy30: 0.5051 - 526s/epoch - 56ms/step
Epoch 20/50
9426/9426 - 537s - loss: 2.7746 - accuracy30: 0.5396 - val_loss: 2.9882 - val_accuracy30: 0.5057 - 537s/epoch - 57ms/step
Epoch 21/50
9426/9426 - 532s - loss: 2.7730 - accuracy30: 0.5399 - val_loss: 2.9882 - val_accuracy30: 0.5060 - 532s/epoch - 56ms/step
Epoch 22/50
9426/9426 - 533s - loss: 2.7719 - accuracy30: 0.5400 - val_loss: 2.9893 - val_accuracy30: 0.5046 - 533s/epoch - 57ms/step
Epoch 23/50
9426/9426 - 520s - loss: 2.7697 - accuracy30: 0.5406 - val_loss: 2.9907 - val_accuracy30: 0.5044 - 520s/epoch - 55ms/step
Epoch 24/50
9426/9426 - 531s - loss: 2.7688 - accuracy30: 0.5410 - val_loss: 3.0051 - val_accuracy30: 0.5031 - 531s/epoch - 56ms/step
Epoch 25/50
9426/9426 - 531s - loss: 2.7671 - accuracy30: 0.5411 - val_loss: 2.9885 - val_accuracy30: 0.5041 - 531s/epoch - 56ms/step
Epoch 26/50
9426/9426 - 518s - loss: 2.7659 - accuracy30: 0.5416 - val_loss: 3.0066 - val_accuracy30: 0.5028 - 518s/epoch - 55ms/step
Epoch 27/50
9426/9426 - 521s - loss: 2.7647 - accuracy30: 0.5418 - val_loss: 3.0119 - val_accuracy30: 0.5024 - 521s/epoch - 55ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1251s - 1251s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664335
{'0': {'precision': 0.4074330626497114, 'recall': 0.5550286261337923, 'f1-score': 0.46991379633983527, 'support': 3134723}, '1': {'precision': 0.6152229382798504, 'recall': 0.364834298215728, 'f1-score': 0.4580435112874349, 'support': 4569987}, '2': {'precision': 0.4072506529625939, 'recall': 0.5019847979346926, 'f1-score': 0.4496825031062137, 'support': 3113919}, 'accuracy': 0.45941948836585483, 'macro avg': {'precision': 0.4766355512973852, 'recall': 0.4739492407614043, 'f1-score': 0.45921327024449465, 'support': 10818629}, 'weighted avg': {'precision': 0.49515480829519504, 'recall': 0.45941948836585483, 'f1-score': 0.4590764104963509, 'support': 10818629}}
[[1739861  539887  854975]
 [1482539 1667288 1420160]
 [1047899  502880 1563140]]
Evaluating performance on  train set...
9426/9426 - 291s - 291s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0034465
{'0': {'precision': 0.4392507336794379, 'recall': 0.5952166176676852, 'f1-score': 0.5054762446939574, 'support': 727226}, '1': {'precision': 0.6702367488896093, 'recall': 0.4676404550600096, 'f1-score': 0.5509027110495761, 'support': 959346}, '2': {'precision': 0.4655952764471954, 'recall': 0.4859797113392969, 'f1-score': 0.4755691584014543, 'support': 725627}, 'accuracy': 0.5116186516949887, 'macro avg': {'precision': 0.5250275863387475, 'recall': 0.5162789280223306, 'f1-score': 0.5106493713816626, 'support': 2412199}, 'weighted avg': {'precision': 0.5390401048228455, 'recall': 0.5116186516949887, 'f1-score': 0.5145461056329708, 'support': 2412199}}
[[432857 115935 178434]
 [284395 448629 226322]
 [268192 104795 352640]]
Evaluating performance on  val set...
3323/3323 - 104s - 104s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0147846
{'0': {'precision': 0.4306423050230933, 'recall': 0.5867426372891856, 'f1-score': 0.49671700704213206, 'support': 245358}, '1': {'precision': 0.6734190808581261, 'recall': 0.45769389205134514, 'f1-score': 0.5449849970454961, 'support': 361709}, '2': {'precision': 0.4466533662512446, 'recall': 0.49611074109705056, 'f1-score': 0.47008478752476135, 'support': 243234}, 'accuracy': 0.5059208445009473, 'macro avg': {'precision': 0.516904917377488, 'recall': 0.5135157568125271, 'f1-score': 0.5039289305374631, 'support': 850301}, 'weighted avg': {'precision': 0.538497028558973, 'recall': 0.5059208445009473, 'f1-score': 0.5096313810273898, 'support': 850301}}
[[143962  41593  59803]
 [106464 165552  89693]
 [ 83870  38693 120671]]
testing model out of sample: results/universal/W6/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 512s - 512s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9200355
{'0': {'precision': 0.5059638473933534, 'recall': 0.4938507748614946, 'f1-score': 0.4998339342619051, 'support': 1353016}, '1': {'precision': 0.6256224463902476, 'recall': 0.6812528806611985, 'f1-score': 0.6522536388704573, 'support': 1787784}, '2': {'precision': 0.5127976251575632, 'recall': 0.46451463651761493, 'f1-score': 0.48746344806698233, 'support': 1344343}, 'accuracy': 0.5597565116652914, 'macro avg': {'precision': 0.5481279729803881, 'recall': 0.5465394306801027, 'f1-score': 0.5465170070664482, 'support': 4485143}, 'weighted avg': {'precision': 0.5557082301365422, 'recall': 0.5597565116652914, 'f1-score': 0.5568807960143966, 'support': 4485143}}
[[ 668188  375916  308912]
 [ 285465 1217933  284386]
 [ 366971  352905  624467]]
Evaluating performance on  train set...
5153/5153 - 158s - 158s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94119984
{'0': {'precision': 0.4839526730498197, 'recall': 0.5076657582103059, 'f1-score': 0.49552568398618546, 'support': 380132}, '1': {'precision': 0.6425880390549732, 'recall': 0.6387749814621246, 'f1-score': 0.6406758368436096, 'support': 559665}, '2': {'precision': 0.48751764035949197, 'recall': 0.4678209588773501, 'f1-score': 0.47746625157780026, 'support': 378818}, 'accuracy': 0.5518661626024276, 'macro avg': {'precision': 0.5380194508214283, 'recall': 0.5380872328499269, 'f1-score': 0.5378892574691985, 'support': 1318615}, 'weighted avg': {'precision': 0.5523070720985107, 'recall': 0.5518661626024276, 'f1-score': 0.5519441398909573, 'support': 1318615}}
[[192980 100387  86765]
 [102636 357500  99529]
 [103142  98457 177219]]
Evaluating performance on  val set...
1795/1795 - 50s - 50s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9237492
{'0': {'precision': 0.4845293338958149, 'recall': 0.512363767814978, 'f1-score': 0.4980579657050575, 'support': 130017}, '1': {'precision': 0.6619380315917376, 'recall': 0.6560919309514252, 'f1-score': 0.6590020161290323, 'support': 199280}, '2': {'precision': 0.4890544532877, 'recall': 0.4675103206142212, 'f1-score': 0.47803977418425836, 'support': 129595}, 'accuracy': 0.562112653957794, 'macro avg': {'precision': 0.5451739395917509, 'recall': 0.5453220064602081, 'f1-score': 0.5450332520061161, 'support': 458892}, 'weighted avg': {'precision': 0.5628493702539009, 'recall': 0.562112653957794, 'f1-score': 0.562296768818539, 'support': 458892}}
[[ 66616  33988  29413]
 [ 34648 130746  33886]
 [ 36222  32786  60587]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.132444
{'0': {'precision': 0.4122326585835458, 'recall': 0.6709473193868044, 'f1-score': 0.5106933341928829, 'support': 94456}, '1': {'precision': 0.4760536398467433, 'recall': 0.05231441277861109, 'f1-score': 0.09426938852929323, 'support': 76002}, '2': {'precision': 0.4511144348911258, 'recall': 0.48864415708336234, 'f1-score': 0.4691299120178636, 'support': 100609}, 'accuracy': 0.42983100119158735, 'macro avg': {'precision': 0.44646691110713826, 'recall': 0.4039686297495926, 'f1-score': 0.3580308782466799, 'support': 271067}, 'weighted avg': {'precision': 0.4445581679612821, 'recall': 0.42983100119158735, 'f1-score': 0.3785093831404469, 'support': 271067}}
[[63375  1876 29205]
 [41414  3976 30612]
 [48947  2500 49162]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1398553
{'0': {'precision': 0.4201987215119511, 'recall': 0.6517404892768617, 'f1-score': 0.5109627814625491, 'support': 18558}, '1': {'precision': 0.5678371907422187, 'recall': 0.07984513522612502, 'f1-score': 0.14000393545848092, 'support': 17822}, '2': {'precision': 0.40526710485685297, 'recall': 0.522612207747881, 'f1-score': 0.45651957861260184, 'support': 17579}, 'accuracy': 0.42078244593117, 'macro avg': {'precision': 0.4644343390370076, 'recall': 0.4180659440836226, 'f1-score': 0.3691620985112107, 'support': 53959}, 'weighted avg': {'precision': 0.46409742069914617, 'recall': 0.42078244593117, 'f1-score': 0.37070285047080115, 'support': 53959}}
[[12095   500  5963]
 [ 8880  1423  7519]
 [ 7809   583  9187]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1256001
{'0': {'precision': 0.4161355103466341, 'recall': 0.6655495042591817, 'f1-score': 0.5120876759428387, 'support': 7161}, '1': {'precision': 0.6082191780821918, 'recall': 0.10216290842153705, 'f1-score': 0.17494089834515367, 'support': 6519}, '2': {'precision': 0.42613425639757696, 'recall': 0.49547218628719275, 'f1-score': 0.4581948690681909, 'support': 6957}, 'accuracy': 0.43024664437660515, 'macro avg': {'precision': 0.4834963149421343, 'recall': 0.4210615329893039, 'f1-score': 0.3817411477853944, 'support': 20637}, 'weighted avg': {'precision': 0.48018332283122545, 'recall': 0.43024664437660515, 'f1-score': 0.38741877539594555, 'support': 20637}}
[[4766  193 2202]
 [3413  666 2440]
 [3274  236 3447]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7055602
{'0': {'precision': 0.5615929318521405, 'recall': 0.40202954088845894, 'f1-score': 0.4686004217327905, 'support': 107512}, '1': {'precision': 0.7486877210398958, 'recall': 0.8790720444803198, 'f1-score': 0.8086579599189372, 'support': 343163}, '2': {'precision': 0.5930882260200543, 'recall': 0.43339170506912444, 'f1-score': 0.5008174241819102, 'support': 108500}, 'accuracy': 0.7008736084410069, 'macro avg': {'precision': 0.6344562929706968, 'recall': 0.5714977634793011, 'f1-score': 0.5926919352778793, 'support': 559175}, 'weighted avg': {'precision': 0.6825233177943882, 'recall': 0.7008736084410069, 'f1-score': 0.683543346116574, 'support': 559175}}
[[ 43223  51690  12599]
 [ 21835 301665  19663]
 [ 11907  49570  47023]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.62724054
{'0': {'precision': 0.5579522745973904, 'recall': 0.4361589708247186, 'f1-score': 0.48959488382887645, 'support': 21765}, '1': {'precision': 0.8126570010087624, 'recall': 0.8854347381011389, 'f1-score': 0.8474862956832047, 'support': 92803}, '2': {'precision': 0.5555494323817921, 'recall': 0.4644337971067907, 'f1-score': 0.5059219110709625, 'support': 21706}, 'accuracy': 0.7466207787252154, 'macro avg': {'precision': 0.6420529026626483, 'recall': 0.5953425020108828, 'f1-score': 0.6143343635276812, 'support': 136274}, 'weighted avg': {'precision': 0.7310242225259959, 'recall': 0.7466207787252154, 'f1-score': 0.7359206036847106, 'support': 136274}}
[[ 9493  9907  2365]
 [ 4932 82171  5700]
 [ 2589  9036 10081]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6349459
{'0': {'precision': 0.5851979345955249, 'recall': 0.3991651447951996, 'f1-score': 0.47460255913144633, 'support': 7666}, '1': {'precision': 0.806008722338879, 'recall': 0.9001803968731209, 'f1-score': 0.8504956963895122, 'support': 33260}, '2': {'precision': 0.5383559292946628, 'recall': 0.4311434854315558, 'f1-score': 0.47882164389834386, 'support': 7276}, 'accuracy': 0.7496991826065309, 'macro avg': {'precision': 0.6431875287430223, 'recall': 0.5768296756999588, 'f1-score': 0.6013066331397675, 'support': 48202}, 'weighted avg': {'precision': 0.7304895069322511, 'recall': 0.7496991826065309, 'f1-score': 0.734610521580457, 'support': 48202}}
[[ 3060  3769   837]
 [ 1467 29940  1853]
 [  702  3437  3137]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0624459
{'0': {'precision': 0.48268681632473753, 'recall': 0.4746710213674106, 'f1-score': 0.47864536139959574, 'support': 115737}, '1': {'precision': 0.4494314582013405, 'recall': 0.33318089116865457, 'f1-score': 0.3826721463909769, 'support': 80905}, '2': {'precision': 0.460512475895518, 'recall': 0.5527684012099425, 'f1-score': 0.50244063771373, 'support': 114055}, 'accuracy': 0.4664962970353753, 'macro avg': {'precision': 0.464210250140532, 'recall': 0.4535401045820026, 'f1-score': 0.4545860485014342, 'support': 310697}, 'weighted avg': {'precision': 0.46588710745523426, 'recall': 0.4664962970353753, 'f1-score': 0.4623891931061661, 'support': 310697}}
[[54937 17292 43508]
 [23599 26956 30350]
 [35279 15730 63046]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1232773
{'0': {'precision': 0.42793633556181493, 'recall': 0.5694544797687862, 'f1-score': 0.4886555191722695, 'support': 44288}, '1': {'precision': 0.5107169649555245, 'recall': 0.22025281353268783, 'f1-score': 0.3077742794865585, 'support': 43273}, '2': {'precision': 0.432838617794768, 'recall': 0.5322242447982672, 'f1-score': 0.47741388753965874, 'support': 43399}, 'accuracy': 0.4417302993280391, 'macro avg': {'precision': 0.4571639727707025, 'recall': 0.4406438460332471, 'f1-score': 0.42461456206616227, 'support': 130960}, 'weighted avg': {'precision': 0.4569140411389524, 'recall': 0.4417302993280391, 'f1-score': 0.4251617084197997, 'support': 130960}}
[[25220  4635 14433]
 [17909  9531 15833]
 [15805  4496 23098]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1057034
{'0': {'precision': 0.42661193432118544, 'recall': 0.5838985954093868, 'f1-score': 0.49301437621127536, 'support': 14595}, '1': {'precision': 0.5162656726533379, 'recall': 0.22420897718910965, 'f1-score': 0.3126410835214447, 'support': 13590}, '2': {'precision': 0.45034454803404944, 'recall': 0.5197834514102393, 'f1-score': 0.48257888368341034, 'support': 14962}, 'accuracy': 0.4483741627459615, 'macro avg': {'precision': 0.4644073850028576, 'recall': 0.4426303413362453, 'f1-score': 0.4294114478053768, 'support': 43147}, 'weighted avg': {'precision': 0.4630798618782769, 'recall': 0.4483741627459615, 'f1-score': 0.4325835493436666, 'support': 43147}}
[[8522 1460 4613]
 [5664 3047 4879]
 [5790 1395 7777]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2208476
{'0': {'precision': 0.3621904295227614, 'recall': 0.8933712440186647, 'f1-score': 0.5154195471445759, 'support': 100939}, '1': {'precision': 0.27152169026747586, 'recall': 0.016121498445236283, 'f1-score': 0.03043587805492567, 'support': 74931}, '2': {'precision': 0.4408235205880147, 'recall': 0.11279133363398229, 'f1-score': 0.1796233334606716, 'support': 104219}, 'accuracy': 0.36823652481889685, 'macro avg': {'precision': 0.3581785467927507, 'recall': 0.3407613586992944, 'f1-score': 0.2418262528867244, 'support': 280089}, 'weighted avg': {'precision': 0.3671929923388372, 'recall': 0.36823652481889685, 'f1-score': 0.2607267284245283, 'support': 280089}}
[[90176  1603  9160]
 [67972  1208  5751]
 [90826  1638 11755]]
Evaluating performance on  train set...
448/448 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2767777
{'0': {'precision': 0.3393056567127944, 'recall': 0.9042677087916354, 'f1-score': 0.4934540370302371, 'support': 38639}, '1': {'precision': 0.2914210870988867, 'recall': 0.011763772866659618, 'f1-score': 0.02261466141532207, 'support': 37828}, '2': {'precision': 0.3967402106936991, 'recall': 0.104785153686642, 'f1-score': 0.16578417325941153, 'support': 38097}, 'accuracy': 0.343711811738417, 'macro avg': {'precision': 0.3424889848351267, 'recall': 0.3402722117816457, 'f1-score': 0.22728429056832355, 'support': 114564}, 'weighted avg': {'precision': 0.34259383365891727, 'recall': 0.343711811738417, 'f1-score': 0.22902410528171097, 'support': 114564}}
[[34940   533  3166]
 [34479   445  2904]
 [33556   549  3992]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2527789
{'0': {'precision': 0.3470618424429048, 'recall': 0.900241284632665, 'f1-score': 0.5009839101747887, 'support': 12019}, '1': {'precision': 0.31393298059964725, 'recall': 0.016745061147695202, 'f1-score': 0.03179423059748147, 'support': 10630}, '2': {'precision': 0.39900990099009903, 'recall': 0.09971956450016496, 'f1-score': 0.15956183185957504, 'support': 12124}, 'accuracy': 0.35104822707272887, 'macro avg': {'precision': 0.35333490801088363, 'recall': 0.33890197009350836, 'f1-score': 0.23077999087728174, 'support': 34773}, 'weighted avg': {'precision': 0.35504672900524786, 'recall': 0.35104822707272887, 'f1-score': 0.23851338501445093, 'support': 34773}}
[[10820   194  1005]
 [ 9636   178   816]
 [10720   195  1209]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.144815
{'0': {'precision': 0.42896133695525834, 'recall': 0.630432444402265, 'f1-score': 0.5105394216383496, 'support': 158055}, '1': {'precision': 0.4558122343374607, 'recall': 0.10106457085255817, 'f1-score': 0.1654458128739703, 'support': 122021}, '2': {'precision': 0.4487118018241437, 'recall': 0.5065920870068379, 'f1-score': 0.4758985089631712, 'support': 160723}, 'accuracy': 0.43873965231318585, 'macro avg': {'precision': 0.4444951243722876, 'recall': 0.41269636742055366, 'f1-score': 0.3839612478251637, 'support': 440799}, 'weighted avg': {'precision': 0.4435955065304969, 'recall': 0.43873965231318585, 'f1-score': 0.40238069477433447, 'support': 440799}}
[[99643  7487 50925]
 [60580 12332 49109]
 [72066  7236 81421]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2196367
{'0': {'precision': 0.40457515517002607, 'recall': 0.6109315589353612, 'f1-score': 0.486786993766521, 'support': 52600}, '1': {'precision': 0.4960547080483956, 'recall': 0.05404940677480369, 'f1-score': 0.09747777548066983, 'support': 52341}, '2': {'precision': 0.4057071449169882, 'recall': 0.5573077793707085, 'f1-score': 0.46957475384040753, 'support': 53012}, 'accuracy': 0.4083999670788146, 'macro avg': {'precision': 0.4354456693784699, 'recall': 0.4074295816936244, 'f1-score': 0.35127984102919946, 'support': 157953}, 'weighted avg': {'precision': 0.4352687179239636, 'recall': 0.4083999670788146, 'f1-score': 0.352004564453606, 'support': 157953}}
[[32135  1419 19046]
 [25281  2829 24231]
 [22013  1455 29544]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2063694
{'0': {'precision': 0.40761273747549187, 'recall': 0.6304506953884764, 'f1-score': 0.495113739016178, 'support': 19126}, '1': {'precision': 0.5026957637997432, 'recall': 0.1006011406258028, 'f1-score': 0.16765134001198734, 'support': 19463}, '2': {'precision': 0.4113646793775293, 'recall': 0.5228827491117357, 'f1-score': 0.46046794003642644, 'support': 18857}, 'accuracy': 0.41562510879782755, 'macro avg': {'precision': 0.4405577268842548, 'recall': 0.41797819504200495, 'f1-score': 0.37441100635486396, 'support': 57446}, 'weighted avg': {'precision': 0.44105895322237804, 'recall': 0.41562510879782755, 'f1-score': 0.37279510058739723, 'support': 57446}}
[[12058   941  6127]
 [ 9523  1958  7982]
 [ 8001   996  9860]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
4450/4450 - 66s - 66s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77290297
{'0': {'precision': 0.5914357180488777, 'recall': 0.43598849577338633, 'f1-score': 0.5019526804794391, 'support': 285808}, '1': {'precision': 0.6867916782951402, 'recall': 0.8152477607754466, 'f1-score': 0.7455268660532312, 'support': 570510}, '2': {'precision': 0.5753398483370817, 'recall': 0.5110766151702776, 'f1-score': 0.541307596373156, 'support': 282803}, 'accuracy': 0.6445759493504202, 'macro avg': {'precision': 0.6178557482270332, 'recall': 0.5874376239063701, 'f1-score': 0.5962623809686087, 'support': 1139121}, 'weighted avg': {'precision': 0.6351971522055566, 'recall': 0.6445759493504202, 'f1-score': 0.6337132194311351, 'support': 1139121}}
[[124609 114326  46873]
 [ 45595 465107  59808]
 [ 40485  97784 144534]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73158747
{'0': {'precision': 0.5882219745001045, 'recall': 0.4079115835245803, 'f1-score': 0.4817477639406, 'support': 82790}, '1': {'precision': 0.7228189456680288, 'recall': 0.8213661124835047, 'f1-score': 0.7689479758902235, 'support': 219001}, '2': {'precision': 0.5533559097621836, 'recall': 0.5234980970275088, 'f1-score': 0.5380130712482053, 'support': 83028}, 'accuracy': 0.6681478825109987, 'macro avg': {'precision': 0.6214656099767724, 'recall': 0.5842585976785313, 'f1-score': 0.5962362703596762, 'support': 384819}, 'weighted avg': {'precision': 0.6572986356308868, 'recall': 0.6681478825109987, 'f1-score': 0.6573335056849404, 'support': 384819}}
[[ 33771  38035  10984]
 [ 15022 179880  24099]
 [  8619  30944  43465]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7361396
{'0': {'precision': 0.5962189161609109, 'recall': 0.40119262739428985, 'f1-score': 0.4796387910734732, 'support': 27670}, '1': {'precision': 0.7206788850256349, 'recall': 0.8217333458762818, 'f1-score': 0.7678957150750992, 'support': 74411}, '2': {'precision': 0.5449402891263356, 'recall': 0.5184312346113261, 'f1-score': 0.5313553364457343, 'support': 28430}, 'accuracy': 0.6665032066262614, 'macro avg': {'precision': 0.6206126967709605, 'recall': 0.5804524026272992, 'f1-score': 0.5929632808647689, 'support': 130511}, 'weighted avg': {'precision': 0.656009580370058, 'recall': 0.6665032066262614, 'f1-score': 0.6552545426715635, 'support': 130511}}
[[11101 12976  3593]
 [ 4550 61146  8715]
 [ 2968 10723 14739]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
6203/6203 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73128396
{'0': {'precision': 0.5666390766970156, 'recall': 0.391017927564553, 'f1-score': 0.46272524810279914, 'support': 311643}, '1': {'precision': 0.7304141683960711, 'recall': 0.8736117392310145, 'f1-score': 0.7956210544696715, 'support': 959654}, '2': {'precision': 0.5483677441717846, 'recall': 0.3897851075725653, 'f1-score': 0.4556732514406309, 'support': 316577}, 'accuracy': 0.6824345004704403, 'macro avg': {'precision': 0.615140329754957, 'recall': 0.5514715914560443, 'f1-score': 0.5713398513377005, 'support': 1587874}, 'weighted avg': {'precision': 0.661976073343176, 'recall': 0.6824345004704403, 'f1-score': 0.6625095459852982, 'support': 1587874}}
[[121858 154799  34986]
 [ 54646 838365  66643]
 [ 38550 154630 123397]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7514744
{'0': {'precision': 0.5442195465292679, 'recall': 0.4329202000434877, 'f1-score': 0.48223119728245395, 'support': 91980}, '1': {'precision': 0.728416972859925, 'recall': 0.8501655289274397, 'f1-score': 0.7845963075227335, 'support': 267929}, '2': {'precision': 0.5405605723707099, 'recall': 0.38809973719076474, 'f1-score': 0.451815187776956, 'support': 92082}, 'accuracy': 0.6711217701237414, 'macro avg': {'precision': 0.6043990305866342, 'recall': 0.5570618220538974, 'f1-score': 0.5728808975273811, 'support': 451991}, 'weighted avg': {'precision': 0.6526617645842254, 'recall': 0.6711217701237414, 'f1-score': 0.655269188380247, 'support': 451991}}
[[ 39820  41723  10437]
 [ 20208 227784  19937]
 [ 13141  43204  35737]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6987781
{'0': {'precision': 0.557320372782844, 'recall': 0.40950592739857156, 'f1-score': 0.4721137521222411, 'support': 27162}, '1': {'precision': 0.7624439835561646, 'recall': 0.8705953249389451, 'f1-score': 0.8129383832450603, 'support': 94587}, '2': {'precision': 0.5316260566882148, 'recall': 0.4061467157998708, 'f1-score': 0.4604914608145069, 'support': 26323}, 'accuracy': 0.703448322437733, 'macro avg': {'precision': 0.6171301376757411, 'recall': 0.5620826560457958, 'f1-score': 0.5818478653939362, 'support': 148072}, 'weighted avg': {'precision': 0.6837836844802423, 'recall': 0.703448322437733, 'f1-score': 0.6877632051580658, 'support': 148072}}
[[11123 13312  2727]
 [ 5548 82347  6692]
 [ 3287 12345 10691]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
5183/5183 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.938149
{'0': {'precision': 0.5419641891160879, 'recall': 0.4693117541661299, 'f1-score': 0.503028211001977, 'support': 426955}, '1': {'precision': 0.5523217845900812, 'recall': 0.6839850920620794, 'f1-score': 0.61114254691156, 'support': 467402}, '2': {'precision': 0.5274836240212742, 'recall': 0.4613961704853139, 'f1-score': 0.4922315643805171, 'support': 432483}, 'accuracy': 0.5423540140484158, 'macro avg': {'precision': 0.5405898659091478, 'recall': 0.5382310055711744, 'f1-score': 0.5354674407646847, 'support': 1326840}, 'weighted avg': {'precision': 0.5408928938625797, 'recall': 0.5423540140484158, 'f1-score': 0.537594165233099, 'support': 1326840}}
[[200375 127974  98606]
 [ 67560 319696  80146]
 [101785 131152 199546]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.922259
{'0': {'precision': 0.5284943483911623, 'recall': 0.4617727268816834, 'f1-score': 0.49288577292323793, 'support': 116239}, '1': {'precision': 0.5816486773422985, 'recall': 0.7059115647628059, 'f1-score': 0.6377837937798042, 'support': 149013}, '2': {'precision': 0.5316507019411079, 'recall': 0.45287743383844925, 'f1-score': 0.4891126964144169, 'support': 115815}, 'accuracy': 0.5545376534835081, 'macro avg': {'precision': 0.5472645758915229, 'recall': 0.5401872418276462, 'f1-score': 0.539927421039153, 'support': 381067}, 'weighted avg': {'precision': 0.5502391835681327, 'recall': 0.5545376534835081, 'f1-score': 0.5484001835807611, 'support': 381067}}
[[ 53676  39339  23224]
 [ 20842 105190  22981]
 [ 27046  36319  52450]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8981874
{'0': {'precision': 0.5236537646132413, 'recall': 0.4554794520547945, 'f1-score': 0.48719321479895183, 'support': 37960}, '1': {'precision': 0.6099595918486003, 'recall': 0.7354234941553776, 'f1-score': 0.6668414654494316, 'support': 57061}, '2': {'precision': 0.5356542539436255, 'recall': 0.43918793564973096, 'f1-score': 0.4826481424847452, 'support': 37731}, 'accuracy': 0.5711778353621791, 'macro avg': {'precision': 0.5564225368018224, 'recall': 0.5433636272866343, 'f1-score': 0.5455609409110429, 'support': 132752}, 'weighted avg': {'precision': 0.5641615330144824, 'recall': 0.5711778353621791, 'f1-score': 0.5631198954280926, 'support': 132752}}
[[17290 14010  6660]
 [ 7392 41964  7705]
 [ 8336 12824 16571]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
7324/7324 - 106s - 106s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9727359
{'0': {'precision': 0.5414218416124216, 'recall': 0.48746666666666666, 'f1-score': 0.5130295425940259, 'support': 673125}, '1': {'precision': 0.47785602759596574, 'recall': 0.6124322198389663, 'f1-score': 0.5368386358975096, 'support': 549202}, '2': {'precision': 0.5439065847483135, 'recall': 0.47088119022837954, 'f1-score': 0.5047663882336799, 'support': 652379}, 'accuracy': 0.5183042034324316, 'macro avg': {'precision': 0.5210614846522336, 'recall': 0.5235933589113375, 'f1-score': 0.5182115222417384, 'support': 1874706}, 'weighted avg': {'precision': 0.5236646690492488, 'recall': 0.5183042034324316, 'f1-score': 0.5171290084740154, 'support': 1874706}}
[[328126 194630 150369]
 [105625 336349 107228]
 [172294 172892 307193]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9551448
{'0': {'precision': 0.5275408368480446, 'recall': 0.48451125033293574, 'f1-score': 0.5051112955557232, 'support': 172706}, '1': {'precision': 0.5351846386542222, 'recall': 0.6509141895681436, 'f1-score': 0.5874034558503478, 'support': 178300}, '2': {'precision': 0.536812857017609, 'recall': 0.4607747791555231, 'f1-score': 0.49589593269018106, 'support': 172746}, 'accuracy': 0.5333306603125143, 'macro avg': {'precision': 0.5331794441732919, 'recall': 0.5320667396855341, 'f1-score': 0.5294702280320841, 'support': 523752}, 'weighted avg': {'precision': 0.5332011383996436, 'recall': 0.5333306603125143, 'f1-score': 0.5300864271198235, 'support': 523752}}
[[ 83678  52218  36810]
 [ 30372 116058  31870]
 [ 44569  48580  79597]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9504115
{'0': {'precision': 0.532894272194364, 'recall': 0.4870024042728285, 'f1-score': 0.5089158495561045, 'support': 61973}, '1': {'precision': 0.5435732060332131, 'recall': 0.6574530489396662, 'f1-score': 0.5951141536643847, 'support': 65121}, '2': {'precision': 0.5288798671341576, 'recall': 0.458589349718382, 'f1-score': 0.49123288140822374, 'support': 62496}, 'accuracy': 0.5361833430033229, 'macro avg': {'precision': 0.535115781787245, 'recall': 0.5343482676436255, 'f1-score': 0.5317542948762376, 'support': 189590}, 'weighted avg': {'precision': 0.5352390086882562, 'recall': 0.5361833430033229, 'f1-score': 0.5326945561570083, 'support': 189590}}
[[30181 18099 13693]
 [10470 42814 11837]
 [15985 17851 28660]]
testing model on single stock: results/universal/W6/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
29350/29350 - 410s - 410s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1546894
{'0': {'precision': 0.3809294337739121, 'recall': 0.5788921572037882, 'f1-score': 0.4594959391050432, 'support': 2213509}, '1': {'precision': 0.5540280847470902, 'recall': 0.18627377623691346, 'f1-score': 0.27880762949851656, 'support': 3113981}, '2': {'precision': 0.3740479346818166, 'recall': 0.530908352295653, 'f1-score': 0.43888345887906827, 'support': 2185914}, 'accuracy': 0.40220863938635537, 'macro avg': {'precision': 0.4363351510676063, 'recall': 0.4320247619121182, 'f1-score': 0.39239567582754264, 'support': 7513404}, 'weighted avg': {'precision': 0.4506692674165206, 'recall': 0.40220863938635537, 'f1-score': 0.3786115527287053, 'support': 7513404}}
[[1281383  244360  687766]
 [1279617  580053 1254311]
 [ 802833  222561 1160520]]
Evaluating performance on  train set...
5452/5452 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1146768
{'0': {'precision': 0.42595916980490983, 'recall': 0.6431733694176698, 'f1-score': 0.5125007132922761, 'support': 467793}, '1': {'precision': 0.5912133373149112, 'recall': 0.17619453832312063, 'f1-score': 0.27148160535117055, 'support': 460701}, '2': {'precision': 0.4397900825607608, 'recall': 0.5197042277951351, 'f1-score': 0.4764192195458065, 'support': 466981}, 'accuracy': 0.4476877049033483, 'macro avg': {'precision': 0.48565419656019393, 'recall': 0.44635737851197516, 'f1-score': 0.4201338460630844, 'support': 1395475}, 'weighted avg': {'precision': 0.4851444176206466, 'recall': 0.4476877049033483, 'f1-score': 0.42085656626076684, 'support': 1395475}}
[[300872  28161 138760]
 [209144  81173 170384]
 [196324  27965 242692]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.137844
{'0': {'precision': 0.41195592621902966, 'recall': 0.6342545440912755, 'f1-score': 0.4994882494193598, 'support': 160043}, '1': {'precision': 0.593842607836681, 'recall': 0.1742072585016126, 'f1-score': 0.26938795832589946, 'support': 186347}, '2': {'precision': 0.4172824544809648, 'recall': 0.5372194351601098, 'f1-score': 0.4697156641204442, 'support': 157673}, 'accuracy': 0.4338267240404473, 'macro avg': {'precision': 0.4743603295122252, 'recall': 0.4485604125843326, 'f1-score': 0.4128639572885679, 'support': 504063}, 'weighted avg': {'precision': 0.48086375549840266, 'recall': 0.4338267240404473, 'f1-score': 0.40510950750370844, 'support': 504063}}
[[101508  10732  47803]
 [ 83400  32463  70484]
 [ 61497  11471  84705]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        86 (peak)  22.78 (ave)

============================================
