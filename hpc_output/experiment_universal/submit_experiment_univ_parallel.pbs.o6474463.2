This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W0/deepLOB_L1/h300
Epoch 1/50
8838/8838 - 197s - loss: 3.2550 - accuracy300: 0.3927 - val_loss: 3.4018 - val_accuracy300: 0.3361 - 197s/epoch - 22ms/step
Epoch 2/50
8838/8838 - 144s - loss: 3.2297 - accuracy300: 0.4092 - val_loss: 3.4512 - val_accuracy300: 0.3379 - 144s/epoch - 16ms/step
Epoch 3/50
8838/8838 - 143s - loss: 3.2189 - accuracy300: 0.4155 - val_loss: 3.4307 - val_accuracy300: 0.3344 - 143s/epoch - 16ms/step
Epoch 4/50
8838/8838 - 145s - loss: 3.2113 - accuracy300: 0.4187 - val_loss: 3.4009 - val_accuracy300: 0.3369 - 145s/epoch - 16ms/step
Epoch 5/50
8838/8838 - 145s - loss: 3.2044 - accuracy300: 0.4215 - val_loss: 3.5676 - val_accuracy300: 0.3384 - 145s/epoch - 16ms/step
Epoch 6/50
8838/8838 - 142s - loss: 3.1989 - accuracy300: 0.4239 - val_loss: 3.5628 - val_accuracy300: 0.3377 - 142s/epoch - 16ms/step
Epoch 7/50
8838/8838 - 142s - loss: 3.1946 - accuracy300: 0.4259 - val_loss: 3.5418 - val_accuracy300: 0.3377 - 142s/epoch - 16ms/step
Epoch 8/50
8838/8838 - 143s - loss: 3.1909 - accuracy300: 0.4270 - val_loss: 3.5835 - val_accuracy300: 0.3382 - 143s/epoch - 16ms/step
Epoch 9/50
8838/8838 - 145s - loss: 3.1888 - accuracy300: 0.4276 - val_loss: 3.6095 - val_accuracy300: 0.3389 - 145s/epoch - 16ms/step
Epoch 10/50
8838/8838 - 141s - loss: 3.1854 - accuracy300: 0.4291 - val_loss: 3.5345 - val_accuracy300: 0.3384 - 141s/epoch - 16ms/step
Epoch 11/50
8838/8838 - 144s - loss: 3.1833 - accuracy300: 0.4300 - val_loss: 3.5722 - val_accuracy300: 0.3371 - 144s/epoch - 16ms/step
Epoch 12/50
8838/8838 - 142s - loss: 3.1810 - accuracy300: 0.4307 - val_loss: 3.6711 - val_accuracy300: 0.3384 - 142s/epoch - 16ms/step
Epoch 13/50
8838/8838 - 142s - loss: 3.1787 - accuracy300: 0.4318 - val_loss: 3.6960 - val_accuracy300: 0.3370 - 142s/epoch - 16ms/step
Epoch 14/50
8838/8838 - 142s - loss: 3.1768 - accuracy300: 0.4320 - val_loss: 3.6706 - val_accuracy300: 0.3369 - 142s/epoch - 16ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 206s - 206s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1186699
{'0': {'precision': 0.2993563226772411, 'recall': 0.15885443611375388, 'f1-score': 0.20756422202504884, 'support': 2377554}, '1': {'precision': 0.4452811344590617, 'recall': 0.405866852423563, 'f1-score': 0.424661410874993, 'support': 3649214}, '2': {'precision': 0.2868425891633883, 'recall': 0.45723726716485136, 'f1-score': 0.3525296927745367, 'support': 2422261}, 'accuracy': 0.3510850773503085, 'macro avg': {'precision': 0.34382668209989703, 'recall': 0.3406528519007228, 'f1-score': 0.32825177522485954, 'support': 8449029}, 'weighted avg': {'precision': 0.35879502710665967, 'recall': 0.3510850773503085, 'f1-score': 0.3428908148270129, 'support': 8449029}}
[[ 377685  913506 1086363]
 [ 500860 1481095 1667259]
 [ 383112  931601 1107548]]
Evaluating performance on  train set...
8838/8838 - 53s - 53s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.138709
{'0': {'precision': 0.33078547228178146, 'recall': 0.24281753241638754, 'f1-score': 0.28005610668276165, 'support': 749081}, '1': {'precision': 0.33396073843716534, 'recall': 0.4871884378962235, 'f1-score': 0.39627832595380813, 'support': 747684}, '2': {'precision': 0.3470874372247423, 'recall': 0.2818502901450006, 'f1-score': 0.3110854719960772, 'support': 765307}, 'accuracy': 0.3367952036893609, 'macro avg': {'precision': 0.3372778826478964, 'recall': 0.33728542015253726, 'f1-score': 0.32913996821088237, 'support': 2262072}, 'weighted avg': {'precision': 0.33735029585270426, 'recall': 0.3367952036893609, 'f1-score': 0.32896899905457416, 'support': 2262072}}
[[181890 359931 207260]
 [184920 364263 198501]
 [183063 366542 215702]]
Evaluating performance on  val set...
3279/3279 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1341951
{'0': {'precision': 0.3364254432778953, 'recall': 0.18506380283394183, 'f1-score': 0.23877835398258535, 'support': 281022}, '1': {'precision': 0.33156450724101033, 'recall': 0.4135702570107903, 'f1-score': 0.36805481385104843, 'support': 274969}, '2': {'precision': 0.34037965152220984, 'recall': 0.4106813345305176, 'f1-score': 0.37224026312121616, 'support': 282886}, 'accuracy': 0.33604688172401914, 'macro avg': {'precision': 0.3361232006803718, 'recall': 0.33643846479174994, 'f1-score': 0.3263578103182833, 'support': 838877}, 'weighted avg': {'precision': 0.3361655522953972, 'recall': 0.33604688172401914, 'f1-score': 0.3261588931106842, 'support': 838877}}
[[ 52007 114770 114245]
 [ 50358 113719 110892]
 [ 52222 114488 116176]]
testing model out of sample: results/universal/W0/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 142s - 142s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1389407
{'0': {'precision': 0.3513655591403317, 'recall': 0.21465460488410007, 'f1-score': 0.2665001710571331, 'support': 1995946}, '1': {'precision': 0.30142287631828535, 'recall': 0.4628331568252047, 'f1-score': 0.36508315364396304, 'support': 1837498}, '2': {'precision': 0.31942520147689274, 'recall': 0.2862963542732027, 'f1-score': 0.30195481662385343, 'support': 1999519}, 'accuracy': 0.3173942642872927, 'macro avg': {'precision': 0.3240712123118366, 'recall': 0.3212613719941692, 'f1-score': 0.31117938044164983, 'support': 5832963}, 'weighted avg': {'precision': 0.3246835911911117, 'recall': 0.3173942642872927, 'f1-score': 0.30970947493686934, 'support': 5832963}}
[[428439 982300 585207]
 [352564 850455 634479]
 [438351 988713 572455]]
Evaluating performance on  train set...
6334/6334 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1333319
{'0': {'precision': 0.33856093866830267, 'recall': 0.22538238956786197, 'f1-score': 0.2706146860893285, 'support': 548459}, '1': {'precision': 0.3242080186178453, 'recall': 0.4479408060213777, 'f1-score': 0.3761606481655308, 'support': 525594}, '2': {'precision': 0.3442604068715753, 'recall': 0.33340404171550725, 'f1-score': 0.33874526336129257, 'support': 546847}, 'accuracy': 0.3339928434820162, 'macro avg': {'precision': 0.33567645471924107, 'recall': 0.33557574576824895, 'f1-score': 0.32850686587205064, 'support': 1620900}, 'weighted avg': {'precision': 0.33582969579554983, 'recall': 0.3339928434820162, 'f1-score': 0.32782446225128864, 'support': 1620900}}
[[123613 245862 178984]
 [121862 235435 168297]
 [119638 244888 182321]]
Evaluating performance on  val set...
2156/2156 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1303657
{'0': {'precision': 0.3374272572907565, 'recall': 0.11263792202074678, 'f1-score': 0.16889600369676613, 'support': 181715}, '1': {'precision': 0.34062664971164286, 'recall': 0.5538980671633733, 'f1-score': 0.42183841170702024, 'support': 185220}, '2': {'precision': 0.33454365058422436, 'recall': 0.34377287887415603, 'f1-score': 0.3390954779245581, 'support': 184395}, 'accuracy': 0.3381840277147988, 'macro avg': {'precision': 0.3375325191955412, 'recall': 0.33676962268609206, 'f1-score': 0.3099432977761148, 'support': 551330}, 'weighted avg': {'precision': 0.3375376608703651, 'recall': 0.3381840277147988, 'f1-score': 0.3107963625778228, 'support': 551330}}
[[ 20468  97912  63335]
 [ 19870 102593  62757]
 [ 20321 100684  63390]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
876/876 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1379839
{'0': {'precision': 0.266521476816222, 'recall': 0.281592039800995, 'f1-score': 0.27384957324402576, 'support': 64320}, '1': {'precision': 0.3347300268751527, 'recall': 0.2975071116805281, 'f1-score': 0.3150228210758671, 'support': 92102}, '2': {'precision': 0.31298931905620275, 'recall': 0.3435105487723857, 'f1-score': 0.3275404551245504, 'support': 67733}, 'accuracy': 0.306841248243403, 'macro avg': {'precision': 0.30474694091585913, 'recall': 0.307536566751303, 'f1-score': 0.30547094981481443, 'support': 224155}, 'weighted avg': {'precision': 0.30858857429773373, 'recall': 0.306841248243403, 'f1-score': 0.3069908503702189, 'support': 224155}}
[[18112 28115 18093]
 [31723 27401 32978]
 [18122 26344 23267]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279016
{'0': {'precision': 0.3493355680593799, 'recall': 0.20865958740033608, 'f1-score': 0.26126468942361497, 'support': 27969}, '1': {'precision': 0.3210106879181215, 'recall': 0.4665685287053537, 'f1-score': 0.3803388438886521, 'support': 25814}, '2': {'precision': 0.3444432100137022, 'recall': 0.33889597376571323, 'f1-score': 0.34164707610931533, 'support': 27445}, 'accuracy': 0.33462599103757323, 'macro avg': {'precision': 0.3382631553304012, 'recall': 0.3380413632904677, 'f1-score': 0.32775020314052744, 'support': 81228}, 'weighted avg': {'precision': 0.3386810003914566, 'recall': 0.33462599103757323, 'f1-score': 0.3262653643872914, 'support': 81228}}
[[ 5836 12632  9501]
 [ 5569 12044  8201]
 [ 5301 12843  9301]]
Evaluating performance on  val set...
104/104 - 1s - 716ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1328468
{'0': {'precision': 0.34418362023995824, 'recall': 0.3989599709759342, 'f1-score': 0.369553041335275, 'support': 8269}, '1': {'precision': 0.410670634498884, 'recall': 0.3848605577689243, 'f1-score': 0.3973469072960049, 'support': 10040}, '2': {'precision': 0.3416455527403654, 'recall': 0.313049853372434, 'f1-score': 0.3267232034687241, 'support': 8184}, 'accuracy': 0.36707809610085684, 'macro avg': {'precision': 0.36549993582640256, 'recall': 0.3656234607057642, 'f1-score': 0.36454105070000137, 'support': 26493}, 'weighted avg': {'precision': 0.3685960340376764, 'recall': 0.36707809610085684, 'f1-score': 0.36685538614884367, 'support': 26493}}
[[3299 2832 2138]
 [3377 3864 2799]
 [2909 2713 2562]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
2359/2359 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1486379
{'0': {'precision': 0.29620323170145235, 'recall': 0.1313770136885495, 'f1-score': 0.18202101919063188, 'support': 187529}, '1': {'precision': 0.3134771038189637, 'recall': 0.6228000584563352, 'f1-score': 0.4170422316159573, 'support': 191596}, '2': {'precision': 0.3955086846862295, 'recall': 0.24639126157845306, 'f1-score': 0.30362951220716244, 'support': 224663}, 'accuracy': 0.330112556062724, 'macro avg': {'precision': 0.3350630067355485, 'recall': 0.33352277790777923, 'f1-score': 0.3008975876712505, 'support': 603788}, 'weighted avg': {'precision': 0.3386351213483908, 'recall': 0.330112556062724, 'f1-score': 0.3018479337407976, 'support': 603788}}
[[ 24637 121497  41395]
 [ 29061 119326  43209]
 [ 29478 139830  55355]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1298261
{'0': {'precision': 0.34276341613861944, 'recall': 0.24058330381390955, 'f1-score': 0.2827243293246994, 'support': 50814}, '1': {'precision': 0.3384727532803345, 'recall': 0.48559532736098504, 'f1-score': 0.3989009920248978, 'support': 50678}, '2': {'precision': 0.32976637611319776, 'recall': 0.283664885294536, 'f1-score': 0.30498328709064293, 'support': 49213}, 'accuracy': 0.33704256660362963, 'macro avg': {'precision': 0.3370008485107172, 'recall': 0.3366145054898102, 'f1-score': 0.3288695361467467, 'support': 150705}, 'weighted avg': {'precision': 0.3370763749448751, 'recall': 0.33704256660362963, 'f1-score': 0.32906009124936036, 'support': 150705}}
[[12225 24433 14156]
 [11852 24609 14217]
 [11589 23664 13960]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1415511
{'0': {'precision': 0.3205051112447384, 'recall': 0.21661163322326646, 'f1-score': 0.25851041256176305, 'support': 19685}, '1': {'precision': 0.301088874829343, 'recall': 0.517454503834268, 'f1-score': 0.3806757183454373, 'support': 17474}, '2': {'precision': 0.3855989667420084, 'recall': 0.27565671021651816, 'f1-score': 0.32148818176923494, 'support': 21661}, 'accuracy': 0.3277286637198232, 'macro avg': {'precision': 0.3357309842720299, 'recall': 0.33657428242468423, 'f1-score': 0.32022477089214507, 'support': 58820}, 'weighted avg': {'precision': 0.3387084211529966, 'recall': 0.3277286637198232, 'f1-score': 0.31799490783661805, 'support': 58820}}
[[ 4264 10306  5115]
 [ 4033  9042  4399]
 [ 5007 10683  5971]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
1625/1625 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1347461
{'0': {'precision': 0.28252405751728427, 'recall': 0.4835596087624838, 'f1-score': 0.3566639747913796, 'support': 116451}, '1': {'precision': 0.4045588820682575, 'recall': 0.33091700512398675, 'f1-score': 0.3640511292937672, 'support': 175059}, '2': {'precision': 0.29206206369982546, 'recall': 0.17227624033906758, 'f1-score': 0.21671851683233426, 'support': 124341}, 'accuracy': 0.3262274228028789, 'macro avg': {'precision': 0.32638166776178906, 'recall': 0.3289176180751794, 'f1-score': 0.31247787363916035, 'support': 415851}, 'weighted avg': {'precision': 0.33674843013587163, 'recall': 0.3262274228028789, 'f1-score': 0.3179294994431126, 'support': 415851}}
[[56311 40865 19275]
 [84481 57930 32648]
 [58522 44398 21421]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1326526
{'0': {'precision': 0.3463741519297075, 'recall': 0.33249699719738424, 'f1-score': 0.33929373953070313, 'support': 37465}, '1': {'precision': 0.37225787195940907, 'recall': 0.5223673533492134, 'f1-score': 0.43471915129995314, 'support': 38203}, '2': {'precision': 0.3715897673699668, 'recall': 0.2417173596098738, 'f1-score': 0.29290283277490103, 'support': 39782}, 'accuracy': 0.3640450411433521, 'macro avg': {'precision': 0.36340726375302784, 'recall': 0.3655272367188238, 'f1-score': 0.35563857453518577, 'support': 115450}, 'weighted avg': {'precision': 0.3636280572544289, 'recall': 0.3640450411433521, 'f1-score': 0.3548850253969772, 'support': 115450}}
[[12457 16242  8766]
 [10751 19956  7496]
 [12756 17410  9616]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1465507
{'0': {'precision': 0.38426643062624477, 'recall': 0.2246878436954131, 'f1-score': 0.2835680751173709, 'support': 15457}, '1': {'precision': 0.34654790474432345, 'recall': 0.507913961038961, 'f1-score': 0.41199385493251395, 'support': 14784}, '2': {'precision': 0.3223971700076299, 'recall': 0.3123236124176858, 'f1-score': 0.3172804532577904, 'support': 14882}, 'accuracy': 0.34638654344790903, 'macro avg': {'precision': 0.3510705017927327, 'recall': 0.34830847238401996, 'f1-score': 0.3376141277692251, 'support': 45123}, 'weighted avg': {'precision': 0.35150333811988327, 'recall': 0.34638654344790903, 'f1-score': 0.33676388081009523, 'support': 45123}}
[[3473 7116 4868]
 [2374 7509 4901]
 [3191 7043 4648]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1269/1269 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.168869
{'0': {'precision': 0.3614271274651068, 'recall': 0.1665097938195401, 'f1-score': 0.22798616292477789, 'support': 100931}, '1': {'precision': 0.32163563669421796, 'recall': 0.2964026808918069, 'f1-score': 0.3085040596151707, 'support': 116976}, '2': {'precision': 0.29507937066629125, 'recall': 0.47073191274319887, 'f1-score': 0.36276111249337417, 'support': 106857}, 'accuracy': 0.3133937259055807, 'macro avg': {'precision': 0.32604737827520536, 'recall': 0.31121479581818196, 'f1-score': 0.2997504450111076, 'support': 324764}, 'weighted avg': {'precision': 0.3252643394939446, 'recall': 0.3133937259055807, 'f1-score': 0.3013326799935013, 'support': 324764}}
[[16806 32542 51583]
 [13722 34672 68582]
 [15971 40585 50301]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1348798
{'0': {'precision': 0.33849139471937084, 'recall': 0.3215992624760426, 'f1-score': 0.32982918848981724, 'support': 41219}, '1': {'precision': 0.31008318117265166, 'recall': 0.3725805665252791, 'f1-score': 0.33847107804057047, 'support': 41022}, '2': {'precision': 0.34354663017065606, 'recall': 0.2927595563383634, 'f1-score': 0.3161262963105748, 'support': 42014}, 'accuracy': 0.32867892640135205, 'macro avg': {'precision': 0.3307070686875595, 'recall': 0.32897979511322833, 'f1-score': 0.32814218761365416, 'support': 124255}, 'weighted avg': {'precision': 0.33082191603550926, 'recall': 0.32867892640135205, 'f1-score': 0.3280489324126558, 'support': 124255}}
[[13256 17049 10914]
 [13149 15284 12589]
 [12757 16957 12300]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1426983
{'0': {'precision': 0.32625240444927656, 'recall': 0.5321964529331514, 'f1-score': 0.40452118006947685, 'support': 14660}, '1': {'precision': 0.32452625144332, 'recall': 0.32192426896644655, 'f1-score': 0.32322002367664465, 'support': 14842}, '2': {'precision': 0.335318901641726, 'recall': 0.14408790111124983, 'f1-score': 0.20156325051307802, 'support': 16018}, 'accuracy': 0.32706502636203866, 'macro avg': {'precision': 0.32869918584477414, 'recall': 0.3327362076702826, 'f1-score': 0.3097681514197332, 'support': 45520}, 'weighted avg': {'precision': 0.3288799876899235, 'recall': 0.32706502636203866, 'f1-score': 0.30659385408492473, 'support': 45520}}
[[7802 4791 2067]
 [7556 4778 2508]
 [8556 5154 2308]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
1733/1733 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1602132
{'0': {'precision': 0.3475451628499846, 'recall': 0.2139918809201624, 'f1-score': 0.2648866853151538, 'support': 147800}, '1': {'precision': 0.31833953974164836, 'recall': 0.7189480627491468, 'f1-score': 0.44128474078768165, 'support': 139476}, '2': {'precision': 0.3325424542134307, 'recall': 0.07984075373153435, 'f1-score': 0.12876586476177695, 'support': 156236}, 'accuracy': 0.32553346921842025, 'macro avg': {'precision': 0.3328090522683546, 'recall': 0.33759356580028116, 'f1-score': 0.2783124302882041, 'support': 443512}, 'weighted avg': {'precision': 0.33307555058425353, 'recall': 0.32553346921842025, 'f1-score': 0.2724091935338918, 'support': 443512}}
[[ 31628 104679  11493]
 [ 25656 100276  13544]
 [ 33720 110042  12474]]
Evaluating performance on  train set...
765/765 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1522405
{'0': {'precision': 0.3179014602988859, 'recall': 0.20588931870213942, 'f1-score': 0.24991854648599957, 'support': 63335}, '1': {'precision': 0.3149164713213258, 'recall': 0.49141084409871744, 'f1-score': 0.3838475170892257, 'support': 64791}, '2': {'precision': 0.341858991089072, 'recall': 0.2711197847363908, 'f1-score': 0.3024076517150396, 'support': 67638}, 'accuracy': 0.32292454179522284, 'macro avg': {'precision': 0.3248923075697612, 'recall': 0.3228066491790826, 'f1-score': 0.31205790509675496, 'support': 195764}, 'weighted avg': {'precision': 0.32519104902174356, 'recall': 0.32292454179522284, 'f1-score': 0.31237972440346873, 'support': 195764}}
[[13040 33599 16696]
 [14344 31839 18608]
 [13635 35665 18338]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1391662
{'0': {'precision': 0.3195372389056896, 'recall': 0.43123576309794986, 'f1-score': 0.36707735810947284, 'support': 21072}, '1': {'precision': 0.34056814554739867, 'recall': 0.340366387167335, 'f1-score': 0.3404672364672365, 'support': 21944}, '2': {'precision': 0.3644853299881525, 'recall': 0.24099161367615887, 'f1-score': 0.29014451748911263, 'support': 21702}, 'accuracy': 0.33662968571340274, 'macro avg': {'precision': 0.3415302381470802, 'recall': 0.3375312546471479, 'f1-score': 0.332563037355274, 'support': 64718}, 'weighted avg': {'precision': 0.3417407323390045, 'recall': 0.33662968571340274, 'f1-score': 0.3322566124674522, 'support': 64718}}
[[9087 7368 4617]
 [9973 7469 4502]
 [9378 7094 5230]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
4693/4693 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1455854
{'0': {'precision': 0.3210565869781729, 'recall': 0.4643142613691822, 'f1-score': 0.37961977415935233, 'support': 379073}, '1': {'precision': 0.35019120348440913, 'recall': 0.28063345400005557, 'f1-score': 0.3115774433617039, 'support': 432044}, '2': {'precision': 0.34432396836470563, 'recall': 0.2707684419662885, 'f1-score': 0.3031481542605633, 'support': 390075}, 'accuracy': 0.3353960066334108, 'macro avg': {'precision': 0.3385239196090959, 'recall': 0.3385720524451754, 'f1-score': 0.33144845726053984, 'support': 1201192}, 'weighted avg': {'precision': 0.33909155561613585, 'recall': 0.3353960066334108, 'f1-score': 0.3303129623431237, 'support': 1201192}}
[[176009 114197  88867]
 [198539 121246 112259]
 [173670 110785 105620]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.142277
{'0': {'precision': 0.34050117170856414, 'recall': 0.40339779789885477, 'f1-score': 0.36929053127120964, 'support': 126788}, '1': {'precision': 0.34292776271727, 'recall': 0.34011561242161364, 'f1-score': 0.341515898633063, 'support': 126457}, '2': {'precision': 0.36385450284130544, 'recall': 0.3011608572484296, 'f1-score': 0.32955249026008215, 'support': 129904}, 'accuracy': 0.3478490091322175, 'macro avg': {'precision': 0.3490944790890465, 'recall': 0.34822475585629936, 'f1-score': 0.3467863067214516, 'support': 383149}, 'weighted avg': {'precision': 0.34921984393961664, 'recall': 0.3478490091322175, 'f1-score': 0.34665070394807523, 'support': 383149}}
[[51146 40698 34944]
 [49992 43010 33455]
 [49070 41712 39122]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.14028
{'0': {'precision': 0.33903720149455785, 'recall': 0.12979662914360346, 'f1-score': 0.1877248740705205, 'support': 48237}, '1': {'precision': 0.31561701291041355, 'recall': 0.5537541681039438, 'f1-score': 0.4020704625146101, 'support': 43485}, '2': {'precision': 0.3510905016529476, 'recall': 0.32890607137660827, 'f1-score': 0.3396364104655406, 'support': 48111}, 'accuracy': 0.3301438144071857, 'macro avg': {'precision': 0.335248238685973, 'recall': 0.3374856228747185, 'f1-score': 0.30981058235022374, 'support': 139833}, 'weighted avg': {'precision': 0.33590109931080137, 'recall': 0.3301438144071857, 'f1-score': 0.3066484031444304, 'support': 139833}}
[[ 6261 26296 15680]
 [ 5838 24080 13567]
 [ 6368 25919 15824]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
6677/6677 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1234527
{'0': {'precision': 0.3471483887904443, 'recall': 0.07810103523184284, 'f1-score': 0.1275140988418082, 'support': 541811}, '1': {'precision': 0.3941722255015283, 'recall': 0.3517870952310377, 'f1-score': 0.37177550672270215, 'support': 681469}, '2': {'precision': 0.28314162902535644, 'recall': 0.5704703234116452, 'f1-score': 0.3784480669940384, 'support': 486006}, 'accuracy': 0.32721264902421243, 'macro avg': {'precision': 0.34148741443910974, 'recall': 0.3334528179581753, 'f1-score': 0.29257922418618293, 'support': 1709286}, 'weighted avg': {'precision': 0.3476969322719181, 'recall': 0.32721264902421243, 'f1-score': 0.29624653536382833, 'support': 1709286}}
[[ 42316 194428 305067]
 [ 44857 239732 396880]
 [ 34723 174031 277252]]
Evaluating performance on  train set...
2262/2262 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1427039
{'0': {'precision': 0.33590701535907014, 'recall': 0.32724864648997315, 'f1-score': 0.33152130773111005, 'support': 197819}, '1': {'precision': 0.31967823187321026, 'recall': 0.40629459203796636, 'f1-score': 0.35781928062429985, 'support': 187113}, '2': {'precision': 0.3431848525306469, 'recall': 0.2624793064501988, 'f1-score': 0.29745501938907604, 'support': 193901}, 'accuracy': 0.3311041353896547, 'macro avg': {'precision': 0.33292336658764243, 'recall': 0.33200751499271275, 'f1-score': 0.328931869248162, 'support': 578833}, 'weighted avg': {'precision': 0.33309888856086795, 'recall': 0.3311041353896547, 'f1-score': 0.32861063267656876, 'support': 578833}}
[[64736 82080 51003]
 [64686 76023 46404]
 [63298 79708 50895]]
Evaluating performance on  val set...
827/827 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1292388
{'0': {'precision': 0.3490387488793705, 'recall': 0.05120561157387111, 'f1-score': 0.08930915393340046, 'support': 68430}, '1': {'precision': 0.3509911273446127, 'recall': 0.624140061791967, 'f1-score': 0.4493090290820664, 'support': 72825}, '2': {'precision': 0.33107488962319165, 'recall': 0.3391599937419107, 'f1-score': 0.3350686760108195, 'support': 70309}, 'accuracy': 0.34411809192490217, 'macro avg': {'precision': 0.3437015886157249, 'recall': 0.3381685557025829, 'f1-score': 0.2912289530087621, 'support': 211564}, 'weighted avg': {'precision': 0.34374087675220605, 'recall': 0.34411809192490217, 'f1-score': 0.29490224701843787, 'support': 211564}}
[[ 3504 40825 24101]
 [ 3293 45453 24079]
 [ 3242 43221 23846]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
5633/5633 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0821493
{'0': {'precision': 0.24011901934064286, 'recall': 0.2697187153309273, 'f1-score': 0.25405963120717484, 'support': 356045}, '1': {'precision': 0.5207430068971567, 'recall': 0.6715119772967975, 'f1-score': 0.5865945973988117, 'support': 707213}, '2': {'precision': 0.36124344834486527, 'recall': 0.12398038967076624, 'f1-score': 0.18460388786737594, 'support': 378576}, 'accuracy': 0.4285306075456675, 'macro avg': {'precision': 0.3740351581942216, 'recall': 0.35507036076616366, 'f1-score': 0.34175270549112086, 'support': 1441834}, 'weighted avg': {'precision': 0.40956691275036083, 'recall': 0.4285306075456675, 'f1-score': 0.3989298267738478, 'support': 1441834}}
[[ 96032 218803  41210]
 [190528 474902  41783]
 [113375 218265  46936]]
Evaluating performance on  train set...
1454/1454 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1225468
{'0': {'precision': 0.32241237302095727, 'recall': 0.17162761241291957, 'f1-score': 0.22400966490748395, 'support': 123162}, '1': {'precision': 0.3430246341515981, 'recall': 0.38857738100082195, 'f1-score': 0.36438285077611077, 'support': 122879}, '2': {'precision': 0.35688076684036907, 'recall': 0.4737572786266203, 'f1-score': 0.4070963563856982, 'support': 126054}, 'accuracy': 0.3456241013719615, 'macro avg': {'precision': 0.34077259133764154, 'recall': 0.3446540906801206, 'f1-score': 0.3318296240230976, 'support': 372095}, 'weighted avg': {'precision': 0.34089607462937493, 'recall': 0.3456241013719615, 'f1-score': 0.332389854143958, 'support': 372095}}
[[21138 45642 56382]
 [23896 47748 51235]
 [20528 45807 59719]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1201886
{'0': {'precision': 0.33360356708552896, 'recall': 0.1014212947748932, 'f1-score': 0.15555205544180184, 'support': 48688}, '1': {'precision': 0.30634656524839554, 'recall': 0.4350820336236581, 'f1-score': 0.3595380237683424, 'support': 44433}, '2': {'precision': 0.3527378147091653, 'recall': 0.4616149320348955, 'f1-score': 0.39989806140921313, 'support': 49290}, 'accuracy': 0.33019219021002594, 'macro avg': {'precision': 0.3308959823476966, 'recall': 0.33270608681114894, 'f1-score': 0.30499604687311915, 'support': 142411}, 'weighted avg': {'precision': 0.3317218072687991, 'recall': 0.33019219021002594, 'f1-score': 0.30376759472448983, 'support': 142411}}
[[ 4938 21616 22134]
 [ 5484 19332 19617]
 [ 4380 22157 22753]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
11876/11876 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1451478
{'0': {'precision': 0.37882009628828556, 'recall': 0.24865845034134, 'f1-score': 0.30023916708279985, 'support': 1125564}, '1': {'precision': 0.2538012297102883, 'recall': 0.5666313491470418, 'f1-score': 0.3505753840400021, 'support': 749392}, '2': {'precision': 0.37938175179344824, 'recall': 0.2045566309046578, 'f1-score': 0.2657987735452438, 'support': 1165203}, 'accuracy': 0.310135094907865, 'macro avg': {'precision': 0.3373343592640074, 'recall': 0.33994881013101325, 'f1-score': 0.3055377748893486, 'support': 3040159}, 'weighted avg': {'precision': 0.34821850742959876, 'recall': 0.310135094907865, 'f1-score': 0.2994469415534281, 'support': 3040159}}
[[279881 614709 230974]
 [165828 424629 158935]
 [293114 633739 238350]]
Evaluating performance on  train set...
2538/2538 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1201309
{'0': {'precision': 0.35075702044839874, 'recall': 0.1250907058606127, 'f1-score': 0.18441379814416756, 'support': 221871}, '1': {'precision': 0.3240733863180569, 'recall': 0.45778903339962707, 'f1-score': 0.37949705352677326, 'support': 209673}, '2': {'precision': 0.3416644490053333, 'recall': 0.4297623360127659, 'f1-score': 0.3806829490204999, 'support': 218081}, 'accuracy': 0.33475158745430056, 'macro avg': {'precision': 0.33883161859059635, 'recall': 0.3375473584243352, 'f1-score': 0.31486460023048024, 'support': 649625}, 'weighted avg': {'precision': 0.33909220660674194, 'recall': 0.33475158745430056, 'f1-score': 0.31326700437560645, 'support': 649625}}
[[ 27754 100824  93293]
 [ 26390  95986  87297]
 [ 24982  99376  93723]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1250703
{'0': {'precision': 0.3151729773903568, 'recall': 0.01689371705579161, 'f1-score': 0.0320685163114277, 'support': 68487}, '1': {'precision': 0.31922875883116664, 'recall': 0.5769728922547123, 'f1-score': 0.4110377169034037, 'support': 65627}, '2': {'precision': 0.3297226021910853, 'recall': 0.385989209152024, 'f1-score': 0.3556441697404712, 'support': 69318}, 'accuracy': 0.32334146053718194, 'macro avg': {'precision': 0.3213747794708696, 'recall': 0.326618606154176, 'f1-score': 0.2662501343184342, 'support': 203432}, 'weighted avg': {'precision': 0.321439049889044, 'recall': 0.32334146053718194, 'f1-score': 0.2645797675975776, 'support': 203432}}
[[ 1157 39722 27608]
 [  979 37865 26783]
 [ 1535 41027 26756]]
testing model on single stock: results/universal/W0/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
19053/19053 - 122s - 122s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1157874
{'0': {'precision': 0.35112477447277046, 'recall': 0.04757617564860825, 'f1-score': 0.08379801422499163, 'support': 1353976}, '1': {'precision': 0.4625581233511947, 'recall': 0.3321368138694504, 'f1-score': 0.38664542612190395, 'support': 2201385}, '2': {'precision': 0.2726921448674109, 'recall': 0.6421446346315304, 'f1-score': 0.3828175728323449, 'support': 1322090}, 'accuracy': 0.33717427402141, 'macro avg': {'precision': 0.3621250142304587, 'recall': 0.34061920804986306, 'f1-score': 0.28442033772641345, 'support': 4877451}, 'weighted avg': {'precision': 0.3801589374906624, 'recall': 0.33717427402141, 'f1-score': 0.301537673337483, 'support': 4877451}}
[[  64417  426629  862930]
 [  68825  731161 1401399]
 [  50217  422900  848973]]
Evaluating performance on  train set...
4812/4812 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1438283
{'0': {'precision': 0.3251642253314436, 'recall': 0.20682734869736524, 'f1-score': 0.2528342849764504, 'support': 407098}, '1': {'precision': 0.3317528424030833, 'recall': 0.5755444512207117, 'f1-score': 0.4208951331909632, 'support': 406648}, '2': {'precision': 0.3376245101851575, 'recall': 0.21595850015067372, 'f1-score': 0.263421678311478, 'support': 418122}, 'accuracy': 0.3316426760010001, 'macro avg': {'precision': 0.33151385930656146, 'recall': 0.3327767666895836, 'f1-score': 0.3123836988262972, 'support': 1231868}, 'weighted avg': {'precision': 0.3315684562868323, 'recall': 0.3316426760010001, 'f1-score': 0.31190589807197977, 'support': 1231868}}
[[ 84199 232526  90373]
 [ 85826 234044  86778]
 [ 88918 238907  90297]]
Evaluating performance on  val set...
1767/1767 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1344774
{'0': {'precision': 0.3442367601246106, 'recall': 0.19332629948180993, 'f1-score': 0.24759892924645294, 'support': 149752}, '1': {'precision': 0.35835541596117654, 'recall': 0.36793873396452, 'f1-score': 0.3630838499017882, 'support': 154735}, '2': {'precision': 0.33099399000563734, 'recall': 0.46874281152321284, 'f1-score': 0.38800528667913664, 'support': 147806}, 'accuracy': 0.3430674363742088, 'macro avg': {'precision': 0.34452872203047485, 'recall': 0.3433359483231809, 'f1-score': 0.33289602194245926, 'support': 452293}, 'weighted avg': {'precision': 0.34473928687312555, 'recall': 0.3430674363742088, 'f1-score': 0.33299149836491937, 'support': 452293}}
[[28951 51242 69559]
 [27326 56933 70476]
 [27825 50698 69283]]
training model: results/universal/W0/deepLOB_L1/h500
Epoch 1/50
8838/8838 - 146s - loss: 3.2368 - accuracy500: 0.4067 - val_loss: 3.4254 - val_accuracy500: 0.3295 - 146s/epoch - 17ms/step
Epoch 2/50
8838/8838 - 139s - loss: 3.2093 - accuracy500: 0.4210 - val_loss: 3.5170 - val_accuracy500: 0.3331 - 139s/epoch - 16ms/step
Epoch 3/50
8838/8838 - 143s - loss: 3.1962 - accuracy500: 0.4276 - val_loss: 3.5706 - val_accuracy500: 0.3337 - 143s/epoch - 16ms/step
Epoch 4/50
8838/8838 - 140s - loss: 3.1847 - accuracy500: 0.4322 - val_loss: 3.5666 - val_accuracy500: 0.3329 - 140s/epoch - 16ms/step
Epoch 5/50
8838/8838 - 143s - loss: 3.1774 - accuracy500: 0.4346 - val_loss: 3.5220 - val_accuracy500: 0.3278 - 143s/epoch - 16ms/step
Epoch 6/50
8838/8838 - 142s - loss: 3.1712 - accuracy500: 0.4371 - val_loss: 3.4687 - val_accuracy500: 0.3299 - 142s/epoch - 16ms/step
Epoch 7/50
8838/8838 - 139s - loss: 3.1651 - accuracy500: 0.4391 - val_loss: 3.8431 - val_accuracy500: 0.3341 - 139s/epoch - 16ms/step
Epoch 8/50
8838/8838 - 139s - loss: 3.1604 - accuracy500: 0.4405 - val_loss: 3.8484 - val_accuracy500: 0.3347 - 139s/epoch - 16ms/step
Epoch 9/50
8838/8838 - 141s - loss: 3.1559 - accuracy500: 0.4424 - val_loss: 3.8610 - val_accuracy500: 0.3337 - 141s/epoch - 16ms/step
Epoch 10/50
8838/8838 - 139s - loss: 3.1532 - accuracy500: 0.4432 - val_loss: 3.9115 - val_accuracy500: 0.3340 - 139s/epoch - 16ms/step
Epoch 11/50
8838/8838 - 139s - loss: 3.1495 - accuracy500: 0.4449 - val_loss: 3.8614 - val_accuracy500: 0.3337 - 139s/epoch - 16ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 170s - 170s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1312032
{'0': {'precision': 0.2581507723304231, 'recall': 0.3385342379431473, 'f1-score': 0.29292800549907055, 'support': 2270887}, '1': {'precision': 0.44673649752030203, 'recall': 0.21511393210152968, 'f1-score': 0.29039565525330746, 'support': 3852075}, '2': {'precision': 0.2802808278159797, 'recall': 0.43573207478546405, 'f1-score': 0.3411316924125998, 'support': 2326067}, 'accuracy': 0.3090236759750736, 'macro avg': {'precision': 0.3283893658889016, 'recall': 0.3297934149433803, 'f1-score': 0.3081517843883259, 'support': 8449029}, 'weighted avg': {'precision': 0.3502231689494813, 'recall': 0.3090236759750736, 'f1-score': 0.3050442146320898, 'support': 8449029}}
[[ 768773  511610  990504]
 [1411320  828635 1612120]
 [ 797907  514618 1013542]]
Evaluating performance on  train set...
8838/8838 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.147402
{'0': {'precision': 0.331208142570661, 'recall': 0.5373405804160623, 'f1-score': 0.40981368311830535, 'support': 749359}, '1': {'precision': 0.3237701579188838, 'recall': 0.2031856911636693, 'f1-score': 0.24968112007658078, 'support': 743261}, '2': {'precision': 0.34412722281236635, 'recall': 0.25935081070684074, 'f1-score': 0.295784334360002, 'support': 769452}, 'accuracy': 0.33298630635983295, 'macro avg': {'precision': 0.3330351744339704, 'recall': 0.33329236076219076, 'f1-score': 0.3184263791849627, 'support': 2262072}, 'weighted avg': {'precision': 0.33315867651470704, 'recall': 0.33298630635983295, 'f1-score': 0.31841058038783115, 'support': 2262072}}
[[402661 155162 191536]
 [403439 151020 188802]
 [409634 160260 199558]]
Evaluating performance on  val set...
3279/3279 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1417953
{'0': {'precision': 0.32713395030542414, 'recall': 0.40756383663543383, 'f1-score': 0.3629464257278801, 'support': 279620}, '1': {'precision': 0.3204870519255541, 'recall': 0.2060875464153099, 'f1-score': 0.2508605253550753, 'support': 280080}, '2': {'precision': 0.33799391118055444, 'recall': 0.37580101512660424, 'f1-score': 0.3558962112140465, 'support': 279177}, 'accuracy': 0.32972533518024694, 'macro avg': {'precision': 0.3285383044705109, 'recall': 0.329817466059116, 'f1-score': 0.32323438743233396, 'support': 838877}, 'weighted avg': {'precision': 0.3285288961663814, 'recall': 0.32972533518024694, 'f1-score': 0.3231774527869797, 'support': 838877}}
[[113963  61037 104620]
 [121489  57721 100870]
 [112916  61346 104915]]
testing model out of sample: results/universal/W0/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 131s - 131s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1475238
{'0': {'precision': 0.35844133423567837, 'recall': 0.4544929329619688, 'f1-score': 0.4007926836524091, 'support': 2000909}, '1': {'precision': 0.2993917783925215, 'recall': 0.26606455121588474, 'f1-score': 0.2817460340779874, 'support': 1801980}, '2': {'precision': 0.31171804919503326, 'recall': 0.2601875596653127, 'f1-score': 0.283631275046623, 'support': 2030074}, 'accuracy': 0.3286566364298899, 'macro avg': {'precision': 0.32318372060774436, 'recall': 0.3269150146143887, 'f1-score': 0.32205666425900653, 'support': 5832963}, 'weighted avg': {'precision': 0.32393779893229063, 'recall': 0.3286566364298899, 'f1-score': 0.3232393010895334, 'support': 5832963}}
[[909399 564006 527504]
 [683761 479443 638776]
 [943933 557941 528200]]
Evaluating performance on  train set...
6334/6334 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1366626
{'0': {'precision': 0.3231528043987938, 'recall': 0.43036600669528985, 'f1-score': 0.3691320772193127, 'support': 537094}, '1': {'precision': 0.33386538907501245, 'recall': 0.24849979434145195, 'f1-score': 0.2849259635892027, 'support': 544592}, '2': {'precision': 0.3449897754599044, 'recall': 0.32007143731431303, 'f1-score': 0.33206378952573445, 'support': 539214}, 'accuracy': 0.33257141094453696, 'macro avg': {'precision': 0.3340026563112368, 'recall': 0.3329790794503516, 'f1-score': 0.32870727677808326, 'support': 1620900}, 'weighted avg': {'precision': 0.33401639155885116, 'recall': 0.33257141094453696, 'f1-score': 0.32850914211261023, 'support': 1620900}}
[[231147 134457 171490]
 [253071 135331 156190]
 [231069 135558 172587]]
Evaluating performance on  val set...
2156/2156 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1365749
{'0': {'precision': 0.28965087894624747, 'recall': 0.4110695830596551, 'f1-score': 0.33984069967202873, 'support': 172039}, '1': {'precision': 0.3458625502779223, 'recall': 0.20662058212571113, 'f1-score': 0.25869503440947894, 'support': 202671}, '2': {'precision': 0.33422355008409593, 'recall': 0.35215717359302456, 'f1-score': 0.34295607870598843, 'support': 176620}, 'accuracy': 0.31704061088640195, 'macro avg': {'precision': 0.32324565976942193, 'recall': 0.3232824462594636, 'f1-score': 0.3138306042624987, 'support': 551330}, 'weighted avg': {'precision': 0.324593473792943, 'recall': 0.31704061088640195, 'f1-score': 0.3110092649968827, 'support': 551330}}
[[70720 39485 61834]
 [98730 41876 62065]
 [74706 39716 62198]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
876/876 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1287236
{'0': {'precision': 0.33115616830308864, 'recall': 0.5658164675755504, 'f1-score': 0.417791147400086, 'support': 68729}, '1': {'precision': 0.38988640527665813, 'recall': 0.21364121227332622, 'f1-score': 0.27602980161979424, 'support': 79685}, '2': {'precision': 0.38307960672375513, 'recall': 0.3189421845499795, 'f1-score': 0.34808106569837394, 'support': 75741}, 'accuracy': 0.3572037206397359, 'macro avg': {'precision': 0.368040726767834, 'recall': 0.36613328813295204, 'f1-score': 0.34730067157275135, 'support': 224155}, 'weighted avg': {'precision': 0.3695789207853379, 'recall': 0.3572037206397359, 'f1-score': 0.34384158510314006, 'support': 224155}}
[[38888 13491 16350]
 [40108 17024 22553]
 [38435 13149 24157]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1372843
{'0': {'precision': 0.3301807021389872, 'recall': 0.3827554910147032, 'f1-score': 0.35452955814109893, 'support': 27545}, '1': {'precision': 0.32215061357817604, 'recall': 0.2759376890502117, 'f1-score': 0.2972587674636471, 'support': 26448}, '2': {'precision': 0.3313065345494126, 'recall': 0.3241050119331742, 'f1-score': 0.32766620884219905, 'support': 27235}, 'accuracy': 0.32831043482542965, 'macro avg': {'precision': 0.32787928342219197, 'recall': 0.3275993973326964, 'f1-score': 0.3264848448156484, 'support': 81228}, 'weighted avg': {'precision': 0.3279435704041372, 'recall': 0.32831043482542965, 'f1-score': 0.326875040117846, 'support': 81228}}
[[10543  7555  9447]
 [10781  7298  8369]
 [10607  7801  8827]]
Evaluating performance on  val set...
104/104 - 1s - 819ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1313307
{'0': {'precision': 0.36360116166505324, 'recall': 0.627254509018036, 'f1-score': 0.4603505331535727, 'support': 8982}, '1': {'precision': 0.4004069175991862, 'recall': 0.23009470361276746, 'f1-score': 0.2922482922482923, 'support': 8553}, '2': {'precision': 0.4062140391254315, 'recall': 0.2758428220584952, 'f1-score': 0.3285685792168074, 'support': 8958}, 'accuracy': 0.3802136413392217, 'macro avg': {'precision': 0.3900740394632236, 'recall': 0.37773067822976625, 'f1-score': 0.36038913487289076, 'support': 26493}, 'weighted avg': {'precision': 0.3898920983953106, 'recall': 0.3802136413392217, 'f1-score': 0.3615213628131655, 'support': 26493}}
[[5634 1483 1865]
 [4838 1968 1747]
 [5023 1464 2471]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
2359/2359 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1631434
{'0': {'precision': 0.3440883716031178, 'recall': 0.6389592481394188, 'f1-score': 0.447299688840357, 'support': 204506}, '1': {'precision': 0.2929913626757328, 'recall': 0.1545971891420156, 'f1-score': 0.2023985686345297, 'support': 165003}, '2': {'precision': 0.4142621418766975, 'recall': 0.2421855992214411, 'f1-score': 0.3056704099471236, 'support': 234279}, 'accuracy': 0.35263867450164627, 'macro avg': {'precision': 0.3504472920518493, 'recall': 0.34524734550095854, 'f1-score': 0.3184562224740034, 'support': 603788}, 'weighted avg': {'precision': 0.3573530952509523, 'recall': 0.35263867450164627, 'f1-score': 0.3254188542309412, 'support': 603788}}
[[130671  29703  44132]
 [103401  25509  36093]
 [145688  31852  56739]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1419184
{'0': {'precision': 0.34849060808242344, 'recall': 0.5028465510393221, 'f1-score': 0.41167544131309997, 'support': 52871}, '1': {'precision': 0.3062305756992748, 'recall': 0.219325023318918, 'f1-score': 0.2555924750176019, 'support': 47172}, '2': {'precision': 0.33966675690974873, 'recall': 0.2724132485886858, 'f1-score': 0.30234519623629413, 'support': 50662}, 'accuracy': 0.33663780232905344, 'macro avg': {'precision': 0.33146264689714894, 'recall': 0.33152827431564197, 'f1-score': 0.32320437085566533, 'support': 150705}, 'weighted avg': {'precision': 0.33229655880942033, 'recall': 0.33663780232905344, 'f1-score': 0.32606690435565083, 'support': 150705}}
[[26586 12022 14263]
 [24259 10346 12567]
 [25444 11417 13801]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1506433
{'0': {'precision': 0.33971156565180505, 'recall': 0.536575682382134, 'f1-score': 0.4160301671893337, 'support': 20150}, '1': {'precision': 0.27336534909493904, 'recall': 0.17876555139509603, 'f1-score': 0.21616884539545753, 'support': 16558}, '2': {'precision': 0.39183420971234145, 'recall': 0.28645079594790157, 'f1-score': 0.3309559265355174, 'support': 22112}, 'accuracy': 0.341822509350561, 'macro avg': {'precision': 0.3349703748196952, 'recall': 0.3339306765750439, 'f1-score': 0.32105164637343625, 'support': 58820}, 'weighted avg': {'precision': 0.34062919998907115, 'recall': 0.341822509350561, 'f1-score': 0.32778696121177187, 'support': 58820}}
[[10812  3552  5786]
 [ 9553  2960  4045]
 [11462  4316  6334]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
1625/1625 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1535378
{'0': {'precision': 0.30679450500579547, 'recall': 0.6907641604642362, 'f1-score': 0.42488257787929706, 'support': 126832}, '1': {'precision': 0.37431592685422754, 'recall': 0.16337402741996038, 'f1-score': 0.22746752105554877, 'support': 154486}, '2': {'precision': 0.33521597327181607, 'recall': 0.1566158488995265, 'f1-score': 0.21348815530832677, 'support': 134533}, 'accuracy': 0.322038422415721, 'macro avg': {'precision': 0.3387754683772797, 'recall': 0.336918012261241, 'f1-score': 0.28861275141439086, 'support': 415851}, 'weighted avg': {'precision': 0.3410729839944463, 'recall': 0.322038422415721, 'f1-score': 0.2831554007889115, 'support': 415851}}
[[ 87611  20049  19172]
 [106634  25239  22613]
 [ 91324  22139  21070]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1550885
{'0': {'precision': 0.3278927794540734, 'recall': 0.6296895213454075, 'f1-score': 0.43123321551509336, 'support': 37104}, '1': {'precision': 0.3381606168892232, 'recall': 0.1905619882885986, 'f1-score': 0.24375942652815671, 'support': 37741}, '2': {'precision': 0.35983774588912637, 'recall': 0.20317694865164387, 'f1-score': 0.2597116413775735, 'support': 40605}, 'accuracy': 0.33612819402338673, 'macro avg': {'precision': 0.34196371407747433, 'recall': 0.34114281942854996, 'f1-score': 0.31156809447360784, 'support': 115450}, 'weighted avg': {'precision': 0.34248475706113546, 'recall': 0.33612819402338673, 'f1-score': 0.3096214200364449, 'support': 115450}}
[[23364  6601  7139]
 [23011  7192  7538]
 [24880  7475  8250]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1655525
{'0': {'precision': 0.33050744331318704, 'recall': 0.5379638188300542, 'f1-score': 0.4094575240583934, 'support': 15146}, '1': {'precision': 0.3300455235204856, 'recall': 0.14447987245914706, 'f1-score': 0.20097948623175013, 'support': 15054}, '2': {'precision': 0.30670028818443806, 'recall': 0.2852643570327682, 'f1-score': 0.2955942089365691, 'support': 14923}, 'accuracy': 0.32311681404161957, 'macro avg': {'precision': 0.3224177516727036, 'recall': 0.32256934944065646, 'f1-score': 0.3020104064089042, 'support': 45123}, 'weighted avg': {'precision': 0.3224798760737382, 'recall': 0.32311681404161957, 'f1-score': 0.30224810462694446, 'support': 45123}}
[[8148 2277 4721]
 [7977 2175 4902]
 [8528 2138 4257]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1269/1269 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1661681
{'0': {'precision': 0.31768847169257847, 'recall': 0.2908799713506953, 'f1-score': 0.30369374094480417, 'support': 100526}, '1': {'precision': 0.3020792157482805, 'recall': 0.1622973937272758, 'f1-score': 0.21115046888556097, 'support': 117716}, '2': {'precision': 0.2906370223512474, 'recall': 0.4624021328927358, 'f1-score': 0.35693012268204843, 'support': 106522}, 'accuracy': 0.30053207867867127, 'macro avg': {'precision': 0.3034682365973688, 'recall': 0.30519316599023566, 'f1-score': 0.29059144417080457, 'support': 324764}, 'weighted avg': {'precision': 0.30315781663390123, 'recall': 0.30053207867867127, 'f1-score': 0.28761136125274733, 'support': 324764}}
[[29241 21505 49780]
 [28171 19105 70440]
 [34631 22635 49256]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.124424
{'0': {'precision': 0.3661553974132749, 'recall': 0.45439888343440177, 'f1-score': 0.40553223018029144, 'support': 41556}, '1': {'precision': 0.3297343754196546, 'recall': 0.29915446282804165, 'f1-score': 0.3137009403107114, 'support': 41039}, '2': {'precision': 0.3463936137203464, 'recall': 0.29476716274603937, 'f1-score': 0.3185018998586453, 'support': 41660}, 'accuracy': 0.34960363768057623, 'macro avg': {'precision': 0.34742779551775865, 'recall': 0.34944016966949426, 'f1-score': 0.3459116901165494, 'support': 124255}, 'weighted avg': {'precision': 0.34750054867283314, 'recall': 0.34960363768057623, 'f1-score': 0.3460227708735636, 'support': 124255}}
[[18883 11667 11006]
 [16597 12277 12165]
 [16091 13289 12280]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1463817
{'0': {'precision': 0.3347099072836957, 'recall': 0.5716755411105733, 'f1-score': 0.42221654749744636, 'support': 14461}, '1': {'precision': 0.358132800110322, 'recall': 0.3434276646389844, 'f1-score': 0.35062611806797855, 'support': 15124}, '2': {'precision': 0.3350743906299462, 'recall': 0.1328522121117038, 'f1-score': 0.1902664809239204, 'support': 15935}, 'accuracy': 0.3422231985940246, 'macro avg': {'precision': 0.3426390326746547, 'recall': 0.34931847262042043, 'f1-score': 0.3210363821631151, 'support': 45520}, 'weighted avg': {'precision': 0.3426197463265867, 'recall': 0.3422231985940246, 'f1-score': 0.31723284878170804, 'support': 45520}}
[[8267 4242 1952]
 [7681 5194 2249]
 [8751 5067 2117]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1699665
{'0': {'precision': 0.3234920590023901, 'recall': 0.7945878347865356, 'f1-score': 0.45979335852697595, 'support': 143935}, '1': {'precision': 0.3456501710976573, 'recall': 0.1442291190422253, 'f1-score': 0.2035310358189436, 'support': 145671}, '2': {'precision': 0.33440701778432647, 'recall': 0.06340883396358817, 'f1-score': 0.10660389209619366, 'support': 153906}, 'accuracy': 0.3272470643409874, 'macro avg': {'precision': 0.334516415961458, 'recall': 0.3340752625974497, 'f1-score': 0.2566427621473711, 'support': 443512}, 'weighted avg': {'precision': 0.33455753635885926, 'recall': 0.3272470643409874, 'f1-score': 0.2530617101573766, 'support': 443512}}
[[114369  21451   8115]
 [113352  21010  11309]
 [125824  18323   9759]]
Evaluating performance on  train set...
765/765 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1600105
{'0': {'precision': 0.32110368397245814, 'recall': 0.6225376358055768, 'f1-score': 0.42367608132228846, 'support': 61577}, '1': {'precision': 0.34627831715210355, 'recall': 0.14344459842140145, 'f1-score': 0.20285656466678736, 'support': 66388}, '2': {'precision': 0.34062314600765126, 'recall': 0.24557884334577207, 'f1-score': 0.28539595474802876, 'support': 67799}, 'accuracy': 0.3295141088249116, 'macro avg': {'precision': 0.3360017157107376, 'recall': 0.3371870258575835, 'f1-score': 0.30397620024570154, 'support': 195764}, 'weighted avg': {'precision': 0.3364011521180536, 'recall': 0.3295141088249116, 'f1-score': 0.30090059464785573, 'support': 195764}}
[[38334  8316 14927]
 [39561  9523 17304]
 [41487  9662 16650]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1461945
{'0': {'precision': 0.3234502026125695, 'recall': 0.6208212560386474, 'f1-score': 0.425311512303288, 'support': 20700}, '1': {'precision': 0.33273056057866185, 'recall': 0.17159605648814283, 'f1-score': 0.22642172804781577, 'support': 22518}, '2': {'precision': 0.36025123373710183, 'recall': 0.22409302325581396, 'f1-score': 0.2763089981074726, 'support': 21500}, 'accuracy': 0.33272041781266415, 'macro avg': {'precision': 0.3388106656427777, 'recall': 0.3388367785942014, 'f1-score': 0.3093474128195255, 'support': 64718}, 'weighted avg': {'precision': 0.33890490253929645, 'recall': 0.33272041781266415, 'f1-score': 0.3066095404086875, 'support': 64718}}
[[12851  3803  4046]
 [14144  3864  4510]
 [12736  3946  4818]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
4693/4693 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113471
{'0': {'precision': 0.19559598022355976, 'recall': 0.6506724112502067, 'f1-score': 0.3007767024389841, 'support': 223747}, '1': {'precision': 0.6153140625462292, 'recall': 0.1680214904632703, 'f1-score': 0.26396347132420683, 'support': 742655}, '2': {'precision': 0.21540235675658656, 'recall': 0.23309766174027854, 'f1-score': 0.223900930312477, 'support': 234790}, 'accuracy': 0.27064532564319443, 'macro avg': {'precision': 0.34210413317545846, 'recall': 0.35059718781791854, 'f1-score': 0.2628803680252227, 'support': 1201192}, 'weighted avg': {'precision': 0.45896442721082864, 'recall': 0.27064532564319443, 'f1-score': 0.26298991007679096, 'support': 1201192}}
[[145586  37476  40685]
 [459209 124782 158664]
 [139525  40536  54729]]
Evaluating performance on  train set...
1497/1497 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1510161
{'0': {'precision': 0.3288987264560729, 'recall': 0.564728565307774, 'f1-score': 0.4156956879785538, 'support': 126034}, '1': {'precision': 0.3272943037974684, 'recall': 0.19659277211490483, 'f1-score': 0.24563955645939406, 'support': 126261}, '2': {'precision': 0.36738353225895165, 'recall': 0.25522337872743667, 'f1-score': 0.30120085317845047, 'support': 130854}, 'accuracy': 0.33771196062106384, 'macro avg': {'precision': 0.3411921875041643, 'recall': 0.33884823871670516, 'f1-score': 0.3208453658721328, 'support': 383149}, 'weighted avg': {'precision': 0.34151343971183457, 'recall': 0.33771196062106384, 'f1-score': 0.32055368229754366, 'support': 383149}}
[[71175 24922 29937]
 [73868 24822 27571]
 [71361 26096 33397]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1391476
{'0': {'precision': 0.2918238804623965, 'recall': 0.4337809755770563, 'f1-score': 0.34891620834681336, 'support': 44753}, '1': {'precision': 0.3395518799884604, 'recall': 0.20813030493555484, 'f1-score': 0.25807316092724103, 'support': 50896}, '2': {'precision': 0.34072614157148623, 'recall': 0.32475556762629004, 'f1-score': 0.3325492195557203, 'support': 44184}, 'accuracy': 0.3171998026216987, 'macro avg': {'precision': 0.32403396734078105, 'recall': 0.32222228271296705, 'f1-score': 0.3131795296099249, 'support': 139833}, 'weighted avg': {'precision': 0.3246477615828943, 'recall': 0.3171998026216987, 'f1-score': 0.31067983514297587, 'support': 139833}}
[[19413 10626 14714]
 [27253 10593 13050]
 [19857  9978 14349]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
6677/6677 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1229372
{'0': {'precision': 0.29216009237404694, 'recall': 0.1817713131449725, 'f1-score': 0.22410974677328385, 'support': 473276}, '1': {'precision': 0.4372826667097964, 'recall': 0.269991873805568, 'f1-score': 0.333852725652038, 'support': 801113}, '2': {'precision': 0.24511871888580622, 'recall': 0.5186469439890364, 'f1-score': 0.3329033514968681, 'support': 434897}, 'accuracy': 0.3088307047504045, 'macro avg': {'precision': 0.32485382598988316, 'recall': 0.32347004364652565, 'f1-score': 0.29695527464072996, 'support': 1709286}, 'weighted avg': {'precision': 0.34820772202053085, 'recall': 0.3088307047504045, 'f1-score': 0.30322496760348316, 'support': 1709286}}
[[ 86028 145164 242084]
 [132262 216294 452557]
 [ 76165 133174 225558]]
Evaluating performance on  train set...
2262/2262 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436477
{'0': {'precision': 0.3170668763241128, 'recall': 0.5477733423194567, 'f1-score': 0.4016482555708453, 'support': 192890}, '1': {'precision': 0.3176463232732827, 'recall': 0.18077843915680106, 'f1-score': 0.23042035971595917, 'support': 196727}, '2': {'precision': 0.36088453191648584, 'recall': 0.25486745306950787, 'f1-score': 0.2987492488678813, 'support': 189216}, 'accuracy': 0.32729474649855833, 'macro avg': {'precision': 0.3318659105046271, 'recall': 0.3278064115152552, 'f1-score': 0.31027262138489525, 'support': 578833}, 'weighted avg': {'precision': 0.3315874623662628, 'recall': 0.32729474649855833, 'f1-score': 0.30981643409530363, 'support': 578833}}
[[105660  38363  48867]
 [124625  35564  36538]
 [102957  38034  48225]]
Evaluating performance on  val set...
827/827 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.13373
{'0': {'precision': 0.25203005082720775, 'recall': 0.42516268980477223, 'f1-score': 0.3164646278438527, 'support': 58547}, '1': {'precision': 0.41665167326376396, 'recall': 0.20309810671256454, 'f1-score': 0.2730817137255769, 'support': 91217}, '2': {'precision': 0.30744578101677056, 'recall': 0.33995145631067963, 'f1-score': 0.32288256719996317, 'support': 61800}, 'accuracy': 0.3045272352574162, 'macro avg': {'precision': 0.3253758350359141, 'recall': 0.3227374176093388, 'f1-score': 0.30414296958979753, 'support': 211564}, 'weighted avg': {'precision': 0.33919508202112697, 'recall': 0.3045272352574162, 'f1-score': 0.29963458764363365, 'support': 211564}}
[[24892 12903 20752]
 [46118 18526 26573]
 [27756 13035 21009]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
5633/5633 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1437727
{'0': {'precision': 0.2505796319835466, 'recall': 0.7554120814491465, 'f1-score': 0.37632691967122595, 'support': 382570}, '1': {'precision': 0.3344289129079194, 'recall': 0.08048472797362509, 'f1-score': 0.12974468626638155, 'support': 639699}, '2': {'precision': 0.40188311881335276, 'recall': 0.1288930201518239, 'f1-score': 0.1951855975774594, 'support': 419565}, 'accuracy': 0.27365355512493117, 'macro avg': {'precision': 0.3289638879016062, 'recall': 0.3215966098581985, 'f1-score': 0.23375240117168894, 'support': 1441834}, 'weighted avg': {'precision': 0.3318094743993781, 'recall': 0.27365355512493117, 'f1-score': 0.21421466061011576, 'support': 1441834}}
[[288998  47438  46134]
 [553862  51486  34351]
 [310458  55028  54079]]
Evaluating performance on  train set...
1454/1454 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1305773
{'0': {'precision': 0.34178464688194055, 'recall': 0.3042173085371211, 'f1-score': 0.3219086397541459, 'support': 122922}, '1': {'precision': 0.332871436626179, 'recall': 0.28381923960692923, 'f1-score': 0.3063945075582648, 'support': 122726}, '2': {'precision': 0.34364698215042744, 'recall': 0.4295159236676236, 'f1-score': 0.38181306900066786, 'support': 126447}, 'accuracy': 0.3400690683830742, 'macro avg': {'precision': 0.33943435521951565, 'recall': 0.339184157270558, 'f1-score': 0.33670540543769284, 'support': 372095}, 'weighted avg': {'precision': 0.3394777200644498, 'recall': 0.3400690683830742, 'f1-score': 0.33714869397971536, 'support': 372095}}
[[37395 34418 51109]
 [35271 34832 52623]
 [36745 35391 54311]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1210684
{'0': {'precision': 0.3610565152925761, 'recall': 0.21008808009470115, 'f1-score': 0.2656198472895157, 'support': 49841}, '1': {'precision': 0.29758679873446514, 'recall': 0.3363090369470216, 'f1-score': 0.31576522216127256, 'support': 42791}, '2': {'precision': 0.3516625416980523, 'recall': 0.45955121637638363, 'f1-score': 0.39843246538361055, 'support': 49779}, 'accuracy': 0.33521286979236153, 'macro avg': {'precision': 0.33676861857503115, 'recall': 0.3353161111393688, 'f1-score': 0.3266058449447996, 'support': 142411}, 'weighted avg': {'precision': 0.3387018147933174, 'recall': 0.33521286979236153, 'f1-score': 0.3271112352598501, 'support': 142411}}
[[10471 16967 22403]
 [ 8628 14391 19772]
 [ 9902 17001 22876]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
11876/11876 - 60s - 60s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1584696
{'0': {'precision': 0.3922643344359607, 'recall': 0.49055285712001223, 'f1-score': 0.435937115507883, 'support': 1188137}, '1': {'precision': 0.21327717570733928, 'recall': 0.32142667364437827, 'f1-score': 0.2564147358766624, 'support': 621025}, '2': {'precision': 0.40095766821857864, 'recall': 0.2014164128750923, 'f1-score': 0.2681372183236057, 'support': 1230997}, 'accuracy': 0.3389299704390461, 'macro avg': {'precision': 0.33549972612062623, 'recall': 0.3377986478798276, 'f1-score': 0.3201630232360504, 'support': 3040159}, 'weighted avg': {'precision': 0.35922197301899506, 'recall': 0.3389299704390461, 'f1-score': 0.3313211872473438, 'support': 3040159}}
[[582844 364830 240463]
 [291440 199614 129971]
 [611561 371493 247943]]
Evaluating performance on  train set...
2538/2538 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1199831
{'0': {'precision': 0.3323242579221821, 'recall': 0.2432493187385883, 'f1-score': 0.2808942335708421, 'support': 217978}, '1': {'precision': 0.3401678462729843, 'recall': 0.34771363351864804, 'f1-score': 0.34389935274786293, 'support': 217288}, '2': {'precision': 0.33808146586307913, 'recall': 0.4226274614081984, 'f1-score': 0.37565619790845994, 'support': 214359}, 'accuracy': 0.33738079661343084, 'macro avg': {'precision': 0.3368578566860818, 'recall': 0.3378634712218116, 'f1-score': 0.33348326140905504, 'support': 649625}, 'weighted avg': {'precision': 0.3368475243644709, 'recall': 0.33738079661343084, 'f1-score': 0.3332372564674115, 'support': 649625}}
[[53023 73959 90996]
 [55359 75554 86375]
 [51170 72595 90594]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1315489
{'0': {'precision': 0.291339544829693, 'recall': 0.27778748689269483, 'f1-score': 0.2844021649991799, 'support': 68664}, '1': {'precision': 0.2920924825142043, 'recall': 0.2384392842382403, 'f1-score': 0.26255288307573027, 'support': 65329}, '2': {'precision': 0.3522148570888424, 'recall': 0.4292832558072553, 'f1-score': 0.3869489589282933, 'support': 69439}, 'accuracy': 0.31686263714656493, 'macro avg': {'precision': 0.31188229481091323, 'recall': 0.3151700089793968, 'f1-score': 0.3113013356677345, 'support': 203432}, 'weighted avg': {'precision': 0.31236037475789763, 'recall': 0.31686263714656493, 'f1-score': 0.3123886916265869, 'support': 203432}}
[[19074 19142 30448]
 [25376 15577 24376]
 [21020 18610 29809]]
testing model on single stock: results/universal/W0/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
19053/19053 - 103s - 103s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1255535
{'0': {'precision': 0.28694904017464234, 'recall': 0.12829946643639237, 'f1-score': 0.1773174769455665, 'support': 1359538}, '1': {'precision': 0.451125656119805, 'recall': 0.27815429524069935, 'f1-score': 0.3441272139976127, 'support': 2187002}, '2': {'precision': 0.2734442450537841, 'recall': 0.6001633467602266, 'f1-score': 0.37570921956626396, 'support': 1330911}, 'accuracy': 0.3242505152793949, 'macro avg': {'precision': 0.3371729804494105, 'recall': 0.3355390361457728, 'f1-score': 0.2990513035031477, 'support': 4877451}, 'weighted avg': {'precision': 0.35687919571002463, 'recall': 0.3242505152793949, 'f1-score': 0.30624854793230816, 'support': 4877451}}
[[ 174428  375061  810049]
 [ 266369  608324 1312309]
 [ 167074  365073  798764]]
Evaluating performance on  train set...
4812/4812 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1547976
{'0': {'precision': 0.3264359320141382, 'recall': 0.6135436577531677, 'f1-score': 0.42614264805387775, 'support': 405976}, '1': {'precision': 0.3210502544618121, 'recall': 0.16980370041101997, 'f1-score': 0.22212521946426556, 'support': 406063}, '2': {'precision': 0.3341887743052822, 'recall': 0.2022347193738403, 'f1-score': 0.2519821513632067, 'support': 419829}, 'accuracy': 0.32709592261508535, 'macro avg': {'precision': 0.3272249869270775, 'recall': 0.32852735917934267, 'f1-score': 0.30008333962711664, 'support': 1231868}, 'weighted avg': {'precision': 0.32730286227153466, 'recall': 0.32709592261508535, 'f1-score': 0.2995369108559544, 'support': 1231868}}
[[249084  71871  85021]
 [252977  68951  84135]
 [260980  73945  84904]]
Evaluating performance on  val set...
1767/1767 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1477745
{'0': {'precision': 0.3311171773350001, 'recall': 0.4314330352690888, 'f1-score': 0.37467667436489605, 'support': 150415}, '1': {'precision': 0.33212591057942925, 'recall': 0.16060913574341837, 'f1-score': 0.2165157759905196, 'support': 154711}, '2': {'precision': 0.3275553327125564, 'recall': 0.4039560499296717, 'f1-score': 0.3617659587415566, 'support': 147167}, 'accuracy': 0.32985476228904714, 'macro avg': {'precision': 0.33026614020899525, 'recall': 0.33199940698072633, 'f1-score': 0.31765280303232407, 'support': 452293}, 'weighted avg': {'precision': 0.3303032716177498, 'recall': 0.32985476228904714, 'f1-score': 0.3163753917128583, 'support': 452293}}
[[64894 25341 60180]
 [67999 24848 61864]
 [63092 24626 59449]]
training model: results/universal/W0/deepLOB_L1/h1000
Epoch 1/50
8838/8838 - 146s - loss: 3.1823 - accuracy1000: 0.4343 - val_loss: 3.5107 - val_accuracy1000: 0.3249 - 146s/epoch - 16ms/step
Epoch 2/50
8838/8838 - 141s - loss: 3.1442 - accuracy1000: 0.4489 - val_loss: 3.5158 - val_accuracy1000: 0.3251 - 141s/epoch - 16ms/step
Epoch 3/50
8838/8838 - 142s - loss: 3.1231 - accuracy1000: 0.4577 - val_loss: 3.5629 - val_accuracy1000: 0.3252 - 142s/epoch - 16ms/step
Epoch 4/50
8838/8838 - 143s - loss: 3.1085 - accuracy1000: 0.4632 - val_loss: 3.5580 - val_accuracy1000: 0.3249 - 143s/epoch - 16ms/step
Epoch 5/50
8838/8838 - 145s - loss: 3.0971 - accuracy1000: 0.4666 - val_loss: 3.5505 - val_accuracy1000: 0.3253 - 145s/epoch - 16ms/step
Epoch 6/50
8838/8838 - 143s - loss: 3.0891 - accuracy1000: 0.4696 - val_loss: 3.5346 - val_accuracy1000: 0.3247 - 143s/epoch - 16ms/step
Epoch 7/50
8838/8838 - 141s - loss: 3.0818 - accuracy1000: 0.4719 - val_loss: 3.5892 - val_accuracy1000: 0.3263 - 141s/epoch - 16ms/step
Epoch 8/50
8838/8838 - 143s - loss: 3.0762 - accuracy1000: 0.4733 - val_loss: 3.6385 - val_accuracy1000: 0.3277 - 143s/epoch - 16ms/step
Epoch 9/50
8838/8838 - 144s - loss: 3.0841 - accuracy1000: 0.4708 - val_loss: 3.5090 - val_accuracy1000: 0.3268 - 144s/epoch - 16ms/step
Epoch 10/50
8838/8838 - 145s - loss: 3.0678 - accuracy1000: 0.4757 - val_loss: 3.6444 - val_accuracy1000: 0.3274 - 145s/epoch - 16ms/step
Epoch 11/50
8838/8838 - 148s - loss: 3.0619 - accuracy1000: 0.4770 - val_loss: 3.6808 - val_accuracy1000: 0.3297 - 148s/epoch - 17ms/step
Epoch 12/50
8838/8838 - 140s - loss: 3.0581 - accuracy1000: 0.4778 - val_loss: 3.8117 - val_accuracy1000: 0.3366 - 140s/epoch - 16ms/step
Epoch 13/50
8838/8838 - 142s - loss: 3.0543 - accuracy1000: 0.4790 - val_loss: 3.8176 - val_accuracy1000: 0.3356 - 142s/epoch - 16ms/step
Epoch 14/50
8838/8838 - 143s - loss: 3.0505 - accuracy1000: 0.4799 - val_loss: 3.8664 - val_accuracy1000: 0.3360 - 143s/epoch - 16ms/step
Epoch 15/50
8838/8838 - 142s - loss: 3.0480 - accuracy1000: 0.4804 - val_loss: 3.8901 - val_accuracy1000: 0.3343 - 142s/epoch - 16ms/step
Epoch 16/50
8838/8838 - 145s - loss: 3.0455 - accuracy1000: 0.4811 - val_loss: 3.9743 - val_accuracy1000: 0.3356 - 145s/epoch - 16ms/step
Epoch 17/50
8838/8838 - 146s - loss: 3.0432 - accuracy1000: 0.4817 - val_loss: 4.0173 - val_accuracy1000: 0.3346 - 146s/epoch - 16ms/step
Epoch 18/50
8838/8838 - 145s - loss: 3.0410 - accuracy1000: 0.4823 - val_loss: 3.9537 - val_accuracy1000: 0.3381 - 145s/epoch - 16ms/step
Epoch 19/50
8838/8838 - 146s - loss: 3.0385 - accuracy1000: 0.4829 - val_loss: 4.0010 - val_accuracy1000: 0.3366 - 146s/epoch - 16ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 223s - 223s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.148375
{'0': {'precision': 0.2762252795522773, 'recall': 0.25626242623943646, 'f1-score': 0.26586965128701645, 'support': 2258829}, '1': {'precision': 0.4685232257472892, 'recall': 0.5654769425142135, 'f1-score': 0.5124546191088619, 'support': 3894180}, '2': {'precision': 0.267247078034988, 'recall': 0.19245172080382575, 'f1-score': 0.22376460490018218, 'support': 2296020}, 'accuracy': 0.3814396896968871, 'macro avg': {'precision': 0.3373318611115182, 'recall': 0.3380636965191586, 'f1-score': 0.3340296250986869, 'support': 8449029}, 'weighted avg': {'precision': 0.36241609341573605, 'recall': 0.3814396896968871, 'f1-score': 0.3680792923460512, 'support': 8449029}}
[[ 578853 1244799  435177]
 [ 915736 2202069  776375]
 [ 600994 1253153  441873]]
Evaluating performance on  train set...
8838/8838 - 59s - 59s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1663749
{'0': {'precision': 0.3289113539647973, 'recall': 0.39679919015654563, 'f1-score': 0.359679930087118, 'support': 746811}, '1': {'precision': 0.3282682686578505, 'recall': 0.4737643114393888, 'f1-score': 0.3878191338542163, 'support': 747741}, '2': {'precision': 0.35420501416862615, 'recall': 0.13012299353762768, 'f1-score': 0.19032645660092942, 'support': 767520}, 'accuracy': 0.331757344593806, 'macro avg': {'precision': 0.337128212263758, 'recall': 0.3335621650445207, 'f1-score': 0.31260850684742125, 'support': 2262072}, 'weighted avg': {'precision': 0.3372809057868176, 'recall': 0.331757344593806, 'f1-score': 0.3115199503843917, 'support': 2262072}}
[[296334 356402  94075]
 [305474 354253  88014]
 [299146 368502  99872]]
Evaluating performance on  val set...
3279/3279 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1697792
{'0': {'precision': 0.326721596386178, 'recall': 0.33171407752425314, 'f1-score': 0.3291989096181182, 'support': 279964}, '1': {'precision': 0.32732477633633517, 'recall': 0.4707099380022314, 'f1-score': 0.38613614773280197, 'support': 283236}, '2': {'precision': 0.32876526366518016, 'recall': 0.1756983716450774, 'f1-score': 0.22900965475503773, 'support': 275677}, 'accuracy': 0.3273733813181193, 'macro avg': {'precision': 0.32760387879589775, 'recall': 0.32604079572385397, 'f1-score': 0.314781570701986, 'support': 838877}, 'weighted avg': {'precision': 0.3275968550246151, 'recall': 0.3273733813181193, 'f1-score': 0.31549821495341906, 'support': 838877}}
[[ 92868 137913  49183]
 [100206 133322  49708]
 [ 91168 136073  48436]]
testing model out of sample: results/universal/W0/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 145s - 145s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1471721
{'0': {'precision': 0.3517758432269846, 'recall': 0.33872210311012363, 'f1-score': 0.3451255838580265, 'support': 1926290}, '1': {'precision': 0.34176396193441083, 'recall': 0.5954574718089498, 'f1-score': 0.4342749693976812, 'support': 1958689}, '2': {'precision': 0.2909297316796282, 'recall': 0.0844596259517532, 'f1-score': 0.13091376095980828, 'support': 1947984}, 'accuracy': 0.34001912921443184, 'macro avg': {'precision': 0.3281565122803412, 'recall': 0.33954640029027555, 'f1-score': 0.3034381047385053, 'support': 5832963}, 'weighted avg': {'precision': 0.32809364028595184, 'recall': 0.34001912921443184, 'f1-score': 0.30352317993342043, 'support': 5832963}}
[[ 652477 1122602  151211]
 [ 542592 1166316  249781]
 [ 659740 1123718  164526]]
Evaluating performance on  train set...
6334/6334 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1608071
{'0': {'precision': 0.3186459241676319, 'recall': 0.3120107170482529, 'f1-score': 0.3152934157400319, 'support': 535222}, '1': {'precision': 0.32787649850782924, 'recall': 0.5307227015188567, 'f1-score': 0.40533813925568557, 'support': 548373}, '2': {'precision': 0.3558439695970171, 'recall': 0.13854142433068742, 'f1-score': 0.19943603105178198, 'support': 537305}, 'accuracy': 0.32850144981183294, 'macro avg': {'precision': 0.3341221307574927, 'recall': 0.32709161429926564, 'f1-score': 0.30668919534916644, 'support': 1620900}, 'weighted avg': {'precision': 0.3340993719695277, 'recall': 0.32850144981183294, 'f1-score': 0.30735174326704123, 'support': 1620900}}
[[166995 298830  69397]
 [191985 291034  65354]
 [165097 297769  74439]]
Evaluating performance on  val set...
2156/2156 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1522615
{'0': {'precision': 0.30974625675012274, 'recall': 0.22620634796150443, 'f1-score': 0.2614655434761495, 'support': 178514}, '1': {'precision': 0.33525684736901923, 'recall': 0.6252059788166351, 'f1-score': 0.4364657948225703, 'support': 188733}, '2': {'precision': 0.3237152546303006, 'recall': 0.12134200333545195, 'f1-score': 0.17651777070944547, 'support': 184083}, 'accuracy': 0.3277800954056554, 'macro avg': {'precision': 0.3229061195831475, 'recall': 0.32425144337119716, 'f1-score': 0.29148303633605505, 'support': 551330}, 'weighted avg': {'precision': 0.32314321562421444, 'recall': 0.3277800954056554, 'f1-score': 0.2930090502382536, 'support': 551330}}
[[ 40381 115439  22694]
 [ 46765 117997  23971]
 [ 43222 118524  22337]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1674002
{'0': {'precision': 0.3326866912532776, 'recall': 0.4516735887009247, 'f1-score': 0.38315502605557294, 'support': 69103}, '1': {'precision': 0.3230506822612086, 'recall': 0.34095409540954097, 'f1-score': 0.3317610259618392, 'support': 77770}, '2': {'precision': 0.3574610937273349, 'recall': 0.22320850909655549, 'f1-score': 0.2748149977297892, 'support': 77282}, 'accuracy': 0.33449175793535724, 'macro avg': {'precision': 0.3377328224139404, 'recall': 0.33861206440234043, 'f1-score': 0.3299103499157338, 'support': 224155}, 'weighted avg': {'precision': 0.33788498240309306, 'recall': 0.33449175793535724, 'f1-score': 0.32797157952811246, 'support': 224155}}
[[31212 26524 11367]
 [31614 26516 19640]
 [30992 29040 17250]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1474566
{'0': {'precision': 0.3246353476037128, 'recall': 0.25225390984360624, 'f1-score': 0.28390383301236255, 'support': 27175}, '1': {'precision': 0.3242171789715599, 'recall': 0.6184335500840213, 'f1-score': 0.4254105466835869, 'support': 27374}, '2': {'precision': 0.3421552488286691, 'recall': 0.10127815885153117, 'f1-score': 0.1562933826931976, 'support': 26679}, 'accuracy': 0.32606982813808044, 'macro avg': {'precision': 0.33033592513464727, 'recall': 0.3239885395930529, 'f1-score': 0.28853592079638235, 'support': 81228}, 'weighted avg': {'precision': 0.33024876288716254, 'recall': 0.32606982813808044, 'f1-score': 0.28967875761928497, 'support': 81228}}
[[ 6855 17851  2469]
 [ 7719 16929  2726]
 [ 6542 17435  2702]]
Evaluating performance on  val set...
104/104 - 1s - 881ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1704177
{'0': {'precision': 0.3719751471550033, 'recall': 0.5056679262058236, 'f1-score': 0.4286387187941592, 'support': 8998}, '1': {'precision': 0.34535970441208436, 'recall': 0.39287921869205095, 'f1-score': 0.36759007576195707, 'support': 8089}, '2': {'precision': 0.41490413125123543, 'recall': 0.2231554327025303, 'f1-score': 0.29021776702385066, 'support': 9406}, 'accuracy': 0.37092816970520515, 'macro avg': {'precision': 0.37741299427277436, 'recall': 0.37390085920013494, 'f1-score': 0.362148853859989, 'support': 26493}, 'weighted avg': {'precision': 0.3790901476480274, 'recall': 0.37092816970520515, 'f1-score': 0.3608544004519931, 'support': 26493}}
[[4550 2867 1581]
 [3532 3178 1379]
 [4150 3157 2099]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
2359/2359 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1710845
{'0': {'precision': 0.2785088772553352, 'recall': 0.38100087604029786, 'f1-score': 0.3217909233003154, 'support': 182640}, '1': {'precision': 0.32449164117658374, 'recall': 0.37232741608649395, 'f1-score': 0.34676759494920006, 'support': 226513}, '2': {'precision': 0.3335708436579426, 'recall': 0.1611529272741285, 'f1-score': 0.21731689911524044, 'support': 194635}, 'accuracy': 0.30687757954778827, 'macro avg': {'precision': 0.3121904540299538, 'recall': 0.30482707313364016, 'f1-score': 0.295291805788252, 'support': 603788}, 'weighted avg': {'precision': 0.313509042271641, 'recall': 0.30687757954778827, 'f1-score': 0.2974831184548096, 'support': 603788}}
[[ 69586  90372  22682]
 [102193  84337  39983]
 [ 78073  85196  31366]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1615376
{'0': {'precision': 0.3231441048034934, 'recall': 0.34266560750198594, 'f1-score': 0.3326186714812307, 'support': 51613}, '1': {'precision': 0.30042923794712284, 'recall': 0.47740213523131675, 'f1-score': 0.3687831697911496, 'support': 50580}, '2': {'precision': 0.3075838194756074, 'recall': 0.09890336411609499, 'f1-score': 0.14967790238804574, 'support': 48512}, 'accuracy': 0.3094190637337845, 'macro avg': {'precision': 0.31038572074207454, 'recall': 0.3063237022831326, 'f1-score': 0.28369324788680866, 'support': 150705}, 'weighted avg': {'precision': 0.310511620629633, 'recall': 0.3094190637337845, 'f1-score': 0.28586758647586996, 'support': 150705}}
[[17686 29319  4608]
 [20240 24147  6193]
 [16805 26909  4798]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1670499
{'0': {'precision': 0.3353110968569596, 'recall': 0.42407341682299854, 'f1-score': 0.3745046678756129, 'support': 19723}, '1': {'precision': 0.3110116505517783, 'recall': 0.4964550610820244, 'f1-score': 0.3824388194517382, 'support': 18336}, '2': {'precision': 0.3127848925548079, 'recall': 0.06940898800635807, 'f1-score': 0.11360769473352254, 'support': 20761}, 'accuracy': 0.32145528731723905, 'macro avg': {'precision': 0.31970254665451525, 'recall': 0.3299791553037937, 'f1-score': 0.2901837273536245, 'support': 58820}, 'weighted avg': {'precision': 0.3197854053409994, 'recall': 0.32145528731723905, 'f1-score': 0.28489226637777026, 'support': 58820}}
[[ 8364  9719  1640]
 [ 7707  9103  1526]
 [ 8873 10447  1441]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
1625/1625 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1925893
{'0': {'precision': 0.2695667794596933, 'recall': 0.6398141380390518, 'f1-score': 0.37931879441313404, 'support': 114924}, '1': {'precision': 0.3247768192611741, 'recall': 0.18201879990566355, 'f1-score': 0.23329123079746517, 'support': 178086}, '2': {'precision': 0.2908511080812516, 'recall': 0.10245764850497797, 'f1-score': 0.15153448836341307, 'support': 122841}, 'accuracy': 0.2850323793858858, 'macro avg': {'precision': 0.295064902267373, 'recall': 0.3080968621498978, 'f1-score': 0.25471483785800414, 'support': 415851}, 'weighted avg': {'precision': 0.29949750791841373, 'recall': 0.2850323793858858, 'f1-score': 0.24949653443657085, 'support': 415851}}
[[ 73530  28328  13066]
 [128050  32415  17621]
 [ 71191  39064  12586]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.176434
{'0': {'precision': 0.3218130614572936, 'recall': 0.4823928609597093, 'f1-score': 0.38607107727836465, 'support': 37428}, '1': {'precision': 0.32446904247660185, 'recall': 0.39463674921329867, 'f1-score': 0.3561295420591903, 'support': 36545}, '2': {'precision': 0.3929386494831521, 'recall': 0.14113846228029991, 'f1-score': 0.20768070953436807, 'support': 41477}, 'accuracy': 0.3320138588133391, 'macro avg': {'precision': 0.34640691780568256, 'recall': 0.339389357484436, 'f1-score': 0.31662710962397433, 'support': 115450}, 'weighted avg': {'precision': 0.3482066417162728, 'recall': 0.3320138588133391, 'f1-score': 0.3125040726226481, 'support': 115450}}
[[18055 14593  4780]
 [17859 14422  4264]
 [20190 15433  5854]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2005758
{'0': {'precision': 0.3228760922202337, 'recall': 0.3959974176888315, 'f1-score': 0.35571793087450704, 'support': 15490}, '1': {'precision': 0.3180444766739183, 'recall': 0.357954159015167, 'f1-score': 0.3368212217209049, 'support': 14703}, '2': {'precision': 0.3143990811318785, 'recall': 0.2016744809109176, 'f1-score': 0.24572571102134083, 'support': 14930}, 'accuracy': 0.31930501074839884, 'macro avg': {'precision': 0.3184398833420101, 'recall': 0.318542019204972, 'f1-score': 0.3127549545389176, 'support': 45123}, 'weighted avg': {'precision': 0.3184969281813485, 'recall': 0.31930501074839884, 'f1-score': 0.3131670774938989, 'support': 45123}}
[[6134 5810 3546]
 [6420 5263 3020]
 [6444 5475 3011]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2258943
{'0': {'precision': 0.3636554842780524, 'recall': 0.2136150234741784, 'f1-score': 0.26913647507491145, 'support': 97128}, '1': {'precision': 0.328751698455035, 'recall': 0.41674109278810884, 'f1-score': 0.3675537676001857, 'support': 125404}, '2': {'precision': 0.2214507733902264, 'recall': 0.23555246889427967, 'f1-score': 0.22828405395925563, 'support': 102232}, 'accuracy': 0.298955549260386, 'macro avg': {'precision': 0.30461931870777126, 'recall': 0.28863619505218896, 'f1-score': 0.28832476554478426, 'support': 324764}, 'weighted avg': {'precision': 0.3054133565766018, 'recall': 0.298955549260386, 'f1-score': 0.2942793401595384, 'support': 324764}}
[[20748 47520 28860]
 [17342 52261 55801]
 [18964 59187 24081]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.149273
{'0': {'precision': 0.3560909743027132, 'recall': 0.4058772604848018, 'f1-score': 0.3793576228900227, 'support': 41584}, '1': {'precision': 0.314695495942011, 'recall': 0.49495736906211935, 'f1-score': 0.38475959626564654, 'support': 41050}, '2': {'precision': 0.3746847799560726, 'recall': 0.11066528915691598, 'f1-score': 0.17086471046481433, 'support': 41621}, 'accuracy': 0.336421069574665, 'macro avg': {'precision': 0.34849041673359893, 'recall': 0.33716663956794574, 'f1-score': 0.3116606432068279, 'support': 124255}, 'weighted avg': {'precision': 0.34864345427045407, 'recall': 0.336421069574665, 'f1-score': 0.31130456666709216, 'support': 124255}}
[[16878 21064  3642]
 [16687 20318  4045]
 [13833 23182  4606]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1782013
{'0': {'precision': 0.30095585201485353, 'recall': 0.6225905114161747, 'f1-score': 0.40576686832162806, 'support': 14059}, '1': {'precision': 0.3452723067218056, 'recall': 0.3178474641889276, 'f1-score': 0.33099277675121785, 'support': 15498}, '2': {'precision': 0.41632088520055327, 'recall': 0.056568314226649125, 'f1-score': 0.09960291197882196, 'support': 15963}, 'accuracy': 0.3203427065026362, 'macro avg': {'precision': 0.3541830146457375, 'recall': 0.3323354299439171, 'f1-score': 0.27878751901722265, 'support': 45520}, 'weighted avg': {'precision': 0.35650041352170037, 'recall': 0.3203427065026362, 'f1-score': 0.2729429644055817, 'support': 45520}}
[[ 8753  4642   664]
 [ 9970  4926   602]
 [10361  4699   903]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
1733/1733 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1674087
{'0': {'precision': 0.3247721556533434, 'recall': 0.5686094571426539, 'f1-score': 0.413414640453913, 'support': 140571}, '1': {'precision': 0.3503113708003383, 'recall': 0.37409432064641046, 'f1-score': 0.3618124369303049, 'support': 146161}, '2': {'precision': 0.3519374591572476, 'recall': 0.09274779946421738, 'f1-score': 0.1468068673427664, 'support': 156780}, 'accuracy': 0.3362907880733779, 'macro avg': {'precision': 0.3423403285369764, 'recall': 0.3451505257510939, 'f1-score': 0.3073446482423281, 'support': 443512}, 'weighted avg': {'precision': 0.3427915407172019, 'recall': 0.3362907880733779, 'f1-score': 0.3021639948398605, 'support': 443512}}
[[79930 48727 11914]
 [76621 54678 14862]
 [89560 52679 14541]]
Evaluating performance on  train set...
765/765 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1841098
{'0': {'precision': 0.3123987596612209, 'recall': 0.4450598358223717, 'f1-score': 0.36711218676492574, 'support': 60666}, '1': {'precision': 0.325425808524935, 'recall': 0.33819109208488934, 'f1-score': 0.3316856742994968, 'support': 65874}, '2': {'precision': 0.3439992171828367, 'recall': 0.2031376401248122, 'f1-score': 0.25543586855824596, 'support': 69224}, 'accuracy': 0.3235528493492164, 'macro avg': {'precision': 0.32727459512299756, 'recall': 0.3287961893440244, 'f1-score': 0.31807790987422285, 'support': 195764}, 'weighted avg': {'precision': 0.3279565429529632, 'recall': 0.3235528493492164, 'f1-score': 0.31570147011790756, 'support': 195764}}
[[27000 21051 12615]
 [29395 22278 14201]
 [30033 25129 14062]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1770663
{'0': {'precision': 0.3224471387260234, 'recall': 0.5839058371366803, 'f1-score': 0.4154645518561564, 'support': 20815}, '1': {'precision': 0.29811088926432194, 'recall': 0.25999017725588247, 'f1-score': 0.27774862866682565, 'support': 22397}, '2': {'precision': 0.3849439402028831, 'recall': 0.13410211103877986, 'f1-score': 0.19891026967377062, 'support': 21506}, 'accuracy': 0.3223369078154455, 'macro avg': {'precision': 0.33516732273107613, 'recall': 0.3259993751437809, 'f1-score': 0.29737448339891753, 'support': 64718}, 'weighted avg': {'precision': 0.33479296575046197, 'recall': 0.3223369078154455, 'f1-score': 0.29584342752774967, 'support': 64718}}
[[12154  6891  1770]
 [13736  5823  2838]
 [11803  6819  2884]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
4693/4693 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2094816
{'0': {'precision': 0.2613186391234671, 'recall': 0.6435504100971231, 'f1-score': 0.3717039885910215, 'support': 304562}, '1': {'precision': 0.43574540497679104, 'recall': 0.16860494178279942, 'f1-score': 0.24313323896365693, 'support': 580155}, '2': {'precision': 0.2830268591395193, 'recall': 0.2027079548147563, 'f1-score': 0.2362268222315098, 'support': 316475}, 'accuracy': 0.29801230777427756, 'macro avg': {'precision': 0.32669696774659246, 'recall': 0.33828776889822626, 'f1-score': 0.28368801659539605, 'support': 1201192}, 'weighted avg': {'precision': 0.35128316542169025, 'recall': 0.29801230777427756, 'f1-score': 0.27391271169799347, 'support': 1201192}}
[[196001  63068  45493]
 [365319  97817 117019]
 [188726  63597  64152]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1866009
{'0': {'precision': 0.3402034528977534, 'recall': 0.5401437249374678, 'f1-score': 0.41746884618099134, 'support': 125935}, '1': {'precision': 0.3521417104495038, 'recall': 0.30507242368448084, 'f1-score': 0.32692152985659184, 'support': 126547}, '2': {'precision': 0.3675189278092675, 'recall': 0.20692294152310836, 'f1-score': 0.2647721263636186, 'support': 130667}, 'accuracy': 0.3488642799537517, 'macro avg': {'precision': 0.3532880303855082, 'recall': 0.3507130300483523, 'f1-score': 0.33638750080040064, 'support': 383149}, 'weighted avg': {'precision': 0.35346195504356137, 'recall': 0.3488642799537517, 'f1-score': 0.33548791049466453, 'support': 383149}}
[[68023 33117 24795]
 [66205 38606 21736]
 [65720 37909 27038]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1729188
{'0': {'precision': 0.285599282379189, 'recall': 0.2646814315861275, 'f1-score': 0.2747427812811152, 'support': 46913}, '1': {'precision': 0.28895675894383754, 'recall': 0.4732173392612859, 'f1-score': 0.3588139480231116, 'support': 46784}, '2': {'precision': 0.33877096104159277, 'recall': 0.14494104387029652, 'f1-score': 0.20302087286527515, 'support': 46136}, 'accuracy': 0.29494468401593327, 'macro avg': {'precision': 0.3044423341215398, 'recall': 0.29427993823923665, 'f1-score': 0.27885920072316733, 'support': 139833}, 'weighted avg': {'precision': 0.30426586859538385, 'recall': 0.29494468401593327, 'f1-score': 0.2792068455448038, 'support': 139833}}
[[12417 27793  6703]
 [18296 22139  6349]
 [12764 26685  6687]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
6677/6677 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1176102
{'0': {'precision': 0.2995682167849521, 'recall': 0.07905231518770996, 'f1-score': 0.12509390851109026, 'support': 458127}, '1': {'precision': 0.48113696704669684, 'recall': 0.7323617544522775, 'f1-score': 0.5807444327306847, 'support': 841311}, '2': {'precision': 0.21777044237666995, 'recall': 0.16354355761160236, 'f1-score': 0.18680118165096707, 'support': 409848}, 'accuracy': 0.42087046872202777, 'macro avg': {'precision': 0.3328252087361063, 'recall': 0.3249858757505299, 'f1-score': 0.297546507630914, 'support': 1709286}, 'weighted avg': {'precision': 0.3693231510708312, 'recall': 0.42087046872202777, 'f1-score': 0.3641612153652641, 'support': 1709286}}
[[ 36216 348543  73368]
 [ 57771 616144 167396]
 [ 26907 315913  67028]]
Evaluating performance on  train set...
2262/2262 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1845936
{'0': {'precision': 0.3152444605265959, 'recall': 0.45946588764509705, 'f1-score': 0.3739309181112203, 'support': 193405}, '1': {'precision': 0.29760363301994786, 'recall': 0.3251960834572205, 'f1-score': 0.3107886317872943, 'support': 195070}, '2': {'precision': 0.3598715852537862, 'recall': 0.15840679141407243, 'f1-score': 0.21998256422602305, 'support': 190358}, 'accuracy': 0.3152083588876239, 'macro avg': {'precision': 0.3242398929334433, 'recall': 0.31435625417213, 'f1-score': 0.30156737137484585, 'support': 578833}, 'weighted avg': {'precision': 0.32397570768613354, 'recall': 0.3152083588876239, 'f1-score': 0.3020233618003558, 'support': 578833}}
[[ 88863  75456  29086]
 [107083  63436  24551]
 [ 85940  74264  30154]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1502798
{'0': {'precision': 0.2882787216828479, 'recall': 0.173401262261425, 'f1-score': 0.21654780783803546, 'support': 65755}, '1': {'precision': 0.34900201033888567, 'recall': 0.6408992023205221, 'f1-score': 0.4519140034863451, 'support': 75845}, '2': {'precision': 0.31434070634241723, 'recall': 0.14706134583500086, 'f1-score': 0.20037781413102748, 'support': 69964}, 'accuracy': 0.3322871566050935, 'macro avg': {'precision': 0.3172071461213836, 'recall': 0.3204539368056493, 'f1-score': 0.289613208485136, 'support': 211564}, 'weighted avg': {'precision': 0.31866649333983726, 'recall': 0.3322871566050935, 'f1-score': 0.2955784163972844, 'support': 211564}}
[[11402 43688 10665]
 [15458 48609 11778]
 [12692 46983 10289]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
5633/5633 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1644485
{'0': {'precision': 0.26919774713640826, 'recall': 0.6042771354936498, 'f1-score': 0.37246644810467466, 'support': 398491}, '1': {'precision': 0.3959889990030601, 'recall': 0.3286553309430061, 'f1-score': 0.3591938559067364, 'support': 590993}, '2': {'precision': 0.375789677442061, 'recall': 0.04720901956449652, 'f1-score': 0.08388045807253666, 'support': 452350}, 'accuracy': 0.31653227764083797, 'macro avg': {'precision': 0.3469921411938431, 'recall': 0.3267138286670508, 'f1-score': 0.2718469206946493, 'support': 1441834}, 'weighted avg': {'precision': 0.3546095226862914, 'recall': 0.31653227764083797, 'f1-score': 0.27648738139389256, 'support': 1441834}}
[[240799 141427  16265]
 [377553 194233  19207]
 [276154 154841  21355]]
Evaluating performance on  train set...
1454/1454 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1580421
{'0': {'precision': 0.34315510677040223, 'recall': 0.23651269680868403, 'f1-score': 0.2800243147017107, 'support': 122708}, '1': {'precision': 0.33117596937897054, 'recall': 0.6109310356060853, 'f1-score': 0.429517404859447, 'support': 122788}, '2': {'precision': 0.3507293886248156, 'recall': 0.16902187221068096, 'f1-score': 0.22811272380322906, 'support': 126599}, 'accuracy': 0.3371047716309007, 'macro avg': {'precision': 0.34168682159139613, 'recall': 0.3388218682084834, 'f1-score': 0.31255148112146225, 'support': 372095}, 'weighted avg': {'precision': 0.34177911995646426, 'recall': 0.3371047716309007, 'f1-score': 0.3116936519895841, 'support': 372095}}
[[29022 74472 19214]
 [27375 75015 20398]
 [28177 77024 21398]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.139585
{'0': {'precision': 0.40109972883398615, 'recall': 0.1090897916538627, 'f1-score': 0.17152796791702235, 'support': 48813}, '1': {'precision': 0.32162624969730513, 'recall': 0.8034958084867341, 'f1-score': 0.4593729927367954, 'support': 46284}, '2': {'precision': 0.3033982379506922, 'recall': 0.0866128418649871, 'f1-score': 0.13475608753555515, 'support': 47314}, 'accuracy': 0.3273061771913686, 'macro avg': {'precision': 0.3420414054939945, 'recall': 0.33306614733519463, 'f1-score': 0.2552190160631243, 'support': 142411}, 'weighted avg': {'precision': 0.34281070026165456, 'recall': 0.3273061771913686, 'f1-score': 0.25286153330445477, 'support': 142411}}
[[ 5325 38948  4540]
 [ 4226 37189  4869]
 [ 3725 39491  4098]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
11876/11876 - 62s - 62s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1531657
{'0': {'precision': 0.38502335422038075, 'recall': 0.3777852592550489, 'f1-score': 0.3813699665258965, 'support': 1143565}, '1': {'precision': 0.24325970480915, 'recall': 0.6096698030784458, 'f1-score': 0.3477616730489766, 'support': 715361}, '2': {'precision': 0.424292034691498, 'recall': 0.04497757851329924, 'f1-score': 0.08133332210699061, 'support': 1181233}, 'accuracy': 0.3030384266086083, 'macro avg': {'precision': 0.35085836457367625, 'recall': 0.34414421361559794, 'f1-score': 0.27015498722728787, 'support': 3040159}, 'weighted avg': {'precision': 0.36692340459026995, 'recall': 0.3030384266086083, 'f1-score': 0.2568846195335779, 'support': 3040159}}
[[432022 669726  41817]
 [248955 436134  30272]
 [441090 687014  53129]]
Evaluating performance on  train set...
2538/2538 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1314329
{'0': {'precision': 0.33084724005134786, 'recall': 0.11901749265751704, 'f1-score': 0.17505977286312013, 'support': 216548}, '1': {'precision': 0.341221018337595, 'recall': 0.7797413985951411, 'f1-score': 0.47470664502140913, 'support': 223510}, '2': {'precision': 0.3495432254678454, 'recall': 0.10169540051630266, 'f1-score': 0.15755272826737834, 'support': 209567}, 'accuracy': 0.3407581296902059, 'macro avg': {'precision': 0.3405371612855961, 'recall': 0.333484763922987, 'f1-score': 0.26910638205063586, 'support': 649625}, 'weighted avg': {'precision': 0.340447709184368, 'recall': 0.3407581296902059, 'f1-score': 0.2725085680623556, 'support': 649625}}
[[ 25773 170492  20283]
 [ 29854 174280  19376]
 [ 22273 165982  21312]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336229
{'0': {'precision': 0.2792054975054128, 'recall': 0.0879388045540797, 'f1-score': 0.13375121192306824, 'support': 67456}, '1': {'precision': 0.32870973692510014, 'recall': 0.8159647852996351, 'f1-score': 0.4686320254506893, 'support': 67699}, '2': {'precision': 0.2860275910859568, 'recall': 0.05921466965449566, 'f1-score': 0.09811677910983838, 'support': 68277}, 'accuracy': 0.3205739510008258, 'macro avg': {'precision': 0.2979809418388233, 'recall': 0.32103941983607015, 'f1-score': 0.23350000549453198, 'support': 203432}, 'weighted avg': {'precision': 0.297969406761932, 'recall': 0.3205739510008258, 'f1-score': 0.23323449884851516, 'support': 203432}}
[[ 5932 56373  5151]
 [ 7518 55240  4941]
 [ 7796 56438  4043]]
testing model on single stock: results/universal/W0/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
19053/19053 - 108s - 108s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1206057
{'0': {'precision': 0.35774052800176737, 'recall': 0.040609463263553205, 'f1-score': 0.0729391296514214, 'support': 1276008}, '1': {'precision': 0.4972163816187207, 'recall': 0.7474879961537083, 'f1-score': 0.5971912421744962, 'support': 2371115}, '2': {'precision': 0.25777612632898345, 'recall': 0.24471685599287343, 'f1-score': 0.25107679272959554, 'support': 1230328}, 'accuracy': 0.43573579724327316, 'macro avg': {'precision': 0.3709110119831572, 'recall': 0.344271438470045, 'f1-score': 0.3070690548518377, 'support': 4877451}, 'weighted avg': {'precision': 0.4003292257186054, 'recall': 0.43573579724327316, 'f1-score': 0.37273297740607736, 'support': 4877451}}
[[  51818  902154  322036]
 [  53855 1772380  544880]
 [  39175  890071  301082]]
Evaluating performance on  train set...
4812/4812 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1654994
{'0': {'precision': 0.32007150787673627, 'recall': 0.4071822426791054, 'f1-score': 0.35840979656776717, 'support': 404971}, '1': {'precision': 0.3275408567998674, 'recall': 0.4809280783527052, 'f1-score': 0.3896837293149211, 'support': 406776}, '2': {'precision': 0.3507968277629364, 'recall': 0.0997069891769276, 'f1-score': 0.1552790195947599, 'support': 420121}, 'accuracy': 0.3266713641396643, 'macro avg': {'precision': 0.33280306414651334, 'recall': 0.32927243673624607, 'f1-score': 0.3011241818258161, 'support': 1231868}, 'weighted avg': {'precision': 0.3330166480974952, 'recall': 0.3266713641396643, 'f1-score': 0.29946028258938595, 'support': 1231868}}
[[164897 198237  41837]
 [175461 195630  35685]
 [174830 203402  41889]]
Evaluating performance on  val set...
1767/1767 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.177576
{'0': {'precision': 0.33400266967388553, 'recall': 0.3858337321210188, 'f1-score': 0.3580521803491025, 'support': 150456}, '1': {'precision': 0.34883260437838876, 'recall': 0.3831348267171569, 'f1-score': 0.36517996226081495, 'support': 156334}, '2': {'precision': 0.3260755558052855, 'recall': 0.23930090788506078, 'f1-score': 0.2760290940801078, 'support': 145503}, 'accuracy': 0.3377611415608908, 'macro avg': {'precision': 0.3363036099525199, 'recall': 0.3360898222410788, 'f1-score': 0.3330870788966751, 'support': 452293}, 'weighted avg': {'precision': 0.336578442818442, 'recall': 0.3377611415608908, 'f1-score': 0.3341289923625277, 'support': 452293}}
[[58051 56653 35752]
 [60226 59897 36211]
 [55527 55157 34819]]
training model: results/universal/W0/deepOF_L1/h300
Epoch 1/50
8838/8838 - 133s - loss: 3.2801 - accuracy300: 0.3715 - val_loss: 3.2891 - val_accuracy300: 0.3599 - 133s/epoch - 15ms/step
Epoch 2/50
8838/8838 - 132s - loss: 3.2809 - accuracy300: 0.3691 - val_loss: 3.2879 - val_accuracy300: 0.3619 - 132s/epoch - 15ms/step
Epoch 3/50
8838/8838 - 129s - loss: 3.2802 - accuracy300: 0.3701 - val_loss: 3.2877 - val_accuracy300: 0.3620 - 129s/epoch - 15ms/step
Epoch 4/50
8838/8838 - 130s - loss: 3.2790 - accuracy300: 0.3710 - val_loss: 3.2871 - val_accuracy300: 0.3618 - 130s/epoch - 15ms/step
Epoch 5/50
8838/8838 - 132s - loss: 3.2776 - accuracy300: 0.3722 - val_loss: 3.2872 - val_accuracy300: 0.3617 - 132s/epoch - 15ms/step
Epoch 6/50
8838/8838 - 132s - loss: 3.2765 - accuracy300: 0.3729 - val_loss: 3.2871 - val_accuracy300: 0.3610 - 132s/epoch - 15ms/step
Epoch 7/50
8838/8838 - 133s - loss: 3.2757 - accuracy300: 0.3737 - val_loss: 3.2876 - val_accuracy300: 0.3606 - 133s/epoch - 15ms/step
Epoch 8/50
8838/8838 - 133s - loss: 3.2745 - accuracy300: 0.3746 - val_loss: 3.2874 - val_accuracy300: 0.3603 - 133s/epoch - 15ms/step
Epoch 9/50
8838/8838 - 130s - loss: 3.2730 - accuracy300: 0.3759 - val_loss: 3.2879 - val_accuracy300: 0.3595 - 130s/epoch - 15ms/step
Epoch 10/50
8838/8838 - 133s - loss: 3.2718 - accuracy300: 0.3769 - val_loss: 3.2873 - val_accuracy300: 0.3594 - 133s/epoch - 15ms/step
Epoch 11/50
8838/8838 - 128s - loss: 3.2703 - accuracy300: 0.3787 - val_loss: 3.2871 - val_accuracy300: 0.3600 - 128s/epoch - 14ms/step
Epoch 12/50
8838/8838 - 135s - loss: 3.2689 - accuracy300: 0.3800 - val_loss: 3.2877 - val_accuracy300: 0.3591 - 135s/epoch - 15ms/step
Epoch 13/50
8838/8838 - 131s - loss: 3.2677 - accuracy300: 0.3811 - val_loss: 3.2875 - val_accuracy300: 0.3598 - 131s/epoch - 15ms/step
Epoch 14/50
8838/8838 - 126s - loss: 3.2666 - accuracy300: 0.3824 - val_loss: 3.2875 - val_accuracy300: 0.3600 - 126s/epoch - 14ms/step
Epoch 15/50
8838/8838 - 129s - loss: 3.2653 - accuracy300: 0.3835 - val_loss: 3.2876 - val_accuracy300: 0.3591 - 129s/epoch - 15ms/step
Epoch 16/50
8838/8838 - 129s - loss: 3.2643 - accuracy300: 0.3845 - val_loss: 3.2884 - val_accuracy300: 0.3587 - 129s/epoch - 15ms/step
Epoch 17/50
8838/8838 - 127s - loss: 3.2634 - accuracy300: 0.3851 - val_loss: 3.2879 - val_accuracy300: 0.3602 - 127s/epoch - 14ms/step
Epoch 18/50
8838/8838 - 130s - loss: 3.2622 - accuracy300: 0.3862 - val_loss: 3.2878 - val_accuracy300: 0.3604 - 130s/epoch - 15ms/step
Epoch 19/50
8838/8838 - 129s - loss: 3.2611 - accuracy300: 0.3870 - val_loss: 3.2886 - val_accuracy300: 0.3594 - 129s/epoch - 15ms/step
Epoch 20/50
8838/8838 - 128s - loss: 3.2603 - accuracy300: 0.3874 - val_loss: 3.2895 - val_accuracy300: 0.3598 - 128s/epoch - 14ms/step
Epoch 21/50
8838/8838 - 125s - loss: 3.2591 - accuracy300: 0.3884 - val_loss: 3.2896 - val_accuracy300: 0.3598 - 125s/epoch - 14ms/step
testing model in sample: results/universal/W0/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 193s - 193s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946339
{'0': {'precision': 0.32741942919245814, 'recall': 0.3375664077303204, 'f1-score': 0.33241550239646644, 'support': 2377547}, '1': {'precision': 0.4325303941735558, 'recall': 0.0944401665017908, 'f1-score': 0.15503045327802056, 'support': 3649210}, '2': {'precision': 0.3110042041963517, 'recall': 0.6677811965501453, 'f1-score': 0.42436832313185424, 'support': 2422247}, 'accuracy': 0.327227090909177, 'macro avg': {'precision': 0.3569846758541219, 'recall': 0.3665959235940855, 'f1-score': 0.3039380929354471, 'support': 8449004}, 'weighted avg': {'precision': 0.3681118297425736, 'recall': 0.327227090909177, 'f1-score': 0.28216308791948275, 'support': 8449004}}
[[ 802580  224999 1349968]
 [1071083  344632 2233495]
 [ 577566  227150 1617531]]
Evaluating performance on  train set...
8838/8838 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950509
{'0': {'precision': 0.3716687331235379, 'recall': 0.34654853174597877, 'f1-score': 0.3586693332504344, 'support': 749087}, '1': {'precision': 0.33801008033779756, 'recall': 0.09786601106988366, 'f1-score': 0.15178487150895933, 'support': 747614}, '2': {'precision': 0.36069708799410904, 'recall': 0.6348761701933064, 'f1-score': 0.46003241638390696, 'support': 765365}, 'accuracy': 0.3619138433626605, 'macro avg': {'precision': 0.35679196715181477, 'recall': 0.3597635710030563, 'f1-score': 0.32349554038110023, 'support': 2262066}, 'weighted avg': {'precision': 0.35683229898844027, 'recall': 0.3619138433626605, 'f1-score': 0.32458988381883475, 'support': 2262066}}
[[259595  70515 418977]
 [232190  73166 442258]
 [206673  72780 485912]]
Evaluating performance on  val set...
3279/3279 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954893
{'0': {'precision': 0.37503767738512916, 'recall': 0.33198501552877896, 'f1-score': 0.35220054574893284, 'support': 281091}, '1': {'precision': 0.33201604984665367, 'recall': 0.09960034765026965, 'f1-score': 0.15323289004761081, 'support': 274989}, '2': {'precision': 0.3577778303169293, 'recall': 0.6421388006817683, 'f1-score': 0.4595243638277628, 'support': 282794}, 'accuracy': 0.3603640117586193, 'macro avg': {'precision': 0.3549438525162374, 'recall': 0.35790805462027225, 'f1-score': 0.3216525998747688, 'support': 838874}, 'weighted avg': {'precision': 0.35511638345185387, 'recall': 0.3603640117586193, 'f1-score': 0.323157584751374, 'support': 838874}}
[[ 93318  27122 160651]
 [ 82286  27389 165314]
 [ 73219  27982 181593]]
testing model out of sample: results/universal/W0/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 122s - 122s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947319
{'0': {'precision': 0.3847938893468596, 'recall': 0.32367370496849596, 'f1-score': 0.35159734845598717, 'support': 1995936}, '1': {'precision': 0.32487361245995083, 'recall': 0.09739771003707762, 'f1-score': 0.14986547378099482, 'support': 1837497}, '2': {'precision': 0.3686289409624748, 'recall': 0.6642769085348624, 'f1-score': 0.4741413622900861, 'support': 1999505}, 'accuracy': 0.36914930348993935, 'macro avg': {'precision': 0.3594321475897617, 'recall': 0.3617827745134787, 'f1-score': 0.32520139484235605, 'support': 5832938}, 'weighted avg': {'precision': 0.3603764818348676, 'recall': 0.36914930348993935, 'f1-score': 0.33005514345769565, 'support': 5832938}}
[[ 646032  186586 1163318]
 [ 546923  178968 1111606]
 [ 485949  185331 1328225]]
Evaluating performance on  train set...
6334/6334 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962162
{'0': {'precision': 0.37023994631008655, 'recall': 0.34593482152296995, 'f1-score': 0.35767495728726795, 'support': 548586}, '1': {'precision': 0.33117669446078263, 'recall': 0.09107152711309348, 'f1-score': 0.14285799568978383, 'support': 525521}, '2': {'precision': 0.35945793958107664, 'recall': 0.6336073593825726, 'f1-score': 0.45869127869989784, 'support': 546785}, 'accuracy': 0.3603460316911923, 'macro avg': {'precision': 0.35362486011731525, 'recall': 0.356871236006212, 'f1-score': 0.31974141055898325, 'support': 1620892}, 'weighted avg': {'precision': 0.35393781222316417, 'recall': 0.3603460316911923, 'f1-score': 0.3221040400564675, 'support': 1620892}}
[[189775  48136 310675]
 [170979  47860 306682]
 [151819  48519 346447]]
Evaluating performance on  val set...
2156/2156 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956147
{'0': {'precision': 0.3626729814147107, 'recall': 0.3725858206696131, 'f1-score': 0.3675625780528859, 'support': 181687}, '1': {'precision': 0.33752399826593177, 'recall': 0.08829580986428907, 'f1-score': 0.13997448783035263, 'support': 185173}, '2': {'precision': 0.35938349839992917, 'recall': 0.6160893370195696, 'f1-score': 0.45395900987805216, 'support': 184470}, 'accuracy': 0.35857653311084103, 'macro avg': {'precision': 0.35319349269352385, 'recall': 0.3589903225178239, 'f1-score': 0.32049869192043023, 'support': 551330}, 'weighted avg': {'precision': 0.35312566204455925, 'recall': 0.35857653311084103, 'f1-score': 0.3200309370175917, 'support': 551330}}
[[ 67694  15775  98218]
 [ 64455  16350 104368]
 [ 54504  16316 113650]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956101
{'0': {'precision': 0.330546989125142, 'recall': 0.18998087597369281, 'f1-score': 0.24128432214685583, 'support': 64317}, '1': {'precision': 0.41217823923858965, 'recall': 0.08275697332276523, 'f1-score': 0.13783874205419874, 'support': 92101}, '2': {'precision': 0.30731155004386695, 'recall': 0.7653841611055335, 'f1-score': 0.43854261834669916, 'support': 67732}, 'accuracy': 0.3197947802810618, 'macro avg': {'precision': 0.3500122594691995, 'recall': 0.34604067013399725, 'f1-score': 0.27255522751591793, 'support': 224150}, 'weighted avg': {'precision': 0.3570673415982436, 'recall': 0.3197947802810618, 'f1-score': 0.25838562728222936, 'support': 224150}}
[[12219  5262 46836]
 [14464  7622 70015]
 [10283  5608 51841]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979086
{'0': {'precision': 0.39267241379310347, 'recall': 0.1953957246014156, 'f1-score': 0.2609442879648637, 'support': 27974}, '1': {'precision': 0.3074292228766863, 'recall': 0.06268402293506896, 'f1-score': 0.1041351568785197, 'support': 25812}, '2': {'precision': 0.34673285838625445, 'recall': 0.7839935857720762, 'f1-score': 0.4808171567148333, 'support': 27439}, 'accuracy': 0.3520590951061865, 'macro avg': {'precision': 0.34894483168534807, 'recall': 0.34735777776952026, 'f1-score': 0.2819655338527389, 'support': 81225}, 'weighted avg': {'precision': 0.35006443958881794, 'recall': 0.3520590951061865, 'f1-score': 0.2853891553582734, 'support': 81225}}
[[ 5466  1896 20612]
 [ 4276  1618 19918]
 [ 4178  1749 21512]]
Evaluating performance on  val set...
104/104 - 1s - 730ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958766
{'0': {'precision': 0.3686382393397524, 'recall': 0.195003638127577, 'f1-score': 0.25507614213197977, 'support': 8246}, '1': {'precision': 0.36817920735209647, 'recall': 0.06371769383697813, 'f1-score': 0.10863486145241928, 'support': 10060}, '2': {'precision': 0.3249141736145169, 'recall': 0.8092097227311592, 'f1-score': 0.46365958638065574, 'support': 8187}, 'accuracy': 0.3349564035783037, 'macro avg': {'precision': 0.3539105401021219, 'recall': 0.3559770182319048, 'f1-score': 0.27579019665501825, 'support': 26493}, 'weighted avg': {'precision': 0.35495210383647524, 'recall': 0.3349564035783037, 'f1-score': 0.2639265318359593, 'support': 26493}}
[[1608  572 6066]
 [1720  641 7699]
 [1034  528 6625]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
2359/2359 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0891558
{'0': {'precision': 0.3860573949060004, 'recall': 0.3061713121703843, 'f1-score': 0.34150475980883443, 'support': 187529}, '1': {'precision': 0.3166375739259568, 'recall': 0.12686590534249148, 'f1-score': 0.18115083357554346, 'support': 191596}, '2': {'precision': 0.40906916067704135, 'recall': 0.6888158890402301, 'f1-score': 0.513302075956421, 'support': 224658}, 'accuracy': 0.3916489864736172, 'macro avg': {'precision': 0.3705880431696662, 'recall': 0.373951035517702, 'f1-score': 0.3453192231135997, 'support': 603783}, 'weighted avg': {'precision': 0.3725909959747587, 'recall': 0.3916489864736172, 'f1-score': 0.3545433359206012, 'support': 603783}}
[[ 57416  23668 106445]
 [ 50189  24307 117100]
 [ 41119  28791 154748]]
Evaluating performance on  train set...
589/589 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935749
{'0': {'precision': 0.3823811114823477, 'recall': 0.3380927997479124, 'f1-score': 0.35887573036761405, 'support': 50776}, '1': {'precision': 0.33923565688656326, 'recall': 0.14317545450960287, 'f1-score': 0.20136443051665326, 'support': 50714}, '2': {'precision': 0.3545050648658255, 'recall': 0.6079977242248141, 'f1-score': 0.44787043758746886, 'support': 49214}, 'accuracy': 0.3606407261917401, 'macro avg': {'precision': 0.3587072777449121, 'recall': 0.36308865949410984, 'f1-score': 0.33603686615724543, 'support': 150704}, 'weighted avg': {'precision': 0.3587588430451719, 'recall': 0.3606407261917401, 'f1-score': 0.3349331506117768, 'support': 150704}}
[[17167  6775 26834]
 [15804  7261 27649]
 [11924  7368 29922]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931034
{'0': {'precision': 0.38740977399124366, 'recall': 0.33258837870784236, 'f1-score': 0.3579119978136103, 'support': 19688}, '1': {'precision': 0.2977705147659624, 'recall': 0.14594656444876708, 'f1-score': 0.19588420486830987, 'support': 17479}, '2': {'precision': 0.3941529235382309, 'recall': 0.6071032699057823, 'f1-score': 0.47798261881386134, 'support': 21652}, 'accuracy': 0.37817711963821216, 'macro avg': {'precision': 0.3597777374318123, 'recall': 0.36187940435413063, 'f1-score': 0.34392627383192714, 'support': 58819}, 'weighted avg': {'precision': 0.3632542810721644, 'recall': 0.37817711963821216, 'f1-score': 0.3539623436713524, 'support': 58819}}
[[ 6548  2734 10406]
 [ 5129  2551  9799]
 [ 5225  3282 13145]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
1625/1625 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983608
{'0': {'precision': 0.288798419089788, 'recall': 0.3338256762559038, 'f1-score': 0.309683895226563, 'support': 116450}, '1': {'precision': 0.4348401853969783, 'recall': 0.12379826230013881, 'f1-score': 0.1927273697409492, 'support': 175059}, '2': {'precision': 0.3093288274467267, 'recall': 0.575685435550158, 'f1-score': 0.40242538047664295, 'support': 124337}, 'accuracy': 0.31772579272134394, 'macro avg': {'precision': 0.34432247731116433, 'recall': 0.34443645803540024, 'f1-score': 0.30161221514805175, 'support': 415846}, 'weighted avg': {'precision': 0.3564162751034255, 'recall': 0.31772579272134394, 'f1-score': 0.2881781110096969, 'support': 415846}}
[[38874 13218 64358]
 [57923 21672 95464]
 [37809 14949 71579]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964884
{'0': {'precision': 0.3497489022690821, 'recall': 0.3552220471599861, 'f1-score': 0.35246422893481716, 'support': 37447}, '1': {'precision': 0.34567249698431846, 'recall': 0.12002932013927066, 'f1-score': 0.17818626974719703, 'support': 38199}, '2': {'precision': 0.36513850134838116, 'recall': 0.5885131400432139, 'f1-score': 0.4506652044674036, 'support': 39802}, 'accuracy': 0.3578320975677361, 'macro avg': {'precision': 0.3535199668672606, 'recall': 0.35458816911415686, 'f1-score': 0.32710523438313927, 'support': 115448}, 'weighted avg': {'precision': 0.35370585446471625, 'recall': 0.3578320975677361, 'f1-score': 0.32865568712499893, 'support': 115448}}
[[13302  4011 20134]
 [13021  4585 20593]
 [11710  4668 23424]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961605
{'0': {'precision': 0.38148632654332526, 'recall': 0.3965293965293965, 'f1-score': 0.3888624313426675, 'support': 15444}, '1': {'precision': 0.34806525037936265, 'recall': 0.12386095173810327, 'f1-score': 0.18270523223975704, 'support': 14815}, '2': {'precision': 0.35150012606101355, 'recall': 0.5627691065662002, 'f1-score': 0.4327246391805908, 'support': 14864}, 'accuracy': 0.3617667265031137, 'macro avg': {'precision': 0.3603505676612338, 'recall': 0.36105315161123325, 'f1-score': 0.3347641009210051, 'support': 45123}, 'weighted avg': {'precision': 0.36063558241420735, 'recall': 0.3617667265031137, 'f1-score': 0.33562459149587703, 'support': 45123}}
[[6124 1702 7618]
 [5165 1835 7815]
 [4764 1735 8365]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1269/1269 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973742
{'0': {'precision': 0.33202142968601, 'recall': 0.3794709204399088, 'f1-score': 0.3541639695955318, 'support': 100930}, '1': {'precision': 0.3662401394239589, 'recall': 0.13653344731780295, 'f1-score': 0.19891271180635559, 'support': 116975}, '2': {'precision': 0.3451570293793012, 'recall': 0.5355531847193367, 'f1-score': 0.41977473033291646, 'support': 106854}, 'accuracy': 0.3433222789822607, 'macro avg': {'precision': 0.3478061994964234, 'recall': 0.3505191841590161, 'f1-score': 0.3242838039116013, 'support': 324759}, 'weighted avg': {'precision': 0.3486686201910415, 'recall': 0.3433222789822607, 'f1-score': 0.31983160728361315, 'support': 324759}}
[[38300 13537 49093]
 [41526 15971 59478]
 [35528 14100 57226]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962554
{'0': {'precision': 0.36694519537970016, 'recall': 0.3624029126213592, 'f1-score': 0.3646599096348761, 'support': 41200}, '1': {'precision': 0.3328328328328328, 'recall': 0.129695994539116, 'f1-score': 0.1866568426223181, 'support': 41019}, '2': {'precision': 0.3578869488014205, 'recall': 0.5753776614725824, 'f1-score': 0.4412899694384892, 'support': 42035}, 'accuracy': 0.35763033785632653, 'macro avg': {'precision': 0.3525549923379845, 'recall': 0.3558255228776859, 'f1-score': 0.3308689072318945, 'support': 124254}, 'weighted avg': {'precision': 0.3526195527909068, 'recall': 0.35763033785632653, 'f1-score': 0.3318210212132298, 'support': 124254}}
[[14931  5245 21024]
 [13329  5320 22370]
 [12430  5419 24186]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974065
{'0': {'precision': 0.343523356468845, 'recall': 0.3006825938566553, 'f1-score': 0.3206784843300695, 'support': 14650}, '1': {'precision': 0.32540329151051, 'recall': 0.1344509526694944, 'f1-score': 0.19028108623153883, 'support': 14853}, '2': {'precision': 0.37237847810535035, 'recall': 0.6175074925074925, 'f1-score': 0.46459189665296535, 'support': 16016}, 'accuracy': 0.3579164744392451, 'macro avg': {'precision': 0.34710170869490176, 'recall': 0.35088034634454734, 'f1-score': 0.32518382240485794, 'support': 45519}, 'weighted avg': {'precision': 0.34776348264262125, 'recall': 0.3579164744392451, 'f1-score': 0.3287657590462545, 'support': 45519}}
[[4405 2066 8179]
 [4366 1997 8490]
 [4052 2074 9890]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
1733/1733 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967807
{'0': {'precision': 0.3595137196349238, 'recall': 0.3323454985859078, 'f1-score': 0.34539618250025483, 'support': 147798}, '1': {'precision': 0.324762499442487, 'recall': 0.10441222862714732, 'f1-score': 0.15802037782528022, 'support': 139476}, '2': {'precision': 0.37016287838312295, 'recall': 0.6208419476038993, 'f1-score': 0.4637972214053635, 'support': 156233}, 'accuracy': 0.3622919142200687, 'macro avg': {'precision': 0.35147969915351124, 'recall': 0.3525332249389848, 'f1-score': 0.3224045939102995, 'support': 443507}, 'weighted avg': {'precision': 0.3523363556500196, 'recall': 0.3622919142200687, 'f1-score': 0.32817823955553266, 'support': 443507}}
[[49120 14350 84328]
 [44201 14563 80712]
 [43308 15929 96996]]
Evaluating performance on  train set...
765/765 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985731
{'0': {'precision': 0.33460423711269066, 'recall': 0.30557262371791843, 'f1-score': 0.3194301478157039, 'support': 63471}, '1': {'precision': 0.3604096241797574, 'recall': 0.1121388356122007, 'f1-score': 0.17105511513778784, 'support': 64652}, '2': {'precision': 0.3598789979946297, 'recall': 0.6261291228692657, 'f1-score': 0.4570565223256442, 'support': 67641}, 'accuracy': 0.3524498886414254, 'macro avg': {'precision': 0.35163095309569264, 'recall': 0.34794686073312825, 'f1-score': 0.31584726175971195, 'support': 195764}, 'weighted avg': {'precision': 0.35185960574775754, 'recall': 0.3524498886414254, 'f1-score': 0.31798168428581197, 'support': 195764}}
[[19395  6169 37907]
 [19977  7250 37425]
 [18592  6697 42352]]
Evaluating performance on  val set...
253/253 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989722
{'0': {'precision': 0.3379260734838424, 'recall': 0.2897196261682243, 'f1-score': 0.31197159714949807, 'support': 21079}, '1': {'precision': 0.3524774774774775, 'recall': 0.09978140085617998, 'f1-score': 0.1555334705757081, 'support': 21958}, '2': {'precision': 0.3455107593371259, 'recall': 0.6442968497763019, 'f1-score': 0.4498076025180725, 'support': 21681}, 'accuracy': 0.34406193022034054, 'macro avg': {'precision': 0.34530477009948196, 'recall': 0.34459929226690206, 'f1-score': 0.30577089008109287, 'support': 64718}, 'weighted avg': {'precision': 0.34540410591496323, 'recall': 0.34406193022034054, 'f1-score': 0.30507017944636733, 'support': 64718}}
[[ 6107  1965 13007]
 [ 6313  2191 13454]
 [ 5652  2060 13969]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/EXC
Evaluating performance on  test set...
4693/4693 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0880879
{'0': {'precision': 0.3819965491742667, 'recall': 0.4088299848049975, 'f1-score': 0.39495802602539337, 'support': 379072}, '1': {'precision': 0.38132827708823297, 'recall': 0.15687095960355799, 'f1-score': 0.22229437974866223, 'support': 432043}, '2': {'precision': 0.3778516656333518, 'recall': 0.5983997826042372, 'f1-score': 0.4632133554932652, 'support': 390072}, 'accuracy': 0.3797660147837098, 'macro avg': {'precision': 0.3803921639652838, 'recall': 0.38803357567093083, 'f1-score': 0.36015525375577356, 'support': 1201187}, 'weighted avg': {'precision': 0.38041018061596726, 'recall': 0.3797660147837098, 'f1-score': 0.35501950949787014, 'support': 1201187}}
[[154976  53221 170875]
 [150809  67775 213459]
 [ 99915  56738 233419]]
Evaluating performance on  train set...
1497/1497 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899212
{'0': {'precision': 0.3914920385295852, 'recall': 0.3926374562316646, 'f1-score': 0.39206391079577446, 'support': 126804}, '1': {'precision': 0.3464801898324585, 'recall': 0.1524130350548399, 'f1-score': 0.21170100007139445, 'support': 126459}, '2': {'precision': 0.38311911951883004, 'recall': 0.5909535358201486, 'f1-score': 0.4648638827483875, 'support': 129885}, 'accuracy': 0.3805787841773936, 'macro avg': {'precision': 0.37369711596029126, 'recall': 0.37866800903555103, 'f1-score': 0.3562095978718521, 'support': 383148}, 'weighted avg': {'precision': 0.3737973880026299, 'recall': 0.3805787841773936, 'f1-score': 0.3572134379491742, 'support': 383148}}
[[49788 17604 59412]
 [43008 19274 64177]
 [34379 18750 76756]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0886422
{'0': {'precision': 0.41229193341869397, 'recall': 0.44094945638642213, 'f1-score': 0.4261394397545668, 'support': 48196}, '1': {'precision': 0.3191499900931246, 'recall': 0.1480094645195378, 'f1-score': 0.2022316734412028, 'support': 43531}, '2': {'precision': 0.39466071454793755, 'recall': 0.5586829085768927, 'f1-score': 0.4625618518996601, 'support': 48106}, 'accuracy': 0.39025837963856885, 'macro avg': {'precision': 0.3753675460199187, 'recall': 0.38254727649428427, 'f1-score': 0.3636443216984766, 'support': 139833}, 'weighted avg': {'precision': 0.37723061491803983, 'recall': 0.39025837963856885, 'f1-score': 0.3689655793873059, 'support': 139833}}
[[21252  6333 20611]
 [16476  6443 20612]
 [13818  7412 26876]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/AAL
Evaluating performance on  test set...
6677/6677 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930446
{'0': {'precision': 0.37406862435343075, 'recall': 0.3824052712205386, 'f1-score': 0.37819101118468185, 'support': 541810}, '1': {'precision': 0.4058976110865898, 'recall': 0.09850924987050035, 'f1-score': 0.15854133750876773, 'support': 681469}, '2': {'precision': 0.31619877435210053, 'recall': 0.6441105180637117, 'f1-score': 0.424169500321475, 'support': 486002}, 'accuracy': 0.34363045046425955, 'macro avg': {'precision': 0.36538833659737363, 'recall': 0.3750083463849168, 'f1-score': 0.3203006163383082, 'support': 1709281}, 'weighted avg': {'precision': 0.3703042374092786, 'recall': 0.34363045046425955, 'f1-score': 0.3036925490869976, 'support': 1709281}}
[[207191  51766 282853]
 [220223  67131 394115]
 [126471  46492 313039]]
Evaluating performance on  train set...
2262/2262 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953985
{'0': {'precision': 0.37732902935215074, 'recall': 0.381194100784169, 'f1-score': 0.3792517177895594, 'support': 197789}, '1': {'precision': 0.3224082385146837, 'recall': 0.09250522288773597, 'f1-score': 0.14376224798219683, 'support': 187157}, '2': {'precision': 0.3616134416584439, 'recall': 0.6067462671171056, 'f1-score': 0.45315310803887504, 'support': 193885}, 'accuracy': 0.3634014073192348, 'macro avg': {'precision': 0.35378356984175946, 'recall': 0.3601485302630035, 'f1-score': 0.3253890246035438, 'support': 578831}, 'weighted avg': {'precision': 0.354307064096727, 'recall': 0.3634014073192348, 'f1-score': 0.32786343407246754, 'support': 578831}}
[[ 75396  18378 104015]
 [ 66181  17313 103663]
 [ 58238  18008 117639]]
Evaluating performance on  val set...
827/827 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094473
{'0': {'precision': 0.3610050652493949, 'recall': 0.42286783188168586, 'f1-score': 0.3894953628299525, 'support': 68428}, '1': {'precision': 0.3421584478577203, 'recall': 0.09308079280864283, 'f1-score': 0.1463488427376656, 'support': 72754}, '2': {'precision': 0.36357935100073463, 'recall': 0.5765962888238471, 'f1-score': 0.44595604395604393, 'support': 70382}, 'accuracy': 0.360600102096765, 'macro avg': {'precision': 0.3555809547026166, 'recall': 0.3641816378380585, 'f1-score': 0.32726674984122067, 'support': 211564}, 'weighted avg': {'precision': 0.3553803681271855, 'recall': 0.360600102096765, 'f1-score': 0.3246636038171825, 'support': 211564}}
[[28936  6257 33235]
 [28181  6772 37801]
 [23037  6763 40582]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/WBA
Evaluating performance on  test set...
5633/5633 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948703
{'0': {'precision': 0.287258298842592, 'recall': 0.3159880014155633, 'f1-score': 0.3009390217642802, 'support': 356042}, '1': {'precision': 0.5103182137108424, 'recall': 0.10490065213825557, 'f1-score': 0.17402819187741764, 'support': 707212}, '2': {'precision': 0.28454118239972415, 'recall': 0.6800607541438288, 'f1-score': 0.40121273606627506, 'support': 378575}, 'accuracy': 0.30804346423882445, 'macro avg': {'precision': 0.36070589831771954, 'recall': 0.3669831358992159, 'f1-score': 0.29205998323599097, 'support': 1441829}, 'weighted avg': {'precision': 0.3959549724123748, 'recall': 0.30804346423882445, 'f1-score': 0.2650181598353898, 'support': 1441829}}
[[112505  34627 208910]
 [194585  74187 438440]
 [ 84561  36560 257454]]
Evaluating performance on  train set...
1454/1454 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096048
{'0': {'precision': 0.3681513855309652, 'recall': 0.3213946503226854, 'f1-score': 0.34318777765738434, 'support': 123185}, '1': {'precision': 0.33932041693657616, 'recall': 0.09378636826042726, 'f1-score': 0.14695511900890731, 'support': 122875}, '2': {'precision': 0.3552957400765858, 'recall': 0.6500519705156586, 'f1-score': 0.45946430974920366, 'support': 126033}, 'accuracy': 0.3575530848470678, 'macro avg': {'precision': 0.35425584751470907, 'recall': 0.35507766303292376, 'f1-score': 0.3165357354718317, 'support': 372093}, 'weighted avg': {'precision': 0.35427624993425316, 'recall': 0.3575530848470678, 'f1-score': 0.3177709927076451, 'support': 372093}}
[[39591 11052 72542]
 [35230 11524 76121]
 [32719 11386 81928]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970134
{'0': {'precision': 0.37228444530269383, 'recall': 0.3168176495963518, 'f1-score': 0.3423187472949428, 'support': 48681}, '1': {'precision': 0.3189400590629739, 'recall': 0.08977556109725686, 'f1-score': 0.14011220196353436, 'support': 44511}, '2': {'precision': 0.35978429222298847, 'recall': 0.6465927099841522, 'f1-score': 0.46231958800328316, 'support': 49218}, 'accuracy': 0.35982725932167686, 'macro avg': {'precision': 0.3503362655295521, 'recall': 0.35106197355925356, 'f1-score': 0.31491684575392015, 'support': 142410}, 'weighted avg': {'precision': 0.3512912249516433, 'recall': 0.35982725932167686, 'f1-score': 0.32059124107162124, 'support': 142410}}
[[15423  4279 28979]
 [12865  3996 27650]
 [13140  4254 31824]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
11876/11876 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948522
{'0': {'precision': 0.4142900301745279, 'recall': 0.3009290478259286, 'f1-score': 0.3486257795380462, 'support': 1125561}, '1': {'precision': 0.2492201499966815, 'recall': 0.09019311655315242, 'f1-score': 0.13245175867481612, 'support': 749392}, '2': {'precision': 0.4072382955368303, 'recall': 0.6820050789520434, 'f1-score': 0.5099660781140305, 'support': 1165201}, 'accuracy': 0.39503821188005606, 'macro avg': {'precision': 0.35691615856934655, 'recall': 0.35770908111037486, 'f1-score': 0.33034787210896427, 'support': 3040154}, 'weighted avg': {'precision': 0.3708979073091018, 'recall': 0.39503821188005606, 'f1-score': 0.35717626592732044, 'support': 3040154}}
[[338714 101640 685207]
 [210311  67590 471491]
 [268552 101976 794673]]
Evaluating performance on  train set...
2538/2538 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960605
{'0': {'precision': 0.37377541099304606, 'recall': 0.34129019174872127, 'f1-score': 0.35679490441058687, 'support': 221905}, '1': {'precision': 0.32355129844110747, 'recall': 0.08086275220432902, 'f1-score': 0.129388424707184, 'support': 209701}, '2': {'precision': 0.3575226307413152, 'recall': 0.6470887724866754, 'f1-score': 0.4605738687003561, 'support': 218018}, 'accuracy': 0.35985123702326266, 'macro avg': {'precision': 0.3516164467251562, 'recall': 0.35641390547990853, 'f1-score': 0.31558573260604234, 'support': 649624}, 'weighted avg': {'precision': 0.3521083462430123, 'recall': 0.35985123702326266, 'f1-score': 0.3182161512183459, 'support': 649624}}
[[ 75734  17915 128256]
 [ 67481  16957 125263]
 [ 59404  17537 141077]]
Evaluating performance on  val set...
795/795 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095538
{'0': {'precision': 0.36677051189298526, 'recall': 0.3626952839830632, 'f1-score': 0.36472151461984015, 'support': 68490}, '1': {'precision': 0.3261591603560515, 'recall': 0.0748635379501723, 'f1-score': 0.12177579365079365, 'support': 65586}, '2': {'precision': 0.3667415395071654, 'recall': 0.6379693177230521, 'f1-score': 0.46574563827267706, 'support': 69356}, 'accuracy': 0.36374808289747923, 'macro avg': {'precision': 0.3532237372520674, 'recall': 0.35850937988542925, 'f1-score': 0.31741431551443694, 'support': 203432}, 'weighted avg': {'precision': 0.353667629796303, 'recall': 0.36374808289747923, 'f1-score': 0.32083850243193596, 'support': 203432}}
[[24841  5110 38539]
 [22813  4910 37863]
 [20075  5034 44247]]
testing model on single stock: results/universal/W0/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
19053/19053 - 127s - 127s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966607
{'0': {'precision': 0.3160770367899133, 'recall': 0.32467757874228015, 'f1-score': 0.320319587290831, 'support': 1353974}, '1': {'precision': 0.45963205237656396, 'recall': 0.07385944478564394, 'f1-score': 0.12726788852230608, 'support': 2201384}, '2': {'precision': 0.29173662350728596, 'recall': 0.6913132862562855, 'f1-score': 0.41031773039202046, 'support': 1322088}, 'accuracy': 0.3108542872642773, 'macro avg': {'precision': 0.3558152375579211, 'recall': 0.36328343659473655, 'f1-score': 0.28596840206838586, 'support': 4877446}, 'weighted avg': {'precision': 0.3742713348131413, 'recall': 0.3108542872642773, 'f1-score': 0.2575827664576562, 'support': 4877446}}
[[ 439605   99736  814633]
 [ 634517  162593 1404274]
 [ 316694   91417  913977]]
Evaluating performance on  train set...
4812/4812 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096387
{'0': {'precision': 0.36486586259815734, 'recall': 0.3398760076832006, 'f1-score': 0.3519278701866829, 'support': 407122}, '1': {'precision': 0.3352556837122475, 'recall': 0.0742128216417782, 'f1-score': 0.121524707929456, 'support': 406547}, '2': {'precision': 0.3568076471706649, 'recall': 0.6506822127317682, 'f1-score': 0.46088481605781684, 'support': 418198}, 'accuracy': 0.3577139415212844, 'macro avg': {'precision': 0.35230973116035663, 'recall': 0.3549236806855823, 'f1-score': 0.3114457980579853, 'support': 1231867}, 'weighted avg': {'precision': 0.3523581332971236, 'recall': 0.3577139415212844, 'f1-score': 0.3128780883865597, 'support': 1231867}}
[[138371  29802 238949]
 [124804  30171 251572]
 [116063  30021 272114]]
Evaluating performance on  val set...
1767/1767 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972462
{'0': {'precision': 0.3622318004627135, 'recall': 0.30503883210120364, 'f1-score': 0.33118426009098545, 'support': 149876}, '1': {'precision': 0.3527854479205215, 'recall': 0.08015393073117097, 'f1-score': 0.1306286364786238, 'support': 154615}, '2': {'precision': 0.34310126756303444, 'recall': 0.6754035804657582, 'f1-score': 0.45504314490580144, 'support': 147802}, 'accuracy': 0.34919178497124653, 'macro avg': {'precision': 0.35270617198208987, 'recall': 0.353532114432711, 'f1-score': 0.3056186804918036, 'support': 452293}, 'weighted avg': {'precision': 0.3527510461243767, 'recall': 0.34919178497124653, 'f1-score': 0.3030999942468847, 'support': 452293}}
[[45718 11673 92485]
 [43581 12393 98641]
 [36913 11063 99826]]
training model: results/universal/W0/deepOF_L1/h500
Epoch 1/50
8838/8838 - 134s - loss: 3.2855 - accuracy500: 0.3648 - val_loss: 3.2940 - val_accuracy500: 0.3468 - 134s/epoch - 15ms/step
Epoch 2/50
8838/8838 - 131s - loss: 3.2861 - accuracy500: 0.3621 - val_loss: 3.2939 - val_accuracy500: 0.3474 - 131s/epoch - 15ms/step
Epoch 3/50
8838/8838 - 127s - loss: 3.2841 - accuracy500: 0.3647 - val_loss: 3.2944 - val_accuracy500: 0.3457 - 127s/epoch - 14ms/step
Epoch 4/50
8838/8838 - 133s - loss: 3.2827 - accuracy500: 0.3662 - val_loss: 3.2945 - val_accuracy500: 0.3466 - 133s/epoch - 15ms/step
Epoch 5/50
8838/8838 - 131s - loss: 3.2816 - accuracy500: 0.3673 - val_loss: 3.2950 - val_accuracy500: 0.3445 - 131s/epoch - 15ms/step
Epoch 6/50
8838/8838 - 128s - loss: 3.2803 - accuracy500: 0.3687 - val_loss: 3.2954 - val_accuracy500: 0.3404 - 128s/epoch - 15ms/step
Epoch 7/50
8838/8838 - 128s - loss: 3.2792 - accuracy500: 0.3700 - val_loss: 3.2953 - val_accuracy500: 0.3388 - 128s/epoch - 14ms/step
Epoch 8/50
8838/8838 - 131s - loss: 3.2784 - accuracy500: 0.3707 - val_loss: 3.2969 - val_accuracy500: 0.3368 - 131s/epoch - 15ms/step
Epoch 9/50
8838/8838 - 130s - loss: 3.2774 - accuracy500: 0.3719 - val_loss: 3.2975 - val_accuracy500: 0.3367 - 130s/epoch - 15ms/step
Epoch 10/50
8838/8838 - 132s - loss: 3.2765 - accuracy500: 0.3731 - val_loss: 3.2978 - val_accuracy500: 0.3362 - 132s/epoch - 15ms/step
Epoch 11/50
8838/8838 - 128s - loss: 3.2757 - accuracy500: 0.3738 - val_loss: 3.2990 - val_accuracy500: 0.3362 - 128s/epoch - 14ms/step
Epoch 12/50
8838/8838 - 131s - loss: 3.2748 - accuracy500: 0.3747 - val_loss: 3.3003 - val_accuracy500: 0.3358 - 131s/epoch - 15ms/step
testing model in sample: results/universal/W0/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 192s - 192s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0924923
{'0': {'precision': 0.29709707522819323, 'recall': 0.13893122442895461, 'f1-score': 0.1893274380042295, 'support': 2270879}, '1': {'precision': 0.4565240285919916, 'recall': 0.37923470257946956, 'f1-score': 0.4143055830497726, 'support': 3852071}, '2': {'precision': 0.29686890248708075, 'recall': 0.5343973097787068, 'f1-score': 0.38169707972042066, 'support': 2326054}, 'accuracy': 0.35736425263853583, 'macro avg': {'precision': 0.3501633354357552, 'recall': 0.35085441226237696, 'f1-score': 0.3284433669248076, 'support': 8449004}, 'weighted avg': {'precision': 0.3697202153703785, 'recall': 0.35736425263853583, 'f1-score': 0.34485984901459754, 'support': 8449004}}
[[ 315496  898764 1056619]
 [ 503730 1460839 1887502]
 [ 242703  840314 1243037]]
Evaluating performance on  train set...
8838/8838 - 50s - 50s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975697
{'0': {'precision': 0.3647894453659515, 'recall': 0.1529072801107103, 'f1-score': 0.21548895003206567, 'support': 749343}, '1': {'precision': 0.3277756431260416, 'recall': 0.3741379635085793, 'f1-score': 0.34942565708297624, 'support': 743298}, '2': {'precision': 0.35923342000649366, 'recall': 0.5133560775904085, 'f1-score': 0.4226836558124901, 'support': 769425}, 'accuracy': 0.3482060205139903, 'macro avg': {'precision': 0.350599502832829, 'recall': 0.3468004404032327, 'f1-score': 0.32919942097584404, 'support': 2262066}, 'weighted avg': {'precision': 0.3507371453934832, 'recall': 0.3482060205139903, 'f1-score': 0.3299752970142628, 'support': 2262066}}
[[114580 290263 344500]
 [105158 278096 360044]
 [ 94361 280075 394989]]
Evaluating performance on  val set...
3279/3279 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975839
{'0': {'precision': 0.3687566512167879, 'recall': 0.14992330054386888, 'f1-score': 0.21317659979052478, 'support': 279663}, '1': {'precision': 0.33319591980766505, 'recall': 0.36077574355183706, 'f1-score': 0.3464377929643968, 'support': 280041}, '2': {'precision': 0.35219171848930686, 'recall': 0.5323208081097539, 'f1-score': 0.42391481083178106, 'support': 279170}, 'accuracy': 0.3475706721152402, 'macro avg': {'precision': 0.3513814298379199, 'recall': 0.34767328406848663, 'f1-score': 0.3278430678622342, 'support': 838874}, 'weighted avg': {'precision': 0.3513727591733189, 'recall': 0.3475706721152402, 'f1-score': 0.3277949860726027, 'support': 838874}}
[[ 41928 104462 133273]
 [ 38938 101032 140071]
 [ 32835  97727 148608]]
testing model out of sample: results/universal/W0/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 123s - 123s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982738
{'0': {'precision': 0.37575680726107846, 'recall': 0.1406951871657754, 'f1-score': 0.20473219155667066, 'support': 2000900}, '1': {'precision': 0.3108851017042331, 'recall': 0.3910226279498883, 'f1-score': 0.3463791729968841, 'support': 1801975}, '2': {'precision': 0.3704828514473617, 'recall': 0.514145620111297, 'f1-score': 0.43064889164688086, 'support': 2030063}, 'accuracy': 0.3480026703524022, 'macro avg': {'precision': 0.3523749201375577, 'recall': 0.34862114507565356, 'f1-score': 0.3272534187334786, 'support': 5832938}, 'weighted avg': {'precision': 0.35388041252109365, 'recall': 0.3480026703524022, 'f1-score': 0.3271181063934066, 'support': 5832938}}
[[ 281517  797710  921673]
 [ 245519  704613  851843]
 [ 222164  764151 1043748]]
Evaluating performance on  train set...
6334/6334 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097654
{'0': {'precision': 0.3595810423956014, 'recall': 0.1473061293631248, 'f1-score': 0.2089951945868784, 'support': 537201}, '1': {'precision': 0.3374863469811975, 'recall': 0.3808072793261407, 'f1-score': 0.3578404510264684, 'support': 544446}, '2': {'precision': 0.35258471510726785, 'recall': 0.51424491650363, 'f1-score': 0.4183403307149096, 'support': 539245}, 'accuracy': 0.3478121922990551, 'macro avg': {'precision': 0.3498840348280223, 'recall': 0.34745277506429845, 'f1-score': 0.3283919921094188, 'support': 1620892}, 'weighted avg': {'precision': 0.3498320257750073, 'recall': 0.3478121922990551, 'f1-score': 0.3286370476029148, 'support': 1620892}}
[[ 79133 209573 248495]
 [ 76427 207329 260690]
 [ 64510 197431 277304]]
Evaluating performance on  val set...
2156/2156 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958656
{'0': {'precision': 0.34184646817728653, 'recall': 0.16146923398911678, 'f1-score': 0.21933624212749994, 'support': 172008}, '1': {'precision': 0.37111013386671965, 'recall': 0.38714864984855807, 'f1-score': 0.3789597703508234, 'support': 202718}, '2': {'precision': 0.34420581274844936, 'recall': 0.504025956376979, 'f1-score': 0.4090595761107332, 'support': 176604}, 'accuracy': 0.3541780784648033, 'macro avg': {'precision': 0.3523874715974851, 'recall': 0.3508812800715513, 'f1-score': 0.3357851961963522, 'support': 551330}, 'weighted avg': {'precision': 0.35336215110743024, 'recall': 0.3541780784648033, 'f1-score': 0.33880092220866836, 'support': 551330}}
[[27774 68068 76166]
 [30811 78482 93425]
 [22662 64929 89013]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958557
{'0': {'precision': 0.3560966565725233, 'recall': 0.0838401769344935, 'f1-score': 0.13572496967270073, 'support': 68726}, '1': {'precision': 0.34795405040970856, 'recall': 0.3367928316851564, 'f1-score': 0.34228247838175646, 'support': 79684}, '2': {'precision': 0.3466497504604826, 'recall': 0.5988381304462636, 'f1-score': 0.43911105087108687, 'support': 75740}, 'accuracy': 0.34778050412670086, 'macro avg': {'precision': 0.3502334858142382, 'recall': 0.3398237130219712, 'f1-score': 0.3057061663085147, 'support': 224150}, 'weighted avg': {'precision': 0.35000991065057957, 'recall': 0.34778050412670086, 'f1-score': 0.31166871410249397, 'support': 224150}}
[[ 5762 24665 38299]
 [ 5661 26837 47186]
 [ 4758 25626 45356]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991534
{'0': {'precision': 0.3825631252977608, 'recall': 0.08741246053920679, 'f1-score': 0.14230860113421548, 'support': 27559}, '1': {'precision': 0.32771394824438954, 'recall': 0.34617565881507806, 'f1-score': 0.3366919173347062, 'support': 26449}, '2': {'precision': 0.344272063674477, 'recall': 0.5943711650806481, 'f1-score': 0.4360024795838611, 'support': 27217}, 'accuracy': 0.3415450907971684, 'macro avg': {'precision': 0.3515163790722091, 'recall': 0.34265309481164435, 'f1-score': 0.30500099935092756, 'support': 81225}, 'weighted avg': {'precision': 0.35187215936257427, 'recall': 0.3415450907971684, 'f1-score': 0.30401633422071334, 'support': 81225}}
[[ 2409  9583 15567]
 [ 2048  9156 15245]
 [ 1840  9200 16177]]
Evaluating performance on  val set...
104/104 - 1s - 687ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986534
{'0': {'precision': 0.3776282590412111, 'recall': 0.10010032326385018, 'f1-score': 0.15825182835492113, 'support': 8971}, '1': {'precision': 0.3170376999664392, 'recall': 0.33018758010019805, 'f1-score': 0.3234790549024084, 'support': 8583}, '2': {'precision': 0.3525962045334739, 'recall': 0.5986128202259761, 'f1-score': 0.44379017209205884, 'support': 8939}, 'accuracy': 0.3428452798852527, 'macro avg': {'precision': 0.34908738784704135, 'recall': 0.34296690786334144, 'f1-score': 0.30850701844979617, 'support': 26493}, 'weighted avg': {'precision': 0.34955252946043774, 'recall': 0.3428452798852527, 'f1-score': 0.3081243433635407, 'support': 26493}}
[[ 898 3149 4924]
 [ 848 2834 4901]
 [ 632 2956 5351]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
2359/2359 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963355
{'0': {'precision': 0.409728356222397, 'recall': 0.16557949400017605, 'f1-score': 0.23584803814021196, 'support': 204506}, '1': {'precision': 0.2760164314303771, 'recall': 0.3493936473882293, 'f1-score': 0.3084004910784736, 'support': 165003}, '2': {'precision': 0.4206936305120569, 'recall': 0.5607536474384694, 'f1-score': 0.4807298223015896, 'support': 234274}, 'accuracy': 0.3691442124074378, 'macro avg': {'precision': 0.36881280605494365, 'recall': 0.35857559627562496, 'f1-score': 0.34165945050675844, 'support': 603783}, 'weighted avg': {'precision': 0.3774419386559503, 'recall': 0.3691442124074378, 'f1-score': 0.3506919597060636, 'support': 603783}}
[[ 33862  72451  98193]
 [ 24645  57651  82707]
 [ 24138  78766 131370]]
Evaluating performance on  train set...
589/589 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980338
{'0': {'precision': 0.39171199541941026, 'recall': 0.20698523154889095, 'f1-score': 0.2708500872233288, 'support': 52883}, '1': {'precision': 0.3134825572690523, 'recall': 0.3550082658641007, 'f1-score': 0.3329556522949093, 'support': 47182}, '2': {'precision': 0.36325871220863143, 'recall': 0.49732419676533896, 'f1-score': 0.4198487917510649, 'support': 50639}, 'accuracy': 0.3508865059985136, 'macro avg': {'precision': 0.3561510882990313, 'recall': 0.35310589805944353, 'f1-score': 0.3412181770897677, 'support': 150704}, 'weighted avg': {'precision': 0.3576593680218573, 'recall': 0.3508865059985136, 'f1-score': 0.3403599221964373, 'support': 150704}}
[[10946 19132 22805]
 [ 9093 16750 21339]
 [ 7905 17550 25184]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984167
{'0': {'precision': 0.3763451776649746, 'recall': 0.18403415578612917, 'f1-score': 0.24719101123595502, 'support': 20143}, '1': {'precision': 0.2782898229020895, 'recall': 0.34875423318819543, 'f1-score': 0.3095627901983413, 'support': 16536}, '2': {'precision': 0.39825107979890956, 'recall': 0.5080849141824751, 'f1-score': 0.4465129202556266, 'support': 22140}, 'accuracy': 0.35231812849589417, 'macro avg': {'precision': 0.3509620267886579, 'recall': 0.3469577677189332, 'f1-score': 0.33442224056330766, 'support': 58819}, 'weighted avg': {'precision': 0.357024096498791, 'recall': 0.35231812849589417, 'f1-score': 0.33975237410539433, 'support': 58819}}
[[ 3707  7258  9178]
 [ 2950  5767  7819]
 [ 3193  7698 11249]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
1625/1625 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970694
{'0': {'precision': 0.3183469522351021, 'recall': 0.22454112526807116, 'f1-score': 0.2633396673925406, 'support': 126832}, '1': {'precision': 0.37247572629235903, 'recall': 0.3141296186012791, 'f1-score': 0.3408236149299959, 'support': 154484}, '2': {'precision': 0.3306595547215225, 'recall': 0.4819965806883223, 'f1-score': 0.3922366861041884, 'support': 134530}, 'accuracy': 0.34111185390745613, 'macro avg': {'precision': 0.34049407774966123, 'recall': 0.34022244151922415, 'f1-score': 0.3321333228089083, 'support': 415846}, 'weighted avg': {'precision': 0.34243866874544343, 'recall': 0.34111185390745613, 'f1-score': 0.33382380353585867, 'support': 415846}}
[[28479 39724 58629]
 [33326 48528 72630]
 [27654 42033 64843]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096932
{'0': {'precision': 0.3454203704428868, 'recall': 0.23763469827586206, 'f1-score': 0.2815647094498619, 'support': 37120}, '1': {'precision': 0.324825297466476, 'recall': 0.3190914150918392, 'f1-score': 0.32193282704032516, 'support': 37729}, '2': {'precision': 0.3735240690281562, 'recall': 0.48621887238601935, 'f1-score': 0.422485473048894, 'support': 40599}, 'accuracy': 0.3516734807012681, 'macro avg': {'precision': 0.34792324564583965, 'recall': 0.34764832858457356, 'f1-score': 0.3419943365130271, 'support': 115448}, 'weighted avg': {'precision': 0.3485728767707257, 'recall': 0.3516734807012681, 'f1-score': 0.344314092634739, 'support': 115448}}
[[ 8821 12197 16102]
 [ 8684 12039 17006]
 [ 8032 12827 19740]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097431
{'0': {'precision': 0.35936913255726627, 'recall': 0.2526232429221936, 'f1-score': 0.29668668862623526, 'support': 15153}, '1': {'precision': 0.33170282149439956, 'recall': 0.3114972372012516, 'f1-score': 0.3212826587015484, 'support': 15021}, '2': {'precision': 0.3583108273999509, 'recall': 0.4881262960733159, 'f1-score': 0.4132638613581016, 'support': 14949}, 'accuracy': 0.350242670035237, 'macro avg': {'precision': 0.34979426048387224, 'recall': 0.3507489253989204, 'f1-score': 0.3437444028952951, 'support': 45123}, 'weighted avg': {'precision': 0.3498086808525474, 'recall': 0.350242670035237, 'f1-score': 0.34349581527273365, 'support': 45123}}
[[3828 4965 6360]
 [3634 4679 6708]
 [3190 4462 7297]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1269/1269 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966145
{'0': {'precision': 0.31370238699847636, 'recall': 0.15361505710079185, 'f1-score': 0.20623843898790642, 'support': 100524}, '1': {'precision': 0.3617232919985214, 'recall': 0.45719746846196324, 'f1-score': 0.4038949343339587, 'support': 117715}, '2': {'precision': 0.35213690048836677, 'recall': 0.4190105144573789, 'f1-score': 0.3826740801392384, 'support': 106520}, 'accuracy': 0.3507031367875871, 'macro avg': {'precision': 0.3425208598284548, 'recall': 0.34327434667337803, 'f1-score': 0.33093581782036785, 'support': 324759}, 'weighted avg': {'precision': 0.3437148738241638, 'recall': 0.3507031367875871, 'f1-score': 0.3357531217067854, 'support': 324759}}
[[15442 47706 37376]
 [19156 53819 44740]
 [14627 47260 44633]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978208
{'0': {'precision': 0.3685546976213919, 'recall': 0.17122083925175144, 'f1-score': 0.233816615708321, 'support': 41537}, '1': {'precision': 0.33395580454403984, 'recall': 0.4179162609542356, 'f1-score': 0.37124816192370896, 'support': 41080}, '2': {'precision': 0.35487123942557286, 'recall': 0.45639695463169777, 'f1-score': 0.3992814069295905, 'support': 41637}, 'accuracy': 0.34834291048980315, 'macro avg': {'precision': 0.35246058053033485, 'recall': 0.3485113516125616, 'f1-score': 0.33478206152054013, 'support': 124254}, 'weighted avg': {'precision': 0.3525305802769447, 'recall': 0.34834291048980315, 'f1-score': 0.33469985029721255, 'support': 124254}}
[[ 7112 17497 16928]
 [ 6294 17168 17618]
 [ 5891 16743 19003]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097309
{'0': {'precision': 0.3309365135040337, 'recall': 0.13038971807628524, 'f1-score': 0.1870724695152176, 'support': 14472}, '1': {'precision': 0.32398502735387275, 'recall': 0.3728049831025114, 'f1-score': 0.3466847424205078, 'support': 15091}, '2': {'precision': 0.36152681275610193, 'recall': 0.5087114565053898, 'f1-score': 0.4226723599250156, 'support': 15956}, 'accuracy': 0.34337309694852697, 'macro avg': {'precision': 0.3388161178713361, 'recall': 0.3373020525613955, 'f1-score': 0.3188098572869137, 'support': 45519}, 'weighted avg': {'precision': 0.3393548429351267, 'recall': 0.34337309694852697, 'f1-score': 0.3225750214559999, 'support': 45519}}
[[1887 5744 6841]
 [1971 5626 7494]
 [1844 5995 8117]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
1733/1733 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979549
{'0': {'precision': 0.3450344668806457, 'recall': 0.17700596805458096, 'f1-score': 0.23397865657660305, 'support': 143933}, '1': {'precision': 0.3285056503660621, 'recall': 0.35361433376810597, 'f1-score': 0.34059786956895466, 'support': 145670}, '2': {'precision': 0.3588159576067348, 'recall': 0.496276899885643, 'f1-score': 0.4164976224752432, 'support': 153904}, 'accuracy': 0.34580513949047026, 'macro avg': {'precision': 0.3441186916178142, 'recall': 0.34229906723611, 'f1-score': 0.330358049540267, 'support': 443507}, 'weighted avg': {'precision': 0.3443879694116737, 'recall': 0.34580513949047026, 'f1-score': 0.33233475847411575, 'support': 443507}}
[[25477 51872 66584]
 [24258 51511 69901]
 [24104 53421 76379]]
Evaluating performance on  train set...
765/765 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975232
{'0': {'precision': 0.3262491652875766, 'recall': 0.1824454871653326, 'f1-score': 0.2340212841285378, 'support': 61591}, '1': {'precision': 0.33959380107754705, 'recall': 0.33839541547277935, 'f1-score': 0.3389935491668303, 'support': 66310}, '2': {'precision': 0.35849650900309726, 'recall': 0.5031460442361817, 'f1-score': 0.41867964784069445, 'support': 67863}, 'accuracy': 0.3464426554422672, 'macro avg': {'precision': 0.34144649178940695, 'recall': 0.3413289822914312, 'f1-score': 0.33056482704535417, 'support': 195764}, 'weighted avg': {'precision': 0.3419480899407269, 'recall': 0.3464426554422672, 'f1-score': 0.333591079552044, 'support': 195764}}
[[11237 21136 29218]
 [11989 22439 31882]
 [11217 22501 34145]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980915
{'0': {'precision': 0.3299003883167314, 'recall': 0.18874667954600338, 'f1-score': 0.24011551104420753, 'support': 20705}, '1': {'precision': 0.3490108078402638, 'recall': 0.3384403588240519, 'f1-score': 0.3436443161834333, 'support': 22518}, '2': {'precision': 0.3440520685655368, 'recall': 0.4967666899278902, 'f1-score': 0.4065408996592488, 'support': 21495}, 'accuracy': 0.343134831113446, 'macro avg': {'precision': 0.34098775490751065, 'recall': 0.34131790943264845, 'f1-score': 0.33010024229562984, 'support': 64718}, 'weighted avg': {'precision': 0.34124991694522694, 'recall': 0.343134831113446, 'f1-score': 0.3314127600692917, 'support': 64718}}
[[ 3908  7100  9697]
 [ 4236  7621 10661]
 [ 3702  7115 10678]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/EXC
Evaluating performance on  test set...
4693/4693 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0848787
{'0': {'precision': 0.22669938182641114, 'recall': 0.25519676417350107, 'f1-score': 0.2401054632308417, 'support': 223745}, '1': {'precision': 0.6270778511523634, 'recall': 0.3532869950205614, 'f1-score': 0.4519510272984484, 'support': 742654}, '2': {'precision': 0.22576495295857152, 'recall': 0.5105116104741299, 'f1-score': 0.3130770024408942, 'support': 234788}, 'accuracy': 0.36574738154841835, 'macro avg': {'precision': 0.35984739531244864, 'recall': 0.37299845655606406, 'f1-score': 0.3350444976567281, 'support': 1201187}, 'weighted avg': {'precision': 0.47405743604592354, 'recall': 0.36574738154841835, 'f1-score': 0.3853457940745107, 'support': 1201187}}
[[ 57099  79790  86856]
 [156087 262370 324197]
 [ 38685  76241 119862]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095974
{'0': {'precision': 0.36725549230841603, 'recall': 0.247856938756072, 'f1-score': 0.29596807824999055, 'support': 125988}, '1': {'precision': 0.32358414083310816, 'recall': 0.3318683581191302, 'f1-score': 0.3276738976610359, 'support': 126282}, '2': {'precision': 0.3711040597847039, 'recall': 0.4780788214978835, 'f1-score': 0.4178534340847393, 'support': 130878}, 'accuracy': 0.35418689383736834, 'macro avg': {'precision': 0.35398123097540934, 'recall': 0.3526013727910286, 'f1-score': 0.3471651366652552, 'support': 383148}, 'weighted avg': {'precision': 0.35417643984606934, 'recall': 0.35418689383736834, 'f1-score': 0.348052353485163, 'support': 383148}}
[[31227 44045 50716]
 [29054 41909 55319]
 [24747 43561 62570]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935705
{'0': {'precision': 0.3700395328484775, 'recall': 0.27404179237903675, 'f1-score': 0.31488662335327805, 'support': 44745}, '1': {'precision': 0.35546740255260434, 'recall': 0.3239420016503595, 'f1-score': 0.3389732941345778, 'support': 50898}, '2': {'precision': 0.3559324844143786, 'recall': 0.48578863996379273, 'f1-score': 0.41084381160169187, 'support': 44190}, 'accuracy': 0.3591212374761322, 'macro avg': {'precision': 0.3604798066051535, 'recall': 0.3612574779977297, 'f1-score': 0.35490124302984927, 'support': 139833}, 'weighted avg': {'precision': 0.36027729676613507, 'recall': 0.3591212374761322, 'f1-score': 0.35397833645479193, 'support': 139833}}
[[12262 15577 16906]
 [12471 16488 21939]
 [ 8404 14319 21467]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/AAL
Evaluating performance on  test set...
6677/6677 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917645
{'0': {'precision': 0.33112670637710767, 'recall': 0.1582170159358004, 'f1-score': 0.21412302637504985, 'support': 473274}, '1': {'precision': 0.47252529483112654, 'recall': 0.4196736290635653, 'f1-score': 0.444534060723697, 'support': 801113}, '2': {'precision': 0.285952555288446, 'recall': 0.5073673124945389, 'f1-score': 0.36576161865980844, 'support': 434894}, 'accuracy': 0.36959224375629285, 'macro avg': {'precision': 0.3632015188322268, 'recall': 0.3617526524979682, 'f1-score': 0.3414729019195184, 'support': 1709281}, 'weighted avg': {'precision': 0.3859042883712982, 'recall': 0.36959224375629285, 'f1-score': 0.3606945900402609, 'support': 1709281}}
[[ 74880 204394 194000]
 [107923 336206 356984]
 [ 43334 170909 220651]]
Evaluating performance on  train set...
2262/2262 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975015
{'0': {'precision': 0.3654618473895582, 'recall': 0.15186475112465533, 'f1-score': 0.21456763545030497, 'support': 192948}, '1': {'precision': 0.3450084113132163, 'recall': 0.4004708849688026, 'f1-score': 0.37067648823882426, 'support': 196651}, '2': {'precision': 0.35249215019841784, 'recall': 0.5036674558214256, 'f1-score': 0.4147330082829113, 'support': 189232}, 'accuracy': 0.35133743700665654, 'macro avg': {'precision': 0.3543208029670641, 'recall': 0.3520010306382945, 'f1-score': 0.33332571065734684, 'support': 578831}, 'weighted avg': {'precision': 0.35427296773950046, 'recall': 0.35133743700665654, 'f1-score': 0.3330420361675694, 'support': 578831}}
[[29302 78001 85645]
 [28464 78753 89434]
 [22412 71510 95310]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925875
{'0': {'precision': 0.31037652129817445, 'recall': 0.16734163804446267, 'f1-score': 0.21744584947764592, 'support': 58521}, '1': {'precision': 0.4350940740826191, 'recall': 0.4133732272418404, 'f1-score': 0.42395562274839965, 'support': 91242}, '2': {'precision': 0.32017144387891777, 'recall': 0.4834873222116147, 'f1-score': 0.3852352281371272, 'support': 61801}, 'accuracy': 0.3657994743907281, 'macro avg': {'precision': 0.3552140130865704, 'recall': 0.3547340624993059, 'f1-score': 0.3422122334543909, 'support': 211564}, 'weighted avg': {'precision': 0.36702517117041555, 'recall': 0.3657994743907281, 'f1-score': 0.3555218743368125, 'support': 211564}}
[[ 9793 24823 23905]
 [13985 37717 39540]
 [ 7774 24147 29880]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/WBA
Evaluating performance on  test set...
5633/5633 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0921257
{'0': {'precision': 0.3105966830104761, 'recall': 0.151507705819619, 'f1-score': 0.20366736181509287, 'support': 382568}, '1': {'precision': 0.45169657007281233, 'recall': 0.3800518057767975, 'f1-score': 0.4127885358213137, 'support': 639697}, '2': {'precision': 0.3132579524422544, 'recall': 0.5353176154293505, 'f1-score': 0.3952329208258362, 'support': 419564}, 'accuracy': 0.3645924724776655, 'macro avg': {'precision': 0.3585170685085142, 'recall': 0.35562570900858903, 'f1-score': 0.33722960615408093, 'support': 1441829}, 'weighted avg': {'precision': 0.3739729553021209, 'recall': 0.3645924724776655, 'f1-score': 0.35219274162715164, 'support': 1441829}}
[[ 57962 147071 177535]
 [ 81733 243118 314846]
 [ 46920 148044 224600]]
Evaluating performance on  train set...
1454/1454 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975757
{'0': {'precision': 0.3656153803616523, 'recall': 0.16142946667643301, 'f1-score': 0.2239699190388546, 'support': 122871}, '1': {'precision': 0.3330519956466695, 'recall': 0.3664676219725791, 'f1-score': 0.3489616867451187, 'support': 122753}, '2': {'precision': 0.35628347731886, 'recall': 0.5149008848018092, 'f1-score': 0.4211523661080966, 'support': 126469}, 'accuracy': 0.34921108432569276, 'macro avg': {'precision': 0.3516502844423939, 'recall': 0.3475993244836071, 'f1-score': 0.3313613239640233, 'support': 372093}, 'weighted avg': {'precision': 0.35170098366556507, 'recall': 0.34921108432569276, 'f1-score': 0.33222398820878524, 'support': 372093}}
[[19835 45516 57520]
 [17634 44985 60134]
 [16782 44568 65119]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995642
{'0': {'precision': 0.3752922472645656, 'recall': 0.16107732755333454, 'f1-score': 0.22540828219566653, 'support': 49827}, '1': {'precision': 0.3053713317088675, 'recall': 0.3366975049060835, 'f1-score': 0.32027022522472476, 'support': 42804}, '2': {'precision': 0.3666039090330358, 'recall': 0.5437232567950341, 'f1-score': 0.4379328198822083, 'support': 49779}, 'accuracy': 0.34761603819956466, 'macro avg': {'precision': 0.349089162668823, 'recall': 0.34716602975148403, 'f1-score': 0.3278704424341998, 'support': 142410}, 'weighted avg': {'precision': 0.3512392196803129, 'recall': 0.34761603819956466, 'f1-score': 0.32820815278701665, 'support': 142410}}
[[ 8026 16809 24992]
 [ 6621 14412 21771]
 [ 6739 15974 27066]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
11876/11876 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023462
{'0': {'precision': 0.4273410325413509, 'recall': 0.1233605608790247, 'f1-score': 0.1914540654712843, 'support': 1188135}, '1': {'precision': 0.20252955271230325, 'recall': 0.3885791853454939, 'f1-score': 0.26627509808064814, 'support': 621024}, '2': {'precision': 0.42211389025410784, 'recall': 0.516297791623849, 'f1-score': 0.4644794466237067, 'support': 1230995}, 'accuracy': 0.3366428148047763, 'macro avg': {'precision': 0.3506614918359207, 'recall': 0.34274584594945584, 'f1-score': 0.3074028700585464, 'support': 3040154}, 'weighted avg': {'precision': 0.37930139031624016, 'recall': 0.3366428148047763, 'f1-score': 0.317289314615546, 'support': 3040154}}
[[146569 477025 564541]
 [ 74148 241317 305559]
 [122262 473173 635560]]
Evaluating performance on  train set...
2538/2538 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977924
{'0': {'precision': 0.3683896107422644, 'recall': 0.12447300936311548, 'f1-score': 0.186074421539179, 'support': 217983}, '1': {'precision': 0.3336751129444117, 'recall': 0.3908617761968091, 'f1-score': 0.3600116136880453, 'support': 217307}, '2': {'precision': 0.34916200248272516, 'recall': 0.5236126792762698, 'f1-score': 0.41895269292867077, 'support': 214334}, 'accuracy': 0.345273573636442, 'macro avg': {'precision': 0.35040890872313374, 'recall': 0.34631582161206476, 'f1-score': 0.321679576051965, 'support': 649624}, 'weighted avg': {'precision': 0.3504333259349634, 'recall': 0.345273573636442, 'f1-score': 0.32109329527889463, 'support': 649624}}
[[ 27133  88604 102246]
 [ 25423  84937 106947]
 [ 21097  81009 112228]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976537
{'0': {'precision': 0.38327540215018996, 'recall': 0.13811937428995893, 'f1-score': 0.20306209850107068, 'support': 68658}, '1': {'precision': 0.3218838085260296, 'recall': 0.3948954922422499, 'f1-score': 0.3546711376192178, 'support': 65354}, '2': {'precision': 0.3636308267013156, 'recall': 0.5160184384903486, 'f1-score': 0.42662506252530785, 'support': 69420}, 'accuracy': 0.3495664398914625, 'macro avg': {'precision': 0.35626334579251173, 'recall': 0.3496777683408525, 'f1-score': 0.32811943288186546, 'support': 203432}, 'weighted avg': {'precision': 0.3568493106927288, 'recall': 0.3495664398914625, 'f1-score': 0.32805717353887165, 'support': 203432}}
[[ 9483 28022 31153]
 [ 8009 25808 31537]
 [ 7250 26348 35822]]
testing model on single stock: results/universal/W0/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
19053/19053 - 104s - 104s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093743
{'0': {'precision': 0.3080660459928271, 'recall': 0.11132548163491074, 'f1-score': 0.16354932651837287, 'support': 1359536}, '1': {'precision': 0.4474447536525875, 'recall': 0.38567820239762013, 'f1-score': 0.4142718358863134, 'support': 2187002}, '2': {'precision': 0.28917054836968475, 'recall': 0.5434109645445064, 'f1-score': 0.3774728219881325, 'support': 1330908}, 'accuracy': 0.3522458270168445, 'macro avg': {'precision': 0.34822711600503314, 'recall': 0.34680488285901245, 'f1-score': 0.3184313281309396, 'support': 4877446}, 'weighted avg': {'precision': 0.3654061669206016, 'recall': 0.3522458270168445, 'f1-score': 0.3343442714426983, 'support': 4877446}}
[[ 151351  551891  656294]
 [ 221997  843479 1121526]
 [ 117946  489732  723230]]
Evaluating performance on  train set...
4812/4812 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979538
{'0': {'precision': 0.3560446446054435, 'recall': 0.11194787028645731, 'f1-score': 0.17033793670689232, 'support': 406064}, '1': {'precision': 0.32869170308593276, 'recall': 0.38790544850874753, 'f1-score': 0.3558521052530495, 'support': 406001}, '2': {'precision': 0.3570754339652828, 'recall': 0.531655399450217, 'f1-score': 0.4272184003093262, 'support': 419802}, 'accuracy': 0.34592857832866697, 'macro avg': {'precision': 0.347270593885553, 'recall': 0.34383623941514063, 'f1-score': 0.31780281408975597, 'support': 1231867}, 'weighted avg': {'precision': 0.3473808893664253, 'recall': 0.34592857832866697, 'f1-score': 0.31902109026578895, 'support': 1231867}}
[[ 45458 164470 196136]
 [ 42787 157490 205724]
 [ 39430 157182 223190]]
Evaluating performance on  val set...
1767/1767 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981492
{'0': {'precision': 0.3661289221597761, 'recall': 0.10693399611898242, 'f1-score': 0.16552398096952553, 'support': 150476}, '1': {'precision': 0.3432143211983425, 'recall': 0.37957624489373804, 'f1-score': 0.36048064085447257, 'support': 154712}, '2': {'precision': 0.34064938185220933, 'recall': 0.5493762958431052, 'f1-score': 0.4205377446363432, 'support': 147105}, 'accuracy': 0.3440955309942891, 'macro avg': {'precision': 0.349997541736776, 'recall': 0.3452955122852752, 'f1-score': 0.3155141221534471, 'support': 452293}, 'weighted avg': {'precision': 0.3500036858176485, 'recall': 0.3440955309942891, 'f1-score': 0.31515250599274536, 'support': 452293}}
[[16091 58890 75495]
 [15057 58725 80930]
 [12801 53488 80816]]
training model: results/universal/W0/deepOF_L1/h1000
Epoch 1/50
8838/8838 - 136s - loss: 3.2830 - accuracy1000: 0.3652 - val_loss: 3.2972 - val_accuracy1000: 0.3360 - 136s/epoch - 15ms/step
Epoch 2/50
8838/8838 - 134s - loss: 3.2861 - accuracy1000: 0.3596 - val_loss: 3.2964 - val_accuracy1000: 0.3395 - 134s/epoch - 15ms/step
Epoch 3/50
8838/8838 - 131s - loss: 3.2839 - accuracy1000: 0.3627 - val_loss: 3.2965 - val_accuracy1000: 0.3401 - 131s/epoch - 15ms/step
Epoch 4/50
8838/8838 - 126s - loss: 3.2817 - accuracy1000: 0.3647 - val_loss: 3.2966 - val_accuracy1000: 0.3401 - 126s/epoch - 14ms/step
Epoch 5/50
8838/8838 - 128s - loss: 3.2809 - accuracy1000: 0.3660 - val_loss: 3.2965 - val_accuracy1000: 0.3398 - 128s/epoch - 15ms/step
Epoch 6/50
8838/8838 - 131s - loss: 3.2797 - accuracy1000: 0.3676 - val_loss: 3.2967 - val_accuracy1000: 0.3403 - 131s/epoch - 15ms/step
Epoch 7/50
8838/8838 - 131s - loss: 3.2760 - accuracy1000: 0.3707 - val_loss: 3.2962 - val_accuracy1000: 0.3416 - 131s/epoch - 15ms/step
Epoch 8/50
8838/8838 - 127s - loss: 3.2762 - accuracy1000: 0.3706 - val_loss: 3.2964 - val_accuracy1000: 0.3423 - 127s/epoch - 14ms/step
Epoch 9/50
8838/8838 - 127s - loss: 3.2756 - accuracy1000: 0.3713 - val_loss: 3.2966 - val_accuracy1000: 0.3426 - 127s/epoch - 14ms/step
Epoch 10/50
8838/8838 - 128s - loss: 3.2748 - accuracy1000: 0.3719 - val_loss: 3.2965 - val_accuracy1000: 0.3415 - 128s/epoch - 14ms/step
Epoch 11/50
8838/8838 - 129s - loss: 3.2735 - accuracy1000: 0.3727 - val_loss: 3.2962 - val_accuracy1000: 0.3417 - 129s/epoch - 15ms/step
Epoch 12/50
8838/8838 - 128s - loss: 3.2728 - accuracy1000: 0.3735 - val_loss: 3.2960 - val_accuracy1000: 0.3419 - 128s/epoch - 14ms/step
Epoch 13/50
8838/8838 - 129s - loss: 3.2723 - accuracy1000: 0.3738 - val_loss: 3.2956 - val_accuracy1000: 0.3430 - 129s/epoch - 15ms/step
Epoch 14/50
8838/8838 - 129s - loss: 3.2716 - accuracy1000: 0.3743 - val_loss: 3.2953 - val_accuracy1000: 0.3442 - 129s/epoch - 15ms/step
Epoch 15/50
8838/8838 - 130s - loss: 3.2708 - accuracy1000: 0.3753 - val_loss: 3.2956 - val_accuracy1000: 0.3424 - 130s/epoch - 15ms/step
Epoch 16/50
8838/8838 - 131s - loss: 3.2695 - accuracy1000: 0.3767 - val_loss: 3.2956 - val_accuracy1000: 0.3424 - 131s/epoch - 15ms/step
Epoch 17/50
8838/8838 - 131s - loss: 3.2683 - accuracy1000: 0.3780 - val_loss: 3.2954 - val_accuracy1000: 0.3422 - 131s/epoch - 15ms/step
Epoch 18/50
8838/8838 - 126s - loss: 3.2672 - accuracy1000: 0.3788 - val_loss: 3.2953 - val_accuracy1000: 0.3420 - 126s/epoch - 14ms/step
Epoch 19/50
8838/8838 - 128s - loss: 3.2663 - accuracy1000: 0.3799 - val_loss: 3.2958 - val_accuracy1000: 0.3413 - 128s/epoch - 14ms/step
Epoch 20/50
8838/8838 - 125s - loss: 3.2654 - accuracy1000: 0.3806 - val_loss: 3.2959 - val_accuracy1000: 0.3408 - 125s/epoch - 14ms/step
Epoch 21/50
8838/8838 - 126s - loss: 3.2651 - accuracy1000: 0.3809 - val_loss: 3.2966 - val_accuracy1000: 0.3405 - 126s/epoch - 14ms/step
Epoch 22/50
8838/8838 - 129s - loss: 3.2641 - accuracy1000: 0.3820 - val_loss: 3.2967 - val_accuracy1000: 0.3399 - 129s/epoch - 15ms/step
Epoch 23/50
8838/8838 - 131s - loss: 3.2641 - accuracy1000: 0.3820 - val_loss: 3.2974 - val_accuracy1000: 0.3401 - 131s/epoch - 15ms/step
Epoch 24/50
8838/8838 - 129s - loss: 3.2638 - accuracy1000: 0.3828 - val_loss: 3.2976 - val_accuracy1000: 0.3399 - 129s/epoch - 15ms/step
testing model in sample: results/universal/W0/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 171s - 171s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962366
{'0': {'precision': 0.2848963594107241, 'recall': 0.3340242542459097, 'f1-score': 0.3075105009907979, 'support': 2258821}, '1': {'precision': 0.4620384582292175, 'recall': 0.3943910013196647, 'f1-score': 0.4255430687431051, 'support': 3894171}, '2': {'precision': 0.2879921926701706, 'recall': 0.31064950880047665, 'f1-score': 0.2988920851039221, 'support': 2296012}, 'accuracy': 0.3554953933031633, 'macro avg': {'precision': 0.34497567010337077, 'recall': 0.34635492145535035, 'f1-score': 0.34398188494594173, 'support': 8449004}, 'weighted avg': {'precision': 0.36738296900539347, 'recall': 0.3554953933031633, 'f1-score': 0.3595700119224192, 'support': 8449004}}
[[ 754501  870092  634228]
 [1229181 1535826 1129164]
 [ 664653  918104  713255]]
Evaluating performance on  train set...
8838/8838 - 58s - 58s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980327
{'0': {'precision': 0.3485014198828007, 'recall': 0.33624463504944796, 'f1-score': 0.3422633307593168, 'support': 746745}, '1': {'precision': 0.33186971751295596, 'recall': 0.3863023957100542, 'f1-score': 0.3570232387986469, 'support': 747795}, '2': {'precision': 0.35267613020888433, 'recall': 0.3083856442648197, 'f1-score': 0.32904717783108345, 'support': 767526}, 'accuracy': 0.34334011474466264, 'macro avg': {'precision': 0.344349089201547, 'recall': 0.34364422500810726, 'f1-score': 0.3427779157963491, 'support': 2262066}, 'weighted avg': {'precision': 0.344419794874547, 'recall': 0.34334011474466264, 'f1-score': 0.34265838750826916, 'support': 2262066}}
[[251089 282595 213061]
 [237538 288875 221382]
 [231855 298977 236694]]
Evaluating performance on  val set...
3279/3279 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980543
{'0': {'precision': 0.3519363247067585, 'recall': 0.3240602175116524, 'f1-score': 0.33742350681396005, 'support': 279985}, '1': {'precision': 0.3372039729777242, 'recall': 0.37934017968131994, 'f1-score': 0.35703317157481884, 'support': 283168}, '2': {'precision': 0.3426255361618809, 'recall': 0.32621381759097057, 'f1-score': 0.3342183247094671, 'support': 275721}, 'accuracy': 0.3434282144875154, 'macro avg': {'precision': 0.3439219446154545, 'recall': 0.3432047382613143, 'f1-score': 0.3428916676994153, 'support': 838874}, 'weighted avg': {'precision': 0.3439030437816262, 'recall': 0.3434282144875154, 'f1-score': 0.3429894124636404, 'support': 838874}}
[[ 90732 105216  84037]
 [ 87218 107417  88533]
 [ 79858 105919  89944]]
testing model out of sample: results/universal/W0/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 154s - 154s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980792
{'0': {'precision': 0.34747042942538503, 'recall': 0.3191732471293159, 'f1-score': 0.33272126967221854, 'support': 1926283}, '1': {'precision': 0.33412086240981365, 'recall': 0.40382818650500696, 'f1-score': 0.3656822165130761, 'support': 1958682}, '2': {'precision': 0.3478024792964538, 'recall': 0.30285070686298016, 'f1-score': 0.32377379822072455, 'support': 1947973}, 'accuracy': 0.34214901649906104, 'macro avg': {'precision': 0.3431312570438842, 'recall': 0.34195071349910106, 'f1-score': 0.340725761468673, 'support': 5832938}, 'weighted avg': {'precision': 0.3430985790066599, 'recall': 0.34214901649906104, 'f1-score': 0.3408013453518098, 'support': 5832938}}
[[614818 772337 539128]
 [600577 790971 567134]
 [554016 804012 589945]]
Evaluating performance on  train set...
6334/6334 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980958
{'0': {'precision': 0.34651397895122316, 'recall': 0.33235373244752003, 'f1-score': 0.3392861740688574, 'support': 535252}, '1': {'precision': 0.34118520142957715, 'recall': 0.3914789956111321, 'f1-score': 0.3646058876973109, 'support': 548433}, '2': {'precision': 0.347663078480081, 'recall': 0.30949894547167106, 'f1-score': 0.3274728369785404, 'support': 537207}, 'accuracy': 0.3447842299178477, 'macro avg': {'precision': 0.3451207529536271, 'recall': 0.3444438911767744, 'f1-score': 0.3437882995815696, 'support': 1620892}, 'weighted avg': {'precision': 0.34509181564118785, 'recall': 0.3447842299178477, 'f1-score': 0.34393790850034067, 'support': 1620892}}
[[177893 204166 153193]
 [174955 214700 158778]
 [160531 210411 166265]]
Evaluating performance on  val set...
2156/2156 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978
{'0': {'precision': 0.3429567388698299, 'recall': 0.3478862663349248, 'f1-score': 0.34540391521939307, 'support': 178452}, '1': {'precision': 0.34064968854451533, 'recall': 0.3801130554098656, 'f1-score': 0.35930101832585926, 'support': 188757}, '2': {'precision': 0.3496421168646557, 'recall': 0.30324623481297625, 'f1-score': 0.32479567202815507, 'support': 184121}, 'accuracy': 0.3440117533963325, 'macro avg': {'precision': 0.3444161814263336, 'recall': 0.3437485188525889, 'f1-score': 0.34316686852446915, 'support': 551330}, 'weighted avg': {'precision': 0.34439951648673794, 'recall': 0.3440117533963325, 'f1-score': 0.3432795344428224, 'support': 551330}}
[[62081 67112 49259]
 [62412 71749 54596]
 [56524 71763 55834]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977412
{'0': {'precision': 0.3227778014395843, 'recall': 0.21934559557748803, 'f1-score': 0.26119473715954816, 'support': 69101}, '1': {'precision': 0.3452685421994885, 'recall': 0.5121000925830675, 'f1-score': 0.4124528126019481, 'support': 77768}, '2': {'precision': 0.34903875693243, 'recall': 0.2793312715932765, 'f1-score': 0.31031855557472254, 'support': 77281}, 'accuracy': 0.34159714476912784, 'macro avg': {'precision': 0.33902836685716764, 'recall': 0.3369256532512774, 'f1-score': 0.32798870177873957, 'support': 224150}, 'weighted avg': {'precision': 0.33963496329039333, 'recall': 0.34159714476912784, 'f1-score': 0.3306097530950719, 'support': 224150}}
[[15157 35501 18443]
 [16126 39825 21817]
 [15675 40019 21587]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987573
{'0': {'precision': 0.34547960308710035, 'recall': 0.23082022761592574, 'f1-score': 0.27674372391865937, 'support': 27151}, '1': {'precision': 0.33896401777607876, 'recall': 0.5175281800605552, 'f1-score': 0.4096322924336264, 'support': 27413}, '2': {'precision': 0.33154349771560454, 'recall': 0.2640186039533401, 'f1-score': 0.29395306105403823, 'support': 26661}, 'accuracy': 0.3384795321637427, 'macro avg': {'precision': 0.33866237285959455, 'recall': 0.3374556705432737, 'f1-score': 0.32677635913544134, 'support': 81225}, 'weighted avg': {'precision': 0.3387062913549922, 'recall': 0.3384795321637427, 'f1-score': 0.32724163054921807, 'support': 81225}}
[[ 6267 13819  7065]
 [ 6099 14187  7127]
 [ 5774 13848  7039]]
Evaluating performance on  val set...
104/104 - 1s - 771ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982468
{'0': {'precision': 0.3664536741214057, 'recall': 0.25480395423747637, 'f1-score': 0.30059621306427303, 'support': 9003}, '1': {'precision': 0.3075402635431918, 'recall': 0.5197327724854633, 'f1-score': 0.3864232166674332, 'support': 8083}, '2': {'precision': 0.3623916020082154, 'recall': 0.2532156904432869, 'f1-score': 0.2981226533166458, 'support': 9407}, 'accuracy': 0.3350696410372551, 'macro avg': {'precision': 0.3454618465576043, 'recall': 0.3425841390554089, 'f1-score': 0.32838069434945066, 'support': 26493}, 'weighted avg': {'precision': 0.347036884400631, 'recall': 0.3350696410372551, 'f1-score': 0.3259036864941758, 'support': 26493}}
[[2294 4530 2179]
 [1870 4201 2012]
 [2096 4929 2382]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
2359/2359 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968503
{'0': {'precision': 0.32930380675033, 'recall': 0.25818143988961834, 'f1-score': 0.2894375015345332, 'support': 182639}, '1': {'precision': 0.3740668390464534, 'recall': 0.40747510065691883, 'f1-score': 0.3900569250339141, 'support': 226512}, '2': {'precision': 0.33465826194306236, 'recall': 0.3676990422952033, 'f1-score': 0.35040148844496677, 'support': 194632}, 'accuracy': 0.3494931125917755, 'macro avg': {'precision': 0.3460096359132819, 'recall': 0.34445186094724684, 'f1-score': 0.3432986383378047, 'support': 603783}, 'weighted avg': {'precision': 0.347822897706073, 'recall': 0.3494931125917755, 'f1-score': 0.3468373447829242, 'support': 603783}}
[[47154 73356 62129]
 [54061 92298 80153]
 [41978 81088 71566]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980012
{'0': {'precision': 0.3657756454192369, 'recall': 0.3103434907342793, 'f1-score': 0.3357872438599803, 'support': 51588}, '1': {'precision': 0.3365199118092876, 'recall': 0.386038056472169, 'f1-score': 0.35958220218101505, 'support': 50609}, '2': {'precision': 0.3400302794713368, 'recall': 0.34263096047993075, 'f1-score': 0.3413256661703548, 'support': 48507}, 'accuracy': 0.34615537742860175, 'macro avg': {'precision': 0.34744194556662045, 'recall': 0.3463375025621263, 'f1-score': 0.34556503740378336, 'support': 150704}, 'weighted avg': {'precision': 0.34766442150812166, 'recall': 0.34615537742860175, 'f1-score': 0.34556064932153796, 'support': 150704}}
[[16010 19496 16082]
 [14896 19537 16176]
 [12864 19023 16620]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098241
{'0': {'precision': 0.35383159886471144, 'recall': 0.2846415343244203, 'f1-score': 0.3154875717017208, 'support': 19709}, '1': {'precision': 0.30862599848275246, 'recall': 0.3768731949212577, 'f1-score': 0.33935230618253187, 'support': 18351}, '2': {'precision': 0.3655071758696181, 'recall': 0.3619153138397803, 'f1-score': 0.363702376918236, 'support': 20759}, 'accuracy': 0.34068923307094645, 'macro avg': {'precision': 0.342654924405694, 'recall': 0.3411433476951528, 'f1-score': 0.3395140849341629, 'support': 58819}, 'weighted avg': {'precision': 0.3438485207851033, 'recall': 0.34068923307094645, 'f1-score': 0.3399496143061004, 'support': 58819}}
[[5610 7476 6623]
 [5016 6916 6419]
 [5229 8017 7513]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
1625/1625 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972
{'0': {'precision': 0.2821210486399425, 'recall': 0.3139727124012391, 'f1-score': 0.2971958998941616, 'support': 114924}, '1': {'precision': 0.4324771021279526, 'recall': 0.3173783158509467, 'f1-score': 0.3660941856962882, 'support': 178084}, '2': {'precision': 0.3010848414707042, 'recall': 0.38545075628062975, 'f1-score': 0.33808408545641494, 'support': 122838}, 'accuracy': 0.3365452595431963, 'macro avg': {'precision': 0.33856099741286644, 'recall': 0.3389339281776052, 'f1-score': 0.3337913903489549, 'support': 415846}, 'weighted avg': {'precision': 0.3521120592859602, 'recall': 0.3365452595431963, 'f1-score': 0.33877933526899273, 'support': 415846}}
[[36083 35669 43172]
 [54826 56520 66738]
 [36990 38500 47348]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980195
{'0': {'precision': 0.3401761900913279, 'recall': 0.3368637285241703, 'f1-score': 0.3385118560915781, 'support': 37484}, '1': {'precision': 0.3165389740173218, 'recall': 0.3124708848272271, 'f1-score': 0.3144917743425679, 'support': 36493}, '2': {'precision': 0.3727691762203049, 'recall': 0.38026572785802126, 'f1-score': 0.3764801375095493, 'support': 41471}, 'accuracy': 0.3447439539879426, 'macro avg': {'precision': 0.3431614467763182, 'recall': 0.3432001137364729, 'f1-score': 0.34316125598123176, 'support': 115448}, 'weighted avg': {'precision': 0.3444124765715276, 'recall': 0.3447439539879426, 'f1-score': 0.3445580219447592, 'support': 115448}}
[[12627 11446 13411]
 [11966 11403 13124]
 [12526 13175 15770]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980809
{'0': {'precision': 0.36627131728542356, 'recall': 0.33642751240894736, 'f1-score': 0.35071567770983136, 'support': 15513}, '1': {'precision': 0.3236196319018405, 'recall': 0.30192150449713817, 'f1-score': 0.3123942470389171, 'support': 14676}, '2': {'precision': 0.3453032243045047, 'recall': 0.39728137136734964, 'f1-score': 0.3694731597957404, 'support': 14934}, 'accuracy': 0.34534494603638943, 'macro avg': {'precision': 0.3450647244972562, 'recall': 0.3452101294244783, 'f1-score': 0.34419436151482957, 'support': 45123}, 'weighted avg': {'precision': 0.34545945559035657, 'recall': 0.34534494603638943, 'f1-score': 0.3444598640658943, 'support': 45123}}
[[5219 4683 5611]
 [4607 4431 5638]
 [4423 4578 5933]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097726
{'0': {'precision': 0.30014690315193676, 'recall': 0.2860864014496335, 'f1-score': 0.2929480353810634, 'support': 97128}, '1': {'precision': 0.38370645045244484, 'recall': 0.44229312365930096, 'f1-score': 0.41092206305635504, 'support': 125401}, '2': {'precision': 0.32766195383017815, 'recall': 0.280876455052333, 'f1-score': 0.302470728893992, 'support': 102230}, 'accuracy': 0.3447633475900591, 'macro avg': {'precision': 0.33717176914485325, 'recall': 0.3364186600537558, 'f1-score': 0.3354469424438035, 'support': 324759}, 'weighted avg': {'precision': 0.34107360394196146, 'recall': 0.3447633475900591, 'f1-score': 0.34149962595233607, 'support': 324759}}
[[27787 43931 25410]
 [36428 55464 33509]
 [28363 45153 28714]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980725
{'0': {'precision': 0.3541351275581721, 'recall': 0.30377068103116583, 'f1-score': 0.3270251378569395, 'support': 41584}, '1': {'precision': 0.33873820168902136, 'recall': 0.4150819352796513, 'f1-score': 0.3730441823314441, 'support': 41069}, '2': {'precision': 0.3473692464518153, 'recall': 0.31946347443571066, 'f1-score': 0.33283245679939893, 'support': 41601}, 'accuracy': 0.34581582886667633, 'macro avg': {'precision': 0.34674752523300295, 'recall': 0.34610536358217586, 'f1-score': 0.34430059232926086, 'support': 124254}, 'weighted avg': {'precision': 0.34678080682462875, 'recall': 0.34581582886667633, 'f1-score': 0.34417988871283695, 'support': 124254}}
[[12632 16573 12379]
 [11432 17047 12590]
 [11606 16705 13290]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977235
{'0': {'precision': 0.32034073309241096, 'recall': 0.26481257557436516, 'f1-score': 0.28994198045247455, 'support': 14059}, '1': {'precision': 0.3438236745435605, 'recall': 0.4047634415542503, 'f1-score': 0.371813115142891, 'support': 15493}, '2': {'precision': 0.35860263124281516, 'recall': 0.3516628045343521, 'f1-score': 0.355098814229249, 'support': 15967}, 'accuracy': 0.3429117511368879, 'macro avg': {'precision': 0.3409223462929289, 'recall': 0.34041294055432253, 'f1-score': 0.3389513032748715, 'support': 45519}, 'weighted avg': {'precision': 0.34175484455510047, 'recall': 0.3429117511368879, 'f1-score': 0.34066340787118715, 'support': 45519}}
[[3723 5649 4687]
 [3866 6271 5356]
 [4033 6319 5615]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981575
{'0': {'precision': 0.32820224566916334, 'recall': 0.34476061748595005, 'f1-score': 0.3362777207249715, 'support': 140570}, '1': {'precision': 0.3336467544245722, 'recall': 0.34231663929939793, 'f1-score': 0.3379260970288871, 'support': 146160}, '2': {'precision': 0.36577625148231163, 'recall': 0.34036880409753983, 'f1-score': 0.35261544154574054, 'support': 156777}, 'accuracy': 0.34240271292223123, 'macro avg': {'precision': 0.342541750525349, 'recall': 0.342482020294296, 'f1-score': 0.3422730864331997, 'support': 443507}, 'weighted avg': {'precision': 0.34327869160814173, 'recall': 0.34240271292223123, 'f1-score': 0.3425962355121068, 'support': 443507}}
[[48463 47206 44901]
 [48503 50033 47624]
 [50696 52719 53362]]
Evaluating performance on  train set...
765/765 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098168
{'0': {'precision': 0.31603642107219176, 'recall': 0.3364989860018796, 'f1-score': 0.3259468653426922, 'support': 60651}, '1': {'precision': 0.33777602523659306, 'recall': 0.32480434386944124, 'f1-score': 0.3311632078681223, 'support': 65932}, '2': {'precision': 0.3650311273714336, 'recall': 0.357670458651942, 'f1-score': 0.3613133090452445, 'support': 69181}, 'accuracy': 0.3400420914979261, 'macro avg': {'precision': 0.3396145245600728, 'recall': 0.33965792950775436, 'f1-score': 0.3394744607520197, 'support': 195764}, 'weighted avg': {'precision': 0.34067240295984813, 'recall': 0.3400420914979261, 'f1-score': 0.3402018347812658, 'support': 195764}}
[[20409 19579 20663]
 [22138 21415 22379]
 [22031 22406 24744]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981961
{'0': {'precision': 0.3341117130580983, 'recall': 0.34364492266308005, 'f1-score': 0.3388112716078617, 'support': 20818}, '1': {'precision': 0.3474781313977294, 'recall': 0.333497074978788, 'f1-score': 0.340344081121112, 'support': 22393}, '2': {'precision': 0.3413404235811864, 'recall': 0.3462128609289999, 'f1-score': 0.3437593776690289, 'support': 21507}, 'accuracy': 0.34098705151580705, 'macro avg': {'precision': 0.340976756012338, 'recall': 0.3411182861902893, 'f1-score': 0.3409715767993342, 'support': 64718}, 'weighted avg': {'precision': 0.34113884744264994, 'recall': 0.34098705151580705, 'f1-score': 0.34098598529629054, 'support': 64718}}
[[7154 6819 6845]
 [7402 7468 7523]
 [6856 7205 7446]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0947493
{'0': {'precision': 0.2828162428266976, 'recall': 0.323309035986341, 'f1-score': 0.3017100590446834, 'support': 304560}, '1': {'precision': 0.4911413376923401, 'recall': 0.38221017940126034, 'f1-score': 0.4298823901181721, 'support': 580152}, '2': {'precision': 0.287551489009867, 'recall': 0.36484398451694444, 'f1-score': 0.32161912600955134, 'support': 316475}, 'accuracy': 0.3627003955254261, 'macro avg': {'precision': 0.3538363565096349, 'recall': 0.35678773330151525, 'f1-score': 0.3510705250574689, 'support': 1201187}, 'weighted avg': {'precision': 0.3846811543453127, 'recall': 0.3627003955254261, 'f1-score': 0.36886043295370274, 'support': 1201187}}
[[ 98467 111073  95020]
 [167354 221740 191058]
 [ 82345 118666 115464]]
Evaluating performance on  train set...
1497/1497 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975533
{'0': {'precision': 0.3528015820698748, 'recall': 0.31868524473026083, 'f1-score': 0.33487673632836945, 'support': 125955}, '1': {'precision': 0.32767086544909185, 'recall': 0.35912977509443506, 'f1-score': 0.342679832449205, 'support': 126542}, '2': {'precision': 0.35884819638511806, 'recall': 0.3589333414975775, 'f1-score': 0.35889076389128044, 'support': 130651}, 'accuracy': 0.34576717091045756, 'macro avg': {'precision': 0.34644021463469493, 'recall': 0.34558278710742446, 'f1-score': 0.3454824442229516, 'support': 383148}, 'weighted avg': {'precision': 0.34656353584302185, 'recall': 0.34576717091045756, 'f1-score': 0.3456424876945378, 'support': 383148}}
[[40140 45310 40505]
 [37815 45445 43282]
 [35820 47936 46895]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972383
{'0': {'precision': 0.3675559459959312, 'recall': 0.3386657010181911, 'f1-score': 0.3525198997804927, 'support': 46946}, '1': {'precision': 0.3314247502821081, 'recall': 0.3393311795288731, 'f1-score': 0.3353313670144725, 'support': 46739}, '2': {'precision': 0.35318022289267903, 'recall': 0.3728872323827685, 'f1-score': 0.3627662826364221, 'support': 46148}, 'accuracy': 0.3501820028176468, 'macro avg': {'precision': 0.3507203063902395, 'recall': 0.35029470430994425, 'f1-score': 0.3502058498104625, 'support': 139833}, 'weighted avg': {'precision': 0.3507348320511738, 'recall': 0.3501820028176468, 'f1-score': 0.35015618909048685, 'support': 139833}}
[[15899 15740 15307]
 [14671 15860 16208]
 [12686 16254 17208]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
6677/6677 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0953605
{'0': {'precision': 0.2985449799390922, 'recall': 0.3639879945429741, 'f1-score': 0.32803435516202833, 'support': 458125}, '1': {'precision': 0.49919011152053416, 'recall': 0.40111492791004505, 'f1-score': 0.4448105849159939, 'support': 841310}, '2': {'precision': 0.26284091651166075, 'recall': 0.30444118034578843, 'f1-score': 0.28211572094116955, 'support': 409846}, 'accuracy': 0.3679839651877017, 'macro avg': {'precision': 0.35352533599042907, 'recall': 0.35651470093293586, 'f1-score': 0.3516535536730639, 'support': 1709281}, 'weighted avg': {'precision': 0.3887417282041837, 'recall': 0.3679839651877017, 'f1-score': 0.37450151959749955, 'support': 1709281}}
[[166752 172220 119153]
 [273062 337462 230786]
 [118735 166337 124774]]
Evaluating performance on  train set...
2262/2262 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980954
{'0': {'precision': 0.35159948510090533, 'recall': 0.3418936043654796, 'f1-score': 0.34667862471907757, 'support': 193335}, '1': {'precision': 0.33930339749014243, 'recall': 0.3863176290313488, 'f1-score': 0.36128744688958064, 'support': 195127}, '2': {'precision': 0.34676793008792367, 'recall': 0.3072401493940715, 'f1-score': 0.325809524340042, 'support': 190369}, 'accuracy': 0.3454721671783301, 'macro avg': {'precision': 0.34589027089299046, 'recall': 0.3451504609303, 'f1-score': 0.3445918653162334, 'support': 578831}, 'weighted avg': {'precision': 0.34586538139275624, 'recall': 0.3454721671783301, 'f1-score': 0.3447397960689312, 'support': 578831}}
[[66100 72898 54337]
 [63903 75381 55843]
 [57995 73885 58489]]
Evaluating performance on  val set...
827/827 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973997
{'0': {'precision': 0.32930392279040144, 'recall': 0.36192360371328564, 'f1-score': 0.3448440864502751, 'support': 65710}, '1': {'precision': 0.3597494066909945, 'recall': 0.3716323087467707, 'f1-score': 0.3655943257997173, 'support': 75868}, '2': {'precision': 0.35118334946121926, 'recall': 0.30594690366644756, 'f1-score': 0.3270081018960422, 'support': 69986}, 'accuracy': 0.34688793934695883, 'macro avg': {'precision': 0.3467455596475384, 'recall': 0.34650093870883464, 'f1-score': 0.34581550471534483, 'support': 211564}, 'weighted avg': {'precision': 0.34745961812398396, 'recall': 0.34688793934695883, 'f1-score': 0.34638503833221596, 'support': 211564}}
[[23782 23964 17964]
 [26078 28195 21595]
 [22359 26215 21412]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
5633/5633 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964643
{'0': {'precision': 0.2976149792045901, 'recall': 0.3212560447088878, 'f1-score': 0.30898396393091265, 'support': 398489}, '1': {'precision': 0.410722906106686, 'recall': 0.4146147494382327, 'f1-score': 0.412659651864626, 'support': 590992}, '2': {'precision': 0.32975663343724554, 'recall': 0.30259888404502727, 'f1-score': 0.31559458730381973, 'support': 452348}, 'accuracy': 0.3536695405627158, 'macro avg': {'precision': 0.3460315062495072, 'recall': 0.3461565593973826, 'f1-score': 0.3457460676997861, 'support': 1441829}, 'weighted avg': {'precision': 0.3540607109415413, 'recall': 0.3536695405627158, 'f1-score': 0.35355360736630537, 'support': 1441829}}
[[128017 161007 109465]
 [177209 245034 168749]
 [124917 190551 136880]]
Evaluating performance on  train set...
1454/1454 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981492
{'0': {'precision': 0.34648977434583583, 'recall': 0.3153376433853203, 'f1-score': 0.33018054547782666, 'support': 122659}, '1': {'precision': 0.33429672447013487, 'recall': 0.4123756654239992, 'f1-score': 0.36925386841203783, 'support': 122854}, '2': {'precision': 0.35075380575499937, 'recall': 0.3018012324221836, 'f1-score': 0.32444138704170805, 'support': 126580}, 'accuracy': 0.3427718339232396, 'macro avg': {'precision': 0.3438467681903233, 'recall': 0.3431715137438343, 'f1-score': 0.3412919336438575, 'support': 372093}, 'weighted avg': {'precision': 0.3439145475781798, 'recall': 0.3427718339232396, 'f1-score': 0.3411290216408173, 'support': 372093}}
[[38679 48921 35059]
 [36539 50662 35653]
 [36413 51965 38202]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986011
{'0': {'precision': 0.355444916288378, 'recall': 0.298473204221744, 'f1-score': 0.3244772694359968, 'support': 48795}, '1': {'precision': 0.3252484085622058, 'recall': 0.38965584289325295, 'f1-score': 0.3545508158049931, 'support': 46287}, '2': {'precision': 0.3446926037883566, 'recall': 0.33489688979039894, 'f1-score': 0.3397241482783381, 'support': 47328}, 'accuracy': 0.3402148725510849, 'macro avg': {'precision': 0.3417953095463135, 'recall': 0.341008645635132, 'f1-score': 0.339584077839776, 'support': 142410}, 'weighted avg': {'precision': 0.34205687332003065, 'recall': 0.3402148725510849, 'f1-score': 0.33931905387973005, 'support': 142410}}
[[14564 18951 15280]
 [13398 18036 14853]
 [13012 18466 15850]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
11876/11876 - 81s - 81s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997512
{'0': {'precision': 0.3913093390447228, 'recall': 0.3040365943983847, 'f1-score': 0.34219617337900077, 'support': 1143563}, '1': {'precision': 0.23685003267312507, 'recall': 0.4286457168418698, 'f1-score': 0.3051101441690107, 'support': 715360}, '2': {'precision': 0.3995332528194447, 'recall': 0.28986540312606085, 'f1-score': 0.33597648150892, 'support': 1181231}, 'accuracy': 0.3278514838393055, 'macro avg': {'precision': 0.34256420817909755, 'recall': 0.3408492381221051, 'f1-score': 0.3277609330189772, 'support': 3040154}, 'weighted avg': {'precision': 0.35815981191091395, 'recall': 0.3278514838393055, 'f1-score': 0.33105306855501954, 'support': 3040154}}
[[347685 482017 313861]
 [207988 306636 200736]
 [332844 505989 342398]]
Evaluating performance on  train set...
2538/2538 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979991
{'0': {'precision': 0.35292801229877063, 'recall': 0.33487358688276375, 'f1-score': 0.3436638400682173, 'support': 216631}, '1': {'precision': 0.3461885388556821, 'recall': 0.41390713659226375, 'f1-score': 0.3770312382171369, 'support': 223468}, '2': {'precision': 0.3374111049555101, 'recall': 0.2848633814580599, 'f1-score': 0.30891855731731616, 'support': 209525}, 'accuracy': 0.34593087693804414, 'macro avg': {'precision': 0.3455092187033209, 'recall': 0.34454803497769576, 'f1-score': 0.3432045452008901, 'support': 649624}, 'weighted avg': {'precision': 0.3456049505546282, 'recall': 0.34593087693804414, 'f1-score': 0.3439355978252586, 'support': 649624}}
[[72544 87006 57081]
 [70846 92495 60127]
 [62159 87680 59686]]
Evaluating performance on  val set...
795/795 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979075
{'0': {'precision': 0.351467944877172, 'recall': 0.34808924756705434, 'f1-score': 0.3497704370639795, 'support': 67408}, '1': {'precision': 0.3330425013147201, 'recall': 0.41137044746593443, 'f1-score': 0.36808559822991316, 'support': 67737}, '2': {'precision': 0.35206776847030413, 'recall': 0.2732730973684596, 'f1-score': 0.3077062601512066, 'support': 68287}, 'accuracy': 0.3440461677612175, 'macro avg': {'precision': 0.3455260715540654, 'recall': 0.34424426413381615, 'f1-score': 0.3418540984816998, 'support': 203432}, 'weighted avg': {'precision': 0.3455341482429866, 'recall': 0.3440461677612175, 'f1-score': 0.3417489734941101, 'support': 203432}}
[[23464 27199 16745]
 [22274 27865 17598]
 [21022 28604 18661]]
testing model on single stock: results/universal/W0/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
19053/19053 - 110s - 110s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0963624
{'0': {'precision': 0.27730268952962595, 'recall': 0.35527290253564836, 'f1-score': 0.311482556791303, 'support': 1276005}, '1': {'precision': 0.4885268441323003, 'recall': 0.3881129291969935, 'f1-score': 0.43256897584620313, 'support': 2371114}, '2': {'precision': 0.26482780037338555, 'recall': 0.2925067888455671, 'f1-score': 0.27797998180163785, 'support': 1230327}, 'accuracy': 0.35540506240356123, 'macro avg': {'precision': 0.34355244467843726, 'recall': 0.3452975401927363, 'f1-score': 0.3406771714797146, 'support': 4877446}, 'weighted avg': {'precision': 0.37684010258671274, 'recall': 0.35540506240356123, 'f1-score': 0.3618963554989936, 'support': 4877446}}
[[453330 479967 342708]
 [794524 920260 656330]
 [386930 483518 359879]]
Evaluating performance on  train set...
4812/4812 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981464
{'0': {'precision': 0.3459515032733244, 'recall': 0.3548087584175188, 'f1-score': 0.3503241552336624, 'support': 404959}, '1': {'precision': 0.3305544797109823, 'recall': 0.384012627821037, 'f1-score': 0.35528390001114624, 'support': 406721}, '2': {'precision': 0.35233386524358873, 'recall': 0.28848584082801226, 'f1-score': 0.31722910642084184, 'support': 420187}, 'accuracy': 0.34182829802243264, 'macro avg': {'precision': 0.34294661607596516, 'recall': 0.34243574235552265, 'f1-score': 0.3409457205552168, 'support': 1231867}, 'weighted avg': {'precision': 0.3430449335778135, 'recall': 0.34182829802243264, 'f1-score': 0.3406730509181237, 'support': 1231867}}
[[143683 152366 108910]
 [136620 156186 113915]
 [135024 163945 121218]]
Evaluating performance on  val set...
1767/1767 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982192
{'0': {'precision': 0.34713099347254023, 'recall': 0.3375089715303437, 'f1-score': 0.34225236790764907, 'support': 150476}, '1': {'precision': 0.3447995743780141, 'recall': 0.38562233681812946, 'f1-score': 0.3640701779819451, 'support': 156298}, '2': {'precision': 0.3310973053321645, 'recall': 0.2984833595612944, 'f1-score': 0.3139455880652249, 'support': 145519}, 'accuracy': 0.34157946287030755, 'macro avg': {'precision': 0.3410092910609063, 'recall': 0.34053822263658917, 'f1-score': 0.34008937798493966, 'support': 452293}, 'weighted avg': {'precision': 0.34116671278251054, 'recall': 0.34157946287030755, 'f1-score': 0.34068459167211723, 'support': 452293}}
[[50787 57458 42231]
 [50507 60272 45519]
 [45011 57073 43435]]
training model: results/universal/W0/deepLOB_L2/h300
Epoch 1/50
8838/8838 - 370s - loss: 3.2500 - accuracy300: 0.3984 - val_loss: 3.3827 - val_accuracy300: 0.3367 - 370s/epoch - 42ms/step
Epoch 2/50
8838/8838 - 362s - loss: 3.2251 - accuracy300: 0.4123 - val_loss: 3.4588 - val_accuracy300: 0.3382 - 362s/epoch - 41ms/step
Epoch 3/50
8838/8838 - 361s - loss: 3.2130 - accuracy300: 0.4183 - val_loss: 3.5474 - val_accuracy300: 0.3399 - 361s/epoch - 41ms/step
Epoch 4/50
8838/8838 - 359s - loss: 3.2044 - accuracy300: 0.4218 - val_loss: 3.6601 - val_accuracy300: 0.3410 - 359s/epoch - 41ms/step
Epoch 5/50
8838/8838 - 360s - loss: 3.1967 - accuracy300: 0.4252 - val_loss: 3.5979 - val_accuracy300: 0.3373 - 360s/epoch - 41ms/step
Epoch 6/50
8838/8838 - 360s - loss: 3.1898 - accuracy300: 0.4276 - val_loss: 3.8817 - val_accuracy300: 0.3410 - 360s/epoch - 41ms/step
Epoch 7/50
8838/8838 - 362s - loss: 3.1849 - accuracy300: 0.4298 - val_loss: 3.8623 - val_accuracy300: 0.3406 - 362s/epoch - 41ms/step
Epoch 8/50
8838/8838 - 362s - loss: 3.1808 - accuracy300: 0.4313 - val_loss: 3.9114 - val_accuracy300: 0.3406 - 362s/epoch - 41ms/step
Epoch 9/50
8838/8838 - 362s - loss: 3.1771 - accuracy300: 0.4330 - val_loss: 3.9495 - val_accuracy300: 0.3408 - 362s/epoch - 41ms/step
Epoch 10/50
8838/8838 - 362s - loss: 3.1740 - accuracy300: 0.4344 - val_loss: 3.9572 - val_accuracy300: 0.3408 - 362s/epoch - 41ms/step
Epoch 11/50
8838/8838 - 361s - loss: 3.1705 - accuracy300: 0.4356 - val_loss: 3.9740 - val_accuracy300: 0.3418 - 361s/epoch - 41ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 440s - 440s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1078824
{'0': {'precision': 0.29181529639238585, 'recall': 0.28971623778050887, 'f1-score': 0.2907619787733489, 'support': 2377554}, '1': {'precision': 0.44188553679942544, 'recall': 0.38054139877792864, 'f1-score': 0.4089256637863928, 'support': 3649214}, '2': {'precision': 0.28936577550272236, 'recall': 0.3519273934559488, 'f1-score': 0.3175949723381359, 'support': 2422261}, 'accuracy': 0.34677984890334734, 'macro avg': {'precision': 0.3410222028981779, 'recall': 0.3407283433381288, 'f1-score': 0.33909420496595916, 'support': 8449029}, 'weighted avg': {'precision': 0.3559297695888937, 'recall': 0.34677984890334734, 'f1-score': 0.3494907495547516, 'support': 8449029}}
[[ 688816  849792  838946]
 [1005983 1388677 1254554]
 [ 665653  904148  852460]]
Evaluating performance on  train set...
8838/8838 - 125s - 125s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1322286
{'0': {'precision': 0.33454782066011374, 'recall': 0.5037986546181255, 'f1-score': 0.4020885085681378, 'support': 749081}, '1': {'precision': 0.338814277145667, 'recall': 0.29766719630218114, 'f1-score': 0.3169107040893771, 'support': 747684}, '2': {'precision': 0.3537081204337493, 'recall': 0.22052457379848872, 'f1-score': 0.2716715132774062, 'support': 765307}, 'accuracy': 0.3398282636450122, 'macro avg': {'precision': 0.3423567394131766, 'recall': 0.3406634749062651, 'f1-score': 0.3302235753116403, 'support': 2262072}, 'weighted avg': {'precision': 0.34244035139733436, 'recall': 0.3398282636450122, 'f1-score': 0.32981179899440993, 'support': 2262072}}
[[377386 211845 159850]
 [376600 222561 148523]
 [374062 222476 168769]]
Evaluating performance on  val set...
3279/3279 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128415
{'0': {'precision': 0.3409447748513169, 'recall': 0.35699340265174967, 'f1-score': 0.3487845749488937, 'support': 281022}, '1': {'precision': 0.32790897144341014, 'recall': 0.30309598536562304, 'f1-score': 0.31501461830813166, 'support': 274969}, '2': {'precision': 0.33948324238720673, 'recall': 0.3485785793570555, 'f1-score': 0.3439707962487203, 'support': 282886}, 'accuracy': 0.33648913964740956, 'macro avg': {'precision': 0.3361123295606446, 'recall': 0.33622265579147603, 'f1-score': 0.3359233298352485, 'support': 838877}, 'weighted avg': {'precision': 0.3361790119326638, 'recall': 0.33648913964740956, 'f1-score': 0.3360920803293834, 'support': 838877}}
[[100323  83037  97662]
 [ 97432  83342  94195]
 [ 96495  87783  98608]]
testing model out of sample: results/universal/W0/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 306s - 306s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.132447
{'0': {'precision': 0.35753196370480167, 'recall': 0.42382709752668657, 'f1-score': 0.3878670945754334, 'support': 1995946}, '1': {'precision': 0.31912087242734216, 'recall': 0.3877664084532337, 'f1-score': 0.3501105704136127, 'support': 1837498}, '2': {'precision': 0.31879147048075573, 'recall': 0.19676732254107113, 'f1-score': 0.24333885851413872, 'support': 1999519}, 'accuracy': 0.33463198720787357, 'macro avg': {'precision': 0.3318147688709665, 'recall': 0.33612027617366375, 'f1-score': 0.32710550783439496, 'support': 5832963}, 'weighted avg': {'precision': 0.332151611442838, 'recall': 0.33463198720787357, 'f1-score': 0.32642928129334314, 'support': 5832963}}
[[845936 759014 390996]
 [675253 712520 449725]
 [844854 761225 393440]]
Evaluating performance on  train set...
6334/6334 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1282226
{'0': {'precision': 0.3409479110097115, 'recall': 0.40980091492709575, 'f1-score': 0.3722170745985889, 'support': 548459}, '1': {'precision': 0.32652939567568323, 'recall': 0.35433813932426933, 'f1-score': 0.33986586979333, 'support': 525594}, '2': {'precision': 0.34838472271200993, 'recall': 0.24930556444489957, 'f1-score': 0.2906329642827069, 'support': 546847}, 'accuracy': 0.3376698130668147, 'macro avg': {'precision': 0.3386206764658016, 'recall': 0.3378148728987549, 'f1-score': 0.33423863622487526, 'support': 1620900}, 'weighted avg': {'precision': 0.3387815299994663, 'recall': 0.3376698130668147, 'f1-score': 0.33420262268155243, 'support': 1620900}}
[[224759 191656 132044]
 [216406 186238 122950]
 [218053 192462 136332]]
Evaluating performance on  val set...
2156/2156 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1320608
{'0': {'precision': 0.3248391988462198, 'recall': 0.3854827614671326, 'f1-score': 0.35257226553652415, 'support': 181715}, '1': {'precision': 0.32475711989807, 'recall': 0.3632977000323939, 'f1-score': 0.3429480073696362, 'support': 185220}, '2': {'precision': 0.3289750175110904, 'recall': 0.22923615065484423, 'f1-score': 0.2701951196126372, 'support': 184395}, 'accuracy': 0.3257722235321858, 'macro avg': {'precision': 0.32619044541846004, 'recall': 0.32600553738479027, 'f1-score': 0.3219051308395992, 'support': 551330}, 'weighted avg': {'precision': 0.3261948689892059, 'recall': 0.3257722235321858, 'f1-score': 0.32178754691010053, 'support': 551330}}
[[70048 68835 42832]
 [74542 67290 43388]
 [71049 71076 42270]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
876/876 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1156331
{'0': {'precision': 0.33656438819894113, 'recall': 0.5317319651741294, 'f1-score': 0.41221420048451823, 'support': 64320}, '1': {'precision': 0.45803875360041896, 'recall': 0.22791036025276323, 'f1-score': 0.30437178278837096, 'support': 92102}, '2': {'precision': 0.30963772177971294, 'recall': 0.350671017081777, 'f1-score': 0.32887941180543057, 'support': 67733}, 'accuracy': 0.3521848720751266, 'macro avg': {'precision': 0.368080287859691, 'recall': 0.37010444750288984, 'f1-score': 0.3484884650261066, 'support': 224155}, 'weighted avg': {'precision': 0.37833998145197284, 'recall': 0.3521848720751266, 'f1-score': 0.34272202945888325, 'support': 224155}}
[[34201 11238 18881]
 [37035 20991 34076]
 [30382 13599 23752]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1299345
{'0': {'precision': 0.3247166775088164, 'recall': 0.3390897064607244, 'f1-score': 0.3317475863998881, 'support': 27969}, '1': {'precision': 0.3010746373832873, 'recall': 0.3972263113039436, 'f1-score': 0.3425307322287547, 'support': 25814}, '2': {'precision': 0.3557312252964427, 'recall': 0.23282929495354346, 'f1-score': 0.28144820295983086, 'support': 27445}, 'accuracy': 0.32166248091791005, 'macro avg': {'precision': 0.32717418006284876, 'recall': 0.3230484375727371, 'f1-score': 0.31857550719615785, 'support': 81228}, 'weighted avg': {'precision': 0.3276823868729642, 'recall': 0.32166248091791005, 'f1-score': 0.3181794762397708, 'support': 81228}}
[[ 9484 12296  6189]
 [10176 10254  5384]
 [ 9547 11508  6390]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1194719
{'0': {'precision': 0.3267408892884309, 'recall': 0.5714112951989357, 'f1-score': 0.41575010998680156, 'support': 8269}, '1': {'precision': 0.3619806488332385, 'recall': 0.12669322709163347, 'f1-score': 0.1876936697653829, 'support': 10040}, '2': {'precision': 0.3354073726226814, 'recall': 0.34909579667644186, 'f1-score': 0.34211471680038325, 'support': 8184}, 'accuracy': 0.33420148718529424, 'macro avg': {'precision': 0.34137630358145027, 'recall': 0.34906677298900374, 'f1-score': 0.31518616551752254, 'support': 26493}, 'weighted avg': {'precision': 0.34277281037843105, 'recall': 0.33420148718529424, 'f1-score': 0.30657716929829176, 'support': 26493}}
[[4725 1085 2459]
 [5566 1272 3202]
 [4170 1157 2857]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1493751
{'0': {'precision': 0.32004725742507933, 'recall': 0.5604893109865674, 'f1-score': 0.4074403567835982, 'support': 187529}, '1': {'precision': 0.2932727548084204, 'recall': 0.25267750892502977, 'f1-score': 0.2714658606951505, 'support': 191596}, '2': {'precision': 0.3926055539941432, 'recall': 0.19275092026724472, 'f1-score': 0.25856067255390164, 'support': 224663}, 'accuracy': 0.32598196718053357, 'macro avg': {'precision': 0.33530852207588097, 'recall': 0.3353059133929473, 'f1-score': 0.3124889633442168, 'support': 603788}, 'weighted avg': {'precision': 0.3385492431862309, 'recall': 0.32598196718053357, 'f1-score': 0.3088959570097396, 'support': 603788}}
[[105108  51917  30504]
 [106693  48412  36491]
 [116613  64746  43304]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266286
{'0': {'precision': 0.34219635704028417, 'recall': 0.44550714370055494, 'f1-score': 0.3870769178158316, 'support': 50814}, '1': {'precision': 0.3284655662855797, 'recall': 0.35772919215438653, 'f1-score': 0.3424733874243183, 'support': 50678}, '2': {'precision': 0.3287801887113806, 'recall': 0.19612703960335684, 'f1-score': 0.24569173984981546, 'support': 49213}, 'accuracy': 0.3345542616369729, 'macro avg': {'precision': 0.3331473706790815, 'recall': 0.3331211251527661, 'f1-score': 0.32508068169665516, 'support': 150705}, 'weighted avg': {'precision': 0.3331979899931574, 'recall': 0.3345542616369729, 'f1-score': 0.3259083668293171, 'support': 150705}}
[[22638 18536  9640]
 [22484 18129 10065]
 [21033 18528  9652]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1361822
{'0': {'precision': 0.35439931279911646, 'recall': 0.4401320802641605, 'f1-score': 0.3926402610350766, 'support': 19685}, '1': {'precision': 0.295248778142777, 'recall': 0.4217694860936248, 'f1-score': 0.3473465925157885, 'support': 17474}, '2': {'precision': 0.3861438741897779, 'recall': 0.16776695443423664, 'f1-score': 0.233908341915551, 'support': 21661}, 'accuracy': 0.33437606256375385, 'macro avg': {'precision': 0.3452639883772238, 'recall': 0.34322284026400735, 'f1-score': 0.3246317318221387, 'support': 58820}, 'weighted avg': {'precision': 0.34851734240976323, 'recall': 0.33437606256375385, 'f1-score': 0.32073013414364365, 'support': 58820}}
[[8664 7990 3031]
 [7358 7370 2746]
 [8425 9602 3634]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1271982
{'0': {'precision': 0.29826280441749853, 'recall': 0.6273454070810899, 'f1-score': 0.4043045386373573, 'support': 116451}, '1': {'precision': 0.4187427033658508, 'recall': 0.2417699175706476, 'f1-score': 0.3065479316126649, 'support': 175059}, '2': {'precision': 0.290069012914865, 'recall': 0.16293097208483123, 'f1-score': 0.20865884243213878, 'support': 124341}, 'accuracy': 0.3261697098239514, 'macro avg': {'precision': 0.3356915068994047, 'recall': 0.3440154322455229, 'f1-score': 0.3065037708940537, 'support': 415851}, 'weighted avg': {'precision': 0.3465307330764909, 'recall': 0.3261697098239514, 'f1-score': 0.30465356898479257, 'support': 415851}}
[[ 73055  25135  18261]
 [101413  42324  31322]
 [ 70467  33615  20259]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1379771
{'0': {'precision': 0.3195753018123145, 'recall': 0.5920992926731616, 'f1-score': 0.4151049317452446, 'support': 37465}, '1': {'precision': 0.34385673001138456, 'recall': 0.20555977279271262, 'f1-score': 0.25730246883242414, 'support': 38203}, '2': {'precision': 0.3808517975687559, 'recall': 0.22208536524056105, 'f1-score': 0.28056525881232136, 'support': 39782}, 'accuracy': 0.336691208315288, 'macro avg': {'precision': 0.348094609797485, 'recall': 0.3399148102354785, 'f1-score': 0.3176575531299967, 'support': 115450}, 'weighted avg': {'precision': 0.34872493330362525, 'recall': 0.336691208315288, 'f1-score': 0.3165273244756384, 'support': 115450}}
[[22183  7232  8050]
 [24037  7853  6313]
 [23194  7753  8835]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369905
{'0': {'precision': 0.3376790958440865, 'recall': 0.4909749628000259, 'f1-score': 0.40014763649785134, 'support': 15457}, '1': {'precision': 0.3012826987173013, 'recall': 0.20177218614718614, 'f1-score': 0.24168523394774155, 'support': 14784}, '2': {'precision': 0.318559774082209, 'recall': 0.2728799892487569, 'f1-score': 0.2939558450959103, 'support': 14882}, 'accuracy': 0.32429138133546087, 'macro avg': {'precision': 0.31917385621453226, 'recall': 0.3218757127319896, 'f1-score': 0.31192957184716774, 'support': 45123}, 'weighted avg': {'precision': 0.31944852426013476, 'recall': 0.32429138133546087, 'f1-score': 0.31320628953633484, 'support': 45123}}
[[7589 3600 4268]
 [7382 2983 4419]
 [7503 3318 4061]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1379913
{'0': {'precision': 0.30610535539405187, 'recall': 0.2353588094837067, 'f1-score': 0.2661102864984457, 'support': 100931}, '1': {'precision': 0.32075367596347487, 'recall': 0.2981893721789085, 'f1-score': 0.30906021982695603, 'support': 116976}, '2': {'precision': 0.28636038522393126, 'recall': 0.3709256295797187, 'f1-score': 0.3232030007746565, 'support': 106857}, 'accuracy': 0.3025951152221305, 'macro avg': {'precision': 0.30440647219381933, 'recall': 0.3014912704141113, 'f1-score': 0.29945783570001944, 'support': 324764}, 'weighted avg': {'precision': 0.30488481884893065, 'recall': 0.3025951152221305, 'f1-score': 0.30036552282528267, 'support': 324764}}
[[23755 36532 40644]
 [23962 34881 58133]
 [29887 37334 39636]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1163896
{'0': {'precision': 0.3593830041550458, 'recall': 0.45954535529731433, 'f1-score': 0.4033387986287077, 'support': 41219}, '1': {'precision': 0.35320727210359315, 'recall': 0.4016137682219297, 'f1-score': 0.37585837154655166, 'support': 41022}, '2': {'precision': 0.36050433665274656, 'recall': 0.2136906745370591, 'f1-score': 0.2683284019247437, 'support': 42014}, 'accuracy': 0.3572894450927528, 'macro avg': {'precision': 0.3576982043037951, 'recall': 0.35828326601876764, 'f1-score': 0.3491751907000011, 'support': 124255}, 'weighted avg': {'precision': 0.35772327845663293, 'recall': 0.3572894450927528, 'f1-score': 0.3486156173733494, 'support': 124255}}
[[18942 14826  7451]
 [16072 16475  8475]
 [17693 15343  8978]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1352499
{'0': {'precision': 0.32763908584242984, 'recall': 0.677694406548431, 'f1-score': 0.4417224284729787, 'support': 14660}, '1': {'precision': 0.3763353342150778, 'recall': 0.24922517180972914, 'f1-score': 0.2998662397146447, 'support': 14842}, '2': {'precision': 0.3679210134128167, 'recall': 0.12329878886252965, 'f1-score': 0.1847002712054615, 'support': 16018}, 'accuracy': 0.3429042179261863, 'macro avg': {'precision': 0.35729847782344143, 'recall': 0.3500727890735633, 'f1-score': 0.30876297979769496, 'support': 45520}, 'weighted avg': {'precision': 0.3576914943259381, 'recall': 0.3429042179261863, 'f1-score': 0.3050262406728407, 'support': 45520}}
[[ 9935  3161  1564]
 [ 9314  3699  1829]
 [11074  2969  1975]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1613939
{'0': {'precision': 0.33802533161040776, 'recall': 0.7946820027063599, 'f1-score': 0.47430194782250523, 'support': 147800}, '1': {'precision': 0.2859763180956651, 'recall': 0.10060512202816255, 'f1-score': 0.14884668218920882, 'support': 139476}, '2': {'precision': 0.3321624728573253, 'recall': 0.09986814818607748, 'f1-score': 0.15356527729934552, 'support': 156236}, 'accuracy': 0.3316460433990512, 'macro avg': {'precision': 0.3187213741877994, 'recall': 0.33171842430686665, 'f1-score': 0.2589046357703532, 'support': 443512}, 'weighted avg': {'precision': 0.3195916075868665, 'recall': 0.3316460433990512, 'f1-score': 0.2589665948099012, 'support': 443512}}
[[117454  15902  14444]
 [108517  14032  16927]
 [121500  19133  15603]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1435456
{'0': {'precision': 0.3344345997897582, 'recall': 0.5977579537380595, 'f1-score': 0.42890482502350763, 'support': 63335}, '1': {'precision': 0.35871011902498384, 'recall': 0.14559120865552314, 'f1-score': 0.20711839100649923, 'support': 64791}, '2': {'precision': 0.3406796530641263, 'recall': 0.28339099322865846, 'f1-score': 0.3094058207292861, 'support': 67638}, 'accuracy': 0.3394904068163707, 'macro avg': {'precision': 0.34460812395962276, 'recall': 0.342246718540747, 'f1-score': 0.31514301225309765, 'support': 195764}, 'weighted avg': {'precision': 0.344626657982997, 'recall': 0.3394904068163707, 'f1-score': 0.314213469621858, 'support': 195764}}
[[37859  7743 17733]
 [35995  9433 19363]
 [39349  9121 19168]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1314099
{'0': {'precision': 0.32483536901931853, 'recall': 0.5641609719058466, 'f1-score': 0.4122838960273284, 'support': 21072}, '1': {'precision': 0.3075968992248062, 'recall': 0.22602989427633977, 'f1-score': 0.2605794741127952, 'support': 21944}, '2': {'precision': 0.3671223741247082, 'recall': 0.20293060547414984, 'f1-score': 0.26138049735889374, 'support': 21702}, 'accuracy': 0.32837850366204147, 'macro avg': {'precision': 0.333184880789611, 'recall': 0.3310404905521121, 'f1-score': 0.3114146224996725, 'support': 64718}, 'weighted avg': {'precision': 0.3331704783185303, 'recall': 0.32837850366204147, 'f1-score': 0.3102426186022707, 'support': 64718}}
[[11888  5426  3758]
 [13150  4960  3834]
 [11559  5739  4404]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
4693/4693 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1249056
{'0': {'precision': 0.3404901622367967, 'recall': 0.637523643203288, 'f1-score': 0.44390074556545606, 'support': 379073}, '1': {'precision': 0.35447424250666376, 'recall': 0.15082491598077974, 'f1-score': 0.21161146598167807, 'support': 432044}, '2': {'precision': 0.3433876143135336, 'recall': 0.27078126001409986, 'f1-score': 0.30279271634808336, 'support': 390075}, 'accuracy': 0.34337225023143675, 'macro avg': {'precision': 0.34611733968566466, 'recall': 0.3530432730660558, 'f1-score': 0.3194349759650725, 'support': 1201192}, 'weighted avg': {'precision': 0.3464608660001814, 'recall': 0.34337225023143675, 'f1-score': 0.3145276694831474, 'support': 1201192}}
[[241668  47413  89992]
 [254901  65163 111980]
 [213196  71254 105625]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1293182
{'0': {'precision': 0.34204324458963625, 'recall': 0.5631999873805092, 'f1-score': 0.42560660877235856, 'support': 126788}, '1': {'precision': 0.33220617661201507, 'recall': 0.16936191748973958, 'f1-score': 0.22434870054366612, 'support': 126457}, '2': {'precision': 0.3659861346143348, 'recall': 0.3096671388101983, 'f1-score': 0.33547940521562186, 'support': 129904}, 'accuracy': 0.3472565503237644, 'macro avg': {'precision': 0.3467451852719954, 'recall': 0.3474096812268157, 'f1-score': 0.3284782381772155, 'support': 383149}, 'weighted avg': {'precision': 0.34691422449698933, 'recall': 0.3472565503237644, 'f1-score': 0.32862513276247707, 'support': 383149}}
[[71407 19766 35615]
 [70968 21417 34072]
 [66391 23286 40227]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1328995
{'0': {'precision': 0.3547132635072073, 'recall': 0.4254617824491573, 'f1-score': 0.38687968330270045, 'support': 48237}, '1': {'precision': 0.32022495227027475, 'recall': 0.3548579970104634, 'f1-score': 0.33665310396736225, 'support': 43485}, '2': {'precision': 0.3554621600023678, 'recall': 0.24963106150360626, 'f1-score': 0.29329165547388214, 'support': 48111}, 'accuracy': 0.343009160927678, 'macro avg': {'precision': 0.3434667919266166, 'recall': 0.34331694698774234, 'f1-score': 0.33894148091464826, 'support': 139833}, 'weighted avg': {'precision': 0.344245819807513, 'recall': 0.343009160927678, 'f1-score': 0.3390603816409363, 'support': 139833}}
[[20523 15832 11882]
 [18159 15431  9895]
 [19176 16925 12010]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
6677/6677 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1086061
{'0': {'precision': 0.34970867871701977, 'recall': 0.09959007845909366, 'f1-score': 0.1550305412378539, 'support': 541811}, '1': {'precision': 0.3961414219929028, 'recall': 0.5040537427234401, 'f1-score': 0.4436295022007315, 'support': 681469}, '2': {'precision': 0.280519042510198, 'recall': 0.39704036575680135, 'f1-score': 0.32876049503870897, 'support': 486006}, 'accuracy': 0.3454190814176212, 'macro avg': {'precision': 0.34212304774004015, 'recall': 0.333561395646445, 'f1-score': 0.30914017949243144, 'support': 1709286}, 'weighted avg': {'precision': 0.3485478997678797, 'recall': 0.3454190814176212, 'f1-score': 0.31948812484606787, 'support': 1709286}}
[[ 53959 272709 215143]
 [ 58197 343497 279775]
 [ 42141 250901 192964]]
Evaluating performance on  train set...
2262/2262 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1321964
{'0': {'precision': 0.34490249748903357, 'recall': 0.5433401240527957, 'f1-score': 0.4219553559511004, 'support': 197819}, '1': {'precision': 0.32944900674404737, 'recall': 0.23026727164868288, 'f1-score': 0.27107063653093, 'support': 187113}, '2': {'precision': 0.34532099869518684, 'recall': 0.24294872125466088, 'f1-score': 0.2852273105694798, 'support': 193901}, 'accuracy': 0.3415095545692799, 'macro avg': {'precision': 0.33989083430942263, 'recall': 0.3388520389853798, 'f1-score': 0.3260844343505034, 'support': 578833}, 'weighted avg': {'precision': 0.3400472089837267, 'recall': 0.3415095545692799, 'f1-score': 0.3273785138698646, 'support': 578833}}
[[107483  43353  46983]
 [101700  43086  42327]
 [102450  44343  47108]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1351568
{'0': {'precision': 0.3190353344188112, 'recall': 0.44096156656437235, 'f1-score': 0.37021814344956205, 'support': 68430}, '1': {'precision': 0.34080484229441527, 'recall': 0.2968898043254377, 'f1-score': 0.3173352120118004, 'support': 72825}, '2': {'precision': 0.3291309463775424, 'recall': 0.25063647612681167, 'f1-score': 0.2845700444085587, 'support': 70309}, 'accuracy': 0.3281182053657522, 'macro avg': {'precision': 0.32965704103025634, 'recall': 0.3294959490055405, 'f1-score': 0.3240411332899737, 'support': 211564}, 'weighted avg': {'precision': 0.3298839513491363, 'recall': 0.3281182053657522, 'f1-score': 0.3235512640304317, 'support': 211564}}
[[30175 20225 18030]
 [33315 21621 17889]
 [31092 21595 17622]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
5633/5633 - 75s - 75s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066775
{'0': {'precision': 0.23873353459610508, 'recall': 0.6389894535803059, 'f1-score': 0.34759989855068035, 'support': 356045}, '1': {'precision': 0.4451431033237624, 'recall': 0.25275694875518406, 'f1-score': 0.32243302524585665, 'support': 707213}, '2': {'precision': 0.3577238566584181, 'recall': 0.0824801360889227, 'f1-score': 0.13405199800800233, 'support': 378576}, 'accuracy': 0.30342397252388276, 'macro avg': {'precision': 0.34720016485942856, 'recall': 0.3247421794748042, 'f1-score': 0.2680283072681798, 'support': 1441834}, 'weighted avg': {'precision': 0.37121925104727416, 'recall': 0.30342397252388276, 'f1-score': 0.2791853307388732, 'support': 1441834}}
[[227509 101265  27271]
 [499668 178753  28792]
 [225806 121545  31225]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1180153
{'0': {'precision': 0.3193616882976188, 'recall': 0.23935142332862408, 'f1-score': 0.2736276384428314, 'support': 123162}, '1': {'precision': 0.32, 'recall': 0.4182976749485266, 'f1-score': 0.36260511315537, 'support': 122879}, '2': {'precision': 0.36067100802255714, 'recall': 0.340957050153109, 'f1-score': 0.3505370731349248, 'support': 126054}, 'accuracy': 0.3328666066461522, 'macro avg': {'precision': 0.33334423210672526, 'recall': 0.3328687161434199, 'f1-score': 0.32892327491104206, 'support': 372095}, 'weighted avg': {'precision': 0.33356677058113315, 'recall': 0.3328666066461522, 'f1-score': 0.3290656448548476, 'support': 372095}}
[[29479 53541 40142]
 [35436 51400 36043]
 [27391 55684 42979]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1199701
{'0': {'precision': 0.3422073722785083, 'recall': 0.13042228064410122, 'f1-score': 0.18886443400154662, 'support': 48688}, '1': {'precision': 0.30789972144846794, 'recall': 0.6219251457250242, 'f1-score': 0.411885261173174, 'support': 44433}, '2': {'precision': 0.35273420319601234, 'recall': 0.2440657334144857, 'f1-score': 0.2885065051861622, 'support': 49290}, 'accuracy': 0.32310706335886974, 'macro avg': {'precision': 0.33428043230766286, 'recall': 0.3321377199278704, 'f1-score': 0.2964187334536276, 'support': 142411}, 'weighted avg': {'precision': 0.3351466511726428, 'recall': 0.32310706335886974, 'f1-score': 0.29293534216458617, 'support': 142411}}
[[ 6350 30501 11837]
 [ 6561 27634 10238]
 [ 5645 31615 12030]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
11876/11876 - 161s - 161s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1436682
{'0': {'precision': 0.37397154910025776, 'recall': 0.5045408346393453, 'f1-score': 0.4295532334131334, 'support': 1125564}, '1': {'precision': 0.24940020867516946, 'recall': 0.3888218715972415, 'f1-score': 0.30388248514508154, 'support': 749392}, '2': {'precision': 0.39839508618981573, 'recall': 0.1207935441292204, 'f1-score': 0.18537984699303847, 'support': 1165203}, 'accuracy': 0.32893740097146235, 'macro avg': {'precision': 0.3405889479884143, 'recall': 0.3380520834552691, 'f1-score': 0.30627185518375116, 'support': 3040159}, 'weighted avg': {'precision': 0.35262582762435024, 'recall': 0.32893740097146235, 'f1-score': 0.30499125630504603, 'support': 3040159}}
[[567893 433141 124530]
 [370001 291380  88011]
 [580652 443802 140749]]
Evaluating performance on  train set...
2538/2538 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182959
{'0': {'precision': 0.35026080256060693, 'recall': 0.21306975675054424, 'f1-score': 0.26495982782151056, 'support': 221871}, '1': {'precision': 0.3244859509137093, 'recall': 0.551988095749095, 'f1-score': 0.40871120559511687, 'support': 209673}, '2': {'precision': 0.3485146760012407, 'recall': 0.25246582691752145, 'f1-score': 0.2928149763335638, 'support': 218081}, 'accuracy': 0.3356844333269194, 'macro avg': {'precision': 0.34108714315851896, 'recall': 0.33917455980572025, 'f1-score': 0.3221620032500637, 'support': 649625}, 'weighted avg': {'precision': 0.34135553029498733, 'recall': 0.3356844333269194, 'f1-score': 0.3207080845459015, 'support': 649625}}
[[ 47274 121325  53272]
 [ 44287 115737  49649]
 [ 43407 119616  55058]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1299229
{'0': {'precision': 0.33075968274672335, 'recall': 0.22956181465095565, 'f1-score': 0.2710222375452508, 'support': 68487}, '1': {'precision': 0.3192640976539615, 'recall': 0.5563563777103936, 'f1-score': 0.40571142841268965, 'support': 65627}, '2': {'precision': 0.31777253466872113, 'recall': 0.190412302720794, 'f1-score': 0.23813303985422266, 'support': 69318}, 'accuracy': 0.32164556215344686, 'macro avg': {'precision': 0.322598771689802, 'recall': 0.3254434983607144, 'f1-score': 0.3049555686040543, 'support': 203432}, 'weighted avg': {'precision': 0.32262593833407616, 'recall': 0.32164556215344686, 'f1-score': 0.3032661034243196, 'support': 203432}}
[[15722 38297 14468]
 [15246 36512 13869]
 [16565 39554 13199]]
testing model on single stock: results/universal/W0/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
19053/19053 - 254s - 254s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09691
{'0': {'precision': 0.31182644486365974, 'recall': 0.06714520789142496, 'f1-score': 0.11049719056398986, 'support': 1353976}, '1': {'precision': 0.46478098920311006, 'recall': 0.4819674886491913, 'f1-score': 0.47321824408162755, 'support': 2201385}, '2': {'precision': 0.2747341208468187, 'recall': 0.4785937417271139, 'f1-score': 0.3490804931253524, 'support': 1322090}, 'accuracy': 0.3658987040566886, 'macro avg': {'precision': 0.35044718497119615, 'recall': 0.34256881275591006, 'f1-score': 0.31093197592365657, 'support': 4877451}, 'weighted avg': {'precision': 0.3708065246084435, 'recall': 0.3658987040566886, 'f1-score': 0.3388782209180163, 'support': 4877451}}
[[  90913  612413  650650]
 [ 120669 1060996 1019720]
 [  79968  609378  632744]]
Evaluating performance on  train set...
4812/4812 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1396141
{'0': {'precision': 0.3320548695219025, 'recall': 0.5780303514141558, 'f1-score': 0.4218018016403154, 'support': 407098}, '1': {'precision': 0.3502043534861191, 'recall': 0.2844622376109067, 'f1-score': 0.31392833784286217, 'support': 406648}, '2': {'precision': 0.34619870914227946, 'recall': 0.159714150415429, 'f1-score': 0.21858638957672208, 'support': 418122}, 'accuracy': 0.33913617368094634, 'macro avg': {'precision': 0.34281931071676697, 'recall': 0.34073557981349717, 'f1-score': 0.3181055096866332, 'support': 1231868}, 'weighted avg': {'precision': 0.34284685524182706, 'recall': 0.33913617368094634, 'f1-score': 0.31721643792507925, 'support': 1231868}}
[[235315 105022  66761]
 [231618 115676  59354]
 [241730 109612  66780]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1280568
{'0': {'precision': 0.3367147157436186, 'recall': 0.36750093487899993, 'f1-score': 0.3514348842258522, 'support': 149752}, '1': {'precision': 0.36111930756368643, 'recall': 0.18982130739651662, 'f1-score': 0.24884039123822915, 'support': 154735}, '2': {'precision': 0.3310780529412615, 'recall': 0.4648187489005859, 'f1-score': 0.38671165910069544, 'support': 147806}, 'accuracy': 0.33851728857178864, 'macro avg': {'precision': 0.3429706920828555, 'recall': 0.34071366372536743, 'f1-score': 0.3289956448549256, 'support': 452293}, 'weighted avg': {'precision': 0.3432218072376568, 'recall': 0.33851728857178864, 'f1-score': 0.32786423448046864, 'support': 452293}}
[[55034 25357 69361]
 [55914 29372 69449]
 [52496 26607 68703]]
training model: results/universal/W0/deepLOB_L2/h500
Epoch 1/50
8838/8838 - 365s - loss: 3.2314 - accuracy500: 0.4103 - val_loss: 3.4966 - val_accuracy500: 0.3340 - 365s/epoch - 41ms/step
Epoch 2/50
8838/8838 - 362s - loss: 3.2066 - accuracy500: 0.4216 - val_loss: 3.7295 - val_accuracy500: 0.3334 - 362s/epoch - 41ms/step
Epoch 3/50
8838/8838 - 363s - loss: 3.1887 - accuracy500: 0.4303 - val_loss: 3.6195 - val_accuracy500: 0.3418 - 363s/epoch - 41ms/step
Epoch 4/50
8838/8838 - 362s - loss: 3.1796 - accuracy500: 0.4340 - val_loss: 3.7052 - val_accuracy500: 0.3401 - 362s/epoch - 41ms/step
Epoch 5/50
8838/8838 - 362s - loss: 3.1688 - accuracy500: 0.4382 - val_loss: 3.8549 - val_accuracy500: 0.3390 - 362s/epoch - 41ms/step
Epoch 6/50
8838/8838 - 362s - loss: 3.1641 - accuracy500: 0.4396 - val_loss: 3.7878 - val_accuracy500: 0.3405 - 362s/epoch - 41ms/step
Epoch 7/50
8838/8838 - 362s - loss: 3.1574 - accuracy500: 0.4422 - val_loss: 3.9356 - val_accuracy500: 0.3375 - 362s/epoch - 41ms/step
Epoch 8/50
8838/8838 - 362s - loss: 3.1521 - accuracy500: 0.4443 - val_loss: 3.8990 - val_accuracy500: 0.3361 - 362s/epoch - 41ms/step
Epoch 9/50
8838/8838 - 361s - loss: 3.1476 - accuracy500: 0.4458 - val_loss: 3.9735 - val_accuracy500: 0.3364 - 361s/epoch - 41ms/step
Epoch 10/50
8838/8838 - 362s - loss: 3.1437 - accuracy500: 0.4472 - val_loss: 4.0148 - val_accuracy500: 0.3388 - 362s/epoch - 41ms/step
Epoch 11/50
8838/8838 - 362s - loss: 3.1403 - accuracy500: 0.4484 - val_loss: 4.0507 - val_accuracy500: 0.3378 - 362s/epoch - 41ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 439s - 439s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1430913
{'0': {'precision': 0.24897751444059787, 'recall': 0.22834161277069268, 'f1-score': 0.23821348841878032, 'support': 2270887}, '1': {'precision': 0.4601496390104104, 'recall': 0.16039199652135538, 'f1-score': 0.2378706442033175, 'support': 3852075}, '2': {'precision': 0.28338297508530136, 'recall': 0.6120288022657989, 'f1-score': 0.3873939280474053, 'support': 2326067}, 'accuracy': 0.30299339722943314, 'macro avg': {'precision': 0.3308367095121032, 'recall': 0.3335874705192823, 'f1-score': 0.2878260202231677, 'support': 8449029}, 'weighted avg': {'precision': 0.35472697610982684, 'recall': 0.30299339722943314, 'f1-score': 0.2791274249237157, 'support': 8449029}}
[[ 518538  361589 1390760]
 [1024952  617842 2209281]
 [ 539180  363267 1423620]]
Evaluating performance on  train set...
8838/8838 - 122s - 122s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1605654
{'0': {'precision': 0.3304744264957575, 'recall': 0.41382301406935795, 'f1-score': 0.3674819119127482, 'support': 749359}, '1': {'precision': 0.31921754177490774, 'recall': 0.19806097723410754, 'f1-score': 0.2444506622673264, 'support': 743261}, '2': {'precision': 0.34218531898218785, 'recall': 0.3835898795506412, 'f1-score': 0.36170656026195946, 'support': 769452}, 'accuracy': 0.3326450263298427, 'macro avg': {'precision': 0.3306257624176177, 'recall': 0.33182462361803555, 'f1-score': 0.3245463781473447, 'support': 2262072}, 'weighted avg': {'precision': 0.3307591947307939, 'recall': 0.3326450263298427, 'f1-score': 0.3250923745677351, 'support': 2262072}}
[[310102 154189 285068]
 [313716 147211 282334]
 [314536 159762 295154]]
Evaluating performance on  val set...
3279/3279 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1648573
{'0': {'precision': 0.3266572803868523, 'recall': 0.3169587297045991, 'f1-score': 0.32173493206132087, 'support': 279620}, '1': {'precision': 0.3338446443624504, 'recall': 0.1725078548986004, 'f1-score': 0.22747324661139437, 'support': 280080}, '2': {'precision': 0.34017685469204156, 'recall': 0.5152215261285851, 'f1-score': 0.4097890343442401, 'support': 279177}, 'accuracy': 0.33471176346472725, 'macro avg': {'precision': 0.33355959314711475, 'recall': 0.33489603691059483, 'f1-score': 0.31966573767231843, 'support': 838877}, 'weighted avg': {'precision': 0.333556254966064, 'recall': 0.33471176346472725, 'f1-score': 0.31956759078509456, 'support': 838877}}
[[ 88628  48212 142780]
 [ 95549  48316 136215]
 [ 87141  48198 143838]]
testing model out of sample: results/universal/W0/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 305s - 305s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1603438
{'0': {'precision': 0.3582600390709789, 'recall': 0.30932891001040025, 'f1-score': 0.33200126376747535, 'support': 2000909}, '1': {'precision': 0.2904956004187143, 'recall': 0.22499972252744205, 'f1-score': 0.25358689625387903, 'support': 1801980}, '2': {'precision': 0.32470548638064806, 'recall': 0.43339996473034975, 'f1-score': 0.3712606106152886, 'support': 2030074}, 'accuracy': 0.32645809685403454, 'macro avg': {'precision': 0.3244870419567804, 'recall': 0.32257619908939733, 'f1-score': 0.3189495902122143, 'support': 5832963}, 'weighted avg': {'precision': 0.32564738780593944, 'recall': 0.32645809685403454, 'f1-score': 0.32144029455175727, 'support': 5832963}}
[[618939 495526 886444]
 [453176 405445 943359]
 [655510 494730 879834]]
Evaluating performance on  train set...
6334/6334 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1537205
{'0': {'precision': 0.3154289869989489, 'recall': 0.2955627878918774, 'f1-score': 0.30517291593975554, 'support': 537094}, '1': {'precision': 0.3519642607845875, 'recall': 0.23146869583100743, 'f1-score': 0.27927359090415643, 'support': 544592}, '2': {'precision': 0.346502818364598, 'recall': 0.48804927171772244, 'f1-score': 0.40527236145151635, 'support': 539214}, 'accuracy': 0.3380615707323092, 'macro avg': {'precision': 0.3379653553827115, 'recall': 0.3383602518135358, 'f1-score': 0.32990628943180944, 'support': 1620900}, 'weighted avg': {'precision': 0.3380412781504484, 'recall': 0.3380615707323092, 'f1-score': 0.32977064386398997, 'support': 1620900}}
[[158745 115717 262632]
 [184848 126056 233688]
 [159674 116377 263163]]
Evaluating performance on  val set...
2156/2156 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.149769
{'0': {'precision': 0.28112674684715394, 'recall': 0.2684740088003302, 'f1-score': 0.2746547341192561, 'support': 172039}, '1': {'precision': 0.39241862298262814, 'recall': 0.1915962323174011, 'f1-score': 0.25747951091425086, 'support': 202671}, '2': {'precision': 0.33661018949531557, 'recall': 0.549037481598913, 'f1-score': 0.41734792909849566, 'support': 176620}, 'accuracy': 0.3300926849618196, 'macro avg': {'precision': 0.3367185197750326, 'recall': 0.3363692409055481, 'f1-score': 0.3164940580440008, 'support': 551330}, 'weighted avg': {'precision': 0.3398123280213527, 'recall': 0.3300926849618196, 'f1-score': 0.3140531931819802, 'support': 551330}}
[[46188 29922 95929]
 [68659 38831 95181]
 [49449 30200 96971]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
876/876 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1339396
{'0': {'precision': 0.33446695408312754, 'recall': 0.465058417843996, 'f1-score': 0.3890975269792383, 'support': 68729}, '1': {'precision': 0.3720012201467765, 'recall': 0.2601744368450775, 'f1-score': 0.3061971997400603, 'support': 79685}, '2': {'precision': 0.3808399670601153, 'recall': 0.36635375820229465, 'f1-score': 0.37345643703608994, 'support': 75741}, 'accuracy': 0.35887220896254823, 'macro avg': {'precision': 0.36243604709667315, 'recall': 0.36386220429712274, 'f1-score': 0.35625038791846286, 'support': 224155}, 'weighted avg': {'precision': 0.36347927309083156, 'recall': 0.35887220896254823, 'f1-score': 0.35434218193033057, 'support': 224155}}
[[31963 17820 18946]
 [32787 20732 26166]
 [30814 17179 27748]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.161003
{'0': {'precision': 0.32194216792948815, 'recall': 0.22675621709929206, 'f1-score': 0.2660929578664849, 'support': 27545}, '1': {'precision': 0.3148720211827008, 'recall': 0.21581972171808833, 'f1-score': 0.2561019382627423, 'support': 26448}, '2': {'precision': 0.3303736927618481, 'recall': 0.530089957774922, 'f1-score': 0.40705444497702087, 'support': 27235}, 'accuracy': 0.3249002806913872, 'macro avg': {'precision': 0.32239596062467907, 'recall': 0.32422196553076743, 'f1-score': 0.3097497803687494, 'support': 81228}, 'weighted avg': {'precision': 0.3224671265355143, 'recall': 0.3249002806913872, 'f1-score': 0.31010294967935315, 'support': 81228}}
[[ 6246  5964 15335]
 [ 6813  5708 13927]
 [ 6342  6456 14437]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1362847
{'0': {'precision': 0.3741602874550851, 'recall': 0.5332887998218659, 'f1-score': 0.43977230995225847, 'support': 8982}, '1': {'precision': 0.3837837837837838, 'recall': 0.29884251139950896, 'f1-score': 0.3360283967659239, 'support': 8553}, '2': {'precision': 0.4019342909970132, 'recall': 0.3154722036168788, 'f1-score': 0.35349302645568825, 'support': 8958}, 'accuracy': 0.3839504774846186, 'macro avg': {'precision': 0.38662612074529407, 'recall': 0.3825345049460845, 'f1-score': 0.3764312443912902, 'support': 26493}, 'weighted avg': {'precision': 0.3866582789180357, 'recall': 0.3839504774846186, 'f1-score': 0.37710626567471367, 'support': 26493}}
[[4790 2088 2104]
 [3896 2556 2101]
 [4116 2016 2826]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1607916
{'0': {'precision': 0.3402732532698011, 'recall': 0.5133150127624617, 'f1-score': 0.40925438245963536, 'support': 204506}, '1': {'precision': 0.29933988953253404, 'recall': 0.18852990551686938, 'f1-score': 0.23135074834991168, 'support': 165003}, '2': {'precision': 0.40720941048594017, 'recall': 0.3326119711967355, 'f1-score': 0.36614979795132035, 'support': 234279}, 'accuracy': 0.3544422876903814, 'macro avg': {'precision': 0.3489408510960918, 'recall': 0.3448189631586889, 'f1-score': 0.3355849762536225, 'support': 603788}, 'weighted avg': {'precision': 0.35505925126860133, 'recall': 0.3544422876903814, 'f1-score': 0.34391169215603495, 'support': 603788}}
[[104976  35853  63677]
 [ 84135  31108  49760]
 [119394  36961  77924]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1590487
{'0': {'precision': 0.3487900738469131, 'recall': 0.37430727620056364, 'f1-score': 0.36109843992336466, 'support': 52871}, '1': {'precision': 0.31537183356505816, 'recall': 0.1971508522004579, 'f1-score': 0.24262662892474657, 'support': 47172}, '2': {'precision': 0.34173426182979977, 'recall': 0.4349216375192452, 'f1-score': 0.38273738698442755, 'support': 50662}, 'accuracy': 0.33923227497428754, 'macro avg': {'precision': 0.33529872308059033, 'recall': 0.3354599219734222, 'f1-score': 0.3288208186108463, 'support': 150705}, 'weighted avg': {'precision': 0.3359579396842333, 'recall': 0.33923227497428754, 'f1-score': 0.3312900066768284, 'support': 150705}}
[[19790 10373 22708]
 [18137  9300 19735]
 [18812  9816 22034]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1634072
{'0': {'precision': 0.3398201844860468, 'recall': 0.4333002481389578, 'f1-score': 0.38090875379010974, 'support': 20150}, '1': {'precision': 0.2851875601154216, 'recall': 0.10744051213914724, 'f1-score': 0.15608001403755045, 'support': 16558}, '2': {'precision': 0.39425043698166534, 'recall': 0.47942293777134587, 'f1-score': 0.4326850472439338, 'support': 22112}, 'accuracy': 0.3589085345120707, 'macro avg': {'precision': 0.3397527271943779, 'recall': 0.3400545660164836, 'f1-score': 0.3232246050238647, 'support': 58820}, 'weighted avg': {'precision': 0.34490272016871093, 'recall': 0.3589085345120707, 'f1-score': 0.3370828974152046, 'support': 58820}}
[[ 8731  2015  9404]
 [ 7895  1779  6884]
 [ 9067  2444 10601]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1570394
{'0': {'precision': 0.30461826148622684, 'recall': 0.6062271351078592, 'f1-score': 0.4054867195966702, 'support': 126832}, '1': {'precision': 0.3757689060426969, 'recall': 0.20166875962870423, 'f1-score': 0.2624728302077542, 'support': 154486}, '2': {'precision': 0.3537439463553955, 'recall': 0.21174730363553923, 'f1-score': 0.26491772178384937, 'support': 134533}, 'accuracy': 0.32831711358154725, 'macro avg': {'precision': 0.34471037129477305, 'recall': 0.3398810661240342, 'f1-score': 0.3109590905294246, 'support': 415851}, 'weighted avg': {'precision': 0.34694304665556563, 'recall': 0.32831711358154725, 'f1-score': 0.30688214079587783, 'support': 415851}}
[[76889 25558 24385]
 [95673 31155 27658]
 [79849 26197 28487]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1642612
{'0': {'precision': 0.33163875598086123, 'recall': 0.508112332902113, 'f1-score': 0.40133259536784743, 'support': 37104}, '1': {'precision': 0.33167257159728375, 'recall': 0.2381229962110172, 'f1-score': 0.27721825500871417, 'support': 37741}, '2': {'precision': 0.35050466577794703, 'recall': 0.27196158108607316, 'f1-score': 0.3062778216915588, 'support': 40605}, 'accuracy': 0.3367951494153313, 'macro avg': {'precision': 0.33793866445203075, 'recall': 0.3393989700664011, 'f1-score': 0.3282762240227068, 'support': 115450}, 'weighted avg': {'precision': 0.33828515271096143, 'recall': 0.3367951494153313, 'f1-score': 0.32732741213164346, 'support': 115450}}
[[18853  8692  9559]
 [17850  8987 10904]
 [20145  9417 11043]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1801704
{'0': {'precision': 0.3290228439166751, 'recall': 0.4317311501386505, 'f1-score': 0.37344374643061107, 'support': 15146}, '1': {'precision': 0.3145233525271913, 'recall': 0.16327886276072803, 'f1-score': 0.2149634876907604, 'support': 15054}, '2': {'precision': 0.30555236893426635, 'recall': 0.3569657575554513, 'f1-score': 0.3292641468615755, 'support': 14923}, 'accuracy': 0.3174434323958957, 'macro avg': {'precision': 0.3163661884593776, 'recall': 0.31732525681827656, 'f1-score': 0.30589046032764905, 'support': 45123}, 'weighted avg': {'precision': 0.3164233881726028, 'recall': 0.3174434323958957, 'f1-score': 0.305960334879109, 'support': 45123}}
[[6539 2726 5881]
 [6370 2458 6226]
 [6965 2631 5327]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1666168
{'0': {'precision': 0.33912904486200407, 'recall': 0.1899508584843722, 'f1-score': 0.24350897775964092, 'support': 100526}, '1': {'precision': 0.30201807983654905, 'recall': 0.13310849841992592, 'f1-score': 0.18477921189643687, 'support': 117716}, '2': {'precision': 0.3077612119477137, 'recall': 0.6257298961716828, 'f1-score': 0.4125918062265745, 'support': 106522}, 'accuracy': 0.31228214949932875, 'macro avg': {'precision': 0.31630277888208896, 'recall': 0.3162630843586603, 'f1-score': 0.2802933319608841, 'support': 324764}, 'weighted avg': {'precision': 0.315388979286286, 'recall': 0.31228214949932875, 'f1-score': 0.2776802773359541, 'support': 324764}}
[[19095 16980 64451]
 [16575 15669 85472]
 [20636 19232 66654]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1444231
{'0': {'precision': 0.3845988186069407, 'recall': 0.3008229858504187, 'f1-score': 0.33759114231704024, 'support': 41556}, '1': {'precision': 0.3153632297836335, 'recall': 0.2542946952898462, 'f1-score': 0.28155562450256977, 'support': 41039}, '2': {'precision': 0.3433914659302068, 'recall': 0.48350936149783963, 'f1-score': 0.4015789631076865, 'support': 41660}, 'accuracy': 0.3467063699649913, 'macro avg': {'precision': 0.3477845047735937, 'recall': 0.3462090142127015, 'f1-score': 0.3402419099757655, 'support': 124255}, 'weighted avg': {'precision': 0.3479157262385657, 'recall': 0.3467063699649913, 'f1-score': 0.3405374301811122, 'support': 124255}}
[[12501 10720 18335]
 [10422 10436 20181]
 [ 9581 11936 20143]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1717255
{'0': {'precision': 0.34008834897846496, 'recall': 0.4259041560058087, 'f1-score': 0.378189186699825, 'support': 14461}, '1': {'precision': 0.34106190586598656, 'recall': 0.3890505157365776, 'f1-score': 0.3634791203360514, 'support': 15124}, '2': {'precision': 0.30655640874187834, 'recall': 0.19541888923752745, 'f1-score': 0.23868470471007552, 'support': 15935}, 'accuracy': 0.33297451669595785, 'macro avg': {'precision': 0.3292355545287766, 'recall': 0.3367911869933046, 'f1-score': 0.32678433724865064, 'support': 45520}, 'weighted avg': {'precision': 0.3286734238180271, 'recall': 0.33297451669595785, 'f1-score': 0.324466010860801, 'support': 45520}}
[[6159 5065 3237]
 [5433 5884 3807]
 [6518 6303 3114]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1590952
{'0': {'precision': 0.3240312768023708, 'recall': 0.6745753291416264, 'f1-score': 0.43777700628068766, 'support': 143935}, '1': {'precision': 0.34454812104612303, 'recall': 0.23143247454881205, 'f1-score': 0.2768830230208855, 'support': 145671}, '2': {'precision': 0.3355860750141249, 'recall': 0.10034046755811989, 'f1-score': 0.15448870570816908, 'support': 153906}, 'accuracy': 0.3297565793033785, 'macro avg': {'precision': 0.3347218242875396, 'recall': 0.3354494237495194, 'f1-score': 0.28971624500324744, 'support': 443512}, 'weighted avg': {'precision': 0.33477971650954863, 'recall': 0.3297565793033785, 'f1-score': 0.2866258387286199, 'support': 443512}}
[[ 97095  33253  13587]
 [ 94970  33713  16988]
 [107582  30881  15443]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1652346
{'0': {'precision': 0.31759179756553363, 'recall': 0.5105802491189892, 'f1-score': 0.3916000298931321, 'support': 61577}, '1': {'precision': 0.3343454454952713, 'recall': 0.20235584744230886, 'f1-score': 0.2521207116582839, 'support': 66388}, '2': {'precision': 0.3470639170156744, 'recall': 0.28967978878744527, 'f1-score': 0.31578608869022734, 'support': 67799}, 'accuracy': 0.3295498661653828, 'macro avg': {'precision': 0.33300038669215976, 'recall': 0.33420529511624775, 'f1-score': 0.3198356100805478, 'support': 195764}, 'weighted avg': {'precision': 0.33348042573700293, 'recall': 0.3295498661653828, 'f1-score': 0.31804277534893166, 'support': 195764}}
[[31440 12875 17262]
 [33267 13434 19687]
 [34288 13871 19640]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1570327
{'0': {'precision': 0.321976897207194, 'recall': 0.5318840579710145, 'f1-score': 0.40112942890973674, 'support': 20700}, '1': {'precision': 0.3474702380952381, 'recall': 0.18665067945643485, 'f1-score': 0.24284971398855953, 'support': 22518}, '2': {'precision': 0.3592554403863895, 'recall': 0.30790697674418605, 'f1-score': 0.3316051794525008, 'support': 21500}, 'accuracy': 0.3373559133471368, 'macro avg': {'precision': 0.3429008585629405, 'recall': 0.34214723805721176, 'f1-score': 0.3251947741169324, 'support': 64718}, 'weighted avg': {'precision': 0.34323138171644463, 'recall': 0.3373559133471368, 'f1-score': 0.3229608516371752, 'support': 64718}}
[[11010  3840  5850]
 [12358  4203  5957]
 [10827  4053  6620]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
4693/4693 - 68s - 68s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944617
{'0': {'precision': 0.1934297562942766, 'recall': 0.5745239042311182, 'f1-score': 0.2894185534700935, 'support': 223747}, '1': {'precision': 0.6260387615805789, 'recall': 0.2384848954090392, 'f1-score': 0.3453943391148675, 'support': 742655}, '2': {'precision': 0.23088474681823018, 'recall': 0.24949103454150517, 'f1-score': 0.23982755408893738, 'support': 234790}, 'accuracy': 0.3032304577453063, 'macro avg': {'precision': 0.35011775489769525, 'recall': 0.3541666113938875, 'f1-score': 0.29154681555796613, 'support': 1201192}, 'weighted avg': {'precision': 0.4682178817946278, 'recall': 0.3032304577453063, 'f1-score': 0.31433316024679364, 'support': 1201192}}
[[128548  52468  42731]
 [413141 177112 152402]
 [122883  53329  58578]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1652727
{'0': {'precision': 0.3307911676036829, 'recall': 0.48317914213624896, 'f1-score': 0.3927204485875233, 'support': 126034}, '1': {'precision': 0.3360281749369218, 'recall': 0.253150220574841, 'f1-score': 0.28876010136371233, 'support': 126261}, '2': {'precision': 0.36800277098928164, 'recall': 0.2922952297980956, 'f1-score': 0.3258088147605499, 'support': 130854}, 'accuracy': 0.34218541611748954, 'macro avg': {'precision': 0.3449407045099621, 'recall': 0.3428748641697285, 'f1-score': 0.3357631215705952, 'support': 383149}, 'weighted avg': {'precision': 0.3452255441316686, 'recall': 0.34218541611748954, 'f1-score': 0.33561004941221456, 'support': 383149}}
[[60897 30859 34278]
 [62890 31963 31408]
 [60308 32298 38248]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1567888
{'0': {'precision': 0.2885472461871857, 'recall': 0.3153755055527004, 'f1-score': 0.3013654755677026, 'support': 44753}, '1': {'precision': 0.3748251748251748, 'recall': 0.21589122917321596, 'f1-score': 0.27397738464799093, 'support': 50896}, '2': {'precision': 0.33652035582105055, 'recall': 0.46919699438710843, 'f1-score': 0.3919348130222709, 'support': 44184}, 'accuracy': 0.327769553681892, 'macro avg': {'precision': 0.3332975922778037, 'recall': 0.33348790970434156, 'f1-score': 0.32242589107932146, 'support': 139833}, 'weighted avg': {'precision': 0.33510882558562366, 'recall': 0.327769553681892, 'f1-score': 0.32001465945593355, 'support': 139833}}
[[14114  9447 21192]
 [20227 10988 19681]
 [14573  8880 20731]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
6677/6677 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.133524
{'0': {'precision': 0.2621372613924749, 'recall': 0.04015838538189133, 'f1-score': 0.06964711055736744, 'support': 473276}, '1': {'precision': 0.49882416153372944, 'recall': 0.15992375607436154, 'f1-score': 0.24219836268409403, 'support': 801113}, '2': {'precision': 0.26119248317323024, 'recall': 0.8287732497579887, 'f1-score': 0.39720394238393336, 'support': 434897}, 'accuracy': 0.2969391898137585, 'macro avg': {'precision': 0.34071796869981147, 'recall': 0.3429517970714138, 'f1-score': 0.23634980520846494, 'support': 1709286}, 'weighted avg': {'precision': 0.372827965826751, 'recall': 0.2969391898137585, 'f1-score': 0.23385984893811612, 'support': 1709286}}
[[ 19006  68172 386098]
 [ 39581 128117 633415]
 [ 13917  60549 360431]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1574978
{'0': {'precision': 0.31123772347224415, 'recall': 0.43981025454922495, 'f1-score': 0.36451876948328865, 'support': 192890}, '1': {'precision': 0.3397753655016628, 'recall': 0.2202036324449618, 'f1-score': 0.26722348507046073, 'support': 196727}, '2': {'precision': 0.36383164395515877, 'recall': 0.3437341451040081, 'f1-score': 0.3534974726887331, 'support': 189216}, 'accuracy': 0.33376638857839824, 'macro avg': {'precision': 0.3382815776430219, 'recall': 0.33458267736606495, 'f1-score': 0.32841324241416087, 'support': 578833}, 'weighted avg': {'precision': 0.3381293069887621, 'recall': 0.33376638857839824, 'f1-score': 0.3278484084103004, 'support': 578833}}
[[ 84835  42590  65465]
 [105148  43320  48259]
 [ 82590  41586  65040]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1397158
{'0': {'precision': 0.2438237632238733, 'recall': 0.2724136164107469, 'f1-score': 0.2573270194177107, 'support': 58547}, '1': {'precision': 0.45115617378737244, 'recall': 0.21902715502592718, 'f1-score': 0.294890812613929, 'support': 91217}, '2': {'precision': 0.3087328699886127, 'recall': 0.5088996763754046, 'f1-score': 0.384314588068529, 'support': 61800}, 'accuracy': 0.31847573311149346, 'macro avg': {'precision': 0.3345709356666195, 'recall': 0.33344681593735953, 'f1-score': 0.3121774733667229, 'support': 211564}, 'weighted avg': {'precision': 0.3521769012456142, 'recall': 0.31847573311149346, 'f1-score': 0.3106172212790861, 'support': 211564}}
[[15949 11984 30614]
 [31434 19979 39804]
 [18029 12321 31450]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
5633/5633 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1511446
{'0': {'precision': 0.2443488493141252, 'recall': 0.6307185613090415, 'f1-score': 0.35223653132545246, 'support': 382570}, '1': {'precision': 0.4085137804714321, 'recall': 0.1331845133414309, 'f1-score': 0.20087827363233934, 'support': 639699}, '2': {'precision': 0.388571079827488, 'recall': 0.22762384850976608, 'f1-score': 0.287078132397478, 'support': 419565}, 'accuracy': 0.2926793236946833, 'macro avg': {'precision': 0.3471445698710151, 'recall': 0.33050897438674615, 'f1-score': 0.2800643124517566, 'support': 1441834}, 'weighted avg': {'precision': 0.35915176174491625, 'recall': 0.2926793236946833, 'f1-score': 0.2661226584841667, 'support': 1441834}}
[[241294  58333  82943]
 [487167  85198  67334]
 [259037  65025  95503]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1536466
{'0': {'precision': 0.3426394382608162, 'recall': 0.181814483981712, 'f1-score': 0.2375682972978719, 'support': 122922}, '1': {'precision': 0.3486800222140951, 'recall': 0.20975180483353162, 'f1-score': 0.26193444007468725, 'support': 122726}, '2': {'precision': 0.3449936063027266, 'recall': 0.6358237047933126, 'f1-score': 0.4472904595133649, 'support': 126447}, 'accuracy': 0.3453123530281245, 'macro avg': {'precision': 0.3454376889258793, 'recall': 0.34246333120285205, 'f1-score': 0.315597732295308, 'support': 372095}, 'weighted avg': {'precision': 0.3454317740692671, 'recall': 0.3453123530281245, 'f1-score': 0.3168735754770731, 'support': 372095}}
[[22349 23681 76892]
 [21232 25742 75752]
 [21645 24404 80398]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145826
{'0': {'precision': 0.38058551617873654, 'recall': 0.049557593146204934, 'f1-score': 0.08769594006852355, 'support': 49841}, '1': {'precision': 0.31575262543757293, 'recall': 0.18971279007267883, 'f1-score': 0.23701843768704103, 'support': 42791}, '2': {'precision': 0.35692444492836467, 'recall': 0.7902328291046425, 'f1-score': 0.491743233952122, 'support': 49779}, 'accuracy': 0.3505698295777714, 'macro avg': {'precision': 0.3510875288482247, 'recall': 0.34316773744117546, 'f1-score': 0.2721525372358955, 'support': 142411}, 'weighted avg': {'precision': 0.35283422805157366, 'recall': 0.3505698295777714, 'f1-score': 0.2737962359573638, 'support': 142411}}
[[ 2470  8885 38486]
 [ 2285  8118 32388]
 [ 1735  8707 39337]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
11876/11876 - 159s - 159s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.17817
{'0': {'precision': 0.3904154083418875, 'recall': 0.3313170114220835, 'f1-score': 0.3584466008808872, 'support': 1188137}, '1': {'precision': 0.21238755545305465, 'recall': 0.30844168914294917, 'f1-score': 0.2515572120290443, 'support': 621025}, '2': {'precision': 0.39639641234175677, 'recall': 0.3638692864401782, 'f1-score': 0.3794370308625818, 'support': 1230997}, 'accuracy': 0.33982498941667194, 'macro avg': {'precision': 0.33306645871223295, 'recall': 0.3345426623350703, 'f1-score': 0.32981361459083774, 'support': 3040159}, 'weighted avg': {'precision': 0.35647075302633974, 'recall': 0.33982498941667194, 'f1-score': 0.3451111712617325, 'support': 3040159}}
[[393650 351584 442903]
 [190315 191550 239160]
 [424320 358755 447922]]
Evaluating performance on  train set...
2538/2538 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.144173
{'0': {'precision': 0.311752010986855, 'recall': 0.08018699134775069, 'f1-score': 0.12756299147950154, 'support': 217978}, '1': {'precision': 0.372756115600224, 'recall': 0.248182136151099, 'f1-score': 0.29797297483969176, 'support': 217288}, '2': {'precision': 0.3407561368451303, 'recall': 0.7135739577064644, 'f1-score': 0.46124967206737766, 'support': 214359}, 'accuracy': 0.345379257263806, 'macro avg': {'precision': 0.3417547544774031, 'recall': 0.34731436173510466, 'f1-score': 0.29559521279552364, 'support': 649625}, 'weighted avg': {'precision': 0.34172738954846166, 'recall': 0.345379257263806, 'f1-score': 0.29466984178314676, 'support': 649625}}
[[ 17479  45576 154923]
 [ 22358  53927 141003]
 [ 16230  45168 152961]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1536536
{'0': {'precision': 0.2482013258349304, 'recall': 0.11505301176744728, 'f1-score': 0.15722488133501836, 'support': 68664}, '1': {'precision': 0.34442353442459966, 'recall': 0.1484792358676851, 'f1-score': 0.20750438540195953, 'support': 65329}, '2': {'precision': 0.35260039040713886, 'recall': 0.7283659038868647, 'f1-score': 0.475171341466279, 'support': 69439}, 'accuracy': 0.3351340988635023, 'macro avg': {'precision': 0.3150750835555563, 'recall': 0.33063271717399906, 'f1-score': 0.27996686940108567, 'support': 203432}, 'weighted avg': {'precision': 0.31473691172989327, 'recall': 0.3351340988635023, 'f1-score': 0.2818984526819245, 'support': 203432}}
[[ 7900  9173 51591]
 [14357  9700 41272]
 [ 9572  9290 50577]]
testing model on single stock: results/universal/W0/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
19053/19053 - 255s - 255s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.148896
{'0': {'precision': 0.3827877265276735, 'recall': 0.018379773128812876, 'f1-score': 0.035075381610410315, 'support': 1359538}, '1': {'precision': 0.4448379948200909, 'recall': 0.14144065711874063, 'f1-score': 0.2146357473213985, 'support': 2187002}, '2': {'precision': 0.27334553862679034, 'recall': 0.8455163418139906, 'f1-score': 0.4131307427863188, 'support': 1330911}, 'accuracy': 0.29926000281704523, 'macro avg': {'precision': 0.3669904199915182, 'recall': 0.33511225735384803, 'f1-score': 0.2209472905727092, 'support': 4877451}, 'weighted avg': {'precision': 0.380746957510148, 'recall': 0.29926000281704523, 'f1-score': 0.2187485579741815, 'support': 4877451}}
[[  24988  197486 1137064]
 [  23249  309331 1854422]
 [  17042  188562 1125307]]
Evaluating performance on  train set...
4812/4812 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1630433
{'0': {'precision': 0.3245446565356848, 'recall': 0.47902585374504897, 'f1-score': 0.38693625310139135, 'support': 405976}, '1': {'precision': 0.30490960559906916, 'recall': 0.17294853261685994, 'f1-score': 0.2207084682748076, 'support': 406063}, '2': {'precision': 0.3344998831793123, 'recall': 0.3205543209259008, 'f1-score': 0.3273786573091449, 'support': 419829}, 'accuracy': 0.3241248250624255, 'macro avg': {'precision': 0.3213180484380221, 'recall': 0.32417623576260324, 'f1-score': 0.3116744595617813, 'support': 1231868}, 'weighted avg': {'precision': 0.32146512622731777, 'recall': 0.3241248250624255, 'f1-score': 0.3118446370565715, 'support': 1231868}}
[[194473  78618 132885]
 [200972  70228 134863]
 [203773  81478 134578]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1734722
{'0': {'precision': 0.3320799674551055, 'recall': 0.3798889738390453, 'f1-score': 0.3543792734545793, 'support': 150415}, '1': {'precision': 0.3225961322071025, 'recall': 0.13898171429310133, 'f1-score': 0.1942682640357059, 'support': 154711}, '2': {'precision': 0.3267453294001967, 'recall': 0.47417559643126517, 'f1-score': 0.38689128090547964, 'support': 147167}, 'accuracy': 0.32816338081730206, 'macro avg': {'precision': 0.32714047635413485, 'recall': 0.33101542818780394, 'f1-score': 0.3118462727985883, 'support': 452293}, 'weighted avg': {'precision': 0.32710015058046765, 'recall': 0.32816338081730206, 'f1-score': 0.31019057325874017, 'support': 452293}}
[[57141 23027 70247]
 [59669 21502 73540]
 [55260 22124 69783]]
training model: results/universal/W0/deepLOB_L2/h1000
Epoch 1/50
8838/8838 - 365s - loss: 3.1798 - accuracy1000: 0.4366 - val_loss: 3.5313 - val_accuracy1000: 0.3285 - 365s/epoch - 41ms/step
Epoch 2/50
8838/8838 - 361s - loss: 3.1368 - accuracy1000: 0.4538 - val_loss: 3.6771 - val_accuracy1000: 0.3327 - 361s/epoch - 41ms/step
Epoch 3/50
8838/8838 - 361s - loss: 3.1111 - accuracy1000: 0.4628 - val_loss: 3.8227 - val_accuracy1000: 0.3339 - 361s/epoch - 41ms/step
Epoch 4/50
8838/8838 - 360s - loss: 3.0949 - accuracy1000: 0.4675 - val_loss: 3.9062 - val_accuracy1000: 0.3338 - 360s/epoch - 41ms/step
Epoch 5/50
8838/8838 - 362s - loss: 3.0828 - accuracy1000: 0.4716 - val_loss: 3.9626 - val_accuracy1000: 0.3327 - 362s/epoch - 41ms/step
Epoch 6/50
8838/8838 - 361s - loss: 3.0750 - accuracy1000: 0.4737 - val_loss: 3.9846 - val_accuracy1000: 0.3359 - 361s/epoch - 41ms/step
Epoch 7/50
8838/8838 - 361s - loss: 3.0695 - accuracy1000: 0.4756 - val_loss: 4.0449 - val_accuracy1000: 0.3346 - 361s/epoch - 41ms/step
Epoch 8/50
8838/8838 - 361s - loss: 3.0638 - accuracy1000: 0.4772 - val_loss: 4.1592 - val_accuracy1000: 0.3360 - 361s/epoch - 41ms/step
Epoch 9/50
8838/8838 - 362s - loss: 3.0582 - accuracy1000: 0.4786 - val_loss: 4.1859 - val_accuracy1000: 0.3354 - 362s/epoch - 41ms/step
Epoch 10/50
8838/8838 - 362s - loss: 3.0535 - accuracy1000: 0.4797 - val_loss: 4.2027 - val_accuracy1000: 0.3347 - 362s/epoch - 41ms/step
Epoch 11/50
8838/8838 - 362s - loss: 3.0475 - accuracy1000: 0.4813 - val_loss: 4.2048 - val_accuracy1000: 0.3345 - 362s/epoch - 41ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 440s - 440s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.160032
{'0': {'precision': 0.2813459219798537, 'recall': 0.31115104330606697, 'f1-score': 0.29549882035832603, 'support': 2258829}, '1': {'precision': 0.47283228981654574, 'recall': 0.18745075985188153, 'f1-score': 0.26846902113608717, 'support': 3894180}, '2': {'precision': 0.26630788091998187, 'recall': 0.5111636658217263, 'f1-score': 0.35017850677305323, 'support': 2296020}, 'accuracy': 0.30849059696682307, 'macro avg': {'precision': 0.34016203090546043, 'recall': 0.33658848965989163, 'f1-score': 0.3047154494224888, 'support': 8449029}, 'weighted avg': {'precision': 0.36551591842181197, 'recall': 0.30849059696682307, 'f1-score': 0.2978998950932671, 'support': 8449029}}
[[ 702837  403920 1152072]
 [1082840  729967 2081373]
 [ 712447  409931 1173642]]
Evaluating performance on  train set...
8838/8838 - 122s - 122s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1882546
{'0': {'precision': 0.33054040530613266, 'recall': 0.5139265490197654, 'f1-score': 0.40232122510034296, 'support': 746811}, '1': {'precision': 0.33582665765852715, 'recall': 0.1302937781932514, 'f1-score': 0.18774600158597254, 'support': 747741}, '2': {'precision': 0.3444242042285744, 'recall': 0.3638537106524911, 'f1-score': 0.3538724619647135, 'support': 767520}, 'accuracy': 0.3361948691288341, 'macro avg': {'precision': 0.33693042239774473, 'recall': 0.33602467928850266, 'f1-score': 0.3146465628836763, 'support': 2262072}, 'weighted avg': {'precision': 0.3369985732906991, 'recall': 0.3361948691288341, 'f1-score': 0.31495349901217373, 'support': 2262072}}
[[383806  95303 267702]
 [386465  97426 263850]
 [390876  97379 279265]]
Evaluating performance on  val set...
3279/3279 - 45s - 45s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1773452
{'0': {'precision': 0.3272961617115493, 'recall': 0.3664399708533954, 'f1-score': 0.3457637286804592, 'support': 279964}, '1': {'precision': 0.31914633867189585, 'recall': 0.14767543673826775, 'f1-score': 0.20191892250690935, 'support': 283236}, '2': {'precision': 0.33191335062669414, 'recall': 0.47482016998153637, 'f1-score': 0.3907093223172071, 'support': 275677}, 'accuracy': 0.32819352539168434, 'macro avg': {'precision': 0.32611861700337974, 'recall': 0.3296451925243999, 'f1-score': 0.3127973245015252, 'support': 838877}, 'weighted avg': {'precision': 0.32606180853474404, 'recall': 0.32819352539168434, 'f1-score': 0.3119666867966385, 'support': 838877}}
[[102590  44665 132709]
 [110644  41827 130765]
 [100213  44567 130897]]
testing model out of sample: results/universal/W0/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 311s - 311s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1756048
{'0': {'precision': 0.34905976335343636, 'recall': 0.44691297779669725, 'f1-score': 0.39197155933728306, 'support': 1926290}, '1': {'precision': 0.3531015730687099, 'recall': 0.18749786209040842, 'f1-score': 0.24493473631416735, 'support': 1958689}, '2': {'precision': 0.31194575775810196, 'recall': 0.3725764688005651, 'f1-score': 0.3395759680942052, 'support': 1947984}, 'accuracy': 0.33497675195265253, 'macro avg': {'precision': 0.3380356980600827, 'recall': 0.3356624362292236, 'f1-score': 0.32549408791521856, 'support': 5832963}, 'weighted avg': {'precision': 0.33802234706154105, 'recall': 0.33497675195265253, 'f1-score': 0.32509899709706663, 'support': 5832963}}
[[860884 338643 726763]
 [717375 367250 874064]
 [888035 334176 725773]]
Evaluating performance on  train set...
6334/6334 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1742891
{'0': {'precision': 0.32290277380402166, 'recall': 0.41118638620983444, 'f1-score': 0.36173596312224837, 'support': 535222}, '1': {'precision': 0.3285289140456323, 'recall': 0.16426775205927352, 'f1-score': 0.21902220493213304, 'support': 548373}, '2': {'precision': 0.3395850278056327, 'recall': 0.4203869310726682, 'f1-score': 0.3756904607063199, 'support': 537305}, 'accuracy': 0.330700228268246, 'macro avg': {'precision': 0.3303389052184289, 'recall': 0.3319470231139254, 'f1-score': 0.31881620958690043, 'support': 1620900}, 'weighted avg': {'precision': 0.3303361021333747, 'recall': 0.330700228268246, 'f1-score': 0.3180796299767252, 'support': 1620900}}
[[220076  92324 222822]
 [241838  90080 216455]
 [219641  91788 225876]]
Evaluating performance on  val set...
2156/2156 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1802901
{'0': {'precision': 0.30526432868444975, 'recall': 0.35361372217305087, 'f1-score': 0.32766505234854737, 'support': 178514}, '1': {'precision': 0.31947922382401356, 'recall': 0.1696735600027552, 'f1-score': 0.2216369978682761, 'support': 188733}, '2': {'precision': 0.3359748185684405, 'recall': 0.44589125557493087, 'f1-score': 0.38320689091715493, 'support': 184083}, 'accuracy': 0.321457203489743, 'macro avg': {'precision': 0.3202394570256346, 'recall': 0.32305951258357896, 'f1-score': 0.31083631371132614, 'support': 551330}, 'weighted avg': {'precision': 0.3203843093016662, 'recall': 0.321457203489743, 'f1-score': 0.3099140057213004, 'support': 551330}}
[[63125 33970 81419]
 [75903 32023 80807]
 [67760 34242 82081]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1742872
{'0': {'precision': 0.3444026664915277, 'recall': 0.6070792874404873, 'f1-score': 0.4394822718439482, 'support': 69103}, '1': {'precision': 0.34498052142643093, 'recall': 0.07401311559727401, 'f1-score': 0.12187814303107299, 'support': 77770}, '2': {'precision': 0.3607900819499895, 'recall': 0.39991201055873293, 'f1-score': 0.37934505106048705, 'support': 77282}, 'accuracy': 0.35070821529745044, 'macro avg': {'precision': 0.3500577566226493, 'recall': 0.36033480453216477, 'f1-score': 0.31356848864516945, 'support': 224155}, 'weighted avg': {'precision': 0.3502530468968199, 'recall': 0.35070821529745044, 'f1-score': 0.3085568060084114, 'support': 224155}}
[[41951  4903 22249]
 [39507  5756 32507]
 [40350  6026 30906]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1694956
{'0': {'precision': 0.31808488684047603, 'recall': 0.34031278748850047, 'f1-score': 0.32882362353108496, 'support': 27175}, '1': {'precision': 0.3237949141542274, 'recall': 0.20048220939577702, 'f1-score': 0.24763666719310518, 'support': 27374}, '2': {'precision': 0.322056526061639, 'recall': 0.42497844746804603, 'f1-score': 0.36642750953396674, 'support': 26679}, 'accuracy': 0.3209976855271581, 'macro avg': {'precision': 0.32131210901878077, 'recall': 0.3219244814507745, 'f1-score': 0.3142959334193856, 'support': 81228}, 'weighted avg': {'precision': 0.3213136460179522, 'recall': 0.3209976855271581, 'f1-score': 0.3138142958592849, 'support': 81228}}
[[ 9248  5865 12062]
 [10081  5488 11805]
 [ 9745  5596 11338]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1802976
{'0': {'precision': 0.3605848309473043, 'recall': 0.6578128472993998, 'f1-score': 0.4658245779719042, 'support': 8998}, '1': {'precision': 0.3397312859884837, 'recall': 0.06564470268265546, 'f1-score': 0.11002900953170328, 'support': 8089}, '2': {'precision': 0.39835584263065177, 'recall': 0.3606208802891771, 'f1-score': 0.3785503041124937, 'support': 9406}, 'accuracy': 0.37149435699996225, 'macro avg': {'precision': 0.3662239865221466, 'recall': 0.3613594767570774, 'f1-score': 0.3181346305387004, 'support': 26493}, 'weighted avg': {'precision': 0.3676278162914204, 'recall': 0.37149435699996225, 'f1-score': 0.3262053512692129, 'support': 26493}}
[[5919  417 2662]
 [5097  531 2461]
 [5399  615 3392]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1962909
{'0': {'precision': 0.28818219927826194, 'recall': 0.5382446342531756, 'f1-score': 0.3753811375799267, 'support': 182640}, '1': {'precision': 0.23151589888135293, 'recall': 0.058018745060989876, 'f1-score': 0.09278517922323654, 'support': 226513}, '2': {'precision': 0.34980718982817066, 'recall': 0.3700567729339533, 'f1-score': 0.35964717366934884, 'support': 194635}, 'accuracy': 0.30386990135610514, 'macro avg': {'precision': 0.28983509599592855, 'recall': 0.32210671741603963, 'f1-score': 0.275937830157504, 'support': 603788}, 'weighted avg': {'precision': 0.28678887303440886, 'recall': 0.30386990135610514, 'f1-score': 0.2642924137547028, 'support': 603788}}
[[ 98305  21813  62522]
 [142017  13142  71354]
 [100799  21810  72026]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1786456
{'0': {'precision': 0.3267921620117313, 'recall': 0.4436479181601535, 'f1-score': 0.3763580480268241, 'support': 51613}, '1': {'precision': 0.2891745546232381, 'recall': 0.13831553973902727, 'f1-score': 0.18712636914394232, 'support': 50580}, '2': {'precision': 0.3326187481175699, 'recall': 0.3869970316622691, 'f1-score': 0.35775332285265116, 'support': 48512}, 'accuracy': 0.3229355363126638, 'macro avg': {'precision': 0.3161951549175131, 'recall': 0.3229868298538166, 'f1-score': 0.30707924667447256, 'support': 150705}, 'weighted avg': {'precision': 0.31604242420247786, 'recall': 0.3229355363126638, 'f1-score': 0.3068587563938614, 'support': 150705}}
[[22898  9030 19685]
 [25600  6996 17984]
 [21571  8167 18774]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1837294
{'0': {'precision': 0.33901951744275394, 'recall': 0.4473964407037469, 'f1-score': 0.3857402023999475, 'support': 19723}, '1': {'precision': 0.30388956254080773, 'recall': 0.17768324607329844, 'f1-score': 0.22424889011253743, 'support': 18336}, '2': {'precision': 0.34760545512210594, 'recall': 0.36953903954530126, 'f1-score': 0.3582368322749346, 'support': 20761}, 'accuracy': 0.33583815028901737, 'macro avg': {'precision': 0.33017151170188924, 'recall': 0.3315395754407822, 'f1-score': 0.3227419749291398, 'support': 58820}, 'weighted avg': {'precision': 0.33109890879057685, 'recall': 0.33583815028901737, 'f1-score': 0.32569086256201235, 'support': 58820}}
[[8824 3548 7351]
 [8030 3258 7048]
 [9174 3915 7672]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1984916
{'0': {'precision': 0.2688123995438206, 'recall': 0.7014374717204414, 'f1-score': 0.3886732593067603, 'support': 114924}, '1': {'precision': 0.28161159905200056, 'recall': 0.03402850308278023, 'f1-score': 0.060719921845645154, 'support': 178086}, '2': {'precision': 0.33690841715193226, 'recall': 0.2590421764720248, 'f1-score': 0.29288833867946673, 'support': 122841}, 'accuracy': 0.28494100050258386, 'macro avg': {'precision': 0.2957774719159178, 'recall': 0.33150271709174883, 'f1-score': 0.24742717327729072, 'support': 415851}, 'weighted avg': {'precision': 0.29440892604637026, 'recall': 0.28494100050258386, 'f1-score': 0.21993442378664002, 'support': 415851}}
[[ 80612   6272  28040]
 [137437   6060  34589]
 [ 81833   9187  31821]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.205166
{'0': {'precision': 0.32389176108238915, 'recall': 0.629368387303623, 'f1-score': 0.42768437488652455, 'support': 37428}, '1': {'precision': 0.3201759332355926, 'recall': 0.07768504583390341, 'f1-score': 0.12503303091693826, 'support': 36545}, '2': {'precision': 0.3744203219613056, 'recall': 0.3056151602092726, 'f1-score': 0.3365369298571656, 'support': 41477}, 'accuracy': 0.3384235599826765, 'macro avg': {'precision': 0.3394960054264291, 'recall': 0.3375561977822663, 'f1-score': 0.2964181118868761, 'support': 115450}, 'weighted avg': {'precision': 0.3408686185177606, 'recall': 0.3384235599826765, 'f1-score': 0.29913594749067135, 'support': 115450}}
[[23556  2858 11014]
 [23541  2839 10165]
 [25631  3170 12676]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2121072
{'0': {'precision': 0.33015992317006976, 'recall': 0.510458360232408, 'f1-score': 0.40097365551864905, 'support': 15490}, '1': {'precision': 0.3129370629370629, 'recall': 0.08522070325783854, 'f1-score': 0.13396054952691505, 'support': 14703}, '2': {'precision': 0.327140361094933, 'recall': 0.37622237106496986, 'f1-score': 0.3499688473520249, 'support': 14930}, 'accuracy': 0.3274826585111805, 'macro avg': {'precision': 0.3234124490673553, 'recall': 0.3239671448517388, 'f1-score': 0.29496768413252966, 'support': 45123}, 'weighted avg': {'precision': 0.3235488872064217, 'recall': 0.3274826585111805, 'f1-score': 0.29709325121653785, 'support': 45123}}
[[7907 1431 6152]
 [8049 1253 5401]
 [7993 1320 5617]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1957603
{'0': {'precision': 0.32457337037404504, 'recall': 0.26944856272135737, 'f1-score': 0.29445319531953196, 'support': 97128}, '1': {'precision': 0.32690674199474545, 'recall': 0.13196548754425697, 'f1-score': 0.1880279729814176, 'support': 125404}, '2': {'precision': 0.2815889700220662, 'recall': 0.5330033648955317, 'f1-score': 0.3684981115232585, 'support': 102232}, 'accuracy': 0.2993250483427966, 'macro avg': {'precision': 0.31102302746361893, 'recall': 0.311472471720382, 'f1-score': 0.2836597599414027, 'support': 324764}, 'weighted avg': {'precision': 0.3119433772650145, 'recall': 0.2993250483427966, 'f1-score': 0.2766667759234489, 'support': 324764}}
[[26171 16000 54957]
 [24793 16549 84062]
 [29668 18074 54490]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1496431
{'0': {'precision': 0.3578605917115639, 'recall': 0.4616198537899192, 'f1-score': 0.40317143607246003, 'support': 41584}, '1': {'precision': 0.3357067044047408, 'recall': 0.18492082825822168, 'f1-score': 0.2384782130627376, 'support': 41050}, '2': {'precision': 0.3512561976584309, 'recall': 0.40510799836620937, 'f1-score': 0.3762650212557045, 'support': 41621}, 'accuracy': 0.3512776145829142, 'macro avg': {'precision': 0.3482744979249119, 'recall': 0.3505495601381168, 'f1-score': 0.3393048901303007, 'support': 124255}, 'weighted avg': {'precision': 0.34832939732236, 'recall': 0.3512776145829142, 'f1-score': 0.33974921004020947, 'support': 124255}}
[[19196  7120 15268]
 [17586  7591 15873]
 [16859  7901 16861]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2050558
{'0': {'precision': 0.3046924141401434, 'recall': 0.6890959527704673, 'f1-score': 0.4225493403118526, 'support': 14059}, '1': {'precision': 0.3791537174276835, 'recall': 0.10233578526261453, 'f1-score': 0.16117067222193995, 'support': 15498}, '2': {'precision': 0.3372812074206058, 'recall': 0.20159117960283154, 'f1-score': 0.2523525721455458, 'support': 15963}, 'accuracy': 0.31836555360281193, 'macro avg': {'precision': 0.3403757796628109, 'recall': 0.3310076392119711, 'f1-score': 0.27869086155977946, 'support': 45520}, 'weighted avg': {'precision': 0.34147220731866534, 'recall': 0.31836555360281193, 'f1-score': 0.27387408529655777, 'support': 45520}}
[[ 9688  1357  3014]
 [10603  1586  3309]
 [11505  1240  3218]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
1733/1733 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2364117
{'0': {'precision': 0.3197631005885576, 'recall': 0.8012036622062872, 'f1-score': 0.4570971695739345, 'support': 140571}, '1': {'precision': 0.36306495061358873, 'recall': 0.016598134933395365, 'f1-score': 0.031744993228345425, 'support': 146161}, '2': {'precision': 0.3442024275229575, 'recall': 0.18576349024110217, 'f1-score': 0.2412994577307544, 'support': 156780}, 'accuracy': 0.3250780136726853, 'macro avg': {'precision': 0.34234349290836796, 'recall': 0.3345217624602616, 'f1-score': 0.24338054017767807, 'support': 443512}, 'weighted avg': {'precision': 0.34267260332644023, 'recall': 0.3250780136726853, 'f1-score': 0.24063704062675514, 'support': 443512}}
[[112626   2251  25694]
 [113940   2426  29795]
 [125651   2005  29124]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2153683
{'0': {'precision': 0.3146316521454575, 'recall': 0.6339465268849108, 'f1-score': 0.4205444475426597, 'support': 60666}, '1': {'precision': 0.32361885453623923, 'recall': 0.03877098703585633, 'f1-score': 0.06924599408941788, 'support': 65874}, '2': {'precision': 0.35479988421164893, 'recall': 0.3364151161446897, 'f1-score': 0.3453630033886743, 'support': 69224}, 'accuracy': 0.3284618213767598, 'macro avg': {'precision': 0.3310167969644486, 'recall': 0.3363775433551523, 'f1-score': 0.27838448167358393, 'support': 195764}, 'weighted avg': {'precision': 0.33185968522018217, 'recall': 0.3284618213767598, 'f1-score': 0.27574870055703243, 'support': 195764}}
[[38459  2223 19984]
 [40955  2554 22365]
 [42821  3115 23288]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.18866
{'0': {'precision': 0.32243743954763027, 'recall': 0.624597645928417, 'f1-score': 0.4253140539125883, 'support': 20815}, '1': {'precision': 0.2774725274725275, 'recall': 0.07215252042684288, 'f1-score': 0.1145246447680805, 'support': 22397}, '2': {'precision': 0.3649921929682873, 'recall': 0.31521435878359527, 'f1-score': 0.33828189326080993, 'support': 21506}, 'accuracy': 0.33060354151858834, 'macro avg': {'precision': 0.3216340533294817, 'recall': 0.3373215083796184, 'f1-score': 0.2927068639804929, 'support': 64718}, 'weighted avg': {'precision': 0.3210174851503772, 'recall': 0.33060354151858834, 'f1-score': 0.28883789513780095, 'support': 64718}}
[[13001  2099  5715]
 [14702  1616  6079]
 [12618  2109  6779]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
4693/4693 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1856635
{'0': {'precision': 0.266269664565888, 'recall': 0.7048449905109633, 'f1-score': 0.3865225145417013, 'support': 304562}, '1': {'precision': 0.42108473542418545, 'recall': 0.02855788539269678, 'f1-score': 0.05348821067278342, 'support': 580155}, '2': {'precision': 0.28127838217058404, 'recall': 0.3160849988150723, 'f1-score': 0.297667650629657, 'support': 316475}, 'accuracy': 0.27578438750840834, 'macro avg': {'precision': 0.3228775940535525, 'recall': 0.3498292915729108, 'f1-score': 0.24589279194804722, 'support': 1201192}, 'weighted avg': {'precision': 0.3449969798807933, 'recall': 0.27578438750840834, 'f1-score': 0.20226232997700533, 'support': 1201192}}
[[214669   9835  80058]
 [388041  16568 175546]
 [203499  12943 100033]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1983966
{'0': {'precision': 0.3278176289750869, 'recall': 0.6198118076785644, 'f1-score': 0.42882846257172913, 'support': 125935}, '1': {'precision': 0.30299322700458814, 'recall': 0.054793871051862154, 'f1-score': 0.09280475400182023, 'support': 126547}, '2': {'precision': 0.3678574936965847, 'recall': 0.34389708189519924, 'f1-score': 0.3554739877305466, 'support': 130667}, 'accuracy': 0.33910045439241654, 'macro avg': {'precision': 0.3328894498920866, 'recall': 0.33950092020854195, 'f1-score': 0.2923690681013653, 'support': 383149}, 'weighted avg': {'precision': 0.3332735623258284, 'recall': 0.33910045439241654, 'f1-score': 0.2928296699023784, 'support': 383149}}
[[78056  7252 40627]
 [83020  6934 36593]
 [77032  8699 44936]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1846473
{'0': {'precision': 0.2975811112028399, 'recall': 0.3841792253746296, 'f1-score': 0.33538026386795433, 'support': 46913}, '1': {'precision': 0.25138406681054704, 'recall': 0.11452633378932968, 'f1-score': 0.1573614496754677, 'support': 46784}, '2': {'precision': 0.3506401628878076, 'recall': 0.4404586440090168, 'f1-score': 0.3904505716207129, 'support': 46136}, 'accuracy': 0.31252994643610593, 'macro avg': {'precision': 0.2998684469670649, 'recall': 0.313054734390992, 'f1-score': 0.294397428388045, 'support': 139833}, 'weighted avg': {'precision': 0.2996310556629362, 'recall': 0.31252994643610593, 'f1-score': 0.29399011644424156, 'support': 139833}}
[[18023  8127 20763]
 [24556  5358 16870]
 [17986  7829 20321]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
6677/6677 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1300384
{'0': {'precision': 0.2976005381970399, 'recall': 0.08690384980583987, 'f1-score': 0.13452451145196798, 'support': 458127}, '1': {'precision': 0.48112656499117595, 'recall': 0.27511467221990443, 'f1-score': 0.3500601943157207, 'support': 841311}, '2': {'precision': 0.23797345292037064, 'recall': 0.6354697351213132, 'f1-score': 0.34627306999157736, 'support': 409848}, 'accuracy': 0.3110749166611088, 'macro avg': {'precision': 0.3389001853695288, 'recall': 0.33249608571568584, 'f1-score': 0.27695259191975535, 'support': 1709286}, 'weighted avg': {'precision': 0.3736348726979538, 'recall': 0.3110749166611088, 'f1-score': 0.2913837287544724, 'support': 1709286}}
[[ 39813 130514 287800]
 [ 63667 231457 546187]
 [ 30300 119102 260446]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1932336
{'0': {'precision': 0.3209732285052508, 'recall': 0.5595925648251079, 'f1-score': 0.407951872625294, 'support': 193405}, '1': {'precision': 0.28834965755946684, 'recall': 0.08028912698005844, 'f1-score': 0.12560448461421253, 'support': 195070}, '2': {'precision': 0.34977312763572305, 'recall': 0.344209331890438, 'f1-score': 0.3469689267331766, 'support': 190358}, 'accuracy': 0.3272325523942139, 'macro avg': {'precision': 0.3196986712334802, 'recall': 0.3280303412318681, 'f1-score': 0.2935084279908944, 'support': 578833}, 'weighted avg': {'precision': 0.31945018336837083, 'recall': 0.3272325523942139, 'f1-score': 0.2927440379070707, 'support': 578833}}
[[108228  19352  65825]
 [123426  15662  55982]
 [105533  19302  65523]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1880859
{'0': {'precision': 0.2919504962963811, 'recall': 0.3878184168504296, 'f1-score': 0.33312432234719336, 'support': 65755}, '1': {'precision': 0.33250071141745974, 'recall': 0.1386511965192168, 'f1-score': 0.19569748399583148, 'support': 75845}, '2': {'precision': 0.3325629117615293, 'recall': 0.4401120576296381, 'f1-score': 0.37885256591655697, 'support': 69964}, 'accuracy': 0.31578623962488894, 'macro avg': {'precision': 0.3190047064917901, 'recall': 0.32219389033309487, 'f1-score': 0.3025581240865272, 'support': 211564}, 'weighted avg': {'precision': 0.31991809995986753, 'recall': 0.31578623962488894, 'f1-score': 0.2989795353244859, 'support': 211564}}
[[25501 10241 30013]
 [33544 10516 31785]
 [28302 10870 30792]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
5633/5633 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2159084
{'0': {'precision': 0.2740067902160864, 'recall': 0.7331583398370353, 'f1-score': 0.39892239598943424, 'support': 398491}, '1': {'precision': 0.3918734290750185, 'recall': 0.06357774119152003, 'f1-score': 0.10940548221221878, 'support': 590993}, '2': {'precision': 0.32795635495207554, 'recall': 0.2027920857742898, 'f1-score': 0.2506157273779097, 'support': 452350}, 'accuracy': 0.2923110427413974, 'macro avg': {'precision': 0.3312788580810601, 'recall': 0.3331760556009484, 'f1-score': 0.25298120185985423, 'support': 1441834}, 'weighted avg': {'precision': 0.33924484404716654, 'recall': 0.2923110427413974, 'f1-score': 0.23372377328365743, 'support': 1441834}}
[[292157  26502  79832]
 [445273  37574 108146]
 [328810  31807  91733]]
Evaluating performance on  train set...
1454/1454 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1542313
{'0': {'precision': 0.3494054146128541, 'recall': 0.2674642240114744, 'f1-score': 0.3029925359699777, 'support': 122708}, '1': {'precision': 0.3320614874501725, 'recall': 0.22184578297553506, 'f1-score': 0.2659883508038727, 'support': 122788}, '2': {'precision': 0.3464062284901418, 'recall': 0.5366630068167995, 'f1-score': 0.4210392588231649, 'support': 126599}, 'accuracy': 0.3440008599954313, 'macro avg': {'precision': 0.3426243768510561, 'recall': 0.3419910046012696, 'f1-score': 0.3300067151990051, 'support': 372095}, 'weighted avg': {'precision': 0.3426616526907627, 'recall': 0.3440008599954313, 'f1-score': 0.3309448792648753, 'support': 372095}}
[[32820 26751 63137]
 [30495 27240 65053]
 [30616 28042 67941]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1373992
{'0': {'precision': 0.38796849538294403, 'recall': 0.11705898018970357, 'f1-score': 0.17985237877905605, 'support': 48813}, '1': {'precision': 0.3218260831005277, 'recall': 0.31360729409731225, 'f1-score': 0.31766353708445494, 'support': 46284}, '2': {'precision': 0.33415676729514054, 'recall': 0.58323117893224, 'f1-score': 0.42488163516686556, 'support': 47314}, 'accuracy': 0.33581675572813896, 'macro avg': {'precision': 0.3479837819262041, 'recall': 0.33796581773975193, 'f1-score': 0.30746585034345886, 'support': 142411}, 'weighted avg': {'precision': 0.34859384375613367, 'recall': 0.33581675572813896, 'f1-score': 0.3060488515777858, 'support': 142411}}
[[ 5714 15121 27978]
 [ 4761 14515 27008]
 [ 4253 15466 27595]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
11876/11876 - 165s - 165s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1892821
{'0': {'precision': 0.3760389842483154, 'recall': 0.5124404821763521, 'f1-score': 0.4337693907114079, 'support': 1143565}, '1': {'precision': 0.23658442117064074, 'recall': 0.1699198027289718, 'f1-score': 0.19778578332308233, 'support': 715361}, '2': {'precision': 0.38584234074621976, 'recall': 0.31619079385692744, 'f1-score': 0.3475613614537658, 'support': 1181233}, 'accuracy': 0.35559258578251995, 'macro avg': {'precision': 0.33282191538839195, 'recall': 0.3328503595874171, 'f1-score': 0.32637217849608535, 'support': 3040159}, 'weighted avg': {'precision': 0.34703382119871196, 'recall': 0.35559258578251995, 'f1-score': 0.3447460079248456, 'support': 3040159}}
[[586009 194490 363066]
 [362369 121554 231438]
 [609995 197743 373495]]
Evaluating performance on  train set...
2538/2538 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402224
{'0': {'precision': 0.33634760328103425, 'recall': 0.1867068733029167, 'f1-score': 0.24012186937645882, 'support': 216548}, '1': {'precision': 0.3423146425007417, 'recall': 0.28392465661491656, 'f1-score': 0.31039753481945237, 'support': 223510}, '2': {'precision': 0.3298336792293785, 'recall': 0.5414688381281404, 'f1-score': 0.40994868145108126, 'support': 209567}, 'accuracy': 0.33460073119107175, 'macro avg': {'precision': 0.3361653083370515, 'recall': 0.3373667893486579, 'f1-score': 0.3201560285489975, 'support': 649625}, 'weighted avg': {'precision': 0.3362992514076665, 'recall': 0.33460073119107175, 'f1-score': 0.3190865174568219, 'support': 649625}}
[[ 40431  61814 114303]
 [ 43793  63460 116257]
 [ 35982  60111 113474]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1618555
{'0': {'precision': 0.2834350434422838, 'recall': 0.162491105313093, 'f1-score': 0.20656188753203678, 'support': 67456}, '1': {'precision': 0.3185815901047689, 'recall': 0.26860071788357287, 'f1-score': 0.2914639717255583, 'support': 67699}, '2': {'precision': 0.33101168254675806, 'recall': 0.5220498850271688, 'f1-score': 0.4051398337112623, 'support': 68277}, 'accuracy': 0.31847988517047465, 'macro avg': {'precision': 0.3110094386979369, 'recall': 0.3177139027412782, 'f1-score': 0.3010552309896191, 'support': 203432}, 'weighted avg': {'precision': 0.3110992076378861, 'recall': 0.31847988517047465, 'f1-score': 0.3014638332883396, 'support': 203432}}
[[10961 19581 36914]
 [14391 18184 35124]
 [13320 19313 35644]]
testing model on single stock: results/universal/W0/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
19053/19053 - 253s - 253s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1301725
{'0': {'precision': 0.35123713113344307, 'recall': 0.05601453909379878, 'f1-score': 0.09662028397373983, 'support': 1276008}, '1': {'precision': 0.4965785917488248, 'recall': 0.27260381719149007, 'f1-score': 0.3519820996239353, 'support': 2371115}, '2': {'precision': 0.2536676018348314, 'recall': 0.6952967013674403, 'f1-score': 0.37171945499819997, 'support': 1230328}, 'accuracy': 0.3225645936781323, 'macro avg': {'precision': 0.3671611082390331, 'recall': 0.3413050192175764, 'f1-score': 0.2734406128652917, 'support': 4877451}, 'weighted avg': {'precision': 0.39728142630814367, 'recall': 0.3225645936781323, 'f1-score': 0.29015466174680105, 'support': 4877451}}
[[  71475  329794  874739]
 [  82623  646375 1642117]
 [  49397  325488  855443]]
Evaluating performance on  train set...
4812/4812 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2006228
{'0': {'precision': 0.32753944004489616, 'recall': 0.5707100014568944, 'f1-score': 0.41620963101893665, 'support': 404971}, '1': {'precision': 0.35363618582615564, 'recall': 0.12000953841917911, 'f1-score': 0.17920446974132695, 'support': 406776}, '2': {'precision': 0.33715871065464187, 'recall': 0.31153881857845717, 'f1-score': 0.3238428440292064, 'support': 420121}, 'accuracy': 0.33349514720733064, 'macro avg': {'precision': 0.3394447788418979, 'recall': 0.3340861194848435, 'f1-score': 0.30641898159649, 'support': 1231868}, 'weighted avg': {'precision': 0.3394374578923884, 'recall': 0.33349514720733064, 'f1-score': 0.30644686552720096, 'support': 1231868}}
[[231121  44531 129319]
 [229965  48817 127994]
 [244542  44695 130884]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1838129
{'0': {'precision': 0.3352218498213215, 'recall': 0.4015193810815122, 'f1-score': 0.3653876395659695, 'support': 150456}, '1': {'precision': 0.34009135347383607, 'recall': 0.10858802307879284, 'f1-score': 0.16461575757575758, 'support': 156334}, '2': {'precision': 0.3250016879346432, 'recall': 0.49623719098575286, 'f1-score': 0.39276738796958127, 'support': 145503}, 'accuracy': 0.3307391447579335, 'macro avg': {'precision': 0.3334382970766003, 'recall': 0.3354481983820193, 'f1-score': 0.3075902617037694, 'support': 452293}, 'weighted avg': {'precision': 0.33361714837561013, 'recall': 0.3307391447579335, 'f1-score': 0.3047994017044791, 'support': 452293}}
[[60411 16717 73328]
 [62725 16976 76633]
 [57076 16223 72204]]
training model: results/universal/W0/deepOF_L2/h300
Epoch 1/50
8838/8838 - 204s - loss: 3.2702 - accuracy300: 0.3795 - val_loss: 3.2819 - val_accuracy300: 0.3652 - 204s/epoch - 23ms/step
Epoch 2/50
8838/8838 - 197s - loss: 3.2546 - accuracy300: 0.3882 - val_loss: 3.2818 - val_accuracy300: 0.3592 - 197s/epoch - 22ms/step
Epoch 3/50
8838/8838 - 197s - loss: 3.2497 - accuracy300: 0.3919 - val_loss: 3.2792 - val_accuracy300: 0.3632 - 197s/epoch - 22ms/step
Epoch 4/50
8838/8838 - 197s - loss: 3.2468 - accuracy300: 0.3935 - val_loss: 3.2774 - val_accuracy300: 0.3651 - 197s/epoch - 22ms/step
Epoch 5/50
8838/8838 - 198s - loss: 3.2439 - accuracy300: 0.3955 - val_loss: 3.2774 - val_accuracy300: 0.3654 - 198s/epoch - 22ms/step
Epoch 6/50
8838/8838 - 197s - loss: 3.2418 - accuracy300: 0.3969 - val_loss: 3.2772 - val_accuracy300: 0.3661 - 197s/epoch - 22ms/step
Epoch 7/50
8838/8838 - 196s - loss: 3.2396 - accuracy300: 0.3984 - val_loss: 3.2765 - val_accuracy300: 0.3671 - 196s/epoch - 22ms/step
Epoch 8/50
8838/8838 - 199s - loss: 3.2377 - accuracy300: 0.3998 - val_loss: 3.2784 - val_accuracy300: 0.3667 - 199s/epoch - 22ms/step
Epoch 9/50
8838/8838 - 197s - loss: 3.2362 - accuracy300: 0.4010 - val_loss: 3.2797 - val_accuracy300: 0.3677 - 197s/epoch - 22ms/step
Epoch 10/50
8838/8838 - 196s - loss: 3.2345 - accuracy300: 0.4024 - val_loss: 3.2804 - val_accuracy300: 0.3678 - 196s/epoch - 22ms/step
Epoch 11/50
8838/8838 - 197s - loss: 3.2327 - accuracy300: 0.4037 - val_loss: 3.2840 - val_accuracy300: 0.3661 - 197s/epoch - 22ms/step
Epoch 12/50
8838/8838 - 197s - loss: 3.2315 - accuracy300: 0.4046 - val_loss: 3.2859 - val_accuracy300: 0.3657 - 197s/epoch - 22ms/step
Epoch 13/50
8838/8838 - 197s - loss: 3.2302 - accuracy300: 0.4056 - val_loss: 3.2870 - val_accuracy300: 0.3650 - 197s/epoch - 22ms/step
Epoch 14/50
8838/8838 - 197s - loss: 3.2290 - accuracy300: 0.4061 - val_loss: 3.2881 - val_accuracy300: 0.3637 - 197s/epoch - 22ms/step
Epoch 15/50
8838/8838 - 196s - loss: 3.2274 - accuracy300: 0.4077 - val_loss: 3.2887 - val_accuracy300: 0.3636 - 196s/epoch - 22ms/step
Epoch 16/50
8838/8838 - 196s - loss: 3.2259 - accuracy300: 0.4086 - val_loss: 3.2919 - val_accuracy300: 0.3634 - 196s/epoch - 22ms/step
Epoch 17/50
8838/8838 - 197s - loss: 3.2244 - accuracy300: 0.4094 - val_loss: 3.2963 - val_accuracy300: 0.3609 - 197s/epoch - 22ms/step
testing model in sample: results/universal/W0/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 249s - 249s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0804805
{'0': {'precision': 0.33380103966348096, 'recall': 0.39153800114151266, 'f1-score': 0.36037159037723854, 'support': 2377547}, '1': {'precision': 0.45665570943179795, 'recall': 0.4051649535104858, 'f1-score': 0.42937213561476933, 'support': 3649210}, '2': {'precision': 0.34376617661749664, 'recall': 0.34379896022164547, 'f1-score': 0.3437825676379981, 'support': 2422247}, 'accuracy': 0.3837373020535912, 'macro avg': {'precision': 0.3780743085709252, 'recall': 0.3801673049578813, 'f1-score': 0.3778420978766686, 'support': 8449004}, 'weighted avg': {'precision': 0.3897201175283622, 'recall': 0.3837373020535912, 'f1-score': 0.38541771050254475, 'support': 8449004}}
[[ 930900  868162  578485]
 [1159451 1478532 1011227]
 [ 698436  891045  832766]]
Evaluating performance on  train set...
8838/8838 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0919725
{'0': {'precision': 0.36823220517655686, 'recall': 0.450460360412075, 'f1-score': 0.4052168514316559, 'support': 749087}, '1': {'precision': 0.3502963123250571, 'recall': 0.33562640614006695, 'f1-score': 0.3428044857673137, 'support': 747614}, '2': {'precision': 0.3857362340899811, 'recall': 0.3172107425868703, 'f1-score': 0.34813344766569826, 'support': 765365}, 'accuracy': 0.367422966438645, 'macro avg': {'precision': 0.3680882505305317, 'recall': 0.36776583637967075, 'f1-score': 0.36538492828822267, 'support': 2262066}, 'weighted avg': {'precision': 0.3682268324292726, 'recall': 0.367422966438645, 'f1-score': 0.3652754891252008, 'support': 2262066}}
[[337434 227817 183836]
 [293914 250919 202781]
 [285014 237569 242782]]
Evaluating performance on  val set...
3279/3279 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925016
{'0': {'precision': 0.3726932362510232, 'recall': 0.44868743574145026, 'f1-score': 0.40717484156526734, 'support': 281091}, '1': {'precision': 0.3415562457637849, 'recall': 0.3335187952972664, 'f1-score': 0.33748967354606285, 'support': 274989}, '2': {'precision': 0.38789992627689707, 'recall': 0.3181573866489388, 'f1-score': 0.3495841614164738, 'support': 282794}, 'accuracy': 0.36693114818196776, 'macro avg': {'precision': 0.36738313609723505, 'recall': 0.3667878725625518, 'f1-score': 0.36474955884260135, 'support': 838874}, 'weighted avg': {'precision': 0.3676126530193124, 'recall': 0.36693114818196776, 'f1-score': 0.3649170609326206, 'support': 838874}}
[[126122  87183  67786]
 [109085  91714  74190]
 [103200  89621  89973]]
testing model out of sample: results/universal/W0/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 173s - 173s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911407
{'0': {'precision': 0.3913738483901099, 'recall': 0.37744747326567585, 'f1-score': 0.38428453014014813, 'support': 1995936}, '1': {'precision': 0.32605579760592696, 'recall': 0.39864010662330335, 'f1-score': 0.3587129916541077, 'support': 1837497}, '2': {'precision': 0.40150926044071655, 'recall': 0.3336315738145191, 'f1-score': 0.36443674523304, 'support': 1999505}, 'accuracy': 0.36910370039935275, 'macro avg': {'precision': 0.3729796354789178, 'recall': 0.36990638456783276, 'f1-score': 0.36914475567576527, 'support': 5832938}, 'weighted avg': {'precision': 0.3742716753017733, 'recall': 0.36910370039935275, 'f1-score': 0.36942523103321934, 'support': 5832938}}
[[753361 748102 494473]
 [605092 732500 499905]
 [566461 765946 667098]]
Evaluating performance on  train set...
6334/6334 - 53s - 53s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938175
{'0': {'precision': 0.37850714959189025, 'recall': 0.3710120199932189, 'f1-score': 0.3747221094550446, 'support': 548586}, '1': {'precision': 0.3369337947960351, 'recall': 0.43051942738729754, 'f1-score': 0.37802054955309444, 'support': 525521}, '2': {'precision': 0.3887208785443098, 'recall': 0.29267262269447775, 'f1-score': 0.3339273380589401, 'support': 546785}, 'accuracy': 0.36387865446926754, 'macro avg': {'precision': 0.36805394097741173, 'recall': 0.3647346900249981, 'f1-score': 0.362223332355693, 'support': 1620892}, 'weighted avg': {'precision': 0.36847381165177834, 'recall': 0.36387865446926754, 'f1-score': 0.3620299809609489, 'support': 1620892}}
[[203532 220546 124508]
 [172130 226247 127144]
 [162061 224695 160029]]
Evaluating performance on  val set...
2156/2156 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910147
{'0': {'precision': 0.37398187927142607, 'recall': 0.395757539064435, 'f1-score': 0.3845616962559466, 'support': 181687}, '1': {'precision': 0.347278962921421, 'recall': 0.43473400549756175, 'f1-score': 0.3861162939051941, 'support': 185173}, '2': {'precision': 0.39581483431427245, 'recall': 0.2730579498021358, 'f1-score': 0.32317172929050547, 'support': 184470}, 'accuracy': 0.367794243012352, 'macro avg': {'precision': 0.3723585588357065, 'recall': 0.3678498314547108, 'f1-score': 0.3646165731505487, 'support': 551330}, 'weighted avg': {'precision': 0.37231838569675096, 'recall': 0.367794243012352, 'f1-score': 0.36454330854693234, 'support': 551330}}
[[71904 73388 36395]
 [64179 80501 40493]
 [56183 77916 50371]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989116
{'0': {'precision': 0.3023260605311412, 'recall': 0.45630237728749784, 'f1-score': 0.36368818583440216, 'support': 64317}, '1': {'precision': 0.43449195240055677, 'recall': 0.2406379952443513, 'f1-score': 0.3097337712249319, 'support': 92101}, '2': {'precision': 0.31162001919360566, 'recall': 0.3499675190456505, 'f1-score': 0.3296824039110146, 'support': 67732}, 'accuracy': 0.33555654695516396, 'macro avg': {'precision': 0.34947934404176784, 'recall': 0.34896929719249986, 'f1-score': 0.3343681203234496, 'support': 224150}, 'weighted avg': {'precision': 0.3594400878128324, 'recall': 0.33555654695516396, 'f1-score': 0.3312432375355768, 'support': 224150}}
[[29348 14193 20776]
 [38351 22163 31587]
 [29375 14653 23704]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968182
{'0': {'precision': 0.36360657390602946, 'recall': 0.5156573961535712, 'f1-score': 0.42648493628595924, 'support': 27974}, '1': {'precision': 0.33042713165893456, 'recall': 0.1600418410041841, 'f1-score': 0.21563919194028291, 'support': 25812}, '2': {'precision': 0.3591270524250456, 'recall': 0.3802252268668683, 'f1-score': 0.36937511063905115, 'support': 27439}, 'accuracy': 0.3568975069252078, 'macro avg': {'precision': 0.35105358599666986, 'recall': 0.35197482134154123, 'f1-score': 0.3371664129550978, 'support': 81225}, 'weighted avg': {'precision': 0.35154943197683614, 'recall': 0.3568975069252078, 'f1-score': 0.34018900696646265, 'support': 81225}}
[[14425  4191  9358]
 [12421  4131  9260]
 [12826  4180 10433]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961602
{'0': {'precision': 0.33910891089108913, 'recall': 0.4984234780499636, 'f1-score': 0.4036138662476677, 'support': 8246}, '1': {'precision': 0.4176929392446634, 'recall': 0.20228628230616302, 'f1-score': 0.2725689793731583, 'support': 10060}, '2': {'precision': 0.32701820860962005, 'recall': 0.3795040918529376, 'f1-score': 0.35131162369968344, 'support': 8187}, 'accuracy': 0.34922432340618276, 'macro avg': {'precision': 0.3612733529151242, 'recall': 0.3600712840696881, 'f1-score': 0.34249815644016984, 'support': 26493}, 'weighted avg': {'precision': 0.3652127400406218, 'recall': 0.34922432340618276, 'f1-score': 0.33769041395091337, 'support': 26493}}
[[4110 1407 2729]
 [4360 2035 3665]
 [3650 1430 3107]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
2359/2359 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0849316
{'0': {'precision': 0.3736320743064648, 'recall': 0.4032709607580694, 'f1-score': 0.38788615509291313, 'support': 187529}, '1': {'precision': 0.338233475692694, 'recall': 0.3711925092381887, 'f1-score': 0.3539473749695169, 'support': 191596}, '2': {'precision': 0.4515885972623383, 'recall': 0.38415725235691583, 'f1-score': 0.4151526084133054, 'support': 224658}, 'accuracy': 0.3859797311285677, 'macro avg': {'precision': 0.3878180490871657, 'recall': 0.38620690745105796, 'f1-score': 0.38566204615857846, 'support': 603783}, 'weighted avg': {'precision': 0.391405556889142, 'recall': 0.3859797311285677, 'f1-score': 0.387261911537746, 'support': 603783}}
[[75625 63119 48785]
 [64454 71119 56023]
 [62326 76028 86304]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.08488
{'0': {'precision': 0.39507986674639106, 'recall': 0.45545139435953996, 'f1-score': 0.42312301598192315, 'support': 50776}, '1': {'precision': 0.3590183427223641, 'recall': 0.36317387703592696, 'f1-score': 0.36108415429103563, 'support': 50714}, '2': {'precision': 0.40092492903983556, 'recall': 0.33293371804771, 'f1-score': 0.36377966741413376, 'support': 49214}, 'accuracy': 0.3843892663764731, 'macro avg': {'precision': 0.3850077128361969, 'recall': 0.3838529964810589, 'f1-score': 0.38266227922903084, 'support': 150704}, 'weighted avg': {'precision': 0.384853427941549, 'recall': 0.3843892663764731, 'f1-score': 0.38286686891079796, 'support': 150704}}
[[23126 16315 11335]
 [19148 18418 13148]
 [16261 16568 16385]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0897975
{'0': {'precision': 0.39656477713636795, 'recall': 0.42569077610727346, 'f1-score': 0.41061192494243304, 'support': 19688}, '1': {'precision': 0.31188190457812726, 'recall': 0.3698724183305681, 'f1-score': 0.33841080402010054, 'support': 17479}, '2': {'precision': 0.4427931115829205, 'recall': 0.3467578052835766, 'f1-score': 0.38893493576460836, 'support': 21652}, 'accuracy': 0.38004726363930025, 'macro avg': {'precision': 0.3837465977658052, 'recall': 0.3807736665738061, 'f1-score': 0.37931922157571396, 'support': 58819}, 'weighted avg': {'precision': 0.3884171372239462, 'recall': 0.38004726363930025, 'f1-score': 0.3811766478673432, 'support': 58819}}
[[8381 6680 4627]
 [6193 6465 4821]
 [6560 7584 7508]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
1625/1625 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0909349
{'0': {'precision': 0.30726612224230615, 'recall': 0.44814942035208244, 'f1-score': 0.3645705623260087, 'support': 116450}, '1': {'precision': 0.4329829986798632, 'recall': 0.3391142414842996, 'f1-score': 0.38034251007476794, 'support': 175059}, '2': {'precision': 0.33779936820452544, 'recall': 0.2958491840723196, 'f1-score': 0.31543563732404933, 'support': 124337}, 'accuracy': 0.3567113787315497, 'macro avg': {'precision': 0.35934949637556496, 'recall': 0.3610376153029005, 'f1-score': 0.3534495699082753, 'support': 415846}, 'weighted avg': {'precision': 0.36931861974255087, 'recall': 0.3567113787315497, 'f1-score': 0.35651886104952996, 'support': 415846}}
[[52187 36864 27399]
 [70982 59365 44712]
 [46674 40878 36785]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974326
{'0': {'precision': 0.3453329434982823, 'recall': 0.5046599193526852, 'f1-score': 0.41006390296297107, 'support': 37447}, '1': {'precision': 0.34515487718848203, 'recall': 0.2817874813476793, 'f1-score': 0.3102687900843122, 'support': 38199}, '2': {'precision': 0.3833028641072517, 'recall': 0.2844580674337973, 'f1-score': 0.3265647533890972, 'support': 39802}, 'accuracy': 0.35499965352366436, 'macro avg': {'precision': 0.35793022826467197, 'recall': 0.356968489378054, 'f1-score': 0.3489658154787935, 'support': 115448}, 'weighted avg': {'precision': 0.35836458393475706, 'recall': 0.35499965352366436, 'f1-score': 0.34825679787504216, 'support': 115448}}
[[18898  9698  8851]
 [18070 10764  9365]
 [17756 10724 11322]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09547
{'0': {'precision': 0.3722772277227723, 'recall': 0.5599585599585599, 'f1-score': 0.44722552619330813, 'support': 15444}, '1': {'precision': 0.3442240373395566, 'recall': 0.27877151535605804, 'f1-score': 0.30805952336553166, 'support': 14815}, '2': {'precision': 0.3707933299646286, 'recall': 0.24683799784714747, 'f1-score': 0.2963770750030292, 'support': 14864}, 'accuracy': 0.36449260909070763, 'macro avg': {'precision': 0.3624315316756525, 'recall': 0.3618560243872551, 'f1-score': 0.35055404152062297, 'support': 45123}, 'weighted avg': {'precision': 0.36257785773840984, 'recall': 0.36449260909070763, 'f1-score': 0.35184277880537257, 'support': 45123}}
[[8648 3869 2927]
 [7386 4130 3299]
 [7196 3999 3669]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055824
{'0': {'precision': 0.3133834185289816, 'recall': 0.6517586446051719, 'f1-score': 0.42325448222391654, 'support': 100930}, '1': {'precision': 0.362695293779354, 'recall': 0.032348792477025004, 'f1-score': 0.05939972372221524, 'support': 116975}, '2': {'precision': 0.33289598437036116, 'recall': 0.32530368540251187, 'f1-score': 0.3290560464995196, 'support': 106854}, 'accuracy': 0.32124128969481985, 'macro avg': {'precision': 0.3363248988928989, 'recall': 0.33647037416156955, 'f1-score': 0.2705700841485505, 'support': 324759}, 'weighted avg': {'precision': 0.3375652035382564, 'recall': 0.32124128969481985, 'f1-score': 0.2612038846219064, 'support': 324759}}
[[65782  3016 32132]
 [75666  3784 37525]
 [68461  3633 34760]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101621
{'0': {'precision': 0.3375838768710994, 'recall': 0.6984708737864078, 'f1-score': 0.45517383189396093, 'support': 41200}, '1': {'precision': 0.31524856596558315, 'recall': 0.032155830225017674, 'f1-score': 0.058358958476207326, 'support': 41019}, '2': {'precision': 0.35487853902256933, 'recall': 0.2940168906863328, 'f1-score': 0.32159352597546215, 'support': 42035}, 'accuracy': 0.34167914111416936, 'macro avg': {'precision': 0.3359036606197506, 'recall': 0.34154786489925276, 'f1-score': 0.2783754387818768, 'support': 124254}, 'weighted avg': {'precision': 0.3360612619492753, 'recall': 0.34167914111416936, 'f1-score': 0.278986365478337, 'support': 124254}}
[[28777  1453 10970]
 [28203  1319 11497]
 [28264  1412 12359]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038
{'0': {'precision': 0.3262568377181558, 'recall': 0.6839590443686007, 'f1-score': 0.44177946298664084, 'support': 14650}, '1': {'precision': 0.32309839497557574, 'recall': 0.03117215377364842, 'f1-score': 0.05685865160260346, 'support': 14853}, '2': {'precision': 0.37632720203379694, 'recall': 0.3142482517482518, 'f1-score': 0.3424974481116026, 'support': 16016}, 'accuracy': 0.3408686482567719, 'macro avg': {'precision': 0.34189414490917613, 'recall': 0.34312648329683365, 'f1-score': 0.2803785209002823, 'support': 45519}, 'weighted avg': {'precision': 0.34284363894014586, 'recall': 0.3408686482567719, 'f1-score': 0.28124584929289276, 'support': 45519}}
[[10020   469  4161]
 [10210   463  4180]
 [10482   501  5033]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
1733/1733 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963451
{'0': {'precision': 0.3563850491993229, 'recall': 0.5327473984762987, 'f1-score': 0.4270751974312245, 'support': 147798}, '1': {'precision': 0.34599357671355396, 'recall': 0.24407783417935702, 'f1-score': 0.2862343820942707, 'support': 139476}, '2': {'precision': 0.38584439952648236, 'recall': 0.30667656641042546, 'f1-score': 0.3417353161442174, 'support': 156233}, 'accuracy': 0.3623279903135689, 'macro avg': {'precision': 0.3627410084797864, 'recall': 0.3611672663553604, 'f1-score': 0.35168163188990426, 'support': 443507}, 'weighted avg': {'precision': 0.3634946588858397, 'recall': 0.3623279903135689, 'f1-score': 0.3527205215567739, 'support': 443507}}
[[78739 31202 37857]
 [67026 34043 38407]
 [75173 33147 47913]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958012
{'0': {'precision': 0.34790812601785814, 'recall': 0.48803390524806606, 'f1-score': 0.4062266402633339, 'support': 63471}, '1': {'precision': 0.3742717682254763, 'recall': 0.2941285652416012, 'f1-score': 0.32939546163173394, 'support': 64652}, '2': {'precision': 0.37046905455911017, 'recall': 0.30627873626942237, 'f1-score': 0.335329632087535, 'support': 67641}, 'accuracy': 0.36119511248237673, 'macro avg': {'precision': 0.3642163162674816, 'recall': 0.3628137355863632, 'f1-score': 0.3569839113275343, 'support': 195764}, 'weighted avg': {'precision': 0.36441016910783264, 'recall': 0.36119511248237673, 'f1-score': 0.356356215206074, 'support': 195764}}
[[30976 15049 17446]
 [27878 19016 17758]
 [30181 16743 20717]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956491
{'0': {'precision': 0.34351593933766633, 'recall': 0.5265430048863798, 'f1-score': 0.4157785311581037, 'support': 21079}, '1': {'precision': 0.37499138347004896, 'recall': 0.24774569632935603, 'f1-score': 0.29836829836829837, 'support': 21958}, '2': {'precision': 0.363164069046422, 'recall': 0.2998477929984779, 'f1-score': 0.3284826436258905, 'support': 21681}, 'accuracy': 0.3560060570474984, 'macro avg': {'precision': 0.36055713061804573, 'recall': 0.35804549807140457, 'f1-score': 0.3475431577174309, 'support': 64718}, 'weighted avg': {'precision': 0.3607774261338342, 'recall': 0.3560060570474984, 'f1-score': 0.34669796579476647, 'support': 64718}}
[[11099  4373  5607]
 [10725  5440  5793]
 [10486  4694  6501]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/EXC
Evaluating performance on  test set...
4693/4693 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0681838
{'0': {'precision': 0.40465675689481434, 'recall': 0.4597543474590579, 'f1-score': 0.43044959111240644, 'support': 379072}, '1': {'precision': 0.39252531740235974, 'recall': 0.41304453491897797, 'f1-score': 0.40252359668918913, 'support': 432043}, '2': {'precision': 0.42910600146261313, 'recall': 0.34748200332246354, 'f1-score': 0.3840044196077599, 'support': 390072}, 'accuracy': 0.40649457578212217, 'macro avg': {'precision': 0.40876269191992903, 'recall': 0.4067602952334998, 'f1-score': 0.40565920246978515, 'support': 1201187}, 'weighted avg': {'precision': 0.40823293796771287, 'recall': 0.40649457578212217, 'f1-score': 0.4053226197517852, 'support': 1201187}}
[[174280 130263  74529]
 [147789 178453 105801]
 [108617 145912 135543]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0768099
{'0': {'precision': 0.41157386610765295, 'recall': 0.45520646036402634, 'f1-score': 0.4322919592137831, 'support': 126804}, '1': {'precision': 0.3616422093071412, 'recall': 0.4143161024521782, 'f1-score': 0.3861913413946495, 'support': 126459}, '2': {'precision': 0.4328881997082317, 'recall': 0.3266966932286253, 'f1-score': 0.3723695526264984, 'support': 129885}, 'accuracy': 0.3981464081764749, 'macro avg': {'precision': 0.40203475837434194, 'recall': 0.3987397520149433, 'f1-score': 0.3969509510783104, 'support': 383148}, 'weighted avg': {'precision': 0.4023192303856219, 'recall': 0.3981464081764749, 'f1-score': 0.3967629735258002, 'support': 383148}}
[[57722 44006 25076]
 [43551 52394 30514]
 [38974 48478 42433]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0790912
{'0': {'precision': 0.4280817938886953, 'recall': 0.45868951780230727, 'f1-score': 0.44285742903503683, 'support': 48196}, '1': {'precision': 0.32727206272044446, 'recall': 0.41138499000712136, 'f1-score': 0.3645394402035624, 'support': 43531}, '2': {'precision': 0.44980879541108987, 'recall': 0.31297551241009436, 'f1-score': 0.3691191252543578, 'support': 48106}, 'accuracy': 0.39383407350196303, 'macro avg': {'precision': 0.4017208840067432, 'recall': 0.39435000673984105, 'f1-score': 0.392171998164319, 'support': 139833}, 'weighted avg': {'precision': 0.4041736372143136, 'recall': 0.39383407350196303, 'f1-score': 0.393108691516023, 'support': 139833}}
[[22107 17554  8535]
 [15742 17908  9881]
 [13793 19257 15056]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/AAL
Evaluating performance on  test set...
6677/6677 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0711751
{'0': {'precision': 0.40744063897859334, 'recall': 0.40145623004374226, 'f1-score': 0.4044262974800635, 'support': 541810}, '1': {'precision': 0.41588046616466795, 'recall': 0.48003210710978783, 'f1-score': 0.44565950391605785, 'support': 681469}, '2': {'precision': 0.36913126221582143, 'recall': 0.29533417557952435, 'f1-score': 0.32813468031941767, 'support': 486002}, 'accuracy': 0.40260963527939525, 'macro avg': {'precision': 0.3974841224530276, 'recall': 0.39227417091101807, 'f1-score': 0.39274016057184635, 'support': 1709281}, 'weighted avg': {'precision': 0.39991293982743353, 'recall': 0.40260963527939525, 'f1-score': 0.39917337150324783, 'support': 1709281}}
[[217513 231885  92412]
 [201447 327127 152895]
 [114892 227577 143533]]
Evaluating performance on  train set...
2262/2262 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899296
{'0': {'precision': 0.39752861752140106, 'recall': 0.3843439220583551, 'f1-score': 0.39082510320859193, 'support': 197789}, '1': {'precision': 0.33613739509348184, 'recall': 0.45668075466052566, 'f1-score': 0.3872451187161754, 'support': 187157}, '2': {'precision': 0.40211358454338175, 'recall': 0.2765195863527349, 'f1-score': 0.32769480430178505, 'support': 193885}, 'accuracy': 0.37161624031884954, 'macro avg': {'precision': 0.37859319905275485, 'recall': 0.3725147543572052, 'f1-score': 0.36858834207551744, 'support': 578831}, 'weighted avg': {'precision': 0.3792143933611793, 'recall': 0.37161624031884954, 'f1-score': 0.3685214650807214, 'support': 578831}}
[[76019 82583 39187]
 [61158 85471 40528]
 [54052 86220 53613]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0861676
{'0': {'precision': 0.3818896544060451, 'recall': 0.40177997311042263, 'f1-score': 0.3915823956701324, 'support': 68428}, '1': {'precision': 0.35313913998132623, 'recall': 0.4730736454353025, 'f1-score': 0.4044014405141672, 'support': 72754}, '2': {'precision': 0.4145432092901755, 'recall': 0.24801795913727942, 'f1-score': 0.3103537171862638, 'support': 70382}, 'accuracy': 0.3751441644136053, 'macro avg': {'precision': 0.3831906678925156, 'recall': 0.3742905258943348, 'f1-score': 0.3687791844568545, 'support': 211564}, 'weighted avg': {'precision': 0.3828657541838848, 'recall': 0.3751441644136053, 'f1-score': 0.3689679619268267, 'support': 211564}}
[[27493 29871 11064]
 [24747 34418 13589]
 [19752 33174 17456]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/WBA
Evaluating performance on  test set...
5633/5633 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0739087
{'0': {'precision': 0.294632265717675, 'recall': 0.34600974042388255, 'f1-score': 0.31826084710076596, 'support': 356042}, '1': {'precision': 0.5014005101626346, 'recall': 0.43637127198067904, 'f1-score': 0.4666311837435794, 'support': 707212}, '2': {'precision': 0.32212997689920164, 'recall': 0.3473472891765172, 'f1-score': 0.3342637006759144, 'support': 378575}, 'accuracy': 0.3906829450649141, 'macro avg': {'precision': 0.37272091759317044, 'recall': 0.3765761005270263, 'f1-score': 0.3730519105067533, 'support': 1441829}, 'weighted avg': {'precision': 0.4032713135527201, 'recall': 0.3906829450649141, 'f1-score': 0.3952377721106313, 'support': 1441829}}
[[123194 148135  84713]
 [206604 308607 192001]
 [ 88330 158748 131497]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092402
{'0': {'precision': 0.37587240620169565, 'recall': 0.3908511588261558, 'f1-score': 0.3832154696572336, 'support': 123185}, '1': {'precision': 0.3497613382789756, 'recall': 0.38523702950152594, 'f1-score': 0.3666430427592724, 'support': 122875}, '2': {'precision': 0.3825935708303807, 'recall': 0.32985805304959814, 'f1-score': 0.3542740760309169, 'support': 126033}, 'accuracy': 0.36833802302112645, 'macro avg': {'precision': 0.369409105103684, 'recall': 0.36864874712575996, 'f1-score': 0.36804419614914097, 'support': 372093}, 'weighted avg': {'precision': 0.36952638805742216, 'recall': 0.36833802302112645, 'f1-score': 0.36793996697915965, 'support': 372093}}
[[48147 42753 32285]
 [40736 47336 34803]
 [39211 45249 41573]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944625
{'0': {'precision': 0.3841302994396803, 'recall': 0.3929048293995604, 'f1-score': 0.3884680220159636, 'support': 48681}, '1': {'precision': 0.33384484228474, 'recall': 0.3959021365505156, 'f1-score': 0.36223482979773064, 'support': 44511}, '2': {'precision': 0.3909168507732476, 'recall': 0.31636799544881955, 'f1-score': 0.3497136440202134, 'support': 49218}, 'accuracy': 0.3673899304824099, 'macro avg': {'precision': 0.3696306641658893, 'recall': 0.36839165379963185, 'f1-score': 0.3668054986113025, 'support': 142410}, 'weighted avg': {'precision': 0.3707587981414005, 'recall': 0.3673899304824099, 'f1-score': 0.3668748853330017, 'support': 142410}}
[[19127 17165 12389]
 [15017 17622 11872]
 [15649 17998 15571]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
11876/11876 - 91s - 91s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011083
{'0': {'precision': 0.4154779989828041, 'recall': 0.3331325445711072, 'f1-score': 0.3697763655782277, 'support': 1125561}, '1': {'precision': 0.246906640023781, 'recall': 0.3868202489484809, 'f1-score': 0.30141844893443465, 'support': 749392}, '2': {'precision': 0.43021981557160144, 'recall': 0.3557935497823981, 'f1-score': 0.3894830345537707, 'support': 1165201}, 'accuracy': 0.3550517506678938, 'macro avg': {'precision': 0.3642014848593955, 'recall': 0.35858211443399535, 'f1-score': 0.35355928302214434, 'support': 3040154}, 'weighted avg': {'precision': 0.37957559127518886, 'recall': 0.3550517506678938, 'f1-score': 0.3604792558026855, 'support': 3040154}}
[[374961 434057 316543]
 [227000 289880 232512]
 [300520 450110 414571]]
Evaluating performance on  train set...
2538/2538 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956275
{'0': {'precision': 0.3872531870101334, 'recall': 0.2843288794754512, 'f1-score': 0.3279041243971395, 'support': 221905}, '1': {'precision': 0.3304255325728316, 'recall': 0.5095540793796882, 'f1-score': 0.4008899160357467, 'support': 209701}, '2': {'precision': 0.39000330651383225, 'recall': 0.2921456026566614, 'f1-score': 0.3340553638299435, 'support': 218018}, 'accuracy': 0.35965573931997585, 'macro avg': {'precision': 0.36922734203226576, 'recall': 0.3620095205039336, 'f1-score': 0.3542831347542766, 'support': 649624}, 'weighted avg': {'precision': 0.36983197041530436, 'recall': 0.35965573931997585, 'f1-score': 0.35352860011088877, 'support': 649624}}
[[ 63094 109220  49591]
 [ 52817 106854  50030]
 [ 47016 107309  63693]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0928998
{'0': {'precision': 0.3906017476246804, 'recall': 0.2989195502993138, 'f1-score': 0.33866538741480845, 'support': 68490}, '1': {'precision': 0.33411396587242975, 'recall': 0.5242429786844753, 'f1-score': 0.40812135743706013, 'support': 65586}, '2': {'precision': 0.40752442319684057, 'recall': 0.2826864294365304, 'f1-score': 0.33381574242759604, 'support': 69356}, 'accuracy': 0.36602894333241576, 'macro avg': {'precision': 0.3774133788979836, 'recall': 0.3686163194734398, 'f1-score': 0.3602008290931549, 'support': 203432}, 'weighted avg': {'precision': 0.3781596609961246, 'recall': 0.36602894333241576, 'f1-score': 0.3594044416056255, 'support': 203432}}
[[20473 33767 14250]
 [16949 34383 14254]
 [14992 34758 19606]]
testing model on single stock: results/universal/W0/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
19053/19053 - 148s - 148s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0832561
{'0': {'precision': 0.3223560686030508, 'recall': 0.36379723687456333, 'f1-score': 0.34182520469214034, 'support': 1353974}, '1': {'precision': 0.4706000521998968, 'recall': 0.41608324581263423, 'f1-score': 0.44166569425143476, 'support': 2201384}, '2': {'precision': 0.31692925030914904, 'recall': 0.3363361591664095, 'f1-score': 0.3263444389686669, 'support': 1322088}, 'accuracy': 0.3799523357101237, 'macro avg': {'precision': 0.3699617903706989, 'recall': 0.3720722139512023, 'f1-score': 0.36994511263741403, 'support': 4877446}, 'weighted avg': {'precision': 0.387793431157513, 'recall': 0.3799523357101237, 'f1-score': 0.38269092041183916, 'support': 4877446}}
[[492572 523242 338160]
 [665206 915959 620219]
 [370259 507163 444666]]
Evaluating performance on  train set...
4812/4812 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964358
{'0': {'precision': 0.35542720739158745, 'recall': 0.4410717180599427, 'f1-score': 0.3936449479089598, 'support': 407122}, '1': {'precision': 0.3462703491576853, 'recall': 0.3244889274794796, 'f1-score': 0.3350259866086111, 'support': 406547}, '2': {'precision': 0.3746000520727862, 'recall': 0.30963323593130526, 'f1-score': 0.33903239826776355, 'support': 418198}, 'accuracy': 0.3579753333760869, 'macro avg': {'precision': 0.3587658695406863, 'recall': 0.35839796049024253, 'f1-score': 0.35590111092844484, 'support': 1231867}, 'weighted avg': {'precision': 0.35891407087244187, 'recall': 0.3579753333760869, 'f1-score': 0.35575918435281145, 'support': 1231867}}
[[179570 123407 104145]
 [162590 131920 112037]
 [163063 125647 129488]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953785
{'0': {'precision': 0.35821555723379006, 'recall': 0.4430729402973124, 'f1-score': 0.3961510010260816, 'support': 149876}, '1': {'precision': 0.35471077717367794, 'recall': 0.31815800536817257, 'f1-score': 0.33544154901004786, 'support': 154615}, '2': {'precision': 0.36321950230443495, 'recall': 0.31512428789867525, 'f1-score': 0.3374668970739006, 'support': 147802}, 'accuracy': 0.3585596062729248, 'macro avg': {'precision': 0.35871527890396765, 'recall': 0.3587850778547201, 'f1-score': 0.3563531490366767, 'support': 452293}, 'weighted avg': {'precision': 0.35865266663043605, 'recall': 0.3585596062729248, 'f1-score': 0.3562206464643278, 'support': 452293}}
[[66406 45250 38220]
 [61988 49192 43435]
 [56986 44240 46576]]
training model: results/universal/W0/deepOF_L2/h500
Epoch 1/50
8838/8838 - 202s - loss: 3.2826 - accuracy500: 0.3675 - val_loss: 3.2935 - val_accuracy500: 0.3466 - 202s/epoch - 23ms/step
Epoch 2/50
8838/8838 - 199s - loss: 3.2692 - accuracy500: 0.3775 - val_loss: 3.3005 - val_accuracy500: 0.3405 - 199s/epoch - 23ms/step
Epoch 3/50
8838/8838 - 201s - loss: 3.2606 - accuracy500: 0.3848 - val_loss: 3.3079 - val_accuracy500: 0.3385 - 201s/epoch - 23ms/step
Epoch 4/50
8838/8838 - 198s - loss: 3.2578 - accuracy500: 0.3868 - val_loss: 3.2998 - val_accuracy500: 0.3366 - 198s/epoch - 22ms/step
Epoch 5/50
8838/8838 - 197s - loss: 3.2563 - accuracy500: 0.3879 - val_loss: 3.3069 - val_accuracy500: 0.3376 - 197s/epoch - 22ms/step
Epoch 6/50
8838/8838 - 197s - loss: 3.2540 - accuracy500: 0.3900 - val_loss: 3.3034 - val_accuracy500: 0.3385 - 197s/epoch - 22ms/step
Epoch 7/50
8838/8838 - 199s - loss: 3.2524 - accuracy500: 0.3917 - val_loss: 3.3035 - val_accuracy500: 0.3387 - 199s/epoch - 23ms/step
Epoch 8/50
8838/8838 - 201s - loss: 3.2506 - accuracy500: 0.3930 - val_loss: 3.3047 - val_accuracy500: 0.3399 - 201s/epoch - 23ms/step
Epoch 9/50
8838/8838 - 197s - loss: 3.2492 - accuracy500: 0.3944 - val_loss: 3.2990 - val_accuracy500: 0.3415 - 197s/epoch - 22ms/step
Epoch 10/50
8838/8838 - 197s - loss: 3.2480 - accuracy500: 0.3954 - val_loss: 3.2992 - val_accuracy500: 0.3417 - 197s/epoch - 22ms/step
Epoch 11/50
8838/8838 - 199s - loss: 3.2468 - accuracy500: 0.3964 - val_loss: 3.2995 - val_accuracy500: 0.3432 - 199s/epoch - 22ms/step
testing model in sample: results/universal/W0/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 254s - 254s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0872239
{'0': {'precision': 0.30226398186706027, 'recall': 0.11110543538427191, 'f1-score': 0.16248503108736048, 'support': 2270879}, '1': {'precision': 0.4712098282070657, 'recall': 0.6851127614210641, 'f1-score': 0.5583768223632297, 'support': 3852071}, '2': {'precision': 0.3073425295393686, 'recall': 0.26605573215411166, 'f1-score': 0.28521272972538264, 'support': 2326054}, 'accuracy': 0.4154655388966558, 'macro avg': {'precision': 0.3602721132044982, 'recall': 0.3540913096531492, 'f1-score': 0.33535819439199094, 'support': 8449004}, 'weighted avg': {'precision': 0.3806879441925787, 'recall': 0.4154655388966558, 'f1-score': 0.3767676308635702, 'support': 8449004}}
[[ 252307 1470488  548084]
 [ 366328 2639103  846640]
 [ 216089 1491105  618860]]
Evaluating performance on  train set...
8838/8838 - 74s - 74s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097403
{'0': {'precision': 0.35413211182710697, 'recall': 0.1339159770625735, 'f1-score': 0.19434129072178127, 'support': 749343}, '1': {'precision': 0.33742704557588554, 'recall': 0.5968938433844837, 'f1-score': 0.43113266218369806, 'support': 743298}, '2': {'precision': 0.36378001861900044, 'recall': 0.3138590505897261, 'f1-score': 0.33698072161215353, 'support': 769425}, 'accuracy': 0.34725335158213777, 'macro avg': {'precision': 0.3517797253406643, 'recall': 0.3482229570122611, 'f1-score': 0.32081822483921096, 'support': 2262066}, 'weighted avg': {'precision': 0.35192461582520085, 'recall': 0.34725335158213777, 'f1-score': 0.3206669138193056, 'support': 2262066}}
[[100349 434566 214428]
 [ 91709 443670 207919]
 [ 91308 436626 241491]]
Evaluating performance on  val set...
3279/3279 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975553
{'0': {'precision': 0.35459214623690705, 'recall': 0.12540808043967203, 'f1-score': 0.1852862474938651, 'support': 279663}, '1': {'precision': 0.34081594690764644, 'recall': 0.608460903939066, 'f1-score': 0.43690769230769233, 'support': 280041}, '2': {'precision': 0.3572229143316653, 'recall': 0.30711036286133897, 'f1-score': 0.33027657234430646, 'support': 279170}, 'accuracy': 0.3471343729809244, 'macro avg': {'precision': 0.3508770024920729, 'recall': 0.34699311574669234, 'f1-score': 0.31749017071528796, 'support': 838874}, 'weighted avg': {'precision': 0.3508687394948316, 'recall': 0.3471343729809244, 'f1-score': 0.31753646625807375, 'support': 838874}}
[[ 35072 167029  77562]
 [ 32938 170394  76709]
 [ 30898 162536  85736]]
testing model out of sample: results/universal/W0/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 181s - 181s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981647
{'0': {'precision': 0.3741357733048173, 'recall': 0.10369033934729371, 'f1-score': 0.1623781717605017, 'support': 2000900}, '1': {'precision': 0.31894707496585467, 'recall': 0.7180704504779478, 'f1-score': 0.44170221655866576, 'support': 1801975}, '2': {'precision': 0.3842594449797744, 'recall': 0.23120513993900682, 'f1-score': 0.28870144904002176, 'support': 2030063}, 'accuracy': 0.33787089799342973, 'macro avg': {'precision': 0.3591140977501488, 'recall': 0.3509886432547494, 'f1-score': 0.29759394578639636, 'support': 5832938}, 'weighted avg': {'precision': 0.36060966289564206, 'recall': 0.33787089799342973, 'f1-score': 0.29263485490526786, 'support': 5832938}}
[[ 207474 1383654  409772]
 [ 165694 1293945  342336]
 [ 181374 1379328  469361]]
Evaluating performance on  train set...
6334/6334 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966638
{'0': {'precision': 0.3551631752777329, 'recall': 0.11450090375855593, 'f1-score': 0.17317272649210502, 'support': 537201}, '1': {'precision': 0.34479230095733604, 'recall': 0.7030559504523864, 'f1-score': 0.4626782142015339, 'support': 544446}, '2': {'precision': 0.3642472003318125, 'recall': 0.22800025962224962, 'f1-score': 0.28045187816853623, 'support': 539245}, 'accuracy': 0.34995175495961484, 'macro avg': {'precision': 0.35473422552229383, 'recall': 0.34851903794439737, 'f1-score': 0.3054342729540584, 'support': 1620892}, 'weighted avg': {'precision': 0.3547017836798006, 'recall': 0.34995175495961484, 'f1-score': 0.3061056121545704, 'support': 1620892}}
[[ 61510 365590 110101]
 [ 57179 382776 104491]
 [ 54499 361798 122948]]
Evaluating performance on  val set...
2156/2156 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0931456
{'0': {'precision': 0.34575713787433354, 'recall': 0.12102344077019674, 'f1-score': 0.1792907434920225, 'support': 172008}, '1': {'precision': 0.3803611561177024, 'recall': 0.7179875492062866, 'f1-score': 0.49728209806313184, 'support': 202718}, '2': {'precision': 0.3578824115136037, 'recall': 0.2197968335938031, 'f1-score': 0.27233597715624747, 'support': 176604}, 'accuracy': 0.3721600493352439, 'macro avg': {'precision': 0.36133356850187986, 'recall': 0.35293594119009547, 'f1-score': 0.3163029395704673, 'support': 551330}, 'weighted avg': {'precision': 0.3623646672960028, 'recall': 0.3721600493352439, 'f1-score': 0.3260172627490608, 'support': 551330}}
[[ 20817 117430  33761]
 [ 21284 145549  35885]
 [ 18106 119681  38817]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973649
{'0': {'precision': 0.3277976275546663, 'recall': 0.1668655239647295, 'f1-score': 0.22115301173453156, 'support': 68726}, '1': {'precision': 0.3706451914195872, 'recall': 0.4482079212890919, 'f1-score': 0.40575313985787564, 'support': 79684}, '2': {'precision': 0.35153977113548696, 'recall': 0.4307499339846845, 'f1-score': 0.38713466946708913, 'support': 75740}, 'accuracy': 0.35604728976132055, 'macro avg': {'precision': 0.3499941967032469, 'recall': 0.34860779307950196, 'f1-score': 0.33801360701983213, 'support': 224150}, 'weighted avg': {'precision': 0.35105212335579816, 'recall': 0.35604728976132055, 'f1-score': 0.34286225717751373, 'support': 224150}}
[[11468 29096 28162]
 [11950 35715 32019]
 [11567 31548 32625]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987175
{'0': {'precision': 0.3520886032679292, 'recall': 0.1868718023150332, 'f1-score': 0.24415682927985585, 'support': 27559}, '1': {'precision': 0.33291333219819513, 'recall': 0.3696169987523158, 'f1-score': 0.35030637474468773, 'support': 26449}, '2': {'precision': 0.3429753175946069, 'recall': 0.4691920490869677, 'f1-score': 0.3962761830876648, 'support': 27217}, 'accuracy': 0.34097876269621424, 'macro avg': {'precision': 0.34265908435357706, 'recall': 0.34189361671810553, 'f1-score': 0.3302464623707361, 'support': 81225}, 'weighted avg': {'precision': 0.34279093579246955, 'recall': 0.34097876269621424, 'f1-score': 0.32969430888079737, 'support': 81225}}
[[ 5150  9886 12523]
 [ 4733  9776 11940]
 [ 4744  9703 12770]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989485
{'0': {'precision': 0.3487494100991034, 'recall': 0.16475309330063537, 'f1-score': 0.22378681202210615, 'support': 8971}, '1': {'precision': 0.33469155690325025, 'recall': 0.411511126645695, 'f1-score': 0.36914715719063546, 'support': 8583}, '2': {'precision': 0.3495129037771321, 'recall': 0.45754558675467055, 'f1-score': 0.3962986289423962, 'support': 8939}, 'accuracy': 0.34348695881931074, 'macro avg': {'precision': 0.3443179569264952, 'recall': 0.3446032689003336, 'f1-score': 0.3297441993850459, 'support': 26493}, 'weighted avg': {'precision': 0.3444526643929883, 'recall': 0.34348695881931074, 'f1-score': 0.3290867393248639, 'support': 26493}}
[[1478 3571 3922]
 [1361 3532 3690]
 [1399 3450 4090]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
2359/2359 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099069
{'0': {'precision': 0.3898380461772227, 'recall': 0.10287228736565186, 'f1-score': 0.16278745860286606, 'support': 204506}, '1': {'precision': 0.27499380770370224, 'recall': 0.686308733780598, 'f1-score': 0.392656096947842, 'support': 165003}, '2': {'precision': 0.4215338912437054, 'recall': 0.2483331483647353, 'f1-score': 0.31254213796271174, 'support': 234274}, 'accuracy': 0.318755248160349, 'macro avg': {'precision': 0.3621219150415434, 'recall': 0.3458380565036617, 'f1-score': 0.28932856450447325, 'support': 603783}, 'weighted avg': {'precision': 0.37075150105465193, 'recall': 0.318755248160349, 'f1-score': 0.2837127623712473, 'support': 603783}}
[[ 21038 139377  44091]
 [ 16014 113243  35746]
 [ 16914 159182  58178]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097946
{'0': {'precision': 0.3832516911593189, 'recall': 0.12427434147079401, 'f1-score': 0.18768830946295215, 'support': 52883}, '1': {'precision': 0.31431505278794103, 'recall': 0.6682209317112459, 'f1-score': 0.42753018869203807, 'support': 47182}, '2': {'precision': 0.37351499293211826, 'recall': 0.2452457591974565, 'f1-score': 0.29608525653251955, 'support': 50639}, 'accuracy': 0.33522003397388256, 'macro avg': {'precision': 0.3570272456264594, 'recall': 0.34591367745983215, 'f1-score': 0.30376791822916993, 'support': 150704}, 'weighted avg': {'precision': 0.3583975059142984, 'recall': 0.33522003397388256, 'f1-score': 0.29920049592411146, 'support': 150704}}
[[ 6572 35597 10714]
 [ 5538 31528 10116]
 [ 5038 33182 12419]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009052
{'0': {'precision': 0.35314574770787227, 'recall': 0.11090701484386635, 'f1-score': 0.16880123918546222, 'support': 20143}, '1': {'precision': 0.27884762731777085, 'recall': 0.6602564102564102, 'f1-score': 0.39209912012928716, 'support': 16536}, '2': {'precision': 0.41532348751780496, 'recall': 0.25022583559168926, 'f1-score': 0.31229741537247385, 'support': 22140}, 'accuracy': 0.31778846971216784, 'macro avg': {'precision': 0.34910562084781604, 'recall': 0.34046308689732196, 'f1-score': 0.29106592489574107, 'support': 58819}, 'weighted avg': {'precision': 0.355662305973419, 'recall': 0.31778846971216784, 'f1-score': 0.2855910367010189, 'support': 58819}}
[[ 2234 13781  4128]
 [ 1947 10918  3671]
 [ 2145 14455  5540]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
1625/1625 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944539
{'0': {'precision': 0.3208597042122903, 'recall': 0.15548915100290148, 'f1-score': 0.20946918399320216, 'support': 126832}, '1': {'precision': 0.38754323857974937, 'recall': 0.619345692757826, 'f1-score': 0.47676208984229007, 'support': 154484}, '2': {'precision': 0.34840972306203893, 'recall': 0.2783988701404891, 'f1-score': 0.30949439525342215, 'support': 134530}, 'accuracy': 0.3675711681728332, 'macro avg': {'precision': 0.3522708886180262, 'recall': 0.3510779046337389, 'f1-score': 0.33190855636297145, 'support': 415846}, 'weighted avg': {'precision': 0.35454487410470054, 'recall': 0.3675711681728332, 'f1-score': 0.3411257802765087, 'support': 415846}}
[[19721 74323 32788]
 [21549 95679 37256]
 [20193 76884 37453]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959466
{'0': {'precision': 0.34340675306561286, 'recall': 0.1591864224137931, 'f1-score': 0.21753455924310197, 'support': 37120}, '1': {'precision': 0.3439630692603222, 'recall': 0.6003604654244745, 'f1-score': 0.43735398042130874, 'support': 37729}, '2': {'precision': 0.3786587625046313, 'recall': 0.30207640582280354, 'f1-score': 0.336059846273994, 'support': 40599}, 'accuracy': 0.3536137481809992, 'macro avg': {'precision': 0.3553428616101888, 'recall': 0.35387443122035706, 'f1-score': 0.3303161286461349, 'support': 115448}, 'weighted avg': {'precision': 0.355985451569917, 'recall': 0.3536137481809992, 'f1-score': 0.3310538499176892, 'support': 115448}}
[[ 5909 20759 10452]
 [ 5406 22651  9672]
 [ 5892 22443 12264]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955346
{'0': {'precision': 0.3575003575003575, 'recall': 0.16498383158450472, 'f1-score': 0.22577440621331166, 'support': 15153}, '1': {'precision': 0.34615240028570354, 'recall': 0.6130084548299048, 'f1-score': 0.44245831531401664, 'support': 15021}, '2': {'precision': 0.35501778124728944, 'recall': 0.27379757843334, 'f1-score': 0.30916232343832617, 'support': 14949}, 'accuracy': 0.35017618509407616, 'macro avg': {'precision': 0.3528901796777835, 'recall': 0.3505966216159165, 'f1-score': 0.3257983483218848, 'support': 45123}, 'weighted avg': {'precision': 0.3529002711202757, 'recall': 0.35017618509407616, 'f1-score': 0.3255322896252841, 'support': 45123}}
[[2500 8783 3870]
 [2247 9208 3566]
 [2246 8610 4093]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042123
{'0': {'precision': 0.31276829744208323, 'recall': 0.2631013489315984, 'f1-score': 0.2857930140205851, 'support': 100524}, '1': {'precision': 0.3715537999513, 'recall': 0.11666312704413201, 'f1-score': 0.1775711810494194, 'support': 117715}, '2': {'precision': 0.33038275510856785, 'recall': 0.6303604956815622, 'f1-score': 0.43353983929338163, 'support': 106520}, 'accuracy': 0.33048198818200575, 'macro avg': {'precision': 0.3382349508339837, 'recall': 0.3367083238857642, 'f1-score': 0.298968011454462, 'support': 324759}, 'weighted avg': {'precision': 0.33985369756496325, 'recall': 0.33048198818200575, 'f1-score': 0.2950265033460773, 'support': 324759}}
[[26448 10515 63561]
 [31452 13733 72530]
 [26661 12713 67146]]
Evaluating performance on  train set...
486/486 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005918
{'0': {'precision': 0.35367672728426797, 'recall': 0.2682909213472326, 'f1-score': 0.3051227993319278, 'support': 41537}, '1': {'precision': 0.33352898019075566, 'recall': 0.1659931840311587, 'f1-score': 0.22166598943518892, 'support': 41080}, '2': {'precision': 0.3414384508990318, 'recall': 0.5928861349280687, 'f1-score': 0.433327189587228, 'support': 41637}, 'accuracy': 0.3432404590596681, 'macro avg': {'precision': 0.34288138612468516, 'recall': 0.3423900801021533, 'f1-score': 0.3200386594514482, 'support': 124254}, 'weighted avg': {'precision': 0.34291462252745075, 'recall': 0.3432404590596681, 'f1-score': 0.3204916441699362, 'support': 124254}}
[[11144  6816 23577]
 [10224  6819 24037]
 [10141  6810 24686]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013093
{'0': {'precision': 0.3222967770322297, 'recall': 0.20245992260917633, 'f1-score': 0.24869498790476594, 'support': 14472}, '1': {'precision': 0.32004957574601967, 'recall': 0.22245046716586045, 'f1-score': 0.262470680218921, 'support': 15091}, '2': {'precision': 0.35340606808280967, 'recall': 0.5745174229130108, 'f1-score': 0.4376178541592075, 'support': 15956}, 'accuracy': 0.3395065796700279, 'macro avg': {'precision': 0.331917473620353, 'recall': 0.3331426042293492, 'f1-score': 0.31626117409429816, 'support': 45519}, 'weighted avg': {'precision': 0.33245665166464383, 'recall': 0.3395065796700279, 'f1-score': 0.3194861350448346, 'support': 45519}}
[[2930 3368 8174]
 [3136 3357 8598]
 [3025 3764 9167]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
1733/1733 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963509
{'0': {'precision': 0.3418394400551461, 'recall': 0.17915974793827683, 'f1-score': 0.2351015868240271, 'support': 143933}, '1': {'precision': 0.3471317348461345, 'recall': 0.48390883503809984, 'f1-score': 0.40426453172448007, 'support': 145670}, '2': {'precision': 0.3739969940122664, 'recall': 0.4009707350036386, 'f1-score': 0.38701443676546216, 'support': 153904}, 'accuracy': 0.35622662100034497, 'macro avg': {'precision': 0.3543227229711823, 'recall': 0.3546797726600051, 'f1-score': 0.3421268517713231, 'support': 443507}, 'weighted avg': {'precision': 0.3547368797041706, 'recall': 0.35622662100034497, 'f1-score': 0.34337938501218557, 'support': 443507}}
[[25787 66307 51839]
 [23725 70491 51454]
 [25924 66269 61711]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0948114
{'0': {'precision': 0.3302659737083461, 'recall': 0.17539900310110243, 'f1-score': 0.22911740066383177, 'support': 61591}, '1': {'precision': 0.3671302039128637, 'recall': 0.5088221987633841, 'f1-score': 0.4265163198745987, 'support': 66310}, '2': {'precision': 0.3728356195187767, 'recall': 0.3909052060769492, 'f1-score': 0.38165665575657304, 'support': 67863}, 'accuracy': 0.3630442778038863, 'macro avg': {'precision': 0.3567439323799955, 'recall': 0.3583754693138119, 'f1-score': 0.3457634587650012, 'support': 195764}, 'weighted avg': {'precision': 0.3575098539850814, 'recall': 0.3630442778038863, 'f1-score': 0.3488600183117377, 'support': 195764}}
[[10803 28115 22673]
 [10619 33740 21951]
 [11288 30047 26528]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956032
{'0': {'precision': 0.3344424460431655, 'recall': 0.17961844964984303, 'f1-score': 0.23371563236449333, 'support': 20705}, '1': {'precision': 0.37653151018750425, 'recall': 0.49404920508038014, 'f1-score': 0.4273586355255071, 'support': 22518}, '2': {'precision': 0.3539830367537003, 'recall': 0.3960921144452198, 'f1-score': 0.3738555777548466, 'support': 21495}, 'accuracy': 0.36091968231403937, 'macro avg': {'precision': 0.35498566432812334, 'recall': 0.3565865897251477, 'f1-score': 0.344976615214949, 'support': 64718}, 'weighted avg': {'precision': 0.35557700742833137, 'recall': 0.36091968231403937, 'f1-score': 0.34763697219800727, 'support': 64718}}
[[ 3719  9078  7908]
 [ 3763 11125  7630]
 [ 3638  9343  8514]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/EXC
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0670017
{'0': {'precision': 0.23947158183063227, 'recall': 0.11253435830968289, 'f1-score': 0.15311548881233486, 'support': 223745}, '1': {'precision': 0.628214878318584, 'recall': 0.7341103663347939, 'f1-score': 0.6770469185231365, 'support': 742654}, '2': {'precision': 0.23651310456041333, 'recall': 0.2298797212804743, 'f1-score': 0.23314924048199642, 'support': 234788}, 'accuracy': 0.5197708599909923, 'macro avg': {'precision': 0.36806652156987657, 'recall': 0.3588414819749837, 'f1-score': 0.35443721593915595, 'support': 1201187}, 'weighted avg': {'precision': 0.4792403681633542, 'recall': 0.5197708599909923, 'f1-score': 0.492688541540563, 'support': 1201187}}
[[ 25179 160732  37834]
 [ 61068 545190 136396]
 [ 18897 161918  53973]]
Evaluating performance on  train set...
1497/1497 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956596
{'0': {'precision': 0.3621510883482714, 'recall': 0.11224878559862844, 'f1-score': 0.17137871278129885, 'support': 125988}, '1': {'precision': 0.3312880924562983, 'recall': 0.7050490172787888, 'f1-score': 0.4507690438339797, 'support': 126282}, '2': {'precision': 0.3828307496283712, 'recall': 0.2203884533687862, 'f1-score': 0.27973737040664914, 'support': 130878}, 'accuracy': 0.34456920041341726, 'macro avg': {'precision': 0.35875664347764696, 'recall': 0.3458954187487344, 'f1-score': 0.3006283756739759, 'support': 383148}, 'weighted avg': {'precision': 0.3590428165102004, 'recall': 0.34456920041341726, 'f1-score': 0.3004769572682471, 'support': 383148}}
[[14142 89328 22518]
 [13265 89035 23982]
 [11643 90391 28844]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0914447
{'0': {'precision': 0.36604237471979173, 'recall': 0.11312995865459828, 'f1-score': 0.17284119233789738, 'support': 44745}, '1': {'precision': 0.36524652003497154, 'recall': 0.7305002161185116, 'f1-score': 0.4869969547136448, 'support': 50898}, '2': {'precision': 0.36729045317470155, 'recall': 0.20119936637248245, 'f1-score': 0.25998216296036375, 'support': 44190}, 'accuracy': 0.36567906002159717, 'macro avg': {'precision': 0.36619311597648824, 'recall': 0.34827651371519747, 'f1-score': 0.3066067700039687, 'support': 139833}, 'weighted avg': {'precision': 0.36614710804579126, 'recall': 0.36567906002159717, 'f1-score': 0.31472944107179845, 'support': 139833}}
[[ 5062 32921  6762]
 [ 5163 37181  8554]
 [ 3604 31695  8891]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/AAL
Evaluating performance on  test set...
6677/6677 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0818775
{'0': {'precision': 0.33909841033052074, 'recall': 0.07684766118569793, 'f1-score': 0.12529951130779, 'support': 473274}, '1': {'precision': 0.47247420999330575, 'recall': 0.8246289849247235, 'f1-score': 0.6007477735254708, 'support': 801113}, '2': {'precision': 0.2983857514351602, 'recall': 0.13983637392100143, 'f1-score': 0.19042936947318317, 'support': 434894}, 'accuracy': 0.4433472319647852, 'macro avg': {'precision': 0.36998612391966224, 'recall': 0.3471043400104743, 'f1-score': 0.305492218102148, 'support': 1709281}, 'weighted avg': {'precision': 0.3912509796960105, 'recall': 0.4433472319647852, 'f1-score': 0.3647056523852217, 'support': 1709281}}
[[ 36370 385651  51253]
 [ 48749 660621  91743]
 [ 22136 351944  60814]]
Evaluating performance on  train set...
2262/2262 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959188
{'0': {'precision': 0.3708515389843674, 'recall': 0.0989748533283579, 'f1-score': 0.15624910510834839, 'support': 192948}, '1': {'precision': 0.3485806093670535, 'recall': 0.7667848116714382, 'f1-score': 0.47928026432264137, 'support': 196651}, '2': {'precision': 0.3691270209802018, 'recall': 0.184836602688763, 'f1-score': 0.24632730960463117, 'support': 189232}, 'accuracy': 0.35392541173503145, 'macro avg': {'precision': 0.36285305644387417, 'recall': 0.3501987558961863, 'f1-score': 0.293952226345207, 'support': 578831}, 'weighted avg': {'precision': 0.36272147239992625, 'recall': 0.35392541173503145, 'f1-score': 0.29544358377982677, 'support': 578831}}
[[ 19097 142888  30963]
 [ 17046 150789  28816]
 [ 15352 138903  34977]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860144
{'0': {'precision': 0.31381040401373117, 'recall': 0.10153620068009775, 'f1-score': 0.15342904358603596, 'support': 58521}, '1': {'precision': 0.44108731668405227, 'recall': 0.7878389338243352, 'f1-score': 0.5655437194152911, 'support': 91242}, '2': {'precision': 0.34583094507569373, 'recall': 0.16596818821701914, 'f1-score': 0.22429477367155043, 'support': 61801}, 'accuracy': 0.4163420997901344, 'macro avg': {'precision': 0.3669095552578257, 'recall': 0.35178110757381736, 'f1-score': 0.3144225122242925, 'support': 211564}, 'weighted avg': {'precision': 0.37805527329222743, 'recall': 0.4163420997901344, 'f1-score': 0.3518642227139962, 'support': 211564}}
[[ 5942 44679  7900]
 [ 7856 71884 11502]
 [ 5137 46407 10257]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/WBA
Evaluating performance on  test set...
5633/5633 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860449
{'0': {'precision': 0.3138020047098605, 'recall': 0.10867349072583175, 'f1-score': 0.16143875617408593, 'support': 382568}, '1': {'precision': 0.45876747227995535, 'recall': 0.7335910595172402, 'f1-score': 0.5645075823873769, 'support': 639697}, '2': {'precision': 0.3314155043901758, 'recall': 0.2262563041633696, 'f1-score': 0.2689210607947037, 'support': 419564}, 'accuracy': 0.42014691062532383, 'macro avg': {'precision': 0.3679949937933306, 'recall': 0.3561736181354805, 'f1-score': 0.3316224664520555, 'support': 1441829}, 'weighted avg': {'precision': 0.38324433461726193, 'recall': 0.42014691062532383, 'f1-score': 0.37154524215682616, 'support': 1441829}}
[[ 41575 266044  74949]
 [ 53864 469276 116557]
 [ 37049 287586  94929]]
Evaluating performance on  train set...
1454/1454 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958445
{'0': {'precision': 0.36941042438051835, 'recall': 0.13722521994612236, 'f1-score': 0.2001139371209514, 'support': 122871}, '1': {'precision': 0.3460253191414124, 'recall': 0.6377196483996318, 'f1-score': 0.4486267318079574, 'support': 122753}, '2': {'precision': 0.37175956415015265, 'recall': 0.2945939321098451, 'f1-score': 0.3287087481858245, 'support': 126469}, 'accuracy': 0.35582502223906387, 'macro avg': {'precision': 0.3623984358906944, 'recall': 0.35651293348519975, 'f1-score': 0.3258164723715778, 'support': 372093}, 'weighted avg': {'precision': 0.3624941468211714, 'recall': 0.35582502223906387, 'f1-score': 0.3258054933898882, 'support': 372093}}
[[16861 73575 32435]
 [13945 78282 30526]
 [14837 74375 37257]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985714
{'0': {'precision': 0.37739190038270404, 'recall': 0.13259879181969614, 'f1-score': 0.19624558172691356, 'support': 49827}, '1': {'precision': 0.3136834822972807, 'recall': 0.6567610503691244, 'f1-score': 0.42457881183782276, 'support': 42804}, '2': {'precision': 0.3790386577485546, 'recall': 0.2686675103959501, 'f1-score': 0.3144492905258456, 'support': 49779}, 'accuracy': 0.3377080261217611, 'macro avg': {'precision': 0.35670468014284645, 'recall': 0.3526757841949235, 'f1-score': 0.3117578946968606, 'support': 142410}, 'weighted avg': {'precision': 0.35881875809765534, 'recall': 0.3377080261217611, 'f1-score': 0.3061931837349846, 'support': 142410}}
[[ 6607 30828 12392]
 [ 5174 28112  9518]
 [ 5726 30679 13374]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
11876/11876 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081368
{'0': {'precision': 0.41488511380117254, 'recall': 0.09654795120083155, 'f1-score': 0.15664340247954084, 'support': 1188135}, '1': {'precision': 0.20415394638163128, 'recall': 0.6943306538877725, 'f1-score': 0.3155320481673799, 'support': 621024}, '2': {'precision': 0.4239146283253345, 'recall': 0.22437296658394226, 'f1-score': 0.29343452962105576, 'support': 1230995}, 'accuracy': 0.27041722228545, 'macro avg': {'precision': 0.34765122950271277, 'recall': 0.33841719055751546, 'f1-score': 0.25520332675599217, 'support': 3040154}, 'weighted avg': {'precision': 0.37549440356613756, 'recall': 0.27041722228545, 'f1-score': 0.24448857606456767, 'support': 3040154}}
[[114712 828075 245348]
 [ 59827 431196 130001]
 [101952 852841 276202]]
Evaluating performance on  train set...
2538/2538 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978332
{'0': {'precision': 0.3621117795187465, 'recall': 0.09499364629351831, 'f1-score': 0.1505049660751471, 'support': 217983}, '1': {'precision': 0.3381869393503352, 'recall': 0.7624834910978477, 'f1-score': 0.4685543483793613, 'support': 217307}, '2': {'precision': 0.3594028977023269, 'recall': 0.17186727257457987, 'f1-score': 0.2325355317852848, 'support': 214334}, 'accuracy': 0.3436403211704001, 'macro avg': {'precision': 0.35323387219046953, 'recall': 0.34311480332198196, 'f1-score': 0.2838649487465977, 'support': 649624}, 'weighted avg': {'precision': 0.3532148780531027, 'recall': 0.3436403211704001, 'f1-score': 0.2839610828308374, 'support': 649624}}
[[ 20707 163951  33325]
 [ 19281 165693  32333]
 [ 17196 160301  36837]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984162
{'0': {'precision': 0.37651648762759876, 'recall': 0.10261003816015614, 'f1-score': 0.161270015680619, 'support': 68658}, '1': {'precision': 0.3251834856405376, 'recall': 0.7633656700431496, 'f1-score': 0.4560821311685225, 'support': 65354}, '2': {'precision': 0.3707631856371594, 'recall': 0.16718524920772113, 'f1-score': 0.23045381888942942, 'support': 69420}, 'accuracy': 0.33691847890204096, 'macro avg': {'precision': 0.35748771963509857, 'recall': 0.3443869858036756, 'f1-score': 0.2826019885795236, 'support': 203432}, 'weighted avg': {'precision': 0.358062108591662, 'recall': 0.33691847890204096, 'f1-score': 0.2795891130416638, 'support': 203432}}
[[ 7045 51401 10212]
 [ 5980 49889  9485]
 [ 5686 52128 11606]]
testing model on single stock: results/universal/W0/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
19053/19053 - 152s - 152s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0899405
{'0': {'precision': 0.3017239872776205, 'recall': 0.10159495592613951, 'f1-score': 0.1520069201105809, 'support': 1359536}, '1': {'precision': 0.45939983308093185, 'recall': 0.6853514537252366, 'f1-score': 0.5500764175973515, 'support': 2187002}, '2': {'precision': 0.297683427383145, 'recall': 0.2587879853453432, 'f1-score': 0.2768763774061776, 'support': 1330908}, 'accuracy': 0.40623924898399694, 'macro avg': {'precision': 0.3529357492472325, 'recall': 0.3485781316655731, 'f1-score': 0.3263199050380367, 'support': 4877446}, 'weighted avg': {'precision': 0.3713218416947677, 'recall': 0.40623924898399694, 'f1-score': 0.3645707387182969, 'support': 4877446}}
[[ 138122  893535  327879]
 [ 203428 1498865  484709]
 [ 116226  870259  344423]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980443
{'0': {'precision': 0.3440400430945068, 'recall': 0.12661304621931518, 'f1-score': 0.1851043108678081, 'support': 406064}, '1': {'precision': 0.3401126551152285, 'recall': 0.5859640739801133, 'f1-score': 0.4304045026554052, 'support': 406001}, '2': {'precision': 0.3614302725174175, 'recall': 0.32970066841034584, 'f1-score': 0.3448371223917783, 'support': 419802}, 'accuracy': 0.34721605497996133, 'macro avg': {'precision': 0.3485276569090509, 'recall': 0.3474259295365914, 'f1-score': 0.3201153119716638, 'support': 1231867}, 'weighted avg': {'precision': 0.348671979533442, 'recall': 0.34721605497996133, 'f1-score': 0.32038537360375435, 'support': 1231867}}
[[ 51413 229618 125033]
 [ 48593 237902 119506]
 [ 49433 231960 138409]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984088
{'0': {'precision': 0.3478954449356141, 'recall': 0.12029160796406071, 'f1-score': 0.1787700117527382, 'support': 150476}, '1': {'precision': 0.35029034389234676, 'recall': 0.5860308185531827, 'f1-score': 0.4384840270540186, 'support': 154712}, '2': {'precision': 0.34449770914644495, 'recall': 0.3312123993066177, 'f1-score': 0.3377244512835442, 'support': 147105}, 'accuracy': 0.34820348756226605, 'macro avg': {'precision': 0.3475611659914686, 'recall': 0.34584494194128707, 'f1-score': 0.3183261633634337, 'support': 452293}, 'weighted avg': {'precision': 0.34760955876034344, 'recall': 0.34820348756226605, 'f1-score': 0.31930693706989083, 'support': 452293}}
[[18101 86171 46204]
 [17541 90666 46505]
 [16388 81994 48723]]
training model: results/universal/W0/deepOF_L2/h1000
Epoch 1/50
8838/8838 - 201s - loss: 3.2798 - accuracy1000: 0.3690 - val_loss: 3.2961 - val_accuracy1000: 0.3444 - 201s/epoch - 23ms/step
Epoch 2/50
8838/8838 - 197s - loss: 3.2650 - accuracy1000: 0.3780 - val_loss: 3.2979 - val_accuracy1000: 0.3415 - 197s/epoch - 22ms/step
Epoch 3/50
8838/8838 - 198s - loss: 3.2587 - accuracy1000: 0.3836 - val_loss: 3.3020 - val_accuracy1000: 0.3397 - 198s/epoch - 22ms/step
Epoch 4/50
8838/8838 - 198s - loss: 3.2562 - accuracy1000: 0.3854 - val_loss: 3.3045 - val_accuracy1000: 0.3390 - 198s/epoch - 22ms/step
Epoch 5/50
8838/8838 - 196s - loss: 3.2545 - accuracy1000: 0.3867 - val_loss: 3.3052 - val_accuracy1000: 0.3388 - 196s/epoch - 22ms/step
Epoch 6/50
8838/8838 - 199s - loss: 3.2530 - accuracy1000: 0.3881 - val_loss: 3.3058 - val_accuracy1000: 0.3394 - 199s/epoch - 22ms/step
Epoch 7/50
8838/8838 - 197s - loss: 3.2513 - accuracy1000: 0.3897 - val_loss: 3.3064 - val_accuracy1000: 0.3393 - 197s/epoch - 22ms/step
Epoch 8/50
8838/8838 - 198s - loss: 3.2495 - accuracy1000: 0.3912 - val_loss: 3.3054 - val_accuracy1000: 0.3396 - 198s/epoch - 22ms/step
Epoch 9/50
8838/8838 - 197s - loss: 3.2482 - accuracy1000: 0.3929 - val_loss: 3.3035 - val_accuracy1000: 0.3408 - 197s/epoch - 22ms/step
Epoch 10/50
8838/8838 - 197s - loss: 3.2469 - accuracy1000: 0.3941 - val_loss: 3.3051 - val_accuracy1000: 0.3417 - 197s/epoch - 22ms/step
Epoch 11/50
8838/8838 - 196s - loss: 3.2461 - accuracy1000: 0.3950 - val_loss: 3.3064 - val_accuracy1000: 0.3421 - 196s/epoch - 22ms/step
testing model in sample: results/universal/W0/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 249s - 249s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964059
{'0': {'precision': 0.277153357508168, 'recall': 0.3964267199570041, 'f1-score': 0.32622994686987283, 'support': 2258821}, '1': {'precision': 0.4802595033765213, 'recall': 0.5119723812847459, 'f1-score': 0.4956091522139436, 'support': 3894171}, '2': {'precision': 0.2905945169678529, 'recall': 0.13501715147830237, 'f1-score': 0.1843710914198134, 'support': 2296012}, 'accuracy': 0.3786441573468305, 'macro avg': {'precision': 0.3493357926175141, 'recall': 0.34780541757335076, 'f1-score': 0.3354033968345433, 'support': 8449004}, 'weighted avg': {'precision': 0.374418209859482, 'recall': 0.3786441573468305, 'f1-score': 0.36574726216932396, 'support': 8449004}}
[[ 895457 1062971  300393]
 [1444075 1993708  456388]
 [ 891376 1094635  310001]]
Evaluating performance on  train set...
8838/8838 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981973
{'0': {'precision': 0.3356644055965735, 'recall': 0.44948945088350106, 'f1-score': 0.3843262262740208, 'support': 746745}, '1': {'precision': 0.34762147299951685, 'recall': 0.42622777632907416, 'f1-score': 0.38293227671765123, 'support': 747795}, '2': {'precision': 0.35271113480066973, 'recall': 0.15863697125569687, 'f1-score': 0.2188451486970807, 'support': 767526}, 'accuracy': 0.34311244676326863, 'macro avg': {'precision': 0.3453323377989201, 'recall': 0.34478473282275734, 'f1-score': 0.3287012172295843, 'support': 2262066}, 'weighted avg': {'precision': 0.3454011874135882, 'recall': 0.34311244676326863, 'f1-score': 0.3277171715175178, 'support': 2262066}}
[[335654 295186 115905]
 [321521 318731 107543]
 [342794 302974 121758]]
Evaluating performance on  val set...
3279/3279 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984616
{'0': {'precision': 0.3392157187954378, 'recall': 0.43828776541600445, 'f1-score': 0.38243969938121647, 'support': 279985}, '1': {'precision': 0.3499146833311173, 'recall': 0.446102666968019, 'f1-score': 0.39219716350810957, 'support': 283168}, '2': {'precision': 0.34113067144382814, 'recall': 0.1436524602768741, 'f1-score': 0.2021698240814233, 'support': 275721}, 'accuracy': 0.34408504733726397, 'macro avg': {'precision': 0.3434203578567945, 'recall': 0.3426809642202992, 'f1-score': 0.3256022289902498, 'support': 838874}, 'weighted avg': {'precision': 0.3434566382288761, 'recall': 0.34408504733726397, 'f1-score': 0.32648232236673014, 'support': 838874}}
[[122714 118247  39024]
 [119370 126322  37476]
 [119674 116439  39608]]
testing model out of sample: results/universal/W0/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 174s - 174s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965278
{'0': {'precision': 0.3424732763271385, 'recall': 0.3852523227376247, 'f1-score': 0.3626054253145841, 'support': 1926283}, '1': {'precision': 0.36111127612793953, 'recall': 0.5586230945094711, 'f1-score': 0.43865947598120225, 'support': 1958682}, '2': {'precision': 0.3651455478779017, 'recall': 0.11922598516509213, 'f1-score': 0.1797580357412371, 'support': 1947973}, 'accuracy': 0.35462729074096105, 'macro avg': {'precision': 0.3562433667776599, 'recall': 0.35436713413739596, 'f1-score': 0.32700764567900786, 'support': 5832938}, 'weighted avg': {'precision': 0.35630350863123417, 'recall': 0.35462729074096105, 'f1-score': 0.3270802615049279, 'support': 5832938}}
[[ 742105  967483  216695]
 [ 677416 1094165  187101]
 [ 747378  968346  232249]]
Evaluating performance on  train set...
6334/6334 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972352
{'0': {'precision': 0.33907897768104284, 'recall': 0.3684769043366489, 'f1-score': 0.35316722027737246, 'support': 535252}, '1': {'precision': 0.35632935708241703, 'recall': 0.5513143811550363, 'f1-score': 0.43287799102486735, 'support': 548433}, '2': {'precision': 0.3577316776439988, 'recall': 0.12698643167345175, 'f1-score': 0.18743706235583588, 'support': 537207}, 'accuracy': 0.35030403012662165, 'macro avg': {'precision': 0.3510466708024862, 'recall': 0.3489259057217123, 'f1-score': 0.32449409121935857, 'support': 1620892}, 'weighted avg': {'precision': 0.35109769226241744, 'recall': 0.35030403012662165, 'f1-score': 0.3252101547768986, 'support': 1620892}}
[[197228 273246  64778]
 [188374 302359  57700]
 [196056 272933  68218]]
Evaluating performance on  val set...
2156/2156 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097288
{'0': {'precision': 0.3336221134652603, 'recall': 0.3690123954901038, 'f1-score': 0.3504259859406014, 'support': 178452}, '1': {'precision': 0.3586773936875608, 'recall': 0.5588243085024661, 'f1-score': 0.4369204896829818, 'support': 188757}, '2': {'precision': 0.35469914135845776, 'recall': 0.1153209031017646, 'f1-score': 0.1740531102576819, 'support': 184121}, 'accuracy': 0.3492753886057352, 'macro avg': {'precision': 0.3489995495037596, 'recall': 0.34771920236477816, 'f1-score': 0.3204665286270884, 'support': 551330}, 'weighted avg': {'precision': 0.3492390452151092, 'recall': 0.3492753886057352, 'f1-score': 0.321137706324556, 'support': 551330}}
[[ 65851  92297  20304]
 [ 64950 105482  18325]
 [ 66581  96307  21233]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004848
{'0': {'precision': 0.3089346096260283, 'recall': 0.5315118449805357, 'f1-score': 0.39075042423146283, 'support': 69101}, '1': {'precision': 0.3663131350589631, 'recall': 0.25403765044748483, 'f1-score': 0.30001518602885346, 'support': 77768}, '2': {'precision': 0.3510285981454064, 'recall': 0.23316209676375824, 'f1-score': 0.28020495595313066, 'support': 77281}, 'accuracy': 0.33238010260985945, 'macro avg': {'precision': 0.34209211427679925, 'recall': 0.33957053073059296, 'f1-score': 0.32365685540448236, 'support': 224150}, 'weighted avg': {'precision': 0.3433547688615159, 'recall': 0.33238010260985945, 'f1-score': 0.3211570165198486, 'support': 224150}}
[[36728 16455 15918]
 [40617 19756 17395]
 [41541 17721 18019]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006683
{'0': {'precision': 0.33652414379919166, 'recall': 0.5826673050716364, 'f1-score': 0.4266393387359933, 'support': 27151}, '1': {'precision': 0.34531166552224, 'recall': 0.16510414766716522, 'f1-score': 0.22339585389930902, 'support': 27413}, '2': {'precision': 0.3333333333333333, 'recall': 0.26390608004200894, 'f1-score': 0.2945843538696644, 'support': 26661}, 'accuracy': 0.33711295783317946, 'macro avg': {'precision': 0.338389714218255, 'recall': 0.3372258442602702, 'f1-score': 0.3148731821683222, 'support': 81225}, 'weighted avg': {'precision': 0.3384425449707974, 'recall': 0.33711295783317946, 'f1-score': 0.3147005070788776, 'support': 81225}}
[[15820  4306  7025]
 [15840  4526  7047]
 [15350  4275  7036]]
Evaluating performance on  val set...
104/104 - 1s - 999ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978012
{'0': {'precision': 0.33566708107047044, 'recall': 0.5698100633122293, 'f1-score': 0.42246561805155236, 'support': 9003}, '1': {'precision': 0.31799075241698194, 'recall': 0.18718297661759248, 'f1-score': 0.23565142901643177, 'support': 8083}, '2': {'precision': 0.34733415995040295, 'recall': 0.23822685234399915, 'f1-score': 0.28261554953023516, 'support': 9407}, 'accuracy': 0.33533386177480845, 'macro avg': {'precision': 0.3336639978126184, 'recall': 0.33173996409127365, 'f1-score': 0.31357753219940643, 'support': 26493}, 'weighted avg': {'precision': 0.3344167299028933, 'recall': 0.33533386177480845, 'f1-score': 0.3158114571580744, 'support': 26493}}
[[5130 1629 2244]
 [4603 1513 1967]
 [5550 1616 2241]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
2359/2359 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977786
{'0': {'precision': 0.30752436190364596, 'recall': 0.43110726624653006, 'f1-score': 0.3589772815348071, 'support': 182639}, '1': {'precision': 0.38393760462078985, 'recall': 0.46072614254432437, 'f1-score': 0.41884144346985014, 'support': 226512}, '2': {'precision': 0.3416564603005281, 'recall': 0.13329257264992395, 'f1-score': 0.1917690758228152, 'support': 194632}, 'accuracy': 0.34621710117707855, 'macro avg': {'precision': 0.3443728089416546, 'recall': 0.34170866048025944, 'f1-score': 0.3231959336091575, 'support': 603783}, 'weighted avg': {'precision': 0.34719377129332346, 'recall': 0.34621710117707855, 'f1-score': 0.3275353289692232, 'support': 603783}}
[[ 78737  81002  22900]
 [ 95062 104360  27090]
 [ 82236  86453  25943]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973964
{'0': {'precision': 0.34995706144117417, 'recall': 0.4344615026750407, 'f1-score': 0.38765750261603515, 'support': 51588}, '1': {'precision': 0.34523860751323204, 'recall': 0.47558734612420717, 'f1-score': 0.400063161743929, 'support': 50609}, '2': {'precision': 0.33945224884901426, 'recall': 0.11856020780505906, 'f1-score': 0.17573988907393545, 'support': 48507}, 'accuracy': 0.3465933220087058, 'macro avg': {'precision': 0.3448826392678068, 'recall': 0.342869685534769, 'f1-score': 0.32115351781129986, 'support': 150704}, 'weighted avg': {'precision': 0.3449913460039785, 'recall': 0.3465933220087058, 'f1-score': 0.3236137501125645, 'support': 150704}}
[[22413 23362  5813]
 [21162 24069  5378]
 [20470 22286  5751]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983887
{'0': {'precision': 0.3410772601380679, 'recall': 0.4186412298949718, 'f1-score': 0.3758997722095672, 'support': 19709}, '1': {'precision': 0.3257510729613734, 'recall': 0.49632172633643945, 'f1-score': 0.3933406750016195, 'support': 18351}, '2': {'precision': 0.3749250149970006, 'recall': 0.12042969314514186, 'f1-score': 0.18230211105844604, 'support': 20759}, 'accuracy': 0.33762899743280234, 'macro avg': {'precision': 0.34725111603214726, 'recall': 0.3451308831255177, 'f1-score': 0.31718085275654423, 'support': 58819}, 'weighted avg': {'precision': 0.34824152138421394, 'recall': 0.33762899743280234, 'f1-score': 0.31301472076872033, 'support': 58819}}
[[8251 9198 2260]
 [7335 9108 1908]
 [8605 9654 2500]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
1625/1625 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096501
{'0': {'precision': 0.2858456327123155, 'recall': 0.4111934843896836, 'f1-score': 0.33724896875579846, 'support': 114924}, '1': {'precision': 0.45133893751624926, 'recall': 0.4971586442353047, 'f1-score': 0.47314206927510444, 'support': 178084}, '2': {'precision': 0.3163548737192576, 'recall': 0.14000553574626745, 'f1-score': 0.19410725673105683, 'support': 122838}, 'accuracy': 0.3679006170553522, 'macro avg': {'precision': 0.3511798146492741, 'recall': 0.3494525547904186, 'f1-score': 0.3348327649206533, 'support': 415846}, 'weighted avg': {'precision': 0.3657295412734523, 'recall': 0.3679006170553522, 'f1-score': 0.3531614586948261, 'support': 415846}}
[[47256 52016 15652]
 [68035 88536 21513]
 [50029 55611 17198]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979127
{'0': {'precision': 0.32892211738365584, 'recall': 0.4389606231992317, 'f1-score': 0.3760570462129177, 'support': 37484}, '1': {'precision': 0.33384559388522667, 'recall': 0.4524155317458143, 'f1-score': 0.3841902567861589, 'support': 36493}, '2': {'precision': 0.37482780212899186, 'recall': 0.1443418292300644, 'f1-score': 0.2084225553176303, 'support': 41471}, 'accuracy': 0.3373813318550343, 'macro avg': {'precision': 0.3458651711326248, 'recall': 0.3452393280583701, 'f1-score': 0.32288995277223564, 'support': 115448}, 'weighted avg': {'precision': 0.34696857189170843, 'recall': 0.3373813318550343, 'f1-score': 0.318410619090151, 'support': 115448}}
[[16454 15747  5283]
 [15282 16510  4701]
 [18288 17197  5986]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977254
{'0': {'precision': 0.35061971684903803, 'recall': 0.43582801521304715, 'f1-score': 0.38860788596390394, 'support': 15513}, '1': {'precision': 0.3353198251887167, 'recall': 0.4600708639956391, 'f1-score': 0.3879122141790187, 'support': 14676}, '2': {'precision': 0.3467741935483871, 'recall': 0.13244944422124014, 'f1-score': 0.19168524081790872, 'support': 14934}, 'accuracy': 0.34330607450745737, 'macro avg': {'precision': 0.34423791186204733, 'recall': 0.3427827744766421, 'f1-score': 0.32273511365361046, 'support': 45123}, 'weighted avg': {'precision': 0.3443707915785818, 'recall': 0.34330607450745737, 'f1-score': 0.3232077028704645, 'support': 45123}}
[[6761 6779 1973]
 [6171 6752 1753]
 [6351 6605 1978]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1109291
{'0': {'precision': 0.2989741608721779, 'recall': 0.5737171567416193, 'f1-score': 0.39309799937921497, 'support': 97128}, '1': {'precision': 0.3878588750684503, 'recall': 0.039537164775400514, 'f1-score': 0.0717593932727378, 'support': 125401}, '2': {'precision': 0.31330021020447163, 'recall': 0.38489680133033355, 'f1-score': 0.3454275706472597, 'support': 102230}, 'accuracy': 0.308013018884773, 'macro avg': {'precision': 0.3333777487150333, 'recall': 0.33271704094911775, 'f1-score': 0.2700949877664041, 'support': 324759}, 'weighted avg': {'precision': 0.33780536822337415, 'recall': 0.308013018884773, 'f1-score': 0.2540116908438822, 'support': 324759}}
[[55724  3263 38141]
 [72340  4958 48103]
 [58320  4562 39348]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101993
{'0': {'precision': 0.3337230735370987, 'recall': 0.5834215082724125, 'f1-score': 0.42458129889221397, 'support': 41584}, '1': {'precision': 0.32799433026222535, 'recall': 0.05634420122233315, 'f1-score': 0.09616823206715984, 'support': 41069}, '2': {'precision': 0.33385766611986245, 'recall': 0.3571308382010048, 'f1-score': 0.34510232050358874, 'support': 41601}, 'accuracy': 0.3334460057623899, 'macro avg': {'precision': 0.33185835663972885, 'recall': 0.3322988492319168, 'f1-score': 0.2886172838209875, 'support': 124254}, 'weighted avg': {'precision': 0.3318746455466902, 'recall': 0.3334460057623899, 'f1-score': 0.28942266237843295, 'support': 124254}}
[[24261  2254 15069]
 [24180  2314 14575]
 [24257  2487 14857]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032038
{'0': {'precision': 0.3069540929599656, 'recall': 0.6097161960310121, 'f1-score': 0.4083363105871145, 'support': 14059}, '1': {'precision': 0.3414481897627965, 'recall': 0.0706125346930872, 'f1-score': 0.11702412151682089, 'support': 15493}, '2': {'precision': 0.34957259017304887, 'recall': 0.3150247385232041, 'f1-score': 0.33140071155619977, 'support': 15967}, 'accuracy': 0.32285419275467386, 'macro avg': {'precision': 0.33265829096527033, 'recall': 0.33178448974910113, 'f1-score': 0.2855870478867117, 'support': 45519}, 'weighted avg': {'precision': 0.33364419130939243, 'recall': 0.32285419275467386, 'f1-score': 0.28219710596942355, 'support': 45519}}
[[8572  970 4517]
 [9557 1094 4842]
 [9797 1140 5030]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
1733/1733 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975853
{'0': {'precision': 0.3192146331760068, 'recall': 0.5023049014725759, 'f1-score': 0.39035730278688435, 'support': 140570}, '1': {'precision': 0.35439647258882484, 'recall': 0.3222495894909688, 'f1-score': 0.3375593954031721, 'support': 146160}, '2': {'precision': 0.37611426142782045, 'recall': 0.21449574873865426, 'f1-score': 0.2731918143192545, 'support': 156777}, 'accuracy': 0.3412279851276305, 'macro avg': {'precision': 0.349908455730884, 'recall': 0.346350079900733, 'f1-score': 0.33370283750310364, 'support': 443507}, 'weighted avg': {'precision': 0.3509226573267239, 'recall': 0.3412279851276305, 'f1-score': 0.33154020197744277, 'support': 443507}}
[[70609 42085 27876]
 [71155 47100 27905]
 [79432 43717 33628]]
Evaluating performance on  train set...
765/765 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961773
{'0': {'precision': 0.31877310246317236, 'recall': 0.48202008210911607, 'f1-score': 0.38375710478990827, 'support': 60651}, '1': {'precision': 0.38155537710791276, 'recall': 0.37474974215858764, 'f1-score': 0.3781219392752203, 'support': 65932}, '2': {'precision': 0.36987556302007785, 'recall': 0.21010103930269872, 'f1-score': 0.2679806043621748, 'support': 69181}, 'accuracy': 0.3497987372550622, 'macro avg': {'precision': 0.356734680863721, 'recall': 0.3556236211901342, 'f1-score': 0.3432865494757678, 'support': 195764}, 'weighted avg': {'precision': 0.3579768388787764, 'recall': 0.3497987372550622, 'f1-score': 0.3409449850497853, 'support': 195764}}
[[29235 18657 12759]
 [29221 24708 12003]
 [33255 21391 14535]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969089
{'0': {'precision': 0.33091079226450404, 'recall': 0.5096070708041118, 'f1-score': 0.40126328529823363, 'support': 20818}, '1': {'precision': 0.3869402607904579, 'recall': 0.3418925557093735, 'f1-score': 0.3630242537755755, 'support': 22393}, '2': {'precision': 0.34850839030453695, 'recall': 0.2085832519644767, 'f1-score': 0.26097326856511244, 'support': 21507}, 'accuracy': 0.35154052968262306, 'macro avg': {'precision': 0.35545314778649967, 'recall': 0.35336095949265395, 'f1-score': 0.3417536025463072, 'support': 64718}, 'weighted avg': {'precision': 0.3561454940437412, 'recall': 0.35154052968262306, 'f1-score': 0.34141124996391986, 'support': 64718}}
[[10609  5882  4327]
 [10678  7656  4059]
 [10773  6248  4486]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0928375
{'0': {'precision': 0.2658146798172078, 'recall': 0.3680358550039401, 'f1-score': 0.308682654931352, 'support': 304560}, '1': {'precision': 0.49256063960856616, 'recall': 0.5774745239178698, 'f1-score': 0.5316483617626663, 'support': 580152}, '2': {'precision': 0.2906784779544997, 'recall': 0.0912425942017537, 'f1-score': 0.1388886884792516, 'support': 316475}, 'accuracy': 0.3962646948393547, 'macro avg': {'precision': 0.34968459912675787, 'recall': 0.3455843243745212, 'f1-score': 0.32640656839109, 'support': 1201187}, 'weighted avg': {'precision': 0.3818797825700478, 'recall': 0.3962646948393547, 'f1-score': 0.37163576316235364, 'support': 1201187}}
[[112089 166658  25813]
 [200478 335023  44651]
 [109114 178485  28876]]
Evaluating performance on  train set...
1497/1497 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977411
{'0': {'precision': 0.3440531182055768, 'recall': 0.37313326187924256, 'f1-score': 0.3580036258931428, 'support': 125955}, '1': {'precision': 0.34399517479759667, 'recall': 0.5859161385152756, 'f1-score': 0.43348719732691765, 'support': 126542}, '2': {'precision': 0.36395588804333806, 'recall': 0.08639046008067294, 'f1-score': 0.13963615669633747, 'support': 130651}, 'accuracy': 0.3456314531199432, 'macro avg': {'precision': 0.3506680603488372, 'recall': 0.3484799534917304, 'f1-score': 0.3103756599721326, 'support': 383148}, 'weighted avg': {'precision': 0.35082069759354373, 'recall': 0.3456314531199432, 'f1-score': 0.3084716274965465, 'support': 383148}}
[[46998 68424 10533]
 [43207 74143  9192]
 [46396 72968 11287]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975748
{'0': {'precision': 0.35643384852467935, 'recall': 0.3350232181655519, 'f1-score': 0.3453970484891075, 'support': 46946}, '1': {'precision': 0.34379277424401017, 'recall': 0.639487366011254, 'f1-score': 0.4471790421759751, 'support': 46739}, '2': {'precision': 0.35697992700729925, 'recall': 0.06782525786599636, 'f1-score': 0.11399227911719717, 'support': 46148}, 'accuracy': 0.3486086975177533, 'macro avg': {'precision': 0.35240218325866296, 'recall': 0.34744528068093405, 'f1-score': 0.30218945659409324, 'support': 139833}, 'weighted avg': {'precision': 0.35238880378568177, 'recall': 0.3486086975177533, 'f1-score': 0.303048828154534, 'support': 139833}}
[[15728 28238  2980]
 [14192 29889  2658]
 [14206 28812  3130]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
6677/6677 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.090934
{'0': {'precision': 0.28001865329581416, 'recall': 0.30670668485675306, 'f1-score': 0.29275569765176634, 'support': 458125}, '1': {'precision': 0.5021554061999491, 'recall': 0.6547752909153582, 'f1-score': 0.5683987001107661, 'support': 841310}, '2': {'precision': 0.26936026936026936, 'recall': 0.07261263986960956, 'f1-score': 0.1143889454769089, 'support': 409846}, 'accuracy': 0.4218961071936095, 'macro avg': {'precision': 0.3505114429520109, 'recall': 0.344698205213907, 'f1-score': 0.3251811144131471, 'support': 1709281}, 'weighted avg': {'precision': 0.38679897529280033, 'recall': 0.4218961071936095, 'f1-score': 0.38565927201252065, 'support': 1709281}}
[[140510 287483  30132]
 [239849 550869  50592]
 [121429 258657  29760]]
Evaluating performance on  train set...
2262/2262 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969206
{'0': {'precision': 0.3455590929764148, 'recall': 0.33011094731941965, 'f1-score': 0.33765842122388084, 'support': 193335}, '1': {'precision': 0.35366658813743196, 'recall': 0.6231736253824433, 'f1-score': 0.45124204932572337, 'support': 195127}, '2': {'precision': 0.3604873007671211, 'recall': 0.09528337071687092, 'f1-score': 0.15072687764607143, 'support': 190369}, 'accuracy': 0.3516725952825609, 'macro avg': {'precision': 0.3532376606269893, 'recall': 0.3495226478062446, 'f1-score': 0.3132091160652252, 'support': 578831}, 'weighted avg': {'precision': 0.3532018405092746, 'recall': 0.3516725952825609, 'f1-score': 0.3144690301602789, 'support': 578831}}
[[ 63822 111830  17683]
 [ 59033 121598  14496]
 [ 61837 110393  18139]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096892
{'0': {'precision': 0.32087034572410167, 'recall': 0.3155379698676001, 'f1-score': 0.31818181818181823, 'support': 65710}, '1': {'precision': 0.37081925450204795, 'recall': 0.6408103548268045, 'f1-score': 0.4697862060635343, 'support': 75868}, '2': {'precision': 0.36795252225519287, 'recall': 0.08327379761666619, 'f1-score': 0.13581124381007864, 'support': 69986}, 'accuracy': 0.35534873607986234, 'macro avg': {'precision': 0.3532140408271142, 'recall': 0.34654070743702353, 'f1-score': 0.3079264226851437, 'support': 211564}, 'weighted avg': {'precision': 0.3543572197568774, 'recall': 0.35534873607986234, 'f1-score': 0.31221924743173535, 'support': 211564}}
[[20734 39811  5165]
 [22405 48617  4846]
 [21479 42679  5828]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
5633/5633 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096918
{'0': {'precision': 0.28418752505130324, 'recall': 0.38609848703477384, 'f1-score': 0.3273956832695307, 'support': 398489}, '1': {'precision': 0.42404829285791845, 'recall': 0.5220392154208517, 'f1-score': 0.46796905395535865, 'support': 590992}, '2': {'precision': 0.33088460715297985, 'recall': 0.1264579483052871, 'f1-score': 0.18298314052336193, 'support': 452348}, 'accuracy': 0.3603617349907652, 'macro avg': {'precision': 0.34637347502073385, 'recall': 0.3448652169203042, 'f1-score': 0.3261159592494171, 'support': 1441829}, 'weighted avg': {'precision': 0.3561654964904242, 'recall': 0.3603617349907652, 'f1-score': 0.33970852522389205, 'support': 1441829}}
[[153856 195309  49324]
 [216119 308521  66352]
 [171414 223731  57203]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977076
{'0': {'precision': 0.3358671734346869, 'recall': 0.4654040877554847, 'f1-score': 0.3901648868005126, 'support': 122659}, '1': {'precision': 0.3488045503302659, 'recall': 0.4023230826835105, 'f1-score': 0.37365719426363975, 'support': 122854}, '2': {'precision': 0.3525975208116115, 'recall': 0.16831252962553325, 'f1-score': 0.2278573071020251, 'support': 126580}, 'accuracy': 0.343510896469431, 'macro avg': {'precision': 0.3457564148588548, 'recall': 0.34534656668817615, 'f1-score': 0.3305597960553925, 'support': 372093}, 'weighted avg': {'precision': 0.34583010171364026, 'recall': 0.343510896469431, 'f1-score': 0.3295001349853494, 'support': 372093}}
[[57086 45340 20233]
 [54542 49427 18885]
 [58338 46937 21305]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972037
{'0': {'precision': 0.35220445815961393, 'recall': 0.43973767804078284, 'f1-score': 0.39113355268554556, 'support': 48795}, '1': {'precision': 0.34510930991054994, 'recall': 0.46177112364162726, 'f1-score': 0.39500651444728846, 'support': 46287}, '2': {'precision': 0.3458627390815178, 'recall': 0.14289638269100743, 'f1-score': 0.20223677521605216, 'support': 47328}, 'accuracy': 0.3482480162909908, 'macro avg': {'precision': 0.3477255023838939, 'recall': 0.3481350614578058, 'f1-score': 0.3294589474496287, 'support': 142410}, 'weighted avg': {'precision': 0.34779076524807284, 'recall': 0.3482480162909908, 'f1-score': 0.32961512769425005, 'support': 142410}}
[[21457 20459  6879]
 [19001 21374  5912]
 [20464 20101  6763]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
11876/11876 - 93s - 93s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099203
{'0': {'precision': 0.38528648944235666, 'recall': 0.3906212425550669, 'f1-score': 0.38793552645291274, 'support': 1143563}, '1': {'precision': 0.24992679997884615, 'recall': 0.541717456944755, 'f1-score': 0.3420468457208728, 'support': 715360}, '2': {'precision': 0.40366614074031454, 'recall': 0.112844143101561, 'f1-score': 0.17638123063934968, 'support': 1181231}, 'accuracy': 0.31824637830846725, 'macro avg': {'precision': 0.3462931433871725, 'recall': 0.34839428086712765, 'f1-score': 0.3021212009377117, 'support': 3040154}, 'weighted avg': {'precision': 0.3605771182814619, 'recall': 0.31824637830846725, 'f1-score': 0.2949397706304699, 'support': 3040154}}
[[446700 569372 127491]
 [258412 387523  69425]
 [454285 593651 133295]]
Evaluating performance on  train set...
2538/2538 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973359
{'0': {'precision': 0.3430756003786781, 'recall': 0.32788012795952565, 'f1-score': 0.3353057944092885, 'support': 216631}, '1': {'precision': 0.35730136185586914, 'recall': 0.6045205577532353, 'f1-score': 0.4491393139446933, 'support': 223468}, '2': {'precision': 0.3459481248352739, 'recall': 0.10649803126118601, 'f1-score': 0.162860458496639, 'support': 209525}, 'accuracy': 0.35164033348521606, 'macro avg': {'precision': 0.3487750290232737, 'recall': 0.346299572324649, 'f1-score': 0.3157685222835403, 'support': 649624}, 'weighted avg': {'precision': 0.3488956873098154, 'recall': 0.35164033348521606, 'f1-score': 0.3188447953335769, 'support': 649624}}
[[ 71029 123059  22543]
 [ 68733 135091  19644]
 [ 67274 119937  22314]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975829
{'0': {'precision': 0.34237860491761263, 'recall': 0.33691846665084263, 'f1-score': 0.3396265916958898, 'support': 67408}, '1': {'precision': 0.3476404627106202, 'recall': 0.6082643164001948, 'f1-score': 0.4424233313289236, 'support': 67737}, '2': {'precision': 0.35355220667384285, 'recall': 0.09619693353054022, 'f1-score': 0.1512427043641429, 'support': 68287}, 'accuracy': 0.34646466632584844, 'macro avg': {'precision': 0.34785709143402527, 'recall': 0.34712657219385923, 'f1-score': 0.31109754246298543, 'support': 203432}, 'weighted avg': {'precision': 0.34788134885392874, 'recall': 0.34646466632584844, 'f1-score': 0.310619219396054, 'support': 203432}}
[[22711 38217  6480]
 [21004 41202  5531]
 [22618 39100  6569]]
testing model on single stock: results/universal/W0/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
19053/19053 - 146s - 146s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960126
{'0': {'precision': 0.2712831753496112, 'recall': 0.3882657199619124, 'f1-score': 0.31939999638971484, 'support': 1276005}, '1': {'precision': 0.5045326906224038, 'recall': 0.52300395510296, 'f1-score': 0.5136023007490522, 'support': 2371114}, '2': {'precision': 0.2670235520773461, 'recall': 0.1287625159815236, 'f1-score': 0.1737434799584121, 'support': 1230327}, 'accuracy': 0.38830793821192483, 'macro avg': {'precision': 0.34761313934978705, 'recall': 0.34667739701546535, 'f1-score': 0.3355819256990597, 'support': 4877446}, 'weighted avg': {'precision': 0.3836002490055443, 'recall': 0.38830793821192483, 'f1-score': 0.37706760722688465, 'support': 4877446}}
[[ 495429  616518  164058]
 [ 860209 1240102  270803]
 [ 470605  601302  158420]]
Evaluating performance on  train set...
4812/4812 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981032
{'0': {'precision': 0.331936969627293, 'recall': 0.45630298375884965, 'f1-score': 0.384308937932268, 'support': 404959}, '1': {'precision': 0.3499053413207426, 'recall': 0.41489128911465106, 'f1-score': 0.3796373371729398, 'support': 406721}, '2': {'precision': 0.35598992349318903, 'recall': 0.16344865500360553, 'f1-score': 0.22403447336616045, 'support': 420187}, 'accuracy': 0.34273829885856183, 'macro avg': {'precision': 0.34594407814707484, 'recall': 0.34488097595903544, 'f1-score': 0.32932691615712273, 'support': 1231867}, 'weighted avg': {'precision': 0.34607392810542476, 'recall': 0.34273829885856183, 'f1-score': 0.32809728149933026, 'support': 1231867}}
[[184784 155263  64912]
 [178643 168745  59333]
 [193257 158251  68679]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986257
{'0': {'precision': 0.33769537639711517, 'recall': 0.4596015311411787, 'f1-score': 0.38932876970667624, 'support': 150476}, '1': {'precision': 0.3614057218100439, 'recall': 0.41793880919781445, 'f1-score': 0.3876218309127861, 'support': 156298}, '2': {'precision': 0.33254430777989186, 'recall': 0.15253678213841493, 'f1-score': 0.20914127423822718, 'support': 145519}, 'accuracy': 0.346410402106599, 'macro avg': {'precision': 0.3438818019956836, 'recall': 0.3433590408258027, 'f1-score': 0.32869729161922984, 'support': 452293}, 'weighted avg': {'precision': 0.3442316288114577, 'recall': 0.346410402106599, 'f1-score': 0.3307660785470061, 'support': 452293}}
[[69159 58750 22567]
 [68990 65323 21985]
 [66648 56674 22197]]
training model: results/universal/W0/deepVOL_L2/h300
Epoch 1/50
8838/8838 - 297s - loss: 3.2822 - accuracy300: 0.3667 - val_loss: 3.2916 - val_accuracy300: 0.3525 - 297s/epoch - 34ms/step
Epoch 2/50
8838/8838 - 290s - loss: 3.2770 - accuracy300: 0.3721 - val_loss: 3.2943 - val_accuracy300: 0.3504 - 290s/epoch - 33ms/step
Epoch 3/50
8838/8838 - 291s - loss: 3.2734 - accuracy300: 0.3748 - val_loss: 3.2904 - val_accuracy300: 0.3553 - 291s/epoch - 33ms/step
Epoch 4/50
8838/8838 - 292s - loss: 3.2637 - accuracy300: 0.3822 - val_loss: 3.2908 - val_accuracy300: 0.3542 - 292s/epoch - 33ms/step
Epoch 5/50
8838/8838 - 296s - loss: 3.2595 - accuracy300: 0.3848 - val_loss: 3.2910 - val_accuracy300: 0.3559 - 296s/epoch - 34ms/step
Epoch 6/50
8838/8838 - 291s - loss: 3.2559 - accuracy300: 0.3871 - val_loss: 3.2911 - val_accuracy300: 0.3555 - 291s/epoch - 33ms/step
Epoch 7/50
8838/8838 - 293s - loss: 3.2528 - accuracy300: 0.3892 - val_loss: 3.2912 - val_accuracy300: 0.3540 - 293s/epoch - 33ms/step
Epoch 8/50
8838/8838 - 292s - loss: 3.2512 - accuracy300: 0.3902 - val_loss: 3.2923 - val_accuracy300: 0.3505 - 292s/epoch - 33ms/step
Epoch 9/50
8838/8838 - 291s - loss: 3.2482 - accuracy300: 0.3923 - val_loss: 3.2920 - val_accuracy300: 0.3505 - 291s/epoch - 33ms/step
Epoch 10/50
8838/8838 - 293s - loss: 3.2461 - accuracy300: 0.3938 - val_loss: 3.2948 - val_accuracy300: 0.3470 - 293s/epoch - 33ms/step
Epoch 11/50
8838/8838 - 292s - loss: 3.2440 - accuracy300: 0.3951 - val_loss: 3.2953 - val_accuracy300: 0.3470 - 292s/epoch - 33ms/step
Epoch 12/50
8838/8838 - 296s - loss: 3.2415 - accuracy300: 0.3965 - val_loss: 3.2967 - val_accuracy300: 0.3458 - 296s/epoch - 34ms/step
Epoch 13/50
8838/8838 - 293s - loss: 3.2399 - accuracy300: 0.3975 - val_loss: 3.2958 - val_accuracy300: 0.3474 - 293s/epoch - 33ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 513s - 513s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937437
{'0': {'precision': 0.31498212480388726, 'recall': 0.3348134258990542, 'f1-score': 0.32459515670264977, 'support': 2377554}, '1': {'precision': 0.4405723707798246, 'recall': 0.24851050116545645, 'f1-score': 0.31777559744901535, 'support': 3649214}, '2': {'precision': 0.30945711521308444, 'recall': 0.49357026348523136, 'f1-score': 0.3804075276753003, 'support': 2422261}, 'accuracy': 0.34305255669024215, 'macro avg': {'precision': 0.3550038702655988, 'recall': 0.3589647301832473, 'f1-score': 0.3409260939423218, 'support': 8449029}, 'weighted avg': {'precision': 0.36764174623759355, 'recall': 0.34305255669024215, 'f1-score': 0.3376506330683234, 'support': 8449029}}
[[ 796037  566540 1014977]
 [1089481  906868 1652865]
 [ 641727  584978 1195556]]
Evaluating performance on  train set...
8838/8838 - 137s - 137s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096401
{'0': {'precision': 0.3608195055875381, 'recall': 0.3186197487321131, 'f1-score': 0.33840912039462534, 'support': 749081}, '1': {'precision': 0.3475154283270194, 'recall': 0.24341566758149163, 'f1-score': 0.2862963230968164, 'support': 747684}, '2': {'precision': 0.3560620974511741, 'recall': 0.5010263854897447, 'f1-score': 0.416284920977421, 'support': 765307}, 'accuracy': 0.35547453838781434, 'macro avg': {'precision': 0.35479901045524387, 'recall': 0.35435393393444975, 'f1-score': 0.3469967881562876, 'support': 2262072}, 'weighted avg': {'precision': 0.35481256882731566, 'recall': 0.35547453838781434, 'f1-score': 0.34753128387209314, 'support': 2262072}}
[[238672 164557 345852]
 [218089 181998 347597]
 [204711 177157 383439]]
Evaluating performance on  val set...
3279/3279 - 54s - 54s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967021
{'0': {'precision': 0.3699067434756893, 'recall': 0.3249211805481421, 'f1-score': 0.3459577015465988, 'support': 281022}, '1': {'precision': 0.3427396658107333, 'recall': 0.23251712011172168, 'f1-score': 0.27706875257307534, 'support': 274969}, '2': {'precision': 0.3520456731362056, 'recall': 0.5046237707062209, 'f1-score': 0.41474717305658537, 'support': 282886}, 'accuracy': 0.3552320542820938, 'macro avg': {'precision': 0.35489736080754275, 'recall': 0.35402069045536155, 'f1-score': 0.3459245423920865, 'support': 838877}, 'weighted avg': {'precision': 0.35497874935675355, 'recall': 0.3552320542820938, 'f1-score': 0.3465743032978368, 'support': 838877}}
[[ 91310  58977 130735]
 [ 79030  63935 132004]
 [ 76506  63629 142751]]
testing model out of sample: results/universal/W0/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 359s - 359s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0928782
{'0': {'precision': 0.38474292549139993, 'recall': 0.39935198647658804, 'f1-score': 0.39191135979231406, 'support': 1995946}, '1': {'precision': 0.3498474360800551, 'recall': 0.17777162206435054, 'f1-score': 0.23574943030198056, 'support': 1837498}, '2': {'precision': 0.37180294264730746, 'recall': 0.5257669469507417, 'f1-score': 0.435579892526291, 'support': 1999519}, 'accuracy': 0.372884415690619, 'macro avg': {'precision': 0.36879776807292086, 'recall': 0.3676301851638934, 'f1-score': 0.35441356087352854, 'support': 5832963}, 'weighted avg': {'precision': 0.36931438024624674, 'recall': 0.372884415690619, 'f1-score': 0.35768670035063405, 'support': 5832963}}
[[ 797085  287135  911726]
 [ 646328  326655  864515]
 [ 628321  319917 1051281]]
Evaluating performance on  train set...
6334/6334 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959734
{'0': {'precision': 0.37246015731169957, 'recall': 0.32981316743822237, 'f1-score': 0.34984174935379775, 'support': 548459}, '1': {'precision': 0.3440474414853361, 'recall': 0.23699090933305936, 'f1-score': 0.2806565724843405, 'support': 525594}, '2': {'precision': 0.3615341039894257, 'recall': 0.5111777151561588, 'f1-score': 0.42352623895772934, 'support': 546847}, 'accuracy': 0.36090196804244556, 'macro avg': {'precision': 0.3593472342621538, 'recall': 0.35932726397581355, 'f1-score': 0.3513415202652892, 'support': 1620900}, 'weighted avg': {'precision': 0.3595608837950316, 'recall': 0.36090196804244556, 'f1-score': 0.35226683926367225, 'support': 1620900}}
[[180889 115380 252190]
 [159565 124561 241468]
 [145206 122105 279536]]
Evaluating performance on  val set...
2156/2156 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947752
{'0': {'precision': 0.3613217538657064, 'recall': 0.37548909005860825, 'f1-score': 0.3682692177949292, 'support': 181715}, '1': {'precision': 0.35792410256410256, 'recall': 0.2355145232696253, 'f1-score': 0.28409449844510654, 'support': 185220}, '2': {'precision': 0.36433721920911, 'recall': 0.47541961549933565, 'f1-score': 0.4125314698477683, 'support': 184395}, 'accuracy': 0.3618867103186839, 'macro avg': {'precision': 0.3611943585463064, 'recall': 0.3621410762758564, 'f1-score': 0.354965062029268, 'support': 551330}, 'weighted avg': {'precision': 0.3611888457306763, 'recall': 0.3618867103186839, 'f1-score': 0.3547943414945449, 'support': 551330}}
[[68232 37596 75887]
 [64535 43622 77063]
 [56073 40657 87665]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0993418
{'0': {'precision': 0.32485853064234305, 'recall': 0.3150652985074627, 'f1-score': 0.3198869780033307, 'support': 64320}, '1': {'precision': 0.4276381121622328, 'recall': 0.17767258039999131, 'f1-score': 0.2510432007854688, 'support': 92102}, '2': {'precision': 0.31449784629335753, 'recall': 0.5734723103952283, 'f1-score': 0.4062204234447634, 'support': 67733}, 'accuracy': 0.3366955901050612, 'macro avg': {'precision': 0.3556648296993112, 'recall': 0.3554033964342274, 'f1-score': 0.3257168674111876, 'support': 224155}, 'weighted avg': {'precision': 0.36395846053074643, 'recall': 0.3366955901050612, 'f1-score': 0.3176874896616254, 'support': 224155}}
[[20265 10363 33692]
 [24765 16364 50973]
 [17351 11539 38843]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971694
{'0': {'precision': 0.37769537705050177, 'recall': 0.3350495191104437, 'f1-score': 0.35509662751042065, 'support': 27969}, '1': {'precision': 0.3215000910249408, 'recall': 0.13682497869373209, 'f1-score': 0.19195652173913041, 'support': 25814}, '2': {'precision': 0.35513195835442757, 'recall': 0.5878666423756604, 'f1-score': 0.4427795158900049, 'support': 27445}, 'accuracy': 0.3574752548382331, 'macro avg': {'precision': 0.35144247547662344, 'recall': 0.35324704672661206, 'f1-score': 0.3299442217131853, 'support': 81228}, 'weighted avg': {'precision': 0.3522130539651422, 'recall': 0.3574752548382331, 'f1-score': 0.33287717339604633, 'support': 81228}}
[[ 9371  3961 14637]
 [ 7622  3532 14660]
 [ 7818  3493 16134]]
Evaluating performance on  val set...
104/104 - 1s - 948ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006881
{'0': {'precision': 0.3182770358732653, 'recall': 0.29398959970975935, 'f1-score': 0.30565159992456153, 'support': 8269}, '1': {'precision': 0.3913746630727763, 'recall': 0.1446215139442231, 'f1-score': 0.21119999999999997, 'support': 10040}, '2': {'precision': 0.3297457906899967, 'recall': 0.6102150537634409, 'f1-score': 0.4281366539500193, 'support': 8184}, 'accuracy': 0.3350696410372551, 'macro avg': {'precision': 0.3464658298786794, 'recall': 0.34960872247247443, 'f1-score': 0.3149960846248603, 'support': 26493}, 'weighted avg': {'precision': 0.34952153315568785, 'recall': 0.3350696410372551, 'f1-score': 0.30769454028245796, 'support': 26493}}
[[2431 1176 4662]
 [3099 1452 5489]
 [2108 1082 4994]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
2359/2359 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0894246
{'0': {'precision': 0.35381376910185086, 'recall': 0.5144750945187144, 'f1-score': 0.4192806793390872, 'support': 187529}, '1': {'precision': 0.3596733782503148, 'recall': 0.14460635921417983, 'f1-score': 0.2062785944823119, 'support': 191596}, '2': {'precision': 0.4272731566394043, 'recall': 0.4832081829228667, 'f1-score': 0.453522497738842, 'support': 224663}, 'accuracy': 0.3854730468310069, 'macro avg': {'precision': 0.38025343466385664, 'recall': 0.38076321221858694, 'f1-score': 0.35969392385341364, 'support': 603788}, 'weighted avg': {'precision': 0.38300660509189777, 'recall': 0.3854730468310069, 'f1-score': 0.36443116625986965, 'support': 603788}}
[[ 96479  21552  69498]
 [ 87873  27706  76017]
 [ 88331  27773 108559]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0897074
{'0': {'precision': 0.3765150114863616, 'recall': 0.5612232849214783, 'f1-score': 0.45067796074465055, 'support': 50814}, '1': {'precision': 0.3655246730083234, 'recall': 0.1941078969177947, 'f1-score': 0.2535636035571594, 'support': 50678}, '2': {'precision': 0.38438325945349733, 'recall': 0.3753073374921261, 'f1-score': 0.3797910840598783, 'support': 49213}, 'accuracy': 0.37706114594738066, 'macro avg': {'precision': 0.3754743146493941, 'recall': 0.3768795064437997, 'f1-score': 0.3613442161205627, 'support': 150705}, 'weighted avg': {'precision': 0.3753886501434508, 'recall': 0.37706114594738066, 'f1-score': 0.36124551155029494, 'support': 150705}}
[[28518  8102 14194]
 [25454  9837 15387]
 [21770  8973 18470]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0902086
{'0': {'precision': 0.3862375560452922, 'recall': 0.5163830327660656, 'f1-score': 0.44192770036736734, 'support': 19685}, '1': {'precision': 0.32942545194200823, 'recall': 0.21065583152111708, 'f1-score': 0.2569812901424183, 'support': 17474}, '2': {'precision': 0.41940172543135784, 'recall': 0.4129541572411246, 'f1-score': 0.416152969364256, 'support': 21661}, 'accuracy': 0.3874702482148929, 'macro avg': {'precision': 0.3783549111395528, 'recall': 0.37999767384276906, 'f1-score': 0.3716873199580139, 'support': 58820}, 'weighted avg': {'precision': 0.38157306039705663, 'recall': 0.3874702482148929, 'f1-score': 0.3774928139251852, 'support': 58820}}
[[10165  3272  6248]
 [ 7658  3681  6135]
 [ 8495  4221  8945]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
1625/1625 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095308
{'0': {'precision': 0.29662024331900033, 'recall': 0.34713312895552634, 'f1-score': 0.31989490885638205, 'support': 116451}, '1': {'precision': 0.41689071643207337, 'recall': 0.25598226883507846, 'f1-score': 0.317196956290922, 'support': 175059}, '2': {'precision': 0.31481653668685133, 'recall': 0.43568090975623486, 'f1-score': 0.36551638052891344, 'support': 124341}, 'accuracy': 0.33523786163794245, 'macro avg': {'precision': 0.342775832145975, 'recall': 0.34626543584894653, 'f1-score': 0.33420274855873916, 'support': 415851}, 'weighted avg': {'precision': 0.3526907446917357, 'recall': 0.33523786163794245, 'f1-score': 0.332400153598074, 'support': 415851}}
[[40424 28614 47413]
 [59755 44812 70492]
 [36103 34065 54173]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994897
{'0': {'precision': 0.3403465886769392, 'recall': 0.41622847991458695, 'f1-score': 0.3744821872410936, 'support': 37465}, '1': {'precision': 0.32040436659763416, 'recall': 0.23893411512184906, 'f1-score': 0.27373598032747554, 'support': 38203}, '2': {'precision': 0.36278346255742167, 'recall': 0.37519481172389524, 'f1-score': 0.3688847698486252, 'support': 39782}, 'accuracy': 0.34342139454309223, 'macro avg': {'precision': 0.34117813927733165, 'recall': 0.3434524689201104, 'f1-score': 0.3390343124723982, 'support': 115450}, 'weighted avg': {'precision': 0.34147894906340664, 'recall': 0.34342139454309223, 'f1-score': 0.33921597848034757, 'support': 115450}}
[[15594  9065 12806]
 [15664  9128 13411]
 [14560 10296 14926]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975277
{'0': {'precision': 0.36014886916690525, 'recall': 0.4069353690884389, 'f1-score': 0.3821153028370087, 'support': 15457}, '1': {'precision': 0.3240793663754389, 'recall': 0.2684659090909091, 'f1-score': 0.29366283156376016, 'support': 14784}, '2': {'precision': 0.35409772240607357, 'recall': 0.3666845854051875, 'f1-score': 0.3602812530947744, 'support': 14882}, 'accuracy': 0.3482924450945194, 'macro avg': {'precision': 0.34610865264947255, 'recall': 0.34736195452817853, 'f1-score': 0.34535312916518107, 'support': 45123}, 'weighted avg': {'precision': 0.3463354105013968, 'recall': 0.3482924450945194, 'f1-score': 0.34593385072682903, 'support': 45123}}
[[6290 4085 5082]
 [5943 3969 4872]
 [5232 4193 5457]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1060305
{'0': {'precision': 0.3134636041099309, 'recall': 0.8587351755159466, 'f1-score': 0.45927743275609917, 'support': 100931}, '1': {'precision': 0.33790162935891577, 'recall': 0.018969703186978524, 'f1-score': 0.03592271516799818, 'support': 116976}, '2': {'precision': 0.32672198772064465, 'recall': 0.12748813835312614, 'f1-score': 0.18340928826748704, 'support': 106857}, 'accuracy': 0.31565998694436576, 'macro avg': {'precision': 0.3260290737298304, 'recall': 0.33506433901868377, 'f1-score': 0.2262031453971948, 'support': 324764}, 'weighted avg': {'precision': 0.32662828227319807, 'recall': 0.31565998694436576, 'f1-score': 0.21602145684680713, 'support': 324764}}
[[86673  2178 12080]
 [98764  2219 15993]
 [91064  2170 13623]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031649
{'0': {'precision': 0.33388543953963806, 'recall': 0.8558431791164269, 'f1-score': 0.4803676595744681, 'support': 41219}, '1': {'precision': 0.3380952380952381, 'recall': 0.02076934327921603, 'f1-score': 0.03913462863442194, 'support': 41022}, '2': {'precision': 0.32545556315691276, 'recall': 0.12455372018850859, 'f1-score': 0.18015939958342658, 'support': 42014}, 'accuracy': 0.33287996458895014, 'macro avg': {'precision': 0.3324787469305963, 'recall': 0.33372208086138383, 'f1-score': 0.23322056259743884, 'support': 124255}, 'weighted avg': {'precision': 0.3324249070057682, 'recall': 0.33287996458895014, 'f1-score': 0.23318878362994924, 'support': 124255}}
[[35277   885  5057]
 [34381   852  5789]
 [35998   783  5233]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047556
{'0': {'precision': 0.32387836490528416, 'recall': 0.8863574351978172, 'f1-score': 0.47440671778021176, 'support': 14660}, '1': {'precision': 0.35555555555555557, 'recall': 0.016170327449130845, 'f1-score': 0.03093381452600374, 'support': 14842}, '2': {'precision': 0.3496296296296296, 'recall': 0.1031339742789362, 'f1-score': 0.1592826495685291, 'support': 16018}, 'accuracy': 0.32702108963093146, 'macro avg': {'precision': 0.3430211833634898, 'recall': 0.3352205789752947, 'f1-score': 0.22154106062491485, 'support': 45520}, 'weighted avg': {'precision': 0.3432684488680674, 'recall': 0.32702108963093146, 'f1-score': 0.21892160893325024, 'support': 45520}}
[[12994   158  1508]
 [13037   240  1565]
 [14089   277  1652]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
1733/1733 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953795
{'0': {'precision': 0.3615170823013367, 'recall': 0.3881123139377537, 'f1-score': 0.3743429274356958, 'support': 147800}, '1': {'precision': 0.31260320543953374, 'recall': 0.27688634603802803, 'f1-score': 0.29366274295099914, 'support': 139476}, '2': {'precision': 0.38791313027359126, 'recall': 0.4004838833559487, 'f1-score': 0.3940982883776592, 'support': 156236}, 'accuracy': 0.3574920182542975, 'macro avg': {'precision': 0.3540111393381539, 'recall': 0.3551608477772435, 'f1-score': 0.35403465292145136, 'support': 443512}, 'weighted avg': {'precision': 0.35543314559120565, 'recall': 0.3574920182542975, 'f1-score': 0.355929782269254, 'support': 443512}}
[[57363 40131 50306]
 [52434 38619 48423]
 [48876 44790 62570]]
Evaluating performance on  train set...
765/765 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987173
{'0': {'precision': 0.3332919144404012, 'recall': 0.2964553564379885, 'f1-score': 0.3137962730843152, 'support': 63335}, '1': {'precision': 0.31891539214369324, 'recall': 0.2565016746153015, 'f1-score': 0.28432362149492735, 'support': 64791}, '2': {'precision': 0.35902104949723995, 'recall': 0.46348206629409505, 'f1-score': 0.4046180851338445, 'support': 67638}, 'accuracy': 0.34094113320120145, 'macro avg': {'precision': 0.3370761186937781, 'recall': 0.3388130324491283, 'f1-score': 0.3342459932376957, 'support': 195764}, 'weighted avg': {'precision': 0.33742340940805843, 'recall': 0.34094113320120145, 'f1-score': 0.33542151140330156, 'support': 195764}}
[[18776 17027 27532]
 [19735 16619 28437]
 [17824 18465 31349]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984267
{'0': {'precision': 0.32935309726415957, 'recall': 0.3416381928625664, 'f1-score': 0.3353831819240624, 'support': 21072}, '1': {'precision': 0.3401112269725408, 'recall': 0.2675446591323369, 'f1-score': 0.2994949752588889, 'support': 21944}, '2': {'precision': 0.36045784826939603, 'recall': 0.42516818726384664, 'f1-score': 0.39014799154334034, 'support': 21702}, 'accuracy': 0.34452547977378783, 'macro avg': {'precision': 0.3433073908353655, 'recall': 0.3447836797529167, 'f1-score': 0.3416753829087639, 'support': 64718}, 'weighted avg': {'precision': 0.34343127805831825, 'recall': 0.34452547977378783, 'f1-score': 0.34157890940786917, 'support': 64718}}
[[7199 5588 8285]
 [7987 5871 8086]
 [6672 5803 9227]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
4693/4693 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0843995
{'0': {'precision': 0.3699573550714624, 'recall': 0.6002880711630741, 'f1-score': 0.45778311566038193, 'support': 379073}, '1': {'precision': 0.452677493858397, 'recall': 0.17102656210941478, 'f1-score': 0.24825836798118517, 'support': 432044}, '2': {'precision': 0.405349482834455, 'recall': 0.43944113311542654, 'f1-score': 0.42170742117971804, 'support': 390075}, 'accuracy': 0.3936581329212982, 'macro avg': {'precision': 0.4093281105881048, 'recall': 0.4035852554626385, 'f1-score': 0.37591630160709505, 'support': 1201192}, 'weighted avg': {'precision': 0.4112033206450025, 'recall': 0.3936581329212982, 'f1-score': 0.3707061649224018, 'support': 1201192}}
[[227553  38067 113453]
 [220139  73891 138014]
 [167387  51273 171415]]
Evaluating performance on  train set...
1497/1497 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0867763
{'0': {'precision': 0.3861333732229465, 'recall': 0.5293482032999969, 'f1-score': 0.4465387673361033, 'support': 126788}, '1': {'precision': 0.381672714554278, 'recall': 0.2071059727812616, 'f1-score': 0.26851073427792244, 'support': 126457}, '2': {'precision': 0.3933284535628247, 'recall': 0.42606848134006653, 'f1-score': 0.4090443831040459, 'support': 129904}, 'accuracy': 0.38797700111444894, 'macro avg': {'precision': 0.3870448471133497, 'recall': 0.387507552473775, 'f1-score': 0.3746979615726905, 'support': 383149}, 'weighted avg': {'precision': 0.3871005901625907, 'recall': 0.38797700111444894, 'f1-score': 0.3750690219740651, 'support': 383149}}
[[67115 18410 41263]
 [56161 26190 44106]
 [50537 24019 55348]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0853025
{'0': {'precision': 0.4064807346280325, 'recall': 0.5432551775607936, 'f1-score': 0.46501929816778315, 'support': 48237}, '1': {'precision': 0.3421041896136744, 'recall': 0.1928481085431758, 'f1-score': 0.24665431336215773, 'support': 43485}, '2': {'precision': 0.40883347754267285, 'recall': 0.4321257092972501, 'f1-score': 0.42015702838434565, 'support': 48111}, 'accuracy': 0.3960510036972675, 'macro avg': {'precision': 0.3858061339281266, 'recall': 0.3894096651337398, 'f1-score': 0.37727687997142884, 'support': 139833}, 'weighted avg': {'precision': 0.3872705249809313, 'recall': 0.3960510036972675, 'f1-score': 0.3816772399567487, 'support': 139833}}
[[26205  7242 14790]
 [19827  8386 15272]
 [18436  8885 20790]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
6677/6677 - 62s - 62s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0882427
{'0': {'precision': 0.38098297321226043, 'recall': 0.48049781196764185, 'f1-score': 0.42499261312529285, 'support': 541811}, '1': {'precision': 0.4606448288223696, 'recall': 0.18101630448340278, 'f1-score': 0.2599011230841676, 'support': 681469}, '2': {'precision': 0.325264225578012, 'recall': 0.5074052583712958, 'f1-score': 0.39641365896002534, 'support': 486006}, 'accuracy': 0.36874929063948336, 'macro avg': {'precision': 0.388964009204214, 'recall': 0.38963979160744683, 'f1-score': 0.3604357983898286, 'support': 1709286}, 'weighted avg': {'precision': 0.39690040272261445, 'recall': 0.36874929063948336, 'f1-score': 0.35104695638623307, 'support': 1709286}}
[[260339  67334 214138]
 [260693 123357 297419]
 [162303  77101 246602]]
Evaluating performance on  train set...
2262/2262 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936284
{'0': {'precision': 0.38245149955336655, 'recall': 0.39174700104641114, 'f1-score': 0.3870434465570889, 'support': 197819}, '1': {'precision': 0.35875273717754713, 'recall': 0.2153939063560522, 'f1-score': 0.26917566913225693, 'support': 187113}, '2': {'precision': 0.36464618136615834, 'recall': 0.4962171417372783, 'f1-score': 0.420377267812087, 'support': 193901}, 'accuracy': 0.36973531225759415, 'macro avg': {'precision': 0.36861680603235736, 'recall': 0.36778601637991387, 'f1-score': 0.35886546116714424, 'support': 578833}, 'weighted avg': {'precision': 0.3688261265593517, 'recall': 0.36973531225759415, 'f1-score': 0.3601079882087791, 'support': 578833}}
[[77495 34191 86133]
 [65296 40303 81514]
 [59836 37848 96217]]
Evaluating performance on  val set...
827/827 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09149
{'0': {'precision': 0.36929223018104557, 'recall': 0.4241706853719129, 'f1-score': 0.3948336722687361, 'support': 68430}, '1': {'precision': 0.38170926131697186, 'recall': 0.21698592516306214, 'f1-score': 0.27668683189900456, 'support': 72825}, '2': {'precision': 0.3722738541177498, 'recall': 0.4848312449330811, 'f1-score': 0.4211618769922657, 'support': 70309}, 'accuracy': 0.37301242177308047, 'macro avg': {'precision': 0.37442511520525573, 'recall': 0.37532928515601877, 'f1-score': 0.3642274603866688, 'support': 211564}, 'weighted avg': {'precision': 0.3745573286374917, 'recall': 0.37301242177308047, 'f1-score': 0.3629145655018993, 'support': 211564}}
[[29026 11779 27625]
 [27169 15802 29854]
 [22404 13817 34088]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
5633/5633 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0917417
{'0': {'precision': 0.2720439775559678, 'recall': 0.33566824418261737, 'f1-score': 0.30052554817944077, 'support': 356045}, '1': {'precision': 0.47334636066111413, 'recall': 0.19591975826236227, 'f1-score': 0.2771331221854308, 'support': 707213}, '2': {'precision': 0.2860872272651067, 'recall': 0.5363916360255272, 'f1-score': 0.3731519501055241, 'support': 378576}, 'accuracy': 0.3198253058257747, 'macro avg': {'precision': 0.34382585516072955, 'recall': 0.3559932128235023, 'f1-score': 0.3169368734901319, 'support': 1441834}, 'weighted avg': {'precision': 0.3744691524130088, 'recall': 0.3198253058257747, 'f1-score': 0.3081208642637245, 'support': 1441834}}
[[119513  72259 164273]
 [226193 138557 342463]
 [ 93609  81902 203065]]
Evaluating performance on  train set...
1454/1454 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961202
{'0': {'precision': 0.36207402663250876, 'recall': 0.33049154771764017, 'f1-score': 0.34556267271129676, 'support': 123162}, '1': {'precision': 0.34439572226253196, 'recall': 0.26653048934317497, 'f1-score': 0.3005009725841377, 'support': 122879}, '2': {'precision': 0.3573481428371785, 'recall': 0.4665619496406302, 'f1-score': 0.40471660134946824, 'support': 126054}, 'accuracy': 0.3554656740886064, 'macro avg': {'precision': 0.35460596391073973, 'recall': 0.3545279955671485, 'f1-score': 0.35026008221496757, 'support': 372095}, 'weighted avg': {'precision': 0.35463504218333597, 'recall': 0.3554656740886064, 'f1-score': 0.35072117435907724, 'support': 372095}}
[[40704 29943 52515]
 [36876 32751 53252]
 [34839 32403 58812]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960011
{'0': {'precision': 0.37409403456606577, 'recall': 0.37210400920144593, 'f1-score': 0.3730963682980322, 'support': 48688}, '1': {'precision': 0.3359350412286775, 'recall': 0.24022685841604213, 'f1-score': 0.28013174642749356, 'support': 44433}, '2': {'precision': 0.3662551440329218, 'recall': 0.46224386285250557, 'f1-score': 0.4086889450931855, 'support': 49290}, 'accuracy': 0.3621560132293152, 'macro avg': {'precision': 0.35876140660922173, 'recall': 0.35819157682333125, 'f1-score': 0.3539723532729038, 'support': 142411}, 'weighted avg': {'precision': 0.35947509736782385, 'recall': 0.3621560132293152, 'f1-score': 0.3564098838737915, 'support': 142411}}
[[18117 10088 20483]
 [14818 10674 18941]
 [15494 11012 22784]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
11876/11876 - 100s - 100s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094295
{'0': {'precision': 0.40591422091251916, 'recall': 0.371911326232893, 'f1-score': 0.38816954981846136, 'support': 1125564}, '1': {'precision': 0.262314277404752, 'recall': 0.1384095373315968, 'f1-score': 0.18120608976010805, 'support': 749392}, '2': {'precision': 0.40241418014747127, 'recall': 0.5572265090288988, 'f1-score': 0.467332932662029, 'support': 1165203}, 'accuracy': 0.3853795146898567, 'macro avg': {'precision': 0.3568808928215808, 'recall': 0.3558491241977962, 'f1-score': 0.3455695240801995, 'support': 3040159}, 'weighted avg': {'precision': 0.3691757125434737, 'recall': 0.3853795146898567, 'f1-score': 0.36749452917625947, 'support': 3040159}}
[[418610 140002 566952]
 [248436 103723 397233]
 [364231 151690 649282]]
Evaluating performance on  train set...
2538/2538 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964712
{'0': {'precision': 0.3815829839451887, 'recall': 0.2690933019637537, 'f1-score': 0.31561446865872844, 'support': 221871}, '1': {'precision': 0.345758060827807, 'recall': 0.2596042408893849, 'f1-score': 0.296550540586923, 'support': 209673}, '2': {'precision': 0.3608105250303068, 'recall': 0.5554633370169799, 'f1-score': 0.43746095259419226, 'support': 218081}, 'accuracy': 0.3621658649220704, 'macro avg': {'precision': 0.3627171899344342, 'recall': 0.36138695995670617, 'f1-score': 0.3498753206132812, 'support': 649625}, 'weighted avg': {'precision': 0.3630467550171039, 'recall': 0.3621658649220704, 'f1-score': 0.3503656128919864, 'support': 649625}}
[[ 59704  51251 110916]
 [ 51560  54432 103681]
 [ 45200  51745 121136]]
Evaluating performance on  val set...
795/795 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956279
{'0': {'precision': 0.36958137622368775, 'recall': 0.3412180413801159, 'f1-score': 0.35483381162787164, 'support': 68487}, '1': {'precision': 0.34717418810628425, 'recall': 0.25085711673549, 'f1-score': 0.29125938768830667, 'support': 65627}, '2': {'precision': 0.3638137118591091, 'recall': 0.4869586543177818, 'f1-score': 0.4164738832441903, 'support': 69318}, 'accuracy': 0.36172775177946437, 'macro avg': {'precision': 0.36018975872969367, 'recall': 0.35967793747779586, 'f1-score': 0.3541890275201229, 'support': 203432}, 'weighted avg': {'precision': 0.3603875449041082, 'recall': 0.36172775177946437, 'f1-score': 0.35532816730651684, 'support': 203432}}
[[23369 14990 30128]
 [20266 16463 28898]
 [19596 15967 33755]]
testing model on single stock: results/universal/W0/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
19053/19053 - 161s - 161s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963585
{'0': {'precision': 0.28734872082376395, 'recall': 0.19608693211696515, 'f1-score': 0.23310373892086236, 'support': 1353976}, '1': {'precision': 0.43738001010302585, 'recall': 0.30167326478557815, 'f1-score': 0.357067237458942, 'support': 2201385}, '2': {'precision': 0.2868738553019539, 'recall': 0.5283891414351519, 'f1-score': 0.3718579911264415, 'support': 1322090}, 'accuracy': 0.33381657755249616, 'macro avg': {'precision': 0.3372008620762479, 'recall': 0.34204977944589837, 'f1-score': 0.32067632250208195, 'support': 4877451}, 'weighted avg': {'precision': 0.3549350102180189, 'recall': 0.33381657755249616, 'f1-score': 0.32666428838157957, 'support': 4877451}}
[[ 265497  432674  655805]
 [ 456529  664099 1080757]
 [ 201928  421584  698578]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099488
{'0': {'precision': 0.34687038509599, 'recall': 0.16501432087605442, 'f1-score': 0.2236385668914915, 'support': 407098}, '1': {'precision': 0.3405449032831436, 'recall': 0.27703566721095396, 'f1-score': 0.3055247817166785, 'support': 406648}, '2': {'precision': 0.3474952324810465, 'recall': 0.5879025738899173, 'f1-score': 0.43680526124531655, 'support': 418122}, 'accuracy': 0.3455305276214659, 'macro avg': {'precision': 0.34497017362006005, 'recall': 0.3433175206589752, 'f1-score': 0.32198953661782886, 'support': 1231868}, 'weighted avg': {'precision': 0.3449943869452987, 'recall': 0.3455305276214659, 'f1-score': 0.32302303833067386, 'support': 1231868}}
[[ 67177 107399 232522]
 [ 64938 112656 229054]
 [ 61551 110756 245815]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003474
{'0': {'precision': 0.35035294815517853, 'recall': 0.15776083124098508, 'f1-score': 0.21755746279652274, 'support': 149752}, '1': {'precision': 0.3444473592905077, 'recall': 0.26304973018386274, 'f1-score': 0.29829537126608624, 'support': 154735}, '2': {'precision': 0.3324284193001665, 'recall': 0.5998132687441646, 'f1-score': 0.4277752848023392, 'support': 147806}, 'accuracy': 0.33824091905026166, 'macro avg': {'precision': 0.3424095755819509, 'recall': 0.3402079433896708, 'f1-score': 0.31454270628831604, 'support': 452293}, 'weighted avg': {'precision': 0.34247497037325675, 'recall': 0.33824091905026166, 'f1-score': 0.3138765207223133, 'support': 452293}}
[[23625 38436 87691]
 [23687 40703 90345]
 [20120 39030 88656]]
training model: results/universal/W0/deepVOL_L2/h500
Epoch 1/50
8838/8838 - 297s - loss: 3.2814 - accuracy500: 0.3671 - val_loss: 3.3022 - val_accuracy500: 0.3386 - 297s/epoch - 34ms/step
Epoch 2/50
8838/8838 - 294s - loss: 3.2749 - accuracy500: 0.3724 - val_loss: 3.3215 - val_accuracy500: 0.3403 - 294s/epoch - 33ms/step
Epoch 3/50
8838/8838 - 289s - loss: 3.2708 - accuracy500: 0.3761 - val_loss: 3.3202 - val_accuracy500: 0.3406 - 289s/epoch - 33ms/step
Epoch 4/50
8838/8838 - 293s - loss: 3.2660 - accuracy500: 0.3799 - val_loss: 3.3315 - val_accuracy500: 0.3388 - 293s/epoch - 33ms/step
Epoch 5/50
8838/8838 - 292s - loss: 3.2614 - accuracy500: 0.3839 - val_loss: 3.3118 - val_accuracy500: 0.3401 - 292s/epoch - 33ms/step
Epoch 6/50
8838/8838 - 289s - loss: 3.2587 - accuracy500: 0.3863 - val_loss: 3.3142 - val_accuracy500: 0.3417 - 289s/epoch - 33ms/step
Epoch 7/50
8838/8838 - 291s - loss: 3.2568 - accuracy500: 0.3877 - val_loss: 3.3071 - val_accuracy500: 0.3417 - 291s/epoch - 33ms/step
Epoch 8/50
8838/8838 - 289s - loss: 3.2544 - accuracy500: 0.3891 - val_loss: 3.3053 - val_accuracy500: 0.3427 - 289s/epoch - 33ms/step
Epoch 9/50
8838/8838 - 291s - loss: 3.2514 - accuracy500: 0.3910 - val_loss: 3.3086 - val_accuracy500: 0.3435 - 291s/epoch - 33ms/step
Epoch 10/50
8838/8838 - 290s - loss: 3.2503 - accuracy500: 0.3922 - val_loss: 3.3107 - val_accuracy500: 0.3430 - 290s/epoch - 33ms/step
Epoch 11/50
8838/8838 - 289s - loss: 3.2475 - accuracy500: 0.3942 - val_loss: 3.3110 - val_accuracy500: 0.3441 - 289s/epoch - 33ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 512s - 512s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0839942
{'0': {'precision': 0.27642245795913445, 'recall': 0.016156242032298394, 'f1-score': 0.030528183590134032, 'support': 2270887}, '1': {'precision': 0.4642198409564693, 'recall': 0.8579443546659917, 'f1-score': 0.6024588976031737, 'support': 3852075}, '2': {'precision': 0.29479048848985645, 'recall': 0.1517148904137327, 'f1-score': 0.20032953137572962, 'support': 2326067}, 'accuracy': 0.43726373764369847, 'macro avg': {'precision': 0.3451442624684867, 'recall': 0.34193849570400764, 'f1-score': 0.27777220418967913, 'support': 8449029}, 'weighted avg': {'precision': 0.36709972676504854, 'recall': 0.43726373764369847, 'f1-score': 0.33802971031248014, 'support': 8449029}}
[[  36689 1876788  357410]
 [  60400 3304866  486809]
 [  35639 1937529  352899]]
Evaluating performance on  train set...
8838/8838 - 142s - 142s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003956
{'0': {'precision': 0.3398702761959865, 'recall': 0.014894062792333181, 'f1-score': 0.02853753141787629, 'support': 749359}, '1': {'precision': 0.3362017727014377, 'recall': 0.765600509107837, 'f1-score': 0.46722765525681503, 'support': 743261}, '2': {'precision': 0.3605068244281921, 'recall': 0.25144518436497665, 'f1-score': 0.2962575614775593, 'support': 769452}, 'accuracy': 0.34202138570301915, 'macro avg': {'precision': 0.3455262911085388, 'recall': 0.34397991875504896, 'f1-score': 0.26400758271741687, 'support': 2262072}, 'weighted avg': {'precision': 0.3456844933095466, 'recall': 0.34202138570301915, 'f1-score': 0.2637462129736078, 'support': 2262072}}
[[ 11161 558272 179926]
 [ 10946 569041 163274]
 [ 10732 565245 193475]]
Evaluating performance on  val set...
3279/3279 - 53s - 53s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1008795
{'0': {'precision': 0.3282226481126573, 'recall': 0.014086975180602247, 'f1-score': 0.02701451541555649, 'support': 279620}, '1': {'precision': 0.33851196288303304, 'recall': 0.7773350471293916, 'f1-score': 0.47163672127170075, 'support': 280080}, '2': {'precision': 0.340055519268452, 'recall': 0.22378276147390366, 'f1-score': 0.26993045969189694, 'support': 279177}, 'accuracy': 0.3387028134041105, 'macro avg': {'precision': 0.3355967100880474, 'recall': 0.33840159459463254, 'f1-score': 0.2561938987930514, 'support': 838877}, 'weighted avg': {'precision': 0.33559595403420256, 'recall': 0.3387028134041105, 'f1-score': 0.2563047832276729, 'support': 838877}}
[[  3939 212759  62922]
 [  4041 217716  58323]
 [  4021 212681  62475]]
testing model out of sample: results/universal/W0/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 360s - 360s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096628
{'0': {'precision': 0.35117890434175764, 'recall': 0.010562699253189426, 'f1-score': 0.020508545955250906, 'support': 2000909}, '1': {'precision': 0.3371244134289555, 'recall': 0.8135162432435432, 'f1-score': 0.4767017134811137, 'support': 1801980}, '2': {'precision': 0.40301737906438784, 'recall': 0.28277983955264685, 'f1-score': 0.3323582735391544, 'support': 2030074}, 'accuracy': 0.35336054763248115, 'macro avg': {'precision': 0.3637735656117003, 'recall': 0.3689529273497931, 'f1-score': 0.276522844325173, 'support': 5832963}, 'weighted avg': {'precision': 0.3648786360559855, 'recall': 0.35336054763248115, 'f1-score': 0.2699750671544115, 'support': 5832963}}
[[  21135 1446452  533322]
 [  19011 1465940  317029]
 [  20037 1435973  574064]]
Evaluating performance on  train set...
6334/6334 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984924
{'0': {'precision': 0.3366817100985102, 'recall': 0.012917664319467356, 'f1-score': 0.024880715652293973, 'support': 537094}, '1': {'precision': 0.34701261135073064, 'recall': 0.8661621911449305, 'f1-score': 0.49550848432420846, 'support': 544592}, '2': {'precision': 0.36964334625376616, 'recall': 0.16518488021453448, 'f1-score': 0.22833309407108138, 'support': 539214}, 'accuracy': 0.35024554259979024, 'macro avg': {'precision': 0.3511125559010024, 'recall': 0.3480882452263108, 'f1-score': 0.24957409801586128, 'support': 1620900}, 'weighted avg': {'precision': 0.35111782697960675, 'recall': 0.35024554259979024, 'f1-score': 0.2506839660522467, 'support': 1620900}}
[[  6938 444235  85921]
 [  6916 471705  65971]
 [  6753 443391  89070]]
Evaluating performance on  val set...
2156/2156 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936642
{'0': {'precision': 0.3179388789913663, 'recall': 0.013485314376391399, 'f1-score': 0.025873221216041395, 'support': 172039}, '1': {'precision': 0.3797029241944496, 'recall': 0.8851735078032871, 'f1-score': 0.5314400060431641, 'support': 202671}, '2': {'precision': 0.367462724109501, 'recall': 0.1488846110293285, 'f1-score': 0.21190985611307878, 'support': 176620}, 'accuracy': 0.37729671884352384, 'macro avg': {'precision': 0.35503484243177236, 'recall': 0.34918114440300235, 'f1-score': 0.2564076944574281, 'support': 551330}, 'weighted avg': {'precision': 0.3565086690084505, 'recall': 0.37729671884352384, 'f1-score': 0.27131880970789296, 'support': 551330}}
[[  2320 144946  24773]
 [  2780 179399  20492]
 [  2197 148127  26296]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988755
{'0': {'precision': 0.3371702637889688, 'recall': 0.010228578911376567, 'f1-score': 0.01985483096562827, 'support': 68729}, '1': {'precision': 0.3710028232925903, 'recall': 0.5458492815460877, 'f1-score': 0.4417541792772846, 'support': 79685}, '2': {'precision': 0.33742881399586, 'recall': 0.46702578524181093, 'f1-score': 0.3917883171255787, 'support': 75741}, 'accuracy': 0.35498650487385963, 'macro avg': {'precision': 0.34853396702580636, 'recall': 0.34103454856642507, 'f1-score': 0.2844657757894972, 'support': 224155}, 'weighted avg': {'precision': 0.3492847843451296, 'recall': 0.35498650487385963, 'f1-score': 0.29551080002924557, 'support': 224155}}
[[  703 34074 33952]
 [  683 43496 35506]
 [  699 39669 35373]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006403
{'0': {'precision': 0.3288590604026846, 'recall': 0.005336721728081322, 'f1-score': 0.010503000857387826, 'support': 27545}, '1': {'precision': 0.33421461383390066, 'recall': 0.3823729582577132, 'f1-score': 0.35667554270195917, 'support': 26448}, '2': {'precision': 0.3403665729781086, 'recall': 0.6313934275748119, 'f1-score': 0.4423010146996412, 'support': 27235}, 'accuracy': 0.33801152312010635, 'macro avg': {'precision': 0.33448008240489796, 'recall': 0.3397010358535355, 'f1-score': 0.26982651941966274, 'support': 81228}, 'weighted avg': {'precision': 0.3344612023012969, 'recall': 0.33801152312010635, 'f1-score': 0.2679953716371558, 'support': 81228}}
[[  147 10251 17147]
 [  156 10113 16179]
 [  144  9895 17196]]
Evaluating performance on  val set...
104/104 - 1s - 903ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038373
{'0': {'precision': 0.31645569620253167, 'recall': 0.0055666889334224, 'f1-score': 0.010940919037199126, 'support': 8982}, '1': {'precision': 0.311416117963461, 'recall': 0.3926107798433298, 'f1-score': 0.3473314025651634, 'support': 8553}, '2': {'precision': 0.3296682098765432, 'recall': 0.572337575351641, 'f1-score': 0.4183598531211751, 'support': 8958}, 'accuracy': 0.3221605707167931, 'macro avg': {'precision': 0.3191800080141786, 'recall': 0.3235050147094644, 'f1-score': 0.25887739157451256, 'support': 26493}, 'weighted avg': {'precision': 0.31929622709042754, 'recall': 0.3221605707167931, 'f1-score': 0.2573005845012438, 'support': 26493}}
[[  50 3659 5273]
 [  43 3358 5152]
 [  65 3766 5127]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
2359/2359 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117895
{'0': {'precision': 0.34646173551072684, 'recall': 0.03703558819790129, 'f1-score': 0.06691788113991881, 'support': 204506}, '1': {'precision': 0.27637745733766483, 'recall': 0.9131227917068174, 'f1-score': 0.4243236697289046, 'support': 165003}, '2': {'precision': 0.3815195518572905, 'recall': 0.059885862582647185, 'f1-score': 0.1035221893873154, 'support': 234279}, 'accuracy': 0.2853186880163236, 'macro avg': {'precision': 0.33478624823522735, 'recall': 0.3366814141624553, 'f1-score': 0.19825458008537963, 'support': 603788}, 'weighted avg': {'precision': 0.3409120955782784, 'recall': 0.2853186880163236, 'f1-score': 0.17879265848965126, 'support': 603788}}
[[  7574 182133  14799]
 [  6390 150668   7945]
 [  7897 212352  14030]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034946
{'0': {'precision': 0.3827626233313987, 'recall': 0.024947513759906188, 'f1-score': 0.04684198377044232, 'support': 52871}, '1': {'precision': 0.3157917261055635, 'recall': 0.9385652505723734, 'f1-score': 0.47257861366693, 'support': 47172}, '2': {'precision': 0.39198186711998867, 'recall': 0.05461687260668746, 'f1-score': 0.09587498484087248, 'support': 50662}, 'accuracy': 0.3208918085000498, 'macro avg': {'precision': 0.36351207218565024, 'recall': 0.3393765456463223, 'f1-score': 0.20509852742608162, 'support': 150705}, 'weighted avg': {'precision': 0.36489934185354755, 'recall': 0.3208918085000498, 'f1-score': 0.19658458159869785, 'support': 150705}}
[[ 1319 49119  2433]
 [ 1039 44274  1859]
 [ 1088 46807  2767]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105133
{'0': {'precision': 0.3840139009556907, 'recall': 0.02193548387096774, 'f1-score': 0.041500399042298484, 'support': 20150}, '1': {'precision': 0.2831727472844719, 'recall': 0.9478197849981882, 'f1-score': 0.4360655737704918, 'support': 16558}, '2': {'precision': 0.40587449933244324, 'recall': 0.04124457308248915, 'f1-score': 0.07487992117903035, 'support': 22112}, 'accuracy': 0.2898333900034002, 'macro avg': {'precision': 0.3576870491908686, 'recall': 0.336999947317215, 'f1-score': 0.18414863133060688, 'support': 58820}, 'weighted avg': {'precision': 0.3638448041998034, 'recall': 0.2898333900034002, 'f1-score': 0.1651198848742747, 'support': 58820}}
[[  442 18929   779]
 [  308 15694   556]
 [  401 20799   912]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
1625/1625 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093637
{'0': {'precision': 0.26628652886671417, 'recall': 0.014728144316891637, 'f1-score': 0.027912467220034817, 'support': 126832}, '1': {'precision': 0.38354829385125744, 'recall': 0.9018422381316107, 'f1-score': 0.5382022710635447, 'support': 154486}, '2': {'precision': 0.38751069289991447, 'recall': 0.1313209398437558, 'f1-score': 0.19616486420465903, 'support': 134533}, 'accuracy': 0.3820046122288993, 'macro avg': {'precision': 0.3457818385392953, 'recall': 0.3492971074307527, 'f1-score': 0.25409320082941284, 'support': 415851}, 'weighted avg': {'precision': 0.3490660616447541, 'recall': 0.3820046122288993, 'f1-score': 0.27191363677379543, 'support': 415851}}
[[  1868 109310  15654]
 [  2894 139322  12270]
 [  2253 114613  17667]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998794
{'0': {'precision': 0.324881822088526, 'recall': 0.0203751617076326, 'f1-score': 0.038345464228652586, 'support': 37104}, '1': {'precision': 0.3411921940421622, 'recall': 0.8658223152539678, 'f1-score': 0.4894917386940696, 'support': 37741}, '2': {'precision': 0.3736023054755043, 'recall': 0.15963551286787342, 'f1-score': 0.2236907945820033, 'support': 40605}, 'accuracy': 0.34573408401905587, 'macro avg': {'precision': 0.3465587738687308, 'recall': 0.3486109966098246, 'f1-score': 0.2505093325015752, 'support': 115450}, 'weighted avg': {'precision': 0.3473492536678282, 'recall': 0.34573408401905587, 'f1-score': 0.25101466027540104, 'support': 115450}}
[[  756 29700  6648]
 [  844 32677  4220]
 [  727 33396  6482]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989449
{'0': {'precision': 0.30739795918367346, 'recall': 0.01591179189224878, 'f1-score': 0.03025737602008789, 'support': 15146}, '1': {'precision': 0.34544123586429726, 'recall': 0.9090607147601967, 'f1-score': 0.500640204865557, 'support': 15054}, '2': {'precision': 0.3749735337709083, 'recall': 0.11867586946324465, 'f1-score': 0.18029115341545354, 'support': 14923}, 'accuracy': 0.34787137380050087, 'macro avg': {'precision': 0.3426042429396263, 'recall': 0.34788279203856337, 'f1-score': 0.2370629114336995, 'support': 45123}, 'weighted avg': {'precision': 0.34243848810939687, 'recall': 0.34787137380050087, 'f1-score': 0.23680607990747865, 'support': 45123}}
[[  241 13029  1876]
 [  293 13685  1076]
 [  250 12902  1771]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10399
{'0': {'precision': 0.38045602605863194, 'recall': 0.005809442333326702, 'f1-score': 0.011444136349830004, 'support': 100526}, '1': {'precision': 0.3305699481865285, 'recall': 0.2547317272078562, 'f1-score': 0.2877376143091553, 'support': 117716}, '2': {'precision': 0.32544007156404425, 'recall': 0.7103790766226695, 'f1-score': 0.44638259089608634, 'support': 106522}, 'accuracy': 0.32713293345321526, 'macro avg': {'precision': 0.3454886819364016, 'recall': 0.3236400820546175, 'f1-score': 0.2485214471850239, 'support': 324764}, 'weighted avg': {'precision': 0.34432887204074514, 'recall': 0.32713293345321526, 'f1-score': 0.25425022663888996, 'support': 324764}}
[[  584 30424 69518]
 [  400 29986 87330]
 [  551 30300 75671]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044521
{'0': {'precision': 0.36823104693140796, 'recall': 0.004909038406006353, 'f1-score': 0.009688909997625266, 'support': 41556}, '1': {'precision': 0.29276669454067616, 'recall': 0.23887034284461123, 'f1-score': 0.2630865638796076, 'support': 41039}, '2': {'precision': 0.32925058470133123, 'recall': 0.7130100816130581, 'f1-score': 0.45048037186165896, 'support': 41660}, 'accuracy': 0.3195927729266428, 'macro avg': {'precision': 0.33008277539113845, 'recall': 0.3189298209545586, 'f1-score': 0.24108528191296394, 'support': 124255}, 'weighted avg': {'precision': 0.3302373435450795, 'recall': 0.3195927729266428, 'f1-score': 0.24116900028709706, 'support': 124255}}
[[  204 11918 29434]
 [  157  9803 31079]
 [  193 11763 29704]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101463
{'0': {'precision': 0.2871287128712871, 'recall': 0.00401078763570984, 'f1-score': 0.007911068676259974, 'support': 14461}, '1': {'precision': 0.3204714466114775, 'recall': 0.3020364982808781, 'f1-score': 0.310981006195112, 'support': 15124}, '2': {'precision': 0.34280839557043524, 'recall': 0.6682773768434265, 'f1-score': 0.45315857784208174, 'support': 15935}, 'accuracy': 0.33556678383128297, 'macro avg': {'precision': 0.3168028516843999, 'recall': 0.32477488758667145, 'f1-score': 0.25735021757115123, 'support': 45520}, 'weighted avg': {'precision': 0.3176983800263303, 'recall': 0.33556678383128297, 'f1-score': 0.26447189454604225, 'support': 45520}}
[[   58  4484  9919]
 [   60  4568 10496]
 [   84  5202 10649]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
1733/1733 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096415
{'0': {'precision': 0.361574382921948, 'recall': 0.011296765901274881, 'f1-score': 0.02190902231324782, 'support': 143935}, '1': {'precision': 0.3466307758659151, 'recall': 0.8000151025255542, 'f1-score': 0.4836887498028538, 'support': 145671}, '2': {'precision': 0.4069448497227896, 'recall': 0.27184125375229035, 'f1-score': 0.3259477399149254, 'support': 153906}, 'accuracy': 0.3607636321001461, 'macro avg': {'precision': 0.3717166695035509, 'recall': 0.3610510407263732, 'f1-score': 0.2771818373436757, 'support': 443512}, 'weighted avg': {'precision': 0.37241047502315605, 'recall': 0.3607636321001461, 'f1-score': 0.27908650015903824, 'support': 443512}}
[[  1626 108961  33348]
 [  1508 116539  27624]
 [  1363 110705  41838]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955037
{'0': {'precision': 0.2939110070257611, 'recall': 0.008152394562904982, 'f1-score': 0.01586473887967133, 'support': 61577}, '1': {'precision': 0.36256289537635705, 'recall': 0.8607127794179671, 'f1-score': 0.5102079994285486, 'support': 66388}, '2': {'precision': 0.39796450223575563, 'recall': 0.21397070753255948, 'f1-score': 0.27830641138779116, 'support': 67799}, 'accuracy': 0.36855601642794383, 'macro avg': {'precision': 0.3514794682126246, 'recall': 0.36094529383781054, 'f1-score': 0.2681263832320037, 'support': 195764}, 'weighted avg': {'precision': 0.35322929070182907, 'recall': 0.36855601642794383, 'f1-score': 0.274399215778881, 'support': 195764}}
[[  502 47780 13295]
 [  596 57141  8651]
 [  610 52682 14507]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0940375
{'0': {'precision': 0.29491525423728815, 'recall': 0.008405797101449276, 'f1-score': 0.016345702207609208, 'support': 20700}, '1': {'precision': 0.37302843740838465, 'recall': 0.8475885957900346, 'f1-score': 0.5180570823663531, 'support': 22518}, '2': {'precision': 0.38293604875414644, 'recall': 0.23088372093023254, 'f1-score': 0.2880770681600557, 'support': 21500}, 'accuracy': 0.3743008127568837, 'macro avg': {'precision': 0.3502932467999398, 'recall': 0.36229270460723884, 'f1-score': 0.2741599509113393, 'support': 64718}, 'weighted avg': {'precision': 0.35133541154683423, 'recall': 0.3743008127568837, 'f1-score': 0.28118332429716997, 'support': 64718}}
[[  174 15732  4794]
 [  227 19086  3205]
 [  189 16347  4964]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
4693/4693 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0536386
{'0': {'precision': 0.16799549354363463, 'recall': 0.017327606627127963, 'f1-score': 0.031414970120530746, 'support': 223747}, '1': {'precision': 0.6173593207222327, 'recall': 0.9560172623896694, 'f1-score': 0.7502414540075026, 'support': 742655}, '2': {'precision': 0.22537318750222665, 'recall': 0.026943225861408068, 'f1-score': 0.04813226863071077, 'support': 234790}, 'accuracy': 0.5995660976763082, 'macro avg': {'precision': 0.336909333922698, 'recall': 0.3334293649594018, 'f1-score': 0.27659623091958135, 'support': 1201192}, 'weighted avg': {'precision': 0.45703671412940233, 'recall': 0.5995660976763082, 'f1-score': 0.47910787592433596, 'support': 1201192}}
[[  3877 214616   5254]
 [ 16175 709991  16489]
 [  3026 225438   6326]]
Evaluating performance on  train set...
1497/1497 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102865
{'0': {'precision': 0.33015050979122834, 'recall': 0.016186108510401954, 'f1-score': 0.030859295228154567, 'support': 126034}, '1': {'precision': 0.3307833213476438, 'recall': 0.9653970743143172, 'f1-score': 0.4927358132089353, 'support': 126261}, '2': {'precision': 0.40200589970501477, 'recall': 0.026036651535298883, 'f1-score': 0.04890582721472199, 'support': 130854}, 'accuracy': 0.3323485119366095, 'macro avg': {'precision': 0.35431324361462896, 'recall': 0.335873278120006, 'f1-score': 0.19083364521727064, 'support': 383149}, 'weighted avg': {'precision': 0.35489927492360024, 'recall': 0.3323485119366095, 'f1-score': 0.18922706320703916, 'support': 383149}}
[[  2040 121201   2793]
 [  2094 121892   2275]
 [  2045 125402   3407]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966637
{'0': {'precision': 0.32603938730853393, 'recall': 0.016646928697517487, 'f1-score': 0.03167651685870998, 'support': 44753}, '1': {'precision': 0.3639034472576954, 'recall': 0.9686026406790318, 'f1-score': 0.5290449974780808, 'support': 50896}, '2': {'precision': 0.3469682386910491, 'recall': 0.016318124207858047, 'f1-score': 0.031170290951536894, 'support': 44184}, 'accuracy': 0.3630330465626855, 'macro avg': {'precision': 0.3456370244190928, 'recall': 0.33385589786146913, 'f1-score': 0.19729726842944253, 'support': 139833}, 'weighted avg': {'precision': 0.3464340692838729, 'recall': 0.3630330465626855, 'f1-score': 0.21254726342154537, 'support': 139833}}
[[  745 43349   659]
 [  900 49298   698]
 [  640 42823   721]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
6677/6677 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0760511
{'0': {'precision': 0.31779456678990514, 'recall': 0.012531799626433625, 'f1-score': 0.024112745685948865, 'support': 473276}, '1': {'precision': 0.47956155512116894, 'recall': 0.9361750464666033, 'f1-score': 0.6342331767726396, 'support': 801113}, '2': {'precision': 0.3611952782249156, 'recall': 0.10525480746015724, 'f1-score': 0.16300796433232614, 'support': 434897}, 'accuracy': 0.46901922791153733, 'macro avg': {'precision': 0.38618380004532993, 'recall': 0.35132055118439803, 'f1-score': 0.27378462893030486, 'support': 1709286}, 'weighted avg': {'precision': 0.4046545051056554, 'recall': 0.46901922791153733, 'f1-score': 0.34540509981089085, 'support': 1709286}}
[[  5931 429280  38065]
 [  8239 749982  42892]
 [  4493 384629  45775]]
Evaluating performance on  train set...
2262/2262 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971806
{'0': {'precision': 0.3505886426592798, 'recall': 0.010498211415832858, 'f1-score': 0.02038597444957869, 'support': 192890}, '1': {'precision': 0.35269309748866373, 'recall': 0.8931412566653281, 'f1-score': 0.5056928399154995, 'support': 196727}, '2': {'precision': 0.37630215289278274, 'recall': 0.1489091831557585, 'f1-score': 0.2133801856928646, 'support': 189216}, 'accuracy': 0.3557260902540111, 'macro avg': {'precision': 0.35986129768024205, 'recall': 0.3508495504123064, 'f1-score': 0.2464863333526476, 'support': 578833}, 'weighted avg': {'precision': 0.35970942643899295, 'recall': 0.3557260902540111, 'f1-score': 0.24841470881186248, 'support': 578833}}
[[  2025 163248  27617]
 [  1939 175705  19083]
 [  1812 159228  28176]]
Evaluating performance on  val set...
827/827 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0838659
{'0': {'precision': 0.2555391432791728, 'recall': 0.008864672826959536, 'f1-score': 0.017134933474198557, 'support': 58547}, '1': {'precision': 0.44070313651970594, 'recall': 0.9174386353420964, 'f1-score': 0.5953989377785841, 'support': 91217}, '2': {'precision': 0.3589939412453541, 'recall': 0.11409385113268608, 'f1-score': 0.17315602706253605, 'support': 61800}, 'accuracy': 0.43133992550717515, 'macro avg': {'precision': 0.3517454070147443, 'recall': 0.3467990531005807, 'f1-score': 0.26189663277177294, 'support': 211564}, 'weighted avg': {'precision': 0.3655938335182103, 'recall': 0.43133992550717515, 'f1-score': 0.3120320391462051, 'support': 211564}}
[[  519 52063  5965]
 [  906 83686  6625]
 [  606 54143  7051]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
5633/5633 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0810497
{'0': {'precision': 0.2813085704549327, 'recall': 0.008631100190814752, 'f1-score': 0.01674832871765219, 'support': 382570}, '1': {'precision': 0.4524690007213333, 'recall': 0.9599749257072467, 'f1-score': 0.6150458609009529, 'support': 639699}, '2': {'precision': 0.36420760903864885, 'recall': 0.06327029184989215, 'f1-score': 0.10781152274739467, 'support': 419565}, 'accuracy': 0.44661382655701004, 'macro avg': {'precision': 0.36599506007163823, 'recall': 0.3439587725826512, 'f1-score': 0.24653523745533326, 'support': 1441834}, 'weighted avg': {'precision': 0.3813704993623957, 'recall': 0.44661382655701004, 'f1-score': 0.3086940464932173, 'support': 1441834}}
[[  3302 353881  25387]
 [  4650 614095  20954]
 [  3786 389233  26546]]
Evaluating performance on  train set...
1454/1454 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09903
{'0': {'precision': 0.36339907192575405, 'recall': 0.010193456012756057, 'f1-score': 0.019830656010128987, 'support': 122922}, '1': {'precision': 0.3419371517384655, 'recall': 0.8945292765999054, 'f1-score': 0.4947530898971348, 'support': 122726}, '2': {'precision': 0.3895730015970413, 'recall': 0.14661478722310534, 'f1-score': 0.2130490993191025, 'support': 126447}, 'accuracy': 0.34822827503728887, 'macro avg': {'precision': 0.36496974175375363, 'recall': 0.35044583994525563, 'f1-score': 0.2425442817421221, 'support': 372095}, 'weighted avg': {'precision': 0.36521495031229534, 'recall': 0.34822827503728887, 'f1-score': 0.24213201217537292, 'support': 372095}}
[[  1253 104547  17122]
 [  1017 109782  11927]
 [  1178 106730  18539]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052005
{'0': {'precision': 0.3558967201674808, 'recall': 0.010232539475532192, 'f1-score': 0.01989312322034559, 'support': 49841}, '1': {'precision': 0.306602002253134, 'recall': 0.8967773597251758, 'f1-score': 0.4569693361119381, 'support': 42791}, '2': {'precision': 0.3690498767305139, 'recall': 0.11727837039715543, 'f1-score': 0.17799323150096039, 'support': 49779}, 'accuracy': 0.3140347304632367, 'macro avg': {'precision': 0.3438495330503762, 'recall': 0.3414294231992878, 'f1-score': 0.21828523027774802, 'support': 142411}, 'weighted avg': {'precision': 0.3456824860583067, 'recall': 0.3140347304632367, 'f1-score': 0.20648680991550855, 'support': 142411}}
[[  510 43354  5977]
 [  413 38374  4004]
 [  510 43431  5838]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
11876/11876 - 86s - 86s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084548
{'0': {'precision': 0.39024915631507145, 'recall': 0.009148776614144665, 'f1-score': 0.017878421797529753, 'support': 1188137}, '1': {'precision': 0.21167171335809645, 'recall': 0.6703127893402037, 'f1-score': 0.3217431965559618, 'support': 621025}, '2': {'precision': 0.4152093872827948, 'recall': 0.35269947855275036, 'f1-score': 0.3814101930585369, 'support': 1230997}, 'accuracy': 0.28331511608438903, 'macro avg': {'precision': 0.33904341898532087, 'recall': 0.34405368150236626, 'f1-score': 0.2403439371373428, 'support': 3040159}, 'weighted avg': {'precision': 0.3638771517351199, 'recall': 0.28331511608438903, 'f1-score': 0.22714844404680726, 'support': 3040159}}
[[ 10870 764905 412362]
 [  5608 416281 199136]
 [ 11376 785449 434172]]
Evaluating performance on  train set...
2538/2538 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999601
{'0': {'precision': 0.34251781472684084, 'recall': 0.016538366257145217, 'f1-score': 0.03155319623812379, 'support': 217978}, '1': {'precision': 0.33931940852453113, 'recall': 0.9021022790029822, 'f1-score': 0.49314558431723776, 'support': 217288}, '2': {'precision': 0.36727118809624587, 'recall': 0.10524400654975999, 'f1-score': 0.16360570734448937, 'support': 214359}, 'accuracy': 0.3420142389840293, 'macro avg': {'precision': 0.3497028037825393, 'recall': 0.34129488393662916, 'f1-score': 0.22943482929995032, 'support': 649625}, 'weighted avg': {'precision': 0.3496159606959843, 'recall': 0.3420142389840293, 'f1-score': 0.22952145646392164, 'support': 649625}}
[[  3605 193316  21057]
 [  3463 196016  17809]
 [  3457 188342  22560]]
Evaluating performance on  val set...
795/795 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011142
{'0': {'precision': 0.3414837454848569, 'recall': 0.017898753349644646, 'f1-score': 0.03401464096425556, 'support': 68664}, '1': {'precision': 0.32949556862420276, 'recall': 0.9133769076520382, 'f1-score': 0.4842872447488881, 'support': 65329}, '2': {'precision': 0.3931049204824421, 'recall': 0.1060787165713792, 'f1-score': 0.1670730462592286, 'support': 69439}, 'accuracy': 0.33556667584254196, 'macro avg': {'precision': 0.35469474486383396, 'recall': 0.345784792524354, 'f1-score': 0.22845831065745745, 'support': 203432}, 'weighted avg': {'precision': 0.35525418064022896, 'recall': 0.33556667584254196, 'f1-score': 0.22403047690906214, 'support': 203432}}
[[ 1229 60469  6966]
 [ 1253 59670  4406]
 [ 1117 60956  7366]]
testing model on single stock: results/universal/W0/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
19053/19053 - 163s - 163s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0875847
{'0': {'precision': 0.28391536814319, 'recall': 0.015506002774471917, 'f1-score': 0.0294060004645035, 'support': 1359538}, '1': {'precision': 0.4526487189256, 'recall': 0.823034455386872, 'f1-score': 0.584072126001473, 'support': 2187002}, '2': {'precision': 0.2783482831410927, 'recall': 0.17288759353555572, 'f1-score': 0.21329405450401054, 'support': 1330911}, 'accuracy': 0.4205387199174323, 'macro avg': {'precision': 0.3383041234032942, 'recall': 0.33714268389896657, 'f1-score': 0.27559072698999565, 'support': 4877451}, 'weighted avg': {'precision': 0.3580546841425934, 'recall': 0.4205387199174323, 'f1-score': 0.32829051202010445, 'support': 4877451}}
[[  21081 1096145  242312]
 [  32779 1799978  354245]
 [  20391 1080422  230098]]
Evaluating performance on  train set...
4812/4812 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993412
{'0': {'precision': 0.3256899771736875, 'recall': 0.015463968313397837, 'f1-score': 0.029526022217414617, 'support': 405976}, '1': {'precision': 0.341437809236258, 'recall': 0.697623275206064, 'f1-score': 0.4584811544288063, 'support': 406063}, '2': {'precision': 0.3617295202479846, 'recall': 0.329934330405951, 'f1-score': 0.3451011266187982, 'support': 419829}, 'accuracy': 0.347499082693925, 'macro avg': {'precision': 0.3429524355526434, 'recall': 0.34767385797513767, 'f1-score': 0.2777027677550064, 'support': 1231868}, 'weighted avg': {'precision': 0.34316348672192043, 'recall': 0.347499082693925, 'f1-score': 0.27847346492790215, 'support': 1231868}}
[[  6278 271505 128193]
 [  6566 283279 116218]
 [  6432 274881 138516]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995839
{'0': {'precision': 0.32446116013308257, 'recall': 0.014912076588106239, 'f1-score': 0.02851367842977728, 'support': 150415}, '1': {'precision': 0.35103867725020077, 'recall': 0.7091997336970222, 'f1-score': 0.4696236881302539, 'support': 154711}, '2': {'precision': 0.3359910856127512, 'recall': 0.3032337412599292, 'f1-score': 0.31877308151121847, 'support': 147167}, 'accuracy': 0.3462136270072718, 'macro avg': {'precision': 0.3371636409986782, 'recall': 0.34244851718168584, 'f1-score': 0.27230348269041654, 'support': 452293}, 'weighted avg': {'precision': 0.33730385014547026, 'recall': 0.3462136270072718, 'f1-score': 0.27384397601133814, 'support': 452293}}
[[  2243 102573  45599]
 [  2396 109721  42594]
 [  2274 100267  44626]]
training model: results/universal/W0/deepVOL_L2/h1000
Epoch 1/50
8838/8838 - 292s - loss: 3.2734 - accuracy1000: 0.3722 - val_loss: 3.2981 - val_accuracy1000: 0.3334 - 292s/epoch - 33ms/step
Epoch 2/50
8838/8838 - 293s - loss: 3.2850 - accuracy1000: 0.3608 - val_loss: 3.2978 - val_accuracy1000: 0.3329 - 293s/epoch - 33ms/step
Epoch 3/50
8838/8838 - 290s - loss: 3.2829 - accuracy1000: 0.3627 - val_loss: 3.3003 - val_accuracy1000: 0.3360 - 290s/epoch - 33ms/step
Epoch 4/50
8838/8838 - 292s - loss: 3.2778 - accuracy1000: 0.3672 - val_loss: 3.3055 - val_accuracy1000: 0.3339 - 292s/epoch - 33ms/step
Epoch 5/50
8838/8838 - 290s - loss: 3.2831 - accuracy1000: 0.3638 - val_loss: 3.3026 - val_accuracy1000: 0.3371 - 290s/epoch - 33ms/step
Epoch 6/50
8838/8838 - 294s - loss: 3.2768 - accuracy1000: 0.3711 - val_loss: 3.3051 - val_accuracy1000: 0.3385 - 294s/epoch - 33ms/step
Epoch 7/50
8838/8838 - 291s - loss: 3.2760 - accuracy1000: 0.3743 - val_loss: 3.2982 - val_accuracy1000: 0.3381 - 291s/epoch - 33ms/step
Epoch 8/50
8838/8838 - 291s - loss: 3.2715 - accuracy1000: 0.3759 - val_loss: 3.3024 - val_accuracy1000: 0.3380 - 291s/epoch - 33ms/step
Epoch 9/50
8838/8838 - 290s - loss: 3.2686 - accuracy1000: 0.3802 - val_loss: 3.3012 - val_accuracy1000: 0.3420 - 290s/epoch - 33ms/step
Epoch 10/50
8838/8838 - 295s - loss: 3.2648 - accuracy1000: 0.3838 - val_loss: 3.3027 - val_accuracy1000: 0.3408 - 295s/epoch - 33ms/step
Epoch 11/50
8838/8838 - 295s - loss: 3.2612 - accuracy1000: 0.3872 - val_loss: 3.3014 - val_accuracy1000: 0.3415 - 295s/epoch - 33ms/step
Epoch 12/50
8838/8838 - 290s - loss: 3.2569 - accuracy1000: 0.3911 - val_loss: 3.3034 - val_accuracy1000: 0.3414 - 290s/epoch - 33ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 525s - 525s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100244
{'0': {'precision': 0.26392987108953886, 'recall': 0.20777269992549235, 'f1-score': 0.23250847155341536, 'support': 2258829}, '1': {'precision': 0.4712701234320623, 'recall': 0.01933449403982353, 'f1-score': 0.03714506169794156, 'support': 3894180}, '2': {'precision': 0.2746240470436891, 'recall': 0.7787789304971211, 'f1-score': 0.40605813008951663, 'support': 2296020}, 'accuracy': 0.27609172604331217, 'macro avg': {'precision': 0.3366080138550968, 'recall': 0.33529537482081234, 'f1-score': 0.22523722111362451, 'support': 8449029}, 'weighted avg': {'precision': 0.3623996840989931, 'recall': 0.27609172604331217, 'f1-score': 0.18962700003770278, 'support': 8449029}}
[[ 469323   41109 1748397]
 [ 844323   75292 2974565]
 [ 464565   43363 1788092]]
Evaluating performance on  train set...
8838/8838 - 148s - 148s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.09849
{'0': {'precision': 0.3301563397863951, 'recall': 0.2007977922124875, 'f1-score': 0.2497189874556, 'support': 746811}, '1': {'precision': 0.34041270450248007, 'recall': 0.016612704131510777, 'f1-score': 0.03167940099358353, 'support': 747741}, '2': {'precision': 0.3428297065900107, 'recall': 0.7912249843652283, 'f1-score': 0.47838156554536654, 'support': 767520}, 'accuracy': 0.3402460222309458, 'macro avg': {'precision': 0.3377995836262953, 'recall': 0.33621182690307555, 'f1-score': 0.25325998466485, 'support': 2262072}, 'weighted avg': {'precision': 0.3378467081293484, 'recall': 0.3402460222309458, 'f1-score': 0.2552298480801791, 'support': 2262072}}
[[149958  12033 584820]
 [156042  12422 579277]
 [148203  12036 607281]]
Evaluating performance on  val set...
3279/3279 - 52s - 52s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098749
{'0': {'precision': 0.33407571161346594, 'recall': 0.21753153976939893, 'f1-score': 0.2634918368627247, 'support': 279964}, '1': {'precision': 0.3472620412844037, 'recall': 0.017105876371647673, 'f1-score': 0.03260562337644858, 'support': 283236}, '2': {'precision': 0.3328410837996477, 'recall': 0.7758826452696452, 'f1-score': 0.4658430477891333, 'support': 275677}, 'accuracy': 0.3333492275983249, 'macro avg': {'precision': 0.33805961223250575, 'recall': 0.3368400204702306, 'f1-score': 0.25398016934276885, 'support': 838877}, 'weighted avg': {'precision': 0.3381221746573303, 'recall': 0.3333492275983249, 'f1-score': 0.25203400360655087, 'support': 838877}}
[[ 60901   4629 214434]
 [ 64090   4845 214301]
 [ 57306   4478 213893]]
testing model out of sample: results/universal/W0/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 373s - 373s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981573
{'0': {'precision': 0.3151021221648623, 'recall': 0.31024560164876525, 'f1-score': 0.31265500376547484, 'support': 1926290}, '1': {'precision': 0.3762916131581547, 'recall': 0.01944770200884367, 'f1-score': 0.03698397849624185, 'support': 1958689}, '2': {'precision': 0.34991025080753413, 'recall': 0.6888927219114737, 'f1-score': 0.46409305986599614, 'support': 1947984}, 'accuracy': 0.33905015341259664, 'macro avg': {'precision': 0.3471013287101837, 'recall': 0.3395286751896942, 'f1-score': 0.2712440140425709, 'support': 5832963}, 'weighted avg': {'precision': 0.3472739121436479, 'recall': 0.33905015341259664, 'f1-score': 0.2706600700519144, 'support': 5832963}}
[[ 597623   31761 1296906]
 [ 724323   38092 1196274]
 [ 574655   31377 1341952]]
Evaluating performance on  train set...
6334/6334 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987493
{'0': {'precision': 0.3174195232501572, 'recall': 0.24991312016322198, 'f1-score': 0.279650058487357, 'support': 535222}, '1': {'precision': 0.356467646520705, 'recall': 0.02131760681142215, 'f1-score': 0.040229400499340116, 'support': 548373}, '2': {'precision': 0.33716490201943755, 'recall': 0.7321242125050018, 'f1-score': 0.4617022375376757, 'support': 537305}, 'accuracy': 0.33242211117280523, 'macro avg': {'precision': 0.33701735726343324, 'recall': 0.3344516464932153, 'f1-score': 0.26052723217479096, 'support': 1620900}, 'weighted avg': {'precision': 0.3371753547276501, 'recall': 0.33242211117280523, 'f1-score': 0.2589983968066665, 'support': 1620900}}
[[133759  10516 390947]
 [154293  11690 382390]
 [133343  10588 393374]]
Evaluating performance on  val set...
2156/2156 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985879
{'0': {'precision': 0.316272304482906, 'recall': 0.2777149131160581, 'f1-score': 0.2957421741010842, 'support': 178514}, '1': {'precision': 0.36936859333275907, 'recall': 0.02271992709277127, 'f1-score': 0.04280680037136497, 'support': 188733}, '2': {'precision': 0.3402224717340784, 'recall': 0.7078057180728259, 'f1-score': 0.45955139995732314, 'support': 184083}, 'accuracy': 0.3340268079008942, 'macro avg': {'precision': 0.34195445651658113, 'recall': 0.3360801860938851, 'f1-score': 0.26603345814325746, 'support': 551330}, 'weighted avg': {'precision': 0.34244508761024695, 'recall': 0.3340268079008942, 'f1-score': 0.26385064241074074, 'support': 551330}}
[[ 49576   3597 125341]
 [ 57111   4288 127334]
 [ 50064   3724 130295]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990545
{'0': {'precision': 0.3017757733774928, 'recall': 0.12394541481556517, 'f1-score': 0.17571934143714418, 'support': 69103}, '1': {'precision': 0.32857845548450565, 'recall': 0.00858943037160859, 'f1-score': 0.01674122526722053, 'support': 77770}, '2': {'precision': 0.3381077733044286, 'recall': 0.8476100514997024, 'f1-score': 0.48339249212241076, 'support': 77282}, 'accuracy': 0.3334210702415739, 'macro avg': {'precision': 0.322820667388809, 'recall': 0.326714965562292, 'f1-score': 0.2252843529422585, 'support': 224155}, 'weighted avg': {'precision': 0.3236010915984374, 'recall': 0.3334210702415739, 'f1-score': 0.22663887629794946, 'support': 224155}}
[[ 8565   604 59934]
 [ 8801   668 68301]
 [11016   761 65505]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992322
{'0': {'precision': 0.3448014713837499, 'recall': 0.11727690892364305, 'f1-score': 0.17502334010654072, 'support': 27175}, '1': {'precision': 0.3317384370015949, 'recall': 0.00759845108497114, 'f1-score': 0.014856612263847718, 'support': 27374}, '2': {'precision': 0.3302783149751955, 'recall': 0.8833914314629484, 'f1-score': 0.4807980660362925, 'support': 26679}, 'accuracy': 0.3319421874230561, 'macro avg': {'precision': 0.3356060744535134, 'recall': 0.33608893049052085, 'f1-score': 0.22355933946889364, 'support': 81228}, 'weighted avg': {'precision': 0.3356291318825812, 'recall': 0.3319421874230561, 'f1-score': 0.22147727108002238, 'support': 81228}}
[[ 3187   215 23773]
 [ 3149   208 24017]
 [ 2907   204 23568]]
Evaluating performance on  val set...
104/104 - 1s - 937ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987114
{'0': {'precision': 0.34670592565329406, 'recall': 0.10468993109579906, 'f1-score': 0.16081946222791293, 'support': 8998}, '1': {'precision': 0.2594594594594595, 'recall': 0.005933984423290889, 'f1-score': 0.011602610587382161, 'support': 8089}, '2': {'precision': 0.3511932516637701, 'recall': 0.8808207527110355, 'f1-score': 0.5021668636542715, 'support': 9406}, 'accuracy': 0.3500924772581437, 'macro avg': {'precision': 0.31911954559217454, 'recall': 0.3304815560767085, 'f1-score': 0.22486297882318887, 'support': 26493}, 'weighted avg': {'precision': 0.32166048434474503, 'recall': 0.3500924772581437, 'f1-score': 0.23645070613747682, 'support': 26493}}
[[ 942   65 7991]
 [ 726   48 7315]
 [1049   72 8285]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
2359/2359 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968795
{'0': {'precision': 0.3223661083294538, 'recall': 0.5573258869908015, 'f1-score': 0.40846791426146517, 'support': 182640}, '1': {'precision': 0.3763799362821368, 'recall': 0.022426968871543797, 'f1-score': 0.042331569517936755, 'support': 226513}, '2': {'precision': 0.3702446345052671, 'recall': 0.5222287872170986, 'f1-score': 0.43329560689477303, 'support': 194635}, 'accuracy': 0.345343067434265, 'macro avg': {'precision': 0.3563302263722859, 'recall': 0.3673272143598147, 'f1-score': 0.2946983635580583, 'support': 603788}, 'weighted avg': {'precision': 0.35806352390126955, 'recall': 0.345343067434265, 'f1-score': 0.2791140617483199, 'support': 603788}}
[[101790   3843  77007]
 [125552   5080  95881]
 [ 88417   4574 101644]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979884
{'0': {'precision': 0.35666800804828974, 'recall': 0.42931044504291554, 'f1-score': 0.38963231285937855, 'support': 51613}, '1': {'precision': 0.34673366834170855, 'recall': 0.023190984578884934, 'f1-score': 0.04347423234438411, 'support': 50580}, '2': {'precision': 0.33539913377231595, 'recall': 0.589029518469657, 'f1-score': 0.4274207420592481, 'support': 48512}, 'accuracy': 0.34442122026475563, 'macro avg': {'precision': 0.3462669367207714, 'recall': 0.34717698269715247, 'f1-score': 0.28684242908767027, 'support': 150705}, 'weighted avg': {'precision': 0.34648736021819176, 'recall': 0.34442122026475563, 'f1-score': 0.28561795742920476, 'support': 150705}}
[[22158  1152 28303]
 [21088  1173 28319]
 [18879  1058 28575]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097931
{'0': {'precision': 0.3351806413402149, 'recall': 0.4017137352329767, 'f1-score': 0.36544360139295673, 'support': 19723}, '1': {'precision': 0.31054545454545457, 'recall': 0.023287521815008726, 'f1-score': 0.043326061589975144, 'support': 18336}, '2': {'precision': 0.36749785547371844, 'recall': 0.5984297480853523, 'f1-score': 0.4553584518399062, 'support': 20761}, 'accuracy': 0.3531791907514451, 'macro avg': {'precision': 0.337741317119796, 'recall': 0.34114366837777926, 'f1-score': 0.288042704940946, 'support': 58820}, 'weighted avg': {'precision': 0.3389077222235359, 'recall': 0.3531791907514451, 'f1-score': 0.2967658557333452, 'support': 58820}}
[[ 7923   433 11367]
 [ 7893   427 10016]
 [ 7822   515 12424]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
1625/1625 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990086
{'0': {'precision': 0.26592450978733484, 'recall': 0.4103059413177404, 'f1-score': 0.3227018426320382, 'support': 114924}, '1': {'precision': 0.4587772116720704, 'recall': 0.02224767808811473, 'f1-score': 0.04243742033611465, 'support': 178086}, '2': {'precision': 0.312635388483388, 'recall': 0.5850896687588021, 'f1-score': 0.4075183919939898, 'support': 122841}, 'accuracy': 0.295752565221678, 'macro avg': {'precision': 0.34577903664759774, 'recall': 0.33921442938821905, 'f1-score': 0.25755255165404756, 'support': 415851}, 'weighted avg': {'precision': 0.36231090135005056, 'recall': 0.295752565221678, 'f1-score': 0.22773460636515333, 'support': 415851}}
[[47154  2227 65543]
 [81646  3962 92478]
 [48521  2447 71873]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986046
{'0': {'precision': 0.31963280505759073, 'recall': 0.4930533290584589, 'f1-score': 0.38783981169151877, 'support': 37428}, '1': {'precision': 0.31865736704446385, 'recall': 0.020002736352442194, 'f1-score': 0.037642575761476865, 'support': 36545}, '2': {'precision': 0.36926435827574383, 'recall': 0.4934059840393471, 'f1-score': 0.4224029391731511, 'support': 41477}, 'accuracy': 0.3434387180597661, 'macro avg': {'precision': 0.3358515101259328, 'recall': 0.33548734981674944, 'f1-score': 0.2826284422087156, 'support': 115450}, 'weighted avg': {'precision': 0.3371548540020655, 'recall': 0.3434387180597661, 'f1-score': 0.2894042712107243, 'support': 115450}}
[[18454   759 18215]
 [19073   731 16741]
 [20208   804 20465]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980978
{'0': {'precision': 0.3474722910723472, 'recall': 0.47966429954809553, 'f1-score': 0.4030049087408131, 'support': 15490}, '1': {'precision': 0.376101860920666, 'recall': 0.026117118955315242, 'f1-score': 0.048842533706436014, 'support': 14703}, '2': {'precision': 0.34596593159910205, 'recall': 0.5264567983924984, 'f1-score': 0.4175409705437063, 'support': 14930}, 'accuracy': 0.34736165591826784, 'macro avg': {'precision': 0.3565133611973718, 'recall': 0.34407940563196976, 'f1-score': 0.2897961376636518, 'support': 45123}, 'weighted avg': {'precision': 0.3563026130488178, 'recall': 0.34736165591826784, 'f1-score': 0.29241328146839657, 'support': 45123}}
[[7430  336 7724]
 [7184  384 7135]
 [6769  301 7860]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997396
{'0': {'precision': 0.42481703260146375, 'recall': 0.013147599044559756, 'f1-score': 0.02550582219825434, 'support': 97128}, '1': {'precision': 0.37122557726465366, 'recall': 0.0016666135051513508, 'f1-score': 0.0033183294037327235, 'support': 125404}, '2': {'precision': 0.315297560671866, 'recall': 0.9906095938649346, 'f1-score': 0.4783445552598204, 'support': 102232}, 'accuracy': 0.31640822258624723, 'macro avg': {'precision': 0.37044672351266117, 'recall': 0.3351412688048819, 'f1-score': 0.16905623562060249, 'support': 324764}, 'weighted avg': {'precision': 0.3696478096599925, 'recall': 0.31640822258624723, 'f1-score': 0.15948683306136058, 'support': 324764}}
[[  1277    199  95652]
 [   924    209 124271]
 [   805    155 101272]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990164
{'0': {'precision': 0.3171428571428571, 'recall': 0.008007887649095807, 'f1-score': 0.015621335084674203, 'support': 41584}, '1': {'precision': 0.32642487046632124, 'recall': 0.0015347137637028016, 'f1-score': 0.003055063889629756, 'support': 41050}, '2': {'precision': 0.334690924462654, 'recall': 0.9891881502126331, 'f1-score': 0.500154889967382, 'support': 41621}, 'accuracy': 0.3345297975936582, 'macro avg': {'precision': 0.32608621735727744, 'recall': 0.33291025054181056, 'f1-score': 0.172943762980562, 'support': 124255}, 'weighted avg': {'precision': 0.32608732422140907, 'recall': 0.3345297975936582, 'f1-score': 0.17377131420194597, 'support': 124255}}
[[  333    60 41191]
 [  337    63 40650]
 [  380    70 41171]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980456
{'0': {'precision': 0.33651551312649164, 'recall': 0.010029162813855894, 'f1-score': 0.019477828429341072, 'support': 14059}, '1': {'precision': 0.32432432432432434, 'recall': 0.001548586914440573, 'f1-score': 0.0030824556896994603, 'support': 15498}, '2': {'precision': 0.3505896462122726, 'recall': 0.9889118586731818, 'f1-score': 0.5176586325627152, 'support': 15963}, 'accuracy': 0.35041739894551843, 'macro avg': {'precision': 0.33714316122102955, 'recall': 0.33349653613382607, 'f1-score': 0.1800729722272519, 'support': 45520}, 'weighted avg': {'precision': 0.33730036247605955, 'recall': 0.35041739894551843, 'f1-score': 0.1885983180967858, 'support': 45520}}
[[  141    20 13898]
 [  131    24 15343]
 [  147    30 15786]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
1733/1733 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097359
{'0': {'precision': 0.33294368505454097, 'recall': 0.40321261142056325, 'f1-score': 0.3647244297159036, 'support': 140571}, '1': {'precision': 0.3392857142857143, 'recall': 0.019759032847339576, 'f1-score': 0.03734329844252067, 'support': 146161}, '2': {'precision': 0.37318562779261294, 'recall': 0.630214313050134, 'f1-score': 0.46878002376992983, 'support': 156780}, 'accuracy': 0.3570884215083245, 'macro avg': {'precision': 0.34847167571095605, 'recall': 0.35106198577267894, 'f1-score': 0.290282583976118, 'support': 443512}, 'weighted avg': {'precision': 0.3492591153403787, 'recall': 0.3570884215083245, 'f1-score': 0.2936180842455247, 'support': 443512}}
[[56680  2709 81182]
 [58499  2888 84774]
 [55060  2915 98805]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983127
{'0': {'precision': 0.2944685876955225, 'recall': 0.32055846767546897, 'f1-score': 0.30696015216207473, 'support': 60666}, '1': {'precision': 0.35738922791191297, 'recall': 0.02044812824483104, 'f1-score': 0.038682997573338304, 'support': 65874}, '2': {'precision': 0.3627911777315528, 'recall': 0.6601034323356062, 'f1-score': 0.4682392482759327, 'support': 69224}, 'accuracy': 0.3396385443697513, 'macro avg': {'precision': 0.33821633111299604, 'recall': 0.3337033427519687, 'f1-score': 0.2712941326704486, 'support': 195764}, 'weighted avg': {'precision': 0.339800708137834, 'recall': 0.3396385443697513, 'f1-score': 0.27371550487251833, 'support': 195764}}
[[19447  1115 40104]
 [24372  1347 40155]
 [22222  1307 45695]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983145
{'0': {'precision': 0.3195454545454545, 'recall': 0.3715109296180639, 'f1-score': 0.3435743641008553, 'support': 20815}, '1': {'precision': 0.3682611996962794, 'recall': 0.021654685895432423, 'f1-score': 0.04090410727840094, 'support': 22397}, '2': {'precision': 0.3453228233973623, 'recall': 0.6294522458848694, 'f1-score': 0.4459782232691452, 'support': 21506}, 'accuracy': 0.3361506845081739, 'macro avg': {'precision': 0.34437649254636543, 'recall': 0.3408726204661219, 'f1-score': 0.2768188982161338, 'support': 64718}, 'weighted avg': {'precision': 0.3449704466445947, 'recall': 0.3361506845081739, 'f1-score': 0.27285820558577034, 'support': 64718}}
[[ 7733   406 12676]
 [ 8924   485 12988]
 [ 7543   426 13537]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
4693/4693 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984188
{'0': {'precision': 0.2599991093009227, 'recall': 0.42171380539922904, 'f1-score': 0.32167562450222653, 'support': 304562}, '1': {'precision': 0.49417354178036016, 'recall': 0.02653428825055373, 'f1-score': 0.05036430200259771, 'support': 580155}, '2': {'precision': 0.2895419992988653, 'recall': 0.618513310688048, 'f1-score': 0.3944376044057462, 'support': 316475}, 'accuracy': 0.28269918547576073, 'macro avg': {'precision': 0.3479048834600494, 'recall': 0.35558713477927695, 'f1-score': 0.2554925103035235, 'support': 1201192}, 'weighted avg': {'precision': 0.38088490773048844, 'recall': 0.28269918547576073, 'f1-score': 0.20980735305619144, 'support': 1201192}}
[[128438   7740 168384]
 [252842  15394 311919]
 [112714   8017 195744]]
Evaluating performance on  train set...
1497/1497 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985025
{'0': {'precision': 0.32316014928925085, 'recall': 0.44209314328820426, 'f1-score': 0.3733845710185167, 'support': 125935}, '1': {'precision': 0.33614259420711035, 'recall': 0.027420642132962456, 'f1-score': 0.050705048586249725, 'support': 126547}, '2': {'precision': 0.35229850954658104, 'recall': 0.5406950492473234, 'f1-score': 0.4266235922828417, 'support': 130667}, 'accuracy': 0.33876116080167246, 'macro avg': {'precision': 0.3372004176809808, 'recall': 0.33673627822283003, 'f1-score': 0.2835710706292027, 'support': 383149}, 'weighted avg': {'precision': 0.33738519379351667, 'recall': 0.33876116080167246, 'f1-score': 0.2849658557571157, 'support': 383149}}
[[55675  3360 66900]
 [60085  3470 62992]
 [56523  3493 70651]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984919
{'0': {'precision': 0.32634432481276704, 'recall': 0.45420245987253, 'f1-score': 0.3798014366433168, 'support': 46913}, '1': {'precision': 0.3408179631114675, 'recall': 0.027252906976744186, 'f1-score': 0.05047006432459178, 'support': 46784}, '2': {'precision': 0.34230709473297644, 'recall': 0.5252947806485174, 'f1-score': 0.4145037841535896, 'support': 46136}, 'accuracy': 0.33481367059277856, 'macro avg': {'precision': 0.3364897942190703, 'recall': 0.33558338249926384, 'f1-score': 0.2815917617071661, 'support': 139833}, 'weighted avg': {'precision': 0.33645347678122356, 'recall': 0.33481367059277856, 'f1-score': 0.28106643547889004, 'support': 139833}}
[[21308  1238 24367]
 [23312  1275 22197]
 [20673  1228 24235]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
6677/6677 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998158
{'0': {'precision': 0.26221750487256473, 'recall': 0.42816948138834865, 'f1-score': 0.32524811535135756, 'support': 458127}, '1': {'precision': 0.5008757018492762, 'recall': 0.023115114386950842, 'f1-score': 0.04419084756123195, 'support': 841311}, '2': {'precision': 0.24931645262219831, 'recall': 0.5611055806054928, 'f1-score': 0.3452345744992276, 'support': 409848}, 'accuracy': 0.26067668020448304, 'macro avg': {'precision': 0.33746988644801307, 'recall': 0.3374633921269308, 'f1-score': 0.23822451247060572, 'support': 1709286}, 'weighted avg': {'precision': 0.376591749963185, 'recall': 0.26067668020448304, 'f1-score': 0.19170395673018933, 'support': 1709286}}
[[196156  10409 251562]
 [381000  19447 440864]
 [170910   8970 229968]]
Evaluating performance on  train set...
2262/2262 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098584
{'0': {'precision': 0.3256179907227996, 'recall': 0.286735089578863, 'f1-score': 0.30494205628032944, 'support': 193405}, '1': {'precision': 0.3635835752799668, 'recall': 0.022468857333264983, 'f1-score': 0.04232226916113458, 'support': 195070}, '2': {'precision': 0.3375430047317816, 'recall': 0.703017472341588, 'f1-score': 0.4560977189149764, 'support': 190358}, 'accuracy': 0.33457663954888545, 'macro avg': {'precision': 0.3422481902448493, 'recall': 0.33740713975123865, 'f1-score': 0.2677873481188135, 'support': 578833}, 'weighted avg': {'precision': 0.34233432928036006, 'recall': 0.33457663954888545, 'f1-score': 0.2661475296283673, 'support': 578833}}
[[ 55456   3836 134113]
 [ 62157   4383 128530]
 [ 52697   3836 133825]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982541
{'0': {'precision': 0.3051531128669195, 'recall': 0.3071857653410387, 'f1-score': 0.3061660654197108, 'support': 65755}, '1': {'precision': 0.3694856896922746, 'recall': 0.022638275430153603, 'f1-score': 0.042662624857128656, 'support': 75845}, '2': {'precision': 0.3447031067905972, 'recall': 0.6933279972557315, 'f1-score': 0.46047235722964763, 'support': 69964}, 'accuracy': 0.3328732676636857, 'macro avg': {'precision': 0.33978063644993045, 'recall': 0.341050679342308, 'f1-score': 0.2697670158354957, 'support': 211564}, 'weighted avg': {'precision': 0.3412952734622724, 'recall': 0.3328732676636857, 'f1-score': 0.26272988039164075, 'support': 211564}}
[[20199  1447 44109]
 [26021  1717 48107]
 [19973  1483 48508]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
5633/5633 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997841
{'0': {'precision': 0.24387708163270733, 'recall': 0.23016580048231955, 'f1-score': 0.2368231475719682, 'support': 398491}, '1': {'precision': 0.4265528230413084, 'recall': 0.024007052537001285, 'f1-score': 0.04545578329368607, 'support': 590993}, '2': {'precision': 0.31023307844666026, 'recall': 0.7081043439814303, 'f1-score': 0.43144322433132304, 'support': 452350}, 'accuracy': 0.2956082322930379, 'macro avg': {'precision': 0.3268876610402253, 'recall': 0.32075906566691703, 'f1-score': 0.2379073850656591, 'support': 1441834}, 'weighted avg': {'precision': 0.33957202265995806, 'recall': 0.2956082322930379, 'f1-score': 0.21944224172925633, 'support': 1441834}}
[[ 91719   8731 298041]
 [162672  14188 414133]
 [121696  10343 320311]]
Evaluating performance on  train set...
1454/1454 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983717
{'0': {'precision': 0.32803593369186457, 'recall': 0.26544316588975453, 'f1-score': 0.29343879784866805, 'support': 122708}, '1': {'precision': 0.3400528291394411, 'recall': 0.01992051340521875, 'f1-score': 0.037636269916372395, 'support': 122788}, '2': {'precision': 0.3459007258817505, 'recall': 0.7257087338762549, 'f1-score': 0.46849750259429324, 'support': 126599}, 'accuracy': 0.34102043832892137, 'macro avg': {'precision': 0.3379964962376854, 'recall': 0.3370241377237428, 'f1-score': 0.2665241901197779, 'support': 372095}, 'weighted avg': {'precision': 0.3380795929312104, 'recall': 0.34102043832892137, 'f1-score': 0.26858701581005073, 'support': 372095}}
[[32572  2350 87786]
 [34394  2446 85948]
 [32328  2397 91874]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098055
{'0': {'precision': 0.3594384499361875, 'recall': 0.31733349722410015, 'f1-score': 0.33707620664142407, 'support': 48813}, '1': {'precision': 0.3472081218274112, 'recall': 0.022167487684729065, 'f1-score': 0.04167428258088102, 'support': 46284}, '2': {'precision': 0.3427112628553045, 'recall': 0.6979752293190177, 'f1-score': 0.45970419349225683, 'support': 47314}, 'accuracy': 0.3478663867257445, 'macro avg': {'precision': 0.3497859448729677, 'recall': 0.34582540474261564, 'f1-score': 0.2794848942381873, 'support': 142411}, 'weighted avg': {'precision': 0.34990619023903274, 'recall': 0.3478663867257445, 'f1-score': 0.28181107906449626, 'support': 142411}}
[[15490   957 32366]
 [14287  1026 30971]
 [13318   972 33024]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
11876/11876 - 101s - 101s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971404
{'0': {'precision': 0.37468894970787475, 'recall': 0.25320292243991377, 'f1-score': 0.3021932319252746, 'support': 1143565}, '1': {'precision': 0.25503247501036436, 'recall': 0.015478898066850164, 'f1-score': 0.029186363881973543, 'support': 715361}, '2': {'precision': 0.393791064211702, 'recall': 0.7414066488152634, 'f1-score': 0.5143761476969413, 'support': 1181233}, 'accuracy': 0.3869537744571912, 'macro avg': {'precision': 0.34117082964331374, 'recall': 0.3366961564406758, 'f1-score': 0.2819185811680631, 'support': 3040159}, 'weighted avg': {'precision': 0.3539553211791083, 'recall': 0.3869537744571912, 'f1-score': 0.3203958969883155, 'support': 3040159}}
[[289554  15846 838165]
 [194271  11073 510017]
 [288960  16499 875774]]
Evaluating performance on  train set...
2538/2538 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990232
{'0': {'precision': 0.3153351574346246, 'recall': 0.17190184162402794, 'f1-score': 0.22250647794212142, 'support': 216548}, '1': {'precision': 0.3607110236773695, 'recall': 0.022969889490403114, 'f1-score': 0.04318949453821984, 'support': 223510}, '2': {'precision': 0.32805701439857116, 'recall': 0.8098507875762883, 'f1-score': 0.4669573950007566, 'support': 209567}, 'accuracy': 0.3264606503752165, 'macro avg': {'precision': 0.33470106517018844, 'recall': 0.3349075062302398, 'f1-score': 0.24421778916036596, 'support': 649625}, 'weighted avg': {'precision': 0.3350512109459262, 'recall': 0.3264606503752165, 'f1-score': 0.2396697742663407, 'support': 649625}}
[[ 37225   4633 174690]
 [ 45441   5134 172935]
 [ 35383   4466 169718]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099098
{'0': {'precision': 0.3175352129125692, 'recall': 0.20152395635673626, 'f1-score': 0.2465651554862289, 'support': 67456}, '1': {'precision': 0.3544585279074939, 'recall': 0.023545399488914164, 'f1-score': 0.044157571056568236, 'support': 67699}, '2': {'precision': 0.33323512080141426, 'recall': 0.761984269959137, 'f1-score': 0.4636877732273921, 'support': 68277}, 'accuracy': 0.3304003303315113, 'macro avg': {'precision': 0.33507628720715915, 'recall': 0.3290178752682625, 'f1-score': 0.2514701665900631, 'support': 203432}, 'weighted avg': {'precision': 0.3350920088579863, 'recall': 0.3304003303315113, 'f1-score': 0.25207898769163317, 'support': 203432}}
[[13594  1438 52424]
 [14431  1594 51674]
 [14786  1465 52026]]
testing model on single stock: results/universal/W0/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
19053/19053 - 192s - 192s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012752
{'0': {'precision': 0.24821303837728964, 'recall': 0.11473517407414374, 'f1-score': 0.1569301910778868, 'support': 1276008}, '1': {'precision': 0.49770850182584614, 'recall': 0.017129493930070874, 'f1-score': 0.03311913584953201, 'support': 2371115}, '2': {'precision': 0.2540631671246217, 'recall': 0.8685439980232913, 'f1-score': 0.3931295751097474, 'support': 1230328}, 'accuracy': 0.25743221203042327, 'macro avg': {'precision': 0.33332823577591913, 'recall': 0.333469555342502, 'f1-score': 0.1943929673457221, 'support': 4877451}, 'weighted avg': {'precision': 0.37097798527604303, 'recall': 0.25743221203042327, 'f1-score': 0.15632177195473632, 'support': 4877451}}
[[ 146403   20787 1108818]
 [ 301894   40616 2028605]
 [ 141531   20203 1068594]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985597
{'0': {'precision': 0.328713964321856, 'recall': 0.09705386311612436, 'f1-score': 0.149860830441911, 'support': 404971}, '1': {'precision': 0.34033032835428045, 'recall': 0.012714614431529884, 'f1-score': 0.024513416735193957, 'support': 406776}, '2': {'precision': 0.34159084570076437, 'recall': 0.892028725057781, 'f1-score': 0.4940078024126974, 'support': 420121}, 'accuracy': 0.3403254244772979, 'macro avg': {'precision': 0.3368783794589669, 'recall': 0.33393240086847836, 'f1-score': 0.22279401652993414, 'support': 1231868}, 'weighted avg': {'precision': 0.33694139321638195, 'recall': 0.3403254244772979, 'f1-score': 0.22583897944275785, 'support': 1231868}}
[[ 39304   4983 360684]
 [ 39946   5172 361658]
 [ 40319   5042 374760]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992591
{'0': {'precision': 0.32119452342064403, 'recall': 0.10587148402190674, 'f1-score': 0.1592509835090403, 'support': 150456}, '1': {'precision': 0.36393499308437066, 'recall': 0.013464761344301303, 'f1-score': 0.025968738819871943, 'support': 156334}, '2': {'precision': 0.32345886787128764, 'recall': 0.8823598138869989, 'f1-score': 0.4733831226413529, 'support': 145503}, 'accuracy': 0.3237282027358372, 'macro avg': {'precision': 0.33619612812543415, 'recall': 0.3338986864177356, 'f1-score': 0.21953428165675504, 'support': 452293}, 'weighted avg': {'precision': 0.3366961064542329, 'recall': 0.3237282027358372, 'f1-score': 0.21423883916661723, 'support': 452293}}
[[ 15929   1905 132622]
 [ 18321   2105 135908]
 [ 15343   1774 128386]]
training model: results/universal/W0/deepVOL_L3/h300
Epoch 1/50
8838/8838 - 513s - loss: 3.2844 - accuracy300: 0.3638 - val_loss: 3.2937 - val_accuracy300: 0.3479 - 513s/epoch - 58ms/step
Epoch 2/50
8838/8838 - 515s - loss: 3.2793 - accuracy300: 0.3673 - val_loss: 3.2902 - val_accuracy300: 0.3565 - 515s/epoch - 58ms/step
Epoch 3/50
8838/8838 - 512s - loss: 3.2772 - accuracy300: 0.3710 - val_loss: 3.2879 - val_accuracy300: 0.3581 - 512s/epoch - 58ms/step
Epoch 4/50
8838/8838 - 512s - loss: 3.2717 - accuracy300: 0.3757 - val_loss: 3.2900 - val_accuracy300: 0.3533 - 512s/epoch - 58ms/step
Epoch 5/50
8838/8838 - 563s - loss: 3.2670 - accuracy300: 0.3801 - val_loss: 3.2931 - val_accuracy300: 0.3456 - 563s/epoch - 64ms/step
Epoch 6/50
8838/8838 - 514s - loss: 3.2588 - accuracy300: 0.3876 - val_loss: 3.3075 - val_accuracy300: 0.3404 - 514s/epoch - 58ms/step
Epoch 7/50
8838/8838 - 527s - loss: 3.2515 - accuracy300: 0.3931 - val_loss: 3.3065 - val_accuracy300: 0.3394 - 527s/epoch - 60ms/step
Epoch 8/50
8838/8838 - 527s - loss: 3.2464 - accuracy300: 0.3964 - val_loss: 3.3118 - val_accuracy300: 0.3428 - 527s/epoch - 60ms/step
Epoch 9/50
8838/8838 - 512s - loss: 3.2429 - accuracy300: 0.3981 - val_loss: 3.3140 - val_accuracy300: 0.3406 - 512s/epoch - 58ms/step
Epoch 10/50
8838/8838 - 509s - loss: 3.2399 - accuracy300: 0.4000 - val_loss: 3.3085 - val_accuracy300: 0.3452 - 509s/epoch - 58ms/step
Epoch 11/50
8838/8838 - 510s - loss: 3.2372 - accuracy300: 0.4019 - val_loss: 3.3042 - val_accuracy300: 0.3442 - 510s/epoch - 58ms/step
Epoch 12/50
8838/8838 - 503s - loss: 3.2333 - accuracy300: 0.4042 - val_loss: 3.3160 - val_accuracy300: 0.3436 - 503s/epoch - 57ms/step
Epoch 13/50
8838/8838 - 509s - loss: 3.2304 - accuracy300: 0.4052 - val_loss: 3.3058 - val_accuracy300: 0.3441 - 509s/epoch - 58ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1014s - 1014s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970889
{'0': {'precision': 0.31049374829641113, 'recall': 0.4364716847650989, 'f1-score': 0.3628594401551252, 'support': 2377554}, '1': {'precision': 0.4325519997145813, 'recall': 0.0033223592806560535, 'f1-score': 0.006594070612140671, 'support': 3649214}, '2': {'precision': 0.31084582925345816, 'recall': 0.6517551163974485, 'f1-score': 0.42093322376647974, 'support': 2422261}, 'accuracy': 0.3111103062848997, 'macro avg': {'precision': 0.35129719242148355, 'recall': 0.3638497201477345, 'f1-score': 0.26346224484458186, 'support': 8449029}, 'weighted avg': {'precision': 0.36331277778036775, 'recall': 0.3111103062848997, 'f1-score': 0.22563435629197245, 'support': 8449029}}
[[1037735    7549 1332270]
 [1469290   12124 2167800]
 [ 835184    8356 1578721]]
Evaluating performance on  train set...
8838/8838 - 278s - 278s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096239
{'0': {'precision': 0.3534151508095614, 'recall': 0.415378310222793, 'f1-score': 0.38189967941007524, 'support': 749081}, '1': {'precision': 0.3237131806010116, 'recall': 0.0029103204027369853, 'f1-score': 0.005768777024572976, 'support': 747684}, '2': {'precision': 0.3550153279973235, 'recall': 0.6378133219740575, 'f1-score': 0.45613813764985456, 'support': 765307}, 'accuracy': 0.35429950947626776, 'macro avg': {'precision': 0.3440478864692988, 'recall': 0.3520339841998625, 'f1-score': 0.28126886469483425, 'support': 2262072}, 'weighted avg': {'precision': 0.34413911490514515, 'recall': 0.35429950947626776, 'f1-score': 0.2826933562430447, 'support': 2262072}}
[[311152   2188 435741]
 [294437   2176 451071]
 [274826   2358 488123]]
Evaluating performance on  val set...
3279/3279 - 101s - 101s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958369
{'0': {'precision': 0.3617515378509773, 'recall': 0.4151810178562532, 'f1-score': 0.3866291110927015, 'support': 281022}, '1': {'precision': 0.3251410153102337, 'recall': 0.0029348762951459982, 'f1-score': 0.005817243405141809, 'support': 274969}, '2': {'precision': 0.35485835829115314, 'recall': 0.6446059543420317, 'f1-score': 0.4577328230957398, 'support': 282886}, 'accuracy': 0.357420694571433, 'macro avg': {'precision': 0.34725030381745475, 'recall': 0.35424061616447694, 'f1-score': 0.283393059197861, 'support': 838877}, 'weighted avg': {'precision': 0.34742674081223845, 'recall': 0.35742069457143294, 'f1-score': 0.28578332109906823, 'support': 838877}}
[[116675    790 163557]
 [106202    807 167960]
 [ 99651    885 182350]]
testing model out of sample: results/universal/W0/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 726s - 726s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937649
{'0': {'precision': 0.3767557241445339, 'recall': 0.4613451466121829, 'f1-score': 0.41478163514017835, 'support': 1995946}, '1': {'precision': 0.3175263263800389, 'recall': 0.0025763293347802283, 'f1-score': 0.005111187768130869, 'support': 1837498}, '2': {'precision': 0.3703833784284837, 'recall': 0.6249828083654119, 'f1-score': 0.4651217754698245, 'support': 1999519}, 'accuracy': 0.37291836070278517, 'macro avg': {'precision': 0.35488847631768544, 'recall': 0.36296809477079167, 'f1-score': 0.29500486612604454, 'support': 5832963}, 'weighted avg': {'precision': 0.3559128821331453, 'recall': 0.37291836070278517, 'f1-score': 0.302983812892129, 'support': 5832963}}
[[ 920820    4881 1070245]
 [ 778697    4734 1054067]
 [ 744560    5294 1249665]]
Evaluating performance on  train set...
6334/6334 - 213s - 213s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956837
{'0': {'precision': 0.36587689655323813, 'recall': 0.45581529339476606, 'f1-score': 0.4059239870816683, 'support': 548459}, '1': {'precision': 0.3088204916339599, 'recall': 0.002844400811272579, 'f1-score': 0.005636882935703715, 'support': 525594}, '2': {'precision': 0.36034005874911557, 'recall': 0.6146472413673294, 'f1-score': 0.45432801645279525, 'support': 546847}, 'accuracy': 0.3625202048244802, 'macro avg': {'precision': 0.3450124823121046, 'recall': 0.357768978524456, 'f1-score': 0.2886296288233891, 'support': 1620900}, 'weighted avg': {'precision': 0.34550777616961537, 'recall': 0.3625202048244802, 'f1-score': 0.29245683798734945, 'support': 1620900}}
[[249996   1623 296840]
 [224277   1495 299822]
 [209006   1723 336118]]
Evaluating performance on  val set...
2156/2156 - 68s - 68s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956594
{'0': {'precision': 0.3556980033686001, 'recall': 0.4788157279255978, 'f1-score': 0.4081749455230375, 'support': 181715}, '1': {'precision': 0.344180225281602, 'recall': 0.002969441744951949, 'f1-score': 0.005888083589375756, 'support': 185220}, '2': {'precision': 0.36026809124278975, 'recall': 0.5961387239350308, 'f1-score': 0.44911800455552947, 'support': 184395}, 'accuracy': 0.3581938222117425, 'macro avg': {'precision': 0.3533821066309973, 'recall': 0.3593079645351935, 'f1-score': 0.2877270112226476, 'support': 551330}, 'weighted avg': {'precision': 0.3533570795957008, 'recall': 0.3581938222117425, 'f1-score': 0.28671977856847947, 'support': 551330}}
[[ 87008    486  94221]
 [ 83696    550 100974]
 [ 73908    562 109925]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004852
{'0': {'precision': 0.2918199670451211, 'recall': 0.4020055970149254, 'f1-score': 0.3381635562298105, 'support': 64320}, '1': {'precision': 0.4369602763385147, 'recall': 0.0027469544635295652, 'f1-score': 0.0054595871861546595, 'support': 92102}, '2': {'precision': 0.30531229162036005, 'recall': 0.608388820811126, 'f1-score': 0.4065850036753279, 'support': 67733}, 'accuracy': 0.300318975708773, 'macro avg': {'precision': 0.3446975116679986, 'recall': 0.3377137907631937, 'f1-score': 0.25006938236376436, 'support': 224155}, 'weighted avg': {'precision': 0.35553297093526315, 'recall': 0.300318975708773, 'f1-score': 0.22213531212625912, 'support': 224155}}
[[25857   146 38317]
 [36404   253 55445]
 [26345   180 41208]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977805
{'0': {'precision': 0.3522864210058984, 'recall': 0.3971897457899818, 'f1-score': 0.3733929381711846, 'support': 27969}, '1': {'precision': 0.3034188034188034, 'recall': 0.002750445494692802, 'f1-score': 0.0054514742014742015, 'support': 25814}, '2': {'precision': 0.3449251920744036, 'recall': 0.6216068500637639, 'f1-score': 0.44366426110135887, 'support': 27445}, 'accuracy': 0.3476633673117644, 'macro avg': {'precision': 0.3335434721663684, 'recall': 0.3405156804494795, 'f1-score': 0.27416955782467256, 'support': 81228}, 'weighted avg': {'precision': 0.33426926425677067, 'recall': 0.3476633673117644, 'f1-score': 0.28020531206817245, 'support': 81228}}
[[11109    84 16776]
 [10119    71 15624]
 [10306    79 17060]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004187
{'0': {'precision': 0.31620872777649506, 'recall': 0.3312371508042085, 'f1-score': 0.3235485204654185, 'support': 8269}, '1': {'precision': 0.36619718309859156, 'recall': 0.0025896414342629482, 'f1-score': 0.00514291365839185, 'support': 10040}, '2': {'precision': 0.29870495495495497, 'recall': 0.6482160312805474, 'f1-score': 0.40895775516497074, 'support': 8184}, 'accuracy': 0.30460876457932284, 'macro avg': {'precision': 0.32703695527668053, 'recall': 0.3273476078396729, 'f1-score': 0.24588306309626037, 'support': 26493}, 'weighted avg': {'precision': 0.32974563241781035, 'recall': 0.30460876457932284, 'f1-score': 0.22926689454304608, 'support': 26493}}
[[2739   28 5502]
 [3061   26 6953]
 [2862   17 5305]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0903944
{'0': {'precision': 0.3627342800804669, 'recall': 0.4855728980584336, 'f1-score': 0.4152598024461652, 'support': 187529}, '1': {'precision': 0.3152077807250221, 'recall': 0.0037213720536963192, 'f1-score': 0.007355899679146591, 'support': 191596}, '2': {'precision': 0.4066466756635691, 'recall': 0.6343990777297552, 'f1-score': 0.49560987144312646, 'support': 224663}, 'accuracy': 0.3880467978827006, 'macro avg': {'precision': 0.36152957882301934, 'recall': 0.3745644492806284, 'f1-score': 0.3060751911894794, 'support': 603788}, 'weighted avg': {'precision': 0.3639923431065302, 'recall': 0.3880467978827006, 'f1-score': 0.3157197840895808, 'support': 603788}}
[[ 91059    618  95852]
 [ 78770    713 112113]
 [ 81206    931 142526]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907605
{'0': {'precision': 0.37681018563514435, 'recall': 0.6103829653245169, 'f1-score': 0.4659645749139913, 'support': 50814}, '1': {'precision': 0.2993762993762994, 'recall': 0.002841469671257745, 'f1-score': 0.005629508004456693, 'support': 50678}, '2': {'precision': 0.3770173165272706, 'recall': 0.5202690346046777, 'f1-score': 0.4372081109925294, 'support': 49213}, 'accuracy': 0.37665638167280446, 'macro avg': {'precision': 0.35106793384623813, 'recall': 0.37783115653348415, 'f1-score': 0.30293406463699246, 'support': 150705}, 'weighted avg': {'precision': 0.3508389109247397, 'recall': 0.37665638167280446, 'f1-score': 0.301775912428949, 'support': 150705}}
[[31016   165 19633]
 [27859   144 22675]
 [23437   172 25604]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0897218
{'0': {'precision': 0.38718632823766946, 'recall': 0.5455422910845822, 'f1-score': 0.45292170135593934, 'support': 19685}, '1': {'precision': 0.24761904761904763, 'recall': 0.0029758498340391438, 'f1-score': 0.005881022393123728, 'support': 17474}, '2': {'precision': 0.4144263781822893, 'recall': 0.5906929504639675, 'f1-score': 0.4871038355382126, 'support': 21661}, 'accuracy': 0.4009860591635498, 'macro avg': {'precision': 0.34974391801300214, 'recall': 0.37973703046086293, 'f1-score': 0.3153021864290919, 'support': 58820}, 'weighted avg': {'precision': 0.3557556594229909, 'recall': 0.4009860591635498, 'f1-score': 0.3327046048636915, 'support': 58820}}
[[10739    74  8872]
 [ 8215    52  9207]
 [ 8782    84 12795]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972732
{'0': {'precision': 0.30688720106995176, 'recall': 0.4295540613648659, 'f1-score': 0.3580045017158766, 'support': 116451}, '1': {'precision': 0.40466278101582015, 'recall': 0.0027762068788237107, 'f1-score': 0.005514580733008056, 'support': 175059}, '2': {'precision': 0.31828477421200707, 'recall': 0.6441720751803508, 'f1-score': 0.42605580423039796, 'support': 124341}, 'accuracy': 0.3140668172013534, 'macro avg': {'precision': 0.34327825209925966, 'recall': 0.3588341144746801, 'f1-score': 0.2631916288930942, 'support': 415851}, 'weighted avg': {'precision': 0.35145528168488377, 'recall': 0.3140668172013534, 'f1-score': 0.2299659348460557, 'support': 415851}}
[[ 50022    345  66084]
 [ 69102    486 105471]
 [ 43874    370  80097]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983297
{'0': {'precision': 0.33729118579085327, 'recall': 0.4602428933671427, 'f1-score': 0.38928962488852775, 'support': 37465}, '1': {'precision': 0.3215434083601286, 'recall': 0.002617595476795016, 'f1-score': 0.005192916861401049, 'support': 38203}, '2': {'precision': 0.35895152850024215, 'recall': 0.5776230455985119, 'f1-score': 0.44275956415765083, 'support': 39782}, 'accuracy': 0.34925941966219143, 'macro avg': {'precision': 0.3392620408837413, 'recall': 0.3468278448141498, 'f1-score': 0.2790807019691932, 'support': 115450}, 'weighted avg': {'precision': 0.3395439308101598, 'recall': 0.34925941966219143, 'f1-score': 0.28061482703009494, 'support': 115450}}
[[17243    92 20130]
 [17195   100 20908]
 [16684   119 22979]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975456
{'0': {'precision': 0.3601824495931167, 'recall': 0.44956977421233096, 'f1-score': 0.3999424460431654, 'support': 15457}, '1': {'precision': 0.3146853146853147, 'recall': 0.003043831168831169, 'f1-score': 0.006029342801634622, 'support': 14784}, '2': {'precision': 0.34301397594113753, 'recall': 0.5920575191506517, 'f1-score': 0.4343710715078015, 'support': 14882}, 'accuracy': 0.3502648316822906, 'macro avg': {'precision': 0.33929391340652293, 'recall': 0.3482237081772713, 'f1-score': 0.28011428678420053, 'support': 45123}, 'weighted avg': {'precision': 0.33961354089099804, 'recall': 0.3502648316822906, 'f1-score': 0.282236519704977, 'support': 45123}}
[[6949   44 8464]
 [6327   45 8412]
 [6017   54 8811]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099731
{'0': {'precision': 0.3009338150092018, 'recall': 0.26245652970841465, 'f1-score': 0.28038125076075504, 'support': 100931}, '1': {'precision': 0.34619883040935673, 'recall': 0.002530433593215702, 'f1-score': 0.005024144749683869, 'support': 116976}, '2': {'precision': 0.3326818804237694, 'recall': 0.7343833347370785, 'f1-score': 0.45792145649763666, 'support': 106857}, 'accuracy': 0.3241122784545085, 'macro avg': {'precision': 0.3266048419474426, 'recall': 0.3331234326795696, 'f1-score': 0.24777561733602518, 'support': 324764}, 'weighted avg': {'precision': 0.32768377334033755, 'recall': 0.3241122784545085, 'f1-score': 0.23961700636074426, 'support': 324764}}
[[26490   279 74162]
 [33433   296 83247]
 [28103   280 78474]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992445
{'0': {'precision': 0.320524068550038, 'recall': 0.2658967951672772, 'f1-score': 0.2906660655324679, 'support': 41219}, '1': {'precision': 0.2988165680473373, 'recall': 0.0024620935107990834, 'f1-score': 0.004883945841392651, 'support': 41022}, '2': {'precision': 0.3369815989211239, 'recall': 0.7196410720236112, 'f1-score': 0.45902062442593955, 'support': 42014}, 'accuracy': 0.3323487988410929, 'macro avg': {'precision': 0.3187740785061664, 'recall': 0.3293333202338958, 'f1-score': 0.25152354526660003, 'support': 124255}, 'weighted avg': {'precision': 0.31892221426159095, 'recall': 0.3323487988410929, 'f1-score': 0.25324217372435576, 'support': 124255}}
[[10960   122 30137]
 [11570   101 29351]
 [11664   115 30235]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982407
{'0': {'precision': 0.3299414907148308, 'recall': 0.26541609822646656, 'f1-score': 0.29418213435149126, 'support': 14660}, '1': {'precision': 0.2782608695652174, 'recall': 0.0021560436598841125, 'f1-score': 0.0042789329410978134, 'support': 14842}, '2': {'precision': 0.3525526597643699, 'recall': 0.7397927331751779, 'f1-score': 0.47753374974813617, 'support': 16018}, 'accuracy': 0.3465070298769772, 'macro avg': {'precision': 0.32025167334813937, 'recall': 0.33578829168717617, 'f1-score': 0.25866493901357507, 'support': 45520}, 'weighted avg': {'precision': 0.32104742056397306, 'recall': 0.3465070298769772, 'f1-score': 0.26417736414258086, 'support': 45520}}
[[ 3891    44 10725]
 [ 3773    32 11037]
 [ 4129    39 11850]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966651
{'0': {'precision': 0.34712490974729243, 'recall': 0.4066035182679296, 'f1-score': 0.3745174106099556, 'support': 147800}, '1': {'precision': 0.2945990180032733, 'recall': 0.0025810892196506926, 'f1-score': 0.005117343530114146, 'support': 139476}, '2': {'precision': 0.36902643360020804, 'recall': 0.6357625643257636, 'f1-score': 0.4669899694641056, 'support': 156236}, 'accuracy': 0.3602721008676203, 'macro avg': {'precision': 0.3369167871169246, 'recall': 0.34831572393778126, 'f1-score': 0.28220824120139176, 'support': 443512}, 'weighted avg': {'precision': 0.3383217774843442, 'recall': 0.3602721008676203, 'f1-score': 0.290923503227763, 'support': 443512}}
[[60096   408 87296]
 [56576   360 82540]
 [56453   454 99329]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973442
{'0': {'precision': 0.33841735973776177, 'recall': 0.3944738296360622, 'f1-score': 0.3643018059069269, 'support': 63335}, '1': {'precision': 0.32247557003257327, 'recall': 0.0030559799972218363, 'f1-score': 0.006054582982952373, 'support': 64791}, '2': {'precision': 0.3575384919719099, 'recall': 0.6413258819007067, 'f1-score': 0.4591187646193414, 'support': 67638}, 'accuracy': 0.3502176089577246, 'macro avg': {'precision': 0.33947714058074824, 'recall': 0.34628523051133026, 'f1-score': 0.27649171783640686, 'support': 195764}, 'weighted avg': {'precision': 0.3397476893451688, 'recall': 0.3502176089577246, 'f1-score': 0.2784945769624992, 'support': 195764}}
[[24984   198 38153]
 [24800   198 39793]
 [24042   218 43378]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983686
{'0': {'precision': 0.33477017449330626, 'recall': 0.3833048595292331, 'f1-score': 0.3573972875506095, 'support': 21072}, '1': {'precision': 0.313953488372093, 'recall': 0.0024608093328472476, 'f1-score': 0.0048833423765599565, 'support': 21944}, '2': {'precision': 0.3509488112026522, 'recall': 0.6536263938807483, 'f1-score': 0.4566893643051464, 'support': 21702}, 'accuracy': 0.3448190611576378, 'macro avg': {'precision': 0.33322415802268385, 'recall': 0.3464640209142762, 'f1-score': 0.2729899980774386, 'support': 64718}, 'weighted avg': {'precision': 0.3331370494527043, 'recall': 0.3448190611576378, 'f1-score': 0.2711658007436565, 'support': 64718}}
[[ 8077    62 12933]
 [ 8589    54 13301]
 [ 7461    56 14185]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
4693/4693 - 70s - 70s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0887134
{'0': {'precision': 0.36663456795922683, 'recall': 0.6176989656345875, 'f1-score': 0.4601484876116212, 'support': 379073}, '1': {'precision': 0.3523558677202224, 'recall': 0.0027867532010628546, 'f1-score': 0.005529771896909252, 'support': 432044}, '2': {'precision': 0.3843772356560309, 'recall': 0.5509530218547715, 'f1-score': 0.4528321367053134, 'support': 390075}, 'accuracy': 0.3748526463712712, 'macro avg': {'precision': 0.3677892237784934, 'recall': 0.39047958023014057, 'f1-score': 0.3061701320712813, 'support': 1201192}, 'weighted avg': {'precision': 0.3672605664139038, 'recall': 0.37485264637127114, 'f1-score': 0.29425559622371233, 'support': 1201192}}
[[234153    955 143965]
 [230598   1204 200242]
 [173904   1258 214913]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0894307
{'0': {'precision': 0.3828228067832821, 'recall': 0.565305864908351, 'f1-score': 0.4565033931716203, 'support': 126788}, '1': {'precision': 0.34146341463414637, 'recall': 0.003210577508560222, 'f1-score': 0.0063613430894818475, 'support': 126457}, '2': {'precision': 0.38868719028423243, 'recall': 0.5826687399926099, 'f1-score': 0.4663087306207818, 'support': 129904}, 'accuracy': 0.38567502459878533, 'macro avg': {'precision': 0.370991137233887, 'recall': 0.38372839413650706, 'f1-score': 0.309724488960628, 'support': 383149}, 'weighted avg': {'precision': 0.3711605610807074, 'recall': 0.38567502459878533, 'f1-score': 0.3112600004673692, 'support': 383149}}
[[71674   333 54781]
 [61788   406 64263]
 [53763   450 75691]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0872678
{'0': {'precision': 0.4040873686256335, 'recall': 0.5603375002591372, 'f1-score': 0.4695550961555165, 'support': 48237}, '1': {'precision': 0.335632183908046, 'recall': 0.003357479590663447, 'f1-score': 0.006648451730418943, 'support': 43485}, '2': {'precision': 0.3992056158545836, 'recall': 0.6016503502317557, 'f1-score': 0.4799535732051069, 'support': 48111}, 'accuracy': 0.40134303061509086, 'macro avg': {'precision': 0.3796417227960877, 'recall': 0.3884484433605188, 'f1-score': 0.31871904036368076, 'support': 139833}, 'weighted avg': {'precision': 0.3811196877848286, 'recall': 0.40134303061509086, 'f1-score': 0.32917897389902107, 'support': 139833}}
[[27029   133 21075]
 [20851   146 22488]
 [19009   156 28946]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
6677/6677 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926607
{'0': {'precision': 0.3662370580840343, 'recall': 0.5290848653866385, 'f1-score': 0.4328509768304293, 'support': 541811}, '1': {'precision': 0.3859968174585133, 'recall': 0.0024916760703715063, 'f1-score': 0.004951390063394122, 'support': 681469}, '2': {'precision': 0.320900191832428, 'recall': 0.608883429422682, 'f1-score': 0.420293076450558, 'support': 486006}, 'accuracy': 0.3418286933842552, 'macro avg': {'precision': 0.35771135579165847, 'recall': 0.380153323626564, 'f1-score': 0.28603181444812714, 'support': 1709286}, 'weighted avg': {'precision': 0.3612242483153289, 'recall': 0.3418286933842552, 'f1-score': 0.25868262909543094, 'support': 1709286}}
[[286664   1317 253830]
 [307363   1698 372408]
 [188701   1384 295921]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943682
{'0': {'precision': 0.37567582242838415, 'recall': 0.48964962920649685, 'f1-score': 0.4251568627881305, 'support': 197819}, '1': {'precision': 0.3264705882352941, 'recall': 0.002966122075964791, 'f1-score': 0.005878832495643837, 'support': 187113}, '2': {'precision': 0.3648398523014479, 'recall': 0.6007859680971217, 'f1-score': 0.4539867498051442, 'support': 193901}, 'accuracy': 0.36955391278658956, 'macro avg': {'precision': 0.35566208765504204, 'recall': 0.36446723979319445, 'f1-score': 0.2950074816963062, 'support': 578833}, 'weighted avg': {'precision': 0.3561398864517645, 'recall': 0.36955391278658956, 'f1-score': 0.2992790601064726, 'support': 578833}}
[[ 96862    558 100399]
 [ 84151    555 102407]
 [ 76821    587 116493]]
Evaluating performance on  val set...
827/827 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093108
{'0': {'precision': 0.36150524367674275, 'recall': 0.5309367236592138, 'f1-score': 0.4301375701465679, 'support': 68430}, '1': {'precision': 0.3616298811544992, 'recall': 0.002924819773429454, 'f1-score': 0.005802707930367504, 'support': 72825}, '2': {'precision': 0.3717559946774325, 'recall': 0.5841215207156979, 'f1-score': 0.45434833113916206, 'support': 70309}, 'accuracy': 0.3668582556578624, 'macro avg': {'precision': 0.36496370650289145, 'recall': 0.37266102138278034, 'f1-score': 0.2967628697386992, 'support': 211564}, 'weighted avg': {'precision': 0.3649547756218048, 'recall': 0.3668582556578624, 'f1-score': 0.2921180963879582, 'support': 211564}}
[[36332   164 31934]
 [35142   213 37470]
 [29028   212 41069]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
5633/5633 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969559
{'0': {'precision': 0.27827006871124516, 'recall': 0.44770183544214914, 'f1-score': 0.34321444066329554, 'support': 356045}, '1': {'precision': 0.49074243813015583, 'recall': 0.0037852810963599367, 'f1-score': 0.007512614569476951, 'support': 707213}, '2': {'precision': 0.28988346899473916, 'recall': 0.6612357888508517, 'f1-score': 0.40306475284653775, 'support': 378576}, 'accuracy': 0.28602945970201843, 'macro avg': {'precision': 0.3529653252787133, 'recall': 0.3709076351297869, 'f1-score': 0.25126393602643676, 'support': 1441834}, 'weighted avg': {'precision': 0.38553607604605633, 'recall': 0.28602945970201843, 'f1-score': 0.1942688590275423, 'support': 1441834}}
[[159402   1295 195348]
 [286665   2677 417871]
 [126765   1483 250328]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961227
{'0': {'precision': 0.36258773600304695, 'recall': 0.3787531868595833, 'f1-score': 0.3704942120207295, 'support': 123162}, '1': {'precision': 0.338958180484226, 'recall': 0.0037597962222999863, 'f1-score': 0.007437098565702419, 'support': 122879}, '2': {'precision': 0.3559581789415852, 'recall': 0.6835959192092278, 'f1-score': 0.4681460233122268, 'support': 126054}, 'accuracy': 0.358188097125734, 'macro avg': {'precision': 0.3525013651429527, 'recall': 0.355369634097037, 'f1-score': 0.2820257779662196, 'support': 372095}, 'weighted avg': {'precision': 0.352538532604929, 'recall': 0.358188097125734, 'f1-score': 0.2836811841012416, 'support': 372095}}
[[46648   444 76070]
 [42578   462 79839]
 [39427   457 86170]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954671
{'0': {'precision': 0.3748312528895053, 'recall': 0.41630381202760436, 'f1-score': 0.3944805036832323, 'support': 48688}, '1': {'precision': 0.3319838056680162, 'recall': 0.0036909504197330813, 'f1-score': 0.007300732299062924, 'support': 44433}, '2': {'precision': 0.36702260877484577, 'recall': 0.6540880503144654, 'f1-score': 0.47020389114138206, 'support': 49290}, 'accuracy': 0.3698660918047061, 'macro avg': {'precision': 0.3579458891107891, 'recall': 0.3580276042539343, 'f1-score': 0.29066170904122574, 'support': 142411}, 'weighted avg': {'precision': 0.3587599614105887, 'recall': 0.3698660918047061, 'f1-score': 0.2998870171260099, 'support': 142411}}
[[20269   141 28278]
 [16945   164 27324]
 [16861   189 32240]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
11876/11876 - 172s - 172s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929874
{'0': {'precision': 0.4023736690036975, 'recall': 0.44232669132985775, 'f1-score': 0.4214053220443279, 'support': 1125564}, '1': {'precision': 0.23453782649884963, 'recall': 0.0023125413668680745, 'f1-score': 0.004579924707412052, 'support': 749392}, '2': {'precision': 0.40781254786417853, 'recall': 0.6283926491778685, 'f1-score': 0.49462482537606633, 'support': 1165203}, 'accuracy': 0.40517782129158375, 'macro avg': {'precision': 0.3482413477889086, 'recall': 0.3576772939581981, 'f1-score': 0.3068700240426021, 'support': 3040159}, 'weighted avg': {'precision': 0.363087092307701, 'recall': 0.40517782129158375, 'f1-score': 0.3467217172656125, 'support': 3040159}}
[[497867   2571 625126]
 [309545   1733 438114]
 [429913   3085 732205]]
Evaluating performance on  train set...
2538/2538 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095492
{'0': {'precision': 0.37226489346255087, 'recall': 0.45065375826493775, 'f1-score': 0.40772577692053613, 'support': 221871}, '1': {'precision': 0.3400089007565643, 'recall': 0.003643769107133489, 'f1-score': 0.007210268025670064, 'support': 209673}, '2': {'precision': 0.3597694746651812, 'recall': 0.6248870832397136, 'f1-score': 0.4566369783603744, 'support': 218081}, 'accuracy': 0.3648674235135655, 'macro avg': {'precision': 0.3573477562947655, 'recall': 0.3597282035372616, 'f1-score': 0.29052434110219355, 'support': 649625}, 'weighted avg': {'precision': 0.3576591991229065, 'recall': 0.3648674235135655, 'f1-score': 0.2948750021269062, 'support': 649625}}
[[ 99987    724 121160]
 [ 87558    764 121351]
 [ 81046    759 136276]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964808
{'0': {'precision': 0.3582502587568775, 'recall': 0.4801203148042694, 'f1-score': 0.4103274433463113, 'support': 68487}, '1': {'precision': 0.32854864433811803, 'recall': 0.00313895195574992, 'f1-score': 0.006218492468379267, 'support': 65627}, '2': {'precision': 0.3641235813366961, 'recall': 0.5831818575261837, 'f1-score': 0.4483248122969091, 'support': 69318}, 'accuracy': 0.36136399386527196, 'macro avg': {'precision': 0.35030749481056384, 'recall': 0.3554803747620677, 'f1-score': 0.2882902493705332, 'support': 203432}, 'weighted avg': {'precision': 0.3506698344633934, 'recall': 0.36136399386527196, 'f1-score': 0.2929095518722635, 'support': 203432}}
[[32882   204 35401]
 [30227   206 35194]
 [28676   217 40425]]
testing model on single stock: results/universal/W0/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
19053/19053 - 276s - 276s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998421
{'0': {'precision': 0.29410240487497596, 'recall': 0.3889640584471217, 'f1-score': 0.33494622014633, 'support': 1353976}, '1': {'precision': 0.44916400295057785, 'recall': 0.0033192740025029697, 'f1-score': 0.006589849719500751, 'support': 2201385}, '2': {'precision': 0.29073987286055925, 'recall': 0.6752286152985046, 'f1-score': 0.40646436021497173, 'support': 1322090}, 'accuracy': 0.2925027847537576, 'macro avg': {'precision': 0.34466876022870435, 'recall': 0.3558373159160431, 'f1-score': 0.24933347669360084, 'support': 4877451}, 'weighted avg': {'precision': 0.3631763342960442, 'recall': 0.2925027847537576, 'f1-score': 0.20613193360429916, 'support': 4877451}}
[[ 526648    4491  822837]
 [ 839141    7307 1354937]
 [ 424907    4470  892713]]
Evaluating performance on  train set...
4812/4812 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987356
{'0': {'precision': 0.33790237770419473, 'recall': 0.37174341313393827, 'f1-score': 0.35401600295683927, 'support': 407098}, '1': {'precision': 0.3418491484184915, 'recall': 0.0027640613011744803, 'f1-score': 0.005483782834393662, 'support': 406648}, '2': {'precision': 0.3465712664481479, 'recall': 0.6471125652321571, 'f1-score': 0.45139231235710064, 'support': 418122}, 'accuracy': 0.343406923469073, 'macro avg': {'precision': 0.3421075975236114, 'recall': 0.3405400132224233, 'f1-score': 0.27029736604944454, 'support': 1231868}, 'weighted avg': {'precision': 0.3421476373560621, 'recall': 0.343406923469073, 'f1-score': 0.2720147227796643, 'support': 1231868}}
[[151336   1071 254691]
 [150076   1124 255448]
 [146457   1093 270572]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990739
{'0': {'precision': 0.34009590784936533, 'recall': 0.3675076125861424, 'f1-score': 0.35327081207032673, 'support': 149752}, '1': {'precision': 0.33728813559322035, 'recall': 0.0025721394642453225, 'f1-score': 0.005105345861527113, 'support': 154735}, '2': {'precision': 0.3349844965795687, 'recall': 0.6556432079888502, 'f1-score': 0.44341644989556095, 'support': 147806}, 'accuracy': 0.3368192742315269, 'macro avg': {'precision': 0.3374561800073848, 'recall': 0.34190765334641265, 'f1-score': 0.26726420260913825, 'support': 452293}, 'weighted avg': {'precision': 0.337464963098511, 'recall': 0.3368192742315269, 'f1-score': 0.2636180487743614, 'support': 452293}}
[[55035   398 94319]
 [56273   398 98064]
 [50514   384 96908]]
training model: results/universal/W0/deepVOL_L3/h500
Epoch 1/50
8838/8838 - 524s - loss: 3.2862 - accuracy500: 0.3639 - val_loss: 3.2983 - val_accuracy500: 0.3337 - 524s/epoch - 59ms/step
Epoch 2/50
8838/8838 - 498s - loss: 3.2858 - accuracy500: 0.3602 - val_loss: 3.2990 - val_accuracy500: 0.3339 - 498s/epoch - 56ms/step
Epoch 3/50
8838/8838 - 503s - loss: 3.2846 - accuracy500: 0.3596 - val_loss: 3.2994 - val_accuracy500: 0.3314 - 503s/epoch - 57ms/step
Epoch 4/50
8838/8838 - 503s - loss: 3.2867 - accuracy500: 0.3590 - val_loss: 3.2977 - val_accuracy500: 0.3333 - 503s/epoch - 57ms/step
Epoch 5/50
8838/8838 - 522s - loss: 3.2857 - accuracy500: 0.3619 - val_loss: 3.3094 - val_accuracy500: 0.3349 - 522s/epoch - 59ms/step
Epoch 6/50
8838/8838 - 498s - loss: 3.2774 - accuracy500: 0.3727 - val_loss: 3.3160 - val_accuracy500: 0.3377 - 498s/epoch - 56ms/step
Epoch 7/50
8838/8838 - 518s - loss: 3.2720 - accuracy500: 0.3765 - val_loss: 3.3164 - val_accuracy500: 0.3383 - 518s/epoch - 59ms/step
Epoch 8/50
8838/8838 - 511s - loss: 3.2622 - accuracy500: 0.3856 - val_loss: 3.3137 - val_accuracy500: 0.3373 - 511s/epoch - 58ms/step
Epoch 9/50
8838/8838 - 509s - loss: 3.2562 - accuracy500: 0.3899 - val_loss: 3.3417 - val_accuracy500: 0.3392 - 509s/epoch - 58ms/step
Epoch 10/50
8838/8838 - 503s - loss: 3.2445 - accuracy500: 0.3974 - val_loss: 3.3523 - val_accuracy500: 0.3413 - 503s/epoch - 57ms/step
Epoch 11/50
8838/8838 - 507s - loss: 3.2398 - accuracy500: 0.4011 - val_loss: 3.3482 - val_accuracy500: 0.3398 - 507s/epoch - 57ms/step
Epoch 12/50
8838/8838 - 503s - loss: 3.2350 - accuracy500: 0.4039 - val_loss: 3.3535 - val_accuracy500: 0.3408 - 503s/epoch - 57ms/step
Epoch 13/50
8838/8838 - 501s - loss: 3.2305 - accuracy500: 0.4061 - val_loss: 3.3741 - val_accuracy500: 0.3407 - 501s/epoch - 57ms/step
Epoch 14/50
8838/8838 - 511s - loss: 3.2271 - accuracy500: 0.4078 - val_loss: 3.3811 - val_accuracy500: 0.3414 - 511s/epoch - 58ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1052s - 1052s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0948999
{'0': {'precision': 0.27685594325337987, 'recall': 0.1240753062569824, 'f1-score': 0.17135599178253144, 'support': 2270887}, '1': {'precision': 0.45670732727304786, 'recall': 0.7867331243550554, 'f1-score': 0.5779235861772264, 'support': 3852075}, '2': {'precision': 0.2708109460052209, 'recall': 0.09263318726416737, 'f1-score': 0.13804642187410907, 'support': 2326067}, 'accuracy': 0.41753756555930865, 'macro avg': {'precision': 0.3347914055105495, 'recall': 0.3344805392920684, 'f1-score': 0.29577533327795563, 'support': 8449029}, 'weighted avg': {'precision': 0.3571894290874951, 'recall': 0.41753756555930865, 'f1-score': 0.3475476671608229, 'support': 8449029}}
[[ 281761 1779169  209957]
 [ 451297 3030555  370223]
 [ 284659 1825937  215471]]
Evaluating performance on  train set...
8838/8838 - 284s - 284s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09911
{'0': {'precision': 0.3298204941379082, 'recall': 0.1328949141866582, 'f1-score': 0.18945323832706013, 'support': 749359}, '1': {'precision': 0.32835052306463813, 'recall': 0.7789565172933869, 'f1-score': 0.46196903040586507, 'support': 743261}, '2': {'precision': 0.33953370244323666, 'recall': 0.08687221555080758, 'f1-score': 0.13834725898820474, 'support': 769452}, 'accuracy': 0.32952001527802827, 'macro avg': {'precision': 0.3325682398819277, 'recall': 0.33290788234361757, 'f1-score': 0.26325650924037663, 'support': 2262072}, 'weighted avg': {'precision': 0.33264148099732815, 'recall': 0.32952001527802827, 'f1-score': 0.26161131380920377, 'support': 2262072}}
[[ 99586 586159  63614]
 [ 97881 578968  66412]
 [104473 598135  66844]]
Evaluating performance on  val set...
3279/3279 - 103s - 103s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989864
{'0': {'precision': 0.3349704752085481, 'recall': 0.12780916958729704, 'f1-score': 0.18502239134373946, 'support': 279620}, '1': {'precision': 0.3336291697767421, 'recall': 0.7851720936875178, 'f1-score': 0.46828033235806427, 'support': 280080}, '2': {'precision': 0.3289612398855406, 'recall': 0.08606368003094811, 'f1-score': 0.1364333250051105, 'support': 279177}, 'accuracy': 0.3333933341836765, 'macro avg': {'precision': 0.33252029495694363, 'recall': 0.333014981101921, 'f1-score': 0.26324534956897144, 'support': 838877}, 'weighted avg': {'precision': 0.3325227825013795, 'recall': 0.3333933341836765, 'f1-score': 0.2634247487168379, 'support': 838877}}
[[ 35738 220006  23876]
 [ 35033 219911  25136]
 [ 35919 219231  24027]]
testing model out of sample: results/universal/W0/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 798s - 798s/epoch - 35ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993223
{'0': {'precision': 0.3568472131147541, 'recall': 0.13598619427470215, 'f1-score': 0.1969277801440178, 'support': 2000909}, '1': {'precision': 0.312104234099535, 'recall': 0.7906136583091932, 'f1-score': 0.44753761953789284, 'support': 1801980}, '2': {'precision': 0.35271227394421617, 'recall': 0.08786871808613873, 'f1-score': 0.14068866303968908, 'support': 2030074}, 'accuracy': 0.3214740090070861, 'macro avg': {'precision': 0.34055457371950176, 'recall': 0.3381561902233447, 'f1-score': 0.2617180209071999, 'support': 5832963}, 'weighted avg': {'precision': 0.341585640938223, 'recall': 0.3214740090070861, 'f1-score': 0.2547756267657985, 'support': 5832963}}
[[ 272096 1559067  169746]
 [ 219698 1424670  157612]
 [ 270706 1580988  178380]]
Evaluating performance on  train set...
6334/6334 - 237s - 237s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990474
{'0': {'precision': 0.3320373765711635, 'recall': 0.13992895098437144, 'f1-score': 0.19688540931233536, 'support': 537094}, '1': {'precision': 0.3369902522286983, 'recall': 0.7710983635455534, 'f1-score': 0.46901056165582283, 'support': 544592}, '2': {'precision': 0.32382229289063763, 'recall': 0.08913529693220132, 'f1-score': 0.13979157638175901, 'support': 539214}, 'accuracy': 0.3350928496514282, 'macro avg': {'precision': 0.3309499738968331, 'recall': 0.333387537154042, 'f1-score': 0.26856251578330576, 'support': 1620900}, 'weighted avg': {'precision': 0.3309685927648689, 'recall': 0.3350928496514282, 'f1-score': 0.2693213319079407, 'support': 1620900}}
[[ 75155 412786  49153]
 [ 73450 419934  51208]
 [ 77740 413411  48063]]
Evaluating performance on  val set...
2156/2156 - 70s - 70s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098176
{'0': {'precision': 0.3051337671728127, 'recall': 0.1447229988549108, 'f1-score': 0.19632859688687723, 'support': 172039}, '1': {'precision': 0.3678500304089104, 'recall': 0.7610067547897824, 'f1-score': 0.4959643447446443, 'support': 202671}, '2': {'precision': 0.3201117982873454, 'recall': 0.09143358623032499, 'f1-score': 0.1422393291877323, 'support': 176620}, 'accuracy': 0.3541998440135672, 'macro avg': {'precision': 0.3310318652896895, 'recall': 0.3323877799583394, 'f1-score': 0.27817742360641795, 'support': 551330}, 'weighted avg': {'precision': 0.33298675475152584, 'recall': 0.3541998440135672, 'f1-score': 0.28914819711370787, 'support': 551330}}
[[ 24898 131599  15542]
 [ 29680 154234  18757]
 [ 27019 133452  16149]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976812
{'0': {'precision': 0.3233110748028699, 'recall': 0.2648809090776819, 'f1-score': 0.2911938066332366, 'support': 68729}, '1': {'precision': 0.3582985577275057, 'recall': 0.6755851163958085, 'f1-score': 0.4682561082745484, 'support': 79685}, '2': {'precision': 0.3283327650869417, 'recall': 0.0762862914405672, 'f1-score': 0.1238067688747469, 'support': 75741}, 'accuracy': 0.3471571011130691, 'macro avg': {'precision': 0.33664746587243904, 'recall': 0.3389174389713525, 'f1-score': 0.29441889459417725, 'support': 224155}, 'weighted avg': {'precision': 0.33744560412702274, 'recall': 0.3471571011130691, 'f1-score': 0.29757844172690906, 'support': 224155}}
[[18205 45196  5328]
 [19359 53834  6492]
 [18744 51219  5778]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098953
{'0': {'precision': 0.346475372797108, 'recall': 0.2226901434017063, 'f1-score': 0.27112201374616013, 'support': 27545}, '1': {'precision': 0.325170185264972, 'recall': 0.7133998790078645, 'f1-score': 0.4467226214293325, 'support': 26448}, '2': {'precision': 0.3255137297690489, 'recall': 0.06572425188176978, 'f1-score': 0.10936640801613001, 'support': 27235}, 'accuracy': 0.32983700201900823, 'macro avg': {'precision': 0.3323864292770429, 'recall': 0.33393809143044684, 'f1-score': 0.27573701439720755, 'support': 81228}, 'weighted avg': {'precision': 0.3325101151554189, 'recall': 0.32983700201900823, 'f1-score': 0.2740627601630013, 'support': 81228}}
[[ 6134 19423  1988]
 [ 5859 18868  1721]
 [ 5711 19734  1790]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995002
{'0': {'precision': 0.3236096537250787, 'recall': 0.17167668670674682, 'f1-score': 0.224339855968575, 'support': 8982}, '1': {'precision': 0.3174350293736931, 'recall': 0.7454694259324214, 'f1-score': 0.4452669436782011, 'support': 8553}, '2': {'precision': 0.3337393422655298, 'recall': 0.06117436927885689, 'f1-score': 0.10339622641509434, 'support': 8958}, 'accuracy': 0.31955610916091043, 'macro avg': {'precision': 0.3249280084547672, 'recall': 0.3261068273060084, 'f1-score': 0.2576676753539568, 'support': 26493}, 'weighted avg': {'precision': 0.32504135975565135, 'recall': 0.31955610916091043, 'f1-score': 0.25476964299308535, 'support': 26493}}
[[1542 6903  537]
 [1620 6376  557]
 [1603 6807  548]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09916
{'0': {'precision': 0.3598842651689218, 'recall': 0.14475369915797093, 'f1-score': 0.20646317690915492, 'support': 204506}, '1': {'precision': 0.27557225969211757, 'recall': 0.8109610128300697, 'f1-score': 0.41136035955719374, 'support': 165003}, '2': {'precision': 0.40510624096117476, 'recall': 0.06217373302771482, 'f1-score': 0.10780246822210299, 'support': 234279}, 'accuracy': 0.2947723373104467, 'macro avg': {'precision': 0.3468542552740714, 'recall': 0.3392961483385852, 'f1-score': 0.24187533489615057, 'support': 603788}, 'weighted avg': {'precision': 0.3543903259500968, 'recall': 0.2947723373104467, 'f1-score': 0.2241755488973039, 'support': 603788}}
[[ 29603 163686  11217]
 [ 21019 133811  10173]
 [ 31635 188078  14566]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989478
{'0': {'precision': 0.3881357011011393, 'recall': 0.11533733048362997, 'f1-score': 0.1778309177335161, 'support': 52871}, '1': {'precision': 0.3159763690504626, 'recall': 0.8413041634868142, 'f1-score': 0.4594084621172658, 'support': 47172}, '2': {'precision': 0.34184759472115794, 'recall': 0.06340057636887608, 'f1-score': 0.10696326884012122, 'support': 50662}, 'accuracy': 0.32511197372349954, 'macro avg': {'precision': 0.3486532216242533, 'recall': 0.3400140234464401, 'f1-score': 0.2480675495636344, 'support': 150705}, 'weighted avg': {'precision': 0.34998867175959697, 'recall': 0.32511197372349954, 'f1-score': 0.24214384096388716, 'support': 150705}}
[[ 6098 43540  3233]
 [ 4535 39686  2951]
 [ 5078 42372  3212]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994846
{'0': {'precision': 0.3796564041503657, 'recall': 0.11076923076923077, 'f1-score': 0.17150101809520152, 'support': 20150}, '1': {'precision': 0.2826667214191853, 'recall': 0.8314409952892862, 'f1-score': 0.42189942079617543, 'support': 16558}, '2': {'precision': 0.3927307056879868, 'recall': 0.07525325615050651, 'f1-score': 0.12630460359026907, 'support': 22112}, 'accuracy': 0.30028901734104047, 'macro avg': {'precision': 0.35168461041917926, 'recall': 0.33915449406967446, 'f1-score': 0.23990168082721533, 'support': 58820}, 'weighted avg': {'precision': 0.35726850528836285, 'recall': 0.30028901734104047, 'f1-score': 0.22499835972032323, 'support': 58820}}
[[ 2232 16514  1404]
 [ 1622 13767  1169]
 [ 2025 18423  1664]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969718
{'0': {'precision': 0.3382905628184732, 'recall': 0.1156805853412388, 'f1-score': 0.17240589178804133, 'support': 126832}, '1': {'precision': 0.37490491820746036, 'recall': 0.8199319032145308, 'f1-score': 0.5145413961121391, 'support': 154486}, '2': {'precision': 0.3294138040620576, 'recall': 0.08475243992180358, 'f1-score': 0.13481844087356484, 'support': 134533}, 'accuracy': 0.36729982613965095, 'macro avg': {'precision': 0.3475364283626637, 'recall': 0.3401216428258577, 'f1-score': 0.27392190959124846, 'support': 415851}, 'weighted avg': {'precision': 0.3490208203406295, 'recall': 0.36729982613965095, 'f1-score': 0.2873470437562591, 'support': 415851}}
[[ 14672 102375   9785]
 [ 14392 126668  13426]
 [ 14307 108824  11402]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986841
{'0': {'precision': 0.3343258694616484, 'recall': 0.1513044415696421, 'f1-score': 0.20832714858245507, 'support': 37104}, '1': {'precision': 0.3319138330841081, 'recall': 0.8116107151373837, 'f1-score': 0.4711482999684681, 'support': 37741}, '2': {'precision': 0.35106716886377903, 'recall': 0.05509173747075483, 'f1-score': 0.09523809523809523, 'support': 40605}, 'accuracy': 0.33332178432221743, 'macro avg': {'precision': 0.33910229046984514, 'recall': 0.33933563139259354, 'f1-score': 0.2582378479296728, 'support': 115450}, 'weighted avg': {'precision': 0.3394254606032574, 'recall': 0.33332178432221743, 'f1-score': 0.254469652379872, 'support': 115450}}
[[ 5614 29477  2013]
 [ 4988 30631  2122]
 [ 6190 32178  2237]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986154
{'0': {'precision': 0.36030795551753636, 'recall': 0.13904661296712004, 'f1-score': 0.20065742461054736, 'support': 15146}, '1': {'precision': 0.3349640685461581, 'recall': 0.8050352065896107, 'f1-score': 0.4730842799703322, 'support': 15054}, '2': {'precision': 0.32537120723047125, 'recall': 0.06754673993164913, 'f1-score': 0.11186948560013317, 'support': 14923}, 'accuracy': 0.3375883695676263, 'macro avg': {'precision': 0.3402144104313886, 'recall': 0.33720951982945996, 'f1-score': 0.26187039672700424, 'support': 45123}, 'weighted avg': {'precision': 0.3402984710161734, 'recall': 0.3375883695676263, 'f1-score': 0.2621810703507196, 'support': 45123}}
[[ 2106 12045   995]
 [ 1840 12119  1095]
 [ 1899 12016  1008]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979029
{'0': {'precision': 0.31744920853831743, 'recall': 0.15341304737082945, 'f1-score': 0.20685816225931714, 'support': 100526}, '1': {'precision': 0.36446908475850404, 'recall': 0.8237367902409188, 'f1-score': 0.5053444025786547, 'support': 117716}, '2': {'precision': 0.3120497384782394, 'recall': 0.02968400893712097, 'f1-score': 0.05421113539925421, 'support': 106522}, 'accuracy': 0.3557999039302386, 'macro avg': {'precision': 0.3313226772583537, 'recall': 0.3356112821829564, 'f1-score': 0.2554712334124087, 'support': 324764}, 'weighted avg': {'precision': 0.33272131197156696, 'recall': 0.3557999039302386, 'f1-score': 0.26498141382120055, 'support': 324764}}
[[15422 81938  3166]
 [16944 96967  3805]
 [16215 87145  3162]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988214
{'0': {'precision': 0.33561032000420365, 'recall': 0.15369621715275772, 'f1-score': 0.21083730833347086, 'support': 41556}, '1': {'precision': 0.32985191577151585, 'recall': 0.8103511294134847, 'f1-score': 0.46885661920203014, 'support': 41039}, '2': {'precision': 0.3188734953440836, 'recall': 0.033701392222755644, 'f1-score': 0.06095998957948896, 'support': 41660}, 'accuracy': 0.3303448553378134, 'macro avg': {'precision': 0.3281119103732677, 'recall': 0.332582912929666, 'f1-score': 0.24688463903833, 'support': 124255}, 'weighted avg': {'precision': 0.32809693811497687, 'recall': 0.3303448553378134, 'f1-score': 0.24580544160331047, 'support': 124255}}
[[ 6387 33749  1420]
 [ 6204 33256  1579]
 [ 6440 33816  1404]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988183
{'0': {'precision': 0.32808022922636104, 'recall': 0.14252126408962035, 'f1-score': 0.19871763968567707, 'support': 14461}, '1': {'precision': 0.33204032087819296, 'recall': 0.8319888918275589, 'f1-score': 0.47465107506601284, 'support': 15124}, '2': {'precision': 0.30700447093889716, 'recall': 0.025855036084091624, 'f1-score': 0.04769346530068878, 'support': 15935}, 'accuracy': 0.3307557117750439, 'macro avg': {'precision': 0.3223750070144837, 'recall': 0.33345506400042363, 'f1-score': 0.24035406001745954, 'support': 45520}, 'weighted avg': {'precision': 0.3220180635372478, 'recall': 0.3307557117750439, 'f1-score': 0.23752798805710523, 'support': 45520}}
[[ 2061 11957   443]
 [ 2054 12583   487]
 [ 2167 13356   412]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984355
{'0': {'precision': 0.3592473464136378, 'recall': 0.15519505332268038, 'f1-score': 0.21675278364020084, 'support': 143935}, '1': {'precision': 0.3308815322135185, 'recall': 0.7936445826554359, 'f1-score': 0.46704533059704206, 'support': 145671}, '2': {'precision': 0.33803125685113844, 'recall': 0.07012722051122114, 'f1-score': 0.11615680576855814, 'support': 153906}, 'accuracy': 0.33537311279063475, 'macro avg': {'precision': 0.3427200451594316, 'recall': 0.3396556188297792, 'f1-score': 0.2666516400019337, 'support': 443512}, 'weighted avg': {'precision': 0.3425682937599292, 'recall': 0.33537311279063475, 'f1-score': 0.2640526110122606, 'support': 443512}}
[[ 22338 111678   9919]
 [ 18843 115611  11217]
 [ 20999 122114  10793]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983325
{'0': {'precision': 0.3279829386014143, 'recall': 0.1423583480845121, 'f1-score': 0.1985414024279761, 'support': 61577}, '1': {'precision': 0.3391812865497076, 'recall': 0.7862866783153581, 'f1-score': 0.47392504357931436, 'support': 66388}, '2': {'precision': 0.3299861267093876, 'recall': 0.07367365300373162, 'f1-score': 0.12045432622745249, 'support': 67799}, 'accuracy': 0.3369414192599252, 'macro avg': {'precision': 0.3323834506201698, 'recall': 0.3341062264678673, 'f1-score': 0.26430692407824763, 'support': 195764}, 'weighted avg': {'precision': 0.33247431635280766, 'recall': 0.3369414192599252, 'f1-score': 0.26488630490971815, 'support': 195764}}
[[ 8766 48291  4520]
 [ 8566 52200  5622]
 [ 9395 53409  4995]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984473
{'0': {'precision': 0.3277964676198486, 'recall': 0.1506280193236715, 'f1-score': 0.20640804978154376, 'support': 20700}, '1': {'precision': 0.35170743235259366, 'recall': 0.7930988542499334, 'f1-score': 0.48731172233136877, 'support': 22518}, '2': {'precision': 0.32339656729900634, 'recall': 0.0666046511627907, 'f1-score': 0.11045973464979945, 'support': 21500}, 'accuracy': 0.34625606477332427, 'macro avg': {'precision': 0.3343001557571495, 'recall': 0.33677717491213194, 'f1-score': 0.2680598355875706, 'support': 64718}, 'weighted avg': {'precision': 0.33465436259425824, 'recall': 0.34625606477332427, 'f1-score': 0.2722707174032944, 'support': 64718}}
[[ 3118 16162  1420]
 [ 3083 17859  1576]
 [ 3311 16757  1432]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
4693/4693 - 70s - 70s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.087825
{'0': {'precision': 0.22822840073529413, 'recall': 0.08878331329582073, 'f1-score': 0.12783674992840757, 'support': 223747}, '1': {'precision': 0.6215646344498477, 'recall': 0.8474581063885653, 'f1-score': 0.7171434089690639, 'support': 742655}, '2': {'precision': 0.20755738414898225, 'recall': 0.08981217257975212, 'f1-score': 0.125373826496941, 'support': 234790}, 'accuracy': 0.5580465071362447, 'macro avg': {'precision': 0.35245013977804135, 'recall': 0.342017864088046, 'f1-score': 0.3234513284648042, 'support': 1201192}, 'weighted avg': {'precision': 0.46737399333413066, 'recall': 0.5580465071362447, 'f1-score': 0.49170303198603427, 'support': 1201192}}
[[ 19865 185478  18404]
 [ 51181 629369  62105]
 [ 15994 197709  21087]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985727
{'0': {'precision': 0.3454488864296583, 'recall': 0.07925639113255153, 'f1-score': 0.12893191352049047, 'support': 126034}, '1': {'precision': 0.33140921652982797, 'recall': 0.8462312194581066, 'f1-score': 0.47628939508759416, 'support': 126261}, '2': {'precision': 0.35195074448702646, 'recall': 0.08562214376327816, 'f1-score': 0.1377360346184107, 'support': 130854}, 'accuracy': 0.33417547742523146, 'macro avg': {'precision': 0.3429362824821709, 'recall': 0.3370365847846455, 'f1-score': 0.2476524477421651, 'support': 383149}, 'weighted avg': {'precision': 0.3430428547631692, 'recall': 0.33417547742523146, 'f1-score': 0.24640516137521884, 'support': 383149}}
[[  9989 105865  10180]
 [  8965 106846  10450]
 [  9962 109688  11204]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980066
{'0': {'precision': 0.3047297297297297, 'recall': 0.08062029361160146, 'f1-score': 0.12750693548672098, 'support': 44753}, '1': {'precision': 0.3619495363381497, 'recall': 0.8244066331342346, 'f1-score': 0.5030421829385989, 'support': 50896}, '2': {'precision': 0.3278090818694067, 'recall': 0.0895346731848633, 'f1-score': 0.14065277679015858, 'support': 44184}, 'accuracy': 0.3541581743937411, 'macro avg': {'precision': 0.3314961159790954, 'recall': 0.3315205333102331, 'f1-score': 0.25706729840515946, 'support': 139833}, 'weighted avg': {'precision': 0.33284896747819853, 'recall': 0.3541581743937411, 'f1-score': 0.2683469218022679, 'support': 139833}}
[[ 3608 37356  3789]
 [ 4614 41959  4323]
 [ 3618 36610  3956]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
6677/6677 - 99s - 99s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952147
{'0': {'precision': 0.25790698098194165, 'recall': 0.08971509225061064, 'f1-score': 0.13312243595873394, 'support': 473276}, '1': {'precision': 0.4658711971891949, 'recall': 0.8128328962331157, 'f1-score': 0.5922800066579895, 'support': 801113}, '2': {'precision': 0.2505581876599684, 'recall': 0.08463613223360934, 'f1-score': 0.1265312366255816, 'support': 434897}, 'accuracy': 0.4273357413563324, 'macro avg': {'precision': 0.3247787886103683, 'recall': 0.32906137357244525, 'f1-score': 0.2839778930807684, 'support': 1709286}, 'weighted avg': {'precision': 0.3535064704583049, 'recall': 0.4273357413563324, 'f1-score': 0.34664469386010494, 'support': 1709286}}
[[ 42460 391483  39333]
 [ 79179 651171  70763]
 [ 42994 355095  36808]]
Evaluating performance on  train set...
2262/2262 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098722
{'0': {'precision': 0.34035927830330626, 'recall': 0.1348644305044326, 'f1-score': 0.19318211353737733, 'support': 192890}, '1': {'precision': 0.34252229855560606, 'recall': 0.7815958155210012, 'f1-score': 0.4763093698451912, 'support': 196727}, '2': {'precision': 0.32181179197667026, 'recall': 0.09098067816675122, 'f1-score': 0.14185653660747394, 'support': 189216}, 'accuracy': 0.34032268374470703, 'macro avg': {'precision': 0.33489778961186084, 'recall': 0.33581364139739506, 'f1-score': 0.2704493399966808, 'support': 578833}, 'weighted avg': {'precision': 0.3350313915248977, 'recall': 0.34032268374470703, 'f1-score': 0.2726301674446333, 'support': 578833}}
[[ 26014 148861  18015]
 [ 24702 153761  18264]
 [ 25715 146286  17215]]
Evaluating performance on  val set...
827/827 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958396
{'0': {'precision': 0.2695628710199676, 'recall': 0.1365057133584983, 'f1-score': 0.18123476387550314, 'support': 58547}, '1': {'precision': 0.4333160288737269, 'recall': 0.768650580483901, 'f1-score': 0.5542061061159964, 'support': 91217}, '2': {'precision': 0.30226775412771034, 'recall': 0.0983495145631068, 'f1-score': 0.14841041168139862, 'support': 61800}, 'accuracy': 0.3979126883590781, 'macro avg': {'precision': 0.3350488846738016, 'recall': 0.33450193613516865, 'f1-score': 0.2946170938909661, 'support': 211564}, 'weighted avg': {'precision': 0.34971938902872557, 'recall': 0.3979126883590781, 'f1-score': 0.3324551130821518, 'support': 211564}}
[[ 7992 44989  5566]
 [12639 70114  8464]
 [ 9017 46705  6078]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
5633/5633 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951629
{'0': {'precision': 0.2740440617877944, 'recall': 0.0990067177248608, 'f1-score': 0.1454611787973924, 'support': 382570}, '1': {'precision': 0.4434997574910028, 'recall': 0.7961869566780626, 'f1-score': 0.5696741251936401, 'support': 639699}, '2': {'precision': 0.27448327405803824, 'recall': 0.10153849820647576, 'f1-score': 0.14823939189906277, 'support': 419565}, 'accuracy': 0.4090616534219612, 'macro avg': {'precision': 0.3306756977789451, 'recall': 0.3322440575364664, 'f1-score': 0.2877915652966984, 'support': 1441834}, 'weighted avg': {'precision': 0.3493543382702546, 'recall': 0.4090616534219612, 'f1-score': 0.3344803298069647, 'support': 1441834}}
[[ 37877 303680  41013]
 [ 58786 509320  71593]
 [ 41552 335411  42602]]
Evaluating performance on  train set...
1454/1454 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985686
{'0': {'precision': 0.346334499907902, 'recall': 0.12237028359447455, 'f1-score': 0.18084326195943592, 'support': 122922}, '1': {'precision': 0.33190694047134833, 'recall': 0.8045401952316542, 'f1-score': 0.4699426243357535, 'support': 122726}, '2': {'precision': 0.3399089042853477, 'recall': 0.08380586332613664, 'f1-score': 0.13446007245135544, 'support': 126447}, 'accuracy': 0.3342614117362501, 'macro avg': {'precision': 0.3393834482215327, 'recall': 0.33690544738408845, 'f1-score': 0.2617486529155149, 'support': 372095}, 'weighted avg': {'precision': 0.33939236429980296, 'recall': 0.3342614117362501, 'f1-score': 0.2604331333182763, 'support': 372095}}
[[ 15042  97984   9896]
 [ 13305  98738  10683]
 [ 15085 100765  10597]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997765
{'0': {'precision': 0.3654120419172816, 'recall': 0.11823599044962982, 'f1-score': 0.17866238176085372, 'support': 49841}, '1': {'precision': 0.30129001012635936, 'recall': 0.799607394078194, 'f1-score': 0.43766788610606566, 'support': 42791}, '2': {'precision': 0.3395707209686296, 'recall': 0.08676349464633681, 'f1-score': 0.13821242279752954, 'support': 49779}, 'accuracy': 0.31197028319441616, 'macro avg': {'precision': 0.3354242576707569, 'recall': 0.33486895972472025, 'f1-score': 0.25151423022148295, 'support': 142411}, 'weighted avg': {'precision': 0.33711225483715224, 'recall': 0.31197028319441616, 'f1-score': 0.24234809444597388, 'support': 142411}}
[[ 5893 39672  4276]
 [ 4451 34216  4124]
 [ 5783 39677  4319]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
11876/11876 - 176s - 176s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022091
{'0': {'precision': 0.4004214016786985, 'recall': 0.1463543345590618, 'f1-score': 0.21435994285016907, 'support': 1188137}, '1': {'precision': 0.2047118040467414, 'recall': 0.7684489352280504, 'f1-score': 0.323298220940481, 'support': 621025}, '2': {'precision': 0.41354642590603785, 'recall': 0.0922788601434447, 'f1-score': 0.15088843460969847, 'support': 1230997}, 'accuracy': 0.25153618610079276, 'macro avg': {'precision': 0.33955987721049263, 'recall': 0.3356940433101856, 'f1-score': 0.2295155328001162, 'support': 3040159}, 'weighted avg': {'precision': 0.365757528038996, 'recall': 0.25153618610079276, 'f1-score': 0.21091280667128545, 'support': 3040159}}
[[173889 909637 104611]
 [ 87320 477226  56479]
 [173056 944346 113595]]
Evaluating performance on  train set...
2538/2538 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996526
{'0': {'precision': 0.32082215256950863, 'recall': 0.1305406967675637, 'f1-score': 0.1855728596024417, 'support': 217978}, '1': {'precision': 0.3334511017437847, 'recall': 0.7557803468208093, 'f1-score': 0.4627405674997887, 'support': 217288}, '2': {'precision': 0.31835649264308363, 'recall': 0.10164257157385508, 'f1-score': 0.15408878422053904, 'support': 214359}, 'accuracy': 0.3301366172791995, 'macro avg': {'precision': 0.32420991565212565, 'recall': 0.329321205054076, 'f1-score': 0.2674674037742565, 'support': 649625}, 'weighted avg': {'precision': 0.3242327089859205, 'recall': 0.3301366172791995, 'f1-score': 0.2678916158061122, 'support': 649625}}
[[ 28455 166587  22936]
 [ 29351 164222  23715]
 [ 30888 161683  21788]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100278
{'0': {'precision': 0.3139300346675071, 'recall': 0.14506874053361296, 'f1-score': 0.1984381536745224, 'support': 68664}, '1': {'precision': 0.31713470092279095, 'recall': 0.7312219688040533, 'f1-score': 0.44239878865895843, 'support': 65329}, '2': {'precision': 0.33589597570235386, 'recall': 0.10193119140540619, 'f1-score': 0.15640087945111644, 'support': 69439}, 'accuracy': 0.3185781981202564, 'macro avg': {'precision': 0.32232023709755064, 'recall': 0.32607396691435747, 'f1-score': 0.2657459405948657, 'support': 203432}, 'weighted avg': {'precision': 0.3224569656385941, 'recall': 0.3185781981202564, 'f1-score': 0.2624333856837399, 'support': 203432}}
[[ 9961 51631  7072]
 [10637 47770  6922]
 [11132 51229  7078]]
testing model on single stock: results/universal/W0/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
19053/19053 - 281s - 281s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958396
{'0': {'precision': 0.26993436586420294, 'recall': 0.13134903180345087, 'f1-score': 0.17671111146295748, 'support': 1359538}, '1': {'precision': 0.4460511073144017, 'recall': 0.7593481853240189, 'f1-score': 0.5619848974020616, 'support': 2187002}, '2': {'precision': 0.2718943664544093, 'recall': 0.10067465067160765, 'f1-score': 0.14694120608057534, 'support': 1330911}, 'accuracy': 0.4045676727454566, 'macro avg': {'precision': 0.3292932798776713, 'recall': 0.33045728926635914, 'f1-score': 0.2952124049818648, 'support': 4877451}, 'weighted avg': {'precision': 0.34943824035327103, 'recall': 0.4045676727454566, 'f1-score': 0.3413408424134111, 'support': 4877451}}
[[ 178574 1044656  136308]
 [ 303805 1660696  222501]
 [ 179167 1017755  133989]]
Evaluating performance on  train set...
4812/4812 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994883
{'0': {'precision': 0.31669616519174043, 'recall': 0.15205824974875362, 'f1-score': 0.2054647937014583, 'support': 405976}, '1': {'precision': 0.32735168948925714, 'recall': 0.7397201912018578, 'f1-score': 0.45385631225219997, 'support': 406063}, '2': {'precision': 0.33609812496858193, 'recall': 0.0955531895128731, 'f1-score': 0.1488018071652321, 'support': 419829}, 'accuracy': 0.32651306795858, 'macro avg': {'precision': 0.32671532654985985, 'recall': 0.32911054348782814, 'f1-score': 0.26937430437296345, 'support': 1231868}, 'weighted avg': {'precision': 0.32682088596862086, 'recall': 0.32651306795858, 'f1-score': 0.2680314325156433, 'support': 1231868}}
[[ 61732 305567  38677]
 [ 65125 300373  40565]
 [ 68068 311645  40116]]
Evaluating performance on  val set...
1767/1767 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991144
{'0': {'precision': 0.3290106389373084, 'recall': 0.1455639397666456, 'f1-score': 0.2018316487142969, 'support': 150415}, '1': {'precision': 0.34206097802415364, 'recall': 0.7593965522813504, 'f1-score': 0.4716658068686155, 'support': 154711}, '2': {'precision': 0.3199375546987724, 'recall': 0.09190919159866003, 'f1-score': 0.14279681594560928, 'support': 147167}, 'accuracy': 0.3380728863811733, 'macro avg': {'precision': 0.3303363905534115, 'recall': 0.33228989454888536, 'f1-score': 0.27209809050950723, 'support': 452293}, 'weighted avg': {'precision': 0.3305224297948549, 'recall': 0.3380728863811733, 'f1-score': 0.27492217456400786, 'support': 452293}}
[[ 21895 114692  13828]
 [ 22301 117487  14923]
 [ 22352 111289  13526]]
training model: results/universal/W0/deepVOL_L3/h1000
Epoch 1/50
8838/8838 - 528s - loss: 3.2794 - accuracy1000: 0.3698 - val_loss: 3.2978 - val_accuracy1000: 0.3307 - 528s/epoch - 60ms/step
Epoch 2/50
8838/8838 - 532s - loss: 3.2791 - accuracy1000: 0.3659 - val_loss: 3.3012 - val_accuracy1000: 0.3310 - 532s/epoch - 60ms/step
Epoch 3/50
8838/8838 - 523s - loss: 3.2813 - accuracy1000: 0.3665 - val_loss: 3.3061 - val_accuracy1000: 0.3304 - 523s/epoch - 59ms/step
Epoch 4/50
8838/8838 - 546s - loss: 3.2735 - accuracy1000: 0.3733 - val_loss: 3.3132 - val_accuracy1000: 0.3306 - 546s/epoch - 62ms/step
Epoch 5/50
8838/8838 - 551s - loss: 3.2611 - accuracy1000: 0.3863 - val_loss: 3.3960 - val_accuracy1000: 0.3331 - 551s/epoch - 62ms/step
Epoch 6/50
8838/8838 - 545s - loss: 3.2509 - accuracy1000: 0.3959 - val_loss: 3.3668 - val_accuracy1000: 0.3339 - 545s/epoch - 62ms/step
Epoch 7/50
8838/8838 - 542s - loss: 3.2344 - accuracy1000: 0.4059 - val_loss: 3.3540 - val_accuracy1000: 0.3361 - 542s/epoch - 61ms/step
Epoch 8/50
8838/8838 - 539s - loss: 3.2227 - accuracy1000: 0.4127 - val_loss: 3.4112 - val_accuracy1000: 0.3358 - 539s/epoch - 61ms/step
Epoch 9/50
8838/8838 - 526s - loss: 3.2155 - accuracy1000: 0.4164 - val_loss: 3.4328 - val_accuracy1000: 0.3365 - 526s/epoch - 60ms/step
Epoch 10/50
8838/8838 - 512s - loss: 3.2100 - accuracy1000: 0.4193 - val_loss: 3.4540 - val_accuracy1000: 0.3363 - 512s/epoch - 58ms/step
Epoch 11/50
8838/8838 - 516s - loss: 3.2067 - accuracy1000: 0.4208 - val_loss: 3.4598 - val_accuracy1000: 0.3376 - 516s/epoch - 58ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1119s - 1119s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999954
{'0': {'precision': 0.2620722318712858, 'recall': 0.3517716480530399, 'f1-score': 0.30036816828951907, 'support': 2258829}, '1': {'precision': 0.4620636172750588, 'recall': 0.06227318716648948, 'f1-score': 0.1097545466107084, 'support': 3894180}, '2': {'precision': 0.2747760997251773, 'recall': 0.5854792205642808, 'f1-score': 0.3740184870758104, 'support': 2296020}, 'accuracy': 0.2818509677265873, 'macro avg': {'precision': 0.33297064962384065, 'recall': 0.3331746852612701, 'f1-score': 0.2613804006586793, 'support': 8449029}, 'weighted avg': {'precision': 0.35770106541908836, 'recall': 0.2818509677265873, 'f1-score': 0.2325282841644332, 'support': 8449029}}
[[ 794592  139491 1324746]
 [1428450  242503 2223227]
 [ 808916  142832 1344272]]
Evaluating performance on  train set...
8838/8838 - 332s - 332s/epoch - 38ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986813
{'0': {'precision': 0.32844193223983076, 'recall': 0.317057461660313, 'f1-score': 0.3226493047796061, 'support': 746811}, '1': {'precision': 0.3305404151687348, 'recall': 0.06098903229861677, 'f1-score': 0.10297738873602956, 'support': 747741}, '2': {'precision': 0.34371594785839865, 'recall': 0.628381019387117, 'f1-score': 0.4443683808763905, 'support': 767520}, 'accuracy': 0.33804450079396237, 'macro avg': {'precision': 0.3342327650889881, 'recall': 0.33547583778201556, 'f1-score': 0.28999835813067537, 'support': 2262072}, 'weighted avg': {'precision': 0.3343180644722729, 'recall': 0.33804450079396237, 'f1-score': 0.2913347078576089, 'support': 2262072}}
[[236782  45376 464653]
 [245906  45604 456231]
 [238237  46988 482295]]
Evaluating performance on  val set...
3279/3279 - 103s - 103s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988742
{'0': {'precision': 0.3294390143613229, 'recall': 0.31193296280950406, 'f1-score': 0.32044707742945155, 'support': 279964}, '1': {'precision': 0.3446241600250039, 'recall': 0.06228727986555382, 'f1-score': 0.10550551987273793, 'support': 283236}, '2': {'precision': 0.33011607392297715, 'recall': 0.6257975819527926, 'f1-score': 0.43222698944599297, 'support': 275677}, 'accuracy': 0.3307874694383086, 'macro avg': {'precision': 0.33472641610310133, 'recall': 0.3333392748759501, 'f1-score': 0.28605986224939417, 'support': 838877}, 'weighted avg': {'precision': 0.33478858249345256, 'recall': 0.3307874694383086, 'f1-score': 0.28460864558408056, 'support': 838877}}
[[ 87330  16885 175749]
 [ 91263  17642 174331]
 [ 86494  16665 172518]]
testing model out of sample: results/universal/W0/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 732s - 732s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987139
{'0': {'precision': 0.3265559269505272, 'recall': 0.27306272679606913, 'f1-score': 0.29742320825867097, 'support': 1926290}, '1': {'precision': 0.33845092594230325, 'recall': 0.05861573736310358, 'f1-score': 0.0999255410675174, 'support': 1958689}, '2': {'precision': 0.34108627948978587, 'recall': 0.6799013749599586, 'f1-score': 0.45427587570599187, 'support': 1947984}, 'accuracy': 0.336920532497806, 'macro avg': {'precision': 0.3353643774608721, 'recall': 0.3371932797063771, 'f1-score': 0.2838748750107267, 'support': 5832963}, 'weighted avg': {'precision': 0.3354028025334922, 'recall': 0.336920532497806, 'f1-score': 0.283486891208782, 'support': 5832963}}
[[ 525998  111871 1288421]
 [ 573740  114810 1270139]
 [ 511006  112541 1324437]]
Evaluating performance on  train set...
6334/6334 - 207s - 207s/epoch - 33ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988888
{'0': {'precision': 0.3259917920656635, 'recall': 0.3250221403455015, 'f1-score': 0.32550624408243606, 'support': 535222}, '1': {'precision': 0.339137564175142, 'recall': 0.06336198171682413, 'f1-score': 0.10677491868038665, 'support': 548373}, '2': {'precision': 0.33541697129209924, 'recall': 0.614779315286476, 'f1-score': 0.4340311972569855, 'support': 537305}, 'accuracy': 0.3325492010611389, 'macro avg': {'precision': 0.33351544251096826, 'recall': 0.33438781244960053, 'f1-score': 0.2887707866732694, 'support': 1620900}, 'weighted avg': {'precision': 0.3335635006308132, 'recall': 0.3325492010611389, 'f1-score': 0.28748085501509896, 'support': 1620900}}
[[173959  33773 327490]
 [186625  34746 327002]
 [173046  33935 330324]]
Evaluating performance on  val set...
2156/2156 - 70s - 70s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991291
{'0': {'precision': 0.3075253332768607, 'recall': 0.32538624421613993, 'f1-score': 0.31620376922993176, 'support': 178514}, '1': {'precision': 0.35187407153468175, 'recall': 0.06526150699665666, 'f1-score': 0.11010248640144456, 'support': 188733}, '2': {'precision': 0.3382471506578224, 'recall': 0.6016688124378677, 'f1-score': 0.4330445900216411, 'support': 184083}, 'accuracy': 0.32858723450564997, 'macro avg': {'precision': 0.3325488518231216, 'recall': 0.3307721878835548, 'f1-score': 0.28645028188433913, 'support': 551330}, 'weighted avg': {'precision': 0.33296460689983226, 'recall': 0.32858723450564997, 'f1-score': 0.28466239727798165, 'support': 551330}}
[[ 58086  11081 109347]
 [ 69076  12317 107340]
 [ 61720  11606 110757]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987228
{'0': {'precision': 0.30236838281590545, 'recall': 0.27103020129372096, 'f1-score': 0.28584292298769876, 'support': 69103}, '1': {'precision': 0.3423146202341639, 'recall': 0.05864729330075865, 'f1-score': 0.10013831865984588, 'support': 77770}, '2': {'precision': 0.3479212841695211, 'recall': 0.670298387722885, 'f1-score': 0.4580761544311409, 'support': 77282}, 'accuracy': 0.3350003345899043, 'macro avg': {'precision': 0.33086809573986353, 'recall': 0.3333252941057882, 'f1-score': 0.2813524653595619, 'support': 224155}, 'weighted avg': {'precision': 0.3319329172069656, 'recall': 0.3350003345899043, 'f1-score': 0.2807941019211822, 'support': 224155}}
[[18729  4069 46305]
 [22426  4561 50783]
 [20786  4694 51802]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098655
{'0': {'precision': 0.3432865832202282, 'recall': 0.25129714811407544, 'f1-score': 0.2901759156964392, 'support': 27175}, '1': {'precision': 0.32954545454545453, 'recall': 0.057207569226273104, 'f1-score': 0.09749112868081927, 'support': 27374}, '2': {'precision': 0.3311772087022604, 'recall': 0.7023876457138574, 'f1-score': 0.45012130383608373, 'support': 26679}, 'accuracy': 0.33404737282710395, 'macro avg': {'precision': 0.3346697488226477, 'recall': 0.33696412101806866, 'f1-score': 0.2792627827377807, 'support': 81228}, 'weighted avg': {'precision': 0.3346785212328825, 'recall': 0.33404737282710395, 'f1-score': 0.27777415337817446, 'support': 81228}}
[[ 6829  1599 18747]
 [ 6711  1566 19097]
 [ 6353  1587 18739]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987394
{'0': {'precision': 0.3101324874043665, 'recall': 0.18470771282507223, 'f1-score': 0.23152469178797797, 'support': 8998}, '1': {'precision': 0.2918454935622318, 'recall': 0.05043886759797256, 'f1-score': 0.08601243807315274, 'support': 8089}, '2': {'precision': 0.36137008512363195, 'recall': 0.758239421645758, 'f1-score': 0.4894653764326402, 'support': 9406}, 'accuracy': 0.3473370324236591, 'macro avg': {'precision': 0.3211160220300768, 'recall': 0.3311286673562676, 'f1-score': 0.26900083543125697, 'support': 26493}, 'weighted avg': {'precision': 0.32274024609377056, 'recall': 0.3473370324236591, 'f1-score': 0.2786745600350044, 'support': 26493}}
[[1662  486 6850]
 [1927  408 5754]
 [1770  504 7132]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993574
{'0': {'precision': 0.2932230328630855, 'recall': 0.37475361366622867, 'f1-score': 0.3290126735614558, 'support': 182640}, '1': {'precision': 0.3717374257869385, 'recall': 0.05860149307103787, 'f1-score': 0.10124284477597142, 'support': 226513}, '2': {'precision': 0.32622356621854615, 'recall': 0.5609114496364991, 'f1-score': 0.41252465557763957, 'support': 194635}, 'accuracy': 0.316157326743824, 'macro avg': {'precision': 0.33039467495619007, 'recall': 0.33142218545792185, 'f1-score': 0.2809267246383556, 'support': 603788}, 'weighted avg': {'precision': 0.333315895745423, 'recall': 0.316157326743824, 'f1-score': 0.27048472565926746, 'support': 603788}}
[[ 68445  10656 103539]
 [ 91294  13274 121945]
 [ 73684  11778 109173]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986787
{'0': {'precision': 0.34441130270566017, 'recall': 0.37808304109429797, 'f1-score': 0.3604625387911926, 'support': 51613}, '1': {'precision': 0.3430388219544846, 'recall': 0.060794780545670224, 'f1-score': 0.10328496573962112, 'support': 50580}, '2': {'precision': 0.3289532451047225, 'recall': 0.5769294195250659, 'f1-score': 0.4190008533317365, 'support': 48512}, 'accuracy': 0.3356026674629243, 'macro avg': {'precision': 0.33880112325495576, 'recall': 0.33860241372167804, 'f1-score': 0.29424945262085006, 'support': 150705}, 'weighted avg': {'precision': 0.33897471223599324, 'recall': 0.3356026674629243, 'f1-score': 0.29299144672419003, 'support': 150705}}
[[19514  3003 29096]
 [19507  3075 27998]
 [17638  2886 27988]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984727
{'0': {'precision': 0.33688588510527684, 'recall': 0.3942605080363028, 'f1-score': 0.36332204181754474, 'support': 19723}, '1': {'precision': 0.32122587968217936, 'recall': 0.06173647469458988, 'f1-score': 0.10356816102470265, 'support': 18336}, '2': {'precision': 0.35521822809958403, 'recall': 0.5511776889359857, 'f1-score': 0.43201510146295424, 'support': 20761}, 'accuracy': 0.3459877592655559, 'macro avg': {'precision': 0.3377766642956801, 'recall': 0.3357248905556261, 'f1-score': 0.29963510143506716, 'support': 58820}, 'weighted avg': {'precision': 0.33847473096496566, 'recall': 0.3459877592655559, 'f1-score': 0.30659455887094145, 'support': 58820}}
[[ 7776  1164 10783]
 [ 7216  1132  9988]
 [ 8090  1228 11443]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991315
{'0': {'precision': 0.286499992496661, 'recall': 0.3322456580000696, 'f1-score': 0.30768177019959875, 'support': 114924}, '1': {'precision': 0.42280934886265925, 'recall': 0.06074593174084431, 'f1-score': 0.10622962410149653, 'support': 178086}, '2': {'precision': 0.30455541244635026, 'recall': 0.6371488346724627, 'f1-score': 0.41211904210282435, 'support': 122841}, 'accuracy': 0.30604471313042414, 'macro avg': {'precision': 0.33795491793522353, 'recall': 0.34338014147112556, 'f1-score': 0.27534347880130655, 'support': 415851}, 'weighted avg': {'precision': 0.3502072671691638, 'recall': 0.30604471313042414, 'f1-score': 0.2522613720950794, 'support': 415851}}
[[ 38183   7195  69546]
 [ 58091  10818 109177]
 [ 37000   7573  78268]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985979
{'0': {'precision': 0.3152975449883167, 'recall': 0.27759965801004594, 'f1-score': 0.295250138531706, 'support': 37428}, '1': {'precision': 0.31634881350997235, 'recall': 0.05946093856888767, 'f1-score': 0.1001059566038605, 'support': 36545}, '2': {'precision': 0.36322526048553444, 'recall': 0.6622947657738023, 'f1-score': 0.46915161607104733, 'support': 41477}, 'accuracy': 0.34675617150281507, 'macro avg': {'precision': 0.33162387299460777, 'recall': 0.3331184541175786, 'f1-score': 0.28816923706887126, 'support': 115450}, 'weighted avg': {'precision': 0.3328490085119374, 'recall': 0.34675617150281507, 'f1-score': 0.29595492376640625, 'support': 115450}}
[[10390  2229 24809]
 [11023  2173 23349]
 [11540  2467 27470]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988413
{'0': {'precision': 0.3346735164916983, 'recall': 0.29018721755971594, 'f1-score': 0.3108467895300992, 'support': 15490}, '1': {'precision': 0.32295573893473367, 'recall': 0.058559477657620894, 'f1-score': 0.09914214980712764, 'support': 14703}, '2': {'precision': 0.3350099910425136, 'recall': 0.6513060951105157, 'f1-score': 0.4424424424424424, 'support': 14930}, 'accuracy': 0.3341976375684241, 'macro avg': {'precision': 0.3308797488229819, 'recall': 0.33335093010928424, 'f1-score': 0.2841437939265564, 'support': 45123}, 'weighted avg': {'precision': 0.3309666947294844, 'recall': 0.3341976375684241, 'f1-score': 0.28540587868938455, 'support': 45123}}
[[ 4495   907 10088]
 [ 4628   861  9214]
 [ 4308   898  9724]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987647
{'0': {'precision': 0.30133156992996485, 'recall': 0.10321431513054938, 'f1-score': 0.15376120616271846, 'support': 97128}, '1': {'precision': 0.3854718014236174, 'recall': 0.05052470415616727, 'f1-score': 0.08933947166193132, 'support': 125404}, '2': {'precision': 0.3149153996611624, 'recall': 0.8472885202284999, 'f1-score': 0.45916933923507114, 'support': 102232}, 'accuracy': 0.317094875047727, 'macro avg': {'precision': 0.3339062570049149, 'recall': 0.3336758465050722, 'f1-score': 0.23409000568657365, 'support': 324764}, 'weighted avg': {'precision': 0.33809741734935184, 'recall': 0.317094875047727, 'f1-score': 0.2250244652275041, 'support': 324764}}
[[ 10025   4893  82210]
 [ 12840   6336 106228]
 [ 10404   5208  86620]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098705
{'0': {'precision': 0.34423177180308334, 'recall': 0.11114851866102347, 'f1-score': 0.1680391194488375, 'support': 41584}, '1': {'precision': 0.32977366911061523, 'recall': 0.05040194884287454, 'f1-score': 0.0874397768574085, 'support': 41050}, '2': {'precision': 0.33620904030453164, 'recall': 0.8445736527233848, 'f1-score': 0.4809577561142467, 'support': 41621}, 'accuracy': 0.3367510361756066, 'macro avg': {'precision': 0.3367381604060768, 'recall': 0.3353747067424276, 'f1-score': 0.2454788841401642, 'support': 124255}, 'weighted avg': {'precision': 0.33676793354122636, 'recall': 0.3367510361756066, 'f1-score': 0.24622819484437758, 'support': 124255}}
[[ 4622  2114 34848]
 [ 4427  2069 34554]
 [ 4378  2091 35152]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982463
{'0': {'precision': 0.3174068617133235, 'recall': 0.1072622519382602, 'f1-score': 0.16034024455077087, 'support': 14059}, '1': {'precision': 0.3391047297297297, 'recall': 0.05181313717899084, 'f1-score': 0.08989141385872608, 'support': 15498}, '2': {'precision': 0.3509544022291086, 'recall': 0.8442648624945186, 'f1-score': 0.49580604812007945, 'support': 15963}, 'accuracy': 0.3468365553602812, 'macro avg': {'precision': 0.33582199789072065, 'recall': 0.33444675053725653, 'f1-score': 0.24867923550985882, 'support': 45520}, 'weighted avg': {'precision': 0.33655872787702606, 'recall': 0.3468365553602812, 'f1-score': 0.25399632197413563, 'support': 45520}}
[[ 1508   723 11828]
 [ 1599   803 13096]
 [ 1644   842 13477]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984076
{'0': {'precision': 0.3103159451566898, 'recall': 0.2925496724075378, 'f1-score': 0.3011710253612309, 'support': 140571}, '1': {'precision': 0.33012217177868824, 'recall': 0.061192794247439466, 'f1-score': 0.10324725547462107, 'support': 146161}, '2': {'precision': 0.3628828866909009, 'recall': 0.6571054981502743, 'f1-score': 0.46755893218600514, 'support': 156780}, 'accuracy': 0.34517442594563397, 'macro avg': {'precision': 0.334440334542093, 'recall': 0.3369493216017505, 'f1-score': 0.29065907100728566, 'support': 443512}, 'weighted avg': {'precision': 0.3354253964974236, 'recall': 0.34517442594563397, 'f1-score': 0.29476208919172775, 'support': 443512}}
[[ 41124   8579  90868]
 [ 47210   8944  90007]
 [ 44189   9570 103021]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987551
{'0': {'precision': 0.29350481032849807, 'recall': 0.2911680348135694, 'f1-score': 0.29233175284859614, 'support': 60666}, '1': {'precision': 0.3457769859907685, 'recall': 0.06482071834107539, 'f1-score': 0.1091750508162561, 'support': 65874}, '2': {'precision': 0.36085594650740066, 'recall': 0.6423928117415925, 'f1-score': 0.46212121212121215, 'support': 69224}, 'accuracy': 0.3391992399011054, 'macro avg': {'precision': 0.33337924760888904, 'recall': 0.3327938549654124, 'f1-score': 0.28787600526202145, 'support': 195764}, 'weighted avg': {'precision': 0.33491023906118, 'recall': 0.3391992399011054, 'f1-score': 0.29073922786447853, 'support': 195764}}
[[17664  3769 39233]
 [22074  4270 39530]
 [20445  4310 44469]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993472
{'0': {'precision': 0.2926950885066068, 'recall': 0.2820081671871247, 'f1-score': 0.28725226327379494, 'support': 20815}, '1': {'precision': 0.34451068057625434, 'recall': 0.06192793677724695, 'f1-score': 0.10498429398629981, 'support': 22397}, '2': {'precision': 0.3302163053375003, 'recall': 0.6239654050032549, 'f1-score': 0.43187486925317414, 'support': 21506}, 'accuracy': 0.319478352235854, 'macro avg': {'precision': 0.32247402480678716, 'recall': 0.3226338363225422, 'f1-score': 0.2747038088377563, 'support': 64718}, 'weighted avg': {'precision': 0.32309536516455506, 'recall': 0.319478352235854, 'f1-score': 0.2722332277050274, 'support': 64718}}
[[ 5870  1270 13675]
 [ 7467  1387 13543]
 [ 6718  1369 13419]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
4693/4693 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000742
{'0': {'precision': 0.25613273275219545, 'recall': 0.41523236648038825, 'f1-score': 0.3168308894083221, 'support': 304562}, '1': {'precision': 0.48701773998216685, 'recall': 0.06307797054235506, 'f1-score': 0.11168998437347398, 'support': 580155}, '2': {'precision': 0.271390321473588, 'recall': 0.542229244016115, 'f1-score': 0.36173114582696553, 'support': 316475}, 'accuracy': 0.2786074166328114, 'macro avg': {'precision': 0.33818026473598345, 'recall': 0.34017986034628606, 'f1-score': 0.2634173398695872, 'support': 1201192}, 'weighted avg': {'precision': 0.37166608359045183, 'recall': 0.2786074166328114, 'f1-score': 0.22958112991075458, 'support': 1201192}}
[[126464  19042 159056]
 [241911  36595 301649]
 [125369  19504 171602]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985382
{'0': {'precision': 0.33394865461425266, 'recall': 0.4036606185730734, 'f1-score': 0.36551037356332167, 'support': 125935}, '1': {'precision': 0.33348862818177966, 'recall': 0.06222194125502778, 'f1-score': 0.10487619707241706, 'support': 126547}, '2': {'precision': 0.34555794591778655, 'recall': 0.5482562544483305, 'f1-score': 0.42392323828854284, 'support': 130667}, 'accuracy': 0.34020185358698574, 'macro avg': {'precision': 0.3376650762379396, 'recall': 0.3380462714254772, 'f1-score': 0.2981032696414272, 'support': 383149}, 'weighted avg': {'precision': 0.33775588444340193, 'recall': 0.34020185358698574, 'f1-score': 0.29934854268983896, 'support': 383149}}
[[50835  7643 67457]
 [50455  7874 68218]
 [50934  8094 71639]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987644
{'0': {'precision': 0.33724340175953077, 'recall': 0.409374800162002, 'f1-score': 0.3698247641055266, 'support': 46913}, '1': {'precision': 0.3330594036158723, 'recall': 0.06064038987688099, 'f1-score': 0.10260026762142418, 'support': 46784}, '2': {'precision': 0.3285283993115318, 'recall': 0.5295647650424831, 'f1-score': 0.40549691296554474, 'support': 46136}, 'accuracy': 0.3323535932147633, 'macro avg': {'precision': 0.33294373489564494, 'recall': 0.33319331836045535, 'f1-score': 0.29264064823083186, 'support': 139833}, 'weighted avg': {'precision': 0.33296816256639467, 'recall': 0.3323535932147633, 'f1-score': 0.29218886568593716, 'support': 139833}}
[[19205  2858 24850]
 [18861  2837 25086]
 [18881  2823 24432]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
6677/6677 - 97s - 97s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001779
{'0': {'precision': 0.2631624967707319, 'recall': 0.28905958391450404, 'f1-score': 0.2755038035569212, 'support': 458127}, '1': {'precision': 0.49165871311540604, 'recall': 0.058780878890208256, 'f1-score': 0.1050074583685018, 'support': 841311}, '2': {'precision': 0.24357571108610465, 'recall': 0.6570021080986121, 'f1-score': 0.3553935090474745, 'support': 409848}, 'accuracy': 0.26394061614030656, 'macro avg': {'precision': 0.33279897365741423, 'recall': 0.33494752363444147, 'f1-score': 0.24530159032429918, 'support': 1709286}, 'weighted avg': {'precision': 0.3709319252513261, 'recall': 0.26394061614030656, 'f1-score': 0.21074119820537557, 'support': 1709286}}
[[132426  26828 298873]
 [254510  49453 537348]
 [116274  24303 269271]]
Evaluating performance on  train set...
2262/2262 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988233
{'0': {'precision': 0.333787133627169, 'recall': 0.30424756340322123, 'f1-score': 0.31833354071204834, 'support': 193405}, '1': {'precision': 0.33813273340832395, 'recall': 0.06163941149331009, 'f1-score': 0.10427091011576983, 'support': 195070}, '2': {'precision': 0.33103623046236347, 'recall': 0.6381922482900639, 'f1-score': 0.4359441779015397, 'support': 190358}, 'accuracy': 0.3323100099683328, 'macro avg': {'precision': 0.33431869916595214, 'recall': 0.3346930743955318, 'f1-score': 0.2861828762431193, 'support': 578833}, 'weighted avg': {'precision': 0.3343469491951547, 'recall': 0.3323100099683328, 'f1-score': 0.28487126113175687, 'support': 578833}}
[[ 58843  11718 122844]
 [ 60391  12024 122655]
 [ 57055  11818 121485]]
Evaluating performance on  val set...
827/827 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988921
{'0': {'precision': 0.3087742893568136, 'recall': 0.3351836362253821, 'f1-score': 0.3214374261671067, 'support': 65755}, '1': {'precision': 0.3625414031918097, 'recall': 0.06349792339640055, 'f1-score': 0.10806808109593959, 'support': 75845}, '2': {'precision': 0.3353716676779537, 'recall': 0.6082985535418215, 'f1-score': 0.43236735834201107, 'support': 69964}, 'accuracy': 0.32810402525949595, 'macro avg': {'precision': 0.335562453408859, 'recall': 0.3356600377212014, 'f1-score': 0.2872909552016858, 'support': 211564}, 'weighted avg': {'precision': 0.3368453492993158, 'recall': 0.32810402525949595, 'f1-score': 0.2816296318247911, 'support': 211564}}
[[22040  4062 39653]
 [26340  4816 44689]
 [22999  4406 42559]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
5633/5633 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996739
{'0': {'precision': 0.2725626252221455, 'recall': 0.4229781852036809, 'f1-score': 0.3315061973149558, 'support': 398491}, '1': {'precision': 0.40704653191645906, 'recall': 0.06552700285790188, 'f1-score': 0.1128820693394274, 'support': 590993}, '2': {'precision': 0.32427975515382523, 'recall': 0.5220979330164696, 'f1-score': 0.40007148640911233, 'support': 452350}, 'accuracy': 0.307559677466338, 'macro avg': {'precision': 0.33462963743081, 'recall': 0.3368677070260175, 'f1-score': 0.2814865843544985, 'support': 1441834}, 'weighted avg': {'precision': 0.343911540002618, 'recall': 0.307559677466338, 'f1-score': 0.26340555553310036, 'support': 1441834}}
[[168553  26537 203401]
 [263545  38726 288722]
 [186303  29876 236171]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984318
{'0': {'precision': 0.3379215416379904, 'recall': 0.36412458845389056, 'f1-score': 0.35053406608062576, 'support': 122708}, '1': {'precision': 0.33058955352525426, 'recall': 0.06247353161546731, 'f1-score': 0.10508795002465887, 'support': 122788}, '2': {'precision': 0.3505409197481862, 'recall': 0.5999336487649981, 'f1-score': 0.44251850600261605, 'support': 126599}, 'accuracy': 0.34481248068369635, 'macro avg': {'precision': 0.33968400497047696, 'recall': 0.3421772562781187, 'f1-score': 0.2993801740359669, 'support': 372095}, 'weighted avg': {'precision': 0.3397955805070589, 'recall': 0.34481248068369635, 'f1-score': 0.3008351999615002, 'support': 372095}}
[[44681  7620 70407]
 [44807  7671 70310]
 [42735  7913 75951]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986971
{'0': {'precision': 0.3405271466538777, 'recall': 0.34910781963821114, 'f1-score': 0.34476410131909035, 'support': 48813}, '1': {'precision': 0.34009033821747275, 'recall': 0.06669691470054447, 'f1-score': 0.11152255197702354, 'support': 46284}, '2': {'precision': 0.33764752494267086, 'recall': 0.5943906666103056, 'f1-score': 0.4306573255235251, 'support': 47314}, 'accuracy': 0.3388151196185688, 'macro avg': {'precision': 0.3394216699380071, 'recall': 0.33673180031635375, 'f1-score': 0.29564799293987964, 'support': 142411}, 'weighted avg': {'precision': 0.3394284698429951, 'recall': 0.3388151196185688, 'f1-score': 0.29749668616338193, 'support': 142411}}
[[17041  2982 28790]
 [16819  3087 26378]
 [16183  3008 28123]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
11876/11876 - 169s - 169s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097883
{'0': {'precision': 0.37901076965035446, 'recall': 0.2588431790060032, 'f1-score': 0.30760757286355916, 'support': 1143565}, '1': {'precision': 0.23793179292461566, 'recall': 0.05746329475607421, 'f1-score': 0.09256988568102155, 'support': 715361}, '2': {'precision': 0.39402463573619634, 'recall': 0.6959617619893789, 'f1-score': 0.5031733979917573, 'support': 1181233}, 'accuracy': 0.3812971624181498, 'macro avg': {'precision': 0.3369890661037222, 'recall': 0.33742274525048543, 'f1-score': 0.3011169521787793, 'support': 3040159}, 'weighted avg': {'precision': 0.35164788376467415, 'recall': 0.3812971624181498, 'f1-score': 0.33299415013569184, 'support': 3040159}}
[[296004  65337 782224]
 [192171  41107 482083]
 [292816  66324 822093]]
Evaluating performance on  train set...
2538/2538 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991126
{'0': {'precision': 0.3290166570513214, 'recall': 0.3713356853907679, 'f1-score': 0.3488976003852921, 'support': 216548}, '1': {'precision': 0.34023131222551795, 'recall': 0.0662028544584135, 'f1-score': 0.11083853618525774, 'support': 223510}, '2': {'precision': 0.3262544473409946, 'recall': 0.5631468694975831, 'f1-score': 0.41315245930334327, 'support': 209567}, 'accuracy': 0.32822936309409273, 'macro avg': {'precision': 0.3318341388726113, 'recall': 0.3335618031155882, 'f1-score': 0.2909628652912977, 'support': 649625}, 'weighted avg': {'precision': 0.3319840914567408, 'recall': 0.32822936309409273, 'f1-score': 0.2877194077041754, 'support': 649625}}
[[ 80412  14597 121539]
 [ 86536  14797 122177]
 [ 77453  14097 118017]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994033
{'0': {'precision': 0.3050115534679344, 'recall': 0.35810009487666034, 'f1-score': 0.32943069695130683, 'support': 67456}, '1': {'precision': 0.3451747447145117, 'recall': 0.07090208127151065, 'f1-score': 0.11763985049935666, 'support': 67699}, '2': {'precision': 0.34049977793689784, 'recall': 0.5502145671309518, 'f1-score': 0.4206689584896365, 'support': 68277}, 'accuracy': 0.32700361791655197, 'macro avg': {'precision': 0.3302286920397813, 'recall': 0.3264055810930409, 'f1-score': 0.2892465019801, 'support': 203432}, 'weighted avg': {'precision': 0.33028799663454267, 'recall': 0.32700361791655197, 'f1-score': 0.2895719051638887, 'support': 203432}}
[[24156  4438 38862]
 [28999  4800 33900]
 [26042  4668 37567]]
testing model on single stock: results/universal/W0/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
19053/19053 - 273s - 273s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002417
{'0': {'precision': 0.25489453190147127, 'recall': 0.33058335057460453, 'f1-score': 0.2878465298903141, 'support': 1276008}, '1': {'precision': 0.48678465024409256, 'recall': 0.062154724675943594, 'f1-score': 0.11023427101327701, 'support': 2371115}, '2': {'precision': 0.2535529108439, 'recall': 0.601726531461529, 'f1-score': 0.35677114645201563, 'support': 1230328}, 'accuracy': 0.26848532153372734, 'macro avg': {'precision': 0.3317440309964879, 'recall': 0.33148820223735903, 'f1-score': 0.25161731578520224, 'support': 4877451}, 'weighted avg': {'precision': 0.36728674332531636, 'recall': 0.26848532153372734, 'f1-score': 0.2188885422934934, 'support': 4877451}}
[[ 421827   79048  775133]
 [ 819404  147376 1404335]
 [ 413677   76330  740321]]
Evaluating performance on  train set...
4812/4812 - 70s - 70s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098758
{'0': {'precision': 0.32175392606221453, 'recall': 0.2927765198001832, 'f1-score': 0.3065820264522218, 'support': 404971}, '1': {'precision': 0.3300993816544354, 'recall': 0.061812889649340175, 'f1-score': 0.10412736801346732, 'support': 406776}, '2': {'precision': 0.3446401032522948, 'recall': 0.6457663387452662, 'f1-score': 0.4494255453612508, 'support': 420121}, 'accuracy': 0.33689486211184966, 'macro avg': {'precision': 0.3321644703229816, 'recall': 0.33345191606492985, 'f1-score': 0.28671164660898, 'support': 1231868}, 'weighted avg': {'precision': 0.33231487471195215, 'recall': 0.33689486211184966, 'f1-score': 0.2884452340901322, 'support': 1231868}}
[[118566  24975 261430]
 [127164  25144 254468]
 [122769  26052 271300]]
Evaluating performance on  val set...
1767/1767 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990609
{'0': {'precision': 0.32311811505507954, 'recall': 0.2807332376242888, 'f1-score': 0.3004381597291376, 'support': 150456}, '1': {'precision': 0.3534724721122706, 'recall': 0.06283342075300319, 'f1-score': 0.10669983272142686, 'support': 156334}, '2': {'precision': 0.32396700966359526, 'recall': 0.6541170972419813, 'f1-score': 0.4333213441812396, 'support': 145503}, 'accuracy': 0.3255345539285375, 'macro avg': {'precision': 0.3335191989436484, 'recall': 0.3325612518730911, 'f1-score': 0.28015311221060135, 'support': 452293}, 'weighted avg': {'precision': 0.3338831164333936, 'recall': 0.3255345539285375, 'f1-score': 0.2762215885527337, 'support': 452293}}
[[42238  9106 99112]
 [47016  9823 99495]
 [41466  8861 95176]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        78 (peak)  20.06 (ave)

============================================
