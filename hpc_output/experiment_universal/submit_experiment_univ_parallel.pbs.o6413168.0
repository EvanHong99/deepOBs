This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W0/deepLOB_L1/h10
Epoch 1/50
8838/8838 - 178s - loss: 2.9361 - accuracy10: 0.5034 - val_loss: 3.2626 - val_accuracy10: 0.4515 - 178s/epoch - 20ms/step
Epoch 2/50
8838/8838 - 141s - loss: 2.8831 - accuracy10: 0.5149 - val_loss: 3.2929 - val_accuracy10: 0.4597 - 141s/epoch - 16ms/step
Epoch 3/50
8838/8838 - 141s - loss: 2.8466 - accuracy10: 0.5221 - val_loss: 3.3123 - val_accuracy10: 0.4664 - 141s/epoch - 16ms/step
Epoch 4/50
8838/8838 - 139s - loss: 2.8270 - accuracy10: 0.5256 - val_loss: 3.3306 - val_accuracy10: 0.4674 - 139s/epoch - 16ms/step
Epoch 5/50
8838/8838 - 140s - loss: 2.8130 - accuracy10: 0.5286 - val_loss: 3.3157 - val_accuracy10: 0.4715 - 140s/epoch - 16ms/step
Epoch 6/50
8838/8838 - 141s - loss: 2.8019 - accuracy10: 0.5307 - val_loss: 3.3680 - val_accuracy10: 0.4718 - 141s/epoch - 16ms/step
Epoch 7/50
8838/8838 - 140s - loss: 2.7931 - accuracy10: 0.5329 - val_loss: 3.3984 - val_accuracy10: 0.4722 - 140s/epoch - 16ms/step
Epoch 8/50
8838/8838 - 137s - loss: 2.7855 - accuracy10: 0.5343 - val_loss: 3.3953 - val_accuracy10: 0.4749 - 137s/epoch - 16ms/step
Epoch 9/50
8838/8838 - 143s - loss: 2.7795 - accuracy10: 0.5355 - val_loss: 3.4684 - val_accuracy10: 0.4755 - 143s/epoch - 16ms/step
Epoch 10/50
8838/8838 - 142s - loss: 2.7745 - accuracy10: 0.5370 - val_loss: 3.4902 - val_accuracy10: 0.4761 - 142s/epoch - 16ms/step
Epoch 11/50
8838/8838 - 139s - loss: 2.7707 - accuracy10: 0.5377 - val_loss: 3.4658 - val_accuracy10: 0.4761 - 139s/epoch - 16ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 221s - 221s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9476783
{'0': {'precision': 0.34782591379168887, 'recall': 0.25102023805075463, 'f1-score': 0.29159857974066977, 'support': 1739545}, '1': {'precision': 0.6179176971631304, 'recall': 0.7688781830115454, 'f1-score': 0.6851814935960493, 'support': 4986669}, '2': {'precision': 0.37417694120502887, 'recall': 0.21473286452695153, 'f1-score': 0.2728706013818894, 'support': 1722815}, 'accuracy': 0.5492639450048047, 'macro avg': {'precision': 0.4466401840532827, 'recall': 0.4115437618630839, 'f1-score': 0.4165502249062028, 'support': 8449029}, 'weighted avg': {'precision': 0.5126089046639176, 'recall': 0.5492639450048047, 'f1-score': 0.5200748784273129, 'support': 8449029}}
[[ 436661 1170851  132033]
 [ 665816 3834141  486712]
 [ 152924 1199946  369945]]
Evaluating performance on  train set...
8838/8838 - 61s - 61s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0485029
{'0': {'precision': 0.40202609320581567, 'recall': 0.28785030082330587, 'f1-score': 0.3354900468249025, 'support': 606336}, '1': {'precision': 0.47073681262537426, 'recall': 0.6880425715962804, 'f1-score': 0.5590140306497633, 'support': 1035808}, '2': {'precision': 0.3876274409256965, 'recall': 0.19631795950497477, 'f1-score': 0.2606347380921023, 'support': 619928}, 'accuracy': 0.44601453888293563, 'macro avg': {'precision': 0.4201301155856288, 'recall': 0.39073694397485365, 'f1-score': 0.3850462718555894, 'support': 2262072}, 'weighted avg': {'precision': 0.4295428942403647, 'recall': 0.44601453888293563, 'f1-score': 0.41732786136199684, 'support': 2262072}}
[[174534 378651  53151]
 [184013 712680 139115]
 [ 75589 422636 121703]]
Evaluating performance on  val set...
3279/3279 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0364366
{'0': {'precision': 0.3916877456512433, 'recall': 0.22913991713336065, 'f1-score': 0.2891343377906726, 'support': 219630}, '1': {'precision': 0.4767779971189244, 'recall': 0.7252456288962044, 'f1-score': 0.575331717082298, 'support': 394294}, '2': {'precision': 0.3834978664930932, 'recall': 0.18857716945317465, 'f1-score': 0.25283026739657116, 'support': 224953}, 'accuracy': 0.45144520591218973, 'macro avg': {'precision': 0.4173212030877536, 'recall': 0.3809875718275799, 'f1-score': 0.3724321074231806, 'support': 838877}, 'weighted avg': {'precision': 0.42948618061362104, 'recall': 0.45144520591218973, 'f1-score': 0.41391925849185746, 'support': 838877}}
[[ 50326 151686  17618]
 [ 57757 285960  50577]
 [ 20402 162130  42421]]
testing model out of sample: results/universal/W0/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 155s - 155s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9618069
{'0': {'precision': 0.39752142998139445, 'recall': 0.3006270590636119, 'f1-score': 0.34235037469905394, 'support': 1259371}, '1': {'precision': 0.6224082704719807, 'recall': 0.7087209878404395, 'f1-score': 0.6627662964124117, 'support': 3290086}, '2': {'precision': 0.3738740049320281, 'recall': 0.33038801532676904, 'f1-score': 0.3507884478176798, 'support': 1283506}, 'accuracy': 0.5373613719133826, 'macro avg': {'precision': 0.4646012351284678, 'recall': 0.4465786874102735, 'f1-score': 0.45196837297638187, 'support': 5832963}, 'weighted avg': {'precision': 0.5191655126794844, 'recall': 0.5373613719133826, 'f1-score': 0.5249378959438158, 'support': 5832963}}
[[ 378601  702732  178038]
 [ 426207 2331753  532126]
 [ 147596  711855  424055]]
Evaluating performance on  train set...
6334/6334 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96144146
{'0': {'precision': 0.3768238305057914, 'recall': 0.3735288476627203, 'f1-score': 0.3751691045449172, 'support': 344118}, '1': {'precision': 0.6481194413537635, 'recall': 0.6676597442366997, 'f1-score': 0.6577444987547808, 'support': 927420}, '2': {'precision': 0.3770136555593231, 'recall': 0.3500867295241039, 'f1-score': 0.36305159608888465, 'support': 349362}, 'accuracy': 0.5367672280831637, 'macro avg': {'precision': 0.4673189758062926, 'recall': 0.46375844047450804, 'f1-score': 0.46532173312952757, 'support': 1620900}, 'weighted avg': {'precision': 0.5320902214447625, 'recall': 0.5367672280831637, 'f1-score': 0.5342367059446921, 'support': 1620900}}
[[128538 164459  51121]
 [157237 619201 150982]
 [ 55334 171721 122307]]
Evaluating performance on  val set...
2156/2156 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9597283
{'0': {'precision': 0.3515132249138448, 'recall': 0.4338142197335806, 'f1-score': 0.3883512194343229, 'support': 112154}, '1': {'precision': 0.6703286231588118, 'recall': 0.608873872063656, 'f1-score': 0.6381250597339148, 'support': 323489}, '2': {'precision': 0.3739093924507705, 'recall': 0.3848919930502131, 'f1-score': 0.3793212137733631, 'support': 115687}, 'accuracy': 0.5262637621751038, 'macro avg': {'precision': 0.46525041350780905, 'recall': 0.4758600282824832, 'f1-score': 0.4685991643138669, 'support': 551330}, 'weighted avg': {'precision': 0.5432753633730443, 'recall': 0.5262637621751038, 'f1-score': 0.5330094741271116, 'support': 551330}}
[[ 48654  45751  17749]
 [ 69716 196964  56809]
 [ 20043  51117  44527]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
876/876 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9571988
{'0': {'precision': 0.32761527364999915, 'recall': 0.4208058935149012, 'f1-score': 0.3684087089082594, 'support': 44795}, '1': {'precision': 0.6536650171045203, 'recall': 0.7384954822441689, 'f1-score': 0.6934957029144072, 'support': 133252}, '2': {'precision': 0.45081814222609345, 'recall': 0.1571527717532749, 'f1-score': 0.23306154613145494, 'support': 46108}, 'accuracy': 0.5554281635475452, 'macro avg': {'precision': 0.477366144326871, 'recall': 0.43881804917078177, 'f1-score': 0.4316553193180405, 'support': 224155}, 'weighted avg': {'precision': 0.5467824493949452, 'recall': 0.5554281635475452, 'f1-score': 0.5338206120288426, 'support': 224155}}
[[18850 23312  2633]
 [28652 98406  6194]
 [10035 28827  7246]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.028561
{'0': {'precision': 0.39858768144370343, 'recall': 0.1912470588235294, 'f1-score': 0.2584748457673472, 'support': 21250}, '1': {'precision': 0.5145493620795525, 'recall': 0.7697037736330468, 'f1-score': 0.6167796280962166, 'support': 39193}, '2': {'precision': 0.38664946791357624, 'recall': 0.23074332451286986, 'f1-score': 0.28901141944620207, 'support': 20785}, 'accuracy': 0.48046240212734526, 'macro avg': {'precision': 0.43326217047894405, 'recall': 0.39723138565648203, 'f1-score': 0.38808863110325525, 'support': 81228}, 'weighted avg': {'precision': 0.451485086044791, 'recall': 0.48046240212734526, 'f1-score': 0.43917290576796736, 'support': 81228}}
[[ 4064 14426  2760]
 [ 4178 30167  4848]
 [ 1954 14035  4796]]
Evaluating performance on  val set...
104/104 - 1s - 736ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0036325
{'0': {'precision': 0.3815318539727989, 'recall': 0.25633215774286633, 'f1-score': 0.3066449324000384, 'support': 6238}, '1': {'precision': 0.5576952546355417, 'recall': 0.7962368728121354, 'f1-score': 0.6559524167142299, 'support': 13712}, '2': {'precision': 0.3996330275229358, 'recall': 0.16643741403026135, 'f1-score': 0.23500215796288304, 'support': 6543}, 'accuracy': 0.5135696221643453, 'macro avg': {'precision': 0.4462867120437588, 'recall': 0.406335481528421, 'f1-score': 0.39919983569238376, 'support': 26493}, 'weighted avg': {'precision': 0.4771793279631388, 'recall': 0.5135696221643453, 'f1-score': 0.46974256391681213, 'support': 26493}}
[[ 1599  4059   580]
 [ 1738 10918  1056]
 [  854  4600  1089]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
2359/2359 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8737924
{'0': {'precision': 0.2954316318264731, 'recall': 0.6167453404058592, 'f1-score': 0.39949722013168415, 'support': 82196}, '1': {'precision': 0.8376586264987418, 'recall': 0.6387644692497781, 'f1-score': 0.7248146815214888, 'support': 438257}, '2': {'precision': 0.3243739668156493, 'recall': 0.38144837103257934, 'f1-score': 0.350603585668356, 'support': 83335}, 'accuracy': 0.6002520752317039, 'macro avg': {'precision': 0.4858214083802881, 'recall': 0.5456527268960721, 'f1-score': 0.49163849577384294, 'support': 603788}, 'weighted avg': {'precision': 0.6929994627379974, 'recall': 0.6002520752317039, 'f1-score': 0.6288792278037647, 'support': 603788}}
[[ 50694  22747   8755]
 [100859 279943  57455]
 [ 20040  31507  31788]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89593554
{'0': {'precision': 0.3234724673993508, 'recall': 0.48603208556149735, 'f1-score': 0.38843017590645673, 'support': 23375}, '1': {'precision': 0.788578959459296, 'recall': 0.62572914268171, 'f1-score': 0.6977784196984043, 'support': 104232}, '2': {'precision': 0.3274729285801192, 'recall': 0.4661009611221751, 'f1-score': 0.38467860077893307, 'support': 23098}, 'accuracy': 0.5795958992734149, 'macro avg': {'precision': 0.479841451812922, 'recall': 0.5259540631217942, 'f1-score': 0.49029573212793137, 'support': 150705}, 'weighted avg': {'precision': 0.6457669004489881, 'recall': 0.5795958992734149, 'f1-score': 0.6018095081424591, 'support': 150705}}
[[11361  8672  3342]
 [20243 65221 18768]
 [ 3518  8814 10766]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89287055
{'0': {'precision': 0.34947856315179604, 'recall': 0.4786288616165891, 'f1-score': 0.40398267625128365, 'support': 9452}, '1': {'precision': 0.7775938697318008, 'recall': 0.6346533910389512, 'f1-score': 0.6988897765778672, 'support': 39973}, '2': {'precision': 0.3416603773584906, 'recall': 0.48185204896221395, 'f1-score': 0.39982336056524626, 'support': 9395}, 'accuracy': 0.5851751105066304, 'macro avg': {'precision': 0.4895776034140291, 'recall': 0.5317114338725848, 'f1-score': 0.5008986044647991, 'support': 58820}, 'weighted avg': {'precision': 0.6391691665927077, 'recall': 0.5851751105066304, 'f1-score': 0.6037318219582576, 'support': 58820}}
[[ 4524  3665  1263]
 [ 7144 25369  7460]
 [ 1277  3591  4527]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
1625/1625 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97028536
{'0': {'precision': 0.4388230506672868, 'recall': 0.494589838631173, 'f1-score': 0.46504055023344437, 'support': 106836}, '1': {'precision': 0.5991521788498902, 'recall': 0.5974366458002053, 'f1-score': 0.5982931825569002, 'support': 198724}, '2': {'precision': 0.46163255656178365, 'recall': 0.40718644313679264, 'f1-score': 0.4327035177816104, 'support': 110291}, 'accuracy': 0.5205566416817562, 'macro avg': {'precision': 0.49986926202632026, 'recall': 0.4997376425227236, 'f1-score': 0.498679083523985, 'support': 415851}, 'weighted avg': {'precision': 0.5214895078444239, 'recall': 0.5205566416817562, 'f1-score': 0.5201420468264578, 'support': 415851}}
[[ 52840  35732  18264]
 [ 45889 118725  34110]
 [ 21684  43698  44909]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0009824
{'0': {'precision': 0.42280156693232473, 'recall': 0.5052461662631155, 'f1-score': 0.46036181791439923, 'support': 30975}, '1': {'precision': 0.5651087567065022, 'recall': 0.5507399577167019, 'f1-score': 0.5578318436021222, 'support': 52976}, '2': {'precision': 0.4379989554577333, 'recall': 0.37274199180926376, 'f1-score': 0.40274419003515993, 'support': 31499}, 'accuracy': 0.4899696838458207, 'macro avg': {'precision': 0.4753030930321867, 'recall': 0.4762427052630271, 'f1-score': 0.4736459505172272, 'support': 115450}, 'weighted avg': {'precision': 0.49224780536141677, 'recall': 0.4899696838458207, 'f1-score': 0.4893672264918324, 'support': 115450}}
[[15650 10231  5094]
 [13829 29176  9971]
 [ 7536 12222 11741]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0016817
{'0': {'precision': 0.45148936170212767, 'recall': 0.4445654906561636, 'f1-score': 0.4480006755900858, 'support': 11933}, '1': {'precision': 0.5291224958684349, 'recall': 0.6344304286888018, 'f1-score': 0.577010989010989, 'support': 20691}, '2': {'precision': 0.4412657636618403, 'recall': 0.3023441875350028, 'f1-score': 0.3588282770735413, 'support': 12499}, 'accuracy': 0.49223234270771005, 'macro avg': {'precision': 0.4739592070774676, 'recall': 0.46044670229332274, 'f1-score': 0.46127998055820535, 'support': 45123}, 'weighted avg': {'precision': 0.48425585389301723, 'recall': 0.49223234270771005, 'f1-score': 0.4824573071512324, 'support': 45123}}
[[ 5305  5132  1496]
 [ 4275 13127  3289]
 [ 2170  6550  3779]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1204689
{'0': {'precision': 0.41770615792741433, 'recall': 0.39370993341076954, 'f1-score': 0.40535322229474674, 'support': 112781}, '1': {'precision': 0.3329837978475973, 'recall': 0.41772001661622454, 'f1-score': 0.3705695772151566, 'support': 101106}, '2': {'precision': 0.41659117945583723, 'recall': 0.344264365017091, 'f1-score': 0.376990084146486, 'support': 110877}, 'accuracy': 0.3843036789791972, 'macro avg': {'precision': 0.38909371174361623, 'recall': 0.38523143834802837, 'f1-score': 0.3843042945521298, 'support': 324764}, 'weighted avg': {'precision': 0.3909496073053533, 'recall': 0.3843036789791972, 'f1-score': 0.38484092755800947, 'support': 324764}}
[[44403 41982 26396]
 [31812 42234 27060]
 [30087 42619 38171]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1286938
{'0': {'precision': 0.4165851869958445, 'recall': 0.3303050124766819, 'f1-score': 0.36846159043307886, 'support': 41277}, '1': {'precision': 0.34652269784046763, 'recall': 0.4828923302036337, 'f1-score': 0.40349679562289226, 'support': 41005}, '2': {'precision': 0.40415879017013234, 'recall': 0.3310937983942058, 'f1-score': 0.36399591398412734, 'support': 41973}, 'accuracy': 0.3809263208723995, 'macro avg': {'precision': 0.3890888916688149, 'recall': 0.3814303803581738, 'f1-score': 0.3786514333466995, 'support': 124255}, 'weighted avg': {'precision': 0.38926648334784764, 'recall': 0.3809263208723995, 'f1-score': 0.3785149544926053, 'support': 124255}}
[[13634 18158  9485]
 [10201 19801 11003]
 [ 8893 19183 13897]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1274803
{'0': {'precision': 0.3959436283647752, 'recall': 0.3589050354849611, 'f1-score': 0.3765156349712827, 'support': 14795}, '1': {'precision': 0.34810188827694727, 'recall': 0.4764436667115359, 'f1-score': 0.4022844803091436, 'support': 14858}, '2': {'precision': 0.4290325320648942, 'recall': 0.3183336484527636, 'f1-score': 0.36548480463096955, 'support': 15867}, 'accuracy': 0.38312829525483305, 'macro avg': {'precision': 0.39102601623553895, 'recall': 0.38456078354975354, 'f1-score': 0.38142830663713195, 'support': 45520}, 'weighted avg': {'precision': 0.39186166572823833, 'recall': 0.38312829525483305, 'f1-score': 0.3810817008548545, 'support': 45520}}
[[5310 6263 3222]
 [4279 7079 3500]
 [3822 6994 5051]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
1733/1733 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0764211
{'0': {'precision': 0.4432954512593621, 'recall': 0.5312153470836105, 'f1-score': 0.4832893538003676, 'support': 144288}, '1': {'precision': 0.40539437896645514, 'recall': 0.524799989567508, 'f1-score': 0.45743335597189033, 'support': 153367}, '2': {'precision': 0.4922225151595043, 'recall': 0.24320396004305586, 'f1-score': 0.32555386281455917, 'support': 145857}, 'accuracy': 0.4342791175887011, 'macro avg': {'precision': 0.4469707817951072, 'recall': 0.43307309889805806, 'f1-score': 0.42209219086227234, 'support': 443512}, 'weighted avg': {'precision': 0.44627976962039134, 'recall': 0.4342791175887011, 'f1-score': 0.42247412821982605, 'support': 443512}}
[[76648 51389 16251]
 [52537 80487 20343]
 [43720 66664 35473]]
Evaluating performance on  train set...
765/765 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0671334
{'0': {'precision': 0.4688108713323824, 'recall': 0.46852342923711277, 'f1-score': 0.46866710621138014, 'support': 65239}, '1': {'precision': 0.40160551498934194, 'recall': 0.5493687377857741, 'f1-score': 0.464007336084365, 'support': 64474}, '2': {'precision': 0.4823809860983266, 'recall': 0.3094275635493785, 'f1-score': 0.37701531082826045, 'support': 66051}, 'accuracy': 0.4414703418401749, 'macro avg': {'precision': 0.45093245747335037, 'recall': 0.4424399101907552, 'f1-score': 0.43656325104133514, 'support': 195764}, 'weighted avg': {'precision': 0.4512556594729199, 'recall': 0.4414703418401749, 'f1-score': 0.4362090099525195, 'support': 195764}}
[[30566 24435 10238]
 [17361 35420 11693]
 [17272 28341 20438]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0572472
{'0': {'precision': 0.4541137030311496, 'recall': 0.45421944858420266, 'f1-score': 0.45416656965237834, 'support': 21472}, '1': {'precision': 0.40803452855245687, 'recall': 0.5255380814367844, 'f1-score': 0.45939154812584365, 'support': 21047}, '2': {'precision': 0.4948242732287857, 'recall': 0.35961079327897655, 'f1-score': 0.41651883543775436, 'support': 22199}, 'accuracy': 0.44496121635402824, 'macro avg': {'precision': 0.4523241682707974, 'recall': 0.4464561077666545, 'f1-score': 0.44335898440532545, 'support': 64718}, 'weighted avg': {'precision': 0.4530924347991937, 'recall': 0.44496121635402824, 'f1-score': 0.4429521945187306, 'support': 64718}}
[[ 9753  7572  4147]
 [ 5983 11061  4003]
 [ 5741  8475  7983]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8483873
{'0': {'precision': 0.2754434329978291, 'recall': 0.6529649989765782, 'f1-score': 0.3874478403067554, 'support': 136796}, '1': {'precision': 0.8744899472154677, 'recall': 0.6370994573013705, 'f1-score': 0.7371539772926115, 'support': 925744}, '2': {'precision': 0.3267445076655603, 'recall': 0.4771225802729135, 'f1-score': 0.3878680566141723, 'support': 138652}, 'accuracy': 0.6204403625731774, 'macro avg': {'precision': 0.4922259626262857, 'recall': 0.5890623455169541, 'f1-score': 0.5041566247378464, 'support': 1201192}, 'weighted avg': {'precision': 0.7430428782677976, 'recall': 0.6204403625731774, 'f1-score': 0.6570105928969244, 'support': 1201192}}
[[ 89323  33847  13626]
 [213269 589791 122684]
 [ 21696  50802  66154]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8835187
{'0': {'precision': 0.28324841051539884, 'recall': 0.6368207623682076, 'f1-score': 0.3920976249180737, 'support': 49320}, '1': {'precision': 0.8510178760167272, 'recall': 0.5891620565934357, 'f1-score': 0.6962844442959075, 'support': 282895}, '2': {'precision': 0.33454164758228094, 'recall': 0.5019044253347469, 'f1-score': 0.4014793991315205, 'support': 50934}, 'accuracy': 0.5836972039598172, 'macro avg': {'precision': 0.4896026447048023, 'recall': 0.5759624147654634, 'f1-score': 0.4966204894485005, 'support': 383149}, 'weighted avg': {'precision': 0.7092751329647928, 'recall': 0.5836972039598172, 'f1-score': 0.6179386986405159, 'support': 383149}}
[[ 31408  12093   5819]
 [ 71192 166671  45032]
 [  8285  17085  25564]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87417257
{'0': {'precision': 0.2706090310139804, 'recall': 0.6035481751388806, 'f1-score': 0.3736755487342591, 'support': 16741}, '1': {'precision': 0.8551933384123929, 'recall': 0.606169412522619, 'f1-score': 0.709463879802628, 'support': 105553}, '2': {'precision': 0.3202182238601055, 'recall': 0.5053309766805405, 'f1-score': 0.39202070017913615, 'support': 17539}, 'accuracy': 0.5932076119370964, 'macro avg': {'precision': 0.48200686442882623, 'recall': 0.57168285478068, 'f1-score': 0.49172004290534116, 'support': 139833}, 'weighted avg': {'precision': 0.7181051373133004, 'recall': 0.5932076119370964, 'f1-score': 0.6294465135312044, 'support': 139833}}
[[10104  4797  1840]
 [24595 63983 16975]
 [ 2639  6037  8863]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
6677/6677 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86487156
{'0': {'precision': 0.2863142698999207, 'recall': 0.42972854640980734, 'f1-score': 0.34365937962921395, 'support': 178152}, '1': {'precision': 0.8731725346865465, 'recall': 0.6620369200303876, 'f1-score': 0.7530861065802836, 'support': 1345286}, '2': {'precision': 0.25514214066640434, 'recall': 0.5792152726959666, 'f1-score': 0.3542420123931722, 'support': 185848}, 'accuracy': 0.6288192847773866, 'macro avg': {'precision': 0.47154298175095716, 'recall': 0.5569935797120539, 'f1-score': 0.4836624995342233, 'support': 1709286}, 'weighted avg': {'precision': 0.7448091793111896, 'recall': 0.6288192847773866, 'f1-score': 0.6670475106541055, 'support': 1709286}}
[[ 76557  70416  31179]
 [171576 890629 283081]
 [ 19255  58947 107646]]
Evaluating performance on  train set...
2262/2262 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91645485
{'0': {'precision': 0.33975219899744635, 'recall': 0.3457163205204704, 'f1-score': 0.34270831345761227, 'support': 103906}, '1': {'precision': 0.692317703681398, 'recall': 0.7363808107183766, 'f1-score': 0.7136697725562822, 'support': 368414}, '2': {'precision': 0.3694809271180808, 'recall': 0.28181536526057854, 'f1-score': 0.31974818113062836, 'support': 106513}, 'accuracy': 0.5826067276744761, 'macro avg': {'precision': 0.4671836099323084, 'recall': 0.45463749883314186, 'f1-score': 0.458708755714841, 'support': 578833}, 'weighted avg': {'precision': 0.5696225827885337, 'recall': 0.5826067276744761, 'f1-score': 0.5745918488086259, 'support': 578833}}
[[ 35922  57354  10630]
 [ 56527 271293  40594]
 [ 13281  63215  30017]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91466886
{'0': {'precision': 0.3103818432755712, 'recall': 0.47488048801947386, 'f1-score': 0.37540137947023705, 'support': 34097}, '1': {'precision': 0.7447932138495561, 'recall': 0.6355263899059314, 'f1-score': 0.6858349923255779, 'support': 142024}, '2': {'precision': 0.34380234505862645, 'recall': 0.37062325423920095, 'f1-score': 0.35670934542640287, 'support': 35443}, 'accuracy': 0.5652568489913218, 'macro avg': {'precision': 0.4663258007279179, 'recall': 0.4936767107215354, 'f1-score': 0.4726485724074059, 'support': 211564}, 'weighted avg': {'precision': 0.6076033145045916, 'recall': 0.5652568489913218, 'f1-score': 0.5806656100082838, 'support': 211564}}
[[16192 13979  3926]
 [30618 90260 21146]
 [ 5358 16949 13136]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
5633/5633 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8921659
{'0': {'precision': 0.33806456018940084, 'recall': 0.5156356471052894, 'f1-score': 0.40838256045181814, 'support': 230403}, '1': {'precision': 0.7727364405029474, 'recall': 0.6527421136877672, 'f1-score': 0.7076888193296133, 'support': 980211}, '2': {'precision': 0.3484381371207762, 'recall': 0.39544157079837383, 'f1-score': 0.3704548539293521, 'support': 231220}, 'accuracy': 0.5895706440547247, 'macro avg': {'precision': 0.48641304593770823, 'recall': 0.5212731105304768, 'f1-score': 0.49550874457026123, 'support': 1441834}, 'weighted avg': {'precision': 0.6352338161038087, 'recall': 0.5895706440547247, 'f1-score': 0.6057795167024945, 'support': 1441834}}
[[118804  85817  25782]
 [195191 639825 145195]
 [ 37429 102357  91434]]
Evaluating performance on  train set...
1454/1454 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9787751
{'0': {'precision': 0.4087371197650697, 'recall': 0.36733502271320634, 'f1-score': 0.3869317063570163, 'support': 85633}, '1': {'precision': 0.6203327400121408, 'recall': 0.6002698087941737, 'f1-score': 0.6101363881306148, 'support': 200883}, '2': {'precision': 0.37541439205955335, 'recall': 0.44196590284999826, 'f1-score': 0.40598081887414195, 'support': 85579}, 'accuracy': 0.5102541017750843, 'macro avg': {'precision': 0.4681614172789213, 'recall': 0.4698569114524594, 'f1-score': 0.467682971120591, 'support': 372095}, 'weighted avg': {'precision': 0.5153073162680649, 'recall': 0.5102541017750843, 'f1-score': 0.5118144112813741, 'support': 372095}}
[[ 31456  37923  16254]
 [ 33626 120584  46673]
 [ 11877  35879  37823]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9544041
{'0': {'precision': 0.42536970698998805, 'recall': 0.29858156028368793, 'f1-score': 0.35087320528847976, 'support': 31020}, '1': {'precision': 0.6336642948409861, 'recall': 0.675455147509028, 'f1-score': 0.6538926791503363, 'support': 80029}, '2': {'precision': 0.3835833569204642, 'recall': 0.4321152987692111, 'f1-score': 0.40640556588496374, 'support': 31362}, 'accuracy': 0.539775719572224, 'macro avg': {'precision': 0.48087245291714603, 'recall': 0.4687173355206424, 'f1-score': 0.47039048344125994, 'support': 142411}, 'weighted avg': {'precision': 0.5332202526658636, 'recall': 0.539775719572224, 'f1-score': 0.5333868549834994, 'support': 142411}}
[[ 9262 16419  5339]
 [ 9534 54056 16439]
 [ 2978 14832 13552]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
11876/11876 - 80s - 80s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99879956
{'0': {'precision': 0.4602446712473795, 'recall': 0.19541321787851776, 'f1-score': 0.2743439641664141, 'support': 785300}, '1': {'precision': 0.5247794337925185, 'recall': 0.7837695800561442, 'f1-score': 0.6286446317145473, 'support': 1459457}, '2': {'precision': 0.43451150946582645, 'recall': 0.28788964573888426, 'f1-score': 0.34632105341563807, 'support': 795402}, 'accuracy': 0.5020540044122692, 'macro avg': {'precision': 0.47317853816857486, 'recall': 0.4223574812245154, 'f1-score': 0.4164365497655331, 'support': 3040159}, 'weighted avg': {'precision': 0.484492581502228, 'recall': 0.5020540044122692, 'f1-score': 0.4632608300608647, 'support': 3040159}}
[[ 153458  522027  109815]
 [ 127381 1143878  188198]
 [  52588  513826  228988]]
Evaluating performance on  train set...
2538/2538 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.954193
{'0': {'precision': 0.34609873964885013, 'recall': 0.34832339427118975, 'f1-score': 0.3472075035020403, 'support': 122748}, '1': {'precision': 0.6937340346429385, 'recall': 0.6283853137589689, 'f1-score': 0.6594446704850135, 'support': 402363}, '2': {'precision': 0.34212724359172664, 'recall': 0.4441026711855695, 'f1-score': 0.3865017596220045, 'support': 124514}, 'accuracy': 0.540145468539542, 'macro avg': {'precision': 0.4606533392945051, 'recall': 0.4736037930719094, 'f1-score': 0.4643846445363528, 'support': 649625}, 'weighted avg': {'precision': 0.5606549425961654, 'recall': 0.540145468539542, 'f1-score': 0.5481316801043744, 'support': 649625}}
[[ 42756  57704  22288]
 [ 65482 252839  84042]
 [ 15299  53918  55297]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96045345
{'0': {'precision': 0.32130388977256297, 'recall': 0.40490446191492685, 'f1-score': 0.35829215760800714, 'support': 38414}, '1': {'precision': 0.7072183185101469, 'recall': 0.5710669364758164, 'f1-score': 0.6318918206963164, 'support': 126015}, '2': {'precision': 0.3476571299842307, 'recall': 0.47480963002845933, 'f1-score': 0.401404558311929, 'support': 39003}, 'accuracy': 0.5212355971528569, 'macro avg': {'precision': 0.4587264460889802, 'recall': 0.4835936761397342, 'f1-score': 0.46386284553875085, 'support': 203432}, 'weighted avg': {'precision': 0.5654093508865584, 'recall': 0.5212355971528569, 'f1-score': 0.5360379129893058, 'support': 203432}}
[[15554 15202  7658]
 [26961 71963 27091]
 [ 5894 14590 18519]]
testing model on single stock: results/universal/W0/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
19053/19053 - 126s - 126s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9861972
{'0': {'precision': 0.4398054786006625, 'recall': 0.11299346254232955, 'f1-score': 0.17979464204263254, 'support': 1177369}, '1': {'precision': 0.5380406677358401, 'recall': 0.8978086852229386, 'f1-score': 0.672852738347481, 'support': 2541351}, '2': {'precision': 0.42555323565834896, 'recall': 0.12277655469647399, 'f1-score': 0.19057129863493, 'support': 1158731}, 'accuracy': 0.5242383777920065, 'macro avg': {'precision': 0.46779979399828386, 'recall': 0.37785956748724736, 'f1-score': 0.3477395596750145, 'support': 4877451}, 'weighted avg': {'precision': 0.4876041300739593, 'recall': 0.5242383777920065, 'f1-score': 0.43925822910322476, 'support': 4877451}}
[[ 133035  986598   57736]
 [ 125399 2281647  134305]
 [  44052  972414  142265]]
Evaluating performance on  train set...
4812/4812 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1314732
{'0': {'precision': 0.4860042302326628, 'recall': 0.21241557688005094, 'f1-score': 0.2956241156956641, 'support': 406731}, '1': {'precision': 0.3460705850816466, 'recall': 0.8378438173714887, 'f1-score': 0.48982105375860396, 'support': 406793}, '2': {'precision': 0.484215694769373, 'recall': 0.0801493507735261, 'f1-score': 0.1375335835435509, 'support': 418344}, 'accuracy': 0.37402952264365985, 'macro avg': {'precision': 0.43876350336122744, 'recall': 0.3768029150083552, 'f1-score': 0.3076595843326064, 'support': 1231868}, 'weighted avg': {'precision': 0.43918732258365184, 'recall': 0.37402952264365985, 'f1-score': 0.3060649498132756, 'support': 1231868}}
[[ 86396 302221  18114]
 [ 48362 340829  17602]
 [ 43010 341804  33530]]
Evaluating performance on  val set...
1767/1767 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1218809
{'0': {'precision': 0.49002464772357346, 'recall': 0.1427564997087155, 'f1-score': 0.22110078267620706, 'support': 147622}, '1': {'precision': 0.35049033545458774, 'recall': 0.8811809125233134, 'f1-score': 0.5015062162626973, 'support': 153881}, '2': {'precision': 0.4655272435182293, 'recall': 0.06918230651899994, 'f1-score': 0.12046258927591962, 'support': 150790}, 'accuracy': 0.3694574092457765, 'macro avg': {'precision': 0.4353474088987968, 'recall': 0.36437323958367634, 'f1-score': 0.281023196071608, 'support': 452293}, 'weighted avg': {'precision': 0.4343845138139449, 'recall': 0.3694574092457765, 'f1-score': 0.28294970658812557, 'support': 452293}}
[[ 21074 120651   5897]
 [ 12204 135597   6080]
 [  9728 130630  10432]]
training model: results/universal/W0/deepLOB_L1/h20
Epoch 1/50
8838/8838 - 144s - loss: 3.0483 - accuracy20: 0.4670 - val_loss: 3.1697 - val_accuracy20: 0.4192 - 144s/epoch - 16ms/step
Epoch 2/50
8838/8838 - 141s - loss: 2.9749 - accuracy20: 0.4859 - val_loss: 3.1466 - val_accuracy20: 0.4344 - 141s/epoch - 16ms/step
Epoch 3/50
8838/8838 - 138s - loss: 2.9367 - accuracy20: 0.4953 - val_loss: 3.1562 - val_accuracy20: 0.4382 - 138s/epoch - 16ms/step
Epoch 4/50
8838/8838 - 137s - loss: 2.9179 - accuracy20: 0.5000 - val_loss: 3.1950 - val_accuracy20: 0.4431 - 137s/epoch - 16ms/step
Epoch 5/50
8838/8838 - 138s - loss: 2.9053 - accuracy20: 0.5034 - val_loss: 3.1938 - val_accuracy20: 0.4448 - 138s/epoch - 16ms/step
Epoch 6/50
8838/8838 - 139s - loss: 2.8966 - accuracy20: 0.5054 - val_loss: 3.2072 - val_accuracy20: 0.4463 - 139s/epoch - 16ms/step
Epoch 7/50
8838/8838 - 137s - loss: 2.8899 - accuracy20: 0.5072 - val_loss: 3.2056 - val_accuracy20: 0.4489 - 137s/epoch - 15ms/step
Epoch 8/50
8838/8838 - 141s - loss: 2.8847 - accuracy20: 0.5084 - val_loss: 3.2130 - val_accuracy20: 0.4500 - 141s/epoch - 16ms/step
Epoch 9/50
8838/8838 - 142s - loss: 2.8794 - accuracy20: 0.5094 - val_loss: 3.2200 - val_accuracy20: 0.4517 - 142s/epoch - 16ms/step
Epoch 10/50
8838/8838 - 142s - loss: 2.8752 - accuracy20: 0.5108 - val_loss: 3.2331 - val_accuracy20: 0.4521 - 142s/epoch - 16ms/step
Epoch 11/50
8838/8838 - 142s - loss: 2.8712 - accuracy20: 0.5116 - val_loss: 3.2357 - val_accuracy20: 0.4535 - 142s/epoch - 16ms/step
Epoch 12/50
8838/8838 - 141s - loss: 2.8676 - accuracy20: 0.5125 - val_loss: 3.2553 - val_accuracy20: 0.4545 - 141s/epoch - 16ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 217s - 217s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0111034
{'0': {'precision': 0.38444702416731286, 'recall': 0.42871170051479585, 'f1-score': 0.4053745781379989, 'support': 1954367}, '1': {'precision': 0.6302637728454178, 'recall': 0.5068517568925837, 'f1-score': 0.5618607647475391, 'support': 4549709}, '2': {'precision': 0.36508262381507034, 'recall': 0.4900689116909252, 'f1-score': 0.41844196426415603, 'support': 1944953}, 'accuracy': 0.48491359184587957, 'macro avg': {'precision': 0.4599311402759337, 'recall': 0.47521078969943487, 'f1-score': 0.46189243571656463, 'support': 8449029}, 'weighted avg': {'precision': 0.5123589801155309, 'recall': 0.48491359184587957, 'f1-score': 0.4926487564419593, 'support': 8449029}}
[[ 837860  690771  425736]
 [1011769 2306028 1231912]
 [ 329761  662031  953161]]
Evaluating performance on  train set...
8838/8838 - 60s - 60s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0529696
{'0': {'precision': 0.4148170909463367, 'recall': 0.40308602087971657, 'f1-score': 0.4088674273634966, 'support': 653074}, '1': {'precision': 0.4633417970807596, 'recall': 0.4572322080214539, 'f1-score': 0.4602667287446193, 'support': 942672}, '2': {'precision': 0.3986819176019219, 'recall': 0.41716967370326236, 'f1-score': 0.40771632304182237, 'support': 666326}, 'accuracy': 0.4297988746600462, 'macro avg': {'precision': 0.4256136018763394, 'recall': 0.42582930086814424, 'f1-score': 0.42561682638331283, 'support': 2262072}, 'weighted avg': {'precision': 0.43028591610630434, 'recall': 0.4297988746600462, 'f1-score': 0.4299479550802544, 'support': 2262072}}
[[263245 241471 148358]
 [240756 431020 270896]
 [130604 257751 277971]]
Evaluating performance on  val set...
3279/3279 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0462223
{'0': {'precision': 0.41405862236975716, 'recall': 0.3840283467493306, 'f1-score': 0.39847849760402815, 'support': 236782}, '1': {'precision': 0.47103901140786114, 'recall': 0.4894116666203485, 'f1-score': 0.48004961189595136, 'support': 359830}, '2': {'precision': 0.3976968496717644, 'recall': 0.40284812085938954, 'f1-score': 0.40025591180885356, 'support': 242265}, 'accuracy': 0.43466682243046356, 'macro avg': {'precision': 0.42759816114979426, 'recall': 0.4254293780763562, 'f1-score': 0.42626134043627767, 'support': 838877}, 'weighted avg': {'precision': 0.4337747053293588, 'recall': 0.43466682243046356, 'f1-score': 0.43398112708128733, 'support': 838877}}
[[ 90931  96459  49392]
 [ 85310 176105  98415]
 [ 43368 101301  97596]]
testing model out of sample: results/universal/W0/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 157s - 157s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0252111
{'0': {'precision': 0.42863932138567323, 'recall': 0.39089347685807935, 'f1-score': 0.4088971546071024, 'support': 1557455}, '1': {'precision': 0.5374320986238955, 'recall': 0.4872801304080374, 'f1-score': 0.5111288334097867, 'support': 2693699}, '2': {'precision': 0.3927518666942763, 'recall': 0.48921835695712945, 'f1-score': 0.435709546112664, 'support': 1581809}, 'accuracy': 0.46206962053419504, 'macro avg': {'precision': 0.4529410955679484, 'recall': 0.4557973214077487, 'f1-score': 0.4519118447098511, 'support': 5832963}, 'weighted avg': {'precision': 0.46914838966467287, 'recall': 0.46206962053419504, 'f1-score': 0.4633794911407188, 'support': 5832963}}
[[ 608799  570069  378587]
 [ 563222 1312586  817891]
 [ 248285  559674  773850]]
Evaluating performance on  train set...
6334/6334 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.027594
{'0': {'precision': 0.4115623130651082, 'recall': 0.44910796887400734, 'f1-score': 0.4295162000233546, 'support': 425882}, '1': {'precision': 0.5910643412705114, 'recall': 0.4309230734971844, 'f1-score': 0.49844696499080293, 'support': 763417}, '2': {'precision': 0.387059759467767, 'recall': 0.5377095975217852, 'f1-score': 0.45011384926899856, 'support': 431601}, 'accuracy': 0.4641353569004874, 'macro avg': {'precision': 0.46322880460112886, 'recall': 0.4725802132976589, 'f1-score': 0.45935900476105207, 'support': 1620900}, 'weighted avg': {'precision': 0.48958043462184725, 'recall': 0.4641353569004874, 'f1-score': 0.46746603271582404, 'support': 1620900}}
[[191267 114887 119728]
 [186660 328974 247783]
 [ 86807 112718 232076]]
Evaluating performance on  val set...
2156/2156 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0235742
{'0': {'precision': 0.39641223107957557, 'recall': 0.5238336858956034, 'f1-score': 0.4513012800384196, 'support': 139928}, '1': {'precision': 0.6365325808616961, 'recall': 0.38197842692606077, 'f1-score': 0.4774454317442262, 'support': 268112}, '2': {'precision': 0.39078099760621215, 'recall': 0.5605276013678554, 'f1-score': 0.4605099449002643, 'support': 143290}, 'accuracy': 0.4643861208350716, 'macro avg': {'precision': 0.47457526984916126, 'recall': 0.48877990472983984, 'f1-score': 0.4630855522276367, 'support': 551330}, 'weighted avg': {'precision': 0.5117193026635374, 'recall': 0.4643861208350716, 'f1-score': 0.46640851234974123, 'support': 551330}}
[[ 73299  28106  38523]
 [ 79008 102413  86691]
 [ 32599  30373  80318]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0341548
{'0': {'precision': 0.36954541170557004, 'recall': 0.4239912051471516, 'f1-score': 0.3949005027318736, 'support': 55487}, '1': {'precision': 0.5842814696717153, 'recall': 0.5774188927880828, 'f1-score': 0.5808299113896693, 'support': 111704}, '2': {'precision': 0.3962196363346041, 'recall': 0.3484832525805772, 'f1-score': 0.37082146359688045, 'support': 56964}, 'accuracy': 0.4812607347594299, 'macro avg': {'precision': 0.4500155059039632, 'recall': 0.44996445017193726, 'f1-score': 0.4488506259061411, 'support': 224155}, 'weighted avg': {'precision': 0.4833342950711813, 'recall': 0.4812607347594299, 'f1-score': 0.4814362493332194, 'support': 224155}}
[[23526 22026  9935]
 [26889 64500 20315]
 [13247 23866 19851]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0735666
{'0': {'precision': 0.44567354965585054, 'recall': 0.2801081498648127, 'f1-score': 0.3440064513068641, 'support': 25890}, '1': {'precision': 0.4231263271030487, 'recall': 0.5379974668355443, 'f1-score': 0.4736973396528195, 'support': 30002}, '2': {'precision': 0.40553545451154466, 'recall': 0.4291127249763183, 'f1-score': 0.41699108255825107, 'support': 25336}, 'accuracy': 0.42183729748362636, 'macro avg': {'precision': 0.42477844375681467, 'recall': 0.41573944722555844, 'f1-score': 0.4115649578393115, 'support': 81228}, 'weighted avg': {'precision': 0.42482605187669437, 'recall': 0.42183729748362636, 'f1-score': 0.4146732737023495, 'support': 81228}}
[[ 7252 11319  7319]
 [ 5243 16141  8618]
 [ 3777 10687 10872]]
Evaluating performance on  val set...
104/104 - 1s - 888ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554245
{'0': {'precision': 0.4144635851952925, 'recall': 0.3201159267553682, 'f1-score': 0.3612308607105693, 'support': 7591}, '1': {'precision': 0.47958640614308523, 'recall': 0.580206033848418, 'f1-score': 0.5251196670135276, 'support': 10872}, '2': {'precision': 0.4100575096964023, 'recall': 0.38181818181818183, 'f1-score': 0.3954343199845231, 'support': 8030}, 'accuracy': 0.44555165515419165, 'macro avg': {'precision': 0.4347025003449267, 'recall': 0.42738004747398933, 'f1-score': 0.4272616159028733, 'support': 26493}, 'weighted avg': {'precision': 0.43985272659446645, 'recall': 0.44555165515419165, 'f1-score': 0.43885336024235555, 'support': 26493}}
[[2430 3289 1872]
 [2025 6308 2539]
 [1408 3556 3066]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
2359/2359 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95371246
{'0': {'precision': 0.3729648082338546, 'recall': 0.6001130422495408, 'f1-score': 0.46002700731508295, 'support': 106155}, '1': {'precision': 0.8320860749484623, 'recall': 0.5301340146300589, 'f1-score': 0.6476444369084009, 'support': 389062}, '2': {'precision': 0.3389662027833002, 'recall': 0.5779075443718856, 'f1-score': 0.4273022899463693, 'support': 108571}, 'accuracy': 0.5510278442102194, 'macro avg': {'precision': 0.514672361988539, 'recall': 0.5693848670838285, 'f1-score': 0.5116579113899511, 'support': 603788}, 'weighted avg': {'precision': 0.6626946069018417, 'recall': 0.5510278442102194, 'f1-score': 0.5750373372702938, 'support': 603788}}
[[ 63705  19000  23450]
 [ 83897 206255  98910]
 [ 23205  22622  62744]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97744393
{'0': {'precision': 0.3928381164153522, 'recall': 0.5566678701545935, 'f1-score': 0.46061922868006516, 'support': 30467}, '1': {'precision': 0.7793636244598664, 'recall': 0.46148733966903704, 'f1-score': 0.5797093383237907, 'support': 90282}, '2': {'precision': 0.35043367299761435, 'recall': 0.6325610895980772, 'f1-score': 0.4510109605017315, 'support': 29956}, 'accuracy': 0.5147340831425633, 'macro avg': {'precision': 0.5075451379576109, 'recall': 0.5502387664739027, 'f1-score': 0.4971131758351957, 'support': 150705}, 'weighted avg': {'precision': 0.6159629524211455, 'recall': 0.5147340831425633, 'f1-score': 0.530052014568421, 'support': 150705}}
[[16960  6074  7433]
 [20927 41664 27691]
 [ 5286  5721 18949]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9708231
{'0': {'precision': 0.4137860363437628, 'recall': 0.49513610725087875, 'f1-score': 0.45082058725019536, 'support': 12233}, '1': {'precision': 0.739918441323063, 'recall': 0.4758019871215874, 'f1-score': 0.5791704349984927, 'support': 34321}, '2': {'precision': 0.3532018813314038, 'recall': 0.6367193869232024, 'f1-score': 0.45436034673337605, 'support': 12266}, 'accuracy': 0.5133798027881673, 'macro avg': {'precision': 0.5023021196660765, 'recall': 0.5358858270985561, 'f1-score': 0.4947837896606881, 'support': 58820}, 'weighted avg': {'precision': 0.591447801490192, 'recall': 0.5133798027881673, 'f1-score': 0.5264498598511815, 'support': 58820}}
[[ 6057  3068  3108]
 [ 6797 16330 11194]
 [ 1784  2672  7810]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
1625/1625 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0087432
{'0': {'precision': 0.47351929884772564, 'recall': 0.5588191173382137, 'f1-score': 0.5126451413138836, 'support': 133324}, '1': {'precision': 0.5433913984844011, 'recall': 0.3799084872879898, 'f1-score': 0.44717649679078336, 'support': 145335}, '2': {'precision': 0.47937539834289356, 'recall': 0.5482389643711003, 'f1-score': 0.5114998027828027, 'support': 137192}, 'accuracy': 0.49280150823251595, 'macro avg': {'precision': 0.49876203189167345, 'recall': 0.49565552299910126, 'f1-score': 0.49044048029582327, 'support': 415851}, 'weighted avg': {'precision': 0.499870736267949, 'recall': 0.49280150823251595, 'f1-score': 0.4893867705620499, 'support': 415851}}
[[74504 21189 37631]
 [46066 55214 44055]
 [36771 25207 75214]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0316693
{'0': {'precision': 0.45995988273414595, 'recall': 0.5495509731110585, 'f1-score': 0.500779956322446, 'support': 37971}, '1': {'precision': 0.48721001689967736, 'recall': 0.32715221540207357, 'f1-score': 0.3914519364295633, 'support': 38774}, '2': {'precision': 0.46209730515131564, 'recall': 0.5258752099211988, 'f1-score': 0.49192768754833727, 'support': 38705}, 'accuracy': 0.466920744911217, 'macro avg': {'precision': 0.46975573492837963, 'recall': 0.4675261328114437, 'f1-score': 0.4613865267667821, 'support': 115450}, 'weighted avg': {'precision': 0.46982844606711144, 'recall': 0.466920744911217, 'f1-score': 0.4610942767535546, 'support': 115450}}
[[20867  6344 10760]
 [13156 12685 12933]
 [11344  7007 20354]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0350031
{'0': {'precision': 0.47819539436531344, 'recall': 0.5128532974427995, 'f1-score': 0.4949183362015781, 'support': 14860}, '1': {'precision': 0.42014598540145986, 'recall': 0.38560996851343204, 'f1-score': 0.4021378418975093, 'support': 14927}, '2': {'precision': 0.4663567092858065, 'recall': 0.47091810119979133, 'f1-score': 0.4686263058854065, 'support': 15336}, 'accuracy': 0.4565077676572923, 'macro avg': {'precision': 0.4548993630175266, 'recall': 0.4564604557186743, 'f1-score': 0.455227494661498, 'support': 45123}, 'weighted avg': {'precision': 0.45496862305173147, 'recall': 0.4565077676572923, 'f1-score': 0.4552900088428998, 'support': 45123}}
[[7621 3666 3573]
 [4480 5756 4691]
 [3836 4278 7222]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1030133
{'0': {'precision': 0.4025906735751295, 'recall': 0.5091562765655994, 'f1-score': 0.4496457450302641, 'support': 112928}, '1': {'precision': 0.34947817443883045, 'recall': 0.16838103979806646, 'f1-score': 0.2272644640897369, 'support': 100231}, '2': {'precision': 0.40746864992667525, 'recall': 0.48796200887057034, 'f1-score': 0.4440974161797625, 'support': 111605}, 'accuracy': 0.39670037319407325, 'macro avg': {'precision': 0.3865124993135451, 'recall': 0.3884997750780787, 'f1-score': 0.3736692084332545, 'support': 324764}, 'weighted avg': {'precision': 0.38787502667394547, 'recall': 0.39670037319407325, 'f1-score': 0.3791061550162533, 'support': 324764}}
[[57498 15392 40038]
 [44199 16877 39155]
 [41123 16023 54459]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1187482
{'0': {'precision': 0.3983255514409918, 'recall': 0.41985065942591154, 'f1-score': 0.4088049572145176, 'support': 41248}, '1': {'precision': 0.3337152379960421, 'recall': 0.2334482926118424, 'f1-score': 0.27471883618903353, 'support': 41174}, '2': {'precision': 0.38601250601250603, 'recall': 0.4795974469916095, 'f1-score': 0.4277460344533516, 'support': 41833}, 'accuracy': 0.37819806044022375, 'macro avg': {'precision': 0.3726844318165133, 'recall': 0.3776321330097878, 'f1-score': 0.3704232759523009, 'support': 124255}, 'weighted avg': {'precision': 0.3727703892729325, 'recall': 0.37819806044022375, 'f1-score': 0.3707501516697014, 'support': 124255}}
[[17318  9399 14531]
 [14181  9612 17381]
 [11978  9792 20063]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.105478
{'0': {'precision': 0.38569844789356983, 'recall': 0.4660727443231295, 'f1-score': 0.4220934817555886, 'support': 14929}, '1': {'precision': 0.3697651769289038, 'recall': 0.22728482107223627, 'f1-score': 0.281524201853759, 'support': 15034}, '2': {'precision': 0.4102746861121772, 'recall': 0.4810053352188725, 'f1-score': 0.44283347141673574, 'support': 15557}, 'accuracy': 0.392311072056239, 'macro avg': {'precision': 0.38857943697821695, 'recall': 0.3914543002047461, 'f1-score': 0.3821503850086944, 'support': 45520}, 'weighted avg': {'precision': 0.3888353490861025, 'recall': 0.392311072056239, 'f1-score': 0.38275546473261757, 'support': 45520}}
[[6958 2893 5078]
 [5939 3417 5678]
 [5143 2931 7483]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0701677
{'0': {'precision': 0.4112489876956033, 'recall': 0.5543457591785279, 'f1-score': 0.47219422647757536, 'support': 141989}, '1': {'precision': 0.4216549118894046, 'recall': 0.2668476636761891, 'f1-score': 0.32684737024504396, 'support': 157277}, '2': {'precision': 0.433370690050661, 'recall': 0.4584182576986537, 'f1-score': 0.4455427198824913, 'support': 144246}, 'accuracy': 0.4211949169357312, 'macro avg': {'precision': 0.4220915298785563, 'recall': 0.4265372268511236, 'f1-score': 0.41486143886837024, 'support': 443512}, 'weighted avg': {'precision': 0.4221338783351714, 'recall': 0.4211949169357312, 'f1-score': 0.41198370065640627, 'support': 443512}}
[[78711 26487 36791]
 [65641 41969 49667]
 [47043 31078 66125]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0624717
{'0': {'precision': 0.43276421617045296, 'recall': 0.517708621060062, 'f1-score': 0.4714406489522998, 'support': 65166}, '1': {'precision': 0.42455358260913123, 'recall': 0.26399227582770113, 'f1-score': 0.32555236549744104, 'support': 64214}, '2': {'precision': 0.43292072215516575, 'recall': 0.5078784044348036, 'f1-score': 0.4674134560729783, 'support': 66384}, 'accuracy': 0.43115179501849166, 'macro avg': {'precision': 0.43007950697825, 'recall': 0.4298597671075222, 'f1-score': 0.42146882350757303, 'support': 195764}, 'weighted avg': {'precision': 0.43012405694701283, 'recall': 0.43115179501849166, 'f1-score': 0.42222112234949655, 'support': 195764}}
[[33737 10917 20512]
 [23611 16952 23651]
 [20609 12060 33715]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0602808
{'0': {'precision': 0.42780201024084963, 'recall': 0.5259746315985824, 'f1-score': 0.4718358468070865, 'support': 21444}, '1': {'precision': 0.4677155329210622, 'recall': 0.2405631694653632, 'f1-score': 0.3177142857142857, 'support': 21379}, '2': {'precision': 0.43455057206565045, 'recall': 0.5429550125599452, 'f1-score': 0.4827418175911638, 'support': 21895}, 'accuracy': 0.437436261936401, 'macro avg': {'precision': 0.4433560384091874, 'recall': 0.43649760454129694, 'f1-score': 0.42409731670417866, 'support': 64718}, 'weighted avg': {'precision': 0.4432702101625759, 'recall': 0.437436261936401, 'f1-score': 0.42461283892233087, 'support': 64718}}
[[11279  2803  7362]
 [ 8129  5143  8107]
 [ 6957  3050 11888]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
4693/4693 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94674736
{'0': {'precision': 0.35248939767132387, 'recall': 0.6998555482600132, 'f1-score': 0.4688418215279807, 'support': 190375}, '1': {'precision': 0.8684681505917562, 'recall': 0.49897843165750533, 'f1-score': 0.6338044664442727, 'support': 818839}, '2': {'precision': 0.35370593488213864, 'recall': 0.6499078019356385, 'f1-score': 0.4580970511617832, 'support': 191978}, 'accuracy': 0.554937095818154, 'macro avg': {'precision': 0.5248878277150729, 'recall': 0.616247260617719, 'f1-score': 0.5202477797113455, 'support': 1201192}, 'weighted avg': {'precision': 0.7044207079391841, 'recall': 0.554937095818154, 'f1-score': 0.579577730254687, 'support': 1201192}}
[[133235  27437  29703]
 [211982 408583 198274]
 [ 32766  34444 124768]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9720038
{'0': {'precision': 0.35970901468797684, 'recall': 0.6927163718390122, 'f1-score': 0.4735277707329445, 'support': 67384}, '1': {'precision': 0.83833271132674, 'recall': 0.43676377659315907, 'f1-score': 0.5743147510945872, 'support': 246868}, '2': {'precision': 0.35288978656215186, 'recall': 0.6390554015414314, 'f1-score': 0.45469472901520164, 'support': 68897}, 'accuracy': 0.5181535120801568, 'macro avg': {'precision': 0.5169771708589562, 'recall': 0.5895118499912009, 'f1-score': 0.500845750280911, 'support': 383149}, 'weighted avg': {'precision': 0.666866413980767, 'recall': 0.5181535120801568, 'f1-score': 0.535079647920907, 'support': 383149}}
[[ 46678   9037  11669]
 [ 69976 107823  69069]
 [ 13112  11756  44029]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96237445
{'0': {'precision': 0.355078632555222, 'recall': 0.6867417677642981, 'f1-score': 0.46811778256888853, 'support': 23080}, '1': {'precision': 0.847892838742916, 'recall': 0.44364412719293517, 'f1-score': 0.5825039287585123, 'support': 92741}, '2': {'precision': 0.3455324619670024, 'recall': 0.6715808762285523, 'f1-score': 0.45629721852805516, 'support': 24012}, 'accuracy': 0.5229094705827666, 'macro avg': {'precision': 0.5161679777550469, 'recall': 0.6006555903952618, 'f1-score': 0.5023063099518187, 'support': 139833}, 'weighted avg': {'precision': 0.6802869857185568, 'recall': 0.5229094705827666, 'f1-score': 0.5419519290151738, 'support': 139833}}
[[15850  3354  3876]
 [24929 41144 26668]
 [ 3859  4027 16126]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
6677/6677 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9738137
{'0': {'precision': 0.3270097541476952, 'recall': 0.5795338422391858, 'f1-score': 0.4181006187153689, 'support': 245625}, '1': {'precision': 0.8749452637001739, 'recall': 0.44793288436828543, 'f1-score': 0.5925213236091753, 'support': 1213309}, '2': {'precision': 0.2736419004203277, 'recall': 0.7135553141177222, 'f1-score': 0.3955818135114308, 'support': 250352}, 'accuracy': 0.5057485991226747, 'macro avg': {'precision': 0.49186563942273226, 'recall': 0.5803406802417311, 'f1-score': 0.46873458527865836, 'support': 1709286}, 'weighted avg': {'precision': 0.7081363393085486, 'recall': 0.5057485991226747, 'f1-score': 0.5386120972587977, 'support': 1709286}}
[[142348  44078  59199]
 [254843 543481 414985]
 [ 38111  33601 178640]]
Evaluating performance on  train set...
2262/2262 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0111617
{'0': {'precision': 0.3884100937672366, 'recall': 0.4152967194987099, 'f1-score': 0.4014036837792583, 'support': 135650}, '1': {'precision': 0.6128136609025402, 'recall': 0.5195979241360117, 'f1-score': 0.5623692132685298, 'support': 305415}, '2': {'precision': 0.3741184545428547, 'recall': 0.474776435747053, 'f1-score': 0.4184796691010643, 'support': 137768}, 'accuracy': 0.4844868900010884, 'macro avg': {'precision': 0.45844740307087717, 'recall': 0.46989035979392485, 'f1-score': 0.46075085538295085, 'support': 578833}, 'weighted avg': {'precision': 0.5034126677461979, 'recall': 0.4844868900010884, 'f1-score': 0.4903996662729662, 'support': 578833}}
[[ 56335  50420  28895]
 [ 66191 158693  80531]
 [ 22514  49845  65409]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0027236
{'0': {'precision': 0.3710516726186138, 'recall': 0.5567195188627665, 'f1-score': 0.44530744336569583, 'support': 45725}, '1': {'precision': 0.7010392895438674, 'recall': 0.4277924583700348, 'f1-score': 0.5313445899128405, 'support': 119205}, '2': {'precision': 0.3688850278422604, 'recall': 0.5554316593043702, 'f1-score': 0.4433338182814011, 'support': 46634}, 'accuracy': 0.48379213854909153, 'macro avg': {'precision': 0.48032533000158056, 'recall': 0.5133145455123905, 'f1-score': 0.4733286171866458, 'support': 211564}, 'weighted avg': {'precision': 0.5565044649796695, 'recall': 0.48379213854909153, 'f1-score': 0.49334973799980836, 'support': 211564}}
[[25456 10296  9973]
 [33868 50995 34342]
 [ 9281 11451 25902]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
5633/5633 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.990547
{'0': {'precision': 0.3816090868302359, 'recall': 0.5431969290549853, 'f1-score': 0.44828619300717926, 'support': 297498}, '1': {'precision': 0.7429841902873681, 'recall': 0.4617736098956978, 'f1-score': 0.5695592783749507, 'support': 845620}, '2': {'precision': 0.348442880594804, 'recall': 0.574836968893531, 'f1-score': 0.43388328993565517, 'support': 298716}, 'accuracy': 0.5019981495789391, 'macro avg': {'precision': 0.49101205257080266, 'recall': 0.526602502614738, 'f1-score': 0.4839095871059283, 'support': 1441834}, 'weighted avg': {'precision': 0.586680363082285, 'recall': 0.5019981495789391, 'f1-score': 0.5164275801951507, 'support': 1441834}}
[[161600  67285  68613]
 [202660 390485 252475]
 [ 59210  67793 171713]]
Evaluating performance on  train set...
1454/1454 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0368687
{'0': {'precision': 0.43753949143569515, 'recall': 0.4779457715015903, 'f1-score': 0.45685093635630136, 'support': 107213}, '1': {'precision': 0.5646215565659267, 'recall': 0.33516651002108366, 'f1-score': 0.4206373558935695, 'support': 157468}, '2': {'precision': 0.39634440825727835, 'recall': 0.5959372148881896, 'f1-score': 0.476067231890525, 'support': 107414}, 'accuracy': 0.4515836009621199, 'macro avg': {'precision': 0.46616848541963335, 'recall': 0.4696831654702878, 'f1-score': 0.45118517471346525, 'support': 372095}, 'weighted avg': {'precision': 0.47942779944144864, 'recall': 0.4515836009621199, 'f1-score': 0.44707283958049854, 'support': 372095}}
[[51242 20750 35221]
 [42417 52778 62273]
 [23455 19947 64012]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0210528
{'0': {'precision': 0.44182024676062154, 'recall': 0.43972050247899913, 'f1-score': 0.4407678739265344, 'support': 38927}, '1': {'precision': 0.575225266223719, 'recall': 0.39830468417652715, 'f1-score': 0.4706889970861223, 'support': 63469}, '2': {'precision': 0.40377756568041395, 'recall': 0.6026240159940023, 'f1-score': 0.48355658939600543, 'support': 40015}, 'accuracy': 0.4670355520289865, 'macro avg': {'precision': 0.4736076928882515, 'recall': 0.4802164008831762, 'f1-score': 0.46500448680288736, 'support': 142411}, 'weighted avg': {'precision': 0.4905861798478045, 'recall': 0.4670355520289865, 'f1-score': 0.46612584638179955, 'support': 142411}}
[[17117  9643 12167]
 [14749 25280 23440]
 [ 6876  9025 24114]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
11876/11876 - 79s - 79s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0491476
{'0': {'precision': 0.5057695864112021, 'recall': 0.2955016666156998, 'f1-score': 0.3730465935061459, 'support': 981030}, '1': {'precision': 0.4019661401703599, 'recall': 0.5687222462980994, 'f1-score': 0.47102054451311176, 'support': 1066074}, '2': {'precision': 0.45295182262464206, 'recall': 0.4372567481156633, 'f1-score': 0.44496592714044164, 'support': 993055}, 'accuracy': 0.4376139537438667, 'macro avg': {'precision': 0.453562516402068, 'recall': 0.4338268870098208, 'f1-score': 0.42967768838656645, 'support': 3040159}, 'weighted avg': {'precision': 0.452116767737961, 'recall': 0.4376139537438667, 'f1-score': 0.43089466517213626, 'support': 3040159}}
[[289896 456117 235017]
 [170366 606300 289408]
 [112916 445919 434220]]
Evaluating performance on  train set...
2538/2538 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0253737
{'0': {'precision': 0.40565743617151573, 'recall': 0.4520021091157222, 'f1-score': 0.42757762735933474, 'support': 161205}, '1': {'precision': 0.6408136564058186, 'recall': 0.38277048232065275, 'f1-score': 0.479266028184641, 'support': 325012}, '2': {'precision': 0.3677315517985116, 'recall': 0.6208080387741114, 'f1-score': 0.4618746798702407, 'support': 163408}, 'accuracy': 0.45982682316721185, 'macro avg': {'precision': 0.47140088145861525, 'recall': 0.48519354340349546, 'f1-score': 0.4562394451380722, 'support': 649625}, 'weighted avg': {'precision': 0.5137678083665012, 'recall': 0.45982682316721185, 'f1-score': 0.4620648519669723, 'support': 649625}}
[[ 72865  36157  52183]
 [ 78368 124405 122239]
 [ 28389  33574 101445]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0272841
{'0': {'precision': 0.38593921640424755, 'recall': 0.5237735549018049, 'f1-score': 0.4444144607574442, 'support': 50308}, '1': {'precision': 0.6818597985748975, 'recall': 0.3367574634568314, 'f1-score': 0.4508491751715788, 'support': 101729}, '2': {'precision': 0.3785550256138491, 'recall': 0.6254499464928495, 'f1-score': 0.4716455139021348, 'support': 51395}, 'accuracy': 0.45594105155531084, 'macro avg': {'precision': 0.4821180135309981, 'recall': 0.49532698828382865, 'f1-score': 0.45563638327705264, 'support': 203432}, 'weighted avg': {'precision': 0.5320528780600614, 'recall': 0.45594105155531084, 'f1-score': 0.45451187433547946, 'support': 203432}}
[[26350  7995 15963]
 [30664 34258 36807]
 [11261  7989 32145]]
testing model on single stock: results/universal/W0/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
19053/19053 - 124s - 124s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.034059
{'0': {'precision': 0.3966524579138495, 'recall': 0.33852274831631274, 'f1-score': 0.3652894685280749, 'support': 1247411}, '1': {'precision': 0.5425314891866444, 'recall': 0.5355617817848984, 'f1-score': 0.5390241064418686, 'support': 2395957}, '2': {'precision': 0.37290629369083605, 'recall': 0.4374470760880751, 'f1-score': 0.4026065020853881, 'support': 1234083}, 'accuracy': 0.46034414287298836, 'macro avg': {'precision': 0.43736341359711, 'recall': 0.43717720206309546, 'f1-score': 0.43564002568511057, 'support': 4877451}, 'weighted avg': {'precision': 0.46230460870909945, 'recall': 0.46034414287298836, 'f1-score': 0.4600752569605018, 'support': 4877451}}
[[ 422277  561211  263923]
 [ 468871 1283183  643903]
 [ 173454  520783  539846]]
Evaluating performance on  train set...
4812/4812 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0853314
{'0': {'precision': 0.4356701647183847, 'recall': 0.32252029442278285, 'f1-score': 0.370652170842033, 'support': 406762}, '1': {'precision': 0.3508813637204909, 'recall': 0.5404959693275658, 'f1-score': 0.4255211699282919, 'support': 406880}, '2': {'precision': 0.4305475144082739, 'recall': 0.31294802331753646, 'f1-score': 0.3624473496921982, 'support': 418226}, 'accuracy': 0.39126675910081277, 'macro avg': {'precision': 0.40569968094904985, 'recall': 0.391988095689295, 'f1-score': 0.38620689682084103, 'support': 1231868}, 'weighted avg': {'precision': 0.4059256686371329, 'recall': 0.39126675910081277, 'f1-score': 0.38598955180980404, 'support': 1231868}}
[[131189 196276  79297]
 [ 93151 219917  93812]
 [ 76780 210563 130883]]
Evaluating performance on  val set...
1767/1767 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0836958
{'0': {'precision': 0.43432772378615453, 'recall': 0.3045734454282482, 'f1-score': 0.3580578750990535, 'support': 147613}, '1': {'precision': 0.3597598989721374, 'recall': 0.5835542734904223, 'f1-score': 0.44511029857129786, 'support': 154265}, '2': {'precision': 0.4274030704914207, 'recall': 0.2800319117109331, 'f1-score': 0.3383674879300788, 'support': 150415}, 'accuracy': 0.39156476001176227, 'macro avg': {'precision': 0.4071635644165708, 'recall': 0.3893865435432012, 'f1-score': 0.3805118872001434, 'support': 452293}, 'weighted avg': {'precision': 0.40659177116194467, 'recall': 0.39156476001176227, 'f1-score': 0.3812008654193203, 'support': 452293}}
[[44959 77660 24994]
 [32807 90022 31436]
 [25748 82546 42121]]
training model: results/universal/W0/deepLOB_L1/h30
Epoch 1/50
8838/8838 - 146s - loss: 3.0916 - accuracy30: 0.4530 - val_loss: 3.2155 - val_accuracy30: 0.4002 - 146s/epoch - 16ms/step
Epoch 2/50
8838/8838 - 140s - loss: 3.0459 - accuracy30: 0.4681 - val_loss: 3.1922 - val_accuracy30: 0.4182 - 140s/epoch - 16ms/step
Epoch 3/50
8838/8838 - 142s - loss: 3.0062 - accuracy30: 0.4782 - val_loss: 3.1689 - val_accuracy30: 0.4317 - 142s/epoch - 16ms/step
Epoch 4/50
8838/8838 - 142s - loss: 2.9870 - accuracy30: 0.4823 - val_loss: 3.1719 - val_accuracy30: 0.4314 - 142s/epoch - 16ms/step
Epoch 5/50
8838/8838 - 142s - loss: 2.9745 - accuracy30: 0.4852 - val_loss: 3.1656 - val_accuracy30: 0.4331 - 142s/epoch - 16ms/step
Epoch 6/50
8838/8838 - 141s - loss: 2.9650 - accuracy30: 0.4876 - val_loss: 3.1829 - val_accuracy30: 0.4314 - 141s/epoch - 16ms/step
Epoch 7/50
8838/8838 - 139s - loss: 2.9587 - accuracy30: 0.4889 - val_loss: 3.1865 - val_accuracy30: 0.4299 - 139s/epoch - 16ms/step
Epoch 8/50
8838/8838 - 138s - loss: 2.9535 - accuracy30: 0.4902 - val_loss: 3.1744 - val_accuracy30: 0.4322 - 138s/epoch - 16ms/step
Epoch 9/50
8838/8838 - 139s - loss: 2.9493 - accuracy30: 0.4914 - val_loss: 3.1664 - val_accuracy30: 0.4331 - 139s/epoch - 16ms/step
Epoch 10/50
8838/8838 - 141s - loss: 2.9458 - accuracy30: 0.4919 - val_loss: 3.1798 - val_accuracy30: 0.4322 - 141s/epoch - 16ms/step
Epoch 11/50
8838/8838 - 141s - loss: 2.9423 - accuracy30: 0.4929 - val_loss: 3.1832 - val_accuracy30: 0.4331 - 141s/epoch - 16ms/step
Epoch 12/50
8838/8838 - 139s - loss: 2.9398 - accuracy30: 0.4939 - val_loss: 3.1617 - val_accuracy30: 0.4359 - 139s/epoch - 16ms/step
Epoch 13/50
8838/8838 - 141s - loss: 2.9374 - accuracy30: 0.4945 - val_loss: 3.1800 - val_accuracy30: 0.4350 - 141s/epoch - 16ms/step
Epoch 14/50
8838/8838 - 137s - loss: 2.9349 - accuracy30: 0.4949 - val_loss: 3.1782 - val_accuracy30: 0.4362 - 137s/epoch - 15ms/step
Epoch 15/50
8838/8838 - 137s - loss: 2.9329 - accuracy30: 0.4954 - val_loss: 3.1849 - val_accuracy30: 0.4351 - 137s/epoch - 15ms/step
Epoch 16/50
8838/8838 - 141s - loss: 2.9307 - accuracy30: 0.4961 - val_loss: 3.1842 - val_accuracy30: 0.4361 - 141s/epoch - 16ms/step
Epoch 17/50
8838/8838 - 141s - loss: 2.9286 - accuracy30: 0.4965 - val_loss: 3.1986 - val_accuracy30: 0.4354 - 141s/epoch - 16ms/step
Epoch 18/50
8838/8838 - 141s - loss: 2.9269 - accuracy30: 0.4968 - val_loss: 3.2102 - val_accuracy30: 0.4348 - 141s/epoch - 16ms/step
Epoch 19/50
8838/8838 - 142s - loss: 2.9254 - accuracy30: 0.4973 - val_loss: 3.2131 - val_accuracy30: 0.4360 - 142s/epoch - 16ms/step
Epoch 20/50
8838/8838 - 138s - loss: 2.9236 - accuracy30: 0.4976 - val_loss: 3.2191 - val_accuracy30: 0.4349 - 138s/epoch - 16ms/step
Epoch 21/50
8838/8838 - 141s - loss: 2.9222 - accuracy30: 0.4982 - val_loss: 3.2384 - val_accuracy30: 0.4345 - 141s/epoch - 16ms/step
Epoch 22/50
8838/8838 - 141s - loss: 2.9203 - accuracy30: 0.4985 - val_loss: 3.2757 - val_accuracy30: 0.4279 - 141s/epoch - 16ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 218s - 218s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99384767
{'0': {'precision': 0.4287631390553881, 'recall': 0.30626403708597527, 'f1-score': 0.35730578183548295, 'support': 2119831}, '1': {'precision': 0.5678877346074281, 'recall': 0.644054323298734, 'f1-score': 0.6035776186431471, 'support': 4218006}, '2': {'precision': 0.407352035349274, 'recall': 0.4150532021720431, 'f1-score': 0.41116656112889366, 'support': 2111192}, 'accuracy': 0.5020825470003712, 'macro avg': {'precision': 0.46800096967069676, 'recall': 0.45512385418558415, 'f1-score': 0.4573499872025079, 'support': 8449029}, 'weighted avg': {'precision': 0.4928681892251247, 'recall': 0.5020825470003712, 'f1-score': 0.49371039491513535, 'support': 8449029}}
[[ 649228 1080883  389720]
 [ 616253 2716625  885128]
 [ 248707  986228  876257]]
Evaluating performance on  train set...
8838/8838 - 59s - 59s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0554746
{'0': {'precision': 0.44158022070164504, 'recall': 0.33659848069497506, 'f1-score': 0.3820079658473445, 'support': 682154}, '1': {'precision': 0.43547067303285586, 'recall': 0.5927076871080827, 'f1-score': 0.5020662278504362, 'support': 881723}, '2': {'precision': 0.4312071497627324, 'recall': 0.3347431591460838, 'f1-score': 0.3769008038226124, 'support': 698195}, 'accuracy': 0.4358535006843284, 'macro avg': {'precision': 0.43608601449907775, 'recall': 0.42134977564971393, 'f1-score': 0.42032499917346433, 'support': 2262072}, 'weighted avg': {'precision': 0.4359971291982084, 'recall': 0.4358535006843284, 'f1-score': 0.427228602484151, 'support': 2262072}}
[[229612 330449 122093]
 [172924 522604 186195]
 [117442 347037 233716]]
Evaluating performance on  val set...
3279/3279 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0435971
{'0': {'precision': 0.4492925102834831, 'recall': 0.26039095148200136, 'f1-score': 0.3297010866095484, 'support': 247908}, '1': {'precision': 0.43308778696452654, 'recall': 0.6476129664553109, 'f1-score': 0.5190581491946138, 'support': 336715}, '2': {'precision': 0.43336619769740786, 'recall': 0.32674018894491336, 'f1-score': 0.37257456536704703, 'support': 254254}, 'accuracy': 0.4359268402876703, 'macro avg': {'precision': 0.43858216498180586, 'recall': 0.4115813689607419, 'f1-score': 0.4071112670570698, 'support': 838877}, 'weighted avg': {'precision': 0.43796104918417716, 'recall': 0.4359268402876703, 'f1-score': 0.4187011626592426, 'support': 838877}}
[[ 64553 142718  40637]
 [ 50669 218061  67985]
 [ 28455 142724  83075]]
testing model out of sample: results/universal/W0/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 148s - 148s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0266045
{'0': {'precision': 0.4803903984694945, 'recall': 0.3172243184197219, 'f1-score': 0.38211811668723306, 'support': 1722431}, '1': {'precision': 0.47541787065066754, 'recall': 0.5789142645993812, 'f1-score': 0.5220863099271112, 'support': 2362583}, '2': {'precision': 0.4252419646617773, 'recall': 0.44244311475906906, 'f1-score': 0.4336720403139906, 'support': 1747949}, 'accuracy': 0.46074319346788245, 'macro avg': {'precision': 0.4603500779273131, 'recall': 0.44619389925939074, 'f1-score': 0.445958822309445, 'support': 5832963}, 'weighted avg': {'precision': 0.4618501369561688, 'recall': 0.46074319346788245, 'f1-score': 0.45425985719522505, 'support': 5832963}}
[[ 546397  766205  409829]
 [ 359393 1367733  635457]
 [ 231612  742969  773368]]
Evaluating performance on  train set...
6334/6334 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0230211
{'0': {'precision': 0.4516123563942112, 'recall': 0.39376394897814826, 'f1-score': 0.42070889314264376, 'support': 473601}, '1': {'precision': 0.5286013582521066, 'recall': 0.512229725386192, 'f1-score': 0.520286783960689, 'support': 668903}, '2': {'precision': 0.42275687861973854, 'recall': 0.4946738685106063, 'f1-score': 0.4558966030742438, 'support': 478396}, 'accuracy': 0.4724344499969153, 'macro avg': {'precision': 0.46765686442201887, 'recall': 0.46688918095831555, 'f1-score': 0.4656307600591922, 'support': 1620900}, 'weighted avg': {'precision': 0.47486723279889703, 'recall': 0.4724344499969153, 'f1-score': 0.4721874603474686, 'support': 1620900}}
[[186487 155501 131613]
 [134756 342632 191515]
 [ 91693 150053 236650]]
Evaluating performance on  val set...
2156/2156 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0111812
{'0': {'precision': 0.43831195844674503, 'recall': 0.4724758006137131, 'f1-score': 0.454753133044564, 'support': 156099}, '1': {'precision': 0.5781176952614079, 'recall': 0.46491921005385994, 'f1-score': 0.5153758622142927, 'support': 236725}, '2': {'precision': 0.42402603131438416, 'recall': 0.5154757548610147, 'f1-score': 0.4653001022218299, 'support': 158506}, 'accuracy': 0.48159360092866343, 'macro avg': {'precision': 0.4801518950075124, 'recall': 0.4842902551761959, 'f1-score': 0.4784763658268955, 'support': 551330}, 'weighted avg': {'precision': 0.4942332902832297, 'recall': 0.48159360092866343, 'f1-score': 0.48381498975309734, 'support': 551330}}
[[ 73753  39240  43106]
 [ 58788 110058  67879]
 [ 35725  41075  81706]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0396079
{'0': {'precision': 0.3810192542222551, 'recall': 0.3498473023413641, 'f1-score': 0.3647685258893665, 'support': 58940}, '1': {'precision': 0.5277153675742768, 'recall': 0.6403290533520165, 'f1-score': 0.5785935461087591, 'support': 104907}, '2': {'precision': 0.39870856046604125, 'recall': 0.2825827419247861, 'f1-score': 0.33074885250992225, 'support': 60308}, 'accuracy': 0.4676986906381745, 'macro avg': {'precision': 0.43581439408752437, 'recall': 0.4242530325393889, 'f1-score': 0.4247036415026826, 'support': 224155}, 'weighted avg': {'precision': 0.45443388179857863, 'recall': 0.4676986906381745, 'f1-score': 0.45568812587146945, 'support': 224155}}
[[20620 29217  9103]
 [21134 67175 16598]
 [12364 30902 17042]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1007073
{'0': {'precision': 0.45368349762961846, 'recall': 0.21813379644704947, 'f1-score': 0.2946149335418296, 'support': 27639}, '1': {'precision': 0.36635122378024915, 'recall': 0.5970132452816029, 'f1-score': 0.45406809166405065, 'support': 26651}, '2': {'precision': 0.41255916435449647, 'recall': 0.3753433810973346, 'f1-score': 0.39307234770438904, 'support': 26938}, 'accuracy': 0.3945806864627961, 'macro avg': {'precision': 0.4108646285881214, 'recall': 0.39683014094199565, 'f1-score': 0.38058512430342306, 'support': 81228}, 'weighted avg': {'precision': 0.4113914343001658, 'recall': 0.3945806864627961, 'f1-score': 0.3795835643074072, 'support': 81228}}
[[ 6029 14096  7514]
 [ 3857 15911  6883]
 [ 3403 13424 10111]]
Evaluating performance on  val set...
104/104 - 1s - 721ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0709794
{'0': {'precision': 0.4261284549612249, 'recall': 0.26466592565147584, 'f1-score': 0.32652750266646346, 'support': 8097}, '1': {'precision': 0.4212527387549942, 'recall': 0.6503183446080382, 'f1-score': 0.5113023073914744, 'support': 10052}, '2': {'precision': 0.4165825765220316, 'recall': 0.2968600191754554, 'f1-score': 0.34667599720083975, 'support': 8344}, 'accuracy': 0.42113010984033517, 'macro avg': {'precision': 0.42132125674608356, 'recall': 0.40394809647832314, 'f1-score': 0.39483526908625927, 'support': 26493}, 'weighted avg': {'precision': 0.42127202084649046, 'recall': 0.42113010984033517, 'f1-score': 0.40298073089620895, 'support': 26493}}
[[2143 4391 1563]
 [1609 6537 1906]
 [1277 4590 2477]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
2359/2359 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9187461
{'0': {'precision': 0.4119536922448532, 'recall': 0.5560044431645205, 'f1-score': 0.47326030927835055, 'support': 121535}, '1': {'precision': 0.777500422626905, 'recall': 0.6067631141650948, 'f1-score': 0.6816022602041057, 'support': 356256}, '2': {'precision': 0.39015779190265376, 'recall': 0.5008135114328119, 'f1-score': 0.43861411258510613, 'support': 125997}, 'accuracy': 0.5744367228232425, 'macro avg': {'precision': 0.5265373022581373, 'recall': 0.554527022920809, 'f1-score': 0.5311588940225208, 'support': 603788}, 'weighted avg': {'precision': 0.6230907104094608, 'recall': 0.5744367228232425, 'f1-score': 0.5889594507390075, 'support': 603788}}
[[ 67574  27472  26489]
 [ 67951 216163  72142]
 [ 28508  34388  63101]]
Evaluating performance on  train set...
589/589 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9425347
{'0': {'precision': 0.4549233231786028, 'recall': 0.504162971016566, 'f1-score': 0.47827916129470044, 'support': 34951}, '1': {'precision': 0.7304226404065661, 'recall': 0.5522397220755945, 'f1-score': 0.6289549108703251, 'support': 81461}, '2': {'precision': 0.40431106347505064, 'recall': 0.5939987752602572, 'f1-score': 0.4811337466784766, 'support': 34293}, 'accuracy': 0.5505922165820643, 'macro avg': {'precision': 0.5298856756867398, 'recall': 0.5501338227841392, 'f1-score': 0.5294559396145008, 'support': 150705}, 'weighted avg': {'precision': 0.5923229028786341, 'recall': 0.5505922165820643, 'f1-score': 0.5603739128473748, 'support': 150705}}
[[17621  8556  8774]
 [15237 44986 21238]
 [ 5876  8047 20370]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9436469
{'0': {'precision': 0.46867283950617283, 'recall': 0.4321901238081685, 'f1-score': 0.44969275190641894, 'support': 14054}, '1': {'precision': 0.6983377796018879, 'recall': 0.556336646612608, 'f1-score': 0.6193015341498481, 'support': 30584}, '2': {'precision': 0.41144452198185627, 'recall': 0.6236073896488507, 'f1-score': 0.4957815959862097, 'support': 14182}, 'accuracy': 0.5428935736144168, 'macro avg': {'precision': 0.526151713696639, 'recall': 0.5373780533565423, 'f1-score': 0.5215919606808256, 'support': 58820}, 'weighted avg': {'precision': 0.5742910055850149, 'recall': 0.5428935736144168, 'f1-score': 0.5489948087386636, 'support': 58820}}
[[ 6074  3989  3991]
 [ 4909 17015  8660]
 [ 1977  3361  8844]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
1625/1625 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.014882
{'0': {'precision': 0.4729968299786088, 'recall': 0.5351436069397871, 'f1-score': 0.5021547006676151, 'support': 137180}, '1': {'precision': 0.500966129158038, 'recall': 0.4157031924072476, 'f1-score': 0.45436934405809287, 'support': 139080}, '2': {'precision': 0.4831104807281841, 'recall': 0.5026541825762406, 'f1-score': 0.4926885956135085, 'support': 139591}, 'accuracy': 0.48429124854815786, 'macro avg': {'precision': 0.4856911466216103, 'recall': 0.48450032730775844, 'f1-score': 0.48307088011307214, 'support': 415851}, 'weighted avg': {'precision': 0.4857459751090978, 'recall': 0.48429124854815786, 'f1-score': 0.4829955055042991, 'support': 415851}}
[[73411 26679 37090]
 [43282 57816 37982]
 [38511 30914 70166]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0414672
{'0': {'precision': 0.4571804398495373, 'recall': 0.5142375081116158, 'f1-score': 0.4840333260035672, 'support': 38525}, '1': {'precision': 0.4398198142605905, 'recall': 0.37842788499827446, 'f1-score': 0.4068207762557078, 'support': 37669}, '2': {'precision': 0.4634564045736161, 'recall': 0.46876910535969024, 'f1-score': 0.46609761657506144, 'support': 39256}, 'accuracy': 0.4544651364226938, 'macro avg': {'precision': 0.4534855528945813, 'recall': 0.45381149948986016, 'f1-score': 0.4523172396114455, 'support': 115450}, 'weighted avg': {'precision': 0.45365000993094406, 'recall': 0.4544651364226938, 'f1-score': 0.4527418253905092, 'support': 115450}}
[[19811  8525 10189]
 [12299 14255 11115]
 [11223  9631 18402]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0511643
{'0': {'precision': 0.4821602110231848, 'recall': 0.4538979285107495, 'f1-score': 0.4676024100440944, 'support': 15303}, '1': {'precision': 0.38647092688543466, 'recall': 0.46112103310894353, 'f1-score': 0.4205086444500125, 'support': 14558}, '2': {'precision': 0.4655727878924103, 'recall': 0.4071550255536627, 'f1-score': 0.43440875249047506, 'support': 15262}, 'accuracy': 0.44041841189637215, 'macro avg': {'precision': 0.44473464193367657, 'recall': 0.44072466239111857, 'f1-score': 0.44083993566152735, 'support': 45123}, 'weighted avg': {'precision': 0.4456776666378548, 'recall': 0.44041841189637215, 'f1-score': 0.4411814575120824, 'support': 45123}}
[[6946 5141 3216]
 [3928 6713 3917]
 [3532 5516 6214]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1162914
{'0': {'precision': 0.38560960173246, 'recall': 0.4564326588082387, 'f1-score': 0.4180427135989948, 'support': 110794}, '1': {'precision': 0.3521956087824351, 'recall': 0.23655306476170412, 'f1-score': 0.2830170305151545, 'support': 104429}, '2': {'precision': 0.3851685684437282, 'recall': 0.4341844606129212, 'f1-score': 0.4082103835689334, 'support': 109541}, 'accuracy': 0.3782254190735426, 'macro avg': {'precision': 0.3743245929862078, 'recall': 0.37572339472762134, 'f1-score': 0.36975670922769427, 'support': 324764}, 'weighted avg': {'precision': 0.37471645748845783, 'recall': 0.3782254190735426, 'f1-score': 0.3713083454960483, 'support': 324764}}
[[50570 22393 37831]
 [41637 24703 38089]
 [38936 23044 47561]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1338434
{'0': {'precision': 0.39977321406072824, 'recall': 0.46118068845231464, 'f1-score': 0.42828700943725184, 'support': 41281}, '1': {'precision': 0.36597280562556395, 'recall': 0.28612435535662156, 'f1-score': 0.32115991098611546, 'support': 41108}, '2': {'precision': 0.38020856744729625, 'recall': 0.4040749056513639, 'f1-score': 0.3917786012042613, 'support': 41866}, 'accuracy': 0.3840247877349, 'macro avg': {'precision': 0.38198486237786283, 'recall': 0.3837933164867667, 'f1-score': 0.38040850720920955, 'support': 124255}, 'weighted avg': {'precision': 0.3819987930308246, 'recall': 0.3840247877349, 'f1-score': 0.38054453000212496, 'support': 124255}}
[[19038  9826 12417]
 [14186 11762 15160]
 [14398 10551 16917]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1124493
{'0': {'precision': 0.3843364757070341, 'recall': 0.4248496993987976, 'f1-score': 0.40357890729107176, 'support': 14970}, '1': {'precision': 0.36700886607559496, 'recall': 0.3103992633032954, 'f1-score': 0.3363386907095257, 'support': 15203}, '2': {'precision': 0.40250713665135907, 'recall': 0.42262331400273667, 'f1-score': 0.4123200152569848, 'support': 15347}, 'accuracy': 0.3858743409490334, 'macro avg': {'precision': 0.38461749281132934, 'recall': 0.38595742556827656, 'f1-score': 0.3840792044191941, 'support': 45520}, 'weighted avg': {'precision': 0.38467552413159006, 'recall': 0.3858743409490334, 'f1-score': 0.3840687309128561, 'support': 45520}}
[[6360 4123 4487]
 [5343 4719 5141]
 [4845 4016 6486]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0990123
{'0': {'precision': 0.38821205452392255, 'recall': 0.5724739636728721, 'f1-score': 0.4626720684788261, 'support': 141437}, '1': {'precision': 0.40166888077050816, 'recall': 0.3080101615275399, 'f1-score': 0.3486592937734006, 'support': 157063}, '2': {'precision': 0.42927259547784774, 'recall': 0.33895815518715694, 'f1-score': 0.3788066200412308, 'support': 145012}, 'accuracy': 0.4024671260304118, 'macro avg': {'precision': 0.40638451025742617, 'recall': 0.4064807601291896, 'f1-score': 0.3967126607644858, 'support': 443512}, 'weighted avg': {'precision': 0.4064028603320587, 'recall': 0.4024671260304118, 'f1-score': 0.3948752899420767, 'support': 443512}}
[[80969 32590 27878]
 [71214 48377 37472]
 [56386 39473 49153]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0794266
{'0': {'precision': 0.40991352946114823, 'recall': 0.5278854618746814, 'f1-score': 0.46147926117952043, 'support': 64747}, '1': {'precision': 0.4122700432734327, 'recall': 0.298904223915429, 'f1-score': 0.34655150787535616, 'support': 64703}, '2': {'precision': 0.4293438416422287, 'recall': 0.42389239074705193, 'f1-score': 0.42660070113669135, 'support': 66314}, 'accuracy': 0.41697656361741686, 'macro avg': {'precision': 0.41717580479226984, 'recall': 0.41689402551238747, 'f1-score': 0.4115438233971893, 'support': 195764}, 'weighted avg': {'precision': 0.4172743069032337, 'recall': 0.41697656361741686, 'f1-score': 0.4116789544187293, 'support': 195764}}
[[34179 13045 17523]
 [25524 19340 19839]
 [23678 14526 28110]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0748707
{'0': {'precision': 0.4080532894244443, 'recall': 0.5159214572983203, 'f1-score': 0.4556909125101866, 'support': 21135}, '1': {'precision': 0.45179263565891475, 'recall': 0.25372998956963405, 'f1-score': 0.32496006969652974, 'support': 22051}, '2': {'precision': 0.42331719506481336, 'recall': 0.5035296303176667, 'f1-score': 0.4599524860003394, 'support': 21532}, 'accuracy': 0.4224636113600544, 'macro avg': {'precision': 0.42772104004939077, 'recall': 0.424393692395207, 'f1-score': 0.4135344894023519, 'support': 64718}, 'weighted avg': {'precision': 0.4280347279742254, 'recall': 0.4224636113600544, 'f1-score': 0.4125655746676393, 'support': 64718}}
[[10904  3242  6989]
 [ 8675  5595  7781]
 [ 7143  3547 10842]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
4693/4693 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8774228
{'0': {'precision': 0.44724231311880047, 'recall': 0.6360377688407064, 'f1-score': 0.5251882827065063, 'support': 228760}, '1': {'precision': 0.821952746819768, 'recall': 0.6292222280572062, 'f1-score': 0.7127892193090235, 'support': 742647}, '2': {'precision': 0.45215110963615124, 'recall': 0.6047827316839655, 'f1-score': 0.5174461683962036, 'support': 229785}, 'accuracy': 0.6258449939726538, 'macro avg': {'precision': 0.5737820565249067, 'recall': 0.6233475761939594, 'f1-score': 0.5851412234705778, 'support': 1201192}, 'weighted avg': {'precision': 0.679849212985318, 'recall': 0.6258449939726538, 'f1-score': 0.6396930837943064, 'support': 1201192}}
[[145500  45091  38169]
 [145143 467290 130214]
 [ 34684  56131 138970]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91338533
{'0': {'precision': 0.4463886986149042, 'recall': 0.6277711054396237, 'f1-score': 0.5217658037984225, 'support': 79932}, '1': {'precision': 0.7830813710246467, 'recall': 0.5656033086925343, 'f1-score': 0.656807956801148, 'support': 221719}, '2': {'precision': 0.43229802432298026, 'recall': 0.5866401629487841, 'f1-score': 0.497779721280838, 'support': 81498}, 'accuracy': 0.5830473262360074, 'macro avg': {'precision': 0.5539226979875104, 'recall': 0.5933381923603139, 'f1-score': 0.5587844939601362, 'support': 383149}, 'weighted avg': {'precision': 0.6382273850282121, 'recall': 0.5830473262360074, 'f1-score': 0.5948094326963008, 'support': 383149}}
[[ 50179  15004  14749]
 [ 48278 125405  48036]
 [ 13954  19734  47810]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8984656
{'0': {'precision': 0.44767118939934936, 'recall': 0.6133719876789273, 'f1-score': 0.5175830224451103, 'support': 27595}, '1': {'precision': 0.7937834169950457, 'recall': 0.5806640671722125, 'f1-score': 0.6707007909370359, 'support': 83606}, '2': {'precision': 0.43337819650067294, 'recall': 0.6185386979603241, 'f1-score': 0.5096622875807588, 'support': 28632}, 'accuracy': 0.5948738852774381, 'macro avg': {'precision': 0.5582776009650227, 'recall': 0.604191584270488, 'f1-score': 0.5659820336543017, 'support': 139833}, 'weighted avg': {'precision': 0.6516847050050424, 'recall': 0.5948738852774381, 'f1-score': 0.6075101331550273, 'support': 139833}}
[[16926  5934  4735]
 [16639 48547 18420]
 [ 4244  6678 17710]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
6677/6677 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92200863
{'0': {'precision': 0.445301593044808, 'recall': 0.43892657192075796, 'f1-score': 0.4420911014831144, 'support': 297216}, '1': {'precision': 0.8228035237098528, 'recall': 0.5808885900022417, 'f1-score': 0.681000019972648, 'support': 1115250}, '2': {'precision': 0.33090768602149856, 'recall': 0.701206118186106, 'f1-score': 0.449629668835258, 'support': 296820}, 'accuracy': 0.5770971037029496, 'macro avg': {'precision': 0.5330042675920531, 'recall': 0.5736737600363685, 'f1-score': 0.5242402634303401, 'support': 1709286}, 'weighted avg': {'precision': 0.6717438787076709, 'recall': 0.5770971037029496, 'f1-score': 0.5992799914096192, 'support': 1709286}}
[[130456  80701  86059]
 [132632 647836 334782]
 [ 29873  58815 208132]]
Evaluating performance on  train set...
2262/2262 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9980158
{'0': {'precision': 0.45662006252678017, 'recall': 0.3677084198621077, 'f1-score': 0.40736925935757895, 'support': 156499}, '1': {'precision': 0.55024932809318, 'recall': 0.6265154122867075, 'f1-score': 0.585910968983473, 'support': 264367}, '2': {'precision': 0.4324826414050251, 'recall': 0.41559313021074024, 'f1-score': 0.4238697076816296, 'support': 157967}, 'accuracy': 0.4989798439273504, 'macro avg': {'precision': 0.4797840106749951, 'recall': 0.4699389874531852, 'f1-score': 0.4723833120075605, 'support': 578833}, 'weighted avg': {'precision': 0.49279556055065254, 'recall': 0.4989798439273504, 'f1-score': 0.4934166382545562, 'support': 578833}}
[[ 57546  68174  30779]
 [ 43368 165630  55369]
 [ 25112  67205  65650]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97398096
{'0': {'precision': 0.440900804981529, 'recall': 0.510392350930923, 'f1-score': 0.4731084145475947, 'support': 53549}, '1': {'precision': 0.6439516082261376, 'recall': 0.5335864289490124, 'f1-score': 0.583597010375385, 'support': 104045}, '2': {'precision': 0.4240712098734257, 'recall': 0.4978691865851399, 'f1-score': 0.45801656837009513, 'support': 53970}, 'accuracy': 0.518604299408217, 'macro avg': {'precision': 0.5029745410270308, 'recall': 0.5139493221550251, 'f1-score': 0.5049073310976916, 'support': 211564}, 'weighted avg': {'precision': 0.5364658707564292, 'recall': 0.518604299408217, 'f1-score': 0.5235956383413536, 'support': 211564}}
[[27331 14583 11635]
 [23671 55517 24857]
 [10987 16113 26870]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
5633/5633 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9633602
{'0': {'precision': 0.42183846351310356, 'recall': 0.5288175459228899, 'f1-score': 0.46930872752433034, 'support': 341823}, '1': {'precision': 0.6866423824631493, 'recall': 0.5572772968999384, 'f1-score': 0.615232988406329, 'support': 754985}, '2': {'precision': 0.4135328773278746, 'recall': 0.4801174404247796, 'f1-score': 0.4443446002312213, 'support': 345026}, 'accuracy': 0.532066104697212, 'macro avg': {'precision': 0.5073379077680426, 'recall': 0.522070761082536, 'f1-score': 0.5096287720539602, 'support': 1441834}, 'weighted avg': {'precision': 0.5585097748910816, 'recall': 0.532066104697212, 'f1-score': 0.5397449602103147, 'support': 1441834}}
[[180762  89872  71189]
 [170511 420736 163738]
 [ 77237 102136 165653]]
Evaluating performance on  train set...
1454/1454 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0311902
{'0': {'precision': 0.47702763269823556, 'recall': 0.4324951900749685, 'f1-score': 0.4536712032047184, 'support': 120584}, '1': {'precision': 0.4918529213230331, 'recall': 0.4027653024405598, 'f1-score': 0.4428733628509081, 'support': 130257}, '2': {'precision': 0.43718930969097525, 'recall': 0.562843287644119, 'f1-score': 0.49212209490982767, 'support': 121254}, 'accuracy': 0.4645641570029159, 'macro avg': {'precision': 0.46868995457074797, 'recall': 0.46603459338654907, 'f1-score': 0.4628888869884847, 'support': 372095}, 'weighted avg': {'precision': 0.4692353796512393, 'recall': 0.4645641570029159, 'f1-score': 0.46242120019969296, 'support': 372095}}
[[52152 27748 40684]
 [30621 52463 47173]
 [26554 26453 68247]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0225388
{'0': {'precision': 0.478860807908441, 'recall': 0.3695143823642927, 'f1-score': 0.4171408068071147, 'support': 44047}, '1': {'precision': 0.5019888623707239, 'recall': 0.44325258201701095, 'f1-score': 0.4707958177473508, 'support': 52672}, '2': {'precision': 0.44082825900860884, 'recall': 0.5973255712159677, 'f1-score': 0.5072812601644905, 'support': 45692}, 'accuracy': 0.4698794334707291, 'macro avg': {'precision': 0.47389264309592455, 'recall': 0.47003084519909044, 'f1-score': 0.465072628239652, 'support': 142411}, 'weighted avg': {'precision': 0.47521233735705265, 'recall': 0.4698794334707291, 'f1-score': 0.465906803331606, 'support': 142411}}
[[16276 12368 15403]
 [10108 23347 19217]
 [ 7605 10794 27293]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
11876/11876 - 81s - 81s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0756078
{'0': {'precision': 0.5645571700194831, 'recall': 0.2211237355860022, 'f1-score': 0.3177803851306892, 'support': 1087658}, '1': {'precision': 0.3163805313371292, 'recall': 0.6458879594650961, 'f1-score': 0.4247180028298786, 'support': 846283}, '2': {'precision': 0.48312069218360465, 'recall': 0.38714972998088987, 'f1-score': 0.42984350786475356, 'support': 1106218}, 'accuracy': 0.399776130130036, 'macro avg': {'precision': 0.4546861311800723, 'recall': 0.418053808343996, 'f1-score': 0.39078063194177376, 'support': 3040159}, 'weighted avg': {'precision': 0.46584056738367746, 'recall': 0.399776130130036, 'f1-score': 0.38832463344926543, 'support': 3040159}}
[[240507 597576 249575]
 [ 91056 546604 208623]
 [ 94447 583499 428272]]
Evaluating performance on  train set...
2538/2538 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0153357
{'0': {'precision': 0.46982154281747274, 'recall': 0.3707429467589733, 'f1-score': 0.41444297348979486, 'support': 186191}, '1': {'precision': 0.5697074010327022, 'recall': 0.46493994838719044, 'f1-score': 0.512019346070829, 'support': 275513}, '2': {'precision': 0.4103047665663735, 'recall': 0.6066591812516962, 'f1-score': 0.4895260137448929, 'support': 187921}, 'accuracy': 0.4789378487588994, 'macro avg': {'precision': 0.4832779034721828, 'recall': 0.4807806921326199, 'f1-score': 0.4719961111018389, 'support': 649625}, 'weighted avg': {'precision': 0.4949674352085749, 'recall': 0.4789378487588994, 'f1-score': 0.4775459007889239, 'support': 649625}}
[[ 69029  51457  65705]
 [ 49273 128097  98143]
 [ 28624  45293 114004]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0128758
{'0': {'precision': 0.44031940095754024, 'recall': 0.45814013617167976, 'f1-score': 0.4490530335028468, 'support': 58015}, '1': {'precision': 0.6078381234870955, 'recall': 0.4145246980318302, 'f1-score': 0.492905080833005, 'support': 86019}, '2': {'precision': 0.4192780219650029, 'recall': 0.595811306778006, 'f1-score': 0.4921942908800111, 'support': 59398}, 'accuracy': 0.4798950017696331, 'macro avg': {'precision': 0.48914518213654623, 'recall': 0.48949204699383864, 'f1-score': 0.4780508017386209, 'support': 203432}, 'weighted avg': {'precision': 0.5050092096595689, 'recall': 0.4798950017696331, 'f1-score': 0.48019176125945184, 'support': 203432}}
[[26579 11818 19618]
 [20963 35657 29399]
 [12821 11187 35390]]
testing model on single stock: results/universal/W0/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
19053/19053 - 130s - 130s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0327232
{'0': {'precision': 0.439617979459413, 'recall': 0.15536794594048683, 'f1-score': 0.22959380903408386, 'support': 1316919}, '1': {'precision': 0.4875984719652839, 'recall': 0.7020638680809616, 'f1-score': 0.5754998839166521, 'support': 2259689}, '2': {'precision': 0.39777459341873556, 'recall': 0.3542302952777545, 'f1-score': 0.3747417438334669, 'support': 1300843}, 'accuracy': 0.46168603231483, 'macro avg': {'precision': 0.44166368161447744, 'recall': 0.403887369766401, 'f1-score': 0.3932784789280676, 'support': 4877451}, 'weighted avg': {'precision': 0.45068714556744477, 'recall': 0.46168603231483, 'f1-score': 0.4285614311370121, 'support': 4877451}}
[[ 204607  896515  215797]
 [ 191398 1586446  481845]
 [  69415  770630  460798]]
Evaluating performance on  train set...
4812/4812 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1129378
{'0': {'precision': 0.42697684073464265, 'recall': 0.22324533924016912, 'f1-score': 0.29319390384743094, 'support': 405406}, '1': {'precision': 0.34312158814255533, 'recall': 0.7071526457716282, 'f1-score': 0.462049493439628, 'support': 407178}, '2': {'precision': 0.4440663523891729, 'recall': 0.19141441123439004, 'f1-score': 0.2675161995680115, 'support': 419284}, 'accuracy': 0.3723605126523296, 'macro avg': {'precision': 0.40472159375545697, 'recall': 0.37393746541539574, 'f1-score': 0.3409198656183568, 'support': 1231868}, 'weighted avg': {'precision': 0.40507623512155516, 'recall': 0.3723605126523296, 'f1-score': 0.34026715414525466, 'support': 1231868}}
[[ 90505 269028  45873]
 [ 64639 287937  54602]
 [ 56823 282204  80257]]
Evaluating performance on  val set...
1767/1767 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1009288
{'0': {'precision': 0.4476313928823945, 'recall': 0.12899172790372312, 'f1-score': 0.20027204858914335, 'support': 147242}, '1': {'precision': 0.34680968020068026, 'recall': 0.8036857419980601, 'f1-score': 0.48453212378979055, 'support': 154650}, '2': {'precision': 0.44442717843129637, 'recall': 0.15212664809409512, 'f1-score': 0.22666594017326866, 'support': 150401}, 'accuracy': 0.36737911044389365, 'macro avg': {'precision': 0.4129560838381237, 'recall': 0.36160137266529274, 'f1-score': 0.3038233708507342, 'support': 452293}, 'weighted avg': {'precision': 0.41209249459326175, 'recall': 0.36737911044389365, 'f1-score': 0.30624425757297485, 'support': 452293}}
[[ 18993 116334  11915]
 [ 13673 124290  16687]
 [  9764 117757  22880]]
training model: results/universal/W0/deepOF_L1/h10
Epoch 1/50
8838/8838 - 131s - loss: 3.0460 - accuracy10: 0.4949 - val_loss: 3.2460 - val_accuracy10: 0.4169 - 131s/epoch - 15ms/step
Epoch 2/50
8838/8838 - 123s - loss: 3.0353 - accuracy10: 0.4944 - val_loss: 3.2483 - val_accuracy10: 0.4186 - 123s/epoch - 14ms/step
Epoch 3/50
8838/8838 - 127s - loss: 3.0235 - accuracy10: 0.4964 - val_loss: 3.2505 - val_accuracy10: 0.4145 - 127s/epoch - 14ms/step
Epoch 4/50
8838/8838 - 128s - loss: 3.0113 - accuracy10: 0.4985 - val_loss: 3.2562 - val_accuracy10: 0.4121 - 128s/epoch - 14ms/step
Epoch 5/50
8838/8838 - 128s - loss: 2.9989 - accuracy10: 0.5000 - val_loss: 3.2537 - val_accuracy10: 0.4132 - 128s/epoch - 14ms/step
Epoch 6/50
8838/8838 - 127s - loss: 2.9886 - accuracy10: 0.5010 - val_loss: 3.2481 - val_accuracy10: 0.4136 - 127s/epoch - 14ms/step
Epoch 7/50
8838/8838 - 129s - loss: 2.9793 - accuracy10: 0.5018 - val_loss: 3.2442 - val_accuracy10: 0.4137 - 129s/epoch - 15ms/step
Epoch 8/50
8838/8838 - 127s - loss: 2.9715 - accuracy10: 0.5028 - val_loss: 3.2439 - val_accuracy10: 0.4159 - 127s/epoch - 14ms/step
Epoch 9/50
8838/8838 - 126s - loss: 2.9642 - accuracy10: 0.5039 - val_loss: 3.2422 - val_accuracy10: 0.4142 - 126s/epoch - 14ms/step
Epoch 10/50
8838/8838 - 128s - loss: 2.9578 - accuracy10: 0.5046 - val_loss: 3.2358 - val_accuracy10: 0.4142 - 128s/epoch - 14ms/step
Epoch 11/50
8838/8838 - 127s - loss: 2.9517 - accuracy10: 0.5055 - val_loss: 3.2381 - val_accuracy10: 0.4148 - 127s/epoch - 14ms/step
Epoch 12/50
8838/8838 - 128s - loss: 2.9467 - accuracy10: 0.5060 - val_loss: 3.2349 - val_accuracy10: 0.4142 - 128s/epoch - 14ms/step
Epoch 13/50
8838/8838 - 129s - loss: 2.9421 - accuracy10: 0.5067 - val_loss: 3.2202 - val_accuracy10: 0.4192 - 129s/epoch - 15ms/step
Epoch 14/50
8838/8838 - 133s - loss: 2.9371 - accuracy10: 0.5078 - val_loss: 3.2111 - val_accuracy10: 0.4208 - 133s/epoch - 15ms/step
Epoch 15/50
8838/8838 - 127s - loss: 2.9329 - accuracy10: 0.5089 - val_loss: 3.2165 - val_accuracy10: 0.4203 - 127s/epoch - 14ms/step
Epoch 16/50
8838/8838 - 129s - loss: 2.9292 - accuracy10: 0.5094 - val_loss: 3.2142 - val_accuracy10: 0.4216 - 129s/epoch - 15ms/step
Epoch 17/50
8838/8838 - 128s - loss: 2.9254 - accuracy10: 0.5101 - val_loss: 3.2142 - val_accuracy10: 0.4191 - 128s/epoch - 15ms/step
Epoch 18/50
8838/8838 - 128s - loss: 2.9218 - accuracy10: 0.5108 - val_loss: 3.2126 - val_accuracy10: 0.4224 - 128s/epoch - 14ms/step
Epoch 19/50
8838/8838 - 128s - loss: 2.9187 - accuracy10: 0.5112 - val_loss: 3.2088 - val_accuracy10: 0.4259 - 128s/epoch - 14ms/step
Epoch 20/50
8838/8838 - 128s - loss: 2.9155 - accuracy10: 0.5121 - val_loss: 3.2019 - val_accuracy10: 0.4266 - 128s/epoch - 15ms/step
Epoch 21/50
8838/8838 - 123s - loss: 2.9123 - accuracy10: 0.5127 - val_loss: 3.2003 - val_accuracy10: 0.4291 - 123s/epoch - 14ms/step
Epoch 22/50
8838/8838 - 126s - loss: 2.9101 - accuracy10: 0.5132 - val_loss: 3.1847 - val_accuracy10: 0.4305 - 126s/epoch - 14ms/step
Epoch 23/50
8838/8838 - 127s - loss: 2.9077 - accuracy10: 0.5137 - val_loss: 3.1890 - val_accuracy10: 0.4290 - 127s/epoch - 14ms/step
Epoch 24/50
8838/8838 - 126s - loss: 2.9047 - accuracy10: 0.5140 - val_loss: 3.1797 - val_accuracy10: 0.4323 - 126s/epoch - 14ms/step
Epoch 25/50
8838/8838 - 126s - loss: 2.9026 - accuracy10: 0.5147 - val_loss: 3.1853 - val_accuracy10: 0.4322 - 126s/epoch - 14ms/step
Epoch 26/50
8838/8838 - 122s - loss: 2.8997 - accuracy10: 0.5153 - val_loss: 3.1800 - val_accuracy10: 0.4337 - 122s/epoch - 14ms/step
Epoch 27/50
8838/8838 - 126s - loss: 2.8978 - accuracy10: 0.5157 - val_loss: 3.1742 - val_accuracy10: 0.4369 - 126s/epoch - 14ms/step
Epoch 28/50
8838/8838 - 123s - loss: 2.8957 - accuracy10: 0.5163 - val_loss: 3.1849 - val_accuracy10: 0.4370 - 123s/epoch - 14ms/step
Epoch 29/50
8838/8838 - 127s - loss: 2.8933 - accuracy10: 0.5165 - val_loss: 3.1742 - val_accuracy10: 0.4360 - 127s/epoch - 14ms/step
Epoch 30/50
8838/8838 - 129s - loss: 2.8914 - accuracy10: 0.5171 - val_loss: 3.1775 - val_accuracy10: 0.4393 - 129s/epoch - 15ms/step
Epoch 31/50
8838/8838 - 127s - loss: 2.8903 - accuracy10: 0.5174 - val_loss: 3.1893 - val_accuracy10: 0.4369 - 127s/epoch - 14ms/step
Epoch 32/50
8838/8838 - 127s - loss: 2.8883 - accuracy10: 0.5178 - val_loss: 3.1672 - val_accuracy10: 0.4374 - 127s/epoch - 14ms/step
Epoch 33/50
8838/8838 - 126s - loss: 2.8870 - accuracy10: 0.5179 - val_loss: 3.1774 - val_accuracy10: 0.4386 - 126s/epoch - 14ms/step
Epoch 34/50
8838/8838 - 127s - loss: 2.8846 - accuracy10: 0.5182 - val_loss: 3.1837 - val_accuracy10: 0.4391 - 127s/epoch - 14ms/step
Epoch 35/50
8838/8838 - 125s - loss: 2.8829 - accuracy10: 0.5187 - val_loss: 3.1595 - val_accuracy10: 0.4406 - 125s/epoch - 14ms/step
Epoch 36/50
8838/8838 - 129s - loss: 2.8811 - accuracy10: 0.5192 - val_loss: 3.1768 - val_accuracy10: 0.4397 - 129s/epoch - 15ms/step
Epoch 37/50
8838/8838 - 129s - loss: 2.8795 - accuracy10: 0.5195 - val_loss: 3.1666 - val_accuracy10: 0.4397 - 129s/epoch - 15ms/step
Epoch 38/50
8838/8838 - 126s - loss: 2.8780 - accuracy10: 0.5196 - val_loss: 3.1743 - val_accuracy10: 0.4414 - 126s/epoch - 14ms/step
Epoch 39/50
8838/8838 - 127s - loss: 2.8765 - accuracy10: 0.5200 - val_loss: 3.1786 - val_accuracy10: 0.4407 - 127s/epoch - 14ms/step
Epoch 40/50
8838/8838 - 126s - loss: 2.8754 - accuracy10: 0.5202 - val_loss: 3.1652 - val_accuracy10: 0.4400 - 126s/epoch - 14ms/step
Epoch 41/50
8838/8838 - 127s - loss: 2.8742 - accuracy10: 0.5206 - val_loss: 3.1667 - val_accuracy10: 0.4413 - 127s/epoch - 14ms/step
Epoch 42/50
8838/8838 - 123s - loss: 2.8726 - accuracy10: 0.5209 - val_loss: 3.1641 - val_accuracy10: 0.4418 - 123s/epoch - 14ms/step
Epoch 43/50
8838/8838 - 124s - loss: 2.8716 - accuracy10: 0.5212 - val_loss: 3.1677 - val_accuracy10: 0.4433 - 124s/epoch - 14ms/step
Epoch 44/50
8838/8838 - 128s - loss: 2.8706 - accuracy10: 0.5214 - val_loss: 3.1674 - val_accuracy10: 0.4402 - 128s/epoch - 14ms/step
Epoch 45/50
8838/8838 - 127s - loss: 2.8691 - accuracy10: 0.5216 - val_loss: 3.1544 - val_accuracy10: 0.4432 - 127s/epoch - 14ms/step
Epoch 46/50
8838/8838 - 127s - loss: 2.8682 - accuracy10: 0.5215 - val_loss: 3.1722 - val_accuracy10: 0.4407 - 127s/epoch - 14ms/step
Epoch 47/50
8838/8838 - 127s - loss: 2.8667 - accuracy10: 0.5222 - val_loss: 3.1719 - val_accuracy10: 0.4438 - 127s/epoch - 14ms/step
Epoch 48/50
8838/8838 - 124s - loss: 2.8658 - accuracy10: 0.5223 - val_loss: 3.1591 - val_accuracy10: 0.4440 - 124s/epoch - 14ms/step
Epoch 49/50
8838/8838 - 128s - loss: 2.8648 - accuracy10: 0.5223 - val_loss: 3.1683 - val_accuracy10: 0.4406 - 128s/epoch - 14ms/step
Epoch 50/50
8838/8838 - 124s - loss: 2.8636 - accuracy10: 0.5227 - val_loss: 3.1664 - val_accuracy10: 0.4444 - 124s/epoch - 14ms/step
testing model in sample: results/universal/W0/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 225s - 225s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0196064
{'0': {'precision': 0.3057547430418902, 'recall': 0.5153857297414135, 'f1-score': 0.38381162928289425, 'support': 1739534}, '1': {'precision': 0.6949258320563795, 'recall': 0.49727924374306276, 'f1-score': 0.5797193775421379, 'support': 4986665}, '2': {'precision': 0.33089170438086946, 'recall': 0.37422575393036356, 'f1-score': 0.35122714969447577, 'support': 1722805}, 'accuracy': 0.47591574107433254, 'macro avg': {'precision': 0.4438574264930464, 'recall': 0.46229690913827987, 'f1-score': 0.43825271883983596, 'support': 8449004}, 'weighted avg': {'precision': 0.5405719985763933, 'recall': 0.47591574107433254, 'f1-score': 0.49279365924948626, 'support': 8449004}}
[[ 896531  527149  315854]
 [1519046 2479765  987854]
 [ 516613  561474  644718]]
Evaluating performance on  train set...
8838/8838 - 59s - 59s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0450779
{'0': {'precision': 0.36458085427421, 'recall': 0.4977954602811716, 'f1-score': 0.4208990694664495, 'support': 606249}, '1': {'precision': 0.56993930071093, 'recall': 0.4762159783697408, 'f1-score': 0.5188793807701891, 'support': 1036326}, '2': {'precision': 0.39644364530754356, 'recall': 0.36374216897420625, 'f1-score': 0.3793895353242157, 'support': 619491}, 'accuracy': 0.45119726833788226, 'macro avg': {'precision': 0.4436546000975612, 'recall': 0.4459178692083729, 'f1-score': 0.43972266185361814, 'support': 2262066}, 'weighted avg': {'precision': 0.46738820368046563, 'recall': 0.45119726833788226, 'f1-score': 0.45441920604816405, 'support': 2262066}}
[[301788 177092 127369]
 [327124 493515 215687]
 [198855 195301 225335]]
Evaluating performance on  val set...
3279/3279 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0521709
{'0': {'precision': 0.35213290250987306, 'recall': 0.4909982888557178, 'f1-score': 0.4101298928393579, 'support': 219736}, '1': {'precision': 0.569563535153081, 'recall': 0.4629345019807153, 'f1-score': 0.5107430755498849, 'support': 394302}, '2': {'precision': 0.3830566037735849, 'recall': 0.3611877101531783, 'f1-score': 0.3718008589035703, 'support': 224836}, 'accuracy': 0.44301528000629414, 'macro avg': {'precision': 0.4349176804788463, 'recall': 0.4383735003298705, 'f1-score': 0.43089127576427105, 'support': 838874}, 'weighted avg': {'precision': 0.46262159879776626, 'recall': 0.44301528000629414, 'f1-score': 0.44714884025594187, 'support': 838874}}
[[107890  65584  46262]
 [127236 182536  84530]
 [ 71264  72364  81208]]
testing model out of sample: results/universal/W0/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 153s - 153s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0420837
{'0': {'precision': 0.3127211984648265, 'recall': 0.4920495394092718, 'f1-score': 0.38240535950551946, 'support': 1259361}, '1': {'precision': 0.6543792560949001, 'recall': 0.4676383347400869, 'f1-score': 0.545468855583532, 'support': 3290081}, '2': {'precision': 0.351780010345177, 'recall': 0.4111785311368325, 'f1-score': 0.3791670977457438, 'support': 1283496}, 'accuracy': 0.4604852648870946, 'macro avg': {'precision': 0.43962682163496786, 'recall': 0.4569554684287304, 'f1-score': 0.4356804376115984, 'support': 5832938}, 'weighted avg': {'precision': 0.5140287578317858, 'recall': 0.4604852648870946, 'f1-score': 0.4736691127331757, 'support': 5832938}}
[[ 619668  388177  251516]
 [1030559 1538568  720954]
 [ 331308  424442  527746]]
Evaluating performance on  train set...
6334/6334 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0375434
{'0': {'precision': 0.30728734365608634, 'recall': 0.49872981125721105, 'f1-score': 0.38027319386226965, 'support': 344437}, '1': {'precision': 0.6584391136379101, 'recall': 0.469775329626585, 'f1-score': 0.5483327278691291, 'support': 926958}, '2': {'precision': 0.3430550319215606, 'recall': 0.3931306992620824, 'f1-score': 0.3663897814695804, 'support': 349497}, 'accuracy': 0.4594019835991541, 'macro avg': {'precision': 0.4362604964051857, 'recall': 0.4538786133819595, 'f1-score': 0.4316652344003264, 'support': 1620892}, 'weighted avg': {'precision': 0.5158167473082297, 'recall': 0.4594019835991541, 'f1-score': 0.4733897732166762, 'support': 1620892}}
[[171781 109118  63538]
 [291919 435462 199577]
 [ 95324 116775 137398]]
Evaluating performance on  val set...
2156/2156 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0472852
{'0': {'precision': 0.28901538321546105, 'recall': 0.510943490656252, 'f1-score': 0.36919530135031287, 'support': 111893}, '1': {'precision': 0.6658012842643098, 'recall': 0.44682724298675663, 'f1-score': 0.5347663572133675, 'support': 323709}, '2': {'precision': 0.3310071034401785, 'recall': 0.3897673855938062, 'f1-score': 0.3579920634920635, 'support': 115728}, 'accuracy': 0.44786244173181217, 'macro avg': {'precision': 0.4286079236399831, 'recall': 0.44917937307893824, 'f1-score': 0.4206512406852479, 'support': 551330}, 'weighted avg': {'precision': 0.519056565521499, 'recall': 0.44786244173181217, 'f1-score': 0.4640573850597321, 'support': 551330}}
[[ 57171  34218  20504]
 [108406 144642  70661]
 [ 32236  38385  45107]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97938895
{'0': {'precision': 0.30172757678971435, 'recall': 0.21951600660802786, 'f1-score': 0.25413850587338305, 'support': 44794}, '1': {'precision': 0.6403849430399455, 'recall': 0.8179962476547843, 'f1-score': 0.7183752558023049, 'support': 133250}, '2': {'precision': 0.34902126065374167, 'recall': 0.16164924304862707, 'f1-score': 0.2209605692262081, 'support': 46106}, 'accuracy': 0.5633905866607183, 'macro avg': {'precision': 0.4303779268278005, 'recall': 0.3997204991038131, 'f1-score': 0.3978247769672987, 'support': 224150}, 'weighted avg': {'precision': 0.5127765022462307, 'recall': 0.5633905866607183, 'f1-score': 0.5232879369729779, 'support': 224150}}
[[  9833  30125   4836]
 [ 15187 108998   9065]
 [  7569  31084   7453]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0655547
{'0': {'precision': 0.334559093917776, 'recall': 0.21392964635063957, 'f1-score': 0.2609793178623677, 'support': 21264}, '1': {'precision': 0.5222248714193263, 'recall': 0.7830239268660146, 'f1-score': 0.6265695399421735, 'support': 39161}, '2': {'precision': 0.3567901234567901, 'recall': 0.15283653846153847, 'f1-score': 0.21400201952204645, 'support': 20800}, 'accuracy': 0.4726623576485072, 'macro avg': {'precision': 0.4045246962646308, 'recall': 0.3832633705593976, 'f1-score': 0.3671836257755292, 'support': 81225}, 'weighted avg': {'precision': 0.43073126907505155, 'recall': 0.4726623576485072, 'f1-score': 0.42521140012015274, 'support': 81225}}
[[ 4549 14326  2389]
 [ 5155 30664  3342]
 [ 3893 13728  3179]]
Evaluating performance on  val set...
104/104 - 1s - 740ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0486643
{'0': {'precision': 0.3027704485488127, 'recall': 0.22397527651268706, 'f1-score': 0.2574794315632012, 'support': 6148}, '1': {'precision': 0.5610914023372288, 'recall': 0.7825802226588081, 'f1-score': 0.653580869618061, 'support': 13743}, '2': {'precision': 0.34425639178970113, 'recall': 0.14480460466525297, 'f1-score': 0.20385968653374562, 'support': 6602}, 'accuracy': 0.4940172875853999, 'macro avg': {'precision': 0.4027060808919141, 'recall': 0.383786701278916, 'f1-score': 0.3716399959050026, 'support': 26493}, 'weighted avg': {'precision': 0.44711027662379654, 'recall': 0.4940172875853999, 'f1-score': 0.4495914802743125, 'support': 26493}}
[[ 1377  4092   679]
 [ 1846 10755  1142]
 [ 1325  4321   956]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
2359/2359 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0079348
{'0': {'precision': 0.2265694485621109, 'recall': 0.5950556001654622, 'f1-score': 0.32818234887575237, 'support': 82194}, '1': {'precision': 0.8415327441158192, 'recall': 0.4603701945894637, 'f1-score': 0.5951543416090347, 'support': 438256}, '2': {'precision': 0.25883853723727374, 'recall': 0.46018984075936303, 'f1-score': 0.3313217360502136, 'support': 83333}, 'accuracy': 0.47868025432978406, 'macro avg': {'precision': 0.44231357663840126, 'recall': 0.5052052118380963, 'f1-score': 0.4182194755116669, 'support': 603783}, 'weighted avg': {'precision': 0.6773943873609067, 'recall': 0.47868025432978406, 'f1-score': 0.5223973105403351, 'support': 603783}}
[[ 48910  18348  14936]
 [141623 201760  94873]
 [ 25339  19645  38349]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97884107
{'0': {'precision': 0.2655518662239469, 'recall': 0.5667691256830601, 'f1-score': 0.3616551799286279, 'support': 23424}, '1': {'precision': 0.8147391952309985, 'recall': 0.524684722728756, 'f1-score': 0.6383060702651582, 'support': 104194}, '2': {'precision': 0.2939601309134186, 'recall': 0.42796500043316293, 'f1-score': 0.3485254691689008, 'support': 23086}, 'accuracy': 0.5164096507060197, 'macro avg': {'precision': 0.4580837307894547, 'recall': 0.506472949614993, 'f1-score': 0.4494955731208956, 'support': 150704}, 'weighted avg': {'precision': 0.6496017770238053, 'recall': 0.5164096507060197, 'f1-score': 0.5509152550767685, 'support': 150704}}
[[13276  6061  4087]
 [29882 54669 19643]
 [ 6836  6370  9880]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0045667
{'0': {'precision': 0.2602668433005299, 'recall': 0.582054809014919, 'f1-score': 0.35969529538692907, 'support': 9451}, '1': {'precision': 0.8046724890829694, 'recall': 0.461424815324903, 'f1-score': 0.5865202514522161, 'support': 39935}, '2': {'precision': 0.2913481701954948, 'recall': 0.4565885720343475, 'f1-score': 0.35571522960026425, 'support': 9433}, 'accuracy': 0.4800319624611095, 'macro avg': {'precision': 0.452095834192998, 'recall': 0.5000227321247231, 'f1-score': 0.4339769254798031, 'support': 58819}, 'weighted avg': {'precision': 0.6348741916220233, 'recall': 0.4800319624611095, 'f1-score': 0.5130591856248051, 'support': 58819}}
[[ 5501  2191  1759]
 [12791 18427  8717]
 [ 2844  2282  4307]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
1625/1625 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0798122
{'0': {'precision': 0.3282324089001854, 'recall': 0.5850533074986194, 'f1-score': 0.42053314314933926, 'support': 106833}, '1': {'precision': 0.60452736522524, 'recall': 0.29658722650510255, 'f1-score': 0.39794071973533185, 'support': 198724}, '2': {'precision': 0.3731268614131497, 'recall': 0.43279928188667954, 'f1-score': 0.40075393760284783, 'support': 110289}, 'accuracy': 0.4068212751836016, 'macro avg': {'precision': 0.43529554517952507, 'recall': 0.43814660529680044, 'f1-score': 0.406409266829173, 'support': 415846}, 'weighted avg': {'precision': 0.47217464514615737, 'recall': 0.4068212751836016, 'f1-score': 0.4044909411056928, 'support': 415846}}
[[62503 17977 26353]
 [85944 58939 53841]
 [41976 20580 47733]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0796764
{'0': {'precision': 0.3400568127657141, 'recall': 0.5762980194500985, 'f1-score': 0.4277252889549662, 'support': 30951}, '1': {'precision': 0.5648428000694806, 'recall': 0.306767796834022, 'f1-score': 0.39759861100921917, 'support': 53001}, '2': {'precision': 0.3825781935106694, 'recall': 0.41554483108966217, 'f1-score': 0.39838066538824457, 'support': 31496}, 'accuracy': 0.4087034855519368, 'macro avg': {'precision': 0.4291592687819547, 'recall': 0.4328702157912609, 'f1-score': 0.4079015217841433, 'support': 115448}, 'weighted avg': {'precision': 0.4548542585510897, 'recall': 0.4087034855519368, 'f1-score': 0.40588877102776094, 'support': 115448}}
[[17837  6024  7090]
 [22710 16259 14032]
 [11906  6502 13088]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1023726
{'0': {'precision': 0.325558490397099, 'recall': 0.6089942215894816, 'f1-score': 0.4242954664799579, 'support': 11941}, '1': {'precision': 0.5653114679421478, 'recall': 0.23986470161874848, 'f1-score': 0.336816392997693, 'support': 20695}, '2': {'precision': 0.3752945376651196, 'recall': 0.42091775446464325, 'f1-score': 0.39679903367054203, 'support': 12487}, 'accuracy': 0.38765153026172905, 'macro avg': {'precision': 0.42205483200145544, 'recall': 0.42325889255762444, 'f1-score': 0.38597029771606434, 'support': 45123}, 'weighted avg': {'precision': 0.44928124581075846, 'recall': 0.38765153026172905, 'f1-score': 0.3765653203858009, 'support': 45123}}
[[7272 1809 2860]
 [9842 4964 5889]
 [5223 2008 5256]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.135547
{'0': {'precision': 0.4281751325062269, 'recall': 0.32162301158027273, 'f1-score': 0.3673281314085199, 'support': 112778}, '1': {'precision': 0.34997177769980625, 'recall': 0.6807014420509169, 'f1-score': 0.46227318065952666, 'support': 101106}, '2': {'precision': 0.4496347337128108, 'recall': 0.1759729425028185, 'f1-score': 0.25294941271034826, 'support': 110875}, 'accuracy': 0.38368759603275043, 'macro avg': {'precision': 0.40926054797294803, 'recall': 0.39276579871133604, 'f1-score': 0.36085024159279827, 'support': 324759}, 'weighted avg': {'precision': 0.41115483404712966, 'recall': 0.38368759603275043, 'f1-score': 0.3578373204191786, 'support': 324759}}
[[36272 62814 13692]
 [22093 68823 10190]
 [26348 65016 19511]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.115654
{'0': {'precision': 0.4130763766638871, 'recall': 0.3242817311189235, 'f1-score': 0.36333260893187, 'support': 41245}, '1': {'precision': 0.39032753607285897, 'recall': 0.6920888153894793, 'f1-score': 0.49914493935646825, 'support': 41119}, '2': {'precision': 0.4319607739758528, 'recall': 0.19558367152064932, 'f1-score': 0.26925415317876333, 'support': 41890}, 'accuracy': 0.4026107811418546, 'macro avg': {'precision': 0.41178822890419964, 'recall': 0.4039847393430174, 'f1-score': 0.37724390048903383, 'support': 124254}, 'weighted avg': {'precision': 0.41191470643303546, 'recall': 0.4026107811418546, 'f1-score': 0.37655971392029225, 'support': 124254}}
[[13375 21474  6396]
 [ 8283 28458  4378]
 [10721 22976  8193]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1281779
{'0': {'precision': 0.3987535953978907, 'recall': 0.2816605715833672, 'f1-score': 0.3301317669471345, 'support': 14766}, '1': {'precision': 0.37741371310275906, 'recall': 0.7101887299348513, 'f1-score': 0.492891437095045, 'support': 14889}, '2': {'precision': 0.4343891402714932, 'recall': 0.19364599092284418, 'f1-score': 0.26787582839204743, 'support': 15864}, 'accuracy': 0.3911553417254333, 'macro avg': {'precision': 0.403518816257381, 'recall': 0.3951650974803542, 'f1-score': 0.363633010811409, 'support': 45519}, 'weighted avg': {'precision': 0.4041929235110438, 'recall': 0.3911553417254333, 'f1-score': 0.3616724536844165, 'support': 45519}}
[[ 4159  8258  2349]
 [ 2664 10574  1651]
 [ 3607  9185  3072]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0923858
{'0': {'precision': 0.41571829260429427, 'recall': 0.35747750994552485, 'f1-score': 0.384404414997876, 'support': 144286}, '1': {'precision': 0.3907948361726384, 'recall': 0.5520780355489483, 'f1-score': 0.45764228015793446, 'support': 153366}, '2': {'precision': 0.42953470722167086, 'recall': 0.3026636042645093, 'f1-score': 0.35510740903112675, 'support': 145855}, 'accuracy': 0.40674442567986524, 'macro avg': {'precision': 0.41201594533286784, 'recall': 0.4040730499196608, 'f1-score': 0.3990513680623124, 'support': 443507}, 'weighted avg': {'precision': 0.41164345801300284, 'recall': 0.40674442567986524, 'f1-score': 0.4000954494637521, 'support': 443507}}
[[51579 65441 27266]
 [37333 84670 31363]
 [35160 66550 44145]]
Evaluating performance on  train set...
765/765 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0816185
{'0': {'precision': 0.41727135464766846, 'recall': 0.4366132372114426, 'f1-score': 0.4267232332923575, 'support': 65195}, '1': {'precision': 0.3858175006689858, 'recall': 0.4486138336600392, 'f1-score': 0.4148527528809219, 'support': 64278}, '2': {'precision': 0.43558619122464826, 'recall': 0.3469852619510944, 'f1-score': 0.3862701304807805, 'support': 66291}, 'accuracy': 0.4102031016938763, 'macro avg': {'precision': 0.4128916821804342, 'recall': 0.41073744427419207, 'f1-score': 0.40928203888468667, 'support': 195764}, 'weighted avg': {'precision': 0.41314556035189803, 'recall': 0.4102031016938763, 'f1-score': 0.4091271105202006, 'support': 195764}}
[[28465 22342 14388]
 [20025 28836 15417]
 [19727 23562 23002]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0897712
{'0': {'precision': 0.41093329685861485, 'recall': 0.4200885574458168, 'f1-score': 0.41546049598967455, 'support': 21455}, '1': {'precision': 0.3707259492425733, 'recall': 0.44794142816392507, 'f1-score': 0.4056922646343301, 'support': 21034}, '2': {'precision': 0.44208405296488196, 'recall': 0.3454496378604526, 'f1-score': 0.3878380767191091, 'support': 22229}, 'accuracy': 0.4035044346240613, 'macro avg': {'precision': 0.4079144330220234, 'recall': 0.4044932078233982, 'f1-score': 0.4029969457810379, 'support': 64718}, 'weighted avg': {'precision': 0.40856500376751803, 'recall': 0.4035044346240613, 'f1-score': 0.4027981186557997, 'support': 64718}}
[[9013 7769 4673]
 [6594 9422 5018]
 [6326 8224 7679]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/EXC
Evaluating performance on  test set...
4693/4693 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95423317
{'0': {'precision': 0.2222545262980026, 'recall': 0.6538371566004357, 'f1-score': 0.3317421460628315, 'support': 136794}, '1': {'precision': 0.8843375415282392, 'recall': 0.5391323509872611, 'f1-score': 0.6698771506686048, 'support': 925743}, '2': {'precision': 0.2702806481615796, 'recall': 0.45690587811034983, 'f1-score': 0.33964550338305144, 'support': 138650}, 'accuracy': 0.5427040086181419, 'macro avg': {'precision': 0.45895757199594045, 'recall': 0.5499584618993489, 'f1-score': 0.4470882667048292, 'support': 1201187}, 'weighted avg': {'precision': 0.7380589252505968, 'recall': 0.5427040086181419, 'f1-score': 0.5932517312158601, 'support': 1201187}}
[[ 89441  28384  18969]
 [274578 499098 152067]
 [ 38407  36893  63350]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99033386
{'0': {'precision': 0.22565873863286204, 'recall': 0.6381598946195156, 'f1-score': 0.33341803782055357, 'support': 49345}, '1': {'precision': 0.8594127979297282, 'recall': 0.48591088853468295, 'f1-score': 0.6208142181121988, 'support': 282949}, '2': {'precision': 0.27892181483341705, 'recall': 0.4586463208400519, 'f1-score': 0.3468871768940183, 'support': 50854}, 'accuracy': 0.5019000490672012, 'macro avg': {'precision': 0.4546644504653357, 'recall': 0.5275723679980835, 'f1-score': 0.4337064776089236, 'support': 383148}, 'weighted avg': {'precision': 0.7007459576737863, 'recall': 0.5019000490672012, 'f1-score': 0.5474434833814927, 'support': 383148}}
[[ 31490  10029   7826]
 [ 92989 137488  52472]
 [ 15068  12462  23324]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99905264
{'0': {'precision': 0.21387832699619772, 'recall': 0.6832390592438226, 'f1-score': 0.3257768251309495, 'support': 16795}, '1': {'precision': 0.8790438275589987, 'recall': 0.4644721756350853, 'f1-score': 0.6077953639469067, 'support': 105537}, '2': {'precision': 0.2699806029522964, 'recall': 0.469230329695446, 'f1-score': 0.34275220167786635, 'support': 17501}, 'accuracy': 0.4913432451567227, 'macro avg': {'precision': 0.45430091916916426, 'recall': 0.5389805215247846, 'f1-score': 0.4254414635852409, 'support': 139833}, 'weighted avg': {'precision': 0.722924241511398, 'recall': 0.4913432451567227, 'f1-score': 0.5407509485207592, 'support': 139833}}
[[11475  2813  2507]
 [36820 49019 19698]
 [ 5357  3932  8212]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/AAL
Evaluating performance on  test set...
6677/6677 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0119872
{'0': {'precision': 0.18073507341709533, 'recall': 0.6070446253157452, 'f1-score': 0.2785404475397676, 'support': 178150}, '1': {'precision': 0.867842599379795, 'recall': 0.48491322278418536, 'f1-score': 0.6221793243683389, 'support': 1345284}, '2': {'precision': 0.23246258685195084, 'recall': 0.44933735814944553, 'f1-score': 0.30640696119278127, 'support': 185847}, 'accuracy': 0.49377428287098496, 'macro avg': {'precision': 0.427013419882947, 'recall': 0.513765068749792, 'f1-score': 0.4023755777002959, 'support': 1709281}, 'weighted avg': {'precision': 0.7271450341821961, 'recall': 0.49377428287098496, 'f1-score': 0.5520301725986194, 'support': 1709281}}
[[108145  45410  24595]
 [441809 652346 251129]
 [ 48408  53931  83508]]
Evaluating performance on  train set...
2262/2262 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0454959
{'0': {'precision': 0.26955017143065846, 'recall': 0.5672370228750949, 'f1-score': 0.36544258276956976, 'support': 104087}, '1': {'precision': 0.7324542788795432, 'recall': 0.412466051059207, 'f1-score': 0.5277441863697651, 'support': 368200}, '2': {'precision': 0.3145728379513014, 'recall': 0.4501051208890224, 'f1-score': 0.37032804102057204, 'support': 106544}, 'accuracy': 0.44722552869490406, 'macro avg': {'precision': 0.4388590960871677, 'recall': 0.4766027316077748, 'f1-score': 0.4211716033866357, 'support': 578831}, 'weighted avg': {'precision': 0.5722951649511415, 'recall': 0.44722552869490406, 'f1-score': 0.46958345758361164, 'support': 578831}}
[[ 59042  26678  18367]
 [130205 151870  86125]
 [ 29792  28796  47956]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.055919
{'0': {'precision': 0.24406503285214137, 'recall': 0.597440713782578, 'f1-score': 0.3465558922673568, 'support': 34072}, '1': {'precision': 0.7591563715787318, 'recall': 0.39139400508139377, 'f1-score': 0.5164993359400395, 'support': 142087}, '2': {'precision': 0.2914670795009562, 'recall': 0.4519983053241068, 'f1-score': 0.35440150592403946, 'support': 35405}, 'accuracy': 0.4347195174982511, 'macro avg': {'precision': 0.43156282797727646, 'recall': 0.48027767472935956, 'f1-score': 0.40581891137714526, 'support': 211564}, 'weighted avg': {'precision': 0.5979345593653779, 'recall': 0.4347195174982511, 'f1-score': 0.46200335985463686, 'support': 211564}}
[[20356  8241  5475]
 [53048 55612 33427]
 [10000  9402 16003]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/WBA
Evaluating performance on  test set...
5633/5633 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91498816
{'0': {'precision': 0.29992343364008034, 'recall': 0.4505386237966684, 'f1-score': 0.3601170497496127, 'support': 230402}, '1': {'precision': 0.7730624465048651, 'recall': 0.6606635312841126, 'f1-score': 0.712457155304766, 'support': 980210}, '2': {'precision': 0.33775786630288607, 'recall': 0.37692730205823965, 'f1-score': 0.35626921315978805, 'support': 231217}, 'accuracy': 0.5815849174902156, 'macro avg': {'precision': 0.4702479154826105, 'recall': 0.49604315237967356, 'f1-score': 0.4762811394047222, 'support': 1441829}, 'weighted avg': {'precision': 0.6276485354497863, 'recall': 0.5815849174902156, 'f1-score': 0.5990341540896054, 'support': 1441829}}
[[103805  95851  30746]
 [192488 647589 140133]
 [ 49812  94253  87152]]
Evaluating performance on  train set...
1454/1454 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9832565
{'0': {'precision': 0.3683943510312267, 'recall': 0.41571445262296997, 'f1-score': 0.39062654385367834, 'support': 85590}, '1': {'precision': 0.632419955618957, 'recall': 0.6350275292327128, 'f1-score': 0.6337210600897885, 'support': 201059}, '2': {'precision': 0.387620380054604, 'recall': 0.3339848321707785, 'f1-score': 0.3588092917989501, 'support': 85444}, 'accuracy': 0.5154517822157364, 'macro avg': {'precision': 0.4628115622349293, 'recall': 0.4615756046754871, 'f1-score': 0.46105229858080565, 'support': 372093}, 'weighted avg': {'precision': 0.5154744435260544, 'recall': 0.5154517822157364, 'f1-score': 0.5146754968179961, 'support': 372093}}
[[ 35581  36644  13365]
 [ 41662 127678  31719]
 [ 19341  37566  28537]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9792327
{'0': {'precision': 0.3560913108281254, 'recall': 0.4405123892087727, 'f1-score': 0.3938285350723715, 'support': 30914}, '1': {'precision': 0.6592225879280799, 'recall': 0.6051261563814779, 'f1-score': 0.6310170870626526, 'support': 80099}, '2': {'precision': 0.3825266799386443, 'recall': 0.37331592190336654, 'f1-score': 0.3778651794061704, 'support': 31397}, 'accuracy': 0.5182852327785971, 'macro avg': {'precision': 0.4659468595649499, 'recall': 0.4729848224978724, 'f1-score': 0.4675702671803981, 'support': 142410}, 'weighted avg': {'precision': 0.5324167335399589, 'recall': 0.5182852327785971, 'f1-score': 0.52371663526209, 'support': 142410}}
[[13618 12448  4848]
 [17557 48470 14072]
 [ 7068 12608 11721]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
11876/11876 - 76s - 76s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0512047
{'0': {'precision': 0.37427645411134236, 'recall': 0.49394752055907437, 'f1-score': 0.42586459693679535, 'support': 785298}, '1': {'precision': 0.5681810636222595, 'recall': 0.4338613607663672, 'f1-score': 0.49201870784111545, 'support': 1459457}, '2': {'precision': 0.3880109475918896, 'recall': 0.4338313223929122, 'f1-score': 0.4096438176630397, 'support': 795399}, 'accuracy': 0.4493742751189578, 'macro avg': {'precision': 0.4434894884418305, 'recall': 0.4538800679061179, 'f1-score': 0.4425090408136502, 'support': 3040154}, 'weighted avg': {'precision': 0.47095571511684026, 'recall': 0.4493742751189578, 'f1-score': 0.45337869280974136, 'support': 3040154}}
[[387896 229124 168278]
 [450274 633202 375981]
 [198219 252111 345069]]
Evaluating performance on  train set...
2538/2538 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0063804
{'0': {'precision': 0.30107129663834503, 'recall': 0.5038230030909386, 'f1-score': 0.3769107195015091, 'support': 122940}, '1': {'precision': 0.7113669331193482, 'recall': 0.5156145138919959, 'f1-score': 0.5978755690440061, 'support': 402318}, '2': {'precision': 0.3310743812506977, 'recall': 0.40539214897962467, 'f1-score': 0.3644835152124172, 'support': 124366}, 'accuracy': 0.4922816891001564, 'macro avg': {'precision': 0.447837537002797, 'recall': 0.47494322198751976, 'f1-score': 0.4464232679193108, 'support': 649624}, 'weighted avg': {'precision': 0.5609149654354709, 'recall': 0.4922816891001564, 'f1-score': 0.5113771410770992, 'support': 649624}}
[[ 61940  39932  21068]
 [114079 207441  80798]
 [ 29713  44236  50417]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0125833
{'0': {'precision': 0.2938480575627492, 'recall': 0.5025210962196619, 'f1-score': 0.37084522248785373, 'support': 38277}, '1': {'precision': 0.7056140815830738, 'recall': 0.5065319064605628, 'f1-score': 0.5897244218026099, 'support': 126150}, '2': {'precision': 0.32283032795528843, 'recall': 0.3924368670683246, 'f1-score': 0.3542467021522796, 'support': 39005}, 'accuracy': 0.48390125447323923, 'macro avg': {'precision': 0.4407641557003705, 'recall': 0.4671632899161831, 'f1-score': 0.43827211548091444, 'support': 203432}, 'weighted avg': {'precision': 0.5547447571322611, 'recall': 0.48390125447323923, 'f1-score': 0.5033916542580148, 'support': 203432}}
[[19235 12274  6768]
 [36911 63899 25340]
 [ 9313 14385 15307]]
testing model on single stock: results/universal/W0/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
19053/19053 - 127s - 127s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0603985
{'0': {'precision': 0.327951290235211, 'recall': 0.5245004527054459, 'f1-score': 0.4035667745843948, 'support': 1177366}, '1': {'precision': 0.6140807552837083, 'recall': 0.41800381686898697, 'f1-score': 0.4974167941276112, 'support': 2541350}, '2': {'precision': 0.34493971435191445, 'recall': 0.37644490088286314, 'f1-score': 0.36000434120017677, 'support': 1158730}, 'accuracy': 0.4338379143510764, 'macro avg': {'precision': 0.4289905866236112, 'recall': 0.4396497234857653, 'f1-score': 0.42032930330406093, 'support': 4877446}, 'weighted avg': {'precision': 0.48107243451394754, 'recall': 0.4338379143510764, 'f1-score': 0.44211741127639675, 'support': 4877446}}
[[ 617529  321960  237877]
 [ 888568 1062294  590488]
 [ 376893  345639  436198]]
Evaluating performance on  train set...
4812/4812 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0816531
{'0': {'precision': 0.4081406221514781, 'recall': 0.5120092463942751, 'f1-score': 0.45421247019452915, 'support': 406645}, '1': {'precision': 0.3994957711162991, 'recall': 0.35779167332096656, 'f1-score': 0.3774953922247194, 'support': 407005}, '2': {'precision': 0.433851132504892, 'recall': 0.37057078024087975, 'f1-score': 0.39972196215280736, 'support': 418217}, 'accuracy': 0.4130380958333976, 'macro avg': {'precision': 0.4138291752575564, 'recall': 0.41345723331870715, 'f1-score': 0.41047660819068527, 'support': 1231867}, 'weighted avg': {'precision': 0.4140130701616129, 'recall': 0.4130380958333976, 'f1-score': 0.41036594202161175, 'support': 1231867}}
[[208206 102988  95451]
 [154595 145623 106787]
 [147332 115906 154979]]
Evaluating performance on  val set...
1767/1767 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0901242
{'0': {'precision': 0.39990733169801035, 'recall': 0.4963331303700697, 'f1-score': 0.44293304353076135, 'support': 147810}, '1': {'precision': 0.3999971422651835, 'recall': 0.3639318261593063, 'f1-score': 0.3811131570080289, 'support': 153842}, '2': {'precision': 0.41883419206654665, 'recall': 0.3583088269461833, 'f1-score': 0.38621459467001534, 'support': 150641}, 'accuracy': 0.4053279621838056, 'macro avg': {'precision': 0.4062462220099135, 'recall': 0.40619126115851983, 'f1-score': 0.4034202650696019, 'support': 452293}, 'weighted avg': {'precision': 0.4062416720704055, 'recall': 0.4053279621838056, 'f1-score': 0.40301507257551367, 'support': 452293}}
[[73363 39840 34607]
 [57565 55988 40289]
 [52522 44143 53976]]
training model: results/universal/W0/deepOF_L1/h20
Epoch 1/50
8838/8838 - 130s - loss: 3.1260 - accuracy20: 0.4577 - val_loss: 3.2354 - val_accuracy20: 0.3715 - 130s/epoch - 15ms/step
Epoch 2/50
8838/8838 - 126s - loss: 3.1141 - accuracy20: 0.4596 - val_loss: 3.2398 - val_accuracy20: 0.3726 - 126s/epoch - 14ms/step
Epoch 3/50
8838/8838 - 127s - loss: 3.1016 - accuracy20: 0.4631 - val_loss: 3.2422 - val_accuracy20: 0.3715 - 127s/epoch - 14ms/step
Epoch 4/50
8838/8838 - 126s - loss: 3.0909 - accuracy20: 0.4655 - val_loss: 3.2461 - val_accuracy20: 0.3750 - 126s/epoch - 14ms/step
Epoch 5/50
8838/8838 - 124s - loss: 3.0809 - accuracy20: 0.4677 - val_loss: 3.2465 - val_accuracy20: 0.3753 - 124s/epoch - 14ms/step
Epoch 6/50
8838/8838 - 125s - loss: 3.0720 - accuracy20: 0.4695 - val_loss: 3.2490 - val_accuracy20: 0.3764 - 125s/epoch - 14ms/step
Epoch 7/50
8838/8838 - 127s - loss: 3.0637 - accuracy20: 0.4708 - val_loss: 3.2480 - val_accuracy20: 0.3793 - 127s/epoch - 14ms/step
Epoch 8/50
8838/8838 - 127s - loss: 3.0567 - accuracy20: 0.4723 - val_loss: 3.2511 - val_accuracy20: 0.3797 - 127s/epoch - 14ms/step
Epoch 9/50
8838/8838 - 128s - loss: 3.0499 - accuracy20: 0.4732 - val_loss: 3.2417 - val_accuracy20: 0.3847 - 128s/epoch - 14ms/step
Epoch 10/50
8838/8838 - 128s - loss: 3.0443 - accuracy20: 0.4741 - val_loss: 3.2430 - val_accuracy20: 0.3834 - 128s/epoch - 15ms/step
Epoch 11/50
8838/8838 - 130s - loss: 3.0397 - accuracy20: 0.4744 - val_loss: 3.2325 - val_accuracy20: 0.3905 - 130s/epoch - 15ms/step
Epoch 12/50
8838/8838 - 129s - loss: 3.0348 - accuracy20: 0.4753 - val_loss: 3.2267 - val_accuracy20: 0.3919 - 129s/epoch - 15ms/step
Epoch 13/50
8838/8838 - 127s - loss: 3.0310 - accuracy20: 0.4762 - val_loss: 3.2221 - val_accuracy20: 0.3928 - 127s/epoch - 14ms/step
Epoch 14/50
8838/8838 - 126s - loss: 3.0273 - accuracy20: 0.4770 - val_loss: 3.2188 - val_accuracy20: 0.3939 - 126s/epoch - 14ms/step
Epoch 15/50
8838/8838 - 126s - loss: 3.0236 - accuracy20: 0.4777 - val_loss: 3.2153 - val_accuracy20: 0.3953 - 126s/epoch - 14ms/step
Epoch 16/50
8838/8838 - 126s - loss: 3.0203 - accuracy20: 0.4784 - val_loss: 3.2157 - val_accuracy20: 0.3951 - 126s/epoch - 14ms/step
Epoch 17/50
8838/8838 - 125s - loss: 3.0175 - accuracy20: 0.4790 - val_loss: 3.2119 - val_accuracy20: 0.3951 - 125s/epoch - 14ms/step
Epoch 18/50
8838/8838 - 126s - loss: 3.0144 - accuracy20: 0.4795 - val_loss: 3.2160 - val_accuracy20: 0.3952 - 126s/epoch - 14ms/step
Epoch 19/50
8838/8838 - 126s - loss: 3.0118 - accuracy20: 0.4801 - val_loss: 3.2082 - val_accuracy20: 0.3979 - 126s/epoch - 14ms/step
Epoch 20/50
8838/8838 - 129s - loss: 3.0089 - accuracy20: 0.4809 - val_loss: 3.2013 - val_accuracy20: 0.4002 - 129s/epoch - 15ms/step
Epoch 21/50
8838/8838 - 126s - loss: 3.0064 - accuracy20: 0.4816 - val_loss: 3.2063 - val_accuracy20: 0.3983 - 126s/epoch - 14ms/step
Epoch 22/50
8838/8838 - 126s - loss: 3.0045 - accuracy20: 0.4823 - val_loss: 3.2004 - val_accuracy20: 0.4013 - 126s/epoch - 14ms/step
Epoch 23/50
8838/8838 - 126s - loss: 3.0023 - accuracy20: 0.4826 - val_loss: 3.2054 - val_accuracy20: 0.3978 - 126s/epoch - 14ms/step
Epoch 24/50
8838/8838 - 124s - loss: 2.9998 - accuracy20: 0.4834 - val_loss: 3.2064 - val_accuracy20: 0.3992 - 124s/epoch - 14ms/step
Epoch 25/50
8838/8838 - 124s - loss: 2.9979 - accuracy20: 0.4836 - val_loss: 3.2015 - val_accuracy20: 0.4011 - 124s/epoch - 14ms/step
Epoch 26/50
8838/8838 - 127s - loss: 2.9954 - accuracy20: 0.4845 - val_loss: 3.2038 - val_accuracy20: 0.4007 - 127s/epoch - 14ms/step
Epoch 27/50
8838/8838 - 127s - loss: 2.9941 - accuracy20: 0.4849 - val_loss: 3.1985 - val_accuracy20: 0.4024 - 127s/epoch - 14ms/step
Epoch 28/50
8838/8838 - 127s - loss: 2.9920 - accuracy20: 0.4855 - val_loss: 3.2033 - val_accuracy20: 0.4020 - 127s/epoch - 14ms/step
Epoch 29/50
8838/8838 - 128s - loss: 2.9901 - accuracy20: 0.4857 - val_loss: 3.1997 - val_accuracy20: 0.4042 - 128s/epoch - 14ms/step
Epoch 30/50
8838/8838 - 128s - loss: 2.9882 - accuracy20: 0.4862 - val_loss: 3.2006 - val_accuracy20: 0.4011 - 128s/epoch - 15ms/step
Epoch 31/50
8838/8838 - 128s - loss: 2.9866 - accuracy20: 0.4865 - val_loss: 3.1997 - val_accuracy20: 0.4018 - 128s/epoch - 14ms/step
Epoch 32/50
8838/8838 - 127s - loss: 2.9851 - accuracy20: 0.4869 - val_loss: 3.1937 - val_accuracy20: 0.4039 - 127s/epoch - 14ms/step
Epoch 33/50
8838/8838 - 129s - loss: 2.9835 - accuracy20: 0.4877 - val_loss: 3.1935 - val_accuracy20: 0.4061 - 129s/epoch - 15ms/step
Epoch 34/50
8838/8838 - 128s - loss: 2.9817 - accuracy20: 0.4880 - val_loss: 3.1984 - val_accuracy20: 0.4073 - 128s/epoch - 15ms/step
Epoch 35/50
8838/8838 - 129s - loss: 2.9802 - accuracy20: 0.4881 - val_loss: 3.1980 - val_accuracy20: 0.4054 - 129s/epoch - 15ms/step
Epoch 36/50
8838/8838 - 127s - loss: 2.9792 - accuracy20: 0.4884 - val_loss: 3.1963 - val_accuracy20: 0.4066 - 127s/epoch - 14ms/step
Epoch 37/50
8838/8838 - 126s - loss: 2.9776 - accuracy20: 0.4888 - val_loss: 3.1937 - val_accuracy20: 0.4080 - 126s/epoch - 14ms/step
Epoch 38/50
8838/8838 - 126s - loss: 2.9762 - accuracy20: 0.4890 - val_loss: 3.1956 - val_accuracy20: 0.4076 - 126s/epoch - 14ms/step
Epoch 39/50
8838/8838 - 127s - loss: 2.9751 - accuracy20: 0.4894 - val_loss: 3.2049 - val_accuracy20: 0.4030 - 127s/epoch - 14ms/step
Epoch 40/50
8838/8838 - 128s - loss: 2.9737 - accuracy20: 0.4897 - val_loss: 3.1949 - val_accuracy20: 0.4071 - 128s/epoch - 14ms/step
Epoch 41/50
8838/8838 - 129s - loss: 2.9724 - accuracy20: 0.4902 - val_loss: 3.1966 - val_accuracy20: 0.4083 - 129s/epoch - 15ms/step
Epoch 42/50
8838/8838 - 127s - loss: 2.9710 - accuracy20: 0.4905 - val_loss: 3.1955 - val_accuracy20: 0.4055 - 127s/epoch - 14ms/step
Epoch 43/50
8838/8838 - 128s - loss: 2.9695 - accuracy20: 0.4910 - val_loss: 3.1962 - val_accuracy20: 0.4069 - 128s/epoch - 14ms/step
testing model in sample: results/universal/W0/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 218s - 218s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0821987
{'0': {'precision': 0.31604003390808766, 'recall': 0.5553117699009086, 'f1-score': 0.40282409429088367, 'support': 1954358}, '1': {'precision': 0.6816364788955067, 'recall': 0.2928214670668685, 'f1-score': 0.40965912296882945, 'support': 4549704}, '2': {'precision': 0.3269372650322199, 'recall': 0.5144626420736453, 'f1-score': 0.3998027756845114, 'support': 1944942}, 'accuracy': 0.4045599931068798, 'macro avg': {'precision': 0.4415379259452714, 'recall': 0.45419862634714087, 'f1-score': 0.4040953309814082, 'support': 8449004}, 'weighted avg': {'precision': 0.515418574933997, 'recall': 0.4045599931068798, 'f1-score': 0.4058091879023022, 'support': 8449004}}
[[1085278  318661  550419]
 [1707946 1332251 1509507]
 [ 640765  303577 1000600]]
Evaluating performance on  train set...
8838/8838 - 60s - 60s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0805548
{'0': {'precision': 0.3673212576464523, 'recall': 0.5246348367500968, 'f1-score': 0.43210541247675194, 'support': 653201}, '1': {'precision': 0.5478283423823608, 'recall': 0.2665867641053653, 'f1-score': 0.35864704354700155, 'support': 942815}, '2': {'precision': 0.386068342678555, 'recall': 0.5044711358006155, 'f1-score': 0.43739854331964306, 'support': 666050}, 'accuracy': 0.4111449444887992, 'macro avg': {'precision': 0.4337393142357893, 'recall': 0.43189757888535923, 'f1-score': 0.40938366644779883, 'support': 2262066}, 'weighted avg': {'precision': 0.4480754368264221, 'recall': 0.4111449444887992, 'f1-score': 0.4030469489727715, 'support': 2262066}}
[[342692 104149 206360]
 [363516 251342 327957]
 [226741 103306 336003]]
Evaluating performance on  val set...
3279/3279 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0839309
{'0': {'precision': 0.3586885631187755, 'recall': 0.5152993610142738, 'f1-score': 0.42296233683452045, 'support': 236938}, '1': {'precision': 0.5454307663438739, 'recall': 0.2666970658318018, 'f1-score': 0.35823125186734384, 'support': 359659}, '2': {'precision': 0.37913601944064745, 'recall': 0.5048683944410737, 'f1-score': 0.4330607187112763, 'support': 242277}, 'accuracy': 0.4057009753550593, 'macro avg': {'precision': 0.42775178296776567, 'recall': 0.42895494042904975, 'f1-score': 0.4047514358043802, 'support': 838874}, 'weighted avg': {'precision': 0.44465792495980266, 'recall': 0.4057009753550593, 'f1-score': 0.39812605436271303, 'support': 838874}}
[[122094  40581  74263]
 [137697  95920 126042]
 [ 80599  39360 122318]]
testing model out of sample: results/universal/W0/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 154s - 154s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0812049
{'0': {'precision': 0.3544114016903074, 'recall': 0.5512669789302351, 'f1-score': 0.4314452169530219, 'support': 1557445}, '1': {'precision': 0.6437215296929228, 'recall': 0.2480885920640607, 'f1-score': 0.35814791531679563, 'support': 2693695}, '2': {'precision': 0.3683250311831207, 'recall': 0.5523897488807041, 'f1-score': 0.44195873876949726, 'support': 1581798}, 'accuracy': 0.4115613778168052, 'macro avg': {'precision': 0.45548598752211694, 'recall': 0.45058177329166665, 'f1-score': 0.41051729034643825, 'support': 5832938}, 'weighted avg': {'precision': 0.4917901628831194, 'recall': 0.4115613778168052, 'f1-score': 0.40044706350981074, 'support': 5832938}}
[[ 858568  192728  506149]
 [1033061  668275  992359]
 [ 530889  177140  873769]]
Evaluating performance on  train set...
6334/6334 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0836122
{'0': {'precision': 0.34792477159019153, 'recall': 0.5545454332173583, 'f1-score': 0.42758218977362766, 'support': 426241}, '1': {'precision': 0.6191139540985245, 'recall': 0.25979721405241607, 'f1-score': 0.36600759276766726, 'support': 762972}, '2': {'precision': 0.36108227637252016, 'recall': 0.5197403626305658, 'f1-score': 0.42612218385696216, 'support': 431679}, 'accuracy': 0.40653479688961386, 'macro avg': {'precision': 0.44270700068707874, 'recall': 0.44469433663344676, 'f1-score': 0.40657065546608573, 'support': 1620892}, 'weighted avg': {'precision': 0.47908068541028476, 'recall': 0.40653479688961386, 'f1-score': 0.39820950650976317, 'support': 1620892}}
[[236370  63032 126839]
 [294597 198218 270157]
 [148404  58914 224361]]
Evaluating performance on  val set...
2156/2156 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.087079
{'0': {'precision': 0.33694749211241054, 'recall': 0.5599931326051033, 'f1-score': 0.4207375079947759, 'support': 139791}, '1': {'precision': 0.633554990011767, 'recall': 0.25886860524923033, 'f1-score': 0.36755526744016825, 'support': 268306}, '2': {'precision': 0.35430378174940536, 'recall': 0.5179113751719226, 'f1-score': 0.42076305915651135, 'support': 143233}, 'accuracy': 0.40251754847369087, 'macro avg': {'precision': 0.4416020879578609, 'recall': 0.4455910376754188, 'f1-score': 0.4030186115304852, 'support': 551330}, 'weighted avg': {'precision': 0.48580129068125394, 'recall': 0.40251754847369087, 'f1-score': 0.39486288759556726, 'support': 551330}}
[[ 78282  20386  41123]
 [104781  69456  94069]
 [ 49264  19787  74182]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0704105
{'0': {'precision': 0.31205311542390196, 'recall': 0.3083300291965541, 'f1-score': 0.31018040068896746, 'support': 55486}, '1': {'precision': 0.5616407126823794, 'recall': 0.5734364648797694, 'f1-score': 0.5674772978959025, 'support': 111702}, '2': {'precision': 0.31243894496906544, 'recall': 0.3032021347565043, 'f1-score': 0.3077512473271561, 'support': 56962}, 'accuracy': 0.43913896944010705, 'macro avg': {'precision': 0.3953775910251156, 'recall': 0.39498954294427596, 'f1-score': 0.39513631530400867, 'support': 224150}, 'weighted avg': {'precision': 0.436529632985883, 'recall': 0.43913896944010705, 'f1-score': 0.43778338341488116, 'support': 224150}}
[[17108 24837 13541]
 [23182 64054 24466]
 [14534 25157 17271]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1114087
{'0': {'precision': 0.356737817528007, 'recall': 0.29822330134504954, 'f1-score': 0.32486670305218524, 'support': 25947}, '1': {'precision': 0.42635079191260916, 'recall': 0.5327215084264976, 'f1-score': 0.47363736165919945, 'support': 29965}, '2': {'precision': 0.3469877336712986, 'recall': 0.30284833879824596, 'f1-score': 0.3234189765008649, 'support': 25313}, 'accuracy': 0.38617420744844566, 'macro avg': {'precision': 0.37669211437063826, 'recall': 0.37793104952326434, 'f1-score': 0.3739743470707499, 'support': 81225}, 'weighted avg': {'precision': 0.37938046332387954, 'recall': 0.38617420744844566, 'f1-score': 0.3792990389458831, 'support': 81225}}
[[ 7738 10974  7235]
 [ 6810 15963  7192]
 [ 7143 10504  7666]]
Evaluating performance on  val set...
104/104 - 1s - 747ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1058773
{'0': {'precision': 0.32954545454545453, 'recall': 0.30392677102679755, 'f1-score': 0.31621808143547275, 'support': 7538}, '1': {'precision': 0.464599609375, 'recall': 0.5238575885483575, 'f1-score': 0.49245234193047527, 'support': 10898}, '2': {'precision': 0.3391699986212602, 'recall': 0.30532456249224277, 'f1-score': 0.3213585891574135, 'support': 8057}, 'accuracy': 0.394821273543955, 'macro avg': {'precision': 0.37777168751390494, 'recall': 0.37770297402246594, 'f1-score': 0.37667633750778723, 'support': 26493}, 'weighted avg': {'precision': 0.38802751135106933, 'recall': 0.394821273543955, 'f1-score': 0.3902760605843126, 'support': 26493}}
[[2291 3243 2004]
 [2400 5709 2789]
 [2261 3336 2460]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
2359/2359 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1038494
{'0': {'precision': 0.2533516031789531, 'recall': 0.6531642707764191, 'f1-score': 0.36509060656242676, 'support': 106154}, '1': {'precision': 0.8202735523456475, 'recall': 0.24740272758583465, 'f1-score': 0.38014877361489874, 'support': 389062}, '2': {'precision': 0.2831836362525439, 'recall': 0.5549660578260429, 'f1-score': 0.375010114212803, 'support': 108567}, 'accuracy': 0.37404497973609724, 'macro avg': {'precision': 0.4522695972590482, 'recall': 0.4851776853960989, 'f1-score': 0.3734164981300428, 'support': 603783}, 'weighted avg': {'precision': 0.6240254408348542, 'recall': 0.37404497973609724, 'f1-score': 0.3765773356966476, 'support': 603783}}
[[ 69336  10816  26002]
 [166297  96255 126510]
 [ 38042  10274  60251]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0713328
{'0': {'precision': 0.29251101321585904, 'recall': 0.6422295081967213, 'f1-score': 0.40194941773970144, 'support': 30500}, '1': {'precision': 0.7942669709070166, 'recall': 0.3084685682636389, 'f1-score': 0.4443611122192524, 'support': 90275}, '2': {'precision': 0.30631278374658477, 'recall': 0.4982124360987671, 'f1-score': 0.37937614492163646, 'support': 29929}, 'accuracy': 0.41369837562373923, 'macro avg': {'precision': 0.46436358928982013, 'recall': 0.48297017085304245, 'f1-score': 0.4085622249601968, 'support': 150704}, 'weighted avg': {'precision': 0.5958147892986659, 'recall': 0.41369837562373923, 'f1-score': 0.4228720225608714, 'support': 150704}}
[[19588  3364  7548]
 [36208 27847 26220]
 [11169  3849 14911]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0763836
{'0': {'precision': 0.2971210250077184, 'recall': 0.6303422302276077, 'f1-score': 0.4038713738656035, 'support': 12214}, '1': {'precision': 0.7866118898018366, 'recall': 0.2847021779060614, 'f1-score': 0.4180849014193051, 'support': 34299}, '2': {'precision': 0.3178646367052164, 'recall': 0.5293352836014952, 'f1-score': 0.39720723192780266, 'support': 12306}, 'accuracy': 0.40765738961900067, 'macro avg': {'precision': 0.4671991838382572, 'recall': 0.4814598972450548, 'f1-score': 0.40638783573757037, 'support': 58819}, 'weighted avg': {'precision': 0.5868967447092243, 'recall': 0.40765738961900067, 'f1-score': 0.4107654191720153, 'support': 58819}}
[[ 7699  1323  3192]
 [13747  9765 10787]
 [ 4466  1326  6514]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
1625/1625 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838195
{'0': {'precision': 0.3824553470495139, 'recall': 0.6344086828031593, 'f1-score': 0.47721816453250054, 'support': 133321}, '1': {'precision': 0.5400154755982977, 'recall': 0.13445488010458595, 'f1-score': 0.21530291261066212, 'support': 145335}, '2': {'precision': 0.4206548482745568, 'recall': 0.4860266783293243, 'f1-score': 0.45098410551234364, 'support': 137190}, 'accuracy': 0.4107265670464547, 'macro avg': {'precision': 0.4477085569741228, 'recall': 0.41829674707902315, 'f1-score': 0.38116839421850207, 'support': 415846}, 'weighted avg': {'precision': 0.4501236445820166, 'recall': 0.4107265670464547, 'f1-score': 0.3770260172110505, 'support': 415846}}
[[84580  7294 41447]
 [75409 19541 50385]
 [61161  9351 66678]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0816892
{'0': {'precision': 0.3902946386491801, 'recall': 0.6330495294830903, 'f1-score': 0.48287926007841553, 'support': 37937}, '1': {'precision': 0.5123982585652092, 'recall': 0.13959724621612563, 'f1-score': 0.21941680682485967, 'support': 38783}, '2': {'precision': 0.4238390735657109, 'recall': 0.47441127866143357, 'f1-score': 0.4477015485458776, 'support': 38728}, 'accuracy': 0.4140652068463724, 'macro avg': {'precision': 0.44217732359336676, 'recall': 0.4156860181202165, 'f1-score': 0.383332538483051, 'support': 115448}, 'weighted avg': {'precision': 0.4425662550188943, 'recall': 0.4140652068463724, 'f1-score': 0.3825723969299436, 'support': 115448}}
[[24016  2416 11505]
 [19898  5414 13471]
 [17619  2736 18373]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0950413
{'0': {'precision': 0.38474863194362424, 'recall': 0.6573177293516277, 'f1-score': 0.48538578062529497, 'support': 14868}, '1': {'precision': 0.4761747187293183, 'recall': 0.09622199933132732, 'f1-score': 0.1600934527451744, 'support': 14955}, '2': {'precision': 0.4204191616766467, 'recall': 0.4588888888888889, 'f1-score': 0.4388125, 'support': 15300}, 'accuracy': 0.4040733107284533, 'macro avg': {'precision': 0.42711417078319647, 'recall': 0.404142872523948, 'f1-score': 0.36143057779015647, 'support': 45123}, 'weighted avg': {'precision': 0.42714466573559945, 'recall': 0.4040733107284533, 'f1-score': 0.3617832285561902, 'support': 45123}}
[[9773  728 4367]
 [8204 1439 5312]
 [7424  855 7021]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0964842
{'0': {'precision': 0.4051823125419763, 'recall': 0.49683863769193987, 'f1-score': 0.4463537751047148, 'support': 112926}, '1': {'precision': 0.36062831936307355, 'recall': 0.3678639130000998, 'f1-score': 0.36421018318672804, 'support': 100230}, '2': {'precision': 0.42109771913334204, 'recall': 0.3171240916462819, 'f1-score': 0.36178890876565295, 'support': 111603}, 'accuracy': 0.3952746498172491, 'macro avg': {'precision': 0.39563611701279733, 'recall': 0.3939422141127738, 'f1-score': 0.3907842890190319, 'support': 324759}, 'weighted avg': {'precision': 0.3969009727961795, 'recall': 0.3952746498172491, 'f1-score': 0.3919412877033552, 'support': 324759}}
[[56106 31477 25343]
 [40047 36871 23312]
 [42318 33893 35392]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0930704
{'0': {'precision': 0.3871578124678637, 'recall': 0.45610719391340165, 'f1-score': 0.4188136875361545, 'support': 41271}, '1': {'precision': 0.4116291304456748, 'recall': 0.398578497962352, 'f1-score': 0.4049987059562983, 'support': 41224}, '2': {'precision': 0.4017247172135737, 'recall': 0.34359060322325724, 'f1-score': 0.3703904485317844, 'support': 41759}, 'accuracy': 0.3992064641782156, 'macro avg': {'precision': 0.40017055337570406, 'recall': 0.3994254316996703, 'f1-score': 0.39806761400807905, 'support': 124254}, 'weighted avg': {'precision': 0.4001723229672713, 'recall': 0.3992064641782156, 'f1-score': 0.3979562918931049, 'support': 124254}}
[[18824 11278 11169]
 [14594 16431 10199]
 [15203 12208 14348]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0975577
{'0': {'precision': 0.38329928498467825, 'recall': 0.4031153484624681, 'f1-score': 0.3929576542967472, 'support': 14894}, '1': {'precision': 0.3950711382113821, 'recall': 0.41510945008008543, 'f1-score': 0.40484248893517316, 'support': 14984}, '2': {'precision': 0.41109772517893844, 'recall': 0.37088421456428616, 'f1-score': 0.38995697768217263, 'support': 15641}, 'accuracy': 0.3959884883235572, 'macro avg': {'precision': 0.3964893827916663, 'recall': 0.3963696710356132, 'f1-score': 0.39591904030469766, 'support': 45519}, 'weighted avg': {'precision': 0.3967263122002883, 'recall': 0.3959884883235572, 'f1-score': 0.395838841917161, 'support': 45519}}
[[6004 4670 4220]
 [4674 6220 4090]
 [4986 4854 5801]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1069336
{'0': {'precision': 0.3736647683546252, 'recall': 0.512944938233347, 'f1-score': 0.43236488411854107, 'support': 141986}, '1': {'precision': 0.39491137793024583, 'recall': 0.175665708690455, 'f1-score': 0.24316569557640513, 'support': 157276}, '2': {'precision': 0.384897865503787, 'recall': 0.47666816874068424, 'f1-score': 0.4258955283973711, 'support': 144245}, 'accuracy': 0.3815407648582773, 'macro avg': {'precision': 0.38449133726288603, 'recall': 0.3884262718881621, 'f1-score': 0.36714203603077245, 'support': 443507}, 'weighted avg': {'precision': 0.38485264107342365, 'recall': 0.3815407648582773, 'f1-score': 0.36316718533779324, 'support': 443507}}
[[72831 21634 47521]
 [67289 27628 62359]
 [54790 20698 68757]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0970496
{'0': {'precision': 0.38632993014508327, 'recall': 0.5510454350358698, 'f1-score': 0.45421578661410356, 'support': 65236}, '1': {'precision': 0.4091468697277826, 'recall': 0.14017027259236117, 'f1-score': 0.2088055290531264, 'support': 64015}, '2': {'precision': 0.4031541289627768, 'recall': 0.48964864011546616, 'f1-score': 0.44221160112969804, 'support': 66513}, 'accuracy': 0.3958286508244621, 'macro avg': {'precision': 0.3995436429452142, 'recall': 0.39362144924789905, 'f1-score': 0.36841097226564273, 'support': 195764}, 'weighted avg': {'precision': 0.3995072984219255, 'recall': 0.3958286508244621, 'f1-score': 0.3698878610154735, 'support': 195764}}
[[35948  6443 22845]
 [29672  8973 25370]
 [27430  6515 32568]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1020488
{'0': {'precision': 0.37842579107639346, 'recall': 0.5345270933657488, 'f1-score': 0.4431309470746691, 'support': 21389}, '1': {'precision': 0.40084618534188615, 'recall': 0.13677004749930147, 'f1-score': 0.20395125169264955, 'support': 21474}, '2': {'precision': 0.3956731299900659, 'recall': 0.49206131320064056, 'f1-score': 0.43863441693518784, 'support': 21855}, 'accuracy': 0.3882072993603016, 'macro avg': {'precision': 0.3916483688027818, 'recall': 0.38778615135523026, 'f1-score': 0.3619055385675021, 'support': 64718}, 'weighted avg': {'precision': 0.3916894292978388, 'recall': 0.3882072993603016, 'f1-score': 0.3622505668893752, 'support': 64718}}
[[11433  2183  7773]
 [ 9885  2937  8652]
 [ 8894  2207 10754]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/EXC
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.038233
{'0': {'precision': 0.26983692920193836, 'recall': 0.7049213911636629, 'f1-score': 0.39027894309025846, 'support': 190373}, '1': {'precision': 0.862799417630542, 'recall': 0.364757131447246, 'f1-score': 0.512745813340658, 'support': 818838}, '2': {'precision': 0.3110054936606232, 'recall': 0.5794578488977788, 'f1-score': 0.40476584658544085, 'support': 191976}, 'accuracy': 0.45298275788865516, 'macro avg': {'precision': 0.4812139468310345, 'recall': 0.5497121238362292, 'f1-score': 0.43593020100545243, 'support': 1201187}, 'weighted avg': {'precision': 0.680633578208647, 'recall': 0.45298275788865516, 'f1-score': 0.4760787934778233, 'support': 1201187}}
[[134198  21880  34295]
 [308013 298677 212148]
 [ 55119  25615 111242]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.059899
{'0': {'precision': 0.28042667113860825, 'recall': 0.6946162861423888, 'f1-score': 0.39954943807760246, 'support': 67407}, '1': {'precision': 0.8396312194709352, 'recall': 0.3215610372361964, 'f1-score': 0.4650266728346988, 'support': 246964}, '2': {'precision': 0.32091546805483595, 'recall': 0.5673844453814502, 'f1-score': 0.40995713745430096, 'support': 68777}, 'accuracy': 0.4313189681271989, 'macro avg': {'precision': 0.48032445288812653, 'recall': 0.5278539229200118, 'f1-score': 0.42484441612220075, 'support': 383148}, 'weighted avg': {'precision': 0.6481385998446232, 'recall': 0.4313189681271989, 'f1-score': 0.44362204225296736, 'support': 383148}}
[[46822  7002 13583]
 [98557 79414 68993]
 [21588  8166 39023]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502338
{'0': {'precision': 0.2723346252381265, 'recall': 0.7172888100696397, 'f1-score': 0.39478163573817715, 'support': 23119}, '1': {'precision': 0.8480449671205217, 'recall': 0.33530040024597324, 'f1-score': 0.4805863524609176, 'support': 92693}, '2': {'precision': 0.3285727797219332, 'recall': 0.5784938179093293, 'f1-score': 0.4191033432358663, 'support': 24021}, 'accuracy': 0.4402322770733661, 'macro avg': {'precision': 0.4829841240268604, 'recall': 0.5436943427416474, 'f1-score': 0.43149044381165363, 'support': 139833}, 'weighted avg': {'precision': 0.6636243453253762, 'recall': 0.4402322770733661, 'f1-score': 0.45583824142483886, 'support': 139833}}
[[16583  2432  4104]
 [37321 31080 24292]
 [ 6988  3137 13896]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/AAL
Evaluating performance on  test set...
6677/6677 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0944268
{'0': {'precision': 0.2299497505141654, 'recall': 0.6377334370152632, 'f1-score': 0.3380188687388328, 'support': 245623}, '1': {'precision': 0.8483413436668202, 'recall': 0.2973573074602657, 'f1-score': 0.4403609928524001, 'support': 1213308}, '2': {'precision': 0.24704377600382219, 'recall': 0.5948352306770521, 'f1-score': 0.34910085729757856, 'support': 250350}, 'accuracy': 0.38983935350594784, 'macro avg': {'precision': 0.4417782900616026, 'recall': 0.5099753250508603, 'f1-score': 0.37582690629627047, 'support': 1709281}, 'weighted avg': {'precision': 0.6714096136883286, 'recall': 0.38983935350594784, 'f1-score': 0.41228804610619724, 'support': 1709281}}
[[156642  33761  55220]
 [453863 360786 398659]
 [ 70696  30737 148917]]
Evaluating performance on  train set...
2262/2262 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.092479
{'0': {'precision': 0.32379258600566885, 'recall': 0.6006937540045514, 'f1-score': 0.4207745979338896, 'support': 135783}, '1': {'precision': 0.6929325351502501, 'recall': 0.23057718833238866, 'f1-score': 0.34601570854382535, 'support': 305221}, '2': {'precision': 0.3412819204401748, 'recall': 0.5580401517844834, 'f1-score': 0.4235390647371087, 'support': 137827}, 'accuracy': 0.3953727426485451, 'macro avg': {'precision': 0.4526690138653646, 'recall': 0.4631036980404744, 'f1-score': 0.39677645707160786, 'support': 578831}, 'weighted avg': {'precision': 0.5226066904937887, 'recall': 0.3953727426485451, 'f1-score': 0.3820120492583046, 'support': 578831}}
[[ 81564  16477  37742]
 [124134  70377 110710]
 [ 46204  14710  76913]]
Evaluating performance on  val set...
827/827 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0967107
{'0': {'precision': 0.3054884514062722, 'recall': 0.6108500360647855, 'f1-score': 0.40728973869449264, 'support': 45751}, '1': {'precision': 0.723620171896034, 'recall': 0.23445730582117094, 'f1-score': 0.3541634990623891, 'support': 119220}, '2': {'precision': 0.3257829668643267, 'recall': 0.5695276114437791, 'f1-score': 0.4144760476703685, 'support': 46593}, 'accuracy': 0.38964568641167685, 'macro avg': {'precision': 0.45163053005554427, 'recall': 0.4716116511099118, 'f1-score': 0.3919764284757501, 'support': 211564}, 'weighted avg': {'precision': 0.5455824469609343, 'recall': 0.38964568641167685, 'f1-score': 0.3789348267301395, 'support': 211564}}
[[27947  5659 12145]
 [48496 27952 42772]
 [15040  5017 26536]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/WBA
Evaluating performance on  test set...
5633/5633 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0397428
{'0': {'precision': 0.3140518310154579, 'recall': 0.5636815284911394, 'f1-score': 0.403369005438613, 'support': 297496}, '1': {'precision': 0.7483048013233885, 'recall': 0.39425202130037285, 'f1-score': 0.5164218962747706, 'support': 845619}, '2': {'precision': 0.3267227581433577, 'recall': 0.5056910623539573, 'f1-score': 0.3969678892693554, 'support': 298714}, 'accuracy': 0.4522984348351989, 'macro avg': {'precision': 0.463026463494068, 'recall': 0.48787487071515656, 'f1-score': 0.4389195969942463, 'support': 1441829}, 'weighted avg': {'precision': 0.5713621957153672, 'recall': 0.4522984348351989, 'f1-score': 0.46834728613666887, 'support': 1441829}}
[[167693  56738  73065]
 [274014 333387 238218]
 [ 92259  55398 151057]]
Evaluating performance on  train set...
1454/1454 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0570788
{'0': {'precision': 0.3861965252222846, 'recall': 0.5202976490579426, 'f1-score': 0.44332804302255735, 'support': 107106}, '1': {'precision': 0.5761484425045873, 'recall': 0.33640588052567183, 'f1-score': 0.42478506588110987, 'support': 157741}, '2': {'precision': 0.3869175270647712, 'recall': 0.489547395707066, 'f1-score': 0.4322237269438007, 'support': 107246}, 'accuracy': 0.4334776520923533, 'macro avg': {'precision': 0.4497541649305477, 'recall': 0.44875030843022684, 'f1-score': 0.43344561194915593, 'support': 372093}, 'weighted avg': {'precision': 0.4669304545024028, 'recall': 0.4334776520923533, 'f1-score': 0.43226661150019224, 'support': 372093}}
[[55727 19603 31776]
 [53261 53065 51415]
 [35309 19435 52502]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0593458
{'0': {'precision': 0.3784826249977575, 'recall': 0.5423532738630813, 'f1-score': 0.44583685545224006, 'support': 38899}, '1': {'precision': 0.6000991540916556, 'recall': 0.3051603245883558, 'f1-score': 0.4045833420376444, 'support': 63465}, '2': {'precision': 0.38903595852636225, 'recall': 0.5284422913649304, 'f1-score': 0.44814806971474563, 'support': 40046}, 'accuracy': 0.43273646513587527, 'macro avg': {'precision': 0.4558725792052585, 'recall': 0.4586519632721225, 'f1-score': 0.43285608906821, 'support': 142410}, 'weighted avg': {'precision': 0.4802136257240461, 'recall': 0.43273646513587527, 'f1-score': 0.4281021504280071, 'support': 142410}}
[[21097  6533 11269]
 [22133 19367 21965]
 [12511  6373 21162]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
11876/11876 - 80s - 80s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0703603
{'0': {'precision': 0.4149034596417129, 'recall': 0.5371115430838436, 'f1-score': 0.46816370918731803, 'support': 981029}, '1': {'precision': 0.49928313954375136, 'recall': 0.18423580351832988, 'f1-score': 0.2691537120680582, 'support': 1066074}, '2': {'precision': 0.4156291650475564, 'recall': 0.5762362658111215, 'f1-score': 0.4829296204463094, 'support': 993051}, 'accuracy': 0.4261504515889656, 'macro avg': {'precision': 0.44327192141100696, 'recall': 0.4325278708044317, 'f1-score': 0.4067490139005619, 'support': 3040154}, 'weighted avg': {'precision': 0.44472946363718946, 'recall': 0.4261504515889656, 'f1-score': 0.40320118402337396, 'support': 3040154}}
[[526922 105683 348424]
 [413536 196409 456129]
 [329529  91290 572232]]
Evaluating performance on  train set...
2538/2538 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0680783
{'0': {'precision': 0.3479011245963701, 'recall': 0.5422529100397923, 'f1-score': 0.42386011831223386, 'support': 161338}, '1': {'precision': 0.6584932217201274, 'recall': 0.30086957056875946, 'f1-score': 0.41302534230807414, 'support': 324988}, '2': {'precision': 0.3548206210672616, 'recall': 0.5424867420299085, 'f1-score': 0.42902909447531873, 'support': 163298}, 'accuracy': 0.42155462236616875, 'macro avg': {'precision': 0.453738322461253, 'recall': 0.46186974087948673, 'f1-score': 0.4219715183652089, 'support': 649624}, 'weighted avg': {'precision': 0.5050206959095593, 'recall': 0.42155462236616875, 'f1-score': 0.4197391364603312, 'support': 649624}}
[[ 87486  26278  47574]
 [113703  97779 113506]
 [ 50279  24432  88587]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0684587
{'0': {'precision': 0.3430335886256409, 'recall': 0.533963578465519, 'f1-score': 0.41771501525814286, 'support': 50245}, '1': {'precision': 0.6493880340464308, 'recall': 0.3081496476970096, 'f1-score': 0.41796515735174544, 'support': 101759}, '2': {'precision': 0.3553435412171472, 'recall': 0.5315781286458738, 'f1-score': 0.42595160561536904, 'support': 51428}, 'accuracy': 0.42040583585669905, 'macro avg': {'precision': 0.44925505462973964, 'recall': 0.4578971182694675, 'f1-score': 0.42054392607508584, 'support': 203432}, 'weighted avg': {'precision': 0.49938754598461155, 'recall': 0.42040583585669905, 'f1-score': 0.4199223650270796, 'support': 203432}}
[[26829  8573 14843]
 [35649 31357 34753]
 [15733  8357 27338]]
testing model on single stock: results/universal/W0/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
19053/19053 - 128s - 128s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1019528
{'0': {'precision': 0.33058759751381533, 'recall': 0.5274837683550463, 'f1-score': 0.40644542783794263, 'support': 1247409}, '1': {'precision': 0.6008533619554992, 'recall': 0.23644851426675376, 'f1-score': 0.3393540340971375, 'support': 2395955}, '2': {'precision': 0.3306397192098869, 'recall': 0.5209046076354732, 'f1-score': 0.404516236616315, 'support': 1234082}, 'accuracy': 0.3828534442000998, 'macro avg': {'precision': 0.4206935595597338, 'recall': 0.42827896341909105, 'f1-score': 0.3834385661837983, 'support': 4877446}, 'weighted avg': {'precision': 0.46336383575198464, 'recall': 0.3828534442000998, 'f1-score': 0.37299990318191983, 'support': 4877446}}
[[657988 197988 391433]
 [919479 566520 909956]
 [412892 178351 642839]]
Evaluating performance on  train set...
4812/4812 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0939847
{'0': {'precision': 0.3981947760368081, 'recall': 0.4951304565795973, 'f1-score': 0.44140331889936724, 'support': 406917}, '1': {'precision': 0.3767152168501481, 'recall': 0.1823684061670737, 'f1-score': 0.2457627118644068, 'support': 406611}, '2': {'precision': 0.40740572724695207, 'recall': 0.5152232997640669, 'f1-score': 0.45501478273444174, 'support': 418339}, 'accuracy': 0.39871836813552114, 'macro avg': {'precision': 0.3941052400446361, 'recall': 0.397574054170246, 'f1-score': 0.38072693783273853, 'support': 1231867}, 'weighted avg': {'precision': 0.3942328832982685, 'recall': 0.39871836813552114, 'f1-score': 0.3814492680985981, 'support': 1231867}}
[[201477  63111 142329]
 [161275  74153 171183]
 [143224  59577 215538]]
Evaluating performance on  val set...
1767/1767 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1012455
{'0': {'precision': 0.38862219400182824, 'recall': 0.48031959516142125, 'f1-score': 0.429632588101095, 'support': 147812}, '1': {'precision': 0.37616953117054813, 'recall': 0.19187773152290913, 'f1-score': 0.25412870037186214, 'support': 154218}, '2': {'precision': 0.39286163192625956, 'recall': 0.4992113827089836, 'f1-score': 0.43969718906340216, 'support': 150263}, 'accuracy': 0.3882461147972664, 'macro avg': {'precision': 0.38588445236621194, 'recall': 0.3904695697977713, 'f1-score': 0.3744861591787864, 'support': 452293}, 'weighted avg': {'precision': 0.38578466590460914, 'recall': 0.3882461147972664, 'f1-score': 0.37313487218811897, 'support': 452293}}
[[70997 25568 51247]
 [59947 29591 64680]
 [51745 23505 75013]]
training model: results/universal/W0/deepOF_L1/h30
Epoch 1/50
8838/8838 - 131s - loss: 3.1709 - accuracy30: 0.4378 - val_loss: 3.2699 - val_accuracy30: 0.3578 - 131s/epoch - 15ms/step
Epoch 2/50
8838/8838 - 126s - loss: 3.1579 - accuracy30: 0.4421 - val_loss: 3.2779 - val_accuracy30: 0.3605 - 126s/epoch - 14ms/step
Epoch 3/50
8838/8838 - 126s - loss: 3.1470 - accuracy30: 0.4456 - val_loss: 3.2843 - val_accuracy30: 0.3634 - 126s/epoch - 14ms/step
Epoch 4/50
8838/8838 - 127s - loss: 3.1382 - accuracy30: 0.4480 - val_loss: 3.2987 - val_accuracy30: 0.3641 - 127s/epoch - 14ms/step
Epoch 5/50
8838/8838 - 127s - loss: 3.1298 - accuracy30: 0.4501 - val_loss: 3.2955 - val_accuracy30: 0.3662 - 127s/epoch - 14ms/step
Epoch 6/50
8838/8838 - 125s - loss: 3.1225 - accuracy30: 0.4517 - val_loss: 3.2935 - val_accuracy30: 0.3682 - 125s/epoch - 14ms/step
Epoch 7/50
8838/8838 - 126s - loss: 3.1152 - accuracy30: 0.4533 - val_loss: 3.2964 - val_accuracy30: 0.3688 - 126s/epoch - 14ms/step
Epoch 8/50
8838/8838 - 126s - loss: 3.1086 - accuracy30: 0.4546 - val_loss: 3.2919 - val_accuracy30: 0.3730 - 126s/epoch - 14ms/step
Epoch 9/50
8838/8838 - 125s - loss: 3.1016 - accuracy30: 0.4561 - val_loss: 3.2915 - val_accuracy30: 0.3753 - 125s/epoch - 14ms/step
Epoch 10/50
8838/8838 - 127s - loss: 3.0964 - accuracy30: 0.4571 - val_loss: 3.2820 - val_accuracy30: 0.3786 - 127s/epoch - 14ms/step
Epoch 11/50
8838/8838 - 129s - loss: 3.0911 - accuracy30: 0.4581 - val_loss: 3.2743 - val_accuracy30: 0.3797 - 129s/epoch - 15ms/step
testing model in sample: results/universal/W0/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 224s - 224s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1246709
{'0': {'precision': 0.316793212658874, 'recall': 0.5943081096865163, 'f1-score': 0.4132861422967872, 'support': 2119823}, '1': {'precision': 0.5992883958088194, 'recall': 0.005071359632204924, 'f1-score': 0.010057608737815006, 'support': 4218001}, '2': {'precision': 0.3070509490036617, 'recall': 0.6452457867164335, 'f1-score': 0.4160957897268878, 'support': 2111180}, 'accuracy': 0.31287107924200297, 'macro avg': {'precision': 0.40771085249045175, 'recall': 0.4148750853450516, 'f1-score': 0.27981318025383, 'support': 8449004}, 'weighted avg': {'precision': 0.4553891102153247, 'recall': 0.31287107924200297, 'f1-score': 0.21268419130720326, 'support': 8449004}}
[[1259828    7312  852683]
 [1975028   21391 2221582]
 [ 741959    6991 1362230]]
Evaluating performance on  train set...
8838/8838 - 63s - 63s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1066145
{'0': {'precision': 0.35915917670406466, 'recall': 0.5585411711604773, 'f1-score': 0.4371910453256832, 'support': 682383}, '1': {'precision': 0.4863809333066293, 'recall': 0.0055075520478976734, 'f1-score': 0.010891770736859575, 'support': 881880}, '2': {'precision': 0.36446516111587884, 'recall': 0.6220021983281815, 'f1-score': 0.4596160820888608, 'support': 697803}, 'accuracy': 0.3625141795155402, 'macro avg': {'precision': 0.40333509037552423, 'recall': 0.39535030717885217, 'f1-score': 0.3025662993838012, 'support': 2262066}, 'weighted avg': {'precision': 0.4103941338420027, 'recall': 0.3625141795155402, 'f1-score': 0.2779133998697433, 'support': 2262066}}
[[381139   2561 298683]
 [418859   4857 458164]
 [261200   2568 434035]]
Evaluating performance on  val set...
3279/3279 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1090344
{'0': {'precision': 0.35449328323639917, 'recall': 0.5557420369959454, 'f1-score': 0.4328700830393828, 'support': 247865}, '1': {'precision': 0.5119808306709265, 'recall': 0.005709433480497965, 'f1-score': 0.011292932080912125, 'support': 336811}, '2': {'precision': 0.35986411010933, 'recall': 0.6321568226343244, 'f1-score': 0.45864062928121285, 'support': 254198}, 'accuracy': 0.35805734830260566, 'macro avg': {'precision': 0.40877940800555185, 'recall': 0.3978694310369226, 'f1-score': 0.3009345481338359, 'support': 838874}, 'weighted avg': {'precision': 0.41935259677861875, 'recall': 0.35805734830260566, 'f1-score': 0.27141436921598056, 'support': 838874}}
[[137749    922 109194]
 [158237   1923 176651]
 [ 92594    911 160693]]
testing model out of sample: results/universal/W0/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 151s - 151s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.103488
{'0': {'precision': 0.36017462107234915, 'recall': 0.5491276522987121, 'f1-score': 0.4350189147857283, 'support': 1722421}, '1': {'precision': 0.502827177382581, 'recall': 0.0046673591305768525, 'f1-score': 0.009248868110318775, 'support': 2362578}, '2': {'precision': 0.3601590465745614, 'recall': 0.6562580273110217, 'f1-score': 0.46507928978345064, 'support': 1747939}, 'accuracy': 0.36070244532000856, 'macro avg': {'precision': 0.40772028167649715, 'recall': 0.40335101291343683, 'f1-score': 0.30311569089316587, 'support': 5832938}, 'weighted avg': {'precision': 0.41795006252401995, 'recall': 0.36070244532000856, 'f1-score': 0.27157276748891973, 'support': 5832938}}
[[ 945829    5540  771052]
 [1084723   11027 1266828]
 [ 595477    5363 1147099]]
Evaluating performance on  train set...
6334/6334 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1073209
{'0': {'precision': 0.3547988671249597, 'recall': 0.5668533053621515, 'f1-score': 0.4364312624052166, 'support': 473821}, '1': {'precision': 0.4786648313833448, 'recall': 0.004160087089673653, 'f1-score': 0.008248486393851884, 'support': 668736}, '2': {'precision': 0.3497659859125384, 'recall': 0.6274326570290696, 'f1-score': 0.44915044339170146, 'support': 478335}, 'accuracy': 0.3525787035780299, 'macro avg': {'precision': 0.39440989480694766, 'recall': 0.3994820164936315, 'f1-score': 0.2979433973969233, 'support': 1620892}, 'weighted avg': {'precision': 0.4044173649888223, 'recall': 0.3525787035780299, 'f1-score': 0.26352818961470015, 'support': 1620892}}
[[268587   1573 203661]
 [311670   2782 354284]
 [176755   1457 300123]]
Evaluating performance on  val set...
2156/2156 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1120281
{'0': {'precision': 0.3425063891931362, 'recall': 0.577374312420664, 'f1-score': 0.4299566033141891, 'support': 155982}, '1': {'precision': 0.5093503937007874, 'recall': 0.004370850858967212, 'f1-score': 0.008667325439228232, 'support': 236796}, '2': {'precision': 0.34508335836063053, 'recall': 0.6232403249407135, 'f1-score': 0.4442106872013414, 'support': 158552}, 'accuracy': 0.34445976094172276, 'macro avg': {'precision': 0.3989800470848514, 'recall': 0.4016618294067815, 'f1-score': 0.2942782053182529, 'support': 551330}, 'weighted avg': {'precision': 0.41490690523042484, 'recall': 0.34445976094172276, 'f1-score': 0.2531122408902262, 'support': 551330}}
[[ 90060    476  65446]
 [113669   1035 122092]
 [ 59215    521  98816]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
876/876 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1157084
{'0': {'precision': 0.3128331226990494, 'recall': 0.3863825310914675, 'f1-score': 0.34573955289027214, 'support': 58939}, '1': {'precision': 0.5768815268275117, 'recall': 0.015270959439492875, 'f1-score': 0.029754276480748874, 'support': 104905}, '2': {'precision': 0.2657006131500838, 'recall': 0.6546114814446323, 'f1-score': 0.37798193246937284, 'support': 60306}, 'accuracy': 0.28486281507918804, 'macro avg': {'precision': 0.385138420892215, 'recall': 0.3520883239918642, 'f1-score': 0.25115858728013124, 'support': 224150}, 'weighted avg': {'precision': 0.42373040003224777, 'recall': 0.28486281507918804, 'f1-score': 0.20652908454834135, 'support': 224150}}
[[22773   589 35577]
 [29780  1602 73523]
 [20243   586 39477]]
Evaluating performance on  train set...
318/318 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1025299
{'0': {'precision': 0.3684491978609626, 'recall': 0.37386051222688466, 'f1-score': 0.3711351312529177, 'support': 27644}, '1': {'precision': 0.43383356070941337, 'recall': 0.011930667066856757, 'f1-score': 0.023222696899989046, 'support': 26654}, '2': {'precision': 0.3270470233782083, 'recall': 0.636944330968916, 'f1-score': 0.43218385011780414, 'support': 26927}, 'accuracy': 0.3423084025854109, 'macro avg': {'precision': 0.3764432606495281, 'recall': 0.34091183675421916, 'f1-score': 0.27551389275690363, 'support': 81225}, 'weighted avg': {'precision': 0.37617980364816456, 'recall': 0.3423084025854109, 'f1-score': 0.27720593245491015, 'support': 81225}}
[[10335   219 17090]
 [ 8135   318 18201]
 [ 9580   196 17151]]
Evaluating performance on  val set...
104/104 - 1s - 733ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1070008
{'0': {'precision': 0.34117898791055956, 'recall': 0.3966417910447761, 'f1-score': 0.36682578938287225, 'support': 8040}, '1': {'precision': 0.44528301886792454, 'recall': 0.011735454997513675, 'f1-score': 0.022868217054263566, 'support': 10055}, '2': {'precision': 0.3150879687222321, 'recall': 0.6333650869254585, 'f1-score': 0.4208236085288184, 'support': 8398}, 'accuracy': 0.3255954403049862, 'macro avg': {'precision': 0.3671833251669054, 'recall': 0.34724744432258275, 'f1-score': 0.27017253832198473, 'support': 26493}, 'weighted avg': {'precision': 0.37241945339701754, 'recall': 0.3255954403049862, 'f1-score': 0.2533988575678077, 'support': 26493}}
[[3189   70 4781]
 [3156  118 6781]
 [3002   77 5319]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
2359/2359 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1472003
{'0': {'precision': 0.26803855691544676, 'recall': 0.6616913785442756, 'f1-score': 0.3815275715322684, 'support': 121534}, '1': {'precision': 0.6759343664539653, 'recall': 0.004162736908290668, 'f1-score': 0.008274515274096806, 'support': 356256}, '2': {'precision': 0.2569993202128894, 'recall': 0.6151294119514576, 'f1-score': 0.36253327033993044, 'support': 125993}, 'accuracy': 0.2640071018892549, 'macro avg': {'precision': 0.4003240811941005, 'recall': 0.4269945091346747, 'f1-score': 0.25077845238209856, 'support': 603783}, 'weighted avg': {'precision': 0.5064097316141202, 'recall': 0.2640071018892549, 'f1-score': 0.15732982200895057, 'support': 603783}}
[[ 80418    380  40736]
 [171446   1483 183327]
 [ 48160    331  77502]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1423596
{'0': {'precision': 0.2840404600948441, 'recall': 0.6436042524005487, 'f1-score': 0.3941372068603431, 'support': 34992}, '1': {'precision': 0.7008443908323281, 'recall': 0.007136364752990886, 'f1-score': 0.014128862030811134, 'support': 81414}, '2': {'precision': 0.2719055916811878, 'recall': 0.5595953116799813, 'f1-score': 0.3659817895790628, 'support': 34298}, 'accuracy': 0.2806494850833422, 'macro avg': {'precision': 0.41893014753611996, 'recall': 0.40344530961117364, 'f1-score': 0.25808261949007233, 'support': 150704}, 'weighted avg': {'precision': 0.5064464579463274, 'recall': 0.2806494850833422, 'f1-score': 0.18243961497250422, 'support': 150704}}
[[22521   145 12326]
 [41765   581 39068]
 [15002   103 19193]]
Evaluating performance on  val set...
230/230 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.135898
{'0': {'precision': 0.3060459251393682, 'recall': 0.6579867303988014, 'f1-score': 0.4177745566552669, 'support': 14017}, '1': {'precision': 0.6719367588932806, 'recall': 0.005556100271268425, 'f1-score': 0.011021069692058346, 'support': 30597}, '2': {'precision': 0.29229686950404504, 'recall': 0.5850052798310454, 'f1-score': 0.38982056995426295, 'support': 14205}, 'accuracy': 0.3009741750114759, 'macro avg': {'precision': 0.4234265178455647, 'recall': 0.4161827035003718, 'f1-score': 0.2728720654338627, 'support': 58819}, 'weighted avg': {'precision': 0.493057885646495, 'recall': 0.3009741750114759, 'f1-score': 0.19943485652943932, 'support': 58819}}
[[ 9223    39  4755]
 [15062   170 15365]
 [ 5851    44  8310]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
1625/1625 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0927454
{'0': {'precision': 0.38884213216534547, 'recall': 0.6432882823776407, 'f1-score': 0.48470151405714035, 'support': 137178}, '1': {'precision': 0.4727463312368973, 'recall': 0.00324276130832117, 'f1-score': 0.0064413388272764275, 'support': 139079}, '2': {'precision': 0.4115903782409058, 'recall': 0.5541840689452607, 'f1-score': 0.4723604589391155, 'support': 139589}, 'accuracy': 0.399316092976727, 'macro avg': {'precision': 0.42439294721438287, 'recall': 0.4002383708770742, 'f1-score': 0.3211677706078441, 'support': 415846}, 'weighted avg': {'precision': 0.42453976307706215, 'recall': 0.399316092976727, 'f1-score': 0.3206056168892844, 'support': 415846}}
[[88245   220 48713]
 [76750   451 61878]
 [61948   283 77358]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0920941
{'0': {'precision': 0.38791432219017447, 'recall': 0.638957397647914, 'f1-score': 0.48274915167801025, 'support': 38519}, '1': {'precision': 0.4358974358974359, 'recall': 0.0027045659436813916, 'f1-score': 0.005375777379572046, 'support': 37714}, '2': {'precision': 0.4083682654973245, 'recall': 0.539079433890093, 'f1-score': 0.4647073047415972, 'support': 39215}, 'accuracy': 0.3971831473910332, 'macro avg': {'precision': 0.41072667452831163, 'recall': 0.3935804658272295, 'f1-score': 0.3176107445997265, 'support': 115448}, 'weighted avg': {'precision': 0.4105369448180723, 'recall': 0.3971831473910332, 'f1-score': 0.3206747072016855, 'support': 115448}}
[[24612    64 13843]
 [20828   102 16784]
 [18007    68 21140]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0935998
{'0': {'precision': 0.39023250379717256, 'recall': 0.6550732217573222, 'f1-score': 0.4891025797476387, 'support': 15296}, '1': {'precision': 0.4157303370786517, 'recall': 0.002537896975101173, 'f1-score': 0.005044995909462776, 'support': 14579}, '2': {'precision': 0.4110141034251175, 'recall': 0.5217733473242392, 'f1-score': 0.45981794538361503, 'support': 15248}, 'accuracy': 0.39919774837665933, 'macro avg': {'precision': 0.40565898143364726, 'recall': 0.39312815535222084, 'f1-score': 0.3179885070135722, 'support': 45123}, 'weighted avg': {'precision': 0.40549325203061426, 'recall': 0.39919774837665933, 'f1-score': 0.3228102760541919, 'support': 45123}}
[[10020    31  5245]
 [ 8386    37  6156]
 [ 7271    21  7956]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1269/1269 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0886986
{'0': {'precision': 0.38836593659308005, 'recall': 0.6051339446891473, 'f1-score': 0.4731020418244109, 'support': 110792}, '1': {'precision': 0.3647435897435897, 'recall': 0.00544873022560999, 'f1-score': 0.010737064573347926, 'support': 104428}, '2': {'precision': 0.3877118644067797, 'recall': 0.5329334757483636, 'f1-score': 0.44886911924707906, 'support': 109539}, 'accuracy': 0.38794921772760727, 'macro avg': {'precision': 0.38027379691448315, 'recall': 0.3811720502210403, 'f1-score': 0.31090274188161265, 'support': 324759}, 'weighted avg': {'precision': 0.3805494300451053, 'recall': 0.38794921772760727, 'f1-score': 0.3162525012402474, 'support': 324759}}
[[67044   454 43294]
 [54962   569 48897]
 [50625   537 58377]]
Evaluating performance on  train set...
486/486 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0955489
{'0': {'precision': 0.3692251438745986, 'recall': 0.5622261492652932, 'f1-score': 0.4457302971855178, 'support': 41309}, '1': {'precision': 0.35733695652173914, 'recall': 0.00639063031540069, 'f1-score': 0.012556696108856529, 'support': 41154}, '2': {'precision': 0.37064471426686024, 'recall': 0.5376037902897753, 'f1-score': 0.43877859911920086, 'support': 41791}, 'accuracy': 0.36984724837832184, 'macro avg': {'precision': 0.36573560488773266, 'recall': 0.36874018995682306, 'f1-score': 0.2990218641378584, 'support': 124254}, 'weighted avg': {'precision': 0.3657651249129831, 'recall': 0.36984724837832184, 'f1-score': 0.29992135105421924, 'support': 124254}}
[[23225   204 17880]
 [20622   263 20269]
 [19055   269 22467]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0946742
{'0': {'precision': 0.3762655205348615, 'recall': 0.5264248012293713, 'f1-score': 0.43885593338346285, 'support': 14967}, '1': {'precision': 0.3717948717948718, 'recall': 0.0076856821042867556, 'f1-score': 0.015060045439792275, 'support': 15093}, '2': {'precision': 0.37243993901182676, 'recall': 0.5846432498867974, 'f1-score': 0.45501686552887277, 'support': 15459}, 'accuracy': 0.37419539093565324, 'macro avg': {'precision': 0.3735001104471867, 'recall': 0.3729179110734851, 'f1-score': 0.3029776147840426, 'support': 45519}, 'weighted avg': {'precision': 0.373483931172238, 'recall': 0.37419539093565324, 'f1-score': 0.303823979986026, 'support': 45519}}
[[7879   79 7009]
 [6757  116 8220]
 [6304  117 9038]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
1733/1733 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1079401
{'0': {'precision': 0.36923034566303703, 'recall': 0.5689296774467243, 'f1-score': 0.44782573609414433, 'support': 141434}, '1': {'precision': 0.379192334017796, 'recall': 0.0035272470282625445, 'f1-score': 0.006989477933940602, 'support': 157063}, '2': {'precision': 0.37492470450702087, 'recall': 0.5794565892007448, 'f1-score': 0.4552742010202451, 'support': 145010}, 'accuracy': 0.3721406877456275, 'macro avg': {'precision': 0.37444912806261793, 'recall': 0.3839711712252439, 'f1-score': 0.30336313834944334, 'support': 443507}, 'weighted avg': {'precision': 0.37462011122013, 'recall': 0.3721406877456275, 'f1-score': 0.29414391525144684, 'support': 443507}}
[[80466   447 60521]
 [76940   554 79569]
 [60523   460 84027]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1034349
{'0': {'precision': 0.3752057717711615, 'recall': 0.5697620590686048, 'f1-score': 0.4524556416037644, 'support': 64806}, '1': {'precision': 0.37829457364341085, 'recall': 0.0037835910000155065, 'f1-score': 0.007492246752847975, 'support': 64489}, '2': {'precision': 0.38770952031351785, 'recall': 0.5640975492334772, 'f1-score': 0.4595594994423267, 'support': 66469}, 'accuracy': 0.3813929016570973, 'macro avg': {'precision': 0.38040328857603006, 'recall': 0.3792143997673658, 'f1-score': 0.30650246259964636, 'support': 195764}, 'weighted avg': {'precision': 0.3804687690832382, 'recall': 0.3813929016570973, 'f1-score': 0.30828685651626436, 'support': 195764}}
[[36924   201 27681]
 [32712   244 31533]
 [28774   200 37495]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1094499
{'0': {'precision': 0.36300290838584587, 'recall': 0.5660163446549199, 'f1-score': 0.4423279251342821, 'support': 21169}, '1': {'precision': 0.43575418994413406, 'recall': 0.0035430388371564844, 'f1-score': 0.007028926736955934, 'support': 22015}, '2': {'precision': 0.37268085376296345, 'recall': 0.5456951797157983, 'f1-score': 0.44289079430886646, 'support': 21534}, 'accuracy': 0.3679192805710931, 'macro avg': {'precision': 0.3904793173643144, 'recall': 0.3717515210692916, 'f1-score': 0.29741588206003483, 'support': 64718}, 'weighted avg': {'precision': 0.3909707741922145, 'recall': 0.3679192805710931, 'f1-score': 0.2944403726000314, 'support': 64718}}
[[11982    52  9135]
 [11292    78 10645]
 [ 9734    49 11751]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/EXC
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1580337
{'0': {'precision': 0.25884354939751286, 'recall': 0.7387413773507374, 'f1-score': 0.3833627294742155, 'support': 228758}, '1': {'precision': 0.8390675466928802, 'recall': 0.008045556025347204, 'f1-score': 0.015938284827152968, 'support': 742646}, '2': {'precision': 0.2750831964433867, 'recall': 0.6478808266930104, 'f1-score': 0.38619301349465346, 'support': 229783}, 'accuracy': 0.2695999873458504, 'macro avg': {'precision': 0.45766476417792656, 'recall': 0.46488925335636494, 'f1-score': 0.26183134259867397, 'support': 1201187}, 'weighted avg': {'precision': 0.6206794879421004, 'recall': 0.2695999873458504, 'f1-score': 0.1567402777108397, 'support': 1201187}}
[[168993    591  59174]
 [403528   5975 333143]
 [ 80356    555 148872]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1536992
{'0': {'precision': 0.27234150086061804, 'recall': 0.7139785752678092, 'f1-score': 0.39428579317580953, 'support': 80001}, '1': {'precision': 0.8302411873840445, 'recall': 0.008071680126982408, 'f1-score': 0.015987924204734747, 'support': 221763}, '2': {'precision': 0.29378310045019534, 'recall': 0.6182173400176939, 'f1-score': 0.39829324382626874, 'support': 81384}, 'accuracy': 0.2850647791453955, 'macro avg': {'precision': 0.465455262898286, 'recall': 0.44675586513749516, 'f1-score': 0.26952232040227103, 'support': 383148}, 'weighted avg': {'precision': 0.599803764329285, 'recall': 0.2850647791453955, 'f1-score': 0.17618122796107402, 'support': 383148}}
[[ 57119    194  22688]
 [121715   1790  98258]
 [ 30899    172  50313]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1585116
{'0': {'precision': 0.26476541415818977, 'recall': 0.7381443298969073, 'f1-score': 0.38973614599348727, 'support': 27645}, '1': {'precision': 0.8524590163934426, 'recall': 0.008708863182323879, 'f1-score': 0.01724158347839473, 'support': 83593}, '2': {'precision': 0.29586314956305426, 'recall': 0.640531561461794, 'f1-score': 0.40476453559037373, 'support': 28595}, 'accuracy': 0.28212224582180173, 'macro avg': {'precision': 0.4710291933715622, 'recall': 0.4624615848470084, 'f1-score': 0.2705807550207519, 'support': 139833}, 'weighted avg': {'precision': 0.622451447037078, 'recall': 0.28212224582180173, 'f1-score': 0.1701298930789309, 'support': 139833}}
[[20406    66  7173]
 [46447   728 36418]
 [10219    60 18316]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/AAL
Evaluating performance on  test set...
6677/6677 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1596597
{'0': {'precision': 0.23127265708408984, 'recall': 0.6450234511160309, 'f1-score': 0.3404700443724587, 'support': 297214}, '1': {'precision': 0.7451283637488401, 'recall': 0.0043201114728639075, 'f1-score': 0.008590417352001176, 'support': 1115249}, '2': {'precision': 0.23411337941136082, 'recall': 0.6892674972542097, 'f1-score': 0.34951285472427557, 'support': 296818}, 'accuracy': 0.2346688461405702, 'macro avg': {'precision': 0.40350480008143025, 'recall': 0.44620368661436816, 'f1-score': 0.23285777214957848, 'support': 1709281}, 'weighted avg': {'precision': 0.5670397079796956, 'recall': 0.2346688461405702, 'f1-score': 0.12549991759287557, 'support': 1709281}}
[[191710    816 104688]
 [545826   4818 564605]
 [ 91399    832 204587]]
Evaluating performance on  train set...
2262/2262 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.116104
{'0': {'precision': 0.3350730280992088, 'recall': 0.6024632052330335, 'f1-score': 0.430637586727274, 'support': 156544}, '1': {'precision': 0.5423327412670219, 'recall': 0.003464277475010684, 'f1-score': 0.006884578094114287, 'support': 264413}, '2': {'precision': 0.3372351399340492, 'recall': 0.6315922824530955, 'f1-score': 0.43969670311256337, 'support': 157874}, 'accuracy': 0.33678223868452106, 'macro avg': {'precision': 0.4048803031000933, 'recall': 0.4125065883870465, 'f1-score': 0.29240628931131724, 'support': 578831}, 'weighted avg': {'precision': 0.43034004693830785, 'recall': 0.33678223868452106, 'f1-score': 0.23953585697971647, 'support': 578831}}
[[ 94312    425  61807]
 [129341    916 134156]
 [ 57814    348  99712]]
Evaluating performance on  val set...
827/827 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1246126
{'0': {'precision': 0.31679529931889244, 'recall': 0.6263775262430423, 'f1-score': 0.4207785689638947, 'support': 53538}, '1': {'precision': 0.5771929824561404, 'recall': 0.0031602101683844506, 'f1-score': 0.006286003611108458, 'support': 104107}, '2': {'precision': 0.3266595014124428, 'recall': 0.6369554331497246, 'f1-score': 0.4318479026254904, 'support': 53919}, 'accuracy': 0.32239889584239284, 'macro avg': {'precision': 0.40688259439582525, 'recall': 0.4221643898537171, 'f1-score': 0.2863041584001645, 'support': 211564}, 'weighted avg': {'precision': 0.44744649475408754, 'recall': 0.32239889584239284, 'f1-score': 0.2196350374581426, 'support': 211564}}
[[33535   123 19880]
 [52865   329 50913]
 [19457   118 34344]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/WBA
Evaluating performance on  test set...
5633/5633 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1255838
{'0': {'precision': 0.3040188273114203, 'recall': 0.6020314726128588, 'f1-score': 0.40401488156590193, 'support': 341821}, '1': {'precision': 0.6284929736714586, 'recall': 0.005153744776386286, 'f1-score': 0.010223653924979243, 'support': 754985}, '2': {'precision': 0.288204663202192, 'recall': 0.6337983264883791, 'f1-score': 0.3962321928804137, 'support': 345023}, 'accuracy': 0.29709001552888725, 'macro avg': {'precision': 0.4069054880616903, 'recall': 0.4136611812925414, 'f1-score': 0.2701569094570983, 'support': 1441829}, 'weighted avg': {'precision': 0.47013898653014546, 'recall': 0.2970900155288873, 'f1-score': 0.1959515976405438, 'support': 1441829}}
[[205787   1176 134858]
 [345878   3891 405216]
 [125224   1124 218675]]
Evaluating performance on  train set...
1454/1454 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0920073
{'0': {'precision': 0.38803157026740487, 'recall': 0.546617658040374, 'f1-score': 0.453870611051212, 'support': 120523}, '1': {'precision': 0.4625943719972546, 'recall': 0.005165740563326308, 'f1-score': 0.010217384713337174, 'support': 130475}, '2': {'precision': 0.36941390847174094, 'recall': 0.6127338040381519, 'f1-score': 0.4609334960910201, 'support': 121095}, 'accuracy': 0.37827371114210695, 'macro avg': {'precision': 0.40667995024546677, 'recall': 0.3881724008806174, 'f1-score': 0.30834049728518975, 'support': 372093}, 'weighted avg': {'precision': 0.408118150236811, 'recall': 0.37827371114210695, 'f1-score': 0.30060146962006806, 'support': 372093}}
[[65880   382 54261]
 [57405   674 72396]
 [46495   401 74199]]
Evaluating performance on  val set...
557/557 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0921044
{'0': {'precision': 0.3869484577858824, 'recall': 0.5643910977744436, 'f1-score': 0.4591215903837263, 'support': 43989}, '1': {'precision': 0.4762773722627737, 'recall': 0.004953313595991801, 'f1-score': 0.009804658151765589, 'support': 52692}, '2': {'precision': 0.37780723542811545, 'recall': 0.6419558704541976, 'f1-score': 0.47567042048124447, 'support': 45729}, 'accuracy': 0.3823046134400674, 'macro avg': {'precision': 0.4136776884922572, 'recall': 0.403766760608211, 'f1-score': 0.3148655563389121, 'support': 142410}, 'weighted avg': {'precision': 0.4170650240692757, 'recall': 0.3823046134400674, 'f1-score': 0.2981873417941816, 'support': 142410}}
[[24827   157 19005]
 [23091   261 29340]
 [16243   130 29356]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
11876/11876 - 77s - 77s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0718573
{'0': {'precision': 0.43974433414423914, 'recall': 0.5173639459535, 'f1-score': 0.47540674060478316, 'support': 1087656}, '1': {'precision': 0.3483754512635379, 'recall': 0.004333071009427118, 'f1-score': 0.008559677313937314, 'support': 846282}, '2': {'precision': 0.4235603766652248, 'recall': 0.6700553960528505, 'f1-score': 0.5190285711284729, 'support': 1106216}, 'accuracy': 0.4301120930058148, 'macro avg': {'precision': 0.4038933873576673, 'recall': 0.39725080433859256, 'f1-score': 0.33433166301573114, 'support': 3040154}, 'weighted avg': {'precision': 0.4084213177284093, 'recall': 0.4301120930058148, 'f1-score': 0.3613240002102802, 'support': 3040154}}
[[562714   3640 521302]
 [355154   3667 487461]
 [361771   3219 741226]]
Evaluating performance on  train set...
2538/2538 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1039299
{'0': {'precision': 0.3584997564539698, 'recall': 0.5491122227708956, 'f1-score': 0.4337902157205703, 'support': 186308}, '1': {'precision': 0.48508575689783745, 'recall': 0.0047229059121633886, 'f1-score': 0.009354732013172844, 'support': 275466}, '2': {'precision': 0.34496854041346886, 'recall': 0.6639978706414693, 'f1-score': 0.45404559312008014, 'support': 187850}, 'accuracy': 0.3514910163417608, 'macro avg': {'precision': 0.3961846845884254, 'recall': 0.40594433310817607, 'f1-score': 0.2990635136179411, 'support': 649624}, 'weighted avg': {'precision': 0.40826438994205266, 'recall': 0.35149101634176083, 'f1-score': 0.2596701519445337, 'support': 649624}}
[[102304    705  83299]
 [120621   1301 153544]
 [ 62442    676 124732]]
Evaluating performance on  val set...
795/795 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1047294
{'0': {'precision': 0.35156715662569304, 'recall': 0.5395502166071213, 'f1-score': 0.4257309782238625, 'support': 57939}, '1': {'precision': 0.5165631469979296, 'recall': 0.005799628079962808, 'f1-score': 0.011470473300691907, 'support': 86040}, '2': {'precision': 0.34733634530194546, 'recall': 0.6633643382167427, 'f1-score': 0.4559421965317919, 'support': 59453}, 'accuracy': 0.349989185575524, 'macro avg': {'precision': 0.405155549641856, 'recall': 0.40290472763460894, 'f1-score': 0.29771454935211544, 'support': 203432}, 'weighted avg': {'precision': 0.42011448736027, 'recall': 0.349989185575524, 'f1-score': 0.25935191159949533, 'support': 203432}}
[[31261   240 26438]
 [37871   499 47670]
 [19787   227 39439]]
testing model on single stock: results/universal/W0/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
19053/19053 - 125s - 125s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1158206
{'0': {'precision': 0.3391152599268848, 'recall': 0.5599870303238319, 'f1-score': 0.42242167415900256, 'support': 1316918}, '1': {'precision': 0.5117258288028995, 'recall': 0.004248820411331486, 'f1-score': 0.008427666551968709, 'support': 2259686}, '2': {'precision': 0.32000861389982393, 'recall': 0.6602754216115408, 'f1-score': 0.43108693971907786, 'support': 1300842}, 'accuracy': 0.3292649472695341, 'macro avg': {'precision': 0.39028323420986943, 'recall': 0.4081704241155681, 'f1-score': 0.287312093476683, 'support': 4877446}, 'weighted avg': {'precision': 0.4139886584863014, 'recall': 0.3292649472695341, 'f1-score': 0.23293227300688146, 'support': 4877446}}
[[ 737457    4737  574724]
 [ 999689    9601 1250396]
 [ 437504    4424  858914]]
Evaluating performance on  train set...
4812/4812 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0930368
{'0': {'precision': 0.3937790512339593, 'recall': 0.5238930066722886, 'f1-score': 0.4496117961490686, 'support': 405558}, '1': {'precision': 0.3461065573770492, 'recall': 0.004149122763920074, 'f1-score': 0.008199944654014768, 'support': 407074}, '2': {'precision': 0.38989966876290144, 'recall': 0.6393216215249203, 'f1-score': 0.4843881307504216, 'support': 419235}, 'accuracy': 0.39142537303134184, 'macro avg': {'precision': 0.37659509245796996, 'recall': 0.3891212503203763, 'f1-score': 0.3140666238511683, 'support': 1231867}, 'weighted avg': {'precision': 0.37670528785320334, 'recall': 0.39142537303134184, 'f1-score': 0.31558123002553473, 'support': 1231867}}
[[212469   1590 191499]
 [177487   1689 227898]
 [149608   1601 268026]]
Evaluating performance on  val set...
1767/1767 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0971301
{'0': {'precision': 0.38445875435872634, 'recall': 0.5129136756606246, 'f1-score': 0.43949233616144684, 'support': 147247}, '1': {'precision': 0.34697309417040356, 'recall': 0.003997778294453486, 'f1-score': 0.007904482186183118, 'support': 154836}, '2': {'precision': 0.3765429183197934, 'recall': 0.6368816989547966, 'f1-score': 0.47327307717043393, 'support': 150210}, 'accuracy': 0.3798643799483963, 'macro avg': {'precision': 0.3693249222829744, 'recall': 0.3845977176366249, 'f1-score': 0.30688996517268796, 'support': 452293}, 'weighted avg': {'precision': 0.368997167705103, 'recall': 0.3798643799483963, 'f1-score': 0.3029632900538264, 'support': 452293}}
[[75525   588 71134]
 [66953   619 87264]
 [53967   577 95666]]
training model: results/universal/W0/deepLOB_L2/h10
Epoch 1/50
8838/8838 - 377s - loss: 2.9444 - accuracy10: 0.4994 - val_loss: 3.3105 - val_accuracy10: 0.4505 - 377s/epoch - 43ms/step
Epoch 2/50
8838/8838 - 376s - loss: 2.8552 - accuracy10: 0.5207 - val_loss: 3.3781 - val_accuracy10: 0.4812 - 376s/epoch - 43ms/step
Epoch 3/50
8838/8838 - 375s - loss: 2.7832 - accuracy10: 0.5383 - val_loss: 3.2100 - val_accuracy10: 0.4982 - 375s/epoch - 42ms/step
Epoch 4/50
8838/8838 - 374s - loss: 2.7425 - accuracy10: 0.5466 - val_loss: 3.2153 - val_accuracy10: 0.5032 - 374s/epoch - 42ms/step
Epoch 5/50
8838/8838 - 373s - loss: 2.7192 - accuracy10: 0.5517 - val_loss: 3.2372 - val_accuracy10: 0.5043 - 373s/epoch - 42ms/step
Epoch 6/50
8838/8838 - 375s - loss: 2.7035 - accuracy10: 0.5548 - val_loss: 3.2514 - val_accuracy10: 0.5062 - 375s/epoch - 42ms/step
Epoch 7/50
8838/8838 - 373s - loss: 2.6920 - accuracy10: 0.5575 - val_loss: 3.2100 - val_accuracy10: 0.5099 - 373s/epoch - 42ms/step
Epoch 8/50
8838/8838 - 375s - loss: 2.6827 - accuracy10: 0.5595 - val_loss: 3.1717 - val_accuracy10: 0.5160 - 375s/epoch - 42ms/step
Epoch 9/50
8838/8838 - 376s - loss: 2.6752 - accuracy10: 0.5612 - val_loss: 3.1537 - val_accuracy10: 0.5165 - 376s/epoch - 43ms/step
Epoch 10/50
8838/8838 - 376s - loss: 2.6692 - accuracy10: 0.5623 - val_loss: 3.1556 - val_accuracy10: 0.5183 - 376s/epoch - 43ms/step
Epoch 11/50
8838/8838 - 371s - loss: 2.6633 - accuracy10: 0.5639 - val_loss: 3.1104 - val_accuracy10: 0.5232 - 371s/epoch - 42ms/step
Epoch 12/50
8838/8838 - 375s - loss: 2.6586 - accuracy10: 0.5650 - val_loss: 3.0985 - val_accuracy10: 0.5257 - 375s/epoch - 42ms/step
Epoch 13/50
8838/8838 - 373s - loss: 2.6546 - accuracy10: 0.5659 - val_loss: 3.0884 - val_accuracy10: 0.5269 - 373s/epoch - 42ms/step
Epoch 14/50
8838/8838 - 379s - loss: 2.6509 - accuracy10: 0.5668 - val_loss: 3.1068 - val_accuracy10: 0.5263 - 379s/epoch - 43ms/step
Epoch 15/50
8838/8838 - 380s - loss: 2.6471 - accuracy10: 0.5675 - val_loss: 3.0730 - val_accuracy10: 0.5297 - 380s/epoch - 43ms/step
Epoch 16/50
8838/8838 - 376s - loss: 2.6445 - accuracy10: 0.5681 - val_loss: 3.0777 - val_accuracy10: 0.5287 - 376s/epoch - 43ms/step
Epoch 17/50
8838/8838 - 379s - loss: 2.6414 - accuracy10: 0.5686 - val_loss: 3.0760 - val_accuracy10: 0.5301 - 379s/epoch - 43ms/step
Epoch 18/50
8838/8838 - 378s - loss: 2.6388 - accuracy10: 0.5692 - val_loss: 3.0526 - val_accuracy10: 0.5312 - 378s/epoch - 43ms/step
Epoch 19/50
8838/8838 - 377s - loss: 2.6360 - accuracy10: 0.5700 - val_loss: 3.0631 - val_accuracy10: 0.5309 - 377s/epoch - 43ms/step
Epoch 20/50
8838/8838 - 378s - loss: 2.6336 - accuracy10: 0.5704 - val_loss: 3.0487 - val_accuracy10: 0.5323 - 378s/epoch - 43ms/step
Epoch 21/50
8838/8838 - 375s - loss: 2.6314 - accuracy10: 0.5710 - val_loss: 3.0666 - val_accuracy10: 0.5317 - 375s/epoch - 42ms/step
Epoch 22/50
8838/8838 - 372s - loss: 2.6295 - accuracy10: 0.5715 - val_loss: 3.0495 - val_accuracy10: 0.5340 - 372s/epoch - 42ms/step
Epoch 23/50
8838/8838 - 372s - loss: 2.6273 - accuracy10: 0.5718 - val_loss: 3.0688 - val_accuracy10: 0.5317 - 372s/epoch - 42ms/step
Epoch 24/50
8838/8838 - 370s - loss: 2.6254 - accuracy10: 0.5722 - val_loss: 3.0456 - val_accuracy10: 0.5342 - 370s/epoch - 42ms/step
Epoch 25/50
8838/8838 - 375s - loss: 2.6239 - accuracy10: 0.5726 - val_loss: 3.0505 - val_accuracy10: 0.5343 - 375s/epoch - 42ms/step
Epoch 26/50
8838/8838 - 386s - loss: 2.6222 - accuracy10: 0.5732 - val_loss: 3.0395 - val_accuracy10: 0.5344 - 386s/epoch - 44ms/step
Epoch 27/50
8838/8838 - 378s - loss: 2.6203 - accuracy10: 0.5735 - val_loss: 3.0238 - val_accuracy10: 0.5357 - 378s/epoch - 43ms/step
Epoch 28/50
8838/8838 - 379s - loss: 2.6183 - accuracy10: 0.5739 - val_loss: 3.0531 - val_accuracy10: 0.5359 - 379s/epoch - 43ms/step
Epoch 29/50
8838/8838 - 375s - loss: 2.6169 - accuracy10: 0.5742 - val_loss: 3.0536 - val_accuracy10: 0.5353 - 375s/epoch - 42ms/step
Epoch 30/50
8838/8838 - 376s - loss: 2.6155 - accuracy10: 0.5746 - val_loss: 3.0331 - val_accuracy10: 0.5367 - 376s/epoch - 43ms/step
Epoch 31/50
8838/8838 - 380s - loss: 2.6137 - accuracy10: 0.5749 - val_loss: 3.0246 - val_accuracy10: 0.5375 - 380s/epoch - 43ms/step
Epoch 32/50
8838/8838 - 380s - loss: 2.6119 - accuracy10: 0.5753 - val_loss: 3.0408 - val_accuracy10: 0.5369 - 380s/epoch - 43ms/step
Epoch 33/50
8838/8838 - 379s - loss: 2.6109 - accuracy10: 0.5755 - val_loss: 3.0106 - val_accuracy10: 0.5387 - 379s/epoch - 43ms/step
Epoch 34/50
8838/8838 - 377s - loss: 2.6094 - accuracy10: 0.5758 - val_loss: 3.0137 - val_accuracy10: 0.5380 - 377s/epoch - 43ms/step
Epoch 35/50
8838/8838 - 376s - loss: 2.6080 - accuracy10: 0.5762 - val_loss: 3.0193 - val_accuracy10: 0.5389 - 376s/epoch - 43ms/step
Epoch 36/50
8838/8838 - 376s - loss: 2.6067 - accuracy10: 0.5765 - val_loss: 3.0201 - val_accuracy10: 0.5385 - 376s/epoch - 43ms/step
Epoch 37/50
8838/8838 - 381s - loss: 2.6054 - accuracy10: 0.5766 - val_loss: 3.0431 - val_accuracy10: 0.5384 - 381s/epoch - 43ms/step
Epoch 38/50
8838/8838 - 378s - loss: 2.6042 - accuracy10: 0.5771 - val_loss: 3.0290 - val_accuracy10: 0.5388 - 378s/epoch - 43ms/step
Epoch 39/50
8838/8838 - 377s - loss: 2.6029 - accuracy10: 0.5775 - val_loss: 3.0228 - val_accuracy10: 0.5383 - 377s/epoch - 43ms/step
Epoch 40/50
8838/8838 - 374s - loss: 2.6015 - accuracy10: 0.5775 - val_loss: 3.0305 - val_accuracy10: 0.5392 - 374s/epoch - 42ms/step
Epoch 41/50
8838/8838 - 379s - loss: 2.6006 - accuracy10: 0.5779 - val_loss: 3.0294 - val_accuracy10: 0.5393 - 379s/epoch - 43ms/step
Epoch 42/50
8838/8838 - 378s - loss: 2.5991 - accuracy10: 0.5779 - val_loss: 3.0309 - val_accuracy10: 0.5386 - 378s/epoch - 43ms/step
Epoch 43/50
8838/8838 - 380s - loss: 2.5978 - accuracy10: 0.5783 - val_loss: 3.0342 - val_accuracy10: 0.5391 - 380s/epoch - 43ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 478s - 478s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81307554
{'0': {'precision': 0.46441609772217574, 'recall': 0.4087925290808803, 'f1-score': 0.43483269703550537, 'support': 1739545}, '1': {'precision': 0.7121654718253194, 'recall': 0.7860984958095274, 'f1-score': 0.747307841959404, 'support': 4986669}, '2': {'precision': 0.4702661669050863, 'recall': 0.3858272652606345, 'f1-score': 0.42388249297178926, 'support': 1722815}, 'accuracy': 0.626798061647084, 'macro avg': {'precision': 0.5489492454841938, 'recall': 0.526906096717014, 'f1-score': 0.5353410106555662, 'support': 8449029}, 'weighted avg': {'precision': 0.6118321748298416, 'recall': 0.626798061647084, 'f1-score': 0.61702463206715, 'support': 8449029}}
[[ 711113  795266  233166]
 [ 551057 3920013  515599]
 [ 269028  789078  664709]]
Evaluating performance on  train set...
8838/8838 - 134s - 134s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94982475
{'0': {'precision': 0.46952963227262284, 'recall': 0.44165611146295125, 'f1-score': 0.4551665410303762, 'support': 606336}, '1': {'precision': 0.5855563434121762, 'recall': 0.7135472983410053, 'f1-score': 0.6432468256409967, 'support': 1035808}, '2': {'precision': 0.482156660054573, 'recall': 0.3340613748693397, 'f1-score': 0.39467375105293845, 'support': 619928}, 'accuracy': 0.5366690361756832, 'macro avg': {'precision': 0.512414211913124, 'recall': 0.49642159489109877, 'f1-score': 0.49769570590810375, 'support': 2262072}, 'weighted avg': {'precision': 0.5261190086014255, 'recall': 0.5366690361756832, 'f1-score': 0.5247106975102869, 'support': 2262072}}
[[267792 248657  89887]
 [164175 739098 132535]
 [138374 274460 207094]]
Evaluating performance on  val set...
3279/3279 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94333464
{'0': {'precision': 0.47182848846874204, 'recall': 0.3876929381232072, 'f1-score': 0.42564284571702793, 'support': 219630}, '1': {'precision': 0.5812940527427967, 'recall': 0.740224299634283, 'f1-score': 0.6512024328669074, 'support': 394294}, '2': {'precision': 0.4797394987013319, 'recall': 0.33335852378052305, 'f1-score': 0.3933726233846622, 'support': 224953}, 'accuracy': 0.5388215435635976, 'macro avg': {'precision': 0.5109540133042902, 'recall': 0.4870919205126711, 'f1-score': 0.4900726339895325, 'support': 838877}, 'weighted avg': {'precision': 0.5254015637643169, 'recall': 0.5388215435635976, 'f1-score': 0.523008143050656, 'support': 838877}}
[[ 85149 103039  31442]
 [ 52546 291866  49882]
 [ 42771 107192  74990]]
testing model out of sample: results/universal/W0/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 312s - 312s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83358
{'0': {'precision': 0.48844809724428484, 'recall': 0.421176920859699, 'f1-score': 0.4523249943717126, 'support': 1259371}, '1': {'precision': 0.7022147722578784, 'recall': 0.7745399360381461, 'f1-score': 0.73660626471574, 'support': 3290086}, '2': {'precision': 0.480579775992387, 'recall': 0.41864237487008243, 'f1-score': 0.44747798648646964, 'support': 1283506}, 'accuracy': 0.6199338140838542, 'macro avg': {'precision': 0.5570808818315167, 'recall': 0.5381197439226425, 'f1-score': 0.5454697485246407, 'support': 5832963}, 'weighted avg': {'precision': 0.6072919347916917, 'recall': 0.6199338140838542, 'f1-score': 0.6116074489181144, 'support': 5832963}}
[[ 530418  534743  194210]
 [ 355236 2548303  386547]
 [ 200271  545905  537330]]
Evaluating performance on  train set...
6334/6334 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8214842
{'0': {'precision': 0.48439116652717457, 'recall': 0.42719067296683116, 'f1-score': 0.4539962940086473, 'support': 344118}, '1': {'precision': 0.7139649648010852, 'recall': 0.7899851200103513, 'f1-score': 0.7500537472588897, 'support': 927420}, '2': {'precision': 0.488456652360515, 'recall': 0.40720799629038074, 'f1-score': 0.44414715927893955, 'support': 349362}, 'accuracy': 0.6304614720217163, 'macro avg': {'precision': 0.5622709278962582, 'recall': 0.5414612630891877, 'f1-score': 0.5493990668488254, 'support': 1620900}, 'weighted avg': {'precision': 0.6166211981496669, 'recall': 0.6304614720217163, 'f1-score': 0.6212667547933346, 'support': 1620900}}
[[147004 146570  50544]
 [ 96329 732648  98443]
 [ 60149 146950 142263]]
Evaluating performance on  val set...
2156/2156 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81277555
{'0': {'precision': 0.4638875986994891, 'recall': 0.463068637765929, 'f1-score': 0.46347775645888184, 'support': 112154}, '1': {'precision': 0.7309211943451845, 'recall': 0.765735465502691, 'f1-score': 0.7479234162557783, 'support': 323489}, '2': {'precision': 0.4808264577963116, 'recall': 0.4176095844822668, 'f1-score': 0.44699394903869283, 'support': 115687}, 'accuracy': 0.6311174795494532, 'macro avg': {'precision': 0.5585450836136617, 'recall': 0.548804562583629, 'f1-score': 0.5527983739177843, 'support': 551330}, 'weighted avg': {'precision': 0.6241220075184624, 'recall': 0.6311174795494532, 'f1-score': 0.6269154068915062, 'support': 551330}}
[[ 51935  43831  16388]
 [ 40005 247707  35777]
 [ 20016  47359  48312]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
876/876 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91810286
{'0': {'precision': 0.3667020420112713, 'recall': 0.44739368233061727, 'f1-score': 0.4030488601968888, 'support': 44795}, '1': {'precision': 0.6938838579847636, 'recall': 0.7245444721279981, 'f1-score': 0.708882786572293, 'support': 133252}, '2': {'precision': 0.4320060600072457, 'recall': 0.2844842543593303, 'f1-score': 0.3430581527637928, 'support': 46108}, 'accuracy': 0.5786397805090228, 'macro avg': {'precision': 0.49753065333442686, 'recall': 0.4854741362726485, 'f1-score': 0.48499659984432486, 'support': 224155}, 'weighted avg': {'precision': 0.5746325767031505, 'recall': 0.5786397805090228, 'f1-score': 0.5725161074992027, 'support': 224155}}
[[20041 20186  4568]
 [24027 96547 12678]
 [10584 22407 13117]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0259916
{'0': {'precision': 0.3942617991125454, 'recall': 0.3679529411764706, 'f1-score': 0.3806533274913587, 'support': 21250}, '1': {'precision': 0.5696249108847136, 'recall': 0.6319750975939581, 'f1-score': 0.5991823503797958, 'support': 39193}, '2': {'precision': 0.41031652989449, 'recall': 0.35362039932643735, 'f1-score': 0.3798645924853998, 'support': 20785}, 'accuracy': 0.49167774658984587, 'macro avg': {'precision': 0.458067746630583, 'recall': 0.4511828126989554, 'f1-score': 0.4532334234521848, 'support': 81228}, 'weighted avg': {'precision': 0.4829837178965768, 'recall': 0.49167774658984587, 'f1-score': 0.48589307409311744, 'support': 81228}}
[[ 7819  9567  3864]
 [ 7725 24769  6699]
 [ 4288  9147  7350]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9855488
{'0': {'precision': 0.38228155339805825, 'recall': 0.4039756332157743, 'f1-score': 0.39282930631332813, 'support': 6238}, '1': {'precision': 0.6140572951365756, 'recall': 0.6721849474912486, 'f1-score': 0.6418076735603371, 'support': 13712}, '2': {'precision': 0.417910447761194, 'recall': 0.3123949258749809, 'f1-score': 0.3575301731677453, 'support': 6543}, 'accuracy': 0.5201751406031782, 'macro avg': {'precision': 0.47141643209860923, 'recall': 0.4628518355273346, 'f1-score': 0.4640557176804702, 'support': 26493}, 'weighted avg': {'precision': 0.5110411814710039, 'recall': 0.5201751406031782, 'f1-score': 0.5129753503068146, 'support': 26493}}
[[2520 2767  951]
 [2599 9217 1896]
 [1473 3026 2044]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6539983
{'0': {'precision': 0.4454584187945265, 'recall': 0.5469487566304929, 'f1-score': 0.491014040050459, 'support': 82196}, '1': {'precision': 0.8658220459734597, 'recall': 0.805566140415327, 'f1-score': 0.8346079379301051, 'support': 438257}, '2': {'precision': 0.4463977793666148, 'recall': 0.5094618107637847, 'f1-score': 0.47584943091071097, 'support': 83335}, 'accuracy': 0.7294911458988916, 'macro avg': {'precision': 0.585892748044867, 'recall': 0.6206589026032016, 'f1-score': 0.600490469630425, 'support': 603788}, 'weighted avg': {'precision': 0.750707254097369, 'recall': 0.7294911458988916, 'f1-score': 0.7383172130190824, 'support': 603788}}
[[ 44957  27398   9841]
 [ 42401 353045  42811]
 [ 13565  27314  42456]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.699123
{'0': {'precision': 0.46735905044510384, 'recall': 0.5120855614973262, 'f1-score': 0.4887010839610509, 'support': 23375}, '1': {'precision': 0.8358723565341054, 'recall': 0.7838187888556297, 'f1-score': 0.809009124982052, 'support': 104232}, '2': {'precision': 0.4551769523252413, 'recall': 0.5390077062949173, 'f1-score': 0.493557978196234, 'support': 23098}, 'accuracy': 0.7041504926843833, 'macro avg': {'precision': 0.5861361197681502, 'recall': 0.6116373522159577, 'f1-score': 0.5970893957131124, 'support': 150705}, 'weighted avg': {'precision': 0.7203665606000172, 'recall': 0.7041504926843833, 'f1-score': 0.7109799219209411, 'support': 150705}}
[[11970  8413  2992]
 [10623 81699 11910]
 [ 3019  7629 12450]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7141911
{'0': {'precision': 0.5045777065690089, 'recall': 0.4664621244181126, 'f1-score': 0.48477185266630013, 'support': 9452}, '1': {'precision': 0.8230434899981103, 'recall': 0.7627148325119456, 'f1-score': 0.7917315882414044, 'support': 39973}, '2': {'precision': 0.42211826060280694, 'recall': 0.5858435337945715, 'f1-score': 0.49068378354283676, 'support': 9395}, 'accuracy': 0.6868582114926896, 'macro avg': {'precision': 0.5832464857233087, 'recall': 0.6050068302415432, 'f1-score': 0.5890624081501804, 'support': 58820}, 'weighted avg': {'precision': 0.7078304482582133, 'recall': 0.6868582114926896, 'f1-score': 0.6943203752900455, 'support': 58820}}
[[ 4409  3680  1363]
 [ 3313 30488  6172]
 [ 1016  2875  5504]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89098763
{'0': {'precision': 0.5192962358560915, 'recall': 0.44976412445243175, 'f1-score': 0.482035642809492, 'support': 106836}, '1': {'precision': 0.6238584571593162, 'recall': 0.7411434955012983, 'f1-score': 0.6774622362054056, 'support': 198724}, '2': {'precision': 0.5222385253794305, 'recall': 0.41307087613676546, 'f1-score': 0.4612837738638262, 'support': 110291}, 'accuracy': 0.5792747883256263, 'macro avg': {'precision': 0.5551310727982793, 'recall': 0.5346594986968318, 'f1-score': 0.5402605509595746, 'support': 415851}, 'weighted avg': {'precision': 0.5700440539930699, 'recall': 0.5792747883256263, 'f1-score': 0.5699209910907829, 'support': 415851}}
[[ 48051  41881  16904]
 [ 26667 147283  24774]
 [ 17813  46920  45558]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91890514
{'0': {'precision': 0.4912660331796657, 'recall': 0.5057304277643261, 'f1-score': 0.49839330597181125, 'support': 30975}, '1': {'precision': 0.6162424693697962, 'recall': 0.6873867411658109, 'f1-score': 0.6498732912160474, 'support': 52976}, '2': {'precision': 0.5177148461444159, 'recall': 0.40220324454744594, 'f1-score': 0.4527068072181526, 'support': 31499}, 'accuracy': 0.5608401905586834, 'macro avg': {'precision': 0.5417411162312926, 'recall': 0.5317734711591943, 'f1-score': 0.5336578014686705, 'support': 115450}, 'weighted avg': {'precision': 0.5558295918040487, 'recall': 0.5608401905586834, 'f1-score': 0.5554372615721331, 'support': 115450}}
[[15665 10480  4830]
 [ 9589 36415  6972]
 [ 6633 12197 12669]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9236834
{'0': {'precision': 0.512443009118541, 'recall': 0.45210760077097123, 'f1-score': 0.4803882284849294, 'support': 11933}, '1': {'precision': 0.5854178564629735, 'recall': 0.7431250302063699, 'f1-score': 0.6549109804923758, 'support': 20691}, '2': {'precision': 0.534093637454982, 'recall': 0.35594847587807027, 'f1-score': 0.4271928561140717, 'support': 12499}, 'accuracy': 0.5589167386920196, 'macro avg': {'precision': 0.5439848343454988, 'recall': 0.5170603689518037, 'f1-score': 0.5208306883637923, 'support': 45123}, 'weighted avg': {'precision': 0.5519025700958881, 'recall': 0.5589167386920196, 'f1-score': 0.545680015434439, 'support': 45123}}
[[ 5395  5019  1519]
 [ 2953 15376  2362]
 [ 2180  5870  4449]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1556889
{'0': {'precision': 0.37848806610709307, 'recall': 0.618526170188241, 'f1-score': 0.46961169754416204, 'support': 112781}, '1': {'precision': 0.5095594347464671, 'recall': 0.09094415761675866, 'f1-score': 0.15434196943374373, 'support': 101106}, '2': {'precision': 0.396456229781394, 'recall': 0.4377012365053167, 'f1-score': 0.41605905121973175, 'support': 110877}, 'accuracy': 0.39254350851695385, 'macro avg': {'precision': 0.4281679102116514, 'recall': 0.38239052143677216, 'f1-score': 0.3466709060658792, 'support': 324764}, 'weighted avg': {'precision': 0.4254278681829636, 'recall': 0.39254350851695385, 'f1-score': 0.35317817074671587, 'support': 324764}}
[[69758  4194 38829]
 [56859  9195 35052]
 [57690  4656 48531]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1464714
{'0': {'precision': 0.38251035039886905, 'recall': 0.5506214114397848, 'f1-score': 0.45142261284075674, 'support': 41277}, '1': {'precision': 0.4511953399943368, 'recall': 0.2720156078527009, 'f1-score': 0.33940906186288533, 'support': 41005}, '2': {'precision': 0.39622594476019546, 'recall': 0.37869582827055487, 'f1-score': 0.3872626052211624, 'support': 41973}, 'accuracy': 0.40060359744074686, 'macro avg': {'precision': 0.40997721171780044, 'recall': 0.4004442825210135, 'f1-score': 0.39269809330826816, 'support': 124255}, 'weighted avg': {'precision': 0.4098099571792007, 'recall': 0.40060359744074686, 'f1-score': 0.39278429923031977, 'support': 124255}}
[[22728  6434 12115]
 [17745 11154 12106]
 [18945  7133 15895]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1675918
{'0': {'precision': 0.37578771169751873, 'recall': 0.5159175397093613, 'f1-score': 0.434842054291167, 'support': 14795}, '1': {'precision': 0.4046471139681264, 'recall': 0.4067169201776821, 'f1-score': 0.4056793770139635, 'support': 14858}, '2': {'precision': 0.4249562001167997, 'recall': 0.275162286506586, 'f1-score': 0.3340346581997628, 'support': 15867}, 'accuracy': 0.39635325131810195, 'macro avg': {'precision': 0.40179700859414824, 'recall': 0.3992655821312097, 'f1-score': 0.3915186965016311, 'support': 45520}, 'weighted avg': {'precision': 0.40234635415545855, 'recall': 0.39635325131810195, 'f1-score': 0.3901845408296775, 'support': 45520}}
[[7633 4082 3080]
 [5987 6043 2828]
 [6692 4809 4366]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0363021
{'0': {'precision': 0.4627443401435671, 'recall': 0.580803670436904, 'f1-score': 0.5150958240623502, 'support': 144288}, '1': {'precision': 0.4844898490853942, 'recall': 0.5092881780304759, 'f1-score': 0.4965796098975155, 'support': 153367}, '2': {'precision': 0.5173575769553832, 'recall': 0.3589406062101922, 'f1-score': 0.42382980101355183, 'support': 145857}, 'accuracy': 0.4831098143905915, 'macro avg': {'precision': 0.4881972553947815, 'recall': 0.4830108182258573, 'f1-score': 0.47850174499113923, 'support': 443512}, 'weighted avg': {'precision': 0.48822452185576937, 'recall': 0.4831098143905915, 'f1-score': 0.4786784000881471, 'support': 443512}}
[[83803 37017 23468]
 [49886 78108 25373]
 [47411 46092 52354]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0220757
{'0': {'precision': 0.49087420300365636, 'recall': 0.4979996627783994, 'f1-score': 0.49441126117557543, 'support': 65239}, '1': {'precision': 0.48396010325645655, 'recall': 0.6193659459627137, 'f1-score': 0.5433541741786689, 'support': 64474}, '2': {'precision': 0.5218527568256667, 'recall': 0.37184902575282736, 'f1-score': 0.43426217334417766, 'support': 66051}, 'accuracy': 0.49540773584520137, 'macro avg': {'precision': 0.4988956876952599, 'recall': 0.4964048781646468, 'f1-score': 0.4906758695661407, 'support': 195764}, 'weighted avg': {'precision': 0.49904927498520896, 'recall': 0.49540773584520137, 'f1-score': 0.4902360194182033, 'support': 195764}}
[[32489 20436 12314]
 [14351 39933 10190]
 [19346 22144 24561]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0058788
{'0': {'precision': 0.49246029980872735, 'recall': 0.5156017138599106, 'f1-score': 0.5037653857529634, 'support': 21472}, '1': {'precision': 0.49937939594538683, 'recall': 0.5734784054734642, 'f1-score': 0.5338700046442709, 'support': 21047}, '2': {'precision': 0.5212265456356894, 'recall': 0.42420829767106627, 'f1-score': 0.4677395321114588, 'support': 22199}, 'accuracy': 0.5030748787045335, 'macro avg': {'precision': 0.5043554137966012, 'recall': 0.5044294723348136, 'f1-score': 0.5017916408362311, 'support': 64718}, 'weighted avg': {'precision': 0.5045776104101212, 'recall': 0.5030748787045335, 'f1-score': 0.5011984644763107, 'support': 64718}}
[[11071  5642  4759]
 [ 5086 12070  3891]
 [ 6324  6458  9417]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
4693/4693 - 70s - 70s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60405576
{'0': {'precision': 0.4407509172053428, 'recall': 0.6085923565016521, 'f1-score': 0.5112485991064986, 'support': 136796}, '1': {'precision': 0.9033979000467601, 'recall': 0.8264336576850619, 'f1-score': 0.8632036195010775, 'support': 925744}, '2': {'precision': 0.4618713994692523, 'recall': 0.551063093211782, 'f1-score': 0.5025404582361821, 'support': 138652}, 'accuracy': 0.7698394594702596, 'macro avg': {'precision': 0.6020067389071184, 'recall': 0.6620297024661653, 'f1-score': 0.625664225614586, 'support': 1201192}, 'weighted avg': {'precision': 0.7997452042055897, 'recall': 0.7698394594702596, 'f1-score': 0.7814908644997145, 'support': 1201192}}
[[ 83253  37545  15998]
 [ 87655 765066  73023]
 [ 17981  44265  76406]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6619972
{'0': {'precision': 0.43527413308341145, 'recall': 0.602676399026764, 'f1-score': 0.5054758179715665, 'support': 49320}, '1': {'precision': 0.8845938442106267, 'recall': 0.787246151398929, 'f1-score': 0.8330858230869079, 'support': 282895}, '2': {'precision': 0.44562426701321756, 'recall': 0.5520477480661248, 'f1-score': 0.4931598147888312, 'support': 50934}, 'accuracy': 0.7322216683326852, 'macro avg': {'precision': 0.5884974147690852, 'recall': 0.6473234328306059, 'f1-score': 0.6105738186157685, 'support': 383149}, 'weighted avg': {'precision': 0.768401645881081, 'recall': 0.7322216683326852, 'f1-score': 0.7457268145577381, 'support': 383149}}
[[ 29724  12698   6898]
 [ 32105 222708  28082]
 [  6459  16357  28118]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6497615
{'0': {'precision': 0.43776043975529744, 'recall': 0.5898691834418494, 'f1-score': 0.5025573169800758, 'support': 16741}, '1': {'precision': 0.8943622080906322, 'recall': 0.7927865622009796, 'f1-score': 0.8405166785524161, 'support': 105553}, '2': {'precision': 0.43302404048924503, 'recall': 0.5853811505787103, 'f1-score': 0.49780600741836173, 'support': 17539}, 'accuracy': 0.7424785279583503, 'macro avg': {'precision': 0.5883822294450582, 'recall': 0.6560122987405131, 'f1-score': 0.6136266676502845, 'support': 139833}, 'weighted avg': {'precision': 0.781832402356202, 'recall': 0.7424785279583503, 'f1-score': 0.7570701377994984, 'support': 139833}}
[[ 9875  4590  2276]
 [10705 83681 11167]
 [ 1978  5294 10267]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
6677/6677 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6210214
{'0': {'precision': 0.3877970554617261, 'recall': 0.5103843908572455, 'f1-score': 0.4407251223886384, 'support': 178152}, '1': {'precision': 0.8995285912177226, 'recall': 0.8143108602929042, 'f1-score': 0.8548010729090465, 'support': 1345286}, '2': {'precision': 0.3951373458531631, 'recall': 0.5463712281003831, 'f1-score': 0.458607989124421, 'support': 185848}, 'accuracy': 0.753501169494163, 'macro avg': {'precision': 0.5608209975108706, 'recall': 0.6236888264168443, 'f1-score': 0.5847113948073687, 'support': 1709286}, 'weighted avg': {'precision': 0.7913511997650837, 'recall': 0.753501169494163, 'f1-score': 0.7685661473481299, 'support': 1709286}}
[[  90926   65360   21866]
 [ 116234 1095481  133571]
 [  27308   56998  101542]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73478264
{'0': {'precision': 0.49374469159607925, 'recall': 0.41400881566030834, 'f1-score': 0.45037480631517235, 'support': 103906}, '1': {'precision': 0.7574327456016685, 'recall': 0.8516641604282139, 'f1-score': 0.8017892781302786, 'support': 368414}, '2': {'precision': 0.5165958765282278, 'recall': 0.37568184165313157, 'f1-score': 0.4350118496292914, 'support': 106513}, 'accuracy': 0.6855137837683754, 'macro avg': {'precision': 0.5892577712419919, 'recall': 0.5471182725805513, 'f1-score': 0.5623919780249141, 'support': 578833}, 'weighted avg': {'precision': 0.6657810457588397, 'recall': 0.6855137837683754, 'f1-score': 0.671215111919392, 'support': 578833}}
[[ 43018  49843  11045]
 [ 28250 313765  26399]
 [ 15858  50640  40015]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.706887
{'0': {'precision': 0.47245924605196127, 'recall': 0.4351995776754553, 'f1-score': 0.4530646515533165, 'support': 34097}, '1': {'precision': 0.7810243689655397, 'recall': 0.8446670985185603, 'f1-score': 0.8115999878222453, 'support': 142024}, '2': {'precision': 0.5147784178621183, 'recall': 0.3857461275851367, 'f1-score': 0.4410180316763975, 'support': 35443}, 'accuracy': 0.7017923654307916, 'macro avg': {'precision': 0.5894206776265398, 'recall': 0.5552042679263841, 'f1-score': 0.568560890350653, 'support': 211564}, 'weighted avg': {'precision': 0.6866902656164686, 'recall': 0.7017923654307916, 'f1-score': 0.6917331123971306, 'support': 211564}}
[[ 14839  16332   2926]
 [ 12100 119963   9961]
 [  4469  17302  13672]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
5633/5633 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6953592
{'0': {'precision': 0.4611712075400193, 'recall': 0.48590079122233654, 'f1-score': 0.47321313464127435, 'support': 230403}, '1': {'precision': 0.8092920349503911, 'recall': 0.8157468136962348, 'f1-score': 0.8125066048855831, 'support': 980211}, '2': {'precision': 0.4861808033281686, 'recall': 0.44376351526684543, 'f1-score': 0.46400477539585816, 'support': 231220}, 'accuracy': 0.7033847169646437, 'macro avg': {'precision': 0.5855480152728596, 'recall': 0.5818037067284721, 'f1-score': 0.5832415049742385, 'support': 1441834}, 'weighted avg': {'precision': 0.7018470295104292, 'recall': 0.7033847169646437, 'f1-score': 0.7024004300836894, 'support': 1441834}}
[[111953  94075  24375]
 [ 96542 799604  84065]
 [ 34263  94350 102607]]
Evaluating performance on  train set...
1454/1454 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8728851
{'0': {'precision': 0.47596262778392356, 'recall': 0.4170238109140168, 'f1-score': 0.4445481818973995, 'support': 85633}, '1': {'precision': 0.6678308234540211, 'recall': 0.7262983925966856, 'f1-score': 0.695838589446123, 'support': 200883}, '2': {'precision': 0.47138531222963, 'recall': 0.4329216279694785, 'f1-score': 0.45133546520481194, 'support': 85579}, 'accuracy': 0.5876483156183233, 'macro avg': {'precision': 0.5383929211558582, 'recall': 0.5254146104933937, 'f1-score': 0.5305740788494449, 'support': 372095}, 'weighted avg': {'precision': 0.5784938003688154, 'recall': 0.5876483156183233, 'f1-score': 0.5817734062561661, 'support': 372095}}
[[ 35711  37013  12909]
 [ 26344 145901  28638]
 [ 12974  35556  37049]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8353659
{'0': {'precision': 0.48873233459236937, 'recall': 0.37124435847840104, 'f1-score': 0.4219628822160746, 'support': 31020}, '1': {'precision': 0.6901487071852811, 'recall': 0.7724449886915993, 'f1-score': 0.7289815508163277, 'support': 80029}, '2': {'precision': 0.49091405929771825, 'recall': 0.4582615904597921, 'f1-score': 0.4740261881988192, 'support': 31362}, 'accuracy': 0.6158653474801806, 'macro avg': {'precision': 0.5565983670251229, 'recall': 0.5339836458765975, 'f1-score': 0.5416568737437405, 'support': 142411}, 'weighted avg': {'precision': 0.6024003386963169, 'recall': 0.6158653474801806, 'f1-score': 0.6059599500804986, 'support': 142411}}
[[11516 14951  4553]
 [ 7860 61818 10351]
 [ 4187 12803 14372]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
11876/11876 - 164s - 164s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9095192
{'0': {'precision': 0.5497155837214629, 'recall': 0.36671972494588057, 'f1-score': 0.43994714248613637, 'support': 785300}, '1': {'precision': 0.6031417597120605, 'recall': 0.7743448419514929, 'f1-score': 0.6781041790672222, 'support': 1459457}, '2': {'precision': 0.5056275601040849, 'recall': 0.40846263901775454, 'f1-score': 0.45188093638600396, 'support': 795402}, 'accuracy': 0.5733252767371707, 'macro avg': {'precision': 0.5528283011792028, 'recall': 0.5165090686383761, 'f1-score': 0.5233107526464541, 'support': 3040159}, 'weighted avg': {'precision': 0.5638284983326394, 'recall': 0.5733252767371707, 'f1-score': 0.5573989328935014, 'support': 3040159}}
[[ 287985  370167  127148]
 [ 138822 1130123  190512]
 [  97073  373437  324892]]
Evaluating performance on  train set...
2538/2538 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7955926
{'0': {'precision': 0.4873319021386909, 'recall': 0.39206341447518495, 'f1-score': 0.4345372460496614, 'support': 122748}, '1': {'precision': 0.7440815896397082, 'recall': 0.7896700243312631, 'f1-score': 0.7661982835329608, 'support': 402363}, '2': {'precision': 0.46286069531237384, 'recall': 0.4604221212072538, 'f1-score': 0.4616381878794711, 'support': 124514}, 'accuracy': 0.651434289012892, 'macro avg': {'precision': 0.5647580623635909, 'recall': 0.5473851866712339, 'f1-score': 0.5541245724873644, 'support': 649625}, 'weighted avg': {'precision': 0.6416664284657254, 'recall': 0.651434289012892, 'f1-score': 0.6451550281483948, 'support': 649625}}
[[ 48125  56274  18349]
 [ 36449 317734  48180]
 [ 14178  53007  57329]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8144464
{'0': {'precision': 0.4429500767487757, 'recall': 0.47326495548497943, 'f1-score': 0.45760600072995455, 'support': 38414}, '1': {'precision': 0.7604784912978784, 'recall': 0.7219219934134825, 'f1-score': 0.7406988247076016, 'support': 126015}, '2': {'precision': 0.43972593129574633, 'recall': 0.4821167602492116, 'f1-score': 0.4599466771029523, 'support': 39003}, 'accuracy': 0.6289915057611388, 'macro avg': {'precision': 0.5477181664474667, 'recall': 0.5591012363825578, 'f1-score': 0.5527505008468362, 'support': 203432}, 'weighted avg': {'precision': 0.6390234172964805, 'recall': 0.6289915057611388, 'f1-score': 0.6334152913731141, 'support': 203432}}
[[18180 14061  6173]
 [17256 90973 17786]
 [ 5607 14592 18804]]
testing model on single stock: results/universal/W0/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
19053/19053 - 278s - 278s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89621496
{'0': {'precision': 0.4926375787997633, 'recall': 0.34076572425467294, 'f1-score': 0.4028637772840808, 'support': 1177369}, '1': {'precision': 0.6144641496217773, 'recall': 0.7842564840511995, 'f1-score': 0.6890546717573536, 'support': 2541351}, '2': {'precision': 0.48163836119948306, 'recall': 0.3406139992802471, 'f1-score': 0.3990326481257558, 'support': 1158731}, 'accuracy': 0.5718064620228885, 'macro avg': {'precision': 0.5295800298736745, 'recall': 0.48854540252870654, 'f1-score': 0.4969836990557301, 'support': 4877451}, 'weighted avg': {'precision': 0.5535011206735628, 'recall': 0.5718064620228885, 'f1-score': 0.5510707541947234, 'support': 4877451}}
[[ 401207  632011  144151]
 [ 267658 1993071  280622]
 [ 145541  618510  394680]]
Evaluating performance on  train set...
4812/4812 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0731635
{'0': {'precision': 0.4903679751589773, 'recall': 0.41312071123174776, 'f1-score': 0.4484420662138539, 'support': 406731}, '1': {'precision': 0.41527784215019486, 'recall': 0.682801818123714, 'f1-score': 0.5164515397287578, 'support': 406793}, '2': {'precision': 0.5164323509924759, 'recall': 0.27202493641596387, 'f1-score': 0.3563477177149907, 'support': 418344}, 'accuracy': 0.45425970964421514, 'macro avg': {'precision': 0.4740260561005494, 'recall': 0.45598248859047524, 'f1-score': 0.4404137745525341, 'support': 1231868}, 'weighted avg': {'precision': 0.4744228696498217, 'recall': 0.45425970964421514, 'f1-score': 0.43962509851207077, 'support': 1231868}}
[[168029 183842  54860]
 [ 77336 277759  51698]
 [ 97294 207250 113800]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0751736
{'0': {'precision': 0.49227467403587744, 'recall': 0.35115362208884854, 'f1-score': 0.40990807551645747, 'support': 147622}, '1': {'precision': 0.4109971518490555, 'recall': 0.7145716495213834, 'f1-score': 0.5218462210178372, 'support': 153881}, '2': {'precision': 0.5074891753096364, 'recall': 0.2673851051130712, 'f1-score': 0.3502375802430529, 'support': 150790}, 'accuracy': 0.44686961770356826, 'macro avg': {'precision': 0.47025366706485644, 'recall': 0.44437012557443434, 'f1-score': 0.42733062559244916, 'support': 452293}, 'weighted avg': {'precision': 0.4696944622161937, 'recall': 0.44686961770356826, 'f1-score': 0.4280985842920103, 'support': 452293}}
[[ 51838  75808  19976]
 [ 24769 109959  19153]
 [ 28696  81775  40319]]
training model: results/universal/W0/deepLOB_L2/h20
Epoch 1/50
8838/8838 - 382s - loss: 3.0288 - accuracy20: 0.4707 - val_loss: 3.2263 - val_accuracy20: 0.3870 - 382s/epoch - 43ms/step
Epoch 2/50
8838/8838 - 380s - loss: 2.9474 - accuracy20: 0.4946 - val_loss: 3.1616 - val_accuracy20: 0.4564 - 380s/epoch - 43ms/step
Epoch 3/50
8838/8838 - 380s - loss: 2.8901 - accuracy20: 0.5095 - val_loss: 3.1506 - val_accuracy20: 0.4623 - 380s/epoch - 43ms/step
Epoch 4/50
8838/8838 - 378s - loss: 2.8573 - accuracy20: 0.5177 - val_loss: 3.1615 - val_accuracy20: 0.4660 - 378s/epoch - 43ms/step
Epoch 5/50
8838/8838 - 372s - loss: 2.8376 - accuracy20: 0.5220 - val_loss: 3.1576 - val_accuracy20: 0.4705 - 372s/epoch - 42ms/step
Epoch 6/50
8838/8838 - 376s - loss: 2.8242 - accuracy20: 0.5247 - val_loss: 3.1325 - val_accuracy20: 0.4766 - 376s/epoch - 43ms/step
Epoch 7/50
8838/8838 - 375s - loss: 2.8147 - accuracy20: 0.5271 - val_loss: 3.1086 - val_accuracy20: 0.4809 - 375s/epoch - 42ms/step
Epoch 8/50
8838/8838 - 372s - loss: 2.8073 - accuracy20: 0.5287 - val_loss: 3.1363 - val_accuracy20: 0.4783 - 372s/epoch - 42ms/step
Epoch 9/50
8838/8838 - 373s - loss: 2.8006 - accuracy20: 0.5303 - val_loss: 3.1036 - val_accuracy20: 0.4832 - 373s/epoch - 42ms/step
Epoch 10/50
8838/8838 - 377s - loss: 2.7955 - accuracy20: 0.5314 - val_loss: 3.1017 - val_accuracy20: 0.4839 - 377s/epoch - 43ms/step
Epoch 11/50
8838/8838 - 376s - loss: 2.7911 - accuracy20: 0.5323 - val_loss: 3.1017 - val_accuracy20: 0.4853 - 376s/epoch - 43ms/step
Epoch 12/50
8838/8838 - 371s - loss: 2.7873 - accuracy20: 0.5333 - val_loss: 3.1105 - val_accuracy20: 0.4852 - 371s/epoch - 42ms/step
Epoch 13/50
8838/8838 - 370s - loss: 2.7839 - accuracy20: 0.5340 - val_loss: 3.1178 - val_accuracy20: 0.4860 - 370s/epoch - 42ms/step
Epoch 14/50
8838/8838 - 371s - loss: 2.7807 - accuracy20: 0.5348 - val_loss: 3.1011 - val_accuracy20: 0.4879 - 371s/epoch - 42ms/step
Epoch 15/50
8838/8838 - 378s - loss: 2.7779 - accuracy20: 0.5357 - val_loss: 3.0838 - val_accuracy20: 0.4894 - 378s/epoch - 43ms/step
Epoch 16/50
8838/8838 - 380s - loss: 2.7755 - accuracy20: 0.5359 - val_loss: 3.0974 - val_accuracy20: 0.4899 - 380s/epoch - 43ms/step
Epoch 17/50
8838/8838 - 377s - loss: 2.7731 - accuracy20: 0.5366 - val_loss: 3.0880 - val_accuracy20: 0.4909 - 377s/epoch - 43ms/step
Epoch 18/50
8838/8838 - 374s - loss: 2.7711 - accuracy20: 0.5371 - val_loss: 3.0945 - val_accuracy20: 0.4911 - 374s/epoch - 42ms/step
Epoch 19/50
8838/8838 - 375s - loss: 2.7688 - accuracy20: 0.5378 - val_loss: 3.0855 - val_accuracy20: 0.4921 - 375s/epoch - 42ms/step
Epoch 20/50
8838/8838 - 380s - loss: 2.7666 - accuracy20: 0.5383 - val_loss: 3.0936 - val_accuracy20: 0.4916 - 380s/epoch - 43ms/step
Epoch 21/50
8838/8838 - 379s - loss: 2.7649 - accuracy20: 0.5387 - val_loss: 3.0662 - val_accuracy20: 0.4964 - 379s/epoch - 43ms/step
Epoch 22/50
8838/8838 - 379s - loss: 2.7629 - accuracy20: 0.5393 - val_loss: 3.0844 - val_accuracy20: 0.4940 - 379s/epoch - 43ms/step
Epoch 23/50
8838/8838 - 378s - loss: 2.7611 - accuracy20: 0.5394 - val_loss: 3.0727 - val_accuracy20: 0.4958 - 378s/epoch - 43ms/step
Epoch 24/50
8838/8838 - 373s - loss: 2.7593 - accuracy20: 0.5400 - val_loss: 3.0646 - val_accuracy20: 0.4972 - 373s/epoch - 42ms/step
Epoch 25/50
8838/8838 - 374s - loss: 2.7576 - accuracy20: 0.5404 - val_loss: 3.0671 - val_accuracy20: 0.4960 - 374s/epoch - 42ms/step
Epoch 26/50
8838/8838 - 375s - loss: 2.7562 - accuracy20: 0.5407 - val_loss: 3.0611 - val_accuracy20: 0.4971 - 375s/epoch - 42ms/step
Epoch 27/50
8838/8838 - 373s - loss: 2.7549 - accuracy20: 0.5410 - val_loss: 3.0618 - val_accuracy20: 0.4973 - 373s/epoch - 42ms/step
Epoch 28/50
8838/8838 - 375s - loss: 2.7532 - accuracy20: 0.5413 - val_loss: 3.0569 - val_accuracy20: 0.4972 - 375s/epoch - 42ms/step
Epoch 29/50
8838/8838 - 376s - loss: 2.7517 - accuracy20: 0.5418 - val_loss: 3.0614 - val_accuracy20: 0.4975 - 376s/epoch - 43ms/step
Epoch 30/50
8838/8838 - 373s - loss: 2.7505 - accuracy20: 0.5418 - val_loss: 3.0719 - val_accuracy20: 0.4971 - 373s/epoch - 42ms/step
Epoch 31/50
8838/8838 - 374s - loss: 2.7492 - accuracy20: 0.5420 - val_loss: 3.0682 - val_accuracy20: 0.4975 - 374s/epoch - 42ms/step
Epoch 32/50
8838/8838 - 370s - loss: 2.7479 - accuracy20: 0.5428 - val_loss: 3.0818 - val_accuracy20: 0.4964 - 370s/epoch - 42ms/step
Epoch 33/50
8838/8838 - 376s - loss: 2.7467 - accuracy20: 0.5429 - val_loss: 3.0576 - val_accuracy20: 0.4973 - 376s/epoch - 43ms/step
Epoch 34/50
8838/8838 - 377s - loss: 2.7454 - accuracy20: 0.5430 - val_loss: 3.0625 - val_accuracy20: 0.4983 - 377s/epoch - 43ms/step
Epoch 35/50
8838/8838 - 376s - loss: 2.7437 - accuracy20: 0.5436 - val_loss: 3.0594 - val_accuracy20: 0.4992 - 376s/epoch - 43ms/step
Epoch 36/50
8838/8838 - 376s - loss: 2.7425 - accuracy20: 0.5437 - val_loss: 3.0716 - val_accuracy20: 0.4972 - 376s/epoch - 43ms/step
Epoch 37/50
8838/8838 - 374s - loss: 2.7412 - accuracy20: 0.5442 - val_loss: 3.0612 - val_accuracy20: 0.4979 - 374s/epoch - 42ms/step
Epoch 38/50
8838/8838 - 373s - loss: 2.7405 - accuracy20: 0.5444 - val_loss: 3.0580 - val_accuracy20: 0.4992 - 373s/epoch - 42ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 463s - 463s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88257545
{'0': {'precision': 0.4500362277768578, 'recall': 0.4408046185798266, 'f1-score': 0.44537259049941014, 'support': 1954367}, '1': {'precision': 0.6733836261970585, 'recall': 0.7268717625676719, 'f1-score': 0.6991061019088217, 'support': 4549709}, '2': {'precision': 0.46771319698629815, 'recall': 0.39044799540143127, 'f1-score': 0.4256022803314685, 'support': 1944953}, 'accuracy': 0.5832566085404607, 'macro avg': {'precision': 0.5303776836534048, 'recall': 0.5193747921829767, 'f1-score': 0.5233603242465669, 'support': 8449029}, 'weighted avg': {'precision': 0.5743755504391165, 'recall': 0.5832566085404607, 'f1-score': 0.5774541961358607, 'support': 8449029}}
[[ 861494  794212  298661]
 [ 677067 3307055  565587]
 [ 375716  809834  759403]]
Evaluating performance on  train set...
8838/8838 - 126s - 126s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9969799
{'0': {'precision': 0.4538840124626811, 'recall': 0.42716904975546416, 'f1-score': 0.44012151053593535, 'support': 653074}, '1': {'precision': 0.5292643378243957, 'recall': 0.6485373491521972, 'f1-score': 0.5828616047146961, 'support': 942672}, '2': {'precision': 0.46408898132952014, 'recall': 0.3429012225247101, 'f1-score': 0.39439556588938546, 'support': 666326}, 'accuracy': 0.49459743102783643, 'macro avg': {'precision': 0.482412443872199, 'recall': 0.47286920714412384, 'f1-score': 0.47245956038000564, 'support': 2262072}, 'weighted avg': {'precision': 0.48830323437716644, 'recall': 0.49459743102783643, 'f1-score': 0.4861362723415382, 'support': 2262072}}
[[278973 261091 113010]
 [180480 611358 150834]
 [155182 282660 228484]]
Evaluating performance on  val set...
3279/3279 - 44s - 44s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98968726
{'0': {'precision': 0.46266670993282927, 'recall': 0.36129435514523905, 'f1-score': 0.405744585993303, 'support': 236782}, '1': {'precision': 0.5194886553944251, 'recall': 0.6982714059416947, 'f1-score': 0.5957562335802422, 'support': 359830}, '2': {'precision': 0.4702335167254813, 'recall': 0.3305677667017522, 'f1-score': 0.38822126454890515, 'support': 242265}, 'accuracy': 0.4969643940649225, 'macro avg': {'precision': 0.4841296273509119, 'recall': 0.46337784259622866, 'f1-score': 0.4632406947074834, 'support': 838877}, 'weighted avg': {'precision': 0.4892253270877493, 'recall': 0.4969643940649225, 'f1-score': 0.4821879783875173, 'support': 838877}}
[[ 85548 114563  36671]
 [ 55018 251259  53553]
 [ 44336 117844  80085]]
testing model out of sample: results/universal/W0/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 334s - 334s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9311685
{'0': {'precision': 0.5005621504811132, 'recall': 0.4182194670150983, 'f1-score': 0.45570096701027174, 'support': 1557455}, '1': {'precision': 0.6042036453737714, 'recall': 0.6995800198908638, 'f1-score': 0.6484032735030781, 'support': 2693699}, '2': {'precision': 0.47925747346754455, 'recall': 0.4280504156949417, 'f1-score': 0.45220892090347753, 'support': 1581809}, 'accuracy': 0.5508195406005489, 'macro avg': {'precision': 0.5280077564408098, 'recall': 0.5152833008669679, 'f1-score': 0.5187710538056091, 'support': 5832963}, 'weighted avg': {'precision': 0.5426469470602622, 'recall': 0.5508195406005489, 'f1-score': 0.5437451154708781, 'support': 5832963}}
[[ 651358  613095  293002]
 [ 366539 1884458  442702]
 [ 283356  621359  677094]]
Evaluating performance on  train set...
6334/6334 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9162012
{'0': {'precision': 0.490063721337127, 'recall': 0.41696761074663874, 'f1-score': 0.4505703204984262, 'support': 425882}, '1': {'precision': 0.6250099204599566, 'recall': 0.7427382413543319, 'f1-score': 0.678807374210853, 'support': 763417}, '2': {'precision': 0.49851561944068884, 'recall': 0.4057937771228519, 'f1-score': 0.4474011592411033, 'support': 431601}, 'accuracy': 0.56742488740823, 'macro avg': {'precision': 0.5378630870792575, 'recall': 0.5218332097412742, 'f1-score': 0.5255929513167942, 'support': 1620900}, 'weighted avg': {'precision': 0.5558716491359724, 'recall': 0.56742488740823, 'f1-score': 0.557222324734442, 'support': 1620900}}
[[177579 171106  77197]
 [ 97411 567019  98987]
 [ 87369 169091 175141]]
Evaluating performance on  val set...
2156/2156 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9086186
{'0': {'precision': 0.48021220159151196, 'recall': 0.45283288548396317, 'f1-score': 0.4661208336091924, 'support': 139928}, '1': {'precision': 0.6388519165456916, 'recall': 0.7107141791490124, 'f1-score': 0.6728697718681528, 'support': 268112}, '2': {'precision': 0.48849383613108854, 'recall': 0.41287598576313767, 'f1-score': 0.44751303900544254, 'support': 143290}, 'accuracy': 0.567855912067183, 'macro avg': {'precision': 0.5358526514227641, 'recall': 0.5254743501320377, 'f1-score': 0.5288345481609292, 'support': 551330}, 'weighted avg': {'precision': 0.5595111453619779, 'recall': 0.567855912067183, 'f1-score': 0.5618267818538282, 'support': 551330}}
[[ 63364  52150  24414]
 [ 40027 190551  37534]
 [ 28559  55570  59161]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0142951
{'0': {'precision': 0.3688708689437914, 'recall': 0.45581848000432534, 'f1-score': 0.40776119884243023, 'support': 55487}, '1': {'precision': 0.6102360717658168, 'recall': 0.5785289694191793, 'f1-score': 0.5939596698590099, 'support': 111704}, '2': {'precision': 0.4119624061663547, 'recall': 0.3593497647637104, 'f1-score': 0.38386168227804185, 'support': 56964}, 'accuracy': 0.49245388235818965, 'macro avg': {'precision': 0.46368978229198765, 'recall': 0.46456573806240503, 'f1-score': 0.46186085032649404, 'support': 224155}, 'weighted avg': {'precision': 0.5001020480046093, 'recall': 0.49245388235818965, 'f1-score': 0.49447664995823054, 'support': 224155}}
[[25292 20107 10088]
 [27949 64624 19131]
 [15325 21169 20470]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0850747
{'0': {'precision': 0.41746386278393527, 'recall': 0.38261877172653536, 'f1-score': 0.39928253290070337, 'support': 25890}, '1': {'precision': 0.4511186222436826, 'recall': 0.4671021931871209, 'f1-score': 0.4589712938248154, 'support': 30002}, '2': {'precision': 0.4156767799046682, 'recall': 0.4336911904010104, 'f1-score': 0.4244929495847015, 'support': 25336}, 'accuracy': 0.4297532870438765, 'macro avg': {'precision': 0.4280864216440953, 'recall': 0.42780405177155556, 'f1-score': 0.42758225877007344, 'support': 81228}, 'weighted avg': {'precision': 0.4293370168869814, 'recall': 0.4297532870438765, 'f1-score': 0.42919233398347023, 'support': 81228}}
[[ 9906  8834  7150]
 [ 7692 14014  8296]
 [ 6131  8217 10988]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0566726
{'0': {'precision': 0.39204545454545453, 'recall': 0.44539586352259253, 'f1-score': 0.4170212765957446, 'support': 7591}, '1': {'precision': 0.5184388444990781, 'recall': 0.4655077262693157, 'f1-score': 0.49054957836580404, 'support': 10872}, '2': {'precision': 0.41124953743678305, 'recall': 0.41519302615193027, 'f1-score': 0.4132118733345727, 'support': 8030}, 'accuracy': 0.4444947722039784, 'macro avg': {'precision': 0.4405779454937719, 'recall': 0.44203220531461285, 'f1-score': 0.44026090943204044, 'support': 26493}, 'weighted avg': {'precision': 0.44973456945102064, 'recall': 0.4444947722039784, 'f1-score': 0.44604064732223375, 'support': 26493}}
[[3381 2226 1984]
 [3022 5061 2789]
 [2221 2475 3334]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7655061
{'0': {'precision': 0.4599058182873212, 'recall': 0.5823654090716405, 'f1-score': 0.5139415403032722, 'support': 106155}, '1': {'precision': 0.8267165114689373, 'recall': 0.7491556615655088, 'f1-score': 0.7860274020627731, 'support': 389062}, '2': {'precision': 0.47173946543841927, 'recall': 0.5075204244227279, 'f1-score': 0.4889762486855358, 'support': 108571}, 'accuracy': 0.6763814451429973, 'macro avg': {'precision': 0.586120598398226, 'recall': 0.6130138316866258, 'f1-score': 0.5963150636838604, 'support': 603788}, 'weighted avg': {'precision': 0.6983949780842497, 'recall': 0.6763814451429973, 'f1-score': 0.6847759438880497, 'support': 603788}}
[[ 61821  30100  14234]
 [ 50124 291468  47470]
 [ 22476  30993  55102]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79910356
{'0': {'precision': 0.49227733760828685, 'recall': 0.5241080513342304, 'f1-score': 0.5076942642757216, 'support': 30467}, '1': {'precision': 0.7782968833800131, 'recall': 0.7233224784563922, 'f1-score': 0.7498033722378823, 'support': 90282}, '2': {'precision': 0.46750865756773274, 'recall': 0.5362865536119642, 'f1-score': 0.49954134859061855, 'support': 29956}, 'accuracy': 0.6458710726253276, 'macro avg': {'precision': 0.5793609595186776, 'recall': 0.5945723611341956, 'f1-score': 0.5856796617014075, 'support': 150705}, 'weighted avg': {'precision': 0.6586981335478254, 'recall': 0.6458710726253276, 'f1-score': 0.6511126362127962, 'support': 150705}}
[[15968  9944  4555]
 [11236 65303 13743]
 [ 5233  8658 16065]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81043303
{'0': {'precision': 0.5150155649148508, 'recall': 0.4598217935093599, 'f1-score': 0.48585618656877566, 'support': 12233}, '1': {'precision': 0.7623276024938598, 'recall': 0.7053990268348824, 'f1-score': 0.7327592729914193, 'support': 34321}, '2': {'precision': 0.44838909541511773, 'recall': 0.590004891570194, 'f1-score': 0.5095402379778919, 'support': 12266}, 'accuracy': 0.6302618157089426, 'macro avg': {'precision': 0.5752440876079428, 'recall': 0.5850752373048121, 'f1-score': 0.5760518991793623, 'support': 58820}, 'weighted avg': {'precision': 0.645426244392332, 'recall': 0.6302618157089426, 'f1-score': 0.6348611067268132, 'support': 58820}}
[[ 5625  4337  2271]
 [ 3479 24210  6632]
 [ 1818  3211  7237]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9754566
{'0': {'precision': 0.5346509034128931, 'recall': 0.4494389607272509, 'f1-score': 0.4883556982709791, 'support': 133324}, '1': {'precision': 0.4970823543119017, 'recall': 0.7045309113427598, 'f1-score': 0.5828994970440307, 'support': 145335}, '2': {'precision': 0.5567861087249969, 'recall': 0.39686716426613794, 'f1-score': 0.46341816324793594, 'support': 137192}, 'accuracy': 0.5212467927214315, 'macro avg': {'precision': 0.5295064554832639, 'recall': 0.5169456787787162, 'f1-score': 0.5115577861876486, 'support': 415851}, 'weighted avg': {'precision': 0.5288236912710095, 'recall': 0.5212467927214315, 'f1-score': 0.5131705783357141, 'support': 415851}}
[[ 59921  49767  23636]
 [ 23237 102393  19705]
 [ 28917  53828  54447]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9899771
{'0': {'precision': 0.5084006462035541, 'recall': 0.49727423560085326, 'f1-score': 0.5027758916803132, 'support': 37971}, '1': {'precision': 0.49072219186952387, 'recall': 0.6254448857481818, 'f1-score': 0.5499529441112107, 'support': 38774}, '2': {'precision': 0.5371915129279015, 'recall': 0.400981785299057, 'f1-score': 0.4591987691579384, 'support': 38705}, 'accuracy': 0.5080381117366826, 'macro avg': {'precision': 0.5121047836669931, 'recall': 0.5079003022160307, 'f1-score': 0.5039758683164874, 'support': 115450}, 'weighted avg': {'precision': 0.5121155540270116, 'recall': 0.5080381117366826, 'f1-score': 0.5040109761647402, 'support': 115450}}
[[18882 11863  7226]
 [ 8378 24251  6145]
 [ 9880 13305 15520]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0110964
{'0': {'precision': 0.531986531986532, 'recall': 0.4253028263795424, 'f1-score': 0.4727000747943157, 'support': 14860}, '1': {'precision': 0.44532434709351304, 'recall': 0.7082468010986802, 'f1-score': 0.5468228722166187, 'support': 14927}, '2': {'precision': 0.5597179837945911, 'recall': 0.34683098591549294, 'f1-score': 0.42827811103506574, 'support': 15336}, 'accuracy': 0.49223234270771005, 'macro avg': {'precision': 0.5123429542915454, 'recall': 0.4934602044645719, 'f1-score': 0.482600352682, 'support': 45123}, 'weighted avg': {'precision': 0.5127431995624977, 'recall': 0.49223234270771005, 'f1-score': 0.48212266994337183, 'support': 45123}}
[[ 6320  6309  2231]
 [ 2402 10572  1953]
 [ 3158  6859  5319]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1319287
{'0': {'precision': 0.38027376425855514, 'recall': 0.44281311986398414, 'f1-score': 0.4091675258153731, 'support': 112928}, '1': {'precision': 0.44809428284854563, 'recall': 0.1069728926180523, 'f1-score': 0.17271401992606256, 'support': 100231}, '2': {'precision': 0.37651769263476165, 'recall': 0.5712826486268536, 'f1-score': 0.45388889482133254, 'support': 111605}, 'accuracy': 0.38331218977472875, 'macro avg': {'precision': 0.4016285799139541, 'recall': 0.37368955370296336, 'f1-score': 0.3452568135209228, 'support': 324764}, 'weighted avg': {'precision': 0.3999142478873436, 'recall': 0.38331218977472875, 'f1-score': 0.35156002325695723, 'support': 324764}}
[[50006  6390 56532]
 [40463 10722 49046]
 [41031  6816 63758]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1425666
{'0': {'precision': 0.38479919125080414, 'recall': 0.40603180760279284, 'f1-score': 0.39513046760722875, 'support': 41248}, '1': {'precision': 0.41735434890245915, 'recall': 0.24566473988439305, 'f1-score': 0.30927992661672526, 'support': 41174}, '2': {'precision': 0.366067793610054, 'recall': 0.49437047307149856, 'f1-score': 0.42065332357009194, 'support': 41833}, 'accuracy': 0.3826324896382439, 'macro avg': {'precision': 0.3894071112544391, 'recall': 0.38202234018622816, 'f1-score': 0.37502123926468195, 'support': 124255}, 'weighted avg': {'precision': 0.38928058438302204, 'recall': 0.3826324896382439, 'f1-score': 0.37527523006146773, 'support': 124255}}
[[16748  6776 17724]
 [12969 10115 18090]
 [13807  7345 20681]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1351861
{'0': {'precision': 0.37726611089056505, 'recall': 0.38194118829124524, 'f1-score': 0.3795892554005925, 'support': 14929}, '1': {'precision': 0.3884649152427906, 'recall': 0.38259944126646267, 'f1-score': 0.3855098689722195, 'support': 15034}, '2': {'precision': 0.3934226552984166, 'recall': 0.3944847978402006, 'f1-score': 0.39395301065605337, 'support': 15557}, 'accuracy': 0.38644551845342706, 'macro avg': {'precision': 0.3863845604772574, 'recall': 0.3863418091326362, 'f1-score': 0.3863507116762885, 'support': 45520}, 'weighted avg': {'precision': 0.3864864576828389, 'recall': 0.38644551845342706, 'f1-score': 0.38645365445474555, 'support': 45520}}
[[5702 4342 4885]
 [4705 5752 4577]
 [4707 4713 6137]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0698519
{'0': {'precision': 0.4157315566674075, 'recall': 0.566466416412539, 'f1-score': 0.4795325821260359, 'support': 141989}, '1': {'precision': 0.46980497217305334, 'recall': 0.37463837687646634, 'f1-score': 0.4168591591644705, 'support': 157277}, '2': {'precision': 0.460524943228778, 'recall': 0.3978758509768035, 'f1-score': 0.42691422216767266, 'support': 144246}, 'accuracy': 0.44360919208499433, 'macro avg': {'precision': 0.448687157356413, 'recall': 0.4463268814219363, 'f1-score': 0.4411019878193931, 'support': 443512}, 'weighted avg': {'precision': 0.44947533678702756, 'recall': 0.44360919208499433, 'f1-score': 0.4401941292912081, 'support': 443512}}
[[80432 30918 30639]
 [61763 58922 36592]
 [51276 35578 57392]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0505933
{'0': {'precision': 0.44604734191544637, 'recall': 0.4716263081975263, 'f1-score': 0.4584803347530003, 'support': 65166}, '1': {'precision': 0.46152549278559085, 'recall': 0.5115706855202915, 'f1-score': 0.4852612064317421, 'support': 64214}, '2': {'precision': 0.4778212772070972, 'recall': 0.40080441070137385, 'f1-score': 0.43593734639709014, 'support': 66384}, 'accuracy': 0.4607128992051654, 'macro avg': {'precision': 0.4617980373027115, 'recall': 0.46133380147306385, 'f1-score': 0.45989296252727757, 'support': 195764}, 'weighted avg': {'precision': 0.46189905571561607, 'recall': 0.4607128992051654, 'f1-score': 0.459620550292936, 'support': 195764}}
[[30734 18849 15583]
 [17870 32850 13494]
 [20299 19478 26607]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.041701
{'0': {'precision': 0.45077482143603026, 'recall': 0.5032643163588882, 'f1-score': 0.4755756307149939, 'support': 21444}, '1': {'precision': 0.4842915811088296, 'recall': 0.44127414752794797, 'f1-score': 0.461783205658484, 'support': 21379}, '2': {'precision': 0.4668732685354745, 'recall': 0.4541219456496917, 'f1-score': 0.4604093350620485, 'support': 21895}, 'accuracy': 0.46616088259834976, 'macro avg': {'precision': 0.4673132236934448, 'recall': 0.4662201365121759, 'f1-score': 0.46592272381184213, 'support': 64718}, 'weighted avg': {'precision': 0.46729310544182634, 'recall': 0.46616088259834976, 'f1-score': 0.46588846024303304, 'support': 64718}}
[[10792  4778  5874]
 [ 6465  9434  5480]
 [ 6684  5268  9943]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
4693/4693 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67972714
{'0': {'precision': 0.513590701385363, 'recall': 0.5951096520026264, 'f1-score': 0.5513532716738815, 'support': 190375}, '1': {'precision': 0.8523038844511975, 'recall': 0.8234072876352982, 'f1-score': 0.8376064341245133, 'support': 818839}, '2': {'precision': 0.5405729119948502, 'recall': 0.5336601068872475, 'f1-score': 0.537094267118566, 'support': 191978}, 'accuracy': 0.7409165229205655, 'macro avg': {'precision': 0.6354891659438037, 'recall': 0.6507256821750574, 'f1-score': 0.6420179909723203, 'support': 1201192}, 'weighted avg': {'precision': 0.7488000225736767, 'recall': 0.7409165229205655, 'f1-score': 0.7442098991833825, 'support': 1201192}}
[[113294  55402  21679]
 [ 79208 674238  65393]
 [ 28090  61437 102451]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74159676
{'0': {'precision': 0.5057234169881711, 'recall': 0.5894277573311172, 'f1-score': 0.5443767518040584, 'support': 67384}, '1': {'precision': 0.8272871732687787, 'recall': 0.7655224654471215, 'f1-score': 0.7952072879519467, 'support': 246868}, '2': {'precision': 0.4890187069248441, 'recall': 0.5406766622639593, 'f1-score': 0.5135518914745782, 'support': 68897}, 'accuracy': 0.6941216080428241, 'macro avg': {'precision': 0.607343099060598, 'recall': 0.6318756283473993, 'f1-score': 0.6177119770768611, 'support': 383149}, 'weighted avg': {'precision': 0.7099074210603413, 'recall': 0.6941216080428241, 'f1-score': 0.7004473467831311, 'support': 383149}}
[[ 39718  17788   9878]
 [ 28839 188983  29046]
 [  9980  21666  37251]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7199462
{'0': {'precision': 0.5124026590693257, 'recall': 0.5844454072790295, 'f1-score': 0.546058091286307, 'support': 23080}, '1': {'precision': 0.8372889197316679, 'recall': 0.7805824823972137, 'f1-score': 0.8079419199669645, 'support': 92741}, '2': {'precision': 0.4997042295178941, 'recall': 0.5628852240546394, 'f1-score': 0.5294163728946337, 'support': 24012}, 'accuracy': 0.710826485879585, 'macro avg': {'precision': 0.6164652694396292, 'recall': 0.6426377045769609, 'f1-score': 0.627805461382635, 'support': 139833}, 'weighted avg': {'precision': 0.7256953868924955, 'recall': 0.710826485879585, 'f1-score': 0.7168887765583958, 'support': 139833}}
[[13489  6696  2895]
 [ 9712 72392 10637]
 [ 3124  7372 13516]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
6677/6677 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7623307
{'0': {'precision': 0.421635000611139, 'recall': 0.505587786259542, 'f1-score': 0.4598107587238525, 'support': 245625}, '1': {'precision': 0.8577064107392713, 'recall': 0.7244988704443798, 'f1-score': 0.7854951985606181, 'support': 1213309}, '2': {'precision': 0.3832204780958244, 'recall': 0.5967997060139324, 'f1-score': 0.46673705781654157, 'support': 250352}, 'accuracy': 0.6743377059193136, 'macro avg': {'precision': 0.5541872964820782, 'recall': 0.6089621209059515, 'f1-score': 0.5706810050336707, 'support': 1709286}, 'weighted avg': {'precision': 0.7255468175981149, 'recall': 0.6743377059193136, 'f1-score': 0.6920070528749538, 'support': 1709286}}
[[124185  79250  42190]
 [135988 879041 198280]
 [ 34359  66583 149410]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8428611
{'0': {'precision': 0.5097810297040292, 'recall': 0.42168079616660525, 'f1-score': 0.46156453116111307, 'support': 135650}, '1': {'precision': 0.6672738090267629, 'recall': 0.8372542278539037, 'f1-score': 0.7426618900398037, 'support': 305415}, '2': {'precision': 0.5572233545138473, 'recall': 0.3373642645607108, 'f1-score': 0.4202768810641203, 'support': 137768}, 'accuracy': 0.6208854712844637, 'macro avg': {'precision': 0.5780927310815464, 'recall': 0.5320997628604065, 'f1-score': 0.5415011007550122, 'support': 578833}, 'weighted avg': {'precision': 0.6041721432052493, 'recall': 0.6208854712844637, 'f1-score': 0.6000556553426521, 'support': 578833}}
[[ 57201  63015  15434]
 [ 28207 255710  21498]
 [ 26799  64491  46478]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81914425
{'0': {'precision': 0.516700458862448, 'recall': 0.42357572443958447, 'f1-score': 0.4655265656359288, 'support': 45725}, '1': {'precision': 0.6843955983342067, 'recall': 0.8326999706388155, 'f1-score': 0.751299003561143, 'support': 119205}, '2': {'precision': 0.5566382041041179, 'recall': 0.346678389158125, 'f1-score': 0.4272575913739793, 'support': 46634}, 'accuracy': 0.6371452610084891, 'macro avg': {'precision': 0.5859114204335909, 'recall': 0.5343180280788417, 'f1-score': 0.5480277201903504, 'support': 211564}, 'weighted avg': {'precision': 0.6199909804650412, 'recall': 0.6371452610084891, 'f1-score': 0.6181086122844295, 'support': 211564}}
[[19368 22176  4181]
 [11247 99262  8696]
 [ 6869 23598 16167]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
5633/5633 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79795116
{'0': {'precision': 0.4836148092696684, 'recall': 0.5037983448628226, 'f1-score': 0.4935002930465648, 'support': 297498}, '1': {'precision': 0.7481995582071176, 'recall': 0.7818677420117783, 'f1-score': 0.7646632263377152, 'support': 845620}, '2': {'precision': 0.5155610518513745, 'recall': 0.4284571298490874, 'f1-score': 0.4679905807329185, 'support': 298716}, 'accuracy': 0.6512740024163669, 'macro avg': {'precision': 0.5824584731093868, 'recall': 0.5713744055745628, 'f1-score': 0.5753847000390662, 'support': 1441834}, 'weighted avg': {'precision': 0.6454094466520042, 'recall': 0.6512740024163669, 'f1-score': 0.6472493657041518, 'support': 1441834}}
[[149879 111691  35928]
 [100124 661163  84333]
 [ 59911 110818 127987]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9625936
{'0': {'precision': 0.49263987530049724, 'recall': 0.4185966254092321, 'f1-score': 0.4526100286417362, 'support': 107213}, '1': {'precision': 0.5594539620848527, 'recall': 0.6654875911296263, 'f1-score': 0.6078815247939997, 'support': 157468}, '2': {'precision': 0.49571427046529254, 'recall': 0.4323458767013611, 'f1-score': 0.4618666613624271, 'support': 107414}, 'accuracy': 0.5270482000564372, 'macro avg': {'precision': 0.5159360359502142, 'recall': 0.5054766977467399, 'f1-score': 0.5074527382660544, 'support': 372095}, 'weighted avg': {'precision': 0.5218026259421081, 'recall': 0.5270482000564372, 'f1-score': 0.520991984602351, 'support': 372095}}
[[ 44879  41836  20498]
 [ 25930 104793  26745]
 [ 20290  40684  46440]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93909156
{'0': {'precision': 0.49681439961006857, 'recall': 0.3665836052097516, 'f1-score': 0.4218773096821877, 'support': 38927}, '1': {'precision': 0.5819398838090427, 'recall': 0.7259922166727064, 'f1-score': 0.6460332704750822, 'support': 63469}, '2': {'precision': 0.5167787179784398, 'recall': 0.44565787829563913, 'f1-score': 0.47859050226104694, 'support': 40015}, 'accuracy': 0.548981469128087, 'macro avg': {'precision': 0.5318443337991837, 'recall': 0.5127445667260323, 'f1-score': 0.5155003608061056, 'support': 142411}, 'weighted avg': {'precision': 0.5403623106291267, 'recall': 0.548981469128087, 'f1-score': 0.5377133973201319, 'support': 142411}}
[[14270 17558  7099]
 [ 7815 46078  9576]
 [ 6638 15544 17833]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
11876/11876 - 167s - 167s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9936485
{'0': {'precision': 0.5708568943018704, 'recall': 0.3678888515132055, 'f1-score': 0.4474308153391745, 'support': 981030}, '1': {'precision': 0.47016004176839665, 'recall': 0.7306622241983202, 'f1-score': 0.5721549168162966, 'support': 1066074}, '2': {'precision': 0.5261914936386667, 'recall': 0.3980283065892624, 'f1-score': 0.4532235927060245, 'support': 993055}, 'accuracy': 0.5049453005582931, 'macro avg': {'precision': 0.5224028099029779, 'recall': 0.49885979410026265, 'f1-score': 0.4909364416204986, 'support': 3040159}, 'weighted avg': {'precision': 0.5209563806039459, 'recall': 0.5049453005582931, 'f1-score': 0.49305924078868507, 'support': 3040159}}
[[360910 433494 186626]
 [117845 778940 169289]
 [153470 444321 395264]]
Evaluating performance on  train set...
2538/2538 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90665597
{'0': {'precision': 0.506300712038417, 'recall': 0.3793368692038088, 'f1-score': 0.4337181055729915, 'support': 161205}, '1': {'precision': 0.6455542512698877, 'recall': 0.7394342362743529, 'f1-score': 0.6893124658498844, 'support': 325012}, '2': {'precision': 0.4814393745848449, 'recall': 0.4612870850876334, 'f1-score': 0.4711478360877066, 'support': 163408}, 'accuracy': 0.5801100634981721, 'macro avg': {'precision': 0.5444314459643832, 'recall': 0.5266860635219317, 'f1-score': 0.5313928025035275, 'support': 649625}, 'weighted avg': {'precision': 0.5697165748240017, 'recall': 0.5801100634981721, 'f1-score': 0.5710089297042397, 'support': 649625}}
[[ 61151  68325  31729]
 [ 35226 240325  49461]
 [ 24403  63627  75378]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9166804
{'0': {'precision': 0.4724976015350176, 'recall': 0.46990538284169514, 'f1-score': 0.47119792704803665, 'support': 50308}, '1': {'precision': 0.6607000557813372, 'recall': 0.6520166324253654, 'f1-score': 0.6563296243339385, 'support': 101729}, '2': {'precision': 0.4594400845155448, 'recall': 0.4738593248370464, 'f1-score': 0.4665383178644291, 'support': 51395}, 'accuracy': 0.5619715678949231, 'macro avg': {'precision': 0.5308792472772998, 'recall': 0.5319271133680357, 'f1-score': 0.5313552897488014, 'support': 203432}, 'weighted avg': {'precision': 0.5633120082203377, 'recall': 0.5619715678949231, 'f1-score': 0.562598403960253, 'support': 203432}}
[[23640 16642 10026]
 [16772 66329 18628]
 [ 9620 17421 24354]]
testing model on single stock: results/universal/W0/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
19053/19053 - 274s - 274s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95537513
{'0': {'precision': 0.4349771611869919, 'recall': 0.3897167813976308, 'f1-score': 0.411104994194567, 'support': 1247411}, '1': {'precision': 0.5836714098788519, 'recall': 0.6966681789364333, 'f1-score': 0.6351835118897105, 'support': 2395957}, '2': {'precision': 0.45586591558059175, 'recall': 0.3324679134223549, 'f1-score': 0.3845091614174132, 'support': 1234083}, 'accuracy': 0.5260159456240565, 'macro avg': {'precision': 0.49150482888214514, 'recall': 0.4729509579188063, 'f1-score': 0.4769325558338969, 'support': 4877451}, 'weighted avg': {'precision': 0.5133056739083539, 'recall': 0.5260159456240565, 'f1-score': 0.5144501693526925, 'support': 4877451}}
[[ 486137  591059  170215]
 [ 407248 1669187  319522]
 [ 224230  599560  410293]]
Evaluating performance on  train set...
4812/4812 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0962865
{'0': {'precision': 0.4376972228316662, 'recall': 0.3972667063294998, 'f1-score': 0.41650310393310924, 'support': 406762}, '1': {'precision': 0.38398458945952035, 'recall': 0.5947552103814392, 'f1-score': 0.46667528044601375, 'support': 406880}, '2': {'precision': 0.4665900946825489, 'recall': 0.25934303462721114, 'f1-score': 0.3333830244034382, 'support': 418226}, 'accuracy': 0.41567034779700424, 'macro avg': {'precision': 0.42942396899124513, 'recall': 0.41712165044605004, 'f1-score': 0.405520469594187, 'support': 1231868}, 'weighted avg': {'precision': 0.4297654914742874, 'recall': 0.41567034779700424, 'f1-score': 0.40485500267404123, 'support': 1231868}}
[[161593 184363  60806]
 [101695 241994  63191]
 [105901 203861 108464]]
Evaluating performance on  val set...
1767/1767 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0973862
{'0': {'precision': 0.44723410390733886, 'recall': 0.3152025905577422, 'f1-score': 0.36978636826042727, 'support': 147613}, '1': {'precision': 0.379049958868686, 'recall': 0.6660875765727806, 'f1-score': 0.48315261856174235, 'support': 154265}, '2': {'precision': 0.4597214123744736, 'recall': 0.23587408170727653, 'f1-score': 0.3117799551825651, 'support': 150415}, 'accuracy': 0.4084984733347631, 'macro avg': {'precision': 0.4286684917168328, 'recall': 0.4057214162792664, 'f1-score': 0.3882396473349116, 'support': 452293}, 'weighted avg': {'precision': 0.428131113962096, 'recall': 0.4084984733347631, 'f1-score': 0.3891618836445383, 'support': 452293}}
[[ 46528  81513  19572]
 [ 29387 102754  22124]
 [ 28120  86816  35479]]
training model: results/universal/W0/deepLOB_L2/h30
Epoch 1/50
8838/8838 - 381s - loss: 3.0937 - accuracy30: 0.4514 - val_loss: 3.2300 - val_accuracy30: 0.4026 - 381s/epoch - 43ms/step
Epoch 2/50
8838/8838 - 377s - loss: 3.0469 - accuracy30: 0.4676 - val_loss: 3.2652 - val_accuracy30: 0.4044 - 377s/epoch - 43ms/step
Epoch 3/50
8838/8838 - 379s - loss: 3.0008 - accuracy30: 0.4810 - val_loss: 3.2197 - val_accuracy30: 0.4201 - 379s/epoch - 43ms/step
Epoch 4/50
8838/8838 - 375s - loss: 2.9652 - accuracy30: 0.4895 - val_loss: 3.1861 - val_accuracy30: 0.4384 - 375s/epoch - 42ms/step
Epoch 5/50
8838/8838 - 374s - loss: 2.9404 - accuracy30: 0.4955 - val_loss: 3.1534 - val_accuracy30: 0.4421 - 374s/epoch - 42ms/step
Epoch 6/50
8838/8838 - 372s - loss: 2.9238 - accuracy30: 0.4993 - val_loss: 3.1627 - val_accuracy30: 0.4440 - 372s/epoch - 42ms/step
Epoch 7/50
8838/8838 - 374s - loss: 2.9114 - accuracy30: 0.5021 - val_loss: 3.1464 - val_accuracy30: 0.4484 - 374s/epoch - 42ms/step
Epoch 8/50
8838/8838 - 371s - loss: 2.9017 - accuracy30: 0.5043 - val_loss: 3.1692 - val_accuracy30: 0.4467 - 371s/epoch - 42ms/step
Epoch 9/50
8838/8838 - 367s - loss: 2.8939 - accuracy30: 0.5063 - val_loss: 3.1549 - val_accuracy30: 0.4521 - 367s/epoch - 42ms/step
Epoch 10/50
8838/8838 - 372s - loss: 2.8877 - accuracy30: 0.5079 - val_loss: 3.1628 - val_accuracy30: 0.4521 - 372s/epoch - 42ms/step
Epoch 11/50
8838/8838 - 373s - loss: 2.8829 - accuracy30: 0.5091 - val_loss: 3.1575 - val_accuracy30: 0.4528 - 373s/epoch - 42ms/step
Epoch 12/50
8838/8838 - 375s - loss: 2.8788 - accuracy30: 0.5103 - val_loss: 3.1609 - val_accuracy30: 0.4546 - 375s/epoch - 42ms/step
Epoch 13/50
8838/8838 - 372s - loss: 2.8748 - accuracy30: 0.5115 - val_loss: 3.1600 - val_accuracy30: 0.4550 - 372s/epoch - 42ms/step
Epoch 14/50
8838/8838 - 373s - loss: 2.8718 - accuracy30: 0.5123 - val_loss: 3.1785 - val_accuracy30: 0.4557 - 373s/epoch - 42ms/step
Epoch 15/50
8838/8838 - 373s - loss: 2.8686 - accuracy30: 0.5129 - val_loss: 3.1498 - val_accuracy30: 0.4561 - 373s/epoch - 42ms/step
Epoch 16/50
8838/8838 - 372s - loss: 2.8656 - accuracy30: 0.5137 - val_loss: 3.1615 - val_accuracy30: 0.4575 - 372s/epoch - 42ms/step
Epoch 17/50
8838/8838 - 373s - loss: 2.8632 - accuracy30: 0.5144 - val_loss: 3.1772 - val_accuracy30: 0.4559 - 373s/epoch - 42ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 469s - 469s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96780604
{'0': {'precision': 0.4366751860213927, 'recall': 0.34004691883456745, 'f1-score': 0.38235052307574796, 'support': 2119831}, '1': {'precision': 0.6046187985619421, 'recall': 0.6531282790968055, 'f1-score': 0.6279380686766056, 'support': 4218006}, '2': {'precision': 0.4132305612985675, 'recall': 0.438805660498903, 'f1-score': 0.42563427410730925, 'support': 2111192}, 'accuracy': 0.5210236584582678, 'macro avg': {'precision': 0.4848415152939675, 'recall': 0.477326952810092, 'f1-score': 0.47864095528655426, 'support': 8449029}, 'weighted avg': {'precision': 0.5146594208014936, 'recall': 0.5210236584582678, 'f1-score': 0.5157705941605454, 'support': 8449029}}
[[ 720842  902718  496271]
 [ 643926 2754899  819181]
 [ 285983  898806  926403]]
Evaluating performance on  train set...
8838/8838 - 134s - 134s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0476563
{'0': {'precision': 0.4264116513841251, 'recall': 0.4240919205927107, 'f1-score': 0.42524862247969086, 'support': 682154}, '1': {'precision': 0.474576304702694, 'recall': 0.5443727792061679, 'f1-score': 0.5070840653692683, 'support': 881723}, '2': {'precision': 0.4305646331020743, 'recall': 0.352884222889021, 'f1-score': 0.3878733494696657, 'support': 698195}, 'accuracy': 0.44899720256472825, 'macro avg': {'precision': 0.4438508630629645, 'recall': 0.44044964089596655, 'f1-score': 0.4400686791062083, 'support': 2262072}, 'weighted avg': {'precision': 0.44646736742171017, 'recall': 0.44899720256472825, 'f1-score': 0.4456109113333137, 'support': 2262072}}
[[289296 250422 142436]
 [218325 479986 183412]
 [170822 280991 246382]]
Evaluating performance on  val set...
3279/3279 - 48s - 48s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0370567
{'0': {'precision': 0.43683480868922586, 'recall': 0.3266534359520467, 'f1-score': 0.37379381333850314, 'support': 247908}, '1': {'precision': 0.45741942776649813, 'recall': 0.6249290943379416, 'f1-score': 0.528211944468501, 'support': 336715}, '2': {'precision': 0.4378992743285989, 'recall': 0.3332218962140222, 'f1-score': 0.3784557657516807, 'support': 254254}, 'accuracy': 0.44836847356644655, 'macro avg': {'precision': 0.4440511702614409, 'recall': 0.4282681421680035, 'f1-score': 0.4268205078528949, 'support': 838877}, 'weighted avg': {'precision': 0.4454198511439324, 'recall': 0.44836847356644655, 'f1-score': 0.43718835279100604, 'support': 838877}}
[[ 80980 120677  46251]
 [ 63790 210423  62502]
 [ 40609 128922  84723]]
testing model out of sample: results/universal/W0/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 331s - 331s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.014093
{'0': {'precision': 0.4759255699176966, 'recall': 0.41250128452170215, 'f1-score': 0.4419495154762105, 'support': 1722431}, '1': {'precision': 0.5526782137023454, 'recall': 0.5161414434963766, 'f1-score': 0.5337853380372288, 'support': 2362583}, '2': {'precision': 0.41376947577795314, 'recall': 0.505077665309457, 'f1-score': 0.4548868064277203, 'support': 1747949}, 'accuracy': 0.48222181419631843, 'macro avg': {'precision': 0.48079108646599833, 'recall': 0.47790679777584516, 'f1-score': 0.4768738866470532, 'support': 5832963}, 'weighted avg': {'precision': 0.48838729971354755, 'recall': 0.48222181419631843, 'f1-score': 0.4830235764560382, 'support': 5832963}}
[[ 710505  474612  537314]
 [ 429644 1219427  713512]
 [ 352742  512357  882850]]
Evaluating performance on  train set...
6334/6334 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.014619
{'0': {'precision': 0.44831845181433955, 'recall': 0.3977757648315776, 'f1-score': 0.4215374873155227, 'support': 473601}, '1': {'precision': 0.5490573397103293, 'recall': 0.5703054105004761, 'f1-score': 0.5594797065613056, 'support': 668903}, '2': {'precision': 0.434409363059717, 'recall': 0.4593872022341324, 'f1-score': 0.44654927008967804, 'support': 478396}, 'accuracy': 0.48715836880745267, 'macro avg': {'precision': 0.4772617181947953, 'recall': 0.475822792522062, 'f1-score': 0.4758554879888355, 'support': 1620900}, 'weighted avg': {'precision': 0.4857855947018927, 'recall': 0.48715836880745267, 'f1-score': 0.48584466302789653, 'support': 1620900}}
[[188387 155287 129927]
 [131217 381479 156207]
 [100604 158023 219769]]
Evaluating performance on  val set...
2156/2156 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0074253
{'0': {'precision': 0.44987213781646707, 'recall': 0.44064984400925056, 'f1-score': 0.44521323762613346, 'support': 156099}, '1': {'precision': 0.5784993619492331, 'recall': 0.511310592459605, 'f1-score': 0.5428338221707971, 'support': 236725}, '2': {'precision': 0.42186046511627906, 'recall': 0.5035519160157975, 'f1-score': 0.45910050444916106, 'support': 158506}, 'accuracy': 0.4890736945205231, 'macro avg': {'precision': 0.48341065496065977, 'recall': 0.48517078416155107, 'f1-score': 0.4823825214153639, 'support': 551330}, 'weighted avg': {'precision': 0.4970476251649027, 'recall': 0.4890736945205231, 'f1-score': 0.4911212201255192, 'support': 551330}}
[[ 68785  41471  45843]
 [ 52144 121040  63541]
 [ 31970  46720  79816]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
876/876 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1322852
{'0': {'precision': 0.3365747052690673, 'recall': 0.5696301323379708, 'f1-score': 0.42313412144279483, 'support': 58940}, '1': {'precision': 0.6458699726106386, 'recall': 0.21354151772522328, 'f1-score': 0.3209639520889449, 'support': 104907}, '2': {'precision': 0.3450812545977396, 'recall': 0.513364727730981, 'f1-score': 0.41272846040019734, 'support': 60308}, 'accuracy': 0.38783877227811114, 'macro avg': {'precision': 0.44250864415914853, 'recall': 0.4321787925980583, 'f1-score': 0.385608844643979, 'support': 224155}, 'weighted avg': {'precision': 0.48361693759899876, 'recall': 0.38783877227811114, 'f1-score': 0.37251775971737583, 'support': 224155}}
[[33574  5957 19409]
 [43156 22402 39349]
 [23022  6326 30960]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1192166
{'0': {'precision': 0.4022825043552459, 'recall': 0.4093852889033612, 'f1-score': 0.4058028189219237, 'support': 27639}, '1': {'precision': 0.40117746005046256, 'recall': 0.17898015083861768, 'f1-score': 0.24752860590021017, 'support': 26651}, '2': {'precision': 0.3855281356919269, 'recall': 0.5897987972381024, 'f1-score': 0.4662724324641594, 'support': 26938}, 'accuracy': 0.39362042645393214, 'macro avg': {'precision': 0.39632936669921176, 'recall': 0.3927214123266937, 'f1-score': 0.3732012857620977, 'support': 81228}, 'weighted avg': {'precision': 0.39636361285454086, 'recall': 0.39362042645393214, 'f1-score': 0.3739266727452243, 'support': 81228}}
[[11315  3745 12579]
 [ 9137  4770 12744]
 [ 7675  3375 15888]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1306596
{'0': {'precision': 0.3693049848132928, 'recall': 0.5105594664690626, 'f1-score': 0.42859364470478456, 'support': 8097}, '1': {'precision': 0.5514423076923077, 'recall': 0.1141066454436928, 'f1-score': 0.18908671282558526, 'support': 10052}, '2': {'precision': 0.3742340570391104, 'recall': 0.5928811121764141, 'f1-score': 0.45884153410935397, 'support': 8344}, 'accuracy': 0.3860642433850451, 'macro avg': {'precision': 0.431660449848237, 'recall': 0.40584907469638987, 'f1-score': 0.35884063054657456, 'support': 26493}, 'weighted avg': {'precision': 0.43996412300949855, 'recall': 0.3860642433850451, 'f1-score': 0.3472462967238846, 'support': 26493}}
[[4134  456 3507]
 [4140 1147 4765]
 [2920  477 4947]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9088222
{'0': {'precision': 0.38529290159724944, 'recall': 0.58273748302958, 'f1-score': 0.4638792733608208, 'support': 121535}, '1': {'precision': 0.8114264708258601, 'recall': 0.563827696937034, 'f1-score': 0.6653384210770382, 'support': 356256}, '2': {'precision': 0.40543659815338934, 'recall': 0.5548306705715216, 'f1-score': 0.4685126046759444, 'support': 125997}, 'accuracy': 0.565756523812994, 'macro avg': {'precision': 0.5340519901921663, 'recall': 0.5671319501793785, 'f1-score': 0.5325767663712678, 'support': 603788}, 'weighted avg': {'precision': 0.6409301222344463, 'recall': 0.565756523812994, 'f1-score': 0.5837140762626678, 'support': 603788}}
[[ 70823  20509  30203]
 [ 83075 200867  72314]
 [ 29918  26172  69907]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93103415
{'0': {'precision': 0.41858918007080237, 'recall': 0.5040771365626162, 'f1-score': 0.45737279335410175, 'support': 34951}, '1': {'precision': 0.7450628064754484, 'recall': 0.5446409938498177, 'f1-score': 0.629278982192626, 'support': 81461}, '2': {'precision': 0.40274720795630553, 'recall': 0.5762692094596565, 'f1-score': 0.47413058864457, 'support': 34293}, 'accuracy': 0.5424305762914303, 'macro avg': {'precision': 0.5221330648341854, 'recall': 0.5416624466240302, 'f1-score': 0.5202607880637659, 'support': 150705}, 'weighted avg': {'precision': 0.5914540440821254, 'recall': 0.5424305762914303, 'f1-score': 0.5541069768441721, 'support': 150705}}
[[17618  7769  9564]
 [17352 44367 19742]
 [ 7119  7412 19762]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9179881
{'0': {'precision': 0.4536963862346433, 'recall': 0.4493382666856411, 'f1-score': 0.4515068101383477, 'support': 14054}, '1': {'precision': 0.7404991372416986, 'recall': 0.5753008108815066, 'f1-score': 0.6475296715429202, 'support': 30584}, '2': {'precision': 0.4138126773888363, 'recall': 0.6168382456635171, 'f1-score': 0.4953286903346357, 'support': 14182}, 'accuracy': 0.5552193131587895, 'macro avg': {'precision': 0.536002733621726, 'recall': 0.5471591077435549, 'f1-score': 0.5314550573386345, 'support': 58820}, 'weighted avg': {'precision': 0.5932058146254721, 'recall': 0.5552193131587895, 'f1-score': 0.5639965261897113, 'support': 58820}}
[[ 6315  3171  4568]
 [ 5165 17595  7824]
 [ 2439  2995  8748]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0051217
{'0': {'precision': 0.4930229366192887, 'recall': 0.4713296398891967, 'f1-score': 0.48193229081259964, 'support': 137180}, '1': {'precision': 0.49203087242032545, 'recall': 0.528501581823411, 'f1-score': 0.5096145513036063, 'support': 139080}, '2': {'precision': 0.493644600127108, 'recall': 0.4785337163570717, 'f1-score': 0.4859717215514952, 'support': 139591}, 'accuracy': 0.4928688400412648, 'macro avg': {'precision': 0.4928994697222407, 'recall': 0.49278831268989315, 'f1-score': 0.49250618788923367, 'support': 415851}, 'weighted avg': {'precision': 0.49289982122922876, 'recall': 0.4928688400412648, 'f1-score': 0.4925464698463458, 'support': 415851}}
[[64657 36079 36444]
 [33501 73504 32075]
 [32986 39806 66799]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0292193
{'0': {'precision': 0.4533451083444622, 'recall': 0.5463205710577547, 'f1-score': 0.49550917587785903, 'support': 38525}, '1': {'precision': 0.5002831540024651, 'recall': 0.39868326740821364, 'f1-score': 0.4437418744829217, 'support': 37669}, '2': {'precision': 0.46929880784514805, 'recall': 0.4662981455064194, 'f1-score': 0.46779366478833645, 'support': 39256}, 'accuracy': 0.47093980077955827, 'macro avg': {'precision': 0.4743090233973584, 'recall': 0.47043399465746255, 'f1-score': 0.4690149050497057, 'support': 115450}, 'weighted avg': {'precision': 0.47408471570254135, 'recall': 0.47093980077955827, 'f1-score': 0.46919455847139563, 'support': 115450}}
[[21047  6755 10723]
 [12674 15018  9977]
 [12705  8246 18305]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0330489
{'0': {'precision': 0.48488680915644367, 'recall': 0.5010782199568712, 'f1-score': 0.4928495677603882, 'support': 15303}, '1': {'precision': 0.439158118146445, 'recall': 0.5116774282181619, 'f1-score': 0.4726522842639594, 'support': 14558}, '2': {'precision': 0.48100753219405523, 'recall': 0.38913641724544623, 'f1-score': 0.4302220290484987, 'support': 15262}, 'accuracy': 0.46663564036079164, 'macro avg': {'precision': 0.4683508198323147, 'recall': 0.4672973551401598, 'f1-score': 0.46524129369094874, 'support': 45123}, 'weighted avg': {'precision': 0.4688213035667548, 'recall': 0.46663564036079164, 'f1-score': 0.4651507545395946, 'support': 45123}}
[[7668 4407 3228]
 [3929 7449 3180]
 [4217 5106 5939]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1397794
{'0': {'precision': 0.3739793930277025, 'recall': 0.37248406953445135, 'f1-score': 0.3732302335571684, 'support': 110794}, '1': {'precision': 0.45191341675038815, 'recall': 0.04738147449463272, 'f1-score': 0.08577025082771413, 'support': 104429}, '2': {'precision': 0.3619510085322219, 'recall': 0.672296217854502, 'f1-score': 0.47056117314419893, 'support': 109541}, 'accuracy': 0.3690710793068197, 'macro avg': {'precision': 0.39594793943677087, 'recall': 0.36405392062786196, 'f1-score': 0.30985388584302714, 'support': 324764}, 'weighted avg': {'precision': 0.3949822470919365, 'recall': 0.3690710793068197, 'f1-score': 0.313625628110902, 'support': 324764}}
[[41269  3269 66256]
 [35917  4948 63564]
 [33165  2732 73644]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1399152
{'0': {'precision': 0.3950153636053261, 'recall': 0.3643564836123156, 'f1-score': 0.3790670127775398, 'support': 41281}, '1': {'precision': 0.38258224811514735, 'recall': 0.2172569816094191, 'f1-score': 0.2771364736548128, 'support': 41108}, '2': {'precision': 0.3594073272432123, 'recall': 0.5394114555964267, 'f1-score': 0.43138490926456535, 'support': 41866}, 'accuracy': 0.3746730513862621, 'macro avg': {'precision': 0.3790016463212286, 'recall': 0.3736749736060538, 'f1-score': 0.36252946523230595, 'support': 124255}, 'weighted avg': {'precision': 0.3789044098255464, 'recall': 0.3746730513862621, 'f1-score': 0.3629725332963821, 'support': 124255}}
[[15041  7130 19110]
 [11036  8931 21141]
 [12000  7283 22583]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1159381
{'0': {'precision': 0.3829234874161679, 'recall': 0.35470941883767537, 'f1-score': 0.3682768665256441, 'support': 14970}, '1': {'precision': 0.3944061613295501, 'recall': 0.2560021048477274, 'f1-score': 0.310478241793307, 'support': 15203}, '2': {'precision': 0.36961211843011244, 'recall': 0.5246628005473383, 'f1-score': 0.43369600344716147, 'support': 15347}, 'accuracy': 0.3790421792618629, 'macro avg': {'precision': 0.38231392239194345, 'recall': 0.3784581080775804, 'f1-score': 0.3708170372553709, 'support': 45520}, 'weighted avg': {'precision': 0.38227062080096924, 'recall': 0.3790421792618629, 'f1-score': 0.37102895357592547, 'support': 45520}}
[[5310 2868 6792]
 [4370 3892 6941]
 [4187 3108 8052]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1237433
{'0': {'precision': 0.38736139870416136, 'recall': 0.6560306001965539, 'f1-score': 0.48710538542101406, 'support': 141437}, '1': {'precision': 0.4653111791284069, 'recall': 0.20326238515754824, 'f1-score': 0.2829314982297395, 'support': 157063}, '2': {'precision': 0.42908115775009975, 'recall': 0.40053926571594073, 'f1-score': 0.41431924045395857, 'support': 145012}, 'accuracy': 0.412153447933765, 'macro avg': {'precision': 0.4272512451942227, 'recall': 0.4199440836900143, 'f1-score': 0.39478537470157077, 'support': 443512}, 'weighted avg': {'precision': 0.4286069389861445, 'recall': 0.412153447933765, 'f1-score': 0.39100194808924893, 'support': 443512}}
[[92787 15819 32831]
 [80686 31925 44452]
 [66063 20866 58083]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0816823
{'0': {'precision': 0.41779533961832643, 'recall': 0.5078690904597897, 'f1-score': 0.45844980585975903, 'support': 64747}, '1': {'precision': 0.44812990466915137, 'recall': 0.3697973818833748, 'f1-score': 0.40521270830510764, 'support': 64703}, '2': {'precision': 0.43573391973611875, 'recall': 0.4183279548813222, 'f1-score': 0.4268535686533979, 'support': 66314}, 'accuracy': 0.4319026991683864, 'macro avg': {'precision': 0.43388638800786555, 'recall': 0.4319981424081622, 'f1-score': 0.43017202760608814, 'support': 195764}, 'weighted avg': {'precision': 0.4338979752633623, 'recall': 0.4319026991683864, 'f1-score': 0.4301510747489254, 'support': 195764}}
[[32883 14250 17614]
 [22466 23927 18310]
 [23357 15216 27741]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901601
{'0': {'precision': 0.41843245372193777, 'recall': 0.5026732907499408, 'f1-score': 0.45670069854916706, 'support': 21135}, '1': {'precision': 0.4790462427745665, 'recall': 0.27059997279034964, 'f1-score': 0.34584287246066014, 'support': 22051}, '2': {'precision': 0.42002828222685323, 'recall': 0.5241965446776891, 'f1-score': 0.4663664159986778, 'support': 21532}, 'accuracy': 0.4307611483667604, 'macro avg': {'precision': 0.4391689929077858, 'recall': 0.4324899360726599, 'f1-score': 0.42296999566950166, 'support': 64718}, 'weighted avg': {'precision': 0.4396159890871739, 'recall': 0.4307611483667604, 'f1-score': 0.42214456741169676, 'support': 64718}}
[[10624  3025  7486]
 [ 7985  5967  8099]
 [ 6781  3464 11287]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
4693/4693 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8299483
{'0': {'precision': 0.43197456681005825, 'recall': 0.6106050008742787, 'f1-score': 0.5059869556633829, 'support': 228760}, '1': {'precision': 0.8057287402314817, 'recall': 0.6811069054342104, 'f1-score': 0.7381951199223017, 'support': 742647}, '2': {'precision': 0.484361315401135, 'recall': 0.5270840133167961, 'f1-score': 0.504820376877196, 'support': 229785}, 'accuracy': 0.6382160387348567, 'macro avg': {'precision': 0.574021540814225, 'recall': 0.6062653065417617, 'f1-score': 0.583000817487627, 'support': 1201192}, 'weighted avg': {'precision': 0.6730726632458489, 'recall': 0.6382160387348567, 'f1-score': 0.649328431677217, 'support': 1201192}}
[[139682  51063  38015]
 [145903 505822  90922]
 [ 37772  70897 121116]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89274293
{'0': {'precision': 0.44135259519874903, 'recall': 0.6214782565180403, 'f1-score': 0.5161518240287605, 'support': 79932}, '1': {'precision': 0.7846961325966851, 'recall': 0.5765270454945224, 'f1-score': 0.6646941518749725, 'support': 221719}, '2': {'precision': 0.4306606620548772, 'recall': 0.5690937200912906, 'f1-score': 0.4902929812413778, 'support': 81498}, 'accuracy': 0.5843235921273447, 'macro avg': {'precision': 0.5522364632834371, 'recall': 0.5890330073679512, 'f1-score': 0.5570463190483703, 'support': 383149}, 'weighted avg': {'precision': 0.6377629071164983, 'recall': 0.5843235921273447, 'f1-score': 0.5966093285981269, 'support': 383149}}
[[ 49676  14358  15898]
 [ 48475 127827  45417]
 [ 14403  20715  46380]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8831984
{'0': {'precision': 0.4109779054790449, 'recall': 0.6012683457148034, 'f1-score': 0.4882369385142791, 'support': 27595}, '1': {'precision': 0.7832325062275566, 'recall': 0.5791569983015573, 'f1-score': 0.6659102786258493, 'support': 83606}, '2': {'precision': 0.44342304524562287, 'recall': 0.5829142218496787, 'f1-score': 0.5036893965686349, 'support': 28632}, 'accuracy': 0.5842898314417913, 'macro avg': {'precision': 0.5458778189840748, 'recall': 0.5877798552886798, 'f1-score': 0.5526122045695877, 'support': 139833}, 'weighted avg': {'precision': 0.6401919493168853, 'recall': 0.5842898314417913, 'f1-score': 0.5976316597344506, 'support': 139833}}
[[16592  6168  4835]
 [19071 48421 16114]
 [ 4709  7233 16690]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
6677/6677 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92983454
{'0': {'precision': 0.43385047071023364, 'recall': 0.35895106589147285, 'f1-score': 0.39286273224566903, 'support': 297216}, '1': {'precision': 0.8058768250301428, 'recall': 0.5705456175745348, 'f1-score': 0.6680935686514149, 'support': 1115250}, '2': {'precision': 0.3006745274968277, 'recall': 0.6825550838892258, 'f1-score': 0.4174547327752737, 'support': 296820}, 'accuracy': 0.5532035013450061, 'macro avg': {'precision': 0.5134672744124014, 'recall': 0.5373505891184112, 'f1-score': 0.4928036778907859, 'support': 1709286}, 'weighted avg': {'precision': 0.6534586042763398, 'recall': 0.5532035013450061, 'f1-score': 0.5767117709078388, 'support': 1709286}}
[[106686  82980 107550]
 [115290 636301 363659]
 [ 23929  70295 202596]]
Evaluating performance on  train set...
2262/2262 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9687807
{'0': {'precision': 0.4414574483392872, 'recall': 0.4508846701895859, 'f1-score': 0.4461212619333628, 'support': 156499}, '1': {'precision': 0.5973345389903307, 'recall': 0.6596738624714885, 'f1-score': 0.6269583911533566, 'support': 264367}, '2': {'precision': 0.46325815720077146, 'recall': 0.37254616470528656, 'f1-score': 0.4129795580381892, 'support': 157967}, 'accuracy': 0.5248646846327006, 'macro avg': {'precision': 0.5006833815101298, 'recall': 0.4943682324554537, 'f1-score': 0.49535307037496956, 'support': 578833}, 'weighted avg': {'precision': 0.5185998217023583, 'recall': 0.5248646846327006, 'f1-score': 0.5196693730488197, 'support': 578833}}
[[ 70563  55223  30713]
 [ 52499 174396  37472]
 [ 36779  62338  58850]]
Evaluating performance on  val set...
827/827 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9599846
{'0': {'precision': 0.44782700381496465, 'recall': 0.4362359707931054, 'f1-score': 0.4419555017405782, 'support': 53549}, '1': {'precision': 0.6059108759379782, 'recall': 0.6317266567350666, 'f1-score': 0.6185495216988279, 'support': 104045}, '2': {'precision': 0.4385837440842056, 'recall': 0.413822493978136, 'f1-score': 0.4258434785924704, 'support': 53970}, 'accuracy': 0.5266585997617742, 'macro avg': {'precision': 0.49744054127904946, 'recall': 0.49392837383543603, 'f1-score': 0.49544950067729215, 'support': 211564}, 'weighted avg': {'precision': 0.5232130701937904, 'recall': 0.5266585997617742, 'f1-score': 0.5246924461982965, 'support': 211564}}
[[23360 19528 10661]
 [20389 65728 17928]
 [ 8414 23222 22334]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
5633/5633 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91530925
{'0': {'precision': 0.432163597031379, 'recall': 0.5481989216641361, 'f1-score': 0.4833143115065931, 'support': 341823}, '1': {'precision': 0.7134132765512347, 'recall': 0.6323754776584966, 'f1-score': 0.6704544975811151, 'support': 754985}, '2': {'precision': 0.4579049990118198, 'recall': 0.44991681786300164, 'f1-score': 0.4538757633038172, 'support': 345026}, 'accuracy': 0.5687575684856925, 'macro avg': {'precision': 0.5344939575314779, 'recall': 0.5434970723952115, 'f1-score': 0.5358815241305085, 'support': 1441834}, 'weighted avg': {'precision': 0.5855937021974397, 'recall': 0.5687575684856925, 'f1-score': 0.5742616527756033, 'support': 1441834}}
[[187387  87537  66899]
 [160676 477434 116875]
 [ 85539 104254 155233]]
Evaluating performance on  train set...
1454/1454 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0296414
{'0': {'precision': 0.49429453617935293, 'recall': 0.33588204073508926, 'f1-score': 0.39997432390395166, 'support': 120584}, '1': {'precision': 0.4732139442992798, 'recall': 0.5700423009895821, 'f1-score': 0.5171346289789565, 'support': 130257}, '2': {'precision': 0.4583927472494484, 'recall': 0.503727712075478, 'f1-score': 0.479992141453831, 'support': 121254}, 'accuracy': 0.47254867708515297, 'macro avg': {'precision': 0.47530040924269373, 'recall': 0.46988401793338314, 'f1-score': 0.4657003647789131, 'support': 372095}, 'weighted avg': {'precision': 0.47521572519981997, 'recall': 0.47254867708515297, 'f1-score': 0.46706318644536715, 'support': 372095}}
[[40502 42927 37155]
 [20993 74252 35012]
 [20444 39731 61079]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0243576
{'0': {'precision': 0.5185348848627682, 'recall': 0.23976661293618182, 'f1-score': 0.3279100816592666, 'support': 44047}, '1': {'precision': 0.47694618690626867, 'recall': 0.6510290097205347, 'f1-score': 0.5505543112652425, 'support': 52672}, '2': {'precision': 0.4670468821664307, 'recall': 0.5125842598266654, 'f1-score': 0.488757186531579, 'support': 45692}, 'accuracy': 0.47940819178293814, 'macro avg': {'precision': 0.48750931797848923, 'recall': 0.46779329416112736, 'f1-score': 0.4557405264853627, 'support': 142411}, 'weighted avg': {'precision': 0.4866332078998525, 'recall': 0.47940819178293814, 'f1-score': 0.46186421987634013, 'support': 142411}}
[[10561 19961 13525]
 [ 5180 34291 13201]
 [ 4626 17645 23421]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
11876/11876 - 173s - 173s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0378535
{'0': {'precision': 0.5319454303946363, 'recall': 0.379611054210055, 'f1-score': 0.44304959489570184, 'support': 1087658}, '1': {'precision': 0.3913677497080506, 'recall': 0.5381722189858476, 'f1-score': 0.4531773939658072, 'support': 846283}, '2': {'precision': 0.47674840285863085, 'recall': 0.47417507218287896, 'f1-score': 0.47545825562608063, 'support': 1106218}, 'accuracy': 0.45815827395869757, 'macro avg': {'precision': 0.4666871943204392, 'recall': 0.46398611512626053, 'f1-score': 0.45722841482919657, 'support': 3040159}, 'weighted avg': {'precision': 0.47272864378863616, 'recall': 0.45815827395869757, 'f1-score': 0.4576613398854488, 'support': 3040159}}
[[412887 333353 341418]
 [156549 455446 234288]
 [206747 374930 524541]]
Evaluating performance on  train set...
2538/2538 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0196173
{'0': {'precision': 0.4896529203209554, 'recall': 0.28186647045238494, 'f1-score': 0.35777905791642667, 'support': 186191}, '1': {'precision': 0.5314349568934713, 'recall': 0.5937941222374262, 'f1-score': 0.5608865956407334, 'support': 275513}, '2': {'precision': 0.42055728187619085, 'recall': 0.5250291345831493, 'f1-score': 0.46702199165017844, 'support': 187921}, 'accuracy': 0.4844995189532423, 'macro avg': {'precision': 0.4805483863635392, 'recall': 0.4668965757576535, 'f1-score': 0.4618958817357795, 'support': 649625}, 'weighted avg': {'precision': 0.4873854164071974, 'recall': 0.4844995189532423, 'f1-score': 0.47552053706396147, 'support': 649625}}
[[ 52481  75341  58369]
 [ 34345 163598  77570]
 [ 20354  68903  98664]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0089389
{'0': {'precision': 0.4787037995651724, 'recall': 0.39850038783073344, 'f1-score': 0.4349355657981376, 'support': 58015}, '1': {'precision': 0.5903631933163147, 'recall': 0.47317453120822145, 'f1-score': 0.5253124939501688, 'support': 86019}, '2': {'precision': 0.4119476059540798, 'recall': 0.5977810700696993, 'f1-score': 0.4877636667101675, 'support': 59398}, 'accuracy': 0.48826143379605963, 'macro avg': {'precision': 0.493671532945189, 'recall': 0.489818663036218, 'f1-score': 0.48267057548615794, 'support': 203432}, 'weighted avg': {'precision': 0.5064263063633547, 'recall': 0.48826143379605963, 'f1-score': 0.4885751924089084, 'support': 203432}}
[[23119 13844 21052]
 [15683 40702 29634]
 [ 9493 14398 35507]]
testing model on single stock: results/universal/W0/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
19053/19053 - 274s - 274s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0131085
{'0': {'precision': 0.46983039301135054, 'recall': 0.2136714558754183, 'f1-score': 0.2937500293605967, 'support': 1316919}, '1': {'precision': 0.5217743614860869, 'recall': 0.6930174904599704, 'f1-score': 0.5953262824477656, 'support': 2259689}, '2': {'precision': 0.396452641336891, 'recall': 0.38925681269761225, 'f1-score': 0.3928217759374727, 'support': 1300843}, 'accuracy': 0.4825787076077238, 'macro avg': {'precision': 0.4626857986114428, 'recall': 0.431981919677667, 'f1-score': 0.427299362581945, 'support': 4877451}, 'weighted avg': {'precision': 0.47432542116381166, 'recall': 0.4825787076077238, 'f1-score': 0.4598911817360065, 'support': 4877451}}
[[ 281388  740297  295234]
 [ 218049 1566004  475636]
 [  99477  695004  506362]]
Evaluating performance on  train set...
4812/4812 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1063623
{'0': {'precision': 0.4118318578592212, 'recall': 0.4102257983354958, 'f1-score': 0.4110272592127588, 'support': 405406}, '1': {'precision': 0.3686462681171328, 'recall': 0.5509531457986433, 'f1-score': 0.44172890507010804, 'support': 407178}, '2': {'precision': 0.4399575404436386, 'recall': 0.2303259842970397, 'f1-score': 0.30236056776358944, 'support': 419284}, 'accuracy': 0.39550990852916057, 'macro avg': {'precision': 0.40681188880666425, 'recall': 0.39716830947705956, 'f1-score': 0.3850389106821521, 'support': 1231868}, 'weighted avg': {'precision': 0.4071304017265193, 'recall': 0.39550990852916057, 'f1-score': 0.38418901818314377, 'support': 1231868}}
[[166308 178396  60702]
 [120613 224336  62229]
 [116904 205808  96572]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0961497
{'0': {'precision': 0.4347194610685922, 'recall': 0.2866233819154861, 'f1-score': 0.34546890796200114, 'support': 147242}, '1': {'precision': 0.36258819421384336, 'recall': 0.68487552537989, 'f1-score': 0.4741506084908933, 'support': 154650}, '2': {'precision': 0.441371769068636, 'recall': 0.18517829003796518, 'f1-score': 0.26089685342526064, 'support': 150401}, 'accuracy': 0.389061957624814, 'macro avg': {'precision': 0.4128931414503572, 'recall': 0.3855590657777805, 'f1-score': 0.36017212329271836, 'support': 452293}, 'weighted avg': {'precision': 0.4122681150526859, 'recall': 0.389061957624814, 'f1-score': 0.36134557068376083, 'support': 452293}}
[[ 42203  88425  16614]
 [ 30098 105916  18636]
 [ 24780  97770  27851]]
training model: results/universal/W0/deepOF_L2/h10
Epoch 1/50
8838/8838 - 209s - loss: 2.8308 - accuracy10: 0.5302 - val_loss: 2.9218 - val_accuracy10: 0.5270 - 209s/epoch - 24ms/step
Epoch 2/50
8838/8838 - 208s - loss: 2.7484 - accuracy10: 0.5493 - val_loss: 2.8991 - val_accuracy10: 0.5333 - 208s/epoch - 24ms/step
Epoch 3/50
8838/8838 - 200s - loss: 2.7235 - accuracy10: 0.5543 - val_loss: 2.8933 - val_accuracy10: 0.5390 - 200s/epoch - 23ms/step
Epoch 4/50
8838/8838 - 200s - loss: 2.7093 - accuracy10: 0.5570 - val_loss: 2.8871 - val_accuracy10: 0.5397 - 200s/epoch - 23ms/step
Epoch 5/50
8838/8838 - 200s - loss: 2.6982 - accuracy10: 0.5596 - val_loss: 2.8656 - val_accuracy10: 0.5417 - 200s/epoch - 23ms/step
Epoch 6/50
8838/8838 - 199s - loss: 2.6898 - accuracy10: 0.5613 - val_loss: 2.8605 - val_accuracy10: 0.5438 - 199s/epoch - 23ms/step
Epoch 7/50
8838/8838 - 200s - loss: 2.6833 - accuracy10: 0.5626 - val_loss: 2.8531 - val_accuracy10: 0.5450 - 200s/epoch - 23ms/step
Epoch 8/50
8838/8838 - 198s - loss: 2.6777 - accuracy10: 0.5636 - val_loss: 2.8443 - val_accuracy10: 0.5462 - 198s/epoch - 22ms/step
Epoch 9/50
8838/8838 - 201s - loss: 2.6726 - accuracy10: 0.5649 - val_loss: 2.8515 - val_accuracy10: 0.5453 - 201s/epoch - 23ms/step
Epoch 10/50
8838/8838 - 198s - loss: 2.6681 - accuracy10: 0.5658 - val_loss: 2.8370 - val_accuracy10: 0.5473 - 198s/epoch - 22ms/step
Epoch 11/50
8838/8838 - 203s - loss: 2.6631 - accuracy10: 0.5669 - val_loss: 2.8346 - val_accuracy10: 0.5487 - 203s/epoch - 23ms/step
Epoch 12/50
8838/8838 - 201s - loss: 2.6594 - accuracy10: 0.5674 - val_loss: 2.8421 - val_accuracy10: 0.5474 - 201s/epoch - 23ms/step
Epoch 13/50
8838/8838 - 200s - loss: 2.6553 - accuracy10: 0.5683 - val_loss: 2.8435 - val_accuracy10: 0.5491 - 200s/epoch - 23ms/step
Epoch 14/50
8838/8838 - 199s - loss: 2.6517 - accuracy10: 0.5687 - val_loss: 2.8257 - val_accuracy10: 0.5498 - 199s/epoch - 23ms/step
Epoch 15/50
8838/8838 - 200s - loss: 2.6488 - accuracy10: 0.5693 - val_loss: 2.8328 - val_accuracy10: 0.5489 - 200s/epoch - 23ms/step
Epoch 16/50
8838/8838 - 203s - loss: 2.6464 - accuracy10: 0.5698 - val_loss: 2.8328 - val_accuracy10: 0.5485 - 203s/epoch - 23ms/step
Epoch 17/50
8838/8838 - 205s - loss: 2.6429 - accuracy10: 0.5703 - val_loss: 2.8292 - val_accuracy10: 0.5493 - 205s/epoch - 23ms/step
Epoch 18/50
8838/8838 - 206s - loss: 2.6410 - accuracy10: 0.5705 - val_loss: 2.8271 - val_accuracy10: 0.5492 - 206s/epoch - 23ms/step
Epoch 19/50
8838/8838 - 205s - loss: 2.6377 - accuracy10: 0.5716 - val_loss: 2.8199 - val_accuracy10: 0.5500 - 205s/epoch - 23ms/step
Epoch 20/50
8838/8838 - 202s - loss: 2.6355 - accuracy10: 0.5721 - val_loss: 2.8115 - val_accuracy10: 0.5515 - 202s/epoch - 23ms/step
Epoch 21/50
8838/8838 - 202s - loss: 2.6335 - accuracy10: 0.5722 - val_loss: 2.8175 - val_accuracy10: 0.5509 - 202s/epoch - 23ms/step
Epoch 22/50
8838/8838 - 206s - loss: 2.6311 - accuracy10: 0.5727 - val_loss: 2.8165 - val_accuracy10: 0.5514 - 206s/epoch - 23ms/step
Epoch 23/50
8838/8838 - 203s - loss: 2.6291 - accuracy10: 0.5730 - val_loss: 2.8152 - val_accuracy10: 0.5514 - 203s/epoch - 23ms/step
Epoch 24/50
8838/8838 - 200s - loss: 2.6272 - accuracy10: 0.5734 - val_loss: 2.8104 - val_accuracy10: 0.5510 - 200s/epoch - 23ms/step
Epoch 25/50
8838/8838 - 198s - loss: 2.6254 - accuracy10: 0.5739 - val_loss: 2.8195 - val_accuracy10: 0.5502 - 198s/epoch - 22ms/step
Epoch 26/50
8838/8838 - 202s - loss: 2.6234 - accuracy10: 0.5743 - val_loss: 2.8188 - val_accuracy10: 0.5497 - 202s/epoch - 23ms/step
Epoch 27/50
8838/8838 - 205s - loss: 2.6222 - accuracy10: 0.5743 - val_loss: 2.8159 - val_accuracy10: 0.5517 - 205s/epoch - 23ms/step
Epoch 28/50
8838/8838 - 204s - loss: 2.6204 - accuracy10: 0.5750 - val_loss: 2.8114 - val_accuracy10: 0.5514 - 204s/epoch - 23ms/step
Epoch 29/50
8838/8838 - 201s - loss: 2.6186 - accuracy10: 0.5749 - val_loss: 2.8147 - val_accuracy10: 0.5519 - 201s/epoch - 23ms/step
Epoch 30/50
8838/8838 - 201s - loss: 2.6173 - accuracy10: 0.5755 - val_loss: 2.8149 - val_accuracy10: 0.5522 - 201s/epoch - 23ms/step
Epoch 31/50
8838/8838 - 200s - loss: 2.6160 - accuracy10: 0.5757 - val_loss: 2.8076 - val_accuracy10: 0.5526 - 200s/epoch - 23ms/step
Epoch 32/50
8838/8838 - 198s - loss: 2.6146 - accuracy10: 0.5758 - val_loss: 2.8202 - val_accuracy10: 0.5523 - 198s/epoch - 22ms/step
Epoch 33/50
8838/8838 - 199s - loss: 2.6132 - accuracy10: 0.5762 - val_loss: 2.8178 - val_accuracy10: 0.5522 - 199s/epoch - 22ms/step
Epoch 34/50
8838/8838 - 205s - loss: 2.6118 - accuracy10: 0.5768 - val_loss: 2.8054 - val_accuracy10: 0.5523 - 205s/epoch - 23ms/step
Epoch 35/50
8838/8838 - 202s - loss: 2.6108 - accuracy10: 0.5768 - val_loss: 2.8118 - val_accuracy10: 0.5538 - 202s/epoch - 23ms/step
Epoch 36/50
8838/8838 - 200s - loss: 2.6095 - accuracy10: 0.5770 - val_loss: 2.8083 - val_accuracy10: 0.5519 - 200s/epoch - 23ms/step
Epoch 37/50
8838/8838 - 200s - loss: 2.6078 - accuracy10: 0.5774 - val_loss: 2.8077 - val_accuracy10: 0.5535 - 200s/epoch - 23ms/step
Epoch 38/50
8838/8838 - 199s - loss: 2.6068 - accuracy10: 0.5774 - val_loss: 2.8122 - val_accuracy10: 0.5523 - 199s/epoch - 23ms/step
Epoch 39/50
8838/8838 - 197s - loss: 2.6052 - accuracy10: 0.5780 - val_loss: 2.8215 - val_accuracy10: 0.5521 - 197s/epoch - 22ms/step
Epoch 40/50
8838/8838 - 198s - loss: 2.6043 - accuracy10: 0.5780 - val_loss: 2.8201 - val_accuracy10: 0.5528 - 198s/epoch - 22ms/step
Epoch 41/50
8838/8838 - 199s - loss: 2.6028 - accuracy10: 0.5784 - val_loss: 2.8198 - val_accuracy10: 0.5520 - 199s/epoch - 23ms/step
Epoch 42/50
8838/8838 - 202s - loss: 2.6023 - accuracy10: 0.5787 - val_loss: 2.8176 - val_accuracy10: 0.5513 - 202s/epoch - 23ms/step
Epoch 43/50
8838/8838 - 201s - loss: 2.6009 - accuracy10: 0.5788 - val_loss: 2.8176 - val_accuracy10: 0.5537 - 201s/epoch - 23ms/step
Epoch 44/50
8838/8838 - 202s - loss: 2.6004 - accuracy10: 0.5791 - val_loss: 2.8123 - val_accuracy10: 0.5526 - 202s/epoch - 23ms/step
testing model in sample: results/universal/W0/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 261s - 261s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.831995
{'0': {'precision': 0.4366580901401409, 'recall': 0.4839997378608294, 'f1-score': 0.45911172367160036, 'support': 1739534}, '1': {'precision': 0.7278375058506157, 'recall': 0.7256531168626728, 'f1-score': 0.7267436699441796, 'support': 4986665}, '2': {'precision': 0.4635650998532121, 'recall': 0.4168452030264598, 'f1-score': 0.438965531257994, 'support': 1722805}, 'accuracy': 0.6129321278579108, 'macro avg': {'precision': 0.5426868986146562, 'recall': 0.5421660192499873, 'f1-score': 0.5416069749579248, 'support': 8449004}, 'weighted avg': {'precision': 0.6140008552651903, 'recall': 0.6129321278579108, 'f1-score': 0.6129621536558006, 'support': 8449004}}
[[ 841934  642026  255574]
 [ 792619 3618589  575457]
 [ 293578  711084  718143]]
Evaluating performance on  train set...
8838/8838 - 73s - 73s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92544264
{'0': {'precision': 0.46312697787602985, 'recall': 0.4868956484876676, 'f1-score': 0.47471397831477985, 'support': 606249}, '1': {'precision': 0.641552114318467, 'recall': 0.6264370478015605, 'f1-score': 0.6339044914746151, 'support': 1036326}, '2': {'precision': 0.4767254195136041, 'recall': 0.47157101555954806, 'f1-score': 0.47413420932187705, 'support': 619491}, 'accuracy': 0.5466272867369918, 'macro avg': {'precision': 0.5271348372360337, 'recall': 0.5283012372829253, 'f1-score': 0.527584226370424, 'support': 2262066}, 'weighted avg': {'precision': 0.5485934143802467, 'recall': 0.5466272867369918, 'f1-score': 0.5474855535330525, 'support': 2262066}}
[[295180 171804 139265]
 [205739 649193 181394]
 [136444 190913 292134]]
Evaluating performance on  val set...
3279/3279 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91431683
{'0': {'precision': 0.4612013507401406, 'recall': 0.4779735682819383, 'f1-score': 0.46943769652462886, 'support': 219736}, '1': {'precision': 0.6544810666779342, 'recall': 0.62853599525237, 'f1-score': 0.641246201355028, 'support': 394302}, '2': {'precision': 0.4755587673566304, 'recall': 0.49171840808411466, 'f1-score': 0.4835036036666434, 'support': 224836}, 'accuracy': 0.5524274205661398, 'macro avg': {'precision': 0.5304137282582351, 'recall': 0.532742657206141, 'f1-score': 0.5313958338487667, 'support': 838874}, 'weighted avg': {'precision': 0.5558981021904049, 'recall': 0.5524274205661398, 'f1-score': 0.5539640489563623, 'support': 838874}}
[[105028  63431  51277]
 [ 75826 247833  70643]
 [ 46873  67407 110556]]
testing model out of sample: results/universal/W0/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 185s - 185s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82786876
{'0': {'precision': 0.4801567539520925, 'recall': 0.43868676257244743, 'f1-score': 0.45848592960695517, 'support': 1259361}, '1': {'precision': 0.7374439856226669, 'recall': 0.72387153994081, 'f1-score': 0.7305947335185285, 'support': 3290081}, '2': {'precision': 0.46557962909299655, 'recall': 0.526999694584167, 'f1-score': 0.4943893480022205, 'support': 1283496}, 'accuracy': 0.6189784633404298, 'macro avg': {'precision': 0.561060122889252, 'recall': 0.5631859990324748, 'f1-score': 0.5611566703759014, 'support': 5832938}, 'weighted avg': {'precision': 0.6220725691062746, 'recall': 0.6189784633404298, 'f1-score': 0.6198697638906117, 'support': 5832938}}
[[ 552465  435020  271876]
 [ 403946 2381596  504539]
 [ 194182  412912  676402]]
Evaluating performance on  train set...
6334/6334 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81226397
{'0': {'precision': 0.48085758039816234, 'recall': 0.4494348748827797, 'f1-score': 0.46461554160926577, 'support': 344437}, '1': {'precision': 0.7257963772642099, 'recall': 0.7797160173384339, 'f1-score': 0.7517906364742716, 'support': 926958}, '2': {'precision': 0.4958682593248686, 'recall': 0.4300981124301496, 'f1-score': 0.46064740330780624, 'support': 349497}, 'accuracy': 0.6341471239292933, 'macro avg': {'precision': 0.5675074056624136, 'recall': 0.5530830015504544, 'f1-score': 0.5590178604637812, 'support': 1620892}, 'weighted avg': {'precision': 0.6241701296106976, 'recall': 0.6341471239292933, 'f1-score': 0.6279900287150884, 'support': 1620892}}
[[154802 131787  57848]
 [109219 722764  94975]
 [ 57908 141271 150318]]
Evaluating performance on  val set...
2156/2156 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7988987
{'0': {'precision': 0.46420351836338786, 'recall': 0.47047625856845376, 'f1-score': 0.4673188399364398, 'support': 111893}, '1': {'precision': 0.7363057138253776, 'recall': 0.7764658999286396, 'f1-score': 0.7558527321771712, 'support': 323709}, '2': {'precision': 0.4964685169842585, 'recall': 0.4142385593806166, 'f1-score': 0.45164116671691285, 'support': 115728}, 'accuracy': 0.638330945168955, 'macro avg': {'precision': 0.5656592497243412, 'recall': 0.5537269059592367, 'f1-score': 0.558270912943508, 'support': 551330}, 'weighted avg': {'precision': 0.6307387936997586, 'recall': 0.638330945168955, 'f1-score': 0.6334383544867191, 'support': 551330}}
[[ 52643  42218  17032]
 [ 40771 251349  31589]
 [ 19991  47798  47939]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
876/876 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9596566
{'0': {'precision': 0.32659042998642757, 'recall': 0.5049560208956557, 'f1-score': 0.3966436362361028, 'support': 44794}, '1': {'precision': 0.7352692495584533, 'recall': 0.5873545966228894, 'f1-score': 0.653040960558045, 'support': 133250}, '2': {'precision': 0.4005738110964333, 'recall': 0.42092135513815987, 'f1-score': 0.41049558982168916, 'support': 46106}, 'accuracy': 0.5366540263216596, 'macro avg': {'precision': 0.4874778302137714, 'recall': 0.504410657552235, 'f1-score': 0.4867267288719456, 'support': 224150}, 'weighted avg': {'precision': 0.5847547417304845, 'recall': 0.5366540263216596, 'f1-score': 0.5519128828919843, 'support': 224150}}
[[22619 13774  8401]
 [34345 78265 20640]
 [12294 14405 19407]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0345945
{'0': {'precision': 0.3678815885480004, 'recall': 0.4979307750188111, 'f1-score': 0.4231391747427315, 'support': 21264}, '1': {'precision': 0.6167747457124988, 'recall': 0.47846071346492686, 'f1-score': 0.5388840954846132, 'support': 39161}, '2': {'precision': 0.40240199410831634, 'recall': 0.426875, 'f1-score': 0.4142773824798787, 'support': 20800}, 'accuracy': 0.4703477993228686, 'macro avg': {'precision': 0.4623527761229385, 'recall': 0.46775549616124595, 'f1-score': 0.45876688423574113, 'support': 81225}, 'weighted avg': {'precision': 0.49672036187362045, 'recall': 0.4703477993228686, 'f1-score': 0.4766739431281485, 'support': 81225}}
[[10588  5889  4787]
 [12025 18737  8399]
 [ 6168  5753  8879]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0124536
{'0': {'precision': 0.3404320987654321, 'recall': 0.5382238126219909, 'f1-score': 0.4170657927905218, 'support': 6148}, '1': {'precision': 0.6616541353383458, 'recall': 0.5122607873099032, 'f1-score': 0.5774515030964196, 'support': 13743}, '2': {'precision': 0.4123593673569216, 'recall': 0.383065737655256, 'f1-score': 0.3971731448763251, 'support': 6602}, 'accuracy': 0.4860906654588004, 'macro avg': {'precision': 0.47148186715356655, 'recall': 0.47785011252905, 'f1-score': 0.4638968135877555, 'support': 26493}, 'weighted avg': {'precision': 0.5249871992018708, 'recall': 0.4860906654588004, 'f1-score': 0.49530719826383274, 'support': 26493}}
[[3309 1605 1234]
 [4333 7040 2370]
 [2078 1995 2529]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
2359/2359 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69311
{'0': {'precision': 0.385107881922133, 'recall': 0.6052023262038592, 'f1-score': 0.47069733113174966, 'support': 82194}, '1': {'precision': 0.8591219938057328, 'recall': 0.7544722719141324, 'f1-score': 0.80340360186994, 'support': 438256}, '2': {'precision': 0.4518731474671837, 'recall': 0.486625946503786, 'f1-score': 0.4686060956232847, 'support': 83333}, 'accuracy': 0.6971842532830503, 'macro avg': {'precision': 0.5653676743983499, 'recall': 0.615433514873926, 'f1-score': 0.5809023428749914, 'support': 603783}, 'weighted avg': {'precision': 0.7383859279938585, 'recall': 0.6971842532830503, 'f1-score': 0.7119036096457347, 'support': 603783}}
[[ 49744  24382   8068]
 [ 66482 330652  41122]
 [ 12943  29838  40552]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7196535
{'0': {'precision': 0.42486933116334386, 'recall': 0.5795338114754098, 'f1-score': 0.490293453724605, 'support': 23424}, '1': {'precision': 0.8316644945272683, 'recall': 0.7533063324183734, 'f1-score': 0.7905484688096449, 'support': 104194}, '2': {'precision': 0.46463734821135544, 'recall': 0.49060036385688294, 'f1-score': 0.4772660233449918, 'support': 23086}, 'accuracy': 0.6860534557808684, 'macro avg': {'precision': 0.5737237246339892, 'recall': 0.6078135025835554, 'f1-score': 0.5860359819597473, 'support': 150704}, 'weighted avg': {'precision': 0.7122120672095746, 'recall': 0.6860534557808684, 'f1-score': 0.6958886587890153, 'support': 150704}}
[[13575  7385  2464]
 [15118 78490 10586]
 [ 3258  8502 11326]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7208058
{'0': {'precision': 0.4486652977412731, 'recall': 0.5548619193736113, 'f1-score': 0.4961445669142344, 'support': 9451}, '1': {'precision': 0.8196492189640997, 'recall': 0.7489420308000501, 'f1-score': 0.7827019954203467, 'support': 39935}, '2': {'precision': 0.4581336340569495, 'recall': 0.5168027138768154, 'f1-score': 0.485702899272691, 'support': 9433}, 'accuracy': 0.6805284006868529, 'macro avg': {'precision': 0.5754827169207741, 'recall': 0.6068688880168256, 'f1-score': 0.5881831538690907, 'support': 58819}, 'weighted avg': {'precision': 0.702062290388196, 'recall': 0.6805284006868529, 'f1-score': 0.6890273880524537, 'support': 58819}}
[[ 5244  3251   956]
 [ 5216 29909  4810]
 [ 1228  3330  4875]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
1625/1625 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9027484
{'0': {'precision': 0.48990712306194295, 'recall': 0.4897924798517312, 'f1-score': 0.4898497947491352, 'support': 106833}, '1': {'precision': 0.6394485832954827, 'recall': 0.6871842354219924, 'f1-score': 0.6624575837470863, 'support': 198724}, '2': {'precision': 0.5048963646456289, 'recall': 0.43709708130457253, 'f1-score': 0.46855682127444503, 'support': 110289}, 'accuracy': 0.5701461598764928, 'macro avg': {'precision': 0.5447506903343515, 'recall': 0.538024598859432, 'f1-score': 0.5402880665902222, 'support': 415846}, 'weighted avg': {'precision': 0.5653452073731376, 'recall': 0.5701461598764928, 'f1-score': 0.5666881664282634, 'support': 415846}}
[[ 52326  35626  18881]
 [ 33773 136560  28391]
 [ 20709  41373  48207]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93003994
{'0': {'precision': 0.47817491448834215, 'recall': 0.4923265807243708, 'f1-score': 0.4851475691680729, 'support': 30951}, '1': {'precision': 0.6362219020741647, 'recall': 0.60825267447784, 'f1-score': 0.6219229878848677, 'support': 53001}, '2': {'precision': 0.47617745366150105, 'recall': 0.4975552451104902, 'f1-score': 0.48663168027823495, 'support': 31496}, 'accuracy': 0.5469735292079551, 'macro avg': {'precision': 0.5301914234080026, 'recall': 0.5327115001042336, 'f1-score': 0.5312340791103918, 'support': 115448}, 'weighted avg': {'precision': 0.5501877372555967, 'recall': 0.5469735292079551, 'f1-score': 0.5483446581686142, 'support': 115448}}
[[15238  8889  6824]
 [10348 32238 10415]
 [ 6281  9544 15671]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9331727
{'0': {'precision': 0.4714242515875416, 'recall': 0.5222343187337743, 'f1-score': 0.4955302157415869, 'support': 11941}, '1': {'precision': 0.6221392790492093, 'recall': 0.612128533462189, 'f1-score': 0.6170933093017026, 'support': 20695}, '2': {'precision': 0.49553455302176364, 'recall': 0.45767598302234325, 'f1-score': 0.47585345545378854, 'support': 12487}, 'accuracy': 0.5455975888128005, 'macro avg': {'precision': 0.5296993612195048, 'recall': 0.5306796117394356, 'f1-score': 0.5294923268323594, 'support': 45123}, 'weighted avg': {'precision': 0.5472195849503131, 'recall': 0.5455975888128005, 'f1-score': 0.5458381410903637, 'support': 45123}}
[[ 6236  3473  2232]
 [ 4441 12668  3586]
 [ 2551  4221  5715]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1597887
{'0': {'precision': 0.37645231795697687, 'recall': 0.5803436840518541, 'f1-score': 0.4566735743341776, 'support': 112778}, '1': {'precision': 0.6016100957354221, 'recall': 0.02734753624908512, 'f1-score': 0.052316890881913304, 'support': 101106}, '2': {'precision': 0.3886249769314368, 'recall': 0.5128027057497182, 'f1-score': 0.44216068248450496, 'support': 110875}, 'accuracy': 0.385122506227695, 'macro avg': {'precision': 0.45556246354127855, 'recall': 0.37349797535021917, 'f1-score': 0.3170503825668653, 'support': 324759}, 'weighted avg': {'precision': 0.4507056745809988, 'recall': 0.385122506227695, 'f1-score': 0.32583192338391265, 'support': 324759}}
[[65450   868 46460]
 [55355  2765 42986]
 [53055   963 56857]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1476904
{'0': {'precision': 0.37288287749117244, 'recall': 0.6042429385380046, 'f1-score': 0.4611726390392391, 'support': 41245}, '1': {'precision': 0.6276408450704225, 'recall': 0.05201974756195433, 'f1-score': 0.09607653783097896, 'support': 41119}, '2': {'precision': 0.40592482873541935, 'recall': 0.5233707328718071, 'f1-score': 0.45722627737226273, 'support': 41890}, 'accuracy': 0.394232781238431, 'macro avg': {'precision': 0.4688161837656714, 'recall': 0.39321113965725535, 'f1-score': 0.3381584847474936, 'support': 124254}, 'weighted avg': {'precision': 0.4683286595707247, 'recall': 0.394232781238431, 'f1-score': 0.3390220468988486, 'support': 124254}}
[[24922   612 15711]
 [22605  2139 16375]
 [19309   657 21924]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1553507
{'0': {'precision': 0.3572687405221526, 'recall': 0.5903426791277259, 'f1-score': 0.4451423464828291, 'support': 14766}, '1': {'precision': 0.5754716981132075, 'recall': 0.03687285915776748, 'f1-score': 0.06930505586063246, 'support': 14889}, '2': {'precision': 0.41966676584349893, 'recall': 0.5334720121028744, 'f1-score': 0.4697751873438801, 'support': 15864}, 'accuracy': 0.3894857092642633, 'macro avg': {'precision': 0.45080240149295303, 'recall': 0.38689585012945593, 'f1-score': 0.3280741965624472, 'support': 45519}, 'weighted avg': {'precision': 0.45038823148792634, 'recall': 0.3894857092642633, 'f1-score': 0.3307930410794992, 'support': 45519}}
[[8717  159 5890]
 [8527  549 5813]
 [7155  246 8463]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
1733/1733 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0106773
{'0': {'precision': 0.46904218785250545, 'recall': 0.518733626270047, 'f1-score': 0.4926380085434644, 'support': 144286}, '1': {'precision': 0.5244643296937854, 'recall': 0.41655256054144985, 'f1-score': 0.4643210163677065, 'support': 153366}, '2': {'precision': 0.48091904394757135, 'recall': 0.5345651503205238, 'f1-score': 0.5063250860445483, 'support': 145855}, 'accuracy': 0.48860559134354137, 'macro avg': {'precision': 0.49147518716462074, 'recall': 0.4899504457106736, 'f1-score': 0.48776137031857303, 'support': 443507}, 'weighted avg': {'precision': 0.49211323532498186, 'recall': 0.48860559134354137, 'f1-score': 0.4873471447394958, 'support': 443507}}
[[74846 29048 40392]
 [45717 63885 43764]
 [39009 28877 77969]]
Evaluating performance on  train set...
765/765 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9971012
{'0': {'precision': 0.48884020265644257, 'recall': 0.49282920469361147, 'f1-score': 0.49082659904370546, 'support': 65195}, '1': {'precision': 0.5280664598006862, 'recall': 0.5003889355611563, 'f1-score': 0.5138552725123215, 'support': 64278}, '2': {'precision': 0.49211607452841105, 'recall': 0.513176750991839, 'f1-score': 0.5024258043553711, 'support': 66291}, 'accuracy': 0.5022016305347254, 'macro avg': {'precision': 0.5030075789951799, 'recall': 0.5021316304155355, 'f1-score': 0.5023692253037993, 'support': 195764}, 'weighted avg': {'precision': 0.5028292209590025, 'recall': 0.5022016305347254, 'f1-score': 0.5023157389904338, 'support': 195764}}
[[32130 14246 18819]
 [15824 32164 16290]
 [17773 14499 34019]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9945731
{'0': {'precision': 0.4757458899939111, 'recall': 0.5462596131437893, 'f1-score': 0.5085701887611196, 'support': 21455}, '1': {'precision': 0.5386916520855676, 'recall': 0.4537415612817343, 'f1-score': 0.492580836623571, 'support': 21034}, '2': {'precision': 0.5017437181436109, 'recall': 0.5048360250123712, 'f1-score': 0.5032851216504093, 'support': 22229}, 'accuracy': 0.5019623597762601, 'macro avg': {'precision': 0.5053937534076965, 'recall': 0.5016123998126316, 'f1-score': 0.5014787156783665, 'support': 64718}, 'weighted avg': {'precision': 0.5051334928520893, 'recall': 0.5019623597762601, 'f1-score': 0.5015582015293576, 'support': 64718}}
[[11720  3792  5943]
 [ 6289  9544  5201]
 [ 6626  4381 11222]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/EXC
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66851676
{'0': {'precision': 0.3567430045395031, 'recall': 0.6652557860724886, 'f1-score': 0.464433715755522, 'support': 136794}, '1': {'precision': 0.8989941107306941, 'recall': 0.7499381577824515, 'f1-score': 0.8177291452566114, 'support': 925743}, '2': {'precision': 0.43289557699276926, 'recall': 0.5427695636494771, 'f1-score': 0.4816458714010964, 'support': 138650}, 'accuracy': 0.7163813794188582, 'macro avg': {'precision': 0.5628775640876555, 'recall': 0.6526545025014724, 'f1-score': 0.5879362441377433, 'support': 1201187}, 'weighted avg': {'precision': 0.7834406960474841, 'recall': 0.7163813794188582, 'f1-score': 0.7387017824036675, 'support': 1201187}}
[[ 91003  31136  14655]
 [147562 694250  83931]
 [ 16529  46866  75255]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6700461
{'0': {'precision': 0.41219522167554823, 'recall': 0.6129091093322525, 'f1-score': 0.4929024267018693, 'support': 49345}, '1': {'precision': 0.8718087908929797, 'recall': 0.7719270964025319, 'f1-score': 0.8188332855340676, 'support': 282949}, '2': {'precision': 0.44096348935739244, 'recall': 0.5137059031737916, 'f1-score': 0.4745633396005341, 'support': 50854}, 'accuracy': 0.7171745643980916, 'macro avg': {'precision': 0.5749891673086401, 'recall': 0.6328473696361919, 'f1-score': 0.5954330172788237, 'support': 383148}, 'weighted avg': {'precision': 0.7554312069376283, 'recall': 0.7171745643980916, 'f1-score': 0.7311633458251856, 'support': 383148}}
[[ 30244  13178   5923]
 [ 37337 218416  27196]
 [  5792  18938  26124]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64771897
{'0': {'precision': 0.40814702840321426, 'recall': 0.6108961000297708, 'f1-score': 0.4893520616221115, 'support': 16795}, '1': {'precision': 0.8811382200629971, 'recall': 0.7819342979239509, 'f1-score': 0.8285774529097553, 'support': 105537}, '2': {'precision': 0.4369296577946768, 'recall': 0.525284269470316, 'f1-score': 0.4770504138449963, 'support': 17501}, 'accuracy': 0.7292699148269721, 'macro avg': {'precision': 0.5754049687536295, 'recall': 0.6393715558080125, 'f1-score': 0.5983266427922876, 'support': 139833}, 'weighted avg': {'precision': 0.7687328428474334, 'recall': 0.7292699148269721, 'f1-score': 0.7438380483532605, 'support': 139833}}
[[10260  4589  1946]
 [13113 82523  9901]
 [ 1765  6543  9193]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/AAL
Evaluating performance on  test set...
6677/6677 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5973208
{'0': {'precision': 0.3619482472353623, 'recall': 0.5188324445691833, 'f1-score': 0.4264182802098183, 'support': 178150}, '1': {'precision': 0.8818603868325455, 'recall': 0.8412587973989135, 'f1-score': 0.8610812476461122, 'support': 1345284}, '2': {'precision': 0.46771649850205493, 'recall': 0.42926170452038503, 'f1-score': 0.4476647943122324, 'support': 185847}, 'accuracy': 0.7628581842306794, 'macro avg': {'precision': 0.570508377523321, 'recall': 0.5964509821628273, 'f1-score': 0.5783881073893876, 'support': 1709281}, 'weighted avg': {'precision': 0.7826433786964961, 'recall': 0.7628581842306794, 'f1-score': 0.770828436521717, 'support': 1709281}}
[[  92430   71174   14546]
 [ 137308 1131732   76244]
 [  25630   80440   79777]]
Evaluating performance on  train set...
2262/2262 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7309539
{'0': {'precision': 0.48649231432708007, 'recall': 0.4551865266555862, 'f1-score': 0.4703190454446187, 'support': 104087}, '1': {'precision': 0.7680287824275706, 'recall': 0.8261732753938077, 'f1-score': 0.7960406921592359, 'support': 368200}, '2': {'precision': 0.5183384680262865, 'recall': 0.41531198378134854, 'f1-score': 0.46114084132749034, 'support': 106544}, 'accuracy': 0.6838351781435341, 'macro avg': {'precision': 0.5909531882603124, 'recall': 0.5655572619435808, 'f1-score': 0.5758335263104484, 'support': 578831}, 'weighted avg': {'precision': 0.6714422291628938, 'recall': 0.6838351781435341, 'f1-score': 0.6758243271950203, 'support': 578831}}
[[ 47379  43844  12864]
 [ 35749 304197  28254]
 [ 14261  48034  44249]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69789636
{'0': {'precision': 0.46679851372408004, 'recall': 0.457208264850904, 'f1-score': 0.4619536207816855, 'support': 34072}, '1': {'precision': 0.7838736875386987, 'recall': 0.8375361574246765, 'f1-score': 0.8098169111367434, 'support': 142087}, '2': {'precision': 0.5201304117067252, 'recall': 0.3875158875864991, 'f1-score': 0.4441351180745512, 'support': 35405}, 'accuracy': 0.7009746459700138, 'macro avg': {'precision': 0.5902675376565013, 'recall': 0.5607534366206931, 'f1-score': 0.57196854999766, 'support': 211564}, 'weighted avg': {'precision': 0.6886721598542027, 'recall': 0.7009746459700138, 'f1-score': 0.6925977154685558, 'support': 211564}}
[[ 15578  15596   2898]
 [ 13324 119003   9760]
 [  4470  17215  13720]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/WBA
Evaluating performance on  test set...
5633/5633 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72995746
{'0': {'precision': 0.42362069215911236, 'recall': 0.5064061943906737, 'f1-score': 0.46132890496807233, 'support': 230402}, '1': {'precision': 0.801916601163584, 'recall': 0.7878852490792789, 'f1-score': 0.7948390058195752, 'support': 980210}, '2': {'precision': 0.4856202850370312, 'recall': 0.4270749988106411, 'f1-score': 0.4544699338869981, 'support': 231217}, 'accuracy': 0.6850444816965119, 'macro avg': {'precision': 0.5703858594532426, 'recall': 0.5737888140935312, 'f1-score': 0.5702126148915485, 'support': 1441829}, 'weighted avg': {'precision': 0.6907430713259394, 'recall': 0.6850444816965119, 'f1-score': 0.6869617818482009, 'support': 1441829}}
[[116677  90178  23547]
 [126869 772293  81048]
 [ 31882 100588  98747]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89163715
{'0': {'precision': 0.4427731673582296, 'recall': 0.5086692370604042, 'f1-score': 0.4734392501005883, 'support': 85590}, '1': {'precision': 0.6863535894239532, 'recall': 0.6517489891027012, 'f1-score': 0.6686038353899807, 'support': 201059}, '2': {'precision': 0.4645413613703029, 'recall': 0.4504002621600112, 'f1-score': 0.4573615311937345, 'support': 85444}, 'accuracy': 0.572601473287592, 'macro avg': {'precision': 0.5312227060508286, 'recall': 0.5369394961077055, 'f1-score': 0.5331348722281012, 'support': 372093}, 'weighted avg': {'precision': 0.5793895445791929, 'recall': 0.572601473287592, 'f1-score': 0.575203733010567, 'support': 372093}}
[[ 43537  28708  13345]
 [ 39005 131040  31014]
 [ 15786  31174  38484]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86089975
{'0': {'precision': 0.4309075816270061, 'recall': 0.5037523452157598, 'f1-score': 0.4644913055149581, 'support': 30914}, '1': {'precision': 0.7092740625203093, 'recall': 0.6812569445311427, 'f1-score': 0.6949832520345912, 'support': 80099}, '2': {'precision': 0.48276802454406, 'recall': 0.45106220339522884, 'f1-score': 0.46637686886649543, 'support': 31397}, 'accuracy': 0.5919738782388877, 'macro avg': {'precision': 0.5409832228971251, 'recall': 0.5453571643807105, 'f1-score': 0.5419504754720149, 'support': 142410}, 'weighted avg': {'precision': 0.5989094008766336, 'recall': 0.5919738782388877, 'f1-score': 0.5945480112015271, 'support': 142410}}
[[15573 10913  4428]
 [14786 54568 10745]
 [ 5781 11454 14162]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
11876/11876 - 94s - 94s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91082656
{'0': {'precision': 0.5547808782732497, 'recall': 0.3954778950156501, 'f1-score': 0.46177647626460766, 'support': 785298}, '1': {'precision': 0.6455034196196521, 'recall': 0.665061046676949, 'f1-score': 0.6551363033653905, 'support': 1459457}, '2': {'precision': 0.4623339391302122, 'recall': 0.5677024989973586, 'f1-score': 0.5096288303987305, 'support': 795399}, 'accuracy': 0.5699533642045764, 'macro avg': {'precision': 0.5542060790077047, 'recall': 0.5427471468966526, 'f1-score': 0.542180536676243, 'support': 3040154}, 'weighted avg': {'precision': 0.5741461620971492, 'recall': 0.5699533642045764, 'f1-score': 0.5671205041681133, 'support': 3040154}}
[[310568 285436 189294]
 [152998 970628 335831]
 [ 96237 247612 451550]]
Evaluating performance on  train set...
2538/2538 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.780113
{'0': {'precision': 0.5054601226993864, 'recall': 0.40209858467545145, 'f1-score': 0.44789344930687686, 'support': 122940}, '1': {'precision': 0.7329010863700212, 'recall': 0.833905020406743, 'f1-score': 0.7801474512284309, 'support': 402318}, '2': {'precision': 0.5057462710368803, 'recall': 0.38250808098676486, 'f1-score': 0.43557801920092293, 'support': 124366}, 'accuracy': 0.665769737571272, 'macro avg': {'precision': 0.5813691600354293, 'recall': 0.5395038953563197, 'f1-score': 0.5545396399120769, 'support': 649624}, 'weighted avg': {'precision': 0.6463711431453417, 'recall': 0.665769737571272, 'f1-score': 0.6513036446883879, 'support': 649624}}
[[ 49434  58939  14567]
 [ 34900 335495  31923]
 [ 13466  63329  47571]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78461874
{'0': {'precision': 0.4867609609425337, 'recall': 0.41447866865219324, 'f1-score': 0.4477211796246649, 'support': 38277}, '1': {'precision': 0.7325506285535814, 'recall': 0.8180816488307571, 'f1-score': 0.7729572443442474, 'support': 126150}, '2': {'precision': 0.48968624833110813, 'recall': 0.37613126522240736, 'f1-score': 0.4254621909664322, 'support': 39005}, 'accuracy': 0.6574039482480633, 'macro avg': {'precision': 0.5696659459424077, 'recall': 0.5362305275684526, 'f1-score': 0.5487135383117815, 'support': 203432}, 'weighted avg': {'precision': 0.6397382083948766, 'recall': 0.6574039482480633, 'f1-score': 0.6451351445454294, 'support': 203432}}
[[ 15865  17715   4697]
 [ 12357 103201  10592]
 [  4371  19963  14671]]
testing model on single stock: results/universal/W0/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
19053/19053 - 155s - 155s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89774144
{'0': {'precision': 0.4740779447621014, 'recall': 0.44077032970206376, 'f1-score': 0.45681780870091854, 'support': 1177366}, '1': {'precision': 0.6386312785672857, 'recall': 0.7153316150864698, 'f1-score': 0.674808956853286, 'support': 2541350}, '2': {'precision': 0.47703448938829135, 'recall': 0.3854340527991853, 'f1-score': 0.42636995455760485, 'support': 1158730}, 'accuracy': 0.5706818691585719, 'macro avg': {'precision': 0.5299145709058929, 'recall': 0.5138453325292397, 'f1-score': 0.5193322400372699, 'support': 4877446}, 'weighted avg': {'precision': 0.560519383953947, 'recall': 0.5706818691585719, 'f1-score': 0.5631666975098437, 'support': 4877446}}
[[ 518948  495503  162915]
 [ 396741 1817908  326701]
 [ 178958  533158  446614]]
Evaluating performance on  train set...
4812/4812 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0177594
{'0': {'precision': 0.49911439698485605, 'recall': 0.4497387155873059, 'f1-score': 0.47314186960424903, 'support': 406645}, '1': {'precision': 0.4636080232813901, 'recall': 0.5385806071178487, 'f1-score': 0.4982900086266763, 'support': 407005}, '2': {'precision': 0.4951174909455818, 'recall': 0.46482089441605673, 'f1-score': 0.4794910975367611, 'support': 418217}, 'accuracy': 0.48421217550271256, 'macro avg': {'precision': 0.4859466370706093, 'recall': 0.4843800723737371, 'f1-score': 0.48364099192256216, 'support': 1231867}, 'weighted avg': {'precision': 0.4860262586694321, 'recall': 0.48421217550271256, 'f1-score': 0.483606289367969, 'support': 1231867}}
[[182884 121991 101770]
 [ 91340 219205  96460]
 [ 92193 131628 194396]]
Evaluating performance on  val set...
1767/1767 - 20s - 20s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0145774
{'0': {'precision': 0.5017082442019729, 'recall': 0.4411135917732224, 'f1-score': 0.46946372512312434, 'support': 147810}, '1': {'precision': 0.4714112669627653, 'recall': 0.5236476384862391, 'f1-score': 0.496158358764639, 'support': 153842}, '2': {'precision': 0.48724297769502, 'recall': 0.4898467216760377, 'f1-score': 0.488541380463244, 'support': 150641}, 'accuracy': 0.4854176385661507, 'macro avg': {'precision': 0.4867874962865861, 'recall': 0.484869317311833, 'f1-score': 0.4847211547836691, 'support': 452293}, 'weighted avg': {'precision': 0.4865852823513405, 'recall': 0.4854176385661507, 'f1-score': 0.4848975985343177, 'support': 452293}}
[[65201 44380 38229]
 [33857 80559 39426]
 [30900 45950 73791]]
training model: results/universal/W0/deepOF_L2/h20
Epoch 1/50
8838/8838 - 221s - loss: 2.9395 - accuracy20: 0.4986 - val_loss: 2.9951 - val_accuracy20: 0.4752 - 221s/epoch - 25ms/step
Epoch 2/50
8838/8838 - 206s - loss: 2.8633 - accuracy20: 0.5178 - val_loss: 2.9536 - val_accuracy20: 0.4934 - 206s/epoch - 23ms/step
Epoch 3/50
8838/8838 - 199s - loss: 2.8428 - accuracy20: 0.5219 - val_loss: 2.9382 - val_accuracy20: 0.4987 - 199s/epoch - 23ms/step
Epoch 4/50
8838/8838 - 204s - loss: 2.8310 - accuracy20: 0.5244 - val_loss: 2.9276 - val_accuracy20: 0.5006 - 204s/epoch - 23ms/step
Epoch 5/50
8838/8838 - 205s - loss: 2.8228 - accuracy20: 0.5266 - val_loss: 2.9229 - val_accuracy20: 0.5024 - 205s/epoch - 23ms/step
Epoch 6/50
8838/8838 - 201s - loss: 2.8168 - accuracy20: 0.5280 - val_loss: 2.9220 - val_accuracy20: 0.5023 - 201s/epoch - 23ms/step
Epoch 7/50
8838/8838 - 201s - loss: 2.8117 - accuracy20: 0.5292 - val_loss: 2.9229 - val_accuracy20: 0.5029 - 201s/epoch - 23ms/step
Epoch 8/50
8838/8838 - 204s - loss: 2.8072 - accuracy20: 0.5303 - val_loss: 2.9235 - val_accuracy20: 0.5020 - 204s/epoch - 23ms/step
Epoch 9/50
8838/8838 - 201s - loss: 2.8033 - accuracy20: 0.5314 - val_loss: 2.9233 - val_accuracy20: 0.5022 - 201s/epoch - 23ms/step
Epoch 10/50
8838/8838 - 204s - loss: 2.7998 - accuracy20: 0.5321 - val_loss: 2.9220 - val_accuracy20: 0.5030 - 204s/epoch - 23ms/step
Epoch 11/50
8838/8838 - 206s - loss: 2.7965 - accuracy20: 0.5329 - val_loss: 2.9218 - val_accuracy20: 0.5023 - 206s/epoch - 23ms/step
Epoch 12/50
8838/8838 - 202s - loss: 2.7940 - accuracy20: 0.5338 - val_loss: 2.9224 - val_accuracy20: 0.5018 - 202s/epoch - 23ms/step
Epoch 13/50
8838/8838 - 203s - loss: 2.7910 - accuracy20: 0.5342 - val_loss: 2.9238 - val_accuracy20: 0.5014 - 203s/epoch - 23ms/step
Epoch 14/50
8838/8838 - 205s - loss: 2.7883 - accuracy20: 0.5349 - val_loss: 2.9332 - val_accuracy20: 0.4983 - 205s/epoch - 23ms/step
Epoch 15/50
8838/8838 - 200s - loss: 2.7860 - accuracy20: 0.5356 - val_loss: 2.9288 - val_accuracy20: 0.4984 - 200s/epoch - 23ms/step
Epoch 16/50
8838/8838 - 199s - loss: 2.7835 - accuracy20: 0.5360 - val_loss: 2.9250 - val_accuracy20: 0.4995 - 199s/epoch - 23ms/step
Epoch 17/50
8838/8838 - 200s - loss: 2.7812 - accuracy20: 0.5366 - val_loss: 2.9343 - val_accuracy20: 0.4960 - 200s/epoch - 23ms/step
Epoch 18/50
8838/8838 - 201s - loss: 2.7791 - accuracy20: 0.5372 - val_loss: 2.9335 - val_accuracy20: 0.4964 - 201s/epoch - 23ms/step
Epoch 19/50
8838/8838 - 200s - loss: 2.7770 - accuracy20: 0.5374 - val_loss: 2.9329 - val_accuracy20: 0.4956 - 200s/epoch - 23ms/step
Epoch 20/50
8838/8838 - 201s - loss: 2.7750 - accuracy20: 0.5379 - val_loss: 2.9311 - val_accuracy20: 0.4968 - 201s/epoch - 23ms/step
Epoch 21/50
8838/8838 - 201s - loss: 2.7731 - accuracy20: 0.5385 - val_loss: 2.9305 - val_accuracy20: 0.4973 - 201s/epoch - 23ms/step
testing model in sample: results/universal/W0/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 259s - 259s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9310495
{'0': {'precision': 0.4120826585263038, 'recall': 0.5632171792476097, 'f1-score': 0.475939856776317, 'support': 1954358}, '1': {'precision': 0.7300518116794178, 'recall': 0.5567188546771394, 'f1-score': 0.6317110252504242, 'support': 4549704}, '2': {'precision': 0.4210663573013479, 'recall': 0.4997485786208535, 'f1-score': 0.45704583050809205, 'support': 1944942}, 'accuracy': 0.5451075653414296, 'macro avg': {'precision': 0.5210669425023565, 'recall': 0.5398948708485343, 'f1-score': 0.5215655708449444, 'support': 8449004}, 'weighted avg': {'precision': 0.5853738891897367, 'recall': 0.5451075653414296, 'f1-score': 0.555471707282382, 'support': 8449004}}
[[1100728  472700  380930]
 [1061328 2532906  955470]
 [ 509078  463882  971982]]
Evaluating performance on  train set...
8838/8838 - 74s - 74s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9985461
{'0': {'precision': 0.42214432041979005, 'recall': 0.587722615244006, 'f1-score': 0.49135931724399207, 'support': 653201}, '1': {'precision': 0.6693878695141737, 'recall': 0.43058818538101323, 'f1-score': 0.5240668772151319, 'support': 942815}, '2': {'precision': 0.4412901859721491, 'recall': 0.4943848059454996, 'f1-score': 0.46633107615789704, 'support': 666050}, 'accuracy': 0.49474727969917764, 'macro avg': {'precision': 0.5109407919687042, 'recall': 0.5042318688568396, 'f1-score': 0.49391909020567376, 'support': 2262066}, 'weighted avg': {'precision': 0.5308312599213653, 'recall': 0.49474727969917764, 'f1-score': 0.4976222283079471, 'support': 2262066}}
[[383901  98636 170664]
 [290612 405965 246238]
 [234894 101871 329285]]
Evaluating performance on  val set...
3279/3279 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9898787
{'0': {'precision': 0.4240638055450057, 'recall': 0.5890570528999147, 'f1-score': 0.4931253235063941, 'support': 236938}, '1': {'precision': 0.6800401589268168, 'recall': 0.44257755262623766, 'f1-score': 0.5361941222342179, 'support': 359659}, '2': {'precision': 0.44511914219073634, 'recall': 0.5064863771633296, 'f1-score': 0.47382403138490525, 'support': 242277}, 'accuracy': 0.502407989757699, 'macro avg': {'precision': 0.516407702220853, 'recall': 0.5127069942298274, 'f1-score': 0.5010478257085058, 'support': 838874}, 'weighted avg': {'precision': 0.5398921934524464, 'recall': 0.502407989757699, 'f1-score': 0.5060162009568008, 'support': 838874}}
[[139570  37646  59722]
 [107235 159177  93247]
 [ 82320  37247 122710]]
testing model out of sample: results/universal/W0/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 191s - 191s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9184922
{'0': {'precision': 0.48008037865212405, 'recall': 0.504526965639236, 'f1-score': 0.4920001828314964, 'support': 1557445}, '1': {'precision': 0.7035070183512627, 'recall': 0.581105136253362, 'f1-score': 0.6364746593574465, 'support': 2693695}, '2': {'precision': 0.46238485846666, 'recall': 0.5762018917712628, 'f1-score': 0.5130568633074571, 'support': 1581798}, 'accuracy': 0.5593284207718306, 'macro avg': {'precision': 0.5486574184900156, 'recall': 0.5539446645546203, 'f1-score': 0.5471772351654667, 'support': 5832938}, 'weighted avg': {'precision': 0.5784617576048996, 'recall': 0.5593284207718306, 'f1-score': 0.5644298212245468, 'support': 5832938}}
[[ 785773  352473  419199]
 [ 487848 1565320  640527]
 [ 363132  307231  911435]]
Evaluating performance on  train set...
6334/6334 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9204389
{'0': {'precision': 0.47489524112060466, 'recall': 0.47699540870071155, 'f1-score': 0.4759430080983933, 'support': 426241}, '1': {'precision': 0.6612021065536492, 'recall': 0.6574002715695989, 'f1-score': 0.6592957082777707, 'support': 762972}, '2': {'precision': 0.4756011893657254, 'recall': 0.47835776120682266, 'f1-score': 0.4769754925738572, 'support': 431679}, 'accuracy': 0.5622768204173998, 'macro avg': {'precision': 0.5372328456799931, 'recall': 0.5375844804923776, 'f1-score': 0.5374047363166737, 'support': 1620892}, 'weighted avg': {'precision': 0.5627799766647904, 'recall': 0.5622768204173998, 'f1-score': 0.5625241487463475, 'support': 1620892}}
[[203315 132811  90115]
 [123825 501578 137569]
 [100986 124196 206497]]
Evaluating performance on  val set...
2156/2156 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91076195
{'0': {'precision': 0.4664090948864822, 'recall': 0.4956899943487063, 'f1-score': 0.4806039714521533, 'support': 139791}, '1': {'precision': 0.6700771312890651, 'recall': 0.6624749353350279, 'f1-score': 0.6662543480868417, 'support': 268306}, '2': {'precision': 0.48204740329161244, 'recall': 0.46275648768091154, 'f1-score': 0.47220500544999894, 'support': 143233}, 'accuracy': 0.5683002920211125, 'macro avg': {'precision': 0.5395112098223865, 'recall': 0.5403071391215486, 'f1-score': 0.5396877749963312, 'support': 551330}, 'weighted avg': {'precision': 0.5695873692463456, 'recall': 0.5683002920211125, 'f1-score': 0.5687691372438936, 'support': 551330}}
[[ 69293  44512  25986]
 [ 45327 177746  45233]
 [ 33947  43004  66282]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1364865
{'0': {'precision': 0.30684213370804736, 'recall': 0.6139386511912915, 'f1-score': 0.40917935905443714, 'support': 55486}, '1': {'precision': 0.6963223847076538, 'recall': 0.24425704105566598, 'f1-score': 0.3616529144712861, 'support': 111702}, '2': {'precision': 0.36356137337895034, 'recall': 0.4719813208805871, 'f1-score': 0.410737065640015, 'support': 56962}, 'accuracy': 0.39363818871291545, 'macro avg': {'precision': 0.4555752972648839, 'recall': 0.44339233770918157, 'f1-score': 0.3938564463885794, 'support': 224150}, 'weighted avg': {'precision': 0.5153478857816232, 'recall': 0.39363818871291545, 'f1-score': 0.3858910751806944, 'support': 224150}}
[[34065  6233 15188]
 [52542 27284 31876]
 [24411  5666 26885]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1279308
{'0': {'precision': 0.37565712449209154, 'recall': 0.6306702123559563, 'f1-score': 0.4708522759970075, 'support': 25947}, '1': {'precision': 0.5718377807930046, 'recall': 0.12658101117970966, 'f1-score': 0.20727908628886824, 'support': 29965}, '2': {'precision': 0.39570107312042796, 'recall': 0.4850867143365069, 'f1-score': 0.4358582990203039, 'support': 25313}, 'accuracy': 0.39933518005540164, 'macro avg': {'precision': 0.44773199280184134, 'recall': 0.41411264595739095, 'f1-score': 0.3713298871020599, 'support': 81225}, 'weighted avg': {'precision': 0.4542773256331927, 'recall': 0.39933518005540164, 'f1-score': 0.36271102430337016, 'support': 81225}}
[[16364  1476  8107]
 [15527  3793 10645]
 [11670  1364 12279]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1425207
{'0': {'precision': 0.3371363757672805, 'recall': 0.670336959405678, 'f1-score': 0.44863713042706216, 'support': 7538}, '1': {'precision': 0.6283391405342624, 'recall': 0.1489264085153239, 'f1-score': 0.24078332467917807, 'support': 10898}, '2': {'precision': 0.3991257565568258, 'recall': 0.44197592155889287, 'f1-score': 0.41945933211614345, 'support': 8057}, 'accuracy': 0.38640395576189934, 'macro avg': {'precision': 0.4548670909527896, 'recall': 0.4204130964932982, 'f1-score': 0.36962659574079454, 'support': 26493}, 'weighted avg': {'precision': 0.4757758719153926, 'recall': 0.38640395576189934, 'f1-score': 0.35426215228070224, 'support': 26493}}
[[5053  488 1997]
 [5911 1623 3364]
 [4024  472 3561]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
2359/2359 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7998154
{'0': {'precision': 0.4555995610058692, 'recall': 0.5396687830887201, 'f1-score': 0.4940835546969331, 'support': 106154}, '1': {'precision': 0.8094540025721506, 'recall': 0.694007638885319, 'f1-score': 0.7472984286673079, 'support': 389062}, '2': {'precision': 0.43303015200598055, 'recall': 0.5762248196965929, 'f1-score': 0.4944691445847413, 'support': 108567}, 'accuracy': 0.6456938999607474, 'macro avg': {'precision': 0.5660279051946667, 'recall': 0.6033004138902107, 'f1-score': 0.5786170426496607, 'support': 603783}, 'weighted avg': {'precision': 0.6795558892194321, 'recall': 0.6456938999607474, 'f1-score': 0.6573179412795491, 'support': 603783}}
[[ 57288  34360  14506]
 [ 51647 270012  67403]
 [ 16807  29201  62559]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8287218
{'0': {'precision': 0.4729296198506658, 'recall': 0.5461639344262295, 'f1-score': 0.5069153873073352, 'support': 30500}, '1': {'precision': 0.7663022351797862, 'recall': 0.6987759623373027, 'f1-score': 0.7309829369332831, 'support': 90275}, '2': {'precision': 0.46051084104821927, 'recall': 0.5102409034715494, 'f1-score': 0.4841020763987954, 'support': 29929}, 'accuracy': 0.6304477651555367, 'macro avg': {'precision': 0.5665808986928904, 'recall': 0.5850602667450272, 'f1-score': 0.5740001335464712, 'support': 150704}, 'weighted avg': {'precision': 0.6461999459074256, 'recall': 0.6304477651555367, 'f1-score': 0.6366061616749747, 'support': 150704}}
[[16658  9874  3968]
 [13271 63082 13922]
 [ 5294  9364 15271]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8248049
{'0': {'precision': 0.4960506764682881, 'recall': 0.5193220894056001, 'f1-score': 0.5074197032118715, 'support': 12214}, '1': {'precision': 0.75448950607543, 'recall': 0.6969882503863086, 'f1-score': 0.7245999030067894, 'support': 34299}, '2': {'precision': 0.47096954067052343, 'recall': 0.5490817487404518, 'f1-score': 0.5070348553633737, 'support': 12306}, 'accuracy': 0.629150444584233, 'macro avg': {'precision': 0.5738365744047472, 'recall': 0.5884640295107869, 'f1-score': 0.5796848205273448, 'support': 58819}, 'weighted avg': {'precision': 0.6415061408517028, 'recall': 0.629150444584233, 'f1-score': 0.6339830200846894, 'support': 58819}}
[[ 6343  4206  1665]
 [ 4468 23906  5925]
 [ 1976  3573  6757]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
1625/1625 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.973498
{'0': {'precision': 0.5023213983734838, 'recall': 0.4901628400627058, 'f1-score': 0.4961676442116052, 'support': 133321}, '1': {'precision': 0.5221782553579679, 'recall': 0.6065366222864417, 'f1-score': 0.5612050332803861, 'support': 145335}, '2': {'precision': 0.5237989361884076, 'recall': 0.4464756906480064, 'f1-score': 0.4820562865957313, 'support': 137190}, 'accuracy': 0.5164219446622067, 'macro avg': {'precision': 0.5160995299732863, 'recall': 0.5143917176657179, 'f1-score': 0.5131429880292409, 'support': 415846}, 'weighted avg': {'precision': 0.5163467821036853, 'recall': 0.5164219446622067, 'f1-score': 0.5142422963400122, 'support': 415846}}
[[65349 39654 28318]
 [29816 88151 27368]
 [34929 41009 61252]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98434466
{'0': {'precision': 0.47522299306243804, 'recall': 0.5561325355194138, 'f1-score': 0.5125040992068793, 'support': 37937}, '1': {'precision': 0.5393754145159895, 'recall': 0.4822989454142279, 'f1-score': 0.509242873866761, 'support': 38783}, '2': {'precision': 0.5080691721881615, 'recall': 0.4771741375748812, 'f1-score': 0.4921372551630471, 'support': 38728}, 'accuracy': 0.5048420067909362, 'macro avg': {'precision': 0.5075558599221964, 'recall': 0.5052018728361743, 'f1-score': 0.5046280760788958, 'support': 115448}, 'weighted avg': {'precision': 0.5077925498015249, 'recall': 0.5048420067909362, 'f1-score': 0.5045763114713159, 'support': 115448}}
[[21098  7884  8955]
 [11140 18705  8938]
 [12158  8090 18480]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9903099
{'0': {'precision': 0.4795758051846033, 'recall': 0.5748587570621468, 'f1-score': 0.5229122055674519, 'support': 14868}, '1': {'precision': 0.5066836409929981, 'recall': 0.479037111334002, 'f1-score': 0.4924726747783048, 'support': 14955}, '2': {'precision': 0.5113204680139797, 'recall': 0.4398692810457516, 'f1-score': 0.4729112500878364, 'support': 15300}, 'accuracy': 0.4973295215300401, 'macro avg': {'precision': 0.49919330473052703, 'recall': 0.4979217164806335, 'f1-score': 0.4960987101445311, 'support': 45123}, 'weighted avg': {'precision': 0.49932384999110996, 'recall': 0.4973295215300401, 'f1-score': 0.4958697260827144, 'support': 45123}}
[[8547 3266 3055]
 [4414 7164 3377]
 [4861 3709 6730]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2254969
{'0': {'precision': 0.3554756191275405, 'recall': 0.6677027433894763, 'f1-score': 0.46395047978857923, 'support': 112926}, '1': {'precision': 0.7773237997957099, 'recall': 0.0075925371645216, 'f1-score': 0.015038188303411753, 'support': 100230}, '2': {'precision': 0.3708078483347811, 'recall': 0.37102049228067346, 'f1-score': 0.37091413983069826, 'support': 111603}, 'accuracy': 0.36201922040651685, 'macro avg': {'precision': 0.5012024224193438, 'recall': 0.34877192427822373, 'f1-score': 0.28330093597422973, 'support': 324759}, 'weighted avg': {'precision': 0.4909390425417839, 'recall': 0.36201922040651685, 'f1-score': 0.29343137601046154, 'support': 324759}}
[[75401    80 37445]
 [66654   761 32815]
 [70058   138 41407]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2359469
{'0': {'precision': 0.3547028260658444, 'recall': 0.7079789682828136, 'f1-score': 0.47261963492846576, 'support': 41271}, '1': {'precision': 0.6624203821656051, 'recall': 0.007568406753347565, 'f1-score': 0.014965823240196664, 'support': 41224}, '2': {'precision': 0.38768807206510975, 'recall': 0.3844201250029934, 'f1-score': 0.3860471827429478, 'support': 41759}, 'accuracy': 0.36686142900832164, 'macro avg': {'precision': 0.4682704267655197, 'recall': 0.3666558333463848, 'f1-score': 0.29121088030387005, 'support': 124254}, 'weighted avg': {'precision': 0.4678805058213441, 'recall': 0.36686142900832164, 'f1-score': 0.29168783584069186, 'support': 124254}}
[[29219    72 11980]
 [27538   312 13374]
 [25619    87 16053]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2328112
{'0': {'precision': 0.3497233566065077, 'recall': 0.7129716664428629, 'f1-score': 0.4692651023023554, 'support': 14894}, '1': {'precision': 0.7014218009478673, 'recall': 0.009877202349172451, 'f1-score': 0.019480092135570913, 'support': 14984}, '2': {'precision': 0.4004282655246253, 'recall': 0.3825842337446455, 'f1-score': 0.39130292627104785, 'support': 15641}, 'accuracy': 0.36800017575078536, 'macro avg': {'precision': 0.4838578076930002, 'recall': 0.36847770084556025, 'f1-score': 0.293349373569658, 'support': 45519}, 'weighted avg': {'precision': 0.48291883476725844, 'recall': 0.36800017575078536, 'f1-score': 0.2944153694952907, 'support': 45519}}
[[10619    27  4248]
 [10124   148  4712]
 [ 9621    36  5984]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
1733/1733 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0801196
{'0': {'precision': 0.39881565166014665, 'recall': 0.6275337005056837, 'f1-score': 0.48769020251778866, 'support': 141986}, '1': {'precision': 0.5263665194950563, 'recall': 0.21527760115974465, 'f1-score': 0.30557761732851985, 'support': 157276}, '2': {'precision': 0.4430021377809449, 'recall': 0.47839439841935594, 'f1-score': 0.4600185324684848, 'support': 144245}, 'accuracy': 0.43283420554805224, 'macro avg': {'precision': 0.45606143631204926, 'recall': 0.44040190002826146, 'f1-score': 0.41776211743826447, 'support': 443507}, 'weighted avg': {'precision': 0.45841870184897743, 'recall': 0.43283420554805224, 'f1-score': 0.41410976524286564, 'support': 443507}}
[[89101 15824 37061]
 [73716 33858 49702]
 [60597 14642 69006]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502839
{'0': {'precision': 0.4213382992494351, 'recall': 0.5687963701023975, 'f1-score': 0.4840870693985115, 'support': 65236}, '1': {'precision': 0.5285647571606475, 'recall': 0.3182535343278919, 'f1-score': 0.39729326533995063, 'support': 64015}, '2': {'precision': 0.4472401775772562, 'recall': 0.46499180611309066, 'f1-score': 0.45594327244851324, 'support': 66513}, 'accuracy': 0.4515998855765105, 'macro avg': {'precision': 0.46571441132911295, 'recall': 0.45068057018112667, 'f1-score': 0.4457745357289918, 'support': 195764}, 'weighted avg': {'precision': 0.4652018969303398, 'recall': 0.4515998855765105, 'f1-score': 0.4461432506507131, 'support': 195764}}
[[37106  9304 18826]
 [24243 20373 19399]
 [26718  8867 30928]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0583919
{'0': {'precision': 0.4144871053192461, 'recall': 0.6364486418252373, 'f1-score': 0.5020283227614692, 'support': 21389}, '1': {'precision': 0.5530208333333333, 'recall': 0.24722920741361645, 'f1-score': 0.34170045697367574, 'support': 21474}, '2': {'precision': 0.4519416386083053, 'recall': 0.46062685884237015, 'f1-score': 0.45624291864944483, 'support': 21855}, 'accuracy': 0.4479279334960907, 'macro avg': {'precision': 0.47314985908696156, 'recall': 0.44810156936040796, 'f1-score': 0.4333238994615299, 'support': 64718}, 'weighted avg': {'precision': 0.47310205170830166, 'recall': 0.4479279334960907, 'f1-score': 0.43336858981552884, 'support': 64718}}
[[13613  2071  5705]
 [ 9662  5309  6503]
 [ 9568  2220 10067]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/EXC
Evaluating performance on  test set...
4693/4693 - 40s - 40s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73618793
{'0': {'precision': 0.4752768396748159, 'recall': 0.5936135901624705, 'f1-score': 0.5278946901290682, 'support': 190373}, '1': {'precision': 0.8418423089804052, 'recall': 0.7490321650924847, 'f1-score': 0.7927300081039057, 'support': 818838}, '2': {'precision': 0.47005748350010645, 'recall': 0.5750354210943035, 'f1-score': 0.5172740179839092, 'support': 191976}, 'accuracy': 0.6965917879564131, 'macro avg': {'precision': 0.5957255440517759, 'recall': 0.6392270587830863, 'f1-score': 0.6126329054056278, 'support': 1201187}, 'weighted avg': {'precision': 0.7243269414776611, 'recall': 0.6965917879564131, 'f1-score': 0.7067330458090255, 'support': 1201187}}
[[113008  55961  21404]
 [102449 613336 103053]
 [ 22316  59267 110393]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75196505
{'0': {'precision': 0.5161116930371024, 'recall': 0.5555357752162239, 'f1-score': 0.5350985617627515, 'support': 67407}, '1': {'precision': 0.8078795299778737, 'recall': 0.7613984224421373, 'f1-score': 0.7839506044163354, 'support': 246964}, '2': {'precision': 0.47162660431414366, 'recall': 0.5337540166043881, 'f1-score': 0.5007707313080607, 'support': 68777}, 'accuracy': 0.6843178093060645, 'macro avg': {'precision': 0.5985392757763733, 'recall': 0.6168960714209164, 'f1-score': 0.6066066324957159, 'support': 383148}, 'weighted avg': {'precision': 0.6961898903267703, 'recall': 0.6843178093060645, 'f1-score': 0.689337995784898, 'support': 383148}}
[[ 37447  21275   8685]
 [ 26484 188038  32442]
 [  8625  23442  36710]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72429377
{'0': {'precision': 0.5283560959360426, 'recall': 0.5488559193736753, 'f1-score': 0.538410947279092, 'support': 23119}, '1': {'precision': 0.8198784476611927, 'recall': 0.7815261130829728, 'f1-score': 0.80024302678818, 'support': 92693}, '2': {'precision': 0.48703568827385285, 'recall': 0.5567628325215437, 'f1-score': 0.5195703269167266, 'support': 24021}, 'accuracy': 0.7044474480272896, 'macro avg': {'precision': 0.6117567439570294, 'recall': 0.629048288326064, 'f1-score': 0.6194081003279995, 'support': 139833}, 'weighted avg': {'precision': 0.7145033132310006, 'recall': 0.7044474480272896, 'f1-score': 0.7087386267554067, 'support': 139833}}
[[12689  7607  2823]
 [ 8988 72442 11263]
 [ 2339  8308 13374]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/AAL
Evaluating performance on  test set...
6677/6677 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73467374
{'0': {'precision': 0.45144077257574694, 'recall': 0.47084759977689383, 'f1-score': 0.4609400065762597, 'support': 245623}, '1': {'precision': 0.8336339886895628, 'recall': 0.7903186989618465, 'f1-score': 0.8113986748029361, 'support': 1213308}, '2': {'precision': 0.43079376820304194, 'recall': 0.5211064509686439, 'f1-score': 0.47166584716839244, 'support': 250350}, 'accuracy': 0.7049806322073433, 'macro avg': {'precision': 0.5719561764894506, 'recall': 0.594090916569128, 'f1-score': 0.5813348428491961, 'support': 1709281}, 'weighted avg': {'precision': 0.7197109453044644, 'recall': 0.7049806322073433, 'f1-score': 0.7112789034697564, 'support': 1709281}}
[[115651 102898  27074]
 [109107 958900 145301]
 [ 31424  88467 130459]]
Evaluating performance on  train set...
2262/2262 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85473067
{'0': {'precision': 0.5114642999866791, 'recall': 0.4524351354735129, 'f1-score': 0.4801422458430215, 'support': 135783}, '1': {'precision': 0.7026811062853705, 'recall': 0.7346840486074026, 'f1-score': 0.7183263046114076, 'support': 305221}, '2': {'precision': 0.490053511178607, 'recall': 0.4963468696264157, 'f1-score': 0.49318011419343677, 'support': 137827}, 'accuracy': 0.6117225926047499, 'macro avg': {'precision': 0.5680663058168856, 'recall': 0.5611553512357771, 'f1-score': 0.5638828882159553, 'support': 578831}, 'weighted avg': {'precision': 0.6071958693847291, 'recall': 0.6117225926047499, 'f1-score': 0.6088425864994104, 'support': 578831}}
[[ 61433  49874  24476]
 [ 34269 224241  46711]
 [ 24410  45007  68410]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82696325
{'0': {'precision': 0.5214083783089181, 'recall': 0.4434438591506197, 'f1-score': 0.4792761720272617, 'support': 45751}, '1': {'precision': 0.7116107784897346, 'recall': 0.7666498909578929, 'f1-score': 0.7381057170890855, 'support': 119220}, '2': {'precision': 0.4986316241829326, 'recall': 0.4731612044727749, 'f1-score': 0.48556262802017486, 'support': 46593}, 'accuracy': 0.6321207766916866, 'macro avg': {'precision': 0.5772169269938617, 'recall': 0.5610849848604292, 'f1-score': 0.5676481723788407, 'support': 211564}, 'weighted avg': {'precision': 0.6235745920530567, 'recall': 0.6321207766916866, 'f1-score': 0.6265156040967462, 'support': 211564}}
[[20288 19262  6201]
 [11854 91400 15966]
 [ 6768 17779 22046]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/WBA
Evaluating performance on  test set...
5633/5633 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83901227
{'0': {'precision': 0.4699878994189062, 'recall': 0.47522655766800226, 'f1-score': 0.4725927114462785, 'support': 297496}, '1': {'precision': 0.7432876283194371, 'recall': 0.7295235797681935, 'f1-score': 0.7363412885933758, 'support': 845619}, '2': {'precision': 0.4645836615154136, 'recall': 0.48378047229122173, 'f1-score': 0.47398777573876094, 'support': 298714}, 'accuracy': 0.6261415188625004, 'macro avg': {'precision': 0.5592863964179189, 'recall': 0.5628435365758059, 'f1-score': 0.5609739252594718, 'support': 1441829}, 'weighted avg': {'precision': 0.6291559574424542, 'recall': 0.6261415188625004, 'f1-score': 0.6275677697185257, 'support': 1441829}}
[[141378 110939  45179]
 [107354 616899 121366]
 [ 52080 102122 144512]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9785299
{'0': {'precision': 0.45431264249702963, 'recall': 0.5283644240285325, 'f1-score': 0.4885483662105581, 'support': 107106}, '1': {'precision': 0.6007319740238487, 'recall': 0.5119594778782942, 'f1-score': 0.552804512410498, 'support': 157741}, '2': {'precision': 0.4627756459000159, 'recall': 0.48802752550211664, 'f1-score': 0.47506626002977165, 'support': 107246}, 'accuracy': 0.5097838443614903, 'macro avg': {'precision': 0.5059400874736314, 'recall': 0.5094504758029811, 'f1-score': 0.5054730462169427, 'support': 372093}, 'weighted avg': {'precision': 0.5188232756917649, 'recall': 0.5097838443614903, 'f1-score': 0.5119025459405184, 'support': 372093}}
[[56591 27443 23072]
 [39297 80757 37687]
 [28676 26231 52339]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9536967
{'0': {'precision': 0.4504087923870795, 'recall': 0.5183423738399445, 'f1-score': 0.4819936652124544, 'support': 38899}, '1': {'precision': 0.6231023217623731, 'recall': 0.5619948002836209, 'f1-score': 0.5909731082133448, 'support': 63465}, '2': {'precision': 0.48412246615350346, 'recall': 0.4884382959596464, 'f1-score': 0.4862708051063407, 'support': 40046}, 'accuracy': 0.5293869812513167, 'macro avg': {'precision': 0.5192111934343188, 'recall': 0.522925156694404, 'f1-score': 0.5197458595107133, 'support': 142410}, 'weighted avg': {'precision': 0.5368500017224718, 'recall': 0.5293869812513167, 'f1-score': 0.5317630823477826, 'support': 142410}}
[[20163 11285  7451]
 [14406 35667 13392]
 [10197 10289 19560]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
11876/11876 - 95s - 95s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9746034
{'0': {'precision': 0.5254931742867399, 'recall': 0.49090699663312704, 'f1-score': 0.5076116343169134, 'support': 981029}, '1': {'precision': 0.5695967456667845, 'recall': 0.428967407515801, 'f1-score': 0.4893795527095009, 'support': 1066074}, '2': {'precision': 0.47206707928756647, 'recall': 0.6278811460841387, 'f1-score': 0.5389381280587205, 'support': 993051}, 'accuracy': 0.5139288996544255, 'macro avg': {'precision': 0.522385666413697, 'recall': 0.5159185167443555, 'f1-score': 0.5119764383617116, 'support': 3040154}, 'weighted avg': {'precision': 0.5235073649133942, 'recall': 0.5139288996544255, 'f1-score': 0.5114509325134043, 'support': 3040154}}
[[481594 188008 311427]
 [222883 457311 385880]
 [211984 157549 623518]]
Evaluating performance on  train set...
2538/2538 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90266967
{'0': {'precision': 0.5090726035382018, 'recall': 0.4168205878342362, 'f1-score': 0.4583507986327653, 'support': 161338}, '1': {'precision': 0.6525081581966209, 'recall': 0.7210943173286398, 'f1-score': 0.685088929686495, 'support': 324988}, '2': {'precision': 0.4836874506708761, 'recall': 0.46910556161128736, 'f1-score': 0.47628492288752866, 'support': 163298}, 'accuracy': 0.5821829242761967, 'macro avg': {'precision': 0.5484227374685663, 'recall': 0.5356734889247211, 'f1-score': 0.5399082170689297, 'support': 649624}, 'weighted avg': {'precision': 0.5744480966609955, 'recall': 0.5821829242761967, 'f1-score': 0.576289449848613, 'support': 649624}}
[[ 67249  64360  29729]
 [ 38599 234347  52042]
 [ 26253  60441  76604]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90362114
{'0': {'precision': 0.4912588988014779, 'recall': 0.4339934321823067, 'f1-score': 0.46085403611847875, 'support': 50245}, '1': {'precision': 0.6523407033899842, 'recall': 0.7068760502756513, 'f1-score': 0.6785143261407852, 'support': 101759}, '2': {'precision': 0.4862027963426135, 'recall': 0.461149568328537, 'f1-score': 0.4733449094864579, 'support': 51428}, 'accuracy': 0.5773575445357663, 'macro avg': {'precision': 0.5432674661780251, 'recall': 0.5340063502621649, 'f1-score': 0.5375710905819073, 'support': 203432}, 'weighted avg': {'precision': 0.570555657009957, 'recall': 0.5773575445357663, 'f1-score': 0.5728879053620015, 'support': 203432}}
[[21806 19415  9024]
 [13790 71931 16038]
 [ 8792 18920 23716]]
testing model on single stock: results/universal/W0/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
19053/19053 - 149s - 149s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0028307
{'0': {'precision': 0.39776049451241463, 'recall': 0.5721836222121213, 'f1-score': 0.469288975722782, 'support': 1247409}, '1': {'precision': 0.6545411651896639, 'recall': 0.4307710286712397, 'f1-score': 0.5195875852705285, 'support': 2395955}, '2': {'precision': 0.40698583844003744, 'recall': 0.4967238805849206, 'f1-score': 0.447399382251105, 'support': 1234082}, 'accuracy': 0.483624626495096, 'macro avg': {'precision': 0.4864291660473719, 'recall': 0.4998928438227605, 'f1-score': 0.47875864774813853, 'support': 4877446}, 'weighted avg': {'precision': 0.5262334212649399, 'recall': 0.483624626495096, 'f1-score': 0.4884587731430418, 'support': 4877446}}
[[ 713747  271634  262028]
 [ 732683 1032108  631164]
 [ 347984  273100  612998]]
Evaluating performance on  train set...
4812/4812 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0779438
{'0': {'precision': 0.40991233440756764, 'recall': 0.598908376892585, 'f1-score': 0.486706761902004, 'support': 406917}, '1': {'precision': 0.4696645619068356, 'recall': 0.18036895214344914, 'f1-score': 0.26064165326557265, 'support': 406611}, '2': {'precision': 0.43456828095872446, 'recall': 0.4998482092274447, 'f1-score': 0.4649279615795091, 'support': 418339}, 'accuracy': 0.427117537851083, 'macro avg': {'precision': 0.4380483924243759, 'recall': 0.42637517942115966, 'f1-score': 0.4040921255823619, 'support': 1231867}, 'weighted avg': {'precision': 0.43800827090068684, 'recall': 0.427117537851083, 'f1-score': 0.40469183542383697, 'support': 1231867}}
[[243706  40189 123022]
 [184218  73340 149053]
 [166608  42625 209106]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0803425
{'0': {'precision': 0.413987996612541, 'recall': 0.6085297540118529, 'f1-score': 0.4927523528831721, 'support': 147812}, '1': {'precision': 0.47926732147597556, 'recall': 0.17560206979729992, 'f1-score': 0.25702937031078715, 'support': 154218}, '2': {'precision': 0.43116023213605503, 'recall': 0.5122285592594318, 'f1-score': 0.4682111692048458, 'support': 150263}, 'accuracy': 0.4289210754975204, 'macro avg': {'precision': 0.4414718500748572, 'recall': 0.4321201276895282, 'f1-score': 0.40599763079960166, 'support': 452293}, 'weighted avg': {'precision': 0.4419512826865217, 'recall': 0.4289210754975204, 'f1-score': 0.4042248744357842, 'support': 452293}}
[[89948 14281 43583]
 [69173 27081 57964]
 [58151 15143 76969]]
training model: results/universal/W0/deepOF_L2/h30
Epoch 1/50
8838/8838 - 209s - loss: 3.0083 - accuracy30: 0.4779 - val_loss: 3.1013 - val_accuracy30: 0.4505 - 209s/epoch - 24ms/step
Epoch 2/50
8838/8838 - 206s - loss: 2.9391 - accuracy30: 0.4966 - val_loss: 3.0607 - val_accuracy30: 0.4642 - 206s/epoch - 23ms/step
Epoch 3/50
8838/8838 - 204s - loss: 2.9204 - accuracy30: 0.5011 - val_loss: 3.0450 - val_accuracy30: 0.4671 - 204s/epoch - 23ms/step
Epoch 4/50
8838/8838 - 204s - loss: 2.9097 - accuracy30: 0.5038 - val_loss: 3.0368 - val_accuracy30: 0.4690 - 204s/epoch - 23ms/step
Epoch 5/50
8838/8838 - 203s - loss: 2.9022 - accuracy30: 0.5058 - val_loss: 3.0339 - val_accuracy30: 0.4699 - 203s/epoch - 23ms/step
Epoch 6/50
8838/8838 - 198s - loss: 2.8968 - accuracy30: 0.5070 - val_loss: 3.0277 - val_accuracy30: 0.4736 - 198s/epoch - 22ms/step
Epoch 7/50
8838/8838 - 198s - loss: 2.8922 - accuracy30: 0.5081 - val_loss: 3.0267 - val_accuracy30: 0.4734 - 198s/epoch - 22ms/step
Epoch 8/50
8838/8838 - 198s - loss: 2.8883 - accuracy30: 0.5092 - val_loss: 3.0384 - val_accuracy30: 0.4732 - 198s/epoch - 22ms/step
Epoch 9/50
8838/8838 - 197s - loss: 2.8849 - accuracy30: 0.5100 - val_loss: 3.0402 - val_accuracy30: 0.4745 - 197s/epoch - 22ms/step
Epoch 10/50
8838/8838 - 200s - loss: 2.8818 - accuracy30: 0.5108 - val_loss: 3.0414 - val_accuracy30: 0.4743 - 200s/epoch - 23ms/step
Epoch 11/50
8838/8838 - 205s - loss: 2.8790 - accuracy30: 0.5116 - val_loss: 3.0469 - val_accuracy30: 0.4742 - 205s/epoch - 23ms/step
Epoch 12/50
8838/8838 - 205s - loss: 2.8765 - accuracy30: 0.5120 - val_loss: 3.0556 - val_accuracy30: 0.4756 - 205s/epoch - 23ms/step
Epoch 13/50
8838/8838 - 201s - loss: 2.8739 - accuracy30: 0.5128 - val_loss: 3.0560 - val_accuracy30: 0.4738 - 201s/epoch - 23ms/step
Epoch 14/50
8838/8838 - 203s - loss: 2.8715 - accuracy30: 0.5136 - val_loss: 3.0569 - val_accuracy30: 0.4749 - 203s/epoch - 23ms/step
Epoch 15/50
8838/8838 - 200s - loss: 2.8694 - accuracy30: 0.5139 - val_loss: 3.0611 - val_accuracy30: 0.4750 - 200s/epoch - 23ms/step
Epoch 16/50
8838/8838 - 201s - loss: 2.8675 - accuracy30: 0.5145 - val_loss: 3.0611 - val_accuracy30: 0.4761 - 201s/epoch - 23ms/step
Epoch 17/50
8838/8838 - 208s - loss: 2.8652 - accuracy30: 0.5153 - val_loss: 3.0707 - val_accuracy30: 0.4768 - 208s/epoch - 24ms/step
testing model in sample: results/universal/W0/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 274s - 274s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.988391
{'0': {'precision': 0.3922697579958623, 'recall': 0.6042872447369426, 'f1-score': 0.4757251428727406, 'support': 2119823}, '1': {'precision': 0.7180031951578966, 'recall': 0.4234335174410817, 'f1-score': 0.5327086733830287, 'support': 4218001}, '2': {'precision': 0.4090880090922377, 'recall': 0.5223955323563125, 'f1-score': 0.45885029371101865, 'support': 2111180}, 'accuracy': 0.49353698968541143, 'macro avg': {'precision': 0.5064536540819988, 'recall': 0.5167054315114455, 'f1-score': 0.4890947033222626, 'support': 8449004}, 'weighted avg': {'precision': 0.559088275188249, 'recall': 0.49353698968541143, 'f1-score': 0.49995648950515814, 'support': 8449004}}
[[1280982  337985  500856]
 [1339759 1786043 1092199]
 [ 644823  363486 1102871]]
Evaluating performance on  train set...
8838/8838 - 73s - 73s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0343544
{'0': {'precision': 0.40838214602895834, 'recall': 0.5997394425124893, 'f1-score': 0.4858994854892779, 'support': 682383}, '1': {'precision': 0.6688786415817501, 'recall': 0.32929083321993924, 'f1-score': 0.4413190560715849, 'support': 881880}, '2': {'precision': 0.4291800277070033, 'recall': 0.5078940617910785, 'f1-score': 0.4652310632737087, 'support': 697803}, 'accuracy': 0.46597093099847664, 'macro avg': {'precision': 0.5021469384392373, 'recall': 0.47897477917450243, 'f1-score': 0.46414986827819055, 'support': 2262066}, 'weighted avg': {'precision': 0.5163540061456309, 'recall': 0.46597093099847664, 'f1-score': 0.46214373471889103, 'support': 2262066}}
[[409252  69261 203870]
 [323981 290395 267504]
 [268897  74496 354410]]
Evaluating performance on  val set...
3279/3279 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0283098
{'0': {'precision': 0.41119232027926256, 'recall': 0.6082988723700401, 'f1-score': 0.49069148719784556, 'support': 247865}, '1': {'precision': 0.6774998083760311, 'recall': 0.34115869137290644, 'f1-score': 0.45380261999075844, 'support': 336811}, '2': {'precision': 0.43458662022333777, 'recall': 0.5173211433606874, 'f1-score': 0.4723584697255154, 'support': 254198}, 'accuracy': 0.4734727742187742, 'macro avg': {'precision': 0.5077595829595437, 'recall': 0.48892623570121135, 'f1-score': 0.4722841923047065, 'support': 838874}, 'weighted avg': {'precision': 0.5252047650928398, 'recall': 0.4734727742187742, 'f1-score': 0.4703251477615088, 'support': 838874}}
[[150776  26607  70482]
 [121298 114906 100607]
 [ 94606  28090 131502]]
testing model out of sample: results/universal/W0/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 187s - 187s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96283287
{'0': {'precision': 0.4626997236428322, 'recall': 0.5412381758002254, 'f1-score': 0.4988969028993593, 'support': 1722421}, '1': {'precision': 0.6873998796004367, 'recall': 0.456247370457187, 'f1-score': 0.5484635013191068, 'support': 2362578}, '2': {'precision': 0.4615060518870314, 'recall': 0.5940756513814269, 'f1-score': 0.5194662005647351, 'support': 1747939}, 'accuracy': 0.5226470776819503, 'macro avg': {'precision': 0.5372018850434334, 'recall': 0.5305203992129465, 'f1-score': 0.5222755349277337, 'support': 5832938}, 'weighted avg': {'precision': 0.5533547554033006, 'recall': 0.5226470776819503, 'f1-score': 0.5251373382602785, 'support': 5832938}}
[[ 932240  246643  543538]
 [ 616562 1077920  668096]
 [ 465982  243549 1038408]]
Evaluating performance on  train set...
6334/6334 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.980393
{'0': {'precision': 0.4487285120736453, 'recall': 0.5390706617055808, 'f1-score': 0.489768330143926, 'support': 473821}, '1': {'precision': 0.6200850533151592, 'recall': 0.48775451000095704, 'f1-score': 0.5460163932642482, 'support': 668736}, '2': {'precision': 0.45806937643392803, 'recall': 0.5033836119037913, 'f1-score': 0.4796586416783451, 'support': 478335}, 'accuracy': 0.507367548238871, 'macro avg': {'precision': 0.5089609806075776, 'recall': 0.5100695945367765, 'f1-score': 0.5051477883621731, 'support': 1620892}, 'weighted avg': {'precision': 0.5221821106585361, 'recall': 0.507367548238871, 'f1-score': 0.5099913227348255, 'support': 1620892}}
[[255423  98092 120306]
 [177995 326179 164562]
 [135797 101752 240786]]
Evaluating performance on  val set...
2156/2156 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9742111
{'0': {'precision': 0.4467300289488156, 'recall': 0.552044466669231, 'f1-score': 0.4938348779592585, 'support': 155982}, '1': {'precision': 0.6279673454891126, 'recall': 0.5077366171725873, 'f1-score': 0.5614878985651072, 'support': 236796}, '2': {'precision': 0.46357940843839945, 'recall': 0.4886220293657601, 'f1-score': 0.4757714120779073, 'support': 158552}, 'accuracy': 0.5147751800192263, 'macro avg': {'precision': 0.5127589276254426, 'recall': 0.5161343710691929, 'f1-score': 0.510364729534091, 'support': 551330}, 'weighted avg': {'precision': 0.5294169395546391, 'recall': 0.5147751800192263, 'f1-score': 0.5176971129636344, 'support': 551330}}
[[ 86109  34285  35588]
 [ 62509 120230  54057]
 [ 44136  36944  77472]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1650637
{'0': {'precision': 0.31368226030569707, 'recall': 0.5745262050594683, 'f1-score': 0.40580265925255704, 'support': 58939}, '1': {'precision': 0.6598488858944126, 'recall': 0.13069920404175206, 'f1-score': 0.21818210750771777, 'support': 104905}, '2': {'precision': 0.32958153865501305, 'recall': 0.521490398965277, 'f1-score': 0.40389913117185844, 'support': 60306}, 'accuracy': 0.3525407093464198, 'macro avg': {'precision': 0.4343708949517076, 'recall': 0.4089052693554991, 'f1-score': 0.3426279659773777, 'support': 224150}, 'weighted avg': {'precision': 0.4799701556325676, 'recall': 0.3525407093464198, 'f1-score': 0.3174817663450087, 'support': 224150}}
[[33862  3879 21198]
 [48420 13711 42774]
 [25668  3189 31449]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1210482
{'0': {'precision': 0.39286771234092926, 'recall': 0.5762552452611779, 'f1-score': 0.46721022993899575, 'support': 27644}, '1': {'precision': 0.5180232558139535, 'recall': 0.06685675695955579, 'f1-score': 0.11842892270884563, 'support': 26654}, '2': {'precision': 0.3866315761205253, 'recall': 0.5346678055483344, 'f1-score': 0.44875631195062654, 'support': 26927}, 'accuracy': 0.3953093259464451, 'macro avg': {'precision': 0.4325075147584693, 'recall': 0.39259326925635607, 'f1-score': 0.3447984881994893, 'support': 81225}, 'weighted avg': {'precision': 0.43187017975518804, 'recall': 0.3953093259464451, 'f1-score': 0.3466398930650624, 'support': 81225}}
[[15930   923 10791]
 [12823  1782 12049]
 [11795   735 14397]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1413653
{'0': {'precision': 0.3562665901427649, 'recall': 0.6176616915422886, 'f1-score': 0.45188589107784705, 'support': 8040}, '1': {'precision': 0.605072463768116, 'recall': 0.08304326205867728, 'f1-score': 0.14604285089637078, 'support': 10055}, '2': {'precision': 0.37802040451047075, 'recall': 0.502976899261729, 'f1-score': 0.4316370324954016, 'support': 8398}, 'accuracy': 0.37840184199599897, 'macro avg': {'precision': 0.44645315280711717, 'recall': 0.4012272842875649, 'f1-score': 0.34318859148987313, 'support': 26493}, 'weighted avg': {'precision': 0.4575926608921288, 'recall': 0.37840184199599897, 'f1-score': 0.32938931902484736, 'support': 26493}}
[[4966  280 2794]
 [5064  835 4156]
 [3909  265 4224]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
2359/2359 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8390385
{'0': {'precision': 0.4463743109255958, 'recall': 0.5789820132637781, 'f1-score': 0.5041031904947827, 'support': 121534}, '1': {'precision': 0.7770949267485439, 'recall': 0.6722385026497799, 'f1-score': 0.720873636635909, 'support': 356256}, '2': {'precision': 0.48460049724918275, 'recall': 0.5306247172461962, 'f1-score': 0.5065693762502274, 'support': 125993}, 'accuracy': 0.6239162083066268, 'macro avg': {'precision': 0.5693565783077741, 'recall': 0.5939484110532515, 'f1-score': 0.5771820677936397, 'support': 603783}, 'weighted avg': {'precision': 0.6494893963190035, 'recall': 0.6239162083066268, 'f1-score': 0.632521006502088, 'support': 603783}}
[[ 70366  32982  18186]
 [ 63849 239489  52918]
 [ 23424  35714  66855]]
Evaluating performance on  train set...
589/589 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8737046
{'0': {'precision': 0.46214394533955033, 'recall': 0.5721593507087335, 'f1-score': 0.5113006614398447, 'support': 34992}, '1': {'precision': 0.7250401747084758, 'recall': 0.648389711843172, 'f1-score': 0.6845760305016826, 'support': 81414}, '2': {'precision': 0.49194504699927694, 'recall': 0.4959181293369876, 'f1-score': 0.4939235985073977, 'support': 34298}, 'accuracy': 0.5959894893300774, 'macro avg': {'precision': 0.5597097223491011, 'recall': 0.5721557306296311, 'f1-score': 0.563266763482975, 'support': 150704}, 'weighted avg': {'precision': 0.610949231214955, 'recall': 0.5959894893300774, 'f1-score': 0.6009535067017051, 'support': 150704}}
[[20021  9798  5173]
 [16233 52788 12393]
 [ 7068 10221 17009]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8709205
{'0': {'precision': 0.4823221300742034, 'recall': 0.5518299208104445, 'f1-score': 0.5147401344247022, 'support': 14017}, '1': {'precision': 0.7101922249318605, 'recall': 0.6472203157172272, 'f1-score': 0.6772456011354114, 'support': 30597}, '2': {'precision': 0.5053027251980131, 'recall': 0.5299542414642732, 'f1-score': 0.517334982647837, 'support': 14205}, 'accuracy': 0.5961679049286795, 'macro avg': {'precision': 0.5659390267346923, 'recall': 0.576334825997315, 'f1-score': 0.5697735727359835, 'support': 58819}, 'weighted avg': {'precision': 0.6064075556355604, 'recall': 0.5961679049286795, 'f1-score': 0.5999003646897049, 'support': 58819}}
[[ 7735  4122  2160]
 [ 5584 19803  5210]
 [ 2718  3959  7528]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
1625/1625 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0100522
{'0': {'precision': 0.46173478869574913, 'recall': 0.5433524326058115, 'f1-score': 0.4992297490991413, 'support': 137178}, '1': {'precision': 0.5143518068885141, 'recall': 0.41886985094802237, 'f1-score': 0.4617262423714037, 'support': 139079}, '2': {'precision': 0.4816837750338271, 'recall': 0.4871014191662667, 'f1-score': 0.48437744881530764, 'support': 139589}, 'accuracy': 0.4828373965362177, 'macro avg': {'precision': 0.48592345687269684, 'recall': 0.48310790090670014, 'f1-score': 0.48177781342861753, 'support': 415846}, 'weighted avg': {'precision': 0.4860288334314867, 'recall': 0.4828373965362177, 'f1-score': 0.4817012218161878, 'support': 415846}}
[[74536 26810 35832]
 [43490 58256 37333]
 [43400 28195 67994]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0277
{'0': {'precision': 0.44101558670718555, 'recall': 0.5839715465095148, 'f1-score': 0.5025244627139092, 'support': 38519}, '1': {'precision': 0.5287076951297808, 'recall': 0.30569549769316434, 'f1-score': 0.3873991935483871, 'support': 37714}, '2': {'precision': 0.4657926214320895, 'recall': 0.5064388626800969, 'f1-score': 0.4852660900161266, 'support': 39215}, 'accuracy': 0.46672960986764606, 'macro avg': {'precision': 0.4785053010896853, 'recall': 0.46536863562759195, 'f1-score': 0.4583965820928076, 'support': 115448}, 'weighted avg': {'precision': 0.47807860723406226, 'recall': 0.46672960986764606, 'f1-score': 0.4590536231441285, 'support': 115448}}
[[22494  5011 11014]
 [14422 11529 11763]
 [14089  5266 19860]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0305201
{'0': {'precision': 0.4519095110678667, 'recall': 0.607282949790795, 'f1-score': 0.5182003291400519, 'support': 15296}, '1': {'precision': 0.48840628888134824, 'recall': 0.29617943617532067, 'f1-score': 0.3687446626814688, 'support': 14579}, '2': {'precision': 0.4614357474407071, 'recall': 0.47593126967471144, 'f1-score': 0.46857142857142864, 'support': 15248}, 'accuracy': 0.4623806041264987, 'macro avg': {'precision': 0.4672505157966407, 'recall': 0.4597978852136091, 'f1-score': 0.45183880679764976, 'support': 45123}, 'weighted avg': {'precision': 0.4669205381705819, 'recall': 0.4623806041264987, 'f1-score': 0.4531413650381515, 'support': 45123}}
[[9289 2106 3901]
 [5692 4318 4569]
 [5574 2417 7257]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2295135
{'0': {'precision': 0.3388655344716282, 'recall': 0.601704094158423, 'f1-score': 0.43356020278421825, 'support': 110792}, '1': {'precision': 0.76797829036635, 'recall': 0.00542000229823419, 'f1-score': 0.010764037464936054, 'support': 104428}, '2': {'precision': 0.3373423936525394, 'recall': 0.3920247583052611, 'f1-score': 0.3626337434658875, 'support': 109539}, 'accuracy': 0.33924233046659213, 'macro avg': {'precision': 0.4813954061635058, 'recall': 0.3330496182539728, 'f1-score': 0.2689859945716806, 'support': 324759}, 'weighted avg': {'precision': 0.4763352998988891, 'recall': 0.33924233046659213, 'f1-score': 0.2736848140213737, 'support': 324759}}
[[66664    58 44070]
 [63579   566 40283]
 [66484   113 42942]]
Evaluating performance on  train set...
486/486 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2184397
{'0': {'precision': 0.3512658639765701, 'recall': 0.6532716841366288, 'f1-score': 0.4568710108859432, 'support': 41309}, '1': {'precision': 0.7050691244239631, 'recall': 0.011153229333722117, 'f1-score': 0.021959095801937566, 'support': 41154}, '2': {'precision': 0.3592286972508444, 'recall': 0.4020961451030126, 'f1-score': 0.37945556571712447, 'support': 41791}, 'accuracy': 0.3561173080947092, 'macro avg': {'precision': 0.47185456188379254, 'recall': 0.3555070195244545, 'f1-score': 0.2860952241350017, 'support': 124254}, 'weighted avg': {'precision': 0.47112674689234907, 'recall': 0.3561173080947092, 'f1-score': 0.2867868782027517, 'support': 124254}}
[[26986    91 14232]
 [24953   459 15742]
 [24886   101 16804]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2223251
{'0': {'precision': 0.34662221919858494, 'recall': 0.6808311618894902, 'f1-score': 0.4593711258875239, 'support': 14967}, '1': {'precision': 0.7168949771689498, 'recall': 0.010402173192870868, 'f1-score': 0.020506792058516198, 'support': 15093}, '2': {'precision': 0.3680669098226638, 'recall': 0.37861439937900254, 'f1-score': 0.3732661586046363, 'support': 15459}, 'accuracy': 0.3558953404073024, 'macro avg': {'precision': 0.47719470206339953, 'recall': 0.3566159114871212, 'f1-score': 0.2843813588502255, 'support': 45519}, 'weighted avg': {'precision': 0.4766786837167939, 'recall': 0.3558953404073024, 'f1-score': 0.2846116610550941, 'support': 45519}}
[[10190    28  4749]
 [ 9636   157  5300]
 [ 9572    34  5853]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
1733/1733 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1222658
{'0': {'precision': 0.3733945862628681, 'recall': 0.6131835343693879, 'f1-score': 0.46414857035817986, 'support': 141434}, '1': {'precision': 0.4865036423540791, 'recall': 0.10247480310448673, 'f1-score': 0.1692909658893692, 'support': 157063}, '2': {'precision': 0.405213203639364, 'recall': 0.4978553203227364, 'f1-score': 0.4467823735274915, 'support': 145010}, 'accuracy': 0.3946138392404179, 'macro avg': {'precision': 0.4217038107521038, 'recall': 0.40450455259887036, 'f1-score': 0.3600739699250135, 'support': 443507}, 'weighted avg': {'precision': 0.42385436566346274, 'recall': 0.3946138392404179, 'f1-score': 0.3540499876230642, 'support': 443507}}
[[86725  9216 45493]
 [80492 16095 60476]
 [65044  7772 72194]]
Evaluating performance on  train set...
765/765 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0933394
{'0': {'precision': 0.3911115285082227, 'recall': 0.5783569422584328, 'f1-score': 0.46665172624161155, 'support': 64806}, '1': {'precision': 0.516010135913384, 'recall': 0.1736730295089085, 'f1-score': 0.25987887788013087, 'support': 64489}, '2': {'precision': 0.41371904841039536, 'recall': 0.48690366937971086, 'f1-score': 0.44733786697628125, 'support': 66469}, 'accuracy': 0.41399337978382134, 'macro avg': {'precision': 0.44028023761066737, 'recall': 0.4129778803823507, 'f1-score': 0.39128949036600785, 'support': 195764}, 'weighted avg': {'precision': 0.4399319731932974, 'recall': 0.41399337978382134, 'f1-score': 0.39197840975088405, 'support': 195764}}
[[37481  5337 21988]
 [29414 11200 23875]
 [28937  5168 32364]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1047167
{'0': {'precision': 0.3890306879563127, 'recall': 0.6192073314752704, 'f1-score': 0.4778448134443979, 'support': 21169}, '1': {'precision': 0.5469990766389659, 'recall': 0.13454462866227573, 'f1-score': 0.2159679183375866, 'support': 22015}, '2': {'precision': 0.41180834862743565, 'recall': 0.4897371598402526, 'f1-score': 0.4474047048342278, 'support': 21534}, 'accuracy': 0.4112611638184122, 'macro avg': {'precision': 0.44927937107423804, 'recall': 0.414496373325933, 'f1-score': 0.3804058122054041, 'support': 64718}, 'weighted avg': {'precision': 0.4503454415293614, 'recall': 0.4112611638184122, 'f1-score': 0.3786341279382349, 'support': 64718}}
[[13108  1209  6852]
 [10842  2962  8211]
 [ 9744  1244 10546]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/EXC
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7822289
{'0': {'precision': 0.4913383527199425, 'recall': 0.6030696194231459, 'f1-score': 0.541500502417886, 'support': 228758}, '1': {'precision': 0.7912034652577242, 'recall': 0.7363979608050134, 'f1-score': 0.7628175890086131, 'support': 742646}, '2': {'precision': 0.5341288366309636, 'recall': 0.5327852800250671, 'f1-score': 0.5334562123628503, 'support': 229783}, 'accuracy': 0.6720560578827444, 'macro avg': {'precision': 0.6055568848695434, 'recall': 0.6240842867510755, 'f1-score': 0.6125914345964498, 'support': 1201187}, 'weighted avg': {'precision': 0.6849186629716016, 'recall': 0.6720560578827444, 'f1-score': 0.6767931820643864, 'support': 1201187}}
[[137957  66664  24137]
 [113120 546883  82643]
 [ 29701  77657 122425]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8109789
{'0': {'precision': 0.5199877068773192, 'recall': 0.5710303621204735, 'f1-score': 0.5443150338089422, 'support': 80001}, '1': {'precision': 0.7537065052950076, 'recall': 0.7301263060113725, 'f1-score': 0.7417290443163806, 'support': 221763}, '2': {'precision': 0.5158756788328425, 'recall': 0.5100756905534257, 'f1-score': 0.512959290220138, 'support': 81384}, 'accuracy': 0.650166515289131, 'macro avg': {'precision': 0.596523297001723, 'recall': 0.6037441195617572, 'f1-score': 0.5996677894484869, 'support': 383148}, 'weighted avg': {'precision': 0.6543888484809036, 'recall': 0.650166515289131, 'f1-score': 0.6519164499090649, 'support': 383148}}
[[ 45683  24239  10079]
 [ 30970 161915  28878]
 [ 11201  28671  41512]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7858133
{'0': {'precision': 0.5328673712921923, 'recall': 0.5653463555796708, 'f1-score': 0.5486265906099167, 'support': 27645}, '1': {'precision': 0.7657949436844395, 'recall': 0.7580539040350268, 'f1-score': 0.7619047619047619, 'support': 83593}, '2': {'precision': 0.5408755179246982, 'recall': 0.5249868858191992, 'f1-score': 0.5328127772848269, 'support': 28595}, 'accuracy': 0.6722948088076491, 'macro avg': {'precision': 0.6131792776337767, 'recall': 0.6161290484779656, 'f1-score': 0.6144480432665018, 'support': 139833}, 'weighted avg': {'precision': 0.6737504783695032, 'recall': 0.6722948088076491, 'f1-score': 0.672891722453037, 'support': 139833}}
[[15629  8874  3142]
 [10624 63368  9601]
 [ 3077 10506 15012]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/AAL
Evaluating performance on  test set...
6677/6677 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8221937
{'0': {'precision': 0.4184120095849746, 'recall': 0.5657573331000558, 'f1-score': 0.4810547380677535, 'support': 297214}, '1': {'precision': 0.8007866383909934, 'recall': 0.6897024789979637, 'f1-score': 0.7411050818193731, 'support': 1115249}, '2': {'precision': 0.44482340086317496, 'recall': 0.5198168574682128, 'f1-score': 0.47940504321266725, 'support': 296818}, 'accuracy': 0.6386498182569162, 'macro avg': {'precision': 0.5546740162797144, 'recall': 0.5917588898554108, 'f1-score': 0.5671882876999313, 'support': 1709281}, 'weighted avg': {'precision': 0.6724850957175044, 'recall': 0.6386498182569162, 'f1-score': 0.6504424669965562, 'support': 1709281}}
[[168151  92507  36556]
 [190047 769190 156012]
 [ 43681  98846 154291]]
Evaluating performance on  train set...
2262/2262 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9299898
{'0': {'precision': 0.4707633926857757, 'recall': 0.5483889513491415, 'f1-score': 0.506619927353416, 'support': 156544}, '1': {'precision': 0.6641029340161939, 'recall': 0.5571057398841963, 'f1-score': 0.6059170137282123, 'support': 264413}, '2': {'precision': 0.47373212261396297, 'recall': 0.5241078328287115, 'f1-score': 0.49764837491279146, 'support': 157874}, 'accuracy': 0.5457482408509565, 'macro avg': {'precision': 0.5361994831053108, 'recall': 0.5432008413540165, 'f1-score': 0.5367284386648065, 'support': 578831}, 'weighted avg': {'precision': 0.5598916069840467, 'recall': 0.5457482408509565, 'f1-score': 0.5495323933920487, 'support': 578831}}
[[ 85847  35827  34870]
 [ 60058 147306  57049]
 [ 36452  38679  82743]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90645
{'0': {'precision': 0.48040902939063307, 'recall': 0.5370391124061414, 'f1-score': 0.5071480857593904, 'support': 53538}, '1': {'precision': 0.6694938016528925, 'recall': 0.6225037701595474, 'f1-score': 0.6451442707322294, 'support': 104107}, '2': {'precision': 0.48738960211235544, 'recall': 0.4963927372540292, 'f1-score': 0.4918499733539151, 'support': 53919}, 'accuracy': 0.5687357017261916, 'macro avg': {'precision': 0.5457641443852936, 'recall': 0.5519785399399061, 'f1-score': 0.548047443281845, 'support': 211564}, 'weighted avg': {'precision': 0.5752334507784381, 'recall': 0.5687357017261916, 'f1-score': 0.5711547688726636, 'support': 211564}}
[[28752 15393  9393]
 [20543 64807 18757]
 [10554 16600 26765]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/WBA
Evaluating performance on  test set...
5633/5633 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9020662
{'0': {'precision': 0.44173799506745975, 'recall': 0.5344727211025654, 'f1-score': 0.4837007099540509, 'support': 341821}, '1': {'precision': 0.7071905690406304, 'recall': 0.6273925972039179, 'f1-score': 0.6649059257611181, 'support': 754985}, '2': {'precision': 0.47045793753748727, 'recall': 0.4887732122206346, 'f1-score': 0.4794407216714666, 'support': 345023}, 'accuracy': 0.5721926802692968, 'macro avg': {'precision': 0.5397955005485259, 'recall': 0.5502128435090393, 'f1-score': 0.5426824524622119, 'support': 1441829}, 'weighted avg': {'precision': 0.5876094904195235, 'recall': 0.5721926802692968, 'f1-score': 0.5775658117926715, 'support': 1441829}}
[[182694  97207  61920]
 [153416 473672 127897]
 [ 77470  98915 168638]]
Evaluating performance on  train set...
1454/1454 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0084265
{'0': {'precision': 0.4549450698770951, 'recall': 0.5555951975971392, 'f1-score': 0.5002577415860445, 'support': 120523}, '1': {'precision': 0.5448328430635776, 'recall': 0.3889557386472504, 'f1-score': 0.45388402699209823, 'support': 130475}, '2': {'precision': 0.4655965391621129, 'recall': 0.5066022544283414, 'f1-score': 0.4852346206323782, 'support': 121095}, 'accuracy': 0.4812184050761503, 'macro avg': {'precision': 0.4884581507009285, 'recall': 0.4837177302242437, 'f1-score': 0.4797921297368403, 'support': 372093}, 'weighted avg': {'precision': 0.48993080430256275, 'recall': 0.4812184050761503, 'f1-score': 0.4791075580471729, 'support': 372093}}
[[66962 21278 32283]
 [41596 50749 38130]
 [38629 21119 61347]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9931378
{'0': {'precision': 0.4487820228046794, 'recall': 0.5511605174020778, 'f1-score': 0.49473029087978126, 'support': 43989}, '1': {'precision': 0.5604195498579649, 'recall': 0.4380551127305853, 'f1-score': 0.4917393666315151, 'support': 52692}, '2': {'precision': 0.48820949596389757, 'recall': 0.5039034310831201, 'f1-score': 0.49593233471074377, 'support': 45729}, 'accuracy': 0.4941366477073239, 'macro avg': {'precision': 0.49913702287551404, 'recall': 0.4977063537385944, 'f1-score': 0.4941339974073467, 'support': 142410}, 'weighted avg': {'precision': 0.5027486227315778, 'recall': 0.4941366477073239, 'f1-score': 0.4940096285797773, 'support': 142410}}
[[24245  9235 10509]
 [15963 23082 13647]
 [13816  8870 23043]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
11876/11876 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9972807
{'0': {'precision': 0.5119585353427153, 'recall': 0.5229098170745162, 'f1-score': 0.5173762313640908, 'support': 1087656}, '1': {'precision': 0.5015563875461752, 'recall': 0.2610323745512725, 'f1-score': 0.34336318949270433, 'support': 846282}, '2': {'precision': 0.47884152824879817, 'recall': 0.6444437614353797, 'f1-score': 0.5494355502205198, 'support': 1106216}, 'accuracy': 0.4942338447328655, 'macro avg': {'precision': 0.4974521503792295, 'recall': 0.4761286510203895, 'f1-score': 0.47005832369243833, 'support': 3040154}, 'weighted avg': {'precision': 0.4970126761655302, 'recall': 0.4942338447328655, 'f1-score': 0.48060191873620506, 'support': 3040154}}
[[568746 114081 404829]
 [254309 220907 371066]
 [287867 105455 712894]]
Evaluating performance on  train set...
2538/2538 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96510816
{'0': {'precision': 0.46892028861882445, 'recall': 0.5016048693561199, 'f1-score': 0.48471221622294486, 'support': 186308}, '1': {'precision': 0.6006521679916261, 'recall': 0.560363166416182, 'f1-score': 0.5798086223248913, 'support': 275466}, '2': {'precision': 0.4734432944900461, 'recall': 0.48728240617513974, 'f1-score': 0.4802631751536631, 'support': 187850}, 'accuracy': 0.522379099294361, 'macro avg': {'precision': 0.5143385837001655, 'recall': 0.5164168139824805, 'f1-score': 0.5149280045671665, 'support': 649624}, 'weighted avg': {'precision': 0.5260876662653048, 'recall': 0.522379099294361, 'f1-score': 0.5237502970795852, 'support': 649624}}
[[ 93453  51006  41849]
 [ 61149 154361  59956]
 [ 44692  51622  91536]]
Evaluating performance on  val set...
795/795 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.968668
{'0': {'precision': 0.4632760532150776, 'recall': 0.5192875265365298, 'f1-score': 0.4896853104172261, 'support': 57939}, '1': {'precision': 0.5994996126443058, 'recall': 0.5486285448628545, 'f1-score': 0.5729370854295753, 'support': 86040}, '2': {'precision': 0.4808950777418869, 'recall': 0.48328932097623334, 'f1-score': 0.4820892266908274, 'support': 59453}, 'accuracy': 0.5211766093829879, 'macro avg': {'precision': 0.5145569145337568, 'recall': 0.5170684641252059, 'f1-score': 0.5149038741792097, 'support': 203432}, 'weighted avg': {'precision': 0.5260399198559363, 'recall': 0.5211766093829879, 'f1-score': 0.5226760530549475, 'support': 203432}}
[[30087 15172 12680]
 [20500 47204 18336]
 [14357 16363 28733]]
testing model on single stock: results/universal/W0/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
19053/19053 - 147s - 147s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0670995
{'0': {'precision': 0.37149790813852523, 'recall': 0.6253866983365707, 'f1-score': 0.466111822172066, 'support': 1316918}, '1': {'precision': 0.6423835953419779, 'recall': 0.23228094522867337, 'f1-score': 0.3411901633238223, 'support': 2259686}, '2': {'precision': 0.38100102200456104, 'recall': 0.5399202977763633, 'f1-score': 0.4467486653533816, 'support': 1300842}, 'accuracy': 0.4204692373836635, 'macro avg': {'precision': 0.4649608418283547, 'recall': 0.46586264711386915, 'f1-score': 0.4180168836164233, 'support': 4877446}, 'weighted avg': {'precision': 0.49953185144035633, 'recall': 0.4204692373836635, 'f1-score': 0.40307224546768355, 'support': 4877446}}
[[823583 141215 352120]
 [945839 524882 788965]
 [447503 150988 702351]]
Evaluating performance on  train set...
4812/4812 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1129341
{'0': {'precision': 0.38575910242937506, 'recall': 0.615490262798416, 'f1-score': 0.4742694069566175, 'support': 405558}, '1': {'precision': 0.4604001510003775, 'recall': 0.059920309329507655, 'f1-score': 0.1060397257713225, 'support': 407074}, '2': {'precision': 0.40882500606423006, 'recall': 0.5186017388815343, 'f1-score': 0.4572164005375157, 'support': 419235}, 'accuracy': 0.39892699455379516, 'macro avg': {'precision': 0.4183280864979942, 'recall': 0.39800410366981936, 'f1-score': 0.3458418444218186, 'support': 1231867}, 'weighted avg': {'precision': 0.4182743531150016, 'recall': 0.39892699455379516, 'f1-score': 0.34678328517160745, 'support': 1231867}}
[[249617  14020 141921]
 [210212  24392 172470]
 [187251  14568 217416]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1154027
{'0': {'precision': 0.3911739880824903, 'recall': 0.63263088551889, 'f1-score': 0.4834295144583065, 'support': 147247}, '1': {'precision': 0.4813245623815364, 'recall': 0.055762225838952184, 'f1-score': 0.0999455936657136, 'support': 154836}, '2': {'precision': 0.4070829383644722, 'recall': 0.5317688569336263, 'f1-score': 0.4611463276640456, 'support': 150210}, 'accuracy': 0.40165114206941077, 'macro avg': {'precision': 0.42652716294283294, 'recall': 0.40672065609715613, 'f1-score': 0.3481738119293552, 'support': 452293}, 'weighted avg': {'precision': 0.4273192252274906, 'recall': 0.40165114206941077, 'f1-score': 0.34474889404585746, 'support': 452293}}
[[93153  4451 49643]
 [79504  8634 66698]
 [65480  4853 79877]]
training model: results/universal/W0/deepVOL_L2/h10
Epoch 1/50
8838/8838 - 303s - loss: 2.8836 - accuracy10: 0.5080 - val_loss: 2.9397 - val_accuracy10: 0.5259 - 303s/epoch - 34ms/step
Epoch 2/50
8838/8838 - 297s - loss: 2.8027 - accuracy10: 0.5317 - val_loss: 2.9364 - val_accuracy10: 0.5373 - 297s/epoch - 34ms/step
Epoch 3/50
8838/8838 - 304s - loss: 2.7674 - accuracy10: 0.5404 - val_loss: 2.9272 - val_accuracy10: 0.5433 - 304s/epoch - 34ms/step
Epoch 4/50
8838/8838 - 314s - loss: 2.7459 - accuracy10: 0.5448 - val_loss: 2.8964 - val_accuracy10: 0.5473 - 314s/epoch - 36ms/step
Epoch 5/50
8838/8838 - 319s - loss: 2.7312 - accuracy10: 0.5482 - val_loss: 2.8905 - val_accuracy10: 0.5506 - 319s/epoch - 36ms/step
Epoch 6/50
8838/8838 - 311s - loss: 2.7196 - accuracy10: 0.5508 - val_loss: 2.8796 - val_accuracy10: 0.5505 - 311s/epoch - 35ms/step
Epoch 7/50
8838/8838 - 314s - loss: 2.7099 - accuracy10: 0.5530 - val_loss: 2.8434 - val_accuracy10: 0.5543 - 314s/epoch - 36ms/step
Epoch 8/50
8838/8838 - 318s - loss: 2.7015 - accuracy10: 0.5546 - val_loss: 2.8398 - val_accuracy10: 0.5556 - 318s/epoch - 36ms/step
Epoch 9/50
8838/8838 - 317s - loss: 2.6943 - accuracy10: 0.5563 - val_loss: 2.8363 - val_accuracy10: 0.5560 - 317s/epoch - 36ms/step
Epoch 10/50
8838/8838 - 316s - loss: 2.6878 - accuracy10: 0.5580 - val_loss: 2.8213 - val_accuracy10: 0.5569 - 316s/epoch - 36ms/step
Epoch 11/50
8838/8838 - 305s - loss: 2.6821 - accuracy10: 0.5592 - val_loss: 2.8293 - val_accuracy10: 0.5548 - 305s/epoch - 35ms/step
Epoch 12/50
8838/8838 - 310s - loss: 2.6767 - accuracy10: 0.5604 - val_loss: 2.8067 - val_accuracy10: 0.5555 - 310s/epoch - 35ms/step
Epoch 13/50
8838/8838 - 313s - loss: 2.6725 - accuracy10: 0.5613 - val_loss: 2.8146 - val_accuracy10: 0.5550 - 313s/epoch - 35ms/step
Epoch 14/50
8838/8838 - 317s - loss: 2.6682 - accuracy10: 0.5622 - val_loss: 2.8099 - val_accuracy10: 0.5567 - 317s/epoch - 36ms/step
Epoch 15/50
8838/8838 - 319s - loss: 2.6649 - accuracy10: 0.5629 - val_loss: 2.8057 - val_accuracy10: 0.5562 - 319s/epoch - 36ms/step
Epoch 16/50
8838/8838 - 314s - loss: 2.6615 - accuracy10: 0.5637 - val_loss: 2.8057 - val_accuracy10: 0.5553 - 314s/epoch - 35ms/step
Epoch 17/50
8838/8838 - 302s - loss: 2.6584 - accuracy10: 0.5642 - val_loss: 2.7937 - val_accuracy10: 0.5542 - 302s/epoch - 34ms/step
Epoch 18/50
8838/8838 - 318s - loss: 2.6553 - accuracy10: 0.5651 - val_loss: 2.8052 - val_accuracy10: 0.5548 - 318s/epoch - 36ms/step
Epoch 19/50
8838/8838 - 311s - loss: 2.6527 - accuracy10: 0.5656 - val_loss: 2.8051 - val_accuracy10: 0.5571 - 311s/epoch - 35ms/step
Epoch 20/50
8838/8838 - 310s - loss: 2.6497 - accuracy10: 0.5663 - val_loss: 2.7962 - val_accuracy10: 0.5573 - 310s/epoch - 35ms/step
Epoch 21/50
8838/8838 - 316s - loss: 2.6476 - accuracy10: 0.5664 - val_loss: 2.7905 - val_accuracy10: 0.5566 - 316s/epoch - 36ms/step
Epoch 22/50
8838/8838 - 312s - loss: 2.6449 - accuracy10: 0.5671 - val_loss: 2.7928 - val_accuracy10: 0.5568 - 312s/epoch - 35ms/step
Epoch 23/50
8838/8838 - 307s - loss: 2.6429 - accuracy10: 0.5678 - val_loss: 2.7968 - val_accuracy10: 0.5576 - 307s/epoch - 35ms/step
Epoch 24/50
8838/8838 - 298s - loss: 2.6407 - accuracy10: 0.5681 - val_loss: 2.7993 - val_accuracy10: 0.5565 - 298s/epoch - 34ms/step
Epoch 25/50
8838/8838 - 298s - loss: 2.6388 - accuracy10: 0.5686 - val_loss: 2.7860 - val_accuracy10: 0.5597 - 298s/epoch - 34ms/step
Epoch 26/50
8838/8838 - 303s - loss: 2.6365 - accuracy10: 0.5690 - val_loss: 2.7850 - val_accuracy10: 0.5597 - 303s/epoch - 34ms/step
Epoch 27/50
8838/8838 - 299s - loss: 2.6347 - accuracy10: 0.5693 - val_loss: 2.7834 - val_accuracy10: 0.5592 - 299s/epoch - 34ms/step
Epoch 28/50
8838/8838 - 301s - loss: 2.6326 - accuracy10: 0.5697 - val_loss: 2.7887 - val_accuracy10: 0.5589 - 301s/epoch - 34ms/step
Epoch 29/50
8838/8838 - 299s - loss: 2.6308 - accuracy10: 0.5702 - val_loss: 2.7797 - val_accuracy10: 0.5609 - 299s/epoch - 34ms/step
Epoch 30/50
8838/8838 - 312s - loss: 2.6294 - accuracy10: 0.5709 - val_loss: 2.7857 - val_accuracy10: 0.5602 - 312s/epoch - 35ms/step
Epoch 31/50
8838/8838 - 311s - loss: 2.6276 - accuracy10: 0.5709 - val_loss: 2.7777 - val_accuracy10: 0.5590 - 311s/epoch - 35ms/step
Epoch 32/50
8838/8838 - 308s - loss: 2.6259 - accuracy10: 0.5715 - val_loss: 2.7957 - val_accuracy10: 0.5587 - 308s/epoch - 35ms/step
Epoch 33/50
8838/8838 - 310s - loss: 2.6244 - accuracy10: 0.5716 - val_loss: 2.7739 - val_accuracy10: 0.5588 - 310s/epoch - 35ms/step
Epoch 34/50
8838/8838 - 314s - loss: 2.6232 - accuracy10: 0.5722 - val_loss: 2.7731 - val_accuracy10: 0.5591 - 314s/epoch - 36ms/step
Epoch 35/50
8838/8838 - 312s - loss: 2.6218 - accuracy10: 0.5722 - val_loss: 2.7770 - val_accuracy10: 0.5604 - 312s/epoch - 35ms/step
Epoch 36/50
8838/8838 - 303s - loss: 2.6203 - accuracy10: 0.5727 - val_loss: 2.7794 - val_accuracy10: 0.5588 - 303s/epoch - 34ms/step
Epoch 37/50
8838/8838 - 297s - loss: 2.6192 - accuracy10: 0.5729 - val_loss: 2.7834 - val_accuracy10: 0.5592 - 297s/epoch - 34ms/step
Epoch 38/50
8838/8838 - 294s - loss: 2.6174 - accuracy10: 0.5733 - val_loss: 2.7765 - val_accuracy10: 0.5605 - 294s/epoch - 33ms/step
Epoch 39/50
8838/8838 - 292s - loss: 2.6163 - accuracy10: 0.5735 - val_loss: 2.7773 - val_accuracy10: 0.5599 - 292s/epoch - 33ms/step
Epoch 40/50
8838/8838 - 314s - loss: 2.6154 - accuracy10: 0.5737 - val_loss: 2.7728 - val_accuracy10: 0.5590 - 314s/epoch - 36ms/step
Epoch 41/50
8838/8838 - 318s - loss: 2.6140 - accuracy10: 0.5742 - val_loss: 2.7695 - val_accuracy10: 0.5608 - 318s/epoch - 36ms/step
Epoch 42/50
8838/8838 - 315s - loss: 2.6126 - accuracy10: 0.5745 - val_loss: 2.7698 - val_accuracy10: 0.5599 - 315s/epoch - 36ms/step
Epoch 43/50
8838/8838 - 307s - loss: 2.6118 - accuracy10: 0.5745 - val_loss: 2.7683 - val_accuracy10: 0.5617 - 307s/epoch - 35ms/step
Epoch 44/50
8838/8838 - 299s - loss: 2.6105 - accuracy10: 0.5748 - val_loss: 2.7792 - val_accuracy10: 0.5599 - 299s/epoch - 34ms/step
Epoch 45/50
8838/8838 - 292s - loss: 2.6135 - accuracy10: 0.5739 - val_loss: 2.7704 - val_accuracy10: 0.5606 - 292s/epoch - 33ms/step
Epoch 46/50
8838/8838 - 297s - loss: 2.6096 - accuracy10: 0.5750 - val_loss: 2.7636 - val_accuracy10: 0.5602 - 297s/epoch - 34ms/step
Epoch 47/50
8838/8838 - 307s - loss: 2.6078 - accuracy10: 0.5754 - val_loss: 2.7663 - val_accuracy10: 0.5614 - 307s/epoch - 35ms/step
Epoch 48/50
8838/8838 - 307s - loss: 2.6065 - accuracy10: 0.5757 - val_loss: 2.7721 - val_accuracy10: 0.5619 - 307s/epoch - 35ms/step
Epoch 49/50
8838/8838 - 310s - loss: 2.6059 - accuracy10: 0.5758 - val_loss: 2.7766 - val_accuracy10: 0.5603 - 310s/epoch - 35ms/step
Epoch 50/50
8838/8838 - 309s - loss: 2.6046 - accuracy10: 0.5761 - val_loss: 2.7620 - val_accuracy10: 0.5613 - 309s/epoch - 35ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 550s - 550s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8080959
{'0': {'precision': 0.4410525985660363, 'recall': 0.5012322187698507, 'f1-score': 0.4692207037750882, 'support': 1739545}, '1': {'precision': 0.7538000468894009, 'recall': 0.731162625792889, 'f1-score': 0.7423087889622352, 'support': 4986669}, '2': {'precision': 0.4552515048461458, 'recall': 0.4321038532866268, 'f1-score': 0.44337576294686887, 'support': 1722815}, 'accuracy': 0.6228428142452819, 'macro avg': {'precision': 0.5500347167671943, 'recall': 0.5548328992831222, 'f1-score': 0.5516350852280641, 'support': 8449029}, 'weighted avg': {'precision': 0.628533324943729, 'recall': 0.6228428142452819, 'f1-score': 0.6251290142968223, 'support': 8449029}}
[[ 871916  571633  295996]
 [ 745817 3646066  594786]
 [ 359165  619215  744435]]
Evaluating performance on  train set...
8838/8838 - 161s - 161s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90515894
{'0': {'precision': 0.452093818380744, 'recall': 0.5451944136584336, 'f1-score': 0.49429847121871856, 'support': 606336}, '1': {'precision': 0.6883534102002813, 'recall': 0.6180991071704408, 'f1-score': 0.6513373009817387, 'support': 1035808}, '2': {'precision': 0.4787859116481907, 'recall': 0.4639974319598405, 'f1-score': 0.4712756859134207, 'support': 619928}, 'accuracy': 0.5563253512708702, 'macro avg': {'precision': 0.5397443800764054, 'recall': 0.5424303175962383, 'f1-score': 0.5389704860379593, 'support': 2262072}, 'weighted avg': {'precision': 0.5675926845877051, 'recall': 0.5563253512708702, 'f1-score': 0.5598974472594599, 'support': 2262072}}
[[330571 135907 139858]
 [222299 640232 173277]
 [178330 153953 287645]]
Evaluating performance on  val set...
3279/3279 - 58s - 58s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89562607
{'0': {'precision': 0.4489655848612609, 'recall': 0.5420662022492374, 'f1-score': 0.4911428123530334, 'support': 219630}, '1': {'precision': 0.693440349952155, 'recall': 0.6304001582575438, 'f1-score': 0.660419293171773, 'support': 394294}, '2': {'precision': 0.4792477723991192, 'recall': 0.45858468213360126, 'f1-score': 0.46868859422953296, 'support': 224953}, 'accuracy': 0.561199079245229, 'macro avg': {'precision': 0.5405512357375116, 'recall': 0.5436836808801275, 'f1-score': 0.5400835665847797, 'support': 838877}, 'weighted avg': {'precision': 0.5719955427215346, 'recall': 0.561199079245229, 'f1-score': 0.564685843093426, 'support': 838877}}
[[119054  52226  48350]
 [ 81987 248563  63744]
 [ 64133  57660 103160]]
testing model out of sample: results/universal/W0/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 404s - 404s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8053821
{'0': {'precision': 0.47298372059534843, 'recall': 0.508585635209958, 'f1-score': 0.49013903003440557, 'support': 1259371}, '1': {'precision': 0.7517904874088599, 'recall': 0.7530529597098677, 'f1-score': 0.7524211939905526, 'support': 3290086}, '2': {'precision': 0.4924792108094494, 'recall': 0.45398697006480687, 'f1-score': 0.4724503616785713, 'support': 1283506}, 'accuracy': 0.6344634793671758, 'macro avg': {'precision': 0.5724178062712192, 'recall': 0.5718751883282109, 'f1-score': 0.5716701952345099, 'support': 5832963}, 'weighted avg': {'precision': 0.6345346885787111, 'recall': 0.6344634793671758, 'f1-score': 0.6341871516691735, 'support': 5832963}}
[[ 640498  382534  236339]
 [ 448324 2477609  364153]
 [ 265343  435468  582695]]
Evaluating performance on  train set...
6334/6334 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81383246
{'0': {'precision': 0.46220272957585334, 'recall': 0.4930576139580028, 'f1-score': 0.47713186578328703, 'support': 344118}, '1': {'precision': 0.7478085464562645, 'recall': 0.7587004809040133, 'f1-score': 0.7532151397919444, 'support': 927420}, '2': {'precision': 0.4880881610319545, 'recall': 0.43712252620491066, 'f1-score': 0.46120161149062877, 'support': 349362}, 'accuracy': 0.6329927817878956, 'macro avg': {'precision': 0.5660331456880241, 'recall': 0.562960207022309, 'f1-score': 0.5638495390219534, 'support': 1620900}, 'weighted avg': {'precision': 0.6311952231261015, 'recall': 0.6329927817878956, 'f1-score': 0.6316631289586324, 'support': 1620900}}
[[169670 111868  62580]
 [126198 703634  97588]
 [ 71222 125426 152714]]
Evaluating performance on  val set...
2156/2156 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8030272
{'0': {'precision': 0.45211110030158574, 'recall': 0.49723594343491984, 'f1-score': 0.4736010734516055, 'support': 112154}, '1': {'precision': 0.7520144958431039, 'recall': 0.7633613507723601, 'f1-score': 0.7576454417289628, 'support': 323489}, '2': {'precision': 0.485794884150504, 'recall': 0.41829246155574956, 'f1-score': 0.4495236856650519, 'support': 115687}, 'accuracy': 0.6368182395298642, 'macro avg': {'precision': 0.5633068267650645, 'recall': 0.5596299185876765, 'f1-score': 0.5602567336152068, 'support': 551330}, 'weighted avg': {'precision': 0.6351452639104226, 'recall': 0.6368182395298642, 'f1-score': 0.6352098882971807, 'support': 551330}}
[[ 55767  37653  18734]
 [ 44063 246939  32487]
 [ 23518  43778  48391]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.099437
{'0': {'precision': 0.3224554053873761, 'recall': 0.5395468244223686, 'f1-score': 0.40366436182650234, 'support': 44795}, '1': {'precision': 0.7879674732872407, 'recall': 0.3010611472998529, 'f1-score': 0.4356660367932929, 'support': 133252}, '2': {'precision': 0.29945060535151086, 'recall': 0.6383490934328099, 'f1-score': 0.40766492610700983, 'support': 46108}, 'accuracy': 0.4180990832236622, 'macro avg': {'precision': 0.4699578280087093, 'recall': 0.4929856883850105, 'f1-score': 0.4156651082422684, 'support': 224155}, 'weighted avg': {'precision': 0.5944533922792101, 'recall': 0.4180990832236622, 'f1-score': 0.4235110982835094, 'support': 224155}}
[[24169  5461 15165]
 [39443 40117 53692]
 [11341  5334 29433]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.158798
{'0': {'precision': 0.3506208911614317, 'recall': 0.5195294117647059, 'f1-score': 0.4186813811934695, 'support': 21250}, '1': {'precision': 0.6702378401542747, 'recall': 0.15962034036690226, 'f1-score': 0.25783584396315457, 'support': 39193}, '2': {'precision': 0.33714455416140765, 'recall': 0.6554245850372865, 'f1-score': 0.4452542816054386, 'support': 20785}, 'accuracy': 0.3806446053085143, 'macro avg': {'precision': 0.4526677618257047, 'recall': 0.4448581123896315, 'f1-score': 0.3739238355873542, 'support': 81228}, 'weighted avg': {'precision': 0.5013896090583514, 'recall': 0.3806446053085143, 'f1-score': 0.34787203705591896, 'support': 81228}}
[[11040  1669  8541]
 [14694  6256 18243]
 [ 5753  1409 13623]]
Evaluating performance on  val set...
104/104 - 1s - 959ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1274835
{'0': {'precision': 0.33702497285559174, 'recall': 0.4975953831356204, 'f1-score': 0.40186431900569647, 'support': 6238}, '1': {'precision': 0.7178171641791045, 'recall': 0.22447491248541424, 'f1-score': 0.342, 'support': 13712}, '2': {'precision': 0.32489419007310505, 'recall': 0.6452697539355036, 'f1-score': 0.43218343740403314, 'support': 6543}, 'accuracy': 0.39270750764352846, 'macro avg': {'precision': 0.45991210903593377, 'recall': 0.4557800165188461, 'f1-score': 0.3920159188032432, 'support': 26493}, 'weighted avg': {'precision': 0.5311158955779032, 'recall': 0.39270750764352846, 'f1-score': 0.37836824266380265, 'support': 26493}}
[[3104  612 2522]
 [4383 3078 6251]
 [1723  598 4222]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
2359/2359 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5865201
{'0': {'precision': 0.4941755309057334, 'recall': 0.4753394325757944, 'f1-score': 0.4845745043687484, 'support': 82196}, '1': {'precision': 0.8571740627723528, 'recall': 0.8774760015242198, 'f1-score': 0.867206227576238, 'support': 438257}, '2': {'precision': 0.5257596467248449, 'recall': 0.48003839923201536, 'f1-score': 0.5018598320192192, 'support': 83335}, 'accuracy': 0.7678771356833856, 'macro avg': {'precision': 0.6257030801343103, 'recall': 0.6109512777773433, 'f1-score': 0.6178801879880685, 'support': 603788}, 'weighted avg': {'precision': 0.7620157494461063, 'recall': 0.7678771356833856, 'f1-score': 0.7646918698968754, 'support': 603788}}
[[ 39071  32797  10328]
 [ 27941 384560  25756]
 [ 12051  31280  40004]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65058434
{'0': {'precision': 0.46316540816709867, 'recall': 0.5274438502673797, 'f1-score': 0.49321918630235634, 'support': 23375}, '1': {'precision': 0.831261573524524, 'recall': 0.839818865607491, 'f1-score': 0.8355183094155209, 'support': 104232}, '2': {'precision': 0.5336244076460253, 'recall': 0.4338903801194909, 'f1-score': 0.4786169679314215, 'support': 23098}, 'accuracy': 0.7291529809893501, 'macro avg': {'precision': 0.6093504631125494, 'recall': 0.6003843653314539, 'f1-score': 0.6024514878830995, 'support': 150705}, 'weighted avg': {'precision': 0.728550508047656, 'recall': 0.7291529809893501, 'f1-score': 0.7277252754195026, 'support': 150705}}
[[12329  8617  2429]
 [10366 87536  6330]
 [ 3924  9152 10022]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6508892
{'0': {'precision': 0.4970484061393152, 'recall': 0.4899492170969107, 'f1-score': 0.4934732804091854, 'support': 9452}, '1': {'precision': 0.8199869398021622, 'recall': 0.8481725164486028, 'f1-score': 0.8338416133792426, 'support': 39973}, '2': {'precision': 0.5351888180480627, 'recall': 0.464608834486429, 'f1-score': 0.49740755512506407, 'support': 9395}, 'accuracy': 0.7293437606256375, 'macro avg': {'precision': 0.61740805466318, 'recall': 0.6009101893439809, 'f1-score': 0.6082408163044973, 'support': 58820}, 'weighted avg': {'precision': 0.7226035094373033, 'recall': 0.7293437606256375, 'f1-score': 0.7254097966412115, 'support': 58820}}
[[ 4631  3812  1009]
 [ 3287 33904  2782]
 [ 1399  3631  4365]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
1625/1625 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8921318
{'0': {'precision': 0.48544649973888904, 'recall': 0.49595641918454453, 'f1-score': 0.490645183693312, 'support': 106836}, '1': {'precision': 0.6542567161939067, 'recall': 0.7019685594090296, 'f1-score': 0.677273389328543, 'support': 198724}, '2': {'precision': 0.5119911002716985, 'recall': 0.4339792004787335, 'f1-score': 0.469768423325498, 'support': 110291}, 'accuracy': 0.5779666274699351, 'macro avg': {'precision': 0.5505647720681647, 'recall': 0.5439680596907692, 'f1-score': 0.5458956654491177, 'support': 415851}, 'weighted avg': {'precision': 0.5731564535256325, 'recall': 0.5779666274699351, 'f1-score': 0.5742928958761108, 'support': 415851}}
[[ 52986  34457  19393]
 [ 32997 139498  26229]
 [ 23166  39261  47864]]
Evaluating performance on  train set...
451/451 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9314044
{'0': {'precision': 0.45977263388576906, 'recall': 0.5418563357546409, 'f1-score': 0.49745109662122106, 'support': 30975}, '1': {'precision': 0.6423851296518144, 'recall': 0.6275672002416188, 'f1-score': 0.634889716413635, 'support': 52976}, '2': {'precision': 0.5014159096759957, 'recall': 0.4328391377504048, 'f1-score': 0.4646106662123019, 'support': 31499}, 'accuracy': 0.5514421827631009, 'macro avg': {'precision': 0.5345245577378597, 'recall': 0.5340875579155548, 'f1-score': 0.5323171597490527, 'support': 115450}, 'weighted avg': {'precision': 0.5549289883233469, 'recall': 0.5514421827631009, 'f1-score': 0.5515568359427662, 'support': 115450}}
[[16784  8407  5784]
 [11957 33246  7773]
 [ 7764 10101 13634]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92976487
{'0': {'precision': 0.4685421603852916, 'recall': 0.5136176988184028, 'f1-score': 0.49004557447829217, 'support': 11933}, '1': {'precision': 0.6247430216090274, 'recall': 0.6609153738340341, 'f1-score': 0.6423203381869422, 'support': 20691}, '2': {'precision': 0.5136412882891757, 'recall': 0.41723337867029364, 'f1-score': 0.4604449938195303, 'support': 12499}, 'accuracy': 0.5544622476342442, 'macro avg': {'precision': 0.5356421567611649, 'recall': 0.5305888171075769, 'f1-score': 0.5309369688282549, 'support': 45123}, 'weighted avg': {'precision': 0.5526599278043676, 'recall': 0.5544622476342442, 'f1-score': 0.5516713413431241, 'support': 45123}}
[[ 6129  3763  2041]
 [ 4119 13675  2897]
 [ 2833  4451  5215]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1269/1269 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1787676
{'0': {'precision': 0.3617393451731731, 'recall': 0.4675787588334915, 'f1-score': 0.4079053217821782, 'support': 112781}, '1': {'precision': 0.36354758119464003, 'recall': 0.15831899194904359, 'f1-score': 0.22057931870797048, 'support': 101106}, '2': {'precision': 0.3526731132599755, 'recall': 0.42925944966043456, 'f1-score': 0.3872156594747633, 'support': 110877}, 'accuracy': 0.358217043761008, 'macro avg': {'precision': 0.3593200132092629, 'recall': 0.35171906681432324, 'f1-score': 0.3385667666549707, 'support': 324764}, 'weighted avg': {'precision': 0.35920700450532456, 'recall': 0.358217043761008, 'f1-score': 0.34252310406568226, 'support': 324764}}
[[52734 14169 45878]
 [43617 16007 41482]
 [49428 13854 47595]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1770604
{'0': {'precision': 0.35448709501308384, 'recall': 0.4561862538459675, 'f1-score': 0.39895758294843003, 'support': 41277}, '1': {'precision': 0.39285301928183813, 'recall': 0.1659553712961834, 'f1-score': 0.23333961973014214, 'support': 41005}, '2': {'precision': 0.3467870814286245, 'recall': 0.4446191599361494, 'f1-score': 0.389656216396797, 'support': 41973}, 'accuracy': 0.3565007444368436, 'macro avg': {'precision': 0.3647090652411822, 'recall': 0.35558692835943345, 'f1-score': 0.34065113969178973, 'support': 124255}, 'weighted avg': {'precision': 0.3645470688930867, 'recall': 0.3565007444368436, 'f1-score': 0.3411605458872447, 'support': 124255}}
[[18830  5218 17229]
 [16277  6805 17923]
 [18012  5299 18662]]
Evaluating performance on  val set...
178/178 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.167842
{'0': {'precision': 0.33523700742432894, 'recall': 0.43643122676579926, 'f1-score': 0.3791989664082687, 'support': 14795}, '1': {'precision': 0.37902648532569794, 'recall': 0.21382420244985867, 'f1-score': 0.27340791738382103, 'support': 14858}, '2': {'precision': 0.3491077921351457, 'recall': 0.3933320728556123, 'f1-score': 0.36990279753437644, 'support': 15867}, 'accuracy': 0.3487478031634446, 'macro avg': {'precision': 0.35445709496172423, 'recall': 0.3478625006904234, 'f1-score': 0.34083656044215543, 'support': 45520}, 'weighted avg': {'precision': 0.3543651226190801, 'recall': 0.3487478031634446, 'f1-score': 0.3414277511638203, 'support': 45520}}
[[6457 2523 5815]
 [5860 3177 5821]
 [6944 2682 6241]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
1733/1733 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0201858
{'0': {'precision': 0.4521183487361202, 'recall': 0.5889401752051453, 'f1-score': 0.5115383110452955, 'support': 144288}, '1': {'precision': 0.5436468870934891, 'recall': 0.41768437799526625, 'f1-score': 0.4724132463615279, 'support': 153367}, '2': {'precision': 0.499393728172399, 'recall': 0.47155775862660004, 'f1-score': 0.48507673211464686, 'support': 145857}, 'accuracy': 0.491116362127744, 'macro avg': {'precision': 0.4983863213340028, 'recall': 0.49272743727567053, 'f1-score': 0.4896760965071567, 'support': 443512}, 'weighted avg': {'precision': 0.4993164005604044, 'recall': 0.491116362127744, 'f1-score': 0.4893064428806393, 'support': 443512}}
[[84977 25647 33664]
 [54025 64059 35283]
 [48951 28126 68780]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99188834
{'0': {'precision': 0.48159954033052427, 'recall': 0.5396005456858628, 'f1-score': 0.5089529041818773, 'support': 65239}, '1': {'precision': 0.549791115327641, 'recall': 0.5123305518503583, 'f1-score': 0.5304002248002889, 'support': 64474}, '2': {'precision': 0.5055682489973956, 'recall': 0.4790540642836596, 'f1-score': 0.49195416595407265, 'support': 66051}, 'accuracy': 0.5101908420342862, 'macro avg': {'precision': 0.512319634885187, 'recall': 0.5103283872732935, 'f1-score': 0.5104357649787463, 'support': 195764}, 'weighted avg': {'precision': 0.5121452013433746, 'recall': 0.5101908420342862, 'f1-score': 0.5102810896034397, 'support': 195764}}
[[35203 13047 16989]
 [17486 33032 13956]
 [20407 14002 31642]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9924183
{'0': {'precision': 0.4809187559504919, 'recall': 0.5645957526080477, 'f1-score': 0.5194087403598973, 'support': 21472}, '1': {'precision': 0.5501492219143039, 'recall': 0.4904737017152088, 'f1-score': 0.5186003868277611, 'support': 21047}, '2': {'precision': 0.5175937530126289, 'recall': 0.48371548267939996, 'f1-score': 0.500081499592502, 'support': 22199}, 'accuracy': 0.5127476127197997, 'macro avg': {'precision': 0.5162205769591416, 'recall': 0.5129283123342189, 'f1-score': 0.5126968755933868, 'support': 64718}, 'weighted avg': {'precision': 0.5160131945444337, 'recall': 0.5127476127197997, 'f1-score': 0.5125163945737747, 'support': 64718}}
[[12123  3875  5474]
 [ 6190 10323  4534]
 [ 6895  4566 10738]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
4693/4693 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5519175
{'0': {'precision': 0.4616850440316732, 'recall': 0.5472747741162022, 'f1-score': 0.5008496347239692, 'support': 136796}, '1': {'precision': 0.8825250876811618, 'recall': 0.8814888349262863, 'f1-score': 0.8820066569354427, 'support': 925744}, '2': {'precision': 0.5325802813453518, 'recall': 0.43934454605775614, 'f1-score': 0.4814904102659358, 'support': 138652}, 'accuracy': 0.7923912247167814, 'macro avg': {'precision': 0.625596804352729, 'recall': 0.6227027183667482, 'f1-score': 0.6214489006417826, 'support': 1201192}, 'weighted avg': {'precision': 0.794204667715704, 'recall': 0.7923912247167814, 'f1-score': 0.7923680857131391, 'support': 1201192}}
[[ 74865  48069  13862]
 [ 70110 816033  39601]
 [ 17181  60555  60916]]
Evaluating performance on  train set...
1497/1497 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5824886
{'0': {'precision': 0.4858169369098228, 'recall': 0.523661800486618, 'f1-score': 0.5040299759957846, 'support': 49320}, '1': {'precision': 0.8562710908234064, 'recall': 0.879916576821789, 'f1-score': 0.8679328175285302, 'support': 282895}, '2': {'precision': 0.5298116089613034, 'recall': 0.4085875839321475, 'f1-score': 0.46136963220786126, 'support': 50934}, 'accuracy': 0.7714022482115312, 'macro avg': {'precision': 0.6239665455648442, 'recall': 0.6040553204135183, 'f1-score': 0.6111108085773921, 'support': 383149}, 'weighted avg': {'precision': 0.765187240623661, 'recall': 0.7714022482115312, 'f1-score': 0.7670436662439961, 'support': 383149}}
[[ 25827  17933   5560]
 [ 21062 248924  12909]
 [  6273  23850  20811]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55888206
{'0': {'precision': 0.4925830916796788, 'recall': 0.5276267845409474, 'f1-score': 0.5095030715542352, 'support': 16741}, '1': {'precision': 0.8667465648429443, 'recall': 0.8838592934355253, 'f1-score': 0.8752192879590974, 'support': 105553}, '2': {'precision': 0.5203309029725183, 'recall': 0.42317121842750444, 'f1-score': 0.4667484199603811, 'support': 17539}, 'accuracy': 0.7834273740819406, 'macro avg': {'precision': 0.6265535198317138, 'recall': 0.611552432134659, 'f1-score': 0.6171569264912379, 'support': 139833}, 'weighted avg': {'precision': 0.7785009075390774, 'recall': 0.7834273740819406, 'f1-score': 0.7802014757640986, 'support': 139833}}
[[ 8833  6044  1864]
 [ 7281 93294  4978]
 [ 1818  8299  7422]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
6677/6677 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53673077
{'0': {'precision': 0.4246577420072395, 'recall': 0.47150186357717006, 'f1-score': 0.4468554830884465, 'support': 178152}, '1': {'precision': 0.8807564391305827, 'recall': 0.9049324827583131, 'f1-score': 0.8926808039159684, 'support': 1345286}, '2': {'precision': 0.5488013367474027, 'recall': 0.3817259265636434, 'f1-score': 0.4502645049299149, 'support': 185848}, 'accuracy': 0.8028703212920483, 'macro avg': {'precision': 0.6180718392950749, 'recall': 0.5860534242997089, 'f1-score': 0.59660026397811, 'support': 1709286}, 'weighted avg': {'precision': 0.7971261473259186, 'recall': 0.8028703212920483, 'f1-score': 0.7981109912046815, 'support': 1709286}}
[[  83999   78470   15683]
 [  85250 1217393   42643]
 [  28555   86350   70943]]
Evaluating performance on  train set...
2262/2262 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7193056
{'0': {'precision': 0.4801664842895107, 'recall': 0.4729851981598753, 'f1-score': 0.47654878841063136, 'support': 103906}, '1': {'precision': 0.7843832031040737, 'recall': 0.8346018338065329, 'f1-score': 0.8087136629340558, 'support': 368414}, '2': {'precision': 0.5255208333333333, 'recall': 0.4168129711866157, 'f1-score': 0.4648966192478259, 'support': 106513}, 'accuracy': 0.692809497730779, 'macro avg': {'precision': 0.5966901735756392, 'recall': 0.5748000010510079, 'f1-score': 0.583386356864171, 'support': 578833}, 'weighted avg': {'precision': 0.6821392916882822, 'recall': 0.692809497730779, 'f1-score': 0.6858199989128574, 'support': 578833}}
[[ 49146  40079  14681]
 [ 35532 307479  25403]
 [ 17674  44443  44396]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6865704
{'0': {'precision': 0.4644142343062775, 'recall': 0.47690412646273866, 'f1-score': 0.47057631925453264, 'support': 34097}, '1': {'precision': 0.7985013759490733, 'recall': 0.8478707824029742, 'f1-score': 0.8224458643098874, 'support': 142024}, '2': {'precision': 0.5384734899980579, 'recall': 0.3911350619304235, 'f1-score': 0.4531280643263385, 'support': 35443}, 'accuracy': 0.7115671853434422, 'macro avg': {'precision': 0.6004630334178028, 'recall': 0.5719699902653788, 'f1-score': 0.5820500826302528, 'support': 211564}, 'weighted avg': {'precision': 0.7010956848562775, 'recall': 0.7115671853434422, 'f1-score': 0.7038650723860754, 'support': 211564}}
[[ 16261  14328   3508]
 [ 13232 120418   8374]
 [  5521  16059  13863]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
5633/5633 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6815367
{'0': {'precision': 0.4689212275716777, 'recall': 0.4598421027503982, 'f1-score': 0.4643372886741391, 'support': 230403}, '1': {'precision': 0.8079169268593467, 'recall': 0.8394559946786967, 'f1-score': 0.8233845519583607, 'support': 980211}, '2': {'precision': 0.5009269765368561, 'recall': 0.4276922411556094, 'f1-score': 0.4614218124469247, 'support': 231220}, 'accuracy': 0.712761663270529, 'macro avg': {'precision': 0.5925883769892936, 'recall': 0.5756634461949014, 'f1-score': 0.5830478843598081, 'support': 1441834}, 'weighted avg': {'precision': 0.7045153962971994, 'recall': 0.712761663270529, 'f1-score': 0.7079630878839188, 'support': 1441834}}
[[105949  97778  26676]
 [ 85518 822844  71849]
 [ 34475  97854  98891]]
Evaluating performance on  train set...
1454/1454 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8743886
{'0': {'precision': 0.4454440316456344, 'recall': 0.5082503240573144, 'f1-score': 0.47477909894185666, 'support': 85633}, '1': {'precision': 0.6973925284917242, 'recall': 0.6707685568216325, 'f1-score': 0.6838214957231342, 'support': 200883}, '2': {'precision': 0.4755709956389977, 'recall': 0.45109197349817126, 'f1-score': 0.46300816177220194, 'support': 85579}, 'accuracy': 0.5828430911460782, 'macro avg': {'precision': 0.5394691852587855, 'recall': 0.5433702847923727, 'f1-score': 0.540536252145731, 'support': 372095}, 'weighted avg': {'precision': 0.5883924865926805, 'recall': 0.5828430911460782, 'f1-score': 0.5849276329468056, 'support': 372095}}
[[ 43523  28525  13585]
 [ 37152 134746  28985]
 [ 17032  29943  38604]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84000033
{'0': {'precision': 0.4378361278076558, 'recall': 0.4907801418439716, 'f1-score': 0.46279886306637685, 'support': 31020}, '1': {'precision': 0.7168206885340203, 'recall': 0.7162653538092442, 'f1-score': 0.7165429135728394, 'support': 80029}, '2': {'precision': 0.49990965923463304, 'recall': 0.4411070722530451, 'f1-score': 0.468671127297366, 'support': 31362}, 'accuracy': 0.6065542689820309, 'macro avg': {'precision': 0.5515221585254364, 'recall': 0.5493841893020869, 'f1-score': 0.5493376346455274, 'support': 142411}, 'weighted avg': {'precision': 0.608283674015344, 'recall': 0.6065542689820309, 'f1-score': 0.6066855612062253, 'support': 142411}}
[[15224 11378  4418]
 [13286 57322  9421]
 [ 6261 11267 13834]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
11876/11876 - 91s - 91s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89157474
{'0': {'precision': 0.5034358392700116, 'recall': 0.5030319623073984, 'f1-score': 0.5032338197545175, 'support': 785300}, '1': {'precision': 0.6641946856434028, 'recall': 0.6970722672884504, 'f1-score': 0.6802364436236547, 'support': 1459457}, '2': {'precision': 0.5048764211669423, 'recall': 0.45942051943545525, 'f1-score': 0.48107709958787276, 'support': 795402}, 'accuracy': 0.5847727043223726, 'macro avg': {'precision': 0.557502315360119, 'recall': 0.553174916343768, 'f1-score': 0.5548491209886817, 'support': 3040159}, 'weighted avg': {'precision': 0.580986541510767, 'recall': 0.5847727043223726, 'f1-score': 0.5824086980717996, 'support': 3040159}}
[[ 395031  237780  152489]
 [ 236234 1017347  205876]
 [ 153405  276573  365424]]
Evaluating performance on  train set...
2538/2538 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7802777
{'0': {'precision': 0.46386848322060775, 'recall': 0.4671033336592042, 'f1-score': 0.46548028836786387, 'support': 122748}, '1': {'precision': 0.7558851086598425, 'recall': 0.8040227356889177, 'f1-score': 0.7792111760101161, 'support': 402363}, '2': {'precision': 0.5004080217067548, 'recall': 0.393987824662287, 'f1-score': 0.44086668943329077, 'support': 124514}, 'accuracy': 0.6617694823936887, 'macro avg': {'precision': 0.5733872045290683, 'recall': 0.5550379646701363, 'f1-score': 0.5618527179370902, 'support': 649625}, 'weighted avg': {'precision': 0.651740516403861, 'recall': 0.6617694823936887, 'f1-score': 0.6550803860960303, 'support': 649625}}
[[ 57336  48884  16528]
 [ 46405 323509  32449]
 [ 19863  55594  49057]]
Evaluating performance on  val set...
795/795 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79295355
{'0': {'precision': 0.4453752610244442, 'recall': 0.47193731452074766, 'f1-score': 0.4582717172866189, 'support': 38414}, '1': {'precision': 0.7489847428894331, 'recall': 0.7888664047930802, 'f1-score': 0.7684084409059289, 'support': 126015}, '2': {'precision': 0.48330111325911607, 'recall': 0.37176627438914955, 'f1-score': 0.42025940149264546, 'support': 39003}, 'accuracy': 0.649052263164104, 'macro avg': {'precision': 0.5592203723909978, 'recall': 0.5441899979009924, 'f1-score': 0.5489798532283977, 'support': 203432}, 'weighted avg': {'precision': 0.640716067150941, 'recall': 0.649052263164104, 'f1-score': 0.6430965475688508, 'support': 203432}}
[[18129 15162  5123]
 [16227 99409 10379]
 [ 6349 18154 14500]]
testing model on single stock: results/universal/W0/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
19053/19053 - 145s - 145s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9112794
{'0': {'precision': 0.4394526583636622, 'recall': 0.5092940276158112, 'f1-score': 0.4718026795391555, 'support': 1177369}, '1': {'precision': 0.6691974059991269, 'recall': 0.6321385751122139, 'f1-score': 0.6501403186221195, 'support': 2541351}, '2': {'precision': 0.4467150148020091, 'recall': 0.4288337845453345, 'f1-score': 0.43759180654138113, 'support': 1158731}, 'accuracy': 0.5541861927469902, 'macro avg': {'precision': 0.5184550263882661, 'recall': 0.52342212909112, 'f1-score': 0.5198449349008853, 'support': 4877451}, 'weighted avg': {'precision': 0.5608843573569066, 'recall': 0.5541861927469902, 'f1-score': 0.5565964249487036, 'support': 4877451}}
[[ 599627  378543  199199]
 [ 518618 1606486  416247]
 [ 246241  415587  496903]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.018541
{'0': {'precision': 0.45888752601992094, 'recall': 0.564768852140604, 'f1-score': 0.5063523011454752, 'support': 406731}, '1': {'precision': 0.500901653288792, 'recall': 0.39808698773086065, 'f1-score': 0.4436150162720111, 'support': 406793}, '2': {'precision': 0.4893638402431402, 'recall': 0.47725795039489033, 'f1-score': 0.4832350887468702, 'support': 418344}, 'accuracy': 0.48000759821669203, 'macro avg': {'precision': 0.4830510065172844, 'recall': 0.480037930088785, 'f1-score': 0.4777341353881188, 'support': 1231868}, 'weighted avg': {'precision': 0.48311141694937465, 'recall': 0.48000759821669203, 'f1-score': 0.47778427646327465, 'support': 1231868}}
[[229709  75725 101297]
 [137814 161939 107040]
 [133055  85631 199658]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0217309
{'0': {'precision': 0.45599368655944705, 'recall': 0.567544132988308, 'f1-score': 0.5056902374176492, 'support': 147622}, '1': {'precision': 0.5035948036493455, 'recall': 0.3960138028736491, 'f1-score': 0.44337168820869516, 'support': 153881}, '2': {'precision': 0.4830837004405286, 'recall': 0.4727037601962995, 'f1-score': 0.4778373667627539, 'support': 150790}, 'accuracy': 0.4775665331986124, 'macro avg': {'precision': 0.4808907302164404, 'recall': 0.47875389868608553, 'f1-score': 0.4756330974630328, 'support': 452293}, 'weighted avg': {'precision': 0.4812202779328244, 'recall': 0.4775665331986124, 'f1-score': 0.47520209137763814, 'support': 452293}}
[[83782 28281 35559]
 [52230 60939 40712]
 [47723 31788 71279]]
training model: results/universal/W0/deepVOL_L2/h20
Epoch 1/50
8838/8838 - 311s - loss: 2.9767 - accuracy20: 0.4833 - val_loss: 3.0175 - val_accuracy20: 0.4974 - 311s/epoch - 35ms/step
Epoch 2/50
8838/8838 - 312s - loss: 2.9091 - accuracy20: 0.5056 - val_loss: 3.0043 - val_accuracy20: 0.4990 - 312s/epoch - 35ms/step
Epoch 3/50
8838/8838 - 310s - loss: 2.8842 - accuracy20: 0.5122 - val_loss: 2.9590 - val_accuracy20: 0.5100 - 310s/epoch - 35ms/step
Epoch 4/50
8838/8838 - 309s - loss: 2.8669 - accuracy20: 0.5163 - val_loss: 2.9520 - val_accuracy20: 0.5095 - 309s/epoch - 35ms/step
Epoch 5/50
8838/8838 - 315s - loss: 2.8507 - accuracy20: 0.5192 - val_loss: 2.9344 - val_accuracy20: 0.5132 - 315s/epoch - 36ms/step
Epoch 6/50
8838/8838 - 318s - loss: 2.8383 - accuracy20: 0.5218 - val_loss: 2.9287 - val_accuracy20: 0.5137 - 318s/epoch - 36ms/step
Epoch 7/50
8838/8838 - 316s - loss: 2.8292 - accuracy20: 0.5238 - val_loss: 2.9272 - val_accuracy20: 0.5129 - 316s/epoch - 36ms/step
Epoch 8/50
8838/8838 - 315s - loss: 2.8212 - accuracy20: 0.5256 - val_loss: 2.9158 - val_accuracy20: 0.5141 - 315s/epoch - 36ms/step
Epoch 9/50
8838/8838 - 314s - loss: 2.8150 - accuracy20: 0.5269 - val_loss: 2.9114 - val_accuracy20: 0.5134 - 314s/epoch - 36ms/step
Epoch 10/50
8838/8838 - 315s - loss: 2.8095 - accuracy20: 0.5285 - val_loss: 2.9148 - val_accuracy20: 0.5138 - 315s/epoch - 36ms/step
Epoch 11/50
8838/8838 - 317s - loss: 2.8043 - accuracy20: 0.5296 - val_loss: 2.9081 - val_accuracy20: 0.5148 - 317s/epoch - 36ms/step
Epoch 12/50
8838/8838 - 313s - loss: 2.7998 - accuracy20: 0.5304 - val_loss: 2.9034 - val_accuracy20: 0.5148 - 313s/epoch - 35ms/step
Epoch 13/50
8838/8838 - 310s - loss: 2.7962 - accuracy20: 0.5315 - val_loss: 2.9039 - val_accuracy20: 0.5139 - 310s/epoch - 35ms/step
Epoch 14/50
8838/8838 - 315s - loss: 2.7924 - accuracy20: 0.5325 - val_loss: 2.9058 - val_accuracy20: 0.5148 - 315s/epoch - 36ms/step
Epoch 15/50
8838/8838 - 316s - loss: 2.7889 - accuracy20: 0.5333 - val_loss: 2.9005 - val_accuracy20: 0.5152 - 316s/epoch - 36ms/step
Epoch 16/50
8838/8838 - 308s - loss: 2.7862 - accuracy20: 0.5339 - val_loss: 2.8971 - val_accuracy20: 0.5160 - 308s/epoch - 35ms/step
Epoch 17/50
8838/8838 - 307s - loss: 2.7837 - accuracy20: 0.5348 - val_loss: 2.8977 - val_accuracy20: 0.5160 - 307s/epoch - 35ms/step
Epoch 18/50
8838/8838 - 308s - loss: 2.7813 - accuracy20: 0.5348 - val_loss: 2.8901 - val_accuracy20: 0.5158 - 308s/epoch - 35ms/step
Epoch 19/50
8838/8838 - 308s - loss: 2.7793 - accuracy20: 0.5357 - val_loss: 2.8940 - val_accuracy20: 0.5168 - 308s/epoch - 35ms/step
Epoch 20/50
8838/8838 - 303s - loss: 2.7769 - accuracy20: 0.5361 - val_loss: 2.8950 - val_accuracy20: 0.5161 - 303s/epoch - 34ms/step
Epoch 21/50
8838/8838 - 301s - loss: 2.7748 - accuracy20: 0.5368 - val_loss: 2.8918 - val_accuracy20: 0.5156 - 301s/epoch - 34ms/step
Epoch 22/50
8838/8838 - 309s - loss: 2.7729 - accuracy20: 0.5373 - val_loss: 2.8888 - val_accuracy20: 0.5166 - 309s/epoch - 35ms/step
Epoch 23/50
8838/8838 - 317s - loss: 2.7710 - accuracy20: 0.5377 - val_loss: 2.8900 - val_accuracy20: 0.5163 - 317s/epoch - 36ms/step
Epoch 24/50
8838/8838 - 315s - loss: 2.7687 - accuracy20: 0.5382 - val_loss: 2.8929 - val_accuracy20: 0.5159 - 315s/epoch - 36ms/step
Epoch 25/50
8838/8838 - 313s - loss: 2.7673 - accuracy20: 0.5385 - val_loss: 2.8919 - val_accuracy20: 0.5159 - 313s/epoch - 35ms/step
Epoch 26/50
8838/8838 - 316s - loss: 2.7660 - accuracy20: 0.5387 - val_loss: 2.8927 - val_accuracy20: 0.5171 - 316s/epoch - 36ms/step
Epoch 27/50
8838/8838 - 313s - loss: 2.7643 - accuracy20: 0.5395 - val_loss: 2.8916 - val_accuracy20: 0.5164 - 313s/epoch - 35ms/step
Epoch 28/50
8838/8838 - 316s - loss: 2.7624 - accuracy20: 0.5398 - val_loss: 2.8955 - val_accuracy20: 0.5157 - 316s/epoch - 36ms/step
Epoch 29/50
8838/8838 - 313s - loss: 2.7614 - accuracy20: 0.5398 - val_loss: 2.8907 - val_accuracy20: 0.5167 - 313s/epoch - 35ms/step
Epoch 30/50
8838/8838 - 315s - loss: 2.7596 - accuracy20: 0.5405 - val_loss: 2.8943 - val_accuracy20: 0.5160 - 315s/epoch - 36ms/step
Epoch 31/50
8838/8838 - 309s - loss: 2.7586 - accuracy20: 0.5406 - val_loss: 2.8869 - val_accuracy20: 0.5181 - 309s/epoch - 35ms/step
Epoch 32/50
8838/8838 - 306s - loss: 2.7571 - accuracy20: 0.5411 - val_loss: 2.8881 - val_accuracy20: 0.5171 - 306s/epoch - 35ms/step
Epoch 33/50
8838/8838 - 313s - loss: 2.7562 - accuracy20: 0.5411 - val_loss: 2.8862 - val_accuracy20: 0.5165 - 313s/epoch - 35ms/step
Epoch 34/50
8838/8838 - 306s - loss: 2.7546 - accuracy20: 0.5419 - val_loss: 2.8869 - val_accuracy20: 0.5170 - 306s/epoch - 35ms/step
Epoch 35/50
8838/8838 - 313s - loss: 2.7533 - accuracy20: 0.5421 - val_loss: 2.8885 - val_accuracy20: 0.5158 - 313s/epoch - 35ms/step
Epoch 36/50
8838/8838 - 308s - loss: 2.7522 - accuracy20: 0.5422 - val_loss: 2.8910 - val_accuracy20: 0.5155 - 308s/epoch - 35ms/step
Epoch 37/50
8838/8838 - 317s - loss: 2.7507 - accuracy20: 0.5425 - val_loss: 2.8889 - val_accuracy20: 0.5172 - 317s/epoch - 36ms/step
Epoch 38/50
8838/8838 - 309s - loss: 2.7499 - accuracy20: 0.5428 - val_loss: 2.8894 - val_accuracy20: 0.5165 - 309s/epoch - 35ms/step
Epoch 39/50
8838/8838 - 310s - loss: 2.7484 - accuracy20: 0.5430 - val_loss: 2.8900 - val_accuracy20: 0.5159 - 310s/epoch - 35ms/step
Epoch 40/50
8838/8838 - 308s - loss: 2.7474 - accuracy20: 0.5434 - val_loss: 2.8906 - val_accuracy20: 0.5165 - 308s/epoch - 35ms/step
Epoch 41/50
8838/8838 - 307s - loss: 2.7465 - accuracy20: 0.5437 - val_loss: 2.8921 - val_accuracy20: 0.5148 - 307s/epoch - 35ms/step
Epoch 42/50
8838/8838 - 304s - loss: 2.7456 - accuracy20: 0.5440 - val_loss: 2.8930 - val_accuracy20: 0.5148 - 304s/epoch - 34ms/step
Epoch 43/50
8838/8838 - 316s - loss: 2.7444 - accuracy20: 0.5441 - val_loss: 2.8906 - val_accuracy20: 0.5162 - 316s/epoch - 36ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 560s - 560s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89633465
{'0': {'precision': 0.4402665701237604, 'recall': 0.4517462687407227, 'f1-score': 0.4459325508315923, 'support': 1954367}, '1': {'precision': 0.7184458810968563, 'recall': 0.6380469608056252, 'f1-score': 0.6758638111119843, 'support': 4549709}, '2': {'precision': 0.42045418134713086, 'recall': 0.5195030419758215, 'f1-score': 0.46475992907230534, 'support': 1944953}, 'accuracy': 0.5676646393331115, 'macro avg': {'precision': 0.5263888775225825, 'recall': 0.5364320905073898, 'f1-score': 0.528852097005294, 'support': 8449029}, 'weighted avg': {'precision': 0.5855022829802107, 'recall': 0.5676646393331115, 'f1-score': 0.5740820328691675, 'support': 8449029}}
[[ 882878  600787  470702]
 [ 724755 2902928  922026]
 [ 397693  536851 1010409]]
Evaluating performance on  train set...
8838/8838 - 157s - 157s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97261494
{'0': {'precision': 0.44153006820274465, 'recall': 0.4904849986372142, 'f1-score': 0.46472183252355, 'support': 653074}, '1': {'precision': 0.6529593327460642, 'recall': 0.5087464144474431, 'f1-score': 0.5719016542994196, 'support': 942672}, '2': {'precision': 0.4442230852184537, 'recall': 0.5347502573815219, 'f1-score': 0.48530107780973153, 'support': 666326}, 'accuracy': 0.5111340399421416, 'macro avg': {'precision': 0.5129041620557542, 'recall': 0.5113272234887264, 'f1-score': 0.5073081882109004, 'support': 2262072}, 'weighted avg': {'precision': 0.5304321345037242, 'recall': 0.5111340399421416, 'f1-score': 0.5154487338545699, 'support': 2262072}}
[[320323 129810 202941]
 [220235 479581 242856]
 [184926 125082 356318]]
Evaluating performance on  val set...
3279/3279 - 57s - 57s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.963687
{'0': {'precision': 0.44050096412684475, 'recall': 0.48722031235482427, 'f1-score': 0.4626842625587304, 'support': 236782}, '1': {'precision': 0.6587328887328887, 'recall': 0.5215601811966762, 'f1-score': 0.5821754843112621, 'support': 359830}, '2': {'precision': 0.4449846276045768, 'recall': 0.5364869048356139, 'f1-score': 0.4864704021918342, 'support': 242265}, 'accuracy': 0.516178176299982, 'macro avg': {'precision': 0.5147394934881034, 'recall': 0.5150891327957048, 'f1-score': 0.5104433830206089, 'support': 838877}, 'weighted avg': {'precision': 0.5354047797797064, 'recall': 0.516178176299982, 'f1-score': 0.5208084874944806, 'support': 838877}}
[[115365  50329  71088]
 [ 81135 187673  91022]
 [ 65395  46898 129972]]
testing model out of sample: results/universal/W0/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 377s - 377s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8830389
{'0': {'precision': 0.512513146988556, 'recall': 0.4724438266274146, 'f1-score': 0.49166345098550185, 'support': 1557455}, '1': {'precision': 0.6760221388783334, 'recall': 0.7046852673591222, 'f1-score': 0.6900561835535416, 'support': 2693699}, '2': {'precision': 0.5035567730951162, 'recall': 0.5059612127633615, 'f1-score': 0.5047561295180866, 'support': 1581809}, 'accuracy': 0.5887837793587924, 'macro avg': {'precision': 0.5640306863206686, 'recall': 0.5610301022499661, 'f1-score': 0.5621585880190434, 'support': 5832963}, 'weighted avg': {'precision': 0.5855937982994752, 'recall': 0.5887837793587924, 'f1-score': 0.5868329938169489, 'support': 5832963}}
[[ 735810  461969  359676]
 [ 366137 1898210  429352]
 [ 333743  447732  800334]]
Evaluating performance on  train set...
6334/6334 - 110s - 110s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.907878
{'0': {'precision': 0.49471360520506563, 'recall': 0.43991528169774724, 'f1-score': 0.46570800034800336, 'support': 425882}, '1': {'precision': 0.6648653350174335, 'recall': 0.6908923956369848, 'f1-score': 0.6776290390237416, 'support': 763417}, '2': {'precision': 0.4809730668983493, 'recall': 0.5002398048197293, 'f1-score': 0.49041727854117756, 'support': 431601}, 'accuracy': 0.5741840952557221, 'macro avg': {'precision': 0.5468506690402828, 'recall': 0.5436824940514872, 'f1-score': 0.5445847726376408, 'support': 1620900}, 'weighted avg': {'precision': 0.571193519477662, 'recall': 0.5741840952557221, 'f1-score': 0.5720986924080739, 'support': 1620900}}
[[187352 137195 101335]
 [104327 527439 131651]
 [ 87029 128668 215904]]
Evaluating performance on  val set...
2156/2156 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8974047
{'0': {'precision': 0.48974610524663503, 'recall': 0.44595077468412325, 'f1-score': 0.46682351885031587, 'support': 139928}, '1': {'precision': 0.6693913584262314, 'recall': 0.6985401623202244, 'f1-score': 0.6836551992246748, 'support': 268112}, '2': {'precision': 0.482522480017762, 'recall': 0.48534440644846116, 'f1-score': 0.48392932940873573, 'support': 143290}, 'accuracy': 0.579023452378793, 'macro avg': {'precision': 0.5472199812302095, 'recall': 0.5432784478176029, 'f1-score': 0.5448026824945754, 'support': 551330}, 'weighted avg': {'precision': 0.5752302524206374, 'recall': 0.579023452378793, 'f1-score': 0.5767146314025914, 'support': 551330}}
[[ 62401  46822  30705]
 [ 36947 187287  43878]
 [ 28067  45678  69545]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
876/876 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.166448
{'0': {'precision': 0.3540536876355748, 'recall': 0.5647809396795646, 'f1-score': 0.4352530225904347, 'support': 55487}, '1': {'precision': 0.7263406429911379, 'recall': 0.20104024923010813, 'f1-score': 0.314916352315912, 'support': 111704}, '2': {'precision': 0.3357746478873239, 'recall': 0.6173021557474896, 'f1-score': 0.43495846965470747, 'support': 56964}, 'accuracy': 0.3968637772969597, 'macro avg': {'precision': 0.4720563261713456, 'recall': 0.46104111488572075, 'f1-score': 0.39504261485368475, 'support': 224155}, 'weighted avg': {'precision': 0.534931628528343, 'recall': 0.3968637772969597, 'f1-score': 0.3752103452922435, 'support': 224155}}
[[31338  4377 19772]
 [39458 22457 49789]
 [17716  4084 35164]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1765454
{'0': {'precision': 0.40273707347707766, 'recall': 0.5944766319042101, 'f1-score': 0.48017346270239913, 'support': 25890}, '1': {'precision': 0.5913229780396357, 'recall': 0.07359509366042263, 'f1-score': 0.1308987431823571, 'support': 30002}, '2': {'precision': 0.3919242323947248, 'recall': 0.6075939374802652, 'f1-score': 0.47649116290587185, 'support': 25336}, 'accuracy': 0.4061776727236913, 'macro avg': {'precision': 0.46199476130381273, 'recall': 0.42522188768163266, 'f1-score': 0.3625211229302094, 'support': 81228}, 'weighted avg': {'precision': 0.46901963819642783, 'recall': 0.4061776727236913, 'f1-score': 0.3500184067772857, 'support': 81228}}
[[15391   859  9640]
 [13550  2208 14244]
 [ 9275   667 15394]]
Evaluating performance on  val set...
104/104 - 1s - 923ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1612267
{'0': {'precision': 0.3826478976906799, 'recall': 0.5478856540640232, 'f1-score': 0.4505958829902492, 'support': 7591}, '1': {'precision': 0.6376459143968871, 'recall': 0.12058498896247241, 'f1-score': 0.20281559405940594, 'support': 10872}, '2': {'precision': 0.36851415094339623, 'recall': 0.6226650062266501, 'f1-score': 0.4630058338735068, 'support': 8030}, 'accuracy': 0.3951987317404597, 'macro avg': {'precision': 0.4629359876769878, 'recall': 0.43037854975104856, 'f1-score': 0.372139103641054, 'support': 26493}, 'weighted avg': {'precision': 0.48300816082619485, 'recall': 0.3951987317404597, 'f1-score': 0.3526750965310498, 'support': 26493}}
[[4159  364 3068]
 [4061 1311 5500]
 [2649  381 5000]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
2359/2359 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68622786
{'0': {'precision': 0.5623906927229868, 'recall': 0.41803023880175216, 'f1-score': 0.47958240796277984, 'support': 106155}, '1': {'precision': 0.8070191085642935, 'recall': 0.8372598711773445, 'f1-score': 0.8218614033250788, 'support': 389062}, '2': {'precision': 0.5095058602288005, 'recall': 0.568964088016137, 'f1-score': 0.5375959479922721, 'support': 108571}, 'accuracy': 0.715309015747249, 'macro avg': {'precision': 0.6263052205053602, 'recall': 0.6080847326650778, 'f1-score': 0.6130132530933768, 'support': 603788}, 'weighted avg': {'precision': 0.7105119895611555, 'recall': 0.715309015747249, 'f1-score': 0.710568016401816, 'support': 603788}}
[[ 44376  43614  18165]
 [ 22013 325746  41303]
 [ 12517  34281  61773]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7439087
{'0': {'precision': 0.5430229821946819, 'recall': 0.4544589227688975, 'f1-score': 0.4948092557848655, 'support': 30467}, '1': {'precision': 0.7658181137802356, 'recall': 0.8160430650628032, 'f1-score': 0.7901332546853633, 'support': 90282}, '2': {'precision': 0.5282030064818646, 'recall': 0.511416744558686, 'f1-score': 0.5196743554952509, 'support': 29956}, 'accuracy': 0.6823927540559371, 'macro avg': {'precision': 0.6123480341522607, 'recall': 0.5939729107967956, 'f1-score': 0.6015389553218266, 'support': 150705}, 'weighted avg': {'precision': 0.6735458107494997, 'recall': 0.6823927540559371, 'f1-score': 0.6766698456502254, 'support': 150705}}
[[13846 11904  4717]
 [ 7641 73674  8967]
 [ 4011 10625 15320]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75435376
{'0': {'precision': 0.5705589374654123, 'recall': 0.4214011280961334, 'f1-score': 0.4847658454015422, 'support': 12233}, '1': {'precision': 0.7505771812080537, 'recall': 0.8146324407796975, 'f1-score': 0.7812940995654665, 'support': 34321}, '2': {'precision': 0.5360191463901077, 'recall': 0.5477743355617153, 'f1-score': 0.5418329906052176, 'support': 12266}, 'accuracy': 0.6772016320979258, 'macro avg': {'precision': 0.6190517550211913, 'recall': 0.5946026348125154, 'f1-score': 0.6026309785240754, 'support': 58820}, 'weighted avg': {'precision': 0.6683954057782567, 'recall': 0.6772016320979258, 'f1-score': 0.6696881815835948, 'support': 58820}}
[[ 5155  5210  1868]
 [ 2414 27959  3948]
 [ 1466  4081  6719]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
1625/1625 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96450925
{'0': {'precision': 0.5350783113593077, 'recall': 0.4340778854519816, 'f1-score': 0.4793152284642333, 'support': 133324}, '1': {'precision': 0.5306537706509032, 'recall': 0.6621460763064644, 'f1-score': 0.589152175044309, 'support': 145335}, '2': {'precision': 0.5280066484625431, 'recall': 0.48626013178611, 'f1-score': 0.5062742612991724, 'support': 137192}, 'accuracy': 0.5310002861601871, 'macro avg': {'precision': 0.531246243490918, 'recall': 0.5274946978481853, 'f1-score': 0.5249138882692382, 'support': 415851}, 'weighted avg': {'precision': 0.5311989983361602, 'recall': 0.5310002861601871, 'f1-score': 0.5265959041483275, 'support': 415851}}
[[57873 42178 33273]
 [22741 96233 26361]
 [27544 42937 66711]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98891616
{'0': {'precision': 0.4989114366348609, 'recall': 0.48884675146822576, 'f1-score': 0.49382781738852827, 'support': 37971}, '1': {'precision': 0.5148267488558886, 'recall': 0.5686542528498478, 'f1-score': 0.5404034214847676, 'support': 38774}, '2': {'precision': 0.5159951435751193, 'recall': 0.47216121948068723, 'f1-score': 0.493105960443593, 'support': 38705}, 'accuracy': 0.5100563014291901, 'macro avg': {'precision': 0.509911109688623, 'recall': 0.5098874079329203, 'f1-score': 0.5091123997722963, 'support': 115450}, 'weighted avg': {'precision': 0.5099839805342186, 'recall': 0.5100563014291901, 'f1-score': 0.5092282764632261, 'support': 115450}}
[[18562  9939  9470]
 [ 9053 22049  7672]
 [ 9590 10840 18275]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9885413
{'0': {'precision': 0.5236057944907303, 'recall': 0.46944818304172276, 'f1-score': 0.49505020757194057, 'support': 14860}, '1': {'precision': 0.49214145383104124, 'recall': 0.6041401487237891, 'f1-score': 0.5424197768488165, 'support': 14927}, '2': {'precision': 0.532131196200653, 'recall': 0.4675925925925926, 'f1-score': 0.49777870331806195, 'support': 15336}, 'accuracy': 0.5133745539968531, 'macro avg': {'precision': 0.5159594815074748, 'recall': 0.5137269747860348, 'f1-score': 0.5117495625796064, 'support': 45123}, 'weighted avg': {'precision': 0.5160947102896842, 'recall': 0.5133745539968531, 'f1-score': 0.5116477248327266, 'support': 45123}}
[[6976 4492 3392]
 [2996 9018 2913]
 [3351 4814 7171]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1269/1269 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1862706
{'0': {'precision': 0.3592190943078561, 'recall': 0.5139026636440918, 'f1-score': 0.42285889159295253, 'support': 112928}, '1': {'precision': 0.3564978781787435, 'recall': 0.2229449970567988, 'f1-score': 0.27433047086481743, 'support': 100231}, '2': {'precision': 0.3662037681793765, 'recall': 0.3298508131356122, 'f1-score': 0.3470779848301285, 'support': 111605}, 'accuracy': 0.3608558830412238, 'macro avg': {'precision': 0.3606402468886587, 'recall': 0.35556615794550095, 'f1-score': 0.34808911576263285, 'support': 324764}, 'weighted avg': {'precision': 0.360779533006708, 'recall': 0.3608558830412238, 'f1-score': 0.3509769088692926, 'support': 324764}}
[[58034 20399 34495]
 [48667 22346 29218]
 [54855 19937 36813]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2009082
{'0': {'precision': 0.34633619984958963, 'recall': 0.5135764158262219, 'f1-score': 0.41369344034995215, 'support': 41248}, '1': {'precision': 0.38504501500500166, 'recall': 0.22436489046485647, 'f1-score': 0.28352208206733576, 'support': 41174}, '2': {'precision': 0.35800700821034864, 'recall': 0.33459230750842633, 'f1-score': 0.34590386753984925, 'support': 41833}, 'accuracy': 0.3574825962737918, 'macro avg': {'precision': 0.3631294076883133, 'recall': 0.35751120459983493, 'f1-score': 0.3477064633190457, 'support': 124255}, 'weighted avg': {'precision': 0.3630922392956044, 'recall': 0.3574825962737918, 'f1-score': 0.3477362015644426, 'support': 124255}}
[[21184  7183 12881]
 [19717  9238 12219]
 [20265  7571 13997]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.175555
{'0': {'precision': 0.33825849949792, 'recall': 0.4738428561859468, 'f1-score': 0.39473243680598186, 'support': 14929}, '1': {'precision': 0.3753113066578117, 'recall': 0.3007183716908341, 'f1-score': 0.3338995568685376, 'support': 15034}, '2': {'precision': 0.36533715468513656, 'recall': 0.29497975188018255, 'f1-score': 0.32641012874315384, 'support': 15557}, 'accuracy': 0.3555360281195079, 'macro avg': {'precision': 0.3596356536136227, 'recall': 0.3565136599189878, 'f1-score': 0.3516807074725578, 'support': 45520}, 'weighted avg': {'precision': 0.35975047097395996, 'recall': 0.3555360281195079, 'f1-score': 0.35129105579734937, 'support': 45520}}
[[7074 3718 4137]
 [6678 4521 3835]
 [7161 3807 4589]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
1733/1733 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0850313
{'0': {'precision': 0.4243526903159702, 'recall': 0.5396122234821007, 'f1-score': 0.4750917704251203, 'support': 141989}, '1': {'precision': 0.5041821812098646, 'recall': 0.2970237224769038, 'f1-score': 0.3738216794968231, 'support': 157277}, '2': {'precision': 0.4445690596704678, 'recall': 0.5248741732873009, 'f1-score': 0.48139552627897814, 'support': 144246}, 'accuracy': 0.44879281733075993, 'macro avg': {'precision': 0.45770131039876755, 'recall': 0.4538367064154351, 'f1-score': 0.44343632540030714, 'support': 443512}, 'weighted avg': {'precision': 0.45923669177078513, 'recall': 0.44879281733075993, 'f1-score': 0.44122985795367825, 'support': 443512}}
[[76619 23273 42097]
 [58068 46715 52494]
 [45868 22667 75711]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0485388
{'0': {'precision': 0.4513458435934449, 'recall': 0.48941165638523154, 'f1-score': 0.46960862266984715, 'support': 65166}, '1': {'precision': 0.519250469523647, 'recall': 0.3788893387734762, 'f1-score': 0.4381020977761772, 'support': 64214}, '2': {'precision': 0.4551542570866242, 'recall': 0.5364846951072547, 'f1-score': 0.49248427020673446, 'support': 66384}, 'accuracy': 0.4691209824073885, 'macro avg': {'precision': 0.47525019006790536, 'recall': 0.46826189675532087, 'f1-score': 0.4667316635509196, 'support': 195764}, 'weighted avg': {'precision': 0.47491118436505364, 'recall': 0.4691209824073885, 'f1-score': 0.46703111606274167, 'support': 195764}}
[[31893 11547 21726]
 [18978 24330 20906]
 [19791 10979 35614]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.05513
{'0': {'precision': 0.4540915280815417, 'recall': 0.5131505316172356, 'f1-score': 0.48181798279221494, 'support': 21444}, '1': {'precision': 0.511299052774019, 'recall': 0.3534777117732354, 'f1-score': 0.4179872230979839, 'support': 21379}, '2': {'precision': 0.4548920443493484, 'recall': 0.5340488696049326, 'f1-score': 0.4913025210084033, 'support': 21895}, 'accuracy': 0.46747427299978367, 'macro avg': {'precision': 0.47342754173496965, 'recall': 0.46689237099846786, 'f1-score': 0.4637025756328674, 'support': 64718}, 'weighted avg': {'precision': 0.47326033697681197, 'recall': 0.46747427299978367, 'f1-score': 0.4639408257839712, 'support': 64718}}
[[11004  3520  6920]
 [ 6730  7557  7092]
 [ 6499  3703 11693]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.631759
{'0': {'precision': 0.598017437663131, 'recall': 0.4525173998686802, 'f1-score': 0.5151914744745553, 'support': 190375}, '1': {'precision': 0.8248221077343126, 'recall': 0.884333794555462, 'f1-score': 0.8535418722057005, 'support': 818839}, '2': {'precision': 0.5650747417934683, 'recall': 0.5275135692631447, 'f1-score': 0.5456485135845041, 'support': 191978}, 'accuracy': 0.7588678579277918, 'macro avg': {'precision': 0.662638095730304, 'recall': 0.6214549212290957, 'f1-score': 0.63812728675492, 'support': 1201192}, 'weighted avg': {'precision': 0.7473626184242002, 'recall': 0.7588678579277918, 'f1-score': 0.7507088462036567, 'support': 1201192}}
[[ 86148  81304  22923]
 [ 39689 724127  55023]
 [ 18219  72488 101271]]
Evaluating performance on  train set...
1497/1497 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6733448
{'0': {'precision': 0.6077833353665976, 'recall': 0.44360679092959754, 'f1-score': 0.5128768251462691, 'support': 67384}, '1': {'precision': 0.7905269272625666, 'recall': 0.8709796328402223, 'f1-score': 0.8288054581197241, 'support': 246868}, '2': {'precision': 0.5461718434852764, 'recall': 0.4912986051642307, 'f1-score': 0.5172840638180818, 'support': 68897}, 'accuracy': 0.7275446366818131, 'macro avg': {'precision': 0.6481607020381469, 'recall': 0.6019616763113502, 'f1-score': 0.6196554490280249, 'support': 383149}, 'weighted avg': {'precision': 0.7144486224690739, 'recall': 0.7275446366818131, 'f1-score': 0.7172263478845844, 'support': 383149}}
[[ 29892  28610   8882]
 [ 12607 215017  19244]
 [  6683  28365  33849]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.646865
{'0': {'precision': 0.6173369079535299, 'recall': 0.44896013864818024, 'f1-score': 0.5198545089677662, 'support': 23080}, '1': {'precision': 0.8058949116356304, 'recall': 0.8791580854206877, 'f1-score': 0.8409338208371795, 'support': 92741}, '2': {'precision': 0.5613457670506491, 'recall': 0.5114109611860737, 'f1-score': 0.5352161785216178, 'support': 24012}, 'accuracy': 0.7450029678259066, 'macro avg': {'precision': 0.6615258622132698, 'recall': 0.6131763950849806, 'f1-score': 0.6320015027755211, 'support': 139833}, 'weighted avg': {'precision': 0.732778889060434, 'recall': 0.7450029678259066, 'f1-score': 0.7354408217223259, 'support': 139833}}
[[10362  9836  2882]
 [ 4493 81534  6714]
 [ 1930  9802 12280]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
6677/6677 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6612519
{'0': {'precision': 0.5112402264484378, 'recall': 0.40515826972010177, 'f1-score': 0.45205924371370226, 'support': 245625}, '1': {'precision': 0.8271136711353128, 'recall': 0.8773263859412566, 'f1-score': 0.8514803965642194, 'support': 1213309}, '2': {'precision': 0.5146292074619719, 'recall': 0.4679850770115677, 'f1-score': 0.4902000573206168, 'support': 250352}, 'accuracy': 0.7495211450863108, 'macro avg': {'precision': 0.6176610350152408, 'recall': 0.5834899108909753, 'f1-score': 0.5979132325328461, 'support': 1709286}, 'weighted avg': {'precision': 0.7359542482530322, 'recall': 0.7495211450863108, 'f1-score': 0.7411682099791642, 'support': 1709286}}
[[  99517  120226   25882]
 [  64223 1064468   84618]
 [  30918  102273  117161]]
Evaluating performance on  train set...
2262/2262 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82919234
{'0': {'precision': 0.5296393647525918, 'recall': 0.42483597493549574, 'f1-score': 0.471483854077183, 'support': 135650}, '1': {'precision': 0.7054723784456863, 'recall': 0.7828233714781527, 'f1-score': 0.7421377986301774, 'support': 305415}, '2': {'precision': 0.5133805663384761, 'recall': 0.48861854712269903, 'f1-score': 0.500693589595784, 'support': 137768}, 'accuracy': 0.6289050555168761, 'macro avg': {'precision': 0.5828307698455847, 'recall': 0.5654259645121158, 'f1-score': 0.5714384141010481, 'support': 578833}, 'weighted avg': {'precision': 0.6185460057650437, 'recall': 0.6289050555168761, 'f1-score': 0.6212437007317092, 'support': 578833}}
[[ 57629  51810  26211]
 [ 28733 239086  37596]
 [ 22446  48006  67316]]
Evaluating performance on  val set...
827/827 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80127776
{'0': {'precision': 0.524510322922181, 'recall': 0.4333734281027884, 'f1-score': 0.47460631099934136, 'support': 45725}, '1': {'precision': 0.7238451268357811, 'recall': 0.7959229898074746, 'f1-score': 0.7581748441745246, 'support': 119205}, '2': {'precision': 0.5214357629539441, 'recall': 0.47754856971308485, 'f1-score': 0.49852814434258985, 'support': 46634}, 'accuracy': 0.6473880244275964, 'macro avg': {'precision': 0.589930404237302, 'recall': 0.5689483292077826, 'f1-score': 0.5771030998388186, 'support': 211564}, 'weighted avg': {'precision': 0.6361471149612894, 'recall': 0.6473880244275964, 'f1-score': 0.6396549855057639, 'support': 211564}}
[[19816 18728  7181]
 [11069 94878 13258]
 [ 6895 17469 22270]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
5633/5633 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7984091
{'0': {'precision': 0.5312950557474329, 'recall': 0.38522275780005244, 'f1-score': 0.4466185895250028, 'support': 297498}, '1': {'precision': 0.7395210511475279, 'recall': 0.7877829285021641, 'f1-score': 0.7628894668311169, 'support': 845620}, '2': {'precision': 0.47563498430790324, 'recall': 0.5180003749380683, 'f1-score': 0.49591451816312765, 'support': 298716}, 'accuracy': 0.6488285059167699, 'macro avg': {'precision': 0.5821503637342881, 'recall': 0.563668687080095, 'f1-score': 0.5684741915064159, 'support': 1441834}, 'weighted avg': {'precision': 0.64188581191638, 'recall': 0.6488285059167699, 'f1-score': 0.6423210503399526, 'support': 1441834}}
[[114603 128863  54032]
 [ 62899 666165 116556]
 [ 38203 105778 154735]]
Evaluating performance on  train set...
1454/1454 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95164114
{'0': {'precision': 0.5022947953417216, 'recall': 0.45016928917202204, 'f1-score': 0.47480570585341864, 'support': 107213}, '1': {'precision': 0.5966217486681291, 'recall': 0.6045101226915944, 'f1-score': 0.6005400324271808, 'support': 157468}, '2': {'precision': 0.4769788249841144, 'recall': 0.5171392928296126, 'f1-score': 0.49624785591766724, 'support': 107414}, 'accuracy': 0.5348177212808557, 'macro avg': {'precision': 0.5252984563313218, 'recall': 0.5239395682310763, 'f1-score': 0.5238645313994222, 'support': 372095}, 'weighted avg': {'precision': 0.5349052497859113, 'recall': 0.5348177212808557, 'f1-score': 0.5342053754107048, 'support': 372095}}
[[48264 33016 25933]
 [27300 95191 34977]
 [20523 31343 55548]]
Evaluating performance on  val set...
557/557 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9237838
{'0': {'precision': 0.4990202482037884, 'recall': 0.431782567369692, 'f1-score': 0.46297290969439053, 'support': 38927}, '1': {'precision': 0.6184383347353197, 'recall': 0.6602593392049662, 'f1-score': 0.6386649394193401, 'support': 63469}, '2': {'precision': 0.5014401484085139, 'recall': 0.5133824815694115, 'f1-score': 0.5073410468863835, 'support': 40015}, 'accuracy': 0.5565370652547907, 'macro avg': {'precision': 0.5396329104492074, 'recall': 0.5351414627146899, 'f1-score': 0.5363262986667047, 'support': 142411}, 'weighted avg': {'precision': 0.552921834743886, 'recall': 0.5565370652547907, 'f1-score': 0.5537410978564737, 'support': 142411}}
[[16808 13649  8470]
 [ 9608 41906 11955]
 [ 7266 12206 20543]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
11876/11876 - 110s - 110s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9464343
{'0': {'precision': 0.5446135437051061, 'recall': 0.47971213928218304, 'f1-score': 0.5101067609100827, 'support': 981030}, '1': {'precision': 0.5493509708502311, 'recall': 0.6265531285820685, 'f1-score': 0.5854177558220606, 'support': 1066074}, '2': {'precision': 0.5265871300688958, 'recall': 0.5091359491669646, 'f1-score': 0.517714519762441, 'support': 993055}, 'accuracy': 0.5408151349978735, 'macro avg': {'precision': 0.540183881541411, 'recall': 0.5384670723437387, 'f1-score': 0.5377463454981948, 'support': 3040159}, 'weighted avg': {'precision': 0.5403865370626262, 'recall': 0.5408151349978735, 'f1-score': 0.5390006498668513, 'support': 3040159}}
[[470612 271927 238491]
 [182068 667952 216054]
 [211441 276014 505600]]
Evaluating performance on  train set...
2538/2538 - 26s - 26s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8872
{'0': {'precision': 0.5179496266703181, 'recall': 0.39890201916813994, 'f1-score': 0.4506970191829211, 'support': 161205}, '1': {'precision': 0.6653562612721183, 'recall': 0.7389419467588889, 'f1-score': 0.7002211470197632, 'support': 325012}, '2': {'precision': 0.4834695924383795, 'recall': 0.4867448350141976, 'f1-score': 0.48510168545664684, 'support': 163408}, 'accuracy': 0.5911225707138734, 'macro avg': {'precision': 0.5555918267936053, 'recall': 0.5415296003137421, 'f1-score': 0.5453399505531104, 'support': 649625}, 'weighted avg': {'precision': 0.5830250343153867, 'recall': 0.5911225707138734, 'f1-score': 0.5841899320833863, 'support': 649625}}
[[ 64305  62836  34064]
 [ 33934 240165  50913]
 [ 25914  57956  79538]]
Evaluating performance on  val set...
795/795 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89262044
{'0': {'precision': 0.4980487804878049, 'recall': 0.40589965810606665, 'f1-score': 0.447277347001358, 'support': 50308}, '1': {'precision': 0.6569021466700671, 'recall': 0.734274395698375, 'f1-score': 0.6934366877088748, 'support': 101729}, '2': {'precision': 0.4840212639313643, 'recall': 0.4588384084054869, 'f1-score': 0.47109353150345595, 'support': 51395}, 'accuracy': 0.583482441307169, 'macro avg': {'precision': 0.5463240636964121, 'recall': 0.5330041540699763, 'f1-score': 0.5372691887378963, 'support': 203432}, 'weighted avg': {'precision': 0.5739417072394324, 'recall': 0.583482441307169, 'f1-score': 0.5763896615502997, 'support': 203432}}
[[20420 19663 10225]
 [12118 74697 14914]
 [ 8462 19351 23582]]
testing model on single stock: results/universal/W0/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
19053/19053 - 149s - 149s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9971226
{'0': {'precision': 0.41235862744567575, 'recall': 0.46432811639467664, 'f1-score': 0.43680301112391884, 'support': 1247411}, '1': {'precision': 0.648665556603474, 'recall': 0.48599161003306823, 'f1-score': 0.5556674341752068, 'support': 2395957}, '2': {'precision': 0.39110801699433045, 'recall': 0.5317114002866906, 'f1-score': 0.45069834354401833, 'support': 1234083}, 'accuracy': 0.49201908947932027, 'macro avg': {'precision': 0.48404406701449343, 'recall': 0.4940103755714785, 'f1-score': 0.48105626294771464, 'support': 4877451}, 'weighted avg': {'precision': 0.523063219653061, 'recall': 0.49201908947932027, 'f1-score': 0.4987087155543044, 'support': 4877451}}
[[ 579208  326578  341625]
 [ 551607 1164415  679935]
 [ 273807  304100  656176]]
Evaluating performance on  train set...
4812/4812 - 43s - 43s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0769712
{'0': {'precision': 0.4200913242009132, 'recall': 0.5098018005615077, 'f1-score': 0.46061919972278614, 'support': 406762}, '1': {'precision': 0.47242448943864235, 'recall': 0.21223456547384978, 'f1-score': 0.29288973983709504, 'support': 406880}, '2': {'precision': 0.4280506181441094, 'recall': 0.5685012409558469, 'f1-score': 0.4883786134855533, 'support': 418226}, 'accuracy': 0.4314455769611679, 'macro avg': {'precision': 0.440188810594555, 'recall': 0.43017920233040147, 'f1-score': 0.4139625176818115, 'support': 1231868}, 'weighted avg': {'precision': 0.44007893808536697, 'recall': 0.4314455769611679, 'f1-score': 0.41464345065069164, 'support': 1231868}}
[[207368  49165 150229]
 [153064  86354 167462]
 [133194  47270 237762]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0805455
{'0': {'precision': 0.4192293493054446, 'recall': 0.515422083420837, 'f1-score': 0.4623757201546053, 'support': 147613}, '1': {'precision': 0.47616905126128556, 'recall': 0.20581466956211714, 'f1-score': 0.28740444368004414, 'support': 154265}, '2': {'precision': 0.42037995022828367, 'recall': 0.5705082604793404, 'f1-score': 0.48407122327928315, 'support': 150415}, 'accuracy': 0.42814281892490047, 'macro avg': {'precision': 0.4385927835983379, 'recall': 0.4305816711540982, 'f1-score': 0.41128379570464424, 'support': 452293}, 'weighted avg': {'precision': 0.43903259799606476, 'recall': 0.42814281892490047, 'f1-score': 0.4099127926654561, 'support': 452293}}
[[76083 17960 53570]
 [57766 31750 64749]
 [47634 16968 85813]]
training model: results/universal/W0/deepVOL_L2/h30
Epoch 1/50
8838/8838 - 312s - loss: 3.0396 - accuracy30: 0.4654 - val_loss: 3.1676 - val_accuracy30: 0.4398 - 312s/epoch - 35ms/step
Epoch 2/50
8838/8838 - 316s - loss: 2.9931 - accuracy30: 0.4808 - val_loss: 3.1225 - val_accuracy30: 0.4603 - 316s/epoch - 36ms/step
Epoch 3/50
8838/8838 - 312s - loss: 2.9715 - accuracy30: 0.4866 - val_loss: 3.1228 - val_accuracy30: 0.4719 - 312s/epoch - 35ms/step
Epoch 4/50
8838/8838 - 312s - loss: 2.9531 - accuracy30: 0.4915 - val_loss: 3.0806 - val_accuracy30: 0.4756 - 312s/epoch - 35ms/step
Epoch 5/50
8838/8838 - 310s - loss: 2.9395 - accuracy30: 0.4943 - val_loss: 3.0710 - val_accuracy30: 0.4775 - 310s/epoch - 35ms/step
Epoch 6/50
8838/8838 - 314s - loss: 2.9290 - accuracy30: 0.4971 - val_loss: 3.0685 - val_accuracy30: 0.4799 - 314s/epoch - 36ms/step
Epoch 7/50
8838/8838 - 315s - loss: 2.9201 - accuracy30: 0.4991 - val_loss: 3.0424 - val_accuracy30: 0.4811 - 315s/epoch - 36ms/step
Epoch 8/50
8838/8838 - 316s - loss: 2.9125 - accuracy30: 0.5010 - val_loss: 3.0436 - val_accuracy30: 0.4818 - 316s/epoch - 36ms/step
Epoch 9/50
8838/8838 - 318s - loss: 2.9069 - accuracy30: 0.5024 - val_loss: 3.0250 - val_accuracy30: 0.4826 - 318s/epoch - 36ms/step
Epoch 10/50
8838/8838 - 314s - loss: 2.9020 - accuracy30: 0.5037 - val_loss: 3.0208 - val_accuracy30: 0.4824 - 314s/epoch - 36ms/step
Epoch 11/50
8838/8838 - 309s - loss: 2.8973 - accuracy30: 0.5047 - val_loss: 3.0234 - val_accuracy30: 0.4809 - 309s/epoch - 35ms/step
Epoch 12/50
8838/8838 - 309s - loss: 2.8929 - accuracy30: 0.5062 - val_loss: 3.0172 - val_accuracy30: 0.4818 - 309s/epoch - 35ms/step
Epoch 13/50
8838/8838 - 302s - loss: 2.8890 - accuracy30: 0.5072 - val_loss: 3.0182 - val_accuracy30: 0.4830 - 302s/epoch - 34ms/step
Epoch 14/50
8838/8838 - 309s - loss: 2.8860 - accuracy30: 0.5079 - val_loss: 3.0177 - val_accuracy30: 0.4821 - 309s/epoch - 35ms/step
Epoch 15/50
8838/8838 - 317s - loss: 2.8825 - accuracy30: 0.5089 - val_loss: 3.0272 - val_accuracy30: 0.4823 - 317s/epoch - 36ms/step
Epoch 16/50
8838/8838 - 314s - loss: 2.8801 - accuracy30: 0.5096 - val_loss: 3.0195 - val_accuracy30: 0.4829 - 314s/epoch - 36ms/step
Epoch 17/50
8838/8838 - 311s - loss: 2.8771 - accuracy30: 0.5103 - val_loss: 3.0241 - val_accuracy30: 0.4830 - 311s/epoch - 35ms/step
Epoch 18/50
8838/8838 - 293s - loss: 2.8748 - accuracy30: 0.5110 - val_loss: 3.0261 - val_accuracy30: 0.4823 - 293s/epoch - 33ms/step
Epoch 19/50
8838/8838 - 297s - loss: 2.8720 - accuracy30: 0.5118 - val_loss: 3.0393 - val_accuracy30: 0.4821 - 297s/epoch - 34ms/step
Epoch 20/50
8838/8838 - 310s - loss: 2.8704 - accuracy30: 0.5122 - val_loss: 3.0225 - val_accuracy30: 0.4834 - 310s/epoch - 35ms/step
Epoch 21/50
8838/8838 - 310s - loss: 2.8682 - accuracy30: 0.5128 - val_loss: 3.0251 - val_accuracy30: 0.4822 - 310s/epoch - 35ms/step
Epoch 22/50
8838/8838 - 309s - loss: 2.8659 - accuracy30: 0.5133 - val_loss: 3.0193 - val_accuracy30: 0.4809 - 309s/epoch - 35ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 564s - 564s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96809417
{'0': {'precision': 0.41100822732713554, 'recall': 0.5424715460807961, 'f1-score': 0.46767697595340263, 'support': 2119831}, '1': {'precision': 0.6871838935344946, 'recall': 0.5284314436726738, 'f1-score': 0.5974415850384363, 'support': 4218006}, '2': {'precision': 0.41587005434062513, 'recall': 0.4742557758839556, 'f1-score': 0.4431480777014519, 'support': 2111192}, 'accuracy': 0.5184169683877283, 'macro avg': {'precision': 0.5046873917340851, 'recall': 0.5150529218791419, 'f1-score': 0.5027555462310969, 'support': 8449029}, 'weighted avg': {'precision': 0.5500981591302931, 'recall': 0.5184169683877283, 'f1-score': 0.5263301875768914, 'support': 8449029}}
[[1149948  481095  488788]
 [1071521 2228927  917558]
 [ 576402  533545 1001245]]
Evaluating performance on  train set...
8838/8838 - 160s - 160s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0244738
{'0': {'precision': 0.4200419050320349, 'recall': 0.5383930901233446, 'f1-score': 0.4719102711704118, 'support': 682154}, '1': {'precision': 0.6219361210926101, 'recall': 0.40849563865295563, 'f1-score': 0.49311017558270875, 'support': 881723}, '2': {'precision': 0.4350317281875667, 'recall': 0.5038148368292525, 'f1-score': 0.46690363967713977, 'support': 698195}, 'accuracy': 0.4770882624425748, 'macro avg': {'precision': 0.4923365847707372, 'recall': 0.4835678552018509, 'f1-score': 0.47730802881008677, 'support': 2262072}, 'weighted avg': {'precision': 0.5033640068243983, 'recall': 0.4770882624425748, 'f1-score': 0.4786283766253569, 'support': 2262072}}
[[367267 104026 210861]
 [275578 360180 245965]
 [231513 114921 351761]]
Evaluating performance on  val set...
3279/3279 - 53s - 53s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.017052
{'0': {'precision': 0.4193725355734613, 'recall': 0.542705358439421, 'f1-score': 0.47313366964233905, 'support': 247908}, '1': {'precision': 0.6288062743707905, 'recall': 0.42145137579258424, 'f1-score': 0.5046595364468034, 'support': 336715}, '2': {'precision': 0.4376603210867974, 'recall': 0.5032919836069443, 'f1-score': 0.46818723977198723, 'support': 254254}, 'accuracy': 0.4820897461725617, 'macro avg': {'precision': 0.495279710343683, 'recall': 0.48914957261298314, 'f1-score': 0.4819934819537099, 'support': 838877}, 'weighted avg': {'precision': 0.5089795029561055, 'recall': 0.4820897461725617, 'f1-score': 0.4842885620291952, 'support': 838877}}
[[134541  40059  73308]
 [103696 141909  91110]
 [ 82578  43712 127964]]
testing model out of sample: results/universal/W0/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 374s - 374s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94453144
{'0': {'precision': 0.4865137856548471, 'recall': 0.5206931366191156, 'f1-score': 0.5030235266634865, 'support': 1722431}, '1': {'precision': 0.6240026906252276, 'recall': 0.6164613052747776, 'f1-score': 0.620209074071038, 'support': 2362583}, '2': {'precision': 0.5008544272256938, 'recall': 0.47436281035659505, 'f1-score': 0.48724879856991915, 'support': 1747949}, 'accuracy': 0.5455993806235356, 'macro avg': {'precision': 0.5371236345019229, 'recall': 0.5371724174168294, 'f1-score': 0.5368271331014812, 'support': 5832963}, 'weighted avg': {'precision': 0.546499706989297, 'recall': 0.5455993806235356, 'f1-score': 0.5457611819433763, 'support': 5832963}}
[[ 896858  417703  407870]
 [ 487679 1456441  418463]
 [ 458901  459886  829162]]
Evaluating performance on  train set...
6334/6334 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97597677
{'0': {'precision': 0.45816422161874965, 'recall': 0.5243802272376958, 'f1-score': 0.48904099743119916, 'support': 473601}, '1': {'precision': 0.6000113280039271, 'recall': 0.5701319922320576, 'f1-score': 0.5846901791956434, 'support': 668903}, '2': {'precision': 0.47638739427738636, 'recall': 0.44139792138730255, 'f1-score': 0.45822569182611717, 'support': 478396}, 'accuracy': 0.5187692022950213, 'macro avg': {'precision': 0.5115209813000211, 'recall': 0.5119700469523519, 'f1-score': 0.5106522894843198, 'support': 1620900}, 'weighted avg': {'precision': 0.5220792366780165, 'recall': 0.5187692022950213, 'f1-score': 0.5194180137119896, 'support': 1620900}}
[[248347 119646 105608]
 [161052 381363 126488]
 [132649 134584 211163]]
Evaluating performance on  val set...
2156/2156 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9706345
{'0': {'precision': 0.45477751666639277, 'recall': 0.5318483782727628, 'f1-score': 0.49030272964577204, 'support': 156099}, '1': {'precision': 0.6051410619632794, 'recall': 0.580171084591826, 'f1-score': 0.5923930624867905, 'support': 236725}, '2': {'precision': 0.4763785079678466, 'recall': 0.42622992189570114, 'f1-score': 0.44991109660835227, 'support': 158506}, 'accuracy': 0.5222316942665917, 'macro avg': {'precision': 0.5120990288658397, 'recall': 0.5127497949200966, 'f1-score': 0.5108689629136381, 'support': 551330}, 'weighted avg': {'precision': 0.5255494626654019, 'recall': 0.5222316942665917, 'f1-score': 0.522524843181333, 'support': 551330}}
[[ 83021  41301  31777]
 [ 56901 137341  42483]
 [ 42631  48315  67560]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
876/876 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1860029
{'0': {'precision': 0.34178303638990165, 'recall': 0.5057855446216492, 'f1-score': 0.4079172425117336, 'support': 58940}, '1': {'precision': 0.6890102330380944, 'recall': 0.15275434432402032, 'f1-score': 0.25006827136893844, 'support': 104907}, '2': {'precision': 0.3223927864526061, 'recall': 0.6076805730583007, 'f1-score': 0.42128253909864755, 'support': 60308}, 'accuracy': 0.36797751555843056, 'macro avg': {'precision': 0.4510620186268674, 'recall': 0.42207348733465677, 'f1-score': 0.35975601765977316, 'support': 224155}, 'weighted avg': {'precision': 0.49907230642872985, 'recall': 0.36797751555843056, 'f1-score': 0.33763807091567904, 'support': 224155}}
[[29811  3464 25665]
 [37520 16025 51362]
 [19891  3769 36648]]
Evaluating performance on  train set...
318/318 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1605895
{'0': {'precision': 0.3992908871454436, 'recall': 0.574514273309454, 'f1-score': 0.4711380123726023, 'support': 27639}, '1': {'precision': 0.5293215791490993, 'recall': 0.051817943041536904, 'f1-score': 0.09439507860560492, 'support': 26651}, '2': {'precision': 0.3868883683817662, 'recall': 0.5579850025985597, 'f1-score': 0.45694569000896806, 'support': 26938}, 'accuracy': 0.3975353326439159, 'macro avg': {'precision': 0.43850027822543636, 'recall': 0.39477240631651683, 'f1-score': 0.34082626032905844, 'support': 81228}, 'weighted avg': {'precision': 0.4378410043726742, 'recall': 0.3975353326439159, 'f1-score': 0.34282156105463524, 'support': 81228}}
[[15879   609 11151]
 [12601  1381 12669]
 [11288   619 15031]]
Evaluating performance on  val set...
104/104 - 1s - 874ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1710777
{'0': {'precision': 0.3845597541131803, 'recall': 0.5253797702852908, 'f1-score': 0.4440732814865076, 'support': 8097}, '1': {'precision': 0.5870841487279843, 'recall': 0.08953442101074413, 'f1-score': 0.15537332757876565, 'support': 10052}, '2': {'precision': 0.3562383076701684, 'recall': 0.5933604985618408, 'f1-score': 0.4451937775379912, 'support': 8344}, 'accuracy': 0.38142150756803683, 'macro avg': {'precision': 0.44262740350377766, 'recall': 0.4027582299526253, 'f1-score': 0.3482134622010882, 'support': 26493}, 'weighted avg': {'precision': 0.4524818869613862, 'recall': 0.38142150756803683, 'f1-score': 0.33488736378647205, 'support': 26493}}
[[4254  276 3567]
 [3772  900 5380]
 [3036  357 4951]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
2359/2359 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.777166
{'0': {'precision': 0.5038543879785424, 'recall': 0.5092936191220636, 'f1-score': 0.5065594029020141, 'support': 121535}, '1': {'precision': 0.7641463362846891, 'recall': 0.8081604239647894, 'f1-score': 0.7855373298846435, 'support': 356256}, '2': {'precision': 0.5522680362885806, 'recall': 0.4565743628816559, 'f1-score': 0.49988269132176466, 'support': 125997}, 'accuracy': 0.6746341431098333, 'macro avg': {'precision': 0.6067562535172707, 'recall': 0.591342801989503, 'f1-score': 0.5973264747028074, 'support': 603788}, 'weighted avg': {'precision': 0.6675385665012598, 'recall': 0.6746341431098333, 'f1-score': 0.6697728399463855, 'support': 603788}}
[[ 61897  42681  16957]
 [ 38663 287912  29681]
 [ 22287  46183  57527]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8404289
{'0': {'precision': 0.47236433181926846, 'recall': 0.5653343251981345, 'f1-score': 0.5146846224977534, 'support': 34951}, '1': {'precision': 0.7160035032073283, 'recall': 0.7426621327997447, 'f1-score': 0.7290892109306739, 'support': 81461}, '2': {'precision': 0.5540379803945695, 'recall': 0.3938996296620301, 'f1-score': 0.46044244469441314, 'support': 34293}, 'accuracy': 0.6221757738628446, 'macro avg': {'precision': 0.5808019384737221, 'recall': 0.5672986958866365, 'f1-score': 0.5680720927076134, 'support': 150705}, 'weighted avg': {'precision': 0.6226441829923254, 'recall': 0.6221757738628446, 'f1-score': 0.618234505878691, 'support': 150705}}
[[19759 11080  4112]
 [14202 60498  6761]
 [ 7869 12916 13508]]
Evaluating performance on  val set...
230/230 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8383102
{'0': {'precision': 0.505771319934818, 'recall': 0.5300270385655329, 'f1-score': 0.5176151761517614, 'support': 14054}, '1': {'precision': 0.6950026676151521, 'recall': 0.7666753858226524, 'f1-score': 0.7290818071577376, 'support': 30584}, '2': {'precision': 0.574463975275256, 'recall': 0.41940487942462273, 'f1-score': 0.48483860449951094, 'support': 14182}, 'accuracy': 0.6264025841550493, 'macro avg': {'precision': 0.5917459876084087, 'recall': 0.5720357679376027, 'f1-score': 0.5771785292696701, 'support': 58820}, 'weighted avg': {'precision': 0.6207262804158351, 'recall': 0.6264025841550493, 'f1-score': 0.6196664869901592, 'support': 58820}}
[[ 7449  4980  1625]
 [ 4355 23448  2781]
 [ 2924  5310  5948]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
1625/1625 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0069075
{'0': {'precision': 0.4913938777646513, 'recall': 0.4790785828838023, 'f1-score': 0.48515808978229896, 'support': 137180}, '1': {'precision': 0.48893932843349186, 'recall': 0.5854616048317515, 'f1-score': 0.5328647714779331, 'support': 139080}, '2': {'precision': 0.5133032801778962, 'recall': 0.4249844187662528, 'f1-score': 0.4649872239030584, 'support': 139591}, 'accuracy': 0.4964999482987897, 'macro avg': {'precision': 0.4978788287920131, 'recall': 0.4965082021606022, 'f1-score': 0.4943366950544301, 'support': 415851}, 'weighted avg': {'precision': 0.49792741182201705, 'recall': 0.4964999482987897, 'f1-score': 0.49434256679757543, 'support': 415851}}
[[65720 41276 30184]
 [31589 81426 26065]
 [36433 43834 59324]]
Evaluating performance on  train set...
451/451 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0377029
{'0': {'precision': 0.4556807384281254, 'recall': 0.5228293316028553, 'f1-score': 0.4869510558826018, 'support': 38525}, '1': {'precision': 0.4646924829157175, 'recall': 0.4928190289097136, 'f1-score': 0.4783426524775181, 'support': 37669}, '2': {'precision': 0.4966612351832327, 'recall': 0.395990421846342, 'f1-score': 0.44064913896959823, 'support': 39256}, 'accuracy': 0.4699090515374621, 'macro avg': {'precision': 0.4723448188423585, 'recall': 0.47054626078630357, 'f1-score': 0.46864761577657266, 'support': 115450}, 'weighted avg': {'precision': 0.47255552217625535, 'recall': 0.4699090515374621, 'f1-score': 0.468398453039787, 'support': 115450}}
[[20142 10200  8183]
 [11534 18564  7571]
 [12526 11185 15545]]
Evaluating performance on  val set...
177/177 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0349755
{'0': {'precision': 0.4851574020644996, 'recall': 0.4944782068875384, 'f1-score': 0.4897734627831716, 'support': 15303}, '1': {'precision': 0.4433454797848343, 'recall': 0.5265146311306498, 'f1-score': 0.48136402172889126, 'support': 14558}, '2': {'precision': 0.49505597777232985, 'recall': 0.3969335604770017, 'f1-score': 0.4405978399214517, 'support': 15262}, 'accuracy': 0.4718214657713361, 'macro avg': {'precision': 0.4745196198738879, 'recall': 0.47264213283173, 'f1-score': 0.47057844147783817, 'support': 45123}, 'weighted avg': {'precision': 0.4750156583396927, 'recall': 0.4718214657713361, 'f1-score': 0.47042760814177403, 'support': 45123}}
[[7567 4635 3101]
 [3815 7665 3078]
 [4215 4989 6058]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1269/1269 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1954327
{'0': {'precision': 0.3353023334430517, 'recall': 0.6803798039605032, 'f1-score': 0.44922112439364503, 'support': 110794}, '1': {'precision': 0.37612107623318386, 'recall': 0.0064254182267377835, 'f1-score': 0.012634988184120588, 'support': 104429}, '2': {'precision': 0.33981581467370264, 'recall': 0.30451611725290073, 'f1-score': 0.32119901975416815, 'support': 109541}, 'accuracy': 0.3368907883878755, 'macro avg': {'precision': 0.35041307478331274, 'recall': 0.3304404464800473, 'f1-score': 0.2610183774439779, 'support': 324764}, 'weighted avg': {'precision': 0.34995011379529967, 'recall': 0.3368907883878755, 'f1-score': 0.26565421740106776, 'support': 324764}}
[[75382   572 34840]
 [73793   671 29965]
 [75643   541 33357]]
Evaluating performance on  train set...
486/486 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.205197
{'0': {'precision': 0.3258723075301311, 'recall': 0.6739662314381919, 'f1-score': 0.4393247959070884, 'support': 41281}, '1': {'precision': 0.4385733157199472, 'recall': 0.008076286854140313, 'f1-score': 0.015860504000955452, 'support': 41108}, '2': {'precision': 0.33718947561711393, 'recall': 0.3070271819614962, 'f1-score': 0.32140222786202755, 'support': 41866}, 'accuracy': 0.330030984668625, 'macro avg': {'precision': 0.36721169962239736, 'recall': 0.32968990008460947, 'f1-score': 0.25886250925669047, 'support': 124255}, 'weighted avg': {'precision': 0.36697099654704457, 'recall': 0.330030984668625, 'f1-score': 0.25949528123603427, 'support': 124255}}
[[27822   209 13250]
 [28759   332 12017]
 [28796   216 12854]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1916782
{'0': {'precision': 0.3245354407591615, 'recall': 0.7104876419505678, 'f1-score': 0.44555222755168294, 'support': 14970}, '1': {'precision': 0.44, 'recall': 0.005788331250411103, 'f1-score': 0.011426345517107058, 'support': 15203}, '2': {'precision': 0.3408782976010202, 'recall': 0.27868638821919595, 'f1-score': 0.30666093066609307, 'support': 15347}, 'accuracy': 0.32954745166959576, 'macro avg': {'precision': 0.3684712461200606, 'recall': 0.3316541204733916, 'f1-score': 0.25454650124496103, 'support': 45520}, 'weighted avg': {'precision': 0.36860884845007696, 'recall': 0.32954745166959576, 'f1-score': 0.25373367487429266, 'support': 45520}}
[[10636    49  4285]
 [11130    88  3985]
 [11007    63  4277]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
1733/1733 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1309983
{'0': {'precision': 0.3903506063039137, 'recall': 0.5362246088364431, 'f1-score': 0.45180487833937494, 'support': 141437}, '1': {'precision': 0.4386083413745041, 'recall': 0.2604623622368094, 'f1-score': 0.3268366535774348, 'support': 157063}, '2': {'precision': 0.4317537672330875, 'recall': 0.4643201941908256, 'f1-score': 0.44744519241631836, 'support': 145012}, 'accuracy': 0.41505754072043144, 'macro avg': {'precision': 0.42023757163716846, 'recall': 0.42033572175469275, 'f1-score': 0.4086955747777094, 'support': 443512}, 'weighted avg': {'precision': 0.420977646420198, 'recall': 0.41505754072043144, 'f1-score': 0.4061238346227249, 'support': 443512}}
[[75842 26891 38704]
 [66240 40909 49914]
 [52210 25470 67332]]
Evaluating performance on  train set...
765/765 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.094765
{'0': {'precision': 0.4148186965579826, 'recall': 0.5012587455789458, 'f1-score': 0.4539605276041011, 'support': 64747}, '1': {'precision': 0.4544985068594652, 'recall': 0.31284484490672765, 'f1-score': 0.3705968509703405, 'support': 64703}, '2': {'precision': 0.43441387625363076, 'recall': 0.4781343306089212, 'f1-score': 0.4552267734849464, 'support': 66314}, 'accuracy': 0.43115179501849166, 'macro avg': {'precision': 0.4345770265570262, 'recall': 0.4307459736981982, 'f1-score': 0.4265947173531293, 'support': 195764}, 'weighted avg': {'precision': 0.43457124305414147, 'recall': 0.43115179501849166, 'f1-score': 0.4268364897836038, 'support': 195764}}
[[32455 12160 20132]
 [23312 20242 21149]
 [22472 12135 31707]]
Evaluating performance on  val set...
253/253 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1098702
{'0': {'precision': 0.4115826034430686, 'recall': 0.5158268275372605, 'f1-score': 0.4578459987821011, 'support': 21135}, '1': {'precision': 0.4446307599436582, 'recall': 0.30062128701646185, 'f1-score': 0.3587121212121212, 'support': 22051}, '2': {'precision': 0.42759744436344926, 'recall': 0.46312465168121864, 'f1-score': 0.4446525316032372, 'support': 21532}, 'accuracy': 0.42496677894866963, 'macro avg': {'precision': 0.4279369359167253, 'recall': 0.426524255411647, 'f1-score': 0.4204035505324865, 'support': 64718}, 'weighted avg': {'precision': 0.4281711329664182, 'recall': 0.42496677894866963, 'f1-score': 0.4196791384095475, 'support': 64718}}
[[10902  3990  6243]
 [ 8316  6629  7106]
 [ 7270  4290  9972]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
4693/4693 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7386284
{'0': {'precision': 0.5393224552839485, 'recall': 0.5708646616541353, 'f1-score': 0.5546454759937905, 'support': 228760}, '1': {'precision': 0.7767786715197432, 'recall': 0.8460075917629776, 'f1-score': 0.8099164604658388, 'support': 742647}, '2': {'precision': 0.6321304229158762, 'recall': 0.41324716582892707, 'f1-score': 0.4997736865927727, 'support': 229785}, 'accuracy': 0.7108222498984342, 'macro avg': {'precision': 0.6494105165731893, 'recall': 0.6100398064153466, 'f1-score': 0.621445207684134, 'support': 1201192}, 'weighted avg': {'precision': 0.7038856770346484, 'recall': 0.7108222498984342, 'f1-score': 0.7019720621496259, 'support': 1201192}}
[[130591  80374  17795]
 [ 76896 628285  37466]
 [ 34652 100175  94958]]
Evaluating performance on  train set...
1497/1497 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77377576
{'0': {'precision': 0.5556867930826411, 'recall': 0.5414977731071411, 'f1-score': 0.5485005354099213, 'support': 79932}, '1': {'precision': 0.7327585183543778, 'recall': 0.8352103338008922, 'f1-score': 0.7806373013965997, 'support': 221719}, '2': {'precision': 0.5933306686461486, 'recall': 0.3825001840535964, 'f1-score': 0.46514022247588355, 'support': 81498}, 'accuracy': 0.6776423793354543, 'macro avg': {'precision': 0.6272586600277225, 'recall': 0.5864027636538766, 'f1-score': 0.5980926864274682, 'support': 383149}, 'weighted avg': {'precision': 0.6661609595980149, 'recall': 0.6776423793354543, 'f1-score': 0.6651012125206592, 'support': 383149}}
[[ 43283  29752   6897]
 [ 22068 185182  14469]
 [ 12540  37785  31173]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74895996
{'0': {'precision': 0.5670387846702728, 'recall': 0.5356405145859757, 'f1-score': 0.550892624203347, 'support': 27595}, '1': {'precision': 0.7477564136443876, 'recall': 0.8461115230964285, 'f1-score': 0.7938992980152518, 'support': 83606}, '2': {'precision': 0.6104993998851954, 'recall': 0.4085987706063146, 'f1-score': 0.4895491160163197, 'support': 28632}, 'accuracy': 0.6952579147983666, 'macro avg': {'precision': 0.6417648660666186, 'recall': 0.5967836027629062, 'f1-score': 0.6114470127449728, 'support': 139833}, 'weighted avg': {'precision': 0.6839885921037364, 'recall': 0.6952579147983666, 'f1-score': 0.6836254458141766, 'support': 139833}}
[[14781 10617  2197]
 [ 7599 70740  5267]
 [ 3687 13246 11699]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
6677/6677 - 62s - 62s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7829016
{'0': {'precision': 0.4597767995609954, 'recall': 0.5186968400086133, 'f1-score': 0.4874628470246, 'support': 297216}, '1': {'precision': 0.7849318962886586, 'recall': 0.8095521183591123, 'f1-score': 0.7970519284867099, 'support': 1115250}, '2': {'precision': 0.5170971302921551, 'recall': 0.3898019001414999, 'f1-score': 0.4445157336847423, 'support': 296820}, 'accuracy': 0.6860870562328364, 'macro avg': {'precision': 0.5872686087139364, 'recall': 0.5726836195030751, 'f1-score': 0.5763435030653508, 'support': 1709286}, 'weighted avg': {'precision': 0.6818830136136168, 'recall': 0.6860870562328364, 'f1-score': 0.682001186962493, 'support': 1709286}}
[[154165 116715  26336]
 [130683 902853  81714]
 [ 50456 130663 115701]]
Evaluating performance on  train set...
2262/2262 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91957474
{'0': {'precision': 0.47527760801632785, 'recall': 0.5267445798375708, 'f1-score': 0.4996893421630878, 'support': 156499}, '1': {'precision': 0.6415675287199075, 'recall': 0.6652191839374808, 'f1-score': 0.6531793195661862, 'support': 264367}, '2': {'precision': 0.5081051845757728, 'recall': 0.4222464185557743, 'f1-score': 0.4612140049301448, 'support': 157967}, 'accuracy': 0.5614710978814269, 'macro avg': {'precision': 0.5416501071040027, 'recall': 0.538070060776942, 'f1-score': 0.5380275555531396, 'support': 578833}, 'weighted avg': {'precision': 0.5601850705366214, 'recall': 0.5614710978814269, 'f1-score': 0.5592917685269071, 'support': 578833}}
[[ 82435  45668  28396]
 [ 52328 175862  36177]
 [ 38683  52583  66701]]
Evaluating performance on  val set...
827/827 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8958774
{'0': {'precision': 0.47649415419834845, 'recall': 0.5441744943883172, 'f1-score': 0.5080903891756173, 'support': 53549}, '1': {'precision': 0.6659914871373632, 'recall': 0.6857513575856601, 'f1-score': 0.6757269967846877, 'support': 104045}, '2': {'precision': 0.5200683966078979, 'recall': 0.41702797850657775, 'f1-score': 0.4628831737739982, 'support': 53970}, 'accuracy': 0.5813654496984364, 'macro avg': {'precision': 0.5541846793145365, 'recall': 0.5489846101601851, 'f1-score': 0.548900186578101, 'support': 211564}, 'weighted avg': {'precision': 0.5808027883160772, 'recall': 0.5813654496984364, 'f1-score': 0.5789999835464004, 'support': 211564}}
[[29140 16644  7765]
 [19691 71349 13005]
 [12324 19139 22507]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
5633/5633 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87685883
{'0': {'precision': 0.49130720938130173, 'recall': 0.47826214151768603, 'f1-score': 0.48469691803667525, 'support': 341823}, '1': {'precision': 0.6895682236997241, 'recall': 0.7320556037537169, 'f1-score': 0.710177013892815, 'support': 754985}, '2': {'precision': 0.4946388628797337, 'recall': 0.4409609710572537, 'f1-score': 0.46626009408375607, 'support': 345026}, 'accuracy': 0.6022295215676701, 'macro avg': {'precision': 0.5585047653202532, 'recall': 0.5504262387762189, 'f1-score': 0.5537113420044154, 'support': 1441834}, 'weighted avg': {'precision': 0.5959195288127648, 'recall': 0.6022295215676701, 'f1-score': 0.5983527941977088, 'support': 1441834}}
[[163481 123431  54911]
 [101764 552691 100530]
 [ 67502 125381 152143]]
Evaluating performance on  train set...
1454/1454 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9978087
{'0': {'precision': 0.48786855911179794, 'recall': 0.4974208850262058, 'f1-score': 0.49259841743693766, 'support': 120584}, '1': {'precision': 0.5142336514255605, 'recall': 0.5394642898270342, 'f1-score': 0.5265468987092785, 'support': 130257}, '2': {'precision': 0.49085349593785, 'recall': 0.45542415095584476, 'f1-score': 0.4724755728195212, 'support': 121254}, 'accuracy': 0.4984533519665677, 'macro avg': {'precision': 0.49765190215840277, 'recall': 0.49743644193636155, 'f1-score': 0.49720696298857914, 'support': 372095}, 'weighted avg': {'precision': 0.4980707208162548, 'recall': 0.4984533519665677, 'f1-score': 0.49792515368400114, 'support': 372095}}
[[59981 32364 28239]
 [30947 70269 29041]
 [32017 34015 55222]]
Evaluating performance on  val set...
557/557 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9775468
{'0': {'precision': 0.4792643899872868, 'recall': 0.49640157104910665, 'f1-score': 0.487682476664176, 'support': 44047}, '1': {'precision': 0.5362265922487089, 'recall': 0.5855103280680437, 'f1-score': 0.5597858147660751, 'support': 52672}, '2': {'precision': 0.5200886037274671, 'recall': 0.44705856605094985, 'f1-score': 0.4808163073156953, 'support': 45692}, 'accuracy': 0.5135277471543631, 'macro avg': {'precision': 0.511859861987821, 'recall': 0.5096568217227001, 'f1-score': 0.5094281995819822, 'support': 142411}, 'weighted avg': {'precision': 0.5134306628997019, 'recall': 0.5135277471543631, 'f1-score': 0.5121475672444855, 'support': 142411}}
[[21865 13104  9078]
 [12061 30840  9771]
 [11696 13569 20427]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
11876/11876 - 86s - 86s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98175424
{'0': {'precision': 0.523207342117286, 'recall': 0.5254013669738098, 'f1-score': 0.5243020592446271, 'support': 1087658}, '1': {'precision': 0.46144366431740363, 'recall': 0.49111940095689033, 'f1-score': 0.4758192801222215, 'support': 846283}, '2': {'precision': 0.5259207128888346, 'recall': 0.49787745272631617, 'f1-score': 0.5115150107966286, 'support': 1106218}, 'accuracy': 0.5058432799073996, 'macro avg': {'precision': 0.5035239064411747, 'recall': 0.5047994068856722, 'f1-score': 0.5038787833878258, 'support': 3040159}, 'weighted avg': {'precision': 0.5070016203272886, 'recall': 0.5058432799073996, 'f1-score': 0.5061532009368562, 'support': 3040159}}
[[571457 228877 287324]
 [221510 415626 209147]
 [299252 256205 550761]]
Evaluating performance on  train set...
2538/2538 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9561448
{'0': {'precision': 0.47256103473016736, 'recall': 0.5235376575666922, 'f1-score': 0.49674494925688023, 'support': 186191}, '1': {'precision': 0.6028520200899757, 'recall': 0.6016485610479361, 'f1-score': 0.6022496893597541, 'support': 275513}, '2': {'precision': 0.4873980022092098, 'recall': 0.43673139244682607, 'f1-score': 0.4606757655617207, 'support': 187921}, 'accuracy': 0.5315543582836252, 'macro avg': {'precision': 0.5209370190097843, 'recall': 0.5206392036871516, 'f1-score': 0.5198901347261183, 'support': 649625}, 'weighted avg': {'precision': 0.5321108334833957, 'recall': 0.5315543582836252, 'f1-score': 0.5310566989444462, 'support': 649625}}
[[ 97478  50931  37782]
 [ 61218 165762  48533]
 [ 47580  58270  82071]]
Evaluating performance on  val set...
795/795 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96357965
{'0': {'precision': 0.45636387545477125, 'recall': 0.5383780056881841, 'f1-score': 0.49399000442841773, 'support': 58015}, '1': {'precision': 0.5892336127029886, 'recall': 0.5892884130250293, 'f1-score': 0.5892610115899236, 'support': 86019}, '2': {'precision': 0.4897271464749612, 'recall': 0.4037004612949931, 'f1-score': 0.44257211937764157, 'support': 59398}, 'accuracy': 0.5205818160368084, 'macro avg': {'precision': 0.5117748782109071, 'recall': 0.5104556266694021, 'f1-score': 0.5086077117986609, 'support': 203432}, 'weighted avg': {'precision': 0.5222877886071349, 'recall': 0.5205818160368084, 'f1-score': 0.5192613345474726, 'support': 203432}}
[[31234 15838 10943]
 [21287 50690 14042]
 [15920 19499 23979]]
testing model on single stock: results/universal/W0/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
19053/19053 - 182s - 182s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0600986
{'0': {'precision': 0.3832973375178025, 'recall': 0.5460631975087306, 'f1-score': 0.4504270664249343, 'support': 1316919}, '1': {'precision': 0.6055963557278977, 'recall': 0.3361661715395349, 'f1-score': 0.4323404308600839, 'support': 2259689}, '2': {'precision': 0.3794579711555249, 'recall': 0.5095895507759199, 'f1-score': 0.4349999573462546, 'support': 1300843}, 'accuracy': 0.43909164848606375, 'macro avg': {'precision': 0.456117221467075, 'recall': 0.46393963994139514, 'f1-score': 0.43925581821042425, 'support': 4877451}, 'weighted avg': {'precision': 0.48526294071983317, 'recall': 0.43909164848606375, 'f1-score': 0.4379331596100553, 'support': 4877451}}
[[719121 233687 364111]
 [780110 759631 719948]
 [376913 261034 662896]]
Evaluating performance on  train set...
4812/4812 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.114559
{'0': {'precision': 0.39659273463144373, 'recall': 0.5346566158369634, 'f1-score': 0.45539023303891824, 'support': 405406}, '1': {'precision': 0.4223696918119316, 'recall': 0.1084808118316805, 'f1-score': 0.17262489814501805, 'support': 407178}, '2': {'precision': 0.41187359126372575, 'recall': 0.5704868299291173, 'f1-score': 0.4783752568660097, 'support': 419284}, 'accuracy': 0.4059850568405056, 'macro avg': {'precision': 0.4102786725690337, 'recall': 0.40454141919925374, 'f1-score': 0.36879679601664866, 'support': 1231868}, 'weighted avg': {'precision': 0.4103140331496668, 'recall': 0.4059850568405056, 'f1-score': 0.3697491003841936, 'support': 1231868}}
[[216753  30306 158347]
 [179799  44171 183208]
 [149986  30102 239196]]
Evaluating performance on  val set...
1767/1767 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1182398
{'0': {'precision': 0.3960390136289333, 'recall': 0.541340106763016, 'f1-score': 0.4574281574152451, 'support': 147242}, '1': {'precision': 0.4208220852646055, 'recall': 0.10684772065955384, 'f1-score': 0.170424307432084, 'support': 154650}, '2': {'precision': 0.4059896866322888, 'recall': 0.5716318375542716, 'f1-score': 0.4747780707688485, 'support': 150401}, 'accuracy': 0.4028494803147517, 'macro avg': {'precision': 0.40761692850860914, 'recall': 0.40660655499228043, 'f1-score': 0.3675435118720592, 'support': 452293}, 'weighted avg': {'precision': 0.40782184732044385, 'recall': 0.4028494803147517, 'f1-score': 0.3650639132602381, 'support': 452293}}
[[79708 11318 56216]
 [68552 16524 69574]
 [53003 11424 85974]]
training model: results/universal/W0/deepVOL_L3/h10
Epoch 1/50
8838/8838 - 510s - loss: 2.9110 - accuracy10: 0.4940 - val_loss: 3.0476 - val_accuracy10: 0.5133 - 510s/epoch - 58ms/step
Epoch 2/50
8838/8838 - 506s - loss: 2.7878 - accuracy10: 0.5344 - val_loss: 3.0505 - val_accuracy10: 0.5208 - 506s/epoch - 57ms/step
Epoch 3/50
8838/8838 - 497s - loss: 2.7547 - accuracy10: 0.5428 - val_loss: 2.9365 - val_accuracy10: 0.5345 - 497s/epoch - 56ms/step
Epoch 4/50
8838/8838 - 502s - loss: 2.7341 - accuracy10: 0.5466 - val_loss: 2.9144 - val_accuracy10: 0.5370 - 502s/epoch - 57ms/step
Epoch 5/50
8838/8838 - 502s - loss: 2.7192 - accuracy10: 0.5497 - val_loss: 2.8147 - val_accuracy10: 0.5490 - 502s/epoch - 57ms/step
Epoch 6/50
8838/8838 - 513s - loss: 2.7066 - accuracy10: 0.5526 - val_loss: 2.7974 - val_accuracy10: 0.5531 - 513s/epoch - 58ms/step
Epoch 7/50
8838/8838 - 513s - loss: 2.6979 - accuracy10: 0.5546 - val_loss: 2.8053 - val_accuracy10: 0.5512 - 513s/epoch - 58ms/step
Epoch 8/50
8838/8838 - 516s - loss: 2.6908 - accuracy10: 0.5565 - val_loss: 2.7810 - val_accuracy10: 0.5556 - 516s/epoch - 58ms/step
Epoch 9/50
8838/8838 - 516s - loss: 2.6842 - accuracy10: 0.5582 - val_loss: 2.7751 - val_accuracy10: 0.5559 - 516s/epoch - 58ms/step
Epoch 10/50
8838/8838 - 513s - loss: 2.6791 - accuracy10: 0.5593 - val_loss: 2.7660 - val_accuracy10: 0.5554 - 513s/epoch - 58ms/step
Epoch 11/50
8838/8838 - 510s - loss: 2.6742 - accuracy10: 0.5603 - val_loss: 2.7623 - val_accuracy10: 0.5578 - 510s/epoch - 58ms/step
Epoch 12/50
8838/8838 - 513s - loss: 2.6696 - accuracy10: 0.5614 - val_loss: 2.7583 - val_accuracy10: 0.5584 - 513s/epoch - 58ms/step
Epoch 13/50
8838/8838 - 508s - loss: 2.6660 - accuracy10: 0.5624 - val_loss: 2.7851 - val_accuracy10: 0.5596 - 508s/epoch - 58ms/step
Epoch 14/50
8838/8838 - 511s - loss: 2.6622 - accuracy10: 0.5628 - val_loss: 2.7750 - val_accuracy10: 0.5602 - 511s/epoch - 58ms/step
Epoch 15/50
8838/8838 - 516s - loss: 2.6585 - accuracy10: 0.5639 - val_loss: 2.7735 - val_accuracy10: 0.5596 - 516s/epoch - 58ms/step
Epoch 16/50
8838/8838 - 506s - loss: 2.6557 - accuracy10: 0.5643 - val_loss: 2.7767 - val_accuracy10: 0.5597 - 506s/epoch - 57ms/step
Epoch 17/50
8838/8838 - 505s - loss: 2.6524 - accuracy10: 0.5650 - val_loss: 2.7611 - val_accuracy10: 0.5609 - 505s/epoch - 57ms/step
Epoch 18/50
8838/8838 - 496s - loss: 2.6498 - accuracy10: 0.5655 - val_loss: 2.7808 - val_accuracy10: 0.5604 - 496s/epoch - 56ms/step
Epoch 19/50
8838/8838 - 481s - loss: 2.6467 - accuracy10: 0.5663 - val_loss: 2.7684 - val_accuracy10: 0.5617 - 481s/epoch - 54ms/step
Epoch 20/50
8838/8838 - 496s - loss: 2.6442 - accuracy10: 0.5666 - val_loss: 2.7759 - val_accuracy10: 0.5617 - 496s/epoch - 56ms/step
Epoch 21/50
8838/8838 - 501s - loss: 2.6419 - accuracy10: 0.5673 - val_loss: 2.7880 - val_accuracy10: 0.5615 - 501s/epoch - 57ms/step
Epoch 22/50
8838/8838 - 496s - loss: 2.6398 - accuracy10: 0.5676 - val_loss: 2.7850 - val_accuracy10: 0.5612 - 496s/epoch - 56ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1044s - 1044s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8069709
{'0': {'precision': 0.4495487782579645, 'recall': 0.45368932680672247, 'f1-score': 0.4516095621542314, 'support': 1739545}, '1': {'precision': 0.7456107999587973, 'recall': 0.7402969798075629, 'f1-score': 0.7429443883902261, 'support': 4986669}, '2': {'precision': 0.443921135581508, 'recall': 0.44895011942663604, 'f1-score': 0.44642146494795165, 'support': 1722815}, 'accuracy': 0.6218805734954869, 'macro avg': {'precision': 0.5463602379327567, 'recall': 0.5476454753469738, 'f1-score': 0.5469918051641364, 'support': 8449029}, 'weighted avg': {'precision': 0.6231388935807113, 'recall': 0.6218805734954869, 'f1-score': 0.6224992839107769, 'support': 8449029}}
[[ 789213  609785  340547]
 [ 666726 3691616  628327]
 [ 299628  649729  773458]]
Evaluating performance on  train set...
8838/8838 - 284s - 284s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9080664
{'0': {'precision': 0.45768160554388787, 'recall': 0.4977850564703399, 'f1-score': 0.4768917073062827, 'support': 606336}, '1': {'precision': 0.6894023148301391, 'recall': 0.6032256943371744, 'f1-score': 0.6434414032370511, 'support': 1035808}, '2': {'precision': 0.45710543361334643, 'recall': 0.513401556309765, 'f1-score': 0.48362071257896755, 'support': 619928}, 'accuracy': 0.550346319657376, 'macro avg': {'precision': 0.5347297846624578, 'recall': 0.5381374357057598, 'f1-score': 0.5346512743741004, 'support': 2262072}, 'weighted avg': {'precision': 0.5636291524530123, 'recall': 0.550346319657376, 'f1-score': 0.5549993034497045, 'support': 2262072}}
[[301825 132568 171943]
 [204920 624826 206062]
 [152720 148936 318272]]
Evaluating performance on  val set...
3279/3279 - 97s - 97s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8955727
{'0': {'precision': 0.459723097600374, 'recall': 0.5014797614169285, 'f1-score': 0.47969443107604604, 'support': 219630}, '1': {'precision': 0.6994824034483356, 'recall': 0.6148762091231417, 'f1-score': 0.6544562259750357, 'support': 394294}, '2': {'precision': 0.4587607243486244, 'recall': 0.5153387596520163, 'f1-score': 0.48540664797790845, 'support': 224953}, 'accuracy': 0.558495464770163, 'macro avg': {'precision': 0.5393220751324447, 'recall': 0.5438982433973621, 'f1-score': 0.5398524350096634, 'support': 838877}, 'weighted avg': {'precision': 0.5721581351445137, 'recall': 0.558495464770163, 'f1-score': 0.5633688046571871, 'support': 838877}}
[[110140  49597  59893]
 [ 74976 242442  76876]
 [ 54463  54563 115927]]
testing model out of sample: results/universal/W0/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 666s - 666s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8003794
{'0': {'precision': 0.48657682743571634, 'recall': 0.46177258329753507, 'f1-score': 0.47385032570217755, 'support': 1259371}, '1': {'precision': 0.7468462589222847, 'recall': 0.7579431054385812, 'f1-score': 0.7523537661540698, 'support': 3290086}, '2': {'precision': 0.4796761675982815, 'recall': 0.4853993670462, 'f1-score': 0.4825207971418016, 'support': 1283506}, 'accuracy': 0.6340266516348552, 'macro avg': {'precision': 0.5710330846520942, 'recall': 0.5683716852607721, 'f1-score': 0.5695749629993497, 'support': 5832963}, 'weighted avg': {'precision': 0.6318634981134852, 'recall': 0.6340266516348552, 'f1-score': 0.6328482265114559, 'support': 5832963}}
[[ 581543  407181  270647]
 [ 391228 2493698  405160]
 [ 222401  438092  623013]]
Evaluating performance on  train set...
6334/6334 - 197s - 197s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8134048
{'0': {'precision': 0.4657780453196887, 'recall': 0.47218977211305424, 'f1-score': 0.46896199419024986, 'support': 344118}, '1': {'precision': 0.7433772374771318, 'recall': 0.7553492484526967, 'f1-score': 0.7493154260189456, 'support': 927420}, '2': {'precision': 0.47564522929184777, 'recall': 0.44886106674452286, 'f1-score': 0.46186516182142434, 'support': 349362}, 'accuracy': 0.6291751496082424, 'macro avg': {'precision': 0.5616001706962228, 'recall': 0.5588000291034246, 'f1-score': 0.5600475273435399, 'support': 1620900}, 'weighted avg': {'precision': 0.6267369335407618, 'recall': 0.6291751496082424, 'f1-score': 0.6278404050709528, 'support': 1620900}}
[[162489 114988  66641]
 [120661 700526 106233]
 [ 65705 126842 156815]]
Evaluating performance on  val set...
2156/2156 - 69s - 69s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8027592
{'0': {'precision': 0.45677316510649846, 'recall': 0.4803217005189293, 'f1-score': 0.4682515537398409, 'support': 112154}, '1': {'precision': 0.7490043002023445, 'recall': 0.7586594907400251, 'f1-score': 0.7538009791936702, 'support': 323489}, '2': {'precision': 0.47266278904809195, 'recall': 0.4320018671069351, 'f1-score': 0.45141855822817967, 'support': 115687}, 'accuracy': 0.633495365751909, 'macro avg': {'precision': 0.5594800847856449, 'recall': 0.5569943527886299, 'f1-score': 0.5578236970538969, 'support': 551330}, 'weighted avg': {'precision': 0.6315718892571003, 'recall': 0.633495365751909, 'f1-score': 0.6322635598684322, 'support': 551330}}
[[ 53870  37969  20315]
 [ 42628 245418  35443]
 [ 21438  44272  49977]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0613482
{'0': {'precision': 0.32833953495929674, 'recall': 0.45109945306395804, 'f1-score': 0.3800522861065659, 'support': 44795}, '1': {'precision': 0.8021576382512889, 'recall': 0.34094047368895025, 'f1-score': 0.47850311762723285, 'support': 133252}, '2': {'precision': 0.3049369668604212, 'recall': 0.700876203695671, 'f1-score': 0.4249756713395229, 'support': 46108}, 'accuracy': 0.43699225982021367, 'macro avg': {'precision': 0.4784780466903356, 'recall': 0.4976387101495265, 'f1-score': 0.42784369169110725, 'support': 224155}, 'weighted avg': {'precision': 0.6051933383094857, 'recall': 0.43699225982021367, 'f1-score': 0.44781833035323937, 'support': 224155}}
[[20207  5800 18788]
 [32949 45431 54872]
 [ 8387  5405 32316]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1247716
{'0': {'precision': 0.36400128452151576, 'recall': 0.42672941176470586, 'f1-score': 0.3928772583510246, 'support': 21250}, '1': {'precision': 0.6887362918929999, 'recall': 0.171459189140918, 'f1-score': 0.2745658835546476, 'support': 39193}, '2': {'precision': 0.33061277089284563, 'recall': 0.7405821505893674, 'f1-score': 0.4571454027084818, 'support': 20785}, 'accuracy': 0.3838700940562368, 'macro avg': {'precision': 0.46111678243578713, 'recall': 0.4462569171649971, 'f1-score': 0.374862848204718, 'support': 81228}, 'weighted avg': {'precision': 0.5121442757085285, 'recall': 0.3838700940562368, 'f1-score': 0.3522365392403158, 'support': 81228}}
[[ 9068  1627 10555]
 [11862  6720 20611]
 [ 3982  1410 15393]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1033628
{'0': {'precision': 0.35291564173057444, 'recall': 0.3909907021481244, 'f1-score': 0.37097878165639975, 'support': 6238}, '1': {'precision': 0.7383113935542442, 'recall': 0.23723745624270712, 'f1-score': 0.35909040732972736, 'support': 13712}, '2': {'precision': 0.32149446494464945, 'recall': 0.7456824086810332, 'f1-score': 0.44928403701827896, 'support': 6543}, 'accuracy': 0.3990110595251576, 'macro avg': {'precision': 0.47090716674315597, 'recall': 0.4579701890239549, 'f1-score': 0.39311774200146865, 'support': 26493}, 'weighted avg': {'precision': 0.5446250664577044, 'recall': 0.3990110595251576, 'f1-score': 0.38416482691610776, 'support': 26493}}
[[2439  574 3225]
 [3387 3253 7072]
 [1085  579 4879]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6082337
{'0': {'precision': 0.4875392776724719, 'recall': 0.4662513990948465, 'f1-score': 0.4766577737977526, 'support': 82196}, '1': {'precision': 0.857683866545739, 'recall': 0.8480161183962834, 'f1-score': 0.8528225945243892, 'support': 438257}, '2': {'precision': 0.46405556039362533, 'recall': 0.5115497690046199, 'f1-score': 0.48664661327975617, 'support': 83335}, 'accuracy': 0.7496058219110019, 'macro avg': {'precision': 0.6030929015372788, 'recall': 0.60860576216525, 'f1-score': 0.6053756605339661, 'support': 603788}, 'weighted avg': {'precision': 0.752965953105569, 'recall': 0.7496058219110019, 'f1-score': 0.7510741016734745, 'support': 603788}}
[[ 38324  32729  11143]
 [ 28517 371649  38091]
 [ 11766  28939  42630]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67366827
{'0': {'precision': 0.44215559390278975, 'recall': 0.5261604278074866, 'f1-score': 0.48051415287843563, 'support': 23375}, '1': {'precision': 0.8248110313721368, 'recall': 0.828095018804206, 'f1-score': 0.8264497627813231, 'support': 104232}, '2': {'precision': 0.5090998793991887, 'recall': 0.40206944324183913, 'f1-score': 0.44929850024189644, 'support': 23098}, 'accuracy': 0.7159682824060251, 'macro avg': {'precision': 0.592022168224705, 'recall': 0.5854416299511773, 'f1-score': 0.5854208053005517, 'support': 150705}, 'weighted avg': {'precision': 0.7170716263151238, 'recall': 0.7159682824060251, 'f1-score': 0.7149890631123295, 'support': 150705}}
[[12299  8775  2301]
 [11264 86314  6654]
 [ 4253  9558  9287]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6737018
{'0': {'precision': 0.4781936282090937, 'recall': 0.49068980110029625, 'f1-score': 0.48436112996710357, 'support': 9452}, '1': {'precision': 0.8144227915718667, 'recall': 0.8238561028694369, 'f1-score': 0.819112288425425, 'support': 39973}, '2': {'precision': 0.4938399539435809, 'recall': 0.45651942522618416, 'f1-score': 0.4744469026548673, 'support': 9395}, 'accuracy': 0.7116456987419245, 'macro avg': {'precision': 0.5954854579081804, 'recall': 0.5903551097319725, 'f1-score': 0.5926401070157986, 'support': 58820}, 'weighted avg': {'precision': 0.709187942683348, 'recall': 0.7116456987419245, 'f1-score': 0.7102683705562913, 'support': 58820}}
[[ 4638  3873   941]
 [ 3586 32932  3455]
 [ 1475  3631  4289]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8930481
{'0': {'precision': 0.4858030041814701, 'recall': 0.4773952600247108, 'f1-score': 0.4815624365626018, 'support': 106836}, '1': {'precision': 0.6449445948826809, 'recall': 0.7155099535033513, 'f1-score': 0.6783971984131338, 'support': 198724}, '2': {'precision': 0.516731749947454, 'recall': 0.4235250383077495, 'f1-score': 0.4655086502431635, 'support': 110291}, 'accuracy': 0.5768965326523202, 'macro avg': {'precision': 0.5491597830038683, 'recall': 0.5388100839452705, 'f1-score': 0.5418227617396331, 'support': 415851}, 'weighted avg': {'precision': 0.5700553343905679, 'recall': 0.5768965326523202, 'f1-score': 0.5713667247981188, 'support': 415851}}
[[ 51003  36838  18995]
 [ 31844 142189  24691]
 [ 22140  41440  46711]]
Evaluating performance on  train set...
451/451 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9302536
{'0': {'precision': 0.4634695389525275, 'recall': 0.5251008878127522, 'f1-score': 0.4923640436513342, 'support': 30975}, '1': {'precision': 0.6395355444850643, 'recall': 0.6373263364542434, 'f1-score': 0.6384290292997004, 'support': 52976}, '2': {'precision': 0.4994739324456699, 'recall': 0.43706149401568306, 'f1-score': 0.466188073549829, 'support': 31499}, 'accuracy': 0.5525768731052404, 'macro avg': {'precision': 0.5341596719610873, 'recall': 0.5331629060942262, 'f1-score': 0.5323270488336211, 'support': 115450}, 'weighted avg': {'precision': 0.5540834419385142, 'recall': 0.5525768731052404, 'f1-score': 0.5522464325424605, 'support': 115450}}
[[16265  8782  5928]
 [11345 33763  7868]
 [ 7484 10248 13767]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92467725
{'0': {'precision': 0.4775894836870447, 'recall': 0.5054051789156122, 'f1-score': 0.4911037824192826, 'support': 11933}, '1': {'precision': 0.6220971775634155, 'recall': 0.6732395727611039, 'f1-score': 0.6466587749228234, 'support': 20691}, '2': {'precision': 0.5156884093833515, 'recall': 0.4168333466677334, 'f1-score': 0.46102114857092297, 'support': 12499}, 'accuracy': 0.5578308179863928, 'macro avg': {'precision': 0.5384583568779373, 'recall': 0.5318260327814832, 'f1-score': 0.5329279019710097, 'support': 45123}, 'weighted avg': {'precision': 0.5544063435207022, 'recall': 0.5578308179863928, 'f1-score': 0.5541001591987547, 'support': 45123}}
[[ 6031  3843  2059]
 [ 3927 13930  2834]
 [ 2670  4619  5210]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.151117
{'0': {'precision': 0.3890153082333471, 'recall': 0.06669563135634549, 'f1-score': 0.11386876783457088, 'support': 112781}, '1': {'precision': 0.3565536205316224, 'recall': 0.015389788934385694, 'f1-score': 0.029506020669384656, 'support': 101106}, '2': {'precision': 0.3429503361411527, 'recall': 0.9312120638184656, 'f1-score': 0.5012853782459138, 'support': 110877}, 'accuracy': 0.34587577440849354, 'macro avg': {'precision': 0.3628397549687074, 'recall': 0.33776582803639893, 'f1-score': 0.21488672224995645, 'support': 324764}, 'weighted avg': {'precision': 0.363182342426063, 'recall': 0.34587577440849354, 'f1-score': 0.2198719319712829, 'support': 324764}}
[[  7522   1403 103856]
 [  5592   1556  93958]
 [  6222   1405 103250]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1553706
{'0': {'precision': 0.3952777777777778, 'recall': 0.06894880926423916, 'f1-score': 0.11741650679703777, 'support': 41277}, '1': {'precision': 0.43832335329341315, 'recall': 0.017851481526643093, 'f1-score': 0.03430579964850615, 'support': 41005}, '2': {'precision': 0.33915153616154614, 'recall': 0.9323374550306149, 'f1-score': 0.4973754114820982, 'support': 41973}, 'accuracy': 0.34373667055651685, 'macro avg': {'precision': 0.3909175557442457, 'recall': 0.3397125819404991, 'f1-score': 0.21636590597588068, 'support': 124255}, 'weighted avg': {'precision': 0.39052382087190307, 'recall': 0.34373667055651685, 'f1-score': 0.2183384862724754, 'support': 124255}}
[[ 2846   485 37946]
 [ 1967   732 38306]
 [ 2387   453 39133]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1436445
{'0': {'precision': 0.373015873015873, 'recall': 0.0540047313281514, 'f1-score': 0.09434964869811656, 'support': 14795}, '1': {'precision': 0.43992248062015504, 'recall': 0.015277964732803876, 'f1-score': 0.029530375959411995, 'support': 14858}, '2': {'precision': 0.34921375577434555, 'recall': 0.9433415264385202, 'f1-score': 0.5097311379386675, 'support': 15867}, 'accuracy': 0.35136203866432336, 'macro avg': {'precision': 0.3873840364701245, 'recall': 0.33754140749982514, 'f1-score': 0.2112037208653987, 'support': 45520}, 'weighted avg': {'precision': 0.3865578365816266, 'recall': 0.35136203866432336, 'f1-score': 0.21798263058362072, 'support': 45520}}
[[  799   134 13862]
 [  599   227 14032]
 [  744   155 14968]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
1733/1733 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0111604
{'0': {'precision': 0.4593554239065733, 'recall': 0.5615713018407629, 'f1-score': 0.5053464012747791, 'support': 144288}, '1': {'precision': 0.5355808813970621, 'recall': 0.40294196274296296, 'f1-score': 0.45988867059593974, 'support': 153367}, '2': {'precision': 0.4914256715788364, 'recall': 0.5112198934572904, 'f1-score': 0.5011273938216801, 'support': 145857}, 'accuracy': 0.49015810169736107, 'macro avg': {'precision': 0.4954539922941572, 'recall': 0.49191105268033875, 'f1-score': 0.488787488564133, 'support': 443512}, 'weighted avg': {'precision': 0.49626116682599164, 'recall': 0.49015810169736107, 'f1-score': 0.48823956414047787, 'support': 443512}}
[[81028 25262 37998]
 [52400 61798 39169]
 [42967 28325 74565]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.986701
{'0': {'precision': 0.48770414867655343, 'recall': 0.5176964699029721, 'f1-score': 0.5022529556100825, 'support': 65239}, '1': {'precision': 0.5439899413243923, 'recall': 0.5032881471600955, 'f1-score': 0.5228481196223133, 'support': 64474}, '2': {'precision': 0.5038362023839792, 'recall': 0.5100301282342432, 'f1-score': 0.5069142453014732, 'support': 66051}, 'accuracy': 0.5103645205451462, 'macro avg': {'precision': 0.511843430794975, 'recall': 0.5103382484324369, 'f1-score': 0.5106717735112897, 'support': 195764}, 'weighted avg': {'precision': 0.5116845969438852, 'recall': 0.5103645205451462, 'f1-score': 0.510608605524932, 'support': 195764}}
[[33774 13045 18420]
 [17270 32449 14755]
 [18207 14156 33688]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.988688
{'0': {'precision': 0.48472914659181365, 'recall': 0.5388412816691506, 'f1-score': 0.5103548664564082, 'support': 21472}, '1': {'precision': 0.5496740402295648, 'recall': 0.4687128806955861, 'f1-score': 0.5059752782479356, 'support': 21047}, '2': {'precision': 0.5080778971268884, 'recall': 0.5241677553042929, 'f1-score': 0.5159974279949446, 'support': 22199}, 'accuracy': 0.5110015760684817, 'macro avg': {'precision': 0.514160361316089, 'recall': 0.5105739725563432, 'f1-score': 0.5107758575664295, 'support': 64718}, 'weighted avg': {'precision': 0.5138588182368254, 'recall': 0.5110015760684817, 'f1-score': 0.510866038473007, 'support': 64718}}
[[11570  3692  6210]
 [ 6126  9865  5056]
 [ 6173  4390 11636]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
4693/4693 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53917396
{'0': {'precision': 0.4866093474128542, 'recall': 0.5258487090265798, 'f1-score': 0.5054686374607814, 'support': 136796}, '1': {'precision': 0.8832728574169777, 'recall': 0.8850837812613422, 'f1-score': 0.8841773920813043, 'support': 925744}, '2': {'precision': 0.5110520747993605, 'recall': 0.4633975708969218, 'f1-score': 0.4860595744680851, 'support': 138652}, 'accuracy': 0.795498138515741, 'macro avg': {'precision': 0.6269780932097307, 'recall': 0.6247766870616146, 'f1-score': 0.6252352013367236, 'support': 1201192}, 'weighted avg': {'precision': 0.7951344603363927, 'recall': 0.795498138515741, 'f1-score': 0.7950944857309646, 'support': 1201192}}
[[ 71934  50643  14219]
 [ 59130 819361  47253]
 [ 16763  57638  64251]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5786779
{'0': {'precision': 0.496956045294046, 'recall': 0.4965328467153285, 'f1-score': 0.4967443558692874, 'support': 49320}, '1': {'precision': 0.8564897463078767, 'recall': 0.8767988122801746, 'f1-score': 0.8665252979049709, 'support': 282895}, '2': {'precision': 0.5009261769223818, 'recall': 0.43536733812384654, 'f1-score': 0.4658515577403836, 'support': 50934}, 'accuracy': 0.7691681304140164, 'macro avg': {'precision': 0.6181239895081015, 'recall': 0.6028996657064499, 'f1-score': 0.6097070705048807, 'support': 383149}, 'weighted avg': {'precision': 0.7629426485023678, 'recall': 0.7691681304140164, 'f1-score': 0.7656624159902511, 'support': 383149}}
[[ 24489  19030   5801]
 [ 18561 248042  16292]
 [  6228  22531  22175]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5577518
{'0': {'precision': 0.5080886758538047, 'recall': 0.5065408279075324, 'f1-score': 0.5073135712362777, 'support': 16741}, '1': {'precision': 0.8675148304294296, 'recall': 0.8811497541519426, 'f1-score': 0.8742791342561042, 'support': 105553}, '2': {'precision': 0.5009729458288871, 'recall': 0.45504304692399794, 'f1-score': 0.4769046907678518, 'support': 17539}, 'accuracy': 0.7828552630637975, 'macro avg': {'precision': 0.6255254840373738, 'recall': 0.6142445429944909, 'f1-score': 0.6194991320867446, 'support': 139833}, 'weighted avg': {'precision': 0.7785091495975841, 'recall': 0.7828552630637975, 'f1-score': 0.7805035529923441, 'support': 139833}}
[[ 8480  6474  1787]
 [ 6382 93008  6163]
 [ 1828  7730  7981]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
6677/6677 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53115827
{'0': {'precision': 0.4522045346650081, 'recall': 0.4223921145987696, 'f1-score': 0.43679021589916384, 'support': 178152}, '1': {'precision': 0.878242746079513, 'recall': 0.9124327466427213, 'f1-score': 0.89501134547406, 'support': 1345286}, '2': {'precision': 0.5220801399246665, 'recall': 0.4079516594206018, 'f1-score': 0.4580132842398413, 'support': 185848}, 'accuracy': 0.8065063424143181, 'macro avg': {'precision': 0.6175091402230626, 'recall': 0.5809255068873642, 'f1-score': 0.5966049485376884, 'support': 1709286}, 'weighted avg': {'precision': 0.7951134935912912, 'recall': 0.8065063424143181, 'f1-score': 0.7997386840468418, 'support': 1709286}}
[[  75250   86101   16801]
 [  65200 1227483   52603]
 [  25957   84074   75817]]
Evaluating performance on  train set...
2262/2262 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7278679
{'0': {'precision': 0.47537949270394675, 'recall': 0.4671626277597059, 'f1-score': 0.4712352438645543, 'support': 103906}, '1': {'precision': 0.7838419044601371, 'recall': 0.8192006818416239, 'f1-score': 0.8011313337235398, 'support': 368414}, '2': {'precision': 0.5043625259024975, 'recall': 0.4341723545482711, 'f1-score': 0.46664278542706217, 'support': 106513}, 'accuracy': 0.6851561676683948, 'macro avg': {'precision': 0.5878613076888605, 'recall': 0.573511888049867, 'f1-score': 0.5796697876717188, 'support': 578833}, 'weighted avg': {'precision': 0.677042046117146, 'recall': 0.6851561676683948, 'f1-score': 0.6803615057116772, 'support': 578833}}
[[ 48541  39624  15741]
 [ 36905 301805  29704]
 [ 16664  43604  46245]]
Evaluating performance on  val set...
827/827 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69498855
{'0': {'precision': 0.45641723860068356, 'recall': 0.4817432618705458, 'f1-score': 0.46873840709984876, 'support': 34097}, '1': {'precision': 0.7985643089639524, 'recall': 0.8326268799639498, 'f1-score': 0.8152399467780743, 'support': 142024}, '2': {'precision': 0.5162768704761211, 'recall': 0.4004740005078577, 'f1-score': 0.45106139570357184, 'support': 35443}, 'accuracy': 0.7036783195628746, 'macro avg': {'precision': 0.5904194726802524, 'recall': 0.5716147141141178, 'f1-score': 0.5783465831938316, 'support': 211564}, 'weighted avg': {'precision': 0.6961305189973201, 'recall': 0.7036783195628746, 'f1-score': 0.6983852674179656, 'support': 211564}}
[[ 16426  14104   3567]
 [ 14039 118253   9732]
 [  5524  15725  14194]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
5633/5633 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6889861
{'0': {'precision': 0.4676712477004653, 'recall': 0.4501764299944011, 'f1-score': 0.4587571071260341, 'support': 230403}, '1': {'precision': 0.8017786974455771, 'recall': 0.8372350442914842, 'f1-score': 0.8191233620242653, 'support': 980211}, '2': {'precision': 0.4909411070170796, 'recall': 0.4172043940835568, 'f1-score': 0.4510792308843334, 'support': 231220}, 'accuracy': 0.7080253344004928, 'macro avg': {'precision': 0.5867970173877074, 'recall': 0.5682052894564807, 'f1-score': 0.5763199000115443, 'support': 1441834}, 'weighted avg': {'precision': 0.6985412745505003, 'recall': 0.7080253344004928, 'f1-score': 0.7025158813923117, 'support': 1441834}}
[[103722 102210  24471]
 [ 83989 820667  75555]
 [ 34073 100681  96466]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88650787
{'0': {'precision': 0.4435937584363695, 'recall': 0.479709924912125, 'f1-score': 0.46094547739539266, 'support': 85633}, '1': {'precision': 0.690797425084162, 'recall': 0.662943106186188, 'f1-score': 0.6765837029359913, 'support': 200883}, '2': {'precision': 0.456387604230339, 'recall': 0.46240315965365336, 'f1-score': 0.4593756892608802, 'support': 85579}, 'accuracy': 0.5746516346631908, 'macro avg': {'precision': 0.5302595959169568, 'recall': 0.5350187302506554, 'f1-score': 0.5323016231974215, 'support': 372095}, 'weighted avg': {'precision': 0.5799941365559642, 'recall': 0.5746516346631908, 'f1-score': 0.5770010888991985, 'support': 372095}}
[[ 41079  29466  15088]
 [ 35662 133174  32047]
 [ 15864  30143  39572]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84430295
{'0': {'precision': 0.44628149408868495, 'recall': 0.4733720180528691, 'f1-score': 0.4594277490105283, 'support': 31020}, '1': {'precision': 0.7103527102408965, 'recall': 0.7144535106024066, 'f1-score': 0.7123972090705208, 'support': 80029}, '2': {'precision': 0.4833028914084847, 'recall': 0.4471653593520821, 'f1-score': 0.46453237052617635, 'support': 31362}, 'accuracy': 0.6030784138865678, 'macro avg': {'precision': 0.5466456985793554, 'recall': 0.5449969626691192, 'f1-score': 0.5454524428690751, 'support': 142411}, 'weighted avg': {'precision': 0.6028313422056766, 'recall': 0.6030784138865678, 'f1-score': 0.6027101082321819, 'support': 142411}}
[[14684 11657  4679]
 [12538 57177 10314]
 [ 5681 11657 14024]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
11876/11876 - 178s - 178s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8890902
{'0': {'precision': 0.5164898310399393, 'recall': 0.45096014262065454, 'f1-score': 0.4815056782452336, 'support': 785300}, '1': {'precision': 0.6563969966363877, 'recall': 0.6966378591489849, 'f1-score': 0.6759190223864151, 'support': 1459457}, '2': {'precision': 0.4887991518985456, 'recall': 0.49504401547896537, 'f1-score': 0.49190176430979793, 'support': 795402}, 'accuracy': 0.5804337865223497, 'macro avg': {'precision': 0.5538953265249575, 'recall': 0.5475473390828682, 'f1-score': 0.5497754883138155, 'support': 3040159}, 'weighted avg': {'precision': 0.5764088256088, 'recall': 0.5804337865223497, 'f1-score': 0.5775555834140695, 'support': 3040159}}
[[ 354139  253258  177903]
 [ 208842 1016713  233902]
 [ 122684  278959  393759]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7777008
{'0': {'precision': 0.46844699590797645, 'recall': 0.44672825626486784, 'f1-score': 0.4573299138883677, 'support': 122748}, '1': {'precision': 0.7483185002883884, 'recall': 0.809346286810666, 'f1-score': 0.7776368889844069, 'support': 402363}, '2': {'precision': 0.4921501986836566, 'recall': 0.3849446648569639, 'f1-score': 0.4319956738243843, 'support': 124514}, 'accuracy': 0.6594835482008852, 'macro avg': {'precision': 0.5696385649600072, 'recall': 0.5470064026441659, 'f1-score': 0.555654158899053, 'support': 649625}, 'weighted avg': {'precision': 0.6463362684997436, 'recall': 0.6594835482008852, 'f1-score': 0.650864965423085, 'support': 649625}}
[[ 54835  52027  15886]
 [ 43138 325651  33574]
 [ 19084  57499  47931]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78939205
{'0': {'precision': 0.4529236354207183, 'recall': 0.45470401416150363, 'f1-score': 0.4538120786188441, 'support': 38414}, '1': {'precision': 0.7426568560684571, 'recall': 0.796151251835099, 'f1-score': 0.7684742270410215, 'support': 126015}, '2': {'precision': 0.47183879093198994, 'recall': 0.3602030613029767, 'f1-score': 0.4085317979586496, 'support': 39003}, 'accuracy': 0.648093711903732, 'macro avg': {'precision': 0.5558064274737218, 'recall': 0.5370194424331931, 'f1-score': 0.5436060345395051, 'support': 203432}, 'weighted avg': {'precision': 0.6360240306895596, 'recall': 0.648093711903732, 'f1-score': 0.640046711551869, 'support': 203432}}
[[ 17467  15840   5107]
 [ 15069 100327  10619]
 [  6029  18925  14049]]
testing model on single stock: results/universal/W0/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
19053/19053 - 267s - 267s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90949476
{'0': {'precision': 0.44082560973716484, 'recall': 0.48234495727337817, 'f1-score': 0.4606516227704979, 'support': 1177369}, '1': {'precision': 0.6550735566476544, 'recall': 0.6604062170081976, 'f1-score': 0.6577290781225812, 'support': 2541351}, '2': {'precision': 0.45481778743554996, 'recall': 0.40317122783458803, 'f1-score': 0.4274400779913656, 'support': 1158731}, 'accuracy': 0.5563129183665813, 'macro avg': {'precision': 0.5169056512734563, 'recall': 0.5153074673720546, 'f1-score': 0.5152735929614816, 'support': 4877451}, 'weighted avg': {'precision': 0.5557816398819161, 'recall': 0.5563129183665813, 'f1-score': 0.555446986525665, 'support': 4877451}}
[[ 567898  422761  186710]
 [ 489752 1678324  373275]
 [ 230610  460954  467167]]
Evaluating performance on  train set...
4812/4812 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0205542
{'0': {'precision': 0.45889739224910997, 'recall': 0.5441508023730672, 'f1-score': 0.4979010690375063, 'support': 406731}, '1': {'precision': 0.49422741920749474, 'recall': 0.38568018623722633, 'f1-score': 0.4332584964694122, 'support': 406793}, '2': {'precision': 0.482495846118956, 'recall': 0.4983912760790163, 'f1-score': 0.4903147671287641, 'support': 418344}, 'accuracy': 0.4762799260959778, 'macro avg': {'precision': 0.4785402191918536, 'recall': 0.47607408822977, 'f1-score': 0.4738247775452275, 'support': 1231868}, 'weighted avg': {'precision': 0.47857829900389953, 'recall': 0.4762799260959778, 'f1-score': 0.4739781893877357, 'support': 1231868}}
[[221323  74511 110897]
 [137171 156892 112730]
 [123799  86046 208499]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199497
{'0': {'precision': 0.45695453549333287, 'recall': 0.5508731760848654, 'f1-score': 0.49953775511771115, 'support': 147622}, '1': {'precision': 0.4996820875403749, 'recall': 0.38302974376303767, 'f1-score': 0.4336479815184044, 'support': 153881}, '2': {'precision': 0.4766487820787476, 'recall': 0.4942967040254659, 'f1-score': 0.4853123585848556, 'support': 150790}, 'accuracy': 0.4749067529234368, 'macro avg': {'precision': 0.4777618017041518, 'recall': 0.47606654129112297, 'f1-score': 0.4728326984069904, 'support': 452293}, 'weighted avg': {'precision': 0.4780573468991374, 'recall': 0.4749067529234368, 'f1-score': 0.4723778570108993, 'support': 452293}}
[[81321 27543 38758]
 [51860 58941 43080]
 [44782 31473 74535]]
training model: results/universal/W0/deepVOL_L3/h20
Epoch 1/50
8838/8838 - 502s - loss: 2.9942 - accuracy20: 0.4775 - val_loss: 2.9821 - val_accuracy20: 0.4880 - 502s/epoch - 57ms/step
Epoch 2/50
8838/8838 - 512s - loss: 2.9010 - accuracy20: 0.5069 - val_loss: 2.9478 - val_accuracy20: 0.5019 - 512s/epoch - 58ms/step
Epoch 3/50
8838/8838 - 515s - loss: 2.8776 - accuracy20: 0.5134 - val_loss: 2.9452 - val_accuracy20: 0.5007 - 515s/epoch - 58ms/step
Epoch 4/50
8838/8838 - 509s - loss: 2.8620 - accuracy20: 0.5161 - val_loss: 2.9337 - val_accuracy20: 0.5041 - 509s/epoch - 58ms/step
Epoch 5/50
8838/8838 - 513s - loss: 2.8493 - accuracy20: 0.5187 - val_loss: 2.9612 - val_accuracy20: 0.4980 - 513s/epoch - 58ms/step
Epoch 6/50
8838/8838 - 515s - loss: 2.8389 - accuracy20: 0.5204 - val_loss: 2.9819 - val_accuracy20: 0.5025 - 515s/epoch - 58ms/step
Epoch 7/50
8838/8838 - 507s - loss: 2.8304 - accuracy20: 0.5219 - val_loss: 2.9287 - val_accuracy20: 0.5029 - 507s/epoch - 57ms/step
Epoch 8/50
8838/8838 - 505s - loss: 2.8233 - accuracy20: 0.5236 - val_loss: 2.9247 - val_accuracy20: 0.5062 - 505s/epoch - 57ms/step
Epoch 9/50
8838/8838 - 497s - loss: 2.8175 - accuracy20: 0.5250 - val_loss: 2.9306 - val_accuracy20: 0.5072 - 497s/epoch - 56ms/step
Epoch 10/50
8838/8838 - 495s - loss: 2.8121 - accuracy20: 0.5265 - val_loss: 2.9239 - val_accuracy20: 0.5067 - 495s/epoch - 56ms/step
Epoch 11/50
8838/8838 - 508s - loss: 2.8081 - accuracy20: 0.5276 - val_loss: 2.9032 - val_accuracy20: 0.5101 - 508s/epoch - 57ms/step
Epoch 12/50
8838/8838 - 510s - loss: 2.8039 - accuracy20: 0.5286 - val_loss: 2.8919 - val_accuracy20: 0.5122 - 510s/epoch - 58ms/step
Epoch 13/50
8838/8838 - 506s - loss: 2.7999 - accuracy20: 0.5295 - val_loss: 2.9236 - val_accuracy20: 0.5116 - 506s/epoch - 57ms/step
Epoch 14/50
8838/8838 - 484s - loss: 2.7970 - accuracy20: 0.5303 - val_loss: 2.9204 - val_accuracy20: 0.5116 - 484s/epoch - 55ms/step
Epoch 15/50
8838/8838 - 503s - loss: 2.7934 - accuracy20: 0.5311 - val_loss: 2.9143 - val_accuracy20: 0.5122 - 503s/epoch - 57ms/step
Epoch 16/50
8838/8838 - 507s - loss: 2.7910 - accuracy20: 0.5316 - val_loss: 2.9346 - val_accuracy20: 0.5101 - 507s/epoch - 57ms/step
Epoch 17/50
8838/8838 - 507s - loss: 2.7880 - accuracy20: 0.5325 - val_loss: 2.9352 - val_accuracy20: 0.5102 - 507s/epoch - 57ms/step
Epoch 18/50
8838/8838 - 510s - loss: 2.7858 - accuracy20: 0.5329 - val_loss: 2.9234 - val_accuracy20: 0.5121 - 510s/epoch - 58ms/step
Epoch 19/50
8838/8838 - 509s - loss: 2.7831 - accuracy20: 0.5336 - val_loss: 2.9189 - val_accuracy20: 0.5113 - 509s/epoch - 58ms/step
Epoch 20/50
8838/8838 - 504s - loss: 2.7813 - accuracy20: 0.5341 - val_loss: 2.9125 - val_accuracy20: 0.5121 - 504s/epoch - 57ms/step
Epoch 21/50
8838/8838 - 507s - loss: 2.7792 - accuracy20: 0.5346 - val_loss: 2.9124 - val_accuracy20: 0.5138 - 507s/epoch - 57ms/step
Epoch 22/50
8838/8838 - 494s - loss: 2.7769 - accuracy20: 0.5352 - val_loss: 2.9116 - val_accuracy20: 0.5114 - 494s/epoch - 56ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 973s - 973s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89033914
{'0': {'precision': 0.41811519300848404, 'recall': 0.5277852112730107, 'f1-score': 0.46659249637611266, 'support': 1954367}, '1': {'precision': 0.7152059572752429, 'recall': 0.6690627906092456, 'f1-score': 0.6913653065797035, 'support': 4549709}, '2': {'precision': 0.4490635130789488, 'recall': 0.3984790377968002, 'f1-score': 0.42226174111601283, 'support': 1944953}, 'accuracy': 0.5740955558325105, 'macro avg': {'precision': 0.5274615544542253, 'recall': 0.5317756798930188, 'f1-score': 0.526739848023943, 'support': 8449029}, 'weighted avg': {'precision': 0.5852195492566827, 'recall': 0.5740955558325105, 'f1-score': 0.5774253083007932, 'support': 8449029}}
[[1031486  585787  337094]
 [ 891920 3044041  613748]
 [ 543584  626346  775023]]
Evaluating performance on  train set...
8838/8838 - 286s - 286s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98176503
{'0': {'precision': 0.4172063075529449, 'recall': 0.5881584629000696, 'f1-score': 0.48814803894905673, 'support': 653074}, '1': {'precision': 0.6651401669163278, 'recall': 0.4945834818473446, 'f1-score': 0.567320223263013, 'support': 942672}, '2': {'precision': 0.4572190091935645, 'recall': 0.4394620651152739, 'f1-score': 0.44816471708191313, 'support': 666326}, 'accuracy': 0.5053623403675922, 'macro avg': {'precision': 0.5131884945542792, 'recall': 0.5074013366208959, 'f1-score': 0.5012109930979943, 'support': 2262072}, 'weighted avg': {'precision': 0.5323139657120072, 'recall': 0.5053623403675922, 'f1-score': 0.5093637537473299, 'support': 2262072}}
[[384111 114599 154364]
 [283183 466230 193259]
 [253380 120121 292825]]
Evaluating performance on  val set...
3279/3279 - 98s - 98s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97170925
{'0': {'precision': 0.4176043738477327, 'recall': 0.582586514177598, 'f1-score': 0.4864884881036979, 'support': 236782}, '1': {'precision': 0.6719718937396373, 'recall': 0.5113470249840202, 'f1-score': 0.5807577708759437, 'support': 359830}, '2': {'precision': 0.45949849189714226, 'recall': 0.44521082285926566, 'f1-score': 0.4522418379989811, 'support': 242265}, 'accuracy': 0.5123552082128846, 'macro avg': {'precision': 0.5163582531615041, 'recall': 0.513048120673628, 'f1-score': 0.5064960323262077, 'support': 838877}, 'weighted avg': {'precision': 0.53881230205645, 'recall': 0.5123552082128846, 'f1-score': 0.5170342669631945, 'support': 838877}}
[[137946  44328  54508]
 [103467 183998  72365]
 [ 88914  45492 107859]]
testing model out of sample: results/universal/W0/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 711s - 711s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8758264
{'0': {'precision': 0.49928018844080346, 'recall': 0.4921214417109965, 'f1-score': 0.4956749690145345, 'support': 1557455}, '1': {'precision': 0.6525958486068234, 'recall': 0.7546990216798536, 'f1-score': 0.6999434999653976, 'support': 2693699}, '2': {'precision': 0.5268751289431229, 'recall': 0.3939356774427254, 'f1-score': 0.4508090248475222, 'support': 1581809}, 'accuracy': 0.5867549648437681, 'macro avg': {'precision': 0.5595837219969165, 'recall': 0.5469187136111918, 'f1-score': 0.5488091646091514, 'support': 5832963}, 'weighted avg': {'precision': 0.5775656439999389, 'recall': 0.5867549648437681, 'f1-score': 0.5778405139146018, 'support': 5832963}}
[[ 766457  518192  272806]
 [ 374012 2032932  286755]
 [ 394655  564023  623131]]
Evaluating performance on  train set...
6334/6334 - 201s - 201s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8969673
{'0': {'precision': 0.4764526485467933, 'recall': 0.5010918517335787, 'f1-score': 0.4884617321363992, 'support': 425882}, '1': {'precision': 0.6623021247240951, 'recall': 0.7180977106876059, 'f1-score': 0.689072292458024, 'support': 763417}, '2': {'precision': 0.5051801090762694, 'recall': 0.40412325272647653, 'f1-score': 0.44903612472710797, 'support': 431601}, 'accuracy': 0.5774779443519032, 'macro avg': {'precision': 0.5479782941157193, 'recall': 0.541104271715887, 'f1-score': 0.5421900497738438, 'support': 1620900}, 'weighted avg': {'precision': 0.5716339985664304, 'recall': 0.5774779443519032, 'f1-score': 0.5724480240394137, 'support': 1620900}}
[[213406 133633  78843]
 [123209 548208  92000]
 [111291 145890 174420]]
Evaluating performance on  val set...
2156/2156 - 68s - 68s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8901741
{'0': {'precision': 0.4710150813635502, 'recall': 0.49728431764907666, 'f1-score': 0.4837933671695752, 'support': 139928}, '1': {'precision': 0.6657295531829128, 'recall': 0.7207062720057289, 'f1-score': 0.6921279091633609, 'support': 268112}, '2': {'precision': 0.5010366579910892, 'recall': 0.3963291227580431, 'f1-score': 0.4425740838155357, 'support': 143290}, 'accuracy': 0.5796963705947437, 'macro avg': {'precision': 0.5459270975125174, 'recall': 0.5381065708042829, 'f1-score': 0.5394984533828239, 'support': 551330}, 'weighted avg': {'precision': 0.573507378505721, 'recall': 0.5796963705947437, 'f1-score': 0.5743936965752624, 'support': 551330}}
[[ 69584  45624  24720]
 [ 43047 193230  31835]
 [ 35101  51399  56790]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.176519
{'0': {'precision': 0.33410586817465465, 'recall': 0.5845693585884982, 'f1-score': 0.4251949924624762, 'support': 55487}, '1': {'precision': 0.7256283015847607, 'recall': 0.20290231325646352, 'f1-score': 0.31712828549241284, 'support': 111704}, '2': {'precision': 0.33632104510783933, 'recall': 0.5658310511902254, 'f1-score': 0.4218820557457084, 'support': 56964}, 'accuracy': 0.3896098681715777, 'macro avg': {'precision': 0.4653517382890849, 'recall': 0.45110090767839567, 'f1-score': 0.38806844456686584, 'support': 224155}, 'weighted avg': {'precision': 0.5297776454736862, 'recall': 0.3896098681715777, 'f1-score': 0.3704997968945972, 'support': 224155}}
[[32436  4618 18433]
 [43867 22665 45172]
 [20780  3952 32232]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1759003
{'0': {'precision': 0.38277456107583113, 'recall': 0.6332560834298957, 'f1-score': 0.47713978056517564, 'support': 25890}, '1': {'precision': 0.5931261056355825, 'recall': 0.07822811812545831, 'f1-score': 0.13822550722930596, 'support': 30002}, '2': {'precision': 0.385696448793519, 'recall': 0.524273760656773, 'f1-score': 0.4444332915098286, 'support': 25336}, 'accuracy': 0.3942605997931748, 'macro avg': {'precision': 0.4538657051683109, 'recall': 0.41191932073737564, 'f1-score': 0.3532661931014367, 'support': 81228}, 'weighted avg': {'precision': 0.4613804111164206, 'recall': 0.3942605997931748, 'f1-score': 0.34175841409882124, 'support': 81228}}
[[16395   893  8602]
 [15101  2347 12554]
 [11336   717 13283]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1665249
{'0': {'precision': 0.3621002763521516, 'recall': 0.6041364774074562, 'f1-score': 0.4528041074249605, 'support': 7591}, '1': {'precision': 0.6473175021987687, 'recall': 0.13539367181751288, 'f1-score': 0.22394644758862015, 'support': 10872}, '2': {'precision': 0.36723212740176564, 'recall': 0.5283935242839353, 'f1-score': 0.43331290849673204, 'support': 8030}, 'accuracy': 0.38881968821952967, 'macro avg': {'precision': 0.4588833019842286, 'recall': 0.4226412245029681, 'f1-score': 0.37002115450343753, 'support': 26493}, 'weighted avg': {'precision': 0.4807010555516693, 'recall': 0.38881968821952967, 'f1-score': 0.3529794441126, 'support': 26493}}
[[4586  370 2635]
 [4724 1472 4676]
 [3355  432 4243]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68453264
{'0': {'precision': 0.5302887754989097, 'recall': 0.4513211812915077, 'f1-score': 0.48762862464504175, 'support': 106155}, '1': {'precision': 0.8005377292173456, 'recall': 0.8517742673404239, 'f1-score': 0.825361601444538, 'support': 389062}, '2': {'precision': 0.5289109149761756, 'recall': 0.48461375505429627, 'f1-score': 0.5057943080716563, 'support': 108571}, 'accuracy': 0.7153471085877825, 'macro avg': {'precision': 0.6199124732308103, 'recall': 0.5959030678954093, 'f1-score': 0.6062615113870786, 'support': 603788}, 'weighted avg': {'precision': 0.7041809408562674, 'recall': 0.7153471085877825, 'f1-score': 0.7085196225364815, 'support': 603788}}
[[ 47910  43705  14540]
 [ 25346 331393  32323]
 [ 17091  38865  52615]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75125295
{'0': {'precision': 0.49535767388072033, 'recall': 0.49207339088193786, 'f1-score': 0.493710070473556, 'support': 30467}, '1': {'precision': 0.760621921182266, 'recall': 0.8209277596863163, 'f1-score': 0.7896250839006617, 'support': 90282}, '2': {'precision': 0.5403043478260869, 'recall': 0.4148417679262919, 'f1-score': 0.4693330311957096, 'support': 29956}, 'accuracy': 0.6737268172920606, 'macro avg': {'precision': 0.5987613142963578, 'recall': 0.5759476394981821, 'f1-score': 0.584222728523309, 'support': 150705}, 'weighted avg': {'precision': 0.6632022002042368, 'recall': 0.6737268172920606, 'f1-score': 0.6661367361689131, 'support': 150705}}
[[14992 11617  3858]
 [ 9452 74115  6715]
 [ 5821 11708 12427]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7508045
{'0': {'precision': 0.5220630372492837, 'recall': 0.446824164146162, 'f1-score': 0.4815222657798529, 'support': 12233}, '1': {'precision': 0.7435472848656889, 'recall': 0.824247545234696, 'f1-score': 0.7818204430196084, 'support': 34321}, '2': {'precision': 0.548233695652174, 'recall': 0.46054133376813955, 'f1-score': 0.5005759858218874, 'support': 12266}, 'accuracy': 0.6699081944916695, 'macro avg': {'precision': 0.6046146725890488, 'recall': 0.5772043477163326, 'f1-score': 0.5879728982071163, 'support': 58820}, 'weighted avg': {'precision': 0.6567548114487481, 'recall': 0.6699081944916695, 'f1-score': 0.6607172108849403, 'support': 58820}}
[[ 5466  5191  1576]
 [ 2953 28289  3079]
 [ 2051  4566  5649]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9724207
{'0': {'precision': 0.5138005822056192, 'recall': 0.46732021241486904, 'f1-score': 0.48945939894810025, 'support': 133324}, '1': {'precision': 0.5175210262685762, 'recall': 0.6867306567585234, 'f1-score': 0.5902380030101512, 'support': 145335}, '2': {'precision': 0.5492755617590973, 'recall': 0.40731237973059653, 'f1-score': 0.4677598921841909, 'support': 137192}, 'accuracy': 0.5242045828914683, 'macro avg': {'precision': 0.5268657234110976, 'recall': 0.5204544163013297, 'f1-score': 0.5158190980474808, 'support': 415851}, 'weighted avg': {'precision': 0.5268042641320559, 'recall': 0.5242045828914683, 'f1-score': 0.5175215166041932, 'support': 415851}}
[[62305 45724 25295]
 [24970 99806 20559]
 [33988 47324 55880]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99819416
{'0': {'precision': 0.48440229598203144, 'recall': 0.5111795844196887, 'f1-score': 0.49743083763662693, 'support': 37971}, '1': {'precision': 0.504047011863843, 'recall': 0.5862175684737195, 'f1-score': 0.5420357939167034, 'support': 38774}, '2': {'precision': 0.524219910846954, 'recall': 0.4101795633639065, 'f1-score': 0.46024061458182347, 'support': 38705}, 'accuracy': 0.5025205716760502, 'macro avg': {'precision': 0.5042230728976095, 'recall': 0.5025255720857715, 'f1-score': 0.4999024153783846, 'support': 115450}, 'weighted avg': {'precision': 0.5043489828330335, 'recall': 0.5025205716760502, 'f1-score': 0.4999433104947258, 'support': 115450}}
[[19410 10744  7817]
 [ 9452 22730  6592]
 [11208 11621 15876]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99846095
{'0': {'precision': 0.5101214574898786, 'recall': 0.4833109017496635, 'f1-score': 0.4963544006358202, 'support': 14860}, '1': {'precision': 0.48117415205891506, 'recall': 0.6215582501507335, 'f1-score': 0.5424303545850507, 'support': 14927}, '2': {'precision': 0.5286515898656691, 'recall': 0.4054512258737611, 'f1-score': 0.45892685807070627, 'support': 15336}, 'accuracy': 0.5025818318817454, 'macro avg': {'precision': 0.5066490664714877, 'recall': 0.5034401259247193, 'f1-score': 0.4992372044305257, 'support': 45123}, 'weighted avg': {'precision': 0.5068433439324275, 'recall': 0.5025818318817454, 'f1-score': 0.498876107344629, 'support': 45123}}
[[7182 4740 2938]
 [3043 9278 2606]
 [3854 5264 6218]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1410723
{'0': {'precision': 0.3465242816288825, 'recall': 0.6942299518277132, 'f1-score': 0.46229460829262115, 'support': 112928}, '1': {'precision': 0.31993031686990914, 'recall': 0.06779339725234708, 'f1-score': 0.11187947641392937, 'support': 100231}, '2': {'precision': 0.35286734641064127, 'recall': 0.24435285157475023, 'f1-score': 0.288751594852003, 'support': 111605}, 'accuracy': 0.3462945400352256, 'macro avg': {'precision': 0.3397739816364776, 'recall': 0.3354587335516035, 'f1-score': 0.28764189318618455, 'support': 324764}, 'weighted avg': {'precision': 0.34049645238429727, 'recall': 0.3462945400352256, 'f1-score': 0.29450899443648765, 'support': 324764}}
[[78398  7386 27144]
 [70567  6795 22869]
 [77276  7058 27271]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1567357
{'0': {'precision': 0.33401022337371333, 'recall': 0.6938518231186966, 'f1-score': 0.45094300975310003, 'support': 41248}, '1': {'precision': 0.3370229007633588, 'recall': 0.0643367173458979, 'f1-score': 0.10804747726067626, 'support': 41174}, '2': {'precision': 0.3373603829496239, 'recall': 0.24765137570817297, 'f1-score': 0.28562763640373856, 'support': 41833}, 'accuracy': 0.3350287714780089, 'macro avg': {'precision': 0.33613116902889867, 'recall': 0.33527997205758914, 'f1-score': 0.28153937447250493, 'support': 124255}, 'weighted avg': {'precision': 0.3361364251714706, 'recall': 0.3350287714780089, 'f1-score': 0.28166194526340627, 'support': 124255}}
[[28620  2568 10060]
 [28236  2649 10289]
 [28830  2643 10360]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.143417
{'0': {'precision': 0.3321753246753247, 'recall': 0.6853104695558979, 'f1-score': 0.44746222309694067, 'support': 14929}, '1': {'precision': 0.35581245985870263, 'recall': 0.07369961420779567, 'f1-score': 0.12210711924178974, 'support': 15034}, '2': {'precision': 0.34464931931759435, 'recall': 0.257118981808832, 'f1-score': 0.294518278540662, 'support': 15557}, 'accuracy': 0.33697275922671355, 'macro avg': {'precision': 0.3442123679505406, 'recall': 0.3387096885241752, 'f1-score': 0.28802920695979745, 'support': 45520}, 'weighted avg': {'precision': 0.34424515387120985, 'recall': 0.33697275922671355, 'f1-score': 0.28773600216503453, 'support': 45520}}
[[10231   967  3731]
 [10051  1108  3875]
 [10518  1039  4000]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
1733/1733 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0939637
{'0': {'precision': 0.41502976266379665, 'recall': 0.5730514335617548, 'f1-score': 0.48140456750680394, 'support': 141989}, '1': {'precision': 0.5089969074996119, 'recall': 0.2710440814613707, 'f1-score': 0.35372653799558557, 'support': 157277}, '2': {'precision': 0.443161688351353, 'recall': 0.5029602207340238, 'f1-score': 0.4711712062762213, 'support': 144246}, 'accuracy': 0.4431582460001082, 'macro avg': {'precision': 0.45572945283825383, 'recall': 0.4490185785857164, 'f1-score': 0.4354341039262036, 'support': 443512}, 'weighted avg': {'precision': 0.4575016425477001, 'recall': 0.4431582460001082, 'f1-score': 0.4327994815756397, 'support': 443512}}
[[81367 21178 39444]
 [62932 42629 51716]
 [51752 19944 72550]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502418
{'0': {'precision': 0.4407211778913598, 'recall': 0.5544148789245926, 'f1-score': 0.4910733096375635, 'support': 65166}, '1': {'precision': 0.528390522875817, 'recall': 0.36258448313451896, 'f1-score': 0.43005966124235767, 'support': 64214}, '2': {'precision': 0.4622864764855213, 'recall': 0.48553868402024586, 'f1-score': 0.4736273667041372, 'support': 66384}, 'accuracy': 0.4681351014486831, 'macro avg': {'precision': 0.4771327257508993, 'recall': 0.4675126820264525, 'f1-score': 0.4649201125280194, 'support': 195764}, 'weighted avg': {'precision': 0.47679108911460183, 'recall': 0.4681351014486831, 'f1-score': 0.4651438134393742, 'support': 195764}}
[[36129 10597 18440]
 [21880 23283 19051]
 [23968 10184 32232]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0562563
{'0': {'precision': 0.4438225154761464, 'recall': 0.5583379966424175, 'f1-score': 0.49453749406249353, 'support': 21444}, '1': {'precision': 0.5315713306420901, 'recall': 0.3264418354459984, 'f1-score': 0.4044859163092616, 'support': 21379}, '2': {'precision': 0.4575816674792784, 'recall': 0.5143640100479562, 'f1-score': 0.4843141892618316, 'support': 21895}, 'accuracy': 0.46685620692852065, 'macro avg': {'precision': 0.47765850453250497, 'recall': 0.4663812807121241, 'f1-score': 0.4611125332111956, 'support': 64718}, 'weighted avg': {'precision': 0.47746444743543576, 'recall': 0.46685620692852065, 'f1-score': 0.46133109183441423, 'support': 64718}}
[[11973  3048  6423]
 [ 7473  6979  6927]
 [ 7531  3102 11262]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
4693/4693 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60672146
{'0': {'precision': 0.5777928663620404, 'recall': 0.4961628365068943, 'f1-score': 0.5338755531942553, 'support': 190375}, '1': {'precision': 0.8171917746609889, 'recall': 0.9097881268478908, 'f1-score': 0.8610075581015695, 'support': 818839}, '2': {'precision': 0.6348986049757714, 'recall': 0.41700090635385306, 'f1-score': 0.5033813417843298, 'support': 191978}, 'accuracy': 0.7654746285356546, 'macro avg': {'precision': 0.676627748666267, 'recall': 0.6076506232362128, 'f1-score': 0.6327548176933848, 'support': 1201192}, 'weighted avg': {'precision': 0.7501151996444712, 'recall': 0.7654746285356546, 'f1-score': 0.7520040672438374, 'support': 1201192}}
[[ 94457  77870  18048]
 [ 45881 744970  27988]
 [ 23141  88782  80055]]
Evaluating performance on  train set...
1497/1497 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65303826
{'0': {'precision': 0.5893924210370041, 'recall': 0.4713285052831533, 'f1-score': 0.5237898903273687, 'support': 67384}, '1': {'precision': 0.781651505287421, 'recall': 0.89974399274106, 'f1-score': 0.8365506475115483, 'support': 246868}, '2': {'precision': 0.5912679054503526, 'recall': 0.38702701133576206, 'f1-score': 0.46782753629545154, 'support': 68897}, 'accuracy': 0.7322033986777989, 'macro avg': {'precision': 0.6541039439249259, 'recall': 0.5860331697866584, 'f1-score': 0.6093893580447894, 'support': 383149}, 'weighted avg': {'precision': 0.7136047532115847, 'recall': 0.7322033986777989, 'f1-score': 0.7152427828021162, 'support': 383149}}
[[ 31760  28276   7348]
 [ 13665 222118  11085]
 [  8461  33771  26665]]
Evaluating performance on  val set...
547/547 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62598515
{'0': {'precision': 0.6051055253876728, 'recall': 0.46832755632582324, 'f1-score': 0.5280023447231518, 'support': 23080}, '1': {'precision': 0.7949248653246385, 'recall': 0.9069451483162787, 'f1-score': 0.8472483140351849, 'support': 92741}, '2': {'precision': 0.6118811881188119, 'recall': 0.41179410294852575, 'f1-score': 0.49228318231604096, 'support': 24012}, 'accuracy': 0.7495226448692369, 'macro avg': {'precision': 0.6706371929437077, 'recall': 0.5956889358635425, 'f1-score': 0.6225112803581259, 'support': 139833}, 'weighted avg': {'precision': 0.7321623189814186, 'recall': 0.7495226448692369, 'f1-score': 0.7336011798496792, 'support': 139833}}
[[10809  9954  2317]
 [ 4675 84111  3955]
 [ 2379 11745  9888]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
6677/6677 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62145793
{'0': {'precision': 0.5031335664996691, 'recall': 0.4333964376590331, 'f1-score': 0.4656685731783336, 'support': 245625}, '1': {'precision': 0.8139768889537962, 'recall': 0.9187445242720527, 'f1-score': 0.8631933603429477, 'support': 1213309}, '2': {'precision': 0.619904703230888, 'recall': 0.3175169361538953, 'f1-score': 0.4199396169400105, 'support': 250352}, 'accuracy': 0.7609405330646831, 'macro avg': {'precision': 0.6456717195614511, 'recall': 0.5565526326949937, 'f1-score': 0.5829338501537639, 'support': 1709286}, 'weighted avg': {'precision': 0.740883649485447, 'recall': 0.7609405330646831, 'f1-score': 0.741147379146284, 'support': 1709286}}
[[ 106453  121483   17689]
 [  67537 1114721   31051]
 [  37590  133271   79491]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81480646
{'0': {'precision': 0.5062842460452589, 'recall': 0.4822558053814965, 'f1-score': 0.49397799608852905, 'support': 135650}, '1': {'precision': 0.7000240320049761, 'recall': 0.810683823649788, 'f1-score': 0.7513009967987134, 'support': 305415}, '2': {'precision': 0.55030961366053, 'recall': 0.38317316067591894, 'f1-score': 0.4517788218781826, 'support': 137768}, 'accuracy': 0.6319646599278202, 'macro avg': {'precision': 0.5855392972369217, 'recall': 0.5587042632357345, 'f1-score': 0.5656859382551417, 'support': 578833}, 'weighted avg': {'precision': 0.6189874325852587, 'recall': 0.6319646599278202, 'f1-score': 0.6197078843797805, 'support': 578833}}
[[ 65418  50450  19782]
 [ 34465 247595  23355]
 [ 29329  55650  52789]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7873652
{'0': {'precision': 0.49768270944741533, 'recall': 0.4884855112083106, 'f1-score': 0.493041222890569, 'support': 45725}, '1': {'precision': 0.7178691890306497, 'recall': 0.8212994421374943, 'f1-score': 0.7661091222098323, 'support': 119205}, '2': {'precision': 0.566756863780359, 'recall': 0.36829351974953894, 'f1-score': 0.446463386103096, 'support': 46634}, 'accuracy': 0.6495150403660358, 'macro avg': {'precision': 0.594102920752808, 'recall': 0.5593594910317813, 'f1-score': 0.5685379104011657, 'support': 211564}, 'weighted avg': {'precision': 0.636971687779655, 'recall': 0.6495150403660358, 'f1-score': 0.6366334602164172, 'support': 211564}}
[[22336 18126  5263]
 [13436 97903  7866]
 [ 9108 20351 17175]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
5633/5633 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7862641
{'0': {'precision': 0.4951229903356728, 'recall': 0.4453340862795716, 'f1-score': 0.46891059672966656, 'support': 297498}, '1': {'precision': 0.7397728536357959, 'recall': 0.8181890210732954, 'f1-score': 0.7770074951877616, 'support': 845620}, '2': {'precision': 0.5194312875529298, 'recall': 0.4155853720590795, 'f1-score': 0.46174160145207843, 'support': 298716}, 'accuracy': 0.6578461875638943, 'macro avg': {'precision': 0.5847757105081328, 'recall': 0.5597028264706488, 'f1-score': 0.5692198977898356, 'support': 1441834}, 'weighted avg': {'precision': 0.6436436208072807, 'recall': 0.6578461875638943, 'f1-score': 0.6481208287541537, 'support': 1441834}}
[[132486 124420  40592]
 [ 79481 691877  74262]
 [ 55615 118959 124142]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9647339
{'0': {'precision': 0.4703618236410453, 'recall': 0.49240297352000223, 'f1-score': 0.4811300979722032, 'support': 107213}, '1': {'precision': 0.6039031132758507, 'recall': 0.5826644143572027, 'f1-score': 0.5930936851563358, 'support': 157468}, '2': {'precision': 0.47432547624342153, 'recall': 0.47659522967210977, 'f1-score': 0.47545764411958646, 'support': 107414}, 'accuracy': 0.52603770542469, 'macro avg': {'precision': 0.5161968043867725, 'recall': 0.5172208725164382, 'f1-score': 0.5165604757493751, 'support': 372095}, 'weighted avg': {'precision': 0.5280197646960049, 'recall': 0.52603770542469, 'f1-score': 0.5268748168977089, 'support': 372095}}
[[52792 30588 23833]
 [32815 91751 32902]
 [26630 29591 51193]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93043274
{'0': {'precision': 0.4738548420832462, 'recall': 0.4655894366378092, 'f1-score': 0.46968577907353415, 'support': 38927}, '1': {'precision': 0.6189138853578502, 'recall': 0.659723644613906, 'f1-score': 0.6386675106579319, 'support': 63469}, '2': {'precision': 0.5049987674272097, 'recall': 0.46075221791828064, 'f1-score': 0.4818618995347864, 'support': 40015}, 'accuracy': 0.5507509953585046, 'macro avg': {'precision': 0.532589164956102, 'recall': 0.5286884330566652, 'f1-score': 0.5300717297554175, 'support': 142411}, 'weighted avg': {'precision': 0.5472549066164251, 'recall': 0.5507509953585046, 'f1-score': 0.5484179625578658, 'support': 142411}}
[[18124 13308  7495]
 [11020 41872 10577]
 [ 9104 12474 18437]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
11876/11876 - 173s - 173s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95171034
{'0': {'precision': 0.5327094468265031, 'recall': 0.4931500565731935, 'f1-score': 0.512167003315675, 'support': 981030}, '1': {'precision': 0.5235413207603556, 'recall': 0.7066104229162329, 'f1-score': 0.6014538547430723, 'support': 1066074}, '2': {'precision': 0.5525429646472224, 'recall': 0.38566141855184255, 'f1-score': 0.45426030270735734, 'support': 993055}, 'accuracy': 0.532892194125373, 'macro avg': {'precision': 0.5362645774113605, 'recall': 0.5284739660137563, 'f1-score': 0.5226270535887015, 'support': 3040159}, 'weighted avg': {'precision': 0.5359730502142247, 'recall': 0.532892194125373, 'f1-score': 0.5245617011837859, 'support': 3040159}}
[[483795 325425 171810]
 [174440 753299 138335]
 [249943 360129 382983]]
Evaluating performance on  train set...
2538/2538 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8710965
{'0': {'precision': 0.4945239936822811, 'recall': 0.471970472379889, 'f1-score': 0.4829840854699769, 'support': 161205}, '1': {'precision': 0.6625781360709169, 'recall': 0.776851316259092, 'f1-score': 0.715178776282507, 'support': 325012}, '2': {'precision': 0.5249943333391452, 'recall': 0.36852540879271517, 'f1-score': 0.4330598243885601, 'support': 163408}, 'accuracy': 0.5984837406195882, 'macro avg': {'precision': 0.5606988210307811, 'recall': 0.5391157324772321, 'f1-score': 0.5437408953803481, 'support': 649625}, 'weighted avg': {'precision': 0.5862672458487835, 'recall': 0.5984837406195882, 'f1-score': 0.5865946872718932, 'support': 649625}}
[[ 76084  61042  24079]
 [ 42119 252486  30407]
 [ 35650  67538  60220]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8844378
{'0': {'precision': 0.4784379199413609, 'recall': 0.46708277013596244, 'f1-score': 0.4726921606887811, 'support': 50308}, '1': {'precision': 0.6501380647435521, 'recall': 0.7614544525159984, 'f1-score': 0.701407124359369, 'support': 101729}, '2': {'precision': 0.5116146825509653, 'recall': 0.3501118785874112, 'f1-score': 0.41572903911466397, 'support': 51395}, 'accuracy': 0.5847359314168862, 'macro avg': {'precision': 0.5467302224119595, 'recall': 0.5262163670797907, 'f1-score': 0.5299427747209381, 'support': 203432}, 'weighted avg': {'precision': 0.5726807320107636, 'recall': 0.5847359314168862, 'f1-score': 0.5726731120924122, 'support': 203432}}
[[23498 19385  7425]
 [14515 77462  9752]
 [11101 22300 17994]]
testing model on single stock: results/universal/W0/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
19053/19053 - 277s - 277s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9997088
{'0': {'precision': 0.39445125545276655, 'recall': 0.5434560060797925, 'f1-score': 0.4571174841556099, 'support': 1247411}, '1': {'precision': 0.6428169176713437, 'recall': 0.5297695242443834, 'f1-score': 0.5808438516389796, 'support': 2395957}, '2': {'precision': 0.4149776648117342, 'recall': 0.39821389647211736, 'f1-score': 0.4064229899107353, 'support': 1234083}, 'accuracy': 0.4999839055277029, 'macro avg': {'precision': 0.4840819459786148, 'recall': 0.4904798089320978, 'f1-score': 0.48146144190177487, 'support': 4877451}, 'weighted avg': {'precision': 0.5216498146578059, 'recall': 0.4999839055277029, 'f1-score': 0.5050691381476549, 'support': 4877451}}
[[ 677913  332430  237068]
 [ 670919 1269305  455733]
 [ 369791  372863  491429]]
Evaluating performance on  train set...
4812/4812 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0998915
{'0': {'precision': 0.4010887587305017, 'recall': 0.6298007188478767, 'f1-score': 0.4900738518811139, 'support': 406762}, '1': {'precision': 0.47539062255175396, 'recall': 0.18641860007864727, 'f1-score': 0.26781631719903326, 'support': 406880}, '2': {'precision': 0.4428697942371646, 'recall': 0.4591560543820805, 'f1-score': 0.4508658984400679, 'support': 418226}, 'accuracy': 0.42541895722593653, 'macro avg': {'precision': 0.4397830585064734, 'recall': 0.4251251244362015, 'f1-score': 0.40291868917340506, 'support': 1231868}, 'weighted avg': {'precision': 0.4398151950917033, 'recall': 0.42541895722593653, 'f1-score': 0.4033519537172848, 'support': 1231868}}
[[256179  41253 109330]
 [198785  75850 132245]
 [183745  42450 192031]]
Evaluating performance on  val set...
1767/1767 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.102934
{'0': {'precision': 0.40035283209999484, 'recall': 0.631861692398366, 'f1-score': 0.4901454340029165, 'support': 147613}, '1': {'precision': 0.4836573706525228, 'recall': 0.18560917901014487, 'f1-score': 0.2682675461197568, 'support': 154265}, '2': {'precision': 0.43721583812140896, 'recall': 0.4654256556859356, 'f1-score': 0.4508799330188223, 'support': 150415}, 'accuracy': 0.42430680996610604, 'macro avg': {'precision': 0.4404086802913089, 'recall': 0.42763217569814876, 'f1-score': 0.40309763771383184, 'support': 452293}, 'weighted avg': {'precision': 0.44102497093591914, 'recall': 0.42430680996610604, 'f1-score': 0.4014106698017943, 'support': 452293}}
[[93271 15097 39245]
 [74764 28633 50868]
 [64937 15471 70007]]
training model: results/universal/W0/deepVOL_L3/h30
Epoch 1/50
8838/8838 - 499s - loss: 3.0477 - accuracy30: 0.4657 - val_loss: 3.1358 - val_accuracy30: 0.4405 - 499s/epoch - 56ms/step
Epoch 2/50
8838/8838 - 510s - loss: 2.9664 - accuracy30: 0.4891 - val_loss: 3.0964 - val_accuracy30: 0.4639 - 510s/epoch - 58ms/step
Epoch 3/50
8838/8838 - 511s - loss: 2.9448 - accuracy30: 0.4943 - val_loss: 3.0544 - val_accuracy30: 0.4665 - 511s/epoch - 58ms/step
Epoch 4/50
8838/8838 - 509s - loss: 2.9316 - accuracy30: 0.4966 - val_loss: 3.0336 - val_accuracy30: 0.4693 - 509s/epoch - 58ms/step
Epoch 5/50
8838/8838 - 502s - loss: 2.9217 - accuracy30: 0.4986 - val_loss: 3.0192 - val_accuracy30: 0.4689 - 502s/epoch - 57ms/step
Epoch 6/50
8838/8838 - 497s - loss: 2.9124 - accuracy30: 0.5009 - val_loss: 3.0040 - val_accuracy30: 0.4737 - 497s/epoch - 56ms/step
Epoch 7/50
8838/8838 - 515s - loss: 2.9057 - accuracy30: 0.5026 - val_loss: 3.0030 - val_accuracy30: 0.4731 - 515s/epoch - 58ms/step
Epoch 8/50
8838/8838 - 494s - loss: 2.8998 - accuracy30: 0.5042 - val_loss: 2.9958 - val_accuracy30: 0.4771 - 494s/epoch - 56ms/step
Epoch 9/50
8838/8838 - 485s - loss: 2.8955 - accuracy30: 0.5051 - val_loss: 2.9988 - val_accuracy30: 0.4751 - 485s/epoch - 55ms/step
Epoch 10/50
8838/8838 - 469s - loss: 2.8914 - accuracy30: 0.5060 - val_loss: 2.9940 - val_accuracy30: 0.4760 - 469s/epoch - 53ms/step
Epoch 11/50
8838/8838 - 489s - loss: 2.8880 - accuracy30: 0.5069 - val_loss: 3.0002 - val_accuracy30: 0.4758 - 489s/epoch - 55ms/step
Epoch 12/50
8838/8838 - 482s - loss: 2.8843 - accuracy30: 0.5077 - val_loss: 2.9905 - val_accuracy30: 0.4781 - 482s/epoch - 55ms/step
Epoch 13/50
8838/8838 - 480s - loss: 2.8815 - accuracy30: 0.5083 - val_loss: 3.0015 - val_accuracy30: 0.4776 - 480s/epoch - 54ms/step
Epoch 14/50
8838/8838 - 482s - loss: 2.8787 - accuracy30: 0.5090 - val_loss: 2.9926 - val_accuracy30: 0.4779 - 482s/epoch - 55ms/step
Epoch 15/50
8838/8838 - 478s - loss: 2.8764 - accuracy30: 0.5093 - val_loss: 2.9864 - val_accuracy30: 0.4775 - 478s/epoch - 54ms/step
Epoch 16/50
8838/8838 - 477s - loss: 2.8738 - accuracy30: 0.5104 - val_loss: 2.9895 - val_accuracy30: 0.4802 - 477s/epoch - 54ms/step
Epoch 17/50
8838/8838 - 479s - loss: 2.8715 - accuracy30: 0.5108 - val_loss: 2.9903 - val_accuracy30: 0.4806 - 479s/epoch - 54ms/step
Epoch 18/50
8838/8838 - 513s - loss: 2.8693 - accuracy30: 0.5112 - val_loss: 2.9802 - val_accuracy30: 0.4815 - 513s/epoch - 58ms/step
Epoch 19/50
8838/8838 - 513s - loss: 2.8677 - accuracy30: 0.5118 - val_loss: 2.9868 - val_accuracy30: 0.4818 - 513s/epoch - 58ms/step
Epoch 20/50
8838/8838 - 501s - loss: 2.8660 - accuracy30: 0.5122 - val_loss: 2.9901 - val_accuracy30: 0.4812 - 501s/epoch - 57ms/step
Epoch 21/50
8838/8838 - 499s - loss: 2.8643 - accuracy30: 0.5126 - val_loss: 2.9812 - val_accuracy30: 0.4824 - 499s/epoch - 56ms/step
Epoch 22/50
8838/8838 - 492s - loss: 2.8623 - accuracy30: 0.5131 - val_loss: 2.9865 - val_accuracy30: 0.4813 - 492s/epoch - 56ms/step
Epoch 23/50
8838/8838 - 507s - loss: 2.8608 - accuracy30: 0.5133 - val_loss: 2.9806 - val_accuracy30: 0.4840 - 507s/epoch - 57ms/step
Epoch 24/50
8838/8838 - 511s - loss: 2.8592 - accuracy30: 0.5142 - val_loss: 2.9742 - val_accuracy30: 0.4831 - 511s/epoch - 58ms/step
Epoch 25/50
8838/8838 - 512s - loss: 2.8578 - accuracy30: 0.5142 - val_loss: 2.9714 - val_accuracy30: 0.4837 - 512s/epoch - 58ms/step
Epoch 26/50
8838/8838 - 511s - loss: 2.8559 - accuracy30: 0.5146 - val_loss: 2.9716 - val_accuracy30: 0.4835 - 511s/epoch - 58ms/step
Epoch 27/50
8838/8838 - 510s - loss: 2.8547 - accuracy30: 0.5151 - val_loss: 2.9714 - val_accuracy30: 0.4830 - 510s/epoch - 58ms/step
Epoch 28/50
8838/8838 - 507s - loss: 2.8532 - accuracy30: 0.5155 - val_loss: 2.9785 - val_accuracy30: 0.4827 - 507s/epoch - 57ms/step
Epoch 29/50
8838/8838 - 507s - loss: 2.8521 - accuracy30: 0.5158 - val_loss: 2.9808 - val_accuracy30: 0.4825 - 507s/epoch - 57ms/step
Epoch 30/50
8838/8838 - 514s - loss: 2.8506 - accuracy30: 0.5162 - val_loss: 2.9838 - val_accuracy30: 0.4817 - 514s/epoch - 58ms/step
Epoch 31/50
8838/8838 - 511s - loss: 2.8496 - accuracy30: 0.5164 - val_loss: 2.9774 - val_accuracy30: 0.4838 - 511s/epoch - 58ms/step
Epoch 32/50
8838/8838 - 505s - loss: 2.8484 - accuracy30: 0.5167 - val_loss: 2.9738 - val_accuracy30: 0.4841 - 505s/epoch - 57ms/step
Epoch 33/50
8838/8838 - 492s - loss: 2.8467 - accuracy30: 0.5170 - val_loss: 2.9719 - val_accuracy30: 0.4836 - 492s/epoch - 56ms/step
Epoch 34/50
8838/8838 - 492s - loss: 2.8455 - accuracy30: 0.5177 - val_loss: 2.9842 - val_accuracy30: 0.4818 - 492s/epoch - 56ms/step
Epoch 35/50
8838/8838 - 498s - loss: 2.8445 - accuracy30: 0.5180 - val_loss: 2.9807 - val_accuracy30: 0.4828 - 498s/epoch - 56ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1048s - 1048s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9344643
{'0': {'precision': 0.4153378940633094, 'recall': 0.5441334710172651, 'f1-score': 0.47109118242979714, 'support': 2119831}, '1': {'precision': 0.6705275247448961, 'recall': 0.6146902114411407, 'f1-score': 0.641395919707232, 'support': 4218006}, '2': {'precision': 0.44736452854020725, 'recall': 0.3825000284199637, 'f1-score': 0.4123972844617477, 'support': 2111192}, 'accuracy': 0.5389695076203431, 'macro avg': {'precision': 0.5110766491161376, 'recall': 0.5137745702927898, 'f1-score': 0.5082947955329256, 'support': 8449029}, 'weighted avg': {'precision': 0.5507387511141336, 'recall': 0.5389695076203431, 'f1-score': 0.5414462866465871, 'support': 8449029}}
[[1153471  601125  365235]
 [ 992920 2592767  632319]
 [ 630796  672865  807531]]
Evaluating performance on  train set...
8838/8838 - 273s - 273s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0053629
{'0': {'precision': 0.4087061317535683, 'recall': 0.6189511459289252, 'f1-score': 0.4923219717132332, 'support': 682154}, '1': {'precision': 0.6339226739988633, 'recall': 0.42124454051896115, 'f1-score': 0.5061500430625662, 'support': 881723}, '2': {'precision': 0.45108055070922315, 'recall': 0.4154842128631686, 'f1-score': 0.4325512770140454, 'support': 698195}, 'accuracy': 0.47908731463896814, 'macro avg': {'precision': 0.4979031188205516, 'recall': 0.48522663310368497, 'f1-score': 0.4770077639299483, 'support': 2262072}, 'weighted avg': {'precision': 0.5095712734116993, 'recall': 0.47908731463896814, 'f1-score': 0.479263558174163, 'support': 2262072}}
[[422220 100354 159580]
 [316873 371421 193429]
 [293972 114134 290089]]
Evaluating performance on  val set...
3279/3279 - 89s - 89s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99817467
{'0': {'precision': 0.4072559256636501, 'recall': 0.6101134291753393, 'f1-score': 0.4884603771025722, 'support': 247908}, '1': {'precision': 0.6351391888648908, 'recall': 0.4401675007053443, 'f1-score': 0.5199774763317295, 'support': 336715}, '2': {'precision': 0.454273657594861, 'recall': 0.4183218356446703, 'f1-score': 0.4355571208019886, 'support': 254254}, 'accuracy': 0.4837693726255458, 'macro avg': {'precision': 0.4988895907078006, 'recall': 0.4895342551751179, 'f1-score': 0.48133165807876344, 'support': 838877}, 'weighted avg': {'precision': 0.5129760245377923, 'recall': 0.4837693726255458, 'f1-score': 0.4850765860813583, 'support': 838877}}
[[151252  40575  56081]
 [116813 148211  71691]
 [103328  44566 106360]]
testing model out of sample: results/universal/W0/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 685s - 685s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9206574
{'0': {'precision': 0.4905822763378811, 'recall': 0.5450534738401712, 'f1-score': 0.5163853678794097, 'support': 1722431}, '1': {'precision': 0.6108281762487038, 'recall': 0.691382271014394, 'f1-score': 0.648613705383804, 'support': 2362583}, '2': {'precision': 0.5315111422011017, 'recall': 0.3786157376445194, 'f1-score': 0.4422207224664894, 'support': 1747949}, 'accuracy': 0.5544465137186709, 'macro avg': {'precision': 0.5443071982625622, 'recall': 0.5383504941663616, 'f1-score': 0.535739931909901, 'support': 5832963}, 'weighted avg': {'precision': 0.5515517165873327, 'recall': 0.5544465137186709, 'f1-score': 0.5477183978542742, 'support': 5832963}}
[[ 938817  486235  297379]
 [ 443184 1633448  285951]
 [ 531678  554470  661801]]
Evaluating performance on  train set...
6334/6334 - 200s - 200s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94720936
{'0': {'precision': 0.47228869119059047, 'recall': 0.5317704143361184, 'f1-score': 0.5002676667504262, 'support': 473601}, '1': {'precision': 0.6016587887087511, 'recall': 0.6515623341500935, 'f1-score': 0.6256169762583014, 'support': 668903}, '2': {'precision': 0.5062791107391788, 'recall': 0.38444092341909214, 'f1-score': 0.43702712721466047, 'support': 478396}, 'accuracy': 0.5377222530692825, 'macro avg': {'precision': 0.5267421968795069, 'recall': 0.5225912239684346, 'f1-score': 0.5209705900744627, 'support': 1620900}, 'weighted avg': {'precision': 0.5357083513118543, 'recall': 0.5377222530692825, 'f1-score': 0.5333310932579184, 'support': 1620900}}
[[251847 137078  84676]
 [138394 435832  94677]
 [143007 151474 183915]]
Evaluating performance on  val set...
2156/2156 - 62s - 62s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94460005
{'0': {'precision': 0.46535789088733004, 'recall': 0.5380239463417447, 'f1-score': 0.4990596393650115, 'support': 156099}, '1': {'precision': 0.6058168463452197, 'recall': 0.6480557609040025, 'f1-score': 0.6262248573848618, 'support': 236725}, '2': {'precision': 0.5027119854453947, 'recall': 0.373058433119251, 'f1-score': 0.42828792027001583, 'support': 158506}, 'accuracy': 0.5378412203217674, 'macro avg': {'precision': 0.5246289075593148, 'recall': 0.5197127134549994, 'f1-score': 0.517857472339963, 'support': 551330}, 'weighted avg': {'precision': 0.5364060731788606, 'recall': 0.5378412203217674, 'f1-score': 0.5333139772912584, 'support': 551330}}
[[ 83985  46290  25824]
 [ 50644 153411  32670]
 [ 45845  53529  59132]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1712356
{'0': {'precision': 0.31852210028235173, 'recall': 0.6258737699355277, 'f1-score': 0.42218445463024956, 'support': 58940}, '1': {'precision': 0.7168183670696916, 'recall': 0.10059385932301944, 'f1-score': 0.1764287923496811, 'support': 104907}, '2': {'precision': 0.3370113223670156, 'recall': 0.5231644226304968, 'f1-score': 0.409944909308248, 'support': 60308}, 'accuracy': 0.35240347081260737, 'macro avg': {'precision': 0.45745059657301973, 'recall': 0.41654401729634793, 'f1-score': 0.33618605209605956, 'support': 224155}, 'weighted avg': {'precision': 0.5099035750000309, 'recall': 0.35240347081260737, 'f1-score': 0.30387510724943334, 'support': 224155}}
[[36889  1974 20077]
 [52362 10553 41992]
 [26562  2195 31551]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1317152
{'0': {'precision': 0.3906486664471518, 'recall': 0.6438727884511017, 'f1-score': 0.4862693663415035, 'support': 27639}, '1': {'precision': 0.5885673959068455, 'recall': 0.03129338486360737, 'f1-score': 0.05942710560068405, 'support': 26651}, '2': {'precision': 0.4046006539000467, 'recall': 0.5145148117900363, 'f1-score': 0.45298558682223744, 'support': 26938}, 'accuracy': 0.3999852267690944, 'macro avg': {'precision': 0.461272238751348, 'recall': 0.39656032836824845, 'f1-score': 0.33289401958814163, 'support': 81228}, 'weighted avg': {'precision': 0.46021298782446474, 'recall': 0.3999852267690944, 'f1-score': 0.3351838841962633, 'support': 81228}}
[[17796   282  9561]
 [14982   834 10835]
 [12777   301 13860]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1510432
{'0': {'precision': 0.35653980166175286, 'recall': 0.6571569717179202, 'f1-score': 0.46227357629990007, 'support': 8097}, '1': {'precision': 0.6154776299879081, 'recall': 0.050636689216076405, 'f1-score': 0.09357477709348286, 'support': 10052}, '2': {'precision': 0.37628002234220814, 'recall': 0.48441994247363374, 'f1-score': 0.4235565335848266, 'support': 8344}, 'accuracy': 0.37262673158947646, 'macro avg': {'precision': 0.44943248466395636, 'recall': 0.3974045344692101, 'f1-score': 0.32646829565940316, 'support': 26493}, 'weighted avg': {'precision': 0.4610034506140131, 'recall': 0.37262673158947646, 'f1-score': 0.3101875409683982, 'support': 26493}}
[[5321  122 2654]
 [5497  509 4046]
 [4106  196 4042]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75790375
{'0': {'precision': 0.521697024817051, 'recall': 0.5097379355741144, 'f1-score': 0.515648149689534, 'support': 121535}, '1': {'precision': 0.7665984630008539, 'recall': 0.8013675559148478, 'f1-score': 0.7835975132776154, 'support': 356256}, '2': {'precision': 0.5353518312985571, 'recall': 0.47853520321912424, 'f1-score': 0.5053515602081954, 'support': 125997}, 'accuracy': 0.6752982835034813, 'macro avg': {'precision': 0.6078824397054873, 'recall': 0.5965468982360288, 'f1-score': 0.6015324077251148, 'support': 603788}, 'weighted avg': {'precision': 0.6690468751185793, 'recall': 0.6752982835034813, 'f1-score': 0.671598962043465, 'support': 603788}}
[[ 61951  44357  15227]
 [ 33660 285492  37104]
 [ 23138  42565  60294]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8197018
{'0': {'precision': 0.49318907137853196, 'recall': 0.5438471002260308, 'f1-score': 0.5172807924672075, 'support': 34951}, '1': {'precision': 0.711506613126432, 'recall': 0.770000368274389, 'f1-score': 0.7395987477817932, 'support': 81461}, '2': {'precision': 0.5636090977255686, 'recall': 0.39454116000349926, 'f1-score': 0.46415890495548806, 'support': 34293}, 'accuracy': 0.6321157227696493, 'macro avg': {'precision': 0.5894349274101774, 'recall': 0.569462876167973, 'f1-score': 0.5736794817348296, 'support': 150705}, 'weighted avg': {'precision': 0.6272209829398246, 'recall': 0.6321157227696493, 'f1-score': 0.6253630330660069, 'support': 150705}}
[[19008 12254  3689]
 [11949 62725  6787]
 [ 7584 13179 13530]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.820797
{'0': {'precision': 0.522263868065967, 'recall': 0.49573075281058776, 'f1-score': 0.5086515295320143, 'support': 14054}, '1': {'precision': 0.6899907589234145, 'recall': 0.7812254773737902, 'f1-score': 0.7327792430840949, 'support': 30584}, '2': {'precision': 0.5647806855879101, 'recall': 0.432167536313637, 'f1-score': 0.4896540704641687, 'support': 14182}, 'accuracy': 0.6288507310438626, 'macro avg': {'precision': 0.5923451041924305, 'recall': 0.569707922166005, 'f1-score': 0.5770282810267593, 'support': 58820}, 'weighted avg': {'precision': 0.6197261723175884, 'recall': 0.6288507310438626, 'f1-score': 0.6206083473962891, 'support': 58820}}
[[ 6967  5486  1601]
 [ 3569 23893  3122]
 [ 2804  5249  6129]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99722874
{'0': {'precision': 0.48378603654260877, 'recall': 0.5331097827671673, 'f1-score': 0.5072517045493955, 'support': 137180}, '1': {'precision': 0.5059760956175299, 'recall': 0.5698015530629853, 'f1-score': 0.5359954549143738, 'support': 139080}, '2': {'precision': 0.5203634983944254, 'recall': 0.4028268298099448, 'f1-score': 0.4541130295737567, 'support': 139591}, 'accuracy': 0.5016484269606181, 'macro avg': {'precision': 0.5033752101848546, 'recall': 0.5019127218800324, 'f1-score': 0.4991200630125087, 'support': 415851}, 'weighted avg': {'precision': 0.5034855873276182, 'recall': 0.5016484269606181, 'f1-score': 0.4990276051056928, 'support': 415851}}
[[73132 37564 26484]
 [34486 79248 25346]
 [43548 39812 56231]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0200181
{'0': {'precision': 0.4473776291746044, 'recall': 0.5973783257624918, 'f1-score': 0.5116098124868007, 'support': 38525}, '1': {'precision': 0.5065737655255983, 'recall': 0.4439194032228092, 'f1-score': 0.47318156736795935, 'support': 37669}, '2': {'precision': 0.5014194464158978, 'recall': 0.3959394742205013, 'f1-score': 0.4424801434793748, 'support': 39256}, 'accuracy': 0.4788133391078389, 'macro avg': {'precision': 0.4851236137053669, 'recall': 0.4790790677352675, 'f1-score': 0.4757571744447116, 'support': 115450}, 'weighted avg': {'precision': 0.4850677533654212, 'recall': 0.4788133391078389, 'f1-score': 0.47556556950770024, 'support': 115450}}
[[23014  7694  7817]
 [13309 16722  7638]
 [15119  8594 15543]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0225201
{'0': {'precision': 0.4692618475649705, 'recall': 0.5616545775338169, 'f1-score': 0.5113180046997233, 'support': 15303}, '1': {'precision': 0.47931546566720884, 'recall': 0.46558593213353483, 'f1-score': 0.47235095299487784, 'support': 14558}, '2': {'precision': 0.4898152534343913, 'recall': 0.4064998034333639, 'f1-score': 0.4442853050701805, 'support': 15262}, 'accuracy': 0.4781818584757219, 'macro avg': {'precision': 0.4794641888888569, 'recall': 0.4779134377002386, 'f1-score': 0.4759847542549272, 'support': 45123}, 'weighted avg': {'precision': 0.4794572391105567, 'recall': 0.4781818584757219, 'f1-score': 0.4760735528577531, 'support': 45123}}
[[8595 3494 3214]
 [4532 6778 3248]
 [5189 3869 6204]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1571043
{'0': {'precision': 0.3431383182158086, 'recall': 0.542556456125783, 'f1-score': 0.42039744454973654, 'support': 110794}, '1': {'precision': 0.35751478691673827, 'recall': 0.06772065230922444, 'f1-score': 0.11387166894774976, 'support': 104429}, '2': {'precision': 0.3239291217257319, 'recall': 0.3838380149898212, 'f1-score': 0.3513480765936467, 'support': 109541}, 'accuracy': 0.3363365397642596, 'macro avg': {'precision': 0.34152740895275957, 'recall': 0.3313717078082762, 'f1-score': 0.29520573003037764, 'support': 324764}, 'weighted avg': {'precision': 0.34128197224534973, 'recall': 0.3363365397642596, 'f1-score': 0.2985430609492823, 'support': 324764}}
[[60112  6295 44387]
 [53990  7072 43367]
 [61081  6414 42046]]
Evaluating performance on  train set...
486/486 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1656796
{'0': {'precision': 0.33913589319615406, 'recall': 0.5365906833652285, 'f1-score': 0.41560269050723747, 'support': 41281}, '1': {'precision': 0.3737224314147391, 'recall': 0.06760241315559015, 'f1-score': 0.11449406723796966, 'support': 41108}, '2': {'precision': 0.322408403393977, 'recall': 0.39662255768403953, 'f1-score': 0.3556855058959612, 'support': 41866}, 'accuracy': 0.3342722626856062, 'macro avg': {'precision': 0.34508890933495673, 'recall': 0.333605218068286, 'f1-score': 0.2952607545470561, 'support': 124255}, 'weighted avg': {'precision': 0.344942261753006, 'recall': 0.3342722626856062, 'f1-score': 0.29579691901885674, 'support': 124255}}
[[22151  2278 16852]
 [20283  2779 18046]
 [22882  2379 16605]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1506448
{'0': {'precision': 0.3369786038469851, 'recall': 0.5207748830995323, 'f1-score': 0.409185146306259, 'support': 14970}, '1': {'precision': 0.3820816864295125, 'recall': 0.09537591264881931, 'f1-score': 0.15264764712074955, 'support': 15203}, '2': {'precision': 0.3226465841850457, 'recall': 0.3908255685150192, 'f1-score': 0.353478504287356, 'support': 15347}, 'accuracy': 0.3348857644991213, 'macro avg': {'precision': 0.3472356248205144, 'recall': 0.3356587880877903, 'f1-score': 0.30510376590478816, 'support': 45520}, 'weighted avg': {'precision': 0.3472103406385137, 'recall': 0.3348857644991213, 'f1-score': 0.3047240427214303, 'support': 45520}}
[[7796 1154 6020]
 [7181 1450 6572]
 [8158 1191 5998]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.11895
{'0': {'precision': 0.383237791659169, 'recall': 0.6324370567814646, 'f1-score': 0.4772664822338953, 'support': 141437}, '1': {'precision': 0.4975995610625943, 'recall': 0.13858133360498653, 'f1-score': 0.21678743059186772, 'support': 157063}, '2': {'precision': 0.4248214758000529, 'recall': 0.4873734587482415, 'f1-score': 0.4539527773495709, 'support': 145012}, 'accuracy': 0.41011517163007993, 'macro avg': {'precision': 0.43521960950727206, 'recall': 0.4194639497115642, 'f1-score': 0.3826688967251113, 'support': 443512}, 'weighted avg': {'precision': 0.4373335901774685, 'recall': 0.41011517163007993, 'f1-score': 0.37739908685172424, 'support': 443512}}
[[89450 10875 41112]
 [80720 21766 54577]
 [63236 11101 70675]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0812043
{'0': {'precision': 0.40290765340931894, 'recall': 0.6202140639720759, 'f1-score': 0.48848341088100233, 'support': 64747}, '1': {'precision': 0.5149916218046989, 'recall': 0.2232508539016738, 'f1-score': 0.31147576332585825, 'support': 64703}, '2': {'precision': 0.43550781077784473, 'recall': 0.4468890430376693, 'f1-score': 0.44112502884021404, 'support': 66314}, 'accuracy': 0.4302987270386792, 'macro avg': {'precision': 0.45113569533062087, 'recall': 0.430117986970473, 'f1-score': 0.4136947343490249, 'support': 195764}, 'weighted avg': {'precision': 0.4509962490797317, 'recall': 0.4302987270386792, 'f1-score': 0.4139372759102553, 'support': 195764}}
[[40157  6605 17985]
 [29831 14445 20427]
 [29680  6999 29635]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0962977
{'0': {'precision': 0.3995576411513286, 'recall': 0.6325053229240596, 'f1-score': 0.48974208675263775, 'support': 21135}, '1': {'precision': 0.5287128712871287, 'recall': 0.18162441612625277, 'f1-score': 0.2703706204009991, 'support': 22051}, '2': {'precision': 0.4290720256691717, 'recall': 0.4719951699795653, 'f1-score': 0.44951125657923835, 'support': 21532}, 'accuracy': 0.4254766834574616, 'macro avg': {'precision': 0.4524475127025431, 'recall': 0.4287083030099592, 'f1-score': 0.4032079879109584, 'support': 64718}, 'weighted avg': {'precision': 0.4533835583175378, 'recall': 0.4254766834574616, 'f1-score': 0.4016118843388793, 'support': 64718}}
[[13368  1660  6107]
 [10630  4005  7416]
 [ 9459  1910 10163]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
4693/4693 - 69s - 69s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6850816
{'0': {'precision': 0.5832779496199761, 'recall': 0.5102509179926561, 'f1-score': 0.5443260220248602, 'support': 228760}, '1': {'precision': 0.7654783870031912, 'recall': 0.8882430010489506, 'f1-score': 0.8223039559410794, 'support': 742647}, '2': {'precision': 0.6615993052116306, 'recall': 0.4011401962704267, 'f1-score': 0.49945273470095475, 'support': 229785}, 'accuracy': 0.7230750787551032, 'macro avg': {'precision': 0.6701185472782659, 'recall': 0.5998780384373444, 'f1-score': 0.6220275708889648, 'support': 1201192}, 'weighted avg': {'precision': 0.7109075716254181, 'recall': 0.7230750787551032, 'f1-score': 0.7076040578104422, 'support': 1201192}}
[[116725  94126  17909]
 [ 53758 659651  29238]
 [ 29636 107973  92176]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73054576
{'0': {'precision': 0.5914434813903968, 'recall': 0.49343191712956014, 'f1-score': 0.5380103397945682, 'support': 79932}, '1': {'precision': 0.7245203814579807, 'recall': 0.8765193781317794, 'f1-score': 0.7933046639167429, 'support': 221719}, '2': {'precision': 0.621659167720666, 'recall': 0.3678863284988589, 'f1-score': 0.46223222613642495, 'support': 81498}, 'accuracy': 0.6884110359155315, 'macro avg': {'precision': 0.6458743435230145, 'recall': 0.5792792079200662, 'f1-score': 0.597849076615912, 'support': 383149}, 'weighted avg': {'precision': 0.674878894795179, 'recall': 0.6884110359155315, 'f1-score': 0.6696245095904781, 'support': 383149}}
[[ 39441  33587   6904]
 [ 16035 194341  11343]
 [ 11210  40306  29982]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70400536
{'0': {'precision': 0.6114259805032872, 'recall': 0.4886754846892553, 'f1-score': 0.5432024169184291, 'support': 27595}, '1': {'precision': 0.7385719984044675, 'recall': 0.8858694352079994, 'f1-score': 0.8055425644149093, 'support': 83606}, '2': {'precision': 0.6447594010744085, 'recall': 0.39403464654931547, 'f1-score': 0.48913938868415346, 'support': 28632}, 'accuracy': 0.7067788004262227, 'macro avg': {'precision': 0.6649191266607212, 'recall': 0.5895265221488567, 'f1-score': 0.612628123339164, 'support': 139833}, 'weighted avg': {'precision': 0.6942717498884711, 'recall': 0.7067788004262227, 'f1-score': 0.6889854420068342, 'support': 139833}}
[[13485 11903  2207]
 [ 5533 74064  4009]
 [ 3037 14313 11282]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
6677/6677 - 96s - 96s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70916885
{'0': {'precision': 0.5198904088444694, 'recall': 0.453296592377261, 'f1-score': 0.48431504005492837, 'support': 297216}, '1': {'precision': 0.7656663174751144, 'recall': 0.892605245460659, 'f1-score': 0.8242772613683222, 'support': 1115250}, '2': {'precision': 0.6195339844661488, 'recall': 0.3130752644700492, 'f1-score': 0.4159529111600998, 'support': 296820}, 'accuracy': 0.7155806576547167, 'macro avg': {'precision': 0.6350302369285775, 'recall': 0.5529923674359897, 'f1-score': 0.5748484041944502, 'support': 1709286}, 'weighted avg': {'precision': 0.6975539409955276, 'recall': 0.7155806576547167, 'f1-score': 0.6942574488859838, 'support': 1709286}}
[[134727 143997  18492]
 [ 81196 995478  38576]
 [ 43222 160671  92927]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8807002
{'0': {'precision': 0.5085752061953032, 'recall': 0.5161502629409772, 'f1-score': 0.5123347361010246, 'support': 156499}, '1': {'precision': 0.6390929659099576, 'recall': 0.7607606093044896, 'f1-score': 0.6946394433766274, 'support': 264367}, '2': {'precision': 0.556496719116488, 'recall': 0.370982546987662, 'f1-score': 0.4451863837674818, 'support': 157967}, 'accuracy': 0.5882525702577427, 'macro avg': {'precision': 0.5680549637405828, 'recall': 0.549297806411043, 'f1-score': 0.5507201877483779, 'support': 578833}, 'weighted avg': {'precision': 0.5812638853378277, 'recall': 0.5882525702577427, 'f1-score': 0.5772725070561301, 'support': 578833}}
[[ 80777  53543  22179]
 [ 38722 201120  24525]
 [ 39331  60033  58603]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.858359
{'0': {'precision': 0.5089460340456357, 'recall': 0.5248277278754039, 'f1-score': 0.5167648870542157, 'support': 53549}, '1': {'precision': 0.6542709330046544, 'recall': 0.7754913739247441, 'f1-score': 0.7097423988529559, 'support': 104045}, '2': {'precision': 0.5743746593180304, 'recall': 0.35143598295349265, 'f1-score': 0.4360630862608056, 'support': 53970}, 'accuracy': 0.6038692783271256, 'macro avg': {'precision': 0.5791972087894401, 'recall': 0.5505850282512136, 'f1-score': 0.5541901240559923, 'support': 211564}, 'weighted avg': {'precision': 0.5971061747980426, 'recall': 0.6038692783271256, 'f1-score': 0.591082204869532, 'support': 211564}}
[[28104 19762  5683]
 [14987 80686  8372]
 [12129 22874 18967]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
5633/5633 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84666663
{'0': {'precision': 0.5010320125017407, 'recall': 0.4736691211533454, 'f1-score': 0.48696648610931487, 'support': 341823}, '1': {'precision': 0.6860558025423739, 'recall': 0.7904037828566131, 'f1-score': 0.7345424242461543, 'support': 754985}, '2': {'precision': 0.5366106516864768, 'recall': 0.38704909195249054, 'f1-score': 0.4497211595452342, 'support': 345026}, 'accuracy': 0.6187924546098926, 'macro avg': {'precision': 0.5745661555768637, 'recall': 0.5503739986541497, 'f1-score': 0.5570766899669012, 'support': 1441834}, 'weighted avg': {'precision': 0.6064295420975057, 'recall': 0.6187924546098926, 'f1-score': 0.6076915582127216, 'support': 1441834}}
[[161911 136118  43794]
 [ 86716 596743  71526]
 [ 74528 136956 133542]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9819959
{'0': {'precision': 0.4787664164440109, 'recall': 0.5617080209646388, 'f1-score': 0.5169313663387495, 'support': 120584}, '1': {'precision': 0.5506039080824353, 'recall': 0.5064142426126811, 'f1-score': 0.5275853795089179, 'support': 130257}, '2': {'precision': 0.497689905971954, 'recall': 0.4548550975637917, 'f1-score': 0.47530938674204565, 'support': 121254}, 'accuracy': 0.5075316787379567, 'macro avg': {'precision': 0.5090200768328, 'recall': 0.5076591203803705, 'f1-score': 0.5066087108632377, 'support': 372095}, 'weighted avg': {'precision': 0.5100806908835155, 'recall': 0.5075316787379567, 'f1-score': 0.5070976633314205, 'support': 372095}}
[[67733 26346 26505]
 [35133 65964 29160]
 [38608 27493 55153]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96547055
{'0': {'precision': 0.4757162178777819, 'recall': 0.5270279474198015, 'f1-score': 0.5000592385158059, 'support': 44047}, '1': {'precision': 0.5574680532775805, 'recall': 0.5872190157958688, 'f1-score': 0.5719569136886875, 'support': 52672}, '2': {'precision': 0.5254917387883556, 'recall': 0.4385231550380811, 'f1-score': 0.47808451241917393, 'support': 45692}, 'accuracy': 0.5208937511849506, 'macro avg': {'precision': 0.5195586699812393, 'recall': 0.5175900394179171, 'f1-score': 0.5167002215412225, 'support': 142411}, 'weighted avg': {'precision': 0.5219231525641763, 'recall': 0.5208937511849506, 'f1-score': 0.519600742766873, 'support': 142411}}
[[23214 12333  8500]
 [12149 30930  9593]
 [13435 12220 20037]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
11876/11876 - 172s - 172s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9815619
{'0': {'precision': 0.5238008511361636, 'recall': 0.5552912772213324, 'f1-score': 0.5390865821248224, 'support': 1087658}, '1': {'precision': 0.45372163318372194, 'recall': 0.6218593543767275, 'f1-score': 0.5246486227287024, 'support': 846283}, '2': {'precision': 0.5637429216548545, 'recall': 0.3705996467242442, 'f1-score': 0.44720841087444557, 'support': 1106218}, 'accuracy': 0.5066182393749801, 'macro avg': {'precision': 0.5137551353249133, 'recall': 0.515916759440768, 'f1-score': 0.5036478719093235, 'support': 3040159}, 'weighted avg': {'precision': 0.5188266989811608, 'recall': 0.5066182393749801, 'f1-score': 0.5016359466692834, 'support': 3040159}}
[[603967 292498 191193]
 [193953 526269 126061]
 [355127 341127 409964]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93017155
{'0': {'precision': 0.5079698977468307, 'recall': 0.48506103947022144, 'f1-score': 0.4962512191436461, 'support': 186191}, '1': {'precision': 0.5843866492033564, 'recall': 0.7368545222911441, 'f1-score': 0.6518233832283419, 'support': 275513}, '2': {'precision': 0.531976276961651, 'recall': 0.35225972616152534, 'f1-score': 0.4238547559363165, 'support': 187921}, 'accuracy': 0.5534331345006734, 'macro avg': {'precision': 0.5414442746372793, 'recall': 0.524725095974297, 'f1-score': 0.5239764527694349, 'support': 649625}, 'weighted avg': {'precision': 0.5473235421300826, 'recall': 0.5534331345006734, 'f1-score': 0.541288491233055, 'support': 649625}}
[[ 90314  68830  27047]
 [ 41308 203013  31192]
 [ 46172  75552  66197]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9423564
{'0': {'precision': 0.4887200068311844, 'recall': 0.49326898215978626, 'f1-score': 0.4909839581367419, 'support': 58015}, '1': {'precision': 0.572520718875128, 'recall': 0.7147606924051663, 'f1-score': 0.6357822024828212, 'support': 86019}, '2': {'precision': 0.5253287806439566, 'recall': 0.3315431496009967, 'f1-score': 0.4065231976054085, 'support': 59398}, 'accuracy': 0.5397036847693578, 'macro avg': {'precision': 0.5288565021167563, 'recall': 0.5131909413886497, 'f1-score': 0.5110964527416572, 'support': 203432}, 'weighted avg': {'precision': 0.5348432391458597, 'recall': 0.5397036847693578, 'f1-score': 0.5275494931871039, 'support': 203432}}
[[28617 21084  8314]
 [15056 61483  9480]
 [14882 24823 19693]]
testing model on single stock: results/universal/W0/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
19053/19053 - 270s - 270s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0288719
{'0': {'precision': 0.38400358720238004, 'recall': 0.5716091878088174, 'f1-score': 0.45939105113753387, 'support': 1316919}, '1': {'precision': 0.5988258418070539, 'recall': 0.46191090897906745, 'f1-score': 0.5215322061845368, 'support': 2259689}, '2': {'precision': 0.40806378943082994, 'recall': 0.36830962691116453, 'f1-score': 0.3871689032047439, 'support': 1300843}, 'accuracy': 0.4665656302851633, 'macro avg': {'precision': 0.46363107281342125, 'recall': 0.4672765745663498, 'f1-score': 0.45603072017560486, 'support': 4877451}, 'weighted avg': {'precision': 0.48994622636632945, 'recall': 0.4665656302851633, 'f1-score': 0.4689185705167491, 'support': 4877451}}
[[ 752763  320233  243923]
 [ 764837 1043775  451077]
 [ 442702  379028  479113]]
Evaluating performance on  train set...
4812/4812 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1043832
{'0': {'precision': 0.3794088315142113, 'recall': 0.6756634090270001, 'f1-score': 0.4859433404945687, 'support': 405406}, '1': {'precision': 0.44638533548987896, 'recall': 0.11183806590729362, 'f1-score': 0.1788634172111557, 'support': 407178}, '2': {'precision': 0.4269845278050861, 'recall': 0.41538432184390534, 'f1-score': 0.4211045519882685, 'support': 419284}, 'accuracy': 0.40070851747102776, 'macro avg': {'precision': 0.41759289826972545, 'recall': 0.40096193225939963, 'f1-score': 0.3619704365646643, 'support': 1231868}, 'weighted avg': {'precision': 0.41774011959006646, 'recall': 0.40070851747102776, 'f1-score': 0.36237323752674333, 'support': 1231868}}
[[273918  25808 105680]
 [233591  45538 128049]
 [214451  30669 174164]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.106792
{'0': {'precision': 0.3786259137018329, 'recall': 0.6786039309436166, 'f1-score': 0.486057094767975, 'support': 147242}, '1': {'precision': 0.46, 'recall': 0.11674749434206272, 'f1-score': 0.18623001547189272, 'support': 154650}, '2': {'precision': 0.4235369843909242, 'recall': 0.4199972074653759, 'f1-score': 0.4217596688310604, 'support': 150401}, 'accuracy': 0.4004970229475141, 'macro avg': {'precision': 0.420720966030919, 'recall': 0.4051162109170184, 'f1-score': 0.36468225969030943, 'support': 452293}, 'weighted avg': {'precision': 0.4213839762602222, 'recall': 0.4004970229475141, 'f1-score': 0.3621580846761163, 'support': 452293}}
[[99919  9695 37628]
 [88247 18055 48348]
 [75733 11500 63168]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128           256
 Used       :        80 (peak)  20.87 (ave)

============================================
