This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W3/deepLOB_L1/h300
Epoch 1/50
10532/10532 - 183s - loss: 3.2478 - accuracy300: 0.3958 - val_loss: 3.3624 - val_accuracy300: 0.3322 - 183s/epoch - 17ms/step
Epoch 2/50
10532/10532 - 166s - loss: 3.2266 - accuracy300: 0.4079 - val_loss: 3.4191 - val_accuracy300: 0.3406 - 166s/epoch - 16ms/step
Epoch 3/50
10532/10532 - 163s - loss: 3.2132 - accuracy300: 0.4163 - val_loss: 3.5773 - val_accuracy300: 0.3360 - 163s/epoch - 15ms/step
Epoch 4/50
10532/10532 - 164s - loss: 3.2055 - accuracy300: 0.4193 - val_loss: 3.7224 - val_accuracy300: 0.3358 - 164s/epoch - 16ms/step
Epoch 5/50
10532/10532 - 165s - loss: 3.2003 - accuracy300: 0.4215 - val_loss: 3.7649 - val_accuracy300: 0.3387 - 165s/epoch - 16ms/step
Epoch 6/50
10532/10532 - 163s - loss: 3.1953 - accuracy300: 0.4235 - val_loss: 3.7939 - val_accuracy300: 0.3373 - 163s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 162s - loss: 3.1921 - accuracy300: 0.4246 - val_loss: 3.7578 - val_accuracy300: 0.3390 - 162s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 163s - loss: 3.1895 - accuracy300: 0.4259 - val_loss: 3.7429 - val_accuracy300: 0.3358 - 163s/epoch - 15ms/step
Epoch 9/50
10532/10532 - 165s - loss: 3.1868 - accuracy300: 0.4266 - val_loss: 3.6318 - val_accuracy300: 0.3358 - 165s/epoch - 16ms/step
Epoch 10/50
10532/10532 - 166s - loss: 3.1844 - accuracy300: 0.4279 - val_loss: 3.6621 - val_accuracy300: 0.3395 - 166s/epoch - 16ms/step
Epoch 11/50
10532/10532 - 167s - loss: 3.1816 - accuracy300: 0.4290 - val_loss: 3.7169 - val_accuracy300: 0.3384 - 167s/epoch - 16ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 175s - 175s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1218287
{'0': {'precision': 0.340632603406326, 'recall': 0.10816977548747175, 'f1-score': 0.16419766902748245, 'support': 2373676}, '1': {'precision': 0.333688427078596, 'recall': 0.2696901835241894, 'f1-score': 0.29829527118576715, 'support': 2407748}, '2': {'precision': 0.3248233653343327, 'recall': 0.6181701678876798, 'f1-score': 0.4258695467327057, 'support': 2305053}, 'accuracy': 0.32893933050230745, 'macro avg': {'precision': 0.3330481319397516, 'recall': 0.3320100422997803, 'f1-score': 0.2961208289819851, 'support': 7086477}, 'weighted avg': {'precision': 0.3331308563026098, 'recall': 0.32893933050230745, 'f1-score': 0.2948748419190989, 'support': 7086477}}
[[ 256760  655844 1461072]
 [ 257651  649346 1500751]
 [ 239363  640775 1424915]]
Evaluating performance on  train set...
10532/10532 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1238651
{'0': {'precision': 0.33612858926166767, 'recall': 0.26408651926119275, 'f1-score': 0.29578405442257566, 'support': 906434}, '1': {'precision': 0.32324215308631266, 'recall': 0.2700043700652793, 'f1-score': 0.2942344894293215, 'support': 883282}, '2': {'precision': 0.34310422741870367, 'recall': 0.47175562746387784, 'f1-score': 0.39727408123386626, 'support': 906092}, 'accuracy': 0.33582547421774844, 'macro avg': {'precision': 0.33415832325556133, 'recall': 0.33528217226345, 'f1-score': 0.32909754169525446, 'support': 2695808}, 'weighted avg': {'precision': 0.33425093803841477, 'recall': 0.33582547421774844, 'f1-score': 0.3293883016490563, 'support': 2695808}}
[[239377 247905 419152]
 [245555 238490 399237]
 [227227 251411 427454]]
Evaluating performance on  val set...
3814/3814 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1211112
{'0': {'precision': 0.33463676674976284, 'recall': 0.1888451423146952, 'f1-score': 0.24143920447423556, 'support': 321295}, '1': {'precision': 0.33280676219261673, 'recall': 0.3136565701438687, 'f1-score': 0.3229480229690388, 'support': 333151}, '2': {'precision': 0.3306689585423005, 'recall': 0.4944133122166596, 'f1-score': 0.3962929294062926, 'support': 321389}, 'accuracy': 0.33209405278556314, 'macro avg': {'precision': 0.3327041624948934, 'recall': 0.33230500822507447, 'f1-score': 0.3202267189498557, 'support': 975835}, 'weighted avg': {'precision': 0.3327052129930254, 'recall': 0.33209405278556314, 'f1-score': 0.32026710897914784, 'support': 975835}}
[[ 60675 105282 155338]
 [ 62355 104495 166301]
 [ 58286 104204 158899]]
testing model out of sample: results/universal/W3/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 98s - 98s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1305475
{'0': {'precision': 0.3454777675948072, 'recall': 0.4074854169489291, 'f1-score': 0.3739283807355341, 'support': 1365455}, '1': {'precision': 0.3617662269258175, 'recall': 0.23271916473799695, 'f1-score': 0.28323634303264056, 'support': 1463876}, '2': {'precision': 0.298147376660102, 'recall': 0.361353711790393, 'f1-score': 0.3267217085867885, 'support': 1307132}, 'accuracy': 0.33105868467819005, 'macro avg': {'precision': 0.33513045706024225, 'recall': 0.33385276449243967, 'f1-score': 0.32796214411832103, 'support': 4136463}, 'weighted avg': {'precision': 0.33628566703168816, 'recall': 0.33105868467819005, 'f1-score': 0.32691544984179827, 'support': 4136463}}
[[556403 305826 503226]
 [514527 340672 608677]
 [539602 295193 472337]]
Evaluating performance on  train set...
6181/6181 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1271981
{'0': {'precision': 0.3196285522178039, 'recall': 0.26269384003615687, 'f1-score': 0.28837789129934005, 'support': 526594}, '1': {'precision': 0.3258965893472008, 'recall': 0.2645607429333906, 'f1-score': 0.2920429270109603, 'support': 521608}, '2': {'precision': 0.34071663662074325, 'recall': 0.4632982561353861, 'f1-score': 0.39266293449264217, 'support': 533585}, 'accuracy': 0.3309794555145541, 'macro avg': {'precision': 0.32874725939524935, 'recall': 0.3301842797016445, 'f1-score': 0.32436125093431417, 'support': 1581787}, 'weighted avg': {'precision': 0.32880914595585636, 'recall': 0.3309794555145541, 'f1-score': 0.3247649944426614, 'support': 1581787}}
[[138333 140749 247512]
 [152776 137997 230835]
 [141684 144692 247209]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1213362
{'0': {'precision': 0.33174828242630294, 'recall': 0.22253635107227124, 'f1-score': 0.2663831821555726, 'support': 190297}, '1': {'precision': 0.3330024653262916, 'recall': 0.32211420550311265, 'f1-score': 0.3274678521410686, 'support': 191637}, '2': {'precision': 0.32770635349458094, 'recall': 0.45125060177688303, 'f1-score': 0.37968128590366773, 'support': 182792}, 'accuracy': 0.3303584393139328, 'macro avg': {'precision': 0.33081903374905847, 'recall': 0.33196705278408895, 'f1-score': 0.324510773400103, 'support': 564726}, 'weighted avg': {'precision': 0.330865581036811, 'recall': 0.3303584393139328, 'f1-score': 0.32378459431356127, 'support': 564726}}
[[42348 63069 84880]
 [45569 61729 84339]
 [39734 60573 82485]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1259232
{'0': {'precision': 0.2984585598331968, 'recall': 0.07624410287627453, 'f1-score': 0.12146006636665302, 'support': 52568}, '1': {'precision': 0.4492279349380651, 'recall': 0.25174559187111145, 'f1-score': 0.3226688256853578, 'support': 73614}, '2': {'precision': 0.2709123073035128, 'recall': 0.6812116077102309, 'f1-score': 0.38765670202507235, 'support': 47210}, 'accuracy': 0.315470148565101, 'macro avg': {'precision': 0.3395329340249249, 'recall': 0.336400434152539, 'f1-score': 0.2772618646923611, 'support': 173392}, 'weighted avg': {'precision': 0.35496796163399147, 'recall': 0.315470148565101, 'f1-score': 0.27936195790675356, 'support': 173392}}
[[ 4008 11401 37159]
 [ 5691 18532 49391]
 [ 3730 11320 32160]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1244777
{'0': {'precision': 0.31542095975408435, 'recall': 0.2530483627894232, 'f1-score': 0.2808128927630245, 'support': 21897}, '1': {'precision': 0.328790777990386, 'recall': 0.3200672391077189, 'f1-score': 0.3243703669598048, 'support': 22011}, '2': {'precision': 0.343186391073715, 'recall': 0.4184023906159404, 'f1-score': 0.3770801511375513, 'support': 22421}, 'accuracy': 0.3311824390538075, 'macro avg': {'precision': 0.3291327096060617, 'recall': 0.3305059975043609, 'f1-score': 0.32742113695346015, 'support': 66329}, 'weighted avg': {'precision': 0.32924314620068645, 'recall': 0.3311824390538075, 'f1-score': 0.3278082004649437, 'support': 66329}}
[[5541 7178 9178]
 [6190 7045 8776]
 [5836 7204 9381]]
Evaluating performance on  val set...
86/86 - 1s - 622ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1304111
{'0': {'precision': 0.28937849391647485, 'recall': 0.24017467248908297, 'f1-score': 0.2624906785980612, 'support': 7328}, '1': {'precision': 0.37382132012146396, 'recall': 0.2893727576394903, 'f1-score': 0.3262203626220363, 'support': 8083}, '2': {'precision': 0.2943199583116206, 'recall': 0.43292963360416986, 'f1-score': 0.3504156843280804, 'support': 6523}, 'accuracy': 0.3156287042947023, 'macro avg': {'precision': 0.31917325744985314, 'recall': 0.32082568791091437, 'f1-score': 0.3130422418493926, 'support': 21934}, 'weighted avg': {'precision': 0.3219664640297448, 'recall': 0.3156287042947023, 'f1-score': 0.3121242086583651, 'support': 21934}}
[[1760 2024 3544]
 [2517 2339 3227]
 [1805 1894 2824]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1224893
{'0': {'precision': 0.3311929034820601, 'recall': 0.08245434768277408, 'f1-score': 0.13203663139003985, 'support': 121352}, '1': {'precision': 0.37316551561764244, 'recall': 0.28158264860463394, 'f1-score': 0.3209690076194173, 'support': 135090}, '2': {'precision': 0.3040506062203479, 'recall': 0.6389910574221623, 'f1-score': 0.41204037078947064, 'support': 112831}, 'accuracy': 0.3253500797512951, 'macro avg': {'precision': 0.3361363417733501, 'recall': 0.3343426845698568, 'f1-score': 0.288348669932976, 'support': 369273}, 'weighted avg': {'precision': 0.338254312334209, 'recall': 0.3253500797512951, 'f1-score': 0.2867080442065842, 'support': 369273}}
[[10006 32486 78860]
 [10884 38039 86167]
 [ 9322 31411 72098]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1245227
{'0': {'precision': 0.3578119869430012, 'recall': 0.3248062559175229, 'f1-score': 0.3405111803468527, 'support': 57034}, '1': {'precision': 0.30973871733966746, 'recall': 0.264370257380626, 'f1-score': 0.285261885911913, 'support': 51791}, '2': {'precision': 0.3489287340117773, 'recall': 0.43006334841628957, 'f1-score': 0.38527082134141893, 'support': 55250}, 'accuracy': 0.3411732439433186, 'macro avg': {'precision': 0.338826479431482, 'recall': 0.3397466205714794, 'f1-score': 0.33701462920006153, 'support': 164075}, 'weighted avg': {'precision': 0.33964613333656285, 'recall': 0.3411732439433186, 'f1-score': 0.3381436896070679, 'support': 164075}}
[[18525 15324 23185]
 [16948 13692 21151]
 [16300 15189 23761]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1289544
{'0': {'precision': 0.31023450144916626, 'recall': 0.36152294060882534, 'f1-score': 0.33392079408487796, 'support': 22798}, '1': {'precision': 0.33751226911751586, 'recall': 0.3305369860619566, 'f1-score': 0.3339882121807466, 'support': 22887}, '2': {'precision': 0.36322785109502864, 'recall': 0.3142366084216557, 'f1-score': 0.3369608144280135, 'support': 24437}, 'accuracy': 0.3349305496135307, 'macro avg': {'precision': 0.3369915405539036, 'recall': 0.33543217836414585, 'f1-score': 0.33495660689787937, 'support': 70122}, 'weighted avg': {'precision': 0.3376054371600909, 'recall': 0.3349305496135307, 'f1-score': 0.3350022232381444, 'support': 70122}}
[[8242 7100 7456]
 [9316 7565 6006]
 [9009 7749 7679]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
1359/1359 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1249549
{'0': {'precision': 0.33826112028518257, 'recall': 0.25303425423030923, 'f1-score': 0.2895055635319454, 'support': 102002}, '1': {'precision': 0.42173481540293767, 'recall': 0.1442900605764268, 'f1-score': 0.21501578691709844, 'support': 147252}, '2': {'precision': 0.27296614040403583, 'recall': 0.612479324586238, 'f1-score': 0.37763165303785823, 'support': 98547}, 'accuracy': 0.3088404001138582, 'macro avg': {'precision': 0.3443206920307187, 'recall': 0.3366012131309913, 'f1-score': 0.2940510011623007, 'support': 347801}, 'weighted avg': {'precision': 0.35510133687780965, 'recall': 0.3088404001138582, 'f1-score': 0.28293799517087037, 'support': 347801}}
[[25810 15203 60989]
 [26233 21247 99772]
 [24259 13930 60358]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1314944
{'0': {'precision': 0.3261544201190456, 'recall': 0.5156023805694064, 'f1-score': 0.39955957661185615, 'support': 37302}, '1': {'precision': 0.29251062974990794, 'recall': 0.23513738999381004, 'f1-score': 0.26070480112195266, 'support': 37157}, '2': {'precision': 0.3481071471859723, 'recall': 0.22018911321236903, 'f1-score': 0.2697515693242122, 'support': 39130}, 'accuracy': 0.3220910475486183, 'macro avg': {'precision': 0.32225739901830863, 'recall': 0.3236429612585285, 'f1-score': 0.31000531568600703, 'support': 113589}, 'weighted avg': {'precision': 0.32271137450180093, 'recall': 0.3220910475486183, 'f1-score': 0.3094204415015563, 'support': 113589}}
[[19233 10117  7952]
 [20237  8737  8183]
 [19499 11015  8616]]
Evaluating performance on  val set...
144/144 - 1s - 891ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1210462
{'0': {'precision': 0.34749098064939327, 'recall': 0.33026807980049877, 'f1-score': 0.33866070001598214, 'support': 12832}, '1': {'precision': 0.3104267655165859, 'recall': 0.2866169372531812, 'f1-score': 0.29804708888483306, 'support': 11395}, '2': {'precision': 0.37070017953321366, 'recall': 0.4157873540072493, 'f1-score': 0.3919514047076689, 'support': 12415}, 'accuracy': 0.3456689045357786, 'macro avg': {'precision': 0.34287264189973093, 'recall': 0.34422412368697647, 'f1-score': 0.3428863978694947, 'support': 36642}, 'weighted avg': {'precision': 0.3438283932552633, 'recall': 0.3456689045357786, 'f1-score': 0.3440864955486454, 'support': 36642}}
[[4238 3765 4829]
 [4195 3266 3934]
 [3763 3490 5162]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1208681
{'0': {'precision': 0.3259437717783545, 'recall': 0.35777681935806055, 'f1-score': 0.34111924510742825, 'support': 88108}, '1': {'precision': 0.3947325900791727, 'recall': 0.22072442424625727, 'f1-score': 0.28312984220987303, 'support': 110681}, '2': {'precision': 0.321724485346085, 'recall': 0.46101965178417514, 'f1-score': 0.3789777608516593, 'support': 92816}, 'accuracy': 0.3386190223075736, 'macro avg': {'precision': 0.34746694906787073, 'recall': 0.34650696512949763, 'f1-score': 0.33440894938965354, 'support': 291605}, 'weighted avg': {'precision': 0.35071014378451126, 'recall': 0.3386190223075736, 'f1-score': 0.33115902801654246, 'support': 291605}}
[[31523 17880 38705]
 [34744 24430 51507]
 [30446 19580 42790]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1274393
{'0': {'precision': 0.3401709401709402, 'recall': 0.48963523405302334, 'f1-score': 0.4014423683082432, 'support': 32514}, '1': {'precision': 0.34533913941988337, 'recall': 0.2873549100288645, 'f1-score': 0.3136899973183159, 'support': 32566}, '2': {'precision': 0.3597324742057828, 'recall': 0.2645850205465071, 'f1-score': 0.3049083995852057, 'support': 33339}, 'accuracy': 0.34646765360347087, 'macro avg': {'precision': 0.3484141845988688, 'recall': 0.34719172154279826, 'f1-score': 0.34001358840392165, 'support': 98419}, 'weighted avg': {'precision': 0.34850743576557847, 'recall': 0.34646765360347087, 'f1-score': 0.33970541002869026, 'support': 98419}}
[[15920  8818  7776]
 [15284  9358  7924]
 [15596  8922  8821]]
Evaluating performance on  val set...
139/139 - 1s - 940ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1200954
{'0': {'precision': 0.2893904419936736, 'recall': 0.3033154121863799, 'f1-score': 0.2961893511834449, 'support': 11160}, '1': {'precision': 0.3855022109917877, 'recall': 0.35666277030976035, 'f1-score': 0.370522161505768, 'support': 13688}, '2': {'precision': 0.30172570390554043, 'recall': 0.3156894421742849, 'f1-score': 0.3085496679515162, 'support': 10523}, 'accuracy': 0.3276412880608408, 'macro avg': {'precision': 0.3255394522970006, 'recall': 0.3252225415568084, 'f1-score': 0.3250870602135764, 'support': 35371}, 'weighted avg': {'precision': 0.3302539136270671, 'recall': 0.3276412880608408, 'f1-score': 0.32863217499510905, 'support': 35371}}
[[3385 3916 3859]
 [4977 4882 3829]
 [3335 3866 3322]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1377791
{'0': {'precision': 0.3385673080722273, 'recall': 0.22044084051945914, 'f1-score': 0.2670231629069401, 'support': 194356}, '1': {'precision': 0.36953651872243315, 'recall': 0.17842407712110206, 'f1-score': 0.24065311562812397, 'support': 202383}, '2': {'precision': 0.3145249393300031, 'recall': 0.6042262998248388, 'f1-score': 0.41370118960344726, 'support': 187256}, 'accuracy': 0.32893946009811725, 'macro avg': {'precision': 0.34087625537488786, 'recall': 0.3343637391551333, 'f1-score': 0.3071258227128371, 'support': 583995}, 'weighted avg': {'precision': 0.34159055991141546, 'recall': 0.32893946009811725, 'f1-score': 0.30491645187114785, 'support': 583995}}
[[ 42844  32055 119457]
 [ 39142  36110 127131]
 [ 44559  29552 113145]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311207
{'0': {'precision': 0.32495067736419836, 'recall': 0.3324318142063268, 'f1-score': 0.32864867741055814, 'support': 74319}, '1': {'precision': 0.32770422747103956, 'recall': 0.23484858694626756, 'f1-score': 0.2736129756549455, 'support': 74201}, '2': {'precision': 0.3405800893894512, 'recall': 0.4268790260157695, 'f1-score': 0.3788775034932464, 'support': 76223}, 'accuracy': 0.3322461656202863, 'macro avg': {'precision': 0.33107833140822973, 'recall': 0.33138647572278795, 'f1-score': 0.3270463855195833, 'support': 224743}, 'weighted avg': {'precision': 0.3311606008958704, 'recall': 0.3322461656202863, 'f1-score': 0.3275135484166964, 'support': 224743}}
[[24706 17805 31808]
 [25584 17426 31191]
 [25740 17945 32538]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1278819
{'0': {'precision': 0.3243089284643521, 'recall': 0.42011029982911297, 'f1-score': 0.36604514229636903, 'support': 25748}, '1': {'precision': 0.33231719232422713, 'recall': 0.32828848307015174, 'f1-score': 0.3302905531385954, 'support': 25901}, '2': {'precision': 0.3337675024422012, 'recall': 0.23913212535967027, 'f1-score': 0.2786335628851033, 'support': 25718}, 'accuracy': 0.3292101283492962, 'macro avg': {'precision': 0.3301312077435935, 'recall': 0.32917696941964497, 'f1-score': 0.3249897527733559, 'support': 77367}, 'weighted avg': {'precision': 0.33013412070131287, 'recall': 0.3292101283492962, 'f1-score': 0.325018210748365, 'support': 77367}}
[[10817  8585  6346]
 [11468  8503  5930]
 [11069  8499  6150]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
5098/5098 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1214951
{'0': {'precision': 0.364601996416688, 'recall': 0.1466943567211314, 'f1-score': 0.20921352165079676, 'support': 466112}, '1': {'precision': 0.29439584448402634, 'recall': 0.3329719322881648, 'f1-score': 0.3124978898335966, 'support': 403061}, '2': {'precision': 0.33420912200925473, 'recall': 0.5073668121669443, 'f1-score': 0.4029740156411058, 'support': 435738}, 'accuracy': 0.32466811912843097, 'macro avg': {'precision': 0.3310689876366564, 'recall': 0.3290110337254135, 'f1-score': 0.3082284757084997, 'support': 1304911}, 'weighted avg': {'precision': 0.3327678773751007, 'recall': 0.32466811912843097, 'f1-score': 0.3058168232203879, 'support': 1304911}}
[[ 68376 164977 232759]
 [ 61192 134208 207661]
 [ 57968 156691 221079]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1222384
{'0': {'precision': 0.3381309207408163, 'recall': 0.3472667225316705, 'f1-score': 0.34263793517479946, 'support': 162296}, '1': {'precision': 0.32798746943765283, 'recall': 0.27255238095238093, 'f1-score': 0.29771135307580276, 'support': 157500}, '2': {'precision': 0.3506071854844891, 'recall': 0.3992057901266123, 'f1-score': 0.3733315454866101, 'support': 160411}, 'accuracy': 0.34011166017988076, 'macro avg': {'precision': 0.3389085252209861, 'recall': 0.3396749645368879, 'f1-score': 0.3378936112457374, 'support': 480207}, 'weighted avg': {'precision': 0.338971675922538, 'recall': 0.34011166017988076, 'f1-score': 0.33815581817762097, 'support': 480207}}
[[56360 42866 63070]
 [59034 42927 55539]
 [51287 45087 64037]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.120206
{'0': {'precision': 0.33094909379314397, 'recall': 0.44210960032962504, 'f1-score': 0.3785372901144868, 'support': 50967}, '1': {'precision': 0.3581032699498767, 'recall': 0.32506409561983174, 'f1-score': 0.34078476651965706, 'support': 55386}, '2': {'precision': 0.35633591602099474, 'recall': 0.2740729348891751, 'f1-score': 0.309837116561084, 'support': 52019}, 'accuracy': 0.34598287576086684, 'macro avg': {'precision': 0.3484627599213384, 'recall': 0.34708221027954395, 'f1-score': 0.3430530577317426, 'support': 158372}, 'weighted avg': {'precision': 0.3487840539255371, 'recall': 0.34598287576086684, 'f1-score': 0.34276912655086633, 'support': 158372}}
[[22533 15396 13038]
 [24667 18004 12715]
 [20886 16876 14257]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
5760/5760 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1172705
{'0': {'precision': 0.32164655784244145, 'recall': 0.0911873158685076, 'f1-score': 0.14209147134342348, 'support': 472149}, '1': {'precision': 0.38748343991756756, 'recall': 0.3364864121123675, 'f1-score': 0.36018878986532515, 'support': 563259}, '2': {'precision': 0.29733478334398133, 'recall': 0.5766302330189518, 'f1-score': 0.3923548933750003, 'support': 439063}, 'accuracy': 0.32944696775996274, 'macro avg': {'precision': 0.3354882603679967, 'recall': 0.3347679869999423, 'f1-score': 0.298211718194583, 'support': 1474471}, 'weighted avg': {'precision': 0.33955726325077845, 'recall': 0.32944696775996274, 'f1-score': 0.2999288831343492, 'support': 1474471}}
[[ 43054 153543 275552]
 [ 50971 189529 322759]
 [ 39830 146056 253177]]
Evaluating performance on  train set...
2159/2159 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1253095
{'0': {'precision': 0.3384978889878762, 'recall': 0.23623005060334762, 'f1-score': 0.2782651335921007, 'support': 184968}, '1': {'precision': 0.32880491042613047, 'recall': 0.29650760529350395, 'f1-score': 0.3118221821835695, 'support': 182110}, '2': {'precision': 0.3343684421676336, 'recall': 0.46737049837971323, 'f1-score': 0.3898374833874156, 'support': 185461}, 'accuracy': 0.3336796135657393, 'macro avg': {'precision': 0.33389041386054674, 'recall': 0.33336938475885497, 'f1-score': 0.3266415997210286, 'support': 552539}, 'weighted avg': {'precision': 0.3339171450718657, 'recall': 0.3336796135657393, 'f1-score': 0.3267746391371958, 'support': 552539}}
[[43695 54653 86620]
 [42180 53997 85933]
 [43210 55572 86679]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1210911
{'0': {'precision': 0.35183109955623293, 'recall': 0.1093327761526675, 'f1-score': 0.16682430206484658, 'support': 71790}, '1': {'precision': 0.3270089107168568, 'recall': 0.27089959711620015, 'f1-score': 0.2963215308230348, 'support': 75456}, '2': {'precision': 0.31963298044926697, 'recall': 0.604288220944664, 'f1-score': 0.41811021290456307, 'support': 70099}, 'accuracy': 0.3250592376176126, 'macro avg': {'precision': 0.33282433024078556, 'recall': 0.3281735314045105, 'f1-score': 0.2937520152641481, 'support': 217345}, 'weighted avg': {'precision': 0.3328288725330984, 'recall': 0.3250592376176126, 'f1-score': 0.2928278170163345, 'support': 217345}}
[[ 7849 21167 42774]
 [ 7622 20441 47393]
 [ 6838 20901 42360]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1211092
{'0': {'precision': 0.3558531379151501, 'recall': 0.09723995120982612, 'f1-score': 0.15274186518959756, 'support': 564048}, '1': {'precision': 0.3223644351450583, 'recall': 0.3731749988981487, 'f1-score': 0.34591380974838154, 'support': 521849}, '2': {'precision': 0.33117690446033543, 'recall': 0.5357113911166819, 'f1-score': 0.4093151126837439, 'support': 530545}, 'accuracy': 0.3302364081111478, 'macro avg': {'precision': 0.3364648258401813, 'recall': 0.33537544707488554, 'f1-score': 0.302656929207241, 'support': 1616442}, 'weighted avg': {'precision': 0.33694253157718423, 'recall': 0.3302364081111478, 'f1-score': 0.29931702203892385, 'support': 1616442}}
[[ 54848 211525 297675]
 [ 50793 194741 276315]
 [ 48490 197836 284219]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1255081
{'0': {'precision': 0.3423590769450597, 'recall': 0.3406740639064645, 'f1-score': 0.34151449199883777, 'support': 182861}, '1': {'precision': 0.3339952217458032, 'recall': 0.23286046793818185, 'f1-score': 0.27440593801996677, 'support': 181306}, '2': {'precision': 0.3501237796803935, 'recall': 0.45439068387289594, 'f1-score': 0.39550061781729334, 'support': 187374}, 'accuracy': 0.3438656419015087, 'macro avg': {'precision': 0.3421593594570855, 'recall': 0.34264173857251407, 'f1-score': 0.3371403492786993, 'support': 551541}, 'weighted avg': {'precision': 0.342247546305586, 'recall': 0.3438656419015087, 'f1-score': 0.33779475557201566, 'support': 551541}}
[[62296 41272 79293]
 [60347 42219 78740]
 [59318 42915 85141]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1224706
{'0': {'precision': 0.35022435219771186, 'recall': 0.2294491558031798, 'f1-score': 0.27725497489306306, 'support': 64973}, '1': {'precision': 0.33058340031240047, 'recall': 0.3538281744550309, 'f1-score': 0.3418110544884359, 'support': 61609}, '2': {'precision': 0.34607154147314156, 'recall': 0.4435423549211494, 'f1-score': 0.38879099564261227, 'support': 64172}, 'accuracy': 0.3416442119169192, 'macro avg': {'precision': 0.3422930979944179, 'recall': 0.34227322839312, 'f1-score': 0.3359523416747037, 'support': 190754}, 'weighted avg': {'precision': 0.3424837356207632, 'recall': 0.3416442119169192, 'f1-score': 0.3356271454967275, 'support': 190754}}
[[14908 22372 27693]
 [13720 21799 26090]
 [13939 21770 28463]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
6082/6082 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1421462
{'0': {'precision': 0.34949056882119384, 'recall': 0.8094419339432014, 'f1-score': 0.4881946467922078, 'support': 544380}, '1': {'precision': 0.2871630718817912, 'recall': 0.1586113857652796, 'f1-score': 0.2043514696297216, 'support': 477368}, '2': {'precision': 0.4095677197759693, 'recall': 0.024737597559881582, 'f1-score': 0.04665713736818636, 'support': 535056}, 'accuracy': 0.34018155143486273, 'macro avg': {'precision': 0.34874045349298477, 'recall': 0.33093030575612087, 'f1-score': 0.24640108459670526, 'support': 1556804}, 'weighted avg': {'precision': 0.35102672078527514, 'recall': 0.34018155143486273, 'f1-score': 0.2494073984050756, 'support': 1556804}}
[[440644  93532  10204]
 [392775  75716   8877]
 [427399  94421  13236]]
Evaluating performance on  train set...
2440/2440 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266872
{'0': {'precision': 0.3000337227985955, 'recall': 0.21803582755107925, 'f1-score': 0.25254563214328446, 'support': 208108}, '1': {'precision': 0.3301545139451265, 'recall': 0.24722867718758643, 'f1-score': 0.2827365430920651, 'support': 206129}, '2': {'precision': 0.34528007924789733, 'recall': 0.5236225338721179, 'f1-score': 0.41614889231867824, 'support': 210350}, 'accuracy': 0.33058645152716915, 'macro avg': {'precision': 0.3251561053305398, 'recall': 0.3296290128702612, 'f1-score': 0.31714368918467595, 'support': 624587}, 'weighted avg': {'precision': 0.3252125043572157, 'recall': 0.33058645152716915, 'f1-score': 0.3176080943156564, 'support': 624587}}
[[ 45375  50921 111812]
 [ 58125  50961  97043]
 [ 47733  52473 110144]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1194757
{'0': {'precision': 0.32518022657054585, 'recall': 0.24355707378889516, 'f1-score': 0.27851151801535734, 'support': 72599}, '1': {'precision': 0.3363129469420413, 'recall': 0.37994689415553234, 'f1-score': 0.35680084886265667, 'support': 70802}, '2': {'precision': 0.33247268858499623, 'recall': 0.3766333024677749, 'f1-score': 0.35317791208109656, 'support': 68037}, 'accuracy': 0.33205005722717773, 'macro avg': {'precision': 0.3313219540325278, 'recall': 0.3333790901374008, 'f1-score': 0.3294967596530369, 'support': 211438}, 'weighted avg': {'precision': 0.33125470753338027, 'recall': 0.33205005722717773, 'f1-score': 0.3287537576113674, 'support': 211438}}
[[17682 27230 27687]
 [20139 26901 23762]
 [16555 25857 25625]]
testing model on single stock: results/universal/W3/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
13689/13689 - 85s - 85s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.122344
{'0': {'precision': 0.3227827616534741, 'recall': 0.08090517575851633, 'f1-score': 0.12938110675693398, 'support': 1134056}, '1': {'precision': 0.35630046800275017, 'recall': 0.20819810083043197, 'f1-score': 0.2628211473290318, 'support': 1237067}, '2': {'precision': 0.32233153407282017, 'recall': 0.7103430077758549, 'f1-score': 0.4434426184350432, 'support': 1133123}, 'accuracy': 0.329375277877181, 'macro avg': {'precision': 0.3338049212430148, 'recall': 0.3331487614549344, 'f1-score': 0.27854829084033633, 'support': 3504246}, 'weighted avg': {'precision': 0.33446925629183755, 'recall': 0.329375277877181, 'f1-score': 0.27804207204522635, 'support': 3504246}}
[[ 91751 229363 812942]
 [100223 257555 879289]
 [ 92276 235941 804906]]
Evaluating performance on  train set...
5475/5475 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1234705
{'0': {'precision': 0.32455635004010075, 'recall': 0.18272355526160147, 'f1-score': 0.2338121007445986, 'support': 471729}, '1': {'precision': 0.31921145565540887, 'recall': 0.2830832893229795, 'f1-score': 0.30006381297499773, 'support': 460119}, '2': {'precision': 0.33753238582194733, 'recall': 0.523088321077753, 'f1-score': 0.41030676485814, 'support': 469718}, 'accuracy': 0.329739733983273, 'macro avg': {'precision': 0.3271000638391523, 'recall': 0.32963172188744466, 'f1-score': 0.3147275595259121, 'support': 1401566}, 'weighted avg': {'precision': 0.3271504413037212, 'recall': 0.329739733983273, 'f1-score': 0.3147118887087926, 'support': 1401566}}
[[ 86196 138922 246611]
 [ 94240 130252 235627]
 [ 85145 138869 245704]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1195372
{'0': {'precision': 0.3613563895020849, 'recall': 0.06876433076424908, 'f1-score': 0.11554165665913446, 'support': 171397}, '1': {'precision': 0.3206581645534543, 'recall': 0.2899638603192988, 'f1-score': 0.30453955294585516, 'support': 179581}, '2': {'precision': 0.32341535641260666, 'recall': 0.619726500546294, 'f1-score': 0.4250242221224018, 'support': 170238}, 'accuracy': 0.3249305470284872, 'macro avg': {'precision': 0.33514330348938187, 'recall': 0.326151563876614, 'f1-score': 0.28170181057579713, 'support': 521216}, 'weighted avg': {'precision': 0.3349419403570344, 'recall': 0.3249305470284872, 'f1-score': 0.281741704609315, 'support': 521216}}
[[ 11786  56702 102909]
 [  9710  52072 117799]
 [ 11120  53617 105501]]
training model: results/universal/W3/deepLOB_L1/h500
Epoch 1/50
10532/10532 - 169s - loss: 3.2246 - accuracy500: 0.4115 - val_loss: 3.3868 - val_accuracy500: 0.3115 - 169s/epoch - 16ms/step
Epoch 2/50
10532/10532 - 159s - loss: 3.1926 - accuracy500: 0.4278 - val_loss: 3.3725 - val_accuracy500: 0.3098 - 159s/epoch - 15ms/step
Epoch 3/50
10532/10532 - 165s - loss: 3.1809 - accuracy500: 0.4328 - val_loss: 3.4147 - val_accuracy500: 0.3190 - 165s/epoch - 16ms/step
Epoch 4/50
10532/10532 - 165s - loss: 3.1713 - accuracy500: 0.4365 - val_loss: 3.5801 - val_accuracy500: 0.3325 - 165s/epoch - 16ms/step
Epoch 5/50
10532/10532 - 159s - loss: 3.1631 - accuracy500: 0.4397 - val_loss: 3.5710 - val_accuracy500: 0.3303 - 159s/epoch - 15ms/step
Epoch 6/50
10532/10532 - 162s - loss: 3.1559 - accuracy500: 0.4422 - val_loss: 3.5828 - val_accuracy500: 0.3331 - 162s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 161s - loss: 3.1504 - accuracy500: 0.4447 - val_loss: 3.7404 - val_accuracy500: 0.3368 - 161s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 163s - loss: 3.1473 - accuracy500: 0.4457 - val_loss: 3.6718 - val_accuracy500: 0.3398 - 163s/epoch - 15ms/step
Epoch 9/50
10532/10532 - 167s - loss: 3.1418 - accuracy500: 0.4472 - val_loss: 3.7621 - val_accuracy500: 0.3388 - 167s/epoch - 16ms/step
Epoch 10/50
10532/10532 - 167s - loss: 3.1397 - accuracy500: 0.4480 - val_loss: 3.8478 - val_accuracy500: 0.3295 - 167s/epoch - 16ms/step
Epoch 11/50
10532/10532 - 159s - loss: 3.1356 - accuracy500: 0.4496 - val_loss: 3.9103 - val_accuracy500: 0.3376 - 159s/epoch - 15ms/step
Epoch 12/50
10532/10532 - 165s - loss: 3.1320 - accuracy500: 0.4510 - val_loss: 3.9983 - val_accuracy500: 0.3326 - 165s/epoch - 16ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 145s - 145s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.116476
{'0': {'precision': 0.3616682829494952, 'recall': 0.06344439716665042, 'f1-score': 0.10795173731237193, 'support': 2451233}, '1': {'precision': 0.3220068939957977, 'recall': 0.8074729857206961, 'f1-score': 0.46040991572634127, 'support': 2288697}, '2': {'precision': 0.3256297688494583, 'recall': 0.1272908661109281, 'f1-score': 0.18303292943133034, 'support': 2346547}, 'accuracy': 0.3248824486412642, 'macro avg': {'precision': 0.3364349819315837, 'recall': 0.33273608299942486, 'f1-score': 0.25046486082334785, 'support': 7086477}, 'weighted avg': {'precision': 0.33692552726707925, 'recall': 0.3248824486412642, 'f1-score': 0.24664569224719807, 'support': 7086477}}
[[ 155517 1975255  320461]
 [ 142510 1848061  298126]
 [ 131972 1915881  298694]]
Evaluating performance on  train set...
10532/10532 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172659
{'0': {'precision': 0.33039066158774044, 'recall': 0.14577189246886474, 'f1-score': 0.20229088399907996, 'support': 905003}, '1': {'precision': 0.3236725921186747, 'recall': 0.6484669701075785, 'f1-score': 0.43181245424762094, 'support': 887817}, '2': {'precision': 0.3390227887215141, 'recall': 0.1944056842394362, 'f1-score': 0.24711075825527803, 'support': 902988}, 'accuracy': 0.327616061677983, 'macro avg': {'precision': 0.33102868080930975, 'recall': 0.32954818227195976, 'f1-score': 0.29373803216732636, 'support': 2695808}, 'weighted avg': {'precision': 0.33106960123568807, 'recall': 0.327616061677983, 'f1-score': 0.29289264812627475, 'support': 2695808}}
[[131924 603042 170037]
 [139880 575720 172217]
 [127493 599949 175546]]
Evaluating performance on  val set...
3814/3814 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246947
{'0': {'precision': 0.3243727731316528, 'recall': 0.13246174974136835, 'f1-score': 0.18810743473264813, 'support': 330586}, '1': {'precision': 0.2967891108978274, 'recall': 0.517226959970602, 'f1-score': 0.37716043964167073, 'support': 315668}, '2': {'precision': 0.32799234971173824, 'recall': 0.28930672581247097, 'f1-score': 0.30743733969165987, 'support': 329581}, 'accuracy': 0.3099007516639596, 'macro avg': {'precision': 0.31638474458040616, 'recall': 0.3129984785081471, 'f1-score': 0.29090173802199293, 'support': 975835}, 'weighted avg': {'precision': 0.31667235674856953, 'recall': 0.3099007516639596, 'f1-score': 0.289566035172187, 'support': 975835}}
[[ 43790 194458  92338]
 [ 49376 163272 103020]
 [ 41833 192398  95350]]
testing model out of sample: results/universal/W3/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 82s - 82s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.121038
{'0': {'precision': 0.3570631960341727, 'recall': 0.18217086447717146, 'f1-score': 0.2412552019909305, 'support': 1469258}, '1': {'precision': 0.3112456006521224, 'recall': 0.7083231164427829, 'f1-score': 0.43246217765721373, 'support': 1276481}, '2': {'precision': 0.32065044834534523, 'recall': 0.11110471955614486, 'f1-score': 0.16502768600138737, 'support': 1390724}, 'accuracy': 0.32064423155725075, 'macro avg': {'precision': 0.3296530816772134, 'recall': 0.33386623349203304, 'f1-score': 0.2795816885498439, 'support': 4136463}, 'weighted avg': {'precision': 0.3306818716786371, 'recall': 0.32064423155725075, 'f1-score': 0.2746316967301392, 'support': 4136463}}
[[ 267656 1032918  168684]
 [ 213637  904161  158683]
 [ 268311  967897  154516]]
Evaluating performance on  train set...
6181/6181 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1164052
{'0': {'precision': 0.3273752378292517, 'recall': 0.10701243866255848, 'f1-score': 0.16129933906402522, 'support': 525780}, '1': {'precision': 0.3304145955829509, 'recall': 0.7564054737075703, 'f1-score': 0.4599241691496743, 'support': 522717}, '2': {'precision': 0.3401708520095272, 'recall': 0.13604792889422265, 'f1-score': 0.19436251463351253, 'support': 533290}, 'accuracy': 0.3313998661008088, 'macro avg': {'precision': 0.33265356180724326, 'recall': 0.3331552804214505, 'f1-score': 0.27186200761573737, 'support': 1581787}, 'weighted avg': {'precision': 0.3326935879314712, 'recall': 0.3313998661008088, 'f1-score': 0.2711298890731808, 'support': 1581787}}
[[ 56265 397756  71759]
 [ 58359 395386  68972]
 [ 57243 403494  72553]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218679
{'0': {'precision': 0.34764868318015085, 'recall': 0.08397630544078849, 'f1-score': 0.1352760047470892, 'support': 200890}, '1': {'precision': 0.3037992376675645, 'recall': 0.7923306600006944, 'f1-score': 0.4391987683228021, 'support': 172818}, '2': {'precision': 0.35017868597086044, 'recall': 0.12003580814373514, 'f1-score': 0.1787864138232175, 'support': 191018}, 'accuracy': 0.31294468467894165, 'macro avg': {'precision': 0.33387553560619193, 'recall': 0.33211425786173937, 'f1-score': 0.2510870622977029, 'support': 564726}, 'weighted avg': {'precision': 0.3350856040913213, 'recall': 0.31294468467894165, 'f1-score': 0.2430000965660092, 'support': 564726}}
[[ 16870 161450  22570]
 [ 15910 136929  19979]
 [ 15746 152343  22929]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0857403
{'0': {'precision': 0.35413126163308245, 'recall': 0.08604011010617381, 'f1-score': 0.13844377303573405, 'support': 50860}, '1': {'precision': 0.4582389434252802, 'recall': 0.8026817439116114, 'f1-score': 0.5834150203589202, 'support': 77114}, '2': {'precision': 0.23350156027275878, 'recall': 0.13344929323175833, 'f1-score': 0.1698353765323993, 'support': 45418}, 'accuracy': 0.4171761096244348, 'macro avg': {'precision': 0.34862392177704044, 'recall': 0.3407237157498479, 'f1-score': 0.29723138997568455, 'support': 173392}, 'weighted avg': {'precision': 0.3688343621068088, 'recall': 0.4171761096244348, 'f1-score': 0.3445620288589077, 'support': 173392}}
[[ 4376 37259  9225]
 [ 4545 61898 10671]
 [ 3436 35921  6061]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1220254
{'0': {'precision': 0.3020689655172414, 'recall': 0.08012805854104733, 'f1-score': 0.12665823242363997, 'support': 21865}, '1': {'precision': 0.3229298629505931, 'recall': 0.7675882836025185, 'f1-score': 0.4546044098573281, 'support': 21918}, '2': {'precision': 0.3254655438263551, 'recall': 0.12170673290162334, 'f1-score': 0.17716370210155924, 'support': 22546}, 'accuracy': 0.32142803298707956, 'macro avg': {'precision': 0.31682145743139656, 'recall': 0.3231410250150631, 'f1-score': 0.2528087814608424, 'support': 66329}, 'weighted avg': {'precision': 0.3169150871910414, 'recall': 0.32142803298707956, 'f1-score': 0.25219337747859244, 'support': 66329}}
[[ 1752 17416  2697]
 [ 2104 16824  2990]
 [ 1944 17858  2744]]
Evaluating performance on  val set...
86/86 - 1s - 639ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962662
{'0': {'precision': 0.30812588069516206, 'recall': 0.09164571109248393, 'f1-score': 0.1412727468504361, 'support': 7158}, '1': {'precision': 0.40209141507842805, 'recall': 0.8200894392844857, 'f1-score': 0.539610683567225, 'support': 8721}, '2': {'precision': 0.2893954410307235, 'recall': 0.09644921552436003, 'f1-score': 0.1446797968537099, 'support': 6055}, 'accuracy': 0.3826023525120817, 'macro avg': {'precision': 0.3332042456014379, 'recall': 0.33606145530044323, 'f1-score': 0.27518774242379035, 'support': 21934}, 'weighted avg': {'precision': 0.34031611563581526, 'recall': 0.3826023525120817, 'f1-score': 0.30059320066081896, 'support': 21934}}
[[ 656 5821  681]
 [ 816 7152  753]
 [ 657 4814  584]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1290215
{'0': {'precision': 0.38870479757959947, 'recall': 0.05761100118154512, 'f1-score': 0.10034900227502372, 'support': 140494}, '1': {'precision': 0.2659567596199187, 'recall': 0.8293967748758599, 'f1-score': 0.4027625268708074, 'support': 99283}, '2': {'precision': 0.33850947672023074, 'recall': 0.10150892691666152, 'f1-score': 0.15618316619932512, 'support': 129496}, 'accuracy': 0.2805079169070038, 'macro avg': {'precision': 0.331057011306583, 'recall': 0.32950556765802225, 'f1-score': 0.21976489844838543, 'support': 369273}, 'weighted avg': {'precision': 0.3381002672652906, 'recall': 0.2805079169070038, 'f1-score': 0.2012359418941795, 'support': 369273}}
[[  8094 117532  14868]
 [  6119  82345  10819]
 [  6610 109741  13145]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157008
{'0': {'precision': 0.3427979485786095, 'recall': 0.1843268317627292, 'f1-score': 0.2397415646266583, 'support': 54756}, '1': {'precision': 0.337990067428433, 'recall': 0.6010734737106648, 'f1-score': 0.43267969633338726, 'support': 55707}, '2': {'precision': 0.33725115285119783, 'recall': 0.2237185704692979, 'f1-score': 0.26899614245985465, 'support': 53612}, 'accuracy': 0.33869267103458783, 'macro avg': {'precision': 0.3393463896194135, 'recall': 0.33637295864756395, 'f1-score': 0.3138058011399667, 'support': 164075}, 'weighted avg': {'precision': 0.33935313707307313, 'recall': 0.33869267103458783, 'f1-score': 0.31480724148041467, 'support': 164075}}
[[10093 32961 11702]
 [10355 33484 11868]
 [ 8995 32623 11994]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1350231
{'0': {'precision': 0.2833258020786263, 'recall': 0.026019836494169397, 'f1-score': 0.047662485746864304, 'support': 24097}, '1': {'precision': 0.28486325480639046, 'recall': 0.8910812157448929, 'f1-score': 0.4317147650601682, 'support': 20070}, '2': {'precision': 0.3625195007800312, 'recall': 0.07162396455403583, 'f1-score': 0.11961522375575073, 'support': 25955}, 'accuracy': 0.2904937109608967, 'macro avg': {'precision': 0.31023618588834934, 'recall': 0.32957500559769937, 'f1-score': 0.19966415818759442, 'support': 70122}, 'weighted avg': {'precision': 0.31307864891758114, 'recall': 0.2904937109608967, 'f1-score': 0.18421681335929202, 'support': 70122}}
[[  627 21652  1818]
 [  735 17884  1451]
 [  851 23245  1859]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
1359/1359 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179934
{'0': {'precision': 0.3147266538261196, 'recall': 0.2620373171961674, 'f1-score': 0.28597531108799623, 'support': 99150}, '1': {'precision': 0.4158615933555216, 'recall': 0.4616885148765338, 'f1-score': 0.43757848042958375, 'support': 150203}, '2': {'precision': 0.24146403370729477, 'recall': 0.24157931090524948, 'f1-score': 0.24152165855095126, 'support': 98448}, 'accuracy': 0.3424688255640438, 'macro avg': {'precision': 0.32401742696297864, 'recall': 0.3217683809926502, 'f1-score': 0.3216918166895104, 'support': 347801}, 'weighted avg': {'precision': 0.3376656703806341, 'recall': 0.3424688255640438, 'f1-score': 0.33886439898494725, 'support': 347801}}
[[25981 45696 27473]
 [33617 69347 47239]
 [22953 51712 23783]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1240237
{'0': {'precision': 0.3211658824066883, 'recall': 0.18808861301369864, 'f1-score': 0.23723951742174978, 'support': 37376}, '1': {'precision': 0.31995084535191487, 'recall': 0.6319987196244231, 'f1-score': 0.4248303314476291, 'support': 37489}, '2': {'precision': 0.34581822302810517, 'recall': 0.15760252040078504, 'f1-score': 0.21652593486127863, 'support': 38724}, 'accuracy': 0.3242039281972726, 'macro avg': {'precision': 0.3289783169289028, 'recall': 0.32589661767963557, 'f1-score': 0.2928652612435525, 'support': 113589}, 'weighted avg': {'precision': 0.3291691812655333, 'recall': 0.3242039281972726, 'f1-score': 0.2920905968039479, 'support': 113589}}
[[ 7030 24694  5652]
 [ 7903 23693  5893]
 [ 6956 25665  6103]]
Evaluating performance on  val set...
144/144 - 1s - 918ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1191808
{'0': {'precision': 0.3677598303148964, 'recall': 0.17536761845483545, 'f1-score': 0.23748814666526183, 'support': 12853}, '1': {'precision': 0.30766755539211177, 'recall': 0.5874144286466562, 'f1-score': 0.40382526849282, 'support': 11394}, '2': {'precision': 0.34239068386802146, 'recall': 0.24195240016135539, 'f1-score': 0.28353975607450127, 'support': 12395}, 'accuracy': 0.3260193220894056, 'macro avg': {'precision': 0.3392726898583432, 'recall': 0.334911482420949, 'f1-score': 0.30828439041086103, 'support': 36642}, 'weighted avg': {'precision': 0.34049216068225563, 'recall': 0.3260193220894056, 'f1-score': 0.304789463862214, 'support': 36642}}
[[2254 7617 2982]
 [1923 6693 2778]
 [1952 7444 2999]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044073
{'0': {'precision': 0.3292555626774105, 'recall': 0.2142959307730816, 'f1-score': 0.2596189252218363, 'support': 83898}, '1': {'precision': 0.4080736536095895, 'recall': 0.6254629081624026, 'f1-score': 0.493905960508087, 'support': 118274}, '2': {'precision': 0.300274592149895, 'recall': 0.18707859514944147, 'f1-score': 0.23053075396825395, 'support': 89433}, 'accuracy': 0.37271651720649507, 'macro avg': {'precision': 0.34586793614563166, 'recall': 0.3422791446949753, 'f1-score': 0.32801854656605905, 'support': 291605}, 'weighted avg': {'precision': 0.35233567361420937, 'recall': 0.37271651720649507, 'f1-score': 0.3457238356030863, 'support': 291605}}
[[17979 50705 15214]
 [20524 73976 23774]
 [16102 56600 16731]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218619
{'0': {'precision': 0.3200904636260837, 'recall': 0.2647627361726009, 'f1-score': 0.28980956931267493, 'support': 32074}, '1': {'precision': 0.3135219737221467, 'recall': 0.46834430566664614, 'f1-score': 0.3756044606730484, 'support': 32506}, '2': {'precision': 0.3532210363893532, 'recall': 0.2435355654717929, 'f1-score': 0.2882980584222494, 'support': 33839}, 'accuracy': 0.32470356333634764, 'macro avg': {'precision': 0.32894449124586117, 'recall': 0.3255475357703466, 'f1-score': 0.3179040294693243, 'support': 98419}, 'weighted avg': {'precision': 0.3293121598322929, 'recall': 0.32470356333634764, 'f1-score': 0.31762635998865413, 'support': 98419}}
[[ 8492 16734  6848]
 [ 9040 15224  8242]
 [ 8998 16600  8241]]
Evaluating performance on  val set...
139/139 - 1s - 941ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027311
{'0': {'precision': 0.3089817363022267, 'recall': 0.11081202332884701, 'f1-score': 0.16312244089288075, 'support': 11145}, '1': {'precision': 0.39019636153624027, 'recall': 0.7854392211000508, 'f1-score': 0.5213784455108882, 'support': 13763}, '2': {'precision': 0.30299727520435965, 'recall': 0.10627926980789448, 'f1-score': 0.15736220193872494, 'support': 10463}, 'accuracy': 0.3719713889909813, 'macro avg': {'precision': 0.3340584576809422, 'recall': 0.3341768380789308, 'f1-score': 0.28062102944749795, 'support': 35371}, 'weighted avg': {'precision': 0.33881243010869944, 'recall': 0.3719713889909813, 'f1-score': 0.3008173890532467, 'support': 35371}}
[[ 1235  8574  1336]
 [ 1731 10810  1222]
 [ 1031  8320  1112]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
2282/2282 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1096969
{'0': {'precision': 0.3404862191033626, 'recall': 0.2199722327401237, 'f1-score': 0.26727231460977424, 'support': 198075}, '1': {'precision': 0.35988494209145583, 'recall': 0.6352054869303265, 'f1-score': 0.45945751906149934, 'support': 201497}, '2': {'precision': 0.3037527022046005, 'recall': 0.16533187292257473, 'f1-score': 0.21411918371932978, 'support': 184423}, 'accuracy': 0.34598583891985374, 'macro avg': {'precision': 0.334707954466473, 'recall': 0.340169864197675, 'f1-score': 0.3136163391302011, 'support': 583995}, 'weighted avg': {'precision': 0.3355791207530538, 'recall': 0.34598583891985374, 'f1-score': 0.31679685211985703, 'support': 583995}}
[[ 43571 116914  37590]
 [ 41205 127992  32300]
 [ 43191 110741  30491]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1166546
{'0': {'precision': 0.32134198084616317, 'recall': 0.1430247929425095, 'f1-score': 0.1979464202370951, 'support': 74134}, '1': {'precision': 0.33439560508633315, 'recall': 0.7173678532901834, 'f1-score': 0.4561570483552194, 'support': 74160}, '2': {'precision': 0.34332700434862495, 'recall': 0.14664678413059687, 'f1-score': 0.2055122223953512, 'support': 76449}, 'accuracy': 0.33377680283701827, 'macro avg': {'precision': 0.3330215300937071, 'recall': 0.33567981012109654, 'f1-score': 0.2865385636625552, 'support': 224743}, 'weighted avg': {'precision': 0.3331278421872982, 'recall': 0.33377680283701827, 'f1-score': 0.2857235620855025, 'support': 224743}}
[[10603 52472 11059]
 [10576 53200 10384]
 [11817 53421 11211]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1199985
{'0': {'precision': 0.3014003402695982, 'recall': 0.0901546290859268, 'f1-score': 0.13879346712469112, 'support': 25545}, '1': {'precision': 0.3328471457166354, 'recall': 0.8373082477848471, 'f1-score': 0.4763395732018742, 'support': 25619}, '2': {'precision': 0.3502557302519417, 'recall': 0.0705644391863527, 'f1-score': 0.1174639476526269, 'support': 26203}, 'accuracy': 0.3309292075432678, 'macro avg': {'precision': 0.3281677387460584, 'recall': 0.3326757720190422, 'f1-score': 0.24419899599306408, 'support': 77367}, 'weighted avg': {'precision': 0.3283600710650923, 'recall': 0.3309292075432678, 'f1-score': 0.24334316263912045, 'support': 77367}}
[[ 2303 21481  1761]
 [ 2499 21451  1669]
 [ 2839 21515  1849]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
5098/5098 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1202663
{'0': {'precision': 0.340993849631957, 'recall': 0.08280344259673117, 'f1-score': 0.13324985870179556, 'support': 462674}, '1': {'precision': 0.3112381633017688, 'recall': 0.744105251167559, 'f1-score': 0.4388978004719873, 'support': 421392}, '2': {'precision': 0.3102971366828741, 'recall': 0.1364778006154285, 'f1-score': 0.1895749614238916, 'support': 420845}, 'accuracy': 0.3136666025499057, 'macro avg': {'precision': 0.32084304987219997, 'recall': 0.3211288314599062, 'f1-score': 0.25390754019922485, 'support': 1304911}, 'weighted avg': {'precision': 0.3214849587305028, 'recall': 0.3136666025499057, 'f1-score': 0.25011739628367285, 'support': 1304911}}
[[ 38311 362377  61986]
 [ 42154 313560  65678]
 [ 31886 331523  57436]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1168393
{'0': {'precision': 0.34885871367834925, 'recall': 0.21028620589375727, 'f1-score': 0.26240129427818665, 'support': 165056}, '1': {'precision': 0.32182024496879486, 'recall': 0.624030079664516, 'f1-score': 0.4246454388719221, 'support': 154523}, '2': {'precision': 0.34836712545015047, 'recall': 0.17585352491470976, 'f1-score': 0.2337244323823393, 'support': 160628}, 'accuracy': 0.3319047827291147, 'macro avg': {'precision': 0.3396820280324315, 'recall': 0.336723270157661, 'f1-score': 0.30692372184414934, 'support': 480207}, 'weighted avg': {'precision': 0.33999372809020584, 'recall': 0.3319047827291147, 'f1-score': 0.30501655182847565, 'support': 480207}}
[[ 34709 103576  26771]
 [ 32030  96427  26066]
 [ 32754  99627  28247]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1195579
{'0': {'precision': 0.3502554941631008, 'recall': 0.16172718727820298, 'f1-score': 0.22128028135744468, 'support': 52131}, '1': {'precision': 0.3284548026919547, 'recall': 0.6594058265842705, 'f1-score': 0.43849305103564457, 'support': 52106}, '2': {'precision': 0.35075607045431584, 'recall': 0.19238939687817494, 'f1-score': 0.24848499308107078, 'support': 54135}, 'accuracy': 0.33594953653423587, 'macro avg': {'precision': 0.34315545576979045, 'recall': 0.3378408035802161, 'f1-score': 0.3027527751580533, 'support': 158372}, 'weighted avg': {'precision': 0.34325395265152925, 'recall': 0.33594953653423587, 'f1-score': 0.30204465666375374, 'support': 158372}}
[[ 8431 34186  9514]
 [ 7983 34359  9764]
 [ 7657 36063 10415]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
5760/5760 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1168982
{'0': {'precision': 0.42635046113306985, 'recall': 0.006161474031747966, 'f1-score': 0.012147397938020492, 'support': 525199}, '1': {'precision': 0.31703746322595566, 'recall': 0.9287766822067155, 'f1-score': 0.4727141754004916, 'support': 466322}, '2': {'precision': 0.32890401714830103, 'recall': 0.06862615177554612, 'f1-score': 0.11355825929644107, 'support': 482950}, 'accuracy': 0.31841114542096793, 'macro avg': {'precision': 0.3574306471691089, 'recall': 0.3345214360046698, 'f1-score': 0.19947327754498437, 'support': 1474471}, 'weighted avg': {'precision': 0.3598609771537407, 'recall': 0.31841114542096793, 'f1-score': 0.19102429432520185, 'support': 1474471}}
[[  3236 485690  36273]
 [  1861 433109  31352]
 [  2493 447314  33143]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132563
{'0': {'precision': 0.3411289795384716, 'recall': 0.11282580728856985, 'f1-score': 0.1695682196677363, 'support': 185002}, '1': {'precision': 0.3360730207169153, 'recall': 0.7399813657788008, 'f1-score': 0.46222156796625863, 'support': 182460}, '2': {'precision': 0.3458070132363117, 'recall': 0.16741680489742108, 'f1-score': 0.2256088015465325, 'support': 185077}, 'accuracy': 0.3382114203703268, 'macro avg': {'precision': 0.3410030044972328, 'recall': 0.34007465932159725, 'f1-score': 0.28579952972684247, 'support': 552539}, 'weighted avg': {'precision': 0.3410263373650033, 'recall': 0.3382114203703268, 'f1-score': 0.28497971587511783, 'support': 552539}}
[[ 20873 133066  31063]
 [ 19889 135017  27554]
 [ 20426 133666  30985]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197739
{'0': {'precision': 0.35740950603293115, 'recall': 0.13805489751776703, 'f1-score': 0.19917528837045154, 'support': 77672}, '1': {'precision': 0.29520883951565385, 'recall': 0.6874431511601018, 'f1-score': 0.4130440823661273, 'support': 64865}, '2': {'precision': 0.35915027277235906, 'recall': 0.17424606993904396, 'f1-score': 0.2346492412377815, 'support': 74808}, 'accuracy': 0.31447238261749755, 'macro avg': {'precision': 0.3372562061069813, 'recall': 0.3332480395389709, 'f1-score': 0.2822895373247868, 'support': 217345}, 'weighted avg': {'precision': 0.33944533406946265, 'recall': 0.31447238261749755, 'f1-score': 0.2752126243507075, 'support': 217345}}
[[10723 54316 12633]
 [ 9648 44591 10626]
 [ 9631 52142 13035]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
6315/6315 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1345108
{'0': {'precision': 0.4093704808801186, 'recall': 0.07128660796111089, 'f1-score': 0.12142807693404084, 'support': 627425}, '1': {'precision': 0.2505358780352322, 'recall': 0.7387001078092337, 'f1-score': 0.37416932413092596, 'support': 410911}, '2': {'precision': 0.34576366360982475, 'recall': 0.17681013516552327, 'f1-score': 0.2339746854566701, 'support': 578106}, 'accuracy': 0.27868738872164917, 'macro avg': {'precision': 0.33522334084172517, 'recall': 0.32893228364528926, 'f1-score': 0.24319069550721228, 'support': 1616442}, 'weighted avg': {'precision': 0.3462451920083523, 'recall': 0.27868738872164917, 'f1-score': 0.22592797751414354, 'support': 1616442}}
[[ 44727 467830 114868]
 [ 28833 303540  78538]
 [ 35698 440193 102215]]
Evaluating performance on  train set...
2155/2155 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129135
{'0': {'precision': 0.33080137023885114, 'recall': 0.2312176733584641, 'f1-score': 0.2721869447015457, 'support': 182512}, '1': {'precision': 0.3342586151541096, 'recall': 0.5484607364319816, 'f1-score': 0.415370357286831, 'support': 182230}, '2': {'precision': 0.3569668064402548, 'recall': 0.23880213491506913, 'f1-score': 0.286166094116364, 'support': 186799}, 'accuracy': 0.33860402037201226, 'macro avg': {'precision': 0.3406755972777385, 'recall': 0.33949351490183827, 'f1-score': 0.3245744653682469, 'support': 551541}, 'weighted avg': {'precision': 0.3408055060291071, 'recall': 0.33860402037201226, 'f1-score': 0.32422950256570304, 'support': 551541}}
[[ 42200  97588  42724]
 [ 44652  99946  37632]
 [ 40717 101474  44608]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1228719
{'0': {'precision': 0.3611477490481049, 'recall': 0.2046278148310044, 'f1-score': 0.26123742146856044, 'support': 70919}, '1': {'precision': 0.2704080665643183, 'recall': 0.5520430273951401, 'f1-score': 0.3630048979072578, 'support': 51688}, '2': {'precision': 0.3846700259717197, 'recall': 0.2542885233392519, 'f1-score': 0.30617689671013115, 'support': 68147}, 'accuracy': 0.3165071243591222, 'macro avg': {'precision': 0.33874194719471434, 'recall': 0.33698645518846543, 'f1-score': 0.31013973869531647, 'support': 190754}, 'weighted avg': {'precision': 0.3449636580056713, 'recall': 0.3165071243591222, 'f1-score': 0.30486768736836184, 'support': 190754}}
[[14512 39941 16466]
 [11900 28534 11254]
 [13771 37047 17329]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
6082/6082 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1338247
{'0': {'precision': 0.3663036727577122, 'recall': 0.3186649082006933, 'f1-score': 0.34082768026991134, 'support': 595974}, '1': {'precision': 0.2400779944668847, 'recall': 0.5550171104905007, 'f1-score': 0.3351734753504901, 'support': 381345}, '2': {'precision': 0.38939114567715344, 'recall': 0.10532110408379855, 'f1-score': 0.16579781641950392, 'support': 579485}, 'accuracy': 0.2971478747485233, 'macro avg': {'precision': 0.3319242709672501, 'recall': 0.32633437425833084, 'f1-score': 0.2805996573466351, 'support': 1556804}, 'weighted avg': {'precision': 0.3439780061721348, 'recall': 0.2971478747485233, 'f1-score': 0.27429176217852025, 'support': 1556804}}
[[189916 347750  58308]
 [132295 211653  37397]
 [196255 322198  61032]]
Evaluating performance on  train set...
2440/2440 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1174046
{'0': {'precision': 0.3164857530529172, 'recall': 0.07647430365038115, 'f1-score': 0.12318314376803266, 'support': 207403}, '1': {'precision': 0.32726816167426204, 'recall': 0.8071121002467463, 'f1-score': 0.4657029078864538, 'support': 206690}, '2': {'precision': 0.331237447860343, 'recall': 0.10186038556918486, 'f1-score': 0.1558076330552568, 'support': 210494}, 'accuracy': 0.3268143589283799, 'macro avg': {'precision': 0.32499712086250737, 'recall': 0.32848226315543744, 'f1-score': 0.2482312282365811, 'support': 624587}, 'weighted avg': {'precision': 0.3250254109144161, 'recall': 0.3268143589283799, 'f1-score': 0.2475255801198322, 'support': 624587}}
[[ 15861 169972  21570]
 [ 18149 166822  21719]
 [ 16106 172947  21441]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127646
{'0': {'precision': 0.3248175182481752, 'recall': 0.0126059076511035, 'f1-score': 0.02426991918290446, 'support': 77662}, '1': {'precision': 0.29329523107177974, 'recall': 0.9204583808804384, 'f1-score': 0.4448449023819048, 'support': 62219}, '2': {'precision': 0.34285714285714286, 'recall': 0.0630546277792529, 'f1-score': 0.10651935266829562, 'support': 71557}, 'accuracy': 0.29682933058390637, 'macro avg': {'precision': 0.3203232973923659, 'recall': 0.33203963877026493, 'f1-score': 0.19187805807770164, 'support': 211438}, 'weighted avg': {'precision': 0.3216467364223717, 'recall': 0.29682933058390637, 'f1-score': 0.17586649875503785, 'support': 211438}}
[[  979 71856  4827]
 [ 1128 57270  3821]
 [  907 66138  4512]]
testing model on single stock: results/universal/W3/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
13689/13689 - 84s - 84s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064024
{'0': {'precision': 0.3481103552532124, 'recall': 0.04051491015551462, 'f1-score': 0.07258231012054762, 'support': 1136742}, '1': {'precision': 0.35464863146616105, 'recall': 0.867266637983851, 'f1-score': 0.5034308580425085, 'support': 1238837}, '2': {'precision': 0.3186738421376908, 'recall': 0.0966928243671517, 'f1-score': 0.1483675813830185, 'support': 1128667}, 'accuracy': 0.3508860393933531, 'macro avg': {'precision': 0.3404776096190214, 'recall': 0.33482479083550576, 'f1-score': 0.24146024984869155, 'support': 3504246}, 'weighted avg': {'precision': 0.34094072091254807, 'recall': 0.3508860393933531, 'f1-score': 0.24930719111406163, 'support': 3504246}}
[[  46055  977037  113650]
 [  44756 1074402  119679]
 [  41489  978044  109134]]
Evaluating performance on  train set...
5475/5475 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1191019
{'0': {'precision': 0.3137501820393548, 'recall': 0.0778253524718182, 'f1-score': 0.12471524062805404, 'support': 470605}, '1': {'precision': 0.3205679545419309, 'recall': 0.7147462142244481, 'f1-score': 0.44261875056444355, 'support': 462851}, '2': {'precision': 0.3266534572017291, 'recall': 0.17644143470551793, 'f1-score': 0.22912259920467043, 'support': 468110}, 'accuracy': 0.32109797184007033, 'macro avg': {'precision': 0.32032386459433826, 'recall': 0.32300433380059473, 'f1-score': 0.26548553013238935, 'support': 1401566}, 'weighted avg': {'precision': 0.32031124656064663, 'recall': 0.32109797184007033, 'f1-score': 0.26457029283456285, 'support': 1401566}}
[[ 36625 351743  82237]
 [ 44012 330821  88018]
 [ 36096 349420  82594]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273444
{'0': {'precision': 0.2919178802213771, 'recall': 0.10959754837661206, 'f1-score': 0.15936365938053842, 'support': 172294}, '1': {'precision': 0.2864426837829706, 'recall': 0.4010480731966232, 'f1-score': 0.33419296258506587, 'support': 178041}, '2': {'precision': 0.3103133820655714, 'recall': 0.37636717949918364, 'f1-score': 0.34016332748006006, 'support': 170881}, 'accuracy': 0.2966140717092338, 'macro avg': {'precision': 0.29622464868997306, 'recall': 0.2956709336908063, 'f1-score': 0.27790664981522145, 'support': 521216}, 'weighted avg': {'precision': 0.2960785972783121, 'recall': 0.2966140717092338, 'f1-score': 0.27835849464336926, 'support': 521216}}
[[18883 90112 63299]
 [26996 71403 79642]
 [18807 87760 64314]]
training model: results/universal/W3/deepLOB_L1/h1000
Epoch 1/50
10532/10532 - 163s - loss: 3.1818 - accuracy1000: 0.4332 - val_loss: 3.5500 - val_accuracy1000: 0.3349 - 163s/epoch - 16ms/step
Epoch 2/50
10532/10532 - 161s - loss: 3.1509 - accuracy1000: 0.4455 - val_loss: 3.6441 - val_accuracy1000: 0.3509 - 161s/epoch - 15ms/step
Epoch 3/50
10532/10532 - 162s - loss: 3.1423 - accuracy1000: 0.4492 - val_loss: 3.5217 - val_accuracy1000: 0.3164 - 162s/epoch - 15ms/step
Epoch 4/50
10532/10532 - 165s - loss: 3.1215 - accuracy1000: 0.4570 - val_loss: 3.5054 - val_accuracy1000: 0.3110 - 165s/epoch - 16ms/step
Epoch 5/50
10532/10532 - 166s - loss: 3.1067 - accuracy1000: 0.4626 - val_loss: 3.7063 - val_accuracy1000: 0.3045 - 166s/epoch - 16ms/step
Epoch 6/50
10532/10532 - 161s - loss: 3.0985 - accuracy1000: 0.4650 - val_loss: 3.7478 - val_accuracy1000: 0.3079 - 161s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 165s - loss: 3.0912 - accuracy1000: 0.4675 - val_loss: 3.7541 - val_accuracy1000: 0.3097 - 165s/epoch - 16ms/step
Epoch 8/50
10532/10532 - 165s - loss: 3.0848 - accuracy1000: 0.4689 - val_loss: 3.6598 - val_accuracy1000: 0.3189 - 165s/epoch - 16ms/step
Epoch 9/50
10532/10532 - 164s - loss: 3.0797 - accuracy1000: 0.4702 - val_loss: 3.7675 - val_accuracy1000: 0.3168 - 164s/epoch - 16ms/step
Epoch 10/50
10532/10532 - 162s - loss: 3.0729 - accuracy1000: 0.4722 - val_loss: 3.7086 - val_accuracy1000: 0.3352 - 162s/epoch - 15ms/step
Epoch 11/50
10532/10532 - 159s - loss: 3.0686 - accuracy1000: 0.4739 - val_loss: 3.7272 - val_accuracy1000: 0.3178 - 159s/epoch - 15ms/step
Epoch 12/50
10532/10532 - 160s - loss: 3.0655 - accuracy1000: 0.4748 - val_loss: 3.7089 - val_accuracy1000: 0.3412 - 160s/epoch - 15ms/step
Epoch 13/50
10532/10532 - 164s - loss: 3.0612 - accuracy1000: 0.4761 - val_loss: 3.7272 - val_accuracy1000: 0.3191 - 164s/epoch - 16ms/step
Epoch 14/50
10532/10532 - 159s - loss: 3.0577 - accuracy1000: 0.4773 - val_loss: 3.6550 - val_accuracy1000: 0.3281 - 159s/epoch - 15ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 143s - 143s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1459905
{'0': {'precision': 0.3842711896172047, 'recall': 0.06293313771357384, 'f1-score': 0.10815365691956257, 'support': 2606417}, '1': {'precision': 0.2847131152119775, 'recall': 0.7961109058767817, 'f1-score': 0.41942668120584625, 'support': 2016665}, '2': {'precision': 0.33971034031387964, 'recall': 0.14075046835769334, 'f1-score': 0.19903554521889955, 'support': 2463395}, 'accuracy': 0.2986311816153499, 'macro avg': {'precision': 0.3362315483810206, 'recall': 0.33326483731601625, 'f1-score': 0.2422052944481028, 'support': 7086477}, 'weighted avg': {'precision': 0.3404488139162772, 'recall': 0.2986311816153499, 'f1-score': 0.22832781436753613, 'support': 7086477}}
[[ 164030 2056544  385843]
 [ 123097 1605489  288079]
 [ 139733 1976938  346724]]
Evaluating performance on  train set...
10532/10532 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1647202
{'0': {'precision': 0.32747470404888757, 'recall': 0.23555925179805262, 'f1-score': 0.2740143661584594, 'support': 905424}, '1': {'precision': 0.3150117223428043, 'recall': 0.5639606208657947, 'f1-score': 0.40423161862850576, 'support': 886053}, '2': {'precision': 0.3417599420379677, 'recall': 0.17317221238683625, 'f1-score': 0.22986843901415127, 'support': 904331}, 'accuracy': 0.32256933728218035, 'macro avg': {'precision': 0.3280821228098865, 'recall': 0.3242306950168945, 'f1-score': 0.3027048079337055, 'support': 2695808}, 'weighted avg': {'precision': 0.3281704958954444, 'recall': 0.32256933728218035, 'f1-score': 0.3020048078970783, 'support': 2695808}}
[[213281 542616 149527]
 [234255 499699 152099]
 [203754 543972 156605]]
Evaluating performance on  val set...
3814/3814 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1694208
{'0': {'precision': 0.3120787169752847, 'recall': 0.1752077002901901, 'f1-score': 0.22442076106941314, 'support': 321858}, '1': {'precision': 0.30492773449116756, 'recall': 0.49559104736414417, 'f1-score': 0.3775538031890105, 'support': 331031}, '2': {'precision': 0.3239175329903042, 'recall': 0.2578945086794696, 'f1-score': 0.28715993152515135, 'support': 322946}, 'accuracy': 0.31125548888900273, 'macro avg': {'precision': 0.31364132815225215, 'recall': 0.3095644187779346, 'f1-score': 0.29637816526119165, 'support': 975835}, 'weighted avg': {'precision': 0.31357087640191594, 'recall': 0.31125548888900273, 'f1-score': 0.29713095101739745, 'support': 975835}}
[[ 56392 189728  75738]
 [ 68878 164056  98097]
 [ 55428 184232  83286]]
testing model out of sample: results/universal/W3/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 89s - 89s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1834435
{'0': {'precision': 0.32036513676469003, 'recall': 0.306664769184337, 'f1-score': 0.31336527903547495, 'support': 1454559}, '1': {'precision': 0.29271907124896235, 'recall': 0.5113137494224608, 'f1-score': 0.37230143347327904, 'support': 1328914}, '2': {'precision': 0.2803638625628848, 'recall': 0.08761114272832762, 'f1-score': 0.1335036240269807, 'support': 1352990}, 'accuracy': 0.3007620278484299, 'macro avg': {'precision': 0.2978160235255124, 'recall': 0.3018632204450418, 'f1-score': 0.2730567788452449, 'support': 4136463}, 'weighted avg': {'precision': 0.29839937338397854, 'recall': 0.3007620278484299, 'f1-score': 0.2734688893248979, 'support': 4136463}}
[[446062 854302 154195]
 [499357 679492 150065]
 [446936 787517 118537]]
Evaluating performance on  train set...
6181/6181 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1658167
{'0': {'precision': 0.31180262695484096, 'recall': 0.2174910564496978, 'f1-score': 0.2562444437424694, 'support': 522164}, '1': {'precision': 0.3183383455900859, 'recall': 0.6165001500465431, 'f1-score': 0.4198706808456905, 'support': 523171}, '2': {'precision': 0.32587826597514435, 'recall': 0.12415463079641795, 'f1-score': 0.17980594790721782, 'support': 536452}, 'accuracy': 0.31780764413919194, 'macro avg': {'precision': 0.3186730795066904, 'recall': 0.31938194576421963, 'f1-score': 0.28530702416512593, 'support': 1581787}, 'weighted avg': {'precision': 0.3187379495727658, 'recall': 0.31780764413919194, 'f1-score': 0.2844397178999362, 'support': 1581787}}
[[113566 341253  67345]
 [130204 322535  70432]
 [120454 349395  66603]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1543725
{'0': {'precision': 0.33883589022797733, 'recall': 0.16724397516261402, 'f1-score': 0.2239498746536917, 'support': 203242}, '1': {'precision': 0.29972725403979883, 'recall': 0.6869423329943523, 'f1-score': 0.4173541819019577, 'support': 174051}, '2': {'precision': 0.34577042272873, 'recall': 0.12083784605699104, 'f1-score': 0.17908878135180442, 'support': 187433}, 'accuracy': 0.31201503029787897, 'macro avg': {'precision': 0.32811118899883535, 'recall': 0.32500805140465244, 'f1-score': 0.27346427930248457, 'support': 564726}, 'weighted avg': {'precision': 0.3290840158553168, 'recall': 0.31201503029787897, 'f1-score': 0.26866848824685957, 'support': 564726}}
[[ 33991 145934  23317]
 [ 34951 119563  19537]
 [ 31375 133409  22649]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1140895
{'0': {'precision': 0.3495866016535934, 'recall': 0.029542441506324124, 'f1-score': 0.05448087883042868, 'support': 55818}, '1': {'precision': 0.43355113362455777, 'recall': 0.7929168249145462, 'f1-score': 0.5605853555622683, 'support': 73724}, '2': {'precision': 0.23379232905856628, 'recall': 0.1804332953249715, 'f1-score': 0.20367605416259074, 'support': 43850}, 'accuracy': 0.39227876718649074, 'macro avg': {'precision': 0.3389766881122392, 'recall': 0.3342975205819472, 'f1-score': 0.2729140961850959, 'support': 173392}, 'weighted avg': {'precision': 0.35600340463029034, 'recall': 0.39227876718649074, 'f1-score': 0.30740059185579, 'support': 173392}}
[[ 1649 41625 12544]
 [ 1881 58457 13386]
 [ 1187 34751  7912]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1768531
{'0': {'precision': 0.2904835772577055, 'recall': 0.20082062759360284, 'f1-score': 0.23747036444836522, 'support': 21447}, '1': {'precision': 0.3233473408341241, 'recall': 0.6456444263996031, 'f1-score': 0.43089614475605537, 'support': 22167}, '2': {'precision': 0.3116022099447514, 'recall': 0.09931763152102135, 'f1-score': 0.15062593890836254, 'support': 22715}, 'accuracy': 0.31471905199837175, 'macro avg': {'precision': 0.308477709345527, 'recall': 0.3152608951714091, 'f1-score': 0.27299748270426105, 'support': 66329}, 'weighted avg': {'precision': 0.30869884944158765, 'recall': 0.31471905199837175, 'f1-score': 0.27237211399892997, 'support': 66329}}
[[ 4307 14610  2530]
 [ 5401 14312  2454]
 [ 5119 15340  2256]]
Evaluating performance on  val set...
86/86 - 1s - 633ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1458668
{'0': {'precision': 0.2516507703595011, 'recall': 0.18317757009345795, 'f1-score': 0.2120228712718282, 'support': 7490}, '1': {'precision': 0.36033236506113625, 'recall': 0.6373521328713108, 'f1-score': 0.4603832211289487, 'support': 8369}, '2': {'precision': 0.2793329362715902, 'recall': 0.07720164609053498, 'f1-score': 0.12096982202734072, 'support': 6075}, 'accuracy': 0.3271177167867238, 'macro avg': {'precision': 0.2971053572307425, 'recall': 0.2992437830184345, 'f1-score': 0.26445863814270587, 'support': 21934}, 'weighted avg': {'precision': 0.3007856944031742, 'recall': 0.3271177167867238, 'f1-score': 0.28156698059041946, 'support': 21934}}
[[1372 5443  675]
 [2500 5334  535]
 [1580 4026  469]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1604472
{'0': {'precision': 0.3951923076923077, 'recall': 0.025682327864527284, 'f1-score': 0.048230316385138444, 'support': 144029}, '1': {'precision': 0.22878222756399788, 'recall': 0.7794654381982463, 'f1-score': 0.3537381643731852, 'support': 89868}, '2': {'precision': 0.31942454076789933, 'recall': 0.1267802269235315, 'f1-score': 0.1815162844315652, 'support': 135376}, 'accuracy': 0.24618913378449006, 'macro avg': {'precision': 0.31446635867473494, 'recall': 0.31064266432876836, 'f1-score': 0.19449492172996297, 'support': 369273}, 'weighted avg': {'precision': 0.3269174045823331, 'recall': 0.24618913378449006, 'f1-score': 0.1714429544421934, 'support': 369273}}
[[  3699 121266  19064]
 [  2315  70049  17504]
 [  3346 114867  17163]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1704078
{'0': {'precision': 0.33504670990902785, 'recall': 0.2938041067467983, 'f1-score': 0.31307297920597704, 'support': 55908}, '1': {'precision': 0.31589403973509933, 'recall': 0.47484560789012814, 'f1-score': 0.37939389476009866, 'support': 54245}, '2': {'precision': 0.3729445820525829, 'recall': 0.2317606913690145, 'f1-score': 0.2858711441022063, 'support': 53922}, 'accuracy': 0.3332683224135304, 'macro avg': {'precision': 0.34129511056557, 'recall': 0.3334701353353136, 'f1-score': 0.3261126726894274, 'support': 164075}, 'weighted avg': {'precision': 0.3411694736947357, 'recall': 0.3332683224135304, 'f1-score': 0.32605972741117467, 'support': 164075}}
[[16426 28045 11437]
 [18912 25758  9575]
 [13688 27737 12497]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1749362
{'0': {'precision': 0.24480220395161637, 'recall': 0.26464702871236445, 'f1-score': 0.2543381037567084, 'support': 21489}, '1': {'precision': 0.3290007752998586, 'recall': 0.5694888494178014, 'f1-score': 0.4170605153998468, 'support': 25335}, '2': {'precision': 0.3612117220941719, 'recall': 0.0470855867456434, 'f1-score': 0.08331118283652934, 'support': 23298}, 'accuracy': 0.30250135478166623, 'macro avg': {'precision': 0.31167156711521565, 'recall': 0.29374048829193644, 'f1-score': 0.25156993399769484, 'support': 70122}, 'weighted avg': {'precision': 0.3139000585306782, 'recall': 0.30250135478166623, 'f1-score': 0.2563059183566996, 'support': 70122}}
[[ 5687 14542  1260]
 [10227 14428   680]
 [ 7317 14884  1097]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1663886
{'0': {'precision': 0.3050455737619777, 'recall': 0.24656556645851918, 'f1-score': 0.2727056406446783, 'support': 95285}, '1': {'precision': 0.4516332190826844, 'recall': 0.45774820779730924, 'f1-score': 0.4546701538123891, 'support': 162928}, '2': {'precision': 0.1824342871205596, 'recall': 0.21514042059204358, 'f1-score': 0.1974420832116863, 'support': 89588}, 'accuracy': 0.3373998349630967, 'macro avg': {'precision': 0.31303769332174053, 'recall': 0.30648473161595735, 'f1-score': 0.30827262588958454, 'support': 347801}, 'weighted avg': {'precision': 0.34213210292428814, 'recall': 0.3373998349630967, 'f1-score': 0.33856054795685364, 'support': 347801}}
[[23494 42606 29185]
 [31158 74580 57190]
 [22366 47948 19274]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2040223
{'0': {'precision': 0.32550071530758223, 'recall': 0.49179973521385534, 'f1-score': 0.39173149971484217, 'support': 37011}, '1': {'precision': 0.3159267255199538, 'recall': 0.391554295705619, 'f1-score': 0.3496983319531527, 'support': 37747}, '2': {'precision': 0.37580378467756753, 'recall': 0.10535396976642374, 'f1-score': 0.16457147454592996, 'support': 38831}, 'accuracy': 0.3263784345315127, 'macro avg': {'precision': 0.3390770751683678, 'recall': 0.329569333561966, 'f1-score': 0.30200043540464155, 'support': 113589}, 'weighted avg': {'precision': 0.3395155327123687, 'recall': 0.3263784345315127, 'f1-score': 0.300107513934225, 'support': 113589}}
[[18202 15413  3396]
 [19568 14780  3399]
 [18150 16590  4091]]
Evaluating performance on  val set...
144/144 - 1s - 938ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1487266
{'0': {'precision': 0.36542669584245074, 'recall': 0.3358268983268983, 'f1-score': 0.35000209582093306, 'support': 12432}, '1': {'precision': 0.32558012259194397, 'recall': 0.4836192179497602, 'f1-score': 0.3891669119811598, 'support': 12301}, '2': {'precision': 0.38819294456443487, 'recall': 0.22638340750692754, 'f1-score': 0.28598705844913547, 'support': 11909}, 'accuracy': 0.349871731892364, 'macro avg': {'precision': 0.3597332543329432, 'recall': 0.3486098412611954, 'f1-score': 0.3417186887504095, 'support': 36642}, 'weighted avg': {'precision': 0.3594491443571505, 'recall': 0.349871731892364, 'f1-score': 0.3423445259155298, 'support': 36642}}
[[4175 6074 2183]
 [4286 5949 2066]
 [2964 6249 2696]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1515435
{'0': {'precision': 0.304494633273703, 'recall': 0.33039342949690037, 'f1-score': 0.31691579051486884, 'support': 82429}, '1': {'precision': 0.4146198792400835, 'recall': 0.5536145101102143, 'f1-score': 0.47414052599697504, 'support': 115230}, '2': {'precision': 0.302571109178984, 'recall': 0.1555787367210951, 'f1-score': 0.2054944745943818, 'support': 93946}, 'accuracy': 0.362281168018381, 'macro avg': {'precision': 0.3405618738975902, 'recall': 0.34652889210940324, 'f1-score': 0.33218359703540856, 'support': 291605}, 'weighted avg': {'precision': 0.3473917876369806, 'recall': 0.362281168018381, 'f1-score': 0.3431479172758538, 'support': 291605}}
[[27234 40286 14909]
 [32656 63793 18781]
 [29550 49780 14616]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2078112
{'0': {'precision': 0.3332074125375139, 'recall': 0.5041277703689592, 'f1-score': 0.40122310248537457, 'support': 31494}, '1': {'precision': 0.31628042559393676, 'recall': 0.33558084869479154, 'f1-score': 0.32564491198583373, 'support': 32332}, '2': {'precision': 0.3764955967203158, 'recall': 0.1791981036625907, 'f1-score': 0.24282188883230832, 'support': 34593}, 'accuracy': 0.33454922321909386, 'macro avg': {'precision': 0.34199447828392215, 'recall': 0.33963557424211377, 'f1-score': 0.3232299677678389, 'support': 98419}, 'weighted avg': {'precision': 0.3428618980898557, 'recall': 0.33454922321909386, 'f1-score': 0.32071865477576894, 'support': 98419}}
[[15877 11006  4611]
 [15827 10850  5655]
 [15945 12449  6199]]
Evaluating performance on  val set...
139/139 - 1s - 900ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1586545
{'0': {'precision': 0.30312470499386385, 'recall': 0.27590651314658876, 'f1-score': 0.2888758940218613, 'support': 11638}, '1': {'precision': 0.364707487944682, 'recall': 0.6117979242979243, 'f1-score': 0.4569913925782363, 'support': 13104}, '2': {'precision': 0.351931330472103, 'recall': 0.0925769122212814, 'f1-score': 0.1465921787709497, 'support': 10629}, 'accuracy': 0.34525458709111984, 'macro avg': {'precision': 0.33992117447021625, 'recall': 0.32676044988859815, 'f1-score': 0.2974864884570158, 'support': 35371}, 'weighted avg': {'precision': 0.3406058734650896, 'recall': 0.34525458709111984, 'f1-score': 0.3084018300621429, 'support': 35371}}
[[3211 7411 1016]
 [4291 8017  796]
 [3091 6554  984]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1597275
{'0': {'precision': 0.34384977713147663, 'recall': 0.15774208050738894, 'f1-score': 0.21626977551845492, 'support': 206863}, '1': {'precision': 0.3584402599566739, 'recall': 0.6267386403717279, 'f1-score': 0.4560559733970139, 'support': 195627}, '2': {'precision': 0.2856997123212209, 'recall': 0.23144816947191538, 'f1-score': 0.2557283042758352, 'support': 181505}, 'accuracy': 0.337754604063391, 'macro avg': {'precision': 0.3293299164697905, 'recall': 0.33864296345034406, 'f1-score': 0.309351351063768, 'support': 583995}, 'weighted avg': {'precision': 0.33066433011610735, 'recall': 0.337754604063391, 'f1-score': 0.3088571688942495, 'support': 583995}}
[[ 32631 115078  59154]
 [ 27144 122607  45876]
 [ 35124 104372  42009]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1725235
{'0': {'precision': 0.31889554117514163, 'recall': 0.2690877895338862, 'f1-score': 0.29188207143068146, 'support': 73437}, '1': {'precision': 0.33266832539369484, 'recall': 0.590989946904563, 'f1-score': 0.4257064368016929, 'support': 74206}, '2': {'precision': 0.3453211839214166, 'recall': 0.13861219195849547, 'f1-score': 0.19781948763512516, 'support': 77100}, 'accuracy': 0.3306131892873193, 'macro avg': {'precision': 0.3322950168300844, 'recall': 0.3328966427989815, 'f1-score': 0.3051359986224998, 'support': 224743}, 'weighted avg': {'precision': 0.3325086026785467, 'recall': 0.3306131892873193, 'f1-score': 0.30379944214337945, 'support': 224743}}
[[19761 43129 10547]
 [20637 43855  9714]
 [21569 44844 10687]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1836028
{'0': {'precision': 0.3183886937080805, 'recall': 0.3094323516858728, 'f1-score': 0.3138466382007438, 'support': 25773}, '1': {'precision': 0.31982391308737707, 'recall': 0.6352223960213372, 'f1-score': 0.4254438982458968, 'support': 24933}, '2': {'precision': 0.38813438170121517, 'recall': 0.04073365590187915, 'f1-score': 0.0737295902780135, 'support': 26661}, 'accuracy': 0.3218297206819445, 'macro avg': {'precision': 0.3421156628322242, 'recall': 0.32846280120302973, 'f1-score': 0.27100670890821804, 'support': 77367}, 'weighted avg': {'precision': 0.3428858838843697, 'recall': 0.3218297206819445, 'f1-score': 0.2670656316997535, 'support': 77367}}
[[ 7975 16890   908]
 [ 8291 15838   804]
 [ 8782 16793  1086]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
5098/5098 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1673769
{'0': {'precision': 0.4157078832067962, 'recall': 0.09516690625723796, 'f1-score': 0.15487800129280466, 'support': 522419}, '1': {'precision': 0.2381615274101006, 'recall': 0.7289060730277632, 'f1-score': 0.359018094727173, 'support': 322261}, '2': {'precision': 0.35009396135022963, 'recall': 0.15139136650942678, 'f1-score': 0.21137688490995055, 'support': 460231}, 'accuracy': 0.2715051064785261, 'macro avg': {'precision': 0.3346544573223755, 'recall': 0.325154781931476, 'f1-score': 0.24175766030997606, 'support': 1304911}, 'weighted avg': {'precision': 0.34871953914703396, 'recall': 0.2715051064785261, 'f1-score': 0.2252191420727166, 'support': 1304911}}
[[ 49717 396630  76072]
 [ 34092 234898  53271]
 [ 35787 354769  69675]]
Evaluating performance on  train set...
1876/1876 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1746801
{'0': {'precision': 0.34104198667027047, 'recall': 0.30931909499665167, 'f1-score': 0.3244068615001615, 'support': 167248}, '1': {'precision': 0.31370597243491577, 'recall': 0.5384448577004711, 'f1-score': 0.3964400707341205, 'support': 152179}, '2': {'precision': 0.3615039515122705, 'recall': 0.15135589003607414, 'f1-score': 0.21337507014590346, 'support': 160780}, 'accuracy': 0.3290414342148282, 'macro avg': {'precision': 0.3387506368724856, 'recall': 0.3330399475777323, 'f1-score': 0.3114073341267285, 'support': 480207}, 'weighted avg': {'precision': 0.3392300751341511, 'recall': 0.3290414342148282, 'f1-score': 0.31005940370399665, 'support': 480207}}
[[51733 91427 24088]
 [51346 81940 18893]
 [48612 87833 24335]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1801142
{'0': {'precision': 0.31495846567310043, 'recall': 0.41870001217977343, 'f1-score': 0.35949455337690633, 'support': 49262}, '1': {'precision': 0.3665080681537096, 'recall': 0.43267430475634266, 'f1-score': 0.3968521552810688, 'support': 58217}, '2': {'precision': 0.3316636999627437, 'recall': 0.15742833002574028, 'f1-score': 0.21351099267155227, 'support': 50893}, 'accuracy': 0.3398769984593236, 'macro avg': {'precision': 0.33771007792985125, 'recall': 0.33626754898728545, 'f1-score': 0.3232859004431758, 'support': 158372}, 'weighted avg': {'precision': 0.33927616511691905, 'recall': 0.3398769984593236, 'f1-score': 0.3263151160715559, 'support': 158372}}
[[20626 20976  7660]
 [24543 25189  8485]
 [20319 22562  8012]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
5760/5760 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1565644
{'0': {'precision': 0.40340958011652267, 'recall': 0.023843773748778635, 'f1-score': 0.0450262434191243, 'support': 589504}, '1': {'precision': 0.23588157933455717, 'recall': 0.9001865886526457, 'f1-score': 0.37381107967029187, 'support': 347288}, '2': {'precision': 0.3608785054906593, 'recall': 0.07670561803604009, 'f1-score': 0.12651925566442318, 'support': 537679}, 'accuracy': 0.24952881406280625, 'macro avg': {'precision': 0.33338988831391303, 'recall': 0.3335786601458215, 'f1-score': 0.18178552625127978, 'support': 1474471}, 'weighted avg': {'precision': 0.3484417102775588, 'recall': 0.24952881406280625, 'f1-score': 0.15218339302941541, 'support': 1474471}}
[[ 14056 528992  46456]
 [  8078 312624  26586]
 [ 12709 483727  41243]]
Evaluating performance on  train set...
2159/2159 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1636221
{'0': {'precision': 0.3070008749988952, 'recall': 0.18765937675584562, 'f1-score': 0.23293398918317193, 'support': 185096}, '1': {'precision': 0.30192857567092884, 'recall': 0.5836221694967144, 'f1-score': 0.3979720221064502, 'support': 182918}, '2': {'precision': 0.31072373250678753, 'recall': 0.14451158379623358, 'f1-score': 0.19727458349362295, 'support': 184525}, 'accuracy': 0.30433326878283706, 'macro avg': {'precision': 0.30655106105887053, 'recall': 0.3052643766829312, 'f1-score': 0.2760601982610817, 'support': 552539}, 'weighted avg': {'precision': 0.30656496990110277, 'recall': 0.30433326878283706, 'f1-score': 0.2756610637813382, 'support': 552539}}
[[ 34735 122928  27433]
 [ 44443 106755  31720]
 [ 33965 123894  26666]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1559892
{'0': {'precision': 0.38388254486133766, 'recall': 0.0698453026867231, 'f1-score': 0.11818711453080741, 'support': 84229}, '1': {'precision': 0.23802849949583668, 'recall': 0.6845397676496873, 'f1-score': 0.35323125570539904, 'support': 54831}, '2': {'precision': 0.35287483364536576, 'recall': 0.19983394009069425, 'f1-score': 0.2551664519075503, 'support': 78285}, 'accuracy': 0.2717384802963031, 'macro avg': {'precision': 0.3249286260008467, 'recall': 0.3180730034757015, 'f1-score': 0.24219494071458558, 'support': 217345}, 'weighted avg': {'precision': 0.3359184240673091, 'recall': 0.2717384802963031, 'f1-score': 0.22682146421118812, 'support': 217345}}
[[ 5883 62260 16086]
 [ 4694 37534 12603]
 [ 4748 57893 15644]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1816677
{'0': {'precision': 0.4551362920556479, 'recall': 0.07603842039164613, 'f1-score': 0.13030682334771862, 'support': 687968}, '1': {'precision': 0.18802596583697787, 'recall': 0.7679887471273477, 'f1-score': 0.3020912209244181, 'support': 302856}, '2': {'precision': 0.37500519858598463, 'recall': 0.1585424332420103, 'f1-score': 0.22286383863621811, 'support': 625618}, 'accuracy': 0.237613845717941, 'macro avg': {'precision': 0.33938915215953674, 'recall': 0.3341898669203347, 'f1-score': 0.21842062763611825, 'support': 1616442}, 'weighted avg': {'precision': 0.37407713905691037, 'recall': 0.237613845717941, 'f1-score': 0.1983149982796057, 'support': 1616442}}
[[ 52312 518282 117374]
 [ 22332 232590  47934]
 [ 40293 486138  99187]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1805122
{'0': {'precision': 0.32347621789168224, 'recall': 0.3062152491054225, 'f1-score': 0.31460915649294274, 'support': 181650}, '1': {'precision': 0.3014141875559109, 'recall': 0.43550480716344353, 'f1-score': 0.3562598564252082, 'support': 181812}, '2': {'precision': 0.34059663441384563, 'recall': 0.2116770080657596, 'f1-score': 0.2610896880984234, 'support': 188079}, 'accuracy': 0.3165965902806863, 'macro avg': {'precision': 0.32182901328714625, 'recall': 0.3177990214448752, 'f1-score': 0.3106529003388581, 'support': 551541}, 'weighted avg': {'precision': 0.32204178048750864, 'recall': 0.3165965902806863, 'f1-score': 0.31008856592925343, 'support': 551541}}
[[55624 88629 37397]
 [62952 79180 39680]
 [53381 94886 39812]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1805475
{'0': {'precision': 0.3163282757946688, 'recall': 0.19016215263498032, 'f1-score': 0.23753130360599192, 'support': 68084}, '1': {'precision': 0.2522776137895849, 'recall': 0.48726024986802746, 'f1-score': 0.33243694250693295, 'support': 56830}, '2': {'precision': 0.3588277876238736, 'recall': 0.21833232077764278, 'f1-score': 0.2714799671391205, 'support': 65840}, 'accuracy': 0.2883976220682135, 'macro avg': {'precision': 0.30914455906937577, 'recall': 0.29858490776021684, 'f1-score': 0.2804827377506818, 'support': 190754}, 'weighted avg': {'precision': 0.31191509828376957, 'recall': 0.2883976220682135, 'f1-score': 0.27752347921311765, 'support': 190754}}
[[12947 42436 12701]
 [16154 27691 12985]
 [11828 39637 14375]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
6082/6082 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.229886
{'0': {'precision': 0.31688947068944495, 'recall': 0.7380341517958386, 'f1-score': 0.4433975061859597, 'support': 507089}, '1': {'precision': 0.3151376756095286, 'recall': 0.20298281414115305, 'f1-score': 0.2469214536097769, 'support': 549347}, '2': {'precision': 0.37755613244067954, 'recall': 0.01656780609471429, 'f1-score': 0.03174268893887904, 'support': 500368}, 'accuracy': 0.3173469492627203, 'macro avg': {'precision': 0.33652775957988434, 'recall': 0.31919492401056865, 'f1-score': 0.24068721624487188, 'support': 1556804}, 'weighted avg': {'precision': 0.3357700188094234, 'recall': 0.3173469492627203, 'f1-score': 0.2417584895526163, 'support': 1556804}}
[[374249 126031   6809]
 [430981 111508   6858]
 [375778 116300   8290]]
Evaluating performance on  train set...
2440/2440 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1573619
{'0': {'precision': 0.3093649429644981, 'recall': 0.17897579116160509, 'f1-score': 0.22676312482438993, 'support': 205173}, '1': {'precision': 0.32725565201456813, 'recall': 0.6930962048774335, 'f1-score': 0.4445910474978334, 'support': 206133}, '2': {'precision': 0.3322465702044173, 'recall': 0.1079843023991823, 'f1-score': 0.16299363057324842, 'support': 213281}, 'accuracy': 0.32440956984375274, 'macro avg': {'precision': 0.3229557217278278, 'recall': 0.3266854328127403, 'f1-score': 0.27811593429849063, 'support': 624587}, 'weighted avg': {'precision': 0.3230829388049099, 'recall': 0.32440956984375274, 'f1-score': 0.2768773630026857, 'support': 624587}}
[[ 36721 144986  23466]
 [ 40441 142870  22822]
 [ 41536 148714  23031]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1441528
{'0': {'precision': 0.33789176448624303, 'recall': 0.1974822008238086, 'f1-score': 0.24927476349112068, 'support': 73318}, '1': {'precision': 0.34766475454838036, 'recall': 0.7483597538612006, 'f1-score': 0.47476732161323676, 'support': 73617}, '2': {'precision': 0.3011655472145397, 'recall': 0.047269119265770584, 'f1-score': 0.08171305291650476, 'support': 64503}, 'accuracy': 0.3434576566180157, 'macro avg': {'precision': 0.32890735541638766, 'recall': 0.3310370246502599, 'f1-score': 0.26858504600695404, 'support': 211438}, 'weighted avg': {'precision': 0.33009045638045165, 'recall': 0.3434576566180157, 'f1-score': 0.27666743951946643, 'support': 211438}}
[[14479 55335  3504]
 [14954 55092  3571]
 [13418 48036  3049]]
testing model on single stock: results/universal/W3/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
13689/13689 - 89s - 89s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1194837
{'0': {'precision': 0.3336643390625495, 'recall': 0.02700560546935118, 'f1-score': 0.04996705512354131, 'support': 1169572}, '1': {'precision': 0.3396386058190336, 'recall': 0.8461654515571664, 'f1-score': 0.4847182845621409, 'support': 1186450}, '2': {'precision': 0.32120194225687076, 'recall': 0.1269168733626888, 'f1-score': 0.18194257776434947, 'support': 1148224}, 'accuracy': 0.33709020428360337, 'macro avg': {'precision': 0.33150162904615127, 'recall': 0.33336264346306876, 'f1-score': 0.23887597248334388, 'support': 3504246}, 'weighted avg': {'precision': 0.3316035664122923, 'recall': 0.33709020428360337, 'f1-score': 0.24040689829555198, 'support': 3504246}}
[[  31585  980457  157530]
 [  32077 1003933  150440]
 [  30999  971496  145729]]
Evaluating performance on  train set...
5475/5475 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1517513
{'0': {'precision': 0.3182695254663104, 'recall': 0.15716526973678602, 'f1-score': 0.21042177107606777, 'support': 469124}, '1': {'precision': 0.31910404446992086, 'recall': 0.6481948934981793, 'f1-score': 0.4276684363047236, 'support': 465485}, '2': {'precision': 0.3295642446148978, 'recall': 0.15835291043929098, 'f1-score': 0.21391933762074622, 'support': 466957}, 'accuracy': 0.32064062627089984, 'macro avg': {'precision': 0.3223126048503764, 'recall': 0.3212376912247521, 'f1-score': 0.2840031816671792, 'support': 1401566}, 'weighted avg': {'precision': 0.3223097235360856, 'recall': 0.32064062627089984, 'f1-score': 0.2837385304330758, 'support': 1401566}}
[[ 73730 323595  71799]
 [ 85134 301725  78626]
 [ 72795 320218  73944]]
Evaluating performance on  val set...
2036/2036 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1625642
{'0': {'precision': 0.33708560118753095, 'recall': 0.07949937275724246, 'f1-score': 0.12865607516347585, 'support': 171385}, '1': {'precision': 0.3011037121769208, 'recall': 0.4981553972232392, 'f1-score': 0.37533870450962376, 'support': 177545}, '2': {'precision': 0.3139527424355822, 'recall': 0.34087505659194595, 'f1-score': 0.32686046317476747, 'support': 172286}, 'accuracy': 0.3085054948428291, 'macro avg': {'precision': 0.317380685266678, 'recall': 0.3061766088574759, 'f1-score': 0.2769517476159557, 'support': 521216}, 'weighted avg': {'precision': 0.31718238987527836, 'recall': 0.3085054948428291, 'f1-score': 0.27820081020648146, 'support': 521216}}
[[ 13625 104570  53190]
 [ 13958  88445  75142]
 [ 12837 100721  58728]]
training model: results/universal/W3/deepOF_L1/h300
Epoch 1/50
10532/10532 - 148s - loss: 3.2753 - accuracy300: 0.3756 - val_loss: 3.2889 - val_accuracy300: 0.3507 - 148s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 149s - loss: 3.2727 - accuracy300: 0.3759 - val_loss: 3.2859 - val_accuracy300: 0.3521 - 149s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 146s - loss: 3.2719 - accuracy300: 0.3764 - val_loss: 3.2852 - val_accuracy300: 0.3537 - 146s/epoch - 14ms/step
Epoch 4/50
10532/10532 - 144s - loss: 3.2707 - accuracy300: 0.3775 - val_loss: 3.2851 - val_accuracy300: 0.3529 - 144s/epoch - 14ms/step
Epoch 5/50
10532/10532 - 146s - loss: 3.2698 - accuracy300: 0.3782 - val_loss: 3.2843 - val_accuracy300: 0.3555 - 146s/epoch - 14ms/step
Epoch 6/50
10532/10532 - 146s - loss: 3.2690 - accuracy300: 0.3789 - val_loss: 3.2842 - val_accuracy300: 0.3560 - 146s/epoch - 14ms/step
Epoch 7/50
10532/10532 - 147s - loss: 3.2683 - accuracy300: 0.3793 - val_loss: 3.2843 - val_accuracy300: 0.3566 - 147s/epoch - 14ms/step
Epoch 8/50
10532/10532 - 146s - loss: 3.2678 - accuracy300: 0.3801 - val_loss: 3.2841 - val_accuracy300: 0.3587 - 146s/epoch - 14ms/step
Epoch 9/50
10532/10532 - 140s - loss: 3.2672 - accuracy300: 0.3805 - val_loss: 3.2844 - val_accuracy300: 0.3589 - 140s/epoch - 13ms/step
Epoch 10/50
10532/10532 - 147s - loss: 3.2666 - accuracy300: 0.3808 - val_loss: 3.2843 - val_accuracy300: 0.3602 - 147s/epoch - 14ms/step
Epoch 11/50
10532/10532 - 144s - loss: 3.2662 - accuracy300: 0.3812 - val_loss: 3.2848 - val_accuracy300: 0.3593 - 144s/epoch - 14ms/step
Epoch 12/50
10532/10532 - 144s - loss: 3.2657 - accuracy300: 0.3818 - val_loss: 3.2859 - val_accuracy300: 0.3606 - 144s/epoch - 14ms/step
Epoch 13/50
10532/10532 - 143s - loss: 3.2651 - accuracy300: 0.3825 - val_loss: 3.2849 - val_accuracy300: 0.3602 - 143s/epoch - 14ms/step
Epoch 14/50
10532/10532 - 144s - loss: 3.2648 - accuracy300: 0.3826 - val_loss: 3.2849 - val_accuracy300: 0.3609 - 144s/epoch - 14ms/step
Epoch 15/50
10532/10532 - 145s - loss: 3.2643 - accuracy300: 0.3830 - val_loss: 3.2863 - val_accuracy300: 0.3599 - 145s/epoch - 14ms/step
Epoch 16/50
10532/10532 - 147s - loss: 3.2637 - accuracy300: 0.3834 - val_loss: 3.2871 - val_accuracy300: 0.3591 - 147s/epoch - 14ms/step
Epoch 17/50
10532/10532 - 146s - loss: 3.2633 - accuracy300: 0.3835 - val_loss: 3.2863 - val_accuracy300: 0.3604 - 146s/epoch - 14ms/step
Epoch 18/50
10532/10532 - 145s - loss: 3.2628 - accuracy300: 0.3841 - val_loss: 3.2864 - val_accuracy300: 0.3609 - 145s/epoch - 14ms/step
testing model in sample: results/universal/W3/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 142s - 142s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970651
{'0': {'precision': 0.3753524885444648, 'recall': 0.14428591349509978, 'f1-score': 0.2084452437684679, 'support': 2373669}, '1': {'precision': 0.340392513094584, 'recall': 0.4749861488711849, 'f1-score': 0.3965807211819545, 'support': 2407746}, '2': {'precision': 0.3581938931785959, 'recall': 0.4373195802939816, 'f1-score': 0.39382162151180866, 'support': 2305042}, 'accuracy': 0.351963329488911, 'macro avg': {'precision': 0.3579796316058816, 'recall': 0.3521972142200887, 'f1-score': 0.33294919548741037, 'support': 7086457}, 'weighted avg': {'precision': 0.3578929845879909, 'recall': 0.351963329488911, 'f1-score': 0.3326656799761071, 'support': 7086457}}
[[ 342487 1180879  850303]
 [ 308213 1143646  955887]
 [ 261741 1035261 1008040]]
Evaluating performance on  train set...
10532/10532 - 57s - 57s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966369
{'0': {'precision': 0.38112045947866846, 'recall': 0.1751005256567952, 'f1-score': 0.2399564006993425, 'support': 906485}, '1': {'precision': 0.3313148518762677, 'recall': 0.44441764831093783, 'f1-score': 0.3796209834854258, 'support': 883212}, '2': {'precision': 0.36909060013959283, 'recall': 0.44587608955243646, 'f1-score': 0.4038660121016555, 'support': 906106}, 'accuracy': 0.35434785108555783, 'macro avg': {'precision': 0.360508637164843, 'recall': 0.3551314211733898, 'f1-score': 0.34114779876214124, 'support': 2695803}, 'weighted avg': {'precision': 0.3607594620215011, 'recall': 0.35434785108555783, 'f1-score': 0.340806840379455, 'support': 2695803}}
[[158726 413816 333943]
 [134039 392515 356658]
 [123707 378388 404011]]
Evaluating performance on  val set...
3814/3814 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948427
{'0': {'precision': 0.37716091718340133, 'recall': 0.1659717857609568, 'f1-score': 0.23050746384749507, 'support': 321398}, '1': {'precision': 0.34549648157227797, 'recall': 0.4505930633651655, 'f1-score': 0.3911075556852649, 'support': 333101}, '2': {'precision': 0.3661337986969153, 'recall': 0.45573622543451536, 'f1-score': 0.4060506662193318, 'support': 321335}, 'accuracy': 0.3585445885263272, 'macro avg': {'precision': 0.36293039915086484, 'recall': 0.35743369152021254, 'f1-score': 0.3425552285840306, 'support': 975834}, 'weighted avg': {'precision': 0.36272111053047085, 'recall': 0.3585445885263272, 'f1-score': 0.3431334085526469, 'support': 975834}}
[[ 53343 149681 118374]
 [ 47852 150093 135156]
 [ 40238 134653 146444]]
testing model out of sample: results/universal/W3/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 87s - 87s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951465
{'0': {'precision': 0.3739673404977504, 'recall': 0.16904268782114001, 'f1-score': 0.23283711570033264, 'support': 1365448}, '1': {'precision': 0.3599380002060935, 'recall': 0.45813326447480685, 'f1-score': 0.40314231329778494, 'support': 1463871}, '2': {'precision': 0.3477319362268221, 'recall': 0.4405412187367075, 'f1-score': 0.3886730126846113, 'support': 1307124}, 'accuracy': 0.35714477390356886, 'macro avg': {'precision': 0.3605457589768886, 'recall': 0.3559057236775514, 'f1-score': 0.3415508138942429, 'support': 4136443}, 'weighted avg': {'precision': 0.36071197327177357, 'recall': 0.35714477390356886, 'f1-score': 0.3423519043537381, 'support': 4136443}}
[[230819 632098 502531]
 [215602 670648 577621]
 [170796 560486 575842]]
Evaluating performance on  train set...
6181/6181 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977566
{'0': {'precision': 0.37429528209910556, 'recall': 0.150897753338093, 'f1-score': 0.21508402946275004, 'support': 526648}, '1': {'precision': 0.3356781587861352, 'recall': 0.4854990901577891, 'f1-score': 0.39692147069612577, 'support': 521519}, '2': {'precision': 0.3681749095785752, 'recall': 0.4244507244964506, 'f1-score': 0.3943150470887989, 'support': 533612}, 'accuracy': 0.35350007807664663, 'macro avg': {'precision': 0.3593827834879386, 'recall': 0.3536158559974442, 'f1-score': 0.3354401824158915, 'support': 1581779}, 'weighted avg': {'precision': 0.3594983555028603, 'recall': 0.35350007807664663, 'f1-score': 0.3355000308713286, 'support': 1581779}}
[[ 79470 258229 188949]
 [ 68588 253197 199734]
 [ 64261 242859 226492]]
Evaluating performance on  val set...
2209/2209 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975018
{'0': {'precision': 0.38225454545454546, 'recall': 0.1380571140389586, 'f1-score': 0.20285134269372385, 'support': 190356}, '1': {'precision': 0.3444472702914722, 'recall': 0.5020466340179811, 'f1-score': 0.4085761085015392, 'support': 191534}, '2': {'precision': 0.3547763679216999, 'recall': 0.42069395523857445, 'f1-score': 0.38493355319622763, 'support': 182836}, 'accuracy': 0.3530154446581174, 'macro avg': {'precision': 0.3604927278892392, 'recall': 0.3535992344318381, 'f1-score': 0.3321203347971636, 'support': 564726}, 'weighted avg': {'precision': 0.36053537773696315, 'recall': 0.3530154446581174, 'f1-score': 0.33157654807415593, 'support': 564726}}
[[26280 96420 67656]
 [23142 96159 72233]
 [19328 86590 76918]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955588
{'0': {'precision': 0.3103919022408684, 'recall': 0.17733559076987462, 'f1-score': 0.2257142857142857, 'support': 52567}, '1': {'precision': 0.42763475830361924, 'recall': 0.44477198320948746, 'f1-score': 0.43603505220541233, 'support': 73613}, '2': {'precision': 0.27846149239429874, 'recall': 0.39397983392645314, 'f1-score': 0.32629824561403514, 'support': 47208}, 'accuracy': 0.3498627355987727, 'macro avg': {'precision': 0.3388293843129288, 'recall': 0.33869580263527177, 'f1-score': 0.3293491945112444, 'support': 173388}, 'weighted avg': {'precision': 0.3514744891287177, 'recall': 0.3498627355987727, 'f1-score': 0.3423931225580043, 'support': 173388}}
[[ 9322 22979 20266]
 [12945 32741 27927]
 [ 7766 20843 18599]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979477
{'0': {'precision': 0.3631375371053342, 'recall': 0.18438841691787705, 'f1-score': 0.2445851382872376, 'support': 21894}, '1': {'precision': 0.33166992116872784, 'recall': 0.4173833902161547, 'f1-score': 0.3696225996896976, 'support': 21975}, '2': {'precision': 0.3578893888808245, 'recall': 0.4391308219788049, 'f1-score': 0.39436957651857474, 'support': 22458}, 'accuracy': 0.3478372306903674, 'macro avg': {'precision': 0.35089894905162883, 'recall': 0.34696754303761224, 'f1-score': 0.33619243816516997, 'support': 66327}, 'weighted avg': {'precision': 0.35093490811513467, 'recall': 0.3478372306903674, 'f1-score': 0.3367279629004182, 'support': 66327}}
[[4037 9254 8603]
 [3712 9172 9091]
 [3368 9228 9862]]
Evaluating performance on  val set...
86/86 - 1s - 601ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003677
{'0': {'precision': 0.3391845979614949, 'recall': 0.16372830394970617, 'f1-score': 0.22084984791224999, 'support': 7317}, '1': {'precision': 0.3807139747496735, 'recall': 0.43158544108574953, 'f1-score': 0.40455675706933436, 'support': 8105}, '2': {'precision': 0.31484697199913175, 'recall': 0.445485257985258, 'f1-score': 0.368943151468905, 'support': 6512}, 'accuracy': 0.34635725357891856, 'macro avg': {'precision': 0.3449151815701001, 'recall': 0.34693300100690455, 'f1-score': 0.3314499188168298, 'support': 21934}, 'weighted avg': {'precision': 0.34730482129519047, 'recall': 0.34635725357891856, 'f1-score': 0.3327003125552292, 'support': 21934}}
[[1198 3061 3058]
 [1352 3498 3255]
 [ 982 2629 2901]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0862967
{'0': {'precision': 0.4016269170214007, 'recall': 0.22702925422332096, 'f1-score': 0.2900824444842218, 'support': 121350}, '1': {'precision': 0.3677455633002126, 'recall': 0.4405466026101311, 'f1-score': 0.4008675708353401, 'support': 135089}, '2': {'precision': 0.3612765681607018, 'recall': 0.44456261632544536, 'f1-score': 0.39861565297551166, 'support': 112830}, 'accuracy': 0.37160714817653256, 'macro avg': {'precision': 0.3768830161607717, 'recall': 0.37071282438629916, 'f1-score': 0.3631885560983579, 'support': 369269}, 'weighted avg': {'precision': 0.37690313014843213, 'recall': 0.37160714817653256, 'f1-score': 0.36377304360767504, 'support': 369269}}
[[27550 56271 37529]
 [24424 59513 51152]
 [16622 46048 50160]]
Evaluating performance on  train set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949907
{'0': {'precision': 0.3982137022110881, 'recall': 0.19239067515655423, 'f1-score': 0.2594379789951745, 'support': 57009}, '1': {'precision': 0.3206011188515938, 'recall': 0.46875783706618823, 'f1-score': 0.3807755290725462, 'support': 51837}, '2': {'precision': 0.3766114028877657, 'recall': 0.4141920764829434, 'f1-score': 0.39450878267093226, 'support': 55228}, 'accuracy': 0.354364494069749, 'macro avg': {'precision': 0.3651420746501492, 'recall': 0.3584468629018953, 'f1-score': 0.34490743024621767, 'support': 164074}, 'weighted avg': {'precision': 0.36642161284510355, 'recall': 0.354364494069749, 'f1-score': 0.3432383674099475, 'support': 164074}}
[[10968 27236 18805]
 [ 8479 24299 19059]
 [ 8096 24257 22875]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.089601
{'0': {'precision': 0.3924864063272368, 'recall': 0.2089198789632943, 'f1-score': 0.27268824590023183, 'support': 22803}, '1': {'precision': 0.3294338900930766, 'recall': 0.4519613416714042, 'f1-score': 0.3810910968122569, 'support': 22867}, '2': {'precision': 0.4022997144145498, 'recall': 0.437837395714052, 'f1-score': 0.4193169356102146, 'support': 24452}, 'accuracy': 0.36800148312940306, 'macro avg': {'precision': 0.3747400036116211, 'recall': 0.3662395387829169, 'f1-score': 0.3576987594409011, 'support': 70122}, 'weighted avg': {'precision': 0.37534675144894514, 'recall': 0.36800148312940306, 'f1-score': 0.35916913224964825, 'support': 70122}}
[[ 4764 10771  7268]
 [ 3894 10335  8638]
 [ 3480 10266 10706]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
1359/1359 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0900583
{'0': {'precision': 0.336727293014952, 'recall': 0.11834313725490196, 'f1-score': 0.17513493122859963, 'support': 102000}, '1': {'precision': 0.4285890741676492, 'recall': 0.518403824735827, 'f1-score': 0.4692373417916045, 'support': 147252}, '2': {'precision': 0.29755900746419206, 'recall': 0.4041300928509818, 'f1-score': 0.34275165243734507, 'support': 98545}, 'accuracy': 0.36869783235623077, 'macro avg': {'precision': 0.35429179154893103, 'recall': 0.34695901828057024, 'f1-score': 0.3290413084858497, 'support': 347797}, 'weighted avg': {'precision': 0.36452222022449476, 'recall': 0.36869783235623077, 'f1-score': 0.34714606977131107, 'support': 347797}}
[[12071 52965 36964]
 [13866 76336 57050]
 [ 9911 48809 39825]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988708
{'0': {'precision': 0.35729686026142027, 'recall': 0.14199266340000535, 'f1-score': 0.20322290137768495, 'support': 37347}, '1': {'precision': 0.335897782846539, 'recall': 0.46826915303565175, 'f1-score': 0.391188852119493, 'support': 37109}, '2': {'precision': 0.36991895858592305, 'recall': 0.4444188899110702, 'f1-score': 0.4037611004701376, 'support': 39132}, 'accuracy': 0.3527749410148959, 'macro avg': {'precision': 0.3543712005646274, 'recall': 0.35156023544890913, 'f1-score': 0.33272428465577186, 'support': 113588}, 'weighted avg': {'precision': 0.3546542359335477, 'recall': 0.3527749410148959, 'f1-score': 0.3337181057387408, 'support': 113588}}
[[ 5303 17472 14572]
 [ 4682 17377 15050]
 [ 4857 16884 17391]]
Evaluating performance on  val set...
144/144 - 1s - 982ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024762
{'0': {'precision': 0.36299161831076726, 'recall': 0.13141923436041084, 'f1-score': 0.19297343616109683, 'support': 12852}, '1': {'precision': 0.3190619499176651, 'recall': 0.4953715948161862, 'f1-score': 0.3881329004628031, 'support': 11343}, '2': {'precision': 0.3711920990402003, 'recall': 0.4287780187997108, 'f1-score': 0.39791239515377447, 'support': 12447}, 'accuracy': 0.34509579171442606, 'macro avg': {'precision': 0.3510818890895442, 'recall': 0.3518562826587693, 'f1-score': 0.3263395772592248, 'support': 36642}, 'weighted avg': {'precision': 0.3521782662845759, 'recall': 0.34509579171442606, 'f1-score': 0.3230037026901103, 'support': 36642}}
[[1689 6373 4790]
 [1473 5619 4251]
 [1491 5619 5337]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0912726
{'0': {'precision': 0.34280081325857925, 'recall': 0.18945146242636793, 'f1-score': 0.24403508771929824, 'support': 88107}, '1': {'precision': 0.3844178448632531, 'recall': 0.4868991687748464, 'f1-score': 0.42963175559860645, 'support': 110680}, '2': {'precision': 0.34927279453281673, 'recall': 0.3865580623612817, 'f1-score': 0.36697078798788973, 'support': 92814}, 'accuracy': 0.3650879112211549, 'macro avg': {'precision': 0.35883048421821634, 'recall': 0.35430289785416536, 'f1-score': 0.3468792104352649, 'support': 291601}, 'weighted avg': {'precision': 0.3606569369618326, 'recall': 0.3650879112211549, 'f1-score': 0.35360944886898865, 'support': 291601}}
[[16692 43613 27802]
 [17748 53890 39042]
 [14253 42683 35878]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967776
{'0': {'precision': 0.3800189693329118, 'recall': 0.184843452051424, 'f1-score': 0.2487119534854849, 'support': 32514}, '1': {'precision': 0.33649469796258785, 'recall': 0.4334520228374977, 'f1-score': 0.37886857250177747, 'support': 32578}, '2': {'precision': 0.3741818002854471, 'recall': 0.45628038168397045, 'f1-score': 0.4111730030825807, 'support': 33326}, 'accuracy': 0.3590501737487045, 'macro avg': {'precision': 0.3635651558603156, 'recall': 0.358191952190964, 'f1-score': 0.34625117635661434, 'support': 98418}, 'weighted avg': {'precision': 0.3636351451505649, 'recall': 0.3590501737487045, 'f1-score': 0.3468080260858791, 'support': 98418}}
[[ 6010 14275 12229]
 [ 5254 14121 13203]
 [ 4551 13569 15206]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947124
{'0': {'precision': 0.3573867163252638, 'recall': 0.2063435176059493, 'f1-score': 0.2616302186878728, 'support': 11161}, '1': {'precision': 0.39191300168228793, 'recall': 0.4768623437385774, 'f1-score': 0.43023447548065824, 'support': 13679}, '2': {'precision': 0.3299682487991533, 'recall': 0.38486373563764126, 'f1-score': 0.3553081441220304, 'support': 10531}, 'accuracy': 0.36411184303525485, 'macro avg': {'precision': 0.35975598893556837, 'recall': 0.35602319899405593, 'f1-score': 0.3490576127635205, 'support': 35371}, 'weighted avg': {'precision': 0.3625757462051446, 'recall': 0.36411184303525485, 'f1-score': 0.3547251230280279, 'support': 35371}}
[[2303 5355 3503]
 [2429 6523 4727]
 [1712 4766 4053]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
2282/2282 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984427
{'0': {'precision': 0.36619924470856874, 'recall': 0.12872255037148325, 'f1-score': 0.19048706761993953, 'support': 194356}, '1': {'precision': 0.34913484860772187, 'recall': 0.46799847811800516, 'f1-score': 0.3999214631499611, 'support': 202381}, '2': {'precision': 0.3472631970899092, 'recall': 0.45322396317301633, 'f1-score': 0.39323054825145665, 'support': 187254}, 'accuracy': 0.35034786494997355, 'macro avg': {'precision': 0.35419909680206657, 'recall': 0.34998166388750157, 'f1-score': 0.3278796930071191, 'support': 583991}, 'weighted avg': {'precision': 0.35421385416647144, 'recall': 0.35034786494997355, 'f1-score': 0.3280749244943355, 'support': 583991}}
[[25018 93804 75534]
 [23678 94714 83989]
 [19622 82764 84868]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992886
{'0': {'precision': 0.3617003331505925, 'recall': 0.1153768546792397, 'f1-score': 0.17494798678252355, 'support': 74339}, '1': {'precision': 0.3372562029648513, 'recall': 0.5211607733092293, 'f1-score': 0.4095089179233032, 'support': 74123}, '2': {'precision': 0.3695511412251694, 'recall': 0.4190012978670407, 'f1-score': 0.39272570884403896, 'support': 76279}, 'accuracy': 0.352263271944149, 'macro avg': {'precision': 0.35616922578020443, 'recall': 0.35184630861850325, 'f1-score': 0.3257275378499553, 'support': 224741}, 'weighted avg': {'precision': 0.35630291802546166, 'recall': 0.352263271944149, 'f1-score': 0.326225353885448, 'support': 224741}}
[[ 8577 39197 26565]
 [ 7533 38630 27960]
 [ 7603 36715 31961]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998149
{'0': {'precision': 0.3719172633253779, 'recall': 0.10883060448514006, 'f1-score': 0.16838756153199663, 'support': 25774}, '1': {'precision': 0.3372512656007218, 'recall': 0.5194549525206515, 'f1-score': 0.4089776318988572, 'support': 25906}, '2': {'precision': 0.3586204591785583, 'recall': 0.4177599563981781, 'f1-score': 0.3859377809746448, 'support': 25687}, 'accuracy': 0.34889552393139195, 'macro avg': {'precision': 0.35592966270155263, 'recall': 0.3486818378013232, 'f1-score': 0.3211009914684996, 'support': 77367}, 'weighted avg': {'precision': 0.3558947686548556, 'recall': 0.34889552393139195, 'f1-score': 0.32117801288395803, 'support': 77367}}
[[ 2805 13775  9194]
 [ 2451 13457  9998]
 [ 2286 12670 10731]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/EXC
Evaluating performance on  test set...
5098/5098 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999403
{'0': {'precision': 0.4213474232038589, 'recall': 0.11394281619614212, 'f1-score': 0.17937749827326782, 'support': 466111}, '1': {'precision': 0.31267456519770703, 'recall': 0.55687600636132, 'f1-score': 0.40048496051443633, 'support': 403061}, '2': {'precision': 0.37895549713234594, 'recall': 0.40093175898195005, 'f1-score': 0.38963399606797516, 'support': 435735}, 'accuracy': 0.3465879177596564, 'macro avg': {'precision': 0.3709924951779706, 'recall': 0.3572501938464707, 'f1-score': 0.32316548495189307, 'support': 1304907}, 'weighted avg': {'precision': 0.37362491368587153, 'recall': 0.3465879177596564, 'f1-score': 0.31788231885049245, 'support': 1304907}}
[[ 53110 266554 146447]
 [ 38749 224455 139857]
 [ 34189 226846 174700]]
Evaluating performance on  train set...
1876/1876 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947284
{'0': {'precision': 0.41252877690244366, 'recall': 0.12038361027562744, 'f1-score': 0.1863784918533362, 'support': 162248}, '1': {'precision': 0.3332889288529213, 'recall': 0.5717940578974099, 'f1-score': 0.4211163658380926, 'support': 157520}, '2': {'precision': 0.3797558650800972, 'recall': 0.3849112112542618, 'f1-score': 0.3823161596275522, 'support': 160437}, 'accuracy': 0.3568371841192824, 'macro avg': {'precision': 0.3751911902784874, 'recall': 0.3590296264757664, 'f1-score': 0.3299370057729936, 'support': 480205}, 'weighted avg': {'precision': 0.37558653657008023, 'recall': 0.3568371841192824, 'f1-score': 0.328841734665824, 'support': 480205}}
[[19532 94216 48500]
 [15090 90069 52361]
 [12725 85958 61754]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0909779
{'0': {'precision': 0.40630360205831906, 'recall': 0.1116216057018319, 'f1-score': 0.17513053925419345, 'support': 50931}, '1': {'precision': 0.354697599512503, 'recall': 0.5880357916005196, 'f1-score': 0.44248964908708344, 'support': 55432}, '2': {'precision': 0.3767958538165466, 'recall': 0.38022265377146264, 'f1-score': 0.37850149773664715, 'support': 52009}, 'accuracy': 0.36657995100143964, 'macro avg': {'precision': 0.3792656851291229, 'recall': 0.3599600170246047, 'f1-score': 0.3320405620259747, 'support': 158372}, 'weighted avg': {'precision': 0.3785506380784109, 'recall': 0.36657995100143964, 'f1-score': 0.3354958207179035, 'support': 158372}}
[[ 5685 30600 14646]
 [ 4775 32596 18061]
 [ 3532 28702 19775]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/AAL
Evaluating performance on  test set...
5760/5760 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911208
{'0': {'precision': 0.36860274895350514, 'recall': 0.1947084276718903, 'f1-score': 0.2548149749636547, 'support': 472147}, '1': {'precision': 0.38868397071495436, 'recall': 0.4452603340926078, 'f1-score': 0.4150530285039069, 'support': 563257}, '2': {'precision': 0.33473721971856735, 'recall': 0.44204817987395884, 'f1-score': 0.3809803294198935, 'support': 439063}, 'accuracy': 0.36407325494568543, 'macro avg': {'precision': 0.3640079797956756, 'recall': 0.3606723138794856, 'f1-score': 0.3502827776291517, 'support': 1474467}, 'weighted avg': {'precision': 0.3661895297110325, 'recall': 0.36407325494568543, 'f1-score': 0.3535962595543179, 'support': 1474467}}
[[ 91931 212825 167391]
 [ 94120 250796 218341]
 [ 63353 181623 194087]]
Evaluating performance on  train set...
2159/2159 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970399
{'0': {'precision': 0.388982021193153, 'recall': 0.13671425250947303, 'f1-score': 0.2023198144148468, 'support': 184999}, '1': {'precision': 0.3336124577640664, 'recall': 0.4990440610921877, 'f1-score': 0.39989434294519044, 'support': 182020}, '2': {'precision': 0.3684310782997347, 'recall': 0.4274494795681305, 'f1-score': 0.3957520286658216, 'support': 185519}, 'accuracy': 0.35369151081011624, 'macro avg': {'precision': 0.363675185752318, 'recall': 0.3544025977232637, 'f1-score': 0.33265539534195293, 'support': 552538}, 'weighted avg': {'precision': 0.3638417443072077, 'recall': 0.35369151081011624, 'f1-score': 0.33235225858831496, 'support': 552538}}
[[25292 93986 65721]
 [20968 90836 70216]
 [18761 87458 79300]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958062
{'0': {'precision': 0.38429172510518933, 'recall': 0.12588580895763432, 'f1-score': 0.1896472167456689, 'support': 71827}, '1': {'precision': 0.35246557796990075, 'recall': 0.5256616037673277, 'f1-score': 0.4219835687625457, 'support': 75385}, '2': {'precision': 0.3566987762323684, 'recall': 0.41394208147377126, 'f1-score': 0.3831944086958244, 'support': 70133}, 'accuracy': 0.3574961466792427, 'macro avg': {'precision': 0.3644853597691528, 'recall': 0.35516316473291115, 'f1-score': 0.33160839806801296, 'support': 217345}, 'weighted avg': {'precision': 0.3643492815933014, 'recall': 0.3574961466792427, 'f1-score': 0.3326858010693594, 'support': 217345}}
[[ 9042 38112 24673]
 [ 8074 39627 27684]
 [ 6413 34689 29031]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/WBA
Evaluating performance on  test set...
6315/6315 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980297
{'0': {'precision': 0.3960190259538827, 'recall': 0.13580074000925454, 'f1-score': 0.20224775468766293, 'support': 564047}, '1': {'precision': 0.32823363005242984, 'recall': 0.5033793300360833, 'f1-score': 0.3973627942823734, 'support': 521849}, '2': {'precision': 0.3665671018612195, 'recall': 0.4302486890764539, 'f1-score': 0.39586317647834124, 'support': 530542}, 'accuracy': 0.35111213668572505, 'macro avg': {'precision': 0.363606585955844, 'recall': 0.3564762530405972, 'f1-score': 0.3318245751494592, 'support': 1616438}, 'weighted avg': {'precision': 0.36446865174977033, 'recall': 0.35111213668572505, 'f1-score': 0.32878629276034504, 'support': 1616438}}
[[ 76598 289987 197462]
 [ 62178 262688 196983]
 [ 54644 247633 228265]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953424
{'0': {'precision': 0.3855161917646064, 'recall': 0.1496209842377572, 'f1-score': 0.21557579864777546, 'support': 182842}, '1': {'precision': 0.33589158440194256, 'recall': 0.5006532848928558, 'f1-score': 0.40204711372017765, 'support': 181391}, '2': {'precision': 0.3775474283104675, 'recall': 0.4237138830162086, 'f1-score': 0.3993006641175287, 'support': 187308}, 'accuracy': 0.3581528843730566, 'macro avg': {'precision': 0.3663184014923388, 'recall': 0.3579960507156072, 'f1-score': 0.3389745254951606, 'support': 551541}, 'weighted avg': {'precision': 0.3664893736328831, 'recall': 0.3581528843730566, 'f1-score': 0.3392970730656458, 'support': 551541}}
[[27357 92726 62759]
 [22489 90814 68088]
 [21116 86827 79365]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966449
{'0': {'precision': 0.3933166628779268, 'recall': 0.13307592911641644, 'f1-score': 0.19886670574577886, 'support': 65008}, '1': {'precision': 0.3299184656330531, 'recall': 0.5076790560855504, 'f1-score': 0.39993598566078803, 'support': 61531}, '2': {'precision': 0.3777573777573778, 'recall': 0.43576167190955245, 'f1-score': 0.4046916579891242, 'support': 64214}, 'accuracy': 0.35580567540222174, 'macro avg': {'precision': 0.36699750208945253, 'recall': 0.35883888570383976, 'f1-score': 0.33449811646523037, 'support': 190753}, 'weighted avg': {'precision': 0.367628582431458, 'recall': 0.35580567540222174, 'f1-score': 0.33301315348607446, 'support': 190753}}
[[ 8651 33598 22759]
 [ 6960 31238 23333]
 [ 6384 29848 27982]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
6082/6082 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987718
{'0': {'precision': 0.39536336562489305, 'recall': 0.16973132639452734, 'f1-score': 0.2375019599476662, 'support': 544378}, '1': {'precision': 0.31213311770032603, 'recall': 0.4520139598800087, 'f1-score': 0.36927060426161107, 'support': 477368}, '2': {'precision': 0.37848172992000606, 'recall': 0.44691563842154247, 'f1-score': 0.4098617476766548, 'support': 535054}, 'accuracy': 0.35155382836587873, 'macro avg': {'precision': 0.3619927377484084, 'recall': 0.35622030823202616, 'f1-score': 0.3388781039619773, 'support': 1556800}, 'weighted avg': {'precision': 0.36404011042082235, 'recall': 0.35155382836587873, 'f1-score': 0.33714477088189376, 'support': 1556800}}
[[ 92398 249659 202321]
 [ 71238 215777 190353]
 [ 70068 225862 239124]]
Evaluating performance on  train set...
2440/2440 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975126
{'0': {'precision': 0.3736200834082918, 'recall': 0.1756724932594476, 'f1-score': 0.23897927760942267, 'support': 208069}, '1': {'precision': 0.3380848881083619, 'recall': 0.47126403350590423, 'f1-score': 0.3937170824162139, 'support': 206292}, '2': {'precision': 0.36711427353071513, 'recall': 0.41771158383438617, 'f1-score': 0.3907819376888537, 'support': 210224}, 'accuracy': 0.35476836619515356, 'macro avg': {'precision': 0.3596064150157896, 'recall': 0.354882703533246, 'f1-score': 0.3411594325714968, 'support': 624585}, 'weighted avg': {'precision': 0.35969354997486513, 'recall': 0.35476836619515356, 'f1-score': 0.3411811134552097, 'support': 624585}}
[[36552 97850 73667]
 [31356 97218 77718]
 [29924 92487 87813]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972676
{'0': {'precision': 0.392167491022427, 'recall': 0.15947978949108643, 'f1-score': 0.22674919689728118, 'support': 72586}, '1': {'precision': 0.3389128869690425, 'recall': 0.4787626244791299, 'f1-score': 0.39687827497175104, 'support': 70795}, '2': {'precision': 0.3546244750463913, 'recall': 0.4268186960929809, 'f1-score': 0.38738672659016204, 'support': 68057}, 'accuracy': 0.3524342833360134, 'macro avg': {'precision': 0.36190161767928686, 'recall': 0.35502037002106573, 'f1-score': 0.3370047328197314, 'support': 211438}, 'weighted avg': {'precision': 0.362252221618439, 'recall': 0.3524342833360134, 'f1-score': 0.33541838805776547, 'support': 211438}}
[[11576 35263 25747]
 [ 9784 33894 27117]
 [ 8158 30851 29048]]
testing model on single stock: results/universal/W3/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
13689/13689 - 89s - 89s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971631
{'0': {'precision': 0.3538674514796119, 'recall': 0.14854142748052562, 'f1-score': 0.2092478002796115, 'support': 1134054}, '1': {'precision': 0.352819406909981, 'recall': 0.4388145508691122, 'f1-score': 0.3911461555172783, 'support': 1237067}, '2': {'precision': 0.3484649430491958, 'recall': 0.45809759063683403, 'f1-score': 0.39583031486155695, 'support': 1133121}, 'accuracy': 0.35111073949801413, 'macro avg': {'precision': 0.3517172671462629, 'recall': 0.34848452299549065, 'f1-score': 0.3320747568861489, 'support': 3504242}, 'weighted avg': {'precision': 0.35175053229800257, 'recall': 0.35111073949801413, 'f1-score': 0.3337942836915458, 'support': 3504242}}
[[168454 524176 441424]
 [165109 542843 529115]
 [142474 471567 519080]]
Evaluating performance on  train set...
5475/5475 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980461
{'0': {'precision': 0.3714617278529647, 'recall': 0.2007917401329174, 'f1-score': 0.2606762593886703, 'support': 471872}, '1': {'precision': 0.3284077178530447, 'recall': 0.3758801094184211, 'f1-score': 0.3505439797211661, 'support': 459886}, '2': {'precision': 0.3625335210350038, 'recall': 0.4785348025891483, 'f1-score': 0.4125346349340331, 'support': 469807}, 'accuracy': 0.3513422495567455, 'macro avg': {'precision': 0.35413432224700436, 'recall': 0.3517355507134956, 'f1-score': 0.34125162468128983, 'support': 1401565}, 'weighted avg': {'precision': 0.35434195780780164, 'recall': 0.3513422495567455, 'f1-score': 0.3410671326429756, 'support': 1401565}}
[[ 94748 186160 190964]
 [ 82674 172862 204350]
 [ 77646 167342 224819]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961212
{'0': {'precision': 0.3666958949627339, 'recall': 0.1853290183387271, 'f1-score': 0.24621856225960514, 'support': 171495}, '1': {'precision': 0.3473474622367049, 'recall': 0.38757851129226245, 'f1-score': 0.3663618300722397, 'support': 179592}, '2': {'precision': 0.3575586485528446, 'recall': 0.49210892910673665, 'f1-score': 0.41418034125032777, 'support': 170129}, 'accuracy': 0.35515218258840864, 'macro avg': {'precision': 0.3572006685840945, 'recall': 0.3550054862459087, 'f1-score': 0.34225357786072425, 'support': 521216}, 'weighted avg': {'precision': 0.3570466625435429, 'recall': 0.35515218258840864, 'f1-score': 0.3424395901077896, 'support': 521216}}
[[31783 69461 70251]
 [29810 69606 80176]
 [25081 61326 83722]]
training model: results/universal/W3/deepOF_L1/h500
Epoch 1/50
10532/10532 - 145s - loss: 3.2743 - accuracy500: 0.3741 - val_loss: 3.3019 - val_accuracy500: 0.3546 - 145s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 145s - loss: 3.2739 - accuracy500: 0.3741 - val_loss: 3.3007 - val_accuracy500: 0.3549 - 145s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 143s - loss: 3.2728 - accuracy500: 0.3755 - val_loss: 3.3001 - val_accuracy500: 0.3554 - 143s/epoch - 14ms/step
Epoch 4/50
10532/10532 - 144s - loss: 3.2717 - accuracy500: 0.3763 - val_loss: 3.3003 - val_accuracy500: 0.3561 - 144s/epoch - 14ms/step
Epoch 5/50
10532/10532 - 144s - loss: 3.2710 - accuracy500: 0.3772 - val_loss: 3.3000 - val_accuracy500: 0.3560 - 144s/epoch - 14ms/step
Epoch 6/50
10532/10532 - 143s - loss: 3.2702 - accuracy500: 0.3776 - val_loss: 3.3001 - val_accuracy500: 0.3563 - 143s/epoch - 14ms/step
Epoch 7/50
10532/10532 - 147s - loss: 3.2696 - accuracy500: 0.3783 - val_loss: 3.3000 - val_accuracy500: 0.3567 - 147s/epoch - 14ms/step
Epoch 8/50
10532/10532 - 145s - loss: 3.2691 - accuracy500: 0.3786 - val_loss: 3.2999 - val_accuracy500: 0.3568 - 145s/epoch - 14ms/step
Epoch 9/50
10532/10532 - 144s - loss: 3.2686 - accuracy500: 0.3791 - val_loss: 3.2999 - val_accuracy500: 0.3570 - 144s/epoch - 14ms/step
Epoch 10/50
10532/10532 - 142s - loss: 3.2681 - accuracy500: 0.3794 - val_loss: 3.2997 - val_accuracy500: 0.3579 - 142s/epoch - 14ms/step
Epoch 11/50
10532/10532 - 143s - loss: 3.2672 - accuracy500: 0.3799 - val_loss: 3.3002 - val_accuracy500: 0.3582 - 143s/epoch - 14ms/step
Epoch 12/50
10532/10532 - 144s - loss: 3.2669 - accuracy500: 0.3800 - val_loss: 3.2996 - val_accuracy500: 0.3583 - 144s/epoch - 14ms/step
Epoch 13/50
10532/10532 - 151s - loss: 3.2661 - accuracy500: 0.3805 - val_loss: 3.2992 - val_accuracy500: 0.3585 - 151s/epoch - 14ms/step
Epoch 14/50
10532/10532 - 146s - loss: 3.2654 - accuracy500: 0.3809 - val_loss: 3.2986 - val_accuracy500: 0.3591 - 146s/epoch - 14ms/step
Epoch 15/50
10532/10532 - 149s - loss: 3.2646 - accuracy500: 0.3817 - val_loss: 3.2985 - val_accuracy500: 0.3597 - 149s/epoch - 14ms/step
Epoch 16/50
10532/10532 - 145s - loss: 3.2643 - accuracy500: 0.3820 - val_loss: 3.2984 - val_accuracy500: 0.3607 - 145s/epoch - 14ms/step
Epoch 17/50
10532/10532 - 145s - loss: 3.2636 - accuracy500: 0.3825 - val_loss: 3.2980 - val_accuracy500: 0.3598 - 145s/epoch - 14ms/step
Epoch 18/50
10532/10532 - 144s - loss: 3.2628 - accuracy500: 0.3831 - val_loss: 3.2986 - val_accuracy500: 0.3601 - 144s/epoch - 14ms/step
Epoch 19/50
10532/10532 - 147s - loss: 3.2625 - accuracy500: 0.3834 - val_loss: 3.2991 - val_accuracy500: 0.3597 - 147s/epoch - 14ms/step
Epoch 20/50
10532/10532 - 144s - loss: 3.2617 - accuracy500: 0.3838 - val_loss: 3.2989 - val_accuracy500: 0.3602 - 144s/epoch - 14ms/step
Epoch 21/50
10532/10532 - 144s - loss: 3.2611 - accuracy500: 0.3842 - val_loss: 3.2987 - val_accuracy500: 0.3600 - 144s/epoch - 14ms/step
Epoch 22/50
10532/10532 - 143s - loss: 3.2609 - accuracy500: 0.3845 - val_loss: 3.2984 - val_accuracy500: 0.3596 - 143s/epoch - 14ms/step
Epoch 23/50
10532/10532 - 147s - loss: 3.2601 - accuracy500: 0.3850 - val_loss: 3.2986 - val_accuracy500: 0.3604 - 147s/epoch - 14ms/step
Epoch 24/50
10532/10532 - 145s - loss: 3.2593 - accuracy500: 0.3856 - val_loss: 3.2978 - val_accuracy500: 0.3602 - 145s/epoch - 14ms/step
Epoch 25/50
10532/10532 - 143s - loss: 3.2588 - accuracy500: 0.3858 - val_loss: 3.2985 - val_accuracy500: 0.3597 - 143s/epoch - 14ms/step
Epoch 26/50
10532/10532 - 143s - loss: 3.2584 - accuracy500: 0.3859 - val_loss: 3.2983 - val_accuracy500: 0.3599 - 143s/epoch - 14ms/step
Epoch 27/50
10532/10532 - 143s - loss: 3.2578 - accuracy500: 0.3868 - val_loss: 3.2983 - val_accuracy500: 0.3598 - 143s/epoch - 14ms/step
Epoch 28/50
10532/10532 - 145s - loss: 3.2571 - accuracy500: 0.3872 - val_loss: 3.2988 - val_accuracy500: 0.3594 - 145s/epoch - 14ms/step
Epoch 29/50
10532/10532 - 143s - loss: 3.2567 - accuracy500: 0.3876 - val_loss: 3.2989 - val_accuracy500: 0.3593 - 143s/epoch - 14ms/step
Epoch 30/50
10532/10532 - 149s - loss: 3.2561 - accuracy500: 0.3877 - val_loss: 3.2990 - val_accuracy500: 0.3598 - 149s/epoch - 14ms/step
Epoch 31/50
10532/10532 - 144s - loss: 3.2557 - accuracy500: 0.3884 - val_loss: 3.2992 - val_accuracy500: 0.3590 - 144s/epoch - 14ms/step
Epoch 32/50
10532/10532 - 147s - loss: 3.2551 - accuracy500: 0.3888 - val_loss: 3.3000 - val_accuracy500: 0.3589 - 147s/epoch - 14ms/step
Epoch 33/50
10532/10532 - 142s - loss: 3.2546 - accuracy500: 0.3891 - val_loss: 3.2995 - val_accuracy500: 0.3585 - 142s/epoch - 13ms/step
Epoch 34/50
10532/10532 - 142s - loss: 3.2538 - accuracy500: 0.3897 - val_loss: 3.3001 - val_accuracy500: 0.3591 - 142s/epoch - 13ms/step
testing model in sample: results/universal/W3/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 137s - 137s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997765
{'0': {'precision': 0.3724646818236448, 'recall': 0.3704410077075685, 'f1-score': 0.3714500885227983, 'support': 2451227}, '1': {'precision': 0.3462755656322328, 'recall': 0.006406279219746475, 'f1-score': 0.012579825090496322, 'support': 2288692}, '2': {'precision': 0.3466820632859234, 'recall': 0.6805297847296741, 'f1-score': 0.45935504025461027, 'support': 2346538}, 'accuracy': 0.3555494656920941, 'macro avg': {'precision': 0.3551407702472669, 'recall': 0.352459023885663, 'f1-score': 0.2811283179559683, 'support': 7086457}, 'weighted avg': {'precision': 0.3554690640060777, 'recall': 0.3555494656920941, 'f1-score': 0.28465478427858437, 'support': 7086457}}
[[ 908035   13908 1529284]
 [ 793997   14662 1480033]
 [ 735877   13772 1596889]]
Evaluating performance on  train set...
10532/10532 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996422
{'0': {'precision': 0.3667273654958975, 'recall': 0.3629422554197697, 'f1-score': 0.36482499296106674, 'support': 905020}, '1': {'precision': 0.37138032397273124, 'recall': 0.006689453014985366, 'f1-score': 0.01314218368735856, 'support': 887666}, '2': {'precision': 0.35067525719746545, 'recall': 0.6927695968517922, 'f1-score': 0.46564445760948364, 'support': 903117}, 'accuracy': 0.35613136419834834, 'macro avg': {'precision': 0.36292764888869805, 'recall': 0.3541337684288491, 'f1-score': 0.28120387808596964, 'support': 2695803}, 'weighted avg': {'precision': 0.362881884631436, 'recall': 0.35613136419834834, 'f1-score': 0.28279930335323145, 'support': 2695803}}
[[328470   4835 571715]
 [294960   5938 586768]
 [272249   5216 625652]]
Evaluating performance on  val set...
3814/3814 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986581
{'0': {'precision': 0.3706796976461646, 'recall': 0.3746937368042154, 'f1-score': 0.37267590887757684, 'support': 330598}, '1': {'precision': 0.35073699165334754, 'recall': 0.006255919366742582, 'f1-score': 0.012292582126896792, 'support': 315701}, '2': {'precision': 0.3547847961951181, 'recall': 0.6847588268317477, 'f1-score': 0.467401300799536, 'support': 329535}, 'accuracy': 0.36020470694810797, 'macro avg': {'precision': 0.35873382849821006, 'recall': 0.3552361610009019, 'f1-score': 0.28412326393466986, 'support': 975834}, 'weighted avg': {'precision': 0.35886020931689044, 'recall': 0.36020470694810797, 'f1-score': 0.288073359046854, 'support': 975834}}
[[123873   1686 205039]
 [108392   1975 205334]
 [101913   1970 225652]]
testing model out of sample: results/universal/W3/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 84s - 84s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975908
{'0': {'precision': 0.38108818022444574, 'recall': 0.3479829845159095, 'f1-score': 0.3637839726262298, 'support': 1469250}, '1': {'precision': 0.3134324043020701, 'recall': 0.00849288668839308, 'f1-score': 0.01653766242483227, 'support': 1276480}, '2': {'precision': 0.348600248022001, 'recall': 0.6918896997439443, 'f1-score': 0.46361412996343976, 'support': 1390713}, 'accuracy': 0.3588433347201932, 'macro avg': {'precision': 0.34770694418283893, 'recall': 0.3494551903160823, 'f1-score': 0.2813119216715006, 'support': 4136443}, 'weighted avg': {'precision': 0.3492872743479589, 'recall': 0.3588433347201932, 'f1-score': 0.29018985506073297, 'support': 4136443}}
[[511274  11018 946958]
 [414578  10841 851061]
 [415764  12729 962220]]
Evaluating performance on  train set...
6181/6181 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002052
{'0': {'precision': 0.35833717923714004, 'recall': 0.35289788513432563, 'f1-score': 0.35559673321095014, 'support': 525849}, '1': {'precision': 0.3889602053915276, 'recall': 0.010436579695169207, 'f1-score': 0.020327725877597572, 'support': 522585}, '2': {'precision': 0.34965948813685244, 'recall': 0.6883049433293646, 'f1-score': 0.46373911642933613, 'support': 533345}, 'accuracy': 0.35284891252191364, 'macro avg': {'precision': 0.36565229092184004, 'recall': 0.3505464693862865, 'f1-score': 0.27988785850596126, 'support': 1581779}, 'weighted avg': {'precision': 0.3655284056745929, 'recall': 0.35284891252191364, 'f1-score': 0.2812947259016548, 'support': 1581779}}
[[185571   4213 336065]
 [170410   5454 346721]
 [161886   4355 367104]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969502
{'0': {'precision': 0.38107197746587484, 'recall': 0.3542904085036469, 'f1-score': 0.36719350660742944, 'support': 200855}, '1': {'precision': 0.3422088880555035, 'recall': 0.010560548106913254, 'f1-score': 0.020488812547012004, 'support': 172813}, '2': {'precision': 0.35114878681028516, 'recall': 0.6849072009546839, 'f1-score': 0.46426898841961856, 'support': 191058}, 'accuracy': 0.3609591199980167, 'macro avg': {'precision': 0.35814321744388783, 'recall': 0.34991938585508137, 'f1-score': 0.2839837691913533, 'support': 564726}, 'weighted avg': {'precision': 0.3590557925716958, 'recall': 0.3609591199980167, 'f1-score': 0.2939402282200528, 'support': 564726}}
[[ 71161   1817 127877]
 [ 57068   1825 113920]
 [ 58510   1691 130857]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1267519
{'0': {'precision': 0.27854526576875377, 'recall': 0.18990129379841914, 'f1-score': 0.22583624650711437, 'support': 50858}, '1': {'precision': 0.40261934938741023, 'recall': 0.01235832663329616, 'f1-score': 0.02398057397365408, 'support': 77114}, '2': {'precision': 0.25850030803532137, 'recall': 0.7760701074511186, 'f1-score': 0.3878215708281068, 'support': 45416}, 'accuracy': 0.26447620365884605, 'macro avg': {'precision': 0.31322164106382844, 'recall': 0.32610990929427797, 'f1-score': 0.21254613043629175, 'support': 173388}, 'weighted avg': {'precision': 0.3284765590747929, 'recall': 0.26447620365884605, 'f1-score': 0.17849056605412417, 'support': 173388}}
[[ 9658   760 40440]
 [15499   953 60662]
 [ 9516   654 35246]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019703
{'0': {'precision': 0.34847419490929543, 'recall': 0.22657035750205723, 'f1-score': 0.2746010638297872, 'support': 21874}, '1': {'precision': 0.30564784053156147, 'recall': 0.00840297757683701, 'f1-score': 0.01635628250144451, 'support': 21897}, '2': {'precision': 0.3438246315748597, 'recall': 0.7850682745167583, 'f1-score': 0.47821331640988946, 'support': 22556}, 'accuracy': 0.34447510063774933, 'macro avg': {'precision': 0.33264888900523887, 'recall': 0.34001386986521753, 'f1-score': 0.25639022091370706, 'support': 66327}, 'weighted avg': {'precision': 0.3327544392685945, 'recall': 0.34447510063774933, 'f1-score': 0.25858785642480986, 'support': 66327}}
[[ 4956   192 16726]
 [ 4644   184 17069]
 [ 4622   226 17708]]
Evaluating performance on  val set...
86/86 - 1s - 665ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1189226
{'0': {'precision': 0.3459133541759714, 'recall': 0.21691639826354853, 'f1-score': 0.2666322402960668, 'support': 7141}, '1': {'precision': 0.31952662721893493, 'recall': 0.006185567010309278, 'f1-score': 0.012136195078098664, 'support': 8730}, '2': {'precision': 0.27540926707930813, 'recall': 0.785254824344384, 'f1-score': 0.4077944325481798, 'support': 6063}, 'accuracy': 0.29014315674295615, 'macro avg': {'precision': 0.3136164161580715, 'recall': 0.3361189298727472, 'f1-score': 0.22885428930744842, 'support': 21934}, 'weighted avg': {'precision': 0.31592236272881186, 'recall': 0.29014315674295615, 'f1-score': 0.2043597818695007, 'support': 21934}}
[[1549   64 5528]
 [1678   54 6998]
 [1251   51 4761]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0865399
{'0': {'precision': 0.4353617894598106, 'recall': 0.329162307018855, 'f1-score': 0.37488600206716255, 'support': 140493}, '1': {'precision': 0.2886435331230284, 'recall': 0.016589276900917597, 'f1-score': 0.031375313134007064, 'support': 99281}, '2': {'precision': 0.37471292953707336, 'recall': 0.744654233754199, 'f1-score': 0.49855235810524345, 'support': 129495}, 'accuracy': 0.39082890792349206, 'macro avg': {'precision': 0.3662394173733041, 'recall': 0.3634686058913239, 'f1-score': 0.30160455776880435, 'support': 369269}, 'weighted avg': {'precision': 0.37464708196184315, 'recall': 0.39082890792349206, 'f1-score': 0.32589756834318, 'support': 369269}}
[[46245  1922 92326]
 [29048  1647 68586]
 [30929  2137 96429]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003332
{'0': {'precision': 0.372216995923487, 'recall': 0.32541945388748766, 'f1-score': 0.3472486323611152, 'support': 54714}, '1': {'precision': 0.3478596220593907, 'recall': 0.0161860498501624, 'f1-score': 0.030932784636488343, 'support': 55727}, '2': {'precision': 0.33968639459373845, 'recall': 0.7197807320120075, 'f1-score': 0.4615522570077535, 'support': 53633}, 'accuracy': 0.3492997062301157, 'macro avg': {'precision': 0.35325433752553875, 'recall': 0.35379541191655256, 'f1-score': 0.27991122466845236, 'support': 164074}, 'weighted avg': {'precision': 0.3533104225819283, 'recall': 0.3492997062301157, 'f1-score': 0.27717728074247283, 'support': 164074}}
[[17805   776 36133]
 [15916   902 38909]
 [14114   915 38604]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0889106
{'0': {'precision': 0.38746253746253745, 'recall': 0.322268383880349, 'f1-score': 0.351871172601497, 'support': 24070}, '1': {'precision': 0.31666666666666665, 'recall': 0.014176988509177734, 'f1-score': 0.02713898014569347, 'support': 20103}, '2': {'precision': 0.3911426364781919, 'recall': 0.7416470769586496, 'f1-score': 0.5121688334153904, 'support': 25949}, 'accuracy': 0.38913607712272896, 'macro avg': {'precision': 0.3650906135357987, 'recall': 0.3593641497827254, 'f1-score': 0.29705966205419365, 'support': 70122}, 'weighted avg': {'precision': 0.3685281873120544, 'recall': 0.38913607712272896, 'f1-score': 0.31809393771830347, 'support': 70122}}
[[ 7757   265 16048]
 [ 5909   285 13909]
 [ 6354   350 19245]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
1359/1359 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173462
{'0': {'precision': 0.3020473950165534, 'recall': 0.3496656547216815, 'f1-score': 0.3241168798994059, 'support': 99149}, '1': {'precision': 0.5090979481223383, 'recall': 0.008754876765955181, 'f1-score': 0.01721373171450077, 'support': 150202}, '2': {'precision': 0.28966211583360096, 'recall': 0.6780163744590944, 'f1-score': 0.4059109705667721, 'support': 98446}, 'accuracy': 0.29537920108569077, 'macro avg': {'precision': 0.3669358196574976, 'recall': 0.34547896864891037, 'f1-score': 0.2490805273935596, 'support': 347797}, 'weighted avg': {'precision': 0.3879599416548227, 'recall': 0.29537920108569077, 'f1-score': 0.21472788110462165, 'support': 347797}}
[[34669   687 63793]
 [48994  1315 99893]
 [31117   581 66748]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006402
{'0': {'precision': 0.3454850031908105, 'recall': 0.34758299670955833, 'f1-score': 0.34653082452092976, 'support': 37381}, '1': {'precision': 0.3894736842105263, 'recall': 0.0059250560478274795, 'f1-score': 0.011672537988327462, 'support': 37468}, '2': {'precision': 0.35227423418644743, 'recall': 0.6857430496398977, 'f1-score': 0.4654442877291961, 'support': 38739}, 'accuracy': 0.35021305067436703, 'macro avg': {'precision': 0.3624109738625947, 'recall': 0.3464170341324279, 'f1-score': 0.2745492167461511, 'support': 113588}, 'weighted avg': {'precision': 0.3623105122233376, 'recall': 0.35021305067436703, 'f1-score': 0.27663011644808305, 'support': 113588}}
[[12993   174 24214]
 [12615   222 24631]
 [12000   174 26565]]
Evaluating performance on  val set...
144/144 - 1s - 889ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978607
{'0': {'precision': 0.3733837429111531, 'recall': 0.38428015564202334, 'f1-score': 0.37875359539789066, 'support': 12850}, '1': {'precision': 0.38562091503267976, 'recall': 0.005179073033707865, 'f1-score': 0.010220874837592032, 'support': 11392}, '2': {'precision': 0.35363651994497936, 'recall': 0.6634677419354839, 'f1-score': 0.4613615971287572, 'support': 12400}, 'accuracy': 0.3608973309317177, 'macro avg': {'precision': 0.37088039262960404, 'recall': 0.350975656870405, 'f1-score': 0.28344535578808, 'support': 36642}, 'weighted avg': {'precision': 0.37050563309258083, 'recall': 0.3608973309317177, 'f1-score': 0.2921320809838254, 'support': 36642}}
[[4938   49 7863]
 [4159   59 7174]
 [4128   45 8227]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1141688
{'0': {'precision': 0.3060012672975901, 'recall': 0.35687807668927374, 'f1-score': 0.3294872429749701, 'support': 83897}, '1': {'precision': 0.5050505050505051, 'recall': 0.011414270374472619, 'f1-score': 0.022324012369156484, 'support': 118273}, '2': {'precision': 0.31236327859243673, 'recall': 0.6674083930628082, 'f1-score': 0.4255560348361751, 'support': 89431}, 'accuracy': 0.3119948148325966, 'macro avg': {'precision': 0.37447168364684397, 'recall': 0.34523358004218485, 'f1-score': 0.25912243006010055, 'support': 291601}, 'weighted avg': {'precision': 0.3886865513976444, 'recall': 0.3119948148325966, 'f1-score': 0.2343655230614514, 'support': 291601}}
[[29941   751 53205]
 [38733  1350 78190]
 [29172   572 59687]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999919
{'0': {'precision': 0.3556527888270132, 'recall': 0.2506463167730883, 'f1-score': 0.29405638486415375, 'support': 32105}, '1': {'precision': 0.41735537190082644, 'recall': 0.006230721776681061, 'f1-score': 0.01227814247507902, 'support': 32420}, '2': {'precision': 0.3533090773888564, 'recall': 0.7850293570943853, 'f1-score': 0.48730322982390273, 'support': 33893}, 'accuracy': 0.3541628563880591, 'macro avg': {'precision': 0.375439079372232, 'recall': 0.34730213188138487, 'f1-score': 0.26454591905437846, 'support': 98418}, 'weighted avg': {'precision': 0.3751711933005808, 'recall': 0.3541628563880591, 'f1-score': 0.26778542526293214, 'support': 98418}}
[[ 8047   144 23914]
 [ 7431   202 24787]
 [ 7148   138 26607]]
Evaluating performance on  val set...
139/139 - 1s - 921ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113249
{'0': {'precision': 0.33499630450849965, 'recall': 0.32649018548532327, 'f1-score': 0.3306885544915641, 'support': 11106}, '1': {'precision': 0.37410071942446044, 'recall': 0.007517709989880006, 'f1-score': 0.01473922902494331, 'support': 13834}, '2': {'precision': 0.3014133256417652, 'recall': 0.7012750455373407, 'f1-score': 0.4216138328530259, 'support': 10431}, 'accuracy': 0.3122614571258941, 'macro avg': {'precision': 0.3368367831915751, 'recall': 0.345094313670848, 'f1-score': 0.2556805387898444, 'support': 35371}, 'weighted avg': {'precision': 0.34038677759064306, 'recall': 0.3122614571258941, 'f1-score': 0.23393128469662408, 'support': 35371}}
[[3626   75 7405]
 [4181  104 9549]
 [3017   99 7315]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056305
{'0': {'precision': 0.36553755191735937, 'recall': 0.3283554209264168, 'f1-score': 0.3459502874984708, 'support': 198075}, '1': {'precision': 0.3772549019607843, 'recall': 0.0023871323146250315, 'f1-score': 0.004744244767522143, 'support': 201497}, '2': {'precision': 0.32731373629224114, 'recall': 0.7184346515272287, 'f1-score': 0.4497325223011228, 'support': 184419}, 'accuracy': 0.33906858153635927, 'macro avg': {'precision': 0.3567020633901283, 'recall': 0.3497257349227569, 'f1-score': 0.26680901818903857, 'support': 583991}, 'weighted avg': {'precision': 0.3575097107827037, 'recall': 0.33906858153635927, 'f1-score': 0.26099593369492297, 'support': 583991}}
[[ 65039    406 132630]
 [ 61350    481 139666]
 [ 51538    388 132493]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005552
{'0': {'precision': 0.35089439549510426, 'recall': 0.3377740621881826, 'f1-score': 0.3442092462435847, 'support': 74162}, '1': {'precision': 0.4357501794687724, 'recall': 0.008180372496698202, 'f1-score': 0.016059263178781667, 'support': 74202}, '2': {'precision': 0.3501536598687804, 'recall': 0.6966626078531495, 'f1-score': 0.46605879055427085, 'support': 76377}, 'accuracy': 0.35091950289444296, 'macro avg': {'precision': 0.378932744944219, 'recall': 0.34753901417934346, 'f1-score': 0.2754424333255457, 'support': 224741}, 'weighted avg': {'precision': 0.3786592168560593, 'recall': 0.35091950289444296, 'f1-score': 0.2772749423223721, 'support': 224741}}
[[25050   417 48695]
 [23540   607 50055]
 [22799   369 53209]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012756
{'0': {'precision': 0.35090567327409433, 'recall': 0.32113535069200094, 'f1-score': 0.3353611235863308, 'support': 25578}, '1': {'precision': 0.3125, 'recall': 0.007240137758296806, 'f1-score': 0.014152386780905753, 'support': 25552}, '2': {'precision': 0.34967301890681507, 'recall': 0.7112474749399703, 'f1-score': 0.46884578664388726, 'support': 26237}, 'accuracy': 0.3497615262321145, 'macro avg': {'precision': 0.33769289739363645, 'recall': 0.346540987796756, 'f1-score': 0.27278643233704125, 'support': 77367}, 'weighted avg': {'precision': 0.33780340853416696, 'recall': 0.3497615262321145, 'f1-score': 0.27454335194970136, 'support': 77367}}
[[ 8214   214 17150]
 [ 7811   185 17556]
 [ 7383   193 18661]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/EXC
Evaluating performance on  test set...
5098/5098 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977674
{'0': {'precision': 0.3925834311392085, 'recall': 0.36292370637577726, 'f1-score': 0.377171377518416, 'support': 462673}, '1': {'precision': 0.3671343358817105, 'recall': 0.010370416074382225, 'f1-score': 0.02017106168098335, 'support': 421391}, '2': {'precision': 0.3422382888432264, 'recall': 0.7036685889987477, 'f1-score': 0.4605043506522284, 'support': 420843}, 'accuracy': 0.3589673440329464, 'macro avg': {'precision': 0.3673186852880484, 'recall': 0.3589875704829691, 'f1-score': 0.2859489299505426, 'support': 1304907}, 'weighted avg': {'precision': 0.3681284926501665, 'recall': 0.3589673440329464, 'f1-score': 0.2887615355308272, 'support': 1304907}}
[[167915   3783 290975]
 [138844   4370 278177]
 [120959   3750 296134]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094858
{'0': {'precision': 0.38845374833350427, 'recall': 0.36735869071071375, 'f1-score': 0.3776118333535831, 'support': 164975}, '1': {'precision': 0.4009629752614976, 'recall': 0.015618229675283101, 'f1-score': 0.030065359477124187, 'support': 154627}, '2': {'precision': 0.35671944833828884, 'recall': 0.7066866745951197, 'f1-score': 0.47411590976023943, 'support': 160603}, 'accuracy': 0.3675846773773701, 'macro avg': {'precision': 0.38204539064443016, 'recall': 0.36322119832703886, 'f1-score': 0.29393103419698224, 'support': 480205}, 'weighted avg': {'precision': 0.38186831180132164, 'recall': 0.3675846773773701, 'f1-score': 0.29797662665445046, 'support': 480205}}
[[ 60605   1646 102724]
 [ 50266   2415 101946]
 [ 45145   1962 113496]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956833
{'0': {'precision': 0.3699111462683272, 'recall': 0.38546179503891426, 'f1-score': 0.3775264022529923, 'support': 52166}, '1': {'precision': 0.3778998778998779, 'recall': 0.01188967000883562, 'f1-score': 0.023054003724394787, 'support': 52062}, '2': {'precision': 0.36283272283272283, 'recall': 0.686040927895981, 'f1-score': 0.47463886173563596, 'support': 54144}, 'accuracy': 0.3654181294673301, 'macro avg': {'precision': 0.37021458233364263, 'recall': 0.3611307976479103, 'f1-score': 0.29173975590434104, 'support': 158372}, 'weighted avg': {'precision': 0.37011733920460654, 'recall': 0.3654181294673301, 'f1-score': 0.2942005302177361, 'support': 158372}}
[[20108   463 31595]
 [17808   619 33635]
 [16443   556 37145]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/AAL
Evaluating performance on  test set...
5760/5760 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983199
{'0': {'precision': 0.38171906862679766, 'recall': 0.38172342949407556, 'f1-score': 0.38172124904798177, 'support': 525197}, '1': {'precision': 0.41634000412626365, 'recall': 0.004327481868751635, 'f1-score': 0.008565928573399353, 'support': 466322}, '2': {'precision': 0.3430433802017541, 'recall': 0.6708299858369845, 'f1-score': 0.4539497605728037, 'support': 482948}, 'accuracy': 0.35706055137212295, 'macro avg': {'precision': 0.38036748431827183, 'recall': 0.3522936323999373, 'f1-score': 0.28141231273139494, 'support': 1474467}, 'weighted avg': {'precision': 0.38000058832882155, 'recall': 0.35706055137212295, 'f1-score': 0.28736313851010026, 'support': 1474467}}
[[200480   1344 323373]
 [167236   2018 297068]
 [157487   1485 323976]]
Evaluating performance on  train set...
2159/2159 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999142
{'0': {'precision': 0.36574000904676524, 'recall': 0.3626509018989052, 'f1-score': 0.3641889050183831, 'support': 185054}, '1': {'precision': 0.36662343277129267, 'recall': 0.00929712425036454, 'f1-score': 0.018134382618365343, 'support': 182422}, '2': {'precision': 0.3501444757574344, 'recall': 0.6894986545049767, 'f1-score': 0.46443657037615355, 'support': 185062}, 'accuracy': 0.35546152481820253, 'macro avg': {'precision': 0.36083597252516414, 'recall': 0.35381556021808214, 'f1-score': 0.28225328600430066, 'support': 552538}, 'weighted avg': {'precision': 0.3608082493145579, 'recall': 0.35546152481820253, 'f1-score': 0.2835140471103002, 'support': 552538}}
[[ 67110   1433 116511]
 [ 60416   1696 120310]
 [ 55965   1497 127600]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952886
{'0': {'precision': 0.3838023824863946, 'recall': 0.36047379940775076, 'f1-score': 0.37177248554299264, 'support': 77670}, '1': {'precision': 0.3129411764705882, 'recall': 0.014357977853860152, 'f1-score': 0.02745624253505758, 'support': 64842}, '2': {'precision': 0.36015867516139755, 'recall': 0.6806355484879666, 'f1-score': 0.47105718275731323, 'support': 74833}, 'accuracy': 0.3674480664381513, 'macro avg': {'precision': 0.35230074470612677, 'recall': 0.35182244191652584, 'f1-score': 0.2900953036117878, 'support': 217345}, 'weighted avg': {'precision': 0.35452123099577637, 'recall': 0.3674480664381513, 'f1-score': 0.3032345293789158, 'support': 217345}}
[[27998  1063 48609]
 [22033   931 41878]
 [22918   981 50934]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/WBA
Evaluating performance on  test set...
6315/6315 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0877256
{'0': {'precision': 0.4186484630792889, 'recall': 0.35276623144795227, 'f1-score': 0.382894030071507, 'support': 627424}, '1': {'precision': 0.30529089803365095, 'recall': 0.010995081660018837, 'f1-score': 0.02122571703741984, 'support': 410911}, '2': {'precision': 0.37519199367725675, 'recall': 0.6963516881939723, 'f1-score': 0.4876433553091811, 'support': 578103}, 'accuracy': 0.3887652975245571, 'macro avg': {'precision': 0.36637711826339886, 'recall': 0.3533710004339811, 'f1-score': 0.2972543674727027, 'support': 1616438}, 'weighted avg': {'precision': 0.37429032144862245, 'recall': 0.3887652975245571, 'f1-score': 0.32841771300319095, 'support': 1616438}}
[[221334   5369 400721]
 [136725   4518 269668]
 [170628   4912 402563]]
Evaluating performance on  train set...
2155/2155 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985867
{'0': {'precision': 0.36202619376344203, 'recall': 0.3605822700203258, 'f1-score': 0.3613027892601681, 'support': 182527}, '1': {'precision': 0.3808567603748327, 'recall': 0.00936933970031286, 'f1-score': 0.01828876317819491, 'support': 182190}, '2': {'precision': 0.3568417018014565, 'recall': 0.6976619706247591, 'f1-score': 0.4721745241666124, 'support': 186824}, 'accuracy': 0.3587457686735891, 'macro avg': {'precision': 0.3665748853132437, 'recall': 0.3558711934484659, 'f1-score': 0.2839220255349918, 'support': 551541}, 'weighted avg': {'precision': 0.3664903286230867, 'recall': 0.3587457686735891, 'f1-score': 0.28555098765391734, 'support': 551541}}
[[ 65816   1395 115316]
 [ 60879   1707 119604]
 [ 55104   1380 130340]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0905225
{'0': {'precision': 0.4032598305811002, 'recall': 0.3448669523057842, 'f1-score': 0.37178454759553287, 'support': 70952}, '1': {'precision': 0.3015500234852043, 'recall': 0.012427169431486034, 'f1-score': 0.023870607919687675, 'support': 51661}, '2': {'precision': 0.37439232176074283, 'recall': 0.702993836219548, 'f1-score': 0.488581540752527, 'support': 68140}, 'accuracy': 0.38276200112186964, 'macro avg': {'precision': 0.3597340586090158, 'recall': 0.35342931931893945, 'f1-score': 0.2947455654225825, 'support': 190753}, 'weighted avg': {'precision': 0.3654021696509957, 'recall': 0.38276200112186964, 'f1-score': 0.31928191369789427, 'support': 190753}}
[[24469   723 45760]
 [16735   642 34284]
 [19474   764 47902]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
6082/6082 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0862027
{'0': {'precision': 0.41206582475387354, 'recall': 0.33780670535982454, 'f1-score': 0.3712593622555532, 'support': 595971}, '1': {'precision': 0.25923606762680024, 'recall': 0.016284466821382213, 'f1-score': 0.0306439674315322, 'support': 381345}, '2': {'precision': 0.38663857700318405, 'recall': 0.696752628200261, 'f1-score': 0.4973114852635151, 'support': 579484}, 'accuracy': 0.3926580164439877, 'macro avg': {'precision': 0.35264682312795265, 'recall': 0.3502812667938226, 'f1-score': 0.29973827165020017, 'support': 1556800}, 'weighted avg': {'precision': 0.3651647796824551, 'recall': 0.3926580164439877, 'f1-score': 0.33474420983390596, 'support': 1556800}}
[[201323   7966 386682]
 [121299   6210 253836]
 [165948   9779 403757]]
Evaluating performance on  train set...
2440/2440 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100174
{'0': {'precision': 0.3554563463853423, 'recall': 0.36166806507922733, 'f1-score': 0.35853530283474355, 'support': 207378}, '1': {'precision': 0.4033459862224097, 'recall': 0.01388700652481171, 'f1-score': 0.026849594542111, 'support': 206596}, '2': {'precision': 0.34853986764090833, 'recall': 0.67266666983206, 'f1-score': 0.4591650042701039, 'support': 210611}, 'accuracy': 0.35150059639600695, 'macro avg': {'precision': 0.36911406674955344, 'recall': 0.34940724714536636, 'f1-score': 0.28151663388231946, 'support': 624585}, 'weighted avg': {'precision': 0.36896471038213186, 'recall': 0.35150059639600695, 'f1-score': 0.28275503507067296, 'support': 624585}}
[[ 75002   2111 130265]
 [ 69193   2869 134534]
 [ 66807   2133 141671]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094759
{'0': {'precision': 0.3930541763213064, 'recall': 0.367166563595135, 'f1-score': 0.3796695976552092, 'support': 77616}, '1': {'precision': 0.35555555555555557, 'recall': 0.008732362714095382, 'f1-score': 0.017046077678725305, 'support': 62297}, '2': {'precision': 0.35221682047101976, 'recall': 0.6766305487591752, 'f1-score': 0.46327699840615716, 'support': 71525}, 'accuracy': 0.3662444782867791, 'macro avg': {'precision': 0.3669421841159606, 'recall': 0.35084315835613517, 'f1-score': 0.28666422458003055, 'support': 211438}, 'weighted avg': {'precision': 0.3681913633215819, 'recall': 0.3662444782867791, 'f1-score': 0.30111069109506644, 'support': 211438}}
[[28498   539 48579]
 [21324   544 40429]
 [22682   447 48396]]
testing model on single stock: results/universal/W3/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
13689/13689 - 72s - 72s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062651
{'0': {'precision': 0.34673367620681345, 'recall': 0.38976898851100517, 'f1-score': 0.3669940130077099, 'support': 1136740}, '1': {'precision': 0.37542155672467287, 'recall': 0.0022464636158458424, 'f1-score': 0.004466202179500244, 'support': 1238836}, '2': {'precision': 0.33445275599244884, 'recall': 0.6575470511205264, 'f1-score': 0.4433840044424968, 'support': 1128666}, 'accuracy': 0.3390176819979899, 'macro avg': {'precision': 0.3522026629746451, 'recall': 0.3498541677491258, 'f1-score': 0.271614739876569, 'support': 3504242}, 'weighted avg': {'precision': 0.35292004177590286, 'recall': 0.3390176819979899, 'f1-score': 0.2634356066583651, 'support': 3504242}}
[[443066   2191 691483]
 [450686   2783 785367]
 [384076   2439 742151]]
Evaluating performance on  train set...
5475/5475 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015778
{'0': {'precision': 0.3613783844260461, 'recall': 0.3739863479633481, 'f1-score': 0.36757428326825503, 'support': 470699}, '1': {'precision': 0.329608938547486, 'recall': 0.0016576543866246526, 'f1-score': 0.0032987190046212173, 'support': 462702}, '2': {'precision': 0.3469653564180911, 'recall': 0.6759874744747567, 'f1-score': 0.4585631476489207, 'support': 468164}, 'accuracy': 0.3519458605202042, 'macro avg': {'precision': 0.3459842264638744, 'recall': 0.35054382560824315, 'f1-score': 0.276478716640599, 'support': 1401565}, 'weighted avg': {'precision': 0.3460758854401141, 'recall': 0.3519458605202042, 'f1-score': 0.27770808267677194, 'support': 1401565}}
[[176035    730 293934]
 [160225    767 301710]
 [150861    830 316473]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028253
{'0': {'precision': 0.3607078064066482, 'recall': 0.3934847711022379, 'f1-score': 0.37638405062939784, 'support': 172304}, '1': {'precision': 0.3971238938053097, 'recall': 0.0020163894833212575, 'f1-score': 0.004012406046550615, 'support': 178041}, '2': {'precision': 0.3427821790817539, 'recall': 0.6667251903482744, 'f1-score': 0.45277829665634645, 'support': 170871}, 'accuracy': 0.3493407723477407, 'macro avg': {'precision': 0.3668712930979039, 'recall': 0.3540754503112778, 'f1-score': 0.27772491777743163, 'support': 521216}, 'weighted avg': {'precision': 0.36727051121600374, 'recall': 0.3493407723477407, 'f1-score': 0.2742308957755485, 'support': 521216}}
[[ 67799    236 104269]
 [ 63524    359 114158]
 [ 56638    309 113924]]
training model: results/universal/W3/deepOF_L1/h1000
Epoch 1/50
10532/10532 - 147s - loss: 3.2784 - accuracy1000: 0.3685 - val_loss: 3.3002 - val_accuracy1000: 0.3391 - 147s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 145s - loss: 3.2760 - accuracy1000: 0.3692 - val_loss: 3.3000 - val_accuracy1000: 0.3392 - 145s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 145s - loss: 3.2748 - accuracy1000: 0.3710 - val_loss: 3.2997 - val_accuracy1000: 0.3393 - 145s/epoch - 14ms/step
Epoch 4/50
10532/10532 - 143s - loss: 3.2740 - accuracy1000: 0.3716 - val_loss: 3.2998 - val_accuracy1000: 0.3393 - 143s/epoch - 14ms/step
Epoch 5/50
10532/10532 - 141s - loss: 3.2731 - accuracy1000: 0.3725 - val_loss: 3.3000 - val_accuracy1000: 0.3393 - 141s/epoch - 13ms/step
Epoch 6/50
10532/10532 - 145s - loss: 3.2724 - accuracy1000: 0.3730 - val_loss: 3.3001 - val_accuracy1000: 0.3393 - 145s/epoch - 14ms/step
Epoch 7/50
10532/10532 - 141s - loss: 3.2718 - accuracy1000: 0.3737 - val_loss: 3.3003 - val_accuracy1000: 0.3393 - 141s/epoch - 13ms/step
Epoch 8/50
10532/10532 - 145s - loss: 3.2713 - accuracy1000: 0.3740 - val_loss: 3.3011 - val_accuracy1000: 0.3393 - 145s/epoch - 14ms/step
Epoch 9/50
10532/10532 - 150s - loss: 3.2709 - accuracy1000: 0.3746 - val_loss: 3.3020 - val_accuracy1000: 0.3392 - 150s/epoch - 14ms/step
Epoch 10/50
10532/10532 - 150s - loss: 3.2703 - accuracy1000: 0.3749 - val_loss: 3.3039 - val_accuracy1000: 0.3392 - 150s/epoch - 14ms/step
Epoch 11/50
10532/10532 - 150s - loss: 3.2698 - accuracy1000: 0.3753 - val_loss: 3.3045 - val_accuracy1000: 0.3392 - 150s/epoch - 14ms/step
Epoch 12/50
10532/10532 - 145s - loss: 3.2695 - accuracy1000: 0.3754 - val_loss: 3.3034 - val_accuracy1000: 0.3392 - 145s/epoch - 14ms/step
Epoch 13/50
10532/10532 - 146s - loss: 3.2695 - accuracy1000: 0.3753 - val_loss: 3.3026 - val_accuracy1000: 0.3392 - 146s/epoch - 14ms/step
testing model in sample: results/universal/W3/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 145s - 145s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095767
{'0': {'precision': 0.4051321928460342, 'recall': 0.0005996758757646539, 'f1-score': 0.001197579097302727, 'support': 2606408}, '1': {'precision': 0.2845963928112075, 'recall': 0.9972578448941866, 'f1-score': 0.4428209963523061, 'support': 2016662}, '2': {'precision': 0.3795346509882412, 'recall': 0.002463275157334191, 'f1-score': 0.004894781951096547, 'support': 2463387}, 'accuracy': 0.2848762082377696, 'macro avg': {'precision': 0.3564210788818276, 'recall': 0.33344026530909515, 'f1-score': 0.14963778580023512, 'support': 7086457}, 'weighted avg': {'precision': 0.3619319561954376, 'recall': 0.2848762082377696, 'f1-score': 0.12815986862149065, 'support': 7086457}}
[[   1563 2599343    5502]
 [   1112 2011132    4418]
 [   1183 2456136    6068]]
Evaluating performance on  train set...
10532/10532 - 65s - 65s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020514
{'0': {'precision': 0.3690773067331671, 'recall': 0.0004903936955693371, 'f1-score': 0.000979485946362114, 'support': 905395}, '1': {'precision': 0.32865439582770156, 'recall': 0.9975914302773241, 'f1-score': 0.49442237984426746, 'support': 886003}, '2': {'precision': 0.35704749189395385, 'recall': 0.002069869140484628, 'f1-score': 0.004115877790090232, 'support': 904405}, 'accuracy': 0.3287276555445632, 'macro avg': {'precision': 0.3515930648182742, 'recall': 0.33338389770445936, 'f1-score': 0.16650591452690658, 'support': 2695803}, 'weighted avg': {'precision': 0.35175606886058003, 'recall': 0.3287276555445632, 'f1-score': 0.16420671463764733, 'support': 2695803}}
[[   444 903301   1650]
 [   413 883869   1721]
 [   346 902187   1872]]
Evaluating performance on  val set...
3814/3814 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003467
{'0': {'precision': 0.3860759493670886, 'recall': 0.0005685966847395486, 'f1-score': 0.0011355210211002145, 'support': 321845}, '1': {'precision': 0.33920233253164545, 'recall': 0.9974140769674614, 'f1-score': 0.5062412506727303, 'support': 331023}, '2': {'precision': 0.3440160240360541, 'recall': 0.0021271588959828587, 'f1-score': 0.004228173669002317, 'support': 322966}, 'accuracy': 0.33923495184631813, 'macro avg': {'precision': 0.35643143531159605, 'recall': 0.333369944182728, 'f1-score': 0.17053498178761095, 'support': 975834}, 'weighted avg': {'precision': 0.3562551282948757, 'recall': 0.33923495184631813, 'f1-score': 0.1735013492270798, 'support': 975834}}
[[   183 321051    611]
 [   157 330167    699]
 [   134 322145    687]]
testing model out of sample: results/universal/W3/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 88s - 88s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048205
{'0': {'precision': 0.33143028846153844, 'recall': 0.0007583096089446158, 'f1-score': 0.0015131571275805468, 'support': 1454551}, '1': {'precision': 0.3211591574261099, 'recall': 0.9966581659719876, 'f1-score': 0.4857818927437506, 'support': 1328911}, '2': {'precision': 0.33780957622454594, 'recall': 0.002268324536708202, 'f1-score': 0.00450638955821524, 'support': 1352981}, 'accuracy': 0.3212039909651843, 'macro avg': {'precision': 0.3301330073707314, 'recall': 0.3332282667058802, 'f1-score': 0.16393381314318214, 'support': 4136443}, 'weighted avg': {'precision': 0.330217080911346, 'recall': 0.3212039909651843, 'f1-score': 0.15807275104043098, 'support': 4136443}}
[[   1103 1450573    2875]
 [   1300 1324470    3141]
 [    925 1348987    3069]]
Evaluating performance on  train set...
6181/6181 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014097
{'0': {'precision': 0.33473684210526317, 'recall': 0.0009138858926289451, 'f1-score': 0.001822795258439504, 'support': 521947}, '1': {'precision': 0.3307440455048255, 'recall': 0.9964971755731026, 'f1-score': 0.4966474849470169, 'support': 523292}, '2': {'precision': 0.3546916890080429, 'recall': 0.0024657993812204123, 'f1-score': 0.004897551224387806, 'support': 536540}, 'accuracy': 0.33080411359614714, 'macro avg': {'precision': 0.3400575255393772, 'recall': 0.333292286948984, 'f1-score': 0.1677892771432814, 'support': 1581779}, 'weighted avg': {'precision': 0.3401846164394661, 'recall': 0.33080411359614714, 'f1-score': 0.1665661197573012, 'support': 1581779}}
[[   477 520323   1147]
 [   573 521459   1260]
 [   375 534842   1323]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069046
{'0': {'precision': 0.3735632183908046, 'recall': 0.000959409594095941, 'f1-score': 0.0019139037748071373, 'support': 203250}, '1': {'precision': 0.30826252548105204, 'recall': 0.9961463801242807, 'f1-score': 0.4708256706410874, 'support': 174122}, '2': {'precision': 0.35401698236446766, 'recall': 0.002892919286484409, 'f1-score': 0.005738941684093496, 'support': 187354}, 'accuracy': 0.30844692824484793, 'macro avg': {'precision': 0.34528090874544143, 'recall': 0.33333290300162033, 'f1-score': 0.159492838699996, 'support': 564726}, 'weighted avg': {'precision': 0.34694437534955935, 'recall': 0.30844692824484793, 'f1-score': 0.14776249375073686, 'support': 564726}}
[[   195 202544    511]
 [   193 173451    478]
 [   134 186678    542]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0933503
{'0': {'precision': 0.3192488262910798, 'recall': 0.001218245010570067, 'f1-score': 0.0024272277846192286, 'support': 55818}, '1': {'precision': 0.4251182039929251, 'recall': 0.9976262496100268, 'f1-score': 0.5961844777063093, 'support': 73723}, '2': {'precision': 0.3076923076923077, 'recall': 0.0011859420256802062, 'f1-score': 0.0023627771719374768, 'support': 43847}, 'accuracy': 0.42487369368122363, 'macro avg': {'precision': 0.3506864459921042, 'recall': 0.33334347888209237, 'f1-score': 0.20032482755428868, 'support': 173388}, 'weighted avg': {'precision': 0.36134106716883824, 'recall': 0.42487369368122363, 'f1-score': 0.2548711095409259, 'support': 173388}}
[[   68 55714    36]
 [   94 73548    81]
 [   51 43744    52]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007491
{'0': {'precision': 0.21428571428571427, 'recall': 0.0005604595768530195, 'f1-score': 0.0011179950621884754, 'support': 21411}, '1': {'precision': 0.334753122781579, 'recall': 0.9983333333333333, 'f1-score': 0.5013856368839571, 'support': 22200}, '2': {'precision': 0.390625, 'recall': 0.001100545870751893, 'f1-score': 0.0021949078138718174, 'support': 22716}, 'accuracy': 0.33470532362386357, 'macro avg': {'precision': 0.3132212790224311, 'recall': 0.33333144626031275, 'f1-score': 0.16823284658667245, 'support': 66327}, 'weighted avg': {'precision': 0.3150003506011501, 'recall': 0.33470532362386357, 'f1-score': 0.16892906443831737, 'support': 66327}}
[[   12 21379    20]
 [   18 22163    19]
 [   26 22665    25]]
Evaluating performance on  val set...
86/86 - 1s - 620ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986562
{'0': {'precision': 0.3333333333333333, 'recall': 0.00040074806305102857, 'f1-score': 0.0008005336891260841, 'support': 7486}, '1': {'precision': 0.38280286771085437, 'recall': 0.9990465975449887, 'f1-score': 0.5535160118851107, 'support': 8391}, '2': {'precision': 0.15384615384615385, 'recall': 0.0006603929337956084, 'f1-score': 0.0013151405556468849, 'support': 6057}, 'accuracy': 0.3825111698732561, 'macro avg': {'precision': 0.2899941182967805, 'recall': 0.33336924618061176, 'f1-score': 0.18521056204329456, 'support': 21934}, 'weighted avg': {'precision': 0.3026934599316708, 'recall': 0.3825111698732561, 'f1-score': 0.2123876838365239, 'support': 21934}}
[[   3 7465   18]
 [   4 8383    4]
 [   2 6051    4]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1143101
{'0': {'precision': 0.4200913242009132, 'recall': 0.0019163073590368473, 'f1-score': 0.003815211080700008, 'support': 144027}, '1': {'precision': 0.24331759403483305, 'recall': 0.996016335250982, 'f1-score': 0.3910944299771047, 'support': 89867}, '2': {'precision': 0.46567967698519513, 'recall': 0.002555863342566944, 'f1-score': 0.005083824328891109, 'support': 135375}, 'accuracy': 0.2440795192664426, 'macro avg': {'precision': 0.3763628650736472, 'recall': 0.3334961686508619, 'f1-score': 0.1333311551288986, 'support': 369269}, 'weighted avg': {'precision': 0.3937836689396729, 'recall': 0.2440795192664426, 'f1-score': 0.0985303376768591, 'support': 369269}}
[[   276 143547    204]
 [   165  89509    193]
 [   216 134813    346]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021821
{'0': {'precision': 0.40425531914893614, 'recall': 0.0017008020624462905, 'f1-score': 0.00338735269472821, 'support': 55856}, '1': {'precision': 0.3309309382800646, 'recall': 0.9962059820244585, 'f1-score': 0.4968219560584907, 'support': 54296}, '2': {'precision': 0.36828644501278773, 'recall': 0.002670524090352732, 'f1-score': 0.005302597904737356, 'support': 53922}, 'accuracy': 0.33112498019186465, 'macro avg': {'precision': 0.3678242341472628, 'recall': 0.3335257693924192, 'f1-score': 0.1685039688859854, 'support': 164074}, 'weighted avg': {'precision': 0.36816956385056077, 'recall': 0.33112498019186465, 'f1-score': 0.16730606666801442, 'support': 164074}}
[[   95 55642   119]
 [   78 54090   128]
 [   62 53716   144]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0954075
{'0': {'precision': 0.2727272727272727, 'recall': 0.0009773351328710384, 'f1-score': 0.0019476905954368396, 'support': 21487}, '1': {'precision': 0.36139251373626374, 'recall': 0.9965279147760899, 'f1-score': 0.53042537775771, 'support': 25345}, '2': {'precision': 0.3375796178343949, 'recall': 0.00227565478746243, 'f1-score': 0.004520834221862072, 'support': 23290}, 'accuracy': 0.36124183565785345, 'macro avg': {'precision': 0.32389980143264374, 'recall': 0.3332603015654744, 'f1-score': 0.17896463419166966, 'support': 70122}, 'weighted avg': {'precision': 0.3263143302971902, 'recall': 0.36124183565785345, 'f1-score': 0.19381608419783347, 'support': 70122}}
[[   21 21420    46]
 [   30 25257    58]
 [   26 23211    53]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
1359/1359 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0837744
{'0': {'precision': 0.18867924528301888, 'recall': 0.00031485154749535596, 'f1-score': 0.0006286540516753631, 'support': 95283}, '1': {'precision': 0.4682759058462355, 'recall': 0.9961209859569872, 'f1-score': 0.637066985927656, 'support': 162928}, '2': {'precision': 0.25, 'recall': 0.00294688902283839, 'f1-score': 0.005825114185476931, 'support': 89586}, 'accuracy': 0.467485343461847, 'macro avg': {'precision': 0.30231838370975145, 'recall': 0.33312757550910693, 'f1-score': 0.21450691805493607, 'support': 347797}, 'weighted avg': {'precision': 0.3354533860729602, 'recall': 0.467485343461847, 'f1-score': 0.3001112677988799, 'support': 347797}}
[[    30  94986    267]
 [   107 162296    525]
 [    22  89300    264]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010051
{'0': {'precision': 0.38095238095238093, 'recall': 0.0006491574477293014, 'f1-score': 0.0012961062807150187, 'support': 36971}, '1': {'precision': 0.33237060590001766, 'recall': 0.9963462098546427, 'f1-score': 0.4984601527263576, 'support': 37769}, '2': {'precision': 0.3442622950819672, 'recall': 0.002702841845140033, 'f1-score': 0.005363573672515516, 'support': 38848}, 'accuracy': 0.3324294819875339, 'macro avg': {'precision': 0.3525284273114553, 'recall': 0.333232736382504, 'f1-score': 0.16837327755986273, 'support': 113588}, 'weighted avg': {'precision': 0.35225021595390804, 'recall': 0.3324294819875339, 'f1-score': 0.16799859108053664, 'support': 113588}}
[[   24 36863    84]
 [   22 37631   116]
 [   17 38726   105]]
Evaluating performance on  val set...
144/144 - 1s - 878ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020944
{'0': {'precision': 0.6, 'recall': 0.0009649404953361209, 'f1-score': 0.0019267822736030828, 'support': 12436}, '1': {'precision': 0.33568691844553916, 'recall': 0.9966685626066466, 'f1-score': 0.5022212213646693, 'support': 12307}, '2': {'precision': 0.23170731707317074, 'recall': 0.001596772838053618, 'f1-score': 0.003171688506802437, 'support': 11899}, 'accuracy': 0.33559849353201243, 'macro avg': {'precision': 0.38913141183956995, 'recall': 0.3330767586466788, 'f1-score': 0.16910656404835825, 'support': 36642}, 'weighted avg': {'precision': 0.3916266653338494, 'recall': 0.33559849353201243, 'f1-score': 0.1703656448128365, 'support': 36642}}
[[   12 12398    26]
 [    4 12266    37]
 [    4 11876    19]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1140/1140 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0903273
{'0': {'precision': 0.27906976744186046, 'recall': 0.00014558159848595138, 'f1-score': 0.0002910113858204703, 'support': 82428}, '1': {'precision': 0.39524598845886666, 'recall': 0.9974138679163412, 'f1-score': 0.5661451765447667, 'support': 115230}, '2': {'precision': 0.3795336787564767, 'recall': 0.0031189125320673174, 'f1-score': 0.006186981998627461, 'support': 93943}, 'accuracy': 0.3951872593029516, 'macro avg': {'precision': 0.3512831448857346, 'recall': 0.33355945401563153, 'f1-score': 0.19087438997640485, 'support': 291601}, 'weighted avg': {'precision': 0.3573440777783086, 'recall': 0.3951872593029516, 'f1-score': 0.22579524703159776, 'support': 291601}}
[[    12  82222    194]
 [    13 114932    285]
 [    18  93632    293]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001841
{'0': {'precision': 0.7777777777777778, 'recall': 0.00022237753351547112, 'f1-score': 0.0004446279416902213, 'support': 31478}, '1': {'precision': 0.3293092909535452, 'recall': 0.9978391727118382, 'f1-score': 0.495193596568496, 'support': 32395}, '2': {'precision': 0.3855421686746988, 'recall': 0.0027789839339991316, 'f1-score': 0.0055181927918606655, 'support': 34545}, 'accuracy': 0.32949257249690095, 'macro avg': {'precision': 0.4975430791353406, 'recall': 0.3336135113931176, 'f1-score': 0.16705213910068228, 'support': 98418}, 'weighted avg': {'precision': 0.49248529320039486, 'recall': 0.32949257249690095, 'f1-score': 0.16507568259037753, 'support': 98418}}
[[    7 31388    83]
 [    0 32325    70]
 [    2 34447    96]]
Evaluating performance on  val set...
139/139 - 1s - 883ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981399
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11629}, '1': {'precision': 0.37038506219363615, 'recall': 0.9978625954198473, 'f1-score': 0.5402434236356498, 'support': 13100}, '2': {'precision': 0.3150684931506849, 'recall': 0.002161247885735764, 'f1-score': 0.004293047130191321, 'support': 10642}, 'accuracy': 0.3702185406123661, 'macro avg': {'precision': 0.22848451844810702, 'recall': 0.333341281101861, 'f1-score': 0.18151215692194703, 'support': 35371}, 'weighted avg': {'precision': 0.23196978368850812, 'recall': 0.3702185406123661, 'f1-score': 0.20137614026141495, 'support': 35371}}
[[    0 11605    24]
 [    2 13072    26]
 [    3 10616    23]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
2282/2282 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041023
{'0': {'precision': 0.36507936507936506, 'recall': 0.00022237046920169, 'f1-score': 0.0004444702108334782, 'support': 206862}, '1': {'precision': 0.3349294125524277, 'recall': 0.9972396307239324, 'f1-score': 0.5014451962806598, 'support': 195626}, '2': {'precision': 0.32593123209169056, 'recall': 0.002506845616876856, 'f1-score': 0.004975423594442835, 'support': 181503}, 'accuracy': 0.3349144079275194, 'macro avg': {'precision': 0.34198000324116107, 'recall': 0.3333229489366703, 'f1-score': 0.16895503002864534, 'support': 583991}, 'weighted avg': {'precision': 0.3428125524149635, 'recall': 0.3349144079275194, 'f1-score': 0.16967849893751094, 'support': 583991}}
[[    46 206361    455]
 [    54 195086    486]
 [    26 181022    455]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011442
{'0': {'precision': 0.4112903225806452, 'recall': 0.0006945106423542549, 'f1-score': 0.0013866797177698928, 'support': 73433}, '1': {'precision': 0.3299376085820579, 'recall': 0.9960629921259843, 'f1-score': 0.4956840011138062, 'support': 74168}, '2': {'precision': 0.3446327683615819, 'recall': 0.0031630801140782993, 'f1-score': 0.006268626040489158, 'support': 77140}, 'accuracy': 0.3300287886945417, 'macro avg': {'precision': 0.361953566508095, 'recall': 0.3333068609608056, 'f1-score': 0.1677797689573551, 'support': 224741}, 'weighted avg': {'precision': 0.3615631618742953, 'recall': 0.3300287886945417, 'f1-score': 0.16618810479212567, 'support': 224741}}
[[   51 73166   216]
 [   44 73876   248]
 [   29 76867   244]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027092
{'0': {'precision': 0.28125, 'recall': 0.0003491349212506789, 'f1-score': 0.0006974041069352965, 'support': 25778}, '1': {'precision': 0.32199034418314904, 'recall': 0.9958256402022959, 'f1-score': 0.4866327991683503, 'support': 24914}, '2': {'precision': 0.4275618374558304, 'recall': 0.004536082474226804, 'f1-score': 0.008976927071741227, 'support': 26675}, 'accuracy': 0.3223596623883568, 'macro avg': {'precision': 0.3436007272129931, 'recall': 0.33357028586592447, 'f1-score': 0.16543571011567562, 'support': 77367}, 'weighted avg': {'precision': 0.3448155150013992, 'recall': 0.3223596623883568, 'f1-score': 0.16003472761238713, 'support': 77367}}
[[    9 25697    72]
 [   14 24810    90]
 [    9 26545   121]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
5098/5098 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1168039
{'0': {'precision': 0.4249146757679181, 'recall': 0.0004766298251591637, 'f1-score': 0.0009521915702365565, 'support': 522418}, '1': {'precision': 0.24688601871041915, 'recall': 0.996204927698132, 'f1-score': 0.3957056708194539, 'support': 322260}, '2': {'precision': 0.36041247484909456, 'recall': 0.0031136673264831206, 'f1-score': 0.006173996402451505, 'support': 460229}, 'accuracy': 0.2473118773981594, 'macro avg': {'precision': 0.3440710564424772, 'recall': 0.33326507494992474, 'f1-score': 0.13427728626404734, 'support': 1304907}, 'weighted avg': {'precision': 0.35819934781732937, 'recall': 0.2473118773981594, 'f1-score': 0.10028224515947949, 'support': 1304907}}
[[   249 520706   1463]
 [   143 321037   1080]
 [   194 458602   1433]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043227
{'0': {'precision': 0.35687732342007433, 'recall': 0.0005739361256920115, 'f1-score': 0.00114602918793088, 'support': 167266}, '1': {'precision': 0.31667562542222927, 'recall': 0.9954569063570438, 'f1-score': 0.48049557611993343, 'support': 152099}, '2': {'precision': 0.348543155579989, 'recall': 0.003941805521014673, 'f1-score': 0.0077954493756877885, 'support': 160840}, 'accuracy': 0.3168188586124676, 'macro avg': {'precision': 0.3406987014740975, 'recall': 0.3333242160012501, 'f1-score': 0.16314568489451736, 'support': 480205}, 'weighted avg': {'precision': 0.3413524837803922, 'recall': 0.3168188586124676, 'f1-score': 0.15520123369810773, 'support': 480205}}
[[    96 166574    596]
 [   102 151408    589]
 [    71 160135    634]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0955251
{'0': {'precision': 0.325, 'recall': 0.0002638683094160391, 'f1-score': 0.0005273084957511104, 'support': 49267}, '1': {'precision': 0.3674209521877239, 'recall': 0.9959953938435625, 'f1-score': 0.5368126574773974, 'support': 58183}, '2': {'precision': 0.33878887070376434, 'recall': 0.0040650406504065045, 'f1-score': 0.00803368715192207, 'support': 50922}, 'accuracy': 0.3672997752127901, 'macro avg': {'precision': 0.3437366076304961, 'recall': 0.333441434267795, 'f1-score': 0.18179121770835685, 'support': 158372}, 'weighted avg': {'precision': 0.34501828059957207, 'recall': 0.3672997752127901, 'f1-score': 0.19996237450318083, 'support': 158372}}
[[   13 49071   183]
 [   12 57950   221]
 [   15 50700   207]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
5760/5760 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1175992
{'0': {'precision': 0.4205933682373473, 'recall': 0.00040881964777049105, 'f1-score': 0.0008168453162733551, 'support': 589502}, '1': {'precision': 0.23545892248429875, 'recall': 0.9972645103329523, 'f1-score': 0.3809691951716791, 'support': 347287}, '2': {'precision': 0.38168449197860965, 'recall': 0.0021239477903131614, 'f1-score': 0.004224388259011967, 'support': 537678}, 'accuracy': 0.23582759058018932, 'macro avg': {'precision': 0.34591226090008526, 'recall': 0.33326575925701196, 'f1-score': 0.1286701429156548, 'support': 1474467}, 'weighted avg': {'precision': 0.36279944471699416, 'recall': 0.23582759058018932, 'f1-score': 0.09159821241272252, 'support': 1474467}}
[[   241 588181   1080]
 [   180 346337    770]
 [   152 536384   1142]]
Evaluating performance on  train set...
2159/2159 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017858
{'0': {'precision': 0.352112676056338, 'recall': 0.0008109116268509058, 'f1-score': 0.0016180967945502499, 'support': 184977}, '1': {'precision': 0.3312300261475886, 'recall': 0.9967705976853218, 'f1-score': 0.497229210904343, 'support': 183006}, '2': {'precision': 0.36637931034482757, 'recall': 0.0027634038633469696, 'f1-score': 0.005485434021522261, 'support': 184555}, 'accuracy': 0.33133467743395023, 'macro avg': {'precision': 0.3499073375162514, 'recall': 0.3334483043918399, 'f1-score': 0.1681109139068052, 'support': 552538}, 'weighted avg': {'precision': 0.34996138232072455, 'recall': 0.33133467743395023, 'f1-score': 0.16706109613703993, 'support': 552538}}
[[   150 184380    447]
 [   156 182415    435]
 [   120 183925    510]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.115055
{'0': {'precision': 0.36531365313653136, 'recall': 0.001175157874744789, 'f1-score': 0.002342779388274271, 'support': 84244}, '1': {'precision': 0.25223348331008233, 'recall': 0.9954423641368749, 'f1-score': 0.40248257663149445, 'support': 54853}, '2': {'precision': 0.3640939597315436, 'recall': 0.002773233820672733, 'f1-score': 0.005504540611841103, 'support': 78248}, 'accuracy': 0.25268122110009433, 'macro avg': {'precision': 0.3272136987260524, 'recall': 0.33313025194409746, 'f1-score': 0.1367766322105366, 'support': 217345}, 'weighted avg': {'precision': 0.3363356452456497, 'recall': 0.25268122110009433, 'f1-score': 0.10446737296256407, 'support': 217345}}
[[   99 83923   222]
 [   93 54603   157]
 [   79 77952   217]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1245242
{'0': {'precision': 0.4345364472753008, 'recall': 0.0008924859658762206, 'f1-score': 0.0017813133269217658, 'support': 687966}, '1': {'precision': 0.18726576877513057, 'recall': 0.9958792297329424, 'f1-score': 0.31525145235502056, 'support': 302856}, '2': {'precision': 0.4133423484336263, 'recall': 0.0029315107030510727, 'f1-score': 0.005821732457428184, 'support': 625616}, 'accuracy': 0.18810248212427572, 'macro avg': {'precision': 0.3450481881613525, 'recall': 0.3332344088006232, 'f1-score': 0.10761816604645684, 'support': 1616438}, 'weighted avg': {'precision': 0.38000495522377725, 'recall': 0.18810248212427572, 'f1-score': 0.06207689118406493, 'support': 1616438}}
[[   614 685647   1705]
 [   350 301608    898]
 [   449 623333   1834]]
Evaluating performance on  train set...
2155/2155 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011117
{'0': {'precision': 0.4064665127020785, 'recall': 0.0009690295939435651, 'f1-score': 0.0019334497797405222, 'support': 181625}, '1': {'precision': 0.32966793011775025, 'recall': 0.996194917024997, 'f1-score': 0.4953959106663112, 'support': 181862}, '2': {'precision': 0.3485530546623794, 'recall': 0.0028821508715581694, 'f1-score': 0.0057170282001381785, 'support': 188054}, 'accuracy': 0.32978146683564774, 'macro avg': {'precision': 0.361562499160736, 'recall': 0.3333486991634995, 'f1-score': 0.16768212954872996, 'support': 551541}, 'weighted avg': {'precision': 0.3613971501992933, 'recall': 0.32978146683564774, 'f1-score': 0.1659350147006131, 'support': 551541}}
[[   176 180986    463]
 [   142 181170    550]
 [   115 187397    542]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1073617
{'0': {'precision': 0.38181818181818183, 'recall': 0.000925205234018181, 'f1-score': 0.0018459374725306925, 'support': 68093}, '1': {'precision': 0.29782588106538144, 'recall': 0.9964615167945919, 'f1-score': 0.45858752805256464, 'support': 56804}, '2': {'precision': 0.38202247191011235, 'recall': 0.003097667638483965, 'f1-score': 0.0061455038409399, 'support': 65856}, 'accuracy': 0.2981342364209213, 'macro avg': {'precision': 0.3538888449312252, 'recall': 0.333494796555698, 'f1-score': 0.15552632312201176, 'support': 190753}, 'weighted avg': {'precision': 0.3568767920436153, 'recall': 0.2981342364209213, 'f1-score': 0.13934260360132658, 'support': 190753}}
[[   63 67850   180]
 [   51 56603   150]
 [   51 65601   204]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
6082/6082 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989549
{'0': {'precision': 0.2981230903535574, 'recall': 0.0013469115692407204, 'f1-score': 0.0026817072620082963, 'support': 507086}, '1': {'precision': 0.3527541163931646, 'recall': 0.9959060484538916, 'f1-score': 0.5209762507856095, 'support': 549347}, '2': {'precision': 0.34563758389261745, 'recall': 0.0024701868828280044, 'f1-score': 0.0049053166727189386, 'support': 500367}, 'accuracy': 0.3526573741007194, 'macro avg': {'precision': 0.3321715968797798, 'recall': 0.3332410489686534, 'f1-score': 0.17618775824011226, 'support': 1556800}, 'weighted avg': {'precision': 0.3326722134589267, 'recall': 0.3526573741007194, 'f1-score': 0.18628664904712444, 'support': 1556800}}
[[   683 505377   1026]
 [   935 547098   1314]
 [   673 498458   1236]]
Evaluating performance on  train set...
2440/2440 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101277
{'0': {'precision': 0.30895522388059704, 'recall': 0.0010089932002632156, 'f1-score': 0.0020114174662941822, 'support': 205155}, '1': {'precision': 0.3298554384476862, 'recall': 0.9960562505760396, 'f1-score': 0.49559042879278636, 'support': 206149}, '2': {'precision': 0.34206798866855526, 'recall': 0.00226461803911272, 'f1-score': 0.004499448049074726, 'support': 213281}, 'accuracy': 0.3298606274566312, 'macro avg': {'precision': 0.32695955033227947, 'recall': 0.33310995393847187, 'f1-score': 0.16736709810271844, 'support': 624585}, 'weighted avg': {'precision': 0.3271607234035305, 'recall': 0.3298606274566312, 'f1-score': 0.1657705043106325, 'support': 624585}}
[[   207 204552    396]
 [   280 205336    533]
 [   183 212615    483]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017061
{'0': {'precision': 0.38596491228070173, 'recall': 0.000900335579625133, 'f1-score': 0.0017964805313227265, 'support': 73306}, '1': {'precision': 0.34825410380491506, 'recall': 0.9965787365762928, 'f1-score': 0.5161424146647587, 'support': 73657}, '2': {'precision': 0.3141683778234086, 'recall': 0.0023730127956572314, 'f1-score': 0.004710446106954835, 'support': 64475}, 'accuracy': 0.34820609351204607, 'macro avg': {'precision': 0.3494624646363418, 'recall': 0.3332840283171917, 'f1-score': 0.1742164471010121, 'support': 211438}, 'weighted avg': {'precision': 0.35093456494940367, 'recall': 0.34820609351204607, 'f1-score': 0.18186371726717612, 'support': 211438}}
[[   66 73094   146]
 [   64 73405   188]
 [   41 64281   153]]
testing model on single stock: results/universal/W3/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
13689/13689 - 70s - 70s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010938
{'0': {'precision': 0.3781998348472337, 'recall': 0.00039159724650704664, 'f1-score': 0.0007823843933104426, 'support': 1169569}, '1': {'precision': 0.3385870789826154, 'recall': 0.9980041282853287, 'f1-score': 0.5056314911713771, 'support': 1186449}, '2': {'precision': 0.34704587777213475, 'recall': 0.001785365921632016, 'f1-score': 0.0035524563502756616, 'support': 1148224}, 'accuracy': 0.33861502715851244, 'macro avg': {'precision': 0.3546109305339946, 'recall': 0.3333936971511559, 'f1-score': 0.16998877730498774, 'support': 3504242}, 'weighted avg': {'precision': 0.3545798235034341, 'recall': 0.33861502715851244, 'f1-score': 0.1726193696787002, 'support': 3504242}}
[[    458 1167232    1879]
 [    390 1184081    1978]
 [    363 1145811    2050]]
Evaluating performance on  train set...
5475/5475 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017427
{'0': {'precision': 0.3806228373702422, 'recall': 0.00023445659355883795, 'f1-score': 0.00046862452312129493, 'support': 469170}, '1': {'precision': 0.3320326422742451, 'recall': 0.9989319889717654, 'f1-score': 0.4984024668485067, 'support': 465351}, '2': {'precision': 0.3701039168665068, 'recall': 0.0009913412869023046, 'f1-score': 0.001977386049391943, 'support': 467044}, 'accuracy': 0.3320766428956203, 'macro avg': {'precision': 0.36091979883699804, 'recall': 0.33338592895074215, 'f1-score': 0.1669494924736733, 'support': 1401565}, 'weighted avg': {'precision': 0.36098457971835735, 'recall': 0.3320766428956203, 'f1-score': 0.16629658789138177, 'support': 1401565}}
[[   110 468678    382]
 [    91 464854    406]
 [    88 466493    463]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000953
{'0': {'precision': 0.3140495867768595, 'recall': 0.00022174372261027375, 'f1-score': 0.0004431745291270628, 'support': 171369}, '1': {'precision': 0.3406414574491182, 'recall': 0.9983276179536125, 'f1-score': 0.5079606109485977, 'support': 177591}, '2': {'precision': 0.33974358974358976, 'recall': 0.0012307263607653726, 'f1-score': 0.002452568255437298, 'support': 172256}, 'accuracy': 0.34063420923379173, 'macro avg': {'precision': 0.33147821132318916, 'recall': 0.33326002934566273, 'f1-score': 0.17028545124438732, 'support': 521216}, 'weighted avg': {'precision': 0.3316016632280701, 'recall': 0.34063420923379173, 'f1-score': 0.17403082183252813, 'support': 521216}}
[[    38 171165    166]
 [    51 177294    246]
 [    32 172012    212]]
training model: results/universal/W3/deepLOB_L2/h300
Epoch 1/50
10532/10532 - 433s - loss: 3.2524 - accuracy300: 0.3928 - val_loss: 3.3546 - val_accuracy300: 0.3335 - 433s/epoch - 41ms/step
Epoch 2/50
10532/10532 - 427s - loss: 3.2228 - accuracy300: 0.4103 - val_loss: 3.4848 - val_accuracy300: 0.3264 - 427s/epoch - 41ms/step
Epoch 3/50
10532/10532 - 427s - loss: 3.2102 - accuracy300: 0.4171 - val_loss: 3.5479 - val_accuracy300: 0.3273 - 427s/epoch - 41ms/step
Epoch 4/50
10532/10532 - 428s - loss: 3.2014 - accuracy300: 0.4207 - val_loss: 3.5158 - val_accuracy300: 0.3248 - 428s/epoch - 41ms/step
Epoch 5/50
10532/10532 - 427s - loss: 3.1954 - accuracy300: 0.4230 - val_loss: 3.6209 - val_accuracy300: 0.3251 - 427s/epoch - 41ms/step
Epoch 6/50
10532/10532 - 429s - loss: 3.1904 - accuracy300: 0.4246 - val_loss: 3.6780 - val_accuracy300: 0.3226 - 429s/epoch - 41ms/step
Epoch 7/50
10532/10532 - 427s - loss: 3.1861 - accuracy300: 0.4269 - val_loss: 3.7634 - val_accuracy300: 0.3260 - 427s/epoch - 41ms/step
Epoch 8/50
10532/10532 - 427s - loss: 3.1810 - accuracy300: 0.4290 - val_loss: 3.6867 - val_accuracy300: 0.3263 - 427s/epoch - 41ms/step
Epoch 9/50
10532/10532 - 425s - loss: 3.1775 - accuracy300: 0.4308 - val_loss: 3.7535 - val_accuracy300: 0.3265 - 425s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 427s - loss: 3.1727 - accuracy300: 0.4328 - val_loss: 3.7492 - val_accuracy300: 0.3267 - 427s/epoch - 41ms/step
Epoch 11/50
10532/10532 - 427s - loss: 3.1693 - accuracy300: 0.4343 - val_loss: 3.6657 - val_accuracy300: 0.3276 - 427s/epoch - 41ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 370s - 370s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1112202
{'0': {'precision': 0.3487385846785594, 'recall': 0.05352457538434058, 'f1-score': 0.09280533997762591, 'support': 2373676}, '1': {'precision': 0.33880946672432494, 'recall': 0.9026679702360878, 'f1-score': 0.49269111869420124, 'support': 2407748}, '2': {'precision': 0.3217127909473643, 'recall': 0.04289749519859196, 'f1-score': 0.07570095210899051, 'support': 2305053}, 'accuracy': 0.33857839374910836, 'macro avg': {'precision': 0.33642028078341624, 'recall': 0.3330300136063401, 'f1-score': 0.22039913692693924, 'support': 7086477}, 'weighted avg': {'precision': 0.33657419032385477, 'recall': 0.33857839374910836, 'f1-score': 0.22310953250707538, 'support': 7086477}}
[[ 127050 2145613  101013]
 [ 126887 2173397  107464]
 [ 110376 2095796   98881]]
Evaluating performance on  train set...
10532/10532 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1240789
{'0': {'precision': 0.33087165638638105, 'recall': 0.2654765818581386, 'f1-score': 0.2945885331355021, 'support': 906434}, '1': {'precision': 0.3192177361776035, 'recall': 0.6458831947215046, 'f1-score': 0.42726592556921034, 'support': 883282}, '2': {'precision': 0.35258665372696496, 'recall': 0.07057009663477881, 'f1-score': 0.11760216139468074, 'support': 906092}, 'accuracy': 0.3246065743554437, 'macro avg': {'precision': 0.3342253487636498, 'recall': 0.32730995773814064, 'f1-score': 0.2798188733664644, 'support': 2695808}, 'weighted avg': {'precision': 0.3343519069904578, 'recall': 0.3246065743554437, 'f1-score': 0.2785731555567748, 'support': 2695808}}
[[240637 607118  58679]
 [254053 570497  58732]
 [232592 609557  63943]]
Evaluating performance on  val set...
3814/3814 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1190492
{'0': {'precision': 0.32643847861239167, 'recall': 0.2023218537481131, 'f1-score': 0.24981313493291113, 'support': 321295}, '1': {'precision': 0.33510721150283623, 'recall': 0.66514583477162, 'f1-score': 0.4456775548212314, 'support': 333151}, '2': {'precision': 0.33503698955283356, 'recall': 0.1203401485427317, 'f1-score': 0.17707696639630793, 'support': 321389}, 'accuracy': 0.3333299174553075, 'macro avg': {'precision': 0.3321942265560205, 'recall': 0.3292692790208216, 'f1-score': 0.2908558853834835, 'support': 975835}, 'weighted avg': {'precision': 0.33222989198024805, 'recall': 0.3333299174553075, 'f1-score': 0.2927259458900949, 'support': 975835}}
[[ 65005 220713  35577]
 [ 70372 221594  41185]
 [ 63757 218956  38676]]
testing model out of sample: results/universal/W3/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 228s - 228s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1222557
{'0': {'precision': 0.34883371646230804, 'recall': 0.3674072012625828, 'f1-score': 0.3578796360267983, 'support': 1365455}, '1': {'precision': 0.3773064778870267, 'recall': 0.6616892414384825, 'f1-score': 0.4805787598527648, 'support': 1463876}, '2': {'precision': 0.30798220920208425, 'recall': 0.030884409531707586, 'f1-score': 0.05613918959040085, 'support': 1307132}, 'accuracy': 0.3652103258266785, 'macro avg': {'precision': 0.34470746785047296, 'recall': 0.35332695074425763, 'f1-score': 0.29819919515665466, 'support': 4136463}, 'weighted avg': {'precision': 0.346000929058021, 'recall': 0.3652103258266785, 'f1-score': 0.3059516263621547, 'support': 4136463}}
[[501678 821446  42331]
 [446867 968631  48378]
 [489613 777149  40370]]
Evaluating performance on  train set...
6181/6181 - 95s - 95s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1264974
{'0': {'precision': 0.31718668050011106, 'recall': 0.2629938814342738, 'f1-score': 0.2875592934925359, 'support': 526594}, '1': {'precision': 0.319874266344492, 'recall': 0.6596121991993987, 'f1-score': 0.43082365241999354, 'support': 521608}, '2': {'precision': 0.34366059490777345, 'recall': 0.04479886053768378, 'f1-score': 0.07926491605625209, 'support': 533585}, 'accuracy': 0.32017838052784603, 'macro avg': {'precision': 0.32690718058412555, 'recall': 0.3224683137237854, 'f1-score': 0.2658826206562605, 'support': 1581787}, 'weighted avg': {'precision': 0.3270033940628906, 'recall': 0.32017838052784603, 'f1-score': 0.26453791346291994, 'support': 1581787}}
[[138491 364923  23180]
 [155076 344059  22473]
 [143056 366625  23904]]
Evaluating performance on  val set...
2209/2209 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182089
{'0': {'precision': 0.3257821612486015, 'recall': 0.2157574738435183, 'f1-score': 0.25959295157527357, 'support': 190297}, '1': {'precision': 0.3313123621656957, 'recall': 0.722005666964104, 'f1-score': 0.45420166825876723, 'support': 191637}, '2': {'precision': 0.3574682102865819, 'recall': 0.04121624578756182, 'f1-score': 0.07391056958424079, 'support': 182792}, 'accuracy': 0.33105435202204253, 'macro avg': {'precision': 0.338187577900293, 'recall': 0.3263264621983947, 'f1-score': 0.26256839647276053, 'support': 564726}, 'weighted avg': {'precision': 0.33791503168293546, 'recall': 0.33105435202204253, 'f1-score': 0.26553030291055796, 'support': 564726}}
[[ 41058 142375   6864]
 [ 46596 138363   6678]
 [ 38375 136883   7534]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939549
{'0': {'precision': 0.3457635119188105, 'recall': 0.02786866534774007, 'f1-score': 0.05157996655224012, 'support': 52568}, '1': {'precision': 0.42630277612594286, 'recall': 0.925150107316543, 'f1-score': 0.5836593549271755, 'support': 73614}, '2': {'precision': 0.245, 'recall': 0.0487820377038763, 'f1-score': 0.0813637166578343, 'support': 47210}, 'accuracy': 0.41450585955522745, 'macro avg': {'precision': 0.33902209601491773, 'recall': 0.3339336034560531, 'f1-score': 0.2388676793790833, 'support': 173392}, 'weighted avg': {'precision': 0.35252144768088023, 'recall': 0.41450585955522745, 'f1-score': 0.2855848972198464, 'support': 173392}}
[[ 1465 47767  3336]
 [ 1749 68104  3761]
 [ 1023 43884  2303]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1278878
{'0': {'precision': 0.3061449579831933, 'recall': 0.26620084943142897, 'f1-score': 0.28477905073649756, 'support': 21897}, '1': {'precision': 0.3150845019777059, 'recall': 0.6369542501476535, 'f1-score': 0.421609755364097, 'support': 22011}, '2': {'precision': 0.3197278911564626, 'recall': 0.03982873199232862, 'f1-score': 0.07083366383755058, 'support': 22421}, 'accuracy': 0.3127138958826456, 'macro avg': {'precision': 0.31365245037245393, 'recall': 0.314327943857137, 'f1-score': 0.2590741566460484, 'support': 66329}, 'weighted avg': {'precision': 0.31370290771168446, 'recall': 0.3127138958826456, 'f1-score': 0.25786640498421426, 'support': 66329}}
[[ 5829 15181   887]
 [ 6978 14020  1013]
 [ 6233 15295   893]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1243583
{'0': {'precision': 0.27462543831686326, 'recall': 0.2351255458515284, 'f1-score': 0.25334509630936636, 'support': 7328}, '1': {'precision': 0.34458885768401804, 'recall': 0.6527279475442286, 'f1-score': 0.45105582628024277, 'support': 8083}, '2': {'precision': 0.37822349570200575, 'recall': 0.02023608768971332, 'f1-score': 0.038416763678696154, 'support': 6523}, 'accuracy': 0.3251116987325613, 'macro avg': {'precision': 0.33247926390096233, 'recall': 0.3026965270284901, 'f1-score': 0.24760589542276842, 'support': 21934}, 'weighted avg': {'precision': 0.33121723402526104, 'recall': 0.3251116987325613, 'f1-score': 0.2622863891243902, 'support': 21934}}
[[1723 5484  121]
 [2711 5276   96]
 [1840 4551  132]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1054556
{'0': {'precision': 0.3217738816552791, 'recall': 0.02056826422308656, 'f1-score': 0.03866500398887762, 'support': 121352}, '1': {'precision': 0.3632668144863267, 'recall': 0.9386853208971797, 'f1-score': 0.5238183755917416, 'support': 135090}, '2': {'precision': 0.271901623533194, 'recall': 0.02998289477182689, 'f1-score': 0.05401004206812322, 'support': 112831}, 'accuracy': 0.3593168198054014, 'macro avg': {'precision': 0.3189807732249333, 'recall': 0.3297454932973644, 'f1-score': 0.20549780721624747, 'support': 369273}, 'weighted avg': {'precision': 0.3217146938456457, 'recall': 0.3593168198054014, 'f1-score': 0.22083582330507529, 'support': 369273}}
[[  2496 115180   3676]
 [  2900 126807   5383]
 [  2361 107087   3383]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.127179
{'0': {'precision': 0.3522038464416673, 'recall': 0.33008380965739736, 'f1-score': 0.34078525786072444, 'support': 57034}, '1': {'precision': 0.30435165028475936, 'recall': 0.5344944102257149, 'f1-score': 0.3878524641843848, 'support': 51791}, '2': {'precision': 0.35385632213127255, 'recall': 0.12597285067873304, 'f1-score': 0.18580066471789533, 'support': 55250}, 'accuracy': 0.3258753618771903, 'macro avg': {'precision': 0.33680393961923305, 'recall': 0.3301836901872817, 'f1-score': 0.3048127955876682, 'support': 164075}, 'weighted avg': {'precision': 0.3376555373798862, 'recall': 0.3258753618771903, 'f1-score': 0.3034532993756864, 'support': 164075}}
[[18826 31767  6441]
 [17841 27682  6268]
 [16785 31505  6960]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1391559
{'0': {'precision': 0.3095561035758323, 'recall': 0.4404772348451619, 'f1-score': 0.36359028205221045, 'support': 22798}, '1': {'precision': 0.3056435241575315, 'recall': 0.4933805216935378, 'f1-score': 0.37745687926193344, 'support': 22887}, '2': {'precision': 0.3622795115332429, 'recall': 0.010926054753038426, 'f1-score': 0.02121236196075316, 'support': 24437}, 'accuracy': 0.3080488291834232, 'macro avg': {'precision': 0.3258263797555356, 'recall': 0.31492793709724604, 'f1-score': 0.254086507758299, 'support': 70122}, 'weighted avg': {'precision': 0.32665280240228606, 'recall': 0.3080488291834232, 'f1-score': 0.24879999622271312, 'support': 70122}}
[[10042 12490   266]
 [11391 11292   204]
 [11007 13163   267]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
1359/1359 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1025684
{'0': {'precision': 0.35264497878359263, 'recall': 0.24442657987098293, 'f1-score': 0.2887285613368693, 'support': 102002}, '1': {'precision': 0.4423641167116724, 'recall': 0.7197864884687475, 'f1-score': 0.5479629107847724, 'support': 147252}, '2': {'precision': 0.24801343928323824, 'recall': 0.09438136117791511, 'f1-score': 0.13673014869642558, 'support': 98547}, 'accuracy': 0.4031702036509383, 'macro avg': {'precision': 0.34767417825950114, 'recall': 0.35286480983921514, 'f1-score': 0.3244738736060224, 'support': 347801}, 'weighted avg': {'precision': 0.36098364996350346, 'recall': 0.4031702036509383, 'f1-score': 0.355415514089808, 'support': 347801}}
[[ 24932  66899  10171]
 [ 23232 105990  18030]
 [ 22536  66710   9301]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.141264
{'0': {'precision': 0.33266330161849883, 'recall': 0.5989491180097581, 'f1-score': 0.42774953811397337, 'support': 37302}, '1': {'precision': 0.3293226275285316, 'recall': 0.3719891272169443, 'f1-score': 0.3493580022242443, 'support': 37157}, '2': {'precision': 0.35180614763293694, 'recall': 0.04007155635062612, 'f1-score': 0.07194805790717416, 'support': 39130}, 'accuracy': 0.3321800526459428, 'macro avg': {'precision': 0.3379306922599891, 'recall': 0.33700326719244283, 'f1-score': 0.28301853274846395, 'support': 113589}, 'weighted avg': {'precision': 0.3381649799269975, 'recall': 0.3321800526459428, 'f1-score': 0.27953706842459575, 'support': 113589}}
[[22342 13547  1413]
 [21859 13822  1476]
 [22960 14602  1568]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1236265
{'0': {'precision': 0.35621506083525156, 'recall': 0.3376714463840399, 'f1-score': 0.34669547127540407, 'support': 12832}, '1': {'precision': 0.2967995024637612, 'recall': 0.5444493198771391, 'f1-score': 0.3841723945755155, 'support': 11395}, '2': {'precision': 0.38405594405594407, 'recall': 0.11059202577527184, 'f1-score': 0.17173233270794247, 'support': 12415}, 'accuracy': 0.32503684296708696, 'macro avg': {'precision': 0.34569016911831896, 'recall': 0.3309042640121503, 'f1-score': 0.300866732852954, 'support': 36642}, 'weighted avg': {'precision': 0.34717091143133705, 'recall': 0.32503684296708696, 'f1-score': 0.29906930937621007, 'support': 36642}}
[[4333 7351 1148]
 [4137 6204 1054]
 [3694 7348 1373]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1128546
{'0': {'precision': 0.3359029739159329, 'recall': 0.344202569573705, 'f1-score': 0.3400021301284243, 'support': 88108}, '1': {'precision': 0.38801624652038874, 'recall': 0.6309484012612824, 'f1-score': 0.4805235018475321, 'support': 110681}, '2': {'precision': 0.30431523216042733, 'recall': 0.06997715911049819, 'f1-score': 0.11378866318030117, 'support': 92816}, 'accuracy': 0.36575504535244596, 'macro avg': {'precision': 0.3427448175322496, 'recall': 0.34837604331516187, 'f1-score': 0.3114380983854192, 'support': 291605}, 'weighted avg': {'precision': 0.3456288060736626, 'recall': 0.36575504535244596, 'f1-score': 0.321335841124414, 'support': 291605}}
[[30327 51351  6430]
 [32429 69834  8418]
 [27529 58792  6495]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1347301
{'0': {'precision': 0.3395253400156162, 'recall': 0.5750753521559944, 'f1-score': 0.4269680881429468, 'support': 32514}, '1': {'precision': 0.3290157697557576, 'recall': 0.34787815513111836, 'f1-score': 0.3381841520022687, 'support': 32566}, '2': {'precision': 0.3666853617498598, 'recall': 0.09805333093374126, 'f1-score': 0.1547309130496521, 'support': 33339}, 'accuracy': 0.3383086599132281, 'macro avg': {'precision': 0.34507549050707786, 'recall': 0.3403356127402846, 'f1-score': 0.30662771773162256, 'support': 98419}, 'weighted avg': {'precision': 0.34524815064684994, 'recall': 0.3383086599132281, 'f1-score': 0.3053711114942034, 'support': 98419}}
[[18698 11181  2635]
 [18226 11329  3011]
 [18147 11923  3269]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1197326
{'0': {'precision': 0.29574809746561476, 'recall': 0.3795698924731183, 'f1-score': 0.332456932072362, 'support': 11160}, '1': {'precision': 0.3752636336245857, 'recall': 0.5459526592635885, 'f1-score': 0.44479495268138797, 'support': 13688}, '2': {'precision': 0.335978835978836, 'recall': 0.03620640501758054, 'f1-score': 0.06536844814274685, 'support': 10523}, 'accuracy': 0.3418054338299737, 'macro avg': {'precision': 0.3356635223563455, 'recall': 0.32057631891809574, 'f1-score': 0.28087344429883226, 'support': 35371}, 'weighted avg': {'precision': 0.33848810256353734, 'recall': 0.3418054338299737, 'f1-score': 0.29647012677155077, 'support': 35371}}
[[4236 6468  456]
 [5918 7473  297]
 [4169 5973  381]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1215956
{'0': {'precision': 0.3432730083081085, 'recall': 0.16454341517627447, 'f1-score': 0.22245563756008319, 'support': 194356}, '1': {'precision': 0.3613397410706249, 'recall': 0.8132451836369655, 'f1-score': 0.5003602513551227, 'support': 202383}, '2': {'precision': 0.3382660856770981, 'recall': 0.06384308112957662, 'f1-score': 0.1074133640014735, 'support': 187256}, 'accuracy': 0.3570612762095566, 'macro avg': {'precision': 0.34762627835194376, 'recall': 0.3472105599809389, 'f1-score': 0.27674308430555977, 'support': 583995}, 'weighted avg': {'precision': 0.34792856746954626, 'recall': 0.3570612762095566, 'f1-score': 0.2818753474483364, 'support': 583995}}
[[ 31980 149264  13112]
 [ 27521 164587  10275]
 [ 33661 141640  11955]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128776
{'0': {'precision': 0.32787301587301587, 'recall': 0.31267912646833246, 'f1-score': 0.32009587173023685, 'support': 74319}, '1': {'precision': 0.3342538704938411, 'recall': 0.6377946388862684, 'f1-score': 0.438631044789953, 'support': 74201}, '2': {'precision': 0.36860957342885053, 'recall': 0.05940464164359839, 'f1-score': 0.10231959054086119, 'support': 76223}, 'accuracy': 0.33411941640006587, 'macro avg': {'precision': 0.34357881993190253, 'recall': 0.3366261356660665, 'f1-score': 0.28701550235368367, 'support': 224743}, 'weighted avg': {'precision': 0.34379577395802063, 'recall': 0.33411941640006587, 'f1-score': 0.28537117238523485, 'support': 224743}}
[[23238 46696  4385]
 [23505 47325  3371]
 [24132 47563  4528]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311115
{'0': {'precision': 0.32076773917901863, 'recall': 0.37905856765574025, 'f1-score': 0.347485536270583, 'support': 25748}, '1': {'precision': 0.32709871000240914, 'recall': 0.5766186633720706, 'f1-score': 0.4174119619899385, 'support': 25901}, '2': {'precision': 0.38095238095238093, 'recall': 0.018975036939108795, 'f1-score': 0.036149487018037704, 'support': 25718}, 'accuracy': 0.3255005364044101, 'macro avg': {'precision': 0.3429396100446029, 'recall': 0.32488408932230656, 'f1-score': 0.2670156617595197, 'support': 77367}, 'weighted avg': {'precision': 0.3428935433645754, 'recall': 0.3255005364044101, 'f1-score': 0.267402604760767, 'support': 77367}}
[[ 9760 15589   399]
 [10572 14935   394]
 [10095 15135   488]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
5098/5098 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1190977
{'0': {'precision': 0.3608200172455313, 'recall': 0.09964986955924757, 'f1-score': 0.15616946377267205, 'support': 466112}, '1': {'precision': 0.3000322236503388, 'recall': 0.8177595947015465, 'f1-score': 0.43899807742637514, 'support': 403061}, '2': {'precision': 0.31368380363355236, 'recall': 0.05587072965864809, 'f1-score': 0.09484793940952335, 'support': 435738}, 'accuracy': 0.3068408496824688, 'macro avg': {'precision': 0.32484534817647415, 'recall': 0.32442673130648075, 'f1-score': 0.23000516020285686, 'support': 1304911}, 'weighted avg': {'precision': 0.3263040783645438, 'recall': 0.3068408496824688, 'f1-score': 0.22305300254652372, 'support': 1304911}}
[[ 46448 395605  24059]
 [ 44248 329607  29206]
 [ 38033 373360  24345]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1263927
{'0': {'precision': 0.32837473609919626, 'recall': 0.3325528663676246, 'f1-score': 0.3304505949665857, 'support': 162296}, '1': {'precision': 0.31414350310210665, 'recall': 0.5690285714285714, 'f1-score': 0.40480588992524674, 'support': 157500}, '2': {'precision': 0.3846053148317843, 'recall': 0.07326180872882783, 'f1-score': 0.1230788565563684, 'support': 160411}, 'accuracy': 0.3234979914911694, 'macro avg': {'precision': 0.3423745180110291, 'recall': 0.3249477488416746, 'f1-score': 0.2861117804827336, 'support': 480207}, 'weighted avg': {'precision': 0.3424906989402868, 'recall': 0.3234979914911694, 'f1-score': 0.28556630761939533, 'support': 480207}}
[[53972 98343  9981]
 [59055 89622  8823]
 [51334 97325 11752]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1333174
{'0': {'precision': 0.3211847698496815, 'recall': 0.5529656444365962, 'f1-score': 0.40634687198119873, 'support': 50967}, '1': {'precision': 0.3284337715375399, 'recall': 0.35138843751128446, 'f1-score': 0.3395235644566175, 'support': 55386}, '2': {'precision': 0.3469387755102041, 'recall': 0.0758184509506142, 'f1-score': 0.12444192026756273, 'support': 52019}, 'accuracy': 0.32574571262596924, 'macro avg': {'precision': 0.33218577229914176, 'recall': 0.3267241776328316, 'f1-score': 0.290104118901793, 'support': 158372}, 'weighted avg': {'precision': 0.33217907962627363, 'recall': 0.32574571262596924, 'f1-score': 0.2903826270783871, 'support': 158372}}
[[28183 19481  3303]
 [31803 19462  4121]
 [27761 20314  3944]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
5760/5760 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007823
{'0': {'precision': 0.316525397512838, 'recall': 0.02167112500503019, 'f1-score': 0.040564943753407, 'support': 472149}, '1': {'precision': 0.3820480574258685, 'recall': 0.9600325960171076, 'f1-score': 0.5465820365309866, 'support': 563259}, '2': {'precision': 0.29702859278639504, 'recall': 0.01809990821362766, 'f1-score': 0.03412062221726082, 'support': 439063}, 'accuracy': 0.37906883214386716, 'macro avg': {'precision': 0.3318673492417005, 'recall': 0.3332678764119218, 'f1-score': 0.20708920083388482, 'support': 1474471}, 'weighted avg': {'precision': 0.3357498531490271, 'recall': 0.37906883214386716, 'f1-score': 0.23194830667758912, 'support': 1474471}}
[[ 10232 453223   8694]
 [ 12398 540747  10114]
 [  9696 421420   7947]]
Evaluating performance on  train set...
2159/2159 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1234671
{'0': {'precision': 0.335356612409445, 'recall': 0.23925760131482202, 'f1-score': 0.27927126323627777, 'support': 184968}, '1': {'precision': 0.32985861428549257, 'recall': 0.7002580857723354, 'f1-score': 0.44846600739917564, 'support': 182110}, '2': {'precision': 0.33561946251434965, 'recall': 0.06147923283062207, 'f1-score': 0.10392190818195904, 'support': 185461}, 'accuracy': 0.331525919437361, 'macro avg': {'precision': 0.3336115630697624, 'recall': 0.3336649733059265, 'f1-score': 0.2772197262724708, 'support': 552539}, 'weighted avg': {'precision': 0.33363276668082265, 'recall': 0.331525919437361, 'f1-score': 0.2761793332942761, 'support': 552539}}
[[ 44255 129683  11030]
 [ 43045 127524  11541]
 [ 44664 129395  11402]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1087338
{'0': {'precision': 0.36647288247847526, 'recall': 0.06936899289594652, 'f1-score': 0.11665632064090703, 'support': 71790}, '1': {'precision': 0.34926474436129573, 'recall': 0.8845022264631043, 'f1-score': 0.5007841048074253, 'support': 75456}, '2': {'precision': 0.3522816990367914, 'recall': 0.06365283384927031, 'f1-score': 0.10782335528303026, 'support': 70099}, 'accuracy': 0.3505164600059813, 'macro avg': {'precision': 0.35600644195885417, 'recall': 0.3391746844027737, 'f1-score': 0.24175459357712084, 'support': 217345}, 'weighted avg': {'precision': 0.35592170790418787, 'recall': 0.3505164600059813, 'f1-score': 0.24716571374149365, 'support': 217345}}
[[ 4980 62668  4142]
 [ 4653 66741  4062]
 [ 3956 61681  4462]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
6315/6315 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1150649
{'0': {'precision': 0.3637888074066201, 'recall': 0.05461591921254929, 'f1-score': 0.09497340183651418, 'support': 564048}, '1': {'precision': 0.3222590820601098, 'recall': 0.8713708371578752, 'f1-score': 0.4705095969786332, 'support': 521849}, '2': {'precision': 0.3349929583298815, 'recall': 0.07621785145463628, 'f1-score': 0.12418177211691274, 'support': 530545}, 'accuracy': 0.32538563091035744, 'macro avg': {'precision': 0.3403469492655371, 'recall': 0.3340682026083536, 'f1-score': 0.22988825697735338, 'support': 1616442}, 'weighted avg': {'precision': 0.34093012185479127, 'recall': 0.32538563091035744, 'f1-score': 0.2257974850446551, 'support': 1616442}}
[[ 30806 491759  41483]
 [ 28335 454724  38790]
 [ 25540 464568  40437]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1262342
{'0': {'precision': 0.33869036503246075, 'recall': 0.3372178868102001, 'f1-score': 0.33795252201125153, 'support': 182861}, '1': {'precision': 0.3270561674805286, 'recall': 0.5736930934442324, 'f1-score': 0.41660842276859117, 'support': 181306}, '2': {'precision': 0.3597892854365912, 'recall': 0.09878104753060724, 'f1-score': 0.155005066619769, 'support': 187374}, 'accuracy': 0.3339497879577402, 'macro avg': {'precision': 0.3418452726498602, 'recall': 0.3365640092616799, 'f1-score': 0.30318867046653725, 'support': 551541}, 'weighted avg': {'precision': 0.3420337960565422, 'recall': 0.3339497879577402, 'f1-score': 0.3016563812641204, 'support': 551541}}
[[ 61664 104485  16712]
 [ 61069 104014  16223]
 [ 59333 109532  18509]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1220981
{'0': {'precision': 0.34463653619247936, 'recall': 0.2067935911840303, 'f1-score': 0.25848651872372763, 'support': 64973}, '1': {'precision': 0.32459958617518586, 'recall': 0.6875131880082456, 'f1-score': 0.4409913638280262, 'support': 61609}, '2': {'precision': 0.35891531158943507, 'recall': 0.11900829022003366, 'f1-score': 0.17874780573434756, 'support': 64172}, 'accuracy': 0.3325225159105445, 'macro avg': {'precision': 0.34271714465236675, 'recall': 0.33777168980410316, 'f1-score': 0.2927418960953671, 'support': 190754}, 'weighted avg': {'precision': 0.34296863471286687, 'recall': 0.3325225159105445, 'f1-score': 0.2906061508786299, 'support': 190754}}
[[13436 44398  7139]
 [12750 42357  6502]
 [12800 43735  7637]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
6082/6082 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1503462
{'0': {'precision': 0.349657633797358, 'recall': 0.795455380432786, 'f1-score': 0.4857809537698702, 'support': 544380}, '1': {'precision': 0.30079150331648663, 'recall': 0.1867615759749292, 'f1-score': 0.23044176146276785, 'support': 477368}, '2': {'precision': 0.4026677592643176, 'recall': 0.016530979934810563, 'f1-score': 0.03175817113148134, 'support': 535056}, 'accuracy': 0.34110202697320924, 'macro avg': {'precision': 0.35103896545938734, 'recall': 0.33291597878084195, 'f1-score': 0.24932696212137315, 'support': 1556804}, 'weighted avg': {'precision': 0.35289263236908375, 'recall': 0.34110202697320924, 'f1-score': 0.2514429294966652, 'support': 1556804}}
[[433030 104354   6996]
 [382089  89154   6125]
 [423321 102890   8845]]
Evaluating performance on  train set...
2440/2440 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1255547
{'0': {'precision': 0.2905731282941819, 'recall': 0.2058354316028216, 'f1-score': 0.24097185305194824, 'support': 208108}, '1': {'precision': 0.30676478814909897, 'recall': 0.6863614532647032, 'f1-score': 0.42401764654756446, 'support': 206129}, '2': {'precision': 0.34700394464967754, 'recall': 0.026346565248395532, 'f1-score': 0.04897468639675506, 'support': 210350}, 'accuracy': 0.30397206474038047, 'macro avg': {'precision': 0.3147806203643195, 'recall': 0.3061811500386401, 'f1-score': 0.2379880619987559, 'support': 624587}, 'weighted avg': {'precision': 0.3149216864207723, 'recall': 0.30397206474038047, 'f1-score': 0.23672015130589527, 'support': 624587}}
[[ 42836 159824   5448]
 [ 59669 141479   4981]
 [ 44914 159894   5542]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1220706
{'0': {'precision': 0.3181739253974017, 'recall': 0.2776346781636111, 'f1-score': 0.29652514196604585, 'support': 72599}, '1': {'precision': 0.31324287802322054, 'recall': 0.6417050365808875, 'f1-score': 0.4209853321349481, 'support': 70802}, '2': {'precision': 0.3257799671592775, 'recall': 0.014580301894557373, 'f1-score': 0.027911426240117044, 'support': 68037}, 'accuracy': 0.3149008219903707, 'macro avg': {'precision': 0.3190655901932999, 'recall': 0.31130667221301866, 'f1-score': 0.2484739667803703, 'support': 211438}, 'weighted avg': {'precision': 0.31897020727277875, 'recall': 0.3149008219903707, 'f1-score': 0.25176667379804196, 'support': 211438}}
[[20156 51356  1087]
 [24402 45434   966]
 [18791 48254   992]]
testing model on single stock: results/universal/W3/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
13689/13689 - 183s - 183s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1069177
{'0': {'precision': 0.32073795436931746, 'recall': 0.014962224087699373, 'f1-score': 0.02859070953588119, 'support': 1134056}, '1': {'precision': 0.3530944557883063, 'recall': 0.9638257264966247, 'f1-score': 0.5168445665121747, 'support': 1237067}, '2': {'precision': 0.3199737187910644, 'recall': 0.02105949663010988, 'f1-score': 0.039518059519699, 'support': 1133123}, 'accuracy': 0.35190109370175493, 'macro avg': {'precision': 0.33126870964956273, 'recall': 0.33328248240481134, 'f1-score': 0.19498444518925162, 'support': 3504246}, 'weighted avg': {'precision': 0.3319133077063113, 'recall': 0.35190109370175493, 'f1-score': 0.20448725495073108, 'support': 3504246}}
[[  16968 1092178   24910]
 [  18945 1192317   25805]
 [  16990 1092270   23863]]
Evaluating performance on  train set...
5475/5475 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1213015
{'0': {'precision': 0.32082086111375396, 'recall': 0.1858524703802395, 'f1-score': 0.23536012606660642, 'support': 471729}, '1': {'precision': 0.318987200479781, 'recall': 0.7328908391090131, 'f1-score': 0.4445055191304371, 'support': 460119}, '2': {'precision': 0.3310796564665533, 'recall': 0.050144980605384505, 'f1-score': 0.08709816385355941, 'support': 469718}, 'accuracy': 0.31995853209909486, 'macro avg': {'precision': 0.3236292393533628, 'recall': 0.322962763364879, 'f1-score': 0.25565460301686765, 'support': 1401566}, 'weighted avg': {'precision': 0.32365700207199866, 'recall': 0.31995853209909486, 'f1-score': 0.254332087960908, 'support': 1401566}}
[[ 87672 360884  23173]
 [ 98486 337217  24416]
 [ 87116 359048  23554]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110393
{'0': {'precision': 0.3634906361183876, 'recall': 0.05424248965851211, 'f1-score': 0.09439824545371471, 'support': 171397}, '1': {'precision': 0.3403126475775595, 'recall': 0.7865085950072669, 'f1-score': 0.47506882581560894, 'support': 179581}, '2': {'precision': 0.32976440082875325, 'recall': 0.15613435308215556, 'f1-score': 0.2119270773119227, 'support': 170238}, 'accuracy': 0.3398188083251473, 'macro avg': {'precision': 0.34452256150823346, 'recall': 0.3322951459159782, 'f1-score': 0.2604647161937488, 'support': 521216}, 'weighted avg': {'precision': 0.34448927544759617, 'recall': 0.3398188083251473, 'f1-score': 0.26394230544006764, 'support': 521216}}
[[  9297 137906  24194]
 [  8510 141242  29829]
 [  7770 135888  26580]]
training model: results/universal/W3/deepLOB_L2/h500
Epoch 1/50
10532/10532 - 431s - loss: 3.2241 - accuracy500: 0.4114 - val_loss: 3.3652 - val_accuracy500: 0.3162 - 431s/epoch - 41ms/step
Epoch 2/50
10532/10532 - 427s - loss: 3.1929 - accuracy500: 0.4279 - val_loss: 3.4503 - val_accuracy500: 0.3233 - 427s/epoch - 41ms/step
Epoch 3/50
10532/10532 - 425s - loss: 3.1773 - accuracy500: 0.4350 - val_loss: 3.4909 - val_accuracy500: 0.3341 - 425s/epoch - 40ms/step
Epoch 4/50
10532/10532 - 426s - loss: 3.1674 - accuracy500: 0.4389 - val_loss: 3.5211 - val_accuracy500: 0.3178 - 426s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 429s - loss: 3.1572 - accuracy500: 0.4435 - val_loss: 3.5434 - val_accuracy500: 0.3157 - 429s/epoch - 41ms/step
Epoch 6/50
10532/10532 - 429s - loss: 3.1481 - accuracy500: 0.4473 - val_loss: 3.6012 - val_accuracy500: 0.3092 - 429s/epoch - 41ms/step
Epoch 7/50
10532/10532 - 426s - loss: 3.1437 - accuracy500: 0.4488 - val_loss: 3.5896 - val_accuracy500: 0.3145 - 426s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 427s - loss: 3.1357 - accuracy500: 0.4514 - val_loss: 3.6364 - val_accuracy500: 0.3297 - 427s/epoch - 41ms/step
Epoch 9/50
10532/10532 - 429s - loss: 3.1310 - accuracy500: 0.4527 - val_loss: 3.6228 - val_accuracy500: 0.3155 - 429s/epoch - 41ms/step
Epoch 10/50
10532/10532 - 426s - loss: 3.1266 - accuracy500: 0.4545 - val_loss: 3.6478 - val_accuracy500: 0.3286 - 426s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 428s - loss: 3.1219 - accuracy500: 0.4559 - val_loss: 3.6856 - val_accuracy500: 0.3364 - 428s/epoch - 41ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 371s - 371s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1073014
{'0': {'precision': 0.3577318204183876, 'recall': 0.04893863618839988, 'f1-score': 0.08609874225211803, 'support': 2451233}, '1': {'precision': 0.3209118698858653, 'recall': 0.6221679846655106, 'f1-score': 0.42342351048757876, 'support': 2288697}, '2': {'precision': 0.32797837445385125, 'recall': 0.3234194755101858, 'f1-score': 0.32568297193613444, 'support': 2346547}, 'accuracy': 0.32496161350696545, 'macro avg': {'precision': 0.3355406882527014, 'recall': 0.3315086987880321, 'f1-score': 0.2784017415586104, 'support': 7086477}, 'weighted avg': {'precision': 0.3359879313615718, 'recall': 0.32496161350696545, 'f1-score': 0.27437704196275475, 'support': 7086477}}
[[ 119960 1528536  802737]
 [ 112469 1423954  752274]
 [ 102906 1484722  758919]]
Evaluating performance on  train set...
10532/10532 - 160s - 160s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157025
{'0': {'precision': 0.3225557540376789, 'recall': 0.19353637501754137, 'f1-score': 0.24191909879262133, 'support': 905003}, '1': {'precision': 0.313221125728226, 'recall': 0.41924292956769244, 'f1-score': 0.3585588709871637, 'support': 887817}, '2': {'precision': 0.33895475730067964, 'recall': 0.3620313891214501, 'f1-score': 0.350113229087961, 'support': 902988}, 'accuracy': 0.3243079625848725, 'macro avg': {'precision': 0.3249105456888615, 'recall': 0.32493689790222796, 'f1-score': 0.31686373295591536, 'support': 2695808}, 'weighted avg': {'precision': 0.3249745692710475, 'recall': 0.3243079625848725, 'f1-score': 0.31657307042471466, 'support': 2695808}}
[[175151 408393 321459]
 [199510 372211 316096]
 [168349 407729 326910]]
Evaluating performance on  val set...
3814/3814 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1219666
{'0': {'precision': 0.3381305114638448, 'recall': 0.14498496609051806, 'f1-score': 0.2029487483486332, 'support': 330586}, '1': {'precision': 0.29314428090724615, 'recall': 0.3615317358743997, 'f1-score': 0.3237661317090746, 'support': 315668}, '2': {'precision': 0.3277769658816255, 'recall': 0.4423404261774799, 'f1-score': 0.37653740656752194, 'support': 329581}, 'accuracy': 0.31546419220462474, 'macro avg': {'precision': 0.3196839194175722, 'recall': 0.3162857093807992, 'f1-score': 0.30108409554174326, 'support': 975835}, 'weighted avg': {'precision': 0.32008130710668015, 'recall': 0.31546419220462474, 'f1-score': 0.30065963731558293, 'support': 975835}}
[[ 47930 138813 143843]
 [ 46399 114124 155145]
 [ 47421 136373 145787]]
testing model out of sample: results/universal/W3/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 231s - 231s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1170161
{'0': {'precision': 0.3725622651161174, 'recall': 0.28453205631686196, 'f1-score': 0.3226505052376073, 'support': 1469258}, '1': {'precision': 0.3260917452434536, 'recall': 0.47663929192835613, 'f1-score': 0.38724835931130214, 'support': 1276481}, '2': {'precision': 0.32031336384666487, 'recall': 0.2645399087094204, 'f1-score': 0.2897672698660611, 'support': 1390724}, 'accuracy': 0.3370933089453477, 'macro avg': {'precision': 0.3396557914020786, 'recall': 0.34190375231821285, 'f1-score': 0.33322204480499024, 'support': 4136463}, 'weighted avg': {'precision': 0.3406551655852777, 'recall': 0.3370933089453477, 'f1-score': 0.33152920879109876, 'support': 4136463}}
[[418051 648226 402981]
 [290374 608421 377686]
 [413672 609150 367902]]
Evaluating performance on  train set...
6181/6181 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1147507
{'0': {'precision': 0.308226048052368, 'recall': 0.1776769751607136, 'f1-score': 0.22541399936781098, 'support': 525780}, '1': {'precision': 0.3186326139936805, 'recall': 0.47573161002990144, 'f1-score': 0.3816476167455138, 'support': 522717}, '2': {'precision': 0.338409635072241, 'recall': 0.3161825648333927, 'f1-score': 0.3269187332109935, 'support': 533290}, 'accuracy': 0.32286837608350555, 'macro avg': {'precision': 0.3217560990394298, 'recall': 0.3231970500080026, 'f1-score': 0.3113267831081061, 'support': 1581787}, 'weighted avg': {'precision': 0.32184121498127377, 'recall': 0.32286837608350555, 'f1-score': 0.3112646399951846, 'support': 1581787}}
[[ 93419 264327 168034]
 [112432 248673 161612]
 [ 97235 267438 168617]]
Evaluating performance on  val set...
2209/2209 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1136465
{'0': {'precision': 0.33337643407936807, 'recall': 0.14117676340285729, 'f1-score': 0.19835502619229128, 'support': 200890}, '1': {'precision': 0.29311716919629216, 'recall': 0.5328206552558182, 'f1-score': 0.3781855668409445, 'support': 172818}, '2': {'precision': 0.3405353150867017, 'recall': 0.2950611984210912, 'f1-score': 0.3161715208903648, 'support': 191018}, 'accuracy': 0.3130792632179145, 'macro avg': {'precision': 0.322342972787454, 'recall': 0.32301953902658886, 'f1-score': 0.2975707046412002, 'support': 564726}, 'weighted avg': {'precision': 0.32347773894880116, 'recall': 0.3130792632179145, 'f1-score': 0.29323825373636675, 'support': 564726}}
[[ 28361 113954  58575]
 [ 30164  92081  50573]
 [ 26547 108109  56362]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097306
{'0': {'precision': 0.2968323320589842, 'recall': 0.021372394809280378, 'f1-score': 0.03987381240600125, 'support': 50860}, '1': {'precision': 0.45973314045339475, 'recall': 0.6264232175739813, 'f1-score': 0.5302873954376798, 'support': 77114}, '2': {'precision': 0.25433061123484285, 'recall': 0.3620590955127923, 'f1-score': 0.29878082017551827, 'support': 45418}, 'accuracy': 0.379700332195257, 'macro avg': {'precision': 0.33696536124907395, 'recall': 0.33661823596535134, 'f1-score': 0.2896473426730664, 'support': 173392}, 'weighted avg': {'precision': 0.3581476740709324, 'recall': 0.379700332195257, 'f1-score': 0.3257969894890315, 'support': 173392}}
[[ 1087 28830 20943]
 [ 1539 48306 27269]
 [ 1036 27938 16444]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173245
{'0': {'precision': 0.30803036356372354, 'recall': 0.17630916990624285, 'f1-score': 0.22425828970331588, 'support': 21865}, '1': {'precision': 0.31861078546307153, 'recall': 0.4959850351309426, 'f1-score': 0.387986723294907, 'support': 21918}, '2': {'precision': 0.3325886056667005, 'recall': 0.2905171649073006, 'f1-score': 0.31013257575757575, 'support': 22546}, 'accuracy': 0.32076467306909495, 'macro avg': {'precision': 0.3197432515644985, 'recall': 0.32093712331482865, 'f1-score': 0.30745919625193285, 'support': 66329}, 'weighted avg': {'precision': 0.3198742299516327, 'recall': 0.32076467306909495, 'f1-score': 0.30755098913855294, 'support': 66329}}
[[ 3855 11507  6503]
 [ 4406 10871  6641]
 [ 4254 11742  6550]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1120088
{'0': {'precision': 0.2617222723174031, 'recall': 0.16219614417435038, 'f1-score': 0.20027600483008454, 'support': 7158}, '1': {'precision': 0.38333912439193885, 'recall': 0.5060199518403853, 'f1-score': 0.43621805960559484, 'support': 8721}, '2': {'precision': 0.27113264283327765, 'recall': 0.2680429397192403, 'f1-score': 0.26957893862635995, 'support': 6055}, 'accuracy': 0.328120725813805, 'macro avg': {'precision': 0.3053980131808732, 'recall': 0.31208634524465867, 'f1-score': 0.3020243343540131, 'support': 21934}, 'weighted avg': {'precision': 0.31267514732495516, 'recall': 0.328120725813805, 'f1-score': 0.31321846511246226, 'support': 21934}}
[[1161 3924 2073]
 [2018 4413 2290]
 [1257 3175 1623]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122735
{'0': {'precision': 0.3829241480395749, 'recall': 0.022314120175950573, 'f1-score': 0.04217082209562755, 'support': 140494}, '1': {'precision': 0.2674769024992363, 'recall': 0.6525991358037126, 'f1-score': 0.37943645557907807, 'support': 99283}, '2': {'precision': 0.34360380978023086, 'recall': 0.3153610922345092, 'f1-score': 0.3288772206742152, 'support': 129496}, 'accuracy': 0.2945381871948396, 'macro avg': {'precision': 0.33133495343968067, 'recall': 0.3300914494047242, 'f1-score': 0.2501614994496403, 'support': 369273}, 'weighted avg': {'precision': 0.33809613352940643, 'recall': 0.2945381871948396, 'f1-score': 0.23338998970189773, 'support': 369273}}
[[ 3135 91616 45743]
 [ 2220 64792 32271]
 [ 2832 85826 40838]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1148037
{'0': {'precision': 0.3328012573365094, 'recall': 0.24749799108773468, 'f1-score': 0.28387988730270114, 'support': 54756}, '1': {'precision': 0.32293575032944427, 'recall': 0.3607266591272192, 'f1-score': 0.34078671788218734, 'support': 55707}, '2': {'precision': 0.33825742703834577, 'recall': 0.3856785794225173, 'f1-score': 0.3604148509674045, 'support': 53612}, 'accuracy': 0.3310924881913759, 'macro avg': {'precision': 0.3313314782347665, 'recall': 0.33130107654582375, 'f1-score': 0.3283604853840976, 'support': 164075}, 'weighted avg': {'precision': 0.33123452487399085, 'recall': 0.3310924881913759, 'f1-score': 0.3282090129043072, 'support': 164075}}
[[13552 21020 20184]
 [15345 20095 20267]
 [11824 21111 20677]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1238753
{'0': {'precision': 0.302285070191618, 'recall': 0.24484375648420964, 'f1-score': 0.2705491230081394, 'support': 24097}, '1': {'precision': 0.2645826523638309, 'recall': 0.4436472346786248, 'f1-score': 0.3314781378552948, 'support': 20070}, '2': {'precision': 0.3741962126128252, 'recall': 0.24438451165478714, 'f1-score': 0.29566960331888315, 'support': 25955}, 'accuracy': 0.301574398904766, 'macro avg': {'precision': 0.3136879783894247, 'recall': 0.31095850093920724, 'f1-score': 0.29923228806077246, 'support': 70122}, 'weighted avg': {'precision': 0.31811128986217424, 'recall': 0.301574398904766, 'f1-score': 0.29728605855543927, 'support': 70122}}
[[ 5900 12179  6018]
 [ 6576  8904  4590]
 [ 7042 12570  6343]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
1359/1359 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1232811
{'0': {'precision': 0.3356841101117471, 'recall': 0.19874936964195664, 'f1-score': 0.24967374916061677, 'support': 99150}, '1': {'precision': 0.42896625167980934, 'recall': 0.33790270500589203, 'f1-score': 0.3780277074333383, 'support': 150203}, '2': {'precision': 0.2519850099543272, 'recall': 0.4371241670729725, 'f1-score': 0.31968443103986216, 'support': 98448}, 'accuracy': 0.3263187857424217, 'macro avg': {'precision': 0.33887845724862786, 'recall': 0.32459208057360706, 'f1-score': 0.3157952958779391, 'support': 347801}, 'weighted avg': {'precision': 0.35227764635129205, 'recall': 0.3263187857424217, 'f1-score': 0.3249224149323815, 'support': 347801}}
[[19706 31656 47788]
 [19491 50754 79958]
 [19507 35907 43034]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1230617
{'0': {'precision': 0.33432694988312495, 'recall': 0.4171125856164384, 'f1-score': 0.3711595462282905, 'support': 37376}, '1': {'precision': 0.32335083448215174, 'recall': 0.29405959081330524, 'f1-score': 0.30801039367438743, 'support': 37489}, '2': {'precision': 0.34824281150159747, 'recall': 0.2955531453362256, 'f1-score': 0.3197418597829276, 'support': 38724}, 'accuracy': 0.3350588525297344, 'macro avg': {'precision': 0.3353068652889581, 'recall': 0.3355751072553231, 'f1-score': 0.33297059989520184, 'support': 113589}, 'weighted avg': {'precision': 0.3354484866080424, 'recall': 0.3350588525297344, 'f1-score': 0.3327887790765108, 'support': 113589}}
[[15590 11129 10657]
 [15702 11024 10763]
 [15339 11940 11445]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1144872
{'0': {'precision': 0.36788192532217207, 'recall': 0.2598615109313001, 'f1-score': 0.3045777858836404, 'support': 12853}, '1': {'precision': 0.291844881665241, 'recall': 0.3593119185536247, 'f1-score': 0.3220832349933129, 'support': 11394}, '2': {'precision': 0.3468784632434429, 'recall': 0.37878176684146836, 'f1-score': 0.3621288083301195, 'support': 12395}, 'accuracy': 0.3310135909611921, 'macro avg': {'precision': 0.335535090076952, 'recall': 0.3326517321087977, 'f1-score': 0.3295966097356909, 'support': 36642}, 'weighted avg': {'precision': 0.33713294906833985, 'recall': 0.3310135909611921, 'f1-score': 0.32948914471721163, 'support': 36642}}
[[3340 4888 4625]
 [3085 4094 4215]
 [2654 5046 4695]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1099164
{'0': {'precision': 0.32144860417955096, 'recall': 0.2663949081026961, 'f1-score': 0.29134376609071416, 'support': 83898}, '1': {'precision': 0.41385914812482205, 'recall': 0.40558364475708947, 'f1-score': 0.40967960953613203, 'support': 118274}, '2': {'precision': 0.30259873595373327, 'recall': 0.3592186329430971, 'f1-score': 0.3284867075664622, 'support': 89433}, 'accuracy': 0.3513177071723736, 'macro avg': {'precision': 0.34596882941936874, 'recall': 0.3437323952676275, 'f1-score': 0.3431700277311028, 'support': 291605}, 'weighted avg': {'precision': 0.35314889878884587, 'recall': 0.3513177071723736, 'f1-score': 0.3507318363661344, 'support': 291605}}
[[22350 31331 30217]
 [26480 47970 43824]
 [20699 36608 32126]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246599
{'0': {'precision': 0.333373268797623, 'recall': 0.4337781380557461, 'f1-score': 0.3770052026880555, 'support': 32074}, '1': {'precision': 0.31574608408903543, 'recall': 0.21208392296806744, 'f1-score': 0.2537357379462642, 'support': 32506}, '2': {'precision': 0.3524145648618404, 'recall': 0.3629539880020095, 'f1-score': 0.357606638520891, 'support': 33839}, 'accuracy': 0.3362054074924557, 'macro avg': {'precision': 0.3338446392494996, 'recall': 0.336272016341941, 'f1-score': 0.32944919305173687, 'support': 98419}, 'weighted avg': {'precision': 0.3340982218186831, 'recall': 0.3362054074924557, 'f1-score': 0.32962181905532856, 'support': 98419}}
[[13913  7366 10795]
 [13838  6894 11774]
 [13983  7574 12282]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122556
{'0': {'precision': 0.2965128205128205, 'recall': 0.25939883355764914, 'f1-score': 0.27671691792294806, 'support': 11145}, '1': {'precision': 0.3875968992248062, 'recall': 0.4686478238756085, 'f1-score': 0.4242862781212999, 'support': 13763}, '2': {'precision': 0.3066815144766147, 'recall': 0.2632132275637962, 'f1-score': 0.28328961580003087, 'support': 10463}, 'accuracy': 0.3419467925701846, 'macro avg': {'precision': 0.33026374473808046, 'recall': 0.3304199616656846, 'f1-score': 0.32809760394809295, 'support': 35371}, 'weighted avg': {'precision': 0.33496198000099553, 'recall': 0.3419467925701846, 'f1-score': 0.33608100834441856, 'support': 35371}}
[[2891 5237 3017]
 [4104 6450 3209]
 [2755 4954 2754]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
2282/2282 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1140392
{'0': {'precision': 0.33074015870748213, 'recall': 0.12856746182001766, 'f1-score': 0.18515879478827363, 'support': 198075}, '1': {'precision': 0.36346614910377895, 'recall': 0.47399216861789506, 'f1-score': 0.4114356609451027, 'support': 201497}, '2': {'precision': 0.3062507165435577, 'recall': 0.40556221295608463, 'f1-score': 0.3489785396511382, 'support': 184423}, 'accuracy': 0.3352237604774013, 'macro avg': {'precision': 0.33348567478493957, 'recall': 0.33604061446466577, 'f1-score': 0.31519099846150483, 'support': 583995}, 'weighted avg': {'precision': 0.33429801878279986, 'recall': 0.3352237604774013, 'f1-score': 0.31496510906638675, 'support': 583995}}
[[25466 86079 86530]
 [23086 95508 82903]
 [28445 81183 74795]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1153364
{'0': {'precision': 0.3256980372023222, 'recall': 0.2224890063938274, 'f1-score': 0.26437776495479903, 'support': 74134}, '1': {'precision': 0.3334055395279684, 'recall': 0.4565938511326861, 'f1-score': 0.3853950296208194, 'support': 74160}, '2': {'precision': 0.33937138130686517, 'recall': 0.3220186006357179, 'f1-score': 0.33046734993858606, 'support': 76449}, 'accuracy': 0.33359437223851246, 'macro avg': {'precision': 0.33282498601238525, 'recall': 0.33370048605407715, 'f1-score': 0.32674671483806816, 'support': 224743}, 'weighted avg': {'precision': 0.3328924853315993, 'recall': 0.33359437223851246, 'f1-score': 0.32679182470330115, 'support': 224743}}
[[16494 33315 24325]
 [16702 33861 23597]
 [17446 34385 24618]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118124
{'0': {'precision': 0.31493898027109163, 'recall': 0.2555881777255823, 'f1-score': 0.2821765061803094, 'support': 25545}, '1': {'precision': 0.3300824842309558, 'recall': 0.5310902064873727, 'f1-score': 0.4071275752180613, 'support': 25619}, '2': {'precision': 0.34542034250129733, 'recall': 0.20322100522840897, 'f1-score': 0.25589274129604267, 'support': 26203}, 'accuracy': 0.3290808742745615, 'macro avg': {'precision': 0.3301472690011149, 'recall': 0.3299664631471213, 'f1-score': 0.31506560756480445, 'support': 77367}, 'weighted avg': {'precision': 0.3302771032752903, 'recall': 0.3290808742745615, 'f1-score': 0.31465040262731814, 'support': 77367}}
[[ 6529 13860  5156]
 [ 7078 13606  4935]
 [ 7124 13754  5325]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
5098/5098 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102731
{'0': {'precision': 0.37184932680428173, 'recall': 0.08912106580443249, 'f1-score': 0.143781938514165, 'support': 462674}, '1': {'precision': 0.31257135207767145, 'recall': 0.5873604624672514, 'f1-score': 0.4080132537667732, 'support': 421392}, '2': {'precision': 0.3171686881797431, 'recall': 0.30309733987572623, 'f1-score': 0.30997340280115043, 'support': 420845}, 'accuracy': 0.31902558871831105, 'macro avg': {'precision': 0.33386312235389876, 'recall': 0.32652628938247, 'f1-score': 0.2872561983606962, 'support': 1304911}, 'weighted avg': {'precision': 0.33507184719997174, 'recall': 0.31902558871831105, 'f1-score': 0.2827077420247366, 'support': 1304911}}
[[ 41234 283267 138173]
 [ 37439 247509 136444]
 [ 32216 261072 127557]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173043
{'0': {'precision': 0.34437974130462623, 'recall': 0.27696054672353626, 'f1-score': 0.3070124479934453, 'support': 165056}, '1': {'precision': 0.31917193387000475, 'recall': 0.40129948292487205, 'f1-score': 0.35555479104490456, 'support': 154523}, '2': {'precision': 0.3405862384123254, 'recall': 0.32479393380979654, 'f1-score': 0.33250267679600265, 'support': 160628}, 'accuracy': 0.3329709895940709, 'macro avg': {'precision': 0.3347126378623188, 'recall': 0.3343513211527349, 'f1-score': 0.33168997194478417, 'support': 480207}, 'weighted avg': {'precision': 0.3349993515751877, 'recall': 0.3329709895940709, 'f1-score': 0.3311590200913902, 'support': 480207}}
[[45714 67712 51630]
 [43134 62010 49379]
 [43895 64562 52171]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1204085
{'0': {'precision': 0.3366941483309703, 'recall': 0.36897431470718, 'f1-score': 0.3520959179937764, 'support': 52131}, '1': {'precision': 0.33113808065901634, 'recall': 0.2885272329482209, 'f1-score': 0.3083676043771217, 'support': 52106}, '2': {'precision': 0.3427169513985889, 'recall': 0.353523598411379, 'f1-score': 0.3480364076125008, 'support': 54135}, 'accuracy': 0.33722501452276915, 'macro avg': {'precision': 0.33684972679619185, 'recall': 0.33700838202225997, 'f1-score': 0.33616664332779966, 'support': 158372}, 'weighted avg': {'precision': 0.33692487081948275, 'recall': 0.33722501452276915, 'f1-score': 0.3363212286307592, 'support': 158372}}
[[19235 14720 18176]
 [18544 15034 18528]
 [19350 15647 19138]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
5760/5760 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062429
{'0': {'precision': 0.3566847981677641, 'recall': 0.023722436638302816, 'f1-score': 0.0444861808619086, 'support': 525199}, '1': {'precision': 0.3170608859284086, 'recall': 0.7262513885255253, 'f1-score': 0.4414132073221516, 'support': 466322}, '2': {'precision': 0.3263147691412939, 'recall': 0.2509410912102702, 'f1-score': 0.28370706950111546, 'support': 482950}, 'accuracy': 0.32033047784595287, 'macro avg': {'precision': 0.33335348441248885, 'recall': 0.33363830545803275, 'f1-score': 0.25653548589505853, 'support': 1474471}, 'weighted avg': {'precision': 0.3342057480395388, 'recall': 0.32033047784595287, 'f1-score': 0.24837458083810238, 'support': 1474471}}
[[ 12459 379164 133576]
 [ 11027 338667 116628]
 [ 11444 350314 121192]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138937
{'0': {'precision': 0.2953718371366186, 'recall': 0.14916595496264906, 'f1-score': 0.19822576590166288, 'support': 185002}, '1': {'precision': 0.3124597293814433, 'recall': 0.46776827797873505, 'f1-score': 0.37465650597438166, 'support': 182460}, '2': {'precision': 0.3415430283019375, 'recall': 0.34317068031143794, 'f1-score': 0.3423549197382464, 'support': 185077}, 'accuracy': 0.3193584525255231, 'macro avg': {'precision': 0.3164581982733331, 'recall': 0.320034971084274, 'f1-score': 0.3050790638714303, 'support': 552539}, 'weighted avg': {'precision': 0.3164799984904677, 'recall': 0.3193584525255231, 'f1-score': 0.30476402698057614, 'support': 552539}}
[[27596 93619 63787]
 [38452 85349 58659]
 [27380 94184 63513]]
Evaluating performance on  val set...
850/850 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1092312
{'0': {'precision': 0.38919319022945964, 'recall': 0.0676949222370996, 'f1-score': 0.11532978000043867, 'support': 77672}, '1': {'precision': 0.2935492295638548, 'recall': 0.5545055114468511, 'f1-score': 0.3838777328929042, 'support': 64865}, '2': {'precision': 0.34658762468176174, 'recall': 0.3766976793925783, 'f1-score': 0.36101591775293856, 'support': 74808}, 'accuracy': 0.3193356184867377, 'macro avg': {'precision': 0.34311001482502546, 'recall': 0.33296603769217636, 'f1-score': 0.2867411435487605, 'support': 217345}, 'weighted avg': {'precision': 0.3459845465704537, 'recall': 0.3193356184867377, 'f1-score': 0.2800386601557622, 'support': 217345}}
[[ 5258 44106 28308]
 [ 4078 35968 24819]
 [ 4174 42454 28180]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
6315/6315 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151329
{'0': {'precision': 0.4077600222635595, 'recall': 0.044370243455393074, 'f1-score': 0.08003185290169008, 'support': 627425}, '1': {'precision': 0.25059245516893525, 'recall': 0.5972826232444495, 'f1-score': 0.35305795110442995, 'support': 410911}, '2': {'precision': 0.3536297624698912, 'recall': 0.34791889376688706, 'f1-score': 0.35075108381376885, 'support': 578106}, 'accuracy': 0.2934859401079655, 'macro avg': {'precision': 0.3373274133007953, 'recall': 0.3298572534889099, 'f1-score': 0.26128029593996294, 'support': 1616442}, 'weighted avg': {'precision': 0.34844771156469273, 'recall': 0.2934859401079655, 'f1-score': 0.24625732758265248, 'support': 1616442}}
[[ 27839 378713 220873]
 [ 18718 245430 146763]
 [ 21716 355256 201134]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1186811
{'0': {'precision': 0.30552867166706993, 'recall': 0.249074033488209, 'f1-score': 0.2744280108662843, 'support': 182512}, '1': {'precision': 0.30289164583235056, 'recall': 0.3171212204357131, 'f1-score': 0.3098431455601695, 'support': 182230}, '2': {'precision': 0.35426161293061964, 'recall': 0.4019828799940042, 'f1-score': 0.376616569825033, 'support': 186799}, 'accuracy': 0.32334495531610524, 'macro avg': {'precision': 0.32089397681001336, 'recall': 0.32272604463930876, 'f1-score': 0.3202959087504956, 'support': 551541}, 'weighted avg': {'precision': 0.3211625401867791, 'recall': 0.32334495531610524, 'f1-score': 0.3207390206011943, 'support': 551541}}
[[45459 64585 72468]
 [60037 57789 64404]
 [43292 68417 75090]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1190977
{'0': {'precision': 0.3596647742633144, 'recall': 0.18759429771993402, 'f1-score': 0.24657813528065317, 'support': 70919}, '1': {'precision': 0.26965430146234376, 'recall': 0.4420174895527008, 'f1-score': 0.33496316387494046, 'support': 51688}, '2': {'precision': 0.37681243391224994, 'recall': 0.381733605294437, 'f1-score': 0.3792570562164684, 'support': 68147}, 'accuracy': 0.3258909380668295, 'macro avg': {'precision': 0.3353771698793027, 'recall': 0.33711513085569056, 'f1-score': 0.32026611845735403, 'support': 190754}, 'weighted avg': {'precision': 0.34140093834878277, 'recall': 0.3258909380668295, 'f1-score': 0.3179271805588362, 'support': 190754}}
[[13304 32005 25610]
 [11428 22847 17413]
 [12258 29875 26014]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
6082/6082 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1295425
{'0': {'precision': 0.37868600544008474, 'recall': 0.6024591676818116, 'f1-score': 0.46505422826319964, 'support': 595974}, '1': {'precision': 0.2401680801553876, 'recall': 0.1964913660858278, 'f1-score': 0.21614534881205297, 'support': 381345}, '2': {'precision': 0.3786451293218231, 'recall': 0.19384453437103635, 'f1-score': 0.2564178654747828, 'support': 579485}, 'accuracy': 0.3509182915768459, 'macro avg': {'precision': 0.3324997383057651, 'recall': 0.3309316893795586, 'f1-score': 0.3125391475166785, 'support': 1556804}, 'weighted avg': {'precision': 0.34474030301699, 'recall': 0.3509182915768459, 'f1-score': 0.32642290452254685, 'support': 1556804}}
[[359050 123239 113685]
 [235766  74931  70648]
 [353331 113824 112330]]
Evaluating performance on  train set...
2440/2440 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112766
{'0': {'precision': 0.30327522769768983, 'recall': 0.14545594808175388, 'f1-score': 0.19661297523111865, 'support': 207403}, '1': {'precision': 0.3194816100484623, 'recall': 0.5227587207895883, 'f1-score': 0.3965894096250443, 'support': 206690}, '2': {'precision': 0.3346334103749358, 'recall': 0.29714386158275297, 'f1-score': 0.31477632446415005, 'support': 210494}, 'accuracy': 0.32143480411856157, 'macro avg': {'precision': 0.3191300827070293, 'recall': 0.32178617681803173, 'f1-score': 0.30265956977343766, 'support': 624587}, 'weighted avg': {'precision': 0.3192064053759722, 'recall': 0.32143480411856157, 'f1-score': 0.30261230800355576, 'support': 624587}}
[[ 30168 114694  62541]
 [ 36817 108049  61824]
 [ 32489 115458  62547]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1165265
{'0': {'precision': 0.323606002845714, 'recall': 0.15521104272359712, 'f1-score': 0.20979714735752017, 'support': 77662}, '1': {'precision': 0.2721693746608357, 'recall': 0.5481444574808338, 'f1-score': 0.3637342889290609, 'support': 62219}, '2': {'precision': 0.34005032630265336, 'recall': 0.23229034196514667, 'f1-score': 0.276025839020907, 'support': 71557}, 'accuracy': 0.2969239209602815, 'macro avg': {'precision': 0.31194190126973437, 'recall': 0.3118819473898592, 'f1-score': 0.2831857584358293, 'support': 211438}, 'weighted avg': {'precision': 0.31403521086212194, 'recall': 0.2969239209602815, 'f1-score': 0.2775093916125579, 'support': 211438}}
[[12054 47551 18057]
 [13912 34105 14202]
 [11283 43652 16622]]
testing model on single stock: results/universal/W3/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
13689/13689 - 183s - 183s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101752
{'0': {'precision': 0.32511236310691904, 'recall': 0.022589998434121374, 'f1-score': 0.04224468157736071, 'support': 1136742}, '1': {'precision': 0.35492624478327073, 'recall': 0.6606115251643275, 'f1-score': 0.46176198429177573, 'support': 1238837}, '2': {'precision': 0.3200262984408526, 'recall': 0.317415145476921, 'f1-score': 0.3187153739227134, 'support': 1128667}, 'accuracy': 0.34310519295734376, 'macro avg': {'precision': 0.3333549687770141, 'recall': 0.33353888969178996, 'f1-score': 0.27424067993061657, 'support': 3504246}, 'weighted avg': {'precision': 0.3340141543583983, 'recall': 0.34310519295734376, 'f1-score': 0.2796015633887889, 'support': 3504246}}
[[ 25679 742695 368368]
 [ 27613 818390 392834]
 [ 25693 744718 358256]]
Evaluating performance on  train set...
5475/5475 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1135368
{'0': {'precision': 0.3152020755518776, 'recall': 0.11978623261546308, 'f1-score': 0.17359946662478504, 'support': 470605}, '1': {'precision': 0.313758924528959, 'recall': 0.48660151971152704, 'f1-score': 0.381517029227324, 'support': 462851}, '2': {'precision': 0.33169141428845883, 'recall': 0.3577577919719724, 'f1-score': 0.34423185033612297, 'support': 468110}, 'accuracy': 0.32040303489097194, 'macro avg': {'precision': 0.3202174714564318, 'recall': 0.3213818480996542, 'f1-score': 0.29978278206274406, 'support': 1401566}, 'weighted avg': {'precision': 0.3202327772540251, 'recall': 0.32040303489097194, 'f1-score': 0.29925147081671194, 'support': 1401566}}
[[ 56372 247439 166794]
 [ 66994 225224 170633]
 [ 55478 245162 167470]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1237302
{'0': {'precision': 0.35616815230549137, 'recall': 0.037569503290886506, 'f1-score': 0.06796942268517547, 'support': 172294}, '1': {'precision': 0.2903347770944507, 'recall': 0.34073050589470966, 'f1-score': 0.31352038575038893, 'support': 178041}, '2': {'precision': 0.31255334124455536, 'recall': 0.5379240524107419, 'f1-score': 0.3953778458335663, 'support': 170881}, 'accuracy': 0.30516714759332025, 'macro avg': {'precision': 0.3196854235481658, 'recall': 0.3054080205321127, 'f1-score': 0.2589558847563769, 'support': 521216}, 'weighted avg': {'precision': 0.31938113409259555, 'recall': 0.30516714759332025, 'f1-score': 0.25918768492408184, 'support': 521216}}
[[  6473  75063  90758]
 [  5959  60664 111418]
 [  5742  73218  91921]]
training model: results/universal/W3/deepLOB_L2/h1000
Epoch 1/50
10532/10532 - 433s - loss: 3.1867 - accuracy1000: 0.4293 - val_loss: 3.3626 - val_accuracy1000: 0.3342 - 433s/epoch - 41ms/step
Epoch 2/50
10532/10532 - 425s - loss: 3.1384 - accuracy1000: 0.4494 - val_loss: 3.6452 - val_accuracy1000: 0.3462 - 425s/epoch - 40ms/step
Epoch 3/50
10532/10532 - 425s - loss: 3.1148 - accuracy1000: 0.4589 - val_loss: 3.6919 - val_accuracy1000: 0.3617 - 425s/epoch - 40ms/step
Epoch 4/50
10532/10532 - 426s - loss: 3.0982 - accuracy1000: 0.4645 - val_loss: 4.0056 - val_accuracy1000: 0.3382 - 426s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 425s - loss: 3.0883 - accuracy1000: 0.4679 - val_loss: 3.9927 - val_accuracy1000: 0.3391 - 425s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 427s - loss: 3.0791 - accuracy1000: 0.4712 - val_loss: 3.9526 - val_accuracy1000: 0.3394 - 427s/epoch - 40ms/step
Epoch 7/50
10532/10532 - 424s - loss: 3.0718 - accuracy1000: 0.4734 - val_loss: 4.0281 - val_accuracy1000: 0.3378 - 424s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 426s - loss: 3.0646 - accuracy1000: 0.4759 - val_loss: 4.2696 - val_accuracy1000: 0.3386 - 426s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 423s - loss: 3.0554 - accuracy1000: 0.4785 - val_loss: 4.0565 - val_accuracy1000: 0.3391 - 423s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 426s - loss: 3.0520 - accuracy1000: 0.4801 - val_loss: 4.0082 - val_accuracy1000: 0.3393 - 426s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 427s - loss: 3.0473 - accuracy1000: 0.4816 - val_loss: 4.0162 - val_accuracy1000: 0.3388 - 427s/epoch - 41ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 371s - 371s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1360997
{'0': {'precision': 0.3686266171269976, 'recall': 0.012637655448072967, 'f1-score': 0.02443751755062462, 'support': 2606417}, '1': {'precision': 0.2848629693478535, 'recall': 0.8398638345982105, 'f1-score': 0.4254297220127311, 'support': 2016665}, '2': {'precision': 0.34419343885269804, 'recall': 0.14690092331924032, 'f1-score': 0.20591697996395777, 'support': 2463395}, 'accuracy': 0.294721622605986, 'macro avg': {'precision': 0.3325610084425164, 'recall': 0.3331341377885079, 'f1-score': 0.21859473984243782, 'support': 7086477}, 'weighted avg': {'precision': 0.33629577262647276, 'recall': 0.294721622605986, 'f1-score': 0.20163735102546224, 'support': 7086477}}
[[  32939 2181211  392267]
 [  25712 1693724  297229]
 [  30705 2070815  361875]]
Evaluating performance on  train set...
10532/10532 - 142s - 142s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1225843
{'0': {'precision': 0.3466642946095001, 'recall': 0.021521408754351552, 'f1-score': 0.040526853251860895, 'support': 905424}, '1': {'precision': 0.32928827408638167, 'recall': 0.8383177981452576, 'f1-score': 0.47284478464477, 'support': 886053}, '2': {'precision': 0.3431281621083675, 'recall': 0.1456402578259509, 'f1-score': 0.20448650918781872, 'support': 904331}, 'accuracy': 0.3316211688666255, 'macro avg': {'precision': 0.3396935769347498, 'recall': 0.3351598215751867, 'f1-score': 0.23928604902814987, 'support': 2695808}, 'weighted avg': {'precision': 0.339766952753755, 'recall': 0.3316211688666255, 'f1-score': 0.23762189847641021, 'support': 2695808}}
[[ 19486 757795 128143]
 [ 19267 742794 123992]
 [ 17457 755167 131707]]
Evaluating performance on  val set...
3814/3814 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1217933
{'0': {'precision': 0.32473482396295006, 'recall': 0.020260487544196508, 'f1-score': 0.03814130590543927, 'support': 321858}, '1': {'precision': 0.33458607894146075, 'recall': 0.7654026360068996, 'f1-score': 0.46562853475279353, 'support': 331031}, '2': {'precision': 0.3346869269059471, 'recall': 0.2057000241526447, 'f1-score': 0.2547993019197207, 'support': 322946}, 'accuracy': 0.33440386950662765, 'macro avg': {'precision': 0.3313359432701193, 'recall': 0.3304543825679136, 'f1-score': 0.25285638085931783, 'support': 975835}, 'weighted avg': {'precision': 0.3313702312027196, 'recall': 0.33440386950662765, 'f1-score': 0.25485863827555993, 'support': 975835}}
[[  6521 253532  61805]
 [  7410 253372  70249]
 [  6150 250366  66430]]
testing model out of sample: results/universal/W3/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 221s - 221s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1258559
{'0': {'precision': 0.29811690456932594, 'recall': 0.017991019958626637, 'f1-score': 0.03393415200280094, 'support': 1454559}, '1': {'precision': 0.32017881326740555, 'recall': 0.8799049449400036, 'f1-score': 0.46951209718867243, 'support': 1328914}, '2': {'precision': 0.30862774959405354, 'recall': 0.0904685178752245, 'f1-score': 0.13992160466942616, 'support': 1352990}, 'accuracy': 0.31860311575372485, 'macro avg': {'precision': 0.308974489143595, 'recall': 0.3294548275912849, 'f1-score': 0.2144559512869665, 'support': 4136463}, 'weighted avg': {'precision': 0.30864267200532275, 'recall': 0.31860311575372485, 'f1-score': 0.20853878234330064, 'support': 4136463}}
[[  26169 1283741  144649]
 [  30044 1169318  129552]
 [  31568 1199019  122403]]
Evaluating performance on  train set...
6181/6181 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1199464
{'0': {'precision': 0.32327186566395383, 'recall': 0.018028818532108686, 'f1-score': 0.034152933600587715, 'support': 522164}, '1': {'precision': 0.3299029912974033, 'recall': 0.8590766690049716, 'f1-score': 0.47673138964626793, 'support': 523171}, '2': {'precision': 0.3318042813455658, 'recall': 0.11771230231222923, 'f1-score': 0.17377532795975598, 'support': 536452}, 'accuracy': 0.330009666282502, 'macro avg': {'precision': 0.32832637943564097, 'recall': 0.33160592994976984, 'f1-score': 0.22821988373553723, 'support': 1581787}, 'weighted avg': {'precision': 0.32835879840901333, 'recall': 0.330009666282502, 'f1-score': 0.22788630359707843, 'support': 1581787}}
[[  9414 449288  63462]
 [ 10022 449444  63705]
 [  9685 463620  63147]]
Evaluating performance on  val set...
2209/2209 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125993
{'0': {'precision': 0.37113968567974503, 'recall': 0.016615660148984954, 'f1-score': 0.03180732877776783, 'support': 203242}, '1': {'precision': 0.3096769193430292, 'recall': 0.8723764873514085, 'f1-score': 0.4570941745614589, 'support': 174051}, '2': {'precision': 0.34432604568559005, 'recall': 0.11998954293000699, 'f1-score': 0.17796311755931776, 'support': 187433}, 'accuracy': 0.31467472721284306, 'macro avg': {'precision': 0.3417142169027881, 'recall': 0.3363272301434668, 'f1-score': 0.22228820696618148, 'support': 564726}, 'weighted avg': {'precision': 0.3432971267596738, 'recall': 0.31467472721284306, 'f1-score': 0.2113917976249423, 'support': 564726}}
[[  3377 176317  23548]
 [  2935 151838  19278]
 [  2787 162156  22490]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.105331
{'0': {'precision': 0.3008595988538682, 'recall': 0.011286681715575621, 'f1-score': 0.02175714877745545, 'support': 55818}, '1': {'precision': 0.4283420568680153, 'recall': 0.8214285714285714, 'f1-score': 0.5630671675096698, 'support': 73724}, '2': {'precision': 0.23119860953272278, 'recall': 0.15774230330672748, 'f1-score': 0.18753389003361892, 'support': 43850}, 'accuracy': 0.3927862877180031, 'macro avg': {'precision': 0.3201334217515354, 'recall': 0.3301525188169582, 'f1-score': 0.25745273544024805, 'support': 173392}, 'weighted avg': {'precision': 0.3374465368492933, 'recall': 0.3927862877180031, 'f1-score': 0.29383919365320826, 'support': 173392}}
[[  630 44427 10761]
 [  925 60559 12240]
 [  539 36394  6917]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1179765
{'0': {'precision': 0.29737609329446063, 'recall': 0.014267729752412925, 'f1-score': 0.027229044313934865, 'support': 21447}, '1': {'precision': 0.33415022878785283, 'recall': 0.8795957955519466, 'f1-score': 0.4843140664199309, 'support': 22167}, '2': {'precision': 0.33501223197582386, 'recall': 0.10248734316530926, 'f1-score': 0.156957928802589, 'support': 22715}, 'accuracy': 0.33367003874624973, 'macro avg': {'precision': 0.3221795180193791, 'recall': 0.3321169561565563, 'f1-score': 0.22283367984548494, 'support': 66329}, 'weighted avg': {'precision': 0.3225547806202034, 'recall': 0.33367003874624973, 'f1-score': 0.22441270901841395, 'support': 66329}}
[[  306 18796  2345]
 [  393 19498  2276]
 [  330 20057  2328]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1070069
{'0': {'precision': 0.30903790087463556, 'recall': 0.014152202937249666, 'f1-score': 0.02706498148857398, 'support': 7490}, '1': {'precision': 0.3853873329578619, 'recall': 0.8993906081969172, 'f1-score': 0.5395698924731183, 'support': 8369}, '2': {'precision': 0.28252427184466017, 'recall': 0.09580246913580247, 'f1-score': 0.14308543331284573, 'support': 6075}, 'accuracy': 0.374532688976019, 'macro avg': {'precision': 0.32564983522571916, 'recall': 0.33644842675665637, 'f1-score': 0.23657343575817932, 'support': 21934}, 'weighted avg': {'precision': 0.33082590583257393, 'recall': 0.374532688976019, 'f1-score': 0.25474702055404774, 'support': 21934}}
[[ 106 6585  799]
 [ 163 7527  679]
 [  74 5419  582]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1481477
{'0': {'precision': 0.40429564118761846, 'recall': 0.013330648688805726, 'f1-score': 0.025810267647098362, 'support': 144029}, '1': {'precision': 0.2365183930945053, 'recall': 0.8098099434726488, 'f1-score': 0.3661086866298593, 'support': 89868}, '2': {'precision': 0.34304116001196616, 'recall': 0.1439989362959461, 'f1-score': 0.20284803046778666, 'support': 135376}, 'accuracy': 0.25506874317916556, 'macro avg': {'precision': 0.3279517314313633, 'recall': 0.3223798428191335, 'f1-score': 0.19825566158158145, 'support': 369273}, 'weighted avg': {'precision': 0.3410086086256196, 'recall': 0.25506874317916556, 'f1-score': 0.17352917072627355, 'support': 369273}}
[[  1920 120686  21423]
 [  1182  72776  15910]
 [  1647 114235  19494]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.12301
{'0': {'precision': 0.32413793103448274, 'recall': 0.01765400300493668, 'f1-score': 0.03348430105338151, 'support': 55908}, '1': {'precision': 0.3405843172873146, 'recall': 0.8295326758226564, 'f1-score': 0.4829018324256164, 'support': 54245}, '2': {'precision': 0.3736423382912487, 'recall': 0.20032639738882088, 'f1-score': 0.2608170755263666, 'support': 53922}, 'accuracy': 0.3461039158921225, 'macro avg': {'precision': 0.3461215288710154, 'recall': 0.34917102540547135, 'f1-score': 0.2590677363351215, 'support': 164075}, 'weighted avg': {'precision': 0.34584453393184184, 'recall': 0.3461039158921225, 'f1-score': 0.25677786713242573, 'support': 164075}}
[[  987 44918 10003]
 [ 1142 44998  8105]
 [  916 42204 10802]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1071936
{'0': {'precision': 0.30920372285418823, 'recall': 0.013914095583787053, 'f1-score': 0.026629853936587105, 'support': 21489}, '1': {'precision': 0.36896026581752733, 'recall': 0.9467140319715808, 'f1-score': 0.530982267383941, 'support': 25335}, '2': {'precision': 0.3666827386692382, 'recall': 0.06528457378315736, 'f1-score': 0.11083582307075714, 'support': 23298}, 'accuracy': 0.36800148312940306, 'macro avg': {'precision': 0.34828224244698464, 'recall': 0.34197090044617506, 'f1-score': 0.22281598146376178, 'support': 70122}, 'weighted avg': {'precision': 0.34989106957041466, 'recall': 0.36800148312940306, 'f1-score': 0.2368292074002163, 'support': 70122}}
[[  299 19562  1628]
 [  351 23985   999]
 [  317 21460  1521]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
1359/1359 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0888212
{'0': {'precision': 0.3031439284684165, 'recall': 0.022060135383323715, 'f1-score': 0.04112738336317124, 'support': 95285}, '1': {'precision': 0.4505807845844464, 'recall': 0.7371108710596092, 'f1-score': 0.5592831995231264, 'support': 162928}, '2': {'precision': 0.20669707120851327, 'recall': 0.17149618252444523, 'f1-score': 0.18745843983918883, 'support': 89588}, 'accuracy': 0.3955192768278412, 'macro avg': {'precision': 0.32014059475379203, 'recall': 0.31022239632245935, 'f1-score': 0.26262300757516216, 'support': 347801}, 'weighted avg': {'precision': 0.3473678123706258, 'recall': 0.3955192768278412, 'f1-score': 0.3215509517338276, 'support': 347801}}
[[  2102  74089  19094]
 [  2959 120096  39873]
 [  1873  72351  15364]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1178999
{'0': {'precision': 0.30436966348568556, 'recall': 0.03274702115587258, 'f1-score': 0.05913204693484253, 'support': 37011}, '1': {'precision': 0.3299872419965781, 'recall': 0.8839377963811693, 'f1-score': 0.480570358634596, 'support': 37747}, '2': {'precision': 0.38203437720744055, 'recall': 0.08356725296798949, 'f1-score': 0.1371368198626519, 'support': 38831}, 'accuracy': 0.33298118655855763, 'macro avg': {'precision': 0.3387970942299014, 'recall': 0.33341735683501045, 'f1-score': 0.22561307514403017, 'support': 113589}, 'weighted avg': {'precision': 0.33943278786022996, 'recall': 0.33298118655855763, 'f1-score': 0.22584744445828547, 'support': 113589}}
[[ 1212 33365  2434]
 [ 1566 33366  2815]
 [ 1204 34382  3245]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112383
{'0': {'precision': 0.3942307692307692, 'recall': 0.03297940797940798, 'f1-score': 0.06086698337292162, 'support': 12432}, '1': {'precision': 0.3392762284196547, 'recall': 0.8307454678481424, 'f1-score': 0.481789679639801, 'support': 12301}, '2': {'precision': 0.39511127325793505, 'recall': 0.18187925098664876, 'f1-score': 0.2490943591512851, 'support': 11909}, 'accuracy': 0.34918945472408713, 'macro avg': {'precision': 0.37620609030278634, 'recall': 0.3485347089380664, 'f1-score': 0.26391700738800256, 'support': 36642}, 'weighted avg': {'precision': 0.37606828126455555, 'recall': 0.34918945472408713, 'f1-score': 0.26334965093810403, 'support': 36642}}
[[  410 10404  1618]
 [  384 10219  1698]
 [  246  9497  2166]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972694
{'0': {'precision': 0.3249198717948718, 'recall': 0.01967754067136566, 'f1-score': 0.03710778874641105, 'support': 82429}, '1': {'precision': 0.3952630203590349, 'recall': 0.8663542480256877, 'f1-score': 0.5428552784695864, 'support': 115230}, '2': {'precision': 0.31412459247510793, 'recall': 0.11384199433717242, 'f1-score': 0.16711851429375044, 'support': 93946}, 'accuracy': 0.3845853123231769, 'macro avg': {'precision': 0.34476916154300485, 'recall': 0.3332912610114086, 'f1-score': 0.24902719383658264, 'support': 291605}, 'weighted avg': {'precision': 0.3492386170086849, 'recall': 0.3845853123231769, 'f1-score': 0.27884325577568636, 'support': 291605}}
[[ 1622 70988  9819]
 [ 1867 99830 13533]
 [ 1503 81748 10695]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1190311
{'0': {'precision': 0.32083122149011656, 'recall': 0.04019813297771004, 'f1-score': 0.07144469525959368, 'support': 31494}, '1': {'precision': 0.32821140315786995, 'recall': 0.8627984659161203, 'f1-score': 0.4755297206075379, 'support': 32332}, '2': {'precision': 0.41027534550058026, 'recall': 0.11242158818258029, 'f1-score': 0.1764839353784716, 'support': 34593}, 'accuracy': 0.3358193031833284, 'macro avg': {'precision': 0.3531059900495223, 'recall': 0.33847272902547015, 'f1-score': 0.2411527837485344, 'support': 98419}, 'weighted avg': {'precision': 0.35469416071502, 'recall': 0.3358193031833284, 'f1-score': 0.24111213216691926, 'support': 98419}}
[[ 1266 27765  2463]
 [ 1309 27896  3127]
 [ 1371 29333  3889]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093974
{'0': {'precision': 0.31221719457013575, 'recall': 0.023715415019762844, 'f1-score': 0.04408241494968855, 'support': 11638}, '1': {'precision': 0.3761160007598303, 'recall': 0.9065934065934066, 'f1-score': 0.5316625643320653, 'support': 13104}, '2': {'precision': 0.327817993795243, 'recall': 0.08947219870166526, 'f1-score': 0.14057649667405767, 'support': 10629}, 'accuracy': 0.37055780158887225, 'macro avg': {'precision': 0.3387170630417364, 'recall': 0.3399270067716116, 'f1-score': 0.23877382531860383, 'support': 35371}, 'weighted avg': {'precision': 0.3405780226856378, 'recall': 0.37055780158887225, 'f1-score': 0.2537142000887851, 'support': 35371}}
[[  276 10271  1091]
 [  365 11880   859]
 [  243  9435   951]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
2282/2282 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1303432
{'0': {'precision': 0.31932335718932986, 'recall': 0.011862923770804832, 'f1-score': 0.02287599977627384, 'support': 206863}, '1': {'precision': 0.3378729130602346, 'recall': 0.811140588978004, 'f1-score': 0.4770395355898472, 'support': 195627}, '2': {'precision': 0.30510111285075425, 'recall': 0.17929533621663316, 'f1-score': 0.22586130312873046, 'support': 181505}, 'accuracy': 0.33164325037029424, 'macro avg': {'precision': 0.3207657943667729, 'recall': 0.33409961632181395, 'f1-score': 0.24192561283161718, 'support': 583995}, 'weighted avg': {'precision': 0.3211168408795743, 'recall': 0.33164325037029424, 'f1-score': 0.2380995847480451, 'support': 583995}}
[[  2454 164551  39858]
 [  2684 158681  34262]
 [  2547 146415  32543]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.120545
{'0': {'precision': 0.3124533929903057, 'recall': 0.01711671228399853, 'f1-score': 0.032455460883036406, 'support': 73437}, '1': {'precision': 0.3313300664673673, 'recall': 0.8692558553216722, 'f1-score': 0.4797834042426586, 'support': 74206}, '2': {'precision': 0.3476841539288732, 'recall': 0.1174189364461738, 'f1-score': 0.17555120324225795, 'support': 77100}, 'accuracy': 0.3328868974784532, 'macro avg': {'precision': 0.33048920446218205, 'recall': 0.3345971680172815, 'f1-score': 0.22926335612265095, 'support': 224743}, 'weighted avg': {'precision': 0.3307723355175586, 'recall': 0.3328868974784532, 'f1-score': 0.22924512330117666, 'support': 224743}}
[[ 1257 63548  8632]
 [ 1349 64504  8353]
 [ 1417 66630  9053]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1198127
{'0': {'precision': 0.2532920216886135, 'recall': 0.012687696426492841, 'f1-score': 0.024164942358853084, 'support': 25773}, '1': {'precision': 0.3216207527918711, 'recall': 0.9229134079332612, 'f1-score': 0.4770107794361526, 'support': 24933}, '2': {'precision': 0.34996688010598365, 'recall': 0.05945013315329507, 'f1-score': 0.10163513946777814, 'support': 26661}, 'accuracy': 0.3221399304613078, 'macro avg': {'precision': 0.3082932181954894, 'recall': 0.331683745837683, 'f1-score': 0.20093695375426127, 'support': 77367}, 'weighted avg': {'precision': 0.3086268369569195, 'recall': 0.3221399304613078, 'f1-score': 0.19679976316060785, 'support': 77367}}
[[  327 23957  1489]
 [  467 23011  1455]
 [  497 24579  1585]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
5098/5098 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1487709
{'0': {'precision': 0.40092897460018817, 'recall': 0.013052741190500346, 'f1-score': 0.02528238297304362, 'support': 522419}, '1': {'precision': 0.2457412853167014, 'recall': 0.832123651326099, 'f1-score': 0.3794299798937951, 'support': 322261}, '2': {'precision': 0.35359231199471197, 'recall': 0.15110020837362106, 'f1-score': 0.21172444554050002, 'support': 460231}, 'accuracy': 0.26401877216147307, 'macro avg': {'precision': 0.3334208573038671, 'recall': 0.33209220029674014, 'f1-score': 0.2054789361357796, 'support': 1304911}, 'weighted avg': {'precision': 0.34590856362674505, 'recall': 0.26401877216147307, 'f1-score': 0.17849925035232186, 'support': 1304911}}
[[  6819 438306  77294]
 [  4265 268161  49835]
 [  5924 384766  69541]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1282562
{'0': {'precision': 0.37279855247285887, 'recall': 0.036957093657323255, 'f1-score': 0.06724764453728485, 'support': 167248}, '1': {'precision': 0.32087352920350526, 'recall': 0.8635619894992081, 'f1-score': 0.4678923907315893, 'support': 152179}, '2': {'precision': 0.35274643980025894, 'recall': 0.118627938798358, 'f1-score': 0.17754712590179195, 'support': 160780}, 'accuracy': 0.326255135806017, 'macro avg': {'precision': 0.348806173825541, 'recall': 0.33971567398496316, 'f1-score': 0.23756238705688867, 'support': 480207}, 'weighted avg': {'precision': 0.34962963408639725, 'recall': 0.326255135806017, 'f1-score': 0.2311429385352659, 'support': 480207}}
[[  6181 141481  19586]
 [  5352 131416  15411]
 [  5047 136660  19073]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065726
{'0': {'precision': 0.35168302945301544, 'recall': 0.020360521294303924, 'f1-score': 0.038492535595041635, 'support': 49262}, '1': {'precision': 0.3713418537244946, 'recall': 0.8868715323702698, 'f1-score': 0.5234923145557042, 'support': 58217}, '2': {'precision': 0.33754019780353134, 'recall': 0.1093077633466292, 'f1-score': 0.16513788701873122, 'support': 50893}, 'accuracy': 0.3674702598944258, 'macro avg': {'precision': 0.35352169366034714, 'recall': 0.338846605670401, 'f1-score': 0.24237424572315902, 'support': 158372}, 'weighted avg': {'precision': 0.35436473228858933, 'recall': 0.3674702598944258, 'f1-score': 0.25747438845892373, 'support': 158372}}
[[ 1003 43034  5225]
 [  893 51631  5693]
 [  956 44374  5563]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
5760/5760 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1487824
{'0': {'precision': 0.4047631935047361, 'recall': 0.012685240473347084, 'f1-score': 0.024599533865478907, 'support': 589504}, '1': {'precision': 0.23589918549977842, 'recall': 0.8660679320909447, 'f1-score': 0.37080002934100476, 'support': 347288}, '2': {'precision': 0.36277841320359594, 'recall': 0.12211003219392984, 'f1-score': 0.18271783597250438, 'support': 537679}, 'accuracy': 0.25358857515678507, 'macro avg': {'precision': 0.3344802640693702, 'recall': 0.3336210682527405, 'f1-score': 0.19270579972632937, 'support': 1474471}, 'weighted avg': {'precision': 0.34967985968564946, 'recall': 0.25358857515678507, 'f1-score': 0.16380075805456623, 'support': 1474471}}
[[  7478 508916  73110]
 [  4298 300775  42215]
 [  6699 465324  65656]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1209987
{'0': {'precision': 0.3323959505061867, 'recall': 0.01915762631283226, 'f1-score': 0.0362272940888008, 'support': 185096}, '1': {'precision': 0.3274562006183442, 'recall': 0.8337943778086355, 'f1-score': 0.4702363884700883, 'support': 182918}, '2': {'precision': 0.3208997385397643, 'recall': 0.1323614686356862, 'f1-score': 0.18741846866894823, 'support': 184525}, 'accuracy': 0.32664843567603374, 'macro avg': {'precision': 0.32691729655476504, 'recall': 0.32843782425238466, 'f1-score': 0.23129405040927908, 'support': 552539}, 'weighted avg': {'precision': 0.32692139091294803, 'recall': 0.32664843567603374, 'f1-score': 0.23039752825405982, 'support': 552539}}
[[  3546 156449  25101]
 [  3816 152516  26586]
 [  3306 156795  24424]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1458503
{'0': {'precision': 0.39932508436445446, 'recall': 0.01685880160039891, 'f1-score': 0.03235176852537449, 'support': 84229}, '1': {'precision': 0.24867847380667316, 'recall': 0.803067607740147, 'f1-score': 0.3797601542050634, 'support': 54831}, '2': {'precision': 0.35859589880449877, 'recall': 0.16820591428753912, 'f1-score': 0.22899674799575673, 'support': 78285}, 'accuracy': 0.2697140490924567, 'macro avg': {'precision': 0.3355331523252088, 'recall': 0.3293774412093617, 'f1-score': 0.21370289024206487, 'support': 217345}, 'weighted avg': {'precision': 0.3466503571102971, 'recall': 0.2697140490924567, 'f1-score': 0.19082378956584883, 'support': 217345}}
[[ 1420 69011 13798]
 [ 1043 44033  9755]
 [ 1093 64024 13168]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
6315/6315 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1696153
{'0': {'precision': 0.42311858461855884, 'recall': 0.011923519698590632, 'f1-score': 0.023193446006602062, 'support': 687968}, '1': {'precision': 0.18864797170295183, 'recall': 0.844057902105291, 'f1-score': 0.3083739819254253, 'support': 302856}, '2': {'precision': 0.38166626722093205, 'recall': 0.1476364171107609, 'f1-score': 0.2129134874714737, 'support': 625618}, 'accuracy': 0.22035742699088492, 'macro avg': {'precision': 0.3311442745141476, 'recall': 0.3345392796382141, 'f1-score': 0.1814936384678337, 'support': 1616442}, 'weighted avg': {'precision': 0.3631447978381871, 'recall': 0.22035742699088492, 'f1-score': 0.15005287510297619, 'support': 1616442}}
[[  8203 573184 106581]
 [  4171 255628  43057]
 [  7013 526241  92364]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.123127
{'0': {'precision': 0.3508869179600887, 'recall': 0.03136251032204789, 'f1-score': 0.057578605863982286, 'support': 181650}, '1': {'precision': 0.3294330590941456, 'recall': 0.8168657734362968, 'f1-score': 0.4695155974614114, 'support': 181812}, '2': {'precision': 0.3507374351932956, 'recall': 0.15754549949755156, 'f1-score': 0.21742655772469283, 'support': 188079}, 'accuracy': 0.33332789402782387, 'macro avg': {'precision': 0.34368580408251, 'recall': 0.3352579277519654, 'f1-score': 0.24817358701669553, 'support': 551541}, 'weighted avg': {'precision': 0.34376381458712, 'recall': 0.33332789402782387, 'f1-score': 0.24788019949767834, 'support': 551541}}
[[  5697 148417  27536]
 [  5981 148516  27315]
 [  4558 153890  29631]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1364056
{'0': {'precision': 0.3032067188394732, 'recall': 0.04666294577286881, 'f1-score': 0.08087879636465466, 'support': 68084}, '1': {'precision': 0.28846762517256475, 'recall': 0.753756818581735, 'f1-score': 0.41725070010958243, 'support': 56830}, '2': {'precision': 0.36216607406941254, 'recall': 0.17481773997569866, 'f1-score': 0.2358099179479825, 'support': 65840}, 'accuracy': 0.30155593067511033, 'macro avg': {'precision': 0.3179468060271502, 'recall': 0.32507916811010085, 'f1-score': 0.24464647147407317, 'support': 190754}, 'weighted avg': {'precision': 0.31916581408910777, 'recall': 0.30155593067511033, 'f1-score': 0.23456721356623653, 'support': 190754}}
[[ 3177 54345 10562]
 [ 4285 42836  9709]
 [ 3016 51314 11510]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1128082
{'0': {'precision': 0.25833238968784206, 'recall': 0.02699328914648119, 'f1-score': 0.04887916796857564, 'support': 507089}, '1': {'precision': 0.3526646301086498, 'recall': 0.9626920689473139, 'f1-score': 0.5162211020744425, 'support': 549347}, '2': {'precision': 0.4554268148498463, 'recall': 0.0038491670130783744, 'f1-score': 0.007633814707578524, 'support': 500368}, 'accuracy': 0.3497331712919545, 'macro avg': {'precision': 0.3554746115487794, 'recall': 0.33117817503562447, 'f1-score': 0.1909113615835322, 'support': 1556804}, 'weighted avg': {'precision': 0.3549668257555238, 'recall': 0.3497331712919545, 'f1-score': 0.20053283442546876, 'support': 1556804}}
[[ 13688 492226   1175]
 [ 19367 528852   1128]
 [ 19931 478511   1926]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1192167
{'0': {'precision': 0.3255664814023087, 'recall': 0.014846008003002344, 'f1-score': 0.02839709316689119, 'support': 205173}, '1': {'precision': 0.3305610128390906, 'recall': 0.8709425468023072, 'f1-score': 0.47923228871923546, 'support': 206133}, '2': {'precision': 0.3310964450113693, 'recall': 0.11196496640582143, 'f1-score': 0.1673411467914017, 'support': 213281}, 'accuracy': 0.33054802613567047, 'macro avg': {'precision': 0.32907464641758954, 'recall': 0.332584507070377, 'f1-score': 0.22499017622584275, 'support': 624587}, 'weighted avg': {'precision': 0.32910317671803285, 'recall': 0.33054802613567047, 'f1-score': 0.2246325864862856, 'support': 624587}}
[[  3046 177550  24577]
 [  2936 179530  23667]
 [  3374 186027  23880]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126088
{'0': {'precision': 0.34748904617458715, 'recall': 0.014062031151968139, 'f1-score': 0.027030215638723206, 'support': 73318}, '1': {'precision': 0.34741507724038795, 'recall': 0.9060814757460912, 'f1-score': 0.502253261299249, 'support': 73617}, '2': {'precision': 0.2962423359436654, 'recall': 0.07565539587306017, 'f1-score': 0.12052953961667653, 'support': 64503}, 'accuracy': 0.34342927950510316, 'macro avg': {'precision': 0.33038215311954683, 'recall': 0.33193296759037316, 'f1-score': 0.2166043388515496, 'support': 211438}, 'weighted avg': {'precision': 0.3318295529848385, 'recall': 0.34342927950510316, 'f1-score': 0.2210137088941496, 'support': 211438}}
[[ 1031 66592  5695]
 [ 1016 66703  5898]
 [  920 58703  4880]]
testing model on single stock: results/universal/W3/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
13689/13689 - 184s - 184s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1179054
{'0': {'precision': 0.33670546932742057, 'recall': 0.012464388682355597, 'f1-score': 0.02403888964009274, 'support': 1169572}, '1': {'precision': 0.33911892001474886, 'recall': 0.8402992119347634, 'f1-score': 0.4832236397273905, 'support': 1186450}, '2': {'precision': 0.3245915042087445, 'recall': 0.14729791399587536, 'f1-score': 0.20263921853826972, 'support': 1148224}, 'accuracy': 0.33692897131080407, 'macro avg': {'precision': 0.3334719645169713, 'recall': 0.33335383820433145, 'f1-score': 0.23663391596858432, 'support': 3504246}, 'weighted avg': {'precision': 0.33355326285662884, 'recall': 0.33692897131080407, 'f1-score': 0.23802869822940265, 'support': 3504246}}
[[ 14578 978028 176966]
 [ 14516 996973 174961]
 [ 14202 964891 169131]]
Evaluating performance on  train set...
5475/5475 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1205114
{'0': {'precision': 0.3386645093036281, 'recall': 0.01160034447182408, 'f1-score': 0.022432310441411973, 'support': 469124}, '1': {'precision': 0.33141121883773994, 'recall': 0.8393482067091314, 'f1-score': 0.475194828493154, 'support': 465485}, '2': {'precision': 0.3312212288285323, 'recall': 0.1465359765460203, 'f1-score': 0.2031819747484945, 'support': 466957}, 'accuracy': 0.3314663740416077, 'macro avg': {'precision': 0.33376565232330013, 'recall': 0.3324948425756586, 'f1-score': 0.23360303789435347, 'support': 1401566}, 'weighted avg': {'precision': 0.33377569933440565, 'recall': 0.3314663740416077, 'f1-score': 0.23302280829249958, 'support': 1401566}}
[[  5442 395083  68599]
 [  5219 390704  69562]
 [  5408 393123  68426]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.124328
{'0': {'precision': 0.35960303561004087, 'recall': 0.010782740613239198, 'f1-score': 0.020937662867372142, 'support': 171385}, '1': {'precision': 0.32954046146756544, 'recall': 0.6927764792024557, 'f1-score': 0.4466283821935442, 'support': 177545}, '2': {'precision': 0.3265351844461714, 'recall': 0.27071265221782387, 'f1-score': 0.2960151561790943, 'support': 172286}, 'accuracy': 0.3290133073428291, 'macro avg': {'precision': 0.3385595605079259, 'recall': 0.3247572906778396, 'f1-score': 0.25452706708000356, 'support': 521216}, 'weighted avg': {'precision': 0.3384321821985105, 'recall': 0.3290133073428291, 'f1-score': 0.2568691380628162, 'support': 521216}}
[[  1848 126310  43227]
 [  1580 122999  52966]
 [  1711 123935  46640]]
training model: results/universal/W3/deepOF_L2/h300
Epoch 1/50
10532/10532 - 236s - loss: 3.2675 - accuracy300: 0.3819 - val_loss: 3.2781 - val_accuracy300: 0.3627 - 236s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 231s - loss: 3.2564 - accuracy300: 0.3876 - val_loss: 3.2746 - val_accuracy300: 0.3651 - 231s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 231s - loss: 3.2496 - accuracy300: 0.3919 - val_loss: 3.2728 - val_accuracy300: 0.3674 - 231s/epoch - 22ms/step
Epoch 4/50
10532/10532 - 234s - loss: 3.2451 - accuracy300: 0.3944 - val_loss: 3.2710 - val_accuracy300: 0.3683 - 234s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 231s - loss: 3.2421 - accuracy300: 0.3963 - val_loss: 3.2724 - val_accuracy300: 0.3675 - 231s/epoch - 22ms/step
Epoch 6/50
10532/10532 - 231s - loss: 3.2397 - accuracy300: 0.3977 - val_loss: 3.2722 - val_accuracy300: 0.3687 - 231s/epoch - 22ms/step
Epoch 7/50
10532/10532 - 231s - loss: 3.2386 - accuracy300: 0.3984 - val_loss: 3.2732 - val_accuracy300: 0.3697 - 231s/epoch - 22ms/step
Epoch 8/50
10532/10532 - 231s - loss: 3.2372 - accuracy300: 0.3992 - val_loss: 3.2720 - val_accuracy300: 0.3707 - 231s/epoch - 22ms/step
Epoch 9/50
10532/10532 - 233s - loss: 3.2353 - accuracy300: 0.4006 - val_loss: 3.2732 - val_accuracy300: 0.3705 - 233s/epoch - 22ms/step
Epoch 10/50
10532/10532 - 234s - loss: 3.2340 - accuracy300: 0.4013 - val_loss: 3.2743 - val_accuracy300: 0.3695 - 234s/epoch - 22ms/step
Epoch 11/50
10532/10532 - 232s - loss: 3.2326 - accuracy300: 0.4023 - val_loss: 3.2764 - val_accuracy300: 0.3684 - 232s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 235s - loss: 3.2315 - accuracy300: 0.4028 - val_loss: 3.2806 - val_accuracy300: 0.3673 - 235s/epoch - 22ms/step
Epoch 13/50
10532/10532 - 234s - loss: 3.2302 - accuracy300: 0.4038 - val_loss: 3.2813 - val_accuracy300: 0.3680 - 234s/epoch - 22ms/step
Epoch 14/50
10532/10532 - 235s - loss: 3.2288 - accuracy300: 0.4047 - val_loss: 3.2823 - val_accuracy300: 0.3678 - 235s/epoch - 22ms/step
testing model in sample: results/universal/W3/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 213s - 213s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935364
{'0': {'precision': 0.38120327349590816, 'recall': 0.38543242549824763, 'f1-score': 0.38330618442155223, 'support': 2373669}, '1': {'precision': 0.348976748751923, 'recall': 0.4089808476475509, 'f1-score': 0.37660367068509776, 'support': 2407746}, '2': {'precision': 0.3770161949855018, 'recall': 0.30499531028068033, 'f1-score': 0.3372030251177827, 'support': 2305042}, 'accuracy': 0.3672692856246782, 'macro avg': {'precision': 0.3690654057444443, 'recall': 0.3664695278088263, 'f1-score': 0.36570429340814425, 'support': 7086457}, 'weighted avg': {'precision': 0.36889180700849206, 'recall': 0.3672692856246782, 'f1-score': 0.3660327191106397, 'support': 7086457}}
[[914889 921371 537409]
 [798747 984722 624277]
 [686367 915648 703027]]
Evaluating performance on  train set...
10532/10532 - 84s - 84s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938399
{'0': {'precision': 0.37745813754555363, 'recall': 0.3553495093686051, 'f1-score': 0.36607031749414026, 'support': 906485}, '1': {'precision': 0.33670590496598723, 'recall': 0.4006444658813513, 'f1-score': 0.3659030029351531, 'support': 883212}, '2': {'precision': 0.38355165739294794, 'recall': 0.3350325458610803, 'f1-score': 0.35765408608674654, 'support': 906106}, 'accuracy': 0.3633603790781448, 'macro avg': {'precision': 0.36590523330149627, 'recall': 0.3636755070370122, 'f1-score': 0.3632091355053466, 'support': 2695803}, 'weighted avg': {'precision': 0.36615483164886126, 'recall': 0.3633603790781448, 'f1-score': 0.36318666019355117, 'support': 2695803}}
[[322119 349367 234999]
 [276448 353854 252910]
 [254823 347708 303575]]
Evaluating performance on  val set...
3814/3814 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0902722
{'0': {'precision': 0.3706942428259685, 'recall': 0.3662779482137412, 'f1-score': 0.36847286323080847, 'support': 321398}, '1': {'precision': 0.35425731090167123, 'recall': 0.4016049186282839, 'f1-score': 0.37644817523588686, 'support': 333101}, '2': {'precision': 0.38599791907184905, 'recall': 0.3371185834098371, 'f1-score': 0.35990624257656834, 'support': 321335}, 'accuracy': 0.36873484629557896, 'macro avg': {'precision': 0.37031649093316293, 'recall': 0.3683338167506207, 'f1-score': 0.3682757603477545, 'support': 975834}, 'weighted avg': {'precision': 0.37012288370705554, 'recall': 0.36873484629557896, 'f1-score': 0.3683743109732251, 'support': 975834}}
[[117721 122083  81594]
 [108604 133775  90722]
 [ 91244 121763 108328]]
testing model out of sample: results/universal/W3/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 126s - 126s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0895461
{'0': {'precision': 0.38173902315150166, 'recall': 0.3693593604443377, 'f1-score': 0.3754471705101029, 'support': 1365448}, '1': {'precision': 0.37037906996345893, 'recall': 0.40824430567994036, 'f1-score': 0.388390975625845, 'support': 1463871}, '2': {'precision': 0.3647195585097708, 'recall': 0.3353170777982808, 'f1-score': 0.3494008462767331, 'support': 1307124}, 'accuracy': 0.37236316322985713, 'macro avg': {'precision': 0.3722792172082438, 'recall': 0.3709735813075196, 'f1-score': 0.3710796641375604, 'support': 4136443}, 'weighted avg': {'precision': 0.37234059635493005, 'recall': 0.37236316322985713, 'f1-score': 0.3717972436094705, 'support': 4136443}}
[[504341 519459 341648]
 [444455 597617 421799]
 [372371 496452 438301]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094911
{'0': {'precision': 0.3700802901195077, 'recall': 0.3712650574957087, 'f1-score': 0.3706717271005572, 'support': 526648}, '1': {'precision': 0.3391512437483745, 'recall': 0.43507714963404975, 'f1-score': 0.38117164827872946, 'support': 521519}, '2': {'precision': 0.3891170831826731, 'recall': 0.28032353095507595, 'f1-score': 0.3258800628736938, 'support': 533612}, 'accuracy': 0.3616251069207519, 'macro avg': {'precision': 0.3661162056835185, 'recall': 0.3622219126949448, 'f1-score': 0.3592411460843268, 'support': 1581779}, 'weighted avg': {'precision': 0.3663049054959887, 'recall': 0.3616251069207519, 'f1-score': 0.359023158534085, 'support': 1581779}}
[[195526 219358 111764]
 [171547 226901 123071]
 [161261 222767 149584]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0917776
{'0': {'precision': 0.3804350598015964, 'recall': 0.3918447540397991, 'f1-score': 0.386055623270992, 'support': 190356}, '1': {'precision': 0.34960774899459524, 'recall': 0.41438595758455415, 'f1-score': 0.3792506158062104, 'support': 191534}, '2': {'precision': 0.37795648060548725, 'recall': 0.29279244787678577, 'f1-score': 0.32996788648705294, 'support': 182836}, 'accuracy': 0.3674206606389647, 'macro avg': {'precision': 0.36933309646722634, 'recall': 0.36634105316704635, 'f1-score': 0.3650913751880851, 'support': 564726}, 'weighted avg': {'precision': 0.3691771193950843, 'recall': 0.3674206606389647, 'f1-score': 0.36558862203076614, 'support': 564726}}
[[74590 74816 40950]
 [65010 79369 47155]
 [56465 72838 53533]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931424
{'0': {'precision': 0.33029247272393875, 'recall': 0.2741263530351742, 'f1-score': 0.2995997712978845, 'support': 52567}, '1': {'precision': 0.4203336226473421, 'recall': 0.48025484629073667, 'f1-score': 0.4483007862033984, 'support': 73613}, '2': {'precision': 0.27152651523448623, 'recall': 0.26258261311642095, 'f1-score': 0.2669796793056288, 'support': 47208}, 'accuracy': 0.3584965510877339, 'macro avg': {'precision': 0.340717536868589, 'recall': 0.3389879374807772, 'f1-score': 0.33829341226897053, 'support': 173388}, 'weighted avg': {'precision': 0.3525199385701877, 'recall': 0.3584965510877339, 'f1-score': 0.35385034519843805, 'support': 173388}}
[[14410 25082 13075]
 [18078 35353 20182]
 [11140 23672 12396]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102948
{'0': {'precision': 0.33222769620994097, 'recall': 0.31108979629122135, 'f1-score': 0.32131147540983607, 'support': 21894}, '1': {'precision': 0.3297322530092361, 'recall': 0.4500113765642776, 'f1-score': 0.3805950044259709, 'support': 21975}, '2': {'precision': 0.3511209346384591, 'recall': 0.2475732478404132, 'f1-score': 0.29039249993471394, 'support': 22458}, 'accuracy': 0.3356099326066308, 'macro avg': {'precision': 0.33769362795254537, 'recall': 0.3362248068986374, 'f1-score': 0.33076632659017363, 'support': 66327}, 'weighted avg': {'precision': 0.33779808209038437, 'recall': 0.3356099326066308, 'f1-score': 0.3304838667272373, 'support': 66327}}
[[ 6811 10068  5015]
 [ 6826  9889  5260]
 [ 6864 10034  5560]]
Evaluating performance on  val set...
86/86 - 1s - 991ms/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001506
{'0': {'precision': 0.3422795399093761, 'recall': 0.26841601749350824, 'f1-score': 0.3008808885484489, 'support': 7317}, '1': {'precision': 0.36732929991356955, 'recall': 0.4719309068476249, 'f1-score': 0.41311156712387936, 'support': 8105}, '2': {'precision': 0.3043403077987204, 'recall': 0.2702702702702703, 'f1-score': 0.28629524196827977, 'support': 6512}, 'accuracy': 0.34416887024710496, 'macro avg': {'precision': 0.337983049207222, 'recall': 0.3368723982038011, 'f1-score': 0.33342923254686935, 'support': 21934}, 'weighted avg': {'precision': 0.34027206408779304, 'recall': 0.34416887024710496, 'f1-score': 0.3380217620473001, 'support': 21934}}
[[1964 3471 1882]
 [2139 3825 2141]
 [1635 3117 1760]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0775751
{'0': {'precision': 0.39589442815249265, 'recall': 0.46279357231149565, 'f1-score': 0.4267379922950084, 'support': 121350}, '1': {'precision': 0.40380501289760273, 'recall': 0.3395317161278861, 'f1-score': 0.3688896395309559, 'support': 135089}, '2': {'precision': 0.376978897615659, 'recall': 0.3803066560311974, 'f1-score': 0.3786354651983623, 'support': 112830}, 'accuracy': 0.39249706853269567, 'macro avg': {'precision': 0.39222611288858483, 'recall': 0.3942106481568597, 'f1-score': 0.3914210323414422, 'support': 369269}, 'weighted avg': {'precision': 0.39300870980668307, 'recall': 0.39249706853269567, 'f1-score': 0.3908777271255583, 'support': 369269}}
[[56160 34193 30997]
 [49303 45867 39919]
 [36393 33527 42910]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911134
{'0': {'precision': 0.39714897343582756, 'recall': 0.4295637530916171, 'f1-score': 0.4127208837879515, 'support': 57009}, '1': {'precision': 0.33061414941030715, 'recall': 0.3963963963963964, 'f1-score': 0.3605291785100186, 'support': 51837}, '2': {'precision': 0.40855915153622613, 'recall': 0.29783805316143985, 'f1-score': 0.3445213584810816, 'support': 55228}, 'accuracy': 0.37474554164584273, 'macro avg': {'precision': 0.37877409146078694, 'recall': 0.3745994008831512, 'f1-score': 0.3725904735930172, 'support': 164074}, 'weighted avg': {'precision': 0.37996889397849676, 'recall': 0.37474554164584273, 'f1-score': 0.3732753603647399, 'support': 164074}}
[[24489 21041 11479]
 [18956 20548 12333]
 [18217 20562 16449]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0826873
{'0': {'precision': 0.3876056763285024, 'recall': 0.4503793360522738, 'f1-score': 0.41664131118278264, 'support': 22803}, '1': {'precision': 0.3548921386442595, 'recall': 0.38417807320592995, 'f1-score': 0.36895487285021306, 'support': 22867}, '2': {'precision': 0.43461212378126324, 'recall': 0.33543268444299035, 'f1-score': 0.37863539839350013, 'support': 24452}, 'accuracy': 0.3887082513333904, 'macro avg': {'precision': 0.39236997958467507, 'recall': 0.3899966979003981, 'f1-score': 0.3880771941421653, 'support': 70122}, 'weighted avg': {'precision': 0.39332914666433605, 'recall': 0.3887082513333904, 'f1-score': 0.3878377065383857, 'support': 70122}}
[[10270  7597  4936]
 [ 8348  8785  5734]
 [ 7878  8372  8202]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910515
{'0': {'precision': 0.30482779166183943, 'recall': 0.3611372549019608, 'f1-score': 0.3306019511582197, 'support': 102000}, '1': {'precision': 0.4183517212274673, 'recall': 0.47124657050498464, 'f1-score': 0.4432266017718333, 'support': 147252}, '2': {'precision': 0.3058525006138987, 'recall': 0.1895885128621442, 'f1-score': 0.23407880724174654, 'support': 98545}, 'accuracy': 0.3591491588484087, 'macro avg': {'precision': 0.34301067116773515, 'recall': 0.34065744608969656, 'f1-score': 0.33596912005726653, 'support': 347797}, 'weighted avg': {'precision': 0.3531824514779923, 'recall': 0.3591491588484087, 'f1-score': 0.3509366056690608, 'support': 347797}}
[[36836 48909 16255]
 [51713 69392 26147]
 [32293 47569 18683]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017691
{'0': {'precision': 0.3380209319306596, 'recall': 0.3346721289527941, 'f1-score': 0.3363381949303052, 'support': 37347}, '1': {'precision': 0.32408029968302754, 'recall': 0.4546066991834865, 'f1-score': 0.37840384011484457, 'support': 37109}, '2': {'precision': 0.3617038605636097, 'recall': 0.22697536542982724, 'f1-score': 0.2789222459490014, 'support': 39132}, 'accuracy': 0.3367521217029968, 'macro avg': {'precision': 0.34126836405909894, 'recall': 0.3387513978553693, 'f1-score': 0.3312214269980504, 'support': 113588}, 'weighted avg': {'precision': 0.3416255155238844, 'recall': 0.3367521217029968, 'f1-score': 0.330300700755011, 'support': 113588}}
[[12499 17346  7502]
 [12067 16870  8172]
 [12411 17839  8882]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1065266
{'0': {'precision': 0.35455081249473774, 'recall': 0.3276532835356365, 'f1-score': 0.3405717982935016, 'support': 12852}, '1': {'precision': 0.3096476025418833, 'recall': 0.4725381292427048, 'f1-score': 0.37413185355809164, 'support': 11343}, '2': {'precision': 0.3551978537894031, 'recall': 0.21274202619105007, 'f1-score': 0.2661039091548589, 'support': 12447}, 'accuracy': 0.3334697887669887, 'macro avg': {'precision': 0.33979875627534134, 'recall': 0.33764447965646377, 'f1-score': 0.3269358536688174, 'support': 36642}, 'weighted avg': {'precision': 0.3408702440896144, 'recall': 0.3334697887669887, 'f1-score': 0.32566458500704226, 'support': 36642}}
[[4211 6068 2573]
 [3749 5360 2234]
 [3917 5882 2648]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999124
{'0': {'precision': 0.29932656174424227, 'recall': 0.27392829173618444, 'f1-score': 0.28606478682928566, 'support': 88107}, '1': {'precision': 0.3793851863805067, 'recall': 0.4248373689916877, 'f1-score': 0.4008268689796266, 'support': 110680}, '2': {'precision': 0.31722394576582785, 'recall': 0.2974551253043722, 'f1-score': 0.30702164097773627, 'support': 92814}, 'accuracy': 0.33869568348531043, 'macro avg': {'precision': 0.33197856463019226, 'recall': 0.33207359534408143, 'f1-score': 0.3313044322622161, 'support': 291601}, 'weighted avg': {'precision': 0.33541017042638394, 'recall': 0.33869568348531043, 'f1-score': 0.3362942329331537, 'support': 291601}}
[[24135 38194 25778]
 [30015 47021 33644]
 [26481 38725 27608]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034216
{'0': {'precision': 0.3150407971694707, 'recall': 0.2683766992680076, 'f1-score': 0.28984255630106953, 'support': 32514}, '1': {'precision': 0.3236294491014757, 'recall': 0.3709251642212536, 'f1-score': 0.345667005163265, 'support': 32578}, '2': {'precision': 0.33926485126269434, 'recall': 0.33982476144751844, 'f1-score': 0.3395445755318032, 'support': 33326}, 'accuracy': 0.3265154748115182, 'macro avg': {'precision': 0.3259783658445469, 'recall': 0.3263755416455932, 'f1-score': 0.32501804566537923, 'support': 98418}, 'weighted avg': {'precision': 0.3260864588304639, 'recall': 0.3265154748115182, 'f1-score': 0.32515132489945636, 'support': 98418}}
[[ 8726 12786 11002]
 [ 9440 12084 11054]
 [ 9532 12469 11325]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027592
{'0': {'precision': 0.2968556061232933, 'recall': 0.2571454170773228, 'f1-score': 0.2755773200825772, 'support': 11161}, '1': {'precision': 0.3804097226796654, 'recall': 0.422179983916953, 'f1-score': 0.4002079002079002, 'support': 13679}, '2': {'precision': 0.2939555217639232, 'recall': 0.2937043015857943, 'f1-score': 0.2938298579774854, 'support': 10531}, 'accuracy': 0.33185377851912584, 'macro avg': {'precision': 0.32374028352229395, 'recall': 0.3243432341933567, 'f1-score': 0.32320502608932095, 'support': 35371}, 'weighted avg': {'precision': 0.3283049847664215, 'recall': 0.33185377851912584, 'f1-score': 0.32920993386521186, 'support': 35371}}
[[2870 4941 3350]
 [3825 5775 4079]
 [2973 4465 3093]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003262
{'0': {'precision': 0.34947569987319016, 'recall': 0.35307374097017846, 'f1-score': 0.35126550690660413, 'support': 194356}, '1': {'precision': 0.34479874192792853, 'recall': 0.45826930393663434, 'f1-score': 0.39351753634134123, 'support': 202381}, '2': {'precision': 0.3393734566080353, 'recall': 0.2150394651115597, 'f1-score': 0.263264739052974, 'support': 187254}, 'accuracy': 0.3452690195568082, 'macro avg': {'precision': 0.34454929946971796, 'recall': 0.3421275033394575, 'f1-score': 0.33601592743363984, 'support': 583991}, 'weighted avg': {'precision': 0.3446156714030711, 'recall': 0.3452690195568082, 'f1-score': 0.3376908322718372, 'support': 583991}}
[[68622 90358 35376]
 [66628 92745 43008]
 [61107 85880 40267]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022533
{'0': {'precision': 0.33717755014346507, 'recall': 0.3272172076568154, 'f1-score': 0.33212271814967026, 'support': 74339}, '1': {'precision': 0.32660608133719154, 'recall': 0.4766131969833925, 'f1-score': 0.38760217236271877, 'support': 74123}, '2': {'precision': 0.3678287682023812, 'recall': 0.2142529398654938, 'f1-score': 0.2707812111672604, 'support': 76279}, 'accuracy': 0.3381492473558452, 'macro avg': {'precision': 0.34387079989434594, 'recall': 0.33936111483523385, 'f1-score': 0.3301687005598831, 'support': 224741}, 'weighted avg': {'precision': 0.34409420211168024, 'recall': 0.3381492473558452, 'f1-score': 0.3296008586470542, 'support': 224741}}
[[24325 36298 13716]
 [24423 35328 14372]
 [23395 36541 16343]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10542
{'0': {'precision': 0.34117694871169635, 'recall': 0.3257158376658648, 'f1-score': 0.33326716951171104, 'support': 25774}, '1': {'precision': 0.32521094764171354, 'recall': 0.4641781826603876, 'f1-score': 0.38246238987309567, 'support': 25906}, '2': {'precision': 0.3500158378207159, 'recall': 0.21508934480476505, 'f1-score': 0.26644483024691357, 'support': 25687}, 'accuracy': 0.33534969689919475, 'macro avg': {'precision': 0.33880124472470863, 'recall': 0.3349944550436725, 'f1-score': 0.32739146321057344, 'support': 77367}, 'weighted avg': {'precision': 0.33876544666074976, 'recall': 0.33534969689919475, 'f1-score': 0.3275539578062963, 'support': 77367}}
[[ 8395 12684  4695]
 [ 8316 12025  5565]
 [ 7895 12267  5525]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/EXC
Evaluating performance on  test set...
5098/5098 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948033
{'0': {'precision': 0.42262533391315155, 'recall': 0.49623802055733507, 'f1-score': 0.45648301919560613, 'support': 466111}, '1': {'precision': 0.29369606843558055, 'recall': 0.2930176821870635, 'f1-score': 0.29335648312015405, 'support': 403061}, '2': {'precision': 0.4243176108855938, 'recall': 0.3461645266044729, 'f1-score': 0.38127737881281165, 'support': 435735}, 'accuracy': 0.3833545225828354, 'macro avg': {'precision': 0.38021300441144196, 'recall': 0.3784734097829571, 'f1-score': 0.3770389603761906, 'support': 1304907}, 'weighted avg': {'precision': 0.383366617111059, 'recall': 0.3833545225828354, 'f1-score': 0.38098363535499163, 'support': 1304907}}
[[231302 141311  93498]
 [173812 118104 111145]
 [142184 142715 150836]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0867254
{'0': {'precision': 0.40748019592429097, 'recall': 0.4983851881070953, 'f1-score': 0.44837146374191833, 'support': 162248}, '1': {'precision': 0.33267413755218633, 'recall': 0.32679024885728797, 'f1-score': 0.3297059445195258, 'support': 157520}, '2': {'precision': 0.4244373243483669, 'recall': 0.33605091094946926, 'f1-score': 0.3751078395903487, 'support': 160437}, 'accuracy': 0.38786143417915264, 'macro avg': {'precision': 0.38819721927494805, 'recall': 0.3870754493046175, 'f1-score': 0.38439508261726424, 'support': 480205}, 'weighted avg': {'precision': 0.3886072156308737, 'recall': 0.38786143417915264, 'f1-score': 0.3849685656964656, 'support': 480205}}
[[80862 49835 31551]
 [64483 51476 41561]
 [53099 53423 53915]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0739199
{'0': {'precision': 0.4056255195984851, 'recall': 0.5173077300661679, 'f1-score': 0.4547094101911378, 'support': 50931}, '1': {'precision': 0.37746266285351127, 'recall': 0.3428705440900563, 'f1-score': 0.3593360054450579, 'support': 55432}, '2': {'precision': 0.4348674128082478, 'recall': 0.3600915226210848, 'f1-score': 0.39396266105706024, 'support': 52009}, 'accuracy': 0.4046232919960599, 'macro avg': {'precision': 0.40598519842008135, 'recall': 0.4067565989257697, 'f1-score': 0.40266935889775196, 'support': 158372}, 'weighted avg': {'precision': 0.40537117002191325, 'recall': 0.4046232919960599, 'f1-score': 0.4013785420604143, 'support': 158372}}
[[26347 14598  9986]
 [22074 19006 14352]
 [16533 16748 18728]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/AAL
Evaluating performance on  test set...
5760/5760 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0775207
{'0': {'precision': 0.4024822352201866, 'recall': 0.35269312311631756, 'f1-score': 0.3759463678776187, 'support': 472147}, '1': {'precision': 0.4104432617365508, 'recall': 0.36378775585567513, 'f1-score': 0.38570976801620344, 'support': 563257}, '2': {'precision': 0.35837477025660025, 'recall': 0.4583078054857731, 'f1-score': 0.4022271550203437, 'support': 439063}, 'accuracy': 0.3883810217522671, 'macro avg': {'precision': 0.3904334224044459, 'recall': 0.39159622815258865, 'f1-score': 0.38796109697138864, 'support': 1474467}, 'weighted avg': {'precision': 0.392389196870207, 'recall': 0.3883810217522671, 'f1-score': 0.3875018823225707, 'support': 1474467}}
[[166523 153419 152205]
 [150286 204906 208065]
 [ 96931 140906 201226]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.085163
{'0': {'precision': 0.40022683883152343, 'recall': 0.4215428191503738, 'f1-score': 0.410608370124075, 'support': 184999}, '1': {'precision': 0.35645531232905636, 'recall': 0.40811998681463574, 'f1-score': 0.3805420801081907, 'support': 182020}, '2': {'precision': 0.4104458615792717, 'recall': 0.33027883936416214, 'f1-score': 0.3660241993052631, 'support': 185519}, 'accuracy': 0.38647839605601786, 'macro avg': {'precision': 0.3890426709132839, 'recall': 0.38664721510972394, 'f1-score': 0.38572488317917625, 'support': 552538}, 'weighted avg': {'precision': 0.3892385079423547, 'recall': 0.38647839605601786, 'f1-score': 0.3857342856360824, 'support': 552538}}
[[77985 65807 41207]
 [60930 74286 46804]
 [55937 68309 61273]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0814635
{'0': {'precision': 0.3977014124617008, 'recall': 0.4355186768206942, 'f1-score': 0.41575184072725346, 'support': 71827}, '1': {'precision': 0.37296693816447185, 'recall': 0.3899714797373483, 'f1-score': 0.38127970844384496, 'support': 75385}, '2': {'precision': 0.3968863795810644, 'recall': 0.3387848801562745, 'f1-score': 0.36554127339441067, 'support': 70133}, 'accuracy': 0.3885067519381628, 'macro avg': {'precision': 0.389184910069079, 'recall': 0.3880916789047723, 'f1-score': 0.387524274188503, 'support': 217345}, 'weighted avg': {'precision': 0.3888593915000303, 'recall': 0.3885067519381628, 'f1-score': 0.3875933856860102, 'support': 217345}}
[[31282 24578 15967]
 [25848 29398 20139]
 [21527 24846 23760]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/WBA
Evaluating performance on  test set...
6315/6315 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0885445
{'0': {'precision': 0.4030808429619398, 'recall': 0.4594138431726434, 'f1-score': 0.42940767555179576, 'support': 564047}, '1': {'precision': 0.3526753764587319, 'recall': 0.370170298304682, 'f1-score': 0.36121112394059374, 'support': 521849}, '2': {'precision': 0.39771878654661763, 'recall': 0.3192188365859819, 'f1-score': 0.35417119769795735, 'support': 530542}, 'accuracy': 0.38458821185841957, 'macro avg': {'precision': 0.3844916686557631, 'recall': 0.38293432602110244, 'f1-score': 0.3815966657301156, 'support': 1616438}, 'weighted avg': {'precision': 0.38504808301449334, 'recall': 0.38458821185841957, 'f1-score': 0.3826973076346314, 'support': 1616438}}
[[259131 179469 125447]
 [197656 193173 131020]
 [186089 175094 169359]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0864593
{'0': {'precision': 0.38822128447823684, 'recall': 0.4493223657584144, 'f1-score': 0.4165430803045168, 'support': 182842}, '1': {'precision': 0.35653588507340184, 'recall': 0.39993163938673915, 'f1-score': 0.3769890349737567, 'support': 181391}, '2': {'precision': 0.4198222098451481, 'recall': 0.3058385119695902, 'f1-score': 0.35387832382529083, 'support': 187308}, 'accuracy': 0.38435039280851285, 'macro avg': {'precision': 0.38819312646559556, 'recall': 0.3850308390382479, 'f1-score': 0.3824701463678548, 'support': 551541}, 'weighted avg': {'precision': 0.3885325212587899, 'recall': 0.38435039280851285, 'f1-score': 0.3822530492040134, 'support': 551541}}
[[82155 63595 37092]
 [66772 72544 42075]
 [62692 67330 57286]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0872858
{'0': {'precision': 0.39802919308987533, 'recall': 0.4479910164902781, 'f1-score': 0.42153485409911995, 'support': 65008}, '1': {'precision': 0.35083230441961827, 'recall': 0.3832864734849101, 'f1-score': 0.36634201655870885, 'support': 61531}, '2': {'precision': 0.4104284976768198, 'recall': 0.3218924222132245, 'f1-score': 0.36080854629241726, 'support': 64214}, 'accuracy': 0.38467022799117184, 'macro avg': {'precision': 0.3864299983954378, 'recall': 0.3843899707294709, 'f1-score': 0.3828951389834154, 'support': 190753}, 'weighted avg': {'precision': 0.38697897206046283, 'recall': 0.38467022799117184, 'f1-score': 0.3832887996926433, 'support': 190753}}
[[29123 21487 14398]
 [22653 23584 15294]
 [21392 22152 20670]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
6082/6082 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961843
{'0': {'precision': 0.3983813705882568, 'recall': 0.4003045677819456, 'f1-score': 0.3993406537020884, 'support': 544378}, '1': {'precision': 0.32761344235931233, 'recall': 0.4088229625781368, 'f1-score': 0.3637405679235313, 'support': 477368}, '2': {'precision': 0.40035740590927205, 'recall': 0.30984909934324384, 'f1-score': 0.3493360894864768, 'support': 535054}, 'accuracy': 0.37182810894141827, 'macro avg': {'precision': 0.37545073961894704, 'recall': 0.37299220990110876, 'f1-score': 0.37080577037069884, 'support': 1556800}, 'weighted avg': {'precision': 0.3773606493908363, 'recall': 0.37182810894141827, 'f1-score': 0.37123846726211024, 'support': 1556800}}
[[217917 202212 124249]
 [158149 195159 124060]
 [170940 198328 165786]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989019
{'0': {'precision': 0.36280301687639077, 'recall': 0.35418058432539207, 'f1-score': 0.3584399539875435, 'support': 208069}, '1': {'precision': 0.333498071092949, 'recall': 0.438330133984837, 'f1-score': 0.37879479714303665, 'support': 206292}, '2': {'precision': 0.38107275666398355, 'recall': 0.2724902960651496, 'f1-score': 0.3177616233112465, 'support': 210224}, 'accuracy': 0.35447857377298525, 'macro avg': {'precision': 0.3591246148777745, 'recall': 0.35500033812512627, 'f1-score': 0.35166545814727557, 'support': 624585}, 'weighted avg': {'precision': 0.3592732521550944, 'recall': 0.35447857377298525, 'f1-score': 0.351471294663575, 'support': 624585}}
[[73694 89950 44425]
 [67254 90424 48614]
 [62176 90764 57284]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094325
{'0': {'precision': 0.3824242908935807, 'recall': 0.3952690601493401, 'f1-score': 0.3887406002303367, 'support': 72586}, '1': {'precision': 0.34294676828759196, 'recall': 0.40614450173034816, 'f1-score': 0.3718797692645955, 'support': 70795}, '2': {'precision': 0.37551594925151693, 'recall': 0.29008037380431106, 'f1-score': 0.32731492995109013, 'support': 68057}, 'accuracy': 0.3650526395444528, 'macro avg': {'precision': 0.36696233614422985, 'recall': 0.3638313118946665, 'f1-score': 0.36264509981534077, 'support': 211438}, 'weighted avg': {'precision': 0.3669825433362594, 'recall': 0.3650526395444528, 'f1-score': 0.36332364882891244, 'support': 211438}}
[[28691 28171 15724]
 [24935 28753 17107]
 [21398 26917 19742]]
testing model on single stock: results/universal/W3/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
13689/13689 - 106s - 106s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965343
{'0': {'precision': 0.34861614097558014, 'recall': 0.3038841183929513, 'f1-score': 0.32471683232874493, 'support': 1134054}, '1': {'precision': 0.35562580413860273, 'recall': 0.4698815828083685, 'f1-score': 0.4048468090737503, 'support': 1237067}, '2': {'precision': 0.35403188192317425, 'recall': 0.2753183464078417, 'f1-score': 0.3097527192934553, 'support': 1133121}, 'accuracy': 0.3532475782209105, 'macro avg': {'precision': 0.35275794234578567, 'recall': 0.3496946825363872, 'f1-score': 0.3464387868986502, 'support': 3504242}, 'weighted avg': {'precision': 0.35284190871033405, 'recall': 0.3532475782209105, 'f1-score': 0.34816555510969244, 'support': 3504242}}
[[344621 527925 261508]
 [348080 581275 307712]
 [295839 525313 311969]]
Evaluating performance on  train set...
5475/5475 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988885
{'0': {'precision': 0.3557417522025128, 'recall': 0.2674983893937339, 'f1-score': 0.3053729675067195, 'support': 471872}, '1': {'precision': 0.33199799615085546, 'recall': 0.4279930243582105, 'f1-score': 0.37393290872908447, 'support': 459886}, '2': {'precision': 0.3624494364198782, 'recall': 0.3501650677831535, 'f1-score': 0.3562013703716936, 'support': 469807}, 'accuracy': 0.3478704162846532, 'macro avg': {'precision': 0.3500630615910822, 'recall': 0.34855216051169924, 'f1-score': 0.34516908220249914, 'support': 1401565}, 'weighted avg': {'precision': 0.3501993021581234, 'recall': 0.3478704162846532, 'f1-score': 0.34490684327685744, 'support': 1401565}}
[[126225 202153 143494]
 [117178 196828 145880]
 [111419 193878 164510]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967302
{'0': {'precision': 0.3427244409834242, 'recall': 0.28742528936703693, 'f1-score': 0.3126484607651299, 'support': 171495}, '1': {'precision': 0.34830768669279233, 'recall': 0.42511915898258273, 'f1-score': 0.3828992274109868, 'support': 179592}, '2': {'precision': 0.36386105755554854, 'recall': 0.3383373792827795, 'f1-score': 0.35063534800989266, 'support': 170129}, 'accuracy': 0.35148767497544203, 'macro avg': {'precision': 0.3516310617439217, 'recall': 0.3502939425441331, 'f1-score': 0.3487276787286698, 'support': 521216}, 'weighted avg': {'precision': 0.3515473813847852, 'recall': 0.35148767497544203, 'f1-score': 0.34925352819116245, 'support': 521216}}
[[49292 73009 49194]
 [51804 76348 51440]
 [42728 69840 57561]]
training model: results/universal/W3/deepOF_L2/h500
Epoch 1/50
10532/10532 - 237s - loss: 3.2645 - accuracy500: 0.3818 - val_loss: 3.3011 - val_accuracy500: 0.3621 - 237s/epoch - 23ms/step
Epoch 2/50
10532/10532 - 232s - loss: 3.2575 - accuracy500: 0.3857 - val_loss: 3.3020 - val_accuracy500: 0.3635 - 232s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 230s - loss: 3.2520 - accuracy500: 0.3891 - val_loss: 3.3004 - val_accuracy500: 0.3635 - 230s/epoch - 22ms/step
Epoch 4/50
10532/10532 - 232s - loss: 3.2489 - accuracy500: 0.3909 - val_loss: 3.2989 - val_accuracy500: 0.3659 - 232s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 240s - loss: 3.2451 - accuracy500: 0.3935 - val_loss: 3.2976 - val_accuracy500: 0.3665 - 240s/epoch - 23ms/step
Epoch 6/50
10532/10532 - 245s - loss: 3.2447 - accuracy500: 0.3940 - val_loss: 3.2978 - val_accuracy500: 0.3656 - 245s/epoch - 23ms/step
Epoch 7/50
10532/10532 - 241s - loss: 3.2427 - accuracy500: 0.3951 - val_loss: 3.2910 - val_accuracy500: 0.3677 - 241s/epoch - 23ms/step
Epoch 8/50
10532/10532 - 240s - loss: 3.2419 - accuracy500: 0.3954 - val_loss: 3.2953 - val_accuracy500: 0.3659 - 240s/epoch - 23ms/step
Epoch 9/50
10532/10532 - 234s - loss: 3.2405 - accuracy500: 0.3967 - val_loss: 3.2995 - val_accuracy500: 0.3664 - 234s/epoch - 22ms/step
Epoch 10/50
10532/10532 - 240s - loss: 3.2389 - accuracy500: 0.3973 - val_loss: 3.2975 - val_accuracy500: 0.3673 - 240s/epoch - 23ms/step
Epoch 11/50
10532/10532 - 234s - loss: 3.2374 - accuracy500: 0.3987 - val_loss: 3.2987 - val_accuracy500: 0.3665 - 234s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 232s - loss: 3.2355 - accuracy500: 0.4000 - val_loss: 3.2991 - val_accuracy500: 0.3665 - 232s/epoch - 22ms/step
Epoch 13/50
10532/10532 - 231s - loss: 3.2343 - accuracy500: 0.4010 - val_loss: 3.3034 - val_accuracy500: 0.3654 - 231s/epoch - 22ms/step
Epoch 14/50
10532/10532 - 229s - loss: 3.2329 - accuracy500: 0.4021 - val_loss: 3.3026 - val_accuracy500: 0.3654 - 229s/epoch - 22ms/step
Epoch 15/50
10532/10532 - 232s - loss: 3.2314 - accuracy500: 0.4034 - val_loss: 3.3038 - val_accuracy500: 0.3667 - 232s/epoch - 22ms/step
Epoch 16/50
10532/10532 - 231s - loss: 3.2309 - accuracy500: 0.4040 - val_loss: 3.3040 - val_accuracy500: 0.3647 - 231s/epoch - 22ms/step
Epoch 17/50
10532/10532 - 231s - loss: 3.2295 - accuracy500: 0.4049 - val_loss: 3.3020 - val_accuracy500: 0.3639 - 231s/epoch - 22ms/step
testing model in sample: results/universal/W3/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 210s - 210s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959024
{'0': {'precision': 0.3695310420602839, 'recall': 0.5748916766990573, 'f1-score': 0.4498839685717487, 'support': 2451227}, '1': {'precision': 0.4231901661272592, 'recall': 0.024052602971478907, 'f1-score': 0.04551812013777233, 'support': 2288692}, '2': {'precision': 0.36181596673922123, 'recall': 0.4846113721576211, 'f1-score': 0.41430640068538627, 'support': 2346538}, 'accuracy': 0.3670943039660016, 'macro avg': {'precision': 0.3848457249755881, 'recall': 0.3611852172760524, 'f1-score': 0.30323616313163576, 'support': 7086457}, 'weighted avg': {'precision': 0.3843064778761448, 'recall': 0.3670943039660016, 'f1-score': 0.30750633227522095, 'support': 7086457}}
[[1409190   38704 1003333]
 [1231214   55049 1002429]
 [1173051   36328 1137159]]
Evaluating performance on  train set...
10532/10532 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982132
{'0': {'precision': 0.35857497508529945, 'recall': 0.5780568385229056, 'f1-score': 0.4426002052455205, 'support': 905020}, '1': {'precision': 0.4261511728931364, 'recall': 0.02210290807578526, 'f1-score': 0.04202607673079106, 'support': 887666}, '2': {'precision': 0.3639985387790407, 'recall': 0.4799422444710929, 'f1-score': 0.4140060041014336, 'support': 903117}, 'accuracy': 0.36212475466493654, 'macro avg': {'precision': 0.3829082289191588, 'recall': 0.3600339970232613, 'f1-score': 0.29954409535924836, 'support': 2695803}, 'weighted avg': {'precision': 0.3826432047651729, 'recall': 0.36212475466493654, 'f1-score': 0.30112104541195694, 'support': 2695803}}
[[523153  13496 368371]
 [479076  19620 388970]
 [456749  12924 433444]]
Evaluating performance on  val set...
3814/3814 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962697
{'0': {'precision': 0.3621002782980595, 'recall': 0.5777560662798928, 'f1-score': 0.4451864023587269, 'support': 330598}, '1': {'precision': 0.43759976352349983, 'recall': 0.023446235520318277, 'f1-score': 0.04450778074416144, 'support': 315701}, '2': {'precision': 0.3724338068781045, 'recall': 0.4875900890648945, 'f1-score': 0.422302296303889, 'support': 329535}, 'accuracy': 0.36797754536119875, 'macro avg': {'precision': 0.390711282899888, 'recall': 0.3629307969550352, 'f1-score': 0.3039988264689258, 'support': 975834}, 'weighted avg': {'precision': 0.39001539739186225, 'recall': 0.36797754536119875, 'f1-score': 0.3078313241270595, 'support': 975834}}
[[191005   4780 134813]
 [172363   7402 135936]
 [164124   4733 160678]]
testing model out of sample: results/universal/W3/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 130s - 130s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929384
{'0': {'precision': 0.38415569547796224, 'recall': 0.5595521524587375, 'f1-score': 0.4555544319228665, 'support': 1469250}, '1': {'precision': 0.3860324871121486, 'recall': 0.03109175231887691, 'f1-score': 0.05754844883962039, 'support': 1276480}, '2': {'precision': 0.3657886370525751, 'recall': 0.49804812351649835, 'f1-score': 0.42179345127122575, 'support': 1390713}, 'accuracy': 0.3757943721211679, 'macro avg': {'precision': 0.37865893988089533, 'recall': 0.36289734276470426, 'f1-score': 0.31163211067790425, 'support': 4136443}, 'weighted avg': {'precision': 0.37855967495048504, 'recall': 0.3757943721211679, 'f1-score': 0.3213815418404727, 'support': 4136443}}
[[822122  32207 614921]
 [650797  39688 585995]
 [667156  30915 692642]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998273
{'0': {'precision': 0.3538957648368421, 'recall': 0.5864478205720653, 'f1-score': 0.4414161019836192, 'support': 525849}, '1': {'precision': 0.3726923728335121, 'recall': 0.02526478946008783, 'f1-score': 0.047321647781136934, 'support': 522585}, '2': {'precision': 0.36310111147656593, 'recall': 0.45951119819253955, 'f1-score': 0.4056565282052597, 'support': 533345}, 'accuracy': 0.35824473583224964, 'macro avg': {'precision': 0.36322974971564004, 'recall': 0.3570746027415643, 'f1-score': 0.29813142599000525, 'support': 1581779}, 'weighted avg': {'precision': 0.36320961398612484, 'recall': 0.35824473583224964, 'f1-score': 0.29915852982832863, 'support': 1581779}}
[[308383  11153 206313]
 [285815  13203 223567]
 [277197  11070 245078]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0930352
{'0': {'precision': 0.38116452719773053, 'recall': 0.57462846331931, 'f1-score': 0.4583167876487126, 'support': 200855}, '1': {'precision': 0.3763415772281848, 'recall': 0.02800136563800177, 'f1-score': 0.052124456700292456, 'support': 172813}, '2': {'precision': 0.3665600019271923, 'recall': 0.4778548922316783, 'f1-score': 0.4148730474297075, 'support': 191058}, 'accuracy': 0.3746135293930154, 'macro avg': {'precision': 0.37468870211770255, 'recall': 0.36016157372966334, 'f1-score': 0.30843809725957083, 'support': 564726}, 'weighted avg': {'precision': 0.37474764566186075, 'recall': 0.3746135293930154, 'f1-score': 0.31931913319867483, 'support': 564726}}
[[115417   4204  81234]
 [ 91439   4839  76535]
 [ 95945   3815  91298]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.123712
{'0': {'precision': 0.30100107219821864, 'recall': 0.557513075622321, 'f1-score': 0.39093597689184256, 'support': 50858}, '1': {'precision': 0.44483985765124556, 'recall': 0.008104883678709443, 'f1-score': 0.01591971369986882, 'support': 77114}, '2': {'precision': 0.2607219993829065, 'recall': 0.44653866478774, 'f1-score': 0.32922077922077925, 'support': 45416}, 'accuracy': 0.28409693865780794, 'macro avg': {'precision': 0.33552097641079026, 'recall': 0.3373855413629235, 'f1-score': 0.24535882327083022, 'support': 173388}, 'weighted avg': {'precision': 0.35442270305182155, 'recall': 0.28409693865780794, 'f1-score': 0.20798293782792304, 'support': 173388}}
[[28354   342 22162]
 [41147   625 35342]
 [24698   438 20280]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1031867
{'0': {'precision': 0.3373137179977073, 'recall': 0.6456980890554996, 'f1-score': 0.4431336868195651, 'support': 21874}, '1': {'precision': 0.35964912280701755, 'recall': 0.00936201306114993, 'f1-score': 0.01824898740374772, 'support': 21897}, '2': {'precision': 0.346786686204731, 'recall': 0.36721936513566233, 'f1-score': 0.3567106651450227, 'support': 22556}, 'accuracy': 0.34091697197219833, 'macro avg': {'precision': 0.34791650900315196, 'recall': 0.3407598224174373, 'f1-score': 0.27269777978944515, 'support': 66327}, 'weighted avg': {'precision': 0.34790896020656786, 'recall': 0.34091697197219833, 'f1-score': 0.273473398550849, 'support': 66327}}
[[14124   186  7564]
 [13654   205  8038]
 [14094   179  8283]]
Evaluating performance on  val set...
86/86 - 1s - 857ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1148285
{'0': {'precision': 0.3279265493496557, 'recall': 0.600196050973253, 'f1-score': 0.42412547622581764, 'support': 7141}, '1': {'precision': 0.4260089686098655, 'recall': 0.010882016036655211, 'f1-score': 0.02122193678096727, 'support': 8730}, '2': {'precision': 0.2776299039463025, 'recall': 0.39567870691077023, 'f1-score': 0.32630576713819365, 'support': 6063}, 'accuracy': 0.3091091456186742, 'macro avg': {'precision': 0.34385514063527456, 'recall': 0.3355855913068928, 'f1-score': 0.2572177267149929, 'support': 21934}, 'weighted avg': {'precision': 0.3530615433799785, 'recall': 0.3091091456186742, 'f1-score': 0.23672560408431093, 'support': 21934}}
[[4286   74 2781]
 [5174   95 3461]
 [3610   54 2399]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.080129
{'0': {'precision': 0.42592613694634046, 'recall': 0.53209768458215, 'f1-score': 0.4731287598059537, 'support': 140493}, '1': {'precision': 0.40573001376204176, 'recall': 0.03266486034588693, 'f1-score': 0.060461994518709095, 'support': 99281}, '2': {'precision': 0.39452094615691047, 'recall': 0.5659446310668366, 'f1-score': 0.46493495782805777, 'support': 129495}, 'accuracy': 0.4096904966298281, 'macro avg': {'precision': 0.4087256989550975, 'recall': 0.3769023919982912, 'f1-score': 0.3328419040509068, 'support': 369269}, 'weighted avg': {'precision': 0.4094830927505439, 'recall': 0.4096904966298281, 'f1-score': 0.35930651772332406, 'support': 369269}}
[[74756  2371 63366]
 [46929  3243 49109]
 [53829  2379 73287]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986527
{'0': {'precision': 0.36362553029219696, 'recall': 0.5577000402090873, 'f1-score': 0.44022217413258313, 'support': 54714}, '1': {'precision': 0.35452983059170146, 'recall': 0.025912035458574838, 'f1-score': 0.0482943143812709, 'support': 55727}, '2': {'precision': 0.35700860879279755, 'recall': 0.5064605746462066, 'f1-score': 0.4188007832374844, 'support': 53633}, 'accuracy': 0.3603313139193291, 'macro avg': {'precision': 0.358387989892232, 'recall': 0.3633575501046229, 'f1-score': 0.3024390905837795, 'support': 164074}, 'weighted avg': {'precision': 0.3583732574885425, 'recall': 0.3603313139193291, 'f1-score': 0.3001033417871889, 'support': 164074}}
[[30514  1331 22869]
 [28230  1444 26053]
 [25172  1298 27163]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0856775
{'0': {'precision': 0.3802303421990223, 'recall': 0.5719567926879934, 'f1-score': 0.45679114753554423, 'support': 24070}, '1': {'precision': 0.38170347003154576, 'recall': 0.030095010694921157, 'f1-score': 0.05579122095167835, 'support': 20103}, '2': {'precision': 0.4127745128363749, 'recall': 0.5142780068596092, 'f1-score': 0.4579694229482318, 'support': 25949}, 'accuracy': 0.3952682467699153, 'macro avg': {'precision': 0.391569441688981, 'recall': 0.37210993674750786, 'f1-score': 0.32351726381181817, 'support': 70122}, 'weighted avg': {'precision': 0.3926958020074402, 'recall': 0.3952682467699153, 'f1-score': 0.3422660847103021, 'support': 70122}}
[[13767   463  9840]
 [10353   605  9145]
 [12087   517 13345]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1201855
{'0': {'precision': 0.29565477738893986, 'recall': 0.6075401668196351, 'f1-score': 0.39774835748951765, 'support': 99149}, '1': {'precision': 0.5094869992972593, 'recall': 0.0241341659898004, 'f1-score': 0.04608529275284934, 'support': 150202}, '2': {'precision': 0.29241790260038997, 'recall': 0.40676106698088293, 'f1-score': 0.3402396903822216, 'support': 98446}, 'accuracy': 0.29875473336457764, 'macro avg': {'precision': 0.36585322642886303, 'recall': 0.3461451332634395, 'f1-score': 0.26135778020819617, 'support': 347797}, 'weighted avg': {'precision': 0.3870856120989569, 'recall': 0.29875473336457764, 'f1-score': 0.2295985635245843, 'support': 347797}}
[[60237  1739 37173]
 [86853  3625 59724]
 [56651  1751 40044]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102794
{'0': {'precision': 0.340108298320921, 'recall': 0.5998501912736417, 'f1-score': 0.43409156906398216, 'support': 37381}, '1': {'precision': 0.37706342311033886, 'recall': 0.011583217679086153, 'f1-score': 0.022475983324270435, 'support': 37468}, '2': {'precision': 0.34953126343854823, 'recall': 0.41962879785229357, 'f1-score': 0.3813858552207116, 'support': 38739}, 'accuracy': 0.3443409515089622, 'macro avg': {'precision': 0.3555676616232694, 'recall': 0.3436874022683405, 'f1-score': 0.2793178025363214, 'support': 113588}, 'weighted avg': {'precision': 0.3555119576978065, 'recall': 0.3443409515089622, 'f1-score': 0.28034135411988614, 'support': 113588}}
[[22423   399 14559]
 [21341   434 15693]
 [22165   318 16256]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984483
{'0': {'precision': 0.3653946432803982, 'recall': 0.5998443579766537, 'f1-score': 0.4541464133156577, 'support': 12850}, '1': {'precision': 0.3181818181818182, 'recall': 0.01228932584269663, 'f1-score': 0.02366463826910074, 'support': 11392}, '2': {'precision': 0.3527503806182564, 'recall': 0.429758064516129, 'f1-score': 0.3874650089068237, 'support': 12400}, 'accuracy': 0.35961464985535724, 'macro avg': {'precision': 0.3454422806934909, 'recall': 0.3472972494451598, 'f1-score': 0.28842535349719406, 'support': 36642}, 'weighted avg': {'precision': 0.3464372348274321, 'recall': 0.35961464985535724, 'f1-score': 0.29774398451810524, 'support': 36642}}
[[7708  155 4987]
 [6461  140 4791]
 [6926  145 5329]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185182
{'0': {'precision': 0.28989809192319477, 'recall': 0.6879745402100195, 'f1-score': 0.4079110099718019, 'support': 83897}, '1': {'precision': 0.39820742637644047, 'recall': 0.00788852908102441, 'f1-score': 0.0154705843337534, 'support': 118273}, '2': {'precision': 0.3028605654580343, 'recall': 0.3053191846227818, 'f1-score': 0.3040849054502528, 'support': 89431}, 'accuracy': 0.29477608101481134, 'macro avg': {'precision': 0.33032202791922316, 'recall': 0.33372741797127525, 'f1-score': 0.24248883325193604, 'support': 291601}, 'weighted avg': {'precision': 0.3378036782705769, 'recall': 0.29477608101481134, 'f1-score': 0.21689527677830953, 'support': 291601}}
[[57719   709 25469]
 [79957   933 37383]
 [61425   701 27305]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048255
{'0': {'precision': 0.3262863313510472, 'recall': 0.6682136738825728, 'f1-score': 0.4384695566864921, 'support': 32105}, '1': {'precision': 0.31542461005199307, 'recall': 0.0056138186304750155, 'f1-score': 0.011031305876291784, 'support': 32420}, '2': {'precision': 0.3410195687398729, 'recall': 0.32289853362051163, 'f1-score': 0.3317117526710616, 'support': 33893}, 'accuracy': 0.33102684468288324, 'macro avg': {'precision': 0.3275768367143044, 'recall': 0.33224200871118653, 'f1-score': 0.26040420507794854, 'support': 98418}, 'weighted avg': {'precision': 0.3277821614868367, 'recall': 0.33102684468288324, 'f1-score': 0.2609015270297049, 'support': 98418}}
[[21453   196 10456]
 [21546   182 10692]
 [22750   199 10944]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151265
{'0': {'precision': 0.31408134069078275, 'recall': 0.6918782640014407, 'f1-score': 0.43203733378313797, 'support': 11106}, '1': {'precision': 0.3822525597269625, 'recall': 0.008095995373716929, 'f1-score': 0.015856161959368585, 'support': 13834}, '2': {'precision': 0.2956751154244794, 'recall': 0.3008340523439747, 'f1-score': 0.29823227523284546, 'support': 10431}, 'accuracy': 0.30912329309321196, 'macro avg': {'precision': 0.3306696719474082, 'recall': 0.33360277057304416, 'f1-score': 0.2487085903251173, 'support': 35371}, 'weighted avg': {'precision': 0.33531583528787356, 'recall': 0.30912329309321196, 'f1-score': 0.2298046884876098, 'support': 35371}}
[[7684  104 3318]
 [9565  112 4157]
 [7216   77 3138]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041833
{'0': {'precision': 0.3543167372881356, 'recall': 0.540360974378392, 'f1-score': 0.4279953214503504, 'support': 198075}, '1': {'precision': 0.40454780361757103, 'recall': 0.019424606817967514, 'f1-score': 0.037069308431041996, 'support': 201497}, '2': {'precision': 0.32073641987099427, 'recall': 0.4734653153959191, 'f1-score': 0.3824156091578982, 'support': 184419}, 'accuracy': 0.3394949579702427, 'macro avg': {'precision': 0.359866986925567, 'recall': 0.34441696553075957, 'f1-score': 0.2824934130130969, 'support': 583991}, 'weighted avg': {'precision': 0.36104382831253573, 'recall': 0.3394949579702427, 'f1-score': 0.2787187336148986, 'support': 583991}}
[[107032   2980  88063]
 [100726   3914  96857]
 [ 94322   2781  87316]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014423
{'0': {'precision': 0.3448574834724179, 'recall': 0.5577789164262021, 'f1-score': 0.42620535461303466, 'support': 74162}, '1': {'precision': 0.3975346687211094, 'recall': 0.020861971375434624, 'f1-score': 0.039643515673017826, 'support': 74202}, '2': {'precision': 0.3495976054551221, 'recall': 0.4618275135184676, 'f1-score': 0.39795118263920615, 'support': 76377}, 'accuracy': 0.3478982473157991, 'macro avg': {'precision': 0.36399658588288314, 'recall': 0.34682280044003483, 'f1-score': 0.2879333509750862, 'support': 224741}, 'weighted avg': {'precision': 0.36386064175905186, 'recall': 0.3478982473157991, 'f1-score': 0.2889734722868359, 'support': 224741}}
[[41366  1164 31632]
 [38663  1548 33991]
 [39922  1182 35273]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022464
{'0': {'precision': 0.3418419798901733, 'recall': 0.5329971068887325, 'f1-score': 0.41653554133121495, 'support': 25578}, '1': {'precision': 0.3595890410958904, 'recall': 0.0205463368816531, 'f1-score': 0.03887161261661484, 'support': 25552}, '2': {'precision': 0.34747127074890355, 'recall': 0.4771124747493997, 'f1-score': 0.40210076610507045, 'support': 26237}, 'accuracy': 0.34479816976230176, 'macro avg': {'precision': 0.3496340972449891, 'recall': 0.3435519728399284, 'f1-score': 0.2858359733509668, 'support': 77367}, 'weighted avg': {'precision': 0.34961232916297685, 'recall': 0.34479816976230176, 'f1-score': 0.2869092936529566, 'support': 77367}}
[[13633   511 11434]
 [12953   525 12074]
 [13295   424 12518]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/EXC
Evaluating performance on  test set...
5098/5098 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0855781
{'0': {'precision': 0.41073863907300556, 'recall': 0.5585110866637992, 'f1-score': 0.47336012082765844, 'support': 462673}, '1': {'precision': 0.5037453183520599, 'recall': 0.06383619963406907, 'f1-score': 0.11331301562161036, 'support': 421391}, '2': {'precision': 0.37525647638007187, 'recall': 0.5549599256729945, 'f1-score': 0.447750234849792, 'support': 420843}, 'accuracy': 0.3976214396888054, 'macro avg': {'precision': 0.42991347793504575, 'recall': 0.3924357373236209, 'f1-score': 0.34480779043302023, 'support': 1304907}, 'weighted avg': {'precision': 0.4293298166771549, 'recall': 0.3976214396888054, 'f1-score': 0.34883143720923576, 'support': 1304907}}
[[258408  14002 190263]
 [195928  26900 198563]
 [174794  12498 233551]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0855721
{'0': {'precision': 0.39972907604200664, 'recall': 0.54196696469162, 'f1-score': 0.46010590396599554, 'support': 164975}, '1': {'precision': 0.4859326323987539, 'recall': 0.06456181650035246, 'f1-score': 0.11398005377602458, 'support': 154627}, '2': {'precision': 0.3824613741726064, 'recall': 0.561969577156093, 'f1-score': 0.4551558934402461, 'support': 160603}, 'accuracy': 0.39493133141054343, 'macro avg': {'precision': 0.42270769420445564, 'recall': 0.3894994527826885, 'f1-score': 0.34308061706075543, 'support': 480205}, 'weighted avg': {'precision': 0.42171167219457373, 'recall': 0.39493133141054343, 'f1-score': 0.34699715170853973, 'support': 480205}}
[[89411  5446 70118]
 [69034  9983 75610]
 [65234  5115 90254]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0852811
{'0': {'precision': 0.3877922704020141, 'recall': 0.5551125253996856, 'f1-score': 0.45660674865972883, 'support': 52166}, '1': {'precision': 0.5117753623188406, 'recall': 0.065114670969229, 'f1-score': 0.11553010939576731, 'support': 52062}, '2': {'precision': 0.3953992267171809, 'recall': 0.5628509160756501, 'f1-score': 0.4644942004907863, 'support': 54144}, 'accuracy': 0.39667996868133254, 'macro avg': {'precision': 0.43165561981267847, 'recall': 0.3943593708148549, 'f1-score': 0.3455436861820942, 'support': 158372}, 'weighted avg': {'precision': 0.4311501794648675, 'recall': 0.39667996868133254, 'f1-score': 0.3471803740390914, 'support': 158372}}
[[28958  1596 21612]
 [23685  3390 24987]
 [22031  1638 30475]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/AAL
Evaluating performance on  test set...
5760/5760 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0911258
{'0': {'precision': 0.39687266514379366, 'recall': 0.5643558512329659, 'f1-score': 0.46602323371049925, 'support': 525197}, '1': {'precision': 0.49524862783648727, 'recall': 0.02592843571609317, 'f1-score': 0.04927700433634378, 'support': 466322}, '2': {'precision': 0.36852815410277595, 'recall': 0.5366126373853913, 'f1-score': 0.43696376648482044, 'support': 482948}, 'accuracy': 0.38498318375385815, 'macro avg': {'precision': 0.4202164823610189, 'recall': 0.37563230811148346, 'f1-score': 0.31742133484388785, 'support': 1474467}, 'weighted avg': {'precision': 0.41870153669978294, 'recall': 0.38498318375385815, 'f1-score': 0.32470291473969687, 'support': 1474467}}
[[296398   6357 222442]
 [232610  12091 221621]
 [217826   5966 259156]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958312
{'0': {'precision': 0.36850330839072837, 'recall': 0.5886606071741222, 'f1-score': 0.4532627645808108, 'support': 185054}, '1': {'precision': 0.42173682348779623, 'recall': 0.026142680159191325, 'f1-score': 0.0492334692613431, 'support': 182422}, '2': {'precision': 0.3769227011049679, 'recall': 0.5002593725346101, 'f1-score': 0.4299201263118789, 'support': 185062}, 'accuracy': 0.373335408605381, 'macro avg': {'precision': 0.3890542776611641, 'recall': 0.3716875532893078, 'f1-score': 0.31080545338467763, 'support': 552538}, 'weighted avg': {'precision': 0.38889841957859217, 'recall': 0.373335408605381, 'f1-score': 0.31205316916096093, 'support': 552538}}
[[108934   3314  72806]
 [ 97420   4769  80233]
 [ 89258   3225  92579]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0881134
{'0': {'precision': 0.3945218256993462, 'recall': 0.5663447920690099, 'f1-score': 0.4650705461311963, 'support': 77670}, '1': {'precision': 0.43743405781810507, 'recall': 0.031970019431849725, 'f1-score': 0.059585231600580615, 'support': 64842}, '2': {'precision': 0.3812123549832359, 'recall': 0.5150668822578274, 'f1-score': 0.43814438849166204, 'support': 74833}, 'accuracy': 0.3892659136396052, 'macro avg': {'precision': 0.4043894128335624, 'recall': 0.37112723125289565, 'f1-score': 0.32093338874114635, 'support': 217345}, 'weighted avg': {'precision': 0.40274160224330113, 'recall': 0.3892659136396052, 'f1-score': 0.3348285625593016, 'support': 217345}}
[[43988  1369 32313]
 [32517  2073 30252]
 [34992  1297 38544]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/WBA
Evaluating performance on  test set...
6315/6315 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0806164
{'0': {'precision': 0.42429354340446257, 'recall': 0.5512014204110777, 'f1-score': 0.4794923858571811, 'support': 627424}, '1': {'precision': 0.3663516222740477, 'recall': 0.0435812134501145, 'f1-score': 0.0778959227304461, 'support': 410911}, '2': {'precision': 0.39439204642861414, 'recall': 0.5133462376081771, 'f1-score': 0.44607499041764054, 'support': 578103}, 'accuracy': 0.408621920543813, 'macro avg': {'precision': 0.39501240403570814, 'recall': 0.36937629048978976, 'f1-score': 0.3344877663350892, 'support': 1616438}, 'weighted avg': {'precision': 0.3988702869233301, 'recall': 0.408621920543813, 'f1-score': 0.36545206954708787, 'support': 1616438}}
[[345837  15686 265901]
 [203204  17908 189799]
 [266048  15288 296767]]
Evaluating performance on  train set...
2155/2155 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0965987
{'0': {'precision': 0.36185902296816813, 'recall': 0.5882362609367381, 'f1-score': 0.44807842384432084, 'support': 182527}, '1': {'precision': 0.38724016211269446, 'recall': 0.0325155057906581, 'f1-score': 0.0599935185935348, 'support': 182190}, '2': {'precision': 0.3792750743128152, 'recall': 0.4862705005780842, 'f1-score': 0.4261596052088416, 'support': 186824}, 'accuracy': 0.37012660890124216, 'macro avg': {'precision': 0.37612475313122595, 'recall': 0.3690074224351601, 'f1-score': 0.31141051588223245, 'support': 551541}, 'weighted avg': {'precision': 0.37614250527891857, 'recall': 0.37012660890124216, 'f1-score': 0.31245813403740624, 'support': 551541}}
[[107369   4658  70500]
 [ 98085   5924  78181]
 [ 91261   4716  90847]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0838085
{'0': {'precision': 0.409157230636444, 'recall': 0.5612244897959183, 'f1-score': 0.47327572887077024, 'support': 70952}, '1': {'precision': 0.37610151568558337, 'recall': 0.04130775633456572, 'f1-score': 0.07443969652044999, 'support': 51661}, '2': {'precision': 0.3964242168715886, 'recall': 0.5105518051071324, 'f1-score': 0.446307497899254, 'support': 68140}, 'accuracy': 0.40231608415070796, 'macro avg': {'precision': 0.39389432106453864, 'recall': 0.3710280170792055, 'f1-score': 0.3313409744301581, 'support': 190753}, 'weighted avg': {'precision': 0.39565642672765267, 'recall': 0.40231608415070796, 'f1-score': 0.3556268136471617, 'support': 190753}}
[[39820  1825 29307]
 [25866  2134 23661]
 [31636  1715 34789]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
6082/6082 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0808282
{'0': {'precision': 0.4159704797420002, 'recall': 0.5538323173443003, 'f1-score': 0.47510255782822103, 'support': 595971}, '1': {'precision': 0.32648625329771525, 'recall': 0.051598945836447314, 'f1-score': 0.08911402265326734, 'support': 381345}, '2': {'precision': 0.40584915268220106, 'recall': 0.49238460423411173, 'f1-score': 0.44494848447516855, 'support': 579484}, 'accuracy': 0.4079355087358684, 'macro avg': {'precision': 0.38276862857397215, 'recall': 0.36593862247161973, 'f1-score': 0.33638835498555225, 'support': 1556800}, 'weighted avg': {'precision': 0.39028348756361086, 'recall': 0.4079355087358684, 'f1-score': 0.3693287904918818, 'support': 1556800}}
[[330068  20756 245147]
 [189102  19677 172566]
 [274319  19836 285329]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019429
{'0': {'precision': 0.35054672054136, 'recall': 0.5865231606052715, 'f1-score': 0.43882270598676665, 'support': 207378}, '1': {'precision': 0.33845986038394416, 'recall': 0.0300393037619315, 'f1-score': 0.05518112140558036, 'support': 206596}, '2': {'precision': 0.3597201383880187, 'recall': 0.44283062138254886, 'f1-score': 0.3969720057376107, 'support': 210611}, 'accuracy': 0.3539998559043205, 'macro avg': {'precision': 0.34957557310444093, 'recall': 0.3531310285832507, 'f1-score': 0.2969919443766526, 'support': 624585}, 'weighted avg': {'precision': 0.3496420009996182, 'recall': 0.3539998559043205, 'f1-score': 0.29781221960251186, 'support': 624585}}
[[121632   6014  79732]
 [114116   6206  86274]
 [111230   6116  93265]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0914987
{'0': {'precision': 0.39164502016542485, 'recall': 0.5905354566068852, 'f1-score': 0.47095269409395424, 'support': 77616}, '1': {'precision': 0.3264265745765499, 'recall': 0.031863492624042894, 'f1-score': 0.058059609816022706, 'support': 62297}, '2': {'precision': 0.36939711293518257, 'recall': 0.456162181055575, 'f1-score': 0.40822020644354085, 'support': 71525}, 'accuracy': 0.380475600412414, 'macro avg': {'precision': 0.36248956922571907, 'recall': 0.3595203767621677, 'f1-score': 0.31241083678450593, 'support': 211438}, 'weighted avg': {'precision': 0.3649033981793428, 'recall': 0.380475600412414, 'f1-score': 0.32807893606342936, 'support': 211438}}
[[45835  2163 29618]
 [34232  1985 26080]
 [36965  1933 32627]]
testing model on single stock: results/universal/W3/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
13689/13689 - 112s - 112s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106559
{'0': {'precision': 0.3371963244451461, 'recall': 0.5918882066259655, 'f1-score': 0.42963265684041146, 'support': 1136740}, '1': {'precision': 0.36276570894650784, 'recall': 0.005014384470583677, 'f1-score': 0.00989203477817765, 'support': 1238836}, '2': {'precision': 0.33949334114506696, 'recall': 0.44871290532362984, 'f1-score': 0.3865359964494499, 'support': 1128666}, 'accuracy': 0.33829912431846887, 'macro avg': {'precision': 0.3464851248455736, 'recall': 0.3485384988067263, 'f1-score': 0.27535356268934635, 'support': 3504242}, 'weighted avg': {'precision': 0.3469755687635356, 'recall': 0.33829912431846887, 'f1-score': 0.26736317643069246, 'support': 3504242}}
[[672823   5623 458294]
 [705592   6212 527032]
 [616930   5289 506447]]
Evaluating performance on  train set...
5475/5475 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027107
{'0': {'precision': 0.3472706788547154, 'recall': 0.5821639731548187, 'f1-score': 0.4350353792493598, 'support': 470699}, '1': {'precision': 0.36890741076281935, 'recall': 0.004400240327467787, 'f1-score': 0.008696747903233729, 'support': 462702}, '2': {'precision': 0.352671562045383, 'recall': 0.45723293546705857, 'f1-score': 0.39820263763206526, 'support': 468164}, 'accuracy': 0.3496948054496224, 'macro avg': {'precision': 0.3562832172209726, 'recall': 0.34793238298311496, 'f1-score': 0.28064492159488624, 'support': 1401565}, 'weighted avg': {'precision': 0.35621771891737336, 'recall': 0.3496948054496224, 'f1-score': 0.2819839681142114, 'support': 1401565}}
[[274024   1818 194857]
 [262616   2036 198050]
 [252439   1665 214060]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043148
{'0': {'precision': 0.342648491080185, 'recall': 0.5860107716593927, 'f1-score': 0.4324421555296209, 'support': 172304}, '1': {'precision': 0.41146190803019905, 'recall': 0.006734403873265147, 'f1-score': 0.013251913459147304, 'support': 178041}, '2': {'precision': 0.35366535343281713, 'recall': 0.4628462407313119, 'f1-score': 0.4009561664114862, 'support': 170871}, 'accuracy': 0.3477598538801572, 'macro avg': {'precision': 0.3692585841810671, 'recall': 0.3518638054213233, 'f1-score': 0.2822167451334181, 'support': 521216}, 'weighted avg': {'precision': 0.36976598527501797, 'recall': 0.3477598538801572, 'f1-score': 0.27892980683910873, 'support': 521216}}
[[100972    887  70445]
 [102753   1199  74089]
 [ 90956    828  79087]]
training model: results/universal/W3/deepOF_L2/h1000
Epoch 1/50
10532/10532 - 236s - loss: 3.2707 - accuracy1000: 0.3768 - val_loss: 3.3227 - val_accuracy1000: 0.3396 - 236s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 235s - loss: 3.2634 - accuracy1000: 0.3811 - val_loss: 3.3327 - val_accuracy1000: 0.3397 - 235s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 233s - loss: 3.2614 - accuracy1000: 0.3829 - val_loss: 3.3281 - val_accuracy1000: 0.3398 - 233s/epoch - 22ms/step
Epoch 4/50
10532/10532 - 235s - loss: 3.2599 - accuracy1000: 0.3833 - val_loss: 3.3245 - val_accuracy1000: 0.3407 - 235s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 232s - loss: 3.2573 - accuracy1000: 0.3854 - val_loss: 3.3187 - val_accuracy1000: 0.3433 - 232s/epoch - 22ms/step
Epoch 6/50
10532/10532 - 230s - loss: 3.2567 - accuracy1000: 0.3864 - val_loss: 3.3140 - val_accuracy1000: 0.3427 - 230s/epoch - 22ms/step
Epoch 7/50
10532/10532 - 233s - loss: 3.2547 - accuracy1000: 0.3882 - val_loss: 3.3125 - val_accuracy1000: 0.3431 - 233s/epoch - 22ms/step
Epoch 8/50
10532/10532 - 234s - loss: 3.2536 - accuracy1000: 0.3895 - val_loss: 3.3245 - val_accuracy1000: 0.3424 - 234s/epoch - 22ms/step
Epoch 9/50
10532/10532 - 233s - loss: 3.2523 - accuracy1000: 0.3905 - val_loss: 3.3262 - val_accuracy1000: 0.3425 - 233s/epoch - 22ms/step
Epoch 10/50
10532/10532 - 234s - loss: 3.2517 - accuracy1000: 0.3915 - val_loss: 3.3249 - val_accuracy1000: 0.3437 - 234s/epoch - 22ms/step
Epoch 11/50
10532/10532 - 231s - loss: 3.2496 - accuracy1000: 0.3932 - val_loss: 3.3204 - val_accuracy1000: 0.3447 - 231s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 232s - loss: 3.2487 - accuracy1000: 0.3944 - val_loss: 3.3102 - val_accuracy1000: 0.3461 - 232s/epoch - 22ms/step
Epoch 13/50
10532/10532 - 230s - loss: 3.2493 - accuracy1000: 0.3941 - val_loss: 3.3133 - val_accuracy1000: 0.3456 - 230s/epoch - 22ms/step
Epoch 14/50
10532/10532 - 230s - loss: 3.2477 - accuracy1000: 0.3954 - val_loss: 3.3180 - val_accuracy1000: 0.3456 - 230s/epoch - 22ms/step
Epoch 15/50
10532/10532 - 231s - loss: 3.2458 - accuracy1000: 0.3970 - val_loss: 3.3193 - val_accuracy1000: 0.3454 - 231s/epoch - 22ms/step
Epoch 16/50
10532/10532 - 231s - loss: 3.2453 - accuracy1000: 0.3979 - val_loss: 3.3148 - val_accuracy1000: 0.3459 - 231s/epoch - 22ms/step
Epoch 17/50
10532/10532 - 230s - loss: 3.2433 - accuracy1000: 0.3993 - val_loss: 3.3228 - val_accuracy1000: 0.3451 - 230s/epoch - 22ms/step
Epoch 18/50
10532/10532 - 231s - loss: 3.2424 - accuracy1000: 0.3999 - val_loss: 3.3135 - val_accuracy1000: 0.3470 - 231s/epoch - 22ms/step
Epoch 19/50
10532/10532 - 233s - loss: 3.2404 - accuracy1000: 0.4009 - val_loss: 3.3177 - val_accuracy1000: 0.3466 - 233s/epoch - 22ms/step
Epoch 20/50
10532/10532 - 231s - loss: 3.2386 - accuracy1000: 0.4022 - val_loss: 3.3108 - val_accuracy1000: 0.3473 - 231s/epoch - 22ms/step
Epoch 21/50
10532/10532 - 230s - loss: 3.2382 - accuracy1000: 0.4030 - val_loss: 3.3095 - val_accuracy1000: 0.3463 - 230s/epoch - 22ms/step
Epoch 22/50
10532/10532 - 232s - loss: 3.2369 - accuracy1000: 0.4038 - val_loss: 3.3123 - val_accuracy1000: 0.3456 - 232s/epoch - 22ms/step
Epoch 23/50
10532/10532 - 229s - loss: 3.2356 - accuracy1000: 0.4046 - val_loss: 3.3151 - val_accuracy1000: 0.3442 - 229s/epoch - 22ms/step
Epoch 24/50
10532/10532 - 230s - loss: 3.2347 - accuracy1000: 0.4051 - val_loss: 3.3166 - val_accuracy1000: 0.3447 - 230s/epoch - 22ms/step
Epoch 25/50
10532/10532 - 229s - loss: 3.2335 - accuracy1000: 0.4058 - val_loss: 3.3236 - val_accuracy1000: 0.3435 - 229s/epoch - 22ms/step
Epoch 26/50
10532/10532 - 230s - loss: 3.2328 - accuracy1000: 0.4063 - val_loss: 3.3263 - val_accuracy1000: 0.3436 - 230s/epoch - 22ms/step
Epoch 27/50
10532/10532 - 231s - loss: 3.2320 - accuracy1000: 0.4070 - val_loss: 3.3340 - val_accuracy1000: 0.3430 - 231s/epoch - 22ms/step
Epoch 28/50
10532/10532 - 230s - loss: 3.2316 - accuracy1000: 0.4075 - val_loss: 3.3265 - val_accuracy1000: 0.3417 - 230s/epoch - 22ms/step
Epoch 29/50
10532/10532 - 230s - loss: 3.2296 - accuracy1000: 0.4083 - val_loss: 3.3355 - val_accuracy1000: 0.3422 - 230s/epoch - 22ms/step
Epoch 30/50
10532/10532 - 230s - loss: 3.2292 - accuracy1000: 0.4089 - val_loss: 3.3334 - val_accuracy1000: 0.3409 - 230s/epoch - 22ms/step
Epoch 31/50
10532/10532 - 230s - loss: 3.2285 - accuracy1000: 0.4093 - val_loss: 3.3465 - val_accuracy1000: 0.3426 - 230s/epoch - 22ms/step
testing model in sample: results/universal/W3/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 205s - 205s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1196928
{'0': {'precision': 0.3943081154313046, 'recall': 0.13746082731483328, 'f1-score': 0.20385515364711876, 'support': 2606408}, '1': {'precision': 0.2697182913810291, 'recall': 0.616760270189055, 'f1-score': 0.3753086278194043, 'support': 2016662}, '2': {'precision': 0.3435180733967797, 'recall': 0.21842852950023686, 'f1-score': 0.2670508096035734, 'support': 2463387}, 'accuracy': 0.30200564259403534, 'macro avg': {'precision': 0.33584816006970447, 'recall': 0.32421654233470837, 'f1-score': 0.2820715303566988, 'support': 7086457}, 'weighted avg': {'precision': 0.3411967943541882, 'recall': 0.30200564259403534, 'f1-score': 0.2746153464304564, 'support': 7086457}}
[[ 358279 1729375  518754]
 [ 263330 1243797  509535]
 [ 287018 1638295  538074]]
Evaluating performance on  train set...
10532/10532 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044525
{'0': {'precision': 0.36946879321255305, 'recall': 0.13929058587688248, 'f1-score': 0.20230988080026885, 'support': 905395}, '1': {'precision': 0.3361528244944929, 'recall': 0.6673058669101571, 'f1-score': 0.44708716738422977, 'support': 886003}, '2': {'precision': 0.3529234989649771, 'recall': 0.2324345840635556, 'f1-score': 0.28027844516560846, 'support': 904405}, 'accuracy': 0.3440766999665777, 'macro avg': {'precision': 0.3528483722240077, 'recall': 0.3463436789501984, 'f1-score': 0.3098918311167023, 'support': 2695803}, 'weighted avg': {'precision': 0.352968442453953, 'recall': 0.3440766999665777, 'f1-score': 0.3089158047865854, 'support': 2695803}}
[[126113 576663 202619]
 [111963 591235 182805]
 [103260 590930 210215]]
Evaluating performance on  val set...
3814/3814 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10374
{'0': {'precision': 0.3551082708273911, 'recall': 0.1431279031832093, 'f1-score': 0.20402333213749488, 'support': 321845}, '1': {'precision': 0.34460634926428096, 'recall': 0.6845717669164982, 'f1-score': 0.4584391636346349, 'support': 331023}, '2': {'precision': 0.34870706802811297, 'recall': 0.20355083816872363, 'f1-score': 0.25705242125472394, 'support': 322966}, 'accuracy': 0.3467946392521679, 'macro avg': {'precision': 0.34947389603992834, 'recall': 0.3437501694228104, 'f1-score': 0.3065049723422846, 'support': 975834}, 'weighted avg': {'precision': 0.3494272344576222, 'recall': 0.3467946392521679, 'f1-score': 0.3078771480380607, 'support': 975834}}
[[ 46065 212182  63598]
 [ 45227 226609  59187]
 [ 38429 218797  65740]]
testing model out of sample: results/universal/W3/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 121s - 121s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1138977
{'0': {'precision': 0.3527276658840974, 'recall': 0.14130339878079215, 'f1-score': 0.20177523883947307, 'support': 1454551}, '1': {'precision': 0.31303199464632253, 'recall': 0.6747652777349273, 'f1-score': 0.4276649201475432, 'support': 1328911}, '2': {'precision': 0.3325415642493768, 'recall': 0.16938818800855296, 'f1-score': 0.22444819320766543, 'support': 1352981}, 'accuracy': 0.3218743737070715, 'macro avg': {'precision': 0.3327670749265989, 'recall': 0.3284856215080908, 'f1-score': 0.28462945073156054, 'support': 4136443}, 'weighted avg': {'precision': 0.3333720441249897, 'recall': 0.3218743737070715, 'f1-score': 0.28176264800982065, 'support': 4136443}}
[[ 205533 1012643  236375]
 [ 208588  896703  223620]
 [ 168575  955227  229179]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030138
{'0': {'precision': 0.3482290186083746, 'recall': 0.16334800276656442, 'f1-score': 0.22238103870325762, 'support': 521947}, '1': {'precision': 0.34221775502461954, 'recall': 0.6688579225365571, 'f1-score': 0.45277531991079234, 'support': 523292}, '2': {'precision': 0.36621480111656096, 'recall': 0.2144425392328624, 'f1-score': 0.27049354722299607, 'support': 536540}, 'accuracy': 0.347914594896, 'macro avg': {'precision': 0.3522205249165184, 'recall': 0.3488828215119946, 'f1-score': 0.31521663527901533, 'support': 1581779}, 'weighted avg': {'precision': 0.3523411263071568, 'recall': 0.347914594896, 'f1-score': 0.3149210013167667, 'support': 1581779}}
[[ 85259 329065 107623]
 [ 81785 350008  91499]
 [ 77792 343691 115057]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111228
{'0': {'precision': 0.37698207959274926, 'recall': 0.16177121771217712, 'f1-score': 0.22639248938785206, 'support': 203250}, '1': {'precision': 0.30782798588946747, 'recall': 0.6735507287993476, 'f1-score': 0.4225438378423171, 'support': 174122}, '2': {'precision': 0.34953116095943637, 'recall': 0.18006020688109142, 'f1-score': 0.23768005664584724, 'support': 187354}, 'accuracy': 0.3256357950581344, 'macro avg': {'precision': 0.34478040881388433, 'recall': 0.3384607177975387, 'f1-score': 0.2955387946253388, 'support': 564726}, 'weighted avg': {'precision': 0.34655265273188485, 'recall': 0.3256357950581344, 'f1-score': 0.29061661926967575, 'support': 564726}}
[[ 32880 136805  33565]
 [ 27627 117280  29215]
 [ 26712 126907  33735]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088233
{'0': {'precision': 0.30323026429435135, 'recall': 0.15724318320255115, 'f1-score': 0.20709507686136638, 'support': 55818}, '1': {'precision': 0.4477034060816364, 'recall': 0.33251495462745684, 'f1-score': 0.38160618938650975, 'support': 73723}, '2': {'precision': 0.2487066274194987, 'recall': 0.5087235158619746, 'f1-score': 0.33408469689594494, 'support': 43847}, 'accuracy': 0.32065079474934827, 'macro avg': {'precision': 0.33321343259849545, 'recall': 0.33282721789732755, 'f1-score': 0.30759532104794035, 'support': 173388}, 'weighted avg': {'precision': 0.3508707903165233, 'recall': 0.32065079474934827, 'f1-score': 0.3134092198144387, 'support': 173388}}
[[ 8777 16582 30459]
 [12286 24514 36923]
 [ 7882 13659 22306]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048416
{'0': {'precision': 0.3271580989330747, 'recall': 0.15753584606043622, 'f1-score': 0.2126666876832382, 'support': 21411}, '1': {'precision': 0.3424285942237115, 'recall': 0.19333333333333333, 'f1-score': 0.24713537168192548, 'support': 22200}, '2': {'precision': 0.34123680518823446, 'recall': 0.6531959852086635, 'f1-score': 0.44828471729180197, 'support': 22716}, 'accuracy': 0.33927359898683795, 'macro avg': {'precision': 0.33694116611500685, 'recall': 0.334688388200811, 'f1-score': 0.30269559221898856, 'support': 66327}, 'weighted avg': {'precision': 0.3370909601622023, 'recall': 0.33927359898683795, 'f1-score': 0.3048991713679969, 'support': 66327}}
[[ 3373  3804 14234]
 [ 3497  4292 14411]
 [ 3440  4438 14838]]
Evaluating performance on  val set...
86/86 - 1s - 875ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125133
{'0': {'precision': 0.36172279792746115, 'recall': 0.14921186214266632, 'f1-score': 0.21127293361074337, 'support': 7486}, '1': {'precision': 0.39441811479726174, 'recall': 0.17852460970086997, 'f1-score': 0.24579538928542125, 'support': 8391}, '2': {'precision': 0.28043593833067515, 'recall': 0.6967145451543668, 'f1-score': 0.39990523572613124, 'support': 6057}, 'accuracy': 0.3116166681863773, 'macro avg': {'precision': 0.345525617018466, 'recall': 0.3414836723326344, 'f1-score': 0.2856578528740986, 'support': 21934}, 'weighted avg': {'precision': 0.35178352079044845, 'recall': 0.3116166681863773, 'f1-score': 0.2765699054115606, 'support': 21934}}
[[1117 1254 5115]
 [1180 1498 5713]
 [ 791 1046 4220]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1278006
{'0': {'precision': 0.4229358272191795, 'recall': 0.11366618758982691, 'f1-score': 0.17917749746901251, 'support': 144027}, '1': {'precision': 0.2422171705023224, 'recall': 0.7955645565112889, 'f1-score': 0.37136787209507677, 'support': 89867}, '2': {'precision': 0.3871778933092224, 'recall': 0.1012225300092336, 'f1-score': 0.16048768204629701, 'support': 135375}, 'accuracy': 0.2750542287600638, 'macro avg': {'precision': 0.3507769636769081, 'recall': 0.3368177580367831, 'f1-score': 0.2370110172034621, 'support': 369269}, 'weighted avg': {'precision': 0.3658463509126544, 'recall': 0.2750542287600638, 'f1-score': 0.21909809365680624, 'support': 369269}}
[[ 16371 114140  13516]
 [ 10199  71495   8173]
 [ 12138 109534  13703]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967647
{'0': {'precision': 0.38802035436208693, 'recall': 0.2266184474362647, 'f1-score': 0.28612762494631433, 'support': 55856}, '1': {'precision': 0.35364941532736194, 'recall': 0.7140857521732724, 'f1-score': 0.4730311718416397, 'support': 54296}, '2': {'precision': 0.37693647447062056, 'recall': 0.15251659804903378, 'f1-score': 0.21716398204383416, 'support': 53922}, 'accuracy': 0.3635798481173129, 'macro avg': {'precision': 0.3728687480533565, 'recall': 0.36440693255285694, 'f1-score': 0.32544092627726273, 'support': 164074}, 'weighted avg': {'precision': 0.3730035358695953, 'recall': 0.3635798481173129, 'f1-score': 0.3253139520282472, 'support': 164074}}
[[12658 35297  7901]
 [ 9831 38772  5693]
 [10133 35565  8224]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0953666
{'0': {'precision': 0.343757292882147, 'recall': 0.20565923581700563, 'f1-score': 0.25735251295789413, 'support': 21487}, '1': {'precision': 0.36847153707618824, 'recall': 0.7426711382915763, 'f1-score': 0.49256172395294984, 'support': 25345}, '2': {'precision': 0.39543910722950026, 'recall': 0.10498067840274795, 'f1-score': 0.16591456587385064, 'support': 23290}, 'accuracy': 0.36631870169133796, 'macro avg': {'precision': 0.3692226457292785, 'recall': 0.3511036841704433, 'f1-score': 0.30527626759489823, 'support': 70122}, 'weighted avg': {'precision': 0.3698554072435148, 'recall': 0.36631870169133796, 'f1-score': 0.31199709903761685, 'support': 70122}}
[[ 4419 15202  1866]
 [ 4650 18823  1872]
 [ 3786 17059  2445]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0914865
{'0': {'precision': 0.2766096400937034, 'recall': 0.20447508999506733, 'f1-score': 0.23513438491895872, 'support': 95283}, '1': {'precision': 0.48435345402784574, 'recall': 0.534653343808308, 'f1-score': 0.508261955329428, 'support': 162928}, '2': {'precision': 0.29916729905449474, 'recall': 0.3256423994820619, 'f1-score': 0.3118439337252806, 'support': 89586}, 'accuracy': 0.3903598938461229, 'macro avg': {'precision': 0.35337679772534797, 'recall': 0.35492361109514575, 'f1-score': 0.3517467579912224, 'support': 347797}, 'weighted avg': {'precision': 0.3797391511369942, 'recall': 0.3903598938461229, 'f1-score': 0.38284189944956154, 'support': 347797}}
[[19483 47870 27930]
 [35407 87110 40411]
 [15545 44868 29173]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000807
{'0': {'precision': 0.33681722035585415, 'recall': 0.1464391009169349, 'f1-score': 0.20412857008200586, 'support': 36971}, '1': {'precision': 0.3543666254870284, 'recall': 0.4936588207259922, 'f1-score': 0.4125730217737653, 'support': 37769}, '2': {'precision': 0.36236887235795895, 'recall': 0.4188117792421746, 'f1-score': 0.38855123168591105, 'support': 38848}, 'accuracy': 0.35504630770856077, 'macro avg': {'precision': 0.3511842394002805, 'recall': 0.35296990029503394, 'f1-score': 0.33508427451389405, 'support': 113588}, 'weighted avg': {'precision': 0.3513914188572547, 'recall': 0.35504630770856077, 'f1-score': 0.33651218502314906, 'support': 113588}}
[[ 5414 16426 15131]
 [ 5626 18645 13498]
 [ 5034 17544 16270]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011275
{'0': {'precision': 0.34331628926223523, 'recall': 0.15117401093599228, 'f1-score': 0.2099151406878071, 'support': 12436}, '1': {'precision': 0.361046447178805, 'recall': 0.5292922726903388, 'f1-score': 0.4292727931727569, 'support': 12307}, '2': {'precision': 0.35416031697653155, 'recall': 0.3906210605933272, 'f1-score': 0.3714982216360948, 'support': 11899}, 'accuracy': 0.3559303531466623, 'macro avg': {'precision': 0.35284101780585725, 'recall': 0.3570291147398861, 'f1-score': 0.33689538516555295, 'support': 36642}, 'weighted avg': {'precision': 0.35279279543688824, 'recall': 0.3559303531466623, 'f1-score': 0.3360630504453518, 'support': 36642}}
[[1880 5872 4684]
 [2001 6514 3792]
 [1595 5656 4648]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099062
{'0': {'precision': 0.289936150805716, 'recall': 0.05784442179841801, 'f1-score': 0.09644695720773112, 'support': 82428}, '1': {'precision': 0.3899761492469043, 'recall': 0.10358413607567474, 'f1-score': 0.16368959866151936, 'support': 115230}, '2': {'precision': 0.3225488552396452, 'recall': 0.839647445791597, 'f1-score': 0.46606123630691415, 'support': 93943}, 'accuracy': 0.32778694174574163, 'macro avg': {'precision': 0.3341537184307552, 'recall': 0.33369200122189663, 'f1-score': 0.2420659307253882, 'support': 291601}, 'weighted avg': {'precision': 0.3399748828848747, 'recall': 0.32778694174574163, 'f1-score': 0.24209475607033645, 'support': 291601}}
[[ 4768  8978 68682]
 [ 6306 11936 96988]
 [ 5371  9693 78879]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032104
{'0': {'precision': 0.34471425963118496, 'recall': 0.059978397611029924, 'f1-score': 0.10217832498985252, 'support': 31478}, '1': {'precision': 0.33676975945017185, 'recall': 0.12403148634048464, 'f1-score': 0.18129314623471549, 'support': 32395}, '2': {'precision': 0.3537094185902975, 'recall': 0.8294688088001158, 'f1-score': 0.49593699969711397, 'support': 34545}, 'accuracy': 0.3511552764738158, 'macro avg': {'precision': 0.3450644792238848, 'recall': 0.33782623091721015, 'f1-score': 0.2598028236405607, 'support': 98418}, 'weighted avg': {'precision': 0.34525659622488347, 'recall': 0.3511552764738158, 'f1-score': 0.2664299664780933, 'support': 98418}}
[[ 1888  3741 25849]
 [ 1870  4018 26507]
 [ 1719  4172 28654]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1148667
{'0': {'precision': 0.3032128514056225, 'recall': 0.051939117722934046, 'f1-score': 0.0886865868878937, 'support': 11629}, '1': {'precision': 0.4017357222844345, 'recall': 0.10954198473282442, 'f1-score': 0.17214491362763915, 'support': 13100}, '2': {'precision': 0.30311671754956887, 'recall': 0.8489945498966359, 'f1-score': 0.4467353951890034, 'support': 10642}, 'accuracy': 0.31308133781911734, 'macro avg': {'precision': 0.3360217637465419, 'recall': 0.33682521745079813, 'f1-score': 0.23585563190151207, 'support': 35371}, 'weighted avg': {'precision': 0.339672848352735, 'recall': 0.31308133781911734, 'f1-score': 0.22732161270653256, 'support': 35371}}
[[  604  1160  9865]
 [  758  1435 10907]
 [  630   977  9035]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016206
{'0': {'precision': 0.3703888288986719, 'recall': 0.19400373195657009, 'f1-score': 0.25463416800703015, 'support': 206862}, '1': {'precision': 0.35451738616250367, 'recall': 0.45664686698087165, 'f1-score': 0.399152830154957, 'support': 195626}, '2': {'precision': 0.3429119459174275, 'recall': 0.42255499909092414, 'f1-score': 0.37859023943568115, 'support': 181503}, 'accuracy': 0.3530174266384242, 'macro avg': {'precision': 0.3559393869928677, 'recall': 0.35773519934278863, 'f1-score': 0.34412574586588945, 'support': 583991}, 'weighted avg': {'precision': 0.3565324448988321, 'recall': 0.3530174266384242, 'f1-score': 0.341570450644716, 'support': 583991}}
[[40132 87913 78817]
 [38148 89332 68146]
 [30071 74737 76695]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990154
{'0': {'precision': 0.32924470818873025, 'recall': 0.1692427110427192, 'f1-score': 0.2235653894585357, 'support': 73433}, '1': {'precision': 0.36285747488299863, 'recall': 0.4630972926329414, 'f1-score': 0.4068947134606842, 'support': 74168}, '2': {'precision': 0.3669384970271939, 'recall': 0.4392273787918071, 'f1-score': 0.3998418664479546, 'support': 77140}, 'accuracy': 0.3588886762984947, 'macro avg': {'precision': 0.35301356003297424, 'recall': 0.3571891274891559, 'f1-score': 0.34343398978905815, 'support': 224741}, 'weighted avg': {'precision': 0.35327543934672806, 'recall': 0.3588886762984947, 'f1-score': 0.34457195585076106, 'support': 224741}}
[[12428 29074 31931]
 [13297 34347 26524]
 [12022 31236 33882]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999017
{'0': {'precision': 0.3534802378454005, 'recall': 0.19601986189774226, 'f1-score': 0.2521897536994984, 'support': 25778}, '1': {'precision': 0.3448729184925504, 'recall': 0.4738299751143935, 'f1-score': 0.39919518463411335, 'support': 24914}, '2': {'precision': 0.36439914014284724, 'recall': 0.39400187441424556, 'f1-score': 0.37862276419835367, 'support': 26675}, 'accuracy': 0.3537425517339434, 'macro avg': {'precision': 0.3542507654935994, 'recall': 0.35461723714212706, 'f1-score': 0.34333590084398846, 'support': 77367}, 'weighted avg': {'precision': 0.3544731542623158, 'recall': 0.3537425517339434, 'f1-score': 0.34312120847171346, 'support': 77367}}
[[ 5053 10882  9843]
 [ 4620 11805  8489]
 [ 4622 11543 10510]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
5098/5098 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1277183
{'0': {'precision': 0.4441107224365943, 'recall': 0.16501154248130806, 'f1-score': 0.2406196573741321, 'support': 522418}, '1': {'precision': 0.24117064371528674, 'recall': 0.7766523924781232, 'f1-score': 0.3680517158217945, 'support': 322260}, '2': {'precision': 0.3671314304497891, 'recall': 0.05824274437291001, 'f1-score': 0.10053615532189011, 'support': 460229}, 'accuracy': 0.2784060473275107, 'macro avg': {'precision': 0.35080426553389005, 'recall': 0.3333022264441138, 'f1-score': 0.23640250950593888, 'support': 1304907}, 'weighted avg': {'precision': 0.366842708439793, 'recall': 0.2784060473275107, 'f1-score': 0.22268409958291974, 'support': 1304907}}
[[ 86205 410641  25572]
 [ 51341 250284  20635]
 [ 56561 376863  26805]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062456
{'0': {'precision': 0.3963670302422444, 'recall': 0.1701122762545885, 'f1-score': 0.23805599595068877, 'support': 167266}, '1': {'precision': 0.31654193860539476, 'recall': 0.7914516203262348, 'f1-score': 0.45221856786246245, 'support': 152099}, '2': {'precision': 0.37256435784383446, 'recall': 0.06514548619746331, 'f1-score': 0.11089943057936962, 'support': 160840}, 'accuracy': 0.3317562291104841, 'macro avg': {'precision': 0.3618244422304912, 'recall': 0.34223646092609555, 'f1-score': 0.26705799813084025, 'support': 480205}, 'weighted avg': {'precision': 0.36311094494235485, 'recall': 0.3317562291104841, 'f1-score': 0.2632994878986816, 'support': 480205}}
[[ 28454 129537   9275]
 [ 23349 120379   8371]
 [ 19984 130378  10478]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0928837
{'0': {'precision': 0.36685410400592827, 'recall': 0.17082428400349117, 'f1-score': 0.23310436516729446, 'support': 49267}, '1': {'precision': 0.3682103970591664, 'recall': 0.8142928346767956, 'f1-score': 0.5071125049503891, 'support': 58183}, '2': {'precision': 0.36449704142011835, 'recall': 0.048387730254114136, 'f1-score': 0.08543393086231407, 'support': 50922}, 'accuracy': 0.367855428989973, 'macro avg': {'precision': 0.36652051416173764, 'recall': 0.3445016163114669, 'f1-score': 0.2752169336599992, 'support': 158372}, 'weighted avg': {'precision': 0.36659450545139805, 'recall': 0.367855428989973, 'f1-score': 0.2862889037304343, 'support': 158372}}
[[ 8416 38920  1931]
 [ 8440 47378  2365]
 [ 6085 42373  2464]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
5760/5760 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1408156
{'0': {'precision': 0.3948452075992971, 'recall': 0.07661042710626936, 'f1-score': 0.12832282729609126, 'support': 589502}, '1': {'precision': 0.23111517628239042, 'recall': 0.8490815953375738, 'f1-score': 0.3633331402949544, 'support': 347287}, '2': {'precision': 0.3726323789618687, 'recall': 0.05836020815432285, 'f1-score': 0.1009154396216676, 'support': 537678}, 'accuracy': 0.25189848263813297, 'macro avg': {'precision': 0.33286425428118543, 'recall': 0.3280174101993887, 'f1-score': 0.19752380240423775, 'support': 1474467}, 'weighted avg': {'precision': 0.3481811176860811, 'recall': 0.25189848263813297, 'f1-score': 0.17368137189588728, 'support': 1474467}}
[[ 45162 512938  31402]
 [ 30984 294875  21428]
 [ 38233 468066  31379]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050036
{'0': {'precision': 0.3629436458465844, 'recall': 0.15424079750455463, 'f1-score': 0.21648260346678708, 'support': 184977}, '1': {'precision': 0.33662733925350674, 'recall': 0.8005857731440499, 'f1-score': 0.4739640366782533, 'support': 183006}, '2': {'precision': 0.3717209831235624, 'recall': 0.07793340738533229, 'f1-score': 0.12885221816096898, 'support': 184555}, 'accuracy': 0.3428289095048666, 'macro avg': {'precision': 0.3570973227412178, 'recall': 0.3442533260113123, 'f1-score': 0.2730996194353365, 'support': 552538}, 'weighted avg': {'precision': 0.3571591739673289, 'recall': 0.3428289095048666, 'f1-score': 0.27249326953171354, 'support': 552538}}
[[ 28531 143315  13131]
 [ 25315 146512  11179]
 [ 24764 145408  14383]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1256201
{'0': {'precision': 0.4112105213240176, 'recall': 0.15439675229096433, 'f1-score': 0.22450053937432576, 'support': 84244}, '1': {'precision': 0.24964029199480847, 'recall': 0.7749439410788835, 'f1-score': 0.3776307022609159, 'support': 54853}, '2': {'precision': 0.39042560082917666, 'recall': 0.07702433289029752, 'f1-score': 0.1286652078774617, 'support': 78248}, 'accuracy': 0.2831535116979917, 'macro avg': {'precision': 0.35042547138266755, 'recall': 0.3354550087533818, 'f1-score': 0.24359881650423446, 'support': 217345}, 'weighted avg': {'precision': 0.3629508868798141, 'recall': 0.2831535116979917, 'f1-score': 0.22864476080040644, 'support': 217345}}
[[13007 65706  5531]
 [ 8466 42508  3879]
 [10158 62063  6027]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
6315/6315 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1434177
{'0': {'precision': 0.453825507966026, 'recall': 0.13444123692159204, 'f1-score': 0.20743264230983585, 'support': 687966}, '1': {'precision': 0.18452435728066904, 'recall': 0.7812722878199541, 'f1-score': 0.29853855364377446, 'support': 302856}, '2': {'precision': 0.3993279580203914, 'recall': 0.08320119690033503, 'f1-score': 0.13771007917033196, 'support': 625616}, 'accuracy': 0.235799950261006, 'macro avg': {'precision': 0.34589260775569547, 'recall': 0.33297157388062704, 'f1-score': 0.2145604250413141, 'support': 1616438}, 'weighted avg': {'precision': 0.3822768259264101, 'recall': 0.235799950261006, 'f1-score': 0.1975172733454014, 'support': 1616438}}
[[ 92491 543356  52119]
 [ 40065 236613  26178]
 [ 71247 502317  52052]]
Evaluating performance on  train set...
2155/2155 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011201
{'0': {'precision': 0.37558523057158033, 'recall': 0.16739986235375087, 'f1-score': 0.2315824751690939, 'support': 181625}, '1': {'precision': 0.33974655902593964, 'recall': 0.7904839933576008, 'f1-score': 0.47523793467085845, 'support': 181862}, '2': {'precision': 0.39625742824630167, 'recall': 0.09999255532985206, 'f1-score': 0.15968884284185675, 'support': 188054}, 'accuracy': 0.3498688220821299, 'macro avg': {'precision': 0.37052973928127386, 'recall': 0.35262547034706787, 'f1-score': 0.288836417560603, 'support': 551541}, 'weighted avg': {'precision': 0.3708164046400335, 'recall': 0.3498688220821299, 'f1-score': 0.2874111153649155, 'support': 551541}}
[[ 30404 135238  15983]
 [ 25436 143759  12667]
 [ 25111 144139  18804]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1121687
{'0': {'precision': 0.3980297877330832, 'recall': 0.1495307887741765, 'f1-score': 0.21739223263659077, 'support': 68093}, '1': {'precision': 0.30426042624099875, 'recall': 0.8100309837335399, 'f1-score': 0.4423625097941192, 'support': 56804}, '2': {'precision': 0.39345908341103064, 'recall': 0.08330296404275996, 'f1-score': 0.13749545733655807, 'support': 65856}, 'accuracy': 0.3233553338610664, 'macro avg': {'precision': 0.36524976579503754, 'recall': 0.3476215788501588, 'f1-score': 0.26575006658908934, 'support': 190753}, 'weighted avg': {'precision': 0.36852837431348057, 'recall': 0.3233553338610664, 'f1-score': 0.25680199075047255, 'support': 190753}}
[[10182 52978  4933]
 [ 7267 46013  3524]
 [ 8132 52238  5486]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
6082/6082 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984716
{'0': {'precision': 0.35350720732444824, 'recall': 0.1821347858154238, 'f1-score': 0.24040669071826828, 'support': 507086}, '1': {'precision': 0.3639498094125952, 'recall': 0.7301687275984032, 'f1-score': 0.4857696131800473, 'support': 549347}, '2': {'precision': 0.3599491259907248, 'recall': 0.13913987133444053, 'f1-score': 0.20069877455007742, 'support': 500367}, 'accuracy': 0.36170028263103804, 'macro avg': {'precision': 0.35913538090925606, 'recall': 0.3504811282494225, 'f1-score': 0.30895835948279765, 'support': 1556800}, 'weighted avg': {'precision': 0.3592625616709322, 'recall': 0.36170028263103804, 'f1-score': 0.3142253279717894, 'support': 1556800}}
[[ 92358 347254  67474]
 [ 91907 401116  56324]
 [ 76997 353749  69621]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033654
{'0': {'precision': 0.3440094085362866, 'recall': 0.17109502571226634, 'f1-score': 0.22852957453042094, 'support': 205155}, '1': {'precision': 0.3417822189786486, 'recall': 0.7087883036056445, 'f1-score': 0.4611803472203591, 'support': 206149}, '2': {'precision': 0.37597592541930597, 'recall': 0.16753484839249627, 'f1-score': 0.23178591004771032, 'support': 213281}, 'accuracy': 0.3473490397624022, 'macro avg': {'precision': 0.3539225176447471, 'recall': 0.34913939257013565, 'f1-score': 0.30716527726616344, 'support': 624585}, 'weighted avg': {'precision': 0.35419011698623293, 'recall': 0.3473490397624022, 'f1-score': 0.30642968201734594, 'support': 624585}}
[[ 35101 136547  33507]
 [ 34234 146116  25799]
 [ 32700 144849  35732]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017935
{'0': {'precision': 0.3658385669647001, 'recall': 0.16131012468283634, 'f1-score': 0.22389684650995467, 'support': 73306}, '1': {'precision': 0.3555315962089714, 'recall': 0.7476410931751225, 'f1-score': 0.48190103653921046, 'support': 73657}, '2': {'precision': 0.3409156586715105, 'recall': 0.12808065141527725, 'f1-score': 0.18620487496899593, 'support': 64475}, 'accuracy': 0.3554327982671043, 'macro avg': {'precision': 0.354095273948394, 'recall': 0.34567728975774537, 'f1-score': 0.29733425267272034, 'support': 211438}, 'weighted avg': {'precision': 0.354648123160095, 'recall': 0.3554327982671043, 'f1-score': 0.3022821167068047, 'support': 211438}}
[[11825 53001  8480]
 [11103 55069  7485]
 [ 9395 46822  8258]]
testing model on single stock: results/universal/W3/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
13689/13689 - 103s - 103s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056582
{'0': {'precision': 0.3477953023444436, 'recall': 0.13565595531345306, 'f1-score': 0.19518205091299176, 'support': 1169569}, '1': {'precision': 0.3426158911922134, 'recall': 0.5675069050587088, 'f1-score': 0.4272761540209083, 'support': 1186449}, '2': {'precision': 0.3380936989185745, 'recall': 0.3188384844768965, 'f1-score': 0.32818389873127235, 'support': 1148224}, 'accuracy': 0.3418927688213314, 'macro avg': {'precision': 0.34283496415174386, 'recall': 0.3406671149496861, 'f1-score': 0.3168807012217241, 'support': 3504242}, 'weighted avg': {'precision': 0.34286278881535015, 'recall': 0.3418927688213314, 'f1-score': 0.31734362829479984, 'support': 3504242}}
[[158659 651868 359042]
 [155441 673318 357690]
 [142085 640041 366098]]
Evaluating performance on  train set...
5475/5475 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1061229
{'0': {'precision': 0.35064728458647365, 'recall': 0.11275017584244516, 'f1-score': 0.17063340381368028, 'support': 469170}, '1': {'precision': 0.3412821645075669, 'recall': 0.6111838160872116, 'f1-score': 0.4379917811573369, 'support': 465351}, '2': {'precision': 0.3464675605992351, 'recall': 0.3095896746345098, 'f1-score': 0.3269921390901607, 'support': 467044}, 'accuracy': 0.34383421389660845, 'macro avg': {'precision': 0.34613233656442527, 'recall': 0.3445078888547222, 'f1-score': 0.31187244135372594, 'support': 1401565}, 'weighted avg': {'precision': 0.346145043874316, 'recall': 0.34383421389660845, 'f1-score': 0.3115058552616805, 'support': 1401565}}
[[ 52899 272767 143504]
 [ 51700 284415 129236]
 [ 46262 276190 144592]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044254
{'0': {'precision': 0.33904973570398844, 'recall': 0.13175078339723054, 'f1-score': 0.18976218792155017, 'support': 171369}, '1': {'precision': 0.3500359195402299, 'recall': 0.6365300043358053, 'f1-score': 0.45168469737381006, 'support': 177591}, '2': {'precision': 0.3511467193195626, 'recall': 0.2684318688463682, 'f1-score': 0.30426800379027164, 'support': 172256}, 'accuracy': 0.348912926694499, 'macro avg': {'precision': 0.34674412485459366, 'recall': 0.34557088552646803, 'f1-score': 0.3152382963618773, 'support': 521216}, 'weighted avg': {'precision': 0.3467909128423462, 'recall': 0.348912926694499, 'f1-score': 0.31684845195492356, 'support': 521216}}
[[ 22578 103800  44991]
 [ 24099 113042  40450]
 [ 19915 106102  46239]]
training model: results/universal/W3/deepVOL_L2/h300
Epoch 1/50
10532/10532 - 340s - loss: 3.2705 - accuracy300: 0.3777 - val_loss: 3.2934 - val_accuracy300: 0.3527 - 340s/epoch - 32ms/step
Epoch 2/50
10532/10532 - 337s - loss: 3.2611 - accuracy300: 0.3832 - val_loss: 3.3080 - val_accuracy300: 0.3553 - 337s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 337s - loss: 3.2541 - accuracy300: 0.3875 - val_loss: 3.3529 - val_accuracy300: 0.3537 - 337s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 339s - loss: 3.2500 - accuracy300: 0.3905 - val_loss: 3.3813 - val_accuracy300: 0.3548 - 339s/epoch - 32ms/step
Epoch 5/50
10532/10532 - 338s - loss: 3.2455 - accuracy300: 0.3931 - val_loss: 3.3849 - val_accuracy300: 0.3537 - 338s/epoch - 32ms/step
Epoch 6/50
10532/10532 - 339s - loss: 3.2435 - accuracy300: 0.3949 - val_loss: 3.3906 - val_accuracy300: 0.3540 - 339s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 340s - loss: 3.2411 - accuracy300: 0.3964 - val_loss: 3.3827 - val_accuracy300: 0.3540 - 340s/epoch - 32ms/step
Epoch 8/50
10532/10532 - 341s - loss: 3.2393 - accuracy300: 0.3974 - val_loss: 3.3915 - val_accuracy300: 0.3542 - 341s/epoch - 32ms/step
Epoch 9/50
10532/10532 - 341s - loss: 3.2381 - accuracy300: 0.3983 - val_loss: 3.3841 - val_accuracy300: 0.3548 - 341s/epoch - 32ms/step
Epoch 10/50
10532/10532 - 340s - loss: 3.2364 - accuracy300: 0.3994 - val_loss: 3.3881 - val_accuracy300: 0.3552 - 340s/epoch - 32ms/step
Epoch 11/50
10532/10532 - 338s - loss: 3.2349 - accuracy300: 0.4002 - val_loss: 3.3851 - val_accuracy300: 0.3554 - 338s/epoch - 32ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 420s - 420s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974555
{'0': {'precision': 0.3829733915214562, 'recall': 0.279420611743136, 'f1-score': 0.3231027419115194, 'support': 2373676}, '1': {'precision': 0.3419586817845701, 'recall': 0.6555191822400018, 'f1-score': 0.4494545363420083, 'support': 2407748}, '2': {'precision': 0.381129241760026, 'recall': 0.12220326387289143, 'f1-score': 0.18506747241332755, 'support': 2305053}, 'accuracy': 0.35606747894616747, 'macro avg': {'precision': 0.36868710502201746, 'recall': 0.3523810192853431, 'f1-score': 0.3192082502222851, 'support': 7086477}, 'weighted avg': {'precision': 0.3684381085762633, 'recall': 0.35606747894616747, 'f1-score': 0.3211334514268124, 'support': 7086477}}
[[ 663254 1497494  212928]
 [ 584956 1578325  244467]
 [ 483644 1539724  281685]]
Evaluating performance on  train set...
10532/10532 - 162s - 162s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009456
{'0': {'precision': 0.3745006993701787, 'recall': 0.26613630997954624, 'f1-score': 0.3111535323764902, 'support': 906434}, '1': {'precision': 0.32676003947926435, 'recall': 0.6742976761668414, 'f1-score': 0.4402014625956805, 'support': 883282}, '2': {'precision': 0.38474542214145935, 'recall': 0.09720756832639511, 'f1-score': 0.1552025514968899, 'support': 906092}, 'accuracy': 0.34309157031954796, 'macro avg': {'precision': 0.36200205366363414, 'recall': 0.3458805181575943, 'f1-score': 0.3021858488230202, 'support': 2695808}, 'weighted avg': {'precision': 0.36230183201594157, 'recall': 0.34309157031954796, 'f1-score': 0.30101919704278246, 'support': 2695808}}
[[241235 599927  65272]
 [212110 595595  75577]
 [190806 627207  88079]]
Evaluating performance on  val set...
3814/3814 - 59s - 59s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981609
{'0': {'precision': 0.36941015657360615, 'recall': 0.2775735694610872, 'f1-score': 0.31697395662102484, 'support': 321295}, '1': {'precision': 0.34171640866115105, 'recall': 0.6703416768972628, 'f1-score': 0.4526751056562851, 'support': 333151}, '2': {'precision': 0.3925144665908304, 'recall': 0.09877438244619449, 'f1-score': 0.1578312803748773, 'support': 321389}, 'accuracy': 0.3527778774075535, 'macro avg': {'precision': 0.36788034394186253, 'recall': 0.3488965429348481, 'f1-score': 0.30916011421739575, 'support': 975835}, 'weighted avg': {'precision': 0.36756483567544546, 'recall': 0.3527778774075535, 'f1-score': 0.31088918606675375, 'support': 975835}}
[[ 89183 209674  22438]
 [ 83133 223325  26693]
 [ 69104 220540  31745]]
testing model out of sample: results/universal/W3/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 254s - 254s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094994
{'0': {'precision': 0.37757508884125657, 'recall': 0.2749127580183895, 'f1-score': 0.318167486281829, 'support': 1365455}, '1': {'precision': 0.3503465278847531, 'recall': 0.6633997688328793, 'f1-score': 0.45853643335159827, 'support': 1463876}, '2': {'precision': 0.35805609333948973, 'recall': 0.10144729070973704, 'f1-score': 0.15810033985522323, 'support': 1307132}, 'accuracy': 0.3575811025023069, 'macro avg': {'precision': 0.36199257002183316, 'recall': 0.34658660585366863, 'f1-score': 0.3116014198295502, 'support': 4136463}, 'weighted avg': {'precision': 0.3617709729753639, 'recall': 0.3575811025023069, 'f1-score': 0.3172618438326649, 'support': 4136463}}
[[375381 887558 102516]
 [357515 971135 135226]
 [261293 913234 132605]]
Evaluating performance on  train set...
6181/6181 - 96s - 96s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014409
{'0': {'precision': 0.3675149371759951, 'recall': 0.2541730441288735, 'f1-score': 0.30051213198231674, 'support': 526594}, '1': {'precision': 0.325588118749694, 'recall': 0.6757890983267127, 'f1-score': 0.4394525807929537, 'support': 521608}, '2': {'precision': 0.3746480125678039, 'recall': 0.09475153911747894, 'f1-score': 0.15125057401803652, 'support': 533585}, 'accuracy': 0.3394268634146064, 'macro avg': {'precision': 0.35591702283116433, 'recall': 0.3415712271910217, 'f1-score': 0.29707176226443566, 'support': 1581787}, 'weighted avg': {'precision': 0.3560954085841128, 'recall': 0.3394268634146064, 'f1-score': 0.2959784755651431, 'support': 1581787}}
[[133846 353976  38772]
 [123493 352497  45618]
 [106853 376174  50558]]
Evaluating performance on  val set...
2209/2209 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983808
{'0': {'precision': 0.3807696312493492, 'recall': 0.26903209194049305, 'f1-score': 0.31529387130447634, 'support': 190297}, '1': {'precision': 0.3355433812147691, 'recall': 0.6628573814033825, 'f1-score': 0.44554735001604673, 'support': 191637}, '2': {'precision': 0.36130991527718676, 'recall': 0.10218718543481115, 'f1-score': 0.15931596230116424, 'support': 182792}, 'accuracy': 0.348669974465493, 'macro avg': {'precision': 0.3592076425804351, 'recall': 0.3446922195928956, 'f1-score': 0.3067190612072291, 'support': 564726}, 'weighted avg': {'precision': 0.3591235528328068, 'recall': 0.348669974465493, 'f1-score': 0.3090074101840671, 'support': 564726}}
[[ 51196 124405  14696]
 [ 46286 127028  18323]
 [ 36972 127141  18679]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0878804
{'0': {'precision': 0.3040439881903627, 'recall': 0.21353294780094353, 'f1-score': 0.25087442868796583, 'support': 52568}, '1': {'precision': 0.41787060669211135, 'recall': 0.7272801369304752, 'f1-score': 0.5307755223436686, 'support': 73614}, '2': {'precision': 0.19863505747126436, 'recall': 0.03514085998729083, 'f1-score': 0.059717072819552935, 'support': 47210}, 'accuracy': 0.3830741902740611, 'macro avg': {'precision': 0.3068498841179128, 'recall': 0.3253179815729032, 'f1-score': 0.2804556746170625, 'support': 173392}, 'weighted avg': {'precision': 0.3236693288931581, 'recall': 0.3830741902740611, 'f1-score': 0.31766009548818225, 'support': 173392}}
[[11225 39250  2093]
 [15476 53538  4600]
 [10218 35333  1659]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1090097
{'0': {'precision': 0.3239222586579221, 'recall': 0.18495684340320592, 'f1-score': 0.23546511627906977, 'support': 21897}, '1': {'precision': 0.32683474935441265, 'recall': 0.7532597337694789, 'f1-score': 0.45587022271102556, 'support': 22011}, '2': {'precision': 0.32515337423312884, 'recall': 0.0449132509700727, 'f1-score': 0.07892468061760326, 'support': 22421}, 'accuracy': 0.3262072396689231, 'macro avg': {'precision': 0.32530346074848787, 'recall': 0.3277099427142525, 'f1-score': 0.2567533398692329, 'support': 66329}, 'weighted avg': {'precision': 0.32530490689673414, 'recall': 0.3262072396689231, 'f1-score': 0.2556907142785578, 'support': 66329}}
[[ 4050 16845  1002]
 [ 4343 16580  1088]
 [ 4110 17304  1007]]
Evaluating performance on  val set...
86/86 - 1s - 763ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980822
{'0': {'precision': 0.3511494252873563, 'recall': 0.1667576419213974, 'f1-score': 0.22612879348630646, 'support': 7328}, '1': {'precision': 0.36908110642287856, 'recall': 0.779166151181492, 'f1-score': 0.5008947389350619, 'support': 8083}, '2': {'precision': 0.2992805755395683, 'recall': 0.06377433696152077, 'f1-score': 0.10514343485403764, 'support': 6523}, 'accuracy': 0.3618127108598523, 'macro avg': {'precision': 0.33983703574993446, 'recall': 0.3365660433548034, 'f1-score': 0.277388989091802, 'support': 21934}, 'weighted avg': {'precision': 0.34233212209202507, 'recall': 0.3618127108598523, 'f1-score': 0.29140396640068594, 'support': 21934}}
[[1222 5627  479]
 [1290 6298  495]
 [ 968 5139  416]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
1443/1443 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0872098
{'0': {'precision': 0.3947147336987714, 'recall': 0.3910359944623904, 'f1-score': 0.39286675249303527, 'support': 121352}, '1': {'precision': 0.3636258380961403, 'recall': 0.5114664297875491, 'f1-score': 0.42505782764899847, 'support': 135090}, '2': {'precision': 0.36674684101764965, 'recall': 0.19189761678971204, 'f1-score': 0.2519593411260902, 'support': 112831}, 'accuracy': 0.37424615392947763, 'macro avg': {'precision': 0.37502913760418705, 'recall': 0.36480001367988385, 'f1-score': 0.3566279737560413, 'support': 369273}, 'weighted avg': {'precision': 0.3747960171772194, 'recall': 0.37424615392947763, 'f1-score': 0.36158899379114073, 'support': 369273}}
[[47453 57345 16554]
 [45164 69094 20832]
 [27604 63575 21652]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099609
{'0': {'precision': 0.38135099337748346, 'recall': 0.3786162639828874, 'f1-score': 0.37997870824131835, 'support': 57034}, '1': {'precision': 0.3111728675136116, 'recall': 0.5296866250893012, 'f1-score': 0.3920372130245586, 'support': 51791}, '2': {'precision': 0.40844997407983413, 'recall': 0.14260633484162896, 'f1-score': 0.21140327341024956, 'support': 55250}, 'accuracy': 0.346829193966174, 'macro avg': {'precision': 0.3669912783236431, 'recall': 0.3503030746379392, 'f1-score': 0.3278063982253755, 'support': 164075}, 'weighted avg': {'precision': 0.3683241664214517, 'recall': 0.346829193966174, 'f1-score': 0.32701956910867924, 'support': 164075}}
[[21594 29888  5552]
 [18499 27433  5859]
 [16532 30839  7879]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095144
{'0': {'precision': 0.3756513337244211, 'recall': 0.4774980261426441, 'f1-score': 0.4204955868435792, 'support': 22798}, '1': {'precision': 0.33642155806580687, 'recall': 0.477563682439813, 'f1-score': 0.3947558509101416, 'support': 22887}, '2': {'precision': 0.4305523457360758, 'recall': 0.15247370790195197, 'f1-score': 0.22519718352422108, 'support': 24437}, 'accuracy': 0.3642508770428681, 'macro avg': {'precision': 0.38087507917543456, 'recall': 0.3691784721614697, 'f1-score': 0.34681620709264727, 'support': 70122}, 'weighted avg': {'precision': 0.3819797920546185, 'recall': 0.3642508770428681, 'f1-score': 0.3440343846784422, 'support': 70122}}
[[10886  9623  2289]
 [ 9318 10930  2639]
 [ 8775 11936  3726]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092177
{'0': {'precision': 0.30207788975986066, 'recall': 0.23801494088351208, 'f1-score': 0.2662470116026583, 'support': 102002}, '1': {'precision': 0.4055963965495262, 'recall': 0.6482017222176948, 'f1-score': 0.49897276923639894, 'support': 147252}, '2': {'precision': 0.27625307622815487, 'recall': 0.08998751864592529, 'f1-score': 0.13575408731859653, 'support': 98547}, 'accuracy': 0.3697372923022073, 'macro avg': {'precision': 0.3279757875125139, 'recall': 0.3254013939157107, 'f1-score': 0.30032462271921795, 'support': 347801}, 'weighted avg': {'precision': 0.33858827720176804, 'recall': 0.3697372923022073, 'f1-score': 0.32780418669319034, 'support': 347801}}
[[24278 69614  8110]
 [36680 95449 15123]
 [19412 70267  8868]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106717
{'0': {'precision': 0.3381373151254548, 'recall': 0.1918395796472039, 'f1-score': 0.24479603181390577, 'support': 37302}, '1': {'precision': 0.3191716174779609, 'recall': 0.7171461635761768, 'f1-score': 0.4417423017945211, 'support': 37157}, '2': {'precision': 0.33877825016782276, 'recall': 0.07738308203424482, 'f1-score': 0.12598818340684032, 'support': 39130}, 'accuracy': 0.3242479465441196, 'macro avg': {'precision': 0.3320290609237462, 'recall': 0.3287896084192085, 'f1-score': 0.2708421723384224, 'support': 113589}, 'weighted avg': {'precision': 0.33215408929126244, 'recall': 0.3242479465441196, 'f1-score': 0.26829286201314384, 'support': 113589}}
[[ 7156 27427  2719]
 [ 7319 26647  3191]
 [ 6688 29414  3028]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1083155
{'0': {'precision': 0.36326291079812206, 'recall': 0.19295511221945136, 'f1-score': 0.2520358306188925, 'support': 12832}, '1': {'precision': 0.29901832705012876, 'recall': 0.7030276437033787, 'f1-score': 0.419577855758655, 'support': 11395}, '2': {'precision': 0.3275123558484349, 'recall': 0.08006443817962143, 'f1-score': 0.12867313915857606, 'support': 12415}, 'accuracy': 0.3133289667594564, 'macro avg': {'precision': 0.32993119789889525, 'recall': 0.32534906470081715, 'f1-score': 0.2667622751787078, 'support': 36642}, 'weighted avg': {'precision': 0.3311710443195251, 'recall': 0.3133289667594564, 'f1-score': 0.26234076926819566, 'support': 36642}}
[[2476 9491  865]
 [2208 8011 1176]
 [2132 9289  994]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029246
{'0': {'precision': 0.3081945026262366, 'recall': 0.542754346937849, 'f1-score': 0.39314679393109797, 'support': 88108}, '1': {'precision': 0.393441894234616, 'recall': 0.4798113497348235, 'f1-score': 0.4323554195042722, 'support': 110681}, '2': {'precision': 0.3392612859097127, 'recall': 0.005343906223064989, 'f1-score': 0.01052207301809542, 'support': 92816}, 'accuracy': 0.3478095368735104, 'macro avg': {'precision': 0.34696589425685503, 'recall': 0.3426365342985791, 'f1-score': 0.2786747621511552, 'support': 291605}, 'weighted avg': {'precision': 0.35043918672920527, 'recall': 0.3478095368735104, 'f1-score': 0.28624174700393024, 'support': 291605}}
[[47821 39850   437]
 [57046 53106   529]
 [50298 42022   496]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080817
{'0': {'precision': 0.3369936378994285, 'recall': 0.5767054192040352, 'f1-score': 0.4254049639275829, 'support': 32514}, '1': {'precision': 0.34682985839322567, 'recall': 0.4489958852791255, 'f1-score': 0.39135496821679494, 'support': 32566}, '2': {'precision': 0.3478964401294498, 'recall': 0.0064489036863733164, 'f1-score': 0.012663073887563683, 'support': 33339}, 'accuracy': 0.34127556670968007, 'macro avg': {'precision': 0.34390664547403466, 'recall': 0.34405006938984467, 'f1-score': 0.2764743353439805, 'support': 98419}, 'weighted avg': {'precision': 0.3439416345275966, 'recall': 0.34127556670968007, 'f1-score': 0.2743236276778575, 'support': 98419}}
[[18751 13561   202]
 [17743 14622   201]
 [19148 13976   215]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097771
{'0': {'precision': 0.32367800606264735, 'recall': 0.5166666666666667, 'f1-score': 0.398012010768275, 'support': 11160}, '1': {'precision': 0.4087966709050977, 'recall': 0.5167299824663939, 'f1-score': 0.4564698289770894, 'support': 13688}, '2': {'precision': 0.2627450980392157, 'recall': 0.0063670056067661315, 'f1-score': 0.012432733345704213, 'support': 10523}, 'accuracy': 0.3648751802323938, 'macro avg': {'precision': 0.33173992500232025, 'recall': 0.3465878849132756, 'f1-score': 0.2889715243636895, 'support': 35371}, 'weighted avg': {'precision': 0.3384897810543888, 'recall': 0.3648751802323938, 'f1-score': 0.30592300789373195, 'support': 35371}}
[[5766 5312   82]
 [6509 7073  106]
 [5539 4917   67]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015886
{'0': {'precision': 0.355937892070291, 'recall': 0.2291722406305954, 'f1-score': 0.2788230102067964, 'support': 194356}, '1': {'precision': 0.33616107382550336, 'recall': 0.6806006433346674, 'f1-score': 0.45003945221054903, 'support': 202383}, '2': {'precision': 0.3205180418669056, 'recall': 0.08405605160849318, 'f1-score': 0.13318441048552232, 'support': 187256}, 'accuracy': 0.33908338256320686, 'macro avg': {'precision': 0.33753900258756664, 'recall': 0.33127631185791867, 'f1-score': 0.28734895763428925, 'support': 583995}, 'weighted avg': {'precision': 0.33772699766790737, 'recall': 0.33908338256320686, 'f1-score': 0.29145941214968735, 'support': 583995}}
[[ 44541 135180  14635]
 [ 45908 137742  18733]
 [ 34688 136828  15740]]
Evaluating performance on  train set...
878/878 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051016
{'0': {'precision': 0.34211313977850943, 'recall': 0.21531506075162476, 'f1-score': 0.264292733684028, 'support': 74319}, '1': {'precision': 0.3213005632360471, 'recall': 0.7103677848007439, 'f1-score': 0.44247081883543965, 'support': 74201}, '2': {'precision': 0.3407343536681756, 'recall': 0.062212193170040536, 'f1-score': 0.10521411138229421, 'support': 76223}, 'accuracy': 0.3268355410402104, 'macro avg': {'precision': 0.334716018894244, 'recall': 0.32929834624080306, 'f1-score': 0.2706592213005873, 'support': 224743}, 'weighted avg': {'precision': 0.33477404932534643, 'recall': 0.3268355410402104, 'f1-score': 0.26916737836090265, 'support': 224743}}
[[16002 54107  4210]
 [16526 52710  4965]
 [14246 57235  4742]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047956
{'0': {'precision': 0.3519959829274416, 'recall': 0.2178033245300606, 'f1-score': 0.26909788867562384, 'support': 25748}, '1': {'precision': 0.32439063994082307, 'recall': 0.6941816918265704, 'f1-score': 0.44216014164863277, 'support': 25901}, '2': {'precision': 0.31158455392809586, 'recall': 0.07278948596313865, 'f1-score': 0.1180104646031646, 'support': 25718}, 'accuracy': 0.3290808742745615, 'macro avg': {'precision': 0.32932372559878687, 'recall': 0.3282581674399232, 'f1-score': 0.2764228316424737, 'support': 77367}, 'weighted avg': {'precision': 0.32932084857168814, 'recall': 0.3290808742745615, 'f1-score': 0.27681201798086247, 'support': 77367}}
[[ 5608 18337  1803]
 [ 5588 17980  2333]
 [ 4736 19110  1872]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
5098/5098 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899167
{'0': {'precision': 0.4268297752698359, 'recall': 0.4185195832761225, 'f1-score': 0.4226338326748986, 'support': 466112}, '1': {'precision': 0.3019850215544362, 'recall': 0.41677066250517913, 'f1-score': 0.35021217999701876, 'support': 403061}, '2': {'precision': 0.4221283366711476, 'recall': 0.2825000344243559, 'f1-score': 0.33847989815026136, 'support': 435738}, 'accuracy': 0.3725595078898101, 'macro avg': {'precision': 0.3836477111651399, 'recall': 0.3725967600685525, 'f1-score': 0.3704419702740596, 'support': 1304911}, 'weighted avg': {'precision': 0.3866978070900918, 'recall': 0.3725595078898101, 'f1-score': 0.3721634091196559, 'support': 1304911}}
[[195077 191842  79193]
 [145758 167984  89319]
 [116202 196440 123096]]
Evaluating performance on  train set...
1876/1876 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0895358
{'0': {'precision': 0.40930059952268527, 'recall': 0.3941563562872776, 'f1-score': 0.40158575208655717, 'support': 162296}, '1': {'precision': 0.32325370915085494, 'recall': 0.5079619047619047, 'f1-score': 0.39508538355934375, 'support': 157500}, '2': {'precision': 0.4233970164878304, 'recall': 0.20170686548927444, 'f1-score': 0.2732412564233567, 'support': 160411}, 'accuracy': 0.36719581347210684, 'macro avg': {'precision': 0.3853171083871236, 'recall': 0.36794170884615224, 'f1-score': 0.3566374640230858, 'support': 480207}, 'weighted avg': {'precision': 0.38578747936457136, 'recall': 0.36719581347210684, 'f1-score': 0.3565808335058914, 'support': 480207}}
[[63970 79873 18453]
 [51885 80004 25611]
 [40436 87619 32356]]
Evaluating performance on  val set...
619/619 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0833665
{'0': {'precision': 0.4005858349841689, 'recall': 0.4642023269958993, 'f1-score': 0.43005416802995605, 'support': 50967}, '1': {'precision': 0.35789403885683974, 'recall': 0.4872530964503665, 'f1-score': 0.41267365491509356, 'support': 55386}, '2': {'precision': 0.44925960010039323, 'recall': 0.20646302312616543, 'f1-score': 0.2829107672044781, 'support': 52019}, 'accuracy': 0.3876063950698356, 'macro avg': {'precision': 0.40257982464713393, 'recall': 0.38597281552414375, 'f1-score': 0.37521286338317594, 'support': 158372}, 'weighted avg': {'precision': 0.401643046910978, 'recall': 0.3876063950698356, 'f1-score': 0.37564499426868314, 'support': 158372}}
[[23659 22032  5276]
 [20509 26987  7890]
 [14893 26386 10740]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
5760/5760 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0869929
{'0': {'precision': 0.38313552108946475, 'recall': 0.343220042825464, 'f1-score': 0.3620810426439685, 'support': 472149}, '1': {'precision': 0.3854425997834099, 'recall': 0.6236775621871998, 'f1-score': 0.47643860474767713, 'support': 563259}, '2': {'precision': 0.36241720908987096, 'recall': 0.11565310672955817, 'f1-score': 0.1753494194328139, 'support': 439063}, 'accuracy': 0.3825928078612601, 'macro avg': {'precision': 0.3769984433209152, 'recall': 0.36085023724740733, 'f1-score': 0.3379563556081531, 'support': 1474471}, 'weighted avg': {'precision': 0.37784741343363104, 'recall': 0.3825928078612601, 'f1-score': 0.3501621777704061, 'support': 1474471}}
[[162051 274260  35838]
 [158472 351292  53495]
 [102437 285847  50779]]
Evaluating performance on  train set...
2159/2159 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968648
{'0': {'precision': 0.3878449950762516, 'recall': 0.31513559102114963, 'f1-score': 0.3477301199069379, 'support': 184968}, '1': {'precision': 0.33178743677214445, 'recall': 0.6195211685245181, 'f1-score': 0.4321401896006894, 'support': 182110}, '2': {'precision': 0.3961772790843474, 'recall': 0.13288508096041757, 'f1-score': 0.1990164252143999, 'support': 185461}, 'accuracy': 0.35428449394522377, 'macro avg': {'precision': 0.3719365703109145, 'recall': 0.3558472801686951, 'f1-score': 0.32629557824067573, 'support': 552539}, 'weighted avg': {'precision': 0.3721658697686525, 'recall': 0.35428449394522377, 'f1-score': 0.32563453436556666, 'support': 552539}}
[[ 58290 109499  17179]
 [ 48906 112821  20383]
 [ 43096 117720  24645]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940958
{'0': {'precision': 0.39001367758058797, 'recall': 0.32173004596740495, 'f1-score': 0.35259634687163677, 'support': 71790}, '1': {'precision': 0.3477819949741624, 'recall': 0.618108566581849, 'f1-score': 0.4451167429364916, 'support': 75456}, '2': {'precision': 0.379314652121414, 'recall': 0.12995905790382173, 'f1-score': 0.19359088784053718, 'support': 70099}, 'accuracy': 0.3627734707492696, 'macro avg': {'precision': 0.37237010822538813, 'recall': 0.3565992234843585, 'f1-score': 0.3304346592162219, 'support': 217345}, 'weighted avg': {'precision': 0.3719013454431425, 'recall': 0.3627734707492696, 'f1-score': 0.3334337037597576, 'support': 217345}}
[[23097 42298  6395]
 [20304 46640  8512]
 [15820 45169  9110]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
6315/6315 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961857
{'0': {'precision': 0.40846887328940157, 'recall': 0.33682417099253964, 'f1-score': 0.36920293481207545, 'support': 564048}, '1': {'precision': 0.3251021729454133, 'recall': 0.6158294832413208, 'f1-score': 0.4255516367192388, 'support': 521849}, '2': {'precision': 0.38863808067220695, 'recall': 0.11926038319086976, 'f1-score': 0.18251335540966204, 'support': 530545}, 'accuracy': 0.3554894020323649, 'macro avg': {'precision': 0.37406970896900726, 'recall': 0.35730467914157676, 'f1-score': 0.3257559756469921, 'support': 1616442}, 'weighted avg': {'precision': 0.37504611077958094, 'recall': 0.3554894020323649, 'f1-score': 0.32611960168753273, 'support': 1616442}}
[[189985 328179  45884]
 [146829 321370  53650]
 [128301 338971  63273]]
Evaluating performance on  train set...
2155/2155 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967343
{'0': {'precision': 0.38579632092917626, 'recall': 0.3251486101465047, 'f1-score': 0.3528856654479844, 'support': 182861}, '1': {'precision': 0.3313937825048025, 'recall': 0.6241768060626786, 'f1-score': 0.4329315179592727, 'support': 181306}, '2': {'precision': 0.40015731702956847, 'recall': 0.11946161153628572, 'f1-score': 0.18399421319129347, 'support': 187374}, 'accuracy': 0.3535693629304077, 'macro avg': {'precision': 0.37244914015451575, 'recall': 0.356262342581823, 'f1-score': 0.3232704655328502, 'support': 551541}, 'weighted avg': {'precision': 0.37279161348538764, 'recall': 0.3535693629304077, 'f1-score': 0.3218216581670505, 'support': 551541}}
[[ 59457 107881  15523]
 [ 50108 113167  18031]
 [ 44550 120440  22384]]
Evaluating performance on  val set...
746/746 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980664
{'0': {'precision': 0.39254864828305863, 'recall': 0.3126529481476921, 'f1-score': 0.3480749130412433, 'support': 64973}, '1': {'precision': 0.32640460307713015, 'recall': 0.629810579623107, 'f1-score': 0.42997240783218643, 'support': 61609}, '2': {'precision': 0.393879173290938, 'recall': 0.12354297824596397, 'f1-score': 0.18809015421115066, 'support': 64172}, 'accuracy': 0.3514683833628653, 'macro avg': {'precision': 0.3709441415503756, 'recall': 0.3553355020055877, 'f1-score': 0.32204582502819346, 'support': 190754}, 'weighted avg': {'precision': 0.3716333016571089, 'recall': 0.3514683833628653, 'f1-score': 0.32070500631808424, 'support': 190754}}
[[20314 38732  5927]
 [16534 38802  6273]
 [14901 41343  7928]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
6082/6082 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015291
{'0': {'precision': 0.4057305495944422, 'recall': 0.24588890113523643, 'f1-score': 0.3062052211150457, 'support': 544380}, '1': {'precision': 0.30649253800049714, 'recall': 0.6973718389167267, 'f1-score': 0.42583295065422144, 'support': 477368}, '2': {'precision': 0.39683622564277493, 'recall': 0.10436664573427828, 'f1-score': 0.16526827016132614, 'support': 535056}, 'accuracy': 0.33568901415977864, 'macro avg': {'precision': 0.36968643774590476, 'recall': 0.3492091285954138, 'f1-score': 0.2991021473101978, 'support': 1556804}, 'weighted avg': {'precision': 0.3722439883350533, 'recall': 0.33568901415977864, 'f1-score': 0.29444862796983534, 'support': 1556804}}
[[133857 369012  41511]
 [101100 332903  43365]
 [ 94959 384255  55842]]
Evaluating performance on  train set...
2440/2440 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10254
{'0': {'precision': 0.3608347815664889, 'recall': 0.23146635400849558, 'f1-score': 0.28202245875341037, 'support': 208108}, '1': {'precision': 0.3236030512390602, 'recall': 0.6985043346642151, 'f1-score': 0.44229821077222947, 'support': 206129}, '2': {'precision': 0.362458565331369, 'recall': 0.07953410981697172, 'f1-score': 0.13044478318330494, 'support': 210350}, 'accuracy': 0.33443219279299763, 'macro avg': {'precision': 0.3489654660456394, 'recall': 0.3365015994965608, 'f1-score': 0.28492181756964824, 'support': 624587}, 'weighted avg': {'precision': 0.3490942611494453, 'recall': 0.33443219279299763, 'f1-score': 0.2838686650172543, 'support': 624587}}
[[ 48170 146433  13505]
 [ 46225 143982  15922]
 [ 39101 154519  16730]]
Evaluating performance on  val set...
826/826 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989573
{'0': {'precision': 0.3858403094745891, 'recall': 0.25965922395625285, 'f1-score': 0.3104169411144776, 'support': 72599}, '1': {'precision': 0.332077343271039, 'recall': 0.6808847207705997, 'f1-score': 0.44642617364207565, 'support': 70802}, '2': {'precision': 0.36576680068925904, 'recall': 0.09359613151667474, 'f1-score': 0.14905145879902162, 'support': 68037}, 'accuracy': 0.3472743783047513, 'macro avg': {'precision': 0.36122815114496243, 'recall': 0.3447133587478424, 'f1-score': 0.3019648578518583, 'support': 211438}, 'weighted avg': {'precision': 0.3613779760701336, 'recall': 0.3472743783047513, 'f1-score': 0.30403635844306715, 'support': 211438}}
[[18851 48466  5282]
 [16834 48208  5760]
 [13172 48497  6368]]
testing model on single stock: results/universal/W3/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
13689/13689 - 129s - 129s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101446
{'0': {'precision': 0.34222390094222316, 'recall': 0.16138621020478708, 'f1-score': 0.21933721024295103, 'support': 1134056}, '1': {'precision': 0.3520298544102162, 'recall': 0.7813077222171475, 'f1-score': 0.48536931868114214, 'support': 1237067}, '2': {'precision': 0.3267010935601458, 'recall': 0.06454197823184243, 'f1-score': 0.10778943520865097, 'support': 1133123}, 'accuracy': 0.348915287339987, 'macro avg': {'precision': 0.34031828297086175, 'recall': 0.335745303551259, 'f1-score': 0.270831988044248, 'support': 3504246}, 'weighted avg': {'precision': 0.3406661824971106, 'recall': 0.348915287339987, 'f1-score': 0.27718194854018147, 'support': 3504246}}
[[183021 880336  70699]
 [190514 966530  80023]
 [161264 898725  73134]]
Evaluating performance on  train set...
5475/5475 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062284
{'0': {'precision': 0.34736500817313537, 'recall': 0.16352397245028397, 'f1-score': 0.22236731728831735, 'support': 471729}, '1': {'precision': 0.32635424882820646, 'recall': 0.7823454367239779, 'f1-score': 0.4605787494186341, 'support': 460119}, '2': {'precision': 0.33459280662073293, 'recall': 0.054483754082236574, 'f1-score': 0.09370840618449118, 'support': 469718}, 'accuracy': 0.3301328656659765, 'macro avg': {'precision': 0.3361040212073583, 'recall': 0.33345105441883277, 'f1-score': 0.25888482429714754, 'support': 1401566}, 'weighted avg': {'precision': 0.33618695266392584, 'recall': 0.3301328656659765, 'f1-score': 0.25745107326877226, 'support': 1401566}}
[[ 77139 369466  25124]
 [ 74376 359972  25771]
 [ 70554 373572  25592]]
Evaluating performance on  val set...
2036/2036 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033355
{'0': {'precision': 0.3392367173858818, 'recall': 0.16663068781833987, 'f1-score': 0.2234864194439445, 'support': 171397}, '1': {'precision': 0.3407102343509548, 'recall': 0.7767080036306736, 'f1-score': 0.47364962722869025, 'support': 179581}, '2': {'precision': 0.32856987807966426, 'recall': 0.05334884103431666, 'f1-score': 0.09179346974666336, 'support': 170238}, 'accuracy': 0.33982840127701375, 'macro avg': {'precision': 0.33617227660550025, 'recall': 0.3322291774944434, 'f1-score': 0.26297650547309936, 'support': 521216}, 'weighted avg': {'precision': 0.33626043549947177, 'recall': 0.33982840127701375, 'f1-score': 0.2666650913316584, 'support': 521216}}
[[ 28560 134032   8805]
 [ 30345 139482   9754]
 [ 25284 135872   9082]]
training model: results/universal/W3/deepVOL_L2/h500
Epoch 1/50
10532/10532 - 338s - loss: 3.2672 - accuracy500: 0.3794 - val_loss: 3.3047 - val_accuracy500: 0.3541 - 338s/epoch - 32ms/step
Epoch 2/50
10532/10532 - 336s - loss: 3.2588 - accuracy500: 0.3848 - val_loss: 3.3054 - val_accuracy500: 0.3517 - 336s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 336s - loss: 3.2518 - accuracy500: 0.3898 - val_loss: 3.3096 - val_accuracy500: 0.3550 - 336s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 338s - loss: 3.2464 - accuracy500: 0.3939 - val_loss: 3.3214 - val_accuracy500: 0.3514 - 338s/epoch - 32ms/step
Epoch 5/50
10532/10532 - 339s - loss: 3.2440 - accuracy500: 0.3956 - val_loss: 3.3221 - val_accuracy500: 0.3525 - 339s/epoch - 32ms/step
Epoch 6/50
10532/10532 - 339s - loss: 3.2429 - accuracy500: 0.3964 - val_loss: 3.3097 - val_accuracy500: 0.3551 - 339s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 339s - loss: 3.2394 - accuracy500: 0.3989 - val_loss: 3.3083 - val_accuracy500: 0.3521 - 339s/epoch - 32ms/step
Epoch 8/50
10532/10532 - 345s - loss: 3.2379 - accuracy500: 0.3996 - val_loss: 3.3068 - val_accuracy500: 0.3523 - 345s/epoch - 33ms/step
Epoch 9/50
10532/10532 - 342s - loss: 3.2347 - accuracy500: 0.4018 - val_loss: 3.3115 - val_accuracy500: 0.3531 - 342s/epoch - 32ms/step
Epoch 10/50
10532/10532 - 341s - loss: 3.2325 - accuracy500: 0.4026 - val_loss: 3.3131 - val_accuracy500: 0.3532 - 341s/epoch - 32ms/step
Epoch 11/50
10532/10532 - 344s - loss: 3.2314 - accuracy500: 0.4032 - val_loss: 3.3157 - val_accuracy500: 0.3556 - 344s/epoch - 33ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 428s - 428s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999901
{'0': {'precision': 0.35712484727507265, 'recall': 0.6668109477964763, 'f1-score': 0.46513611310272257, 'support': 2451233}, '1': {'precision': 0.3362785542762145, 'recall': 0.009545169150831237, 'f1-score': 0.01856342098543503, 'support': 2288697}, '2': {'precision': 0.3547417899525373, 'recall': 0.369573675703065, 'f1-score': 0.36200587576734367, 'support': 2346547}, 'accuracy': 0.35611164757890273, 'macro avg': {'precision': 0.3493817305012748, 'recall': 0.34864326421679087, 'f1-score': 0.28190180328516706, 'support': 7086477}, 'weighted avg': {'precision': 0.34960308374452975, 'recall': 0.35611164757890273, 'f1-score': 0.28675840443882916, 'support': 7086477}}
[[1634509   21500  795224]
 [1484640   21846  782211]
 [1457707   21618  867222]]
Evaluating performance on  train set...
10532/10532 - 165s - 165s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020437
{'0': {'precision': 0.3460648180669221, 'recall': 0.6804540979422168, 'f1-score': 0.45879568303087837, 'support': 905003}, '1': {'precision': 0.32872389791183293, 'recall': 0.007979121823528949, 'f1-score': 0.015580068333247193, 'support': 887817}, '2': {'precision': 0.3546058550378024, 'recall': 0.3513845145228951, 'f1-score': 0.3529878355053725, 'support': 902988}, 'accuracy': 0.34876111355111344, 'macro avg': {'precision': 0.34313152367218586, 'recall': 0.34660591142954694, 'f1-score': 0.2757878622898327, 'support': 2695808}, 'weighted avg': {'precision': 0.3432147969166512, 'recall': 0.34876111355111344, 'f1-score': 0.27738900495314867, 'support': 2695808}}
[[615813   7269 281921]
 [585165   7084 295568]
 [578495   7197 317296]]
Evaluating performance on  val set...
3814/3814 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011193
{'0': {'precision': 0.34975592511526804, 'recall': 0.7033026201956526, 'f1-score': 0.4671805943892595, 'support': 330586}, '1': {'precision': 0.3349542665277295, 'recall': 0.009164692018196334, 'f1-score': 0.017841229706603356, 'support': 315668}, '2': {'precision': 0.3639462642547521, 'recall': 0.3339785970671853, 'f1-score': 0.34831905117527184, 'support': 329581}, 'accuracy': 0.35402296494796764, 'macro avg': {'precision': 0.3495521519659166, 'recall': 0.3488153030936781, 'f1-score': 0.2777802917570449, 'support': 975835}, 'weighted avg': {'precision': 0.3497604916669076, 'recall': 0.35402296494796764, 'f1-score': 0.28168144254017236, 'support': 975835}}
[[232502   2830  95254]
 [215659   2893  97116]
 [216594   2914 110073]]
testing model out of sample: results/universal/W3/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 249s - 249s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966477
{'0': {'precision': 0.367011109570568, 'recall': 0.6648001916613692, 'f1-score': 0.47293348249443123, 'support': 1469258}, '1': {'precision': 0.3417398431097061, 'recall': 0.01143299430230454, 'f1-score': 0.022125765434138935, 'support': 1276481}, '2': {'precision': 0.36754123791591353, 'recall': 0.37854455664819187, 'f1-score': 0.3729617584746888, 'support': 1390724}, 'accuracy': 0.3669337789314204, 'macro avg': {'precision': 0.3587640635320626, 'recall': 0.3515925808706218, 'f1-score': 0.289340335467753, 'support': 4136463}, 'weighted avg': {'precision': 0.35939082401010847, 'recall': 0.3669337789314204, 'f1-score': 0.3002060674549467, 'support': 4136463}}
[[976763  14456 478039]
 [834018  14594 427869]
 [850618  13655 526451]]
Evaluating performance on  train set...
6181/6181 - 98s - 98s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029345
{'0': {'precision': 0.3430664652120165, 'recall': 0.6603027882384267, 'f1-score': 0.4515341540546498, 'support': 525780}, '1': {'precision': 0.318719076415613, 'recall': 0.00887287002335872, 'f1-score': 0.017265094394055863, 'support': 522717}, '2': {'precision': 0.35055883528856646, 'recall': 0.36500215642520956, 'f1-score': 0.3576347294387407, 'support': 533290}, 'accuracy': 0.3454725573038595, 'macro avg': {'precision': 0.337448125638732, 'recall': 0.3447259382289983, 'f1-score': 0.2754779926291488, 'support': 1581787}, 'weighted avg': {'precision': 0.3375466398554, 'recall': 0.3454725573038595, 'f1-score': 0.2763680639223976, 'support': 1581787}}
[[347174   5030 173576]
 [331045   4638 187034]
 [333754   4884 194652]]
Evaluating performance on  val set...
2209/2209 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979269
{'0': {'precision': 0.36891293654697493, 'recall': 0.6645427846084923, 'f1-score': 0.4744439942853488, 'support': 200890}, '1': {'precision': 0.29517435716801693, 'recall': 0.009698063859088753, 'f1-score': 0.01877913230548584, 'support': 172818}, '2': {'precision': 0.3566240985119742, 'recall': 0.3681171407930143, 'f1-score': 0.3622794905613717, 'support': 191018}, 'accuracy': 0.363880890909928, 'macro avg': {'precision': 0.340237130742322, 'recall': 0.34745266308686507, 'f1-score': 0.28516753905073544, 'support': 564726}, 'weighted avg': {'precision': 0.342190697664964, 'recall': 0.363880890909928, 'f1-score': 0.29706145958713653, 'support': 564726}}
[[133500   1906  65484]
 [109769   1676  61373]
 [118605   2096  70317]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1163591
{'0': {'precision': 0.2871407957122243, 'recall': 0.684683444750295, 'f1-score': 0.4046010398814884, 'support': 50860}, '1': {'precision': 0.4502177504129749, 'recall': 0.038877506030033454, 'f1-score': 0.07157437360486076, 'support': 77114}, '2': {'precision': 0.267125698446918, 'recall': 0.2673609582104012, 'f1-score': 0.26724327655266517, 'support': 45418}, 'accuracy': 0.2881563163237058, 'macro avg': {'precision': 0.33482808152403915, 'recall': 0.33030730299690986, 'f1-score': 0.24780623001300475, 'support': 173392}, 'weighted avg': {'precision': 0.35442458387544984, 'recall': 0.2881563163237058, 'f1-score': 0.22051219357875035, 'support': 173392}}
[[34823  2098 13939]
 [54740  2998 19376]
 [31712  1563 12143]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1079092
{'0': {'precision': 0.3224969899046031, 'recall': 0.6369997713240338, 'f1-score': 0.42820469463360644, 'support': 21865}, '1': {'precision': 0.328761429758936, 'recall': 0.03608905922073182, 'f1-score': 0.06503864495971058, 'support': 21918}, '2': {'precision': 0.3319508078128768, 'recall': 0.3052869688636565, 'f1-score': 0.3180610429518726, 'support': 22546}, 'accuracy': 0.3256795670068899, 'macro avg': {'precision': 0.3277364091588053, 'recall': 0.32612526646947404, 'f1-score': 0.27043479418172983, 'support': 66329}, 'weighted avg': {'precision': 0.3277804974395759, 'recall': 0.3256795670068899, 'f1-score': 0.27075965177801053, 'support': 66329}}
[[13928   839  7098]
 [14373   791  6754]
 [14887   776  6883]]
Evaluating performance on  val set...
86/86 - 1s - 806ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1141956
{'0': {'precision': 0.33184817067946193, 'recall': 0.5410729253981559, 'f1-score': 0.4113866907430028, 'support': 7158}, '1': {'precision': 0.37694704049844235, 'recall': 0.02774911134044261, 'f1-score': 0.0516928334935384, 'support': 8721}, '2': {'precision': 0.268994906974327, 'recall': 0.4274153592072667, 'f1-score': 0.33018627200816536, 'support': 6055}, 'accuracy': 0.3055986140238898, 'macro avg': {'precision': 0.3259300393840771, 'recall': 0.3320791319819551, 'f1-score': 0.26442193208156883, 'support': 21934}, 'weighted avg': {'precision': 0.33242858154646004, 'recall': 0.3055986140238898, 'f1-score': 0.24595591366121106, 'support': 21934}}
[[3873  227 3058]
 [4504  242 3975]
 [3294  173 2588]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0896571
{'0': {'precision': 0.3983910702217184, 'recall': 0.6503409398266118, 'f1-score': 0.49410148740397847, 'support': 140494}, '1': {'precision': 0.22907008453776928, 'recall': 0.008460662953375704, 'f1-score': 0.016318601262748908, 'support': 99283}, '2': {'precision': 0.3993512450370979, 'recall': 0.42021375177611664, 'f1-score': 0.4095169647459897, 'support': 129496}, 'accuracy': 0.3970639608094824, 'macro avg': {'precision': 0.3422707999321952, 'recall': 0.3596717848520347, 'f1-score': 0.30664568447090573, 'support': 369273}, 'weighted avg': {'precision': 0.3532040226342502, 'recall': 0.3970639608094824, 'f1-score': 0.33598249243039896, 'support': 369273}}
[[91369  1568 47557]
 [64155   840 34288]
 [73821  1259 54416]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015041
{'0': {'precision': 0.3465552505987448, 'recall': 0.7240850317773395, 'f1-score': 0.4687577588347265, 'support': 54756}, '1': {'precision': 0.3086734693877551, 'recall': 0.008688315651533919, 'f1-score': 0.01690091663029245, 'support': 55707}, '2': {'precision': 0.36685307997754724, 'recall': 0.32914272923972243, 'f1-score': 0.346976296048686, 'support': 53612}, 'accuracy': 0.352143836660064, 'macro avg': {'precision': 0.340693933321349, 'recall': 0.35397202555619867, 'f1-score': 0.2775449905045683, 'support': 164075}, 'weighted avg': {'precision': 0.3403259459681536, 'recall': 0.352143836660064, 'f1-score': 0.2755501593127541, 'support': 164075}}
[[39648   610 14498]
 [39266   484 15957]
 [35492   474 17646]]
Evaluating performance on  val set...
274/274 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970757
{'0': {'precision': 0.36550450700869636, 'recall': 0.7639540191725112, 'f1-score': 0.4944469065173308, 'support': 24097}, '1': {'precision': 0.30547550432276654, 'recall': 0.005281514698555058, 'f1-score': 0.010383503942792771, 'support': 20070}, '2': {'precision': 0.43247977742284505, 'recall': 0.3234058948179542, 'f1-score': 0.3700731857860859, 'support': 25955}, 'accuracy': 0.38374547217706284, 'macro avg': {'precision': 0.36781992958476933, 'recall': 0.3642138095630068, 'f1-score': 0.29163453208206985, 'support': 70122}, 'weighted avg': {'precision': 0.37311354639280714, 'recall': 0.38374547217706284, 'f1-score': 0.3098647153184141, 'support': 70122}}
[[18409   100  5588]
 [14537   106  5427]
 [17420   141  8394]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
1359/1359 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.117161
{'0': {'precision': 0.2958691461330595, 'recall': 0.7089460413514876, 'f1-score': 0.4175001781853602, 'support': 99150}, '1': {'precision': 0.41602634467618005, 'recall': 0.002523251865808273, 'f1-score': 0.005016080574930185, 'support': 150203}, '2': {'precision': 0.289702868852459, 'recall': 0.3216723549488055, 'f1-score': 0.30485175202156334, 'support': 98448}, 'accuracy': 0.29424584748174964, 'macro avg': {'precision': 0.33386611988723286, 'recall': 0.34438054938870044, 'f1-score': 0.24245600359395125, 'support': 347801}, 'weighted avg': {'precision': 0.34601539075872695, 'recall': 0.29424584748174964, 'f1-score': 0.20747674187450174, 'support': 347801}}
[[ 70292    306  28552]
 [100732    379  49092]
 [ 66554    226  31668]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049296
{'0': {'precision': 0.3370600956812373, 'recall': 0.688035102739726, 'f1-score': 0.4524636890675722, 'support': 37376}, '1': {'precision': 0.29411764705882354, 'recall': 0.004134546133532503, 'f1-score': 0.00815446127946128, 'support': 37489}, '2': {'precision': 0.3451192645578916, 'recall': 0.32767792583410804, 'f1-score': 0.3361725238770185, 'support': 38724}, 'accuracy': 0.33946949088380035, 'macro avg': {'precision': 0.3254323357659841, 'recall': 0.3399491915691222, 'f1-score': 0.26559689140801734, 'support': 113589}, 'weighted avg': {'precision': 0.32563481505700337, 'recall': 0.33946949088380035, 'f1-score': 0.26617832938144514, 'support': 113589}}
[[25716   183 11477]
 [24733   155 12601]
 [25846   189 12689]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006945
{'0': {'precision': 0.36316001612253124, 'recall': 0.7010036567338365, 'f1-score': 0.47845365478055385, 'support': 12853}, '1': {'precision': 0.23076923076923078, 'recall': 0.003686150605581885, 'f1-score': 0.007256392536281962, 'support': 11394}, '2': {'precision': 0.33210300429184547, 'recall': 0.31214199273900767, 'f1-score': 0.3218132667914327, 'support': 12395}, 'accuracy': 0.3526281316522024, 'macro avg': {'precision': 0.3086774170612025, 'recall': 0.3389439333594753, 'f1-score': 0.2691744380360895, 'support': 36642}, 'weighted avg': {'precision': 0.3114867376454597, 'recall': 0.3526281316522024, 'f1-score': 0.27894546158322864, 'support': 36642}}
[[9010   72 3771]
 [7342   42 4010]
 [8458   68 3869]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1235473
{'0': {'precision': 0.2875584859079452, 'recall': 0.9273999380199767, 'f1-score': 0.43899728049289655, 'support': 83898}, '1': {'precision': 0.43969102792632203, 'recall': 0.006256658268089352, 'f1-score': 0.01233775436197971, 'support': 118274}, '2': {'precision': 0.290374276261373, 'recall': 0.0628067939127615, 'f1-score': 0.10327550860935675, 'support': 89433}, 'accuracy': 0.2886233089281734, 'macro avg': {'precision': 0.33920793003188004, 'recall': 0.3321544634002758, 'f1-score': 0.18487018115474432, 'support': 291605}, 'weighted avg': {'precision': 0.35012651064469397, 'recall': 0.2886233089281734, 'f1-score': 0.16298234927268884, 'support': 291605}}
[[ 77807    470   5621]
 [109428    740   8106]
 [ 83343    473   5617]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1133482
{'0': {'precision': 0.32593354413067976, 'recall': 0.9287896738791545, 'f1-score': 0.4825346432013477, 'support': 32074}, '1': {'precision': 0.3631123919308357, 'recall': 0.0077524149387805325, 'f1-score': 0.015180722891566264, 'support': 32506}, '2': {'precision': 0.330698703762251, 'recall': 0.06182215786518514, 'f1-score': 0.1041702975227188, 'support': 33839}, 'accuracy': 0.3265019965657038, 'macro avg': {'precision': 0.3399148799412555, 'recall': 0.3327880822277067, 'f1-score': 0.20062855453854425, 'support': 98419}, 'weighted avg': {'precision': 0.33985142445220917, 'recall': 0.3265019965657038, 'f1-score': 0.19808471354336624, 'support': 98419}}
[[29790   230  2054]
 [30074   252  2180]
 [31535   212  2092]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.116306
{'0': {'precision': 0.3174850448654038, 'recall': 0.9143113503813369, 'f1-score': 0.47131194930737036, 'support': 11145}, '1': {'precision': 0.4517543859649123, 'recall': 0.007483833466540725, 'f1-score': 0.01472375098277464, 'support': 13763}, '2': {'precision': 0.26681982277650146, 'recall': 0.07770237981458472, 'f1-score': 0.12035529237601776, 'support': 10463}, 'accuracy': 0.31398603375646716, 'macro avg': {'precision': 0.34535308453560587, 'recall': 0.3331658545541541, 'f1-score': 0.2021303308887209, 'support': 35371}, 'weighted avg': {'precision': 0.35474264919766324, 'recall': 0.31398603375646716, 'f1-score': 0.18983608277789274, 'support': 35371}}
[[10190    67   888]
 [12314   103  1346]
 [ 9592    58   813]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
2282/2282 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041217
{'0': {'precision': 0.34827993763516574, 'recall': 0.6992149438344062, 'f1-score': 0.4649617699144754, 'support': 198075}, '1': {'precision': 0.33021077283372363, 'recall': 0.0034988113966957324, 'f1-score': 0.006924255519761138, 'support': 201497}, '2': {'precision': 0.3228338762214984, 'recall': 0.32244351301085006, 'f1-score': 0.3226385765402593, 'support': 184423}, 'accuracy': 0.3401878440740075, 'macro avg': {'precision': 0.33377486223012925, 'recall': 0.34171908941398393, 'f1-score': 0.2648415339914986, 'support': 583995}, 'weighted avg': {'precision': 0.33400974442445514, 'recall': 0.3401878440740075, 'f1-score': 0.26197911538893187, 'support': 583995}}
[[138497    672  58906]
 [134964    705  65828]
 [124199    758  59466]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060438
{'0': {'precision': 0.334528833071034, 'recall': 0.7196832762295303, 'f1-score': 0.4567483231387589, 'support': 74134}, '1': {'precision': 0.31121951219512195, 'recall': 0.00430151024811219, 'f1-score': 0.008485735186539868, 'support': 74160}, '2': {'precision': 0.3493328766483474, 'recall': 0.29350285811456, 'f1-score': 0.3189934603355132, 'support': 76449}, 'accuracy': 0.3386534842019551, 'macro avg': {'precision': 0.33169374063816776, 'recall': 0.3391625481974008, 'f1-score': 0.2614091728869373, 'support': 224743}, 'weighted avg': {'precision': 0.3318730666680065, 'recall': 0.3386534842019551, 'f1-score': 0.26197306860810876, 'support': 224743}}
[[53353   364 20417]
 [52465   319 21376]
 [53669   342 22438]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1070166
{'0': {'precision': 0.3335382437316046, 'recall': 0.7009199451947543, 'f1-score': 0.45199237633635003, 'support': 25545}, '1': {'precision': 0.26358695652173914, 'recall': 0.0037862523908037005, 'f1-score': 0.007465271097087006, 'support': 25619}, '2': {'precision': 0.33078869494360336, 'recall': 0.29435560813647293, 'f1-score': 0.31151050080775444, 'support': 26203}, 'accuracy': 0.3323768531802965, 'macro avg': {'precision': 0.30930463173231576, 'recall': 0.3330206019073436, 'f1-score': 0.2569893827470638, 'support': 77367}, 'weighted avg': {'precision': 0.30944362388177793, 'recall': 0.3323768531802965, 'f1-score': 0.2572144155313496, 'support': 77367}}
[[17905   118  7522]
 [17440    97  8082]
 [18337   153  7713]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
5098/5098 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0915061
{'0': {'precision': 0.3965560840678273, 'recall': 0.6067014787950047, 'f1-score': 0.4796199331756272, 'support': 462674}, '1': {'precision': 0.2944815639693145, 'recall': 0.0028239738770550935, 'f1-score': 0.005594300395126848, 'support': 421392}, '2': {'precision': 0.37299013680981696, 'recall': 0.5255806769713315, 'f1-score': 0.4363293478968455, 'support': 420845}, 'accuracy': 0.385530507444569, 'macro avg': {'precision': 0.3546759282823196, 'recall': 0.3783687098811304, 'f1-score': 0.3071811938225332, 'support': 1304911}, 'weighted avg': {'precision': 0.35599316656069474, 'recall': 0.385530507444569, 'f1-score': 0.3125823070001337, 'support': 1304911}}
[[280705   1499 180470]
 [228847   1190 191355]
 [198305   1352 221188]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932349
{'0': {'precision': 0.3773616715595187, 'recall': 0.6238004071345483, 'f1-score': 0.4702502609025286, 'support': 165056}, '1': {'precision': 0.2627197039777983, 'recall': 0.001837914096930554, 'f1-score': 0.0036502917662785015, 'support': 154523}, '2': {'precision': 0.378739474207263, 'recall': 0.48637846452673256, 'f1-score': 0.4258626845494907, 'support': 160628}, 'accuracy': 0.3776954521695852, 'macro avg': {'precision': 0.33960694991486, 'recall': 0.37067226191940383, 'f1-score': 0.29992107907276594, 'support': 480207}, 'weighted avg': {'precision': 0.34093257520538744, 'recall': 0.3776954521695852, 'f1-score': 0.30525825819270447, 'support': 480207}}
[[102962    363  61731]
 [ 87817    284  66422]
 [ 82068    434  78126]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927836
{'0': {'precision': 0.3642412334050671, 'recall': 0.6720761159386929, 'f1-score': 0.472437971952535, 'support': 52131}, '1': {'precision': 0.3021978021978022, 'recall': 0.0021110812574367636, 'f1-score': 0.0041928721174004195, 'support': 52106}, '2': {'precision': 0.4041152396512399, 'recall': 0.4614759397801792, 'f1-score': 0.4308950100902082, 'support': 54135}, 'accuracy': 0.3796630717551082, 'macro avg': {'precision': 0.3568514250847031, 'recall': 0.3785543789921029, 'f1-score': 0.3025086180533812, 'support': 158372}, 'weighted avg': {'precision': 0.3574581170817954, 'recall': 0.3796630717551082, 'f1-score': 0.3041802785949555, 'support': 158372}}
[[35036   109 16986]
 [32145   110 19851]
 [29008   145 24982]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
5760/5760 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963532
{'0': {'precision': 0.3718253037660701, 'recall': 0.7426594490850135, 'f1-score': 0.4955466183711442, 'support': 525199}, '1': {'precision': 0.34434826036290994, 'recall': 0.017743104550074842, 'f1-score': 0.0337473233404711, 'support': 466322}, '2': {'precision': 0.3657611877093998, 'recall': 0.30403354384511855, 'f1-score': 0.3320529853741824, 'support': 482950}, 'accuracy': 0.36972649852048634, 'macro avg': {'precision': 0.36064491727945996, 'recall': 0.3548120324934023, 'f1-score': 0.2871156423619326, 'support': 1474471}, 'weighted avg': {'precision': 0.3611490580593609, 'recall': 0.36972649852048634, 'f1-score': 0.29594525563618623, 'support': 1474471}}
[[390044   7927 127228]
 [330664   8274 127384]
 [328290   7827 146833]]
Evaluating performance on  train set...
2159/2159 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015261
{'0': {'precision': 0.34909971154512637, 'recall': 0.7078193749256765, 'f1-score': 0.4675845914330195, 'support': 185002}, '1': {'precision': 0.31668348469559365, 'recall': 0.010320070152362162, 'f1-score': 0.019988747704425554, 'support': 182460}, '2': {'precision': 0.3656226857386102, 'recall': 0.33878331721391636, 'f1-score': 0.3516916829328487, 'support': 185077}, 'accuracy': 0.35387909269752904, 'macro avg': {'precision': 0.3438019606597767, 'recall': 0.35230758743065166, 'f1-score': 0.27975500735676456, 'support': 552539}, 'weighted avg': {'precision': 0.34392968326448314, 'recall': 0.35387909269752904, 'f1-score': 0.2809598473458051, 'support': 552539}}
[[130948   2160  51894]
 [123681   1883  56896]
 [120473   1903  62701]]
Evaluating performance on  val set...
850/850 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954208
{'0': {'precision': 0.3748422610724201, 'recall': 0.7075007724791431, 'f1-score': 0.4900501616319251, 'support': 77672}, '1': {'precision': 0.2965030855127828, 'recall': 0.015555384259616126, 'f1-score': 0.029559969531845084, 'support': 64865}, '2': {'precision': 0.3788146542122693, 'recall': 0.3409929419313442, 'f1-score': 0.3589101423174601, 'support': 74808}, 'accuracy': 0.37484644229220826, 'macro avg': {'precision': 0.35005333359915736, 'recall': 0.3546830328900345, 'f1-score': 0.2928400911604101, 'support': 217345}, 'weighted avg': {'precision': 0.3528297747641542, 'recall': 0.37484644229220826, 'f1-score': 0.3074831880394882, 'support': 217345}}
[[54953  1142 21577]
 [43603  1009 20253]
 [48047  1252 25509]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
6315/6315 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0881499
{'0': {'precision': 0.40748596992520175, 'recall': 0.6766497987807307, 'f1-score': 0.5086545569564139, 'support': 627425}, '1': {'precision': 0.2733321012751802, 'recall': 0.007198639121366914, 'f1-score': 0.014027832775713544, 'support': 410911}, '2': {'precision': 0.3903957598301378, 'recall': 0.38070180901080425, 'f1-score': 0.3854878500547792, 'support': 578106}, 'accuracy': 0.4006274273991891, 'macro avg': {'precision': 0.3570712770101732, 'recall': 0.3548500823043006, 'f1-score': 0.30272341326230223, 'support': 1616442}, 'weighted avg': {'precision': 0.3672709462385702, 'recall': 0.4006274273991891, 'f1-score': 0.3388674726565181, 'support': 1616442}}
[[424547   3734 199144]
 [263432   2958 144521]
 [353890   4130 220086]]
Evaluating performance on  train set...
2155/2155 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011363
{'0': {'precision': 0.34624727289084817, 'recall': 0.6747830279652844, 'f1-score': 0.45765886287625424, 'support': 182512}, '1': {'precision': 0.29172799528996174, 'recall': 0.0054381825165999015, 'f1-score': 0.010677326035544398, 'support': 182230}, '2': {'precision': 0.3683543251444486, 'recall': 0.3795095262822606, 'f1-score': 0.37384872974647665, 'support': 186799}, 'accuracy': 0.35362556908733894, 'macro avg': {'precision': 0.3354431977750862, 'recall': 0.35324357892138164, 'f1-score': 0.28072830621942507, 'support': 551541}, 'weighted avg': {'precision': 0.33572135967081695, 'recall': 0.35362556908733894, 'f1-score': 0.2815901852675327, 'support': 551541}}
[[123156   1190  58166]
 [117841    991  63398]
 [114691   1216  70892]]
Evaluating performance on  val set...
746/746 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0930514
{'0': {'precision': 0.38447008133381205, 'recall': 0.6945388400851675, 'f1-score': 0.4949530982299418, 'support': 70919}, '1': {'precision': 0.2736960179472799, 'recall': 0.009441262962389722, 'f1-score': 0.01825288474126162, 'support': 51688}, '2': {'precision': 0.38805724896067834, 'recall': 0.34654496896415105, 'f1-score': 0.36612818207187375, 'support': 68147}, 'accuracy': 0.3845790913952001, 'macro avg': {'precision': 0.34874111608059005, 'recall': 0.35017502400390277, 'f1-score': 0.2931113883476924, 'support': 190754}, 'weighted avg': {'precision': 0.3557355065618282, 'recall': 0.3845790913952001, 'f1-score': 0.3197603777825238, 'support': 190754}}
[[49256   623 21040]
 [34999   488 16201]
 [43859   672 23616]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
6082/6082 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0874306
{'0': {'precision': 0.4010002087655889, 'recall': 0.5769144291529497, 'f1-score': 0.473134970190485, 'support': 595974}, '1': {'precision': 0.24971310534771632, 'recall': 0.005706119130970643, 'f1-score': 0.011157286461791677, 'support': 381345}, '2': {'precision': 0.3995459474799072, 'recall': 0.47620559634848186, 'f1-score': 0.4345205384543922, 'support': 579485}, 'accuracy': 0.39950822325739144, 'macro avg': {'precision': 0.3500864205310708, 'recall': 0.3529420482108007, 'f1-score': 0.30627093170222297, 'support': 1556804}, 'weighted avg': {'precision': 0.3634005475018577, 'recall': 0.39950822325739144, 'f1-score': 0.3455984506439601, 'support': 1556804}}
[[343826   3363 248785]
 [213239   2176 165930]
 [300356   3175 275954]]
Evaluating performance on  train set...
2440/2440 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022034
{'0': {'precision': 0.3437179641170177, 'recall': 0.5932893931138894, 'f1-score': 0.4352670675627874, 'support': 207403}, '1': {'precision': 0.3077599472411519, 'recall': 0.006773428806425081, 'f1-score': 0.01325512807767505, 'support': 206690}, '2': {'precision': 0.34366759400246527, 'recall': 0.4278269214324399, 'f1-score': 0.38115695133693805, 'support': 210494}, 'accuracy': 0.34343494180954776, 'macro avg': {'precision': 0.331715168453545, 'recall': 0.3426299144509181, 'f1-score': 0.2765597156591335, 'support': 624587}, 'weighted avg': {'precision': 0.33180166564304164, 'recall': 0.34343494180954776, 'f1-score': 0.2773779302976477, 'support': 624587}}
[[123050   1550  82803]
 [116107   1400  89183]
 [118840   1599  90055]]
Evaluating performance on  val set...
826/826 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952114
{'0': {'precision': 0.38229393946659634, 'recall': 0.6159125441013623, 'f1-score': 0.4717653846722851, 'support': 77662}, '1': {'precision': 0.263668430335097, 'recall': 0.004805606004596666, 'f1-score': 0.009439174151184632, 'support': 62219}, '2': {'precision': 0.3612575279104986, 'recall': 0.4300487723073913, 'f1-score': 0.3926630088043894, 'support': 71557}, 'accuracy': 0.37318268239389324, 'macro avg': {'precision': 0.335739965904064, 'recall': 0.3502556408044501, 'f1-score': 0.29128918920928637, 'support': 211438}, 'weighted avg': {'precision': 0.34026713702629496, 'recall': 0.37318268239389324, 'f1-score': 0.30894790057580596, 'support': 211438}}
[[47833   431 29398]
 [36908   299 25012]
 [40380   404 30773]]
testing model on single stock: results/universal/W3/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
13689/13689 - 130s - 130s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077338
{'0': {'precision': 0.326471987325231, 'recall': 0.6683548245776086, 'f1-score': 0.4386675654647888, 'support': 1136742}, '1': {'precision': 0.360330249236354, 'recall': 0.013140550371033477, 'f1-score': 0.025356401599669787, 'support': 1238837}, '2': {'precision': 0.32310974667049497, 'recall': 0.3240424323560448, 'f1-score': 0.32357541741278395, 'support': 1128667}, 'accuracy': 0.32582244511372777, 'macro avg': {'precision': 0.33663732774402666, 'recall': 0.3351792691015623, 'f1-score': 0.26253312815908086, 'support': 3504246}, 'weighted avg': {'precision': 0.33735878509517375, 'recall': 0.32582244511372777, 'f1-score': 0.2554824033002077, 'support': 3504246}}
[[759747  14439 362556]
 [818925  16279 403633]
 [748471  14460 365736]]
Evaluating performance on  train set...
5475/5475 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047636
{'0': {'precision': 0.33847889217901134, 'recall': 0.6803518874640091, 'f1-score': 0.45205692203646364, 'support': 470605}, '1': {'precision': 0.3361888842457167, 'recall': 0.010428842111176166, 'f1-score': 0.020230129775423347, 'support': 462851}, '2': {'precision': 0.33553602142862, 'recall': 0.31630386020379825, 'f1-score': 0.32563622388218905, 'support': 468110}, 'accuracy': 0.33752887841171947, 'macro avg': {'precision': 0.3367345992844493, 'recall': 0.3356948632596612, 'f1-score': 0.26597442523135867, 'support': 1401566}, 'weighted avg': {'precision': 0.336739752039411, 'recall': 0.33752887841171947, 'f1-score': 0.2672277697612142, 'support': 1401566}}
[[320177   4740 145688]
 [310498   4827 147526]
 [315254   4791 148065]]
Evaluating performance on  val set...
2036/2036 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060333
{'0': {'precision': 0.3336411366590971, 'recall': 0.6941332838055881, 'f1-score': 0.4506658527210654, 'support': 172294}, '1': {'precision': 0.3506560773480663, 'recall': 0.011407484792828618, 'f1-score': 0.02209614160678442, 'support': 178041}, '2': {'precision': 0.33360514748041026, 'recall': 0.3064471766902113, 'f1-score': 0.31944999405217617, 'support': 170881}, 'accuracy': 0.3338193762278978, 'macro avg': {'precision': 0.3393007871625246, 'recall': 0.33732931509620934, 'f1-score': 0.264070662793342, 'support': 521216}, 'weighted avg': {'precision': 0.33944143286712136, 'recall': 0.3338193762278978, 'f1-score': 0.26125248651262944, 'support': 521216}}
[[119595   1923  50776]
 [122182   2031  53828]
 [116677   1838  52366]]
training model: results/universal/W3/deepVOL_L2/h1000
Epoch 1/50
10532/10532 - 341s - loss: 3.2711 - accuracy1000: 0.3750 - val_loss: 3.3366 - val_accuracy1000: 0.3391 - 341s/epoch - 32ms/step
Epoch 2/50
10532/10532 - 342s - loss: 3.2702 - accuracy1000: 0.3744 - val_loss: 3.3181 - val_accuracy1000: 0.3349 - 342s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 336s - loss: 3.2658 - accuracy1000: 0.3804 - val_loss: 3.3387 - val_accuracy1000: 0.3392 - 336s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 338s - loss: 3.2590 - accuracy1000: 0.3850 - val_loss: 3.3124 - val_accuracy1000: 0.3388 - 338s/epoch - 32ms/step
Epoch 5/50
10532/10532 - 336s - loss: 3.2531 - accuracy1000: 0.3913 - val_loss: 3.3242 - val_accuracy1000: 0.3390 - 336s/epoch - 32ms/step
Epoch 6/50
10532/10532 - 337s - loss: 3.2541 - accuracy1000: 0.3905 - val_loss: 3.3106 - val_accuracy1000: 0.3489 - 337s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 336s - loss: 3.2502 - accuracy1000: 0.3940 - val_loss: 3.3200 - val_accuracy1000: 0.3404 - 336s/epoch - 32ms/step
Epoch 8/50
10532/10532 - 335s - loss: 3.2473 - accuracy1000: 0.3957 - val_loss: 3.3206 - val_accuracy1000: 0.3410 - 335s/epoch - 32ms/step
Epoch 9/50
10532/10532 - 341s - loss: 3.2437 - accuracy1000: 0.3976 - val_loss: 3.3246 - val_accuracy1000: 0.3410 - 341s/epoch - 32ms/step
Epoch 10/50
10532/10532 - 343s - loss: 3.2424 - accuracy1000: 0.3983 - val_loss: 3.3367 - val_accuracy1000: 0.3392 - 343s/epoch - 33ms/step
Epoch 11/50
10532/10532 - 338s - loss: 3.2407 - accuracy1000: 0.3988 - val_loss: 3.3281 - val_accuracy1000: 0.3393 - 338s/epoch - 32ms/step
Epoch 12/50
10532/10532 - 342s - loss: 3.2388 - accuracy1000: 0.3996 - val_loss: 3.3226 - val_accuracy1000: 0.3423 - 342s/epoch - 32ms/step
Epoch 13/50
10532/10532 - 344s - loss: 3.2362 - accuracy1000: 0.4017 - val_loss: 3.3241 - val_accuracy1000: 0.3442 - 344s/epoch - 33ms/step
Epoch 14/50
10532/10532 - 343s - loss: 3.2337 - accuracy1000: 0.4029 - val_loss: 3.3390 - val_accuracy1000: 0.3421 - 343s/epoch - 33ms/step
Epoch 15/50
10532/10532 - 341s - loss: 3.2321 - accuracy1000: 0.4041 - val_loss: 3.3383 - val_accuracy1000: 0.3431 - 341s/epoch - 32ms/step
Epoch 16/50
10532/10532 - 342s - loss: 3.2295 - accuracy1000: 0.4053 - val_loss: 3.3321 - val_accuracy1000: 0.3442 - 342s/epoch - 32ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 440s - 440s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1261343
{'0': {'precision': 0.3548537321194696, 'recall': 0.12775699360463041, 'f1-score': 0.18787417505877624, 'support': 2606417}, '1': {'precision': 0.27137338211804707, 'recall': 0.6425489607842652, 'f1-score': 0.3815875298785657, 'support': 2016665}, '2': {'precision': 0.3485157340709328, 'recall': 0.1942636077445964, 'f1-score': 0.24947126259416794, 'support': 2463395}, 'accuracy': 0.29737512730232524, 'macro avg': {'precision': 0.32491428276948314, 'recall': 0.32152318737783064, 'f1-score': 0.27297765584383665, 'support': 7086477}, 'weighted avg': {'precision': 0.3288937392007888, 'recall': 0.29737512730232524, 'f1-score': 0.2644133214000255, 'support': 7086477}}
[[ 332988 1805283  468146]
 [ 294450 1295806  426409]
 [ 310943 1673904  478548]]
Evaluating performance on  train set...
10532/10532 - 165s - 165s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074125
{'0': {'precision': 0.3519599522772837, 'recall': 0.1580220979342275, 'f1-score': 0.21811532395942188, 'support': 905424}, '1': {'precision': 0.33600643891112986, 'recall': 0.6337058844109776, 'f1-score': 0.4391596402704112, 'support': 886053}, '2': {'precision': 0.3481785109421986, 'recall': 0.23801572654260442, 'f1-score': 0.2827457383546114, 'support': 904331}, 'accuracy': 0.34120345365842075, 'macro avg': {'precision': 0.3453816340435374, 'recall': 0.3432479029626032, 'f1-score': 0.3133402341948148, 'support': 2695808}, 'weighted avg': {'precision': 0.3454478664749493, 'recall': 0.34120345365842075, 'f1-score': 0.3124485505396224, 'support': 2695808}}
[[143077 555231 207116]
 [128714 561497 195842]
 [134724 554362 215245]]
Evaluating performance on  val set...
3814/3814 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038713
{'0': {'precision': 0.34725852213168595, 'recall': 0.1543910668679977, 'f1-score': 0.21374925799430483, 'support': 321858}, '1': {'precision': 0.3497263335168572, 'recall': 0.6524162389625141, 'f1-score': 0.45535863946926486, 'support': 331031}, '2': {'precision': 0.3492149054122502, 'recall': 0.23270144234639847, 'f1-score': 0.2792937936570763, 'support': 322946}, 'accuracy': 0.34925166652149187, 'macro avg': {'precision': 0.34873325368693114, 'recall': 0.3465029160589701, 'f1-score': 0.31613389704021533, 'support': 975835}, 'weighted avg': {'precision': 0.3487431258050218, 'recall': 0.34925166652149187, 'f1-score': 0.3174015565623895, 'support': 975835}}
[[ 49692 200159  72007]
 [ 47021 215970  68040]
 [ 46385 201411  75150]]
testing model out of sample: results/universal/W3/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 256s - 256s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1128653
{'0': {'precision': 0.3732040288331679, 'recall': 0.11037847210047856, 'f1-score': 0.17036882188588667, 'support': 1454559}, '1': {'precision': 0.32862685999143393, 'recall': 0.7771383249781401, 'f1-score': 0.4619218094185086, 'support': 1328914}, '2': {'precision': 0.3461328289942907, 'recall': 0.14419544859902883, 'f1-score': 0.20358107346637228, 'support': 1352990}, 'accuracy': 0.3356483546450192, 'macro avg': {'precision': 0.34932123927296416, 'recall': 0.3439040818925492, 'f1-score': 0.27862390159025585, 'support': 4136463}, 'weighted avg': {'precision': 0.35002812071452966, 'recall': 0.3356483546450192, 'f1-score': 0.27489887356042314, 'support': 4136463}}
[[ 160552 1091480  202527]
 [ 130144 1032750  166020]
 [ 139503 1018392  195095]]
Evaluating performance on  train set...
6181/6181 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040033
{'0': {'precision': 0.35902606131564113, 'recall': 0.12684903593507021, 'f1-score': 0.1874642681263196, 'support': 522164}, '1': {'precision': 0.34840588663205213, 'recall': 0.7589163007888434, 'f1-score': 0.4775681543448582, 'support': 523171}, '2': {'precision': 0.3679433449747769, 'recall': 0.17675206728654194, 'f1-score': 0.23879307739576303, 'support': 536452}, 'accuracy': 0.35282752987601995, 'macro avg': {'precision': 0.3584584309741567, 'recall': 0.35417246800348523, 'f1-score': 0.30127516662231363, 'support': 1581787}, 'weighted avg': {'precision': 0.35853770684321384, 'recall': 0.35282752987601995, 'f1-score': 0.3008230089979101, 'support': 1581787}}
[[ 66236 364616  91312]
 [ 54559 397043  71569]
 [ 63693 377940  94819]]
Evaluating performance on  val set...
2209/2209 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1142052
{'0': {'precision': 0.3879626236716746, 'recall': 0.10418614262800012, 'f1-score': 0.16426061391192373, 'support': 203242}, '1': {'precision': 0.315783745985584, 'recall': 0.7835691837449943, 'f1-score': 0.4501528224289194, 'support': 174051}, '2': {'precision': 0.3511148022743244, 'recall': 0.1466123894938458, 'f1-score': 0.20685138766569566, 'support': 187433}, 'accuracy': 0.32765624391297726, 'macro avg': {'precision': 0.351620390643861, 'recall': 0.34478923862228, 'f1-score': 0.2737549413355129, 'support': 564726}, 'weighted avg': {'precision': 0.35348696016740655, 'recall': 0.32765624391297726, 'f1-score': 0.26650974230619345, 'support': 564726}}
[[ 21175 153420  28647]
 [ 15532 136381  22138]
 [ 17873 142080  27480]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956768
{'0': {'precision': 0.3583613592439852, 'recall': 0.4218889963810957, 'f1-score': 0.38753898182356766, 'support': 55818}, '1': {'precision': 0.45671585189271185, 'recall': 0.35938093429548046, 'f1-score': 0.40224388170279957, 'support': 73724}, '2': {'precision': 0.2842732599110073, 'recall': 0.32198403648802737, 'f1-score': 0.30195579413368695, 'support': 43850}, 'accuracy': 0.3700459075389868, 'macro avg': {'precision': 0.3664501570159015, 'recall': 0.3677513223882012, 'f1-score': 0.36391288588668474, 'support': 173392}, 'weighted avg': {'precision': 0.38144387435589144, 'recall': 0.3700459075389868, 'f1-score': 0.3721477368900945, 'support': 173392}}
[[23549 17385 14884]
 [26565 26495 20664]
 [15599 14132 14119]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065148
{'0': {'precision': 0.3313093876907306, 'recall': 0.3918030493775353, 'f1-score': 0.3590258491775261, 'support': 21447}, '1': {'precision': 0.3263818399926179, 'recall': 0.31912302070645554, 'f1-score': 0.3227116169795397, 'support': 22167}, '2': {'precision': 0.34133319510678, 'recall': 0.28989654413383226, 'f1-score': 0.3135191753755326, 'support': 22715}, 'accuracy': 0.33261469342218336, 'macro avg': {'precision': 0.3330081409300428, 'recall': 0.33360753807260773, 'f1-score': 0.3317522138441995, 'support': 66329}, 'weighted avg': {'precision': 0.3330953611809309, 'recall': 0.33261469342218336, 'f1-score': 0.33130552050462214, 'support': 66329}}
[[8403 6709 6335]
 [8721 7074 6372]
 [8239 7891 6585]]
Evaluating performance on  val set...
86/86 - 1s - 780ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079946
{'0': {'precision': 0.34974060483360747, 'recall': 0.36902536715620826, 'f1-score': 0.3591242772688884, 'support': 7490}, '1': {'precision': 0.37434698927687654, 'recall': 0.32536742741068225, 'f1-score': 0.3481429393338873, 'support': 8369}, '2': {'precision': 0.27393813822702384, 'recall': 0.3046913580246914, 'f1-score': 0.288497506234414, 'support': 6075}, 'accuracy': 0.33454910185100756, 'macro avg': {'precision': 0.33267524411250265, 'recall': 0.3330280508638606, 'f1-score': 0.33192157427906327, 'support': 21934}, 'weighted avg': {'precision': 0.3381344612560896, 'recall': 0.33454910185100756, 'f1-score': 0.33537300293623334, 'support': 21934}}
[[2764 2491 2235]
 [2975 2723 2671]
 [2164 2060 1851]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402023
{'0': {'precision': 0.42253225951318824, 'recall': 0.09798721090891417, 'f1-score': 0.1590824550526968, 'support': 144029}, '1': {'precision': 0.2440766260514213, 'recall': 0.8320870610228335, 'f1-score': 0.3774388689654476, 'support': 89868}, '2': {'precision': 0.4138503779532897, 'recall': 0.0901858527360832, 'f1-score': 0.1480982793233744, 'support': 135376}, 'accuracy': 0.2737811862768196, 'macro avg': {'precision': 0.3601530878392998, 'recall': 0.3400867082226103, 'f1-score': 0.2282065344471729, 'support': 369273}, 'weighted avg': {'precision': 0.3759196740655793, 'recall': 0.2737811862768196, 'f1-score': 0.2081958763750744, 'support': 369273}}
[[ 14113 118887  11029]
 [  8827  74778   6263]
 [ 10461 112706  12209]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1047711
{'0': {'precision': 0.40841460365091276, 'recall': 0.11685268655648566, 'f1-score': 0.18171450823319985, 'support': 55908}, '1': {'precision': 0.34354247503949203, 'recall': 0.8258825698221034, 'f1-score': 0.48523972250353364, 'support': 54245}, '2': {'precision': 0.37718553726022747, 'recall': 0.12362301101591187, 'f1-score': 0.18621412109784205, 'support': 53922}, 'accuracy': 0.3534907816547311, 'macro avg': {'precision': 0.37638087198354414, 'recall': 0.355452755798167, 'f1-score': 0.2843894506115252, 'support': 164075}, 'weighted avg': {'precision': 0.3767039692797712, 'recall': 0.3534907816547311, 'f1-score': 0.28354204669415667, 'support': 164075}}
[[ 6533 43613  5762]
 [ 4200 44800  5245]
 [ 5263 41993  6666]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034706
{'0': {'precision': 0.3457243608580664, 'recall': 0.10949788263762855, 'f1-score': 0.16631913765682985, 'support': 21489}, '1': {'precision': 0.3646337087099916, 'recall': 0.8422340635484508, 'f1-score': 0.508932191666468, 'support': 25335}, '2': {'precision': 0.38378153012299354, 'recall': 0.07901965833977165, 'f1-score': 0.13105534792667733, 'support': 23298}, 'accuracy': 0.36410826844642197, 'macro avg': {'precision': 0.3647131998970172, 'recall': 0.3435838681752837, 'f1-score': 0.2687688924166584, 'support': 70122}, 'weighted avg': {'precision': 0.3652007628055693, 'recall': 0.36410826844642197, 'f1-score': 0.27838847324624666, 'support': 70122}}
[[ 2353 17754  1382]
 [ 2423 21338  1574]
 [ 2030 19427  1841]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
1359/1359 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0691183
{'0': {'precision': 0.3134341538801192, 'recall': 0.14899511990344755, 'f1-score': 0.20197752169583155, 'support': 95285}, '1': {'precision': 0.5010925870916023, 'recall': 0.7558062457036236, 'f1-score': 0.6026402397993516, 'support': 162928}, '2': {'precision': 0.29311651015697954, 'recall': 0.1857056748671697, 'f1-score': 0.22736373140549518, 'support': 89588}, 'accuracy': 0.44271293067012457, 'macro avg': {'precision': 0.36921441704290037, 'recall': 0.36350234682474697, 'f1-score': 0.3439938309668928, 'support': 347801}, 'weighted avg': {'precision': 0.39610958074896624, 'recall': 0.44271293067012457, 'f1-score': 0.3962077714381832, 'support': 347801}}
[[ 14197  63041  18047]
 [ 17711 123142  22075]
 [ 13387  59564  16637]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099418
{'0': {'precision': 0.35576327495917565, 'recall': 0.17070600632244468, 'f1-score': 0.2307102428336681, 'support': 37011}, '1': {'precision': 0.35478346957068513, 'recall': 0.7025458976872334, 'f1-score': 0.4714740341707114, 'support': 37747}, '2': {'precision': 0.3750415026324527, 'recall': 0.2036259689423399, 'f1-score': 0.2639449878158694, 'support': 38831}, 'accuracy': 0.358696704786555, 'macro avg': {'precision': 0.3618627490541045, 'recall': 0.35895929098400603, 'f1-score': 0.32204308827341627, 'support': 113589}, 'weighted avg': {'precision': 0.3620280377864007, 'recall': 0.358696704786555, 'f1-score': 0.32208043901466477, 'support': 113589}}
[[ 6318 23477  7216]
 [ 5268 26519  5960]
 [ 6173 24751  7907]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014463
{'0': {'precision': 0.3664766729997889, 'recall': 0.13963963963963963, 'f1-score': 0.20222494029937677, 'support': 12432}, '1': {'precision': 0.35859338246824524, 'recall': 0.7435980814567922, 'f1-score': 0.48385305086090613, 'support': 12301}, '2': {'precision': 0.3460997342504299, 'recall': 0.18590981610546645, 'f1-score': 0.24188790560471976, 'support': 11909}, 'accuracy': 0.35743136291687133, 'macro avg': {'precision': 0.35705659657282135, 'recall': 0.3563825124006328, 'f1-score': 0.3093219655883342, 'support': 36642}, 'weighted avg': {'precision': 0.35720749226744253, 'recall': 0.35743136291687133, 'f1-score': 0.30966049626899367, 'support': 36642}}
[[1736 8350 2346]
 [1317 9147 1837]
 [1684 8011 2214]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012504
{'0': {'precision': 0.2745414188793031, 'recall': 0.15905809848475658, 'f1-score': 0.20142105465299381, 'support': 82429}, '1': {'precision': 0.3906238084343781, 'recall': 0.7112383927796581, 'f1-score': 0.5042856527544471, 'support': 115230}, '2': {'precision': 0.3214359155136453, 'recall': 0.11647116428586635, 'f1-score': 0.17098611577738362, 'support': 93946}, 'accuracy': 0.36353629052999775, 'macro avg': {'precision': 0.32886704760910884, 'recall': 0.32892255185009367, 'f1-score': 0.29223094106160824, 'support': 291605}, 'weighted avg': {'precision': 0.33552022284096766, 'recall': 0.36353629052999775, 'f1-score': 0.3112951887440499, 'support': 291605}}
[[13111 60578  8740]
 [18915 81956 14359]
 [15730 67274 10942]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1132368
{'0': {'precision': 0.31897044804575786, 'recall': 0.15936368832158507, 'f1-score': 0.2125389061805247, 'support': 31494}, '1': {'precision': 0.3220842780512083, 'recall': 0.7205554868241989, 'f1-score': 0.44517694718336764, 'support': 32332}, '2': {'precision': 0.33954791344667695, 'recall': 0.10161015234295956, 'f1-score': 0.1564133941484036, 'support': 34593}, 'accuracy': 0.3234233227323992, 'macro avg': {'precision': 0.3268675465145477, 'recall': 0.32717644249624783, 'f1-score': 0.271376415837432, 'support': 98419}, 'weighted avg': {'precision': 0.3272260959628289, 'recall': 0.3234233227323992, 'f1-score': 0.2692363254184437, 'support': 98419}}
[[ 5019 23317  3158]
 [ 5356 23297  3679]
 [ 5360 25718  3515]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044378
{'0': {'precision': 0.3243683781581092, 'recall': 0.17099157930915965, 'f1-score': 0.22393518258031844, 'support': 11638}, '1': {'precision': 0.36257309941520466, 'recall': 0.6907814407814408, 'f1-score': 0.475545048594694, 'support': 13104}, '2': {'precision': 0.28875878220140516, 'recall': 0.11600338696020322, 'f1-score': 0.16551446405799047, 'support': 10629}, 'accuracy': 0.34703570721777727, 'macro avg': {'precision': 0.32523341992490634, 'recall': 0.32592546901693453, 'f1-score': 0.28833156507766766, 'support': 35371}, 'weighted avg': {'precision': 0.3278214971518943, 'recall': 0.34703570721777727, 'f1-score': 0.29959439117149633, 'support': 35371}}
[[1990 8291 1357]
 [2372 9052 1680]
 [1773 7623 1233]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
2282/2282 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103456
{'0': {'precision': 0.36824015264382237, 'recall': 0.13621092220455083, 'f1-score': 0.19886301481044952, 'support': 206863}, '1': {'precision': 0.35313806191246416, 'recall': 0.7890373005771187, 'f1-score': 0.48790949665575095, 'support': 195627}, '2': {'precision': 0.3648544958508583, 'recall': 0.14146717721274896, 'f1-score': 0.2038819918929971, 'support': 181505}, 'accuracy': 0.35652873740357366, 'macro avg': {'precision': 0.362077570135715, 'recall': 0.35557179999813954, 'f1-score': 0.29688483445306585, 'support': 583995}, 'weighted avg': {'precision': 0.36212898672680194, 'recall': 0.35652873740357366, 'f1-score': 0.2972478734810179, 'support': 583995}}
[[ 28177 153478  25208]
 [ 21779 154357  19491]
 [ 26562 129266  25677]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037799
{'0': {'precision': 0.34321036663169535, 'recall': 0.16482154772117596, 'f1-score': 0.22269649690903737, 'support': 73437}, '1': {'precision': 0.34913465843829694, 'recall': 0.7250357113980002, 'f1-score': 0.47131274993758393, 'support': 74206}, '2': {'precision': 0.3824452296819788, 'recall': 0.175473411154345, 'f1-score': 0.2405690153367415, 'support': 77100}, 'accuracy': 0.3534481607881002, 'macro avg': {'precision': 0.35826341825065705, 'recall': 0.355110223424507, 'f1-score': 0.31152608739445425, 'support': 224743}, 'weighted avg': {'precision': 0.3586263125742944, 'recall': 0.3534481607881002, 'f1-score': 0.31091632508171607, 'support': 224743}}
[[12104 49247 12086]
 [10644 53802  9760]
 [12519 51052 13529]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058728
{'0': {'precision': 0.36966688937673, 'recall': 0.1502735420789198, 'f1-score': 0.2136827586206897, 'support': 25773}, '1': {'precision': 0.3389375068085261, 'recall': 0.7487265872538403, 'f1-score': 0.4666358375723338, 'support': 24933}, '2': {'precision': 0.35413139180494413, 'recall': 0.1568958403660778, 'f1-score': 0.21745119954253636, 'support': 26661}, 'accuracy': 0.34541858932102837, 'macro avg': {'precision': 0.35424526266340006, 'recall': 0.351965323232946, 'f1-score': 0.29925659857851994, 'support': 77367}, 'weighted avg': {'precision': 0.3544101572256267, 'recall': 0.34541858932102837, 'f1-score': 0.2965003620035105, 'support': 77367}}
[[ 3873 17581  4319]
 [ 2955 18668  3310]
 [ 3649 18829  4183]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
5098/5098 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1424652
{'0': {'precision': 0.4287944646500488, 'recall': 0.04626363129978044, 'f1-score': 0.08351647592193288, 'support': 522419}, '1': {'precision': 0.24999860054000497, 'recall': 0.8314968302090542, 'f1-score': 0.38441779409412363, 'support': 322261}, '2': {'precision': 0.4078119340818544, 'recall': 0.1565778924062047, 'f1-score': 0.22627740664275003, 'support': 460231}, 'accuracy': 0.2790918307838619, 'macro avg': {'precision': 0.3622016664239694, 'recall': 0.3447794513050131, 'f1-score': 0.2314038922196022, 'support': 1304911}, 'weighted avg': {'precision': 0.3772386535718239, 'recall': 0.2790918307838619, 'f1-score': 0.20817767166789625, 'support': 1304911}}
[[ 24169 433023  65227]
 [ 14887 267959  39415]
 [ 17309 370860  72062]]
Evaluating performance on  train set...
1876/1876 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1153119
{'0': {'precision': 0.3900033886818028, 'recall': 0.06881397684875155, 'f1-score': 0.11698634871263176, 'support': 167248}, '1': {'precision': 0.3209392074624702, 'recall': 0.843756365858627, 'f1-score': 0.46500477129473194, 'support': 152179}, '2': {'precision': 0.38642694853304355, 'recall': 0.12165070282373429, 'f1-score': 0.18504695002246976, 'support': 160780}, 'accuracy': 0.33208595459874596, 'macro avg': {'precision': 0.3657898482257722, 'recall': 0.344740348510371, 'f1-score': 0.2556793566766112, 'support': 480207}, 'weighted avg': {'precision': 0.36691930602391915, 'recall': 0.33208595459874596, 'f1-score': 0.2500620410884555, 'support': 480207}}
[[ 11509 139298  16441]
 [  9162 128402  14615]
 [  8839 132382  19559]]
Evaluating performance on  val set...
619/619 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100908
{'0': {'precision': 0.3278073407013235, 'recall': 0.09753968576184482, 'f1-score': 0.15034418022528157, 'support': 49262}, '1': {'precision': 0.37224358924951634, 'recall': 0.8295858598004019, 'f1-score': 0.5138965737390935, 'support': 58217}, '2': {'precision': 0.4172929639968506, 'recall': 0.11455406440964376, 'f1-score': 0.1797607301430686, 'support': 50893}, 'accuracy': 0.37210491753592806, 'macro avg': {'precision': 0.3724479646492302, 'recall': 0.3472265366572968, 'f1-score': 0.2813338280358146, 'support': 158372}, 'weighted avg': {'precision': 0.37289824634190016, 'recall': 0.37210491753592806, 'f1-score': 0.2934378215770327, 'support': 158372}}
[[ 4805 40261  4196]
 [ 5976 48296  3945]
 [ 3877 41186  5830]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
5760/5760 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1453391
{'0': {'precision': 0.39508084581789205, 'recall': 0.08915630767560526, 'f1-score': 0.14548222577452996, 'support': 589504}, '1': {'precision': 0.23399331832800102, 'recall': 0.809737163391767, 'f1-score': 0.363068989847542, 'support': 347288}, '2': {'precision': 0.3781732249632998, 'recall': 0.09821845376144503, 'f1-score': 0.1559371881108598, 'support': 537679}, 'accuracy': 0.26218216567162056, 'macro avg': {'precision': 0.3357491297030643, 'recall': 0.3323706416096058, 'f1-score': 0.22149613457764392, 'support': 1474471}, 'weighted avg': {'precision': 0.3509737471225731, 'recall': 0.26218216567162056, 'f1-score': 0.20054379417121168, 'support': 1474471}}
[[ 52558 483165  53781]
 [ 33022 281212  33054]
 [ 47451 437418  52810]]
Evaluating performance on  train set...
2159/2159 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093148
{'0': {'precision': 0.3771678338111576, 'recall': 0.08671176038380084, 'f1-score': 0.14100593015594112, 'support': 185096}, '1': {'precision': 0.341210942243871, 'recall': 0.8448047759105173, 'f1-score': 0.4860924340009909, 'support': 182918}, '2': {'precision': 0.3668079442362254, 'recall': 0.11350223546944858, 'f1-score': 0.17336097970805758, 'support': 184525}, 'accuracy': 0.34662530608699116, 'macro avg': {'precision': 0.3617289067637513, 'recall': 0.34833959058792224, 'f1-score': 0.2668197812883299, 'support': 552539}, 'weighted avg': {'precision': 0.36180453580772387, 'recall': 0.34662530608699116, 'f1-score': 0.26605203301733754, 'support': 552539}}
[[ 16050 148635  20411]
 [ 12645 154530  15743]
 [ 13859 149722  20944]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336243
{'0': {'precision': 0.41730086250634196, 'recall': 0.07812036234551045, 'f1-score': 0.13160394811844356, 'support': 84229}, '1': {'precision': 0.25506369108989924, 'recall': 0.8391968047272528, 'f1-score': 0.3912206195559296, 'support': 54831}, '2': {'precision': 0.3964580873671783, 'recall': 0.10723637989397714, 'f1-score': 0.16881158254574705, 'support': 78285}, 'accuracy': 0.2806091697531574, 'macro avg': {'precision': 0.3562742136544732, 'recall': 0.34151784898891346, 'f1-score': 0.23054538340670674, 'support': 217345}, 'weighted avg': {'precision': 0.3688649518679357, 'recall': 0.2806091697531574, 'f1-score': 0.21050082346745205, 'support': 217345}}
[[ 6580 69901  7748]
 [ 3785 46014  5032]
 [ 5403 64487  8395]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
6315/6315 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1576113
{'0': {'precision': 0.44407246947617174, 'recall': 0.085221987069166, 'f1-score': 0.1430006975643784, 'support': 687968}, '1': {'precision': 0.18692874135847995, 'recall': 0.8603131521251024, 'f1-score': 0.30712532739870385, 'support': 302856}, '2': {'precision': 0.379684635940019, 'recall': 0.05496165391660726, 'f1-score': 0.09602334608617946, 'support': 625618}, 'accuracy': 0.21873101540296527, 'macro avg': {'precision': 0.33689528225822357, 'recall': 0.33349893103695855, 'f1-score': 0.1820497903497539, 'support': 1616442}, 'weighted avg': {'precision': 0.3709738315021322, 'recall': 0.21873101540296527, 'f1-score': 0.15556919814529413, 'support': 1616442}}
[[ 58630 590147  39191]
 [ 25319 260551  16986]
 [ 48079 543154  34385]]
Evaluating performance on  train set...
2155/2155 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108736
{'0': {'precision': 0.36702730054697474, 'recall': 0.08385356454720616, 'f1-score': 0.1365174254204552, 'support': 181650}, '1': {'precision': 0.3377725736442088, 'recall': 0.8662904538754318, 'f1-score': 0.4860362779042999, 'support': 181812}, '2': {'precision': 0.3737655449890271, 'recall': 0.0869315553570574, 'f1-score': 0.1410558917795042, 'support': 188079}, 'accuracy': 0.34282854765103593, 'macro avg': {'precision': 0.3595218063934036, 'recall': 0.3456918579265651, 'f1-score': 0.2545365317014197, 'support': 551541}, 'weighted avg': {'precision': 0.3596814493206309, 'recall': 0.34282854765103593, 'f1-score': 0.253281749055754, 'support': 551541}}
[[ 15232 151224  15194]
 [ 12110 157502  12200]
 [ 14159 157570  16350]]
Evaluating performance on  val set...
746/746 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166315
{'0': {'precision': 0.4024016351558508, 'recall': 0.09253275365724693, 'f1-score': 0.15046572725101504, 'support': 68084}, '1': {'precision': 0.3047466483589832, 'recall': 0.8435685377441492, 'f1-score': 0.44774237535082023, 'support': 56830}, '2': {'precision': 0.37257547647158035, 'recall': 0.10065309842041312, 'f1-score': 0.1584894830616906, 'support': 65840}, 'accuracy': 0.3190863625402351, 'macro avg': {'precision': 0.3599079199954714, 'recall': 0.34558479660726976, 'f1-score': 0.2522325285545087, 'support': 190754}, 'weighted avg': {'precision': 0.36301327534458416, 'recall': 0.3190863625402351, 'f1-score': 0.24180072412702713, 'support': 190754}}
[[ 6300 55366  6418]
 [ 4148 47940  4742]
 [ 5208 54005  6627]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
6082/6082 - 65s - 65s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972694
{'0': {'precision': 0.38022446344568545, 'recall': 0.08304459374981513, 'f1-score': 0.13631640451765986, 'support': 507089}, '1': {'precision': 0.37283220835833203, 'recall': 0.8133311003791774, 'f1-score': 0.5112888386399839, 'support': 549347}, '2': {'precision': 0.3478522454715046, 'recall': 0.17216728487832955, 'f1-score': 0.2303327976984634, 'support': 500368}, 'accuracy': 0.3693843284061449, 'macro avg': {'precision': 0.3669696390918407, 'recall': 0.3561809930024407, 'f1-score': 0.2926460136187024, 'support': 1556804}, 'weighted avg': {'precision': 0.36721130628603194, 'recall': 0.3693843284061449, 'f1-score': 0.2988498874679148, 'support': 1556804}}
[[ 42111 374027  90951]
 [ 31990 446801  70556]
 [ 36652 377569  86147]]
Evaluating performance on  train set...
2440/2440 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002103
{'0': {'precision': 0.36964888482286506, 'recall': 0.11422068205855546, 'f1-score': 0.17451623593016372, 'support': 205173}, '1': {'precision': 0.35528492920885335, 'recall': 0.7520872446430218, 'f1-score': 0.4825934221237161, 'support': 206133}, '2': {'precision': 0.3648095486041575, 'recall': 0.21352581805224094, 'f1-score': 0.269380922523631, 'support': 213281}, 'accuracy': 0.3586465936690965, 'macro avg': {'precision': 0.36324778754529197, 'recall': 0.35994458158460607, 'f1-score': 0.3088301935258369, 'support': 624587}, 'weighted avg': {'precision': 0.3632558223181296, 'recall': 0.3586465936690965, 'f1-score': 0.3085851644268773, 'support': 624587}}
[[ 23435 136676  45062]
 [ 16871 155030  34232]
 [ 23092 144648  45541]]
Evaluating performance on  val set...
826/826 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996331
{'0': {'precision': 0.39921174750492655, 'recall': 0.08565427316620748, 'f1-score': 0.14104594099877593, 'support': 73318}, '1': {'precision': 0.3657267847952356, 'recall': 0.8108317372346061, 'f1-score': 0.5040852260491746, 'support': 73617}, '2': {'precision': 0.338790583166641, 'recall': 0.17067423220625397, 'f1-score': 0.2269943710179591, 'support': 64503}, 'accuracy': 0.36407835866778915, 'macro avg': {'precision': 0.36790970515560106, 'recall': 0.35572008086902246, 'f1-score': 0.29070851268863657, 'support': 211438}, 'weighted avg': {'precision': 0.3691206150542235, 'recall': 0.36407835866778915, 'f1-score': 0.29366654197439324, 'support': 211438}}
[[ 6280 55010 12028]
 [ 4468 59691  9458]
 [ 4983 48511 11009]]
testing model on single stock: results/universal/W3/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
13689/13689 - 137s - 137s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060956
{'0': {'precision': 0.3343446247564739, 'recall': 0.19090145796924002, 'f1-score': 0.24303608700503163, 'support': 1169572}, '1': {'precision': 0.3404621660380893, 'recall': 0.5146512705971596, 'f1-score': 0.4098153036425835, 'support': 1186450}, '2': {'precision': 0.33486195870506286, 'recall': 0.3041706147929324, 'f1-score': 0.31877926751852514, 'support': 1148224}, 'accuracy': 0.337629549980224, 'macro avg': {'precision': 0.33655624983320864, 'recall': 0.336574447786444, 'f1-score': 0.32387688605538006, 'support': 3504246}, 'weighted avg': {'precision': 0.3365853841407629, 'recall': 0.337629549980224, 'f1-score': 0.32432185840394284, 'support': 3504246}}
[[223273 602345 343954]
 [226067 610608 349775]
 [218453 580515 349256]]
Evaluating performance on  train set...
5475/5475 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103332
{'0': {'precision': 0.34241360459985115, 'recall': 0.22164289185801622, 'f1-score': 0.26909907788184567, 'support': 469124}, '1': {'precision': 0.3445031201804874, 'recall': 0.4458102838974403, 'f1-score': 0.38866361880931294, 'support': 465485}, '2': {'precision': 0.3398205979396006, 'recall': 0.3606177870767544, 'f1-score': 0.34991044081405354, 'support': 466957}, 'accuracy': 0.3423948640306628, 'macro avg': {'precision': 0.34224577423997965, 'recall': 0.3426903209440703, 'f1-score': 0.33589104583507073, 'support': 1401566}, 'weighted avg': {'precision': 0.34224366294102226, 'recall': 0.3423948640306628, 'f1-score': 0.33573235232939724, 'support': 1401566}}
[[103978 197939 167207]
 [ 98032 207518 159935]
 [101652 196912 168393]]
Evaluating performance on  val set...
2036/2036 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004176
{'0': {'precision': 0.3461615514063627, 'recall': 0.20163958339411267, 'f1-score': 0.25483653310817533, 'support': 171385}, '1': {'precision': 0.36006666477891, 'recall': 0.5013433214114732, 'f1-score': 0.41911986288469505, 'support': 177545}, '2': {'precision': 0.34020565287035603, 'recall': 0.3439397281264874, 'f1-score': 0.34206250018039447, 'support': 172286}, 'accuracy': 0.3507662849950884, 'macro avg': {'precision': 0.3488112896852096, 'recall': 0.34897421097735776, 'f1-score': 0.33867296539108827, 'support': 521216}, 'weighted avg': {'precision': 0.34892943539026666, 'recall': 0.35076628499508844, 'f1-score': 0.339629587711596, 'support': 521216}}
[[34558 78294 58533]
 [32146 89011 56388]
 [33128 79902 59256]]
training model: results/universal/W3/deepVOL_L3/h300
Epoch 1/50
10532/10532 - 634s - loss: 3.2798 - accuracy300: 0.3681 - val_loss: 3.3219 - val_accuracy300: 0.3419 - 634s/epoch - 60ms/step
Epoch 2/50
10532/10532 - 623s - loss: 3.2659 - accuracy300: 0.3802 - val_loss: 3.3303 - val_accuracy300: 0.3411 - 623s/epoch - 59ms/step
Epoch 3/50
10532/10532 - 565s - loss: 3.2549 - accuracy300: 0.3893 - val_loss: 3.3273 - val_accuracy300: 0.3377 - 565s/epoch - 54ms/step
Epoch 4/50
10532/10532 - 564s - loss: 3.2452 - accuracy300: 0.3956 - val_loss: 3.3424 - val_accuracy300: 0.3364 - 564s/epoch - 54ms/step
Epoch 5/50
10532/10532 - 568s - loss: 3.2403 - accuracy300: 0.3984 - val_loss: 3.3435 - val_accuracy300: 0.3355 - 568s/epoch - 54ms/step
Epoch 6/50
10532/10532 - 564s - loss: 3.2364 - accuracy300: 0.4006 - val_loss: 3.3331 - val_accuracy300: 0.3400 - 564s/epoch - 54ms/step
Epoch 7/50
10532/10532 - 592s - loss: 3.2333 - accuracy300: 0.4024 - val_loss: 3.3347 - val_accuracy300: 0.3417 - 592s/epoch - 56ms/step
Epoch 8/50
10532/10532 - 586s - loss: 3.2302 - accuracy300: 0.4044 - val_loss: 3.3673 - val_accuracy300: 0.3419 - 586s/epoch - 56ms/step
Epoch 9/50
10532/10532 - 589s - loss: 3.2272 - accuracy300: 0.4067 - val_loss: 3.3796 - val_accuracy300: 0.3442 - 589s/epoch - 56ms/step
Epoch 10/50
10532/10532 - 577s - loss: 3.2250 - accuracy300: 0.4077 - val_loss: 3.3576 - val_accuracy300: 0.3456 - 577s/epoch - 55ms/step
Epoch 11/50
10532/10532 - 584s - loss: 3.2230 - accuracy300: 0.4089 - val_loss: 3.3566 - val_accuracy300: 0.3460 - 584s/epoch - 55ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 808s - 808s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051316
{'0': {'precision': 0.34165003997972004, 'recall': 0.7988727189388948, 'f1-score': 0.4786136782100936, 'support': 2373676}, '1': {'precision': 0.3373698685952939, 'recall': 0.17194282790391685, 'f1-score': 0.22779062707280281, 'support': 2407748}, '2': {'precision': 0.3781606145522557, 'recall': 0.05069991883049978, 'f1-score': 0.08941234256955859, 'support': 2305053}, 'accuracy': 0.3425010763458345, 'macro avg': {'precision': 0.3523935077090899, 'recall': 0.34050515522443714, 'f1-score': 0.26527221595081835, 'support': 7086477}, 'weighted avg': {'precision': 0.3520717538101097, 'recall': 0.3425010763458345, 'f1-score': 0.26679496969640876, 'support': 7086477}}
[[1896265  384816   92595]
 [1894176  413995   99577]
 [1759873  428314  116866]]
Evaluating performance on  train set...
10532/10532 - 330s - 330s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1079595
{'0': {'precision': 0.3438244554898209, 'recall': 0.8278606054053577, 'f1-score': 0.485862167872148, 'support': 906434}, '1': {'precision': 0.34170817828992117, 'recall': 0.15470144302725516, 'f1-score': 0.2129803533436723, 'support': 883282}, '2': {'precision': 0.3724075902934537, 'recall': 0.0466111608975689, 'f1-score': 0.0828523786169691, 'support': 906092}, 'accuracy': 0.3447129765918048, 'macro avg': {'precision': 0.35264674135773194, 'recall': 0.34305773644339393, 'f1-score': 0.2605649666109298, 'support': 2695808}, 'weighted avg': {'precision': 0.35273817643093075, 'recall': 0.3447129765918048, 'f1-score': 0.26099617561077604, 'support': 2695808}}
[[750401 123827  32206]
 [707669 136645  38968]
 [724442 139416  42234]]
Evaluating performance on  val set...
3814/3814 - 114s - 114s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1070776
{'0': {'precision': 0.3377464770598497, 'recall': 0.8164646197419817, 'f1-score': 0.47782948842885636, 'support': 321295}, '1': {'precision': 0.35811859083513076, 'recall': 0.17044523354274788, 'f1-score': 0.23096399729110273, 'support': 333151}, '2': {'precision': 0.3633249544087929, 'recall': 0.045872758557386845, 'f1-score': 0.08146046462799095, 'support': 321389}, 'accuracy': 0.3421203379669719, 'macro avg': {'precision': 0.35306334076792445, 'recall': 0.3442608706140388, 'f1-score': 0.2634179834493167, 'support': 975835}, 'weighted avg': {'precision': 0.35312574848693334, 'recall': 0.3421203379669719, 'f1-score': 0.2630061531023205, 'support': 975835}}
[[262326  47734  11235]
 [261767  56784  14600]
 [252602  54044  14743]]
testing model out of sample: results/universal/W3/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 481s - 481s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021658
{'0': {'precision': 0.33833124129735903, 'recall': 0.7404425631016768, 'f1-score': 0.46444370536628926, 'support': 1365455}, '1': {'precision': 0.35879478418854915, 'recall': 0.22475127674748407, 'f1-score': 0.2763777916943353, 'support': 1463876}, '2': {'precision': 0.3386888153483443, 'recall': 0.05989678165632851, 'f1-score': 0.10179178663158024, 'support': 1307132}, 'accuracy': 0.3428876312927252, 'macro avg': {'precision': 0.3452716136114175, 'recall': 0.3416968738351631, 'f1-score': 0.2808710945640683, 'support': 4136463}, 'weighted avg': {'precision': 0.3456861930515017, 'recall': 0.3428876312927252, 'f1-score': 0.28328915248331105, 'support': 4136463}}
[[1011041  286548   67866]
 [1049862  329008   85006]
 [ 927414  301425   78293]]
Evaluating performance on  train set...
6181/6181 - 191s - 191s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073978
{'0': {'precision': 0.3411218972415698, 'recall': 0.7832846557309806, 'f1-score': 0.47526501359634976, 'support': 526594}, '1': {'precision': 0.3487215651640924, 'recall': 0.20287648962439225, 'f1-score': 0.25651797131135123, 'support': 521608}, '2': {'precision': 0.3542449829391013, 'recall': 0.04591770758173487, 'f1-score': 0.08129752185403875, 'support': 533585}, 'accuracy': 0.3431536610175706, 'macro avg': {'precision': 0.3480294817815878, 'recall': 0.3440262843123693, 'f1-score': 0.27102683558724655, 'support': 1581787}, 'weighted avg': {'precision': 0.34805477080017694, 'recall': 0.3431536610175706, 'f1-score': 0.27023402566086, 'support': 1581787}}
[[412473  93821  20300]
 [391423 105822  24363]
 [405270 103814  24501]]
Evaluating performance on  val set...
2209/2209 - 68s - 68s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034853
{'0': {'precision': 0.3460353999557679, 'recall': 0.7646520964597445, 'f1-score': 0.4764556995183413, 'support': 190297}, '1': {'precision': 0.35051546391752575, 'recall': 0.2150315440128994, 'f1-score': 0.26654506292023633, 'support': 191637}, '2': {'precision': 0.3436761340186846, 'recall': 0.05011160225830452, 'f1-score': 0.08746926400725727, 'support': 182792}, 'accuracy': 0.3468567057298584, 'macro avg': {'precision': 0.34674233263065934, 'recall': 0.34326508091031616, 'f1-score': 0.27682334214861165, 'support': 564726}, 'weighted avg': {'precision': 0.34679203428510297, 'recall': 0.3468567057298584, 'f1-score': 0.27931539929187194, 'support': 564726}}
[[145511  36811   7975]
 [140911  41208   9518]
 [134087  39545   9160]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1067711
{'0': {'precision': 0.3006189724030769, 'recall': 0.8906368893623497, 'f1-score': 0.44951274542748787, 'support': 52568}, '1': {'precision': 0.42957208354559345, 'recall': 0.0916401771402179, 'f1-score': 0.1510557782305918, 'support': 73614}, '2': {'precision': 0.26104830421377184, 'recall': 0.010760432111840712, 'f1-score': 0.020668890878020995, 'support': 47210}, 'accuracy': 0.3118540647780751, 'macro avg': {'precision': 0.3304131200541474, 'recall': 0.3310124995381361, 'f1-score': 0.20707913817870024, 'support': 173392}, 'weighted avg': {'precision': 0.34459229919109546, 'recall': 0.3118540647780751, 'f1-score': 0.2060394043476651, 'support': 173392}}
[[46819  5137   612]
 [66042  6746   826]
 [42881  3821   508]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1127547
{'0': {'precision': 0.3312838934751822, 'recall': 0.8760104123852582, 'f1-score': 0.48075790423438897, 'support': 21897}, '1': {'precision': 0.3315360336664913, 'recall': 0.11453364226977421, 'f1-score': 0.17025156170859365, 'support': 22011}, '2': {'precision': 0.3560145808019441, 'recall': 0.013068105793675571, 'f1-score': 0.025210807090001723, 'support': 22421}, 'accuracy': 0.33161965354520645, 'macro avg': {'precision': 0.33961150264787254, 'recall': 0.334537386816236, 'f1-score': 0.2254067576776614, 'support': 66329}, 'weighted avg': {'precision': 0.3397272078369883, 'recall': 0.33161965354520645, 'f1-score': 0.22373041142717665, 'support': 66329}}
[[19182  2474   241]
 [19201  2521   289]
 [19519  2609   293]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041485
{'0': {'precision': 0.33654360620652757, 'recall': 0.8583515283842795, 'f1-score': 0.4835114151741102, 'support': 7328}, '1': {'precision': 0.35932085932085933, 'recall': 0.12829395026599036, 'f1-score': 0.1890783116054335, 'support': 8083}, '2': {'precision': 0.329608938547486, 'recall': 0.018089835965046756, 'f1-score': 0.03429734050283389, 'support': 6523}, 'accuracy': 0.33942737302817544, 'macro avg': {'precision': 0.34182446802495764, 'recall': 0.3349117715384389, 'f1-score': 0.2356290224274592, 'support': 21934}, 'weighted avg': {'precision': 0.3428750414113792, 'recall': 0.33942737302817544, 'f1-score': 0.24141575614126853, 'support': 21934}}
[[6290  932  106]
 [6912 1037  134]
 [5488  917  118]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991573
{'0': {'precision': 0.3450768222837458, 'recall': 0.8073043707561474, 'f1-score': 0.48348936716232294, 'support': 121352}, '1': {'precision': 0.3730562160094012, 'recall': 0.20209489969649863, 'f1-score': 0.2621667819005915, 'support': 135090}, '2': {'precision': 0.3458856345885635, 'recall': 0.0373656176050908, 'f1-score': 0.06744520876659735, 'support': 112831}, 'accuracy': 0.3506484362517704, 'macro avg': {'precision': 0.35467289096057014, 'recall': 0.3489216293525789, 'f1-score': 0.27103378594317057, 'support': 369273}, 'weighted avg': {'precision': 0.35555956919338627, 'recall': 0.3506484362517704, 'f1-score': 0.27540172880545577, 'support': 369273}}
[[ 97968  19920   3464]
 [103280  27301   4509]
 [ 82654  25961   4216]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1054962
{'0': {'precision': 0.3574464086960293, 'recall': 0.8671494196444226, 'f1-score': 0.5062232594321276, 'support': 57034}, '1': {'precision': 0.3368416530629779, 'recall': 0.1513969608619258, 'f1-score': 0.20890114428059517, 'support': 51791}, '2': {'precision': 0.3601642710472279, 'recall': 0.015873303167420815, 'f1-score': 0.030406518158966805, 'support': 55250}, 'accuracy': 0.3545634618314795, 'macro avg': {'precision': 0.3514841109354117, 'recall': 0.3448065612245897, 'f1-score': 0.2485103072905632, 'support': 164075}, 'weighted avg': {'precision': 0.3518576291495558, 'recall': 0.3545634618314795, 'f1-score': 0.25214747322974973, 'support': 164075}}
[[49457  6911   666]
 [43058  7841   892]
 [45847  8526   877]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1094474
{'0': {'precision': 0.3405293587227497, 'recall': 0.8448109483288008, 'f1-score': 0.4854014138639314, 'support': 22798}, '1': {'precision': 0.355865138900338, 'recall': 0.1886223620395858, 'f1-score': 0.24655891255925524, 'support': 22887}, '2': {'precision': 0.38687150837988826, 'recall': 0.02267054057372018, 'f1-score': 0.042831187908307235, 'support': 24437}, 'accuracy': 0.3441288040843102, 'macro avg': {'precision': 0.36108866866765865, 'recall': 0.35203461698070226, 'f1-score': 0.25826383811049797, 'support': 70122}, 'weighted avg': {'precision': 0.361684675343724, 'recall': 0.3441288040843102, 'f1-score': 0.25321355642920745, 'support': 70122}}
[[19260  3204   334]
 [18026  4317   544]
 [19273  4610   554]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
1359/1359 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056222
{'0': {'precision': 0.29331539939985046, 'recall': 0.8423364247759848, 'f1-score': 0.43511618544092734, 'support': 102002}, '1': {'precision': 0.4717043256369099, 'recall': 0.15566511830060034, 'f1-score': 0.23408188066133595, 'support': 147252}, '2': {'precision': 0.2657643312101911, 'recall': 0.016936081260718237, 'f1-score': 0.031842941226973974, 'support': 98547}, 'accuracy': 0.3177420421447897, 'macro avg': {'precision': 0.34359468541565047, 'recall': 0.3383125414457678, 'f1-score': 0.23368033577641242, 'support': 347801}, 'weighted avg': {'precision': 0.3610353054650231, 'recall': 0.3177420421447897, 'f1-score': 0.23573759870610814, 'support': 347801}}
[[ 85920  14216   1866]
 [121585  22922   2745]
 [ 85422  11456   1669]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1144061
{'0': {'precision': 0.33018216477499296, 'recall': 0.9101120583346738, 'f1-score': 0.48456691002776175, 'support': 37302}, '1': {'precision': 0.37523471729605673, 'recall': 0.09680544715665958, 'f1-score': 0.1539053975996406, 'support': 37157}, '2': {'precision': 0.28631756756756754, 'recall': 0.008663429593662151, 'f1-score': 0.016817978865902663, 'support': 39130}, 'accuracy': 0.33352701405946, 'macro avg': {'precision': 0.3305781498795391, 'recall': 0.3385269783616651, 'f1-score': 0.21843009549776835, 'support': 113589}, 'weighted avg': {'precision': 0.3298088540257004, 'recall': 0.33352701405946, 'f1-score': 0.21526789785532213, 'support': 113589}}
[[33949  2984   369]
 [33084  3597   476]
 [35786  3005   339]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1068887
{'0': {'precision': 0.35599103111466046, 'recall': 0.90321072319202, 'f1-score': 0.5106964242437595, 'support': 12832}, '1': {'precision': 0.3734072022160665, 'recall': 0.11829749890302764, 'f1-score': 0.179673442185938, 'support': 11395}, '2': {'precision': 0.3136842105263158, 'recall': 0.012001610954490536, 'f1-score': 0.023118696664080684, 'support': 12415}, 'accuracy': 0.3571584520495606, 'macro avg': {'precision': 0.3476941479523476, 'recall': 0.34450327768317934, 'f1-score': 0.23782952103125943, 'support': 36642}, 'weighted avg': {'precision': 0.34707279772391275, 'recall': 0.3571584520495606, 'f1-score': 0.2425537363869125, 'support': 36642}}
[[11590  1085   157]
 [ 9878  1348   169]
 [11089  1177   149]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1166383
{'0': {'precision': 0.3018137158927078, 'recall': 0.9622735733418077, 'f1-score': 0.4595052340911001, 'support': 88108}, '1': {'precision': 0.42024749098704084, 'recall': 0.03896784452616077, 'f1-score': 0.07132226484984787, 'support': 110681}, '2': {'precision': 0.2576112412177986, 'recall': 0.0011851404930184452, 'f1-score': 0.002359426444880581, 'support': 92816}, 'accuracy': 0.30591725107594175, 'macro avg': {'precision': 0.3265574826991824, 'recall': 0.33414218612032903, 'f1-score': 0.17772897512860952, 'support': 291605}, 'weighted avg': {'precision': 0.3326968343981843, 'recall': 0.30591725107594175, 'f1-score': 0.1666607201044313, 'support': 291605}}
[[ 84784   3159    165]
 [106216   4313    152]
 [ 89915   2791    110]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1163242
{'0': {'precision': 0.330835734870317, 'recall': 0.9709663529556499, 'f1-score': 0.49351644142911855, 'support': 32514}, '1': {'precision': 0.3373744371319709, 'recall': 0.029908493520849965, 'f1-score': 0.054945984824979546, 'support': 32566}, '2': {'precision': 0.2616822429906542, 'recall': 0.0008398572242718738, 'f1-score': 0.0016743407283382169, 'support': 33339}, 'accuracy': 0.33095235676038165, 'macro avg': {'precision': 0.30996413833098074, 'recall': 0.33390490123359057, 'f1-score': 0.18337892232747877, 'support': 98419}, 'weighted avg': {'precision': 0.30957389632366383, 'recall': 0.33095235676038165, 'f1-score': 0.1817879206655088, 'support': 98419}}
[[31570   912    32]
 [31545   974    47]
 [32310  1001    28]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1093998
{'0': {'precision': 0.31508173668483036, 'recall': 0.9637096774193549, 'f1-score': 0.4748973373956816, 'support': 11160}, '1': {'precision': 0.3893065998329156, 'recall': 0.034044418468731734, 'f1-score': 0.06261336916358749, 'support': 13688}, '2': {'precision': 0.3, 'recall': 0.001140359213152143, 'f1-score': 0.002272081794944618, 'support': 10523}, 'accuracy': 0.3175765457578242, 'macro avg': {'precision': 0.334796112172582, 'recall': 0.3329648183670796, 'f1-score': 0.17992759611807121, 'support': 35371}, 'weighted avg': {'precision': 0.33931867687980705, 'recall': 0.3175765457578242, 'f1-score': 0.17474245000636665, 'support': 35371}}
[[10755   389    16]
 [13210   466    12]
 [10169   342    12]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
2282/2282 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047435
{'0': {'precision': 0.33787450176153977, 'recall': 0.871416369960279, 'f1-score': 0.4869454962609002, 'support': 194356}, '1': {'precision': 0.3788221731734406, 'recall': 0.13314359407657758, 'f1-score': 0.19703561792083768, 'support': 202383}, '2': {'precision': 0.32100362131401966, 'recall': 0.019881872943991113, 'f1-score': 0.03744455731340581, 'support': 187256}, 'accuracy': 0.3425269051961061, 'macro avg': {'precision': 0.3459000987496667, 'recall': 0.3414806123269492, 'f1-score': 0.24047522383171457, 'support': 583995}, 'weighted avg': {'precision': 0.34665529439550735, 'recall': 0.3425269051961061, 'f1-score': 0.24234652070177914, 'support': 583995}}
[[169365  21657   3334]
 [170896  26946   4541]
 [161005  22528   3723]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109616
{'0': {'precision': 0.3352524222335543, 'recall': 0.8846055517431612, 'f1-score': 0.48623062728580463, 'support': 74319}, '1': {'precision': 0.37784423877460294, 'recall': 0.1259956065282139, 'f1-score': 0.18897558214747737, 'support': 74201}, '2': {'precision': 0.27564102564102566, 'recall': 0.014103354630492108, 'f1-score': 0.026833743119953072, 'support': 76223}, 'accuracy': 0.3389071072291462, 'macro avg': {'precision': 0.32957922888306096, 'recall': 0.3415681709672891, 'f1-score': 0.23401331751774504, 'support': 224743}, 'weighted avg': {'precision': 0.32909692861057177, 'recall': 0.3389071072291462, 'f1-score': 0.2322817598857845, 'support': 224743}}
[[65743  7412  1164]
 [63191  9349  1661]
 [67166  7982  1075]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1075668
{'0': {'precision': 0.337141074585184, 'recall': 0.8814665216715861, 'f1-score': 0.48773464278423073, 'support': 25748}, '1': {'precision': 0.36956273547208585, 'recall': 0.12497586965754218, 'f1-score': 0.18678592036930178, 'support': 25901}, '2': {'precision': 0.31885182311869664, 'recall': 0.01598102496306089, 'f1-score': 0.030436553486133226, 'support': 25718}, 'accuracy': 0.3405069344811095, 'macro avg': {'precision': 0.34185187772532216, 'recall': 0.34080780543072975, 'f1-score': 0.23498570554655526, 'support': 77367}, 'weighted avg': {'precision': 0.34191559691920914, 'recall': 0.3405069344811095, 'f1-score': 0.23496970269559417, 'support': 77367}}
[[22696  2635   417]
 [22203  3237   461]
 [22420  2887   411]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
5098/5098 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958519
{'0': {'precision': 0.38684666939042767, 'recall': 0.6134727275847864, 'f1-score': 0.47448821275614245, 'support': 466112}, '1': {'precision': 0.3076737451737452, 'recall': 0.3100027043053037, 'f1-score': 0.3088338340503205, 'support': 403061}, '2': {'precision': 0.39248864526233357, 'recall': 0.14378135485085075, 'f1-score': 0.21046319640286681, 'support': 435738}, 'accuracy': 0.36289677993365066, 'macro avg': {'precision': 0.3623363532755021, 'recall': 0.35575226224698026, 'f1-score': 0.3312617477364433, 'support': 1304911}, 'weighted avg': {'precision': 0.3642757088228275, 'recall': 0.36289677993365066, 'f1-score': 0.3351572146181155, 'support': 1304911}}
[[285947 132304  47861]
 [228998 124950  49113]
 [224229 148858  62651]]
Evaluating performance on  train set...
1876/1876 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982612
{'0': {'precision': 0.3669129340714645, 'recall': 0.5615172277813378, 'f1-score': 0.44381999215917367, 'support': 162296}, '1': {'precision': 0.3337471128074011, 'recall': 0.3431174603174603, 'f1-score': 0.33836742616350785, 'support': 157500}, '2': {'precision': 0.36894578744099554, 'recall': 0.16079321243555617, 'f1-score': 0.22397436621063646, 'support': 160411}, 'accuracy': 0.3560256306134646, 'macro avg': {'precision': 0.3565352781066204, 'recall': 0.3551426335114514, 'f1-score': 0.335387261511106, 'support': 480207}, 'weighted avg': {'precision': 0.3567141556129453, 'recall': 0.3560256306134646, 'f1-score': 0.33579483665675874, 'support': 480207}}
[[91132 50792 20372]
 [79714 54041 23745]
 [77529 57089 25793]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096438
{'0': {'precision': 0.3530948163281139, 'recall': 0.5357976730041006, 'f1-score': 0.42566988293610586, 'support': 50967}, '1': {'precision': 0.3493990809473312, 'recall': 0.35693135449391544, 'f1-score': 0.35312505582051695, 'support': 55386}, '2': {'precision': 0.3738191632928475, 'recall': 0.17572425459928104, 'f1-score': 0.23906789413118526, 'support': 52019}, 'accuracy': 0.35497436415528, 'macro avg': {'precision': 0.3587710201894308, 'recall': 0.3561510940324324, 'f1-score': 0.3392876109626027, 'support': 158372}, 'weighted avg': {'precision': 0.35860947677919397, 'recall': 0.35497436415528, 'f1-score': 0.33900799415357374, 'support': 158372}}
[[27308 17098  6561]
 [26866 19769  8751]
 [23165 19713  9141]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
5760/5760 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097812
{'0': {'precision': 0.33587174232688455, 'recall': 0.7373159744063844, 'f1-score': 0.46151031568481227, 'support': 472149}, '1': {'precision': 0.3963926693908795, 'recall': 0.25006435760458334, 'f1-score': 0.30666749402073396, 'support': 563259}, '2': {'precision': 0.3122436882281069, 'recall': 0.0587865522715419, 'f1-score': 0.09894465677386215, 'support': 439063}, 'accuracy': 0.34913199377946397, 'macro avg': {'precision': 0.3481693666486237, 'recall': 0.34872229476083655, 'f1-score': 0.2890408221598028, 'support': 1474471}, 'weighted avg': {'precision': 0.35195530893508986, 'recall': 0.34913199377946397, 'f1-score': 0.29439561571030914, 'support': 1474471}}
[[348123 102312  21714]
 [387270 140851  35138]
 [301083 112169  25811]]
Evaluating performance on  train set...
2159/2159 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056228
{'0': {'precision': 0.34696432000341365, 'recall': 0.79127741014662, 'f1-score': 0.4824019736289163, 'support': 184968}, '1': {'precision': 0.3428615645112837, 'recall': 0.2068145626269837, 'f1-score': 0.2580019797300306, 'support': 182110}, '2': {'precision': 0.3760368221700149, 'recall': 0.042289214444007094, 'f1-score': 0.07602826704407759, 'support': 185461}, 'accuracy': 0.3472460767475237, 'macro avg': {'precision': 0.35528756889490404, 'recall': 0.3467937290725369, 'f1-score': 0.27214407346767483, 'support': 552539}, 'weighted avg': {'precision': 0.35537035563465097, 'recall': 0.3472460767475237, 'f1-score': 0.2720422399524576, 'support': 552539}}
[[146361  32995   5612]
 [137045  37663   7402]
 [138427  39191   7843]]
Evaluating performance on  val set...
850/850 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030507
{'0': {'precision': 0.3431426917334471, 'recall': 0.7843432232901518, 'f1-score': 0.477419081332005, 'support': 71790}, '1': {'precision': 0.3605781099216769, 'recall': 0.21293203986429177, 'f1-score': 0.26774986460025824, 'support': 75456}, '2': {'precision': 0.34760096651708666, 'recall': 0.04309619252771081, 'f1-score': 0.07668485848457926, 'support': 70099}, 'accuracy': 0.3468954887391014, 'macro avg': {'precision': 0.3504405893907369, 'recall': 0.3467904852273848, 'f1-score': 0.2739512681389475, 'support': 217345}, 'weighted avg': {'precision': 0.3506336738994477, 'recall': 0.3468954887391014, 'f1-score': 0.27538145127337754, 'support': 217345}}
[[56308 13113  2369]
 [56088 16067  3301]
 [51699 15379  3021]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
6315/6315 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992825
{'0': {'precision': 0.3689940797134408, 'recall': 0.6932743312625875, 'f1-score': 0.4816374490852904, 'support': 564048}, '1': {'precision': 0.3299560698984782, 'recall': 0.27907881398642137, 'f1-score': 0.30239236237998735, 'support': 521849}, '2': {'precision': 0.37462384986948566, 'recall': 0.08142381890320331, 'f1-score': 0.1337724391429695, 'support': 530545}, 'accuracy': 0.3587360387814719, 'macro avg': {'precision': 0.3578579998271349, 'recall': 0.35125898805073735, 'f1-score': 0.3059340835360824, 'support': 1616442}, 'weighted avg': {'precision': 0.3582389149896279, 'recall': 0.3587360387814719, 'f1-score': 0.30959483267720134, 'support': 1616442}}
[[391040 139176  33832]
 [337930 145637  38282]
 [330776 156570  43199]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030698
{'0': {'precision': 0.3476729816624253, 'recall': 0.726196400544676, 'f1-score': 0.47022267704657683, 'support': 182861}, '1': {'precision': 0.33437370262736493, 'recall': 0.24876727742049354, 'f1-score': 0.28528688083897863, 'support': 181306}, '2': {'precision': 0.38763866877971476, 'recall': 0.07179758130797229, 'f1-score': 0.12115508445192925, 'support': 187374}, 'accuracy': 0.3469352233106877, 'macro avg': {'precision': 0.35656178435650165, 'recall': 0.348920419757714, 'f1-score': 0.29222154744582823, 'support': 551541}, 'weighted avg': {'precision': 0.3568786283381653, 'recall': 0.3469352233106877, 'f1-score': 0.29084134263618067, 'support': 551541}}
[[132793  40667   9401]
 [124352  45103  11851]
 [124803  49118  13453]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103349
{'0': {'precision': 0.3533871544327931, 'recall': 0.7303033567789697, 'f1-score': 0.47629802504454316, 'support': 64973}, '1': {'precision': 0.31899815124570824, 'recall': 0.2352578357058222, 'f1-score': 0.2708019991592321, 'support': 61609}, '2': {'precision': 0.3784175267065001, 'recall': 0.06513744312161067, 'f1-score': 0.11114360924246855, 'support': 64172}, 'accuracy': 0.3466454176583453, 'macro avg': {'precision': 0.35026761079500046, 'recall': 0.34356621186880093, 'f1-score': 0.28608121114874796, 'support': 190754}, 'weighted avg': {'precision': 0.35070085140478435, 'recall': 0.3466454176583453, 'f1-score': 0.2870852492725076, 'support': 190754}}
[[47450 14302  3221]
 [43470 14494  3645]
 [43352 16640  4180]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
6082/6082 - 90s - 90s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104018
{'0': {'precision': 0.36039800240923486, 'recall': 0.6638928689518351, 'f1-score': 0.46718304433591784, 'support': 544380}, '1': {'precision': 0.30970593074915964, 'recall': 0.27599671532235087, 'f1-score': 0.29188128199845365, 'support': 477368}, '2': {'precision': 0.3621156268956185, 'recall': 0.08702453574952902, 'f1-score': 0.14032565750811432, 'support': 535056}, 'accuracy': 0.34668782968183537, 'macro avg': {'precision': 0.34407318668467096, 'recall': 0.34230470667457163, 'f1-score': 0.2997966612808286, 'support': 1556804}, 'weighted avg': {'precision': 0.34544445168798776, 'recall': 0.34668782968183537, 'f1-score': 0.30109247824664276, 'support': 1556804}}
[[361410 142406  40564]
 [304157 131752  41459]
 [337241 151252  46563]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1064875
{'0': {'precision': 0.3418248565254769, 'recall': 0.7069310165875411, 'f1-score': 0.4608252492568497, 'support': 208108}, '1': {'precision': 0.34564157880543805, 'recall': 0.2549422934181993, 'f1-score': 0.2934433003506734, 'support': 206129}, '2': {'precision': 0.34785805778262724, 'recall': 0.0697171381031614, 'f1-score': 0.11615473569154244, 'support': 210350}, 'accuracy': 0.3431611608951195, 'macro avg': {'precision': 0.3451081643711807, 'recall': 0.34386348270296724, 'f1-score': 0.2901410950996885, 'support': 624587}, 'weighted avg': {'precision': 0.34511634519124756, 'recall': 0.3431611608951195, 'f1-score': 0.28950609552079115, 'support': 624587}}
[[147118  48316  12674]
 [138759  52551  14819]
 [144513  51172  14665]]
Evaluating performance on  val set...
826/826 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015818
{'0': {'precision': 0.35317503421607177, 'recall': 0.671786112756374, 'f1-score': 0.4629601503616653, 'support': 72599}, '1': {'precision': 0.3347066492829205, 'recall': 0.2719414705799271, 'f1-score': 0.30007714666438084, 'support': 70802}, '2': {'precision': 0.34829329962073324, 'recall': 0.08098534620868057, 'f1-score': 0.1314141932098692, 'support': 68037}, 'accuracy': 0.3477851663371769, 'macro avg': {'precision': 0.34539166103990854, 'recall': 0.3415709765149939, 'f1-score': 0.2981504967453051, 'support': 211438}, 'weighted avg': {'precision': 0.34541986642835143, 'recall': 0.3477851663371769, 'f1-score': 0.3017316355511209, 'support': 211438}}
[[48771 19045  4783]
 [46021 19254  5527]
 [43301 19226  5510]]
testing model on single stock: results/universal/W3/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
13689/13689 - 216s - 216s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11096
{'0': {'precision': 0.3253398533805225, 'recall': 0.9142599659981517, 'f1-score': 0.4799052059213898, 'support': 1134056}, '1': {'precision': 0.37617113036894834, 'recall': 0.08996844956659583, 'f1-score': 0.14520772244093846, 'support': 1237067}, '2': {'precision': 0.32188561589650516, 'recall': 0.006104368193038179, 'f1-score': 0.011981514136350567, 'support': 1133123}, 'accuracy': 0.32961042118618383, 'macro avg': {'precision': 0.341132199881992, 'recall': 0.3367775945859286, 'f1-score': 0.21236481416622624, 'support': 3504246}, 'weighted avg': {'precision': 0.34216733050103254, 'recall': 0.32961042118618383, 'f1-score': 0.21044401249968067, 'support': 3504246}}
[[1036822   90615    6619]
 [1117817  111297    7953]
 [1032250   93956    6917]]
Evaluating performance on  train set...
5475/5475 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129003
{'0': {'precision': 0.33806336558527794, 'recall': 0.9443621231681749, 'f1-score': 0.49789128567588675, 'support': 471729}, '1': {'precision': 0.36835950551286334, 'recall': 0.062299100884771114, 'f1-score': 0.10657381812368365, 'support': 460119}, '2': {'precision': 0.3052684228076025, 'recall': 0.0038980835309696455, 'f1-score': 0.007697870157825257, 'support': 469718}, 'accuracy': 0.3396051274074856, 'macro avg': {'precision': 0.3372304313019146, 'recall': 0.3368531025279719, 'f1-score': 0.20405432465246523, 'support': 1401566}, 'weighted avg': {'precision': 0.3370184306166047, 'recall': 0.3396051274074856, 'f1-score': 0.20514355021215191, 'support': 1401566}}
[[445483  24427   1819]
 [429106  28665   2348]
 [443161  24726   1831]]
Evaluating performance on  val set...
2036/2036 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1112292
{'0': {'precision': 0.3321989628210592, 'recall': 0.9186566859396605, 'f1-score': 0.4879488669378268, 'support': 171397}, '1': {'precision': 0.40507726269315675, 'recall': 0.09809501005117467, 'f1-score': 0.15794216139400813, 'support': 179581}, '2': {'precision': 0.2456, 'recall': 0.005410072956684171, 'f1-score': 0.010586937030140008, 'support': 170238}, 'accuracy': 0.33765655697445973, 'macro avg': {'precision': 0.3276254085047387, 'recall': 0.3407205896491731, 'f1-score': 0.21882598845399162, 'support': 521216}, 'weighted avg': {'precision': 0.3290239331531282, 'recall': 0.33765655697445973, 'f1-score': 0.218333056195468, 'support': 521216}}
[[157455  12890   1052]
 [160188  17616   1777]
 [156335  12982    921]]
training model: results/universal/W3/deepVOL_L3/h500
Epoch 1/50
10532/10532 - 625s - loss: 3.2719 - accuracy500: 0.3766 - val_loss: 3.3091 - val_accuracy500: 0.3387 - 625s/epoch - 59ms/step
Epoch 2/50
10532/10532 - 583s - loss: 3.2679 - accuracy500: 0.3778 - val_loss: 3.3201 - val_accuracy500: 0.3440 - 583s/epoch - 55ms/step
Epoch 3/50
10532/10532 - 592s - loss: 3.2639 - accuracy500: 0.3816 - val_loss: 3.3205 - val_accuracy500: 0.3420 - 592s/epoch - 56ms/step
Epoch 4/50
10532/10532 - 586s - loss: 3.2590 - accuracy500: 0.3867 - val_loss: 3.3392 - val_accuracy500: 0.3412 - 586s/epoch - 56ms/step
Epoch 5/50
10532/10532 - 595s - loss: 3.2517 - accuracy500: 0.3927 - val_loss: 3.3477 - val_accuracy500: 0.3421 - 595s/epoch - 56ms/step
Epoch 6/50
10532/10532 - 584s - loss: 3.2464 - accuracy500: 0.3966 - val_loss: 3.3369 - val_accuracy500: 0.3455 - 584s/epoch - 55ms/step
Epoch 7/50
10532/10532 - 598s - loss: 3.2415 - accuracy500: 0.3995 - val_loss: 3.3439 - val_accuracy500: 0.3446 - 598s/epoch - 57ms/step
Epoch 8/50
10532/10532 - 595s - loss: 3.2379 - accuracy500: 0.4015 - val_loss: 3.3492 - val_accuracy500: 0.3459 - 595s/epoch - 56ms/step
Epoch 9/50
10532/10532 - 591s - loss: 3.2351 - accuracy500: 0.4026 - val_loss: 3.3529 - val_accuracy500: 0.3474 - 591s/epoch - 56ms/step
Epoch 10/50
10532/10532 - 594s - loss: 3.2304 - accuracy500: 0.4056 - val_loss: 3.3688 - val_accuracy500: 0.3455 - 594s/epoch - 56ms/step
Epoch 11/50
10532/10532 - 594s - loss: 3.2276 - accuracy500: 0.4073 - val_loss: 3.3368 - val_accuracy500: 0.3493 - 594s/epoch - 56ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 824s - 824s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026706
{'0': {'precision': 0.3448996967892788, 'recall': 0.29564549759243614, 'f1-score': 0.31837891649525574, 'support': 2451233}, '1': {'precision': 0.3078131134668237, 'recall': 0.0003425529897579278, 'f1-score': 0.0006843443998107579, 'support': 2288697}, '2': {'precision': 0.33177174616993704, 'recall': 0.7044972889952769, 'f1-score': 0.4511035026819758, 'support': 2346547}, 'accuracy': 0.33565564384107927, 'macro avg': {'precision': 0.3281615188086799, 'recall': 0.3334951131924903, 'f1-score': 0.25672225452568076, 'support': 7086477}, 'weighted avg': {'precision': 0.3285748988491574, 'recall': 0.33565564384107927, 'f1-score': 0.25972323546666576, 'support': 7086477}}
[[ 724696     982 1725555]
 [ 683853     784 1604060]
 [ 692630     781 1653136]]
Evaluating performance on  train set...
10532/10532 - 335s - 335s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103401
{'0': {'precision': 0.3325184315386244, 'recall': 0.3053956727215269, 'f1-score': 0.3183804509537279, 'support': 905003}, '1': {'precision': 0.30514285714285716, 'recall': 0.00030073765201612493, 'f1-score': 0.0006008830956056767, 'support': 887817}, '2': {'precision': 0.33669501633535415, 'recall': 0.6949317155931197, 'f1-score': 0.4536137695776649, 'support': 902988}, 'accuracy': 0.3353970312425811, 'macro avg': {'precision': 0.3247854350056119, 'recall': 0.33354270865555424, 'f1-score': 0.2575317012089995, 'support': 2695808}, 'weighted avg': {'precision': 0.32490175617417055, 'recall': 0.3353970312425811, 'f1-score': 0.2590230936495345, 'support': 2695808}}
[[276384    292 628327]
 [279643    267 607907]
 [275157    316 627515]]
Evaluating performance on  val set...
3814/3814 - 116s - 116s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023703
{'0': {'precision': 0.33647294715140547, 'recall': 0.3238582396108728, 'f1-score': 0.3300451001729405, 'support': 330586}, '1': {'precision': 0.3344594594594595, 'recall': 0.00031362063940595816, 'f1-score': 0.0006266536694053753, 'support': 315668}, '2': {'precision': 0.3396820857172848, 'recall': 0.6774935448341985, 'f1-score': 0.4524929883436279, 'support': 329581}, 'accuracy': 0.33863409285381235, 'macro avg': {'precision': 0.33687149744271655, 'recall': 0.33388846836149244, 'f1-score': 0.2610549140619913, 'support': 975835}, 'weighted avg': {'precision': 0.336905476692711, 'recall': 0.33863409285381235, 'f1-score': 0.2648390307660278, 'support': 975835}}
[[107063     99 223424]
 [104935     99 210634]
 [106194     98 223289]]
testing model out of sample: results/universal/W3/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 473s - 473s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995048
{'0': {'precision': 0.3650908285334515, 'recall': 0.28041705405041184, 'f1-score': 0.31720044746277365, 'support': 1469258}, '1': {'precision': 0.2555018786902845, 'recall': 0.00037290018417822124, 'f1-score': 0.0007447134730557659, 'support': 1276481}, '2': {'precision': 0.34133229100828316, 'recall': 0.7378020369246522, 'f1-score': 0.46673644430616285, 'support': 1390724}, 'accuracy': 0.347775382011153, 'macro avg': {'precision': 0.32064166607733974, 'recall': 0.33953066371974744, 'f1-score': 0.26156053508066407, 'support': 4136463}, 'weighted avg': {'precision': 0.32328463308920175, 'recall': 0.347775382011153, 'f1-score': 0.2698202503946738, 'support': 4136463}}
[[ 412005     711 1056542]
 [ 352526     476  923479]
 [ 363969     676 1026079]]
Evaluating performance on  train set...
6181/6181 - 189s - 189s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103484
{'0': {'precision': 0.3327558349628554, 'recall': 0.29808475027578074, 'f1-score': 0.31446752884546897, 'support': 525780}, '1': {'precision': 0.37167070217917675, 'recall': 0.0005873158898600963, 'f1-score': 0.001172778549230913, 'support': 522717}, '2': {'precision': 0.33910018703309297, 'recall': 0.7057867201710138, 'f1-score': 0.45810203413471073, 'support': 533290}, 'accuracy': 0.337228084438676, 'macro avg': {'precision': 0.3478422413917084, 'recall': 0.33481959544555157, 'f1-score': 0.2579141138431369, 'support': 1581787}, 'weighted avg': {'precision': 0.3477545940639548, 'recall': 0.337228084438676, 'f1-score': 0.25936172340839125, 'support': 1581787}}
[[156727    271 368782]
 [157617    307 364793]
 [156653    248 376389]]
Evaluating performance on  val set...
2209/2209 - 80s - 80s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991076
{'0': {'precision': 0.3690506329113924, 'recall': 0.29025835034098263, 'f1-score': 0.32494636239516284, 'support': 200890}, '1': {'precision': 0.34220532319391633, 'recall': 0.0005207790855119259, 'f1-score': 0.0010399755027992676, 'support': 172818}, '2': {'precision': 0.3406829157881529, 'recall': 0.7249316818310316, 'f1-score': 0.4635293841979913, 'support': 191018}, 'accuracy': 0.348620392898503, 'macro avg': {'precision': 0.3506462906311539, 'recall': 0.33857027041917537, 'f1-score': 0.2631719073653178, 'support': 564726}, 'weighted avg': {'precision': 0.3512400534016802, 'recall': 0.348620392898503, 'f1-score': 0.27269978208678003, 'support': 564726}}
[[ 58310     78 142502]
 [ 47242     90 125486]
 [ 52448     95 138475]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
678/678 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1247853
{'0': {'precision': 0.31151875421673564, 'recall': 0.3359024773889107, 'f1-score': 0.32325143565339964, 'support': 50860}, '1': {'precision': 0.64, 'recall': 0.0004149700443499235, 'f1-score': 0.0008294023119589446, 'support': 77114}, '2': {'precision': 0.2678627184580721, 'recall': 0.6988859042670307, 'f1-score': 0.3872888438802091, 'support': 45418}, 'accuracy': 0.28177770600719754, 'macro avg': {'precision': 0.4064604908916025, 'recall': 0.34506778390009707, 'f1-score': 0.2371232272818559, 'support': 173392}, 'weighted avg': {'precision': 0.4461716387514527, 'recall': 0.28177770600719754, 'f1-score': 0.19663197413126124, 'support': 173392}}
[[17084    16 33760]
 [24083    32 52999]
 [13674     2 31742]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043366
{'0': {'precision': 0.3067006445810223, 'recall': 0.2807226160530528, 'f1-score': 0.2931372080806151, 'support': 21865}, '1': {'precision': 0.42857142857142855, 'recall': 0.0002737476047084588, 'f1-score': 0.0005471457231442641, 'support': 21918}, '2': {'precision': 0.33702647833786875, 'recall': 0.6921405127295307, 'f1-score': 0.4533174529398094, 'support': 22546}, 'accuracy': 0.3278957921874293, 'macro avg': {'precision': 0.3574328504967732, 'recall': 0.324378958795764, 'f1-score': 0.24900060224785625, 'support': 66329}, 'weighted avg': {'precision': 0.35728018130528444, 'recall': 0.3278957921874293, 'f1-score': 0.2508997978052355, 'support': 66329}}
[[ 6138     3 15724]
 [ 6939     6 14973]
 [ 6936     5 15605]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198268
{'0': {'precision': 0.3281539030706622, 'recall': 0.2478345906677843, 'f1-score': 0.28239414199299584, 'support': 7158}, '1': {'precision': 0.23076923076923078, 'recall': 0.0003439972480220158, 'f1-score': 0.0006869704602702084, 'support': 8721}, '2': {'precision': 0.2724795640326976, 'recall': 0.7431874483897605, 'f1-score': 0.3987594151528578, 'support': 6055}, 'accuracy': 0.2861767119540439, 'macro avg': {'precision': 0.27713423262419684, 'recall': 0.3304553454351889, 'f1-score': 0.22728017586870797, 'support': 21934}, 'weighted avg': {'precision': 0.27406436855731947, 'recall': 0.2861767119540439, 'f1-score': 0.20251010287774387, 'support': 21934}}
[[1774    5 5379]
 [2082    3 6636]
 [1550    5 4500]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0920501
{'0': {'precision': 0.3672534430720786, 'recall': 0.45989152561675234, 'f1-score': 0.4083848723402238, 'support': 140494}, '1': {'precision': 0.336734693877551, 'recall': 0.0003323831874540455, 'f1-score': 0.0006641108461375917, 'support': 99283}, '2': {'precision': 0.35136254023452457, 'recall': 0.5243250756780132, 'f1-score': 0.4207623521246336, 'support': 129496}, 'accuracy': 0.3589295724301533, 'macro avg': {'precision': 0.3517835590613847, 'recall': 0.32818299482740654, 'f1-score': 0.27660377843699835, 'support': 369273}, 'weighted avg': {'precision': 0.3534755569820255, 'recall': 0.3589295724301533, 'f1-score': 0.3031052926220873, 'support': 369273}}
[[64612    47 75835]
 [49741    33 49509]
 [61580    18 67898]]
Evaluating performance on  train set...
641/641 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044905
{'0': {'precision': 0.33563812754248845, 'recall': 0.5168383373511579, 'f1-score': 0.4069805066403975, 'support': 54756}, '1': {'precision': 0.38461538461538464, 'recall': 0.00017951065395731237, 'f1-score': 0.00035885382089605796, 'support': 55707}, '2': {'precision': 0.33284001404705765, 'recall': 0.49500111915242856, 'f1-score': 0.3980381569474442, 'support': 53612}, 'accuracy': 0.3342861496266951, 'macro avg': {'precision': 0.3510311754016436, 'recall': 0.33733965571918123, 'f1-score': 0.26845917246957923, 'support': 164075}, 'weighted avg': {'precision': 0.3513526702762552, 'recall': 0.3342861496266951, 'f1-score': 0.26600174896643997, 'support': 164075}}
[[28300    11 26445]
 [28948    10 26749]
 [27069     5 26538]]
Evaluating performance on  val set...
274/274 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929664
{'0': {'precision': 0.3516943401348233, 'recall': 0.645184047806781, 'f1-score': 0.4552362268128779, 'support': 24097}, '1': {'precision': 0.3333333333333333, 'recall': 9.96512207274539e-05, 'f1-score': 0.00019924287706714485, 'support': 20070}, '2': {'precision': 0.39760710150521034, 'recall': 0.39691774224619536, 'f1-score': 0.3972621228188567, 'support': 25955}, 'accuracy': 0.36865748267305554, 'macro avg': {'precision': 0.36087825832445564, 'recall': 0.3474004804245679, 'f1-score': 0.28423253083626726, 'support': 70122}, 'weighted avg': {'precision': 0.363433313850098, 'recall': 0.36865748267305554, 'f1-score': 0.3035390399563059, 'support': 70122}}
[[15547     1  8549]
 [13009     2  7059]
 [15650     3 10302]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
1359/1359 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1221032
{'0': {'precision': 0.31300170579971903, 'recall': 0.25168935955622795, 'f1-score': 0.2790169836424826, 'support': 99150}, '1': {'precision': 0.39823008849557523, 'recall': 0.0002995945487107448, 'f1-score': 0.0005987386572287714, 'support': 150203}, '2': {'precision': 0.28895730706075534, 'recall': 0.7864964245083699, 'f1-score': 0.4226381520054147, 'support': 98448}, 'accuracy': 0.2945046161454395, 'macro avg': {'precision': 0.3333963671186832, 'recall': 0.3461617928711029, 'f1-score': 0.23408462476837535, 'support': 347801}, 'weighted avg': {'precision': 0.3430028725560314, 'recall': 0.2945046161454395, 'f1-score': 0.19943113176590332, 'support': 347801}}
[[ 24955     31  74164]
 [ 33791     45 116367]
 [ 20982     37  77429]]
Evaluating performance on  train set...
444/444 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029731
{'0': {'precision': 0.3293754310215586, 'recall': 0.2939051797945205, 'f1-score': 0.31063101785739533, 'support': 37376}, '1': {'precision': 0.5357142857142857, 'recall': 0.00040011736776120996, 'f1-score': 0.0007996374976677239, 'support': 37489}, '2': {'precision': 0.34186510410173293, 'recall': 0.7081138312157835, 'f1-score': 0.46111288613853063, 'support': 38724}, 'accuracy': 0.33824578084145474, 'macro avg': {'precision': 0.4023182736125257, 'recall': 0.33413970945935506, 'f1-score': 0.2575145138311979, 'support': 113589}, 'weighted avg': {'precision': 0.4017335592199961, 'recall': 0.33824578084145474, 'f1-score': 0.2596753025065502, 'support': 113589}}
[[10985    10 26381]
 [11066    15 26408]
 [11300     3 27421]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009125
{'0': {'precision': 0.3507352215533406, 'recall': 0.2765113203143235, 'f1-score': 0.30923170625598195, 'support': 12853}, '1': {'precision': 0.7142857142857143, 'recall': 0.0004388274530454625, 'f1-score': 0.0008771160424524164, 'support': 11394}, '2': {'precision': 0.33506905139234777, 'recall': 0.7164179104477612, 'f1-score': 0.4565904825564953, 'support': 12395}, 'accuracy': 0.3394738278478249, 'macro avg': {'precision': 0.46669666241046753, 'recall': 0.33112268607171, 'f1-score': 0.2555664349516433, 'support': 36642}, 'weighted avg': {'precision': 0.45848349225491686, 'recall': 0.3394738278478249, 'f1-score': 0.2631949132684787, 'support': 36642}}
[[3554    2 9297]
 [3064    5 8325]
 [3515    0 8880]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1140/1140 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1176815
{'0': {'precision': 0.28839693905976044, 'recall': 0.41955708121766905, 'f1-score': 0.3418272218769422, 'support': 83898}, '1': {'precision': 0.8, 'recall': 3.3819774422104605e-05, 'f1-score': 6.763668952223133e-05, 'support': 118274}, '2': {'precision': 0.29782477911599214, 'recall': 0.5646126150302461, 'f1-score': 0.3899543978469297, 'support': 89433}, 'accuracy': 0.29388727902470807, 'macro avg': {'precision': 0.46207390605858417, 'recall': 0.32806783867411243, 'f1-score': 0.24394975213779804, 'support': 291605}, 'weighted avg': {'precision': 0.4987928528794648, 'recall': 0.29388727902470807, 'f1-score': 0.21797092500297566, 'support': 291605}}
[[35200     1 48697]
 [47916     4 70354]
 [38938     0 50495]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025329
{'0': {'precision': 0.33212283528904424, 'recall': 0.4562262268504084, 'f1-score': 0.38440623645462546, 'support': 32074}, '1': {'precision': 1.0, 'recall': 6.152710268873438e-05, 'f1-score': 0.00012304663467454166, 'support': 32506}, '2': {'precision': 0.34283822068508774, 'recall': 0.5507254942521942, 'f1-score': 0.4225994081431341, 'support': 33839}, 'accuracy': 0.3380546439203812, 'macro avg': {'precision': 0.5583203519913773, 'recall': 0.3356710827350971, 'f1-score': 0.269042897077478, 'support': 98419}, 'weighted avg': {'precision': 0.5563947039578078, 'recall': 0.3380546439203812, 'f1-score': 0.2706163114247036, 'support': 98419}}
[[14633     0 17441]
 [14223     2 18281]
 [15203     0 18636]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1148635
{'0': {'precision': 0.3180370985603544, 'recall': 0.41229250785105426, 'f1-score': 0.35908256163794783, 'support': 11145}, '1': {'precision': 1.0, 'recall': 7.265857734505559e-05, 'f1-score': 0.00014530659691950018, 'support': 13763}, '2': {'precision': 0.29026861676703947, 'recall': 0.5804262639778266, 'f1-score': 0.3870001593117731, 'support': 10463}, 'accuracy': 0.30163127986203386, 'macro avg': {'precision': 0.5361019051091312, 'recall': 0.3309304768020753, 'f1-score': 0.24874267584888013, 'support': 35371}, 'weighted avg': {'precision': 0.5751775183254272, 'recall': 0.30163127986203386, 'f1-score': 0.2276768446192478, 'support': 35371}}
[[4595    0 6550]
 [5463    1 8299]
 [4390    0 6073]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
2282/2282 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066384
{'0': {'precision': 0.3622748876986165, 'recall': 0.22434431402246624, 'f1-score': 0.2770939339519106, 'support': 198075}, '1': {'precision': 0.32158590308370044, 'recall': 0.0003622882722819695, 'f1-score': 0.0007237611786401222, 'support': 201497}, '2': {'precision': 0.3184813936895341, 'recall': 0.7962889661267846, 'f1-score': 0.4549873747153502, 'support': 184423}, 'accuracy': 0.32768088767883286, 'macro avg': {'precision': 0.334114061490617, 'recall': 0.3403318561405109, 'f1-score': 0.24426835661530033, 'support': 583995}, 'weighted avg': {'precision': 0.3344060945093105, 'recall': 0.32768088767883286, 'f1-score': 0.23791531311204064, 'support': 583995}}
[[ 44437     97 153541]
 [ 40712     73 160712]
 [ 37512     57 146854]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034296
{'0': {'precision': 0.33015408453129036, 'recall': 0.25868022769579413, 'f1-score': 0.29007933806790254, 'support': 74134}, '1': {'precision': 0.41836734693877553, 'recall': 0.0005528586839266451, 'f1-score': 0.001104258127070484, 'support': 74160}, '2': {'precision': 0.34160062439961575, 'recall': 0.7442477991863857, 'f1-score': 0.4682707224835294, 'support': 76449}, 'accuracy': 0.33867573183591926, 'macro avg': {'precision': 0.3633740186232272, 'recall': 0.33449362852203546, 'f1-score': 0.2531514395595008, 'support': 224743}, 'weighted avg': {'precision': 0.3631561004629666, 'recall': 0.33867573183591926, 'f1-score': 0.2553381502167933, 'support': 224743}}
[[19177    30 54927]
 [19383    41 54736]
 [19525    27 56897]]
Evaluating performance on  val set...
303/303 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039385
{'0': {'precision': 0.3397911227154047, 'recall': 0.2547269524368761, 'f1-score': 0.29117350934108965, 'support': 25545}, '1': {'precision': 0.4, 'recall': 0.0005464694172294001, 'f1-score': 0.0010914477274499104, 'support': 25619}, '2': {'precision': 0.33618644941734555, 'recall': 0.7464794107544938, 'f1-score': 0.46358950050364395, 'support': 26203}, 'accuracy': 0.33710755231558676, 'macro avg': {'precision': 0.35865919071091673, 'recall': 0.33391761086953303, 'f1-score': 0.2519514858573945, 'support': 77367}, 'weighted avg': {'precision': 0.35850760354993366, 'recall': 0.33710755231558676, 'f1-score': 0.253511507194859, 'support': 77367}}
[[ 6507    10 19028]
 [ 6011    14 19594]
 [ 6632    11 19560]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
5098/5098 - 84s - 84s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020699
{'0': {'precision': 0.3727138479457563, 'recall': 0.23238608609949987, 'f1-score': 0.2862783731611529, 'support': 462674}, '1': {'precision': 0.3340192043895748, 'recall': 0.0011556935110301097, 'f1-score': 0.0023034172874541797, 'support': 421392}, '2': {'precision': 0.3291857845054617, 'recall': 0.7939170003207832, 'f1-score': 0.46540030728042886, 'support': 420845}, 'accuracy': 0.3388139114468343, 'macro avg': {'precision': 0.34530627894693094, 'recall': 0.34248625997710436, 'f1-score': 0.25132736590967863, 'support': 1304911}, 'weighted avg': {'precision': 0.3461800988272668, 'recall': 0.3388139114468343, 'f1-score': 0.25234333526117125, 'support': 1304911}}
[[107519    541 354614]
 [ 94658    487 326247]
 [ 86299    430 334116]]
Evaluating performance on  train set...
1876/1876 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019524
{'0': {'precision': 0.3511699287146173, 'recall': 0.25577985653354013, 'f1-score': 0.2959789958531533, 'support': 165056}, '1': {'precision': 0.2968421052631579, 'recall': 0.0009124855199549582, 'f1-score': 0.0018193783145588976, 'support': 154523}, '2': {'precision': 0.33772262879299936, 'recall': 0.7558769330378265, 'f1-score': 0.4668559750374419, 'support': 160628}, 'accuracy': 0.34104875605728363, 'macro avg': {'precision': 0.3285782209235915, 'recall': 0.3375230916971072, 'f1-score': 0.2548847830683847, 'support': 480207}, 'weighted avg': {'precision': 0.329190009315276, 'recall': 0.34104875605728363, 'f1-score': 0.2584810019286534, 'support': 480207}}
[[ 42218    152 122686]
 [ 38972    141 115410]
 [ 39031    182 121415]]
Evaluating performance on  val set...
619/619 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017466
{'0': {'precision': 0.33765123338035996, 'recall': 0.3030058890103777, 'f1-score': 0.31939178874364343, 'support': 52131}, '1': {'precision': 0.3352272727272727, 'recall': 0.0011323072198979004, 'f1-score': 0.0022569909337821813, 'support': 52106}, '2': {'precision': 0.3485378857235177, 'recall': 0.7173178165696869, 'f1-score': 0.4691299856839969, 'support': 54135}, 'accuracy': 0.34530725128179224, 'macro avg': {'precision': 0.34047213061038345, 'recall': 0.3404853375999875, 'f1-score': 0.26359292178714083, 'support': 158372}, 'weighted avg': {'precision': 0.34057502060794487, 'recall': 0.34530725128179224, 'f1-score': 0.2662349902987504, 'support': 158372}}
[[15796    57 36278]
 [15743    59 36304]
 [15243    60 38832]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
5760/5760 - 94s - 94s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100982
{'0': {'precision': 0.36442723190069043, 'recall': 0.376072688638021, 'f1-score': 0.37015838925168265, 'support': 525199}, '1': {'precision': 0.3225806451612903, 'recall': 6.433322897053967e-05, 'f1-score': 0.00012864080271860896, 'support': 466322}, '2': {'precision': 0.3319190558518055, 'recall': 0.6408116782275598, 'f1-score': 0.4373206268997122, 'support': 482950}, 'accuracy': 0.34386773290217304, 'macro avg': {'precision': 0.3396423109712621, 'recall': 0.33898290003151715, 'f1-score': 0.26920255231803786, 'support': 1474471}, 'weighted avg': {'precision': 0.3405448987491401, 'recall': 0.34386773290217304, 'f1-score': 0.2751297249482803, 'support': 1474471}}
[[197513     36 327650]
 [171026     30 295266]
 [173443     27 309480]]
Evaluating performance on  train set...
2159/2159 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029934
{'0': {'precision': 0.3329112456639409, 'recall': 0.40359563680392646, 'f1-score': 0.36486156311998513, 'support': 185002}, '1': {'precision': 0.4307692307692308, 'recall': 0.00015345829222843362, 'f1-score': 0.0003068072866730585, 'support': 182460}, '2': {'precision': 0.3402398595943838, 'recall': 0.6033380701005527, 'f1-score': 0.4351090753581456, 'support': 185077}, 'accuracy': 0.33727573981203135, 'macro avg': {'precision': 0.3679734453425185, 'recall': 0.3356957217322359, 'f1-score': 0.26675914858826794, 'support': 552539}, 'weighted avg': {'precision': 0.3676807838191042, 'recall': 0.33727573981203135, 'f1-score': 0.2680078352802416, 'support': 552539}}
[[ 74666     18 110318]
 [ 76222     28 106210]
 [ 73394     19 111664]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959778
{'0': {'precision': 0.3746163366336634, 'recall': 0.38970285302296837, 'f1-score': 0.382010702206068, 'support': 77672}, '1': {'precision': 0.17647058823529413, 'recall': 4.624990364603407e-05, 'f1-score': 9.247557103665114e-05, 'support': 64865}, '2': {'precision': 0.3559050158209305, 'recall': 0.6495428296438883, 'f1-score': 0.4598459325434379, 'support': 74808}, 'accuracy': 0.36284708642940944, 'macro avg': {'precision': 0.3023306468966293, 'recall': 0.3464306441901676, 'f1-score': 0.28064970344018086, 'support': 217345}, 'weighted avg': {'precision': 0.30904095897501405, 'recall': 0.36284708642940944, 'f1-score': 0.2948201624669282, 'support': 217345}}
[[30269     6 47397]
 [24322     3 40540]
 [26209     8 48591]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
6315/6315 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0899447
{'0': {'precision': 0.3854361708841997, 'recall': 0.3211985496274455, 'f1-score': 0.35039755468658984, 'support': 627425}, '1': {'precision': 0.2103448275862069, 'recall': 0.00029690127545867597, 'f1-score': 0.0005929655812642318, 'support': 410911}, '2': {'precision': 0.35718958284728797, 'recall': 0.6753259782807998, 'f1-score': 0.46724604170518896, 'support': 578106}, 'accuracy': 0.3662735811120968, 'macro avg': {'precision': 0.3176568604392315, 'recall': 0.33227380972790127, 'f1-score': 0.272745520657681, 'support': 1616442}, 'weighted avg': {'precision': 0.33082457270153154, 'recall': 0.3662735811120968, 'f1-score': 0.3032645662604761, 'support': 1616442}}
[[201528    223 425674]
 [133868    122 276921]
 [187461    235 390410]]
Evaluating performance on  train set...
2155/2155 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026467
{'0': {'precision': 0.33080514072050693, 'recall': 0.3238088454457789, 'f1-score': 0.3272696060515444, 'support': 182512}, '1': {'precision': 0.3181818181818182, 'recall': 0.0004609559348076606, 'f1-score': 0.0009205782107904916, 'support': 182230}, '2': {'precision': 0.34544112713854414, 'recall': 0.689082918002773, 'f1-score': 0.460187621553598, 'support': 186799}, 'accuracy': 0.34068727438214025, 'macro avg': {'precision': 0.33147602868028975, 'recall': 0.3377842397944532, 'f1-score': 0.26279260193864434, 'support': 551541}, 'weighted avg': {'precision': 0.3315913734043467, 'recall': 0.34068727438214025, 'f1-score': 0.2644608013286816, 'support': 551541}}
[[ 59099     82 123331]
 [ 61572     84 120574]
 [ 57981     98 128720]]
Evaluating performance on  val set...
746/746 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.091557
{'0': {'precision': 0.37475599821705785, 'recall': 0.3438006740083758, 'f1-score': 0.35861156052360643, 'support': 70919}, '1': {'precision': 0.36363636363636365, 'recall': 0.0003869370066553165, 'f1-score': 0.0007730514272461976, 'support': 51688}, '2': {'precision': 0.36335344402171316, 'recall': 0.6698900905395688, 'f1-score': 0.47115101788064084, 'support': 68147}, 'accuracy': 0.36724262662906154, 'macro avg': {'precision': 0.3672486019583782, 'recall': 0.3380259005182, 'f1-score': 0.27684520994383116, 'support': 190754}, 'weighted avg': {'precision': 0.3676693760075258, 'recall': 0.36724262662906154, 'f1-score': 0.30185400651340044, 'support': 190754}}
[[24382    22 46515]
 [18196    20 33472]
 [22483    13 45651]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
6082/6082 - 102s - 102s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.087576
{'0': {'precision': 0.39031527767226315, 'recall': 0.21551779104457577, 'f1-score': 0.27769988400614454, 'support': 595974}, '1': {'precision': 0.22342586323628977, 'recall': 0.0008653581402666877, 'f1-score': 0.0017240388483420494, 'support': 381345}, '2': {'precision': 0.37563404585680593, 'recall': 0.7948816621655436, 'f1-score': 0.5101761773724522, 'support': 579485}, 'accuracy': 0.37859293783931697, 'macro avg': {'precision': 0.32979172892178626, 'recall': 0.33708827045012874, 'f1-score': 0.26320003340897963, 'support': 1556804}, 'weighted avg': {'precision': 0.3439703316375237, 'recall': 0.37859293783931697, 'f1-score': 0.2966325924200956, 'support': 1556804}}
[[128443    566 466965]
 [ 82350    330 298665]
 [118282    581 460622]]
Evaluating performance on  train set...
2440/2440 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039982
{'0': {'precision': 0.33917221909352213, 'recall': 0.22359367993712723, 'f1-score': 0.26951442768721123, 'support': 207403}, '1': {'precision': 0.39502332814930013, 'recall': 0.0012288935120228362, 'f1-score': 0.002450164710875741, 'support': 206690}, '2': {'precision': 0.33749027640661144, 'recall': 0.7811671591589309, 'f1-score': 0.4713441525216028, 'support': 210494}, 'accuracy': 0.3379176960135257, 'macro avg': {'precision': 0.3572286078831446, 'recall': 0.3353299108693603, 'f1-score': 0.2477695816398966, 'support': 624587}, 'weighted avg': {'precision': 0.3570877807155222, 'recall': 0.3379176960135257, 'f1-score': 0.24915606861907763, 'support': 624587}}
[[ 46374    184 160845]
 [ 44495    254 161941]
 [ 45858    205 164431]]
Evaluating performance on  val set...
826/826 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098032
{'0': {'precision': 0.3831993777547317, 'recall': 0.20934305065540418, 'f1-score': 0.2707658486622422, 'support': 77662}, '1': {'precision': 0.31901840490797545, 'recall': 0.0008357575660168116, 'f1-score': 0.001667147574620884, 'support': 62219}, '2': {'precision': 0.33841087842319717, 'recall': 0.7985242533924005, 'f1-score': 0.47536448909132495, 'support': 71557}, 'accuracy': 0.3473831572375827, 'macro avg': {'precision': 0.34687622036196814, 'recall': 0.3362343538712738, 'f1-score': 0.24926582844272935, 'support': 211438}, 'weighted avg': {'precision': 0.34915532419662515, 'recall': 0.3473831572375827, 'f1-score': 0.2608216230746617, 'support': 211438}}
[[16258    62 61342]
 [11801    52 50366]
 [14368    49 57140]]
testing model on single stock: results/universal/W3/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
13689/13689 - 199s - 199s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108653
{'0': {'precision': 0.3182659560954069, 'recall': 0.2777068147389645, 'f1-score': 0.2966062519378753, 'support': 1136742}, '1': {'precision': 0.4101876675603217, 'recall': 0.0001235029305711728, 'f1-score': 0.0002469315128186506, 'support': 1238837}, '2': {'precision': 0.32263320587819644, 'recall': 0.7180621033484633, 'f1-score': 0.445222874301432, 'support': 1128667}, 'accuracy': 0.3214063738675881, 'macro avg': {'precision': 0.35036227651130836, 'recall': 0.331964140339333, 'f1-score': 0.2473586859173753, 'support': 3504246}, 'weighted avg': {'precision': 0.35216916608028026, 'recall': 0.3214063738675881, 'f1-score': 0.23970322226352953, 'support': 3504246}}
[[315681    119 820942]
 [358084    153 880600]
 [318113    101 810453]]
Evaluating performance on  train set...
5475/5475 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041539
{'0': {'precision': 0.32803777170685355, 'recall': 0.2816884648484398, 'f1-score': 0.30310146024371315, 'support': 470605}, '1': {'precision': 0.504424778761062, 'recall': 0.0001231497825434103, 'f1-score': 0.00024623944842363556, 'support': 462851}, '2': {'precision': 0.3335198292259117, 'recall': 0.7105872551323407, 'f1-score': 0.45396673106094987, 'support': 468110}, 'accuracy': 0.3319529726035021, 'macro avg': {'precision': 0.3886607932312757, 'recall': 0.3307996232544413, 'f1-score': 0.2524381435843622, 'support': 1401566}, 'weighted avg': {'precision': 0.38811850179540713, 'recall': 0.3319529726035021, 'f1-score': 0.253474614359849, 'support': 1401566}}
[[132564     20 338021]
 [136107     57 326687]
 [135441     36 332633]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1069254
{'0': {'precision': 0.3151950857297151, 'recall': 0.27100769614728315, 'f1-score': 0.2914359899386457, 'support': 172294}, '1': {'precision': 0.4426229508196721, 'recall': 0.00015165046253391072, 'f1-score': 0.0003031970443902932, 'support': 178041}, '2': {'precision': 0.32821200219830304, 'recall': 0.7164517997904974, 'f1-score': 0.4501890067218733, 'support': 170881}, 'accuracy': 0.32452572445972494, 'macro avg': {'precision': 0.36201001291589674, 'recall': 0.3292037154667715, 'f1-score': 0.24730939790163645, 'support': 521216}, 'weighted avg': {'precision': 0.3629904876965577, 'recall': 0.32452572445972494, 'f1-score': 0.2440358730605157, 'support': 521216}}
[[ 46693     17 125584]
 [ 53011     27 125003]
 [ 48436     17 122428]]
training model: results/universal/W3/deepVOL_L3/h1000
Epoch 1/50
10532/10532 - 552s - loss: 3.2682 - accuracy1000: 0.3805 - val_loss: 3.3272 - val_accuracy1000: 0.3396 - 552s/epoch - 52ms/step
Epoch 2/50
10532/10532 - 550s - loss: 3.2595 - accuracy1000: 0.3859 - val_loss: 3.3305 - val_accuracy1000: 0.3372 - 550s/epoch - 52ms/step
Epoch 3/50
10532/10532 - 556s - loss: 3.2401 - accuracy1000: 0.4015 - val_loss: 3.3550 - val_accuracy1000: 0.3361 - 556s/epoch - 53ms/step
Epoch 4/50
10532/10532 - 550s - loss: 3.2280 - accuracy1000: 0.4097 - val_loss: 3.3466 - val_accuracy1000: 0.3355 - 550s/epoch - 52ms/step
Epoch 5/50
10532/10532 - 551s - loss: 3.2191 - accuracy1000: 0.4143 - val_loss: 3.3767 - val_accuracy1000: 0.3373 - 551s/epoch - 52ms/step
Epoch 6/50
10532/10532 - 569s - loss: 3.2143 - accuracy1000: 0.4168 - val_loss: 3.4065 - val_accuracy1000: 0.3375 - 569s/epoch - 54ms/step
Epoch 7/50
10532/10532 - 558s - loss: 3.2104 - accuracy1000: 0.4185 - val_loss: 3.3977 - val_accuracy1000: 0.3378 - 558s/epoch - 53ms/step
Epoch 8/50
10532/10532 - 555s - loss: 3.2071 - accuracy1000: 0.4204 - val_loss: 3.3993 - val_accuracy1000: 0.3375 - 555s/epoch - 53ms/step
Epoch 9/50
10532/10532 - 545s - loss: 3.2038 - accuracy1000: 0.4223 - val_loss: 3.3840 - val_accuracy1000: 0.3360 - 545s/epoch - 52ms/step
Epoch 10/50
10532/10532 - 551s - loss: 3.2002 - accuracy1000: 0.4237 - val_loss: 3.3900 - val_accuracy1000: 0.3354 - 551s/epoch - 52ms/step
Epoch 11/50
10532/10532 - 543s - loss: 3.1976 - accuracy1000: 0.4246 - val_loss: 3.4179 - val_accuracy1000: 0.3391 - 543s/epoch - 52ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 782s - 782s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.128943
{'0': {'precision': 0.3835336861935947, 'recall': 0.013122228714745185, 'f1-score': 0.025376234468630837, 'support': 2606417}, '1': {'precision': 0.28535249661153517, 'recall': 0.9700500578926098, 'f1-score': 0.4409839773938528, 'support': 2016665}, '2': {'precision': 0.37049453380290637, 'recall': 0.021310021332348245, 'f1-score': 0.04030196339158354, 'support': 2463395}, 'accuracy': 0.2882903592292757, 'macro avg': {'precision': 0.3464602388693454, 'recall': 0.33482743597990106, 'f1-score': 0.16888739175135573, 'support': 7086477}, 'weighted avg': {'precision': 0.35106068846962496, 'recall': 0.2882903592292757, 'f1-score': 0.14883808369024687, 'support': 7086477}}
[[  34202 2518430   53785]
 [  24990 1956266   35409]
 [  29984 2380916   52495]]
Evaluating performance on  train set...
10532/10532 - 327s - 327s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1145302
{'0': {'precision': 0.351885721493441, 'recall': 0.012324612557210766, 'f1-score': 0.02381511328131669, 'support': 905424}, '1': {'precision': 0.32872853570032895, 'recall': 0.9712037541772331, 'f1-score': 0.4911984885111435, 'support': 886053}, '2': {'precision': 0.3454521902459034, 'recall': 0.017693742667231355, 'f1-score': 0.033663283016883185, 'support': 904331}, 'accuracy': 0.3292882875931817, 'macro avg': {'precision': 0.34202214914655776, 'recall': 0.33374070313389176, 'f1-score': 0.1828922949364478, 'support': 2695808}, 'weighted avg': {'precision': 0.34211628105474456, 'recall': 0.3292882875931817, 'f1-score': 0.1807374337721114, 'support': 2695808}}
[[ 11159 879082  15183]
 [ 10380 860538  15135]
 [ 10173 878157  16001]]
Evaluating performance on  val set...
3814/3814 - 123s - 123s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1102315
{'0': {'precision': 0.32111100009991006, 'recall': 0.009985770122227814, 'f1-score': 0.019369205133381747, 'support': 321858}, '1': {'precision': 0.33913698776575535, 'recall': 0.9679425793958873, 'f1-score': 0.5022879080259407, 'support': 331031}, '2': {'precision': 0.3643846044055378, 'recall': 0.02371603921398624, 'f1-score': 0.044533600802407224, 'support': 322946}, 'accuracy': 0.33949591887972863, 'macro avg': {'precision': 0.3415441974237344, 'recall': 0.3338814629107005, 'f1-score': 0.1887302379872432, 'support': 975835}, 'weighted avg': {'precision': 0.3415470350229224, 'recall': 0.33949591887972863, 'f1-score': 0.19151695763350296, 'support': 975835}}
[[  3214 312024   6620]
 [  3872 320419   6740]
 [  2923 312364   7659]]
testing model out of sample: results/universal/W3/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 501s - 501s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1152049
{'0': {'precision': 0.35798584999769795, 'recall': 0.016036475660320414, 'f1-score': 0.030697800512989912, 'support': 1454559}, '1': {'precision': 0.3224538495066787, 'recall': 0.958068016440492, 'f1-score': 0.4825106516427264, 'support': 1328914}, '2': {'precision': 0.3934300806589453, 'recall': 0.035726797685127015, 'f1-score': 0.06550516887521995, 'support': 1352990}, 'accuracy': 0.3251217283945245, 'macro avg': {'precision': 0.35795659338777397, 'recall': 0.3366104299286465, 'f1-score': 0.19290454034364543, 'support': 4136463}, 'weighted avg': {'precision': 0.3581639530634908, 'recall': 0.3251217283945245, 'f1-score': 0.187235993787446, 'support': 4136463}}
[[  23326 1389748   41485]
 [  22684 1273190   33040]
 [  19149 1285503   48338]]
Evaluating performance on  train set...
6181/6181 - 185s - 185s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.113778
{'0': {'precision': 0.32988027815614024, 'recall': 0.017624730927448082, 'f1-score': 0.033461682501245316, 'support': 522164}, '1': {'precision': 0.33068975610527895, 'recall': 0.9588031446697161, 'f1-score': 0.4917690944606885, 'support': 523171}, '2': {'precision': 0.34387244966896363, 'recall': 0.023720668391580234, 'f1-score': 0.044379962229077335, 'support': 536452}, 'accuracy': 0.33098388088914626, 'macro avg': {'precision': 0.3348141613101276, 'recall': 0.3333828479962481, 'f1-score': 0.1898702463970037, 'support': 1581787}, 'weighted avg': {'precision': 0.33489335752809485, 'recall': 0.33098388088914626, 'f1-score': 0.18874825396680214, 'support': 1581787}}
[[  9203 500553  12408]
 [  9681 501618  11872]
 [  9014 514713  12725]]
Evaluating performance on  val set...
2209/2209 - 67s - 67s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1193923
{'0': {'precision': 0.343274270027452, 'recall': 0.013535588116629436, 'f1-score': 0.026044230696406254, 'support': 203242}, '1': {'precision': 0.3083246775809236, 'recall': 0.9584776875743317, 'f1-score': 0.4665642125694117, 'support': 174051}, '2': {'precision': 0.378307554646555, 'recall': 0.03157928433093425, 'f1-score': 0.05829258564401046, 'support': 187433}, 'accuracy': 0.31075955419088197, 'macro avg': {'precision': 0.34330216741831016, 'recall': 0.33453085334063176, 'f1-score': 0.18363367630327612, 'support': 564726}, 'weighted avg': {'precision': 0.3441302287067082, 'recall': 0.31075955419088197, 'f1-score': 0.17251765192700796, 'support': 564726}}
[[  2751 195212   5279]
 [  2779 166824   4448]
 [  2484 179030   5919]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.081072
{'0': {'precision': 0.3952896244430299, 'recall': 0.011125443405353113, 'f1-score': 0.021641778041088015, 'support': 55818}, '1': {'precision': 0.42514155885434446, 'recall': 0.9797216645868374, 'f1-score': 0.5929693208219426, 'support': 73724}, '2': {'precision': 0.2361183186299948, 'recall': 0.010376282782212087, 'f1-score': 0.019878978526334187, 'support': 43850}, 'accuracy': 0.4227703700286057, 'macro avg': {'precision': 0.3521831673091231, 'recall': 0.3337411302581342, 'f1-score': 0.2114966924631216, 'support': 173392}, 'weighted avg': {'precision': 0.3677286196252654, 'recall': 0.4227703700286057, 'f1-score': 0.26411693840173767, 'support': 173392}}
[[  621 54589   608]
 [  631 72229   864]
 [  319 43076   455]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1119933
{'0': {'precision': 0.3333333333333333, 'recall': 0.006993985172751434, 'f1-score': 0.013700506918755994, 'support': 21447}, '1': {'precision': 0.3340781082716567, 'recall': 0.97130870212478, 'f1-score': 0.4971598780825714, 'support': 22167}, '2': {'precision': 0.3475524475524476, 'recall': 0.021879815100154083, 'f1-score': 0.041167943673638435, 'support': 22715}, 'accuracy': 0.3343635513877791, 'macro avg': {'precision': 0.3383212963858125, 'recall': 0.3333941674658952, 'f1-score': 0.18400944289165524, 'support': 66329}, 'weighted avg': {'precision': 0.33845170697902366, 'recall': 0.3343635513877791, 'f1-score': 0.18467800856170932, 'support': 66329}}
[[  150 20831   466]
 [  169 21531   467]
 [  131 22087   497]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992606
{'0': {'precision': 0.3870967741935484, 'recall': 0.00801068090787717, 'f1-score': 0.015696533682145197, 'support': 7490}, '1': {'precision': 0.38060990986783727, 'recall': 0.9738319990440912, 'f1-score': 0.5473104559801222, 'support': 8369}, '2': {'precision': 0.29508196721311475, 'recall': 0.017777777777777778, 'f1-score': 0.033535165346995806, 'support': 6075}, 'accuracy': 0.3792285948755357, 'macro avg': {'precision': 0.3542628837581668, 'recall': 0.33320681924324874, 'f1-score': 0.19884738500308774, 'support': 21934}, 'weighted avg': {'precision': 0.35913659730159936, 'recall': 0.3792285948755357, 'f1-score': 0.22347653746967766, 'support': 21934}}
[[  60 7329  101]
 [  62 8150  157]
 [  33 5934  108]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1389939
{'0': {'precision': 0.45837993289662887, 'recall': 0.01991959952509564, 'f1-score': 0.03818002768018737, 'support': 144029}, '1': {'precision': 0.24391199877302705, 'recall': 0.9556015489384431, 'f1-score': 0.38862868081293533, 'support': 89868}, '2': {'precision': 0.3983345534407028, 'recall': 0.03215488712918095, 'f1-score': 0.05950623359580053, 'support': 135376}, 'accuracy': 0.2521169974517498, 'macro avg': {'precision': 0.36687549503678624, 'recall': 0.3358920118642399, 'f1-score': 0.16210498069630774, 'support': 369273}, 'weighted avg': {'precision': 0.3841732955496111, 'recall': 0.2521169974517498, 'f1-score': 0.1312850638235443, 'support': 369273}}
[[  2869 137286   3874]
 [  1289  85878   2701]
 [  2101 128922   4353]]
Evaluating performance on  train set...
641/641 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1135677
{'0': {'precision': 0.34019292604501605, 'recall': 0.009461973241754311, 'f1-score': 0.01841184762368829, 'support': 55908}, '1': {'precision': 0.32954545454545453, 'recall': 0.9639045073278644, 'f1-score': 0.4911675880305671, 'support': 54245}, '2': {'precision': 0.31872406639004147, 'recall': 0.022792181298913246, 'f1-score': 0.042542144068676666, 'support': 53922}, 'accuracy': 0.32939204632028035, 'macro avg': {'precision': 0.3294874823268374, 'recall': 0.33205288728951066, 'f1-score': 0.18404052657431066, 'support': 164075}, 'weighted avg': {'precision': 0.3296171775043532, 'recall': 0.32939204632028035, 'f1-score': 0.18264033449419143, 'support': 164075}}
[[  529 54106  1273]
 [  604 52287  1354]
 [  422 52271  1229]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005979
{'0': {'precision': 0.3465346534653465, 'recall': 0.0065149611429103265, 'f1-score': 0.012789476088247384, 'support': 21489}, '1': {'precision': 0.3624035051116211, 'recall': 0.9598579040852575, 'f1-score': 0.5261529474128325, 'support': 25335}, '2': {'precision': 0.3837920489296636, 'recall': 0.04309382779637737, 'f1-score': 0.07748707262483599, 'support': 23298}, 'accuracy': 0.3631100082712986, 'macro avg': {'precision': 0.3642434025022104, 'recall': 0.33648889767484835, 'f1-score': 0.20547649870863863, 'support': 70122}, 'weighted avg': {'precision': 0.3646468030900866, 'recall': 0.3631100082712986, 'f1-score': 0.21976286746495946, 'support': 70122}}
[[  140 20618   731]
 [  136 24318   881]
 [  128 22166  1004]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
1359/1359 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0668216
{'0': {'precision': 0.2644592560739626, 'recall': 0.02581728498714383, 'f1-score': 0.04704217541377036, 'support': 95285}, '1': {'precision': 0.46781686844085735, 'recall': 0.9690845035844053, 'f1-score': 0.631016277870808, 'support': 162928}, '2': {'precision': 0.45417925478348437, 'recall': 0.005034156360226816, 'f1-score': 0.009957938198960046, 'support': 89588}, 'accuracy': 0.46233909620731395, 'macro avg': {'precision': 0.3954851264327681, 'recall': 0.33331198164392534, 'f1-score': 0.22933879716117947, 'support': 347801}, 'weighted avg': {'precision': 0.40859134399809754, 'recall': 0.46233909620731395, 'f1-score': 0.3110535782605702, 'support': 347801}}
[[  2460  92691    134]
 [  4629 157891    408]
 [  2213  86924    451]]
Evaluating performance on  train set...
444/444 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1133415
{'0': {'precision': 0.33969118982742963, 'recall': 0.020210207776066576, 'f1-score': 0.03815061331701222, 'support': 37011}, '1': {'precision': 0.33194553335676374, 'recall': 0.9758391395342676, 'f1-score': 0.4953803945828907, 'support': 37747}, '2': {'precision': 0.3, 'recall': 0.0032448301614689296, 'f1-score': 0.006420218593156862, 'support': 38831}, 'accuracy': 0.3319775682504468, 'macro avg': {'precision': 0.32387890772806444, 'recall': 0.3330980591572677, 'f1-score': 0.17998374216435328, 'support': 113589}, 'weighted avg': {'precision': 0.32354857137857324, 'recall': 0.3319775682504468, 'f1-score': 0.17924640248604345, 'support': 113589}}
[[  748 36147   116]
 [  734 36835   178]
 [  720 37985   126]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1129723
{'0': {'precision': 0.3, 'recall': 0.016167953667953667, 'f1-score': 0.03068233857426347, 'support': 12432}, '1': {'precision': 0.33527981894889775, 'recall': 0.9755304446792944, 'f1-score': 0.499043499958413, 'support': 12301}, '2': {'precision': 0.3314917127071823, 'recall': 0.005038206398522126, 'f1-score': 0.009925558312655085, 'support': 11909}, 'accuracy': 0.3346160144096938, 'macro avg': {'precision': 0.32225717721869335, 'recall': 0.3322455349152567, 'f1-score': 0.17988379894844386, 'support': 36642}, 'weighted avg': {'precision': 0.32207881282463363, 'recall': 0.3346160144096938, 'f1-score': 0.18116861525269068, 'support': 36642}}
[[  201 12160    71]
 [  251 12000    50]
 [  218 11631    60]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0927432
{'0': {'precision': 0.27124183006535946, 'recall': 0.002013854347377743, 'f1-score': 0.003998025071952409, 'support': 82429}, '1': {'precision': 0.3954857873104687, 'recall': 0.993708235702508, 'f1-score': 0.5657920743156438, 'support': 115230}, '2': {'precision': 0.3362952836637047, 'recall': 0.005237051071892364, 'f1-score': 0.01031349243782033, 'support': 93946}, 'accuracy': 0.3949280705063356, 'macro avg': {'precision': 0.3343409670131776, 'recall': 0.33365304704059273, 'f1-score': 0.19336786394180552, 'support': 291605}, 'weighted avg': {'precision': 0.34129598875641093, 'recall': 0.3949280705063356, 'f1-score': 0.22802999020116616, 'support': 291605}}
[[   166  81779    484]
 [   238 114505    487]
 [   208  93246    492]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1137308
{'0': {'precision': 0.3333333333333333, 'recall': 0.0024766622213755, 'f1-score': 0.004916792738275341, 'support': 31494}, '1': {'precision': 0.3284076119815952, 'recall': 0.991185203513547, 'f1-score': 0.49335334641881234, 'support': 32332}, '2': {'precision': 0.2857142857142857, 'recall': 0.004972104182927182, 'f1-score': 0.009774115641426337, 'support': 34593}, 'accuracy': 0.3281581808390656, 'macro avg': {'precision': 0.3158184103430714, 'recall': 0.3328779899726166, 'f1-score': 0.169348084932838, 'support': 98419}, 'weighted avg': {'precision': 0.31497768922975455, 'recall': 0.3281581808390656, 'f1-score': 0.16708222852595683, 'support': 98419}}
[[   78 31198   218]
 [   73 32047   212]
 [   83 34338   172]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098307
{'0': {'precision': 0.3333333333333333, 'recall': 0.002319986251933322, 'f1-score': 0.004607901698097107, 'support': 11638}, '1': {'precision': 0.3704800409999431, 'recall': 0.992979242979243, 'f1-score': 0.5396259279226974, 'support': 13104}, '2': {'precision': 0.3333333333333333, 'recall': 0.00526860476056073, 'f1-score': 0.010373251829211819, 'support': 10629}, 'accuracy': 0.3702185406123661, 'macro avg': {'precision': 0.3457155692222032, 'recall': 0.333522611330579, 'f1-score': 0.18486902715000209, 'support': 35371}, 'weighted avg': {'precision': 0.34709518505545744, 'recall': 0.3702185406123661, 'f1-score': 0.20455011769964584, 'support': 35371}}
[[   27 11560    51]
 [   31 13012    61]
 [   23 10550    56]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
2282/2282 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1118741
{'0': {'precision': 0.37620152469340407, 'recall': 0.0384070616785022, 'f1-score': 0.06969848496811153, 'support': 206863}, '1': {'precision': 0.3343686443243705, 'recall': 0.959734596962587, 'f1-score': 0.49594985293204763, 'support': 195627}, '2': {'precision': 0.12335766423357664, 'recall': 0.0009311038263408721, 'f1-score': 0.0018482570061517428, 'support': 181505}, 'accuracy': 0.33538643310302313, 'macro avg': {'precision': 0.2779759444171171, 'recall': 0.33302425415581, 'f1-score': 0.18916553163543695, 'support': 583995}, 'weighted avg': {'precision': 0.2836047288634502, 'recall': 0.33538643310302313, 'f1-score': 0.19139665144975163, 'support': 583995}}
[[  7945 198449    469]
 [  7145 187750    732]
 [  6029 175307    169]]
Evaluating performance on  train set...
878/878 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1153822
{'0': {'precision': 0.30688992588525943, 'recall': 0.030447866879093646, 'f1-score': 0.05539932856806611, 'support': 73437}, '1': {'precision': 0.32922590400324536, 'recall': 0.9624154381047355, 'f1-score': 0.4906193109607392, 'support': 74206}, '2': {'precision': 0.3602251407129456, 'recall': 0.002490272373540856, 'f1-score': 0.004946350134607706, 'support': 77100}, 'accuracy': 0.32857530601620516, 'macro avg': {'precision': 0.3321136568671501, 'recall': 0.33178452578579, 'f1-score': 0.183654996554471, 'support': 224743}, 'weighted avg': {'precision': 0.3325619541817486, 'recall': 0.32857530601620516, 'f1-score': 0.1817926283647719, 'support': 224743}}
[[ 2236 71039   162]
 [ 2610 71417   179]
 [ 2440 74468   192]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1186118
{'0': {'precision': 0.3274336283185841, 'recall': 0.035890272766073025, 'f1-score': 0.06468983845024127, 'support': 25773}, '1': {'precision': 0.32167220570229144, 'recall': 0.9588497172422091, 'f1-score': 0.48173373365305183, 'support': 24933}, '2': {'precision': 0.20361990950226244, 'recall': 0.001687858669967368, 'f1-score': 0.0033479651811621157, 'support': 26661}, 'accuracy': 0.3215453617175281, 'macro avg': {'precision': 0.28424191450771263, 'recall': 0.33214261622608315, 'f1-score': 0.1832571790948184, 'support': 77367}, 'weighted avg': {'precision': 0.28291016085242954, 'recall': 0.3215453617175281, 'f1-score': 0.17795156187062408, 'support': 77367}}
[[  925 24757    91]
 [  941 23907    85]
 [  959 25657    45]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
5098/5098 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1418124
{'0': {'precision': 0.4160161507402423, 'recall': 0.02366682681908583, 'f1-score': 0.0447858238595716, 'support': 522419}, '1': {'precision': 0.24705370690893394, 'recall': 0.9553901961453605, 'f1-score': 0.3925882760977451, 'support': 322261}, '2': {'precision': 0.3731874050545505, 'recall': 0.02348603201435801, 'f1-score': 0.04419096679238341, 'support': 460231}, 'accuracy': 0.2537015934420049, 'macro avg': {'precision': 0.3454190875679089, 'recall': 0.3341810183262681, 'f1-score': 0.1605216889165667, 'support': 1304911}, 'weighted avg': {'precision': 0.35918382840776686, 'recall': 0.2537015934420049, 'f1-score': 0.1304693642679496, 'support': 1304911}}
[[ 12364 498735  11320]
 [  7541 307885   6835]
 [  9815 439607  10809]]
Evaluating performance on  train set...
1876/1876 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1180578
{'0': {'precision': 0.3788126127674199, 'recall': 0.026362049172486367, 'f1-score': 0.04929368819422317, 'support': 167248}, '1': {'precision': 0.31718959030552824, 'recall': 0.9628595272672313, 'f1-score': 0.47718328114594066, 'support': 152179}, '2': {'precision': 0.3737526459026308, 'recall': 0.015375046647592984, 'f1-score': 0.02953510878526112, 'support': 160780}, 'accuracy': 0.31946223191248774, 'macro avg': {'precision': 0.3565849496585263, 'recall': 0.33486554102910354, 'f1-score': 0.18533735937514165, 'support': 480207}, 'weighted avg': {'precision': 0.3575899496080969, 'recall': 0.31946223191248774, 'f1-score': 0.1782777012728049, 'support': 480207}}
[[  4409 160750   2089]
 [  3599 146527   2053]
 [  3631 154677   2472]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018258
{'0': {'precision': 0.3232969514490026, 'recall': 0.017437375664812634, 'f1-score': 0.03309000558562376, 'support': 49262}, '1': {'precision': 0.3677675996275969, 'recall': 0.9703007712523833, 'f1-score': 0.5333736202517303, 'support': 58217}, '2': {'precision': 0.37063267233238906, 'recall': 0.015424518106615841, 'f1-score': 0.029616494689781368, 'support': 50893}, 'accuracy': 0.36705983380900664, 'macro avg': {'precision': 0.3538990744696629, 'recall': 0.3343875550079373, 'f1-score': 0.19869337350904515, 'support': 158372}, 'weighted avg': {'precision': 0.35485558913704984, 'recall': 0.36705983380900664, 'f1-score': 0.21587631759149992, 'support': 158372}}
[[  859 47733   670]
 [ 1066 56488   663]
 [  732 49376   785]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
5760/5760 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1417862
{'0': {'precision': 0.4097884695147242, 'recall': 0.0016759852350450549, 'f1-score': 0.0033383171570242356, 'support': 589504}, '1': {'precision': 0.236197258954469, 'recall': 0.9433179378498537, 'f1-score': 0.3777977797087778, 'support': 347288}, '2': {'precision': 0.408682159607857, 'recall': 0.0646612569953448, 'f1-score': 0.11165636290646327, 'support': 537679}, 'accuracy': 0.24643278843734465, 'macro avg': {'precision': 0.35155596269235007, 'recall': 0.33655172669341454, 'f1-score': 0.1642641532574218, 'support': 1474471}, 'weighted avg': {'precision': 0.36849841773516095, 'recall': 0.24643278843734465, 'f1-score': 0.1310353802740242, 'support': 1474471}}
[[   988 557363  31153]
 [   534 327603  19151]
 [   889 502023  34767]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1127992
{'0': {'precision': 0.3225968797181681, 'recall': 0.003463067813458962, 'f1-score': 0.006852573456701037, 'support': 185096}, '1': {'precision': 0.3319010161786589, 'recall': 0.9547556828742934, 'f1-score': 0.49257021174579224, 'support': 182918}, '2': {'precision': 0.34631643751282576, 'recall': 0.045728221108250915, 'f1-score': 0.08078893197376609, 'support': 184525}, 'accuracy': 0.3325032260166251, 'macro avg': {'precision': 0.3336047778032176, 'recall': 0.33464899059866776, 'f1-score': 0.1934039057254198, 'support': 552539}, 'weighted avg': {'precision': 0.33359835732452575, 'recall': 0.3325032260166251, 'f1-score': 0.19234102859909896, 'support': 552539}}
[[   641 176109   8346]
 [   695 174642   7581]
 [   651 175436   8438]]
Evaluating performance on  val set...
850/850 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1346904
{'0': {'precision': 0.452914798206278, 'recall': 0.0023982238896342115, 'f1-score': 0.004771183938588721, 'support': 84229}, '1': {'precision': 0.25259654503499956, 'recall': 0.9523080009483686, 'f1-score': 0.39928426139752554, 'support': 54831}, '2': {'precision': 0.4047338440384993, 'recall': 0.052640991249920166, 'f1-score': 0.0931646828761007, 'support': 78285}, 'accuracy': 0.26013480871425615, 'macro avg': {'precision': 0.370081729093259, 'recall': 0.335782405362641, 'f1-score': 0.16574004273740497, 'support': 217345}, 'weighted avg': {'precision': 0.38502505546244253, 'recall': 0.26013480871425615, 'f1-score': 0.1361357500177444, 'support': 217345}}
[[  202 80475  3552]
 [  106 52216  2509]
 [  138 74026  4121]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
6315/6315 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1598941
{'0': {'precision': 0.48058510638297874, 'recall': 0.007879726964044839, 'f1-score': 0.015505228474017802, 'support': 687968}, '1': {'precision': 0.18801341633267957, 'recall': 0.9609781546345458, 'f1-score': 0.31449627732572594, 'support': 302856}, '2': {'precision': 0.42083639288086994, 'recall': 0.038475555370849304, 'f1-score': 0.07050508482519449, 'support': 625618}, 'accuracy': 0.1982935360501645, 'macro avg': {'precision': 0.36314497186550937, 'recall': 0.3357778123231467, 'f1-score': 0.1335021968749794, 'support': 1616442}, 'weighted avg': {'precision': 0.402644195168326, 'recall': 0.1982935360501645, 'f1-score': 0.0928108993373976, 'support': 1616442}}
[[  5421 659385  23162]
 [  1853 291038   9965]
 [  4006 597541  24071]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1141542
{'0': {'precision': 0.33372861256987973, 'recall': 0.01084503165428021, 'f1-score': 0.021007395242944663, 'support': 181650}, '1': {'precision': 0.3301068534229156, 'recall': 0.9566475260158845, 'f1-score': 0.49084100228304706, 'support': 181812}, '2': {'precision': 0.35987838702794966, 'recall': 0.03587322348587561, 'f1-score': 0.06524293249914179, 'support': 188079}, 'accuracy': 0.33115761112954434, 'macro avg': {'precision': 0.341237951006915, 'recall': 0.3344552603853468, 'f1-score': 0.19236377667504453, 'support': 551541}, 'weighted avg': {'precision': 0.34145196252259674, 'recall': 0.33115761112954434, 'f1-score': 0.19096967071255325, 'support': 551541}}
[[  1970 173757   5923]
 [  1804 173930   6078]
 [  2129 179203   6747]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1221606
{'0': {'precision': 0.4092558983666062, 'recall': 0.00662417014276482, 'f1-score': 0.013037319688954413, 'support': 68084}, '1': {'precision': 0.2989683878640374, 'recall': 0.9510645785676579, 'f1-score': 0.45492919218062833, 'support': 56830}, '2': {'precision': 0.38366978685011843, 'recall': 0.05167071688942892, 'f1-score': 0.09107580280295019, 'support': 65840}, 'accuracy': 0.3035427828512115, 'macro avg': {'precision': 0.3639646910269207, 'recall': 0.33645315519995056, 'f1-score': 0.18634743822417765, 'support': 190754}, 'weighted avg': {'precision': 0.3675674996745392, 'recall': 0.3035427828512115, 'f1-score': 0.1716225595367548, 'support': 190754}}
[[  451 64662  2971]
 [  287 54049  2494]
 [  364 62074  3402]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
6082/6082 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1059599
{'0': {'precision': 0.36694420769684655, 'recall': 0.022075020361317244, 'f1-score': 0.04164473255889657, 'support': 507089}, '1': {'precision': 0.35355100646185694, 'recall': 0.9606168778568009, 'f1-score': 0.516870132108884, 'support': 549347}, '2': {'precision': 0.3752411480129404, 'recall': 0.025267403191251238, 'f1-score': 0.047346651412479096, 'support': 500368}, 'accuracy': 0.35428287697102523, 'macro avg': {'precision': 0.3652454540572146, 'recall': 0.33598643380312315, 'f1-score': 0.20195383869341987, 'support': 1556804}, 'weighted avg': {'precision': 0.364884865938504, 'recall': 0.35428287697102523, 'f1-score': 0.2111694160126366, 'support': 1556804}}
[[ 11194 486638   9257]
 [  9842 527712  11793]
 [  9470 478255  12643]]
Evaluating performance on  train set...
2440/2440 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1143534
{'0': {'precision': 0.34020552344251764, 'recall': 0.025817237160835, 'f1-score': 0.04799246182211893, 'support': 205173}, '1': {'precision': 0.32949405736198983, 'recall': 0.9570325954602126, 'f1-score': 0.4902137895303141, 'support': 206133}, '2': {'precision': 0.33828815699990283, 'recall': 0.016325879942423377, 'f1-score': 0.03114852353135875, 'support': 213281}, 'accuracy': 0.3299060018860463, 'macro avg': {'precision': 0.33599591260147005, 'recall': 0.3330585708544903, 'f1-score': 0.18978492496126395, 'support': 624587}, 'weighted avg': {'precision': 0.3360156756393697, 'recall': 0.3299060018860463, 'f1-score': 0.1881873697242715, 'support': 624587}}
[[  5297 196608   3268]
 [  5314 197276   3543]
 [  4959 204840   3482]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066746
{'0': {'precision': 0.3811989100817439, 'recall': 0.01908126244578412, 'f1-score': 0.03634332623265964, 'support': 73318}, '1': {'precision': 0.34806561771619204, 'recall': 0.9594794680576497, 'f1-score': 0.510822636051347, 'support': 73617}, '2': {'precision': 0.33836608066184076, 'recall': 0.02536316140334558, 'f1-score': 0.04718913150076437, 'support': 64503}, 'accuracy': 0.34841892185889006, 'macro avg': {'precision': 0.3558768694865922, 'recall': 0.33464129730225983, 'f1-score': 0.19811836459492368, 'support': 211438}, 'weighted avg': {'precision': 0.3565958605819054, 'recall': 0.34841892185889006, 'f1-score': 0.20485291451920637, 'support': 211438}}
[[ 1399 70451  1468]
 [ 1252 70634  1731]
 [ 1019 61848  1636]]
testing model on single stock: results/universal/W3/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
13689/13689 - 191s - 191s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1117595
{'0': {'precision': 0.3227741375987666, 'recall': 0.011456327613862165, 'f1-score': 0.02212728431719022, 'support': 1169572}, '1': {'precision': 0.3382831440695563, 'recall': 0.9749437397277593, 'f1-score': 0.502284925225366, 'support': 1186450}, '2': {'precision': 0.30391749723145073, 'recall': 0.011472500139345632, 'f1-score': 0.022110362144669878, 'support': 1148224}, 'accuracy': 0.33767435277089564, 'macro avg': {'precision': 0.32165825963325784, 'recall': 0.3326241891603224, 'f1-score': 0.18217419056240872, 'support': 3504246}, 'weighted avg': {'precision': 0.3218464098359747, 'recall': 0.33767435277089564, 'f1-score': 0.18469110050215132, 'support': 3504246}}
[[  13399 1141251   14922]
 [  14479 1156722   15249]
 [  13634 1121417   13173]]
Evaluating performance on  train set...
5475/5475 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1136637
{'0': {'precision': 0.3249864330568261, 'recall': 0.008935803753378638, 'f1-score': 0.0173933608977165, 'support': 469124}, '1': {'precision': 0.3318222063522716, 'recall': 0.9782227139435212, 'f1-score': 0.4955494490545504, 'support': 465485}, '2': {'precision': 0.3214851847335691, 'recall': 0.011292260315189621, 'f1-score': 0.021818151725735944, 'support': 466957}, 'accuracy': 0.3316383245598138, 'macro avg': {'precision': 0.32609794138088893, 'recall': 0.33281692600402984, 'f1-score': 0.17825365389266765, 'support': 1401566}, 'weighted avg': {'precision': 0.32609021091612583, 'recall': 0.3316383245598138, 'f1-score': 0.1776717022290297, 'support': 1401566}}
[[  4192 459350   5582]
 [  4590 455348   5547]
 [  4117 457567   5273]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107569
{'0': {'precision': 0.2972454672245467, 'recall': 0.009948361875309975, 'f1-score': 0.019252375494718303, 'support': 171385}, '1': {'precision': 0.3398746059296518, 'recall': 0.9727674674026303, 'f1-score': 0.5037457908161405, 'support': 177545}, '2': {'precision': 0.3396612947282163, 'recall': 0.014435299443947855, 'f1-score': 0.027693643935682154, 'support': 172286}, 'accuracy': 0.3394024742141454, 'macro avg': {'precision': 0.3255937892941383, 'recall': 0.33238370957396274, 'f1-score': 0.18356393674884697, 'support': 521216}, 'weighted avg': {'precision': 0.32578688515625853, 'recall': 0.3394024742141454, 'f1-score': 0.18707856616780164, 'support': 521216}}
[[  1705 167423   2257]
 [  2257 172710   2578]
 [  1774 168025   2487]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        80 (peak)  19.00 (ave)

============================================
