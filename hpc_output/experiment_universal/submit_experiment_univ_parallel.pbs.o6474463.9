This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W3/deepLOB_L1/h10
Epoch 1/50
10532/10532 - 181s - loss: 2.7636 - accuracy10: 0.5396 - val_loss: 4.4748 - val_accuracy10: 0.5264 - 181s/epoch - 17ms/step
Epoch 2/50
10532/10532 - 168s - loss: 2.6688 - accuracy10: 0.5605 - val_loss: 4.5465 - val_accuracy10: 0.5307 - 168s/epoch - 16ms/step
Epoch 3/50
10532/10532 - 163s - loss: 2.6442 - accuracy10: 0.5656 - val_loss: 4.5038 - val_accuracy10: 0.5312 - 163s/epoch - 16ms/step
Epoch 4/50
10532/10532 - 161s - loss: 2.6310 - accuracy10: 0.5681 - val_loss: 4.3413 - val_accuracy10: 0.5316 - 161s/epoch - 15ms/step
Epoch 5/50
10532/10532 - 162s - loss: 2.6198 - accuracy10: 0.5700 - val_loss: 4.3587 - val_accuracy10: 0.5311 - 162s/epoch - 15ms/step
Epoch 6/50
10532/10532 - 162s - loss: 2.6122 - accuracy10: 0.5714 - val_loss: 4.3168 - val_accuracy10: 0.5317 - 162s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 163s - loss: 2.6054 - accuracy10: 0.5728 - val_loss: 4.2771 - val_accuracy10: 0.5317 - 163s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 165s - loss: 2.6003 - accuracy10: 0.5736 - val_loss: 4.2767 - val_accuracy10: 0.5320 - 165s/epoch - 16ms/step
Epoch 9/50
10532/10532 - 167s - loss: 2.5963 - accuracy10: 0.5745 - val_loss: 4.2615 - val_accuracy10: 0.5321 - 167s/epoch - 16ms/step
Epoch 10/50
10532/10532 - 161s - loss: 2.5922 - accuracy10: 0.5751 - val_loss: 4.3414 - val_accuracy10: 0.5329 - 161s/epoch - 15ms/step
Epoch 11/50
10532/10532 - 163s - loss: 2.5890 - accuracy10: 0.5758 - val_loss: 4.2801 - val_accuracy10: 0.5320 - 163s/epoch - 16ms/step
Epoch 12/50
10532/10532 - 167s - loss: 2.5863 - accuracy10: 0.5764 - val_loss: 4.3454 - val_accuracy10: 0.5323 - 167s/epoch - 16ms/step
Epoch 13/50
10532/10532 - 161s - loss: 2.5833 - accuracy10: 0.5769 - val_loss: 4.3498 - val_accuracy10: 0.5331 - 161s/epoch - 15ms/step
Epoch 14/50
10532/10532 - 162s - loss: 2.5808 - accuracy10: 0.5774 - val_loss: 4.3338 - val_accuracy10: 0.5338 - 162s/epoch - 15ms/step
Epoch 15/50
10532/10532 - 160s - loss: 2.5790 - accuracy10: 0.5778 - val_loss: 4.3145 - val_accuracy10: 0.5338 - 160s/epoch - 15ms/step
Epoch 16/50
10532/10532 - 163s - loss: 2.5767 - accuracy10: 0.5783 - val_loss: 4.3292 - val_accuracy10: 0.5340 - 163s/epoch - 16ms/step
Epoch 17/50
10532/10532 - 159s - loss: 2.5747 - accuracy10: 0.5788 - val_loss: 4.3355 - val_accuracy10: 0.5341 - 159s/epoch - 15ms/step
Epoch 18/50
10532/10532 - 162s - loss: 2.5730 - accuracy10: 0.5792 - val_loss: 4.3231 - val_accuracy10: 0.5344 - 162s/epoch - 15ms/step
Epoch 19/50
10532/10532 - 161s - loss: 2.5712 - accuracy10: 0.5794 - val_loss: 4.3150 - val_accuracy10: 0.5350 - 161s/epoch - 15ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 137s - 137s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0936967
{'0': {'precision': 0.46193363143832566, 'recall': 0.12542649327749614, 'f1-score': 0.19728515123930349, 'support': 1587950}, '1': {'precision': 0.5633369532396743, 'recall': 0.8833852750247726, 'f1-score': 0.6879600792008882, 'support': 3894431}, '2': {'precision': 0.41742030904352617, 'recall': 0.14268909092722631, 'f1-score': 0.21267746777716195, 'support': 1604096}, 'accuracy': 0.5458764630154024, 'macro avg': {'precision': 0.48089696457384207, 'recall': 0.38383361974316504, 'f1-score': 0.36597423273911783, 'support': 7086477}, 'weighted avg': {'precision': 0.5075846082955059, 'recall': 0.5458764630154024, 'f1-score': 0.47042375082347976, 'support': 7086477}}
[[ 199171 1344615   44164]
 [ 178862 3440283  275286]
 [  53135 1322074  228887]]
Evaluating performance on  train set...
10532/10532 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2461205
{'0': {'precision': 0.46501209267231214, 'recall': 0.10295170479968976, 'f1-score': 0.16858041975975002, 'support': 670460}, '1': {'precision': 0.5069609483677254, 'recall': 0.9092491557022115, 'f1-score': 0.6509681197057515, 'support': 1343128}, '2': {'precision': 0.4684032593619972, 'recall': 0.09504558646770836, 'f1-score': 0.15802556991270356, 'support': 682220}, 'accuracy': 0.5026711842979915, 'macro avg': {'precision': 0.480125433467345, 'recall': 0.3690821489898699, 'f1-score': 0.3258580364594017, 'support': 2695808}, 'weighted avg': {'precision': 0.4867703945957081, 'recall': 0.5026711842979915, 'f1-score': 0.40624856860062486, 'support': 2695808}}
[[  69025  588714   12721]
 [  61021 1221238   60869]
 [  18391  598987   64842]]
Evaluating performance on  val set...
3814/3814 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1551689
{'0': {'precision': 0.45133433617471724, 'recall': 0.10776141110115907, 'f1-score': 0.17398245356566314, 'support': 225526}, '1': {'precision': 0.5416753707959056, 'recall': 0.9111455203997313, 'f1-score': 0.6794300530815977, 'support': 517948}, '2': {'precision': 0.4587224652244158, 'recall': 0.10019753745249849, 'f1-score': 0.16447026826554578, 'support': 232361}, 'accuracy': 0.5323758627226939, 'macro avg': {'precision': 0.48391072406501284, 'recall': 0.3730348229844629, 'f1-score': 0.33929425830426885, 'support': 975835}, 'weighted avg': {'precision': 0.5010442474343998, 'recall': 0.5323758627226939, 'f1-score': 0.43999598288727865, 'support': 975835}}
[[ 24303 196799   4424]
 [ 22974 471926  23048]
 [  6570 202509  23282]]
testing model out of sample: results/universal/W3/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 82s - 82s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84847766
{'0': {'precision': 0.5169615114372706, 'recall': 0.21356685704112424, 'f1-score': 0.30226299202822077, 'support': 775139}, '1': {'precision': 0.6694126445599602, 'recall': 0.9393614343269748, 'f1-score': 0.7817386296844371, 'support': 2586077}, '2': {'precision': 0.5602528644804425, 'recall': 0.13535299072424659, 'f1-score': 0.21803123191635473, 'support': 775247}, 'accuracy': 0.652667991953512, 'macro avg': {'precision': 0.5822090068258912, 'recall': 0.4294270940307819, 'f1-score': 0.4340109512096708, 'support': 4136463}, 'weighted avg': {'precision': 0.6203860701883547, 'recall': 0.652667991953512, 'f1-score': 0.5862400273048887, 'support': 4136463}}
[[ 165544  586177   23418]
 [  97872 2429261   58944]
 [  56809  613506  104932]]
Evaluating performance on  train set...
6181/6181 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0056068
{'0': {'precision': 0.5136300744796727, 'recall': 0.19618150232471848, 'f1-score': 0.28391962865476855, 'support': 355742}, '1': {'precision': 0.5899501614619305, 'recall': 0.9104626549394531, 'f1-score': 0.7159730767627599, 'support': 867839}, '2': {'precision': 0.5331000318991237, 'recall': 0.15862660033611944, 'f1-score': 0.2445007659340092, 'support': 358206}, 'accuracy': 0.5795634936941573, 'macro avg': {'precision': 0.5455600892802422, 'recall': 0.421756919200097, 'f1-score': 0.4147978237838459, 'support': 1581787}, 'weighted avg': {'precision': 0.5599117821520632, 'recall': 0.5795634936941573, 'f1-score': 0.5120367893172589, 'support': 1581787}}
[[ 69790 271979  13973]
 [ 41912 790135  35792]
 [ 24174 277211  56821]]
Evaluating performance on  val set...
2209/2209 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8913757
{'0': {'precision': 0.5200419406277987, 'recall': 0.2107410948233128, 'f1-score': 0.2999363767504268, 'support': 112968}, '1': {'precision': 0.6517855816903888, 'recall': 0.9047125445031111, 'f1-score': 0.7576990709569857, 'support': 339583}, '2': {'precision': 0.5187652349331764, 'recall': 0.22007577445954982, 'f1-score': 0.30904527331109205, 'support': 112175}, 'accuracy': 0.6298966224328258, 'macro avg': {'precision': 0.5635309190837879, 'recall': 0.4451764712619912, 'f1-score': 0.45556024033950154, 'support': 564726}, 'weighted avg': {'precision': 0.5990088846000318, 'recall': 0.6298966224328258, 'f1-score': 0.5770091863225707, 'support': 564726}}
[[ 23807  83971   5190]
 [ 14647 307225  17711]
 [  7325  80163  24687]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.398826
{'0': {'precision': 0.39851183215418395, 'recall': 0.06706215617045734, 'f1-score': 0.11480479319675298, 'support': 48716}, '1': {'precision': 0.4386787512091731, 'recall': 0.9468700543933611, 'f1-score': 0.5995772524779573, 'support': 75193}, '2': {'precision': 0.5236778430694781, 'recall': 0.030616575389527716, 'f1-score': 0.05785092408736826, 'support': 49483}, 'accuracy': 0.43819784073082957, 'macro avg': {'precision': 0.4536228088109451, 'recall': 0.3481829286511154, 'f1-score': 0.25741098992069283, 'support': 173392}, 'weighted avg': {'precision': 0.4516507362710019, 'recall': 0.43819784073082957, 'f1-score': 0.30877710579244316, 'support': 173392}}
[[ 3267 44882   567]
 [ 3184 71198   811]
 [ 1747 46221  1515]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.411944
{'0': {'precision': 0.4206896551724138, 'recall': 0.05779555742709759, 'f1-score': 0.10162902628656054, 'support': 18998}, '1': {'precision': 0.4425507190238706, 'recall': 0.9502356528971444, 'f1-score': 0.6038650002752849, 'support': 28856}, '2': {'precision': 0.4602272727272727, 'recall': 0.04384303112313938, 'f1-score': 0.08005930318754632, 'support': 18475}, 'accuracy': 0.4421595380602753, 'macro avg': {'precision': 0.44115588230785235, 'recall': 0.3506247471491271, 'f1-score': 0.26185110991646393, 'support': 66329}, 'weighted avg': {'precision': 0.44121281009444874, 'recall': 0.4421595380602753, 'f1-score': 0.31411558014934066, 'support': 66329}}
[[ 1098 17507   393]
 [  879 27420   557]
 [  633 17032   810]]
Evaluating performance on  val set...
86/86 - 1s - 621ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4354814
{'0': {'precision': 0.470873786407767, 'recall': 0.04546875, 'f1-score': 0.08292960957537761, 'support': 6400}, '1': {'precision': 0.43231736816642474, 'recall': 0.9604471195184867, 'f1-score': 0.5962500834056181, 'support': 9304}, '2': {'precision': 0.46594427244582043, 'recall': 0.048314606741573035, 'f1-score': 0.08755090168702735, 'support': 6230}, 'accuracy': 0.4343940913650041, 'macro avg': {'precision': 0.4563784756733374, 'recall': 0.3514101587533532, 'f1-score': 0.25557686488934106, 'support': 21934}, 'weighted avg': {'precision': 0.453118712672909, 'recall': 0.4343940913650041, 'f1-score': 0.301983331576478, 'support': 21934}}
[[ 291 5957  152]
 [ 175 8936  193]
 [ 152 5777  301]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5461146
{'0': {'precision': 0.45320527138708955, 'recall': 0.3562774363476734, 'f1-score': 0.39893826189539916, 'support': 34170}, '1': {'precision': 0.877282104177411, 'recall': 0.9012871841232941, 'f1-score': 0.8891226476886464, 'support': 301977}, '2': {'precision': 0.3894501258897765, 'recall': 0.37822254422508, 'f1-score': 0.38375423066909664, 'support': 33126}, 'accuracy': 0.8039336750859121, 'macro avg': {'precision': 0.573312500484759, 'recall': 0.5452623882320158, 'f1-score': 0.5572717134177141, 'support': 369273}, 'weighted avg': {'precision': 0.794279481485794, 'recall': 0.8039336750859121, 'f1-score': 0.7984297601914699, 'support': 369273}}
[[ 12174  19918   2078]
 [ 12245 272168  17564]
 [  2443  18154  12529]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87730247
{'0': {'precision': 0.534168834239773, 'recall': 0.1627228525121556, 'f1-score': 0.2494547663086989, 'support': 27765}, '1': {'precision': 0.7005457303036048, 'recall': 0.9445321842962909, 'f1-score': 0.8044457748422637, 'support': 109541}, '2': {'precision': 0.5130599369085174, 'recall': 0.15189211401247713, 'f1-score': 0.2343921139101862, 'support': 26769}, 'accuracy': 0.682913301843669, 'macro avg': {'precision': 0.582591500483965, 'recall': 0.4197157169403079, 'f1-score': 0.4294308850203829, 'support': 164075}, 'weighted avg': {'precision': 0.6418027059391045, 'recall': 0.682913301843669, 'f1-score': 0.6175245997612019, 'support': 164075}}
[[  4518  22541    706]
 [  2923 103465   3153]
 [  1017  21686   4066]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7025683
{'0': {'precision': 0.49524441495244415, 'recall': 0.22742508887760285, 'f1-score': 0.3117081999164694, 'support': 9845}, '1': {'precision': 0.7665115519634256, 'recall': 0.9313560162682274, 'f1-score': 0.8409314823107927, 'support': 50405}, '2': {'precision': 0.49563820018365473, 'recall': 0.2186993517017828, 'f1-score': 0.303486083778465, 'support': 9872}, 'accuracy': 0.7321953167336928, 'macro avg': {'precision': 0.5857980556998416, 'recall': 0.4591601522825377, 'f1-score': 0.4853752553352424, 'support': 70122}, 'weighted avg': {'precision': 0.6902917251951787, 'recall': 0.7321953167336928, 'f1-score': 0.6909662190626928, 'support': 70122}}
[[ 2239  7212   394]
 [ 1657 46945  1803]
 [  625  7088  2159]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.343826
{'0': {'precision': 0.5138760329187634, 'recall': 0.277468308419283, 'f1-score': 0.36035972241892084, 'support': 110045}, '1': {'precision': 0.40722996515679444, 'recall': 0.8290844602083796, 'f1-score': 0.5461847389558233, 'support': 130819}, '2': {'precision': 0.5528894130454505, 'recall': 0.11398299933605768, 'f1-score': 0.18900165138041447, 'support': 106937}, 'accuracy': 0.4346824764736157, 'macro avg': {'precision': 0.49133180370700275, 'recall': 0.4068452559879068, 'f1-score': 0.3651820375850529, 'support': 347801}, 'weighted avg': {'precision': 0.48575835037056636, 'recall': 0.4346824764736157, 'f1-score': 0.37756762232632846, 'support': 347801}}
[[ 30534  75719   3792]
 [ 16294 108460   6065]
 [ 12591  82157  12189]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5788184
{'0': {'precision': 0.49933291826025084, 'recall': 0.14957902589790045, 'f1-score': 0.23019989748846748, 'support': 37532}, '1': {'precision': 0.34825942659815345, 'recall': 0.880880776170925, 'f1-score': 0.49917012448132775, 'support': 38239}, '2': {'precision': 0.5347555555555555, 'recall': 0.07953884393674969, 'f1-score': 0.13848030752940632, 'support': 37818}, 'accuracy': 0.37244803634154716, 'macro avg': {'precision': 0.4607826334713199, 'recall': 0.369999548668525, 'f1-score': 0.2892834431664005, 'support': 113589}, 'weighted avg': {'precision': 0.4602685198551842, 'recall': 0.37244803634154716, 'f1-score': 0.2902101190496064, 'support': 113589}}
[[ 5614 30860  1058]
 [ 2996 33684  1559]
 [ 2633 32177  3008]]
Evaluating performance on  val set...
144/144 - 1s - 920ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4317019
{'0': {'precision': 0.5118531735916391, 'recall': 0.17057424396873938, 'f1-score': 0.2558776680471488, 'support': 11772}, '1': {'precision': 0.38008219829489487, 'recall': 0.8454854552323385, 'f1-score': 0.5244165338832131, 'support': 13235}, '2': {'precision': 0.5155582672361196, 'recall': 0.1452513966480447, 'f1-score': 0.22664789110172337, 'support': 11635}, 'accuracy': 0.4063096992522242, 'macro avg': {'precision': 0.46916454637421784, 'recall': 0.3871036986163742, 'f1-score': 0.33564736434402836, 'support': 36642}, 'weighted avg': {'precision': 0.46543430744080455, 'recall': 0.4063096992522242, 'f1-score': 0.3435918603559825, 'support': 36642}}
[[ 2008  9161   603]
 [ 1060 11190   985]
 [  855  9090  1690]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.6068416
{'0': {'precision': 0.41372311138071016, 'recall': 0.17184971266317145, 'f1-score': 0.24283298299908934, 'support': 103189}, '1': {'precision': 0.3170384356035064, 'recall': 0.6262160232709294, 'f1-score': 0.4209565011854197, 'support': 93851}, '2': {'precision': 0.39665130665320036, 'recall': 0.2657960133241686, 'f1-score': 0.3182995320800593, 'support': 94565}, 'accuracy': 0.34855026491315305, 'macro avg': {'precision': 0.3758042845458056, 'recall': 0.3546205830860898, 'f1-score': 0.3273630054215228, 'support': 291605}, 'weighted avg': {'precision': 0.37706959473859736, 'recall': 0.34855026491315305, 'f1-score': 0.32463392783593104, 'support': 291605}}
[[17733 67982 17474]
 [14321 58771 20759]
 [10808 58622 25135]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5929624
{'0': {'precision': 0.38465322183964584, 'recall': 0.16551765844218674, 'f1-score': 0.23144409445489716, 'support': 33072}, '1': {'precision': 0.3262468895380288, 'recall': 0.7435122973556062, 'f1-score': 0.45350126891625153, 'support': 32446}, '2': {'precision': 0.3938891058180398, 'recall': 0.12264064922038843, 'f1-score': 0.18704368988295283, 'support': 32901}, 'accuracy': 0.34173279549680446, 'macro avg': {'precision': 0.36826307239857153, 'recall': 0.34389020167272716, 'f1-score': 0.29066301775136716, 'support': 98419}, 'weighted avg': {'precision': 0.3684857944213107, 'recall': 0.34173279549680446, 'f1-score': 0.28980731061998277, 'support': 98419}}
[[ 5474 24942  2656]
 [ 4769 24124  3553]
 [ 3988 24878  4035]]
Evaluating performance on  val set...
139/139 - 1s - 933ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.6309444
{'0': {'precision': 0.3812154696132597, 'recall': 0.15379716605636046, 'f1-score': 0.21917186613726605, 'support': 12562}, '1': {'precision': 0.3182096638333716, 'recall': 0.7232616830563049, 'f1-score': 0.44196867771012255, 'support': 11491}, '2': {'precision': 0.3835125448028674, 'recall': 0.1418095069800318, 'f1-score': 0.20705669870347676, 'support': 11318}, 'accuracy': 0.3349636708037658, 'macro avg': {'precision': 0.3609792260831662, 'recall': 0.3396227853642324, 'f1-score': 0.2893990808502885, 'support': 35371}, 'weighted avg': {'precision': 0.3614817494125101, 'recall': 0.3349636708037658, 'f1-score': 0.2876754056687485, 'support': 35371}}
[[1932 9429 1201]
 [1801 8311 1379]
 [1335 8378 1605]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
2282/2282 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3955635
{'0': {'precision': 0.5212247212247212, 'recall': 0.22048171579940412, 'f1-score': 0.30988141700313876, 'support': 187621}, '1': {'precision': 0.3764225445155091, 'recall': 0.8471006168489541, 'f1-score': 0.5212288246335146, 'support': 207182}, '2': {'precision': 0.6002657080337606, 'recall': 0.12179690473170113, 'f1-score': 0.20250461376219353, 'support': 189192}, 'accuracy': 0.41081516108870797, 'macro avg': {'precision': 0.4993043245913303, 'recall': 0.39645974579335314, 'f1-score': 0.344538285132949, 'support': 583995}, 'weighted avg': {'precision': 0.4954599763234939, 'recall': 0.41081516108870797, 'f1-score': 0.3500744776439244, 'support': 583995}}
[[ 41367 140896   5358]
 [ 21691 175504   9987]
 [ 16307 149842  23043]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4267051
{'0': {'precision': 0.5267280618185668, 'recall': 0.20081250504452636, 'f1-score': 0.2907702646110694, 'support': 74338}, '1': {'precision': 0.3495770514611747, 'recall': 0.8057644110275689, 'f1-score': 0.4876077871776577, 'support': 74214}, '2': {'precision': 0.5422437946410955, 'recall': 0.18034938509797746, 'f1-score': 0.2706732852696687, 'support': 76191}, 'accuracy': 0.3936407363076937, 'macro avg': {'precision': 0.47284963597361235, 'recall': 0.3956421003900242, 'f1-score': 0.3496837790194653, 'support': 224743}, 'weighted avg': {'precision': 0.4734898035271752, 'recall': 0.3936407363076937, 'f1-score': 0.34895624124551905, 'support': 224743}}
[[14928 54695  4715]
 [ 7530 59799  6885]
 [ 5883 56567 13741]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4186349
{'0': {'precision': 0.5043067226890756, 'recall': 0.19220144921734256, 'f1-score': 0.2783269080263196, 'support': 24979}, '1': {'precision': 0.36869799314733237, 'recall': 0.7807433182794107, 'f1-score': 0.5008667980716712, 'support': 27014}, '2': {'precision': 0.5351874471483604, 'recall': 0.22448175297548673, 'f1-score': 0.31629508287753005, 'support': 25374}, 'accuracy': 0.40828777127198934, 'macro avg': {'precision': 0.4693973876615895, 'recall': 0.3991421734907467, 'f1-score': 0.365162929658507, 'support': 77367}, 'weighted avg': {'precision': 0.46708456443800267, 'recall': 0.40828777127198934, 'f1-score': 0.36848287967262544, 'support': 77367}}
[[ 4801 18418  1760]
 [ 2736 21091  3187]
 [ 1983 17695  5696]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
5098/5098 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59171045
{'0': {'precision': 0.41503036916207836, 'recall': 0.48643446259852796, 'f1-score': 0.4479044938250836, 'support': 153256}, '1': {'precision': 0.8663134241407052, 'recall': 0.7810303758489842, 'f1-score': 0.8214643467427629, 'support': 999577}, '2': {'precision': 0.3829675208488575, 'recall': 0.5643682846960113, 'f1-score': 0.4563001241390676, 'support': 152078}, 'accuracy': 0.7211809847568148, 'macro avg': {'precision': 0.554770438050547, 'recall': 0.6106110410478411, 'f1-score': 0.575222988235638, 'support': 1304911}, 'weighted avg': {'precision': 0.7569817423979488, 'recall': 0.7211809847568148, 'f1-score': 0.7350341354380252, 'support': 1304911}}
[[ 74549  69413   9294]
 [ 89886 780700 128991]
 [ 15188  51062  85828]]
Evaluating performance on  train set...
1876/1876 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57023907
{'0': {'precision': 0.4245909978503799, 'recall': 0.45752731902252713, 'f1-score': 0.4404442742244351, 'support': 56554}, '1': {'precision': 0.8545841782691938, 'recall': 0.8240097218619004, 'f1-score': 0.8390185035084231, 'support': 366185}, '2': {'precision': 0.4243903176090176, 'recall': 0.48874156052063755, 'f1-score': 0.454298422968055, 'support': 57468}, 'accuracy': 0.740726395075457, 'macro avg': {'precision': 0.567855164576197, 'recall': 0.5900928671350217, 'f1-score': 0.5779204002336377, 'support': 480207}, 'weighted avg': {'precision': 0.7524611040328235, 'recall': 0.740726395075457, 'f1-score': 0.7460376420228126, 'support': 480207}}
[[ 25875  26701   3978]
 [ 30328 301740  34117]
 [  4738  24643  28087]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51498586
{'0': {'precision': 0.40738498789346245, 'recall': 0.57148056044156, 'f1-score': 0.47567840464470523, 'support': 16487}, '1': {'precision': 0.8930788506369344, 'recall': 0.8177595497353736, 'f1-score': 0.8537612419923627, 'support': 125082}, '2': {'precision': 0.43508280623823087, 'recall': 0.536273284532524, 'f1-score': 0.48040731460254843, 'support': 16803}, 'accuracy': 0.7622559543353623, 'macro avg': {'precision': 0.5785155482562092, 'recall': 0.6418377982364859, 'f1-score': 0.6032823204132055, 'support': 158372}, 'weighted avg': {'precision': 0.7939240616017321, 'recall': 0.7622559543353623, 'f1-score': 0.7747894680595849, 'support': 158372}}
[[  9422   6028   1037]
 [ 12132 102287  10663]
 [  1574   6218   9011]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
5760/5760 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.52891
{'0': {'precision': 0.5532947496820741, 'recall': 0.13965843656445093, 'f1-score': 0.22302308794761014, 'support': 152651}, '1': {'precision': 0.8112424928238281, 'recall': 0.9843931413451511, 'f1-score': 0.8894694788935876, 'support': 1167051}, '2': {'precision': 0.5286688557716596, 'recall': 0.06761690002519885, 'f1-score': 0.11989871909442956, 'support': 154769}, 'accuracy': 0.8007081861901658, 'macro avg': {'precision': 0.631068699425854, 'recall': 0.397222825978267, 'f1-score': 0.4107970953118758, 'support': 1474471}, 'weighted avg': {'precision': 0.7548767723917146, 'recall': 0.8007081861901658, 'f1-score': 0.7396941323810755, 'support': 1474471}}
[[  21319  128801    2531]
 [  11415 1148837    6799]
 [   5797  138507   10465]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6704901
{'0': {'precision': 0.5194067448077319, 'recall': 0.2480786701696663, 'f1-score': 0.3357815849382675, 'support': 81454}, '1': {'precision': 0.7541493427407501, 'recall': 0.9238947842304971, 'f1-score': 0.8304366173571729, 'support': 388725}, '2': {'precision': 0.5075237204329814, 'recall': 0.230560951918407, 'f1-score': 0.31707785431016494, 'support': 82360}, 'accuracy': 0.7209210571561464, 'macro avg': {'precision': 0.5936932693271545, 'recall': 0.4675114687728568, 'f1-score': 0.4944320188685351, 'support': 552539}, 'weighted avg': {'precision': 0.6827827788867888, 'recall': 0.7209210571561464, 'f1-score': 0.6809958380905491, 'support': 552539}}
[[ 20207  58622   2625]
 [ 13783 359141  15801]
 [  4914  58457  18989]]
Evaluating performance on  val set...
850/850 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6248784
{'0': {'precision': 0.5140061162079511, 'recall': 0.2812395421993173, 'f1-score': 0.3635577089461844, 'support': 29882}, '1': {'precision': 0.7894450610432853, 'recall': 0.9022229269066117, 'f1-score': 0.8420747317795043, 'support': 157675}, '2': {'precision': 0.4847799951911517, 'recall': 0.33842486907479524, 'f1-score': 0.3985924124705929, 'support': 29788}, 'accuracy': 0.7395753295451931, 'macro avg': {'precision': 0.596077057480796, 'recall': 0.5072957793935747, 'f1-score': 0.5347416177320938, 'support': 217345}, 'weighted avg': {'precision': 0.7098203651396628, 'recall': 0.7395753295451931, 'f1-score': 0.7155040860141123, 'support': 217345}}
[[  8404  20218   1260]
 [  5963 142258   9454]
 [  1983  17724  10081]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
6315/6315 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6291302
{'0': {'precision': 0.5180080001821673, 'recall': 0.3027101352849856, 'f1-score': 0.3821196706579283, 'support': 225450}, '1': {'precision': 0.796698125406034, 'recall': 0.8720449679535567, 'f1-score': 0.8326705219071768, 'support': 1165808}, '2': {'precision': 0.45590801027646766, 'recall': 0.42239679550945003, 'f1-score': 0.438513102329098, 'support': 225184}, 'accuracy': 0.7299983544104892, 'macro avg': {'precision': 0.5902047119548897, 'recall': 0.5323839662493308, 'f1-score': 0.5511010982980676, 'support': 1616442}, 'weighted avg': {'precision': 0.7103534436809508, 'recall': 0.7299983544104892, 'f1-score': 0.7149213952546812, 'support': 1616442}}
[[  68246  145195   12009]
 [  47665 1016637  101506]
 [  15836  114231   95117]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6986461
{'0': {'precision': 0.5184448862381268, 'recall': 0.31610846727125796, 'f1-score': 0.3927485706317111, 'support': 89096}, '1': {'precision': 0.7382729495443432, 'recall': 0.897937832182578, 'f1-score': 0.8103151736638847, 'support': 369902}, '2': {'precision': 0.5431029017055181, 'recall': 0.27768712922641364, 'f1-score': 0.3674817674817674, 'support': 92543}, 'accuracy': 0.6998772530056696, 'macro avg': {'precision': 0.5999402458293294, 'recall': 0.4972444762267499, 'f1-score': 0.5235151705924544, 'support': 551541}, 'weighted avg': {'precision': 0.6700143380077955, 'recall': 0.6998772530056696, 'f1-score': 0.6685584484665446, 'support': 551541}}
[[ 28164  57121   3811]
 [ 19945 332149  17808]
 [  6215  60630  25698]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6234855
{'0': {'precision': 0.5203522384383275, 'recall': 0.31555754724027185, 'f1-score': 0.3928679359323058, 'support': 26778}, '1': {'precision': 0.7889479712565348, 'recall': 0.8985344595136242, 'f1-score': 0.8401828973280908, 'support': 137219}, '2': {'precision': 0.4888133362579513, 'recall': 0.33314646634525547, 'f1-score': 0.3962394150201143, 'support': 26757}, 'accuracy': 0.7373895173888884, 'macro avg': {'precision': 0.5993711819842712, 'recall': 0.5157461576997172, 'f1-score': 0.5430967494268369, 'support': 190754}, 'weighted avg': {'precision': 0.709142782573398, 'recall': 0.7373895173888884, 'f1-score': 0.715117127842938, 'support': 190754}}
[[  8450  17141   1187]
 [  5788 123296   8135]
 [  2001  15842   8914]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
6082/6082 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7740752
{'0': {'precision': 0.5109635291062219, 'recall': 0.2493969707286332, 'f1-score': 0.3351903638855018, 'support': 276106}, '1': {'precision': 0.701910220979802, 'recall': 0.9196545745213912, 'f1-score': 0.7961629993673855, 'support': 1005832}, '2': {'precision': 0.5527975350591758, 'recall': 0.20952391347056384, 'f1-score': 0.3038726068271217, 'support': 274866}, 'accuracy': 0.6754022985552453, 'macro avg': {'precision': 0.5885570950483999, 'recall': 0.4595251529068627, 'f1-score': 0.4784086566933364, 'support': 1556804}, 'weighted avg': {'precision': 0.6417179714514698, 'recall': 0.6754022985552453, 'f1-score': 0.6274897421504635, 'support': 1556804}}
[[ 68860 195910  11336]
 [ 45560 925018  35254]
 [ 20345 196930  57591]]
Evaluating performance on  train set...
2440/2440 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.003163
{'0': {'precision': 0.510593645637535, 'recall': 0.19508436759168873, 'f1-score': 0.28230676480826566, 'support': 143420}, '1': {'precision': 0.581268854985591, 'recall': 0.9177424845695001, 'f1-score': 0.7117426120814738, 'support': 337805}, '2': {'precision': 0.5572263534835222, 'recall': 0.1416484145031459, 'f1-score': 0.22587803453741553, 'support': 143362}, 'accuracy': 0.5736654781479602, 'macro avg': {'precision': 0.5496962847022161, 'recall': 0.4181584222214449, 'f1-score': 0.40664247047571833, 'support': 624587}, 'weighted avg': {'precision': 0.5595216530344813, 'recall': 0.5736654781479602, 'f1-score': 0.5016130276011775, 'support': 624587}}
[[ 27979 110320   5121]
 [ 16772 310018  11015]
 [ 10046 113009  20307]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8224793
{'0': {'precision': 0.5463623395149786, 'recall': 0.21099286340302992, 'f1-score': 0.30442401141680364, 'support': 39935}, '1': {'precision': 0.6736643921338166, 'recall': 0.935378338559178, 'f1-score': 0.7832372227793084, 'support': 132355}, '2': {'precision': 0.5676360071883679, 'recall': 0.1775058751404925, 'f1-score': 0.2704417201790231, 'support': 39148}, 'accuracy': 0.6582402406379175, 'macro avg': {'precision': 0.5958875796123877, 'recall': 0.4412923590342335, 'f1-score': 0.45270098479171167, 'support': 211438}, 'weighted avg': {'precision': 0.6299891460324644, 'recall': 0.6582402406379175, 'f1-score': 0.5978574711189749, 'support': 211438}}
[[  8426  30157   1352]
 [  4612 123802   3941]
 [  2384  29815   6949]]
testing model on single stock: results/universal/W3/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
13689/13689 - 86s - 86s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5098983
{'0': {'precision': 0.5244093240647218, 'recall': 0.02470320976597303, 'f1-score': 0.047183747364969726, 'support': 1071885}, '1': {'precision': 0.3819815978384115, 'recall': 0.9837070906633424, 'f1-score': 0.5502835447934898, 'support': 1333218}, '2': {'precision': 0.5084021226415094, 'recall': 0.009413697762711495, 'f1-score': 0.018485120523093004, 'support': 1099143}, 'accuracy': 0.3847680784967722, 'macro avg': {'precision': 0.47159768151488096, 'recall': 0.33927466606400897, 'f1-score': 0.20531747089385088, 'support': 3504246}, 'weighted avg': {'precision': 0.46520074918216425, 'recall': 0.3847680784967722, 'f1-score': 0.22959040800614497, 'support': 3504246}}
[[  26479 1042120    3286]
 [  15003 1311496    6719]
 [   9011 1079785   10347]]
Evaluating performance on  train set...
5475/5475 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.7117528
{'0': {'precision': 0.47292004967045564, 'recall': 0.010670879555491376, 'f1-score': 0.02087083352654276, 'support': 463973}, '1': {'precision': 0.3319777139055492, 'recall': 0.9882228730427004, 'f1-score': 0.49699715856095034, 'support': 465054}, '2': {'precision': 0.4245843230403801, 'recall': 0.006052410488869702, 'f1-score': 0.011934693025924576, 'support': 472539}, 'accuracy': 0.3334755552003973, 'macro avg': {'precision': 0.4098273622054616, 'recall': 0.33498205436235384, 'f1-score': 0.17660089503780588, 'support': 1401566}, 'weighted avg': {'precision': 0.40985750895324213, 'recall': 0.3334755552003973, 'f1-score': 0.17584161411520555, 'support': 1401566}}
[[  4951 457463   1559]
 [  3160 459577   2317]
 [  2358 467321   2860]]
Evaluating performance on  val set...
2036/2036 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5725732
{'0': {'precision': 0.443392425463336, 'recall': 0.013768814042814067, 'f1-score': 0.02670824788554648, 'support': 159854}, '1': {'precision': 0.372056934201266, 'recall': 0.9849962064711925, 'f1-score': 0.5401036375008137, 'support': 193751}, '2': {'precision': 0.44001208824418253, 'recall': 0.00868678070055068, 'f1-score': 0.01703721039082612, 'support': 167611}, 'accuracy': 0.3731677461935167, 'macro avg': {'precision': 0.41848714930292813, 'recall': 0.3358172670715191, 'f1-score': 0.1946163652590621, 'support': 521216}, 'weighted avg': {'precision': 0.41578793045712586, 'recall': 0.3731677461935167, 'f1-score': 0.21444211996126955, 'support': 521216}}
[[  2201 157044    609]
 [  1663 190844   1244]
 [  1100 165055   1456]]
training model: results/universal/W3/deepLOB_L1/h20
Epoch 1/50
10532/10532 - 170s - loss: 2.8891 - accuracy20: 0.5037 - val_loss: 3.5834 - val_accuracy20: 0.4783 - 170s/epoch - 16ms/step
Epoch 2/50
10532/10532 - 163s - loss: 2.7924 - accuracy20: 0.5298 - val_loss: 3.7446 - val_accuracy20: 0.4859 - 163s/epoch - 16ms/step
Epoch 3/50
10532/10532 - 162s - loss: 2.7603 - accuracy20: 0.5368 - val_loss: 3.7294 - val_accuracy20: 0.4887 - 162s/epoch - 15ms/step
Epoch 4/50
10532/10532 - 158s - loss: 2.7443 - accuracy20: 0.5400 - val_loss: 3.7395 - val_accuracy20: 0.4898 - 158s/epoch - 15ms/step
Epoch 5/50
10532/10532 - 161s - loss: 2.7337 - accuracy20: 0.5426 - val_loss: 3.7452 - val_accuracy20: 0.4915 - 161s/epoch - 15ms/step
Epoch 6/50
10532/10532 - 164s - loss: 2.7267 - accuracy20: 0.5439 - val_loss: 3.7364 - val_accuracy20: 0.4920 - 164s/epoch - 16ms/step
Epoch 7/50
10532/10532 - 161s - loss: 2.7206 - accuracy20: 0.5451 - val_loss: 3.7337 - val_accuracy20: 0.4931 - 161s/epoch - 15ms/step
Epoch 8/50
10532/10532 - 166s - loss: 2.7154 - accuracy20: 0.5463 - val_loss: 3.7021 - val_accuracy20: 0.4934 - 166s/epoch - 16ms/step
Epoch 9/50
10532/10532 - 170s - loss: 2.7112 - accuracy20: 0.5473 - val_loss: 3.6933 - val_accuracy20: 0.4946 - 170s/epoch - 16ms/step
Epoch 10/50
10532/10532 - 167s - loss: 2.7076 - accuracy20: 0.5480 - val_loss: 3.6992 - val_accuracy20: 0.4953 - 167s/epoch - 16ms/step
Epoch 11/50
10532/10532 - 165s - loss: 2.7047 - accuracy20: 0.5486 - val_loss: 3.6769 - val_accuracy20: 0.4953 - 165s/epoch - 16ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 181s - 181s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1033598
{'0': {'precision': 0.45084339038533333, 'recall': 0.15309376110608588, 'f1-score': 0.22857116881603431, 'support': 1806442}, '1': {'precision': 0.4886747593116679, 'recall': 0.7665859925562296, 'f1-score': 0.5968659895510463, 'support': 3457119}, '2': {'precision': 0.37241490326366083, 'recall': 0.21448327843959897, 'f1-score': 0.27219975076406827, 'support': 1822916}, 'accuracy': 0.46817607677270384, 'macro avg': {'precision': 0.437311017653554, 'recall': 0.3780543440339715, 'f1-score': 0.365878969710383, 'support': 7086477}, 'weighted avg': {'precision': 0.44912448270826755, 'recall': 0.46817607677270384, 'f1-score': 0.419465778712459, 'support': 7086477}}
[[ 276555 1400685  129202]
 [ 277263 2650179  529677]
 [  59599 1372332  390985]]
Evaluating performance on  train set...
10532/10532 - 67s - 67s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1474094
{'0': {'precision': 0.4684849562824137, 'recall': 0.13746487461990425, 'f1-score': 0.21255959649588535, 'support': 728106}, '1': {'precision': 0.46866355246667424, 'recall': 0.8382335200485155, 'f1-score': 0.6011942448482552, 'support': 1226824}, '2': {'precision': 0.42785692949978116, 'recall': 0.16627029011524164, 'f1-score': 0.23947697882565183, 'support': 740878}, 'accuracy': 0.46429122548786855, 'macro avg': {'precision': 0.4550018127496231, 'recall': 0.3806562282612204, 'f1-score': 0.35107694005659745, 'support': 2695808}, 'weighted avg': {'precision': 0.4574005967354786, 'recall': 0.46429122548786855, 'f1-score': 0.39681931017577665, 'support': 2695808}}
[[ 100089  574074   53943]
 [  87674 1028365  110785]
 [  25881  591811  123186]]
Evaluating performance on  val set...
3814/3814 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0785354
{'0': {'precision': 0.45640450349385703, 'recall': 0.13375054461916266, 'f1-score': 0.20687563752653487, 'support': 252470}, '1': {'precision': 0.4935962102460636, 'recall': 0.8157534585033313, 'f1-score': 0.6150424523297149, 'support': 465447}, '2': {'precision': 0.39833805875610784, 'recall': 0.20481703487154831, 'f1-score': 0.2705321431680724, 'support': 257918}, 'accuracy': 0.4778307808184785, 'macro avg': {'precision': 0.44944625749867617, 'recall': 0.38477367933134743, 'f1-score': 0.364150077674774, 'support': 975835}, 'weighted avg': {'precision': 0.45879669791076505, 'recall': 0.4778307808184785, 'f1-score': 0.41838493784036845, 'support': 975835}}
[[ 33768 192345  26357]
 [ 32324 379690  53433]
 [  7895 197197  52826]]
testing model out of sample: results/universal/W3/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 86s - 86s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92417395
{'0': {'precision': 0.4992790326260552, 'recall': 0.23555967948193535, 'f1-score': 0.32009747706422015, 'support': 928996}, '1': {'precision': 0.5997289945050186, 'recall': 0.8953954976367722, 'f1-score': 0.7183276634212157, 'support': 2281202}, '2': {'precision': 0.5009407241181139, 'recall': 0.15809622516234556, 'f1-score': 0.24034111471180286, 'support': 926265}, 'accuracy': 0.5821038408901518, 'macro avg': {'precision': 0.5333162504163959, 'recall': 0.429683800760351, 'f1-score': 0.4262554183990796, 'support': 4136463}, 'weighted avg': {'precision': 0.5550478913365301, 'recall': 0.5821038408901518, 'f1-score': 0.5218563156187024, 'support': 4136463}}
[[ 218834  661647   48515]
 [ 141250 2042578   97374]
 [  78216  701610  146439]]
Evaluating performance on  train set...
6181/6181 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0607746
{'0': {'precision': 0.5102402829227893, 'recall': 0.2156008748596087, 'f1-score': 0.3031193538896766, 'support': 422925}, '1': {'precision': 0.5046505807136545, 'recall': 0.8198248843273247, 'f1-score': 0.6247380414049247, 'support': 732887}, '2': {'precision': 0.4456717668265271, 'recall': 0.22230177827337286, 'f1-score': 0.2966393714797667, 'support': 425975}, 'accuracy': 0.4973596318594096, 'macro avg': {'precision': 0.4868542101543237, 'recall': 0.41924251248676875, 'f1-score': 0.4081655889247893, 'support': 1581787}, 'weighted avg': {'precision': 0.490262122951155, 'recall': 0.4973596318594096, 'f1-score': 0.4503894000652529, 'support': 1581787}}
[[ 91183 290518  41224]
 [ 55490 600839  76558]
 [ 32033 299247  94695]]
Evaluating performance on  val set...
2209/2209 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97801036
{'0': {'precision': 0.5074772380607928, 'recall': 0.2361187324860803, 'f1-score': 0.32228491536425824, 'support': 136677}, '1': {'precision': 0.5771873701047581, 'recall': 0.7511177908481517, 'f1-score': 0.652765215528527, 'support': 292094}, '2': {'precision': 0.3991521992414414, 'recall': 0.3553013864881762, 'f1-score': 0.37595243098523584, 'support': 135955}, 'accuracy': 0.5311850348664662, 'macro avg': {'precision': 0.4946056024689975, 'recall': 0.44751263660746937, 'f1-score': 0.45033418729267366, 'support': 564726}, 'weighted avg': {'precision': 0.5174547858566533, 'recall': 0.5311850348664662, 'f1-score': 0.5061398819895455, 'support': 564726}}
[[ 32272  82098  22307]
 [ 22290 219397  50407]
 [  9031  78619  48305]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.352542
{'0': {'precision': 0.4677993527508091, 'recall': 0.0489825655275241, 'f1-score': 0.08867962147819818, 'support': 59021}, '1': {'precision': 0.3249776534141697, 'recall': 0.9050436539432859, 'f1-score': 0.47823393161822875, 'support': 55436}, '2': {'precision': 0.4685794479962576, 'recall': 0.10197675405107322, 'f1-score': 0.16750045289223953, 'support': 58935}, 'accuracy': 0.34069045861400754, 'macro avg': {'precision': 0.42045215138707875, 'recall': 0.35200099117396105, 'f1-score': 0.24480466866288877, 'support': 173392}, 'weighted avg': {'precision': 0.4224022824642017, 'recall': 0.34069045861400754, 'f1-score': 0.2400166983693423, 'support': 173392}}
[[ 2891 52939  3191]
 [ 1639 50172  3625]
 [ 1650 51275  6010]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3786416
{'0': {'precision': 0.4596288262231863, 'recall': 0.08423889036133934, 'f1-score': 0.14238249897338262, 'support': 22638}, '1': {'precision': 0.33673750528075236, 'recall': 0.8565621641825912, 'f1-score': 0.48342694407088055, 'support': 21403}, '2': {'precision': 0.4455215199689802, 'recall': 0.15465721464465182, 'f1-score': 0.2296086594504579, 'support': 22288}, 'accuracy': 0.35711378130229615, 'macro avg': {'precision': 0.4139626171576396, 'recall': 0.3651527563961941, 'f1-score': 0.28513936749824037, 'support': 66329}, 'weighted avg': {'precision': 0.4152339675049083, 'recall': 0.35711378130229615, 'f1-score': 0.28174041064301125, 'support': 66329}}
[[ 1907 18443  2288]
 [ 1068 18333  2002]
 [ 1174 17667  3447]]
Evaluating performance on  val set...
86/86 - 1s - 789ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4086815
{'0': {'precision': 0.5031645569620253, 'recall': 0.041476457545324114, 'f1-score': 0.07663573924569224, 'support': 7667}, '1': {'precision': 0.31791691172539166, 'recall': 0.8698069046225864, 'f1-score': 0.4656407846822507, 'support': 6836}, '2': {'precision': 0.43747595228934205, 'recall': 0.15300767056923698, 'f1-score': 0.22671984047856428, 'support': 7431}, 'accuracy': 0.33742135497401293, 'macro avg': {'precision': 0.4195191403255864, 'recall': 0.3547636775790492, 'f1-score': 0.2563321214688357, 'support': 21934}, 'weighted avg': {'precision': 0.4231752743797175, 'recall': 0.33742135497401293, 'f1-score': 0.24872078742959786, 'support': 21934}}
[[ 318 6616  733]
 [ 161 5946  729]
 [ 153 6141 1137]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72332036
{'0': {'precision': 0.45955893007215926, 'recall': 0.34344003118638194, 'f1-score': 0.39310370471362527, 'support': 46174}, '1': {'precision': 0.8246634073532547, 'recall': 0.7789186350950887, 'f1-score': 0.8011385494037228, 'support': 278056}, '2': {'precision': 0.30062106634873986, 'recall': 0.4814288568701019, 'f1-score': 0.3701238297618133, 'support': 45043}, 'accuracy': 0.688179206169961, 'macro avg': {'precision': 0.5282811345913846, 'recall': 0.5345958410505242, 'f1-score': 0.5214553612930538, 'support': 369273}, 'weighted avg': {'precision': 0.7150892622090291, 'recall': 0.688179206169961, 'f1-score': 0.6975436563691627, 'support': 369273}}
[[ 15858  24947   5369]
 [ 16393 216583  45080]
 [  2256  21102  21685]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8899257
{'0': {'precision': 0.4737502239741982, 'recall': 0.22249649368863955, 'f1-score': 0.30278854045387743, 'support': 35650}, '1': {'precision': 0.6354237397743072, 'recall': 0.8373938703113848, 'f1-score': 0.7225605412287032, 'support': 93871}, '2': {'precision': 0.42067389095834745, 'recall': 0.2876078022804885, 'f1-score': 0.34164117020179446, 'support': 34554}, 'accuracy': 0.5880054852963583, 'macro avg': {'precision': 0.5099492849022843, 'recall': 0.4491660554268376, 'f1-score': 0.4556634172947917, 'support': 164075}, 'weighted avg': {'precision': 0.5550694681652226, 'recall': 0.5880054852963583, 'f1-score': 0.551131866695189, 'support': 164075}}
[[ 7932 23058  4660]
 [ 6238 78607  9026]
 [ 2573 22043  9938]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.862369
{'0': {'precision': 0.49700163547156095, 'recall': 0.21006144393241166, 'f1-score': 0.295308535334449, 'support': 13020}, '1': {'precision': 0.6681119153379227, 'recall': 0.8588034576888081, 'f1-score': 0.7515502602844716, 'support': 43960}, '2': {'precision': 0.40421597633136097, 'recall': 0.24950540252625172, 'f1-score': 0.30855368401242117, 'support': 13142}, 'accuracy': 0.6241550440660563, 'macro avg': {'precision': 0.5231098423802815, 'recall': 0.4394567680491572, 'f1-score': 0.4518041598771139, 'support': 70122}, 'weighted avg': {'precision': 0.5868823971512728, 'recall': 0.6241550440660563, 'f1-score': 0.5838121999864684, 'support': 70122}}
[[ 2735  9453   832]
 [ 2206 37753  4001]
 [  562  9301  3279]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2552999
{'0': {'precision': 0.46279357517027647, 'recall': 0.3558023132795761, 'f1-score': 0.40230601433468377, 'support': 112481}, '1': {'precision': 0.3840324914242046, 'recall': 0.7187741064541013, 'f1-score': 0.5006002165816477, 'support': 124448}, '2': {'precision': 0.4892081264744199, 'recall': 0.12531567934194388, 'f1-score': 0.19952180250299772, 'support': 110872}, 'accuracy': 0.4122041052210891, 'macro avg': {'precision': 0.445344731022967, 'recall': 0.39996403302520717, 'f1-score': 0.36747601113977635, 'support': 347801}, 'weighted avg': {'precision': 0.4430322023799793, 'recall': 0.4122041052210891, 'f1-score': 0.37283348765140073, 'support': 347801}}
[[40021 66807  5653]
 [26144 89450  8854]
 [20312 76666 13894]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3996578
{'0': {'precision': 0.4552574897199922, 'recall': 0.18552999069025136, 'f1-score': 0.2636253685085796, 'support': 37595}, '1': {'precision': 0.34408413864051746, 'recall': 0.8299456206113721, 'f1-score': 0.4864802135313915, 'support': 37882}, '2': {'precision': 0.47643219724437996, 'recall': 0.08619332493702771, 'f1-score': 0.14597729242117893, 'support': 38112}, 'accuracy': 0.3671130127036949, 'macro avg': {'precision': 0.4252579418682965, 'recall': 0.36722297874621707, 'f1-score': 0.29869429148705, 'support': 113589}, 'weighted avg': {'precision': 0.4252857632990958, 'recall': 0.3671130127036949, 'f1-score': 0.2984736703979452, 'support': 113589}}
[[ 6975 29085  1535]
 [ 4367 31440  2075]
 [ 3979 30848  3285]]
Evaluating performance on  val set...
144/144 - 1s - 926ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2915633
{'0': {'precision': 0.48446101935713015, 'recall': 0.22620232172470978, 'f1-score': 0.3084054038776779, 'support': 12060}, '1': {'precision': 0.3616735840355511, 'recall': 0.689332800639233, 'f1-score': 0.4744280686317642, 'support': 12515}, '2': {'precision': 0.4238614138027382, 'recall': 0.2514295185215878, 'f1-score': 0.31563068920676207, 'support': 12067}, 'accuracy': 0.39269144697341846, 'macro avg': {'precision': 0.42333200573180646, 'recall': 0.38898821362851016, 'f1-score': 0.3661547205720681, 'support': 36642}, 'weighted avg': {'precision': 0.42256646684159027, 'recall': 0.39269144697341846, 'f1-score': 0.3674895468683293, 'support': 36642}}
[[2728 7516 1816]
 [1580 8627 2308]
 [1323 7710 3034]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3733295
{'0': {'precision': 0.3907773994344087, 'recall': 0.20619404348620501, 'f1-score': 0.2699491677464368, 'support': 98514}, '1': {'precision': 0.32918797974227815, 'recall': 0.5318647782317941, 'f1-score': 0.4066730876146178, 'support': 97647}, '2': {'precision': 0.3931245953308819, 'recall': 0.33716105779305144, 'f1-score': 0.36299851664683225, 'support': 95444}, 'accuracy': 0.35811457279539105, 'macro avg': {'precision': 0.37102999150252297, 'recall': 0.35840662650368355, 'f1-score': 0.3465402573359622, 'support': 291605}, 'weighted avg': {'precision': 0.3709217855062028, 'recall': 0.35811457279539105, 'f1-score': 0.3461881988323839, 'support': 291605}}
[[20313 55681 22520]
 [18555 51935 27157]
 [13113 50151 32180]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4170794
{'0': {'precision': 0.3862790104565162, 'recall': 0.22583050038766625, 'f1-score': 0.2850260637196786, 'support': 33534}, '1': {'precision': 0.3211437100611036, 'recall': 0.6366550565607373, 'f1-score': 0.426932616783795, 'support': 32443}, '2': {'precision': 0.3854590604952749, 'recall': 0.17224585413969545, 'f1-score': 0.23809625258313982, 'support': 32442}, 'accuracy': 0.34359219256444384, 'macro avg': {'precision': 0.3642939270042982, 'recall': 0.3449104703626997, 'f1-score': 0.31668497769553783, 'support': 98419}, 'weighted avg': {'precision': 0.3645374222736352, 'recall': 0.34359219256444384, 'f1-score': 0.31633482898012155, 'support': 98419}}
[[ 7573 22064  3897]
 [ 6776 20655  5012]
 [ 5256 21598  5588]]
Evaluating performance on  val set...
139/139 - 1s - 903ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4064893
{'0': {'precision': 0.37865748709122204, 'recall': 0.23036649214659685, 'f1-score': 0.2864583333333333, 'support': 12415}, '1': {'precision': 0.3201270081986636, 'recall': 0.5760211477786306, 'f1-score': 0.41153893018155235, 'support': 11727}, '2': {'precision': 0.3696590739913652, 'recall': 0.22112387567904532, 'f1-score': 0.2767190460269698, 'support': 11229}, 'accuracy': 0.34203160781431113, 'macro avg': {'precision': 0.35614785642708363, 'recall': 0.3425038385347576, 'f1-score': 0.3249054365139518, 'support': 35371}, 'weighted avg': {'precision': 0.3563954615145823, 'recall': 0.34203160781431113, 'f1-score': 0.32483603546434203, 'support': 35371}}
[[2860 7502 2053]
 [2791 6755 2181]
 [1902 6844 2483]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
2282/2282 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2477181
{'0': {'precision': 0.4758855406274954, 'recall': 0.3219181674201026, 'f1-score': 0.3840448461074042, 'support': 190682}, '1': {'precision': 0.3545929002263864, 'recall': 0.6757103279751819, 'f1-score': 0.465109840193118, 'support': 198887}, '2': {'precision': 0.48065993053362804, 'recall': 0.18790696717517205, 'f1-score': 0.27018792015796833, 'support': 194426}, 'accuracy': 0.39779107697839877, 'macro avg': {'precision': 0.43704612379583657, 'recall': 0.39517848752348556, 'f1-score': 0.3731142021528302, 'support': 583995}, 'weighted avg': {'precision': 0.43616728304041746, 'recall': 0.39779107697839877, 'f1-score': 0.37374685861449813, 'support': 583995}}
[[ 61384 115094  14204]
 [ 39227 134390  25270]
 [ 28378 129514  36534]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2611555
{'0': {'precision': 0.48630084906855914, 'recall': 0.25813959745990744, 'f1-score': 0.33725600485133983, 'support': 74328}, '1': {'precision': 0.3497207393887829, 'recall': 0.6877479422480097, 'f1-score': 0.46366646653203064, 'support': 74110}, '2': {'precision': 0.4756486117432863, 'recall': 0.2465107135836446, 'f1-score': 0.32472745164046923, 'support': 76305}, 'accuracy': 0.3958566006505208, 'macro avg': {'precision': 0.43722340006687616, 'recall': 0.3974660844305206, 'f1-score': 0.37521664100794655, 'support': 224743}, 'weighted avg': {'precision': 0.4376462929868428, 'recall': 0.3958566006505208, 'f1-score': 0.37468670597395776, 'support': 224743}}
[[19187 46196  8945]
 [11350 50969 11791]
 [ 8918 48577 18810]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2249209
{'0': {'precision': 0.4808344762867249, 'recall': 0.26425199349387074, 'f1-score': 0.3410650281618023, 'support': 25207}, '1': {'precision': 0.3634575646675131, 'recall': 0.5508017355215997, 'f1-score': 0.4379349652027838, 'support': 26505}, '2': {'precision': 0.42819205893690837, 'recall': 0.3896706295069187, 'f1-score': 0.4080241622790906, 'support': 25655}, 'accuracy': 0.4040094613982706, 'macro avg': {'precision': 0.4241613666303821, 'recall': 0.4015747861741297, 'f1-score': 0.3956747185478922, 'support': 77367}, 'weighted avg': {'precision': 0.4231662681414336, 'recall': 0.4040094613982706, 'f1-score': 0.39645523673975214, 'support': 77367}}
[[ 6661 12862  5684]
 [ 4240 14599  7666]
 [ 2952 12706  9997]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
5098/5098 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79928184
{'0': {'precision': 0.42394547181406783, 'recall': 0.5414959966888835, 'f1-score': 0.4755643574284604, 'support': 210201}, '1': {'precision': 0.8088200366224593, 'recall': 0.5948243609334362, 'f1-score': 0.6855096094592639, 'support': 887388}, '2': {'precision': 0.35132262174294787, 'recall': 0.6504133666470514, 'f1-score': 0.456217869449524, 'support': 207322}, 'accuracy': 0.5950658703926934, 'macro avg': {'precision': 0.5280293767264918, 'recall': 0.5955779080897904, 'f1-score': 0.5390972787790828, 'support': 1304911}, 'weighted avg': {'precision': 0.6741362938653374, 'recall': 0.5950658703926934, 'f1-score': 0.6152611986140597, 'support': 1304911}}
[[113823  66787  29591]
 [140163 527840 219385]
 [ 14499  57978 134845]]
Evaluating performance on  train set...
1876/1876 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7142017
{'0': {'precision': 0.4512376975842529, 'recall': 0.49183418718955607, 'f1-score': 0.47066216224623747, 'support': 76906}, '1': {'precision': 0.8005759037104938, 'recall': 0.7424072094935675, 'f1-score': 0.7703951100635213, 'support': 324683}, '2': {'precision': 0.43496694301605626, 'recall': 0.527207509730596, 'f1-score': 0.476665823308876, 'support': 78618}, 'accuracy': 0.667045669888194, 'macro avg': {'precision': 0.5622601814369343, 'recall': 0.5871496354712399, 'f1-score': 0.5725743652062116, 'support': 480207}, 'weighted avg': {'precision': 0.6847724078176393, 'recall': 0.667045669888194, 'f1-score': 0.67430390116629, 'support': 480207}}
[[ 37825  28377  10704]
 [ 40498 241047  43138]
 [  5502  31668  41448]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6549758
{'0': {'precision': 0.447030413327267, 'recall': 0.5553236815790618, 'f1-score': 0.4953271028037383, 'support': 23001}, '1': {'precision': 0.8187645907071316, 'recall': 0.7780849122430358, 'f1-score': 0.7979065948683135, 'support': 111786}, '2': {'precision': 0.4802478041328977, 'recall': 0.4798812804748781, 'f1-score': 0.4800644723447574, 'support': 23585}, 'accuracy': 0.70132346626929, 'macro avg': {'precision': 0.5820142693890987, 'recall': 0.6044299580989919, 'f1-score': 0.5910993900056031, 'support': 158372}, 'weighted avg': {'precision': 0.7143637103414889, 'recall': 0.70132346626929, 'f1-score': 0.7066282290164246, 'support': 158372}}
[[12773  8405  1823]
 [14381 86979 10426]
 [ 1419 10848 11318]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
5760/5760 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6789337
{'0': {'precision': 0.5961142184280247, 'recall': 0.09650853564381917, 'f1-score': 0.16612249585719208, 'support': 209826}, '1': {'precision': 0.7386136033440318, 'recall': 0.9711712223405514, 'f1-score': 0.8390766665153594, 'support': 1056375}, '2': {'precision': 0.45629767658533743, 'recall': 0.11287271330484468, 'f1-score': 0.1809776395459392, 'support': 208270}, 'accuracy': 0.7254662858747307, 'macro avg': {'precision': 0.5970084994524647, 'recall': 0.39351749042973844, 'f1-score': 0.3953922673061636, 'support': 1474471}, 'weighted avg': {'precision': 0.6784577820322397, 'recall': 0.7254662858747307, 'f1-score': 0.6503543612550716, 'support': 1474471}}
[[  20250  182231    7345]
 [   9788 1025921   20666]
 [   3932  180830   23508]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8392636
{'0': {'precision': 0.5167692477794568, 'recall': 0.25767237577183183, 'f1-score': 0.3438791401488676, 'support': 108832}, '1': {'precision': 0.6600051807074329, 'recall': 0.8169222148642453, 'f1-score': 0.7301278257306527, 'support': 333727}, '2': {'precision': 0.39179831459355413, 'recall': 0.30352791416621205, 'f1-score': 0.3420602309639209, 'support': 109980}, 'accuracy': 0.6045799482027513, 'macro avg': {'precision': 0.5228575810268146, 'recall': 0.4593741682674297, 'f1-score': 0.4720223989478138, 'support': 552539}, 'weighted avg': {'precision': 0.578407240674925, 'recall': 0.6045799482027513, 'f1-score': 0.5768067189460058, 'support': 552539}}
[[ 28043  69300  11489]
 [ 20767 272629  40331]
 [  5456  71142  33382]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80843276
{'0': {'precision': 0.5125310453827049, 'recall': 0.2847751906864713, 'f1-score': 0.366123127046338, 'support': 39856}, '1': {'precision': 0.708709130022314, 'recall': 0.7707694543340842, 'f1-score': 0.7384376566241576, 'support': 137630}, '2': {'precision': 0.38914275671163057, 'recall': 0.4443914799668833, 'f1-score': 0.41493610691404004, 'support': 39859}, 'accuracy': 0.6217948423014102, 'macro avg': {'precision': 0.5367943107055498, 'recall': 0.49997870832914626, 'f1-score': 0.5064989635281786, 'support': 217345}, 'weighted avg': {'precision': 0.614129223352334, 'recall': 0.6217948423014102, 'f1-score': 0.6108367632944323, 'support': 217345}}
[[ 11350  23212   5294]
 [  9038 106081  22511]
 [  1757  20389  17713]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
6315/6315 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83058447
{'0': {'precision': 0.5017839977842584, 'recall': 0.30352514511535317, 'f1-score': 0.3782499232422475, 'support': 304413}, '1': {'precision': 0.7111829507288394, 'recall': 0.7237514158843109, 'f1-score': 0.7174121402606911, 'support': 1007321}, '2': {'precision': 0.3871757592427956, 'recall': 0.5173838560195334, 'f1-score': 0.44290831448678875, 'support': 304708}, 'accuracy': 0.6057118040733909, 'macro avg': {'precision': 0.5333809025852978, 'recall': 0.5148868056730659, 'f1-score': 0.5128567926632425, 'support': 1616442}, 'weighted avg': {'precision': 0.6106712424423385, 'recall': 0.6057118040733909, 'f1-score': 0.6017946917452791, 'support': 1616442}}
[[ 92397 163907  48109]
 [ 76849 729050 201422]
 [ 14891 132166 157651]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84409505
{'0': {'precision': 0.5190881400844113, 'recall': 0.32177874113084853, 'f1-score': 0.3972841171028492, 'support': 118106}, '1': {'precision': 0.6379355566177642, 'recall': 0.8363509570269818, 'f1-score': 0.7237914860657436, 'support': 311172}, '2': {'precision': 0.5156096798488057, 'recall': 0.296778256708898, 'f1-score': 0.3767208621441475, 'support': 122263}, 'accuracy': 0.606551462175976, 'macro avg': {'precision': 0.5575444588503271, 'recall': 0.48496931828890943, 'f1-score': 0.4992654884375802, 'support': 551541}, 'weighted avg': {'precision': 0.5853691623723838, 'recall': 0.606551462175976, 'f1-score': 0.5769368097837306, 'support': 551541}}
[[ 38004  69939  10163]
 [ 26998 260249  23925]
 [  8211  77767  36285]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8307046
{'0': {'precision': 0.5111332524692428, 'recall': 0.32736807058431827, 'f1-score': 0.3991137570611914, 'support': 36042}, '1': {'precision': 0.6975555467228427, 'recall': 0.7416056049964926, 'f1-score': 0.718906430496727, 'support': 118323}, '2': {'precision': 0.38237611940298505, 'recall': 0.4400230838989805, 'f1-score': 0.40917918838802, 'support': 36389}, 'accuracy': 0.6058064313199198, 'macro avg': {'precision': 0.5303549728650235, 'recall': 0.5029989198265972, 'f1-score': 0.5090664586486461, 'support': 190754}, 'weighted avg': {'precision': 0.602207105745298, 'recall': 0.6058064313199198, 'f1-score': 0.5993984141560091, 'support': 190754}}
[[11799 19784  4459]
 [ 9170 87749 21404]
 [ 2115 18262 16012]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
6082/6082 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91342336
{'0': {'precision': 0.5152573549538502, 'recall': 0.26365179586874554, 'f1-score': 0.34881738601913825, 'support': 356986}, '1': {'precision': 0.5939230717546896, 'recall': 0.8776310315156444, 'f1-score': 0.7084283438123133, 'support': 846056}, '2': {'precision': 0.5378427227395226, 'recall': 0.18842329023467755, 'f1-score': 0.2790770699356913, 'support': 353762}, 'accuracy': 0.5802284680666289, 'macro avg': {'precision': 0.5490077164826875, 'recall': 0.44323537253968914, 'f1-score': 0.4454409332557143, 'support': 1556804}, 'weighted avg': {'precision': 0.5631409977067248, 'recall': 0.5802284680666289, 'f1-score': 0.5284029567193358, 'support': 1556804}}
[[ 94120 244777  18089]
 [ 64343 742525  39188]
 [ 24203 262902  66657]]
Evaluating performance on  train set...
2440/2440 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0892367
{'0': {'precision': 0.5354301686273305, 'recall': 0.19419379275003898, 'f1-score': 0.28501590052565745, 'support': 179532}, '1': {'precision': 0.4678961089118471, 'recall': 0.8570052489981751, 'f1-score': 0.6053121146404729, 'support': 265765}, '2': {'precision': 0.4898891242743555, 'recall': 0.1986279212449105, 'f1-score': 0.28265286684868884, 'support': 179290}, 'accuracy': 0.4774963295745829, 'macro avg': {'precision': 0.4977384672711777, 'recall': 0.4166089876643748, 'f1-score': 0.3909936273382731, 'support': 624587}, 'weighted avg': {'precision': 0.4936213522057105, 'recall': 0.4774963295745829, 'f1-score': 0.4206252792611742, 'support': 624587}}
[[ 34864 127846  16822]
 [ 17743 227762  20260]
 [ 12507 131171  35612]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.963322
{'0': {'precision': 0.5288586855334202, 'recall': 0.2189758513693218, 'f1-score': 0.3097136470812719, 'support': 51887}, '1': {'precision': 0.5692318114076683, 'recall': 0.7736999116087213, 'f1-score': 0.6559002138720204, 'support': 108608}, '2': {'precision': 0.38793877261775406, 'recall': 0.32237991480674477, 'f1-score': 0.3521339665726813, 'support': 50943}, 'accuracy': 0.5288311467191328, 'macro avg': {'precision': 0.49534308985294756, 'recall': 0.4383518925949293, 'f1-score': 0.4392492758419912, 'support': 211438}, 'weighted avg': {'precision': 0.5156442270694145, 'recall': 0.5288311467191328, 'f1-score': 0.4977576551680893, 'support': 211438}}
[[11362 31903  8622]
 [ 7289 84030 17289]
 [ 2833 31687 16423]]
testing model on single stock: results/universal/W3/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
13689/13689 - 75s - 75s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3600537
{'0': {'precision': 0.4586529692613057, 'recall': 0.029812403019683735, 'f1-score': 0.05598573795289202, 'support': 1147140}, '1': {'precision': 0.3382616030709965, 'recall': 0.9478523342324601, 'f1-score': 0.49859042928077324, 'support': 1186707}, '2': {'precision': 0.42486371518629584, 'recall': 0.03788964276285267, 'f1-score': 0.06957457623927656, 'support': 1170399}, 'accuracy': 0.34340283187881215, 'macro avg': {'precision': 0.407259429172866, 'recall': 0.3385181266716655, 'f1-score': 0.20805024782431394, 'support': 3504246}, 'weighted avg': {'precision': 0.40659720999733256, 'recall': 0.34340283187881215, 'f1-score': 0.21041166814534487, 'support': 3504246}}
[[  34199 1089332   23609]
 [  25462 1124823   36422]
 [  14903 1111150   44346]]
Evaluating performance on  train set...
5475/5475 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4260997
{'0': {'precision': 0.42365203838098486, 'recall': 0.018749326377961242, 'f1-score': 0.03590942963126573, 'support': 463910}, '1': {'precision': 0.32975289999683965, 'recall': 0.9206787831832219, 'f1-score': 0.48558670226290357, 'support': 464655}, '2': {'precision': 0.3540725873891955, 'recall': 0.0626594869778288, 'f1-score': 0.10647611759866502, 'support': 473001}, 'accuracy': 0.3325808417156238, 'macro avg': {'precision': 0.3691591752556733, 'recall': 0.3340291988463373, 'f1-score': 0.2093240831642781, 'support': 1401566}, 'weighted avg': {'precision': 0.36904037254116545, 'recall': 0.3325808417156238, 'f1-score': 0.20880382567820288, 'support': 1401566}}
[[  8698 430638  24574]
 [  7363 427798  29494]
 [  4470 438893  29638]]
Evaluating performance on  val set...
2036/2036 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3042725
{'0': {'precision': 0.39873756285439177, 'recall': 0.02218558026572694, 'f1-score': 0.04203249144294261, 'support': 167992}, '1': {'precision': 0.34923712346313707, 'recall': 0.8923857924531453, 'f1-score': 0.5020111068837941, 'support': 179651}, '2': {'precision': 0.37809796088380637, 'recall': 0.11505245631521031, 'f1-score': 0.17642122001855204, 'support': 173573}, 'accuracy': 0.3530494075392927, 'macro avg': {'precision': 0.3753575490671117, 'recall': 0.3432079430113608, 'f1-score': 0.2401549394484296, 'support': 521216}, 'weighted avg': {'precision': 0.37480260868967175, 'recall': 0.3530494075392927, 'f1-score': 0.24532992096854941, 'support': 521216}}
[[  3727 147043  17222]
 [  3708 160318  15625]
 [  1912 151691  19970]]
training model: results/universal/W3/deepLOB_L1/h30
Epoch 1/50
10532/10532 - 166s - loss: 2.9479 - accuracy30: 0.4897 - val_loss: 3.5669 - val_accuracy30: 0.4417 - 166s/epoch - 16ms/step
Epoch 2/50
10532/10532 - 162s - loss: 2.8720 - accuracy30: 0.5123 - val_loss: 3.6260 - val_accuracy30: 0.4469 - 162s/epoch - 15ms/step
Epoch 3/50
10532/10532 - 169s - loss: 2.8490 - accuracy30: 0.5178 - val_loss: 3.6852 - val_accuracy30: 0.4490 - 169s/epoch - 16ms/step
Epoch 4/50
10532/10532 - 159s - loss: 2.8323 - accuracy30: 0.5217 - val_loss: 3.7048 - val_accuracy30: 0.4485 - 159s/epoch - 15ms/step
Epoch 5/50
10532/10532 - 164s - loss: 2.8215 - accuracy30: 0.5241 - val_loss: 3.6956 - val_accuracy30: 0.4489 - 164s/epoch - 16ms/step
Epoch 6/50
10532/10532 - 160s - loss: 2.8133 - accuracy30: 0.5260 - val_loss: 3.7118 - val_accuracy30: 0.4496 - 160s/epoch - 15ms/step
Epoch 7/50
10532/10532 - 164s - loss: 2.8070 - accuracy30: 0.5274 - val_loss: 3.7155 - val_accuracy30: 0.4499 - 164s/epoch - 16ms/step
Epoch 8/50
10532/10532 - 164s - loss: 2.8015 - accuracy30: 0.5286 - val_loss: 3.7113 - val_accuracy30: 0.4508 - 164s/epoch - 16ms/step
Epoch 9/50
10532/10532 - 164s - loss: 2.7974 - accuracy30: 0.5295 - val_loss: 3.7071 - val_accuracy30: 0.4512 - 164s/epoch - 16ms/step
Epoch 10/50
10532/10532 - 164s - loss: 2.7944 - accuracy30: 0.5304 - val_loss: 3.7280 - val_accuracy30: 0.4513 - 164s/epoch - 16ms/step
Epoch 11/50
10532/10532 - 161s - loss: 2.7909 - accuracy30: 0.5311 - val_loss: 3.6848 - val_accuracy30: 0.4520 - 161s/epoch - 15ms/step
testing model in sample: results/universal/W3/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 147s - 147s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0922031
{'0': {'precision': 0.4836301584418148, 'recall': 0.1701867637103086, 'f1-score': 0.25177522547746417, 'support': 1986735}, '1': {'precision': 0.43835108459529876, 'recall': 0.745837854505997, 'f1-score': 0.5521734271611332, 'support': 3093777}, '2': {'precision': 0.42833032612285266, 'recall': 0.23988005772782675, 'f1-score': 0.3075315973535938, 'support': 2005965}, 'accuracy': 0.4412295418442761, 'macro avg': {'precision': 0.45010385638665534, 'recall': 0.38530155864804416, 'f1-score': 0.3704934166640637, 'support': 7086477}, 'weighted avg': {'precision': 0.44820876564178735, 'recall': 0.4412295418442761, 'f1-score': 0.3987044228375624, 'support': 7086477}}
[[ 338116 1503088  145531]
 [ 289632 2307456  496689]
 [  71373 1453401  481191]]
Evaluating performance on  train set...
10532/10532 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1189015
{'0': {'precision': 0.48278096387966596, 'recall': 0.15612200940436016, 'f1-score': 0.23594422732341896, 'support': 768367}, '1': {'precision': 0.4353555935474543, 'recall': 0.8229147566233752, 'f1-score': 0.5694492320511074, 'support': 1145262}, '2': {'precision': 0.4638498782490515, 'recall': 0.16755499700196502, 'f1-score': 0.2461823403833673, 'support': 782179}, 'accuracy': 0.44271327928398463, 'macro avg': {'precision': 0.46066214522539056, 'recall': 0.3821972543432335, 'f1-score': 0.3505252665859646, 'support': 2695808}, 'weighted avg': {'precision': 0.4571404241584106, 'recall': 0.44271327928398463, 'f1-score': 0.38059794367100724, 'support': 2695808}}
[[119959 603472  44936]
 [ 96259 942453 106550]
 [ 32257 618864 131058]]
Evaluating performance on  val set...
3814/3814 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.106948
{'0': {'precision': 0.4770888214239306, 'recall': 0.14654634387064935, 'f1-score': 0.22421962830851225, 'support': 275592}, '1': {'precision': 0.4348547201033011, 'recall': 0.8160576037855551, 'f1-score': 0.5673722995695231, 'support': 419278}, '2': {'precision': 0.46330829085055003, 'recall': 0.17208193191322763, 'f1-score': 0.25095439905948547, 'support': 280965}, 'accuracy': 0.4415613295280452, 'macro avg': {'precision': 0.4584172774592606, 'recall': 0.37822862652314404, 'f1-score': 0.3475154423125069, 'support': 975835}, 'weighted avg': {'precision': 0.4549747587944279, 'recall': 0.4415613295280452, 'f1-score': 0.37935640918337454, 'support': 975835}}
[[ 40387 221191  14014]
 [ 35130 342155  41993]
 [  9136 223480  48349]]
testing model out of sample: results/universal/W3/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 85s - 85s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98038685
{'0': {'precision': 0.49615720524017465, 'recall': 0.2640437361654166, 'f1-score': 0.3446646670938826, 'support': 1032738}, '1': {'precision': 0.5529486801062365, 'recall': 0.8460915017212428, 'f1-score': 0.6688087807667505, 'support': 2079021}, '2': {'precision': 0.4950327860770103, 'recall': 0.19597366654175255, 'f1-score': 0.2807886663814246, 'support': 1024704}, 'accuracy': 0.5397231886275787, 'macro avg': {'precision': 0.5147128904744739, 'recall': 0.43536963480947066, 'f1-score': 0.43142070474735256, 'support': 4136463}, 'weighted avg': {'precision': 0.5244225304838294, 'recall': 0.5397231886275787, 'f1-score': 0.4917585552582929, 'support': 4136463}}
[[ 272688  700787   59263]
 [ 174397 1759042  145582]
 [ 102515  721374  200815]]
Evaluating performance on  train set...
6181/6181 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0994619
{'0': {'precision': 0.5063556655619416, 'recall': 0.23386839816401575, 'f1-score': 0.3199587644048452, 'support': 464492}, '1': {'precision': 0.44683904223183607, 'recall': 0.7760966878317637, 'f1-score': 0.567143950650637, 'support': 649182}, '2': {'precision': 0.4740985165779506, 'recall': 0.2427811233612397, 'f1-score': 0.32111993150888135, 'support': 468113}, 'accuracy': 0.45904220985505634, 'macro avg': {'precision': 0.4757644081239094, 'recall': 0.41758206978567297, 'f1-score': 0.40274088218812115, 'support': 1581787}, 'weighted avg': {'precision': 0.4723832588162625, 'recall': 0.45904220985505634, 'f1-score': 0.42174979631621334, 'support': 1581787}}
[[108630 311396  44466]
 [ 63753 503828  81601]
 [ 42150 312314 113649]]
Evaluating performance on  val set...
2209/2209 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0257822
{'0': {'precision': 0.5145604214685545, 'recall': 0.2562844397795854, 'f1-score': 0.342154007838329, 'support': 152440}, '1': {'precision': 0.5158453567838392, 'recall': 0.7408465482841945, 'f1-score': 0.6082035707885727, 'support': 261131}, '2': {'precision': 0.45048782631625206, 'recall': 0.3390691674109358, 'f1-score': 0.3869170519958479, 'support': 151155}, 'accuracy': 0.5025056399032451, 'macro avg': {'precision': 0.4936312015228819, 'recall': 0.4454000518249053, 'f1-score': 0.44575821020758316, 'support': 564726}, 'weighted avg': {'precision': 0.4980048588126282, 'recall': 0.5025056399032451, 'f1-score': 0.47715743669124155, 'support': 564726}}
[[ 39068  93487  19885]
 [ 25040 193458  42633]
 [ 11817  88086  51252]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2705612
{'0': {'precision': 0.43950617283950616, 'recall': 0.048595706924205714, 'f1-score': 0.08751498018006945, 'support': 58606}, '1': {'precision': 0.33235383658288, 'recall': 0.8837307523097229, 'f1-score': 0.4830442038639304, 'support': 56825}, '2': {'precision': 0.454660427469331, 'recall': 0.12404892945256293, 'f1-score': 0.19491697729583193, 'support': 57961}, 'accuracy': 0.3475131493955892, 'macro avg': {'precision': 0.4088401456305724, 'recall': 0.35212512956216385, 'f1-score': 0.2551587204466106, 'support': 173392}, 'weighted avg': {'precision': 0.4094553299218196, 'recall': 0.3475131493955892, 'f1-score': 0.25304208229932584, 'support': 173392}}
[[ 2848 51832  3926]
 [ 1909 50218  4698]
 [ 1723 49048  7190]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3046333
{'0': {'precision': 0.43470935130581295, 'recall': 0.09232833817937822, 'f1-score': 0.15230786259823637, 'support': 22355}, '1': {'precision': 0.34079934625956465, 'recall': 0.8383206176618393, 'f1-score': 0.48459720333276113, 'support': 21889}, '2': {'precision': 0.4442290293395373, 'recall': 0.15562599049128367, 'f1-score': 0.2305009724364563, 'support': 22085}, 'accuracy': 0.359586304632966, 'macro avg': {'precision': 0.4065792423016383, 'recall': 0.3620916487775004, 'f1-score': 0.2891353461224846, 'support': 66329}, 'weighted avg': {'precision': 0.4068881266366256, 'recall': 0.359586304632966, 'f1-score': 0.28800079042942783, 'support': 66329}}
[[ 2064 18210  2081]
 [ 1320 18350  2219]
 [ 1364 17284  3437]]
Evaluating performance on  val set...
86/86 - 1s - 654ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3066559
{'0': {'precision': 0.4573082489146165, 'recall': 0.041727188696685596, 'f1-score': 0.07647628267182963, 'support': 7573}, '1': {'precision': 0.3275206431986093, 'recall': 0.8595665811234674, 'f1-score': 0.47431358665722606, 'support': 7014}, '2': {'precision': 0.4416225749559083, 'recall': 0.17040969103035253, 'f1-score': 0.24592417992535848, 'support': 7347}, 'accuracy': 0.34635725357891856, 'macro avg': {'precision': 0.40881715568971133, 'recall': 0.3572344869501685, 'f1-score': 0.2655713497514714, 'support': 21934}, 'weighted avg': {'precision': 0.4105510266538933, 'recall': 0.34635725357891856, 'f1-score': 0.2604538768760444, 'support': 21934}}
[[ 316 6470  787]
 [ 189 6029  796]
 [ 186 5909 1252]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.820335
{'0': {'precision': 0.4585786952025159, 'recall': 0.3928151723888557, 'f1-score': 0.423157074690817, 'support': 55311}, '1': {'precision': 0.7846461908933589, 'recall': 0.6993495728566868, 'f1-score': 0.739546556464865, 'support': 259983}, '2': {'precision': 0.30691005068035887, 'recall': 0.5126993830934252, 'f1-score': 0.38396969865142355, 'support': 53979}, 'accuracy': 0.6261519255401831, 'macro avg': {'precision': 0.5167116455920778, 'recall': 0.5349547094463226, 'f1-score': 0.5155577766023686, 'support': 369273}, 'weighted avg': {'precision': 0.6659729102399838, 'recall': 0.6261519255401831, 'f1-score': 0.6401796874159064, 'support': 369273}}
[[ 21727  26741   6843]
 [ 22509 181819  55655]
 [  3143  23161  27675]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95977974
{'0': {'precision': 0.5266714673461474, 'recall': 0.23311349204403364, 'f1-score': 0.3231815091774303, 'support': 40787}, '1': {'precision': 0.5961160612291524, 'recall': 0.7804778826710698, 'f1-score': 0.6759515445435799, 'support': 83577}, '2': {'precision': 0.43375140038800997, 'recall': 0.399738107829065, 'f1-score': 0.41605074173088014, 'support': 39711}, 'accuracy': 0.552259637360963, 'macro avg': {'precision': 0.5188463096544366, 'recall': 0.47110982751472275, 'f1-score': 0.4717279318172967, 'support': 164075}, 'weighted avg': {'precision': 0.5395559533676944, 'recall': 0.552259637360963, 'f1-score': 0.5253536337529398, 'support': 164075}}
[[ 9508 22475  8804]
 [ 6428 65230 11919]
 [ 2117 21720 15874]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9243527
{'0': {'precision': 0.49096274437476944, 'recall': 0.26375586234229476, 'f1-score': 0.34315916122378826, 'support': 15139}, '1': {'precision': 0.6139489577245276, 'recall': 0.7970358380333342, 'f1-score': 0.6936138837227218, 'support': 39539}, '2': {'precision': 0.45801669950276763, 'recall': 0.3161098161098161, 'f1-score': 0.37405662184423244, 'support': 15444}, 'accuracy': 0.5759818601865321, 'macro avg': {'precision': 0.520976133867355, 'recall': 0.4589671721618151, 'f1-score': 0.47027655559691417, 'support': 70122}, 'weighted avg': {'precision': 0.5530535742517394, 'recall': 0.5759818601865321, 'f1-score': 0.5475716088822616, 'support': 70122}}
[[ 3993 10079  1067]
 [ 3315 31514  4710]
 [  825  9737  4882]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2390769
{'0': {'precision': 0.426905032241479, 'recall': 0.34814549520431876, 'f1-score': 0.38352354741238287, 'support': 114478}, '1': {'precision': 0.3609447951378541, 'recall': 0.6600635811898765, 'f1-score': 0.46668865724185643, 'support': 121105}, '2': {'precision': 0.4607756921490736, 'recall': 0.13540608458536063, 'f1-score': 0.20930472812424672, 'support': 112218}, 'accuracy': 0.3881156178389366, 'macro avg': {'precision': 0.4162085065094689, 'recall': 0.38120505365985197, 'f1-score': 0.35317231092616197, 'support': 347801}, 'weighted avg': {'precision': 0.4148659156175359, 'recall': 0.3881156178389366, 'f1-score': 0.3562700983510585, 'support': 347801}}
[[39855 67714  6909]
 [30295 79937 10873]
 [23208 73815 15195]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3455809
{'0': {'precision': 0.4225721784776903, 'recall': 0.19755655142979087, 'f1-score': 0.26924055694914023, 'support': 37488}, '1': {'precision': 0.33793040874654084, 'recall': 0.79291074564905, 'f1-score': 0.4738926441351889, 'support': 37578}, '2': {'precision': 0.4493727030794576, 'recall': 0.09204890584845417, 'f1-score': 0.15279872452277327, 'support': 38523}, 'accuracy': 0.3587319194640326, 'macro avg': {'precision': 0.4032917634345629, 'recall': 0.36083873430909835, 'f1-score': 0.29864397520236746, 'support': 113589}, 'weighted avg': {'precision': 0.40365985586085895, 'recall': 0.3587319194640326, 'f1-score': 0.2974539175889592, 'support': 113589}}
[[ 7406 28305  1777]
 [ 5214 29796  2568]
 [ 4906 30071  3546]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2807633
{'0': {'precision': 0.4455933821189946, 'recall': 0.22693024386291824, 'f1-score': 0.3007139406302002, 'support': 12343}, '1': {'precision': 0.34025641025641024, 'recall': 0.6633341664583854, 'f1-score': 0.4497923904753834, 'support': 12003}, '2': {'precision': 0.4207878090856814, 'recall': 0.23804489264801562, 'f1-score': 0.3040723041761895, 'support': 12296}, 'accuracy': 0.373614977348398, 'macro avg': {'precision': 0.4022125338203621, 'recall': 0.37610310098977306, 'f1-score': 0.351526211760591, 'support': 36642}, 'weighted avg': {'precision': 0.40276359664647077, 'recall': 0.373614977348398, 'f1-score': 0.35067527111579644, 'support': 36642}}
[[2801 7668 1874]
 [1886 7962 2155]
 [1599 7770 2927]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3371718
{'0': {'precision': 0.37576363434410753, 'recall': 0.21097599002182726, 'f1-score': 0.27022925153766275, 'support': 96210}, '1': {'precision': 0.3382271588670027, 'recall': 0.5473795392817624, 'f1-score': 0.41810575005858786, 'support': 99410}, '2': {'precision': 0.39198738005840633, 'recall': 0.3132468614887743, 'f1-score': 0.3482213690507212, 'support': 95985}, 'accuracy': 0.3593216851562902, 'macro avg': {'precision': 0.36865939108983886, 'recall': 0.357200796930788, 'f1-score': 0.3455187902156573, 'support': 291605}, 'weighted avg': {'precision': 0.36830743573711516, 'recall': 0.3593216851562902, 'f1-score': 0.3463132559870243, 'support': 291605}}
[[20298 54727 21185]
 [19543 54415 25452]
 [14177 51741 30067]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3666955
{'0': {'precision': 0.3771830454073445, 'recall': 0.23731179283105158, 'f1-score': 0.29132867897701376, 'support': 33673}, '1': {'precision': 0.3171369777791957, 'recall': 0.6142367225878209, 'f1-score': 0.41830079111260726, 'support': 32367}, '2': {'precision': 0.36585533553355337, 'recall': 0.16433490842830228, 'f1-score': 0.22679709310998872, 'support': 32379}, 'accuracy': 0.33726211402269884, 'macro avg': {'precision': 0.35339178624003115, 'recall': 0.3386278079490583, 'f1-score': 0.3121421877332033, 'support': 98419}, 'weighted avg': {'precision': 0.35370901103467484, 'recall': 0.33726211402269884, 'f1-score': 0.3118555907999783, 'support': 98419}}
[[ 7991 21604  4078]
 [ 7341 19881  5145]
 [ 5854 21204  5321]]
Evaluating performance on  val set...
139/139 - 1s - 923ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3620899
{'0': {'precision': 0.36095100864553314, 'recall': 0.24423139421514461, 'f1-score': 0.29133553014150027, 'support': 12308}, '1': {'precision': 0.32468422598648783, 'recall': 0.5565626049009735, 'f1-score': 0.41011687588893697, 'support': 11916}, '2': {'precision': 0.3630043826507481, 'recall': 0.21548398672288507, 'f1-score': 0.2704345868047737, 'support': 11147}, 'accuracy': 0.34039184642786463, 'macro avg': {'precision': 0.3495465390942563, 'recall': 0.33875932861300107, 'f1-score': 0.3239623309450703, 'support': 35371}, 'weighted avg': {'precision': 0.3493803427856747, 'recall': 0.34039184642786463, 'f1-score': 0.3247644889086249, 'support': 35371}}
[[3006 7221 2081]
 [3150 6632 2134]
 [2172 6573 2402]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
2282/2282 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.23809
{'0': {'precision': 0.459208725313403, 'recall': 0.3255599026524137, 'f1-score': 0.3810038846677302, 'support': 194766}, '1': {'precision': 0.3370277091713759, 'recall': 0.6538094188523988, 'f1-score': 0.4447792365431129, 'support': 190554}, '2': {'precision': 0.4858562941785897, 'recall': 0.18647539952183215, 'f1-score': 0.26951056276552404, 'support': 198675}, 'accuracy': 0.38534918963347287, 'macro avg': {'precision': 0.42736424288778957, 'recall': 0.38861490700888157, 'f1-score': 0.36509789465878906, 'support': 583995}, 'weighted avg': {'precision': 0.4284073047436432, 'recall': 0.3853491896334729, 'f1-score': 0.3638833830749783, 'support': 583995}}
[[ 63408 116522  14836]
 [ 41599 124586  24369]
 [ 33074 128553  37048]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.250661
{'0': {'precision': 0.4592190168912507, 'recall': 0.2600803471858331, 'f1-score': 0.33208382298698735, 'support': 74427}, '1': {'precision': 0.3396347997842699, 'recall': 0.6547482412670979, 'f1-score': 0.4472628326338606, 'support': 74059}, '2': {'precision': 0.4544952285283777, 'recall': 0.23732903208885742, 'f1-score': 0.31182749381875824, 'support': 76257}, 'accuracy': 0.3824145802093947, 'macro avg': {'precision': 0.41778301506796606, 'recall': 0.38405254018059615, 'f1-score': 0.3637247164798687, 'support': 224743}, 'weighted avg': {'precision': 0.41820991109523703, 'recall': 0.3824145802093947, 'f1-score': 0.3631653489168545, 'support': 224743}}
[[19357 46155  8915]
 [12762 48490 12807]
 [10033 48126 18098]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2381616
{'0': {'precision': 0.4517245884504834, 'recall': 0.2736229819563153, 'f1-score': 0.3408082799408576, 'support': 25272}, '1': {'precision': 0.3544800844233931, 'recall': 0.5461282516636419, 'f1-score': 0.4299129399508892, 'support': 26448}, '2': {'precision': 0.4276463963963964, 'recall': 0.3553632003743128, 'f1-score': 0.38816840222321597, 'support': 25647}, 'accuracy': 0.3938759419390696, 'macro avg': {'precision': 0.4112836897567576, 'recall': 0.3917048113314234, 'f1-score': 0.3862965407049876, 'support': 77367}, 'weighted avg': {'precision': 0.41049956959076733, 'recall': 0.3938759419390696, 'f1-score': 0.3869685951155569, 'support': 77367}}
[[ 6915 13169  5188]
 [ 4994 14444  7010]
 [ 3399 13134  9114]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
5098/5098 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83622676
{'0': {'precision': 0.46520320360290773, 'recall': 0.5636636910545247, 'f1-score': 0.5097222122605309, 'support': 252161}, '1': {'precision': 0.7527677986939375, 'recall': 0.5858234177278104, 'f1-score': 0.6588852506669685, 'support': 804792}, '2': {'precision': 0.40850242581821106, 'recall': 0.614620217940135, 'f1-score': 0.49079912660942826, 'support': 247958}, 'accuracy': 0.5870132139279997, 'macro avg': {'precision': 0.5421578093716855, 'recall': 0.5880357755741568, 'f1-score': 0.5531355298456425, 'support': 1304911}, 'weighted avg': {'precision': 0.6317818240257276, 'recall': 0.5870132139279997, 'f1-score': 0.5981214130744696, 'support': 1304911}}
[[142134  78953  31074]
 [143730 471466 189596]
 [ 19667  75891 152400]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7948253
{'0': {'precision': 0.4724640014489983, 'recall': 0.513220457551346, 'f1-score': 0.4919996227719971, 'support': 91487}, '1': {'precision': 0.7424144044240492, 'recall': 0.6897598834155186, 'f1-score': 0.7151192105452712, 'support': 295065}, '2': {'precision': 0.4557503046208642, 'recall': 0.5191821045325931, 'f1-score': 0.4854026803763508, 'support': 93655}, 'accuracy': 0.622858475615724, 'macro avg': {'precision': 0.5568762368313039, 'recall': 0.5740541484998193, 'f1-score': 0.564173837897873, 'support': 480207}, 'weighted avg': {'precision': 0.6350763631542514, 'recall': 0.622858475615724, 'f1-score': 0.6278096891105903, 'support': 480207}}
[[ 46953  33388  11146]
 [ 44621 203524  46920]
 [  7805  37226  48624]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7446106
{'0': {'precision': 0.46579077119406015, 'recall': 0.5754003797785819, 'f1-score': 0.5148260939253085, 'support': 27911}, '1': {'precision': 0.7634178245151456, 'recall': 0.7285979691539453, 'f1-score': 0.745601593385038, 'support': 101731}, '2': {'precision': 0.5120513394522797, 'recall': 0.47768882701009396, 'f1-score': 0.49427357199452565, 'support': 28730}, 'accuracy': 0.6560818831611649, 'macro avg': {'precision': 0.5804199783871619, 'recall': 0.5938957253142071, 'f1-score': 0.5849004197682907, 'support': 158372}, 'weighted avg': {'precision': 0.6653649628912415, 'recall': 0.6560818831611649, 'f1-score': 0.6593374240876247, 'support': 158372}}
[[16060 10110  1741]
 [16273 74121 11337]
 [ 2146 12860 13724]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
5760/5760 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7779656
{'0': {'precision': 0.6018333545855117, 'recall': 0.1676196338869619, 'f1-score': 0.26220987654320993, 'support': 253419}, '1': {'precision': 0.6952904833953311, 'recall': 0.9192223986097642, 'f1-score': 0.7917268335244929, 'support': 971346}, '2': {'precision': 0.4428209819302774, 'recall': 0.2122776385028794, 'f1-score': 0.28698272104902695, 'support': 249706}, 'accuracy': 0.6703204064372917, 'macro avg': {'precision': 0.5799816066370401, 'recall': 0.4330398903332018, 'f1-score': 0.4469731437055766, 'support': 1474471}, 'weighted avg': {'precision': 0.6364714483253376, 'recall': 0.6703204064372917, 'f1-score': 0.6152382548606613, 'support': 1474471}}
[[ 42478 200419  10522]
 [ 22289 892883  56174]
 [  5814 190885  53007]]
Evaluating performance on  train set...
2159/2159 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9118536
{'0': {'precision': 0.5346416054184351, 'recall': 0.2814032411227174, 'f1-score': 0.36872944236212035, 'support': 128474}, '1': {'precision': 0.5925797897039552, 'recall': 0.7805115066919917, 'f1-score': 0.6736847662075427, 'support': 294307}, '2': {'precision': 0.4509324177066842, 'recall': 0.3380446677661493, 'f1-score': 0.3864124881074033, 'support': 129758}, 'accuracy': 0.5605522868069042, 'macro avg': {'precision': 0.5260512709430248, 'recall': 0.4666531385269528, 'f1-score': 0.4762755655590221, 'support': 552539}, 'weighted avg': {'precision': 0.5458438489223637, 'recall': 0.5605522868069042, 'f1-score': 0.5353149741432094, 'support': 552539}}
[[ 36153  79440  12881]
 [ 24068 229710  40529]
 [  7400  78494  43864]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8759171
{'0': {'precision': 0.5344138796940988, 'recall': 0.29723838747222514, 'f1-score': 0.3820065816312654, 'support': 47255}, '1': {'precision': 0.637980552250441, 'recall': 0.7589811590901695, 'f1-score': 0.6932405020025115, 'support': 122924}, '2': {'precision': 0.4501606282348742, 'recall': 0.4278081668998855, 'f1-score': 0.4386998586802913, 'support': 47166}, 'accuracy': 0.586721571694771, 'macro avg': {'precision': 0.5408516867264713, 'recall': 0.4946759044874267, 'f1-score': 0.504648980771356, 'support': 217345}, 'weighted avg': {'precision': 0.574704389247988, 'recall': 0.586721571694771, 'f1-score': 0.570334417712194, 'support': 217345}}
[[14046 28228  4981]
 [ 9962 93297 19665]
 [ 2275 24713 20178]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
6315/6315 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88503724
{'0': {'precision': 0.5357405974877518, 'recall': 0.32144702271264264, 'f1-score': 0.40180752953121296, 'support': 361957}, '1': {'precision': 0.6392058377653088, 'recall': 0.7200623444192774, 'f1-score': 0.6772292033909655, 'support': 891820}, '2': {'precision': 0.4459943998885046, 'recall': 0.4853101346973102, 'f1-score': 0.4648223953519081, 'support': 362665}, 'accuracy': 0.5781345696288516, 'macro avg': {'precision': 0.5403136117138551, 'recall': 0.5089398339430767, 'f1-score': 0.5146197094246955, 'support': 1616442}, 'weighted avg': {'precision': 0.5726887625515152, 'recall': 0.5781345696288516, 'f1-score': 0.5679006176187947, 'support': 1616442}}
[[116350 196177  49430]
 [ 80454 642166 169200]
 [ 20372 166288 176005]]
Evaluating performance on  train set...
2155/2155 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92459434
{'0': {'precision': 0.526481295718134, 'recall': 0.3378392061563386, 'f1-score': 0.4115742311233683, 'support': 138264}, '1': {'precision': 0.5621909819738939, 'recall': 0.7937538571835077, 'f1-score': 0.6581997254296291, 'support': 270599}, '2': {'precision': 0.5376852688797811, 'recall': 0.30434965446670126, 'f1-score': 0.3886877402781072, 'support': 142678}, 'accuracy': 0.552858264390136, 'macro avg': {'precision': 0.542119182190603, 'recall': 0.47864757260218255, 'f1-score': 0.48615389894370153, 'support': 551541}, 'weighted avg': {'precision': 0.5468996614858282, 'recall': 0.552858264390136, 'f1-score': 0.5266540046904462, 'support': 551541}}
[[ 46711  80166  11387]
 [ 29860 214789  25950]
 [ 12152  87102  43424]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87892604
{'0': {'precision': 0.55825491199748, 'recall': 0.33021240916713246, 'f1-score': 0.4149678778920873, 'support': 42936}, '1': {'precision': 0.6288152307031635, 'recall': 0.7573778028946083, 'f1-score': 0.6871347443155896, 'support': 104401}, '2': {'precision': 0.4609325692358183, 'recall': 0.4205265218693139, 'f1-score': 0.43980343980343983, 'support': 43417}, 'accuracy': 0.5845591704498988, 'macro avg': {'precision': 0.549334237312154, 'recall': 0.5027055779770182, 'f1-score': 0.5139686873370389, 'support': 190754}, 'weighted avg': {'precision': 0.5747217943564817, 'recall': 0.5845591704498988, 'f1-score': 0.5695794646110304, 'support': 190754}}
[[14178 24107  4651]
 [ 8628 79071 16702]
 [ 2591 22568 18258]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
6082/6082 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9851674
{'0': {'precision': 0.5154874145296484, 'recall': 0.30176513905057245, 'f1-score': 0.38068068589788795, 'support': 411469}, '1': {'precision': 0.5297389126860225, 'recall': 0.8276561808788256, 'f1-score': 0.6460045235395112, 'support': 739191}, '2': {'precision': 0.5507234676768304, 'recall': 0.21835358887488182, 'f1-score': 0.3127188481841552, 'support': 406144}, 'accuracy': 0.5297044457748054, 'macro avg': {'precision': 0.5319832649641671, 'recall': 0.44925830293475993, 'f1-score': 0.44646801920718476, 'support': 1556804}, 'weighted avg': {'precision': 0.5314467072492954, 'recall': 0.5297044457748054, 'f1-score': 0.488929829819501, 'support': 1556804}}
[[124167 264159  23143]
 [ 78191 611796  49204]
 [ 38515 278946  88683]]
Evaluating performance on  train set...
2440/2440 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1443375
{'0': {'precision': 0.5305271049735782, 'recall': 0.21746436148065904, 'f1-score': 0.30848142874720946, 'support': 201748}, '1': {'precision': 0.3902638157778912, 'recall': 0.8011737121017036, 'f1-score': 0.5248602678181654, 'support': 221349}, '2': {'precision': 0.512711186301182, 'recall': 0.2226065809717604, 'f1-score': 0.3104314604875213, 'support': 201490}, 'accuracy': 0.42598549121259327, 'macro avg': {'precision': 0.4778340356842172, 'recall': 0.41374821818470764, 'f1-score': 0.38125771901763206, 'support': 624587}, 'weighted avg': {'precision': 0.47507147068487665, 'recall': 0.42598549121259327, 'f1-score': 0.38579355907472584, 'support': 624587}}
[[ 43873 138903  18972]
 [ 20353 177339  23657]
 [ 18471 138166  44853]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0296607
{'0': {'precision': 0.543659611671706, 'recall': 0.24874577062186443, 'f1-score': 0.34132284328972645, 'support': 59997}, '1': {'precision': 0.4899499890686489, 'recall': 0.7732526794763969, 'f1-score': 0.5998327129772908, 'support': 92742}, '2': {'precision': 0.4701613546346261, 'recall': 0.3013168878515818, 'f1-score': 0.36726260927344834, 'support': 58699}, 'accuracy': 0.49340232124783623, 'macro avg': {'precision': 0.5012569851249936, 'recall': 0.4411051126499477, 'f1-score': 0.43613938851348855, 'support': 211438}, 'weighted avg': {'precision': 0.49969678564576797, 'recall': 0.49340232124783623, 'f1-score': 0.4619130903505319, 'support': 211438}}
[[14924 38018  7055]
 [ 8152 71713 12877]
 [ 4375 36637 17687]]
testing model on single stock: results/universal/W3/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
13689/13689 - 76s - 76s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2912446
{'0': {'precision': 0.5044049634141465, 'recall': 0.030992649226596433, 'f1-score': 0.0583971453370624, 'support': 1221096}, '1': {'precision': 0.29560532675696827, 'recall': 0.9230996789275486, 'f1-score': 0.4478084211451389, 'support': 1037772}, '2': {'precision': 0.5025169609751698, 'recall': 0.07606927374660545, 'f1-score': 0.13213622437842554, 'support': 1245378}, 'accuracy': 0.3112073182076829, 'macro avg': {'precision': 0.4341757503820949, 'recall': 0.34338720063358347, 'f1-score': 0.21278059695354226, 'support': 3504246}, 'weighted avg': {'precision': 0.4418985945021349, 'recall': 0.3112073182076829, 'f1-score': 0.1999263488508208, 'support': 3504246}}
[[  37845 1146188   37063]
 [  23082  957967   56723]
 [  14102 1136541   94735]]
Evaluating performance on  train set...
5475/5475 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3078247
{'0': {'precision': 0.42271546635183, 'recall': 0.01928446470583166, 'f1-score': 0.036886166348327226, 'support': 464156}, '1': {'precision': 0.3285043096062429, 'recall': 0.9468784912887628, 'f1-score': 0.4877808683691399, 'support': 463654}, '2': {'precision': 0.40286182264889214, 'recall': 0.03738000151976967, 'f1-score': 0.06841228941075574, 'support': 473756}, 'accuracy': 0.33225977228328885, 'macro avg': {'precision': 0.38469386620232165, 'recall': 0.33451431917145474, 'f1-score': 0.19769310804274096, 'support': 1401566}, 'weighted avg': {'precision': 0.3848384327366828, 'recall': 0.33225977228328885, 'f1-score': 0.1967037005410244, 'support': 1401566}}
[[  8951 445692   9513]
 [  7894 439024  16736]
 [  4330 451717  17709]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3076595
{'0': {'precision': 0.3782415411212645, 'recall': 0.017275998601225057, 'f1-score': 0.033042784094586726, 'support': 177298}, '1': {'precision': 0.3066913856506704, 'recall': 0.9341027020675239, 'f1-score': 0.46177082059435, 'support': 161691}, '2': {'precision': 0.44437987311734223, 'recall': 0.05035477728327855, 'f1-score': 0.09045919675072459, 'support': 182227}, 'accuracy': 0.313257843197446, 'macro avg': {'precision': 0.3764375999630924, 'recall': 0.3339111593173425, 'f1-score': 0.19509093381322043, 'support': 521216}, 'weighted avg': {'precision': 0.37916855340878725, 'recall': 0.313257843197446, 'f1-score': 0.18611614634511867, 'support': 521216}}
[[  3063 169730   4505]
 [  3687 151036   6968]
 [  1348 171703   9176]]
training model: results/universal/W3/deepOF_L1/h10
Epoch 1/50
10532/10532 - 152s - loss: 2.9406 - accuracy10: 0.5375 - val_loss: 3.6009 - val_accuracy10: 0.5292 - 152s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 148s - loss: 2.9323 - accuracy10: 0.5383 - val_loss: 3.5724 - val_accuracy10: 0.5289 - 148s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 145s - loss: 2.9199 - accuracy10: 0.5393 - val_loss: 3.5979 - val_accuracy10: 0.5289 - 145s/epoch - 14ms/step
Epoch 4/50
10532/10532 - 143s - loss: 2.9063 - accuracy10: 0.5406 - val_loss: 3.6419 - val_accuracy10: 0.5289 - 143s/epoch - 14ms/step
Epoch 5/50
10532/10532 - 145s - loss: 2.8940 - accuracy10: 0.5406 - val_loss: 3.6414 - val_accuracy10: 0.5297 - 145s/epoch - 14ms/step
Epoch 6/50
10532/10532 - 149s - loss: 2.8823 - accuracy10: 0.5405 - val_loss: 3.6927 - val_accuracy10: 0.5296 - 149s/epoch - 14ms/step
Epoch 7/50
10532/10532 - 149s - loss: 2.8726 - accuracy10: 0.5406 - val_loss: 3.7602 - val_accuracy10: 0.5299 - 149s/epoch - 14ms/step
Epoch 8/50
10532/10532 - 142s - loss: 2.8642 - accuracy10: 0.5406 - val_loss: 3.7957 - val_accuracy10: 0.5300 - 142s/epoch - 14ms/step
Epoch 9/50
10532/10532 - 150s - loss: 2.8566 - accuracy10: 0.5411 - val_loss: 3.8191 - val_accuracy10: 0.5300 - 150s/epoch - 14ms/step
Epoch 10/50
10532/10532 - 147s - loss: 2.8488 - accuracy10: 0.5414 - val_loss: 3.8662 - val_accuracy10: 0.5300 - 147s/epoch - 14ms/step
Epoch 11/50
10532/10532 - 152s - loss: 2.8428 - accuracy10: 0.5418 - val_loss: 3.8746 - val_accuracy10: 0.5303 - 152s/epoch - 14ms/step
Epoch 12/50
10532/10532 - 143s - loss: 2.8374 - accuracy10: 0.5416 - val_loss: 3.8507 - val_accuracy10: 0.5304 - 143s/epoch - 14ms/step
testing model in sample: results/universal/W3/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 132s - 132s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98863083
{'0': {'precision': 0.4627886418169984, 'recall': 0.030000409334076432, 'f1-score': 0.05634804043328815, 'support': 1587945}, '1': {'precision': 0.5519477193794187, 'recall': 0.9740806608826765, 'f1-score': 0.7046285720760322, 'support': 3894428}, '2': {'precision': 0.43077354260089684, 'recall': 0.02970355667159575, 'f1-score': 0.05557499539275858, 'support': 1604084}, 'accuracy': 0.5487612498036748, 'macro avg': {'precision': 0.4818366345991046, 'recall': 0.3445948756294495, 'f1-score': 0.272183869300693, 'support': 7086457}, 'weighted avg': {'precision': 0.5045399287721439, 'recall': 0.5487612498036748, 'f1-score': 0.4124416179577966, 'support': 7086457}}
[[  47639 1531287    9019]
 [  46999 3793487   53942]
 [   8301 1548136   47647]]
Evaluating performance on  train set...
10532/10532 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0647767
{'0': {'precision': 0.43055304699635155, 'recall': 0.017772310445090585, 'f1-score': 0.034135577153020125, 'support': 670650}, '1': {'precision': 0.4988257776301422, 'recall': 0.9774185572660979, 'f1-score': 0.660543191087215, 'support': 1342784}, '2': {'precision': 0.4453899559661777, 'recall': 0.02416141413223637, 'f1-score': 0.04583631040915447, 'support': 682369}, 'accuracy': 0.49739094436796755, 'macro avg': {'precision': 0.4582562601975571, 'recall': 0.3397840939478083, 'f1-score': 0.24683835954979652, 'support': 2695803}, 'weighted avg': {'precision': 0.468315367562133, 'recall': 0.49739094436796755, 'f1-score': 0.3491119827435878, 'support': 2695803}}
[[  11919  655298    3433]
 [  13225 1312462   17097]
 [   2539  663343   16487]]
Evaluating performance on  val set...
3814/3814 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0149398
{'0': {'precision': 0.43638525564803804, 'recall': 0.02277250103048005, 'f1-score': 0.04328614093691159, 'support': 225623}, '1': {'precision': 0.531606393129269, 'recall': 0.9761721247665023, 'f1-score': 0.6883495634951446, 'support': 517671}, '2': {'precision': 0.42398159827854864, 'recall': 0.024572116625096757, 'f1-score': 0.04645207445013963, 'support': 232540}, 'accuracy': 0.5289711159889899, 'macro avg': {'precision': 0.4639910823519519, 'recall': 0.34117224747402636, 'f1-score': 0.259362592960732, 'support': 975834}, 'weighted avg': {'precision': 0.4839434212544273, 'recall': 0.5289711159889899, 'f1-score': 0.3862408168329238, 'support': 975834}}
[[  5138 219449   1036]
 [  5608 505336   6727]
 [  1028 225798   5714]]
testing model out of sample: results/universal/W3/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 101s - 101s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8997086
{'0': {'precision': 0.4537139372689508, 'recall': 0.030717309158557304, 'f1-score': 0.0575391095575095, 'support': 775133}, '1': {'precision': 0.6313367154819561, 'recall': 0.976379612160687, 'f1-score': 0.7668321666035735, 'support': 2586071}, '2': {'precision': 0.44626486070858223, 'recall': 0.048662412494727435, 'f1-score': 0.08775561950000815, 'support': 775239}, 'accuracy': 0.6253010134552803, 'macro avg': {'precision': 0.5104385044864964, 'recall': 0.35191977793799056, 'f1-score': 0.304042298553697, 'support': 4136443}, 'weighted avg': {'precision': 0.5633661918781648, 'recall': 0.6253010134552803, 'f1-score': 0.5066465243773159, 'support': 4136443}}
[[  23810  743844    7479]
 [  21753 2524987   39331]
 [   6915  730599   37725]]
Evaluating performance on  train set...
6181/6181 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0006961
{'0': {'precision': 0.4701856231634774, 'recall': 0.036897888937944844, 'f1-score': 0.0684260343303547, 'support': 355603}, '1': {'precision': 0.5540112623385373, 'recall': 0.9701655039719801, 'f1-score': 0.7052759593414766, 'support': 867955}, '2': {'precision': 0.4627872716558633, 'recall': 0.04384723397009109, 'f1-score': 0.08010485489378089, 'support': 358221}, 'accuracy': 0.5505750171168033, 'macro avg': {'precision': 0.49566138571929264, 'recall': 0.35030354229333865, 'f1-score': 0.284602282855204, 'support': 1581779}, 'weighted avg': {'precision': 0.5145070092577296, 'recall': 0.5505750171168033, 'f1-score': 0.4205236885817258, 'support': 1581779}}
[[ 13121 338905   3577]
 [ 11239 842060  14656]
 [  3546 338968  15707]]
Evaluating performance on  val set...
2209/2209 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92972755
{'0': {'precision': 0.4533731029037635, 'recall': 0.0456823626125927, 'f1-score': 0.0830014133367596, 'support': 113129}, '1': {'precision': 0.6072907392359421, 'recall': 0.9670437530212104, 'f1-score': 0.7460634554271388, 'support': 339268}, '2': {'precision': 0.4399847094801223, 'recall': 0.051233430369717524, 'f1-score': 0.09177969683196581, 'support': 112329}, 'accuracy': 0.6003088223315378, 'macro avg': {'precision': 0.500216183873276, 'recall': 0.3546531820011735, 'f1-score': 0.30694818853195477, 'support': 564726}, 'weighted avg': {'precision': 0.5431784665637709, 'recall': 0.6003088223315378, 'f1-score': 0.48309241092258315, 'support': 564726}}
[[  5168 106728   1233]
 [  5089 328087   6092]
 [  1142 105432   5755]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2098979
{'0': {'precision': 0.4437194127243067, 'recall': 0.005583495843169455, 'f1-score': 0.011028219266947779, 'support': 48715}, '1': {'precision': 0.43407860262008735, 'recall': 0.9914885694147062, 'f1-score': 0.6038073563534905, 'support': 75193}, '2': {'precision': 0.35804878048780486, 'recall': 0.007417138237671787, 'f1-score': 0.014533214533214536, 'support': 49480}, 'accuracy': 0.4336632292892242, 'macro avg': {'precision': 0.4119489319440663, 'recall': 0.33482973449851583, 'f1-score': 0.20978959671788425, 'support': 173388}, 'weighted avg': {'precision': 0.4150905323102719, 'recall': 0.4336632292892242, 'f1-score': 0.2690983787977301, 'support': 173388}}
[[  272 48208   235]
 [  217 74553   423]
 [  124 48989   367]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1953977
{'0': {'precision': 0.5, 'recall': 0.006902365772696138, 'f1-score': 0.013616755885868718, 'support': 18979}, '1': {'precision': 0.4368495634551799, 'recall': 0.9933476543552076, 'f1-score': 0.6068302801324994, 'support': 28862}, '2': {'precision': 0.5, 'recall': 0.01179270799523964, 'f1-score': 0.023041961737659863, 'support': 18486}, 'accuracy': 0.43751413451535576, 'macro avg': {'precision': 0.47894985448505994, 'recall': 0.33734757604104776, 'f1-score': 0.21449633258534265, 'support': 66327}, 'weighted avg': {'precision': 0.4725202722939889, 'recall': 0.43751413451535576, 'f1-score': 0.2743787848059535, 'support': 66327}}
[[  131 18743   105]
 [   79 28670   113]
 [   52 18216   218]]
Evaluating performance on  val set...
86/86 - 1s - 610ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2280271
{'0': {'precision': 0.37254901960784315, 'recall': 0.002953061858874728, 'f1-score': 0.005859676175790285, 'support': 6434}, '1': {'precision': 0.4259743836937061, 'recall': 0.9946403687426305, 'f1-score': 0.596490100282849, 'support': 9329}, '2': {'precision': 0.32, 'recall': 0.005185545292497164, 'f1-score': 0.010205708818370275, 'support': 6171}, 'accuracy': 0.4253670101212729, 'macro avg': {'precision': 0.37284113443384975, 'recall': 0.33425965863133417, 'f1-score': 0.20418516175900317, 'support': 21934}, 'weighted avg': {'precision': 0.38048761820167076, 'recall': 0.4253670101212729, 'f1-score': 0.25829017649183444, 'support': 21934}}
[[  19 6383   32]
 [  14 9279   36]
 [  18 6121   32]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6486985
{'0': {'precision': 0.3444885285492496, 'recall': 0.058443078724026924, 'f1-score': 0.09993244426651988, 'support': 34170}, '1': {'precision': 0.827483354930962, 'recall': 0.9811773121042732, 'f1-score': 0.897800133325253, 'support': 301976}, '2': {'precision': 0.3646449704142012, 'recall': 0.0595356700781934, 'f1-score': 0.10235913939425398, 'support': 33123}, 'accuracy': 0.8131226829222058, 'macro avg': {'precision': 0.5122056179648043, 'recall': 0.3663853536354979, 'f1-score': 0.3666972389953423, 'support': 369269}, 'weighted avg': {'precision': 0.7412737650985858, 'recall': 0.8131226829222058, 'f1-score': 0.7526199774575429, 'support': 369269}}
[[  1997  31660    513]
 [  2761 296292   2923]
 [  1039  30112   1972]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83928114
{'0': {'precision': 0.46263736263736266, 'recall': 0.04544963834610817, 'f1-score': 0.08276811166814114, 'support': 27789}, '1': {'precision': 0.6784313725490196, 'recall': 0.978267224526337, 'f1-score': 0.8012165604857263, 'support': 109466}, '2': {'precision': 0.48299514146899114, 'recall': 0.06301502666020359, 'f1-score': 0.11148492644633552, 'support': 26819}, 'accuracy': 0.6706729890171508, 'macro avg': {'precision': 0.541354625551791, 'recall': 0.3622439631775496, 'f1-score': 0.331823199533401, 'support': 164074}, 'weighted avg': {'precision': 0.6099372539027361, 'recall': 0.6706729890171508, 'f1-score': 0.5667926015556441, 'support': 164074}}
[[  1263  26066    460]
 [  1030 107087   1349]
 [   437  24692   1690]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7655978
{'0': {'precision': 0.43703703703703706, 'recall': 0.04805049373918355, 'f1-score': 0.08658167476841237, 'support': 9823}, '1': {'precision': 0.7305008574300751, 'recall': 0.9794259890589074, 'f1-score': 0.8368446010025741, 'support': 50452}, '2': {'precision': 0.42560801144492133, 'recall': 0.060424494769980706, 'f1-score': 0.10582481102712317, 'support': 9847}, 'accuracy': 0.7199024557200308, 'macro avg': {'precision': 0.5310486353040113, 'recall': 0.36263365918935725, 'f1-score': 0.3430836955993699, 'support': 70122}, 'weighted avg': {'precision': 0.6465760554829456, 'recall': 0.7199024557200308, 'f1-score': 0.6290897651980272, 'support': 70122}}
[[  472  9171   180]
 [  415 49414   623]
 [  193  9059   595]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
1359/1359 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2333443
{'0': {'precision': 0.5423948220064725, 'recall': 0.03807602482665867, 'f1-score': 0.07115685075742137, 'support': 110043}, '1': {'precision': 0.37780291316459197, 'recall': 0.9600360806616827, 'f1-score': 0.5422243329591572, 'support': 130818}, '2': {'precision': 0.4926797385620915, 'recall': 0.035245380414453506, 'f1-score': 0.06578465082994432, 'support': 106936}, 'accuracy': 0.38398548578624886, 'macro avg': {'precision': 0.470959157911052, 'recall': 0.3444524953009316, 'f1-score': 0.22638861151550763, 'support': 347797}, 'weighted avg': {'precision': 0.46520060671972346, 'recall': 0.38398548578624886, 'f1-score': 0.2466891995563529, 'support': 347797}}
[[  4190 104811   1042]
 [  2389 125590   2839]
 [  1146 102021   3769]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2855068
{'0': {'precision': 0.5944618133095132, 'recall': 0.03543474788349928, 'f1-score': 0.0668827416396573, 'support': 37562}, '1': {'precision': 0.3397979946107455, 'recall': 0.9686218158066623, 'f1-score': 0.5031041993201294, 'support': 38275}, '2': {'precision': 0.5670976370931787, 'recall': 0.033694471669624644, 'f1-score': 0.06360954143121468, 'support': 37751}, 'accuracy': 0.349306264746276, 'macro avg': {'precision': 0.5004524816711458, 'recall': 0.34591701178659534, 'f1-score': 0.2111988274636671, 'support': 113588}, 'weighted avg': {'precision': 0.4995549333834807, 'recall': 0.349306264746276, 'f1-score': 0.21278556334310444, 'support': 113588}}
[[ 1331 35908   323]
 [  553 37074   648]
 [  355 36124  1272]]
Evaluating performance on  val set...
144/144 - 1s - 952ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2378516
{'0': {'precision': 0.5727170236753101, 'recall': 0.04327824160845119, 'f1-score': 0.08047524752475248, 'support': 11738}, '1': {'precision': 0.36365454389623747, 'recall': 0.963004993191103, 'f1-score': 0.5279442566516663, 'support': 13218}, '2': {'precision': 0.598404255319149, 'recall': 0.03850761595071025, 'f1-score': 0.07235890014471778, 'support': 11686}, 'accuracy': 0.3735331040882048, 'macro avg': {'precision': 0.5115919409635655, 'recall': 0.34826361691675484, 'f1-score': 0.22692613477371218, 'support': 36642}, 'weighted avg': {'precision': 0.5054934313842266, 'recall': 0.3735331040882048, 'f1-score': 0.23930385205388466, 'support': 36642}}
[[  508 11138    92]
 [  279 12729   210]
 [  100 11136   450]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3064466
{'0': {'precision': 0.5154004106776181, 'recall': 0.012162266930263208, 'f1-score': 0.02376376357422152, 'support': 103188}, '1': {'precision': 0.32290542469416034, 'recall': 0.9883004794885456, 'f1-score': 0.48676959894198774, 'support': 93850}, '2': {'precision': 0.5582120582120582, 'recall': 0.011357507693283843, 'f1-score': 0.02226206639236374, 'support': 94563}, 'accuracy': 0.3260654112983152, 'macro avg': {'precision': 0.46550596452794557, 'recall': 0.3372734180373642, 'f1-score': 0.17759847630285766, 'support': 291601}, 'weighted avg': {'precision': 0.46733042254743934, 'recall': 0.3260654112983152, 'f1-score': 0.17229237856064764, 'support': 291601}}
[[  1255 101542    391]
 [   639  92752    459]
 [   541  92948   1074]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2998232
{'0': {'precision': 0.5008665511265165, 'recall': 0.00871742277992278, 'f1-score': 0.017136588692223308, 'support': 33152}, '1': {'precision': 0.3309644774461608, 'recall': 0.9915575412109074, 'f1-score': 0.4962795611038716, 'support': 32455}, '2': {'precision': 0.6128500823723229, 'recall': 0.011337661150224011, 'f1-score': 0.022263450834879406, 'support': 32811}, 'accuracy': 0.33369912007966024, 'macro avg': {'precision': 0.48156037031500004, 'recall': 0.3372042083803514, 'f1-score': 0.17855986687699144, 'support': 98418}, 'weighted avg': {'precision': 0.48217200177995595, 'recall': 0.33369912007966024, 'f1-score': 0.17685130188882084, 'support': 98418}}
[[  289 32732   131]
 [  170 32181   104]
 [  118 32321   372]]
Evaluating performance on  val set...
139/139 - 1s - 892ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3059776
{'0': {'precision': 0.486404833836858, 'recall': 0.012753485424588085, 'f1-score': 0.024855268236202238, 'support': 12624}, '1': {'precision': 0.32271853573170384, 'recall': 0.9874473314606742, 'f1-score': 0.48645376116240363, 'support': 11392}, '2': {'precision': 0.5519125683060109, 'recall': 0.008894760017613386, 'f1-score': 0.01750736696134512, 'support': 11355}, 'accuracy': 0.32543609171355065, 'macro avg': {'precision': 0.4536786459581909, 'recall': 0.33636519230095857, 'f1-score': 0.1762721321199837, 'support': 35371}, 'weighted avg': {'precision': 0.45471576699914673, 'recall': 0.32543609171355065, 'f1-score': 0.17116423921353632, 'support': 35371}}
[[  161 12427    36]
 [   97 11249    46]
 [   73 11181   101]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2615552
{'0': {'precision': 0.5821121015259103, 'recall': 0.020536190171623496, 'f1-score': 0.03967277426263521, 'support': 187620}, '1': {'precision': 0.3555939362419881, 'recall': 0.9768608125262451, 'f1-score': 0.5213922376093764, 'support': 207181}, '2': {'precision': 0.5324817518248175, 'recall': 0.023135472276547386, 'f1-score': 0.044344258142951225, 'support': 189190}, 'accuracy': 0.3606511059245776, 'macro avg': {'precision': 0.4900625965309053, 'recall': 0.34017749165813865, 'f1-score': 0.20180309000498756, 'support': 583991}, 'weighted avg': {'precision': 0.4856725573178009, 'recall': 0.3606511059245776, 'f1-score': 0.21208453775035707, 'support': 583991}}
[[  3853 182726   1041]
 [  1992 202387   2802]
 [   774 184039   4377]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2914915
{'0': {'precision': 0.5426906511274385, 'recall': 0.028797676826071174, 'f1-score': 0.05469308548667144, 'support': 74381}, '1': {'precision': 0.33175516814590894, 'recall': 0.9704702683786912, 'f1-score': 0.4944743329938725, 'support': 74298}, '2': {'precision': 0.5557486243845932, 'recall': 0.025229418106281716, 'f1-score': 0.04826762246117084, 'support': 76062}, 'accuracy': 0.3389012240757138, 'macro avg': {'precision': 0.4767314812193136, 'recall': 0.34149912110368136, 'f1-score': 0.19914501364723827, 'support': 224741}, 'weighted avg': {'precision': 0.4773760491959886, 'recall': 0.3389012240757138, 'f1-score': 0.19790742358539132, 'support': 224741}}
[[ 2142 71696   543]
 [ 1203 72104   991]
 [  602 73541  1919]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.258469
{'0': {'precision': 0.5457788347205708, 'recall': 0.03665987780040733, 'f1-score': 0.06870486098117726, 'support': 25041}, '1': {'precision': 0.3506789158898648, 'recall': 0.9670145982690094, 'f1-score': 0.5147048647152447, 'support': 26921}, '2': {'precision': 0.5424430641821946, 'recall': 0.030938791576461327, 'f1-score': 0.05853876517464811, 'support': 25405}, 'accuracy': 0.3585120270916541, 'macro avg': {'precision': 0.4796336049308767, 'recall': 0.3448710892152927, 'f1-score': 0.21398283029035667, 'support': 77367}, 'weighted avg': {'precision': 0.47679554513497374, 'recall': 0.3585120270916541, 'f1-score': 0.22055896462433205, 'support': 77367}}
[[  918 23918   205]
 [  430 26033   458]
 [  334 24285   786]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/EXC
Evaluating performance on  test set...
5098/5098 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71277016
{'0': {'precision': 0.34484643130396764, 'recall': 0.061759812077909364, 'f1-score': 0.10475811003752032, 'support': 153255}, '1': {'precision': 0.7730000056173418, 'recall': 0.9636746343703386, 'f1-score': 0.8578699551769189, 'support': 999577}, '2': {'precision': 0.3101950892429516, 'recall': 0.06388295249054743, 'f1-score': 0.10594675943596846, 'support': 152075}, 'accuracy': 0.752886604179455, 'macro avg': {'precision': 0.47601384205475367, 'recall': 0.36310579964626505, 'f1-score': 0.35619160821680257, 'support': 1304907}, 'weighted avg': {'precision': 0.6687797556769004, 'recall': 0.752886604179455, 'f1-score': 0.6817908355008473, 'support': 1304907}}
[[  9465 142154   1636]
 [ 16342 963267  19968]
 [  1640 140720   9715]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7193528
{'0': {'precision': 0.3313270008464215, 'recall': 0.06228122900682389, 'f1-score': 0.10485275078498192, 'support': 56566}, '1': {'precision': 0.7707285388107881, 'recall': 0.9628189716408939, 'f1-score': 0.8561312045710732, 'support': 366020}, '2': {'precision': 0.3423913043478261, 'recall': 0.07325708533643416, 'f1-score': 0.12069138061675269, 'support': 57619}, 'accuracy': 0.7500026030549453, 'macro avg': {'precision': 0.4814822813350119, 'recall': 0.36611909532805065, 'f1-score': 0.36055844532426923, 'support': 480205}, 'weighted avg': {'precision': 0.6675735310349138, 'recall': 0.7500026030549453, 'f1-score': 0.679389762409313, 'support': 480205}}
[[  3523  52192    851]
 [  6353 352411   7256]
 [   757  52641   4221]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67947716
{'0': {'precision': 0.3067922374429224, 'recall': 0.06534159980549477, 'f1-score': 0.1077370214471838, 'support': 16452}, '1': {'precision': 0.79803373391809, 'recall': 0.9629173694434008, 'f1-score': 0.8727562535093916, 'support': 125099}, '2': {'precision': 0.3271290158082611, 'recall': 0.07627370548718863, 'f1-score': 0.12370438220122451, 'support': 16821}, 'accuracy': 0.7755032455231985, 'macro avg': {'precision': 0.4773183290564245, 'recall': 0.3681775582453614, 'f1-score': 0.36806588571926663, 'support': 158372}, 'weighted avg': {'precision': 0.6969868735934437, 'recall': 0.7755032455231985, 'f1-score': 0.7137262612559495, 'support': 158372}}
[[  1075  15155    222]
 [  2222 120460   2417]
 [   207  15331   1283]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/AAL
Evaluating performance on  test set...
5760/5760 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6754939
{'0': {'precision': 0.3805016102273836, 'recall': 0.025542257073416792, 'f1-score': 0.04787103427954032, 'support': 152649}, '1': {'precision': 0.797766638460307, 'recall': 0.9863561972494752, 'f1-score': 0.8820940487443042, 'support': 1167050}, '2': {'precision': 0.4071324531316074, 'recall': 0.0559870257417554, 'f1-score': 0.09843738462150173, 'support': 154768}, 'accuracy': 0.7892282431549842, 'macro avg': {'precision': 0.5284669006064326, 'recall': 0.3559618266882158, 'f1-score': 0.34280082254844874, 'support': 1474467}, 'weighted avg': {'precision': 0.7135648483289039, 'recall': 0.7892282431549842, 'f1-score': 0.7134715678559631, 'support': 1474467}}
[[   3899  146818    1932]
 [   5237 1151127   10686]
 [   1111  144992    8665]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7888928
{'0': {'precision': 0.44794690999585235, 'recall': 0.05311497178267124, 'f1-score': 0.09496905811358913, 'support': 81333}, '1': {'precision': 0.7121553709910311, 'recall': 0.9720351149830445, 'f1-score': 0.8220448146359082, 'support': 388666}, '2': {'precision': 0.425459825750242, 'recall': 0.06389706684112965, 'f1-score': 0.11110759993679886, 'support': 82539}, 'accuracy': 0.7011119597204174, 'macro avg': {'precision': 0.5285207022457085, 'recall': 0.36301571786894843, 'f1-score': 0.34270715756209874, 'support': 552538}, 'weighted avg': {'precision': 0.6304371355633314, 'recall': 0.7011119597204174, 'f1-score': 0.6088191192642242, 'support': 552538}}
[[  4320  76189    824]
 [  4571 377797   6298]
 [   753  76512   5274]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76639414
{'0': {'precision': 0.41011361104923144, 'recall': 0.06146090672364292, 'f1-score': 0.10690125714949338, 'support': 29954}, '1': {'precision': 0.7342526806256964, 'recall': 0.9667106967764879, 'f1-score': 0.8345975344651291, 'support': 157468}, '2': {'precision': 0.3983739837398374, 'recall': 0.07368913544764896, 'f1-score': 0.12437249703875007, 'support': 29923}, 'accuracy': 0.7190043479261082, 'macro avg': {'precision': 0.5142467584715884, 'recall': 0.3672869129825933, 'f1-score': 0.35529042955112417, 'support': 217345}, 'weighted avg': {'precision': 0.6433384201779797, 'recall': 0.7190043479261082, 'f1-score': 0.636527746406411, 'support': 217345}}
[[  1841  27698    415]
 [  2327 152226   2915]
 [   321  27397   2205]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/WBA
Evaluating performance on  test set...
6315/6315 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7583204
{'0': {'precision': 0.44171450985985805, 'recall': 0.05494369014721733, 'f1-score': 0.09773089486058732, 'support': 225449}, '1': {'precision': 0.7315641723921258, 'recall': 0.9717062944381016, 'f1-score': 0.8347065541760307, 'support': 1165807}, '2': {'precision': 0.43940153375770635, 'recall': 0.07786146317201197, 'f1-score': 0.13228259721446783, 'support': 225182}, 'accuracy': 0.7193235991729964, 'macro avg': {'precision': 0.5375600720032301, 'recall': 0.368170482585777, 'f1-score': 0.35490668208369525, 'support': 1616438}, 'weighted avg': {'precision': 0.6504375941619597, 'recall': 0.7193235991729964, 'f1-score': 0.6340656035837245, 'support': 1616438}}
[[  12387  209664    3398]
 [  14014 1132822   18971]
 [   1642  206007   17533]]
Evaluating performance on  train set...
2155/2155 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8229398
{'0': {'precision': 0.47431583669807087, 'recall': 0.047481642826667864, 'f1-score': 0.08632197750607254, 'support': 89066}, '1': {'precision': 0.6800473594819205, 'recall': 0.9723458686469325, 'f1-score': 0.8003436823876131, 'support': 369782}, '2': {'precision': 0.4780263252535424, 'recall': 0.07169904955066726, 'f1-score': 0.12469511051071334, 'support': 92693}, 'accuracy': 0.6716291263931421, 'macro avg': {'precision': 0.5441298404778446, 'recall': 0.36384218700808924, 'f1-score': 0.33712025680146634, 'support': 551541}, 'weighted avg': {'precision': 0.6128726262635426, 'recall': 0.6716291263931421, 'f1-score': 0.5714886195002398, 'support': 551541}}
[[  4229  83794   1043]
 [  4012 359556   6214]
 [   675  85372   6646]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7597425
{'0': {'precision': 0.46764380530973454, 'recall': 0.06304761194586332, 'f1-score': 0.1111147616387949, 'support': 26821}, '1': {'precision': 0.730210469034283, 'recall': 0.969098562163976, 'f1-score': 0.8328631256896379, 'support': 137081}, '2': {'precision': 0.4468330134357006, 'recall': 0.08670068153886261, 'f1-score': 0.14522316833536073, 'support': 26851}, 'accuracy': 0.7174933028576221, 'macro avg': {'precision': 0.5482290959265727, 'recall': 0.3729489518829007, 'f1-score': 0.36306701855459783, 'support': 190753}, 'weighted avg': {'precision': 0.6534029297136241, 'recall': 0.7174933028576221, 'f1-score': 0.6345866458066094, 'support': 190753}}
[[  1691  24807    323]
 [  1677 132845   2559]
 [   248  24275   2328]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
6082/6082 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86721873
{'0': {'precision': 0.4217928112215079, 'recall': 0.04182089487370792, 'f1-score': 0.07609677015440783, 'support': 276106}, '1': {'precision': 0.6549841038659803, 'recall': 0.9657546163413463, 'f1-score': 0.7805748256052689, 'support': 1005829}, '2': {'precision': 0.44459543993615047, 'recall': 0.07498590217015626, 'f1-score': 0.12832789579857046, 'support': 274865}, 'accuracy': 0.644618448098664, 'macro avg': {'precision': 0.5071241183412128, 'recall': 0.3608538044617368, 'f1-score': 0.3283331638527491, 'support': 1556800}, 'weighted avg': {'precision': 0.5764807667912325, 'recall': 0.644618448098664, 'f1-score': 0.5404730332493891, 'support': 1556800}}
[[ 11547 261270   3289]
 [ 11986 971384  22459]
 [  3843 250411  20611]]
Evaluating performance on  train set...
2440/2440 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0111135
{'0': {'precision': 0.4417282064340888, 'recall': 0.03630326199179619, 'f1-score': 0.06709254878198145, 'support': 143348}, '1': {'precision': 0.5463813647692104, 'recall': 0.9662013769261278, 'f1-score': 0.6980304778237642, 'support': 337854}, '2': {'precision': 0.4564636926082709, 'recall': 0.048883061450799604, 'f1-score': 0.08830903753354585, 'support': 143383}, 'accuracy': 0.5421968186876086, 'macro avg': {'precision': 0.48152442127052336, 'recall': 0.3504625667895745, 'f1-score': 0.28447735471309715, 'support': 624585}, 'weighted avg': {'precision': 0.5017205315303798, 'recall': 0.5421968186876086, 'f1-score': 0.41325357872209856, 'support': 624585}}
[[  5204 136418   1726]
 [  4799 326435   6620]
 [  1778 134596   7009]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8930495
{'0': {'precision': 0.4380165289256198, 'recall': 0.046419098143236075, 'f1-score': 0.08394234902821458, 'support': 39962}, '1': {'precision': 0.6329127093830353, 'recall': 0.965367409243418, 'f1-score': 0.7645634772200194, 'support': 132332}, '2': {'precision': 0.42779850746268655, 'recall': 0.058578581647251174, 'f1-score': 0.1030469171310444, 'support': 39144}, 'accuracy': 0.6238093436373784, 'macro avg': {'precision': 0.4995759152571139, 'recall': 0.3567883630113018, 'f1-score': 0.3171842477930928, 'support': 211438}, 'weighted avg': {'precision': 0.5581038695178768, 'recall': 0.6238093436373784, 'f1-score': 0.5134573101501277, 'support': 211438}}
[[  1855  37605    502]
 [  2018 127749   2565]
 [   362  36489   2293]]
testing model on single stock: results/universal/W3/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
13689/13689 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2068958
{'0': {'precision': 0.5723384437227802, 'recall': 0.02121033732226372, 'f1-score': 0.040904781010537905, 'support': 1071883}, '1': {'precision': 0.38110305860089855, 'recall': 0.981257378763263, 'f1-score': 0.5489886201406473, 'support': 1333218}, '2': {'precision': 0.5412771850313159, 'recall': 0.01564676415491734, 'f1-score': 0.030414337429724984, 'support': 1099141}, 'accuracy': 0.3847231441207542, 'macro avg': {'precision': 0.4982395624516649, 'recall': 0.33937149341348133, 'f1-score': 0.2067692461936367, 'support': 3504242}, 'weighted avg': {'precision': 0.4898386732671954, 'recall': 0.3847231441207542, 'f1-score': 0.2309190674637874, 'support': 3504242}}
[[  22735 1046039    3109]
 [  13522 1308230   11466]
 [   3466 1078477   17198]]
Evaluating performance on  train set...
5475/5475 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2882184
{'0': {'precision': 0.5376458112407211, 'recall': 0.005462455583879399, 'f1-score': 0.010815030973224801, 'support': 464077}, '1': {'precision': 0.33176045881222194, 'recall': 0.9916011017909478, 'f1-score': 0.497179374530008, 'support': 465061}, '2': {'precision': 0.5344271901552886, 'recall': 0.007721827922620849, 'f1-score': 0.015223691870473422, 'support': 472427}, 'accuracy': 0.3334401187244259, 'macro avg': {'precision': 0.4679444867360772, 'recall': 0.334928461765816, 'f1-score': 0.1744060324579021, 'support': 1401565}, 'weighted avg': {'precision': 0.4682449547772122, 'recall': 0.3334401187244259, 'f1-score': 0.17368429384762993, 'support': 1401565}}
[[  2535 460637    905]
 [  1633 461155   2273]
 [   547 468232   3648]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2238353
{'0': {'precision': 0.535277516462841, 'recall': 0.010675221853248531, 'f1-score': 0.020932970348024427, 'support': 159903}, '1': {'precision': 0.37149300979579636, 'recall': 0.9884015760636622, 'f1-score': 0.540018734094359, 'support': 193647}, '2': {'precision': 0.522808267997149, 'recall': 0.008749537771521954, 'f1-score': 0.01721103758975081, 'support': 167666}, 'accuracy': 0.3733097218811395, 'macro avg': {'precision': 0.4765262647519288, 'recall': 0.33594211189614426, 'f1-score': 0.19272091401071142, 'support': 521216}, 'weighted avg': {'precision': 0.47041564081857473, 'recall': 0.3733097218811395, 'f1-score': 0.2125912450639536, 'support': 521216}}
[[  1707 157897    299]
 [  1206 191401   1040]
 [   276 165923   1467]]
training model: results/universal/W3/deepOF_L1/h20
Epoch 1/50
10532/10532 - 147s - loss: 3.0428 - accuracy20: 0.4957 - val_loss: 3.3498 - val_accuracy20: 0.4803 - 147s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 145s - loss: 3.0262 - accuracy20: 0.4996 - val_loss: 3.3643 - val_accuracy20: 0.4801 - 145s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 143s - loss: 3.0105 - accuracy20: 0.5009 - val_loss: 3.3757 - val_accuracy20: 0.4811 - 143s/epoch - 14ms/step
Epoch 4/50
10532/10532 - 150s - loss: 2.9973 - accuracy20: 0.5020 - val_loss: 3.4180 - val_accuracy20: 0.4821 - 150s/epoch - 14ms/step
Epoch 5/50
10532/10532 - 149s - loss: 2.9859 - accuracy20: 0.5027 - val_loss: 3.4807 - val_accuracy20: 0.4819 - 149s/epoch - 14ms/step
Epoch 6/50
10532/10532 - 144s - loss: 2.9739 - accuracy20: 0.5035 - val_loss: 3.4949 - val_accuracy20: 0.4829 - 144s/epoch - 14ms/step
Epoch 7/50
10532/10532 - 141s - loss: 2.9636 - accuracy20: 0.5037 - val_loss: 3.5274 - val_accuracy20: 0.4834 - 141s/epoch - 13ms/step
Epoch 8/50
10532/10532 - 146s - loss: 2.9544 - accuracy20: 0.5046 - val_loss: 3.5245 - val_accuracy20: 0.4840 - 146s/epoch - 14ms/step
Epoch 9/50
10532/10532 - 146s - loss: 2.9483 - accuracy20: 0.5050 - val_loss: 3.5419 - val_accuracy20: 0.4848 - 146s/epoch - 14ms/step
Epoch 10/50
10532/10532 - 143s - loss: 2.9419 - accuracy20: 0.5057 - val_loss: 3.5662 - val_accuracy20: 0.4855 - 143s/epoch - 14ms/step
Epoch 11/50
10532/10532 - 141s - loss: 2.9367 - accuracy20: 0.5062 - val_loss: 3.5793 - val_accuracy20: 0.4857 - 141s/epoch - 13ms/step
testing model in sample: results/universal/W3/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 155s - 155s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0203912
{'0': {'precision': 0.5231059539232805, 'recall': 0.0514090475539364, 'f1-score': 0.09361767331346402, 'support': 1806433}, '1': {'precision': 0.49197912006054256, 'recall': 0.9586536870617012, 'f1-score': 0.6502508354806096, 'support': 3457116}, '2': {'precision': 0.4589963422198262, 'recall': 0.043436640795915096, 'f1-score': 0.0793628599936755, 'support': 1822908}, 'accuracy': 0.4919559943706707, 'macro avg': {'precision': 0.4913604720678831, 'recall': 0.3511664584705176, 'f1-score': 0.27441045626258304, 'support': 7086457}, 'weighted avg': {'precision': 0.49142933478520723, 'recall': 0.4919559943706707, 'f1-score': 0.3615033315231285, 'support': 7086457}}
[[  92867 1695610   17956]
 [  67567 3314177   75372]
 [  17096 1726631   79181]]
Evaluating performance on  train set...
10532/10532 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0572916
{'0': {'precision': 0.5059630606860158, 'recall': 0.03291302968763516, 'f1-score': 0.06180558957684958, 'support': 728283}, '1': {'precision': 0.45720385505951483, 'recall': 0.9663793939957321, 'f1-score': 0.6207327666691023, 'support': 1226361}, '2': {'precision': 0.48421015239245496, 'recall': 0.03678293051828285, 'f1-score': 0.06837199562110247, 'support': 741159}, 'accuracy': 0.45862475855987994, 'macro avg': {'precision': 0.4824590227126619, 'recall': 0.34535845140055005, 'f1-score': 0.25030345062235143, 'support': 2695803}, 'weighted avg': {'precision': 0.47780122841219297, 'recall': 0.45862475855987994, 'f1-score': 0.3178752069648355, 'support': 2695803}}
[[  23970  698152    6161]
 [  18352 1185130   22879]
 [   5053  708844   27262]]
Evaluating performance on  val set...
3814/3814 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0293591
{'0': {'precision': 0.5099252630075689, 'recall': 0.04246025296987906, 'f1-score': 0.07839291595008964, 'support': 252283}, '1': {'precision': 0.47992854252875533, 'recall': 0.9626576951813334, 'f1-score': 0.6405258729430857, 'support': 465772}, '2': {'precision': 0.46627765621201067, 'recall': 0.03719853052420872, 'f1-score': 0.06890035351938609, 'support': 257779}, 'accuracy': 0.4802866061235825, 'macro avg': {'precision': 0.4853771539161116, 'recall': 0.3474388262251404, 'f1-score': 0.26260638080418713, 'support': 975834}, 'weighted avg': {'precision': 0.4840775584563746, 'recall': 0.4802866061235825, 'f1-score': 0.3441950999216641, 'support': 975834}}
[[ 10712 239650   1921]
 [  8338 448379   9055]
 [  1957 246233   9589]]
testing model out of sample: results/universal/W3/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 93s - 93s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97743434
{'0': {'precision': 0.47920334979600604, 'recall': 0.04804465064209518, 'f1-score': 0.08733331376635065, 'support': 928990}, '1': {'precision': 0.5594891169861513, 'recall': 0.9617968445541139, 'f1-score': 0.7074473582005839, 'support': 2281199}, '2': {'precision': 0.46838945959483985, 'recall': 0.06158138048526646, 'f1-score': 0.10885153425512363, 'support': 926254}, 'accuracy': 0.5549993073759266, 'macro avg': {'precision': 0.5023606421256658, 'recall': 0.3571409585604919, 'f1-score': 0.3012107354073527, 'support': 4136443}, 'weighted avg': {'precision': 0.5210584902570256, 'recall': 0.5549993073759266, 'f1-score': 0.4341372890296231, 'support': 4136443}}
[[  44633  871082   13275]
 [  35685 2194050   51464]
 [  12822  856392   57040]]
Evaluating performance on  train set...
6181/6181 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0578932
{'0': {'precision': 0.49810075752642663, 'recall': 0.05427817921638658, 'f1-score': 0.09788933062603443, 'support': 422785}, '1': {'precision': 0.46976181521284976, 'recall': 0.9523678966170567, 'f1-score': 0.6291775892785534, 'support': 733119}, '2': {'precision': 0.4813555892766818, 'recall': 0.05586380980334605, 'f1-score': 0.10010940458657688, 'support': 425875}, 'accuracy': 0.47094948156474453, 'macro avg': {'precision': 0.4830727206719861, 'recall': 0.3541699618789298, 'f1-score': 0.2757254414970549, 'support': 1581779}, 'weighted avg': {'precision': 0.48045785951200914, 'recall': 0.47094948156474453, 'f1-score': 0.3447272206808537, 'support': 1581779}}
[[ 22948 393087   6750]
 [ 16036 698199  18884]
 [  7087 394997  23791]]
Evaluating performance on  val set...
2209/2209 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0071583
{'0': {'precision': 0.4733968466209817, 'recall': 0.06219804995168799, 'f1-score': 0.10995011678237072, 'support': 136612}, '1': {'precision': 0.5245244278264889, 'recall': 0.9484306929336658, 'f1-score': 0.6754789192590976, 'support': 291976}, '2': {'precision': 0.4668153339704789, 'recall': 0.06458152756761522, 'f1-score': 0.11346565831246934, 'support': 136138}, 'accuracy': 0.5209747736070236, 'macro avg': {'precision': 0.48824553613931654, 'recall': 0.35840342348432297, 'f1-score': 0.2996315647846459, 'support': 564726}, 'weighted avg': {'precision': 0.49824435263424305, 'recall': 0.5209747736070236, 'f1-score': 0.4031886721610311, 'support': 564726}}
[[  8497 125899   2216]
 [  7231 276919   7826]
 [  2221 125125   8792]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2448856
{'0': {'precision': 0.464, 'recall': 0.00786160857999695, 'f1-score': 0.015461255227337099, 'support': 59021}, '1': {'precision': 0.32038653330137556, 'recall': 0.9886175048704813, 'f1-score': 0.4839400428265525, 'support': 55436}, '2': {'precision': 0.39954853273137697, 'recall': 0.009010537747535253, 'f1-score': 0.01762363093262529, 'support': 58931}, 'accuracy': 0.3218215793480518, 'macro avg': {'precision': 0.3946450220109175, 'recall': 0.33516321706600455, 'f1-score': 0.17234164299550495, 'support': 173388}, 'weighted avg': {'precision': 0.3961778579975998, 'recall': 0.3218215793480518, 'f1-score': 0.16597929010886547, 'support': 173388}}
[[  464 58150   407]
 [  240 54805   391]
 [  296 58104   531]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2274034
{'0': {'precision': 0.5213675213675214, 'recall': 0.010761224309782129, 'f1-score': 0.021087200760521993, 'support': 22674}, '1': {'precision': 0.3247522932969877, 'recall': 0.9895473635090994, 'f1-score': 0.4890175143262345, 'support': 21430}, '2': {'precision': 0.4857142857142857, 'recall': 0.012239571614993476, 'f1-score': 0.023877452486503095, 'support': 22223}, 'accuracy': 0.3274986053944849, 'macro avg': {'precision': 0.4439447001262649, 'recall': 0.337516053144625, 'f1-score': 0.1779940558577532, 'support': 66327}, 'weighted avg': {'precision': 0.4458962020937205, 'recall': 0.3274986053944849, 'f1-score': 0.1732085749191557, 'support': 66327}}
[[  244 22264   166]
 [  102 21206   122]
 [  122 21829   272]]
Evaluating performance on  val set...
86/86 - 1s - 703ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2540778
{'0': {'precision': 0.4067796610169492, 'recall': 0.006260597365331942, 'f1-score': 0.01233140655105973, 'support': 7667}, '1': {'precision': 0.3130450832910341, 'recall': 0.9919578885802017, 'f1-score': 0.4759031918625043, 'support': 6839}, '2': {'precision': 0.4896551724137931, 'recall': 0.009558427571351643, 'f1-score': 0.01875082530040935, 'support': 7428}, 'accuracy': 0.3147168779064466, 'macro avg': {'precision': 0.4031599722405921, 'recall': 0.33592563783896173, 'f1-score': 0.16899514123799111, 'support': 21934}, 'weighted avg': {'precision': 0.40561929453515033, 'recall': 0.3147168779064466, 'f1-score': 0.1590465922087208, 'support': 21934}}
[[  48 7576   43]
 [  24 6784   31]
 [  46 7311   71]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7919172
{'0': {'precision': 0.4033604783012061, 'recall': 0.08474649687046543, 'f1-score': 0.14006514657980457, 'support': 46173}, '1': {'precision': 0.7676561280974848, 'recall': 0.9660607935092211, 'f1-score': 0.85550585451378, 'support': 278056}, '2': {'precision': 0.39981341349642374, 'recall': 0.08563499111900533, 'f1-score': 0.14105728966664838, 'support': 45040}, 'accuracy': 0.7484760432096926, 'macro avg': {'precision': 0.5236100066317049, 'recall': 0.37881409383289727, 'f1-score': 0.3788760969200777, 'support': 369269}, 'weighted avg': {'precision': 0.6772389555114423, 'recall': 0.7484760432096926, 'f1-score': 0.6789061205308292, 'support': 369269}}
[[  3913  41377    883]
 [  4530 268619   4907]
 [  1258  39925   3857]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9504464
{'0': {'precision': 0.545067264573991, 'recall': 0.06807807555518217, 'f1-score': 0.12103861186487093, 'support': 35709}, '1': {'precision': 0.5868824035556476, 'recall': 0.9669974736438157, 'f1-score': 0.7304474559348101, 'support': 93811}, '2': {'precision': 0.5106087646242317, 'recall': 0.07452103953232621, 'f1-score': 0.13006035810793745, 'support': 34554}, 'accuracy': 0.5834013920548046, 'macro avg': {'precision': 0.5475194775846234, 'recall': 0.369865529577108, 'f1-score': 0.3271821419692062, 'support': 164074}, 'weighted avg': {'precision': 0.5617185377540451, 'recall': 0.5834013920548046, 'f1-score': 0.4713743779870352, 'support': 164074}}
[[ 2431 32603   675]
 [ 1303 90715  1793]
 [  726 31253  2575]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89415777
{'0': {'precision': 0.5025906735751295, 'recall': 0.07473611218121581, 'f1-score': 0.13012274465088203, 'support': 12979}, '1': {'precision': 0.6441366350437971, 'recall': 0.9656927341300495, 'f1-score': 0.7728000000000002, 'support': 44014}, '2': {'precision': 0.49637352674524027, 'recall': 0.08340315332470104, 'f1-score': 0.1428105640691229, 'support': 13129}, 'accuracy': 0.6355922535010411, 'macro avg': {'precision': 0.5477002784547224, 'recall': 0.37461066654532216, 'f1-score': 0.34857776957333503, 'support': 70122}, 'weighted avg': {'precision': 0.5902718439261223, 'recall': 0.6355922535010411, 'f1-score': 0.5358923333402831, 'support': 70122}}
[[  970 11754   255]
 [  654 42504   856]
 [  306 11728  1095]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.163332
{'0': {'precision': 0.5532904941280744, 'recall': 0.04439939899892424, 'f1-score': 0.08220237850294226, 'support': 112479}, '1': {'precision': 0.35891574534846665, 'recall': 0.941203885991627, 'f1-score': 0.5196643233782396, 'support': 124447}, '2': {'precision': 0.43413535044660817, 'recall': 0.048660154594077805, 'f1-score': 0.08751155736508297, 'support': 110871}, 'accuracy': 0.36664778592109765, 'macro avg': {'precision': 0.44878052997438306, 'recall': 0.344754479861543, 'f1-score': 0.22979275308208827, 'support': 347797}, 'weighted avg': {'precision': 0.445755914196437, 'recall': 0.36664778592109765, 'f1-score': 0.24042530918814234, 'support': 347797}}
[[  4994 105038   2447]
 [  2732 117130   4585]
 [  1300 104176   5395]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1784177
{'0': {'precision': 0.5727056019070322, 'recall': 0.05116056218057922, 'f1-score': 0.09393021210047894, 'support': 37568}, '1': {'precision': 0.33553547567208947, 'recall': 0.9487423377721412, 'f1-score': 0.49574431367134913, 'support': 37848}, '2': {'precision': 0.5157076205287714, 'recall': 0.04343497851828566, 'f1-score': 0.08012177736970545, 'support': 38172}, 'accuracy': 0.3476423565869634, 'macro avg': {'precision': 0.47464956603596437, 'recall': 0.3477792928236687, 'f1-score': 0.2232654343805112, 'support': 113588}, 'weighted avg': {'precision': 0.47452496765947894, 'recall': 0.3476423565869634, 'f1-score': 0.22317594708754807, 'support': 113588}}
[[ 1922 35110   536]
 [  919 35908  1021]
 [  515 35999  1658]]
Evaluating performance on  val set...
144/144 - 1s - 976ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1579704
{'0': {'precision': 0.573720397249809, 'recall': 0.06239096120295755, 'f1-score': 0.11254308407013337, 'support': 12037}, '1': {'precision': 0.3451709938377968, 'recall': 0.9420532440618524, 'f1-score': 0.5052258105884113, 'support': 12546}, '2': {'precision': 0.5521978021978022, 'recall': 0.05000414628078614, 'f1-score': 0.09170405292373204, 'support': 12059}, 'accuracy': 0.3595054855084329, 'macro avg': {'precision': 0.4903630644284694, 'recall': 0.351482783848532, 'f1-score': 0.2364909825274256, 'support': 36642}, 'weighted avg': {'precision': 0.48838330350658393, 'recall': 0.3595054855084329, 'f1-score': 0.24013709122869079, 'support': 36642}}
[[  751 11135   151]
 [  389 11819   338]
 [  169 11287   603]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1758236
{'0': {'precision': 0.5210956107519564, 'recall': 0.031092343142529413, 'f1-score': 0.05868321981780039, 'support': 98513}, '1': {'precision': 0.33541672619217694, 'recall': 0.9617803084611761, 'f1-score': 0.4973757937495697, 'support': 97646}, '2': {'precision': 0.4496597452451579, 'recall': 0.027000691519456842, 'f1-score': 0.050942445118756986, 'support': 95442}, 'accuracy': 0.34140486486671856, 'macro avg': {'precision': 0.4353906940630971, 'recall': 0.3399577810410541, 'f1-score': 0.20233381956204236, 'support': 291601}, 'weighted avg': {'precision': 0.4355376660349489, 'recall': 0.34140486486671856, 'f1-score': 0.2030509690892893, 'support': 291601}}
[[ 3063 94576   874]
 [ 1452 93914  2280]
 [ 1363 91502  2577]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1859558
{'0': {'precision': 0.5459985041136873, 'recall': 0.021736541210100047, 'f1-score': 0.04180865381861917, 'support': 33584}, '1': {'precision': 0.33069965583815997, 'recall': 0.9727469135802469, 'f1-score': 0.49359456242560923, 'support': 32400}, '2': {'precision': 0.46933033202025887, 'recall': 0.025713757168403528, 'f1-score': 0.04875624799041244, 'support': 32434}, 'accuracy': 0.33612753764555264, 'macro avg': {'precision': 0.44867616399070204, 'recall': 0.3400657373195835, 'f1-score': 0.19471982141154695, 'support': 98418}, 'weighted avg': {'precision': 0.44985411814968335, 'recall': 0.33612753764555264, 'f1-score': 0.19282982584237926, 'support': 98418}}
[[  730 32483   371]
 [  311 31517   572]
 [  296 31304   834]]
Evaluating performance on  val set...
139/139 - 1s - 961ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.181324
{'0': {'precision': 0.5162337662337663, 'recall': 0.02562656136674994, 'f1-score': 0.04882917466410749, 'support': 12409}, '1': {'precision': 0.33312983312983313, 'recall': 0.9767303102625299, 'f1-score': 0.4968133535660092, 'support': 11732}, '2': {'precision': 0.4481792717086835, 'recall': 0.014247551202137132, 'f1-score': 0.027617157158884957, 'support': 11230}, 'accuracy': 0.33747985637951994, 'macro avg': {'precision': 0.43251429035742767, 'recall': 0.3388681409438057, 'f1-score': 0.19108656179633388, 'support': 35371}, 'weighted avg': {'precision': 0.43389435494508277, 'recall': 0.33747985637951994, 'f1-score': 0.1906837852290749, 'support': 35371}}
[[  318 12008    83]
 [  159 11459   114]
 [  139 10931   160]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
2282/2282 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1681391
{'0': {'precision': 0.5561169252977265, 'recall': 0.03232624120913987, 'f1-score': 0.06110078556736798, 'support': 190681}, '1': {'precision': 0.3412782986957119, 'recall': 0.9613197443774606, 'f1-score': 0.5037280204869875, 'support': 198887}, '2': {'precision': 0.5075721722669191, 'recall': 0.03309793594379266, 'f1-score': 0.06214359177406194, 'support': 194423}, 'accuracy': 0.34896599433895387, 'macro avg': {'precision': 0.4683224654201192, 'recall': 0.34224797384346434, 'f1-score': 0.20899079927613914, 'support': 583991}, 'weighted avg': {'precision': 0.4667887910499324, 'recall': 0.34896599433895387, 'f1-score': 0.21219138179673186, 'support': 583991}}
[[  6164 182643   1874]
 [  3324 191194   4369]
 [  1596 186392   6435]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1795045
{'0': {'precision': 0.5138169257340242, 'recall': 0.04800258165145016, 'f1-score': 0.0878023586123784, 'support': 74371}, '1': {'precision': 0.33120168392437443, 'recall': 0.9456924548897004, 'f1-score': 0.4905887246454824, 'support': 74207}, '2': {'precision': 0.5031318774335534, 'recall': 0.0390215721544582, 'f1-score': 0.07242597782380894, 'support': 76163}, 'accuracy': 0.3413662838556383, 'macro avg': {'precision': 0.44938349569731734, 'recall': 0.34423886956520294, 'f1-score': 0.21693902036055657, 'support': 224741}, 'weighted avg': {'precision': 0.4498983057106309, 'recall': 0.3413662838556383, 'f1-score': 0.21558703775066973, 'support': 224741}}
[[ 3570 69731  1070]
 [ 2165 70177  1865]
 [ 1213 71978  2972]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.164582
{'0': {'precision': 0.5057874430024553, 'recall': 0.05710891089108911, 'f1-score': 0.10262979965125796, 'support': 25250}, '1': {'precision': 0.34459993620060747, 'recall': 0.9382221886564459, 'f1-score': 0.5040625665682724, 'support': 26482}, '2': {'precision': 0.49523809523809526, 'recall': 0.04665496391652038, 'f1-score': 0.08527629233511586, 'support': 25635}, 'accuracy': 0.355241899000866, 'macro avg': {'precision': 0.44854182481371935, 'recall': 0.3473286878213518, 'f1-score': 0.23065621951821544, 'support': 77367}, 'weighted avg': {'precision': 0.44711901738086074, 'recall': 0.355241899000866, 'f1-score': 0.23428651858112562, 'support': 77367}}
[[ 1442 23391   417]
 [  834 24846   802]
 [  575 23864  1196]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/EXC
Evaluating performance on  test set...
5098/5098 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8536474
{'0': {'precision': 0.4044427629445465, 'recall': 0.07119919695146028, 'f1-score': 0.12108267294490761, 'support': 210199}, '1': {'precision': 0.6903202150263054, 'recall': 0.9504714403073292, 'f1-score': 0.7997720453007812, 'support': 887387}, '2': {'precision': 0.3736089719950541, 'recall': 0.08307407353813652, 'f1-score': 0.13592455212690396, 'support': 207321}, 'accuracy': 0.6710248316546696, 'macro avg': {'precision': 0.489457316655302, 'recall': 0.36824823693230874, 'f1-score': 0.35225975679086424, 'support': 1304907}, 'weighted avg': {'precision': 0.5939516261792721, 'recall': 0.6710248316546696, 'f1-score': 0.5849756241672187, 'support': 1304907}}
[[ 14966 191091   4142]
 [ 19217 843436  24734]
 [  2821 187277  17223]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8565284
{'0': {'precision': 0.3846364695401905, 'recall': 0.07302413322058154, 'f1-score': 0.12274486649609659, 'support': 76865}, '1': {'precision': 0.6889238635956586, 'recall': 0.9480067775723968, 'f1-score': 0.7979623271686254, 'support': 324600}, '2': {'precision': 0.42761351636747624, 'recall': 0.10285750571501143, 'f1-score': 0.16582719082719083, 'support': 78740}, 'accuracy': 0.6693703730698347, 'macro avg': {'precision': 0.5003912831677751, 'recall': 0.37462947216932996, 'f1-score': 0.36217812816397094, 'support': 480205}, 'weighted avg': {'precision': 0.5973699912186099, 'recall': 0.6693703730698347, 'f1-score': 0.5862300237771186, 'support': 480205}}
[[  5613  69513   1739]
 [  7775 307723   9102]
 [  1205  69436   8099]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8246492
{'0': {'precision': 0.3791151184734745, 'recall': 0.07859502695183446, 'f1-score': 0.13019839412378928, 'support': 23004}, '1': {'precision': 0.7181180746748403, 'recall': 0.94746354120068, 'f1-score': 0.8170007252079187, 'support': 111770}, '2': {'precision': 0.40263972625061106, 'recall': 0.10471226375116535, 'f1-score': 0.16620144610728096, 'support': 23598}, 'accuracy': 0.6956848432803778, 'macro avg': {'precision': 0.4999576397996419, 'recall': 0.3769236106345599, 'f1-score': 0.3711335218129963, 'support': 158372}, 'weighted avg': {'precision': 0.6218694823064218, 'recall': 0.6956848432803778, 'f1-score': 0.6202692182971253, 'support': 158372}}
[[  1808  20740    456]
 [  2662 105898   3210]
 [   299  20828   2471]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/AAL
Evaluating performance on  test set...
5760/5760 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8219501
{'0': {'precision': 0.46954541395016525, 'recall': 0.050113428397132835, 'f1-score': 0.09056145518435263, 'support': 209824}, '1': {'precision': 0.7261953193358542, 'recall': 0.9750003313220507, 'f1-score': 0.8324035823665068, 'support': 1056374}, '2': {'precision': 0.42380811371039384, 'recall': 0.06871882037173078, 'f1-score': 0.11826193299426951, 'support': 208269}, 'accuracy': 0.7153717241552371, 'macro avg': {'precision': 0.5398496156654712, 'recall': 0.3646108600303048, 'f1-score': 0.3470756568483763, 'support': 1474467}, 'weighted avg': {'precision': 0.6469604563812709, 'recall': 0.7153717241552371, 'f1-score': 0.62596298405744, 'support': 1474467}}
[[  10515  196604    2705]
 [   9656 1029965   16753]
 [   2223  191734   14312]]
Evaluating performance on  train set...
2159/2159 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9215382
{'0': {'precision': 0.5, 'recall': 0.0659786417947515, 'f1-score': 0.11657443748324027, 'support': 108717}, '1': {'precision': 0.6146908330723397, 'recall': 0.9583830128877252, 'f1-score': 0.7489912239114173, 'support': 333806}, '2': {'precision': 0.45624119470273317, 'recall': 0.07358996500477208, 'f1-score': 0.12673763306199123, 'support': 110015}, 'accuracy': 0.6066243407693227, 'macro avg': {'precision': 0.5236440092583576, 'recall': 0.36598387322908293, 'f1-score': 0.3307677648188829, 'support': 552538}, 'weighted avg': {'precision': 0.5605756767132154, 'recall': 0.6066243407693227, 'f1-score': 0.5006613632187379, 'support': 552538}}
[[  7173  99983   1561]
 [  5804 319914   8088]
 [  1369 100550   8096]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89835244
{'0': {'precision': 0.4692195831313621, 'recall': 0.07284220031605088, 'f1-score': 0.12610734757686295, 'support': 39867}, '1': {'precision': 0.6446919832886646, 'recall': 0.9517011156525913, 'f1-score': 0.7686754348349653, 'support': 137498}, '2': {'precision': 0.43533007334963325, 'recall': 0.08906953476738369, 'f1-score': 0.14788205980066443, 'support': 39980}, 'accuracy': 0.63181577676045, 'macro avg': {'precision': 0.51641387992322, 'recall': 0.3712042835786753, 'f1-score': 0.3475549474041642, 'support': 217345}, 'weighted avg': {'precision': 0.573994026876354, 'recall': 0.63181577676045, 'f1-score': 0.5366177336290939, 'support': 217345}}
[[  2904  36250    713]
 [  2735 130857   3906]
 [   550  35869   3561]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/WBA
Evaluating performance on  test set...
6315/6315 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89558923
{'0': {'precision': 0.5024304231795654, 'recall': 0.0692681933307272, 'f1-score': 0.12175102994119158, 'support': 304411}, '1': {'precision': 0.6355228258618802, 'recall': 0.95669900657288, 'f1-score': 0.7637177732033927, 'support': 1007321}, '2': {'precision': 0.47289758247813213, 'recall': 0.09013278373251593, 'f1-score': 0.15140773246743222, 'support': 304706}, 'accuracy': 0.6262244515409808, 'macro avg': {'precision': 0.5369502771731925, 'recall': 0.37203332787870763, 'f1-score': 0.34562551187067214, 'support': 1616438}, 'weighted avg': {'precision': 0.5798029783926829, 'recall': 0.6262244515409808, 'f1-score': 0.5273979876281456, 'support': 1616438}}
[[ 21086 278386   4939]
 [ 17945 963703  25673]
 [  2937 274305  27464]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9483383
{'0': {'precision': 0.5521545319465082, 'recall': 0.06287382090436107, 'f1-score': 0.11289256826035772, 'support': 118205}, '1': {'precision': 0.575588713206027, 'recall': 0.959957823269211, 'f1-score': 0.7196667441885686, 'support': 311072}, '2': {'precision': 0.5143153526970954, 'recall': 0.08110318654714388, 'f1-score': 0.14011190866444356, 'support': 122264}, 'accuracy': 0.572874908664995, 'macro avg': {'precision': 0.5473528659498769, 'recall': 0.3679782769069053, 'f1-score': 0.3242237403711233, 'support': 551541}, 'weighted avg': {'precision': 0.5569834534972377, 'recall': 0.572874908664995, 'f1-score': 0.4611502714764479, 'support': 551541}}
[[  7432 108975   1798]
 [  4890 298616   7566]
 [  1138 111210   9916]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89668643
{'0': {'precision': 0.5132565368440299, 'recall': 0.07772178535828995, 'f1-score': 0.13500060117830948, 'support': 36116}, '1': {'precision': 0.6329451831536828, 'recall': 0.9529470495659385, 'f1-score': 0.7606610744147723, 'support': 118186}, '2': {'precision': 0.47508848352845084, 'recall': 0.09574497270308086, 'f1-score': 0.1593716464598032, 'support': 36451}, 'accuracy': 0.6234344938218533, 'macro avg': {'precision': 0.5404300678420545, 'recall': 0.37547126920910306, 'f1-score': 0.3516777740176283, 'support': 190753}, 'weighted avg': {'precision': 0.5801192265073456, 'recall': 0.6234344938218533, 'f1-score': 0.5273019419775647, 'support': 190753}}
[[  2807  32758    551]
 [  2256 112625   3305]
 [   406  32555   3490]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
6082/6082 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98171496
{'0': {'precision': 0.4519411301556538, 'recall': 0.06270851716458675, 'f1-score': 0.11013534456038848, 'support': 356985}, '1': {'precision': 0.5540302683524546, 'recall': 0.9464644733498413, 'f1-score': 0.6989294285179366, 'support': 846055}, '2': {'precision': 0.4901257892102246, 'recall': 0.08580110809588422, 'f1-score': 0.14603706136077693, 'support': 353760}, 'accuracy': 0.5482399794450155, 'macro avg': {'precision': 0.4986990625727777, 'recall': 0.3649913662034374, 'f1-score': 0.31836727814636734, 'support': 1556800}, 'weighted avg': {'precision': 0.5160991663865372, 'recall': 0.5482399794450155, 'f1-score': 0.4382781824573622, 'support': 1556800}}
[[ 22386 328598   6001]
 [ 19719 800761  25575]
 [  7428 315979  30353]]
Evaluating performance on  train set...
2440/2440 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.094822
{'0': {'precision': 0.4814991873028014, 'recall': 0.056125491070184726, 'f1-score': 0.10053250687467873, 'support': 179455}, '1': {'precision': 0.43148252299108564, 'recall': 0.9437418180176655, 'f1-score': 0.5922060692901379, 'support': 265828}, '2': {'precision': 0.48993077407174324, 'recall': 0.06078571348897391, 'f1-score': 0.10815289658046719, 'support': 179302}, 'accuracy': 0.43523939896091, 'macro avg': {'precision': 0.4676374947885435, 'recall': 0.3535510075256081, 'f1-score': 0.26696382424842796, 'support': 624585}, 'weighted avg': {'precision': 0.46263221247982295, 'recall': 0.43523939896091, 'f1-score': 0.3119800294133307, 'support': 624585}}
[[ 10072 165975   3408]
 [  7016 250873   7939]
 [  3830 164573  10899]]
Evaluating performance on  val set...
826/826 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0097749
{'0': {'precision': 0.45303274288781537, 'recall': 0.06518507076519087, 'f1-score': 0.11397127086744425, 'support': 51791}, '1': {'precision': 0.521012457657676, 'recall': 0.9445728333225917, 'f1-score': 0.6715872714537278, 'support': 108611}, '2': {'precision': 0.4869331826529171, 'recall': 0.06754055960498472, 'f1-score': 0.11862686053514582, 'support': 51036}, 'accuracy': 0.5174755720353011, 'macro avg': {'precision': 0.48699279439946946, 'recall': 0.35909948789758905, 'f1-score': 0.3013951342854393, 'support': 211438}, 'weighted avg': {'precision': 0.4961351542080183, 'recall': 0.5174755720353011, 'f1-score': 0.40152996000543106, 'support': 211438}}
[[  3376  47590    825]
 [  3213 102591   2807]
 [   863  46726   3447]]
testing model on single stock: results/universal/W3/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
13689/13689 - 88s - 88s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1512074
{'0': {'precision': 0.6020093948871527, 'recall': 0.04345862787095177, 'f1-score': 0.08106521576521933, 'support': 1147137}, '1': {'precision': 0.3397958387002833, 'recall': 0.9645522985474076, 'f1-score': 0.5025511945710913, 'support': 1186706}, '2': {'precision': 0.5295910639909125, 'recall': 0.023900396360557383, 'f1-score': 0.04573669964250065, 'support': 1170399}, 'accuracy': 0.3488531899338002, 'macro avg': {'precision': 0.4904654325261162, 'recall': 0.3439704409263056, 'f1-score': 0.20978436999293706, 'support': 3504242}, 'weighted avg': {'precision': 0.48902383553625073, 'recall': 0.3488531899338002, 'f1-score': 0.21200122989417713, 'support': 3504242}}
[[  49853 1090171    7113]
 [  24332 1144640   17734]
 [   8626 1133800   27973]]
Evaluating performance on  train set...
5475/5475 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1725224
{'0': {'precision': 0.5721331689272503, 'recall': 0.017002931539920677, 'f1-score': 0.03302442710699236, 'support': 463920}, '1': {'precision': 0.3317130226627969, 'recall': 0.9830347185442583, 'f1-score': 0.4960425603339122, 'support': 464478}, '2': {'precision': 0.5236872398831134, 'recall': 0.012498758366496396, 'f1-score': 0.02441481236841019, 'support': 473167}, 'accuracy': 0.33562481939831545, 'macro avg': {'precision': 0.4758444771577202, 'recall': 0.33751213615022513, 'f1-score': 0.18449393326977157, 'support': 1401565}, 'weighted avg': {'precision': 0.47610274322123747, 'recall': 0.33562481939831545, 'f1-score': 0.18356182701920662, 'support': 1401565}}
[[  7888 454404   1628]
 [  4129 456598   3751]
 [  1770 465483   5914]]
Evaluating performance on  val set...
2036/2036 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1481932
{'0': {'precision': 0.5945913022292606, 'recall': 0.02909253464461332, 'f1-score': 0.0554709519047186, 'support': 167775}, '1': {'precision': 0.34590470197242923, 'recall': 0.9768201255067473, 'f1-score': 0.5108948851259113, 'support': 180070}, '2': {'precision': 0.5145652657327107, 'recall': 0.013347099572592879, 'f1-score': 0.026019295207682102, 'support': 173371}, 'accuracy': 0.35127663003438114, 'macro avg': {'precision': 0.48502042331146683, 'recall': 0.33975325324131783, 'f1-score': 0.197461710746104, 'support': 521216}, 'weighted avg': {'precision': 0.48205601919556446, 'recall': 0.35127663003438114, 'f1-score': 0.2030146276205797, 'support': 521216}}
[[  4881 162336    558]
 [  2549 175896   1625]
 [   779 170278   2314]]
training model: results/universal/W3/deepOF_L1/h30
Epoch 1/50
10532/10532 - 148s - loss: 3.0940 - accuracy30: 0.4744 - val_loss: 3.2980 - val_accuracy30: 0.4369 - 148s/epoch - 14ms/step
Epoch 2/50
10532/10532 - 143s - loss: 3.0760 - accuracy30: 0.4783 - val_loss: 3.3346 - val_accuracy30: 0.4388 - 143s/epoch - 14ms/step
Epoch 3/50
10532/10532 - 139s - loss: 3.0625 - accuracy30: 0.4802 - val_loss: 3.3680 - val_accuracy30: 0.4393 - 139s/epoch - 13ms/step
Epoch 4/50
10532/10532 - 142s - loss: 3.0508 - accuracy30: 0.4822 - val_loss: 3.3890 - val_accuracy30: 0.4399 - 142s/epoch - 13ms/step
Epoch 5/50
10532/10532 - 145s - loss: 3.0399 - accuracy30: 0.4834 - val_loss: 3.3699 - val_accuracy30: 0.4410 - 145s/epoch - 14ms/step
Epoch 6/50
10532/10532 - 140s - loss: 3.0297 - accuracy30: 0.4845 - val_loss: 3.3923 - val_accuracy30: 0.4406 - 140s/epoch - 13ms/step
Epoch 7/50
10532/10532 - 139s - loss: 3.0201 - accuracy30: 0.4858 - val_loss: 3.4341 - val_accuracy30: 0.4414 - 139s/epoch - 13ms/step
Epoch 8/50
10532/10532 - 142s - loss: 3.0116 - accuracy30: 0.4871 - val_loss: 3.4350 - val_accuracy30: 0.4420 - 142s/epoch - 13ms/step
Epoch 9/50
10532/10532 - 140s - loss: 3.0046 - accuracy30: 0.4885 - val_loss: 3.4313 - val_accuracy30: 0.4440 - 140s/epoch - 13ms/step
Epoch 10/50
10532/10532 - 141s - loss: 2.9987 - accuracy30: 0.4894 - val_loss: 3.4581 - val_accuracy30: 0.4441 - 141s/epoch - 13ms/step
Epoch 11/50
10532/10532 - 139s - loss: 2.9935 - accuracy30: 0.4902 - val_loss: 3.4656 - val_accuracy30: 0.4448 - 139s/epoch - 13ms/step
testing model in sample: results/universal/W3/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 134s - 134s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0456098
{'0': {'precision': 0.5169825619949137, 'recall': 0.07141893605969211, 'f1-score': 0.12550051167838472, 'support': 1986728}, '1': {'precision': 0.4421673193810155, 'recall': 0.9226462316401365, 'f1-score': 0.5978311259821187, 'support': 3093773}, '2': {'precision': 0.47570238472697274, 'recall': 0.08451680894296784, 'f1-score': 0.14353256017633298, 'support': 2005956}, 'accuracy': 0.44675145845095793, 'macro avg': {'precision': 0.47828408870096734, 'recall': 0.3595273255475988, 'f1-score': 0.28895473261227883, 'support': 7086457}, 'weighted avg': {'precision': 0.47263492863468626, 'recall': 0.44675145845095793, 'f1-score': 0.33681276510531677, 'support': 7086457}}
[[ 141890 1797017   47821]
 [ 100280 2854458  139035]
 [  32288 1804131  169537]]
Evaluating performance on  train set...
10532/10532 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0586646
{'0': {'precision': 0.506987845425824, 'recall': 0.047823801021337736, 'f1-score': 0.08740294474762958, 'support': 768404}, '1': {'precision': 0.4280859242105012, 'recall': 0.9395327146876817, 'f1-score': 0.5881767315150208, 'support': 1145082}, '2': {'precision': 0.4842750170183798, 'recall': 0.06820125345607983, 'f1-score': 0.11956409693308175, 'support': 782317}, 'accuracy': 0.43250378458663336, 'macro avg': {'precision': 0.473116262218235, 'recall': 0.35185258972169975, 'f1-score': 0.2650479243985774, 'support': 2695803}, 'weighted avg': {'precision': 0.46688187272295556, 'recall': 0.43250378458663336, 'f1-score': 0.3094470872140651, 'support': 2695803}}
[[  36748  717128   14528]
 [  26948 1075842   42292]
 [   8787  720175   53355]]
Evaluating performance on  val set...
3814/3814 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0490017
{'0': {'precision': 0.507703058987961, 'recall': 0.05794910282766097, 'f1-score': 0.10402483631204197, 'support': 275811}, '1': {'precision': 0.4326178831166673, 'recall': 0.931782120812287, 'f1-score': 0.5908906588551439, 'support': 419113}, '2': {'precision': 0.4791876710355754, 'recall': 0.07106190594852443, 'f1-score': 0.12376925175466877, 'support': 280910}, 'accuracy': 0.4370282240626992, 'macro avg': {'precision': 0.47316953771340126, 'recall': 0.35359770986282407, 'f1-score': 0.27289491564061824, 'support': 975834}, 'weighted avg': {'precision': 0.4672459413381864, 'recall': 0.4370282240626992, 'f1-score': 0.3188136213159416, 'support': 975834}}
[[ 15983 254774   5054]
 [ 11949 390522  16642]
 [  3549 257399  19962]]
testing model out of sample: results/universal/W3/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 92s - 92s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0149484
{'0': {'precision': 0.4732546149042162, 'recall': 0.0631045257671165, 'f1-score': 0.11136011592251441, 'support': 1032731}, '1': {'precision': 0.5125548074501398, 'recall': 0.9328784070171591, 'f1-score': 0.661602774168008, 'support': 2079018}, '2': {'precision': 0.4584279915086961, 'recall': 0.0961008847519357, 'f1-score': 0.1588928456751179, 'support': 1024694}, 'accuracy': 0.5084356293559467, 'macro avg': {'precision': 0.4814124712876841, 'recall': 0.3640279391787371, 'f1-score': 0.31061857858854675, 'support': 4136443}, 'weighted avg': {'precision': 0.4893343857780786, 'recall': 0.5084356293559467, 'f1-score': 0.3996926020322816, 'support': 4136443}}
[[  65170  939065   28496]
 [  51709 1939471   87838]
 [  20827  905393   98474]]
Evaluating performance on  train set...
6181/6181 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0780048
{'0': {'precision': 0.4957127219654585, 'recall': 0.07023461800260208, 'f1-score': 0.12303686653333837, 'support': 464244}, '1': {'precision': 0.41770182533503186, 'recall': 0.9188784500203904, 'f1-score': 0.5743272034034433, 'support': 649815}, '2': {'precision': 0.4756449972258184, 'recall': 0.08797784999572393, 'f1-score': 0.14849016296424603, 'support': 467720}, 'accuracy': 0.4241148731902497, 'macro avg': {'precision': 0.46301984817543623, 'recall': 0.3590303060062388, 'f1-score': 0.2819514109670092, 'support': 1581779}, 'weighted avg': {'precision': 0.457730976722207, 'recall': 0.4241148731902497, 'f1-score': 0.31595904217223064, 'support': 1581779}}
[[ 32606 417153  14485]
 [ 21836 597101  30878]
 [ 11334 415237  41149]]
Evaluating performance on  val set...
2209/2209 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0413798
{'0': {'precision': 0.4744312657981723, 'recall': 0.08001206739377087, 'f1-score': 0.13693095088443927, 'support': 152477}, '1': {'precision': 0.47055710982864385, 'recall': 0.9131144400597678, 'f1-score': 0.6210613955197335, 'support': 261010}, '2': {'precision': 0.463378636000246, 'recall': 0.09964361044439596, 'f1-score': 0.16401739215611583, 'support': 151239}, 'accuracy': 0.4703201198457305, 'macro avg': {'precision': 0.46945567054235404, 'recall': 0.36425670596597826, 'f1-score': 0.3073365795200962, 'support': 564726}, 'weighted avg': {'precision': 0.46968067502031685, 'recall': 0.4703201198457305, 'f1-score': 0.36794459935421975, 'support': 564726}}
[[ 12200 135599   4678]
 [  9904 238332  12774]
 [  3611 132558  15070]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1753412
{'0': {'precision': 0.4627468581687612, 'recall': 0.017592055420946662, 'f1-score': 0.033895518953216956, 'support': 58606}, '1': {'precision': 0.3293290902686147, 'recall': 0.9706990004223568, 'f1-score': 0.49180386335165605, 'support': 56824}, '2': {'precision': 0.4001634432034868, 'recall': 0.02534594016356672, 'f1-score': 0.04767236203735255, 'support': 57958}, 'accuracy': 0.3325431979145039, 'macro avg': {'precision': 0.3974131305469542, 'recall': 0.3378789986689567, 'f1-score': 0.19112391478074187, 'support': 173388}, 'weighted avg': {'precision': 0.3981025874711622, 'recall': 0.3325431979145039, 'f1-score': 0.1885697872622535, 'support': 173388}}
[[ 1031 56452  1123]
 [  586 55159  1079]
 [  611 55878  1469]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1585256
{'0': {'precision': 0.489769820971867, 'recall': 0.017143368694328812, 'f1-score': 0.033127189378540846, 'support': 22341}, '1': {'precision': 0.3330101187031795, 'recall': 0.9727717118187217, 'f1-score': 0.49616684143073514, 'support': 21889}, '2': {'precision': 0.463216957605985, 'recall': 0.033624473910485585, 'f1-score': 0.06269777646512806, 'support': 22097}, 'accuracy': 0.33800714641096385, 'macro avg': {'precision': 0.42866563242701056, 'recall': 0.3411798514745121, 'f1-score': 0.19733060242480135, 'support': 66327}, 'weighted avg': {'precision': 0.4291903926130509, 'recall': 0.33800714641096385, 'f1-score': 0.1957893964227732, 'support': 66327}}
[[  383 21494   464]
 [  199 21293   397]
 [  200 21154   743]]
Evaluating performance on  val set...
86/86 - 1s - 608ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.178656
{'0': {'precision': 0.4439252336448598, 'recall': 0.012552854122621564, 'f1-score': 0.02441531739912619, 'support': 7568}, '1': {'precision': 0.32137322124641904, 'recall': 0.9774317954577918, 'f1-score': 0.4837067929596381, 'support': 7001}, '2': {'precision': 0.44730679156908665, 'recall': 0.02593346911065852, 'f1-score': 0.049024640657084194, 'support': 7365}, 'accuracy': 0.3250205160937358, 'macro avg': {'precision': 0.4042017488201219, 'recall': 0.3386393728970239, 'f1-score': 0.1857155836719495, 'support': 21934}, 'weighted avg': {'precision': 0.40594395049132864, 'recall': 0.3250205160937358, 'f1-score': 0.17927750788850363, 'support': 21934}}
[[  95 7342  131]
 [  53 6843  105]
 [  66 7108  191]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.873586
{'0': {'precision': 0.4535844301316158, 'recall': 0.1171397577291629, 'f1-score': 0.18619421214472512, 'support': 55310}, '1': {'precision': 0.7234107705444159, 'recall': 0.9450310212590823, 'f1-score': 0.8195019120666163, 'support': 259983}, '2': {'precision': 0.4098990556821882, 'recall': 0.11660738105824811, 'f1-score': 0.1815638026279731, 'support': 53976}, 'accuracy': 0.6999369023665675, 'macro avg': {'precision': 0.5289647521194066, 'recall': 0.3929260533488312, 'f1-score': 0.3957533089464382, 'support': 369269}, 'weighted avg': {'precision': 0.6371695664096644, 'recall': 0.6999369023665675, 'f1-score': 0.6313962322566673, 'support': 369269}}
[[  6479  47540   1291]
 [  6521 245692   7770]
 [  1284  46398   6294]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0011971
{'0': {'precision': 0.5600428331038703, 'recall': 0.08969741516599289, 'f1-score': 0.15462916033113702, 'support': 40815}, '1': {'precision': 0.5278657781052208, 'recall': 0.9439360912161353, 'f1-score': 0.6770905373304869, 'support': 83494}, '2': {'precision': 0.5207725947521866, 'recall': 0.1078083741984157, 'f1-score': 0.17863616476029753, 'support': 39765}, 'accuracy': 0.5287918865877592, 'macro avg': {'precision': 0.5362270686537592, 'recall': 0.3804806268601813, 'f1-score': 0.33678528747397385, 'support': 164074}, 'weighted avg': {'precision': 0.5341510278323955, 'recall': 0.5287918865877592, 'f1-score': 0.42631772001950496, 'support': 164074}}
[[ 3661 35987  1167]
 [ 1903 78813  2778]
 [  973 34505  4287]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95827585
{'0': {'precision': 0.5213735108619482, 'recall': 0.09826971338000264, 'f1-score': 0.16537008224049787, 'support': 15142}, '1': {'precision': 0.5853807871642307, 'recall': 0.9421381105187356, 'f1-score': 0.7220984952650232, 'support': 39577}, '2': {'precision': 0.5186222346681602, 'recall': 0.12023631760046743, 'f1-score': 0.19521450405818486, 'support': 15403}, 'accuracy': 0.5793759447819514, 'macro avg': {'precision': 0.5417921775647797, 'recall': 0.38688138049973525, 'f1-score': 0.3608943605212353, 'support': 70122}, 'weighted avg': {'precision': 0.5568950029329461, 'recall': 0.5793759447819514, 'f1-score': 0.4861443618036802, 'support': 70122}}
[[ 1488 13256   398]
 [  969 37287  1321]
 [  397 13154  1852]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
1359/1359 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1332815
{'0': {'precision': 0.48396666195790367, 'recall': 0.059855863725704304, 'f1-score': 0.10653564792860307, 'support': 114475}, '1': {'precision': 0.3453639185151187, 'recall': 0.8885182279839808, 'f1-score': 0.4973929443088529, 'support': 121105}, '2': {'precision': 0.40875317143892714, 'recall': 0.08039780068973507, 'f1-score': 0.13436692506459946, 'support': 112217}, 'accuracy': 0.35502893929504853, 'macro avg': {'precision': 0.4126945839706499, 'recall': 0.3429239641331401, 'f1-score': 0.24609850576735182, 'support': 347797}, 'weighted avg': {'precision': 0.41143665879454555, 'recall': 0.35502893929504853, 'f1-score': 0.25161428663020274, 'support': 347797}}
[[  6852 103277   4346]
 [  4797 107604   8704]
 [  2509 100686   9022]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.13245
{'0': {'precision': 0.5232786885245901, 'recall': 0.06381107231388437, 'f1-score': 0.11375083151192625, 'support': 37517}, '1': {'precision': 0.33226809045470934, 'recall': 0.907718924673942, 'f1-score': 0.48646643890818575, 'support': 37570}, '2': {'precision': 0.4827478042659975, 'recall': 0.07994597542920963, 'f1-score': 0.13717494484925463, 'support': 38501}, 'accuracy': 0.3484082825650597, 'macro avg': {'precision': 0.44609819441509896, 'recall': 0.35049199080567867, 'f1-score': 0.24579740508978887, 'support': 113588}, 'weighted avg': {'precision': 0.44636257287570563, 'recall': 0.3484082825650597, 'f1-score': 0.24496871682972343, 'support': 113588}}
[[ 2394 33895  1228]
 [ 1397 34103  2070]
 [  784 34639  3078]]
Evaluating performance on  val set...
144/144 - 1s - 863ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.126526
{'0': {'precision': 0.5310457516339869, 'recall': 0.07908183956525265, 'f1-score': 0.13766325450052946, 'support': 12329}, '1': {'precision': 0.3280418425399156, 'recall': 0.8941970985492746, 'f1-score': 0.47999462943071963, 'support': 11994}, '2': {'precision': 0.4943181818181818, 'recall': 0.08474713856644209, 'f1-score': 0.14468851777423605, 'support': 12319}, 'accuracy': 0.34779760930080234, 'macro avg': {'precision': 0.4511352586640281, 'recall': 0.3526753588936564, 'f1-score': 0.2541154672351617, 'support': 36642}, 'weighted avg': {'precision': 0.45224885686199867, 'recall': 0.34779760930080234, 'f1-score': 0.25208022762376214, 'support': 36642}}
[[  975 10984   370]
 [  571 10725   698]
 [  290 10985  1044]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1273547
{'0': {'precision': 0.49964476021314386, 'recall': 0.02923842883721897, 'f1-score': 0.05524406170524063, 'support': 96209}, '1': {'precision': 0.34436971143415057, 'recall': 0.9579816716796266, 'f1-score': 0.5066219088227392, 'support': 99409}, '2': {'precision': 0.5168062771710317, 'recall': 0.050779825594115625, 'f1-score': 0.09247348549528525, 'support': 95983}, 'accuracy': 0.352944605814109, 'macro avg': {'precision': 0.45360691627277533, 'recall': 0.3459999753703204, 'f1-score': 0.21811315200775502, 'support': 291601}, 'weighted avg': {'precision': 0.45235917668667447, 'recall': 0.352944605814109, 'f1-score': 0.22137659275878044, 'support': 291601}}
[[ 2813 91457  1939]
 [ 1559 95232  2618]
 [ 1258 89851  4874]]
Evaluating performance on  train set...
385/385 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.139503
{'0': {'precision': 0.5629522431259045, 'recall': 0.023024563480319622, 'f1-score': 0.04423973615375867, 'support': 33790}, '1': {'precision': 0.3312360268284893, 'recall': 0.963578927808232, 'f1-score': 0.4930002614503362, 'support': 32289}, '2': {'precision': 0.5157759175788796, 'recall': 0.049537709885896286, 'f1-score': 0.09039356749894203, 'support': 32339}, 'accuracy': 0.34031376374240485, 'macro avg': {'precision': 0.4699880625110911, 'recall': 0.34538040039148266, 'f1-score': 0.20921118836767896, 'support': 98418}, 'weighted avg': {'precision': 0.4714291467421894, 'recall': 0.34031376374240485, 'f1-score': 0.20663479958903552, 'support': 98418}}
[[  778 32361   651]
 [  323 31113   853]
 [  281 30456  1602]]
Evaluating performance on  val set...
139/139 - 1s - 876ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1331044
{'0': {'precision': 0.5242566510172144, 'recall': 0.027121113989637305, 'f1-score': 0.051574166730813636, 'support': 12352}, '1': {'precision': 0.33946201596216374, 'recall': 0.9691957127183729, 'f1-score': 0.5028131088684078, 'support': 11849}, '2': {'precision': 0.532150776053215, 'recall': 0.04297224709042077, 'f1-score': 0.07952286282306163, 'support': 11170}, 'accuracy': 0.34771422917078965, 'macro avg': {'precision': 0.4652898143441977, 'recall': 0.3464296912661437, 'f1-score': 0.21130337947409436, 'support': 35371}, 'weighted avg': {'precision': 0.46484486582270007, 'recall': 0.34771422917078965, 'f1-score': 0.21156164689079676, 'support': 35371}}
[[  335 11808   209]
 [  152 11484   213]
 [  152 10538   480]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
2282/2282 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1330338
{'0': {'precision': 0.5107874055163438, 'recall': 0.052391343413857726, 'f1-score': 0.09503497219919717, 'support': 194765}, '1': {'precision': 0.32558584732497775, 'recall': 0.9103876066626783, 'f1-score': 0.47963703322771695, 'support': 190554}, '2': {'precision': 0.47900371842543915, 'recall': 0.07521442377385842, 'f1-score': 0.1300137470200289, 'support': 198672}, 'accuracy': 0.3401165428919281, 'macro avg': {'precision': 0.43845899042225356, 'recall': 0.3459977912834648, 'f1-score': 0.23489525081564766, 'support': 583991}, 'weighted avg': {'precision': 0.4395441390938788, 'recall': 0.3401165428919281, 'f1-score': 0.23242880924194756, 'support': 583991}}
[[ 10204 179028   5533]
 [  6356 173478  10720]
 [  3417 180312  14943]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.134342
{'0': {'precision': 0.4816053511705686, 'recall': 0.06394832458619297, 'f1-score': 0.11290495028333154, 'support': 74310}, '1': {'precision': 0.3314444093118849, 'recall': 0.9019615751757889, 'f1-score': 0.4847554256522163, 'support': 74379}, '2': {'precision': 0.4773784694368683, 'recall': 0.07824909272602956, 'f1-score': 0.13445852820895185, 'support': 76052}, 'accuracy': 0.3461317694590662, 'macro avg': {'precision': 0.4301427433064406, 'recall': 0.3480529974960038, 'f1-score': 0.24403963471483325, 'support': 224741}, 'weighted avg': {'precision': 0.4304785718818833, 'recall': 0.3461317694590662, 'f1-score': 0.24326416028890044, 'support': 224741}}
[[ 4752 67083  2475]
 [ 3252 67087  4040]
 [ 1863 68238  5951]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1248828
{'0': {'precision': 0.4747501315097317, 'recall': 0.0714172667563504, 'f1-score': 0.12415738065758701, 'support': 25274}, '1': {'precision': 0.3434532897128317, 'recall': 0.8932123274721119, 'f1-score': 0.4961352657004831, 'support': 26445}, '2': {'precision': 0.4649269311064718, 'recall': 0.08682938240798503, 'f1-score': 0.14633024508837636, 'support': 25648}, 'accuracy': 0.35742629286388256, 'macro avg': {'precision': 0.42771011744301174, 'recall': 0.3504863255454824, 'f1-score': 0.25554096381548214, 'support': 77367}, 'weighted avg': {'precision': 0.42661474529517207, 'recall': 0.35742629286388256, 'f1-score': 0.25865457968146377, 'support': 77367}}
[[ 1805 22525   944]
 [ 1205 23621  1619]
 [  792 22629  2227]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/EXC
Evaluating performance on  test set...
5098/5098 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.931214
{'0': {'precision': 0.45092146710597775, 'recall': 0.09877855329949238, 'f1-score': 0.16205700752770022, 'support': 252160}, '1': {'precision': 0.6308334787809644, 'recall': 0.9206564188714834, 'f1-score': 0.7486750540335447, 'support': 804791}, '2': {'precision': 0.3770596534192243, 'recall': 0.11425414186387907, 'f1-score': 0.1753690922034108, 'support': 247956}, 'accuracy': 0.6086058240165775, 'macro avg': {'precision': 0.4862715331020555, 'recall': 0.3778963713449517, 'f1-score': 0.362033717921552, 'support': 1304907}, 'weighted avg': {'precision': 0.5478456830948655, 'recall': 0.6086058240165775, 'f1-score': 0.5263785534565179, 'support': 1304907}}
[[ 24908 218944   8308]
 [ 25359 740936  38496]
 [  4971 214655  28330]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9285382
{'0': {'precision': 0.4353226444972288, 'recall': 0.09621252720571348, 'f1-score': 0.15759443215306204, 'support': 91433}, '1': {'precision': 0.6319459107034717, 'recall': 0.9231548799294998, 'f1-score': 0.7502844250756859, 'support': 295035}, '2': {'precision': 0.4393573743363442, 'recall': 0.13595485240620034, 'f1-score': 0.20765338960266574, 'support': 93737}, 'accuracy': 0.6120386085109485, 'macro avg': {'precision': 0.5022086431790148, 'recall': 0.38510741984713787, 'f1-score': 0.3718440822771379, 'support': 480205}, 'weighted avg': {'precision': 0.5569143580697405, 'recall': 0.6120386085109485, 'f1-score': 0.5315111313885549, 'support': 480205}}
[[  8797  79709   2927]
 [  9337 272363  13335]
 [  2074  78919  12744]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9068457
{'0': {'precision': 0.4336630782659296, 'recall': 0.10665855665676768, 'f1-score': 0.1712086839158028, 'support': 27949}, '1': {'precision': 0.6592393256923066, 'recall': 0.9204386741418314, 'f1-score': 0.7682443775833974, 'support': 101670}, '2': {'precision': 0.4179151388161341, 'recall': 0.13873334956352382, 'f1-score': 0.20831375006527755, 'support': 28753}, 'accuracy': 0.6349038971535372, 'macro avg': {'precision': 0.5036058475914568, 'recall': 0.38861019345404096, 'f1-score': 0.38258893718815923, 'support': 158372}, 'weighted avg': {'precision': 0.575617063647435, 'recall': 0.6349038971535372, 'f1-score': 0.5612239703438341, 'support': 158372}}
[[ 2981 24156   812]
 [ 3345 93581  4744]
 [  548 24216  3989]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/AAL
Evaluating performance on  test set...
5760/5760 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.905691
{'0': {'precision': 0.4628446892877683, 'recall': 0.06033904458246849, 'f1-score': 0.10676022411897157, 'support': 253418}, '1': {'precision': 0.6701503693919909, 'recall': 0.95066840309056, 'f1-score': 0.7861345047535739, 'support': 971345}, '2': {'precision': 0.40195306347456294, 'recall': 0.10220100599109345, 'f1-score': 0.16296608491861272, 'support': 249704}, 'accuracy': 0.6539569892035563, 'macro avg': {'precision': 0.5116493740514407, 'recall': 0.3710694845547073, 'f1-score': 0.35195360459705277, 'support': 1474467}, 'weighted avg': {'precision': 0.589100789498065, 'recall': 0.6539569892035563, 'f1-score': 0.563834976479066, 'support': 1474467}}
[[ 15291 233091   5036]
 [ 14984 923427  32934]
 [  2762 221422  25520]]
Evaluating performance on  train set...
2159/2159 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9894445
{'0': {'precision': 0.49569395340404315, 'recall': 0.0851468034912058, 'f1-score': 0.14532986930145717, 'support': 128437}, '1': {'precision': 0.545011536279645, 'recall': 0.9235475148781217, 'f1-score': 0.6854937831940126, 'support': 294392}, '2': {'precision': 0.44523169381622646, 'recall': 0.10851984056619048, 'f1-score': 0.17450596315489322, 'support': 129709}, 'accuracy': 0.5373331788944833, 'macro avg': {'precision': 0.49531239449997155, 'recall': 0.3724047196451727, 'f1-score': 0.33510987188345437, 'support': 552538}, 'weighted avg': {'precision': 0.5101242597884694, 'recall': 0.5373331788944833, 'f1-score': 0.4399780869738933, 'support': 552538}}
[[ 10936 113879   3622]
 [  8590 271885  13917]
 [  2536 113097  14076]]
Evaluating performance on  val set...
850/850 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97040963
{'0': {'precision': 0.458307597282273, 'recall': 0.09411665222078938, 'f1-score': 0.15616395110230283, 'support': 47303}, '1': {'precision': 0.5787760148361838, 'recall': 0.9147248953804569, 'f1-score': 0.7089661961343573, 'support': 122826}, '2': {'precision': 0.42668936422174525, 'recall': 0.12209844120637073, 'f1-score': 0.1898661221532432, 'support': 47216}, 'accuracy': 0.5639375186914812, 'macro avg': {'precision': 0.48792432544673403, 'recall': 0.3769799962692057, 'f1-score': 0.3516654231299678, 'support': 217345}, 'weighted avg': {'precision': 0.5195179649571252, 'recall': 0.5639375186914812, 'f1-score': 0.47588499486520663, 'support': 217345}}
[[  4452  41354   1497]
 [  4225 112352   6249]
 [  1037  40414   5765]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/WBA
Evaluating performance on  test set...
6315/6315 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9664541
{'0': {'precision': 0.49847452970690725, 'recall': 0.09524388390822064, 'f1-score': 0.15992985614013927, 'support': 361955}, '1': {'precision': 0.5666364604476823, 'recall': 0.9206072974367024, 'f1-score': 0.7014985374339581, 'support': 891820}, '2': {'precision': 0.47083884087442807, 'recall': 0.12768603359041314, 'f1-score': 0.2008923826443072, 'support': 362663}, 'accuracy': 0.5578914873320227, 'macro avg': {'precision': 0.5119832770096725, 'recall': 0.38117907164511206, 'f1-score': 0.35410692540613486, 'support': 1616438}, 'weighted avg': {'precision': 0.5298804551146152, 'recall': 0.5578914873320227, 'f1-score': 0.4679140622161128, 'support': 1616438}}
[[ 34474 317643   9838]
 [ 28599 821016  42205]
 [  6086 310270  46307]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0075699
{'0': {'precision': 0.5378557365312332, 'recall': 0.08693136616764302, 'f1-score': 0.1496718923159297, 'support': 138270}, '1': {'precision': 0.5046059282949406, 'recall': 0.9256328412466197, 'f1-score': 0.6531494308006329, 'support': 270684}, '2': {'precision': 0.5102421996999296, 'recall': 0.116868999277634, 'f1-score': 0.1901783778231743, 'support': 142587}, 'accuracy': 0.506286930618032, 'macro avg': {'precision': 0.5175679548420344, 'recall': 0.3764777355639655, 'f1-score': 0.3309999003132456, 'support': 551541}, 'weighted avg': {'precision': 0.5143986907834144, 'recall': 0.506286930618032, 'f1-score': 0.40723934836401116, 'support': 551541}}
[[ 12020 122355   3895]
 [  8030 250554  12100]
 [  2298 123625  16664]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9683015
{'0': {'precision': 0.5085077029202115, 'recall': 0.10289635919506805, 'f1-score': 0.1711587949615928, 'support': 42985}, '1': {'precision': 0.5627309964923844, 'recall': 0.9164597969961565, 'f1-score': 0.6973006282611786, 'support': 104333}, '2': {'precision': 0.47244418815388417, 'recall': 0.13203637619431335, 'f1-score': 0.2063914780292943, 'support': 43435}, 'accuracy': 0.5545129041220845, 'macro avg': {'precision': 0.51456096252216, 'recall': 0.38379751079517926, 'f1-score': 0.35828363375068856, 'support': 190753}, 'weighted avg': {'precision': 0.529953552392514, 'recall': 0.5545129041220845, 'f1-score': 0.46695643632341305, 'support': 190753}}
[[ 4423 37395  1167]
 [ 3479 95617  5237]
 [  796 36904  5735]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
6082/6082 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0298821
{'0': {'precision': 0.46733888645330995, 'recall': 0.0777219072246377, 'f1-score': 0.13327859936611397, 'support': 411467}, '1': {'precision': 0.4874889145914112, 'recall': 0.9191479863093386, 'f1-score': 0.6370861647492585, 'support': 739190}, '2': {'precision': 0.5013946706675401, 'recall': 0.11684308236261612, 'f1-score': 0.1895209359630503, 'support': 406143}, 'accuracy': 0.4874486125385406, 'macro avg': {'precision': 0.4854074905707537, 'recall': 0.3712376586321975, 'f1-score': 0.31996190002614094, 'support': 1556800}, 'weighted avg': {'precision': 0.4857909789941136, 'recall': 0.4874486125385406, 'f1-score': 0.38716602586152515, 'support': 1556800}}
[[ 31980 366966  12521]
 [ 25095 679425  34670]
 [ 11355 347333  47455]]
Evaluating performance on  train set...
2440/2440 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1175762
{'0': {'precision': 0.4943615605519367, 'recall': 0.07000629838473708, 'f1-score': 0.1226449110094573, 'support': 201639}, '1': {'precision': 0.36105336105336105, 'recall': 0.9146332107317734, 'f1-score': 0.5177312392708248, 'support': 221585}, '2': {'precision': 0.5032561088059013, 'recall': 0.08673476989089247, 'f1-score': 0.14796772075487682, 'support': 201361}, 'accuracy': 0.37504903255761823, 'macro avg': {'precision': 0.4528903434703997, 'recall': 0.3571247596691343, 'f1-score': 0.262781290345053, 'support': 624585}, 'weighted avg': {'precision': 0.449935129794033, 'recall': 0.37504903255761823, 'f1-score': 0.27097417018305664, 'support': 624585}}
[[ 14116 180744   6779]
 [  8456 202669  10460]
 [  5982 177914  17465]]
Evaluating performance on  val set...
826/826 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0548062
{'0': {'precision': 0.47456630402822697, 'recall': 0.08069596520173991, 'f1-score': 0.13793692846765235, 'support': 60003}, '1': {'precision': 0.44646560595266366, 'recall': 0.9122207366514276, 'f1-score': 0.5995131785472596, 'support': 92744}, '2': {'precision': 0.49105621805792166, 'recall': 0.09822630386260245, 'f1-score': 0.16370632250003553, 'support': 58691}, 'accuracy': 0.45029748673369974, 'macro avg': {'precision': 0.4706960426796041, 'recall': 0.3637143352385899, 'f1-score': 0.3003854765049825, 'support': 211438}, 'weighted avg': {'precision': 0.46681764201854453, 'recall': 0.45029748673369974, 'f1-score': 0.3475532663186427, 'support': 211438}}
[[ 4842 53360  1801]
 [ 3967 84603  4174]
 [ 1394 51532  5765]]
testing model on single stock: results/universal/W3/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
13689/13689 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1360569
{'0': {'precision': 0.563434327899108, 'recall': 0.06000275163091457, 'f1-score': 0.1084555639929126, 'support': 1221094}, '1': {'precision': 0.29580713036003836, 'recall': 0.9165788180425335, 'f1-score': 0.44726772076366705, 'support': 1037770}, '2': {'precision': 0.5276418663303909, 'recall': 0.06719566268233419, 'f1-score': 0.11920984516851402, 'support': 1245378}, 'accuracy': 0.31623129909406944, 'macro avg': {'precision': 0.4622944415298457, 'recall': 0.3479257441185941, 'f1-score': 0.2249777099750312, 'support': 3504242}, 'weighted avg': {'precision': 0.4714570554979308, 'recall': 0.31623129909406944, 'f1-score': 0.21261567539900098, 'support': 3504242}}
[[  73269 1121382   26443]
 [  38099  951198   48473]
 [  18672 1143022   83684]]
Evaluating performance on  train set...
5475/5475 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1243913
{'0': {'precision': 0.530877034358047, 'recall': 0.025302954561125284, 'f1-score': 0.04830363459861461, 'support': 464096}, '1': {'precision': 0.33015980401506845, 'recall': 0.9558695370809784, 'f1-score': 0.4907970431804639, 'support': 463580}, '2': {'precision': 0.48435698774831776, 'recall': 0.038124961752646715, 'f1-score': 0.07068604628416048, 'support': 473889}, 'accuracy': 0.3374313713598727, 'macro avg': {'precision': 0.44846460870714444, 'recall': 0.33976581779825016, 'f1-score': 0.20326224135441304, 'support': 1401565}, 'weighted avg': {'precision': 0.4487589506371807, 'recall': 0.3374313713598727, 'f1-score': 0.20223004760238208, 'support': 1401565}}
[[ 11743 446270   6083]
 [  7307 443122  13151]
 [  3070 452752  18067]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1280522
{'0': {'precision': 0.5504297065023512, 'recall': 0.038273115236522104, 'f1-score': 0.07156975916760228, 'support': 177383}, '1': {'precision': 0.3091985603487606, 'recall': 0.9431298087627719, 'f1-score': 0.46571552044027803, 'support': 161684}, '2': {'precision': 0.5088177245813968, 'recall': 0.04387616731357295, 'f1-score': 0.08078602620087337, 'support': 182149}, 'accuracy': 0.32092261173870335, 'macro avg': {'precision': 0.45614866381083624, 'recall': 0.34175969710428894, 'f1-score': 0.2060237686029179, 'support': 521216}, 'weighted avg': {'precision': 0.46105639960153266, 'recall': 0.32092261173870335, 'f1-score': 0.1970566918201966, 'support': 521216}}
[[  6789 168152   2442]
 [  3922 152489   5273]
 [  1623 172534   7992]]
training model: results/universal/W3/deepLOB_L2/h10
Epoch 1/50
10532/10532 - 428s - loss: 2.7682 - accuracy10: 0.5387 - val_loss: 3.7256 - val_accuracy10: 0.4945 - 428s/epoch - 41ms/step
Epoch 2/50
10532/10532 - 423s - loss: 2.6218 - accuracy10: 0.5728 - val_loss: 3.3561 - val_accuracy10: 0.5286 - 423s/epoch - 40ms/step
Epoch 3/50
10532/10532 - 422s - loss: 2.5781 - accuracy10: 0.5818 - val_loss: 3.2259 - val_accuracy10: 0.5350 - 422s/epoch - 40ms/step
Epoch 4/50
10532/10532 - 424s - loss: 2.5556 - accuracy10: 0.5859 - val_loss: 3.1855 - val_accuracy10: 0.5385 - 424s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 424s - loss: 2.5424 - accuracy10: 0.5885 - val_loss: 3.0226 - val_accuracy10: 0.5461 - 424s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 423s - loss: 2.5335 - accuracy10: 0.5901 - val_loss: 3.0490 - val_accuracy10: 0.5497 - 423s/epoch - 40ms/step
Epoch 7/50
10532/10532 - 423s - loss: 2.5258 - accuracy10: 0.5914 - val_loss: 3.0207 - val_accuracy10: 0.5491 - 423s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 423s - loss: 2.5200 - accuracy10: 0.5923 - val_loss: 2.9961 - val_accuracy10: 0.5507 - 423s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 422s - loss: 2.5149 - accuracy10: 0.5933 - val_loss: 2.9879 - val_accuracy10: 0.5505 - 422s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 423s - loss: 2.5102 - accuracy10: 0.5943 - val_loss: 3.0031 - val_accuracy10: 0.5520 - 423s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 422s - loss: 2.5062 - accuracy10: 0.5953 - val_loss: 2.9511 - val_accuracy10: 0.5537 - 422s/epoch - 40ms/step
Epoch 12/50
10532/10532 - 422s - loss: 2.5028 - accuracy10: 0.5956 - val_loss: 2.9807 - val_accuracy10: 0.5528 - 422s/epoch - 40ms/step
Epoch 13/50
10532/10532 - 422s - loss: 2.5000 - accuracy10: 0.5962 - val_loss: 2.9933 - val_accuracy10: 0.5531 - 422s/epoch - 40ms/step
Epoch 14/50
10532/10532 - 424s - loss: 2.4968 - accuracy10: 0.5968 - val_loss: 3.0031 - val_accuracy10: 0.5539 - 424s/epoch - 40ms/step
Epoch 15/50
10532/10532 - 423s - loss: 2.4942 - accuracy10: 0.5974 - val_loss: 2.9877 - val_accuracy10: 0.5535 - 423s/epoch - 40ms/step
Epoch 16/50
10532/10532 - 423s - loss: 2.4918 - accuracy10: 0.5975 - val_loss: 3.0011 - val_accuracy10: 0.5544 - 423s/epoch - 40ms/step
Epoch 17/50
10532/10532 - 421s - loss: 2.4897 - accuracy10: 0.5982 - val_loss: 2.9601 - val_accuracy10: 0.5530 - 421s/epoch - 40ms/step
Epoch 18/50
10532/10532 - 423s - loss: 2.4879 - accuracy10: 0.5986 - val_loss: 2.9964 - val_accuracy10: 0.5550 - 423s/epoch - 40ms/step
Epoch 19/50
10532/10532 - 425s - loss: 2.4855 - accuracy10: 0.5991 - val_loss: 3.0072 - val_accuracy10: 0.5541 - 425s/epoch - 40ms/step
Epoch 20/50
10532/10532 - 423s - loss: 2.4838 - accuracy10: 0.5994 - val_loss: 2.9923 - val_accuracy10: 0.5544 - 423s/epoch - 40ms/step
Epoch 21/50
10532/10532 - 423s - loss: 2.4818 - accuracy10: 0.5995 - val_loss: 3.0370 - val_accuracy10: 0.5548 - 423s/epoch - 40ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 365s - 365s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9350861
{'0': {'precision': 0.3979385362982716, 'recall': 0.5773783809313895, 'f1-score': 0.4711516918023486, 'support': 1587950}, '1': {'precision': 0.6948469308686599, 'recall': 0.612487421140598, 'f1-score': 0.6510729319108278, 'support': 3894431}, '2': {'precision': 0.449563036479693, 'recall': 0.37825354592243854, 'f1-score': 0.4108369324293077, 'support': 1604096}, 'accuracy': 0.5515989115607092, 'macro avg': {'precision': 0.5141161678822082, 'recall': 0.5227064493314754, 'f1-score': 0.5110205187141613, 'support': 7086477}, 'weighted avg': {'precision': 0.5727926860003266, 'recall': 0.5515989115607092, 'f1-score': 0.5563760128275418, 'support': 7086477}}
[[ 916848  490021  181081]
 [ 947322 2385290  561819]
 [ 439824  557517  606755]]
Evaluating performance on  train set...
10532/10532 - 144s - 144s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96866596
{'0': {'precision': 0.4093619941645563, 'recall': 0.6085344390418519, 'f1-score': 0.48946211688604596, 'support': 670460}, '1': {'precision': 0.6615944455936772, 'recall': 0.6000597113603469, 'f1-score': 0.6293264598263716, 'support': 1343128}, '2': {'precision': 0.46084926060848014, 'recall': 0.3248790712673331, 'f1-score': 0.3810993538270017, 'support': 682220}, 'accuracy': 0.532528280945824, 'macro avg': {'precision': 0.5106019001222379, 'recall': 0.5111577405565106, 'f1-score': 0.49996264351313974, 'support': 2695808}, 'weighted avg': {'precision': 0.5480610821324182, 'recall': 0.532528280945824, 'f1-score': 0.5317234615332214, 'support': 2695808}}
[[407998 178029  84433]
 [362307 805957 174864]
 [226363 234218 221639]]
Evaluating performance on  val set...
3814/3814 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9351814
{'0': {'precision': 0.4065552766206577, 'recall': 0.588114009027784, 'f1-score': 0.480764525605917, 'support': 225526}, '1': {'precision': 0.68664637267315, 'recall': 0.6397495501478913, 'f1-score': 0.6623689058000782, 'support': 517948}, '2': {'precision': 0.45502661341986933, 'recall': 0.32707295974797834, 'f1-score': 0.38058300073613727, 'support': 232361}, 'accuracy': 0.5533630173133778, 'macro avg': {'precision': 0.5160760875712257, 'recall': 0.5183121729745511, 'f1-score': 0.5079054773807108, 'support': 975835}, 'weighted avg': {'precision': 0.5667621469503731, 'recall': 0.5533630173133778, 'f1-score': 0.5533007086825011, 'support': 975835}}
[[132635  65545  27346]
 [122915 331357  63676]
 [ 70691  85671  75999]]
testing model out of sample: results/universal/W3/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 214s - 214s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7792645
{'0': {'precision': 0.4248156554355007, 'recall': 0.6171886590663094, 'f1-score': 0.5032443744802874, 'support': 775139}, '1': {'precision': 0.7990308858077855, 'recall': 0.7630666062920787, 'f1-score': 0.7806347419920467, 'support': 2586077}, '2': {'precision': 0.5131762212073625, 'recall': 0.3578730391733215, 'f1-score': 0.4216797884305559, 'support': 775247}, 'accuracy': 0.6597897769181061, 'macro avg': {'precision': 0.5790075874835495, 'recall': 0.57937610151057, 'f1-score': 0.56851963496763, 'support': 4136463}, 'weighted avg': {'precision': 0.6753317760555584, 'recall': 0.6597897769181061, 'f1-score': 0.6613795128345797, 'support': 4136463}}
[[ 478407  219772   76960]
 [ 426495 1973349  186233]
 [ 221250  276557  277440]]
Evaluating performance on  train set...
6181/6181 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8702435
{'0': {'precision': 0.4369134752007402, 'recall': 0.5946922207667354, 'f1-score': 0.503737127209953, 'support': 355742}, '1': {'precision': 0.7304374725725344, 'recall': 0.7019712181637378, 'f1-score': 0.7159214904660026, 'support': 867839}, '2': {'precision': 0.4999601610253414, 'recall': 0.3678609515195167, 'f1-score': 0.42385652503268917, 'support': 358206}, 'accuracy': 0.6021828476273986, 'macro avg': {'precision': 0.5557703695995387, 'recall': 0.55484146348333, 'f1-score': 0.5478383809028816, 'support': 1581787}, 'weighted avg': {'precision': 0.612231184536844, 'recall': 0.6021828476273986, 'f1-score': 0.6020614620541879, 'support': 1581787}}
[[211557 100312  43873]
 [170723 609198  87918]
 [101928 124508 131770]]
Evaluating performance on  val set...
2209/2209 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7959506
{'0': {'precision': 0.43950725912890454, 'recall': 0.6013384321223709, 'f1-score': 0.5078420525395093, 'support': 112968}, '1': {'precision': 0.7828916649990948, 'recall': 0.7258225529546533, 'f1-score': 0.7532777516304714, 'support': 339583}, '2': {'precision': 0.49108912968227164, 'recall': 0.4173568085580566, 'f1-score': 0.45123079592112114, 'support': 112175}, 'accuracy': 0.6396482541976108, 'macro avg': {'precision': 0.5711626846034237, 'recall': 0.5815059312116936, 'f1-score': 0.5707835333637007, 'support': 564726}, 'weighted avg': {'precision': 0.6562383871944457, 'recall': 0.6396482541976108, 'f1-score': 0.6441832574658602, 'support': 564726}}
[[ 67932  31204  13832]
 [ 58422 246477  34684]
 [ 28210  37148  46817]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1466353
{'0': {'precision': 0.35004334398873055, 'recall': 0.5304827982592988, 'f1-score': 0.4217750359054707, 'support': 48716}, '1': {'precision': 0.49419518377693283, 'recall': 0.38891918130677056, 'f1-score': 0.4352822100500119, 'support': 75193}, '2': {'precision': 0.41092871821535565, 'recall': 0.33540811996039044, 'f1-score': 0.36934751646786546, 'support': 49483}, 'accuracy': 0.4134216111469964, 'macro avg': {'precision': 0.41838908199367303, 'recall': 0.41827003317548656, 'f1-score': 0.40880158747444933, 'support': 173392}, 'weighted avg': {'precision': 0.42993169098311546, 'recall': 0.4134216111469964, 'f1-score': 0.41267065970079847, 'support': 173392}}
[[25843 14730  8143]
 [30300 29244 15649]
 [17685 15201 16597]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1817071
{'0': {'precision': 0.34560924915562485, 'recall': 0.5601642278134541, 'f1-score': 0.4274753966659972, 'support': 18998}, '1': {'precision': 0.5060612863396565, 'recall': 0.3124826725810923, 'f1-score': 0.3863821399494365, 'support': 28856}, '2': {'precision': 0.3661606185450646, 'recall': 0.35117726657645465, 'f1-score': 0.35851246062883346, 'support': 18475}, 'accuracy': 0.39420163126234375, 'macro avg': {'precision': 0.40594371801344864, 'recall': 0.40794138899033366, 'f1-score': 0.39078999908142237, 'support': 66329}, 'weighted avg': {'precision': 0.42113715602068114, 'recall': 0.39420163126234375, 'f1-score': 0.3903893971921671, 'support': 66329}}
[[10642  4332  4024]
 [12632  9017  7207]
 [ 7518  4469  6488]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1593558
{'0': {'precision': 0.36345108695652173, 'recall': 0.5015625, 'f1-score': 0.4214810924369748, 'support': 6400}, '1': {'precision': 0.4907543773523155, 'recall': 0.32233447979363716, 'f1-score': 0.38910152448913393, 'support': 9304}, '2': {'precision': 0.36690030038621085, 'recall': 0.4117174959871589, 'f1-score': 0.38801906058543223, 'support': 6230}, 'accuracy': 0.40001823652776514, 'macro avg': {'precision': 0.40703525489834935, 'recall': 0.411871491926932, 'f1-score': 0.399533892503847, 'support': 21934}, 'weighted avg': {'precision': 0.4184304985325876, 'recall': 0.40001823652776514, 'f1-score': 0.39824192226182104, 'support': 21934}}
[[3210 1575 1615]
 [3494 2999 2811]
 [2128 1537 2565]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6050901
{'0': {'precision': 0.34164993639944213, 'recall': 0.652414398595259, 'f1-score': 0.4484565635026805, 'support': 34170}, '1': {'precision': 0.9282120780389114, 'recall': 0.7961069882805644, 'f1-score': 0.8570990559310916, 'support': 301977}, '2': {'precision': 0.3613708548963863, 'recall': 0.491154984000483, 'f1-score': 0.41638408680853245, 'support': 33126}, 'accuracy': 0.7554546365426121, 'macro avg': {'precision': 0.5437442897782466, 'recall': 0.6465587902921021, 'f1-score': 0.5739799020807682, 'support': 369273}, 'weighted avg': {'precision': 0.8230865726874776, 'recall': 0.7554546365426121, 'f1-score': 0.7797512995735115, 'support': 369273}}
[[ 22293   8140   3737]
 [ 36555 240406  25016]
 [  6403  10453  16270]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7681261
{'0': {'precision': 0.38890145688173017, 'recall': 0.6191608139744282, 'f1-score': 0.4777334685767483, 'support': 27765}, '1': {'precision': 0.8495702317484496, 'recall': 0.7128289864069162, 'f1-score': 0.7752158093035031, 'support': 109541}, '2': {'precision': 0.4337470047566253, 'recall': 0.4530613769658934, 'f1-score': 0.4431938607710579, 'support': 26769}, 'accuracy': 0.6545969830870029, 'macro avg': {'precision': 0.557406231128935, 'recall': 0.5950170591157459, 'f1-score': 0.5653810462171031, 'support': 164075}, 'weighted avg': {'precision': 0.7037732456291833, 'recall': 0.6545969830870029, 'f1-score': 0.6707057210478677, 'support': 164075}}
[[17191  6550  4024]
 [19648 78084 11809]
 [ 7365  7276 12128]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6918675
{'0': {'precision': 0.3845940895563707, 'recall': 0.5644489588623667, 'f1-score': 0.457479212974397, 'support': 9845}, '1': {'precision': 0.8459330753858583, 'recall': 0.789425652217042, 'f1-score': 0.8167030982215244, 'support': 50405}, '2': {'precision': 0.4547770700636943, 'recall': 0.39779173419773095, 'f1-score': 0.4243799643378181, 'support': 9872}, 'accuracy': 0.7027038589886199, 'macro avg': {'precision': 0.5617680783353077, 'recall': 0.5838887817590465, 'f1-score': 0.5661874251779132, 'support': 70122}, 'weighted avg': {'precision': 0.7260937325258185, 'recall': 0.7027038589886199, 'f1-score': 0.7110362158171731, 'support': 70122}}
[[ 5557  3293   995]
 [ 6901 39791  3713]
 [ 1991  3954  3927]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
1359/1359 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1135015
{'0': {'precision': 0.4563116890318288, 'recall': 0.5982370848289336, 'f1-score': 0.5177239429530861, 'support': 110045}, '1': {'precision': 0.501380633687462, 'recall': 0.5732424189146836, 'f1-score': 0.5349087692768592, 'support': 130819}, '2': {'precision': 0.5322646404744255, 'recall': 0.2685786958676604, 'f1-score': 0.3570110070417721, 'support': 106937}, 'accuracy': 0.4874770342810975, 'macro avg': {'precision': 0.4966523210645721, 'recall': 0.48001939987042586, 'f1-score': 0.4698812397572391, 'support': 347801}, 'weighted avg': {'precision': 0.49661650425467824, 'recall': 0.4874770342810975, 'f1-score': 0.4747739300643983, 'support': 347801}}
[[65833 33707 10505]
 [41094 74991 14734]
 [37345 40871 28721]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2164148
{'0': {'precision': 0.4384359909533609, 'recall': 0.5733240967707556, 'f1-score': 0.49688838600177804, 'support': 37532}, '1': {'precision': 0.43987012987012986, 'recall': 0.5314469520646461, 'f1-score': 0.48134156017953794, 'support': 38239}, '2': {'precision': 0.5001638448935009, 'recall': 0.24215981807604844, 'f1-score': 0.3263255416191562, 'support': 37818}, 'accuracy': 0.4489695305003125, 'macro avg': {'precision': 0.45948998857233053, 'recall': 0.44897695563715007, 'f1-score': 0.43485182926682403, 'support': 113589}, 'weighted avg': {'precision': 0.4594702814070715, 'recall': 0.4489695305003125, 'f1-score': 0.434867937529843, 'support': 113589}}
[[21518 11988  4026]
 [12791 20322  5126]
 [14770 13890  9158]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1228937
{'0': {'precision': 0.4622324049545357, 'recall': 0.5484199796126402, 'f1-score': 0.5016511907999535, 'support': 11772}, '1': {'precision': 0.5010884353741497, 'recall': 0.5565545901020023, 'f1-score': 0.5273671022015393, 'support': 13235}, '2': {'precision': 0.49329153605015674, 'recall': 0.3381177481736141, 'f1-score': 0.4012238653748088, 'support': 11635}, 'accuracy': 0.4845805359969434, 'macro avg': {'precision': 0.48553745879294735, 'recall': 0.4810307726294189, 'f1-score': 0.4767473861254338, 'support': 36642}, 'weighted avg': {'precision': 0.4861293689003122, 'recall': 0.4845805359969434, 'f1-score': 0.4790508457335933, 'support': 36642}}
[[6456 3444 1872]
 [3700 7366 2169]
 [3811 3890 3934]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2780652
{'0': {'precision': 0.3904259817134401, 'recall': 0.5727160840787293, 'f1-score': 0.4643203683261509, 'support': 103189}, '1': {'precision': 0.32351685872812636, 'recall': 0.10499621740844531, 'f1-score': 0.15853913603089054, 'support': 93851}, '2': {'precision': 0.3689263786915411, 'recall': 0.4282768466134405, 'f1-score': 0.3963923403297397, 'support': 94565}, 'accuracy': 0.3753433583100427, 'macro avg': {'precision': 0.3609564063777025, 'recall': 0.3686630493668717, 'f1-score': 0.3397506148955937, 'support': 291605}, 'weighted avg': {'precision': 0.36191961844442705, 'recall': 0.3753433583100427, 'f1-score': 0.34387837179103287, 'support': 291605}}
[[59098 10659 33432]
 [48151  9854 35846]
 [44119  9946 40500]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2684704
{'0': {'precision': 0.37020260872833893, 'recall': 0.5955793420416062, 'f1-score': 0.4565938014325784, 'support': 33072}, '1': {'precision': 0.35784250547751, 'recall': 0.1711459039635086, 'f1-score': 0.23154866149612208, 'support': 32446}, '2': {'precision': 0.37949149688499745, 'recall': 0.34251238564177383, 'f1-score': 0.3600549555882165, 'support': 32901}, 'accuracy': 0.37105640171105175, 'macro avg': {'precision': 0.36917887036361546, 'recall': 0.3697458772156295, 'f1-score': 0.349399139505639, 'support': 98419}, 'weighted avg': {'precision': 0.3692330581249577, 'recall': 0.37105640171105175, 'f1-score': 0.3501302204420825, 'support': 98419}}
[[19697  4914  8461]
 [16928  5553  9965]
 [16581  5051 11269]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2956257
{'0': {'precision': 0.37714056144227387, 'recall': 0.597834739691132, 'f1-score': 0.462509622786759, 'support': 12562}, '1': {'precision': 0.3183990442054958, 'recall': 0.13915238012357498, 'f1-score': 0.1936655968025192, 'support': 11491}, '2': {'precision': 0.3576082790341127, 'recall': 0.3297402367909525, 'f1-score': 0.34310931322975086, 'support': 11318}, 'accuracy': 0.363037516609652, 'macro avg': {'precision': 0.35104929489396075, 'recall': 0.3555757855352198, 'f1-score': 0.3330948442730097, 'support': 35371}, 'weighted avg': {'precision': 0.3518072333807719, 'recall': 0.363037516609652, 'f1-score': 0.3369644189149115, 'support': 35371}}
[[7510 1809 3243]
 [6431 1599 3461]
 [5972 1614 3732]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0817237
{'0': {'precision': 0.45005662256797546, 'recall': 0.6333406175214928, 'f1-score': 0.5261950625484335, 'support': 187621}, '1': {'precision': 0.5032923369960369, 'recall': 0.4744331071232057, 'f1-score': 0.48843680742588524, 'support': 207182}, '2': {'precision': 0.5407976641211577, 'recall': 0.3563469914161275, 'f1-score': 0.4296110318107667, 'support': 189192}, 'accuracy': 0.4872301988886891, 'macro avg': {'precision': 0.4980488745617233, 'recall': 0.488040238686942, 'f1-score': 0.4814143005950285, 'support': 583995}, 'weighted avg': {'precision': 0.4983395032778518, 'recall': 0.4872301988886891, 'f1-score': 0.48151016497889876, 'support': 583995}}
[[118828  44686  24107]
 [ 75749  98294  33139]
 [ 69452  52322  67418]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0979611
{'0': {'precision': 0.4758086690643526, 'recall': 0.5819500121068633, 'f1-score': 0.5235539365480851, 'support': 74338}, '1': {'precision': 0.48609814296088805, 'recall': 0.5050799040612284, 'f1-score': 0.49540726643141303, 'support': 74214}, '2': {'precision': 0.5220067007582437, 'recall': 0.3885367038101613, 'f1-score': 0.44548949970278623, 'support': 76191}, 'accuracy': 0.49099638253471745, 'macro avg': {'precision': 0.4946378375944948, 'recall': 0.49185553999275095, 'f1-score': 0.48815023422742815, 'support': 224743}, 'weighted avg': {'precision': 0.494868204838756, 'recall': 0.49099638253471745, 'f1-score': 0.4877944936122924, 'support': 224743}}
[[43261 17976 13101]
 [22724 37484 14006]
 [24936 21652 29603]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.109792
{'0': {'precision': 0.46788812006627034, 'recall': 0.5766043476520277, 'f1-score': 0.5165883576629245, 'support': 24979}, '1': {'precision': 0.48207289125452796, 'recall': 0.482786703190938, 'f1-score': 0.48242953318043946, 'support': 27014}, '2': {'precision': 0.5179723502304148, 'recall': 0.39867580988413337, 'f1-score': 0.45056119722073756, 'support': 25374}, 'accuracy': 0.48549123011102924, 'macro avg': {'precision': 0.48931112051707104, 'recall': 0.4860222869090331, 'f1-score': 0.4831930293547005, 'support': 77367}, 'weighted avg': {'precision': 0.48926706283340093, 'recall': 0.48549123011102924, 'f1-score': 0.4830063439667762, 'support': 77367}}
[[14403  6569  4007]
 [ 8565 13042  5407]
 [ 7815  7443 10116]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
5098/5098 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74158657
{'0': {'precision': 0.33376930809724037, 'recall': 0.8059195072297333, 'f1-score': 0.47204323266603987, 'support': 153256}, '1': {'precision': 0.9507023431235708, 'recall': 0.6085043973600833, 'f1-score': 0.7420524056890355, 'support': 999577}, '2': {'precision': 0.3567400498861295, 'recall': 0.6921711227133445, 'f1-score': 0.4708218718550822, 'support': 152078}, 'accuracy': 0.6414406806287939, 'macro avg': {'precision': 0.5470705670356469, 'recall': 0.7021983424343871, 'f1-score': 0.5616391700700526, 'support': 1304911}, 'weighted avg': {'precision': 0.8090242617471712, 'recall': 0.6414406806287939, 'f1-score': 0.6787310581448642, 'support': 1304911}}
[[123512  13253  16491]
 [218013 608247 173317]
 [ 28527  18287 105264]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65530425
{'0': {'precision': 0.3514765581469394, 'recall': 0.7807758956042012, 'f1-score': 0.48474070170816314, 'support': 56554}, '1': {'precision': 0.9368612924950953, 'recall': 0.6989854854786515, 'f1-score': 0.8006280957095245, 'support': 366185}, '2': {'precision': 0.41746856911108654, 'recall': 0.5910941741490917, 'f1-score': 0.4893364160850494, 'support': 57468}, 'accuracy': 0.69570622668974, 'macro avg': {'precision': 0.568602139917707, 'recall': 0.6902851850773147, 'f1-score': 0.5915684045009124, 'support': 480207}, 'weighted avg': {'precision': 0.8057630175974827, 'recall': 0.69570622668974, 'f1-score': 0.7261726922584871, 'support': 480207}}
[[ 44156   6233   6165]
 [ 68992 255958  41235]
 [ 12482  11017  33969]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5988456
{'0': {'precision': 0.34822594833790954, 'recall': 0.7923212227815855, 'f1-score': 0.4838148148148148, 'support': 16487}, '1': {'precision': 0.9375379142290173, 'recall': 0.7289937800802674, 'f1-score': 0.8202175936961694, 'support': 125082}, '2': {'precision': 0.41521186440677965, 'recall': 0.5831696720823663, 'f1-score': 0.485062990372002, 'support': 16803}, 'accuracy': 0.7201146667340187, 'macro avg': {'precision': 0.5669919089912355, 'recall': 0.701494891648073, 'f1-score': 0.5963651329609955, 'support': 158372}, 'weighted avg': {'precision': 0.8207708657809978, 'recall': 0.7201146667340187, 'f1-score': 0.749637722159074, 'support': 158372}}
[[13063  2018  1406]
 [21503 91184 12395]
 [ 2947  4057  9799]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
5760/5760 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56015277
{'0': {'precision': 0.41861885325035136, 'recall': 0.6107133264767345, 'f1-score': 0.49674170773944326, 'support': 152651}, '1': {'precision': 0.8994052358397718, 'recall': 0.8691882359896869, 'f1-score': 0.8840386022354856, 'support': 1167051}, '2': {'precision': 0.5106673121923666, 'recall': 0.40891263754369417, 'f1-score': 0.4541602230363223, 'support': 154769}, 'accuracy': 0.7941153132208094, 'macro avg': {'precision': 0.6095638004274966, 'recall': 0.6296047333367052, 'f1-score': 0.6116468443370837, 'support': 1474471}, 'weighted avg': {'precision': 0.8088255623204942, 'recall': 0.7941153132208094, 'f1-score': 0.7988194930688822, 'support': 1474471}}
[[  93226   47923   11502]
 [ 103523 1014387   49141]
 [  25950   65532   63287]]
Evaluating performance on  train set...
2159/2159 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6598914
{'0': {'precision': 0.41757203221044575, 'recall': 0.6563581898985931, 'f1-score': 0.5104183075799453, 'support': 81454}, '1': {'precision': 0.8495526107146902, 'recall': 0.7718258408900894, 'f1-score': 0.8088261657804107, 'support': 388725}, '2': {'precision': 0.49578112297816274, 'recall': 0.4294803302574065, 'f1-score': 0.4602552925715327, 'support': 82360}, 'accuracy': 0.7037747561710576, 'macro avg': {'precision': 0.5876352553010996, 'recall': 0.6192214536820297, 'f1-score': 0.5931665886439629, 'support': 552539}, 'weighted avg': {'precision': 0.7331388086636764, 'recall': 0.7037747561710576, 'f1-score': 0.7128785298681151, 'support': 552539}}
[[ 53463  21913   6078]
 [ 58801 300028  29896]
 [ 15769  31219  35372]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6124035
{'0': {'precision': 0.4356326245292804, 'recall': 0.646509604444147, 'f1-score': 0.5205243233776555, 'support': 29882}, '1': {'precision': 0.8743048219994544, 'recall': 0.7926494371333439, 'f1-score': 0.8314771941029325, 'support': 157675}, '2': {'precision': 0.49798662185097675, 'recall': 0.5023499395729825, 'f1-score': 0.5001587646439495, 'support': 29788}, 'accuracy': 0.7327704801122639, 'macro avg': {'precision': 0.6026413561265705, 'recall': 0.6471696603834911, 'f1-score': 0.6173867607081792, 'support': 217345}, 'weighted avg': {'precision': 0.7624174118872982, 'recall': 0.7327704801122639, 'f1-score': 0.7433168634777196, 'support': 217345}}
[[ 19319   8154   2409]
 [ 20018 124981  12676]
 [  5010   9814  14964]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
6315/6315 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65259516
{'0': {'precision': 0.40008862882148843, 'recall': 0.7048125970281659, 'f1-score': 0.5104302519064843, 'support': 225450}, '1': {'precision': 0.888588652964336, 'recall': 0.7288884619079643, 'f1-score': 0.8008546279545713, 'support': 1165808}, '2': {'precision': 0.47135116637198426, 'recall': 0.5504964828762257, 'f1-score': 0.5078587976951077, 'support': 225184}, 'accuracy': 0.7006790221981364, 'macro avg': {'precision': 0.5866761493859362, 'recall': 0.6613991806041186, 'f1-score': 0.6063812258520545, 'support': 1616442}, 'weighted avg': {'precision': 0.7623313937346097, 'recall': 0.7006790221981364, 'f1-score': 0.7195314820444871, 'support': 1616442}}
[[158900  46389  20161]
 [197193 849744 118871]
 [ 41069  60152 123963]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6964326
{'0': {'precision': 0.4140527898429669, 'recall': 0.6954633204633205, 'f1-score': 0.5190704765734295, 'support': 89096}, '1': {'precision': 0.8421939493252122, 'recall': 0.7363977485928705, 'f1-score': 0.7857506522802042, 'support': 369902}, '2': {'precision': 0.5329993881921077, 'recall': 0.45186561922565727, 'f1-score': 0.489090579477073, 'support': 92543}, 'accuracy': 0.6820435833419456, 'macro avg': {'precision': 0.5964153757867622, 'recall': 0.6279088960939494, 'f1-score': 0.597970569443569, 'support': 551541}, 'weighted avg': {'precision': 0.7211522552060606, 'recall': 0.6820435833419456, 'f1-score': 0.6928945453866261, 'support': 551541}}
[[ 61963  20055   7078]
 [ 67946 272395  29561]
 [ 19741  30985  41817]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6185831
{'0': {'precision': 0.4292682926829268, 'recall': 0.6671147957278363, 'f1-score': 0.5223926425218955, 'support': 26778}, '1': {'precision': 0.8695965014670494, 'recall': 0.7926744838542767, 'f1-score': 0.8293556995806328, 'support': 137219}, '2': {'precision': 0.5073572200515422, 'recall': 0.4561796912957357, 'f1-score': 0.48040932795434427, 'support': 26757}, 'accuracy': 0.7278484330603814, 'macro avg': {'precision': 0.6020740047338394, 'recall': 0.6386563236259496, 'f1-score': 0.6107192233522908, 'support': 190754}, 'weighted avg': {'precision': 0.756972151636084, 'recall': 0.7278484330603814, 'f1-score': 0.7373177092500318, 'support': 190754}}
[[ 17864   6827   2087]
 [ 18684 108770   9765]
 [  5067   9484  12206]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
6082/6082 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7577383
{'0': {'precision': 0.41475626825344397, 'recall': 0.6321267918842763, 'f1-score': 0.500874566124804, 'support': 276106}, '1': {'precision': 0.8062689175938952, 'recall': 0.7521196382696116, 'f1-score': 0.7782535162583226, 'support': 1005832}, '2': {'precision': 0.5143718420134235, 'recall': 0.36999119570990957, 'f1-score': 0.4303957645176785, 'support': 274866}, 'accuracy': 0.6633705977117222, 'macro avg': {'precision': 0.5784656759535874, 'recall': 0.5847458752879325, 'f1-score': 0.5698412823002684, 'support': 1556804}, 'weighted avg': {'precision': 0.6852957102182098, 'recall': 0.6633705977117222, 'f1-score': 0.6676421218917169, 'support': 1556804}}
[[174534  79092  22480]
 [175791 756506  73535]
 [ 70486 102682 101698]]
Evaluating performance on  train set...
2440/2440 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.878724
{'0': {'precision': 0.4452361190458225, 'recall': 0.5760005578022591, 'f1-score': 0.5022464600774558, 'support': 143420}, '1': {'precision': 0.7126501783436864, 'recall': 0.7162534598362961, 'f1-score': 0.7144472758733711, 'support': 337805}, '2': {'precision': 0.5120463770445686, 'recall': 0.3554986677083188, 'f1-score': 0.4196480769389116, 'support': 143362}, 'accuracy': 0.6012437018381747, 'macro avg': {'precision': 0.5566442248113592, 'recall': 0.5492508951156246, 'f1-score': 0.5454472709632462, 'support': 624587}, 'weighted avg': {'precision': 0.6052007973185549, 'recall': 0.6012437018381747, 'f1-score': 0.5980554141165747, 'support': 624587}}
[[ 82610  44082  16728]
 [ 64012 241954  31839]
 [ 38920  53477  50965]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7747387
{'0': {'precision': 0.4329601070384846, 'recall': 0.6158257167897834, 'f1-score': 0.5084507479041112, 'support': 39935}, '1': {'precision': 0.7903103526147691, 'recall': 0.7403498167806278, 'f1-score': 0.7645147322142598, 'support': 132355}, '2': {'precision': 0.4944857739493605, 'recall': 0.38712067027689795, 'f1-score': 0.43426557395839305, 'support': 39148}, 'accuracy': 0.6514297335389098, 'macro avg': {'precision': 0.5725854112008714, 'recall': 0.5810987346157698, 'f1-score': 0.5690770180255881, 'support': 211438}, 'weighted avg': {'precision': 0.668044143784368, 'recall': 0.6514297335389098, 'f1-score': 0.6550050449261354, 'support': 211438}}
[[24593 11485  3857]
 [22730 97989 11636]
 [ 9479 14514 15155]]
testing model on single stock: results/universal/W3/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
13689/13689 - 182s - 182s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1436023
{'0': {'precision': 0.41892561419989244, 'recall': 0.5159004930566246, 'f1-score': 0.46238317317440775, 'support': 1071885}, '1': {'precision': 0.4375390913743106, 'recall': 0.5079139345553391, 'f1-score': 0.4701073354822182, 'support': 1333218}, '2': {'precision': 0.5035376543403814, 'recall': 0.29162902370301225, 'f1-score': 0.36934695224986935, 'support': 1099143}, 'accuracy': 0.4425168780958871, 'macro avg': {'precision': 0.45333411997152817, 'recall': 0.43848115043832525, 'f1-score': 0.4339458203021651, 'support': 3504246}, 'weighted avg': {'precision': 0.4525466997194766, 'recall': 0.4425168780958871, 'f1-score': 0.4361401186765313, 'support': 3504246}}
[[552986 411587 107312]
 [447332 677160 208726]
 [319692 458909 320542]]
Evaluating performance on  train set...
5475/5475 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1855744
{'0': {'precision': 0.4244061981450456, 'recall': 0.570543975619271, 'f1-score': 0.48674276552162904, 'support': 463973}, '1': {'precision': 0.37753939587164703, 'recall': 0.41759451590567975, 'f1-score': 0.39655806127533055, 'support': 465054}, '2': {'precision': 0.46525734805665114, 'recall': 0.25937753285972165, 'f1-score': 0.3330706436079438, 'support': 472539}, 'accuracy': 0.414883780000371, 'macro avg': {'precision': 0.4224009806911146, 'recall': 0.4158386747948908, 'f1-score': 0.40545715680163447, 'support': 1401566}, 'weighted avg': {'precision': 0.42262830660346073, 'recall': 0.414883780000371, 'f1-score': 0.4050078859187213, 'support': 1401566}}
[[264717 140421  58835]
 [188814 194204  82036]
 [170204 179769 122566]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1612236
{'0': {'precision': 0.4161385422828118, 'recall': 0.5545372652545447, 'f1-score': 0.4754714754661117, 'support': 159854}, '1': {'precision': 0.432514304947829, 'recall': 0.4642556683578407, 'f1-score': 0.4478232405077155, 'support': 193751}, '2': {'precision': 0.4619766931396416, 'recall': 0.276252751907691, 'f1-score': 0.34575248563502703, 'support': 167611}, 'accuracy': 0.43148713777013753, 'macro avg': {'precision': 0.43687651345676076, 'recall': 0.4316818951733588, 'f1-score': 0.42301573386961805, 'support': 521216}, 'weighted avg': {'precision': 0.4369663731540319, 'recall': 0.43148713777013753, 'f1-score': 0.42347920589648574, 'support': 521216}}
[[88645 51632 19577]
 [69453 89950 34348]
 [54920 66388 46303]]
training model: results/universal/W3/deepLOB_L2/h20
Epoch 1/50
10532/10532 - 423s - loss: 2.8655 - accuracy20: 0.5113 - val_loss: 3.4644 - val_accuracy20: 0.4749 - 423s/epoch - 40ms/step
Epoch 2/50
10532/10532 - 421s - loss: 2.7364 - accuracy20: 0.5457 - val_loss: 3.3664 - val_accuracy20: 0.4852 - 421s/epoch - 40ms/step
Epoch 3/50
10532/10532 - 422s - loss: 2.7004 - accuracy20: 0.5534 - val_loss: 3.2243 - val_accuracy20: 0.4946 - 422s/epoch - 40ms/step
Epoch 4/50
10532/10532 - 422s - loss: 2.6828 - accuracy20: 0.5567 - val_loss: 3.1126 - val_accuracy20: 0.5036 - 422s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 422s - loss: 2.6696 - accuracy20: 0.5592 - val_loss: 3.0690 - val_accuracy20: 0.5125 - 422s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 422s - loss: 2.6604 - accuracy20: 0.5611 - val_loss: 3.0046 - val_accuracy20: 0.5221 - 422s/epoch - 40ms/step
Epoch 7/50
10532/10532 - 425s - loss: 2.6536 - accuracy20: 0.5624 - val_loss: 2.9937 - val_accuracy20: 0.5228 - 425s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 422s - loss: 2.6482 - accuracy20: 0.5635 - val_loss: 3.0009 - val_accuracy20: 0.5257 - 422s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 422s - loss: 2.6437 - accuracy20: 0.5643 - val_loss: 2.9674 - val_accuracy20: 0.5282 - 422s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 425s - loss: 2.6396 - accuracy20: 0.5653 - val_loss: 2.9800 - val_accuracy20: 0.5305 - 425s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 424s - loss: 2.6362 - accuracy20: 0.5659 - val_loss: 2.9776 - val_accuracy20: 0.5293 - 424s/epoch - 40ms/step
Epoch 12/50
10532/10532 - 424s - loss: 2.6331 - accuracy20: 0.5663 - val_loss: 2.9676 - val_accuracy20: 0.5324 - 424s/epoch - 40ms/step
Epoch 13/50
10532/10532 - 424s - loss: 2.6306 - accuracy20: 0.5670 - val_loss: 2.9646 - val_accuracy20: 0.5318 - 424s/epoch - 40ms/step
Epoch 14/50
10532/10532 - 422s - loss: 2.6278 - accuracy20: 0.5675 - val_loss: 2.9648 - val_accuracy20: 0.5326 - 422s/epoch - 40ms/step
Epoch 15/50
10532/10532 - 424s - loss: 2.6250 - accuracy20: 0.5681 - val_loss: 2.9524 - val_accuracy20: 0.5323 - 424s/epoch - 40ms/step
Epoch 16/50
10532/10532 - 422s - loss: 2.6227 - accuracy20: 0.5686 - val_loss: 2.9402 - val_accuracy20: 0.5328 - 422s/epoch - 40ms/step
Epoch 17/50
10532/10532 - 422s - loss: 2.6208 - accuracy20: 0.5691 - val_loss: 2.9673 - val_accuracy20: 0.5324 - 422s/epoch - 40ms/step
Epoch 18/50
10532/10532 - 423s - loss: 2.6187 - accuracy20: 0.5693 - val_loss: 2.9686 - val_accuracy20: 0.5313 - 423s/epoch - 40ms/step
Epoch 19/50
10532/10532 - 422s - loss: 2.6166 - accuracy20: 0.5697 - val_loss: 2.9687 - val_accuracy20: 0.5293 - 422s/epoch - 40ms/step
Epoch 20/50
10532/10532 - 422s - loss: 2.6148 - accuracy20: 0.5702 - val_loss: 2.9777 - val_accuracy20: 0.5288 - 422s/epoch - 40ms/step
Epoch 21/50
10532/10532 - 426s - loss: 2.6132 - accuracy20: 0.5704 - val_loss: 2.9821 - val_accuracy20: 0.5282 - 426s/epoch - 40ms/step
Epoch 22/50
10532/10532 - 423s - loss: 2.6116 - accuracy20: 0.5708 - val_loss: 2.9746 - val_accuracy20: 0.5307 - 423s/epoch - 40ms/step
Epoch 23/50
10532/10532 - 422s - loss: 2.6100 - accuracy20: 0.5711 - val_loss: 2.9674 - val_accuracy20: 0.5293 - 422s/epoch - 40ms/step
Epoch 24/50
10532/10532 - 431s - loss: 2.6084 - accuracy20: 0.5714 - val_loss: 2.9786 - val_accuracy20: 0.5288 - 431s/epoch - 41ms/step
Epoch 25/50
10532/10532 - 430s - loss: 2.6068 - accuracy20: 0.5716 - val_loss: 2.9799 - val_accuracy20: 0.5290 - 430s/epoch - 41ms/step
Epoch 26/50
10532/10532 - 428s - loss: 2.6053 - accuracy20: 0.5718 - val_loss: 2.9731 - val_accuracy20: 0.5302 - 428s/epoch - 41ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 366s - 366s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9777426
{'0': {'precision': 0.4334500051594263, 'recall': 0.5813311470836041, 'f1-score': 0.49661542914107476, 'support': 1806442}, '1': {'precision': 0.6678690368653384, 'recall': 0.5667418448714088, 'f1-score': 0.613163767928398, 'support': 3457119}, '2': {'precision': 0.46225110211857623, 'recall': 0.43870918901364625, 'f1-score': 0.4501725728139627, 'support': 1822916}, 'accuracy': 0.5375259102654253, 'macro avg': {'precision': 0.5211900480477804, 'recall': 0.5289273936562197, 'f1-score': 0.5199839232944785, 'support': 7086477}, 'weighted avg': {'precision': 0.5552194639379558, 'recall': 0.5375259102654253, 'f1-score': 0.5415263278225633, 'support': 7086477}}
[[1050141  465028  291273]
 [ 858751 1959294  639074]
 [ 513858  509328  799730]]
Evaluating performance on  train set...
10532/10532 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0030228
{'0': {'precision': 0.4202512292880459, 'recall': 0.6146110593787169, 'f1-score': 0.49917956440503075, 'support': 728106}, '1': {'precision': 0.6466888387408487, 'recall': 0.5433208023318749, 'f1-score': 0.5905153817191202, 'support': 1226824}, '2': {'precision': 0.4751265331418537, 'recall': 0.38493382176282737, 'f1-score': 0.42530101795817815, 'support': 740878}, 'accuracy': 0.5190466086605574, 'macro avg': {'precision': 0.5140222003902495, 'recall': 0.5142885611578064, 'f1-score': 0.5049986546941098, 'support': 2695808}, 'weighted avg': {'precision': 0.5383809325710419, 'recall': 0.5190466086605574, 'f1-score': 0.5204414580584694, 'support': 2695808}}
[[447502 158276 122328]
 [367544 666559 192721]
 [249798 205891 285189]]
Evaluating performance on  val set...
3814/3814 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98353255
{'0': {'precision': 0.42653685947928743, 'recall': 0.5844654810472532, 'f1-score': 0.4931661594969411, 'support': 252470}, '1': {'precision': 0.6491463762602244, 'recall': 0.586543688110569, 'f1-score': 0.6162592394868212, 'support': 465447}, '2': {'precision': 0.4779817127351595, 'recall': 0.3879294969719058, 'f1-score': 0.4282730222324952, 'support': 257918}, 'accuracy': 0.533511300578479, 'macro avg': {'precision': 0.5178883161582238, 'recall': 0.5196462220432426, 'f1-score': 0.5125661404054193, 'support': 975835}, 'weighted avg': {'precision': 0.546312728780127, 'recall': 0.533511300578479, 'f1-score': 0.5347266657557639, 'support': 975835}}
[[147560  63828  41082]
 [124252 273005  68190]
 [ 74137  83727 100054]]
testing model out of sample: results/universal/W3/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 217s - 217s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8687817
{'0': {'precision': 0.4595438495383014, 'recall': 0.5750778259540407, 'f1-score': 0.5108601224641426, 'support': 928996}, '1': {'precision': 0.7356583756733848, 'recall': 0.7202128526978321, 'f1-score': 0.727853682427037, 'support': 2281202}, '2': {'precision': 0.49190724830239224, 'recall': 0.3933075307822275, 'f1-score': 0.4371161209119389, 'support': 926265}, 'accuracy': 0.6144145372507864, 'macro avg': {'precision': 0.5623698245046929, 'recall': 0.5628660698113668, 'f1-score': 0.5586099752677062, 'support': 4136463}, 'weighted avg': {'precision': 0.6190642158040277, 'recall': 0.6144145372507864, 'f1-score': 0.6140158029033784, 'support': 4136463}}
[[ 534245  273355  121396]
 [ 383353 1642951  254898]
 [ 244957  317001  364307]]
Evaluating performance on  train set...
6181/6181 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9460377
{'0': {'precision': 0.4673473883772023, 'recall': 0.5467376012295324, 'f1-score': 0.5039348628191969, 'support': 422925}, '1': {'precision': 0.6459688228165404, 'recall': 0.6589351427982758, 'f1-score': 0.652387562184014, 'support': 732887}, '2': {'precision': 0.4999322373460609, 'recall': 0.3983496684077704, 'f1-score': 0.44339720013849054, 'support': 425975}, 'accuracy': 0.5587610721291805, 'macro avg': {'precision': 0.5377494828466012, 'recall': 0.5346741374785262, 'f1-score': 0.5332398750472337, 'support': 1581787}, 'weighted avg': {'precision': 0.5588828847881936, 'recall': 0.5587610721291805, 'f1-score': 0.5564144461126295, 'support': 1581787}}
[[231229 121939  69757]
 [149986 482925  99976]
 [113554 142734 169687]]
Evaluating performance on  val set...
2209/2209 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8834671
{'0': {'precision': 0.48069102341860176, 'recall': 0.5335864849243106, 'f1-score': 0.5057594818200102, 'support': 136677}, '1': {'precision': 0.7010208245416404, 'recall': 0.6881449122542743, 'f1-score': 0.6945231962102404, 'support': 292094}, '2': {'precision': 0.48492239467849224, 'recall': 0.45041373984038835, 'f1-score': 0.4670314793982496, 'support': 135955}, 'accuracy': 0.5935055230324087, 'macro avg': {'precision': 0.5555447475462448, 'recall': 0.5573817123396577, 'f1-score': 0.5557713858095, 'support': 564726}, 'weighted avg': {'precision': 0.5956711890367445, 'recall': 0.5935055230324087, 'f1-score': 0.5940704199065326, 'support': 564726}}
[[ 72929  41240  22508]
 [ 48555 201003  42536]
 [ 30233  44486  61236]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1876317
{'0': {'precision': 0.422046897592255, 'recall': 0.4549905965673235, 'f1-score': 0.4379000236447097, 'support': 59021}, '1': {'precision': 0.39222020141697655, 'recall': 0.2606429035283931, 'f1-score': 0.3131725819561094, 'support': 55436}, '2': {'precision': 0.422063764141241, 'recall': 0.5222533299397641, 'f1-score': 0.4668436220233581, 'support': 58935}, 'accuracy': 0.4157169880963366, 'macro avg': {'precision': 0.4121102877168242, 'recall': 0.41262894334516026, 'f1-score': 0.4059720758747258, 'support': 173392}, 'weighted avg': {'precision': 0.41251659227766013, 'recall': 0.4157169880963366, 'f1-score': 0.40786057841653545, 'support': 173392}}
[[26854 11845 20322]
 [19163 14449 21824]
 [17611 10545 30779]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.212657
{'0': {'precision': 0.41465164366797486, 'recall': 0.43404894425302587, 'f1-score': 0.4241286284666019, 'support': 22638}, '1': {'precision': 0.3902061492999367, 'recall': 0.259122552913143, 'f1-score': 0.31143306379155433, 'support': 21403}, '2': {'precision': 0.3923079629825117, 'recall': 0.5002243359655419, 'f1-score': 0.43974204744907014, 'support': 22288}, 'accuracy': 0.3998401905652128, 'macro avg': {'precision': 0.3990552519834744, 'recall': 0.3977986110439036, 'f1-score': 0.3917679132357421, 'support': 66329}, 'weighted avg': {'precision': 0.399255619740632, 'recall': 0.3998401905652128, 'f1-score': 0.3930105460522915, 'support': 66329}}
[[ 9826  4328  8484]
 [ 7071  5546  8786]
 [ 6800  4339 11149]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2065314
{'0': {'precision': 0.43761904761904763, 'recall': 0.35959306117125345, 'f1-score': 0.3947877138970431, 'support': 7667}, '1': {'precision': 0.3748934356351236, 'recall': 0.25731421884142774, 'f1-score': 0.3051700208188758, 'support': 6836}, '2': {'precision': 0.38923414366660575, 'recall': 0.573139550531557, 'f1-score': 0.463615087356447, 'support': 7431}, 'accuracy': 0.4000638278471779, 'macro avg': {'precision': 0.40058220897359237, 'recall': 0.39668227684807933, 'f1-score': 0.38785760735745534, 'support': 21934}, 'weighted avg': {'precision': 0.4016775638590084, 'recall': 0.4000638278471779, 'f1-score': 0.3901752247156115, 'support': 21934}}
[[2757 1536 3374]
 [1768 1759 3309]
 [1775 1397 4259]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69000316
{'0': {'precision': 0.460027677240792, 'recall': 0.5615497899250661, 'f1-score': 0.505744211901929, 'support': 46174}, '1': {'precision': 0.8871506444882442, 'recall': 0.7737649969790258, 'f1-score': 0.8265875744850875, 'support': 278056}, '2': {'precision': 0.3665099231435837, 'recall': 0.5727638034766779, 'f1-score': 0.4469913543669976, 'support': 45043}, 'accuracy': 0.7227119231571222, 'macro avg': {'precision': 0.57122941495754, 'recall': 0.63602619679359, 'f1-score': 0.5931077135846713, 'support': 369273}, 'weighted avg': {'precision': 0.7702366109650475, 'recall': 0.7227119231571222, 'f1-score': 0.740167029341809, 'support': 369273}}
[[ 25929  13342   6903]
 [ 25217 215150  37689]
 [  5218  14026  25799]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83006114
{'0': {'precision': 0.47000051106454743, 'recall': 0.5159326788218794, 'f1-score': 0.49189666238767654, 'support': 35650}, '1': {'precision': 0.7648406981732788, 'recall': 0.7216818825835455, 'f1-score': 0.7426347666420017, 'support': 93871}, '2': {'precision': 0.46924409492121977, 'recall': 0.4938646755802512, 'f1-score': 0.4812396892316803, 'support': 34554}, 'accuracy': 0.628998933414597, 'macro avg': {'precision': 0.568028434719682, 'recall': 0.5771597456618921, 'f1-score': 0.5719237060871195, 'support': 164075}, 'weighted avg': {'precision': 0.6385259171329136, 'recall': 0.628998933414597, 'f1-score': 0.6331052287995336, 'support': 164075}}
[[18393 10160  7097]
 [13921 67745 12205]
 [ 6820 10669 17065]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79548454
{'0': {'precision': 0.44977023232065355, 'recall': 0.5412442396313364, 'f1-score': 0.4912855549358617, 'support': 13020}, '1': {'precision': 0.7682746169158835, 'recall': 0.7550272975432211, 'f1-score': 0.7615933549023658, 'support': 43960}, '2': {'precision': 0.482580874511198, 'recall': 0.41317912037741594, 'f1-score': 0.44519144051816023, 'support': 13142}, 'accuracy': 0.6512649382504777, 'macro avg': {'precision': 0.566875241249245, 'recall': 0.5698168858506578, 'f1-score': 0.5660234501187958, 'support': 70122}, 'weighted avg': {'precision': 0.6555922312150725, 'recall': 0.6512649382504777, 'f1-score': 0.6521047277325602, 'support': 70122}}
[[ 7047  4565  1408]
 [ 6355 33191  4414]
 [ 2266  5446  5430]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
1359/1359 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1446538
{'0': {'precision': 0.43674443574833605, 'recall': 0.6002969390385932, 'f1-score': 0.5056236989112041, 'support': 112481}, '1': {'precision': 0.46693244001152023, 'recall': 0.49505014142453074, 'f1-score': 0.48058036584890207, 'support': 124448}, '2': {'precision': 0.49817160767924773, 'recall': 0.2752363085359694, 'f1-score': 0.35457334076965974, 'support': 110872}, 'accuracy': 0.4590153564825863, 'macro avg': {'precision': 0.4672828278130347, 'recall': 0.4568611296663645, 'f1-score': 0.4469258018432553, 'support': 347801}, 'weighted avg': {'precision': 0.4671278738663081, 'recall': 0.4590153564825863, 'f1-score': 0.4485110165991732, 'support': 347801}}
[[67522 31311 13648]
 [45748 61608 17092]
 [41333 39023 30516]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2128804
{'0': {'precision': 0.4086451210793569, 'recall': 0.5929511903178614, 'f1-score': 0.48384086124194203, 'support': 37595}, '1': {'precision': 0.42409030679849147, 'recall': 0.43933794414233673, 'f1-score': 0.4315794932966833, 'support': 37882}, '2': {'precision': 0.4685763362635142, 'recall': 0.24336167086481947, 'f1-score': 0.3203467689013228, 'support': 38112}, 'accuracy': 0.4244249002984444, 'macro avg': {'precision': 0.4337705880471208, 'recall': 0.4252169351083392, 'f1-score': 0.4119223744799827, 'support': 113589}, 'weighted avg': {'precision': 0.4339045475952243, 'recall': 0.4244249002984444, 'f1-score': 0.4115552351004321, 'support': 113589}}
[[22292 10350  4953]
 [15673 16643  5566]
 [16586 12251  9275]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1697036
{'0': {'precision': 0.4355592195658148, 'recall': 0.5257048092868989, 'f1-score': 0.47640516982266307, 'support': 12060}, '1': {'precision': 0.4570303451470929, 'recall': 0.47295245705153816, 'f1-score': 0.4648551009188722, 'support': 12515}, '2': {'precision': 0.45922276956759717, 'recall': 0.3476423303223668, 'f1-score': 0.3957173851523441, 'support': 12067}, 'accuracy': 0.44904754107308553, 'macro avg': {'precision': 0.45060411142683493, 'recall': 0.4487665322202679, 'f1-score': 0.4456592186312931, 'support': 36642}, 'weighted avg': {'precision': 0.45068555531498794, 'recall': 0.44904754107308553, 'f1-score': 0.4458880416651476, 'support': 36642}}
[[6340 3337 2383]
 [4039 5919 2557]
 [4177 3695 4195]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1140/1140 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3090539
{'0': {'precision': 0.3738954549060046, 'recall': 0.4784802160099072, 'f1-score': 0.4197716667260357, 'support': 98514}, '1': {'precision': 0.3280124454665359, 'recall': 0.09932716826937847, 'f1-score': 0.15248082002263866, 'support': 97647}, '2': {'precision': 0.3702837474074401, 'recall': 0.5274925610829387, 'f1-score': 0.43512380623136426, 'support': 95444}, 'accuracy': 0.36755885530083504, 'macro avg': {'precision': 0.35739721592666024, 'recall': 0.3684333151207415, 'f1-score': 0.3357920976600129, 'support': 291605}, 'weighted avg': {'precision': 0.35734891409487723, 'recall': 0.36755885530083504, 'f1-score': 0.3352913604723705, 'support': 291605}}
[[47137 10070 41307]
 [43635  9699 44313]
 [35298  9800 50346]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.268824
{'0': {'precision': 0.37467181467181465, 'recall': 0.506411403351822, 'f1-score': 0.4306927554242382, 'support': 33534}, '1': {'precision': 0.3772896500372301, 'recall': 0.15618161082513948, 'f1-score': 0.22091426329213265, 'support': 32443}, '2': {'precision': 0.3645875352964905, 'recall': 0.4457493372788361, 'f1-score': 0.4011039303247996, 'support': 32442}, 'accuracy': 0.37096495595362683, 'macro avg': {'precision': 0.37218300000184507, 'recall': 0.36944745048526584, 'f1-score': 0.3509036496803901, 'support': 98419}, 'weighted avg': {'precision': 0.3722106663291766, 'recall': 0.37096495595362683, 'f1-score': 0.35178762243042716, 'support': 98419}}
[[16982  4142 12410]
 [14583  5067 12793]
 [13760  4221 14461]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3060727
{'0': {'precision': 0.3751631660140026, 'recall': 0.5093032621828434, 'f1-score': 0.4320612251870581, 'support': 12415}, '1': {'precision': 0.3349831271091114, 'recall': 0.1269719450839942, 'f1-score': 0.1841454365570121, 'support': 11727}, '2': {'precision': 0.3520466173962479, 'recall': 0.44117908985662124, 'f1-score': 0.3916050748982254, 'support': 11229}, 'accuracy': 0.36091713550648835, 'macro avg': {'precision': 0.3540643035064539, 'recall': 0.35915143237448627, 'f1-score': 0.3359372455474319, 'support': 35371}, 'weighted avg': {'precision': 0.3545031043627508, 'recall': 0.36091713550648835, 'f1-score': 0.3370231837164225, 'support': 35371}}
[[6323 1517 4575]
 [5695 1489 4543]
 [4836 1439 4954]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
2282/2282 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1300828
{'0': {'precision': 0.4373415519212606, 'recall': 0.5998153994608825, 'f1-score': 0.505852460067713, 'support': 190682}, '1': {'precision': 0.46309352517985614, 'recall': 0.4207464540166024, 'f1-score': 0.4409055104626871, 'support': 198887}, '2': {'precision': 0.4994216146825229, 'recall': 0.364174544556798, 'f1-score': 0.4212076145151695, 'support': 194426}, 'accuracy': 0.460380653943955, 'macro avg': {'precision': 0.46661889726121314, 'recall': 0.46157879934476104, 'f1-score': 0.4559885283485232, 'support': 583995}, 'weighted avg': {'precision': 0.46677966524055864, 'recall': 0.460380653943955, 'f1-score': 0.455553634380004, 'support': 583995}}
[[114374  44340  31968]
 [ 76205  83681  39001]
 [ 70942  52679  70805]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1361945
{'0': {'precision': 0.44694011503076014, 'recall': 0.5405096329781509, 'f1-score': 0.4892916080551952, 'support': 74328}, '1': {'precision': 0.4580861271184035, 'recall': 0.43548778842261504, 'f1-score': 0.4465012036191583, 'support': 74110}, '2': {'precision': 0.4842391304347826, 'recall': 0.40868881462551604, 'f1-score': 0.44326782985679253, 'support': 76305}, 'accuracy': 0.4611222596476865, 'macro avg': {'precision': 0.4630884575279821, 'recall': 0.4615620786754273, 'f1-score': 0.459686880510382, 'support': 224743}, 'weighted avg': {'precision': 0.46327936620307336, 'recall': 0.4611222596476865, 'f1-score': 0.4595552368748523, 'support': 224743}}
[[40175 17620 16533]
 [25154 32274 16682]
 [24560 20560 31185]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1564766
{'0': {'precision': 0.44718507511969624, 'recall': 0.5372713928670607, 'f1-score': 0.48810639371440934, 'support': 25207}, '1': {'precision': 0.4452972709551657, 'recall': 0.4136955291454443, 'f1-score': 0.42891509710731685, 'support': 26505}, '2': {'precision': 0.4752872027785199, 'recall': 0.416059247709998, 'f1-score': 0.4437054434352462, 'support': 25655}, 'accuracy': 0.4547416857316427, 'macro avg': {'precision': 0.45592318295112727, 'recall': 0.455675389907501, 'f1-score': 0.4535756447523241, 'support': 77367}, 'weighted avg': {'precision': 0.4558570390798632, 'recall': 0.4547416857316427, 'f1-score': 0.4531047561172049, 'support': 77367}}
[[13543  6441  5223]
 [ 8979 10965  6561]
 [ 7763  7218 10674]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
5098/5098 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7425106
{'0': {'precision': 0.43066416476335223, 'recall': 0.7239118748245726, 'f1-score': 0.5400474152310782, 'support': 210201}, '1': {'precision': 0.8905974864955979, 'recall': 0.6400616190437554, 'f1-score': 0.7448258950144346, 'support': 887388}, '2': {'precision': 0.43566956106110094, 'recall': 0.659476563027561, 'f1-score': 0.5247041621653775, 'support': 207322}, 'accuracy': 0.6566532123646747, 'macro avg': {'precision': 0.5856437374400171, 'recall': 0.6744833522986298, 'f1-score': 0.6031924908036301, 'support': 1304911}, 'weighted avg': {'precision': 0.7442311737598093, 'recall': 0.6566532123646747, 'f1-score': 0.676866686205042, 'support': 1304911}}
[[152167  33109  24925]
 [167229 567983 152176]
 [ 33935  36663 136724]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.687113
{'0': {'precision': 0.4350486719566856, 'recall': 0.6979299404467791, 'f1-score': 0.535991571925725, 'support': 76906}, '1': {'precision': 0.8758101594084184, 'recall': 0.714595466963161, 'f1-score': 0.7870318860244233, 'support': 324683}, '2': {'precision': 0.4935428067846768, 'recall': 0.5770052659696253, 'f1-score': 0.5320205710398697, 'support': 78618}, 'accuracy': 0.6894006126524603, 'macro avg': {'precision': 0.6014672127165935, 'recall': 0.6631768911265218, 'f1-score': 0.6183480096633392, 'support': 480207}, 'weighted avg': {'precision': 0.7426378031484384, 'recall': 0.6894006126524603, 'f1-score': 0.7050776746998692, 'support': 480207}}
[[ 53675  13378   9853]
 [ 55969 232017  36697]
 [ 13733  19522  45363]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6595803
{'0': {'precision': 0.4073286935401, 'recall': 0.7582713795052389, 'f1-score': 0.5299685501147086, 'support': 23001}, '1': {'precision': 0.8724571648591414, 'recall': 0.7297246524609522, 'f1-score': 0.7947331501724441, 'support': 111786}, '2': {'precision': 0.5334149437794704, 'recall': 0.49883400466398137, 'f1-score': 0.5155452334523782, 'support': 23585}, 'accuracy': 0.6994860202561058, 'macro avg': {'precision': 0.604400267392904, 'recall': 0.6622766788767241, 'f1-score': 0.6134156445798437, 'support': 158372}, 'weighted avg': {'precision': 0.7544140085374854, 'recall': 0.6994860202561058, 'f1-score': 0.7147032359087439, 'support': 158372}}
[[17441  3925  1635]
 [21557 81573  8656]
 [ 3820  8000 11765]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
5760/5760 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6934319
{'0': {'precision': 0.48572938460272286, 'recall': 0.5344189947861562, 'f1-score': 0.5089122615927477, 'support': 209826}, '1': {'precision': 0.8535452500181435, 'recall': 0.8016017039403621, 'f1-score': 0.8267584037397795, 'support': 1056375}, '2': {'precision': 0.4409082234697285, 'recall': 0.5324770730302012, 'f1-score': 0.482385590068596, 'support': 208270}, 'accuracy': 0.7255659826473358, 'macro avg': {'precision': 0.5933942860301983, 'recall': 0.6228325905855732, 'f1-score': 0.6060187518003745, 'support': 1474471}, 'weighted avg': {'precision': 0.7429176111592617, 'recall': 0.7255659826473358, 'f1-score': 0.732884118979048, 'support': 1474471}}
[[112135  74869  22822]
 [ 91780 846792 117803]
 [ 26944  70427 110899]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77033526
{'0': {'precision': 0.47728786166957227, 'recall': 0.5861327550720377, 'f1-score': 0.5261399768231174, 'support': 108832}, '1': {'precision': 0.7703433685717362, 'recall': 0.7288562208032314, 'f1-score': 0.7490257605688235, 'support': 333727}, '2': {'precision': 0.4983225706362596, 'recall': 0.46730314602655026, 'f1-score': 0.48231462972868977, 'support': 109980}, 'accuracy': 0.6486836223325413, 'macro avg': {'precision': 0.5819846002925226, 'recall': 0.5940973739672731, 'f1-score': 0.5858267890402102, 'support': 552539}, 'weighted avg': {'precision': 0.6584767595466358, 'recall': 0.6486836223325413, 'f1-score': 0.6520371393377238, 'support': 552539}}
[[ 63790  32797  12245]
 [ 50993 243239  39495]
 [ 18868  39718  51394]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7187329
{'0': {'precision': 0.5013433515482696, 'recall': 0.5524638699317543, 'f1-score': 0.5256636745607334, 'support': 39856}, '1': {'precision': 0.8012399284835257, 'recall': 0.7521688585337499, 'f1-score': 0.775929333548201, 'support': 137630}, '2': {'precision': 0.49466353111432704, 'recall': 0.5488346421134499, 'f1-score': 0.520342994422178, 'support': 39859}, 'accuracy': 0.6782580689686903, 'macro avg': {'precision': 0.5990822703820408, 'recall': 0.6178224568596513, 'f1-score': 0.6073120008437042, 'support': 217345}, 'weighted avg': {'precision': 0.6900227088876276, 'recall': 0.6782580689686903, 'f1-score': 0.6831643562272198, 'support': 217345}}
[[ 22019  13132   4705]
 [ 16466 103521  17643]
 [  5435  12548  21876]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
6315/6315 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73124886
{'0': {'precision': 0.501741321236895, 'recall': 0.5475718842493587, 'f1-score': 0.5236557383229244, 'support': 304413}, '1': {'precision': 0.8027674225528659, 'recall': 0.7343220284298649, 'f1-score': 0.767020815489362, 'support': 1007321}, '2': {'precision': 0.48647143786453795, 'recall': 0.5791971329928981, 'f1-score': 0.5288001725853039, 'support': 304708}, 'accuracy': 0.6699108288450807, 'macro avg': {'precision': 0.5969933938847664, 'recall': 0.6203636818907072, 'f1-score': 0.6064922421325302, 'support': 1616442}, 'weighted avg': {'precision': 0.6864538304275005, 'recall': 0.6699108288450807, 'f1-score': 0.6762837343608856, 'support': 1616442}}
[[166688  96109  41616]
 [122937 739698 144686]
 [ 42594  85628 176486]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78168434
{'0': {'precision': 0.4821581407597604, 'recall': 0.6200785734848356, 'f1-score': 0.5424895183632351, 'support': 118106}, '1': {'precision': 0.7527639298390894, 'recall': 0.7244867790161068, 'f1-score': 0.7383547174754976, 'support': 311172}, '2': {'precision': 0.5623752096477918, 'recall': 0.46074446071174435, 'f1-score': 0.506512131852125, 'support': 122263}, 'accuracy': 0.6436638436671073, 'macro avg': {'precision': 0.5990990934155471, 'recall': 0.6017699377375623, 'f1-score': 0.5957854558969525, 'support': 551541}, 'weighted avg': {'precision': 0.6526124208456476, 'recall': 0.6436638436671073, 'f1-score': 0.6450187274903046, 'support': 551541}}
[[ 73235  31345  13526]
 [ 55422 225440  30310]
 [ 23233  42698  56332]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7160205
{'0': {'precision': 0.508904279000742, 'recall': 0.5708617723766717, 'f1-score': 0.5381054503609164, 'support': 36042}, '1': {'precision': 0.7892693711758959, 'recall': 0.7784031845034355, 'f1-score': 0.7837986188233191, 'support': 118323}, '2': {'precision': 0.5254534641688968, 'recall': 0.4856137843853912, 'f1-score': 0.5047487110641398, 'support': 36389}, 'accuracy': 0.6833356050200782, 'macro avg': {'precision': 0.6078757047818449, 'recall': 0.6116262470884994, 'f1-score': 0.6088842600827918, 'support': 190754}, 'weighted avg': {'precision': 0.6859692270517643, 'recall': 0.6833356050200782, 'f1-score': 0.6841434594496195, 'support': 190754}}
[[20575 11404  4063]
 [14324 92103 11896]
 [ 5531 13187 17671]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83961636
{'0': {'precision': 0.4715910348031949, 'recall': 0.5970682323676558, 'f1-score': 0.5269631475630319, 'support': 356986}, '1': {'precision': 0.713603719586593, 'recall': 0.7521121533326399, 'f1-score': 0.7323520746152538, 'support': 846056}, '2': {'precision': 0.5690871894970956, 'recall': 0.342843493648272, 'f1-score': 0.427900593419465, 'support': 353762}, 'accuracy': 0.6235589065804045, 'macro avg': {'precision': 0.5847606479622945, 'recall': 0.5640079597828559, 'f1-score': 0.5624052718659168, 'support': 1556804}, 'weighted avg': {'precision': 0.6252691591617694, 'recall': 0.6235589065804045, 'f1-score': 0.6160726095037503, 'support': 1556804}}
[[213145 111004  32837]
 [150727 636329  59000]
 [ 88098 144379 121285]]
Evaluating performance on  train set...
2440/2440 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9562649
{'0': {'precision': 0.4934689080676976, 'recall': 0.5309081389390192, 'f1-score': 0.5115043535425359, 'support': 179532}, '1': {'precision': 0.6015915412409992, 'recall': 0.6966342445393486, 'f1-score': 0.6456338696150244, 'support': 265765}, '2': {'precision': 0.5383968564544558, 'recall': 0.37140944837972, 'f1-score': 0.4395785749178142, 'support': 179290}, 'accuracy': 0.5556407674191105, 'macro avg': {'precision': 0.5444857685877175, 'recall': 0.5329839439526959, 'f1-score': 0.5322389326917915, 'support': 624587}, 'weighted avg': {'precision': 0.5523723810371388, 'recall': 0.5556407674191105, 'f1-score': 0.5479305967870776, 'support': 624587}}
[[ 95315  56749  27468]
 [ 51000 185141  29624]
 [ 46838  65862  66590]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87001294
{'0': {'precision': 0.5003797982652936, 'recall': 0.5459170890589164, 'f1-score': 0.5221574988939685, 'support': 51887}, '1': {'precision': 0.6842169207938836, 'recall': 0.7259409988214496, 'f1-score': 0.7044616889818128, 'support': 108608}, '2': {'precision': 0.5118692863275923, 'recall': 0.3978760575545217, 'f1-score': 0.447730862261296, 'support': 50943}, 'accuracy': 0.6027204192245481, 'macro avg': {'precision': 0.5654886684622564, 'recall': 0.556578048478296, 'f1-score': 0.5581166833790258, 'support': 211438}, 'weighted avg': {'precision': 0.5975784626205315, 'recall': 0.6027204192245481, 'f1-score': 0.5978684748163777, 'support': 211438}}
[[28326 16744  6817]
 [17253 78843 12512]
 [11030 19644 20269]]
testing model on single stock: results/universal/W3/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
13689/13689 - 181s - 181s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.181754
{'0': {'precision': 0.423243479374164, 'recall': 0.5734810049340098, 'f1-score': 0.4870394972824125, 'support': 1147140}, '1': {'precision': 0.38726917223954394, 'recall': 0.35984198289889585, 'f1-score': 0.3730521379471811, 'support': 1186707}, '2': {'precision': 0.4844289799786839, 'recall': 0.3506761369413337, 'f1-score': 0.40684143799259137, 'support': 1170399}, 'accuracy': 0.42671690286583763, 'macro avg': {'precision': 0.4316472105307973, 'recall': 0.4279997082580798, 'f1-score': 0.42231102440739504, 'support': 3504246}, 'weighted avg': {'precision': 0.4314964635040527, 'recall': 0.42671690286583763, 'f1-score': 0.421652157001684, 'support': 3504246}}
[[657863 312453 176824]
 [499688 427027 259992]
 [396786 363182 410431]]
Evaluating performance on  train set...
5475/5475 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2001613
{'0': {'precision': 0.40438711289136686, 'recall': 0.6141234291134057, 'f1-score': 0.4876603436412, 'support': 463910}, '1': {'precision': 0.3736405140530515, 'recall': 0.2930841161722138, 'f1-score': 0.32849573830914536, 'support': 464655}, '2': {'precision': 0.45679732509050675, 'recall': 0.3211790249914905, 'f1-score': 0.37716755650946593, 'support': 473001}, 'accuracy': 0.408827697018906, 'macro avg': {'precision': 0.4116083173449751, 'recall': 0.40946219009237, 'f1-score': 0.3977745461532704, 'support': 1401566}, 'weighted avg': {'precision': 0.4118812458092515, 'recall': 0.408827697018906, 'f1-score': 0.39760405767488577, 'support': 1401566}}
[[284898  99271  79741]
 [227559 136183 100913]
 [192061 129022 151918]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1837922
{'0': {'precision': 0.4170179296199407, 'recall': 0.5712474403543026, 'f1-score': 0.48209809250616653, 'support': 167992}, '1': {'precision': 0.39687542236475115, 'recall': 0.35959165270441024, 'f1-score': 0.37731474045411406, 'support': 179651}, '2': {'precision': 0.4685317955112219, 'recall': 0.34637875706475085, 'f1-score': 0.39830005995501716, 'support': 173573}, 'accuracy': 0.42340987229862476, 'macro avg': {'precision': 0.42747504916530454, 'recall': 0.42573928337448796, 'f1-score': 0.419237630971766, 'support': 521216}, 'weighted avg': {'precision': 0.4272301922393639, 'recall': 0.42340987229862476, 'f1-score': 0.4180756720825726, 'support': 521216}}
[[95965 42418 29609]
 [76461 64601 38589]
 [57696 55755 60122]]
training model: results/universal/W3/deepLOB_L2/h30
Epoch 1/50
10532/10532 - 430s - loss: 2.9602 - accuracy30: 0.4881 - val_loss: 3.2996 - val_accuracy30: 0.4557 - 430s/epoch - 41ms/step
Epoch 2/50
10532/10532 - 430s - loss: 2.8474 - accuracy30: 0.5218 - val_loss: 3.4697 - val_accuracy30: 0.4492 - 430s/epoch - 41ms/step
Epoch 3/50
10532/10532 - 432s - loss: 2.8042 - accuracy30: 0.5310 - val_loss: 3.3475 - val_accuracy30: 0.4539 - 432s/epoch - 41ms/step
Epoch 4/50
10532/10532 - 424s - loss: 2.7812 - accuracy30: 0.5358 - val_loss: 3.2619 - val_accuracy30: 0.4623 - 424s/epoch - 40ms/step
Epoch 5/50
10532/10532 - 426s - loss: 2.7667 - accuracy30: 0.5389 - val_loss: 3.1726 - val_accuracy30: 0.4775 - 426s/epoch - 40ms/step
Epoch 6/50
10532/10532 - 423s - loss: 2.7561 - accuracy30: 0.5415 - val_loss: 3.1712 - val_accuracy30: 0.4768 - 423s/epoch - 40ms/step
Epoch 7/50
10532/10532 - 425s - loss: 2.7483 - accuracy30: 0.5431 - val_loss: 3.1436 - val_accuracy30: 0.4801 - 425s/epoch - 40ms/step
Epoch 8/50
10532/10532 - 423s - loss: 2.7423 - accuracy30: 0.5444 - val_loss: 3.1203 - val_accuracy30: 0.4884 - 423s/epoch - 40ms/step
Epoch 9/50
10532/10532 - 423s - loss: 2.7380 - accuracy30: 0.5455 - val_loss: 3.1118 - val_accuracy30: 0.4883 - 423s/epoch - 40ms/step
Epoch 10/50
10532/10532 - 423s - loss: 2.7336 - accuracy30: 0.5464 - val_loss: 3.1262 - val_accuracy30: 0.4855 - 423s/epoch - 40ms/step
Epoch 11/50
10532/10532 - 428s - loss: 2.7305 - accuracy30: 0.5471 - val_loss: 3.1186 - val_accuracy30: 0.4874 - 428s/epoch - 41ms/step
Epoch 12/50
10532/10532 - 428s - loss: 2.7269 - accuracy30: 0.5478 - val_loss: 3.0994 - val_accuracy30: 0.4911 - 428s/epoch - 41ms/step
Epoch 13/50
10532/10532 - 426s - loss: 2.7241 - accuracy30: 0.5483 - val_loss: 3.1137 - val_accuracy30: 0.4898 - 426s/epoch - 40ms/step
Epoch 14/50
10532/10532 - 428s - loss: 2.7215 - accuracy30: 0.5489 - val_loss: 3.1210 - val_accuracy30: 0.4878 - 428s/epoch - 41ms/step
Epoch 15/50
10532/10532 - 430s - loss: 2.7192 - accuracy30: 0.5495 - val_loss: 3.1081 - val_accuracy30: 0.4886 - 430s/epoch - 41ms/step
Epoch 16/50
10532/10532 - 424s - loss: 2.7168 - accuracy30: 0.5500 - val_loss: 3.1452 - val_accuracy30: 0.4826 - 424s/epoch - 40ms/step
Epoch 17/50
10532/10532 - 425s - loss: 2.7147 - accuracy30: 0.5507 - val_loss: 3.1486 - val_accuracy30: 0.4846 - 425s/epoch - 40ms/step
Epoch 18/50
10532/10532 - 425s - loss: 2.7126 - accuracy30: 0.5509 - val_loss: 3.1488 - val_accuracy30: 0.4850 - 425s/epoch - 40ms/step
Epoch 19/50
10532/10532 - 429s - loss: 2.7108 - accuracy30: 0.5513 - val_loss: 3.1411 - val_accuracy30: 0.4843 - 429s/epoch - 41ms/step
Epoch 20/50
10532/10532 - 426s - loss: 2.7089 - accuracy30: 0.5519 - val_loss: 3.1757 - val_accuracy30: 0.4806 - 426s/epoch - 40ms/step
Epoch 21/50
10532/10532 - 424s - loss: 2.7069 - accuracy30: 0.5522 - val_loss: 3.1872 - val_accuracy30: 0.4805 - 424s/epoch - 40ms/step
Epoch 22/50
10532/10532 - 428s - loss: 2.7054 - accuracy30: 0.5526 - val_loss: 3.2051 - val_accuracy30: 0.4796 - 428s/epoch - 41ms/step
testing model in sample: results/universal/W3/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 373s - 373s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0278561
{'0': {'precision': 0.46375421663462035, 'recall': 0.44930098880827085, 'f1-score': 0.45641320887463593, 'support': 1986735}, '1': {'precision': 0.5621756391323527, 'recall': 0.5211047855097507, 'f1-score': 0.5408616442887499, 'support': 3093777}, '2': {'precision': 0.43673255867178457, 'recall': 0.49942197396265636, 'f1-score': 0.46597827376176487, 'support': 2005965}, 'accuracy': 0.49483643282832923, 'macro avg': {'precision': 0.4875541381462525, 'recall': 0.48994258276022595, 'f1-score': 0.48775104230838356, 'support': 7086477}, 'weighted avg': {'precision': 0.49907352030488517, 'recall': 0.49483643282832923, 'f1-score': 0.4959888418099409, 'support': 7086477}}
[[ 892642  642653  451440]
 [ 640953 1612182  840642]
 [ 391222  612920 1001823]]
Evaluating performance on  train set...
10532/10532 - 148s - 148s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0378242
{'0': {'precision': 0.4245623126510518, 'recall': 0.49474795247583514, 'f1-score': 0.4569759369618724, 'support': 768367}, '1': {'precision': 0.5510187647410408, 'recall': 0.5377232458598993, 'f1-score': 0.5442898240745242, 'support': 1145262}, '2': {'precision': 0.45543591606228545, 'recall': 0.3975662859780178, 'f1-score': 0.4245380966585687, 'support': 782179}, 'accuracy': 0.4848082652770524, 'macro avg': {'precision': 0.4770056644847927, 'recall': 0.4766791614379174, 'f1-score': 0.4752679525649885, 'support': 2695808}, 'weighted avg': {'precision': 0.4872427607675647, 'recall': 0.4848082652770524, 'f1-score': 0.48465783400046414, 'support': 2695808}}
[[380148 230160 158059]
 [315663 615834 213765]
 [199577 271634 310968]]
Evaluating performance on  val set...
3814/3814 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0293025
{'0': {'precision': 0.4357760766516836, 'recall': 0.4383218671078986, 'f1-score': 0.43704526460128, 'support': 275592}, '1': {'precision': 0.5445861446270226, 'recall': 0.5782917300693097, 'f1-score': 0.5609330646635189, 'support': 419278}, '2': {'precision': 0.4570075570726702, 'recall': 0.412179452956774, 'f1-score': 0.43343750584800794, 'support': 280965}, 'accuracy': 0.4909344305133552, 'macro avg': {'precision': 0.4791232594504588, 'recall': 0.4762643500446608, 'f1-score': 0.4771386117042689, 'support': 975835}, 'weighted avg': {'precision': 0.48864051641562595, 'recall': 0.4909344305133552, 'f1-score': 0.48923623448490006, 'support': 975835}}
[[120798  94673  60121]
 [ 99337 242465  77476]
 [ 57067 108090 115808]]
testing model out of sample: results/universal/W3/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 219s - 219s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93877345
{'0': {'precision': 0.4574301772255185, 'recall': 0.5037473202303004, 'f1-score': 0.4794727853695267, 'support': 1032738}, '1': {'precision': 0.6708963940479101, 'recall': 0.6876534676657907, 'f1-score': 0.6791715855457402, 'support': 2079021}, '2': {'precision': 0.4746362038502383, 'recall': 0.40214735182062333, 'f1-score': 0.43539523801976854, 'support': 1024704}, 'accuracy': 0.5710112721907581, 'macro avg': {'precision': 0.5343209250412223, 'recall': 0.5311827132389049, 'f1-score': 0.5313465363116785, 'support': 4136463}, 'weighted avg': {'precision': 0.5689824458837326, 'recall': 0.5710112721907581, 'f1-score': 0.5689239807897842, 'support': 4136463}}
[[ 520239  342006  170493]
 [ 363744 1429646  285631]
 [ 253325  359297  412082]]
Evaluating performance on  train set...
6181/6181 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0086001
{'0': {'precision': 0.47461734302628755, 'recall': 0.46636325275785157, 'f1-score': 0.47045409629212975, 'support': 464492}, '1': {'precision': 0.5639346530953979, 'recall': 0.6277161104282004, 'f1-score': 0.5941184746611538, 'support': 649182}, '2': {'precision': 0.478766932824852, 'recall': 0.41193472516251417, 'f1-score': 0.4428435113408146, 'support': 468113}, 'accuracy': 0.516476617901146, 'macro avg': {'precision': 0.5057729763155125, 'recall': 0.5020046961161887, 'f1-score': 0.502472027431366, 'support': 1581787}, 'weighted avg': {'precision': 0.5125021321380078, 'recall': 0.516476617901146, 'f1-score': 0.513036197880425, 'support': 1581787}}
[[216622 150922  96948]
 [128692 407502 112988]
 [111100 164181 192832]]
Evaluating performance on  val set...
2209/2209 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9604982
{'0': {'precision': 0.4948876309377461, 'recall': 0.44101941747572815, 'f1-score': 0.4664032717396206, 'support': 152440}, '1': {'precision': 0.630283073018942, 'recall': 0.639158123700365, 'f1-score': 0.6346895742662172, 'support': 261131}, '2': {'precision': 0.453315942488313, 'recall': 0.49205120571598693, 'f1-score': 0.47189000907285567, 'support': 151155}, 'accuracy': 0.5462985589471708, 'macro avg': {'precision': 0.5261622154816671, 'recall': 0.5240762489640267, 'f1-score': 0.5243276183595645, 'support': 564726}, 'weighted avg': {'precision': 0.5463677799277531, 'recall': 0.5462985589471708, 'f1-score': 0.545687948284844, 'support': 564726}}
[[ 67229  49737  35474]
 [ 40006 166904  54221]
 [ 28612  48167  74376]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2226543
{'0': {'precision': 0.40260593257948274, 'recall': 0.3869910930621438, 'f1-score': 0.3946441155743482, 'support': 58606}, '1': {'precision': 0.3556986332316729, 'recall': 0.277078750549934, 'f1-score': 0.3115045998615096, 'support': 56825}, '2': {'precision': 0.39850811880100007, 'recall': 0.5004917099428926, 'f1-score': 0.44371534549348013, 'support': 57961}, 'accuracy': 0.3889106763864538, 'macro avg': {'precision': 0.3856042282040519, 'recall': 0.3881871845183234, 'f1-score': 0.3832880203097793, 'support': 173392}, 'weighted avg': {'precision': 0.38586340310953066, 'recall': 0.3889106763864538, 'f1-score': 0.38380056210568037, 'support': 173392}}
[[22680 14975 20951]
 [18246 15745 22834]
 [15407 13545 29009]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2681005
{'0': {'precision': 0.38550604299289604, 'recall': 0.37383135763811226, 'f1-score': 0.37957895214952425, 'support': 22355}, '1': {'precision': 0.35356200527704484, 'recall': 0.25099364977842753, 'f1-score': 0.29357700117559044, 'support': 21889}, '2': {'precision': 0.37640835394339106, 'recall': 0.4961738736699117, 'f1-score': 0.4280719573412504, 'support': 22085}, 'accuracy': 0.37402945921090325, 'macro avg': {'precision': 0.37182546740444394, 'recall': 0.3736662936954838, 'f1-score': 0.36707597022212174, 'support': 66329}, 'weighted avg': {'precision': 0.37193512372348775, 'recall': 0.37402945921090325, 'f1-score': 0.36734405210264937, 'support': 66329}}
[[ 8357  5160  8838]
 [ 7079  5494  9316]
 [ 6242  4885 10958]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2479429
{'0': {'precision': 0.41225109686128925, 'recall': 0.3225934240063383, 'f1-score': 0.36195273723979554, 'support': 7573}, '1': {'precision': 0.34975165562913907, 'recall': 0.24094667807242656, 'f1-score': 0.28532838088806345, 'support': 7014}, '2': {'precision': 0.3792054402290623, 'recall': 0.5768340819382061, 'f1-score': 0.4575932624304918, 'support': 7347}, 'accuracy': 0.38164493480441325, 'macro avg': {'precision': 0.38040273090649684, 'recall': 0.380124728005657, 'f1-score': 0.3682914601861169, 'support': 21934}, 'weighted avg': {'precision': 0.3811962267929354, 'recall': 0.38164493480441325, 'f1-score': 0.36948568622880784, 'support': 21934}}
[[2443 1683 3447]
 [1833 1690 3491]
 [1650 1459 4238]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80465335
{'0': {'precision': 0.4772856634649591, 'recall': 0.48512954023611937, 'f1-score': 0.4811756372667689, 'support': 55311}, '1': {'precision': 0.8385621620100465, 'recall': 0.687694964670767, 'f1-score': 0.7556721161811696, 'support': 259983}, '2': {'precision': 0.3252974640439085, 'recall': 0.6016969562237167, 'f1-score': 0.4222905547284866, 'support': 53979}, 'accuracy': 0.644783127929743, 'macro avg': {'precision': 0.5470484298396381, 'recall': 0.591507153710201, 'f1-score': 0.553046102725475, 'support': 369273}, 'weighted avg': {'precision': 0.7094217170207257, 'recall': 0.644783127929743, 'f1-score': 0.6658245561080292, 'support': 369273}}
[[ 26833  18330  10148]
 [ 23977 178789  57217]
 [  5410  16090  32479]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92725486
{'0': {'precision': 0.44450685765107895, 'recall': 0.46563856130629855, 'f1-score': 0.4548273921425407, 'support': 40787}, '1': {'precision': 0.7123175423246254, 'recall': 0.6136736183399739, 'f1-score': 0.6593263915670394, 'support': 83577}, '2': {'precision': 0.43701617152352773, 'recall': 0.5430485255974415, 'f1-score': 0.48429657410422544, 'support': 39711}, 'accuracy': 0.5597805881456651, 'macro avg': {'precision': 0.5312801904997441, 'recall': 0.5407869017479047, 'f1-score': 0.5328167859379351, 'support': 164075}, 'weighted avg': {'precision': 0.5791120745101361, 'recall': 0.5597805881456651, 'f1-score': 0.56612809950065, 'support': 164075}}
[[18992 10060 11735]
 [16242 51289 16046]
 [ 7492 10654 21565]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8954183
{'0': {'precision': 0.42109966358284273, 'recall': 0.5291630887112755, 'f1-score': 0.4689869156689986, 'support': 15139}, '1': {'precision': 0.6975969033922907, 'recall': 0.6563646020384937, 'f1-score': 0.6763529273791064, 'support': 39539}, '2': {'precision': 0.4562464018422568, 'recall': 0.4105154105154105, 'f1-score': 0.43217450579413774, 'support': 15444}, 'accuracy': 0.5747554262570947, 'macro avg': {'precision': 0.5249809896057968, 'recall': 0.5320143670883932, 'f1-score': 0.5258381162807476, 'support': 70122}, 'weighted avg': {'precision': 0.5847463164236653, 'recall': 0.5747554262570947, 'f1-score': 0.5778046031122916, 'support': 70122}}
[[ 8011  5209  1919]
 [ 7950 25952  5637]
 [ 3063  6041  6340]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
1359/1359 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1898699
{'0': {'precision': 0.4150256834675075, 'recall': 0.5300407065112948, 'f1-score': 0.4655345038572048, 'support': 114478}, '1': {'precision': 0.4053480231824181, 'recall': 0.4666363899095826, 'f1-score': 0.43383834700465607, 'support': 121105}, '2': {'precision': 0.46027789392428675, 'recall': 0.25504820973462367, 'f1-score': 0.32822247706422014, 'support': 112218}, 'accuracy': 0.41923686245870484, 'macro avg': {'precision': 0.4268838668580708, 'recall': 0.4172417687185003, 'f1-score': 0.409198442642027, 'support': 347801}, 'weighted avg': {'precision': 0.4262565295668951, 'recall': 0.41923686245870484, 'f1-score': 0.41019411064878075, 'support': 347801}}
[[60678 38437 15363]
 [46395 56512 18198]
 [39130 44467 28621]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2515318
{'0': {'precision': 0.3964552032394397, 'recall': 0.4779396073410158, 'f1-score': 0.43340066036937147, 'support': 37488}, '1': {'precision': 0.3685657848870986, 'recall': 0.5064665495768801, 'f1-score': 0.42664992826398845, 'support': 37578}, '2': {'precision': 0.44844253490870034, 'recall': 0.19507826493263764, 'f1-score': 0.271883648993325, 'support': 38523}, 'accuracy': 0.3914463548406976, 'macro avg': {'precision': 0.40448784101174623, 'recall': 0.39316147395017786, 'f1-score': 0.37731141254222833, 'support': 113589}, 'weighted avg': {'precision': 0.40485988516331134, 'recall': 0.3914463548406976, 'f1-score': 0.37638986847671, 'support': 113589}}
[[17917 15281  4290]
 [13593 19032  4953]
 [13683 17325  7515]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1978436
{'0': {'precision': 0.4307333172341624, 'recall': 0.43352507494126225, 'f1-score': 0.43212468707098445, 'support': 12343}, '1': {'precision': 0.4080560420315236, 'recall': 0.4658835291177206, 'f1-score': 0.43505659936982144, 'support': 12003}, '2': {'precision': 0.43699476937708037, 'recall': 0.37369876382563433, 'f1-score': 0.40287580553241853, 'support': 12296}, 'accuracy': 0.4240489056274221, 'macro avg': {'precision': 0.42526137621425547, 'recall': 0.42436912262820575, 'f1-score': 0.42335236399107484, 'support': 36642}, 'weighted avg': {'precision': 0.4254059737838062, 'recall': 0.4240489056274221, 'f1-score': 0.4232700256421523, 'support': 36642}}
[[5351 3978 3014]
 [3505 5592 2906]
 [3567 4134 4595]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3004379
{'0': {'precision': 0.37042698565771387, 'recall': 0.3752936285209438, 'f1-score': 0.372844427004812, 'support': 96210}, '1': {'precision': 0.32926999407066376, 'recall': 0.18993059048385474, 'f1-score': 0.24090282739614174, 'support': 99410}, '2': {'precision': 0.36274115608711227, 'recall': 0.5169453560452154, 'f1-score': 0.42632768264496895, 'support': 95985}, 'accuracy': 0.35872841686528006, 'macro avg': {'precision': 0.35414604527182997, 'recall': 0.36072319168333794, 'f1-score': 0.34669164568197425, 'support': 291605}, 'weighted avg': {'precision': 0.35386642982018424, 'recall': 0.35872841686528006, 'f1-score': 0.3454692992653101, 'support': 291605}}
[[36107 19089 41014]
 [34373 18881 46156]
 [26994 19372 49619]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2589606
{'0': {'precision': 0.36711690288214593, 'recall': 0.45846820895079143, 'f1-score': 0.40773852756685375, 'support': 33673}, '1': {'precision': 0.32385146874621196, 'recall': 0.24762875768529674, 'f1-score': 0.28065690874711113, 'support': 32367}, '2': {'precision': 0.36362198747548863, 'recall': 0.3550758207480157, 'f1-score': 0.3592980920980671, 'support': 32379}, 'accuracy': 0.3551143579999797, 'macro avg': {'precision': 0.3515301197012822, 'recall': 0.3537242624613679, 'f1-score': 0.34923117613734395, 'support': 98419}, 'weighted avg': {'precision': 0.3517384274594132, 'recall': 0.3551143579999797, 'f1-score': 0.3500087841597631, 'support': 98419}}
[[15438  8565  9670]
 [13901  8015 10451]
 [12713  8169 11497]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2926033
{'0': {'precision': 0.36396780628740455, 'recall': 0.42988300292492687, 'f1-score': 0.39418886198547215, 'support': 12308}, '1': {'precision': 0.3224368499257058, 'recall': 0.23674051695199733, 'f1-score': 0.2730220179046698, 'support': 11916}, '2': {'precision': 0.3406702523789822, 'recall': 0.36933704135641876, 'f1-score': 0.3544249311294766, 'support': 11147}, 'accuracy': 0.3457352068078369, 'macro avg': {'precision': 0.34235830286403085, 'recall': 0.34532018707778095, 'f1-score': 0.3405452703398728, 'support': 35371}, 'weighted avg': {'precision': 0.34263449059310164, 'recall': 0.3457352068078369, 'f1-score': 0.34083801945010067, 'support': 35371}}
[[5291 3074 3943]
 [5070 2821 4025]
 [4176 2854 4117]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
2282/2282 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1506895
{'0': {'precision': 0.43514785798196465, 'recall': 0.5287165110953658, 'f1-score': 0.477390522284962, 'support': 194766}, '1': {'precision': 0.41974352656834796, 'recall': 0.3754946104516305, 'f1-score': 0.39638801174450167, 'support': 190554}, '2': {'precision': 0.47024869546536413, 'recall': 0.4186686800050333, 'f1-score': 0.44296220557144306, 'support': 198675}, 'accuracy': 0.4412828876959563, 'macro avg': {'precision': 0.4417133600052256, 'recall': 0.4409599338506765, 'f1-score': 0.43891357986696894, 'support': 583995}, 'weighted avg': {'precision': 0.4420628177313188, 'recall': 0.4412828876959563, 'f1-score': 0.4392473905516676, 'support': 583995}}
[[102976  48031  43759]
 [ 69057  71552  49945]
 [ 64613  50883  83179]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1771078
{'0': {'precision': 0.4407645672835094, 'recall': 0.4473914036572749, 'f1-score': 0.4440532629206591, 'support': 74427}, '1': {'precision': 0.42187478246341903, 'recall': 0.4091602641137472, 'f1-score': 0.415420259654799, 'support': 74059}, '2': {'precision': 0.4468140105984232, 'recall': 0.45333543150137035, 'f1-score': 0.45005109778880015, 'support': 76257}, 'accuracy': 0.4368100452516875, 'macro avg': {'precision': 0.4364844534484506, 'recall': 0.4366290330907974, 'f1-score': 0.4365082067880861, 'support': 224743}, 'weighted avg': {'precision': 0.4365924855050972, 'recall': 0.4368100452516875, 'f1-score': 0.4366530115431902, 'support': 224743}}
[[33298 19988 21141]
 [22098 30302 21659]
 [20150 21537 34570]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1985531
{'0': {'precision': 0.4303084343209176, 'recall': 0.42010921177587845, 'f1-score': 0.4251476624286715, 'support': 25272}, '1': {'precision': 0.4092291033276415, 'recall': 0.3715214761040532, 'f1-score': 0.38946471392615795, 'support': 26448}, '2': {'precision': 0.433009099466583, 'recall': 0.48426716575038015, 'f1-score': 0.45720596355604637, 'support': 25647}, 'accuracy': 0.4247676658006644, 'macro avg': {'precision': 0.42418221237171405, 'recall': 0.4252992845434373, 'f1-score': 0.4239394466369586, 'support': 77367}, 'weighted avg': {'precision': 0.4239977051066623, 'recall': 0.4247676658006644, 'f1-score': 0.42357666480719597, 'support': 77367}}
[[10617  7097  7558]
 [ 7917  9826  8705]
 [ 6139  7088 12420]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
5098/5098 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8621656
{'0': {'precision': 0.45589809432568124, 'recall': 0.6435214010096724, 'f1-score': 0.5337001601715513, 'support': 252161}, '1': {'precision': 0.8455782201625471, 'recall': 0.5137464090100299, 'f1-score': 0.639159719205601, 'support': 804792}, '2': {'precision': 0.3962865863202379, 'recall': 0.7351849910065414, 'f1-score': 0.5149823579098431, 'support': 247958}, 'accuracy': 0.5809016860153681, 'macro avg': {'precision': 0.5659209669361555, 'recall': 0.6308176003420812, 'f1-score': 0.5626140790956652, 'support': 1304911}, 'weighted avg': {'precision': 0.6849024459868208, 'recall': 0.5809016860153681, 'f1-score': 0.5951846450298461, 'support': 1304911}}
[[162271  41590  48300]
 [161920 413459 229413]
 [ 31746  33917 182295]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76831204
{'0': {'precision': 0.45237090752784037, 'recall': 0.6211811514204204, 'f1-score': 0.523503781423584, 'support': 91487}, '1': {'precision': 0.8304360094743772, 'recall': 0.6582752952739227, 'f1-score': 0.734400964914105, 'support': 295065}, '2': {'precision': 0.4795253799115059, 'recall': 0.6179274998665314, 'f1-score': 0.5399993468351832, 'support': 93655}, 'accuracy': 0.6433392266251845, 'macro avg': {'precision': 0.5874440989712412, 'recall': 0.6324613155202915, 'f1-score': 0.5993013643909574, 'support': 480207}, 'weighted avg': {'precision': 0.6899703832059273, 'recall': 0.6433392266251845, 'f1-score': 0.6563074882109775, 'support': 480207}}
[[ 56830  17551  17106]
 [ 55123 194234  45708]
 [ 13674  22109  57872]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.751915
{'0': {'precision': 0.4179614929910488, 'recall': 0.7093260721579305, 'f1-score': 0.5259899839264602, 'support': 27911}, '1': {'precision': 0.8198841907136777, 'recall': 0.6722532954556625, 'f1-score': 0.738765501447522, 'support': 101731}, '2': {'precision': 0.5198434272045233, 'recall': 0.49923424991298293, 'f1-score': 0.5093304451270396, 'support': 28730}, 'accuracy': 0.647399792892683, 'macro avg': {'precision': 0.5858963703030833, 'recall': 0.6269378725088587, 'f1-score': 0.591361976833674, 'support': 158372}, 'weighted avg': {'precision': 0.694620662111688, 'recall': 0.647399792892683, 'f1-score': 0.6596451604932004, 'support': 158372}}
[[19798  5215  2898]
 [22992 68389 10350]
 [ 4578  9809 14343]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
5760/5760 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7692776
{'0': {'precision': 0.558643101885104, 'recall': 0.37443916991227966, 'f1-score': 0.4483588761024105, 'support': 253419}, '1': {'precision': 0.7842169483551971, 'recall': 0.8237682555958433, 'f1-score': 0.8035061839722326, 'support': 971346}, '2': {'precision': 0.4437452071563751, 'recall': 0.5051820941427119, 'f1-score': 0.47247483070653806, 'support': 249706}, 'accuracy': 0.6925880536138046, 'macro avg': {'precision': 0.595535085798892, 'recall': 0.5677965065502782, 'f1-score': 0.5747799635937271, 'support': 1474471}, 'weighted avg': {'precision': 0.6877874253558315, 'recall': 0.6925880536138046, 'f1-score': 0.6864054809325486, 'support': 1474471}}
[[ 94890 124175  34354]
 [ 47405 800164 123777]
 [ 27563  95996 126147]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8581773
{'0': {'precision': 0.4924830601576382, 'recall': 0.5199028597225898, 'f1-score': 0.5058216364194, 'support': 128474}, '1': {'precision': 0.6937347558898472, 'recall': 0.691964513246372, 'f1-score': 0.6928485038180664, 'support': 294307}, '2': {'precision': 0.47939297642595413, 'recall': 0.4557406865087316, 'f1-score': 0.4672677133623584, 'support': 129758}, 'accuracy': 0.5964827822108485, 'macro avg': {'precision': 0.5552035974911466, 'recall': 0.5558693531592311, 'f1-score': 0.5553126178666082, 'support': 552539}, 'weighted avg': {'precision': 0.5966046510878773, 'recall': 0.5964827822108485, 'f1-score': 0.5963865310521114, 'support': 552539}}
[[ 66794  42402  19278]
 [ 45715 203650  44942]
 [ 23118  47504  59136]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8066246
{'0': {'precision': 0.5358115131416127, 'recall': 0.45815257644693685, 'f1-score': 0.49394827802557584, 'support': 47255}, '1': {'precision': 0.7310054006066435, 'recall': 0.7234470079073249, 'f1-score': 0.7272065648037224, 'support': 122924}, '2': {'precision': 0.47758926310458344, 'recall': 0.5598100326506382, 'f1-score': 0.5154413774255262, 'support': 47166}, 'accuracy': 0.6302560445374865, 'macro avg': {'precision': 0.5814687256176132, 'recall': 0.5804698723349667, 'f1-score': 0.5788654067516081, 'support': 217345}, 'weighted avg': {'precision': 0.6335726890486035, 'recall': 0.6302560445374865, 'f1-score': 0.6305365831175492, 'support': 217345}}
[[21650 17845  7760]
 [12873 88929 21122]
 [ 5883 14879 26404]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
6315/6315 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83918536
{'0': {'precision': 0.5188524142617073, 'recall': 0.47256442063560034, 'f1-score': 0.4946278536138908, 'support': 361957}, '1': {'precision': 0.7489568439220331, 'recall': 0.6466674889551703, 'f1-score': 0.6940636246952925, 'support': 891820}, '2': {'precision': 0.44938723616709597, 'recall': 0.6403264720885666, 'f1-score': 0.5281287027161021, 'support': 362665}, 'accuracy': 0.6062593028391987, 'macro avg': {'precision': 0.5723988314502787, 'recall': 0.5865194605597791, 'f1-score': 0.5722733936750951, 'support': 1616442}, 'weighted avg': {'precision': 0.6302199385192986, 'recall': 0.6062593028391987, 'f1-score': 0.6121763921976873, 'support': 1616442}}
[[171048 110189  80720]
 [111296 576711 203813]
 [ 47322  83119 232224]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8563267
{'0': {'precision': 0.4822457981821312, 'recall': 0.5874920442052884, 'f1-score': 0.5296915908876013, 'support': 138264}, '1': {'precision': 0.6854621322605922, 'recall': 0.6756639898890979, 'f1-score': 0.6805277948374371, 'support': 270599}, '2': {'precision': 0.5501886208763351, 'recall': 0.44874472588626135, 'f1-score': 0.4943157472138475, 'support': 142678}, 'accuracy': 0.5948587684324466, 'macro avg': {'precision': 0.5726321837730195, 'recall': 0.5706335866602159, 'f1-score': 0.5681783776462953, 'support': 551541}, 'weighted avg': {'precision': 0.5995246275740733, 'recall': 0.5948587684324466, 'f1-score': 0.5945440158731197, 'support': 551541}}
[[ 81229  36931  20104]
 [ 55524 182834  32241]
 [ 31686  46966  64026]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8144663
{'0': {'precision': 0.5371168770087011, 'recall': 0.4787590832867524, 'f1-score': 0.5062617754627065, 'support': 42936}, '1': {'precision': 0.7185065453759479, 'recall': 0.7323397285466614, 'f1-score': 0.7253571902927727, 'support': 104401}, '2': {'precision': 0.4930977600277826, 'recall': 0.5232512610267868, 'f1-score': 0.507727206695795, 'support': 43417}, 'accuracy': 0.627672289965086, 'macro avg': {'precision': 0.5829070608041439, 'recall': 0.5781166909534002, 'f1-score': 0.5797820574837581, 'support': 190754}, 'weighted avg': {'precision': 0.6263736410359215, 'recall': 0.627672289965086, 'f1-score': 0.62650777309065, 'support': 190754}}
[[20556 15247  7133]
 [11723 76457 16221]
 [ 5992 14707 22718]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93231124
{'0': {'precision': 0.4523708156650375, 'recall': 0.5810231147425444, 'f1-score': 0.5086886860902295, 'support': 411469}, '1': {'precision': 0.6421858831686784, 'recall': 0.6565474958434289, 'f1-score': 0.6492872829388734, 'support': 739191}, '2': {'precision': 0.5331721650959489, 'recall': 0.35785091002206115, 'f1-score': 0.42826308275517616, 'support': 406144}, 'accuracy': 0.5586612059064596, 'macro avg': {'precision': 0.5425762879765549, 'recall': 0.5318071735360115, 'f1-score': 0.5287463505947597, 'support': 1556804}, 'weighted avg': {'precision': 0.5635772185432109, 'recall': 0.5586612059064596, 'f1-score': 0.5544650594565839, 'support': 1556804}}
[[239073 116316  56080]
 [182703 485314  71174]
 [106713 154092 145339]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0093517
{'0': {'precision': 0.5063820965102988, 'recall': 0.4479499177191348, 'f1-score': 0.4753771540387569, 'support': 201748}, '1': {'precision': 0.5140435318501381, 'recall': 0.6745275560314254, 'f1-score': 0.5834510544096069, 'support': 221349}, '2': {'precision': 0.5168663476054347, 'recall': 0.3993151024864758, 'f1-score': 0.45054948131763517, 'support': 201490}, 'accuracy': 0.5125578982591696, 'macro avg': {'precision': 0.5124306586552906, 'recall': 0.5072641920790121, 'f1-score': 0.5031258965886664, 'support': 624587}, 'weighted avg': {'precision': 0.5124794421229948, 'recall': 0.5125578982591696, 'f1-score': 0.5056684056924232, 'support': 624587}}
[[ 90373  68060  43315]
 [ 40151 149306  31892]
 [ 47944  73088  80458]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95997465
{'0': {'precision': 0.5199313042648602, 'recall': 0.45413937363534845, 'f1-score': 0.48481343748331884, 'support': 59997}, '1': {'precision': 0.6066424184604376, 'recall': 0.6582131073300123, 'f1-score': 0.6313764428447313, 'support': 92742}, '2': {'precision': 0.4600818395055387, 'recall': 0.4577931480945161, 'f1-score': 0.4589346404112513, 'support': 58699}, 'accuracy': 0.5446655757243258, 'macro avg': {'precision': 0.5288851874102788, 'recall': 0.5233818763532923, 'f1-score': 0.5250415069131005, 'support': 211438}, 'weighted avg': {'precision': 0.5413496794898379, 'recall': 0.5446655757243258, 'f1-score': 0.5419152201992677, 'support': 211438}}
[[27247 19143 13607]
 [13770 61044 17928]
 [11388 20439 26872]]
testing model on single stock: results/universal/W3/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
13689/13689 - 183s - 183s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1775316
{'0': {'precision': 0.45737469120274515, 'recall': 0.4064954761951558, 'f1-score': 0.4304367714423842, 'support': 1221096}, '1': {'precision': 0.31708560023731974, 'recall': 0.4089038825483825, 'f1-score': 0.35718846102209084, 'support': 1037772}, '2': {'precision': 0.46751388904310875, 'recall': 0.4056969048754675, 'f1-score': 0.43441730013421687, 'support': 1245378}, 'accuracy': 0.4069249133765152, 'macro avg': {'precision': 0.41399139349439124, 'recall': 0.407032087873002, 'f1-score': 0.4073475108662306, 'support': 3504246}, 'weighted avg': {'precision': 0.41943187651983327, 'recall': 0.4069249133765152, 'f1-score': 0.4101591474569929, 'support': 3504246}}
[[496370 453327 271399]
 [309360 424349 304063]
 [279529 460603 505246]]
Evaluating performance on  train set...
5475/5475 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1989369
{'0': {'precision': 0.4017660556222466, 'recall': 0.447776178698541, 'f1-score': 0.4235251923905745, 'support': 464156}, '1': {'precision': 0.34491737452331456, 'recall': 0.3868315597406687, 'f1-score': 0.3646740561438966, 'support': 463654}, '2': {'precision': 0.4270434691894207, 'recall': 0.32834201572117294, 'f1-score': 0.37124439448505636, 'support': 473756}, 'accuracy': 0.3872439828020942, 'macro avg': {'precision': 0.3912422997783273, 'recall': 0.3876499180534609, 'f1-score': 0.38648121433984245, 'support': 1401566}, 'weighted avg': {'precision': 0.3915041114510024, 'recall': 0.3872439828020942, 'f1-score': 0.38638466071540273, 'support': 1401566}}
[[207838 157104  99214]
 [174808 179356 109490]
 [134665 183537 155554]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1923857
{'0': {'precision': 0.4263237346909128, 'recall': 0.3806923935972205, 'f1-score': 0.40221799123410773, 'support': 177298}, '1': {'precision': 0.32869537842182334, 'recall': 0.42618327550698554, 'f1-score': 0.3711443482756949, 'support': 161691}, '2': {'precision': 0.445467477552725, 'recall': 0.37462615309476643, 'f1-score': 0.4069871078321783, 'support': 182227}, 'accuracy': 0.3926836474705305, 'macro avg': {'precision': 0.40016219688848703, 'recall': 0.3938339407329908, 'f1-score': 0.3934498157806603, 'support': 521216}, 'weighted avg': {'precision': 0.4027305991712321, 'recall': 0.3926836474705305, 'f1-score': 0.3942457367498399, 'support': 521216}}
[[67496 65915 43887]
 [51687 68910 41094]
 [39138 74822 68267]]
training model: results/universal/W3/deepOF_L2/h10
Epoch 1/50
10532/10532 - 235s - loss: 2.6755 - accuracy10: 0.5688 - val_loss: 2.7078 - val_accuracy10: 0.5723 - 235s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 230s - loss: 2.5913 - accuracy10: 0.5838 - val_loss: 2.6388 - val_accuracy10: 0.5710 - 230s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 230s - loss: 2.5668 - accuracy10: 0.5880 - val_loss: 2.6347 - val_accuracy10: 0.5708 - 230s/epoch - 22ms/step
Epoch 4/50
10532/10532 - 230s - loss: 2.5527 - accuracy10: 0.5903 - val_loss: 2.6137 - val_accuracy10: 0.5760 - 230s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 233s - loss: 2.5432 - accuracy10: 0.5918 - val_loss: 2.6031 - val_accuracy10: 0.5790 - 233s/epoch - 22ms/step
Epoch 6/50
10532/10532 - 232s - loss: 2.5352 - accuracy10: 0.5932 - val_loss: 2.5886 - val_accuracy10: 0.5824 - 232s/epoch - 22ms/step
Epoch 7/50
10532/10532 - 233s - loss: 2.5292 - accuracy10: 0.5942 - val_loss: 2.5742 - val_accuracy10: 0.5831 - 233s/epoch - 22ms/step
Epoch 8/50
10532/10532 - 232s - loss: 2.5238 - accuracy10: 0.5951 - val_loss: 2.5689 - val_accuracy10: 0.5847 - 232s/epoch - 22ms/step
Epoch 9/50
10532/10532 - 233s - loss: 2.5191 - accuracy10: 0.5959 - val_loss: 2.5671 - val_accuracy10: 0.5860 - 233s/epoch - 22ms/step
Epoch 10/50
10532/10532 - 232s - loss: 2.5148 - accuracy10: 0.5965 - val_loss: 2.5580 - val_accuracy10: 0.5877 - 232s/epoch - 22ms/step
Epoch 11/50
10532/10532 - 234s - loss: 2.5109 - accuracy10: 0.5972 - val_loss: 2.5589 - val_accuracy10: 0.5858 - 234s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 230s - loss: 2.5076 - accuracy10: 0.5976 - val_loss: 2.5535 - val_accuracy10: 0.5854 - 230s/epoch - 22ms/step
Epoch 13/50
10532/10532 - 229s - loss: 2.5044 - accuracy10: 0.5983 - val_loss: 2.5455 - val_accuracy10: 0.5873 - 229s/epoch - 22ms/step
Epoch 14/50
10532/10532 - 230s - loss: 2.5010 - accuracy10: 0.5987 - val_loss: 2.5415 - val_accuracy10: 0.5872 - 230s/epoch - 22ms/step
Epoch 15/50
10532/10532 - 228s - loss: 2.4986 - accuracy10: 0.5992 - val_loss: 2.5428 - val_accuracy10: 0.5874 - 228s/epoch - 22ms/step
Epoch 16/50
10532/10532 - 231s - loss: 2.4963 - accuracy10: 0.5992 - val_loss: 2.5424 - val_accuracy10: 0.5863 - 231s/epoch - 22ms/step
Epoch 17/50
10532/10532 - 230s - loss: 2.4941 - accuracy10: 0.5996 - val_loss: 2.5420 - val_accuracy10: 0.5868 - 230s/epoch - 22ms/step
Epoch 18/50
10532/10532 - 228s - loss: 2.4911 - accuracy10: 0.6000 - val_loss: 2.5392 - val_accuracy10: 0.5876 - 228s/epoch - 22ms/step
Epoch 19/50
10532/10532 - 228s - loss: 2.4893 - accuracy10: 0.6004 - val_loss: 2.5318 - val_accuracy10: 0.5883 - 228s/epoch - 22ms/step
Epoch 20/50
10532/10532 - 230s - loss: 2.4868 - accuracy10: 0.6010 - val_loss: 2.5314 - val_accuracy10: 0.5893 - 230s/epoch - 22ms/step
Epoch 21/50
10532/10532 - 231s - loss: 2.4850 - accuracy10: 0.6011 - val_loss: 2.5329 - val_accuracy10: 0.5888 - 231s/epoch - 22ms/step
Epoch 22/50
10532/10532 - 229s - loss: 2.4836 - accuracy10: 0.6013 - val_loss: 2.5377 - val_accuracy10: 0.5878 - 229s/epoch - 22ms/step
Epoch 23/50
10532/10532 - 232s - loss: 2.4816 - accuracy10: 0.6018 - val_loss: 2.5341 - val_accuracy10: 0.5896 - 232s/epoch - 22ms/step
Epoch 24/50
10532/10532 - 230s - loss: 2.4797 - accuracy10: 0.6021 - val_loss: 2.5379 - val_accuracy10: 0.5883 - 230s/epoch - 22ms/step
Epoch 25/50
10532/10532 - 230s - loss: 2.4785 - accuracy10: 0.6021 - val_loss: 2.5375 - val_accuracy10: 0.5882 - 230s/epoch - 22ms/step
Epoch 26/50
10532/10532 - 229s - loss: 2.4770 - accuracy10: 0.6023 - val_loss: 2.5357 - val_accuracy10: 0.5878 - 229s/epoch - 22ms/step
Epoch 27/50
10532/10532 - 230s - loss: 2.4755 - accuracy10: 0.6026 - val_loss: 2.5376 - val_accuracy10: 0.5889 - 230s/epoch - 22ms/step
Epoch 28/50
10532/10532 - 230s - loss: 2.4741 - accuracy10: 0.6029 - val_loss: 2.5338 - val_accuracy10: 0.5892 - 230s/epoch - 22ms/step
Epoch 29/50
10532/10532 - 231s - loss: 2.4726 - accuracy10: 0.6032 - val_loss: 2.5394 - val_accuracy10: 0.5885 - 231s/epoch - 22ms/step
Epoch 30/50
10532/10532 - 232s - loss: 2.4720 - accuracy10: 0.6032 - val_loss: 2.5444 - val_accuracy10: 0.5870 - 232s/epoch - 22ms/step
testing model in sample: results/universal/W3/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 208s - 208s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83478427
{'0': {'precision': 0.44206034272033407, 'recall': 0.6092918835350091, 'f1-score': 0.5123759138486631, 'support': 1587945}, '1': {'precision': 0.8209071252292831, 'recall': 0.6041244054325822, 'f1-score': 0.6960267450561926, 'support': 3894428}, '2': {'precision': 0.4526996598570819, 'recall': 0.5734063802145025, 'f1-score': 0.5059533092016039, 'support': 1604084}, 'accuracy': 0.5983290380510317, 'macro avg': {'precision': 0.571889042602233, 'recall': 0.5956075563940312, 'f1-score': 0.5714519893688198, 'support': 7086457}, 'weighted avg': {'precision': 0.6526674029060862, 'recall': 0.5983290380510317, 'f1-score': 0.6118491120808972, 'support': 7086457}}
[[ 967522  249613  370810]
 [ 800518 2352719  741191]
 [ 420625  263667  919792]]
Evaluating performance on  train set...
10532/10532 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8789682
{'0': {'precision': 0.44431678953596804, 'recall': 0.6337448743756058, 'f1-score': 0.5223884632828218, 'support': 670650}, '1': {'precision': 0.8118376953228369, 'recall': 0.5597557015871503, 'f1-score': 0.6626319137203494, 'support': 1342784}, '2': {'precision': 0.46390916065070714, 'recall': 0.5529852616399631, 'f1-score': 0.5045458465623853, 'support': 682369}, 'accuracy': 0.5764486499940834, 'macro avg': {'precision': 0.5733545485031707, 'recall': 0.582161945867573, 'f1-score': 0.5631887411885188, 'support': 2695803}, 'weighted avg': {'precision': 0.6323388440560158, 'recall': 0.5764486499940834, 'f1-score': 0.5877275896297386, 'support': 2695803}}
[[425021  79603 166026]
 [321127 751631 270026]
 [210424  94605 377340]]
Evaluating performance on  val set...
3814/3814 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8552536
{'0': {'precision': 0.43892700190445816, 'recall': 0.634350221387004, 'f1-score': 0.518847199564981, 'support': 225623}, '1': {'precision': 0.8186555001401258, 'recall': 0.581214709728766, 'f1-score': 0.6797981920429101, 'support': 517671}, '2': {'precision': 0.4640151649363994, 'recall': 0.5631676270749119, 'f1-score': 0.5088058744682091, 'support': 232540}, 'accuracy': 0.5891995974725209, 'macro avg': {'precision': 0.5738658889936611, 'recall': 0.5929108527302273, 'f1-score': 0.5691504220253668, 'support': 975834}, 'weighted avg': {'precision': 0.6463479698576181, 'recall': 0.5891995974725209, 'f1-score': 0.6018373920455041, 'support': 975834}}
[[143124  29731  52768]
 [118290 300878  98503]
 [ 64663  36918 130959]]
testing model out of sample: results/universal/W3/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 124s - 124s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73668694
{'0': {'precision': 0.4621587926284238, 'recall': 0.5217569113945607, 'f1-score': 0.490152851976459, 'support': 775133}, '1': {'precision': 0.8100012859801474, 'recall': 0.7745297789581184, 'f1-score': 0.7918684977128396, 'support': 2586071}, '2': {'precision': 0.4729382521907854, 'recall': 0.4810464901791576, 'f1-score': 0.4769579138606789, 'support': 775239}, 'accuracy': 0.6721586638568451, 'macro avg': {'precision': 0.5816994435997855, 'recall': 0.5924443935106122, 'f1-score': 0.5863264211833258, 'support': 4136443}, 'weighted avg': {'precision': 0.6816473827229207, 'recall': 0.6721586638568451, 'f1-score': 0.6763101013463133, 'support': 4136443}}
[[ 404431  234837  135865]
 [ 303343 2002989  279739]
 [ 167317  234996  372926]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8274507
{'0': {'precision': 0.46414416097877614, 'recall': 0.5308532267725525, 'f1-score': 0.495262457120744, 'support': 355603}, '1': {'precision': 0.7526593964530022, 'recall': 0.7125565265480354, 'f1-score': 0.7320591549562516, 'support': 867955}, '2': {'precision': 0.4760158253103085, 'recall': 0.469553711256459, 'f1-score': 0.47276268692583673, 'support': 358221}, 'accuracy': 0.6166752751174469, 'macro avg': {'precision': 0.5642731275806957, 'recall': 0.5709878215256823, 'f1-score': 0.5666947663342775, 'support': 1581779}, 'weighted avg': {'precision': 0.6251470069354728, 'recall': 0.6166752751174469, 'f1-score': 0.6201022657734244, 'support': 1581779}}
[[188773  98034  68796]
 [133130 618467 116358]
 [ 84809 105208 168204]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75306076
{'0': {'precision': 0.4760789049919485, 'recall': 0.5226688117105251, 'f1-score': 0.49828718782786763, 'support': 113129}, '1': {'precision': 0.7835355509717555, 'recall': 0.7691913177782755, 'f1-score': 0.7762971777042352, 'support': 339268}, '2': {'precision': 0.4825112357982302, 'recall': 0.4616350185615469, 'f1-score': 0.4718423279556684, 'support': 112329}, 'accuracy': 0.6586309112737859, 'macro avg': {'precision': 0.5807085639206447, 'recall': 0.5844983826834492, 'f1-score': 0.5821422311625905, 'support': 564726}, 'weighted avg': {'precision': 0.6620677538415073, 'recall': 0.6586309112737859, 'f1-score': 0.660045932034423, 'support': 564726}}
[[ 59129  35209  18791]
 [ 41483 260962  36823]
 [ 23588  36886  51855]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1631815
{'0': {'precision': 0.3632161684515807, 'recall': 0.49360566560607616, 'f1-score': 0.41848970570319705, 'support': 48715}, '1': {'precision': 0.545955303745672, 'recall': 0.13840384078305162, 'f1-score': 0.22082648135377436, 'support': 75193}, '2': {'precision': 0.342838986416713, 'recall': 0.6105901374292644, 'f1-score': 0.43911833317587556, 'support': 49480}, 'accuracy': 0.3729496850993148, 'macro avg': {'precision': 0.41733681953798857, 'recall': 0.4141998812727974, 'f1-score': 0.35947817341094906, 'support': 173388}, 'weighted avg': {'precision': 0.4366493981623067, 'recall': 0.3729496850993148, 'f1-score': 0.3386561166361451, 'support': 173388}}
[[24046  4992 19677]
 [26552 10407 38234]
 [15605  3663 30212]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1544151
{'0': {'precision': 0.3796633941093969, 'recall': 0.4278939880921018, 'f1-score': 0.4023384280016844, 'support': 18979}, '1': {'precision': 0.573103181759629, 'recall': 0.1541473217379253, 'f1-score': 0.24294880546075084, 'support': 28862}, '2': {'precision': 0.3165384408457524, 'recall': 0.6365357567889214, 'f1-score': 0.42281710384477184, 'support': 18486}, 'accuracy': 0.36692448022675533, 'macro avg': {'precision': 0.42310167223825945, 'recall': 0.40619235553964944, 'f1-score': 0.35603477910240233, 'support': 66327}, 'weighted avg': {'precision': 0.44624459430131375, 'recall': 0.36692448022675533, 'f1-score': 0.33868811238148283, 'support': 66327}}
[[ 8121  1792  9066]
 [ 8072  4449 16341]
 [ 5197  1522 11767]]
Evaluating performance on  val set...
86/86 - 1s - 963ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1442497
{'0': {'precision': 0.3968562874251497, 'recall': 0.41202984146720545, 'f1-score': 0.40430074729296933, 'support': 6434}, '1': {'precision': 0.5445884146341463, 'recall': 0.1531782613356201, 'f1-score': 0.23910315401991133, 'support': 9329}, '2': {'precision': 0.32145684877276326, 'recall': 0.6579160589855777, 'f1-score': 0.431891920642519, 'support': 6171}, 'accuracy': 0.3711133400200602, 'macro avg': {'precision': 0.42096718361068647, 'recall': 0.40770805392946774, 'f1-score': 0.35843194065179995, 'support': 21934}, 'weighted avg': {'precision': 0.43847674328403785, 'recall': 0.3711133400200602, 'f1-score': 0.34180128449984964, 'support': 21934}}
[[2651  653 3130]
 [2460 1429 5440]
 [1569  542 4060]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54648113
{'0': {'precision': 0.4178160547389324, 'recall': 0.566491074041557, 'f1-score': 0.48092522888483086, 'support': 34170}, '1': {'precision': 0.9149934737560557, 'recall': 0.8612439399157549, 'f1-score': 0.8873054674666033, 'support': 301976}, '2': {'precision': 0.37973800480582903, 'recall': 0.4437098088941219, 'f1-score': 0.40923899423607046, 'support': 33123}, 'accuracy': 0.7965169023124063, 'macro avg': {'precision': 0.570849177766939, 'recall': 0.623814940950478, 'f1-score': 0.5924898968625015, 'support': 369269}, 'weighted avg': {'precision': 0.8209757812179507, 'recall': 0.7965169023124063, 'f1-score': 0.8068194029847376, 'support': 369269}}
[[ 19357  11250   3563]
 [ 21458 260075  20443]
 [  5514  12912  14697]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74244124
{'0': {'precision': 0.4420742920191247, 'recall': 0.519054302061967, 'f1-score': 0.47748150355032526, 'support': 27789}, '1': {'precision': 0.8267051656049691, 'recall': 0.7611221749218936, 'f1-score': 0.7925592633461437, 'support': 109466}, '2': {'precision': 0.42254761283589876, 'recall': 0.4831276333942354, 'f1-score': 0.45081154428265746, 'support': 26819}, 'accuracy': 0.6746833745748869, 'macro avg': {'precision': 0.5637756901533308, 'recall': 0.5877680367926986, 'f1-score': 0.5736174370597088, 'support': 164074}, 'weighted avg': {'precision': 0.69549846159464, 'recall': 0.6746833745748869, 'f1-score': 0.6833339872845517, 'support': 164074}}
[[14424  8955  4410]
 [12852 83317 13297]
 [ 5352  8510 12957]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6813001
{'0': {'precision': 0.4206896551724138, 'recall': 0.5340527333808409, 'f1-score': 0.4706410083882833, 'support': 9823}, '1': {'precision': 0.8498854006770823, 'recall': 0.8011178942361056, 'f1-score': 0.8247813976267485, 'support': 50452}, '2': {'precision': 0.42922238732045565, 'recall': 0.4400324972072712, 'f1-score': 0.4345602246514893, 'support': 9847}, 'accuracy': 0.713000199652035, 'macro avg': {'precision': 0.5665991477233173, 'recall': 0.591734374941406, 'f1-score': 0.5766608768888404, 'support': 70122}, 'weighted avg': {'precision': 0.7306894493263641, 'recall': 0.713000199652035, 'f1-score': 0.7203743793760308, 'support': 70122}}
[[ 5246  3427  1150]
 [ 5422 40418  4612]
 [ 1802  3712  4333]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
1359/1359 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0013382
{'0': {'precision': 0.4796976731462158, 'recall': 0.5577183464645639, 'f1-score': 0.5157741696920802, 'support': 110043}, '1': {'precision': 0.5638335112806959, 'recall': 0.49249338776009416, 'f1-score': 0.5257544352140491, 'support': 130818}, '2': {'precision': 0.49317170186570697, 'recall': 0.48696416548215754, 'f1-score': 0.490048276446176, 'support': 106936}, 'accuracy': 0.5114305183770993, 'macro avg': {'precision': 0.5122342954308728, 'recall': 0.5123919665689385, 'f1-score': 0.5105256271174351, 'support': 347797}, 'weighted avg': {'precision': 0.5154867708331538, 'recall': 0.5114305183770993, 'f1-score': 0.5116182231339125, 'support': 347797}}
[[61373 25605 23065]
 [35940 64427 30451]
 [30628 24234 52074]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0342063
{'0': {'precision': 0.45800103573278095, 'recall': 0.5886268036845749, 'f1-score': 0.5151624590794179, 'support': 37562}, '1': {'precision': 0.5610949428487072, 'recall': 0.34756368386675374, 'f1-score': 0.4292398038203407, 'support': 38275}, '2': {'precision': 0.4703153542928565, 'recall': 0.5183173955656803, 'f1-score': 0.493151030180833, 'support': 37751}, 'accuracy': 0.48403000316934885, 'macro avg': {'precision': 0.4964704442914482, 'recall': 0.48483596103900295, 'f1-score': 0.47918443102686387, 'support': 113588}, 'weighted avg': {'precision': 0.49683257722328605, 'recall': 0.48403000316934885, 'f1-score': 0.478894164168057, 'support': 113588}}
[[22110  4950 10502]
 [13437 13303 11535]
 [12728  5456 19567]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0191997
{'0': {'precision': 0.4668472836161415, 'recall': 0.5578463111262566, 'f1-score': 0.5083061636391865, 'support': 11738}, '1': {'precision': 0.5806089088680016, 'recall': 0.4299440157361174, 'f1-score': 0.49404503173085274, 'support': 13218}, '2': {'precision': 0.4682725288431556, 'recall': 0.5140338867020366, 'f1-score': 0.49008729705474424, 'support': 11686}, 'accuracy': 0.4977348398013209, 'macro avg': {'precision': 0.5052429071090997, 'recall': 0.5006080711881369, 'f1-score': 0.49747949747492787, 'support': 36642}, 'weighted avg': {'precision': 0.508339466856739, 'recall': 0.4977348398013209, 'f1-score': 0.49735126716873873, 'support': 36642}}
[[6548 2036 3154]
 [3868 5683 3667]
 [3610 2069 6007]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2219682
{'0': {'precision': 0.4172586040969708, 'recall': 0.4411850215141295, 'f1-score': 0.42888837597094576, 'support': 103188}, '1': {'precision': 0.5472589792060492, 'recall': 0.018508257858284496, 'f1-score': 0.03580557387862797, 'support': 93850}, '2': {'precision': 0.3424733161575267, 'recall': 0.649440055835792, 'f1-score': 0.4484582945396791, 'support': 94563}, 'accuracy': 0.3726839071196601, 'macro avg': {'precision': 0.43566363315351553, 'recall': 0.3697111117360687, 'f1-score': 0.30438408146308427, 'support': 291601}, 'weighted avg': {'precision': 0.43484638335893955, 'recall': 0.3726839071196601, 'f1-score': 0.30872338762471613, 'support': 291601}}
[[45525   881 56782]
 [30986  1737 61127]
 [32594   556 61413]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1801924
{'0': {'precision': 0.4079237767131399, 'recall': 0.45716698841698844, 'f1-score': 0.43114385685432255, 'support': 33152}, '1': {'precision': 0.5774003919007185, 'recall': 0.0544754275150208, 'f1-score': 0.0995579581608807, 'support': 32455}, '2': {'precision': 0.3495756159582145, 'recall': 0.6200969187162841, 'f1-score': 0.4471009635986068, 'support': 32811}, 'accuracy': 0.37869088987786786, 'macro avg': {'precision': 0.44496659485735757, 'recall': 0.37724644488276443, 'f1-score': 0.32593425953793664, 'support': 98418}, 'weighted avg': {'precision': 0.4443592056324738, 'recall': 0.37869088987786786, 'f1-score': 0.327117645056593, 'support': 98418}}
[[15156   703 17293]
 [10124  1768 20563]
 [11874   591 20346]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1998603
{'0': {'precision': 0.4222043912758042, 'recall': 0.4584917617237009, 'f1-score': 0.439600501272168, 'support': 12624}, '1': {'precision': 0.586248492159228, 'recall': 0.04266151685393258, 'f1-score': 0.07953522624989771, 'support': 11392}, '2': {'precision': 0.3309172946767148, 'recall': 0.6071334214002642, 'f1-score': 0.42835839443270785, 'support': 11355}, 'accuracy': 0.3722823782194453, 'macro avg': {'precision': 0.4464567260372491, 'recall': 0.3694288999926325, 'f1-score': 0.3158313739849245, 'support': 35371}, 'weighted avg': {'precision': 0.4457328585337642, 'recall': 0.3722823782194453, 'f1-score': 0.320024641493938, 'support': 35371}}
[[5788  195 6641]
 [3608  486 7298]
 [4313  148 6894]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0211458
{'0': {'precision': 0.47173426158288134, 'recall': 0.5590661976335145, 'f1-score': 0.5117007419982731, 'support': 187620}, '1': {'precision': 0.5464770368119904, 'recall': 0.4167322293067415, 'f1-score': 0.47286628529491503, 'support': 207181}, '2': {'precision': 0.4951459647916718, 'recall': 0.5329774300967282, 'f1-score': 0.513365662428246, 'support': 189190}, 'accuracy': 0.500119008683353, 'macro avg': {'precision': 0.5044524210621812, 'recall': 0.5029252856789946, 'f1-score': 0.4993108965738114, 'support': 583991}, 'weighted avg': {'precision': 0.505835032048202, 'recall': 0.500119008683353, 'f1-score': 0.4984629090896977, 'support': 583991}}
[[104892  37484  45244]
 [ 63275  86339  57567]
 [ 54187  34169 100834]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0170858
{'0': {'precision': 0.48521960955676546, 'recall': 0.5523588013067854, 'f1-score': 0.5166169980006791, 'support': 74381}, '1': {'precision': 0.5394676939240063, 'recall': 0.4146679587606665, 'f1-score': 0.46890600267868016, 'support': 74298}, '2': {'precision': 0.48887388799151377, 'recall': 0.5331966027714233, 'f1-score': 0.5100742045025782, 'support': 76062}, 'accuracy': 0.5003537405279855, 'macro avg': {'precision': 0.5045203971574285, 'recall': 0.500074454279625, 'f1-score': 0.49853240172731245, 'support': 224741}, 'weighted avg': {'precision': 0.5043904591063407, 'recall': 0.5003537405279855, 'f1-score': 0.49862967263732116, 'support': 224741}}
[[41085 12760 20536]
 [21623 30809 21866]
 [21965 13541 40556]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0279515
{'0': {'precision': 0.4842105263157895, 'recall': 0.556607164250629, 'f1-score': 0.5178909820532829, 'support': 25041}, '1': {'precision': 0.5216237243146766, 'recall': 0.42338694699305374, 'f1-score': 0.467399327482982, 'support': 26921}, '2': {'precision': 0.49350940855186864, 'recall': 0.5192678606573509, 'f1-score': 0.5060610710449593, 'support': 25405}, 'accuracy': 0.49799009913787534, 'macro avg': {'precision': 0.4997812197274449, 'recall': 0.49975399063367787, 'f1-score': 0.49711712686040804, 'support': 77367}, 'weighted avg': {'precision': 0.5002824795585885, 'recall': 0.49799009913787534, 'f1-score': 0.49643707118878605, 'support': 77367}}
[[13938  5216  5887]
 [ 7871 11398  7652]
 [ 6976  5237 13192]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/EXC
Evaluating performance on  test set...
5098/5098 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50623447
{'0': {'precision': 0.4528240698164076, 'recall': 0.6104401161462921, 'f1-score': 0.5199497574016129, 'support': 153255}, '1': {'precision': 0.8856757118858921, 'recall': 0.8597436715730754, 'f1-score': 0.8725170530086243, 'support': 999577}, '2': {'precision': 0.5076251191424866, 'recall': 0.4272562880157817, 'f1-score': 0.46398617503293793, 'support': 152075}, 'accuracy': 0.7800617208735948, 'macro avg': {'precision': 0.6153749669482621, 'recall': 0.6324800252450498, 'f1-score': 0.6188176618143917, 'support': 1304907}, 'weighted avg': {'precision': 0.7907810394710669, 'recall': 0.7800617208735948, 'f1-score': 0.7834991887804417, 'support': 1304907}}
[[ 93553  48910  10792]
 [ 87966 859380  52231]
 [ 25080  62020  64975]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5213296
{'0': {'precision': 0.4506348020911128, 'recall': 0.5866951879220733, 'f1-score': 0.5097418804862877, 'support': 56566}, '1': {'precision': 0.8850580882851524, 'recall': 0.8558576034096498, 'f1-score': 0.8702129550921991, 'support': 366020}, '2': {'precision': 0.49424129542344536, 'recall': 0.45132681927836305, 'f1-score': 0.47181022361318997, 'support': 57619}, 'accuracy': 0.7756124988286253, 'macro avg': {'precision': 0.6099780619332369, 'recall': 0.6312932035366954, 'f1-score': 0.617255019730559, 'support': 480205}, 'weighted avg': {'precision': 0.7869915117298256, 'recall': 0.7756124988286253, 'f1-score': 0.7799473939438416, 'support': 480205}}
[[ 33187  18053   5326]
 [ 31474 313261  21285]
 [  8984  22630  26005]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47209468
{'0': {'precision': 0.4405338736675183, 'recall': 0.6078896182834914, 'f1-score': 0.5108545742452878, 'support': 16452}, '1': {'precision': 0.8944981120972882, 'recall': 0.8748990799286964, 'f1-score': 0.8845900499884828, 'support': 125099}, '2': {'precision': 0.5087890625, 'recall': 0.40265144759526783, 'f1-score': 0.4495403710218034, 'support': 16821}, 'accuracy': 0.7970032581516935, 'macro avg': {'precision': 0.6146070160882688, 'recall': 0.6284800486024852, 'f1-score': 0.6149949984185247, 'support': 158372}, 'weighted avg': {'precision': 0.8063724865200236, 'recall': 0.7970032581516935, 'f1-score': 0.7995581838958302, 'support': 158372}}
[[ 10001   5418   1033]
 [ 10144 109449   5506]
 [  2557   7491   6773]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/AAL
Evaluating performance on  test set...
5760/5760 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5202858
{'0': {'precision': 0.45162923339126915, 'recall': 0.5259909989583947, 'f1-score': 0.48598198721673447, 'support': 152649}, '1': {'precision': 0.8922350064695218, 'recall': 0.8780240778030076, 'f1-score': 0.8850725023234602, 'support': 1167050}, '2': {'precision': 0.4659497240625548, 'recall': 0.44624211723353663, 'f1-score': 0.4558830324433149, 'support': 154768}, 'accuracy': 0.7962565455856252, 'macro avg': {'precision': 0.6032713213077819, 'recall': 0.616752397998313, 'f1-score': 0.6089791739945032, 'support': 1474467}, 'weighted avg': {'precision': 0.8018746584643216, 'recall': 0.7962565455856252, 'f1-score': 0.7987053174933237, 'support': 1474467}}
[[  80292   58033   14324]
 [  77518 1024698   64834]
 [  19973   65731   69064]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63419765
{'0': {'precision': 0.4668566432434183, 'recall': 0.5317767695769245, 'f1-score': 0.4972065112429301, 'support': 81333}, '1': {'precision': 0.8322201140471306, 'recall': 0.8328539157013991, 'f1-score': 0.8325368942476351, 'support': 388666}, '2': {'precision': 0.5072674213694613, 'recall': 0.4359393741140552, 'f1-score': 0.4689063803169308, 'support': 82539}, 'accuracy': 0.7292439615012904, 'macro avg': {'precision': 0.6021147262200034, 'recall': 0.6001900197974596, 'f1-score': 0.5995499286024987, 'support': 552538}, 'weighted avg': {'precision': 0.7298970566794917, 'recall': 0.7292439615012904, 'f1-score': 0.7288569210507726, 'support': 552538}}
[[ 43251  31142   6940]
 [ 36953 323702  28011]
 [ 12439  34118  35982]]
Evaluating performance on  val set...
850/850 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5798331
{'0': {'precision': 0.4938511533069963, 'recall': 0.5174934900180277, 'f1-score': 0.5053959766554726, 'support': 29954}, '1': {'precision': 0.8502933706979595, 'recall': 0.8632420555287423, 'f1-score': 0.8567187884059068, 'support': 157468}, '2': {'precision': 0.5202943543750719, 'recall': 0.4536644053069545, 'f1-score': 0.48470025350805157, 'support': 29923}, 'accuracy': 0.7592031102624859, 'macro avg': {'precision': 0.6214796261266758, 'recall': 0.6114666502845748, 'f1-score': 0.6156050061898103, 'support': 217345}, 'weighted avg': {'precision': 0.7557366486884415, 'recall': 0.7592031102624859, 'f1-score': 0.7570825689257209, 'support': 217345}}
[[ 15501  11799   2654]
 [ 11673 135933   9862]
 [  4214  12134  13575]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/WBA
Evaluating performance on  test set...
6315/6315 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5919496
{'0': {'precision': 0.48741808882811527, 'recall': 0.48697488123699817, 'f1-score': 0.4871963842349448, 'support': 225449}, '1': {'precision': 0.8399920388663212, 'recall': 0.8652298364995235, 'f1-score': 0.8524241741776636, 'support': 1165807}, '2': {'precision': 0.5242645513763395, 'recall': 0.44319261752715583, 'f1-score': 0.4803317113552901, 'support': 225182}, 'accuracy': 0.7536806236923408, 'macro avg': {'precision': 0.6172248930235921, 'recall': 0.5984657784212258, 'f1-score': 0.6066507565892995, 'support': 1616438}, 'weighted avg': {'precision': 0.7468343727200585, 'recall': 0.7536806236923408, 'f1-score': 0.7496495765883568, 'support': 1616438}}
[[ 109788   97019   18642]
 [  85197 1008691   71919]
 [  30259   95124   99799]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66252935
{'0': {'precision': 0.4899883290201451, 'recall': 0.5420811533020456, 'f1-score': 0.5147200707885352, 'support': 89066}, '1': {'precision': 0.8148163143021401, 'recall': 0.816391820045324, 'f1-score': 0.8156033063209951, 'support': 369782}, '2': {'precision': 0.5262698614696578, 'recall': 0.4684496132394032, 'f1-score': 0.495679273067659, 'support': 92693}, 'accuracy': 0.7136187518244337, 'macro avg': {'precision': 0.610358168263981, 'recall': 0.6089741955289243, 'f1-score': 0.6086675500590631, 'support': 551541}, 'weighted avg': {'precision': 0.7138675803194853, 'recall': 0.7136187518244337, 'f1-score': 0.7132479335195432, 'support': 551541}}
[[ 48281  32263   8522]
 [ 37330 301887  30565]
 [ 12924  36347  43422]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5945926
{'0': {'precision': 0.486302780638517, 'recall': 0.5281682263897692, 'f1-score': 0.5063716466193633, 'support': 26821}, '1': {'precision': 0.8437208300423638, 'recall': 0.8571939218418307, 'f1-score': 0.8504040151835889, 'support': 137081}, '2': {'precision': 0.5240907260770367, 'recall': 0.4362965997541991, 'f1-score': 0.4761807983090806, 'support': 26851}, 'accuracy': 0.7516841150597894, 'macro avg': {'precision': 0.6180381122526392, 'recall': 0.6072195826619331, 'f1-score': 0.610985486704011, 'support': 190753}, 'weighted avg': {'precision': 0.7484735866195418, 'recall': 0.7516841150597894, 'f1-score': 0.7493541771545223, 'support': 190753}}
[[ 14166  10496   2159]
 [ 11097 117505   8479]
 [  3867  11269  11715]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
6082/6082 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7284661
{'0': {'precision': 0.47818632867357197, 'recall': 0.48589672082461083, 'f1-score': 0.48201069226678933, 'support': 276106}, '1': {'precision': 0.7910594238217924, 'recall': 0.8126033351593561, 'f1-score': 0.8016866669838076, 'support': 1005829}, '2': {'precision': 0.4977532713356925, 'recall': 0.440085132701508, 'f1-score': 0.4671461811019821, 'support': 274865}, 'accuracy': 0.6888893884892087, 'macro avg': {'precision': 0.5889996746103523, 'recall': 0.5795283962284917, 'f1-score': 0.5836145134508597, 'support': 1556800}, 'weighted avg': {'precision': 0.6837844145642857, 'recall': 0.6888893884892087, 'f1-score': 0.6859248958332905, 'support': 1556800}}
[[134159 108821  33126]
 [ 99559 817340  88930]
 [ 46840 107061 120964]]
Evaluating performance on  train set...
2440/2440 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8580228
{'0': {'precision': 0.46492716463682865, 'recall': 0.5161006780701509, 'f1-score': 0.48917923524005363, 'support': 143348}, '1': {'precision': 0.7148490317488873, 'recall': 0.7292114345249723, 'f1-score': 0.7219588100150037, 'support': 337854}, '2': {'precision': 0.49930059511492586, 'recall': 0.42071933213839857, 'f1-score': 0.45665404996214987, 'support': 143383}, 'accuracy': 0.6094814957131536, 'macro avg': {'precision': 0.5596922638335472, 'recall': 0.5553438149111739, 'f1-score': 0.5559306984057357, 'support': 624585}, 'weighted avg': {'precision': 0.6080072387236519, 'recall': 0.6094814957131536, 'f1-score': 0.6076290087941966, 'support': 624585}}
[[ 73982  47589  21777]
 [ 52771 246367  38716]
 [ 32373  50686  60324]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7435646
{'0': {'precision': 0.47323767356684204, 'recall': 0.5108603173014363, 'f1-score': 0.49132982755923515, 'support': 39962}, '1': {'precision': 0.7672345625763785, 'recall': 0.8065320557385969, 'f1-score': 0.7863926732045888, 'support': 132332}, '2': {'precision': 0.5155709342560554, 'recall': 0.38445227876558347, 'f1-score': 0.44046068517407405, 'support': 39144}, 'accuracy': 0.6725091989141024, 'macro avg': {'precision': 0.5853477234664254, 'recall': 0.5672815506018722, 'f1-score': 0.572727728645966, 'support': 211438}, 'weighted avg': {'precision': 0.6650777849603878, 'recall': 0.6725091989141024, 'f1-score': 0.6665823118828487, 'support': 211438}}
[[ 20415  15571   3976]
 [ 15438 106730  10164]
 [  7286  16809  15049]]
testing model on single stock: results/universal/W3/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
13689/13689 - 103s - 103s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0673492
{'0': {'precision': 0.43667533648644935, 'recall': 0.6522148406122683, 'f1-score': 0.5231126902892393, 'support': 1071883}, '1': {'precision': 0.5475897835969373, 'recall': 0.1674204818716819, 'f1-score': 0.25643756422916103, 'support': 1333218}, '2': {'precision': 0.4539680289797127, 'recall': 0.6177414908551314, 'f1-score': 0.5233412260174934, 'support': 1099141}, 'accuracy': 0.45695788133353804, 'macro avg': {'precision': 0.4794110496876998, 'recall': 0.47912560444636054, 'f1-score': 0.43429716017863124, 'support': 3504242}, 'weighted avg': {'precision': 0.48429768810128887, 'recall': 0.45695788133353804, 'f1-score': 0.42172560422992134, 'support': 3504242}}
[[699098  91489 281296]
 [574624 223208 535386]
 [327234  92922 678985]]
Evaluating performance on  train set...
5475/5475 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0814543
{'0': {'precision': 0.43945974316806047, 'recall': 0.6765752235081678, 'f1-score': 0.5328284199594078, 'support': 464077}, '1': {'precision': 0.5240425138252164, 'recall': 0.109624328851484, 'f1-score': 0.18131865200667915, 'support': 465061}, '2': {'precision': 0.4655360085723393, 'recall': 0.5812009051133826, 'f1-score': 0.5169779454751368, 'support': 472427}, 'accuracy': 0.4563042028018679, 'macro avg': {'precision': 0.47634608852187205, 'recall': 0.4558001524910115, 'f1-score': 0.4103750058137412, 'support': 1401565}, 'weighted avg': {'precision': 0.4763151724494244, 'recall': 0.4563042028018679, 'f1-score': 0.4108492921251335, 'support': 1401565}}
[[313983  19651 130443]
 [229293  50982 184786]
 [171199  26653 274575]]
Evaluating performance on  val set...
2036/2036 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0668638
{'0': {'precision': 0.4350257619562935, 'recall': 0.673752212278694, 'f1-score': 0.5286893793475728, 'support': 159903}, '1': {'precision': 0.5765073015982483, 'recall': 0.17267502207625215, 'f1-score': 0.2657521617497457, 'support': 193647}, '2': {'precision': 0.4703079842087928, 'recall': 0.6046604559063853, 'f1-score': 0.529088351873162, 'support': 167666}, 'accuracy': 0.46536176940078583, 'macro avg': {'precision': 0.49394701592111145, 'recall': 0.48369589675377717, 'f1-score': 0.44117663099016013, 'support': 521216}, 'weighted avg': {'precision': 0.4989399640975039, 'recall': 0.46536176940078583, 'f1-score': 0.43112884926275, 'support': 521216}}
[[107735  10299  41869]
 [ 87896  33438  72313]
 [ 52021  14264 101381]]
training model: results/universal/W3/deepOF_L2/h20
Epoch 1/50
10532/10532 - 243s - loss: 2.7880 - accuracy20: 0.5382 - val_loss: 2.8425 - val_accuracy20: 0.5456 - 243s/epoch - 23ms/step
Epoch 2/50
10532/10532 - 229s - loss: 2.7133 - accuracy20: 0.5531 - val_loss: 2.8335 - val_accuracy20: 0.5527 - 229s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 229s - loss: 2.6917 - accuracy20: 0.5571 - val_loss: 2.8196 - val_accuracy20: 0.5547 - 229s/epoch - 22ms/step
Epoch 4/50
10532/10532 - 229s - loss: 2.6778 - accuracy20: 0.5600 - val_loss: 2.8105 - val_accuracy20: 0.5573 - 229s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 230s - loss: 2.6686 - accuracy20: 0.5615 - val_loss: 2.8099 - val_accuracy20: 0.5581 - 230s/epoch - 22ms/step
Epoch 6/50
10532/10532 - 231s - loss: 2.6621 - accuracy20: 0.5629 - val_loss: 2.8035 - val_accuracy20: 0.5592 - 231s/epoch - 22ms/step
Epoch 7/50
10532/10532 - 230s - loss: 2.6564 - accuracy20: 0.5638 - val_loss: 2.8071 - val_accuracy20: 0.5587 - 230s/epoch - 22ms/step
Epoch 8/50
10532/10532 - 230s - loss: 2.6514 - accuracy20: 0.5647 - val_loss: 2.8033 - val_accuracy20: 0.5560 - 230s/epoch - 22ms/step
Epoch 9/50
10532/10532 - 231s - loss: 2.6474 - accuracy20: 0.5652 - val_loss: 2.7926 - val_accuracy20: 0.5563 - 231s/epoch - 22ms/step
Epoch 10/50
10532/10532 - 230s - loss: 2.6435 - accuracy20: 0.5662 - val_loss: 2.8102 - val_accuracy20: 0.5543 - 230s/epoch - 22ms/step
Epoch 11/50
10532/10532 - 230s - loss: 2.6407 - accuracy20: 0.5667 - val_loss: 2.8005 - val_accuracy20: 0.5574 - 230s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 230s - loss: 2.6384 - accuracy20: 0.5671 - val_loss: 2.7984 - val_accuracy20: 0.5557 - 230s/epoch - 22ms/step
Epoch 13/50
10532/10532 - 230s - loss: 2.6348 - accuracy20: 0.5677 - val_loss: 2.8100 - val_accuracy20: 0.5526 - 230s/epoch - 22ms/step
Epoch 14/50
10532/10532 - 230s - loss: 2.6325 - accuracy20: 0.5684 - val_loss: 2.8021 - val_accuracy20: 0.5551 - 230s/epoch - 22ms/step
Epoch 15/50
10532/10532 - 231s - loss: 2.6301 - accuracy20: 0.5687 - val_loss: 2.8139 - val_accuracy20: 0.5537 - 231s/epoch - 22ms/step
Epoch 16/50
10532/10532 - 230s - loss: 2.6280 - accuracy20: 0.5690 - val_loss: 2.8091 - val_accuracy20: 0.5544 - 230s/epoch - 22ms/step
Epoch 17/50
10532/10532 - 229s - loss: 2.6256 - accuracy20: 0.5696 - val_loss: 2.8076 - val_accuracy20: 0.5542 - 229s/epoch - 22ms/step
Epoch 18/50
10532/10532 - 231s - loss: 2.6236 - accuracy20: 0.5698 - val_loss: 2.8145 - val_accuracy20: 0.5536 - 231s/epoch - 22ms/step
Epoch 19/50
10532/10532 - 233s - loss: 2.6218 - accuracy20: 0.5701 - val_loss: 2.8267 - val_accuracy20: 0.5546 - 233s/epoch - 22ms/step
testing model in sample: results/universal/W3/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 210s - 210s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9518184
{'0': {'precision': 0.43898184765903214, 'recall': 0.6223474659729976, 'f1-score': 0.5148246392324997, 'support': 1806433}, '1': {'precision': 0.7751193879150756, 'recall': 0.5520364373078601, 'f1-score': 0.6448287944198412, 'support': 3457116}, '2': {'precision': 0.4605173305391352, 'recall': 0.5212528553278608, 'f1-score': 0.4890064435181542, 'support': 1822908}, 'accuracy': 0.5620409465548157, 'macro avg': {'precision': 0.5582061887044143, 'recall': 0.5652122528695729, 'f1-score': 0.549553292390165, 'support': 7086457}, 'weighted avg': {'precision': 0.6085057257614201, 'recall': 0.5620409465548157, 'f1-score': 0.5716055171029779, 'support': 7086457}}
[[1124229  269003  413201]
 [ 848736 1908454  699926]
 [ 588027  284685  950196]]
Evaluating performance on  train set...
10532/10532 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0065777
{'0': {'precision': 0.4291068964643081, 'recall': 0.6507799852529854, 'f1-score': 0.5171915401155942, 'support': 728283}, '1': {'precision': 0.7536280825291246, 'recall': 0.5040742489364877, 'f1-score': 0.6040928766278597, 'support': 1226361}, '2': {'precision': 0.4687592003911666, 'recall': 0.48764974856947024, 'f1-score': 0.47801791578549196, 'support': 741159}, 'accuracy': 0.5391918474755018, 'macro avg': {'precision': 0.5504980597948664, 'recall': 0.5475013275863144, 'f1-score': 0.5331007775096487, 'support': 2695803}, 'weighted avg': {'precision': 0.5876380607184324, 'recall': 0.5391918474755018, 'f1-score': 0.5459542225933733, 'support': 2695803}}
[[473952  95834 158497]
 [357080 618177 251104]
 [273476 106257 361426]]
Evaluating performance on  val set...
3814/3814 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9765847
{'0': {'precision': 0.4366719802101604, 'recall': 0.6493263517557664, 'f1-score': 0.5221787464637208, 'support': 252283}, '1': {'precision': 0.7652236696571217, 'recall': 0.5347358793572821, 'f1-score': 0.6295465919833377, 'support': 465772}, '2': {'precision': 0.47324607938607327, 'recall': 0.5052506216565352, 'f1-score': 0.4887249503274914, 'support': 257779}, 'accuracy': 0.5565721218977818, 'macro avg': {'precision': 0.5583805764177852, 'recall': 0.5631042842565278, 'f1-score': 0.54681676292485, 'support': 975834}, 'weighted avg': {'precision': 0.6031533819737367, 'recall': 0.5565721218977818, 'f1-score': 0.5645888797744703, 'support': 975834}}
[[163814  34936  53533]
 [125271 249065  91436]
 [ 86057  41479 130243]]
testing model out of sample: results/universal/W3/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 122s - 122s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8544075
{'0': {'precision': 0.46765874128074786, 'recall': 0.5118924853873562, 'f1-score': 0.48877687837031547, 'support': 928990}, '1': {'precision': 0.7476349827595207, 'recall': 0.7346329715206784, 'f1-score': 0.741076952262861, 'support': 2281199}, '2': {'precision': 0.47505913625197455, 'recall': 0.4503397556177895, 'f1-score': 0.4623692922118194, 'support': 926254}, 'accuracy': 0.6209479980746743, 'macro avg': {'precision': 0.5634509534307477, 'recall': 0.565621737508608, 'f1-score': 0.5640743742816653, 'support': 4136443}, 'weighted avg': {'precision': 0.6237194358264756, 'recall': 0.6209479980746743, 'f1-score': 0.6220040360886617, 'support': 4136443}}
[[ 475543  288029  165418]
 [ 309845 1675844  295510]
 [ 231471  277654  417129]]
Evaluating performance on  train set...
6181/6181 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93399143
{'0': {'precision': 0.46882029113476437, 'recall': 0.5299620374421987, 'f1-score': 0.4975197289243573, 'support': 422785}, '1': {'precision': 0.6701988237671125, 'recall': 0.6696402630405159, 'f1-score': 0.669919426975622, 'support': 733119}, '2': {'precision': 0.48893221452653574, 'recall': 0.42633167009098916, 'f1-score': 0.4554911235626669, 'support': 425875}, 'accuracy': 0.5667985224231704, 'macro avg': {'precision': 0.5426504431428042, 'recall': 0.5419779901912346, 'f1-score': 0.540976759820882, 'support': 1581779}, 'weighted avg': {'precision': 0.567569606835229, 'recall': 0.5667985224231704, 'f1-score': 0.5661074152744955, 'support': 1581779}}
[[224060 117409  81316]
 [133725 490926 108468]
 [120138 124173 181564]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8699636
{'0': {'precision': 0.4795089539267947, 'recall': 0.512941762070682, 'f1-score': 0.49566223045881685, 'support': 136612}, '1': {'precision': 0.7060554114158636, 'recall': 0.7307210181658766, 'f1-score': 0.7181764935572041, 'support': 291976}, '2': {'precision': 0.4939139099585098, 'recall': 0.42235084987292304, 'f1-score': 0.45533773376466535, 'support': 136138}, 'accuracy': 0.6036998473596045, 'macro avg': {'precision': 0.559826091767056, 'recall': 0.5553378767031605, 'f1-score': 0.5563921525935621, 'support': 564726}, 'weighted avg': {'precision': 0.6001111404315315, 'recall': 0.6036998473596045, 'f1-score': 0.6009861010641482, 'support': 564726}}
[[ 70074  43839  22699]
 [ 42407 213353  36216]
 [ 33656  44984  57498]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2235899
{'0': {'precision': 0.39463763562987847, 'recall': 0.5533793056708629, 'f1-score': 0.46071813969234676, 'support': 59021}, '1': {'precision': 0.4755927475592748, 'recall': 0.08611732448228587, 'f1-score': 0.145828878638849, 'support': 55436}, '2': {'precision': 0.4005062788504492, 'recall': 0.5476913678708999, 'f1-score': 0.46267533454224874, 'support': 58931}, 'accuracy': 0.40205204512423004, 'macro avg': {'precision': 0.4235788873465342, 'recall': 0.3957293326746829, 'f1-score': 0.35640745095781484, 'support': 173388}, 'weighted avg': {'precision': 0.4225154160907493, 'recall': 0.40205204512423004, 'f1-score': 0.36070624944583535, 'support': 173388}}
[[32661  2956 23404]
 [25754  4774 24908]
 [24347  2308 32276]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.253705
{'0': {'precision': 0.38393700787401575, 'recall': 0.5376201817059186, 'f1-score': 0.4479641334705277, 'support': 22674}, '1': {'precision': 0.4679174484052533, 'recall': 0.058189454036397574, 'f1-score': 0.10350695164971987, 'support': 21430}, '2': {'precision': 0.37139633993482074, 'recall': 0.5333213337533186, 'f1-score': 0.437868292232382, 'support': 22223}, 'accuracy': 0.3812776094199949, 'macro avg': {'precision': 0.40775026540469655, 'recall': 0.3763769898318783, 'f1-score': 0.3297797924508765, 'support': 66327}, 'weighted avg': {'precision': 0.4068689899774079, 'recall': 0.38127760941999483, 'f1-score': 0.33328870285772716, 'support': 66327}}
[[12190   717  9767]
 [ 9890  1247 10293]
 [ 9670   701 11852]]
Evaluating performance on  val set...
86/86 - 1s - 866ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2480985
{'0': {'precision': 0.39801196875950906, 'recall': 0.5118038346158863, 'f1-score': 0.44779185210544337, 'support': 7667}, '1': {'precision': 0.42937062937062936, 'recall': 0.04488960374323731, 'f1-score': 0.08128144029653163, 'support': 6839}, '2': {'precision': 0.36883802816901406, 'recall': 0.5640818524501885, 'f1-score': 0.44602938045560997, 'support': 7428}, 'accuracy': 0.3839245007750524, 'macro avg': {'precision': 0.3987402087663841, 'recall': 0.3735917636031041, 'f1-score': 0.32503422428586165, 'support': 21934}, 'weighted avg': {'precision': 0.39790974614681895, 'recall': 0.3839245007750524, 'f1-score': 0.3329173948347171, 'support': 21934}}
[[3924  195 3548]
 [2910  307 3622]
 [3025  213 4190]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65691817
{'0': {'precision': 0.49892585253936805, 'recall': 0.5180733329001798, 'f1-score': 0.5083193438024607, 'support': 46173}, '1': {'precision': 0.8678377891529189, 'recall': 0.8316705987283137, 'f1-score': 0.8493693574571551, 'support': 278056}, '2': {'precision': 0.38457051188566427, 'recall': 0.4683836589698046, 'f1-score': 0.42235925362376875, 'support': 45040}, 'accuracy': 0.7481483688043133, 'macro avg': {'precision': 0.5837780511926504, 'recall': 0.6060425301994328, 'f1-score': 0.5933493182944615, 'support': 369269}, 'weighted avg': {'precision': 0.7627649858107087, 'recall': 0.7481483688043133, 'f1-score': 0.7546421061657281, 'support': 369269}}
[[ 23921  17120   5132]
 [ 18177 231251  28628]
 [  5847  18097  21096]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8433525
{'0': {'precision': 0.4827307505792338, 'recall': 0.501778263182951, 'f1-score': 0.49207024867150917, 'support': 35709}, '1': {'precision': 0.749313864812384, 'recall': 0.7363102408033173, 'f1-score': 0.7427551426390098, 'support': 93811}, '2': {'precision': 0.461392459666983, 'recall': 0.46431672165306476, 'f1-score': 0.46284997187243065, 'support': 34554}, 'accuracy': 0.6279849336275095, 'macro avg': {'precision': 0.5644790250195336, 'recall': 0.5674684085464444, 'f1-score': 0.5658917877276498, 'support': 164074}, 'weighted avg': {'precision': 0.6306585467269729, 'recall': 0.6279849336275095, 'f1-score': 0.6292481266014057, 'support': 164074}}
[[17918 11955  5836]
 [11844 69074 12893]
 [ 7356 11154 16044]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7836351
{'0': {'precision': 0.4779638607315998, 'recall': 0.5013483319207951, 'f1-score': 0.4893769036964615, 'support': 12979}, '1': {'precision': 0.7741276363884033, 'recall': 0.7747080474394511, 'f1-score': 0.7744177331622399, 'support': 44014}, '2': {'precision': 0.47395875130406867, 'recall': 0.449843857110214, 'f1-score': 0.46158655724892533, 'support': 13129}, 'accuracy': 0.6632868429308919, 'macro avg': {'precision': 0.5753500828080239, 'recall': 0.5753000788234868, 'f1-score': 0.5751270647025423, 'support': 70122}, 'weighted avg': {'precision': 0.6631093120890126, 'recall': 0.6632868429308919, 'f1-score': 0.6630874026781943, 'support': 70122}}
[[ 6507  4972  1500]
 [ 4861 34098  5055]
 [ 2246  4977  5906]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
1359/1359 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1107768
{'0': {'precision': 0.4288476606930718, 'recall': 0.603365961646174, 'f1-score': 0.501353742275543, 'support': 112479}, '1': {'precision': 0.5228307150198209, 'recall': 0.37198968235473734, 'f1-score': 0.4346964646227522, 'support': 124447}, '2': {'precision': 0.45875329201401954, 'recall': 0.4179181210596098, 'f1-score': 0.43738465967820345, 'support': 110871}, 'accuracy': 0.4614588394954528, 'macro avg': {'precision': 0.47014388924230405, 'recall': 0.464424588353507, 'f1-score': 0.4578116221921662, 'support': 347797}, 'weighted avg': {'precision': 0.4720095522907156, 'recall': 0.4614588394954528, 'f1-score': 0.45711065107951054, 'support': 347797}}
[[67866 20131 24482]
 [47969 46293 30185]
 [42417 22119 46335]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1556414
{'0': {'precision': 0.40727254251067, 'recall': 0.6400926320272572, 'f1-score': 0.49780565561213924, 'support': 37568}, '1': {'precision': 0.53256917483207, 'recall': 0.22833439019234833, 'f1-score': 0.3196301433194637, 'support': 37848}, '2': {'precision': 0.43560299605919045, 'recall': 0.43725767578329666, 'f1-score': 0.4364287675352011, 'support': 38172}, 'accuracy': 0.4347290206711977, 'macro avg': {'precision': 0.45848157113397686, 'recall': 0.43522823266763405, 'f1-score': 0.41795485548893474, 'support': 113588}, 'weighted avg': {'precision': 0.45854254473761713, 'recall': 0.4347290206711977, 'f1-score': 0.41781071458909047, 'support': 113588}}
[[24047  3353 10168]
 [17748  8642 11458]
 [17249  4232 16691]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1293851
{'0': {'precision': 0.41501683117475896, 'recall': 0.6043033978566088, 'f1-score': 0.4920849682045732, 'support': 12037}, '1': {'precision': 0.5390602887064817, 'recall': 0.30360274190977204, 'f1-score': 0.38843565164185195, 'support': 12546}, '2': {'precision': 0.4287492737986555, 'recall': 0.4283937308234514, 'f1-score': 0.4285714285714286, 'support': 12059}, 'accuracy': 0.44345286829321545, 'macro avg': {'precision': 0.460942131226632, 'recall': 0.4454332901966107, 'f1-score': 0.4363640161392846, 'support': 36642}, 'weighted avg': {'precision': 0.4620079545794466, 'recall': 0.44345286829321545, 'f1-score': 0.4356935567086944, 'support': 36642}}
[[7274 1481 3282]
 [5136 3809 3601]
 [5117 1776 5166]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.338532
{'0': {'precision': 0.3609952013352806, 'recall': 0.49178281039050686, 'f1-score': 0.4163597846311185, 'support': 98513}, '1': {'precision': 0.4624922504649721, 'recall': 0.0076398418778034945, 'f1-score': 0.015031382544655901, 'support': 97646}, '2': {'precision': 0.33299953782159913, 'recall': 0.5435342930785189, 'f1-score': 0.4129827326789425, 'support': 95442}, 'accuracy': 0.3466003203006848, 'macro avg': {'precision': 0.38549566320728396, 'recall': 0.34765231511560973, 'f1-score': 0.28145796661823896, 'support': 291601}, 'weighted avg': {'precision': 0.3858195974870259, 'recall': 0.3466003203006848, 'f1-score': 0.2808649621080328, 'support': 291601}}
[[48447   406 49660]
 [42652   746 54248]
 [43105   461 51876]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3199211
{'0': {'precision': 0.36251520617475563, 'recall': 0.5146498332539304, 'f1-score': 0.4253894809381999, 'support': 33584}, '1': {'precision': 0.5830985915492958, 'recall': 0.025555555555555557, 'f1-score': 0.04896510940272029, 'support': 32400}, '2': {'precision': 0.33842254663422544, 'recall': 0.5146142936424739, 'f1-score': 0.4083225285612936, 'support': 32434}, 'accuracy': 0.3536243370115223, 'macro avg': {'precision': 0.4280121147860923, 'recall': 0.35160656081732, 'f1-score': 0.2942257063007379, 'support': 98418}, 'weighted avg': {'precision': 0.4271932159554619, 'recall': 0.3536243370115223, 'f1-score': 0.2958430649254571, 'support': 98418}}
[[17284   264 16036]
 [14979   828 16593]
 [15415   328 16691]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.322393
{'0': {'precision': 0.36408118883653495, 'recall': 0.4856958659037795, 'f1-score': 0.4161861685598867, 'support': 12409}, '1': {'precision': 0.735973597359736, 'recall': 0.01900784180020457, 'f1-score': 0.03705857914416286, 'support': 11732}, '2': {'precision': 0.31451874257318785, 'recall': 0.5185218165627783, 'f1-score': 0.39154115115653576, 'support': 11230}, 'accuracy': 0.3413248141132566, 'macro avg': {'precision': 0.47152450958981956, 'recall': 0.3410751747555875, 'f1-score': 0.28159529962019514, 'support': 35371}, 'weighted avg': {'precision': 0.47169633868405997, 'recall': 0.3413248141132566, 'f1-score': 0.2826109678456037, 'support': 35371}}
[[6027   41 6341]
 [5159  223 6350]
 [5368   39 5823]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1219527
{'0': {'precision': 0.4253024434471535, 'recall': 0.5879505561644841, 'f1-score': 0.49357230278856407, 'support': 190681}, '1': {'precision': 0.5159187829120315, 'recall': 0.3108347956377239, 'f1-score': 0.3879402850204258, 'support': 198887}, '2': {'precision': 0.45761140002293565, 'recall': 0.4720583470062698, 'f1-score': 0.4647226216758147, 'support': 194423}, 'accuracy': 0.45499160089795904, 'macro avg': {'precision': 0.46627754212737355, 'recall': 0.45694789960282595, 'f1-score': 0.44874506982826823, 'support': 583991}, 'weighted avg': {'precision': 0.4669195508537479, 'recall': 0.45499160089795904, 'f1-score': 0.4479930444286993, 'support': 583991}}
[[112111  28407  50163]
 [ 78447  61821  58619]
 [ 73045  29599  91779]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1242076
{'0': {'precision': 0.4293271730869235, 'recall': 0.5772545750359683, 'f1-score': 0.49242115767318356, 'support': 74371}, '1': {'precision': 0.509562565861752, 'recall': 0.30626490762327, 'f1-score': 0.3825836643997037, 'support': 74207}, '2': {'precision': 0.4495033938909962, 'recall': 0.47299870015624385, 'f1-score': 0.46095184476702894, 'support': 76163}, 'accuracy': 0.45244525920949, 'macro avg': {'precision': 0.46279771094655725, 'recall': 0.45217272760516075, 'f1-score': 0.4453188889466387, 'support': 224741}, 'weighted avg': {'precision': 0.46265758140913565, 'recall': 0.45244525920949, 'f1-score': 0.4454893199479062, 'support': 224741}}
[[42931 10225 21215]
 [28576 22727 22904]
 [28489 11649 36025]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1385149
{'0': {'precision': 0.43436988543371524, 'recall': 0.5780990099009901, 'f1-score': 0.4960326225469375, 'support': 25250}, '1': {'precision': 0.4891859331076817, 'recall': 0.32199229665433127, 'f1-score': 0.3883588003552479, 'support': 26482}, '2': {'precision': 0.4533059891382781, 'recall': 0.4656134191535011, 'f1-score': 0.45937728514798143, 'support': 25635}, 'accuracy': 0.45316478601987925, 'macro avg': {'precision': 0.45895393589322503, 'recall': 0.45523490856960747, 'f1-score': 0.4479229026833889, 'support': 77367}, 'weighted avg': {'precision': 0.45940724752567236, 'recall': 0.45316478601987925, 'f1-score': 0.44703139807781545, 'support': 77367}}
[[14597  4226  6427]
 [ 9987  8527  7968]
 [ 9021  4678 11936]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/EXC
Evaluating performance on  test set...
5098/5098 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5973766
{'0': {'precision': 0.5243537609945721, 'recall': 0.5570150191009472, 'f1-score': 0.5401911458369378, 'support': 210199}, '1': {'precision': 0.8166383793075082, 'recall': 0.8501961376490753, 'f1-score': 0.8330794555550096, 'support': 887387}, '2': {'precision': 0.5468455848329457, 'recall': 0.41612764746455977, 'f1-score': 0.472614521589552, 'support': 207321}, 'accuracy': 0.7340055651475546, 'macro avg': {'precision': 0.6292792417116753, 'recall': 0.6077796014048608, 'f1-score': 0.6152950409938333, 'support': 1304907}, 'weighted avg': {'precision': 0.7266920103877141, 'recall': 0.7340055651475546, 'f1-score': 0.7286300347234241, 'support': 1304907}}
[[117084  78028  15087]
 [ 76530 754453  56404]
 [ 29678  91371  86272]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60976213
{'0': {'precision': 0.5164909299885063, 'recall': 0.537852078319131, 'f1-score': 0.5269551141107266, 'support': 76865}, '1': {'precision': 0.8191895480627875, 'recall': 0.8514725816389402, 'f1-score': 0.835019154310022, 'support': 324600}, '2': {'precision': 0.5517851168570472, 'recall': 0.43986537973075945, 'f1-score': 0.4895095011624702, 'support': 78740}, 'accuracy': 0.7337803646359368, 'macro avg': {'precision': 0.6291551983027803, 'recall': 0.6097300132296102, 'f1-score': 0.6171612565277397, 'support': 480205}, 'weighted avg': {'precision': 0.726890729451112, 'recall': 0.7337803646359368, 'f1-score': 0.7290544672727003, 'support': 480205}}
[[ 41342  28082   7441]
 [ 27519 276388  20693]
 [ 11183  32922  34635]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5656365
{'0': {'precision': 0.516370177893264, 'recall': 0.5615110415579899, 'f1-score': 0.5379953768300048, 'support': 23004}, '1': {'precision': 0.8304785267654198, 'recall': 0.8662700187885837, 'f1-score': 0.847996776976401, 'support': 111770}, '2': {'precision': 0.5673225998807394, 'recall': 0.40316976014916517, 'f1-score': 0.47136345620293296, 'support': 23598}, 'accuracy': 0.7529992675472937, 'macro avg': {'precision': 0.6380571015131411, 'recall': 0.6103169401652462, 'f1-score': 0.6191185366697796, 'support': 158372}, 'weighted avg': {'precision': 0.7456421793045065, 'recall': 0.7529992675472937, 'f1-score': 0.746848434386928, 'support': 158372}}
[[12917  8634  1453]
 [ 9144 96823  5803]
 [ 2954 11130  9514]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/AAL
Evaluating performance on  test set...
5760/5760 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6463489
{'0': {'precision': 0.50293405087674, 'recall': 0.4828094021656245, 'f1-score': 0.4926662970636009, 'support': 209824}, '1': {'precision': 0.8398169444905508, 'recall': 0.8381879902383057, 'f1-score': 0.8390016766957297, 'support': 1056374}, '2': {'precision': 0.46066095448851013, 'recall': 0.48376378625719624, 'f1-score': 0.4719297957998328, 'support': 208269}, 'accuracy': 0.7375532989208982, 'macro avg': {'precision': 0.6011373166186004, 'recall': 0.6015870595537088, 'f1-score': 0.6011992565197211, 'support': 1474467}, 'weighted avg': {'precision': 0.7383209088713343, 'recall': 0.7375532989208982, 'f1-score': 0.7378673900292668, 'support': 1474467}}
[[101305  87487  21032]
 [ 74005 885440  96929]
 [ 26118  81398 100753]]
Evaluating performance on  train set...
2159/2159 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7516189
{'0': {'precision': 0.5103798545710215, 'recall': 0.5074551358113266, 'f1-score': 0.5089132931447204, 'support': 108717}, '1': {'precision': 0.7533589842678002, 'recall': 0.8059351839092167, 'f1-score': 0.7787607033063736, 'support': 333806}, '2': {'precision': 0.5353094731057223, 'recall': 0.42498750170431304, 'f1-score': 0.4738114178873817, 'support': 110015}, 'accuracy': 0.6713565401836615, 'macro avg': {'precision': 0.5996827706481813, 'recall': 0.5794592738082854, 'f1-score': 0.5871618047794919, 'support': 552538}, 'weighted avg': {'precision': 0.6621350702315879, 'recall': 0.6713565401836615, 'f1-score': 0.6649477229757631, 'support': 552538}}
[[ 55169  42963  10585]
 [ 34778 269026  30002]
 [ 18147  45113  46755]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6965619
{'0': {'precision': 0.5333719295343644, 'recall': 0.4852885845436075, 'f1-score': 0.5081954294720253, 'support': 39867}, '1': {'precision': 0.7744686292721668, 'recall': 0.8368776273109427, 'f1-score': 0.8044645478823809, 'support': 137498}, '2': {'precision': 0.5430848772081, 'recall': 0.44139569784892446, 'f1-score': 0.4869884372326627, 'support': 39980}, 'accuracy': 0.6996388230693138, 'macro avg': {'precision': 0.6169751453382104, 'recall': 0.5878539699011582, 'f1-score': 0.5998828048623563, 'support': 217345}, 'weighted avg': {'precision': 0.6876825309677734, 'recall': 0.6996388230693138, 'f1-score': 0.691721876795209, 'support': 217345}}
[[ 19347  16941   3579]
 [ 11161 115069  11268]
 [  5765  16568  17647]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/WBA
Evaluating performance on  test set...
6315/6315 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.710799
{'0': {'precision': 0.5447750756877715, 'recall': 0.43505983686529065, 'f1-score': 0.48377487374775124, 'support': 304411}, '1': {'precision': 0.7533191736124937, 'recall': 0.8601786322334192, 'f1-score': 0.8032103347713963, 'support': 1007321}, '2': {'precision': 0.5603994209471905, 'recall': 0.4103562122176787, 'f1-score': 0.4737822287142237, 'support': 304706}, 'accuracy': 0.6953257718514413, 'macro avg': {'precision': 0.6194978900824852, 'recall': 0.5685315604387962, 'f1-score': 0.5869224790777904, 'support': 1616438}, 'weighted avg': {'precision': 0.6776794500047857, 'recall': 0.6953257718514413, 'f1-score': 0.6809548640326946, 'support': 1616438}}
[[132437 145328  26646]
 [ 69406 866476  71439]
 [ 41261 138407 125038]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7750614
{'0': {'precision': 0.5377260886433758, 'recall': 0.49245801785034476, 'f1-score': 0.514097474598051, 'support': 118205}, '1': {'precision': 0.7228800742446637, 'recall': 0.8112880619277852, 'f1-score': 0.7645367683144801, 'support': 311072}, '2': {'precision': 0.5664588886175149, 'recall': 0.4363017732120657, 'f1-score': 0.49293321320488837, 'support': 122264}, 'accuracy': 0.6598312727430962, 'macro avg': {'precision': 0.6090216838351848, 'recall': 0.5800159509967319, 'f1-score': 0.5905224853724732, 'support': 551541}, 'weighted avg': {'precision': 0.6485233052872916, 'recall': 0.6598312727430962, 'f1-score': 0.6506549104368797, 'support': 551541}}
[[ 58211  47237  12757]
 [ 30633 252369  28070]
 [ 19410  49510  53344]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7133129
{'0': {'precision': 0.5397216674987518, 'recall': 0.47892900653449993, 'f1-score': 0.5075112962854293, 'support': 36116}, '1': {'precision': 0.7593196733099695, 'recall': 0.8487976579290272, 'f1-score': 0.801569323089585, 'support': 118186}, '2': {'precision': 0.561033393501805, 'recall': 0.4092891827384708, 'f1-score': 0.47329600431451546, 'support': 36451}, 'accuracy': 0.6947833061603225, 'macro avg': {'precision': 0.6200249114368421, 'recall': 0.579005282400666, 'f1-score': 0.5941255412298432, 'support': 190753}, 'weighted avg': {'precision': 0.6798518024866256, 'recall': 0.6947833061603225, 'f1-score': 0.6831644202113658, 'support': 190753}}
[[ 17297  15697   3122]
 [  9319 100316   8551]
 [  5432  16100  14919]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
6082/6082 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8528585
{'0': {'precision': 0.520319795372093, 'recall': 0.4535848845189574, 'f1-score': 0.4846659004106653, 'support': 356985}, '1': {'precision': 0.6990347994594299, 'recall': 0.8002907612389265, 'f1-score': 0.7462436530880131, 'support': 846055}, '2': {'precision': 0.5265529217239363, 'recall': 0.4122908186341022, 'f1-score': 0.4624687279034299, 'support': 353760}, 'accuracy': 0.6326214028776979, 'macro avg': {'precision': 0.5819691721851531, 'recall': 0.5553888214639954, 'f1-score': 0.5644594271340361, 'support': 1556800}, 'weighted avg': {'precision': 0.6188602331684315, 'recall': 0.6326214028776979, 'f1-score': 0.6217783707313705, 'support': 1556800}}
[[161923 149052  46010]
 [ 83833 677090  85132]
 [ 65443 142465 145852]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95299697
{'0': {'precision': 0.5010293288998734, 'recall': 0.5004374355688056, 'f1-score': 0.500733207322037, 'support': 179455}, '1': {'precision': 0.6077100122452381, 'recall': 0.7131679130866575, 'f1-score': 0.6562291228932511, 'support': 265828}, '2': {'precision': 0.5260001199544173, 'recall': 0.3912951333504367, 'f1-score': 0.4487568998931836, 'support': 179302}, 'accuracy': 0.5596452044157321, 'macro avg': {'precision': 0.544913153699843, 'recall': 0.5349668273352999, 'f1-score': 0.5352397433694905, 'support': 624585}, 'weighted avg': {'precision': 0.5536018778243488, 'recall': 0.5596452044157321, 'f1-score': 0.5519923832065947, 'support': 624585}}
[[ 89806  60050  29599]
 [ 42623 189580  33625]
 [ 46814  62328  70160]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8650293
{'0': {'precision': 0.5124072547403132, 'recall': 0.480044795427777, 'f1-score': 0.49569837804428224, 'support': 51791}, '1': {'precision': 0.6668197527789022, 'recall': 0.7887322646877388, 'f1-score': 0.7226705022376508, 'support': 108611}, '2': {'precision': 0.5420319303338171, 'recall': 0.36587898738145624, 'f1-score': 0.43686685539152614, 'support': 51036}, 'accuracy': 0.611053831383195, 'macro avg': {'precision': 0.5737529792843442, 'recall': 0.5448853491656573, 'f1-score': 0.5517452452244864, 'support': 211438}, 'weighted avg': {'precision': 0.5988761996227812, 'recall': 0.611053831383195, 'f1-score': 0.5980884110121494, 'support': 211438}}
[[24862 21073  5856]
 [13025 85665  9921]
 [10633 21730 18673]]
testing model on single stock: results/universal/W3/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
13689/13689 - 104s - 104s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1940434
{'0': {'precision': 0.4194440638397793, 'recall': 0.6991710667513994, 'f1-score': 0.5243325350022996, 'support': 1147137}, '1': {'precision': 0.4613347721424421, 'recall': 0.04683299823208107, 'f1-score': 0.08503369094903822, 'support': 1186706}, '2': {'precision': 0.4521286210341055, 'recall': 0.5684873278258098, 'f1-score': 0.5036750442560944, 'support': 1170399}, 'accuracy': 0.434610109689913, 'macro avg': {'precision': 0.44430248567210895, 'recall': 0.43816379760309676, 'f1-score': 0.3710137567358108, 'support': 3504242}, 'weighted avg': {'precision': 0.4445467616393896, 'recall': 0.434610109689913, 'f1-score': 0.3686651808232967, 'support': 3504242}}
[[802045  28288 316804]
 [641680  55577 489449]
 [468437  36605 665357]]
Evaluating performance on  train set...
5475/5475 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2308788
{'0': {'precision': 0.4079905973158561, 'recall': 0.7310376789101569, 'f1-score': 0.5237034154537004, 'support': 463920}, '1': {'precision': 0.48774399680495234, 'recall': 0.04206873091944075, 'f1-score': 0.07745669322551235, 'support': 464478}, '2': {'precision': 0.45465637971451256, 'recall': 0.5095072141548332, 'f1-score': 0.48052157724896305, 'support': 473167}, 'accuracy': 0.4279252121735346, 'macro avg': {'precision': 0.4501303246117736, 'recall': 0.4275378746614769, 'f1-score': 0.36056056197605857, 'support': 1401565}, 'weighted avg': {'precision': 0.45017516082031117, 'recall': 0.4279252121735346, 'f1-score': 0.3612393086267425, 'support': 1401565}}
[[339143   8239 116538]
 [272307  19540 172631]
 [219802  12283 241082]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.200769
{'0': {'precision': 0.42009526127316343, 'recall': 0.720202652361794, 'f1-score': 0.5306573269946532, 'support': 167775}, '1': {'precision': 0.5391596220785678, 'recall': 0.09634031210084967, 'f1-score': 0.163470689671419, 'support': 180070}, '2': {'precision': 0.4677424159674296, 'recall': 0.5433896095656137, 'f1-score': 0.5027362646452195, 'support': 173371}, 'accuracy': 0.4458573796660118, 'macro avg': {'precision': 0.4756657664397203, 'recall': 0.45331085800941917, 'f1-score': 0.39895476043709727, 'support': 521216}, 'weighted avg': {'precision': 0.47707845884716116, 'recall': 0.4458573796660118, 'f1-score': 0.3945141535629503, 'support': 521216}}
[[120832   5638  41305]
 [ 96825  17348  65897]
 [ 69973   9190  94208]]
training model: results/universal/W3/deepOF_L2/h30
Epoch 1/50
10532/10532 - 236s - loss: 2.8692 - accuracy30: 0.5191 - val_loss: 3.0573 - val_accuracy30: 0.5188 - 236s/epoch - 22ms/step
Epoch 2/50
10532/10532 - 229s - loss: 2.8024 - accuracy30: 0.5330 - val_loss: 2.9954 - val_accuracy30: 0.5302 - 229s/epoch - 22ms/step
Epoch 3/50
10532/10532 - 233s - loss: 2.7830 - accuracy30: 0.5366 - val_loss: 2.9911 - val_accuracy30: 0.5352 - 233s/epoch - 22ms/step
Epoch 4/50
10532/10532 - 231s - loss: 2.7702 - accuracy30: 0.5396 - val_loss: 2.9948 - val_accuracy30: 0.5377 - 231s/epoch - 22ms/step
Epoch 5/50
10532/10532 - 231s - loss: 2.7615 - accuracy30: 0.5416 - val_loss: 3.0166 - val_accuracy30: 0.5371 - 231s/epoch - 22ms/step
Epoch 6/50
10532/10532 - 234s - loss: 2.7544 - accuracy30: 0.5432 - val_loss: 3.0179 - val_accuracy30: 0.5386 - 234s/epoch - 22ms/step
Epoch 7/50
10532/10532 - 232s - loss: 2.7493 - accuracy30: 0.5443 - val_loss: 3.0475 - val_accuracy30: 0.5360 - 232s/epoch - 22ms/step
Epoch 8/50
10532/10532 - 231s - loss: 2.7443 - accuracy30: 0.5454 - val_loss: 3.0510 - val_accuracy30: 0.5356 - 231s/epoch - 22ms/step
Epoch 9/50
10532/10532 - 232s - loss: 2.7406 - accuracy30: 0.5463 - val_loss: 3.0426 - val_accuracy30: 0.5355 - 232s/epoch - 22ms/step
Epoch 10/50
10532/10532 - 233s - loss: 2.7373 - accuracy30: 0.5467 - val_loss: 3.0536 - val_accuracy30: 0.5356 - 233s/epoch - 22ms/step
Epoch 11/50
10532/10532 - 234s - loss: 2.7338 - accuracy30: 0.5474 - val_loss: 3.0512 - val_accuracy30: 0.5374 - 234s/epoch - 22ms/step
Epoch 12/50
10532/10532 - 232s - loss: 2.7309 - accuracy30: 0.5483 - val_loss: 3.0627 - val_accuracy30: 0.5349 - 232s/epoch - 22ms/step
Epoch 13/50
10532/10532 - 231s - loss: 2.7281 - accuracy30: 0.5488 - val_loss: 3.0726 - val_accuracy30: 0.5342 - 231s/epoch - 22ms/step
testing model in sample: results/universal/W3/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 206s - 206s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0232006
{'0': {'precision': 0.46251698838040894, 'recall': 0.5553417478386573, 'f1-score': 0.5046967395227372, 'support': 1986728}, '1': {'precision': 0.7180055150409804, 'recall': 0.5219781800410049, 'f1-score': 0.6044970002217899, 'support': 3093773}, '2': {'precision': 0.4576425201712481, 'recall': 0.5593766762581034, 'f1-score': 0.5034212780772379, 'support': 2005956}, 'accuracy': 0.5419181969212542, 'macro avg': {'precision': 0.5460550078642125, 'recall': 0.5455655347125885, 'f1-score': 0.5375383392739216, 'support': 7086457}, 'weighted avg': {'precision': 0.5726771906988991, 'recall': 0.5419181969212542, 'f1-score': 0.547906037540678, 'support': 7086457}}
[[1103313  289565  593850]
 [ 742945 1614882  735946]
 [ 539196  344675 1122085]]
Evaluating performance on  train set...
10532/10532 - 87s - 87s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0900161
{'0': {'precision': 0.44255911416069194, 'recall': 0.5607063471819511, 'f1-score': 0.49467606306517314, 'support': 768404}, '1': {'precision': 0.6914827366856788, 'recall': 0.45187244232290785, 'f1-score': 0.5465703025392764, 'support': 1145082}, '2': {'precision': 0.44518779306570727, 'recall': 0.5542510261185684, 'f1-score': 0.4937686757524962, 'support': 782317}, 'accuracy': 0.5126042221927938, 'macro avg': {'precision': 0.526409881304026, 'recall': 0.522276605207809, 'f1-score': 0.5116716804523153, 'support': 2695803}, 'weighted avg': {'precision': 0.5490559240993602, 'recall': 0.5126042221927938, 'f1-score': 0.5164555829355767, 'support': 2695803}}
[[430849 104550 233005]
 [320285 517431 307366]
 [222406 126311 433600]]
Evaluating performance on  val set...
3814/3814 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.042332
{'0': {'precision': 0.453539885436948, 'recall': 0.582754132358753, 'f1-score': 0.5100912248631786, 'support': 275811}, '1': {'precision': 0.7074609750056828, 'recall': 0.4975316919303386, 'f1-score': 0.5842097890342645, 'support': 419113}, '2': {'precision': 0.4697533188244765, 'recall': 0.5463208856929266, 'f1-score': 0.5051521789577803, 'support': 280910}, 'accuracy': 0.5356638526634653, 'macro avg': {'precision': 0.5435847264223691, 'recall': 0.5422022366606728, 'f1-score': 0.5331510642850744, 'support': 975834}, 'weighted avg': {'precision': 0.5672642946964243, 'recall': 0.5356638526634653, 'f1-score': 0.5405027768281141, 'support': 975834}}
[[160730  37578  77503]
 [114864 208522  95727]
 [ 78796  48647 153467]]
testing model out of sample: results/universal/W3/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 124s - 124s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9402069
{'0': {'precision': 0.4606695684589071, 'recall': 0.4882210372304114, 'f1-score': 0.4740453181536338, 'support': 1032731}, '1': {'precision': 0.6955927936354726, 'recall': 0.6724641152698053, 'f1-score': 0.683832945128626, 'support': 2079018}, '2': {'precision': 0.45994455732580664, 'recall': 0.4632495164410058, 'f1-score': 0.4615911211420342, 'support': 1024694}, 'accuracy': 0.5746374360773254, 'macro avg': {'precision': 0.5387356398067288, 'recall': 0.5413115563137408, 'f1-score': 0.5398231281414313, 'support': 4136443}, 'weighted avg': {'precision': 0.5785647501892275, 'recall': 0.5746374360773254, 'f1-score': 0.576401499951785, 'support': 4136443}}
[[ 504201  294454  234076]
 [ 357661 1398065  323292]
 [ 232634  317371  474689]]
Evaluating performance on  train set...
6181/6181 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0046637
{'0': {'precision': 0.4655433113253851, 'recall': 0.5066861391854284, 'f1-score': 0.4852441836957822, 'support': 464244}, '1': {'precision': 0.6091582339486752, 'recall': 0.589366204227357, 'f1-score': 0.5990987996248778, 'support': 649815}, '2': {'precision': 0.4733890867676779, 'recall': 0.45323270332677673, 'f1-score': 0.4630916687146719, 'support': 467720}, 'accuracy': 0.5248463913100376, 'macro avg': {'precision': 0.5160302106805794, 'recall': 0.5164283489131873, 'f1-score': 0.515811550678444, 'support': 1581779}, 'weighted avg': {'precision': 0.5268620903927026, 'recall': 0.5248463913100376, 'f1-score': 0.5254667830241336, 'support': 1581779}}
[[235226 114031 114987]
 [146004 382979 120832]
 [124042 131692 211986]]
Evaluating performance on  val set...
2209/2209 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95270205
{'0': {'precision': 0.4725949496895607, 'recall': 0.49870472267948607, 'f1-score': 0.4852989041987631, 'support': 152477}, '1': {'precision': 0.6439325736886713, 'recall': 0.6549480862802192, 'f1-score': 0.6493936199511857, 'support': 261010}, '2': {'precision': 0.47780267437658114, 'recall': 0.43708302752596884, 'f1-score': 0.45653667784342633, 'support': 151239}, 'accuracy': 0.5544157697715352, 'macro avg': {'precision': 0.5314433992516043, 'recall': 0.530245278828558, 'f1-score': 0.5304097339977917, 'support': 564726}, 'weighted avg': {'precision': 0.5531799489882439, 'recall': 0.5544157697715352, 'f1-score': 0.5534388364965236, 'support': 564726}}
[[ 76041  44232  32204]
 [ 50020 170948  40042]
 [ 34840  50295  66104]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3039006
{'0': {'precision': 0.38174824247247646, 'recall': 0.39286079923557315, 'f1-score': 0.38722481037353473, 'support': 58606}, '1': {'precision': 0.46674311926605505, 'recall': 0.07162466563423905, 'f1-score': 0.12419138288783108, 'support': 56824}, '2': {'precision': 0.3674345509601748, 'recall': 0.6615825252769246, 'f1-score': 0.472466946782163, 'support': 57958}, 'accuracy': 0.3774078944332941, 'macro avg': {'precision': 0.4053086375662354, 'recall': 0.375355996715579, 'f1-score': 0.32796104668117626, 'support': 173388}, 'weighted avg': {'precision': 0.4048187891438051, 'recall': 0.3774078944332941, 'f1-score': 0.32951523565396734, 'support': 173388}}
[[23024  2681 32901]
 [19643  4070 33111]
 [17645  1969 38344]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3222333
{'0': {'precision': 0.37651566183900304, 'recall': 0.40029542097488924, 'f1-score': 0.38804156813398993, 'support': 22341}, '1': {'precision': 0.43233532934131735, 'recall': 0.03298460413906528, 'f1-score': 0.06129292414788403, 'support': 21889}, '2': {'precision': 0.3569245813470236, 'recall': 0.6607231750916414, 'f1-score': 0.46347734992539913, 'support': 22097}, 'accuracy': 0.36583894944743467, 'macro avg': {'precision': 0.3885918575091147, 'recall': 0.3646677334018653, 'f1-score': 0.304270614069091, 'support': 66327}, 'weighted avg': {'precision': 0.3884102537295889, 'recall': 0.36583894944743467, 'f1-score': 0.30534075853959997, 'support': 66327}}
[[ 8943   492 12906]
 [ 7768   722 13399]
 [ 7041   456 14600]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.311373
{'0': {'precision': 0.39251276233692567, 'recall': 0.3657505285412262, 'f1-score': 0.3786593707250342, 'support': 7568}, '1': {'precision': 0.3801980198019802, 'recall': 0.0274246536209113, 'f1-score': 0.05115907274180656, 'support': 7001}, '2': {'precision': 0.3554983654448077, 'recall': 0.6939579090291921, 'f1-score': 0.4701499402078926, 'support': 7365}, 'accuracy': 0.3679675389805781, 'macro avg': {'precision': 0.37606971586123783, 'recall': 0.3623776970637765, 'f1-score': 0.2999894612249111, 'support': 21934}, 'weighted avg': {'precision': 0.3761533866827996, 'recall': 0.3679675389805781, 'f1-score': 0.30484695429668895, 'support': 21934}}
[[2768  169 4631]
 [2174  192 4635]
 [2110  144 5111]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7452549
{'0': {'precision': 0.47911720742108505, 'recall': 0.4925872355812692, 'f1-score': 0.4857588589257856, 'support': 55310}, '1': {'precision': 0.8206674504979405, 'recall': 0.8108030140432259, 'f1-score': 0.8157054103679855, 'support': 259983}, '2': {'precision': 0.4172217621430886, 'recall': 0.4293574922187639, 'f1-score': 0.4232026442176001, 'support': 53976}, 'accuracy': 0.7073840479433692, 'macro avg': {'precision': 0.572335473354038, 'recall': 0.5775825806144197, 'f1-score': 0.574888971170457, 'support': 369269}, 'weighted avg': {'precision': 0.7105376307209694, 'recall': 0.7073840479433692, 'f1-score': 0.7089131449300492, 'support': 369269}}
[[ 27245  21275   6790]
 [ 23607 210795  25581]
 [  6013  24788  23175]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9096627
{'0': {'precision': 0.4768638768638769, 'recall': 0.4858017885581281, 'f1-score': 0.48129134049396205, 'support': 40815}, '1': {'precision': 0.6884809317520062, 'recall': 0.69666083790452, 'f1-score': 0.6925467317537802, 'support': 83494}, '2': {'precision': 0.47926752262681543, 'recall': 0.4580912863070539, 'f1-score': 0.4684402041839713, 'support': 39765}, 'accuracy': 0.5863878493850336, 'macro avg': {'precision': 0.5482041104142329, 'recall': 0.5468513042565674, 'f1-score': 0.5474260921439046, 'support': 164074}, 'weighted avg': {'precision': 0.5851341412238165, 'recall': 0.5863878493850336, 'f1-score': 0.5856804100752514, 'support': 164074}}
[[19828 13171  7816]
 [13351 58167 11976]
 [ 8401 13148 18216]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8641311
{'0': {'precision': 0.4791162613014135, 'recall': 0.49696209219389775, 'f1-score': 0.48787603734439833, 'support': 15142}, '1': {'precision': 0.7121178418724203, 'recall': 0.7280238522374106, 'f1-score': 0.7199830080711661, 'support': 39577}, '2': {'precision': 0.4940881404514511, 'recall': 0.44764007011621115, 'f1-score': 0.46971864568431093, 'support': 15403}, 'accuracy': 0.6165397450158295, 'macro avg': {'precision': 0.5617740812084283, 'recall': 0.5575420048491732, 'f1-score': 0.5591925636999585, 'support': 70122}, 'weighted avg': {'precision': 0.6139115524911509, 'recall': 0.6165397450158295, 'f1-score': 0.6148892325857344, 'support': 70122}}
[[ 7525  5629  1988]
 [ 5692 28813  5072]
 [ 2489  6019  6895]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
1359/1359 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2013342
{'0': {'precision': 0.41625817260810094, 'recall': 0.5556060275169251, 'f1-score': 0.47594211140710585, 'support': 114475}, '1': {'precision': 0.4699517451671157, 'recall': 0.26216093472606417, 'f1-score': 0.3365683785373921, 'support': 121105}, '2': {'precision': 0.4160480846188854, 'recall': 0.4724952547296755, 'f1-score': 0.44247868846986765, 'support': 112217}, 'accuracy': 0.42661092533863143, 'macro avg': {'precision': 0.434086000798034, 'recall': 0.43008740565755493, 'f1-score': 0.41832972613812186, 'support': 347797}, 'weighted avg': {'precision': 0.43488681132802576, 'recall': 0.42661092533863143, 'f1-score': 0.41661434017579924, 'support': 347797}}
[[63603 17030 33842]
 [48778 31749 40578]
 [40416 18779 53022]]
Evaluating performance on  train set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2335784
{'0': {'precision': 0.3967789707515735, 'recall': 0.5713143375003332, 'f1-score': 0.4683133596250696, 'support': 37517}, '1': {'precision': 0.49143379906852963, 'recall': 0.15727974447697632, 'f1-score': 0.2382949550348833, 'support': 37570}, '2': {'precision': 0.4141426888776712, 'recall': 0.5114152879145997, 'f1-score': 0.45766749956418157, 'support': 38501}, 'accuracy': 0.4140666267563475, 'macro avg': {'precision': 0.43411848623259147, 'recall': 0.4133364566306364, 'f1-score': 0.3880919380747115, 'support': 113588}, 'weighted avg': {'precision': 0.43397218140270677, 'recall': 0.4140666267563475, 'f1-score': 0.38862476823638814, 'support': 113588}}
[[21434  2683 13400]
 [17207  5909 14454]
 [15379  3432 19690]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1894798
{'0': {'precision': 0.40836700736867126, 'recall': 0.557385027171709, 'f1-score': 0.47137908563981207, 'support': 12329}, '1': {'precision': 0.49723440778180433, 'recall': 0.21735867933966985, 'f1-score': 0.3024888321633695, 'support': 11994}, '2': {'precision': 0.4157573261958685, 'recall': 0.4917606948615959, 'f1-score': 0.45057642246188173, 'support': 12319}, 'accuracy': 0.424021614540691, 'macro avg': {'precision': 0.4404529137821147, 'recall': 0.42216813379099155, 'f1-score': 0.4081481134216878, 'support': 36642}, 'weighted avg': {'precision': 0.4399405278693907, 'recall': 0.424021614540691, 'f1-score': 0.4091025257390049, 'support': 36642}}
[[6872 1212 4245]
 [5119 2607 4268]
 [4837 1424 6058]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3799899
{'0': {'precision': 0.35185584706732076, 'recall': 0.38989075866083217, 'f1-score': 0.3698981352739895, 'support': 96209}, '1': {'precision': 0.5265324794144556, 'recall': 0.011578428512508928, 'f1-score': 0.022658595403317095, 'support': 99409}, '2': {'precision': 0.3487522291390873, 'recall': 0.6642217892751842, 'f1-score': 0.4573638127759704, 'support': 95983}, 'accuracy': 0.3512196460231618, 'macro avg': {'precision': 0.4090468518736212, 'recall': 0.3552303254828417, 'f1-score': 0.283306847817759, 'support': 291601}, 'weighted avg': {'precision': 0.41038285755559306, 'recall': 0.3512196460231618, 'f1-score': 0.2803116204975277, 'support': 291601}}
[[37511   555 58143]
 [37349  1151 60909]
 [31749   480 63754]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3392084
{'0': {'precision': 0.37781322505800463, 'recall': 0.38552826279964486, 'f1-score': 0.3816317562619013, 'support': 33790}, '1': {'precision': 0.5795116140559857, 'recall': 0.030134101396760506, 'f1-score': 0.05728921337729627, 'support': 32289}, '2': {'precision': 0.35257553124849417, 'recall': 0.6787779461331519, 'f1-score': 0.46409014989746084, 'support': 32339}, 'accuracy': 0.3652888699221687, 'macro avg': {'precision': 0.4366334567874948, 'recall': 0.36481343677651906, 'f1-score': 0.30100370651221947, 'support': 98418}, 'weighted avg': {'precision': 0.4356936686989042, 'recall': 0.3652888699221687, 'f1-score': 0.3023162410571557, 'support': 98418}}
[[13027   377 20386]
 [11394   973 19922]
 [10059   329 21951]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3542026
{'0': {'precision': 0.3723145071982281, 'recall': 0.40827396373056996, 'f1-score': 0.3894659613082597, 'support': 12352}, '1': {'precision': 0.6405867970660146, 'recall': 0.022111570596674825, 'f1-score': 0.04274759340838636, 'support': 11849}, '2': {'precision': 0.33090535555866835, 'recall': 0.6344673231871083, 'f1-score': 0.4349587258722804, 'support': 11170}, 'accuracy': 0.3503435017387125, 'macro avg': {'precision': 0.4479355532743037, 'recall': 0.3549509525047843, 'f1-score': 0.2890574268629755, 'support': 35371}, 'weighted avg': {'precision': 0.44910674204681933, 'recall': 0.3503435017387125, 'f1-score': 0.2876845086757221, 'support': 35371}}
[[5043   92 7217]
 [4474  262 7113]
 [4028   55 7087]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
2282/2282 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1858162
{'0': {'precision': 0.41372254919542856, 'recall': 0.5211716684209176, 'f1-score': 0.4612724459400199, 'support': 194765}, '1': {'precision': 0.4716729108975403, 'recall': 0.22793538839384112, 'f1-score': 0.3073461199622132, 'support': 190554}, '2': {'precision': 0.428872719603501, 'recall': 0.5322441008295079, 'f1-score': 0.4749994384924645, 'support': 198672}, 'accuracy': 0.429256615256057, 'macro avg': {'precision': 0.4380893932321566, 'recall': 0.4271170525480888, 'f1-score': 0.4145393347982325, 'support': 583991}, 'weighted avg': {'precision': 0.43778557050756656, 'recall': 0.429256615256057, 'f1-score': 0.41571676433534505, 'support': 583991}}
[[101506  24271  68988]
 [ 75292  43434  71828]
 [ 68550  24380 105742]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1984649
{'0': {'precision': 0.4076496003227142, 'recall': 0.5167675952092585, 'f1-score': 0.4557684661535449, 'support': 74310}, '1': {'precision': 0.4804346617753321, 'recall': 0.23241775232256418, 'f1-score': 0.31328095975933534, 'support': 74379}, '2': {'precision': 0.4185050445229383, 'recall': 0.5203413453952559, 'f1-score': 0.4639001230877439, 'support': 76052}, 'accuracy': 0.4238701438544814, 'macro avg': {'precision': 0.4355297688736615, 'recall': 0.4231755643090262, 'f1-score': 0.41098318300020803, 'support': 224741}, 'weighted avg': {'precision': 0.4354115944764276, 'recall': 0.4238701438544814, 'f1-score': 0.4113633533128295, 'support': 224741}}
[[38401  8681 27228]
 [29335 17287 27757]
 [26465 10014 39573]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2152948
{'0': {'precision': 0.40689273526608666, 'recall': 0.5236606789586136, 'f1-score': 0.4579505544886766, 'support': 25274}, '1': {'precision': 0.4543535235876529, 'recall': 0.23599924371336736, 'f1-score': 0.3106443343868993, 'support': 26445}, '2': {'precision': 0.41962448559670784, 'recall': 0.5088895820336868, 'f1-score': 0.45996616859317735, 'support': 25648}, 'accuracy': 0.4204376542970517, 'macro avg': {'precision': 0.42695691481681575, 'recall': 0.4228498349018892, 'f1-score': 0.40952035248958446, 'support': 77367}, 'weighted avg': {'precision': 0.42733613464364545, 'recall': 0.4204376542970517, 'f1-score': 0.4082676597139113, 'support': 77367}}
[[13235  3600  8439]
 [10591  6241  9613]
 [ 8701  3895 13052]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/EXC
Evaluating performance on  test set...
5098/5098 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6995355
{'0': {'precision': 0.5254775650313176, 'recall': 0.5609414657360406, 'f1-score': 0.5426306925641331, 'support': 252160}, '1': {'precision': 0.7550960053325385, 'recall': 0.8121773230565451, 'f1-score': 0.7825971911255851, 'support': 804791}, '2': {'precision': 0.562880658436214, 'recall': 0.38614108954814563, 'f1-score': 0.45805346652123163, 'support': 247956}, 'accuracy': 0.6826739376829153, 'macro avg': {'precision': 0.6144847429333568, 'recall': 0.5864199594469105, 'f1-score': 0.5944271167369833, 'support': 1304907}, 'weighted avg': {'precision': 0.6742001756210104, 'recall': 0.6826739376829153, 'f1-score': 0.6745569123507354, 'support': 1304907}}
[[141447  89169  21544]
 [ 98348 653633  52810]
 [ 29383 122827  95746]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7091339
{'0': {'precision': 0.5092534700512692, 'recall': 0.5344897356534293, 'f1-score': 0.5215665138716201, 'support': 91433}, '1': {'precision': 0.761553924636362, 'recall': 0.8166658193095735, 'f1-score': 0.7881476102390989, 'support': 295035}, '2': {'precision': 0.5751528995652494, 'recall': 0.4163457332750141, 'f1-score': 0.48303133818505867, 'support': 93737}, 'accuracy': 0.6847950354536083, 'macro avg': {'precision': 0.6153200980842936, 'recall': 0.5891670960793389, 'f1-score': 0.5975818207652592, 'support': 480205}, 'weighted avg': {'precision': 0.6771290220402423, 'recall': 0.6847950354536083, 'f1-score': 0.6778301554485463, 'support': 480205}}
[[ 48870  32536  10027]
 [ 35289 240945  18801]
 [ 11805  42905  39027]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67796165
{'0': {'precision': 0.5096871781668383, 'recall': 0.5666392357508319, 'f1-score': 0.5366564443164297, 'support': 27949}, '1': {'precision': 0.7700320732476219, 'recall': 0.8288580702272057, 'f1-score': 0.7983629154883543, 'support': 101670}, '2': {'precision': 0.6039299109891956, 'recall': 0.3751956317601642, 'f1-score': 0.46284537497854816, 'support': 28753}, 'accuracy': 0.7002184729623924, 'macro avg': {'precision': 0.6278830541345519, 'recall': 0.5902309792460673, 'f1-score': 0.5992882449277773, 'support': 158372}, 'weighted avg': {'precision': 0.6939307741289055, 'recall': 0.7002184729623924, 'f1-score': 0.6912633650308075, 'support': 158372}}
[[15837 10106  2006]
 [12331 84270  5069]
 [ 2904 15061 10788]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/AAL
Evaluating performance on  test set...
5760/5760 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7473006
{'0': {'precision': 0.4824654622741764, 'recall': 0.5087878524808814, 'f1-score': 0.49527716637665126, 'support': 253418}, '1': {'precision': 0.7915985442991739, 'recall': 0.792053286937185, 'f1-score': 0.7918258503289338, 'support': 971345}, '2': {'precision': 0.4778131905490396, 'recall': 0.45028914234453593, 'f1-score': 0.463643036220888, 'support': 249704}, 'accuracy': 0.6854897396822038, 'macro avg': {'precision': 0.5839590657074633, 'recall': 0.5837100939208675, 'f1-score': 0.5835820176421577, 'support': 1474467}, 'weighted avg': {'precision': 0.6853273660676947, 'recall': 0.6854897396822038, 'f1-score': 0.6852793248360913, 'support': 1474467}}
[[128936  94739  29743]
 [108850 769357  93138]
 [ 29458 107807 112439]]
Evaluating performance on  train set...
2159/2159 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8455328
{'0': {'precision': 0.4967393398645344, 'recall': 0.5218978954662598, 'f1-score': 0.5090079315359235, 'support': 128437}, '1': {'precision': 0.6884855360181509, 'recall': 0.7421533193836789, 'f1-score': 0.7143128036460411, 'support': 294392}, '2': {'precision': 0.5347510373443983, 'recall': 0.413325212591262, 'f1-score': 0.4662622573000239, 'support': 129709}, 'accuracy': 0.6137623113704397, 'macro avg': {'precision': 0.5733253044090278, 'recall': 0.5591254758137335, 'f1-score': 0.5631943308273295, 'support': 552538}, 'weighted avg': {'precision': 0.6078249221167435, 'recall': 0.6137623113704397, 'f1-score': 0.608359674313393, 'support': 552538}}
[[ 67031  44990  16416]
 [ 45680 218484  30228]
 [ 22231  53866  53612]]
Evaluating performance on  val set...
850/850 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7960844
{'0': {'precision': 0.5097262247838616, 'recall': 0.5085301143690675, 'f1-score': 0.5091274670617493, 'support': 47303}, '1': {'precision': 0.7095983712752175, 'recall': 0.7803640922931627, 'f1-score': 0.7433007239211945, 'support': 122826}, '2': {'precision': 0.5516848166942243, 'recall': 0.4098610640460861, 'f1-score': 0.47031375312902524, 'support': 47216}, 'accuracy': 0.6407140720973568, 'macro avg': {'precision': 0.5903364709177679, 'recall': 0.5662517569027721, 'f1-score': 0.5742473147039897, 'support': 217345}, 'weighted avg': {'precision': 0.6317930454633663, 'recall': 0.6407140720973568, 'f1-score': 0.6330315648324397, 'support': 217345}}
[[24055 18002  5246]
 [16497 95849 10480]
 [ 6640 21224 19352]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/WBA
Evaluating performance on  test set...
6315/6315 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8111362
{'0': {'precision': 0.5227138346186265, 'recall': 0.4591731016286555, 'f1-score': 0.4888875161602034, 'support': 361955}, '1': {'precision': 0.6856198641694886, 'recall': 0.8109506402637303, 'f1-score': 0.7430373192292045, 'support': 891820}, '2': {'precision': 0.5598921350528243, 'recall': 0.3761370749152795, 'f1-score': 0.44997781629916495, 'support': 362663}, 'accuracy': 0.6346256398327681, 'macro avg': {'precision': 0.5894086112803131, 'recall': 0.5487536056025552, 'f1-score': 0.5606342172295243, 'support': 1616438}, 'weighted avg': {'precision': 0.6209335307928178, 'recall': 0.6346256398327681, 'f1-score': 0.6203771055489041, 'support': 1616438}}
[[166200 156997  38758]
 [100129 723222  68469]
 [ 51627 174625 136411]]
Evaluating performance on  train set...
2155/2155 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8670691
{'0': {'precision': 0.5163941101133411, 'recall': 0.5044767483908296, 'f1-score': 0.5103658692733466, 'support': 138270}, '1': {'precision': 0.6523986999056175, 'recall': 0.7482156315112826, 'f1-score': 0.6970297166004442, 'support': 270684}, '2': {'precision': 0.5555964271903266, 'recall': 0.41312321600145874, 'f1-score': 0.4738827883029645, 'support': 142587}, 'accuracy': 0.6004811972274047, 'macro avg': {'precision': 0.5747964124030951, 'recall': 0.5552718653011902, 'f1-score': 0.5604261247255851, 'support': 551541}, 'weighted avg': {'precision': 0.5932768933849178, 'recall': 0.6004811972274047, 'f1-score': 0.592544535562098, 'support': 551541}}
[[ 69754  49353  19163]
 [ 40200 202530  27954]
 [ 25125  58556  58906]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8175932
{'0': {'precision': 0.5242216672024531, 'recall': 0.49317203675700827, 'f1-score': 0.5082230533179901, 'support': 42985}, '1': {'precision': 0.6895746565871511, 'recall': 0.7982325822127228, 'f1-score': 0.7399358524428492, 'support': 104333}, '2': {'precision': 0.557530212247385, 'recall': 0.37918729135489815, 'f1-score': 0.451381276035957, 'support': 43435}, 'accuracy': 0.6340712859037604, 'macro avg': {'precision': 0.5904421786789964, 'recall': 0.5568639701082098, 'f1-score': 0.5665133939322654, 'support': 190753}, 'weighted avg': {'precision': 0.6222464956219291, 'recall': 0.6340712859037604, 'f1-score': 0.6220161201365924, 'support': 190753}}
[[21199 16999  4787]
 [12767 83282  8284]
 [ 6473 20492 16470]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
6082/6082 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9318238
{'0': {'precision': 0.5086652288000696, 'recall': 0.45510089509000723, 'f1-score': 0.48039455878297344, 'support': 411467}, '1': {'precision': 0.6320038619801843, 'recall': 0.7438628769328589, 'f1-score': 0.6833862578532324, 'support': 739190}, '2': {'precision': 0.5198781077196352, 'recall': 0.40787358147253555, 'f1-score': 0.45711486854722433, 'support': 406143}, 'accuracy': 0.5798882322713258, 'macro avg': {'precision': 0.5535157328332964, 'recall': 0.5356124511651339, 'f1-score': 0.5402985617278101, 'support': 1556800}, 'weighted avg': {'precision': 0.5701533560761732, 'recall': 0.5798882322713258, 'f1-score': 0.5707045220437178, 'support': 1556800}}
[[187259 155719  68489]
 [104836 549856  84498]
 [ 76043 164445 165655]]
Evaluating performance on  train set...
2440/2440 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0001861
{'0': {'precision': 0.5019912676980541, 'recall': 0.49321807785200283, 'f1-score': 0.49756600309190147, 'support': 201639}, '1': {'precision': 0.5370407878595641, 'recall': 0.6341945528803845, 'f1-score': 0.5815882265300379, 'support': 221585}, '2': {'precision': 0.5152519129363649, 'recall': 0.4216953630544147, 'f1-score': 0.4638027091981647, 'support': 201361}, 'accuracy': 0.5201741956659222, 'macro avg': {'precision': 0.518094656164661, 'recall': 0.5163693312622674, 'f1-score': 0.5143189796067014, 'support': 624585}, 'weighted avg': {'precision': 0.518700962472696, 'recall': 0.5201741956659222, 'f1-score': 0.516489694437039, 'support': 624585}}
[[ 99452  57345  44842]
 [ 46013 140528  35044]
 [ 52650  63798  84913]]
Evaluating performance on  val set...
826/826 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9394123
{'0': {'precision': 0.5092495636998254, 'recall': 0.4863090178824392, 'f1-score': 0.4975149825665158, 'support': 60003}, '1': {'precision': 0.5952438947377917, 'recall': 0.7114314672647287, 'f1-score': 0.648172070474628, 'support': 92744}, '2': {'precision': 0.5238271234205724, 'recall': 0.38637951304288565, 'f1-score': 0.4447255398011414, 'support': 58691}, 'accuracy': 0.5573170385644964, 'macro avg': {'precision': 0.5427735272860632, 'recall': 0.5280399993966846, 'f1-score': 0.5301375309474284, 'support': 211438}, 'weighted avg': {'precision': 0.5510160853059488, 'recall': 0.5573170385644964, 'f1-score': 0.5489450744875866, 'support': 211438}}
[[29180 21301  9522]
 [15671 65981 11092]
 [12449 23565 22677]]
testing model on single stock: results/universal/W3/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
13689/13689 - 102s - 102s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2412404
{'0': {'precision': 0.44712053159040327, 'recall': 0.5985468768170182, 'f1-score': 0.5118694445144789, 'support': 1221094}, '1': {'precision': 0.3718765171202559, 'recall': 0.025096119564065256, 'f1-score': 0.04701914779148658, 'support': 1037770}, '2': {'precision': 0.4460836668396713, 'recall': 0.6445890324062252, 'f1-score': 0.5272720943307988, 'support': 1245378}, 'accuracy': 0.44508427214787105, 'macro avg': {'precision': 0.4216935718501102, 'recall': 0.4227440095957696, 'f1-score': 0.36205356221225476, 'support': 3504242}, 'weighted avg': {'precision': 0.4244687656888982, 'recall': 0.44508427214787105, 'f1-score': 0.37967949553057, 'support': 3504242}}
[[730882  21754 468458]
 [483375  26044 528351]
 [420385  22236 802757]]
Evaluating performance on  train set...
5475/5475 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3119941
{'0': {'precision': 0.4197023245208751, 'recall': 0.6028644935530579, 'f1-score': 0.4948794051266087, 'support': 464096}, '1': {'precision': 0.4174713165966148, 'recall': 0.03170973726217697, 'f1-score': 0.05894240485011789, 'support': 463580}, '2': {'precision': 0.42290998840966615, 'recall': 0.6244479192384714, 'f1-score': 0.5042884774328781, 'support': 473889}, 'accuracy': 0.4212476767042556, 'macro avg': {'precision': 0.420027876509052, 'recall': 0.4196740500179021, 'f1-score': 0.3527034291365349, 'support': 1401565}, 'weighted avg': {'precision': 0.420048955593331, 'recall': 0.4212476767042556, 'f1-score': 0.3538707335901263, 'support': 1401565}}
[[279787   9292 175017]
 [220095  14700 228785]
 [166750  11220 295919]]
Evaluating performance on  val set...
2036/2036 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2378219
{'0': {'precision': 0.4388826921333612, 'recall': 0.6277489951122712, 'f1-score': 0.5165947575968453, 'support': 177383}, '1': {'precision': 0.5047757741894033, 'recall': 0.0728890923035056, 'f1-score': 0.12738405996832963, 'support': 161684}, '2': {'precision': 0.4592180281136341, 'recall': 0.6155345349137245, 'f1-score': 0.5260086183236726, 'support': 182149}, 'accuracy': 0.4513598968565815, 'macro avg': {'precision': 0.46762549814546617, 'recall': 0.43872420744316704, 'f1-score': 0.3899958119629492, 'support': 521216}, 'weighted avg': {'precision': 0.46642965575807693, 'recall': 0.4513598968565815, 'f1-score': 0.399149366208557, 'support': 521216}}
[[111352   4539  61492]
 [ 79358  11785  70541]
 [ 63007   7023 112119]]
training model: results/universal/W3/deepVOL_L2/h10
Epoch 1/50
10532/10532 - 342s - loss: 2.7145 - accuracy10: 0.5481 - val_loss: 2.8372 - val_accuracy10: 0.5652 - 342s/epoch - 32ms/step
Epoch 2/50
10532/10532 - 340s - loss: 2.6277 - accuracy10: 0.5712 - val_loss: 2.7410 - val_accuracy10: 0.5787 - 340s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 341s - loss: 2.5942 - accuracy10: 0.5785 - val_loss: 2.7409 - val_accuracy10: 0.5797 - 341s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 337s - loss: 2.5745 - accuracy10: 0.5821 - val_loss: 2.7163 - val_accuracy10: 0.5834 - 337s/epoch - 32ms/step
Epoch 5/50
10532/10532 - 335s - loss: 2.5598 - accuracy10: 0.5844 - val_loss: 2.7127 - val_accuracy10: 0.5820 - 335s/epoch - 32ms/step
Epoch 6/50
10532/10532 - 339s - loss: 2.5490 - accuracy10: 0.5864 - val_loss: 2.6983 - val_accuracy10: 0.5823 - 339s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 339s - loss: 2.5408 - accuracy10: 0.5879 - val_loss: 2.6762 - val_accuracy10: 0.5835 - 339s/epoch - 32ms/step
Epoch 8/50
10532/10532 - 338s - loss: 2.5338 - accuracy10: 0.5889 - val_loss: 2.6667 - val_accuracy10: 0.5845 - 338s/epoch - 32ms/step
Epoch 9/50
10532/10532 - 337s - loss: 2.5279 - accuracy10: 0.5899 - val_loss: 2.6685 - val_accuracy10: 0.5825 - 337s/epoch - 32ms/step
Epoch 10/50
10532/10532 - 340s - loss: 2.5229 - accuracy10: 0.5906 - val_loss: 2.6553 - val_accuracy10: 0.5836 - 340s/epoch - 32ms/step
Epoch 11/50
10532/10532 - 339s - loss: 2.5182 - accuracy10: 0.5915 - val_loss: 2.6664 - val_accuracy10: 0.5806 - 339s/epoch - 32ms/step
Epoch 12/50
10532/10532 - 345s - loss: 2.5141 - accuracy10: 0.5923 - val_loss: 2.6509 - val_accuracy10: 0.5817 - 345s/epoch - 33ms/step
Epoch 13/50
10532/10532 - 338s - loss: 2.5104 - accuracy10: 0.5929 - val_loss: 2.6495 - val_accuracy10: 0.5795 - 338s/epoch - 32ms/step
Epoch 14/50
10532/10532 - 337s - loss: 2.5072 - accuracy10: 0.5935 - val_loss: 2.6627 - val_accuracy10: 0.5797 - 337s/epoch - 32ms/step
Epoch 15/50
10532/10532 - 342s - loss: 2.5040 - accuracy10: 0.5942 - val_loss: 2.6484 - val_accuracy10: 0.5803 - 342s/epoch - 32ms/step
Epoch 16/50
10532/10532 - 345s - loss: 2.5010 - accuracy10: 0.5947 - val_loss: 2.6541 - val_accuracy10: 0.5782 - 345s/epoch - 33ms/step
Epoch 17/50
10532/10532 - 342s - loss: 2.4989 - accuracy10: 0.5950 - val_loss: 2.6493 - val_accuracy10: 0.5792 - 342s/epoch - 32ms/step
Epoch 18/50
10532/10532 - 345s - loss: 2.4965 - accuracy10: 0.5957 - val_loss: 2.6398 - val_accuracy10: 0.5798 - 345s/epoch - 33ms/step
Epoch 19/50
10532/10532 - 359s - loss: 2.4942 - accuracy10: 0.5959 - val_loss: 2.6347 - val_accuracy10: 0.5810 - 359s/epoch - 34ms/step
Epoch 20/50
10532/10532 - 352s - loss: 2.4919 - accuracy10: 0.5964 - val_loss: 2.6529 - val_accuracy10: 0.5786 - 352s/epoch - 33ms/step
Epoch 21/50
10532/10532 - 359s - loss: 2.4899 - accuracy10: 0.5967 - val_loss: 2.6474 - val_accuracy10: 0.5809 - 359s/epoch - 34ms/step
Epoch 22/50
10532/10532 - 358s - loss: 2.4881 - accuracy10: 0.5970 - val_loss: 2.6511 - val_accuracy10: 0.5789 - 358s/epoch - 34ms/step
Epoch 23/50
10532/10532 - 362s - loss: 2.4861 - accuracy10: 0.5973 - val_loss: 2.6433 - val_accuracy10: 0.5804 - 362s/epoch - 34ms/step
Epoch 24/50
10532/10532 - 357s - loss: 2.4846 - accuracy10: 0.5978 - val_loss: 2.6412 - val_accuracy10: 0.5804 - 357s/epoch - 34ms/step
Epoch 25/50
10532/10532 - 339s - loss: 2.4830 - accuracy10: 0.5980 - val_loss: 2.6636 - val_accuracy10: 0.5771 - 339s/epoch - 32ms/step
Epoch 26/50
10532/10532 - 343s - loss: 2.4815 - accuracy10: 0.5984 - val_loss: 2.6366 - val_accuracy10: 0.5794 - 343s/epoch - 33ms/step
Epoch 27/50
10532/10532 - 339s - loss: 2.4796 - accuracy10: 0.5986 - val_loss: 2.6403 - val_accuracy10: 0.5807 - 339s/epoch - 32ms/step
Epoch 28/50
10532/10532 - 340s - loss: 2.4785 - accuracy10: 0.5990 - val_loss: 2.6400 - val_accuracy10: 0.5805 - 340s/epoch - 32ms/step
Epoch 29/50
10532/10532 - 334s - loss: 2.4772 - accuracy10: 0.5990 - val_loss: 2.6505 - val_accuracy10: 0.5804 - 334s/epoch - 32ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 426s - 426s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8840732
{'0': {'precision': 0.4122415573931058, 'recall': 0.6997361377877137, 'f1-score': 0.5188239232783122, 'support': 1587950}, '1': {'precision': 0.8158636515611698, 'recall': 0.5965058823740875, 'f1-score': 0.6891503330795429, 'support': 3894431}, '2': {'precision': 0.4871944856320555, 'recall': 0.46886595315991064, 'f1-score': 0.4778545322276033, 'support': 1604096}, 'accuracy': 0.5907453026376859, 'macro avg': {'precision': 0.5717665648621103, 'recall': 0.5883693244405707, 'f1-score': 0.5619429295284861, 'support': 7086477}, 'weighted avg': {'precision': 0.6510217140477332, 'recall': 0.5907453026376859, 'f1-score': 0.6031543478520093, 'support': 7086477}}
[[1111146  244594  232210]
 [1011947 2323051  559433]
 [ 572283  279707  752106]]
Evaluating performance on  train set...
10532/10532 - 165s - 165s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.922038
{'0': {'precision': 0.4192362103369577, 'recall': 0.7063210333204069, 'f1-score': 0.5261666698147484, 'support': 670460}, '1': {'precision': 0.8125344435289816, 'recall': 0.5543552066519349, 'f1-score': 0.6590622722100586, 'support': 1343128}, '2': {'precision': 0.4882369686478169, 'recall': 0.46508897423118645, 'f1-score': 0.47638193972652104, 'support': 682220}, 'accuracy': 0.5695594790133423, 'macro avg': {'precision': 0.5733358741712521, 'recall': 0.575255071401176, 'f1-score': 0.5538702939171093, 'support': 2695808}, 'weighted avg': {'precision': 0.6326503580379702, 'recall': 0.5695594790133423, 'f1-score': 0.5797801564181035, 'support': 2695808}}
[[473560  80061 116839]
 [382815 744570 215743]
 [273203  91724 317293]]
Evaluating performance on  val set...
3814/3814 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9013564
{'0': {'precision': 0.41216557029066225, 'recall': 0.6956625843583445, 'f1-score': 0.5176401495280233, 'support': 225526}, '1': {'precision': 0.8146314915849195, 'recall': 0.5779981774232162, 'f1-score': 0.6762106651698641, 'support': 517948}, '2': {'precision': 0.4861699137431267, 'recall': 0.4764009450811453, 'f1-score': 0.4812358576077104, 'support': 232361}, 'accuracy': 0.58099986165694, 'macro avg': {'precision': 0.5709889918729029, 'recall': 0.5833539022875687, 'f1-score': 0.5583622241018659, 'support': 975835}, 'weighted avg': {'precision': 0.6434056285499746, 'recall': 0.58099986165694, 'f1-score': 0.5931368715771037, 'support': 975835}}
[[156890  31751  36885]
 [138465 299373  80110]
 [ 85293  36371 110697]]
testing model out of sample: results/universal/W3/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 251s - 251s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76135844
{'0': {'precision': 0.4249612731153134, 'recall': 0.6296122372890539, 'f1-score': 0.5074294305472233, 'support': 775139}, '1': {'precision': 0.8287809489177367, 'recall': 0.7262007279752304, 'f1-score': 0.7741072931980151, 'support': 2586077}, '2': {'precision': 0.4910282475860197, 'recall': 0.4573303734164724, 'f1-score': 0.4735806199329322, 'support': 775247}, 'accuracy': 0.6577097389726441, 'macro avg': {'precision': 0.5815901565396899, 'recall': 0.6043811128935855, 'f1-score': 0.5850391145593902, 'support': 4136463}, 'weighted avg': {'precision': 0.6898075921800785, 'recall': 0.657709738972644, 'f1-score': 0.6678100016119408, 'support': 4136463}}
[[ 488037  181915  105187]
 [ 445753 1878011  262313]
 [ 214637  206066  354544]]
Evaluating performance on  train set...
6181/6181 - 96s - 96s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85981727
{'0': {'precision': 0.43514364538550776, 'recall': 0.6273732086737017, 'f1-score': 0.5138694299229712, 'support': 355742}, '1': {'precision': 0.775330174892434, 'recall': 0.6571829567465854, 'f1-score': 0.7113844411431964, 'support': 867839}, '2': {'precision': 0.48953035880911017, 'recall': 0.4554892994533872, 'f1-score': 0.47189672351385314, 'support': 358206}, 'accuracy': 0.6048039337786946, 'macro avg': {'precision': 0.566668059695684, 'recall': 0.5800151549578915, 'f1-score': 0.5657168648600069, 'support': 1581787}, 'weighted avg': {'precision': 0.6341013967448097, 'recall': 0.6048039337786946, 'f1-score': 0.6127299936716709, 'support': 1581787}}
[[223183  76854  55705]
 [183077 570329 114433]
 [106635  88412 163159]]
Evaluating performance on  val set...
2209/2209 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78442013
{'0': {'precision': 0.4433031334756766, 'recall': 0.6120140216698534, 'f1-score': 0.5141728857802617, 'support': 112968}, '1': {'precision': 0.8019239722748644, 'recall': 0.7202421793788264, 'f1-score': 0.7588914900779892, 'support': 339583}, '2': {'precision': 0.4956490734405566, 'recall': 0.4585157120570537, 'f1-score': 0.47635983069841537, 'support': 112175}, 'accuracy': 0.6466038397382093, 'macro avg': {'precision': 0.5802920597303659, 'recall': 0.5969239710352445, 'f1-score': 0.5831414021855554, 'support': 564726}, 'weighted avg': {'precision': 0.6693480581249844, 'recall': 0.6466038397382093, 'f1-score': 0.6538168872064916, 'support': 564726}}
[[ 69138  28509  15321]
 [ 57985 244582  37016]
 [ 28838  31903  51434]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.379098
{'0': {'precision': 0.3144932992019274, 'recall': 0.8574390344034813, 'f1-score': 0.4601952229860743, 'support': 48716}, '1': {'precision': 0.5758403361344537, 'recall': 0.03645286130357879, 'f1-score': 0.06856528210323565, 'support': 75193}, '2': {'precision': 0.4051435273092818, 'recall': 0.2932118101166057, 'f1-score': 0.34020751509467145, 'support': 49483}, 'accuracy': 0.34039056011811386, 'macro avg': {'precision': 0.43182572088188764, 'recall': 0.39570123527455525, 'f1-score': 0.2896560067279938, 'support': 173392}, 'weighted avg': {'precision': 0.4536987584244041, 'recall': 0.34039056011811386, 'f1-score': 0.2561190147735064, 'support': 173392}}
[[41771   854  6091]
 [57240  2741 15212]
 [33809  1165 14509]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3783334
{'0': {'precision': 0.32226030225452146, 'recall': 0.8216128013475102, 'f1-score': 0.4629415428418898, 'support': 18998}, '1': {'precision': 0.5788894997251237, 'recall': 0.036491544219573055, 'f1-score': 0.06865525672371639, 'support': 28856}, '2': {'precision': 0.37675749657832525, 'recall': 0.3277943166441137, 'f1-score': 0.3505745462965643, 'support': 18475}, 'accuracy': 0.34250478674486273, 'macro avg': {'precision': 0.42596909951932344, 'recall': 0.39529955407039896, 'f1-score': 0.29405711528739015, 'support': 66329}, 'weighted avg': {'precision': 0.4490845840519852, 'recall': 0.34250478674486273, 'f1-score': 0.26011162932893317, 'support': 66329}}
[[15609   368  3021]
 [20806  1053  6997]
 [12021   398  6056]]
Evaluating performance on  val set...
86/86 - 1s - 783ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.372709
{'0': {'precision': 0.33170355120946987, 'recall': 0.805625, 'f1-score': 0.4699234414874225, 'support': 6400}, '1': {'precision': 0.5063559322033898, 'recall': 0.025687876182287187, 'f1-score': 0.048895253682487726, 'support': 9304}, '2': {'precision': 0.3965866846907739, 'recall': 0.37672552166934187, 'f1-score': 0.3864010536713862, 'support': 6230}, 'accuracy': 0.35296799489377223, 'macro avg': {'precision': 0.4115487227012112, 'recall': 0.40267946595054305, 'f1-score': 0.3017399162804321, 'support': 21934}, 'weighted avg': {'precision': 0.42421689461951617, 'recall': 0.35296799489377223, 'f1-score': 0.2676078248451767, 'support': 21934}}
[[5156  113 1131]
 [6625  239 2440]
 [3763  120 2347]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.508545
{'0': {'precision': 0.45109424939615, 'recall': 0.5410886742756804, 'f1-score': 0.4920100589432787, 'support': 34170}, '1': {'precision': 0.9180371554743414, 'recall': 0.8784278272848595, 'f1-score': 0.897795828573846, 'support': 301977}, '2': {'precision': 0.40019828155981496, 'recall': 0.475246030308519, 'f1-score': 0.43450540958268935, 'support': 33126}, 'accuracy': 0.8110449450677412, 'macro avg': {'precision': 0.5897765621434354, 'recall': 0.6315875106230197, 'f1-score': 0.608103765699938, 'support': 369273}, 'weighted avg': {'precision': 0.8283762010098006, 'recall': 0.8110449450677412, 'f1-score': 0.8186872607452272, 'support': 369273}}
[[ 18489  11534   4147]
 [ 17264 265265  19448]
 [  5234  12149  15743]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7311219
{'0': {'precision': 0.4234475801099105, 'recall': 0.5744642535566361, 'f1-score': 0.48752903777967965, 'support': 27765}, '1': {'precision': 0.8345912441585359, 'recall': 0.7793155074355721, 'f1-score': 0.806006788558588, 'support': 109541}, '2': {'precision': 0.4671669015836166, 'recall': 0.42097201987373456, 'f1-score': 0.44286809062506144, 'support': 26769}, 'accuracy': 0.6861861953374981, 'macro avg': {'precision': 0.575068575284021, 'recall': 0.5915839269553143, 'f1-score': 0.5788013056544431, 'support': 164075}, 'weighted avg': {'precision': 0.7050712925589742, 'recall': 0.6861861953374981, 'f1-score': 0.6928670990546479, 'support': 164075}}
[[15950  8417  3398]
 [14719 85367  9455]
 [ 6998  8502 11269]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6554527
{'0': {'precision': 0.42829488627197937, 'recall': 0.5393600812595226, 'f1-score': 0.4774535809018568, 'support': 9845}, '1': {'precision': 0.8527187391117215, 'recall': 0.8254141454220811, 'f1-score': 0.8388443082382354, 'support': 50405}, '2': {'precision': 0.47240568677935746, 'recall': 0.4274716369529984, 'f1-score': 0.44881680404147833, 'support': 9872}, 'accuracy': 0.7292290579276118, 'macro avg': {'precision': 0.5844731040543527, 'recall': 0.5974152878782008, 'f1-score': 0.5883715643938568, 'support': 70122}, 'weighted avg': {'precision': 0.739588718806648, 'recall': 0.7292290579276118, 'f1-score': 0.7331963912926687, 'support': 70122}}
[[ 5310  3454  1081]
 [ 5168 41605  3632]
 [ 1920  3732  4220]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0470698
{'0': {'precision': 0.4591940141040591, 'recall': 0.6011813349084465, 'f1-score': 0.5206814184017599, 'support': 110045}, '1': {'precision': 0.5596554146485747, 'recall': 0.46283796696198565, 'f1-score': 0.5066629847661366, 'support': 130819}, '2': {'precision': 0.5007169696779393, 'recall': 0.44735685497068367, 'f1-score': 0.47253528778435183, 'support': 106937}, 'accuracy': 0.5018501959453826, 'macro avg': {'precision': 0.5065221328101911, 'recall': 0.5037920522803719, 'f1-score': 0.4999598969840828, 'support': 347801}, 'weighted avg': {'precision': 0.5097476360258967, 'recall': 0.5018501959453826, 'f1-score': 0.5006053397256998, 'support': 347801}}
[[66157 24007 19881]
 [42450 60548 27821]
 [35465 23633 47839]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.118232
{'0': {'precision': 0.43867048156956007, 'recall': 0.6290898433336886, 'f1-score': 0.5169009151013617, 'support': 37532}, '1': {'precision': 0.5276381909547738, 'recall': 0.31577708622087397, 'f1-score': 0.39509848831882727, 'support': 38239}, '2': {'precision': 0.4785249457700651, 'recall': 0.4666560896927389, 'f1-score': 0.4725159977509438, 'support': 37818}, 'accuracy': 0.46953490214721494, 'macro avg': {'precision': 0.481611206098133, 'recall': 0.4705076730824338, 'f1-score': 0.4615051337237109, 'support': 113589}, 'weighted avg': {'precision': 0.4818899162535161, 'recall': 0.46953490214721494, 'f1-score': 0.46111952956142876, 'support': 113589}}
[[23611  5425  8496]
 [15428 12075 10736]
 [14785  5385 17648]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0827308
{'0': {'precision': 0.4543876567020251, 'recall': 0.6004077471967381, 'f1-score': 0.5172905917224723, 'support': 11772}, '1': {'precision': 0.5670166140046886, 'recall': 0.4203248961088024, 'f1-score': 0.4827735832682461, 'support': 13235}, '2': {'precision': 0.4817311103228095, 'recall': 0.4668672110012892, 'f1-score': 0.47418270699663917, 'support': 11635}, 'accuracy': 0.492958899623383, 'macro avg': {'precision': 0.501045127009841, 'recall': 0.4958666181022766, 'f1-score': 0.4914156273291192, 'support': 36642}, 'weighted avg': {'precision': 0.5037513740967792, 'recall': 0.492958899623383, 'f1-score': 0.4911350094486675, 'support': 36642}}
[[7068 2152 2552]
 [4380 5563 3292]
 [4107 2096 5432]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3440952
{'0': {'precision': 0.3532847144837833, 'recall': 0.9309325606411536, 'f1-score': 0.5121940815782458, 'support': 103189}, '1': {'precision': 0.28086997193638913, 'recall': 0.012796880161106434, 'f1-score': 0.024478481967246526, 'support': 93851}, '2': {'precision': 0.4118562718899987, 'recall': 0.0671495796542061, 'f1-score': 0.11547239118772902, 'support': 94565}, 'accuracy': 0.3553196961643319, 'macro avg': {'precision': 0.3486703194367237, 'recall': 0.3369596734854887, 'f1-score': 0.21738165157774045, 'support': 291605}, 'weighted avg': {'precision': 0.3489727970725704, 'recall': 0.3553196961643319, 'f1-score': 0.22657283574614032, 'support': 291605}}
[[96062  1740  5387]
 [88969  1201  3681]
 [86880  1335  6350]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3610383
{'0': {'precision': 0.33447397563676634, 'recall': 0.9132498790517658, 'f1-score': 0.489624874363713, 'support': 33072}, '1': {'precision': 0.32306477093206953, 'recall': 0.025211120014793812, 'f1-score': 0.04677225684716107, 'support': 32446}, '2': {'precision': 0.41489171290495797, 'recall': 0.07045378559922191, 'f1-score': 0.12045312824776555, 'support': 32901}, 'accuracy': 0.3387455674209248, 'macro avg': {'precision': 0.35747681982459795, 'recall': 0.3363049282219272, 'f1-score': 0.2189500864862132, 'support': 98419}, 'weighted avg': {'precision': 0.35759594312284304, 'recall': 0.3387455674209248, 'f1-score': 0.2202163694317097, 'support': 98419}}
[[30203   848  2021]
 [30380   818  1248]
 [29717   866  2318]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.343897
{'0': {'precision': 0.3577888519748985, 'recall': 0.9258875975163191, 'f1-score': 0.5161304637230975, 'support': 12562}, '1': {'precision': 0.35526315789473684, 'recall': 0.018797319641458532, 'f1-score': 0.03570543020084304, 'support': 11491}, '2': {'precision': 0.42572062084257206, 'recall': 0.08482063968899099, 'f1-score': 0.14145730494363815, 'support': 11318}, 'accuracy': 0.3620762771762178, 'macro avg': {'precision': 0.3795908769040692, 'recall': 0.34316851894892286, 'f1-score': 0.23109773295585956, 'support': 35371}, 'weighted avg': {'precision': 0.37870511132208096, 'recall': 0.3620762771762178, 'f1-score': 0.24016668347175749, 'support': 35371}}
[[11631   202   729]
 [10709   216   566]
 [10168   190   960]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0647374
{'0': {'precision': 0.4514891216218741, 'recall': 0.6440483741159039, 'f1-score': 0.5308459744059465, 'support': 187621}, '1': {'precision': 0.5356832783469352, 'recall': 0.37225724242453495, 'f1-score': 0.4392622103503561, 'support': 207182}, '2': {'precision': 0.5202721909281293, 'recall': 0.47403695716520783, 'f1-score': 0.49607960815441504, 'support': 189192}, 'accuracy': 0.492548737574808, 'macro avg': {'precision': 0.5024815302989795, 'recall': 0.4967808579018822, 'f1-score': 0.48872926430357255, 'support': 583995}, 'weighted avg': {'precision': 0.5036414863284223, 'recall': 0.492548737574808, 'f1-score': 0.48709213101957327, 'support': 583995}}
[[120837  33868  32916]
 [ 80278  77125  49779]
 [ 66526  32982  89684]]
Evaluating performance on  train set...
878/878 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0544226
{'0': {'precision': 0.4697080076394495, 'recall': 0.6418251768947241, 'f1-score': 0.5424407103390254, 'support': 74338}, '1': {'precision': 0.5493704039488264, 'recall': 0.3674239361845474, 'f1-score': 0.44034267535466576, 'support': 74214}, '2': {'precision': 0.5123487012103903, 'recall': 0.49445472562376136, 'f1-score': 0.5032426980851049, 'support': 76191}, 'accuracy': 0.5012525417921804, 'macro avg': {'precision': 0.5104757042662221, 'recall': 0.5012346129010109, 'f1-score': 0.4953420279262654, 'support': 224743}, 'weighted avg': {'precision': 0.5104696872626976, 'recall': 0.5012525417921804, 'f1-score': 0.49543751415508325, 'support': 224743}}
[[47712 10768 15858]
 [26947 27268 19999]
 [26919 11599 37673]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0692893
{'0': {'precision': 0.46701266713581985, 'recall': 0.6376155971015653, 'f1-score': 0.5391398541035493, 'support': 24979}, '1': {'precision': 0.5395731809779869, 'recall': 0.35659287776708376, 'f1-score': 0.4294024561481713, 'support': 27014}, '2': {'precision': 0.509681227863046, 'recall': 0.5104043509103807, 'f1-score': 0.5100425330812853, 'support': 25374}, 'accuracy': 0.49777036721082635, 'macro avg': {'precision': 0.5054223586589509, 'recall': 0.50153760859301, 'f1-score': 0.49286161444433524, 'support': 77367}, 'weighted avg': {'precision': 0.5063423785221336, 'recall': 0.49777036721082635, 'f1-score': 0.4912801530425606, 'support': 77367}}
[[15927  4086  4966]
 [ 9888  9633  7493]
 [ 8289  4134 12951]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
5098/5098 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49418154
{'0': {'precision': 0.4612383009359251, 'recall': 0.6270488594247533, 'f1-score': 0.5315121983595404, 'support': 153256}, '1': {'precision': 0.8915294152186587, 'recall': 0.8506328176818795, 'f1-score': 0.8706011003936414, 'support': 999577}, '2': {'precision': 0.5009346317830814, 'recall': 0.4704954036744302, 'f1-score': 0.48523811945814893, 'support': 152078}, 'accuracy': 0.780071591089354, 'macro avg': {'precision': 0.6179007826458883, 'recall': 0.6493923602603543, 'f1-score': 0.6291171394037769, 'support': 1304911}, 'weighted avg': {'precision': 0.7954726201683983, 'recall': 0.780071591089354, 'f1-score': 0.7858653290001547, 'support': 1304911}}
[[ 96099  44965  12192]
 [ 90211 850273  59093]
 [ 22040  58486  71552]]
Evaluating performance on  train set...
1876/1876 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51068324
{'0': {'precision': 0.4637637692223798, 'recall': 0.6015135976235103, 'f1-score': 0.5237325450710514, 'support': 56554}, '1': {'precision': 0.8945363423042383, 'recall': 0.8432486311563827, 'f1-score': 0.8681356527850992, 'support': 366185}, '2': {'precision': 0.4793156571799238, 'recall': 0.5143210134335631, 'f1-score': 0.49620172412345864, 'support': 57468}, 'accuracy': 0.7754156020216282, 'macro avg': {'precision': 0.6125385895688472, 'recall': 0.6530277474044853, 'f1-score': 0.6293566406598697, 'support': 480207}, 'weighted avg': {'precision': 0.7941133696470393, 'recall': 0.7754156020216282, 'f1-score': 0.7830646888758114, 'support': 480207}}
[[ 34018  16489   6047]
 [ 31339 308785  26061]
 [  7995  19916  29557]]
Evaluating performance on  val set...
619/619 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45905182
{'0': {'precision': 0.45313672685532647, 'recall': 0.62255110086735, 'f1-score': 0.5245030405232767, 'support': 16487}, '1': {'precision': 0.9053101286565434, 'recall': 0.8612829983530804, 'f1-score': 0.8827479402329554, 'support': 125082}, '2': {'precision': 0.49886377227604356, 'recall': 0.49645896566089387, 'f1-score': 0.49765846383296053, 'support': 16803}, 'accuracy': 0.797723082363044, 'macro avg': {'precision': 0.6191035425959711, 'recall': 0.6600976882937748, 'f1-score': 0.6349698148630641, 'support': 158372}, 'weighted avg': {'precision': 0.8151142543747373, 'recall': 0.797723082363044, 'f1-score': 0.8045962332805738, 'support': 158372}}
[[ 10264   4818   1405]
 [ 10376 107731   6975]
 [  2011   6450   8342]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
5760/5760 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5195239
{'0': {'precision': 0.4091949422814763, 'recall': 0.6429961153218781, 'f1-score': 0.500119738511472, 'support': 152651}, '1': {'precision': 0.9038230398566428, 'recall': 0.8505292399389572, 'f1-score': 0.876366659059095, 'support': 1167051}, '2': {'precision': 0.4934293508550644, 'recall': 0.43475114525518677, 'f1-score': 0.462235473134272, 'support': 154769}, 'accuracy': 0.7854010014439077, 'macro avg': {'precision': 0.6021491109977278, 'recall': 0.6427588335053408, 'f1-score': 0.6129072902349463, 'support': 1474471}, 'weighted avg': {'precision': 0.8095372284869841, 'recall': 0.7854010014439077, 'f1-score': 0.7939444627711286, 'support': 1474471}}
[[ 98154  42594  11903]
 [117265 992611  57175]
 [ 24452  63031  67286]]
Evaluating performance on  train set...
2159/2159 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64332634
{'0': {'precision': 0.4405345613797463, 'recall': 0.5989515554791661, 'f1-score': 0.5076717360652241, 'support': 81454}, '1': {'precision': 0.8426233322781128, 'recall': 0.8011473406649945, 'f1-score': 0.8213620706934839, 'support': 388725}, '2': {'precision': 0.5061839535753362, 'recall': 0.4437591063623118, 'f1-score': 0.4729204272691395, 'support': 82360}, 'accuracy': 0.7180687698062942, 'macro avg': {'precision': 0.5964472824110651, 'recall': 0.6146193341688241, 'f1-score': 0.6006514113426159, 'support': 552539}, 'weighted avg': {'precision': 0.733199588479546, 'recall': 0.7180687698062942, 'f1-score': 0.7231807906947159, 'support': 552539}}
[[ 48787  26221   6446]
 [ 48090 311426  29209]
 [ 13868  31944  36548]]
Evaluating performance on  val set...
850/850 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59576595
{'0': {'precision': 0.4535601346526574, 'recall': 0.5951743524529818, 'f1-score': 0.5148059165774163, 'support': 29882}, '1': {'precision': 0.860958033064858, 'recall': 0.8243792611384176, 'f1-score': 0.8422716919757267, 'support': 157675}, '2': {'precision': 0.5058364325956475, 'recall': 0.4611588559151336, 'f1-score': 0.482465536921591, 'support': 29788}, 'accuracy': 0.7430858772918632, 'macro avg': {'precision': 0.6067848667710543, 'recall': 0.6269041565021777, 'f1-score': 0.613181048491578, 'support': 217345}, 'weighted avg': {'precision': 0.7562754950026518, 'recall': 0.7430858772918632, 'f1-score': 0.7479367036060613, 'support': 217345}}
[[ 17785   9703   2394]
 [ 16665 129984  11026]
 [  4762  11289  13737]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
6315/6315 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5927072
{'0': {'precision': 0.4550851489582021, 'recall': 0.57701042359725, 'f1-score': 0.5088460440209503, 'support': 225450}, '1': {'precision': 0.8509655404954498, 'recall': 0.8312835389703965, 'f1-score': 0.841009401853295, 'support': 1165808}, '2': {'precision': 0.531009773345989, 'recall': 0.4521591232059116, 'f1-score': 0.48842251696927547, 'support': 225184}, 'accuracy': 0.7430040793297873, 'macro avg': {'precision': 0.6123534875998803, 'recall': 0.6201510285911861, 'f1-score': 0.6127593209478402, 'support': 1616442}, 'weighted avg': {'precision': 0.751178382192302, 'recall': 0.7430040793297873, 'f1-score': 0.7455632589610507, 'support': 1616442}}
[[130087  77544  17819]
 [124583 969117  72108]
 [ 31182  92183 101819]]
Evaluating performance on  train set...
2155/2155 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6722804
{'0': {'precision': 0.4629252765602171, 'recall': 0.5974342282481817, 'f1-score': 0.5216483731869855, 'support': 89096}, '1': {'precision': 0.8244480009064257, 'recall': 0.7868543560186212, 'f1-score': 0.8052126257198068, 'support': 369902}, '2': {'precision': 0.5267594166806351, 'recall': 0.4754114303621019, 'f1-score': 0.4997699713174112, 'support': 92543}, 'accuracy': 0.7039984334800132, 'macro avg': {'precision': 0.6047108980490926, 'recall': 0.6199000048763016, 'f1-score': 0.6088769900747345, 'support': 551541}, 'weighted avg': {'precision': 0.7160984433969075, 'recall': 0.7039984334800132, 'f1-score': 0.7081554346677814, 'support': 551541}}
[[ 53229  27699   8168]
 [ 47485 291059  31358]
 [ 14270  34277  43996]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60856915
{'0': {'precision': 0.4518451100446798, 'recall': 0.6118082007618194, 'f1-score': 0.5197982105463546, 'support': 26778}, '1': {'precision': 0.8560353952648934, 'recall': 0.8192159977845633, 'f1-score': 0.8372210802276044, 'support': 137219}, '2': {'precision': 0.5169765736226757, 'recall': 0.447845423627462, 'f1-score': 0.4799343159243832, 'support': 26757}, 'accuracy': 0.7380081151640333, 'macro avg': {'precision': 0.6082856929774163, 'recall': 0.6262898740579482, 'f1-score': 0.6123178688994474, 'support': 190754}, 'weighted avg': {'precision': 0.7517355936968649, 'recall': 0.7380081151640333, 'f1-score': 0.7425448398510682, 'support': 190754}}
[[ 16383   8356   2039]
 [ 15650 112412   9157]
 [  4225  10549  11983]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
6082/6082 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74405515
{'0': {'precision': 0.4434855524702389, 'recall': 0.5842285209303674, 'f1-score': 0.5042198313317787, 'support': 276106}, '1': {'precision': 0.8179348810256781, 'recall': 0.740950775079735, 'f1-score': 0.7775419341208505, 'support': 1005832}, '2': {'precision': 0.47817573631394306, 'recall': 0.49043170126534386, 'f1-score': 0.4842261803199486, 'support': 274866}, 'accuracy': 0.668924283339457, 'macro avg': {'precision': 0.5798653899366201, 'recall': 0.6052036657584821, 'f1-score': 0.5886626485908593, 'support': 1556804}, 'weighted avg': {'precision': 0.6915375032051794, 'recall': 0.668924283339457, 'f1-score': 0.6772798584215858, 'support': 1556804}}
[[161309  80334  34463]
 [147915 745272 112645]
 [ 54506  85557 134803]]
Evaluating performance on  train set...
2440/2440 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.879278
{'0': {'precision': 0.44204063881218963, 'recall': 0.6094686933482081, 'f1-score': 0.5124251821715197, 'support': 143420}, '1': {'precision': 0.749077566625898, 'recall': 0.6472639540563343, 'f1-score': 0.6944589135074702, 'support': 337805}, '2': {'precision': 0.48431317337759533, 'recall': 0.4559088182363527, 'f1-score': 0.46968194426479254, 'support': 143362}, 'accuracy': 0.5946633535440219, 'macro avg': {'precision': 0.5584771262718943, 'recall': 0.570880488546965, 'f1-score': 0.5588553466479275, 'support': 624587}, 'weighted avg': {'precision': 0.6178029977797561, 'recall': 0.5946633535440219, 'f1-score': 0.6010663939501135, 'support': 624587}}
[[ 87410  34079  21931]
 [ 71493 218649  47663]
 [ 38839  39163  65360]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.761569
{'0': {'precision': 0.4521953221173574, 'recall': 0.5794916739702016, 'f1-score': 0.5079901659496006, 'support': 39935}, '1': {'precision': 0.7880231829822322, 'recall': 0.7509425408938083, 'f1-score': 0.7690361417816327, 'support': 132355}, '2': {'precision': 0.5020214448936544, 'recall': 0.4377235107796056, 'f1-score': 0.46767282552332085, 'support': 39148}, 'accuracy': 0.6605671638967452, 'macro avg': {'precision': 0.5807466499977479, 'recall': 0.5893859085478719, 'f1-score': 0.581566377751518, 'support': 211438}, 'weighted avg': {'precision': 0.6716406894553808, 'recall': 0.6605671638967452, 'f1-score': 0.6639337375320059, 'support': 211438}}
[[23142 12532  4261]
 [20227 99391 12737]
 [ 7808 14204 17136]]
testing model on single stock: results/universal/W3/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
13689/13689 - 109s - 109s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.164919
{'0': {'precision': 0.4079206599384803, 'recall': 0.7185714885458795, 'f1-score': 0.5204122482611, 'support': 1071885}, '1': {'precision': 0.5139240232175344, 'recall': 0.1779821454555819, 'f1-score': 0.26439799034841316, 'support': 1333218}, '2': {'precision': 0.48223935548143976, 'recall': 0.5064609427526718, 'f1-score': 0.4940534539046716, 'support': 1099143}, 'accuracy': 0.4463693473574629, 'macro avg': {'precision': 0.46802801287915147, 'recall': 0.46767152558471103, 'f1-score': 0.42628789750472823, 'support': 3504246}, 'weighted avg': {'precision': 0.4715613021648962, 'recall': 0.4463693473574629, 'f1-score': 0.4147418982881973, 'support': 3504246}}
[[770226 108926 192733]
 [690985 237289 404944]
 [426965 115505 556673]]
Evaluating performance on  train set...
5475/5475 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1530834
{'0': {'precision': 0.4185690500245502, 'recall': 0.7330986932429258, 'f1-score': 0.5328835949409131, 'support': 463973}, '1': {'precision': 0.5178489782998629, 'recall': 0.12664335754557535, 'f1-score': 0.20351563444865634, 'support': 465054}, '2': {'precision': 0.48411554397712186, 'recall': 0.4868550532337013, 'f1-score': 0.48548143396162713, 'support': 472539}, 'accuracy': 0.4488493585032742, 'macro avg': {'precision': 0.4735111907671783, 'recall': 0.44886570134073417, 'f1-score': 0.40729355445039883, 'support': 1401566}, 'weighted avg': {'precision': 0.4736101986183385, 'recall': 0.4488493585032742, 'f1-score': 0.4076142481918076, 'support': 1401566}}
[[340138  26505  97330]
 [258333  58896 147825]
 [214150  28331 230058]]
Evaluating performance on  val set...
2036/2036 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1462309
{'0': {'precision': 0.4086337692363269, 'recall': 0.7076332153089694, 'f1-score': 0.5180890091922119, 'support': 159854}, '1': {'precision': 0.553328105812904, 'recall': 0.19303126177413277, 'f1-score': 0.286214997972006, 'support': 193751}, '2': {'precision': 0.48121376657899945, 'recall': 0.507609882406286, 'f1-score': 0.4940595094304562, 'support': 167611}, 'accuracy': 0.4520179733546169, 'macro avg': {'precision': 0.48105854720941016, 'recall': 0.4694247864964627, 'f1-score': 0.43278783886489136, 'support': 521216}, 'weighted avg': {'precision': 0.4857608688277652, 'recall': 0.4520179733546169, 'f1-score': 0.4241674295927872, 'support': 521216}}
[[113118  14853  31883]
 [ 96510  37400  59841]
 [ 67192  15338  85081]]
training model: results/universal/W3/deepVOL_L2/h20
Epoch 1/50
10532/10532 - 345s - loss: 2.8255 - accuracy20: 0.5210 - val_loss: 3.0559 - val_accuracy20: 0.5368 - 345s/epoch - 33ms/step
Epoch 2/50
10532/10532 - 343s - loss: 2.7516 - accuracy20: 0.5427 - val_loss: 3.0274 - val_accuracy20: 0.5503 - 343s/epoch - 33ms/step
Epoch 3/50
10532/10532 - 341s - loss: 2.7204 - accuracy20: 0.5502 - val_loss: 3.0044 - val_accuracy20: 0.5564 - 341s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 343s - loss: 2.7009 - accuracy20: 0.5540 - val_loss: 2.9889 - val_accuracy20: 0.5583 - 343s/epoch - 33ms/step
Epoch 5/50
10532/10532 - 346s - loss: 2.6867 - accuracy20: 0.5563 - val_loss: 2.9818 - val_accuracy20: 0.5582 - 346s/epoch - 33ms/step
Epoch 6/50
10532/10532 - 340s - loss: 2.6764 - accuracy20: 0.5582 - val_loss: 2.9731 - val_accuracy20: 0.5591 - 340s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 342s - loss: 2.6686 - accuracy20: 0.5594 - val_loss: 2.9840 - val_accuracy20: 0.5577 - 342s/epoch - 32ms/step
Epoch 8/50
10532/10532 - 340s - loss: 2.6626 - accuracy20: 0.5607 - val_loss: 2.9521 - val_accuracy20: 0.5593 - 340s/epoch - 32ms/step
Epoch 9/50
10532/10532 - 343s - loss: 2.6571 - accuracy20: 0.5617 - val_loss: 2.9429 - val_accuracy20: 0.5603 - 343s/epoch - 33ms/step
Epoch 10/50
10532/10532 - 339s - loss: 2.6524 - accuracy20: 0.5625 - val_loss: 2.9479 - val_accuracy20: 0.5595 - 339s/epoch - 32ms/step
Epoch 11/50
10532/10532 - 347s - loss: 2.6481 - accuracy20: 0.5632 - val_loss: 2.9367 - val_accuracy20: 0.5589 - 347s/epoch - 33ms/step
Epoch 12/50
10532/10532 - 342s - loss: 2.6446 - accuracy20: 0.5639 - val_loss: 2.9193 - val_accuracy20: 0.5599 - 342s/epoch - 33ms/step
Epoch 13/50
10532/10532 - 348s - loss: 2.6409 - accuracy20: 0.5646 - val_loss: 2.9097 - val_accuracy20: 0.5590 - 348s/epoch - 33ms/step
Epoch 14/50
10532/10532 - 344s - loss: 2.6377 - accuracy20: 0.5652 - val_loss: 2.9045 - val_accuracy20: 0.5595 - 344s/epoch - 33ms/step
Epoch 15/50
10532/10532 - 338s - loss: 2.6350 - accuracy20: 0.5657 - val_loss: 2.8954 - val_accuracy20: 0.5580 - 338s/epoch - 32ms/step
Epoch 16/50
10532/10532 - 339s - loss: 2.6323 - accuracy20: 0.5664 - val_loss: 2.8925 - val_accuracy20: 0.5580 - 339s/epoch - 32ms/step
Epoch 17/50
10532/10532 - 335s - loss: 2.6295 - accuracy20: 0.5668 - val_loss: 2.8804 - val_accuracy20: 0.5583 - 335s/epoch - 32ms/step
Epoch 18/50
10532/10532 - 330s - loss: 2.6272 - accuracy20: 0.5674 - val_loss: 2.8858 - val_accuracy20: 0.5578 - 330s/epoch - 31ms/step
Epoch 19/50
10532/10532 - 339s - loss: 2.6251 - accuracy20: 0.5679 - val_loss: 2.8724 - val_accuracy20: 0.5575 - 339s/epoch - 32ms/step
Epoch 20/50
10532/10532 - 347s - loss: 2.6232 - accuracy20: 0.5681 - val_loss: 2.8665 - val_accuracy20: 0.5590 - 347s/epoch - 33ms/step
Epoch 21/50
10532/10532 - 350s - loss: 2.6209 - accuracy20: 0.5686 - val_loss: 2.8549 - val_accuracy20: 0.5580 - 350s/epoch - 33ms/step
Epoch 22/50
10532/10532 - 345s - loss: 2.6194 - accuracy20: 0.5691 - val_loss: 2.8533 - val_accuracy20: 0.5581 - 345s/epoch - 33ms/step
Epoch 23/50
10532/10532 - 338s - loss: 2.6175 - accuracy20: 0.5694 - val_loss: 2.8503 - val_accuracy20: 0.5569 - 338s/epoch - 32ms/step
Epoch 24/50
10532/10532 - 336s - loss: 2.6155 - accuracy20: 0.5697 - val_loss: 2.8532 - val_accuracy20: 0.5582 - 336s/epoch - 32ms/step
Epoch 25/50
10532/10532 - 342s - loss: 2.6144 - accuracy20: 0.5699 - val_loss: 2.8513 - val_accuracy20: 0.5578 - 342s/epoch - 33ms/step
Epoch 26/50
10532/10532 - 337s - loss: 2.6127 - accuracy20: 0.5701 - val_loss: 2.8507 - val_accuracy20: 0.5567 - 337s/epoch - 32ms/step
Epoch 27/50
10532/10532 - 335s - loss: 2.6114 - accuracy20: 0.5706 - val_loss: 2.8474 - val_accuracy20: 0.5562 - 335s/epoch - 32ms/step
Epoch 28/50
10532/10532 - 337s - loss: 2.6098 - accuracy20: 0.5708 - val_loss: 2.8527 - val_accuracy20: 0.5549 - 337s/epoch - 32ms/step
Epoch 29/50
10532/10532 - 335s - loss: 2.6084 - accuracy20: 0.5712 - val_loss: 2.8340 - val_accuracy20: 0.5567 - 335s/epoch - 32ms/step
Epoch 30/50
10532/10532 - 332s - loss: 2.6069 - accuracy20: 0.5717 - val_loss: 2.8410 - val_accuracy20: 0.5551 - 332s/epoch - 31ms/step
Epoch 31/50
10532/10532 - 334s - loss: 2.6053 - accuracy20: 0.5718 - val_loss: 2.8523 - val_accuracy20: 0.5550 - 334s/epoch - 32ms/step
Epoch 32/50
10532/10532 - 333s - loss: 2.6045 - accuracy20: 0.5719 - val_loss: 2.8524 - val_accuracy20: 0.5541 - 333s/epoch - 32ms/step
Epoch 33/50
10532/10532 - 330s - loss: 2.6032 - accuracy20: 0.5720 - val_loss: 2.8411 - val_accuracy20: 0.5560 - 330s/epoch - 31ms/step
Epoch 34/50
10532/10532 - 331s - loss: 2.6021 - accuracy20: 0.5723 - val_loss: 2.8441 - val_accuracy20: 0.5534 - 331s/epoch - 31ms/step
Epoch 35/50
10532/10532 - 333s - loss: 2.6008 - accuracy20: 0.5727 - val_loss: 2.8457 - val_accuracy20: 0.5536 - 333s/epoch - 32ms/step
Epoch 36/50
10532/10532 - 332s - loss: 2.5996 - accuracy20: 0.5730 - val_loss: 2.8393 - val_accuracy20: 0.5540 - 332s/epoch - 32ms/step
Epoch 37/50
10532/10532 - 335s - loss: 2.5984 - accuracy20: 0.5732 - val_loss: 2.8429 - val_accuracy20: 0.5534 - 335s/epoch - 32ms/step
Epoch 38/50
10532/10532 - 332s - loss: 2.5975 - accuracy20: 0.5734 - val_loss: 2.8451 - val_accuracy20: 0.5525 - 332s/epoch - 31ms/step
Epoch 39/50
10532/10532 - 337s - loss: 2.5964 - accuracy20: 0.5735 - val_loss: 2.8485 - val_accuracy20: 0.5531 - 337s/epoch - 32ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 440s - 440s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96758586
{'0': {'precision': 0.4458701162346963, 'recall': 0.6215643790390171, 'f1-score': 0.5192580587503113, 'support': 1806442}, '1': {'precision': 0.761920841442983, 'recall': 0.5613078404301385, 'f1-score': 0.6464070012201902, 'support': 3457119}, '2': {'precision': 0.4725274779639518, 'recall': 0.5239638030496194, 'f1-score': 0.49691813489347636, 'support': 1822916}, 'accuracy': 0.5670617430918071, 'macro avg': {'precision': 0.560106145213877, 'recall': 0.5689453408395916, 'f1-score': 0.5541943982879927, 'support': 7086477}, 'weighted avg': {'precision': 0.6069119284490582, 'recall': 0.5670617430918071, 'f1-score': 0.5755406403779831, 'support': 7086477}}
[[1122820  274011  409611]
 [ 860017 1940508  656594]
 [ 535430  332344  955142]]
Evaluating performance on  train set...
10532/10532 - 165s - 165s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0132396
{'0': {'precision': 0.44198370562474004, 'recall': 0.620280563544319, 'f1-score': 0.5161689232318302, 'support': 728106}, '1': {'precision': 0.7524372938652357, 'recall': 0.5065518770418577, 'f1-score': 0.6054834026715512, 'support': 1226824}, '2': {'precision': 0.4687459835130951, 'recall': 0.5365633748066483, 'f1-score': 0.5003672247938097, 'support': 740878}, 'accuracy': 0.5455165946536252, 'macro avg': {'precision': 0.554388994334357, 'recall': 0.5544652717976083, 'f1-score': 0.5406731835657302, 'support': 2695808}, 'weighted avg': {'precision': 0.5906217005624086, 'recall': 0.5455165946536252, 'f1-score': 0.5524719597198859, 'support': 2695808}}
[[451630  92563 183913]
 [338748 621450 266626]
 [231447 111903 397528]]
Evaluating performance on  val set...
3814/3814 - 60s - 60s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99033535
{'0': {'precision': 0.44110482499025055, 'recall': 0.6182595951994296, 'f1-score': 0.5148696432341144, 'support': 252470}, '1': {'precision': 0.7619138608521457, 'recall': 0.5311496260583912, 'f1-score': 0.6259402827114576, 'support': 465447}, '2': {'precision': 0.4704767154967831, 'recall': 0.5426686000977055, 'f1-score': 0.5040006337637646, 'support': 257918}, 'accuracy': 0.5567314146346463, 'macro avg': {'precision': 0.5578318004463931, 'recall': 0.5640259404518421, 'f1-score': 0.5482701865697789, 'support': 975835}, 'weighted avg': {'precision': 0.6018852259499162, 'recall': 0.5567314146346463, 'f1-score': 0.564974612566263, 'support': 975835}}
[[156092  34393  61985]
 [122680 247222  95545]
 [ 75094  42860 139964]]
testing model out of sample: results/universal/W3/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 249s - 249s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.843578
{'0': {'precision': 0.4539889714767424, 'recall': 0.5965181766121705, 'f1-score': 0.5155846373059043, 'support': 928996}, '1': {'precision': 0.766429813278098, 'recall': 0.6997455727287631, 'f1-score': 0.731571234611044, 'support': 2281202}, '2': {'precision': 0.5057310941114194, 'recall': 0.4548568714136883, 'f1-score': 0.4789467940468991, 'support': 926265}, 'accuracy': 0.6217248891142022, 'macro avg': {'precision': 0.5753832929554199, 'recall': 0.5837068735848739, 'f1-score': 0.5753675553212824, 'support': 4136463}, 'weighted avg': {'precision': 0.6378822132200254, 'recall': 0.6217248891142022, 'f1-score': 0.6264940557775253, 'support': 4136463}}
[[ 554163  218824  156009]
 [ 429181 1596261  255760]
 [ 237309  267638  421318]]
Evaluating performance on  train set...
6181/6181 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9353177
{'0': {'precision': 0.46802642709772746, 'recall': 0.5782136312584973, 'f1-score': 0.5173177183872971, 'support': 422925}, '1': {'precision': 0.692481772830481, 'recall': 0.6271157763748026, 'f1-score': 0.6581798289266602, 'support': 732887}, '2': {'precision': 0.5019641746674554, 'recall': 0.466154117025647, 'f1-score': 0.4833968506294724, 'support': 425975}, 'accuracy': 0.5706937786187395, 'macro avg': {'precision': 0.5541574581985546, 'recall': 0.5571611748863156, 'f1-score': 0.5529647993144765, 'support': 1581787}, 'weighted avg': {'precision': 0.5811624163232397, 'recall': 0.5706937786187395, 'f1-score': 0.5734482643860459, 'support': 1581787}}
[[244541  93458  84926]
 [161192 459605 112090]
 [116761 110644 198570]]
Evaluating performance on  val set...
2209/2209 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8741129
{'0': {'precision': 0.47403177087791815, 'recall': 0.5672205272284291, 'f1-score': 0.5164561009649494, 'support': 136677}, '1': {'precision': 0.7215345825454129, 'recall': 0.6897231713078666, 'f1-score': 0.7052703435962963, 'support': 292094}, '2': {'precision': 0.5050424715489816, 'recall': 0.4530690301938141, 'f1-score': 0.47764608268487396, 'support': 135955}, 'accuracy': 0.6031013270152251, 'macro avg': {'precision': 0.5668696083241042, 'recall': 0.5700042429100366, 'f1-score': 0.5664575090820398, 'support': 564726}, 'weighted avg': {'precision': 0.6095136613539006, 'recall': 0.6031013270152251, 'f1-score': 0.6047734289291178, 'support': 564726}}
[[ 77526  35837  23314]
 [ 53577 201464  37053]
 [ 32443  41915  61597]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2549211
{'0': {'precision': 0.39741482059923555, 'recall': 0.6553260703817285, 'f1-score': 0.4947775752342575, 'support': 59021}, '1': {'precision': 0.39092872570194387, 'recall': 0.04897539505014792, 'f1-score': 0.08704573507959155, 'support': 55436}, '2': {'precision': 0.43306858787957697, 'recall': 0.5079324679731908, 'f1-score': 0.467522528854113, 'support': 58935}, 'accuracy': 0.411368459905878, 'macro avg': {'precision': 0.40713737806025213, 'recall': 0.40407797780168914, 'f1-score': 0.34978194638932064, 'support': 173392}, 'weighted avg': {'precision': 0.4074596416863714, 'recall': 0.411368459905878, 'f1-score': 0.35515580231954474, 'support': 173392}}
[[38678  1922 18421]
 [31954  2715 20767]
 [26692  2308 29935]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2585435
{'0': {'precision': 0.3995894934110718, 'recall': 0.5933828076685219, 'f1-score': 0.47757532663763225, 'support': 22638}, '1': {'precision': 0.4311819595645412, 'recall': 0.05181516609821053, 'f1-score': 0.09251303441084463, 'support': 21403}, '2': {'precision': 0.4106171201061712, 'recall': 0.5552763819095478, 'f1-score': 0.47211413748378733, 'support': 22288}, 'accuracy': 0.4058255061888465, 'macro avg': {'precision': 0.4137961910272614, 'recall': 0.4001581185587601, 'f1-score': 0.34740083284408807, 'support': 66329}, 'weighted avg': {'precision': 0.4134892551572625, 'recall': 0.4058255061888465, 'f1-score': 0.35148858894535845, 'support': 66329}}
[[13433   736  8469]
 [10999  1109  9295]
 [ 9185   727 12376]]
Evaluating performance on  val set...
86/86 - 1s - 820ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2684994
{'0': {'precision': 0.4033232628398791, 'recall': 0.5920177383592018, 'f1-score': 0.4797843665768194, 'support': 7667}, '1': {'precision': 0.2957516339869281, 'recall': 0.026477472205968404, 'f1-score': 0.04860365198711064, 'support': 6836}, '2': {'precision': 0.39471593166468016, 'recall': 0.5347867043466559, 'f1-score': 0.4541973827075832, 'support': 7431}, 'accuracy': 0.3963709309747424, 'macro avg': {'precision': 0.3645969428304958, 'recall': 0.3844273049706087, 'f1-score': 0.32752846709050437, 'support': 21934}, 'weighted avg': {'precision': 0.3668811759974575, 'recall': 0.3963709309747424, 'f1-score': 0.33673301971498193, 'support': 21934}}
[[4539  198 2930]
 [3491  181 3164]
 [3224  233 3974]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6066093
{'0': {'precision': 0.46641297154202516, 'recall': 0.5494650669207779, 'f1-score': 0.5045440986377647, 'support': 46174}, '1': {'precision': 0.8727991242880202, 'recall': 0.8459267197974508, 'f1-score': 0.8591528460362597, 'support': 278056}, '2': {'precision': 0.4533956194085761, 'recall': 0.45680793908043427, 'f1-score': 0.45509538291401713, 'support': 45043}, 'accuracy': 0.7613933323042844, 'macro avg': {'precision': 0.5975359050795405, 'recall': 0.6173999085995544, 'f1-score': 0.6062641091960138, 'support': 369273}, 'weighted avg': {'precision': 0.7708266911906142, 'recall': 0.7613933323042844, 'f1-score': 0.7655265462152782, 'support': 369273}}
[[ 25371  15432   5371]
 [ 23406 235215  19435]
 [  5619  18848  20576]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.814829
{'0': {'precision': 0.4712517848643503, 'recall': 0.5554558204768584, 'f1-score': 0.5099008626239218, 'support': 35650}, '1': {'precision': 0.7610694397707413, 'recall': 0.7468973378359663, 'f1-score': 0.7539167930148284, 'support': 93871}, '2': {'precision': 0.5133970332754243, 'recall': 0.4447241998032066, 'f1-score': 0.4765995720001241, 'support': 34554}, 'accuracy': 0.6416638732287064, 'macro avg': {'precision': 0.581906085970172, 'recall': 0.5823591193720105, 'f1-score': 0.5801390758796248, 'support': 164075}, 'weighted avg': {'precision': 0.6459387267952604, 'recall': 0.6416638732287064, 'f1-score': 0.6424946557399364, 'support': 164075}}
[[19802 10800  5048]
 [14242 70112  9517]
 [ 7976 11211 15367]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7598344
{'0': {'precision': 0.476697827880121, 'recall': 0.532642089093702, 'f1-score': 0.5031195589088799, 'support': 13020}, '1': {'precision': 0.7783675580846134, 'recall': 0.787238398544131, 'f1-score': 0.7827778468915755, 'support': 43960}, '2': {'precision': 0.5214613515702331, 'recall': 0.44095267082635825, 'f1-score': 0.47783962069676356, 'support': 13142}, 'accuracy': 0.6750663129973474, 'macro avg': {'precision': 0.5921755791783225, 'recall': 0.5869443861547304, 'f1-score': 0.5879123421657396, 'support': 70122}, 'weighted avg': {'precision': 0.674206221367542, 'recall': 0.6750663129973474, 'f1-score': 0.6737015359166045, 'support': 70122}}
[[ 6935  4639  1446]
 [ 5481 34607  3872]
 [ 2132  5215  5795]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.139396
{'0': {'precision': 0.4430700857390073, 'recall': 0.6009281567553632, 'f1-score': 0.5100646324852756, 'support': 112481}, '1': {'precision': 0.5179440650326758, 'recall': 0.3394429802005657, 'f1-score': 0.4101122777381351, 'support': 124448}, '2': {'precision': 0.4632936333409567, 'recall': 0.47505231257666497, 'f1-score': 0.4690992972862245, 'support': 110872}, 'accuracy': 0.46723844957317545, 'macro avg': {'precision': 0.4747692613708799, 'recall': 0.4718078165108646, 'f1-score': 0.4630920691698784, 'support': 347801}, 'weighted avg': {'precision': 0.47630789168223864, 'recall': 0.46723844957317545, 'f1-score': 0.46124137065520227, 'support': 347801}}
[[67593 18904 25984]
 [47173 42243 35032]
 [37790 20412 52670]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2129937
{'0': {'precision': 0.4218571842690115, 'recall': 0.5806357228354835, 'f1-score': 0.48867248712782624, 'support': 37595}, '1': {'precision': 0.4951468315301391, 'recall': 0.21141967161184733, 'f1-score': 0.29631685073163516, 'support': 37882}, '2': {'precision': 0.4448969760669163, 'recall': 0.5331129303106633, 'f1-score': 0.4850264379751973, 'support': 38112}, 'accuracy': 0.4415568408912835, 'macro avg': {'precision': 0.453966997288689, 'recall': 0.4417227749193313, 'f1-score': 0.4233385919448862, 'support': 113589}, 'weighted avg': {'precision': 0.4540297622699428, 'recall': 0.4415568408912835, 'f1-score': 0.4232984241176272, 'support': 113589}}
[[21829  4149 11617]
 [16139  8009 13734]
 [13777  4017 20318]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1668983
{'0': {'precision': 0.44031362299901994, 'recall': 0.5587893864013267, 'f1-score': 0.49252695048419515, 'support': 12060}, '1': {'precision': 0.53125, 'recall': 0.3029165001997603, 'f1-score': 0.38583278204671523, 'support': 12515}, '2': {'precision': 0.44320822477290334, 'recall': 0.5215878014419492, 'f1-score': 0.4792142530835999, 'support': 12067}, 'accuracy': 0.4591452431635828, 'macro avg': {'precision': 0.47159061592397444, 'recall': 0.4610978960143453, 'f1-score': 0.4525246618715035, 'support': 36642}, 'weighted avg': {'precision': 0.47232601090832393, 'recall': 0.4591452431635828, 'f1-score': 0.45170161787331037, 'support': 36642}}
[[6739 1647 3674]
 [4491 3791 4233]
 [4075 1698 6294]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3232051
{'0': {'precision': 0.34804567115141805, 'recall': 0.26022697281604645, 'f1-score': 0.29779695767579906, 'support': 98514}, '1': {'precision': 0.2916666666666667, 'recall': 0.022724712484766558, 'f1-score': 0.04216426773074913, 'support': 97647}, '2': {'precision': 0.3287249215555767, 'recall': 0.7244457482921923, 'f1-score': 0.45224079742563383, 'support': 95444}, 'accuracy': 0.332638329246755, 'macro avg': {'precision': 0.3228124197912205, 'recall': 0.3357991445310018, 'f1-score': 0.26406734094406065, 'support': 291605}, 'weighted avg': {'precision': 0.3228427758809392, 'recall': 0.332638329246755, 'f1-score': 0.26274602427623095, 'support': 291605}}
[[25636  2868 70010]
 [24242  2219 71186]
 [23779  2521 69144]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3193903
{'0': {'precision': 0.35348685816583936, 'recall': 0.25908033637502237, 'f1-score': 0.29900881057268724, 'support': 33534}, '1': {'precision': 0.315211842776927, 'recall': 0.038066763246308914, 'f1-score': 0.06792992491955667, 'support': 32443}, '2': {'precision': 0.32801796261602045, 'recall': 0.7069847728253499, 'f1-score': 0.448121916670737, 'support': 32442}, 'accuracy': 0.3338684603582642, 'macro avg': {'precision': 0.33223888785292893, 'recall': 0.33471062414889374, 'f1-score': 0.27168688405432695, 'support': 98419}, 'weighted avg': {'precision': 0.3324744699715912, 'recall': 0.3338684603582642, 'f1-score': 0.27198796196406916, 'support': 98419}}
[[ 8688  1341 23505]
 [ 7726  1235 23482]
 [ 8164  1342 22936]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3244386
{'0': {'precision': 0.36521926053310405, 'recall': 0.27370116794200566, 'f1-score': 0.3129057507251715, 'support': 12415}, '1': {'precision': 0.3029661016949153, 'recall': 0.024388164065830987, 'f1-score': 0.04514245126667192, 'support': 11727}, '2': {'precision': 0.3197070413565259, 'recall': 0.7152907649835248, 'f1-score': 0.44190140845070425, 'support': 11229}, 'accuracy': 0.3312318000621978, 'macro avg': {'precision': 0.3292974678615151, 'recall': 0.3377933656637872, 'f1-score': 0.2666498701475159, 'support': 35371}, 'weighted avg': {'precision': 0.3301312080938393, 'recall': 0.3312318000621978, 'f1-score': 0.26508216722032807, 'support': 35371}}
[[3398  334 8683]
 [3033  286 8408]
 [2873  324 8032]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.143696
{'0': {'precision': 0.44050004562460077, 'recall': 0.6329176324980859, 'f1-score': 0.5194627434860554, 'support': 190682}, '1': {'precision': 0.514491280055002, 'recall': 0.2671416432446565, 'f1-score': 0.35167926501542246, 'support': 198887}, '2': {'precision': 0.48059259689191347, 'recall': 0.5110581918056227, 'f1-score': 0.4953574108186661, 'support': 194426}, 'accuracy': 0.46777797755117767, 'macro avg': {'precision': 0.47852797419050547, 'recall': 0.47037248918278834, 'f1-score': 0.45549980644004795, 'support': 583995}, 'weighted avg': {'precision': 0.47904648697231395, 'recall': 0.46777797755117767, 'f1-score': 0.4542966785509471, 'support': 583995}}
[[120686  24509  45487]
 [ 83855  53131  61901]
 [ 69434  25629  99363]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1490153
{'0': {'precision': 0.44635308127418877, 'recall': 0.6051420729738457, 'f1-score': 0.5137580098002262, 'support': 74328}, '1': {'precision': 0.5317706607212799, 'recall': 0.23815949264606665, 'f1-score': 0.32898109057697505, 'support': 74110}, '2': {'precision': 0.46696481681390584, 'recall': 0.5555599239892537, 'f1-score': 0.5074242759759886, 'support': 76305}, 'accuracy': 0.46729375330933554, 'macro avg': {'precision': 0.4816961862697915, 'recall': 0.46628716320305535, 'f1-score': 0.45005445878439665, 'support': 224743}, 'weighted avg': {'precision': 0.48151802653692016, 'recall': 0.46729375330933554, 'f1-score': 0.4506765654700642, 'support': 224743}}
[[44979  7684 21665]
 [29735 17650 26725]
 [26056  7857 42392]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1691035
{'0': {'precision': 0.4464445923653518, 'recall': 0.6119728646804459, 'f1-score': 0.5162650602409639, 'support': 25207}, '1': {'precision': 0.5113118352186392, 'recall': 0.22852292020373516, 'f1-score': 0.31587181559802874, 'support': 26505}, '2': {'precision': 0.4601201239989667, 'recall': 0.555408302475151, 'f1-score': 0.503293714568285, 'support': 25655}, 'accuracy': 0.46185065984205154, 'macro avg': {'precision': 0.4726255171943192, 'recall': 0.46530136245311066, 'f1-score': 0.4451435301357592, 'support': 77367}, 'weighted avg': {'precision': 0.47320215096122303, 'recall': 0.46185065984205154, 'f1-score': 0.4433114388973216, 'support': 77367}}
[[15426  2905  6876]
 [10605  6057  9843]
 [ 8522  2884 14249]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
5098/5098 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5832737
{'0': {'precision': 0.5181114040870138, 'recall': 0.5982654697170803, 'f1-score': 0.5553109703458218, 'support': 210201}, '1': {'precision': 0.8215585374160462, 'recall': 0.8454103503766109, 'f1-score': 0.8333138021448022, 'support': 887388}, '2': {'precision': 0.5766505636070853, 'recall': 0.4145435602589209, 'f1-score': 0.4823409903412822, 'support': 207322}, 'accuracy': 0.7371437592295567, 'macro avg': {'precision': 0.6387735017033819, 'recall': 0.6194064601175374, 'f1-score': 0.6236552542773021, 'support': 1304911}, 'weighted avg': {'precision': 0.7337673380017434, 'recall': 0.7371437592295567, 'f1-score': 0.7327698887777551, 'support': 1304911}}
[[125756  69517  14928]
 [ 89013 750207  48168]
 [ 27951  93427  85944]]
Evaluating performance on  train set...
1876/1876 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59618527
{'0': {'precision': 0.5098028060034364, 'recall': 0.5825683301692975, 'f1-score': 0.5437620229505611, 'support': 76906}, '1': {'precision': 0.8298254729956903, 'recall': 0.836181752663367, 'f1-score': 0.8329914873445393, 'support': 324683}, '2': {'precision': 0.5695582773122141, 'recall': 0.4720165865323463, 'f1-score': 0.5162201263111037, 'support': 78618}, 'accuracy': 0.7359451236654193, 'macro avg': {'precision': 0.636395518770447, 'recall': 0.6302555564550035, 'f1-score': 0.630991212202068, 'support': 480207}, 'weighted avg': {'precision': 0.7359631394229814, 'recall': 0.7359451236654193, 'f1-score': 0.734810052983087, 'support': 480207}}
[[ 44803  24474   7629]
 [ 32773 271494  20416]
 [ 10307  31202  37109]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5596149
{'0': {'precision': 0.4894505805720759, 'recall': 0.6011042998130516, 'f1-score': 0.5395617475462936, 'support': 23001}, '1': {'precision': 0.8388116701452107, 'recall': 0.8448821856046375, 'f1-score': 0.841835984330224, 'support': 111786}, '2': {'precision': 0.5937018654800617, 'recall': 0.4412550349798601, 'f1-score': 0.5062509120980688, 'support': 23585}, 'accuracy': 0.7493685752532013, 'macro avg': {'precision': 0.6406547053991161, 'recall': 0.629080506799183, 'f1-score': 0.6292162146581955, 'support': 158372}, 'weighted avg': {'precision': 0.7515704332832704, 'recall': 0.7493685752532013, 'f1-score': 0.7479596447698057, 'support': 158372}}
[[13826  7518  1657]
 [11875 94446  5465]
 [ 2547 10631 10407]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
5760/5760 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6281678
{'0': {'precision': 0.4338482643640815, 'recall': 0.6300172523900756, 'f1-score': 0.5138466980352829, 'support': 209826}, '1': {'precision': 0.8462045370870835, 'recall': 0.818085433676488, 'f1-score': 0.831907441446983, 'support': 1056375}, '2': {'precision': 0.5498996619483091, 'recall': 0.39208239304748643, 'f1-score': 0.4577708763117768, 'support': 208270}, 'accuracy': 0.7311490019132285, 'macro avg': {'precision': 0.6099841544664913, 'recall': 0.61339502637135, 'f1-score': 0.601175005264681, 'support': 1474471}, 'weighted avg': {'precision': 0.745670526160094, 'recall': 0.7311490019132285, 'f1-score': 0.7337984681488897, 'support': 1474471}}
[[132194  61298  16334]
 [141665 864205  50505]
 [ 30842  95769  81659]]
Evaluating performance on  train set...
2159/2159 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74748635
{'0': {'precision': 0.47913277484682165, 'recall': 0.5791311379006174, 'f1-score': 0.5244073916914193, 'support': 108832}, '1': {'precision': 0.7613419759576836, 'recall': 0.7767546527550963, 'f1-score': 0.768971092092968, 'support': 333727}, '2': {'precision': 0.5599180226058875, 'recall': 0.4098836152027641, 'f1-score': 0.47329518609900784, 'support': 109980}, 'accuracy': 0.6648055612364014, 'macro avg': {'precision': 0.6001309244701309, 'recall': 0.5885898019528258, 'f1-score': 0.5888912232944651, 'support': 552539}, 'weighted avg': {'precision': 0.6656636651688925, 'recall': 0.6648055612364014, 'f1-score': 0.6619473475549045, 'support': 552539}}
[[ 63028  35511  10293]
 [ 49365 259224  25138]
 [ 19153  45748  45079]]
Evaluating performance on  val set...
850/850 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69844985
{'0': {'precision': 0.4831684849513945, 'recall': 0.5711561621838619, 'f1-score': 0.523490858916868, 'support': 39856}, '1': {'precision': 0.7839103971620046, 'recall': 0.7963670711327472, 'f1-score': 0.7900896387418137, 'support': 137630}, '2': {'precision': 0.5565529032682317, 'recall': 0.424671968689631, 'f1-score': 0.48174974741365817, 'support': 39859}, 'accuracy': 0.6869033104051163, 'macro avg': {'precision': 0.6078772617938769, 'recall': 0.5973984006687466, 'f1-score': 0.5984434150241134, 'support': 217345}, 'weighted avg': {'precision': 0.6870661541282198, 'recall': 0.6869033104051163, 'f1-score': 0.6846550499675057, 'support': 217345}}
[[ 22764  13424   3668]
 [ 18207 109604   9819]
 [  6143  16789  16927]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
6315/6315 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70357615
{'0': {'precision': 0.5027177708812866, 'recall': 0.5438401119531688, 'f1-score': 0.5224710324792853, 'support': 304413}, '1': {'precision': 0.7647323155697971, 'recall': 0.8261358593735264, 'f1-score': 0.7942490756488592, 'support': 1007321}, '2': {'precision': 0.5984466507477693, 'recall': 0.3906887905798338, 'f1-score': 0.4727490057244065, 'support': 304708}, 'accuracy': 0.6908890018942838, 'macro avg': {'precision': 0.6219655790662844, 'recall': 0.586888253968843, 'f1-score': 0.5964897046175169, 'support': 1616442}, 'weighted avg': {'precision': 0.6840432429344325, 'recall': 0.6908890018942838, 'f1-score': 0.6824625638148932, 'support': 1616442}}
[[165552 114745  24116]
 [119374 832184  55763]
 [ 44388 141274 119046]]
Evaluating performance on  train set...
2155/2155 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.766574
{'0': {'precision': 0.5148612077630866, 'recall': 0.5637901546068785, 'f1-score': 0.5382159427084174, 'support': 118106}, '1': {'precision': 0.7335435223036072, 'recall': 0.786574627537182, 'f1-score': 0.7591340487562805, 'support': 311172}, '2': {'precision': 0.5911929796821883, 'recall': 0.4281426106017356, 'f1-score': 0.49662723072398324, 'support': 122263}, 'accuracy': 0.6594124462188667, 'macro avg': {'precision': 0.6131992365829607, 'recall': 0.5928357975819321, 'f1-score': 0.597992407396227, 'support': 551541}, 'weighted avg': {'precision': 0.6551596889464403, 'recall': 0.6594124462188667, 'f1-score': 0.653635772243797, 'support': 551541}}
[[ 66587  39300  12219]
 [ 42434 244760  23978]
 [ 20309  49608  52346]]
Evaluating performance on  val set...
746/746 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7160951
{'0': {'precision': 0.4963541914883477, 'recall': 0.5779368514510849, 'f1-score': 0.5340477899702595, 'support': 36042}, '1': {'precision': 0.7729316619490497, 'recall': 0.80772968907144, 'f1-score': 0.7899476387861456, 'support': 118323}, '2': {'precision': 0.5778104861166362, 'recall': 0.39915908653714033, 'f1-score': 0.4721504380190811, 'support': 36389}, 'accuracy': 0.6863709280015098, 'macro avg': {'precision': 0.6156987798513446, 'recall': 0.5949418756865551, 'f1-score': 0.598715288925162, 'support': 190754}, 'weighted avg': {'precision': 0.683451652839357, 'recall': 0.6863709280015098, 'f1-score': 0.680972389566025, 'support': 190754}}
[[20830 12140  3072]
 [15209 95573  7541]
 [ 5927 15937 14525]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
6082/6082 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82328683
{'0': {'precision': 0.49742794028846815, 'recall': 0.5468953964581245, 'f1-score': 0.5209900823645415, 'support': 356986}, '1': {'precision': 0.7287036525772342, 'recall': 0.7487270346170939, 'f1-score': 0.7385796567484376, 'support': 846056}, '2': {'precision': 0.5348238891167508, 'recall': 0.4460060718788338, 'f1-score': 0.48639358791568726, 'support': 353762}, 'accuracy': 0.6336565168126495, 'macro avg': {'precision': 0.5869851606608177, 'recall': 0.5805428343180173, 'f1-score': 0.5819877756762222, 'support': 1556804}, 'weighted avg': {'precision': 0.6316140482927995, 'recall': 0.6336565168126495, 'f1-score': 0.6313790843684713, 'support': 1556804}}
[[195234 112211  49541]
 [124899 633465  87692]
 [ 72354 123628 157780]]
Evaluating performance on  train set...
2440/2440 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93997425
{'0': {'precision': 0.49344211957713735, 'recall': 0.5639161820733908, 'f1-score': 0.52633056497836, 'support': 179532}, '1': {'precision': 0.6396143177525968, 'recall': 0.6524636426918519, 'f1-score': 0.6459750888950564, 'support': 265765}, '2': {'precision': 0.5281639808509204, 'recall': 0.4369011099336271, 'f1-score': 0.4782173382173382, 'support': 179290}, 'accuracy': 0.5651334401772692, 'macro avg': {'precision': 0.5537401393935515, 'recall': 0.5510936448996232, 'f1-score': 0.5501743306969182, 'support': 624587}, 'weighted avg': {'precision': 0.5656061844005768, 'recall': 0.5651334401772692, 'f1-score': 0.5634288498814034, 'support': 624587}}
[[101241  45466  32825]
 [ 55210 173402  37153]
 [ 48722  52236  78332]]
Evaluating performance on  val set...
826/826 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85539716
{'0': {'precision': 0.5072952349881282, 'recall': 0.5394222059475399, 'f1-score': 0.5228656827946945, 'support': 51887}, '1': {'precision': 0.6820852669181718, 'recall': 0.7524491750147319, 'f1-score': 0.7155415462744068, 'support': 108608}, '2': {'precision': 0.5505171042163882, 'recall': 0.39393047131107317, 'f1-score': 0.4592429859490137, 'support': 50943}, 'accuracy': 0.6137922227792545, 'macro avg': {'precision': 0.5799658687075627, 'recall': 0.5619339507577816, 'f1-score': 0.5658834050060383, 'support': 211438}, 'weighted avg': {'precision': 0.6074922074904855, 'recall': 0.6137922227792545, 'f1-score': 0.6065072663104063, 'support': 211438}}
[[27989 17654  6244]
 [16745 81722 10141]
 [10439 20436 20068]]
testing model on single stock: results/universal/W3/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
13689/13689 - 114s - 114s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2408767
{'0': {'precision': 0.42916975965424525, 'recall': 0.6803886186516032, 'f1-score': 0.5263395340838973, 'support': 1147140}, '1': {'precision': 0.44970592502483175, 'recall': 0.10186591972576213, 'f1-score': 0.16610604074431337, 'support': 1186707}, '2': {'precision': 0.46607124329566413, 'recall': 0.5641947746025073, 'f1-score': 0.5104603189695757, 'support': 1170399}, 'accuracy': 0.4456647735347347, 'macro avg': {'precision': 0.4483156426582471, 'recall': 0.4488164376599575, 'f1-score': 0.4009686312659288, 'support': 3504246}, 'weighted avg': {'precision': 0.44844919116415227, 'recall': 0.4456647735347347, 'f1-score': 0.39904349788349225, 'support': 3504246}}
[[780501  71675 294964]
 [604312 120885 461510]
 [433817  76249 660333]]
Evaluating performance on  train set...
5475/5475 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2549394
{'0': {'precision': 0.42165818858393034, 'recall': 0.6721971934211377, 'f1-score': 0.518235692966304, 'support': 463910}, '1': {'precision': 0.4876055887527079, 'recall': 0.07217828281197879, 'f1-score': 0.12574329441582496, 'support': 464655}, '2': {'precision': 0.45349956425068816, 'recall': 0.5687725818761482, 'f1-score': 0.5046368895324844, 'support': 473001}, 'accuracy': 0.43837179269474286, 'macro avg': {'precision': 0.45425444719577546, 'recall': 0.4377160193697549, 'f1-score': 0.38287195897153775, 'support': 1401566}, 'weighted avg': {'precision': 0.4542672785284463, 'recall': 0.43837179269474286, 'f1-score': 0.38352508849140027, 'support': 1401566}}
[[311839  16795 135276]
 [242192  33538 188925]
 [185523  18448 269030]]
Evaluating performance on  val set...
2036/2036 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2299812
{'0': {'precision': 0.42733824009839155, 'recall': 0.661858898042764, 'f1-score': 0.519350642374532, 'support': 167992}, '1': {'precision': 0.5220755469061408, 'recall': 0.12394030648312561, 'f1-score': 0.2003238866396761, 'support': 179651}, '2': {'precision': 0.46297313881180685, 'recall': 0.582492668790653, 'f1-score': 0.5159010600706714, 'support': 173573}, 'accuracy': 0.45002072077603145, 'macro avg': {'precision': 0.4707956419387797, 'recall': 0.45609729110551417, 'f1-score': 0.4118585296949598, 'support': 521216}, 'weighted avg': {'precision': 0.47185895354483715, 'recall': 0.45002072077603145, 'f1-score': 0.4082407953173607, 'support': 521216}}
[[111187   9775  47030]
 [ 87138  22266  70247]
 [ 61860  10608 101105]]
training model: results/universal/W3/deepVOL_L2/h30
Epoch 1/50
10532/10532 - 354s - loss: 2.8967 - accuracy30: 0.5057 - val_loss: 3.2166 - val_accuracy30: 0.5193 - 354s/epoch - 34ms/step
Epoch 2/50
10532/10532 - 335s - loss: 2.8296 - accuracy30: 0.5248 - val_loss: 3.2029 - val_accuracy30: 0.5260 - 335s/epoch - 32ms/step
Epoch 3/50
10532/10532 - 335s - loss: 2.8038 - accuracy30: 0.5309 - val_loss: 3.1837 - val_accuracy30: 0.5253 - 335s/epoch - 32ms/step
Epoch 4/50
10532/10532 - 331s - loss: 2.7879 - accuracy30: 0.5343 - val_loss: 3.1690 - val_accuracy30: 0.5290 - 331s/epoch - 31ms/step
Epoch 5/50
10532/10532 - 335s - loss: 2.7766 - accuracy30: 0.5370 - val_loss: 3.1510 - val_accuracy30: 0.5280 - 335s/epoch - 32ms/step
Epoch 6/50
10532/10532 - 335s - loss: 2.7682 - accuracy30: 0.5387 - val_loss: 3.1388 - val_accuracy30: 0.5298 - 335s/epoch - 32ms/step
Epoch 7/50
10532/10532 - 336s - loss: 2.7621 - accuracy30: 0.5401 - val_loss: 3.1261 - val_accuracy30: 0.5311 - 336s/epoch - 32ms/step
Epoch 8/50
10532/10532 - 339s - loss: 2.7564 - accuracy30: 0.5415 - val_loss: 3.1341 - val_accuracy30: 0.5322 - 339s/epoch - 32ms/step
Epoch 9/50
10532/10532 - 341s - loss: 2.7515 - accuracy30: 0.5424 - val_loss: 3.1235 - val_accuracy30: 0.5315 - 341s/epoch - 32ms/step
Epoch 10/50
10532/10532 - 340s - loss: 2.7472 - accuracy30: 0.5436 - val_loss: 3.1104 - val_accuracy30: 0.5327 - 340s/epoch - 32ms/step
Epoch 11/50
10532/10532 - 340s - loss: 2.7432 - accuracy30: 0.5445 - val_loss: 3.1090 - val_accuracy30: 0.5346 - 340s/epoch - 32ms/step
Epoch 12/50
10532/10532 - 340s - loss: 2.7396 - accuracy30: 0.5453 - val_loss: 3.1091 - val_accuracy30: 0.5326 - 340s/epoch - 32ms/step
Epoch 13/50
10532/10532 - 344s - loss: 2.7364 - accuracy30: 0.5457 - val_loss: 3.1009 - val_accuracy30: 0.5341 - 344s/epoch - 33ms/step
Epoch 14/50
10532/10532 - 337s - loss: 2.7337 - accuracy30: 0.5465 - val_loss: 3.0965 - val_accuracy30: 0.5341 - 337s/epoch - 32ms/step
Epoch 15/50
10532/10532 - 332s - loss: 2.7310 - accuracy30: 0.5471 - val_loss: 3.0950 - val_accuracy30: 0.5345 - 332s/epoch - 31ms/step
Epoch 16/50
10532/10532 - 329s - loss: 2.7285 - accuracy30: 0.5476 - val_loss: 3.0851 - val_accuracy30: 0.5350 - 329s/epoch - 31ms/step
Epoch 17/50
10532/10532 - 333s - loss: 2.7264 - accuracy30: 0.5480 - val_loss: 3.0805 - val_accuracy30: 0.5355 - 333s/epoch - 32ms/step
Epoch 18/50
10532/10532 - 331s - loss: 2.7238 - accuracy30: 0.5485 - val_loss: 3.0743 - val_accuracy30: 0.5348 - 331s/epoch - 31ms/step
Epoch 19/50
10532/10532 - 337s - loss: 2.7221 - accuracy30: 0.5490 - val_loss: 3.0719 - val_accuracy30: 0.5358 - 337s/epoch - 32ms/step
Epoch 20/50
10532/10532 - 338s - loss: 2.7201 - accuracy30: 0.5493 - val_loss: 3.0697 - val_accuracy30: 0.5345 - 338s/epoch - 32ms/step
Epoch 21/50
10532/10532 - 332s - loss: 2.7181 - accuracy30: 0.5497 - val_loss: 3.0696 - val_accuracy30: 0.5350 - 332s/epoch - 32ms/step
Epoch 22/50
10532/10532 - 331s - loss: 2.7165 - accuracy30: 0.5500 - val_loss: 3.0829 - val_accuracy30: 0.5349 - 331s/epoch - 31ms/step
Epoch 23/50
10532/10532 - 337s - loss: 2.7148 - accuracy30: 0.5506 - val_loss: 3.0790 - val_accuracy30: 0.5348 - 337s/epoch - 32ms/step
Epoch 24/50
10532/10532 - 339s - loss: 2.7131 - accuracy30: 0.5508 - val_loss: 3.0605 - val_accuracy30: 0.5357 - 339s/epoch - 32ms/step
Epoch 25/50
10532/10532 - 331s - loss: 2.7116 - accuracy30: 0.5513 - val_loss: 3.0607 - val_accuracy30: 0.5351 - 331s/epoch - 31ms/step
Epoch 26/50
10532/10532 - 331s - loss: 2.7098 - accuracy30: 0.5515 - val_loss: 3.0477 - val_accuracy30: 0.5361 - 331s/epoch - 31ms/step
Epoch 27/50
10532/10532 - 333s - loss: 2.7086 - accuracy30: 0.5520 - val_loss: 3.0623 - val_accuracy30: 0.5360 - 333s/epoch - 32ms/step
Epoch 28/50
10532/10532 - 332s - loss: 2.7069 - accuracy30: 0.5522 - val_loss: 3.0465 - val_accuracy30: 0.5355 - 332s/epoch - 32ms/step
Epoch 29/50
10532/10532 - 337s - loss: 2.7054 - accuracy30: 0.5525 - val_loss: 3.0605 - val_accuracy30: 0.5351 - 337s/epoch - 32ms/step
Epoch 30/50
10532/10532 - 333s - loss: 2.7044 - accuracy30: 0.5530 - val_loss: 3.0302 - val_accuracy30: 0.5362 - 333s/epoch - 32ms/step
Epoch 31/50
10532/10532 - 338s - loss: 2.7033 - accuracy30: 0.5532 - val_loss: 3.0384 - val_accuracy30: 0.5353 - 338s/epoch - 32ms/step
Epoch 32/50
10532/10532 - 333s - loss: 2.7020 - accuracy30: 0.5534 - val_loss: 3.0287 - val_accuracy30: 0.5348 - 333s/epoch - 32ms/step
Epoch 33/50
10532/10532 - 335s - loss: 2.7006 - accuracy30: 0.5539 - val_loss: 3.0274 - val_accuracy30: 0.5358 - 335s/epoch - 32ms/step
Epoch 34/50
10532/10532 - 338s - loss: 2.6996 - accuracy30: 0.5540 - val_loss: 3.0241 - val_accuracy30: 0.5364 - 338s/epoch - 32ms/step
Epoch 35/50
10532/10532 - 338s - loss: 2.6980 - accuracy30: 0.5543 - val_loss: 3.0394 - val_accuracy30: 0.5354 - 338s/epoch - 32ms/step
Epoch 36/50
10532/10532 - 333s - loss: 2.6970 - accuracy30: 0.5546 - val_loss: 3.0359 - val_accuracy30: 0.5339 - 333s/epoch - 32ms/step
Epoch 37/50
10532/10532 - 343s - loss: 2.6960 - accuracy30: 0.5547 - val_loss: 3.0396 - val_accuracy30: 0.5347 - 343s/epoch - 33ms/step
Epoch 38/50
10532/10532 - 338s - loss: 2.6950 - accuracy30: 0.5550 - val_loss: 3.0403 - val_accuracy30: 0.5347 - 338s/epoch - 32ms/step
Epoch 39/50
10532/10532 - 342s - loss: 2.6939 - accuracy30: 0.5554 - val_loss: 3.0321 - val_accuracy30: 0.5338 - 342s/epoch - 32ms/step
Epoch 40/50
10532/10532 - 341s - loss: 2.6924 - accuracy30: 0.5559 - val_loss: 3.0330 - val_accuracy30: 0.5333 - 341s/epoch - 32ms/step
Epoch 41/50
10532/10532 - 334s - loss: 2.6910 - accuracy30: 0.5559 - val_loss: 3.0453 - val_accuracy30: 0.5319 - 334s/epoch - 32ms/step
Epoch 42/50
10532/10532 - 334s - loss: 2.6904 - accuracy30: 0.5562 - val_loss: 3.0591 - val_accuracy30: 0.5325 - 334s/epoch - 32ms/step
Epoch 43/50
10532/10532 - 335s - loss: 2.6891 - accuracy30: 0.5566 - val_loss: 3.0431 - val_accuracy30: 0.5346 - 335s/epoch - 32ms/step
Epoch 44/50
10532/10532 - 347s - loss: 2.6877 - accuracy30: 0.5568 - val_loss: 3.0382 - val_accuracy30: 0.5318 - 347s/epoch - 33ms/step
testing model in sample: results/universal/W3/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 434s - 434s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.026346
{'0': {'precision': 0.45369826541326913, 'recall': 0.5863303359532097, 'f1-score': 0.5115571937764684, 'support': 1986735}, '1': {'precision': 0.6949126178578623, 'recall': 0.5530699206827124, 'f1-score': 0.615930519171392, 'support': 3093777}, '2': {'precision': 0.4844488226304675, 'recall': 0.4966921157647317, 'f1-score': 0.49049407944516676, 'support': 2005965}, 'accuracy': 0.5464358382874875, 'macro avg': {'precision': 0.544353235300533, 'recall': 0.5453641241335513, 'f1-score': 0.5393272641310091, 'support': 7086477}, 'weighted avg': {'precision': 0.5677109062743307, 'recall': 0.5464358382874875, 'f1-score': 0.5511616295745019, 'support': 7086477}}
[[1164883  363590  458262]
 [ 780650 1711075  602052]
 [ 621995  387623  996347]]
Evaluating performance on  train set...
10532/10532 - 169s - 169s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0947733
{'0': {'precision': 0.43383942596097913, 'recall': 0.5959834297933149, 'f1-score': 0.5021467675125624, 'support': 768367}, '1': {'precision': 0.6871724283310517, 'recall': 0.478188397065475, 'f1-score': 0.5639418707925189, 'support': 1145262}, '2': {'precision': 0.4666450059112518, 'recall': 0.5031137373925917, 'f1-score': 0.4841936503913291, 'support': 782179}, 'accuracy': 0.518994676178719, 'macro avg': {'precision': 0.5292189534010943, 'recall': 0.5257618547504604, 'f1-score': 0.5167607628988035, 'support': 2695808}, 'weighted avg': {'precision': 0.550981483807932, 'recall': 0.518994676178719, 'f1-score': 0.523190192109507, 'support': 2695808}}
[[457934 119825 190608]
 [338437 547651 259174]
 [259167 129487 393525]]
Evaluating performance on  val set...
3814/3814 - 64s - 64s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0484303
{'0': {'precision': 0.44564399246207687, 'recall': 0.5886455339777642, 'f1-score': 0.5072590202276984, 'support': 275592}, '1': {'precision': 0.6955751422799202, 'recall': 0.5206187779945526, 'f1-score': 0.5955127295742987, 'support': 419278}, '2': {'precision': 0.4783500172824011, 'recall': 0.5073372128201021, 'f1-score': 0.4924173857771575, 'support': 280965}, 'accuracy': 0.5360065994763459, 'macro avg': {'precision': 0.5398563840081327, 'recall': 0.5388671749308064, 'f1-score': 0.5317297118597182, 'support': 975835}, 'weighted avg': {'precision': 0.562446403624792, 'recall': 0.5360065994763459, 'f1-score': 0.5409049326248021, 'support': 975835}}
[[162226  45279  68087]
 [113634 218284  87360]
 [ 88166  50255 142544]]
testing model out of sample: results/universal/W3/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 253s - 253s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91661525
{'0': {'precision': 0.4707070917842139, 'recall': 0.5242336391224105, 'f1-score': 0.496030535330297, 'support': 1032738}, '1': {'precision': 0.702172376363246, 'recall': 0.6779941135755724, 'f1-score': 0.6898714631316051, 'support': 2079021}, '2': {'precision': 0.48754972651692696, 'recall': 0.4657344950346637, 'f1-score': 0.476392497746509, 'support': 1024704}, 'accuracy': 0.5870232611774843, 'macro avg': {'precision': 0.5534763982214623, 'recall': 0.5559874159108822, 'f1-score': 0.5540981654028038, 'support': 4136463}, 'weighted avg': {'precision': 0.5912158217285972, 'recall': 0.5870232611774843, 'f1-score': 0.588591784855349, 'support': 4136463}}
[[ 541396  286209  205133]
 [ 372976 1409564  296481]
 [ 235804  311660  477240]]
Evaluating performance on  train set...
6181/6181 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99251765
{'0': {'precision': 0.4824692091768098, 'recall': 0.5173135382310137, 'f1-score': 0.49928417815548604, 'support': 464492}, '1': {'precision': 0.6151913615663492, 'recall': 0.6061612922108129, 'f1-score': 0.6106429449851998, 'support': 649182}, '2': {'precision': 0.4944426430321372, 'recall': 0.46907477468047243, 'f1-score': 0.48142476121152067, 'support': 468113}, 'accuracy': 0.5395018419041249, 'macro avg': {'precision': 0.530701071258432, 'recall': 0.5308498683740998, 'f1-score': 0.5304506281174022, 'support': 1581787}, 'weighted avg': {'precision': 0.54048318474676, 'recall': 0.5395018419041249, 'f1-score': 0.5397016817284429, 'support': 1581787}}
[[240288 118465 105739]
 [136896 393509 118777]
 [120854 127679 219580]]
Evaluating performance on  val set...
2209/2209 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9451355
{'0': {'precision': 0.4891878965660173, 'recall': 0.5032274993440042, 'f1-score': 0.4961083895167419, 'support': 152440}, '1': {'precision': 0.6471808325765475, 'recall': 0.6631614017485477, 'f1-score': 0.6550736698757352, 'support': 261131}, '2': {'precision': 0.4967790667844825, 'recall': 0.4612086930634117, 'f1-score': 0.4783335105853777, 'support': 151155}, 'accuracy': 0.5659346302454642, 'macro avg': {'precision': 0.5443825986423491, 'recall': 0.5425325313853212, 'f1-score': 0.5431718566592849, 'support': 564726}, 'weighted avg': {'precision': 0.5642761636331222, 'recall': 0.5659346302454642, 'f1-score': 0.5648567751064862, 'support': 564726}}
[[ 76712  45979  29749]
 [ 47090 173172  40869]
 [ 33013  48428  69714]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3070455
{'0': {'precision': 0.39815361987682046, 'recall': 0.5173361089308262, 'f1-score': 0.4499870134688879, 'support': 58606}, '1': {'precision': 0.36237840800109605, 'recall': 0.04654641443026837, 'f1-score': 0.08249641319942613, 'support': 56825}, '2': {'precision': 0.38596237658987814, 'recall': 0.5989372164041338, 'f1-score': 0.469422940400933, 'support': 57961}, 'accuracy': 0.3903236596844145, 'macro avg': {'precision': 0.3821648014892649, 'recall': 0.3876065799217428, 'f1-score': 0.3339687890230823, 'support': 173392}, 'weighted avg': {'precision': 0.3823539113147616, 'recall': 0.3903236596844145, 'f1-score': 0.3360479182430188, 'support': 173392}}
[[30319  2442 25845]
 [24796  2645 29384]
 [21034  2212 34715]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3173494
{'0': {'precision': 0.39466884264925883, 'recall': 0.5192574368150302, 'f1-score': 0.4484710336700988, 'support': 22355}, '1': {'precision': 0.42178447276940906, 'recall': 0.04988807163415414, 'f1-score': 0.08922297573331153, 'support': 21889}, '2': {'precision': 0.39058494523421117, 'recall': 0.6071088974417025, 'f1-score': 0.47535142608973113, 'support': 22085}, 'accuracy': 0.39361365315322105, 'macro avg': {'precision': 0.402346086884293, 'recall': 0.39208480196362894, 'f1-score': 0.3376818118310472, 'support': 66329}, 'weighted avg': {'precision': 0.4022573959711639, 'recall': 0.39361365315322105, 'f1-score': 0.3388669800345735, 'support': 66329}}
[[11608   845  9902]
 [ 9779  1092 11018]
 [ 8025   652 13408]]
Evaluating performance on  val set...
86/86 - 1s - 783ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3197385
{'0': {'precision': 0.404437564499484, 'recall': 0.5174963686781988, 'f1-score': 0.45403464056073684, 'support': 7573}, '1': {'precision': 0.3275862068965517, 'recall': 0.032506415739948676, 'f1-score': 0.059143968871595336, 'support': 7014}, '2': {'precision': 0.38595427779702113, 'recall': 0.6066421668708316, 'f1-score': 0.4717650172003175, 'support': 7347}, 'accuracy': 0.3922677122275919, 'macro avg': {'precision': 0.37265934973101894, 'recall': 0.38554831709632637, 'f1-score': 0.32831454221088324, 'support': 21934}, 'weighted avg': {'precision': 0.3736710773275153, 'recall': 0.3922677122275919, 'f1-score': 0.3336964398651665, 'support': 21934}}
[[3919  262 3392]
 [3087  228 3699]
 [2684  206 4457]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69133985
{'0': {'precision': 0.5123560032322929, 'recall': 0.4929218419482562, 'f1-score': 0.5024510707308982, 'support': 55311}, '1': {'precision': 0.8271702221613144, 'recall': 0.8357892631441286, 'f1-score': 0.8314574066102262, 'support': 259983}, '2': {'precision': 0.4635174636486284, 'recall': 0.45827080901832196, 'f1-score': 0.46087920482174627, 'support': 53979}, 'accuracy': 0.729249092135087, 'macro avg': {'precision': 0.6010145630140785, 'recall': 0.5956606380369022, 'f1-score': 0.598262560720957, 'support': 369273}, 'weighted avg': {'precision': 0.7268587953444624, 'recall': 0.729249092135087, 'f1-score': 0.7280078985276913, 'support': 369273}}
[[ 27264  21533   6514]
 [ 20575 217291  22117]
 [  5374  23868  24737]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85708344
{'0': {'precision': 0.5079672262993867, 'recall': 0.4955255350969672, 'f1-score': 0.5016692522494569, 'support': 40787}, '1': {'precision': 0.6953234294850443, 'recall': 0.7493090204242794, 'f1-score': 0.7213075102365197, 'support': 83577}, '2': {'precision': 0.5271324625230122, 'recall': 0.45425700687466947, 'f1-score': 0.48798896283070925, 'support': 39711}, 'accuracy': 0.6148103001676063, 'macro avg': {'precision': 0.5768077061024811, 'recall': 0.566363854131972, 'f1-score': 0.5703219084388953, 'support': 164075}, 'weighted avg': {'precision': 0.6080418268742708, 'recall': 0.6148103001676063, 'f1-score': 0.6102381915435411, 'support': 164075}}
[[20211 13709  6867]
 [11637 62625  9315]
 [ 7940 13732 18039]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81667423
{'0': {'precision': 0.5164200649584988, 'recall': 0.4726203844375454, 'f1-score': 0.4935503897358074, 'support': 15139}, '1': {'precision': 0.7107840903913618, 'recall': 0.7891448949138825, 'f1-score': 0.7479175905173965, 'support': 39539}, '2': {'precision': 0.5480637076562374, 'recall': 0.43894068894068894, 'f1-score': 0.4874698881817855, 'support': 15444}, 'accuracy': 0.6436781609195402, 'macro avg': {'precision': 0.591755954335366, 'recall': 0.5669019894307056, 'f1-score': 0.5763126228116632, 'support': 70122}, 'weighted avg': {'precision': 0.6329835346172913, 'recall': 0.6436781609195402, 'f1-score': 0.6356387141661279, 'support': 70122}}
[[ 7155  6184  1800]
 [ 4547 31202  3790]
 [ 2153  6512  6779]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
1359/1359 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2424799
{'0': {'precision': 0.42490152546014465, 'recall': 0.5182567829626653, 'f1-score': 0.46695893084830076, 'support': 114478}, '1': {'precision': 0.4384689273109056, 'recall': 0.324156723504397, 'f1-score': 0.37274552903810815, 'support': 121105}, '2': {'precision': 0.4322018897664343, 'recall': 0.45693204298775597, 'f1-score': 0.4442230471677272, 'support': 112218}, 'accuracy': 0.43088432753212325, 'macro avg': {'precision': 0.43185744751249483, 'recall': 0.4331151831516061, 'f1-score': 0.4279758356847121, 'support': 347801}, 'weighted avg': {'precision': 0.43198118446877204, 'recall': 0.43088432753212325, 'f1-score': 0.4268179035910762, 'support': 347801}}
[[59329 24982 30167]
 [44652 39257 37196]
 [35649 25293 51276]]
Evaluating performance on  train set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2972391
{'0': {'precision': 0.40523616289369063, 'recall': 0.5247812633376013, 'f1-score': 0.4573255070610798, 'support': 37488}, '1': {'precision': 0.43405196241017135, 'recall': 0.2089520464101336, 'f1-score': 0.2821010275202989, 'support': 37578}, '2': {'precision': 0.42204804907139204, 'recall': 0.5143939983905719, 'f1-score': 0.4636677391050014, 'support': 38523}, 'accuracy': 0.41677451161644175, 'macro avg': {'precision': 0.420445391458418, 'recall': 0.4160424360461023, 'f1-score': 0.4010314245621267, 'support': 113589}, 'weighted avg': {'precision': 0.4204707754481977, 'recall': 0.41677451161644175, 'f1-score': 0.40150792184459344, 'support': 113589}}
[[19673  5218 12597]
 [15187  7852 14539]
 [13687  5020 19816]]
Evaluating performance on  val set...
144/144 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2470217
{'0': {'precision': 0.4308599167822469, 'recall': 0.503362229603824, 'f1-score': 0.46429772447035084, 'support': 12343}, '1': {'precision': 0.4644525168655942, 'recall': 0.29825876864117307, 'f1-score': 0.3632489472883162, 'support': 12003}, '2': {'precision': 0.425933581369712, 'recall': 0.502765126870527, 'f1-score': 0.461171204774338, 'support': 12296}, 'accuracy': 0.43597511052890126, 'macro avg': {'precision': 0.4404153383391844, 'recall': 0.43479537503850807, 'f1-score': 0.42957262551100167, 'support': 36642}, 'weighted avg': {'precision': 0.44021087356866373, 'recall': 0.43597511052890126, 'f1-score': 0.43014750999793844, 'support': 36642}}
[[6213 2078 4052]
 [4143 3580 4280]
 [4064 2050 6182]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1140/1140 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.545379
{'0': {'precision': 0.33487372290552325, 'recall': 0.8322835464088972, 'f1-score': 0.4775875488702073, 'support': 96210}, '1': {'precision': 0.2557794902193242, 'recall': 0.008681219193240117, 'f1-score': 0.01679249688667497, 'support': 99410}, '2': {'precision': 0.38095044182921367, 'recall': 0.1949262905662343, 'f1-score': 0.25789288692547846, 'support': 95985}, 'accuracy': 0.34171910632533736, 'macro avg': {'precision': 0.32386788498468705, 'recall': 0.34529701872279056, 'f1-score': 0.25075764422745356, 'support': 291605}, 'weighted avg': {'precision': 0.3230766556212016, 'recall': 0.34171910632533736, 'f1-score': 0.248184663993584, 'support': 291605}}
[[80074  1354 14782]
 [82925   863 15622]
 [76118  1157 18710]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5357606
{'0': {'precision': 0.34147392792925935, 'recall': 0.8234193567546699, 'f1-score': 0.48275021545908026, 'support': 33673}, '1': {'precision': 0.25, 'recall': 0.01334692742608212, 'f1-score': 0.02534095908490981, 'support': 32367}, '2': {'precision': 0.36551991221842123, 'recall': 0.17489730998486674, 'f1-score': 0.23658923796791448, 'support': 32379}, 'accuracy': 0.3436531564027271, 'macro avg': {'precision': 0.3189979467158935, 'recall': 0.3372211980552063, 'f1-score': 0.2482268041706349, 'support': 98419}, 'weighted avg': {'precision': 0.3193018707046628, 'recall': 0.3436531564027271, 'f1-score': 0.25133746292908876, 'support': 98419}}
[[27727   678  5268]
 [27373   432  4562]
 [26098   618  5663]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5145272
{'0': {'precision': 0.3554331709383605, 'recall': 0.8180045498862528, 'f1-score': 0.49554560220504995, 'support': 12308}, '1': {'precision': 0.29782608695652174, 'recall': 0.011497146693521317, 'f1-score': 0.022139625080801553, 'support': 11916}, '2': {'precision': 0.3470007593014427, 'recall': 0.2049878891181484, 'f1-score': 0.257726144822919, 'support': 11147}, 'accuracy': 0.3531141330468463, 'macro avg': {'precision': 0.33342000573210834, 'recall': 0.34482986189930753, 'f1-score': 0.2584704573695902, 'support': 35371}, 'weighted avg': {'precision': 0.33336870837738364, 'recall': 0.3531141330468463, 'f1-score': 0.2611140307241431, 'support': 35371}}
[[10068   148  2092]
 [ 9571   137  2208]
 [ 8687   175  2285]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.216731
{'0': {'precision': 0.4343094810932963, 'recall': 0.5506145836542312, 'f1-score': 0.48559506802297553, 'support': 194766}, '1': {'precision': 0.44998755589121275, 'recall': 0.2751608467940846, 'f1-score': 0.34149963363999025, 'support': 190554}, '2': {'precision': 0.4576447170949123, 'recall': 0.5080357367560085, 'f1-score': 0.4815254779045193, 'support': 198675}, 'accuracy': 0.4462503959794176, 'macro avg': {'precision': 0.4473139180264738, 'recall': 0.44460372240144147, 'f1-score': 0.436206726522495, 'support': 583995}, 'weighted avg': {'precision': 0.44736378443093316, 'recall': 0.4462503959794176, 'f1-score': 0.43719313441018826, 'support': 583995}}
[[107241  32421  55104]
 [ 73608  52433  64513]
 [ 66074  31667 100934]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2392684
{'0': {'precision': 0.43132857917167056, 'recall': 0.5452994209090787, 'f1-score': 0.4816638974602421, 'support': 74427}, '1': {'precision': 0.4695073235685752, 'recall': 0.23805344387582872, 'f1-score': 0.31592434301893213, 'support': 74059}, '2': {'precision': 0.4433512352309345, 'recall': 0.5412748993535019, 'f1-score': 0.48744368405203203, 'support': 76257}, 'accuracy': 0.4426878701450101, 'macro avg': {'precision': 0.4480623793237268, 'recall': 0.4415425880461365, 'f1-score': 0.42834397484373543, 'support': 224743}, 'weighted avg': {'precision': 0.4479889036952448, 'recall': 0.4426878701450101, 'f1-score': 0.4290092809594441, 'support': 224743}}
[[40585 10043 23799]
 [28404 17630 28025]
 [25104  9877 41276]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2567022
{'0': {'precision': 0.4299818783978004, 'recall': 0.5445552389996834, 'f1-score': 0.4805335381821991, 'support': 25272}, '1': {'precision': 0.45794392523364486, 'recall': 0.23343920145190564, 'f1-score': 0.3092411720510894, 'support': 26448}, '2': {'precision': 0.4380940431004737, 'recall': 0.5445471205209186, 'f1-score': 0.48555435802941277, 'support': 25647}, 'accuracy': 0.43819716416560034, 'macro avg': {'precision': 0.4420066155773063, 'recall': 0.4408471869908359, 'f1-score': 0.4251096894209005, 'support': 77367}, 'weighted avg': {'precision': 0.44222990278602625, 'recall': 0.43819716416560034, 'f1-score': 0.4236414325969483, 'support': 77367}}
[[13762  3720  7790]
 [10151  6174 10123]
 [ 8093  3588 13966]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
5098/5098 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66350657
{'0': {'precision': 0.5677281285958367, 'recall': 0.5165548994491614, 'f1-score': 0.5409339421461692, 'support': 252161}, '1': {'precision': 0.7572159753151764, 'recall': 0.8355003528862116, 'f1-score': 0.7944342672763909, 'support': 804792}, '2': {'precision': 0.5743316763030445, 'recall': 0.4342590277385686, 'f1-score': 0.4945687370533848, 'support': 247958}, 'accuracy': 0.6976238226208531, 'macro avg': {'precision': 0.6330919267380192, 'recall': 0.5954380933579806, 'f1-score': 0.6099789821586482, 'support': 1304911}, 'weighted avg': {'precision': 0.6858478360849564, 'recall': 0.6976238226208531, 'f1-score': 0.6884676897640564, 'support': 1304911}}
[[130255 100636  21270]
 [ 73852 672404  58536]
 [ 25325 114955 107678]]
Evaluating performance on  train set...
1876/1876 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6670648
{'0': {'precision': 0.5564893515423551, 'recall': 0.5095368740914009, 'f1-score': 0.5319791161450458, 'support': 91487}, '1': {'precision': 0.7695218567670858, 'recall': 0.8318472201040449, 'f1-score': 0.7994716853303107, 'support': 295065}, '2': {'precision': 0.5805539780060922, 'recall': 0.480262666168384, 'f1-score': 0.5256674711186168, 'support': 93655}, 'accuracy': 0.7018723175630509, 'macro avg': {'precision': 0.6355217287718444, 'recall': 0.6072155867879433, 'f1-score': 0.6190394241979912, 'support': 480207}, 'weighted avg': {'precision': 0.6920813123958962, 'recall': 0.7018723175630509, 'f1-score': 0.6951099697388085, 'support': 480207}}
[[ 46616  34880   9991]
 [ 27110 245449  22506]
 [ 10042  38634  44979]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.63501847
{'0': {'precision': 0.5508430319307669, 'recall': 0.5290745584178281, 'f1-score': 0.5397393958222921, 'support': 27911}, '1': {'precision': 0.7772372307079053, 'recall': 0.8433319243888293, 'f1-score': 0.8089367459797371, 'support': 101731}, '2': {'precision': 0.606930412614484, 'recall': 0.44747650539505746, 'f1-score': 0.5151466581182882, 'support': 28730}, 'accuracy': 0.716136690829187, 'macro avg': {'precision': 0.6450035584177187, 'recall': 0.606627662733905, 'f1-score': 0.6212742666401058, 'support': 158372}, 'weighted avg': {'precision': 0.7064431296932517, 'recall': 0.716136690829187, 'f1-score': 0.7081982539198788, 'support': 158372}}
[[14767 11062  2082]
 [ 9694 85793  6244]
 [ 2347 13527 12856]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
5760/5760 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7101139
{'0': {'precision': 0.4745423331351146, 'recall': 0.5573694158685812, 'f1-score': 0.51263178906491, 'support': 253419}, '1': {'precision': 0.7929379808950404, 'recall': 0.8048367934803871, 'f1-score': 0.7988430812745111, 'support': 971346}, '2': {'precision': 0.5377374304602458, 'recall': 0.4110954482471386, 'f1-score': 0.4659649027244419, 'support': 249706}, 'accuracy': 0.6956230403988956, 'macro avg': {'precision': 0.601739248163467, 'recall': 0.5911005525320356, 'f1-score': 0.5924799243546209, 'support': 1474471}, 'weighted avg': {'precision': 0.6949959967484933, 'recall': 0.6956230403988956, 'f1-score': 0.6932777239948573, 'support': 1474471}}
[[141248  90522  21649]
 [122975 781775  66596]
 [ 33428 113625 102653]]
Evaluating performance on  train set...
2159/2159 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8151342
{'0': {'precision': 0.5185095040316565, 'recall': 0.5140417516384638, 'f1-score': 0.5162659620623746, 'support': 128474}, '1': {'precision': 0.6909844133781848, 'recall': 0.7656596683055449, 'f1-score': 0.7264079172173687, 'support': 294307}, '2': {'precision': 0.5584449671407948, 'recall': 0.42632438847701104, 'f1-score': 0.4835217663023289, 'support': 129758}, 'accuracy': 0.6274652106005187, 'macro avg': {'precision': 0.5893129615168787, 'recall': 0.5686752694736733, 'f1-score': 0.5753985485273575, 'support': 552539}, 'weighted avg': {'precision': 0.619755785230204, 'recall': 0.6274652106005187, 'f1-score': 0.6205073405756901, 'support': 552539}}
[[ 66041  47334  15099]
 [ 40327 225339  28641]
 [ 20999  53440  55319]]
Evaluating performance on  val set...
850/850 - 18s - 18s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7763466
{'0': {'precision': 0.5184976850850245, 'recall': 0.507163263146757, 'f1-score': 0.512767846636071, 'support': 47255}, '1': {'precision': 0.7168084548214219, 'recall': 0.7779847710780645, 'f1-score': 0.746144753627033, 'support': 122924}, '2': {'precision': 0.5540734061737562, 'recall': 0.4429673917652546, 'f1-score': 0.4923298065367486, 'support': 47166}, 'accuracy': 0.6464008833881617, 'macro avg': {'precision': 0.5964598486934009, 'recall': 0.5760384753300254, 'f1-score': 0.5837474689332843, 'support': 217345}, 'weighted avg': {'precision': 0.6383767599197252, 'recall': 0.6464008833881617, 'f1-score': 0.6403237706998055, 'support': 217345}}
[[23966 18144  5145]
 [15621 95633 11670]
 [ 6635 19638 20893]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
6315/6315 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78568625
{'0': {'precision': 0.5380955974368166, 'recall': 0.4728103061965924, 'f1-score': 0.5033448578600851, 'support': 361957}, '1': {'precision': 0.6939783663268838, 'recall': 0.8139254558094683, 'f1-score': 0.7491812804536321, 'support': 891820}, '2': {'precision': 0.5852645005902439, 'recall': 0.40738146774571576, 'f1-score': 0.48038458599616657, 'support': 362665}, 'accuracy': 0.6463300260696022, 'macro avg': {'precision': 0.6057794881179814, 'recall': 0.5647057432505921, 'f1-score': 0.5776369081032946, 'support': 1616442}, 'weighted avg': {'precision': 0.6346817299511149, 'recall': 0.6463300260696022, 'f1-score': 0.6338258472193378, 'support': 1616442}}
[[171137 153653  37167]
 [ 98417 725875  67528]
 [ 48488 166434 147743]]
Evaluating performance on  train set...
2155/2155 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8316291
{'0': {'precision': 0.5508344259376163, 'recall': 0.4922467164265463, 'f1-score': 0.5198951959728366, 'support': 138264}, '1': {'precision': 0.6573046489087515, 'recall': 0.7794189926792043, 'f1-score': 0.7131722657108561, 'support': 270599}, '2': {'precision': 0.5846310404063036, 'recall': 0.4388973773111482, 'f1-score': 0.5013891669001961, 'support': 142678}, 'accuracy': 0.619339269428746, 'macro avg': {'precision': 0.5975900384175571, 'recall': 0.5701876954722996, 'f1-score': 0.5781522095279629, 'support': 551541}, 'weighted avg': {'precision': 0.6118140615856091, 'recall': 0.619339269428746, 'f1-score': 0.6099341569530939, 'support': 551541}}
[[ 68060  52099  18105]
 [ 33303 210910  26386]
 [ 22195  57862  62621]]
Evaluating performance on  val set...
746/746 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7959674
{'0': {'precision': 0.5343233674272226, 'recall': 0.5061486864169927, 'f1-score': 0.5198545593723088, 'support': 42936}, '1': {'precision': 0.6978955141222078, 'recall': 0.7966494573806764, 'f1-score': 0.744009840098401, 'support': 104401}, '2': {'precision': 0.5689141969716578, 'recall': 0.4050026487320635, 'f1-score': 0.47316515304406326, 'support': 43417}, 'accuracy': 0.6421202176625392, 'macro avg': {'precision': 0.6003776928403627, 'recall': 0.5692669308432442, 'f1-score': 0.5790098508382576, 'support': 190754}, 'weighted avg': {'precision': 0.6317206735567605, 'recall': 0.6421202176625392, 'f1-score': 0.6319094652119311, 'support': 190754}}
[[21732 16620  4584]
 [12490 83171  8740]
 [ 6450 19383 17584]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
6082/6082 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8833823
{'0': {'precision': 0.5214904123645225, 'recall': 0.4940590907212937, 'f1-score': 0.5074042735874723, 'support': 411469}, '1': {'precision': 0.6601367993794668, 'recall': 0.7218878476604829, 'f1-score': 0.6896327562409211, 'support': 739191}, '2': {'precision': 0.52316516191634, 'recall': 0.4619765403403719, 'f1-score': 0.4906705928194292, 'support': 406144}, 'accuracy': 0.5938653806131022, 'macro avg': {'precision': 0.5682641245534431, 'recall': 0.5593078262407162, 'f1-score': 0.5625692075492742, 'support': 1556804}, 'weighted avg': {'precision': 0.587758453136474, 'recall': 0.5938653806131022, 'f1-score': 0.5895632160614314, 'support': 1556804}}
[[203290 135734  72445]
 [107010 533613  98568]
 [ 79525 138990 187629]]
Evaluating performance on  train set...
2440/2440 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97054225
{'0': {'precision': 0.5171059728502225, 'recall': 0.5084759204552214, 'f1-score': 0.5127546366296869, 'support': 201748}, '1': {'precision': 0.5556739770149172, 'recall': 0.6406760364853693, 'f1-score': 0.5951552591709718, 'support': 221349}, '2': {'precision': 0.5271437510599601, 'recall': 0.4473671149932999, 'f1-score': 0.4839900452901712, 'support': 201490}, 'accuracy': 0.5356131331583911, 'macro avg': {'precision': 0.5333079003083666, 'recall': 0.5321730239779635, 'f1-score': 0.5306333136969433, 'support': 624587}, 'weighted avg': {'precision': 0.5340123463183398, 'recall': 0.5356131331583911, 'f1-score': 0.5326774302355285, 'support': 624587}}
[[102584  54712  44452]
 [ 43131 141813  36405]
 [ 52666  58684  90140]]
Evaluating performance on  val set...
826/826 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91387796
{'0': {'precision': 0.5323605683187844, 'recall': 0.4858742937146857, 'f1-score': 0.5080562938434056, 'support': 59997}, '1': {'precision': 0.6017425770858255, 'recall': 0.7268120161307714, 'f1-score': 0.6583903106075405, 'support': 92742}, '2': {'precision': 0.542093950114191, 'recall': 0.41246017819724357, 'f1-score': 0.4684745697119803, 'support': 58699}, 'accuracy': 0.5711745287034498, 'macro avg': {'precision': 0.5587323651729336, 'recall': 0.5417154960142335, 'f1-score': 0.5449737247209755, 'support': 211438}, 'weighted avg': {'precision': 0.5654954165252634, 'recall': 0.5711745287034498, 'f1-score': 0.5630079570162926, 'support': 211438}}
[[29151 21684  9162]
 [14047 67406 11289]
 [11560 22928 24211]]
testing model on single stock: results/universal/W3/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
13689/13689 - 98s - 98s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2646017
{'0': {'precision': 0.43754188741357736, 'recall': 0.6191200364262924, 'f1-score': 0.5127296501592774, 'support': 1221096}, '1': {'precision': 0.35946305035048337, 'recall': 0.0907251303754582, 'f1-score': 0.14488311112752522, 'support': 1037772}, '2': {'precision': 0.4605058119111825, 'recall': 0.5600106955478578, 'f1-score': 0.5054071700894323, 'support': 1245378}, 'accuracy': 0.4416305247976312, 'macro avg': {'precision': 0.4191702498917477, 'recall': 0.42328528744986943, 'f1-score': 0.3876733104587449, 'support': 3504246}, 'weighted avg': {'precision': 0.4225802481526172, 'recall': 0.4416305247976312, 'f1-score': 0.4011906503035358, 'support': 3504246}}
[[756005  86471 378620]
 [505189  94152 438431]
 [466652  81301 697425]]
Evaluating performance on  train set...
5475/5475 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.342044
{'0': {'precision': 0.4055660699156039, 'recall': 0.6352734856384491, 'f1-score': 0.495072212652073, 'support': 464156}, '1': {'precision': 0.43037974683544306, 'recall': 0.0609376819783718, 'f1-score': 0.10675926643151465, 'support': 463654}, '2': {'precision': 0.4301187940263012, 'recall': 0.5527866665540911, 'f1-score': 0.48379817573028516, 'support': 473756}, 'accuracy': 0.4173945429612305, 'macro avg': {'precision': 0.4220215369257827, 'recall': 0.41633261139030403, 'f1-score': 0.3618765516046243, 'support': 1401566}, 'weighted avg': {'precision': 0.4220740052696141, 'recall': 0.4173945429612305, 'f1-score': 0.3628030270390763, 'support': 1401566}}
[[294866  18661 150629]
 [239046  28254 196354]
 [193136  18734 261886]]
Evaluating performance on  val set...
2036/2036 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2661349
{'0': {'precision': 0.4275543219729285, 'recall': 0.6133966542205778, 'f1-score': 0.5038861514012153, 'support': 177298}, '1': {'precision': 0.45377792295901703, 'recall': 0.11168834381629157, 'f1-score': 0.17925633288334789, 'support': 161691}, '2': {'precision': 0.455381051370587, 'recall': 0.5674076838229242, 'f1-score': 0.5052591971814123, 'support': 182227}, 'accuracy': 0.4416786898330059, 'macro avg': {'precision': 0.44557109876751083, 'recall': 0.4308308939532645, 'f1-score': 0.3961338938219918, 'support': 521216}, 'weighted avg': {'precision': 0.44541812831231326, 'recall': 0.4416786898330059, 'f1-score': 0.4036599227885393, 'support': 521216}}
[[108754  11207  57337]
 [ 77310  18059  66322]
 [ 68299  10531 103397]]
training model: results/universal/W3/deepVOL_L3/h10
Epoch 1/50
10532/10532 - 582s - loss: 2.7182 - accuracy10: 0.5444 - val_loss: 2.8565 - val_accuracy10: 0.5458 - 582s/epoch - 55ms/step
Epoch 2/50
10532/10532 - 560s - loss: 2.6155 - accuracy10: 0.5723 - val_loss: 2.7284 - val_accuracy10: 0.5651 - 560s/epoch - 53ms/step
Epoch 3/50
10532/10532 - 573s - loss: 2.5771 - accuracy10: 0.5799 - val_loss: 2.7203 - val_accuracy10: 0.5592 - 573s/epoch - 54ms/step
Epoch 4/50
10532/10532 - 566s - loss: 2.5578 - accuracy10: 0.5836 - val_loss: 2.6670 - val_accuracy10: 0.5681 - 566s/epoch - 54ms/step
Epoch 5/50
10532/10532 - 582s - loss: 2.5448 - accuracy10: 0.5859 - val_loss: 2.6974 - val_accuracy10: 0.5605 - 582s/epoch - 55ms/step
Epoch 6/50
10532/10532 - 563s - loss: 2.5352 - accuracy10: 0.5877 - val_loss: 2.6549 - val_accuracy10: 0.5681 - 563s/epoch - 53ms/step
Epoch 7/50
10532/10532 - 573s - loss: 2.5281 - accuracy10: 0.5888 - val_loss: 2.6700 - val_accuracy10: 0.5658 - 573s/epoch - 54ms/step
Epoch 8/50
10532/10532 - 580s - loss: 2.5214 - accuracy10: 0.5904 - val_loss: 2.6962 - val_accuracy10: 0.5630 - 580s/epoch - 55ms/step
Epoch 9/50
10532/10532 - 579s - loss: 2.5163 - accuracy10: 0.5911 - val_loss: 2.6620 - val_accuracy10: 0.5699 - 579s/epoch - 55ms/step
Epoch 10/50
10532/10532 - 577s - loss: 2.5114 - accuracy10: 0.5920 - val_loss: 2.6472 - val_accuracy10: 0.5737 - 577s/epoch - 55ms/step
Epoch 11/50
10532/10532 - 578s - loss: 2.5079 - accuracy10: 0.5928 - val_loss: 2.6389 - val_accuracy10: 0.5757 - 578s/epoch - 55ms/step
Epoch 12/50
10532/10532 - 585s - loss: 2.5033 - accuracy10: 0.5937 - val_loss: 2.6181 - val_accuracy10: 0.5765 - 585s/epoch - 56ms/step
Epoch 13/50
10532/10532 - 597s - loss: 2.5000 - accuracy10: 0.5944 - val_loss: 2.6194 - val_accuracy10: 0.5765 - 597s/epoch - 57ms/step
Epoch 14/50
10532/10532 - 583s - loss: 2.4969 - accuracy10: 0.5949 - val_loss: 2.6250 - val_accuracy10: 0.5746 - 583s/epoch - 55ms/step
Epoch 15/50
10532/10532 - 594s - loss: 2.4939 - accuracy10: 0.5956 - val_loss: 2.6180 - val_accuracy10: 0.5762 - 594s/epoch - 56ms/step
Epoch 16/50
10532/10532 - 580s - loss: 2.4911 - accuracy10: 0.5961 - val_loss: 2.6113 - val_accuracy10: 0.5787 - 580s/epoch - 55ms/step
Epoch 17/50
10532/10532 - 596s - loss: 2.4892 - accuracy10: 0.5964 - val_loss: 2.6099 - val_accuracy10: 0.5767 - 596s/epoch - 57ms/step
Epoch 18/50
10532/10532 - 587s - loss: 2.4862 - accuracy10: 0.5970 - val_loss: 2.6174 - val_accuracy10: 0.5768 - 587s/epoch - 56ms/step
Epoch 19/50
10532/10532 - 589s - loss: 2.4838 - accuracy10: 0.5974 - val_loss: 2.6093 - val_accuracy10: 0.5800 - 589s/epoch - 56ms/step
Epoch 20/50
10532/10532 - 594s - loss: 2.4820 - accuracy10: 0.5977 - val_loss: 2.6138 - val_accuracy10: 0.5774 - 594s/epoch - 56ms/step
Epoch 21/50
10532/10532 - 588s - loss: 2.4800 - accuracy10: 0.5983 - val_loss: 2.6094 - val_accuracy10: 0.5788 - 588s/epoch - 56ms/step
Epoch 22/50
10532/10532 - 589s - loss: 2.4781 - accuracy10: 0.5985 - val_loss: 2.6132 - val_accuracy10: 0.5778 - 589s/epoch - 56ms/step
Epoch 23/50
10532/10532 - 584s - loss: 2.4764 - accuracy10: 0.5988 - val_loss: 2.6063 - val_accuracy10: 0.5799 - 584s/epoch - 55ms/step
Epoch 24/50
10532/10532 - 590s - loss: 2.4751 - accuracy10: 0.5991 - val_loss: 2.6237 - val_accuracy10: 0.5776 - 590s/epoch - 56ms/step
Epoch 25/50
10532/10532 - 574s - loss: 2.4734 - accuracy10: 0.5992 - val_loss: 2.6185 - val_accuracy10: 0.5766 - 574s/epoch - 55ms/step
Epoch 26/50
10532/10532 - 578s - loss: 2.4717 - accuracy10: 0.5998 - val_loss: 2.6028 - val_accuracy10: 0.5793 - 578s/epoch - 55ms/step
Epoch 27/50
10532/10532 - 612s - loss: 2.4702 - accuracy10: 0.6000 - val_loss: 2.6123 - val_accuracy10: 0.5771 - 612s/epoch - 58ms/step
Epoch 28/50
10532/10532 - 606s - loss: 2.4690 - accuracy10: 0.6004 - val_loss: 2.5973 - val_accuracy10: 0.5795 - 606s/epoch - 58ms/step
Epoch 29/50
10532/10532 - 597s - loss: 2.4674 - accuracy10: 0.6006 - val_loss: 2.5966 - val_accuracy10: 0.5782 - 597s/epoch - 57ms/step
Epoch 30/50
10532/10532 - 599s - loss: 2.4663 - accuracy10: 0.6009 - val_loss: 2.6059 - val_accuracy10: 0.5777 - 599s/epoch - 57ms/step
Epoch 31/50
10532/10532 - 565s - loss: 2.4646 - accuracy10: 0.6012 - val_loss: 2.6008 - val_accuracy10: 0.5781 - 565s/epoch - 54ms/step
Epoch 32/50
10532/10532 - 576s - loss: 2.4638 - accuracy10: 0.6014 - val_loss: 2.5987 - val_accuracy10: 0.5762 - 576s/epoch - 55ms/step
Epoch 33/50
10532/10532 - 579s - loss: 2.4626 - accuracy10: 0.6016 - val_loss: 2.5936 - val_accuracy10: 0.5781 - 579s/epoch - 55ms/step
Epoch 34/50
10532/10532 - 578s - loss: 2.4613 - accuracy10: 0.6017 - val_loss: 2.6028 - val_accuracy10: 0.5779 - 578s/epoch - 55ms/step
Epoch 35/50
10532/10532 - 570s - loss: 2.4605 - accuracy10: 0.6019 - val_loss: 2.6033 - val_accuracy10: 0.5750 - 570s/epoch - 54ms/step
Epoch 36/50
10532/10532 - 587s - loss: 2.4593 - accuracy10: 0.6022 - val_loss: 2.6000 - val_accuracy10: 0.5773 - 587s/epoch - 56ms/step
Epoch 37/50
10532/10532 - 587s - loss: 2.4583 - accuracy10: 0.6025 - val_loss: 2.6013 - val_accuracy10: 0.5743 - 587s/epoch - 56ms/step
Epoch 38/50
10532/10532 - 574s - loss: 2.4571 - accuracy10: 0.6027 - val_loss: 2.5937 - val_accuracy10: 0.5763 - 574s/epoch - 54ms/step
Epoch 39/50
10532/10532 - 575s - loss: 2.4562 - accuracy10: 0.6029 - val_loss: 2.6009 - val_accuracy10: 0.5745 - 575s/epoch - 55ms/step
Epoch 40/50
10532/10532 - 587s - loss: 2.4553 - accuracy10: 0.6031 - val_loss: 2.5954 - val_accuracy10: 0.5761 - 587s/epoch - 56ms/step
Epoch 41/50
10532/10532 - 585s - loss: 2.4544 - accuracy10: 0.6033 - val_loss: 2.6012 - val_accuracy10: 0.5750 - 585s/epoch - 56ms/step
Epoch 42/50
10532/10532 - 597s - loss: 2.4533 - accuracy10: 0.6035 - val_loss: 2.6039 - val_accuracy10: 0.5753 - 597s/epoch - 57ms/step
Epoch 43/50
10532/10532 - 572s - loss: 2.4524 - accuracy10: 0.6038 - val_loss: 2.5968 - val_accuracy10: 0.5754 - 572s/epoch - 54ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 923s - 923s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86548173
{'0': {'precision': 0.40492547337947515, 'recall': 0.7145287949872478, 'f1-score': 0.5169142120930217, 'support': 1587950}, '1': {'precision': 0.8349679711237686, 'recall': 0.5931531461207041, 'f1-score': 0.6935880619673002, 'support': 3894431}, '2': {'precision': 0.48161349299161627, 'recall': 0.45571150355090967, 'f1-score': 0.46830461116729094, 'support': 1604096}, 'accuracy': 0.5892399001647787, 'macro avg': {'precision': 0.5738356458316201, 'recall': 0.5877978148862871, 'f1-score': 0.5596022950758709, 'support': 7086477}, 'weighted avg': {'precision': 0.658617932981131, 'recall': 0.5892399001647787, 'f1-score': 0.6030034848632819, 'support': 7086477}}
[[1134636  202486  250828]
 [1048445 2309994  535992]
 [ 619005  254086  731005]]
Evaluating performance on  train set...
10532/10532 - 352s - 352s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90509754
{'0': {'precision': 0.41441861149813863, 'recall': 0.7138024639799541, 'f1-score': 0.5243884065561699, 'support': 670460}, '1': {'precision': 0.829528783850673, 'recall': 0.5515043986872435, 'f1-score': 0.6625311816050667, 'support': 1343128}, '2': {'precision': 0.4808010135348881, 'recall': 0.45670458209961595, 'f1-score': 0.46844312606136146, 'support': 682220}, 'accuracy': 0.5678779794406723, 'macro avg': {'precision': 0.5749161362945666, 'recall': 0.5740038149222711, 'f1-score': 0.5517875714075328, 'support': 2695808}, 'weighted avg': {'precision': 0.6380374663605866, 'recall': 0.5678779794406723, 'f1-score': 0.5790571514766933, 'support': 2695808}}
[[478576  66941 124943]
 [390874 740741 211513]
 [285363  85284 311573]]
Evaluating performance on  val set...
3814/3814 - 124s - 124s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8854513
{'0': {'precision': 0.40568934863423306, 'recall': 0.7011608417654727, 'f1-score': 0.5139873266515739, 'support': 225526}, '1': {'precision': 0.8328776726253067, 'recall': 0.573464903812738, 'f1-score': 0.679245757644016, 'support': 517948}, '2': {'precision': 0.4755196596768499, 'recall': 0.46951941160521776, 'f1-score': 0.47250048723445726, 'support': 232361}, 'accuracy': 0.5782258271121655, 'macro avg': {'precision': 0.5713622269787965, 'recall': 0.5813817190611428, 'f1-score': 0.5552445238433491, 'support': 975835}, 'weighted avg': {'precision': 0.6490575194199725, 'recall': 0.5782258271121655, 'f1-score': 0.5918235902841272, 'support': 975835}}
[[158130  26595  40801]
 [141393 297025  79530]
 [ 90258  33005 109098]]
testing model out of sample: results/universal/W3/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 542s - 542s/epoch - 34ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73255795
{'0': {'precision': 0.4291932355127341, 'recall': 0.6719207780798024, 'f1-score': 0.523803800864203, 'support': 775139}, '1': {'precision': 0.84272034400345, 'recall': 0.7360001268330371, 'f1-score': 0.7857531355664041, 'support': 2586077}, '2': {'precision': 0.5047631805914502, 'recall': 0.43256923277355475, 'f1-score': 0.4658859944401763, 'support': 775247}, 'accuracy': 0.6671238205200917, 'macro avg': {'precision': 0.5922255867025448, 'recall': 0.6134967125621315, 'f1-score': 0.5918143102902611, 'support': 4136463}, 'weighted avg': {'precision': 0.7018895747176984, 'recall': 0.6671238205200917, 'f1-score': 0.6767171821665032, 'support': 4136463}}
[[ 520832  157509   96798]
 [ 450503 1903353  232221]
 [ 242179  197720  335348]]
Evaluating performance on  train set...
6181/6181 - 231s - 231s/epoch - 37ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84308445
{'0': {'precision': 0.42913574850320857, 'recall': 0.6733559714624644, 'f1-score': 0.5241964426393095, 'support': 355742}, '1': {'precision': 0.7943608895307511, 'recall': 0.6490143909181312, 'f1-score': 0.7143695141122984, 'support': 867839}, '2': {'precision': 0.49521690060245754, 'recall': 0.4348559208946807, 'f1-score': 0.46307772117767193, 'support': 358206}, 'accuracy': 0.6059911985621326, 'macro avg': {'precision': 0.5729045128788058, 'recall': 0.5857420944250921, 'f1-score': 0.5672145593097601, 'support': 1581787}, 'weighted avg': {'precision': 0.6444790825507543, 'recall': 0.6059911985621326, 'f1-score': 0.6146931501189891, 'support': 1581787}}
[[239541  63626  52575]
 [198397 563240 106202]
 [120256  82182 155768]]
Evaluating performance on  val set...
2209/2209 - 80s - 80s/epoch - 36ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7675214
{'0': {'precision': 0.43742876816411813, 'recall': 0.6523174704341053, 'f1-score': 0.5236860058557662, 'support': 112968}, '1': {'precision': 0.8161735436284266, 'recall': 0.7185018095723285, 'f1-score': 0.7642296030871004, 'support': 339583}, '2': {'precision': 0.5003545115447455, 'recall': 0.4340806775128148, 'f1-score': 0.4648673935042866, 'support': 112175}, 'accuracy': 0.6487659502130236, 'macro avg': {'precision': 0.5846522744457635, 'recall': 0.6016333191730828, 'f1-score': 0.5842610008157177, 'support': 564726}, 'weighted avg': {'precision': 0.6776762197604996, 'recall': 0.6487659502130236, 'f1-score': 0.6566470144476868, 'support': 564726}}
[[ 73691  24613  14664]
 [ 61632 243991  33960]
 [ 33141  30341  48693]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.243893
{'0': {'precision': 0.3374347113078593, 'recall': 0.7307044913375482, 'f1-score': 0.46167214624308567, 'support': 48716}, '1': {'precision': 0.6258158085569253, 'recall': 0.05738566089928584, 'f1-score': 0.1051310788422181, 'support': 75193}, '2': {'precision': 0.3813028653858763, 'recall': 0.47008063375300607, 'f1-score': 0.4210631114972802, 'support': 49483}, 'accuracy': 0.36433630155947216, 'macro avg': {'precision': 0.44818446175022036, 'recall': 0.4193902619966134, 'f1-score': 0.32928877886086133, 'support': 173392}, 'weighted avg': {'precision': 0.47501296009495175, 'recall': 0.36433630155947216, 'f1-score': 0.2954658083070787, 'support': 173392}}
[[35597  1147 11972]
 [45107  4315 25771]
 [24789  1433 23261]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2638104
{'0': {'precision': 0.3438436912444738, 'recall': 0.7123381408569323, 'f1-score': 0.463808348755912, 'support': 18998}, '1': {'precision': 0.67265625, 'recall': 0.05967563071804824, 'f1-score': 0.10962566844919786, 'support': 28856}, '2': {'precision': 0.3584859284748679, 'recall': 0.47366711772665765, 'f1-score': 0.40810520915916615, 'support': 18475}, 'accuracy': 0.36192314070768444, 'macro avg': {'precision': 0.4583286232397805, 'recall': 0.4152269631005461, 'f1-score': 0.3271797421214253, 'support': 66329}, 'weighted avg': {'precision': 0.4909698431279786, 'recall': 0.36192314070768444, 'f1-score': 0.29420815989462323, 'support': 66329}}
[[13533   388  5077]
 [16551  1722 10583]
 [ 9274   450  8751]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2641901
{'0': {'precision': 0.34841982052282483, 'recall': 0.69765625, 'f1-score': 0.4647410876919074, 'support': 6400}, '1': {'precision': 0.5665322580645161, 'recall': 0.03020206362854686, 'f1-score': 0.057346938775510205, 'support': 9304}, '2': {'precision': 0.346515133944103, 'recall': 0.4796147672552167, 'f1-score': 0.4023429610179761, 'support': 6230}, 'accuracy': 0.35260326433846995, 'macro avg': {'precision': 0.42048907084381465, 'recall': 0.4024910269612545, 'f1-score': 0.30814366249513125, 'support': 21934}, 'weighted avg': {'precision': 0.44039811547597785, 'recall': 0.35260326433846995, 'f1-score': 0.27420878666625087, 'support': 21934}}
[[4465  105 1830]
 [5218  281 3805]
 [3132  110 2988]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50353783
{'0': {'precision': 0.420892657174852, 'recall': 0.6159789288849868, 'f1-score': 0.5000831571194373, 'support': 34170}, '1': {'precision': 0.9207913892170083, 'recall': 0.8750898247217503, 'f1-score': 0.8973591005253274, 'support': 301977}, '2': {'precision': 0.44884744082290245, 'recall': 0.43733019380547, 'f1-score': 0.44301397510779483, 'support': 33126}, 'accuracy': 0.8118438120306657, 'macro avg': {'precision': 0.5968438290715876, 'recall': 0.6427996491374025, 'f1-score': 0.6134854109175198, 'support': 369273}, 'weighted avg': {'precision': 0.8321979775449293, 'recall': 0.8118438120306657, 'f1-score': 0.8198404202785711, 'support': 369273}}
[[ 21048   9836   3286]
 [ 23217 264257  14503]
 [  5743  12896  14487]]
Evaluating performance on  train set...
641/641 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73515975
{'0': {'precision': 0.40067212676934033, 'recall': 0.648406266882766, 'f1-score': 0.495288663906351, 'support': 27765}, '1': {'precision': 0.8451661863789727, 'recall': 0.7523484357455199, 'f1-score': 0.7960608929157893, 'support': 109541}, '2': {'precision': 0.4969489644970414, 'recall': 0.4015839217004744, 'f1-score': 0.4442056982293754, 'support': 26769}, 'accuracy': 0.6775316166387323, 'macro avg': {'precision': 0.5809290925484515, 'recall': 0.6007795414429201, 'f1-score': 0.5785184183505052, 'support': 164075}, 'weighted avg': {'precision': 0.7131362953070918, 'recall': 0.6775316166387323, 'f1-score': 0.6877582712792959, 'support': 164075}}
[[18003  6867  2895]
 [19141 82413  7987]
 [ 7788  8231 10750]]
Evaluating performance on  val set...
274/274 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66052055
{'0': {'precision': 0.4084507042253521, 'recall': 0.6185881157948198, 'f1-score': 0.49202181377499504, 'support': 9845}, '1': {'precision': 0.8590134944527483, 'recall': 0.8095228647951592, 'f1-score': 0.8335342062794926, 'support': 50405}, '2': {'precision': 0.5074568797821294, 'recall': 0.3963735818476499, 'f1-score': 0.4450890064266621, 'support': 9872}, 'accuracy': 0.7245514959641767, 'macro avg': {'precision': 0.5916403594867433, 'recall': 0.6081615208125429, 'f1-score': 0.5902150088270499, 'support': 70122}, 'weighted avg': {'precision': 0.7462620388494132, 'recall': 0.7245514959641767, 'f1-score': 0.7308999329108791, 'support': 70122}}
[[ 6090  2890   865]
 [ 6668 40804  2933]
 [ 2152  3807  3913]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
1359/1359 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0273008
{'0': {'precision': 0.4461167451337009, 'recall': 0.704357308373847, 'f1-score': 0.5462541095383574, 'support': 110045}, '1': {'precision': 0.6206175465430299, 'recall': 0.3970141951857146, 'f1-score': 0.4842497843873103, 'support': 130819}, '2': {'precision': 0.5080835242173755, 'recall': 0.429364953196742, 'f1-score': 0.4654191965779044, 'support': 106937}, 'accuracy': 0.5042049907849604, 'macro avg': {'precision': 0.5249392719647021, 'recall': 0.5102454855854346, 'f1-score': 0.4986410301678574, 'support': 347801}, 'weighted avg': {'precision': 0.5308047184127827, 'recall': 0.5042049907849604, 'f1-score': 0.49807832252455697, 'support': 347801}}
[[77511 14722 17812]
 [52240 51937 26642]
 [43995 17027 45915]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0928658
{'0': {'precision': 0.42378743684151804, 'recall': 0.7084088244697858, 'f1-score': 0.5303228251438601, 'support': 37532}, '1': {'precision': 0.599682640431609, 'recall': 0.2470775909411857, 'f1-score': 0.3499648109049154, 'support': 38239}, '2': {'precision': 0.4829177945576293, 'recall': 0.4481463853191602, 'f1-score': 0.46488280553536404, 'support': 37818}, 'accuracy': 0.46645361786792733, 'macro avg': {'precision': 0.5021292906102521, 'recall': 0.46787760024337716, 'f1-score': 0.44839014719471315, 'support': 113589}, 'weighted avg': {'precision': 0.5026881099541379, 'recall': 0.46645361786792733, 'f1-score': 0.44781905481365986, 'support': 113589}}
[[26588  2987  7957]
 [18601  9448 10190]
 [17550  3320 16948]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0541538
{'0': {'precision': 0.43817927472290974, 'recall': 0.691811077132178, 'f1-score': 0.5365307332498848, 'support': 11772}, '1': {'precision': 0.638972592911465, 'recall': 0.3364563656970155, 'f1-score': 0.44080380122747964, 'support': 13235}, '2': {'precision': 0.47948047262559756, 'recall': 0.4568972926514826, 'f1-score': 0.4679165566411408, 'support': 11635}, 'accuracy': 0.48886523661372194, 'macro avg': {'precision': 0.518877446753324, 'recall': 0.49505491182689204, 'f1-score': 0.4817503637061684, 'support': 36642}, 'weighted avg': {'precision': 0.5238197693417433, 'recall': 0.48886523661372194, 'f1-score': 0.4801672189722998, 'support': 36642}}
[[8144 1178 2450]
 [5461 4453 3321]
 [4981 1338 5316]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.22259
{'0': {'precision': 0.3676326207442597, 'recall': 0.5624630532324182, 'f1-score': 0.4446419268838292, 'support': 103189}, '1': {'precision': 0.3325717187103326, 'recall': 0.013958295596211015, 'f1-score': 0.026792105532263015, 'support': 93851}, '2': {'precision': 0.336695148353892, 'recall': 0.462116004864379, 'f1-score': 0.3895594501595678, 'support': 94565}, 'accuracy': 0.3533890022461892, 'macro avg': {'precision': 0.3456331626028281, 'recall': 0.34617911789766936, 'f1-score': 0.28699782752522, 'support': 291605}, 'weighted avg': {'precision': 0.3463157613166737, 'recall': 0.3533890022461892, 'f1-score': 0.2922971522911589, 'support': 291605}}
[[58040  1491 43658]
 [50108  1310 42433]
 [49727  1138 43700]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2160333
{'0': {'precision': 0.3473016910976695, 'recall': 0.5781325592646347, 'f1-score': 0.4339290780141844, 'support': 33072}, '1': {'precision': 0.4228993536472761, 'recall': 0.028231523146150527, 'f1-score': 0.05292961978504565, 'support': 32446}, '2': {'precision': 0.34381067961165046, 'recall': 0.43053402632138843, 'f1-score': 0.382316028123777, 'support': 32901}, 'accuracy': 0.34750403885428627, 'macro avg': {'precision': 0.3713372414521987, 'recall': 0.3456327029107245, 'f1-score': 0.28972490864100237, 'support': 98419}, 'weighted avg': {'precision': 0.3710571040787303, 'recall': 0.34750403885428627, 'f1-score': 0.2910701851566373, 'support': 98419}}
[[19120   654 13298]
 [17793   916 13737]
 [18140   596 14165]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2304145
{'0': {'precision': 0.37685708307177235, 'recall': 0.5734755612163668, 'f1-score': 0.4548266936043942, 'support': 12562}, '1': {'precision': 0.42752293577981654, 'recall': 0.020276738316943696, 'f1-score': 0.03871718178796943, 'support': 11491}, '2': {'precision': 0.3312539783577339, 'recall': 0.45979855098073863, 'f1-score': 0.38508213704306643, 'support': 11318}, 'accuracy': 0.3573831670012157, 'macro avg': {'precision': 0.3785446657364409, 'recall': 0.3511836168380163, 'f1-score': 0.2928753374784767, 'support': 35371}, 'weighted avg': {'precision': 0.37872486668870853, 'recall': 0.3573831670012157, 'f1-score': 0.297328084816301, 'support': 35371}}
[[7204  174 5184]
 [5936  233 5322]
 [5976  138 5204]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
2282/2282 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.047393
{'0': {'precision': 0.4305096495463042, 'recall': 0.7414308632828948, 'f1-score': 0.5447258416626692, 'support': 187621}, '1': {'precision': 0.6070313038851501, 'recall': 0.2973569132453592, 'f1-score': 0.39917582150574565, 'support': 207182}, '2': {'precision': 0.5268537225031685, 'recall': 0.4438401200896444, 'f1-score': 0.48179726543000917, 'support': 189192}, 'accuracy': 0.4874802010291184, 'macro avg': {'precision': 0.5214648919782077, 'recall': 0.49420929887263276, 'f1-score': 0.4752329761994747, 'support': 583995}, 'weighted avg': {'precision': 0.524345448209111, 'recall': 0.4874802010291184, 'f1-score': 0.47270308894944196, 'support': 583995}}
[[139108  18905  29608]
 [ 99772  61607  45803]
 [ 84244  20977  83971]]
Evaluating performance on  train set...
878/878 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0362378
{'0': {'precision': 0.4481260408593995, 'recall': 0.7311872797223493, 'f1-score': 0.5556861863089884, 'support': 74338}, '1': {'precision': 0.6313820615483532, 'recall': 0.2911041043468887, 'f1-score': 0.39848382842545027, 'support': 74214}, '2': {'precision': 0.5167841460596256, 'recall': 0.4695830216167264, 'f1-score': 0.4920542142577171, 'support': 76191}, 'accuracy': 0.4971767752499522, 'macro avg': {'precision': 0.5320974161557928, 'recall': 0.4972914685619882, 'f1-score': 0.4820747429973853, 'support': 224743}, 'weighted avg': {'precision': 0.5319163792135215, 'recall': 0.4971767752499522, 'f1-score': 0.482203144031688, 'support': 224743}}
[[54355  5515 14468]
 [33624 21604 18986]
 [33315  7098 35778]]
Evaluating performance on  val set...
303/303 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0504425
{'0': {'precision': 0.4420078559895896, 'recall': 0.7342968093198287, 'f1-score': 0.5518382574162104, 'support': 24979}, '1': {'precision': 0.6146496815286624, 'recall': 0.27863330125120306, 'f1-score': 0.3834437086092715, 'support': 27014}, '2': {'precision': 0.515027091093803, 'recall': 0.47950658154015924, 'f1-score': 0.4966325156128822, 'support': 25374}, 'accuracy': 0.4916307986609278, 'macro avg': {'precision': 0.5238948762040184, 'recall': 0.497478897370397, 'f1-score': 0.477304827212788, 'support': 77367}, 'weighted avg': {'precision': 0.5262367435856812, 'recall': 0.4916307986609278, 'f1-score': 0.4749346572509165, 'support': 77367}}
[[18342  2178  4459]
 [12489  7527  6998]
 [10666  2541 12167]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
5098/5098 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48569357
{'0': {'precision': 0.46144495246389433, 'recall': 0.6638043535000261, 'f1-score': 0.5444289842662956, 'support': 153256}, '1': {'precision': 0.8907194915140524, 'recall': 0.8633271874002704, 'f1-score': 0.876809451670228, 'support': 999577}, '2': {'precision': 0.5362338898019202, 'recall': 0.4076460763555544, 'f1-score': 0.4631810167060159, 'support': 152078}, 'accuracy': 0.7867877579390472, 'macro avg': {'precision': 0.6294661112599557, 'recall': 0.644925872418617, 'f1-score': 0.6281398175475131, 'support': 1304911}, 'weighted avg': {'precision': 0.7989903543592207, 'recall': 0.7867877579390472, 'f1-score': 0.7895674205700651, 'support': 1304911}}
[[101732  42817   8707]
 [ 91706 862962  44909]
 [ 27026  63058  61994]]
Evaluating performance on  train set...
1876/1876 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5030214
{'0': {'precision': 0.4641295173789611, 'recall': 0.6417583194822647, 'f1-score': 0.538678461173118, 'support': 56554}, '1': {'precision': 0.8957391874969554, 'recall': 0.8536313611972091, 'f1-score': 0.8741785009144858, 'support': 366185}, '2': {'precision': 0.5071458199781289, 'recall': 0.4680517853414074, 'f1-score': 0.4868151955549925, 'support': 57468}, 'accuracy': 0.7825354482546069, 'macro avg': {'precision': 0.6223381749513485, 'recall': 0.6544804886736271, 'f1-score': 0.6332240525475321, 'support': 480207}, 'weighted avg': {'precision': 0.798404211271234, 'recall': 0.7825354482546069, 'f1-score': 0.7883095658928542, 'support': 480207}}
[[ 36294  15480   4780]
 [ 32238 312587  21360]
 [  9666  20904  26898]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4487689
{'0': {'precision': 0.46212519726459755, 'recall': 0.6394128707466489, 'f1-score': 0.5365022010738186, 'support': 16487}, '1': {'precision': 0.9033047433077094, 'recall': 0.8765050127116611, 'f1-score': 0.8897031076919332, 'support': 125082}, '2': {'precision': 0.5299175417576997, 'recall': 0.44747961673510683, 'f1-score': 0.48522199277232836, 'support': 16803}, 'accuracy': 0.806304144672038, 'macro avg': {'precision': 0.6317824941100022, 'recall': 0.6544658333978056, 'f1-score': 0.6371424338460266, 'support': 158372}, 'weighted avg': {'precision': 0.8177608825036683, 'recall': 0.806304144672038, 'f1-score': 0.810019075657186, 'support': 158372}}
[[ 10542   4849   1096]
 [  9873 109635   5574]
 [  2397   6887   7519]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
5760/5760 - 85s - 85s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48651987
{'0': {'precision': 0.4467217240007477, 'recall': 0.6105430033213015, 'f1-score': 0.5159404564855155, 'support': 152651}, '1': {'precision': 0.8996984138149333, 'recall': 0.8767783070319978, 'f1-score': 0.8880905027879624, 'support': 1167051}, '2': {'precision': 0.5045596016184252, 'recall': 0.41898571419341085, 'f1-score': 0.45780810409158135, 'support': 154769}, 'accuracy': 0.8011625864462577, 'macro avg': {'precision': 0.6169932464780353, 'recall': 0.6354356748489033, 'f1-score': 0.6206130211216864, 'support': 1474471}, 'weighted avg': {'precision': 0.8113259849901775, 'recall': 0.8011625864462577, 'f1-score': 0.8043971284985021, 'support': 1474471}}
[[  93200   47907   11544]
 [  91676 1023245   52130]
 [  23755   66168   64846]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62914366
{'0': {'precision': 0.44301810039519346, 'recall': 0.6096815380460137, 'f1-score': 0.5131567390506895, 'support': 81454}, '1': {'precision': 0.8413627152316122, 'recall': 0.8149308637211397, 'f1-score': 0.8279358839994878, 'support': 388725}, '2': {'precision': 0.522642306308561, 'recall': 0.40568237008256436, 'f1-score': 0.45679442746891424, 'support': 82360}, 'accuracy': 0.723671994194075, 'macro avg': {'precision': 0.6023410406451223, 'recall': 0.6100982572832393, 'f1-score': 0.5992956835063639, 'support': 552539}, 'weighted avg': {'precision': 0.7351320688233258, 'recall': 0.723671994194075, 'f1-score': 0.7262105201201644, 'support': 552539}}
[[ 49661  25985   5808]
 [ 47232 316784  24709]
 [ 15204  33744  33412]]
Evaluating performance on  val set...
850/850 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57698965
{'0': {'precision': 0.4581672295152731, 'recall': 0.6038417776587912, 'f1-score': 0.5210134988811089, 'support': 29882}, '1': {'precision': 0.859655264062024, 'recall': 0.8410527984778817, 'f1-score': 0.8502522937250351, 'support': 157675}, '2': {'precision': 0.5327650955736529, 'recall': 0.42386195783536995, 'f1-score': 0.4721147194645428, 'support': 29788}, 'accuracy': 0.7512618187673975, 'macro avg': {'precision': 0.6168625297169833, 'recall': 0.6229188446573476, 'f1-score': 0.614460170690229, 'support': 217345}, 'weighted avg': {'precision': 0.759654482874246, 'recall': 0.7512618187673975, 'f1-score': 0.7531611449541973, 'support': 217345}}
[[ 18044   9698   2140]
 [ 16129 132613   8933]
 [  5210  11952  12626]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
6315/6315 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57574105
{'0': {'precision': 0.45795749021809457, 'recall': 0.5933865602129075, 'f1-score': 0.5169493654010753, 'support': 225450}, '1': {'precision': 0.8492322504492744, 'recall': 0.8504196231283367, 'f1-score': 0.8498255220409678, 'support': 1165808}, '2': {'precision': 0.5633497574625677, 'recall': 0.3924790393633651, 'f1-score': 0.462641369183939, 'support': 225184}, 'accuracy': 0.7507754685908928, 'macro avg': {'precision': 0.6235131660433122, 'recall': 0.6120950742348698, 'f1-score': 0.6098054188753274, 'support': 1616442}, 'weighted avg': {'precision': 0.7548341477058181, 'recall': 0.7507754685908928, 'f1-score': 0.7494602718238733, 'support': 1616442}}
[[133779  76853  14818]
 [120697 991426  53685]
 [ 37645  99159  88380]]
Evaluating performance on  train set...
2155/2155 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6588557
{'0': {'precision': 0.45857637172516064, 'recall': 0.6247418514860376, 'f1-score': 0.5289154107831772, 'support': 89096}, '1': {'precision': 0.8247521586184842, 'recall': 0.8017934479943336, 'f1-score': 0.8131107720693564, 'support': 369902}, '2': {'precision': 0.5557571290889506, 'recall': 0.42371654258020597, 'f1-score': 0.48083679237763566, 'support': 92543}, 'accuracy': 0.7097550318108717, 'macro avg': {'precision': 0.6130285531441985, 'recall': 0.6167506140201923, 'f1-score': 0.6076209917433898, 'support': 551541}, 'weighted avg': {'precision': 0.7204654330136803, 'recall': 0.7097550318108717, 'f1-score': 0.7114496066949522, 'support': 551541}}
[[ 55662  26818   6616]
 [ 48589 296585  24728]
 [ 17129  36202  39212]]
Evaluating performance on  val set...
746/746 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5911091
{'0': {'precision': 0.4550327900078914, 'recall': 0.6244678467398611, 'f1-score': 0.5264533190611866, 'support': 26778}, '1': {'precision': 0.8565881613598276, 'recall': 0.834396111325691, 'f1-score': 0.8453465149160339, 'support': 137219}, '2': {'precision': 0.5409271913868542, 'recall': 0.41121949396419627, 'f1-score': 0.4672385239288292, 'support': 26757}, 'accuracy': 0.7455675896704657, 'macro avg': {'precision': 0.6175160475848577, 'recall': 0.6233611506765828, 'f1-score': 0.6130127859686832, 'support': 190754}, 'weighted avg': {'precision': 0.7559402572129735, 'recall': 0.7455675896704657, 'f1-score': 0.7475432839827598, 'support': 190754}}
[[ 16722   8282   1774]
 [ 15160 114495   7564]
 [  4867  10887  11003]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
6082/6082 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72447056
{'0': {'precision': 0.43547641532879366, 'recall': 0.6346366975002354, 'f1-score': 0.516523553912682, 'support': 276106}, '1': {'precision': 0.8201807757152433, 'recall': 0.7578879972003277, 'f1-score': 0.7878049120769132, 'support': 1005832}, '2': {'precision': 0.5206035957952753, 'recall': 0.426127640377493, 'f1-score': 0.4686516581941419, 'support': 274866}, 'accuracy': 0.6774539376825855, 'macro avg': {'precision': 0.5920869289464373, 'recall': 0.6062174450260187, 'f1-score': 0.5909933747279124, 'support': 1556804}, 'weighted avg': {'precision': 0.6990590652977835, 'recall': 0.6774539376825855, 'f1-score': 0.6833429573549089, 'support': 1556804}}
[[175227  74770  26109]
 [161776 762308  81748]
 [ 65377  92361 117128]]
Evaluating performance on  train set...
2440/2440 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8731696
{'0': {'precision': 0.42748012893218507, 'recall': 0.6648654302049923, 'f1-score': 0.5203788443120144, 'support': 143420}, '1': {'precision': 0.7630487247593751, 'recall': 0.63271117952665, 'f1-score': 0.6917944228033578, 'support': 337805}, '2': {'precision': 0.49829517377697247, 'recall': 0.4220295475788563, 'f1-score': 0.4570023642090474, 'support': 143362}, 'accuracy': 0.5917366195582041, 'macro avg': {'precision': 0.5629413424895109, 'recall': 0.5732020524368329, 'f1-score': 0.5563918771081399, 'support': 624587}, 'weighted avg': {'precision': 0.6252250963625708, 'recall': 0.5917366195582041, 'f1-score': 0.5985413109527653, 'support': 624587}}
[[ 95355  28777  19288]
 [ 82443 213733  41629]
 [ 45265  37594  60503]]
Evaluating performance on  val set...
826/826 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75837725
{'0': {'precision': 0.4393460664583925, 'recall': 0.6197821459872292, 'f1-score': 0.5141943056579863, 'support': 39935}, '1': {'precision': 0.7933693446055008, 'recall': 0.7501567753390502, 'f1-score': 0.7711581702595329, 'support': 132355}, '2': {'precision': 0.5177259981305915, 'recall': 0.39616327781751304, 'f1-score': 0.44885968974299606, 'support': 39148}, 'accuracy': 0.659990162600857, 'macro avg': {'precision': 0.5834804697314949, 'recall': 0.5887007330479309, 'f1-score': 0.5780707218868385, 'support': 211438}, 'weighted avg': {'precision': 0.6754680906180222, 'recall': 0.659990162600857, 'f1-score': 0.6629505971263961, 'support': 211438}}
[[24751 11476  3708]
 [22329 99287 10739]
 [ 9256 14383 15509]]
testing model on single stock: results/universal/W3/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
13689/13689 - 195s - 195s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1490035
{'0': {'precision': 0.3940193901347359, 'recall': 0.7654412553585506, 'f1-score': 0.5202396438251324, 'support': 1071885}, '1': {'precision': 0.5600381896457733, 'recall': 0.14255283081986592, 'f1-score': 0.22725889450829467, 'support': 1333218}, '2': {'precision': 0.4822735455957051, 'recall': 0.4750109858316889, 'f1-score': 0.47861471655114696, 'support': 1099143}, 'accuracy': 0.43736198885580524, 'macro avg': {'precision': 0.4787770417920714, 'recall': 0.4610016906700351, 'f1-score': 0.40870441829485804, 'support': 3504246}, 'weighted avg': {'precision': 0.4848643790545613, 'recall': 0.43736198885580524, 'f1-score': 0.39571672046832296, 'support': 3504246}}
[[820465  71374 180046]
 [762724 190054 380440]
 [499107  77931 522105]]
Evaluating performance on  train set...
5475/5475 - 94s - 94s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1381116
{'0': {'precision': 0.40830433654810117, 'recall': 0.7531558948473295, 'f1-score': 0.5295348211681181, 'support': 463973}, '1': {'precision': 0.5698357709542784, 'recall': 0.10363312647563509, 'f1-score': 0.1753722042606767, 'support': 465054}, '2': {'precision': 0.4784287873498039, 'recall': 0.4668947959850933, 'f1-score': 0.4725914279532948, 'support': 472539}, 'accuracy': 0.4411244279612947, 'macro avg': {'precision': 0.4855229649507278, 'recall': 0.44122793910268593, 'f1-score': 0.39249948446069655, 'support': 1401566}, 'weighted avg': {'precision': 0.4855446360086447, 'recall': 0.4411244279612947, 'f1-score': 0.3928215192404082, 'support': 1401566}}
[[349444  17107  97422]
 [273760  48195 143099]
 [232638  19275 220626]]
Evaluating performance on  val set...
2036/2036 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1328583
{'0': {'precision': 0.3971145699365732, 'recall': 0.7359465512279956, 'f1-score': 0.5158681958601274, 'support': 159854}, '1': {'precision': 0.5953279760792375, 'recall': 0.1644172159111437, 'f1-score': 0.2576710439575995, 'support': 193751}, '2': {'precision': 0.4746207548160202, 'recall': 0.48551706033613545, 'f1-score': 0.4800070781844457, 'support': 167611}, 'accuracy': 0.44296030820235754, 'macro avg': {'precision': 0.4890211002772769, 'recall': 0.4619602758250916, 'f1-score': 0.4178487726673909, 'support': 521216}, 'weighted avg': {'precision': 0.4957203970934071, 'recall': 0.44296030820235754, 'f1-score': 0.40835677224111844, 'support': 521216}}
[[117644  10372  31838]
 [103652  31856  58243]
 [ 74951  11282  81378]]
training model: results/universal/W3/deepVOL_L3/h20
Epoch 1/50
10532/10532 - 605s - loss: 2.8317 - accuracy20: 0.5185 - val_loss: 3.0898 - val_accuracy20: 0.5206 - 605s/epoch - 57ms/step
Epoch 2/50
10532/10532 - 613s - loss: 2.7355 - accuracy20: 0.5446 - val_loss: 2.9766 - val_accuracy20: 0.5386 - 613s/epoch - 58ms/step
Epoch 3/50
10532/10532 - 590s - loss: 2.7043 - accuracy20: 0.5515 - val_loss: 2.9622 - val_accuracy20: 0.5373 - 590s/epoch - 56ms/step
Epoch 4/50
10532/10532 - 625s - loss: 2.6876 - accuracy20: 0.5543 - val_loss: 2.9279 - val_accuracy20: 0.5414 - 625s/epoch - 59ms/step
Epoch 5/50
10532/10532 - 605s - loss: 2.6750 - accuracy20: 0.5567 - val_loss: 2.8873 - val_accuracy20: 0.5398 - 605s/epoch - 57ms/step
Epoch 6/50
10532/10532 - 603s - loss: 2.6655 - accuracy20: 0.5587 - val_loss: 2.8822 - val_accuracy20: 0.5444 - 603s/epoch - 57ms/step
Epoch 7/50
10532/10532 - 592s - loss: 2.6581 - accuracy20: 0.5600 - val_loss: 2.8802 - val_accuracy20: 0.5420 - 592s/epoch - 56ms/step
Epoch 8/50
10532/10532 - 602s - loss: 2.6524 - accuracy20: 0.5612 - val_loss: 2.8861 - val_accuracy20: 0.5440 - 602s/epoch - 57ms/step
Epoch 9/50
10532/10532 - 606s - loss: 2.6475 - accuracy20: 0.5622 - val_loss: 2.8653 - val_accuracy20: 0.5452 - 606s/epoch - 58ms/step
Epoch 10/50
10532/10532 - 599s - loss: 2.6436 - accuracy20: 0.5629 - val_loss: 2.8588 - val_accuracy20: 0.5462 - 599s/epoch - 57ms/step
Epoch 11/50
10532/10532 - 600s - loss: 2.6399 - accuracy20: 0.5637 - val_loss: 2.8661 - val_accuracy20: 0.5472 - 600s/epoch - 57ms/step
Epoch 12/50
10532/10532 - 591s - loss: 2.6364 - accuracy20: 0.5643 - val_loss: 2.8769 - val_accuracy20: 0.5440 - 591s/epoch - 56ms/step
Epoch 13/50
10532/10532 - 599s - loss: 2.6333 - accuracy20: 0.5654 - val_loss: 2.8707 - val_accuracy20: 0.5472 - 599s/epoch - 57ms/step
Epoch 14/50
10532/10532 - 600s - loss: 2.6306 - accuracy20: 0.5660 - val_loss: 2.8488 - val_accuracy20: 0.5505 - 600s/epoch - 57ms/step
Epoch 15/50
10532/10532 - 594s - loss: 2.6280 - accuracy20: 0.5665 - val_loss: 2.8641 - val_accuracy20: 0.5519 - 594s/epoch - 56ms/step
Epoch 16/50
10532/10532 - 597s - loss: 2.6255 - accuracy20: 0.5671 - val_loss: 2.8701 - val_accuracy20: 0.5489 - 597s/epoch - 57ms/step
Epoch 17/50
10532/10532 - 599s - loss: 2.6232 - accuracy20: 0.5675 - val_loss: 2.8453 - val_accuracy20: 0.5515 - 599s/epoch - 57ms/step
Epoch 18/50
10532/10532 - 609s - loss: 2.6211 - accuracy20: 0.5678 - val_loss: 2.8312 - val_accuracy20: 0.5502 - 609s/epoch - 58ms/step
Epoch 19/50
10532/10532 - 619s - loss: 2.6186 - accuracy20: 0.5684 - val_loss: 2.8371 - val_accuracy20: 0.5539 - 619s/epoch - 59ms/step
Epoch 20/50
10532/10532 - 631s - loss: 2.6169 - accuracy20: 0.5687 - val_loss: 2.8352 - val_accuracy20: 0.5533 - 631s/epoch - 60ms/step
Epoch 21/50
10532/10532 - 605s - loss: 2.6155 - accuracy20: 0.5690 - val_loss: 2.8377 - val_accuracy20: 0.5520 - 605s/epoch - 57ms/step
Epoch 22/50
10532/10532 - 614s - loss: 2.6136 - accuracy20: 0.5695 - val_loss: 2.8298 - val_accuracy20: 0.5520 - 614s/epoch - 58ms/step
Epoch 23/50
10532/10532 - 603s - loss: 2.6119 - accuracy20: 0.5698 - val_loss: 2.8348 - val_accuracy20: 0.5513 - 603s/epoch - 57ms/step
Epoch 24/50
10532/10532 - 599s - loss: 2.6102 - accuracy20: 0.5701 - val_loss: 2.8353 - val_accuracy20: 0.5532 - 599s/epoch - 57ms/step
Epoch 25/50
10532/10532 - 607s - loss: 2.6086 - accuracy20: 0.5706 - val_loss: 2.8408 - val_accuracy20: 0.5524 - 607s/epoch - 58ms/step
Epoch 26/50
10532/10532 - 620s - loss: 2.6074 - accuracy20: 0.5707 - val_loss: 2.8306 - val_accuracy20: 0.5559 - 620s/epoch - 59ms/step
Epoch 27/50
10532/10532 - 616s - loss: 2.6060 - accuracy20: 0.5709 - val_loss: 2.8474 - val_accuracy20: 0.5545 - 616s/epoch - 58ms/step
Epoch 28/50
10532/10532 - 601s - loss: 2.6045 - accuracy20: 0.5714 - val_loss: 2.8455 - val_accuracy20: 0.5564 - 601s/epoch - 57ms/step
Epoch 29/50
10532/10532 - 602s - loss: 2.6033 - accuracy20: 0.5715 - val_loss: 2.8360 - val_accuracy20: 0.5515 - 602s/epoch - 57ms/step
Epoch 30/50
10532/10532 - 608s - loss: 2.6019 - accuracy20: 0.5719 - val_loss: 2.8631 - val_accuracy20: 0.5506 - 608s/epoch - 58ms/step
Epoch 31/50
10532/10532 - 675s - loss: 2.6008 - accuracy20: 0.5722 - val_loss: 2.8377 - val_accuracy20: 0.5555 - 675s/epoch - 64ms/step
Epoch 32/50
10532/10532 - 653s - loss: 2.5996 - accuracy20: 0.5724 - val_loss: 2.8382 - val_accuracy20: 0.5541 - 653s/epoch - 62ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 1008s - 1008s/epoch - 36ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98023814
{'0': {'precision': 0.4315919056735632, 'recall': 0.6823800598081754, 'f1-score': 0.5287560540697976, 'support': 1806442}, '1': {'precision': 0.7962792655988759, 'recall': 0.528454183960691, 'f1-score': 0.6352932503467387, 'support': 3457119}, '2': {'precision': 0.47769626465828624, 'recall': 0.5073354998255543, 'f1-score': 0.49206996552482796, 'support': 1822916}, 'accuracy': 0.5622594979141258, 'macro avg': {'precision': 0.5685224786435751, 'recall': 0.5727232478648069, 'f1-score': 0.5520397566471215, 'support': 7086477}, 'weighted avg': {'precision': 0.6213634910072391, 'recall': 0.5622594979141258, 'f1-score': 0.5712928615228805, 'support': 7086477}}
[[1232680  204944  368818]
 [ 987817 1826929  642373]
 [ 635627  262459  924830]]
Evaluating performance on  train set...
10532/10532 - 327s - 327s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0349358
{'0': {'precision': 0.4287084320001694, 'recall': 0.6673712344081768, 'f1-score': 0.522056350890387, 'support': 728106}, '1': {'precision': 0.7829207813699934, 'recall': 0.4720049493651901, 'f1-score': 0.5889471778557074, 'support': 1226824}, '2': {'precision': 0.4710990106230401, 'recall': 0.523152259886243, 'f1-score': 0.4957630316356041, 'support': 740878}, 'accuracy': 0.5388276909928303, 'macro avg': {'precision': 0.5609094079977343, 'recall': 0.5541761478865367, 'f1-score': 0.5355888534605662, 'support': 2695808}, 'weighted avg': {'precision': 0.6015554813494703, 'recall': 0.5388276909928303, 'f1-score': 0.545271331377891, 'support': 2695808}}
[[485917  69989 172200]
 [384809 579067 262948]
 [262718  90568 387592]]
Evaluating performance on  val set...
3814/3814 - 126s - 126s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0030689
{'0': {'precision': 0.4272134198493578, 'recall': 0.6746425317859548, 'f1-score': 0.5231470461313066, 'support': 252470}, '1': {'precision': 0.7922168078211194, 'recall': 0.5026222104772402, 'f1-score': 0.6150351626684194, 'support': 465447}, '2': {'precision': 0.4776272978544488, 'recall': 0.5219255732442094, 'f1-score': 0.4987948280429897, 'support': 257918}, 'accuracy': 0.5522296289844082, 'macro avg': {'precision': 0.565685841841642, 'recall': 0.5663967718358015, 'f1-score': 0.5456590122809052, 'support': 975835}, 'weighted avg': {'precision': 0.6146348369010207, 'recall': 0.5522296289844082, 'f1-score': 0.5605387904251135, 'support': 975835}}
[[170327  26720  55423]
 [139701 233944  91802]
 [ 88665  34639 134614]]
testing model out of sample: results/universal/W3/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 501s - 501s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84229654
{'0': {'precision': 0.4431604315141839, 'recall': 0.6668715473478896, 'f1-score': 0.5324730968384891, 'support': 928996}, '1': {'precision': 0.7982605058621707, 'recall': 0.667634869687121, 'f1-score': 0.7271276759543129, 'support': 2281202}, '2': {'precision': 0.502391670509312, 'recall': 0.45049958705122184, 'f1-score': 0.47503267200043714, 'support': 926265}, 'accuracy': 0.6188410243244047, 'macro avg': {'precision': 0.5812708692952221, 'recall': 0.5950020013620775, 'f1-score': 0.5782111482644131, 'support': 4136463}, 'weighted avg': {'precision': 0.6522566626156342, 'recall': 0.6188410243244047, 'f1-score': 0.6269599470957156, 'support': 4136463}}
[[ 619521  167289  142186]
 [ 487069 1523010  271123]
 [ 291371  217612  417282]]
Evaluating performance on  train set...
6181/6181 - 197s - 197s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93932486
{'0': {'precision': 0.44705122377204104, 'recall': 0.6627203404859018, 'f1-score': 0.5339295919533661, 'support': 422925}, '1': {'precision': 0.7304470987487686, 'recall': 0.5685787849968685, 'f1-score': 0.6394279422878473, 'support': 732887}, '2': {'precision': 0.5037023160940175, 'recall': 0.45448676565526147, 'f1-score': 0.47783060954254386, 'support': 425975}, 'accuracy': 0.563024604450536, 'macro avg': {'precision': 0.560400212871609, 'recall': 0.5619286303793439, 'f1-score': 0.5503960479279191, 'support': 1581787}, 'weighted avg': {'precision': 0.593612740383268, 'recall': 0.563024604450536, 'f1-score': 0.5677025370143237, 'support': 1581787}}
[[280281  66709  75935]
 [201364 416704 114819]
 [145310  87065 193600]]
Evaluating performance on  val set...
2209/2209 - 68s - 68s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8787504
{'0': {'precision': 0.45470640459181566, 'recall': 0.6445341937560819, 'f1-score': 0.533229624742368, 'support': 136677}, '1': {'precision': 0.7523878168991399, 'recall': 0.6396947557977911, 'f1-score': 0.691479873732047, 'support': 292094}, '2': {'precision': 0.5039381634949367, 'recall': 0.4546063035563238, 'f1-score': 0.4780027919458935, 'support': 135955}, 'accuracy': 0.5963068815673441, 'macro avg': {'precision': 0.5703441283286307, 'recall': 0.5796117510367322, 'f1-score': 0.5675707634734362, 'support': 564726}, 'weighted avg': {'precision': 0.6205288711121624, 'recall': 0.5963068815673441, 'f1-score': 0.6017860293979826, 'support': 564726}}
[[ 88093  27316  21268]
 [ 65671 186851  39572]
 [ 39972  34177  61806]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3064094
{'0': {'precision': 0.40185737216234807, 'recall': 0.5938564239846834, 'f1-score': 0.47934573751547105, 'support': 59021}, '1': {'precision': 0.5282121006118287, 'recall': 0.014016162782307526, 'f1-score': 0.027307712583689178, 'support': 55436}, '2': {'precision': 0.4061699389617596, 'recall': 0.5837448035971834, 'f1-score': 0.4790303266590549, 'support': 58935}, 'accuracy': 0.4050359878195072, 'macro avg': {'precision': 0.4454131372453121, 'recall': 0.39720579678805806, 'f1-score': 0.328561258919405, 'support': 173392}, 'weighted avg': {'precision': 0.4437206752596578, 'recall': 0.4050359878195072, 'f1-score': 0.3347152546273266, 'support': 173392}}
[[35050   271 23700]
 [28061   777 26598]
 [24109   423 34403]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3100702
{'0': {'precision': 0.39741310611169006, 'recall': 0.5727537768354095, 'f1-score': 0.46923856398378694, 'support': 22638}, '1': {'precision': 0.5562913907284768, 'recall': 0.011774050366771014, 'f1-score': 0.023060029282576867, 'support': 21403}, '2': {'precision': 0.3948270676691729, 'recall': 0.5890165111270639, 'f1-score': 0.4727573913356621, 'support': 22288}, 'accuracy': 0.3972018272550468, 'macro avg': {'precision': 0.44951052150311327, 'recall': 0.3911814461097481, 'f1-score': 0.3216853282006753, 'support': 66329}, 'weighted avg': {'precision': 0.4478108853763595, 'recall': 0.3972018272550468, 'f1-score': 0.32644835827902124, 'support': 66329}}
[[12966   107  9565]
 [10594   252 10557]
 [ 9066    94 13128]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3063698
{'0': {'precision': 0.40627682915196034, 'recall': 0.5554975870614322, 'f1-score': 0.4693112947658402, 'support': 7667}, '1': {'precision': 0.4142857142857143, 'recall': 0.0042422469280280865, 'f1-score': 0.008398494063133507, 'support': 6836}, '2': {'precision': 0.3908268166241982, 'recall': 0.5985735432647019, 'f1-score': 0.4728896449075059, 'support': 7431}, 'accuracy': 0.39828576639007934, 'macro avg': {'precision': 0.4037964533539576, 'recall': 0.38610445908472074, 'f1-score': 0.3168664779121599, 'support': 21934}, 'weighted avg': {'precision': 0.40353860063370295, 'recall': 0.39828576639007934, 'f1-score': 0.3268744758681934, 'support': 21934}}
[[4259   20 3388]
 [3262   29 3545]
 [2962   21 4448]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63497823
{'0': {'precision': 0.4520582971107134, 'recall': 0.6126391475722268, 'f1-score': 0.5202390804597702, 'support': 46174}, '1': {'precision': 0.8861594214242107, 'recall': 0.8143503466927525, 'f1-score': 0.8487387083473893, 'support': 278056}, '2': {'precision': 0.4344087702499365, 'recall': 0.493528406189641, 'f1-score': 0.46208530805687204, 'support': 45043}, 'accuracy': 0.7499952609586945, 'macro avg': {'precision': 0.5908754962616202, 'recall': 0.6401726334848735, 'f1-score': 0.6103543656213438, 'support': 369273}, 'weighted avg': {'precision': 0.7767758762018568, 'recall': 0.7499952609586945, 'f1-score': 0.7605000043875312, 'support': 369273}}
[[ 28288  13114   4772]
 [ 27450 226435  24171]
 [  6838  15975  22230]]
Evaluating performance on  train set...
641/641 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84491146
{'0': {'precision': 0.42403799449511576, 'recall': 0.6611781206171108, 'f1-score': 0.5166982693424816, 'support': 35650}, '1': {'precision': 0.7944436558834536, 'recall': 0.6558681594954778, 'f1-score': 0.7185355492273937, 'support': 93871}, '2': {'precision': 0.5002097383111226, 'recall': 0.4486311280893674, 'f1-score': 0.4730185368830575, 'support': 34554}, 'accuracy': 0.6133780283406979, 'macro avg': {'precision': 0.5728971295632307, 'recall': 0.5885591360673187, 'f1-score': 0.5694174518176444, 'support': 164075}, 'weighted avg': {'precision': 0.6519970880560054, 'recall': 0.6133780283406979, 'f1-score': 0.6229750197595083, 'support': 164075}}
[[23571  7271  4808]
 [21623 61567 10681]
 [10393  8659 15502]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7761719
{'0': {'precision': 0.43623944495240147, 'recall': 0.6229646697388633, 'f1-score': 0.513143327112264, 'support': 13020}, '1': {'precision': 0.7937362610220564, 'recall': 0.7310282074613285, 'f1-score': 0.7610927564034247, 'support': 43960}, '2': {'precision': 0.5249954718348125, 'recall': 0.44110485466443466, 'f1-score': 0.47940787297386706, 'support': 13142}, 'accuracy': 0.6566270214768546, 'macro avg': {'precision': 0.58499039260309, 'recall': 0.5983659106215422, 'f1-score': 0.5845479854965187, 'support': 70122}, 'weighted avg': {'precision': 0.6769911596740392, 'recall': 0.6566270214768546, 'f1-score': 0.6622620854670258, 'support': 70122}}
[[ 8111  3620  1289]
 [ 7868 32136  3956]
 [ 2614  4731  5797]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
1359/1359 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1392554
{'0': {'precision': 0.41619838623358446, 'recall': 0.719045883304736, 'f1-score': 0.5272270370165152, 'support': 112481}, '1': {'precision': 0.5880221399275276, 'recall': 0.2373200051427102, 'f1-score': 0.3381613749041071, 'support': 124448}, '2': {'precision': 0.47863860451151125, 'recall': 0.44572119200519517, 'f1-score': 0.46159378663266687, 'support': 110872}, 'accuracy': 0.4595472698468377, 'macro avg': {'precision': 0.49428637689087446, 'recall': 0.46736236015088045, 'f1-score': 0.44232739951776306, 'support': 347801}, 'weighted avg': {'precision': 0.4975839900145228, 'recall': 0.4595472698468377, 'f1-score': 0.43865416558968495, 'support': 347801}}
[[80879  9105 22497]
 [63582 29534 31332]
 [49867 11587 49418]]
Evaluating performance on  train set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2064013
{'0': {'precision': 0.4043548591727988, 'recall': 0.6782018885490092, 'f1-score': 0.5066417621285433, 'support': 37595}, '1': {'precision': 0.5680326013131084, 'recall': 0.13246396705559368, 'f1-score': 0.21483003681822072, 'support': 37882}, '2': {'precision': 0.45348809323964606, 'recall': 0.4961691855583543, 'f1-score': 0.47386951673328237, 'support': 38112}, 'accuracy': 0.4351213585822571, 'macro avg': {'precision': 0.4752918512418511, 'recall': 0.4356116803876524, 'f1-score': 0.3984471052266822, 'support': 113589}, 'weighted avg': {'precision': 0.4754269352058204, 'recall': 0.4351213585822571, 'f1-score': 0.39832645347444984, 'support': 113589}}
[[25497  1783 10315]
 [20390  5018 12474]
 [17169  2033 18910]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1566788
{'0': {'precision': 0.4175278829428016, 'recall': 0.6766998341625208, 'f1-score': 0.516420932734291, 'support': 12060}, '1': {'precision': 0.6159940579351325, 'recall': 0.19880143827407112, 'f1-score': 0.30059200193306757, 'support': 12515}, '2': {'precision': 0.44849506012100787, 'recall': 0.4852904615894589, 'f1-score': 0.46616780767393734, 'support': 12067}, 'accuracy': 0.4504393864963703, 'macro avg': {'precision': 0.4940056669996473, 'recall': 0.4535972446753503, 'f1-score': 0.42772691411376534, 'support': 36642}, 'weighted avg': {'precision': 0.49551175683173876, 'recall': 0.4504393864963703, 'f1-score': 0.42615556705882024, 'support': 36642}}
[[8161  727 3172]
 [5998 2488 4029]
 [5387  824 5856]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4913276
{'0': {'precision': 0.3483031650699308, 'recall': 0.17012810361979008, 'f1-score': 0.22859792816078237, 'support': 98514}, '1': {'precision': 0.3128654970760234, 'recall': 0.019724108267535102, 'f1-score': 0.03710875408225196, 'support': 97647}, '2': {'precision': 0.32524333206927064, 'recall': 0.8087464900884288, 'f1-score': 0.4639184551677716, 'support': 95444}, 'accuracy': 0.3287872292999091, 'macro avg': {'precision': 0.32880399807174165, 'recall': 0.332866233991918, 'f1-score': 0.2432083791369353, 'support': 291605}, 'weighted avg': {'precision': 0.32888887290238883, 'recall': 0.3287872292999091, 'f1-score': 0.24149753207158234, 'support': 291605}}
[[16760  2191 79563]
 [15144  1926 80577]
 [16215  2039 77190]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4940716
{'0': {'precision': 0.37367049376628864, 'recall': 0.15819765014612036, 'f1-score': 0.22228740231715238, 'support': 33534}, '1': {'precision': 0.32908419993290844, 'recall': 0.030237647566501248, 'f1-score': 0.055386178861788614, 'support': 32443}, '2': {'precision': 0.32615305079947315, 'recall': 0.8167498921151594, 'f1-score': 0.4661558896228988, 'support': 32442}, 'accuracy': 0.33309625174000956, 'macro avg': {'precision': 0.34296924816622343, 'recall': 0.3350617299425937, 'f1-score': 0.2479431569339466, 'support': 98419}, 'weighted avg': {'precision': 0.34330975025572885, 'recall': 0.33309625174000956, 'f1-score': 0.24765653909572827, 'support': 98419}}
[[ 5305  1005 27224]
 [ 3942   981 27520]
 [ 4950   995 26497]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4991896
{'0': {'precision': 0.37739013753773903, 'recall': 0.18123238018525978, 'f1-score': 0.2448713065244599, 'support': 12415}, '1': {'precision': 0.3491655969191271, 'recall': 0.023194337852818284, 'f1-score': 0.04349912042219735, 'support': 11727}, '2': {'precision': 0.31826755151938524, 'recall': 0.8114703001157717, 'f1-score': 0.45721167114077116, 'support': 11229}, 'accuracy': 0.32891351672273894, 'macro avg': {'precision': 0.3482744286587504, 'recall': 0.3386323393846166, 'f1-score': 0.2485273660291428, 'support': 35371}, 'weighted avg': {'precision': 0.34926323396604025, 'recall': 0.32891351672273894, 'f1-score': 0.24551811684521208, 'support': 35371}}
[[2250  238 9927]
 [1864  272 9591]
 [1848  269 9112]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
2282/2282 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1491694
{'0': {'precision': 0.41295038005153045, 'recall': 0.7413494718956168, 'f1-score': 0.5304350436394474, 'support': 190682}, '1': {'precision': 0.5941760944417117, 'recall': 0.1518399895418001, 'f1-score': 0.24187063497148714, 'support': 198887}, '2': {'precision': 0.48810047786720323, 'recall': 0.47911801919496366, 'f1-score': 0.48356753894630833, 'support': 194426}, 'accuracy': 0.45328127809313434, 'macro avg': {'precision': 0.49840898412014845, 'recall': 0.45743582687746026, 'f1-score': 0.4186244058524143, 'support': 583995}, 'weighted avg': {'precision': 0.4996884027671872, 'recall': 0.45328127809313434, 'f1-score': 0.4165574059641028, 'support': 583995}}
[[141362   9605  39715]
 [110708  30199  57980]
 [ 90252  11021  93153]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1501701
{'0': {'precision': 0.42264592067075135, 'recall': 0.7053196641911528, 'f1-score': 0.5285630746894661, 'support': 74328}, '1': {'precision': 0.6205564142194745, 'recall': 0.15169342868708677, 'f1-score': 0.24379242296098713, 'support': 74110}, '2': {'precision': 0.4779202537929698, 'recall': 0.5172662341917306, 'f1-score': 0.49681544697026914, 'support': 76305}, 'accuracy': 0.4589108448316522, 'macro avg': {'precision': 0.5070408628943985, 'recall': 0.4580931090233234, 'f1-score': 0.4230569815402408, 'support': 224743}, 'weighted avg': {'precision': 0.5066745874847867, 'recall': 0.4589108448316522, 'f1-score': 0.42387969975582673, 'support': 224743}}
[[52425  3140 18763]
 [38514 11242 24354]
 [33101  3734 39470]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1743605
{'0': {'precision': 0.41817266779521434, 'recall': 0.7251953822350934, 'f1-score': 0.5304624134879065, 'support': 25207}, '1': {'precision': 0.5983355978260869, 'recall': 0.1329183172986229, 'f1-score': 0.2175161300280925, 'support': 26505}, '2': {'precision': 0.47124077075454707, 'recall': 0.5099980510621711, 'f1-score': 0.48985398727068513, 'support': 25655}, 'accuracy': 0.4509286905269689, 'macro avg': {'precision': 0.4959163454586162, 'recall': 0.4560372501986292, 'f1-score': 0.4126108435955613, 'support': 77367}, 'weighted avg': {'precision': 0.4974917656262012, 'recall': 0.4509286905269689, 'f1-score': 0.4097849874832121, 'support': 77367}}
[[18280  1099  5828]
 [14129  3523  8853]
 [11305  1266 13084]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
5098/5098 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5971657
{'0': {'precision': 0.5091051533954443, 'recall': 0.6584887797869658, 'f1-score': 0.5742407899103884, 'support': 210201}, '1': {'precision': 0.8391987258281942, 'recall': 0.8116742619913724, 'f1-score': 0.8252070407310427, 'support': 887388}, '2': {'precision': 0.5456969710842409, 'recall': 0.45996083387194797, 'f1-score': 0.49917423724909765, 'support': 207322}, 'accuracy': 0.7311188272610163, 'macro avg': {'precision': 0.6313336167692931, 'recall': 0.643374625216762, 'f1-score': 0.6328740226301762, 'support': 1304911}, 'weighted avg': {'precision': 0.7393947010204008, 'recall': 0.7311188272610163, 'f1-score': 0.7329807281532223, 'support': 1304911}}
[[138415  58029  13757]
 [101486 720270  65632]
 [ 31978  79984  95360]]
Evaluating performance on  train set...
1876/1876 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61462986
{'0': {'precision': 0.5014483915230981, 'recall': 0.6414974124255585, 'f1-score': 0.562892561512, 'support': 76906}, '1': {'precision': 0.8492328633551144, 'recall': 0.7993643030278764, 'f1-score': 0.8235443439631921, 'support': 324683}, '2': {'precision': 0.5299389803818647, 'recall': 0.5136737133989672, 'f1-score': 0.5216795954089508, 'support': 78618}, 'accuracy': 0.727309264546331, 'macro avg': {'precision': 0.6268734117533591, 'recall': 0.6515118096174674, 'f1-score': 0.6360388336280476, 'support': 480207}, 'weighted avg': {'precision': 0.7412607615692096, 'recall': 0.727309264546331, 'f1-score': 0.7323801402280763, 'support': 480207}}
[[ 49335  20297   7274]
 [ 36596 259540  28547]
 [ 12454  25780  40384]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5658225
{'0': {'precision': 0.502055622732769, 'recall': 0.6317986174514152, 'f1-score': 0.5595041004119663, 'support': 23001}, '1': {'precision': 0.8533823788301352, 'recall': 0.8239224947667866, 'f1-score': 0.8383937227200939, 'support': 111786}, '2': {'precision': 0.5510697674418604, 'recall': 0.5023531905872376, 'f1-score': 0.5255850060995896, 'support': 23585}, 'accuracy': 0.7481309827494759, 'macro avg': {'precision': 0.6355025896682549, 'recall': 0.6526914342684799, 'f1-score': 0.6411609430772166, 'support': 158372}, 'weighted avg': {'precision': 0.7573369310452491, 'recall': 0.7481309827494759, 'f1-score': 0.7513055140455566, 'support': 158372}}
[[14532  6859  1610]
 [11641 92103  8042]
 [ 2772  8965 11848]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
5760/5760 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6072278
{'0': {'precision': 0.47477709184434447, 'recall': 0.6219963207610115, 'f1-score': 0.5385061324695956, 'support': 209826}, '1': {'precision': 0.8545173568773924, 'recall': 0.8286110519465152, 'f1-score': 0.8413648326255669, 'support': 1056375}, '2': {'precision': 0.5151198689744512, 'recall': 0.43340855620108515, 'f1-score': 0.4707446877860147, 'support': 208270}, 'accuracy': 0.7433859329888483, 'macro avg': {'precision': 0.614804772565396, 'recall': 0.628005309636204, 'f1-score': 0.6168718842937256, 'support': 1474471}, 'weighted avg': {'precision': 0.7525379380509998, 'recall': 0.7433859329888483, 'f1-score': 0.7459158972550778, 'support': 1474471}}
[[130511  63526  15789]
 [111873 875324  69178]
 [ 32505  85499  90266]]
Evaluating performance on  train set...
2159/2159 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74513924
{'0': {'precision': 0.47865797229380525, 'recall': 0.6178238018229932, 'f1-score': 0.5394094004957762, 'support': 108832}, '1': {'precision': 0.7743588489243827, 'recall': 0.7589077299709044, 'f1-score': 0.7665554370114785, 'support': 333727}, '2': {'precision': 0.5506782592326788, 'recall': 0.4255864702673213, 'f1-score': 0.48011816778389244, 'support': 109980}, 'accuracy': 0.664772984350426, 'macro avg': {'precision': 0.6012316934836223, 'recall': 0.6007726673537397, 'f1-score': 0.5953610017637158, 'support': 552539}, 'weighted avg': {'precision': 0.6715930549084805, 'recall': 0.664772984350426, 'f1-score': 0.6648013014378324, 'support': 552539}}
[[ 67239  32107   9486]
 [ 51754 253268  28705]
 [ 21481  41693  46806]]
Evaluating performance on  val set...
850/850 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69537014
{'0': {'precision': 0.48836227689339123, 'recall': 0.6096196306704135, 'f1-score': 0.542295330774038, 'support': 39856}, '1': {'precision': 0.7967099708178411, 'recall': 0.7815665189275594, 'f1-score': 0.7890655946949134, 'support': 137630}, '2': {'precision': 0.5454433837748243, 'recall': 0.44582152086103516, 'f1-score': 0.49062646677158395, 'support': 39859}, 'accuracy': 0.6884630426280798, 'macro avg': {'precision': 0.6101718771620189, 'recall': 0.6123358901530027, 'f1-score': 0.607329130746845, 'support': 217345}, 'weighted avg': {'precision': 0.6940863052998837, 'recall': 0.6884630426280798, 'f1-score': 0.6890827985011827, 'support': 217345}}
[[ 24297  12146   3413]
 [ 18667 107567  11396]
 [  6788  15301  17770]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
6315/6315 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6985768
{'0': {'precision': 0.49509667186260836, 'recall': 0.5947249296186431, 'f1-score': 0.5403569408565805, 'support': 304413}, '1': {'precision': 0.7791017054305257, 'recall': 0.8053530106093291, 'f1-score': 0.7920098917153954, 'support': 1007321}, '2': {'precision': 0.5828075032218033, 'recall': 0.4007246281686073, 'f1-score': 0.47491141889237637, 'support': 304708}, 'accuracy': 0.6894123018332857, 'macro avg': {'precision': 0.6190019601716458, 'recall': 0.6002675227988599, 'f1-score': 0.6024260838214507, 'support': 1616442}, 'weighted avg': {'precision': 0.6886145502773401, 'recall': 0.6894123018332857, 'f1-score': 0.6848431197639484, 'support': 1616442}}
[[181042 101616  21755]
 [130421 811249  65651]
 [ 54207 128397 122104]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7703296
{'0': {'precision': 0.4925457027381494, 'recall': 0.6232367534248895, 'f1-score': 0.5502373388151747, 'support': 118106}, '1': {'precision': 0.7462811919059108, 'recall': 0.762443278958261, 'f1-score': 0.7542756679166343, 'support': 311172}, '2': {'precision': 0.5953246383009051, 'recall': 0.4099195995517859, 'f1-score': 0.4855242699165411, 'support': 122263}, 'accuracy': 0.6544880616309576, 'macro avg': {'precision': 0.6113838443149885, 'recall': 0.5985332106449789, 'f1-score': 0.5966790922161166, 'support': 551541}, 'weighted avg': {'precision': 0.6584833948299791, 'recall': 0.6544880616309576, 'f1-score': 0.6510077275993371, 'support': 551541}}
[[ 73608  34256  10242]
 [ 50095 237251  23826]
 [ 25741  46404  50118]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7083075
{'0': {'precision': 0.4957559741103223, 'recall': 0.6141723544753344, 'f1-score': 0.5486473423964904, 'support': 36042}, '1': {'precision': 0.7837779654561412, 'recall': 0.8000135223075818, 'f1-score': 0.7918125279698198, 'support': 118323}, '2': {'precision': 0.5750720517983339, 'recall': 0.4002858006540438, 'f1-score': 0.4720178878123076, 'support': 36389}, 'accuracy': 0.6886461096490768, 'macro avg': {'precision': 0.6182019971215992, 'recall': 0.6048238924789867, 'f1-score': 0.604159252726206, 'support': 190754}, 'weighted avg': {'precision': 0.689544093012156, 'recall': 0.6886461096490768, 'f1-score': 0.6848623891568688, 'support': 190754}}
[[22136 11221  2685]
 [15585 94660  8078]
 [ 6930 14893 14566]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
6082/6082 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8319405
{'0': {'precision': 0.4636369273978823, 'recall': 0.6492327430207347, 'f1-score': 0.5409587162654997, 'support': 356986}, '1': {'precision': 0.7519025699743592, 'recall': 0.6938961487182882, 'f1-score': 0.7217357309437549, 'support': 846056}, '2': {'precision': 0.5430215587642008, 'recall': 0.4238555865242734, 'f1-score': 0.4760950704169452, 'support': 353762}, 'accuracy': 0.6222915665684312, 'macro avg': {'precision': 0.5861870187121475, 'recall': 0.5889948260877654, 'f1-score': 0.5795965058753999, 'support': 1556804}, 'weighted avg': {'precision': 0.6383359533877276, 'recall': 0.6222915665684312, 'f1-score': 0.6244638876601964, 'support': 1556804}}
[[231767  84821  40398]
 [173194 587075  85787]
 [ 94928 108890 149944]]
Evaluating performance on  train set...
2440/2440 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94768685
{'0': {'precision': 0.4570927344544856, 'recall': 0.680664171289798, 'f1-score': 0.5469123425737789, 'support': 179532}, '1': {'precision': 0.679215464543428, 'recall': 0.5514458261998382, 'f1-score': 0.6086979997341839, 'support': 265765}, '2': {'precision': 0.5301473083012893, 'recall': 0.4183222711807686, 'f1-score': 0.46764267587806535, 'support': 179290}, 'accuracy': 0.5503748877258092, 'macro avg': {'precision': 0.5554851690997343, 'recall': 0.5501440895568016, 'f1-score': 0.5410843393953427, 'support': 624587}, 'weighted avg': {'precision': 0.5725776899644165, 'recall': 0.5503748877258092, 'f1-score': 0.5504478094236502, 'support': 624587}}
[[122201  29675  27656]
 [ 80395 146555  38815]
 [ 64748  39541  75001]]
Evaluating performance on  val set...
826/826 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86696404
{'0': {'precision': 0.4697612012732126, 'recall': 0.6342821901439667, 'f1-score': 0.5397635018778805, 'support': 51887}, '1': {'precision': 0.7090231387355987, 'recall': 0.6743057601649971, 'f1-score': 0.6912287987616683, 'support': 108608}, '2': {'precision': 0.5413899025965502, 'recall': 0.4047857409261331, 'f1-score': 0.463226705004942, 'support': 50943}, 'accuracy': 0.5995469120971633, 'macro avg': {'precision': 0.5733914142017872, 'recall': 0.5711245637450323, 'f1-score': 0.5647396685481637, 'support': 211438}, 'weighted avg': {'precision': 0.6099192685810267, 'recall': 0.5995469120971633, 'f1-score': 0.5991252482094591, 'support': 211438}}
[[32911 13323  5653]
 [23558 73235 11815]
 [13590 16732 20621]]
testing model on single stock: results/universal/W3/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
13689/13689 - 198s - 198s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2466562
{'0': {'precision': 0.4118911266543853, 'recall': 0.7568274142650417, 'f1-score': 0.5334569195750345, 'support': 1147140}, '1': {'precision': 0.5038434975828003, 'recall': 0.05655819001657528, 'f1-score': 0.10170018008680837, 'support': 1186707}, '2': {'precision': 0.48132837566011494, 'recall': 0.5195040323855369, 'f1-score': 0.4996881197028631, 'support': 1170399}, 'accuracy': 0.44041771040046845, 'macro avg': {'precision': 0.4656876666324335, 'recall': 0.44429654555571796, 'f1-score': 0.37828173978823526, 'support': 3504246}, 'weighted avg': {'precision': 0.4662223034742785, 'recall': 0.44041771040046845, 'f1-score': 0.37596463317463796, 'support': 3504246}}
[[868187  30160 248793]
 [713182  67118 406407]
 [526438  35934 608027]]
Evaluating performance on  train set...
5475/5475 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2731256
{'0': {'precision': 0.4096642154821452, 'recall': 0.7210040740660904, 'f1-score': 0.5224690054405468, 'support': 463910}, '1': {'precision': 0.5520317424583521, 'recall': 0.042218420118152175, 'f1-score': 0.07843803666999206, 'support': 464655}, '2': {'precision': 0.46379609647095643, 'recall': 0.5388593258788036, 'f1-score': 0.4985179281310052, 'support': 473001}, 'accuracy': 0.43449898185315566, 'macro avg': {'precision': 0.47516401813715126, 'recall': 0.4340272733543487, 'f1-score': 0.36647499008051465, 'support': 1401566}, 'weighted avg': {'precision': 0.47513114111156124, 'recall': 0.43449898185315566, 'f1-score': 0.36717835675716504, 'support': 1401566}}
[[334481   7183 122246]
 [272611  19617 172427]
 [209384   8736 254881]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.24099
{'0': {'precision': 0.41017276831241134, 'recall': 0.7350230963379208, 'f1-score': 0.5265238331794699, 'support': 167992}, '1': {'precision': 0.5842920265912981, 'recall': 0.08170285720647255, 'f1-score': 0.1433594436739398, 'support': 179651}, '2': {'precision': 0.477421868591584, 'recall': 0.5365120151175586, 'f1-score': 0.5052451109380978, 'support': 173573}, 'accuracy': 0.4437315815324165, 'macro avg': {'precision': 0.49062888783176445, 'recall': 0.45107932288731734, 'f1-score': 0.39170946259716916, 'support': 521216}, 'weighted avg': {'precision': 0.49258260790255654, 'recall': 0.4437315815324165, 'f1-score': 0.38736985978905275, 'support': 521216}}
[[123478   4662  39852]
 [102893  14678  62080]
 [ 74668   5781  93124]]
training model: results/universal/W3/deepVOL_L3/h30
Epoch 1/50
10532/10532 - 592s - loss: 2.9132 - accuracy30: 0.5029 - val_loss: 3.3995 - val_accuracy30: 0.4853 - 592s/epoch - 56ms/step
Epoch 2/50
10532/10532 - 591s - loss: 2.8296 - accuracy30: 0.5234 - val_loss: 3.2071 - val_accuracy30: 0.5092 - 591s/epoch - 56ms/step
Epoch 3/50
10532/10532 - 591s - loss: 2.7971 - accuracy30: 0.5303 - val_loss: 3.2035 - val_accuracy30: 0.5095 - 591s/epoch - 56ms/step
Epoch 4/50
10532/10532 - 596s - loss: 2.7778 - accuracy30: 0.5345 - val_loss: 3.1784 - val_accuracy30: 0.5123 - 596s/epoch - 57ms/step
Epoch 5/50
10532/10532 - 589s - loss: 2.7654 - accuracy30: 0.5378 - val_loss: 3.1649 - val_accuracy30: 0.5148 - 589s/epoch - 56ms/step
Epoch 6/50
10532/10532 - 596s - loss: 2.7571 - accuracy30: 0.5401 - val_loss: 3.1584 - val_accuracy30: 0.5179 - 596s/epoch - 57ms/step
Epoch 7/50
10532/10532 - 590s - loss: 2.7505 - accuracy30: 0.5417 - val_loss: 3.1458 - val_accuracy30: 0.5195 - 590s/epoch - 56ms/step
Epoch 8/50
10532/10532 - 590s - loss: 2.7453 - accuracy30: 0.5428 - val_loss: 3.1341 - val_accuracy30: 0.5219 - 590s/epoch - 56ms/step
Epoch 9/50
10532/10532 - 593s - loss: 2.7411 - accuracy30: 0.5437 - val_loss: 3.1235 - val_accuracy30: 0.5235 - 593s/epoch - 56ms/step
Epoch 10/50
10532/10532 - 587s - loss: 2.7373 - accuracy30: 0.5447 - val_loss: 3.1089 - val_accuracy30: 0.5229 - 587s/epoch - 56ms/step
Epoch 11/50
10532/10532 - 594s - loss: 2.7338 - accuracy30: 0.5456 - val_loss: 3.0888 - val_accuracy30: 0.5266 - 594s/epoch - 56ms/step
Epoch 12/50
10532/10532 - 589s - loss: 2.7308 - accuracy30: 0.5463 - val_loss: 3.0912 - val_accuracy30: 0.5225 - 589s/epoch - 56ms/step
Epoch 13/50
10532/10532 - 587s - loss: 2.7280 - accuracy30: 0.5471 - val_loss: 3.0559 - val_accuracy30: 0.5253 - 587s/epoch - 56ms/step
Epoch 14/50
10532/10532 - 601s - loss: 2.7252 - accuracy30: 0.5476 - val_loss: 3.0515 - val_accuracy30: 0.5254 - 601s/epoch - 57ms/step
Epoch 15/50
10532/10532 - 583s - loss: 2.7231 - accuracy30: 0.5483 - val_loss: 3.0224 - val_accuracy30: 0.5237 - 583s/epoch - 55ms/step
Epoch 16/50
10532/10532 - 596s - loss: 2.7206 - accuracy30: 0.5488 - val_loss: 3.0258 - val_accuracy30: 0.5246 - 596s/epoch - 57ms/step
Epoch 17/50
10532/10532 - 584s - loss: 2.7180 - accuracy30: 0.5493 - val_loss: 3.0386 - val_accuracy30: 0.5232 - 584s/epoch - 55ms/step
Epoch 18/50
10532/10532 - 587s - loss: 2.7162 - accuracy30: 0.5498 - val_loss: 3.0493 - val_accuracy30: 0.5234 - 587s/epoch - 56ms/step
Epoch 19/50
10532/10532 - 590s - loss: 2.7143 - accuracy30: 0.5502 - val_loss: 3.0297 - val_accuracy30: 0.5222 - 590s/epoch - 56ms/step
Epoch 20/50
10532/10532 - 587s - loss: 2.7125 - accuracy30: 0.5506 - val_loss: 3.0250 - val_accuracy30: 0.5237 - 587s/epoch - 56ms/step
Epoch 21/50
10532/10532 - 584s - loss: 2.7103 - accuracy30: 0.5510 - val_loss: 3.0269 - val_accuracy30: 0.5229 - 584s/epoch - 55ms/step
Epoch 22/50
10532/10532 - 617s - loss: 2.7085 - accuracy30: 0.5515 - val_loss: 3.0240 - val_accuracy30: 0.5237 - 617s/epoch - 59ms/step
Epoch 23/50
10532/10532 - 620s - loss: 2.7070 - accuracy30: 0.5517 - val_loss: 3.0336 - val_accuracy30: 0.5235 - 620s/epoch - 59ms/step
Epoch 24/50
10532/10532 - 636s - loss: 2.7053 - accuracy30: 0.5524 - val_loss: 3.0218 - val_accuracy30: 0.5250 - 636s/epoch - 60ms/step
Epoch 25/50
10532/10532 - 606s - loss: 2.7037 - accuracy30: 0.5526 - val_loss: 3.0259 - val_accuracy30: 0.5251 - 606s/epoch - 58ms/step
Epoch 26/50
10532/10532 - 587s - loss: 2.7023 - accuracy30: 0.5530 - val_loss: 3.0274 - val_accuracy30: 0.5257 - 587s/epoch - 56ms/step
Epoch 27/50
10532/10532 - 583s - loss: 2.7005 - accuracy30: 0.5533 - val_loss: 3.0138 - val_accuracy30: 0.5235 - 583s/epoch - 55ms/step
Epoch 28/50
10532/10532 - 586s - loss: 2.6994 - accuracy30: 0.5535 - val_loss: 3.0156 - val_accuracy30: 0.5232 - 586s/epoch - 56ms/step
Epoch 29/50
10532/10532 - 579s - loss: 2.6979 - accuracy30: 0.5540 - val_loss: 3.0143 - val_accuracy30: 0.5247 - 579s/epoch - 55ms/step
Epoch 30/50
10532/10532 - 585s - loss: 2.6964 - accuracy30: 0.5545 - val_loss: 3.0136 - val_accuracy30: 0.5246 - 585s/epoch - 56ms/step
Epoch 31/50
10532/10532 - 588s - loss: 2.6950 - accuracy30: 0.5546 - val_loss: 3.0240 - val_accuracy30: 0.5228 - 588s/epoch - 56ms/step
Epoch 32/50
10532/10532 - 582s - loss: 2.6939 - accuracy30: 0.5547 - val_loss: 3.0198 - val_accuracy30: 0.5226 - 582s/epoch - 55ms/step
Epoch 33/50
10532/10532 - 586s - loss: 2.6929 - accuracy30: 0.5549 - val_loss: 3.0190 - val_accuracy30: 0.5245 - 586s/epoch - 56ms/step
Epoch 34/50
10532/10532 - 582s - loss: 2.6913 - accuracy30: 0.5557 - val_loss: 3.0145 - val_accuracy30: 0.5241 - 582s/epoch - 55ms/step
Epoch 35/50
10532/10532 - 578s - loss: 2.6902 - accuracy30: 0.5558 - val_loss: 3.0240 - val_accuracy30: 0.5239 - 578s/epoch - 55ms/step
Epoch 36/50
10532/10532 - 575s - loss: 2.6892 - accuracy30: 0.5562 - val_loss: 3.0238 - val_accuracy30: 0.5264 - 575s/epoch - 55ms/step
Epoch 37/50
10532/10532 - 578s - loss: 2.6880 - accuracy30: 0.5563 - val_loss: 3.0125 - val_accuracy30: 0.5246 - 578s/epoch - 55ms/step
Epoch 38/50
10532/10532 - 583s - loss: 2.6867 - accuracy30: 0.5566 - val_loss: 3.0127 - val_accuracy30: 0.5256 - 583s/epoch - 55ms/step
Epoch 39/50
10532/10532 - 581s - loss: 2.6858 - accuracy30: 0.5567 - val_loss: 3.0222 - val_accuracy30: 0.5255 - 581s/epoch - 55ms/step
Epoch 40/50
10532/10532 - 584s - loss: 2.6844 - accuracy30: 0.5573 - val_loss: 3.0178 - val_accuracy30: 0.5255 - 584s/epoch - 55ms/step
Epoch 41/50
10532/10532 - 579s - loss: 2.6833 - accuracy30: 0.5573 - val_loss: 3.0231 - val_accuracy30: 0.5229 - 579s/epoch - 55ms/step
Epoch 42/50
10532/10532 - 577s - loss: 2.6825 - accuracy30: 0.5576 - val_loss: 3.0214 - val_accuracy30: 0.5229 - 577s/epoch - 55ms/step
Epoch 43/50
10532/10532 - 587s - loss: 2.6812 - accuracy30: 0.5578 - val_loss: 3.0192 - val_accuracy30: 0.5243 - 587s/epoch - 56ms/step
Epoch 44/50
10532/10532 - 586s - loss: 2.6801 - accuracy30: 0.5581 - val_loss: 3.0043 - val_accuracy30: 0.5252 - 586s/epoch - 56ms/step
Epoch 45/50
10532/10532 - 576s - loss: 2.6789 - accuracy30: 0.5581 - val_loss: 3.0322 - val_accuracy30: 0.5243 - 576s/epoch - 55ms/step
Epoch 46/50
10532/10532 - 583s - loss: 2.6780 - accuracy30: 0.5585 - val_loss: 3.0350 - val_accuracy30: 0.5226 - 583s/epoch - 55ms/step
Epoch 47/50
10532/10532 - 580s - loss: 2.6768 - accuracy30: 0.5589 - val_loss: 3.0255 - val_accuracy30: 0.5232 - 580s/epoch - 55ms/step
Epoch 48/50
10532/10532 - 586s - loss: 2.6754 - accuracy30: 0.5592 - val_loss: 3.0210 - val_accuracy30: 0.5227 - 586s/epoch - 56ms/step
Epoch 49/50
10532/10532 - 582s - loss: 2.6749 - accuracy30: 0.5593 - val_loss: 3.0267 - val_accuracy30: 0.5214 - 582s/epoch - 55ms/step
Epoch 50/50
10532/10532 - 584s - loss: 2.6735 - accuracy30: 0.5597 - val_loss: 3.0425 - val_accuracy30: 0.5202 - 584s/epoch - 55ms/step
testing model in sample: results/universal/W3/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
27685/27685 - 838s - 838s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0185597
{'0': {'precision': 0.4453066019298954, 'recall': 0.6279277306736932, 'f1-score': 0.5210797968520335, 'support': 1986735}, '1': {'precision': 0.7193505079675641, 'recall': 0.5055471031040699, 'f1-score': 0.5937893292179429, 'support': 3093777}, '2': {'precision': 0.48141610110270167, 'recall': 0.5065576916845508, 'f1-score': 0.4936669994583026, 'support': 2005965}, 'accuracy': 0.5401432898180577, 'macro avg': {'precision': 0.548691070333387, 'recall': 0.5466775084874379, 'f1-score': 0.5361787085094263, 'support': 7086477}, 'weighted avg': {'precision': 0.5751687499334349, 'recall': 0.5401432898180577, 'f1-score': 0.5450632186271258, 'support': 7086477}}
[[1247526  281645  457564]
 [ 892703 1564050  637024]
 [ 661270  328558 1016137]]
Evaluating performance on  train set...
10532/10532 - 319s - 319s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0962352
{'0': {'precision': 0.42748291314075143, 'recall': 0.5975621024848803, 'f1-score': 0.4984124296177131, 'support': 768367}, '1': {'precision': 0.6964118793148109, 'recall': 0.4319465764165754, 'f1-score': 0.5331864630745965, 'support': 1145262}, '2': {'precision': 0.4591082003043692, 'recall': 0.5349517182128387, 'f1-score': 0.4941366531803785, 'support': 782179}, 'accuracy': 0.5090373646787901, 'macro avg': {'precision': 0.5276676642533105, 'recall': 0.5214867990380981, 'f1-score': 0.508578515290896, 'support': 2695808}, 'weighted avg': {'precision': 0.5509081575004339, 'recall': 0.5090373646787901, 'f1-score': 0.5119449054345812, 'support': 2695808}}
[[459147 100235 208985]
 [366590 494692 283980]
 [248334 115417 418428]]
Evaluating performance on  val set...
3814/3814 - 117s - 117s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0462404
{'0': {'precision': 0.4334081201303006, 'recall': 0.6049159627275102, 'f1-score': 0.5049974176096305, 'support': 275592}, '1': {'precision': 0.7084566928010387, 'recall': 0.47370241224199694, 'f1-score': 0.5677706882554058, 'support': 419278}, '2': {'precision': 0.47356517822674044, 'recall': 0.5239193493851547, 'f1-score': 0.4974712954436005, 'support': 280965}, 'accuracy': 0.5252178903195724, 'macro avg': {'precision': 0.53847666371936, 'recall': 0.5341792414515539, 'f1-score': 0.5234131337695456, 'support': 975835}, 'weighted avg': {'precision': 0.563147823338638, 'recall': 0.5252178903195724, 'f1-score': 0.5298016872407062, 'support': 975835}}
[[166710  37538  71344]
 [128372 198613  92293]
 [ 89567  44195 147203]]
testing model out of sample: results/universal/W3/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
16161/16161 - 482s - 482s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9152275
{'0': {'precision': 0.4486639886456015, 'recall': 0.6204555269584348, 'f1-score': 0.5207575905956625, 'support': 1032738}, '1': {'precision': 0.7552613417645345, 'recall': 0.6085070809770561, 'f1-score': 0.6739881445972358, 'support': 2079021}, '2': {'precision': 0.4776597247896435, 'recall': 0.4816415276997065, 'f1-score': 0.47964236254525133, 'support': 1024704}, 'accuracy': 0.5800624833341915, 'macro avg': {'precision': 0.5605283517332599, 'recall': 0.5702013785450658, 'f1-score': 0.5581293659127166, 'support': 4136463}, 'weighted avg': {'precision': 0.6099453496751627, 'recall': 0.5800624833341915, 'f1-score': 0.5875872953377903, 'support': 4136463}}
[[ 640768  187522  204448]
 [ 478664 1265099  335258]
 [ 308737  222427  493540]]
Evaluating performance on  train set...
6181/6181 - 195s - 195s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9982896
{'0': {'precision': 0.45291962080777504, 'recall': 0.6120126934371313, 'f1-score': 0.520582488357741, 'support': 464492}, '1': {'precision': 0.6746394823228351, 'recall': 0.49544041578478765, 'f1-score': 0.5713176786772144, 'support': 649182}, '2': {'precision': 0.4817843616985622, 'recall': 0.4913343573026171, 'f1-score': 0.4865124986118529, 'support': 468113}, 'accuracy': 0.528456739118478, 'macro avg': {'precision': 0.536447821609724, 'recall': 0.5329291555081787, 'f1-score': 0.5261375552156028, 'support': 1581787}, 'weighted avg': {'precision': 0.5524579932881903, 'recall': 0.528456739118478, 'f1-score': 0.5313220931288382, 'support': 1581787}}
[[284275  70425 109792]
 [189951 321631 137600]
 [153424  84689 230000]]
Evaluating performance on  val set...
2209/2209 - 67s - 67s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9523862
{'0': {'precision': 0.45696888430806487, 'recall': 0.5991406454998688, 'f1-score': 0.5184852983335556, 'support': 152440}, '1': {'precision': 0.6967109662713924, 'recall': 0.566539399764869, 'f1-score': 0.624918421958591, 'support': 261131}, '2': {'precision': 0.4822937770871444, 'recall': 0.4866395421917899, 'f1-score': 0.4844569140388314, 'support': 151155}, 'accuracy': 0.5539535987363784, 'macro avg': {'precision': 0.5453245425555339, 'recall': 0.5507731958188425, 'f1-score': 0.5426202114436594, 'support': 564726}, 'weighted avg': {'precision': 0.5746048241677268, 'recall': 0.5539535987363784, 'f1-score': 0.5585922308588158, 'support': 564726}}
[[ 91333  29960  31147]
 [ 65378 147941  47812]
 [ 43156  34441  73558]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
678/678 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3336413
{'0': {'precision': 0.3967325653339619, 'recall': 0.45952632836228374, 'f1-score': 0.42582695591676684, 'support': 58606}, '1': {'precision': 0.3374538449189276, 'recall': 0.03699076110866696, 'f1-score': 0.06667301043549974, 'support': 56825}, '2': {'precision': 0.38334625960657126, 'recall': 0.6566311830368696, 'f1-score': 0.48408186108037293, 'support': 57961}, 'accuracy': 0.38693826704807605, 'macro avg': {'precision': 0.37251088995315357, 'recall': 0.3843827575026068, 'f1-score': 0.3255272758108798, 'support': 173392}, 'weighted avg': {'precision': 0.37283067277923265, 'recall': 0.38693826704807605, 'f1-score': 0.3275962970986828, 'support': 173392}}
[[26931  2166 29509]
 [23010  2102 31713]
 [17941  1961 38059]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3561536
{'0': {'precision': 0.3884022708840227, 'recall': 0.4284500111831805, 'f1-score': 0.40744443262788466, 'support': 22355}, '1': {'precision': 0.2986348122866894, 'recall': 0.01598976654940838, 'f1-score': 0.030354277785004987, 'support': 21889}, '2': {'precision': 0.372620194088451, 'recall': 0.6832691872311524, 'f1-score': 0.4822472915534819, 'support': 22085}, 'accuracy': 0.37718041882133, 'macro avg': {'precision': 0.353219092419721, 'recall': 0.3759029883212471, 'f1-score': 0.3066820006554572, 'support': 66329}, 'weighted avg': {'precision': 0.35352360442942177, 'recall': 0.37718041882133, 'f1-score': 0.3079087052690525, 'support': 66329}}
[[ 9578   435 12342]
 [ 8474   350 13065]
 [ 6608   387 15090]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3576128
{'0': {'precision': 0.399172950620287, 'recall': 0.4333817509573485, 'f1-score': 0.4155745489078822, 'support': 7573}, '1': {'precision': 0.215311004784689, 'recall': 0.00641573994867408, 'f1-score': 0.01246019659421293, 'support': 7014}, '2': {'precision': 0.3745834259053544, 'recall': 0.6884442629644753, 'f1-score': 0.4851798561151079, 'support': 7347}, 'accuracy': 0.3822832132761922, 'macro avg': {'precision': 0.32968912710344345, 'recall': 0.3760805846234993, 'f1-score': 0.30440486720573434, 'support': 21934}, 'weighted avg': {'precision': 0.33214154156715053, 'recall': 0.3822832132761922, 'f1-score': 0.3099825969120497, 'support': 21934}}
[[3282   89 4202]
 [2726   45 4243]
 [2214   75 5058]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.755929
{'0': {'precision': 0.4001120892978072, 'recall': 0.6195512646670644, 'f1-score': 0.4862192016004881, 'support': 55311}, '1': {'precision': 0.8516599920089946, 'recall': 0.7050961024374671, 'f1-score': 0.7714787732126888, 'support': 259983}, '2': {'precision': 0.4102069167215033, 'recall': 0.5196835806517349, 'f1-score': 0.4585008662678565, 'support': 53979}, 'accuracy': 0.6651799617085462, 'macro avg': {'precision': 0.5539929993427684, 'recall': 0.6147769825854222, 'f1-score': 0.5720662803603445, 'support': 369273}, 'weighted avg': {'precision': 0.7194955456568324, 'recall': 0.6651799617085462, 'f1-score': 0.6830016124009924, 'support': 369273}}
[[ 34268  14094   6949]
 [ 43286 183313  33384]
 [  8092  17835  28052]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92438614
{'0': {'precision': 0.41725828654509456, 'recall': 0.6614117243239267, 'f1-score': 0.5117033383915023, 'support': 40787}, '1': {'precision': 0.755213261837171, 'recall': 0.5156562212091843, 'f1-score': 0.6128566654579325, 'support': 83577}, '2': {'precision': 0.48264708659930117, 'recall': 0.5147943894638765, 'f1-score': 0.4982026880475709, 'support': 39711}, 'accuracy': 0.551680633856468, 'macro avg': {'precision': 0.5517062116605222, 'recall': 0.5639541116656624, 'f1-score': 0.540920897299002, 'support': 164075}, 'weighted avg': {'precision': 0.6052327958179178, 'recall': 0.551680633856468, 'f1-score': 0.5599615574402493, 'support': 164075}}
[[26977  6205  7605]
 [26172 43097 14308]
 [11504  7764 20443]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88694423
{'0': {'precision': 0.40678601165695255, 'recall': 0.6454191161899729, 'f1-score': 0.4990423657396767, 'support': 15139}, '1': {'precision': 0.741333074860263, 'recall': 0.5803131085763423, 'f1-score': 0.6510143282735139, 'support': 39539}, '2': {'precision': 0.4938287901788661, 'recall': 0.48445998445998445, 'f1-score': 0.48909952606635076, 'support': 15444}, 'accuracy': 0.5732580359944097, 'macro avg': {'precision': 0.5473159588986939, 'recall': 0.5700640697420999, 'f1-score': 0.5463854066931805, 'support': 70122}, 'weighted avg': {'precision': 0.6145944741008094, 'recall': 0.5732580359944097, 'f1-score': 0.5825434383090635, 'support': 70122}}
[[ 9771  3391  1977]
 [10902 22945  5692]
 [ 3347  4615  7482]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
1359/1359 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2500197
{'0': {'precision': 0.3985776451313304, 'recall': 0.6672810496339908, 'f1-score': 0.4990592293520442, 'support': 114478}, '1': {'precision': 0.545158424637252, 'recall': 0.10641179142066802, 'f1-score': 0.17806610291272867, 'support': 121105}, '2': {'precision': 0.4253403568086455, 'recall': 0.5022456290434689, 'f1-score': 0.46060492142232534, 'support': 112218}, 'accuracy': 0.4187365763755711, 'macro avg': {'precision': 0.456358808859076, 'recall': 0.4253128233660426, 'f1-score': 0.37924341789569943, 'support': 347801}, 'weighted avg': {'precision': 0.45825235360275396, 'recall': 0.4187365763755711, 'f1-score': 0.37488150098240036, 'support': 347801}}
[[76389  5008 33081]
 [65152 12887 43066]
 [50113  5744 56361]]
Evaluating performance on  train set...
444/444 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3027389
{'0': {'precision': 0.3887638489051732, 'recall': 0.5943768672641913, 'f1-score': 0.4700695125681677, 'support': 37488}, '1': {'precision': 0.5102739726027398, 'recall': 0.055511203363670235, 'f1-score': 0.1001296020736332, 'support': 37578}, '2': {'precision': 0.41863718238608055, 'recall': 0.5671157490330452, 'f1-score': 0.4816942089539075, 'support': 38523}, 'accuracy': 0.406861579906505, 'macro avg': {'precision': 0.43922500129799785, 'recall': 0.4056679398869689, 'f1-score': 0.35063110786523616, 'support': 113589}, 'weighted avg': {'precision': 0.4390937035037008, 'recall': 0.406861579906505, 'f1-score': 0.3516268484220289, 'support': 113589}}
[[22282  1037 14169]
 [19322  2086 16170]
 [15711   965 21847]]
Evaluating performance on  val set...
144/144 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2436581
{'0': {'precision': 0.40409305387907385, 'recall': 0.5966944827027465, 'f1-score': 0.48186070856096047, 'support': 12343}, '1': {'precision': 0.603225806451613, 'recall': 0.09347663084228942, 'f1-score': 0.1618697251677126, 'support': 12003}, '2': {'precision': 0.415076105339454, 'recall': 0.5588809368900456, 'f1-score': 0.4763621239428809, 'support': 12296}, 'accuracy': 0.4191638011025599, 'macro avg': {'precision': 0.4741316552233803, 'recall': 0.4163506834783605, 'f1-score': 0.37336418589051795, 'support': 36642}, 'weighted avg': {'precision': 0.47300954396927153, 'recall': 0.4191638011025599, 'f1-score': 0.37519452303252154, 'support': 36642}}
[[7365  352 4626]
 [5823 1122 5058]
 [5038  386 6872]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2860618
{'0': {'precision': 0.38078274683483365, 'recall': 0.08221598586425527, 'f1-score': 0.13523332450014106, 'support': 96210}, '1': {'precision': 0.3640226145903663, 'recall': 0.5369379338094759, 'f1-score': 0.4338870350876479, 'support': 99410}, '2': {'precision': 0.3526622168903632, 'recall': 0.45633171849768195, 'f1-score': 0.3978545411606551, 'support': 95985}, 'accuracy': 0.36037790847207696, 'macro avg': {'precision': 0.36582252610518773, 'recall': 0.35849521272380436, 'f1-score': 0.32232496691614804, 'support': 291605}, 'weighted avg': {'precision': 0.3658129287139424, 'recall': 0.36037790847207696, 'f1-score': 0.32349094302747594, 'support': 291605}}
[[ 7910 47961 40339]
 [ 5972 53377 40061]
 [ 6891 45293 43801]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2991521
{'0': {'precision': 0.41091492776886035, 'recall': 0.06842277195379087, 'f1-score': 0.11731160896130347, 'support': 33673}, '1': {'precision': 0.3491659849912864, 'recall': 0.6066363889146352, 'f1-score': 0.44322298845385494, 'support': 32367}, '2': {'precision': 0.3455629066652086, 'recall': 0.39037647858179686, 'f1-score': 0.3666052757515553, 'support': 32379}, 'accuracy': 0.3513447606661315, 'macro avg': {'precision': 0.36854793980845174, 'recall': 0.3551452131500743, 'f1-score': 0.30904662438890457, 'support': 98419}, 'weighted avg': {'precision': 0.3691073385615236, 'recall': 0.3513447606661315, 'f1-score': 0.30650935794307504, 'support': 98419}}
[[ 2304 18703 12666]
 [ 1460 19635 11272]
 [ 1843 17896 12640]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3458757
{'0': {'precision': 0.3696193525435788, 'recall': 0.0844166395840104, 'f1-score': 0.13744295257622857, 'support': 12308}, '1': {'precision': 0.3310981706958414, 'recall': 0.47239006377979187, 'f1-score': 0.3893211605629906, 'support': 11916}, '2': {'precision': 0.32187158557747925, 'recall': 0.44926886157710594, 'f1-score': 0.3750468059612072, 'support': 11147}, 'accuracy': 0.33010093014051056, 'macro avg': {'precision': 0.3408630362722998, 'recall': 0.3353585216469694, 'f1-score': 0.3006036397001421, 'support': 35371}, 'weighted avg': {'precision': 0.34159462151339165, 'recall': 0.33010093014051056, 'f1-score': 0.2971769403077774, 'support': 35371}}
[[1039 6065 5204]
 [ 940 5629 5347]
 [ 832 5307 5008]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
2282/2282 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2330168
{'0': {'precision': 0.40869377695625386, 'recall': 0.6811353110912582, 'f1-score': 0.5108613193778568, 'support': 194766}, '1': {'precision': 0.5636835038659197, 'recall': 0.06389264985253523, 'f1-score': 0.11477565719080095, 'support': 190554}, '2': {'precision': 0.4500201853689717, 'recall': 0.5386334465836164, 'f1-score': 0.49035560209040235, 'support': 198675}, 'accuracy': 0.43125369224051574, 'macro avg': {'precision': 0.4741324887303818, 'recall': 0.42788713584247, 'f1-score': 0.3719975262196867, 'support': 583995}, 'weighted avg': {'precision': 0.47332521491880697, 'recall': 0.43125369224051574, 'f1-score': 0.37464494654165575, 'support': 583995}}
[[132662   4848  57256]
 [104852  12175  73527]
 [ 87086   4576 107013]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.262771
{'0': {'precision': 0.4074112599141854, 'recall': 0.6315046958764964, 'f1-score': 0.4952895801719777, 'support': 74427}, '1': {'precision': 0.6147479307750188, 'recall': 0.06619046976059628, 'f1-score': 0.119512878963344, 'support': 74059}, '2': {'precision': 0.43503214863319, 'recall': 0.5784911549103688, 'f1-score': 0.49660870984628025, 'support': 76257}, 'accuracy': 0.427230214066734, 'macro avg': {'precision': 0.4857304464407981, 'recall': 0.42539544018248715, 'f1-score': 0.37047038966053397, 'support': 224743}, 'weighted avg': {'precision': 0.4851063721905526, 'recall': 0.427230214066734, 'f1-score': 0.3719084121567918, 'support': 224743}}
[[47001  1616 25810]
 [37677  4902 31480]
 [30687  1456 44114]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2848017
{'0': {'precision': 0.4039096521031727, 'recall': 0.6679724596391263, 'f1-score': 0.503414546864283, 'support': 25272}, '1': {'precision': 0.5821550463188688, 'recall': 0.04514519056261343, 'f1-score': 0.08379241376890416, 'support': 26448}, '2': {'precision': 0.43461010679553724, 'recall': 0.5680586423363356, 'f1-score': 0.49245381872264193, 'support': 25647}, 'accuracy': 0.4219370015639743, 'macro avg': {'precision': 0.47355826840585963, 'recall': 0.42705876417935845, 'f1-score': 0.35988692645194303, 'support': 77367}, 'weighted avg': {'precision': 0.47502018692695813, 'recall': 0.4219370015639743, 'f1-score': 0.3563327681891987, 'support': 77367}}
[[16881   420  7971]
 [14272  1194 10982]
 [10641   437 14569]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
5098/5098 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67878044
{'0': {'precision': 0.5142702168051944, 'recall': 0.6391948001475248, 'f1-score': 0.5699676082436312, 'support': 252161}, '1': {'precision': 0.7858454260691683, 'recall': 0.7637364685533653, 'f1-score': 0.7746332254108845, 'support': 804792}, '2': {'precision': 0.5600011464274455, 'recall': 0.47279781253276765, 'f1-score': 0.5127180168990431, 'support': 247958}, 'accuracy': 0.6843861382117248, 'macro avg': {'precision': 0.6200389297672694, 'recall': 0.6252430270778859, 'f1-score': 0.619106283517853, 'support': 1304911}, 'weighted avg': {'precision': 0.6904515086030611, 'recall': 0.6843861382117248, 'f1-score': 0.6853147523788609, 'support': 1304911}}
[[161180  71437  19544]
 [117575 614649  72568]
 [ 34660  96064 117234]]
Evaluating performance on  train set...
1876/1876 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6891742
{'0': {'precision': 0.5058327061606279, 'recall': 0.6171040694306295, 'f1-score': 0.5559554699924667, 'support': 91487}, '1': {'precision': 0.8031512863352644, 'recall': 0.7526782234422924, 'f1-score': 0.7770960501201043, 'support': 295065}, '2': {'precision': 0.5443506782661583, 'recall': 0.5351556243660243, 'f1-score': 0.5397139903514817, 'support': 93655}, 'accuracy': 0.6844256747610926, 'macro avg': {'precision': 0.6177782235873502, 'recall': 0.6349793057463153, 'f1-score': 0.6242551701546842, 'support': 480207}, 'weighted avg': {'precision': 0.696033406143703, 'recall': 0.6844256747610926, 'f1-score': 0.6886685489346415, 'support': 480207}}
[[ 56457  24516  10514]
 [ 41537 222089  31439]
 [ 13618  29917  50120]]
Evaluating performance on  val set...
619/619 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64913106
{'0': {'precision': 0.5103965766634523, 'recall': 0.6068216832073376, 'f1-score': 0.5544479908339471, 'support': 27911}, '1': {'precision': 0.7966548946470379, 'recall': 0.789395562807797, 'f1-score': 0.7930086157948009, 'support': 101731}, '2': {'precision': 0.5754183070866141, 'recall': 0.48837452140619564, 'f1-score': 0.5283352788342057, 'support': 28730}, 'accuracy': 0.7026115727527593, 'macro avg': {'precision': 0.6274899261323681, 'recall': 0.62819725580711, 'f1-score': 0.6252639618209845, 'support': 158372}, 'weighted avg': {'precision': 0.706071438771941, 'recall': 0.7026115727527593, 'f1-score': 0.7029514682298256, 'support': 158372}}
[[16937  8860  2114]
 [13186 80306  8239]
 [ 3061 11638 14031]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
5760/5760 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68685514
{'0': {'precision': 0.49103445950502395, 'recall': 0.5746648830592813, 'f1-score': 0.5295682355786101, 'support': 253419}, '1': {'precision': 0.8015586901301623, 'recall': 0.8105443374451534, 'f1-score': 0.8060264713876722, 'support': 971346}, '2': {'precision': 0.5285296643087869, 'recall': 0.41412701336772045, 'f1-score': 0.46438627453622, 'support': 249706}, 'accuracy': 0.702869028960217, 'macro avg': {'precision': 0.6070409379813244, 'recall': 0.5997787446240518, 'f1-score': 0.5999936605008341, 'support': 1474471}, 'weighted avg': {'precision': 0.7019502706206947, 'recall': 0.702869028960217, 'f1-score': 0.7006535093860558, 'support': 1474471}}
[[145631  86361  21427]
 [113208 787319  70819]
 [ 37741 108555 103410]]
Evaluating performance on  train set...
2159/2159 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81690437
{'0': {'precision': 0.4873728944124897, 'recall': 0.5909444712548843, 'f1-score': 0.5341846965699208, 'support': 128474}, '1': {'precision': 0.7100052171864218, 'recall': 0.7167311684737366, 'f1-score': 0.7133523390181298, 'support': 294307}, '2': {'precision': 0.5515411165068026, 'recall': 0.42364247291111146, 'f1-score': 0.47920462371309264, 'support': 129758}, 'accuracy': 0.6186549727711528, 'macro avg': {'precision': 0.5829730760352381, 'recall': 0.5771060375465774, 'f1-score': 0.5755805531003811, 'support': 552539}, 'weighted avg': {'precision': 0.6210260685434407, 'recall': 0.6186549727711528, 'f1-score': 0.6167059069319925, 'support': 552539}}
[[ 75921  38420  14133]
 [ 52804 210939  30564]
 [ 27051  47736  54971]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7721099
{'0': {'precision': 0.4942364954969767, 'recall': 0.5725320071950059, 'f1-score': 0.5305110004313895, 'support': 47255}, '1': {'precision': 0.7341230904231981, 'recall': 0.7486414369854544, 'f1-score': 0.741311186205841, 'support': 122924}, '2': {'precision': 0.5506725012752021, 'recall': 0.43488953907475725, 'f1-score': 0.48597997986139907, 'support': 47166}, 'accuracy': 0.6422646023603027, 'macro avg': {'precision': 0.5930106957317923, 'recall': 0.5853543277517392, 'f1-score': 0.5859340554995432, 'support': 217345}, 'weighted avg': {'precision': 0.6421565325037937, 'recall': 0.6422646023603027, 'f1-score': 0.6400697752821315, 'support': 217345}}
[[27055 15138  5062]
 [19223 92026 11675]
 [ 8463 18191 20512]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
6315/6315 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78281033
{'0': {'precision': 0.5077028560030916, 'recall': 0.562586163549814, 'f1-score': 0.5337373303173352, 'support': 361957}, '1': {'precision': 0.7159994726897219, 'recall': 0.767361126684757, 'f1-score': 0.7407910959756746, 'support': 891820}, '2': {'precision': 0.5710944934370461, 'recall': 0.4087380916272593, 'f1-score': 0.47646521853725643, 'support': 362665}, 'accuracy': 0.6410468176402246, 'macro avg': {'precision': 0.5982656073766198, 'recall': 0.5795617939539434, 'f1-score': 0.5836645482767554, 'support': 1616442}, 'weighted avg': {'precision': 0.6368463804125387, 'recall': 0.6410468176402246, 'f1-score': 0.635123027342467, 'support': 1616442}}
[[203632 124512  33813]
 [129957 684348  77515]
 [ 67496 146934 148235]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8301364
{'0': {'precision': 0.5104429296230585, 'recall': 0.5930321703407974, 'f1-score': 0.5486468673364582, 'support': 138264}, '1': {'precision': 0.6813790174048374, 'recall': 0.7232288367658417, 'f1-score': 0.7016804764277955, 'support': 270599}, '2': {'precision': 0.5869491836006443, 'recall': 0.42654789105538343, 'f1-score': 0.49405556795811095, 'support': 142678}, 'accuracy': 0.6138419446605058, 'macro avg': {'precision': 0.5929237102095134, 'recall': 0.5809362993873409, 'f1-score': 0.5814609705741215, 'support': 551541}, 'weighted avg': {'precision': 0.6140995820254648, 'recall': 0.6138419446605058, 'f1-score': 0.6096065497060427, 'support': 551541}}
[[ 81995  40749  15520]
 [ 47586 195705  27308]
 [ 31054  50765  60859]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78501916
{'0': {'precision': 0.5142737459419835, 'recall': 0.5718744177380287, 'f1-score': 0.5415467407725985, 'support': 42936}, '1': {'precision': 0.7147955127638901, 'recall': 0.775107518127221, 'f1-score': 0.7437307856680039, 'support': 104401}, '2': {'precision': 0.5749186214302493, 'recall': 0.3945919800999608, 'f1-score': 0.4679851398601398, 'support': 43417}, 'accuracy': 0.642754542499764, 'macro avg': {'precision': 0.6013292933787077, 'recall': 0.5805246386550702, 'f1-score': 0.5844208887669141, 'support': 190754}, 'weighted avg': {'precision': 0.6378239285701218, 'recall': 0.642754542499764, 'f1-score': 0.6354603281380482, 'support': 190754}}
[[24554 14340  4042]
 [14854 80922  8625]
 [ 8337 17948 17132]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
6082/6082 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8908859
{'0': {'precision': 0.4729846369454182, 'recall': 0.6299308088823217, 'f1-score': 0.5402909100005003, 'support': 411469}, '1': {'precision': 0.7028260238798706, 'recall': 0.6095055269882885, 'f1-score': 0.6528477438229633, 'support': 739191}, '2': {'precision': 0.5129119885577239, 'recall': 0.4644362590608257, 'f1-score': 0.4874719441583764, 'support': 406144}, 'accuracy': 0.5770578698410332, 'macro avg': {'precision': 0.5629075497943375, 'recall': 0.567957531643812, 'f1-score': 0.5602035326606133, 'support': 1556804}, 'weighted avg': {'precision': 0.5925327232444597, 'recall': 0.5770578698410332, 'f1-score': 0.5799547934996927, 'support': 1556804}}
[[259197  89129  63143]
 [172662 450541 115988]
 [116144 101372 188628]]
Evaluating performance on  train set...
2440/2440 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9709314
{'0': {'precision': 0.4716067188205644, 'recall': 0.6418403156412951, 'f1-score': 0.5437101108498489, 'support': 201748}, '1': {'precision': 0.6217143889440881, 'recall': 0.46643535773823236, 'f1-score': 0.5329957100156422, 'support': 221349}, '2': {'precision': 0.5123076923076924, 'recall': 0.46771055635515413, 'f1-score': 0.488994396014944, 'support': 201490}, 'accuracy': 0.5235043316623625, 'macro avg': {'precision': 0.535209600024115, 'recall': 0.5253287432448938, 'f1-score': 0.5219000722934783, 'support': 624587}, 'weighted avg': {'precision': 0.5379337826596986, 'recall': 0.5235043316623625, 'f1-score': 0.522261871785738, 'support': 624587}}
[[129490  28788  43470]
 [ 71863 103245  46241]
 [ 73219  34032  94239]]
Evaluating performance on  val set...
826/826 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92414
{'0': {'precision': 0.4782682247612107, 'recall': 0.6125806290314516, 'f1-score': 0.5371557185972246, 'support': 59997}, '1': {'precision': 0.6473187872055254, 'recall': 0.578044467447327, 'f1-score': 0.6107234604890663, 'support': 92742}, '2': {'precision': 0.5119459198454853, 'recall': 0.4515579481762892, 'f1-score': 0.4798595144558901, 'support': 58699}, 'accuracy': 0.5527294053103037, 'macro avg': {'precision': 0.5458443106040738, 'recall': 0.547394348218356, 'f1-score': 0.5425795645140603, 'support': 211438}, 'weighted avg': {'precision': 0.5617675687105597, 'recall': 0.5527294053103037, 'f1-score': 0.5535179128652417, 'support': 211438}}
[[36753 13886  9358]
 [23222 53609 15911]
 [16871 15322 26506]]
testing model on single stock: results/universal/W3/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
13689/13689 - 197s - 197s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2592362
{'0': {'precision': 0.4244788195328058, 'recall': 0.6884651165837903, 'f1-score': 0.5251636681659171, 'support': 1221096}, '1': {'precision': 0.37974462834303496, 'recall': 0.027282485941035217, 'f1-score': 0.05090755441280915, 'support': 1037772}, '2': {'precision': 0.46819037472122244, 'recall': 0.5448096883034709, 'f1-score': 0.5036024407677387, 'support': 1245378}, 'accuracy': 0.44160398556494035, 'macro avg': {'precision': 0.42413794086568773, 'recall': 0.42018576360943216, 'f1-score': 0.3598912211154883, 'support': 3504246}, 'weighted avg': {'precision': 0.42676562191998096, 'recall': 0.44160398556494035, 'f1-score': 0.37705146544485274, 'support': 3504246}}
[[840682  23749 356665]
 [595434  28313 414025]
 [544388  22496 678494]]
Evaluating performance on  train set...
5475/5475 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3464866
{'0': {'precision': 0.39805801363161836, 'recall': 0.6276122682891097, 'f1-score': 0.4871469852439498, 'support': 464156}, '1': {'precision': 0.4204771667112339, 'recall': 0.030522760506757195, 'f1-score': 0.056914083943447866, 'support': 463654}, '2': {'precision': 0.43028482221603853, 'recall': 0.5777151107321068, 'f1-score': 0.4932183735089027, 'support': 473756}, 'accuracy': 0.41322206731613065, 'macro avg': {'precision': 0.4162733341862969, 'recall': 0.4119500465093246, 'f1-score': 0.3457598142321001, 'support': 1401566}, 'weighted avg': {'precision': 0.4163677999204529, 'recall': 0.41322206731613065, 'f1-score': 0.34687328496816405, 'support': 1401566}}
[[291310  10154 162692]
 [249809  14152 199693]
 [190709   9351 273696]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2637999
{'0': {'precision': 0.4123891121389036, 'recall': 0.6442204649798644, 'f1-score': 0.5028716591784127, 'support': 177298}, '1': {'precision': 0.47929284661974136, 'recall': 0.054325843738983616, 'f1-score': 0.0975902409759024, 'support': 161691}, '2': {'precision': 0.4576575779036827, 'recall': 0.5673912208399414, 'f1-score': 0.5066507900339828, 'support': 182227}, 'accuracy': 0.43436310473968565, 'macro avg': {'precision': 0.44977984555410927, 'recall': 0.42197917651959643, 'f1-score': 0.36903756339609933, 'support': 521216}, 'weighted avg': {'precision': 0.4489706223819881, 'recall': 0.43436310473968565, 'f1-score': 0.37846700139322553, 'support': 521216}}
[[114219   4873  58206]
 [ 88587   8784  64320]
 [ 74163   4670 103394]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        84 (peak)  21.21 (ave)

============================================
