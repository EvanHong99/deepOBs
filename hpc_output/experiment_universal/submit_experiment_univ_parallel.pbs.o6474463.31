This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W10/deepLOB_L1/h50
Epoch 1/50
8543/8543 - 159s - loss: 3.0832 - accuracy50: 0.4465 - val_loss: 3.2398 - val_accuracy50: 0.3488 - 159s/epoch - 19ms/step
Epoch 2/50
8543/8543 - 132s - loss: 3.0603 - accuracy50: 0.4549 - val_loss: 3.3889 - val_accuracy50: 0.3853 - 132s/epoch - 15ms/step
Epoch 3/50
8543/8543 - 132s - loss: 3.0360 - accuracy50: 0.4639 - val_loss: 3.4933 - val_accuracy50: 0.3995 - 132s/epoch - 15ms/step
Epoch 4/50
8543/8543 - 133s - loss: 3.0170 - accuracy50: 0.4696 - val_loss: 3.5007 - val_accuracy50: 0.4003 - 133s/epoch - 16ms/step
Epoch 5/50
8543/8543 - 135s - loss: 3.0045 - accuracy50: 0.4729 - val_loss: 3.5804 - val_accuracy50: 0.3959 - 135s/epoch - 16ms/step
Epoch 6/50
8543/8543 - 137s - loss: 2.9947 - accuracy50: 0.4757 - val_loss: 3.4295 - val_accuracy50: 0.4066 - 137s/epoch - 16ms/step
Epoch 7/50
8543/8543 - 134s - loss: 2.9877 - accuracy50: 0.4771 - val_loss: 3.4662 - val_accuracy50: 0.4005 - 134s/epoch - 16ms/step
Epoch 8/50
8543/8543 - 134s - loss: 2.9828 - accuracy50: 0.4780 - val_loss: 3.4214 - val_accuracy50: 0.3927 - 134s/epoch - 16ms/step
Epoch 9/50
8543/8543 - 133s - loss: 2.9769 - accuracy50: 0.4794 - val_loss: 3.3921 - val_accuracy50: 0.3921 - 133s/epoch - 16ms/step
Epoch 10/50
8543/8543 - 133s - loss: 2.9729 - accuracy50: 0.4802 - val_loss: 3.3920 - val_accuracy50: 0.3930 - 133s/epoch - 16ms/step
Epoch 11/50
8543/8543 - 136s - loss: 2.9700 - accuracy50: 0.4809 - val_loss: 3.3617 - val_accuracy50: 0.3967 - 136s/epoch - 16ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 245s - 245s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.111955
{'0': {'precision': 0.38382700487753146, 'recall': 0.42503969805738756, 'f1-score': 0.40338343429756357, 'support': 3201668}, '1': {'precision': 0.29487457622070606, 'recall': 0.2818489964454072, 'f1-score': 0.28821469183534226, 'support': 3091212}, '2': {'precision': 0.3934998809592224, 'recall': 0.3684283508880675, 'f1-score': 0.3805516219420367, 'support': 3252399}, 'accuracy': 0.3593783900921073, 'macro avg': {'precision': 0.3574004873524867, 'recall': 0.3584390151302874, 'f1-score': 0.35738324935831417, 'support': 9545279}, 'weighted avg': {'precision': 0.3583158844170497, 'recall': 0.3593783900921073, 'f1-score': 0.3583067883035144, 'support': 9545279}}
[[1360836 1060182  780650]
 [1153708  871255 1066249]
 [1030897 1023226 1198276]]
Evaluating performance on  train set...
8543/8543 - 54s - 54s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884743
{'0': {'precision': 0.3404085046467479, 'recall': 0.6907390986497604, 'f1-score': 0.4560616984817728, 'support': 655217}, '1': {'precision': 0.41299611395262453, 'recall': 0.1338814612576375, 'f1-score': 0.20221170417691536, 'support': 863667}, '2': {'precision': 0.3716225580895754, 'recall': 0.3211941255038662, 'f1-score': 0.34457306063701965, 'support': 667836}, 'accuracy': 0.35794157459574155, 'macro avg': {'precision': 0.3750090588963159, 'recall': 0.38193822847042136, 'f1-score': 0.3342821544319026, 'support': 2186720}, 'weighted avg': {'precision': 0.3786106482048727, 'recall': 0.35794157459574155, 'f1-score': 0.3217518696170888, 'support': 2186720}}
[[452584  78680 123953]
 [509284 115629 238754]
 [367664  85667 214505]]
Evaluating performance on  val set...
3077/3077 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0867437
{'0': {'precision': 0.3271505321890537, 'recall': 0.6436117925238445, 'f1-score': 0.4337991598707723, 'support': 225838}, '1': {'precision': 0.4029700035202787, 'recall': 0.13220897400438275, 'f1-score': 0.1990969487119047, 'support': 329017}, '2': {'precision': 0.3656369833830422, 'recall': 0.36975199062424596, 'f1-score': 0.3676829738553691, 'support': 232088}, 'accuracy': 0.349029091052338, 'macro avg': {'precision': 0.3652525063641248, 'recall': 0.38185758571749107, 'f1-score': 0.333526360812682, 'support': 786943}, 'weighted avg': {'precision': 0.37020084013219073, 'recall': 0.349029091052338, 'f1-score': 0.3161721007460326, 'support': 786943}}
[[145352  30618  49868]
 [186501  43499  99017]
 [112444  33829  85815]]
testing model out of sample: results/universal/W10/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 126s - 126s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0737368
{'0': {'precision': 0.390060820343826, 'recall': 0.5561130379775796, 'f1-score': 0.45851596065497546, 'support': 1617191}, '1': {'precision': 0.4748249185598992, 'recall': 0.25239802314292625, 'f1-score': 0.3295959571982075, 'support': 2227981}, '2': {'precision': 0.3941974275058985, 'recall': 0.48086841826733523, 'f1-score': 0.4332407540882041, 'support': 1615627}, 'accuracy': 0.40993689751261675, 'macro avg': {'precision': 0.4196943888032079, 'recall': 0.429793159795947, 'f1-score': 0.40711755731379573, 'support': 5460799}, 'weighted avg': {'precision': 0.4258680372963238, 'recall': 0.40993689751261675, 'f1-score': 0.39843928975361714, 'support': 5460799}}
[[899341 314132 403718]
 [875415 562338 790228]
 [530887 307836 776904]]
Evaluating performance on  train set...
4055/4055 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0675458
{'0': {'precision': 0.36455893832943015, 'recall': 0.6292748657739152, 'f1-score': 0.4616622538632784, 'support': 287202}, '1': {'precision': 0.5448313267449121, 'recall': 0.18847823715501255, 'f1-score': 0.2800695724342734, 'support': 458350}, '2': {'precision': 0.38021045379098684, 'recall': 0.4990477103943438, 'f1-score': 0.4315982817360391, 'support': 291928}, 'accuracy': 0.3978910436827698, 'macro avg': {'precision': 0.42986690628844304, 'recall': 0.43893360444109053, 'f1-score': 0.391110036011197, 'support': 1037480}, 'weighted avg': {'precision': 0.44860582582210223, 'recall': 0.3978910436827698, 'f1-score': 0.3729766688031855, 'support': 1037480}}
[[180729  36670  69803]
 [204278  86389 167683]
 [110740  35502 145686]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0734093
{'0': {'precision': 0.3493237746593451, 'recall': 0.6333308751682307, 'f1-score': 0.4502854221692084, 'support': 108482}, '1': {'precision': 0.5430919591292759, 'recall': 0.2112688226551609, 'f1-score': 0.30420032846170436, 'support': 173594}, '2': {'precision': 0.3926240483568614, 'recall': 0.45479442341951093, 'f1-score': 0.42142868875346984, 'support': 112829}, 'accuracy': 0.3967891011762323, 'macro avg': {'precision': 0.4283465940484941, 'recall': 0.43313137374763416, 'f1-score': 0.39197147979479424, 'support': 394905}, 'weighted avg': {'precision': 0.4468726048739289, 'recall': 0.3967891011762323, 'f1-score': 0.3778240146620236, 'support': 394905}}
[[68705 15669 24108]
 [81646 36675 55273]
 [46329 15186 51314]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1409178
{'0': {'precision': 0.44353173920522965, 'recall': 0.3995196312007283, 'f1-score': 0.4203768431993967, 'support': 51627}, '1': {'precision': 0.2571448883833357, 'recall': 0.21985837157705984, 'f1-score': 0.23704431883345622, 'support': 32903}, '2': {'precision': 0.4178769793355642, 'recall': 0.5038685524126456, 'f1-score': 0.4568615988081543, 'support': 48080}, 'accuracy': 0.39277580876253676, 'macro avg': {'precision': 0.3728512023080432, 'recall': 0.37441551839681125, 'f1-score': 0.37142758694700245, 'support': 132610}, 'weighted avg': {'precision': 0.3879841379147818, 'recall': 0.39277580876253676, 'f1-score': 0.3881168100228379, 'support': 132610}}
[[20626 11489 19512]
 [11433  7234 14236]
 [14445  9409 24226]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1175599
{'0': {'precision': 0.397676669893514, 'recall': 0.5330910978458344, 'f1-score': 0.4555333776890663, 'support': 11559}, '1': {'precision': 0.3128287217013492, 'recall': 0.12315448325531149, 'f1-score': 0.176732769200956, 'support': 11108}, '2': {'precision': 0.39896229678312, 'recall': 0.49476664378860674, 'f1-score': 0.4417295392746352, 'support': 11656}, 'accuracy': 0.38740786061824434, 'macro avg': {'precision': 0.369822562792661, 'recall': 0.3836707416299176, 'f1-score': 0.35799856205488584, 'support': 34323}, 'weighted avg': {'precision': 0.37065380646393853, 'recall': 0.38740786061824434, 'f1-score': 0.3606170038393289, 'support': 34323}}
[[6162 1574 3823]
 [4875 1368 4865]
 [4458 1431 5767]]
Evaluating performance on  val set...
46/46 - 0s - 470ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1316134
{'0': {'precision': 0.39736514153462704, 'recall': 0.5581395348837209, 'f1-score': 0.4642262895174709, 'support': 3999}, '1': {'precision': 0.33143831722569644, 'recall': 0.1546419098143236, 'f1-score': 0.21088804485440404, 'support': 3770}, '2': {'precision': 0.4003715745471435, 'recall': 0.4405826731408127, 'f1-score': 0.4195157561747171, 'support': 3913}, 'accuracy': 0.3885464817668208, 'macro avg': {'precision': 0.37639167776915566, 'recall': 0.3844547059462857, 'f1-score': 0.364876696848864, 'support': 11682}, 'weighted avg': {'precision': 0.37709635577305445, 'recall': 0.3885464817668208, 'f1-score': 0.367493067522097, 'support': 11682}}
[[2232  621 1146]
 [1751  583 1436]
 [1634  555 1724]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
1840/1840 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0390263
{'0': {'precision': 0.2831357705924926, 'recall': 0.6729468374439201, 'f1-score': 0.39857501807042306, 'support': 86038}, '1': {'precision': 0.7891972866977496, 'recall': 0.15723972795685942, 'f1-score': 0.26223227693589746, 'support': 298188}, '2': {'precision': 0.2790827956573813, 'recall': 0.666213209439596, 'f1-score': 0.3933765592825173, 'support': 86741}, 'accuracy': 0.3451919136584941, 'macro avg': {'precision': 0.4504719509825412, 'recall': 0.4987999249467919, 'f1-score': 0.35139461809627925, 'support': 470967}, 'weighted avg': {'precision': 0.6027970467871048, 'recall': 0.3451919136584941, 'f1-score': 0.3112935550228132, 'support': 470967}}
[[ 57899   6005  22134]
 [124159  46887 127142]
 [ 22434   6519  57788]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0420016
{'0': {'precision': 0.20484190224838858, 'recall': 0.7017503187666628, 'f1-score': 0.3171169283553553, 'support': 17254}, '1': {'precision': 0.8181640529581318, 'recall': 0.16671810136285353, 'f1-score': 0.2769930532583526, 'support': 100451}, '2': {'precision': 0.22218440427780664, 'recall': 0.7008928571428571, 'f1-score': 0.337409377167807, 'support': 17696}, 'accuracy': 0.30470971410846304, 'macro avg': {'precision': 0.41506345316144233, 'recall': 0.5231204257574578, 'f1-score': 0.31050645292717166, 'support': 135401}, 'weighted avg': {'precision': 0.6621185566073446, 'recall': 0.30470971410846304, 'f1-score': 0.2900020015587742, 'support': 135401}}
[[12108  1985  3161]
 [43445 16747 40259]
 [ 3556  1737 12403]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0615827
{'0': {'precision': 0.22501639344262295, 'recall': 0.8027839513393379, 'f1-score': 0.3515070808471408, 'support': 8549}, '1': {'precision': 0.7668586919688242, 'recall': 0.06339290716566755, 'f1-score': 0.11710522911330176, 'support': 35698}, '2': {'precision': 0.2740563394630941, 'recall': 0.6089417091114884, 'f1-score': 0.3779948008150074, 'support': 8835}, 'accuracy': 0.27327530989789384, 'macro avg': {'precision': 0.42197714162484706, 'recall': 0.49170618920549797, 'f1-score': 0.2822023702584833, 'support': 53082}, 'weighted avg': {'precision': 0.5975712010210713, 'recall': 0.27327530989789384, 'f1-score': 0.19827889997078937, 'support': 53082}}
[[ 6863   264  1422]
 [20606  2263 12829]
 [ 3031   424  5380]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.155652
{'0': {'precision': 0.4042802605917258, 'recall': 0.4316490186522529, 'f1-score': 0.41751660595671736, 'support': 90284}, '1': {'precision': 0.2856677372806405, 'recall': 0.16827068081489402, 'f1-score': 0.21178865997170168, 'support': 72942}, '2': {'precision': 0.37018959667951595, 'recall': 0.474968272982814, 'f1-score': 0.41608395241311236, 'support': 84313}, 'accuracy': 0.3687944121936341, 'macro avg': {'precision': 0.35337919818396074, 'recall': 0.35829599081665364, 'f1-score': 0.3484630727805105, 'support': 247539}, 'weighted avg': {'precision': 0.35771741262923373, 'recall': 0.3687944121936341, 'f1-score': 0.3564070468397258, 'support': 247539}}
[[38971 16290 35023]
 [27560 12274 33108]
 [29865 14402 40046]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1278274
{'0': {'precision': 0.3654568981452955, 'recall': 0.640047482868397, 'f1-score': 0.46525857504265467, 'support': 18533}, '1': {'precision': 0.3335326953748006, 'recall': 0.0900285206909541, 'f1-score': 0.14178566888427477, 'support': 18583}, '2': {'precision': 0.3914639987227928, 'recall': 0.3841453861820461, 'f1-score': 0.38777016341591986, 'support': 19149}, 'accuracy': 0.3712965431440505, 'macro avg': {'precision': 0.3634845307476296, 'recall': 0.37140712991379904, 'f1-score': 0.3316048024476164, 'support': 56265}, 'weighted avg': {'precision': 0.3637642385678386, 'recall': 0.3712965431440505, 'f1-score': 0.332051028443854, 'support': 56265}}
[[11862  1595  5076]
 [10551  1673  6359]
 [10045  1748  7356]]
Evaluating performance on  val set...
79/79 - 1s - 693ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1347313
{'0': {'precision': 0.3775699203556214, 'recall': 0.5907839443558904, 'f1-score': 0.4607039945759647, 'support': 6901}, '1': {'precision': 0.31603053435114503, 'recall': 0.06529968454258675, 'f1-score': 0.10823529411764705, 'support': 6340}, '2': {'precision': 0.3874636673827878, 'recall': 0.452212389380531, 'f1-score': 0.4173415912339209, 'support': 6780}, 'accuracy': 0.3774536736426752, 'macro avg': {'precision': 0.36035470736318476, 'recall': 0.36943200609300275, 'f1-score': 0.32876029330917755, 'support': 20021}, 'weighted avg': {'precision': 0.3614328591486791, 'recall': 0.3774536736426752, 'f1-score': 0.334404176606593, 'support': 20021}}
[[4077  443 2381]
 [3460  414 2466]
 [3261  453 3066]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1551645
{'0': {'precision': 0.3924492118942015, 'recall': 0.48475886382368627, 'f1-score': 0.4337471104803575, 'support': 144379}, '1': {'precision': 0.3089840838339106, 'recall': 0.1763292881271112, 'f1-score': 0.22452685910915693, 'support': 119895}, '2': {'precision': 0.3885510825821496, 'recall': 0.436470157451483, 'f1-score': 0.4111189966107091, 'support': 142012}, 'accuracy': 0.37686260417538386, 'macro avg': {'precision': 0.36332812610342063, 'recall': 0.36585276980076015, 'f1-score': 0.35646432206674117, 'support': 406286}, 'weighted avg': {'precision': 0.36645611179069887, 'recall': 0.37686260417538386, 'f1-score': 0.3640968499618888, 'support': 406286}}
[[69989 23980 50410]
 [51622 21141 47132]
 [56728 23300 61984]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1347256
{'0': {'precision': 0.3740664045231392, 'recall': 0.6114090131203651, 'f1-score': 0.4641568265149984, 'support': 26295}, '1': {'precision': 0.3335383353833538, 'recall': 0.06569490430428813, 'f1-score': 0.10976926190797462, 'support': 24766}, '2': {'precision': 0.35689212173850104, 'recall': 0.40370051987392036, 'f1-score': 0.378855979409166, 'support': 24429}, 'accuracy': 0.365160948469996, 'macro avg': {'precision': 0.35483228721499804, 'recall': 0.3602681457661912, 'f1-score': 0.317594022610713, 'support': 75490}, 'weighted avg': {'precision': 0.35521266608809016, 'recall': 0.365160948469996, 'f1-score': 0.3202890715937382, 'support': 75490}}
[[16077  1635  8583]
 [13951  1627  9188]
 [12951  1616  9862]]
Evaluating performance on  val set...
131/131 - 1s - 871ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1594571
{'0': {'precision': 0.3675879070974439, 'recall': 0.5038683859493108, 'f1-score': 0.42507220825987474, 'support': 11245}, '1': {'precision': 0.322265625, 'recall': 0.08579599618684461, 'f1-score': 0.13551433851207992, 'support': 11539}, '2': {'precision': 0.34375840731772933, 'recall': 0.4835383159886471, 'f1-score': 0.4018397672773017, 'support': 10570}, 'accuracy': 0.35279126941296396, 'macro avg': {'precision': 0.3445373131383911, 'recall': 0.35773423270826754, 'f1-score': 0.3208087713497521, 'support': 33354}, 'weighted avg': {'precision': 0.3443567616338117, 'recall': 0.35279126941296396, 'f1-score': 0.3175356261346243, 'support': 33354}}
[[5666 1038 4541]
 [5333  990 5216]
 [4415 1044 5111]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
2104/2104 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1645389
{'0': {'precision': 0.45181049988122307, 'recall': 0.4816663953256996, 'f1-score': 0.466260998993127, 'support': 221124}, '1': {'precision': 0.19582181091367085, 'recall': 0.14744567682348575, 'f1-score': 0.1682249585435557, 'support': 97012}, '2': {'precision': 0.45770066019958305, 'recall': 0.47712373823295906, 'f1-score': 0.46721042016508063, 'support': 220425}, 'accuracy': 0.41960335040970287, 'macro avg': {'precision': 0.36844432366482566, 'recall': 0.36874527012738145, 'f1-score': 0.36723212590058774, 'support': 538561}, 'weighted avg': {'precision': 0.4081095335915258, 'recall': 0.41960335040970287, 'f1-score': 0.4129637936732729, 'support': 538561}}
[[106508  30256  84360]
 [ 42459  14304  40249]
 [ 86769  28486 105170]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1410356
{'0': {'precision': 0.3849601699415826, 'recall': 0.49571901414229835, 'f1-score': 0.43337478477137936, 'support': 36557}, '1': {'precision': 0.32735340729001583, 'recall': 0.14258103705339886, 'f1-score': 0.19864212490142905, 'support': 36218}, '2': {'precision': 0.3883028899751308, 'recall': 0.49325962036003157, 'f1-score': 0.4345333061430131, 'support': 36719}, 'accuracy': 0.37808464390742874, 'macro avg': {'precision': 0.36687215573557647, 'recall': 0.3771865571852429, 'f1-score': 0.35551673860527383, 'support': 109494}, 'weighted avg': {'precision': 0.36702621563538695, 'recall': 0.37808464390742874, 'f1-score': 0.35611933945999386, 'support': 109494}}
[[18122  5364 13071]
 [15593  5164 15461]
 [13360  5247 18112]]
Evaluating performance on  val set...
141/141 - 1s - 935ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1358545
{'0': {'precision': 0.38543352601156067, 'recall': 0.5532232639176968, 'f1-score': 0.45433175484618266, 'support': 12053}, '1': {'precision': 0.30624824880919027, 'recall': 0.09666578225877775, 'f1-score': 0.14694810432912075, 'support': 11307}, '2': {'precision': 0.4029513427279979, 'recall': 0.4829124512068828, 'f1-score': 0.43932311483132225, 'support': 12553}, 'accuracy': 0.3849024030295436, 'macro avg': {'precision': 0.3648777058495829, 'recall': 0.37760049912778576, 'f1-score': 0.3468676580022086, 'support': 35913}, 'weighted avg': {'precision': 0.36662566322967766, 'recall': 0.3849024030295436, 'f1-score': 0.35230768572071386, 'support': 35913}}
[[6668 1254 4131]
 [5363 1093 4851]
 [5269 1222 6062]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
5267/5267 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0289284
{'0': {'precision': 0.343060903720676, 'recall': 0.7261351529768557, 'f1-score': 0.46597362615238774, 'support': 305994}, '1': {'precision': 0.666238577810987, 'recall': 0.11670350136408815, 'f1-score': 0.19861590491162326, 'support': 733457}, '2': {'precision': 0.35120176633166267, 'recall': 0.6507103110080392, 'f1-score': 0.4561889526335449, 'support': 308738}, 'accuracy': 0.3773128248339068, 'macro avg': {'precision': 0.45350041595444185, 'recall': 0.49784965511632767, 'f1-score': 0.3735928278991853, 'support': 1348189}, 'weighted avg': {'precision': 0.520743944411594, 'recall': 0.3773128248339068, 'f1-score': 0.31828195037032164, 'support': 1348189}}
[[222193  22418  61383]
 [338109  85597 309751]
 [ 87376  20463 200899]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0349969
{'0': {'precision': 0.26344811921916994, 'recall': 0.8451091906332854, 'f1-score': 0.4016795971275618, 'support': 49409}, '1': {'precision': 0.7379115989320676, 'recall': 0.08693145083786193, 'f1-score': 0.1555392287130106, 'support': 171687}, '2': {'precision': 0.33385923772679627, 'recall': 0.6158430840991089, 'f1-score': 0.4329881014112931, 'support': 50167}, 'accuracy': 0.3228453567202309, 'macro avg': {'precision': 0.44507298529267797, 'recall': 0.5159612418567521, 'f1-score': 0.33006897575062183, 'support': 271263}, 'weighted avg': {'precision': 0.5767659179003035, 'recall': 0.3228453567202309, 'f1-score': 0.2516832920745796, 'support': 271263}}
[[ 41756   1996   5657]
 [100775  14925  55987]
 [ 15967   3305  30895]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.045108
{'0': {'precision': 0.2560098588696063, 'recall': 0.8516313809176167, 'f1-score': 0.3936762587126669, 'support': 17807}, '1': {'precision': 0.7386505622657226, 'recall': 0.05264407735577423, 'f1-score': 0.09828343423987586, 'support': 67377}, '2': {'precision': 0.29617963828490146, 'recall': 0.6398858522664911, 'f1-score': 0.40493141170342073, 'support': 18222}, 'accuracy': 0.2937160319517243, 'macro avg': {'precision': 0.4302800198067434, 'recall': 0.5147204368466274, 'f1-score': 0.29896370155198787, 'support': 103406}, 'weighted avg': {'precision': 0.5775662133676589, 'recall': 0.2937160319517243, 'f1-score': 0.2031883669394069, 'support': 103406}}
[[15165   442  2200]
 [38322  3547 25508]
 [ 5749   813 11660]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
10110/10110 - 65s - 65s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0282038
{'0': {'precision': 0.3420684500679606, 'recall': 0.524071784686474, 'f1-score': 0.4139478017965018, 'support': 592104}, '1': {'precision': 0.5607144331599373, 'recall': 0.31089482445228295, 'f1-score': 0.40000312925238934, 'support': 1397939}, '2': {'precision': 0.34377062970412453, 'recall': 0.5206953171765949, 'f1-score': 0.41412795429519816, 'support': 598058}, 'accuracy': 0.4081459726648999, 'macro avg': {'precision': 0.41551783764400746, 'recall': 0.4518873087717839, 'f1-score': 0.4093596284480298, 'support': 2588101}, 'weighted avg': {'precision': 0.46056141039155685, 'recall': 0.4081459726648999, 'f1-score': 0.40645734452741583, 'support': 2588101}}
[[310305 170719 111080]
 [479959 434612 483368]
 [116879 169773 311406]]
Evaluating performance on  train set...
1686/1686 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0240726
{'0': {'precision': 0.30634540395956644, 'recall': 0.6503683094255285, 'f1-score': 0.4165035782094348, 'support': 87698}, '1': {'precision': 0.6901005835745125, 'recall': 0.22669040809806199, 'f1-score': 0.3412755673652783, 'support': 256654}, '2': {'precision': 0.31549311513676603, 'recall': 0.5826797835259585, 'f1-score': 0.409345372824152, 'support': 87216}, 'accuracy': 0.3847273199125051, 'macro avg': {'precision': 0.43731303422361495, 'recall': 0.48657950034984965, 'f1-score': 0.3890415061329551, 'support': 431568}, 'weighted avg': {'precision': 0.5364137330454232, 'recall': 0.3847273199125051, 'f1-score': 0.3703187824505301, 'support': 431568}}
[[ 57036  13827  16835]
 [105049  58181  93424]
 [ 24097  12300  50819]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0481726
{'0': {'precision': 0.3098660607510165, 'recall': 0.638642413487134, 'f1-score': 0.417273254315898, 'support': 40572}, '1': {'precision': 0.5990337058069244, 'recall': 0.26878107919286565, 'f1-score': 0.3710674874471646, 'support': 97332}, '2': {'precision': 0.3508904032227702, 'recall': 0.43848506233827333, 'f1-score': 0.3898276727455245, 'support': 42510}, 'accuracy': 0.3919429756005631, 'macro avg': {'precision': 0.41993005659357036, 'recall': 0.448636185006091, 'f1-score': 0.3927228048361957, 'support': 180414}, 'weighted avg': {'precision': 0.4755361862792785, 'recall': 0.3919429756005631, 'f1-score': 0.38587873186517835, 'support': 180414}}
[[25911  8941  5720]
 [42409 26161 28762]
 [15300  8570 18640]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
6546/6546 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0745633
{'0': {'precision': 0.4258738908541592, 'recall': 0.23118170362429236, 'f1-score': 0.29968316971692516, 'support': 531690}, '1': {'precision': 0.42457216514652407, 'recall': 0.3910321374681891, 'f1-score': 0.4071125194276221, 'support': 621642}, '2': {'precision': 0.4076247342293018, 'recall': 0.6355905113918042, 'f1-score': 0.49669982177167776, 'support': 522437}, 'accuracy': 0.4165580100837287, 'macro avg': {'precision': 0.4193569300766617, 'recall': 0.4192681174947619, 'f1-score': 0.4011651703054084, 'support': 1675769}, 'weighted avg': {'precision': 0.41970165469752524, 'recall': 0.4165580100837287, 'f1-score': 0.4009569040218239, 'support': 1675769}}
[[122917 189842 218931]
 [114935 243082 263625]
 [ 50771 139610 332056]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0697755
{'0': {'precision': 0.42510031719341157, 'recall': 0.5311216791764548, 'f1-score': 0.47223342517395234, 'support': 104718}, '1': {'precision': 0.3985079852414425, 'recall': 0.276282500116697, 'f1-score': 0.32632582962558654, 'support': 107115}, '2': {'precision': 0.43523018427507226, 'recall': 0.4637108134101441, 'f1-score': 0.4490193311697475, 'support': 102937}, 'accuracy': 0.4223560059726149, 'macro avg': {'precision': 0.41961282890330875, 'recall': 0.4237049975677653, 'f1-score': 0.4158595286564288, 'support': 314770}, 'weighted avg': {'precision': 0.4193637491937602, 'recall': 0.4223560059726149, 'f1-score': 0.41499010055065905, 'support': 314770}}
[[55618 23516 25584]
 [41165 29594 36356]
 [34052 21152 47733]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0610756
{'0': {'precision': 0.38223900644332404, 'recall': 0.581342333540575, 'f1-score': 0.46122046319349835, 'support': 33777}, '1': {'precision': 0.44133089493245237, 'recall': 0.3201181026551702, 'f1-score': 0.3710767475601741, 'support': 46739}, '2': {'precision': 0.40886332161499944, 'recall': 0.3497782368309132, 'f1-score': 0.3770199250151443, 'support': 32918}, 'accuracy': 0.40650951213921754, 'macro avg': {'precision': 0.41081107433025865, 'recall': 0.4170795576755528, 'f1-score': 0.4031057119229389, 'support': 113434}, 'weighted avg': {'precision': 0.41431329618814994, 'recall': 0.40650951213921754, 'f1-score': 0.3996433307575356, 'support': 113434}}
[[19636  9701  4440]
 [19570 14962 12207]
 [12165  9239 11514]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
7633/7633 - 49s - 49s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094205
{'0': {'precision': 0.4143310830233884, 'recall': 0.6378864500069481, 'f1-score': 0.5023603492258162, 'support': 662052}, '1': {'precision': 0.3556957308834433, 'recall': 0.1506860017379242, 'f1-score': 0.21169155231810624, 'support': 627185}, '2': {'precision': 0.44262669986936154, 'recall': 0.44547055965316334, 'f1-score': 0.44404407646578536, 'support': 664751}, 'accuracy': 0.4160460555540771, 'macro avg': {'precision': 0.4042178379253977, 'recall': 0.4113476704660119, 'f1-score': 0.38603199266990257, 'support': 1953988}, 'weighted avg': {'precision': 0.40513672065375567, 'recall': 0.4160460555540771, 'f1-score': 0.38922305768560955, 'support': 1953988}}
[[422314  85571 154167]
 [313949  94508 218728]
 [283004  85620 296127]]
Evaluating performance on  train set...
1586/1586 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0818846
{'0': {'precision': 0.4075483681160368, 'recall': 0.6568966166120959, 'f1-score': 0.5030173432393643, 'support': 132855}, '1': {'precision': 0.4031836110440312, 'recall': 0.1475472615198804, 'f1-score': 0.2160352384906108, 'support': 135787}, '2': {'precision': 0.44597497165473, 'recall': 0.46161471848849756, 'f1-score': 0.45366009162317733, 'support': 137188}, 'accuracy': 0.42045930562058004, 'macro avg': {'precision': 0.41890231693826596, 'recall': 0.4220195322068246, 'f1-score': 0.39090422445105083, 'support': 405830}, 'weighted avg': {'precision': 0.41907780560890284, 'recall': 0.42045930562058004, 'f1-score': 0.39031088562844235, 'support': 405830}}
[[87272 14500 31083]
 [68164 20035 47588]
 [58703 15157 63328]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764289
{'0': {'precision': 0.3752757990291874, 'recall': 0.6620770958916298, 'f1-score': 0.4790298699626625, 'support': 44957}, '1': {'precision': 0.4890710382513661, 'recall': 0.15339593399580637, 'f1-score': 0.2335419934209613, 'support': 54845}, '2': {'precision': 0.43395289725564956, 'recall': 0.46423639878486606, 'f1-score': 0.4485841262021328, 'support': 47073}, 'accuracy': 0.40872170212765957, 'macro avg': {'precision': 0.4327665781787344, 'recall': 0.4265698095574341, 'f1-score': 0.3870519965285855, 'support': 146875}, 'weighted avg': {'precision': 0.43657422925866585, 'recall': 0.40872170212765957, 'f1-score': 0.3776037927884054, 'support': 146875}}
[[29765  4458 10734]
 [28661  8413 17771]
 [20889  4331 21853]]
testing model on single stock: results/universal/W10/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
22048/22048 - 147s - 147s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1458663
{'0': {'precision': 0.39892786220015936, 'recall': 0.4163539274838803, 'f1-score': 0.4074546599995918, 'support': 2133567}, '1': {'precision': 0.2231308526640134, 'recall': 0.35981502697207196, 'f1-score': 0.27544867053429833, 'support': 1318030}, '2': {'precision': 0.4221650446132422, 'recall': 0.24875448751659657, 'f1-score': 0.3130493130429991, 'support': 2192471}, 'accuracy': 0.3380457145448992, 'macro avg': {'precision': 0.34807458649247164, 'recall': 0.34164114732418294, 'f1-score': 0.3319842145256297, 'support': 5644068}, 'weighted avg': {'precision': 0.3669015145522337, 'recall': 0.3380457145448992, 'f1-score': 0.33995567881399863, 'support': 5644068}}
[[888319 817450 427798]
 [525087 474247 318696]
 [813360 833724 545387]]
Evaluating performance on  train set...
5429/5429 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1049136
{'0': {'precision': 0.34921531955548635, 'recall': 0.7157959614548205, 'f1-score': 0.46941646510794593, 'support': 457541}, '1': {'precision': 0.33018455075145664, 'recall': 0.1149031432748538, 'f1-score': 0.17047985487504924, 'support': 459648}, '2': {'precision': 0.39064265802757475, 'recall': 0.24136333147837422, 'f1-score': 0.2983731639404509, 'support': 472607}, 'accuracy': 0.3557291861539391, 'macro avg': {'precision': 0.35668084277817264, 'recall': 0.3573541454026829, 'f1-score': 0.3127564946411487, 'support': 1389796}, 'weighted avg': {'precision': 0.35700883409578116, 'recall': 0.3557291861539391, 'f1-score': 0.3123848745326408, 'support': 1389796}}
[[327506  49147  80888]
 [309785  52815  97048]
 [300543  57994 114070]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.099659
{'0': {'precision': 0.3407241313378874, 'recall': 0.6345396866502654, 'f1-score': 0.4433733304683171, 'support': 154460}, '1': {'precision': 0.3414811305858203, 'recall': 0.12898415879377803, 'f1-score': 0.18724295869156776, 'support': 167664}, '2': {'precision': 0.39221597503806094, 'recall': 0.32214333025881653, 'f1-score': 0.35374288384739566, 'support': 161543}, 'accuracy': 0.3549487560656402, 'macro avg': {'precision': 0.3581404123205896, 'recall': 0.36188905856762, 'f1-score': 0.32811972433576014, 'support': 483667}, 'weighted avg': {'precision': 0.35818463294077235, 'recall': 0.3549487560656402, 'f1-score': 0.3246490555186918, 'support': 483667}}
[[ 98011  19326  37123]
 [102519  21626  43519]
 [ 87125  22378  52040]]
training model: results/universal/W10/deepLOB_L1/h100
Epoch 1/50
8543/8543 - 136s - loss: 3.1883 - accuracy100: 0.4140 - val_loss: 3.3133 - val_accuracy100: 0.3444 - 136s/epoch - 16ms/step
Epoch 2/50
8543/8543 - 129s - loss: 3.1696 - accuracy100: 0.4222 - val_loss: 3.3528 - val_accuracy100: 0.3813 - 129s/epoch - 15ms/step
Epoch 3/50
8543/8543 - 132s - loss: 3.1543 - accuracy100: 0.4290 - val_loss: 3.5172 - val_accuracy100: 0.3918 - 132s/epoch - 15ms/step
Epoch 4/50
8543/8543 - 128s - loss: 3.1416 - accuracy100: 0.4339 - val_loss: 3.5539 - val_accuracy100: 0.3830 - 128s/epoch - 15ms/step
Epoch 5/50
8543/8543 - 130s - loss: 3.1341 - accuracy100: 0.4367 - val_loss: 3.5802 - val_accuracy100: 0.3879 - 130s/epoch - 15ms/step
Epoch 6/50
8543/8543 - 128s - loss: 3.1266 - accuracy100: 0.4396 - val_loss: 3.6027 - val_accuracy100: 0.3893 - 128s/epoch - 15ms/step
Epoch 7/50
8543/8543 - 131s - loss: 3.1227 - accuracy100: 0.4412 - val_loss: 3.5526 - val_accuracy100: 0.3882 - 131s/epoch - 15ms/step
Epoch 8/50
8543/8543 - 130s - loss: 3.1175 - accuracy100: 0.4429 - val_loss: 3.5878 - val_accuracy100: 0.3905 - 130s/epoch - 15ms/step
Epoch 9/50
8543/8543 - 133s - loss: 3.1136 - accuracy100: 0.4439 - val_loss: 3.5070 - val_accuracy100: 0.3851 - 133s/epoch - 16ms/step
Epoch 10/50
8543/8543 - 133s - loss: 3.1107 - accuracy100: 0.4450 - val_loss: 3.5605 - val_accuracy100: 0.3815 - 133s/epoch - 16ms/step
Epoch 11/50
8543/8543 - 131s - loss: 3.1075 - accuracy100: 0.4461 - val_loss: 3.6511 - val_accuracy100: 0.3840 - 131s/epoch - 15ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 237s - 237s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1082165
{'0': {'precision': 0.37899469743381725, 'recall': 0.4353600140750475, 'f1-score': 0.4052267015277382, 'support': 3330717}, '1': {'precision': 0.2923868544648903, 'recall': 0.3221124271281226, 'f1-score': 0.3065306735848065, 'support': 2843175}, '2': {'precision': 0.39135671709870196, 'recall': 0.3003013299867384, 'f1-score': 0.33983539449651223, 'support': 3371387}, 'accuracy': 0.35392522313910363, 'macro avg': {'precision': 0.35424608966580323, 'recall': 0.3525912570633028, 'f1-score': 0.350530923203019, 'support': 9545279}, 'weighted avg': {'precision': 0.3575637783856425, 'recall': 0.35392522313910363, 'f1-score': 0.3527327428194879, 'support': 9545279}}
[[1450061 1136065  744591]
 [1097396  915822  829957]
 [1278615 1080340 1012432]]
Evaluating performance on  train set...
8543/8543 - 49s - 49s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1133057
{'0': {'precision': 0.33357833929958175, 'recall': 0.5932578961250511, 'f1-score': 0.42703980746952724, 'support': 690022}, '1': {'precision': 0.36546631806854857, 'recall': 0.31458352955951147, 'f1-score': 0.33812134411653744, 'support': 796275}, '2': {'precision': 0.3702736322945204, 'recall': 0.14491528690519873, 'f1-score': 0.20830537171002, 'support': 700423}, 'accuracy': 0.3481735201580449, 'macro avg': {'precision': 0.35643942988755023, 'recall': 0.35091890419658717, 'f1-score': 0.32448884109869486, 'support': 2186720}, 'weighted avg': {'precision': 0.3569438490583314, 'recall': 0.3481735201580449, 'f1-score': 0.32459862656644717, 'support': 2186720}}
[[409361 217671  62990]
 [436145 250495 109635]
 [381675 217246 101502]]
Evaluating performance on  val set...
3077/3077 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062429
{'0': {'precision': 0.31231071699381124, 'recall': 0.5838964346349745, 'f1-score': 0.4069530438795524, 'support': 235600}, '1': {'precision': 0.38899012756072654, 'recall': 0.31525697703858063, 'f1-score': 0.3482637015097702, 'support': 308082}, '2': {'precision': 0.37211200661293653, 'recall': 0.14804263733191922, 'f1-score': 0.2118156339970768, 'support': 243261}, 'accuracy': 0.3439944189096288, 'macro avg': {'precision': 0.35780428372249146, 'recall': 0.34906534966849145, 'f1-score': 0.3223441264621331, 'support': 786943}, 'weighted avg': {'precision': 0.360815967920898, 'recall': 0.3439944189096288, 'f1-score': 0.32365545886845487, 'support': 786943}}
[[137566  75197  22837]
 [173027  97125  37930]
 [129885  77363  36013]]
testing model out of sample: results/universal/W10/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 120s - 120s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898006
{'0': {'precision': 0.3856870156260538, 'recall': 0.441456620238295, 'f1-score': 0.41169170384814624, 'support': 1787700}, '1': {'precision': 0.3590526383056198, 'recall': 0.31641833864168245, 'f1-score': 0.33638999505508177, 'support': 1882255}, '2': {'precision': 0.39796007283094714, 'recall': 0.39018306452153284, 'f1-score': 0.3940331988323764, 'support': 1790844}, 'accuracy': 0.38154288410908366, 'macro avg': {'precision': 0.38089990892087355, 'recall': 0.38268600780050344, 'f1-score': 0.38070496591186814, 'support': 5460799}, 'weighted avg': {'precision': 0.3805314405854355, 'recall': 0.38154288410908366, 'f1-score': 0.37994531551912136, 'support': 5460799}}
[[789192 560032 438476]
 [668061 595580 618614]
 [588945 503142 698757]]
Evaluating performance on  train set...
4055/4055 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0911406
{'0': {'precision': 0.367138555860338, 'recall': 0.46537311649810903, 'f1-score': 0.41046010428494384, 'support': 318091}, '1': {'precision': 0.3996551944320286, 'recall': 0.31381062564081996, 'f1-score': 0.3515684790408399, 'support': 398903}, '2': {'precision': 0.37330638077855094, 'recall': 0.3739726540316894, 'f1-score': 0.3736392203808313, 'support': 320486}, 'accuracy': 0.37886417087558316, 'macro avg': {'precision': 0.3800333770236392, 'recall': 0.3843854653902061, 'f1-score': 0.37855593456887165, 'support': 1037480}, 'weighted avg': {'precision': 0.38154624199684334, 'recall': 0.37886417087558316, 'f1-score': 0.37644246174374574, 'support': 1037480}}
[[148031  98268  71792]
 [144310 125180 129413]
 [110861  89772 119853]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099417
{'0': {'precision': 0.3447508896797153, 'recall': 0.39178717938093066, 'f1-score': 0.3667671348717769, 'support': 120665}, '1': {'precision': 0.37821043622269696, 'recall': 0.36584101770209326, 'f1-score': 0.371922909802553, 'support': 148570}, '2': {'precision': 0.37089053705749303, 'recall': 0.33664359035569347, 'f1-score': 0.35293823205526076, 'support': 125670}, 'accuracy': 0.3644775325711247, 'macro avg': {'precision': 0.36461728765330176, 'recall': 0.36475726247957246, 'f1-score': 0.3638760922431969, 'support': 394905}, 'weighted avg': {'precision': 0.365657321140082, 'recall': 0.3644775325711247, 'f1-score': 0.36430607528659514, 'support': 394905}}
[[47275 46290 27100]
 [49557 54353 44660]
 [40296 43068 42306]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1108686
{'0': {'precision': 0.4601045160283909, 'recall': 0.21343415887258715, 'f1-score': 0.2916002422175262, 'support': 55277}, '1': {'precision': 0.20888597640891218, 'recall': 0.29039428613074847, 'f1-score': 0.2429869496280034, 'support': 27442}, '2': {'precision': 0.4121014850765788, 'recall': 0.5684391974504419, 'f1-score': 0.4778070744425444, 'support': 49891}, 'accuracy': 0.36292134831460676, 'macro avg': {'precision': 0.3603639925046273, 'recall': 0.3574225474845925, 'f1-score': 0.337464755429358, 'support': 132610}, 'weighted avg': {'precision': 0.3900580762315838, 'recall': 0.36292134831460676, 'f1-score': 0.3515957108194167, 'support': 132610}}
[[11798 17195 26284]
 [ 5299  7969 14174]
 [ 8545 12986 28360]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1039873
{'0': {'precision': 0.3606073040623718, 'recall': 0.38425885439440316, 'f1-score': 0.3720575783234547, 'support': 11435}, '1': {'precision': 0.3222872674053941, 'recall': 0.27275944439529326, 'f1-score': 0.29546216876707077, 'support': 11303}, '2': {'precision': 0.38705058860960867, 'recall': 0.42002589555459646, 'f1-score': 0.4028645941135075, 'support': 11585}, 'accuracy': 0.3596130874340821, 'macro avg': {'precision': 0.3566483866924582, 'recall': 0.35901473144809765, 'f1-score': 0.35679478040134427, 'support': 34323}, 'weighted avg': {'precision': 0.35691339843483105, 'recall': 0.3596130874340821, 'f1-score': 0.35723199092468283, 'support': 34323}}
[[4394 3439 3602]
 [4116 3083 4104]
 [3675 3044 4866]]
Evaluating performance on  val set...
46/46 - 0s - 486ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1084363
{'0': {'precision': 0.4156010230179028, 'recall': 0.3735632183908046, 'f1-score': 0.3934624697336561, 'support': 4350}, '1': {'precision': 0.28701260627381997, 'recall': 0.2959492140266022, 'f1-score': 0.2914124125613931, 'support': 3308}, '2': {'precision': 0.3861499656042192, 'recall': 0.41848906560636184, 'f1-score': 0.4016696481812761, 'support': 4024}, 'accuracy': 0.36706043485704504, 'macro avg': {'precision': 0.36292119829864733, 'recall': 0.36266716600792287, 'f1-score': 0.3621815101587751, 'support': 11682}, 'weighted avg': {'precision': 0.36904379500710943, 'recall': 0.36706043485704504, 'f1-score': 0.3673919421653782, 'support': 11682}}
[[1625 1268 1457]
 [1109  979 1220]
 [1176 1164 1684]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
1840/1840 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.064499
{'0': {'precision': 0.35713882282063675, 'recall': 0.47382706798218227, 'f1-score': 0.40728998182156506, 'support': 120105}, '1': {'precision': 0.5079738797443373, 'recall': 0.3203011064439224, 'f1-score': 0.39287579231504616, 'support': 229022}, '2': {'precision': 0.33912840662396615, 'recall': 0.46541365725541695, 'f1-score': 0.39235982577469025, 'support': 121840}, 'accuracy': 0.3969938445793442, 'macro avg': {'precision': 0.4014137030629801, 'recall': 0.4198472772271738, 'f1-score': 0.3975085333037672, 'support': 470967}, 'weighted avg': {'precision': 0.42582762118098344, 'recall': 0.3969938445793442, 'f1-score': 0.396418186723579, 'support': 470967}}
[[56909 37883 25313]
 [70474 73356 85192]
 [31964 33170 56706]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0656976
{'0': {'precision': 0.2560457351006779, 'recall': 0.5831540943309265, 'f1-score': 0.3558487824313873, 'support': 26036}, '1': {'precision': 0.6277564948652739, 'recall': 0.23453850039691132, 'f1-score': 0.3414911781445646, 'support': 83142}, '2': {'precision': 0.2729573712255773, 'recall': 0.4688250772222858, 'f1-score': 0.34503178367455767, 'support': 26223}, 'accuracy': 0.34694721604714884, 'macro avg': {'precision': 0.3855865337305097, 'recall': 0.4288392239833745, 'f1-score': 0.34745724808350315, 'support': 135401}, 'weighted avg': {'precision': 0.4875672882830862, 'recall': 0.34694721604714884, 'f1-score': 0.3449376806373432, 'support': 135401}}
[[15183  6149  4704]
 [35600 19500 28042]
 [ 8515  5414 12294]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.066804
{'0': {'precision': 0.28425938755715674, 'recall': 0.6640233047418677, 'f1-score': 0.3980982874884782, 'support': 12358}, '1': {'precision': 0.5807631991636174, 'recall': 0.3168062733915523, 'f1-score': 0.40997255471759037, 'support': 28055}, '2': {'precision': 0.38002244668911334, 'recall': 0.2672665561607072, 'f1-score': 0.31382362482042725, 'support': 12669}, 'accuracy': 0.38581816811725256, 'macro avg': {'precision': 0.41501501113662914, 'recall': 0.41603204476470906, 'f1-score': 0.37396482234216527, 'support': 53082}, 'weighted avg': {'precision': 0.4638237715434801, 'recall': 0.38581816811725256, 'f1-score': 0.38426039264222533, 'support': 53082}}
[[ 8206  2920  1232]
 [14875  8888  4292]
 [ 5787  3496  3386]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1190073
{'0': {'precision': 0.3874639887096586, 'recall': 0.3622011186584821, 'f1-score': 0.374406888545764, 'support': 91717}, '1': {'precision': 0.2911577084853094, 'recall': 0.25861284585797595, 'f1-score': 0.27392199523969457, 'support': 72537}, '2': {'precision': 0.34599940435233584, 'recall': 0.4045266254427568, 'f1-score': 0.37298099170808935, 'support': 83285}, 'accuracy': 0.346086879239231, 'macro avg': {'precision': 0.34154036718243463, 'recall': 0.34178019665307163, 'f1-score': 0.34043662516451595, 'support': 247539}, 'weighted avg': {'precision': 0.3452922640245252, 'recall': 0.346086879239231, 'f1-score': 0.34448179179790567, 'support': 247539}}
[[33220 24364 34133]
 [24229 18759 29549]
 [28288 21306 33691]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1309949
{'0': {'precision': 0.33860529377545084, 'recall': 0.5087403037255545, 'f1-score': 0.40659244706395986, 'support': 18306}, '1': {'precision': 0.3265597147950089, 'recall': 0.2994116365221181, 'f1-score': 0.31239697607002787, 'support': 18356}, '2': {'precision': 0.37599530634481604, 'recall': 0.22884252410345354, 'f1-score': 0.2845182977104078, 'support': 19603}, 'accuracy': 0.342930774015818, 'macro avg': {'precision': 0.3470534383050919, 'recall': 0.3456648214503754, 'f1-score': 0.33450257361479857, 'support': 56265}, 'weighted avg': {'precision': 0.3477023837715812, 'recall': 0.342930774015818, 'f1-score': 0.33333071036543865, 'support': 56265}}
[[9313 5595 3398]
 [8813 5496 4047]
 [9378 5739 4486]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.122456
{'0': {'precision': 0.349036850921273, 'recall': 0.4850865706387313, 'f1-score': 0.4059665144596651, 'support': 6873}, '1': {'precision': 0.3235076010381906, 'recall': 0.2712997512437811, 'f1-score': 0.29511246406223574, 'support': 6432}, '2': {'precision': 0.356256157635468, 'recall': 0.2692078618225134, 'f1-score': 0.3066745823085404, 'support': 6716}, 'accuracy': 0.34398881174766494, 'macro avg': {'precision': 0.3429335365316439, 'recall': 0.34186472790167527, 'f1-score': 0.3359178536101471, 'support': 20021}, 'weighted avg': {'precision': 0.3432569562429127, 'recall': 0.34398881174766494, 'f1-score': 0.3370459875887186, 'support': 20021}}
[[3334 1879 1660]
 [3080 1745 1607]
 [3138 1770 1808]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1588/1588 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1243823
{'0': {'precision': 0.38000874337056934, 'recall': 0.4497477687233217, 'f1-score': 0.4119475579528271, 'support': 146889}, '1': {'precision': 0.28119947613241203, 'recall': 0.2711532264385936, 'f1-score': 0.27608499015660753, 'support': 114817}, '2': {'precision': 0.36768946395563773, 'recall': 0.3095656384008853, 'f1-score': 0.3361333808978427, 'support': 144580}, 'accuracy': 0.34939180774134476, 'macro avg': {'precision': 0.3429658944862064, 'recall': 0.34348887785426685, 'f1-score': 0.3413886430024258, 'support': 406286}, 'weighted avg': {'precision': 0.347701193875154, 'recall': 0.34939180774134476, 'f1-score': 0.3465735451508398, 'support': 406286}}
[[66063 40247 40579]
 [47295 31133 36389]
 [60488 39335 44757]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1269413
{'0': {'precision': 0.34845655531733405, 'recall': 0.5873324266563047, 'f1-score': 0.4374059497627041, 'support': 25735}, '1': {'precision': 0.3268902500251029, 'recall': 0.2618750754132647, 'f1-score': 0.2907929702329113, 'support': 24863}, '2': {'precision': 0.36236162361623614, 'recall': 0.17752691627832234, 'f1-score': 0.23830452719281686, 'support': 24892}, 'accuracy': 0.3450125844482713, 'macro avg': {'precision': 0.34590280965289105, 'recall': 0.3422448061159639, 'f1-score': 0.3221678157294774, 'support': 75490}, 'weighted avg': {'precision': 0.34593863124282787, 'recall': 0.3450125844482713, 'f1-score': 0.32346673767290585, 'support': 75490}}
[[15115  6855  3765]
 [14341  6511  4011]
 [13921  6552  4419]]
Evaluating performance on  val set...
131/131 - 1s - 838ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1179174
{'0': {'precision': 0.34526836643529657, 'recall': 0.4593581420864954, 'f1-score': 0.3942247332077841, 'support': 10937}, '1': {'precision': 0.39001135073779797, 'recall': 0.2936250213638694, 'f1-score': 0.33502340093603744, 'support': 11702}, '2': {'precision': 0.3348343840688482, 'recall': 0.31227251516565563, 'f1-score': 0.32316013135020283, 'support': 10715}, 'accuracy': 0.3539605444624333, 'macro avg': {'precision': 0.3567047004139809, 'recall': 0.3550852262053401, 'f1-score': 0.3508027551646748, 'support': 33354}, 'weighted avg': {'precision': 0.3576141804681375, 'recall': 0.3539605444624333, 'f1-score': 0.3506248291738463, 'support': 33354}}
[[5024 2749 3164]
 [4783 3436 3483]
 [4744 2625 3346]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
2104/2104 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143506
{'0': {'precision': 0.41298008160535943, 'recall': 0.32012209754365084, 'f1-score': 0.3606701868509492, 'support': 208358}, '1': {'precision': 0.22311576838200453, 'recall': 0.26619071078411577, 'f1-score': 0.24275723907831792, 'support': 123821}, '2': {'precision': 0.4086845800301754, 'recall': 0.45411906077080366, 'f1-score': 0.4302055505063024, 'support': 206382}, 'accuracy': 0.3590716743321555, 'macro avg': {'precision': 0.3482601433391797, 'recall': 0.34681062303285676, 'f1-score': 0.3445443254785232, 'support': 538561}, 'weighted avg': {'precision': 0.36768214259061704, 'recall': 0.3590716743321555, 'f1-score': 0.36020737635365013, 'support': 538561}}
[[66700 59186 82472]
 [37729 32960 53132]
 [57080 55580 93722]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1087879
{'0': {'precision': 0.3664481146429856, 'recall': 0.36438160211267606, 'f1-score': 0.3654119367163685, 'support': 36352}, '1': {'precision': 0.3283065953654189, 'recall': 0.25237051246916964, 'f1-score': 0.2853734118376201, 'support': 36490}, '2': {'precision': 0.36315870808221296, 'recall': 0.4488158899923606, 'f1-score': 0.40146920645767487, 'support': 36652}, 'accuracy': 0.355316273037792, 'macro avg': {'precision': 0.3526378060302058, 'recall': 0.3551893348580688, 'f1-score': 0.3507515183372212, 'support': 109494}, 'weighted avg': {'precision': 0.35263596632706096, 'recall': 0.355316273037792, 'f1-score': 0.3508080796806664, 'support': 109494}}
[[13246  9598 13508]
 [11942  9209 15339]
 [10959  9243 16450]]
Evaluating performance on  val set...
141/141 - 1s - 888ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1088188
{'0': {'precision': 0.36618176130142344, 'recall': 0.3866545544636221, 'f1-score': 0.3761397871058446, 'support': 12109}, '1': {'precision': 0.30278324430700027, 'recall': 0.28676666370817433, 'f1-score': 0.2945573890053788, 'support': 11267}, '2': {'precision': 0.3798169556840077, 'recall': 0.37736300550370905, 'f1-score': 0.37858600408114274, 'support': 12537}, 'accuracy': 0.35207306546375966, 'macro avg': {'precision': 0.34959398709747713, 'recall': 0.35026140789183513, 'f1-score': 0.3497610600641221, 'support': 35913}, 'weighted avg': {'precision': 0.351051678629363, 'recall': 0.35207306546375966, 'f1-score': 0.35139886718329194, 'support': 35913}}
[[4682 3731 3696]
 [4007 3231 4029]
 [4097 3709 4731]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
5267/5267 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.062074
{'0': {'precision': 0.40033158530832613, 'recall': 0.5713952225441267, 'f1-score': 0.4708063077609918, 'support': 406953}, '1': {'precision': 0.41014470354127625, 'recall': 0.24280322525304512, 'f1-score': 0.3050303169631311, 'support': 524610}, '2': {'precision': 0.42181414563342723, 'recall': 0.4624651365973319, 'f1-score': 0.44120526263362964, 'support': 416626}, 'accuracy': 0.4098705745262719, 'macro avg': {'precision': 0.4107634781610099, 'recall': 0.4255545281315012, 'f1-score': 0.4056806291192508, 'support': 1348189}, 'weighted avg': {'precision': 0.4107887638895143, 'recall': 0.4098705745262719, 'f1-score': 0.39715171811540195, 'support': 1348189}}
[[232531  94690  79732]
 [212863 127377 184370]
 [135452  88499 192675]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0696956
{'0': {'precision': 0.3152502198264327, 'recall': 0.6955128205128205, 'f1-score': 0.43385157709204747, 'support': 71136}, '1': {'precision': 0.5039530155861758, 'recall': 0.2784355938284894, 'f1-score': 0.3586924847011064, 'support': 128202}, '2': {'precision': 0.43171836556370574, 'recall': 0.2610358011817866, 'f1-score': 0.32535047741175244, 'support': 71925}, 'accuracy': 0.383196381371584, 'macro avg': {'precision': 0.41697386699210476, 'recall': 0.4116614051743655, 'f1-score': 0.37263151306830206, 'support': 271263}, 'weighted avg': {'precision': 0.4353146856921938, 'recall': 0.383196381371584, 'f1-score': 0.3695616165843164, 'support': 271263}}
[[49476 16452  5208]
 [73000 35696 19506]
 [34466 18684 18775]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.076267
{'0': {'precision': 0.29177904602959365, 'recall': 0.7665296535525543, 'f1-score': 0.4226692857297041, 'support': 25545}, '1': {'precision': 0.5518577615682699, 'recall': 0.23638884549289174, 'f1-score': 0.330995447274517, 'support': 51208}, '2': {'precision': 0.41477510096086895, 'recall': 0.22350204479795896, 'f1-score': 0.2904790930147507, 'support': 26653}, 'accuracy': 0.3640311007098234, 'macro avg': {'precision': 0.41947063618624414, 'recall': 0.4088068479478017, 'f1-score': 0.348047942006324, 'support': 103406}, 'weighted avg': {'precision': 0.45227577462742946, 'recall': 0.3640311007098234, 'f1-score': 0.3431990506752114, 'support': 103406}}
[[19581  4385  1579]
 [32277 12105  6826]
 [15251  5445  5957]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
10110/10110 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.073262
{'0': {'precision': 0.39028500681622147, 'recall': 0.4396825356128278, 'f1-score': 0.4135137644212047, 'support': 780056}, '1': {'precision': 0.409327529158519, 'recall': 0.3785458336946838, 'f1-score': 0.39333537110168004, 'support': 1014712}, '2': {'precision': 0.3961759479057218, 'recall': 0.3849783130160979, 'f1-score': 0.39049687292831103, 'support': 793333}, 'accuracy': 0.39894424522072364, 'macro avg': {'precision': 0.3985961612934874, 'recall': 0.4010688941078699, 'f1-score': 0.39911533615039857, 'support': 2588101}, 'weighted avg': {'precision': 0.3995567291710886, 'recall': 0.39894424522072364, 'f1-score': 0.3985470697594533, 'support': 2588101}}
[[342977 293407 143672]
 [308775 384115 321822]
 [227034 260883 305416]]
Evaluating performance on  train set...
1686/1686 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0709176
{'0': {'precision': 0.360311865854961, 'recall': 0.429192994359866, 'f1-score': 0.3917476291852139, 'support': 117905}, '1': {'precision': 0.4684163057921225, 'recall': 0.3454198376394255, 'f1-score': 0.39762373691623476, 'support': 196969}, '2': {'precision': 0.3555260018920438, 'recall': 0.4444273056026874, 'f1-score': 0.39503671429877213, 'support': 116694}, 'accuracy': 0.39507794831868903, 'macro avg': {'precision': 0.39475139117970914, 'recall': 0.40634671253399296, 'f1-score': 0.3948026934667403, 'support': 431568}, 'weighted avg': {'precision': 0.40835699853554464, 'recall': 0.39507794831868903, 'f1-score': 0.395318856806152, 'support': 431568}}
[[50604 42279 25022]
 [59942 68037 68990]
 [29899 34933 51862]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0881587
{'0': {'precision': 0.33838664545681046, 'recall': 0.3360999010127161, 'f1-score': 0.3372393968044772, 'support': 52532}, '1': {'precision': 0.3963309713170837, 'recall': 0.40318112276542667, 'f1-score': 0.39972670128450394, 'support': 72553}, '2': {'precision': 0.3694653683630351, 'recall': 0.3634621988468976, 'f1-score': 0.3664391986078591, 'support': 55329}, 'accuracy': 0.37146784617601736, 'macro avg': {'precision': 0.3680609950456431, 'recall': 0.3675810742083468, 'f1-score': 0.36780176556561345, 'support': 180414}, 'weighted avg': {'precision': 0.37121995846920924, 'recall': 0.37146784617601736, 'f1-score': 0.3713234326105605, 'support': 180414}}
[[17656 23748 11128]
 [20109 29252 23192]
 [14412 20807 20110]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
6546/6546 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0872886
{'0': {'precision': 0.38175908131065084, 'recall': 0.26105062013267955, 'f1-score': 0.31007137787018374, 'support': 554720}, '1': {'precision': 0.3499230577521787, 'recall': 0.3072509074488963, 'f1-score': 0.32720157134877803, 'support': 575790}, '2': {'precision': 0.382326090694828, 'recall': 0.5545456379445365, 'f1-score': 0.45260681774466727, 'support': 545259}, 'accuracy': 0.3724218552795761, 'macro avg': {'precision': 0.3713360765858858, 'recall': 0.37428238850870416, 'f1-score': 0.36329325565454296, 'support': 1675769}, 'weighted avg': {'precision': 0.371004796540539, 'recall': 0.3724218552795761, 'f1-score': 0.36233521943400354, 'support': 1675769}}
[[144810 184748 225162]
 [135539 176912 263339]
 [ 98974 143914 302371]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987015
{'0': {'precision': 0.3929206444730147, 'recall': 0.3996809378941901, 'f1-score': 0.39627196108273144, 'support': 107816}, '1': {'precision': 0.3244884740759617, 'recall': 0.3010184984535372, 'f1-score': 0.31231317162405914, 'support': 101522}, '2': {'precision': 0.3885953840605842, 'recall': 0.408822748311708, 'f1-score': 0.3984525218162993, 'support': 105432}, 'accuracy': 0.37092162531372114, 'macro avg': {'precision': 0.3686681675365202, 'recall': 0.36984072821981173, 'f1-score': 0.3690125515076967, 'support': 314770}, 'weighted avg': {'precision': 0.36940064047373594, 'recall': 0.37092162531372114, 'f1-score': 0.369923314946944, 'support': 314770}}
[[43092 34921 29803]
 [32948 30560 38014]
 [33631 28698 43103]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973425
{'0': {'precision': 0.36081713587420167, 'recall': 0.4328667846868776, 'f1-score': 0.39357167108886737, 'support': 36152}, '1': {'precision': 0.364482683747693, 'recall': 0.3194034820664066, 'f1-score': 0.3404573572659974, 'support': 42044}, '2': {'precision': 0.36891537975255123, 'recall': 0.3477779669674783, 'f1-score': 0.35803497085761865, 'support': 35238}, 'accuracy': 0.36437928663363717, 'macro avg': {'precision': 0.364738399791482, 'recall': 0.36668274457358746, 'f1-score': 0.3640213330708278, 'support': 113434}, 'weighted avg': {'precision': 0.36469146114333045, 'recall': 0.36437928663363717, 'f1-score': 0.3628456061249457, 'support': 113434}}
[[15649 12912  7591]
 [15242 13429 13373]
 [12480 10503 12255]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
7633/7633 - 49s - 49s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0999423
{'0': {'precision': 0.37380787659252485, 'recall': 0.5127396932662059, 'f1-score': 0.4323877082311206, 'support': 652292}, '1': {'precision': 0.3222740437856717, 'recall': 0.23507362410154362, 'f1-score': 0.2718523169343835, 'support': 643743}, '2': {'precision': 0.40265829632305183, 'recall': 0.3608889996701892, 'f1-score': 0.3806311685771857, 'support': 657953}, 'accuracy': 0.3701307275172621, 'macro avg': {'precision': 0.3662467389004161, 'recall': 0.36956743901264627, 'f1-score': 0.36162373124756325, 'support': 1953988}, 'weighted avg': {'precision': 0.36654461606092353, 'recall': 0.3701307275172621, 'f1-score': 0.36207156251555794, 'support': 1953988}}
[[334456 165678 152158]
 [292321 151327 200095]
 [267950 152555 237448]]
Evaluating performance on  train set...
1586/1586 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017293
{'0': {'precision': 0.3761605431395436, 'recall': 0.5239199659937506, 'f1-score': 0.4379119800286107, 'support': 134093}, '1': {'precision': 0.34748938960314013, 'recall': 0.28882424420959607, 'f1-score': 0.31545249068957476, 'support': 135785}, '2': {'precision': 0.3986704707023342, 'recall': 0.31143344709897613, 'f1-score': 0.3496933782081725, 'support': 135952}, 'accuracy': 0.3740778158342163, 'macro avg': {'precision': 0.37410680114833933, 'recall': 0.3747258857674409, 'f1-score': 0.36768594964211926, 'support': 405830}, 'weighted avg': {'precision': 0.3741083466264124, 'recall': 0.3740778158342163, 'f1-score': 0.36738575694359177, 'support': 405830}}
[[70254 37198 26641]
 [59345 39218 37222]
 [57167 36445 42340]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1052895
{'0': {'precision': 0.34048339395587585, 'recall': 0.4471328764982925, 'f1-score': 0.38658754281854585, 'support': 44801}, '1': {'precision': 0.376594553525013, 'recall': 0.342392292310489, 'f1-score': 0.3586799207800122, 'support': 55010}, '2': {'precision': 0.37231440818365896, 'recall': 0.30082440931497534, 'f1-score': 0.33277314874663594, 'support': 47064}, 'accuracy': 0.3610212765957447, 'macro avg': {'precision': 0.36313078522151593, 'recall': 0.36344985937458557, 'f1-score': 0.35934687078173133, 'support': 146875}, 'weighted avg': {'precision': 0.364208124110869, 'recall': 0.3610212765957447, 'f1-score': 0.3588910735015068, 'support': 146875}}
[[20032 15621  9148]
 [21454 18835 14721]
 [17348 15558 14158]]
testing model on single stock: results/universal/W10/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
22048/22048 - 142s - 142s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1279384
{'0': {'precision': 0.37490428438683365, 'recall': 0.4516295996765063, 'f1-score': 0.40970582123565397, 'support': 2102050}, '1': {'precision': 0.2460476935257271, 'recall': 0.362550538409191, 'f1-score': 0.293148152857701, 'support': 1398936}, '2': {'precision': 0.3958128470374555, 'recall': 0.19402010749005405, 'f1-score': 0.2603979670470234, 'support': 2143082}, 'accuracy': 0.3317348408984442, 'macro avg': {'precision': 0.3389216083166721, 'recall': 0.3360667485252504, 'f1-score': 0.32108398038012614, 'support': 5644068}, 'weighted avg': {'precision': 0.3509050413709003, 'recall': 0.3317348408984442, 'f1-score': 0.32412292373331014, 'support': 5644068}}
[[949348 778802 373900]
 [630953 507185 260798]
 [951940 775341 415801]]
Evaluating performance on  train set...
5429/5429 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1286674
{'0': {'precision': 0.33483877205591983, 'recall': 0.6258232654545296, 'f1-score': 0.4362614229492571, 'support': 459299}, '1': {'precision': 0.3381925566826412, 'recall': 0.34565343498798373, 'f1-score': 0.34188229609753146, 'support': 458546}, '2': {'precision': 0.3651879855162623, 'recall': 0.04850927320844749, 'f1-score': 0.08564235507124394, 'support': 471951}, 'accuracy': 0.3373387173369329, 'macro avg': {'precision': 0.34607310475160774, 'recall': 0.3399953245503203, 'f1-score': 0.2879286913726775, 'support': 1389796}, 'weighted avg': {'precision': 0.34625138668948235, 'recall': 0.3373387173369329, 'f1-score': 0.28605794646389693, 'support': 1389796}}
[[287440 152329  19530]
 [279781 158498  20267]
 [291222 157835  22894]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1181883
{'0': {'precision': 0.3112812298911675, 'recall': 0.5909978221608414, 'f1-score': 0.4077818908171306, 'support': 150608}, '1': {'precision': 0.35620647886819695, 'recall': 0.3409834754645205, 'f1-score': 0.34842878154693807, 'support': 175073}, '2': {'precision': 0.36645426788795965, 'recall': 0.0698922689352221, 'f1-score': 0.11739440138636387, 'support': 157986}, 'accuracy': 0.330285092842803, 'macro avg': {'precision': 0.34464732554910804, 'recall': 0.3339578555201947, 'f1-score': 0.2912016912501442, 'support': 483667}, 'weighted avg': {'precision': 0.34556466393797386, 'recall': 0.330285092842803, 'f1-score': 0.2914450623701422, 'support': 483667}}
[[ 89009  52338   9261]
 [105547  59697   9829]
 [ 91388  55556  11042]]
training model: results/universal/W10/deepLOB_L1/h200
Epoch 1/50
8543/8543 - 139s - loss: 3.2408 - accuracy200: 0.3982 - val_loss: 3.3404 - val_accuracy200: 0.3355 - 139s/epoch - 16ms/step
Epoch 2/50
8543/8543 - 130s - loss: 3.2280 - accuracy200: 0.4051 - val_loss: 3.3448 - val_accuracy200: 0.3414 - 130s/epoch - 15ms/step
Epoch 3/50
8543/8543 - 133s - loss: 3.2213 - accuracy200: 0.4090 - val_loss: 3.3923 - val_accuracy200: 0.3548 - 133s/epoch - 16ms/step
Epoch 4/50
8543/8543 - 133s - loss: 3.2136 - accuracy200: 0.4130 - val_loss: 3.4017 - val_accuracy200: 0.3530 - 133s/epoch - 16ms/step
Epoch 5/50
8543/8543 - 131s - loss: 3.2062 - accuracy200: 0.4166 - val_loss: 3.4696 - val_accuracy200: 0.3519 - 131s/epoch - 15ms/step
Epoch 6/50
8543/8543 - 130s - loss: 3.2029 - accuracy200: 0.4183 - val_loss: 3.4869 - val_accuracy200: 0.3585 - 130s/epoch - 15ms/step
Epoch 7/50
8543/8543 - 132s - loss: 3.1989 - accuracy200: 0.4201 - val_loss: 3.5032 - val_accuracy200: 0.3590 - 132s/epoch - 15ms/step
Epoch 8/50
8543/8543 - 129s - loss: 3.1948 - accuracy200: 0.4221 - val_loss: 3.4922 - val_accuracy200: 0.3590 - 129s/epoch - 15ms/step
Epoch 9/50
8543/8543 - 131s - loss: 3.1922 - accuracy200: 0.4231 - val_loss: 3.5456 - val_accuracy200: 0.3588 - 131s/epoch - 15ms/step
Epoch 10/50
8543/8543 - 132s - loss: 3.1893 - accuracy200: 0.4245 - val_loss: 3.5649 - val_accuracy200: 0.3557 - 132s/epoch - 15ms/step
Epoch 11/50
8543/8543 - 134s - loss: 3.1855 - accuracy200: 0.4261 - val_loss: 3.6505 - val_accuracy200: 0.3558 - 134s/epoch - 16ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 241s - 241s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221445
{'0': {'precision': 0.37242188344042076, 'recall': 0.25452974622258306, 'f1-score': 0.3023915817262621, 'support': 3439983}, '1': {'precision': 0.2795230021876083, 'recall': 0.5473674738577176, 'f1-score': 0.37006545370869565, 'support': 2656042}, '2': {'precision': 0.38116637825888666, 'recall': 0.22025429266734198, 'f1-score': 0.27918405565505244, 'support': 3449254}, 'accuracy': 0.3236282564396494, 'macro avg': {'precision': 0.3443704212956386, 'recall': 0.3407171709158809, 'f1-score': 0.3172136970300034, 'support': 9545279}, 'weighted avg': {'precision': 0.3497319917536602, 'recall': 0.3236282564396494, 'f1-score': 0.312836116051214, 'support': 9545279}}
[[ 875578 1869819  694586]
 [ 663383 1453831  538828]
 [ 812077 1877464  759713]]
Evaluating performance on  train set...
8543/8543 - 56s - 56s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130747
{'0': {'precision': 0.33534621381733515, 'recall': 0.28695312217396024, 'f1-score': 0.30926802424049765, 'support': 718762}, '1': {'precision': 0.33989178655617075, 'recall': 0.4424643515962675, 'f1-score': 0.38445406539948507, 'support': 742670}, '2': {'precision': 0.3360407215881287, 'recall': 0.28025694620619673, 'f1-score': 0.3056242181485758, 'support': 725288}, 'accuracy': 0.3375480171215336, 'macro avg': {'precision': 0.33709290732054487, 'recall': 0.3365581399921415, 'f1-score': 0.3331154359295195, 'support': 2186720}, 'weighted avg': {'precision': 0.3371203681022982, 'recall': 0.3375480171215336, 'f1-score': 0.3335946908254959, 'support': 2186720}}
[[206251 318314 194197]
 [206641 328605 207424]
 [202147 319874 203267]]
Evaluating performance on  val set...
3077/3077 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1133566
{'0': {'precision': 0.3163969152931084, 'recall': 0.2925079508946274, 'f1-score': 0.3039838191512623, 'support': 247142}, '1': {'precision': 0.3589418617193399, 'recall': 0.42116161420852244, 'f1-score': 0.387570466107521, 'support': 284449}, '2': {'precision': 0.322493936494515, 'recall': 0.2837886525267082, 'f1-score': 0.3019058153510937, 'support': 255352}, 'accuracy': 0.33618190898197203, 'macro avg': {'precision': 0.3326109045023211, 'recall': 0.33248607254328605, 'f1-score': 0.33115336686995894, 'support': 786943}, 'weighted avg': {'precision': 0.33375364128700724, 'recall': 0.33618190898197203, 'f1-score': 0.33352282733060973, 'support': 786943}}
[[ 72291 105831  69020]
 [ 81431 119799  83219]
 [ 74760 108126  72466]]
testing model out of sample: results/universal/W10/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 134s - 134s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1237115
{'0': {'precision': 0.37393172703857064, 'recall': 0.292524155408766, 'f1-score': 0.3282559746665381, 'support': 1960327}, '1': {'precision': 0.2795072850680572, 'recall': 0.5780761040165397, 'f1-score': 0.37681812510117085, 'support': 1546331}, '2': {'precision': 0.37122496338111616, 'recall': 0.1385120111598907, 'f1-score': 0.20174764177927476, 'support': 1954141}, 'accuracy': 0.3182706413475391, 'macro avg': {'precision': 0.34155465849591465, 'recall': 0.3363707568617322, 'f1-score': 0.30227391384899455, 'support': 5460799}, 'weighted avg': {'precision': 0.34622500507040305, 'recall': 0.3182706413475391, 'f1-score': 0.2967364183721362, 'support': 5460799}}
[[ 573443 1136214  250670]
 [ 444644  893897  207790]
 [ 515463 1168006  270672]]
Evaluating performance on  train set...
4055/4055 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1120275
{'0': {'precision': 0.34896050455199495, 'recall': 0.30069322332915216, 'f1-score': 0.3230338083967814, 'support': 345199}, '1': {'precision': 0.3373294250460478, 'recall': 0.4890613648958683, 'f1-score': 0.39926579782950894, 'support': 348261}, '2': {'precision': 0.347425548022695, 'recall': 0.23744549735480494, 'f1-score': 0.2820951137725378, 'support': 344020}, 'accuracy': 0.34295215329452133, 'macro avg': {'precision': 0.3445718258735792, 'recall': 0.3424000285266085, 'f1-score': 0.3347982399996094, 'support': 1037480}, 'weighted avg': {'precision': 0.3445472077896184, 'recall': 0.34295215329452133, 'f1-score': 0.3350484006271847, 'support': 1037480}}
[[103799 165787  75613]
 [100121 170321  77819]
 [ 93532 168802  81686]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1126456
{'0': {'precision': 0.3513118103071447, 'recall': 0.3047192367510852, 'f1-score': 0.3263609769033787, 'support': 129237}, '1': {'precision': 0.334390643382777, 'recall': 0.4401378514604968, 'f1-score': 0.38004535741908424, 'support': 131736}, '2': {'precision': 0.35415676525426826, 'recall': 0.28931846011408774, 'f1-score': 0.31847097113551187, 'support': 133932}, 'accuracy': 0.3446702371456426, 'macro avg': {'precision': 0.3466197396480633, 'recall': 0.3447251827752232, 'f1-score': 0.3416257684859916, 'support': 394905}, 'weighted avg': {'precision': 0.34663195986217604, 'recall': 0.3446702371456426, 'f1-score': 0.3415936057612433, 'support': 394905}}
[[39381 55515 34341]
 [37432 57982 36322]
 [35284 59899 38749]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1411
{'0': {'precision': 0.4647887323943662, 'recall': 0.010796143409733849, 'f1-score': 0.021102125258604477, 'support': 51963}, '1': {'precision': 0.2810733259467599, 'recall': 0.5374127488524947, 'f1-score': 0.369101914808286, 'support': 36819}, '2': {'precision': 0.34262765347102697, 'recall': 0.47690973806698916, 'f1-score': 0.398767563648851, 'support': 43828}, 'accuracy': 0.3110625141392052, 'macro avg': {'precision': 0.36282990393738435, 'recall': 0.34170621010973923, 'f1-score': 0.26299053457191385, 'support': 132610}, 'weighted avg': {'precision': 0.3734057799997766, 'recall': 0.3110625141392052, 'f1-score': 0.2425433822165824, 'support': 132610}}
[[  561 28031 23371]
 [  300 19787 16732]
 [  346 22580 20902]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1227447
{'0': {'precision': 0.34699123072270943, 'recall': 0.19825501036627505, 'f1-score': 0.25233644859813087, 'support': 11576}, '1': {'precision': 0.31899641577060933, 'recall': 0.4658445706174592, 'f1-score': 0.3786824360869722, 'support': 11272}, '2': {'precision': 0.31845661450924606, 'recall': 0.312156862745098, 'f1-score': 0.31527527175108916, 'support': 11475}, 'accuracy': 0.3242140838504793, 'macro avg': {'precision': 0.3281480870008549, 'recall': 0.3254188145762774, 'f1-score': 0.31543138547873073, 'support': 34323}, 'weighted avg': {'precision': 0.3282576621188705, 'recall': 0.3242140838504793, 'f1-score': 0.3148716281178237, 'support': 34323}}
[[2295 5544 3737]
 [2092 5251 3929]
 [2227 5666 3582]]
Evaluating performance on  val set...
46/46 - 0s - 457ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1290104
{'0': {'precision': 0.3924731182795699, 'recall': 0.1831242873432155, 'f1-score': 0.2497278805784481, 'support': 4385}, '1': {'precision': 0.2746524064171123, 'recall': 0.3759882869692533, 'f1-score': 0.3174289245982695, 'support': 3415}, '2': {'precision': 0.3370288248337029, 'recall': 0.43070582174137045, 'f1-score': 0.37815221078819405, 'support': 3882}, 'accuracy': 0.32177709296353363, 'macro avg': {'precision': 0.33471811651012834, 'recall': 0.3299394653512797, 'f1-score': 0.3151030053216372, 'support': 11682}, 'weighted avg': {'precision': 0.3396061025145341, 'recall': 0.32177709296353363, 'f1-score': 0.312195122078356, 'support': 11682}}
[[ 803 1825 1757]
 [ 599 1284 1532]
 [ 644 1566 1672]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
1840/1840 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022598
{'0': {'precision': 0.37172278463541825, 'recall': 0.40323788073089917, 'f1-score': 0.3868395251387926, 'support': 153619}, '1': {'precision': 0.35717964078149467, 'recall': 0.4288400146370393, 'f1-score': 0.38974323688948526, 'support': 158502}, '2': {'precision': 0.3587728683938187, 'recall': 0.25753245281593495, 'f1-score': 0.2998372839614759, 'support': 158846}, 'accuracy': 0.3627111878326932, 'macro avg': {'precision': 0.3625584312702439, 'recall': 0.3632034493946244, 'f1-score': 0.35880668199658466, 'support': 470967}, 'weighted avg': {'precision': 0.3624606499583651, 'recall': 0.3627111878326932, 'f1-score': 0.3584729646745908, 'support': 470967}}
[[61945 57505 34169]
 [51585 67972 38945]
 [53113 64825 40908]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0848927
{'0': {'precision': 0.30906938896286434, 'recall': 0.23431103134989625, 'f1-score': 0.26654757727519224, 'support': 35662}, '1': {'precision': 0.46852809480016283, 'recall': 0.4862543224171113, 'f1-score': 0.4772266584766585, 'support': 63911}, '2': {'precision': 0.27664382909886764, 'recall': 0.3245785419225187, 'f1-score': 0.2987002979554094, 'support': 35828}, 'accuracy': 0.37711686028906727, 'macro avg': {'precision': 0.3514137709539649, 'recall': 0.3483812985631754, 'f1-score': 0.34749151123575334, 'support': 135401}, 'weighted avg': {'precision': 0.37575591557611177, 'recall': 0.37711686028906727, 'f1-score': 0.3744986148243812, 'support': 135401}}
[[ 8356 17831  9475]
 [11902 31077 20932]
 [ 6778 17421 11629]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038612
{'0': {'precision': 0.3117289416209197, 'recall': 0.33356493178372915, 'f1-score': 0.322277484514692, 'support': 15832}, '1': {'precision': 0.4112025937460006, 'recall': 0.45098956627520703, 'f1-score': 0.4301780693533271, 'support': 21373}, '2': {'precision': 0.31929133858267716, 'recall': 0.2554008943755117, 'f1-score': 0.2837946600412919, 'support': 15877}, 'accuracy': 0.35746580761840174, 'macro avg': {'precision': 0.34740762464986585, 'recall': 0.34665179747814934, 'f1-score': 0.34541673796977035, 'support': 53082}, 'weighted avg': {'precision': 0.35404306963853727, 'recall': 0.35746580761840174, 'f1-score': 0.35421236631251374, 'support': 53082}}
[[5281 6931 3620]
 [6709 9639 5025]
 [4951 6871 4055]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1331166
{'0': {'precision': 0.3788562924097571, 'recall': 0.15502043681103175, 'f1-score': 0.2200150885905352, 'support': 96884}, '1': {'precision': 0.2727226626548792, 'recall': 0.717906883611931, 'f1-score': 0.39528293411951093, 'support': 67421}, '2': {'precision': 0.33955751339623264, 'recall': 0.1240959223394286, 'f1-score': 0.18176378978117605, 'support': 83234}, 'accuracy': 0.2979328509850973, 'macro avg': {'precision': 0.33037882282028963, 'recall': 0.3323410809207971, 'f1-score': 0.2656872708304074, 'support': 247539}, 'weighted avg': {'precision': 0.33673513160634705, 'recall': 0.2979328509850973, 'f1-score': 0.2548900974106034, 'support': 247539}}
[[15019 70508 11357]
 [10286 48402  8733]
 [14338 58567 10329]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1125307
{'0': {'precision': 0.33179658131782397, 'recall': 0.26129698933139694, 'f1-score': 0.2923567277045185, 'support': 17903}, '1': {'precision': 0.32736150234741784, 'recall': 0.469182322226409, 'f1-score': 0.38564665280297333, 'support': 18577}, '2': {'precision': 0.3616884370375137, 'recall': 0.2841041192822846, 'f1-score': 0.3182358602728868, 'support': 19785}, 'accuracy': 0.3379543232915667, 'macro avg': {'precision': 0.34028217356758517, 'recall': 0.33819447694669685, 'f1-score': 0.3320797469267929, 'support': 56265}, 'weighted avg': {'precision': 0.34084341155653053, 'recall': 0.3379543232915667, 'f1-score': 0.3322583641822429, 'support': 56265}}
[[4678 8521 4704]
 [4645 8716 5216]
 [4776 9388 5621]]
Evaluating performance on  val set...
79/79 - 1s - 609ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1159532
{'0': {'precision': 0.3787704351830532, 'recall': 0.23792305467168065, 'f1-score': 0.2922625921648752, 'support': 6914}, '1': {'precision': 0.32814814814814813, 'recall': 0.41158253329204086, 'f1-score': 0.36516004945734304, 'support': 6458}, '2': {'precision': 0.3329374505146477, 'recall': 0.37945555722665064, 'f1-score': 0.35467772545160614, 'support': 6649}, 'accuracy': 0.340942010888567, 'macro avg': {'precision': 0.3466186779486163, 'recall': 0.34298704839679073, 'f1-score': 0.33736678902460815, 'support': 20021}, 'weighted avg': {'precision': 0.3472204504304612, 'recall': 0.340942010888567, 'f1-score': 0.3365046380376204, 'support': 20021}}
[[1645 2696 2573]
 [1318 2658 2482]
 [1380 2746 2523]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1235468
{'0': {'precision': 0.36656685990953686, 'recall': 0.15779514603044015, 'f1-score': 0.22062037498562173, 'support': 145860}, '1': {'precision': 0.28692079918772756, 'recall': 0.5864811823755188, 'f1-score': 0.38532921405688825, 'support': 115158}, '2': {'precision': 0.37323442081602826, 'recall': 0.27776248038108875, 'f1-score': 0.31849773262766545, 'support': 145268}, 'accuracy': 0.32219667918658285, 'macro avg': {'precision': 0.3422406933044309, 'recall': 0.34067960292901595, 'f1-score': 0.3081491072233918, 'support': 406286}, 'weighted avg': {'precision': 0.3463759160354237, 'recall': 0.32219667918658285, 'f1-score': 0.30230172378846826, 'support': 406286}}
[[23016 85316 37528]
 [17389 67538 30231]
 [22383 82535 40350]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150264
{'0': {'precision': 0.33284689286148605, 'recall': 0.33123562870628104, 'f1-score': 0.3320393060778843, 'support': 24789}, '1': {'precision': 0.33332298522289827, 'recall': 0.4300993430539978, 'f1-score': 0.3755771652441584, 'support': 24964}, '2': {'precision': 0.3449943575689183, 'recall': 0.2494463224151999, 'f1-score': 0.28954133405493165, 'support': 25737}, 'accuracy': 0.3360445092065174, 'macro avg': {'precision': 0.3370547452177675, 'recall': 0.3369270980584929, 'f1-score': 0.3323859351256581, 'support': 75490}, 'weighted avg': {'precision': 0.33714579958933716, 'recall': 0.3360445092065174, 'f1-score': 0.3319480199508759, 'support': 75490}}
[[ 8211 10538  6040]
 [ 8078 10737  6149]
 [ 8380 10937  6420]]
Evaluating performance on  val set...
131/131 - 1s - 854ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1125532
{'0': {'precision': 0.3524511374559436, 'recall': 0.21046589495838516, 'f1-score': 0.2635519616651692, 'support': 10453}, '1': {'precision': 0.3402285954701634, 'recall': 0.4048056065409645, 'f1-score': 0.3697184440126491, 'support': 11986}, '2': {'precision': 0.3000544704692242, 'recall': 0.3532753092075126, 'f1-score': 0.3244971808465876, 'support': 10915}, 'accuracy': 0.32703723691311387, 'macro avg': {'precision': 0.330911401131777, 'recall': 0.3228489369022874, 'f1-score': 0.3192558621748019, 'support': 33354}, 'weighted avg': {'precision': 0.3309122213318924, 'recall': 0.32703723691311387, 'f1-score': 0.32164779799010995, 'support': 33354}}
[[2200 4578 3675]
 [1814 4852 5320]
 [2228 4831 3856]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
2104/2104 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1396905
{'0': {'precision': 0.4081178876710892, 'recall': 0.18567720262635518, 'f1-score': 0.2552334600361415, 'support': 209568}, '1': {'precision': 0.24068224290199872, 'recall': 0.6085239401037711, 'f1-score': 0.34493603483982654, 'support': 125083}, '2': {'precision': 0.383003189855472, 'recall': 0.23847775979598843, 'f1-score': 0.2939357763505856, 'support': 203910}, 'accuracy': 0.3038764411088066, 'macro avg': {'precision': 0.3439344401428533, 'recall': 0.34422630084203826, 'f1-score': 0.2980350904088512, 'support': 538561}, 'weighted avg': {'precision': 0.3597213443153047, 'recall': 0.3038764411088066, 'f1-score': 0.2907207242157751, 'support': 538561}}
[[ 38912 121841  48815]
 [ 19445  76116  29522]
 [ 36988 118294  48628]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175735
{'0': {'precision': 0.3421585781379501, 'recall': 0.2032994090610637, 'f1-score': 0.2550540586922945, 'support': 36552}, '1': {'precision': 0.3272313672105895, 'recall': 0.5050591617825942, 'f1-score': 0.39714785708850997, 'support': 36172}, '2': {'precision': 0.34682442795880675, 'recall': 0.30133260810443296, 'f1-score': 0.32248206411804936, 'support': 36770}, 'accuracy': 0.3359088169214752, 'macro avg': {'precision': 0.3387381244357821, 'recall': 0.3365637263160303, 'f1-score': 0.32489465996628464, 'support': 109494}, 'weighted avg': {'precision': 0.3387941583911915, 'recall': 0.3359088169214752, 'f1-score': 0.32463910111555894, 'support': 109494}}
[[ 7431 18719 10402]
 [ 7438 18269 10465]
 [ 6849 18841 11080]]
Evaluating performance on  val set...
141/141 - 1s - 896ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117019
{'0': {'precision': 0.37392281753465717, 'recall': 0.2453897221539218, 'f1-score': 0.29631828978622327, 'support': 12201}, '1': {'precision': 0.3047790802524797, 'recall': 0.49123444454537196, 'f1-score': 0.3761694431885368, 'support': 11009}, '2': {'precision': 0.3635111198582956, 'recall': 0.2907974494213965, 'f1-score': 0.32311392958670454, 'support': 12703}, 'accuracy': 0.33681396708712724, 'macro avg': {'precision': 0.3474043392151442, 'recall': 0.3424738720402301, 'f1-score': 0.33186722085382153, 'support': 35913}, 'weighted avg': {'precision': 0.3490442721799858, 'recall': 0.33681396708712724, 'f1-score': 0.3302744159854153, 'support': 35913}}
[[2994 5852 3355]
 [2488 5408 3113]
 [2525 6484 3694]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057638
{'0': {'precision': 0.4019233569335493, 'recall': 0.3665260698806829, 'f1-score': 0.38340945615856986, 'support': 481993}, '1': {'precision': 0.2760630610233372, 'recall': 0.4429367420517863, 'f1-score': 0.3401349272351453, 'support': 366120}, '2': {'precision': 0.4234466741798303, 'recall': 0.27199265711611836, 'f1-score': 0.3312277027602918, 'support': 500076}, 'accuracy': 0.35221174479245865, 'macro avg': {'precision': 0.36714436404557227, 'recall': 0.3604851563495292, 'f1-score': 0.35159069538466897, 'support': 1348189}, 'weighted avg': {'precision': 0.37572771437646296, 'recall': 0.35221174479245865, 'f1-score': 0.3523021610821069, 'support': 1348189}}
[[176663 206479  98851]
 [117606 162168  86346]
 [145275 218784 136017]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096776
{'0': {'precision': 0.3436557832986655, 'recall': 0.32632408260189305, 'f1-score': 0.3347657561769678, 'support': 90119}, '1': {'precision': 0.33859253911787984, 'recall': 0.43193493625661566, 'f1-score': 0.3796099463676255, 'support': 90127}, '2': {'precision': 0.35455908139600656, 'recall': 0.2754760099761583, 'f1-score': 0.31005422517358855, 'support': 91017}, 'accuracy': 0.3443521600808072, 'macro avg': {'precision': 0.3456024679375173, 'recall': 0.34457834294488904, 'f1-score': 0.3414766425727273, 'support': 271263}, 'weighted avg': {'precision': 0.3456319115382117, 'recall': 0.3443521600808072, 'f1-score': 0.34137374514700364, 'support': 271263}}
[[29408 38128 22583]
 [28138 38929 23060]
 [28028 37916 25073]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1143217
{'0': {'precision': 0.31089645926016213, 'recall': 0.3141414452415407, 'f1-score': 0.31251052881449376, 'support': 32479}, '1': {'precision': 0.35023515579071135, 'recall': 0.3956390602949722, 'f1-score': 0.37155516287047025, 'support': 36139}, '2': {'precision': 0.34111678537830936, 'recall': 0.2918535127055306, 'f1-score': 0.3145681001363242, 'support': 34788}, 'accuracy': 0.33512562133725315, 'macro avg': {'precision': 0.33408280014306097, 'recall': 0.3338780060806812, 'f1-score': 0.3328779306070961, 'support': 103406}, 'weighted avg': {'precision': 0.3348115692046104, 'recall': 0.33512562133725315, 'f1-score': 0.33383804193068406, 'support': 103406}}
[[10203 12910  9366]
 [11596 14298 10245]
 [11019 13616 10153]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
10110/10110 - 69s - 69s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.125249
{'0': {'precision': 0.3734336353558933, 'recall': 0.351067293583386, 'f1-score': 0.3619052245780794, 'support': 933670}, '1': {'precision': 0.2630731628412294, 'recall': 0.5861782722769397, 'f1-score': 0.36316164023966496, 'support': 704731}, '2': {'precision': 0.42795236803403913, 'recall': 0.06311993261029798, 'f1-score': 0.11001363585477354, 'support': 949700}, 'accuracy': 0.30942532768234315, 'macro avg': {'precision': 0.3548197220770539, 'recall': 0.3334551661568746, 'f1-score': 0.27836016689083926, 'support': 2588101}, 'weighted avg': {'precision': 0.363388430114175, 'recall': 0.30942532768234315, 'f1-score': 0.26981608016489045, 'support': 2588101}}
[[327781 557682  48207]
 [259711 413098  31922]
 [290257 599498  59945]]
Evaluating performance on  train set...
1686/1686 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1087658
{'0': {'precision': 0.35922093905178953, 'recall': 0.34795747217255096, 'f1-score': 0.35349950711167444, 'support': 144282}, '1': {'precision': 0.3411920412063627, 'recall': 0.4743038774165202, 'f1-score': 0.39688416432816226, 'support': 145664}, '2': {'precision': 0.35733399016984446, 'recall': 0.22536046659417322, 'f1-score': 0.2764019936000416, 'support': 141622}, 'accuracy': 0.3503712045378712, 'macro avg': {'precision': 0.3525823234759989, 'recall': 0.3492072720610815, 'f1-score': 0.342261888346626, 'support': 431568}, 'weighted avg': {'precision': 0.35251656140952903, 'recall': 0.3503712045378712, 'f1-score': 0.34284273610510774, 'support': 431568}}
[[50204 66615 27463]
 [46637 69089 29938]
 [42917 66789 31916]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1194012
{'0': {'precision': 0.3826271767448238, 'recall': 0.2723634766482846, 'f1-score': 0.31821421444251213, 'support': 61473}, '1': {'precision': 0.2906415356687652, 'recall': 0.41729052293018354, 'f1-score': 0.34263728257900006, 'support': 54099}, '2': {'precision': 0.35967990777003545, 'recall': 0.32717991425310755, 'f1-score': 0.3426610135271553, 'support': 64842}, 'accuracy': 0.33552274213752814, 'macro avg': {'precision': 0.34431620672787483, 'recall': 0.33894463794385854, 'f1-score': 0.3345041701828892, 'support': 180414}, 'weighted avg': {'precision': 0.3467969306916521, 'recall': 0.33552274213752814, 'f1-score': 0.3343240668340244, 'support': 180414}}
[[16743 26361 18369]
 [12125 22575 19399]
 [14890 28737 21215]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
6546/6546 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1077261
{'0': {'precision': 0.33434727602149195, 'recall': 0.1575819702301203, 'f1-score': 0.2142060180320815, 'support': 543368}, '1': {'precision': 0.37139823893086865, 'recall': 0.5424837468488789, 'f1-score': 0.44092675282659616, 'support': 602960}, '2': {'precision': 0.35015344423869765, 'recall': 0.35644764950202196, 'f1-score': 0.35327251335877324, 'support': 529441}, 'accuracy': 0.35890328559604573, 'macro avg': {'precision': 0.3519663197303527, 'recall': 0.3521711221936737, 'f1-score': 0.3361350947391503, 'support': 1675769}, 'weighted avg': {'precision': 0.3526724044269723, 'recall': 0.35890328559604573, 'f1-score': 0.33971916370070265, 'support': 1675769}}
[[ 85625 284121 173622]
 [ 99246 327096 176618]
 [ 71225 269498 188718]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154845
{'0': {'precision': 0.3510175137702431, 'recall': 0.20093268259527428, 'f1-score': 0.25556976388163466, 'support': 105931}, '1': {'precision': 0.3332177225458671, 'recall': 0.5309330011333514, 'f1-score': 0.4094570093255416, 'support': 106763}, '2': {'precision': 0.33419026195831997, 'recall': 0.27507935263921, 'f1-score': 0.30176735788325443, 'support': 102076}, 'accuracy': 0.3369063125456683, 'macro avg': {'precision': 0.3394751660914767, 'recall': 0.3356483454559453, 'f1-score': 0.32226471036347687, 'support': 314770}, 'weighted avg': {'precision': 0.3395233508371747, 'recall': 0.3369063125456683, 'f1-score': 0.32274620887524, 'support': 314770}}
[[21285 57643 27003]
 [21140 56684 28939]
 [18213 55784 28079]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1075654
{'0': {'precision': 0.31434076520781723, 'recall': 0.12688536429543623, 'f1-score': 0.1807927492925415, 'support': 36001}, '1': {'precision': 0.37086583852703336, 'recall': 0.6066912416592786, 'f1-score': 0.46033333628373413, 'support': 42862}, '2': {'precision': 0.3146083029355567, 'recall': 0.2619536605825692, 'f1-score': 0.28587663362586024, 'support': 34571}, 'accuracy': 0.34934851984413845, 'macro avg': {'precision': 0.3332716355568024, 'recall': 0.3318434221790947, 'f1-score': 0.3090009064007119, 'support': 113434}, 'weighted avg': {'precision': 0.3357807808944185, 'recall': 0.34934851984413845, 'f1-score': 0.3184456893713861, 'support': 113434}}
[[ 4568 22679  8754]
 [ 5883 26004 10975]
 [ 4081 21434  9056]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
7633/7633 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150414
{'0': {'precision': 0.36793945807575834, 'recall': 0.2856450208158122, 'f1-score': 0.32161129144085665, 'support': 668242}, '1': {'precision': 0.315811265273013, 'recall': 0.5493836939816455, 'f1-score': 0.40106927961339955, 'support': 612277}, '2': {'precision': 0.3523681885363949, 'recall': 0.1936377175489889, 'f1-score': 0.24993052640858904, 'support': 673469}, 'accuracy': 0.33657525020624485, 'macro avg': {'precision': 0.3453729706283888, 'recall': 0.3428888107821489, 'f1-score': 0.32420369915428177, 'support': 1953988}, 'weighted avg': {'precision': 0.34623837248562567, 'recall': 0.33657525020624485, 'f1-score': 0.32180347556829436, 'support': 1953988}}
[[190880 358993 118369]
 [154587 336375 121315]
 [173314 369746 130409]]
Evaluating performance on  train set...
1586/1586 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112569
{'0': {'precision': 0.3422828702215814, 'recall': 0.29214299482525985, 'f1-score': 0.3152316079563862, 'support': 134886}, '1': {'precision': 0.3389775811065203, 'recall': 0.5076001640112465, 'f1-score': 0.4064956272666239, 'support': 136576}, '2': {'precision': 0.33959483918875016, 'recall': 0.217827161228864, 'f1-score': 0.2654110520684089, 'support': 134368}, 'accuracy': 0.3400463248158096, 'macro avg': {'precision': 0.34028509683895064, 'recall': 0.3391901066884568, 'f1-score': 0.3290460957638064, 'support': 405830}, 'weighted avg': {'precision': 0.34028053298678346, 'recall': 0.3400463248158096, 'f1-score': 0.3294498428028965, 'support': 405830}}
[[39406 66678 28802]
 [39133 69326 28117]
 [36588 68511 29269]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101509
{'0': {'precision': 0.31626905235255137, 'recall': 0.3881483824326767, 'f1-score': 0.3485414046334239, 'support': 44264}, '1': {'precision': 0.40352821649579756, 'recall': 0.4618800105717558, 'f1-score': 0.4307368732387423, 'support': 56755}, '2': {'precision': 0.348617202508246, 'recall': 0.20974354501046755, 'f1-score': 0.2619102729933964, 'support': 45856}, 'accuracy': 0.3609395744680851, 'macro avg': {'precision': 0.35613815711886493, 'recall': 0.35325731267163335, 'f1-score': 0.3470628502885209, 'support': 146875}, 'weighted avg': {'precision': 0.36008692901290523, 'recall': 0.3609395744680851, 'f1-score': 0.35325593500421365, 'support': 146875}}
[[17181 18734  8349]
 [20919 26214  9622]
 [16224 20014  9618]]
testing model on single stock: results/universal/W10/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
22048/22048 - 138s - 138s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1319555
{'0': {'precision': 0.3706652963257031, 'recall': 0.24962803933351077, 'f1-score': 0.29833772459420627, 'support': 2115143}, '1': {'precision': 0.25060335605657, 'recall': 0.5864486146626836, 'f1-score': 0.35115141264863464, 'support': 1413302}, '2': {'precision': 0.3877170270676148, 'recall': 0.16718621417899124, 'f1-score': 0.23362971094760912, 'support': 2115623}, 'accuracy': 0.30306704313271915, 'macro avg': {'precision': 0.3363285598166293, 'recall': 0.3344209560583952, 'f1-score': 0.29437294939681663, 'support': 5644068}, 'weighted avg': {'precision': 0.3469928766172852, 'recall': 0.30306704313271915, 'f1-score': 0.2873073700697117, 'support': 5644068}}
[[ 527999 1235601  351543]
 [ 377448  828829  207025]
 [ 519016 1242904  353703]]
Evaluating performance on  train set...
5429/5429 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116102
{'0': {'precision': 0.3322670615466452, 'recall': 0.29997988149551874, 'f1-score': 0.31529906105367983, 'support': 462261}, '1': {'precision': 0.3274187203913051, 'recall': 0.4190039504929909, 'f1-score': 0.3675926325945767, 'support': 456905}, '2': {'precision': 0.33810968061401336, 'recall': 0.2785627775534921, 'f1-score': 0.3054612558162293, 'support': 470630}, 'accuracy': 0.3318573373358392, 'macro avg': {'precision': 0.3325984875173212, 'recall': 0.33251553651400056, 'f1-score': 0.3294509831548286, 'support': 1389796}, 'weighted avg': {'precision': 0.3326516363303508, 'recall': 0.3318573373358392, 'f1-score': 0.3291595326811648, 'support': 1389796}}
[[138669 194746 128846]
 [137662 191445 127798]
 [141011 198519 131100]]
Evaluating performance on  val set...
1890/1890 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1159793
{'0': {'precision': 0.31778407182821045, 'recall': 0.3291375995064872, 'f1-score': 0.3233612080026306, 'support': 152377}, '1': {'precision': 0.34914335390579865, 'recall': 0.37574162206765105, 'f1-score': 0.36195450169051296, 'support': 172089}, '2': {'precision': 0.3216705653160039, 'recall': 0.28418163202492447, 'f1-score': 0.30176622822229937, 'support': 159201}, 'accuracy': 0.33092189460930765, 'macro avg': {'precision': 0.32953266368333767, 'recall': 0.32968695119968755, 'f1-score': 0.32902731263848095, 'support': 483667}, 'weighted avg': {'precision': 0.33022097809471257, 'recall': 0.33092189460930765, 'f1-score': 0.3299846471486659, 'support': 483667}}
[[50153 58930 43294]
 [55317 64661 52111]
 [52351 61608 45242]]
training model: results/universal/W10/deepOF_L1/h50
Epoch 1/50
8543/8543 - 122s - loss: 3.1095 - accuracy50: 0.4498 - val_loss: 3.2651 - val_accuracy50: 0.3482 - 122s/epoch - 14ms/step
Epoch 2/50
8543/8543 - 116s - loss: 3.0958 - accuracy50: 0.4522 - val_loss: 3.2507 - val_accuracy50: 0.3492 - 116s/epoch - 14ms/step
Epoch 3/50
8543/8543 - 117s - loss: 3.0871 - accuracy50: 0.4543 - val_loss: 3.2449 - val_accuracy50: 0.3522 - 117s/epoch - 14ms/step
Epoch 4/50
8543/8543 - 113s - loss: 3.0806 - accuracy50: 0.4562 - val_loss: 3.2430 - val_accuracy50: 0.3554 - 113s/epoch - 13ms/step
Epoch 5/50
8543/8543 - 114s - loss: 3.0751 - accuracy50: 0.4577 - val_loss: 3.2444 - val_accuracy50: 0.3553 - 114s/epoch - 13ms/step
Epoch 6/50
8543/8543 - 116s - loss: 3.0701 - accuracy50: 0.4588 - val_loss: 3.2442 - val_accuracy50: 0.3563 - 116s/epoch - 14ms/step
Epoch 7/50
8543/8543 - 115s - loss: 3.0661 - accuracy50: 0.4599 - val_loss: 3.2439 - val_accuracy50: 0.3573 - 115s/epoch - 13ms/step
Epoch 8/50
8543/8543 - 117s - loss: 3.0634 - accuracy50: 0.4607 - val_loss: 3.2384 - val_accuracy50: 0.3594 - 117s/epoch - 14ms/step
Epoch 9/50
8543/8543 - 117s - loss: 3.0596 - accuracy50: 0.4616 - val_loss: 3.2338 - val_accuracy50: 0.3623 - 117s/epoch - 14ms/step
Epoch 10/50
8543/8543 - 113s - loss: 3.0567 - accuracy50: 0.4619 - val_loss: 3.2303 - val_accuracy50: 0.3638 - 113s/epoch - 13ms/step
Epoch 11/50
8543/8543 - 118s - loss: 3.0534 - accuracy50: 0.4630 - val_loss: 3.2248 - val_accuracy50: 0.3696 - 118s/epoch - 14ms/step
Epoch 12/50
8543/8543 - 115s - loss: 3.0507 - accuracy50: 0.4634 - val_loss: 3.2250 - val_accuracy50: 0.3712 - 115s/epoch - 13ms/step
Epoch 13/50
8543/8543 - 117s - loss: 3.0479 - accuracy50: 0.4644 - val_loss: 3.2278 - val_accuracy50: 0.3691 - 117s/epoch - 14ms/step
Epoch 14/50
8543/8543 - 117s - loss: 3.0451 - accuracy50: 0.4651 - val_loss: 3.2242 - val_accuracy50: 0.3743 - 117s/epoch - 14ms/step
Epoch 15/50
8543/8543 - 115s - loss: 3.0431 - accuracy50: 0.4654 - val_loss: 3.2238 - val_accuracy50: 0.3776 - 115s/epoch - 13ms/step
Epoch 16/50
8543/8543 - 114s - loss: 3.0409 - accuracy50: 0.4661 - val_loss: 3.2247 - val_accuracy50: 0.3810 - 114s/epoch - 13ms/step
Epoch 17/50
8543/8543 - 118s - loss: 3.0383 - accuracy50: 0.4670 - val_loss: 3.2233 - val_accuracy50: 0.3807 - 118s/epoch - 14ms/step
Epoch 18/50
8543/8543 - 120s - loss: 3.0364 - accuracy50: 0.4675 - val_loss: 3.2275 - val_accuracy50: 0.3898 - 120s/epoch - 14ms/step
Epoch 19/50
8543/8543 - 119s - loss: 3.0346 - accuracy50: 0.4681 - val_loss: 3.2303 - val_accuracy50: 0.3917 - 119s/epoch - 14ms/step
Epoch 20/50
8543/8543 - 118s - loss: 3.0324 - accuracy50: 0.4685 - val_loss: 3.2410 - val_accuracy50: 0.4007 - 118s/epoch - 14ms/step
Epoch 21/50
8543/8543 - 120s - loss: 3.0305 - accuracy50: 0.4689 - val_loss: 3.2485 - val_accuracy50: 0.4004 - 120s/epoch - 14ms/step
Epoch 22/50
8543/8543 - 117s - loss: 3.0288 - accuracy50: 0.4692 - val_loss: 3.2511 - val_accuracy50: 0.4052 - 117s/epoch - 14ms/step
Epoch 23/50
8543/8543 - 119s - loss: 3.0264 - accuracy50: 0.4700 - val_loss: 3.2700 - val_accuracy50: 0.4086 - 119s/epoch - 14ms/step
Epoch 24/50
8543/8543 - 116s - loss: 3.0247 - accuracy50: 0.4704 - val_loss: 3.2900 - val_accuracy50: 0.4124 - 116s/epoch - 14ms/step
Epoch 25/50
8543/8543 - 118s - loss: 3.0230 - accuracy50: 0.4708 - val_loss: 3.2870 - val_accuracy50: 0.4103 - 118s/epoch - 14ms/step
Epoch 26/50
8543/8543 - 134s - loss: 3.0208 - accuracy50: 0.4717 - val_loss: 3.2976 - val_accuracy50: 0.4137 - 134s/epoch - 16ms/step
Epoch 27/50
8543/8543 - 167s - loss: 3.0190 - accuracy50: 0.4719 - val_loss: 3.3156 - val_accuracy50: 0.4182 - 167s/epoch - 20ms/step
testing model in sample: results/universal/W10/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 219s - 219s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0853173
{'0': {'precision': 0.40127260912599144, 'recall': 0.5198033393333514, 'f1-score': 0.45291127741547804, 'support': 3201657}, '1': {'precision': 0.36863923018375555, 'recall': 0.18425897440127795, 'f1-score': 0.24570557804113402, 'support': 3091209}, '2': {'precision': 0.40443182092482477, 'recall': 0.479089210758372, 'f1-score': 0.43860624692389094, 'support': 3252388}, 'accuracy': 0.39726538445179144, 'macro avg': {'precision': 0.39144788674485725, 'recall': 0.3943838414976671, 'f1-score': 0.3790743674601677, 'support': 9545254}, 'weighted avg': {'precision': 0.3917808122452939, 'recall': 0.39726538445179144, 'f1-score': 0.3809339751595361, 'support': 9545254}}
[[1664232  472023 1065402]
 [1292439  569583 1229187]
 [1190714  503490 1558184]]
Evaluating performance on  train set...
8543/8543 - 76s - 76s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0865306
{'0': {'precision': 0.370694064561549, 'recall': 0.4964809093336385, 'f1-score': 0.42446457012341077, 'support': 655425}, '1': {'precision': 0.42703017903627694, 'recall': 0.24859003827866497, 'f1-score': 0.3142459205103646, 'support': 863144}, '2': {'precision': 0.37883719920884407, 'recall': 0.4572374476721301, 'f1-score': 0.414361456110916, 'support': 668143}, 'accuracy': 0.38664213668741015, 'macro avg': {'precision': 0.39218714760222334, 'recall': 0.4007694650948112, 'f1-score': 0.3843573155815638, 'support': 2186712}, 'weighted avg': {'precision': 0.39541929477239635, 'recall': 0.38664213668741015, 'f1-score': 0.37787183591458334, 'support': 2186712}}
[[325406 138448 191571]
 [339231 214569 309344]
 [213192 149451 305500]]
Evaluating performance on  val set...
3077/3077 - 27s - 27s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0877314
{'0': {'precision': 0.35922472922528087, 'recall': 0.5188785741795822, 'f1-score': 0.4245377840801047, 'support': 225891}, '1': {'precision': 0.4555636118807779, 'recall': 0.21376647599721743, 'f1-score': 0.2909901397472186, 'support': 329191}, '2': {'precision': 0.36580912971484747, 'recall': 0.48307807762476335, 'f1-score': 0.41634358400582855, 'support': 231859}, 'accuracy': 0.3806969010383243, 'macro avg': {'precision': 0.39353249027363546, 'recall': 0.405241042600521, 'f1-score': 0.3772905026110506, 'support': 786941}, 'weighted avg': {'precision': 0.40146492974013037, 'recall': 0.3806969010383243, 'f1-score': 0.36625821595414776, 'support': 786941}}
[[117210  40494  68187]
 [132827  70370 125994]
 [ 76249  43604 112006]]
testing model out of sample: results/universal/W10/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 147s - 147s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0857732
{'0': {'precision': 0.3803401446495704, 'recall': 0.5379481097365665, 'f1-score': 0.4456188149938674, 'support': 1617182}, '1': {'precision': 0.4593514410417343, 'recall': 0.2000517060528847, 'f1-score': 0.2787188379768651, 'support': 2227979}, '2': {'precision': 0.3700550303474846, 'recall': 0.504629512141831, 'f1-score': 0.42698980114230767, 'support': 1615613}, 'accuracy': 0.390229846538238, 'macro avg': {'precision': 0.40324887201292975, 'recall': 0.414209775977094, 'f1-score': 0.38377581803768007, 'support': 5460774}, 'weighted avg': {'precision': 0.4095335785385358, 'recall': 0.390229846538238, 'f1-score': 0.3720125971115445, 'support': 5460774}}
[[869960 255070 492152]
 [886558 445711 895710]
 [530803 269524 815286]]
Evaluating performance on  train set...
4055/4055 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0877259
{'0': {'precision': 0.35927602863295116, 'recall': 0.5373404544220151, 'f1-score': 0.4306268022885141, 'support': 287222}, '1': {'precision': 0.48002355995016965, 'recall': 0.20090052159572078, 'f1-score': 0.2832532618123435, 'support': 458401}, '2': {'precision': 0.35767284788905046, 'recall': 0.5098818563087635, 'f1-score': 0.42042512074564936, 'support': 291848}, 'accuracy': 0.38096197387686015, 'macro avg': {'precision': 0.3989908121573904, 'recall': 0.4160409441088331, 'f1-score': 0.378101728282169, 'support': 1037471}, 'weighted avg': {'precision': 0.4121766918896575, 'recall': 0.38096197387686015, 'f1-score': 0.36264078756353474, 'support': 1037471}}
[[154336  47470  85416]
 [184487  92093 181821]
 [ 90752  52288 148808]]
Evaluating performance on  val set...
1545/1545 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0875204
{'0': {'precision': 0.3606653419420302, 'recall': 0.5499074508937205, 'f1-score': 0.4356215348701488, 'support': 108591}, '1': {'precision': 0.4891355916121074, 'recall': 0.17821234522375934, 'f1-score': 0.26124303710867386, 'support': 173557}, '2': {'precision': 0.3647337178360285, 'recall': 0.537288150624795, 'f1-score': 0.4345063275705644, 'support': 112757}, 'accuracy': 0.3829477975715678, 'macro avg': {'precision': 0.40484488379672207, 'recall': 0.42180264891409164, 'f1-score': 0.37712363318312897, 'support': 394905}, 'weighted avg': {'precision': 0.41828843859228565, 'recall': 0.3829477975715678, 'f1-score': 0.35866541538453195, 'support': 394905}}
[[59715 15570 33306]
 [70414 30930 72213]
 [35440 16734 60583]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
518/518 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0989946
{'0': {'precision': 0.4257234526368252, 'recall': 0.5294618990431178, 'f1-score': 0.47195938946059807, 'support': 51626}, '1': {'precision': 0.23221261160714285, 'recall': 0.10117925961947602, 'f1-score': 0.14094584868114654, 'support': 32902}, '2': {'precision': 0.3981096128590718, 'recall': 0.44767768371570604, 'f1-score': 0.42144115919326414, 'support': 48077}, 'accuracy': 0.3935447381320463, 'macro avg': {'precision': 0.35201522570101323, 'recall': 0.3594396141261, 'f1-score': 0.3447821324450029, 'support': 132605}, 'weighted avg': {'precision': 0.3676978558150337, 'recall': 0.3935447381320463, 'f1-score': 0.37151240423916504, 'support': 132605}}
[[27334  5446 18846]
 [15879  3329 13694]
 [20993  5561 21523]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.116741
{'0': {'precision': 0.37002671165471673, 'recall': 0.4544591211257878, 'f1-score': 0.4079197179278547, 'support': 11583}, '1': {'precision': 0.3047703180212014, 'recall': 0.1236226820747111, 'f1-score': 0.1758970110254286, 'support': 11163}, '2': {'precision': 0.35922142994796685, 'recall': 0.48311015118790496, 'f1-score': 0.4120551175300272, 'support': 11575}, 'accuracy': 0.3565164185192739, 'macro avg': {'precision': 0.34467281987462833, 'recall': 0.3537306514628013, 'f1-score': 0.3319572821611035, 'support': 34321}, 'weighted avg': {'precision': 0.3451577317914679, 'recall': 0.3565164185192739, 'f1-score': 0.33384838472787115, 'support': 34321}}
[[5264 1554 4765]
 [4573 1380 5210]
 [4389 1594 5592]]
Evaluating performance on  val set...
46/46 - 0s - 410ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1059219
{'0': {'precision': 0.38103651354534745, 'recall': 0.4823558648111332, 'f1-score': 0.4257512612415003, 'support': 4024}, '1': {'precision': 0.3021346469622332, 'recall': 0.09743182419909982, 'f1-score': 0.14734734734734733, 'support': 3777}, '2': {'precision': 0.3707635009310987, 'recall': 0.5130121102808555, 'f1-score': 0.4304399524375744, 'support': 3881}, 'accuracy': 0.36808765622324946, 'macro avg': {'precision': 0.3513115538128931, 'recall': 0.3642665997636962, 'f1-score': 0.334512853675474, 'support': 11682}, 'weighted avg': {'precision': 0.35211322027019576, 'recall': 0.36808765622324946, 'f1-score': 0.3372959648670565, 'support': 11682}}
[[1941  447 1636]
 [1666  368 1743]
 [1487  403 1991]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
1840/1840 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0864211
{'0': {'precision': 0.2852659951207996, 'recall': 0.6741209972685535, 'f1-score': 0.40088889810504347, 'support': 86035}, '1': {'precision': 0.7556368068251066, 'recall': 0.16218010845543232, 'f1-score': 0.26704510941891735, 'support': 298187}, '2': {'precision': 0.2767479658828093, 'recall': 0.6497578971639382, 'f1-score': 0.3881662999197633, 'support': 86740}, 'accuracy': 0.34550133556422813, 'macro avg': {'precision': 0.43921692260957185, 'recall': 0.4953530009626413, 'f1-score': 0.3520334358145747, 'support': 470962}, 'weighted avg': {'precision': 0.5815098690927313, 'recall': 0.34550133556422813, 'f1-score': 0.31380323942442573, 'support': 470962}}
[[ 57998   5878  22159]
 [124695  48360 125132]
 [ 20619   9761  56360]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0650339
{'0': {'precision': 0.21790730725927018, 'recall': 0.6831385256336072, 'f1-score': 0.33041799023243446, 'support': 17282}, '1': {'precision': 0.8309018374537724, 'recall': 0.28415507334415485, 'f1-score': 0.4234850621113403, 'support': 100417}, '2': {'precision': 0.22858849378186394, 'recall': 0.6054237288135593, 'f1-score': 0.3318725901608882, 'support': 17700}, 'accuracy': 0.37707811726822205, 'macro avg': {'precision': 0.42579921283163547, 'recall': 0.5242391092637738, 'f1-score': 0.361925214168221, 'support': 135399}, 'weighted avg': {'precision': 0.673923442828892, 'recall': 0.37707811726822205, 'f1-score': 0.39963018955146723, 'support': 135399}}
[[11806  2321  3155]
 [38875 28534 33008]
 [ 3498  3486 10716]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830586
{'0': {'precision': 0.244947209653092, 'recall': 0.6630117811734515, 'f1-score': 0.3577317641135377, 'support': 8573}, '1': {'precision': 0.786799371398638, 'recall': 0.21055287652798027, 'f1-score': 0.33220533917236195, 'support': 35668}, '2': {'precision': 0.2748868778280543, 'recall': 0.6321683067526298, 'f1-score': 0.38316251328283, 'support': 8841}, 'accuracy': 0.3538487622923025, 'macro avg': {'precision': 0.43554448629326137, 'recall': 0.5019109881513538, 'f1-score': 0.35769987218957655, 'support': 53082}, 'weighted avg': {'precision': 0.6140267377694963, 'recall': 0.3538487622923025, 'f1-score': 0.3448150829147106, 'support': 53082}}
[[ 5684   784  2105]
 [15520  7510 12638]
 [ 2001  1251  5589]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1032321
{'0': {'precision': 0.4123250648898879, 'recall': 0.5120233044980783, 'f1-score': 0.45679756516927217, 'support': 90283}, '1': {'precision': 0.2952367252261162, 'recall': 0.22509665213457267, 'f1-score': 0.25543930613356153, 'support': 72942}, '2': {'precision': 0.40271651964715316, 'recall': 0.38121671470424273, 'f1-score': 0.3916717951217729, 'support': 84309}, 'accuracy': 0.3829211340664313, 'macro avg': {'precision': 0.3700927699210524, 'recall': 0.37277889044563123, 'f1-score': 0.3679695554748689, 'support': 247534}, 'weighted avg': {'precision': 0.3745494683551713, 'recall': 0.3829211340664313, 'f1-score': 0.37528083341720003, 'support': 247534}}
[[46227 19611 24445]
 [33300 16419 23223]
 [32586 19583 32140]]
Evaluating performance on  train set...
220/220 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1100891
{'0': {'precision': 0.37512785543811794, 'recall': 0.4756552283166712, 'f1-score': 0.4194524530010245, 'support': 18505}, '1': {'precision': 0.3188394702595116, 'recall': 0.2239247311827957, 'f1-score': 0.2630830938319174, 'support': 18600}, '2': {'precision': 0.3893787372048242, 'recall': 0.40112758404677384, 'f1-score': 0.39516585240421703, 'support': 19156}, 'accuracy': 0.3670571088320506, 'macro avg': {'precision': 0.36111535430081787, 'recall': 0.3669025145154136, 'f1-score': 0.3592337997457196, 'support': 56261}, 'weighted avg': {'precision': 0.3613710065872434, 'recall': 0.3670571088320506, 'f1-score': 0.35948721595266353, 'support': 56261}}
[[8802 4302 5401]
 [7786 4165 6649]
 [6876 4596 7684]]
Evaluating performance on  val set...
79/79 - 1s - 571ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038324
{'0': {'precision': 0.40511772927642187, 'recall': 0.5439584235599827, 'f1-score': 0.4643825486812916, 'support': 6927}, '1': {'precision': 0.30723340790454884, 'recall': 0.19597272871412716, 'f1-score': 0.2393030009680542, 'support': 6307}, '2': {'precision': 0.38569508735254593, 'recall': 0.3805805215853838, 'f1-score': 0.3831207356867399, 'support': 6787}, 'accuracy': 0.37895210029469056, 'macro avg': {'precision': 0.3660154081778389, 'recall': 0.37350389128649786, 'f1-score': 0.3622687617786952, 'support': 20021}, 'weighted avg': {'precision': 0.36769812557881687, 'recall': 0.37895210029469056, 'f1-score': 0.3659308913104604, 'support': 20021}}
[[3768 1297 1862]
 [2819 1236 2252]
 [2714 1490 2583]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1588/1588 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.093953
{'0': {'precision': 0.39965984760403955, 'recall': 0.576164123591381, 'f1-score': 0.4719491888426505, 'support': 144379}, '1': {'precision': 0.3244731717995691, 'recall': 0.23489082022453167, 'f1-score': 0.2725086725338314, 'support': 119894}, '2': {'precision': 0.4026817308210443, 'recall': 0.3157357331981297, 'f1-score': 0.35394744112980253, 'support': 142008}, 'accuracy': 0.38442604995064994, 'macro avg': {'precision': 0.375604916741551, 'recall': 0.37559689233801413, 'f1-score': 0.3661351008354281, 'support': 406281}, 'weighted avg': {'precision': 0.3785284146376424, 'recall': 0.38442604995064994, 'f1-score': 0.37184873262752927, 'support': 406281}}
[[83186 27110 34083]
 [59306 28162 32426]
 [65650 31521 44837]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0968939
{'0': {'precision': 0.377040708463508, 'recall': 0.6123998473864937, 'f1-score': 0.46672773004172663, 'support': 26210}, '1': {'precision': 0.35374439940260294, 'recall': 0.19989551099143993, 'f1-score': 0.25544371405094496, 'support': 24883}, '2': {'precision': 0.39738014425116674, 'recall': 0.30715310514449684, 'f1-score': 0.3464890985179534, 'support': 24395}, 'accuracy': 0.37778189910979226, 'macro avg': {'precision': 0.3760550840390926, 'recall': 0.37314948784081015, 'f1-score': 0.35622018087020835, 'support': 75488}, 'weighted avg': {'precision': 0.37593455222248207, 'recall': 0.37778189910979226, 'f1-score': 0.35822569546774047, 'support': 75488}}
[[16051  4406  5753]
 [14299  4974  5610]
 [12221  4681  7493]]
Evaluating performance on  val set...
131/131 - 1s - 810ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1136589
{'0': {'precision': 0.3816586470421738, 'recall': 0.5998754337574518, 'f1-score': 0.46650982562967064, 'support': 11239}, '1': {'precision': 0.30622638409725644, 'recall': 0.16146916146916146, 'f1-score': 0.21144574896489138, 'support': 11544}, '2': {'precision': 0.3274317850447823, 'recall': 0.29741746287011633, 'f1-score': 0.3117037624547663, 'support': 10571}, 'accuracy': 0.3522815854170414, 'macro avg': {'precision': 0.33843893872807085, 'recall': 0.3529206860322432, 'f1-score': 0.32988644568310943, 'support': 33354}, 'weighted avg': {'precision': 0.3383648231646613, 'recall': 0.3522815854170414, 'f1-score': 0.3291675400015563, 'support': 33354}}
[[6742 1986 2511]
 [5733 1864 3947]
 [5190 2237 3144]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
2104/2104 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1096745
{'0': {'precision': 0.45971592418930385, 'recall': 0.48507158943931405, 'f1-score': 0.4720535164158085, 'support': 221122}, '1': {'precision': 0.1719403265006291, 'recall': 0.22679668494619223, 'f1-score': 0.19559506611845762, 'support': 97012}, '2': {'precision': 0.46430686786066844, 'recall': 0.3734200760359674, 'f1-score': 0.4139332205171274, 'support': 220422}, 'accuracy': 0.3928505113674344, 'macro avg': {'precision': 0.3653210395168671, 'recall': 0.36176278347382457, 'f1-score': 0.36052726768379784, 'support': 538556}, 'weighted avg': {'precision': 0.40975688316656117, 'recall': 0.3928505113674344, 'f1-score': 0.398466407474815, 'support': 538556}}
[[107260  51418  62444]
 [ 42489  22002  32521]
 [ 83569  54543  82310]]
Evaluating performance on  train set...
428/428 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1114786
{'0': {'precision': 0.3820341089553269, 'recall': 0.45449318219155577, 'f1-score': 0.415125482987583, 'support': 36522}, '1': {'precision': 0.3249622659687209, 'recall': 0.27882177890444176, 'f1-score': 0.3001290207767941, 'support': 36292}, '2': {'precision': 0.38432889270878096, 'recall': 0.36574061452057033, 'f1-score': 0.37480442556995974, 'support': 36679}, 'accuracy': 0.36653484697651906, 'macro avg': {'precision': 0.36377508921094287, 'recall': 0.36635185853885593, 'f1-score': 0.363352976444779, 'support': 109493}, 'weighted avg': {'precision': 0.3638860907954723, 'recall': 0.36653484697651906, 'f1-score': 0.36350220413345574, 'support': 109493}}
[[16599 10092  9831]
 [14514 10119 11659]
 [12336 10928 13415]]
Evaluating performance on  val set...
141/141 - 1s - 864ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1131556
{'0': {'precision': 0.38186059275521406, 'recall': 0.4607615894039735, 'f1-score': 0.4176170468187275, 'support': 12080}, '1': {'precision': 0.2963037364403375, 'recall': 0.26103884611981243, 'f1-score': 0.2775556287340641, 'support': 11301}, '2': {'precision': 0.401634302785344, 'recall': 0.36474624960102137, 'f1-score': 0.38230251327729686, 'support': 12532}, 'accuracy': 0.3644084314872052, 'macro avg': {'precision': 0.35993287732696516, 'recall': 0.3621822283749358, 'f1-score': 0.35915839627669616, 'support': 35913}, 'weighted avg': {'precision': 0.3618379296773082, 'recall': 0.3644084314872052, 'f1-score': 0.3612197583684173, 'support': 35913}}
[[5566 3275 3239]
 [4780 2950 3571]
 [4230 3731 4571]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/EXC
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0564297
{'0': {'precision': 0.3528672201340577, 'recall': 0.6172979509134285, 'f1-score': 0.4490456232274077, 'support': 305990}, '1': {'precision': 0.6712625012059041, 'recall': 0.22768069566450386, 'f1-score': 0.3400293005834664, 'support': 733457}, '2': {'precision': 0.3414634578703671, 'recall': 0.6239129096933637, 'f1-score': 0.4413687069873163, 'support': 308737}, 'accuracy': 0.40684802667885095, 'macro avg': {'precision': 0.45519772640344297, 'recall': 0.4896305187570987, 'f1-score': 0.4101478769327301, 'support': 1348184}, 'weighted avg': {'precision': 0.5234733720533122, 'recall': 0.40684802667885095, 'f1-score': 0.3879790825722194, 'support': 1348184}}
[[188887  38864  78239]
 [273211 166994 293252]
 [ 73194  42918 192625]]
Evaluating performance on  train set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0598869
{'0': {'precision': 0.30386125881903175, 'recall': 0.7074196941500122, 'f1-score': 0.42511912865895174, 'support': 49436}, '1': {'precision': 0.7738723608445297, 'recall': 0.22536638194553615, 'f1-score': 0.34907536424020236, 'support': 171747}, '2': {'precision': 0.31254592384648716, 'recall': 0.6625132290980251, 'f1-score': 0.4247246100375721, 'support': 50079}, 'accuracy': 0.39392174355420223, 'macro avg': {'precision': 0.46342651450334954, 'recall': 0.5317664350645245, 'f1-score': 0.3996397009789088, 'support': 271262}, 'weighted avg': {'precision': 0.6030477135361801, 'recall': 0.39392174355420223, 'f1-score': 0.3768998959405208, 'support': 271262}}
[[34972  4682  9782]
 [69847 38706 63194]
 [10273  6628 33178]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0705502
{'0': {'precision': 0.30171848034807125, 'recall': 0.6969679955081415, 'f1-score': 0.421129412562976, 'support': 17810}, '1': {'precision': 0.7859676346708047, 'recall': 0.2104653923780126, 'f1-score': 0.33202228777450016, 'support': 67384}, '2': {'precision': 0.28174396779810496, 'recall': 0.6841093784318032, 'f1-score': 0.3991158521935515, 'support': 18212}, 'accuracy': 0.377676343732472, 'macro avg': {'precision': 0.4564766942723269, 'recall': 0.5305142554393191, 'f1-score': 0.38408918417700927, 'support': 103406}, 'weighted avg': {'precision': 0.6137590697947483, 'recall': 0.377676343732472, 'f1-score': 0.3591861456520172, 'support': 103406}}
[[12413  1676  3721]
 [25161 14182 28041]
 [ 3567  2186 12459]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/AAL
Evaluating performance on  test set...
10110/10110 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812305
{'0': {'precision': 0.33859534323230434, 'recall': 0.6178591152522965, 'f1-score': 0.43745777405757674, 'support': 592101}, '1': {'precision': 0.6639157220175702, 'recall': 0.18023676283442983, 'f1-score': 0.28350806916669713, 'support': 1397939}, '2': {'precision': 0.3262455668218778, 'recall': 0.6154122690851693, 'f1-score': 0.42642989183737434, 'support': 598056}, 'accuracy': 0.3809155456366379, 'macro avg': {'precision': 0.4429188773572508, 'recall': 0.47116938239063194, 'f1-score': 0.3824652450205494, 'support': 2588096}, 'weighted avg': {'precision': 0.5114607188280248, 'recall': 0.3809155456366379, 'f1-score': 0.351754775546495, 'support': 2588096}}
[[365835  59737 166529]
 [552418 251960 593561]
 [162196  67809 368051]]
Evaluating performance on  train set...
1686/1686 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0890324
{'0': {'precision': 0.3069432706955113, 'recall': 0.650895476388873, 'f1-score': 0.41716413542855474, 'support': 87607}, '1': {'precision': 0.7024024170362068, 'recall': 0.16843835573750696, 'f1-score': 0.27171788894264903, 'support': 256723}, '2': {'precision': 0.2960819862560116, 'recall': 0.6252693841991839, 'f1-score': 0.40186840147055575, 'support': 87236}, 'accuracy': 0.3587191762094326, 'macro avg': {'precision': 0.43514255799590984, 'recall': 0.48153440544185466, 'f1-score': 0.3635834752805865, 'support': 431566}, 'weighted avg': {'precision': 0.5399921286144812, 'recall': 0.3587191762094326, 'f1-score': 0.32755157238104593, 'support': 431566}}
[[ 57023   8308  22276]
 [106077  43242 107404]
 [ 22677  10013  54546]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868306
{'0': {'precision': 0.3321251884970502, 'recall': 0.6181648078390821, 'f1-score': 0.432095684722282, 'support': 40617}, '1': {'precision': 0.6305711591291155, 'recall': 0.1580185771238338, 'f1-score': 0.25270924223377944, 'support': 97324}, '2': {'precision': 0.32765116192323473, 'recall': 0.6204412214818826, 'f1-score': 0.4288364524003255, 'support': 42473}, 'accuracy': 0.3704756837052557, 'macro avg': {'precision': 0.43011583651646684, 'recall': 0.4655415354815995, 'f1-score': 0.3712137931187956, 'support': 180414}, 'weighted avg': {'precision': 0.49206804390253683, 'recall': 0.3704756837052557, 'f1-score': 0.3345587114100031, 'support': 180414}}
[[25108  4184 11325]
 [39195 15379 42750]
 [11295  4826 26352]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/WBA
Evaluating performance on  test set...
6546/6546 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.078949
{'0': {'precision': 0.3951271694930364, 'recall': 0.5418695585936839, 'f1-score': 0.4570077536103145, 'support': 531687}, '1': {'precision': 0.4546155403616428, 'recall': 0.18782192966369712, 'f1-score': 0.2658212574134575, 'support': 621642}, '2': {'precision': 0.3886061140258426, 'recall': 0.5130915807708136, 'f1-score': 0.44225581698462174, 'support': 522435}, 'accuracy': 0.40156012421796866, 'macro avg': {'precision': 0.4127829412935073, 'recall': 0.4142610230093982, 'f1-score': 0.3883616093361313, 'support': 1675764}, 'weighted avg': {'precision': 0.4151619967303436, 'recall': 0.40156012421796866, 'f1-score': 0.38148609072708606, 'support': 1675764}}
[[288105  68475 175107]
 [258257 116758 246627]
 [182783  71595 268057]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0681518
{'0': {'precision': 0.422346611515751, 'recall': 0.5378200173665779, 'f1-score': 0.4731396720265602, 'support': 104799}, '1': {'precision': 0.41599525214013383, 'recall': 0.2162705462161303, 'f1-score': 0.284587654867801, 'support': 106954}, '2': {'precision': 0.4159746086292478, 'recall': 0.5076251031403194, 'f1-score': 0.45725253249507053, 'support': 103015}, 'accuracy': 0.41867978955929447, 'macro avg': {'precision': 0.41810549076171083, 'recall': 0.4205718889076759, 'f1-score': 0.40499328646314386, 'support': 314768}, 'weighted avg': {'precision': 0.4181031205382282, 'recall': 0.41867978955929447, 'f1-score': 0.40387276394812044, 'support': 314768}}
[[56363 15718 32718]
 [43122 23131 40701]
 [33967 16755 52293]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0681646
{'0': {'precision': 0.387590039102696, 'recall': 0.5566952409104345, 'f1-score': 0.457000727978646, 'support': 33830}, '1': {'precision': 0.5172826086956521, 'recall': 0.20388141547425243, 'f1-score': 0.292483559707455, 'support': 46684}, '2': {'precision': 0.38180956892468026, 'recall': 0.5386718512667842, 'f1-score': 0.446875, 'support': 32918}, 'accuracy': 0.40626101981804075, 'macro avg': {'precision': 0.4288940722410095, 'recall': 0.4330828358838237, 'f1-score': 0.3987864292287003, 'support': 113432}, 'weighted avg': {'precision': 0.4392887343699719, 'recall': 0.40626101981804075, 'f1-score': 0.38635366015674966, 'support': 113432}}
[[18833  4271 10726]
 [19182  9518 17984]
 [10575  4611 17732]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
7633/7633 - 43s - 43s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0821351
{'0': {'precision': 0.4058802861086711, 'recall': 0.48855222415225436, 'f1-score': 0.4433955927207924, 'support': 662050}, '1': {'precision': 0.38745851198882436, 'recall': 0.2423419602540881, 'f1-score': 0.29818159703217173, 'support': 627184}, '2': {'precision': 0.4075347704827792, 'recall': 0.46887321379949426, 'f1-score': 0.4360575006120808, 'support': 664749}, 'accuracy': 0.40282950261082107, 'macro avg': {'precision': 0.40029118952675824, 'recall': 0.39992246606861226, 'f1-score': 0.3925448967883483, 'support': 1953983}, 'weighted avg': {'precision': 0.40053017551590847, 'recall': 0.40282950261082107, 'f1-score': 0.3942887765083966, 'support': 1953983}}
[[323446 118515 220089]
 [242162 151993 233029]
 [231292 121774 311683]]
Evaluating performance on  train set...
1586/1586 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0742036
{'0': {'precision': 0.40935931775499523, 'recall': 0.4998458704559979, 'f1-score': 0.45009986120984397, 'support': 133005}, '1': {'precision': 0.4082537810376814, 'recall': 0.24501006466454806, 'f1-score': 0.3062354849412025, 'support': 135623}, '2': {'precision': 0.4186642144761529, 'recall': 0.49443156805294386, 'f1-score': 0.4534043591303128, 'support': 137202}, 'accuracy': 0.41285267230120987, 'macro avg': {'precision': 0.41209243775627646, 'recall': 0.41309583439116326, 'f1-score': 0.40324656842711976, 'support': 405830}, 'weighted avg': {'precision': 0.4121356384649576, 'recall': 0.41285267230120987, 'f1-score': 0.4031394724288327, 'support': 405830}}
[[66482 23288 43235]
 [51434 33229 50960]
 [44489 24876 67837]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0787238
{'0': {'precision': 0.3828726109424986, 'recall': 0.5192799768595777, 'f1-score': 0.4407637538008273, 'support': 44943}, '1': {'precision': 0.4610021970593206, 'recall': 0.1989315927654609, 'f1-score': 0.2779306128687147, 'support': 54848}, '2': {'precision': 0.3995213005204652, 'recall': 0.5282261490102795, 'f1-score': 0.45494622082388236, 'support': 47084}, 'accuracy': 0.4025191489361702, 'macro avg': {'precision': 0.4144653695074281, 'recall': 0.41547923954510607, 'f1-score': 0.39121352916447477, 'support': 146875}, 'weighted avg': {'precision': 0.4173858939343245, 'recall': 0.4025191489361702, 'f1-score': 0.3845029549138078, 'support': 146875}}
[[23338  6367 15238]
 [21794 10911 22143]
 [15823  6390 24871]]
testing model on single stock: results/universal/W10/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
22048/22048 - 125s - 125s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0933195
{'0': {'precision': 0.4232878497049579, 'recall': 0.49033449164450504, 'f1-score': 0.45435104465114384, 'support': 2133566}, '1': {'precision': 0.23623390114041085, 'recall': 0.15942820681487282, 'f1-score': 0.19037631600524205, 'support': 1318029}, '2': {'precision': 0.43649473707724806, 'recall': 0.4545279566224, 'f1-score': 0.4453288615946992, 'support': 2192468}, 'accuracy': 0.39915039927796697, 'macro avg': {'precision': 0.36533882930753897, 'recall': 0.3680968850272593, 'f1-score': 0.3633520740836951, 'support': 5644063}, 'weighted avg': {'precision': 0.3847363929212134, 'recall': 0.39915039927796697, 'f1-score': 0.3892016663993726, 'support': 5644063}}
[[1046161  331704  755701]
 [ 577090  210131  530808]
 [ 848261  347669  996538]]
Evaluating performance on  train set...
5429/5429 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0972737
{'0': {'precision': 0.3873280721533258, 'recall': 0.450375575160914, 'f1-score': 0.4164792736221308, 'support': 457698}, '1': {'precision': 0.3430765703805594, 'recall': 0.26074665191454516, 'f1-score': 0.2962988628924778, 'support': 459143}, '2': {'precision': 0.3968956127675052, 'recall': 0.42683855089501305, 'f1-score': 0.41132286527253265, 'support': 472954}, 'accuracy': 0.37971859159084614, 'macro avg': {'precision': 0.37576675176713015, 'recall': 0.3793202593234907, 'f1-score': 0.3747003339290471, 'support': 1389795}, 'weighted avg': {'precision': 0.37596469793280074, 'recall': 0.37971859159084614, 'f1-score': 0.3750208295507239, 'support': 1389795}}
[[206136 111563 139999]
 [172662 119720 166761]
 [153402 117677 201875]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094748
{'0': {'precision': 0.3761043181458185, 'recall': 0.4766088876514352, 'f1-score': 0.42043364520145765, 'support': 154439}, '1': {'precision': 0.3649923955855399, 'recall': 0.22296335558718608, 'f1-score': 0.2768233123708329, 'support': 167911}, '2': {'precision': 0.3928937460218139, 'recall': 0.45151471946540045, 'f1-score': 0.4201694245506961, 'support': 161317}, 'accuracy': 0.38018305983248807, 'macro avg': {'precision': 0.3779968199177241, 'recall': 0.3836956542346739, 'f1-score': 0.3724754607076622, 'support': 483667}, 'weighted avg': {'precision': 0.3778464384634193, 'recall': 0.38018305983248807, 'f1-score': 0.37048941109277966, 'support': 483667}}
[[73607 31516 49316]
 [67240 37438 63233]
 [54862 33618 72837]]
training model: results/universal/W10/deepOF_L1/h100
Epoch 1/50
8543/8543 - 164s - loss: 3.2044 - accuracy100: 0.4151 - val_loss: 3.2632 - val_accuracy100: 0.3533 - 164s/epoch - 19ms/step
Epoch 2/50
8543/8543 - 144s - loss: 3.1923 - accuracy100: 0.4188 - val_loss: 3.2617 - val_accuracy100: 0.3550 - 144s/epoch - 17ms/step
Epoch 3/50
8543/8543 - 123s - loss: 3.1847 - accuracy100: 0.4217 - val_loss: 3.2582 - val_accuracy100: 0.3568 - 123s/epoch - 14ms/step
Epoch 4/50
8543/8543 - 120s - loss: 3.1791 - accuracy100: 0.4236 - val_loss: 3.2591 - val_accuracy100: 0.3570 - 120s/epoch - 14ms/step
Epoch 5/50
8543/8543 - 119s - loss: 3.1759 - accuracy100: 0.4246 - val_loss: 3.2596 - val_accuracy100: 0.3578 - 119s/epoch - 14ms/step
Epoch 6/50
8543/8543 - 121s - loss: 3.1724 - accuracy100: 0.4258 - val_loss: 3.2583 - val_accuracy100: 0.3585 - 121s/epoch - 14ms/step
Epoch 7/50
8543/8543 - 144s - loss: 3.1690 - accuracy100: 0.4272 - val_loss: 3.2578 - val_accuracy100: 0.3586 - 144s/epoch - 17ms/step
Epoch 8/50
8543/8543 - 124s - loss: 3.1659 - accuracy100: 0.4285 - val_loss: 3.2531 - val_accuracy100: 0.3614 - 124s/epoch - 15ms/step
Epoch 9/50
8543/8543 - 119s - loss: 3.1636 - accuracy100: 0.4291 - val_loss: 3.2512 - val_accuracy100: 0.3622 - 119s/epoch - 14ms/step
Epoch 10/50
8543/8543 - 120s - loss: 3.1615 - accuracy100: 0.4299 - val_loss: 3.2510 - val_accuracy100: 0.3622 - 120s/epoch - 14ms/step
Epoch 11/50
8543/8543 - 116s - loss: 3.1592 - accuracy100: 0.4308 - val_loss: 3.2494 - val_accuracy100: 0.3629 - 116s/epoch - 14ms/step
Epoch 12/50
8543/8543 - 119s - loss: 3.1568 - accuracy100: 0.4312 - val_loss: 3.2480 - val_accuracy100: 0.3649 - 119s/epoch - 14ms/step
Epoch 13/50
8543/8543 - 122s - loss: 3.1554 - accuracy100: 0.4315 - val_loss: 3.2460 - val_accuracy100: 0.3659 - 122s/epoch - 14ms/step
Epoch 14/50
8543/8543 - 117s - loss: 3.1537 - accuracy100: 0.4320 - val_loss: 3.2448 - val_accuracy100: 0.3676 - 117s/epoch - 14ms/step
Epoch 15/50
8543/8543 - 115s - loss: 3.1518 - accuracy100: 0.4324 - val_loss: 3.2449 - val_accuracy100: 0.3670 - 115s/epoch - 13ms/step
Epoch 16/50
8543/8543 - 170s - loss: 3.1504 - accuracy100: 0.4332 - val_loss: 3.2442 - val_accuracy100: 0.3679 - 170s/epoch - 20ms/step
Epoch 17/50
8543/8543 - 122s - loss: 3.1486 - accuracy100: 0.4335 - val_loss: 3.2434 - val_accuracy100: 0.3681 - 122s/epoch - 14ms/step
Epoch 18/50
8543/8543 - 116s - loss: 3.1471 - accuracy100: 0.4341 - val_loss: 3.2429 - val_accuracy100: 0.3699 - 116s/epoch - 14ms/step
Epoch 19/50
8543/8543 - 116s - loss: 3.1456 - accuracy100: 0.4344 - val_loss: 3.2440 - val_accuracy100: 0.3695 - 116s/epoch - 14ms/step
Epoch 20/50
8543/8543 - 119s - loss: 3.1440 - accuracy100: 0.4349 - val_loss: 3.2455 - val_accuracy100: 0.3679 - 119s/epoch - 14ms/step
Epoch 21/50
8543/8543 - 383s - loss: 3.1429 - accuracy100: 0.4353 - val_loss: 3.2426 - val_accuracy100: 0.3704 - 383s/epoch - 45ms/step
Epoch 22/50
8543/8543 - 121s - loss: 3.1414 - accuracy100: 0.4358 - val_loss: 3.2428 - val_accuracy100: 0.3703 - 121s/epoch - 14ms/step
Epoch 23/50
8543/8543 - 120s - loss: 3.1397 - accuracy100: 0.4362 - val_loss: 3.2420 - val_accuracy100: 0.3726 - 120s/epoch - 14ms/step
Epoch 24/50
8543/8543 - 117s - loss: 3.1384 - accuracy100: 0.4367 - val_loss: 3.2396 - val_accuracy100: 0.3739 - 117s/epoch - 14ms/step
Epoch 25/50
8543/8543 - 122s - loss: 3.1365 - accuracy100: 0.4372 - val_loss: 3.2403 - val_accuracy100: 0.3739 - 122s/epoch - 14ms/step
Epoch 26/50
8543/8543 - 119s - loss: 3.1350 - accuracy100: 0.4378 - val_loss: 3.2411 - val_accuracy100: 0.3734 - 119s/epoch - 14ms/step
Epoch 27/50
8543/8543 - 119s - loss: 3.1334 - accuracy100: 0.4380 - val_loss: 3.2417 - val_accuracy100: 0.3738 - 119s/epoch - 14ms/step
Epoch 28/50
8543/8543 - 120s - loss: 3.1324 - accuracy100: 0.4381 - val_loss: 3.2416 - val_accuracy100: 0.3763 - 120s/epoch - 14ms/step
Epoch 29/50
8543/8543 - 117s - loss: 3.1311 - accuracy100: 0.4388 - val_loss: 3.2393 - val_accuracy100: 0.3772 - 117s/epoch - 14ms/step
Epoch 30/50
8543/8543 - 121s - loss: 3.1292 - accuracy100: 0.4394 - val_loss: 3.2394 - val_accuracy100: 0.3777 - 121s/epoch - 14ms/step
Epoch 31/50
8543/8543 - 119s - loss: 3.1278 - accuracy100: 0.4396 - val_loss: 3.2408 - val_accuracy100: 0.3796 - 119s/epoch - 14ms/step
Epoch 32/50
8543/8543 - 117s - loss: 3.1269 - accuracy100: 0.4401 - val_loss: 3.2411 - val_accuracy100: 0.3780 - 117s/epoch - 14ms/step
Epoch 33/50
8543/8543 - 116s - loss: 3.1250 - accuracy100: 0.4406 - val_loss: 3.2413 - val_accuracy100: 0.3796 - 116s/epoch - 14ms/step
Epoch 34/50
8543/8543 - 120s - loss: 3.1240 - accuracy100: 0.4410 - val_loss: 3.2403 - val_accuracy100: 0.3794 - 120s/epoch - 14ms/step
Epoch 35/50
8543/8543 - 118s - loss: 3.1229 - accuracy100: 0.4413 - val_loss: 3.2420 - val_accuracy100: 0.3822 - 118s/epoch - 14ms/step
Epoch 36/50
8543/8543 - 119s - loss: 3.1213 - accuracy100: 0.4415 - val_loss: 3.2420 - val_accuracy100: 0.3815 - 119s/epoch - 14ms/step
Epoch 37/50
8543/8543 - 117s - loss: 3.1198 - accuracy100: 0.4423 - val_loss: 3.2472 - val_accuracy100: 0.3841 - 117s/epoch - 14ms/step
Epoch 38/50
8543/8543 - 119s - loss: 3.1183 - accuracy100: 0.4430 - val_loss: 3.2472 - val_accuracy100: 0.3856 - 119s/epoch - 14ms/step
Epoch 39/50
8543/8543 - 118s - loss: 3.1164 - accuracy100: 0.4437 - val_loss: 3.2473 - val_accuracy100: 0.3868 - 118s/epoch - 14ms/step
testing model in sample: results/universal/W10/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 280s - 280s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886308
{'0': {'precision': 0.3983922818674865, 'recall': 0.49366470271750357, 'f1-score': 0.44094090577533684, 'support': 3330704}, '1': {'precision': 0.3155706033526429, 'recall': 0.2038067314909323, 'f1-score': 0.24766353442548258, 'support': 2843174}, '2': {'precision': 0.4114958477754993, 'recall': 0.43718113909572826, 'f1-score': 0.42394980951911143, 'support': 3371376}, 'accuracy': 0.387376910032986, 'macro avg': {'precision': 0.3751529109985429, 'recall': 0.3782175244347214, 'f1-score': 0.3708514165733103, 'support': 9545254}, 'weighted avg': {'precision': 0.3783509717700213, 'recall': 0.387376910032986, 'f1-score': 0.37736956748070594, 'support': 9545254}}
[[1644251  625673 1060780]
 [1216583  579458 1047133]
 [1266382  631092 1473902]]
Evaluating performance on  train set...
8543/8543 - 56s - 56s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0837991
{'0': {'precision': 0.3760235438598432, 'recall': 0.4923617841481488, 'f1-score': 0.42639970290893303, 'support': 690279}, '1': {'precision': 0.3844635082784411, 'recall': 0.25185619063300907, 'f1-score': 0.30434234488750367, 'support': 795581}, '2': {'precision': 0.3914550987666963, 'recall': 0.4254378955899391, 'f1-score': 0.4077396540006263, 'support': 700852}, 'accuracy': 0.3834103439318941, 'macro avg': {'precision': 0.38398071696832686, 'recall': 0.38988529012369905, 'f1-score': 0.379493900599021, 'support': 2186712}, 'weighted avg': {'precision': 0.38404010546086353, 'recall': 0.3834103439318941, 'f1-score': 0.3760115184797392, 'support': 2186712}}
[[339867 157418 192994]
 [324678 200372 270531]
 [239300 163383 298169]]
Evaluating performance on  val set...
3077/3077 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0846928
{'0': {'precision': 0.35791501333803255, 'recall': 0.5001231182019648, 'f1-score': 0.41723453991641285, 'support': 235546}, '1': {'precision': 0.4160360508566191, 'recall': 0.22971342187388485, 'f1-score': 0.29599424823705955, 'support': 308258}, '2': {'precision': 0.3768562914851375, 'recall': 0.44577748347639395, 'f1-score': 0.40842973960884804, 'support': 243137}, 'accuracy': 0.3774082173885971, 'macro avg': {'precision': 0.38360245189326303, 'recall': 0.39187134118408123, 'f1-score': 0.3738861759207735, 'support': 786941}, 'weighted avg': {'precision': 0.3865341859675653, 'recall': 0.3774082173885971, 'f1-score': 0.36702230981927153, 'support': 786941}}
[[117802  48679  69065]
 [127294  70811 110153]
 [ 84038  50714 108385]]
testing model out of sample: results/universal/W10/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 132s - 132s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0804802
{'0': {'precision': 0.3912592053660986, 'recall': 0.5156039532625379, 'f1-score': 0.4449068001443219, 'support': 1787688}, '1': {'precision': 0.377814120835475, 'recall': 0.214785267859989, 'f1-score': 0.27387442070628276, 'support': 1882252}, '2': {'precision': 0.40596354508360866, 'recall': 0.4612901028236006, 'f1-score': 0.43186204152879537, 'support': 1790834}, 'accuracy': 0.3941040226165741, 'macro avg': {'precision': 0.39167895709506073, 'recall': 0.3972264413153758, 'f1-score': 0.3835477541264667, 'support': 5460774}, 'weighted avg': {'precision': 0.39144708976961573, 'recall': 0.3941040226165741, 'f1-score': 0.38167637978404223, 'support': 5460774}}
[[921739 335980 529969]
 [799138 404280 678834]
 [634950 329790 826094]]
Evaluating performance on  train set...
4055/4055 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0811234
{'0': {'precision': 0.37283248028710864, 'recall': 0.5217503355029716, 'f1-score': 0.4348965087249131, 'support': 318179}, '1': {'precision': 0.4111532401024227, 'recall': 0.20938373769669613, 'f1-score': 0.27746550248814084, 'support': 398775}, '2': {'precision': 0.38477965892620347, 'recall': 0.467142148466384, 'f1-score': 0.4219795643149141, 'support': 320517}, 'accuracy': 0.38481461168553144, 'macro avg': {'precision': 0.38958845977191164, 'recall': 0.3994254072220172, 'f1-score': 0.37811385850932266, 'support': 1037471}, 'weighted avg': {'precision': 0.39125288418391024, 'recall': 0.38481461168553144, 'f1-score': 0.3703938384974768, 'support': 1037471}}
[[166010  58881  93288]
 [169169  83497 146109]
 [110088  60702 149727]]
Evaluating performance on  val set...
1545/1545 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0808461
{'0': {'precision': 0.37254844989394775, 'recall': 0.5308217760298075, 'f1-score': 0.437820118828109, 'support': 120775}, '1': {'precision': 0.4055248926024274, 'recall': 0.1964440852611375, 'f1-score': 0.2646746576896205, 'support': 148485}, '2': {'precision': 0.39453645346640953, 'recall': 0.473811134545744, 'f1-score': 0.43055515375936587, 'support': 125645}, 'accuracy': 0.38695635659209177, 'macro avg': {'precision': 0.39086993198759484, 'recall': 0.40035899861222973, 'f1-score': 0.3776833100923651, 'support': 394905}, 'weighted avg': {'precision': 0.39194346845393196, 'recall': 0.38695635659209177, 'f1-score': 0.3704056512138456, 'support': 394905}}
[[64110 20893 35772]
 [63729 29169 55587]
 [44246 21867 59532]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0932732
{'0': {'precision': 0.45596423685131565, 'recall': 0.5185165083672546, 'f1-score': 0.48523274614206025, 'support': 55275}, '1': {'precision': 0.20976528078186332, 'recall': 0.19084581465690026, 'f1-score': 0.19985879748888505, 'support': 27441}, '2': {'precision': 0.43520689578169314, 'recall': 0.3906472368658422, 'f1-score': 0.41172493926270204, 'support': 49889}, 'accuracy': 0.40260171185098603, 'macro avg': {'precision': 0.366978804471624, 'recall': 0.3666698532966657, 'f1-score': 0.3656054942978824, 'support': 132605}, 'weighted avg': {'precision': 0.3972069611669581, 'recall': 0.40260171185098603, 'f1-score': 0.39852276158343813, 'support': 132605}}
[[28661 10504 16110]
 [13022  5237  9182]
 [21175  9225 19489]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1053573
{'0': {'precision': 0.3613933236574746, 'recall': 0.45704046849051655, 'f1-score': 0.40362794287919723, 'support': 11441}, '1': {'precision': 0.3195428203477141, 'recall': 0.17578816861494864, 'f1-score': 0.22680530164533821, 'support': 11292}, '2': {'precision': 0.3662023460410557, 'recall': 0.4310493614083535, 'f1-score': 0.39598858411289045, 'support': 11588}, 'accuracy': 0.35572972815477405, 'macro avg': {'precision': 0.3490461633487481, 'recall': 0.3546259995046062, 'f1-score': 0.3421406095458086, 'support': 34321}, 'weighted avg': {'precision': 0.34924772964818357, 'recall': 0.35572972815477405, 'f1-score': 0.3428719580828131, 'support': 34321}}
[[5229 2033 4179]
 [4841 1985 4466]
 [4399 2194 4995]]
Evaluating performance on  val set...
46/46 - 0s - 414ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926236
{'0': {'precision': 0.41488118426178416, 'recall': 0.48999309868875085, 'f1-score': 0.44931969201561023, 'support': 4347}, '1': {'precision': 0.29445727482678985, 'recall': 0.15315315315315314, 'f1-score': 0.20150138285262742, 'support': 3330}, '2': {'precision': 0.3920265780730897, 'recall': 0.4714107365792759, 'f1-score': 0.4280693798889015, 'support': 4005}, 'accuracy': 0.3876048621811334, 'macro avg': {'precision': 0.367121679053888, 'recall': 0.3715189961403933, 'f1-score': 0.35963015158571304, 'support': 11682}, 'weighted avg': {'precision': 0.3727185138111548, 'recall': 0.3876048621811334, 'f1-score': 0.3713927557392705, 'support': 11682}}
[[2130  669 1548]
 [1440  510 1380]
 [1564  553 1888]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
1840/1840 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0554237
{'0': {'precision': 0.3481038574057355, 'recall': 0.5875089507252169, 'f1-score': 0.43717685399454154, 'support': 120102}, '1': {'precision': 0.5733872531368585, 'recall': 0.18077739256490644, 'f1-score': 0.27488812460993006, 'support': 229022}, '2': {'precision': 0.3704521690341996, 'recall': 0.5961112296656216, 'f1-score': 0.45693991374456183, 'support': 121838}, 'accuracy': 0.3919466963364348, 'macro avg': {'precision': 0.43064775985893117, 'recall': 0.4547991909852483, 'f1-score': 0.38966829744967785, 'support': 470962}, 'weighted avg': {'precision': 0.46343742454984066, 'recall': 0.3919466963364348, 'f1-score': 0.36337090424212093, 'support': 470962}}
[[70561 14973 34568]
 [98762 41402 88858]
 [33378 15831 72629]]
Evaluating performance on  train set...
529/529 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0498964
{'0': {'precision': 0.27804062934174456, 'recall': 0.5680693544056159, 'f1-score': 0.3733471152512889, 'support': 26069}, '1': {'precision': 0.7008620425192502, 'recall': 0.27492508935125576, 'f1-score': 0.3949315447379339, 'support': 83099}, '2': {'precision': 0.3128179249091643, 'recall': 0.5907895238458313, 'f1-score': 0.40904831663829166, 'support': 26231}, 'accuracy': 0.3925582906816151, 'macro avg': {'precision': 0.4305735322567197, 'recall': 0.47792798920090096, 'f1-score': 0.39244232554250486, 'support': 135399}, 'weighted avg': {'precision': 0.5442780450809046, 'recall': 0.39255829068161513, 'f1-score': 0.39351065205357827, 'support': 135399}}
[[14809  4909  6351]
 [32561 22846 27692]
 [ 5892  4842 15497]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0640838
{'0': {'precision': 0.30753829678260464, 'recall': 0.5329191544295627, 'f1-score': 0.39000915237223577, 'support': 12394}, '1': {'precision': 0.6014373716632444, 'recall': 0.209079877221786, 'f1-score': 0.3102918586789555, 'support': 28018}, '2': {'precision': 0.35389892522295907, 'recall': 0.6107340173638516, 'f1-score': 0.4481250904879108, 'support': 12670}, 'accuracy': 0.3805621491277646, 'macro avg': {'precision': 0.42095819788960265, 'recall': 0.4509110163384001, 'f1-score': 0.38280870051303406, 'support': 53082}, 'weighted avg': {'precision': 0.47373123303868114, 'recall': 0.3805621491277646, 'f1-score': 0.3618039189829, 'support': 53082}}
[[ 6605  2032  3757]
 [11790  5858 10370]
 [ 3082  1850  7738]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
967/967 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100226
{'0': {'precision': 0.41276715512701784, 'recall': 0.4956986316305948, 'f1-score': 0.4504475940888847, 'support': 91715}, '1': {'precision': 0.2888810105797399, 'recall': 0.21343590167776444, 'f1-score': 0.24549274557995715, 'support': 72537}, '2': {'precision': 0.39002852062673776, 'recall': 0.39244974904541197, 'f1-score': 0.391235388823385, 'support': 83282}, 'accuracy': 0.3782470286910081, 'macro avg': {'precision': 0.36389222877783184, 'recall': 0.3671947607845904, 'f1-score': 0.3623919094974089, 'support': 247534}, 'weighted avg': {'precision': 0.36881340240828736, 'recall': 0.3782470286910081, 'f1-score': 0.37046617446485963, 'support': 247534}}
[[45463 19755 26497]
 [32437 15482 24618]
 [32242 18356 32684]]
Evaluating performance on  train set...
220/220 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1047597
{'0': {'precision': 0.3596516334791675, 'recall': 0.4803145306612789, 'f1-score': 0.4113163432312369, 'support': 18313}, '1': {'precision': 0.3208405725159262, 'recall': 0.21135818617833008, 'f1-score': 0.2548381797272876, 'support': 18348}, '2': {'precision': 0.38692498858852764, 'recall': 0.389234693877551, 'f1-score': 0.38807640460869347, 'support': 19600}, 'accuracy': 0.3608716517658769, 'macro avg': {'precision': 0.3558057315278738, 'recall': 0.3603024702390533, 'f1-score': 0.3514103091890726, 'support': 56261}, 'weighted avg': {'precision': 0.3564958490741606, 'recall': 0.3608716517658769, 'f1-score': 0.35218898785233654, 'support': 56261}}
[[8796 3915 5602]
 [7984 3878 6486]
 [7677 4294 7629]]
Evaluating performance on  val set...
79/79 - 1s - 568ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1019964
{'0': {'precision': 0.37790380630384995, 'recall': 0.5067271131909915, 'f1-score': 0.43293559067907794, 'support': 6838}, '1': {'precision': 0.3212423486737701, 'recall': 0.2193498452012384, 'f1-score': 0.2606935884463251, 'support': 6460}, '2': {'precision': 0.38022046266107745, 'recall': 0.36427190242451285, 'f1-score': 0.37207535703433603, 'support': 6723}, 'accuracy': 0.36616552619749265, 'macro avg': {'precision': 0.35978887254623254, 'recall': 0.36344962027224764, 'f1-score': 0.3552348453865797, 'support': 20021}, 'weighted avg': {'precision': 0.36039927927719423, 'recall': 0.36616552619749265, 'f1-score': 0.35692306956538816, 'support': 20021}}
[[3465 1478 1895]
 [2946 1417 2097]
 [2758 1516 2449]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0972365
{'0': {'precision': 0.4133788376120398, 'recall': 0.38839115516584066, 'f1-score': 0.40049561771447223, 'support': 146888}, '1': {'precision': 0.28843623972912935, 'recall': 0.23297275641025642, 'f1-score': 0.2577546084392496, 'support': 114816}, '2': {'precision': 0.39678922601889094, 'recall': 0.4817502092310672, 'f1-score': 0.4351615533361865, 'support': 144577}, 'accuracy': 0.3776917945953663, 'macro avg': {'precision': 0.36620143445335335, 'recall': 0.3677047069357214, 'f1-score': 0.36447059316330277, 'support': 406281}, 'weighted avg': {'precision': 0.37216626406361664, 'recall': 0.3776917945953663, 'f1-score': 0.37249269671505714, 'support': 406281}}
[[57050 34433 55405]
 [37588 26749 50479]
 [43371 31556 69650]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953616
{'0': {'precision': 0.38827101415794857, 'recall': 0.4573016675088428, 'f1-score': 0.41996858713500385, 'support': 25727}, '1': {'precision': 0.3412815773259396, 'recall': 0.2228884149531206, 'f1-score': 0.26966237433363355, 'support': 24851}, '2': {'precision': 0.3712746486169147, 'recall': 0.4315937374548374, 'f1-score': 0.39916832197820556, 'support': 24910}, 'accuracy': 0.3716484739296312, 'macro avg': {'precision': 0.36694241336693434, 'recall': 0.3705946066389336, 'f1-score': 0.362933094482281, 'support': 75488}, 'weighted avg': {'precision': 0.3671933069682044, 'recall': 0.3716484739296312, 'f1-score': 0.3636232832538214, 'support': 75488}}
[[11765  5524  8438]
 [ 9544  5539  9768]
 [ 8992  5167 10751]]
Evaluating performance on  val set...
131/131 - 1s - 868ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1031178
{'0': {'precision': 0.38713982884509696, 'recall': 0.45089612289685443, 'f1-score': 0.41659274278714153, 'support': 10936}, '1': {'precision': 0.30544655470098886, 'recall': 0.16648130721190862, 'f1-score': 0.21550387596899223, 'support': 11689}, '2': {'precision': 0.33651551312649164, 'recall': 0.44682635846770435, 'f1-score': 0.3839039039039039, 'support': 10729}, 'accuracy': 0.3499130539065779, 'macro avg': {'precision': 0.3430339655575258, 'recall': 0.3547345961921558, 'f1-score': 0.33866684088667925, 'support': 33354}, 'weighted avg': {'precision': 0.34222584656964583, 'recall': 0.3499130539065779, 'f1-score': 0.3356055653386914, 'support': 33354}}
[[4931 2248 3757]
 [4048 1946 5695]
 [3758 2177 4794]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
2104/2104 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021256
{'0': {'precision': 0.42831896157713517, 'recall': 0.4722638176966346, 'f1-score': 0.44921922257806063, 'support': 208356}, '1': {'precision': 0.22565929645575664, 'recall': 0.20614601841382652, 'f1-score': 0.21546175501091025, 'support': 123820}, '2': {'precision': 0.4290123141382658, 'recall': 0.4068320573699002, 'f1-score': 0.4176278942525305, 'support': 206380}, 'accuracy': 0.3860062834691286, 'macro avg': {'precision': 0.3609968573903859, 'recall': 0.3617472978267871, 'f1-score': 0.3607696239471671, 'support': 538556}, 'weighted avg': {'precision': 0.3819909555132106, 'recall': 0.3860062834691286, 'f1-score': 0.38336967680382833, 'support': 538556}}
[[98399 43454 66503]
 [53050 25525 45245]
 [78284 44134 83962]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102469
{'0': {'precision': 0.36620299038649334, 'recall': 0.46386651639682236, 'f1-score': 0.40928935241329134, 'support': 36379}, '1': {'precision': 0.32545701285223916, 'recall': 0.22356263537411236, 'f1-score': 0.2650543663757375, 'support': 36473}, '2': {'precision': 0.38138067678189685, 'recall': 0.39925220381539805, 'f1-score': 0.39011186815824217, 'support': 36641}, 'accuracy': 0.3621966701067648, 'macro avg': {'precision': 0.3576802266735431, 'recall': 0.3622271185287776, 'f1-score': 0.35481852898242366, 'support': 109493}, 'weighted avg': {'precision': 0.3577092745197907, 'recall': 0.3621966701067648, 'f1-score': 0.3548259177979556, 'support': 109493}}
[[16875  8394 11110]
 [15700  8154 12619]
 [13506  8506 14629]]
Evaluating performance on  val set...
141/141 - 1s - 923ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100408
{'0': {'precision': 0.379377562680648, 'recall': 0.4664848334573105, 'f1-score': 0.4184460260972716, 'support': 12099}, '1': {'precision': 0.31251518833535846, 'recall': 0.22876456461798453, 'f1-score': 0.26416063267087764, 'support': 11243}, '2': {'precision': 0.39926596907699513, 'recall': 0.40672977487868905, 'f1-score': 0.40296331323639517, 'support': 12571}, 'accuracy': 0.37114693843455016, 'macro avg': {'precision': 0.36371957336433386, 'recall': 0.36732639098466136, 'f1-score': 0.3618566573348481, 'support': 35913}, 'weighted avg': {'precision': 0.3654072311027901, 'recall': 0.37114693843455016, 'f1-score': 0.36472553876212765, 'support': 35913}}
[[5644 2751 3704]
 [4682 2572 3989]
 [4551 2907 5113]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/EXC
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0542973
{'0': {'precision': 0.40848869441151403, 'recall': 0.5783093746160461, 'f1-score': 0.478786590321652, 'support': 406950}, '1': {'precision': 0.46333917549340853, 'recall': 0.23180648481729285, 'f1-score': 0.30901444598320355, 'support': 524610}, '2': {'precision': 0.43172492557786313, 'recall': 0.5280636737201889, 'f1-score': 0.4750593003583394, 'support': 416624}, 'accuracy': 0.4279497457320366, 'macro avg': {'precision': 0.4345175984942619, 'recall': 0.44605984438450924, 'f1-score': 0.42095344555439834, 'support': 1348184}, 'weighted avg': {'precision': 0.4370129036098294, 'recall': 0.4279497457320366, 'f1-score': 0.41157243921537234, 'support': 1348184}}
[[235343  68952 102655]
 [216068 121608 186934]
 [124720  71900 220004]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0418739
{'0': {'precision': 0.3778851447399775, 'recall': 0.645994577966316, 'f1-score': 0.47683677913029054, 'support': 71191}, '1': {'precision': 0.5689668246445497, 'recall': 0.2342423201798202, 'f1-score': 0.3318590431119318, 'support': 128128}, '2': {'precision': 0.4201072192209563, 'recall': 0.565322547016388, 'f1-score': 0.4820152411202105, 'support': 71943}, 'accuracy': 0.4301118475864662, 'macro avg': {'precision': 0.4556530628684945, 'recall': 0.481853148387508, 'f1-score': 0.4302370211208109, 'support': 271262}, 'weighted avg': {'precision': 0.47933870693150477, 'recall': 0.4301118475864662, 'f1-score': 0.4097313486991227, 'support': 271262}}
[[45989 10796 14406]
 [56381 30013 41734]
 [19331 11941 40671]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0503073
{'0': {'precision': 0.35946169012792883, 'recall': 0.6137555781727081, 'f1-score': 0.4533861546469261, 'support': 25546}, '1': {'precision': 0.5841490683229814, 'recall': 0.22955557291259862, 'f1-score': 0.3295905350659546, 'support': 51212}, '2': {'precision': 0.3894813806318231, 'recall': 0.5797057940558391, 'f1-score': 0.46592571368249613, 'support': 26648}, 'accuracy': 0.41470514283503856, 'macro avg': {'precision': 0.4443640463609111, 'recall': 0.4743389817137153, 'f1-score': 0.4163008011317923, 'support': 103406}, 'weighted avg': {'precision': 0.4784746557650564, 'recall': 0.41470514283503856, 'f1-score': 0.3953076379186817, 'support': 103406}}
[[15679  4079  5788]
 [21029 11756 18427]
 [ 6910  4290 15448]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/AAL
Evaluating performance on  test set...
10110/10110 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0672877
{'0': {'precision': 0.38352014843540083, 'recall': 0.5416241481337142, 'f1-score': 0.44906243157695586, 'support': 780052}, '1': {'precision': 0.45631702907068694, 'recall': 0.21041241258603427, 'f1-score': 0.28801718055909664, 'support': 1014712}, '2': {'precision': 0.4051520845728064, 'recall': 0.5201844877050213, 'f1-score': 0.4555182100656213, 'support': 793332}, 'accuracy': 0.40519439773485993, 'macro avg': {'precision': 0.41499642069296466, 'recall': 0.4240736828082566, 'f1-score': 0.397532607400558, 'support': 2588096}, 'weighted avg': {'precision': 0.4186924046047827, 'recall': 0.40519439773485993, 'f1-score': 0.3879004912583339, 'support': 2588096}}
[[422495 129465 228092]
 [423397 213508 377807]
 [255732 124921 412679]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.066079
{'0': {'precision': 0.3603908863986404, 'recall': 0.5756434400502197, 'f1-score': 0.4432671831519538, 'support': 117882}, '1': {'precision': 0.5111338824734954, 'recall': 0.19747240197944424, 'f1-score': 0.284882699235568, 'support': 197025}, '2': {'precision': 0.3711121879430715, 'recall': 0.5317549438963132, 'f1-score': 0.4371423739324069, 'support': 116659}, 'accuracy': 0.3911313680873841, 'macro avg': {'precision': 0.41421231893840244, 'recall': 0.43495692864199237, 'f1-score': 0.38843075210664296, 'support': 431566}, 'weighted avg': {'precision': 0.43210848027424714, 'recall': 0.3911313680873841, 'f1-score': 0.369303485681882, 'support': 431566}}
[[67858 18562 31462]
 [84457 38907 73661]
 [35975 18650 62034]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0678179
{'0': {'precision': 0.3793098946433933, 'recall': 0.5525464988018713, 'f1-score': 0.44982543602288294, 'support': 52582}, '1': {'precision': 0.4408923126303964, 'recall': 0.18934193477242026, 'f1-score': 0.26491547815353755, 'support': 72546}, '2': {'precision': 0.40429660620406815, 'recall': 0.531364178996491, 'f1-score': 0.4592021758839529, 'support': 55286}, 'accuracy': 0.4000077599299389, 'macro avg': {'precision': 0.408166271159286, 'recall': 0.4244175375235942, 'f1-score': 0.39131436335345776, 'support': 180414}, 'weighted avg': {'precision': 0.41172962609787356, 'recall': 0.4000077599299389, 'f1-score': 0.3783449779451815, 'support': 180414}}
[[29054  8666 14862]
 [30387 13736 28423]
 [17156  8753 29377]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/WBA
Evaluating performance on  test set...
6546/6546 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0858141
{'0': {'precision': 0.38475544704772063, 'recall': 0.5409254465348033, 'f1-score': 0.4496668634814639, 'support': 554716}, '1': {'precision': 0.3739379639287486, 'recall': 0.19239305996978065, 'f1-score': 0.25406720127701, 'support': 575790}, '2': {'precision': 0.3929408233204646, 'recall': 0.43213487926816296, 'f1-score': 0.41160692215847106, 'support': 545258}, 'accuracy': 0.3857721015608403, 'macro avg': {'precision': 0.38387807809897795, 'recall': 0.38848446192424896, 'f1-score': 0.37178032897231494, 'support': 1675764}, 'weighted avg': {'precision': 0.38370192357463667, 'recall': 0.3857721015608403, 'f1-score': 0.37007521633628415, 'support': 1675764}}
[[300060  91380 163276]
 [264268 110778 200744]
 [215544  94089 235625]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786922
{'0': {'precision': 0.40873140967712557, 'recall': 0.5410422848664689, 'f1-score': 0.4656708794081145, 'support': 107840}, '1': {'precision': 0.35985204999917436, 'recall': 0.2147283995625228, 'f1-score': 0.26896304889788464, 'support': 101491}, '2': {'precision': 0.4170090975973012, 'recall': 0.4408224816715195, 'f1-score': 0.42858526014892, 'support': 105437}, 'accuracy': 0.4022581710974432, 'macro avg': {'precision': 0.39519751909120043, 'recall': 0.3988643887001704, 'f1-score': 0.3877397294849731, 'support': 314768}, 'weighted avg': {'precision': 0.39574393791431806, 'recall': 0.4022581710974432, 'f1-score': 0.38982368126807027, 'support': 314768}}
[[58346 18929 30565]
 [45284 21793 34414]
 [39119 19839 46479]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0775754
{'0': {'precision': 0.3821218264311227, 'recall': 0.5476631893522234, 'f1-score': 0.4501557986671822, 'support': 36139}, '1': {'precision': 0.42071881606765327, 'recall': 0.2127533201872134, 'f1-score': 0.2825990911386014, 'support': 42091}, '2': {'precision': 0.3905878271213323, 'recall': 0.4477302425998523, 'f1-score': 0.41721153082563467, 'support': 35202}, 'accuracy': 0.3923760490866775, 'macro avg': {'precision': 0.39780948987336945, 'recall': 0.40271558404642965, 'f1-score': 0.38332214021047273, 'support': 113432}, 'weighted avg': {'precision': 0.399071241473509, 'recall': 0.3923760490866775, 'f1-score': 0.37775706203956694, 'support': 113432}}
[[19792  5960 10387]
 [18932  8955 14204]
 [13071  6370 15761]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
7633/7633 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0885785
{'0': {'precision': 0.38388872341972385, 'recall': 0.5018902635330911, 'f1-score': 0.43502953987950166, 'support': 652290}, '1': {'precision': 0.3535846253103678, 'recall': 0.22475463772753682, 'f1-score': 0.2748206440289705, 'support': 643742}, '2': {'precision': 0.40028208214775496, 'recall': 0.42099487651816014, 'f1-score': 0.4103772886066722, 'support': 657951}, 'accuracy': 0.38334826863897997, 'macro avg': {'precision': 0.3792518102926155, 'recall': 0.3825465925929293, 'f1-score': 0.37340915750504805, 'support': 1953983}, 'weighted avg': {'precision': 0.37942502339948503, 'recall': 0.38334826863897997, 'f1-score': 0.3739475507271794, 'support': 1953983}}
[[327378 131913 192999]
 [277054 144684 222004]
 [248362 132595 276994]]
Evaluating performance on  train set...
1586/1586 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.086063
{'0': {'precision': 0.3914170624102674, 'recall': 0.5019155660236725, 'f1-score': 0.43983239876813746, 'support': 134164}, '1': {'precision': 0.36507500149405364, 'recall': 0.22518929200734314, 'f1-score': 0.27855651111252977, 'support': 135637}, '2': {'precision': 0.4029348680441762, 'recall': 0.44469194068911777, 'f1-score': 0.42278485436214636, 'support': 136029}, 'accuracy': 0.390247147820516, 'macro avg': {'precision': 0.38647564398283246, 'recall': 0.39059893290671116, 'f1-score': 0.38039125474760455, 'support': 405830}, 'weighted avg': {'precision': 0.3864736069389679, 'recall': 0.390247147820516, 'f1-score': 0.3802164561519035, 'support': 405830}}
[[67339 26054 40771]
 [56229 30544 48864]
 [48471 27067 60491]]
Evaluating performance on  val set...
574/574 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886567
{'0': {'precision': 0.35897474602623514, 'recall': 0.5295375091852412, 'f1-score': 0.4278851344057001, 'support': 44909}, '1': {'precision': 0.411831283482985, 'recall': 0.19881251593632754, 'f1-score': 0.26816685500908954, 'support': 54906}, '2': {'precision': 0.38344850522892726, 'recall': 0.44099022524436887, 'f1-score': 0.41021130240556625, 'support': 47060}, 'accuracy': 0.37753191489361704, 'macro avg': {'precision': 0.3847515115793825, 'recall': 0.3897800834553125, 'f1-score': 0.3687544306067853, 'support': 146875}, 'weighted avg': {'precision': 0.3865756049449007, 'recall': 0.37753191489361704, 'f1-score': 0.3625151096739445, 'support': 146875}}
[[23781  7382 13746]
 [24367 10916 19623]
 [18099  8208 20753]]
testing model on single stock: results/universal/W10/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
22048/22048 - 140s - 140s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998409
{'0': {'precision': 0.4037018741755984, 'recall': 0.4669370061958623, 'f1-score': 0.43302303348269283, 'support': 2102048}, '1': {'precision': 0.2503393381264937, 'recall': 0.19894262496640303, 'f1-score': 0.22170115495573073, 'support': 1398936}, '2': {'precision': 0.41717518684874233, 'recall': 0.4089900558962129, 'f1-score': 0.41304207478128513, 'support': 2143079}, 'accuracy': 0.37850924059494023, 'macro avg': {'precision': 0.35707213305027813, 'recall': 0.3582898956861594, 'f1-score': 0.3559220877399029, 'support': 5644063}, 'weighted avg': {'precision': 0.37080535985955665, 'recall': 0.37850924059494023, 'f1-score': 0.37305797702392396, 'support': 5644063}}
[[981524 415872 704652]
 [600747 278308 519881]
 [849038 417543 876498]]
Evaluating performance on  train set...
5429/5429 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0960217
{'0': {'precision': 0.37619056195965417, 'recall': 0.454587203886369, 'f1-score': 0.4116899193023815, 'support': 459452}, '1': {'precision': 0.3359668693178649, 'recall': 0.2630302262822808, 'f1-score': 0.2950579971393303, 'support': 458012}, '2': {'precision': 0.3892041217188534, 'recall': 0.3922397640637604, 'f1-score': 0.3907160466749477, 'support': 472331}, 'accuracy': 0.3702697160372573, 'macro avg': {'precision': 0.3671205176654575, 'recall': 0.36995239807747, 'f1-score': 0.36582132103888654, 'support': 1389795}, 'weighted avg': {'precision': 0.36735744180910757, 'recall': 0.3702697160372573, 'f1-score': 0.36612533591725505, 'support': 1389795}}
[[208861 116801 133790]
 [180583 120471 156958]
 [165756 121308 185267]]
Evaluating performance on  val set...
1890/1890 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946927
{'0': {'precision': 0.354409184338497, 'recall': 0.4696308401591699, 'f1-score': 0.40396456010125686, 'support': 150531}, '1': {'precision': 0.37402296804059465, 'recall': 0.23974025381174108, 'f1-score': 0.29219203137931277, 'support': 175248}, '2': {'precision': 0.37625605846381216, 'recall': 0.4095688082691528, 'f1-score': 0.39220633500629254, 'support': 157888}, 'accuracy': 0.36672752120777313, 'macro avg': {'precision': 0.3682294036143013, 'recall': 0.37297996741335465, 'f1-score': 0.36278764216228737, 'support': 483667}, 'weighted avg': {'precision': 0.3686475665893493, 'recall': 0.36672752120777313, 'f1-score': 0.35962745470176305, 'support': 483667}}
[[70694 34412 45425]
 [71458 42014 61776]
 [57318 35904 64666]]
training model: results/universal/W10/deepOF_L1/h200
Epoch 1/50
8543/8543 - 134s - loss: 3.2602 - accuracy200: 0.3872 - val_loss: 3.2755 - val_accuracy200: 0.3653 - 134s/epoch - 16ms/step
Epoch 2/50
8543/8543 - 119s - loss: 3.2538 - accuracy200: 0.3894 - val_loss: 3.2738 - val_accuracy200: 0.3657 - 119s/epoch - 14ms/step
Epoch 3/50
8543/8543 - 122s - loss: 3.2502 - accuracy200: 0.3914 - val_loss: 3.2723 - val_accuracy200: 0.3682 - 122s/epoch - 14ms/step
Epoch 4/50
8543/8543 - 119s - loss: 3.2475 - accuracy200: 0.3930 - val_loss: 3.2715 - val_accuracy200: 0.3688 - 119s/epoch - 14ms/step
Epoch 5/50
8543/8543 - 120s - loss: 3.2450 - accuracy200: 0.3943 - val_loss: 3.2709 - val_accuracy200: 0.3708 - 120s/epoch - 14ms/step
Epoch 6/50
8543/8543 - 117s - loss: 3.2421 - accuracy200: 0.3961 - val_loss: 3.2705 - val_accuracy200: 0.3702 - 117s/epoch - 14ms/step
Epoch 7/50
8543/8543 - 120s - loss: 3.2396 - accuracy200: 0.3976 - val_loss: 3.2699 - val_accuracy200: 0.3702 - 120s/epoch - 14ms/step
Epoch 8/50
8543/8543 - 121s - loss: 3.2377 - accuracy200: 0.3981 - val_loss: 3.2692 - val_accuracy200: 0.3712 - 121s/epoch - 14ms/step
Epoch 9/50
8543/8543 - 120s - loss: 3.2361 - accuracy200: 0.3992 - val_loss: 3.2688 - val_accuracy200: 0.3715 - 120s/epoch - 14ms/step
Epoch 10/50
8543/8543 - 120s - loss: 3.2343 - accuracy200: 0.4002 - val_loss: 3.2678 - val_accuracy200: 0.3729 - 120s/epoch - 14ms/step
Epoch 11/50
8543/8543 - 120s - loss: 3.2333 - accuracy200: 0.4005 - val_loss: 3.2681 - val_accuracy200: 0.3730 - 120s/epoch - 14ms/step
Epoch 12/50
8543/8543 - 122s - loss: 3.2318 - accuracy200: 0.4012 - val_loss: 3.2672 - val_accuracy200: 0.3732 - 122s/epoch - 14ms/step
Epoch 13/50
8543/8543 - 121s - loss: 3.2304 - accuracy200: 0.4016 - val_loss: 3.2673 - val_accuracy200: 0.3722 - 121s/epoch - 14ms/step
Epoch 14/50
8543/8543 - 119s - loss: 3.2293 - accuracy200: 0.4021 - val_loss: 3.2677 - val_accuracy200: 0.3718 - 119s/epoch - 14ms/step
Epoch 15/50
8543/8543 - 120s - loss: 3.2281 - accuracy200: 0.4026 - val_loss: 3.2678 - val_accuracy200: 0.3709 - 120s/epoch - 14ms/step
Epoch 16/50
8543/8543 - 120s - loss: 3.2273 - accuracy200: 0.4031 - val_loss: 3.2673 - val_accuracy200: 0.3713 - 120s/epoch - 14ms/step
Epoch 17/50
8543/8543 - 116s - loss: 3.2260 - accuracy200: 0.4036 - val_loss: 3.2682 - val_accuracy200: 0.3706 - 116s/epoch - 14ms/step
Epoch 18/50
8543/8543 - 119s - loss: 3.2254 - accuracy200: 0.4040 - val_loss: 3.2674 - val_accuracy200: 0.3716 - 119s/epoch - 14ms/step
Epoch 19/50
8543/8543 - 117s - loss: 3.2243 - accuracy200: 0.4046 - val_loss: 3.2676 - val_accuracy200: 0.3714 - 117s/epoch - 14ms/step
Epoch 20/50
8543/8543 - 120s - loss: 3.2233 - accuracy200: 0.4049 - val_loss: 3.2690 - val_accuracy200: 0.3689 - 120s/epoch - 14ms/step
Epoch 21/50
8543/8543 - 120s - loss: 3.2223 - accuracy200: 0.4055 - val_loss: 3.2687 - val_accuracy200: 0.3698 - 120s/epoch - 14ms/step
Epoch 22/50
8543/8543 - 119s - loss: 3.2213 - accuracy200: 0.4058 - val_loss: 3.2681 - val_accuracy200: 0.3703 - 119s/epoch - 14ms/step
testing model in sample: results/universal/W10/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 228s - 228s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003329
{'0': {'precision': 0.4053955111802022, 'recall': 0.38018100147326783, 'f1-score': 0.3923836035083777, 'support': 3439972}, '1': {'precision': 0.28182202624422, 'recall': 0.504578057777013, 'f1-score': 0.3616510565816558, 'support': 2656039}, '2': {'precision': 0.4241330579410805, 'recall': 0.19229494703620476, 'f1-score': 0.2646169325681074, 'support': 3449243}, 'accuracy': 0.3469015072830959, 'macro avg': {'precision': 0.3704501984551676, 'recall': 0.35901800209549517, 'f1-score': 0.339550530886047, 'support': 9545254}, 'weighted avg': {'precision': 0.37778119695097906, 'recall': 0.3469015072830959, 'f1-score': 0.3376626774250347, 'support': 9545254}}
[[1307812 1666486  465674]
 [ 880976 1340179  434884]
 [1037227 1748744  663272]]
Evaluating performance on  train set...
8543/8543 - 50s - 50s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913242
{'0': {'precision': 0.3827962950703915, 'recall': 0.3861272367851782, 'f1-score': 0.3844545511838945, 'support': 718833}, '1': {'precision': 0.34478597805169814, 'recall': 0.4908733524509606, 'f1-score': 0.4050603942219297, 'support': 742770}, '2': {'precision': 0.40407879467213015, 'recall': 0.22521303693651576, 'f1-score': 0.2892261044518122, 'support': 725109}, 'accuracy': 0.36834800376089766, 'macro avg': {'precision': 0.3772203559314066, 'recall': 0.3674045420575515, 'f1-score': 0.3595803499525454, 'support': 2186712}, 'weighted avg': {'precision': 0.3769423960803746, 'recall': 0.36834800376089766, 'f1-score': 0.3598762794461933, 'support': 2186712}}
[[277561 335404 105868]
 [243197 364606 134967]
 [204330 357475 163304]]
Evaluating performance on  val set...
3077/3077 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0892812
{'0': {'precision': 0.36588211023799255, 'recall': 0.39457642476043314, 'f1-score': 0.37968790748547165, 'support': 247217}, '1': {'precision': 0.3685285164246545, 'recall': 0.4887413445679581, 'f1-score': 0.42020635700517783, 'support': 284359}, '2': {'precision': 0.3987362100265326, 'recall': 0.22362892330585632, 'f1-score': 0.28654866590564115, 'support': 255365}, 'accuracy': 0.37312962471138245, 'macro avg': {'precision': 0.37771561222972655, 'recall': 0.3689822308780825, 'f1-score': 0.3621476434654302, 'support': 786941}, 'weighted avg': {'precision': 0.37749964777807943, 'recall': 0.37312962471138245, 'f1-score': 0.3641051425271593, 'support': 786941}}
[[ 97546 113466  36205]
 [ 95473 138978  49908]
 [ 73586 124672  57107]]
testing model out of sample: results/universal/W10/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 118s - 118s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972339
{'0': {'precision': 0.4165516999792739, 'recall': 0.36396005945986204, 'f1-score': 0.38848404180740725, 'support': 1960314}, '1': {'precision': 0.28756846125629376, 'recall': 0.5277634966426937, 'f1-score': 0.37228550939636623, 'support': 1546329}, '2': {'precision': 0.4400784580897543, 'recall': 0.20494480666853962, 'f1-score': 0.2796543921434858, 'support': 1954131}, 'accuracy': 0.35344092247728987, 'macro avg': {'precision': 0.3813995397751073, 'recall': 0.36555612092369844, 'f1-score': 0.3468079811157531, 'support': 5460774}, 'weighted avg': {'precision': 0.38844649818955035, 'recall': 0.35344092247728987, 'f1-score': 0.34495254745293646, 'support': 5460774}}
[[ 713476  990757  256081]
 [ 476763  816096  253470]
 [ 522576 1031066  400489]]
Evaluating performance on  train set...
4055/4055 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910014
{'0': {'precision': 0.3866395694113375, 'recall': 0.38252293857069597, 'f1-score': 0.3845702376912737, 'support': 345161}, '1': {'precision': 0.3385653338236704, 'recall': 0.4973448733642523, 'f1-score': 0.40287516919434974, 'support': 348006}, '2': {'precision': 0.40952092308358407, 'recall': 0.21977090013476464, 'f1-score': 0.28603830073562214, 'support': 344304}, 'accuracy': 0.36702616265900445, 'macro avg': {'precision': 0.3782419421061973, 'recall': 0.36654623735657105, 'f1-score': 0.3578279025404152, 'support': 1037471}, 'weighted avg': {'precision': 0.37810730119839225, 'recall': 0.36702616265900445, 'f1-score': 0.35801073479536705, 'support': 1037471}}
[[132032 164029  49100]
 [114923 173079  60004]
 [ 94531 174105  75668]]
Evaluating performance on  val set...
1545/1545 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910438
{'0': {'precision': 0.38151399991263707, 'recall': 0.40560371517027866, 'f1-score': 0.3931902250166943, 'support': 129200}, '1': {'precision': 0.3404704496110499, 'recall': 0.4738380479509255, 'f1-score': 0.3962327636557556, 'support': 131718}, '2': {'precision': 0.4202308946156022, 'recall': 0.2328210945838029, 'f1-score': 0.2996350014407838, 'support': 133987}, 'accuracy': 0.3697395576151226, 'macro avg': {'precision': 0.3807384480464297, 'recall': 0.37075428590166903, 'f1-score': 0.3630193300377446, 'support': 394905}, 'weighted avg': {'precision': 0.3809604141437603, 'recall': 0.3697395576151226, 'f1-score': 0.362462767433717, 'support': 394905}}
[[52404 57337 19459]
 [45726 62413 23579]
 [39228 63564 31195]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024569
{'0': {'precision': 0.4159221874154001, 'recall': 0.41394507419025806, 'f1-score': 0.41493127562093074, 'support': 51961}, '1': {'precision': 0.28310249307479224, 'recall': 0.47187593362122815, 'f1-score': 0.3538889284950452, 'support': 36819}, '2': {'precision': 0.38911940986629784, 'recall': 0.17332572732458643, 'f1-score': 0.239825719066713, 'support': 43825}, 'accuracy': 0.350507145281098, 'macro avg': {'precision': 0.36271469678549667, 'recall': 0.3530489117120242, 'f1-score': 0.336215307727563, 'support': 132605}, 'weighted avg': {'precision': 0.37018545009768017, 'recall': 0.350507145281098, 'f1-score': 0.3401111768703815, 'support': 132605}}
[[21509 23620  6832]
 [14352 17374  5093]
 [15853 20376  7596]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1006423
{'0': {'precision': 0.35342715115872014, 'recall': 0.4378523722786018, 'f1-score': 0.3911359057802572, 'support': 11529}, '1': {'precision': 0.32936481093147535, 'recall': 0.4312666076173605, 'f1-score': 0.37348981705212286, 'support': 11290}, '2': {'precision': 0.38039961941008565, 'recall': 0.1737958615892888, 'f1-score': 0.23858685922301126, 'support': 11502}, 'accuracy': 0.3471926808659421, 'macro avg': {'precision': 0.354397193833427, 'recall': 0.3476382804950837, 'f1-score': 0.33440419401846383, 'support': 34321}, 'weighted avg': {'precision': 0.35455105514349944, 'recall': 0.3471926808659421, 'f1-score': 0.33420739334640975, 'support': 34321}}
[[5048 4816 1665]
 [4830 4869 1591]
 [4405 5098 1999]]
Evaluating performance on  val set...
46/46 - 1s - 771ms/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977901
{'0': {'precision': 0.40728338216827126, 'recall': 0.4432801822323462, 'f1-score': 0.42452006980802787, 'support': 4390}, '1': {'precision': 0.2907112320248737, 'recall': 0.4370435290680689, 'f1-score': 0.3491655969191271, 'support': 3423}, '2': {'precision': 0.3981797497155859, 'recall': 0.18092530369604548, 'f1-score': 0.2488004265150169, 'support': 3869}, 'accuracy': 0.35456257490155796, 'macro avg': {'precision': 0.3653914546362436, 'recall': 0.3537496716654869, 'f1-score': 0.34082869774739066, 'support': 11682}, 'weighted avg': {'precision': 0.3701109438956904, 'recall': 0.35456257490155796, 'f1-score': 0.3442429202960123, 'support': 11682}}
[[1946 1904  540]
 [1409 1496  518]
 [1423 1746  700]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
1840/1840 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0800173
{'0': {'precision': 0.4009112728549964, 'recall': 0.5349833350692637, 'f1-score': 0.458344022933375, 'support': 153616}, '1': {'precision': 0.3524983896199503, 'recall': 0.36251277586402697, 'f1-score': 0.3574354524162771, 'support': 158502}, '2': {'precision': 0.4466684147656091, 'recall': 0.2895482360051371, 'f1-score': 0.35134237031774596, 'support': 158844}, 'accuracy': 0.39415918906408587, 'macro avg': {'precision': 0.4000260257468519, 'recall': 0.39568144897947594, 'f1-score': 0.3890406152224661, 'support': 470962}, 'weighted avg': {'precision': 0.40005071219644667, 'recall': 0.39415918906408587, 'f1-score': 0.38829425086646085, 'support': 470962}}
[[82182 47770 23664]
 [67731 57459 33312]
 [55075 57776 45993]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0675409
{'0': {'precision': 0.3546224205912375, 'recall': 0.4967756406661807, 'f1-score': 0.4138317626037908, 'support': 35666}, '1': {'precision': 0.4999221143361545, 'recall': 0.4521886154424197, 'f1-score': 0.4748588197578358, 'support': 63876}, '2': {'precision': 0.3849018402689902, 'recall': 0.2969015812812003, 'f1-score': 0.3352226210718559, 'support': 35857}, 'accuracy': 0.42280962193221516, 'macro avg': {'precision': 0.41314879173212743, 'recall': 0.41528861246326687, 'f1-score': 0.4079710678111608, 'support': 135399}, 'weighted avg': {'precision': 0.4311879224711295, 'recall': 0.42280962193221516, 'f1-score': 0.42180432011796143, 'support': 135399}}
[[17718 13275  4673]
 [22652 28884 12340]
 [ 9593 15618 10646]]
Evaluating performance on  val set...
208/208 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.075123
{'0': {'precision': 0.3746212796292996, 'recall': 0.5308751104937492, 'f1-score': 0.43926649600334366, 'support': 15838}, '1': {'precision': 0.4368259622044128, 'recall': 0.4130028063610851, 'f1-score': 0.4245804683367793, 'support': 21380}, '2': {'precision': 0.42929777436684574, 'recall': 0.2820852244074634, 'f1-score': 0.3404595252586731, 'support': 15864}, 'accuracy': 0.4090463810707961, 'macro avg': {'precision': 0.41358167206685276, 'recall': 0.4086543804207659, 'f1-score': 0.40143549653293203, 'support': 53082}, 'weighted avg': {'precision': 0.41601617857757495, 'recall': 0.4090463810707961, 'f1-score': 0.403822069353922, 'support': 53082}}
[[8408 5266 2164]
 [8765 8830 3785]
 [5271 6118 4475]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
967/967 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062137
{'0': {'precision': 0.43145823749753565, 'recall': 0.2710720257632997, 'f1-score': 0.33295721077654516, 'support': 96882}, '1': {'precision': 0.27041222449858415, 'recall': 0.6147285671907445, 'f1-score': 0.3756015334003969, 'support': 67420}, '2': {'precision': 0.3825748502994012, 'recall': 0.15352268358323723, 'f1-score': 0.21911653748542426, 'support': 83232}, 'accuracy': 0.3251472524986467, 'macro avg': {'precision': 0.3614817707651737, 'recall': 0.34644109217909386, 'f1-score': 0.30922509388745545, 'support': 247534}, 'weighted avg': {'precision': 0.3711578978283814, 'recall': 0.3251472524986467, 'f1-score': 0.3062937759026835, 'support': 247534}}
[[26262 59125 11495]
 [16848 41445  9127]
 [17758 52696 12778]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1018714
{'0': {'precision': 0.3448592612033331, 'recall': 0.2943218725501176, 'f1-score': 0.3175926765159068, 'support': 17858}, '1': {'precision': 0.33121689844209745, 'recall': 0.5751008335574079, 'f1-score': 0.42034511222043164, 'support': 18595}, '2': {'precision': 0.3881827550669873, 'recall': 0.17114297253634894, 'f1-score': 0.23755299393854457, 'support': 19808}, 'accuracy': 0.3437549990224134, 'macro avg': {'precision': 0.354752971570806, 'recall': 0.3468552262146248, 'f1-score': 0.325163594224961, 'support': 56261}, 'weighted avg': {'precision': 0.3556033295794033, 'recall': 0.3437549990224134, 'f1-score': 0.3233738661398603, 'support': 56261}}
[[ 5256 10185  2417]
 [ 4975 10694  2926]
 [ 5010 11408  3390]]
Evaluating performance on  val set...
79/79 - 1s - 575ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1018132
{'0': {'precision': 0.3708756345177665, 'recall': 0.3378612716763006, 'f1-score': 0.35359951603145795, 'support': 6920}, '1': {'precision': 0.3254178463786647, 'recall': 0.5525744416873449, 'f1-score': 0.409610852445824, 'support': 6448}, '2': {'precision': 0.37897398843930635, 'recall': 0.15767323012174958, 'f1-score': 0.2226939815306231, 'support': 6653}, 'accuracy': 0.3471355077168973, 'macro avg': {'precision': 0.3584224897785792, 'recall': 0.3493696478284651, 'f1-score': 0.32863478333596835, 'support': 20021}, 'weighted avg': {'precision': 0.35892650763694517, 'recall': 0.3471355077168973, 'f1-score': 0.32813857882381486, 'support': 20021}}
[[2338 3715  867]
 [2033 3563  852]
 [1933 3671 1049]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1588/1588 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1078081
{'0': {'precision': 0.4046249615375512, 'recall': 0.23440445910091254, 'f1-score': 0.2968435949417643, 'support': 145859}, '1': {'precision': 0.28405924101398133, 'recall': 0.6249066499939214, 'f1-score': 0.390576831227476, 'support': 115158}, '2': {'precision': 0.40100810870041637, 'recall': 0.1889456437933693, 'f1-score': 0.25686330477424907, 'support': 145264}, 'accuracy': 0.32883644571121956, 'macro avg': {'precision': 0.36323077041731633, 'recall': 0.3494189176294011, 'f1-score': 0.31476124364782976, 'support': 406281}, 'weighted avg': {'precision': 0.3691581153040655, 'recall': 0.32883644571121956, 'f1-score': 0.3091169603053822, 'support': 406281}}
[[34190 91030 20639]
 [22836 71963 20359]
 [27472 90345 27447]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988566
{'0': {'precision': 0.37587128557203503, 'recall': 0.28927519864477874, 'f1-score': 0.32693622646670006, 'support': 24793}, '1': {'precision': 0.32860656282542705, 'recall': 0.5941907051282052, 'f1-score': 0.4231806314467921, 'support': 24960}, '2': {'precision': 0.3789249600851517, 'recall': 0.16599961142413056, 'f1-score': 0.2308627631116755, 'support': 25735}, 'accuracy': 0.3480685671894871, 'macro avg': {'precision': 0.3611342694942046, 'recall': 0.34982183839903813, 'f1-score': 0.32699320700838924, 'support': 75488}, 'weighted avg': {'precision': 0.3612843159058593, 'recall': 0.3480685671894871, 'f1-score': 0.3260064067451753, 'support': 75488}}
[[ 7172 14716  2905]
 [ 6032 14831  4097]
 [ 5877 15586  4272]]
Evaluating performance on  val set...
131/131 - 1s - 821ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980942
{'0': {'precision': 0.37831672469684235, 'recall': 0.30118524182756645, 'f1-score': 0.33537331701346385, 'support': 10462}, '1': {'precision': 0.3724375280562622, 'recall': 0.6228209191759112, 'f1-score': 0.46613396591547535, 'support': 11989}, '2': {'precision': 0.3671623794212219, 'recall': 0.16756855911217097, 'f1-score': 0.2301152465520499, 'support': 10903}, 'accuracy': 0.37311866642681535, 'macro avg': {'precision': 0.37263887739144214, 'recall': 0.36385824003854955, 'f1-score': 0.34387417649366303, 'support': 33354}, 'weighted avg': {'precision': 0.37255725011916035, 'recall': 0.37311866642681535, 'f1-score': 0.3479673290493642, 'support': 33354}}
[[3151 6007 1304]
 [2677 7467 1845]
 [2501 6575 1827]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
2104/2104 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130766
{'0': {'precision': 0.4302846260744248, 'recall': 0.279242437979262, 'f1-score': 0.33868680730387474, 'support': 209567}, '1': {'precision': 0.23308514688352297, 'recall': 0.5971602628675589, 'f1-score': 0.3352964941419401, 'support': 125082}, '2': {'precision': 0.41953833972836346, 'recall': 0.16891033657500723, 'f1-score': 0.24085146257718473, 'support': 203907}, 'accuracy': 0.31130653079716875, 'macro avg': {'precision': 0.36096937089543707, 'recall': 0.3484376791406094, 'f1-score': 0.3049449213409999, 'support': 538556}, 'weighted avg': {'precision': 0.38041544205990685, 'recall': 0.31130653079716875, 'f1-score': 0.30085716881111574, 'support': 538556}}
[[ 58520 122245  28802]
 [ 31537  74694  18851]
 [ 45946 123519  34442]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1002831
{'0': {'precision': 0.3634199211115454, 'recall': 0.27944913517501435, 'f1-score': 0.3159504464147796, 'support': 36597}, '1': {'precision': 0.32395897569050014, 'recall': 0.5536818749133269, 'f1-score': 0.408755387655231, 'support': 36055}, '2': {'precision': 0.37511403953370503, 'recall': 0.20089031242365843, 'f1-score': 0.2616534973749801, 'support': 36841}, 'accuracy': 0.34331875097038167, 'macro avg': {'precision': 0.35416431211191685, 'recall': 0.3446737741706665, 'f1-score': 0.3287864438149969, 'support': 109493}, 'weighted avg': {'precision': 0.3543605166713985, 'recall': 0.34331875097038167, 'f1-score': 0.3282409878818069, 'support': 109493}}
[[10227 20502  5868]
 [ 9631 19963  6461]
 [ 8283 21157  7401]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1007537
{'0': {'precision': 0.3826239578762615, 'recall': 0.2864416522953108, 'f1-score': 0.32761940543840695, 'support': 12177}, '1': {'precision': 0.29452532907858, 'recall': 0.5365122615803815, 'f1-score': 0.38028713062512065, 'support': 11010}, '2': {'precision': 0.39400682391336594, 'recall': 0.2087065849442087, 'f1-score': 0.27287203986233116, 'support': 12726}, 'accuracy': 0.33556093893576144, 'macro avg': {'precision': 0.3570520369560691, 'recall': 0.34388683293996697, 'f1-score': 0.3269261919752862, 'support': 35913}, 'weighted avg': {'precision': 0.35964878036744075, 'recall': 0.33556093893576144, 'f1-score': 0.3243658950099988, 'support': 35913}}
[[3488 6824 1865]
 [2883 5907 2220]
 [2745 7325 2656]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/EXC
Evaluating performance on  test set...
5267/5267 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0873321
{'0': {'precision': 0.4575646115759212, 'recall': 0.38998319467208864, 'f1-score': 0.42107951357036527, 'support': 481990}, '1': {'precision': 0.28543202291675673, 'recall': 0.5228094613787829, 'f1-score': 0.36926231840581986, 'support': 366120}, '2': {'precision': 0.49712499344033706, 'recall': 0.2652087491051324, 'f1-score': 0.34589023232523447, 'support': 500074}, 'accuracy': 0.3797723456145452, 'macro avg': {'precision': 0.41337387597767167, 'recall': 0.3926671350520013, 'f1-score': 0.37874402143380653, 'support': 1348184}, 'weighted avg': {'precision': 0.42549327342072324, 'recall': 0.3797723456145452, 'f1-score': 0.3791182411305344, 'support': 1348184}}
[[187968 228897  65125]
 [105676 191411  69033]
 [117157 250293 132624]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0744814
{'0': {'precision': 0.4382703829122167, 'recall': 0.4666045459083497, 'f1-score': 0.45199385349394483, 'support': 90147}, '1': {'precision': 0.35060590052666124, 'recall': 0.48605763362590293, 'f1-score': 0.40736728060671723, 'support': 90121}, '2': {'precision': 0.49180718584281713, 'recall': 0.27212783260434753, 'f1-score': 0.35038169559157506, 'support': 90994}, 'accuracy': 0.40783080564177804, 'macro avg': {'precision': 0.42689448976056504, 'recall': 0.4082633373795334, 'f1-score': 0.4032476098974123, 'support': 271262}, 'weighted avg': {'precision': 0.42710448805336587, 'recall': 0.40783080564177804, 'f1-score': 0.4030821442558722, 'support': 271262}}
[[42063 37900 10184]
 [30914 43804 15403]
 [22998 43234 24762]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0737909
{'0': {'precision': 0.4205906289966283, 'recall': 0.44512120093515445, 'f1-score': 0.4325083692013391, 'support': 32508}, '1': {'precision': 0.36682490569236637, 'recall': 0.47947368421052633, 'f1-score': 0.41565209038733997, 'support': 36100}, '2': {'precision': 0.4728639530619729, 'recall': 0.2964538191850106, 'f1-score': 0.36443282580280495, 'support': 34798}, 'accuracy': 0.4070846952788039, 'macro avg': {'precision': 0.42009316258365587, 'recall': 0.40701623477689713, 'f1-score': 0.4041977617971613, 'support': 103406}, 'weighted avg': {'precision': 0.4194114374559247, 'recall': 0.4070846952788039, 'f1-score': 0.40371502621962085, 'support': 103406}}
[[14470 13639  4399]
 [11690 17309  7101]
 [ 8244 16238 10316]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/AAL
Evaluating performance on  test set...
10110/10110 - 67s - 67s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941378
{'0': {'precision': 0.4277108694148568, 'recall': 0.4238843696614953, 'f1-score': 0.425789022672147, 'support': 933665}, '1': {'precision': 0.2810944609864401, 'recall': 0.5082364760454698, 'f1-score': 0.361983679050638, 'support': 704731}, '2': {'precision': 0.4791448997133196, 'recall': 0.1960503316836896, 'f1-score': 0.27824994059565744, 'support': 949700}, 'accuracy': 0.3632496630727763, 'macro avg': {'precision': 0.39598341003820553, 'recall': 0.3760570591302183, 'f1-score': 0.35534088077281417, 'support': 2588096}, 'weighted avg': {'precision': 0.4066613296938741, 'recall': 0.3632496630727763, 'f1-score': 0.35427565150516876, 'support': 2588096}}
[[395766 435500 102399]
 [246563 358170  99998]
 [282983 480528 186189]]
Evaluating performance on  train set...
1686/1686 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850595
{'0': {'precision': 0.3994389966316806, 'recall': 0.4817736858889921, 'f1-score': 0.43675993664680596, 'support': 144242}, '1': {'precision': 0.34487386787567503, 'recall': 0.4482524158487923, 'f1-score': 0.38982580103748876, 'support': 145601}, '2': {'precision': 0.4454393819682205, 'recall': 0.21481340361126988, 'f1-score': 0.28984762149579424, 'support': 141723}, 'accuracy': 0.382796605849395, 'macro avg': {'precision': 0.39658408215852536, 'recall': 0.3816131684496848, 'f1-score': 0.3721444530600297, 'support': 431566}, 'weighted avg': {'precision': 0.3961360842128322, 'recall': 0.382796605849395, 'f1-score': 0.3726804884998272, 'support': 431566}}
[[69492 58364 16386]
 [58819 65266 21516]
 [45663 65616 30444]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0894638
{'0': {'precision': 0.402291294957273, 'recall': 0.48762561384110054, 'f1-score': 0.4408670915385803, 'support': 61498}, '1': {'precision': 0.31056068574827955, 'recall': 0.42497687326549494, 'f1-score': 0.35886980228570536, 'support': 54050}, '2': {'precision': 0.48345242572395636, 'recall': 0.23781333826658033, 'f1-score': 0.31880463760927524, 'support': 64866}, 'accuracy': 0.37903932067356194, 'macro avg': {'precision': 0.39876813547650297, 'recall': 0.3834719417910586, 'f1-score': 0.3728471771445203, 'support': 180414}, 'weighted avg': {'precision': 0.40399048947968025, 'recall': 0.37903932067356194, 'f1-score': 0.37241532714836556, 'support': 180414}}
[[29988 23143  8367]
 [22965 22970  8115]
 [21590 27850 15426]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/WBA
Evaluating performance on  test set...
6546/6546 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912566
{'0': {'precision': 0.3708044084676199, 'recall': 0.35399160050500034, 'f1-score': 0.3622030044393392, 'support': 543366}, '1': {'precision': 0.3576221299462628, 'recall': 0.4856415963327401, 'f1-score': 0.41191427227015587, 'support': 602957}, '2': {'precision': 0.37046727866719886, 'recall': 0.23667415254957588, 'f1-score': 0.2888290099069238, 'support': 529441}, 'accuracy': 0.3642953303687154, 'macro avg': {'precision': 0.3662979390270272, 'recall': 0.35876911646243875, 'f1-score': 0.35431542887213957, 'support': 1675764}, 'weighted avg': {'precision': 0.36595477722535275, 'recall': 0.3642953303687154, 'f1-score': 0.35690784108592494, 'support': 1675764}}
[[192347 260049  90970]
 [188176 292821 121960]
 [138206 265930 125305]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905298
{'0': {'precision': 0.39017085290313797, 'recall': 0.3788821635300894, 'f1-score': 0.3844436566413398, 'support': 105901}, '1': {'precision': 0.339436570672424, 'recall': 0.4561219619477226, 'f1-score': 0.3892220829107404, 'support': 106853}, '2': {'precision': 0.38850847160038626, 'recall': 0.2602878036347952, 'f1-score': 0.3117281051890115, 'support': 102014}, 'accuracy': 0.3666668784628679, 'macro avg': {'precision': 0.37270529839198274, 'recall': 0.36509730970420246, 'f1-score': 0.36179794824703054, 'support': 314768}, 'weighted avg': {'precision': 0.37240952892669377, 'recall': 0.3666668784628679, 'f1-score': 0.3624991925163539, 'support': 314768}}
[[40124 47476 18301]
 [34623 48738 23492]
 [28090 47371 26553]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.086627
{'0': {'precision': 0.36680457902886004, 'recall': 0.40120491962575305, 'f1-score': 0.38323432693327675, 'support': 36019}, '1': {'precision': 0.37418600431442917, 'recall': 0.43376647658221934, 'f1-score': 0.40177943261643706, 'support': 42788}, '2': {'precision': 0.37079479413931404, 'recall': 0.2616606498194946, 'f1-score': 0.3068118322355611, 'support': 34625}, 'accuracy': 0.370891811834403, 'macro avg': {'precision': 0.3705951258275344, 'recall': 0.365544015342489, 'f1-score': 0.3639418639284249, 'support': 113432}, 'weighted avg': {'precision': 0.37080695598878666, 'recall': 0.370891811834403, 'f1-score': 0.36690189078706276, 'support': 113432}}
[[14451 15395  6173]
 [15027 18560  9201]
 [ 9919 15646  9060]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
7633/7633 - 41s - 41s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954875
{'0': {'precision': 0.3920330922825446, 'recall': 0.3165544064324291, 'f1-score': 0.3502737574524702, 'support': 668239}, '1': {'precision': 0.3150983191862327, 'recall': 0.5287443428382905, 'f1-score': 0.3948756354836506, 'support': 612277}, '2': {'precision': 0.4130941490818694, 'recall': 0.23736872036788736, 'f1-score': 0.3014949328067639, 'support': 673467}, 'accuracy': 0.3557513038752128, 'macro avg': {'precision': 0.3734085201835489, 'recall': 0.3608891565462023, 'f1-score': 0.34888144191429493, 'support': 1953983}, 'weighted avg': {'precision': 0.3751847034646175, 'recall': 0.3557513038752128, 'f1-score': 0.34743738445312844, 'support': 1953983}}
[[211534 349922 106783]
 [168200 323738 120339]
 [159848 353759 159860]]
Evaluating performance on  train set...
1586/1586 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926466
{'0': {'precision': 0.38592219729714944, 'recall': 0.31363990069292624, 'f1-score': 0.34604676263404704, 'support': 134935}, '1': {'precision': 0.3383724519864917, 'recall': 0.5301139486315173, 'f1-score': 0.4130771800296352, 'support': 136465}, '2': {'precision': 0.3903051933862627, 'recall': 0.23916536487391207, 'f1-score': 0.2965904688105386, 'support': 134430}, 'accuracy': 0.3617623142695217, 'macro avg': {'precision': 0.3715332808899679, 'recall': 0.3609730713994519, 'f1-score': 0.35190480382474026, 'support': 405830}, 'weighted avg': {'precision': 0.37138490377631705, 'recall': 0.3617623142695217, 'f1-score': 0.35220425796754795, 'support': 405830}}
[[42321 69907 22707]
 [36607 72342 27516]
 [30734 71545 32151]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888078
{'0': {'precision': 0.34191806550064563, 'recall': 0.32939047834445323, 'f1-score': 0.33553738048611914, 'support': 44215}, '1': {'precision': 0.3865670416290336, 'recall': 0.49743779386127107, 'f1-score': 0.4350497839998152, 'support': 56787}, '2': {'precision': 0.3643530090367237, 'recall': 0.2478582172519783, 'f1-score': 0.2950219904254077, 'support': 45873}, 'accuracy': 0.36889872340425534, 'macro avg': {'precision': 0.3642793720554676, 'recall': 0.3582288298192342, 'f1-score': 0.355203051637114, 'support': 146875}, 'weighted avg': {'precision': 0.36618795194989345, 'recall': 0.36889872340425534, 'f1-score': 0.36135830555898546, 'support': 146875}}
[[14564 21773  7878]
 [16581 28248 11958]
 [11450 23053 11370]]
testing model on single stock: results/universal/W10/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
22048/22048 - 129s - 129s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072894
{'0': {'precision': 0.40446453397807647, 'recall': 0.38374604813579805, 'f1-score': 0.39383299348485606, 'support': 2115141}, '1': {'precision': 0.25509094973855173, 'recall': 0.5142821562553509, 'f1-score': 0.3410275785590233, 'support': 1413302}, '2': {'precision': 0.42205703929700944, 'recall': 0.15719221788411908, 'f1-score': 0.22906920037691558, 'support': 2115620}, 'accuracy': 0.3315115369902852, 'macro avg': {'precision': 0.3605375076712125, 'recall': 0.35174014075842264, 'f1-score': 0.321309924140265, 'support': 5644063}, 'weighted avg': {'precision': 0.3736550038133622, 'recall': 0.3315115369902852, 'f1-score': 0.3188502063507418, 'support': 5644063}}
[[ 811677 1038201  265263]
 [ 496340  726836  190126]
 [ 698777 1084284  332559]]
Evaluating performance on  train set...
5429/5429 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967078
{'0': {'precision': 0.37239882939120467, 'recall': 0.3682682782279171, 'f1-score': 0.37032203618393855, 'support': 462326}, '1': {'precision': 0.3327270527915867, 'recall': 0.49960828081232495, 'f1-score': 0.39943802482873497, 'support': 456960}, '2': {'precision': 0.3938591009795249, 'recall': 0.20629786040224524, 'f1-score': 0.2707701320166538, 'support': 470509}, 'accuracy': 0.3566180623761058, 'macro avg': {'precision': 0.36632832772077206, 'recall': 0.3580581398141624, 'f1-score': 0.34684339767644246, 'support': 1389795}, 'weighted avg': {'precision': 0.36662016123495683, 'recall': 0.3566180623761058, 'f1-score': 0.34619241655894434, 'support': 1389795}}
[[170260 222271  69795]
 [149073 228301  79586]
 [137865 235579  97065]]
Evaluating performance on  val set...
1890/1890 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940979
{'0': {'precision': 0.35213444796201027, 'recall': 0.3737121858389658, 'f1-score': 0.36260258883604246, 'support': 152390}, '1': {'precision': 0.36279092960345066, 'recall': 0.5072921871913167, 'f1-score': 0.42304235220579867, 'support': 172102}, '2': {'precision': 0.38669914378506054, 'recall': 0.19748076016962463, 'f1-score': 0.2614456278096839, 'support': 159175}, 'accuracy': 0.363245786874027, 'macro avg': {'precision': 0.3672081737835072, 'recall': 0.3594950443999691, 'f1-score': 0.349030189617175, 'support': 483667}, 'weighted avg': {'precision': 0.367301571749842, 'recall': 0.363245786874027, 'f1-score': 0.35081792063269424, 'support': 483667}}
[[56950 73235 22205]
 [57147 87306 27649]
 [47631 80110 31434]]
training model: results/universal/W10/deepLOB_L2/h50
Epoch 1/50
8543/8543 - 365s - loss: 3.0726 - accuracy50: 0.4505 - val_loss: 3.3477 - val_accuracy50: 0.3273 - 365s/epoch - 43ms/step
Epoch 2/50
8543/8543 - 362s - loss: 3.0480 - accuracy50: 0.4578 - val_loss: 3.3176 - val_accuracy50: 0.3812 - 362s/epoch - 42ms/step
Epoch 3/50
8543/8543 - 360s - loss: 3.0354 - accuracy50: 0.4619 - val_loss: 3.2739 - val_accuracy50: 0.3973 - 360s/epoch - 42ms/step
Epoch 4/50
8543/8543 - 361s - loss: 3.0171 - accuracy50: 0.4674 - val_loss: 3.4683 - val_accuracy50: 0.3552 - 361s/epoch - 42ms/step
Epoch 5/50
8543/8543 - 355s - loss: 2.9998 - accuracy50: 0.4723 - val_loss: 3.3547 - val_accuracy50: 0.3897 - 355s/epoch - 42ms/step
Epoch 6/50
8543/8543 - 352s - loss: 2.9826 - accuracy50: 0.4773 - val_loss: 3.3522 - val_accuracy50: 0.4123 - 352s/epoch - 41ms/step
Epoch 7/50
8543/8543 - 361s - loss: 2.9718 - accuracy50: 0.4800 - val_loss: 3.2962 - val_accuracy50: 0.4077 - 361s/epoch - 42ms/step
Epoch 8/50
8543/8543 - 354s - loss: 2.9628 - accuracy50: 0.4826 - val_loss: 3.3405 - val_accuracy50: 0.3723 - 354s/epoch - 41ms/step
Epoch 9/50
8543/8543 - 354s - loss: 2.9553 - accuracy50: 0.4847 - val_loss: 3.3222 - val_accuracy50: 0.3992 - 354s/epoch - 41ms/step
Epoch 10/50
8543/8543 - 357s - loss: 2.9481 - accuracy50: 0.4869 - val_loss: 3.3030 - val_accuracy50: 0.4046 - 357s/epoch - 42ms/step
Epoch 11/50
8543/8543 - 354s - loss: 2.9417 - accuracy50: 0.4886 - val_loss: 3.3000 - val_accuracy50: 0.4126 - 354s/epoch - 41ms/step
Epoch 12/50
8543/8543 - 359s - loss: 2.9362 - accuracy50: 0.4899 - val_loss: 3.3165 - val_accuracy50: 0.4174 - 359s/epoch - 42ms/step
Epoch 13/50
8543/8543 - 361s - loss: 2.9313 - accuracy50: 0.4913 - val_loss: 3.2486 - val_accuracy50: 0.4179 - 361s/epoch - 42ms/step
Epoch 14/50
8543/8543 - 355s - loss: 2.9267 - accuracy50: 0.4925 - val_loss: 3.2404 - val_accuracy50: 0.4180 - 355s/epoch - 42ms/step
Epoch 15/50
8543/8543 - 355s - loss: 2.9229 - accuracy50: 0.4935 - val_loss: 3.2349 - val_accuracy50: 0.4153 - 355s/epoch - 42ms/step
Epoch 16/50
8543/8543 - 357s - loss: 2.9191 - accuracy50: 0.4946 - val_loss: 3.2909 - val_accuracy50: 0.4121 - 357s/epoch - 42ms/step
Epoch 17/50
8543/8543 - 356s - loss: 2.9155 - accuracy50: 0.4953 - val_loss: 3.3358 - val_accuracy50: 0.4090 - 356s/epoch - 42ms/step
Epoch 18/50
8543/8543 - 352s - loss: 2.9127 - accuracy50: 0.4960 - val_loss: 3.2944 - val_accuracy50: 0.4134 - 352s/epoch - 41ms/step
Epoch 19/50
8543/8543 - 353s - loss: 2.9097 - accuracy50: 0.4967 - val_loss: 3.2937 - val_accuracy50: 0.4200 - 353s/epoch - 41ms/step
Epoch 20/50
8543/8543 - 348s - loss: 2.9073 - accuracy50: 0.4974 - val_loss: 3.3336 - val_accuracy50: 0.4222 - 348s/epoch - 41ms/step
Epoch 21/50
8543/8543 - 350s - loss: 2.9048 - accuracy50: 0.4983 - val_loss: 3.3929 - val_accuracy50: 0.4061 - 350s/epoch - 41ms/step
Epoch 22/50
8543/8543 - 357s - loss: 2.9021 - accuracy50: 0.4990 - val_loss: 3.3963 - val_accuracy50: 0.4145 - 357s/epoch - 42ms/step
Epoch 23/50
8543/8543 - 354s - loss: 2.9000 - accuracy50: 0.4993 - val_loss: 3.3901 - val_accuracy50: 0.4108 - 354s/epoch - 41ms/step
Epoch 24/50
8543/8543 - 360s - loss: 2.8975 - accuracy50: 0.5001 - val_loss: 3.3596 - val_accuracy50: 0.4144 - 360s/epoch - 42ms/step
Epoch 25/50
8543/8543 - 357s - loss: 2.8952 - accuracy50: 0.5004 - val_loss: 3.3385 - val_accuracy50: 0.4060 - 357s/epoch - 42ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 522s - 522s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0900271
{'0': {'precision': 0.4198305065561073, 'recall': 0.4054702111524368, 'f1-score': 0.41252542373689255, 'support': 3201668}, '1': {'precision': 0.40370923052684077, 'recall': 0.3904206505409529, 'f1-score': 0.39695375824353646, 'support': 3091212}, '2': {'precision': 0.41970653611508973, 'recall': 0.446969144929635, 'f1-score': 0.4329090469980772, 'support': 3252399}, 'accuracy': 0.4147365414882058, 'macro avg': {'precision': 0.4144154243993459, 'recall': 0.41428666887434157, 'f1-score': 0.41412940965950207, 'support': 9545279}, 'weighted avg': {'precision': 0.4145674353294437, 'recall': 0.4147365414882058, 'f1-score': 0.4144279722824097, 'support': 9545279}}
[[1298181  916076  987411]
 [ 861809 1206873 1022530]
 [ 932165  866512 1453722]]
Evaluating performance on  train set...
8543/8543 - 119s - 119s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017083
{'0': {'precision': 0.3887717386968405, 'recall': 0.43135632927717077, 'f1-score': 0.4089584460759772, 'support': 655217}, '1': {'precision': 0.46343097341407535, 'recall': 0.44614648932979956, 'f1-score': 0.454624504902892, 'support': 863667}, '2': {'precision': 0.3888167339935506, 'recall': 0.3657859115112093, 'f1-score': 0.37694986706416256, 'support': 667836}, 'accuracy': 0.417172294578181, 'macro avg': {'precision': 0.41367314870148886, 'recall': 0.4144295767060599, 'f1-score': 0.4135109393476773, 'support': 2186720}, 'weighted avg': {'precision': 0.4182728941943453, 'recall': 0.417172294578181, 'f1-score': 0.4172191226399318, 'support': 2186720}}
[[282632 222049 150536]
 [244888 385322 233457]
 [199467 224084 244285]]
Evaluating performance on  val set...
3077/3077 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879327
{'0': {'precision': 0.38118325557767657, 'recall': 0.45187258123079377, 'f1-score': 0.413528731230638, 'support': 225838}, '1': {'precision': 0.48955077057601926, 'recall': 0.4083892321673348, 'f1-score': 0.445302052902548, 'support': 329017}, '2': {'precision': 0.3704495125718068, 'recall': 0.39066647133845783, 'f1-score': 0.3802894879226243, 'support': 232088}, 'accuracy': 0.41564128532816225, 'macro avg': {'precision': 0.4137278462418342, 'recall': 0.41697609491219545, 'f1-score': 0.41304009068527003, 'support': 786943}, 'weighted avg': {'precision': 0.4233255476311841, 'recall': 0.41564128532816225, 'f1-score': 0.41700996618114455, 'support': 786943}}
[[102050  68926  54862]
 [ 95427 134367  99223]
 [ 70242  71177  90669]]
testing model out of sample: results/universal/W10/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 290s - 290s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0026193
{'0': {'precision': 0.4675178611191836, 'recall': 0.4595894980864969, 'f1-score': 0.46351977903040176, 'support': 1617191}, '1': {'precision': 0.5714026834190853, 'recall': 0.577423236553633, 'f1-score': 0.5743971842890077, 'support': 2227981}, '2': {'precision': 0.4620478063099192, 'recall': 0.4631774537068271, 'f1-score': 0.46261194039077597, 'support': 1615627}, 'accuracy': 0.508726653370688, 'macro avg': {'precision': 0.5003227836160626, 'recall': 0.5000633961156523, 'f1-score': 0.5001763012367285, 'support': 5460799}, 'weighted avg': {'precision': 0.508284027760957, 'recall': 0.508726653370688, 'f1-score': 0.5084886606222075, 'support': 5460799}}
[[ 743244  481447  392500]
 [ 462738 1286488  478755]
 [ 383784  483521  748322]]
Evaluating performance on  train set...
4055/4055 - 60s - 60s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0150034
{'0': {'precision': 0.44106513153856125, 'recall': 0.4503102346083941, 'f1-score': 0.44563973922511824, 'support': 287202}, '1': {'precision': 0.6083532595097516, 'recall': 0.514556561579579, 'f1-score': 0.5575374897610135, 'support': 458350}, '2': {'precision': 0.4266119239322783, 'recall': 0.5210873914115809, 'f1-score': 0.46914056175357166, 'support': 291928}, 'accuracy': 0.49860912981455063, 'macro avg': {'precision': 0.4920101049935304, 'recall': 0.4953180625331847, 'f1-score': 0.49077259691323444, 'support': 1037480}, 'weighted avg': {'precision': 0.5109047597391126, 'recall': 0.49860912981455063, 'f1-score': 0.5016879349274103, 'support': 1037480}}
[[129330  78348  79524]
 [ 97570 235847 124933]
 [ 66322  73486 152120]]
Evaluating performance on  val set...
1545/1545 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0313377
{'0': {'precision': 0.4144892513718975, 'recall': 0.45535664902933204, 'f1-score': 0.4339629271720987, 'support': 108482}, '1': {'precision': 0.584873341219208, 'recall': 0.5212392133368665, 'f1-score': 0.5512258567594983, 'support': 173594}, '2': {'precision': 0.4253429185258635, 'recall': 0.456221361529394, 'f1-score': 0.44024135232564604, 'support': 112829}, 'accuracy': 0.48456464212911965, 'macro avg': {'precision': 0.4749018370389897, 'recall': 0.47760574129853084, 'f1-score': 0.47514337875241436, 'support': 394905}, 'weighted avg': {'precision': 0.49248842612093546, 'recall': 0.48456464212911965, 'f1-score': 0.48730367856913, 'support': 394905}}
[[49398 32221 26863]
 [40428 90484 42682]
 [29352 32002 51475]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1663711
{'0': {'precision': 0.45939411179064144, 'recall': 0.31282081081604585, 'f1-score': 0.37219699937775114, 'support': 51627}, '1': {'precision': 0.28104497901767245, 'recall': 0.28903139531349725, 'f1-score': 0.2849822447970513, 'support': 32903}, '2': {'precision': 0.4135529811213984, 'recall': 0.5471921797004992, 'f1-score': 0.4710780056760701, 'support': 48080}, 'accuracy': 0.3918935223587965, 'macro avg': {'precision': 0.3846640239765707, 'recall': 0.3830147952766807, 'f1-score': 0.3760857499502908, 'support': 132610}, 'weighted avg': {'precision': 0.39852190699306805, 'recall': 0.3918935223587965, 'f1-score': 0.3864083839856571, 'support': 132610}}
[[16150 13287 22190]
 [ 8275  9510 15118]
 [10730 11041 26309]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1570678
{'0': {'precision': 0.43400123941334434, 'recall': 0.3635262565965914, 'f1-score': 0.3956499223200414, 'support': 11559}, '1': {'precision': 0.38075867940592184, 'recall': 0.36235145840835437, 'f1-score': 0.37132709073296744, 'support': 11108}, '2': {'precision': 0.40767590618336885, 'recall': 0.4921070693205216, 'f1-score': 0.44593018735909196, 'support': 11656}, 'accuracy': 0.4068117588788859, 'macro avg': {'precision': 0.4074786083342117, 'recall': 0.40599492810848914, 'f1-score': 0.40430240013736696, 'support': 34323}, 'weighted avg': {'precision': 0.4078302624972518, 'recall': 0.4068117588788859, 'f1-score': 0.40485333565879256, 'support': 34323}}
[[4202 3315 4042]
 [2791 4025 4292]
 [2689 3231 5736]]
Evaluating performance on  val set...
46/46 - 1s - 872ms/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1641858
{'0': {'precision': 0.42674986435160067, 'recall': 0.3933483370842711, 'f1-score': 0.40936890045543267, 'support': 3999}, '1': {'precision': 0.37584987761762306, 'recall': 0.36657824933687, 'f1-score': 0.3711561702699074, 'support': 3770}, '2': {'precision': 0.39800879833294744, 'recall': 0.4393048811653463, 'f1-score': 0.4176384839650146, 'support': 3913}, 'accuracy': 0.40010272213662046, 'macro avg': {'precision': 0.4002028467673904, 'recall': 0.3997438225288292, 'f1-score': 0.3993878515634515, 'support': 11682}, 'weighted avg': {'precision': 0.40069638538241, 'recall': 0.40010272213662046, 'f1-score': 0.39980691513387506, 'support': 11682}}
[[1573 1206 1220]
 [1008 1382 1380]
 [1105 1089 1719]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
1840/1840 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9200848
{'0': {'precision': 0.3781247311827957, 'recall': 0.5109021595109138, 'f1-score': 0.43459819663054655, 'support': 86038}, '1': {'precision': 0.7893144461766923, 'recall': 0.5721860034609039, 'f1-score': 0.6634366937624064, 'support': 298188}, '2': {'precision': 0.3611969167701146, 'recall': 0.5769589928638129, 'f1-score': 0.44426690102398164, 'support': 86741}, 'accuracy': 0.561869515273894, 'macro avg': {'precision': 0.5095453647098676, 'recall': 0.5533490519452102, 'f1-score': 0.5141005971389782, 'support': 470967}, 'weighted avg': {'precision': 0.6353476431588572, 'recall': 0.561869515273894, 'f1-score': 0.5812657272017882, 'support': 470967}}
[[ 43957  23235  18846]
 [ 57905 170619  69664]
 [ 14388  22307  50046]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9987212
{'0': {'precision': 0.2872502200997786, 'recall': 0.6240292106178278, 'f1-score': 0.3934084805524599, 'support': 17254}, '1': {'precision': 0.8644438483916892, 'recall': 0.41708892893052335, 'f1-score': 0.5626855047744397, 'support': 100451}, '2': {'precision': 0.2505308284968959, 'recall': 0.7001017179023508, 'f1-score': 0.36901127377246934, 'support': 17696}, 'accuracy': 0.4804469686339096, 'macro avg': {'precision': 0.46740829899612124, 'recall': 0.580406619150234, 'f1-score': 0.4417017530331229, 'support': 135401}, 'weighted avg': {'precision': 0.7106583987819604, 'recall': 0.4804469686339096, 'f1-score': 0.5158028010445048, 'support': 135401}}
[[10767  3556  2931]
 [24423 41897 34131]
 [ 2293  3014 12389]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0616744
{'0': {'precision': 0.32503148174059043, 'recall': 0.5434553748976488, 'f1-score': 0.40677669307884246, 'support': 8549}, '1': {'precision': 0.839889874579382, 'recall': 0.38455935906773486, 'f1-score': 0.5275637453644102, 'support': 35698}, '2': {'precision': 0.2686806576660874, 'recall': 0.6825127334465195, 'f1-score': 0.385574525225398, 'support': 8835}, 'accuracy': 0.4597415319694058, 'macro avg': {'precision': 0.4778673379953533, 'recall': 0.536842489137301, 'f1-score': 0.4399716545562169, 'support': 53082}, 'weighted avg': {'precision': 0.6618981291325678, 'recall': 0.4597415319694058, 'f1-score': 0.48447789196933294, 'support': 53082}}
[[ 4646  1361  2542]
 [ 8099 13728 13871]
 [ 1549  1256  6030]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.246299
{'0': {'precision': 0.4210546196268037, 'recall': 0.3703978556554871, 'f1-score': 0.39410509940721006, 'support': 90284}, '1': {'precision': 0.3268629555317064, 'recall': 0.28810561816237557, 'f1-score': 0.3062629795606077, 'support': 72942}, '2': {'precision': 0.3768107566651256, 'recall': 0.46400910891558833, 'f1-score': 0.41588842173522483, 'support': 84313}, 'accuracy': 0.37803336039977536, 'macro avg': {'precision': 0.3749094439412119, 'recall': 0.3741708609111503, 'f1-score': 0.3720855002343475, 'support': 247539}, 'weighted avg': {'precision': 0.3782296054661561, 'recall': 0.37803336039977536, 'f1-score': 0.3756402811344976, 'support': 247539}}
[[33441 22691 34152]
 [21377 21015 30550]
 [24604 20587 39122]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2435971
{'0': {'precision': 0.38431537893960155, 'recall': 0.3934603140344251, 'f1-score': 0.3888340843042632, 'support': 18533}, '1': {'precision': 0.36246563449573144, 'recall': 0.269601248452887, 'f1-score': 0.3092115414287918, 'support': 18583}, '2': {'precision': 0.3878307554646555, 'recall': 0.47532508224972586, 'f1-score': 0.42714346050964386, 'support': 19149}, 'accuracy': 0.3804141117924109, 'macro avg': {'precision': 0.3782039229666629, 'recall': 0.37946221491234605, 'f1-score': 0.37506302874756625, 'support': 56265}, 'weighted avg': {'precision': 0.3782953335130988, 'recall': 0.3804141117924109, 'f1-score': 0.37557469624244766, 'support': 56265}}
[[7292 4397 6844]
 [6050 5010 7523]
 [5632 4415 9102]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2158775
{'0': {'precision': 0.4037150875317386, 'recall': 0.4377626430952036, 'f1-score': 0.4200500556173526, 'support': 6901}, '1': {'precision': 0.360251572327044, 'recall': 0.22586750788643534, 'f1-score': 0.2776539020843432, 'support': 6340}, '2': {'precision': 0.3879481490131963, 'recall': 0.48997050147492627, 'f1-score': 0.4330313498012123, 'support': 6780}, 'accuracy': 0.3883422406473203, 'macro avg': {'precision': 0.3839716029573263, 'recall': 0.38453355081885504, 'f1-score': 0.376911769167636, 'support': 20021}, 'weighted avg': {'precision': 0.38461221906595366, 'recall': 0.3883422406473203, 'f1-score': 0.3793538646762053, 'support': 20021}}
[[3021 1320 2560]
 [2227 1432 2681]
 [2235 1223 3322]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2531216
{'0': {'precision': 0.38932216697199684, 'recall': 0.4121374992208008, 'f1-score': 0.4004050885037632, 'support': 144379}, '1': {'precision': 0.28844444444444445, 'recall': 0.1407398140039201, 'f1-score': 0.18917570559712996, 'support': 119895}, '2': {'precision': 0.3872354395576211, 'recall': 0.5315747964960708, 'f1-score': 0.44806771170294224, 'support': 142012}, 'accuracy': 0.37379579901842547, 'macro avg': {'precision': 0.35500068365802084, 'recall': 0.36148403657359723, 'f1-score': 0.3458828352679451, 'support': 406286}, 'weighted avg': {'precision': 0.3588237622127602, 'recall': 0.37379579901842547, 'f1-score': 0.35473114842748943, 'support': 406286}}
[[59504 22006 62869]
 [46434 16874 56587]
 [46902 19620 75490]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.284061
{'0': {'precision': 0.3925292247055135, 'recall': 0.3332953032895988, 'f1-score': 0.36049524906420954, 'support': 26295}, '1': {'precision': 0.32443928847641146, 'recall': 0.23713962690785756, 'f1-score': 0.27400391900718485, 'support': 24766}, '2': {'precision': 0.3491628875388608, 'recall': 0.501125711244832, 'f1-score': 0.4115649689023365, 'support': 24429}, 'accuracy': 0.3560604053517022, 'macro avg': {'precision': 0.3553771335735953, 'recall': 0.35718688048076275, 'f1-score': 0.3486880456579103, 'support': 75490}, 'weighted avg': {'precision': 0.3561573660315951, 'recall': 0.3560604053517022, 'f1-score': 0.3486464996369123, 'support': 75490}}
[[ 8764  6530 11001]
 [ 7075  5873 11818]
 [ 6488  5699 12242]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2511361
{'0': {'precision': 0.3765409717186367, 'recall': 0.3694086260560249, 'f1-score': 0.372940701171612, 'support': 11245}, '1': {'precision': 0.38386824324324326, 'recall': 0.23632897131467198, 'f1-score': 0.2925494823794454, 'support': 11539}, '2': {'precision': 0.359245630174793, 'recall': 0.5172185430463576, 'f1-score': 0.42399565689467966, 'support': 10570}, 'accuracy': 0.37021046950890446, 'macro avg': {'precision': 0.3732182817122243, 'recall': 0.3743187134723515, 'f1-score': 0.36316194681524566, 'support': 33354}, 'weighted avg': {'precision': 0.3735949270464537, 'recall': 0.37021046950890446, 'f1-score': 0.36130841144174497, 'support': 33354}}
[[4154 2369 4722]
 [3783 2727 5029]
 [3095 2008 5467]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1927963
{'0': {'precision': 0.46398683372925303, 'recall': 0.4054376729798665, 'f1-score': 0.4327408319154328, 'support': 221124}, '1': {'precision': 0.19679755611999725, 'recall': 0.23640374386673813, 'f1-score': 0.2147901174443216, 'support': 97012}, '2': {'precision': 0.4610540025524029, 'recall': 0.4785800158784167, 'f1-score': 0.4696535619917681, 'support': 220425}, 'accuracy': 0.4049253473608375, 'macro avg': {'precision': 0.3739461308005511, 'recall': 0.3734738109083405, 'f1-score': 0.37239483711717414, 'support': 538561}, 'weighted avg': {'precision': 0.4146571653879021, 'recall': 0.4049253473608375, 'f1-score': 0.4085887930838144, 'support': 538561}}
[[ 89652  48024  83448]
 [ 34213  22934  39865]
 [ 69356  45578 105491]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2297686
{'0': {'precision': 0.4162836697888184, 'recall': 0.39147085373526275, 'f1-score': 0.40349615845492354, 'support': 36557}, '1': {'precision': 0.37430968944990317, 'recall': 0.2881992379479817, 'f1-score': 0.3256583052539624, 'support': 36218}, '2': {'precision': 0.3955325005293246, 'recall': 0.5087556850676761, 'f1-score': 0.4450559268127077, 'support': 36719}, 'accuracy': 0.39664273841489034, 'macro avg': {'precision': 0.39537528658934873, 'recall': 0.3961419255836402, 'f1-score': 0.3914034635071979, 'support': 109494}, 'weighted avg': {'precision': 0.3954407395464838, 'recall': 0.39664273841489034, 'f1-score': 0.39168639506238206, 'support': 109494}}
[[14311  8847 13399]
 [10630 10438 15150]
 [ 9437  8601 18681]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2105949
{'0': {'precision': 0.40843417675100846, 'recall': 0.46204264498465114, 'f1-score': 0.4335876673933355, 'support': 12053}, '1': {'precision': 0.35848214285714286, 'recall': 0.21305386044043512, 'f1-score': 0.26726576801464463, 'support': 11307}, '2': {'precision': 0.4010155546985474, 'recall': 0.4970126662949096, 'f1-score': 0.4438831774038633, 'support': 12553}, 'accuracy': 0.39587336062150197, 'macro avg': {'precision': 0.38931062476889955, 'recall': 0.3907030572399986, 'f1-score': 0.38157887093728116, 'support': 35913}, 'weighted avg': {'precision': 0.39011396930906594, 'recall': 0.39587336062150197, 'f1-score': 0.384820864867434, 'support': 35913}}
[[5569 2123 4361]
 [3940 2409 4958]
 [4126 2188 6239]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
5267/5267 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9534749
{'0': {'precision': 0.4284783093063055, 'recall': 0.5907599495414942, 'f1-score': 0.4967000054954113, 'support': 305994}, '1': {'precision': 0.713501470783335, 'recall': 0.4252873719931775, 'f1-score': 0.5329226174764381, 'support': 733457}, '2': {'precision': 0.39636408986733346, 'recall': 0.6279434342387397, 'f1-score': 0.48597559217856795, 'support': 308738}, 'accuracy': 0.5092527828071584, 'macro avg': {'precision': 0.512781289985658, 'recall': 0.5479969185911372, 'f1-score': 0.5051994050501392, 'support': 1348189}, 'weighted avg': {'precision': 0.5761856063294294, 'recall': 0.5092527828071584, 'f1-score': 0.5139503275178817, 'support': 1348189}}
[[180769  69926  55299]
 [181575 311930 239952]
 [ 59542  55326 193870]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9565142
{'0': {'precision': 0.37724847064948586, 'recall': 0.586613774818353, 'f1-score': 0.45919248409762436, 'support': 49409}, '1': {'precision': 0.7864214292084948, 'recall': 0.4622190381333473, 'f1-score': 0.5822315808008921, 'support': 171687}, '2': {'precision': 0.35379154013942943, 'recall': 0.6595570793549544, 'f1-score': 0.4605438058055132, 'support': 50167}, 'accuracy': 0.5213722475973501, 'macro avg': {'precision': 0.5058204799991367, 'recall': 0.5694632974355516, 'f1-score': 0.5006559569013432, 'support': 271263}, 'weighted avg': {'precision': 0.6318829541699903, 'recall': 0.5213722475973501, 'f1-score': 0.5373159478645722, 'support': 271263}}
[[28984 11648  8777]
 [40671 79357 51659]
 [ 7175  9904 33088]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0219221
{'0': {'precision': 0.3617286379434717, 'recall': 0.6195316448587634, 'f1-score': 0.4567643101128247, 'support': 17807}, '1': {'precision': 0.8272942652079994, 'recall': 0.35241996527004765, 'f1-score': 0.4942807481343478, 'support': 67377}, '2': {'precision': 0.30018549518164955, 'recall': 0.7282405882998573, 'f1-score': 0.42512974947139104, 'support': 18222}, 'accuracy': 0.4646442179370636, 'macro avg': {'precision': 0.4964027994443736, 'recall': 0.5667307328095561, 'f1-score': 0.45872493590618785, 'support': 103406}, 'weighted avg': {'precision': 0.6542356116277468, 'recall': 0.4646442179370636, 'f1-score': 0.4756345892123736, 'support': 103406}}
[[11032  2801  3974]
 [16670 23745 26962]
 [ 2796  2156 13270]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
10110/10110 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.901116
{'0': {'precision': 0.4732703781263582, 'recall': 0.44505019388485806, 'f1-score': 0.4587266799082951, 'support': 592104}, '1': {'precision': 0.6592621481119252, 'recall': 0.7001471451901693, 'f1-score': 0.6790898270399397, 'support': 1397939}, '2': {'precision': 0.47625528427622565, 'recall': 0.43533235906885287, 'f1-score': 0.4548752672034468, 'support': 598058}, 'accuracy': 0.5805928748530294, 'macro avg': {'precision': 0.5362626035048365, 'recall': 0.5268432327146267, 'f1-score': 0.5308972580505605, 'support': 2588101}, 'weighted avg': {'precision': 0.5744218772154707, 'recall': 0.5805928748530294, 'f1-score': 0.5768638273220273, 'support': 2588101}}
[[263516 247739  80849]
 [213710 978763 205466]
 [ 79572 258132 260354]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9191686
{'0': {'precision': 0.40459102191606855, 'recall': 0.4795320303769755, 'f1-score': 0.43888541014401994, 'support': 87698}, '1': {'precision': 0.7388056734486974, 'recall': 0.5792272865414138, 'f1-score': 0.6493561519376595, 'support': 256654}, '2': {'precision': 0.38511011961268277, 'recall': 0.5581659328563566, 'f1-score': 0.4557633973710819, 'support': 87216}, 'accuracy': 0.5547121195269343, 'macro avg': {'precision': 0.5095022716591495, 'recall': 0.5389750832582486, 'f1-score': 0.5146683198175871, 'support': 431568}, 'weighted avg': {'precision': 0.5994119558109895, 'recall': 0.5547121195269343, 'f1-score': 0.5674634981818266, 'support': 431568}}
[[ 42054  28284  17360]
 [ 47626 148661  60367]
 [ 14262  24273  48681]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9696464
{'0': {'precision': 0.388096747893831, 'recall': 0.5279749580991817, 'f1-score': 0.44735660509361264, 'support': 40572}, '1': {'precision': 0.6940889780812636, 'recall': 0.5472300990424527, 'f1-score': 0.6119721950939279, 'support': 97332}, '2': {'precision': 0.4035395309502692, 'recall': 0.4602211244413079, 'f1-score': 0.4300205514831137, 'support': 42510}, 'accuracy': 0.5223984834879777, 'macro avg': {'precision': 0.49524175230845463, 'recall': 0.5118087271943141, 'f1-score': 0.49644978389021804, 'support': 180414}, 'weighted avg': {'precision': 0.5568159629011606, 'recall': 0.5223984834879777, 'f1-score': 0.5320806784300963, 'support': 180414}}
[[21421 11995  7156]
 [22308 53263 21761]
 [11466 11480 19564]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
6546/6546 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.072995
{'0': {'precision': 0.4739177379626818, 'recall': 0.21133367187646937, 'f1-score': 0.2923154167739787, 'support': 531690}, '1': {'precision': 0.4715047548452947, 'recall': 0.515721267224544, 'f1-score': 0.4926228122743127, 'support': 621642}, '2': {'precision': 0.42540939853835663, 'recall': 0.6178218617747212, 'f1-score': 0.5038714551988337, 'support': 522437}, 'accuracy': 0.45097564163079756, 'macro avg': {'precision': 0.45694396378211105, 'recall': 0.4482922669585782, 'f1-score': 0.429603228082375, 'support': 1675769}, 'weighted avg': {'precision': 0.45789968119299285, 'recall': 0.45097564163079756, 'f1-score': 0.43257591329837114, 'support': 1675769}}
[[112364 207531 211795]
 [ 76881 320594 224167]
 [ 47851 151813 322773]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0090607
{'0': {'precision': 0.5132787853650567, 'recall': 0.38998071009759544, 'f1-score': 0.4432144388189776, 'support': 104718}, '1': {'precision': 0.4691225842963008, 'recall': 0.5726742286327778, 'f1-score': 0.5157520367925876, 'support': 107115}, '2': {'precision': 0.4798560049019608, 'recall': 0.4868997542185997, 'f1-score': 0.4833522193022639, 'support': 102937}, 'accuracy': 0.48384534739651175, 'macro avg': {'precision': 0.48741912485443945, 'recall': 0.4831848976496577, 'f1-score': 0.48077289830460973, 'support': 314770}, 'weighted avg': {'precision': 0.4873225880463494, 'recall': 0.48384534739651175, 'f1-score': 0.4810246733284648, 'support': 314770}}
[[40838 36405 27475]
 [18920 61342 26853]
 [19805 33012 50120]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9867687
{'0': {'precision': 0.48376387592073866, 'recall': 0.414157562838618, 'f1-score': 0.4462628002679682, 'support': 33777}, '1': {'precision': 0.5160714614266527, 'recall': 0.6001198142878539, 'f1-score': 0.5549312493817391, 'support': 46739}, '2': {'precision': 0.4581648213220182, 'recall': 0.4198614739656115, 'f1-score': 0.4381776678714096, 'support': 32918}, 'accuracy': 0.4924361302607684, 'macro avg': {'precision': 0.4860000528898032, 'recall': 0.47804628369736113, 'f1-score': 0.479790572507039, 'support': 113434}, 'weighted avg': {'precision': 0.48964707284300385, 'recall': 0.4924361302607684, 'f1-score': 0.48869195074224064, 'support': 113434}}
[[13989 13407  6381]
 [ 8726 28049  9964]
 [ 6202 12895 13821]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
7633/7633 - 106s - 106s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0426282
{'0': {'precision': 0.46990851526607536, 'recall': 0.5146151661803, 'f1-score': 0.4912467891436106, 'support': 662052}, '1': {'precision': 0.46090613233943833, 'recall': 0.4057797938407328, 'f1-score': 0.4315897828984632, 'support': 627185}, '2': {'precision': 0.4690489348058004, 'recall': 0.4775351973896993, 'f1-score': 0.4732540258168105, 'support': 664751}, 'accuracy': 0.4670668397144711, 'macro avg': {'precision': 0.46662119413710473, 'recall': 0.4659767191369107, 'f1-score': 0.4653635326196281, 'support': 1953988}, 'weighted avg': {'precision': 0.4667265271953241, 'recall': 0.4670668397144711, 'f1-score': 0.46597709103076834, 'support': 1953988}}
[[340702 149924 171426]
 [184776 254499 187910]
 [199561 147748 317442]]
Evaluating performance on  train set...
1586/1586 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.015091
{'0': {'precision': 0.48694331022694903, 'recall': 0.46318166422039064, 'f1-score': 0.47476536008980547, 'support': 132855}, '1': {'precision': 0.5028503208476347, 'recall': 0.4963067156649753, 'f1-score': 0.49955709080935634, 'support': 135787}, '2': {'precision': 0.48026650531497955, 'recall': 0.5091480304399801, 'f1-score': 0.49428573450425645, 'support': 137188}, 'accuracy': 0.48980361234999875, 'macro avg': {'precision': 0.4900200454631878, 'recall': 0.48954547010844873, 'f1-score': 0.48953606180113945, 'support': 405830}, 'weighted avg': {'precision': 0.4900086029329781, 'recall': 0.48980361234999875, 'f1-score': 0.4896591724358256, 'support': 405830}}
[[61536 33507 37812]
 [30618 67392 37777]
 [34218 33121 69849]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0266831
{'0': {'precision': 0.4585408207564034, 'recall': 0.39940387481371087, 'f1-score': 0.42693423367730277, 'support': 44957}, '1': {'precision': 0.5065502872656102, 'recall': 0.5851581730330933, 'f1-score': 0.5430241706922954, 'support': 54845}, '2': {'precision': 0.4699504057709648, 'recall': 0.4428653368172838, 'f1-score': 0.45600603720757277, 'support': 47073}, 'accuracy': 0.48269617021276595, 'macro avg': {'precision': 0.47834717126432613, 'recall': 0.4758091282213626, 'f1-score': 0.4753214805257236, 'support': 146875}, 'weighted avg': {'precision': 0.48012490644891676, 'recall': 0.48269617021276595, 'f1-score': 0.47960112459248694, 'support': 146875}}
[[17956 15510 11491]
 [10730 32093 12022]
 [10473 15753 20847]]
testing model on single stock: results/universal/W10/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
22048/22048 - 305s - 305s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1300914
{'0': {'precision': 0.41644049460398824, 'recall': 0.4223635817389377, 'f1-score': 0.41938112568295843, 'support': 2133567}, '1': {'precision': 0.24223530155685263, 'recall': 0.2935540162211786, 'f1-score': 0.2654369666698796, 'support': 1318030}, '2': {'precision': 0.43107259357138533, 'recall': 0.3702051247200077, 'f1-score': 0.39832702101529555, 'support': 2192471}, 'accuracy': 0.3720220947019065, 'macro avg': {'precision': 0.3632494632440754, 'recall': 0.3620409075600413, 'f1-score': 0.3610483711227112, 'support': 5644068}, 'weighted avg': {'precision': 0.3814431809754551, 'recall': 0.3720220947019065, 'f1-score': 0.37525275341337844, 'support': 5644068}}
[[901141 593058 639368]
 [499255 386913 431862]
 [763517 617290 811664]]
Evaluating performance on  train set...
5429/5429 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1509038
{'0': {'precision': 0.3787376064467971, 'recall': 0.4236166813465897, 'f1-score': 0.39992200549056584, 'support': 457541}, '1': {'precision': 0.36948725459270276, 'recall': 0.4281167328042328, 'f1-score': 0.3966471551008232, 'support': 459648}, '2': {'precision': 0.39481088654350505, 'recall': 0.28858861591131746, 'f1-score': 0.33344457198179595, 'support': 472607}, 'accuracy': 0.3791880247172966, 'macro avg': {'precision': 0.3810119158610017, 'recall': 0.38010734335404667, 'f1-score': 0.3766712441910616, 'support': 1389796}, 'weighted avg': {'precision': 0.38114403081241194, 'recall': 0.3791880247172966, 'f1-score': 0.3762329325257396, 'support': 1389796}}
[[193822 163413 100306]
 [154106 196783 108759]
 [163830 172388 136389]]
Evaluating performance on  val set...
1890/1890 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1178806
{'0': {'precision': 0.3727881317862582, 'recall': 0.4405541887867409, 'f1-score': 0.40384809405397065, 'support': 154460}, '1': {'precision': 0.3919852629947359, 'recall': 0.39216528294684605, 'f1-score': 0.3920752523069125, 'support': 167664}, '2': {'precision': 0.3917293909497106, 'recall': 0.32345567434057804, 'f1-score': 0.3543337255154595, 'support': 161543}, 'accuracy': 0.3846696177328617, 'macro avg': {'precision': 0.38550092857690155, 'recall': 0.385391715358055, 'f1-score': 0.38341902395878086, 'support': 483667}, 'weighted avg': {'precision': 0.38576916137062056, 'recall': 0.3846696177328617, 'f1-score': 0.3832294010782343, 'support': 483667}}
[[68048 49011 37401]
 [58177 65752 43735]
 [56313 52978 52252]]
training model: results/universal/W10/deepLOB_L2/h100
Epoch 1/50
8543/8543 - 354s - loss: 3.1807 - accuracy100: 0.4172 - val_loss: 3.2687 - val_accuracy100: 0.3955 - 354s/epoch - 41ms/step
Epoch 2/50
8543/8543 - 347s - loss: 3.1539 - accuracy100: 0.4291 - val_loss: 3.2731 - val_accuracy100: 0.3732 - 347s/epoch - 41ms/step
Epoch 3/50
8543/8543 - 349s - loss: 3.1432 - accuracy100: 0.4334 - val_loss: 3.3155 - val_accuracy100: 0.3935 - 349s/epoch - 41ms/step
Epoch 4/50
8543/8543 - 347s - loss: 3.1330 - accuracy100: 0.4380 - val_loss: 3.6890 - val_accuracy100: 0.3844 - 347s/epoch - 41ms/step
Epoch 5/50
8543/8543 - 350s - loss: 3.1230 - accuracy100: 0.4414 - val_loss: 3.8078 - val_accuracy100: 0.3734 - 350s/epoch - 41ms/step
Epoch 6/50
8543/8543 - 348s - loss: 3.1146 - accuracy100: 0.4448 - val_loss: 3.9449 - val_accuracy100: 0.3576 - 348s/epoch - 41ms/step
Epoch 7/50
8543/8543 - 347s - loss: 3.1065 - accuracy100: 0.4473 - val_loss: 3.8883 - val_accuracy100: 0.3609 - 347s/epoch - 41ms/step
Epoch 8/50
8543/8543 - 345s - loss: 3.0999 - accuracy100: 0.4490 - val_loss: 4.0052 - val_accuracy100: 0.3542 - 345s/epoch - 40ms/step
Epoch 9/50
8543/8543 - 348s - loss: 3.0931 - accuracy100: 0.4507 - val_loss: 4.1154 - val_accuracy100: 0.3542 - 348s/epoch - 41ms/step
Epoch 10/50
8543/8543 - 349s - loss: 3.0871 - accuracy100: 0.4527 - val_loss: 4.1645 - val_accuracy100: 0.3639 - 349s/epoch - 41ms/step
Epoch 11/50
8543/8543 - 357s - loss: 3.0832 - accuracy100: 0.4538 - val_loss: 4.3886 - val_accuracy100: 0.3433 - 357s/epoch - 42ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 515s - 515s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1066166
{'0': {'precision': 0.3896880305923283, 'recall': 0.286587542562157, 'f1-score': 0.33027877831639624, 'support': 3330717}, '1': {'precision': 0.302271482451426, 'recall': 0.5788173432869943, 'f1-score': 0.3971449218580789, 'support': 2843175}, '2': {'precision': 0.39845295088658, 'recall': 0.19517367777712852, 'f1-score': 0.2620082189397166, 'support': 3371387}, 'accuracy': 0.34134434415170056, 'macro avg': {'precision': 0.36347082131011144, 'recall': 0.3535261878754266, 'f1-score': 0.3298106397047306, 'support': 9545279}, 'weighted avg': {'precision': 0.3667457356709925, 'recall': 0.34134434415170056, 'f1-score': 0.3260825333767625, 'support': 9545279}}
[[ 954542 1873368  502807]
 [ 706907 1645679  490589]
 [ 788054 1925327  658006]]
Evaluating performance on  train set...
8543/8543 - 118s - 118s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953466
{'0': {'precision': 0.3713708234766403, 'recall': 0.20157473239983653, 'f1-score': 0.26131269750017844, 'support': 690022}, '1': {'precision': 0.36705179773802715, 'recall': 0.7743505698408213, 'f1-score': 0.49803080283150847, 'support': 796275}, '2': {'precision': 0.37661817494804456, 'recall': 0.07115129000618198, 'f1-score': 0.11969047058653998, 'support': 700423}, 'accuracy': 0.3683704360869247, 'macro avg': {'precision': 0.37168026538757065, 'recall': 0.34902553074894654, 'f1-score': 0.29301132363940896, 'support': 2186720}, 'weighted avg': {'precision': 0.37147885442694084, 'recall': 0.3683704360869247, 'f1-score': 0.30214885589319335, 'support': 2186720}}
[[139091 519659  31272]
 [128462 616596  51217]
 [106981 543606  49836]]
Evaluating performance on  val set...
3077/3077 - 41s - 41s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0860046
{'0': {'precision': 0.3704272731837124, 'recall': 0.1565747028862479, 'f1-score': 0.22011128182943748, 'support': 235600}, '1': {'precision': 0.40047475466327065, 'recall': 0.8329113677527411, 'f1-score': 0.5408849176989863, 'support': 308082}, '2': {'precision': 0.37370724799382055, 'recall': 0.07159799556854572, 'f1-score': 0.12017235490759555, 'support': 243261}, 'accuracy': 0.39508706475564304, 'macro avg': {'precision': 0.3815364252802678, 'recall': 0.3536946887358449, 'f1-score': 0.2937228514786731, 'support': 786943}, 'weighted avg': {'precision': 0.3832045367739178, 'recall': 0.39508706475564304, 'f1-score': 0.3147983684215136, 'support': 786943}}
[[ 36889 186216  12495]
 [ 34783 256605  16694]
 [ 27913 197931  17417]]
testing model out of sample: results/universal/W10/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 293s - 293s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0937868
{'0': {'precision': 0.40417079165027975, 'recall': 0.30007663478212226, 'f1-score': 0.34443068297753626, 'support': 1787700}, '1': {'precision': 0.3715176495518951, 'recall': 0.6575851837290909, 'f1-score': 0.47479123356465996, 'support': 1882255}, '2': {'precision': 0.4048108637233691, 'recall': 0.1812731873909732, 'f1-score': 0.2504123953487744, 'support': 1790844}, 'accuracy': 0.38434339004237295, 'macro avg': {'precision': 0.39349976830851463, 'recall': 0.3796450019673954, 'f1-score': 0.3565447706303235, 'support': 5460799}, 'weighted avg': {'precision': 0.3931256550780061, 'recall': 0.38434339004237295, 'f1-score': 0.3585311308891192, 'support': 5460799}}
[[ 536447 1029494  221759]
 [ 388968 1237743  255544]
 [ 401863 1064349  324632]]
Evaluating performance on  train set...
4055/4055 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0830804
{'0': {'precision': 0.37815678286838883, 'recall': 0.3455269089663021, 'f1-score': 0.3611062284902298, 'support': 318091}, '1': {'precision': 0.4064918813383388, 'recall': 0.6017879033248684, 'f1-score': 0.4852262253197716, 'support': 398903}, '2': {'precision': 0.3834390176794661, 'recall': 0.1869816466241895, 'f1-score': 0.25137959892526573, 'support': 320486}, 'accuracy': 0.39508135096580177, 'macro avg': {'precision': 0.3893625606287312, 'recall': 0.3780988196384534, 'f1-score': 0.36590401757842245, 'support': 1037480}, 'weighted avg': {'precision': 0.3906831333432137, 'recall': 0.39508135096580177, 'f1-score': 0.37493395576452676, 'support': 1037480}}
[[109909 172125  36057]
 [ 98547 240055  60301]
 [ 82188 178373  59925]]
Evaluating performance on  val set...
1545/1545 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085236
{'0': {'precision': 0.3759546242427363, 'recall': 0.36309617536153815, 'f1-score': 0.36941354030092366, 'support': 120665}, '1': {'precision': 0.4025596718758901, 'recall': 0.5707747189876826, 'f1-score': 0.47213143961115966, 'support': 148570}, '2': {'precision': 0.3875802997858672, 'recall': 0.2088406143073128, 'f1-score': 0.27142746335031154, 'support': 125670}, 'accuracy': 0.3921398817437105, 'macro avg': {'precision': 0.38869819863483124, 'recall': 0.38090383621884455, 'f1-score': 0.3709908144207983, 'support': 394905}, 'weighted avg': {'precision': 0.3896635177041078, 'recall': 0.3921398817437105, 'f1-score': 0.37687581099928996, 'support': 394905}}
[[43813 61614 15238]
 [37538 84800 26232]
 [35187 64238 26245]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1329447
{'0': {'precision': 0.4604210448696678, 'recall': 0.22591674656728838, 'f1-score': 0.3031067961165048, 'support': 55277}, '1': {'precision': 0.21277294908236533, 'recall': 0.4719043801472196, 'f1-score': 0.2933016250495442, 'support': 27442}, '2': {'precision': 0.41686088203657223, 'recall': 0.3728528191457377, 'f1-score': 0.393630640639052, 'support': 49891}, 'accuracy': 0.332101651459166, 'macro avg': {'precision': 0.3633516253295351, 'recall': 0.35689131528674856, 'f1-score': 0.3300130206017003, 'support': 132610}, 'weighted avg': {'precision': 0.39278497573083115, 'recall': 0.332101651459166, 'f1-score': 0.33513493594498583, 'support': 132610}}
[[12488 25486 17303]
 [ 5773 12950  8719]
 [ 8862 22427 18602]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081433
{'0': {'precision': 0.3889905673659017, 'recall': 0.24162658504591167, 'f1-score': 0.2980904088898479, 'support': 11435}, '1': {'precision': 0.35188818048062775, 'recall': 0.6347872246306291, 'f1-score': 0.45278137128072443, 'support': 11303}, '2': {'precision': 0.3850658857979502, 'recall': 0.22701769529564092, 'f1-score': 0.28563670920445283, 'support': 11585}, 'accuracy': 0.3661684584680826, 'macro avg': {'precision': 0.3753148778814932, 'recall': 0.3678105016573939, 'f1-score': 0.34550282979167507, 'support': 34323}, 'weighted avg': {'precision': 0.3754475870049493, 'recall': 0.3661684584680826, 'f1-score': 0.34482862632564243, 'support': 34323}}
[[2763 6494 2178]
 [2106 7175 2022]
 [2234 6721 2630]]
Evaluating performance on  val set...
46/46 - 1s - 827ms/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1188442
{'0': {'precision': 0.4582798459563543, 'recall': 0.24620689655172415, 'f1-score': 0.3203230148048452, 'support': 4350}, '1': {'precision': 0.30771544593171907, 'recall': 0.6185006045949214, 'f1-score': 0.4109671587827659, 'support': 3308}, '2': {'precision': 0.3798219584569733, 'recall': 0.2544731610337972, 'f1-score': 0.3047619047619048, 'support': 4024}, 'accuracy': 0.35447697312104093, 'macro avg': {'precision': 0.38193908344834887, 'recall': 0.3730602207268143, 'f1-score': 0.345350692783172, 'support': 11682}, 'weighted avg': {'precision': 0.38861869422043555, 'recall': 0.35447697312104093, 'f1-score': 0.3406305752796072, 'support': 11682}}
[[1071 2332  947]
 [ 537 2046  725]
 [ 729 2271 1024]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0542184
{'0': {'precision': 0.3527413710286146, 'recall': 0.4280004995628825, 'f1-score': 0.3867436567795814, 'support': 120105}, '1': {'precision': 0.5085993577816227, 'recall': 0.5788570530342063, 'f1-score': 0.5414586230627695, 'support': 229022}, '2': {'precision': 0.359038681904054, 'recall': 0.19029875246224556, 'f1-score': 0.24875280284092738, 'support': 121840}, 'accuracy': 0.4398652134862952, 'macro avg': {'precision': 0.40679313690476376, 'recall': 0.3990521016864448, 'f1-score': 0.39231836089442607, 'support': 470967}, 'weighted avg': {'precision': 0.4301611736882722, 'recall': 0.4398652134862952, 'f1-score': 0.4262800263431022, 'support': 470967}}
[[ 51405  59446   9254]
 [ 64313 132571  32138]
 [ 30012  68642  23186]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0273244
{'0': {'precision': 0.28222938694229766, 'recall': 0.4572514979259487, 'f1-score': 0.34902811574657716, 'support': 26036}, '1': {'precision': 0.6396763542255407, 'recall': 0.5172836833369416, 'f1-score': 0.5720061711975316, 'support': 83142}, '2': {'precision': 0.2928227823744468, 'recall': 0.2901651222209511, 'f1-score': 0.291487894575544, 'support': 26223}, 'accuracy': 0.46175434450262554, 'macro avg': {'precision': 0.40490950784742835, 'recall': 0.42156676782794716, 'f1-score': 0.40417406050655097, 'support': 135401}, 'weighted avg': {'precision': 0.5037687135520025, 'recall': 0.46175434450262554, 'f1-score': 0.4748024029862227, 'support': 135401}}
[[11905 11332  2799]
 [24557 43008 15577]
 [ 5720 12894  7609]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0461793
{'0': {'precision': 0.33600949455459367, 'recall': 0.3894643146140152, 'f1-score': 0.3607675586537741, 'support': 12358}, '1': {'precision': 0.5768594113851248, 'recall': 0.7328818392443415, 'f1-score': 0.6455775691544475, 'support': 28055}, '2': {'precision': 0.34574638844301764, 'recall': 0.08501065593180204, 'f1-score': 0.13646730866700457, 'support': 12669}, 'accuracy': 0.498304510003391, 'macro avg': {'precision': 0.419538431460912, 'recall': 0.40245226993005284, 'f1-score': 0.3809374788250754, 'support': 53082}, 'weighted avg': {'precision': 0.46562784211785413, 'recall': 0.498304510003391, 'f1-score': 0.45776249059895346, 'support': 53082}}
[[ 4813  7033   512]
 [ 5968 20561  1526]
 [ 3543  8049  1077]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1304125
{'0': {'precision': 0.39551285161999966, 'recall': 0.26659179868508565, 'f1-score': 0.3185009574177076, 'support': 91717}, '1': {'precision': 0.30022428218219677, 'recall': 0.54070336517915, 'f1-score': 0.38607906445643186, 'support': 72537}, '2': {'precision': 0.3491711904718677, 'recall': 0.23091793240079245, 'f1-score': 0.27799138504235205, 'support': 83285}, 'accuracy': 0.33491288241448824, 'macro avg': {'precision': 0.3483027747580214, 'recall': 0.34607103208834267, 'f1-score': 0.32752380230549716, 'support': 247539}, 'weighted avg': {'precision': 0.3519984469806011, 'recall': 0.33491288241448824, 'f1-score': 0.3246740186928459, 'support': 247539}}
[[24451 47751 19515]
 [16984 39221 16332]
 [20386 43667 19232]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143174
{'0': {'precision': 0.35347387173396677, 'recall': 0.2601332896318147, 'f1-score': 0.29970419787274216, 'support': 18306}, '1': {'precision': 0.333461159197984, 'recall': 0.663216387012421, 'f1-score': 0.4437882764654419, 'support': 18356}, '2': {'precision': 0.38965791567223546, 'recall': 0.12492985767484568, 'f1-score': 0.18919962917181704, 'support': 19603}, 'accuracy': 0.3445303474628988, 'macro avg': {'precision': 0.3588643155347288, 'recall': 0.3494265114396938, 'f1-score': 0.31089736783666705, 'support': 56265}, 'weighted avg': {'precision': 0.3595515836687643, 'recall': 0.3445303474628988, 'f1-score': 0.3082101302712734, 'support': 56265}}
[[ 4762 11771  1773]
 [ 4119 12174  2063]
 [ 4591 12563  2449]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1117283
{'0': {'precision': 0.3885147774036663, 'recall': 0.30219700276444056, 'f1-score': 0.339962353711433, 'support': 6873}, '1': {'precision': 0.3369575864433343, 'recall': 0.5348258706467661, 'f1-score': 0.4134366925064599, 'support': 6432}, '2': {'precision': 0.34818629646215854, 'recall': 0.23153662894580107, 'f1-score': 0.27812555893400104, 'support': 6716}, 'accuracy': 0.35322910943509317, 'macro avg': {'precision': 0.35788622010305304, 'recall': 0.3561865007856692, 'f1-score': 0.34384153505063136, 'support': 20021}, 'weighted avg': {'precision': 0.3584232769661247, 'recall': 0.35322910943509317, 'f1-score': 0.3428239007572539, 'support': 20021}}
[[2077 3321 1475]
 [1556 3440 1436]
 [1713 3448 1555]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1305944
{'0': {'precision': 0.3774348459504667, 'recall': 0.2857259563343749, 'f1-score': 0.32523916353787674, 'support': 146889}, '1': {'precision': 0.2653244421646576, 'recall': 0.46851947011331074, 'f1-score': 0.33879048383795446, 'support': 114817}, '2': {'precision': 0.37264457439896037, 'recall': 0.23799972333656108, 'f1-score': 0.2904777984129664, 'support': 144580}, 'accuracy': 0.32039991533057993, 'macro avg': {'precision': 0.33846795417136155, 'recall': 0.3307483832614156, 'f1-score': 0.3181691485962658, 'support': 406286}, 'weighted avg': {'precision': 0.34404763179001807, 'recall': 0.32039991533057993, 'f1-score': 0.31669868656632094, 'support': 406286}}
[[41970 74229 30690]
 [33783 53794 27240]
 [35445 74725 34410]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1106461
{'0': {'precision': 0.37247437774524156, 'recall': 0.1977074023703128, 'f1-score': 0.25830689173753013, 'support': 25735}, '1': {'precision': 0.3338565481471371, 'recall': 0.7870329405140168, 'f1-score': 0.4688349805330937, 'support': 24863}, '2': {'precision': 0.3769422001243008, 'recall': 0.0487305158283786, 'f1-score': 0.0863038064745642, 'support': 24892}, 'accuracy': 0.3426811498211684, 'macro avg': {'precision': 0.3610910420055598, 'recall': 0.3444902862375694, 'f1-score': 0.27114855958172934, 'support': 75490}, 'weighted avg': {'precision': 0.36122862251093063, 'recall': 0.3426811498211684, 'f1-score': 0.2709292135464896, 'support': 75490}}
[[ 5088 19656   991]
 [ 4281 19568  1014]
 [ 4291 19388  1213]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1174426
{'0': {'precision': 0.3541115903715041, 'recall': 0.23269635183322665, 'f1-score': 0.2808430809975722, 'support': 10937}, '1': {'precision': 0.3281435830900638, 'recall': 0.5187147496154504, 'f1-score': 0.40198675496688746, 'support': 11702}, '2': {'precision': 0.30134306950058676, 'recall': 0.2156789547363509, 'f1-score': 0.25141427328111404, 'support': 10715}, 'accuracy': 0.32757690232056125, 'macro avg': {'precision': 0.32786608098738484, 'recall': 0.322363352061676, 'f1-score': 0.3114147030818579, 'support': 33354}, 'weighted avg': {'precision': 0.3280489795200532, 'recall': 0.32757690232056125, 'f1-score': 0.3138913989836332, 'support': 33354}}
[[2545 6068 2324]
 [2598 6070 3034]
 [2044 6360 2311]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
2104/2104 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1318452
{'0': {'precision': 0.41615105210420844, 'recall': 0.31892703903857783, 'f1-score': 0.3611094506545519, 'support': 208358}, '1': {'precision': 0.23988015111381303, 'recall': 0.44614403049563484, 'f1-score': 0.3120038631954387, 'support': 123821}, '2': {'precision': 0.4069492768741041, 'recall': 0.29299551317459854, 'f1-score': 0.34069633465080446, 'support': 206382}, 'accuracy': 0.338238379682153, 'macro avg': {'precision': 0.3543268266973752, 'recall': 0.35268886090293705, 'f1-score': 0.337936549500265, 'support': 538561}, 'weighted avg': {'precision': 0.3720982521297002, 'recall': 0.338238379682153, 'f1-score': 0.34199703320906244, 'support': 538561}}
[[66451 88733 53174]
 [33631 55242 34948]
 [59598 86315 60469]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1091979
{'0': {'precision': 0.3803228676750985, 'recall': 0.32922535211267606, 'f1-score': 0.35293423768799764, 'support': 36352}, '1': {'precision': 0.35361728224099387, 'recall': 0.4898602356810085, 'f1-score': 0.4107354174565424, 'support': 36490}, '2': {'precision': 0.3711103832296102, 'recall': 0.2782112845138055, 'f1-score': 0.31801525051068935, 'support': 36652}, 'accuracy': 0.3656821378340366, 'macro avg': {'precision': 0.3683501777152342, 'recall': 0.3657656241024967, 'f1-score': 0.36056163521840984, 'support': 109494}, 'weighted avg': {'precision': 0.36833917183435366, 'recall': 0.3656821378340366, 'f1-score': 0.36050829957021485, 'support': 109494}}
[[11968 16011  8373]
 [ 9708 17875  8907]
 [ 9792 16663 10197]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1076274
{'0': {'precision': 0.38368, 'recall': 0.396069039557354, 'f1-score': 0.3897760981754642, 'support': 12109}, '1': {'precision': 0.3300738246341148, 'recall': 0.4523830655897754, 'f1-score': 0.38166910030326856, 'support': 11267}, '2': {'precision': 0.3907916196211266, 'recall': 0.248464544946957, 'f1-score': 0.3037838892139653, 'support': 12537}, 'accuracy': 0.36220867095480747, 'macro avg': {'precision': 0.3681818147517471, 'recall': 0.36563888336469547, 'f1-score': 0.358409695897566, 'support': 35913}, 'weighted avg': {'precision': 0.36934473414481206, 'recall': 0.36220867095480747, 'f1-score': 0.3572133529640828, 'support': 35913}}
[[4796 4927 2386]
 [3700 5097 2470]
 [4004 5418 3115]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
5267/5267 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0621634
{'0': {'precision': 0.3959521839263816, 'recall': 0.4879482397230147, 'f1-score': 0.43716275270843563, 'support': 406953}, '1': {'precision': 0.42149402355267573, 'recall': 0.5005680410209489, 'f1-score': 0.4576404252556771, 'support': 524610}, '2': {'precision': 0.4531309382754689, 'recall': 0.2432517413699577, 'f1-score': 0.31656413356010876, 'support': 416626}, 'accuracy': 0.41724120282838684, 'macro avg': {'precision': 0.4235257152515088, 'recall': 0.4105893407046404, 'f1-score': 0.4037891038414072, 'support': 1348189}, 'weighted avg': {'precision': 0.42356082054616784, 'recall': 0.41724120282838684, 'f1-score': 0.4078629078748979, 'support': 1348189}}
[[198572 172863  35518]
 [175215 262603  86792]
 [127718 187563 101345]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0502603
{'0': {'precision': 0.383998822240034, 'recall': 0.33000168690958165, 'f1-score': 0.3549584558740143, 'support': 71136}, '1': {'precision': 0.4977331008308544, 'recall': 0.7569928706260433, 'f1-score': 0.6005780024877623, 'support': 128202}, '2': {'precision': 0.42316831683168316, 'recall': 0.08913451511991657, 'f1-score': 0.14725236864771749, 'support': 71925}, 'accuracy': 0.46793702052989167, 'macro avg': {'precision': 0.4349667466341905, 'recall': 0.39204302421851384, 'f1-score': 0.3675962756698314, 'support': 271263}, 'weighted avg': {'precision': 0.44813668063725265, 'recall': 0.46793702052989167, 'f1-score': 0.4159680915088938, 'support': 271263}}
[[23475 45520  2141]
 [24556 97048  6598]
 [13102 52412  6411]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0480428
{'0': {'precision': 0.3776759756849617, 'recall': 0.33564298297122724, 'f1-score': 0.35542106244947874, 'support': 25545}, '1': {'precision': 0.530189572853065, 'recall': 0.8088579909389157, 'f1-score': 0.6405270198173678, 'support': 51208}, '2': {'precision': 0.37233630375823323, 'recall': 0.03605597868907815, 'f1-score': 0.06574536498597523, 'support': 26653}, 'accuracy': 0.4927663771928128, 'macro avg': {'precision': 0.42673395076542, 'recall': 0.3935189841997404, 'f1-score': 0.35389781575094054, 'support': 103406}, 'weighted avg': {'precision': 0.45182639256523105, 'recall': 0.4927663771928128, 'f1-score': 0.42194505042309827, 'support': 103406}}
[[ 8574 16447   524]
 [ 8692 41420  1096]
 [ 5436 20256   961]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
10110/10110 - 147s - 147s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0812305
{'0': {'precision': 0.3990069526180048, 'recall': 0.23859056272882972, 'f1-score': 0.2986187714550914, 'support': 780056}, '1': {'precision': 0.40726786218817, 'recall': 0.7244883277225459, 'f1-score': 0.5214211595080755, 'support': 1014712}, '2': {'precision': 0.39799360683285534, 'recall': 0.15882359614436814, 'f1-score': 0.22704318595647802, 'support': 793333}, 'accuracy': 0.4046445637167947, 'macro avg': {'precision': 0.4014228072130101, 'recall': 0.37396749553191455, 'f1-score': 0.34902770563988167, 'support': 2588101}, 'weighted avg': {'precision': 0.40193517041939336, 'recall': 0.4046445637167947, 'f1-score': 0.36403236343455747, 'support': 2588101}}
[[186114 522345  71597]
 [160574 735147 118991]
 [119755 547578 126000]]
Evaluating performance on  train set...
1686/1686 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0600407
{'0': {'precision': 0.3667878174457122, 'recall': 0.40570798524235613, 'f1-score': 0.3852674562360815, 'support': 117905}, '1': {'precision': 0.4933615991363549, 'recall': 0.5754052668186365, 'f1-score': 0.5312344003768518, 'support': 196969}, '2': {'precision': 0.3714649717197738, 'recall': 0.22737244417022298, 'f1-score': 0.28208290364763294, 'support': 116694}, 'accuracy': 0.4349372520668817, 'macro avg': {'precision': 0.41053812943394696, 'recall': 0.4028285654104052, 'f1-score': 0.3995282534201887, 'support': 431568}, 'weighted avg': {'precision': 0.4258211726682531, 'recall': 0.4349372520668817, 'f1-score': 0.42398660325510734, 'support': 431568}}
[[ 47835  57523  12547]
 [ 51284 113337  32348]
 [ 31297  58864  26533]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0722666
{'0': {'precision': 0.38793450158000575, 'recall': 0.38559354298332443, 'f1-score': 0.3867604800137474, 'support': 52532}, '1': {'precision': 0.4336971162514451, 'recall': 0.5636155637947432, 'f1-score': 0.4901941980340447, 'support': 72553}, '2': {'precision': 0.3745281906109932, 'recall': 0.22955412170832656, 'f1-score': 0.2846449501910557, 'support': 55329}, 'accuracy': 0.4093307614708393, 'macro avg': {'precision': 0.39871993614748136, 'recall': 0.3929210761621314, 'f1-score': 0.387199876079616, 'support': 180414}, 'weighted avg': {'precision': 0.4022263924679215, 'recall': 0.4093307614708393, 'f1-score': 0.3970394849355768, 'support': 180414}}
[[20256 26141  6135]
 [16585 40892 15076]
 [15374 27254 12701]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
6546/6546 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0930799
{'0': {'precision': 0.42297554582993346, 'recall': 0.1541895010095183, 'f1-score': 0.22599562710140236, 'support': 554720}, '1': {'precision': 0.36434685481109785, 'recall': 0.5636812032164504, 'f1-score': 0.44260617280162556, 'support': 575790}, '2': {'precision': 0.3829916482053165, 'recall': 0.40932474292033694, 'f1-score': 0.39572059772625723, 'support': 545259}, 'accuracy': 0.37790530795115557, 'macro avg': {'precision': 0.3901046829487826, 'recall': 0.37573181571543524, 'f1-score': 0.3547741325430951, 'support': 1675769}, 'weighted avg': {'precision': 0.3898209797551127, 'recall': 0.37790530795115557, 'f1-score': 0.3556472997762574, 'support': 1675769}}
[[ 85532 294165 175023]
 [ 66690 324562 184538]
 [ 49993 272078 223188]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0982454
{'0': {'precision': 0.4160101482173855, 'recall': 0.2889645321659123, 'f1-score': 0.34103970312961807, 'support': 107816}, '1': {'precision': 0.33451180435136396, 'recall': 0.587153523374244, 'f1-score': 0.426206299893822, 'support': 101522}, '2': {'precision': 0.40314187053158895, 'recall': 0.23585818347370818, 'f1-score': 0.2976034467283009, 'support': 105432}, 'accuracy': 0.3673507640499412, 'macro avg': {'precision': 0.3845546077001128, 'recall': 0.37065874633795476, 'f1-score': 0.3549498165839136, 'support': 314770}, 'weighted avg': {'precision': 0.38541446527766715, 'recall': 0.3673507640499412, 'f1-score': 0.3539593328649545, 'support': 314770}}
[[31155 60185 16476]
 [21573 59609 20340]
 [22162 58403 24867]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085223
{'0': {'precision': 0.4225464353583032, 'recall': 0.1906671830050896, 'f1-score': 0.2627656532926713, 'support': 36152}, '1': {'precision': 0.37738567257799255, 'recall': 0.7040481400437637, 'f1-score': 0.491380383628954, 'support': 42044}, '2': {'precision': 0.3984157567972597, 'recall': 0.21124921959248538, 'f1-score': 0.27610251845257966, 'support': 35238}, 'accuracy': 0.387344182520232, 'macro avg': {'precision': 0.3994492882445185, 'recall': 0.3686548475471129, 'f1-score': 0.343416185124735, 'support': 113434}, 'weighted avg': {'precision': 0.39831158547670303, 'recall': 0.387344182520232, 'f1-score': 0.35164413925599375, 'support': 113434}}
[[ 6893 25023  4236]
 [ 5439 29601  7004]
 [ 3981 23813  7444]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
7633/7633 - 109s - 109s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925682
{'0': {'precision': 0.404814719762517, 'recall': 0.37965359072317306, 'f1-score': 0.39183064473383383, 'support': 652292}, '1': {'precision': 0.3579336894565639, 'recall': 0.6148447439428467, 'f1-score': 0.45246407627147706, 'support': 643743}, '2': {'precision': 0.4241293847962714, 'recall': 0.1524151421150143, 'f1-score': 0.2242454396547387, 'support': 657953}, 'accuracy': 0.38062106829724646, 'macro avg': {'precision': 0.3956259313384507, 'recall': 0.3823044922603447, 'f1-score': 0.35618005355334986, 'support': 1953988}, 'weighted avg': {'precision': 0.3958734195655396, 'recall': 0.38062106829724646, 'f1-score': 0.35537656143390123, 'support': 1953988}}
[[247645 344779  59868]
 [171649 395802  76292]
 [192455 365216 100282]]
Evaluating performance on  train set...
1586/1586 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0938026
{'0': {'precision': 0.3966746502187, 'recall': 0.3198973846509512, 'f1-score': 0.3541728590772483, 'support': 134093}, '1': {'precision': 0.3542311834531948, 'recall': 0.6612880656920868, 'f1-score': 0.461338087506936, 'support': 135785}, '2': {'precision': 0.4106641932856755, 'recall': 0.1335250676709427, 'f1-score': 0.20152534470125893, 'support': 135952}, 'accuracy': 0.371687652465318, 'macro avg': {'precision': 0.3871900089858567, 'recall': 0.3715701726713269, 'f1-score': 0.3390120970951478, 'support': 405830}, 'weighted avg': {'precision': 0.38716012498470387, 'recall': 0.371687652465318, 'f1-score': 0.33889231221743177, 'support': 405830}}
[[42896 80095 11102]
 [31043 89793 14949]
 [34200 83599 18153]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889487
{'0': {'precision': 0.35275395033860046, 'recall': 0.34880917836655434, 'f1-score': 0.3507704739565213, 'support': 44801}, '1': {'precision': 0.3949449711753776, 'recall': 0.6027631339756407, 'f1-score': 0.4772102528676079, 'support': 55010}, '2': {'precision': 0.40985015306944517, 'recall': 0.16214091449940507, 'f1-score': 0.23235844891372195, 'support': 47064}, 'accuracy': 0.38410893617021274, 'macro avg': {'precision': 0.38584969152780774, 'recall': 0.37123774228053336, 'f1-score': 0.353446391912617, 'support': 146875}, 'weighted avg': {'precision': 0.38685167794068104, 'recall': 0.38410893617021274, 'f1-score': 0.3601832990886715, 'support': 146875}}
[[15627 24808  4366]
 [15230 33158  6622]
 [13443 25990  7631]]
testing model on single stock: results/universal/W10/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
22048/22048 - 300s - 300s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1239293
{'0': {'precision': 0.3875132333421108, 'recall': 0.27443543207820936, 'f1-score': 0.3213160390941746, 'support': 2102050}, '1': {'precision': 0.251756058998391, 'recall': 0.6239806538683685, 'f1-score': 0.3587628747341108, 'support': 1398936}, '2': {'precision': 0.4009661063501729, 'recall': 0.12874635688228447, 'f1-score': 0.19490923476046418, 'support': 2143082}, 'accuracy': 0.3057546436364693, 'macro avg': {'precision': 0.3467451328968916, 'recall': 0.3423874809429541, 'f1-score': 0.2916627161962499, 'support': 5644068}, 'weighted avg': {'precision': 0.35897265083037594, 'recall': 0.3057546436364693, 'f1-score': 0.28260027227805773, 'support': 5644068}}
[[ 576877 1272518  252655]
 [ 366473  872909  159554]
 [ 545314 1321854  275914]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093504
{'0': {'precision': 0.3693816309463293, 'recall': 0.14713291341805665, 'f1-score': 0.2104420722213226, 'support': 459299}, '1': {'precision': 0.33652694306400155, 'recall': 0.8662795008570569, 'f1-score': 0.4847436488818273, 'support': 458546}, '2': {'precision': 0.37270013978616495, 'recall': 0.020902593701464772, 'f1-score': 0.03958508888086353, 'support': 471951}, 'accuracy': 0.3415407728904098, 'macro avg': {'precision': 0.3595362379321652, 'recall': 0.3447716693255261, 'f1-score': 0.24492360332800447, 'support': 1389796}, 'weighted avg': {'precision': 0.35966854201513326, 'recall': 0.3415407728904098, 'f1-score': 0.24292436935475425, 'support': 1389796}}
[[ 67578 382962   8759]
 [ 53472 397229   7845]
 [ 61899 400187   9865]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0962029
{'0': {'precision': 0.36522029201200895, 'recall': 0.0945036120259216, 'f1-score': 0.15015376175631268, 'support': 150608}, '1': {'precision': 0.36996495237564364, 'recall': 0.9098547463058267, 'f1-score': 0.5260340471905289, 'support': 175073}, '2': {'precision': 0.3869439139967466, 'recall': 0.03462965072854557, 'f1-score': 0.06357007988380538, 'support': 157986}, 'accuracy': 0.3700790006347342, 'macro avg': {'precision': 0.3740430527947997, 'recall': 0.34632933635343127, 'f1-score': 0.24658596294354898, 'support': 483667}, 'weighted avg': {'precision': 0.3740335665722402, 'recall': 0.3700790006347342, 'f1-score': 0.2579293173503776, 'support': 483667}}
[[ 14233 131595   4780]
 [ 11894 159291   3888]
 [ 12844 139671   5471]]
training model: results/universal/W10/deepLOB_L2/h200
Epoch 1/50
8543/8543 - 358s - loss: 3.2412 - accuracy200: 0.3982 - val_loss: 3.3288 - val_accuracy200: 0.3601 - 358s/epoch - 42ms/step
Epoch 2/50
8543/8543 - 379s - loss: 3.2228 - accuracy200: 0.4070 - val_loss: 3.3432 - val_accuracy200: 0.3604 - 379s/epoch - 44ms/step
Epoch 3/50
8543/8543 - 392s - loss: 3.2119 - accuracy200: 0.4127 - val_loss: 3.3890 - val_accuracy200: 0.3581 - 392s/epoch - 46ms/step
Epoch 4/50
8543/8543 - 343s - loss: 3.2038 - accuracy200: 0.4173 - val_loss: 3.4318 - val_accuracy200: 0.3436 - 343s/epoch - 40ms/step
Epoch 5/50
8543/8543 - 342s - loss: 3.1984 - accuracy200: 0.4199 - val_loss: 3.4208 - val_accuracy200: 0.3556 - 342s/epoch - 40ms/step
Epoch 6/50
8543/8543 - 343s - loss: 3.1935 - accuracy200: 0.4225 - val_loss: 3.3980 - val_accuracy200: 0.3586 - 343s/epoch - 40ms/step
Epoch 7/50
8543/8543 - 362s - loss: 3.1880 - accuracy200: 0.4248 - val_loss: 3.4266 - val_accuracy200: 0.3576 - 362s/epoch - 42ms/step
Epoch 8/50
8543/8543 - 396s - loss: 3.1839 - accuracy200: 0.4264 - val_loss: 3.5154 - val_accuracy200: 0.3505 - 396s/epoch - 46ms/step
Epoch 9/50
8543/8543 - 344s - loss: 3.1801 - accuracy200: 0.4282 - val_loss: 3.4538 - val_accuracy200: 0.3591 - 344s/epoch - 40ms/step
Epoch 10/50
8543/8543 - 343s - loss: 3.1769 - accuracy200: 0.4292 - val_loss: 3.4930 - val_accuracy200: 0.3561 - 343s/epoch - 40ms/step
Epoch 11/50
8543/8543 - 348s - loss: 3.1737 - accuracy200: 0.4303 - val_loss: 3.5373 - val_accuracy200: 0.3534 - 348s/epoch - 41ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 565s - 565s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1331687
{'0': {'precision': 0.3858497600319257, 'recall': 0.03204172811319126, 'f1-score': 0.05916987282205556, 'support': 3439983}, '1': {'precision': 0.2769951369784663, 'recall': 0.8587962840949052, 'f1-score': 0.4188839428363652, 'support': 2656042}, '2': {'precision': 0.368290759920298, 'recall': 0.10942395080211548, 'f1-score': 0.16871923384335344, 'support': 3449254}, 'accuracy': 0.29005469614874535, 'macro avg': {'precision': 0.3437118856435633, 'recall': 0.3334206543367373, 'f1-score': 0.2155910165005914, 'support': 9545279}, 'weighted avg': {'precision': 0.34921511560768326, 'recall': 0.29005469614874535, 'f1-score': 0.19884931536628112, 'support': 9545279}}
[[ 110223 2976619  353141]
 [  80797 2280999  294246]
 [  94643 2977180  377431]]
Evaluating performance on  train set...
8543/8543 - 121s - 121s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1159104
{'0': {'precision': 0.36421346538826255, 'recall': 0.019237244039056044, 'f1-score': 0.03654427097787046, 'support': 718762}, '1': {'precision': 0.33845744139157974, 'recall': 0.9531837828375995, 'f1-score': 0.49953832111186813, 'support': 742670}, '2': {'precision': 0.33773271567170704, 'recall': 0.026637694267656435, 'f1-score': 0.049380633436976434, 'support': 725288}, 'accuracy': 0.3388856369356845, 'macro avg': {'precision': 0.3468012074838498, 'recall': 0.33301957371477064, 'f1-score': 0.195154408508905, 'support': 2186720}, 'weighted avg': {'precision': 0.3466829190256567, 'recall': 0.3388856369356845, 'f1-score': 0.19804727587481938, 'support': 2186720}}
[[ 13827 689105  15830]
 [ 12714 707901  22055]
 [ 11423 694545  19320]]
Evaluating performance on  val set...
3077/3077 - 41s - 41s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1081742
{'0': {'precision': 0.3598458304134548, 'recall': 0.008311011483276821, 'f1-score': 0.016246786632390747, 'support': 247142}, '1': {'precision': 0.36096233495921287, 'recall': 0.9657302363516834, 'f1-score': 0.5255056802040798, 'support': 284449}, '2': {'precision': 0.32274503982979563, 'recall': 0.025545129859958018, 'f1-score': 0.04734307581206476, 'support': 255352}, 'accuracy': 0.3599727045033757, 'macro avg': {'precision': 0.3478510684008211, 'recall': 0.33319545923163946, 'f1-score': 0.19636518088284513, 'support': 786943}, 'weighted avg': {'precision': 0.34821071519471314, 'recall': 0.3599727045033757, 'f1-score': 0.21041419475747924, 'support': 786943}}
[[  2054 239159   5929]
 [  1989 274701   7759]
 [  1665 247164   6523]]
testing model out of sample: results/universal/W10/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 287s - 287s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1315693
{'0': {'precision': 0.4016069067285027, 'recall': 0.04276072308344475, 'f1-score': 0.07729186635076815, 'support': 1960327}, '1': {'precision': 0.2851554962235503, 'recall': 0.9221977700763937, 'f1-score': 0.4356136187849692, 'support': 1546331}, '2': {'precision': 0.38606526706314137, 'recall': 0.04963050260958651, 'f1-score': 0.08795409355863341, 'support': 1954141}, 'accuracy': 0.294248698771004, 'macro avg': {'precision': 0.35760922333839806, 'recall': 0.33819633192314164, 'f1-score': 0.2002865262314569, 'support': 5460799}, 'weighted avg': {'precision': 0.36306987554774645, 'recall': 0.294248698771004, 'f1-score': 0.18257307686621388, 'support': 5460799}}
[[  83825 1789874   86628]
 [  52707 1426023   67601]
 [  72192 1784964   96985]]
Evaluating performance on  train set...
4055/4055 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147397
{'0': {'precision': 0.35353725405870334, 'recall': 0.03810265962531757, 'f1-score': 0.06879130132347289, 'support': 345199}, '1': {'precision': 0.3363555181786261, 'recall': 0.8911879308909123, 'f1-score': 0.48838349227729816, 'support': 348261}, '2': {'precision': 0.3476735788713505, 'recall': 0.07836753677111796, 'f1-score': 0.12790465979068422, 'support': 344020}, 'accuracy': 0.3378175964837876, 'macro avg': {'precision': 0.34585545036955995, 'recall': 0.33588604242911596, 'f1-score': 0.22835981779715175, 'support': 1037480}, 'weighted avg': {'precision': 0.3458253463040626, 'recall': 0.3378175964837876, 'f1-score': 0.22924140503020476, 'support': 1037480}}
[[ 13153 307368  24678]
 [ 11989 310366  25906]
 [ 12062 304998  26960]]
Evaluating performance on  val set...
1545/1545 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114431
{'0': {'precision': 0.34011280123055887, 'recall': 0.04619420135100629, 'f1-score': 0.08134069078275087, 'support': 129237}, '1': {'precision': 0.3367118072105951, 'recall': 0.8740587235076213, 'f1-score': 0.4861464413506296, 'support': 131736}, '2': {'precision': 0.37088432297996216, 'recall': 0.09798255831317385, 'f1-score': 0.15501284587898295, 'support': 133932}, 'accuracy': 0.33992479203859155, 'macro avg': {'precision': 0.34923631047370535, 'recall': 0.3394118277239338, 'f1-score': 0.2408333260041212, 'support': 394905}, 'weighted avg': {'precision': 0.3494144259320115, 'recall': 0.33992479203859155, 'f1-score': 0.24136537882964473, 'support': 394905}}
[[  5970 111920  11347]
 [  5678 115145  10913]
 [  5905 114904  13123]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1316441
{'0': {'precision': 0.48074179743223966, 'recall': 0.006485383830802686, 'f1-score': 0.012798116360322041, 'support': 51963}, '1': {'precision': 0.28190569959523026, 'recall': 0.6998832124718216, 'f1-score': 0.4019215622051174, 'support': 36819}, '2': {'precision': 0.3475641373861083, 'recall': 0.32116455234096924, 'f1-score': 0.3338432530506244, 'support': 43828}, 'accuracy': 0.3030088228640374, 'macro avg': {'precision': 0.37007054480452606, 'recall': 0.3425110495478645, 'f1-score': 0.2495209772053546, 'support': 132610}, 'weighted avg': {'precision': 0.38151959118261525, 'recall': 0.3030088228640374, 'f1-score': 0.2269441264909464, 'support': 132610}}
[[  337 36074 15552]
 [  179 25769 10871]
 [  185 29567 14076]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1199636
{'0': {'precision': 0.31767337807606266, 'recall': 0.02453351762266759, 'f1-score': 0.04554931836407378, 'support': 11576}, '1': {'precision': 0.32852370949412857, 'recall': 0.8463449254790631, 'f1-score': 0.47331993748604595, 'support': 11272}, '2': {'precision': 0.3366742596810934, 'recall': 0.12880174291938998, 'f1-score': 0.18632209265679167, 'support': 11475}, 'accuracy': 0.32928357078343967, 'macro avg': {'precision': 0.3276237824170949, 'recall': 0.3332267286737069, 'f1-score': 0.23506378283563714, 'support': 34323}, 'weighted avg': {'precision': 0.32758917949674754, 'recall': 0.32928357078343967, 'f1-score': 0.2330969687370542, 'support': 34323}}
[[ 284 9855 1437]
 [ 257 9540 1475]
 [ 353 9644 1478]]
Evaluating performance on  val set...
46/46 - 1s - 878ms/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1271769
{'0': {'precision': 0.35668789808917195, 'recall': 0.012770809578107183, 'f1-score': 0.024658740642888595, 'support': 4385}, '1': {'precision': 0.28867521367521365, 'recall': 0.7912152269399707, 'f1-score': 0.42301369863013694, 'support': 3415}, '2': {'precision': 0.33856812933025404, 'recall': 0.1888201957753735, 'f1-score': 0.24243426492475612, 'support': 3882}, 'accuracy': 0.2988358157849683, 'macro avg': {'precision': 0.3279770803648799, 'recall': 0.3309354107644838, 'f1-score': 0.2300355680659272, 'support': 11682}, 'weighted avg': {'precision': 0.33078443467573354, 'recall': 0.2988358157849683, 'f1-score': 0.21347801532091143, 'support': 11682}}
[[  56 3562  767]
 [  48 2702  665]
 [  53 3096  733]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
1840/1840 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116897
{'0': {'precision': 0.3449911423509915, 'recall': 0.03929852427108626, 'f1-score': 0.07055949695531738, 'support': 153619}, '1': {'precision': 0.319014260575231, 'recall': 0.837219719624989, 'f1-score': 0.4619913172745851, 'support': 158502}, '2': {'precision': 0.28619052698954556, 'recall': 0.0675559976329275, 'f1-score': 0.10930926648399224, 'support': 158846}, 'accuracy': 0.3173661848919351, 'macro avg': {'precision': 0.3167319766385894, 'recall': 0.3146914138430009, 'f1-score': 0.21395336023796488, 'support': 470967}, 'weighted avg': {'precision': 0.31641667691514175, 'recall': 0.3173661848919351, 'f1-score': 0.21536363880558812, 'support': 470967}}
[[  6037 140089   7493]
 [  6529 132701  19272]
 [  4933 143182  10731]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0701994
{'0': {'precision': 0.35658497172098036, 'recall': 0.03712635298076384, 'f1-score': 0.06725079365079364, 'support': 35662}, '1': {'precision': 0.46956026213315605, 'recall': 0.8509333291608643, 'f1-score': 0.6051744283091304, 'support': 63911}, '2': {'precision': 0.2781523725502552, 'recall': 0.12319973205314279, 'f1-score': 0.17076426098226202, 'support': 35828}, 'accuracy': 0.4440292169186343, 'macro avg': {'precision': 0.36809920213479724, 'recall': 0.3370864713982569, 'f1-score': 0.2810631609807287, 'support': 135401}, 'weighted avg': {'precision': 0.3891569661851558, 'recall': 0.4440292169186343, 'f1-score': 0.34854796222562545, 'support': 135401}}
[[ 1324 30953  3385]
 [ 1457 54384  8070]
 [  932 30482  4414]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0892817
{'0': {'precision': 0.40679711637487126, 'recall': 0.02494946942900455, 'f1-score': 0.04701541391418199, 'support': 15832}, '1': {'precision': 0.4054528434355254, 'recall': 0.9727225939269172, 'f1-score': 0.572340981981858, 'support': 21373}, '2': {'precision': 0.45748502994011975, 'recall': 0.0240599609498016, 'f1-score': 0.04571565342269029, 'support': 15877}, 'accuracy': 0.4062959195207415, 'macro avg': {'precision': 0.42324499658350545, 'recall': 0.3405773414352411, 'f1-score': 0.2216906831062434, 'support': 53082}, 'weighted avg': {'precision': 0.4214167776186603, 'recall': 0.4062959195207415, 'f1-score': 0.2581443666474442, 'support': 53082}}
[[  395 15258   179]
 [  309 20790   274]
 [  267 15228   382]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1393582
{'0': {'precision': 0.3780396837237058, 'recall': 0.026154989471945833, 'f1-score': 0.04892505816366919, 'support': 96884}, '1': {'precision': 0.26544842066403634, 'recall': 0.8532059743996677, 'f1-score': 0.4049189444119862, 'support': 67421}, '2': {'precision': 0.3357506941278853, 'recall': 0.09734002931494341, 'f1-score': 0.15092441670935594, 'support': 83234}, 'accuracy': 0.27535055082229465, 'macro avg': {'precision': 0.32641293283854245, 'recall': 0.32556699772885234, 'f1-score': 0.20158947309500377, 'support': 247539}, 'weighted avg': {'precision': 0.33315424221039075, 'recall': 0.27535055082229465, 'f1-score': 0.1801822677909985, 'support': 247539}}
[[ 2534 86094  8256]
 [ 2124 57524  7773]
 [ 2045 73087  8102]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119927
{'0': {'precision': 0.31761565836298933, 'recall': 0.019940792046025807, 'f1-score': 0.037525621485257794, 'support': 17903}, '1': {'precision': 0.32333608847955286, 'recall': 0.8844269795984282, 'f1-score': 0.4735484428816418, 'support': 18577}, '2': {'precision': 0.33626068869886755, 'recall': 0.07354056103108415, 'f1-score': 0.12068679495686796, 'support': 19785}, 'accuracy': 0.3242157646849729, 'macro avg': {'precision': 0.32573747851380325, 'recall': 0.3259694442251794, 'f1-score': 0.21058695310792253, 'support': 56265}, 'weighted avg': {'precision': 0.3260607015598391, 'recall': 0.3242157646849729, 'f1-score': 0.21072991847657443, 'support': 56265}}
[[  357 16377  1169]
 [  444 16430  1703]
 [  323 18007  1455]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.120071
{'0': {'precision': 0.35403726708074534, 'recall': 0.049464853919583454, 'f1-score': 0.0868020304568528, 'support': 6914}, '1': {'precision': 0.3198902948326373, 'recall': 0.7946732734592753, 'f1-score': 0.4561575041109284, 'support': 6458}, '2': {'precision': 0.32602921646746347, 'recall': 0.14769138216273123, 'f1-score': 0.20329158472207845, 'support': 6649}, 'accuracy': 0.3224614155137106, 'macro avg': {'precision': 0.3333189261269487, 'recall': 0.33060983651386333, 'f1-score': 0.24875037309661988, 'support': 20021}, 'weighted avg': {'precision': 0.33372126511750705, 'recall': 0.3224614155137106, 'f1-score': 0.24462814779202616, 'support': 20021}}
[[ 342 5562 1010]
 [ 306 5132 1020]
 [ 318 5349  982]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1343318
{'0': {'precision': 0.31510430281800594, 'recall': 0.04132044426162073, 'f1-score': 0.07306030172074163, 'support': 145860}, '1': {'precision': 0.2768126281994114, 'recall': 0.8086020945136247, 'f1-score': 0.4124345584522575, 'support': 115158}, '2': {'precision': 0.35050916898107115, 'recall': 0.12249772833659169, 'f1-score': 0.1815473609573703, 'support': 145268}, 'accuracy': 0.287824340489212, 'macro avg': {'precision': 0.3141420333328295, 'recall': 0.32414008903727903, 'f1-score': 0.22234740704345649, 'support': 406286}, 'weighted avg': {'precision': 0.3169099309520003, 'recall': 0.287824340489212, 'f1-score': 0.20804245414015674, 'support': 406286}}
[[  6027 122213  17620]
 [  6687  93117  15354]
 [  6413 121060  17795]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1208881
{'0': {'precision': 0.31170336037079954, 'recall': 0.010851587397636048, 'f1-score': 0.020973023545922346, 'support': 24789}, '1': {'precision': 0.33122365710130486, 'recall': 0.9852988303156546, 'f1-score': 0.4957823129251701, 'support': 24964}, '2': {'precision': 0.3442622950819672, 'recall': 0.004895675486653456, 'f1-score': 0.009654062751407884, 'support': 25737}, 'accuracy': 0.3310637170486157, 'macro avg': {'precision': 0.32906310418469054, 'recall': 0.333682031066648, 'f1-score': 0.17546979974083346, 'support': 75490}, 'weighted avg': {'precision': 0.32925898350289196, 'recall': 0.3310637170486157, 'f1-score': 0.17413003780072592, 'support': 75490}}
[[  269 24372   148]
 [  275 24597    92]
 [  319 25292   126]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158965
{'0': {'precision': 0.3753501400560224, 'recall': 0.038457858987850375, 'f1-score': 0.06976744186046512, 'support': 10453}, '1': {'precision': 0.33512182573224064, 'recall': 0.7608042716502587, 'f1-score': 0.4652907110238028, 'support': 11986}, '2': {'precision': 0.25118296529968454, 'recall': 0.11672010994044893, 'f1-score': 0.1593794958403703, 'support': 10915}, 'accuracy': 0.3236493374108053, 'macro avg': {'precision': 0.3205516436959825, 'recall': 0.305327413526186, 'f1-score': 0.23147921624154608, 'support': 33354}, 'weighted avg': {'precision': 0.32026045702099587, 'recall': 0.3236493374108053, 'f1-score': 0.24122686122193396, 'support': 33354}}
[[ 402 8702 1349]
 [ 418 9119 2449]
 [ 251 9390 1274]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
2104/2104 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.147124
{'0': {'precision': 0.374757045675413, 'recall': 0.014720758894487708, 'f1-score': 0.028328741965105604, 'support': 209568}, '1': {'precision': 0.2304462043324049, 'recall': 0.8612121551289943, 'f1-score': 0.3635992351532479, 'support': 125083}, '2': {'precision': 0.3732166998011928, 'recall': 0.1150801824334265, 'f1-score': 0.17591693685926868, 'support': 203910}, 'accuracy': 0.24931994704406743, 'macro avg': {'precision': 0.32613998326967025, 'recall': 0.3303376988189695, 'f1-score': 0.18928163799254072, 'support': 538561}, 'weighted avg': {'precision': 0.3406570553402054, 'recall': 0.24931994704406743, 'f1-score': 0.1620765401167007, 'support': 538561}}
[[  3085 182674  23809]
 [  1760 107723  15600]
 [  3387 177057  23466]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1156589
{'0': {'precision': 0.3409090909090909, 'recall': 0.03611293499671701, 'f1-score': 0.06530773797743915, 'support': 36552}, '1': {'precision': 0.3295154780961829, 'recall': 0.8080836005750304, 'f1-score': 0.4681369016159772, 'support': 36172}, '2': {'precision': 0.34304800189170015, 'recall': 0.15781887408213216, 'f1-score': 0.2161829899787654, 'support': 36770}, 'accuracy': 0.3320090598571611, 'macro avg': {'precision': 0.3378241902989913, 'recall': 0.3340051365512932, 'f1-score': 0.2498758765240606, 'support': 109494}, 'weighted avg': {'precision': 0.3378634262531466, 'recall': 0.3320090598571611, 'f1-score': 0.24905131774639422, 'support': 109494}}
[[ 1320 29710  5522]
 [ 1351 29230  5591]
 [ 1201 29766  5803]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121544
{'0': {'precision': 0.3333333333333333, 'recall': 0.04737316613392345, 'f1-score': 0.08295658414065303, 'support': 12201}, '1': {'precision': 0.3055478980013784, 'recall': 0.8054319193387228, 'f1-score': 0.4430288041170152, 'support': 11009}, '2': {'precision': 0.378561736770692, 'recall': 0.15374321026529167, 'f1-score': 0.21867651998656368, 'support': 12703}, 'accuracy': 0.31737810820594214, 'macro avg': {'precision': 0.3391476560351345, 'recall': 0.33551609857931264, 'f1-score': 0.24822063608141062, 'support': 35913}, 'weighted avg': {'precision': 0.34081381536756256, 'recall': 0.31737810820594214, 'f1-score': 0.24134172085355293, 'support': 35913}}
[[  578  9995  1628]
 [  564  8867  1578]
 [  592 10158  1953]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1281426
{'0': {'precision': 0.45391023512722223, 'recall': 0.062401321181013, 'f1-score': 0.1097190176104185, 'support': 481993}, '1': {'precision': 0.27006040206921433, 'recall': 0.8608215885502021, 'f1-score': 0.4111371942290722, 'support': 366120}, '2': {'precision': 0.4507718815810084, 'recall': 0.10358425519321063, 'f1-score': 0.16845802370770255, 'support': 500076}, 'accuracy': 0.29449951008352687, 'macro avg': {'precision': 0.39158083959248163, 'recall': 0.3422690549748086, 'f1-score': 0.22977141184906444, 'support': 1348189}, 'weighted avg': {'precision': 0.4028190927375615, 'recall': 0.29449951008352687, 'f1-score': 0.21336115534980585, 'support': 1348189}}
[[ 30077 421869  30047]
 [ 17889 315164  33067]
 [ 18296 429980  51800]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114183
{'0': {'precision': 0.42323524927580425, 'recall': 0.030803715087828316, 'f1-score': 0.057427749850017584, 'support': 90119}, '1': {'precision': 0.33118459412058493, 'recall': 0.9491273425277664, 'f1-score': 0.4910308881860294, 'support': 90127}, '2': {'precision': 0.4763761110244815, 'recall': 0.03356515815726732, 'f1-score': 0.06271169044442162, 'support': 91017}, 'accuracy': 0.3368428425550112, 'macro avg': {'precision': 0.4102653181402902, 'recall': 0.3378320719242873, 'f1-score': 0.20372344282682286, 'support': 271263}, 'weighted avg': {'precision': 0.4104818417583946, 'recall': 0.3368428425550112, 'f1-score': 0.2032651049994136, 'support': 271263}}
[[ 2776 86151  1192]
 [ 2419 85542  2166]
 [ 1364 86598  3055]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131498
{'0': {'precision': 0.29636048526863085, 'recall': 0.005264940423042581, 'f1-score': 0.010346079380445303, 'support': 32479}, '1': {'precision': 0.34933605720122574, 'recall': 0.9936633553778467, 'f1-score': 0.5169360991549944, 'support': 36139}, '2': {'precision': 0.4117647058823529, 'recall': 0.00040243762216856386, 'f1-score': 0.0008040893687898455, 'support': 34788}, 'accuracy': 0.34906098292168736, 'macro avg': {'precision': 0.3524870827840698, 'recall': 0.3331102444743526, 'f1-score': 0.17602875596807652, 'support': 103406}, 'weighted avg': {'precision': 0.35369919115399734, 'recall': 0.34906098292168736, 'f1-score': 0.18418231689187559, 'support': 103406}}
[[  171 32297    11]
 [  220 35910     9]
 [  186 34588    14]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
10110/10110 - 139s - 139s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1348733
{'0': {'precision': 0.3942362152257205, 'recall': 0.025347285443465036, 'f1-score': 0.04763208211733924, 'support': 933670}, '1': {'precision': 0.27395301699811264, 'recall': 0.9608517292413701, 'f1-score': 0.4263479402961017, 'support': 704731}, '2': {'precision': 0.4508397542875404, 'recall': 0.026738970201116142, 'f1-score': 0.05048378471331755, 'support': 949700}, 'accuracy': 0.2805926043844502, 'macro avg': {'precision': 0.3730096621704579, 'recall': 0.3376459949619837, 'f1-score': 0.1748212690422528, 'support': 2588101}, 'weighted avg': {'precision': 0.38225410265626125, 'recall': 0.2805926043844502, 'f1-score': 0.15180153586183298, 'support': 2588101}}
[[ 23666 891614  18390]
 [ 15047 677142  12542]
 [ 21317 902989  25394]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119316
{'0': {'precision': 0.3687030028996904, 'recall': 0.05199539790133211, 'f1-score': 0.0911382563217902, 'support': 144282}, '1': {'precision': 0.3407063630587081, 'recall': 0.8723981217047452, 'f1-score': 0.4900346094149177, 'support': 145664}, '2': {'precision': 0.36446129707112973, 'recall': 0.09840985157673243, 'f1-score': 0.15497436923863853, 'support': 141622}, 'accuracy': 0.34413116820524225, 'macro avg': {'precision': 0.35795688767650935, 'recall': 0.34093445706093656, 'f1-score': 0.2453824116584488, 'support': 431568}, 'weighted avg': {'precision': 0.3578615563405172, 'recall': 0.34413116820524225, 'f1-score': 0.24672309199187514, 'support': 431568}}
[[  7502 124815  11965]
 [  6249 127077  12338]
 [  6596 121089  13937]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1242388
{'0': {'precision': 0.37453515140782717, 'recall': 0.03440534868966864, 'f1-score': 0.06302145411203815, 'support': 61473}, '1': {'precision': 0.299888261022252, 'recall': 0.8681676186251133, 'f1-score': 0.44578907903603937, 'support': 54099}, '2': {'precision': 0.36640590568532394, 'recall': 0.10257240677338762, 'f1-score': 0.16027664650456658, 'support': 64842}, 'accuracy': 0.3089172680612369, 'macro avg': {'precision': 0.34694310603846773, 'recall': 0.3350484580293898, 'f1-score': 0.2230290598842147, 'support': 180414}, 'weighted avg': {'precision': 0.34922980551389554, 'recall': 0.3089172680612369, 'f1-score': 0.21275244464425777, 'support': 180414}}
[[ 2115 53460  5898]
 [ 1529 46967  5603]
 [ 2003 56188  6651]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
6546/6546 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1070834
{'0': {'precision': 0.3583048669124362, 'recall': 0.038993831068447164, 'f1-score': 0.07033337648671704, 'support': 543368}, '1': {'precision': 0.36196786705348133, 'recall': 0.7614916412365663, 'f1-score': 0.4906905912024965, 'support': 602960}, '2': {'precision': 0.3231893840387184, 'recall': 0.21252604161747957, 'f1-score': 0.2564277868176245, 'support': 529441}, 'accuracy': 0.35378205468653495, 'macro avg': {'precision': 0.3478207060015453, 'recall': 0.33767050464083104, 'f1-score': 0.272483918168946, 'support': 1675769}, 'weighted avg': {'precision': 0.3485284992847385, 'recall': 0.35378205468653495, 'f1-score': 0.28037700235939544, 'support': 1675769}}
[[ 21188 410616 111564]
 [ 19740 459149 124071]
 [ 18206 398715 112520]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1141125
{'0': {'precision': 0.34934681837336706, 'recall': 0.06260679121314817, 'f1-score': 0.10618420525957652, 'support': 105931}, '1': {'precision': 0.34030220536506284, 'recall': 0.8336596011726909, 'f1-score': 0.4833141916933427, 'support': 106763}, '2': {'precision': 0.3355820337597103, 'recall': 0.11257298483482896, 'f1-score': 0.16859108848427942, 'support': 102076}, 'accuracy': 0.3403342122819837, 'macro avg': {'precision': 0.3417436858327134, 'recall': 0.3362797924068894, 'f1-score': 0.2526964951457329, 'support': 314770}, 'weighted avg': {'precision': 0.3418153376959543, 'recall': 0.3403342122819837, 'f1-score': 0.2543361058653298, 'support': 314770}}
[[ 6632 88268 11031]
 [ 6039 89004 11720]
 [ 6313 84272 11491]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995934
{'0': {'precision': 0.37110016420361247, 'recall': 0.006277603399905558, 'f1-score': 0.01234635345534007, 'support': 36001}, '1': {'precision': 0.3817855404089581, 'recall': 0.8781904717465354, 'f1-score': 0.5322012809818033, 'support': 42862}, '2': {'precision': 0.34096817255673434, 'recall': 0.14037777327818113, 'f1-score': 0.19887714121793296, 'support': 34571}, 'accuracy': 0.37660666114216196, 'macro avg': {'precision': 0.36461795905643496, 'recall': 0.34161528280820735, 'f1-score': 0.2478082585516921, 'support': 113434}, 'weighted avg': {'precision': 0.36595447165719164, 'recall': 0.37660666114216196, 'f1-score': 0.26562647905595244, 'support': 113434}}
[[  226 31414  4361]
 [  202 37641  5019]
 [  181 29537  4853]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
7633/7633 - 103s - 103s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1218643
{'0': {'precision': 0.40700794444152155, 'recall': 0.08103651072515645, 'f1-score': 0.1351618825120961, 'support': 668242}, '1': {'precision': 0.3180775709386679, 'recall': 0.9110451641985572, 'f1-score': 0.47152822832024854, 'support': 612277}, '2': {'precision': 0.38540473818057436, 'recall': 0.03847987063992552, 'f1-score': 0.0699734038962617, 'support': 673469}, 'accuracy': 0.3264498041953175, 'macro avg': {'precision': 0.3701634178535879, 'recall': 0.34352051518787974, 'f1-score': 0.22555450490953544, 'support': 1953988}, 'weighted avg': {'precision': 0.37169600188375734, 'recall': 0.3264498041953175, 'f1-score': 0.2180932810710692, 'support': 1953988}}
[[ 54152 593453  20637]
 [ 33776 557812  20689]
 [ 45121 602433  25915]]
Evaluating performance on  train set...
1586/1586 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1166307
{'0': {'precision': 0.32946614701350496, 'recall': 0.02694868259122518, 'f1-score': 0.0498221616102084, 'support': 134886}, '1': {'precision': 0.33583376421584193, 'recall': 0.9368629920337395, 'f1-score': 0.4944307803476584, 'support': 136576}, '2': {'precision': 0.31494636126413456, 'recall': 0.032336568230531076, 'f1-score': 0.05865122431899786, 'support': 134368}, 'accuracy': 0.3349505950767563, 'macro avg': {'precision': 0.32674875749782717, 'recall': 0.33204941428516527, 'f1-score': 0.20096805542562154, 'support': 405830}, 'weighted avg': {'precision': 0.3268016547764968, 'recall': 0.3349505950767563, 'f1-score': 0.20237177650004057, 'support': 405830}}
[[  3635 126665   4586]
 [  3758 127953   4865]
 [  3640 126383   4345]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981745
{'0': {'precision': 0.3202792625722701, 'recall': 0.06632929694559914, 'f1-score': 0.10989874791787539, 'support': 44264}, '1': {'precision': 0.39325507817873356, 'recall': 0.9066866355387191, 'f1-score': 0.5485770938494422, 'support': 56755}, '2': {'precision': 0.40822877152028014, 'recall': 0.06101709699930216, 'f1-score': 0.10616581293872131, 'support': 45856}, 'accuracy': 0.3893991489361702, 'macro avg': {'precision': 0.3739210374237613, 'recall': 0.3446776764945401, 'f1-score': 0.2548805515686796, 'support': 146875}, 'weighted avg': {'precision': 0.3759371696161154, 'recall': 0.3893991489361702, 'f1-score': 0.2782460640502463, 'support': 146875}}
[[ 2936 39271  2057]
 [ 3297 51459  1999]
 [ 2934 40124  2798]]
testing model on single stock: results/universal/W10/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
22048/22048 - 315s - 315s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1434414
{'0': {'precision': 0.3772508252689691, 'recall': 0.02209826947870664, 'f1-score': 0.04175089167599357, 'support': 2115143}, '1': {'precision': 0.2537478245451727, 'recall': 0.906293913119772, 'f1-score': 0.3964859218179204, 'support': 1413302}, '2': {'precision': 0.3898817462434427, 'recall': 0.08705237180726434, 'f1-score': 0.14232628554051646, 'support': 2115623}, 'accuracy': 0.26785254890621446, 'macro avg': {'precision': 0.3402934653525282, 'recall': 0.3384815181352477, 'f1-score': 0.1935210330114768, 'support': 5644068}, 'weighted avg': {'precision': 0.35105965056941474, 'recall': 0.26785254890621446, 'f1-score': 0.16827795408266355, 'support': 5644068}}
[[  46741 1882547  185855]
 [  30086 1280867  102349]
 [  47072 1884381  184170]]
Evaluating performance on  train set...
5429/5429 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1208482
{'0': {'precision': 0.3376841561126906, 'recall': 0.005652650775211407, 'f1-score': 0.011119172593984242, 'support': 462261}, '1': {'precision': 0.3287967383995837, 'recall': 0.9942613891290312, 'f1-score': 0.4941731509150105, 'support': 456905}, '2': {'precision': 0.35802469135802467, 'recall': 0.00030809765633300044, 'f1-score': 0.0006156655025635038, 'support': 470630}, 'accuracy': 0.32885473839326057, 'macro avg': {'precision': 0.3415018619567663, 'recall': 0.33340737918685853, 'f1-score': 0.1686359963371861, 'support': 1389796}, 'weighted avg': {'precision': 0.3416503212997429, 'recall': 0.32885473839326057, 'f1-score': 0.16636966433689698, 'support': 1389796}}
[[  2613 459508    140]
 [  2502 454283    120]
 [  2623 467862    145]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109238
{'0': {'precision': 0.31510621557828483, 'recall': 0.005256698845626308, 'f1-score': 0.010340887818795629, 'support': 152377}, '1': {'precision': 0.3557973168789643, 'recall': 0.9944912225650681, 'f1-score': 0.5240914046327032, 'support': 172089}, '2': {'precision': 0.3559322033898305, 'recall': 0.00026381743833267377, 'f1-score': 0.0005272440826266798, 'support': 159201}, 'accuracy': 0.35558349029394193, 'macro avg': {'precision': 0.3422785786156932, 'recall': 0.33333724628300904, 'f1-score': 0.17831984551137517, 'support': 483667}, 'weighted avg': {'precision': 0.34302217638875676, 'recall': 0.35558349029394193, 'f1-score': 0.1899034190469892, 'support': 483667}}
[[   801 151540     36]
 [   908 171141     40]
 [   833 158326     42]]
training model: results/universal/W10/deepOF_L2/h50
Epoch 1/50
8543/8543 - 194s - loss: 3.0404 - accuracy50: 0.4671 - val_loss: 3.2721 - val_accuracy50: 0.4209 - 194s/epoch - 23ms/step
Epoch 2/50
8543/8543 - 188s - loss: 2.9799 - accuracy50: 0.4811 - val_loss: 3.2982 - val_accuracy50: 0.4131 - 188s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 187s - loss: 2.9539 - accuracy50: 0.4866 - val_loss: 3.3145 - val_accuracy50: 0.4146 - 187s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 187s - loss: 2.9411 - accuracy50: 0.4902 - val_loss: 3.3467 - val_accuracy50: 0.4182 - 187s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 188s - loss: 2.9326 - accuracy50: 0.4926 - val_loss: 3.3489 - val_accuracy50: 0.4222 - 188s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 190s - loss: 2.9274 - accuracy50: 0.4937 - val_loss: 3.3490 - val_accuracy50: 0.4276 - 190s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 186s - loss: 2.9222 - accuracy50: 0.4953 - val_loss: 3.3333 - val_accuracy50: 0.4287 - 186s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 187s - loss: 2.9212 - accuracy50: 0.4960 - val_loss: 3.3308 - val_accuracy50: 0.4278 - 187s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 185s - loss: 2.9171 - accuracy50: 0.4966 - val_loss: 3.3456 - val_accuracy50: 0.4289 - 185s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 190s - loss: 2.9120 - accuracy50: 0.4984 - val_loss: 3.3340 - val_accuracy50: 0.4294 - 190s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 184s - loss: 2.9082 - accuracy50: 0.4995 - val_loss: 3.3447 - val_accuracy50: 0.4335 - 184s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 276s - 276s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088773
{'0': {'precision': 0.41709895335243374, 'recall': 0.39682202059745936, 'f1-score': 0.40670791085569846, 'support': 3201657}, '1': {'precision': 0.4323233138603072, 'recall': 0.42967654403180117, 'f1-score': 0.4309958654938036, 'support': 3091209}, '2': {'precision': 0.4043500374530305, 'recall': 0.4260534106016871, 'f1-score': 0.41491810501834986, 'support': 3252388}, 'accuracy': 0.41742199840884275, 'macro avg': {'precision': 0.4179241015552571, 'recall': 0.4175173250769825, 'f1-score': 0.41754062712261736, 'support': 9545254}, 'weighted avg': {'precision': 0.4176853452008806, 'recall': 0.41742199840884275, 'f1-score': 0.4173709985997417, 'support': 9545254}}
[[1270488  824602 1106567]
 [ 828288 1328220  934701]
 [ 947235  919462 1385691]]
Evaluating performance on  train set...
8543/8543 - 67s - 67s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1173333
{'0': {'precision': 0.3796635659938178, 'recall': 0.4036525918297288, 'f1-score': 0.39129074743596476, 'support': 655425}, '1': {'precision': 0.5041883029121794, 'recall': 0.4105908168277831, 'f1-score': 0.452601251297848, 'support': 863144}, '2': {'precision': 0.3740082138445977, 'recall': 0.4405209663200842, 'f1-score': 0.4045489438233752, 'support': 668143}, 'accuracy': 0.417656280296628, 'macro avg': {'precision': 0.41928669425019827, 'recall': 0.4182547916591987, 'f1-score': 0.41614698085239593, 'support': 2186712}, 'weighted avg': {'precision': 0.4270882819928272, 'recall': 0.417656280296628, 'f1-score': 0.4195423711771044, 'support': 2186712}}
[[264564 160870 229991]
 [246103 354399 262642]
 [186171 187641 294331]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1107916
{'0': {'precision': 0.37106085708917624, 'recall': 0.38468996108742715, 'f1-score': 0.37775251641565905, 'support': 225891}, '1': {'precision': 0.5237728168538088, 'recall': 0.4190090251556087, 'f1-score': 0.46557014064920726, 'support': 329191}, '2': {'precision': 0.36734552842719226, 'recall': 0.4585200488227759, 'f1-score': 0.4079000124696652, 'support': 231859}, 'accuracy': 0.42079901796958097, 'macro avg': {'precision': 0.4207264007900591, 'recall': 0.4207396783552706, 'f1-score': 0.41707422317817716, 'support': 786941}, 'weighted avg': {'precision': 0.433848245671853, 'recall': 0.42079901796958097, 'f1-score': 0.42337059938077565, 'support': 786941}}
[[ 86898  57944  81049]
 [ 89212 137934 102045]
 [ 58078  67469 106312]]
testing model out of sample: results/universal/W10/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0088826
{'0': {'precision': 0.45941395489985526, 'recall': 0.389425556307206, 'f1-score': 0.4215344186977367, 'support': 1617182}, '1': {'precision': 0.5393982938457663, 'recall': 0.6382061949416938, 'f1-score': 0.5846569641184165, 'support': 2227979}, '2': {'precision': 0.45211554942931, 'recall': 0.4068486698237759, 'f1-score': 0.4282893414394095, 'support': 1615613}, 'accuracy': 0.4960820572321799, 'macro avg': {'precision': 0.48364259939164383, 'recall': 0.4781601403575586, 'f1-score': 0.4781602414185209, 'support': 5460774}, 'weighted avg': {'precision': 0.4898880284914172, 'recall': 0.4960820572321799, 'f1-score': 0.49008641272262454, 'support': 5460774}}
[[ 629772  584244  403166]
 [ 412691 1421910  393378]
 [ 328353  629950  657310]]
Evaluating performance on  train set...
4055/4055 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0142069
{'0': {'precision': 0.440636239493778, 'recall': 0.398820424619284, 'f1-score': 0.4186868474579987, 'support': 287222}, '1': {'precision': 0.562751667843188, 'recall': 0.6173743076476709, 'f1-score': 0.5887988715234433, 'support': 458401}, '2': {'precision': 0.43634814337371775, 'recall': 0.41057673857624516, 'f1-score': 0.4230703369528951, 'support': 291848}, 'accuracy': 0.4986944213380422, 'macro avg': {'precision': 0.4799120169035613, 'recall': 0.47559049028106665, 'f1-score': 0.4768520186447791, 'support': 1037471}, 'weighted avg': {'precision': 0.49338601485554767, 'recall': 0.4986944213380422, 'f1-score': 0.49508304030168343, 'support': 1037471}}
[[114550 104964  67708]
 [ 88319 283005  87077]
 [ 57096 114926 119826]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0087562
{'0': {'precision': 0.43421787978647547, 'recall': 0.414988350784135, 'f1-score': 0.42438539739044034, 'support': 108591}, '1': {'precision': 0.5658249347671173, 'recall': 0.608474449316363, 'f1-score': 0.586375195726771, 'support': 173557}, '2': {'precision': 0.4484035833237625, 'recall': 0.4155041372154279, 'f1-score': 0.43132741977803457, 'support': 112757}, 'accuracy': 0.5001709271850192, 'macro avg': {'precision': 0.4828154659591184, 'recall': 0.47965564577197534, 'f1-score': 0.48069600429841525, 'support': 394905}, 'weighted avg': {'precision': 0.49610836741015485, 'recall': 0.5001709271850192, 'f1-score': 0.49756052824018016, 'support': 394905}}
[[ 45064  38055  25472]
 [ 35791 105605  32161]
 [ 22927  42979  46851]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.16255
{'0': {'precision': 0.4239146603200238, 'recall': 0.3864138224925425, 'f1-score': 0.4042964989613416, 'support': 51626}, '1': {'precision': 0.27219445543130416, 'recall': 0.23007719895447085, 'f1-score': 0.24936998665854096, 'support': 32902}, '2': {'precision': 0.3888802286308132, 'recall': 0.4670008527986355, 'f1-score': 0.4243753071485276, 'support': 48077}, 'accuracy': 0.376840993929339, 'macro avg': {'precision': 0.36166311479404706, 'recall': 0.361163958081883, 'f1-score': 0.3593472642561368, 'support': 132605}, 'weighted avg': {'precision': 0.37356777631436167, 'recall': 0.376840993929339, 'f1-score': 0.37313580934502694, 'support': 132605}}
[[19949  9975 21702]
 [11751  7570 13581]
 [15359 10266 22452]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1694353
{'0': {'precision': 0.39135103475204996, 'recall': 0.3461106794440128, 'f1-score': 0.3673431987904888, 'support': 11583}, '1': {'precision': 0.3651722614840989, 'recall': 0.29624652871092, 'f1-score': 0.32711805727286214, 'support': 11163}, '2': {'precision': 0.3644231409360229, 'recall': 0.4729157667386609, 'f1-score': 0.41164084824785685, 'support': 11575}, 'accuracy': 0.3726581393316046, 'macro avg': {'precision': 0.37364881239072395, 'recall': 0.37175765829786456, 'f1-score': 0.3687007014370693, 'support': 34321}, 'weighted avg': {'precision': 0.3737546938263587, 'recall': 0.3726581393316046, 'f1-score': 0.36919955605594634, 'support': 34321}}
[[4009 2791 4783]
 [3092 3307 4764]
 [3143 2958 5474]]
Evaluating performance on  val set...
46/46 - 1s - 522ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1640636
{'0': {'precision': 0.3786060760786316, 'recall': 0.36853876739562624, 'f1-score': 0.3735045963984385, 'support': 4024}, '1': {'precision': 0.3558823529411765, 'recall': 0.32036007413290973, 'f1-score': 0.33718824021178767, 'support': 3777}, '2': {'precision': 0.3725085910652921, 'recall': 0.4189641844885339, 'f1-score': 0.39437302934756246, 'support': 3881}, 'accuracy': 0.3697140900530731, 'macro avg': {'precision': 0.36899900669503344, 'recall': 0.3692876753390233, 'f1-score': 0.36835528865259626, 'support': 11682}, 'weighted avg': {'precision': 0.3692333794832765, 'recall': 0.3697140900530731, 'f1-score': 0.3686957889132964, 'support': 11682}}
[[1483 1137 1404]
 [1232 1210 1335]
 [1202 1053 1626]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9050819
{'0': {'precision': 0.3639982869922439, 'recall': 0.5334805602371128, 'f1-score': 0.432736683810323, 'support': 86035}, '1': {'precision': 0.7395573507358648, 'recall': 0.6582446585531898, 'f1-score': 0.6965359508436112, 'support': 298187}, '2': {'precision': 0.4434097601489945, 'recall': 0.4062255014987318, 'f1-score': 0.4240039469092572, 'support': 86740}, 'accuracy': 0.5890369074362688, 'macro avg': {'precision': 0.5156551326257011, 'recall': 0.5326502400963449, 'f1-score': 0.5177588605210638, 'support': 470962}, 'weighted avg': {'precision': 0.6164071474143918, 'recall': 0.5890369074362688, 'f1-score': 0.5981513763758731, 'support': 470962}}
[[ 45898  31244   8893]
 [ 66570 196280  35337]
 [ 13626  37878  35236]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83175516
{'0': {'precision': 0.33355207991541796, 'recall': 0.5293947459784747, 'f1-score': 0.40925052000626244, 'support': 17282}, '1': {'precision': 0.8262785433287181, 'recall': 0.7488074728382644, 'f1-score': 0.7856377893521542, 'support': 100417}, '2': {'precision': 0.4282767562470533, 'recall': 0.41056497175141243, 'f1-score': 0.41923387562016845, 'support': 17700}, 'accuracy': 0.6765854991543512, 'macro avg': {'precision': 0.5293691264970631, 'recall': 0.5629223968560505, 'f1-score': 0.538040728326195, 'support': 135399}, 'weighted avg': {'precision': 0.7113594495979363, 'recall': 0.6765854991543512, 'f1-score': 0.6896985722095471, 'support': 135399}}
[[ 9149  7071  1062]
 [16585 75193  8639]
 [ 1695  8738  7267]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8658599
{'0': {'precision': 0.344930966469428, 'recall': 0.5099731715852094, 'f1-score': 0.4115210843373494, 'support': 8573}, '1': {'precision': 0.7574049646240556, 'recall': 0.7083099697207581, 'f1-score': 0.732035234121465, 'support': 35668}, '2': {'precision': 0.47794639058289606, 'recall': 0.3811785997059156, 'f1-score': 0.4241127611376794, 'support': 8841}, 'accuracy': 0.6217926980897479, 'macro avg': {'precision': 0.5267607738921266, 'recall': 0.5331539136706277, 'f1-score': 0.522556359865498, 'support': 53082}, 'weighted avg': {'precision': 0.6442435758429714, 'recall': 0.6217926980897479, 'f1-score': 0.628985040275173, 'support': 53082}}
[[ 4372  3559   642]
 [ 7365 25264  3039]
 [  938  4533  3370]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2416939
{'0': {'precision': 0.37313199484059256, 'recall': 0.31721365041037625, 'f1-score': 0.3429081156157954, 'support': 90283}, '1': {'precision': 0.3007613133718952, 'recall': 0.1938937786186285, 'f1-score': 0.23578347198372873, 'support': 72942}, '2': {'precision': 0.33905152839839364, 'recall': 0.4976930102361551, 'f1-score': 0.4033335576211395, 'support': 84309}, 'accuracy': 0.3423448899949098, 'macro avg': {'precision': 0.33764827887029386, 'recall': 0.3362668130883866, 'f1-score': 0.32734171507355453, 'support': 247534}, 'weighted avg': {'precision': 0.34019852997126115, 'recall': 0.3423448899949098, 'f1-score': 0.33192183831335753, 'support': 247534}}
[[28639 16185 45459]
 [22461 14143 36338]
 [25653 16696 41960]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.251372
{'0': {'precision': 0.3535958450368329, 'recall': 0.36055120237773575, 'f1-score': 0.3570396532348692, 'support': 18505}, '1': {'precision': 0.3378807564602281, 'recall': 0.25166666666666665, 'f1-score': 0.2884698342269058, 'support': 18600}, '2': {'precision': 0.3525363242416518, 'recall': 0.4331802046356233, 'f1-score': 0.3887197264252588, 'support': 19156}, 'accuracy': 0.3492828069177583, 'macro avg': {'precision': 0.34800430857957093, 'recall': 0.3484660245600086, 'f1-score': 0.344743071295678, 'support': 56261}, 'weighted avg': {'precision': 0.34803965464069103, 'recall': 0.3492828069177583, 'f1-score': 0.34515690761155965, 'support': 56261}}
[[6672 4217 7616]
 [6295 4681 7624]
 [5902 4956 8298]]
Evaluating performance on  val set...
79/79 - 1s - 779ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2327445
{'0': {'precision': 0.37209629733915245, 'recall': 0.3815504547423127, 'f1-score': 0.3767640769779045, 'support': 6927}, '1': {'precision': 0.3342269883824844, 'recall': 0.2371967654986523, 'f1-score': 0.27747380135398314, 'support': 6307}, '2': {'precision': 0.351575456053068, 'recall': 0.4373066155886253, 'f1-score': 0.3897826515201261, 'support': 6787}, 'accuracy': 0.35497727386244443, 'macro avg': {'precision': 0.3526329139249016, 'recall': 0.35201794527653013, 'f1-score': 0.3480068432840046, 'support': 20021}, 'weighted avg': {'precision': 0.35321029357318867, 'recall': 0.35497727386244443, 'f1-score': 0.349898950213906, 'support': 20021}}
[[2643 1429 2855]
 [2192 1496 2619]
 [2268 1551 2968]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1588/1588 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2227194
{'0': {'precision': 0.3404446111557194, 'recall': 0.4023230525214886, 'f1-score': 0.3688063492063492, 'support': 144379}, '1': {'precision': 0.30862546751157877, 'recall': 0.13283400336964318, 'f1-score': 0.18572919642909202, 'support': 119894}, '2': {'precision': 0.3339400294473994, 'recall': 0.43282068615852626, 'f1-score': 0.3770045849753883, 'support': 142008}, 'accuracy': 0.3334564008654109, 'macro avg': {'precision': 0.3276700360382325, 'recall': 0.322659247349886, 'f1-score': 0.3105133768702765, 'support': 406281}, 'weighted avg': {'precision': 0.32878118843276233, 'recall': 0.3334564008654109, 'f1-score': 0.3176456080198631, 'support': 406281}}
[[58087 15707 70585]
 [51960 15926 52008]
 [60574 19970 61464]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2261876
{'0': {'precision': 0.34192526702382153, 'recall': 0.3871804654711942, 'f1-score': 0.36314838340281624, 'support': 26210}, '1': {'precision': 0.35346695557963165, 'recall': 0.15733633404332276, 'f1-score': 0.21774799076726273, 'support': 24883}, '2': {'precision': 0.30935997466386433, 'recall': 0.44045911047345765, 'f1-score': 0.36344878906778516, 'support': 24395}, 'accuracy': 0.32863501483679525, 'macro avg': {'precision': 0.33491739908910584, 'recall': 0.3283253033293249, 'f1-score': 0.31478172107928803, 'support': 75488}, 'weighted avg': {'precision': 0.335205808688895, 'recall': 0.32863501483679525, 'f1-score': 0.31531734305529663, 'support': 75488}}
[[10148  3409 12653]
 [ 9633  3915 11335]
 [ 9898  3752 10745]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2203122
{'0': {'precision': 0.3470249208539654, 'recall': 0.3803719192098941, 'f1-score': 0.36293403514729605, 'support': 11239}, '1': {'precision': 0.4405469678953627, 'recall': 0.19256756756756757, 'f1-score': 0.26799276672694394, 'support': 11544}, '2': {'precision': 0.295328038026143, 'recall': 0.44669378488317096, 'f1-score': 0.35557228915662653, 'support': 10571}, 'accuracy': 0.3363914373088685, 'macro avg': {'precision': 0.36096664225849034, 'recall': 0.3398777572202109, 'f1-score': 0.32883303034362216, 'support': 33354}, 'weighted avg': {'precision': 0.36300893364622355, 'recall': 0.3363914373088685, 'f1-score': 0.327741164141962, 'support': 33354}}
[[4275 1303 5661]
 [3715 2223 5606]
 [4329 1520 4722]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
2104/2104 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1520576
{'0': {'precision': 0.41190771234142654, 'recall': 0.3547679561509031, 'f1-score': 0.3812085428967126, 'support': 221122}, '1': {'precision': 0.18486144457783113, 'recall': 0.15238321032449595, 'f1-score': 0.1670584246807549, 'support': 97012}, '2': {'precision': 0.4068732751547699, 'recall': 0.4949551315204471, 'f1-score': 0.44661271240906986, 'support': 220422}, 'accuracy': 0.3756879507423555, 'macro avg': {'precision': 0.3345474773580092, 'recall': 0.3340354326652821, 'f1-score': 0.33162655999551244, 'support': 538556}, 'weighted avg': {'precision': 0.368948552584894, 'recall': 0.3756879507423555, 'f1-score': 0.36940176065658586, 'support': 538556}}
[[ 78447  31644 111031]
 [ 34219  14783  48010]
 [ 77782  33541 109099]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.239265
{'0': {'precision': 0.3468026003035597, 'recall': 0.33158096489786976, 'f1-score': 0.3390210103442001, 'support': 36522}, '1': {'precision': 0.35406937958639095, 'recall': 0.23399096219552518, 'f1-score': 0.2817705222642511, 'support': 36292}, '2': {'precision': 0.3467483692429334, 'recall': 0.4782573134491126, 'f1-score': 0.4020213363279057, 'support': 36679}, 'accuracy': 0.3483693021471692, 'macro avg': {'precision': 0.3492067830442947, 'recall': 0.34794308018083586, 'f1-score': 0.34093762297878566, 'support': 109493}, 'weighted avg': {'precision': 0.3491930436438627, 'recall': 0.3483693021471692, 'f1-score': 0.3411494956661735, 'support': 109493}}
[[12110  7407 17005]
 [11757  8492 16043]
 [11052  8085 17542]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2273742
{'0': {'precision': 0.3511151797603196, 'recall': 0.3492549668874172, 'f1-score': 0.35018260292164677, 'support': 12080}, '1': {'precision': 0.32627646326276466, 'recall': 0.1854703123617379, 'f1-score': 0.2365021156558533, 'support': 11301}, '2': {'precision': 0.35317346763578095, 'recall': 0.4924194063198213, 'f1-score': 0.41133144475920685, 'support': 12532}, 'accuracy': 0.34767354439896414, 'macro avg': {'precision': 0.343521703552955, 'recall': 0.34238156185632546, 'f1-score': 0.33267205444556897, 'support': 35913}, 'weighted avg': {'precision': 0.34401725222757135, 'recall': 0.34767354439896414, 'f1-score': 0.3357481112143979, 'support': 35913}}
[[4219 2003 5858]
 [3761 2096 5444]
 [4036 2325 6171]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/EXC
Evaluating performance on  test set...
5267/5267 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91895044
{'0': {'precision': 0.45931530410597965, 'recall': 0.4922219680381712, 'f1-score': 0.4751996365368779, 'support': 305990}, '1': {'precision': 0.6527553923764859, 'recall': 0.6118122807472013, 'f1-score': 0.6316210256955231, 'support': 733457}, '2': {'precision': 0.4456793461931374, 'recall': 0.4804445207409543, 'f1-score': 0.4624094195839185, 'support': 308737}, 'accuracy': 0.5545860208992245, 'macro avg': {'precision': 0.519250014225201, 'recall': 0.5281595898421089, 'f1-score': 0.5230766939387732, 'support': 1348184}, 'weighted avg': {'precision': 0.5614304917098109, 'recall': 0.5545860208992245, 'f1-score': 0.557369095317524, 'support': 1348184}}
[[150615 116983  38392]
 [138622 448738 146097]
 [ 38675 121731 148331]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88993496
{'0': {'precision': 0.37255433030244406, 'recall': 0.584311028400356, 'f1-score': 0.4550015357837617, 'support': 49436}, '1': {'precision': 0.7398615448450568, 'recall': 0.5917832625897396, 'f1-score': 0.6575892857142858, 'support': 171747}, '2': {'precision': 0.43952514462149983, 'recall': 0.49459853431578105, 'f1-score': 0.46543835088741276, 'support': 50079}, 'accuracy': 0.5724797428316535, 'macro avg': {'precision': 0.5173136732563336, 'recall': 0.5568976084352922, 'f1-score': 0.5260097241284867, 'support': 271262}, 'weighted avg': {'precision': 0.6174752686805955, 'recall': 0.5724797428316535, 'f1-score': 0.585194867510629, 'support': 271262}}
[[ 28886  16398   4152]
 [ 42677 101637  27433]
 [  5972  19338  24769]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.887138
{'0': {'precision': 0.36944365798414497, 'recall': 0.5861313868613138, 'f1-score': 0.4532192940563539, 'support': 17810}, '1': {'precision': 0.7576811263751924, 'recall': 0.5917725276029918, 'f1-score': 0.6645280094656413, 'support': 67384}, '2': {'precision': 0.40397850894720483, 'recall': 0.49956072918954536, 'f1-score': 0.4467139665627378, 'support': 18212}, 'accuracy': 0.5745604703788948, 'macro avg': {'precision': 0.510367764435514, 'recall': 0.5591548812179504, 'f1-score': 0.5214870900282443, 'support': 103406}, 'weighted avg': {'precision': 0.6285189754299564, 'recall': 0.5745604703788948, 'f1-score': 0.5897718292557204, 'support': 103406}}
[[10439  5855  1516]
 [15601 39876 11907]
 [ 2216  6898  9098]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/AAL
Evaluating performance on  test set...
10110/10110 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9155699
{'0': {'precision': 0.4785894011235476, 'recall': 0.4169694021796957, 'f1-score': 0.4456594826380208, 'support': 592101}, '1': {'precision': 0.6390437546875539, 'recall': 0.7283565305782298, 'f1-score': 0.6807833771388186, 'support': 1397939}, '2': {'precision': 0.4828038378417882, 'recall': 0.38662265741000845, 'f1-score': 0.4293931777178773, 'support': 598056}, 'accuracy': 0.5781501149880066, 'macro avg': {'precision': 0.5334789978842965, 'recall': 0.510649530055978, 'f1-score': 0.5186120124982389, 'support': 2588096}, 'weighted avg': {'precision': 0.566231384934379, 'recall': 0.5781501149880066, 'f1-score': 0.568900931447968, 'support': 2588096}}
[[ 246888  272210   73003]
 [ 205051 1018198  174690]
 [  63927  302907  231222]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88811064
{'0': {'precision': 0.4463667820069204, 'recall': 0.4417455226180556, 'f1-score': 0.4440441290366996, 'support': 87607}, '1': {'precision': 0.6946521973828714, 'recall': 0.7268300853449048, 'f1-score': 0.710376938275929, 'support': 256723}, '2': {'precision': 0.46210541501095065, 'recall': 0.4039158145719657, 'f1-score': 0.43105568026815577, 'support': 87236}, 'accuracy': 0.6036851837262435, 'macro avg': {'precision': 0.5343747981335808, 'recall': 0.524163807511642, 'f1-score': 0.5284922491935947, 'support': 431566}, 'weighted avg': {'precision': 0.5972441729049519, 'recall': 0.6036851837262435, 'f1-score': 0.5998504193133897, 'support': 431566}}
[[ 38700  39573   9334]
 [ 38448 186594  31681]
 [  9552  42448  35236]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9163314
{'0': {'precision': 0.44608712793219, 'recall': 0.4457246965556294, 'f1-score': 0.44590583859804683, 'support': 40617}, '1': {'precision': 0.6618532468908648, 'recall': 0.7059409806419794, 'f1-score': 0.6831865798907181, 'support': 97324}, '2': {'precision': 0.48513449740443604, 'recall': 0.4114613990064276, 'f1-score': 0.4452710966163881, 'support': 42473}, 'accuracy': 0.5780316383429224, 'macro avg': {'precision': 0.5310249574091636, 'recall': 0.5210423587346787, 'f1-score': 0.5247878383683844, 'support': 180414}, 'weighted avg': {'precision': 0.5716742812857477, 'recall': 0.5780316383429224, 'f1-score': 0.5737570667143846, 'support': 180414}}
[[18104 16410  6103]
 [16175 68705 12444]
 [ 6305 18692 17476]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/WBA
Evaluating performance on  test set...
6546/6546 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0242106
{'0': {'precision': 0.5177568526642264, 'recall': 0.278810653636444, 'f1-score': 0.3624454308623849, 'support': 531687}, '1': {'precision': 0.45755172405770667, 'recall': 0.6327403875542514, 'f1-score': 0.5310713562411394, 'support': 621642}, '2': {'precision': 0.45210968791643547, 'recall': 0.45847808818321895, 'f1-score': 0.45527161863054527, 'support': 522435}, 'accuracy': 0.46611754399784217, 'macro avg': {'precision': 0.4758060882127895, 'recall': 0.4566763764579715, 'f1-score': 0.44959613524468983, 'support': 1675764}, 'weighted avg': {'precision': 0.47495702340889795, 'recall': 0.46611754399784217, 'f1-score': 0.4539383898416675, 'support': 1675764}}
[[148240 247656 135791]
 [ 73826 393338 154478]
 [ 64246 218664 239525]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.019929
{'0': {'precision': 0.5044641718323513, 'recall': 0.37739863929999334, 'f1-score': 0.4317771191205289, 'support': 104799}, '1': {'precision': 0.44040531817085177, 'recall': 0.6314957832339136, 'f1-score': 0.5189174653784837, 'support': 106954}, '2': {'precision': 0.4968977772423348, 'recall': 0.40037858564286755, 'f1-score': 0.4434469411891195, 'support': 103015}, 'accuracy': 0.47125819651298734, 'macro avg': {'precision': 0.480589089081846, 'recall': 0.4697576693922582, 'f1-score': 0.4647138418960441, 'support': 314768}, 'weighted avg': {'precision': 0.48022154623761937, 'recall': 0.47125819651298734, 'f1-score': 0.4652054705224159, 'support': 314768}}
[[39551 42797 22451]
 [20104 67541 19309]
 [18747 43023 41245]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98264146
{'0': {'precision': 0.5076192755704484, 'recall': 0.3761454330475909, 'f1-score': 0.43210295765560797, 'support': 33830}, '1': {'precision': 0.5144725627745361, 'recall': 0.6723716905149516, 'f1-score': 0.582918585648492, 'support': 46684}, '2': {'precision': 0.49232231646680313, 'recall': 0.40907710067440306, 'f1-score': 0.4468558154969305, 'support': 32918}, 'accuracy': 0.5076168982297764, 'macro avg': {'precision': 0.5048047182705959, 'recall': 0.4858647414123152, 'f1-score': 0.4872924529336768, 'support': 113432}, 'weighted avg': {'precision': 0.5060006279230636, 'recall': 0.5076168982297764, 'f1-score': 0.49845382294618257, 'support': 113432}}
[[12725 14886  6219]
 [ 7628 31389  7667]
 [ 4715 14737 13466]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
7633/7633 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.052958
{'0': {'precision': 0.47320779369373694, 'recall': 0.3873106260856431, 'f1-score': 0.4259720713267615, 'support': 662050}, '1': {'precision': 0.4137906962342437, 'recall': 0.5859556366233832, 'f1-score': 0.48504902268103284, 'support': 627184}, '2': {'precision': 0.4812128082691126, 'recall': 0.3793055724792365, 'f1-score': 0.4242249876548195, 'support': 664749}, 'accuracy': 0.4483478106001946, 'macro avg': {'precision': 0.4560704327323644, 'recall': 0.4508572783960876, 'f1-score': 0.44508202722087126, 'support': 1953983}, 'weighted avg': {'precision': 0.4568595821591082, 'recall': 0.4483478106001946, 'f1-score': 0.44434006456638414, 'support': 1953983}}
[[256419 253975 151656]
 [139507 367502 120175]
 [145948 266658 252143]]
Evaluating performance on  train set...
1586/1586 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0421019
{'0': {'precision': 0.48421697543846814, 'recall': 0.39812788992895004, 'f1-score': 0.4369726402132339, 'support': 133005}, '1': {'precision': 0.42687135610307725, 'recall': 0.5900621575986374, 'f1-score': 0.4953728636248274, 'support': 135623}, '2': {'precision': 0.4869313125567655, 'recall': 0.38684567280360344, 'f1-score': 0.4311564034556849, 'support': 137202}, 'accuracy': 0.4584555109282212, 'macro avg': {'precision': 0.46600654803277036, 'recall': 0.45834524011039696, 'f1-score': 0.45450063576458205, 'support': 405830}, 'weighted avg': {'precision': 0.4659704868845932, 'recall': 0.4584555109282212, 'f1-score': 0.4545228809153538, 'support': 405830}}
[[52953 50984 29068]
 [28740 80026 26857]
 [27665 56461 53076]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0255741
{'0': {'precision': 0.4635938044723343, 'recall': 0.4142358098035289, 'f1-score': 0.4375271735937298, 'support': 44943}, '1': {'precision': 0.4697672383619181, 'recall': 0.5872775670945157, 'f1-score': 0.5219906657159525, 'support': 54848}, '2': {'precision': 0.48861044850454793, 'recall': 0.3958881998131, 'f1-score': 0.4373892741074466, 'support': 47084}, 'accuracy': 0.4729736170212766, 'macro avg': {'precision': 0.47399049711293345, 'recall': 0.4658005255703815, 'f1-score': 0.4656357044723763, 'support': 146875}, 'weighted avg': {'precision': 0.4739188030737889, 'recall': 0.4729736170212766, 'f1-score': 0.4690244383188873, 'support': 146875}}
[[18617 17097  9229]
 [12357 32211 10280]
 [ 9184 19260 18640]]
testing model on single stock: results/universal/W10/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
22048/22048 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1541952
{'0': {'precision': 0.4063493401519196, 'recall': 0.4066872081763583, 'f1-score': 0.4065182039613896, 'support': 2133566}, '1': {'precision': 0.22680463559717573, 'recall': 0.20793776161222552, 'f1-score': 0.2169618079675683, 'support': 1318029}, '2': {'precision': 0.3917407681924589, 'recall': 0.411013980591735, 'f1-score': 0.4011460106307799, 'support': 2192468}, 'accuracy': 0.36195503133115275, 'macro avg': {'precision': 0.34163158131385146, 'recall': 0.3418796501267729, 'f1-score': 0.34154200751991254, 'support': 5644063}, 'weighted avg': {'precision': 0.35874640695532, 'recall': 0.36195503133115275, 'f1-score': 0.36016521516191746, 'support': 5644063}}
[[867694 413157 852715]
 [497476 274068 546485]
 [770170 521163 901135]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2057371
{'0': {'precision': 0.36600561654960356, 'recall': 0.3869800610883159, 'f1-score': 0.3762007168458782, 'support': 457698}, '1': {'precision': 0.34161252357844163, 'recall': 0.23074728352604745, 'f1-score': 0.2754426878189679, 'support': 459143}, '2': {'precision': 0.3534956096103456, 'recall': 0.4452631756999624, 'f1-score': 0.3941079099867407, 'support': 472954}, 'accuracy': 0.3551998676063736, 'macro avg': {'precision': 0.3537045832461303, 'recall': 0.3543301734381086, 'f1-score': 0.3485837715505289, 'support': 1389795}, 'weighted avg': {'precision': 0.3536897169327478, 'recall': 0.3551998676063736, 'f1-score': 0.34900745086293883, 'support': 1389795}}
[[177120  91175 189403]
 [157456 105946 195741]
 [149351 113014 210589]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.208765
{'0': {'precision': 0.3520493275844369, 'recall': 0.35527943071374457, 'f1-score': 0.35365700381894644, 'support': 154439}, '1': {'precision': 0.3517525067958019, 'recall': 0.23273639011142808, 'f1-score': 0.28012716435670537, 'support': 167911}, '2': {'precision': 0.3497805853825105, 'recall': 0.46989467942002394, 'f1-score': 0.40103695473904183, 'support': 161317}, 'accuracy': 0.3509646099485803, 'macro avg': {'precision': 0.3511941399209164, 'recall': 0.3526368334150655, 'f1-score': 0.3449403743048978, 'support': 483667}, 'weighted avg': {'precision': 0.35118959111031595, 'recall': 0.3509646099485803, 'f1-score': 0.34393279825733625, 'support': 483667}}
[[54869 32522 67048]
 [54969 39079 73863]
 [46018 39497 75802]]
training model: results/universal/W10/deepOF_L2/h100
Epoch 1/50
8543/8543 - 190s - loss: 3.1699 - accuracy100: 0.4249 - val_loss: 3.2522 - val_accuracy100: 0.3878 - 190s/epoch - 22ms/step
Epoch 2/50
8543/8543 - 185s - loss: 3.1354 - accuracy100: 0.4343 - val_loss: 3.2750 - val_accuracy100: 0.3947 - 185s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 188s - loss: 3.1163 - accuracy100: 0.4409 - val_loss: 3.2766 - val_accuracy100: 0.3958 - 188s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 187s - loss: 3.1044 - accuracy100: 0.4452 - val_loss: 3.2788 - val_accuracy100: 0.3971 - 187s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 185s - loss: 3.0959 - accuracy100: 0.4479 - val_loss: 3.2730 - val_accuracy100: 0.3966 - 185s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 187s - loss: 3.0900 - accuracy100: 0.4501 - val_loss: 3.2664 - val_accuracy100: 0.3952 - 187s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 187s - loss: 3.0848 - accuracy100: 0.4520 - val_loss: 3.2644 - val_accuracy100: 0.3950 - 187s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 186s - loss: 3.0806 - accuracy100: 0.4538 - val_loss: 3.2605 - val_accuracy100: 0.3920 - 186s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 185s - loss: 3.0769 - accuracy100: 0.4551 - val_loss: 3.2565 - val_accuracy100: 0.3938 - 185s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 185s - loss: 3.0737 - accuracy100: 0.4566 - val_loss: 3.2646 - val_accuracy100: 0.3910 - 185s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 187s - loss: 3.0706 - accuracy100: 0.4574 - val_loss: 3.2672 - val_accuracy100: 0.3903 - 187s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 282s - 282s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0828599
{'0': {'precision': 0.39900340715310445, 'recall': 0.5311621807281584, 'f1-score': 0.45569417450532934, 'support': 3330704}, '1': {'precision': 0.3536727136081412, 'recall': 0.3747273293861016, 'f1-score': 0.3638957265908943, 'support': 2843174}, '2': {'precision': 0.4128190041045016, 'recall': 0.25700841436849525, 'f1-score': 0.3167919220385168, 'support': 3371376}, 'accuracy': 0.3877352032748421, 'macro avg': {'precision': 0.3884983749552491, 'recall': 0.3876326414942517, 'f1-score': 0.3787939410449135, 'support': 9545254}, 'weighted avg': {'precision': 0.3903807474206978, 'recall': 0.3877352032748421, 'f1-score': 0.3792906884730845, 'support': 9545254}}
[[1769144  919255  642305]
 [1187621 1065415  590138]
 [1477142 1027762  866472]]
Evaluating performance on  train set...
8543/8543 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903178
{'0': {'precision': 0.36663612043783134, 'recall': 0.5743880373008595, 'f1-score': 0.44757916125754926, 'support': 690279}, '1': {'precision': 0.42345917774122777, 'recall': 0.36438904398169386, 'f1-score': 0.39170967373628796, 'support': 795581}, '2': {'precision': 0.3952587303209735, 'recall': 0.23725551186270424, 'f1-score': 0.2965223741263137, 'support': 700852}, 'accuracy': 0.38993246481475385, 'macro avg': {'precision': 0.39511800950001086, 'recall': 0.39201086438175253, 'f1-score': 0.3786037363733836, 'support': 2186712}, 'weighted avg': {'precision': 0.39648347031029446, 'recall': 0.38993246481475385, 'f1-score': 0.3788379854071614, 'support': 2186712}}
[[396488 180693 113098]
 [364370 289901 141310]
 [320563 214008 166281]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0916739
{'0': {'precision': 0.35075853913381555, 'recall': 0.5515483175260883, 'f1-score': 0.42881261665970766, 'support': 235546}, '1': {'precision': 0.44179615435820385, 'recall': 0.3767817866851793, 'f1-score': 0.4067071345156202, 'support': 308258}, '2': {'precision': 0.38587037868582547, 'recall': 0.24387073954190436, 'f1-score': 0.2988608870967742, 'support': 243137}, 'accuracy': 0.38802781911223333, 'macro avg': {'precision': 0.39280835739261494, 'recall': 0.3907336145843907, 'f1-score': 0.378126879424034, 'support': 786941}, 'weighted avg': {'precision': 0.3972678206771543, 'recall': 0.38802781911223333, 'f1-score': 0.38000302942824427, 'support': 786941}}
[[129915  66702  38929]
 [136672 116146  55440]
 [103796  80047  59294]]
testing model out of sample: results/universal/W10/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0580229
{'0': {'precision': 0.42894186864334083, 'recall': 0.4782965483909944, 'f1-score': 0.45227673647935634, 'support': 1787688}, '1': {'precision': 0.4108666679757769, 'recall': 0.511344389592892, 'f1-score': 0.45563185089980385, 'support': 1882252}, '2': {'precision': 0.4389003177357726, 'recall': 0.27567602580697037, 'f1-score': 0.3386462381862406, 'support': 1790834}, 'accuracy': 0.42323926974454534, 'macro avg': {'precision': 0.42623628478496345, 'recall': 0.4217723212636189, 'f1-score': 0.4155182751884669, 'support': 5460774}, 'weighted avg': {'precision': 0.42597742562025886, 'recall': 0.42323926974454534, 'f1-score': 0.4161686336807169, 'support': 5460774}}
[[855045 646700 285943]
 [574572 962479 345201]
 [563765 733379 493690]]
Evaluating performance on  train set...
4055/4055 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0556617
{'0': {'precision': 0.40959644275323204, 'recall': 0.48174140970962886, 'f1-score': 0.44274921613342555, 'support': 318179}, '1': {'precision': 0.44908610971123597, 'recall': 0.5072660021315278, 'f1-score': 0.4764063626043909, 'support': 398775}, '2': {'precision': 0.42461421348420203, 'recall': 0.28192888364735724, 'f1-score': 0.3388640032700266, 'support': 320517}, 'accuracy': 0.429822134787382, 'macro avg': {'precision': 0.42776558864955666, 'recall': 0.42364543182950465, 'f1-score': 0.41933986066928103, 'support': 1037471}, 'weighted avg': {'precision': 0.4294147728680558, 'recall': 0.429822134787382, 'f1-score': 0.4235917185384288, 'support': 1037471}}
[[153280 115522  49377]
 [123418 202285  73072]
 [ 97524 132630  90363]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0558776
{'0': {'precision': 0.4043415612922339, 'recall': 0.4972221072241772, 'f1-score': 0.4459974822962349, 'support': 120775}, '1': {'precision': 0.44495844347598296, 'recall': 0.5033303027241809, 'f1-score': 0.472347834880186, 'support': 148485}, '2': {'precision': 0.4394629126659271, 'recall': 0.27429662939233557, 'f1-score': 0.33776976302016976, 'support': 125645}, 'accuracy': 0.4285916866081716, 'macro avg': {'precision': 0.42958763914471465, 'recall': 0.4249496797802312, 'f1-score': 0.41870502673219684, 'support': 394905}, 'weighted avg': {'precision': 0.430787972313623, 'recall': 0.4285916866081716, 'f1-score': 0.42147097671891065, 'support': 394905}}
[[60052 42581 18142]
 [47931 74737 25817]
 [40535 50646 34464]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964824
{'0': {'precision': 0.4335185591067906, 'recall': 0.608322026232474, 'f1-score': 0.5062557400743762, 'support': 55275}, '1': {'precision': 0.20499264618197718, 'recall': 0.18793046900623156, 'f1-score': 0.19609110612570818, 'support': 27441}, '2': {'precision': 0.41204617701187884, 'recall': 0.24682795806690855, 'f1-score': 0.30872214004562887, 'support': 49889}, 'accuracy': 0.3853248369216847, 'macro avg': {'precision': 0.35018579410021555, 'recall': 0.3476934844352047, 'f1-score': 0.3370229954152377, 'support': 132605}, 'weighted avg': {'precision': 0.37814949122169683, 'recall': 0.3853248369216847, 'f1-score': 0.3677543148489354, 'support': 132605}}
[[33625  9949 11701]
 [16414  5157  5870]
 [27524 10051 12314]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1251132
{'0': {'precision': 0.36151637663326885, 'recall': 0.5392885237304431, 'f1-score': 0.4328609513119124, 'support': 11441}, '1': {'precision': 0.33674418604651163, 'recall': 0.25646475380800565, 'f1-score': 0.29117233058515984, 'support': 11292}, '2': {'precision': 0.3672290270395193, 'recall': 0.2742492233344839, 'f1-score': 0.3140005928267957, 'support': 11588}, 'accuracy': 0.3567495119606072, 'macro avg': {'precision': 0.3551631965730999, 'recall': 0.3566675002909776, 'f1-score': 0.3460112915746227, 'support': 34321}, 'weighted avg': {'precision': 0.3552948392888432, 'recall': 0.3567495119606072, 'f1-score': 0.3461122627721839, 'support': 34321}}
[[6170 2719 2552]
 [5472 2896 2924]
 [5425 2985 3178]]
Evaluating performance on  val set...
46/46 - 1s - 599ms/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.118601
{'0': {'precision': 0.3860991020951114, 'recall': 0.5341614906832298, 'f1-score': 0.44821928385290993, 'support': 4347}, '1': {'precision': 0.27926475330538536, 'recall': 0.26006006006006005, 'f1-score': 0.26932047893018196, 'support': 3330}, '2': {'precision': 0.37865212310089597, 'recall': 0.24269662921348314, 'f1-score': 0.295800365185636, 'support': 4005}, 'accuracy': 0.35610340695086456, 'macro avg': {'precision': 0.3480053261671309, 'recall': 0.34563939331892435, 'f1-score': 0.3377800426562427, 'support': 11682}, 'weighted avg': {'precision': 0.35309246518862103, 'recall': 0.35610340695086456, 'f1-score': 0.3449689166507942, 'support': 11682}}
[[2322 1179  846]
 [1715  866  749]
 [1977 1056  972]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
1840/1840 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0077218
{'0': {'precision': 0.4050347474054831, 'recall': 0.5114819070456779, 'f1-score': 0.45207677136381036, 'support': 120102}, '1': {'precision': 0.5565855372990072, 'recall': 0.6084961270096323, 'f1-score': 0.5813843856121351, 'support': 229022}, '2': {'precision': 0.48923295701889313, 'recall': 0.2767199067614373, 'f1-score': 0.35349563831571884, 'support': 121838}, 'accuracy': 0.4979255226536324, 'macro avg': {'precision': 0.4836177472411278, 'recall': 0.4655659802722492, 'f1-score': 0.4623189317638881, 'support': 470962}, 'weighted avg': {'precision': 0.5005138019064265, 'recall': 0.4979255226536324, 'f1-score': 0.4894542250481128, 'support': 470962}}
[[ 61430  48793   9879]
 [ 64343 139359  25320]
 [ 25893  62230  33715]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9761169
{'0': {'precision': 0.3620475488921628, 'recall': 0.4807625915838736, 'f1-score': 0.4130441947071812, 'support': 26069}, '1': {'precision': 0.6809848985485963, 'recall': 0.6696350136584075, 'f1-score': 0.675262266932827, 'support': 83099}, '2': {'precision': 0.4264212292846654, 'recall': 0.309976745072624, 'f1-score': 0.3589924722400053, 'support': 26231}, 'accuracy': 0.5635935272786358, 'macro avg': {'precision': 0.48981789224180816, 'recall': 0.4867914501049684, 'f1-score': 0.4824329779600045, 'support': 135399}, 'weighted avg': {'precision': 0.5702615004684353, 'recall': 0.5635935272786358, 'f1-score': 0.5635048986403155, 'support': 135399}}
[[12533 11643  1893]
 [18409 55646  9044]
 [ 3675 14425  8131]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99550503
{'0': {'precision': 0.3806949806949807, 'recall': 0.477327739228659, 'f1-score': 0.42356984320183294, 'support': 12394}, '1': {'precision': 0.5902885153140113, 'recall': 0.6404097365979013, 'f1-score': 0.614328511512454, 'support': 28018}, '2': {'precision': 0.49279216235129464, 'recall': 0.27790055248618784, 'f1-score': 0.35538733282866514, 'support': 12670}, 'accuracy': 0.5158057345239441, 'macro avg': {'precision': 0.4879252194534289, 'recall': 0.4652126761042494, 'f1-score': 0.4644285625143174, 'support': 53082}, 'weighted avg': {'precision': 0.5180798370406628, 'recall': 0.5158057345239441, 'f1-score': 0.5079827131445432, 'support': 53082}}
[[ 5916  5512   966]
 [ 7417 17943  2658]
 [ 2207  6942  3521]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.123676
{'0': {'precision': 0.3804582759655101, 'recall': 0.5393119991277326, 'f1-score': 0.44616730710252384, 'support': 91715}, '1': {'precision': 0.3126196572324868, 'recall': 0.18684257689179315, 'f1-score': 0.2338942100267495, 'support': 72537}, '2': {'precision': 0.33903629401930646, 'recall': 0.30195000120073967, 'f1-score': 0.3194202751279739, 'support': 83282}, 'accuracy': 0.3561652136676174, 'macro avg': {'precision': 0.34403807573910106, 'recall': 0.3427015257400885, 'f1-score': 0.3331605974190824, 'support': 247534}, 'weighted avg': {'precision': 0.3466426571516055, 'recall': 0.3561652136676174, 'f1-score': 0.34131948838069204, 'support': 247534}}
[[49463 15120 27132]
 [37091 13553 21893]
 [43455 14680 25147]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1362042
{'0': {'precision': 0.3413147138964578, 'recall': 0.5472069022006225, 'f1-score': 0.42040568036414744, 'support': 18313}, '1': {'precision': 0.33766135155656796, 'recall': 0.2423697405711794, 'f1-score': 0.28218795608858427, 'support': 18348}, '2': {'precision': 0.3574393707668779, 'recall': 0.2504081632653061, 'f1-score': 0.29450061504305297, 'support': 19600}, 'accuracy': 0.3443948738913279, 'macro avg': {'precision': 0.3454718120733012, 'recall': 0.3466616020123694, 'f1-score': 0.3323647504985949, 'support': 56261}, 'weighted avg': {'precision': 0.3457407173881827, 'recall': 0.3443948738913279, 'f1-score': 0.33146737344991756, 'support': 56261}}
[[10021  3994  4298]
 [ 9376  4447  4525]
 [ 9963  4729  4908]]
Evaluating performance on  val set...
79/79 - 1s - 796ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1324996
{'0': {'precision': 0.35918438480306725, 'recall': 0.6028078385492834, 'f1-score': 0.45014742819700776, 'support': 6838}, '1': {'precision': 0.34738445911630267, 'recall': 0.21176470588235294, 'f1-score': 0.2631275245239469, 'support': 6460}, '2': {'precision': 0.3522899934881702, 'recall': 0.24141008478357875, 'f1-score': 0.28649602824360104, 'support': 6723}, 'accuracy': 0.3552769591928475, 'macro avg': {'precision': 0.35295294580251335, 'recall': 0.35199420973840506, 'f1-score': 0.3332569936548519, 'support': 20021}, 'weighted avg': {'precision': 0.35306188778760583, 'recall': 0.3552769591928475, 'f1-score': 0.334849643889794, 'support': 20021}}
[[4122 1222 1494]
 [3602 1368 1490]
 [3752 1348 1623]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1588/1588 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.123598
{'0': {'precision': 0.3529323781783831, 'recall': 0.6104378846468057, 'f1-score': 0.4472699701706955, 'support': 146888}, '1': {'precision': 0.3031448112176384, 'recall': 0.08454396599777035, 'f1-score': 0.13221463255174104, 'support': 114816}, '2': {'precision': 0.3384941763727121, 'recall': 0.28142097290717055, 'f1-score': 0.30733031947638956, 'support': 144577}, 'accuracy': 0.3447367708556393, 'macro avg': {'precision': 0.3315237885895779, 'recall': 0.3254676078505822, 'f1-score': 0.29560497406627534, 'support': 406281}, 'weighted avg': {'precision': 0.3337243886572798, 'recall': 0.3447367708556393, 'f1-score': 0.3084363832628939, 'support': 406281}}
[[89666 10235 46987]
 [72583  9707 32526]
 [91811 12079 40687]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1339089
{'0': {'precision': 0.3449116942951353, 'recall': 0.5936176001865744, 'f1-score': 0.43631169202199843, 'support': 25727}, '1': {'precision': 0.3635962005743318, 'recall': 0.13246951832924228, 'f1-score': 0.19418964754460993, 'support': 24851}, '2': {'precision': 0.3258259613648673, 'recall': 0.2898032918506624, 'f1-score': 0.306760718990354, 'support': 24910}, 'accuracy': 0.3415509749894023, 'macro avg': {'precision': 0.3447779520781114, 'recall': 0.3386301367888263, 'f1-score': 0.31242068618565416, 'support': 75488}, 'weighted avg': {'precision': 0.34476469156955425, 'recall': 0.3415509749894023, 'f1-score': 0.3138539548250155, 'support': 75488}}
[[15272  2755  7700]
 [14322  3292  7237]
 [14684  3007  7219]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1272159
{'0': {'precision': 0.3368747458316389, 'recall': 0.6059802487198245, 'f1-score': 0.4330240460010455, 'support': 10936}, '1': {'precision': 0.5133715377268386, 'recall': 0.18393361279835743, 'f1-score': 0.2708320211626882, 'support': 11689}, '2': {'precision': 0.31862228776069096, 'recall': 0.2819461273184826, 'f1-score': 0.29916431785590664, 'support': 10729}, 'accuracy': 0.3538406188163339, 'macro avg': {'precision': 0.3896228571063895, 'recall': 0.35728666294555483, 'f1-score': 0.33434012833988014, 'support': 33354}, 'weighted avg': {'precision': 0.3928572480148789, 'recall': 0.3538406188163339, 'f1-score': 0.33312467556257475, 'support': 33354}}
[[6627  960 3349]
 [6419 2150 3120]
 [6626 1078 3025]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017474
{'0': {'precision': 0.3906140449387048, 'recall': 0.6176735971126341, 'f1-score': 0.4785776839020726, 'support': 208356}, '1': {'precision': 0.24098537290962496, 'recall': 0.13186076562752383, 'f1-score': 0.17045377431865996, 'support': 123820}, '2': {'precision': 0.3880524148470998, 'recall': 0.26574764996608197, 'f1-score': 0.31546040711619316, 'support': 206380}, 'accuracy': 0.3711183238140509, 'macro avg': {'precision': 0.33988394423180984, 'recall': 0.3384273375687466, 'f1-score': 0.3214972884456419, 'support': 538556}, 'weighted avg': {'precision': 0.35523111096536475, 'recall': 0.3711183238140509, 'f1-score': 0.3452284201900576, 'support': 538556}}
[[128696  25721  53939]
 [ 74943  16327  32550]
 [125832  25703  54845]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1321374
{'0': {'precision': 0.3455231362686288, 'recall': 0.5589213557272052, 'f1-score': 0.4270472349988448, 'support': 36379}, '1': {'precision': 0.35493798805695914, 'recall': 0.21185534504976283, 'f1-score': 0.2653366069742287, 'support': 36473}, '2': {'precision': 0.35056794569885025, 'recall': 0.27627521082939877, 'f1-score': 0.3090190332280171, 'support': 36641}, 'accuracy': 0.34872548930068586, 'macro avg': {'precision': 0.35034302334147943, 'recall': 0.349017303868789, 'f1-score': 0.33380095840036356, 'support': 109493}, 'weighted avg': {'precision': 0.3503475063343729, 'recall': 0.34872548930068586, 'f1-score': 0.3336828822363237, 'support': 109493}}
[[20333  6729  9317]
 [19310  7727  9436]
 [19204  7314 10123]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1280763
{'0': {'precision': 0.35282487272008306, 'recall': 0.5899661129018927, 'f1-score': 0.4415712960098979, 'support': 12099}, '1': {'precision': 0.3233462380070695, 'recall': 0.17086186960775593, 'f1-score': 0.2235800744878957, 'support': 11243}, '2': {'precision': 0.35869007288779386, 'recall': 0.2779412934531859, 'f1-score': 0.3131946934385085, 'support': 12571}, 'accuracy': 0.34953916409099767, 'macro avg': {'precision': 0.34495372787164885, 'recall': 0.34625642532094486, 'f1-score': 0.326115354645434, 'support': 35913}, 'weighted avg': {'precision': 0.3456492856410276, 'recall': 0.34953916409099767, 'f1-score': 0.32838950739583594, 'support': 35913}}
[[7138 1837 3124]
 [6199 1921 3123]
 [6894 2183 3494]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/EXC
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0159624
{'0': {'precision': 0.48574919128211774, 'recall': 0.4328246713355449, 'f1-score': 0.45776228265205743, 'support': 406950}, '1': {'precision': 0.4509598019899591, 'recall': 0.5754751148472198, 'f1-score': 0.5056650735174039, 'support': 524610}, '2': {'precision': 0.478817634256213, 'recall': 0.3633012020430892, 'f1-score': 0.4131365184732291, 'support': 416624}, 'accuracy': 0.46684873874782673, 'macro avg': {'precision': 0.4718422091760966, 'recall': 0.457200329408618, 'f1-score': 0.45885462488089673, 'support': 1348184}, 'weighted avg': {'precision': 0.47006979252725944, 'recall': 0.46684873874782673, 'f1-score': 0.4626118571468068, 'support': 1348184}}
[[176138 173269  57543]
 [115501 301900 107209]
 [ 70972 194292 151360]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99550503
{'0': {'precision': 0.433513086939366, 'recall': 0.5092778581562276, 'f1-score': 0.4683511600268692, 'support': 71191}, '1': {'precision': 0.5363930722891567, 'recall': 0.5559518606393606, 'f1-score': 0.5459973632572971, 'support': 128128}, '2': {'precision': 0.47646318554049866, 'recall': 0.36312080396980945, 'f1-score': 0.4121414823462594, 'support': 71943}, 'accuracy': 0.49256069777558226, 'macro avg': {'precision': 0.48212311492300713, 'recall': 0.4761168409217993, 'f1-score': 0.4754966685434752, 'support': 271262}, 'weighted avg': {'precision': 0.49349850954393015, 'recall': 0.49256069777558226, 'f1-score': 0.4901188970712475, 'support': 271262}}
[[36256 27509  7426]
 [35616 71233 21279]
 [11761 34058 26124]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98972756
{'0': {'precision': 0.42498239023244894, 'recall': 0.49596805762154544, 'f1-score': 0.4577394822883361, 'support': 25546}, '1': {'precision': 0.5558737081634588, 'recall': 0.5724049051003671, 'f1-score': 0.5640182015834994, 'support': 51212}, '2': {'precision': 0.4586249880141912, 'recall': 0.3589762833983789, 'f1-score': 0.4027280764535006, 'support': 26648}, 'accuracy': 0.4985203953348935, 'macro avg': {'precision': 0.47982702880336636, 'recall': 0.47578308204009717, 'f1-score': 0.474828586775112, 'support': 103406}, 'weighted avg': {'precision': 0.49847632791083074, 'recall': 0.4985203953348935, 'f1-score': 0.4961976165344843, 'support': 103406}}
[[12670 10339  2537]
 [13143 29314  8755]
 [ 4000 13082  9566]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/AAL
Evaluating performance on  test set...
10110/10110 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0262995
{'0': {'precision': 0.4651720789559552, 'recall': 0.4550683800567142, 'f1-score': 0.46006476317117917, 'support': 780052}, '1': {'precision': 0.4541155688368781, 'recall': 0.6014415913086669, 'f1-score': 0.5174973003293025, 'support': 1014712}, '2': {'precision': 0.47589372201597246, 'recall': 0.2885828379543495, 'f1-score': 0.3592909660156464, 'support': 793332}, 'accuracy': 0.4614237648062514, 'macro avg': {'precision': 0.46506045660293527, 'recall': 0.44836426977324356, 'f1-score': 0.44561767650537604, 'support': 2588096}, 'weighted avg': {'precision': 0.46412368238803065, 'recall': 0.4614237648062514, 'f1-score': 0.45169196965803304, 'support': 2588096}}
[[354977 336299  88776]
 [241062 610290 163360]
 [167070 397320 228942]]
Evaluating performance on  train set...
1686/1686 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0076773
{'0': {'precision': 0.44256167256311335, 'recall': 0.4690368334436131, 'f1-score': 0.4554147996837111, 'support': 117882}, '1': {'precision': 0.5239414874470364, 'recall': 0.613181068392336, 'f1-score': 0.5650595872855512, 'support': 197025}, '2': {'precision': 0.45444384541545585, 'recall': 0.2962480391568589, 'f1-score': 0.35867737717167947, 'support': 116659}, 'accuracy': 0.4881362294527372, 'macro avg': {'precision': 0.47364900180853514, 'recall': 0.45948864699760267, 'f1-score': 0.45971725471364727, 'support': 431566}, 'weighted avg': {'precision': 0.48292634547591545, 'recall': 0.4881362294527372, 'f1-score': 0.4793218574788605, 'support': 431566}}
[[ 55291  50310  12281]
 [ 47005 120812  29208]
 [ 22638  59461  34560]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0204794
{'0': {'precision': 0.4399654477397063, 'recall': 0.4940093568141189, 'f1-score': 0.4654237925875491, 'support': 52582}, '1': {'precision': 0.4808197289173455, 'recall': 0.5931409037024784, 'f1-score': 0.5311067088787267, 'support': 72546}, '2': {'precision': 0.4894918444165621, 'recall': 0.2822595232065984, 'f1-score': 0.35805245164398963, 'support': 55286}, 'accuracy': 0.4689824514727238, 'macro avg': {'precision': 0.47009234035787134, 'recall': 0.45646992790773194, 'f1-score': 0.45152765103675513, 'support': 180414}, 'weighted avg': {'precision': 0.47157015163735094, 'recall': 0.4689824514727238, 'f1-score': 0.45893261612593383, 'support': 180414}}
[[25976 20780  5826]
 [19067 43030 10449]
 [13998 25683 15605]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/WBA
Evaluating performance on  test set...
6546/6546 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0651891
{'0': {'precision': 0.4471632370701822, 'recall': 0.3484161264502917, 'f1-score': 0.391661448485917, 'support': 554716}, '1': {'precision': 0.38288486730160504, 'recall': 0.5705708678511263, 'f1-score': 0.45825504628874075, 'support': 575790}, '2': {'precision': 0.4284687816139659, 'recall': 0.30293732508280485, 'f1-score': 0.3549305519742836, 'support': 545258}, 'accuracy': 0.40995032713436974, 'macro avg': {'precision': 0.4195056286619177, 'recall': 0.40730810646140764, 'f1-score': 0.4016156822496471, 'support': 1675764}, 'weighted avg': {'precision': 0.4189945069135524, 'recall': 0.40995032713436974, 'f1-score': 0.4025914556401151, 'support': 1675764}}
[[193272 263859  97585]
 [124515 328529 122746]
 [114431 265648 165179]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0631382
{'0': {'precision': 0.44160027275337355, 'recall': 0.4564076409495549, 'f1-score': 0.4488818765504159, 'support': 107840}, '1': {'precision': 0.37189802248933695, 'recall': 0.52921933964588, 'f1-score': 0.4368257324685359, 'support': 101491}, '2': {'precision': 0.459788072272789, 'recall': 0.2567978982710054, 'f1-score': 0.329542066027689, 'support': 105437}, 'accuracy': 0.4130216540436131, 'macro avg': {'precision': 0.4244287891718332, 'recall': 0.4141416262888134, 'f1-score': 0.40508322501554694, 'support': 314768}, 'weighted avg': {'precision': 0.42521841670822685, 'recall': 0.4130216540436131, 'f1-score': 0.4050196614551748, 'support': 314768}}
[[49219 43955 14666]
 [30634 53711 17146]
 [31603 46758 27076]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0499444
{'0': {'precision': 0.43680277555377633, 'recall': 0.4528902293920695, 'f1-score': 0.444701055577443, 'support': 36139}, '1': {'precision': 0.4252109342535547, 'recall': 0.5591456605925257, 'f1-score': 0.48306650246305416, 'support': 42091}, '2': {'precision': 0.4597098918158444, 'recall': 0.26918925061076077, 'f1-score': 0.3395503000985398, 'support': 35202}, 'accuracy': 0.435309260173496, 'macro avg': {'precision': 0.4405745338743918, 'recall': 0.4270750468651186, 'f1-score': 0.4224392860463457, 'support': 113432}, 'weighted avg': {'precision': 0.43961030882912805, 'recall': 0.435309260173496, 'f1-score': 0.4263052160479796, 'support': 113432}}
[[16367 15287  4485]
 [11904 23535  6652]
 [ 9199 16527  9476]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
7633/7633 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.077091
{'0': {'precision': 0.4164038401302561, 'recall': 0.4422572782044796, 'f1-score': 0.42894134842637494, 'support': 652290}, '1': {'precision': 0.36804971795956937, 'recall': 0.4931012734915541, 'f1-score': 0.42149585017198826, 'support': 643742}, '2': {'precision': 0.43292562116123984, 'recall': 0.2623599629759663, 'f1-score': 0.3267214293825946, 'support': 657951}, 'accuracy': 0.39843233027104125, 'macro avg': {'precision': 0.4057930597503551, 'recall': 0.3992395048906667, 'f1-score': 0.3923862093269859, 'support': 1953983}, 'weighted avg': {'precision': 0.4060367811725858, 'recall': 0.39843233027104125, 'f1-score': 0.3920686233862647, 'support': 1953983}}
[[288480 259296 104514]
 [204717 317430 121595]
 [199592 285739 172620]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0692649
{'0': {'precision': 0.42797018300598855, 'recall': 0.4570302018425211, 'f1-score': 0.4420230826346787, 'support': 134164}, '1': {'precision': 0.3777521130906888, 'recall': 0.49193804050517187, 'f1-score': 0.4273490588393526, 'support': 135637}, '2': {'precision': 0.4384362015386585, 'recall': 0.2769262436686295, 'f1-score': 0.3394488799178186, 'support': 136029}, 'accuracy': 0.4083286105019343, 'macro avg': {'precision': 0.4147194992117786, 'recall': 0.4086314953387742, 'f1-score': 0.40294034046395, 'support': 405830}, 'weighted avg': {'precision': 0.41469431302564963, 'recall': 0.4083286105019343, 'f1-score': 0.40273715801871046, 'support': 405830}}
[[61317 51635 21212]
 [41875 66725 27037]
 [40082 58277 37670]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0659862
{'0': {'precision': 0.39456940066141916, 'recall': 0.4542964661871785, 'f1-score': 0.4223317048935994, 'support': 44909}, '1': {'precision': 0.4197780949311726, 'recall': 0.4981969183695771, 'f1-score': 0.45563800814531646, 'support': 54906}, '2': {'precision': 0.43156140643226126, 'recall': 0.27515937101572463, 'f1-score': 0.3360539804061507, 'support': 47060}, 'accuracy': 0.41331063829787235, 'macro avg': {'precision': 0.4153029673416177, 'recall': 0.4092175851908267, 'f1-score': 0.40467456448168887, 'support': 146875}, 'weighted avg': {'precision': 0.41584567204287215, 'recall': 0.41331063829787235, 'f1-score': 0.40713841925587646, 'support': 146875}}
[[20402 17528  6979]
 [17475 27354 10077]
 [13830 20281 12949]]
testing model on single stock: results/universal/W10/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
22048/22048 - 170s - 170s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1073678
{'0': {'precision': 0.38624014177344895, 'recall': 0.5938993781302806, 'f1-score': 0.4680716884688692, 'support': 2102048}, '1': {'precision': 0.23783107698189102, 'recall': 0.20456618458599965, 'f1-score': 0.219947997967878, 'support': 1398936}, '2': {'precision': 0.3938576560863284, 'recall': 0.22211687016670875, 'f1-score': 0.2840456094613048, 'support': 2143079}, 'accuracy': 0.35623167211280243, 'macro avg': {'precision': 0.3393096249472228, 'recall': 0.34019414429432965, 'f1-score': 0.3240217652993507, 'support': 5644063}, 'weighted avg': {'precision': 0.3523479175890074, 'recall': 0.35623167211280243, 'f1-score': 0.3366961902740144, 'support': 5644063}}
[[1248405  423251  430392]
 [ 810573  286175  302188]
 [1173221  493844  476014]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1236656
{'0': {'precision': 0.3506731029806106, 'recall': 0.6167934844118645, 'f1-score': 0.4471325168136008, 'support': 459452}, '1': {'precision': 0.33491690209757097, 'recall': 0.23165331912700976, 'f1-score': 0.2738746552367235, 'support': 458012}, '2': {'precision': 0.36892972964810083, 'recall': 0.20689093030099653, 'f1-score': 0.26511106770409437, 'support': 472331}, 'accuracy': 0.35056105396839105, 'macro avg': {'precision': 0.35150657824209414, 'recall': 0.3517792446132903, 'f1-score': 0.32870607991813955, 'support': 1389795}, 'weighted avg': {'precision': 0.3516852246616064, 'recall': 0.35056105396839105, 'f1-score': 0.32817356763340444, 'support': 1389795}}
[[283387  94952  81113]
 [265869 106100  86043]
 [258867 115743  97721]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1316301
{'0': {'precision': 0.3295966137692756, 'recall': 0.5855670924925763, 'f1-score': 0.4217844949481657, 'support': 150531}, '1': {'precision': 0.35941285804374523, 'recall': 0.247164018990231, 'f1-score': 0.2929024492500778, 'support': 175248}, '2': {'precision': 0.35257796583607587, 'recall': 0.21374011957843533, 'f1-score': 0.26614038477462804, 'support': 157888}, 'accuracy': 0.3415738514308398, 'macro avg': {'precision': 0.34719581254969895, 'recall': 0.3488237436870809, 'f1-score': 0.32694244299095715, 'support': 483667}, 'weighted avg': {'precision': 0.34790201168092805, 'recall': 0.3415738514308398, 'f1-score': 0.3242780328335744, 'support': 483667}}
[[88146 34681 27704]
 [97669 43315 34264]
 [81621 42520 33747]]
training model: results/universal/W10/deepOF_L2/h200
Epoch 1/50
8543/8543 - 196s - loss: 3.2479 - accuracy200: 0.3913 - val_loss: 3.3017 - val_accuracy200: 0.3666 - 196s/epoch - 23ms/step
Epoch 2/50
8543/8543 - 187s - loss: 3.2276 - accuracy200: 0.3984 - val_loss: 3.3089 - val_accuracy200: 0.3668 - 187s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 186s - loss: 3.2166 - accuracy200: 0.4036 - val_loss: 3.3017 - val_accuracy200: 0.3662 - 186s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 185s - loss: 3.2088 - accuracy200: 0.4070 - val_loss: 3.3036 - val_accuracy200: 0.3647 - 185s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 187s - loss: 3.2032 - accuracy200: 0.4097 - val_loss: 3.3069 - val_accuracy200: 0.3632 - 187s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 187s - loss: 3.1984 - accuracy200: 0.4120 - val_loss: 3.3159 - val_accuracy200: 0.3619 - 187s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 190s - loss: 3.1943 - accuracy200: 0.4144 - val_loss: 3.3241 - val_accuracy200: 0.3610 - 190s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 186s - loss: 3.1908 - accuracy200: 0.4158 - val_loss: 3.3284 - val_accuracy200: 0.3630 - 186s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 186s - loss: 3.1875 - accuracy200: 0.4176 - val_loss: 3.3373 - val_accuracy200: 0.3625 - 186s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 185s - loss: 3.1854 - accuracy200: 0.4190 - val_loss: 3.3398 - val_accuracy200: 0.3624 - 185s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 186s - loss: 3.1824 - accuracy200: 0.4200 - val_loss: 3.3492 - val_accuracy200: 0.3628 - 186s/epoch - 22ms/step
Epoch 12/50
8543/8543 - 194s - loss: 3.1794 - accuracy200: 0.4215 - val_loss: 3.3550 - val_accuracy200: 0.3632 - 194s/epoch - 23ms/step
Epoch 13/50
8543/8543 - 193s - loss: 3.1770 - accuracy200: 0.4229 - val_loss: 3.3611 - val_accuracy200: 0.3626 - 193s/epoch - 23ms/step
testing model in sample: results/universal/W10/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 282s - 282s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1327311
{'0': {'precision': 0.4558107866286657, 'recall': 0.060717936076223875, 'f1-score': 0.10716108897272232, 'support': 3439972}, '1': {'precision': 0.27705701790861337, 'recall': 0.8892960532582541, 'f1-score': 0.42248907066731844, 'support': 2656039}, '2': {'precision': 0.423656844365396, 'recall': 0.06898905064096673, 'f1-score': 0.11865595059891437, 'support': 3449243}, 'accuracy': 0.29426487760304754, 'macro avg': {'precision': 0.38550821630089166, 'recall': 0.33966767999181496, 'f1-score': 0.21610203674631837, 'support': 9545254}, 'weighted avg': {'precision': 0.39445215317675064, 'recall': 0.29426487760304754, 'f1-score': 0.1990572279515536, 'support': 9545254}}
[[ 208868 3073926  157178]
 [ 127491 2362005  166543]
 [ 121875 3089408  237960]]
Evaluating performance on  train set...
8543/8543 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1068616
{'0': {'precision': 0.43076876102073997, 'recall': 0.07850502133318865, 'f1-score': 0.13280680037089507, 'support': 718833}, '1': {'precision': 0.3397974011530613, 'recall': 0.8720492211586359, 'f1-score': 0.48903888259720646, 'support': 742770}, '2': {'precision': 0.38466941844673835, 'recall': 0.07929842271989453, 'f1-score': 0.13149048466249252, 'support': 725109}, 'accuracy': 0.34831473006047436, 'macro avg': {'precision': 0.38507852687351324, 'recall': 0.34328422173723966, 'f1-score': 0.2511120558768647, 'support': 2186712}, 'weighted avg': {'precision': 0.3845816796111133, 'recall': 0.34831473006047436, 'f1-score': 0.25337321759832754, 'support': 2186712}}
[[ 56432 621410  40991]
 [ 44050 647732  50988]
 [ 30521 637088  57500]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993807
{'0': {'precision': 0.40856494196052584, 'recall': 0.09026482806603106, 'f1-score': 0.14786224261599878, 'support': 247217}, '1': {'precision': 0.3608601544779328, 'recall': 0.855998930928861, 'f1-score': 0.5076937998037313, 'support': 284359}, '2': {'precision': 0.37969996366341946, 'recall': 0.08593190139604096, 'f1-score': 0.140146507513779, 'support': 255365}, 'accuracy': 0.36555472392466526, 'macro avg': {'precision': 0.38304168670062605, 'recall': 0.344065220130311, 'f1-score': 0.2652341833111697, 'support': 786941}, 'weighted avg': {'precision': 0.3819601636523639, 'recall': 0.36555472392466526, 'f1-score': 0.27538261971665573, 'support': 786941}}
[[ 22315 209632  15270]
 [ 20369 243411  20579]
 [ 11934 221487  21944]]
testing model out of sample: results/universal/W10/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1210177
{'0': {'precision': 0.4687450648880136, 'recall': 0.10296105623894948, 'f1-score': 0.16883669845104485, 'support': 1960314}, '1': {'precision': 0.28488546628524, 'recall': 0.8278813887600892, 'f1-score': 0.423900791790177, 'support': 1546329}, '2': {'precision': 0.44310393994009667, 'recall': 0.12165970449268754, 'f1-score': 0.1909042656129174, 'support': 1954131}, 'accuracy': 0.3149282500978799, 'macro avg': {'precision': 0.3989114903711168, 'recall': 0.35083404983057537, 'f1-score': 0.2612139186180464, 'support': 5460774}, 'weighted avg': {'precision': 0.4075058437842971, 'recall': 0.3149282500978799, 'f1-score': 0.2489601244479098, 'support': 5460774}}
[[ 201836 1606939  151539]
 [ 118899 1280177  147253]
 [ 109853 1606539  237739]]
Evaluating performance on  train set...
4055/4055 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027555
{'0': {'precision': 0.4478529143043092, 'recall': 0.1036704610312289, 'f1-score': 0.16836681880205145, 'support': 345161}, '1': {'precision': 0.3363126960440966, 'recall': 0.8250748550312351, 'f1-score': 0.4778476378136212, 'support': 348006}, '2': {'precision': 0.4149214911858202, 'recall': 0.12510165435196802, 'f1-score': 0.19224126003650857, 'support': 344304}, 'accuracy': 0.3527684147315925, 'macro avg': {'precision': 0.3996957005114086, 'recall': 0.3512823234714773, 'f1-score': 0.2794852388840604, 'support': 1037471}, 'weighted avg': {'precision': 0.399509311542158, 'recall': 0.3527684147315925, 'f1-score': 0.2801012648884759, 'support': 1037471}}
[[ 35783 283072  26306]
 [ 26444 287131  34431]
 [ 17672 283559  43073]]
Evaluating performance on  val set...
1545/1545 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026697
{'0': {'precision': 0.4365869017632242, 'recall': 0.1073219814241486, 'f1-score': 0.17229125248508947, 'support': 129200}, '1': {'precision': 0.33486106333726884, 'recall': 0.8203890128911766, 'f1-score': 0.47559631089369064, 'support': 131718}, '2': {'precision': 0.42562555632479476, 'recall': 0.12847515057430944, 'f1-score': 0.19737317334648083, 'support': 133987}, 'accuracy': 0.35233790405287346, 'macro avg': {'precision': 0.39902450714176263, 'recall': 0.35206204829654486, 'f1-score': 0.28175357890842034, 'support': 394905}, 'weighted avg': {'precision': 0.3989378424273109, 'recall': 0.35233790405287346, 'f1-score': 0.28196671117495004, 'support': 394905}}
[[ 13866 105249  10085]
 [ 10513 108060  13145]
 [  7381 109392  17214]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1354429
{'0': {'precision': 0.4070864923410181, 'recall': 0.050634129443236274, 'f1-score': 0.09006572641380255, 'support': 51961}, '1': {'precision': 0.2798627812890356, 'recall': 0.8153942258073278, 'f1-score': 0.41670310146919004, 'support': 36819}, '2': {'precision': 0.3413186347254611, 'recall': 0.14694808899030234, 'f1-score': 0.20544558403649532, 'support': 43825}, 'accuracy': 0.2948078880886844, 'macro avg': {'precision': 0.3427559694518383, 'recall': 0.33765881474695547, 'f1-score': 0.23740480397316266, 'support': 132605}, 'weighted avg': {'precision': 0.3500258522654197, 'recall': 0.2948078880886844, 'f1-score': 0.21889181722846884, 'support': 132605}}
[[ 2631 41884  7446]
 [ 1815 30022  4982]
 [ 2017 35368  6440]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1209444
{'0': {'precision': 0.38474970896391153, 'recall': 0.057333680284499956, 'f1-score': 0.09979618026723032, 'support': 11529}, '1': {'precision': 0.3277409860191317, 'recall': 0.7890168290522587, 'f1-score': 0.46311411489472315, 'support': 11290}, '2': {'precision': 0.3429835884196939, 'recall': 0.16171100678142933, 'f1-score': 0.21979320531757754, 'support': 11502}, 'accuracy': 0.33300311762477786, 'macro avg': {'precision': 0.3518247611342457, 'recall': 0.33602050537272926, 'f1-score': 0.2609011668265103, 'support': 34321}, 'weighted avg': {'precision': 0.35199942777903476, 'recall': 0.33300311762477786, 'f1-score': 0.25952536251930597, 'support': 34321}}
[[ 661 9142 1726]
 [ 545 8908 1837]
 [ 512 9130 1860]]
Evaluating performance on  val set...
46/46 - 1s - 602ms/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.133658
{'0': {'precision': 0.41352201257861637, 'recall': 0.05990888382687927, 'f1-score': 0.10465578989255869, 'support': 4390}, '1': {'precision': 0.2958927074601844, 'recall': 0.8250073035349109, 'f1-score': 0.4355672090691756, 'support': 3423}, '2': {'precision': 0.33688415446071907, 'recall': 0.13078314810028432, 'f1-score': 0.18841928877304043, 'support': 3869}, 'accuracy': 0.3075671973977059, 'macro avg': {'precision': 0.34876629149983995, 'recall': 0.33856644515402484, 'f1-score': 0.24288076257825822, 'support': 11682}, 'weighted avg': {'precision': 0.35367292984633275, 'recall': 0.3075671973977059, 'f1-score': 0.2293596732182002, 'support': 11682}}
[[ 263 3550  577]
 [ 180 2824  419]
 [ 193 3170  506]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904452
{'0': {'precision': 0.5040233162263195, 'recall': 0.15535491094677636, 'f1-score': 0.2375040429925609, 'support': 153616}, '1': {'precision': 0.34289105382943885, 'recall': 0.8402606907168364, 'f1-score': 0.4870345246236154, 'support': 158502}, '2': {'precision': 0.5086503224340218, 'recall': 0.1127206567449825, 'f1-score': 0.18454482207735318, 'support': 158844}, 'accuracy': 0.37148007694888335, 'macro avg': {'precision': 0.4518548974965933, 'recall': 0.36944541946953174, 'f1-score': 0.30302779656450984, 'support': 470962}, 'weighted avg': {'precision': 0.45135491902999764, 'recall': 0.37148007694888335, 'f1-score': 0.3036215342390524, 'support': 470962}}
[[ 23865 123708   6043]
 [ 14066 133183  11253]
 [  9418 131521  17905]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0406187
{'0': {'precision': 0.4708844415752098, 'recall': 0.20450849548589695, 'f1-score': 0.28516694033935414, 'support': 35666}, '1': {'precision': 0.48890946978467237, 'recall': 0.8264449871626276, 'f1-score': 0.6143694246760275, 'support': 63876}, '2': {'precision': 0.4634657281716105, 'recall': 0.15425161056418552, 'f1-score': 0.23146617563976482, 'support': 35857}, 'accuracy': 0.4846047607441709, 'macro avg': {'precision': 0.4744198798438309, 'recall': 0.3950683644042367, 'f1-score': 0.3770008468850488, 'support': 135399}, 'weighted avg': {'precision': 0.47742329264054095, 'recall': 0.4846047607441709, 'f1-score': 0.4262506231557425, 'support': 135399}}
[[ 7294 26959  1413]
 [ 6096 52790  4990]
 [ 2100 28226  5531]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.064619
{'0': {'precision': 0.4332859174964438, 'recall': 0.28848339436797577, 'f1-score': 0.34635939809725963, 'support': 15838}, '1': {'precision': 0.407598585091052, 'recall': 0.7275958840037419, 'f1-score': 0.5224955915694013, 'support': 21380}, '2': {'precision': 0.5139524245196706, 'recall': 0.14164145234493192, 'f1-score': 0.2220794623443368, 'support': 15864}, 'accuracy': 0.42146113560152215, 'macro avg': {'precision': 0.4516123090357221, 'recall': 0.3859069102388832, 'f1-score': 0.3636448173369992, 'support': 53082}, 'weighted avg': {'precision': 0.44704761262076453, 'recall': 0.42146113560152215, 'f1-score': 0.380160214111163, 'support': 53082}}
[[ 4569 10678   591]
 [ 4290 15556  1534]
 [ 1686 11931  2247]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
967/967 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.149998
{'0': {'precision': 0.38919065725149377, 'recall': 0.029582378563613468, 'f1-score': 0.05498532317786774, 'support': 96882}, '1': {'precision': 0.2709239636507762, 'recall': 0.8415158706615248, 'f1-score': 0.4098861046190302, 'support': 67420}, '2': {'precision': 0.32054491660435025, 'recall': 0.11845203767781623, 'f1-score': 0.17298160348805589, 'support': 83232}, 'accuracy': 0.28060791648824, 'macro avg': {'precision': 0.32688651250220674, 'recall': 0.32985009563431816, 'f1-score': 0.2126176770949846, 'support': 247534}, 'weighted avg': {'precision': 0.3338969894397854, 'recall': 0.28060791648824, 'f1-score': 0.19132407699568973, 'support': 247534}}
[[ 2866 81723 12293]
 [ 2080 56735  8605]
 [ 2418 70955  9859]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1316305
{'0': {'precision': 0.33209941829719725, 'recall': 0.03516631201702318, 'f1-score': 0.0635981568687022, 'support': 17858}, '1': {'precision': 0.329100745126059, 'recall': 0.8669534821188492, 'f1-score': 0.47709381473808826, 'support': 18595}, '2': {'precision': 0.329619312906221, 'recall': 0.08961025848142165, 'f1-score': 0.14091215813916566, 'support': 19808}, 'accuracy': 0.32925116866035087, 'macro avg': {'precision': 0.33027315877649244, 'recall': 0.33057668420576464, 'f1-score': 0.2272013765819854, 'support': 56261}, 'weighted avg': {'precision': 0.33023513833058143, 'recall': 0.32925116866035087, 'f1-score': 0.22748410797598034, 'support': 56261}}
[[  628 15430  1800]
 [  664 16121  1810]
 [  599 17434  1775]]
Evaluating performance on  val set...
79/79 - 1s - 792ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1291654
{'0': {'precision': 0.3447368421052632, 'recall': 0.03786127167630058, 'f1-score': 0.06822916666666667, 'support': 6920}, '1': {'precision': 0.31927437641723355, 'recall': 0.8734491315136477, 'f1-score': 0.46761873131849885, 'support': 6448}, '2': {'precision': 0.3220234423195558, 'recall': 0.07846084473169998, 'f1-score': 0.12617839013778098, 'support': 6653}, 'accuracy': 0.3204635133110234, 'macro avg': {'precision': 0.32867822028068416, 'recall': 0.3299237493072161, 'f1-score': 0.2206754293743155, 'support': 20021}, 'weighted avg': {'precision': 0.3289886663133084, 'recall': 0.3204635133110234, 'f1-score': 0.21611389253592084, 'support': 20021}}
[[ 262 6126  532]
 [ 249 5632  567]
 [ 249 5882  522]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1572978
{'0': {'precision': 0.35707513628821996, 'recall': 0.020656935807869245, 'f1-score': 0.03905455063935138, 'support': 145859}, '1': {'precision': 0.28531078816650324, 'recall': 0.912259678007607, 'f1-score': 0.4346759294697403, 'support': 115158}, '2': {'precision': 0.3158196665991766, 'recall': 0.06442752505782576, 'f1-score': 0.10702237875790462, 'support': 145264}, 'accuracy': 0.289026560434773, 'macro avg': {'precision': 0.31940186368463325, 'recall': 0.33244804629110064, 'f1-score': 0.1935842862889988, 'support': 406281}, 'weighted avg': {'precision': 0.3219832335167149, 'recall': 0.289026560434773, 'f1-score': 0.17549274323798, 'support': 406281}}
[[  3013 130224  12622]
 [  2451 105054   7653]
 [  2974 132931   9359]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1315814
{'0': {'precision': 0.34854535082715343, 'recall': 0.024644052756826525, 'f1-score': 0.04603330068560235, 'support': 24793}, '1': {'precision': 0.33368447603080165, 'recall': 0.9010416666666666, 'f1-score': 0.48701263547678086, 'support': 24960}, '2': {'precision': 0.32228535353535354, 'recall': 0.0793471925393433, 'f1-score': 0.12734245891927287, 'support': 25735}, 'accuracy': 0.33307280627384483, 'macro avg': {'precision': 0.33483839346443617, 'recall': 0.3350109706542788, 'f1-score': 0.22012946502721867, 'support': 75488}, 'weighted avg': {'precision': 0.3346791937528978, 'recall': 0.33307280627384483, 'f1-score': 0.21956201231568032, 'support': 75488}}
[[  611 21786  2396]
 [  572 22490  1898]
 [  570 23123  2042]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1401411
{'0': {'precision': 0.17576703068122726, 'recall': 0.032307398203020456, 'f1-score': 0.05458215583366977, 'support': 10462}, '1': {'precision': 0.3310512052488946, 'recall': 0.7743765118024856, 'f1-score': 0.4638173506856843, 'support': 11989}, '2': {'precision': 0.2423974018305285, 'recall': 0.07530037604329083, 'f1-score': 0.11490552834149756, 'support': 10903}, 'accuracy': 0.31309588055405646, 'macro avg': {'precision': 0.2497385459202168, 'recall': 0.2939947620162656, 'f1-score': 0.21110167828695056, 'support': 33354}, 'weighted avg': {'precision': 0.2533641076594786, 'recall': 0.31309588055405646, 'f1-score': 0.22139952351171885, 'support': 33354}}
[[ 338 8952 1172]
 [1311 9284 1394]
 [ 274 9808  821]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
2104/2104 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1659201
{'0': {'precision': 0.4026294165981923, 'recall': 0.025719698234932028, 'f1-score': 0.04835078087856688, 'support': 209567}, '1': {'precision': 0.23241152515803642, 'recall': 0.8723877136598391, 'f1-score': 0.367040367040367, 'support': 125082}, '2': {'precision': 0.3611764917261081, 'recall': 0.09858415846439798, 'f1-score': 0.15489050869920326, 'support': 203907}, 'accuracy': 0.24994986593780405, 'macro avg': {'precision': 0.3320724778274456, 'recall': 0.33223052345305637, 'f1-score': 0.19009388553937903, 'support': 538556}, 'weighted avg': {'precision': 0.347400738709524, 'recall': 0.24994986593780405, 'f1-score': 0.16270569865315815, 'support': 538556}}
[[  5390 181541  22636]
 [  3043 109120  12919]
 [  4954 178851  20102]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1296508
{'0': {'precision': 0.3216324200913242, 'recall': 0.030794873896767494, 'f1-score': 0.05620807461160569, 'support': 36597}, '1': {'precision': 0.32870434366526663, 'recall': 0.8573845513798364, 'f1-score': 0.4752190622598002, 'support': 36055}, '2': {'precision': 0.32744474212993974, 'recall': 0.10615889905268587, 'f1-score': 0.16033616890437632, 'support': 36841}, 'accuracy': 0.32834062451480917, 'macro avg': {'precision': 0.3259271686288436, 'recall': 0.3314461081097632, 'f1-score': 0.2305877685919274, 'support': 109493}, 'weighted avg': {'precision': 0.32591680320881233, 'recall': 0.32834062451480917, 'f1-score': 0.22922026974276122, 'support': 109493}}
[[ 1127 31256  4214]
 [ 1323 30913  3819]
 [ 1054 31876  3911]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1376839
{'0': {'precision': 0.3035019455252918, 'recall': 0.025622074402562207, 'f1-score': 0.04725482771677395, 'support': 12177}, '1': {'precision': 0.30517552916881774, 'recall': 0.8590372388737512, 'f1-score': 0.4503595066901576, 'support': 11010}, '2': {'precision': 0.3231441048034934, 'recall': 0.09885274241709885, 'f1-score': 0.15139298393405137, 'support': 12726}, 'accuracy': 0.30707543229471224, 'macro avg': {'precision': 0.31060719316586766, 'recall': 0.3278373518978041, 'f1-score': 0.21633577278032767, 'support': 35913}, 'weighted avg': {'precision': 0.3109753472151983, 'recall': 0.30707543229471224, 'f1-score': 0.20773834876814884, 'support': 35913}}
[[  312 10443  1422]
 [  339  9458  1213]
 [  377 11091  1258]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/EXC
Evaluating performance on  test set...
5267/5267 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142057
{'0': {'precision': 0.5486228875504356, 'recall': 0.09732567065706757, 'f1-score': 0.16532304249376648, 'support': 481990}, '1': {'precision': 0.27402084917900765, 'recall': 0.8364252157762482, 'f1-score': 0.4128033861977393, 'support': 366120}, '2': {'precision': 0.5372806262015173, 'recall': 0.1559269228154233, 'f1-score': 0.2417068736506185, 'support': 500074}, 'accuracy': 0.31977608397666785, 'macro avg': {'precision': 0.45330812097698686, 'recall': 0.3632259364162464, 'f1-score': 0.27327776744737475, 'support': 1348184}, 'weighted avg': {'precision': 0.4698433824603691, 'recall': 0.31977608397666785, 'f1-score': 0.26086272507331804, 'support': 1348184}}
[[ 46910 407267  27813]
 [ 20547 306232  39341]
 [ 18048 404051  77975]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0812966
{'0': {'precision': 0.5319419160916133, 'recall': 0.13938345147370407, 'f1-score': 0.22088812319808732, 'support': 90147}, '1': {'precision': 0.33754096967908387, 'recall': 0.8376294093496521, 'f1-score': 0.4811800026771884, 'support': 90121}, '2': {'precision': 0.5488333333333333, 'recall': 0.14475679715146053, 'f1-score': 0.2290902134024384, 'support': 90994}, 'accuracy': 0.3731632148992487, 'macro avg': {'precision': 0.4727720730346768, 'recall': 0.3739232193249389, 'f1-score': 0.31038611309257136, 'support': 271262}, 'weighted avg': {'precision': 0.4730225316177449, 'recall': 0.3731632148992487, 'f1-score': 0.3101159010165462, 'support': 271262}}
[[12565 74138  3444]
 [ 7249 75488  7384]
 [ 3807 74015 13172]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0766182
{'0': {'precision': 0.5198035322395235, 'recall': 0.15300849021779253, 'f1-score': 0.23642369940822777, 'support': 32508}, '1': {'precision': 0.35572221958513317, 'recall': 0.8303601108033241, 'f1-score': 0.498072577429217, 'support': 36100}, '2': {'precision': 0.5392413000313513, 'recall': 0.1482843841600092, 'f1-score': 0.23260531476097096, 'support': 34798}, 'accuracy': 0.3878885171073245, 'macro avg': {'precision': 0.4715890172853359, 'recall': 0.3772176617270419, 'f1-score': 0.32236719719947193, 'support': 103406}, 'weighted avg': {'precision': 0.4690623765696062, 'recall': 0.3878885171073245, 'f1-score': 0.3264828095914132, 'support': 103406}}
[[ 4974 26194  1340]
 [ 3055 29976  3069]
 [ 1540 28098  5160]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/AAL
Evaluating performance on  test set...
10110/10110 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1148692
{'0': {'precision': 0.4911709769384358, 'recall': 0.15518628201764015, 'f1-score': 0.23585407818937404, 'support': 933665}, '1': {'precision': 0.27300420152415145, 'recall': 0.7799344714508089, 'f1-score': 0.4044402453525471, 'support': 704731}, '2': {'precision': 0.4965437870372356, 'recall': 0.1462840897125408, 'f1-score': 0.2259903732128711, 'support': 949700}, 'accuracy': 0.32203674052276265, 'macro avg': {'precision': 0.4202396551666076, 'recall': 0.36046828106032996, 'f1-score': 0.28876156558493077, 'support': 2588096}, 'weighted avg': {'precision': 0.43373634852679505, 'recall': 0.32203674052276265, 'f1-score': 0.27814012072986916, 'support': 2588096}}
[[144892 724134  64639]
 [ 78866 549644  76221]
 [ 71235 739539 138926]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0917313
{'0': {'precision': 0.47338661678428706, 'recall': 0.1543933112408314, 'f1-score': 0.23284505923068077, 'support': 144242}, '1': {'precision': 0.3381991672963803, 'recall': 0.7838339022396824, 'f1-score': 0.47252078433970385, 'support': 145601}, '2': {'precision': 0.4594301740072662, 'recall': 0.15257932727927012, 'f1-score': 0.22907993008104244, 'support': 141723}, 'accuracy': 0.366157204228322, 'macro avg': {'precision': 0.42367198602931117, 'recall': 0.36360218025326135, 'f1-score': 0.3114819245504757, 'support': 431566}, 'weighted avg': {'precision': 0.4231941160484171, 'recall': 0.366157204228322, 'f1-score': 0.3124700061753536, 'support': 431566}}
[[ 22270 112334   9638]
 [ 15669 114127  15805]
 [  9105 110994  21624]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062847
{'0': {'precision': 0.47440638902288684, 'recall': 0.14392337962210153, 'f1-score': 0.22084710872684177, 'support': 61498}, '1': {'precision': 0.298651075322031, 'recall': 0.7815541165587419, 'f1-score': 0.4321622948807136, 'support': 54050}, '2': {'precision': 0.4804785584166215, 'recall': 0.15044861714919988, 'f1-score': 0.22914636580297496, 'support': 64866}, 'accuracy': 0.33729644040928086, 'macro avg': {'precision': 0.4178453409205131, 'recall': 0.3586420377766811, 'f1-score': 0.2940519231368434, 'support': 180414}, 'weighted avg': {'precision': 0.42393526502121703, 'recall': 0.33729644040928086, 'f1-score': 0.28713866825723977, 'support': 180414}}
[[ 8851 48106  4541]
 [ 5796 42243  6011]
 [ 4010 51097  9759]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/WBA
Evaluating performance on  test set...
6546/6546 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910814
{'0': {'precision': 0.4224120362576312, 'recall': 0.08773644283963296, 'f1-score': 0.14529467789249115, 'support': 543366}, '1': {'precision': 0.3622578960780872, 'recall': 0.8180865302169144, 'f1-score': 0.5021556397338104, 'support': 602957}, '2': {'precision': 0.4008039831451741, 'recall': 0.1523512534918905, 'f1-score': 0.22078066044514147, 'support': 529441}, 'accuracy': 0.3709382705440623, 'macro avg': {'precision': 0.3951579718269642, 'recall': 0.35272474218281263, 'f1-score': 0.28941032602381433, 'support': 1675764}, 'weighted avg': {'precision': 0.3939411124592027, 'recall': 0.3709382705440623, 'f1-score': 0.2975459430214795, 'support': 1675764}}
[[ 47673 443938  51755]
 [ 40854 493271  68832]
 [ 24332 424448  80661]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965116
{'0': {'precision': 0.43815465889425265, 'recall': 0.09084900048158186, 'f1-score': 0.15049390344050867, 'support': 105901}, '1': {'precision': 0.3420245921827931, 'recall': 0.8447306112135363, 'f1-score': 0.48690520501243406, 'support': 106853}, '2': {'precision': 0.41197024736204807, 'recall': 0.11672907640127826, 'f1-score': 0.1819140078980133, 'support': 102014}, 'accuracy': 0.3551536369643674, 'macro avg': {'precision': 0.39738316614636465, 'recall': 0.3507695626987988, 'f1-score': 0.2731043721169853, 'support': 314768}, 'weighted avg': {'precision': 0.39703560430050133, 'recall': 0.3551536369643674, 'f1-score': 0.27487709151233564, 'support': 314768}}
[[ 9621 88627  7653]
 [ 7247 90262  9344]
 [ 5090 85016 11908]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0807478
{'0': {'precision': 0.42536415875985567, 'recall': 0.08837002693023127, 'f1-score': 0.14633809939772882, 'support': 36019}, '1': {'precision': 0.38059190063997805, 'recall': 0.8436477517060859, 'f1-score': 0.5245468085879318, 'support': 42788}, '2': {'precision': 0.4119077643667808, 'recall': 0.132072202166065, 'f1-score': 0.20001312135062438, 'support': 34625}, 'accuracy': 0.38661048028774947, 'macro avg': {'precision': 0.4059546079222048, 'recall': 0.35469666026746066, 'f1-score': 0.290299343112095, 'support': 113432}, 'weighted avg': {'precision': 0.4043679404414487, 'recall': 0.38661048028774947, 'f1-score': 0.30538750242288415, 'support': 113432}}
[[ 3183 30267  2569]
 [ 2730 36098  3960]
 [ 1570 28482  4573]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
7633/7633 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1122351
{'0': {'precision': 0.4250159717785617, 'recall': 0.06869248876524717, 'f1-score': 0.11826981791760817, 'support': 668239}, '1': {'precision': 0.3155153774068138, 'recall': 0.8732338467719676, 'f1-score': 0.46354386799957165, 'support': 612277}, '2': {'precision': 0.4127635124425424, 'recall': 0.09280187447937316, 'f1-score': 0.1515342175799477, 'support': 673467}, 'accuracy': 0.32910368206888185, 'macro avg': {'precision': 0.3844316205426393, 'recall': 0.34490940333886266, 'f1-score': 0.24444930116570918, 'support': 1953983}, 'weighted avg': {'precision': 0.3864811828618713, 'recall': 0.32910368206888185, 'f1-score': 0.23792584103010772, 'support': 1953983}}
[[ 45903 577785  44551]
 [ 33250 534661  44366]
 [ 28850 582118  62499]]
Evaluating performance on  train set...
1586/1586 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016705
{'0': {'precision': 0.4278175208162308, 'recall': 0.08110571756771778, 'f1-score': 0.13636023823170276, 'support': 134935}, '1': {'precision': 0.3384285215000188, 'recall': 0.8585864507382845, 'f1-score': 0.48549124253637027, 'support': 136465}, '2': {'precision': 0.4103995299647474, 'recall': 0.10392025589526148, 'f1-score': 0.1658455511367009, 'support': 134430}, 'accuracy': 0.3500997954808664, 'macro avg': {'precision': 0.39221519076033234, 'recall': 0.347870808067088, 'f1-score': 0.26256567730159136, 'support': 405830}, 'weighted avg': {'precision': 0.39198978432101905, 'recall': 0.3500997954808664, 'f1-score': 0.26352647314842986, 'support': 405830}}
[[ 10944 114927   9064]
 [  8292 117167  11006]
 [  6345 114115  13970]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0831641
{'0': {'precision': 0.384042756251193, 'recall': 0.09100983829017302, 'f1-score': 0.147148629623535, 'support': 44215}, '1': {'precision': 0.3888979088193272, 'recall': 0.8436085723845246, 'f1-score': 0.5323746603619472, 'support': 56787}, '2': {'precision': 0.39498978278967684, 'recall': 0.11377062760229328, 'f1-score': 0.17665775310564263, 'support': 45873}, 'accuracy': 0.38909957446808513, 'macro avg': {'precision': 0.38931014928673235, 'recall': 0.349463012758997, 'f1-score': 0.285393681030375, 'support': 146875}, 'weighted avg': {'precision': 0.38933897750931384, 'recall': 0.38909957446808513, 'f1-score': 0.3053069453957014, 'support': 146875}}
[[ 4024 37145  3046]
 [ 3933 47906  4948]
 [ 2521 38133  5219]]
testing model on single stock: results/universal/W10/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
22048/22048 - 177s - 177s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1512946
{'0': {'precision': 0.42883028477680646, 'recall': 0.04139913131086769, 'f1-score': 0.07550868007050293, 'support': 2115141}, '1': {'precision': 0.2504043283649252, 'recall': 0.9370912940051029, 'f1-score': 0.39520434715143415, 'support': 1413302}, '2': {'precision': 0.3482068279748094, 'recall': 0.024828182754937086, 'f1-score': 0.04635137460456127, 'support': 2115620}, 'accuracy': 0.25947353883186636, 'macro avg': {'precision': 0.3424804803721804, 'recall': 0.3344395360236359, 'f1-score': 0.1723548006088328, 'support': 5644063}, 'weighted avg': {'precision': 0.35393063203936087, 'recall': 0.25947353883186636, 'f1-score': 0.14463277508626704, 'support': 5644063}}
[[  87565 1968718   58858]
 [  49444 1324393   39465]
 [  67186 1995907   52527]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192266
{'0': {'precision': 0.3874487213057519, 'recall': 0.05760870035429545, 'f1-score': 0.100303539283105, 'support': 462326}, '1': {'precision': 0.3271951299992113, 'recall': 0.8896949404761905, 'f1-score': 0.47843902875306116, 'support': 456960}, '2': {'precision': 0.32006063153604136, 'recall': 0.05340386687608526, 'f1-score': 0.09153467294213648, 'support': 470509}, 'accuracy': 0.3297723765015704, 'macro avg': {'precision': 0.34490149428033484, 'recall': 0.33356916923552377, 'f1-score': 0.22342574699276754, 'support': 1389795}, 'weighted avg': {'precision': 0.34482359759118, 'recall': 0.3297723765015704, 'f1-score': 0.22166457651159438, 'support': 1389795}}
[[ 26634 409549  26143]
 [ 23168 406555  27237]
 [ 18940 426442  25127]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096524
{'0': {'precision': 0.3724215880192145, 'recall': 0.06054203031694993, 'f1-score': 0.10415267296218737, 'support': 152390}, '1': {'precision': 0.35575099315554665, 'recall': 0.8882116419332722, 'f1-score': 0.5080251847396031, 'support': 172102}, '2': {'precision': 0.315892202855871, 'recall': 0.057955080885817495, 'f1-score': 0.09794137319644544, 'support': 159175}, 'accuracy': 0.35419823969797404, 'macro avg': {'precision': 0.3480215946768774, 'recall': 0.3355695843786799, 'f1-score': 0.23670641029941197, 'support': 483667}, 'weighted avg': {'precision': 0.3478858896966038, 'recall': 0.35419823969797404, 'f1-score': 0.2458174617149963, 'support': 483667}}
[[  9226 133638   9526]
 [  8787 152863  10452]
 [  6760 143190   9225]]
training model: results/universal/W10/deepVOL_L2/h50
Epoch 1/50
8543/8543 - 278s - loss: 3.0382 - accuracy50: 0.4591 - val_loss: 3.4090 - val_accuracy50: 0.4267 - 278s/epoch - 33ms/step
Epoch 2/50
8543/8543 - 268s - loss: 2.9896 - accuracy50: 0.4751 - val_loss: 3.3660 - val_accuracy50: 0.4347 - 268s/epoch - 31ms/step
Epoch 3/50
8543/8543 - 268s - loss: 2.9779 - accuracy50: 0.4779 - val_loss: 3.4515 - val_accuracy50: 0.4372 - 268s/epoch - 31ms/step
Epoch 4/50
8543/8543 - 273s - loss: 2.9699 - accuracy50: 0.4803 - val_loss: 3.3738 - val_accuracy50: 0.4412 - 273s/epoch - 32ms/step
Epoch 5/50
8543/8543 - 272s - loss: 2.9623 - accuracy50: 0.4829 - val_loss: 3.3941 - val_accuracy50: 0.4408 - 272s/epoch - 32ms/step
Epoch 6/50
8543/8543 - 272s - loss: 2.9562 - accuracy50: 0.4847 - val_loss: 3.3706 - val_accuracy50: 0.4408 - 272s/epoch - 32ms/step
Epoch 7/50
8543/8543 - 271s - loss: 2.9513 - accuracy50: 0.4863 - val_loss: 3.4336 - val_accuracy50: 0.4481 - 271s/epoch - 32ms/step
Epoch 8/50
8543/8543 - 272s - loss: 2.9467 - accuracy50: 0.4878 - val_loss: 3.3959 - val_accuracy50: 0.4467 - 272s/epoch - 32ms/step
Epoch 9/50
8543/8543 - 270s - loss: 2.9425 - accuracy50: 0.4892 - val_loss: 3.3843 - val_accuracy50: 0.4455 - 270s/epoch - 32ms/step
Epoch 10/50
8543/8543 - 274s - loss: 2.9382 - accuracy50: 0.4899 - val_loss: 3.3435 - val_accuracy50: 0.4484 - 274s/epoch - 32ms/step
Epoch 11/50
8543/8543 - 274s - loss: 2.9351 - accuracy50: 0.4907 - val_loss: 3.3285 - val_accuracy50: 0.4481 - 274s/epoch - 32ms/step
Epoch 12/50
8543/8543 - 274s - loss: 2.9308 - accuracy50: 0.4919 - val_loss: 3.3471 - val_accuracy50: 0.4480 - 274s/epoch - 32ms/step
Epoch 13/50
8543/8543 - 273s - loss: 2.9278 - accuracy50: 0.4925 - val_loss: 3.3623 - val_accuracy50: 0.4504 - 273s/epoch - 32ms/step
Epoch 14/50
8543/8543 - 274s - loss: 2.9249 - accuracy50: 0.4932 - val_loss: 3.3429 - val_accuracy50: 0.4501 - 274s/epoch - 32ms/step
Epoch 15/50
8543/8543 - 269s - loss: 2.9221 - accuracy50: 0.4940 - val_loss: 3.3519 - val_accuracy50: 0.4512 - 269s/epoch - 31ms/step
Epoch 16/50
8543/8543 - 273s - loss: 2.9194 - accuracy50: 0.4947 - val_loss: 3.3422 - val_accuracy50: 0.4508 - 273s/epoch - 32ms/step
Epoch 17/50
8543/8543 - 274s - loss: 2.9172 - accuracy50: 0.4952 - val_loss: 3.3437 - val_accuracy50: 0.4537 - 274s/epoch - 32ms/step
Epoch 18/50
8543/8543 - 271s - loss: 2.9149 - accuracy50: 0.4955 - val_loss: 3.3626 - val_accuracy50: 0.4531 - 271s/epoch - 32ms/step
Epoch 19/50
8543/8543 - 269s - loss: 2.9151 - accuracy50: 0.4956 - val_loss: 3.3667 - val_accuracy50: 0.4561 - 269s/epoch - 31ms/step
Epoch 20/50
8543/8543 - 275s - loss: 2.9116 - accuracy50: 0.4965 - val_loss: 3.3366 - val_accuracy50: 0.4545 - 275s/epoch - 32ms/step
Epoch 21/50
8543/8543 - 277s - loss: 2.9092 - accuracy50: 0.4971 - val_loss: 3.3219 - val_accuracy50: 0.4555 - 277s/epoch - 32ms/step
Epoch 22/50
8543/8543 - 277s - loss: 2.9070 - accuracy50: 0.4977 - val_loss: 3.3759 - val_accuracy50: 0.4540 - 277s/epoch - 32ms/step
Epoch 23/50
8543/8543 - 280s - loss: 2.9052 - accuracy50: 0.4986 - val_loss: 3.3637 - val_accuracy50: 0.4547 - 280s/epoch - 33ms/step
Epoch 24/50
8543/8543 - 280s - loss: 2.9040 - accuracy50: 0.4986 - val_loss: 3.3860 - val_accuracy50: 0.4559 - 280s/epoch - 33ms/step
Epoch 25/50
8543/8543 - 281s - loss: 2.9021 - accuracy50: 0.4990 - val_loss: 3.3546 - val_accuracy50: 0.4540 - 281s/epoch - 33ms/step
Epoch 26/50
8543/8543 - 283s - loss: 2.9004 - accuracy50: 0.4996 - val_loss: 3.3306 - val_accuracy50: 0.4526 - 283s/epoch - 33ms/step
Epoch 27/50
8543/8543 - 284s - loss: 2.8990 - accuracy50: 0.4999 - val_loss: 3.3464 - val_accuracy50: 0.4515 - 284s/epoch - 33ms/step
Epoch 28/50
8543/8543 - 277s - loss: 2.8979 - accuracy50: 0.5001 - val_loss: 3.3355 - val_accuracy50: 0.4537 - 277s/epoch - 32ms/step
Epoch 29/50
8543/8543 - 275s - loss: 2.8966 - accuracy50: 0.5003 - val_loss: 3.3597 - val_accuracy50: 0.4552 - 275s/epoch - 32ms/step
Epoch 30/50
8543/8543 - 276s - loss: 2.8950 - accuracy50: 0.5010 - val_loss: 3.3575 - val_accuracy50: 0.4539 - 276s/epoch - 32ms/step
Epoch 31/50
8543/8543 - 278s - loss: 2.8950 - accuracy50: 0.5014 - val_loss: 3.3524 - val_accuracy50: 0.4535 - 278s/epoch - 33ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 588s - 588s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0734198
{'0': {'precision': 0.4246962970302138, 'recall': 0.5810465045095244, 'f1-score': 0.49071849878469015, 'support': 3201668}, '1': {'precision': 0.5871875037781243, 'recall': 0.3927912417524259, 'f1-score': 0.47070838995727304, 'support': 3091212}, '2': {'precision': 0.45290101562588286, 'recall': 0.4312761134165888, 'f1-score': 0.4418241172853817, 'support': 3252399}, 'accuracy': 0.46904873079142057, 'macro avg': {'precision': 0.4882616054780737, 'recall': 0.46837128655951304, 'f1-score': 0.4677503353424483, 'support': 9545279}, 'weighted avg': {'precision': 0.4869289218439523, 'recall': 0.46904873079142057, 'f1-score': 0.4675783133566281, 'support': 9545279}}
[[1860318  468363  872987]
 [1055575 1214201  821436]
 [1464456  385261 1402682]]
Evaluating performance on  train set...
8543/8543 - 140s - 140s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1521071
{'0': {'precision': 0.3917958554281702, 'recall': 0.5867140199353802, 'f1-score': 0.46984118836179817, 'support': 655217}, '1': {'precision': 0.6532549174223508, 'recall': 0.3453148030433026, 'f1-score': 0.45180339143785786, 'support': 863667}, '2': {'precision': 0.4212148845182799, 'recall': 0.4724019070550255, 'f1-score': 0.4453423807671921, 'support': 667836}, 'accuracy': 0.4564594461110705, 'macro avg': {'precision': 0.4887552191229336, 'recall': 0.46814357667790274, 'f1-score': 0.45566232018894937, 'support': 2186720}, 'weighted avg': {'precision': 0.5040464638310522, 'recall': 0.4564594461110705, 'f1-score': 0.4552349124670059, 'support': 2186720}}
[[384425  86495 184297]
 [316221 298237 249209]
 [280541  71808 315487]]
Evaluating performance on  val set...
3077/3077 - 48s - 48s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1571876
{'0': {'precision': 0.38569226156040914, 'recall': 0.5638510790920925, 'f1-score': 0.4580580760618351, 'support': 225838}, '1': {'precision': 0.6549665390899527, 'recall': 0.35576581149302317, 'f1-score': 0.4610809224533367, 'support': 329017}, '2': {'precision': 0.40956593663466034, 'recall': 0.4907104201854469, 'f1-score': 0.4464812861897687, 'support': 232088}, 'accuracy': 0.4552807509565496, 'macro avg': {'precision': 0.4834082457616741, 'recall': 0.4701091035901875, 'f1-score': 0.45520676156831347, 'support': 786943}, 'weighted avg': {'precision': 0.5053154216502386, 'recall': 0.4552807509565496, 'f1-score': 0.4559076456537427, 'support': 786943}}
[[127339  33778  64721]
 [112503 117053  99461]
 [ 90315  27885 113888]]
testing model out of sample: results/universal/W10/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 335s - 335s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9592979
{'0': {'precision': 0.5051618733330651, 'recall': 0.4269019553039808, 'f1-score': 0.4627464017915134, 'support': 1617191}, '1': {'precision': 0.591132209822857, 'recall': 0.6509516912397367, 'f1-score': 0.619601480063109, 'support': 2227981}, '2': {'precision': 0.4781066408728454, 'recall': 0.4855272906431992, 'f1-score': 0.48178839368245846, 'support': 1615627}, 'accuracy': 0.5356580602948396, 'macro avg': {'precision': 0.5248002413429225, 'recall': 0.5211269790623055, 'f1-score': 0.5213787585123603, 'support': 5460799}, 'weighted avg': {'precision': 0.5322328408249752, 'recall': 0.5356580602948396, 'f1-score': 0.5323763021733842, 'support': 5460799}}
[[ 690382  532738  394071]
 [ 315472 1450308  462201]
 [ 360801  470395  784431]]
Evaluating performance on  train set...
4055/4055 - 69s - 69s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9725046
{'0': {'precision': 0.48298907854597956, 'recall': 0.43330478200012534, 'f1-score': 0.45679991190397534, 'support': 287202}, '1': {'precision': 0.6266939290453092, 'recall': 0.628580778880768, 'f1-score': 0.6276359358661554, 'support': 458350}, '2': {'precision': 0.46489759194231656, 'recall': 0.5097489792003508, 'f1-score': 0.4862912976700108, 'support': 291928}, 'accuracy': 0.5410860932258935, 'macro avg': {'precision': 0.5248601998445351, 'recall': 0.5238781800270814, 'f1-score': 0.5235757151467139, 'support': 1037480}, 'weighted avg': {'precision': 0.5413860661747855, 'recall': 0.5410860932258935, 'f1-score': 0.5405721801375534, 'support': 1037480}}
[[124446  91892  70864]
 [ 69822 288110 100418]
 [ 63390  79728 148810]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9688381
{'0': {'precision': 0.47371007371007373, 'recall': 0.43542707545952325, 'f1-score': 0.4537625422076207, 'support': 108482}, '1': {'precision': 0.6260278993059533, 'recall': 0.629756788829107, 'f1-score': 0.6278868078409751, 'support': 173594}, '2': {'precision': 0.471135183557008, 'recall': 0.5034255377606821, 'f1-score': 0.48674541863225235, 'support': 112829}, 'accuracy': 0.5402793076815943, 'macro avg': {'precision': 0.5236243855243451, 'recall': 0.5228698006831042, 'f1-score': 0.5227982562269494, 'support': 394905}, 'weighted avg': {'precision': 0.539930907417955, 'recall': 0.5402793076815943, 'f1-score': 0.5397284143350216, 'support': 394905}}
[[ 47236  35282  25964]
 [ 26475 109322  37797]
 [ 26004  30024  56801]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1568087
{'0': {'precision': 0.4490682313605297, 'recall': 0.5307106746469871, 'f1-score': 0.4864879261363636, 'support': 51627}, '1': {'precision': 0.32622792494481234, 'recall': 0.14372549615536578, 'f1-score': 0.19954007468511994, 'support': 32903}, '2': {'precision': 0.4236703385229681, 'recall': 0.5031613976705491, 'f1-score': 0.4600070354912009, 'support': 48080}, 'accuracy': 0.4247040193047282, 'macro avg': {'precision': 0.39965549827610336, 'recall': 0.3925325228243007, 'f1-score': 0.38201167877089476, 'support': 132610}, 'weighted avg': {'precision': 0.40938083757705707, 'recall': 0.4247040193047282, 'f1-score': 0.40568974818206377, 'support': 132610}}
[[27399  5010 19218]
 [14483  4729 13691]
 [19131  4757 24192]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1782203
{'0': {'precision': 0.4203059188649967, 'recall': 0.4920840903192318, 'f1-score': 0.4533715925394548, 'support': 11559}, '1': {'precision': 0.4358742774566474, 'recall': 0.21723082463089666, 'f1-score': 0.28995433789954345, 'support': 11108}, '2': {'precision': 0.41307198111970633, 'recall': 0.5405799588194921, 'f1-score': 0.46830174656261614, 'support': 11656}, 'accuracy': 0.41960201614078024, 'macro avg': {'precision': 0.4230840591471168, 'recall': 0.4166316245898735, 'f1-score': 0.40387589233387144, 'support': 34323}, 'weighted avg': {'precision': 0.4228877021845478, 'recall': 0.41960201614078024, 'f1-score': 0.40555488102687814, 'support': 34323}}
[[5688 1679 4192]
 [3934 2413 4761]
 [3911 1444 6301]]
Evaluating performance on  val set...
46/46 - 1s - 506ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1679552
{'0': {'precision': 0.4111111111111111, 'recall': 0.5088772193048262, 'f1-score': 0.45479941892948933, 'support': 3999}, '1': {'precision': 0.4246941896024465, 'recall': 0.2946949602122016, 'f1-score': 0.3479486376448481, 'support': 3770}, '2': {'precision': 0.4161807580174927, 'recall': 0.4377715307947866, 'f1-score': 0.4267032008967493, 'support': 3913}, 'accuracy': 0.4159390515322719, 'macro avg': {'precision': 0.4173286862436834, 'recall': 0.4137812367706048, 'f1-score': 0.4098170858236956, 'support': 11682}, 'weighted avg': {'precision': 0.4171927524616509, 'recall': 0.4159390515322719, 'f1-score': 0.41090556970801967, 'support': 11682}}
[[2035  810 1154]
 [1410 1111 1249]
 [1505  695 1713]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
1840/1840 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7825548
{'0': {'precision': 0.5371564302680693, 'recall': 0.36797694042167417, 'f1-score': 0.43675592158810306, 'support': 86038}, '1': {'precision': 0.7485944771951598, 'recall': 0.8091271278522274, 'f1-score': 0.7776846611054524, 'support': 298188}, '2': {'precision': 0.46900041236194234, 'recall': 0.4851454329555804, 'f1-score': 0.4769363283994832, 'support': 86741}, 'accuracy': 0.6688663961593913, 'macro avg': {'precision': 0.5849171066083905, 'recall': 0.554083167076494, 'f1-score': 0.5637923036976795, 'support': 470967}, 'weighted avg': {'precision': 0.6584735654132066, 'recall': 0.6688663961593913, 'f1-score': 0.6600117922678433, 'support': 470967}}
[[ 31660  43617  10761]
 [ 20032 241272  36884]
 [  7248  37411  42082]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.70202667
{'0': {'precision': 0.5016370289529435, 'recall': 0.45288049148023646, 'f1-score': 0.4760135238037221, 'support': 17254}, '1': {'precision': 0.8410411509420282, 'recall': 0.808354322007745, 'f1-score': 0.8243738515111828, 'support': 100451}, '2': {'precision': 0.4218327104008249, 'recall': 0.554871157323689, 'f1-score': 0.4792912405730603, 'support': 17696}, 'accuracy': 0.7299281393785866, 'macro avg': {'precision': 0.5881702967652654, 'recall': 0.6053686569372235, 'f1-score': 0.5932262052959884, 'support': 135401}, 'weighted avg': {'precision': 0.7430035346421723, 'recall': 0.7299281393785866, 'f1-score': 0.734882703163493, 'support': 135401}}
[[ 7814  8309  1131]
 [ 6924 81200 12327]
 [  839  7038  9819]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7565927
{'0': {'precision': 0.5407161202598579, 'recall': 0.41864545560884314, 'f1-score': 0.47191455696202533, 'support': 8549}, '1': {'precision': 0.7881382901779257, 'recall': 0.7631239845369489, 'f1-score': 0.7754294578939129, 'support': 35698}, '2': {'precision': 0.42797108757774416, 'recall': 0.5763440860215053, 'f1-score': 0.49119760767858, 'support': 8835}, 'accuracy': 0.6765570249802193, 'macro avg': {'precision': 0.5856084993385092, 'recall': 0.5860378420557657, 'f1-score': 0.5795138741781728, 'support': 53082}, 'weighted avg': {'precision': 0.68834383319435, 'recall': 0.6765570249802193, 'f1-score': 0.6792398402321975, 'support': 53082}}
[[ 3579  4035   935]
 [ 2585 27242  5871]
 [  455  3288  5092]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2631527
{'0': {'precision': 0.41900911200026897, 'recall': 0.5521133312657835, 'f1-score': 0.47643944028138857, 'support': 90284}, '1': {'precision': 0.3108213529477321, 'recall': 0.07647171725480519, 'f1-score': 0.12274447671859873, 'support': 72942}, '2': {'precision': 0.3847544495566262, 'recall': 0.5048450416898936, 'f1-score': 0.43669399103323037, 'support': 84313}, 'accuracy': 0.3958568144817584, 'macro avg': {'precision': 0.3715283048348758, 'recall': 0.3778100300701608, 'f1-score': 0.3452926360110726, 'support': 247539}, 'weighted avg': {'precision': 0.3754622572605269, 'recall': 0.3958568144817584, 'f1-score': 0.35867910314398, 'support': 247539}}
[[49847  6531 33906]
 [33206  5578 34158]
 [35911  5837 42565]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3038492
{'0': {'precision': 0.38959028108623156, 'recall': 0.5294879404305833, 'f1-score': 0.44889183687472844, 'support': 18533}, '1': {'precision': 0.35440729483282674, 'recall': 0.15686380024753807, 'f1-score': 0.21747239629961204, 'support': 18583}, '2': {'precision': 0.3965954839838964, 'recall': 0.4732884223719254, 'f1-score': 0.4315611533058737, 'support': 19149}, 'accuracy': 0.38729227761485824, 'macro avg': {'precision': 0.3801976866343182, 'recall': 0.38654672101668225, 'f1-score': 0.36597512882673805, 'support': 56265}, 'weighted avg': {'precision': 0.3803542941803462, 'recall': 0.38729227761485824, 'f1-score': 0.3665612099509324, 'support': 56265}}
[[9813 2605 6115]
 [7994 2915 7674]
 [7381 2705 9063]]
Evaluating performance on  val set...
79/79 - 1s - 775ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2780079
{'0': {'precision': 0.4036611852311511, 'recall': 0.5655702072163454, 'f1-score': 0.4710923355461678, 'support': 6901}, '1': {'precision': 0.38215859030837, 'recall': 0.10946372239747634, 'f1-score': 0.17018146150073565, 'support': 6340}, '2': {'precision': 0.40089034676663543, 'recall': 0.5047197640117994, 'f1-score': 0.44685296422042303, 'support': 6780}, 'accuracy': 0.4005294440837121, 'macro avg': {'precision': 0.3955700407687188, 'recall': 0.3932512312085404, 'f1-score': 0.3627089204224421, 'support': 20021}, 'weighted avg': {'precision': 0.39591368327820925, 'recall': 0.4005294440837121, 'f1-score': 0.36759511367730063, 'support': 20021}}
[[3903  591 2407]
 [2939  694 2707]
 [2827  531 3422]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1686912
{'0': {'precision': 0.35002214114687225, 'recall': 0.6186426003781713, 'f1-score': 0.44708679547502256, 'support': 144379}, '1': {'precision': 0.2895437941168392, 'recall': 0.08792693606906042, 'f1-score': 0.13489098167673252, 'support': 119895}, '2': {'precision': 0.358085722257097, 'recall': 0.2892079542573867, 'f1-score': 0.31998223662682895, 'support': 142012}, 'accuracy': 0.3468787996632914, 'macro avg': {'precision': 0.33255055250693616, 'recall': 0.3319258302348728, 'f1-score': 0.3006533379261947, 'support': 406286}, 'weighted avg': {'precision': 0.33499350088720153, 'recall': 0.3468787996632914, 'f1-score': 0.310530060302027, 'support': 406286}}
[[89319 13173 41887]
 [77615 10542 31738]
 [88247 12694 41071]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1699666
{'0': {'precision': 0.34248934076746473, 'recall': 0.6354059707168663, 'f1-score': 0.44507785132993244, 'support': 26295}, '1': {'precision': 0.33657313058473115, 'recall': 0.08669143180166357, 'f1-score': 0.13787124739123455, 'support': 24766}, '2': {'precision': 0.3351207753234614, 'recall': 0.2788489090834664, 'f1-score': 0.30440611314684063, 'support': 24429}, 'accuracy': 0.3400052987150616, 'macro avg': {'precision': 0.3380610822252191, 'recall': 0.3336487705339988, 'f1-score': 0.2957850706226692, 'support': 75490}, 'weighted avg': {'precision': 0.3381638996942479, 'recall': 0.3400052987150616, 'f1-score': 0.2987704113349591, 'support': 75490}}
[[16708  2248  7339]
 [16443  2147  6176]
 [15633  1984  6812]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1716386
{'0': {'precision': 0.33235115289275524, 'recall': 0.6319253001333927, 'f1-score': 0.4356035064059339, 'support': 11245}, '1': {'precision': 0.37660028449502136, 'recall': 0.09177571713320046, 'f1-score': 0.1475855341091213, 'support': 11539}, '2': {'precision': 0.3320598187970746, 'recall': 0.28779564806054875, 'f1-score': 0.3083472707921545, 'support': 10570}, 'accuracy': 0.33600167895904537, 'macro avg': {'precision': 0.3470037520616171, 'recall': 0.3371655551090473, 'f1-score': 0.2971787704357366, 'support': 33354}, 'weighted avg': {'precision': 0.3475670588760617, 'recall': 0.33600167895904537, 'f1-score': 0.29563415362154316, 'support': 33354}}
[[7106  935 3204]
 [7565 1059 2915]
 [6710  818 3042]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1088346
{'0': {'precision': 0.466900726851764, 'recall': 0.5563032506647854, 'f1-score': 0.5076962126668166, 'support': 221124}, '1': {'precision': 0.20372793333199138, 'recall': 0.10432729971549912, 'f1-score': 0.13799074244500342, 'support': 97012}, '2': {'precision': 0.47157933962389703, 'recall': 0.4822592718611773, 'f1-score': 0.47685951525428294, 'support': 220425}, 'accuracy': 0.4445828791910294, 'macro avg': {'precision': 0.38073599993588414, 'recall': 0.3809632740804873, 'f1-score': 0.374182156788701, 'support': 538561}, 'weighted avg': {'precision': 0.421409806000379, 'recall': 0.4445828791910294, 'f1-score': 0.4284794737935669, 'support': 538561}}
[[123012  20069  78043]
 [ 45819  10121  41072]
 [ 94634  19489 106302]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2866821
{'0': {'precision': 0.40821344387547753, 'recall': 0.5495253986924529, 'f1-score': 0.4684443097156315, 'support': 36557}, '1': {'precision': 0.3933927847588164, 'recall': 0.10718427301341875, 'f1-score': 0.16846764744173937, 'support': 36218}, '2': {'precision': 0.396457333280438, 'recall': 0.5443231024810044, 'f1-score': 0.4587699264343016, 'support': 36719}, 'accuracy': 0.40146492045226223, 'macro avg': {'precision': 0.399354520638244, 'recall': 0.400344258062292, 'f1-score': 0.3652272945305575, 'support': 109494}, 'weighted avg': {'precision': 0.3993686920459116, 'recall': 0.40146492045226223, 'f1-score': 0.36597487363746295, 'support': 109494}}
[[20089  3083 13385]
 [15294  3882 17042]
 [13829  2903 19987]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2665865
{'0': {'precision': 0.3990343652371485, 'recall': 0.5828424458641003, 'f1-score': 0.4737338997909502, 'support': 12053}, '1': {'precision': 0.37083641746854185, 'recall': 0.08861767046962059, 'f1-score': 0.14305089585266614, 'support': 11307}, '2': {'precision': 0.40651031654491865, 'recall': 0.5053772006691627, 'f1-score': 0.45058418267694167, 'support': 12553}, 'accuracy': 0.400161501406176, 'macro avg': {'precision': 0.3921270330835363, 'recall': 0.3922791056676278, 'f1-score': 0.355789659440186, 'support': 35913}, 'weighted avg': {'precision': 0.39276954250852103, 'recall': 0.400161501406176, 'f1-score': 0.3615285389338141, 'support': 35913}}
[[7025  820 4208]
 [5251 1002 5054]
 [5329  880 6344]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8364408
{'0': {'precision': 0.5829311618694292, 'recall': 0.36355614815976783, 'f1-score': 0.44782049501542764, 'support': 305994}, '1': {'precision': 0.6594856166018483, 'recall': 0.745840587791786, 'f1-score': 0.7000099171121369, 'support': 733457}, '2': {'precision': 0.4962147554384295, 'recall': 0.5269354598397347, 'f1-score': 0.5111139037685166, 'support': 308738}, 'accuracy': 0.6089450366380381, 'macro avg': {'precision': 0.579543844636569, 'recall': 0.5454440652637628, 'f1-score': 0.552981438632027, 'support': 1348189}, 'weighted avg': {'precision': 0.6047209486248336, 'recall': 0.6089450366380381, 'f1-score': 0.5995137497403937, 'support': 1348189}}
[[111246 158651  36097]
 [ 57345 547042 129070]
 [ 22248 123805 162685]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7568964
{'0': {'precision': 0.562992341356674, 'recall': 0.41658402315367643, 'f1-score': 0.47884702625364955, 'support': 49409}, '1': {'precision': 0.7528584927286655, 'recall': 0.7842818617600634, 'f1-score': 0.7682489872767729, 'support': 171687}, '2': {'precision': 0.504136078782453, 'recall': 0.5612454402296331, 'f1-score': 0.531160096965581, 'support': 50167}, 'accuracy': 0.676059764877628, 'macro avg': {'precision': 0.6066623042892642, 'recall': 0.5873704417144577, 'f1-score': 0.5927520368320012, 'support': 271263}, 'weighted avg': {'precision': 0.6722770864418577, 'recall': 0.676059764877628, 'f1-score': 0.6716891916082406, 'support': 271263}}
[[ 20583  25095   3731]
 [ 13073 134651  23963]
 [  2904  19107  28156]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76618516
{'0': {'precision': 0.5776253821366604, 'recall': 0.39259841635311954, 'f1-score': 0.46746907388833164, 'support': 17807}, '1': {'precision': 0.7619363102336469, 'recall': 0.7681107796429049, 'f1-score': 0.7650110864745012, 'support': 67377}, '2': {'precision': 0.44636441402908467, 'recall': 0.5727143013939194, 'f1-score': 0.5017066487188115, 'support': 18222}, 'accuracy': 0.6690134034775544, 'macro avg': {'precision': 0.5953087021331306, 'recall': 0.5778078324633147, 'f1-score': 0.5780622696938814, 'support': 103406}, 'weighted avg': {'precision': 0.6745876477840543, 'recall': 0.6690134034775544, 'f1-score': 0.6673739659698293, 'support': 103406}}
[[ 6991  9377  1439]
 [ 4119 51753 11505]
 [  993  6793 10436]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
10110/10110 - 76s - 76s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8590539
{'0': {'precision': 0.5742811413736965, 'recall': 0.3526863523975518, 'f1-score': 0.4369972461014339, 'support': 592104}, '1': {'precision': 0.6549660220328439, 'recall': 0.7870078737341186, 'f1-score': 0.7149413978732199, 'support': 1397939}, '2': {'precision': 0.49721683703442604, 'recall': 0.45285908724571866, 'f1-score': 0.4740024607048537, 'support': 598058}, 'accuracy': 0.6104290365793298, 'macro avg': {'precision': 0.5754880001469888, 'recall': 0.5308511044591296, 'f1-score': 0.5419803682265024, 'support': 2588101}, 'weighted avg': {'precision': 0.6000543309282126, 'recall': 0.6104290365793298, 'f1-score': 0.5956773881125034, 'support': 2588101}}
[[ 208827  307756   75521]
 [  99403 1100189  198347]
 [  55402  271820  270836]]
Evaluating performance on  train set...
1686/1686 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82593304
{'0': {'precision': 0.541760989289455, 'recall': 0.36567538598371685, 'f1-score': 0.4366337172888925, 'support': 87698}, '1': {'precision': 0.7138966896434346, 'recall': 0.784464687867713, 'f1-score': 0.7475189259631914, 'support': 256654}, '2': {'precision': 0.4716878804648589, 'recall': 0.48863740598055405, 'f1-score': 0.4800130655643535, 'support': 87216}, 'accuracy': 0.6395793942090239, 'macro avg': {'precision': 0.5757818531325829, 'recall': 0.5462591599439947, 'f1-score': 0.5547219029388125, 'support': 431568}, 'weighted avg': {'precision': 0.6299691506438749, 'recall': 0.6395793942090239, 'f1-score': 0.6302840935593438, 'support': 431568}}
[[ 32069  44221  11408]
 [ 18993 201336  36325]
 [  8132  36467  42617]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8604521
{'0': {'precision': 0.5237274386534172, 'recall': 0.3819136350192251, 'f1-score': 0.44171726674078504, 'support': 40572}, '1': {'precision': 0.6833976833976834, 'recall': 0.7655961040562199, 'f1-score': 0.7221654205290472, 'support': 97332}, '2': {'precision': 0.49094259254827827, 'recall': 0.4826158550929193, 'f1-score': 0.4867436149895017, 'support': 42510}, 'accuracy': 0.6126353830633986, 'macro avg': {'precision': 0.5660225715331263, 'recall': 0.5433751980561214, 'f1-score': 0.550208767419778, 'support': 180414}, 'weighted avg': {'precision': 0.6021434177543709, 'recall': 0.6126353830633986, 'f1-score': 0.6036262636510696, 'support': 180414}}
[[15495 18480  6597]
 [ 8139 74517 14676]
 [ 5952 16042 20516]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9908331
{'0': {'precision': 0.5197167421945097, 'recall': 0.34425699185615677, 'f1-score': 0.4141702814189288, 'support': 531690}, '1': {'precision': 0.5065249229188078, 'recall': 0.634254120538831, 'f1-score': 0.5632388171212006, 'support': 621642}, '2': {'precision': 0.4825094785034695, 'recall': 0.5035152563849804, 'f1-score': 0.4927886191502953, 'support': 522437}, 'accuracy': 0.5014843931353307, 'macro avg': {'precision': 0.5029170478722623, 'recall': 0.49400878959332273, 'f1-score': 0.4900659058968082, 'support': 1675769}, 'weighted avg': {'precision': 0.5032233948780587, 'recall': 0.5014843931353307, 'f1-score': 0.49397865069917773, 'support': 1675769}}
[[183038 211753 136899]
 [ 82136 394279 145227]
 [ 87014 172368 263055]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9785512
{'0': {'precision': 0.5322974238566962, 'recall': 0.3853587730858114, 'f1-score': 0.4470639066299597, 'support': 104718}, '1': {'precision': 0.48622342540973884, 'recall': 0.6505811510992858, 'f1-score': 0.5565209752513597, 'support': 107115}, '2': {'precision': 0.5058869045129449, 'recall': 0.47000592595471014, 'f1-score': 0.48728679125560875, 'support': 102937}, 'accuracy': 0.5032944689773485, 'macro avg': {'precision': 0.50813591792646, 'recall': 0.5019819500466025, 'f1-score': 0.496957224378976, 'support': 314770}, 'weighted avg': {'precision': 0.5079817775964631, 'recall': 0.5032944689773485, 'f1-score': 0.4974655236204343, 'support': 314770}}
[[40354 39863 24501]
 [14674 69687 22754]
 [20783 33773 48381]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94808894
{'0': {'precision': 0.5347795133799573, 'recall': 0.37806791603754036, 'f1-score': 0.4429721104481754, 'support': 33777}, '1': {'precision': 0.5477479335292399, 'recall': 0.6819572519737265, 'f1-score': 0.6075288287429714, 'support': 46739}, '2': {'precision': 0.49320877439102156, 'recall': 0.46992526884986935, 'f1-score': 0.48128558538937805, 'support': 32918}, 'accuracy': 0.5299381137930427, 'macro avg': {'precision': 0.525245407100073, 'recall': 0.5099834789537121, 'f1-score': 0.5105955081935083, 'support': 113434}, 'weighted avg': {'precision': 0.5280593536687554, 'recall': 0.5299381137930427, 'f1-score': 0.521893945387391, 'support': 113434}}
[[12770 14094  6913]
 [ 5883 31874  8982]
 [ 5226 12223 15469]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
7633/7633 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99910533
{'0': {'precision': 0.5023765702339046, 'recall': 0.4246569755849994, 'f1-score': 0.4602588889743812, 'support': 662052}, '1': {'precision': 0.47685002436382934, 'recall': 0.5258241188803942, 'f1-score': 0.5001410390177619, 'support': 627185}, '2': {'precision': 0.4849329571019368, 'recall': 0.5126596274394473, 'f1-score': 0.49841098054127575, 'support': 664751}, 'accuracy': 0.4870679860879391, 'macro avg': {'precision': 0.4880531838998902, 'recall': 0.4877135739682803, 'f1-score': 0.486270302844473, 'support': 1953988}, 'weighted avg': {'precision': 0.48824878339764355, 'recall': 0.4870679860879391, 'f1-score': 0.4860395628045902, 'support': 1953988}}
[[281145 193404 187503]
 [122931 329789 174465]
 [155554 168406 340791]]
Evaluating performance on  train set...
1586/1586 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97992224
{'0': {'precision': 0.5135939634659404, 'recall': 0.4272778593203116, 'f1-score': 0.46647656770015855, 'support': 132855}, '1': {'precision': 0.5050489307955557, 'recall': 0.5727646976514689, 'f1-score': 0.5367796259231141, 'support': 135787}, '2': {'precision': 0.5009836529615739, 'recall': 0.516036388022276, 'f1-score': 0.5083986240475695, 'support': 137188}, 'accuracy': 0.5059606239065618, 'macro avg': {'precision': 0.50654218240769, 'recall': 0.5053596483313522, 'f1-score': 0.5038849392236141, 'support': 405830}, 'weighted avg': {'precision': 0.5064720463363872, 'recall': 0.5059606239065618, 'f1-score': 0.5041707855576582, 'support': 405830}}
[[56766 40127 35962]
 [23459 77774 34554]
 [30302 36092 70794]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9701983
{'0': {'precision': 0.4920010559662091, 'recall': 0.41455168271904264, 'f1-score': 0.4499680094643698, 'support': 44957}, '1': {'precision': 0.5483039488607073, 'recall': 0.5817850305406145, 'f1-score': 0.5645485186528544, 'support': 54845}, '2': {'precision': 0.4898919312611956, 'recall': 0.5286894822934591, 'f1-score': 0.5085518115127614, 'support': 47073}, 'accuracy': 0.5135795744680851, 'macro avg': {'precision': 0.510065645362704, 'recall': 0.5083420651843721, 'f1-score': 0.5076894465433285, 'support': 146875}, 'weighted avg': {'precision': 0.5123493067478918, 'recall': 0.5135795744680851, 'f1-score': 0.5115297683768217, 'support': 146875}}
[[18637 14493 11827]
 [ 8850 31908 14087]
 [10393 11793 24887]]
testing model on single stock: results/universal/W10/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
22048/22048 - 175s - 175s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1719186
{'0': {'precision': 0.4101348476190395, 'recall': 0.6771706723997887, 'f1-score': 0.5108615479703636, 'support': 2133567}, '1': {'precision': 0.20934420293400927, 'recall': 0.016229524365909728, 'f1-score': 0.030123692887887788, 'support': 1318030}, '2': {'precision': 0.44242535299157576, 'recall': 0.40745442014968497, 'f1-score': 0.4242203929537204, 'support': 2192471}, 'accuracy': 0.41805166061075094, 'macro avg': {'precision': 0.35396813451487485, 'recall': 0.3669515389717945, 'f1-score': 0.32173521127065724, 'support': 5644068}, 'weighted avg': {'precision': 0.37578868155414086, 'recall': 0.41805166061075094, 'f1-score': 0.3649410638594616, 'support': 5644068}}
[[1444789   41578  647200]
 [ 818001   21391  478638]
 [1259927   39212  893332]]
Evaluating performance on  train set...
5429/5429 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3113426
{'0': {'precision': 0.3722505742844726, 'recall': 0.6552243405509014, 'f1-score': 0.4747709818187002, 'support': 457541}, '1': {'precision': 0.3409323116219668, 'recall': 0.023230820105820105, 'f1-score': 0.04349774323377491, 'support': 459648}, '2': {'precision': 0.40197531846270107, 'recall': 0.47046065758653594, 'f1-score': 0.43352997319965325, 'support': 472607}, 'accuracy': 0.3833749701395025, 'macro avg': {'precision': 0.3717194014563801, 'recall': 0.38297193941441915, 'f1-score': 0.3172662327507095, 'support': 1389796}, 'weighted avg': {'precision': 0.37200071414351993, 'recall': 0.3833749701395025, 'f1-score': 0.31811153616660043, 'support': 1389796}}
[[299792  10881 146868]
 [265055  10678 183915]
 [240503   9761 222343]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3328696
{'0': {'precision': 0.3639114532626142, 'recall': 0.6267706849669817, 'f1-score': 0.4604686448396985, 'support': 154460}, '1': {'precision': 0.3353917662682603, 'recall': 0.030125727645767725, 'f1-score': 0.055285567303693, 'support': 167664}, '2': {'precision': 0.39435180523057783, 'recall': 0.4945246776400092, 'f1-score': 0.4387936976993911, 'support': 161543}, 'accuracy': 0.37577300084562315, 'macro avg': {'precision': 0.36455167492048407, 'recall': 0.3838070300842529, 'f1-score': 0.3181826366142609, 'support': 483667}, 'weighted avg': {'precision': 0.3641920202182663, 'recall': 0.37577300084562315, 'f1-score': 0.31277187930083916, 'support': 483667}}
[[96811  5298 52351]
 [92273  5051 70340]
 [76945  4711 79887]]
training model: results/universal/W10/deepVOL_L2/h100
Epoch 1/50
8543/8543 - 280s - loss: 3.1747 - accuracy100: 0.4196 - val_loss: 3.2633 - val_accuracy100: 0.3827 - 280s/epoch - 33ms/step
Epoch 2/50
8543/8543 - 273s - loss: 3.1375 - accuracy100: 0.4330 - val_loss: 3.3738 - val_accuracy100: 0.3855 - 273s/epoch - 32ms/step
Epoch 3/50
8543/8543 - 276s - loss: 3.1275 - accuracy100: 0.4359 - val_loss: 3.3466 - val_accuracy100: 0.3930 - 276s/epoch - 32ms/step
Epoch 4/50
8543/8543 - 268s - loss: 3.1204 - accuracy100: 0.4383 - val_loss: 3.3725 - val_accuracy100: 0.3934 - 268s/epoch - 31ms/step
Epoch 5/50
8543/8543 - 274s - loss: 3.1152 - accuracy100: 0.4411 - val_loss: 3.3567 - val_accuracy100: 0.3978 - 274s/epoch - 32ms/step
Epoch 6/50
8543/8543 - 271s - loss: 3.1106 - accuracy100: 0.4433 - val_loss: 3.3978 - val_accuracy100: 0.4015 - 271s/epoch - 32ms/step
Epoch 7/50
8543/8543 - 267s - loss: 3.1073 - accuracy100: 0.4447 - val_loss: 3.3709 - val_accuracy100: 0.4053 - 267s/epoch - 31ms/step
Epoch 8/50
8543/8543 - 272s - loss: 3.1048 - accuracy100: 0.4457 - val_loss: 3.3460 - val_accuracy100: 0.4064 - 272s/epoch - 32ms/step
Epoch 9/50
8543/8543 - 274s - loss: 3.1024 - accuracy100: 0.4465 - val_loss: 3.3519 - val_accuracy100: 0.4068 - 274s/epoch - 32ms/step
Epoch 10/50
8543/8543 - 270s - loss: 3.1004 - accuracy100: 0.4473 - val_loss: 3.3319 - val_accuracy100: 0.4075 - 270s/epoch - 32ms/step
Epoch 11/50
8543/8543 - 268s - loss: 3.0981 - accuracy100: 0.4480 - val_loss: 3.3495 - val_accuracy100: 0.4064 - 268s/epoch - 31ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 587s - 587s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0731132
{'0': {'precision': 0.39855863469042546, 'recall': 0.4276337497301632, 'f1-score': 0.4125845908384378, 'support': 3330717}, '1': {'precision': 0.5011748104493376, 'recall': 0.20961108619764876, 'f1-score': 0.2955933619075749, 'support': 2843175}, '2': {'precision': 0.39849378645616396, 'recall': 0.5652804023981821, 'f1-score': 0.4674554072233179, 'support': 3371387}, 'accuracy': 0.41130982132633315, 'macro avg': {'precision': 0.4327424105319757, 'recall': 0.4008417461086647, 'f1-score': 0.39187778665644357, 'support': 9545279}, 'weighted avg': {'precision': 0.42910118007012393, 'recall': 0.41130982132633315, 'f1-score': 0.3971177008422277, 'support': 9545279}}
[[1424327  322852 1583538]
 [ 954075  595961 1293139]
 [1195293  270315 1905779]]
Evaluating performance on  train set...
8543/8543 - 142s - 142s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904989
{'0': {'precision': 0.3597535057301783, 'recall': 0.5127053920019942, 'f1-score': 0.42282235337143514, 'support': 690022}, '1': {'precision': 0.5785140000373086, 'recall': 0.19473423126432451, 'f1-score': 0.2913850287980006, 'support': 796275}, '2': {'precision': 0.3734821633816069, 'recall': 0.4987214868729325, 'f1-score': 0.427110296518104, 'support': 700423}, 'accuracy': 0.3924398185410112, 'macro avg': {'precision': 0.4372498897163646, 'recall': 0.40205370337975044, 'f1-score': 0.38043922622917986, 'support': 2186720}, 'weighted avg': {'precision': 0.4438106233230099, 'recall': 0.3924398185410112, 'f1-score': 0.37633405966117855, 'support': 2186720}}
[[353778  63063 273181]
 [328415 155062 312798]
 [301197  49910 349316]]
Evaluating performance on  val set...
3077/3077 - 47s - 47s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994507
{'0': {'precision': 0.3461147029763194, 'recall': 0.4951188455008489, 'f1-score': 0.40742053727819333, 'support': 235600}, '1': {'precision': 0.5734308869023895, 'recall': 0.1961393395264897, 'f1-score': 0.29229913413631303, 'support': 308082}, '2': {'precision': 0.3587644904190539, 'recall': 0.5081291287958202, 'f1-score': 0.42057914355077164, 'support': 243261}, 'accuracy': 0.38209247683758546, 'macro avg': {'precision': 0.4261033600992543, 'recall': 0.39979577127438626, 'f1-score': 0.37343293832175933, 'support': 786943}, 'weighted avg': {'precision': 0.43901752378979453, 'recall': 0.38209247683758546, 'f1-score': 0.366419020774097, 'support': 786943}}
[[116650  25049  93901]
 [120626  60427 127029]
 [ 99751  19902 123608]]
testing model out of sample: results/universal/W10/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 335s - 335s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0612127
{'0': {'precision': 0.42904570610193316, 'recall': 0.47776472562510486, 'f1-score': 0.45209648430273475, 'support': 1787700}, '1': {'precision': 0.5139414639520883, 'recall': 0.2428656053510284, 'f1-score': 0.3298560751359082, 'support': 1882255}, '2': {'precision': 0.3975016982267529, 'recall': 0.5728058948741487, 'f1-score': 0.46931780723082844, 'support': 1790844}, 'accuracy': 0.42796685979469307, 'macro avg': {'precision': 0.4468296227602581, 'recall': 0.4311454086167606, 'f1-score': 0.4170901222231571, 'support': 5460799}, 'weighted avg': {'precision': 0.4479632797853858, 'recall': 0.42796685979469307, 'f1-score': 0.41560971404833313, 'support': 5460799}}
[[ 854100  235794  697806]
 [ 568099  457135  857021]
 [ 568498  196540 1025806]]
Evaluating performance on  train set...
4055/4055 - 63s - 63s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0621127
{'0': {'precision': 0.40620632611733837, 'recall': 0.4925068612441094, 'f1-score': 0.4452130123536082, 'support': 318091}, '1': {'precision': 0.5751177824658247, 'recall': 0.254914101924528, 'f1-score': 0.35325301539658716, 'support': 398903}, '2': {'precision': 0.3818863157894737, 'recall': 0.5660028831212596, 'f1-score': 0.4560633373811733, 'support': 320486}, 'accuracy': 0.4238578093071674, 'macro avg': {'precision': 0.4544034747908789, 'recall': 0.43780794876329904, 'f1-score': 0.4181764550437896, 'support': 1037480}, 'weighted avg': {'precision': 0.46363882008526464, 'recall': 0.4238578093071674, 'f1-score': 0.4132068614886639, 'support': 1037480}}
[[156662  41891 119538]
 [123151 101686 174066]
 [105858  33232 181396]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0649819
{'0': {'precision': 0.3972528691024006, 'recall': 0.47505076036961835, 'f1-score': 0.4326825457331456, 'support': 120665}, '1': {'precision': 0.564927857935627, 'recall': 0.23981961365013124, 'f1-score': 0.3367038367038367, 'support': 148570}, '2': {'precision': 0.38690619017910943, 'recall': 0.57738521524628, 'f1-score': 0.46333279056476667, 'support': 125670}, 'accuracy': 0.4191185221762196, 'macro avg': {'precision': 0.449695639072379, 'recall': 0.4307518630886766, 'f1-score': 0.41090639100058296, 'support': 394905}, 'weighted avg': {'precision': 0.4570424538143249, 'recall': 0.4191185221762196, 'f1-score': 0.4063274969682665, 'support': 394905}}
[[57322 15186 48157]
 [46118 35630 66822]
 [40856 12254 72560]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.076099
{'0': {'precision': 0.4456554941545639, 'recall': 0.5806574162852542, 'f1-score': 0.5042773313223199, 'support': 55277}, '1': {'precision': 0.24620119253702635, 'recall': 0.046643830624590044, 'f1-score': 0.07842896970068318, 'support': 27442}, '2': {'precision': 0.42022784307353445, 'recall': 0.4665370507706801, 'f1-score': 0.4421732522796352, 'support': 49891}, 'accuracy': 0.4272151421461428, 'macro avg': {'precision': 0.3706948432550416, 'recall': 0.3646127658935081, 'f1-score': 0.3416265177675461, 'support': 132610}, 'weighted avg': {'precision': 0.3948144121466301, 'recall': 0.4272151421461428, 'f1-score': 0.3927882630232509, 'support': 132610}}
[[32097  2070 21110]
 [15159  1280 11003]
 [24766  1849 23276]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1219399
{'0': {'precision': 0.3739307803658376, 'recall': 0.4969829470922606, 'f1-score': 0.426763789283971, 'support': 11435}, '1': {'precision': 0.37575452716297786, 'recall': 0.06608864903123064, 'f1-score': 0.11240689188172447, 'support': 11303}, '2': {'precision': 0.3668670128960728, 'recall': 0.5426845058264997, 'f1-score': 0.4377828842002646, 'support': 11585}, 'accuracy': 0.37050957084170966, 'macro avg': {'precision': 0.3721841068082961, 'recall': 0.3685853673166637, 'f1-score': 0.32565118845532, 'support': 34323}, 'weighted avg': {'precision': 0.37214713860698356, 'recall': 0.37050957084170966, 'f1-score': 0.3269613303866622, 'support': 34323}}
[[5683  660 5092]
 [4798  747 5758]
 [4717  581 6287]]
Evaluating performance on  val set...
46/46 - 1s - 528ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115013
{'0': {'precision': 0.38869005010737295, 'recall': 0.4993103448275862, 'f1-score': 0.43711008251157174, 'support': 4350}, '1': {'precision': 0.3559027777777778, 'recall': 0.061970979443772674, 'f1-score': 0.10556127703398557, 'support': 3308}, '2': {'precision': 0.366618339978253, 'recall': 0.5027335984095428, 'f1-score': 0.4240201215678055, 'support': 4024}, 'accuracy': 0.3766478342749529, 'macro avg': {'precision': 0.3704037226211346, 'recall': 0.3546716408936339, 'f1-score': 0.3222304937044543, 'support': 11682}, 'weighted avg': {'precision': 0.37180279977131064, 'recall': 0.3766478342749529, 'f1-score': 0.33871619008240117, 'support': 11682}}
[[2172  233 1945]
 [1553  205 1550]
 [1863  138 2023]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9846782
{'0': {'precision': 0.4804886036948532, 'recall': 0.3298030889638233, 'f1-score': 0.39113476577928746, 'support': 120105}, '1': {'precision': 0.6026918244351215, 'recall': 0.6178576730619766, 'f1-score': 0.6101805276763826, 'support': 229022}, '2': {'precision': 0.4038102547758272, 'recall': 0.5095453053184504, 'f1-score': 0.45055754527674063, 'support': 121840}, 'accuracy': 0.516378005253022, 'macro avg': {'precision': 0.4956635609686006, 'recall': 0.4857353557814168, 'f1-score': 0.48395761291080364, 'support': 470967}, 'weighted avg': {'precision': 0.5200768041167163, 'recall': 0.516378005253022, 'f1-score': 0.5130251953320295, 'support': 470967}}
[[ 39611  48721  31773]
 [ 27632 141503  59887]
 [ 15196  44561  62083]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93115
{'0': {'precision': 0.4376951331496786, 'recall': 0.3661468735596866, 'f1-score': 0.39873682449389325, 'support': 26036}, '1': {'precision': 0.7128055296297799, 'recall': 0.6338192489956941, 'f1-score': 0.6709959190429805, 'support': 83142}, '2': {'precision': 0.36367529980852564, 'recall': 0.5504709606071007, 'f1-score': 0.43798831828870516, 'support': 26223}, 'accuracy': 0.5662070442611207, 'macro avg': {'precision': 0.5047253208626614, 'recall': 0.5168123610541605, 'f1-score': 0.502573687275193, 'support': 135401}, 'weighted avg': {'precision': 0.5922893126198711, 'recall': 0.5662070442611207, 'f1-score': 0.5735173472432198, 'support': 135401}}
[[ 9533 11577  4926]
 [10114 52697 20331]
 [ 2133  9655 14435]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9628898
{'0': {'precision': 0.4903448275862069, 'recall': 0.34520148891406377, 'f1-score': 0.4051666824959635, 'support': 12358}, '1': {'precision': 0.6551752043376224, 'recall': 0.5771520228123329, 'f1-score': 0.6136936458905796, 'support': 28055}, '2': {'precision': 0.382753711612772, 'recall': 0.5942063304128187, 'f1-score': 0.4655966849120203, 'support': 12669}, 'accuracy': 0.5272220338344448, 'macro avg': {'precision': 0.509424581178867, 'recall': 0.5055199473797384, 'f1-score': 0.4948190044328545, 'support': 53082}, 'weighted avg': {'precision': 0.5517826854569261, 'recall': 0.5272220338344448, 'f1-score': 0.52980048790354, 'support': 53082}}
[[ 4266  4671  3421]
 [ 3144 16192  8719]
 [ 1290  3851  7528]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1179557
{'0': {'precision': 0.38040874058251306, 'recall': 0.5747462302517526, 'f1-score': 0.4578073637907151, 'support': 91717}, '1': {'precision': 0.3381746162733124, 'recall': 0.02824765292195707, 'f1-score': 0.052140058018219755, 'support': 72537}, '2': {'precision': 0.34752400202122286, 'recall': 0.4294050549318605, 'f1-score': 0.3841497800669198, 'support': 83285}, 'accuracy': 0.3657039900783311, 'macro avg': {'precision': 0.3553691196256828, 'recall': 0.34413297936852344, 'f1-score': 0.2980324006252849, 'support': 247539}, 'weighted avg': {'precision': 0.3569686276059981, 'recall': 0.3657039900783311, 'f1-score': 0.31415136930396437, 'support': 247539}}
[[52714  2256 36747]
 [40090  2049 30398]
 [45768  1754 35763]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1323681
{'0': {'precision': 0.3439205786026201, 'recall': 0.5506937616082159, 'f1-score': 0.42341131504893115, 'support': 18306}, '1': {'precision': 0.33519850786037836, 'recall': 0.06853344955327959, 'f1-score': 0.11379981003211362, 'support': 18356}, '2': {'precision': 0.36280172413793105, 'recall': 0.4293730551446207, 'f1-score': 0.3932901899399575, 'support': 19603}, 'accuracy': 0.3511241446725318, 'macro avg': {'precision': 0.3473069368669765, 'recall': 0.34953342210203875, 'f1-score': 0.31016710500700073, 'support': 56265}, 'weighted avg': {'precision': 0.34765335680192894, 'recall': 0.3511241446725318, 'f1-score': 0.3119087254888154, 'support': 56265}}
[[10081  1168  7057]
 [ 9372  1258  7726]
 [ 9859  1327  8417]]
Evaluating performance on  val set...
79/79 - 1s - 727ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.130685
{'0': {'precision': 0.3575092234320166, 'recall': 0.5780590717299579, 'f1-score': 0.4417880573779607, 'support': 6873}, '1': {'precision': 0.44039735099337746, 'recall': 0.041355721393034825, 'f1-score': 0.07561114269471289, 'support': 6432}, '2': {'precision': 0.3503131021194605, 'recall': 0.43314472900536033, 'f1-score': 0.3873501997336884, 'support': 6716}, 'accuracy': 0.3570251236201988, 'macro avg': {'precision': 0.38273989218161814, 'recall': 0.3508531740427843, 'f1-score': 0.30158313326878733, 'support': 20021}, 'weighted avg': {'precision': 0.3817241620334624, 'recall': 0.3570251236201988, 'f1-score': 0.3058880240538719, 'support': 20021}}
[[3973  182 2718]
 [3489  266 2677]
 [3651  156 2909]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1178533
{'0': {'precision': 0.3481391674932951, 'recall': 0.1290225952930444, 'f1-score': 0.18827082308880577, 'support': 146889}, '1': {'precision': 0.2746867167919799, 'recall': 0.014318437165228145, 'f1-score': 0.027218092415688486, 'support': 114817}, '2': {'precision': 0.3583210693251374, 'recall': 0.8571724996541707, 'f1-score': 0.5053798300719962, 'support': 144580}, 'accuracy': 0.3557247850036674, 'macro avg': {'precision': 0.32704898453680414, 'recall': 0.3335045107041477, 'f1-score': 0.24028958185883012, 'support': 406286}, 'weighted avg': {'precision': 0.3310047088475994, 'recall': 0.3557247850036674, 'f1-score': 0.25560277361610517, 'support': 406286}}
[[ 18952   2243 125694]
 [ 16934   1644  96239]
 [ 18552   2098 123930]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1361614
{'0': {'precision': 0.3532386485904885, 'recall': 0.12756945793666213, 'f1-score': 0.1874446886865169, 'support': 25735}, '1': {'precision': 0.34352941176470586, 'recall': 0.011744359087801151, 'f1-score': 0.022712246723447287, 'support': 24863}, '2': {'precision': 0.33091543476264806, 'recall': 0.8687128394664952, 'f1-score': 0.4792659411777744, 'support': 24892}, 'accuracy': 0.33380580209299243, 'macro avg': {'precision': 0.3425611650392808, 'recall': 0.3360088854969862, 'f1-score': 0.2298076255292462, 'support': 75490}, 'weighted avg': {'precision': 0.3426800289878651, 'recall': 0.33380580209299243, 'f1-score': 0.2294141139413133, 'support': 75490}}
[[ 3283   326 22126]
 [ 2975   292 21596]
 [ 3036   232 21624]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1446322
{'0': {'precision': 0.3296522556390977, 'recall': 0.12828014994971199, 'f1-score': 0.1846903179095636, 'support': 10937}, '1': {'precision': 0.3181818181818182, 'recall': 0.008374636814219792, 'f1-score': 0.016319733555370527, 'support': 11702}, '2': {'precision': 0.3224730809308788, 'recall': 0.8664489034064395, 'f1-score': 0.4700164536134666, 'support': 10715}, 'accuracy': 0.3233495232955568, 'macro avg': {'precision': 0.3234357182505982, 'recall': 0.3343678967234571, 'f1-score': 0.22367550169280026, 'support': 33354}, 'weighted avg': {'precision': 0.323321623147533, 'recall': 0.3233495232955568, 'f1-score': 0.2172800212721154, 'support': 33354}}
[[ 1403   105  9429]
 [ 1527    98 10077]
 [ 1326   105  9284]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
2104/2104 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0901874
{'0': {'precision': 0.4027091430773202, 'recall': 0.5166636270265601, 'f1-score': 0.4526241656593262, 'support': 208358}, '1': {'precision': 0.23799765807962528, 'recall': 0.03939557910209092, 'f1-score': 0.06760118350575468, 'support': 123821}, '2': {'precision': 0.40516773812752244, 'recall': 0.4922667674506498, 'f1-score': 0.44449062629886466, 'support': 206382}, 'accuracy': 0.39758541743646497, 'macro avg': {'precision': 0.348624846428156, 'recall': 0.3494419911931003, 'f1-score': 0.3215719918213152, 'support': 538561}, 'weighted avg': {'precision': 0.36578234923177855, 'recall': 0.39758541743646497, 'f1-score': 0.3609863627112328, 'support': 538561}}
[[107651   7971  92736]
 [ 62526   4878  56417]
 [ 97140   7647 101595]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1243
{'0': {'precision': 0.35450390575210766, 'recall': 0.5355688820422535, 'f1-score': 0.4266196272638626, 'support': 36352}, '1': {'precision': 0.38170005414185165, 'recall': 0.03864072348588654, 'f1-score': 0.07017718494923353, 'support': 36490}, '2': {'precision': 0.36577504372948644, 'recall': 0.5077758376077703, 'f1-score': 0.4252339117818423, 'support': 36652}, 'accuracy': 0.3606590315451075, 'macro avg': {'precision': 0.3673263345411486, 'recall': 0.3606618143786368, 'f1-score': 0.30734357466497947, 'support': 109494}, 'weighted avg': {'precision': 0.36734020001379, 'recall': 0.3606590315451075, 'f1-score': 0.3073676685820369, 'support': 109494}}
[[19469  1113 15770]
 [18580  1410 16500]
 [16870  1171 18611]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1134247
{'0': {'precision': 0.36715838101737625, 'recall': 0.5775869188207119, 'f1-score': 0.4489376725078632, 'support': 12109}, '1': {'precision': 0.3617407071622847, 'recall': 0.03541315345699832, 'f1-score': 0.06451091350040421, 'support': 11267}, '2': {'precision': 0.3843664742084893, 'recall': 0.4832096992901013, 'f1-score': 0.4281574669587957, 'support': 12537}, 'accuracy': 0.374544036978253, 'macro avg': {'precision': 0.3710885207960501, 'recall': 0.3654032571892705, 'f1-score': 0.3138686843223544, 'support': 35913}, 'weighted avg': {'precision': 0.37146592795056665, 'recall': 0.374544036978253, 'f1-score': 0.32107707242695377, 'support': 35913}}
[[6994  310 4805]
 [5970  399 4898]
 [6085  394 6058]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
5267/5267 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0106447
{'0': {'precision': 0.5254957399714988, 'recall': 0.340705192000059, 'f1-score': 0.41338936584769553, 'support': 406953}, '1': {'precision': 0.49202201406270374, 'recall': 0.5107336878824269, 'f1-score': 0.5012032687007036, 'support': 524610}, '2': {'precision': 0.4531123791174182, 'recall': 0.5870516962455535, 'f1-score': 0.5114585228449006, 'support': 416626}, 'accuracy': 0.48299459497147657, 'macro avg': {'precision': 0.49021004438387356, 'recall': 0.47949685870934644, 'f1-score': 0.4753503857977666, 'support': 1348189}, 'weighted avg': {'precision': 0.49010200700957346, 'recall': 0.48299459497147657, 'f1-score': 0.4778656463831651, 'support': 1348189}}
[[138651 154026 114276]
 [ 75751 267936 180923]
 [ 49446 122599 244581]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9706368
{'0': {'precision': 0.5085957190685777, 'recall': 0.38011695906432746, 'f1-score': 0.43506942768418855, 'support': 71136}, '1': {'precision': 0.5861587114804736, 'recall': 0.5595076519867085, 'f1-score': 0.5725231966477103, 'support': 128202}, '2': {'precision': 0.45116167314362127, 'recall': 0.6004449078901634, 'f1-score': 0.5152073677743381, 'support': 71925}, 'accuracy': 0.5233186980900455, 'macro avg': {'precision': 0.5153053678975575, 'recall': 0.5133565063137331, 'f1-score': 0.5075999973687456, 'support': 271263}, 'weighted avg': {'precision': 0.5300243215688721, 'recall': 0.5233186980900455, 'f1-score': 0.5212801141015969, 'support': 271263}}
[[27040 29036 15060]
 [18995 71730 37477]
 [ 7131 21607 43187]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9765305
{'0': {'precision': 0.5106111111111111, 'recall': 0.3597964376590331, 'f1-score': 0.42213801814215185, 'support': 25545}, '1': {'precision': 0.609261971830986, 'recall': 0.5279643805655366, 'f1-score': 0.5657072910454787, 'support': 51208}, '2': {'precision': 0.40917842606809485, 'recall': 0.6299103290436349, 'f1-score': 0.49609952130488744, 'support': 26653}, 'accuracy': 0.5126975223874823, 'macro avg': {'precision': 0.5096838363367306, 'recall': 0.5058903824227349, 'f1-score': 0.49464827683083934, 'support': 103406}, 'weighted avg': {'precision': 0.5333199280201091, 'recall': 0.5126975223874823, 'f1-score': 0.5122990462317206, 'support': 103406}}
[[ 9191 10045  6309]
 [ 6239 27036 17933]
 [ 2570  7294 16789]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
10110/10110 - 88s - 88s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0326674
{'0': {'precision': 0.47270393862034776, 'recall': 0.3923833673479853, 'f1-score': 0.4288148997560185, 'support': 780056}, '1': {'precision': 0.5391588800585243, 'recall': 0.38349699225001777, 'f1-score': 0.44819702567977227, 'support': 1014712}, '2': {'precision': 0.4027557394830158, 'recall': 0.6187742095689956, 'f1-score': 0.4879247340310541, 'support': 793333}, 'accuracy': 0.45829509744789715, 'macro avg': {'precision': 0.47153951938729594, 'recall': 0.46488485638899957, 'f1-score': 0.4549788864889483, 'support': 2588101}, 'weighted avg': {'precision': 0.47731751895218105, 'recall': 0.45829509744789715, 'f1-score': 0.45453300655141055, 'support': 2588101}}
[[306081 182858 291117]
 [188746 389139 436827]
 [152684 149755 490894]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0232178
{'0': {'precision': 0.441707657628882, 'recall': 0.4105084602010093, 'f1-score': 0.4255369655621104, 'support': 117905}, '1': {'precision': 0.6192059533705419, 'recall': 0.3970929435596464, 'f1-score': 0.483877952512342, 'support': 196969}, '2': {'precision': 0.3738884686931458, 'recall': 0.6269474008946475, 'f1-score': 0.46842526491020264, 'support': 116694}, 'accuracy': 0.46290966892818747, 'macro avg': {'precision': 0.47826735989752317, 'recall': 0.47818293488510105, 'f1-score': 0.459280060994885, 'support': 431568}, 'weighted avg': {'precision': 0.5043804447221609, 'recall': 0.46290966892818747, 'f1-score': 0.4637607751650616, 'support': 431568}}
[[48401 27393 42111]
 [38350 78215 80404]
 [22826 20707 73161]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0349355
{'0': {'precision': 0.43112608007056796, 'recall': 0.409369527145359, 'f1-score': 0.41996621522658256, 'support': 52532}, '1': {'precision': 0.579675933353196, 'recall': 0.34861411657684727, 'f1-score': 0.4353880846229322, 'support': 72553}, '2': {'precision': 0.3984349827387802, 'recall': 0.6257839469356034, 'f1-score': 0.4868767972776297, 'support': 55329}, 'accuracy': 0.45130643963328787, 'macro avg': {'precision': 0.46974566538751467, 'recall': 0.4612558635526032, 'f1-score': 0.4474103657090482, 'support': 180414}, 'weighted avg': {'precision': 0.48083936053075416, 'recall': 0.45130643963328787, 'f1-score': 0.44668807985247494, 'support': 180414}}
[[21505 10068 20959]
 [15943 25293 31317]
 [12433  8272 34624]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
6546/6546 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0623736
{'0': {'precision': 0.43681905131546117, 'recall': 0.397661883472743, 'f1-score': 0.4163217622868057, 'support': 554720}, '1': {'precision': 0.47739912404327745, 'recall': 0.30591882457145836, 'f1-score': 0.37288914198133283, 'support': 575790}, '2': {'precision': 0.3971142681468234, 'recall': 0.5839591827003314, 'f1-score': 0.47274446834824724, 'support': 545259}, 'accuracy': 0.42675631307178974, 'macro avg': {'precision': 0.437110814501854, 'recall': 0.42917996358151095, 'f1-score': 0.42065179087212856, 'support': 1675769}, 'weighted avg': {'precision': 0.4378431839436463, 'recall': 0.42675631307178974, 'f1-score': 0.4197571521517974, 'support': 1675769}}
[[220591 105237 228892]
 [145139 176145 254506]
 [139264  87586 318409]]
Evaluating performance on  train set...
1230/1230 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.068541
{'0': {'precision': 0.438022335238295, 'recall': 0.3874378570898568, 'f1-score': 0.411180179249044, 'support': 107816}, '1': {'precision': 0.4495215908145436, 'recall': 0.26609010854790094, 'f1-score': 0.33429651583682407, 'support': 101522}, '2': {'precision': 0.3962086498022723, 'recall': 0.5986797177327566, 'f1-score': 0.47684160427888284, 'support': 105432}, 'accuracy': 0.4190551831496013, 'macro avg': {'precision': 0.42791752528503696, 'recall': 0.41740256112350477, 'f1-score': 0.4074394331215836, 'support': 314770}, 'weighted avg': {'precision': 0.42772569623750445, 'recall': 0.4190551831496013, 'f1-score': 0.40837632909436145, 'support': 314770}}
[[41772 18521 47523]
 [25841 27014 48667]
 [27752 14560 63120]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0516106
{'0': {'precision': 0.43968025481608525, 'recall': 0.3971011285682673, 'f1-score': 0.4173073848524047, 'support': 36152}, '1': {'precision': 0.49622902394569796, 'recall': 0.37558272286176386, 'f1-score': 0.4275580104513579, 'support': 42044}, '2': {'precision': 0.40105390004289126, 'recall': 0.5572393438901186, 'f1-score': 0.4664188410788727, 'support': 35238}, 'accuracy': 0.43887194315637285, 'macro avg': {'precision': 0.4456543929348915, 'recall': 0.4433077317733833, 'f1-score': 0.43709474546087845, 'support': 113434}, 'weighted avg': {'precision': 0.44864071605158456, 'recall': 0.43887194315637285, 'f1-score': 0.43636310709785725, 'support': 113434}}
[[14356  8831 12965]
 [ 9893 15791 16360]
 [ 8402  7200 19636]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
7633/7633 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0827718
{'0': {'precision': 0.4107891791023179, 'recall': 0.5440186296934502, 'f1-score': 0.4681087947740939, 'support': 652292}, '1': {'precision': 0.4418296418473139, 'recall': 0.09321111064508662, 'f1-score': 0.15394502732983475, 'support': 643743}, '2': {'precision': 0.39325581322242864, 'recall': 0.570400925294056, 'f1-score': 0.4655464353098644, 'support': 657953}, 'accuracy': 0.40438324083873595, 'macro avg': {'precision': 0.41529154472402013, 'recall': 0.4025435552108642, 'f1-score': 0.362533419137931, 'support': 1953988}, 'weighted avg': {'precision': 0.4151115955798404, 'recall': 0.40438324083873595, 'f1-score': 0.3637444699970544, 'support': 1953988}}
[[354859  40391 257042]
 [261745  60004 321994]
 [247243  35413 375297]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0718206
{'0': {'precision': 0.4133156318852042, 'recall': 0.5455989499824748, 'f1-score': 0.4703329765383169, 'support': 134093}, '1': {'precision': 0.4881183317167798, 'recall': 0.14824907022130573, 'f1-score': 0.22742550487219318, 'support': 135785}, '2': {'precision': 0.3980541635568824, 'recall': 0.5492158997293163, 'f1-score': 0.4615741255888135, 'support': 135952}, 'accuracy': 0.41386294753961017, 'macro avg': {'precision': 0.43316270905295545, 'recall': 0.41435463997769895, 'f1-score': 0.3864442023331079, 'support': 405830}, 'weighted avg': {'precision': 0.43323100890134025, 'recall': 0.41386294753961017, 'f1-score': 0.3861253665921042, 'support': 405830}}
[[73161 11660 49272]
 [52014 20130 63641]
 [51835  9450 74667]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0767081
{'0': {'precision': 0.3875412708038542, 'recall': 0.5135153233186759, 'f1-score': 0.44172226755628086, 'support': 44801}, '1': {'precision': 0.5518765097507806, 'recall': 0.17027813124886385, 'f1-score': 0.2602558937526916, 'support': 55010}, '2': {'precision': 0.379866171425331, 'recall': 0.5693311235764066, 'f1-score': 0.45568952908964133, 'support': 47064}, 'accuracy': 0.4028459574468085, 'macro avg': {'precision': 0.4397613173266553, 'recall': 0.4177081927146487, 'f1-score': 0.3858892301328713, 'support': 146875}, 'weighted avg': {'precision': 0.4466313856451792, 'recall': 0.4028459574468085, 'f1-score': 0.3782321567400809, 'support': 146875}}
[[23006  4316 17479]
 [19379  9367 26264]
 [16979  3290 26795]]
testing model on single stock: results/universal/W10/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
22048/22048 - 156s - 156s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953069
{'0': {'precision': 0.3772000091462055, 'recall': 0.47871553959230273, 'f1-score': 0.4219376693852162, 'support': 2102050}, '1': {'precision': 0.24223548246252366, 'recall': 0.005948806807459383, 'f1-score': 0.011612435995202649, 'support': 1398936}, '2': {'precision': 0.39327926470288316, 'recall': 0.5398785487442851, 'f1-score': 0.45506351791595, 'support': 2143082}, 'accuracy': 0.38475971586451474, 'macro avg': {'precision': 0.3375715854372041, 'recall': 0.34151429838134906, 'f1-score': 0.29620454109878963, 'support': 5644068}, 'weighted avg': {'precision': 0.349853143030516, 'recall': 0.38475971586451474, 'f1-score': 0.3328127100514963, 'support': 5644068}}
[[1006284   12825 1082941]
 [ 688619    8322  701995]
 [ 972870   13208 1157004]]
Evaluating performance on  train set...
5429/5429 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1320041
{'0': {'precision': 0.3388087103178308, 'recall': 0.5926509746374367, 'f1-score': 0.43114117686190223, 'support': 459299}, '1': {'precision': 0.32357617132703637, 'recall': 0.0075455897554443825, 'f1-score': 0.01474728230176946, 'support': 458546}, '2': {'precision': 0.36058594238545877, 'recall': 0.43984439062529795, 'f1-score': 0.3962910888197175, 'support': 471951}, 'accuracy': 0.34771218221954875, 'macro avg': {'precision': 0.3409902746767753, 'recall': 0.346680318339393, 'f1-score': 0.280726515994463, 'support': 1389796}, 'weighted avg': {'precision': 0.34117809879461175, 'recall': 0.34771218221954875, 'f1-score': 0.2819226666081904, 'support': 1389796}}
[[272204   3394 183701]
 [270684   3460 184402]
 [260527   3839 207585]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1486825
{'0': {'precision': 0.3196371300284065, 'recall': 0.579019706788484, 'f1-score': 0.4118951522436844, 'support': 150608}, '1': {'precision': 0.3566674317190728, 'recall': 0.008876297315976764, 'f1-score': 0.017321518140779132, 'support': 175073}, '2': {'precision': 0.34255757076785237, 'recall': 0.44771688630638157, 'f1-score': 0.38814062024139095, 'support': 157986}, 'accuracy': 0.32975580306285107, 'macro avg': {'precision': 0.33962071083844386, 'recall': 0.34520429680361414, 'f1-score': 0.27245243020861815, 'support': 483667}, 'weighted avg': {'precision': 0.34052777329857403, 'recall': 0.32975580306285107, 'f1-score': 0.26131205822194575, 'support': 483667}}
[[87205  1416 61987]
 [99754  1554 73765]
 [85866  1387 70733]]
training model: results/universal/W10/deepVOL_L2/h200
Epoch 1/50
8543/8543 - 282s - loss: 3.2528 - accuracy200: 0.3866 - val_loss: 3.2751 - val_accuracy200: 0.3698 - 282s/epoch - 33ms/step
Epoch 2/50
8543/8543 - 268s - loss: 3.2342 - accuracy200: 0.3953 - val_loss: 3.3304 - val_accuracy200: 0.3667 - 268s/epoch - 31ms/step
Epoch 3/50
8543/8543 - 267s - loss: 3.2249 - accuracy200: 0.3978 - val_loss: 3.3264 - val_accuracy200: 0.3674 - 267s/epoch - 31ms/step
Epoch 4/50
8543/8543 - 272s - loss: 3.2157 - accuracy200: 0.4024 - val_loss: 3.3295 - val_accuracy200: 0.3676 - 272s/epoch - 32ms/step
Epoch 5/50
8543/8543 - 274s - loss: 3.2102 - accuracy200: 0.4052 - val_loss: 3.3380 - val_accuracy200: 0.3676 - 274s/epoch - 32ms/step
Epoch 6/50
8543/8543 - 266s - loss: 3.2068 - accuracy200: 0.4074 - val_loss: 3.3286 - val_accuracy200: 0.3672 - 266s/epoch - 31ms/step
Epoch 7/50
8543/8543 - 270s - loss: 3.2038 - accuracy200: 0.4090 - val_loss: 3.3418 - val_accuracy200: 0.3640 - 270s/epoch - 32ms/step
Epoch 8/50
8543/8543 - 270s - loss: 3.2017 - accuracy200: 0.4100 - val_loss: 3.3323 - val_accuracy200: 0.3647 - 270s/epoch - 32ms/step
Epoch 9/50
8543/8543 - 271s - loss: 3.1991 - accuracy200: 0.4115 - val_loss: 3.3453 - val_accuracy200: 0.3666 - 271s/epoch - 32ms/step
Epoch 10/50
8543/8543 - 275s - loss: 3.1975 - accuracy200: 0.4124 - val_loss: 3.3453 - val_accuracy200: 0.3664 - 275s/epoch - 32ms/step
Epoch 11/50
8543/8543 - 273s - loss: 3.1951 - accuracy200: 0.4135 - val_loss: 3.3645 - val_accuracy200: 0.3674 - 273s/epoch - 32ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 568s - 568s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109215
{'0': {'precision': 0.4530439973268104, 'recall': 0.04059584015386122, 'f1-score': 0.07451465745556102, 'support': 3439983}, '1': {'precision': 0.28116287591460937, 'recall': 0.7008409505572577, 'f1-score': 0.4013231963165926, 'support': 2656042}, '2': {'precision': 0.3995452611881685, 'recall': 0.30307683922378575, 'f1-score': 0.34468860235610027, 'support': 3449254}, 'accuracy': 0.319163117180755, 'macro avg': {'precision': 0.3779173781431961, 'recall': 0.3481712099783016, 'f1-score': 0.27350881870941796, 'support': 9545279}, 'weighted avg': {'precision': 0.38588470244406675, 'recall': 0.31916311718075496, 'f1-score': 0.2630807292610574, 'support': 9545279}}
[[ 139649 2437023  863311]
 [  86832 1861463  707747]
 [  81765 2322100 1045389]]
Evaluating performance on  train set...
8543/8543 - 140s - 140s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942227
{'0': {'precision': 0.4234090258563114, 'recall': 0.04939326230379458, 'f1-score': 0.0884663784403384, 'support': 718762}, '1': {'precision': 0.3448332876214041, 'recall': 0.7160986710113509, 'f1-score': 0.4655051758538638, 'support': 742670}, '2': {'precision': 0.3804746657628812, 'recall': 0.2940845567553855, 'f1-score': 0.33174766485236334, 'support': 725288}, 'accuracy': 0.356983518694666, 'macro avg': {'precision': 0.3829056597468656, 'recall': 0.3531921633568437, 'f1-score': 0.2952397397155218, 'support': 2186720}, 'weighted avg': {'precision': 0.3824821492199051, 'recall': 0.356983518694666, 'f1-score': 0.2972102511512057, 'support': 2186720}}
[[ 35502 518190 165070]
 [ 28606 531825 182239]
 [ 19740 492252 213296]]
Evaluating performance on  val set...
3077/3077 - 47s - 47s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911634
{'0': {'precision': 0.41361642168636115, 'recall': 0.05226145292989456, 'f1-score': 0.09279768939788555, 'support': 247142}, '1': {'precision': 0.3660673088400083, 'recall': 0.7223860867853288, 'f1-score': 0.4859040024971269, 'support': 284449}, '2': {'precision': 0.3732644693996183, 'recall': 0.28415677182869137, 'f1-score': 0.3226717362060723, 'support': 255352}, 'accuracy': 0.36973198821261516, 'macro avg': {'precision': 0.38431606664199597, 'recall': 0.35293477051463823, 'f1-score': 0.30045780936702826, 'support': 786943}, 'weighted avg': {'precision': 0.38333563982496, 'recall': 0.36973198821261516, 'f1-score': 0.30948110262518436, 'support': 786943}}
[[ 12916 180401  53825]
 [ 10959 205482  68008]
 [  7352 175440  72560]]
testing model out of sample: results/universal/W10/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 340s - 340s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1060256
{'0': {'precision': 0.46175657612997834, 'recall': 0.0726052337186602, 'f1-score': 0.12548031507169957, 'support': 1960327}, '1': {'precision': 0.28546135520850596, 'recall': 0.746236737153947, 'f1-score': 0.4129536574145399, 'support': 1546331}, '2': {'precision': 0.4277192265047067, 'recall': 0.2430060062196126, 'f1-score': 0.3099282267764966, 'support': 1954141}, 'accuracy': 0.3243347722558549, 'macro avg': {'precision': 0.3916457192810637, 'recall': 0.3539493256974066, 'f1-score': 0.2827873997542454, 'support': 5460799}, 'weighted avg': {'precision': 0.3996549412416041, 'recall': 0.3243347722558549, 'f1-score': 0.27288844482799907, 'support': 5460799}}
[[ 142330 1489589  328408]
 [  85445 1153929  306957]
 [  80461 1398812  474868]]
Evaluating performance on  train set...
4055/4055 - 71s - 71s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942966
{'0': {'precision': 0.4283219892325352, 'recall': 0.07674703576777453, 'f1-score': 0.13017010111730196, 'support': 345199}, '1': {'precision': 0.3394597767863665, 'recall': 0.7338834954244087, 'f1-score': 0.46420177774226007, 'support': 348261}, '2': {'precision': 0.3981797446074822, 'recall': 0.2577786175222371, 'f1-score': 0.3129534739278959, 'support': 344020}, 'accuracy': 0.3573630335042603, 'macro avg': {'precision': 0.3886538368754613, 'recall': 0.35613638290480676, 'f1-score': 0.30244178426248597, 'support': 1037480}, 'weighted avg': {'precision': 0.38849782108989545, 'recall': 0.3573630335042603, 'f1-score': 0.30290725426472176, 'support': 1037480}}
[[ 26493 256602  62104]
 [ 20747 255583  71931]
 [ 14613 240726  88681]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0938525
{'0': {'precision': 0.4119272089454067, 'recall': 0.07268816205885312, 'f1-score': 0.12357111850672842, 'support': 129237}, '1': {'precision': 0.33653299104974677, 'recall': 0.7363894455577822, 'f1-score': 0.46195201859065327, 'support': 131736}, '2': {'precision': 0.409363072519084, 'recall': 0.25625690648986055, 'f1-score': 0.3152012196241941, 'support': 133932}, 'accuracy': 0.3563489953279903, 'macro avg': {'precision': 0.38594109083807915, 'recall': 0.3551115047021653, 'f1-score': 0.3002414522405253, 'support': 394905}, 'weighted avg': {'precision': 0.38590689365805175, 'recall': 0.3563489953279903, 'f1-score': 0.3014426292658232, 'support': 394905}}
[[ 9394 97121 22722]
 [ 7930 97009 26797]
 [ 5481 94130 34321]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134751
{'0': {'precision': 0.37485692483784816, 'recall': 0.037815368627677384, 'f1-score': 0.0687002884363255, 'support': 51963}, '1': {'precision': 0.27648434778280995, 'recall': 0.7544202721421005, 'f1-score': 0.4046647824946825, 'support': 36819}, '2': {'precision': 0.3591792736869494, 'recall': 0.22047549511727663, 'f1-score': 0.27323238749628875, 'support': 43828}, 'accuracy': 0.2971495362340698, 'macro avg': {'precision': 0.3368401821025358, 'recall': 0.33757037862901823, 'f1-score': 0.24886581947576558, 'support': 132610}, 'weighted avg': {'precision': 0.3423623919275771, 'recall': 0.2971495362340698, 'f1-score': 0.22957887635831264, 'support': 132610}}
[[ 1965 39813 10185]
 [ 1987 27777  7055]
 [ 1290 32875  9663]]
Evaluating performance on  train set...
135/135 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058118
{'0': {'precision': 0.37707948243992606, 'recall': 0.035245335176226675, 'f1-score': 0.0644651603728867, 'support': 11576}, '1': {'precision': 0.3333987364125103, 'recall': 0.7537260468417317, 'f1-score': 0.46230444837437074, 'support': 11272}, '2': {'precision': 0.3620778551172983, 'recall': 0.2447930283224401, 'f1-score': 0.2921021161545261, 'support': 11475}, 'accuracy': 0.34125804853888064, 'macro avg': {'precision': 0.3575186913232449, 'recall': 0.34458813678013284, 'f1-score': 0.2729572416339278, 'support': 34323}, 'weighted avg': {'precision': 0.3577189066526061, 'recall': 0.34125804853888064, 'f1-score': 0.2712238505208062, 'support': 34323}}
[[ 408 8667 2501]
 [ 328 8496 2448]
 [ 346 8320 2809]]
Evaluating performance on  val set...
46/46 - 1s - 512ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1170014
{'0': {'precision': 0.42661448140900193, 'recall': 0.049714937286202965, 'f1-score': 0.08905228758169934, 'support': 4385}, '1': {'precision': 0.2953972257250946, 'recall': 0.8231332357247437, 'f1-score': 0.434769159384425, 'support': 3415}, '2': {'precision': 0.3583081570996979, 'recall': 0.15275631117980423, 'f1-score': 0.21419541267834566, 'support': 3882}, 'accuracy': 0.3100496490326999, 'macro avg': {'precision': 0.36010662141126487, 'recall': 0.341868161396917, 'f1-score': 0.24600561988148997, 'support': 11682}, 'weighted avg': {'precision': 0.3655571214424498, 'recall': 0.3100496490326999, 'f1-score': 0.23170155387441368, 'support': 11682}}
[[ 218 3575  592]
 [ 134 2811  470]
 [ 159 3130  593]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
1840/1840 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0868915
{'0': {'precision': 0.48414115062474256, 'recall': 0.09181155976799744, 'f1-score': 0.15435209656855503, 'support': 153619}, '1': {'precision': 0.3438433775263756, 'recall': 0.7194609531740924, 'f1-score': 0.46530777124693723, 'support': 158502}, '2': {'precision': 0.43005336527989546, 'recall': 0.29830779497123, 'f1-score': 0.3522655465933167, 'support': 158846}, 'accuracy': 0.37269065560856707, 'macro avg': {'precision': 0.41934596447700456, 'recall': 0.3698601026377733, 'f1-score': 0.32397513813626966, 'support': 470967}, 'weighted avg': {'precision': 0.4186819868563152, 'recall': 0.37269065560856707, 'f1-score': 0.325754458582255, 'support': 470967}}
[[ 14104 113262  26253]
 [  7920 114036  36546]
 [  7108 104353  47385]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0324376
{'0': {'precision': 0.4396161023727006, 'recall': 0.13871908474005945, 'f1-score': 0.21089203879356286, 'support': 35662}, '1': {'precision': 0.4896680566450601, 'recall': 0.7422978829935379, 'f1-score': 0.5900805373301409, 'support': 63911}, '2': {'precision': 0.3966769366197183, 'recall': 0.30185888132187116, 'f1-score': 0.34283268877195205, 'support': 35828}, 'accuracy': 0.46678384945458307, 'macro avg': {'precision': 0.44198703187915966, 'recall': 0.3942919496851562, 'f1-score': 0.3812684216318853, 'support': 135401}, 'weighted avg': {'precision': 0.4518792763441109, 'recall': 0.46678384945458307, 'f1-score': 0.42478621784243964, 'support': 135401}}
[[ 4947 25988  4727]
 [ 4748 47441 11722]
 [ 1558 23455 10815]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0563108
{'0': {'precision': 0.4745914483993732, 'recall': 0.13390601313794845, 'f1-score': 0.20887728459530022, 'support': 15832}, '1': {'precision': 0.42086713286713284, 'recall': 0.7039723015018949, 'f1-score': 0.5267930605885545, 'support': 21373}, '2': {'precision': 0.4274387874076953, 'recall': 0.3463500661334005, 'f1-score': 0.3826456057337694, 'support': 15877}, 'accuracy': 0.4269808974793715, 'macro avg': {'precision': 0.44096578955806714, 'recall': 0.3947427935910813, 'f1-score': 0.37277198363920805, 'support': 53082}, 'weighted avg': {'precision': 0.4388563104159618, 'recall': 0.4269808974793715, 'f1-score': 0.3888579468728952, 'support': 53082}}
[[ 2120 11051  2661]
 [ 1622 15046  4705]
 [  725  9653  5499]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119893
{'0': {'precision': 0.41667656491269744, 'recall': 0.03620824904008918, 'f1-score': 0.06662678176310267, 'support': 96884}, '1': {'precision': 0.27687316390637107, 'recall': 0.7366844158348289, 'f1-score': 0.4024796402090677, 'support': 67421}, '2': {'precision': 0.33568833603991227, 'recall': 0.2408991517889324, 'f1-score': 0.28050222082327847, 'support': 83234}, 'accuracy': 0.2958200525977725, 'macro avg': {'precision': 0.3430793549529936, 'recall': 0.3379306055546169, 'f1-score': 0.24986954759848293, 'support': 247539}, 'weighted avg': {'precision': 0.3513670203914506, 'recall': 0.2958200525977725, 'f1-score': 0.23001616228100122, 'support': 247539}}
[[ 3508 69010 24366]
 [ 2439 49668 15314]
 [ 2472 60711 20051]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076741
{'0': {'precision': 0.3241350906095552, 'recall': 0.04395911299782159, 'f1-score': 0.07741872018100437, 'support': 17903}, '1': {'precision': 0.3359461114513166, 'recall': 0.7382785164450665, 'f1-score': 0.4617689640079459, 'support': 18577}, '2': {'precision': 0.3711189671072856, 'recall': 0.24407379327773565, 'f1-score': 0.29447815348964845, 'support': 19785}, 'accuracy': 0.34357060339465034, 'macro avg': {'precision': 0.3437333897227191, 'recall': 0.34210380757354125, 'f1-score': 0.2778886125595329, 'support': 56265}, 'weighted avg': {'precision': 0.3445561219911423, 'recall': 0.34357060339465034, 'f1-score': 0.2806462216043513, 'support': 56265}}
[[  787 12930  4186]
 [  865 13715  3997]
 [  776 14180  4829]]
Evaluating performance on  val set...
79/79 - 1s - 786ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113522
{'0': {'precision': 0.3285302593659942, 'recall': 0.032976569279722305, 'f1-score': 0.05993690851735016, 'support': 6914}, '1': {'precision': 0.3284059412977045, 'recall': 0.7155466088572313, 'f1-score': 0.45019241073603194, 'support': 6458}, '2': {'precision': 0.3394216133942161, 'recall': 0.2683110242141675, 'f1-score': 0.29970600587988244, 'support': 6649}, 'accuracy': 0.3313021327606014, 'macro avg': {'precision': 0.33211927135263825, 'recall': 0.33894473411704035, 'f1-score': 0.26994510837775487, 'support': 20021}, 'weighted avg': {'precision': 0.33210719192923444, 'recall': 0.3313021327606014, 'f1-score': 0.265445862200569, 'support': 20021}}
[[ 228 4780 1906]
 [ 271 4621 1566]
 [ 195 4670 1784]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1184618
{'0': {'precision': 0.350253807106599, 'recall': 0.0037844508432743726, 'f1-score': 0.007487994790960145, 'support': 145860}, '1': {'precision': 0.28206124711918945, 'recall': 0.9012400354295838, 'f1-score': 0.4296537020554325, 'support': 115158}, '2': {'precision': 0.3478426464987214, 'recall': 0.08801663132968031, 'f1-score': 0.14048542515904322, 'support': 145268}, 'accuracy': 0.2882772234337388, 'macro avg': {'precision': 0.3267192335748366, 'recall': 0.33101370586751283, 'f1-score': 0.19254237400181196, 'support': 406286}, 'weighted avg': {'precision': 0.33006314510442497, 'recall': 0.2882772234337388, 'f1-score': 0.17470032608436625, 'support': 406286}}
[[   552 132231  13077]
 [   478 103785  10895]
 [   546 131936  12786]]
Evaluating performance on  train set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061395
{'0': {'precision': 0.42916666666666664, 'recall': 0.004155068780507483, 'f1-score': 0.008230452674897118, 'support': 24789}, '1': {'precision': 0.3320498663257003, 'recall': 0.9154382310527159, 'f1-score': 0.4873331343028959, 'support': 24964}, '2': {'precision': 0.3495175848117025, 'recall': 0.08726735827796557, 'f1-score': 0.13966358859559122, 'support': 25737}, 'accuracy': 0.33384554245595444, 'macro avg': {'precision': 0.37024470593468983, 'recall': 0.3356202193703963, 'f1-score': 0.21174239185779475, 'support': 75490}, 'weighted avg': {'precision': 0.3698958728739379, 'recall': 0.33384554245595444, 'f1-score': 0.21147610061968802, 'support': 75490}}
[[  103 22557  2129]
 [   60 22853  2051]
 [   77 23414  2246]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017711
{'0': {'precision': 0.2727272727272727, 'recall': 0.0037309863197168276, 'f1-score': 0.0073612684031710085, 'support': 10453}, '1': {'precision': 0.35957580362747366, 'recall': 0.9080594026364092, 'f1-score': 0.5151579694710685, 'support': 11986}, '2': {'precision': 0.32528891910265123, 'recall': 0.08767750801649107, 'f1-score': 0.1381251353106733, 'support': 10915}, 'accuracy': 0.3561791689152725, 'macro avg': {'precision': 0.3191973318191325, 'recall': 0.333155965657539, 'f1-score': 0.22021479106163758, 'support': 33354}, 'weighted avg': {'precision': 0.32113756419327577, 'recall': 0.3561791689152725, 'f1-score': 0.232633765443862, 'support': 33354}}
[[   39  9477   937]
 [   54 10884  1048]
 [   50  9908   957]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1235164
{'0': {'precision': 0.4100536265641081, 'recall': 0.036121927011757524, 'f1-score': 0.06639506378574656, 'support': 209568}, '1': {'precision': 0.2361765955660274, 'recall': 0.7420672673344899, 'f1-score': 0.35831335626353517, 'support': 125083}, '2': {'precision': 0.40263122693545467, 'recall': 0.2509440439409543, 'f1-score': 0.30918522412454413, 'support': 203910}, 'accuracy': 0.28141658976420497, 'macro avg': {'precision': 0.3496204830218634, 'recall': 0.3430444127624006, 'f1-score': 0.2446312147246086, 'support': 538561}, 'weighted avg': {'precision': 0.3668597039135418, 'recall': 0.28141658976420497, 'f1-score': 0.22611950980520107, 'support': 538561}}
[[  7570 153454  48544]
 [  4888  92820  27375]
 [  6003 146737  51170]]
Evaluating performance on  train set...
428/428 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057419
{'0': {'precision': 0.32553495007132666, 'recall': 0.031215802144889473, 'f1-score': 0.05696881943230896, 'support': 36552}, '1': {'precision': 0.336121374531379, 'recall': 0.6865807807143647, 'f1-score': 0.4513033918171163, 'support': 36172}, '2': {'precision': 0.35480655410877826, 'recall': 0.30976339407125375, 'f1-score': 0.33075850853757693, 'support': 36770}, 'accuracy': 0.34126070834931593, 'macro avg': {'precision': 0.3388209595704946, 'recall': 0.34251999231016933, 'f1-score': 0.2796769065956674, 'support': 109494}, 'weighted avg': {'precision': 0.3388621554526819, 'recall': 0.34126070834931593, 'f1-score': 0.27918297747479487, 'support': 109494}}
[[ 1141 24702 10709]
 [ 1334 24835 10003]
 [ 1030 24350 11390]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1063508
{'0': {'precision': 0.36724565756823824, 'recall': 0.036390459798377184, 'f1-score': 0.0662192393736018, 'support': 12201}, '1': {'precision': 0.30594625268533904, 'recall': 0.685620855663548, 'f1-score': 0.4230941704035874, 'support': 11009}, '2': {'precision': 0.3774544004784212, 'recall': 0.29811855467212467, 'f1-score': 0.333128078817734, 'support': 12703}, 'accuracy': 0.3279870798875059, 'macro avg': {'precision': 0.3502154369106662, 'recall': 0.3400432900446833, 'f1-score': 0.27414716286497437, 'support': 35913}, 'weighted avg': {'precision': 0.3520655420900609, 'recall': 0.3279870798875059, 'f1-score': 0.2700278630800012, 'support': 35913}}
[[ 444 8527 3230]
 [ 445 7548 3016]
 [ 320 8596 3787]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
5267/5267 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09542
{'0': {'precision': 0.5486868646321515, 'recall': 0.11343525735850936, 'f1-score': 0.18800288838456777, 'support': 481993}, '1': {'precision': 0.27440997787687094, 'recall': 0.6938408172183983, 'f1-score': 0.3932800143670153, 'support': 366120}, '2': {'precision': 0.4880984096104878, 'recall': 0.31508210751965704, 'f1-score': 0.382955194497442, 'support': 500076}, 'accuracy': 0.34584839365993936, 'macro avg': {'precision': 0.43706508403983674, 'recall': 0.37411939403218825, 'f1-score': 0.32141269908300835, 'support': 1348189}, 'weighted avg': {'precision': 0.4517293267704297, 'recall': 0.34584839365993936, 'f1-score': 0.3160613659395659, 'support': 1348189}}
[[ 54675 349613  77705]
 [ 24547 254029  87544]
 [ 20425 322086 157565]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0652217
{'0': {'precision': 0.5289905693328676, 'recall': 0.13444445677382127, 'f1-score': 0.21439883917432737, 'support': 90119}, '1': {'precision': 0.34023100406876156, 'recall': 0.7134820863892063, 'f1-score': 0.4607491903356166, 'support': 90127}, '2': {'precision': 0.4929579837595606, 'recall': 0.3214893920915873, 'f1-score': 0.3891737323358271, 'support': 91017}, 'accuracy': 0.3895887017396401, 'macro avg': {'precision': 0.4540598523870632, 'recall': 0.3898053117515383, 'f1-score': 0.354773920615257, 'support': 271263}, 'weighted avg': {'precision': 0.45418526533017, 'recall': 0.3895887017396401, 'f1-score': 0.3548909245305822, 'support': 271263}}
[[12116 66722 11281]
 [ 7007 64304 18816]
 [ 3781 57975 29261]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0674723
{'0': {'precision': 0.5259600172587372, 'recall': 0.11259583115243696, 'f1-score': 0.18548387096774194, 'support': 32479}, '1': {'precision': 0.35991013129256477, 'recall': 0.7092337917485265, 'f1-score': 0.47750433146412796, 'support': 36139}, '2': {'precision': 0.4637847689991283, 'recall': 0.33646659767736004, 'f1-score': 0.38999766767733984, 'support': 34788}, 'accuracy': 0.39642767344254687, 'macro avg': {'precision': 0.4498849725168101, 'recall': 0.3860987401927745, 'f1-score': 0.35099529003640323, 'support': 103406}, 'weighted avg': {'precision': 0.4470107361204398, 'recall': 0.39642767344254687, 'f1-score': 0.35634391179527986, 'support': 103406}}
[[ 3657 23799  5023]
 [ 1998 25631  8510]
 [ 1298 21785 11705]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
10110/10110 - 89s - 89s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043712
{'0': {'precision': 0.49789609632129317, 'recall': 0.08960017993509484, 'f1-score': 0.15187017049245205, 'support': 933670}, '1': {'precision': 0.27349817314036884, 'recall': 0.7487268191693001, 'f1-score': 0.40064646973915696, 'support': 704731}, '2': {'precision': 0.461075806875531, 'recall': 0.23828788038327894, 'f1-score': 0.314196400865525, 'support': 949700}, 'accuracy': 0.32363883789697545, 'macro avg': {'precision': 0.41082335877906434, 'recall': 0.35887162649589127, 'f1-score': 0.28890434703237805, 'support': 2588101}, 'weighted avg': {'precision': 0.42328216058700135, 'recall': 0.32363883789697545, 'f1-score': 0.27917648161776637, 'support': 2588101}}
[[ 83657 720957 129056]
 [ 41625 527651 135455]
 [ 42739 680659 226302]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.085855
{'0': {'precision': 0.4656193664692248, 'recall': 0.08771710954935473, 'f1-score': 0.14762368557648006, 'support': 144282}, '1': {'precision': 0.34074001193362874, 'recall': 0.7370317992091389, 'f1-score': 0.4660285627468855, 'support': 145664}, '2': {'precision': 0.4225347381621525, 'recall': 0.26646283769470847, 'f1-score': 0.32682206527434365, 'support': 141622}, 'accuracy': 0.3655321988655322, 'macro avg': {'precision': 0.40963137218833534, 'recall': 0.363737248817734, 'f1-score': 0.31349143786590306, 'support': 431568}, 'weighted avg': {'precision': 0.40933123220260337, 'recall': 0.3655321988655322, 'f1-score': 0.31389773962525286, 'support': 431568}}
[[ 12656 109725  21901]
 [  8632 107359  29673]
 [  5893  97992  37737]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959817
{'0': {'precision': 0.44741689325497763, 'recall': 0.08297951946382964, 'f1-score': 0.13999505996651757, 'support': 61473}, '1': {'precision': 0.3017886227906135, 'recall': 0.7397918630658608, 'f1-score': 0.42869614117773075, 'support': 54099}, '2': {'precision': 0.45597164601478146, 'recall': 0.25594522069029335, 'f1-score': 0.3278578413457265, 'support': 64842}, 'accuracy': 0.34209651135721175, 'macro avg': {'precision': 0.40172572068679085, 'recall': 0.35957220107332794, 'f1-score': 0.2988496808299916, 'support': 180414}, 'weighted avg': {'precision': 0.40682338872982754, 'recall': 0.34209651135721175, 'f1-score': 0.29408420084602854, 'support': 180414}}
[[ 5101 47042  9330]
 [ 3606 40022 10471]
 [ 2694 45552 16596]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
6546/6546 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094812
{'0': {'precision': 0.39700336241366774, 'recall': 0.06431920908113838, 'f1-score': 0.11070319923978461, 'support': 543368}, '1': {'precision': 0.3633045327574316, 'recall': 0.73209333952501, 'f1-score': 0.4856186694917771, 'support': 602960}, '2': {'precision': 0.37473136310585836, 'recall': 0.26380276555839083, 'f1-score': 0.30963159364899195, 'support': 529441}, 'accuracy': 0.36761630033733766, 'macro avg': {'precision': 0.37834641942565256, 'recall': 0.35340510472151304, 'f1-score': 0.3019844874601845, 'support': 1675769}, 'weighted avg': {'precision': 0.3778415591370526, 'recall': 0.36761630033733766, 'f1-score': 0.30845114660457446, 'support': 1675769}}
[[ 34949 406049 102370]
 [ 30860 441423 130677]
 [ 22223 367550 139668]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964053
{'0': {'precision': 0.42758667758667757, 'recall': 0.05914227185620829, 'f1-score': 0.10391182836718277, 'support': 105931}, '1': {'precision': 0.342676601207411, 'recall': 0.7400784916122627, 'f1-score': 0.468448652542398, 'support': 106763}, '2': {'precision': 0.38933306491041386, 'recall': 0.26524354402601985, 'f1-score': 0.3155263433905534, 'support': 102076}, 'accuracy': 0.3569368110048607, 'macro avg': {'precision': 0.3865321145681675, 'recall': 0.35482143583149695, 'f1-score': 0.2959622747667114, 'support': 314770}, 'weighted avg': {'precision': 0.3863818923402375, 'recall': 0.3569368110048607, 'f1-score': 0.29617858884290815, 'support': 314770}}
[[ 6265 80064 19602]
 [ 4885 79013 22865]
 [ 3502 71499 27075]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.086158
{'0': {'precision': 0.41941633670626194, 'recall': 0.07944223771561901, 'f1-score': 0.13358243811303128, 'support': 36001}, '1': {'precision': 0.3799817606859877, 'recall': 0.7485185012365265, 'f1-score': 0.5040732157586708, 'support': 42862}, '2': {'precision': 0.3779190334505455, 'recall': 0.24248647710508808, 'f1-score': 0.2954205064049477, 'support': 34571}, 'accuracy': 0.3819489747342067, 'macro avg': {'precision': 0.39243904361426507, 'recall': 0.3568157386857445, 'f1-score': 0.31102538675888325, 'support': 113434}, 'weighted avg': {'precision': 0.39186861672605877, 'recall': 0.3819489747342067, 'f1-score': 0.3228985123973485, 'support': 113434}}
[[ 2860 27624  5517]
 [ 2497 32083  8282]
 [ 1462 24726  8383]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
7633/7633 - 65s - 65s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012261
{'0': {'precision': 0.4228073111321842, 'recall': 0.06805618323900622, 'f1-score': 0.11724095261174212, 'support': 668242}, '1': {'precision': 0.3167204258141126, 'recall': 0.7449210079751485, 'f1-score': 0.44446588336641757, 'support': 612277}, '2': {'precision': 0.41397919583818327, 'recall': 0.2497887801814189, 'f1-score': 0.3115768222775807, 'support': 673469}, 'accuracy': 0.3427866496621269, 'macro avg': {'precision': 0.38450231092816, 'recall': 0.3542553237985245, 'f1-score': 0.2910945527519135, 'support': 1953988}, 'weighted avg': {'precision': 0.3865225325865491, 'recall': 0.3427866496621269, 'f1-score': 0.2867565702796414, 'support': 1953988}}
[[ 45478 506450 116314]
 [ 34357 456098 121822]
 [ 27727 477517 168225]]
Evaluating performance on  train set...
1586/1586 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968741
{'0': {'precision': 0.41793088537350004, 'recall': 0.08598371958542769, 'f1-score': 0.14262437206785666, 'support': 134886}, '1': {'precision': 0.3406737365335201, 'recall': 0.7406865042174321, 'f1-score': 0.46669450102302795, 'support': 136576}, '2': {'precision': 0.39506766250092434, 'recall': 0.23856126458680638, 'f1-score': 0.29748591686542375, 'support': 134368}, 'accuracy': 0.3568316782889387, 'macro avg': {'precision': 0.38455742813598154, 'recall': 0.35507716279655543, 'f1-score': 0.30226826331876944, 'support': 405830}, 'weighted avg': {'precision': 0.3843612678220342, 'recall': 0.3568316782889387, 'f1-score': 0.30295908853421194, 'support': 405830}}
[[ 11598  99984  23304]
 [  9637 101160  25779]
 [  6516  95797  32055]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0833327
{'0': {'precision': 0.3800064773831372, 'recall': 0.07952286282306163, 'f1-score': 0.13152240925140585, 'support': 44264}, '1': {'precision': 0.3906461584437658, 'recall': 0.7370275746630253, 'f1-score': 0.5106388173395022, 'support': 56755}, '2': {'precision': 0.3815543837814823, 'recall': 0.25405617585484996, 'f1-score': 0.30501773815601724, 'support': 45856}, 'accuracy': 0.3880851063829787, 'macro avg': {'precision': 0.38406900653612847, 'recall': 0.3568688711136456, 'f1-score': 0.31572632158230846, 'support': 146875}, 'weighted avg': {'precision': 0.3846011047492546, 'recall': 0.3880851063829787, 'f1-score': 0.3321866035886979, 'support': 146875}}
[[ 3520 33147  7597]
 [ 3639 41830 11286]
 [ 2104 32102 11650]]
testing model on single stock: results/universal/W10/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
22048/22048 - 163s - 163s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117981
{'0': {'precision': 0.39120128207981836, 'recall': 0.01661873452527796, 'f1-score': 0.03188303657555997, 'support': 2115143}, '1': {'precision': 0.2507072028247388, 'recall': 0.6707950600791621, 'f1-score': 0.364997808363792, 'support': 1413302}, '2': {'precision': 0.3877452592472671, 'recall': 0.3249076040485474, 'f1-score': 0.35355609905385005, 'support': 2115623}, 'accuracy': 0.2959866890335127, 'macro avg': {'precision': 0.34321791471727475, 'recall': 0.3374404662176625, 'f1-score': 0.250145647997734, 'support': 5644068}, 'weighted avg': {'precision': 0.354725427325334, 'recall': 0.2959866890335127, 'f1-score': 0.23587255311883323, 'support': 5644068}}
[[  35151 1436642  643350]
 [  23231  948036  442035]
 [  31472 1396769  687382]]
Evaluating performance on  train set...
5429/5429 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1046325
{'0': {'precision': 0.3570069938255348, 'recall': 0.026392016631297036, 'f1-score': 0.04915054166314153, 'support': 462261}, '1': {'precision': 0.33269232373626556, 'recall': 0.6982195423556319, 'f1-score': 0.45065400770866687, 'support': 456905}, '2': {'precision': 0.3613136754226543, 'recall': 0.3045704693708433, 'f1-score': 0.33052439098909436, 'support': 470630}, 'accuracy': 0.34146018552363083, 'macro avg': {'precision': 0.35033766432815155, 'recall': 0.3430606761192574, 'f1-score': 0.27677631345363424, 'support': 1389796}, 'weighted avg': {'precision': 0.35047176075745484, 'recall': 0.34146018552363083, 'f1-score': 0.2764298804019233, 'support': 1389796}}
[[ 12200 323034 127027]
 [ 11533 319020 126352]
 [ 10440 316850 143340]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004927
{'0': {'precision': 0.3317833062078586, 'recall': 0.028094791208646976, 'f1-score': 0.05180300096805421, 'support': 152377}, '1': {'precision': 0.3592387274460648, 'recall': 0.7094468559873089, 'f1-score': 0.47696121232720173, 'support': 172089}, '2': {'precision': 0.35161788071376193, 'recall': 0.28913763104503115, 'f1-score': 0.3173315225446636, 'support': 159201}, 'accuracy': 0.35644358618636374, 'macro avg': {'precision': 0.3475466381225618, 'recall': 0.342226426080329, 'f1-score': 0.28203191194663985, 'support': 483667}, 'weighted avg': {'precision': 0.34808059355923043, 'recall': 0.3564435861863638, 'f1-score': 0.2904743546020671, 'support': 483667}}
[[  4281 108421  39675]
 [  4795 122088  45206]
 [  3827 109343  46031]]
training model: results/universal/W10/deepVOL_L3/h50
Epoch 1/50
8543/8543 - 468s - loss: 3.0759 - accuracy50: 0.4535 - val_loss: 3.1946 - val_accuracy50: 0.4212 - 468s/epoch - 55ms/step
Epoch 2/50
8543/8543 - 428s - loss: 2.9910 - accuracy50: 0.4740 - val_loss: 3.6024 - val_accuracy50: 0.4262 - 428s/epoch - 50ms/step
Epoch 3/50
8543/8543 - 432s - loss: 2.9693 - accuracy50: 0.4800 - val_loss: 3.7639 - val_accuracy50: 0.4274 - 432s/epoch - 51ms/step
Epoch 4/50
8543/8543 - 430s - loss: 2.9590 - accuracy50: 0.4826 - val_loss: 3.6188 - val_accuracy50: 0.4282 - 430s/epoch - 50ms/step
Epoch 5/50
8543/8543 - 438s - loss: 2.9514 - accuracy50: 0.4851 - val_loss: 3.6911 - val_accuracy50: 0.4178 - 438s/epoch - 51ms/step
Epoch 6/50
8543/8543 - 437s - loss: 2.9458 - accuracy50: 0.4862 - val_loss: 3.6055 - val_accuracy50: 0.4167 - 437s/epoch - 51ms/step
Epoch 7/50
8543/8543 - 443s - loss: 2.9400 - accuracy50: 0.4878 - val_loss: 3.4565 - val_accuracy50: 0.4249 - 443s/epoch - 52ms/step
Epoch 8/50
8543/8543 - 426s - loss: 2.9355 - accuracy50: 0.4888 - val_loss: 3.5399 - val_accuracy50: 0.4297 - 426s/epoch - 50ms/step
Epoch 9/50
8543/8543 - 428s - loss: 2.9311 - accuracy50: 0.4901 - val_loss: 3.5454 - val_accuracy50: 0.4332 - 428s/epoch - 50ms/step
Epoch 10/50
8543/8543 - 439s - loss: 2.9273 - accuracy50: 0.4910 - val_loss: 3.5916 - val_accuracy50: 0.4297 - 439s/epoch - 51ms/step
Epoch 11/50
8543/8543 - 432s - loss: 2.9239 - accuracy50: 0.4922 - val_loss: 3.6127 - val_accuracy50: 0.4353 - 432s/epoch - 51ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 994s - 994s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0577105
{'0': {'precision': 0.46278601096396504, 'recall': 0.12817162803888474, 'f1-score': 0.20074547664350106, 'support': 3201668}, '1': {'precision': 0.6433776889179258, 'recall': 0.31729561091248354, 'f1-score': 0.42499550448360063, 'support': 3091212}, '2': {'precision': 0.39316010607146734, 'recall': 0.8623871179397116, 'f1-score': 0.5400931231891684, 'support': 3252399}, 'accuracy': 0.4395909223816297, 'macro avg': {'precision': 0.4997746019844527, 'recall': 0.43595145229702664, 'f1-score': 0.38861136810542335, 'support': 9545279}, 'weighted avg': {'precision': 0.49754622473508314, 'recall': 0.4395909223816297, 'f1-score': 0.3889954296660509, 'support': 9545279}}
[[ 410363  301345 2489960]
 [ 271113  980828 1839271]
 [ 205247  242325 2804827]]
Evaluating performance on  train set...
8543/8543 - 240s - 240s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0891982
{'0': {'precision': 0.4343330132075651, 'recall': 0.13942709056694194, 'f1-score': 0.21109096979842898, 'support': 655217}, '1': {'precision': 0.7168707869401666, 'recall': 0.28640899791238983, 'f1-score': 0.4092940908808869, 'support': 863667}, '2': {'precision': 0.3560626679613174, 'recall': 0.8697569463161614, 'f1-score': 0.5052749608118429, 'support': 667836}, 'accuracy': 0.42052571888490525, 'macro avg': {'precision': 0.5024221560363498, 'recall': 0.43186434493183107, 'f1-score': 0.37522000716371956, 'support': 2186720}, 'weighted avg': {'precision': 0.5220199585587951, 'recall': 0.42052571888490525, 'f1-score': 0.3792186472323746, 'support': 2186720}}
[[ 91355  53793 510069]
 [ 75901 247362 540404]
 [ 43078  43903 580855]]
Evaluating performance on  val set...
3077/3077 - 82s - 82s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879968
{'0': {'precision': 0.43199407935173917, 'recall': 0.1524942658011495, 'f1-score': 0.22541636803366943, 'support': 225838}, '1': {'precision': 0.7106339615058918, 'recall': 0.3009692508289845, 'f1-score': 0.4228515062035216, 'support': 329017}, '2': {'precision': 0.3487363438497137, 'recall': 0.8532927165557892, 'f1-score': 0.4951197803901176, 'support': 232088}, 'accuracy': 0.42125287346097495, 'macro avg': {'precision': 0.49712146156911485, 'recall': 0.4355854110619744, 'f1-score': 0.38112921820910284, 'support': 786943}, 'weighted avg': {'precision': 0.5239373799332536, 'recall': 0.42125287346097495, 'f1-score': 0.38750490865505316, 'support': 786943}}
[[ 34439  22210 169189]
 [ 29345  99024 200648]
 [ 15937  18112 198039]]
testing model out of sample: results/universal/W10/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 580s - 580s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0253233
{'0': {'precision': 0.4435800006968104, 'recall': 0.25980048120475563, 'f1-score': 0.32768124961978873, 'support': 1617191}, '1': {'precision': 0.6579923084357162, 'recall': 0.38504278088547433, 'f1-score': 0.48580376793694446, 'support': 2227981}, '2': {'precision': 0.3855439178032687, 'recall': 0.7659824947218634, 'f1-score': 0.5129190069313211, 'support': 1615627}, 'accuracy': 0.460657314067044, 'macro avg': {'precision': 0.49570540897859844, 'recall': 0.47027525227069783, 'f1-score': 0.4421346748293515, 'support': 5460799}, 'weighted avg': {'precision': 0.5138887385411058, 'recall': 0.460657314067044, 'f1-score': 0.44699878696454975, 'support': 5460799}}
[[ 420147  242870  954174]
 [ 351969  857868 1018144]
 [ 175057  203028 1237542]]
Evaluating performance on  train set...
4055/4055 - 115s - 115s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0302087
{'0': {'precision': 0.42829480075223636, 'recall': 0.26723351508694226, 'f1-score': 0.32911593242724607, 'support': 287202}, '1': {'precision': 0.690919379695627, 'recall': 0.3755972510090542, 'f1-score': 0.48664486274554153, 'support': 458350}, '2': {'precision': 0.3743164240461129, 'recall': 0.7810179222273985, 'f1-score': 0.5060835189519678, 'support': 291928}, 'accuracy': 0.4596772949839997, 'macro avg': {'precision': 0.49784353483132543, 'recall': 0.47461622944113163, 'f1-score': 0.4406147713749185, 'support': 1037480}, 'weighted avg': {'precision': 0.5291316132244169, 'recall': 0.4596772949839997, 'f1-score': 0.4485063580840102, 'support': 1037480}}
[[ 76750  43387 167065]
 [ 72148 172155 214047]
 [ 30301  33626 228001]]
Evaluating performance on  val set...
1545/1545 - 42s - 42s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.030421
{'0': {'precision': 0.4167739167739168, 'recall': 0.2507512767095002, 'f1-score': 0.31311654676258993, 'support': 108482}, '1': {'precision': 0.6912505427702996, 'recall': 0.3668214339205272, 'f1-score': 0.479297289566978, 'support': 173594}, '2': {'precision': 0.37695828088094746, 'recall': 0.793537122548281, 'f1-score': 0.5111175809057331, 'support': 112829}, 'accuracy': 0.4568541801192692, 'macro avg': {'precision': 0.49499424680838794, 'recall': 0.4703699443927694, 'f1-score': 0.434510472411767, 'support': 394905}, 'weighted avg': {'precision': 0.526053710727015, 'recall': 0.4568541801192692, 'f1-score': 0.4427381989263297, 'support': 394905}}
[[27202 16358 64922]
 [26855 63678 83061]
 [11211 12084 89534]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1220713
{'0': {'precision': 0.448030869112513, 'recall': 0.14168942607550314, 'f1-score': 0.21529269800158932, 'support': 51627}, '1': {'precision': 0.3779372197309417, 'recall': 0.06403671397744887, 'f1-score': 0.10951712666978533, 'support': 32903}, '2': {'precision': 0.37969252447880913, 'recall': 0.8742720465890182, 'f1-score': 0.5294480691236114, 'support': 48080}, 'accuracy': 0.38803257672875346, 'macro avg': {'precision': 0.4018868711074213, 'recall': 0.35999939554732346, 'f1-score': 0.28475263126499534, 'support': 132610}, 'weighted avg': {'precision': 0.4058621114351861, 'recall': 0.38803257672875346, 'f1-score': 0.30295016440696204, 'support': 132610}}
[[ 7315  2043 42269]
 [ 4392  2107 26404]
 [ 4620  1425 42035]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1507955
{'0': {'precision': 0.41482609799441483, 'recall': 0.14136170949044036, 'f1-score': 0.21086591818299136, 'support': 11559}, '1': {'precision': 0.44981009224091156, 'recall': 0.0746308966510623, 'f1-score': 0.12802100223920934, 'support': 11108}, '2': {'precision': 0.3608493045093024, 'recall': 0.8835792724776939, 'f1-score': 0.5124263004701843, 'support': 11656}, 'accuracy': 0.37182064504850976, 'macro avg': {'precision': 0.40849516491487625, 'recall': 0.3665239595397322, 'f1-score': 0.283771073630795, 'support': 34323}, 'weighted avg': {'precision': 0.4078176402030684, 'recall': 0.37182064504850976, 'f1-score': 0.28646381142181054, 'support': 34323}}
[[ 1634   575  9350]
 [ 1387   829  8892]
 [  918   439 10299]]
Evaluating performance on  val set...
46/46 - 1s - 775ms/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1426716
{'0': {'precision': 0.4196078431372549, 'recall': 0.16054013503375844, 'f1-score': 0.23223005968529573, 'support': 3999}, '1': {'precision': 0.44154057771664373, 'recall': 0.08514588859416446, 'f1-score': 0.14276184122748498, 'support': 3770}, '2': {'precision': 0.3551193633952255, 'recall': 0.8553539483772042, 'f1-score': 0.5018743439796072, 'support': 3913}, 'accuracy': 0.36894367402841977, 'macro avg': {'precision': 0.40542259474970804, 'recall': 0.36701332400170905, 'f1-score': 0.2922887482974626, 'support': 11682}, 'weighted avg': {'precision': 0.4050849008443029, 'recall': 0.36894367402841977, 'f1-score': 0.2936769780946173, 'support': 11682}}
[[ 642  254 3103]
 [ 474  321 2975]
 [ 414  152 3347]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8693591
{'0': {'precision': 0.44365523643421756, 'recall': 0.3666170761756433, 'f1-score': 0.4014738824966908, 'support': 86038}, '1': {'precision': 0.7615538027561672, 'recall': 0.710722765503642, 'f1-score': 0.7352608014599122, 'support': 298188}, '2': {'precision': 0.3826819318331359, 'recall': 0.5364014710459875, 'f1-score': 0.4466866674666986, 'support': 86741}, 'accuracy': 0.6157543946815807, 'macro avg': {'precision': 0.5292969903411735, 'recall': 0.5379137709084242, 'f1-score': 0.5278071171411005, 'support': 470967}, 'weighted avg': {'precision': 0.633699660523394, 'recall': 0.6157543946815807, 'f1-score': 0.6211348268365033, 'support': 470967}}
[[ 31543  33443  21052]
 [ 32255 211929  54004]
 [  7300  32913  46528]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78113323
{'0': {'precision': 0.41660123387549075, 'recall': 0.43050886750898343, 'f1-score': 0.42344088473378183, 'support': 17254}, '1': {'precision': 0.8373967053740211, 'recall': 0.7717394550576898, 'f1-score': 0.8032285806057216, 'support': 100451}, '2': {'precision': 0.3774203872619619, 'recall': 0.533114828209765, 'f1-score': 0.44195633842406074, 'support': 17696}, 'accuracy': 0.6970701841197627, 'macro avg': {'precision': 0.543806108837158, 'recall': 0.5784543835921462, 'f1-score': 0.5562086012545214, 'support': 135401}, 'weighted avg': {'precision': 0.7236593918346333, 'recall': 0.6970701841197627, 'f1-score': 0.7076168015034909, 'support': 135401}}
[[ 7428  7873  1953]
 [ 9320 77522 13609]
 [ 1082  7180  9434]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81895775
{'0': {'precision': 0.4863365800865801, 'recall': 0.4205170195344485, 'f1-score': 0.45103820337494516, 'support': 8549}, '1': {'precision': 0.7924890108269168, 'recall': 0.7525071432573254, 'f1-score': 0.7719807457432287, 'support': 35698}, '2': {'precision': 0.3983719155431188, 'recall': 0.531748726655348, 'f1-score': 0.45549738219895286, 'support': 8835}, 'accuracy': 0.6622960702309634, 'macro avg': {'precision': 0.5590658354855386, 'recall': 0.5682576298157073, 'f1-score': 0.5595054437723755, 'support': 53082}, 'weighted avg': {'precision': 0.6775852455725652, 'recall': 0.6622960702309634, 'f1-score': 0.6676163979111928, 'support': 53082}}
[[ 3595  3534  1420]
 [ 3160 26863  5675]
 [  637  3500  4698]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1834673
{'0': {'precision': 0.40525110670126696, 'recall': 0.14702494351158565, 'f1-score': 0.21576898381813894, 'support': 90284}, '1': {'precision': 0.30758704576554663, 'recall': 0.027734364289435442, 'f1-score': 0.05088092154076384, 'support': 72942}, '2': {'precision': 0.34781251350819137, 'recall': 0.8589066929180553, 'f1-score': 0.49512511964993855, 'support': 84313}, 'accuracy': 0.354344163949923, 'macro avg': {'precision': 0.35355022199166836, 'recall': 0.3445553335730254, 'f1-score': 0.25392500833628046, 'support': 247539}, 'weighted avg': {'precision': 0.35690869584616497, 'recall': 0.354344163949923, 'f1-score': 0.2623317025887174, 'support': 247539}}
[[13274  2565 74445]
 [ 9574  2023 61345]
 [ 9907  1989 72417]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1934274
{'0': {'precision': 0.365931268561731, 'recall': 0.18615442723789996, 'f1-score': 0.2467722899753228, 'support': 18533}, '1': {'precision': 0.35870556061987235, 'recall': 0.08470107087122639, 'f1-score': 0.13704235775543075, 'support': 18583}, '2': {'precision': 0.3519517538693491, 'recall': 0.7801973993420022, 'f1-score': 0.4850806844378065, 'support': 19149}, 'accuracy': 0.35482093663911846, 'macro avg': {'precision': 0.35886286101698417, 'recall': 0.3503509658170428, 'f1-score': 0.28963177738952, 'support': 56265}, 'weighted avg': {'precision': 0.35878705710651054, 'recall': 0.35482093663911846, 'f1-score': 0.2916359905906226, 'support': 56265}}
[[ 3450  1290 13793]
 [ 3293  1574 13716]
 [ 2685  1524 14940]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1909337
{'0': {'precision': 0.3501639344262295, 'recall': 0.15476017968410374, 'f1-score': 0.2146517937895689, 'support': 6901}, '1': {'precision': 0.3554421768707483, 'recall': 0.032965299684542586, 'f1-score': 0.060334872979214776, 'support': 6340}, '2': {'precision': 0.34895928706586093, 'recall': 0.8432153392330384, 'f1-score': 0.49363208565384453, 'support': 6780}, 'accuracy': 0.34933320013985314, 'macro avg': {'precision': 0.3515217994542796, 'recall': 0.34364693953389486, 'f1-score': 0.2562062508075427, 'support': 20021}, 'weighted avg': {'precision': 0.35142743515021685, 'recall': 0.34933320013985314, 'f1-score': 0.260259760469662, 'support': 20021}}
[[1068  192 5641]
 [1106  209 5025]
 [ 876  187 5717]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1588/1588 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1229023
{'0': {'precision': 0.3456920303411681, 'recall': 0.07039112336281592, 'f1-score': 0.11696532357375501, 'support': 144379}, '1': {'precision': 0.28517320287224807, 'recall': 0.0301430418282664, 'f1-score': 0.05452296180073622, 'support': 119895}, '2': {'precision': 0.34849017335961824, 'recall': 0.8937624989437513, 'f1-score': 0.5014558714882286, 'support': 142012}, 'accuracy': 0.3463126959826329, 'macro avg': {'precision': 0.32645180219101144, 'recall': 0.3314322213782778, 'f1-score': 0.22431471895423993, 'support': 406286}, 'weighted avg': {'precision': 0.3288109787345411, 'recall': 0.3463126959826329, 'f1-score': 0.23293226490487184, 'support': 406286}}
[[ 10163   4647 129569]
 [  8561   3614 107720]
 [ 10675   4412 126925]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1310501
{'0': {'precision': 0.3530201342281879, 'recall': 0.0700133105153071, 'f1-score': 0.11685179308156142, 'support': 26295}, '1': {'precision': 0.3343122858541361, 'recall': 0.027578131309052734, 'f1-score': 0.050953038158827256, 'support': 24766}, '2': {'precision': 0.3245837730097315, 'recall': 0.9065864341561259, 'f1-score': 0.47802203731882886, 'support': 24429}, 'accuracy': 0.32681149821168365, 'macro avg': {'precision': 0.33730539769735185, 'recall': 0.3347259586601619, 'f1-score': 0.21527562285307253, 'support': 75490}, 'weighted avg': {'precision': 0.3376804807504102, 'recall': 0.32681149821168365, 'f1-score': 0.21210916931756318, 'support': 75490}}
[[ 1841   735 23719]
 [ 1717   683 22366]
 [ 1657   625 22147]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1380953
{'0': {'precision': 0.3301457194899818, 'recall': 0.06447309915518008, 'f1-score': 0.1078788780596682, 'support': 11245}, '1': {'precision': 0.33540372670807456, 'recall': 0.023398908050957623, 'f1-score': 0.043745949449125084, 'support': 11539}, '2': {'precision': 0.31631140249728196, 'recall': 0.908325449385052, 'f1-score': 0.4692226865088092, 'support': 10570}, 'accuracy': 0.31768303651735924, 'macro avg': {'precision': 0.3272869495651128, 'recall': 0.33206581886372993, 'f1-score': 0.20694917133920085, 'support': 33354}, 'weighted avg': {'precision': 0.3275806122967436, 'recall': 0.31768303651735924, 'f1-score': 0.2002028629511464, 'support': 33354}}
[[  725   280 10240]
 [  757   270 10512]
 [  714   255  9601]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0910172
{'0': {'precision': 0.45067975447674125, 'recall': 0.1607107324397171, 'f1-score': 0.23693228791636664, 'support': 221124}, '1': {'precision': 0.19066202090592335, 'recall': 0.042304044860429636, 'f1-score': 0.06924420223221442, 'support': 97012}, '2': {'precision': 0.4201225968999324, 'recall': 0.8351638879437451, 'f1-score': 0.559029712621601, 'support': 220425}, 'accuracy': 0.4154255506804243, 'macro avg': {'precision': 0.3538214574275323, 'recall': 0.34605955508129727, 'f1-score': 0.28840206759006065, 'support': 538561}, 'weighted avg': {'precision': 0.39133568420793186, 'recall': 0.4154255506804243, 'f1-score': 0.338556000499083, 'support': 538561}}
[[ 35537   8946 176641]
 [ 15456   4104  77452]
 [ 27859   8475 184091]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.185636
{'0': {'precision': 0.37595907928388744, 'recall': 0.1447602374374265, 'f1-score': 0.20903363419114016, 'support': 36557}, '1': {'precision': 0.39068692206076616, 'recall': 0.06532663316582915, 'f1-score': 0.1119364148176184, 'support': 36218}, '2': {'precision': 0.34945502562610503, 'recall': 0.8504588904926604, 'f1-score': 0.495364091338108, 'support': 36719}, 'accuracy': 0.35514274754781083, 'macro avg': {'precision': 0.3720336756569196, 'recall': 0.35351525369863873, 'f1-score': 0.2721113801156222, 'support': 109494}, 'weighted avg': {'precision': 0.37194251822513424, 'recall': 0.35514274754781083, 'f1-score': 0.2729376012095092, 'support': 109494}}
[[ 5292  1897 29368]
 [ 5086  2366 28766]
 [ 3698  1793 31228]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1683506
{'0': {'precision': 0.3763097949886105, 'recall': 0.13706131253629802, 'f1-score': 0.20093656875266072, 'support': 12053}, '1': {'precision': 0.41996348143639683, 'recall': 0.06102414433536747, 'f1-score': 0.10656370656370656, 'support': 11307}, '2': {'precision': 0.36244979919678716, 'recall': 0.8627419740301123, 'f1-score': 0.5104517710272666, 'support': 12553}, 'accuracy': 0.36677526243978503, 'macro avg': {'precision': 0.38624102520726483, 'recall': 0.3536091436339259, 'f1-score': 0.27265068211454463, 'support': 35913}, 'weighted avg': {'precision': 0.38520929393022946, 'recall': 0.36677526243978503, 'f1-score': 0.2794115048867242, 'support': 35913}}
[[ 1652   476  9925]
 [ 1492   690  9125]
 [ 1246   477 10830]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9033459
{'0': {'precision': 0.5255384615384615, 'recall': 0.30699948365000623, 'f1-score': 0.38758602478834187, 'support': 305994}, '1': {'precision': 0.6671509394981221, 'recall': 0.6868228130619791, 'f1-score': 0.6768439700350881, 'support': 733457}, '2': {'precision': 0.4288906855232832, 'recall': 0.5756110358945125, 'f1-score': 0.49153566691974615, 'support': 308738}, 'accuracy': 0.5751478464814651, 'macro avg': {'precision': 0.5405266955199556, 'recall': 0.523144444202166, 'f1-score': 0.5186552205810587, 'support': 1348189}, 'weighted avg': {'precision': 0.580447544890636, 'recall': 0.5751478464814651, 'f1-score': 0.5687560753963858, 'support': 1348189}}
[[ 93940 140522  71532]
 [ 64592 503755 165110]
 [ 20218 110807 177713]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82888657
{'0': {'precision': 0.5071608391608392, 'recall': 0.36695743690420773, 'f1-score': 0.4258152397280381, 'support': 49409}, '1': {'precision': 0.7498299519174387, 'recall': 0.744820516404853, 'f1-score': 0.7473168394077615, 'support': 171687}, '2': {'precision': 0.43535006848998814, 'recall': 0.5638367851376402, 'f1-score': 0.4913322911238492, 'support': 50167}, 'accuracy': 0.6425240449305656, 'macro avg': {'precision': 0.5641136198560887, 'recall': 0.5585382461489004, 'f1-score': 0.5548214567532163, 'support': 271263}, 'weighted avg': {'precision': 0.6474696945137539, 'recall': 0.6425240449305656, 'f1-score': 0.6414157420508257, 'support': 271263}}
[[ 18131  23539   7739]
 [ 14863 127876  28948]
 [  2756  19125  28286]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8441324
{'0': {'precision': 0.5063311049941015, 'recall': 0.3615432133430673, 'f1-score': 0.42185964222528016, 'support': 17807}, '1': {'precision': 0.7653215677433899, 'recall': 0.7054039212194072, 'f1-score': 0.7341422161122652, 'support': 67377}, '2': {'precision': 0.3845884780859771, 'recall': 0.6033915047744485, 'f1-score': 0.4697613808720172, 'support': 18222}, 'accuracy': 0.6282130630717754, 'macro avg': {'precision': 0.5520803836078229, 'recall': 0.556779546445641, 'f1-score': 0.5419210797365208, 'support': 103406}, 'weighted avg': {'precision': 0.6536301617329654, 'recall': 0.6282130630717754, 'f1-score': 0.6337770209306187, 'support': 103406}}
[[ 6438  8312  3057]
 [ 5312 47528 14537]
 [  965  6262 10995]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
10110/10110 - 144s - 144s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96476734
{'0': {'precision': 0.4449211172964523, 'recall': 0.35136057179144203, 'f1-score': 0.39264431247800075, 'support': 592104}, '1': {'precision': 0.701971365279834, 'recall': 0.5084477935017193, 'f1-score': 0.5897391646331902, 'support': 1397939}, '2': {'precision': 0.3596335972114542, 'recall': 0.6662564500433068, 'f1-score': 0.4671225818704247, 'support': 598058}, 'accuracy': 0.5089758861806398, 'macro avg': {'precision': 0.5021753599292468, 'recall': 0.5086882717788227, 'f1-score': 0.4831686863272053, 'support': 2588101}, 'weighted avg': {'precision': 0.5640562217335073, 'recall': 0.5089758861806398, 'f1-score': 0.516313715396692, 'support': 2588101}}
[[208042 164060 220002]
 [197661 710779 489499]
 [ 61890 137708 398460]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9571687
{'0': {'precision': 0.4158330503826364, 'recall': 0.36308695751328424, 'f1-score': 0.3876741014902114, 'support': 87698}, '1': {'precision': 0.7595474758043421, 'recall': 0.49781028154636203, 'f1-score': 0.6014366882734792, 'support': 256654}, '2': {'precision': 0.32924478804167423, 'recall': 0.7051114474408365, 'f1-score': 0.4488864882225418, 'support': 87216}, 'accuracy': 0.5123271419567715, 'macro avg': {'precision': 0.5015417714095509, 'recall': 0.5220028955001609, 'f1-score': 0.4793324259954108, 'support': 431568}, 'weighted avg': {'precision': 0.602741718898034, 'recall': 0.5123271419567715, 'f1-score': 0.5271694358744098, 'support': 431568}}
[[ 31842  23136  32720]
 [ 36324 127765  92565]
 [  8408  17311  61497]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9802787
{'0': {'precision': 0.4048683556880278, 'recall': 0.32140392388839595, 'f1-score': 0.35834020335256933, 'support': 40572}, '1': {'precision': 0.7376241756407046, 'recall': 0.4539103275387334, 'f1-score': 0.5619899889968009, 'support': 97332}, '2': {'precision': 0.35476894158145644, 'recall': 0.7370030581039755, 'f1-score': 0.47897508809747674, 'support': 42510}, 'accuracy': 0.4908155686365803, 'macro avg': {'precision': 0.49908715763672956, 'recall': 0.5041057698437016, 'f1-score': 0.4664350934822823, 'support': 180414}, 'weighted avg': {'precision': 0.5725829641661038, 'recall': 0.4908155686365803, 'f1-score': 0.4966322975738069, 'support': 180414}}
[[13040  8815 18717]
 [14888 44180 38264]
 [ 4280  6900 31330]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
6546/6546 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0227011
{'0': {'precision': 0.4768203007884201, 'recall': 0.23989166619646787, 'f1-score': 0.31919438128998595, 'support': 531690}, '1': {'precision': 0.5790400945710641, 'recall': 0.4081593586018963, 'f1-score': 0.47881030088759435, 'support': 621642}, '2': {'precision': 0.4054642747063911, 'recall': 0.7528831227497287, 'f1-score': 0.5270736740546191, 'support': 522437}, 'accuracy': 0.46224211093533774, 'macro avg': {'precision': 0.48710822335529186, 'recall': 0.4669780491826976, 'f1-score': 0.44169278541073315, 'support': 1675769}, 'weighted avg': {'precision': 0.49249375509412296, 'recall': 0.46224211093533774, 'f1-score': 0.44321373811337456, 'support': 1675769}}
[[127548 105604 298538]
 [ 89702 253729 278211]
 [ 50247  78856 393334]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0313069
{'0': {'precision': 0.4776454563860921, 'recall': 0.24780839970205695, 'f1-score': 0.3263186353719341, 'support': 104718}, '1': {'precision': 0.5507913007230232, 'recall': 0.3577276758623909, 'f1-score': 0.4337461230218922, 'support': 107115}, '2': {'precision': 0.4117314221048661, 'recall': 0.7634572602659879, 'f1-score': 0.5349597868002682, 'support': 102937}, 'accuracy': 0.45384248816596245, 'macro avg': {'precision': 0.48005605973799376, 'recall': 0.4563311119434786, 'f1-score': 0.4316748483980315, 'support': 314770}, 'weighted avg': {'precision': 0.4809813021444039, 'recall': 0.45384248816596245, 'f1-score': 0.4311062248633205, 'support': 314770}}
[[25950 17594 61174]
 [17687 38318 51110]
 [10692 13657 78588]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9999978
{'0': {'precision': 0.48205419942076955, 'recall': 0.27595701216804336, 'f1-score': 0.3509875171803513, 'support': 33777}, '1': {'precision': 0.6076417529202033, 'recall': 0.4886069449496138, 'f1-score': 0.5416617252911459, 'support': 46739}, '2': {'precision': 0.40536140847562596, 'recall': 0.695941430220548, 'f1-score': 0.5123164827300886, 'support': 32918}, 'accuracy': 0.4854540966553238, 'macro avg': {'precision': 0.498352453605533, 'recall': 0.4868351291127351, 'f1-score': 0.46832190840052856, 'support': 113434}, 'weighted avg': {'precision': 0.5115450343615968, 'recall': 0.4854540966553238, 'f1-score': 0.4763692254940552, 'support': 113434}}
[[ 9321  8155 16301]
 [ 6597 22837 17305]
 [ 3418  6591 22909]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
7633/7633 - 107s - 107s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0607395
{'0': {'precision': 0.44311844112089965, 'recall': 0.23521717327339847, 'f1-score': 0.30730825548306634, 'support': 662052}, '1': {'precision': 0.5382182413710135, 'recall': 0.2211261430040578, 'f1-score': 0.31346547431636307, 'support': 627185}, '2': {'precision': 0.40174052962424844, 'recall': 0.8127735046656568, 'f1-score': 0.5377032278097101, 'support': 664751}, 'accuracy': 0.4271802078620749, 'macro avg': {'precision': 0.4610257373720539, 'recall': 0.423038940314371, 'f1-score': 0.38615898586971314, 'support': 1953988}, 'weighted avg': {'precision': 0.4595664234905751, 'recall': 0.4271802078620749, 'f1-score': 0.38766545498637445, 'support': 1953988}}
[[155726  65514 440812]
 [124724 138687 363774]
 [ 70982  53477 540292]]
Evaluating performance on  train set...
1586/1586 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.03331
{'0': {'precision': 0.4612782505626806, 'recall': 0.2607052801926913, 'f1-score': 0.33313135393523197, 'support': 132855}, '1': {'precision': 0.5785779809834443, 'recall': 0.2926274238329148, 'f1-score': 0.3886747789341889, 'support': 135787}, '2': {'precision': 0.41944014103317484, 'recall': 0.8012435489984546, 'f1-score': 0.5506319285467397, 'support': 137188}, 'accuracy': 0.45411132740309984, 'macro avg': {'precision': 0.48643212419309984, 'recall': 0.45152541767468685, 'f1-score': 0.4241460204720535, 'support': 405830}, 'weighted avg': {'precision': 0.4863825847038491, 'recall': 0.45411132740309984, 'f1-score': 0.4252402268133752, 'support': 405830}}
[[ 34636  16322  81897]
 [ 25804  39735  70248]
 [ 14647  12620 109921]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.027994
{'0': {'precision': 0.4510932582408481, 'recall': 0.24229819605400715, 'f1-score': 0.3152593878879965, 'support': 44957}, '1': {'precision': 0.6192794213431148, 'recall': 0.3293828060898897, 'f1-score': 0.4300371357836602, 'support': 54845}, '2': {'precision': 0.4094446107144384, 'recall': 0.8137573555966265, 'f1-score': 0.5447809484530217, 'support': 47073}, 'accuracy': 0.4579676595744681, 'macro avg': {'precision': 0.49327243009946703, 'recall': 0.4618127859135078, 'f1-score': 0.4300258240415595, 'support': 146875}, 'weighted avg': {'precision': 0.5005478511282226, 'recall': 0.4579676595744681, 'f1-score': 0.43167984067992915, 'support': 146875}}
[[10893  6682 27382]
 [ 8912 18065 27868]
 [ 4343  4424 38306]]
testing model on single stock: results/universal/W10/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
22048/22048 - 303s - 303s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.115909
{'0': {'precision': 0.4325446743475194, 'recall': 0.06897791351291054, 'f1-score': 0.11898179607382468, 'support': 2133567}, '1': {'precision': 0.20401877747696281, 'recall': 0.006232028102546983, 'f1-score': 0.012094610065148044, 'support': 1318030}, '2': {'precision': 0.39144519296515085, 'recall': 0.939760662740807, 'f1-score': 0.5526790501872443, 'support': 2192471}, 'accuracy': 0.39258580867558646, 'macro avg': {'precision': 0.342669548263211, 'recall': 0.3383235347854215, 'f1-score': 0.22791848544207235, 'support': 5644068}, 'weighted avg': {'precision': 0.3632128716658043, 'recall': 0.39258580867558646, 'f1-score': 0.26249320214623334, 'support': 5644068}}
[[ 147169   16984 1969414]
 [  76061    8214 1233755]
 [ 117010   15063 2060398]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1807685
{'0': {'precision': 0.3954400487165461, 'recall': 0.0837367580173143, 'f1-score': 0.1382073055473389, 'support': 457541}, '1': {'precision': 0.30576056743026936, 'recall': 0.006940093288777499, 'f1-score': 0.013572129058609047, 'support': 459648}, '2': {'precision': 0.3452477863133501, 'recall': 0.9368714386371764, 'f1-score': 0.5045596134199921, 'support': 472607}, 'accuracy': 0.34845042006164934, 'macro avg': {'precision': 0.34881613415338847, 'recall': 0.34251609664775606, 'f1-score': 0.21877968267531336, 'support': 1389796}, 'weighted avg': {'precision': 0.3487121773081798, 'recall': 0.34845042006164934, 'f1-score': 0.2215665579585412, 'support': 1389796}}
[[ 38313   3953 415275]
 [ 32029   3190 424429]
 [ 26545   3290 442772]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1866846
{'0': {'precision': 0.3788476927180581, 'recall': 0.09195260908973196, 'f1-score': 0.14798645480593905, 'support': 154460}, '1': {'precision': 0.31787819253438115, 'recall': 0.009650252886725833, 'f1-score': 0.018731838336594232, 'support': 167664}, '2': {'precision': 0.3399669452965061, 'recall': 0.9282667772667339, 'f1-score': 0.49766855284336986, 'support': 161543}, 'accuracy': 0.3427482131301081, 'macro avg': {'precision': 0.34556427684964847, 'recall': 0.34328987974773056, 'f1-score': 0.22146228199530105, 'support': 483667}, 'weighted avg': {'precision': 0.34472648358136737, 'recall': 0.3427482131301081, 'f1-score': 0.21997265429348825, 'support': 483667}}
[[ 14203   1959 138298]
 [ 13212   1618 152834]
 [ 10075   1513 149955]]
training model: results/universal/W10/deepVOL_L3/h100
Epoch 1/50
8543/8543 - 430s - loss: 3.1985 - accuracy100: 0.4107 - val_loss: 3.3050 - val_accuracy100: 0.3702 - 430s/epoch - 50ms/step
Epoch 2/50
8543/8543 - 425s - loss: 3.1511 - accuracy100: 0.4299 - val_loss: 3.2910 - val_accuracy100: 0.3889 - 425s/epoch - 50ms/step
Epoch 3/50
8543/8543 - 429s - loss: 3.1295 - accuracy100: 0.4356 - val_loss: 3.4680 - val_accuracy100: 0.3867 - 429s/epoch - 50ms/step
Epoch 4/50
8543/8543 - 431s - loss: 3.1176 - accuracy100: 0.4385 - val_loss: 3.3366 - val_accuracy100: 0.3928 - 431s/epoch - 50ms/step
Epoch 5/50
8543/8543 - 431s - loss: 3.1102 - accuracy100: 0.4410 - val_loss: 3.4306 - val_accuracy100: 0.3890 - 431s/epoch - 50ms/step
Epoch 6/50
8543/8543 - 440s - loss: 3.1046 - accuracy100: 0.4433 - val_loss: 3.3941 - val_accuracy100: 0.3997 - 440s/epoch - 51ms/step
Epoch 7/50
8543/8543 - 431s - loss: 3.1002 - accuracy100: 0.4449 - val_loss: 3.3596 - val_accuracy100: 0.3927 - 431s/epoch - 50ms/step
Epoch 8/50
8543/8543 - 435s - loss: 3.0967 - accuracy100: 0.4465 - val_loss: 3.4725 - val_accuracy100: 0.3925 - 435s/epoch - 51ms/step
Epoch 9/50
8543/8543 - 428s - loss: 3.0934 - accuracy100: 0.4477 - val_loss: 3.4266 - val_accuracy100: 0.3910 - 428s/epoch - 50ms/step
Epoch 10/50
8543/8543 - 429s - loss: 3.0909 - accuracy100: 0.4489 - val_loss: 3.3548 - val_accuracy100: 0.3918 - 429s/epoch - 50ms/step
Epoch 11/50
8543/8543 - 426s - loss: 3.0884 - accuracy100: 0.4498 - val_loss: 3.3600 - val_accuracy100: 0.3924 - 426s/epoch - 50ms/step
Epoch 12/50
8543/8543 - 432s - loss: 3.0858 - accuracy100: 0.4509 - val_loss: 3.3380 - val_accuracy100: 0.3977 - 432s/epoch - 51ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1002s - 1002s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0705322
{'0': {'precision': 0.40529392760104255, 'recall': 0.34726066489587676, 'f1-score': 0.3740396781315916, 'support': 3330717}, '1': {'precision': 0.4892371964040582, 'recall': 0.2489470398410228, 'f1-score': 0.32998307426460693, 'support': 2843175}, '2': {'precision': 0.3955441824655145, 'recall': 0.6153330958445292, 'f1-score': 0.48154495419403104, 'support': 3371387}, 'accuracy': 0.4126598080579939, 'macro avg': {'precision': 0.4300251021568718, 'recall': 0.4038469335271429, 'f1-score': 0.39518923553007657, 'support': 9545279}, 'weighted avg': {'precision': 0.4268538253552917, 'recall': 0.4126598080579939, 'f1-score': 0.3988876951930945, 'support': 9545279}}
[[1156627  408123 1765967]
 [ 731129  707800 1404246]
 [ 966042  330819 2074526]]
Evaluating performance on  train set...
8543/8543 - 237s - 237s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1027554
{'0': {'precision': 0.36986441516857893, 'recall': 0.3877079281530154, 'f1-score': 0.37857603268302653, 'support': 690022}, '1': {'precision': 0.5694114326222025, 'recall': 0.22293554362500392, 'f1-score': 0.3204203488707908, 'support': 796275}, '2': {'precision': 0.366491787449681, 'recall': 0.6025944322216717, 'f1-score': 0.45578175829812506, 'support': 700423}, 'accuracy': 0.39653727957854684, 'macro avg': {'precision': 0.43525587841348745, 'recall': 0.4044126346665637, 'f1-score': 0.3849260466173141, 'support': 2186720}, 'weighted avg': {'precision': 0.44144744148110654, 'recall': 0.39653727957854684, 'f1-score': 0.3821287275067425, 'support': 2186720}}
[[267527  75245 347250]
 [236426 177518 382331]
 [219358  58994 422071]]
Evaluating performance on  val set...
3077/3077 - 82s - 82s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1137105
{'0': {'precision': 0.3553160857877467, 'recall': 0.38654499151103566, 'f1-score': 0.37027324270644657, 'support': 235600}, '1': {'precision': 0.5622799849132512, 'recall': 0.23226933089242474, 'f1-score': 0.32874081764849106, 'support': 308082}, '2': {'precision': 0.3557113532917505, 'recall': 0.589835608667234, 'f1-score': 0.44378805288316553, 'support': 243261}, 'accuracy': 0.3889887831774347, 'macro avg': {'precision': 0.4244358079975828, 'recall': 0.40288331035689806, 'f1-score': 0.3809340377460344, 'support': 786943}, 'weighted avg': {'precision': 0.4364630114719133, 'recall': 0.3889887831774347, 'f1-score': 0.37673863303547145, 'support': 786943}}
[[ 91070  31165 113365]
 [ 90001  71558 146523]
 [ 75236  24541 143484]]
testing model out of sample: results/universal/W10/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 578s - 578s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0563444
{'0': {'precision': 0.4342055355098627, 'recall': 0.4245510991777144, 'f1-score': 0.42932404810316405, 'support': 1787700}, '1': {'precision': 0.4924678021605, 'recall': 0.3275762317008057, 'f1-score': 0.3934441083757673, 'support': 1882255}, '2': {'precision': 0.4100554976932514, 'recall': 0.5634628141814697, 'f1-score': 0.47467216976306, 'support': 1790844}, 'accuracy': 0.43668078609009414, 'macro avg': {'precision': 0.445576278454538, 'recall': 0.4385300483533299, 'f1-score': 0.43248010874733045, 'support': 5460799}, 'weighted avg': {'precision': 0.446367765321076, 'recall': 0.43668078609009414, 'f1-score': 0.43182848300990634, 'support': 5460799}}
[[ 758970  346255  682475]
 [ 496399  616582  769274]
 [ 492582  289188 1009074]]
Evaluating performance on  train set...
4055/4055 - 111s - 111s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0600293
{'0': {'precision': 0.41231761571057973, 'recall': 0.4417069329217111, 'f1-score': 0.42650659097980587, 'support': 318091}, '1': {'precision': 0.5444781075994211, 'recall': 0.31401368252432293, 'f1-score': 0.3983114983464767, 'support': 398903}, '2': {'precision': 0.3884249526956514, 'recall': 0.5655847681333974, 'f1-score': 0.4605555520266279, 'support': 320486}, 'accuracy': 0.4308767397925743, 'macro avg': {'precision': 0.44840689200188405, 'recall': 0.4404351278598105, 'f1-score': 0.4284578804509702, 'support': 1037480}, 'weighted avg': {'precision': 0.45575166041209897, 'recall': 0.4308767397925743, 'f1-score': 0.42618379757013913, 'support': 1037480}}
[[140503  58688 118900]
 [107145 125261 166497]
 [ 93116  46108 181262]]
Evaluating performance on  val set...
1545/1545 - 41s - 41s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0589045
{'0': {'precision': 0.40273479040680604, 'recall': 0.4205610574731695, 'f1-score': 0.4114549338998099, 'support': 120665}, '1': {'precision': 0.5487793643482266, 'recall': 0.3207646227367571, 'f1-score': 0.4048765982753494, 'support': 148570}, '2': {'precision': 0.3985740886196233, 'recall': 0.5774170446407257, 'f1-score': 0.4716097605360561, 'support': 125670}, 'accuracy': 0.43293197098036235, 'macro avg': {'precision': 0.45002941445821865, 'recall': 0.43958090828355073, 'f1-score': 0.42931376423707174, 'support': 394905}, 'weighted avg': {'precision': 0.45635519773738326, 'recall': 0.43293197098036235, 'f1-score': 0.42812302809879693, 'support': 394905}}
[[50747 22285 47633]
 [39052 47656 61862]
 [36207 16899 72564]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0671874
{'0': {'precision': 0.448601364990868, 'recall': 0.4221285525625486, 'f1-score': 0.4349625321552399, 'support': 55277}, '1': {'precision': 0.26453042440770413, 'recall': 0.05655564463231543, 'f1-score': 0.09318802725989972, 'support': 27442}, '2': {'precision': 0.4076249866181351, 'recall': 0.610551001182578, 'f1-score': 0.48886606376234765, 'support': 49891}, 'accuracy': 0.41736671442575973, 'macro avg': {'precision': 0.37358559200556907, 'recall': 0.3630783994591473, 'f1-score': 0.3390055410591624, 'support': 132610}, 'weighted avg': {'precision': 0.39509388256211303, 'recall': 0.41736671442575973, 'f1-score': 0.3845162998354472, 'support': 132610}}
[[23334  2480 29463]
 [11086  1552 14804]
 [17595  1835 30461]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1343019
{'0': {'precision': 0.3649923896499239, 'recall': 0.41941407958023613, 'f1-score': 0.3903153611393693, 'support': 11435}, '1': {'precision': 0.34665002080732416, 'recall': 0.07369724851809255, 'f1-score': 0.12155260469867211, 'support': 11303}, '2': {'precision': 0.3628860489882854, 'recall': 0.588260681916271, 'f1-score': 0.44887205664416263, 'support': 11585}, 'accuracy': 0.362555720653789, 'macro avg': {'precision': 0.3581761531485112, 'recall': 0.3604573366715333, 'f1-score': 0.32024667416073466, 'support': 34323}, 'weighted avg': {'precision': 0.35824106396181427, 'recall': 0.362555720653789, 'f1-score': 0.3215729400623606, 'support': 34323}}
[[4796  861 5778]
 [4283  833 6187]
 [4061  709 6815]]
Evaluating performance on  val set...
46/46 - 1s - 783ms/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1106414
{'0': {'precision': 0.39426118391323994, 'recall': 0.4011494252873563, 'f1-score': 0.39767547857793983, 'support': 4350}, '1': {'precision': 0.3309776207302709, 'recall': 0.08494558645707376, 'f1-score': 0.13519364926629782, 'support': 3308}, '2': {'precision': 0.37287341969720617, 'recall': 0.5936878727634195, 'f1-score': 0.45805771258747957, 'support': 4024}, 'accuracy': 0.3779318609827084, 'macro avg': {'precision': 0.3660374081135724, 'recall': 0.35992762816928314, 'f1-score': 0.33030894681057243, 'support': 11682}, 'weighted avg': {'precision': 0.36897387093476186, 'recall': 0.3779318609827084, 'f1-score': 0.3441476766854108, 'support': 11682}}
[[1745  351 2254]
 [1263  281 1764]
 [1418  217 2389]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97249794
{'0': {'precision': 0.5120482706048038, 'recall': 0.32996960992464924, 'f1-score': 0.4013225182529797, 'support': 120105}, '1': {'precision': 0.5922133406311885, 'recall': 0.6803101885408389, 'f1-score': 0.6332122906730772, 'support': 229022}, '2': {'precision': 0.4367905946550786, 'recall': 0.46776099803020355, 'f1-score': 0.4517456077425798, 'support': 121840}, 'accuracy': 0.5359802279140576, 'macro avg': {'precision': 0.5136840686303569, 'recall': 0.49268026549856386, 'f1-score': 0.49542680555621227, 'support': 470967}, 'weighted avg': {'precision': 0.5315616747920785, 'recall': 0.5359802279140576, 'f1-score': 0.5271305020026021, 'support': 470967}}
[[ 39631  56792  23682]
 [ 23411 155806  49805]
 [ 14355  50493  56992]]
Evaluating performance on  train set...
529/529 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9119728
{'0': {'precision': 0.4811463863907249, 'recall': 0.3411046243662621, 'f1-score': 0.3991998921202859, 'support': 26036}, '1': {'precision': 0.7036348591507069, 'recall': 0.7057083062711986, 'f1-score': 0.704670057467468, 'support': 83142}, '2': {'precision': 0.4008523065919657, 'recall': 0.5129466498875034, 'f1-score': 0.45002425600963547, 'support': 26223}, 'accuracy': 0.5982673687786648, 'macro avg': {'precision': 0.5285445173777991, 'recall': 0.519919860174988, 'f1-score': 0.5179647351991298, 'support': 135401}, 'weighted avg': {'precision': 0.6022133279025864, 'recall': 0.5982673687786648, 'f1-score': 0.5966147397326803, 'support': 135401}}
[[ 8881 13749  3406]
 [ 7769 58674 16699]
 [ 1808 10964 13451]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9383703
{'0': {'precision': 0.5428494551325171, 'recall': 0.3265091438744133, 'f1-score': 0.4077611035319085, 'support': 12358}, '1': {'precision': 0.634825485835831, 'recall': 0.7021208340759223, 'f1-score': 0.6667795003723512, 'support': 28055}, '2': {'precision': 0.4335841313269494, 'recall': 0.5003551977267345, 'f1-score': 0.4645827989299718, 'support': 12669}, 'accuracy': 0.5665197242002938, 'macro avg': {'precision': 0.5370863574317659, 'recall': 0.5096617252256901, 'f1-score': 0.5130411342780772, 'support': 53082}, 'weighted avg': {'precision': 0.565382614284183, 'recall': 0.5665197242002938, 'f1-score': 0.5582195486235909, 'support': 53082}}
[[ 4035  6160  2163]
 [ 2239 19698  6118]
 [ 1159  5171  6339]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
967/967 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1337608
{'0': {'precision': 0.3697126723707542, 'recall': 0.46829922478929753, 'f1-score': 0.4132069209345282, 'support': 91717}, '1': {'precision': 0.3338188559322034, 'recall': 0.03475467692350111, 'f1-score': 0.06295496260410294, 'support': 72537}, '2': {'precision': 0.34897789408220464, 'recall': 0.5187969022032779, 'f1-score': 0.4172710504205739, 'support': 83285}, 'accuracy': 0.35824657932689397, 'macro avg': {'precision': 0.3508364741283874, 'recall': 0.3406169346386922, 'f1-score': 0.2978109779864017, 'support': 247539}, 'weighted avg': {'precision': 0.35221835522167866, 'recall': 0.35824657932689397, 'f1-score': 0.3119390589928998, 'support': 247539}}
[[42951  2971 45795]
 [35206  2521 34810]
 [38017  2060 43208]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1517272
{'0': {'precision': 0.33228020906466965, 'recall': 0.46536654648749043, 'f1-score': 0.38772073548152197, 'support': 18306}, '1': {'precision': 0.34440858173533323, 'recall': 0.09882327304423622, 'f1-score': 0.15357913897472802, 'support': 18356}, '2': {'precision': 0.3660883280757098, 'recall': 0.47360097944192214, 'f1-score': 0.4129617685652648, 'support': 19603}, 'accuracy': 0.348653692348707, 'macro avg': {'precision': 0.34759237295857087, 'recall': 0.3459302663245496, 'f1-score': 0.31808721434050496, 'support': 56265}, 'weighted avg': {'precision': 0.3480159056027683, 'recall': 0.348653692348707, 'f1-score': 0.3201280371088552, 'support': 56265}}
[[8519 1567 8220]
 [8686 1814 7856]
 [8433 1886 9284]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1511949
{'0': {'precision': 0.33937717680803114, 'recall': 0.4820311363305689, 'f1-score': 0.3983168019236549, 'support': 6873}, '1': {'precision': 0.4088050314465409, 'recall': 0.05052860696517413, 'f1-score': 0.08994050089940502, 'support': 6432}, '2': {'precision': 0.3500633981403212, 'recall': 0.49329958308516975, 'f1-score': 0.4095179233621755, 'support': 6716}, 'accuracy': 0.3471854552719644, 'macro avg': {'precision': 0.3660818687982978, 'recall': 0.34195310879363755, 'f1-score': 0.2992584087284118, 'support': 20021}, 'weighted avg': {'precision': 0.36526642427332034, 'recall': 0.3471854552719644, 'f1-score': 0.303004398117308, 'support': 20021}}
[[3313  240 3320]
 [3276  325 2831]
 [3173  230 3313]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1588/1588 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062807
{'0': {'precision': 0.3622162278713845, 'recall': 0.5603823295141229, 'f1-score': 0.4400171058961886, 'support': 146889}, '1': {'precision': 0.26868307760238436, 'recall': 0.021198951374796417, 'f1-score': 0.03929736187800704, 'support': 114817}, '2': {'precision': 0.3530204264131407, 'recall': 0.4150297413196846, 'f1-score': 0.38152189117359075, 'support': 144580}, 'accuracy': 0.35628350472327375, 'macro avg': {'precision': 0.32797324396230315, 'recall': 0.33220367406953466, 'f1-score': 0.28694545298259544, 'support': 406286}, 'weighted avg': {'precision': 0.33251123018682566, 'recall': 0.35628350472327375, 'f1-score': 0.3059571653776161, 'support': 406286}}
[[82314  3488 61087]
 [63499  2434 48884]
 [81438  3137 60005]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1250132
{'0': {'precision': 0.3352261972364187, 'recall': 0.550534291820478, 'f1-score': 0.4167120104707423, 'support': 25735}, '1': {'precision': 0.3361522198731501, 'recall': 0.01918513453726421, 'f1-score': 0.0362986074119169, 'support': 24863}, '2': {'precision': 0.3305876065017135, 'recall': 0.4224248754619958, 'f1-score': 0.3709060124517187, 'support': 24892}, 'accuracy': 0.3332891773744867, 'macro avg': {'precision': 0.3339886745370941, 'recall': 0.330714767273246, 'f1-score': 0.274638876778126, 'support': 75490}, 'weighted avg': {'precision': 0.3340016628643001, 'recall': 0.3332891773744867, 'f1-score': 0.27631697347324446, 'support': 75490}}
[[14168   526 11041]
 [14135   477 10251]
 [13961   416 10515]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1349672
{'0': {'precision': 0.32663929879063575, 'recall': 0.5383560391332175, 'f1-score': 0.40658771536097776, 'support': 10937}, '1': {'precision': 0.3801498127340824, 'recall': 0.017347461972312427, 'f1-score': 0.03318077803203662, 'support': 11702}, '2': {'precision': 0.32026497228606193, 'recall': 0.44218385440970603, 'f1-score': 0.37147673370183076, 'support': 10715}, 'accuracy': 0.32466870540265036, 'macro avg': {'precision': 0.34235136127026, 'recall': 0.33262911850507865, 'f1-score': 0.2704150756982817, 'support': 33354}, 'weighted avg': {'precision': 0.34336530243846525, 'recall': 0.32466870540265036, 'f1-score': 0.26430126848501, 'support': 33354}}
[[5888  177 4872]
 [6315  203 5184]
 [5823  154 4738]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0901105
{'0': {'precision': 0.394455177212756, 'recall': 0.4135382370727306, 'f1-score': 0.40377135680746773, 'support': 208358}, '1': {'precision': 0.2339119312991047, 'recall': 0.051695592831587533, 'f1-score': 0.08467715264640906, 'support': 123821}, '2': {'precision': 0.3975057897649253, 'recall': 0.5638718492891822, 'f1-score': 0.46629402572424566, 'support': 206382}, 'accuracy': 0.38795605326044774, 'macro avg': {'precision': 0.34195763275892865, 'recall': 0.3430352263978334, 'f1-score': 0.3182475117260408, 'support': 538561}, 'weighted avg': {'precision': 0.3587135736942458, 'recall': 0.38795605326044774, 'f1-score': 0.3543674638463287, 'support': 538561}}
[[ 86164  11127 111067]
 [ 52102   6401  65318]
 [ 80172   9837 116373]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1522846
{'0': {'precision': 0.3492078008184915, 'recall': 0.4201694542253521, 'f1-score': 0.3814161391417263, 'support': 36352}, '1': {'precision': 0.40174170226749917, 'recall': 0.06700465881063306, 'f1-score': 0.11485343855693349, 'support': 36490}, '2': {'precision': 0.3556453099599457, 'recall': 0.5789861399105096, 'f1-score': 0.44063080740440813, 'support': 36652}, 'accuracy': 0.35563592525617843, 'macro avg': {'precision': 0.3688649376819788, 'recall': 0.35538675098216493, 'f1-score': 0.31230012836768933, 'support': 109494}, 'weighted avg': {'precision': 0.3688701535403472, 'recall': 0.35563592525617843, 'f1-score': 0.3124028879756781, 'support': 109494}}
[[15274  1857 19221]
 [14818  2445 19227]
 [13647  1784 21221]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1372796
{'0': {'precision': 0.34981645432951847, 'recall': 0.40135436452225615, 'f1-score': 0.3738173986616414, 'support': 12109}, '1': {'precision': 0.3541543901001768, 'recall': 0.053341617111919766, 'f1-score': 0.09271829682196853, 'support': 11267}, '2': {'precision': 0.3659892732372189, 'recall': 0.5932838797160406, 'f1-score': 0.4527084601339014, 'support': 12537}, 'accuracy': 0.35917355832149916, 'macro avg': {'precision': 0.35665337255563806, 'recall': 0.3493266204500722, 'f1-score': 0.3064147185391704, 'support': 35913}, 'weighted avg': {'precision': 0.35682322494110336, 'recall': 0.35917355832149916, 'f1-score': 0.31316843191561994, 'support': 35913}}
[[4860  532 6717]
 [4498  601 6168]
 [4535  564 7438]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
5267/5267 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0053796
{'0': {'precision': 0.5627150974435574, 'recall': 0.27401444392841434, 'f1-score': 0.36855891155293424, 'support': 406953}, '1': {'precision': 0.4753371833376211, 'recall': 0.637469739425478, 'f1-score': 0.5445923532702199, 'support': 524610}, '2': {'precision': 0.4796113547485408, 'recall': 0.5139717636441317, 'f1-score': 0.49619742787626, 'support': 416626}, 'accuracy': 0.48959604328473233, 'macro avg': {'precision': 0.5058878785099065, 'recall': 0.47515198233267464, 'f1-score': 0.46978289756647135, 'support': 1348189}, 'weighted avg': {'precision': 0.503033177903219, 'recall': 0.48959604328473233, 'f1-score': 0.4765010682987816, 'support': 1348189}}
[[111511 207689  87753]
 [ 45600 334423 144587]
 [ 41055 161437 214134]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9550141
{'0': {'precision': 0.5542993440667859, 'recall': 0.326684098065677, 'f1-score': 0.4110878198494618, 'support': 71136}, '1': {'precision': 0.5673834291601582, 'recall': 0.6658242461116052, 'f1-score': 0.6126748179596407, 'support': 128202}, '2': {'precision': 0.4810185948056228, 'recall': 0.5276190476190477, 'f1-score': 0.5032423185561405, 'support': 71925}, 'accuracy': 0.5402432325824016, 'macro avg': {'precision': 0.534233789344189, 'recall': 0.5067091305987766, 'f1-score': 0.5090016521217476, 'support': 271263}, 'weighted avg': {'precision': 0.5410527456974225, 'recall': 0.5402432325824016, 'f1-score': 0.5307947782300705, 'support': 271263}}
[[23239 36857 11040]
 [12938 85360 29904]
 [ 5748 28228 37949]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96239203
{'0': {'precision': 0.5448601280754971, 'recall': 0.31642200039146606, 'f1-score': 0.4003467062902427, 'support': 25545}, '1': {'precision': 0.5901946382666177, 'recall': 0.6276753632244961, 'f1-score': 0.6083582541545216, 'support': 51208}, '2': {'precision': 0.4402099029638533, 'recall': 0.5633887367275728, 'f1-score': 0.4942400105325521, 'support': 26653}, 'accuracy': 0.5342146490532464, 'macro avg': {'precision': 0.5250882231019894, 'recall': 0.5024953667811783, 'f1-score': 0.5009816569924389, 'support': 103406}, 'weighted avg': {'precision': 0.5403366685853926, 'recall': 0.5342146490532464, 'f1-score': 0.5275578311863248, 'support': 103406}}
[[ 8083 12813  4649]
 [ 4620 32142 14446]
 [ 2132  9505 15016]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
10110/10110 - 145s - 145s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0234141
{'0': {'precision': 0.4916950190355865, 'recall': 0.37368470981570556, 'f1-score': 0.4246434354316032, 'support': 780056}, '1': {'precision': 0.5198852782992123, 'recall': 0.46535765813353935, 'f1-score': 0.4911125706384357, 'support': 1014712}, '2': {'precision': 0.4239327530706665, 'recall': 0.5808481432135055, 'f1-score': 0.49013780691715, 'support': 793333}, 'accuracy': 0.4731287534760042, 'macro avg': {'precision': 0.4785043501351551, 'recall': 0.47329683705425013, 'f1-score': 0.46863127099572965, 'support': 2588101}, 'weighted avg': {'precision': 0.48197629191217223, 'recall': 0.4731287534760042, 'f1-score': 0.47077991748455966, 'support': 2588101}}
[[291495 239466 249095]
 [165430 472204 377078]
 [135912 196615 460806]]
Evaluating performance on  train set...
1686/1686 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0115687
{'0': {'precision': 0.46962816782287375, 'recall': 0.3955981510538145, 'f1-score': 0.4294461017198836, 'support': 117905}, '1': {'precision': 0.5994218287445623, 'recall': 0.4379267803562997, 'f1-score': 0.5061034819623846, 'support': 196969}, '2': {'precision': 0.38482694176174825, 'recall': 0.6211201946972423, 'f1-score': 0.4752213636855373, 'support': 116694}, 'accuracy': 0.4758971934897861, 'macro avg': {'precision': 0.4846256461097281, 'recall': 0.48488170870245223, 'f1-score': 0.4702569824559352, 'support': 431568}, 'weighted avg': {'precision': 0.5059365440790075, 'recall': 0.4758971934897861, 'f1-score': 0.4768101925440531, 'support': 431568}}
[[46643 33044 38218]
 [33063 86258 77648]
 [19613 24600 72481]]
Evaluating performance on  val set...
705/705 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0198829
{'0': {'precision': 0.45440538194444446, 'recall': 0.3985951420086804, 'f1-score': 0.4246744818074879, 'support': 52532}, '1': {'precision': 0.5765087655292921, 'recall': 0.41382162005706175, 'f1-score': 0.48180242634315423, 'support': 72553}, '2': {'precision': 0.41742143334751686, 'recall': 0.6205606463156753, 'f1-score': 0.4991132689847656, 'support': 55329}, 'accuracy': 0.47279035994989305, 'macro avg': {'precision': 0.48277852694041773, 'recall': 0.4776591361271391, 'f1-score': 0.46853005904513595, 'support': 180414}, 'weighted avg': {'precision': 0.4921667635296432, 'recall': 0.47279035994989305, 'f1-score': 0.4704770659507794, 'support': 180414}}
[[20939 12440 19153]
 [13762 30024 28767]
 [11379  9615 34335]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
6546/6546 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0548466
{'0': {'precision': 0.4397689619947298, 'recall': 0.39501910873954427, 'f1-score': 0.41619459958423277, 'support': 554720}, '1': {'precision': 0.4713722694684459, 'recall': 0.3606019555740808, 'f1-score': 0.40861304847521135, 'support': 575790}, '2': {'precision': 0.4042229862662039, 'recall': 0.5463788768273427, 'f1-score': 0.4646717196727998, 'support': 545259}, 'accuracy': 0.4324426576694043, 'macro avg': {'precision': 0.43845473924312656, 'recall': 0.43399998038032256, 'f1-score': 0.42982645591074803, 'support': 1675769}, 'weighted avg': {'precision': 0.43906188675376917, 'recall': 0.4324426576694043, 'f1-score': 0.42936300448330217, 'support': 1675769}}
[[219125 127294 208301]
 [137364 207631 230795]
 [141784 105557 297918]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0610735
{'0': {'precision': 0.4341589217069729, 'recall': 0.41377903094160423, 'f1-score': 0.42372406456729567, 'support': 107816}, '1': {'precision': 0.44633540192131615, 'recall': 0.3025058607986446, 'f1-score': 0.3606079998121283, 'support': 101522}, '2': {'precision': 0.40980950784872355, 'recall': 0.5566431443963882, 'f1-score': 0.472072072072072, 'support': 105432}, 'accuracy': 0.42574260571210726, 'macro avg': {'precision': 0.4301012771590042, 'recall': 0.42430934537887904, 'f1-score': 0.4188013788171654, 'support': 314770}, 'weighted avg': {'precision': 0.42993035234654337, 'recall': 0.42574260571210726, 'f1-score': 0.4195615268450523, 'support': 314770}}
[[44612 21158 42046]
 [28337 30711 42474]
 [29806 16938 58688]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0473207
{'0': {'precision': 0.4444515042729612, 'recall': 0.3869772073467581, 'f1-score': 0.41372783864910023, 'support': 36152}, '1': {'precision': 0.48946886446886445, 'recall': 0.4322376557891732, 'f1-score': 0.4590764411660688, 'support': 42044}, '2': {'precision': 0.4087755693858886, 'recall': 0.5200351892842954, 'f1-score': 0.4577416413753482, 'support': 35238}, 'accuracy': 0.44508701094909814, 'macro avg': {'precision': 0.44756531270923805, 'recall': 0.44641668414007557, 'f1-score': 0.4435153070635058, 'support': 113434}, 'weighted avg': {'precision': 0.4500544213747639, 'recall': 0.44508701094909814, 'f1-score': 0.4442089556395171, 'support': 113434}}
[[13990 10392 11770]
 [ 9137 18173 14734]
 [ 8350  8563 18325]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
7633/7633 - 108s - 108s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0802481
{'0': {'precision': 0.4101922946959103, 'recall': 0.48386305519613915, 'f1-score': 0.44399241490684627, 'support': 652292}, '1': {'precision': 0.4418703738567791, 'recall': 0.20781895880809578, 'f1-score': 0.28268600516003073, 'support': 643743}, '2': {'precision': 0.40524574695984605, 'recall': 0.5431056625625235, 'f1-score': 0.4641554969884409, 'support': 657953}, 'accuracy': 0.41286845159745095, 'macro avg': {'precision': 0.41910280517084514, 'recall': 0.4115958921889195, 'f1-score': 0.3969446390184393, 'support': 1953988}, 'weighted avg': {'precision': 0.41896304753096786, 'recall': 0.41286845159745095, 'f1-score': 0.39763925829339075, 'support': 1953988}}
[[315620  90115 246557]
 [232075 133782 277886]
 [221749  78866 357338]]
Evaluating performance on  train set...
1586/1586 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0678595
{'0': {'precision': 0.41231471498735867, 'recall': 0.4876913783717271, 'f1-score': 0.4468466006149641, 'support': 134093}, '1': {'precision': 0.47035311629958376, 'recall': 0.2513237839231137, 'f1-score': 0.3276006892612521, 'support': 135785}, '2': {'precision': 0.410542225580956, 'recall': 0.5274582205484288, 'f1-score': 0.4617137926927027, 'support': 135952}, 'accuracy': 0.4219279008451815, 'macro avg': {'precision': 0.4310700189559662, 'recall': 0.4221577942810899, 'f1-score': 0.4120536941896396, 'support': 405830}, 'weighted avg': {'precision': 0.43113976696084816, 'recall': 0.4219279008451815, 'f1-score': 0.4119290696886869, 'support': 405830}}
[[65396 21294 47403]
 [46102 34126 55557]
 [47109 17134 71709]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0704997
{'0': {'precision': 0.3850923278992506, 'recall': 0.4450123881163367, 'f1-score': 0.4128897310842575, 'support': 44801}, '1': {'precision': 0.5232424493965903, 'recall': 0.2979276495182694, 'f1-score': 0.37967381735625266, 'support': 55010}, '2': {'precision': 0.3963249243505119, 'recall': 0.5370984191738909, 'f1-score': 0.45609635076007043, 'support': 47064}, 'accuracy': 0.4194314893617021, 'macro avg': {'precision': 0.4348865672154509, 'recall': 0.42667948560283236, 'f1-score': 0.41621996640019354, 'support': 146875}, 'weighted avg': {'precision': 0.4404338707278519, 'recall': 0.4194314893617021, 'f1-score': 0.41429411531741434, 'support': 146875}}
[[19937  8770 16094]
 [16212 16389 22409]
 [15623  6163 25278]]
testing model on single stock: results/universal/W10/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
22048/22048 - 308s - 308s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964332
{'0': {'precision': 0.3799027587677738, 'recall': 0.3347284793415951, 'f1-score': 0.35588780886892113, 'support': 2102050}, '1': {'precision': 0.23633967600925687, 'recall': 0.005256137521659318, 'f1-score': 0.010283570901116606, 'support': 1398936}, '2': {'precision': 0.38417665529249817, 'recall': 0.674185588792216, 'f1-score': 0.4894474760342368, 'support': 2143082}, 'accuracy': 0.38195925350296983, 'macro avg': {'precision': 0.3334730300231763, 'recall': 0.33805673521849017, 'f1-score': 0.2852062852680915, 'support': 5644068}, 'weighted avg': {'precision': 0.34594210237067347, 'recall': 0.38195925350296983, 'f1-score': 0.3209398083101487, 'support': 5644068}}
[[ 703616   13073 1385361]
 [ 460918    7353  930665]
 [ 687561   10686 1444835]]
Evaluating performance on  train set...
5429/5429 - 101s - 101s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1584667
{'0': {'precision': 0.3408037467253798, 'recall': 0.3843596437179267, 'f1-score': 0.36127363403997553, 'support': 459299}, '1': {'precision': 0.30154313179863396, 'recall': 0.005199042189878442, 'f1-score': 0.010221844905799525, 'support': 458546}, '2': {'precision': 0.3489687935167747, 'recall': 0.6387760593790457, 'f1-score': 0.4513572712940602, 'support': 471951}, 'accuracy': 0.345655765306563, 'macro avg': {'precision': 0.33043855734692945, 'recall': 0.34277824842895027, 'f1-score': 0.2742842500799451, 'support': 1389796}, 'weighted avg': {'precision': 0.33062290296560926, 'recall': 0.345655765306563, 'f1-score': 0.2760393039551161, 'support': 1389796}}
[[176536   3248 279515]
 [173257   2384 282905]
 [168206   2274 301471]]
Evaluating performance on  val set...
1890/1890 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1794311
{'0': {'precision': 0.3203420410103498, 'recall': 0.39375730372888557, 'f1-score': 0.3532758271478441, 'support': 150608}, '1': {'precision': 0.33391695847923963, 'recall': 0.00762539055137, 'f1-score': 0.014910286981141559, 'support': 175073}, '2': {'precision': 0.33668879118640616, 'recall': 0.6277138480624865, 'f1-score': 0.43829041546325004, 'support': 157986}, 'accuracy': 0.3304091451349792, 'macro avg': {'precision': 0.33031593022533184, 'recall': 0.343032180780914, 'f1-score': 0.26882550986407855, 'support': 483667}, 'weighted avg': {'precision': 0.33059529210944355, 'recall': 0.3304091451349792, 'f1-score': 0.2585669562428467, 'support': 483667}}
[[ 59303   1601  89704]
 [ 68067   1335 105671]
 [ 57754   1062  99170]]
training model: results/universal/W10/deepVOL_L3/h200
Epoch 1/50
8543/8543 - 532s - loss: 3.2623 - accuracy200: 0.3808 - val_loss: 3.2745 - val_accuracy200: 0.3656 - 532s/epoch - 62ms/step
Epoch 2/50
8543/8543 - 491s - loss: 3.2495 - accuracy200: 0.3877 - val_loss: 3.2789 - val_accuracy200: 0.3627 - 491s/epoch - 58ms/step
Epoch 3/50
8543/8543 - 458s - loss: 3.2446 - accuracy200: 0.3904 - val_loss: 3.2836 - val_accuracy200: 0.3685 - 458s/epoch - 54ms/step
Epoch 4/50
8543/8543 - 436s - loss: 3.2364 - accuracy200: 0.3943 - val_loss: 3.2742 - val_accuracy200: 0.3698 - 436s/epoch - 51ms/step
Epoch 5/50
8543/8543 - 439s - loss: 3.2271 - accuracy200: 0.3985 - val_loss: 3.2808 - val_accuracy200: 0.3702 - 439s/epoch - 51ms/step
Epoch 6/50
8543/8543 - 434s - loss: 3.2188 - accuracy200: 0.4030 - val_loss: 3.2913 - val_accuracy200: 0.3698 - 434s/epoch - 51ms/step
Epoch 7/50
8543/8543 - 437s - loss: 3.2101 - accuracy200: 0.4057 - val_loss: 3.2873 - val_accuracy200: 0.3719 - 437s/epoch - 51ms/step
Epoch 8/50
8543/8543 - 430s - loss: 3.2053 - accuracy200: 0.4078 - val_loss: 3.2881 - val_accuracy200: 0.3723 - 430s/epoch - 50ms/step
Epoch 9/50
8543/8543 - 436s - loss: 3.2004 - accuracy200: 0.4106 - val_loss: 3.3020 - val_accuracy200: 0.3658 - 436s/epoch - 51ms/step
Epoch 10/50
8543/8543 - 427s - loss: 3.1975 - accuracy200: 0.4119 - val_loss: 3.3131 - val_accuracy200: 0.3603 - 427s/epoch - 50ms/step
Epoch 11/50
8543/8543 - 436s - loss: 3.1942 - accuracy200: 0.4138 - val_loss: 3.3162 - val_accuracy200: 0.3633 - 436s/epoch - 51ms/step
Epoch 12/50
8543/8543 - 426s - loss: 3.1917 - accuracy200: 0.4150 - val_loss: 3.3189 - val_accuracy200: 0.3612 - 426s/epoch - 50ms/step
Epoch 13/50
8543/8543 - 440s - loss: 3.1905 - accuracy200: 0.4153 - val_loss: 3.3135 - val_accuracy200: 0.3622 - 440s/epoch - 52ms/step
Epoch 14/50
8543/8543 - 427s - loss: 3.1875 - accuracy200: 0.4172 - val_loss: 3.3045 - val_accuracy200: 0.3610 - 427s/epoch - 50ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 991s - 991s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116141
{'0': {'precision': 0.510819364315026, 'recall': 0.009806443810914181, 'f1-score': 0.01924346167822107, 'support': 3439983}, '1': {'precision': 0.2750340998073594, 'recall': 0.8940758466921833, 'f1-score': 0.42066419226137935, 'support': 2656042}, '2': {'precision': 0.45107434437006155, 'recall': 0.11050795331396296, 'f1-score': 0.17752447965095902, 'support': 3449254}, 'accuracy': 0.2922499174722918, 'macro avg': {'precision': 0.4123092694974823, 'recall': 0.3381300812723535, 'f1-score': 0.20581071119685315, 'support': 9545279}, 'weighted avg': {'precision': 0.42362114679422647, 'recall': 0.2922499174722918, 'f1-score': 0.18813760866607665, 'support': 9545279}}
[[  33734 3206078  200171]
 [  17653 2374703  263686]
 [  14652 3053432  381170]]
Evaluating performance on  train set...
8543/8543 - 241s - 241s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965834
{'0': {'precision': 0.529026750142288, 'recall': 0.010345566404456552, 'f1-score': 0.02029426133091709, 'support': 718762}, '1': {'precision': 0.33923643261477787, 'recall': 0.9126408768362799, 'f1-score': 0.4946188144461553, 'support': 742670}, '2': {'precision': 0.4390636270996256, 'recall': 0.10574144339903598, 'f1-score': 0.17043608507914781, 'support': 725288}, 'accuracy': 0.34843052608472963, 'macro avg': {'precision': 0.4357756032855638, 'recall': 0.34290929554659083, 'f1-score': 0.2284497202854067, 'support': 2186720}, 'weighted avg': {'precision': 0.43472992718209075, 'recall': 0.34843052608472963, 'f1-score': 0.23118668419475, 'support': 2186720}}
[[  7436 674023  37303]
 [  4201 677791  60678]
 [  2419 646176  76693]]
Evaluating performance on  val set...
3077/3077 - 82s - 82s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904204
{'0': {'precision': 0.5116492386718033, 'recall': 0.011285010237029724, 'f1-score': 0.02208295558467574, 'support': 247142}, '1': {'precision': 0.3624115415196788, 'recall': 0.8989379466969474, 'f1-score': 0.5165665662632347, 'support': 284449}, '2': {'precision': 0.43359452163034173, 'recall': 0.12893965976377705, 'f1-score': 0.1987702505682384, 'support': 255352}, 'accuracy': 0.37031398716298386, 'macro avg': {'precision': 0.43588510060727464, 'recall': 0.3463875388992514, 'f1-score': 0.24580659080538295, 'support': 786943}, 'weighted avg': {'precision': 0.4323780057830224, 'recall': 0.37031398716298386, 'f1-score': 0.25815192464920533, 'support': 786943}}
[[  2789 228498  15855]
 [  1592 255702  27155]
 [  1070 221357  32925]]
testing model out of sample: results/universal/W10/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 590s - 590s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093236
{'0': {'precision': 0.494015778333654, 'recall': 0.013096794565396487, 'f1-score': 0.025517108061086403, 'support': 1960327}, '1': {'precision': 0.2791124239006138, 'recall': 0.8354705428527269, 'f1-score': 0.418434903939801, 'support': 1546331}, '2': {'precision': 0.4544847457887815, 'recall': 0.1814500591308406, 'f1-score': 0.25935452300920264, 'support': 1954141}, 'accuracy': 0.3062128820342957, 'macro avg': {'precision': 0.4092043160076831, 'recall': 0.343339132182988, 'f1-score': 0.23443551167003, 'support': 5460799}, 'weighted avg': {'precision': 0.4190155942155301, 'recall': 0.3062128820342957, 'f1-score': 0.22045785722674063, 'support': 5460799}}
[[  25674 1748953  185700]
 [  14518 1291914  239899]
 [  11778 1587784  354579]]
Evaluating performance on  train set...
4055/4055 - 117s - 117s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944691
{'0': {'precision': 0.45485218508997427, 'recall': 0.016402133262263217, 'f1-score': 0.031662505207648885, 'support': 345199}, '1': {'precision': 0.33070314715380794, 'recall': 0.8271267813507686, 'f1-score': 0.47249327894155835, 'support': 348261}, '2': {'precision': 0.4140112084472469, 'recall': 0.18532062089413406, 'f1-score': 0.256034505261932, 'support': 344020}, 'accuracy': 0.34455796738250377, 'macro avg': {'precision': 0.3998555135636764, 'recall': 0.3429498451690553, 'f1-score': 0.2533967631370464, 'support': 1037480}, 'weighted avg': {'precision': 0.3996353318635812, 'recall': 0.34455796738250377, 'f1-score': 0.2540404031430496, 'support': 1037480}}
[[  5662 305344  34193]
 [  4161 288056  56044]
 [  2625 277641  63754]]
Evaluating performance on  val set...
1545/1545 - 41s - 41s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960448
{'0': {'precision': 0.4256973022405121, 'recall': 0.01440763867932558, 'f1-score': 0.027871956650275802, 'support': 129237}, '1': {'precision': 0.3276657789774302, 'recall': 0.8256513026052105, 'f1-score': 0.4691470915537306, 'support': 131736}, '2': {'precision': 0.4160934059368759, 'recall': 0.18200280739479735, 'f1-score': 0.25323741007194245, 'support': 133932}, 'accuracy': 0.3418695635659209, 'macro avg': {'precision': 0.3898188290516061, 'recall': 0.34068724955977786, 'f1-score': 0.25008548609198294, 'support': 394905}, 'weighted avg': {'precision': 0.38973789481765353, 'recall': 0.3418695635659209, 'f1-score': 0.251509203783921, 'support': 394905}}
[[  1862 114564  12811]
 [  1572 108768  21396]
 [   940 108616  24376]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1219505
{'0': {'precision': 0.48523206751054854, 'recall': 0.0022131131766834093, 'f1-score': 0.004406130268199234, 'support': 51963}, '1': {'precision': 0.278301849051471, 'recall': 0.9447024634020479, 'f1-score': 0.4299452417151828, 'support': 36819}, '2': {'precision': 0.4041948579161028, 'recall': 0.06815277904535913, 'f1-score': 0.1166386817134601, 'support': 43828}, 'accuracy': 0.2856873538948797, 'macro avg': {'precision': 0.3892429248260408, 'recall': 0.3383561185413635, 'f1-score': 0.18366335123228072, 'support': 132610}, 'weighted avg': {'precision': 0.40099511301578844, 'recall': 0.2856873538948797, 'f1-score': 0.15964972282614642, 'support': 132610}}
[[  115 49402  2446]
 [   79 34783  1957]
 [   43 40798  2987]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088147
{'0': {'precision': 0.3262411347517731, 'recall': 0.003973738769868694, 'f1-score': 0.007851839207988395, 'support': 11576}, '1': {'precision': 0.32912969017593025, 'recall': 0.937721788502484, 'f1-score': 0.4872427224744739, 'support': 11272}, '2': {'precision': 0.40686985970004835, 'recall': 0.07328976034858388, 'f1-score': 0.12420617338650125, 'support': 11475}, 'accuracy': 0.3337994930513067, 'macro avg': {'precision': 0.35408022820925056, 'recall': 0.33832842920697886, 'f1-score': 0.20643357835632117, 'support': 34323}, 'weighted avg': {'precision': 0.3541458754656547, 'recall': 0.3337994930513067, 'f1-score': 0.20418840713265293, 'support': 34323}}
[[   46 10949   581]
 [   57 10570   645]
 [   38 10596   841]]
Evaluating performance on  val set...
46/46 - 1s - 804ms/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1179729
{'0': {'precision': 0.5, 'recall': 0.004104903078677309, 'f1-score': 0.0081429540827867, 'support': 4385}, '1': {'precision': 0.29333215422709585, 'recall': 0.971303074670571, 'f1-score': 0.4505875161312232, 'support': 3415}, '2': {'precision': 0.3609467455621302, 'recall': 0.03142709943328181, 'f1-score': 0.05781990521327014, 'support': 3882}, 'accuracy': 0.29592535524738917, 'macro avg': {'precision': 0.3847596332630754, 'recall': 0.3356116923941767, 'f1-score': 0.17218345847576003, 'support': 11682}, 'weighted avg': {'precision': 0.39337652567691506, 'recall': 0.29592535524738917, 'f1-score': 0.15399076299255793, 'support': 11682}}
[[  18 4239  128]
 [  10 3317   88]
 [   8 3752  122]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
1840/1840 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0845876
{'0': {'precision': 0.5207816128773924, 'recall': 0.04233200320272883, 'f1-score': 0.07829939917883762, 'support': 153619}, '1': {'precision': 0.33958638545269615, 'recall': 0.741448057437761, 'f1-score': 0.4658235775596396, 'support': 158502}, '2': {'precision': 0.4474285866790026, 'recall': 0.3166274253050124, 'f1-score': 0.37083187406683754, 'support': 158846}, 'accuracy': 0.37012996664309816, 'macro avg': {'precision': 0.4359321950030304, 'recall': 0.3668024953151674, 'f1-score': 0.30498495026843825, 'support': 470967}, 'weighted avg': {'precision': 0.43506087079402217, 'recall': 0.37012996664309816, 'f1-score': 0.30738332826043596, 'support': 470967}}
[[  6503 123053  24063]
 [  2930 117521  38051]
 [  3054 105497  50295]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0208589
{'0': {'precision': 0.5882352941176471, 'recall': 0.047108967528461665, 'f1-score': 0.08723194350693182, 'support': 35662}, '1': {'precision': 0.4924486596492595, 'recall': 0.7913035314734552, 'f1-score': 0.6070896955728416, 'support': 63911}, '2': {'precision': 0.4336974001608148, 'recall': 0.3613095902645975, 'f1-score': 0.3942079298373835, 'support': 35828}, 'accuracy': 0.4815178617587758, 'macro avg': {'precision': 0.5047937846425739, 'recall': 0.3999073630888381, 'f1-score': 0.3628431896390523, 'support': 135401}, 'weighted avg': {'precision': 0.5021310315184454, 'recall': 0.4815178617587758, 'f1-score': 0.4138393129542165, 'support': 135401}}
[[ 1680 29608  4374]
 [  809 50573 12529]
 [  367 22516 12945]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0503018
{'0': {'precision': 0.5415224913494809, 'recall': 0.039540171803941385, 'f1-score': 0.07369908170473274, 'support': 15832}, '1': {'precision': 0.4186621106584308, 'recall': 0.7452393206381883, 'f1-score': 0.5361338314988723, 'support': 21373}, '2': {'precision': 0.44312369425833875, 'recall': 0.3874157586445802, 'f1-score': 0.41340143826870085, 'support': 15877}, 'accuracy': 0.4277344485889755, 'macro avg': {'precision': 0.46776943208875016, 'recall': 0.3907317503622367, 'f1-score': 0.3410781171574353, 'support': 53082}, 'weighted avg': {'precision': 0.46262243826320165, 'recall': 0.4277344485889755, 'f1-score': 0.3615004498241756, 'support': 53082}}
[[  626 12627  2579]
 [  294 15928  5151]
 [  236  9490  6151]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293284
{'0': {'precision': 0.38844086021505375, 'recall': 0.0029829486808967427, 'f1-score': 0.005920432662760683, 'support': 96884}, '1': {'precision': 0.26643109857538105, 'recall': 0.8812684475163525, 'f1-score': 0.40916165108047436, 'support': 67421}, '2': {'precision': 0.31927862787960315, 'recall': 0.09124876853209025, 'f1-score': 0.14193343424716415, 'support': 83234}, 'accuracy': 0.2718763507972481, 'macro avg': {'precision': 0.324716862223346, 'recall': 0.3251667215764465, 'f1-score': 0.1856718393301331, 'support': 247539}, 'weighted avg': {'precision': 0.33195412727310414, 'recall': 0.2718763507972481, 'f1-score': 0.16148312121210812, 'support': 247539}}
[[  289 88200  8395]
 [  207 59416  7798]
 [  248 75391  7595]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109572
{'0': {'precision': 0.3342857142857143, 'recall': 0.006535217561302575, 'f1-score': 0.012819810442119103, 'support': 17903}, '1': {'precision': 0.3260135805900806, 'recall': 0.8838886795499812, 'f1-score': 0.4763355235484386, 'support': 18577}, '2': {'precision': 0.3647504054784646, 'recall': 0.10229972201162497, 'f1-score': 0.15978526880871557, 'support': 19785}, 'accuracy': 0.3298853639029592, 'macro avg': {'precision': 0.3416832334514199, 'recall': 0.3309078730409696, 'f1-score': 0.2163135342664244, 'support': 56265}, 'weighted avg': {'precision': 0.3422670968074379, 'recall': 0.3298853639029592, 'f1-score': 0.21753753897956174, 'support': 56265}}
[[  117 16291  1495]
 [  127 16420  2030]
 [  106 17655  2024]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135458
{'0': {'precision': 0.2992125984251969, 'recall': 0.0054960948799537175, 'f1-score': 0.010793921317994604, 'support': 6914}, '1': {'precision': 0.3205107129157762, 'recall': 0.9056983586249613, 'f1-score': 0.4734690573521674, 'support': 6458}, '2': {'precision': 0.3325227963525836, 'recall': 0.08226801022710183, 'f1-score': 0.13190258017844225, 'support': 6649}, 'accuracy': 0.32136256930223267, 'macro avg': {'precision': 0.3174153692311856, 'recall': 0.33115415457733893, 'f1-score': 0.20538851961620141, 'support': 20021}, 'weighted avg': {'precision': 0.31714490597224027, 'recall': 0.32136256930223267, 'f1-score': 0.20025536186900628, 'support': 20021}}
[[  38 6320  556]
 [  67 5849  542]
 [  22 6080  547]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1257982
{'0': {'precision': 0.23076923076923078, 'recall': 2.0567667626491154e-05, 'f1-score': 4.1131669328799704e-05, 'support': 145860}, '1': {'precision': 0.283424712193536, 'recall': 0.9992445162298754, 'f1-score': 0.44159567119502646, 'support': 115158}, '2': {'precision': 0.31365313653136534, 'recall': 0.0005851254233554534, 'f1-score': 0.001168071788317908, 'support': 145268}, 'accuracy': 0.28344319026498577, 'macro avg': {'precision': 0.27594902649804404, 'recall': 0.3332834031069524, 'f1-score': 0.14760162488422437, 'support': 406286}, 'weighted avg': {'precision': 0.2753291692168118, 'recall': 0.28344319026498577, 'f1-score': 0.1255986108832461, 'support': 406286}}
[[     3 145752    105]
 [     6 115071     81]
 [     4 145179     85]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1118548
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 24789}, '1': {'precision': 0.33058957637452946, 'recall': 0.9990786732895369, 'f1-score': 0.49679308421639706, 'support': 24964}, '2': {'precision': 0.22727272727272727, 'recall': 0.0003885456735439251, 'f1-score': 0.0007757650983282261, 'support': 25737}, 'accuracy': 0.33052059875480194, 'macro avg': {'precision': 0.18595410121575226, 'recall': 0.3331557396543603, 'f1-score': 0.16585628310490844, 'support': 75490}, 'weighted avg': {'precision': 0.18680827084954213, 'recall': 0.33052059875480194, 'f1-score': 0.16455038310655465, 'support': 75490}}
[[    0 24776    13]
 [    2 24941    21]
 [    0 25727    10]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035708
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10453}, '1': {'precision': 0.359371250299976, 'recall': 0.9994994159853162, 'f1-score': 0.5286615771589956, 'support': 11986}, '2': {'precision': 0.2222222222222222, 'recall': 0.0003664681630783326, 'f1-score': 0.0007317296259032289, 'support': 10915}, 'accuracy': 0.3592972357138574, 'macro avg': {'precision': 0.19386449084073276, 'recall': 0.33328862804946485, 'f1-score': 0.17646443559496627, 'support': 33354}, 'weighted avg': {'precision': 0.2018642250300134, 'recall': 0.3592972357138574, 'f1-score': 0.19021779974499178, 'support': 33354}}
[[    0 10445     8]
 [    0 11980     6]
 [    0 10911     4]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
2104/2104 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1347605
{'0': {'precision': 0.38942665673864485, 'recall': 0.0024956100167964576, 'f1-score': 0.004959437867157237, 'support': 209568}, '1': {'precision': 0.23041893637995295, 'recall': 0.9380891088317357, 'f1-score': 0.3699649233437118, 'support': 125083}, '2': {'precision': 0.39194309408064054, 'recall': 0.053773723701633074, 'f1-score': 0.0945723329567115, 'support': 203910}, 'accuracy': 0.2392059580994539, 'macro avg': {'precision': 0.33726289573307944, 'recall': 0.3314528141833884, 'f1-score': 0.15649889805586017, 'support': 538561}, 'weighted avg': {'precision': 0.3534492355231838, 'recall': 0.2392059580994539, 'f1-score': 0.12366269818042701, 'support': 538561}}
[[   523 199365   9680]
 [   413 117339   7331]
 [   407 192538  10965]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088904
{'0': {'precision': 0.3263707571801567, 'recall': 0.003419785511052747, 'f1-score': 0.006768647624204684, 'support': 36552}, '1': {'precision': 0.3264457819199259, 'recall': 0.8966880460024328, 'f1-score': 0.47863941562753626, 'support': 36172}, '2': {'precision': 0.361529785706962, 'recall': 0.09589339135164536, 'f1-score': 0.1515809384605464, 'support': 36770}, 'accuracy': 0.3295705700768992, 'macro avg': {'precision': 0.3381154416023482, 'recall': 0.3320004076217103, 'f1-score': 0.2123296672374291, 'support': 109494}, 'weighted avg': {'precision': 0.3382025586835957, 'recall': 0.3295705700768992, 'f1-score': 0.21128448734390434, 'support': 109494}}
[[  125 33776  2651]
 [  161 32435  3576]
 [   97 33147  3526]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1145326
{'0': {'precision': 0.36470588235294116, 'recall': 0.0025407753462830915, 'f1-score': 0.0050463942699007, 'support': 12201}, '1': {'precision': 0.302749560606512, 'recall': 0.923153783268235, 'f1-score': 0.45596482569877517, 'support': 11009}, '2': {'precision': 0.36033643204957944, 'recall': 0.06407935133433047, 'f1-score': 0.10880898275631601, 'support': 12703}, 'accuracy': 0.3065185308941052, 'macro avg': {'precision': 0.3425972916696775, 'recall': 0.3299246366496162, 'f1-score': 0.1899400675749973, 'support': 35913}, 'weighted avg': {'precision': 0.3441678522994775, 'recall': 0.3065185308941052, 'f1-score': 0.17997628520475473, 'support': 35913}}
[[   31 11542   628]
 [   29 10163   817]
 [   25 11864   814]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
5267/5267 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941739
{'0': {'precision': 0.5592900793134833, 'recall': 0.035697613865761535, 'f1-score': 0.06711171178550464, 'support': 481993}, '1': {'precision': 0.27074281694852737, 'recall': 0.6896591281547034, 'f1-score': 0.388837727876113, 'support': 366120}, '2': {'precision': 0.49579925834106436, 'recall': 0.3815220086546845, 'f1-score': 0.43121792676821613, 'support': 500076}, 'accuracy': 0.3415648696139785, 'macro avg': {'precision': 0.4419440515343584, 'recall': 0.36895958355838315, 'f1-score': 0.29572245547661125, 'support': 1348189}, 'weighted avg': {'precision': 0.4573806589832024, 'recall': 0.3415648696139785, 'f1-score': 0.28953683806586145, 'support': 1348189}}
[[ 17206 377914  86873]
 [  6472 252498 107150]
 [  7086 302200 190790]]
Evaluating performance on  train set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0618565
{'0': {'precision': 0.5698617788461539, 'recall': 0.04208879370609971, 'f1-score': 0.07838801343322138, 'support': 90119}, '1': {'precision': 0.33804389401755347, 'recall': 0.7256427041840958, 'f1-score': 0.46122436026277097, 'support': 90127}, '2': {'precision': 0.4951996738870693, 'recall': 0.3870595603019216, 'f1-score': 0.43450215222190697, 'support': 91017}, 'accuracy': 0.3849474495231565, 'macro avg': {'precision': 0.4677017822502589, 'recall': 0.38493035273070575, 'f1-score': 0.3247048419726331, 'support': 271263}, 'weighted avg': {'precision': 0.4677889885540452, 'recall': 0.3849474495231565, 'f1-score': 0.32507234561577714, 'support': 271263}}
[[ 3793 73370 12956]
 [ 1771 65400 22956]
 [ 1092 54696 35229]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0644628
{'0': {'precision': 0.5446113074204947, 'recall': 0.0379629914714123, 'f1-score': 0.07097832656938088, 'support': 32479}, '1': {'precision': 0.3550204630823569, 'recall': 0.7009048396469189, 'f1-score': 0.47131280992119984, 'support': 36139}, '2': {'precision': 0.47204135060750485, 'recall': 0.404277337012763, 'f1-score': 0.4355393143600384, 'support': 34788}, 'accuracy': 0.39288822698876275, 'macro avg': {'precision': 0.4572243737034521, 'recall': 0.3810483893770314, 'f1-score': 0.32594348361687303, 'support': 103406}, 'weighted avg': {'precision': 0.45393777608627567, 'recall': 0.39288822698876275, 'f1-score': 0.3335359686512019, 'support': 103406}}
[[ 1233 25752  5494]
 [  573 25330 10236]
 [  458 20266 14064]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
10110/10110 - 145s - 145s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064253
{'0': {'precision': 0.5859043305972261, 'recall': 0.013302344511444086, 'f1-score': 0.026014066865786684, 'support': 933670}, '1': {'precision': 0.26752067576493355, 'recall': 0.8161014628276605, 'f1-score': 0.4029522968439262, 'support': 704731}, '2': {'precision': 0.4774255892078275, 'recall': 0.20965252184900496, 'f1-score': 0.2913598240488519, 'support': 949700}, 'accuracy': 0.303952202792704, 'macro avg': {'precision': 0.4436168651899957, 'recall': 0.34635210972936986, 'f1-score': 0.2401087292528549, 'support': 2588101}, 'weighted avg': {'precision': 0.4594034358674114, 'recall': 0.303952202792704, 'f1-score': 0.2260213004890036, 'support': 2588101}}
[[ 12420 828884  92366]
 [  4029 575132 125570]
 [  4749 745844 199107]]
Evaluating performance on  train set...
1686/1686 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0855508
{'0': {'precision': 0.5187597707139135, 'recall': 0.013799365132171719, 'f1-score': 0.026883607885498245, 'support': 144282}, '1': {'precision': 0.330683200921259, 'recall': 0.8003762082601055, 'f1-score': 0.46800541923829597, 'support': 145664}, '2': {'precision': 0.4306163445037183, 'recall': 0.2285591221702843, 'f1-score': 0.29861940763223566, 'support': 141622}, 'accuracy': 0.3497617988358729, 'macro avg': {'precision': 0.42668643871296363, 'recall': 0.3475782318541872, 'f1-score': 0.26450281158534333, 'support': 431568}, 'weighted avg': {'precision': 0.4263547875617394, 'recall': 0.3497617988358729, 'f1-score': 0.2649442031118041, 'support': 431568}}
[[  1991 127543  14748]
 [  1026 116586  28052]
 [   821 108432  32369]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097676
{'0': {'precision': 0.5157152020525978, 'recall': 0.013078912693377581, 'f1-score': 0.025510851630917628, 'support': 61473}, '1': {'precision': 0.29489671293681957, 'recall': 0.830163219283166, 'f1-score': 0.4351988681786688, 'support': 54099}, '2': {'precision': 0.4687323519445804, 'recall': 0.19200518182659387, 'f1-score': 0.2724199424526547, 'support': 64842}, 'accuracy': 0.3223973749265578, 'macro avg': {'precision': 0.4264480889779992, 'recall': 0.34508243793437915, 'f1-score': 0.24437655408741374, 'support': 180414}, 'weighted avg': {'precision': 0.4326145479493766, 'recall': 0.3223973749265578, 'f1-score': 0.23710081291041848, 'support': 180414}}
[[  804 55327  5342]
 [  419 44911  8769]
 [  336 52056 12450]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
6546/6546 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910267
{'0': {'precision': 0.44465137406313876, 'recall': 0.018015414967388583, 'f1-score': 0.03462785403876664, 'support': 543368}, '1': {'precision': 0.35876531557009406, 'recall': 0.8258010481623989, 'f1-score': 0.500214732940033, 'support': 602960}, '2': {'precision': 0.4059706095859239, 'recall': 0.2038659642906386, 'f1-score': 0.2714287510530485, 'support': 529441}, 'accuracy': 0.3673829746223972, 'macro avg': {'precision': 0.40312909973971894, 'recall': 0.34922747580680863, 'f1-score': 0.26875711267728275, 'support': 1675769}, 'weighted avg': {'precision': 0.4015278645253998, 'recall': 0.3673829746223972, 'f1-score': 0.27696577067193384, 'support': 1675769}}
[[  9789 472686  60893]
 [  7994 497925  97041]
 [  4232 417274 107935]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966588
{'0': {'precision': 0.4479591836734694, 'recall': 0.01657682831276963, 'f1-score': 0.03197057832882723, 'support': 105931}, '1': {'precision': 0.33777769644621747, 'recall': 0.8644474209229789, 'f1-score': 0.4857510533088767, 'support': 106763}, '2': {'precision': 0.41709197235513024, 'recall': 0.15371879775853287, 'f1-score': 0.22464494330546328, 'support': 102076}, 'accuracy': 0.3486291577977571, 'macro avg': {'precision': 0.4009429508249391, 'recall': 0.34491434899809376, 'f1-score': 0.24745552498105572, 'support': 314770}, 'weighted avg': {'precision': 0.4005782147648253, 'recall': 0.3486291577977571, 'f1-score': 0.2483647497227025, 'support': 314770}}
[[ 1756 95448  8727]
 [ 1270 92291 13202]
 [  894 85491 15691]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.083471
{'0': {'precision': 0.4560315670800451, 'recall': 0.022471598011166355, 'f1-score': 0.04283256121773659, 'support': 36001}, '1': {'precision': 0.3751889463711652, 'recall': 0.8223134711399375, 'f1-score': 0.5152773310721909, 'support': 42862}, '2': {'precision': 0.40230274297324753, 'recall': 0.20618437418645685, 'f1-score': 0.2726386046778481, 'support': 34571}, 'accuracy': 0.3806883297776681, 'macro avg': {'precision': 0.4111744188081526, 'recall': 0.3503231477791869, 'f1-score': 0.2769161656559252, 'support': 113434}, 'weighted avg': {'precision': 0.40910969544526093, 'recall': 0.3806883297776681, 'f1-score': 0.29138724900059826, 'support': 113434}}
[[  809 31559  3633]
 [  659 35246  6957]
 [  306 27137  7128]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
7633/7633 - 109s - 109s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027747
{'0': {'precision': 0.433300395256917, 'recall': 0.01837358322284442, 'f1-score': 0.03525233355058586, 'support': 668242}, '1': {'precision': 0.3117163219541422, 'recall': 0.8259382599705689, 'f1-score': 0.45261266582982607, 'support': 612277}, '2': {'precision': 0.4409330968503366, 'recall': 0.19859859919313286, 'f1-score': 0.2738525577828897, 'support': 673469}, 'accuracy': 0.33353889583764074, 'macro avg': {'precision': 0.3953166046871319, 'recall': 0.3476368141288488, 'f1-score': 0.25390585238776725, 'support': 1953988}, 'weighted avg': {'precision': 0.39783306191598333, 'recall': 0.33353889583764074, 'f1-score': 0.24826796444516752, 'support': 1953988}}
[[ 12278 583174  72790]
 [  9780 505703  96794]
 [  6278 533441 133750]]
Evaluating performance on  train set...
1586/1586 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096943
{'0': {'precision': 0.43998971986635826, 'recall': 0.025384398677401658, 'f1-score': 0.04799955140606163, 'support': 134886}, '1': {'precision': 0.33325411160756724, 'recall': 0.8213448922211809, 'f1-score': 0.47413268411442483, 'support': 136576}, '2': {'precision': 0.40771484375, 'recall': 0.18642831626577758, 'f1-score': 0.25586288609249874, 'support': 134368}, 'accuracy': 0.34657368849025455, 'macro avg': {'precision': 0.3936528917413085, 'recall': 0.3443858690547867, 'f1-score': 0.2593317072043284, 'support': 405830}, 'weighted avg': {'precision': 0.3933834241574273, 'recall': 0.34657368849025455, 'f1-score': 0.2602306316315861, 'support': 405830}}
[[  3424 116682  14780]
 [  2790 112176  21610]
 [  1568 107750  25050]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850408
{'0': {'precision': 0.39689034369885434, 'recall': 0.02191397072112778, 'f1-score': 0.04153464074676715, 'support': 44264}, '1': {'precision': 0.38261891687830324, 'recall': 0.7857457492731917, 'f1-score': 0.5146358773736779, 'support': 56755}, '2': {'precision': 0.37766777861472794, 'recall': 0.22961008374040476, 'f1-score': 0.28559028955041704, 'support': 45856}, 'accuracy': 0.38191659574468084, 'macro avg': {'precision': 0.38572567973062855, 'recall': 0.3457566012449081, 'f1-score': 0.2805869358902873, 'support': 146875}, 'weighted avg': {'precision': 0.38537412396303766, 'recall': 0.38191659574468084, 'f1-score': 0.30054588511306835, 'support': 146875}}
[[  970 37110  6184]
 [  994 44595 11166]
 [  480 34847 10529]]
testing model on single stock: results/universal/W10/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
22048/22048 - 307s - 307s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1307881
{'0': {'precision': 0.4278403275332651, 'recall': 0.00019762257209087044, 'f1-score': 0.00039506266185282494, 'support': 2115143}, '1': {'precision': 0.25021560701757917, 'recall': 0.9847506053200236, 'f1-score': 0.399039209347567, 'support': 1413302}, '2': {'precision': 0.390490554841262, 'recall': 0.014929881174481465, 'f1-score': 0.028760156448112483, 'support': 2115623}, 'accuracy': 0.25225670562438296, 'macro avg': {'precision': 0.3561821631307021, 'recall': 0.33329270302219866, 'f1-score': 0.14273147615251078, 'support': 5644068}, 'weighted avg': {'precision': 0.3693620436241709, 'recall': 0.25225670562438296, 'f1-score': 0.11084986487376475, 'support': 5644068}}
[[    418 2086738   27987]
 [    237 1391750   21315]
 [    322 2083715   31586]]
Evaluating performance on  train set...
5429/5429 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1099814
{'0': {'precision': 0.41642228739002934, 'recall': 0.0006143715346957671, 'f1-score': 0.0012269329053468787, 'support': 462261}, '1': {'precision': 0.32880215084595704, 'recall': 0.9737604097131789, 'f1-score': 0.4916071240139068, 'support': 456905}, '2': {'precision': 0.365256310463694, 'recall': 0.02791789728661581, 'f1-score': 0.05187109407384889, 'support': 470630}, 'accuracy': 0.32978868841182446, 'macro avg': {'precision': 0.37016024956656013, 'recall': 0.33409755951149683, 'f1-score': 0.18156838366436753, 'support': 1389796}, 'weighted avg': {'precision': 0.3702901052507006, 'recall': 0.32978868841182446, 'f1-score': 0.17959255116096762, 'support': 1389796}}
[[   284 450892  11085]
 [   241 444916  11748]
 [   157 457334  13139]]
Evaluating performance on  val set...
1890/1890 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011115
{'0': {'precision': 0.42083333333333334, 'recall': 0.00066282969214514, 'f1-score': 0.0013235747000661787, 'support': 152377}, '1': {'precision': 0.35642777045839247, 'recall': 0.9715379832528517, 'f1-score': 0.5215241678013235, 'support': 172089}, '2': {'precision': 0.3750435449035045, 'recall': 0.03381260167963769, 'f1-score': 0.062032566232988, 'support': 159201}, 'accuracy': 0.3570121591921715, 'macro avg': {'precision': 0.3841015495650768, 'recall': 0.33533780487487813, 'f1-score': 0.19496010291145924, 'support': 483667}, 'weighted avg': {'precision': 0.3828458977270115, 'recall': 0.3570121591921715, 'f1-score': 0.20639386485266073, 'support': 483667}}
[[   101 148106   4170]
 [    98 167191   4800]
 [    41 153777   5383]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        77 (peak)  22.42 (ave)

============================================
